<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>掘金文章推荐</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>一个帮助开发者成长的社区</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Redis（134）Redis的事件循环模型是什么？]]></title>    <link>https://juejin.cn/post/7574568258787901491</link>    <guid>https://juejin.cn/post/7574568258787901491</guid>    <pubDate>2025-11-19T22:59:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574568258787901491" data-draft-id="7574568258787885107" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redis（134）Redis的事件循环模型是什么？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T22:59:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redis（134）Redis的事件循环模型是什么？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T22:59:42.000Z" title="Wed Nov 19 2025 22:59:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Redis的事件循环模型是其高性能和高并发处理能力的关键。Redis使用基于reactor模式的单线程事件驱动模型来处理网络事件和文件事件。这种模型包括事件的注册、事件的分发和事件的处理。Redis源码中的<code>ae</code>库实现了其事件循环机制。</p>
<h3 data-id="heading-0">事件循环模型的主要组件</h3>
<ol>
<li><strong>事件循环</strong>：主要由<code>aeEventLoop</code>结构体表示，包含了所有需要处理的事件信息。</li>
<li><strong>文件事件</strong>：如套接字的可读/可写事件。</li>
<li><strong>时间事件</strong>：如定时任务。</li>
</ol>
<h3 data-id="heading-1">核心数据结构</h3>
<h4 data-id="heading-2"><code>aeEventLoop</code> 结构体</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aeEventLoop</span> {</span>
    <span class="hljs-type">int</span> maxfd;   <span class="hljs-comment">/* highest file descriptor currently registered */</span>
    <span class="hljs-type">int</span> setsize; <span class="hljs-comment">/* max number of file descriptors tracked */</span>
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> timeEventNextId;
    aeFileEvent *events; <span class="hljs-comment">/* Registered events */</span>
    aeFiredEvent *fired; <span class="hljs-comment">/* Fired events */</span>
    aeTimeEvent *timeEventHead;
    <span class="hljs-type">int</span> stop;
    <span class="hljs-type">void</span> *apidata; <span class="hljs-comment">/* This is used for polling API specific data */</span>
    aeBeforeSleepProc *beforesleep;
    aeBeforeSleepProc *aftersleep;
} aeEventLoop;
</code></pre>
<h3 data-id="heading-3">文件事件</h3>
<p>Redis使用<code>aeFileEvent</code>结构体来表示文件事件：</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aeFileEvent</span> {</span>
    <span class="hljs-type">int</span> mask; <span class="hljs-comment">/* one of AE_(READABLE|WRITABLE) */</span>
    aeFileProc *rfileProc;
    aeFileProc *wfileProc;
    <span class="hljs-type">void</span> *clientData;
} aeFileEvent;
</code></pre>
<h3 data-id="heading-4">时间事件</h3>
<p>时间事件通过<code>aeTimeEvent</code>结构体表示：</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aeTimeEvent</span> {</span>
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> id; <span class="hljs-comment">/* time event identifier. */</span>
    <span class="hljs-type">long</span> when_sec; <span class="hljs-comment">/* seconds */</span>
    <span class="hljs-type">long</span> when_ms; <span class="hljs-comment">/* milliseconds */</span>
    aeTimeProc *timeProc;
    aeEventFinalizerProc *finalizerProc;
    <span class="hljs-type">void</span> *clientData;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aeTimeEvent</span> *<span class="hljs-title">next</span>;</span>
} aeTimeEvent;
</code></pre>
<h3 data-id="heading-5">事件循环的主要流程</h3>
<h4 data-id="heading-6">1. 创建事件循环</h4>
<p>创建事件循环，为文件事件和时间事件分配空间：</p>
<pre><code class="hljs language-c" lang="c">aeEventLoop *<span class="hljs-title function_">aeCreateEventLoop</span><span class="hljs-params">(<span class="hljs-type">int</span> setsize)</span> {
    aeEventLoop *eventLoop;
    <span class="hljs-type">int</span> i;

    <span class="hljs-keyword">if</span> ((eventLoop = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(*eventLoop))) == <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">goto</span> err;
    eventLoop-&gt;events = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(aeFileEvent)*setsize);
    eventLoop-&gt;fired = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(aeFiredEvent)*setsize);
    <span class="hljs-keyword">if</span> (eventLoop-&gt;events == <span class="hljs-literal">NULL</span> || eventLoop-&gt;fired == <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">goto</span> err;
    eventLoop-&gt;setsize = setsize;
    eventLoop-&gt;timeEventHead = <span class="hljs-literal">NULL</span>;
    eventLoop-&gt;timeEventNextId = <span class="hljs-number">0</span>;
    eventLoop-&gt;stop = <span class="hljs-number">0</span>;
    eventLoop-&gt;maxfd = <span class="hljs-number">-1</span>;
    eventLoop-&gt;beforesleep = <span class="hljs-literal">NULL</span>;
    eventLoop-&gt;aftersleep = <span class="hljs-literal">NULL</span>;
    <span class="hljs-comment">/* 根据操作系统，初始化不同的IO多路复用机制（如epoll, kqueue等） */</span>
    <span class="hljs-keyword">if</span> (aeApiCreate(eventLoop) == <span class="hljs-number">-1</span>) <span class="hljs-keyword">goto</span> err;
    <span class="hljs-comment">/* 初始化文件事件数组 */</span>
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; setsize; i++)
        eventLoop-&gt;events[i].mask = AE_NONE;
    <span class="hljs-keyword">return</span> eventLoop;

err:
    <span class="hljs-keyword">if</span> (eventLoop) {
        <span class="hljs-built_in">free</span>(eventLoop-&gt;events);
        <span class="hljs-built_in">free</span>(eventLoop-&gt;fired);
        <span class="hljs-built_in">free</span>(eventLoop);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
}
</code></pre>
<h4 data-id="heading-7">2. 注册事件</h4>
<p>注册文件事件：</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> <span class="hljs-title function_">aeCreateFileEvent</span><span class="hljs-params">(aeEventLoop *eventLoop, <span class="hljs-type">int</span> fd, <span class="hljs-type">int</span> mask,
                      aeFileProc *proc, <span class="hljs-type">void</span> *clientData)</span> {
    <span class="hljs-keyword">if</span> (fd &gt;= eventLoop-&gt;setsize) <span class="hljs-keyword">return</span> AE_ERR;
    aeFileEvent *fe = &amp;eventLoop-&gt;events[fd];

    <span class="hljs-keyword">if</span> (aeApiAddEvent(eventLoop, fd, mask) == <span class="hljs-number">-1</span>)
        <span class="hljs-keyword">return</span> AE_ERR;
    fe-&gt;mask |= mask;
    <span class="hljs-keyword">if</span> (mask &amp; AE_READABLE) fe-&gt;rfileProc = proc;
    <span class="hljs-keyword">if</span> (mask &amp; AE_WRITABLE) fe-&gt;wfileProc = proc;
    fe-&gt;clientData = clientData;
    <span class="hljs-keyword">if</span> (fd &gt; eventLoop-&gt;maxfd)
        eventLoop-&gt;maxfd = fd;
    <span class="hljs-keyword">return</span> AE_OK;
}
</code></pre>
<h4 data-id="heading-8">3. 事件处理循环</h4>
<p>在事件循环中，事件处理的主要步骤是：</p>
<ol>
<li>等待事件（调用<code>aeApiPoll</code>）。</li>
<li>处理已触发的文件事件。</li>
<li>处理时间事件。</li>
</ol>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">aeMain</span><span class="hljs-params">(aeEventLoop *eventLoop)</span> {
    eventLoop-&gt;stop = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (!eventLoop-&gt;stop) {
        <span class="hljs-keyword">if</span> (eventLoop-&gt;beforesleep != <span class="hljs-literal">NULL</span>)
            eventLoop-&gt;beforesleep(eventLoop);
        aeProcessEvents(eventLoop, AE_ALL_EVENTS);
        <span class="hljs-keyword">if</span> (eventLoop-&gt;aftersleep != <span class="hljs-literal">NULL</span>)
            eventLoop-&gt;aftersleep(eventLoop);
    }
}

<span class="hljs-type">int</span> <span class="hljs-title function_">aeProcessEvents</span><span class="hljs-params">(aeEventLoop *eventLoop, <span class="hljs-type">int</span> flags)</span> {
    <span class="hljs-type">int</span> processed = <span class="hljs-number">0</span>, numevents;

    <span class="hljs-comment">/* 处理时间事件 */</span>
    <span class="hljs-keyword">if</span> (!(flags &amp; AE_TIME_EVENTS)) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    processed += processTimeEvents(eventLoop);

    <span class="hljs-comment">/* 处理文件事件 */</span>
    <span class="hljs-keyword">if</span> (flags &amp; AE_FILE_EVENTS) {
        numevents = aeApiPoll(eventLoop, &amp;tvp);
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; numevents; j++) {
            aeFileEvent *fe = &amp;eventLoop-&gt;events[eventLoop-&gt;fired[j].fd];
            <span class="hljs-type">int</span> mask = eventLoop-&gt;fired[j].mask;
            <span class="hljs-type">int</span> fd = eventLoop-&gt;fired[j].fd;
            <span class="hljs-type">int</span> rfired = <span class="hljs-number">0</span>;

            <span class="hljs-comment">/* 处理读事件 */</span>
            <span class="hljs-keyword">if</span> (fe-&gt;mask &amp; mask &amp; AE_READABLE) {
                rfired = <span class="hljs-number">1</span>;
                fe-&gt;rfileProc(eventLoop, fd, fe-&gt;clientData, mask);
            }

            <span class="hljs-comment">/* 处理写事件 */</span>
            <span class="hljs-keyword">if</span> (fe-&gt;mask &amp; mask &amp; AE_WRITABLE) {
                <span class="hljs-keyword">if</span> (!rfired || fe-&gt;wfileProc != fe-&gt;rfileProc)
                    fe-&gt;wfileProc(eventLoop, fd, fe-&gt;clientData, mask);
            }

            processed++;
        }
    }

    <span class="hljs-keyword">return</span> processed;
}
</code></pre>
<h3 data-id="heading-9">事件处理代码示例</h3>
<p>以下是一个简单的示例，展示了如何使用Redis的事件循环模型处理文件事件：</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ae.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>

<span class="hljs-comment">/* 文件事件处理函数 */</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">fileEventProc</span><span class="hljs-params">(aeEventLoop *eventLoop, <span class="hljs-type">int</span> fd, <span class="hljs-type">void</span> *clientData, <span class="hljs-type">int</span> mask)</span> {
    <span class="hljs-type">char</span> buf[<span class="hljs-number">128</span>];
    <span class="hljs-type">int</span> n = read(fd, buf, <span class="hljs-keyword">sizeof</span>(buf));
    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">0</span>) {
        buf[n] = <span class="hljs-string">'\0'</span>;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Read from fd %d: %s\n"</span>, fd, buf);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"EOF on fd %d\n"</span>, fd);
        aeDeleteFileEvent(eventLoop, fd, AE_READABLE);
        close(fd);
    } <span class="hljs-keyword">else</span> {
        perror(<span class="hljs-string">"read"</span>);
    }
}

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> **argv)</span> {
    aeEventLoop *eventLoop = aeCreateEventLoop(<span class="hljs-number">1024</span>);

    <span class="hljs-comment">// 注册标准输入的读事件</span>
    <span class="hljs-keyword">if</span> (aeCreateFileEvent(eventLoop, STDIN_FILENO, AE_READABLE, fileEventProc, <span class="hljs-literal">NULL</span>) == AE_ERR) {
        <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">"Could not create file event.\n"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

    <span class="hljs-comment">// 进入事件循环</span>
    aeMain(eventLoop);

    aeDeleteEventLoop(eventLoop);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-10">总结</h3>
<p>Redis的事件循环模型是其高性能和高并发处理能力的关键。通过基于reactor模式的单线程事件驱动模型，Redis能够高效地处理网络事件和文件事件。上述代码展示了事件循环的主要流程，包括创建事件循环、注册事件、处理事件等。</p>
<p>这种模型在处理大量并发连接时具有较高的效率，同时也简化了编程模型，使得开发和维护更加容易。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redis（135）Redis的网络模型是什么？]]></title>    <link>https://juejin.cn/post/7574318108719333422</link>    <guid>https://juejin.cn/post/7574318108719333422</guid>    <pubDate>2025-11-19T23:01:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574318108719333422" data-draft-id="7574322843048558642" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redis（135）Redis的网络模型是什么？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T23:01:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redis（135）Redis的网络模型是什么？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T23:01:02.000Z" title="Wed Nov 19 2025 23:01:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Redis的网络模型是基于单线程的事件驱动机制实现的，使用了 Reactor 模式。它主要通过一个事件循环来处理网络I/O和文件I/O。Redis的高性能很大程度上依赖于这个轻量级的网络模型，该模型允许它在单线程中高效地处理大量并发连接。</p>
<h3 data-id="heading-0">核心数据结构和组件</h3>
<h4 data-id="heading-1">1. 事件循环（Event Loop）</h4>
<p>Redis使用<code>aeEventLoop</code>结构体来管理事件循环。事件循环本质上是一个无限循环，它处理所有注册的事件（文件事件和时间事件）。</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aeEventLoop</span> {</span>
    <span class="hljs-type">int</span> maxfd;   <span class="hljs-comment">/* highest file descriptor currently registered */</span>
    <span class="hljs-type">int</span> setsize; <span class="hljs-comment">/* max number of file descriptors tracked */</span>
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> timeEventNextId;
    aeFileEvent *events; <span class="hljs-comment">/* Registered events */</span>
    aeFiredEvent *fired; <span class="hljs-comment">/* Fired events */</span>
    aeTimeEvent *timeEventHead;
    <span class="hljs-type">int</span> stop;
    <span class="hljs-type">void</span> *apidata; <span class="hljs-comment">/* This is used for polling API specific data */</span>
    aeBeforeSleepProc *beforesleep;
    aeBeforeSleepProc *aftersleep;
} aeEventLoop;
</code></pre>
<h4 data-id="heading-2">2. 文件事件（File Event）</h4>
<p>文件事件表示对文件描述符的读写操作。</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aeFileEvent</span> {</span>
    <span class="hljs-type">int</span> mask; <span class="hljs-comment">/* one of AE_(READABLE|WRITABLE) */</span>
    aeFileProc *rfileProc;
    aeFileProc *wfileProc;
    <span class="hljs-type">void</span> *clientData;
} aeFileEvent;
</code></pre>
<h4 data-id="heading-3">3. 时间事件（Time Event）</h4>
<p>时间事件用于处理定时任务。</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aeTimeEvent</span> {</span>
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> id; <span class="hljs-comment">/* time event identifier. */</span>
    <span class="hljs-type">long</span> when_sec; <span class="hljs-comment">/* seconds */</span>
    <span class="hljs-type">long</span> when_ms; <span class="hljs-comment">/* milliseconds */</span>
    aeTimeProc *timeProc;
    aeEventFinalizerProc *finalizerProc;
    <span class="hljs-type">void</span> *clientData;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aeTimeEvent</span> *<span class="hljs-title">next</span>;</span>
} aeTimeEvent;
</code></pre>
<h3 data-id="heading-4">核心函数和流程</h3>
<h4 data-id="heading-5">1. 创建和初始化事件循环</h4>
<pre><code class="hljs language-c" lang="c">aeEventLoop *<span class="hljs-title function_">aeCreateEventLoop</span><span class="hljs-params">(<span class="hljs-type">int</span> setsize)</span> {
    aeEventLoop *eventLoop;
    <span class="hljs-type">int</span> i;

    <span class="hljs-keyword">if</span> ((eventLoop = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(*eventLoop))) == <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">goto</span> err;
    eventLoop-&gt;events = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(aeFileEvent) * setsize);
    eventLoop-&gt;fired = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(aeFiredEvent) * setsize);
    <span class="hljs-keyword">if</span> (eventLoop-&gt;events == <span class="hljs-literal">NULL</span> || eventLoop-&gt;fired == <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">goto</span> err;
    eventLoop-&gt;setsize = setsize;
    eventLoop-&gt;timeEventHead = <span class="hljs-literal">NULL</span>;
    eventLoop-&gt;timeEventNextId = <span class="hljs-number">0</span>;
    eventLoop-&gt;stop = <span class="hljs-number">0</span>;
    eventLoop-&gt;maxfd = <span class="hljs-number">-1</span>;
    eventLoop-&gt;beforesleep = <span class="hljs-literal">NULL</span>;
    eventLoop-&gt;aftersleep = <span class="hljs-literal">NULL</span>;

    <span class="hljs-keyword">if</span> (aeApiCreate(eventLoop) == <span class="hljs-number">-1</span>) <span class="hljs-keyword">goto</span> err;

    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; setsize; i++)
        eventLoop-&gt;events[i].mask = AE_NONE;
    <span class="hljs-keyword">return</span> eventLoop;

err:
    <span class="hljs-keyword">if</span> (eventLoop) {
        <span class="hljs-built_in">free</span>(eventLoop-&gt;events);
        <span class="hljs-built_in">free</span>(eventLoop-&gt;fired);
        <span class="hljs-built_in">free</span>(eventLoop);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
}
</code></pre>
<h4 data-id="heading-6">2. 注册文件事件</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> <span class="hljs-title function_">aeCreateFileEvent</span><span class="hljs-params">(aeEventLoop *eventLoop, <span class="hljs-type">int</span> fd, <span class="hljs-type">int</span> mask,
                      aeFileProc *proc, <span class="hljs-type">void</span> *clientData)</span> {
    <span class="hljs-keyword">if</span> (fd &gt;= eventLoop-&gt;setsize) <span class="hljs-keyword">return</span> AE_ERR;
    aeFileEvent *fe = &amp;eventLoop-&gt;events[fd];

    <span class="hljs-keyword">if</span> (aeApiAddEvent(eventLoop, fd, mask) == <span class="hljs-number">-1</span>)
        <span class="hljs-keyword">return</span> AE_ERR;
    fe-&gt;mask |= mask;
    <span class="hljs-keyword">if</span> (mask &amp; AE_READABLE) fe-&gt;rfileProc = proc;
    <span class="hljs-keyword">if</span> (mask &amp; AE_WRITABLE) fe-&gt;wfileProc = proc;
    fe-&gt;clientData = clientData;
    <span class="hljs-keyword">if</span> (fd &gt; eventLoop-&gt;maxfd)
        eventLoop-&gt;maxfd = fd;
    <span class="hljs-keyword">return</span> AE_OK;
}
</code></pre>
<h4 data-id="heading-7">3. 事件循环处理函数</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">aeMain</span><span class="hljs-params">(aeEventLoop *eventLoop)</span> {
    eventLoop-&gt;stop = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (!eventLoop-&gt;stop) {
        <span class="hljs-keyword">if</span> (eventLoop-&gt;beforesleep != <span class="hljs-literal">NULL</span>)
            eventLoop-&gt;beforesleep(eventLoop);
        aeProcessEvents(eventLoop, AE_ALL_EVENTS);
        <span class="hljs-keyword">if</span> (eventLoop-&gt;aftersleep != <span class="hljs-literal">NULL</span>)
            eventLoop-&gt;aftersleep(eventLoop);
    }
}

<span class="hljs-type">int</span> <span class="hljs-title function_">aeProcessEvents</span><span class="hljs-params">(aeEventLoop *eventLoop, <span class="hljs-type">int</span> flags)</span> {
    <span class="hljs-type">int</span> processed = <span class="hljs-number">0</span>, numevents;

    <span class="hljs-keyword">if</span> (!(flags &amp; AE_TIME_EVENTS)) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    processed += processTimeEvents(eventLoop);

    <span class="hljs-keyword">if</span> (flags &amp; AE_FILE_EVENTS) {
        numevents = aeApiPoll(eventLoop, &amp;tvp);
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; numevents; j++) {
            aeFileEvent *fe = &amp;eventLoop-&gt;events[eventLoop-&gt;fired[j].fd];
            <span class="hljs-type">int</span> mask = eventLoop-&gt;fired[j].mask;
            <span class="hljs-type">int</span> fd = eventLoop-&gt;fired[j].fd;
            <span class="hljs-type">int</span> rfired = <span class="hljs-number">0</span>;

            <span class="hljs-keyword">if</span> (fe-&gt;mask &amp; mask &amp; AE_READABLE) {
                rfired = <span class="hljs-number">1</span>;
                fe-&gt;rfileProc(eventLoop, fd, fe-&gt;clientData, mask);
            }

            <span class="hljs-keyword">if</span> (fe-&gt;mask &amp; mask &amp; AE_WRITABLE) {
                <span class="hljs-keyword">if</span> (!rfired || fe-&gt;wfileProc != fe-&gt;rfileProc)
                    fe-&gt;wfileProc(eventLoop, fd, fe-&gt;clientData, mask);
            }

            processed++;
        }
    }

    <span class="hljs-keyword">return</span> processed;
}
</code></pre>
<h4 data-id="heading-8">4. 处理时间事件</h4>
<p>时间事件主要用于定时任务，通过检查当前时间和事件触发时间来决定是否执行：</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">processTimeEvents</span><span class="hljs-params">(aeEventLoop *eventLoop)</span> {
    <span class="hljs-type">int</span> processed = <span class="hljs-number">0</span>;
    aeTimeEvent *te;
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> maxId;
    <span class="hljs-type">time_t</span> now = time(<span class="hljs-literal">NULL</span>);

    te = eventLoop-&gt;timeEventHead;

    <span class="hljs-keyword">while</span> (te) {
        <span class="hljs-type">long</span> now_sec, now_ms;
        <span class="hljs-type">long</span> <span class="hljs-type">long</span> id;

        aeGetTime(&amp;now_sec, &amp;now_ms);

        <span class="hljs-keyword">if</span> (te-&gt;when_sec &gt; now_sec || (te-&gt;when_sec == now_sec &amp;&amp; te-&gt;when_ms &gt; now_ms)) {
            te = te-&gt;next;
            <span class="hljs-keyword">continue</span>;
        }

        id = te-&gt;id;
        <span class="hljs-type">int</span> retval = te-&gt;timeProc(eventLoop, id, te-&gt;clientData);
        processed++;

        <span class="hljs-keyword">if</span> (retval != AE_NOMORE) {
            te-&gt;when_sec = now_sec + retval / <span class="hljs-number">1000</span>;
            te-&gt;when_ms = now_ms + retval % <span class="hljs-number">1000</span>;
            <span class="hljs-keyword">if</span> (te-&gt;when_ms &gt;= <span class="hljs-number">1000</span>) {
                te-&gt;when_sec++;
                te-&gt;when_ms -= <span class="hljs-number">1000</span>;
            }
        } <span class="hljs-keyword">else</span> {
            aeDeleteTimeEvent(eventLoop, id);
        }

        te = eventLoop-&gt;timeEventHead;
    }

    <span class="hljs-keyword">return</span> processed;
}
</code></pre>
<h3 data-id="heading-9">示例使用</h3>
<p>以下是一个简单的示例，展示了如何使用Redis的网络模型处理文件事件：</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ae.h"</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">fileEventProc</span><span class="hljs-params">(aeEventLoop *eventLoop, <span class="hljs-type">int</span> fd, <span class="hljs-type">void</span> *clientData, <span class="hljs-type">int</span> mask)</span> {
    <span class="hljs-type">char</span> buf[<span class="hljs-number">128</span>];
    <span class="hljs-type">int</span> n = read(fd, buf, <span class="hljs-keyword">sizeof</span>(buf));
    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">0</span>) {
        buf[n] = <span class="hljs-string">'\0'</span>;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Read from fd %d: %s\n"</span>, fd, buf);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"EOF on fd %d\n"</span>, fd);
        aeDeleteFileEvent(eventLoop, fd, AE_READABLE);
        close(fd);
    } <span class="hljs-keyword">else</span> {
        perror(<span class="hljs-string">"read"</span>);
    }
}

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> **argv)</span> {
    aeEventLoop *eventLoop = aeCreateEventLoop(<span class="hljs-number">1024</span>);

    <span class="hljs-keyword">if</span> (aeCreateFileEvent(eventLoop, STDIN_FILENO, AE_READABLE, fileEventProc, <span class="hljs-literal">NULL</span>) == AE_ERR) {
        <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">"Could not create file event.\n"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

    aeMain(eventLoop);

    aeDeleteEventLoop(eventLoop);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-10">总结</h3>
<p>Redis的网络模型是基于单线程事件驱动机制的，使用 Reactor 模式进行事件处理。这种模型允许 Redis 在单线程环境下高效地处理大量并发连接，通过注册、处理文件事件和时间事件实现高效的 I/O 操作。这种设计不仅简化了编程模型，还显著提升了系统的性能和可维护性。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2 种方法！用 n8n 自动发公众号]]></title>    <link>https://juejin.cn/post/7574308545525678095</link>    <guid>https://juejin.cn/post/7574308545525678095</guid>    <pubDate>2025-11-19T16:02:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574308545525678095" data-draft-id="7574276404596588596" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2 种方法！用 n8n 自动发公众号"/> <meta itemprop="keywords" content="工作流引擎"/> <meta itemprop="datePublished" content="2025-11-19T16:02:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="麦麦麦造"/> <meta itemprop="url" content="https://juejin.cn/user/1732486056126311"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2 种方法！用 n8n 自动发公众号
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1732486056126311/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    麦麦麦造
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T16:02:40.000Z" title="Wed Nov 19 2025 16:02:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"“";top:4px;left:6px}.markdown-body blockquote:after{content:"”";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>大家好，我是 <strong>MAI麦造</strong></p>
<p>前段时间有朋友找我咨询 ==n8n 中如何自动发公众号的问题==，刚好发现了一些新手可能会遇到的坑，所以这里分享一下！</p>
<blockquote>
<p>[!Note]
<strong>我用了两种方法来实现，分别是：</strong></p>
<ul>
<li>自己手动配置 http 节点，实现公众号接口。</li>
<li>使用社区节点</li>
</ul>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9db97006db4b4e3c95fafb91edcfad6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=HRIS3Kzg%2FK2Wa6ptBw9T1B256yo%3D" alt="PixPin_2025-11-19_23-26-02.png" loading="lazy"/></p>
<p>各有自己适合的场景，所以根据自己的需求来选择即可。</p>
<blockquote>
<p>不过都需要用到公众号的官方接口，所以先需要在公众号后台进行一下配置！</p>
</blockquote>
<h2 data-id="heading-0">公众号后台配置</h2>
<h3 data-id="heading-1">1. 获取 开发者 ID 和 开发者密码</h3>
<p>通过<strong>设置与开发——开发接口管理——账号开发信息</strong>获取。</p>
<p>第一次可能需要申请一下。 不过基本都能过。</p>
<blockquote>
<p>[!note]
<strong>开发者密码(AppSecret)</strong> 是敏感信息，后台只会显示一次，请妥善保存，如果遗忘只能重置！</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd4d270c12064f05915e675230c7a456~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=CdcyFs8EY%2F8h3AIT9vsZKdh%2BcyI%3D" alt="PixPin_2025-11-18_17-15-31.png" loading="lazy"/></p>
<h3 data-id="heading-2">2. 配置白名单</h3>
<p>由于公众号的安全限制，限制必须在白名单内的 IP 才能访问。</p>
<p>所以需要把你的 IP 添加进来。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b4a844187f147e48b4996fc6abf54fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=%2BxJEEOl69IROUXQMBwDMGECTCI0%3D" alt="PixPin_2025-11-19_21-24-46.png" loading="lazy"/></p>
<p>这里需要注意一下，
建议这一步都在 n8n 中配置一个 http 节点来看你的请求 IP！</p>
<blockquote>
<p>这个方法也适合你的 n8n 通过其他方式部署，你不知道 IP 的情况。</p>
</blockquote>
<p>很多人在最后一步上传草稿的时候，出现上传不成功的问题，原因就是白名单配置不正确。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f08487c3539b4ee7ae9ffd524cd88bfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=%2Bqi%2BN2CimAvA6GfOVI9pc4wQTsc%3D" alt="PixPin_2025-11-18_17-17-44.png" loading="lazy"/></p>
<p>n8n 中配置一个网络请求节点，使用<code>GET</code>方法，URL是：<code>http://httpbin.org/ip</code></p>
<p>这样可以确保你的 n8n 的出口 IP 不会出错！</p>
<h2 data-id="heading-3">方法 1：手动配置节点</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9db75b4a5c54b52b719596be4b0a417~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=lBxn8pF52rwfinKbfPcLuWdBXEk%3D" alt="PixPin_2025-11-19_21-35-18.png" loading="lazy"/></p>
<p>这个方法相对来讲复杂一些，配置的节点比较多，</p>
<p>比较适合你的 n8n 没法安装社区节点的场景。</p>
<p>这里实际需要调到公众号的 3 个接口，分别是：</p>
<ul>
<li>获取 token</li>
<li>上传封面素材</li>
<li>上传到草稿箱</li>
</ul>
<p>这里我设置了一个 mock 数据的节点，来模拟一下真实的场景。
里面总共是 3 个字段：<code>content</code>、<code>title</code>、<code>author</code></p>
<p>大家根据自己的实际情况调整。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d71b467b57ea48a585ade91e0918c12a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=vu4cXmBeQZrVmBxAXrwURF4qduM%3D" alt="PixPin_2025-11-19_21-38-54.png" loading="lazy"/></p>
<p>token 是微信用来鉴权的，有过期时间，所以每次运行都要调用一次。</p>
<p>接口主要就 3 个参数：</p>
<ul>
<li><code>grant_type</code> ：值是固定的 <code>client_credential</code></li>
<li><code>appid</code> 和 <code>secret</code> ：是刚刚获取到的 <code>开发者 ID</code> 和 <code>开发者密码</code></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73e88ac81c6448e48502f8e277b6782b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=TCaNycZgLjKnd54YOfj%2B%2FDURjOc%3D" alt="PixPin_2025-11-19_21-44-15.png" loading="lazy"/></p>
<p>接下来是上传封面：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03340c2df1c4402f830777fc9721572c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=H2F0A4jefrpj8%2BupNiAU%2FhK2pQw%3D" alt="PixPin_2025-11-19_21-56-34.png" loading="lazy"/></p>
<p>这里总共用了 3 个节点，分别是：</p>
<ul>
<li>下载封面图。 也可以从本地路径读取</li>
<li>上传图片</li>
<li>解析上传结果，拿到 <code>media_id</code></li>
</ul>
<p>在下载封面图这里需要注意一下，因为下载完之后是一个文件,
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c96cbeca82394580ab18cbb1fdc82609~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=CQ3Itj%2FZ4eaZOMTbtAWkCCoIIaU%3D" alt="PixPin_2025-11-19_22-03-27.png" loading="lazy"/></p>
<p>所以在后面一个<code>上传图片</code>的节点中，
需要选择 <code>n8n binary file</code>，
在 <code>Input Data Field Name</code> 中只需要填 <code>data</code> 即可！</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3dfa36797944944aee411884cfa1a6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=UaqXrykWKNykHNqzmw7Epet0Bx4%3D" alt="" loading="lazy"/></p>
<p>这个参数跟其他节点的拖拽方式不同，只能手动输入，且没有提示！</p>
<p>如果不知道这个的话，可能会花比较多的时间来调试。<br/>
<em>(本人石锤😭)</em></p>
<p>大家也可以直接使用我的模板，没这个烦恼哈哈～</p>
<p>接下来就是解析结果，拿到响应中的 <code>media_id</code>:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6290243e6674e2b963524f3d9f69d3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=4TlsUyu%2BQ%2FLQ7h2JUaLRql9xvGY%3D" alt="PixPin_2025-11-19_22-10-29.png" loading="lazy"/></p>
<p>因为接口返回的是一个JSON格式的字符串，所以需要解码一下才可以拿到里面的值。</p>
<blockquote>
<p>[!TIPS]
这里有一个小技巧，可以使用了一个 Set 节点，在当中使用 JS 的表达式来做解析。<br/>
就不用配置 Code 节点了，简单又快速！</p>
</blockquote>
<p>然后就到最后一步，上传草稿了！</p>
<p>这个节点的核心就是上传的内容:
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/557ae25ab954456ea9cb843cecb1849e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=y7gr6lhkDLx08BRmmdYsriInrSg%3D" alt="PixPin_2025-11-19_22-21-10.png" loading="lazy"/></p>
<p>基本格式如下:</p>
<pre><code class="hljs language-bash" lang="bash">{
   <span class="hljs-string">"articles"</span>: [
      {
         <span class="hljs-string">"title"</span>: <span class="hljs-string">"{{ <span class="hljs-subst">$('mock 数据')</span>.item.json.title }}"</span>,
         <span class="hljs-string">"author"</span>: <span class="hljs-string">"{{ <span class="hljs-subst">$('mock 数据')</span>.item.json.author }}"</span>,
         <span class="hljs-string">"content"</span>: <span class="hljs-string">"{{ <span class="hljs-subst">$('mock 数据')</span>.item.json.content }}"</span>,
         <span class="hljs-string">"thumb_media_id"</span>: <span class="hljs-string">"{{ <span class="hljs-variable">$json</span>.media_id }}"</span>,
         <span class="hljs-string">"need_open_comment"</span>:1,
         <span class="hljs-string">"only_fans_can_comment"</span>:0
      }
   ]
}
</code></pre>
<p>这里还支持更多的字段地址，具体字段看官方文档：
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/448734780efa4ed6bddee4e79541b571~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=h8gDy0SDjTUkJKnzQyyUYWg8XBo%3D" alt="PixPin_2025-11-19_22-23-28.png" loading="lazy"/></p>
<p>如果前面的一切都没有问题，那么节点这个运行完之后，响应结果应该大致如下：
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94b3380c488e49f2b1b6289f9f2d94bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=2%2FUKXr40gPk1xtbS49L1q2tO94Y%3D" alt="PixPin_2025-11-19_22-25-28.png" loading="lazy"/></p>
<p>这时候在你公众号的草稿箱中就可以看到了！
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60efbcc5be04450ca19d2d9628ac249b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=K78pwLTfhFF9%2BzegZuEhfrJhmh4%3D" alt="PixPin_2025-11-19_22-26-55.png" loading="lazy"/></p>
<h2 data-id="heading-4">方法 2：使用社区节点</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/102818d63b62432b8adf5c2ae97a1aa6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=xhXHY9ZQgvX%2FbctrwA3gJn%2Bl0cw%3D" alt="PixPin_2025-11-19_22-28-19.png" loading="lazy"/></p>
<p>这个节点包封装好了一系列的微信接口，包括我们要用到的 3 个接口，所以整个流程非常简单，只需要配置 4 个节点即可。</p>
<p>首先是安装它：
进到 <code>Settings</code>-&gt; <code>Community nodes</code>中，</p>
<p>输入 <strong>n8n-nodes-wechat-offiaccount</strong> 来进行安装</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6513f2dae67d4748ac4882360942ea29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=AqWa0svIZnMT7bP6i3KWZQLf5qU%3D" alt="PixPin_2025-11-19_22-32-27.png" loading="lazy"/></p>
<p>然后在面板的添加节点中搜索 <code>wechat</code> ，选择第一个：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddcbecc887304b249ffae63fb9ee0b44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=KX%2BC8u9DQBQC0uS06obUrug8M3Y%3D" alt="PixPin_2025-11-19_22-34-33.png" loading="lazy"/></p>
<p>滑动到最底下，选择 <code>授权 获取Access Token</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c77848b640af4f03a7da587744fbfafb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=zLKDwD%2B8lhs9yI0UTD4juH5jge0%3D" alt="PixPin_2025-11-19_22-35-29.png" loading="lazy"/></p>
<p>这个节点中先需要配置 <code>AppID</code> 和 <code>AppSecret</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f13fc478b3404e2291f460d9cba21e6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=cgazd1DNC9hBbNSRF8WpSlL05YA%3D" alt="PixPin_2025-11-19_22-36-41.png" loading="lazy"/></p>
<p>然后是下载封面图和上传素材：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91473c15215448ba86ec331ad118ca9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=XuvZG%2BeM6tegOUaotbTy4jpBCQg%3D" alt="PixPin_2025-11-19_22-40-03.png" loading="lazy"/></p>
<p>下载封面图的节点和上面一样，不重复了</p>
<p>上传素材节点 选择<code>素材</code>选项下的第一个：上传永久素材</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08a174a9dc454ad8a15e0fca071bbbe8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=zXlalxzvBXe5YNS8CSIRaxI%2F0rU%3D" alt="PixPin_2025-11-19_22-42-58.png" loading="lazy"/></p>
<p>这里不用改动什么，请求参数都封装好了</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f45a9f8e184e4aa093591d827866e83a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=Z%2Bfrucc7dKEfE30bOzTLLnKYwQ4%3D" alt="PixPin_2025-11-19_22-44-05.png" loading="lazy"/></p>
<p>最后添加上传草稿的节点，</p>
<p>选择 <code>草稿</code> 中的 <code>新建草稿</code>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86116e284ded4d49a6a74fefc48f3b2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=j%2B7PMBFKgd5oInN5b%2BFKYKl7xlw%3D" alt="PixPin_2025-11-19_22-46-22.png" loading="lazy"/></p>
<p>里面也做了很多的封装，只需要传入文章内容即可：
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b47a6314c032463687214556d1f6a8e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=asuak%2FLTXUUtwzY6SCqmTwbf5fo%3D" alt="PixPin_2025-11-19_22-56-40.png" loading="lazy"/></p>
<p>不过文章参数与刚刚的稍有不同，格式如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
         <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"这是我的文章标题2"</span><span class="hljs-punctuation">,</span>
         <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"你的作者名"</span><span class="hljs-punctuation">,</span>
         <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;h1&gt;这是一个大标题&lt;/h1&gt;&lt;p&gt;这里是文章的正文部分，&lt;b&gt;支持 HTML 格式&lt;/b&gt;。你可以从其他节点动态传入这段内容。&lt;/p&gt;&lt;img src='https://mmbiz.qpic.cn/mmbiz_jpg/your_image_url/0?wx_fmt=jpeg' /&gt;"</span><span class="hljs-punctuation">,</span>
         <span class="hljs-attr">"thumb_media_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"kjIYa7yRqi3jD3XlC9XxnShDNVceXTE_iRf55uv19iEOuBgfKKKvrQ3rd3pg17Kj"</span><span class="hljs-punctuation">,</span>
         <span class="hljs-attr">"need_open_comment"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
         <span class="hljs-attr">"only_fans_can_comment"</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span>
      <span class="hljs-punctuation">}</span>
   <span class="hljs-punctuation">]</span>

</code></pre>
<p>运行成功后，结果跟刚刚是一致的
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/637750fed137484cb34df1eb70655ff9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bqm6bqm6bqm6YCg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172960&amp;x-signature=oI49psuFJ%2FSuN3N%2BnbZMdY4Zq8M%3D" alt="PixPin_2025-11-19_22-59-08.png" loading="lazy"/></p>
<h2 data-id="heading-5">最后</h2>
<p>两种方法各种有优缺点，大家根据自己的场景来选择。</p>
<p>有空可以跟着教程自己动手实践一下。</p>
<p>或者公众号后台回复【n8n公众号】获取完整工作流 json 文件，直接接入到自己的工作流中！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gemini 3 Pro 来了！一句话生成完整网站，AI编程能力断层领先]]></title>    <link>https://juejin.cn/post/7574308545525694479</link>    <guid>https://juejin.cn/post/7574308545525694479</guid>    <pubDate>2025-11-19T16:27:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574308545525694479" data-draft-id="7574250031249326114" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gemini 3 Pro 来了！一句话生成完整网站，AI编程能力断层领先"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T16:27:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wwwzhouhui"/> <meta itemprop="url" content="https://juejin.cn/user/3428746411400537"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gemini 3 Pro 来了！一句话生成完整网站，AI编程能力断层领先
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3428746411400537/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wwwzhouhui
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T16:27:34.000Z" title="Wed Nov 19 2025 16:27:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>在AI大模型快速迭代的今天，各家厂商疯狂堆参数、拼算力，动不动就是参数翻倍，但日常用起来的感觉却大同小异。就在大家对"GPT-4.5级"、"性能提升30%"这些宣传话术感到麻木的时候，Google在2025年11月18日悄悄扔出了一个重磅炸弹——Gemini 3.0。</p>
<p>Gemini 3 Pro 是 Google DeepMind 推出的新一代旗舰模型，被官方定义为"世界上多模态理解能力最强的模型"。它不是简单的微调升级，而是从零开始在自家TPU芯片上训练的全新模型，采用稀疏混合专家架构（MoE），万亿级参数但每次查询只激活150-200亿参数。最关键的是，它引入了"Deep Think"深度思维模式，让AI学会了真正的"慢思考"。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b62b181b88f7475a8f93d5dcd0b74f58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=9T2xcG0ICP1bGRjufccTdUsfRPQ%3D" alt="image-20251119235934986" loading="lazy"/></p>
<p>这2天 Gemini 3 Pro 在AI圈简直火爆了，LMArena直接干到1501分霸榜第一。今天我们就来手把手带大家体验一下这个号称"史上最强前端开发模型"的真实能力，看看它到底有多离谱。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcaa6a6b68ad4aa48a2099a1d33a7ccd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=3MNGNCrhx5yNuBIq7%2BwosxFdDSE%3D" alt="image-20251119233133775" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">项目介绍</h2>
<h3 data-id="heading-2">✨ 核心特性</h3>
<ul>
<li><strong>🚀 原生多模态</strong>: 从训练之初就用图像、视频、音频和文本混合训练，跨模态推理能力前所未有</li>
<li><strong>🧠 Deep Think模式</strong>: 引入System 2深度思维，复杂问题会先内部多步推理再输出</li>
<li><strong>💻 Vibe Coding</strong>: 氛围编程能力，一句话就能生成完整可交互的网页应用</li>
<li><strong>👁️ 屏幕理解</strong>: ScreenSpot-Pro得分72.7%，碾压GPT-5.1的3.5%，真正能"看懂"UI</li>
<li><strong>📊 超长上下文</strong>: 100万Token上下文窗口，64K Token最大输出</li>
<li><strong>🎯 低幻觉率</strong>: 幻觉率约6.3%，对比GPT-4o的15.8%大幅降低</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a296a8316054ca1809e6eadc9868733~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=SkAzQdt7QP2VwcFG2dKH9NMq11I%3D" alt="image-20251119233829993" loading="lazy"/></p>
<h3 data-id="heading-3">🏆 基准测试表现</h3>















































<table><thead><tr><th>测试项目</th><th>Gemini 3 Pro</th><th>GPT-5.1</th><th>差距</th></tr></thead><tbody><tr><td>Humanity's Last Exam</td><td><strong>37.5%</strong></td><td>26.5%</td><td>+11%</td></tr><tr><td>ARC-AGI-2 (视觉推理)</td><td><strong>31.1%</strong></td><td>17.6%</td><td>+13.5%</td></tr><tr><td>ScreenSpot-Pro (UI理解)</td><td><strong>72.7%</strong></td><td>3.5%</td><td>+69.2%</td></tr><tr><td>Video-MMMU (视频理解)</td><td><strong>87.6%</strong></td><td>80.4%</td><td>+7.2%</td></tr><tr><td>AIME 2025 (数学)</td><td><strong>95.0%</strong></td><td>94.0%</td><td>+1%</td></tr><tr><td>LiveCodeBench (编程)</td><td><strong>2439 Elo</strong></td><td>2243 Elo</td><td>+196</td></tr></tbody></table>
<p>好家伙，这个ScreenSpot-Pro的差距简直是降维打击，GPT-5.1几乎是"屏幕盲"，而Gemini 3能精准理解各种软件界面，这才是构建GUI自动化代理的核心能力。</p>
<h3 data-id="heading-4">🛠️ 技术架构</h3>
<p><strong>模型架构</strong></p>
<ul>
<li><strong>类型</strong>: 稀疏混合专家 (Sparse MoE)</li>
<li><strong>参数</strong>: 万亿级总参数，每次激活150-200亿</li>
<li><strong>训练</strong>: 自家TPU芯片从零训练</li>
</ul>
<p><strong>推理能力</strong></p>
<ul>
<li><strong>Deep Think</strong>: 推理时间计算扩展，多路径探索+自我验证</li>
<li><strong>System 2</strong>: 慢思考模式，先规划再执行</li>
</ul>
<hr/>
<h2 data-id="heading-5">功能演示</h2>
<p>话不多说，我们直接上实战案例，让大家感受一下Gemini 3 Pro到底有多强。</p>
<h3 data-id="heading-6">案例一：一键复刻数据仪表盘</h3>
<p>这是Gemini 3 Pro最让人震撼的能力之一——截图复刻。你只需要给它一张网页截图，加上简单的描述，它就能给你生成一个完整可交互的网页。</p>
<p><strong>提示词：</strong></p>
<pre><code class="hljs">复刻截图中的网页
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af392e91d2b1467bbb36da9e34b2c099~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=Li5VXOy5oDjPTEmSYEVpqgBYs0I%3D" alt="微信图片_20251119003732_642_296" loading="lazy"/></p>
<p>是不是非常简单？就这么一句话，Gemini 3 Pro直接生成了一个完整的Product Performance Dashboard，包括：</p>
<ul>
<li>深色主题的仪表盘界面</li>
<li>产品洞察卡片和数据可视化</li>
<li>Freeform表格和趋势图表</li>
<li>完整的交互效果</li>
</ul>
<p>这个设计最大的特点是深邃的背景、橙色的强调色以及精细的数据可视化图表。传统的做法需要设计师画图、前端开发切图写代码，现在一句话就搞定了。</p>
<h3 data-id="heading-7">案例二：Chrome应用商店复刻</h3>
<p>再来看一个更复杂的案例——复刻Chrome应用商店。</p>
<p><strong>提示词：</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">这是一个使用 React 和 Tailwind CSS 构建的 Chrome 应用商店 (Chrome Web Store) 的复刻版本。
它包含了以下核心功能和视觉元素：
<span class="hljs-bullet">1.</span> 响应式布局
<span class="hljs-bullet">2.</span> 卡片式设计
<span class="hljs-bullet">3.</span> 交互功能：搜索过滤、分类切换、悬停效果
<span class="hljs-bullet">4.</span> Mock 数据
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f27afa760a6948b2b2f85cce8c63b3f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=V4R3i7XLfGb%2Bp1YC5XzsU6k1R%2Bk%3D" alt="微信图片_20251119135921_656_296" loading="lazy"/></p>
<p>看看这个效果！左侧导航栏、顶部搜索栏、主要内容区域，还有各种扩展程序的卡片，甚至连评分、用户数量这些细节都有。点击左侧导航的"扩展程序"或"主题背景"可以切换视图，搜索框也是可以实时过滤的。</p>
<h3 data-id="heading-8">案例三：SVG动画生成</h3>
<p>这个能力Gemini 3 Pro简直是断档第一，来看看这些案例：</p>
<p><strong>八缸发动机动画：</strong></p>
<pre><code class="hljs">帮我用SVG绘制一个八缸发动机的物理结构动画
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9dc9830fea4641999a4098f746148d92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=MYmbn5M0tH22VVfy%2FCj6rB2YPMM%3D" alt="20251119" loading="lazy"/></p>
<p>还有经典的电风扇、咖啡机工作原理、内燃机结构，全都能做出来。</p>
<h3 data-id="heading-9">案例四：3D场景与游戏</h3>
<p><strong>3D魔方模拟：</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">创建一个<span class="hljs-number">3</span>D魔方模拟，包含<span class="hljs-string">"打乱"</span>和<span class="hljs-string">"解决"</span>按钮，两个按钮都会播放流畅的动画
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f13925ad78214b6aad2266d8d19c34e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=2FJd71oH5AHDkBDA75KXziHfNXE%3D" alt="20251119-2" loading="lazy"/></p>
<p><strong>3D山脉场景：</strong></p>
<pre><code class="hljs language-css" lang="css">创建一个 <span class="hljs-number">3</span>D <span class="hljs-selector-tag">HTML</span> 山脉场景，包含悬崖、河流和昼夜光照变化。支持拖动和缩放、动画过渡、真实感渐变色，并可切换等高线显示
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cbce47d09da14bb89f7e822d6271edf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=sKR4mMwNMpVK0u0yOjMbf30HXYg%3D" alt="20251119-3" loading="lazy"/></p>
<h3 data-id="heading-10">案例五：Neobrutalist创意网页</h3>
<p>来看看Gemini 3 Pro的"氛围编程"能力：</p>
<p><strong>提示词：</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">Make a neobrutalist webpage, make it extremely creative, <span class="hljs-keyword">as</span> far <span class="hljs-keyword">as</span> possible, push the limits
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/409e8a7582b44269bd6778c953970ca4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=jfUNt%2FNDEAUbGd3rI%2Bc6%2B5BCIyw%3D" alt="image-20251119235726222" loading="lazy"/></p>
<p>总生成时间大概89秒，结果出来直接让人"卧槽"——不仅可以对话，还可以不断增加贴纸，如果不告诉我这是AI生成的，我会以为是哪个设计师的作品集。</p>
<h3 data-id="heading-11">案例六：Neo-Matrix风格网站</h3>
<p><strong>提示词：</strong></p>
<pre><code class="hljs language-scss" lang="scss">生成一个Neo-Matrix 风格的单页网站。
要求：
- 粗野主义美学与黑客帝国冷峻感极致融合
- 主色调：<span class="hljs-selector-id">#000000</span> (黑), <span class="hljs-selector-id">#00FF41</span> (矩阵绿), <span class="hljs-selector-id">#FF0000</span> (警告红), <span class="hljs-selector-id">#0000FF</span> (程序蓝)
- 核心元素：全屏数字雨背景，巨大且粗糙的命令行界面风格交互区域
- 交互：模拟系统错误或选择分支 (Red Pill/Blue Pill) 的极端用户引导
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd517dc638144b068a8f091e4539b2c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=hYrTv3oMaBAzJfFpPsetmWVtv%2FY%3D" alt="20251119-6" loading="lazy"/></p>
<p>包含entry页面，还有经典的红蓝药丸交互功能。选蓝色会被嘲讽，选红色进入Matrix界面，背后还有红色的数字雨，真的是太帅了！</p>
<h3 data-id="heading-12">案例七：三大不可能任务</h3>
<p><strong>中国象棋残局游戏：</strong></p>
<p>之前没有一个AI可以用单一HTML文件做出中国象棋残局游戏，Gemini 3 Pro一次就做出来了，可以玩，有多个关卡，速度还快。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f30d1e836694efdb1b0cb7e50957d94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=3wx1A0GWKaV68ss%2FG78YiIOAmAg%3D" alt="image-20251119233628865" loading="lazy"/></p>
<p><strong>AI原生操作系统：</strong></p>
<pre><code class="hljs">制作一个 AI 原生的操作系统，比Windows更美更好用
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6eabfb6894e749b08ea59a6bf2cfcda3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=R4PVkznkB8Z1F%2BSEMbgeGQXKmKQ%3D" alt="image-20251119233607595" loading="lazy"/></p>
<p>果然让人眼前一亮——桌面没有任何图片和传统UI交互界面，就只有一个输入框。输入"工作模式"，桌面就变成你每天需要工作的任务、日程、项目文档；输入"娱乐模式"，就变成看剧、玩游戏、聊天的界面。这才是真正的AI原生操作系统，去App化，界面随内容和语境实时变化。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c23090ae55dc4c888b9d857fb633d7ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=oe2fsmhjn%2BfFgJ5NaqmN0eU5EHg%3D" alt="image-20251119233640983" loading="lazy"/></p>
<p><strong>文献修复：</strong></p>
<p>识别破损文献的文字内容，并推理出完整内容。先用OCR识别能识别的文字，不能识别的用...，然后使用AI推理补全。这个对考古文献修复等实际工作将会有很大帮助。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7337398e7b2a4a23bd46cecf3d03c710~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=mcoIsrCUAQwH0JdjjlJ8SSXoNBY%3D" alt="image-20251119233657915" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/255c46d004c84af4a25145898d1dd9d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=sG4LIStmjzRlzTd9%2FwEWNnnF3hM%3D" alt="image-20251119233708962" loading="lazy"/></p>
<h3 data-id="heading-13">视频演示</h3>
<p>下面是一些实际操作的视频演示，可以更直观地感受Gemini 3 Pro的能力：</p>
<p><strong>视频1：功能演示</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/525a793a1ec04b58908bdd3c25141742~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=TktQyKq6cto3R1euXN0f%2B49QB9A%3D" alt="微信视频2025-11-19_221112_391" loading="lazy"/></p>
<p><strong>视频2：交互效果</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e1053706e8f4ffcb9e4de560e86a5cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=AhGuW%2FWzC0TJgBNRxA2LTkGjDOU%3D" alt="微信视频2025-11-19_221127_163" loading="lazy"/></p>
<p><strong>视频3：生成过程</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/52c1f50a380d442e94a98194f0fec0d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764174454&amp;x-signature=dPVu75%2BTXkRuU%2FW7AjVQ8bCDpUs%3D" alt="微信视频_20251119221119" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-14">体验方式</h2>
<p>Gemini 3 Pro的体验方式已经很多了：</p>
<ul>
<li><strong>Gemini App</strong>: 官方应用，部分功能内测中</li>
<li><strong>Google AI Studio</strong>: 推荐使用Build模式，免费体验</li>
<li><strong>Gemini CLI</strong>: 命令行工具</li>
<li><strong>Antigravity</strong>: Google新推出的代理优先IDE</li>
<li><strong>Cursor/flowith</strong>: 第三方集成</li>
</ul>
<h3 data-id="heading-15">API定价</h3>




















<table><thead><tr><th>上下文范围</th><th>输入价格</th><th>输出价格</th></tr></thead><tbody><tr><td>200k以内</td><td>$2.00/百万Token</td><td>$12.00/百万Token</td></tr><tr><td>200k以上</td><td>$4.00/百万Token</td><td>$18.00/百万Token</td></tr></tbody></table>
<p>这个价格在高端模型市场中极具竞争力，而且Google AI Studio目前提供慷慨的免费额度。</p>
<hr/>
<h2 data-id="heading-16">总结</h2>
<p>今天主要带大家了解并体验了Google Gemini 3 Pro的各种惊艳能力，该模型以"原生多模态+Deep Think深度思维"为核心优势，结合Vibe Coding氛围编程理念，通过稀疏混合专家架构与推理时间计算扩展技术，形成了一套从自然语言描述到完整应用生成的全链路AI编程解决方案。通过这套能力，开发者和设计师能够高效突破传统编码门槛——借助简单的提示词描述（包括截图复刻、系统模拟、SVG动画生成），无需编写大量代码，就能快速生成完整可交互的网页应用（如本次演示的数据仪表盘、Chrome商店复刻、Neo-Matrix风格网站）。</p>
<p>无论是前端界面开发、3D场景构建，还是游戏模拟器制作、AI原生操作系统概念验证，都能通过一句话提示词完成，极大提升了开发效率和创意落地速度。在实际应用中，Gemini 3 Pro不仅在ScreenSpot-Pro屏幕理解测试中以72.7%碾压GPT-5.1的3.5%，还在Vending-Bench代理任务中取得了271%的性能优势，适配性远优于传统代码生成方案；特别是通过Deep Think模式的多路径推理和自我验证机制，有效解决了AI幻觉和逻辑陷阱的难题。</p>
<p>同时，方案具备良好的扩展性——小伙伴们可以基于此扩展更多应用场景，如企业数据可视化、教育互动演示、产品原型快速验证等，进一步发挥AI编程能力在前端开发、创意设计、产品原型等领域的应用价值。感兴趣的小伙伴可以通过Google AI Studio的Build模式进行实践，根据实际需求调整提示词描述。今天的分享就到这里结束了，我们下一篇文章见。</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[企业如何平衡AI创新与风险]]></title>    <link>https://juejin.cn/post/7574271557939445811</link>    <guid>https://juejin.cn/post/7574271557939445811</guid>    <pubDate>2025-11-19T14:58:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574271557939445811" data-draft-id="7574322843048345650" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="企业如何平衡AI创新与风险"/> <meta itemprop="keywords" content="人工智能,云计算,云原生"/> <meta itemprop="datePublished" content="2025-11-19T14:58:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AKAMAI"/> <meta itemprop="url" content="https://juejin.cn/user/829502942352628"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            企业如何平衡AI创新与风险
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/829502942352628/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AKAMAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T14:58:52.000Z" title="Wed Nov 19 2025 14:58:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>生成式AI的全球支出预计将在2025年达到6440亿美元，较2024年激增76%。这一数据传递出明确信号：企业普遍认为，若在AI应用领域落后，企业将面临生存危机。然而，尽管AI技术已无处不在，但其应用仍持续引发企业领导层的忧虑——从安全隐患到运营挑战，诸多问题亟待解决。</p>
<p>关于AI的潜在风险与弊端是否值得其宣称的巨大收益，业界始终存有疑虑。尽管创新承诺能带来客户体验与运营效率的变革性提升，但将AI深度嵌入现有运营体系所伴随的风险，亦可能引发严重后果。</p>
<h4 data-id="heading-0"><strong><strong>寻找平衡点</strong></strong></h4>
<p>技术领导者面临一项”平衡”挑战：企业如何在积极开拓AI疆土的同时，避免为自身埋下难以承受的风险隐患。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Flp%2Fforrester-enterprise-ai-report-2025%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejing_251119_external1_blogarticles228" target="_blank" title="https://www.akamai.com/zh/lp/forrester-enterprise-ai-report-2025?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejing_251119_external1_blogarticles228" ref="nofollow noopener noreferrer">由Akamai委托、Forrester进行的一项新研究</a>，就企业目前如何实现这种平衡提供了一些答案。该研究通过对400名高级AI和企业云战略决策者进行调研，揭示了组织如何在快速捕获价值的同时，建立必要的防护措施来保护其业务。</p>
<h4 data-id="heading-1"><strong><strong>企业如何确定AI场景的优先级</strong></strong></h4>
<p>Forrester的研究明确指出，企业领导者正将AI直接融入核心业务目标，使其成为业务战略的核心。即便如此，领导者们也谨慎地优先考虑低风险、高回报的应用。</p>
<p>受访者指出了推动AI投资的三大首要目标：</p>
<ul>
<li>改善客户体验（76%）</li>
<li>提高运营效率（76%）</li>
<li>加强客户留存（71%）</li>
</ul>
<p>其他研究持续表明，客户体验的改善与收入增长、客户流失减少和更强的竞争优势直接相关。</p>
<p>例如，麦肯锡公司指出："……全球最成功的高增长企业所创造的价值中，80%来自核心业务——主要是从现有客户中挖掘新收益。"</p>
<p><strong><strong>最高优先级的AI场景最贴近客户</strong></strong></p>
<p>因此，企业领导者并非因为需要保持竞争力而使用AI，而是谨慎地将这种新技术与影响收入和增长的可衡量成果挂钩。这就解释了为什么最高优先级的AI使用案例是那些最贴近客户的场景。</p>
<p>超过一半的组织正在将AI应用用于个性化（53%）、自动化客户解决流程（53%）和回答客户问题（52%）。与更具实验性的用例相比，这些应用风险相对较低，但能带来快速、有形的投资回报。</p>
<p>通过专注于直接的客户体验改善，公司可以产生回报，为进一步的探索提供资金，同时也能让团队和基础设施为更宏大的计划做好准备。</p>
<h4 data-id="heading-2"><strong><strong>采用AI的风险格局</strong></strong></h4>
<p>Forrester的研究也呼应了企业领导者从一开始就对AI存在的一些担忧。他们最关心的AI问题包括：</p>
<ul>
<li>网络安全风险</li>
<li>合规性挑战</li>
<li>声誉损害</li>
<li>财务损失</li>
</ul>
<p><strong><strong>网络安全风险</strong></strong></p>
<p>63%的受访者担心网络安全风险。AI系统引入了新的攻击面，并为威胁行为者扩大了现有的攻击面。诸如模型投毒、提示注入和数据窃取之类的威胁，已在现实场景中出现。当面向客户的应用程序依赖AI进行决策时，即使是微小的漏洞也可能级联成重大的安全漏洞。</p>
<p><strong><strong>合规性挑战</strong></strong></p>
<p>随着政府颁布新的AI驱动法规，如欧盟《人工智能法案》、美国监管框架以及特定行业指南，企业在扩展AI规模时面临着合规障碍。与传统软件不同，AI引入了可解释性、可审计性和偏见缓解等独特问题。未能达到法规要求可能导致处罚、法律风险部署停滞。</p>
<p><strong><strong>声誉损害</strong></strong></p>
<p>AI故障往往会<strong><strong>迅速曝光</strong></strong>。有偏见的推荐系统或胡言乱语的聊天机器人，随时可能登上新闻头条。客户数据隐私也可能因此泄露。对于面向客户的应用场景而言，此类失误远不止是技术问题——更会重创品牌形象。而重建用户对企业的信任，注定代价高昂。</p>
<p><strong><strong>财务损失</strong></strong></p>
<p>实施不当的AI可能导致客户流失、机会丧失和投资浪费。例如，如果零售业的AI聊天机器人提供了误导性的财务建议，公司可能不仅面临监管罚款和诉讼，还会遭遇消费者的强烈反对，这将削弱AI系统本应实现的客户留存收益。</p>
<p>这些风险的后果有可能像滚雪球一样演变成严重的业务中断，这就是为什么领导者必须谨慎采用AI，必须仔细平衡创新的风险与回报。</p>
<h4 data-id="heading-3"><strong><strong>企业如何实现这种平衡</strong></strong></h4>
<p>尽管AI的回报是否大于风险仍有待观察，但当今的企业并非无能为力。根据Forrester的研究，领导者们可以在以下方面相互借鉴：</p>
<ul>
<li>迭代式采用</li>
<li>用于AI训练和推理的托管服务</li>
<li>云原生和开源技术的采用</li>
<li>强大的供应商生态系统</li>
<li>跨职能治理</li>
</ul>
<p><strong><strong>迭代式采用</strong></strong></p>
<p>许多组织并非全力投入雄心勃勃的生成式AI项目，而是从小处着手。通过在受控的场景（如客户服务自动化）中推出AI，他们可以在不危及关键运营的情况下获得经验。这种迭代模式使他们能够负责任地进行测试、学习和扩展。</p>
<p><strong><strong>用于AI训练和推理的托管服务</strong></strong></p>
<p>构建和维护AI基础设施非常复杂，企业越来越依赖托管服务来进行模型训练和推理。这减少了运营负担，并使专业知识的获取变得更加容易。</p>
<p>通过外包高风险任务，组织在加速部署的同时也最小化了风险暴露。关键在于选择那些与自身具有相似安全和风险缓解标准的公司提供的服务。</p>
<p><strong><strong>云原生和开源技术的采用</strong></strong></p>
<p>调查数据还显示，企业正在尝试<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Fglossary%2Fwhat-is-cloud-native%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejing_251119_external2_blogarticles228" target="_blank" title="https://www.akamai.com/zh/glossary/what-is-cloud-native?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejing_251119_external2_blogarticles228" ref="nofollow noopener noreferrer">云原生</a>和开源AI技术。云原生架构提供了可扩展性和弹性，而开源技术则提供了灵活性和速度，这两者对于AI采用和技术更新都是必需的。这为企业带来了架构上的灵活性，同时规避了长期受制于特定供应商的风险。</p>
<p><strong><strong>强大的供应商生态系统</strong></strong></p>
<p>鉴于AI采用的复杂性，许多组织正在优先考虑那些拥有成熟AI专业知识的供应商。这些合作伙伴不仅帮助企业应对技术问题，还帮助应对合规性、可扩展性和安全性。强大的供应商生态系统支持AI风险缓解策略。</p>
<p><strong><strong>跨职能治理</strong></strong></p>
<p>或许最重要的是，组织认识到AI治理不能仅仅由IT部门负责。领先的企业从一开始就创建涉及合规、法律和安全团队的跨职能治理框架。这种整体方法确保了AI创新符合监管要求和合乎道德的AI标准。</p>
<p>从数据中显现出的主要模式是，公司正在通过结来实现平衡；也就是说，他们正在构建脚手架，使创新和风险管理能够并行推进。</p>
<h4 data-id="heading-4"><strong><strong>基础设施与AI风险管理</strong></strong></h4>
<p>除了运营结构，平衡的AI采用还需要坚实的基础设施。事实上，根据Forrester的研究，55%的企业将技术和平台差距列为其采用AI的首要挑战。</p>
<p>传统的云平台并非为性能敏感的AI工作负载（如大规模推理）的独特需求而设计。延迟、成本效率低下以及数据本地化控制不足，都会带来风险——从客户体验下降到合规审计中更高的风险暴露。</p>
<p>企业正在通过探索专为AI性能构建的替代方案来重新思考其基础设施战略。他们通过使用为分布式工作负载、低延迟推理和内置安全而优化的平台来实现这一目标。</p>
<p>简而言之，基础设施不仅仅是AI技术的基础；它也是风险方程中的一个活跃部分。选择错误的基础设施会放大漏洞。选择正确的基础设施则可以将AI从负债转变为长期的竞争优势。</p>
<h4 data-id="heading-5"><strong><strong>现在缓解风险，为了未来创新</strong></strong></h4>
<p>企业AI的征程正在快速演变。早期的采用集中于狭窄的场景，随后生成式AI浪潮扩展到内容创作、分析和自动化。</p>
<p>现在，我们正处于下一阶段的风口浪尖：代理型AI。代理型AI构成了具有自主性的系统，能够代表人类行事，并根据现有情境做出决策。这种演进承诺带来进一步的收益，但当然也伴随着前所未有的风险。</p>
<p>AI的每个阶段都既增加了潜在收益，也提高了失败的成本。那些成功的企业，将是那些目前通过迭代采用来构建组织流畅度、投资于具有弹性且性能优化的基础设施、并从一开始就嵌入治理与合规的企业。</p>
<p>现在正是技术决策者重新评估AI解决方案和云战略，特别是其基础设施选择的时候，以确保他们能够负责任地扩展，并将道德考量放在心上。</p>
<p><strong><strong>了解更多</strong></strong></p>
<p>要更深入地了解400位高级决策者如何应对AI开发与采用，请下载完整的Forrester报告：《<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Flp%2Fforrester-enterprise-ai-report-2025%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejing_251119_external3_blogarticles228" target="_blank" title="https://www.akamai.com/zh/lp/forrester-enterprise-ai-report-2025?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejing_251119_external3_blogarticles228" ref="nofollow noopener noreferrer">企业级 AI 现状：积累经验，管控风险</a>》。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[为什么实时更新场景下 Doris 查询性能是 ClickHouse 的 34 倍]]></title>    <link>https://juejin.cn/post/7574269207363043337</link>    <guid>https://juejin.cn/post/7574269207363043337</guid>    <pubDate>2025-11-19T15:26:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574269207363043337" data-draft-id="7574269207362977801" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="为什么实时更新场景下 Doris 查询性能是 ClickHouse 的 34 倍"/> <meta itemprop="keywords" content="数据库"/> <meta itemprop="datePublished" content="2025-11-19T15:26:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SelectDB"/> <meta itemprop="url" content="https://juejin.cn/user/3189021726222904"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            为什么实时更新场景下 Doris 查询性能是 ClickHouse 的 34 倍
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3189021726222904/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SelectDB
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T15:26:28.000Z" title="Wed Nov 19 2025 15:26:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读24分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在当今数据驱动的商业环境中，企业越来越依赖数据分析来驱动决策。无论是用户行为分析、业务报表还是运营监控，企业都需要具备快速、高效的数据处理能力。企业在数据分析能力上的演进，往往始于 TP（事务处理）系统，随着业务发展不断探索 TP 系统的扩展方案，最终走向构建独立的 AP（分析处理）系统。</p>
<h2 data-id="heading-0">企业实时分析典型演进过程</h2>
<h3 data-id="heading-1">第一阶段：使用 TP 系统支撑事务处理和数据分析</h3>
<p>在企业信息系统建设的早期，主要存储在 OLTP（在线事务处理）系统中，比如 PostgreSQL、MySQL、SQL Server 等。因为数据“就在那儿”，最自然的方式就是直接从 TP 系统中执行 SQL 查询来获取所需分析数据：</p>
<ul>
<li>查询订单、用户、库存、交易等业务数据；</li>
<li>生成运营报表，支撑内部管理；</li>
<li>快速开发查询接口，满足临时的 BI 需求。</li>
</ul>
<p>在业务初期，数据规模有限，分析需求也相对简单，系统架构轻量，能够高效支撑当下业务，避免了多系统部署和复杂数据流带来的额外成本与运维压力。然而，随着业务快速发展，数据量迅速增长，分析场景愈发复杂，查询延迟上升，事务与分析负载相互影响，原有系统逐渐难以支撑持续扩展的业务需求。</p>
<h3 data-id="heading-2">第二阶段：探索 TP 系统的扩展方案</h3>
<p>为了在不破坏 TP 系统稳定性的前提下支撑持续扩展的业务需求，部分企业开始尝试基于 TP 的扩展方案。以下是行业中常见的做法与代表系统：</p>
<p><strong>1. 分片与分布式扩展：Citus、TiDB、Vitesse</strong></p>
<p>这些系统具备了基于关系数据库的水平扩展能力，使 TP 系统可以存储更大规模的数据并处理更高并发。</p>
<ul>
<li><strong>Citus</strong>：是 PostgreSQL 的分布式扩展插件，可将表自动切分到多个节点，实现并行处理和查询加速。</li>
<li><strong>TiDB</strong>：兼容 MySQL 协议的分布式 HTAP 数据库，事务与分析融合，适用于在线业务+报表的场景。</li>
<li><strong>Vitesse</strong>：基于 MySQL 的分布式中间件，解决数据库扩展、容错和自动化问题，常用于大规模 TP 系统。</li>
</ul>
<p><strong>2. 读写分离与多副本架构：Amazon Aurora</strong></p>
<ul>
<li><strong>Amazon Aurora</strong> 提供了高性能、弹性扩展的云数据库，并支持最多 15 个只读副本，用于分担查询压力。这类方案适用于中等复杂度的分析任务，但在海量数据和复杂查询面前，Aurora 等 TP 架构依然面临查询瓶颈。</li>
</ul>
<p>这些方案虽然在一定程度上缓解了单机性能瓶颈，但本质仍属于 TP 系统架构，难以根本解决事务与分析并存所带来的矛盾。面对大规模、多维度的聚合分析，这类系统能力有限，查询操作常常干扰写入，导致系统性能波动，影响整体稳定性。同时，架构复杂、运维门槛高，随着写入量和查询压力的持续上升，资源消耗不断加剧，系统成本快速攀升，性能瓶颈也日益显现。尤其在高吞吐数据导入和实时更新方面能力不足，限制了对业务变化的快速响应。而 TP 系统以行存为主的特性，使其在处理 TB 级以上数据的分析任务时，性能与专为分析设计的 AP 系统存在显著差距，难以胜任更复杂、更大规模的分析需求。</p>
<h3 data-id="heading-3">第三阶段：复杂分析使用 AP 系统</h3>
<p>随着数据量不断增长、分析需求日益复杂，很多企业逐渐意识到，无法再依赖原有的 TP 系统同时满足事务处理与分析需求。因此，企业通常会将一些复杂的分析查询迁移到专门的 AP 系统中，例如 Redshift、Snowflake、BigQuery 等，用于支撑大规模的数据分析任务。而对于对实时性要求高、并发量大的查询，仍会保留在 TP 系统中运行，以确保系统的快速响应和稳定性。在一些高并发场景中，数据甚至会在 AP 系统中完成加工处理后，回流到 TP 系统中，进一步支撑实时查询和业务服务。</p>
<h3 data-id="heading-4">第四阶段：拥抱 AP 系统，实现分析计算与事务的解耦</h3>
<p>随着数据规模持续扩大，事务处理系统（TP）的数据导入速度难以跟上行为数据生成的节奏，导致数据延迟持续增加。与此同时，部分复杂查询被转移到分析处理系统（AP）执行，其他分析任务仍在 TP 系统中完成，这使得系统运维难度和资源成本不断攀升，远超专门的 AP 系统。</p>
<p>下表总结了 OLTP 与 OLAP 在关键维度上的主要区别，便于理解两者在架构定位上的差异。</p>
<h3 data-id="heading-5">OLTP vs OLAP 对比</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b704c567eadc4c87be94e82bfcf419f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=1HrTGzPtWI6tYx6jx0dwURwYfQo%3D" alt="OLTP vs OLAP 对比.jpeg" loading="lazy"/></p>
<p>面对这种挑战，越来越多企业开始认识到：对于实时分析场景，采用具备高并发与高性能的一体化 AP 系统来统一承载，能够大幅提升效率；而批量处理和离线分析等需求，则可以选择更适合的 AP 系统来完成。这样不仅优化了整体架构，也有效控制了成本，同时提升了数据分析能力，助力企业实现更加高效的数据驱动运营。</p>
<p>实时数据需求直接导入实时 OLAP 系统，常见做法是将事务处理系统（TP）与分析处理系统（AP）解耦，通过变更数据捕获（CDC）技术，实现 TP 系统数据的实时同步，同时行为数据也直接写入实时 OLAP。实时 OLAP 系统需具备快速更新能力和高效查询性能。该架构不仅避免了对核心业务系统的影响，还使企业能够第一时间获取并分析最新数据，广泛应用于用户行为分析、实时报表、风险监控等关键场景，显著提升了数据决策的及时性和价值。</p>
<h2 data-id="heading-6">OLAP 系统的选择：为什么是 Apache Doris？</h2>
<p>Apache Doris 适合大数据量下需要高并发查询、AdHoc 和实时数据更新的场景：</p>
<h3 data-id="heading-7">低延迟高吞吐写入</h3>
<p>支持多种数据导入方式，通过 <code>Stream Load</code> 可实现数据<strong>秒级可见</strong>、单节点写入吞吐可达<strong>百万行/秒</strong>，轻松满足海量数据的实时入库需求。</p>
<h4 data-id="heading-8">用户案例：网易云音乐</h4>
<p>网易云音乐作为知名音乐流媒体平台，每天产生大量用户行为数据、业务数据及日志数据，这些数据在异常行为跟踪、客诉问题定位、运行状态监控、性能优化等方面扮演守护者的角色。面对每日万亿级别数据的增量，<strong>网易云音乐选择使用 Apache Doris 替换 ClickHouse 构建新的日志平台，目前已稳定运行 3 个季度，规模达到 50 台服务器，2PB 数据，每天新增日志量超过万亿条，峰值写入吞吐达 6GB/s。</strong></p>
<p><strong>在低延迟高吞吐写入场景中</strong>，网易云音乐采用 Flink + Doris Connector 实现流式数据无缝对接，通过多项关键优化措施显著提升了写入性能：</p>
<ul>
<li><strong>写入流程优化</strong>：在 append 数据操作时，直接写入压缩流，无需经过 ArrayList 中转，大幅降低内存使用，TM 内存占用从 8G 降至 4G，有效避免了因 batch size 设置过高导致的 OOM 问题。</li>
<li><strong>单 tablet 导入功能</strong>：开启单 tablet 导入功能（要求表使用 random bucket 策略），极大提升写入性能，解决了写入 tablet 过多时元数据产生过多影响写入性能的问题。</li>
<li><strong>负载均衡优化</strong>：每个 batch flush 完成后随机选择 BE 节点写入数据，解决 BE 写入不均衡问题，相较之前导入性能提升 70%。</li>
<li><strong>容错能力增强</strong>：调整 failover 策略，优化重试逻辑并增加重试时间间隔，当 FE/BE 发生单点故障时能自动感知和重试恢复，保证服务高可用。</li>
</ul>
<p><strong>在元数据性能优化方面</strong>，针对 HDD 硬盘环境下 Stream Load 耗时突增问题，通过调整 3 台 Follower FE 为异步刷盘模式，实现了 4 倍性能提升，有效解决了同步元数据阶段的严重耗时问题。</p>
<p><strong>整体收益显著</strong>：查询响应整体 P99 延迟降低 30%，并发查询能力从 ClickHouse 的 200 提升至 500+，写入稳定性大幅改善，运维成本显著降低，在坏盘和宕机场景下实现自恢复能力。</p>
<p>完整阅读：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.selectdb.com%2Fblog%2F1369" target="_blank" title="https://www.selectdb.com/blog/1369" ref="nofollow noopener noreferrer">网易云音乐基于 Apache Doris 的万亿级日志平台建设实践</a></p>
<h3 data-id="heading-9">实时更新能力强</h3>
<p>配合主流数据同步工具（如 Kafka、Canal、DataX、SeaTunnel 等）可实现从 TP 系统到 Doris 的准实时数据同步。其“Merge-on-Write”的更新机制兼顾写入性能与更新效率，适配主流 CDC 场景。</p>
<h4 data-id="heading-10">用户案例 ：中通快递</h4>
<p>随着中通快递业务的持续增长，昔日双 11 的业务高峰现已成为每日常态，原有数据架构在数据时效性、查询效率、与维护成本方面，均面临着较大的挑战。为此，中通快递引入 SelectDB，借助其高效的数据更新、低延时的实时写入与优异的查询性能，在快递业务实时分析场景、BI 报表与离线分析场景、高并发分析场景中均进行了应用实践。</p>
<p><strong>在实时分析场景中，基于 SelectDB 灵活丰富的 SQL 函数公式、高吞吐量的计算能力，实现了结果表的查询加速，能够达到每秒上 2K+ 数量级的 QPS 并发查询，数据报表更新及时度大大提高。</strong></p>
<p>SelectDB 的引入满足了复杂与简单的实时分析需求。目前，SelectDB 日处理数据超过 6 亿条，数据总量超过 45 亿条，字段总量超过 200 列，并实现服务器资源节省 2/3、查询时长从 10 分钟降至秒级的数十倍提升。</p>
<p>案例回顾：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1eF6HY9Ecr%2F" target="_blank" title="https://www.bilibili.com/video/BV1eF6HY9Ecr/" ref="nofollow noopener noreferrer">中通快递基于 SelectDB 实时数仓的应用实践</a></p>
<h3 data-id="heading-11">极致的查询性能</h3>
<p>Doris 天生为分析优化，具备列式存储、向量化执行引擎、位图索引、多级缓存、物化视图等优化手段，能够支撑亚秒级的分析响应时间，并支持复杂的多维分析、聚合与 JOIN 查询。</p>
<h4 data-id="heading-12">用户案例 ：拉卡拉</h4>
<p>拉卡拉（股票代码 300773）是国内首家数字支付领域上市企业，从支付、货源、物流、金融、品牌和营销等各维度，助力商户、企业及金融机构数字化经营。随着实时交易数据规模日益增长，拉卡拉早期基于 Lambda 架构构建的数据平台面临存储成本高、实时写入性能差、复杂查询耗时久、组件维护复杂等问题。<strong>拉卡拉选择使用 Apache Doris 替换 Elasticsearch、Hive、HBase、TiDB、Oracle/MySQL 等组件，完成 OLAP 引擎的统一，实现了查询性能提升 15 倍、资源减少 52% 的显著成效。</strong></p>
<p><strong>在极致查询性能场景中</strong>，拉卡拉充分发挥了 Apache Doris 天生为分析优化的多项能力，在金融核心业务中实现了显著的性能提升：</p>
<ul>
<li><strong>风控场景查询优化</strong>：替换 Elasticsearch 后，查询响应时间从 15 秒缩短至 1 秒以内，查询性能提升 15 倍。Doris 的标准 SQL 查询接口和强大的多维分析能力，支持复杂的多表 JOIN、子查询和窗口函数等场景。</li>
<li><strong>对账单系统高并发处理</strong>：借助 Doris 优秀的并发处理和极速查询能力，支持每日亿级数据规模和百万级查询请求，查询 99 分位数响应时长控制在 2 秒以内，数据延迟可控制在 5 秒。</li>
<li><strong>倒排索引加速大表关联</strong>：通过添加倒排索引、调整分桶策略以及表结构优化，大表关联查询耗时从 200 秒缩短至 10 秒，查询效率提升超过 20 倍。</li>
<li><strong>Light Schema Change 灵活变更</strong>：相比 Elasticsearch 需要通过 Reindex 进行 Schema 变更，Doris 的 Light Schema Change 机制更加高效灵活，支持字段和索引的快速增删修改，极大提升了数据管理的便捷性和业务适应性。</li>
</ul>
<p><strong>整体收益显著</strong>：服务器数量下降 52%，开发运维效率大幅提升，通过统一的 OLAP 引擎简化了技术架构，降低了学习成本和运维复杂性。</p>
<p>完整阅读：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.selectdb.com%2Fblog%2F1387" target="_blank" title="https://www.selectdb.com/blog/1387" ref="nofollow noopener noreferrer">拉卡拉 x Apache Doris：统一金融场景 OLAP 引擎，查询提速 15 倍，资源直降 52%</a></p>
<h3 data-id="heading-13">高并发处理能力</h3>
<p>得益于 MPP 架构，Doris 可轻松扩展计算资源，支持海量用户并发访问分析报表，是支撑数据门户、运营后台、用户行为分析等实时应用场景的理想方案。</p>
<h4 data-id="heading-14">用户案例：快手</h4>
<p>快手作为知名短视频平台，OLAP 系统为内外多个场景提供数据服务，每天承载近 10 亿的查询请求。原有湖仓分离架构面临存储冗余、资源抢占、治理复杂等问题。<strong>快手通过引入 Apache Doris 湖仓一体能力替换 ClickHouse，升级为湖仓一体架构，涉及数十万张表、数百 PB 的数据增量处理。</strong></p>
<p><strong>在高并发处理场景中</strong>，Apache Doris 凭借强大的 MPP 架构和分布式查询引擎，为快手提供了卓越的并发查询支撑能力：</p>
<ul>
<li><strong>海量并发查询支撑</strong>：系统每天承载近 10 亿查询请求，覆盖 ToB 系统（商业化报表引擎、DMP、磁力金牛、电商选品）和内部系统（KwaiBI、春节/活动大屏、APP 分析、用户理解中心等）的高并发访问需求。</li>
<li><strong>智能查询路由</strong>：通过查询路由服务分析和预估查询的数据扫描量，将超大查询自动路由到 Spark 引擎，避免大查询占用过多 Doris 资源，确保高并发场景下的系统稳定性。</li>
<li><strong>物化视图透明改写</strong>：结合 Doris 的物化视图改写能力和自动物化服务，实现查询性能提升至少 6 倍，百亿级别以下数据可实现毫秒级响应，有效支撑高并发查询场景。</li>
<li><strong>缓存优化加速</strong>：通过元数据缓存和数据缓存双重优化，元数据访问平均耗时从 800 毫秒降至 50 毫秒，显著提升高并发场景下的查询响应效率。</li>
</ul>
<p><strong>整体收益</strong>：实现了统一存储和链路简化，无需数据导入即可直接访问湖仓数据，在支撑海量并发查询的同时大幅降低了运维复杂度和存储成本。</p>
<p>完整阅读：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.selectdb.com%2Fblog%2F1004" target="_blank" title="https://www.selectdb.com/blog/1004" ref="nofollow noopener noreferrer">快手：从 Clickhouse 到 Apache Doris，实现湖仓分离向湖仓一体架构升级</a></p>
<p><strong>统一数据体验</strong> Doris 提供类 SQL 的接口，兼容 MySQL 协议，易于 BI 工具对接（如 Tableau、Power BI、Superset 等），同时可通过视图、物化视图等能力，提供类似数据仓库的建模支持。</p>
<p>可以满足的典型场景包括：</p>
<ul>
<li><strong>面向用户的实时分析（Customer-Facing Analytics）</strong> 将订单、交易、行为等业务数据从数据库中捕获并同步至实时数仓（如 Apache Doris），支持用户在前端系统中秒级查看订单状态、活动参与情况、积分变化等。提升用户体验的同时，也为推荐、搜索等系统提供最新的数据支持。</li>
<li><strong>运营监控与分析</strong> 运维、客服、市场等部门可以实时查看关键指标（如系统交易量、失败率、退货率），并快速响应业务波动。CDC 保证了数据与业务系统的实时一致性，使监控结果具有可信度。</li>
<li><strong>模型训练与特征回填</strong> 将用户行为日志和业务数据同步到分析库后，ML 工程师可以基于最新数据生成训练样本、回填特征值，显著加快模型迭代速度，提升预测准确率。</li>
<li><strong>多维分析与自助 BI</strong> 将结构化业务数据实时汇聚到 OLAP 系统，结合维度模型，支持业务人员进行灵活多维分析，满足从明细到聚合的多层级洞察需求，减少对开发人员的依赖。</li>
</ul>
<h2 data-id="heading-15">ClickHouse 实时更新原理</h2>
<p>在 ClickHouse 中，虽然底层存储以追加为主，但通过 <code>ReplacingMergeTree</code> 引擎，用户可以实现类似“实时更新”的效果。其核心思想是：在写入时保留所有版本的数据，在后台合并时自动保留最新版本，从而实现数据的“更新”。</p>
<blockquote>
<p>详情<a href="https://link.juejin.cn?target=https%3A%2F%2Fclickhouse.com%2Fdocs%2Fguides%2Fdeveloper%2Fdeduplication" target="_blank" title="https://clickhouse.com/docs/guides/developer/deduplication" ref="nofollow noopener noreferrer">参考文档</a></p>
</blockquote>
<p>具体工作原理如下：</p>
<ol>
<li><strong>写入阶段</strong> 使用 <code>ReplacingMergeTree</code> 创建表时，通常会指定一个唯一标识列（如主键）和一个版本列（如 <code>update_time</code>）。每次对同一主键的数据更新时，系统不会直接覆盖旧数据，而是插入一行新版本的记录。</li>
<li><strong>合并阶段（Merge）</strong> ClickHouse 的后台合并线程会在空闲时自动执行数据文件的合并操作。对于 <code>ReplacingMergeTree</code> 表，合并过程中会根据主键值和版本列，自动保留每组主键下版本最新的记录，删除旧版本，实现最终的“更新”语义。</li>
<li><strong>查询阶段</strong> 查询过程中可能会读到尚未合并的多个版本记录，因此建议设置 <code>FINAL</code> 查询语法，如：</li>
</ol>
<pre><code class="hljs language-SQL" lang="SQL"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_table <span class="hljs-keyword">FINAL</span>;
</code></pre>
<h2 data-id="heading-16">Apache Doris 实时更新原理</h2>
<p>在需要频繁更新数据的场景中，可以使用 Doris 提供的 Unique Key 模型来建表，实现对同一主键的数据进行高效覆盖更新。Doris 通过一种名为标记删除（Delete Bitmap）的机制，有效提升查询性能。与 ClickHouse 查询时进行更新清理的方式不同，Doris 的标记删除机制无需在查询时实时计算删除逻辑，因此可以显著减少查询延迟，确保查询响应时间稳定在百毫秒以内，并支持高并发访问。</p>
<p>具体来说，Doris 的处理分为两个阶段：</p>
<ol>
<li><strong>写入阶段</strong> 在使用 Unique Key 创建表时，您通常会指定一个唯一标识（如主键 ID）和一个版本列（如更新时间 <code>update_time</code>）。每当新数据写入时，如果主键相同且版本更新，Doris 会自动为旧数据打上“删除标记”，这些信息随着数据一同写入底层存储。</li>
<li><strong>查询阶段</strong> 在查询过程中，Doris 会自动识别并跳过那些已被标记删除的旧数据行，无需实时对比或扫描多个版本，从而实现低延迟、高效率的数据读取。</li>
</ol>
<p>借助这套机制，Doris 能够同时满足 <strong>实时更新</strong> 和 <strong>高速查询</strong> 的双重需求，非常适合用于用户画像、订单中心、指标快照等典型更新型分析场景。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcd3c65aa91b457f8a475812b688d2d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=IVmc%2F8Q2YgWLpaQ1Vy3NWTjwJb4%3D" alt="Apache Doris 实时更新原理.png" loading="lazy"/></p>
<h2 data-id="heading-17">性能对比</h2>
<p>当分析负载从 TP 或者 HTAP 演进到 AP 时，一个常见场景是将 TP 系统中的变更数据（通过 CDC）同步到 AP 系统，用于后续的报表分析和业务监控。这类场景通常涉及大量的<strong>数据更新</strong>，而不仅仅是新增数据，因此对分析系统的更新处理能力和查询性能提出了更高要求。</p>
<p>为了评估 Doris 和 ClickHouse 在这一类实时更新分析场景下的表现，我们基于典型的行业测试模型 <strong>ClickBench</strong> 和 <strong>SSB（Star Schema Benchmark）</strong> 进行了测试，分别对数据集中的 <strong>25% 和 100% 的记录进行了更新操作</strong>。</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdataroaring%2FClickBench%2Ftree%2Fmain%2Fclickhouse-cloud-update" target="_blank" title="https://github.com/dataroaring/ClickBench/tree/main/clickhouse-cloud-update" ref="nofollow noopener noreferrer">更新 SQL </a> 详情参考</p>
</blockquote>
<p>为确保性能对比的合理性，结合 ClickHouse Cloud 与 SelectDB Cloud 套餐配置的差异，制定了如下测试方案：ClickHouse Cloud 采用双副本，单副本分别配置为 8 核 32GB 和 16 核 64GB；SelectDB Cloud 则采用单副本 16 核 128GB 配置。通过该设计，可在整体资源层面分别实现核数对等（16 核）与内存对等（128GB）的横向对比，从而更全面地评估两者在不同资源维度下的性能表现。</p>
<p>原始数据：<a href="https://link.juejin.cn?target=https%3A%2F%2Fselectdb.feishu.cn%2Fsheets%2FGgLnslWcBhmVK8trjVpcAPTinkb" target="_blank" title="https://selectdb.feishu.cn/sheets/GgLnslWcBhmVK8trjVpcAPTinkb" ref="nofollow noopener noreferrer">ssb</a></p>
<h3 data-id="heading-18">SSB-sf100</h3>
<h4 data-id="heading-19">ClickHouse MergeTree  vs  SelectDB Duplicate Key</h4>
<ul>
<li>SelectDB （16c 128GB）的性能是 ClickHouse 32c 128GB（2 replica 每个 replica 16c 64GB）的 5 倍。</li>
<li>SelectDB （16c 128GB）的性能是 ClickHouse 16c 64GB（2 replica 每个 replica 16c 64GB）的 9.8 倍。</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cc9c7fa7ad542c78bbbe94c9539442c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=L8m98pfaQLFm8DXt0OX08PONw1s%3D" alt="性能对比-1.png" loading="lazy"/></p>
<h4 data-id="heading-20">ClickHouse MergeTree  vs  ReplacingMergeTree</h4>
<ul>
<li>25% 更新比例下，ClickHouse ReplacingMergeTree 相比 MergeTree 性能下降 1.6 倍。</li>
<li>100% 更新比例下，ClickHouse ReplacingMergeTree 相比 MergeTree 性能下降 2.5 倍。</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/354a89fce3764de98d3a5dc24b4d6e86~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=nwZWvtbo%2BTYss0lePuNCfFsLxYk%3D" alt="性能对比 02.png" loading="lazy"/></p>
<h4 data-id="heading-21">ClickHouse ReplacingMergeTree vs SelectDB UniqueKey</h4>
<ul>
<li>SelectDB （16c 128GB）相比 ClickHouse 32c 128GB（2 replica 每个 replica 16c 64GB）</li>
<li>25% 更新比例条件下，SelectDB 的性能是 ClickHouse 的 14 倍。</li>
<li>100% 更新比例条件下，SelectDB 的性能是 ClickHouse 的 18 倍。</li>
<li>SelectDB （16c 128GB）相比 ClickHouse 16c 64GB（2 replica 每个 replica 8c 32GB）
<ul>
<li>25% 更新比例条件下，SelectDB 的性能是 ClickHouse 的 25 倍。</li>
<li>100% 更新比例条件下，SelectDB 的性能是 ClickHouse 的 34 倍。</li>
</ul>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cfd9496a5d54ccb8cf588a283538c0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=%2FQfehlDBS%2BuqGT6gjR5pPge6VYM%3D" alt="性能对比-2.png" loading="lazy"/></p>
<h3 data-id="heading-22">ClickBench</h3>
<p>原始数据：<a href="https://link.juejin.cn?target=https%3A%2F%2Fselectdb.feishu.cn%2Fsheets%2FGaKxsBKErhDKYDtBmcEc1KBRnte" target="_blank" title="https://selectdb.feishu.cn/sheets/GaKxsBKErhDKYDtBmcEc1KBRnte" ref="nofollow noopener noreferrer">clickbench</a></p>
<h4 data-id="heading-23">ClickHouse MergeTree  vs  ReplacingMergeTree</h4>
<ul>
<li>ClickBench 下 25% 更新比例 ClickHouse ReplacingMergeTree 相比 MergeTree 性能下降超过 170%。</li>
<li>ClickBench 下 100% 更新比例 ClickHouse ReplacingMergeTree 相比 MergeTree 性能下降超过 290%。</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/753a869cf73e440d8d19e4b2333f6182~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=W9eCtdfQfEU5AUC1ejynEtb6aMQ%3D" alt="性能对比-3.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9802ca07a8204ffaac8ae6e38d09fa6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=VNCVtESSFmEN7YCj6qSp06vQgDc%3D" alt="性能对比-4.png" loading="lazy"/></p>
<h4 data-id="heading-24">ClickHouse ReplacingMergeTree vs SelectDB UniqueKey</h4>
<ul>
<li>SelectDB （16c 128GB）相比 ClickHouse 32c 128GB（2 replica 每个 replica 16c 64GB）</li>
<li>25% 更新比例条件下，查询耗时低 43%</li>
<li>100% 更新比例条件下，查询耗时低 60%</li>
<li>SelectDB （16c 128GB）相比 ClickHouse 16c 64GB（2 replica 每个 replica 8c 32GB）
<ul>
<li>25% 更新比例条件下，查询耗时低 68%。</li>
<li>100% 更新比例条件下，查询耗时低 78%。</li>
</ul>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/967b330635f74a61a749da5aeae588ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=WRIIDqcgO3tUhoD74cn5UkOzZB8%3D" alt="性能对比-5.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb35845a420c4584815998cb6253f2c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764170788&amp;x-signature=Hj%2Bwengf9KGI6oKty%2FrqiQJ9ifw%3D" alt="性能对比-6.png" loading="lazy"/></p>
<h2 data-id="heading-25">用户案例</h2>
<h3 data-id="heading-26">案例一：森马服饰（MySQL）</h3>
<p>森马服饰作为中国休闲服饰和童装领域的领先企业，覆盖线上线下全渠道零售，门店总数达到 8000+ 家。为支撑全域货通中台项目，<strong>森马引入阿里云 SelectDB 替换原 Elasticsearch + 分布式 MySQL 混合架构，统一分析 16+ 核心业务，实现复杂查询 QPS 提升 400%，响应时间缩短至秒级。</strong></p>
<p><strong>在高并发处理场景中</strong>，阿里云 SelectDB 凭借 MPP 架构为森马提供了强大的并发查询支撑：</p>
<ul>
<li><strong>多场景并发支撑</strong>：同时支撑 2B 业务、2C 业务、直营店、加盟商等多场景下的高并发数据分析需求，复杂查询 QPS 达到 200+ 水平。</li>
<li><strong>资源隔离能力</strong>：基于存算分离架构，在线订单查询服务和离线聚合分析 BI 场景分别使用独立计算组，避免相互干扰，确保高并发场景下系统稳定性。</li>
<li><strong>弹性扩缩容</strong>：在直播大促等高压力时段，可快速在线扩容应对流量激增，无需停服和数据搬迁，显著提升应对突发高并发的灵活性。</li>
<li><strong>统一架构简化</strong>：替换双系统架构，统一支持简单过滤查询、海量数据聚合分析、复杂多表关联查询，无需维护复杂业务逻辑来处理高并发多表关联分析。</li>
</ul>
<p><strong>显著收益</strong>：亿级库存流水聚合查询缩短至 8 秒内，运维成本大幅降低，业务高峰期系统运行平稳，为全渠道运营提供可靠的高并发数据分析支撑。</p>
<p>完整阅读：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.selectdb.com%2Fblog%2F1409" target="_blank" title="https://www.selectdb.com/blog/1409" ref="nofollow noopener noreferrer">森马服饰从 Elasticsearch 到阿里云 SelectDB 的架构演进之路</a></p>
<h3 data-id="heading-27">案例二：天眼查（PostgreSQL）</h3>
<p>天眼查是一家数据服务公司，为用户提供超过 3 亿家企业的商业、财务和法务信息查询服务，涵盖 300+ 维度数据。随着业务增长，其尽调平台需要支持内部营销和运营团队的即席查询及用户分群等新需求。<strong>该平台使用 Apache Doris 替换了原有的 Apache Hive、MySQL、Elasticsearch 和 PostgreSQL 混合架构，实现数据写入效率提升 75%，用户分群延迟降低 70%。</strong></p>
<p><strong>在高并发处理场景中</strong>，Apache Doris 的 MPP 架构为平台提供了强大的并发查询支撑能力：</p>
<ul>
<li><strong>即席查询能力</strong>：原架构每次新需求都需要在 Hive 中开发测试数据模型，写入 MySQL 调度任务。现在 Apache Doris 拥有全量明细数据，面对新请求只需配置查询条件即可执行即席查询，仅需低代码配置即可响应新需求。</li>
<li><strong>高效用户分群</strong>：在结果集小于 500 万的用户分群场景中，Apache Doris 能够实现毫秒级响应。通过连续密集的用户 ID 映射优化，用户分群延迟降低 70%，显著提升高并发分群任务处理效率。</li>
<li><strong>统一架构简化</strong>：消除了多组件间的复杂读写操作，无需预定义用户标签，标签可基于任务条件自动生成，大幅简化用户分群流程，提高 A/B 测试的灵活性。</li>
<li><strong>稳定数据写入</strong>：支持每天近 10 亿条新数据流入，使用不同数据模型适配不同场景（MySQL 数据采用 Unique 模型，日志数据采用 Duplicate 模型，DWS 层数据采用 Aggregate 模型）。</li>
</ul>
<p><strong>显著收益</strong>：数据仓库架构更加简单，对开发者和运维人员更加友好，2 个 Apache Doris 集群承载数十 TB 数据，为客户提供实时、准确的企业信息查询服务。</p>
<p>完整阅读：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.selectdb.com%2Fblog%2F86" target="_blank" title="https://www.selectdb.com/blog/86" ref="nofollow noopener noreferrer">秒级数据写入，毫秒查询响应，天眼查基于 Apache Doris 构建统一实时数仓</a></p>
<h3 data-id="heading-28">案例三：宝舵 BOCDOP（TiDB）</h3>
<p>宝舵是宝尊集团旗下商业化独立品牌，拥有 1000 余名技术工程师，为集团 8000+ 员工和全球 450+ 品牌提供电商全渠道数据分析服务。<strong>宝舵早期基于 TiDB 构建实时数仓，随着数据量增长面临处理效率、OLAP 扩展、成本等挑战。通过引入 SelectDB 替换 TiDB，实现写入速度提升 10 倍，成本直降 30% 的显著成效。</strong></p>
<p><strong>在实时更新场景中</strong>，SelectDB 为宝舵提供了强大的实时数据处理能力，特别体现在多源数据同步方面：</p>
<ul>
<li><strong>多源异构数据实时接入</strong>：支持 100+ 业务模块的多渠道数据实时接入，通过 Canal、Mongo-Connector、OGG 等工具获取 MySQL、MongoDB、Oracle 等不同类型业务数据库的 binlog，实现秒级延迟数据同步。</li>
<li><strong>高吞吐实时写入</strong>：利用分区分桶策略与单副本写入机制，在双 11 峰值时段实现每秒百万级数据写入，最高写入速度从 20 万/分提升至 230 万/分，较传统方案提升 10 倍。</li>
<li><strong>流式数据处理</strong>：通过 Kafka + Flink + SelectDB 流式写入能力，将分散在订单、支付、物流等业务模块的数据实时汇聚，数据同步提速 30%。</li>
<li><strong>资源隔离保障</strong>：为"作战室看板"单独分配计算资源组，避免高并发查询与实时写入的资源争用，确保关键业务查询响应时间稳定在 500ms 内。</li>
</ul>
<p><strong>显著收益</strong>：在双 11 等大促期间数据量达平日 30-60 倍的情况下，实现数据供应 0 事故、报表服务可用性 99.9%，查询性能提升 66%，为多渠道电商运营提供稳定的实时数据支撑。</p>
<p>完整阅读：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.selectdb.com%2Fblog%2F1381" target="_blank" title="https://www.selectdb.com/blog/1381" ref="nofollow noopener noreferrer">SelectDB 实时分析性能突出，宝舵成本锐减与性能显著提升的双赢之旅</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linux开发到底指什么？是什么岗位？做什么的？]]></title>    <link>https://juejin.cn/post/7574320550458654761</link>    <guid>https://juejin.cn/post/7574320550458654761</guid>    <pubDate>2025-11-19T15:50:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574320550458654761" data-draft-id="7574267813735022611" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linux开发到底指什么？是什么岗位？做什么的？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T15:50:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="码事漫谈"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linux开发到底指什么？是什么岗位？做什么的？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    码事漫谈
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T15:50:19.000Z" title="Wed Nov 19 2025 15:50:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在技术圈，“Linux开发”是一个高频词，但它却像一个多面体，从不同的角度看去，含义截然不同。这让很多初学者甚至从业者感到困惑。本文将为你彻底拆解“Linux开发”，厘清它的不同层面、对应的岗位以及具体工作内容。</p>
<h4 data-id="heading-0"><strong>核心：两个截然不同的层面</strong></h4>
<p>首先，你必须理解“Linux开发”一词涵盖的两个核心层面，这是解开所有疑惑的钥匙：</p>
<ol>
<li><strong>为 Linux 本身而开发——创造和维护平台</strong></li>
<li><strong>在 Linux 之上进行开发——使用平台构建应用</strong></li>
</ol>
<p>它们之间的关系，好比<strong>造车</strong>与<strong>开车</strong>。前者是工程师在设计和制造汽车（Linux系统本身），后者是司机利用汽车将乘客或货物运送到目的地（在Linux上开发应用）。</p>
<hr/>
<h3 data-id="heading-1"><strong>层面一：为 Linux 本身而开发（造车）</strong></h3>
<p>这类开发者的工作是<strong>构建和维护Linux操作系统及其核心生态</strong>。他们是系统的奠基者，是底层技术的掌控者。</p>
<p><strong>1. Linux 内核开发</strong></p>
<ul>
<li><strong>是什么？</strong> 这是最硬核、最核心的部分。开发者直接参与Linux操作系统“内核”的编码工作。内核是操作系统的心脏，负责管理CPU、内存、设备、文件系统和网络等。</li>
<li><strong>岗位名称</strong>： Linux内核开发工程师、系统软件工程师、内核维护者。</li>
<li><strong>做什么？</strong>
<ul>
<li><strong>开发设备驱动程序</strong>：让新的硬件（如显卡、网卡、传感器）能在Linux上工作。</li>
<li><strong>优化调度算法</strong>：管理CPU时间如何分配给无数个进程，提升系统性能和响应速度。</li>
<li><strong>维护文件系统</strong>：开发或改进Ext4, Btrfs, XFS等文件系统，保障数据存储的可靠与高效。</li>
<li><strong>增强网络协议栈</strong>：优化TCP/IP等网络协议的实现，应对高性能计算和超大流量场景。</li>
<li><strong>修复安全漏洞</strong>：响应社区发现的安全问题，及时提交补丁。</li>
</ul>
</li>
<li><strong>所需技能</strong>： <strong>C语言</strong>和<strong>汇编语言</strong>是绝对主力，需要对计算机体系结构、操作系统原理有极其深刻的理解。</li>
</ul>
<p><strong>2. 系统工具与桌面环境开发</strong></p>
<ul>
<li><strong>是什么？</strong> 开发构成Linux发行版（如Ubuntu, CentOS）的其他核心组件。</li>
<li><strong>岗位名称</strong>： 系统软件开发工程师、桌面应用开发工程师。</li>
<li><strong>做什么？</strong>
<ul>
<li>开发GNU核心工具集（如ls, grep, gcc）。</li>
<li>参与开发systemd（初始化系统）、Glibc（C标准库）等关键组件。</li>
<li>为GNOME、KDE等桌面环境开发应用程序和底层库。</li>
</ul>
</li>
<li><strong>所需技能</strong>： C/C++、Python，对Linux系统机制有深入理解。</li>
</ul>
<p><strong>小结</strong>：这个层面的岗位数量相对较少，但技术门槛极高，通常存在于Red Hat、Intel、Google、华为等与底层硬件和系统密切相关的巨头公司，或活跃在开源社区中。</p>
<hr/>
<h3 data-id="heading-2"><strong>层面二：在 Linux 之上进行开发（开车）</strong></h3>
<p>这是<strong>绝大多数</strong>人谈论“Linux开发”时所指的含义，也是就业市场中最主流的岗位。开发者将Linux视为一个<strong>稳定、高效、免费</strong>的开发环境和部署平台。</p>
<p><strong>1. 后端/服务端开发（最主流的领域）</strong></p>
<ul>
<li><strong>是什么？</strong> 开发运行在服务器上的应用程序，我们日常使用的网站、App的所有数据和处理逻辑，都由这些后端服务提供支持。<strong>互联网的基石就建立在Linux服务器之上。</strong></li>
<li><strong>岗位名称</strong>： 后端开发工程师、Java/Python/Go开发工程师、服务端工程师。</li>
<li><strong>做什么？</strong>
<ul>
<li>设计和实现Web API接口，为前端（网页、App）提供数据。</li>
<li>开发业务逻辑，处理用户注册、订单交易、数据查询等。</li>
<li>构建微服务架构，将复杂系统拆分为小型、独立的服务。</li>
<li>与数据库（MySQL, PostgreSQL, Redis）进行交互，优化查询性能。</li>
<li>集成消息队列（Kafka, RabbitMQ）处理异步任务。</li>
</ul>
</li>
<li><strong>为什么用Linux？</strong> 稳定（常年不关机）、高性能、强大的命令行和脚本能力、开源生态丰富、安全性好。</li>
<li><strong>所需技能</strong>：
<ul>
<li><strong>编程语言</strong>： Java, Python, Go, C++, Node.js, PHP。</li>
<li><strong>框架</strong>： Spring Boot (Java), Django/Flask (Python), Gin (Go)。</li>
<li><strong>Linux本身</strong>： 必须熟练掌握常用命令、进程管理、日志查看、性能监控（如top, iostat）。</li>
</ul>
</li>
</ul>
<p><strong>2. 嵌入式Linux开发</strong></p>
<ul>
<li><strong>是什么？</strong> 在为特定功能设计的设备（非通用计算机）中运行定制化的Linux系统，并为其开发应用程序。</li>
<li><strong>岗位名称</strong>： 嵌入式Linux开发工程师、嵌入式软件工程师。</li>
<li><strong>做什么？</strong>
<ul>
<li><strong>移植和定制Linux系统</strong>：为智能电视、路由器、工业机器人、自动驾驶汽车等特定硬件板卡，裁剪和编译一个最适合的Linux系统。</li>
<li><strong>驱动开发</strong>：编写或调试摄像头、触摸屏、传感器等外设的驱动程序。</li>
<li><strong>应用开发</strong>：开发运行在设备上的用户界面或控制程序。</li>
</ul>
</li>
<li><strong>所需技能</strong>： C/C++、操作系统知识、交叉编译、硬件基础、设备树。</li>
</ul>
<p><strong>3. DevOps / SRE（开发与运维的桥梁）</strong></p>
<ul>
<li><strong>是什么？</strong> 这是一类强调自动化和协作的岗位，目标是高效、可靠地交付和运维大规模软件系统。他们的主战场就是Linux服务器集群。</li>
<li><strong>岗位名称</strong>： DevOps工程师、SRE（站点可靠性工程师）、云平台工程师。</li>
<li><strong>做什么？</strong>
<ul>
<li>使用Ansible, SaltStack等工具自动化配置和管理成千上万台Linux服务器。</li>
<li>搭建和维护CI/CD流水线（如Jenkins, GitLab CI），实现自动化构建、测试和部署。</li>
<li>使用Docker容器封装应用，使用Kubernetes编排和管理容器集群。</li>
<li>监控系统健康状况，排查和解决线上故障。</li>
</ul>
</li>
<li><strong>所需技能</strong>： <strong>精通Linux命令和Shell/Python脚本</strong>、容器技术、CI/CD工具、云计算平台（AWS/Aliyun）。</li>
</ul>
<p><strong>4. 云计算与大数据开发</strong></p>
<ul>
<li><strong>是什么？</strong> 所有的云平台（AWS, Google Cloud, 阿里云）的底层虚拟机绝大多数是Linux。大数据框架（Hadoop, Spark）也主要运行在Linux集群上。</li>
<li><strong>岗位名称</strong>： 云计算开发工程师、大数据开发工程师。</li>
<li><strong>做什么？</strong> 开发云原生应用、构建大数据处理平台和数据管道。</li>
<li><strong>所需技能</strong>： 除了编程，还需精通Linux环境下的网络、存储、分布式系统原理。</li>
</ul>
<hr/>
<h3 data-id="heading-3"><strong>总结与对比</strong></h3>








































<table><thead><tr><th align="left">类别</th><th align="left">核心目标</th><th align="left">好比</th><th align="left">主要技术栈</th><th align="left">常见岗位</th></tr></thead><tbody><tr><td align="left"><strong>为Linux开发</strong></td><td align="left">制造和维护操作系统本身</td><td align="left"><strong>造车</strong></td><td align="left">C, 汇编, 内核原理</td><td align="left">内核开发工程师、系统软件工程师</td></tr><tr><td align="left"><strong>在Linux上开发</strong></td><td align="left"><strong>后端/服务端</strong></td><td align="left">用汽车<strong>运营网约车平台</strong></td><td align="left">Java/Python/Go, 框架, 数据库</td><td align="left">后端开发工程师</td></tr><tr><td align="left"/><td align="left"><strong>嵌入式</strong></td><td align="left">为特种车辆<strong>定制控制系统</strong></td><td align="left">C/C++, 交叉编译, 驱动开发</td><td align="left">嵌入式Linux工程师</td></tr><tr><td align="left"/><td align="left"><strong>DevOps/SRE</strong></td><td align="left">建设和管理<strong>整个城市的交通系统</strong></td><td align="left">Shell/Python, Docker, K8s, CI/CD</td><td align="left">DevOps工程师</td></tr></tbody></table>
<h4 data-id="heading-4"><strong>如何入门与准备？</strong></h4>
<p>无论你选择哪个方向，以下都是必备的通用基础：</p>
<ol>
<li><strong>将Linux作为你的主要操作系统</strong>：克服对命令行的恐惧，从Ubuntu、CentOS等发行版开始，每天使用它。</li>
<li><strong>精通Linux命令行和Bash脚本</strong>：这是Linux开发的灵魂。掌握文件操作、文本处理（grep, sed, awk）、进程管理和网络配置。</li>
<li><strong>掌握Git版本控制</strong>：这是现代软件开发的基石，毋庸置疑。</li>
<li><strong>学习一门主力编程语言</strong>：根据你的兴趣方向选择——<strong>后端选Java/Go/Python，底层/嵌入式选C/C++</strong>。</li>
<li><strong>深入理解计算机基础</strong>：操作系统、计算机网络、数据结构和算法，这些知识永远是你技术的压舱石。</li>
</ol>
<p><strong>结论：</strong></p>
<p>当你在招聘网站上看到“熟悉Linux开发”时，<strong>十有八九指的是在Linux环境下进行后端服务、DevOps或嵌入式开发的能力</strong>，而非要求你去修改Linux内核。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Windows开发：一场与指针的共舞，亦是超越它的征程]]></title>    <link>https://juejin.cn/post/7574281453707689990</link>    <guid>https://juejin.cn/post/7574281453707689990</guid>    <pubDate>2025-11-19T15:51:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574281453707689990" data-draft-id="7574281453707673606" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Windows开发：一场与指针的共舞，亦是超越它的征程"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T15:51:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="码事漫谈"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Windows开发：一场与指针的共舞，亦是超越它的征程
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    码事漫谈
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T15:51:49.000Z" title="Wed Nov 19 2025 15:51:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>当人们问“Windows开发导致指针吗？”或“Windows开发到底指针么？”，这背后其实是一个混合了技术困惑和职业好奇的复杂问题。简单来说，这个问题的内核是：<strong>Windows开发是否是一个整天与令人头疼的指针打交道的岗位？</strong></p>
<p>答案是双重的：<strong>是的，深入理解指针是高级Windows开发的基石；但也不是，因为现代Windows开发已经在很大程度上帮助你管理指针，让你更专注于业务逻辑。</strong></p>
<h4 data-id="heading-0"><strong>一、解码问题：什么是“Windows开发到底指针么？”</strong></h4>
<p>这个问题通常源于以下几点认知：</p>
<ol>
<li><strong>技术传说：</strong> C/C++是Windows的“母语”，而指针是C/C++的灵魂。因此，Windows内核、驱动、高性能应用的开发者必须是玩转指针的大师。</li>
<li><strong>痛苦经历：</strong> 很多初学者或在其他领域的程序员，在接触Windows底层开发时，被野指针、内存访问违规等问题折磨得痛苦不堪，从而形成了“Windows开发 == 指针地狱”的印象。</li>
<li><strong>岗位模糊：</strong> 不清楚“Windows开发工程师”具体做什么，以为他们每天都在<code>malloc</code>和<code>free</code>之间挣扎。</li>
</ol>
<p>所以，这个问题真正的含义是：<strong>“Windows开发这个岗位，是否需要深入理解和频繁操作指针？它的工作内容到底是什么？”</strong></p>
<h4 data-id="heading-1"><strong>二、指针：Windows开发的“内功”</strong></h4>
<p>在Windows开发的某些领域，指针不仅是必需品，更是你必须精通的“内功”。</p>
<p><strong>为什么指针如此重要？</strong></p>
<ol>
<li><strong>性能与直接控制：</strong> Windows内核、图形驱动、游戏、高性能服务器等场景，需要直接操作内存地址来达到极致的性能。指针提供了这种底层能力。</li>
<li><strong>数据结构的核心：</strong> 链表、树、哈希表等复杂数据结构，其实现严重依赖于指针。</li>
<li><strong>与操作系统对话：</strong> 许多Windows API本身就大量使用指针。例如：
<ul>
<li><strong>内存管理：</strong> <code>VirtualAlloc</code>, <code>HeapAlloc</code></li>
<li><strong>字符串操作：</strong> 多字节与宽字符串（<code>LPSTR</code>, <code>LPWSTR</code>）本质上都是字符指针。</li>
<li><strong>函数回调：</strong> 很多API需要你传入一个函数指针，系统在特定事件发生时回调你的函数。</li>
<li><strong>结构体指针：</strong> API经常需要你传入或传出结构体的指针。</li>
</ul>
</li>
</ol>
<p><strong>典型场景：</strong>
如果你是一名<strong>Windows系统级开发工程师</strong>，你的工作可能是开发设备驱动、杀毒软件、文件系统过滤器等。在这里，一个错误的指针操作就可能导致系统的<strong>蓝屏死机</strong>。这时，指针就是你手中最强大也最危险的武器。</p>
<h4 data-id="heading-2"><strong>三、现代Windows开发的演变：从“亲力亲为”到“依赖框架”</strong></h4>
<p>然而，科技在进步。今天的“Windows开发”一词涵盖的范围远比过去广泛。对于大量应用层开发，指针已经从“前台明星”退居为“幕后英雄”。</p>
<ol>
<li>
<p><strong>C# 与 .NET 的崛起：</strong></p>
<ul>
<li><strong>岗位：</strong> <strong>.NET桌面开发工程师</strong>、<strong>WPF/WinForms开发工程师</strong>。</li>
<li><strong>变化：</strong> C#是一种托管语言，它使用“引用”而不是原始指针。虽然引用在概念上类似指针，但 .NET 的垃圾回收器会自动管理内存的生命周期。开发者几乎不再需要手动分配和释放内存，从而从根源上避免了野指针、内存泄漏等经典问题。</li>
<li><strong>工作内容：</strong> 使用 Visual Studio 和 XAML 设计漂亮的UI，处理按钮点击、数据绑定、网络请求等业务逻辑。</li>
</ul>
</li>
<li>
<p><strong>C++ 的现代化：</strong></p>
<ul>
<li><strong>理念：</strong> 即使是使用C++，现代最佳实践也强烈推荐使用 <strong>智能指针</strong>，如 <code>std::unique_ptr</code> 和 <code>std::shared_ptr</code>。</li>
<li><strong>作用：</strong> 智能指针通过RAII机制，在对象超出作用域时自动释放内存。这意味着你不再需要手动调用<code>delete</code>，从而极大地降低了野指针出现的风险。开发者可以更安全地享受C++的性能优势。</li>
</ul>
</li>
<li>
<p><strong>新平台与框架：</strong></p>
<ul>
<li><strong>WinUI 3：</strong> 微软最新的原生UI框架，同时支持C#和C++，倡导现代、安全的开发模式。</li>
<li><strong>.NET MAUI：</strong> 跨平台方案，进一步抽象了底层细节。</li>
</ul>
</li>
</ol>
<h4 data-id="heading-3"><strong>四、“Windows开发”到底是什么岗位？做什么的？</strong></h4>
<p>“Windows开发工程师”不是一个单一的职位，而是一个系列。根据技术栈和领域，主要分为以下几类：</p>
<p><strong>1. 系统底层开发</strong></p>
<ul>
<li><strong>核心技术：</strong> C/C++，汇编语言，Windows Driver Kit</li>
<li><strong>指针依赖度：</strong> ⭐⭐⭐⭐⭐</li>
<li><strong>工作内容：</strong>
<ul>
<li>开发硬件设备驱动、文件系统驱动。</li>
<li>开发安全软件、系统监控工具。</li>
<li>性能分析与优化，深入Windows内核。</li>
</ul>
</li>
<li><strong>特点：</strong> 技术门槛极高，需要对操作系统原理、内存管理、指针有极其深刻的理解。</li>
</ul>
<p><strong>2. 原生桌面应用开发</strong></p>
<ul>
<li><strong>核心技术：</strong> C++ with Win32 API / MFC / WTL, COM</li>
<li><strong>指针依赖度：</strong> ⭐⭐⭐⭐</li>
<li><strong>工作内容：</strong>
<ul>
<li>开发高性能桌面软件，如大型设计软件、音视频处理软件、游戏。</li>
<li>维护传统的企业级桌面应用。</li>
</ul>
</li>
<li><strong>特点：</strong> 仍然需要熟练操作指针和手动管理内存，但对框架的使用可以减轻部分负担。</li>
</ul>
<p><strong>3. 托管桌面应用开发</strong></p>
<ul>
<li><strong>核心技术：</strong> C# with WPF / WinForms / WinUI 3</li>
<li><strong>指针依赖度：</strong> ⭐</li>
<li><strong>工作内容：</strong>
<ul>
<li>开发企业级业务应用、办公软件、工具类软件。</li>
<li>设计复杂的用户界面和数据可视化图表。</li>
<li>与后端Web API进行交互。</li>
</ul>
</li>
<li><strong>特点：</strong> 这是目前市场需求量最大的Windows开发岗位。开发者主要与“引用”和“对象”打交道，几乎不接触原始指针，生产力高。</li>
</ul>
<p><strong>4. 游戏开发</strong></p>
<ul>
<li><strong>核心技术：</strong> C++， DirectX, Unity, Unreal Engine</li>
<li><strong>指针依赖度：</strong> ⭐⭐⭐（引擎层面高，游戏逻辑层面中）</li>
<li><strong>工作内容：</strong>
<ul>
<li>在游戏引擎层面，需要大量使用指针进行资源管理和性能优化。</li>
<li>在游戏逻辑层面，现代引擎和脚本（如C# in Unity, Blueprint in Unreal）降低了对指针的直接操作。</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4"><strong>结论</strong></h3>
<p>所以，“Windows开发到底指针么？”这个问题的最终答案是：</p>
<p><strong>它取决于你选择的赛道。</strong></p>
<ul>
<li>如果你想<strong>深入Windows腹地，驾驭系统底层，追求极致的性能与控制权</strong>，那么<strong>指针是你必须精通、日夜相伴的伙伴</strong>。这条路上充满了挑战，但也充满了技术上的纯粹与力量。</li>
<li>如果你想<strong>快速构建美观、稳定、功能丰富的现代Windows应用程序</strong>，那么你可以选择C#和.NET这条道路。在这里，<strong>指针已经化身为一个可靠、自动化的后台管理系统</strong>，你只需专注于实现业务价值，而无需在指针的泥潭中跋涉。</li>
</ul>
<p>因此，当你考虑成为一名Windows开发工程师时，首先要问自己的是：<strong>“我想成为哪一种？”</strong> 答案是开放的，Windows开发的世界既容纳了底层硬核的剑术大师，也欢迎上层高效的应用构建者。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[前端跨标签页通信方案（下）]]></title>    <link>https://juejin.cn/post/7574321422399930394</link>    <guid>https://juejin.cn/post/7574321422399930394</guid>    <pubDate>2025-11-19T14:06:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574321422399930394" data-draft-id="7553114436405444660" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="前端跨标签页通信方案（下）"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2025-11-19T14:06:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="168169"/> <meta itemprop="url" content="https://juejin.cn/user/2541726614191528"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            前端跨标签页通信方案（下）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2541726614191528/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    168169
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T14:06:53.000Z" title="Wed Nov 19 2025 14:06:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>前情</strong></h2>
<p>平时开发很少有接触到有什么需求需要实现跨标签页通信，但最近因为一些变故，不得不重新开始找工作了，其中就有面试官问到一道题，跨标签页怎么实现数据通信，我当时只答出二种，面试完后特意重新查资料，因此有些文章</p>
<h2 data-id="heading-1"><strong>SharedWorker</strong></h2>
<p>共享工作线程可以在多个标签页之间共享数据和逻辑，通过<code>postMessage</code>通信</p>
<p>关键代码如下：</p>
<p>标签页1</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>SharedWorker0<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>SharedWorker0<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"communication"</span>&gt;</span>SharedWorker0.html 发送消息<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// 主线程</span>
    <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SharedWorker</span>(<span class="hljs-string">'sw.js'</span>);

    <span class="hljs-comment">// 发送消息</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'communication'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      worker.<span class="hljs-property">port</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Hello from Tab:SharedWorker0.html'</span>);
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>标签页2</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>SharedWorker1<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>SharedWorker1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// 主线程</span>
    <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SharedWorker</span>(<span class="hljs-string">'sw.js'</span>);

    <span class="hljs-comment">// 接收消息</span>
    worker.<span class="hljs-property">port</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Received:SharedWorker1.html'</span>, e.<span class="hljs-property">data</span>);
    };
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>sw.js关键代码：</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> connections = [];

self.<span class="hljs-property">onconnect</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> port = e.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>];
  connections.<span class="hljs-title function_">push</span>(port);
  
  port.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-comment">// 广播给所有连接的页面</span>
    connections.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-title function_">postMessage</span>(e.<span class="hljs-property">data</span>));
  };
};
</code></pre>
<p>动图演示：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e0c0228ae4343c683796e87bfdaab57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764166013&amp;x-signature=aLqvm2jY6HVPZLQp2Yedxfha8AQ%3D" alt="20250923_203404.gif" loading="lazy"/></p>
<p><strong>提醒：</strong></p>
<ul>
<li>同源标签才有效</li>
<li>不同页面创建 SharedWorker 时，若指定的脚本路径不同（即使内容相同），会创建不同的 worker 实例</li>
<li>页面与 SharedWorker 之间通过 <strong>MessagePort</strong> 通信，需通过 <code>port.postMessage()</code> 发送消息，通过 <code>port.onmessage</code> 接收消息</li>
<li>SharedWorker 无法访问 DOM、<code>window</code> 对象或页面的全局变量，仅能使用 JavaScript 核心 API 和部分 Web API（如 <code>fetch</code>、<code>WebSocket</code>）</li>
<li>兼容性一般，安卓webview全系不兼容</li>
</ul>
<h2 data-id="heading-2"><strong>Service Worker</strong></h2>
<p>专门用于同源标签页通信的 API，创建一个频道后，所有加入该频道的页面都能收到消息</p>
<p>关键代码如下:</p>
<p>标签页1</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ServiceWorker0<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ServiceWorker0<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sendBtn"</span>&gt;</span>发送消息<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// 注册ServiceWorker</span>
    <span class="hljs-keyword">let</span> swReg;
    navigator.<span class="hljs-property">serviceWorker</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">'ServiceWorker.js'</span>)
      .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">reg</span> =&gt;</span> {
        swReg = reg;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'SW注册成功'</span>);
      });
    
    <span class="hljs-comment">// 发送消息</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sendBtn'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (swReg &amp;&amp; swReg.<span class="hljs-property">active</span>) {
        swReg.<span class="hljs-property">active</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'来自页面0的消息'</span>);
      }
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>标签页2</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ServiceWorker1<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ServiceWorker1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// 注册ServiceWorker</span>
    navigator.<span class="hljs-property">serviceWorker</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">'ServiceWorker.js'</span>)
      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'SW注册成功'</span>));
    
    <span class="hljs-comment">// 接收消息</span>
    navigator.<span class="hljs-property">serviceWorker</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'---- Received:ServiceWorker1.html ----:'</span>,  e.<span class="hljs-property">data</span>);
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>ServiceWorker.js关键代码</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// 快速激活</span>
self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'install'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-title function_">waitUntil</span>(self.<span class="hljs-title function_">skipWaiting</span>()));
self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'activate'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-title function_">waitUntil</span>(self.<span class="hljs-property">clients</span>.<span class="hljs-title function_">claim</span>()));

<span class="hljs-comment">// 消息转发</span>
self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  self.<span class="hljs-property">clients</span>.<span class="hljs-title function_">matchAll</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">clients</span> =&gt;</span> {
    clients.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">client</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (client.<span class="hljs-property">id</span> !== e.<span class="hljs-property">source</span>.<span class="hljs-property">id</span>) {
        client.<span class="hljs-title function_">postMessage</span>(e.<span class="hljs-property">data</span>);
      }
    });
  });
});
</code></pre>
<p>演示动图如下：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13f8ad8243d64980881ab4376f89225e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY4MTY5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764166013&amp;x-signature=k99zQTEjMyCrkjJcB5vEyvaCXaw%3D" alt="20250923_212126.gif" loading="lazy"/></p>
<p><strong>提醒：</strong></p>
<ul>
<li>Service Worker 要求页面必须在 <strong>HTTPS 环境</strong> 下运行（<code>localhost</code> 除外，方便本地开发），这是出于安全考虑，防止中间人攻击篡改 Service Worker 脚本</li>
<li>Service Worker 有严格的生命周期（安装、激活、空闲、销毁），一旦注册成功会长期运行在后台，更新 Service Worker 需满足两个条件：</li>
</ul>
<ol>
<li>脚本 URL 不变但内容有差异</li>
<li>需在 <code>install</code> 事件中调用 <code>self.skipWaiting()</code>，并在 <code>activate</code> 事件中调用 <code>self.clients.claim()</code> 让新 Worker 立即生效</li>
</ol>
<ul>
<li>Service Worker 的作用域由注册路径决定，默认只能控制其所在路径及子路径下的页面，例如：<code>/sw.js</code> 可控制全站，<code>/js/sw.js</code> 默认只能控制 <code>/js/</code> 路径下的页面，可通过 <code>scope</code> 参数指定作用域，但不能超出注册文件所在路径的范围</li>
<li>可在浏览器开发者工具的 <strong>Application &gt; Service Workers</strong> 面板进行调试，
• 查看当前运行的 Service Worker 状态
• 强制更新、停止或注销 Worker
• 模拟离线环境</li>
<li>主流浏览器都支持，使用的时候可以通过<a href="https://link.juejin.cn?target=https%3A%2F%2Fjakearchibald.github.io%2Fisserviceworkerready%2F" target="_blank" title="https://jakearchibald.github.io/isserviceworkerready/" ref="nofollow noopener noreferrer">Is service worker ready?</a>，测试兼容性</li>
</ul>
<h2 data-id="heading-3"><strong>window.open + window.opener</strong></h2>
<p>如果标签页是通过<code>window.open</code>打开的，可以直接通过<code>opener</code>属性通信
父窗口，打开子窗口的页面关键代码：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>parent<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>window.open parent<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"openBtn"</span>&gt;</span>打开子窗口<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sendBtn"</span>&gt;</span>发送消息<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"messageDisplay"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">let</span> childWindow = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> messageHandler = <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// 打开子窗口</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'openBtn'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// 如果已有窗口，先关闭</span>
      <span class="hljs-keyword">if</span> (childWindow &amp;&amp; !childWindow.<span class="hljs-property">closed</span>) {
        childWindow.<span class="hljs-title function_">close</span>();
      }
      childWindow = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(<span class="hljs-string">'./children.html'</span>, <span class="hljs-string">'childWindow'</span>);
    });

    <span class="hljs-comment">// 发送消息</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sendBtn'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (childWindow &amp;&amp; !childWindow.<span class="hljs-property">closed</span>) {
	      <span class="hljs-comment">// window.location.origin限制接收域名</span>
        childWindow.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Hello child'</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">alert</span>(<span class="hljs-string">'请先打开子窗口'</span>);
      }
    });
    
    <span class="hljs-comment">// 接收子窗口的消息</span>
    messageHandler = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">origin</span> === <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span> &amp;&amp; e.<span class="hljs-property">source</span> !== <span class="hljs-variable language_">window</span>) {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'messageDisplay'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">'收到消息: '</span> + e.<span class="hljs-property">data</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'父页面收到消息:'</span>, e.<span class="hljs-property">data</span>);
      }
    };
    
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, messageHandler);
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>通过window.open打开的子页面关键代码：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>children<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>子窗口<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"replyBtn"</span>&gt;</span>回复父窗口<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"messageDisplay"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">let</span> messageHandler = <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// 只在页面加载完成后设置消息监听</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// 接收父页面消息</span>
      messageHandler = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (e.<span class="hljs-property">origin</span> === <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span> &amp;&amp; e.<span class="hljs-property">source</span> !== <span class="hljs-variable language_">window</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'子页面收到消息:'</span>, e.<span class="hljs-property">data</span>);
          
          <span class="hljs-comment">// 显示收到的消息</span>
          <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'messageDisplay'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">'收到消息: '</span> + e.<span class="hljs-property">data</span>;
          
          <span class="hljs-variable language_">window</span>.<span class="hljs-property">opener</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'子窗口已收到消息'</span>, e.<span class="hljs-property">origin</span>);
        }
      };
      
      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, messageHandler);
    };
    
    <span class="hljs-comment">// 手动回复按钮</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'replyBtn'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">opener</span>) {
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">opener</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'来自子窗口的回复'</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span>);
      }
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><strong>提醒：</strong></p>
<ul>
<li>允许跨域通信，但必须由开发者显式指定信任的源，避免恶意网站滥用</li>
<li>在事件监听的时候记得判断e.source，避免自己发送的事件自己接收了</li>
<li>若子窗口被关闭，父窗口中对它的引用（如 <code>childWindow</code>）会变成无效对象，调用其方法会报错</li>
<li>window.open使用会有一些限制，最好是在事件中使用，有的浏览器还会有权限提示，需要用户同意才行，若 <code>window.open</code> 被浏览器拦截（非用户主动触发），会返回 <code>null</code>，导致后续通信失败</li>
</ul>
<h2 data-id="heading-4">总结</h2>
<p>面试官有提到Service Worker也可以，我面试完后的查询资料尝试了这些方法，都挺顺利的，就是Service Worker折腾了一会才跑通，使用起来相比前面的一些方式，它稍微复杂一些，我觉得用于消息通信只是它的冰山一角，它有一个主要功能就是用来解决一些耗性能的计算密集任务</p>
<p>个人技术有限，如果你有更好的跨标签页通信方式，期待你的分享，你工作中有遇到这种跨标签页通信的需求么，如果有你用的是哪一种了，期待你的留言</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[只有前端 Leader 才会告诉你：那些年踩过的模块加载失败的坑（二）]]></title>    <link>https://juejin.cn/post/7574270661872812070</link>    <guid>https://juejin.cn/post/7574270661872812070</guid>    <pubDate>2025-11-19T14:18:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574270661872812070" data-draft-id="7574270661872795686" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="只有前端 Leader 才会告诉你：那些年踩过的模块加载失败的坑（二）"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-11-19T14:18:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="也无风雨也雾晴"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            只有前端 Leader 才会告诉你：那些年踩过的模块加载失败的坑（二）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    也无风雨也雾晴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T14:18:51.000Z" title="Wed Nov 19 2025 14:18:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>最近项目准备要发布了，项目有比较多的一些代码提交和修复，发现在生产环境中，偶尔会遇到下面的错误：</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">TypeError:</span> Failed <span class="hljs-keyword">to</span> fetch dynamically imported <span class="hljs-keyword">module</span>:
<span class="hljs-symbol">https:</span>//***-dev.***.internal.***.tech/assets/index-DUebgR3_.js

Failed <span class="hljs-keyword">to</span> load <span class="hljs-keyword">module</span> script: Expected a JavaScript-<span class="hljs-built_in">or</span>-Wasm <span class="hljs-keyword">module</span> script 
but the server responded <span class="hljs-keyword">with</span> a MIME type <span class="hljs-keyword">of</span> <span class="hljs-string">"text/html"</span>.
</code></pre>
<p>去做了一些调研，整理了这篇文章</p>
<h2 data-id="heading-0">🔍 问题原因分析</h2>
<h3 data-id="heading-1">1. 根本原因</h3>
<p><strong>Nginx 配置问题</strong>：当浏览器请求不存在的静态资源文件时，nginx 返回了 <code>index.html</code> 而不是 404 错误。</p>
<p>原始的nginx配置：</p>
<pre><code class="hljs language-nginx" lang="nginx">location / {
    try_files $uri $uri/ /index.html;
}
</code></pre>
<p>这个配置作用是让前端路由（比如 <code>/about</code>、<code>/user/profile</code> 这类路径）在刷新或直接访问时不会返回 404，导致所有找不到的文件（包括 <code>/assets/</code> 下的 JS 文件）都返回 <code>index.html</code>（对应MIME type: text/html），但浏览器期望的是 JavaScript 文件。</p>
<h3 data-id="heading-2">2. 触发场景</h3>
<p>我们的触发场景主要是场景A，其他两种也是可能会触发的场景</p>
<h4 data-id="heading-3">场景 A：版本更新后的缓存问题</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> 用户访问网站，浏览器缓存了 index.html（引用 index-ABC123.js）
<span class="hljs-bullet">2.</span> 服务器部署新版本，生成新的哈希文件 index-DEF456.js
<span class="hljs-bullet">3.</span> 用户刷新页面，浏览器使用缓存的 HTML，尝试加载已删除的 index-ABC123.js
<span class="hljs-bullet">4.</span> 文件不存在，nginx 返回 index.html
<span class="hljs-bullet">5.</span> 浏览器把 HTML 当作 JS 解析，抛出 TypeError
</code></pre>
<h4 data-id="heading-4">场景 B：部署不完整</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> CI/CD 部署过程中，HTML 文件已更新
<span class="hljs-bullet">2.</span> 某些 chunk 文件因网络问题未完全上传
<span class="hljs-bullet">3.</span> 用户访问时，HTML 引用了不存在的 chunk 文件
<span class="hljs-bullet">4.</span> 触发模块加载错误
</code></pre>
<h4 data-id="heading-5">场景 C：CDN/浏览器缓存不一致</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> CDN 缓存了新版本的 HTML
<span class="hljs-bullet">2.</span> 某些静态资源仍指向旧版本或缓存未更新
<span class="hljs-bullet">3.</span> 导致文件引用不匹配
</code></pre>
<h3 data-id="heading-6">3. 错误链条</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[浏览器请求 /assets/index-DUebgR3_.js] --&gt; B{文件是否存在?}
    B --&gt;|否| C[nginx 执行 try_files]
    C --&gt; D[返回 /index.html]
    D --&gt; E[MIME type: text/html]
    E --&gt; F[浏览器期望: application/javascript]
    F --&gt; G[TypeError: MIME type 不匹配]
</code></pre>
<h2 data-id="heading-7">✅ 解决方案</h2>
<h3 data-id="heading-8">方案 1：修复 Nginx 配置（核心）</h3>
<p><strong>修改内容</strong>：</p>
<pre><code class="hljs language-nginx" lang="nginx">server {
    listen       80;
    server_name  _;

    root   /usr/share/nginx/html;
    index  index.html;

    # 静态资源：找不到返回 404，不返回 index.html
    location /assets/ {
        try_files $uri =404;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # SPA 路由：只对非静态资源路径生效
    location / {
        try_files $uri $uri/ /index.html;
        # 禁用 index.html 缓存，确保用户总是获取最新版本
        add_header Cache-Control "no-cache, no-store, must-revalidate";
    }

    # Gzip 压缩
    gzip on;
    gzip_types text/plain text/css application/javascript application/json application/xml image/svg+xml;
    gzip_min_length 1024;
}
</code></pre>
<p><strong>改进点</strong>：</p>
<ul>
<li>✅ <code>/assets/</code> 路径返回真实的 404，避免误返回 HTML</li>
<li>✅ 静态资源设置长期缓存（1年），提升性能</li>
<li>✅ <code>index.html</code> 禁用缓存，防止引用过期的静态资源</li>
<li>✅ 区分 SPA 路由和静态资源路由</li>
</ul>
<h3 data-id="heading-9">📘 SPA 加载流程详解</h3>
<h4 data-id="heading-10">单页应用的完整加载过程</h4>
<p>很多人误以为 SPA 只是"返回 index.html 就完事了"，实际上 <strong>index.html 只是入口，JS 文件才是应用的核心</strong>。</p>
<h5 data-id="heading-11">🔄 完整加载流程（6个步骤）</h5>
<pre><code class="hljs language-bash" lang="bash">用户访问: https://yourapp.com/users/123
    ↓
① 服务器返回 index.html（HTML 入口文件）
    ↓
② 浏览器解析 HTML，发现 &lt;script src=<span class="hljs-string">"/assets/index-DUebgR3_.js"</span>&gt;
    ↓
③ 浏览器自动发起第二个请求: GET /assets/index-DUebgR3_.js
    ↓                           ⚠️ 我们的错误发生在这一步，由于项目更新，打包部署了新的版本，文件的																	<span class="hljs-built_in">hash</span>值也发生了变化，但是本地之前启动项目的缓存请求的还是旧文件，期望																拿到js文件，但是由于服务端找不到，返回了html，就出现了开头的错误
④ 服务器返回 JS 文件（包含 React 应用代码）
    ↓
⑤ 浏览器执行 JS：React 启动，读取 URL (/users/123)
    ↓
⑥ React Router 匹配路由，渲染 &lt;UserProfile <span class="hljs-built_in">id</span>=<span class="hljs-string">"123"</span> /&gt; 组件
</code></pre>
<h5 data-id="heading-12">📄 index.html 和 JS 文件的关系</h5>
<p><strong>index.html 的实际内容</strong>（简化版）：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Innies<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/assets/style-ABC123.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"root"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-comment">&lt;!-- ⚠️ 注意：这里是空的！ --&gt;</span>

    <span class="hljs-comment">&lt;!-- ⚠️ 关键：这行代码触发浏览器请求 JS 文件 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/assets/index-DUebgR3_.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><strong>JS 文件包含真正的应用代码</strong>：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// /assets/index-DUebgR3_.js 的内容</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BrowserRouter</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;

<span class="hljs-comment">// 这里才开始渲染页面内容</span>
<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">BrowserRouter</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>  {/* 包含所有路由、组件、业务逻辑 */}
  <span class="hljs-tag">&lt;/<span class="hljs-name">BrowserRouter</span>&gt;</span></span>,
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>)  <span class="hljs-comment">// 找到 HTML 里的 &lt;div id="root"&gt;，开始渲染</span>
);
</code></pre>
<p><strong>关键理解</strong>：</p>
<ul>
<li><code>index.html</code> 只是一个<strong>空壳</strong>（只有一个空的 <code>&lt;div id="root"&gt;</code>）</li>
<li><strong>所有页面内容、路由、组件都在 JS 文件里</strong></li>
<li>没有 JS 文件，页面就是空白，什么都显示不出来</li>
</ul>
<h5 data-id="heading-13">⚠️ 错误发生的位置</h5>
<p><strong>本文档解决的错误发生在第③步</strong>：</p>
<p><strong>正常流程</strong>：</p>
<pre><code class="hljs language-bash" lang="bash">③ 浏览器请求: GET /assets/index-DUebgR3_.js
    ↓
✅ 服务器返回: JavaScript 文件（Content-Type: application/javascript）
    ↓
✅ 浏览器执行 JS，React 启动
    ↓
✅ 页面渲染成功
</code></pre>
<p><strong>错误流程（修复前）</strong>：</p>
<pre><code class="hljs language-bash" lang="bash">③ 浏览器请求: GET /assets/index-DUebgR3_.js
    ↓
❌ 服务器找不到文件（可能是旧版本文件已被删除）
    ↓
❌ Nginx 配置错误：try_files <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.html
    ↓
❌ 返回: index.html 内容（Content-Type: text/html）
    ↓
❌ 浏览器期望 JavaScript，但收到 HTML
    ↓
❌ TypeError: Expected JavaScript but got MIME <span class="hljs-built_in">type</span> <span class="hljs-string">"text/html"</span>
    ↓
❌ React 无法启动，页面白屏或崩溃
</code></pre>
<h5 data-id="heading-14">📊 请求和响应对比</h5>








































<table><thead><tr><th>步骤</th><th>正常情况</th><th>错误情况（修复前）</th></tr></thead><tbody><tr><td><strong>浏览器请求</strong></td><td><code>GET /assets/index-DUebgR3_.js</code></td><td><code>GET /assets/index-DUebgR3_.js</code></td></tr><tr><td><strong>文件状态</strong></td><td>✅ 文件存在</td><td>❌ 文件不存在（旧版本）</td></tr><tr><td><strong>服务器返回</strong></td><td>JavaScript 代码</td><td>❌ index.html 内容</td></tr><tr><td><strong>Content-Type</strong></td><td><code>application/javascript</code></td><td>❌ <code>text/html</code></td></tr><tr><td><strong>浏览器行为</strong></td><td>✅ 执行 JS，渲染页面</td><td>❌ MIME type 不匹配报错</td></tr><tr><td><strong>用户体验</strong></td><td>✅ 页面正常显示</td><td>❌ 白屏或错误提示</td></tr></tbody></table>
<h5 data-id="heading-15">💡 为什么 JS 文件找不到会导致整个应用崩溃？</h5>
<p>因为 JS 文件包含：</p>
<ul>
<li>✅ React 核心代码</li>
<li>✅ 所有组件定义</li>
<li>✅ 路由配置</li>
<li>✅ 状态管理</li>
<li>✅ 业务逻辑</li>
</ul>
<p><strong>没有这个 JS 文件，index.html 只是一个空壳，无法渲染任何内容。</strong></p>
<p>这就像：</p>
<ul>
<li><code>index.html</code> = 汽车的外壳</li>
<li><code>index-DUebgR3_.js</code> = 发动机</li>
<li>没有发动机，汽车就无法启动</li>
</ul>
<h4 data-id="heading-16">🎯 为什么要区分 SPA 路由和静态资源路由？</h4>
<p><strong>问题背景</strong>：
单页应用（SPA）和传统的静态资源服务有本质区别，需要不同的处理策略。</p>
<h5 data-id="heading-17">📘 SPA 路由工作原理</h5>
<p><strong>单页应用（SPA）的核心机制</strong>：</p>
<ol>
<li>
<p><strong>服务器层面</strong>：所有 URL 路径都返回同一个 <code>index.html</code></p>
<pre><code class="hljs language-bash" lang="bash">/users/123    → 服务器返回 index.html
/dashboard    → 服务器返回 index.html
/settings     → 服务器返回 index.html
</code></pre>
</li>
<li>
<p><strong>浏览器层面</strong>：前端路由（如 React Router）解析 URL 并渲染对应组件</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// index.html 加载后，前端路由接管 URL 解析</span>
/users/<span class="hljs-number">123</span>    → <span class="hljs-title class_">React</span> <span class="hljs-title class_">Router</span> 匹配 → &lt;<span class="hljs-title class_">UserProfile</span> id=<span class="hljs-string">"123"</span> /&gt;
<span class="hljs-regexp">/dashboard    → React Router 匹配 → &lt;Dashboard /</span>&gt;
<span class="hljs-regexp">/settings     → React Router 匹配 → &lt;Settings /</span>&gt;
</code></pre>
</li>
</ol>
<p><strong>为什么 <code>/users/123</code> 需要返回 <code>index.html</code>？</strong></p>
<p>典型场景：</p>
<ul>
<li>用户直接在浏览器输入 <code>https://yourapp.com/users/123</code></li>
<li>或在 <code>/users/123</code> 页面刷新浏览器</li>
<li>服务器收到 HTTP 请求：<code>GET /users/123</code></li>
</ul>
<p><strong>如果不返回 <code>index.html</code> 会发生什么？</strong></p>
<pre><code class="hljs language-bash" lang="bash">❌ 服务器在文件系统中找不到 /users/123 文件
❌ 返回 404 错误
❌ 用户看到错误页面，应用无法加载
</code></pre>
<p><strong>返回 <code>index.html</code> 后的完整流程</strong>：</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> 服务器返回 index.html（包含 React 应用的启动代码）
<span class="hljs-bullet">2.</span> 浏览器加载并执行 index.html 中的 JavaScript
<span class="hljs-bullet">3.</span> React 应用启动
<span class="hljs-bullet">4.</span> React Router 读取当前 URL: /users/123
<span class="hljs-bullet">5.</span> 匹配路由规则，渲染 <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"123"</span> /&gt;</span></span> 组件
<span class="hljs-bullet">6.</span> 用户看到正确的页面 ✅
</code></pre>
<h5 data-id="heading-18">📊 路由类型对比</h5>























<table><thead><tr><th>类型</th><th>路径示例</th><th>期望行为</th><th>原因</th></tr></thead><tbody><tr><td><strong>SPA 路由</strong></td><td><code>/users/123</code><br/><code>/settings</code><br/><code>/dashboard</code></td><td>返回 <code>index.html</code></td><td>这些是前端路由，由 React Router 处理，服务器没有对应文件</td></tr><tr><td><strong>静态资源</strong></td><td><code>/assets/index-DUebgR3_.js</code><br/><code>/assets/style.css</code><br/><code>/favicon.ico</code></td><td>返回文件或 404</td><td>这些是真实的物理文件，不存在就应该报错</td></tr></tbody></table>
<p><strong>修复前的问题</strong>：</p>
<pre><code class="hljs language-nginx" lang="nginx">location / {
    try_files $uri $uri/ /index.html;  # ❌ 所有路径都用这个规则
}
</code></pre>
<p>这会导致：</p>
<ul>
<li>✅ <code>/users/123</code> → 返回 <code>index.html</code> ✓（正确）</li>
<li>❌ <code>/assets/missing.js</code> → 返回 <code>index.html</code> ✗（错误！应该返回 404）</li>
</ul>
<p><strong>修复后的方案</strong>：</p>
<pre><code class="hljs language-nginx" lang="nginx"># 规则 1：静态资源 - 严格匹配
location /assets/ {
    try_files $uri =404;  # 找不到就返回 404，绝不返回 HTML
}

# 规则 2：SPA 路由 - 兜底方案
location / {
    try_files $uri $uri/ /index.html;  # 找不到才返回 HTML
}
</code></pre>
<p><strong>工作原理</strong>：</p>
<pre><code class="hljs language-bash" lang="bash">请求: /users/123
  ↓ 不匹配 /assets/
  ↓ 进入 location /
  ↓ <span class="hljs-variable">$uri</span> 不存在 → 返回 index.html ✅
  
请求: /assets/index-ABC.js (存在)
  ↓ 匹配 /assets/
  ↓ <span class="hljs-variable">$uri</span> 存在 → 返回文件 ✅
  
请求: /assets/index-OLD.js (不存在)
  ↓ 匹配 /assets/
  ↓ <span class="hljs-variable">$uri</span> 不存在 → 返回 404 ✅（不是 HTML！）
</code></pre>
<p><strong>核心收益</strong>：</p>
<ol>
<li><strong>类型安全</strong>：浏览器期望 JS 文件，就不会收到 HTML 文件</li>
<li><strong>快速失败</strong>：资源缺失立即返回 404，触发前端错误处理（重试/提示）</li>
<li><strong>正确缓存</strong>：静态资源和 HTML 可以设置不同的缓存策略</li>
<li><strong>问题可见</strong>：404 错误可以被监控系统捕获，便于及时发现部署问题</li>
</ol>
<h4 data-id="heading-19">⚠️ 重要说明：404 不是终极解决方案</h4>
<p><strong>返回 404 的作用</strong>：</p>
<pre><code class="hljs language-go" lang="go">❌ 修复前：返回 HTML → MIME <span class="hljs-keyword">type</span> 错误 → 用户看到技术错误 → 无法恢复
✅ 修复后：返回 <span class="hljs-number">404</span> → 触发 <span class="hljs-type">error</span> 事件 → 前端捕获错误 → 自动重试/提示用户
</code></pre>
<p><strong>404 只是让问题"正确地暴露"</strong>，真正的解决方案是 <strong>方案 3 的前端错误处理</strong>：</p>
<ul>
<li>🔄 自动重试加载（处理临时网络问题）</li>
<li>🔄 自动刷新页面（清除过期缓存）</li>
<li>💬 友好的用户提示（引导用户清除缓存）</li>
</ul>
<p><strong>完整的解决链条</strong>：</p>
<pre><code class="hljs language-css" lang="css">文件不存在 
  ↓
nginx 返回 <span class="hljs-number">404</span>（不是 <span class="hljs-selector-tag">HTML</span>）
  ↓
浏览器触发 error 事件
  ↓
前端错误处理器捕获
  ↓
自动重试（<span class="hljs-number">2</span>次）或提示用户清除缓存
  ↓
问题解决 ✅
</code></pre>
<p><strong>三个方案的角色</strong>：</p>

























<table><thead><tr><th>方案</th><th>角色</th><th>作用</th></tr></thead><tbody><tr><td><strong>方案 1 (Nginx)</strong></td><td>🚦 正确的错误信号</td><td>让错误以正确的方式暴露（404 而非 HTML）</td></tr><tr><td><strong>方案 2 (Vite)</strong></td><td>🛡️ 减少问题发生</td><td>优化构建，减少 chunk 文件数量和依赖复杂度</td></tr><tr><td><strong>方案 3 (前端)</strong></td><td>🔧 自动修复</td><td>捕获错误并自动恢复，用户无感知或有友好提示</td></tr></tbody></table>
<p><strong>根本性的预防措施</strong>（见后文"预防措施"章节）：</p>
<ul>
<li>✅ 禁用 <code>index.html</code> 缓存</li>
<li>✅ 原子性部署（避免文件不完整）</li>
<li>✅ 保留旧版本静态资源（避免缓存引用失效）</li>
</ul>
<h3 data-id="heading-20">方案 2：优化 Vite 构建配置</h3>
<p><strong>修改内容</strong>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(<span class="hljs-function">(<span class="hljs-params">{ mode }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">build</span>: {
      <span class="hljs-attr">rollupOptions</span>: {
        <span class="hljs-attr">output</span>: {
          <span class="hljs-attr">manualChunks</span>: {
            <span class="hljs-comment">// 拆分大型依赖，减少单个文件失败的影响</span>
            <span class="hljs-string">'react-vendor'</span>: [<span class="hljs-string">'react'</span>, <span class="hljs-string">'react-dom'</span>, <span class="hljs-string">'react-router-dom'</span>],
            <span class="hljs-string">'ui-vendor'</span>: [<span class="hljs-string">'@zhiman/design'</span>, <span class="hljs-string">'framer-motion'</span>, <span class="hljs-string">'lucide-react'</span>],
          },
        },
      },
      <span class="hljs-attr">assetsDir</span>: <span class="hljs-string">'assets'</span>,
      <span class="hljs-attr">chunkSizeWarningLimit</span>: <span class="hljs-number">1000</span>,
    },
    <span class="hljs-comment">// ... 其他配置</span>
  };
});
</code></pre>
<p><strong>改进点</strong>：</p>
<ul>
<li>✅ 合理拆分 chunk，避免单个巨大文件</li>
<li>✅ 减少动态导入失败的影响范围</li>
<li>✅ 提升首屏加载速度</li>
</ul>
<h3 data-id="heading-21">方案 3：添加前端错误处理</h3>
<p><strong>新增文件</strong>：<code>src/utils/moduleLoadErrorHandler.ts</code></p>
<p><strong>核心功能</strong>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">setupModuleLoadErrorHandler</span>(<span class="hljs-params"/>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// 监听全局错误</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-comment">// 检测模块加载错误</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isModuleLoadError</span>(event.<span class="hljs-property">message</span>)) {
      <span class="hljs-comment">// 自动重试（最多 2 次）</span>
      <span class="hljs-keyword">if</span> (reloadCount &lt; <span class="hljs-variable constant_">MAX_RELOAD_ATTEMPTS</span>) {
        sessionStorage.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable constant_">RELOAD_KEY</span>, <span class="hljs-title class_">String</span>(reloadCount + <span class="hljs-number">1</span>));
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-title function_">reload</span>(), <span class="hljs-number">500</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// 显示友好的错误提示</span>
        <span class="hljs-title function_">showErrorUI</span>();
      }
    }
  });
}
</code></pre>
<p><strong>特性</strong>：</p>
<ul>
<li>✅ 自动检测模块加载失败</li>
<li>✅ 智能重试机制（最多 2 次）</li>
<li>✅ 友好的用户提示界面</li>
<li>✅ 一键清除缓存并重新加载</li>
<li>✅ 防止无限重载循环</li>
</ul>
<p><strong>使用方式</strong>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/main.tsx</span>
<span class="hljs-keyword">import</span> { setupModuleLoadErrorHandler } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils/moduleLoadErrorHandler'</span>;

<span class="hljs-title function_">setupModuleLoadErrorHandler</span>();
</code></pre>
<h2 data-id="heading-22">📊 效果对比</h2>
<h3 data-id="heading-23">修复前</h3>
<pre><code class="hljs">用户体验：❌ 白屏 / 加载失败
错误信息：❌ 技术性错误提示
恢复方式：❌ 用户需要手动清除缓存
影响范围：❌ 版本更新时频繁出现
</code></pre>
<h3 data-id="heading-24">修复后</h3>
<pre><code class="hljs">用户体验：✅ 自动重试 / 友好提示
错误信息：✅ 用户友好的提示界面
恢复方式：✅ 自动重试 + 一键清除缓存
影响范围：✅ 大幅减少错误发生率
</code></pre>
<ul>
<li>
<h2 data-id="heading-25">💡 总结与建议</h2>
<h3 data-id="heading-26">问题本质</h3>
<p>说白了就是：<strong>旧文件找不到了，Nginx 配置有问题，返回了错的东西。</strong></p>
<p>用户浏览器缓存的旧 HTML 里写着"去加载 <code>index-ABC123.js</code>"，但服务器上这个文件早删了。正常情况应该返回 404，但 Nginx 配置写错了，返回了一个 HTML 页面。浏览器期望拿到 JS 文件，结果拿到 HTML，直接懵了，抛错。</p>
<h3 data-id="heading-27">解决思路很简单</h3>
<p><strong>核心就一句话：让 Nginx 该返回 404 就返回 404，别瞎返回 HTML。然后前端监听到 404 错误，自动刷新页面就行了。</strong></p>
<p>三个方案其实就是围绕这个思路：</p>
<ol>
<li><strong>改 Nginx</strong>：找不到文件就老老实实返回 404，别整那些花里胡哨的</li>
<li><strong>前端兜底</strong>：监听加载失败，自动重试或者刷新页面，用户基本无感</li>
<li><strong>优化打包</strong>：把文件拆小点，减少出问题的概率</li>
</ol>
<h3 data-id="heading-28">为什么这么简单的问题会困扰这么久？</h3>
<p>因为大多数人（包括我们一开始）都把 Nginx 配置写成了：</p>
<p>nginx</p>
<pre><code class="hljs language-nginx" lang="nginx">location / {
    try_files $uri $uri/ /index.html;  # 啥都找不到就返回 HTML
}
</code></pre>
<p>这个配置的本意是支持 SPA 前端路由，但副作用是<strong>连静态资源文件找不到也返回 HTML</strong>，这就埋了个大坑。</p>
<h3 data-id="heading-29">三个方案的优先级</h3>
<p>如果时间紧迫，只能先做一个，建议顺序是：</p>
<ol>
<li><strong>先改 Nginx</strong>（5分钟搞定，治本）</li>
<li><strong>再加前端兜底</strong>（半小时搞定，救急）</li>
<li><strong>最后优化构建</strong>（锦上添花，可选）</li>
</ol>
<h3 data-id="heading-30">一些踩坑经验</h3>
<p><strong>关于 Nginx 配置：</strong></p>
<ul>
<li>静态资源目录（<code>/assets/</code>）要单独配置，找不到就返回 404</li>
<li>测试方法：直接浏览器访问一个不存在的 <code>/assets/xxx.js</code>，看返回的是不是 404</li>
<li>别偷懒，该分开配置就分开配置</li>
</ul>
<p><strong>关于缓存策略：</strong></p>
<ul>
<li><code>index.html</code> 千万别缓存，或者设置较短时间的缓存，</li>
<li>这是问题的根源</li>
<li>静态资源随便缓存，文件名带 hash，不会冲突</li>
<li>CDN 的缓存规则要和 Nginx 保持一致</li>
</ul>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[剑指offer-39、平衡⼆叉树]]></title>    <link>https://juejin.cn/post/7574270661872844838</link>    <guid>https://juejin.cn/post/7574270661872844838</guid>    <pubDate>2025-11-19T14:21:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574270661872844838" data-draft-id="7572497847770628123" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="剑指offer-39、平衡⼆叉树"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-11-19T14:21:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            剑指offer-39、平衡⼆叉树
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T14:21:34.000Z" title="Wed Nov 19 2025 14:21:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">题⽬描述</h2>
<p>输⼊⼀棵节点数为 n ⼆叉树，判断该⼆叉树是否是平衡⼆叉树。</p>
<p>在这⾥，我们只需要考虑其平衡性，不需要考虑其是不是排序⼆叉树</p>
<p>平衡⼆叉树（ Balanced Binary Tree ），具有以下性质：它是⼀棵空树或它的左右两个⼦树的⾼度差的绝对值不超过 1 ，并且左右两个⼦树都是⼀棵平衡⼆叉树。</p>
<p>样例解释：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/115a10d767fd4113a84ccf6e865756fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764166894&amp;x-signature=lLsSiREZJAeRrD02LbjeWUOVvqk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">思路及解答</h2>
<h3 data-id="heading-2">自顶向下递归（基础解法）</h3>
<p>平衡树意味着我们需要对⽐任何在同⼀个根下的左右⼦树的⾼度差，还记得之前我们计算树的⾼度么，使⽤递归⽅式来解决，其实这道题与算⾼度差不多，只是两边⾼度需要算出⼀个差值。</p>
<p>算法的主要思想：</p>
<ul>
<li>不断对⽐每两个节点的左右⼦树的最⼤⾼度差，注意取差的绝对值，需要⼩于等于1</li>
<li>对⽐完左右⼦树之后，需要递归左⼦树以及右⼦树进⾏分别判断，都满⾜才是平衡树</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution79</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">IsBalanced_Solution</span><span class="hljs-params">(TreeNode root)</span> {
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-comment">// 当前左右⼦树是否平衡以及左右⼦树分别是否平衡</span>
        <span class="hljs-keyword">return</span> Math.abs(depth(root.left) - depth(root.right)) &lt;= <span class="hljs-number">1</span> &amp;&amp;
            IsBalanced_Solution(root.left) &amp;&amp; IsBalanced_Solution(root.right);
    }
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">depth</span><span class="hljs-params">(TreeNode root)</span> {
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        <span class="hljs-comment">// 递归获取深度</span>
        <span class="hljs-keyword">return</span> Math.max(depth(root.left), depth(root.right)) + <span class="hljs-number">1</span>;
    }
}
</code></pre>
<ul>
<li>时间复杂度 O(nlogn) ：最差情况下，需要遍历树所有节点判断是否平衡，需要O(n)。但是判断每个节点最⼤⾼度需要递归左右⼦树，需要占⽤ O(log2n) ，所以总共占⽤ O(Nlog2n)</li>
<li>空间复杂度 O(n) ：最差情况下，也就是树退化为链表时，递归需要使⽤ O(n) 的栈空间，严格意义上递归栈也需要空间。</li>
</ul>
<h3 data-id="heading-3">自底向上递归（优化解法）</h3>
<p>上⾯的计算，仔细观察就会发现会有很多重复计算的过程，⽐如下⾯的数，计算⼦树深度的时候，计算 1 的左⼦树，和计算 2 的，基本都重复了。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c16cee843a1642648ddf18e1ea8e828b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764166894&amp;x-signature=%2B3VOdWzJvB2Zjxio%2FjJBNkPK4eI%3D" alt="" loading="lazy"/></p>
<p>应该如何避免这种重复计算呢？前⾯的是⾃顶向下的⽅式，因为每个节点都得把⼦树计算⼀遍才需要重复，如果我们从下往上计算，那不就避免了重复计算。后序遍历，先判断子树平衡性，再判断当前节点，对⽐逻辑如下：</p>
<ul>
<li>如果当前节点为空，⾼度为0</li>
<li>如果当前节点的左⼦树的⾼度为-1，那么说明不平衡，否则，需要计算右⼦树⾼度，同样需要不等于-1，如果两者的差不符合⼩于等于1，那么说明它们不平衡，返回-1。通过这样 -1 异常值就会⼀路返回，到最初的调⽤处，得到不平衡的结果。</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution79</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">IsBalanced_Solution</span><span class="hljs-params">(TreeNode root)</span> {
        <span class="hljs-comment">// 空树</span>
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> getHeight(root) != -<span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHeight</span><span class="hljs-params">(TreeNode root)</span> {
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//空节点高度为0</span>
        }
        <span class="hljs-comment">// 左⼦树的⾼度</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> getHeight(root.left);
        <span class="hljs-keyword">if</span> (left &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<span class="hljs-comment">//左子树不平衡，直接返回</span>
        }
        <span class="hljs-comment">// 右⼦树的⾼度</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> getHeight(root.right);
        <span class="hljs-keyword">if</span> (right &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<span class="hljs-comment">//右子树不平衡，直接返回</span>
        }
        
        <span class="hljs-comment">// 检查当前节点是否平衡</span>
        <span class="hljs-keyword">return</span> Math.abs(left - right) &gt; <span class="hljs-number">1</span> ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span> + Math.max(left, right);
    }
}
</code></pre>
<ul>
<li>时间复杂度 O(n) ：每个节点计算⼀次</li>
<li>空间复杂度 O(n) ：递归需要使⽤额外堆栈空间</li>
</ul>
<p>笔试面试时，建议首选这个方式，效率最优，代码简洁</p>
<h3 data-id="heading-4">封装信息法（面向对象思路）</h3>
<p>通过自定义类同时返回高度和平衡信息，代码结构更清晰。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BalanceInfo</span> {
    <span class="hljs-type">boolean</span> isBalanced;
    <span class="hljs-type">int</span> height;
    
    BalanceInfo(<span class="hljs-type">boolean</span> isBalanced, <span class="hljs-type">int</span> height) {
        <span class="hljs-built_in">this</span>.isBalanced = isBalanced;
        <span class="hljs-built_in">this</span>.height = height;
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isBalanced</span><span class="hljs-params">(TreeNode root)</span> {
        <span class="hljs-keyword">return</span> checkBalance(root).isBalanced;
    }
    
    <span class="hljs-keyword">private</span> BalanceInfo <span class="hljs-title function_">checkBalance</span><span class="hljs-params">(TreeNode node)</span> {
        <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BalanceInfo</span>(<span class="hljs-literal">true</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 空节点平衡且高度为0</span>
        }
        
        <span class="hljs-comment">// 递归检查左右子树</span>
        <span class="hljs-type">BalanceInfo</span> <span class="hljs-variable">leftInfo</span> <span class="hljs-operator">=</span> checkBalance(node.left);
        <span class="hljs-type">BalanceInfo</span> <span class="hljs-variable">rightInfo</span> <span class="hljs-operator">=</span> checkBalance(node.right);
        
        <span class="hljs-comment">// 如果子树不平衡，直接返回</span>
        <span class="hljs-keyword">if</span> (!leftInfo.isBalanced || !rightInfo.isBalanced) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BalanceInfo</span>(<span class="hljs-literal">false</span>, -<span class="hljs-number">1</span>); <span class="hljs-comment">// 高度值此时不重要</span>
        }
        
        <span class="hljs-comment">// 检查当前节点是否平衡</span>
        <span class="hljs-keyword">if</span> (Math.abs(leftInfo.height - rightInfo.height) &gt; <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BalanceInfo</span>(<span class="hljs-literal">false</span>, -<span class="hljs-number">1</span>);
        }
        
        <span class="hljs-comment">// 返回当前节点的平衡信息和高高度</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">currentHeight</span> <span class="hljs-operator">=</span> Math.max(leftInfo.height, rightInfo.height) + <span class="hljs-number">1</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BalanceInfo</span>(<span class="hljs-literal">true</span>, currentHeight);
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TypeScript 简史：它是怎么拯救我的烂代码的]]></title>    <link>https://juejin.cn/post/7574321422399963162</link>    <guid>https://juejin.cn/post/7574321422399963162</guid>    <pubDate>2025-11-19T14:25:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574321422399963162" data-draft-id="7574289653177679910" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" TypeScript 简史：它是怎么拯救我的烂代码的"/> <meta itemprop="keywords" content="TypeScript,JavaScript"/> <meta itemprop="datePublished" content="2025-11-19T14:25:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="也无风雨也雾晴"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             TypeScript 简史：它是怎么拯救我的烂代码的
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    也无风雨也雾晴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T14:25:04.000Z" title="Wed Nov 19 2025 14:25:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">看烂代码的场景</h2>
<p>接手老旧 JavaScript 项目的时候，盯着屏幕上的一行代码发呆，这种绝望你一定体会过：</p>
<p>JavaScript</p>
<pre><code class="hljs language-kotlin" lang="kotlin">function process(<span class="hljs-keyword">data</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">data</span>.value + <span class="hljs-number">10</span>; <span class="hljs-comment">// 此时 data 是 undefined，程序崩了</span>
}
</code></pre>
<p>看着这个 <code>data</code>，我满脑子都是问号：</p>
<ul>
<li>它是对象还是数字？</li>
<li>到底是谁传进来的？</li>
<li>我要是改了它，会不会导致隔壁模块的页面挂掉？</li>
<li>为什么明明是字符串 <code>'10'</code>，结果拼成了 <code>'1010'</code>？</li>
</ul>
<p>这时候我就在想，要是代码能自己告诉我“我是谁，我从哪里来，我要去哪里”，该多好。</p>
<p>这就是 TypeScript 诞生的意义。它不是微软为了炫技造的轮子，而是为了解决 JavaScript 在大规模应用中“失控”的必然选择。</p>
<hr/>
<h2 data-id="heading-1">为什么我们需要 TypeScript？</h2>
<h3 data-id="heading-2">JavaScript 的“娘胎顽疾”</h3>
<p>JavaScript 诞生的时候，Brendan Eich 只用了 10 天。这事儿说穿了挺传奇，但也留下了隐患。</p>
<p>当时的场景很简单：验证一下表单，改改页面背景色。所以它的设计哲学是 <strong>“怎么方便怎么来”</strong> ：</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">data</span> = <span class="hljs-string">"hello"</span><span class="hljs-comment">;</span>
<span class="hljs-attr">data</span> = <span class="hljs-number">123</span><span class="hljs-comment">;           // 随便改类型，没事</span>
<span class="hljs-attr">data.abcd</span> = <span class="hljs-string">"what?"</span><span class="hljs-comment">;  // 随便加属性，也不报错</span>
</code></pre>
<p>这种“自由”在写几十行代码时是天堂，但在写几十万行代码时就是地狱。</p>
<h3 data-id="heading-3">事情是怎么失控的？</h3>
<p>随着 <strong>Ajax</strong> 和 <strong>Node.js</strong> 的出现，前端不再是画页面的，而是写应用程序的。</p>
<p>想想也是，当代码量从 500 行变成 50,000 行，团队从 1 个人变成 20 个人：</p>
<ul>
<li>你写的 <code>getUser(id)</code>，同事调用时传了个对象。</li>
<li>后端 API 偷偷改了一个字段名，前端只有等到用户点击报错了才知道。</li>
<li>重构？别逗了，改一行代码，心里都要祈祷半天。</li>
</ul>
<p>问题的根源在于 <strong>JavaScript 是动态弱类型</strong>。它在运行前完全不知道自己错了，非要等到撞了南墙（报错）才回头。</p>
<hr/>
<h2 data-id="heading-4">它是怎么解决问题的？</h2>
<h3 data-id="heading-5">核心思路：给 JS 穿上铠甲</h3>
<p>TypeScript 的原理说穿了挺简单：<strong>它就是给 JavaScript 加上了类型约束，但在运行前又把这些约束脱得干干净净。</strong></p>
<p>看个流程图就明白了：</p>
<p>代码段</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[TypeScript源码] --&gt;|编译/检查| B(类型检查器)
    B -- 报错 --&gt; C[修复代码]
    B -- 通过 --&gt; D[抹除类型信息]
    D --&gt; E[纯净的JavaScript]
    E --&gt; F[浏览器/Node运行]
</code></pre>
<h3 data-id="heading-6">巧妙的“超集”策略</h3>
<p>微软的大神 Anders Hejlsberg（这也是 C# 之父）非常聪明。他知道如果搞一门新语言，开发者肯定不买账（看看 Google 的 Dart 就知道了）。</p>
<p>所以他搞了个 <strong>“超集（Superset）”</strong> 策略：</p>
<ol>
<li><strong>向后兼容</strong>：任何合法的 JavaScript 代码，直接粘贴进 TypeScript 文件，它都能跑。你不需要重写代码。</li>
<li><strong>类型擦除</strong>：TS 编译后就是普通的 JS。浏览器根本不知道 TS 的存在，不用装任何插件。</li>
</ol>
<p>TypeScript</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// TypeScript 写法</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// 编译出来的 JavaScript（类型全没了）</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<p>这招“瞒天过海”非常高明，既让你爽了（有类型检查），又让浏览器爽了（只认 JS）。</p>
<hr/>
<h2 data-id="heading-7">为什么 TS 能赢？（深度分析）</h2>
<p>在 TS 出来之前，Google 的 Closure 和 Dart，甚至 Facebook 的 Flow 都尝试过解决这个问题。为什么最后是 TypeScript 统一了江湖？</p>
<h3 data-id="heading-8">对比分析</h3>
<p>我们来看看这张技术演进图：</p>
<p>代码段</p>
<pre><code class="hljs language-mermaid" lang="mermaid">timeline
    title 前端类型探索之路
    2009 : Closure Compiler : 注释太繁琐
    2009 : CoffeeScript : 语法糖，无类型
    2011 : Dart : 甚至想换掉JS虚拟机
    2012 : TypeScript 诞生 : 拥抱JS，做超集
    2014 : Angular 宣布采用 TS
    2016 : VS Code 崛起
    2023 : 统治地位确立
</code></pre>
<h3 data-id="heading-9">TypeScript 胜出的关键点</h3>
<ol>
<li>
<p>工具链的降维打击</p>
<p>这点必须得吹一下 VS Code。VS Code 是用 TS 写的，它对 TS 的支持简直是原生级的。</p>
<ul>
<li><strong>智能补全</strong>：你打个点 <code>.</code>，属性全出来了，不用去翻文档。</li>
<li><strong>重构神器</strong>：按 F2 重命名一个变量，整个项目几百个文件里的引用全改好了。</li>
</ul>
</li>
<li>
<p>渐进式的温柔</p>
<p>CoffeeScript 和 Dart 要求你“学会新语法，忘掉旧习惯”。</p>
<p>TypeScript 说：“没事，你先用 any 凑合着，等有空了再补类型。”这种低门槛让很多老项目敢于尝试迁移。</p>
</li>
<li>
<p>生态圈的马太效应</p>
<p>现在你装个第三方库，如果没有自带 TypeScript 类型定义（d.ts），大家都会觉得这个库“不正规”。Angular、Vue3、React 全部深度拥抱 TS。</p>
</li>
</ol>
<h3 data-id="heading-10">潜在的坑</h3>
<p>当然，TS 也不是银弹，这里要注意几个软肋：</p>
<ul>
<li><strong>AnyScript 现象</strong>：很多新手遇到类型报错就写 <code>any</code>，结果写成了“带编译过程的 JavaScript”，完全失去了类型的意义。</li>
<li><strong>体操级类型</strong>：有时候为了描述一个复杂的动态结构，类型定义写得比业务逻辑还长，人称“类型体操”。</li>
<li><strong>编译时间</strong>：项目大了以后，<code>tsc</code> 跑一遍确实挺慢的（虽然现在有了 SWC/Esbuild 等加速方案）。</li>
</ul>
<hr/>
<h2 data-id="heading-11">写在最后</h2>
<p>TypeScript 的成功告诉我们要顺势而为。它没有试图颠覆 JavaScript，而是承认了 JS 的混乱，然后提供了一套工具来管理这种混乱。</p>
<p>下次当你接手一个全是 <code>any</code> 的 TS 项目时，你会知道：</p>
<ul>
<li>这哥们儿可能是在迁移初期。</li>
<li>或者他只是单纯的懒。</li>
<li><strong>最重要的</strong>：至少你还能重构，因为编译器会教你做人。</li>
</ul>
<p>如果你的团队还在用纯 JS 裸奔，<strong>赶紧试试 TS 吧</strong>。哪怕只是为了那个“点一下能出属性提示”的爽快感，也值了。</p>
<hr/>
<p><strong>相关文档</strong>：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.typescriptlang.org%2Fdocs%2F" target="_blank" title="https://www.typescriptlang.org/docs/" ref="nofollow noopener noreferrer">TypeScript 官方手册</a> - 最权威的文档。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fbasarat.gitbook.io%2Ftypescript%2F" target="_blank" title="https://basarat.gitbook.io/typescript/" ref="nofollow noopener noreferrer">TypeScript Deep Dive</a> - 很多底层原理讲得很透。</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[从 Flink 到 Doris 的实时数据写入实践——基于 Flink CDC 构建更实时高效的数据集成链路]]></title>    <link>https://juejin.cn/post/7574244766424465417</link>    <guid>https://juejin.cn/post/7574244766424465417</guid>    <pubDate>2025-11-19T14:35:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574244766424465417" data-draft-id="7574270661872746534" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="从 Flink 到 Doris 的实时数据写入实践——基于 Flink CDC 构建更实时高效的数据集成链路"/> <meta itemprop="keywords" content="数据库"/> <meta itemprop="datePublished" content="2025-11-19T14:35:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SelectDB"/> <meta itemprop="url" content="https://juejin.cn/user/3189021726222904"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            从 Flink 到 Doris 的实时数据写入实践——基于 Flink CDC 构建更实时高效的数据集成链路
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3189021726222904/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SelectDB
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T14:35:21.000Z" title="Wed Nov 19 2025 14:35:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读12分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Flink-Doris-Connector 作为 Apache Flink 与 Doris 之间的桥梁，打通了实时数据同步、维表关联与高效写入的关键链路。本文将深入解析 Flink-Doris-Connector 三大典型场景中的设计与实现，并结合 Flink CDC 详细介绍了整库同步的解决方案，助力构建更加高效、稳定的实时数据处理体系。</p>
<h2 data-id="heading-0">一、Apache Doris 简介</h2>
<p>Apache Doris 是一款基于 MPP 架构的高性能、实时的分析型数据库，整体架构精简，只有 FE 、BE 两个系统模块。其中 FE 主要负责接入请求、查询解析、元数据管理和任务调度，BE 主要负责查询执行和数据存储。Apache Doris 支持标准 SQL 并且完全兼容 MySQL 协议，可以通过各类支持 MySQL 协议的客户端工具和 BI 软件访问存储在 Apache  Doris 中的数据库。</p>
<p>在典型的数据集成和处理链路中，往往会对 TP 数据库、用户行为日志、时序性数据以及本地文件等数据源进行采集，经由数据集成工具或者 ETL 工具处理后写入至实时数仓 Apache Doris 中，并由 Doris 对下游数据应用提供查询和分析，例如典型的 BI 报表分析、OLAP 多维分析、Ad-hoc 即席查询以及日志检索分析等多种数据应用场景。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/405407dd99ad46cdb8441a721b3ee8e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=M672N75c%2B%2F8T3mTUtXqmqhqluEI%3D" alt="Apache Doris 简介 .PNG" loading="lazy"/></p>
<p>Flink-Doris-Connector 是 Apache Doris 与 Apache Flink 在实时数据处理 ETL 的结合，依托 Flink 提供的实时计算能力，构建高效的数据处理和分析链路。Flink-Doris-Connector 的使用场景主要分为三种：</p>
<ol>
<li><strong>Scan</strong>：通常用来做数据同步或是跟其他数据源的联合分析；</li>
<li><strong>Lookup Join</strong>：将实时流中的数据和 Doris 中的维度表进行 Join；</li>
<li><strong>Real-time ETL</strong>：使用 Flink 清洗数据再实时写入 Doris 中。</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e6c4300c02a41afb3c62f22d7150902~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=osqqy1D7DXJ8L8uL9P5irAfJW6g%3D" alt="Apache Doris 简介 -2.PNG" loading="lazy"/></p>
<h2 data-id="heading-1">二、Flink-Doris-Connector 典型场景的设计与实现</h2>
<p>本章节结合 Scan、Lookup Join、Write 这三种场景，介绍 Flink-Doris-Connector 的设计与实现。</p>
<h3 data-id="heading-2">01 Scan 场景</h3>
<p>Scan 场景指将 Doris 中的存量数据快速提取出来，当从 Doris 中读取大量数据时，使用传统的 JDBC 方法可能会面临性能瓶颈。因此 Flink-Doris-Connector 中可以借助 Doris Source ，充分利用 Doris 的分布式架构和 Flink 的并行处理能力，从而实现了更高效的数据同步。</p>
<h4 data-id="heading-3">Doris Source 读取流程</h4>
<ul>
<li>Job Manager 向 FE 端发起请求查询计划，FE 会返回要查询的数据对应的 BE 以及 Tablet；</li>
<li>根据不同的 BE，将请求分发给不同的 TaskManager；</li>
<li>通过 Task Manager 直接读取每个 BE 上对应 Tablet 的数据。</li>
</ul>
<p>通过这种方式，我们可以利用 Flink 分布式处理的能力从而提高整个数据同步的效率。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e68bd5321f74e3fbf4d6d2c790a2e26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=aVV07P%2BPiS3ZFL9J87euX01YYw8%3D" alt="Doris Source 读取流程.PNG" loading="lazy"/></p>
<h3 data-id="heading-4">02 Lookup Join 场景</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0e7362f40c64379b74978b4fc3e5d99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=AuKUSritBtH1w9okDh6uTaV8pzM%3D" alt="Lookup Join 场景.PNG" loading="lazy"/></p>
<p>对于维度表存储在 Doris 中的场景，可通过 Lookup Join 实现对实时流数据与 Doris 维度表的关联查询。</p>
<h4 data-id="heading-5">JDBC Connector</h4>
<p>Doris 支持 MySQL 协议，所以可以直接使用 JDBC Connector 进行 Lookup Join，但是这一方式存在一定的局限：</p>
<ul>
<li>Jdbc Connector 中的 Lookup Join 是同步查询的操作，会导致实时流中每条数据都要等待 Doris 查询的结果，增加了延迟。</li>
<li>仅支持单条数据查询，在上游数据量吞吐较高时，容易造成性能瓶颈和反压。</li>
</ul>
<h4 data-id="heading-6">Flink-Doris-Connector 的优化</h4>
<p>因此针对 Lookup Join 场景 ，Flink-Doris-Connector 实现了异步 Lookup Join 和攒批查询的优化：</p>
<ul>
<li><strong>支持异步 Lookup Join：</strong> 异步 Lookup Join 意味着实时流中的数据不需要显式等待每条记录的查询结果，可以大大的降低延迟性。</li>
<li><strong>支持攒批查询：</strong> 将实时流的数据追加到队列 Queue 中，后台通过监听线程 Watcher，将队列里面的数据取出来再推送到查询执行的 Worker 线程池中，Worker 线程会将收到的这一批数据拼接成一个 Union All 的查询，同时向 Doris 发起 Query 查询。</li>
</ul>
<p>通过异步 Lookup join 以及攒批查询，可以在上游数据量比较大的时候大幅度提高维表关联吞吐量，保障了数据读取与处理的高效性。</p>
<h3 data-id="heading-7">03 实时 ETL 场景</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76eae7d3e54b4d55909c5b74fd6e6544~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=z5GrSjZ0Gecy9Tk%2FHfj2dzg0nLE%3D" alt="实时 ETL 场景.png" loading="lazy"/></p>
<p>对于实时写入来说，Doris Sink 的写入是基于 Stream Load 的导入方式去实现的。Stream Load 是 Apache Doris 中最为常见的数据导入方式之一，支持通过 HTTP 协议将本地文件或数据流导入到 Doris 中。主要流程如下：</p>
<ul>
<li>Sink 端在接收到数据后会开启一个 Stream Load 的长链接请求。在 Checkpoint 期间，它会将接收到的数据以 Chunk 的形式持续发送到 Doris 中。</li>
<li>Checkpoint 时，会对刚才发起的 Stream Load 的请求进行提交，提交完成后，数据才会可见。</li>
</ul>
<h4 data-id="heading-8">如何保证数据写入的 Exactly-Once 语义</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d8570e53ec247cbbddaa4af740123bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=Xw3pxFrGaXyM6vvmHXULQX9Rd3A%3D" alt="如何保证数据写入的 Exactly-Once 语义 .png" loading="lazy"/></p>
<p>那么，如何保证数据写入期间，端到端数据的精确一次性？</p>
<p>以 Kafka 同步到 Drois 的 Checkpoint 过程为例：</p>
<ol>
<li>Checkpoint 时，Source 端会接收到 Checkpoint Barrier；</li>
<li>Source 端接收到 Barrier 后，首先会对自身做一个快照，同时会将 Checkpoint Barrier 下发到 Sink 端；</li>
<li>Sink 端接收到 Barrier 后，执行 Pre-commit 提交，成功后数据就会完整写入到 Doris，由于此处执行的是预提交，所以在 Doris 上，此时对用户来说数据是不可见的；</li>
<li>将 Pre-Commit 成功的事务 ID 保存到状态中；</li>
<li>所有的算子 Checkpoint 都做完后，Job Manager 会下发本次 Checkpoint 完成的通知；</li>
<li>Sink 端会对刚才 Pre-commit 成功的事务进行一次提交。</li>
</ol>
<p>通过这种两阶段提交，就可以实现端到端的精确一次性。</p>
<h4 data-id="heading-9">实时性与 Exactly-Once</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82131d3ca6c2492d838abfbe76e25a5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=acV40oP24VbY%2F4psUOd9wFN13N0%3D" alt="实时性与 Exactly-Once.png" loading="lazy"/></p>
<p>上面提到，Doris Sink 端的写入与 Checkpoint 绑定，数据写入 Doris 的延迟性取决于 Checkpoint 的间隔。但在一些用户的场景下，希望数据可以实时写入，但是 Checkpoint 不能做的太频繁，同时对于一些作业来说，如果 Checkpoint 太频繁会消耗大量资源，针对该情况，Flink-Doris-Connector 引入了攒批机制，以平衡实时性与资源消耗之间的矛盾。</p>
<p>攒批的实现原理是 Sink 端接收上游数据之后，不会立即将每条数据单独写入 Doris，而是先在内存中进行缓存，然后通过对应参数设置，将缓存数据提交到 Doris 中。结合攒批写入和 Doris 中的主键模型，可以确保数据写入的幂等性。</p>
<p>通过引入攒批机制，既满足了用户对数据实时写入的需求，又避免了频繁 Checkpoint 带来的资源消耗问题，从而实现性能与效率的优化。</p>
<h2 data-id="heading-10">三、基于 Flink CDC 的整库同步方案</h2>
<p>以上是对 Flink-Doris-Connector 的典型场景和实现原理介绍，接下来我们来看它在实际业务中的一个重要应用——整库同步。相比底层实现，整库同步更偏向具体使用场景。下面我们基于前面介绍的能力，进一步探讨如何通过 Flink CDC 实现 TP 数据库到 Doris 的高效、自动化同步。</p>
<h3 data-id="heading-11">01 整库同步痛点</h3>
<p>在数据迁移过程中，用户通常希望可以尽快将数据迁移到 Doris 中，然而在同步 TP 数据库时，整库同步往往面临以下几点挑战：</p>
<ul>
<li><strong>建表：</strong>
<ul>
<li><strong>存量表的快速批量创建</strong>：TP 数据库中往往存在成千上万的表，这些表的结构各异，对于存量表而言需要逐一在 Doris 中创建对应的表结构；</li>
<li><strong>同步任务开启后，新增表的自动创建与同步：</strong> 为了保证数据的完整性和实时性，同步工具需要实时监控 TP 数据库的变化，并自动在 Doris 中创建和同步新表。</li>
</ul>
</li>
<li><strong>元数据映射：</strong> 上下游之间字段元数据的便捷映射，包括字段类型的转换、字段名称的对应修改等。</li>
<li><strong>DDL 自动同步：</strong> 增加、删除列等操作会导致数据库结构发生变化，进而影响到数据同步。因此，同步工具需要能够实时捕获 DDL 并动态地更新 Doris 表结构，以确保数据的准确性和一致性。</li>
<li><strong>开箱即用：</strong> 零代码，低门槛，理想的同步工具只需进行简单配置，即可实现数据的迁移和同步。</li>
</ul>
<h3 data-id="heading-12">02 基于 Flink CDC 实现整库同步</h3>
<p>在数据抽取方面，Flink-Doris-Connector 借用了 Flink CDC 的特性能力：</p>
<ul>
<li>增量快照读取
<ul>
<li>无锁读取与并发读取：不论存量数据量多大，都可以通过横向提高 Flink 的并发提升数据读取速度。</li>
<li>断点续传：当存量数据比较大时，可能面临同步中断的情况，CDC 支持中断任务的衔接同步。</li>
</ul>
</li>
<li>丰富数据源支持，Flink CDC 支持多种数据库，如 MySQL、Oracle、SQLServer 等。</li>
<li>无缝对接 Flink 现有生态，方便与 Flink 已有Source 和 Sink 结合使用。</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3181c0a740ae4cbda4ef13cd18655325~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=aYk64I1YtcQ4diV3fkm07t1T%2FME%3D" alt="基于 Flink CDC 实现整库同步.png" loading="lazy"/></p>
<h4 data-id="heading-13">一键建表与元数据自动映射</h4>
<p>Flink-Doris-Connector 中集成了 Flink CDC 等能力，可以让用户只提交一个操作，就能进行整库同步的操作。其主要原理是 Flink CDC Source 在接收到上游的数据源之后，会进行分流处理，不同的表用不同的 Sink。同时在最新的 Connector 版本中，也支持单个 Sink 同步多张表，支持新增表的创建和同步。</p>
<p>集成 Flink CDC 的功能后，<strong>用户仅需通过 Flink-Doris-Connector 提交任务，就可以在 Doris 自动创建所需的表，而无需配置上下游表之间的显式关联，实现数据快速同步</strong>。</p>
<p>当 Flink 任务启动后，Doris-Flink-Connector 将自动识别对应的 Doris 表是否存在。如果表不存在，Doris Flink Connector 会自动创建表，并根据 Table 名称进行分流，从而实现下游多个表的 Sink 接入；如果表存在，则直接启动同步任务。</p>
<p>这一改进，不仅简化了配置流程，还使得新增表的创建和同步更加便捷，从而提升数据处理的整体效率。</p>
<h4 data-id="heading-14">Light Schema Change 与 DDL 自动同步</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fd014e95def4cf2b17fb6fe68eba079~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=gUaz1InCjgSev3YVtCry%2FyU1Myw%3D" alt="Light Schema Change 与 DDL 自动同步.png" loading="lazy"/></p>
<p>在 Apache Doris 1.2 版本之前，Schema Change 操作比较繁琐，需要手动增改数据列。在上游 TP 数据库发生表结构变更时，需要暂停数据同步任务、待 Doris 中的 Schema Change 完成后再重启任务。</p>
<p>自 Apache Doris 1.2 版本起，我们引入了轻量级的 Light Schema Change 机制，极大地简化了操作流程，常见的增减列场景其处理速度可达毫秒级。Light Schema Change 机制原理如下：</p>
<ul>
<li><strong>Schema Change：</strong>
<ul>
<li>客户端向 FE 发起增减列的请求；</li>
<li>FE 在接收到请求后，修改当前元数据，并将最新的 Schema 持久化；</li>
<li>FE 向客户端同步 Schema Change 的结果；</li>
</ul>
</li>
<li><strong>Data Load：</strong>
<ul>
<li>当后续导入任务发起时，FE 将导入任务与最新的 Schema 信息发送给 BE；</li>
<li>在数据写入过程中，BE 的每个 Rowset 都会存储当前导入的 Schema 信息；</li>
</ul>
</li>
<li><strong>Query：</strong>
<ul>
<li>FE 将查询计划与最新的 Schema 一起发送给 BE；</li>
<li>BE 使用最新 Schema 执行查询计划；</li>
</ul>
</li>
<li><strong>Compaction：</strong>
<ul>
<li>在 BE 中，对参与合并的 Rowset 版本进行比较；</li>
<li>根据最新的  Schema Change 信息进行数据合并。</li>
</ul>
</li>
</ul>
<p>经测试，与早期的 Schema Change 相比，Light Schema Change 的数据同步性能有了数百倍的提升，</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a25ef456fb1441fd96615e59e9065338~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=th5MjuitLDWkHEBRO1kd63FUYHg%3D" alt="Light Schema Change 与 DDL 自动同步-2.png" loading="lazy"/></p>
<p>Light Schema Change 与 Flink-Doris-Connector 的结合，通过 Flink CDC 可以实现 DDL 的自动同步，具体步骤如下：</p>
<ol>
<li>Source 端捕获上游 Schema Change 信息，开启 DDL 变更同步；</li>
<li>Doris Sink 端识别并解析 DDL 操作（加减列）；</li>
<li>Table 校验，判断是否可以进行 Light Schema Change；</li>
<li>发起 Schema Change 操作；</li>
</ol>
<p>基于这一实现，Doris 能自动获取到 DDL 语句并在毫秒级即可完成 Schema Change 操作，在上游 TP 数据库发生表结构变更时，数据同步任务无需暂停。</p>
<h4 data-id="heading-15">开箱即用：MySQL 整库同步示例</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/766f5b42f09441f3a2b7e4edb7d5a6bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=QNg9CvYsdH8mmiSzQP3TJ6CJRwo%3D" alt="开箱即用：MySQL 整库同步示例.png" loading="lazy"/></p>
<p>对于用户来讲，只要有 Flink 客户端，通过上图的操作就可以提交整库同步作业。支持传入 Flink 的配置，比如并发设置、Checkpoint 间隔等，也支持正则表达式去配置需要同步的表， 同时可以将 Flink CDC Source 和 Doris Sink 的配置直接透传给具体的 Connector。通过这种方式，用户可以很便捷地提交整库同步作业。</p>
<h3 data-id="heading-16">03 Flink-Doris-Connector 核心优势</h3>
<p>基于以上优化，可以完美解决用户的痛点：</p>
<ol>
<li>自动建表，即存量表与增量表的自动创建，无需用户提前在 Doris 中预先创建对应的表结构；</li>
<li>自动映射上下游字段，无需手动写入上下游字段间的匹配规则，节省大量人力成本；</li>
<li>增减列无感同步，及时获取上游 DDL 语句并自动在 Doris 中实现毫秒级 Schema Change，无需停服、数据同步任务平稳运行；</li>
<li>开箱即用，降低学习成本，更专注业务本身。</li>
</ol>
<h3 data-id="heading-17">04 最佳实践</h3>
<p>在生产环境中，若作业数量较多，直接采用上述提交方式的作业管理复杂度较高。通常建议借助任务托管平台（如 StreamPark），实现对作业的统一创建、监控与运维，从而提升任务管理效率与系统稳定性。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9a43559eded4d3caf2c7d97fd6245d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=05x7PrmqiBDi28vbX6IqECRwpjo%3D" alt="最佳实践.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0db4a5efa79b4eb2a9c50b1239026f7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764167721&amp;x-signature=lt50R0WcgO%2BPDCX7NkX3%2BSPQkmo%3D" alt="最佳实践-2.png" loading="lazy"/></p>
<h2 data-id="heading-18">四、未来规划</h2>
<p>未来，基于 Flink-Doris-Connector 的能力规划如下：</p>
<ol>
<li>支持实时读取。目前 Doris Source 只是把数据 Scan 出来，是一个有界流的读取，后续会支持 CDC 的场景，可以使用 Flink 来对 Doris 中的数据进行流式的读取。</li>
<li>Sink 一流多表。目前Flink-Doris-Connector支持单个 Sink 同步多张表，但是 Stream Load 的导入方式还是只支持单个表的导入。所以在表特别多的时候，需要在 Sink 端维护大量 StreamLoad 的连接，在后续会做到单个 Stream Load 的连接支持多张表的写入。</li>
<li>整库同步方面，支持更多的上游数据源，满足更多数据同步场景。</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[🎨 新来的外包，在大群分享了它的限流算法的实现]]></title>    <link>https://juejin.cn/post/7574270661872631846</link>    <guid>https://juejin.cn/post/7574270661872631846</guid>    <pubDate>2025-11-19T13:29:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574270661872631846" data-draft-id="7574254039023763482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="🎨 新来的外包，在大群分享了它的限流算法的实现"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T13:29:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="有态度的下等马"/> <meta itemprop="url" content="https://juejin.cn/user/448256476727662"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            🎨 新来的外包，在大群分享了它的限流算法的实现
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/448256476727662/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    有态度的下等马
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T13:29:43.000Z" title="Wed Nov 19 2025 13:29:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fccab2fa5b3487b8b35ea367414ee75~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oCB5bqm55qE5LiL562J6ams:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764165026&amp;x-signature=9EONJsKQiwidlHXLvty%2F1mOeneo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">1. 令牌桶按用户维度限流</h2>
<p>前文<a href="https://juejin.cn/post/7568124427822825512" target="_blank" title="https://juejin.cn/post/7568124427822825512"><code>golang/x/time/rate</code></a>演示了基于<code>整体</code>请求速率的令牌桶限流；<br/>
那基于<code>用户id、ip、apikey</code>请求速率的限流(更贴近生产的需求)， 阁下又该如何应对？</p>
<p>那这个问题就从<code>全局速率</code>变成了按照<code>用户维度（group by userid）</code>来做限流，那么</p>
<ul>
<li>早先的全局的rateLimiter就要变成 userid:rateLimiter的键值对,select count( * ) from table ---&gt; select userid, count(*) from  table group by userid</li>
<li>使用缓存组件来存储维度键值对: 缓存的剔除机制来清理不再访问的键值对 （30min过期，10min周期清理内存）。</li>
</ul>

<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> userLimiters = cache.New(time.Minute*<span class="hljs-number">30</span>, <span class="hljs-number">10</span>) <span class="hljs-comment">// 10 items per minute</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">limiterForUser</span><span class="hljs-params">(userID <span class="hljs-type">string</span>)</span></span> *rate.Limiter {
	<span class="hljs-keyword">if</span> v, found := userLimiters.Get(userID); found {
		<span class="hljs-keyword">return</span> v.(*rate.Limiter)
	}

	l := rate.NewLimiter(rate.Every(time.Minute/<span class="hljs-number">60</span>), <span class="hljs-number">10</span>)
	userLimiters.Set(userID, l, cache.DefaultExpiration)
	<span class="hljs-keyword">return</span> l
}

<span class="hljs-comment">// 更细化的限流： 针对同一用户的请求次数限速， 增加了细粒度的用户维度，需要维护 用户与对应限速器的映射关系</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">userRatelimitMiddleware</span><span class="hljs-params">(c *gin.Context)</span></span> {
	userID := c.GetString(<span class="hljs-string">"userID"</span>)  <span class="hljs-comment">//  从每个请求context的key中取得信息， 这个key对于req context是排他性的</span>
	<span class="hljs-keyword">if</span> userID == <span class="hljs-string">""</span> {
		c.AbortWithStatusJSON(http.StatusUnauthorized, gin.H{<span class="hljs-string">"error"</span>: <span class="hljs-string">"Unauthorized"</span>})
		<span class="hljs-keyword">return</span>
	}
	<span class="hljs-keyword">if</span> userID == <span class="hljs-string">""</span> {
		userID = c.GetString(<span class="hljs-string">"x-api-key"</span>)
	}

	<span class="hljs-keyword">if</span> userID == <span class="hljs-string">""</span> {
		userID = c.ClientIP()
	}
	limiter := limiterForUser(userID) <span class="hljs-comment">// 通过userid维度找到对应的限速器</span>
	<span class="hljs-keyword">if</span> !limiter.Allow() {
		c.AbortWithStatusJSON(http.StatusTooManyRequests, gin.H{<span class="hljs-string">"error"</span>: <span class="hljs-string">"Too many requests"</span>})
		<span class="hljs-keyword">return</span>
	}
	c.Next()
}
</code></pre>
<h2 data-id="heading-1">2. redis 作为限流器外置存储</h2>
<p>这个思路也是极其常见的行为： redis可以成为用户令牌桶的全局中心存储： 当多个负载层需要读写用户限流器时，与redis交互。</p>
<p>本次通过golang的实战，深入理解基于redis的令牌桶限流器的算法实现。</p>
<p>①  请求到达负载层，被负载层识别为userid=junio</p>
<p>②  负载层请求redis获取该用户的token bucket的当前状态:
<code>hget userbucket:junio tokens last_time</code></p>
<p>③  基于当前时间<code>now</code>和<code>last_time</code>，计算流逝的时间，再根据rate计算这一阶段下发了多少tokens:<code>delta=(now-last_time) * r/1000</code>，加上redis原始记录的<code>token</code>,就是本次请求时bucket中能用的tokens， 注意：令牌数量最多不能超过cap</p>
<p>④ 如果tokens&gt;=1, 表示桶中有令牌，可放行请求，tokens数量减1</p>
<p>⑤ 最后将本次处理完后的 tokens和<code>last_time=now</code>写入原用户令牌桶
<code>hset  userbucket:junio  tokens  20 last_time 990</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c02de3fafff04c10a34f558eccb3fbc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oCB5bqm55qE5LiL562J6ams:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764165026&amp;x-signature=fNn9f5DXGXEs1iZ3SeRRomm02io%3D" alt="" loading="lazy"/>
使用redis 中的hashmap存储用户的tokenbucket状态，应用存在<code>读取redis- 计算- 回写redis</code>过程，使用redis lua的脚本执行三个动作，以保证线程安全。</p>
<blockquote>
<p>为什么lua脚本能保证线程安全呢？<br/>
主要得益于 Redis 的单线程架构和原子性执行机制： 加载并执行lua脚本时所有的redis操作作为一个整体完成； 整个脚本执行期间没有其他命令可以插入。</p>
</blockquote>
<pre><code class="hljs language-ini" lang="ini">// 读取- 计算 - 重新赋值都在一个 lua 脚本里面
var <span class="hljs-attr">redisScript</span> = `
	local <span class="hljs-attr">key</span> = KEYS[<span class="hljs-number">1</span>]
	local <span class="hljs-attr">capacity</span> = tonumber(ARGV[<span class="hljs-number">1</span>])
	local <span class="hljs-attr">rate</span> = tonumber(ARGV[<span class="hljs-number">2</span>])
	local <span class="hljs-attr">now</span> = tonumber(ARGV[<span class="hljs-number">3</span>])
	local <span class="hljs-attr">tokens</span> =  tonumber(redis.call(<span class="hljs-string">'hget'</span>, key, <span class="hljs-string">'tokens'</span>) or <span class="hljs-string">'-1'</span>)
	local <span class="hljs-attr">last_time</span> = tonumber(redis.call(<span class="hljs-string">'hget'</span>, key, <span class="hljs-string">'last_time'</span>) or  <span class="hljs-string">'-1'</span>)

	if <span class="hljs-attr">tokens</span>  == -<span class="hljs-number">1</span> or last_time == -<span class="hljs-number">1</span> then
		<span class="hljs-attr">tokens</span> = capacity
		<span class="hljs-attr">last_time</span> = now
	else
		local <span class="hljs-attr">elapsed</span> = now - last_time
        if elapsed &lt; 0 
			then <span class="hljs-attr">elapsed</span> = <span class="hljs-number">0</span>
		end
		local <span class="hljs-attr">delta</span>  = elapsed * rate / <span class="hljs-number">1000</span>
		<span class="hljs-attr">tokens</span> = tokens + delta
		if tokens &gt; capacity then
			<span class="hljs-attr">tokens</span> = capacity
		end
        <span class="hljs-attr">last_time</span> = now
	end
	local <span class="hljs-attr">allow</span> = <span class="hljs-number">0</span>
	if tokens &gt;= 1 then
		<span class="hljs-attr">allow</span> = <span class="hljs-number">1</span>
		<span class="hljs-attr">tokens</span>= tokens - <span class="hljs-number">1</span>
	else	
		<span class="hljs-attr">allow</span> = <span class="hljs-number">0</span>
	end

	redis.call('hset', key, 'tokens', tokens)
	redis.call('hset', key, 'last_time', last_time)
    redis.call('PEXPIRE', key,  math.max(1000, 2 * math.ceil((capacity / rate) * 5000)))
	return allow
`
</code></pre>
<p>注意</p>
<ul>
<li>上面还使用的redis expire机制： redis expire不是滑动过期，但是每次被请求触发执行的时候就重新设置TTL， 表现为“滑动过期”。</li>
<li>除了hset/hget ,还有hmget可用，另外这些操作还有配套的TTL指令，eg：<code>hset key EXAT  1740470400 FIELDS 2 field1 "Hello" field2 "World"</code>。</li>
</ul>
<p>golang应用层的写法如下：</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(r *RedisLimiter)</span></span> Allow(c *gin.Context, userid <span class="hljs-type">string</span>) <span class="hljs-type">bool</span> {
	key := r.keyprefix + userid <span class="hljs-comment">// 定位这个用户的token bucket</span>
	now := time.Now().UnixMilli()
	<span class="hljs-comment">// Check if the key exists in Redis</span>
	rCmd := r.redis.Eval(redisScript, []<span class="hljs-type">string</span>{key}, r.<span class="hljs-built_in">cap</span>, r.rate, now)
	res, err := rCmd.Result()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		log.Printf(<span class="hljs-string">"get from redis failure. "</span>, err)
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
	}
	<span class="hljs-keyword">if</span> allow, ok := res.(<span class="hljs-type">int64</span>); ok { <span class="hljs-comment">// 注意：lua返回的0,1 值对应golang的int64</span>
		log.Printf(<span class="hljs-string">"%v %v \n"</span>, allow, res)
		<span class="hljs-keyword">return</span> allow == <span class="hljs-number">1</span>
	} <span class="hljs-keyword">else</span> {
		log.Printf(<span class="hljs-string">"get from redis failure. "</span>, err)
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
	}
}
</code></pre>
<hr/>
<h2 data-id="heading-2">3. 总结展望</h2>
<p>至此限流第二弹结束了，本文紧接掘金爆文<a href="https://juejin.cn/post/7568124427822825512" target="_blank" title="https://juejin.cn/post/7568124427822825512">🎨 新来的外包，限流算法用的这么6</a>，进一步讲述了<br/>
① 实现根据特定业务维度的限流： 从全局限流器转换成针对业务维度的键值对限流器；</p>
<p>② redis作为限流计数器的外置存储，令牌桶算法在redis上实现原理：核心是使用hashmap存储当前请求用户的令牌桶状态（current_tokens, last_time）, 落地时注意使用lua脚本避免竞态条件。</p>
<p>后面35+外包er针对限流设计还会再更新几个彩蛋， 期待一键三连，交个朋友， 35+报团不迷路。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Claude Skills实战指南：Skill Seekers 自动生成 SiliconFlow API 技能]]></title>    <link>https://juejin.cn/post/7574250031249014818</link>    <guid>https://juejin.cn/post/7574250031249014818</guid>    <pubDate>2025-11-19T13:27:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574250031249014818" data-draft-id="7574245788949643279" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Claude Skills实战指南：Skill Seekers 自动生成 SiliconFlow API 技能"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T13:27:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wwwzhouhui"/> <meta itemprop="url" content="https://juejin.cn/user/3428746411400537"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Claude Skills实战指南：Skill Seekers 自动生成 SiliconFlow API 技能
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3428746411400537/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wwwzhouhui
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T13:27:02.000Z" title="Wed Nov 19 2025 13:27:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读14分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>在AI开发日益火热的今天,如何让Claude AI更高效地调用各种API成为了开发者关注的焦点。传统方式下,每次调用一个新的API服务,我们都需要查阅文档、理解参数、编写调用代码,费时费力。特别是硅基流动(SiliconFlow)这样功能丰富的API平台,光是API文档就有数十个页面,手动整理成Claude能理解的技能包,少说也要几个小时。</p>
<p>Skill Seekers 是一个开源的自动化工具,它能够自动将任何文档网站、GitHub仓库和PDF文件转换成Claude AI可直接使用的技能包。核心原理是通过智能爬虫抓取文档内容,使用AI分析和归类,最终打包成标准的.zip技能文件。只需30分钟,就能完成从文档URL到Claude可用技能包的全流程转换。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56e868297abc44b08dc43d691e6e9d8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=o30Moq83XsTDcr5MztQAlRasUTo%3D" alt="image-20251119205854213" loading="lazy"/></p>
<p>Skill Seekers 通过统一多源抓取技术,突破了传统文档转换工具的瓶颈,实现文档+GitHub+PDF三合一,同时提供冲突检测功能,确保文档和代码的一致性。之前教大家使用官方提供的<strong>skill-creator</strong> 来实现 <strong>skills</strong>生成。对之前skill-creator使用不熟悉的小伙伴可以看我之前的文章《<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FNHMuneNRFmFvWfEDPkvV1g%3Fscene%3D1%26click_id%3D1" target="_blank" title="https://mp.weixin.qq.com/s/NHMuneNRFmFvWfEDPkvV1g?scene=1&amp;click_id=1" ref="nofollow noopener noreferrer">Claude Skills 新玩法：用 skill-creator 10 分钟搞定 Excel 报表自动化，职场人必学</a>》今天给大家介绍Skill Seekers  这个开源项目。</p>
<p>使用这个工具,体验一下自动生成硅基流动API技能包的能力。</p>
<h2 data-id="heading-1">项目介绍</h2>
<h3 data-id="heading-2">✨ 核心特性</h3>
<p>Skill Seekers 是一个功能强大的文档转技能工具,具备以下核心特性:</p>
<ul>
<li><strong>🌐 多源抓取</strong>: 支持文档网站、GitHub仓库、PDF文件三合一</li>
<li><strong>🤖 AI 增强</strong>: 免费本地增强,使用Claude Code Max,无需API密钥</li>
<li><strong>⚡ 高性能</strong>: 异步模式下2-3倍速度提升,处理500页文档仅需9分钟</li>
<li><strong>🔍 冲突检测</strong>: 自动发现文档与代码之间的不一致,生成对比报告</li>
<li><strong>📦 智能分类</strong>: 自动将内容归类为入门、API、教程等类别</li>
<li><strong>🔧 MCP 集成</strong>: 9个工具直接集成到Claude Code,自然语言控制</li>
<li><strong>💾 断点续传</strong>: 大型文档抓取支持中断恢复,永不丢失进度</li>
<li><strong>✅ 生产就绪</strong>: 9,731行生产代码,372+测试函数,100%通过率</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c93a8d78396427a96449ba7b0f2f12f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=nohyBg4bTR5Oz0u2UVRXSXbjOks%3D" alt="image-20251119204605561" loading="lazy"/></p>
<h3 data-id="heading-3">🛠️ 技术栈</h3>
<p><strong>核心依赖</strong></p>
<ul>
<li><strong>语言</strong>: Python 3.10+</li>
<li><strong>HTML解析</strong>: BeautifulSoup4</li>
<li><strong>HTTP客户端</strong>: Requests/httpx</li>
<li><strong>异步支持</strong>: async/await</li>
</ul>
<p><strong>高级功能</strong></p>
<ul>
<li><strong>GitHub API</strong>: PyGithub</li>
<li><strong>PDF提取</strong>: PyMuPDF + pytesseract(OCR)</li>
<li><strong>图像处理</strong>: Pillow</li>
<li><strong>MCP协议</strong>: mcp (Model Context Protocol)</li>
</ul>
<p><strong>可选增强</strong></p>
<ul>
<li><strong>AI增强</strong>: anthropic (API模式)</li>
<li><strong>测试</strong>: pytest (372+测试)</li>
</ul>
<h3 data-id="heading-4">🎯 应用场景</h3>
<ul>
<li><strong>开发者</strong>: 为常用框架(React、Vue、Django等)创建技能包</li>
<li><strong>团队</strong>: 将内部文档+代码仓库合并为单一知识源</li>
<li><strong>游戏开发</strong>: Godot、Unity引擎文档快速转换</li>
<li><strong>API服务</strong>: 快速为第三方API(如SiliconFlow)生成调用技能</li>
<li><strong>学习者</strong>: 从文档+代码示例+PDF手册构建完整学习技能</li>
</ul>
<h3 data-id="heading-5">📊 性能数据</h3>
<p>根据官方测试数据,Skill Seekers 在不同规模文档下的性能表现:</p>





























<table><thead><tr><th>文档规模</th><th>同步模式</th><th>异步模式</th><th>提升倍数</th></tr></thead><tbody><tr><td>React (~500页)</td><td>28分钟</td><td>9分钟</td><td><strong>3.1倍</strong></td></tr><tr><td>Godot (~2,000页)</td><td>112分钟</td><td>37分钟</td><td><strong>3倍</strong></td></tr><tr><td>Godot完整 (~40,000页)</td><td>30+小时</td><td>4-8小时</td><td><strong>节省75%+</strong></td></tr></tbody></table>
<h2 data-id="heading-6">部署实战</h2>
<h3 data-id="heading-7">环境准备</h3>
<p>我们首先需要确保 Skill Seekers 已经正确安装。本次实战演示在已安装好的环境中进行。</p>
<p>检查当前环境:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 查看是否已安装</span>
<span class="hljs-built_in">ls</span> -la ~/.claude/skills/
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/381da324a34a472fba6924fd95e82d7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=Bhq2HBzrJvdQbJqOLqINaWFym2k%3D" alt="环境检查" loading="lazy"/></p>
<p>从截图可以看到,当前运行环境已经安装好 skill-seekers,我们可以直接使用。</p>
<p><strong>如果你还没安装,请执行以下步骤:</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. 克隆仓库</span>
git <span class="hljs-built_in">clone</span> https://github.com/yusufkaraaslan/Skill_Seekers.git
<span class="hljs-built_in">cd</span> Skill_Seekers

<span class="hljs-comment"># 2. 创建虚拟环境(推荐)</span>
python3 -m venv venv
<span class="hljs-built_in">source</span> venv/bin/activate  <span class="hljs-comment"># Windows: venv\Scripts\activate</span>

<span class="hljs-comment"># 3. 安装依赖</span>
pip install requests beautifulsoup4

<span class="hljs-comment"># 4. 可选: 设置MCP集成</span>
./setup_mcp.sh
</code></pre>
<h3 data-id="heading-8">准备硅基流动文档URL</h3>
<p>在开始之前,我们先访问硅基流动的官方文档网站: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.siliconflow.cn%2Fcn%2Fuserguide%2Fintroduction" target="_blank" title="https://docs.siliconflow.cn/cn/userguide/introduction" ref="nofollow noopener noreferrer">docs.siliconflow.cn/cn/userguid…</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f5ba43d31814430b8572e29d34786b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=PKJqkFYrU4GqhdTAqGscPIDTWQo%3D" alt="硅基流动文档首页" loading="lazy"/></p>
<p>硅基流动提供了丰富的文档资源,包括:</p>
<ul>
<li><strong>用户指南</strong> - 基础使用说明</li>
<li><strong>场景示例</strong> - 实际应用案例</li>
<li><strong>API手册</strong> - 详细的API接口文档</li>
<li><strong>常见问题</strong> - FAQ解答</li>
<li><strong>更新公告</strong> - 版本更新信息</li>
<li><strong>条款与协议</strong> - 使用条款</li>
</ul>
<p><strong>我们的目标</strong>: 将这些文档整合成一个技能包,以后在使用硅基流动API时,只需告诉Claude"使用硅基流动的DeepSeek模型生成文本",而无需每次都手动查找API文档、复制请求代码。</p>
<h3 data-id="heading-9">使用 Skill Seekers 生成技能包</h3>
<p>准备好需要抓取的文档URL列表:</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.siliconflow.cn/cn</span><span class="hljs-regexp">/userguide/introduction</span>
<span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.siliconflow.cn/cn</span><span class="hljs-regexp">/usercases/use</span>-siliconcloud-<span class="hljs-keyword">in</span>-<span class="hljs-title class_">ClaudeCode</span>
<span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.siliconflow.cn/cn</span><span class="hljs-regexp">/api-reference/chat</span>-completions/chat-completions
<span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.siliconflow.cn/cn</span><span class="hljs-regexp">/faqs/stream</span>-mode
</code></pre>
<p>在Claude Code中输入提示词:</p>
<pre><code class="hljs language-ruby" lang="ruby">请使用<span class="hljs-title class_">Skill</span>_Seekers 帮我把硅基流动的api文档
  <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.siliconflow.cn/cn</span><span class="hljs-regexp">/userguide/introduction</span>
  <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.siliconflow.cn/cn</span><span class="hljs-regexp">/usercases/use</span>-siliconcloud-<span class="hljs-keyword">in</span>-<span class="hljs-title class_">ClaudeCode</span>
  <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.siliconflow.cn/cn</span><span class="hljs-regexp">/api-reference/chat</span>-completions/chat-completions
  <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.siliconflow.cn/cn</span><span class="hljs-regexp">/faqs/stream</span>-mode
  制作成一个硅基流动版本的skills技能。
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61a348cdf46544cf96bf577903860d6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=yi4LqJLLO6bTUFh7prpAlSdKazI%3D" alt="发起请求" loading="lazy"/></p>
<p>从截图中可以看到,AI理解了我们的需求,开始通过fetch来获取硅基流动提供的API文档。</p>
<p><strong>Skill Seekers 工作流程:</strong></p>
<ol>
<li><strong>URL验证</strong> - 检查文档URL是否可访问</li>
<li><strong>内容抓取</strong> - 使用BFS遍历抓取所有相关页面</li>
<li><strong>智能分类</strong> - 根据URL、标题、内容关键词自动分类</li>
<li><strong>代码提取</strong> - 识别并提取代码示例(支持8+语言)</li>
<li><strong>AI增强</strong> - 使用Claude分析并生成最佳实践</li>
<li><strong>打包输出</strong> - 生成标准.zip技能包</li>
</ol>
<h3 data-id="heading-10">等待生成完成</h3>
<p>整个过程大约需要几分钟时间,具体取决于文档数量和网络速度。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4ae3cf04b0646cb9c32ad3f4b6d1eb0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=w0e4a2nrjOIyZWaAPaINqh0GCKQ%3D" alt="image-20251119155653153" loading="lazy"/></p>
<p><strong>实际耗时参考:</strong></p>
<ul>
<li>小型文档(10-50页): 1-3分钟</li>
<li>中型文档(50-200页): 3-10分钟</li>
<li>大型文档(200-1000页): 10-30分钟</li>
</ul>
<p>对于硅基流动API文档(约50页),实际耗时约5分钟。</p>
<h3 data-id="heading-11">查看生成结果</h3>
<p>生成完成后,AI会输出3个文件:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cd5f65124b741daaa94e0bab6209041~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=W47eYNt%2F%2F2SnnnhtaewC0enDXIg%3D" alt="生成完成" loading="lazy"/></p>
<p>从截图可以看到生成了:</p>
<ol>
<li><strong>siliconflow.zip</strong> - 技能包压缩文件(可直接上传到Claude)</li>
<li><strong>siliconflow.json</strong> - 配置文件(记录抓取规则)</li>
<li><strong>generation_report.md</strong> - 生成报告(统计信息和质量分析)</li>
</ol>
<p>让我们查看一下生成报告的内容:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> generation_report.md
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1e7824968604748867f3ded776fd5ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=9rUJBFtzuHcOMKe%2BvikbJUsC8aQ%3D" alt="image-20251119180022793" loading="lazy"/></p>
<h3 data-id="heading-12">技能包结构</h3>
<p>解压 siliconflow.zip 查看内部结构:</p>
<pre><code class="hljs language-bash" lang="bash">unzip -l siliconflow.zip
</code></pre>
<p>标准技能包结构:</p>
<pre><code class="hljs language-bash" lang="bash">siliconflow/
├── SKILL.md                    <span class="hljs-comment"># 主技能文件(500+行)</span>
│   ├── 概述
│   ├── 何时使用此技能
│   ├── 快速参考(5-10个代码示例)
│   ├── 关键概念
│   ├── 常见模式
│   └── 导航指南
│
├── references/                 <span class="hljs-comment"># 分类文档</span>
│   ├── index.md               <span class="hljs-comment"># 目录索引</span>
│   ├── getting_started.md     <span class="hljs-comment"># 入门指南</span>
│   ├── api_reference.md       <span class="hljs-comment"># API参考</span>
│   ├── use_cases.md           <span class="hljs-comment"># 使用案例</span>
│   └── faqs.md                <span class="hljs-comment"># 常见问题</span>
│
├── scripts/                   <span class="hljs-comment"># 用户脚本(空)</span>
└── assets/                    <span class="hljs-comment"># 用户资源(空)</span>
</code></pre>
<h2 data-id="heading-13">技能包发布</h2>
<h3 data-id="heading-14">安装技能包到 Claude</h3>
<p>接下来我们把这个技能包部署发布。将 siliconflow.zip 解压并复制到 <code>~/.claude/skills</code> 文件夹下。</p>
<p>在Claude Code中输入:</p>
<pre><code class="hljs language-javascript" lang="javascript">帮我把siliconflow.<span class="hljs-property">zip</span> 技能包安装到~<span class="hljs-regexp">/.claude/</span>skills 文件夹下
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d2f023bca4e4a34a3b406a3134ff38e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=%2FO%2FxqTKk2vwfE7cG8UwnoVNFFus%3D" alt="image-20251119161537276" loading="lazy"/></p>
<p>执行过程:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># AI自动执行以下命令</span>
unzip siliconflow.zip -d ~/.claude/skills/
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/223cf633badd431cab634173b59f8baf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=eJ5%2BERccW5LaWjqFDdKDVwx5v%2Fc%3D" alt="安装完成" loading="lazy"/></p>
<p>安装成功后,技能包立即生效,无需重启Claude Code。</p>
<h3 data-id="heading-15">验证安装</h3>
<p>检查技能是否正确安装:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">ls</span> ~/.claude/skills/siliconflow/
</code></pre>
<p>应该看到:</p>
<ul>
<li>SKILL.md</li>
<li>references/</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c78afcceb6346f6883e55fca2571722~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=zqDsIJLfqyPXuED%2BQv3YXtfegL8%3D" alt="image-20251119180328685" loading="lazy"/></p>
<p>查看主技能文件:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">head</span> -50 ~/.claude/skills/siliconflow/SKILL.md
</code></pre>
<p>这将显示技能的前50行,包含概述、使用场景、快速参考等核心内容。</p>
<h2 data-id="heading-16">验证及测试</h2>
<h3 data-id="heading-17">测试技能调用</h3>
<p>接下来我们对这个技能包进行实战测试。让AI使用这个技能包生成调用硅基流动的API代码。</p>
<p>测试提示词:</p>
<pre><code class="hljs">请帮我使用siliconflow 这个skill技能包生成调用硅基流动的API 实现文本生成的模型接口,使用python 代码实现,
使用deepseek-ai/DeepSeek-V3.2-Exp 模型
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb772af09c5e49918d9544c161fcfe80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=q9UaCfX5HE9U1KVFHMSi2I2ioQU%3D" alt="测试请求" loading="lazy"/></p>
<h3 data-id="heading-18">AI 读取技能包</h3>
<p>AI接收到请求后,会自动读取 siliconflow 技能包中的 api_reference.md 文件,理解API调用方式。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbc0a5ede75149fcaf7a9f6a9ecbad46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=8zTv0gIenuNMXr4FF3I%2B8i%2FiQvw%3D" alt="读取API文档" loading="lazy"/></p>
<p>从截图可以看到,AI正在分析技能包中的API参考文档,提取关键信息:</p>
<ul>
<li>API endpoint: <code>https://api.siliconflow.cn/v1/chat/completions</code></li>
<li>认证方式: Bearer Token</li>
<li>请求参数: model, messages, temperature, max_tokens等</li>
<li>响应格式: JSON</li>
</ul>
<h3 data-id="heading-19">生成的完整代码</h3>
<p>AI基于技能包生成了完整的Python代码,包含3种调用方式和多轮对话管理:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-comment"># -*- coding: utf-8 -*-</span>
<span class="hljs-string">"""
硅基流动(SiliconFlow)API 文本生成接口
使用 DeepSeek-V3.2-Exp 模型

基于 SiliconFlow 技能包文档生成
API 文档: https://docs.siliconflow.cn/cn/api-reference/chat-completions/chat-completions
"""</span>

<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI

<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># 配置部分</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-comment"># API 配置</span>
API_KEY = os.getenv(<span class="hljs-string">"SILICONFLOW_API_KEY"</span>, <span class="hljs-string">"YOUR_API_KEY"</span>)
BASE_URL = <span class="hljs-string">"https://api.siliconflow.cn/v1"</span>
MODEL = <span class="hljs-string">"deepseek-ai/DeepSeek-V3.2-Exp"</span>

<span class="hljs-comment"># 初始化客户端</span>
client = OpenAI(
    api_key=API_KEY,
    base_url=BASE_URL
)


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># 方式一:普通请求(非流式)</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">chat_completion</span>(<span class="hljs-params">
    messages: <span class="hljs-built_in">list</span>,
    model: <span class="hljs-built_in">str</span> = MODEL,
    temperature: <span class="hljs-built_in">float</span> = <span class="hljs-number">0.7</span>,
    max_tokens: <span class="hljs-built_in">int</span> = <span class="hljs-number">2048</span>,
    top_p: <span class="hljs-built_in">float</span> = <span class="hljs-number">0.7</span>
</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""
    普通对话请求(非流式)

    Args:
        messages: 对话消息列表
        model: 模型名称
        temperature: 温度参数,控制随机性 (0-1)
        max_tokens: 最大生成 token 数
        top_p: 核采样参数

    Returns:
        生成的文本内容
    """</span>
    <span class="hljs-keyword">try</span>:
        response = client.chat.completions.create(
            model=model,
            messages=messages,
            temperature=temperature,
            max_tokens=max_tokens,
            top_p=top_p,
            stream=<span class="hljs-literal">False</span>
        )

        <span class="hljs-keyword">return</span> response.choices[<span class="hljs-number">0</span>].message.content

    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"请求错误: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">raise</span>


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># 方式二:流式请求(实时输出)</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">chat_completion_stream</span>(<span class="hljs-params">
    messages: <span class="hljs-built_in">list</span>,
    model: <span class="hljs-built_in">str</span> = MODEL,
    temperature: <span class="hljs-built_in">float</span> = <span class="hljs-number">0.7</span>,
    max_tokens: <span class="hljs-built_in">int</span> = <span class="hljs-number">2048</span>,
    top_p: <span class="hljs-built_in">float</span> = <span class="hljs-number">0.7</span>
</span>):
    <span class="hljs-string">"""
    流式对话请求

    Args:
        messages: 对话消息列表
        model: 模型名称
        temperature: 温度参数
        max_tokens: 最大生成 token 数
        top_p: 核采样参数

    Yields:
        生成的文本片段
    """</span>
    <span class="hljs-keyword">try</span>:
        response = client.chat.completions.create(
            model=model,
            messages=messages,
            temperature=temperature,
            max_tokens=max_tokens,
            top_p=top_p,
            stream=<span class="hljs-literal">True</span>
        )

        <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> response:
            <span class="hljs-keyword">if</span> chunk.choices[<span class="hljs-number">0</span>].delta.content:
                <span class="hljs-keyword">yield</span> chunk.choices[<span class="hljs-number">0</span>].delta.content

    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"请求错误: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">raise</span>


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># 方式三:使用 requests 库直接调用 API</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">chat_completion_requests</span>(<span class="hljs-params">
    messages: <span class="hljs-built_in">list</span>,
    model: <span class="hljs-built_in">str</span> = MODEL,
    stream: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>,
    temperature: <span class="hljs-built_in">float</span> = <span class="hljs-number">0.7</span>,
    max_tokens: <span class="hljs-built_in">int</span> = <span class="hljs-number">2048</span>
</span>):
    <span class="hljs-string">"""
    使用 requests 库直接调用 API

    Args:
        messages: 对话消息列表
        model: 模型名称
        stream: 是否启用流式输出
        temperature: 温度参数
        max_tokens: 最大生成 token 数

    Returns:
        生成的文本内容或流式响应
    """</span>
    <span class="hljs-keyword">import</span> requests

    url = <span class="hljs-string">f"<span class="hljs-subst">{BASE_URL}</span>/chat/completions"</span>

    headers = {
        <span class="hljs-string">"Authorization"</span>: <span class="hljs-string">f"Bearer <span class="hljs-subst">{API_KEY}</span>"</span>,
        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>
    }

    payload = {
        <span class="hljs-string">"model"</span>: model,
        <span class="hljs-string">"messages"</span>: messages,
        <span class="hljs-string">"temperature"</span>: temperature,
        <span class="hljs-string">"max_tokens"</span>: max_tokens,
        <span class="hljs-string">"stream"</span>: stream
    }

    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">if</span> stream:
            <span class="hljs-comment"># 流式请求</span>
            response = requests.post(url, headers=headers, json=payload, stream=<span class="hljs-literal">True</span>)
            response.raise_for_status()

            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> response.iter_lines():
                <span class="hljs-keyword">if</span> line:
                    line = line.decode(<span class="hljs-string">'utf-8'</span>)
                    <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">'data: '</span>):
                        data = line[<span class="hljs-number">6</span>:]
                        <span class="hljs-keyword">if</span> data != <span class="hljs-string">'[DONE]'</span>:
                            <span class="hljs-keyword">import</span> json
                            chunk = json.loads(data)
                            <span class="hljs-keyword">if</span> chunk[<span class="hljs-string">'choices'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'delta'</span>].get(<span class="hljs-string">'content'</span>):
                                <span class="hljs-keyword">yield</span> chunk[<span class="hljs-string">'choices'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'delta'</span>][<span class="hljs-string">'content'</span>]
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># 非流式请求</span>
            response = requests.post(url, headers=headers, json=payload)
            response.raise_for_status()

            result = response.json()
            <span class="hljs-keyword">return</span> result[<span class="hljs-string">'choices'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'message'</span>][<span class="hljs-string">'content'</span>]

    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"请求错误: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">raise</span>


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># 高级功能:多轮对话</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatSession</span>:
    <span class="hljs-string">"""多轮对话会话管理"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, system_prompt: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span>, model: <span class="hljs-built_in">str</span> = MODEL</span>):
        <span class="hljs-string">"""
        初始化对话会话

        Args:
            system_prompt: 系统提示词
            model: 模型名称
        """</span>
        self.model = model
        self.messages = []

        <span class="hljs-keyword">if</span> system_prompt:
            self.messages.append({
                <span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>,
                <span class="hljs-string">"content"</span>: system_prompt
            })

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">self, user_input: <span class="hljs-built_in">str</span>, stream: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>, **kwargs</span>):
        <span class="hljs-string">"""
        发送消息并获取回复

        Args:
            user_input: 用户输入
            stream: 是否使用流式输出
            **kwargs: 其他参数

        Returns:
            助手的回复
        """</span>
        <span class="hljs-comment"># 添加用户消息</span>
        self.messages.append({
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>,
            <span class="hljs-string">"content"</span>: user_input
        })

        <span class="hljs-keyword">if</span> stream:
            <span class="hljs-comment"># 流式输出</span>
            full_response = <span class="hljs-string">""</span>
            <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> chat_completion_stream(self.messages, model=self.model, **kwargs):
                <span class="hljs-built_in">print</span>(chunk, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
                full_response += chunk
            <span class="hljs-built_in">print</span>()

            <span class="hljs-comment"># 保存助手回复</span>
            self.messages.append({
                <span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>,
                <span class="hljs-string">"content"</span>: full_response
            })

            <span class="hljs-keyword">return</span> full_response
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># 普通输出</span>
            response = chat_completion(self.messages, model=self.model, **kwargs)

            <span class="hljs-comment"># 保存助手回复</span>
            self.messages.append({
                <span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>,
                <span class="hljs-string">"content"</span>: response
            })

            <span class="hljs-keyword">return</span> response

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""清空对话历史(保留系统提示词)"""</span>
        <span class="hljs-keyword">if</span> self.messages <span class="hljs-keyword">and</span> self.messages[<span class="hljs-number">0</span>][<span class="hljs-string">"role"</span>] == <span class="hljs-string">"system"</span>:
            self.messages = [self.messages[<span class="hljs-number">0</span>]]
        <span class="hljs-keyword">else</span>:
            self.messages = []

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_history</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""获取对话历史"""</span>
        <span class="hljs-keyword">return</span> self.messages.copy()


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># 使用示例</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-string">"""主函数 - 演示各种使用方式"""</span>

    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"硅基流动 API 文本生成示例"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"模型: <span class="hljs-subst">{MODEL}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)

    <span class="hljs-comment"># 示例消息</span>
    messages = [
        {
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>,
            <span class="hljs-string">"content"</span>: <span class="hljs-string">"你是一个有帮助的 AI 助手。"</span>
        },
        {
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>,
            <span class="hljs-string">"content"</span>: <span class="hljs-string">"请用简洁的语言解释什么是机器学习?"</span>
        }
    ]

    <span class="hljs-comment"># 示例 1: 普通请求</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n【示例 1】普通请求(非流式):"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">40</span>)

    <span class="hljs-keyword">try</span>:
        response = chat_completion(messages)
        <span class="hljs-built_in">print</span>(response)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"错误: <span class="hljs-subst">{e}</span>"</span>)

    <span class="hljs-comment"># 示例 2: 流式请求</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n【示例 2】流式请求:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">40</span>)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> chat_completion_stream(messages):
            <span class="hljs-built_in">print</span>(chunk, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
        <span class="hljs-built_in">print</span>()
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"错误: <span class="hljs-subst">{e}</span>"</span>)

    <span class="hljs-comment"># 示例 3: 多轮对话</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n【示例 3】多轮对话:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">40</span>)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># 创建对话会话</span>
        session = ChatSession(
            system_prompt=<span class="hljs-string">"你是一个专业的 Python 编程助手。"</span>,
            model=MODEL
        )

        <span class="hljs-comment"># 第一轮对话</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"用户: 什么是列表推导式?"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"助手: "</span>, end=<span class="hljs-string">""</span>)
        session.chat(<span class="hljs-string">"什么是列表推导式?"</span>, stream=<span class="hljs-literal">True</span>)

        <span class="hljs-comment"># 第二轮对话(上下文相关)</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n用户: 能给我一个例子吗?"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"助手: "</span>, end=<span class="hljs-string">""</span>)
        session.chat(<span class="hljs-string">"能给我一个例子吗?"</span>, stream=<span class="hljs-literal">True</span>)

    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"错误: <span class="hljs-subst">{e}</span>"</span>)

    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"示例完成"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># 快速使用函数</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">quick_chat</span>(<span class="hljs-params">prompt: <span class="hljs-built_in">str</span>, stream: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">True</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""
    快速对话函数

    Args:
        prompt: 用户输入
        stream: 是否使用流式输出

    Returns:
        助手的回复
    """</span>
    messages = [
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}
    ]

    <span class="hljs-keyword">if</span> stream:
        response = <span class="hljs-string">""</span>
        <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> chat_completion_stream(messages):
            <span class="hljs-built_in">print</span>(chunk, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
            response += chunk
        <span class="hljs-built_in">print</span>()
        <span class="hljs-keyword">return</span> response
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> chat_completion(messages)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># 检查 API Key</span>
    <span class="hljs-keyword">if</span> API_KEY == <span class="hljs-string">"YOUR_API_KEY"</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"⚠️  请先设置 API Key!"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">""</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"方式 1: 设置环境变量"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"  export SILICONFLOW_API_KEY='your-api-key'"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">""</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"方式 2: 直接修改代码中的 API_KEY 变量"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">""</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"获取 API Key: https://cloud.siliconflow.cn/account/ak"</span>)
        exit(<span class="hljs-number">1</span>)

    main()
</code></pre>
<h3 data-id="heading-20">实际运行测试</h3>
<p>让我们运行一下这个代码,测试实际效果:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 设置API密钥</span>
<span class="hljs-built_in">export</span> SILICONFLOW_API_KEY=<span class="hljs-string">'your-api-key-here'</span>

<span class="hljs-comment"># 运行测试</span>
python siliconflow_api_test.py
</code></pre>
<p>预期输出:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b1c3cb9eb6f456b90a66077b427fa9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=%2FhPdurNsTztF%2F64%2B3KvODg9AT40%3D" alt="代码分析" loading="lazy"/></p>
<pre><code class="hljs language-markdown" lang="markdown">============================================================
硅基流动 API 文本生成示例
<span class="hljs-section">模型: deepseek-ai/DeepSeek-V3.2-Exp
============================================================</span>

<span class="hljs-section">【示例 1】普通请求(非流式):
----------------------------------------</span>
机器学习是一种人工智能技术,通过让计算机从数据中学习规律和模式,
而不是通过明确编程来完成任务。简单来说,就是让机器通过大量数据
训练,自动提取特征并做出预测或决策。

<span class="hljs-section">【示例 2】流式请求:
----------------------------------------</span>
机器学习是一种人工智能的分支,它使计算机系统能够从数据中学习并
改进性能,而无需显式编程...

<span class="hljs-section">【示例 3】多轮对话:
----------------------------------------</span>
用户: 什么是列表推导式?
助手: 列表推导式是Python中一种简洁的创建列表的语法...

用户: 能给我一个例子吗?
助手: 当然!这里有一个简单的例子...

============================================================
<span class="hljs-section">示例完成
============================================================</span>
</code></pre>
<p>完美运行!🎉</p>
<p>项目已经开源上传github上了 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyusufkaraaslan%2FSkill_Seekers" target="_blank" title="https://github.com/yusufkaraaslan/Skill_Seekers" ref="nofollow noopener noreferrer">github.com/yusufkaraas…</a>  需要的小伙伴可以自取</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3240e975809242e0b96566fa102457fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764163622&amp;x-signature=0hdcC9%2FxMDAXLJglI2Sul6oYj6I%3D" alt="image-20251119180614744" loading="lazy"/></p>
<h2 data-id="heading-21">总结</h2>
<p>今天我们通过Skill Seekers这个开源工具,成功将硅基流动的API文档转换成了Claude可直接使用的技能包,整个过程只用了不到10分钟,相比手动整理文档节省了数小时的工作时间。更重要的是,生成的技能包质量非常高,包含了完整的API参考、使用示例、最佳实践,AI基于这个技能包生成的代码完全可以直接用于生产环境,不需要任何修改。</p>
<p>Skill Seekers的核心价值在于自动化了文档到技能包的转换流程,支持文档网站、GitHub仓库、PDF文件三合一,还提供了智能冲突检测功能,能够自动发现文档和代码之间的不一致,这对于保证技能包的准确性非常重要。从技术实现角度来看,它采用了BFS遍历算法进行智能爬虫抓取,使用BeautifulSoup4解析HTML,支持异步模式下2-3倍速度提升,对于大型文档还提供了断点续传功能,9731行生产代码配合372+测试函数保证了100%测试通过率,这是一个生产就绪的工具。特别值得一提的是它的MCP集成功能,通过9个工具直接集成到Claude Code中,可以用自然语言控制整个流程,大大降低了使用门槛。对于开发者来说,无论是为常用框架(React、Vue、Django)创建技能包,还是将团队内部文档和代码仓库合并为单一知识源,或者像我们今天演示的为第三方API服务快速生成调用技能,Skill Seekers都是一个非常实用的工具。</p>
<p>项目完全开源,MIT许可证,代码质量高,文档详尽,还有活跃的社区支持,强烈推荐大家试用,相信你也会被它的效率和质量所打动。最后附上项目的GitHub地址和相关资源,感兴趣的小伙伴可以去star支持一下,有问题也可以在issues里提问,项目维护者响应很及时。希望这篇教程能帮助大家快速上手Skill Seekers,提升AI开发效率。今天的分享就到这里结束了,我们下篇文章见！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Doubao-Seed-Code 实测：我用它10分钟写了个公众号排版神器！]]></title>    <link>https://juejin.cn/post/7574270661872648230</link>    <guid>https://juejin.cn/post/7574270661872648230</guid>    <pubDate>2025-11-19T13:44:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574270661872648230" data-draft-id="7574271557939232819" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Doubao-Seed-Code 实测：我用它10分钟写了个公众号排版神器！"/> <meta itemprop="keywords" content="AI编程"/> <meta itemprop="datePublished" content="2025-11-19T13:44:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="后端小肥肠"/> <meta itemprop="url" content="https://juejin.cn/user/2966945320667536"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Doubao-Seed-Code 实测：我用它10分钟写了个公众号排版神器！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2966945320667536/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    后端小肥肠
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T13:44:10.000Z" title="Wed Nov 19 2025 13:44:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. 前言</h2>
<p>作为程序员，最近被国产编程模型Doubao-Seed-Code圈粉了。在包括 Terminal Bench、SWE-Bench-Verified-Openhands 和 Multi-SWE-Bench-Flash-Openhands 在内的多个编程领域主流基准测试中，该模型表现出卓越性能，位居行业前列，仅略逊于顶尖模型 Sonnet 4.5，并显著领先于国内其他模型。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e79a37231d8413e8d0a8ce904ce041b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=Ttgv%2B9ffLwHEPmAXOb0r7gpvmq0%3D" alt="" loading="lazy"/></p>
<p><strong>在国产编程模型中，Doubao-Seed-Code开创了先河（或居于首位）。依托于 Doubao 系列模型在视觉理解方面的深厚积累和高难度 VLM 训练技术，它保持了顶尖的视觉优势，这也是其难以被模仿的核心竞争力。</strong></p>
<p>这对于我这种不太擅长前端的后端程序员来说简直就是福音，是不是意味着只需要传入一张界面图，我就能得到精美的前端代码？</p>
<p>目前Doubao-Seed-Code 同步发布了<strong>Coding Plan（</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.volcengine.com%2Factivity%2Fcodingplan" target="_blank" title="https://www.volcengine.com/activity/codingplan" ref="nofollow noopener noreferrer"><strong>https://www.volcengine.com/activity/codingplan</strong></a> <strong>），</strong> 我订阅了pro那个。成功订阅后我直接在火山上体验了一把，首先我先找了一张大屏的图片：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97a5a956c9144bb784ca39803f1d37c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=mozoa0VfmkjNlc60ep0DI9uBUPI%3D" alt="" loading="lazy"/></p>
<p>打开<a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.volcengine.com%2Fark%2Fregion%3Aark%2Bcn-beijing%2Fexperience%2Fchat%3FmodelId%3Ddoubao-seed-code-preview-251028%26csid%3Dexcs-202511130927-%255Bbao3WX3TLfcXdqlXjej1U%255D" target="_blank" title="https://console.volcengine.com/ark/region:ark+cn-beijing/experience/chat?modelId=doubao-seed-code-preview-251028&amp;csid=excs-202511130927-%5Bbao3WX3TLfcXdqlXjej1U%5D" ref="nofollow noopener noreferrer">火山引擎体验中心</a>网页，让它理解这个大屏的风格复刻一个类似的大屏，提示词如下：</p>
<pre><code class="hljs language-css" lang="css">理解这个大屏的风格复刻一个类似的大屏，禁止使用任何改变应用结构或组件化范式的 JavaScript 框架/库（例如：React, Vue, Angular）。可以cdn引用第三方库以满足题目要求，如Three<span class="hljs-selector-class">.js</span>，p5js。最终产物必须是纯粹的 <span class="hljs-selector-tag">HTML</span>单文件。
</code></pre>
<p>等待几分钟后得到了成品代码，还能直接查看效果，支持一键下载：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4aba56d46c34039881e078f50a875b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=sUsAFhGo8vjNtpfzJ%2BRkmGkuuYY%3D" alt="" loading="lazy"/></p>
<p>第一次不是很满意，我又让他重新生成了一个：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d69b4955c6e453b802c44fd06efb461~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=aA4fs9xJXLCPniobhLHhZB%2Bswkk%3D" alt="" loading="lazy"/></p>
<p>可以看到这次的好了很多，要接近原版还要精调很多次，我没有一直调，我主要是想用它做另外一个工具。</p>
<p>最近社群很多人问我有没有公众号排版工具，大家都为公众号排版而苦恼，今天我用Doubao-Seed-Code试着做了一下，从提需求到使用，只耗时10分钟。给大家看看成品：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d71ceda9cee048b59e1d20f07be1f053~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=Omtm7%2BrwSewuvKxGv9Jo8QbkeNY%3D" alt="" loading="lazy"/></p>
<p>左边是编辑区，右边是成品查看区域，只需要在编辑区编辑好文字，点击【复制到公众号】就可以把带有精美样式的内容复制到公众号当中了。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fa5cf3f11ca46b68128c070c787250a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=F%2FFGRkKLvWXYOKJEFSMtveTvYkM%3D" alt="" loading="lazy"/></p>
<p>下面就正式开始搭建教程，感兴趣的同学可以码住跟练哦~</p>
<h2 data-id="heading-1">2. 公众号排版编辑器构建</h2>
<p>Doubao-Seed-Code除了能在火山社区轻量使用，还可以集成到Claude Code中，下面就基于Claude Code来实现公众号排版编辑器的构建。</p>
<h3 data-id="heading-2">2.1. Doubao-Seed-Code丝滑集成Claude Code</h3>
<p>在电脑上打开powershell，输入命令：</p>
<pre><code class="hljs language-bash" lang="bash">notepad <span class="hljs-variable">$HOME</span>.claude\settings.json
</code></pre>
<p>在弹出的配置文件中输入以下配置进行保存：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"ANTHROPIC_AUTH_TOKEN"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"你的火山方舟API Key"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"ANTHROPIC_BASE_URL"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://ark.cn-beijing.volces.com/api/coding"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"ANTHROPIC_MODEL"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"doubao-seed-code-preview-latest"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"API_TIMEOUT_MS"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"300000"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>进入任意项目目录，启动命令提示符，输入claude，再输入/status，按下回车可以看到当前的模型已经被切换为了Doubao-Seed-Code。</p>
<h3 data-id="heading-3">2.2. 构建公众号排版编辑器</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a35c23096ba44579314bf62178bca39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=kxvyQqWlpeP9ldkLKL0UOUAj%2BTU%3D" alt="" loading="lazy"/></p>
<p>接下来就开始愉快的 AI Coding了，输入如下需求：</p>
<pre><code class="hljs language-markdown" lang="markdown">请在当前目录下，创建一个具有 mdnice 风格的 Markdown 在线编辑器的单页网站。

要求：
<span class="hljs-bullet">1.</span>  创建一个 <span class="hljs-code">`mdnice-editor.html`</span> 文件。
<span class="hljs-bullet">2.</span>  功能包括：
<span class="hljs-bullet">    *</span>   左侧是 Markdown 编辑区（textarea）。
<span class="hljs-bullet">    *</span>   右侧是实时预览区（div）。
<span class="hljs-bullet">    *</span>   支持常见的 Markdown 语法高亮和渲染（如标题、列表、链接、代码块等）。
<span class="hljs-bullet">    *</span>   顶部有一个简单的工具栏，包含“加粗”、“标题”、“列表”等几个常用按钮，点击可在编辑器中插入对应 Markdown 格式。
<span class="hljs-bullet">3.</span>  样式要美观，模仿 mdnice 的简洁、现代风格，可以使用 Tailwind CSS 来实现样式（通过 CDN 引入）。
<span class="hljs-bullet">4.</span>  使用原生 JavaScript 实现编辑和预览的实时同步，以及工具栏功能。
<span class="hljs-bullet">5.</span>  <span class="hljs-strong">**禁止使用任何改变应用结构或组件化范式的 JavaScript 框架/库（例如：React, Vue, Angular）。**</span> 可以 CDN 引用第三方库以满足特定功能需求（如 Markdown 解析库 marked.js）。
<span class="hljs-bullet">6.</span>  最终产物必须是纯粹的 HTML、CSS 和 JS 文件。如果需要创建多个文件（HTML/CSS/JS），请确保所有文件引用均使用相对路径。
</code></pre>
<p>回车以后就开始自主规划执行写代码了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5fd9b147cfc40f79674243e717cd75c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=qs8rv%2F%2Bj58KMA4zPEWm2LIRFd40%3D" alt="" loading="lazy"/></p>
<p>等了2分钟就完成了初版，我打开看了一下，有模有样哦。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/678b074e58ef4f48864e6443e905efe3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=Q390eiW4kVUpWTBDZyCq0mi2EzM%3D" alt="" loading="lazy"/></p>
<p>在出版的基础之上我又提了新的需求，希望它可以多几个主题，我设置了水粉色、紫罗兰和活力橙色三个主题让他帮我生成。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b270e9d173eb43e38a24183a0532c696~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=KHKD3uwcGxsk3d4y%2FR34MncioNY%3D" alt="" loading="lazy"/></p>
<p>等待两分钟后样式就有了，不得不说挺符合我的心意。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94d7b4ce6e03496a83735454cc7ae7ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=wAsFDnNeKVqJw5EBy%2FkBLn7LaC4%3D" alt="" loading="lazy"/></p>
<p>接下来最后一步就是实现样式可以复制到公众号的功能，我也是用大白话跟大模型说的。3分钟后它跟我说可以了，我去测了一下真行了，全流程不到10分钟。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e09de7ea0b9f4b52b57c465e2794ad84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=Ciik94xXwyF8VTS8Xs%2Bp1szwdYY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d30519dd83b4dcaa17ee02081b9ab84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=klm%2FuAWSt%2FAj%2B5qZikMF7AdIxN0%3D" alt="" loading="lazy"/></p>
<p>只需要【复制到公众号】按钮，就可以一键复制到公众号，样式被成功迁移了~</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cac9c3a4fd064770b193075d99de1b0b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=g01rNTFazVbkT6WQappspwhUdPk%3D" alt="" loading="lazy"/></p>
<p>以上就是我的完整体验流程，体验下来总体感觉来说还是不错的，感兴趣的同学可以试试，如果只是日常开发Lite那个套餐是足够的。需要开发复杂项目的可以考虑一下Pro套餐，这个因人而异。</p>
<h2 data-id="heading-4">3. 结语</h2>
<p>通过这次对 <strong>Doubao-Seed-Code</strong> 的深度体验，我彻底感受到了国产编程模型的巨大潜力和价值。从最初尝试的<strong>大屏样式复刻</strong>，到最终<strong>不到10分钟构建出功能完备、样式美观的公众号排版编辑器</strong>，Doubao-Seed-Code展现出的不仅是强大的代码生成能力，更在于其<strong>对视觉、需求的快速理解与精准转化</strong>。</p>
<p><strong>如本次分享对你有帮助，麻烦一键三连支持一下小肥肠，我们下期再见~</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/87a63992e27d41efae8dd523b765f47d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764164650&amp;x-signature=MBv3gyBU%2F53Ncw7bdLO%2FTado1xg%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[🚀开发者必看！深度测评谷歌Gemini 3 Pro + Antigravity IDE！对比Claude Sonnet 4.5前端编程巅峰对决！模型能力是否被]]></title>    <link>https://juejin.cn/post/7574281453707345926</link>    <guid>https://juejin.cn/post/7574281453707345926</guid>    <pubDate>2025-11-19T13:47:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574281453707345926" data-draft-id="7574245125029150739" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="🚀开发者必看！深度测评谷歌Gemini 3 Pro + Antigravity IDE！对比Claude Sonnet 4.5前端编程巅峰对决！模型能力是否被"/> <meta itemprop="keywords" content="Gemini,Google,AIGC"/> <meta itemprop="datePublished" content="2025-11-19T13:47:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="win4r"/> <meta itemprop="url" content="https://juejin.cn/user/1739869037541555"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            🚀开发者必看！深度测评谷歌Gemini 3 Pro + Antigravity IDE！对比Claude Sonnet 4.5前端编程巅峰对决！模型能力是否被
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1739869037541555/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    win4r
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T13:47:12.000Z" title="Wed Nov 19 2025 13:47:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读14分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Gemini 3 Pro 与 Antigravity IDE 深度体验：基准与实战的双重考验</h2>
<p><em>2025年11月18日凌晨，Google 正式发布了最新一代人工智能模型 Gemini 3 Pro，同时推出了对标 Cursor 和 Windsurf 的代理式开发平台 Antigravity IDE。作为 AI 编程领域的重磅更新，这次发布引发了开发者社区的热烈讨论。本文将结合官方数据与实际测试，为大家带来一份客观、全面的使用体验报告。</em></p>
<p>🔥🔥🔥本篇笔记所对应的视频：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1BxynBwEF5%2F" target="_blank" title="https://www.bilibili.com/video/BV1BxynBwEF5/" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1Bx…</a></p>
<h3 data-id="heading-1">一、基准测试：纸面数据的辉煌战绩</h3>
<h4 data-id="heading-2">令人瞩目的基准测试成绩</h4>
<p>从官方公布的数据来看，Gemini 3 Pro 在多项基准测试中的表现确实令人印象深刻，甚至在某些项目上超越了 Claude Sonnet 4.5 和 GPT-5.1。</p>
<p>在业界最受关注的 LMArena 排行榜上，Gemini 3 Pro 以 1501 Elo 的分数登顶，超越了此前占据榜首的 Grok 4.1 Thinking。在推理能力方面，它在"人类最后考试"（Humanity's Last Exam）中取得了 37.5% 的得分（不使用工具），在 GPQA Diamond 专业科学知识测试中达到 91.9% 的成绩。</p>
<p>数学能力的提升尤为显著。在 MathArena Apex 这项极具挑战性的数学竞赛测试中，Gemini 3 Pro 取得了 23.4% 的成绩，而竞争对手的得分大多在 1-3% 之间，这个差距相当惊人。</p>
<p>在编程基准测试中，Gemini 3 Pro 在 WebDev Arena 获得 1487 Elo 分，在 Terminal-Bench 2.0 上达到 54.2%，在 SWE-bench Verified 上取得 76.2% 的得分。这些数字看起来都非常亮眼。</p>
<p>然而，基准测试毕竟只是纸面数据。真实的编程能力如何？我们需要通过实际测试来验证。</p>
<h3 data-id="heading-3">二、实战测试：前端编程能力的真实较量</h3>
<p>为了客观评估 Gemini 3 Pro 的实际编程能力，我们在 Google AI Studio 中进行了一系列前端编程测试，并与 Claude Sonnet 4.5 进行了对比。测试涵盖了 SVG 绘图、动画制作、游戏开发等多个场景。</p>
<h4 data-id="heading-4">测试一：SVG 绘制 MacBook Pro 键盘</h4>
<p><strong>测试要求</strong>：用 SVG 画出 MacBook Pro 的键盘布局，要求 100% 还原真实键盘样式。</p>
<p><strong>Gemini 3 Pro 表现</strong>：整体还原度相当高，字母、图标、键盘大小和布局都非常接近真实的 MacBook Pro 键盘。但存在明显缺陷——数字键那一排的数字位置靠下，甚至超出了按键区域，出现了元素错位。</p>
<p><strong>Claude Sonnet 4.5 表现</strong>：完成度更好，键盘之间的空隙清晰可见，数字键位置准确，功能键（亮度调节、音量调节等）还原精准，没有任何元素错位的情况。</p>
<p><strong>结论</strong>：这一轮 Claude Sonnet 4.5 完成得更好。</p>
<h4 data-id="heading-5">测试二：太阳系八大行星公转动画</h4>
<p><strong>测试要求</strong>：用 SVG 画出太阳系八大行星围绕太阳公转的动画，采用 3D 效果，百分百还原。</p>
<p><strong>两者表现</strong>：双方都完成得非常出色。运行轨道清晰，土星的星环细节到位，木星的光影效果逼真。放大后还能看到月亮围绕地球旋转的细节。</p>
<p><strong>结论</strong>：这一轮两者不分伯仲。</p>
<h4 data-id="heading-6">测试三：猫狗行走动画</h4>
<p><strong>测试要求</strong>：用 SVG 画一猫一狗在草地上一前一后地走，天空中有飘动的云和飞翔的鸟。</p>
<p><strong>Claude Sonnet 4.5 表现</strong>：猫和狗的特征明显可辨，动物走到边缘会自动返回，鸟的飞行轨迹自然。</p>
<p><strong>Gemini 3 Pro 表现</strong>：基本功能都实现了，但画出的狗看起来不太像狗。有趣的是，它生成的鸟的运动效果和 Claude Sonnet 4.5 生成的非常相似，这背后的原因值得探讨。</p>
<p><strong>结论</strong>：两者完成度都不错，但 Claude 在细节还原上略胜一筹。</p>
<h4 data-id="heading-7">测试四：3D 恐龙狩猎游戏（重头戏）</h4>
<p><strong>测试要求</strong>：创建一个 3D 风格的恐龙狩猎游戏，玩家控制一辆车在侏罗纪时代追逐恐龙并进行射击。</p>
<p><strong>Claude Sonnet 4.5 表现</strong>：实现了第一人称视角，射击和音效都不错，可以消灭恐龙。但恐龙的建模相对简单。</p>
<p><strong>Gemini 3 Pro 表现</strong>：这一轮表现令人惊喜！不仅实现了第一人称视角，还加入了开始按钮、皮卡车模型、远处雾蒙蒙的氛围效果。最重要的是，恐龙的建模明显比 Claude 版本更加逼真，击中时的血量系统也更完善，整体游戏性更强。</p>
<p><strong>结论</strong>：这一轮 Gemini 3 Pro 明显胜出，在复杂 3D 游戏开发上展现了更强的能力。</p>
<h4 data-id="heading-8">测试五：p5.js 自动寻路贪吃蛇</h4>
<p><strong>测试要求</strong>：用 p5.js 实现自动寻路版贪吃蛇，能够自动规划路径、躲避障碍、寻找食物。</p>
<p><strong>两者表现</strong>：双方都成功实现了自动寻路、躲避障碍、自动吃食物并变长等核心功能。不同之处在于，Claude Sonnet 4.5 的背景色和主题设计更加美观，用户界面更加精致。</p>
<p><strong>结论</strong>：功能实现上两者相当，UI 设计上 Claude 更胜一筹。</p>
<h4 data-id="heading-9">测试六：简化版 Minecraft 游戏</h4>
<p><strong>测试要求</strong>：使用 HTML5 + Three.js 复刻一个简化版的 Minecraft 游戏。</p>
<p><strong>Claude Sonnet 4.5 表现</strong>：实现了第一人称视角、鼠标视角切换、空格跳跃、方向键移动。最重要的是，鼠标点击可以挖掘方块，能挖出洞来，甚至能把地面"挖穿"看到下面的天空。方向键可以选择不同材料（石头、泥土等）。核心游戏机制完整。</p>
<p><strong>Gemini 3 Pro 表现</strong>：初始化后角色处于悬浮状态，跳跃时始终在空中漂浮，无法正常落地。点击方块没有任何反应，挖掘功能完全未实现。</p>
<p><strong>结论</strong>：Claude Sonnet 4.5 完成度远超 Gemini 3 Pro。</p>
<h4 data-id="heading-10">前端测试总结</h4>
<p>通过这六个具有代表性的前端编程测试，我们可以得出一个重要结论：<strong>尽管 Gemini 3 Pro 在基准测试中表现出色，但在实际前端编程能力上，它与 Claude Sonnet 4.5 的差距并不明显，两者各有胜负。</strong></p>
<p>Gemini 3 Pro 在某些复杂场景（如 3D 恐龙游戏）中展现了出色的能力，但在另一些场景（如 Minecraft 游戏）中又出现了明显的问题。Claude Sonnet 4.5 则表现得更加稳定均衡，在 UI 设计和细节处理上往往更胜一筹。</p>
<h3 data-id="heading-11">三、Antigravity IDE：真实体验与功能探索</h3>
<h4 data-id="heading-12">初印象：熟悉的界面，不一样的能力</h4>
<p>Antigravity IDE 支持 macOS、Windows 和 Linux 三大平台，下载安装后使用 Google 账号登录即可使用。第一眼看到界面时，熟悉的感觉扑面而来——这确实是一个基于 VS Code 的 IDE，界面布局与 Cursor 和 Windsurf 非常相似，这意味着上手难度几乎为零。</p>
<p>但 Antigravity 的独特之处在于其"代理优先"的设计理念。它不仅仅是一个代码编辑器，更是一个可以管理和协调多个 AI 代理的开发平台。</p>
<h4 data-id="heading-13">令人惊喜的发现：免费使用 Claude Sonnet 4.5</h4>
<p>打开 Antigravity 后，最令人惊喜的发现是：<strong>它不仅支持 Gemini 3 Pro，还支持 Claude Sonnet 4.5，而且可以免费使用！</strong></p>
<p>这意味着即使你没有 Claude 的订阅，也能在 Antigravity 中免费体验 Claude Sonnet 4.5 的强大编程能力。这对于开发者来说是一个巨大的福利，也体现了 Google 的开放态度。</p>
<p>除了模型选择，Antigravity 还提供了两种工作模式：</p>
<ul>
<li><strong>Planning 模式</strong>：AI 先根据需求生成详细的任务规划，开发者审核后再执行</li>
<li><strong>Fast 模式</strong>：直接快速响应和执行任务</li>
</ul>
<h4 data-id="heading-14">实战测试一：开源项目分析</h4>
<p>我们首先测试了 Antigravity 的项目分析能力。通过克隆一个 GitHub 仓库，然后让它"详细分析这个项目，并生成分析报告以及函数地图"。</p>
<p><strong>测试配置</strong>：</p>
<ul>
<li>模型：Gemini 3 Pro</li>
<li>模式：Fast（因为只是分析，不需要 Planning）</li>
<li>操作：克隆仓库 → 输入中文提示词 → 等待分析</li>
</ul>
<p><strong>分析过程</strong>：可以实时看到 Antigravity 读取项目文件的过程，整个分析速度较快。</p>
<p><strong>分析结果</strong>：</p>
<ul>
<li>✅ 生成了完整的项目分析报告</li>
<li>✅ 识别了技术栈和关键特性</li>
<li>✅ 提供了架构分析和核心组件分析</li>
<li>⚠️ 函数地图的可视化效果一般</li>
<li>⚠️ <strong>输入中文提示词，但输出为英文</strong></li>
</ul>
<p>这个功能对于快速了解陌生项目的架构很有帮助，但语言处理的一致性还需要改进。</p>
<h4 data-id="heading-15">实战测试二：全栈背单词应用开发（重头戏）</h4>
<p>接下来是最具挑战性的测试——让 Antigravity 从零开始构建一个全栈应用。</p>
<p><strong>项目需求</strong>：</p>
<ul>
<li><strong>前端</strong>：React + Chakra UI</li>
<li><strong>后端</strong>：Node.js + Express + Supabase</li>
<li><strong>数据库</strong>：Supabase PostgreSQL</li>
<li><strong>功能</strong>：单词学习、练习、测试、进度追踪、底部导航等</li>
</ul>
<p><strong>开发全过程记录</strong>：</p>
<p><strong>第一阶段：规划（Planning 模式）</strong></p>
<ul>
<li>
<p>选择 Gemini 3 Pro + Planning 模式</p>
</li>
<li>
<p>输入详细的需求和技术栈描述</p>
</li>
<li>
<p>AI 生成了详细的任务规划，包括：</p>
<ul>
<li>数据库表结构设计</li>
<li>前端组件架构</li>
<li>后端 API 设计</li>
<li>实施步骤</li>
</ul>
</li>
<li>
<p>可以通过对话方式修改规划，满意后点击执行</p>
</li>
</ul>
<p><strong>第二阶段：执行与问题（约 10 分钟）</strong></p>
<ul>
<li>✅ 首先生成 SQL 文件（手动复制到 Supabase 执行，成功）</li>
<li>✅ 开始生成前后端代码</li>
<li>✅ 可以实时查看正在执行的命令</li>
<li>❌ 后端启动时出现报错</li>
<li>✅ 选中报错 → 点击 Chat → 发送，AI 自动修复</li>
<li>❌ 前端页面空白，检查发现错误</li>
<li>❌ 经过多轮修复，问题依然存在</li>
<li>⚠️ <strong>关键问题出现：Gemini 3 Pro 配额用完！</strong></li>
</ul>
<p><strong>第三阶段：切换模型的转机</strong></p>
<ul>
<li>系统提示选择其他模型</li>
<li>切换到 Claude Sonnet 4.5（免费！）</li>
<li>输入"继续"让它继续修复</li>
</ul>
<p><strong>第四阶段：自动化测试的惊喜</strong></p>
<ul>
<li>
<p>🎉 Claude Sonnet 4.5 自动调用浏览器</p>
</li>
<li>
<p>🎉 开始自动化 UI 测试：</p>
<ul>
<li>自动点击单词卡片</li>
<li>自动测试练习功能</li>
<li>自动点击设置页面</li>
<li>对每个操作进行分析和验证</li>
</ul>
</li>
<li>
<p>这个自动化测试功能是 Cursor 和 Windsurf 都不具备的！</p>
</li>
</ul>
<p><strong>最终成果评估</strong>：</p>
<p><strong>✅ 成功实现的功能</strong>：</p>
<ul>
<li>单词卡片展示</li>
<li>点击查看解释</li>
<li>练习功能</li>
<li>进度追踪</li>
<li>设置页面</li>
<li>底部导航</li>
</ul>
<p><strong>❌ 存在的不足</strong>：</p>
<ul>
<li>单词解释只有英文，没有中文</li>
<li>缺少发音按钮（同样提示词，其他 AI 都实现了）</li>
<li>整体功能比较简单</li>
<li>缺少一些细节优化</li>
</ul>
<p><strong>⚠️ 重要发现</strong>：</p>
<ul>
<li>因为中途从 Gemini 3 切换到 Claude 4.5，代码风格和实现方式不统一</li>
<li>最后生成的项目总结使用中文（因为 Claude 接手了）</li>
</ul>
<h4 data-id="heading-16">Antigravity 的独特优势总结</h4>
<p>通过这两个实战测试，我们发现 Antigravity 有几个独特的亮点：</p>
<ol>
<li><strong>🌟 自动化浏览器测试</strong>：这是杀手级功能！能够自动调用浏览器对 Web 应用进行 UI 测试，这是 Cursor 和 Windsurf 目前都不具备的。</li>
<li><strong>🌟 多模型免费使用</strong>：可以免费使用 Claude Sonnet 4.5，这个价值巨大。还支持 GPT-OSS 等其他模型。</li>
<li><strong>✅ Planning 模式</strong>：先规划后执行，增加了可控性和透明度。</li>
<li><strong>✅ 工件系统</strong>：通过任务列表、截图、录制等方式展示工作过程。</li>
<li><strong>✅ VS Code 生态</strong>：基于 VS Code，学习成本低，可以导入现有设置。</li>
</ol>
<h4 data-id="heading-17">Antigravity 存在的问题</h4>
<ol>
<li><strong>⚠️ Gemini 3 Pro 配额限制严格</strong>：一个中等复杂度的项目还没完成，配额就用完了。</li>
<li><strong>⚠️ 语言一致性问题</strong>：中文提示词却返回英文内容。</li>
<li><strong>⚠️ 早期产品稳定性</strong>：作为刚发布的产品，还需要时间打磨。</li>
<li><strong>⚠️ 代码质量受模型切换影响</strong>：中途切换模型会导致代码风格不统一。</li>
</ol>
<h3 data-id="heading-18">四、综合评估：理性看待新技术</h3>
<h4 data-id="heading-19">基准测试 vs 实际能力：差距依然存在</h4>
<p>通过全面的测试，我们发现了一个重要的事实：<strong>基准测试的亮眼数据并不能完全转化为实际编程能力的绝对优势。</strong></p>
<p>Gemini 3 Pro 在数学、推理等基准测试中确实取得了令人瞩目的成绩，但在实际前端编程测试中，它与 Claude Sonnet 4.5 的差距并不明显，两者各有胜负：</p>
<ul>
<li>简单任务：两者接近</li>
<li>复杂 3D 场景：Gemini 3 有优势</li>
<li>细节和 UI 设计：Claude 4.5 更稳定</li>
</ul>
<p>这提醒我们，评估 AI 模型不能只看基准测试分数，实际应用场景的测试同样重要。</p>
<h4 data-id="heading-20">Antigravity：有亮点，但需打磨</h4>
<p>Antigravity IDE 作为 Google 进军 AI 编程工具市场的重要产品，确实带来了一些创新：</p>
<p><strong>真正的亮点</strong>：</p>
<ul>
<li>⭐ 自动化浏览器测试功能（独家）</li>
<li>⭐ 免费使用多款顶级模型（包括 Claude Sonnet 4.5）</li>
<li>✅ 基于 VS Code，上手容易</li>
<li>✅ Planning 模式增加可控性</li>
</ul>
<p><strong>需要改进的地方</strong>：</p>
<ul>
<li>❌ Gemini 3 Pro 配额限制过严</li>
<li>❌ 语言处理不一致（中文输入，英文输出）</li>
<li>❌ 产品稳定性和细节还需打磨</li>
<li>❌ 多模型切换会影响代码质量</li>
</ul>
<h4 data-id="heading-21">对开发者的实用建议</h4>
<p>基于这次深度测试，我们给出以下建议：</p>
<p><strong>1. 对于想尝试 Gemini 3 Pro 的开发者：</strong></p>
<ul>
<li>✅ 可以在 Google AI Studio 中免费测试前端项目</li>
<li>✅ 适合复杂 3D 可视化、游戏开发等场景</li>
<li>⚠️ 不要期望在所有场景下都超越 Claude 4.5</li>
<li>⚠️ 注意配额限制，复杂项目可能做不完</li>
</ul>
<p><strong>2. 对于想使用 Antigravity IDE 的开发者：</strong></p>
<ul>
<li>⭐ 非常值得下载尝试（免费）</li>
<li>⭐ 主要为了免费使用 Claude Sonnet 4.5</li>
<li>⭐ 体验自动化浏览器测试功能</li>
<li>⚠️ 做好遇到 bug 的心理准备</li>
<li>⚠️ 重要项目建议等产品成熟后再用</li>
</ul>
<p><strong>3. 对于纠结选择哪个 IDE 的开发者：</strong></p>
<ul>
<li>Cursor：目前最成熟，但需付费</li>
<li>Windsurf：界面精致，功能完善</li>
<li>Antigravity：免费使用顶级模型，有创新功能，但需打磨</li>
<li>建议：Antigravity 作为辅助工具，主力工作还是用成熟产品</li>
</ul>
<h4 data-id="heading-22">多模态能力与生成式 UI</h4>
<p>除了编程能力，Gemini 3 Pro 在多模态理解和生成式 UI 方面也有亮点：</p>
<p><strong>多模态能力</strong>：</p>
<ul>
<li>MMMU-Pro 测试：81%</li>
<li>Video-MMMU 测试：87.6%</li>
<li>100 万 token 超长上下文</li>
<li>可处理文本、图像、视频、音频、代码</li>
</ul>
<p><strong>生成式 UI</strong>：</p>
<ul>
<li>不再局限于文本回答</li>
<li>可以即时创建交互界面、工具和可视化</li>
<li>已整合到 Google 搜索的 AI 模式中</li>
<li>例如：问"RNA 聚合酶工作原理"，直接生成动态可视化界面</li>
</ul>
<p>这些能力在未来的 AI 应用中可能会发挥更大作用。</p>
<h3 data-id="heading-23">五、展望：保持理性，拥抱未来</h3>
<h4 data-id="heading-24">技术进步是真实的</h4>
<p>Gemini 3 Pro 和 Antigravity IDE 的发布，确实标志着 AI 编程工具又迈出了重要一步。我们看到了：</p>
<ul>
<li>模型能力的持续提升</li>
<li>编程工具的不断创新</li>
<li>开发者体验的逐步改善</li>
<li>代理式编程的逐渐成熟</li>
</ul>
<h4 data-id="heading-25">但也要保持清醒</h4>
<p>通过实际测试，我们也应该认识到：</p>
<ul>
<li>基准测试数据要辩证看待</li>
<li>实际能力提升是渐进式的，不是革命性的</li>
<li>新产品需要时间打磨</li>
<li>不同场景下各有优劣</li>
</ul>
<h4 data-id="heading-26">给开发者的建议</h4>
<ol>
<li><strong>保持学习</strong>：AI 编程工具发展迅速，持续关注和学习新工具</li>
<li><strong>理性评估</strong>：不被营销数字迷惑，实际测试最重要</li>
<li><strong>多工具并用</strong>：不同工具适合不同场景，灵活选择</li>
<li><strong>掌握核心</strong>：工具是辅助，编程思维和能力才是核心</li>
</ol>
<h4 data-id="heading-27">Gemini 3 Deep Think 值得期待</h4>
<p>Google 还将推出 Gemini 3 Deep Think 增强推理模式，在某些基准测试中表现更优：</p>
<ul>
<li>Humanity's Last Exam：41.0%（比 Pro 版高）</li>
<li>GPQA Diamond：93.8%</li>
<li>ARC-AGI-2：45.1%（前所未有的成绩）</li>
</ul>
<p>这个版本将在安全测试后向 Google AI Ultra 订阅用户开放，可能会带来更强的推理能力。</p>
<hr/>
<p><strong>结语</strong></p>
<p>Gemini 3 Pro 和 Antigravity IDE 的发布，为 AI 编程工具市场注入了新的活力。虽然在实际测试中我们发现它们并非完美无缺，但其中的创新点（尤其是 Antigravity 的自动化测试功能和免费使用顶级模型的策略）确实值得关注。</p>
<p>对于开发者来说，这是一个值得尝试的新选择，但不必急于放弃现有的成熟工具。技术的进步是渐进的，让我们保持开放的心态，在实践中探索最适合自己的开发方式。</p>
<p>AI 编程的未来正在到来，但它不是突然降临，而是在一次次的迭代和改进中逐渐成形。</p>
<hr/>
<p><em>📌 获取方式：</em></p>
<ul>
<li><em>Gemini 3 Pro 可在 Google AI Studio (aistudio.google.com) 中免费使用</em></li>
<li><em>Antigravity IDE 可在官网 (antigravity.google) 下载，支持 macOS、Windows、Linux</em></li>
<li><em>Gemini 3 Deep Think 将面向 Google AI Ultra 订阅用户开放</em></li>
</ul>
<p><em>💡 提示：本文测试基于 2025年11月18-19日 的产品版本，后续版本可能会有改进。</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[谷歌Gemini 3：当AI开始“自己动手”，我们离未来更近一步]]></title>    <link>https://juejin.cn/post/7574254039023927322</link>    <guid>https://juejin.cn/post/7574254039023927322</guid>    <pubDate>2025-11-19T13:52:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574254039023927322" data-draft-id="7574244766424317961" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="谷歌Gemini 3：当AI开始“自己动手”，我们离未来更近一步"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-11-19T13:52:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="墨风如雪"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            谷歌Gemini 3：当AI开始“自己动手”，我们离未来更近一步
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    墨风如雪
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T13:52:03.000Z" title="Wed Nov 19 2025 13:52:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>AI圈最近的热闹劲儿，大概要数谷歌在2025年11月18日那天的“大动作”了——Gemini 3，这款被官方冠以“最智能”称号的新一代AI模型，正式揭开了它的神秘面纱。但如果你以为这只是又一次跑分竞赛的胜利，那可就小瞧了它。依我看，Gemini 3更像是一个信号，预示着我们正告别“你问我答”的聊天机器人时代，迈向AI真正“动手干活”的新纪元。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F11%2FiShot_2025-11-19_21.45.04-1024x469.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/11/iShot_2025-11-19_21.45.04-1024x469.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fffc513724a54ca6b08c7bfe6b4295f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764165123&amp;x-signature=IXJUq1%2FkFldnxbTQopasJ%2F3G%2F0w%3D" alt="iShot_2025-11-19_21.45.04" loading="lazy"/></a></p>
<h4 data-id="heading-0">不止于“聪明绝顶”，更在于“触类旁通”</h4>
<p>先来说说它的“聪明”。Gemini 3在各项基准测试上的表现，简直是教科书级别的。想想看，在“Humanity's Last Exam”（人类最终考试，博士级推理）上，它拿下了37.5%的惊人分数；面对GPQA Diamond（研究生科学问题），更是高达91.9%；连硬核的MathArena Apex，也啃下了23.4%。这些数字背后，是Gemini 3在多步骤、长链条复杂推理能力上的显著飞跃，足以让它在高级学术和专业领域游刃有余。</p>
<p>而它的“触类旁通”则体现在无与伦比的多模态理解上。无论是MMMU-Pro的图像理解（81%），还是Video-MMMU的视频理解（87.6%），Gemini 3都树立了新的行业标杆。这意味着它不再是单一维度的信息处理者，而是能够像人类一样，将文字、图像、视频、音频融会贯通，形成对世界的整体认知。最令人印象深刻的是它在事实性（SimpleQA Verified 72.1%）上的提升，这让它的输出更具可靠性。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F11%2FiShot_2025-11-19_21.45.11-1024x928.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/11/iShot_2025-11-19_21.45.11-1024x928.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8c99ff8909140d8b80f96a1f3eaa4c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764165123&amp;x-signature=YemKbfyfCJRHORlRtm7HYiQna%2Fc%3D" alt="iShot_2025-11-19_21.45.11" loading="lazy"/></a></p>
<h4 data-id="heading-1">从“回答问题”到“主动干活”：AI的“执行官”之路</h4>
<p>然而，Gemini 3真正的变革之处，在于它工作方式的根本性转变。谷歌传递出的核心理念是：AI不再仅仅是提供答案的“百科全书”，而是能够理解并完成复杂任务的“执行官”。</p>
<p>想象一下，你不再需要一步步指示AI去“扫描邮件”、“分类归档”、“起草回复”，而是直接告诉它：“帮我把Gmail收件箱整理一下。”Gemini 3就能自主规划，将这个复杂目标拆解成一系列具体动作并执行。这种智能体（Agentic）能力，让它能够自动编写完整的游戏，甚至根据简单的提示词生成描述GLP-1受体机制的复杂3D动画代码——这在过去，可是只有专业人士才能完成的“黑科技”。</p>
<p>值得一提的还有它的“Deep Think模式”，这个为解决极端复杂问题而生的增强推理模式，未来将向Ultra订阅用户开放，无疑将把AI的思维深度推向新的高度。同时，“生成式UI”的出现，让AI能够根据指令动态生成交互式界面和工具，信息不再是静态的文字，而是活生生的、可操作的数字体验。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F11%2Fasdasdg-1024x332.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/11/asdasdg-1024x332.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b3185b658c44e228d4032c0e0671d23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764165123&amp;x-signature=gbhVJejSECEq%2F%2FVdomJxs6fQ0iI%3D" alt="asdasdg" loading="lazy"/></a></p>
<h4 data-id="heading-2">开发者的新舞台与用户的即刻触达</h4>
<p>对于开发者而言，Gemini 3带来了前所未有的自由度。配套发布的“Google Antigravity”平台，直接将智能体变成了开发流程的核心伙伴。AI可以直接操作编辑器、终端和浏览器，自主规划并执行复杂的端到端软件任务，甚至能验证自己编写的代码，这无疑将重塑软件开发的未来。</p>
<p>而对于普通用户来说，最振奋人心的莫过于Gemini 3的即刻触达。谷歌首次在发布当天就将新模型深度集成到搜索（AI Mode）、Gemini App、Gmail、Docs等拥有数十亿用户的核心产品中。这意味着，你无需改变日常习惯，就能在每天使用的工具中，直接体验到这个最前沿的AI能力。AI不再是高高在上的技术概念，而是润物细无声地融入了你的数字生活。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F11%2Ferberdb.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/11/erberdb.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8376eb910134d1f9848898ed031f458~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764165123&amp;x-signature=vAFjxm24Ore63Aedxn5RXK7m8YU%3D" alt="erberdb" loading="lazy"/></a></p>
<h4 data-id="heading-3">总结：AI竞争的“下半场”已然打响</h4>
<p>Gemini 3的发布，清晰地告诉我们：AI领域的竞争焦点，已经从单纯的模型性能跑分，转向了任务执行能力、分发效率和生态系统的综合比拼。它不再是一个需要你主动提问的聊天机器人，而是正逐渐成为一个嵌入你数字生活各个角落的、主动的执行与协作系统。</p>
<p>这不仅仅是谷歌的一次技术突破，更是整个AI行业发展轨迹的清晰缩影。一个“能干”、能够“自己动手”的AI时代，已经悄然来临。</p>
<p><strong>如果你也对最新的AI信息感兴趣或者有疑问 都可以加入我的大家庭 第一时间分享最新AI资讯、工具、教程、文档 欢迎你的加入！！！😉😉😉</strong></p>
<p>公众号：墨风如雪小站</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cloudflare 崩溃梗图]]></title>    <link>https://juejin.cn/post/7574270661872435238</link>    <guid>https://juejin.cn/post/7574270661872435238</guid>    <pubDate>2025-11-19T12:23:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574270661872435238" data-draft-id="7574244766424121353" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cloudflare 崩溃梗图"/> <meta itemprop="keywords" content="前端,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-11-19T12:23:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="冴羽"/> <meta itemprop="url" content="https://juejin.cn/user/712139234359182"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cloudflare 崩溃梗图
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/712139234359182/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    冴羽
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T12:23:27.000Z" title="Wed Nov 19 2025 12:23:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. 新闻</h2>
<p>昨天，Cloudflare 崩了。</p>
<p>随后，OpenAI、X、Spotify、AWS、Shopify 等大型网站也崩了。</p>
<p>据说全球 20% 的网站都受到波及，不知道你是否也被影响了？</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aad0c79bd91e4bb690d62300b5d25223~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=wjJCuKl6ptCsVepr8NljPuH7oRI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">2. 事故原因</h2>
<p>整个事故持续了 5 个小时，根据 Cloudflare 的报告，最初公司怀疑是遭到了超大规模 DDoS 攻击，不过很快就发现了核心问题。</p>
<p>事故的根本原因是因为 Cloudflare 内部的一套用于识别和阻断恶意机器人流量的自动生成配置文件。</p>
<p>该配置文件在例行升级后规模意外变大，远超系统预期，撑爆了路由网络流量的软件限制，继而导致大量流量被标记为爬虫而被 Ban。</p>
<p>CEO 发布了道歉声明：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5bf0f808cc84fb3985bc3f01397d225~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=VRrRC09%2Blf6FcqNmiJMNOxg6zt8%3D" alt="" loading="lazy"/></p>
<p>不过这也不是第一次发生这种大规模事故了。</p>
<p>一个月前，亚马逊 AWS 刚出现持续故障，超过一千个网站和在线应用数小时瘫痪。</p>
<p>今年 7 月，美国网络安全服务提供商 CrowdStrike 的一次软件升级错误则造成全球范围蓝屏事故，机场停航、银行受阻、医院手术延期，影响持续多日。</p>
<h2 data-id="heading-2">3. 梗图</h2>
<p>每次这种大事故都会有不少梗图出现，这次也不少。</p>
<h3 data-id="heading-3">3.1. 第一天上班</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e6428c98346494ea90f9677d82b977f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=oyI8SIxuueI%2F%2BBTr%2BI9LPFeiwZg%3D" alt="" loading="lazy"/></p>
<p>苦了这位缩写为 SB 的老哥 😂</p>
<h3 data-id="heading-4">3.2. 真正的底座</h3>
<p>原本你以为的 Cloudflare：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1855bfae9994cdb9dec7cd1d5bcd012~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=qBYBOSiOnXG9UI%2FLTm2c6MO8XUE%3D" alt="" loading="lazy"/></p>
<p>经过这次事故，实际的 Cloudflare：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2c507325a694b1db6f386efba6742bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=iqld9nUBTCxHVM18JiZWef2SBzs%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">3.3. 死循环</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a42d21916ffe443388c531ec8e42c1fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=%2BtnqEc%2BcYHfnOkwFnJQQ6lyzLAw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e51ecc60c7874003acc8c558cc0bf3ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=U1LUuApuf30DxBssewKNavbzJgo%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">3.4. 按秒赔偿</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8656a6128aa0465ca09da453b46c2857~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=zqZoJ7OtxQ0o4ZlE3GbBCc2O2E4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">3.5. 影响到我了</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf3b3ae0aa9246588269c06cc88aa190~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=J%2FJbj55S%2FKLzIUNlBWhJ3HCIaFQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/beb564eee2874557976897053d468396~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=LAEsqLU%2FtqbgSrpwaJtwsqqYgQ8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3420d85e9b1149538f8147692ff317f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=%2BcOZCFkG8S9UcFjsLZoCfCfJqh8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-8">3.6. 影响惨了</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60b395ff70c148c78f624a4310045fea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=iH3u85ZDGV0fcdngtNCQ6p8NiNg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4921568a36c64c04972b1ea73494c2c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=sRGmUAsOmLxL%2FeUlSZr4NfObLCU%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/317c4a6e9f49498d8b887f4dc477e8bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=pa19YSJ6gsFJQuuIPyBQMCfEgtk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">3.7. 这是发动战争了？</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8117d206fe746ca90b17141fb9a523a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=ngbCtEEFaam7d9DMO8D5MPObq6Y%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">3.8. 加速失败</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bdca90e003144fe843c512bde8d4c38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=TtReeLhw2DAMAreoDnDtb4Oyh1A%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">3.9. mc 亦有记载</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6a899a8199a4e00a0809f659c16a6a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159807&amp;x-signature=0I5eCv736ndcPlhhvo1u4PChHuU%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Next.js第八章(路由处理程序)]]></title>    <link>https://juejin.cn/post/7574253222607142953</link>    <guid>https://juejin.cn/post/7574253222607142953</guid>    <pubDate>2025-11-19T12:24:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574253222607142953" data-draft-id="7574245125028970515" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Next.js第八章(路由处理程序)"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-11-19T12:24:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="小满zs"/> <meta itemprop="url" content="https://juejin.cn/user/2463384809252397"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Next.js第八章(路由处理程序)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2463384809252397/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    小满zs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T12:24:05.000Z" title="Wed Nov 19 2025 12:24:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">路由处理程序(Route Handlers)</h2>
<p>路由处理程序，可以让我们在Next.js中编写API接口，并且支持与客户端组件的交互，真正做到了什么叫<code>前后端分离人不分离</code>。</p>
<h4 data-id="heading-1">文件结构</h4>
<p>定义前端路由页面我们使用的<code>page.tsx</code>文件，而定义API接口我们使用的<code>route.ts</code>文件，并且他两都不受文件夹的限制，可以放在任何地方，只需要文件的名称以<code>route.ts</code>结尾即可。</p>
<blockquote>
<p>注意：<code>page.tsx</code>文件和<code>route.ts</code>文件不能放在同一个文件夹下，否则会报错，因为Next.js就搞不清到底用哪一个了，所以我们最好把前后端代码分开。</p>
</blockquote>
<p>为此我们可以定义一个<code>api</code>文件夹，然后在这个文件夹下创建一对应的模块例如<code>user</code> <code>login</code> <code>register</code>等。</p>
<p>目录结构如下</p>
<pre><code class="hljs language-txt" lang="txt">app/
├── api
│   ├── user
│   │   └── route.ts
│   ├── login
│   │   └── route.ts
│   └── register
│       └── route.ts
</code></pre>
<h4 data-id="heading-2">定义请求</h4>
<p>Next.js是遵循<code>RESTful API</code>的规范，所以我们可以使用HTTP方法来定义请求。</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">GET</span>(<span class="hljs-params">request</span>) {}
 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HEAD</span>(<span class="hljs-params">request</span>) {}
 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">POST</span>(<span class="hljs-params">request</span>) {}
 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">PUT</span>(<span class="hljs-params">request</span>) {}
 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">DELETE</span>(<span class="hljs-params">request</span>) {}
 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">PATCH</span>(<span class="hljs-params">request</span>) {}
 
<span class="hljs-comment">//如果没有定义OPTIONS方法，则Next.js会自动实现OPTIONS方法</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">OPTIONS</span>(<span class="hljs-params">request</span>) {}
</code></pre>
<blockquote>
<p>注意: 我们在定义这些请求方法的时候<code>不能修改方法名称而且必须是大写</code>，否则无效。</p>
</blockquote>
<p>工具准备: 打开vsCode / Cursor 找到插件市场搜索<code>REST Client</code>，安装完成后，我们可以使用<code>REST Client</code>来测试API接口。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36c7565a81d348d5b4287b8157a5124a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159844&amp;x-signature=8Zw4fapzBgzy3yFJ1wIcJUAbphg%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-3">定义GET请求</h4>
<p>src/app/api/user/route.ts</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NextRequest</span>, <span class="hljs-title class_">NextResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/server"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">GET</span>(<span class="hljs-params">request: NextRequest</span>) {
    <span class="hljs-keyword">const</span> query = request.<span class="hljs-property">nextUrl</span>.<span class="hljs-property">searchParams</span>; <span class="hljs-comment">//接受url中的参数</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(query.<span class="hljs-title function_">get</span>(<span class="hljs-string">'id'</span>));
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">NextResponse</span>.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Get request successful'</span> }); <span class="hljs-comment">//返回json数据</span>
}
</code></pre>
<p>REST client测试:</p>
<p>在src目录新建<code>test.http</code>文件，编写测试请求</p>
<p>src/test.http</p>
<pre><code class="hljs language-http" lang="http">GET http://localhost:3000/api/user?id=123 HTTP/1.1
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b33e7766b81d4cc59227c800757fe48b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159844&amp;x-signature=qILSjK%2BeAJEs4l6b50BQ%2BhZuzXI%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">定义Post请求</h4>
<p>src/app/api/user/route.ts</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NextRequest</span>, <span class="hljs-title class_">NextResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/server"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">POST</span>(<span class="hljs-params">request: NextRequest</span>){
    <span class="hljs-comment">//const body = await request.formData(); //接受formData数据</span>
    <span class="hljs-comment">//const body = await request.text(); //接受text数据</span>
    <span class="hljs-comment">//const body = await request.arrayBuffer(); //接受arrayBuffer数据</span>
    <span class="hljs-comment">//const body = await request.blob(); //接受blob数据</span>
    <span class="hljs-keyword">const</span> body = <span class="hljs-keyword">await</span> request.<span class="hljs-title function_">json</span>(); <span class="hljs-comment">//接受json数据</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(body); <span class="hljs-comment">//打印请求体中的数据</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">NextResponse</span>.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Post request successful'</span>, body },{<span class="hljs-attr">status</span>: <span class="hljs-number">201</span>});
     <span class="hljs-comment">//返回json数据</span>
}
</code></pre>
<p>REST client测试:</p>
<p>src/test.http</p>
<pre><code class="hljs language-http" lang="http">POST http://localhost:3000/api/user HTTP/1.1
Content-Type: application/json

{
    "name": "张三",
    "age": 18
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b352fedfccc3478ba8fdf59abd2d3aef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159844&amp;x-signature=OVci%2BdTshmVDWWjdpHN1Qg%2BbbKQ%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-5">动态参数</h4>
<p>我们可以在路由中使用方括号<code>[]</code>来定义动态参数，例如<code>/api/user/[id]</code>，其中<code>[id]</code>就是动态参数，这个参数可以在请求中传递，这个跟前端路由的动态路由类似。</p>
<p>src/app/api/user/[id]/route.ts</p>
<p>接受动态参参数，需要在第二个参数解构{ params },需注意这个参数是异步的，所以需要使用<code>await</code>来等待参数解析完成。</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NextRequest</span>, <span class="hljs-title class_">NextResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/server"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">GET</span>(<span class="hljs-params">request: NextRequest, 
{ params }: { params: <span class="hljs-built_in">Promise</span>&lt;{ id: <span class="hljs-built_in">string</span> }&gt; }</span>) {
    <span class="hljs-keyword">const</span> { id } = <span class="hljs-keyword">await</span> params;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(id);
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">NextResponse</span>.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">`Hello, <span class="hljs-subst">${id}</span>!`</span> });
}
</code></pre>
<p>REST client测试:</p>
<p>src/test.http</p>
<pre><code class="hljs language-http" lang="http">GET http://localhost:3000/api/user/886 HTTP/1.1
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11205ab7973d4fdd88bb9b49d2d8deec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159844&amp;x-signature=BGetDCCP7qfswykFY6FLaNtM6pc%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">cookie</h4>
<p>Next.js也内置了cookie的操作可以方便让我们读写，接下来我们用一个登录的例子来演示如何使用cookie。</p>
<p>安装手动挡组件库<code>shadcn/ui</code><a href="https://link.juejin.cn?target=https%3A%2F%2Fui.shadcn.com%2F" target="_blank" title="https://ui.shadcn.com/" ref="nofollow noopener noreferrer">官网地址</a></p>
<pre><code class="hljs language-sh" lang="sh">npx shadcn@latest init 
</code></pre>
<p>为什么使用这个组件库？因为这个组件库是把组件放入你项目的目录下面，这样做的好处是可以让你随时修改组件库样式，并且还能通过AI分析修改组件库</p>
<p>安装button,input组件</p>
<pre><code class="hljs language-sh" lang="sh">npx shadcn@latest add button
npx shadcn@latest add input
</code></pre>
<p>新建login接口
src/app/api/login/route.ts</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { cookies } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/headers"</span>; <span class="hljs-comment">//引入cookies</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">NextRequest</span>, <span class="hljs-title class_">NextResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/server"</span>; <span class="hljs-comment">//引入NextRequest, NextResponse</span>
<span class="hljs-comment">//模拟登录成功后设置cookie</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">POST</span>(<span class="hljs-params">request: NextRequest</span>) {
    <span class="hljs-keyword">const</span> body = <span class="hljs-keyword">await</span> request.<span class="hljs-title function_">json</span>();
    <span class="hljs-keyword">if</span>(body.<span class="hljs-property">username</span> === <span class="hljs-string">'admin'</span> &amp;&amp; body.<span class="hljs-property">password</span> === <span class="hljs-string">'123456'</span>){
        <span class="hljs-keyword">const</span> cookieStore = <span class="hljs-keyword">await</span> <span class="hljs-title function_">cookies</span>(); <span class="hljs-comment">//获取cookie</span>
        cookieStore.<span class="hljs-title function_">set</span>(<span class="hljs-string">'token'</span>, <span class="hljs-string">'123456'</span>,{
            <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//只允许在服务器端访问</span>
            <span class="hljs-attr">maxAge</span>: <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">24</span> * <span class="hljs-number">30</span>, <span class="hljs-comment">//30天</span>
        });
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">NextResponse</span>.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">code</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">status</span>: <span class="hljs-number">200</span> });
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">NextResponse</span>.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">code</span>: <span class="hljs-number">0</span> }, { <span class="hljs-attr">status</span>: <span class="hljs-number">401</span> });
    }
}
<span class="hljs-comment">//检查登录状态</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">GET</span>(<span class="hljs-params">request: NextRequest</span>) {
    <span class="hljs-keyword">const</span> cookieStore = <span class="hljs-keyword">await</span> <span class="hljs-title function_">cookies</span>();
    <span class="hljs-keyword">const</span> token = cookieStore.<span class="hljs-title function_">get</span>(<span class="hljs-string">'token'</span>);
    <span class="hljs-keyword">if</span>(token &amp;&amp; token.<span class="hljs-property">value</span> === <span class="hljs-string">'123456'</span>){
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">NextResponse</span>.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">code</span>:<span class="hljs-number">1</span> }, { <span class="hljs-attr">status</span>: <span class="hljs-number">200</span> });
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">NextResponse</span>.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">code</span>:<span class="hljs-number">0</span> }, { <span class="hljs-attr">status</span>: <span class="hljs-number">401</span> });
    }
}
</code></pre>
<p>src/app/page.tsx</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-string">'use client'</span>;
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/ui/button'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Input</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/ui/input'</span>;
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'next/navigation'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">HomePage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>();
    <span class="hljs-keyword">const</span> [username, setUsername] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
    <span class="hljs-keyword">const</span> [password, setPassword] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogin</span> = (<span class="hljs-params"/>) =&gt; {
        <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/login'</span>, {
            <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
            <span class="hljs-attr">headers</span>: {
                <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
            },
            <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ username, password }),
        }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
            <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
        }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
            <span class="hljs-keyword">if</span>(data.<span class="hljs-property">code</span> === <span class="hljs-number">1</span>){
                router.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/home'</span>);
            }
        });
    }
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'mt-10 flex flex-col items-center justify-center gap-4'</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{username}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setUsername(e.target.value)} className='w-[250px]' placeholder="请输入用户名" /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{password}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setPassword(e.target.value)} className='w-[250px]' placeholder="请输入密码" /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleLogin}</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p>src/app/home/page.tsx</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-string">'use client'</span>;
<span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { redirect } <span class="hljs-keyword">from</span> <span class="hljs-string">'next/navigation'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">checkLogin</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/login'</span>);
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>();
    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">code</span> === <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">redirect</span>(<span class="hljs-string">'/'</span>);
    }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HomePage</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">checkLogin</span>()    
    }, []);
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>你已经登录进入home页面<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9071f38c83b44efebfef84deb5241892~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764159844&amp;x-signature=gRwfrsES%2Bdl%2Bj8kaG2%2FI%2BtaFtXQ%3D" alt="123.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【Agent】MemOS 源码笔记---(1)--基本概念]]></title>    <link>https://juejin.cn/post/7574269207362600969</link>    <guid>https://juejin.cn/post/7574269207362600969</guid>    <pubDate>2025-11-19T12:28:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574269207362600969" data-draft-id="7574289653177303078" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【Agent】MemOS 源码笔记---(1)--基本概念"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2025-11-19T12:28:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="罗西的思考"/> <meta itemprop="url" content="https://juejin.cn/user/351470467691175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【Agent】MemOS 源码笔记---(1)--基本概念
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/351470467691175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    罗西的思考
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T12:28:20.000Z" title="Wed Nov 19 2025 12:28:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读23分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">【Agent】MemOS 源码笔记---(1)--基本概念</h2>
<ul>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x00 概要</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x01 背景</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.1 为什么需要MemOS</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.2 MemOS 相关信息</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.3 MemOS能做些什么</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x02 原理</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.1 记忆类型</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x03 MemCube</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.1 结构</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.2 初始化</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.3 核心方法</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.4 GeneralMemCube</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.5 实例</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x04 记忆生产流程</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x05 常见问题</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">Q：MemOS 和普通 RAG 框架有什么区别？</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">Q：MemOS 可以和已有 RAG 或知识图谱结合吗？</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0xFF 参考</a></p>
</li>
</ul>
<h3 data-id="heading-1">0x00 概要</h3>
<p>随着大型语言模型（LLMs）的不断演进，其所承担的任务日益复杂，包括多轮对话、规划、决策制定以及个性化代理等。然而，主流 LLM 架构往往在记忆结构化、管理和集成方面存在不足，导致知识更新成本高、行为状态不可持续以及难以积累用户偏好。因此，在此背景下，如何高效管理和利用记忆，成为实现长期智能与适应性能力的关键因素。</p>
<p>MemOS（Memory Operating System）的核心思想是把“记忆”从辅助功能提升为系统级资源：统一格式、统一生命周期、统一调度。它像操作系统管理磁盘一样管理记忆——自动存取、版本控制、冷热分层、并发安全，让大模型应用无需重复编写记忆逻辑，就能持续积累知识、按需调用上下文、并在多轮对话中保持连贯。</p>
<p>MemOS 的内容非常丰富，是个宝库，但是因为内容太多，所以只能找自己最好奇的地方去阅读。而且，因为本系列是使用MemOS的某个版本进行学习，而MemOS 本身在飞速发展，因此本系列的内容可能与最新进展有出入。</p>
<p>**本文是基于MemOS的文档内容进行梳理和重整，把散落在多个文档中的内容，按照自己的理解聚合到一个文档中。**希望借助本文，读者可以了解到MemOS的意义、设计思路和基本概念。</p>
<p>注：MemOS文档非常出色，本系列会大量直接引用其文档。</p>
<h3 data-id="heading-2">0x01 背景</h3>
<h4 data-id="heading-3">1.1 为什么需要MemOS</h4>
<p>大模型原生的记忆存在局限：</p>
<ul>
<li>上下文有限：一次对话的Token窗口再大，也无法承载长期知识。</li>
<li>遗忘严重：用户上周说过的偏好，下次对话就消失了。</li>
<li>难以管理：随着交互增多，记忆混乱，开发者需要额外逻辑处理。</li>
</ul>
<p>MemOS的价值在于，它抽象出记忆层，让你只关注业务逻辑：</p>
<ul>
<li>不再手写繁琐的“长文本拼接”或“额外数据库调用”。</li>
<li>记忆可以像模块一样复用、扩展，甚至在不同Agent、不同系统之间共享。</li>
<li>通过主动调度和多层管理，记忆调用更快、更准，显著降低幻觉。</li>
</ul>
<p>简单来说：MemOS让AI不再是一次性的对话机器，而是能持续成长的伙伴。</p>
<p>下图右侧是传统记忆系统，左侧是MemOS。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b79143f8dcb4ad89330a9b566c469d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764160100&amp;x-signature=TZ0rAw8TdxcxTxcY2Bc2W6B2Jwo%3D" alt="cookbook-chapter3-chart.png" loading="lazy"/></p>
<h4 data-id="heading-4">1.2 MemOS 相关信息</h4>
<p>论文名称: MemOS: A Memory OS for AI System*</p>
<p>第一作者: MemTensor (Shanghai) Technology Co., Ltd.</p>
<p><em>论文链接: <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Farxiv.org%2Fpdf%2F2507.03724" target="_blank" title="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2507.03724" ref="nofollow noopener noreferrer">arxiv.org/pdf/2507.03…</a></em></p>
<p>GitHub：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fgithub.com%2FMemTensor%2FMemOS.git" target="_blank" title="https://link.zhihu.com/?target=https%3A//github.com/MemTensor/MemOS.git" ref="nofollow noopener noreferrer">github.com/MemTensor/M…</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMemTensor%2FMemOS-Docs" target="_blank" title="https://github.com/MemTensor/MemOS-Docs" ref="nofollow noopener noreferrer">github.com/MemTensor/M…</a></li>
</ul>
<h4 data-id="heading-5">1.3 MemOS能做些什么</h4>
<ul>
<li>个性化对话：记住用户的姓名、习惯、兴趣、指令偏好，下次自动补充。</li>
<li>团队知识库：把碎片对话转化为结构化知识，供多个 Agent 协作使用。</li>
<li>任务连续性：跨会话、跨应用保持记忆，让 AI 从容处理长流程任务。</li>
<li>多层记忆调度：针对不同需求调用最合适的记忆，提升性能与准确率。</li>
<li>开放扩展：支持单独作为 API 使用，也能接入现有的框架（官方使用指导即将上线，着急的老师们也可以先自己动手哦~）</li>
</ul>
<h3 data-id="heading-6">0x02 原理</h3>
<p>参数化记忆将完成 MemOS 关于统一<strong>Memory³</strong>架构的设想：</p>
<ul>
<li><strong>参数化记忆</strong>: 嵌入知识</li>
<li><strong>激活记忆</strong>: 短暂的运行状态</li>
<li><strong>明文记忆</strong>: 结构化的、可追溯的外部记忆</li>
</ul>
<p>将这三者结合在一起，可以实现适应性强、可进化和可解释的智能系统。</p>
<p>下图就是MemOS的系统架构。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ec60c953e3749d0a333f0e814224f05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764160100&amp;x-signature=zsgiMH3kFZK7FFxfDKpAKGM2qo8%3D" alt="memos-architecture.png" loading="lazy"/></p>
<h4 data-id="heading-7">2.1 记忆类型</h4>
<p>MemOS 把记忆分为以下三种。</p>
<ul>
<li>结构化记忆（明文记忆）：尝试基于图的分层知识 TreeTextMemory，是结构化、层次化和知识图谱。图与向量后端会连接 Neo4j 或 Qdrant 实现生产级向量/图搜索。</li>
<li>激活记忆：使用 KVCacheMemory （最近或稳定的上下文）加速多轮对话，高效的运行时状态缓存。</li>
<li>参数化记忆：用适配器/LoRA 实现动态技能注入。</li>
</ul>
<h5 data-id="heading-8">2.1.1 GeneralTextMemory</h5>
<p>title: "GeneralTextMemory: 通用文本的记忆"。</p>
<p>desc: "<code>GeneralTextMemory</code> 是MemOS中一个灵活的、基于向量的明文记忆模块，用于存储、搜索和管理非结构化知识。它适用于会话代理、个人助理和任何需要语义记忆检索的系统。"</p>
<h6 data-id="heading-9">记忆结构</h6>
<p>每条记忆都存储为一个 <code>TextualMemoryItem</code>：</p>
<ul>
<li><code>memory</code>：主要文本内容（例如，“用户喜欢番茄。”）</li>
<li><code>metadata</code>：额外信息，使记忆可搜索且易于管理——类型、时间、来源、置信度、实体、标签、可见性和更新时间。</li>
</ul>
<p>这些字段使每条记忆都能被查询、筛选和方便治理。</p>

























<table><thead><tr><th>字段</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>id</code></td><td><code>str</code></td><td>UUID (如果省略则自动生成)</td></tr><tr><td><code>memory</code></td><td><code>str</code></td><td>记忆内容主体 (必填)</td></tr><tr><td><code>metadata</code></td><td><code>TextualMemoryMetadata</code></td><td>元数据（用于搜索/过滤）</td></tr></tbody></table>
<h6 data-id="heading-10">元数据域 (<code>TextualMemoryMetadata</code>)</h6>


















































<table><thead><tr><th>字段</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>type</code></td><td><code>"procedure"</code>, <code>"fact"</code>, <code>"event"</code>, <code>"opinion"</code></td><td>记忆类型，比如它是事实、事件还是观点</td></tr><tr><td><code>memory_time</code></td><td><code>str (YYYY-MM-DD)</code>，比如<code>"2025-07-02"</code></td><td>记忆所指的日期/时间</td></tr><tr><td><code>source</code></td><td><code>"conversation"</code>, <code>"retrieved"</code>, <code>"web"</code>, <code>"file"</code></td><td>记忆源</td></tr><tr><td><code>confidence</code></td><td><code>float (0-100)</code></td><td>确定性/可信度评分（0–100）</td></tr><tr><td><code>entities</code></td><td><code>list[str]</code>，比如<code>["tomatoes"]</code></td><td>主要实体/概念</td></tr><tr><td><code>tags</code></td><td><code>list[str]</code>，比如<code>["food", "preferences"]</code></td><td>主题标签，即分组用的额外标签</td></tr><tr><td><code>visibility</code></td><td><code>"private"</code>, <code>"public"</code>, <code>"session"</code></td><td>访问范围，即谁可以访问</td></tr><tr><td><code>updated_at</code></td><td><code>str</code>，比如<code>"2025-07-02T00:00:00Z"</code></td><td>最近更新时间戳 (ISO 8601)</td></tr></tbody></table>
<p>所有的值都经过验证，无效的值将引发错误。</p>
<h5 data-id="heading-11">2.1.2 TreeTextMemory</h5>
<p><strong>TreeTextMemory</strong> 支持以结构化方式组织、关联并检索记忆，同时保留丰富的上下文信息与良好的可解释性。即，TreeTextMemory是分层结构的、基于图的、树形明文记忆。当前使用<a href="/open_source/modules/memories/neo4j_graph_db" target="_blank" title="/open_source/modules/memories/neo4j_graph_db">Neo4j</a>作为后端，未来计划支持更多图数据库。</p>
<h6 data-id="heading-12">记忆结构</h6>
<p>每个节点在<code>TreeTextMemory</code> 是一个 <code>TextualMemoryItem</code>:</p>
<ul>
<li><code>id</code>: 唯一记忆ID（如果省略则自动生成）</li>
<li><code>memory</code>: 主要文本</li>
<li><code>metadata</code>: 包括层次结构信息、嵌入、标签、实体、源和状态</li>
</ul>
<h6 data-id="heading-13">元数据字段 (<code>TreeNodeTextualMemoryMetadata</code>)</h6>











































































<table><thead><tr><th>字段</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>memory_type</code></td><td><code>"WorkingMemory"</code>, <code>"LongTermMemory"</code>, <code>"UserMemory"</code></td><td>生命周期分类</td></tr><tr><td><code>status</code></td><td><code>"activated"</code>, <code>"archived"</code>, <code>"deleted"</code></td><td>节点状态</td></tr><tr><td><code>visibility</code></td><td><code>"private"</code>, <code>"public"</code>, <code>"session"</code></td><td>访问范围</td></tr><tr><td><code>sources</code></td><td><code>list[str]</code></td><td>来源列表 (例如: 文件, URLs)</td></tr><tr><td><code>source</code></td><td><code>"conversation"</code>, <code>"retrieved"</code>, <code>"web"</code>, <code>"file"</code></td><td>原始来源类型</td></tr><tr><td><code>confidence</code></td><td><code>float (0-100)</code></td><td>确定性得分</td></tr><tr><td><code>entities</code></td><td><code>list[str]</code></td><td>提及的实体或概念</td></tr><tr><td><code>tags</code></td><td><code>list[str]</code></td><td>主题标签</td></tr><tr><td><code>embedding</code></td><td><code>list[float]</code></td><td>基于向量嵌入的相似性搜索</td></tr><tr><td><code>created_at</code></td><td><code>str</code></td><td>创建时间戳(ISO 8601)</td></tr><tr><td><code>updated_at</code></td><td><code>str</code></td><td>最近更新时间戳(ISO 8601)</td></tr><tr><td><code>usage</code></td><td><code>list[str]</code></td><td>使用历史</td></tr><tr><td><code>background</code></td><td><code>str</code></td><td>附加上下文</td></tr></tbody></table>
<p><strong>最佳实践</strong>：使用有意义的标签和背景——它们有助于组织你的图进行多跳推理。</p>
<h6 data-id="heading-14">特色</h6>
<p>TreeTextMemory的特点为：</p>
<ul>
<li><strong>结构层次:</strong> 像思维导图一样组织记忆——节点可以有父母、孩子和交叉链接。</li>
<li><strong>图风格的链接:</strong> 超越纯粹的层次结构-建立多跳推理链。</li>
<li><strong>语义搜索+图扩展:</strong> 结合向量和图形的优点。</li>
<li><strong>可解释性:</strong> 追踪记忆是如何连接、合并或随时间演变的.</li>
</ul>
<h5 data-id="heading-15">2.1.3 KVCacheMemory（激活记忆）</h5>
<p>KVCacheMemory 是MemOS中用于存储和管理KV cache的专用记忆模块，主要用于加速大语言模型（LLMs）推理并支持有效的上下文复用。它作为激活记忆有助于对于会话式和生成式人工智能系统。</p>
<p>在MemOS中，KV Cache最适合存储<strong>语义稳定且经常复用的背景信息</strong>，例如：</p>
<ul>
<li>常见问题（FAQs）或特定领域知识</li>
<li>先前的对话历史</li>
</ul>
<p>这些稳定的<strong>明文记忆项</strong>由<code>MemScheduler</code>模块自动识别和管理。一旦被选中，它们就会被提前转换成KV格式的表示(<code>KVCacheItem</code>)。这个预计算步骤以可复用的格式存储记忆的激活状态（键值对张量），允许它们在推理期间注入到模型的注意力缓存中</p>
<p>一旦进行转换，这些KV记忆就可以<strong>跨查询复用</strong>，而不需要对原始内容重新编码。这减少了处理和存储大量文本的计算开销，使其成为需要<strong>快速响应时间</strong>和<strong>高吞吐量</strong>的应用程序的理想选择。</p>
<h6 data-id="heading-16">记忆结构</h6>
<p>通过<code>KVCacheMemory</code>实现基于KV的记忆复用，在保持相同输出的同时，大大减少了模型大小和查询类型之间的延迟。通过将可复用记忆从明文提示转移到预先计算的KV Cache，MemOS消除了冗余的上下文编码，并实现了更快的响应时间，特别是在实时的、记忆增强的LLM应用程序中。</p>
<p>每个缓存被存储为一个<code>KVCacheItem</code>:</p>

























<table><thead><tr><th>字段</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>kv_cache_id</code></td><td><code>str</code></td><td>缓存中的唯一ID(UUID)</td></tr><tr><td><code>kv_cache</code></td><td><code>DynamicCache</code></td><td>实际的KV Cache(transformers)</td></tr><tr><td><code>metadata</code></td><td><code>dict</code></td><td>元数据 (源, 抽取时间等.)</td></tr></tbody></table>
<h6 data-id="heading-17">API总结 (<code>KVCacheMemory</code>)</h6>
<p>初始化</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">KVCacheMemory</span>(config: KVCacheMemoryConfig)
</code></pre>
<p>核心方法如下：</p>





















































<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td><code>extract(text)</code></td><td>使用LLM从输入文本中提取KV Cache</td></tr><tr><td><code>add(memories)</code></td><td>添加一个或多个<code>KVCacheItem</code>到记忆中</td></tr><tr><td><code>get(memory_id)</code></td><td>根据ID获取单个缓存</td></tr><tr><td><code>get_by_ids(ids)</code></td><td>根据IDs获取多个缓存</td></tr><tr><td><code>get_all()</code></td><td>返回所有存储的缓存</td></tr><tr><td><code>get_cache(cache_ids)</code></td><td>从多个IDs合并并返回组合缓存</td></tr><tr><td><code>delete(ids)</code></td><td>通过IDs删除缓存</td></tr><tr><td><code>delete_all()</code></td><td>删除所有缓存</td></tr><tr><td><code>dump(dir)</code></td><td>将所有缓存序列化到目录中的pickle文件</td></tr><tr><td><code>load(dir)</code></td><td>从目录中的pickle文件加载缓存</td></tr><tr><td><code>from_textual_memory(mem)</code></td><td>将<code>TextualMemoryItem</code> 转换为 <code>KVCacheItem</code></td></tr></tbody></table>
<p>当调用<code>dump(dir)</code>, 系统写到:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dir</span>&gt;</span>/<span class="hljs-tag">&lt;<span class="hljs-name">config.memory_filename</span>&gt;</span>
</code></pre>
<p>该文件包含所有KV Cache的pickle字典，可以使用<code>load(dir)</code>重新加载。</p>
<h6 data-id="heading-18">特色</h6>
<p>将<code>MemScheduler</code>与KV Cache记忆集成可以实现显著的性能优化，特别是在LLM推理的<strong>预填充阶段</strong>。</p>
<p>当无KV Cache记忆时</p>
<ul>
<li>每个新查询都被添加到完整的提示模板中，包括背景知识。</li>
<li>模型必须在整个序列上<strong>重新计算token嵌入和注意力</strong>——即使是未更改的记忆。</li>
</ul>
<p>当有KV Cache记忆时</p>
<ul>
<li>背景知识以键值对张量的形式<strong>缓存一次</strong>。</li>
<li>对于每个查询，只对新用户输入（查询token）进行编码。</li>
<li>之前缓存的KV被直接注入到注意力机制中。</li>
</ul>
<p>KV Cache这种分离减少了预填充阶段的冗余计算，从而导致:</p>
<ul>
<li>跳过背景知识的重复编码</li>
<li>更快的查询token和缓存记忆之间的注意力计算</li>
<li><strong>降低首次token时间(Time To First Token, TTFT)</strong> 生成过程中的延迟</li>
</ul>
<p>这种优化在以下方面特别有价值:</p>
<ul>
<li>多回合聊天机器人交互</li>
<li>检索增强生成或上下文增强生成(RAG, CAG)</li>
<li>在固定文档或FAQ风格记忆上操作的助理</li>
</ul>
<h5 data-id="heading-19">2.1.4 参数记忆</h5>
<p><code>参数化记忆(Parametric Memory)</code> 是MemOS内部的核心<strong>长期的知识和能力储存</strong>。与明文记忆或激活记忆不同，参数记忆，对语言结构、世界知识和一般推理能力的深度表示进行编码，直接嵌入在模型的权重中。</p>
<p>在MemOS架构中，参数记忆不仅仅指静态预训练权重。它还包括模块化权重组件，如<strong>LoRA适配器</strong>和插件专家模块。这些允许您逐步扩展或专业化您的LLM的能力，而无需重新训练整个模型。</p>
<p>例如，您可以将结构化或稳定的知识提取为参数形式，将其保存为<strong>能力块</strong>，并在推理过程中动态加载或卸载它。这使得为法律推理、财务分析或特定领域的摘要等任务创建“专家子模型”变得容易——所有这些都由MemOS管理。</p>
<h6 data-id="heading-20">设计目标</h6>
<ul>
<li><strong>可控制性</strong> — 按需生成、加载、交换或组合参数模块on demand.</li>
<li><strong>可塑性</strong> — 与明文和激活记忆一起演化；支持知识的提纯与回滚</li>
<li><strong>可追溯性</strong> <em>(开发中)</em> — 参数块的版本控制和管理</li>
</ul>
<h6 data-id="heading-21">当前状态</h6>
<p><code>参数化记忆(Parametric Memory)</code> 目前仍处于设计和原型阶段。用于生成、压缩以及热插拔参数模块的 API 将在未来版本中发布，旨在支持多任务、多角色和多代理架构。</p>
<h5 data-id="heading-22">2.1.5 混合模式</h5>
<h6 data-id="heading-23">何时使用：</h6>
<ul>
<li>你希望同时拥有长期可解释记忆与短期快速上下文。</li>
<li>理想场景：用于具备计划能力、能记住事实并保持上下文的复杂智能体。</li>
<li>展示多记忆调度能力。</li>
</ul>
<h6 data-id="heading-24">工作原理：</h6>
<ul>
<li><strong>TreeTextMemory</strong> 将你的长时记忆存储在图数据库（Neo4j）中。</li>
<li><strong>KVCacheMemory</strong> 将最近或稳定的上下文作为激活缓存保存。</li>
<li>二者在一个 <strong>MemCube</strong> 中协同工作，由你的 <code>MOS</code> Pipeline 统一管理。</li>
</ul>
<h3 data-id="heading-25">0x03 MemCube</h3>
<p>MemCube是 MemOS 中的核心组织单元，专为封装和管理用户或代理的所有类型记忆而设计。它为加载、保存和操作多个记忆模块提供统一接口，使构建、共享和部署记忆增强应用程序变得容易。</p>
<p><strong>MemCube</strong> 是一个容器，捆绑了三种主要类型的记忆：</p>
<ul>
<li><strong>明文记忆</strong> (例如，<code>GeneralTextMemory</code>、<code>TreeTextMemory</code>): 用于存储和检索非结构化或结构化文本知识。</li>
<li><strong>激活记忆</strong> (例如，<code>KVCacheMemory</code>): 用于存储键值缓存以加速 LLM 推理和上下文重用。</li>
<li><strong>参数化记忆</strong> (例如，<code>LoRAMemory</code>): 用于存储模型适应参数（如 LoRA 权重）。</li>
</ul>
<p>每种记忆类型都是独立可配置的，可以根据需要进行交换或扩展。</p>
<h4 data-id="heading-26">3.1 结构</h4>
<p>MemCube 由配置定义（参见 <code>GeneralMemCubeConfig</code>），该配置为每种记忆类型指定后端和配置。典型结构是：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">MemCube</span>
 <span class="hljs-string">├──</span> <span class="hljs-attr">text_mem:</span> <span class="hljs-string">TextualMemory</span>
 <span class="hljs-string">├──</span> <span class="hljs-attr">act_mem:</span> <span class="hljs-string">ActivationMemory</span>
 <span class="hljs-string">└──</span> <span class="hljs-attr">para_mem:</span> <span class="hljs-string">ParametricMemory</span>
</code></pre>
<p>所有记忆模块都可通过 MemCube 接口访问：</p>
<ul>
<li><code>mem_cube.text_mem</code></li>
<li><code>mem_cube.act_mem</code></li>
<li><code>mem_cube.para_mem</code></li>
</ul>
<p>基类代码如下：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseMemCube</span>(<span class="hljs-title class_ inherited__">ABC</span>):
    <span class="hljs-string">"""Base class for all MemCube implementations."""</span>

    @abstractmethod
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config: BaseMemCubeConfig</span>):
        <span class="hljs-string">"""Initialize the MemCube with the given configuration."""</span>
        self.text_mem: BaseTextMemory
        self.act_mem: BaseActMemory
        self.para_mem: BaseParaMemory

    @abstractmethod
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load</span>(<span class="hljs-params">self, <span class="hljs-built_in">dir</span>: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""Load memories from a directory."""</span>

    @abstractmethod
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">dump</span>(<span class="hljs-params">self, <span class="hljs-built_in">dir</span>: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""Dump memories to a directory."""</span>
</code></pre>
<h4 data-id="heading-27">3.2 初始化</h4>
<pre><code class="hljs language-arduino" lang="arduino">from memos.mem_cube.general <span class="hljs-keyword">import</span> GeneralMemCube
mem_cube = <span class="hljs-built_in">GeneralMemCube</span>(config)
</code></pre>
<h4 data-id="heading-28">3.3 核心方法</h4>
<p>MemCube 的核心方法如下：</p>





































<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td><code>load(dir)</code></td><td>从目录加载所有记忆</td></tr><tr><td><code>dump(dir)</code></td><td>将所有记忆保存到目录</td></tr><tr><td><code>text_mem</code></td><td>访问明文记忆模块</td></tr><tr><td><code>act_mem</code></td><td>访问激活记忆模块</td></tr><tr><td><code>para_mem</code></td><td>访问参数化记忆模块</td></tr><tr><td><code>init_from_dir(dir)</code></td><td>从目录加载 MemCube</td></tr><tr><td><code>init_from_remote_repo(repo, base_url)</code></td><td>从远程仓库加载</td></tr></tbody></table>
<h4 data-id="heading-29">3.4 GeneralMemCube</h4>
<p><code>GeneralMemCube</code>（通用记忆立方体）是一个<strong>记忆管理容器</strong>，核心职责是统一管理三种类型的 AI 记忆（文本记忆、激活记忆、参数化记忆），提供 “加载 - 存储 - 实例化” 的全流程能力，适配本地和远程两种数据来源场景。</p>
<h5 data-id="heading-30">3.4.1 核心特色</h5>
<ol>
<li>
<p><strong>多类型记忆统一管理</strong>：</p>
<ul>
<li>整合文本记忆（text_mem）、激活记忆（act_mem）、参数化记忆（para_mem）三类记忆，通过统一接口（load/dump）实现批量加载 / 存储，避免分散管理的繁琐。</li>
<li>支持按需加载 / 存储：可指定具体记忆类型，无需操作全部记忆，提升效率。</li>
</ul>
</li>
<li>
<p><strong>灵活的实例化方式</strong>：</p>
<ul>
<li>本地初始化：从本地目录加载配置和记忆数据（<code>init_from_dir</code>），适配离线使用场景。</li>
<li>远程初始化：从远程仓库（默认 Hugging Face）下载数据并初始化（<code>init_from_remote_repo</code>），支持共享和复用公开记忆资源。</li>
</ul>
</li>
<li>
<p><strong>配置安全与兼容性</strong>：</p>
<ul>
<li>配置校验：加载时校验配置文件的 schema 一致性，避免因配置格式不匹配导致的运行错误。</li>
<li>配置合并：支持将默认配置与用户配置合并，兼顾通用设置与个性化需求，提升配置灵活性。</li>
</ul>
</li>
<li>
<p><strong>类型安全与容错</strong>：</p>
<ul>
<li>记忆实例类型校验：通过 setter 方法强制校验记忆实例类型，确保仅支持对应基类的子类实例，避免类型错误。</li>
<li>未初始化提示：访问未初始化的记忆时输出警告日志，而非直接抛出异常，提升系统容错性。</li>
</ul>
</li>
<li>
<p><strong>数据安全保护</strong>：</p>
<ul>
<li>存储时校验目标目录是否为空，避免覆盖已有数据，防止误操作导致的数据丢失。</li>
<li>存储时自动同步配置文件，确保记忆数据与配置一一对应，便于后续加载和迁移。</li>
</ul>
</li>
</ol>
<h5 data-id="heading-31">3.4.2 流程图</h5>
<h6 data-id="heading-32">初始化</h6>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a28588ddae7e44da8f56526608f1b8db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764160100&amp;x-signature=8oQi3BKBXicD2H605paP3HRPipY%3D" alt="memos-1-1" loading="lazy"/></p>
<p>memos-1-1</p>
<h6 data-id="heading-33">加载流程</h6>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/605710786e95420ba40752740f6882d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764160100&amp;x-signature=bI%2BTctYxn6Sx02LiHHVRmJoJ6xc%3D" alt="memos-1-2" loading="lazy"/></p>
<p>memos-1-2</p>
<h6 data-id="heading-34">存储流程</h6>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29aa0c5169cf4c519d3f9dc5dc506f7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764160100&amp;x-signature=myHui4cUZYr4cg%2BrYoHVw%2BGCcWM%3D" alt="memos-1-3" loading="lazy"/></p>
<p>memos-1-3</p>
<h5 data-id="heading-35">3.4.3 代码</h5>
<p>GeneralMemCube 的代码如下</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GeneralMemCube</span>(<span class="hljs-title class_ inherited__">BaseMemCube</span>):
    <span class="hljs-string">"""记忆立方体（MemCube）是一个用于加载和存储三种类型记忆的容器。
    支持的记忆类型：文本记忆（text_mem）、激活记忆（act_mem）、参数化记忆（para_mem）
    """</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config: GeneralMemCubeConfig</span>):
        <span class="hljs-string">"""使用配置初始化记忆立方体。

        参数:
            config: 通用记忆立方体配置实例（GeneralMemCubeConfig），包含三种记忆的后端配置等信息
        """</span>
        self.config = config  <span class="hljs-comment"># 保存配置实例</span>
        time_start = time.time()  <span class="hljs-comment"># 记录文本记忆初始化开始时间</span>

        <span class="hljs-comment"># 初始化文本记忆：若配置中后端不是"未初始化"状态，则通过工厂类创建实例</span>
        self._text_mem: BaseTextMemory | <span class="hljs-literal">None</span> = (
            MemoryFactory.from_config(config.text_mem)
            <span class="hljs-keyword">if</span> config.text_mem.backend != <span class="hljs-string">"uninitialized"</span>
            <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
        )

        <span class="hljs-comment"># 初始化激活记忆：逻辑同文本记忆</span>
        self._act_mem: BaseActMemory | <span class="hljs-literal">None</span> = (
            MemoryFactory.from_config(config.act_mem)
            <span class="hljs-keyword">if</span> config.act_mem.backend != <span class="hljs-string">"uninitialized"</span>
            <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
        )

        <span class="hljs-comment"># 初始化参数化记忆：逻辑同文本记忆</span>
        self._para_mem: BaseParaMemory | <span class="hljs-literal">None</span> = (
            MemoryFactory.from_config(config.para_mem)
            <span class="hljs-keyword">if</span> config.para_mem.backend != <span class="hljs-string">"uninitialized"</span>
            <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
        )

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load</span>(<span class="hljs-params">
        self, <span class="hljs-built_in">dir</span>: <span class="hljs-built_in">str</span>, memory_types: <span class="hljs-built_in">list</span>[<span class="hljs-type">Literal</span>[<span class="hljs-string">"text_mem"</span>, <span class="hljs-string">"act_mem"</span>, <span class="hljs-string">"para_mem"</span>]] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>
    </span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""从指定目录加载记忆数据。

        参数:
            dir: 存储记忆文件的目录路径
            memory_types: 要加载的记忆类型列表（可选）。若为None，加载所有可用的记忆类型。
                          可选值：["text_mem", "act_mem", "para_mem"]
        """</span>
        <span class="hljs-comment"># 读取目录中的配置文件schema，用于校验配置一致性</span>
        loaded_schema = get_json_file_model_schema(os.path.join(<span class="hljs-built_in">dir</span>, self.config.config_filename))
        <span class="hljs-comment"># 校验加载的配置schema是否与当前实例的配置schema一致，不一致则抛出配置错误</span>
        <span class="hljs-keyword">if</span> loaded_schema != self.config.model_schema:
            <span class="hljs-keyword">raise</span> ConfigurationError(
                <span class="hljs-string">f"Configuration schema mismatch. Expected <span class="hljs-subst">{self.config.model_schema}</span>, "</span>
                <span class="hljs-string">f"but found <span class="hljs-subst">{loaded_schema}</span>."</span>
            )

        <span class="hljs-comment"># 若未指定记忆类型，默认加载所有三种类型</span>
        <span class="hljs-keyword">if</span> memory_types <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            memory_types = [<span class="hljs-string">"text_mem"</span>, <span class="hljs-string">"act_mem"</span>, <span class="hljs-string">"para_mem"</span>]

        <span class="hljs-comment"># 加载指定类型的记忆（仅加载已初始化的记忆实例）</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"text_mem"</span> <span class="hljs-keyword">in</span> memory_types <span class="hljs-keyword">and</span> self.text_mem:
            self.text_mem.load(<span class="hljs-built_in">dir</span>)  <span class="hljs-comment"># 调用文本记忆的load方法加载数据</span>

        <span class="hljs-keyword">if</span> <span class="hljs-string">"act_mem"</span> <span class="hljs-keyword">in</span> memory_types <span class="hljs-keyword">and</span> self.act_mem:
            self.act_mem.load(<span class="hljs-built_in">dir</span>)  <span class="hljs-comment"># 调用激活记忆的load方法加载数据</span>

        <span class="hljs-keyword">if</span> <span class="hljs-string">"para_mem"</span> <span class="hljs-keyword">in</span> memory_types <span class="hljs-keyword">and</span> self.para_mem:
            self.para_mem.load(<span class="hljs-built_in">dir</span>)  <span class="hljs-comment"># 调用参数化记忆的load方法加载数据</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">dump</span>(<span class="hljs-params">
        self, <span class="hljs-built_in">dir</span>: <span class="hljs-built_in">str</span>, memory_types: <span class="hljs-built_in">list</span>[<span class="hljs-type">Literal</span>[<span class="hljs-string">"text_mem"</span>, <span class="hljs-string">"act_mem"</span>, <span class="hljs-string">"para_mem"</span>]] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>
    </span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""将记忆数据存储到指定目录。

        参数:
            dir: 保存记忆文件的目标目录路径
            memory_types: 要存储的记忆类型列表（可选）。若为None，存储所有可用的记忆类型。
                          可选值：["text_mem", "act_mem", "para_mem"]
        """</span>
        <span class="hljs-comment"># 校验目标目录是否存在且非空，非空目录则抛出异常（避免覆盖已有数据）</span>
        <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-built_in">dir</span>) <span class="hljs-keyword">and</span> os.listdir(<span class="hljs-built_in">dir</span>):
            <span class="hljs-keyword">raise</span> MemCubeError(
                <span class="hljs-string">f"Directory <span class="hljs-subst">{<span class="hljs-built_in">dir</span>}</span> is not empty. Please provide an empty directory for dumping."</span>
            )

        <span class="hljs-comment"># 始终先存储配置文件（确保配置与记忆数据同步）</span>
        self.config.to_json_file(os.path.join(<span class="hljs-built_in">dir</span>, self.config.config_filename))

        <span class="hljs-comment"># 若未指定记忆类型，默认存储所有三种类型</span>
        <span class="hljs-keyword">if</span> memory_types <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            memory_types = [<span class="hljs-string">"text_mem"</span>, <span class="hljs-string">"act_mem"</span>, <span class="hljs-string">"para_mem"</span>]

        <span class="hljs-comment"># 存储指定类型的记忆（仅存储已初始化的记忆实例）</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"text_mem"</span> <span class="hljs-keyword">in</span> memory_types <span class="hljs-keyword">and</span> self.text_mem:
            self.text_mem.dump(<span class="hljs-built_in">dir</span>)  <span class="hljs-comment"># 调用文本记忆的dump方法存储数据</span>

        <span class="hljs-keyword">if</span> <span class="hljs-string">"act_mem"</span> <span class="hljs-keyword">in</span> memory_types <span class="hljs-keyword">and</span> self.act_mem:
            self.act_mem.dump(<span class="hljs-built_in">dir</span>)  <span class="hljs-comment"># 调用激活记忆的dump方法存储数据</span>

        <span class="hljs-keyword">if</span> <span class="hljs-string">"para_mem"</span> <span class="hljs-keyword">in</span> memory_types <span class="hljs-keyword">and</span> self.para_mem:
            self.para_mem.dump(<span class="hljs-built_in">dir</span>)  <span class="hljs-comment"># 调用参数化记忆的dump方法存储数据</span>

    @<span class="hljs-built_in">staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">init_from_dir</span>(<span class="hljs-params">
        <span class="hljs-built_in">dir</span>: <span class="hljs-built_in">str</span>,
        memory_types: <span class="hljs-built_in">list</span>[<span class="hljs-type">Literal</span>[<span class="hljs-string">"text_mem"</span>, <span class="hljs-string">"act_mem"</span>, <span class="hljs-string">"para_mem"</span>]] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
        default_config: GeneralMemCubeConfig | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
    </span>) -&gt; <span class="hljs-string">"GeneralMemCube"</span>:
        <span class="hljs-string">"""从本地目录创建并初始化记忆立方体实例。

        参数:
            dir: 存储记忆文件和配置文件的本地目录路径
            memory_types: 要加载的记忆类型列表（可选）。若为None，加载所有可用类型。
            default_config: 用于合并的默认配置（可选）。若提供，会合并通用设置，
                          同时保留用户特定的关键配置字段。

        返回:
            GeneralMemCube: 已加载指定目录记忆数据的记忆立方体实例
        """</span>
        <span class="hljs-comment"># 构建配置文件路径（默认配置文件名为config.json）</span>
        config_path = os.path.join(<span class="hljs-built_in">dir</span>, <span class="hljs-string">"config.json"</span>)
        <span class="hljs-comment"># 从JSON文件加载配置实例</span>
        config = GeneralMemCubeConfig.from_json_file(config_path)

        <span class="hljs-comment"># 若提供了默认配置，将其与加载的配置合并</span>
        <span class="hljs-keyword">if</span> default_config <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            config = merge_config_with_default(config, default_config)

        <span class="hljs-comment"># 创建记忆立方体实例并加载指定目录的记忆数据</span>
        mem_cube = GeneralMemCube(config)
        mem_cube.load(<span class="hljs-built_in">dir</span>, memory_types)
        <span class="hljs-keyword">return</span> mem_cube

    @<span class="hljs-built_in">staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">init_from_remote_repo</span>(<span class="hljs-params">
        cube_id: <span class="hljs-built_in">str</span>,
        base_url: <span class="hljs-built_in">str</span> = <span class="hljs-string">"https://huggingface.co/datasets"</span>,
        memory_types: <span class="hljs-built_in">list</span>[<span class="hljs-type">Literal</span>[<span class="hljs-string">"text_mem"</span>, <span class="hljs-string">"act_mem"</span>, <span class="hljs-string">"para_mem"</span>]] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
        default_config: GeneralMemCubeConfig | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
    </span>) -&gt; <span class="hljs-string">"GeneralMemCube"</span>:
        <span class="hljs-string">"""从远程仓库创建并初始化记忆立方体实例。

        参数:
            cube_id: 远程仓库名称（即记忆立方体ID）
            base_url: 远程仓库的基础URL（默认是Hugging Face数据集仓库）
            memory_types: 要加载的记忆类型列表（可选）。若为None，加载所有可用类型。
            default_config: 用于合并的默认配置（可选）。

        返回:
            GeneralMemCube: 已加载远程仓库记忆数据的记忆立方体实例
        """</span>
        <span class="hljs-comment"># 下载远程仓库到本地目录</span>
        <span class="hljs-built_in">dir</span> = download_repo(cube_id, base_url)
        <span class="hljs-comment"># 调用本地目录初始化方法，创建并返回记忆立方体实例</span>
        <span class="hljs-keyword">return</span> GeneralMemCube.init_from_dir(<span class="hljs-built_in">dir</span>, memory_types, default_config)

    @<span class="hljs-built_in">property</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">text_mem</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-string">"BaseTextMemory | None"</span>:
        <span class="hljs-string">"""获取文本记忆实例（属性访问器）。"""</span>
        <span class="hljs-keyword">if</span> self._text_mem <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            logger.warning(<span class="hljs-string">"Textual memory is not initialized. Returning None."</span>)
        <span class="hljs-keyword">return</span> self._text_mem

    @text_mem.setter
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">text_mem</span>(<span class="hljs-params">self, value: BaseTextMemory</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""设置文本记忆实例（属性修改器）。

        参数:
            value: 要设置的文本记忆实例，必须是BaseTextMemory的子类实例
        """</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(value, BaseTextMemory):
            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">f"Expected BaseTextMemory, got <span class="hljs-subst">{<span class="hljs-built_in">type</span>(value).__name__}</span>"</span>)
        self._text_mem = value

    @<span class="hljs-built_in">property</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">act_mem</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-string">"BaseActMemory | None"</span>:
        <span class="hljs-string">"""获取激活记忆实例（属性访问器）。"""</span>
        <span class="hljs-keyword">if</span> self._act_mem <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            logger.warning(<span class="hljs-string">"Activation memory is not initialized. Returning None."</span>)
        <span class="hljs-keyword">return</span> self._act_mem

    @act_mem.setter
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">act_mem</span>(<span class="hljs-params">self, value: BaseActMemory</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""设置激活记忆实例（属性修改器）。

        参数:
            value: 要设置的激活记忆实例，必须是BaseActMemory的子类实例
        """</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(value, BaseActMemory):
            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">f"Expected BaseActMemory, got <span class="hljs-subst">{<span class="hljs-built_in">type</span>(value).__name__}</span>"</span>)
        self._act_mem = value

    @<span class="hljs-built_in">property</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">para_mem</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-string">"BaseParaMemory | None"</span>:
        <span class="hljs-string">"""获取参数化记忆实例（属性访问器）。"""</span>
        <span class="hljs-keyword">if</span> self._para_mem <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            logger.warning(<span class="hljs-string">"Parametric memory is not initialized. Returning None."</span>)
        <span class="hljs-keyword">return</span> self._para_mem

    @para_mem.setter
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">para_mem</span>(<span class="hljs-params">self, value: BaseParaMemory</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""设置参数化记忆实例（属性修改器）。

        参数:
            value: 要设置的参数化记忆实例，必须是BaseParaMemory的子类实例
        """</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(value, BaseParaMemory):
            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">f"Expected BaseParaMemory, got <span class="hljs-subst">{<span class="hljs-built_in">type</span>(value).__name__}</span>"</span>)
        self._para_mem = value
</code></pre>
<h4 data-id="heading-36">3.5 实例</h4>
<p>官方代码给出了使用实例如下:</p>
<h5 data-id="heading-37">🕰️ 创意1：智能世界时间线系统</h5>
<p>基于MemOS构建动态的武侠世界时间轴，让AI理解事件的因果关系：</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># 示例：智能时间线管理</span>
timeline_memory = {
    <span class="hljs-string">"1094年"</span>: {
        <span class="hljs-string">"events"</span>: [<span class="hljs-string">"萧峰身世之谜揭开"</span>, <span class="hljs-string">"聚贤庄大战"</span>],
        <span class="hljs-string">"consequences"</span>: [<span class="hljs-string">"江湖震动"</span>, <span class="hljs-string">"丐帮分裂"</span>],
        <span class="hljs-string">"affected_characters"</span>: [<span class="hljs-string">"萧峰"</span>, <span class="hljs-string">"阿朱"</span>, <span class="hljs-string">"段正淳"</span>]
    },
    <span class="hljs-string">"1095年"</span>: {
        <span class="hljs-string">"events"</span>: [<span class="hljs-string">"雁门关事件真相"</span>, <span class="hljs-string">"阿朱之死"</span>],
        <span class="hljs-string">"consequences"</span>: [<span class="hljs-string">"萧峰心境转变"</span>, <span class="hljs-string">"宋辽关系紧张"</span>]
    }
}

<span class="hljs-comment"># AI可以回答：如果萧峰没有去雁门关，后续会如何发展？</span>
</code></pre>
<h5 data-id="heading-38">🧠 创意2：动态Working Memory世界背景</h5>
<p>利用MemCube的working memory功能，让世界背景随着剧情发展实时更新：</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 示例：动态世界状态管理</span>
from memos.memories.textual.base import TextualMemoryItem

<span class="hljs-comment"># 创建世界状态记忆项</span>
<span class="hljs-attr">world_state_memories</span> = [
    TextualMemoryItem(
        memory=<span class="hljs-string">"宋辽政治紧张程度达到0.8级别，边境冲突频发"</span>,
        metadata={<span class="hljs-string">"type"</span>: <span class="hljs-string">"world_state"</span>, <span class="hljs-string">"category"</span>: <span class="hljs-string">"politics"</span>}
    ),
    TextualMemoryItem(
        memory=<span class="hljs-string">"当前江湖流传的绝世武功：九阳神功、易筋经"</span>,
        metadata={<span class="hljs-string">"type"</span>: <span class="hljs-string">"world_state"</span>, <span class="hljs-string">"category"</span>: <span class="hljs-string">"martial_arts"</span>}
    ),
    TextualMemoryItem(
        memory=<span class="hljs-string">"少林与武当保持中立，丐帮内部出现分裂"</span>,
        metadata={<span class="hljs-string">"type"</span>: <span class="hljs-string">"world_state"</span>, <span class="hljs-string">"category"</span>: <span class="hljs-string">"sect_relations"</span>}
    )
]

<span class="hljs-comment"># 使用MemCube的文本记忆管理世界状态</span>
mem_cube.text_mem.replace_working_memory(world_state_memories)

<span class="hljs-comment"># 当萧峰做出重要决定时，自动更新工作记忆</span>
<span class="hljs-attr">current_working_memory</span> = mem_cube.text_mem.get_working_memory()
</code></pre>
<h4 data-id="heading-39">0x04 记忆生产流程</h4>
<p>当一条消息进入系统时，它是如何被加工成记忆，并在未来对话中被有效使用的？</p>
<p>MemOS 的记忆机制可以理解为一条完整的「工作流」：</p>
<p>你提交原始消息 → 对记忆进行加工生产 → 调度机制根据任务和上下文安排调用与存储，并可动态调整记忆形态 → 在需要时被召回相关记忆注入为上下文或指令 → 同时由生命周期管理维持演化与更新。</p>
<p>即：记忆生产 → 记忆调度 → 记忆召回与指令补全 → 记忆生命周期管理</p>
<p>比如：构建一个基于《天龙八部》小说的智能记忆分析系统，实现从原始文本到结构化记忆的完整转换流程。数据处理流水线如下：</p>
<ul>
<li>文本预处理 → 章节切分 → 结构化输入</li>
<li>AI驱动抽取 → 人物建模 → MemCube生成</li>
<li>格式转换 → 图结构构建 → MemOS记忆库</li>
</ul>
<h3 data-id="heading-40">0x05 常见问题</h3>
<h4 data-id="heading-41">Q：MemOS 和普通 RAG 框架有什么区别？</h4>



































<table><thead><tr><th><strong>对比维度</strong></th><th><strong>RAG</strong></th><th><strong>MemOS</strong></th><th><strong>MemOS 的优势</strong></th></tr></thead><tbody><tr><td>精准度</td><td>语料越多，噪声越大</td><td>通过生产阶段的抽取、图式化/关系建模，再配合调度与生命周期管理，形成结构化组织，记忆条理更清晰  能够基于用户反馈驱动自我进化</td><td><strong>更准</strong>：减少噪声，降低幻觉</td></tr><tr><td>结果组织</td><td>直接拿原文段落，内容冗余</td><td>将原始信息加工为记忆，提炼成事实/偏好等单元，内容更短、更纯粹</td><td><strong>更省</strong>：同等信息量下更少 token</td></tr><tr><td>搜索范围</td><td>每次都在全量语料里搜，语料越大越慢</td><td>记忆动态更新，分层管理，逐层召回</td><td><strong>更快</strong>：避免全局扫描，小范围命中</td></tr><tr><td>理解力</td><td>不能从用户历史对话中沉淀偏好（无个性化），仅依赖静态知识库的相似度匹配</td><td>会自动提取记忆做偏好建模，并在召回时转化为可执行的指令，让模型真正理解到位。</td><td><strong>更懂</strong>：回答更贴近真实需求</td></tr></tbody></table>
<h4 data-id="heading-42">Q：MemOS 可以和已有 RAG 或知识图谱结合吗？</h4>
<p>可以结合。</p>
<ul>
<li>RAG 专注于 <strong>事实检索与知识增强</strong>，让模型“知道世界上有什么”；</li>
<li>MemOS 专注于 <strong>状态管理与连续记忆</strong>，让模型“知道你是谁、你想要什么”。</li>
</ul>
<p>两者结合后能形成互补的智能结构：</p>
<blockquote>
<p>🧠 <strong>RAG 提供外部知识，MemOS 提供内在记忆。</strong><br/>
前者让模型更聪明，后者让模型更懂你。</p>
</blockquote>
<p>在实践中，<strong>MemOS 的记忆单元</strong> 可以与 <strong>RAG 的向量召回层</strong> 直接对接，也能调用外部知识图谱。<br/>
区别在于——RAG 管理的是 <strong>静态事实</strong>，而 MemOS 管理的是 <strong>随时间演化的动态记忆</strong>。</p>
<p>换句话说：</p>
<ul>
<li><strong>RAG</strong> 让模型更像百科全书；</li>
<li><strong>MemOS</strong> 让模型更像你长期相处的助手。</li>
</ul>
<p>当两者融合时，AI 就既能“知道世界”，也能“理解你”。</p>
<h3 data-id="heading-43">0xFF 参考</h3>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">MemOS：一个为AI系统设计的记忆操作系统</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Ftangtommy930" target="_blank" title="https://www.zhihu.com/people/tangtommy930" ref="nofollow noopener noreferrer">唐国梁Tommy</a></p>
<p>本文使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarkdown.com.cn" target="_blank" title="https://markdown.com.cn" ref="nofollow noopener noreferrer">markdown.com.cn</a> 排版</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[解决 Monorepo 项目中 node-sass 安装失败的 Python 版本兼容性问题]]></title>    <link>https://juejin.cn/post/7574251313883725839</link>    <guid>https://juejin.cn/post/7574251313883725839</guid>    <pubDate>2025-11-19T12:38:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574251313883725839" data-draft-id="7574244766424137737" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="解决 Monorepo 项目中 node-sass 安装失败的 Python 版本兼容性问题"/> <meta itemprop="keywords" content="前端,Debug"/> <meta itemprop="datePublished" content="2025-11-19T12:38:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="eason_fan"/> <meta itemprop="url" content="https://juejin.cn/user/2995517308808877"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            解决 Monorepo 项目中 node-sass 安装失败的 Python 版本兼容性问题
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2995517308808877/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    eason_fan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T12:38:57.000Z" title="Wed Nov 19 2025 12:38:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">解决 Monorepo 项目中 node-sass 安装失败的 Python 版本兼容性问题</h2>
<h3 data-id="heading-1">问题背景</h3>
<p>在最近的一个 <strong>Monorepo 项目</strong>（具体是 <code>a-mono</code> 中的 <code>table-list</code> 子项目）中，我遇到了一个令人头疼的依赖安装问题。项目在使用 <code>eden-mono</code> 工具安装依赖时卡在 <code>node-sass</code> 的构建阶段，导致整个开发流程受阻。</p>
<h3 data-id="heading-2">项目环境</h3>
<ul>
<li><strong>项目类型</strong>：Monorepo（使用 eden-mono 管理）</li>
<li><strong>构建工具</strong>：eden-mono</li>
<li><strong>依赖管理</strong>：pnpm</li>
</ul>
<h3 data-id="heading-3">错误现象</h3>
<p>在项目根目录执行 <code>eden-mono install --filter=table-list</code> 时，安装过程在 <code>node-sass@6.0.1</code> 的 postinstall 脚本处失败，报错信息如下：</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">ValueError:</span> invalid mode: <span class="hljs-comment">'rU' while trying to load binding.gyp</span>
gyp ERR! configure <span class="hljs-keyword">error</span>
gyp ERR! stack <span class="hljs-keyword">Error</span>: `gyp` failed <span class="hljs-keyword">with</span> <span class="hljs-keyword">exit</span> code: <span class="hljs-number">1</span>
</code></pre>
<h3 data-id="heading-4">问题分析</h3>
<h4 data-id="heading-5">根本原因</h4>
<p>经过深入分析，发现问题出在 <strong>Python 版本兼容性</strong> 上：</p>
<ol>
<li><strong>node-gyp 版本过旧</strong>：项目使用的是 <code>node-gyp@7.1.2</code>，这个版本发布于 2020 年</li>
<li><strong>Python 版本过高</strong>：系统安装了 Python 3.11.13，而旧的 node-gyp 不支持</li>
<li><strong>语法不兼容</strong>：<code>'rU'</code> 模式是 Python 2 的语法，在 Python 3 中已被移除</li>
</ol>
<h4 data-id="heading-6">技术细节</h4>
<p><code>node-gyp</code> 在构建过程中会调用 Python 脚本来生成构建配置，其中使用了 <code>open(build_file_path, "rU")</code> 这样的语法。Python 3.11 不再支持 <code>'rU'</code> 模式，导致构建失败。</p>
<h3 data-id="heading-7">尝试过的解决方案</h3>
<h4 data-id="heading-8">方案一：升级 node-gyp</h4>
<pre><code class="hljs language-bash" lang="bash">npm install -g node-gyp@latest
</code></pre>
<p><strong>结果</strong>：失败，因为 monorepo 项目中的 node-sass 版本锁定了 node-gyp 版本，升级全局包无法影响项目内部依赖</p>
<h4 data-id="heading-9">方案二：配置 Python 路径</h4>
<pre><code class="hljs language-bash" lang="bash">npm config <span class="hljs-built_in">set</span> python /path/to/python3.10
</code></pre>
<p><strong>结果</strong>：失败，npm 配置语法在较新版本中发生了变化，而且 monorepo 项目的依赖管理更加复杂</p>
<h4 data-id="heading-10">方案三：降级 Node.js 版本</h4>
<pre><code class="hljs language-bash" lang="bash">nvm use 16.20.2
</code></pre>
<p><strong>结果</strong>：部分成功，但仍然遇到 Python 兼容性问题，因为 node-gyp 仍然调用不兼容的 Python 版本</p>
<h4 data-id="heading-11">方案四：替换 node-sass 为 sass</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 在 monorepo 中尝试替换</span>
npm uninstall node-sass
npm install sass
</code></pre>
<p><strong>结果</strong>：理论上可行，但 monorepo 项目中存在复杂的间接依赖关系，无法完全替换 node-sass</p>
<h3 data-id="heading-12">最终解决方案：暴力卸载重装</h3>
<p>在尝试了所有常规方法后，我决定采用最粗暴但有效的方法：<strong>完全卸载所有 Python 版本，只保留通过 pyenv 管理的 Python 3.10.19</strong>。</p>
<h4 data-id="heading-13">执行步骤</h4>
<ol>
<li><strong>查看当前 Python 版本</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">pyenv versions
<span class="hljs-built_in">which</span> -a python3 python3.10 python3.11
</code></pre>
<ol start="2">
<li><strong>卸载 Python 3.11</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">pyenv uninstall 3.11.9
brew uninstall python@3.11
</code></pre>
<ol start="3">
<li><strong>卸载通过 Homebrew 安装的 Python 3.10</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">brew uninstall python@3.10
</code></pre>
<ol start="4">
<li><strong>清理 monorepo 缓存和依赖</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> /Users/bytedance/Documents/work-space/ttam_core_mono/packages/campaign-list
<span class="hljs-built_in">rm</span> -rf node_modules
<span class="hljs-built_in">rm</span> -rf .pnpm-store
pnpm store prune
</code></pre>
<ol start="5">
<li><strong>重新安装依赖（使用 eden-mono）</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">nvm <span class="hljs-built_in">exec</span> 16.20.2 eden-mono install --filter=campaign-list
</code></pre>
<h4 data-id="heading-14">结果</h4>
<p><strong>成功！</strong> 安装过程顺利完成，node-sass 构建成功，monorepo 项目可以正常运行。</p>
<h3 data-id="heading-15">经验教训</h3>
<h4 data-id="heading-16">版本兼容性的重要性</h4>
<p>这次问题深刻说明了开发环境中版本兼容性的重要性：</p>
<ol>
<li><strong>Node.js 版本</strong>：不同版本的 Node.js 对依赖包的支持程度不同</li>
<li><strong>Python 版本</strong>：构建工具的 Python 支持存在版本限制</li>
<li><strong>依赖版本</strong>：间接依赖可能导致意想不到的兼容性问题</li>
</ol>
<h4 data-id="heading-17">最佳实践建议</h4>
<ol>
<li>
<p><strong>使用版本管理工具</strong>：</p>
<ul>
<li>Node.js：使用 nvm 管理版本，确保 <code>.nvmrc</code> 文件存在</li>
<li>Python：使用 pyenv 管理版本，确保 <code>.python-version</code> 文件存在</li>
</ul>
</li>
<li>
<p><strong>锁定环境版本</strong>：</p>
<ul>
<li>在 monorepo 根目录和子项目目录都放置版本锁定文件</li>
<li>明确指定项目所需的运行时版本</li>
<li>定期检查和更新这些版本锁定文件</li>
</ul>
</li>
<li>
<p><strong>定期更新依赖</strong>：</p>
<ul>
<li>避免使用过时的依赖包（如 node-sass）</li>
<li>及时升级到官方推荐的替代方案（如 sass）</li>
<li>在 monorepo 中使用批量更新工具</li>
</ul>
</li>
<li>
<p><strong>环境隔离</strong>：</p>
<ul>
<li>为不同项目使用不同的虚拟环境</li>
<li>避免全局安装可能产生冲突的工具</li>
<li>考虑使用容器化技术隔离复杂的构建环境</li>
</ul>
</li>
</ol>
<h3 data-id="heading-18">总结</h3>
<p>虽然通过暴力卸载重装解决了这个 monorepo 项目的问题，但这并不是最理想的方式。在理想情况下，我们应该：</p>
<ol>
<li>提前规划好 monorepo 项目的运行时环境，考虑各子项目的兼容性</li>
<li>使用容器化技术（如 Docker）来标准化复杂的 monorepo 环境</li>
<li>建立完善的 CI/CD 流程来检测环境兼容性问题</li>
<li>为 monorepo 项目建立专门的构建环境管理策略</li>
</ol>
<p>这次经历让我更加重视开发环境的标准化管理，特别是对于复杂的 monorepo 项目。希望这篇文章能帮助遇到类似问题的开发者少走弯路，特别是在处理 monorepo 项目中的环境兼容性问题时。</p>
<hr/>
<p><strong>参考链接</strong>：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnodejs%2Fnode-gyp" target="_blank" title="https://github.com/nodejs/node-gyp" ref="nofollow noopener noreferrer">node-gyp Python 兼容性文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsass-lang.com%2Fblog%2Flibsass-is-deprecated" target="_blank" title="https://sass-lang.com/blog/libsass-is-deprecated" ref="nofollow noopener noreferrer">node-sass 弃用说明</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpyenv%2Fpyenv" target="_blank" title="https://github.com/pyenv/pyenv" ref="nofollow noopener noreferrer">pyenv 官方文档</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[在AWS上订阅Kiro]]></title>    <link>https://juejin.cn/post/7574254039023435802</link>    <guid>https://juejin.cn/post/7574254039023435802</guid>    <pubDate>2025-11-19T11:15:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574254039023435802" data-draft-id="7574040813750255667" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="在AWS上订阅Kiro "/> <meta itemprop="keywords" content="AI编程,AWS"/> <meta itemprop="datePublished" content="2025-11-19T11:15:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="thinktik"/> <meta itemprop="url" content="https://juejin.cn/user/2928754704785447"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            在AWS上订阅Kiro 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2928754704785447/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    thinktik
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T11:15:07.000Z" title="Wed Nov 19 2025 11:15:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Kiro 的简单介绍</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fkiro.dev%2F" target="_blank" title="https://kiro.dev/" ref="nofollow noopener noreferrer">kiro</a>是AWS推出的AI IDE，与市场上其他"氛围编程"工具（如Cursor和Windsurf）的区别在于，它是最先提出了<a href="https://link.juejin.cn?target=https%3A%2F%2Fkiro.dev%2Fdocs%2Fspecs%2F" target="_blank" title="https://kiro.dev/docs/specs/" ref="nofollow noopener noreferrer">SPEC模式</a>的IDE，它会首先根据用户提示生成"规范"或规格说明。在这些规格说明中，Kiro会生成明确的需求、结构化设计和经过测试验证的实现任务，然后再开始工作。</p>
<p>AWS还推出了命令行界面功能<a href="https://link.juejin.cn?target=https%3A%2F%2Fkiro.dev%2Fcli%2F" target="_blank" title="https://kiro.dev/cli/" ref="nofollow noopener noreferrer">Kiro CLI</a>。这一新产品将Kiro带入终端，提供逐行、基于文本的方式与开发智能体交互。与依赖图标和菜单等视觉元素的图形用户界面不同，CLI需要按顺序输入命令并在窗口中接收文本输出。<a href="https://link.juejin.cn?target=https%3A%2F%2Fkiro.dev%2Fcli%2F" target="_blank" title="https://kiro.dev/cli/" ref="nofollow noopener noreferrer">Kiro CLI</a>和AWS现有的<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faws%2Famazon-q-developer-cli" target="_blank" title="https://github.com/aws/amazon-q-developer-cli" ref="nofollow noopener noreferrer">Q Cli</a>、<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgoogle-gemini%2Fgemini-cli" target="_blank" title="https://github.com/google-gemini/gemini-cli" ref="nofollow noopener noreferrer">Google gemini cli </a>的定位一样，都是基于先进的LLM进行基于命令行的交互，适用于运维，轻量级脚本开发等场景。</p>
<p>目前Kiro相比其他AI IDE的优势简单来讲有几点</p>
<ol>
<li>首创SPEC模式，更容易把文档化的需求变成具体的生产环境可用的项目代码</li>
<li>国内开发者友好，不需要翻墙就可以使用顶级的编程模型Claude，而且还是最新的Claude模型</li>
<li>价格相比其他IDE持平或者略便宜，比如它目前提供每月免费的额度，此外按照使用用量提供阶梯<a href="https://link.juejin.cn?target=https%3A%2F%2Fkiro.dev%2Fpricing%2F" target="_blank" title="https://kiro.dev/pricing/" ref="nofollow noopener noreferrer">定价</a></li>
</ol>
<h3 data-id="heading-1">在AWS上订阅Kiro付费版</h3>
<p>使用Kiro付费版有2个主要的渠道，第一个是在AWS上直接订阅，这种方式适合企业客户给员工订阅，第二种方式是开发者自己用邮箱注册帐户后用信用卡付款，这种方式适合独立开发者。本文主要介绍的是第一种方式</p>
<p>首先我们在AWS控制台输入kiro进行产品搜索
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c39bea844105435ebea733d1dff4daf9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=W0h0fflRD9lt894gtIJJmC6fGhI%3D" alt="kiro-01.png" loading="lazy"/></p>
<p>然后找到kiro产品页面，这里我们可以看到<code>settings</code>图标，这个地方可以让我们细节调整Kiro产品的全局设置。
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2505076ef41453e858e1e6831acd494~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=xz95YMfLUvavJXENXp33YIlUhp8%3D" alt="kiro-02.png" loading="lazy"/></p>
<p>我可以调整Kiro的全局产品级设置，比如打开MCP功能，开启token用量追踪，允许套餐用完后继续超额付费使用等。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc7cf73dd6064c2fa803b52d1a3b4032~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=%2Bzjr0%2FX54D4HpZSaKu%2FMjSW7kWc%3D" alt="kiro-03.png" loading="lazy"/></p>
<p>首次使用时，我们可以进入Kiro的<code>User&amp;Groups</code>添加用户。
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d23275d1a724415a6e137fbddbcf226~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=WcLeNJdTth%2B7%2B91fRdSbtdM2KNM%3D" alt="kiro-04.png" loading="lazy"/></p>
<p>添加用户这个地方，我们可以一个用户一个用户的单独添加，也可以选择直接添加一个用户组(组里面包含有多个用户)，这里我以添加用户组的方式进行介绍，当我们选择添加组的时候，我们可以选不同的订阅计划，这些计划是阶梯付费的，我们只需要按需订阅即可，后续我们也可以调整订阅套餐，具体价格可以看[定价]</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1af95634fbe4169880dd952e5f09715~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=M%2B%2Fjre4VAD1i9Z25ze5ts4IOxWk%3D" alt="kiro-05.png" loading="lazy"/></p>
<p>首次订阅时我们可能没有用户组，那么我们可以直接进入到AWS IAM Identity Center进行组的创建
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e4cb760eeeb459f916cadcde9e5ea49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=6WbYAFqC6VKsfT%2Bx3lVodIMmD3s%3D" alt="kiro-06.png" loading="lazy"/></p>
<p>在AWS IAM Identity Center创建组，我们可以直接给一个组名，用户后续可以自己添加
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c244638e9afb465d9ca5f7609e4ebe73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=K9wJrmYdv%2Bo5Lua6Dt4yYB9XiwU%3D" alt="kiro-07.png" loading="lazy"/></p>
<p>创建组成功后我们可以直接进行组级别的订阅
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb478cb074924e46ae184b56ef3f5652~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=0qf%2FHMvZO5yaH6OEkOub69EoSmk%3D" alt="kiro-08.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b5f666106374900ab8fefdd72125fd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=1l0wsTl1eOjXRISkDWpSLx2qJZc%3D" alt="kiro-09.png" loading="lazy"/></p>
<p>在AWS Kiro控制台我们可以继续添加组，选择我们刚才创建的用户组
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da2fdf50e53044cba968d13f9d5832c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=G4Qp1Neup8l4hpyFv0tMWs2tazY%3D" alt="kiro-10.png" loading="lazy"/></p>
<p>添加完成后我们可以看到订阅状态
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6ec1ffa455a4dcaa9bd672529c5ea97~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=74gVM34dOwRABgCQUM3BHd3Cdro%3D" alt="kiro-11.png" loading="lazy"/></p>
<p>前面我们创建的组没有用户，我们可以继续添加用户，你可以假设你是一个公司的leader或者管理员，现在你为开发组的程序员同事们开通Kiro订阅
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4762f20a6ca44a8afcc2c469cad4c04~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=rod97us6mDYuYwk5XFubs9oxH7o%3D" alt="kiro-12.png" loading="lazy"/></p>
<p>新用户添加我们可以直接输入可接收邮件的邮箱，其余的保持不变
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75f5d28850014ff785488e585d400284~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=RZre0pKhU2KvWF3s%2Bel0k2jaJ4c%3D" alt="kiro-13.png" loading="lazy"/></p>
<p>在过程中我们可以把用户加入到前面创建的组中。这一步添加用户到组的话，你也可以后续补充添加。
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c66eb37246314e7ebc299b27050f8e49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=gWs9A53ZFIVVJBixIJzu3MwUzd0%3D" alt="kiro-14.png" loading="lazy"/></p>
<p>然后你填入的邮箱里面就会收到激活确认邮件。<strong>用户需要通过这个邮件进行订阅的确认才能使用Kiro</strong>。
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/295c865b6ec14e8d85393cab317c64a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=hBQv6kZwCjb9KZvfYdV2tyYLSBw%3D" alt="kiro-15.png" loading="lazy"/></p>
<p>我们直接点击 <code>Accept Invitation</code>进行确认后，设置自己的密码和必要信息后，就可以使用了。</p>
<h3 data-id="heading-2">登录Kiro</h3>
<p>在Kiro上我们直接使用组织身份进行登录
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d511c268a347439aa22273c94d1bed6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=0NIVBmAWoNnzuIH3E8kQVHMgYHU%3D" alt="kiro-16.png" loading="lazy"/></p>
<p>这里需要补充<code>Sign in URL</code>,这个URL在激活邮件里面有，此外我们可以在AWS Kiro控制台上找到</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7b0ef93cac841748ec4be4eb7ea409b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGhpbmt0aWs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764155850&amp;x-signature=jtDjHGBeEj5SNeqCCsvWWy54UXc%3D" alt="kiro-17.png" loading="lazy"/></p>
<p>填入<code>Sign in URL</code>后用前面注册好的用户身份登录就行了</p>
<p>直接单独添加用户和添加用户组的区别：</p>
<ol>
<li>用组的方式管理大量的用户更加方便，除去管理的便利性外，其他任何地方没有区别</li>
<li>一般直接在用户级别进行订阅，订阅信息可以马上同步成功，用户可以直接登录使用。如果使用组级别进行订阅当前(2025/11/19)的情况来看有延迟，可能你需要等几十分钟到几小时不等才能正常登录使用。
<ol>
<li>如果进行组级别的订阅，一般建议提前一天进行用户集中注册，第二天使用。如果着急的话，也可以直接进行用户级别的订阅然后把用户手动加入到组中，这样马上可以使用。</li>
</ol>
</li>
</ol>
<h2 data-id="heading-3">参考</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fkiro.dev%2F" target="_blank" title="https://kiro.dev/" ref="nofollow noopener noreferrer">kiro.dev</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fkiro-community.github.io%2Fbook-of-kiro%2Ffeatures%2Fintro%2F" target="_blank" title="https://kiro-community.github.io/book-of-kiro/features/intro/" ref="nofollow noopener noreferrer">Kiro 中文社区</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1LpyEBxEm7%2F" target="_blank" title="https://www.bilibili.com/video/BV1LpyEBxEm7/" ref="nofollow noopener noreferrer">你下令，它搞定！Kiro“自动导航式开发”深度体验</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.aws.amazon.com%2Famazonq%2Flatest%2Fqdeveloper-ug%2Fupgrade-to-kiro.html" target="_blank" title="https://docs.aws.amazon.com/amazonq/latest/qdeveloper-ug/upgrade-to-kiro.html" ref="nofollow noopener noreferrer">Upgrade to Kiro</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.aws.amazon.com%2Fzh_cn%2Fsinglesignon%2Flatest%2Fuserguide%2Fenable-identity-center.html" target="_blank" title="https://docs.aws.amazon.com/zh_cn/singlesignon/latest/userguide/enable-identity-center.html" ref="nofollow noopener noreferrer">启用 IAM Identity Center</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.aws.amazon.com%2Fzh_cn%2Fsinglesignon%2Flatest%2Fuserguide%2Fidentities.html" target="_blank" title="https://docs.aws.amazon.com/zh_cn/singlesignon/latest/userguide/identities.html" ref="nofollow noopener noreferrer">在 IAM 身份中心设置员工</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[一个大龄程序员的地铁日记（第三期），沉迷《皇室战争》之前]]></title>    <link>https://juejin.cn/post/7574244766423908361</link>    <guid>https://juejin.cn/post/7574244766423908361</guid>    <pubDate>2025-11-19T11:29:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574244766423908361" data-draft-id="7574269207362387977" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="一个大龄程序员的地铁日记（第三期），沉迷《皇室战争》之前"/> <meta itemprop="keywords" content="程序员"/> <meta itemprop="datePublished" content="2025-11-19T11:29:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="我要改名叫嘟嘟"/> <meta itemprop="url" content="https://juejin.cn/user/1698109849624061"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            一个大龄程序员的地铁日记（第三期），沉迷《皇室战争》之前
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1698109849624061/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    我要改名叫嘟嘟
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T11:29:40.000Z" title="Wed Nov 19 2025 11:29:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读17分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>我不想放弃自己的地铁日记系列，于是将两三个月前的记录搬运至此，它们记于<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMjM5ODczOTMzMA%3D%3D%26mid%3D2247487161%26idx%3D1%26sn%3D97d19115b91dc5cb47e57f621e5cb537%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MjM5ODczOTMzMA==&amp;mid=2247487161&amp;idx=1&amp;sn=97d19115b91dc5cb47e57f621e5cb537&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">再次沉迷《皇室战争》</a>之前。</p>
<p>--</p>
<p>三年前，大白鹅在我的推荐下买过一双白鞋。</p>
<p>这鞋对他来说有些小，他懒得退，便将鞋子送了我。</p>
<p>那是一个周末，我在台球厅穿新鞋打台球，最后的输赢我忘记，但当时脚上新的白鞋给予我的感受，是舒适中带些自信：“我脚下这鞋，是新的，好白好白。”</p>
<p>这鞋我只这穿一次，便将它在深圳鞋架放一年。<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMjM5ODczOTMzMA%3D%3D%26mid%3D2247485548%26idx%3D1%26sn%3D8ee975931fa4d9f5326b4c9511a2b648%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MjM5ODczOTMzMA==&amp;mid=2247485548&amp;idx=1&amp;sn=8ee975931fa4d9f5326b4c9511a2b648&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">两年前</a>，它跟我回到重庆，我再将它放后备箱一年。我的想法是，在那些需要换鞋的场景，换上它。</p>
<p>白鞋被换过两次后进入我的日常轮换，不再只是备用。</p>
<p>今天是周一，久不下雨的重庆迎来一场中雨，我撑伞出行，脚下穿的，是大白鹅给我的白鞋，它已变成灰色。（我不喜欢洗鞋，是阿妮很嫌弃的习惯。但这白鞋，其实我已经洗过两次。）</p>
<p>我耳朵听的书是《今日简史》，正听到的内容是在《<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMjM5ODczOTMzMA%3D%3D%26mid%3D2247486458%26idx%3D1%26sn%3D5f6d0b5fbe7407980ab4eeda84d2511b%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MjM5ODczOTMzMA==&amp;mid=2247486458&amp;idx=1&amp;sn=5f6d0b5fbe7407980ab4eeda84d2511b&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">人类简史</a>》中已经听过的“故事的重要性”。作者说，诗人、画家、文学家对这世界的影响也是大的，他们的作品源远流长，是我们价值观中很重要的组成部分。</p>
<p>上班路上，新开一家包子店，门口稻穗还未拆除，我多出一丝惊喜——未来上班路上的早饭多出一种选择。</p>
<p>母亲说她曾经切过包子铺肉包的馅，叫我别在外面吃肉包。我听妈妈的话，只买半笼酸菜粉丝包和半笼香菇菜包。</p>
<p>我边走边吃，头顶是雨声、耳朵里是书声，路走一半，我将耳机取下，只专注脚下灰鞋，以及头顶雨声。</p>
<p>--</p>
<p>最近的读书，大概只能算是中规中矩。</p>
<p>今早很用心阅读的书是《爱的艺术》和《国史大纲》。</p>
<p>《爱的艺术》当中讲的内容，是父爱和母爱的差异。作者说父爱是有条件而母爱无条件的。作者在书中有提出四个很相近句子：</p>
<blockquote>
<p>我因被爱而爱。<br/>
我因爱而被爱。<br/>
我爱你，因为我需要你。<br/>
我需要你，因为我爱你。</p>
</blockquote>
<p>这四句话，大概是很有些差异的。我在第一遍阅读时所感受到的差异，在后面的几遍，全然得不出属于自己的理解。特别是后两句，因为爱而产生的需要，和因为需要而产生的爱，是不同的么？</p>
<p>肯定不同，但当我想要理解更多些的时候，脑子混沌一片。</p>
<p>--</p>
<p>还是应该写一写现在的状态。</p>
<p>如果说自己前面两个月感觉有些不错，那今天的感觉，是不错当中多出些迷茫。</p>
<p>首先，之后的工作内容还没定下来。大家都说从需求池当中选需求，但我还没看到需求池里的内容，工作也就似乎推不下去。对的，我这两天处于工作的空窗期，准确说不算空窗，只是没有很繁忙。</p>
<p>不忙的日子，我竟然有些不习惯。天啊，这是怎样的一种体验。</p>
<p>其次，依然是昨天说过的事情。带我吃饭的同事提了离职开始休假，然后我们的吃饭队伍在晚上便散了伙。</p>
<p>我啊，跟着另外的小组一起吃饭。你别说，三个人一起走路二十分钟，我们聊天的内容大体围绕着重庆的公司，原来重庆的公司好像就那么多。我在过去的五六年，真就已经把重庆公司几乎面了个遍。</p>
<p>晚上的散步聊天，是开心的。</p>
<p>早上做出了一个决定，本周的公众号更新将不再是《<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMjM5ODczOTMzMA%3D%3D%26mid%3D2247487160%26idx%3D1%26sn%3D0b46be43eab9b02943a9e471f31be86a%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MjM5ODczOTMzMA==&amp;mid=2247487160&amp;idx=1&amp;sn=0b46be43eab9b02943a9e471f31be86a&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">细说宋朝</a>》的读书笔记，因为《国史大纲》宋朝两部分，我本周看不完。今早阅读的内容，是《细说宋朝》里面的熙宁变法，即便昨天读书感觉难懂不投入，今天再读，发现依然是有用处的。</p>
<p>即，读书这件事，只要去读，就有效果。</p>
<p>我说自己喜欢心理学，大概是真的吧？或许我喜欢的，是严谨的心理学。</p>
<p>最近正听的书有《亲密关系》，我喜欢听《亲密关系》。</p>
<p>这两天听到的内容，关于搭讪，关于吸引力。</p>
<p>心理学家研究发现，如果要搭讪，请不要自作幽默，请直白简单的打招呼就好。直白简单，成功率会更好些，这是男生搭讪女生。</p>
<p>如果女人搭讪男人，只需要简单的一个“嗨”，或者任意的一句话，是都可以成功的。“男追女隔层山，女追男隔层纱”是我们的谚语，它在《亲密关系》中被再一次验证。</p>
<p>吸引力是一个很有意思话题，一般情况下，外表绝对是第一吸引力。长得好看的，就是会收获更多的好感。</p>
<p>外表，是有匹配度的。即帅哥和美女，确确实实更匹配。当然也有意外情况，意外情况的章节，我正开始听。</p>
<p>《亲密关系》，可真是一本好听的书。我现在内心很想很想继续听《亲密关系》，我对书中的基于研究、统计的结论，很是好奇。</p>
<p>我现在在长江上面，长江两岸的风景很好看。</p>
<p>--</p>
<p>我在周三，就已经盼着周五到来。我在周五下午三点，已经在跟同桌说距离下班还剩两小时三十七分钟。</p>
<p>这种盼着周五盼着下班时间快快到来的感受，我已经两年多没体验过。</p>
<p>公司旁边不远，在另一个园区，有一个篮球场，是我某天吃过饭在公司周围闲逛，逛出来的。这篮球场免费，每天下午七点左右人很多。</p>
<p>我曾经想过，周三傍晚不吃晚饭来运动一小时再回公司。这想法被自己否决，湿湿的自己，坐在工位臭臭的，不合适。</p>
<p>我新的想法，您肯定可以猜到：“既然周五可以六点下班，那就周五下班后打完球再回家？”</p>
<p>念头即生，念念生。</p>
<p>我今天的盼头，是下班，是下班后在公司旁边球场打篮球。我的盼望不落空。</p>
<p>六点十分，球场只有二三四五六七个人。我在纠结一会儿后想到：“对啊，现在时间还早着嘛。”</p>
<p>我的推断再次正确。</p>
<p>今晚自己，队伍组的不错，我的队伍常赢。到最后投出手感，被评价为“真有”。</p>
<p>重庆八点半的室外，已经真有秋天感受。风大大的，湿透的衣服贴在身上，迎风竟然有些冷。脱掉衣服等汗干，是舒爽感受。</p>
<p>我的晚饭是一碗抄手，在抄手店打工的一位阿姨，气质很像母亲，那是农村妇女在城里的典型气质：眼里好奇并不消失，友好又带些对城市的陌生，尽责且想着家。</p>
<p>我将湿透的衣服提在手上，黏黏的很不舒服，我想回工位拿一个袋子又想快点回家。两难之时，我找一位老板——地铁口有很多很多做买卖的老板——要一个胶袋，胶袋装衣服，刚刚好。</p>
<p>我想自己，有些想念母亲。</p>
<p>--</p>
<p>现在时间是晚上的9点32分，今天准时下班，和两个小朋友一起。是的，我以为刚毕业的大学生即便拥有研究生学历，也还算是小朋友。</p>
<p>为什么会有这样的想法呢？</p>
<p>我感觉自己好像能够一眼看见他们的单纯。他们，就像十几年前的自己一样。</p>
<p>我不应该直接跳过这种阐述说自己说不清楚这种单纯的具体表现，我应该试着努力一下，去作些记录。</p>
<p>首先是眼神，当我和他们有了目光接触，我能从他们眼睛当中看见简单、纯净，还带些好奇，对我生活的好奇。</p>
<p>然后是走路姿态，这一点我真不确定是否是自己的错觉，我总感觉他们走路的姿态很是放松。这种放松，显然来自于一种无忧无虑。</p>
<p>嗯……</p>
<p>好累啦，想不出来。</p>
<p>今天的晚餐，是一碗巫溪粉皮，这是我前天晚上发现的。</p>
<p>周一那天，我开会不能和大家一起吃饭，于是便就近找一家面馆吃抄手，抄手下锅那瞬间，我发现老板的菜单上面有粉皮。</p>
<p>当时自己的状态，是极好的，我勇敢询问老板是否是巫溪的。</p>
<p>老板真是巫溪的，我们简单的聊天，老板告诉我他们为这粉皮子，选了好些粉终于做成器。</p>
<p>老板送我一个煎蛋。</p>
<p>昨天和大家一起吃饭，不到这家。今晚继续开会，我吃到粉皮子。</p>
<p>啊哈啊哈，真好吃呀。</p>
<p>--</p>
<p>现在时间是晚上的9点24分，地铁已经坐了一半，正阅读《开始冥想》的我决定先不读书，且先记下今天的日记。</p>
<p>当下这一刻，我内心是更想看书而不是写东西的。我想内里的原因很简单，我认为写东西比看书累一些。</p>
<p>写东西，我需要少量的动动脑子，再轻微地动动手指。而看书呢？现在这时间，除非看那些很需要思考的书，其它内容都将只是雾里看花，水中望月，我看过但什么都不能记住。</p>
<p>昨天的睡后收入，已经降低到近半年来最低只剩两块钱。原因大概也是简单的，最近很长一段时间，我在问一问的输出，只是不走心的照片分享。</p>
<p>（啊，面前站着两个非主流小伙，手上都拿着带冰饮料，其中一个将不知是嘴里漏出来的还是外面水汽汇成的一滴水滴到我的腿上，他不道歉，我有感受到被冒犯。）</p>
<p>自媒体这个事情，不走心就没流量，是真的。就像亲密关系一样，不走心就不能亲密一样。</p>
<p>由此，我改变了自己的地铁作息。早上走路时间，我依然听书，但早上的地铁时间，我会将其中很长一部分用来作听书总结与复述，将听到的内容作一次走心的搬运与分享。</p>
<p>我对自己这样说：“读书这件事，虽然时长攒的很长很好看，但是读慢一点，应该也会有更多不一样的收获，请不止看时长，也看阅读质量。”</p>
<p>最近两天的工作，有一点轻松，就不停地找人找人找人找人就好。发现敲代码间隙，找一找人帮忙配环境，也是一件不错事情。</p>
<p>要不要将两年前在深圳读完一半的，那本由谷歌许多sre工程师写就的运维书籍看完呢？</p>
<p>地铁已经快到终点，我内心现在竟然生出些快活。</p>
<p>希望，可真是幸福的源泉。</p>
<p>我现在的希望，是出地铁口给阿妮打电话，是回家快快洗漱完毕后以一种很放松心态看短视频或是看书。</p>
<p>总之，现在到睡觉之前的时间，完全属于我自己，真好。这真好的前提，来自于工作中的快乐。</p>
<p>我想自己啊，很睿智。大概一年前的一篇读书笔记标题是：“<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMjM5ODczOTMzMA%3D%3D%26mid%3D2247486275%26idx%3D1%26sn%3Db9f3fc63413a4ffffb467f60c82ed769%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MjM5ODczOTMzMA==&amp;mid=2247486275&amp;idx=1&amp;sn=b9f3fc63413a4ffffb467f60c82ed769&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">《真实的幸福》，找一份可以将之转换为事业的工作。</a>”</p>
<p>--</p>
<p>昨晚我是很想很想写一篇日记的。</p>
<p>晚上发版，发版需要验证，我便只能打车回家。坐网约车副驾的我，从不玩手机，偶尔和司机师傅聊聊天，眼睛一直看着窗外。</p>
<p>窗外的风景我已经记得许多：龙湖医院出某个隧道后可以看到，它慢慢变得清晰；有一条路走左边是桥上，走右边是桥下，目的地一样，我对这分叉很有些好奇，它就是路上又修了一条路；铜元局的大圆环，又到牛角沱地铁站……</p>
<p>昨天上午，周二让我有些郁闷的发版在周四上午成功搞定，整个中午，我都超级超级开心，我感觉自己好放松好放松。</p>
<p>过去好几周的中午，每次吃完饭，我都会给阿妮电话，不管阿妮在浙江还是重庆，就很神奇的，我就想要和阿妮说上两句话，不管是感到压力、快乐或是紧张。</p>
<p>我前两天在《亲密关系》中看到，文字沟通与声音沟通是有差异的，当我们听到伴侣的声音，便能够让我们紧绷的神经放松下来。</p>
<p>下午，公司举办了三季度员工的生日会，我和同桌积极参加。同桌投壶很强，以认真姿态三投两中；我呢？通过身体前倾三投三中，我拿到一个杯子。</p>
<p>每天，如果勤快些，可以在公司的零食铺拿到零食、饮料或者可以泡的“冲剂”（我忽然不知道这个名词应该是怎样的），我现在已经攒下来两包麦片一包芝麻糊。</p>
<p>我曾经用纸杯喝过一次芝麻糊，芝麻糊是好喝的，但纸杯是不方便的。</p>
<p>今天，我从家里带一把小勺子到公司。 今天，我用昨天收获的水杯泡一杯茶。 </p>
<p>我想此处大概是有些心理学依据的，即不管怎样的行动，如果稍微将门槛提高一些，它被执行的概率便会降低许多。喝茶如是，我有一个保温杯，杯子不适合泡茶，我便泡茶很少。</p>
<p>昨天，晚上吃饭时开会，开会到又一次独自吃饭。我的独自吃饭选择，当然是去吃我那巫溪老乡自制的粉皮。</p>
<p>大约是周二，我向同桌提议晚餐吃粉皮，他们三人便真的跟着我去吃粉皮。</p>
<p>昨天，当我再次吃粉皮时，发现他们三位也在。这是一个小小的惊喜，自己的推荐被接受，是很快乐的一件事。</p>
<p>晚上发版，一切顺利。</p>
<p>--</p>
<p>现在时间是晚上的9点31分，不，已经到了32分，我已坐了一站地铁。</p>
<p>前面的一分多钟，我本打算将今天的单词快快背完，完成复习再学习新单词时，两个单词一直错让我产生些许焦躁情绪，我以为地铁上太吵，于是来写日记。</p>
<p>27天前，我将背单词APP从《百词斩》切换成《不背单词》，切换的原因有些简单，《百词斩》每次出新单词时都会先“叮”很大一声，它的设置不能关闭，咨询客服客服也说不行，我便真的让《百词斩》成了历史。</p>
<p>时间定格在2484天。</p>
<p>我以为自己的这次切换决定做的真好，除开那让我焦躁的“叮”“叮”“叮”（现在回忆起当时叮叮声，依然让我感受到焦躁），我在两个APP之间发现更多的差异。</p>
<p>《百词斩》会有启动广告，进入APP后内里的营销活动显得花里胡哨，它常常有弹框，很多的弹框。背单词页面，除开中间大概五分之二处位置是我真正背单词需要的，剩下的部分，都是它的广告。</p>
<p>与之相反，《不背单词》没有启动页广告，进入APP后有弹框但只有一个，还只在他们做活动时。剩下的内容，只关于单词，整个界面简单整洁。</p>
<p>我喜欢简单，于是喜欢这新的背单词APP。</p>
<p>--</p>
<p>羊排是表妹去年快过年时送我的，一直放冰箱没吃，上周阿妮说想要我每周都做一个“拿手菜”，今天周六答应同事不去公司加班，于是在家做一顿好吃的。</p>
<p>清煮羊排、炒土豆片和凉拌青瓜。</p>
<p>拿手菜是土豆片，大菜是清煮羊排，准备工作花近一小时：锅铲和砍刀配合，将羊排剁成大块，先清水简单洗一遍，用盐水泡半小时再洗一遍，用白酒生姜焯水之后再用热水洗一遍。</p>
<p>炖一个半小时。</p>
<p>炖汤只加两块生姜。</p>
<p>阿妮说羊肉是好吃的，她吃了五块。</p>
<p>我也觉得好吃，我甚至以为这味道比外面馆子做的还要好些。</p>
<p>今天打球在下午，和大家一起打路人的感觉很爽，我发现自己呀，好像更喜欢打路人一些。为什么会有此种感觉呢？</p>
<p>我想自己喜欢的，是胜负欲的唤起，是和大家一起合作赢下比赛时的快乐。</p>
<p>现在时间是晚上的9点37分，已经洗过澡躺在沙发的我想要记一记今天，于是有此篇。</p>
<p>今天呀，先是早上的沉迷——打游戏近一小时，吃过早饭——自己煮的面条——后读《国史大纲》，再一次被钱穆先生的文字所感动。</p>
<p>准备晚餐，出发打球，阿妮在我快回家时将备好羊肉炖着，回家炒土豆片，吃过晚餐后给母亲打电话聊50分钟，聊聊家常，时间到现在。</p>
<p>今天还剩一小时，我啊，去整理一下当前的沉迷吧。</p>
<p>开车路上，我有听到余华自己说《<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMjM5ODczOTMzMA%3D%3D%26mid%3D2247486946%26idx%3D1%26sn%3Dec5abb657f9070a26059a051008ae16a%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MjM5ODczOTMzMA==&amp;mid=2247486946&amp;idx=1&amp;sn=ec5abb657f9070a26059a051008ae16a&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">活着</a>》，原来余华和我想法一样的，富贵的人生并不是那样的悲剧，在悲剧发生的间隙，富贵是享用过幸福的，我们不应该只关注悲剧，也应该给予平凡日子一些想象。</p>
<p>对的，余华也说《活着》并非悲剧。</p>
<p>--</p>
<p>最近的读书，似乎有些不够连续。</p>
<p>《亲密关系》已经听完，现在每天地铁上做的事情是温习。我啊，打算一章又一章的复述书中内容。目前正在<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMjM5ODczOTMzMA%3D%3D%26mid%3D2247487181%26idx%3D1%26sn%3D3bdaea7eb29959d59261d06128d26754%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MjM5ODczOTMzMA==&amp;mid=2247487181&amp;idx=1&amp;sn=3bdaea7eb29959d59261d06128d26754&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">复述第一章</a>，我想自己的选择并不错，现在的我，能记住的内容有许多。</p>
<p>亲密关系的七个要素有：了解、关心、信任、彼此依赖、回应性、共同性、承诺。个人的依恋类型，决定着亲密关系的质量。</p>
<p>中午的听书，是《演讲的力量》，它跟《余华写作课》和《余华文学课》一样，是我打算只听但不想写读书笔记的书。我决定，听便听了，只让它留下一种浅薄印象便好。</p>
<p>我还在阅读的书，是《沈从文评传》和《执拗的拓荒者》，两本书，都是别人讲沈从文先生。它们阅读的更不连续，只在很想看的时候看看。</p>
<p>昨晚，我再新增一本很累——比如下班回家步行的路上，比如晚上回到家躺在瑜伽垫或正洗澡——时可以听的书，它是《百家讲坛·资治通鉴》。</p>
<p>我依然不关注讲的好或者不好，只是听书就好。</p>
<p>我还有好几本读书笔记没有完成，它们是《瓦尔登湖》《今日简史》《爱的艺术》和《初老的女人》。</p>
<p>有一件很重要的事，我忘记记录了。</p>
<p>我们小组，新来一位同事，新来的同事，将和我做相同事情，他是我的学弟，他也看书，他也写东西，他也23年从深圳回来……</p>
<p>我感觉我们可以聊天的内容，很多很多很多。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[完整指南：iPhone崩溃日志查看与分析方法及低内存崩溃处理]]></title>    <link>https://juejin.cn/post/7574245883635433524</link>    <guid>https://juejin.cn/post/7574245883635433524</guid>    <pubDate>2025-11-19T10:08:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574245883635433524" data-draft-id="7574251313883267087" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="完整指南：iPhone崩溃日志查看与分析方法及低内存崩溃处理"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T10:08:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="疯狂的程序猴"/> <meta itemprop="url" content="https://juejin.cn/user/2760245749234147"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            完整指南：iPhone崩溃日志查看与分析方法及低内存崩溃处理
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2760245749234147/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    疯狂的程序猴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T10:08:39.000Z" title="Wed Nov 19 2025 10:08:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ios查看崩溃日志 查看iphone崩溃日志</p>
<p>我们在进行iPhone应用测试时必然会在“隐私”中找到不少应用的崩溃日志，但是不会阅读对于很多人来说简直头疼。在此小编为大家详细介绍一下具体的阅读方法，希望大家可以更快的定位BUG。首先我们先看一下从iPhone中随机抽出的一个Crash日志：</p>
<p><em>进程信息</em></p>
<p>日志主要分为六个部分： <strong>进程信息</strong>、 <strong>基本信息</strong>、 <strong>异常信息</strong>、 <strong>线程回溯</strong>、 <strong>线程状态</strong> 和 <strong>二进制映像</strong> <strong>，具体位置已经标记在上述文件中。</strong></p>
<p><strong>日志组成分析：</strong></p>
<p><strong>在上述六个部分中，我们最需要关注的是异常信息和线程回溯的内容。</strong></p>
<p><strong>1.</strong> <strong>进程信息：</strong> <strong>发生crash进程的相关信息</strong></p>
<p><strong>Hardware Model</strong>: 标识设备类型</p>
<p><strong>Process</strong>：应用名称</p>
<p><strong>Path</strong> <strong>：</strong> 所在路径</p>
<p><strong>Identifier</strong> <strong>：</strong> 程序ID</p>
<p><strong>Version</strong> <strong>：</strong> 版本号</p>
<p><strong>Code Type</strong> <strong>：</strong> 处理器架构</p>
<p><strong>2.</strong> <strong>基本信息：</strong> 给出了一些基本信息，包括闪退发生的日期和时间，设备的iOS版本。</p>
<p><strong>3.</strong> <strong>异常信息：</strong> 崩溃时抛出的异常类型，还能看到异常编码和抛出异常的线程。</p>
<p>注：</p>
<p><em>具体信号说明参见</em> <em>iOS异常捕获</em></p>
<p><em>详细的异常编码代表的含义请参考：</em> <em>Hexspeak</em></p>
<p>因此我们可以确定本次崩溃原因是内存访问错误</p>
<p><strong>4.</strong> <strong>线程回溯：</strong> 回溯是闪退发生时所有活动帧清单。它包含闪退发生时调用函数的清单。</p>
<p>实际上我们直接从iPhone中导出的崩溃日志应该是一串地址表示的，如下：</p>
<p><strong>大家可以通过symbolicatecrash</strong> 命令和dSYM文件将最后的两列解析为具体的方法名和行数。（具体使用方法大家可以自行查找）</p>
<p>使用Keymob工具可以更方便地进行崩溃日志的符号化分析，它支持自动解析和可视化展示，无需手动处理命令行，同时提供实时日志监控和过滤功能，帮助开发者快速定位问题。</p>
<p>在这里我们就可以看到详细的方法名，这样就能帮助开发同学定位到具体位置。</p>
<p><strong>5.</strong> <strong>线程状态：</strong> 闪退时寄存器中的值。一般不需要这部分的信息，因为回溯部分的信息已经足够让你找出问题所在。</p>
<p><strong>6.</strong> <strong>二进制映像：</strong> 闪退时已经加载的二进制文件。</p>
<p><strong>低内存崩溃：</strong></p>
<p>因为低内存崩溃日志与普通崩溃日志略有不同，所以本教程特别分开说明一下。</p>
<p>iOS设备检测到低内存时，虚拟内存系统发出通知请求应用释放内存。这些通知发送到所有正在运行的应用和进程，试图收回一些内存。</p>
<p>如果内存使用依然居高不下，系统将会终止后台线程以缓解内存压力。如果可用内存足够，应用将能够继续运行而不会产生崩溃报告。否则，应用将被iOS终止，并产生低内存崩溃报告。低内存崩溃日志上没有应用线程的堆栈回溯。相反，上面显示的是以内存页数为单位的各进程内存使用量。被iOS因释放内存页终止的进程名称后面你会看到jettisoned 字样。如果看到它出现在你的应用名称后面，说明你的应用因使用太多内存而被终止了。</p>
<p>当应用发生低内存闪退时，你必需看看应用中内存使用的方式，以及是如何处理低内存警告的。你可以使用Instruments工具中使用Allocations 和 Leaks来发现内存分配问题和内存泄漏问题。如果你不知道如何利用Instruments 检查内存问题。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[EMR Serverless Stella 1.0 技术分享：StarRocks企业级版本内核重大突破]]></title>    <link>https://juejin.cn/post/7574250031248523298</link>    <guid>https://juejin.cn/post/7574250031248523298</guid>    <pubDate>2025-11-19T10:17:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574250031248523298" data-draft-id="7574245883635286068" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="EMR Serverless Stella 1.0 技术分享：StarRocks企业级版本内核重大突破"/> <meta itemprop="keywords" content="数据分析"/> <meta itemprop="datePublished" content="2025-11-19T10:17:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="阿里云大数据AI技术"/> <meta itemprop="url" content="https://juejin.cn/user/2414974667341287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            EMR Serverless Stella 1.0 技术分享：StarRocks企业级版本内核重大突破
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2414974667341287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    阿里云大数据AI技术
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T10:17:20.000Z" title="Wed Nov 19 2025 10:17:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在今年云栖大会上，EMR Serverless Stella 1.0正式发布，这是一款面向企业级场景深度优化的高性能数据分析引擎。阿里云开源大数据平台OLAP引擎负责人周康系统性地分享了 Stella 在存算分离架构、Lakehouse 场景以及全文检索等三大核心场景下的深度优化经验，为业界提供了大规模 OLAP 系统工程化实践的宝贵参考。Stella引擎的发布将为企业级用户提供更加专业、高效的OLAP解决方案。</p>
<h2 data-id="heading-0">站在巨人肩膀上：与 StarRocks 开源社区的深度合作</h2>
<p>阿里云与StarRocks开源社区的合作可以追溯到2021年，从开源第一天起就建立了深度合作关系。在过去四年中，双方在源码共创、产品发布和技术优化方面积累了丰富的经验。</p>
<p><strong>合作历程回顾：</strong></p>
<ul>
<li><strong>2021年</strong>：开启源码共创，重点推动数据湖分析相关框架和性能优化</li>
<li><strong>2022年3月</strong>：推出EMR半托管StarRocks形态</li>
<li><strong>2023年</strong>：响应市场需求，推出全托管产品形态</li>
<li><strong>2024年</strong>：正式商业化存算分离版本</li>
</ul>
<p>随着产品的成熟，阿里云EMR已积累数百家B端企业客户。“我们始终站在巨人的肩膀上，”阿里云开源大数据平台OLAP引擎负责人周康表示，“Stella 所有功能和优化都会逐步回馈给社区，同时确保API层面与开源版本完全兼容。”
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10ec765f33d845818662bffad09c55ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152239&amp;x-signature=OviiVhCs0EcdI0rKko4fWMejfIQ%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">Lakehouse 成为业界共识：Stella 应运而生</h2>
<p>2024年，阿里云正式发布 OpenLake 方案，标志着 Lakehouse 架构在数据基础设施领域的全面落地：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/251ae1e337554d93a358e35dc0ec1805~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152239&amp;x-signature=bOLQpvWkxLtV5CRWcF7It4Ogaww%3D" alt="image.png" loading="lazy"/>
2024云栖大会重磅发布OpenLake解決方案，StarRocks 为 OLAP场景核心组件</p>
<p>伴随这一趋势，Lakehouse（数据湖仓一体）已成为国内外头部公司的业界共识：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37b7b5571a1c48a5850d2c97fb007a15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152239&amp;x-signature=nkhdTjbAc0OAzI3i8X1gmDV9gtk%3D" alt="image.png" loading="lazy"/></p>
<p>海外Lakehouse发展趋势  Snowflake/Databricks/BigQuery + Iceberg/Delta/Hudi</p>
<p>阿里云推出了 OpenLake 一体化湖仓解决方案，StarRocks 在其中担任核心 OLAP 引擎角色。然而，在大规模生产环境中，StarRocks 在存算分离架构和湖表查询方面仍有优化空间。Stella 项目正是为了应对这些挑战而生。通过在调度、查询优化、执行引擎和存储引擎四个层面的全面改进，Stella 1.0 针对几十 TB 甚至 PB 级数据场景，解决了事务机制、Compaction 效率、查询性能、元数据管理等一系列生产环境痛点。</p>
<h2 data-id="heading-2">Stella 1.0 三大核心场景突破</h2>
<p>EMR Serverless Stella 1.0版本于今年5月正式发布，主要聚焦三大核心技术能力的重大突破：</p>
<h3 data-id="heading-3">一、存算分离：性能和稳定性大幅提升</h3>
<p>Stella 1.0 在存算分离架构下实现了三大突破：</p>
<p><strong>1. 冷查性能大幅提升</strong></p>
<ul>
<li>实现 IO 合并，减少对象存储访问次数</li>
<li>优化 Compaction 调度器，大幅减少小文件数量 </li>
<li>针对轻量级 ETL 场景优化负载调度</li>
</ul>
<p><strong>2. 写入性能保障</strong></p>
<ul>
<li>开发 Batch Publish 能力，解决串行化导入瓶颈 </li>
<li>推出 Collocated PK Index，避免缓存盘和索引盘互相影响 </li>
<li>优化 FE 侧 Tablet 创建删除效率</li>
</ul>
<p><strong>3. 缓存利用率优化</strong></p>
<ul>
<li>引入 Index Cache 和 Meta Data Cache，提升元数据访问速度 </li>
<li>实现自适应 IO Stream，智能选择本地缓存或远端访问 </li>
<li>针对 ETL 场景优化空间利用</li>
</ul>
<p>在TPC-H 10T基准测试中，存算分离版本的Stella相比上一版本<strong>性能提升超过120%</strong>，充分展现了云原生架构的技术优势。
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ec1b23b39624717bc67f35adfd9d0bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152239&amp;x-signature=nzk591SzLrlCzqownmY%2BcZaWNP8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">二、Paimon 湖表查询：Co-design 驱动性能飞跃</h3>
<p>Stella 1.0在Paimon表分析方面，重点聚焦在三个方向的提升：</p>
<p><strong>1. 数据读写效率提升</strong> </p>
<ul>
<li>实现自适应 Batch Size 优化 </li>
<li>支持Native Paimon Writer，性能大幅提升</li>
</ul>
<p><strong>2. 元数据访问优化</strong> </p>
<ul>
<li>针对 Manifest 数量众多场景，实现分布式解析能力 </li>
<li>适配异步 Splits 调度框架 </li>
<li>优化 Manifest Cache 策略</li>
</ul>
<p><strong>3. 深度集成阿里云 DLF 2.x</strong> </p>
<ul>
<li>与 Data Lake Formation 产品深度整合 </li>
<li>借助 DLF 能力提升 Paimon 查询和写入的性能与稳定性 </li>
<li>针对DV表实现Native读取优化</li>
</ul>
<p>Stella在Lakehouse场景下查询Paimon下性能的提升非常明显：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a08f8a870994472938bfffc41fce1e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152239&amp;x-signature=r44PojoCMzaTuPucR08owzkGbiU%3D" alt="image.png" loading="lazy"/></p>
<p>虽然 Flink + Paimon 已成为成熟的实时入湖方案，但计算引擎与 Paimon 存储的查询优化结合仍有巨大提升空间。Stella 与 Paimon 将在多个方便持续进行Co-Design，更多优化成果将在后续版本中发布。</p>
<h3 data-id="heading-5">三、全文检索：打造高性能、高可用的文本分析能力</h3>
<p>Stella 1.0 正式推出全文检索能力，支持高效、精准的文本查询。</p>
<ul>
<li><strong>架构重构</strong>：对 Inverted Index（倒排索引） 整体解决方案进行架构优化</li>
<li><strong>存算分离主键表支持</strong>：新增主键表全文检索能力，实现高效精准的查询能力</li>
<li><strong>小文件合并</strong>：解决存算分离架构下的“性能杀手”问题（单个 Segment 产生十几个小文件）
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bde7b2fc36c467b94c0bf8fc075d392~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152239&amp;x-signature=AnF3GW2XeG6PDSGLQTFdVmdYDMI%3D" alt="image.png" loading="lazy"/></li>
</ul>
<p>文本过滤性能benchmark: Stella vs EMR StarRocks 3.3</p>
<p>目前，全文检索功能已在阿里集团内部和云上客户中投入使用，所有优化代码已通过 PR 提交至 StarRocks 开源社区。</p>
<h2 data-id="heading-6">技术创新路线图持续演进</h2>
<p>面向未来，Stella引擎制定了清晰的技术发展路线图，在四个关键领域持续深耕：</p>
<ol>
<li><strong>迈向Stella 2.0时代：轻量 ETL Production Ready</strong><br/>
全面强化轻量级 ETL 能力，打通从数据接入、转换到分析的端到端链路，使用户无需依赖外部调度系统即可高效完成日常数据加工任务，真正实现“开箱即用、生产就绪”。</li>
<li><strong>Lake Optimizer：湖表性能全面对齐甚至超越内表</strong><br/>
推出专为开放数据湖设计的 Lake Optimizer，显著提升 Apache Paimon 等湖表格式的查询性能，让湖表在复杂分析场景中媲美甚至超越传统内表体验。</li>
<li><strong>智能化 Background Job Service：彻底释放用户运维负担</strong><br/>
针对企业用户长期面临的内表运维复杂、资源争抢等问题，Stella 将推出智能化后台作业服务，自动处理 compaction、索引构建、统计信息收集等任务，实现高智能化的自治运维，大幅提升系统稳定性与资源效率。</li>
<li><strong>全文检索与向量检索能力持续提升</strong><br/>
在已有的高性能 OLAP 基础上，进一步融合全文检索与向量检索能力，支持非结构化与多模态数据的统一分析，为 AI 原生应用、智能搜索等新兴场景提供底层引擎支撑。</li>
</ol>
<p>这四大方向不仅体现了 Stella 对 Lakehouse 架构的深度适配，更彰显了其从“高性能分析引擎”向“智能数据平台核心引擎”演进的战略决心。随着这些能力的逐步落地，Stella 将为企业用户提供更开放、更智能、更易用的下一代实时分析体验。</p>
<h2 data-id="heading-7">技术探索与社区协作深度融合</h2>
<p>Stella引擎在技术架构探索方面持续深化与开源社区的合作：</p>
<p>Lakehouse架构能力的持续拓展体现了Stella引擎的前瞻性设计理念。在现有Lakehouse架构基础上，系统将支持更多检索功能，为企业的多元化分析需求提供全面支持。向量搜索技术是与Apache Paimon深度集成的创新探索，在AI和大数据时代，向量搜索能力将成为差异化的技术优势。</p>
<h3 data-id="heading-8">开源社区贡献亮点</h3>
<ul>
<li><strong>JSON等半结构化数据处理能力持续增强</strong>，推动整个生态发展</li>
<li><strong>大规模场景技术实践经验分享</strong>，为社区贡献宝贵技术智慧</li>
<li><strong>与Apache Paimon团队深度技术合作</strong>，确保生态整合持续优化</li>
<li><strong>所有优化方案回馈开源社区</strong>，推动开源生态系统发展进步</li>
</ul>
<p>开源社区的深度贡献体现了Stella团队的技术责任感和开放合作精神。JSON等半结构化数据处理能力的持续增强将推动整个生态的发展，为企业在数字化转型过程中处理多样化数据提供更强支持。大规模场景下的技术实践经验分享不仅展示技术实力，更为社区贡献了宝贵的技术智慧。</p>
<p>“我们不仅要在云上提供增值服务，更要推动整个开源生态的发展，”周康强调，“通过深度参与开源社区，确保所有用户都能从技术进步中受益。”</p>
<h2 data-id="heading-9">技术意义与未来规划</h2>
<p>EMR Serverless Stella 1.0的发布标志着阿里云在湖仓一体技术领域达到新的里程碑，为用户提供从数仓加速、湖仓查询到全文检索的全方位OLAP能力支持。该版本不仅解决了企业在实际生产环境中遇到的关键技术挑战，更通过持续的技术创新和社区贡献，推动了整个StarRocks生态系统的发展。</p>
<p>未来，Stella将继续围绕Lakehouse架构演进，在缓存调度、查询优化、存储引擎和写入能力等核心领域持续创新，为企业数字化转型提供更加强劲的技术引擎。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【开源】耗时数月、我开发了一款功能全面【30W行代码】的AI图床]]></title>    <link>https://juejin.cn/post/7574271557938905139</link>    <guid>https://juejin.cn/post/7574271557938905139</guid>    <pubDate>2025-11-19T10:15:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574271557938905139" data-draft-id="7574271557938855987" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【开源】耗时数月、我开发了一款功能全面【30W行代码】的AI图床 "/> <meta itemprop="keywords" content="前端,后端,开源"/> <meta itemprop="datePublished" content="2025-11-19T10:15:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="_小九"/> <meta itemprop="url" content="https://juejin.cn/user/3861140568811576"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【开源】耗时数月、我开发了一款功能全面【30W行代码】的AI图床 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3861140568811576/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    _小九
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.5 如鱼得水
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.5 如鱼得水" title="VIP.5 如鱼得水" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T10:15:48.000Z" title="Wed Nov 19 2025 10:15:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读13分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>AI编程发展迅猛，现在如果你是一个全栈开发，借助AI编辑器，比如<strong>Trae</strong>你可以开发很多你以往无法实现的功能，并且效率会大大提示，<strong>Tare</strong>的<strong>Coding能力</strong>已经非常智强了，借助他，我完成了这个<code>30W行</code>代码的开源项目，现在，想把这个项目推荐给你。</p>
<p>当前文章主要是介绍我们开发出的这个项目，在后续，将会新开一个文章专门介绍<strong>AI Coding</strong>的各种技巧，如何使用他，才能让他在<strong>大型项目</strong>中依然如虎添翼。</p>
<blockquote>
<p>如果你想快速了解此项目、你可以访问<a href="https://link.juejin.cn?target=https%3A%2F%2Fpixelpunk.cc%2F" target="_blank" title="https://pixelpunk.cc/" ref="nofollow noopener noreferrer">PixelPunk官方文档</a>。</p>
</blockquote>
<blockquote>
<p>如果你想快速体验此项目、你可以访问<a href="https://link.juejin.cn?target=https%3A%2F%2Fv1.pixelpunk.cc%2F" target="_blank" title="https://v1.pixelpunk.cc/" ref="nofollow noopener noreferrer">V1版本</a>,前往体验功能。</p>
</blockquote>
<blockquote>
<p>如果你想完整体验前后台全面的功能、你可以访问<a href="https://link.juejin.cn?target=http%3A%2F%2Fdev.pixelpunk.cc%2F" target="_blank" title="http://dev.pixelpunk.cc/" ref="nofollow noopener noreferrer">测试环境</a>。【root 123456】</p>
</blockquote>
<blockquote>
<p>如果您认可我的项目，愿意为我献上一个宝贵的Star，你可以前往<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCooperJiang%2FPixelPunk" target="_blank" title="https://github.com/CooperJiang/PixelPunk" ref="nofollow noopener noreferrer">PixelPunk</a>项目。</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2bada0a94aae436495f282772dd0748b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=046KAzJ3ITK5fWE0X%2BdC2dEoQZc%3D" alt="image.png" loading="lazy"/></p>
<p>开发这样一个项目在现在这个时间来看似乎没什么必要，实际上开发这样一个项目的原因其实就是在年初的时候失业了一段时间，闲在家里无聊，于是想着做一个自己的开源项目，最开始其实做的是另一个类型的项目，开发了一段时间感觉有些无聊就转战做了现在的这个项目<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCooperJiang%2FPixelPunk" target="_blank" title="https://github.com/CooperJiang/PixelPunk" ref="nofollow noopener noreferrer">PixelPunk图床</a>， 其实并不只是想要做一个<code>图床</code>，只是当前来说的一期功能比较贴合图床，后期的跌代准备支持更多格式包括视频文档等等，并且由于<code>AI多模态模型</code>的能力发展迅速，后期结合<code>AI</code>可以实现更多可玩性比较高的内容。</p>
<p>市面上已经有了非常多的开源图床了，开发这样一个项目要追求一些差异点才会有价值，本质上来说这类服务其实核心就是个存图片而已，其他功能并不是很重要，但是作为个人使用用户来说，除了存图也愿意去尝试一些便捷的功能，于是思考到这个点之后，我开始了这个项目的开发，项目的命名<code>[PixelPunk] </code>是我让AI起的，因为要做就要做一个不一样的有特点，我要做一个ui上就不一样的图床出来，于是有了此命名，中文翻译过来是<code>像素朋克</code>,由于像素风格感觉ui不是很适合工具类网站使用，于是我选择了<code>赛博朋克风格</code>，围绕这个ui来开发了此项目。</p>
<h3 data-id="heading-0">项目概览</h3>
<p>首先呢项目从开发就一个全栈项目，前后端放一起了，采用的技术栈是 go+vue， 前端会将打包的文件放入到go中一起打包为<code>二进制</code>安装包，这样部署起来将非常简单。
项目分为了用户端和管理端，并且同属于一个项目，不分离开发，为了符合我们定制化的ui，所有组件都是自定义的组件，项目使用了<code>70+</code>自定义组件。
项目接入了多模态<code>AI</code>大模型，在以前我们的图床要实现各种功能需要对接各种各样的平台，现在有了<code>AI</code>，我们只需要一个模型就能完成非常多的功能，比如【<strong>语义化描述图片</strong>】，【**<em>图片OCR识别</em>】，【**<em>图片自动分类</em>】，【**<em>图片自动打标</em>】，【**<em>图标自动审核NSFW、违规图、敏感图、血腥图等等</em>】，【<strong>图片颜色提取</strong>】等等功能都只需要配置一个<code>AI模型</code>即可，对于成本而言，比之前的三方<code>API</code>可能更加便宜</p>
<h3 data-id="heading-1">关于部署</h3>
<p>作为一个开源项目，我想的是需要使用者使用起来足够简单，部署起来也足够快，本身来讲，我们项目需要用来这些内容，<code>mysql|Sqlite</code> + <code>Redis|系统内存</code> + <code>qdrant向量数据库</code>， 这三件套，为了安装简单，我将向量数据库直接集成到安装包，用户可以无需关系任何内容，我们可以做到<code>0配置启动项目</code>，不需要你做任何配置即可超快部署项目。</p>
<p>我们提供了两种部署方式，一种是安装包部署，你可以下载对应平台的安装包**.zip安装包**，下载到你的服务器，解压之后里面有一个<code>install.sh</code>，直接<code>sh ./install.sh</code>即可安装，当然手动部署 可能还需要两个步骤，你可以使用我们的脚本直接进行部署，也可以看看我们的部署文档，<a href="https://link.juejin.cn?target=https%3A%2F%2Fpixelpunk.cc%2Fdocs%2Fgetting-started" target="_blank" title="https://pixelpunk.cc/docs/getting-started" ref="nofollow noopener noreferrer">PixelPunk部署文档</a>。</p>
<blockquote>
<p>安装包一键部署 <code>curl -fsSL https://download.pixelpunk.cc/shell/install.sh | bash</code></p>
</blockquote>
<blockquote>
<p>docker-compose一键部署脚本 <code>curl -fsSL https://download.pixelpunk.cc/shell/docker-install.sh | bash</code></p>
</blockquote>
<p>我们的部署非常简单，你只需要执行完脚本即可直接启动项目，我们的<code>docker-compose部署方式</code>已经配置了所有数据库缓存等信息，启动项目进入 <strong><a href="https://link.juejin.cn?target=http%3A%2F%2Fip%3A9520" target="_blank" title="http://ip:9520" ref="nofollow noopener noreferrer">http://ip:9520</a></strong> 会自动跳转到安装页面，添加管理员账号密码即可完成安装， 如果使用安装包模式呢，那么就支持你可以自定义选择数据库，可以填写自己的mysql，也可以使用系统内置的<code>Sqlite</code>，可以选择自己的<code>向量数据库和缓存</code>，也可以使用系统内置的，自由选择，总之，一键脚本预估20S就可以帮你安装并且启动项目，无需你的任何配置，希望会自己内置生成一些必要信息，比如<strong>jwt</strong>，系统安装后你可以进入后台管理进行修改。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28da070422dd4053915ba5f9e947322a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=QN8mnmOLPXfFpR6sGM1VVRjEBNw%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">项目部分功能</h3>
<p>我们的项目功能可以说已经非常全面了，并且还在持续迭代，目前代码总行数已经达到了<code>30W行</code>，很多功能需要你自己体验，我们覆盖了主流图床的全部功能，并且还在进一步持续加入更多有趣的元素，我们可以列举一些功能做简要说明。</p>
<h4 data-id="heading-3">10+精美主题</h4>
<p>作为个人使用的工具，我一直在持续优化UI和交互，始终认为，<code>UI</code>还是很重要的一个步骤，目前的<code>UI还不够精美</code>，也是后续会持续调整的一个点，目前提供了<code>10多套</code>主题，并且您可以自定义主题，我在项目中放置了<strong>主题开发文档</strong>,你可以根据模板文件去替换一套变量即可完成一套主题的开发。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c9416634a9d4fe6a07b2f25dbab0ab4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=pkSI7K4CTlF5zHMEZLBFxl1QmFg%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bdf3798fec034b7aaceff58524b7b733~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=gYITr0mdbY2Rj4EWqkTBkRBJJ3c%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">多语言双风格</h4>
<p>我们目前内置了三种语言<code>中英日</code>,并且为了迎合我们<code>PixelPunk风格</code>的特色，我们新增了一种风格选项，你可以选择<code>赛博朋克风格</code>的文案，让系统的所有内容提示充满赛博味道~</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3152eb1f44824daa9aaf4428e0357b0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=9u%2BdbT%2BNiVsgEKrlEa8cpZPpZXY%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62ec4e8376c542c6b5fc0a62f9b8a512~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=zQlg2awfkZ6nL8c7OPjhm2V2hoA%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-5">多布局系统</h4>
<p>我们网站为了更好的工作体验，提供了两种的布局方式,<code>传统布局</code>,<code>工作布局</code>，既可以使用传统的轻量化的布局让人轻松，也可以使用工作台布局让工作更高效。并且您还可以在后台限制这些功能，使用固定布局而不开放这些功能，在后台管理部分都可以实现。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b76d28edf12749e180c31bd42d90ad6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=BqsX8kXEGnHy0rVFOuBgu6jFKkQ%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f22417779924ad1898afc8620ad40f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=YyNiK%2FGz7syOQpWj8I6Ng%2BwaYc8%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">多种登录方式</h4>
<p>我们内置默认使用传统邮箱的登录方式，并且支持关闭注册，<code>邮箱配置也是后台配置即可</code>，同时系统对接了<code>Github</code>、<code>Google</code>、<code>LinuxDo</code>三种接入成本非常低的快捷登录方式，并且可能由于你是国内服务器，无法直接访问这些服务，所以系统贴心的准备了<code>(代理服务)</code>配置，让你即使是国内服务器也依然可以顺利完成这些快捷登录。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55af683a3ec340e09bba7b1a875dfaf4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=bRWkKlZ%2FyX0ZYNK2y0Bpw41%2FQ3A%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8fc5d4613564de4b8bb1b823ec4c39e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=AIrC%2Fyf%2BppTocXvsAPBoh16kV7o%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-7">强大的特色文件上传</h4>
<p>文件上传是一个基础的功能，所有图床都支持，我们当然也支持，我们在此功能上进行了耐心的打磨，支持很多特色功能，</p>
<ul>
<li>支持后台动态配置允许格式，动态配置上传图片限制尺寸</li>
<li>支持<code>大文件分片上传</code>、<code>断点续传</code>等功能。</li>
<li>支持<code>秒传</code>，后台动态开启是否启用</li>
<li>支持<code>游客模式</code>，限制游客上传数量，并限制上传资源有效时间</li>
<li>支持<code>自定义资源保存时间</code>，后台可配置用户允许选择有效期，精确到分钟</li>
<li>支持<code>重复图检测</code>，重复图自动秒传，不占用空间</li>
<li>支持水印，并且特色化水印，开发了一个水印专用面板用于你配置特色化水印，支持<code>文字、图片</code>水印。</li>
<li>支持<code>中断上传</code>,取消上传</li>
<li>支持<code>上传实时进度提示</code></li>
<li>支持<code>自动优化图片</code>，<code>自定义上传文件夹</code>。</li>
<li>支持<code>文件夹上传</code>,<code>拖拽上传</code>,<code>项目内全局上传（任意页面都支持上传）</code>。</li>
<li>支持<code>原图复制</code>,<code>MD格式复制</code>,<code>HTML格式复制</code>,<code>缩略图格式复制</code>,<code>全部图片链接批量复制</code></li>
<li>支持<code>公开、私密、受保护</code>,三种权限设置，<code>公开图片</code>可以在任何地方显示并且授权给管理员可以用于推荐，并且在作者首页可以展示对外，<code>私密</code>则仅自己可见，系统其他人不可见，<code>受保护</code>权限图片只能在系统观看打开，无法产生链接，除自己登录系统外，其他人无法观看。</li>
<li>支持<code>持久化</code>，你可以选择图片并且上传中，跳转到任何页面而不会中断你的上传，你可以在上传过程中干任何事情</li>
<li>支持<code>特色悬浮球</code>，当你不在上传页面的其他页面，如果有上传内容，会有一个特色上传球实时告知您上传的进度，并且你可以随意拖动控制悬浮球的位置。</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fdc7ea1ec924525bf3b14d5d5ca803d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=P5I48qTZ681qRtQemYbnxdyM2MY%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f66c5469421d47639f17f4d9fd308934~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=AGis85x6E6aOeT514m8gygfdzhU%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93ae54015b5348ceaa37d7fc7874985f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=Vo6udTlkiV2aSaZXgQXvrfRQ6G4%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-8">超过上传渠道支持</h4>
<p>作为一个图床的基本素养，都会支持对接三方，目前我们已经支持了<code>10+</code>的三方云储存渠道，并且添加时候可以测试渠道保障你的配置，首先我们支持<code>服务器自身存储</code>，这也是系统默认渠道，你可以在后台渠道配置更多，比如<code>阿里云COS</code>,<code>腾讯云OSS</code>,<code>七牛云</code>,<code>雨云</code>,<code>又拍云</code>,<code>S3</code>,<code>Cloudfare R2</code>,<code>WebDav</code>,<code>AZure</code>,<code>Sftp</code>,<code>Ftp</code>,等等渠道，<strong>S3</strong>协议本身就可以支持非常多的基于S3协议的渠道了，并且，如果你想要更多渠道，可以去往我们官网网站提起诉求，我们可以很快支持新的渠道。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa931accca7c4903a5eb329f90d1adb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=lykqpx7jqED%2B9tnj8GK1NffKGnE%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e2674a6366e4caabe03f3f98f0f6391~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=Ui6agEDPab1Q5OjE2WpOoaki%2B7A%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-9">特色AI功能</h4>
<p>AI也是我们图床的一大特色，我们利用AI做了这些事情</p>
<ul>
<li>自动分类</li>
<li>自动打标</li>
<li>语义化图片，提取信息，提取色调</li>
<li>实现ai自然语言搜索</li>
<li>实现相似图搜索</li>
<li>实现NSFW违规图审核</li>
</ul>
<p>而这些，仅仅只需要配置一个<strong>openai的gpt4-mini</strong>即可完成，后续会支持更多渠道（目前仅支持配置OPENAI格式的渠道），目前测试感觉<strong>gpt-4.1-mini</strong>足以胜任工作，并且价格低廉，性价比很高。</p>
<ul>
<li>违规图片检测 可以自定义等级 宽松或严格</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b57cfde532dc4c13bad16a572ff66a93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=qYG9qLtaHLEDBDx28fKEH5Sd5Go%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>自然语言搜索图片</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/084de3398649419f834f4c948b2bcfa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=Tt8nptZae1e3dNdJjKKL0js4HNI%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>相似图搜索</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d322149879694be5bfd9c7a94b420738~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=V9k%2BBT44cE4Xln%2B6wh4JTSX5f8g%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>图片ai描述</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55e575a838c24ced9ef145455cdd7ef1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=l%2BKwYtVZq0zxvfGEX5EvvthywJU%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>自动分类打标签</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05ea689cef8c44829823170ca949d523~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=mn03ubC2618pQuafFawjHPicIOA%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-10">文件夹功能</h4>
<p>文件分类是一个和合理的诉求，所以我们可以自定义创建文件夹，同样可以控制不同的权限，并且文件夹可以无限嵌套 你可以自定义多层级的文件夹 合理管理你的文件，并且我们支持<code>文件夹移动</code>，<code>图片移动</code>，<code>批量操作</code>，<code>右键菜单</code>，<code>拖拽排序</code>等等特色功能，你可以灵活的管理你的文件。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffa3db788fb14937a9ca47cf82d77def~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=Zm%2F3TEl193SXbkK5hzmIiU0rJ8A%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>右键菜单</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/512e2954b1334e7fa3b57f69b490068d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=D3V4yCKNPBX62VmzJzfo0EBY%2F1g%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-11">分享系统</h4>
<p>我们拥有大量素材，或者一些收藏资源需要分享给好友，我们可以任意创建分享，可以分享自己的文件夹，图片，也可以组合分享，也可以分享用户公开的推荐图，选择任意探索广场的图进行分享，并且可以统计访问次数，限制访问次数，达到访问次数关闭分享，密码分享，限制时间有效期分享，邮箱通知等等功能。</p>
<p>您可以观看我们的<a href="https://link.juejin.cn?target=https%3A%2F%2Fv1.pixelpunk.cc%2Fshare%2FETDMDkz6EnzZxEMl" target="_blank" title="https://v1.pixelpunk.cc/share/ETDMDkz6EnzZxEMl" ref="nofollow noopener noreferrer">演示分享内容</a></p>
<ul>
<li>创建分享</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa459bf521ec476b8190f04bb4f84bd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=nnXi4XsOomOAIkEv6%2F9v4f1kaeU%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a5e483c67d4441e897fb2c9879ec1b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=gh9K%2Bc9DazHicKKW500pas9c7EM%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-12">防盗链管理</h4>
<p>图床安全始终是一个问题，经常会遇到被盗刷的风险，由于流量费用贵，鄙人有幸被刷破产过一次（TMD），我们加入了防盗链配置，可以配置<code>白黑名单域名|IP</code>，可以配置<code>网站refer</code>等内容，并且对于违规的用户，我们可以配置让其<code>302到他地址</code>,<code>可以自定义返回固定图</code>,<code>也可以直接拒绝</code>。</p>
<p>当我们对接三方渠道的时候，正常情况我们会拿到<code>远程url地址</code>，我们依然可以在后台配置渠道将其隐藏远程url地址，如果配置，那么域名请求将会从我们服务器代理获取，可以隐藏掉三方的地址，或者配置私有存储桶通过秘钥去动态获取图片，防止你的图片被盗刷大量流量</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6092e578d72a4b2f83e9f98b4ec1c277~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=s%2BghD%2FZfbwm7WX5k72c2eppjwgk%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-13">开放API</h4>
<p>图床的基本功能之一，我们可以生成秘钥在三方进行上传文件，不同的是，我们系统支持了设置秘钥时可以<code>限制其使用的空间</code>，<code>限制上传次数</code>，可以<code>指定上传的文件夹</code>,指定<code>文件格式</code>等等，并位置提供了完整的上传文档，支持<code>单文件上传</code>,<code>多文件上传</code>。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90d55a4cd12e45f3bccb57c8a30470dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=WQI3G2nTForI1P94vE%2FWCry264g%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-14">随机图片</h4>
<p>经常会有人需要一个随机图片的API，但是受限于使用别人的不够稳定，也不够灵活，于是我们开放了一个随机API功能，你可以动态的配置，选择其绑定你需要随机的图片，比如指定随机任意文件夹，指定返回方式302重定向，或直接返回图片，你可以点击<a href="https://link.juejin.cn?target=https%3A%2F%2Fv1.pixelpunk.cc%2Fapi%2Fv1%2Fr%2Frnd_C3wEvW5T9EjJ" target="_blank" title="https://v1.pixelpunk.cc/api/v1/r/rnd_C3wEvW5T9EjJ" ref="nofollow noopener noreferrer">pixelpunk随机图片API演示</a> ，每次刷新你可以获取新的图片。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d507d4f2f6947ef80c161b73337a5fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=%2FI687jhTfSy0lKAJpYJMOLzcATQ%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-15">空间带宽控制</h4>
<p>我们允许为用户配置限制的使用空间和流量，后台动态灵活配置这些内容，保证多用户使用的时候限制用户使用量。</p>
<h3 data-id="heading-16">更多功能</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed3904072cee4741a79777739e8ae0af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=Pf96zVJF6ve6QljPCceE3AR9VnE%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92f44fb955fd48d283b89d061a5651e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=ge1kF0X3PvyAs4tLCnpOoBnTLkM%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/813a5acee47f4818a667273b7ee0785e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=m2rGsoQ%2BSLy1j4aeBf7r59K5AwU%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7232fbd2fa040d888643bf21fee31dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=mxt90OLx%2BeUlacgijTrk5k8aeRk%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/800b0f1909c343e4b00f1b8b18b06fcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-Wwj-S5nQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152147&amp;x-signature=29ECRlu6CGV5sUt9sEG2TbhLWPg%3D" alt="image.png" loading="lazy"/></p>
<p>总之我们的功能远不止如此，我们还有很多有意思的功能，一些更多的细节需要你去探索，比如，公告系统、消息通知、活动日志、限制登录、IP登录记录，超全的管理系统、埋点统计、访客系统等等模块，这是我个人第一个花费较多时间开发的一套系统，目前对比市面上所有的开源图床，自我认为是一款相对功能最全面的图床，耗费了我大量时间。</p>
<p>如果佬友花费时间看到了这里，那么希望能收获你的一个<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCooperJiang%2FPixelPunk" target="_blank" title="https://github.com/CooperJiang/PixelPunk" ref="nofollow noopener noreferrer">宝贵的Star</a>,后续的功能我依然会持续跌代，如果你有任何需求，可以私信我，如果合理，我可以无偿免费优先加入到后续跌代中去。</p>
<h3 data-id="heading-17">待更新预期功能</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 后端多语言适配</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> UI 美化</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> Desktop 端开发</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 更多格式支持 (视频|文档)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 交互体验优化</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 更多渠道支持</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 更多AI接入</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 图片处理工具箱</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【穿越Effective C++】条款22：将成员变量声明为private——封装的边界与设计的自由]]></title>    <link>https://juejin.cn/post/7574281453706854406</link>    <guid>https://juejin.cn/post/7574281453706854406</guid>    <pubDate>2025-11-19T10:22:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574281453706854406" data-draft-id="7574253222606782505" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【穿越Effective C++】条款22：将成员变量声明为private——封装的边界与设计的自由"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2025-11-19T10:22:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="沐怡旸"/> <meta itemprop="url" content="https://juejin.cn/user/2875978146656750"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【穿越Effective C++】条款22：将成员变量声明为private——封装的边界与设计的自由
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978146656750/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    沐怡旸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T10:22:47.000Z" title="Wed Nov 19 2025 10:22:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这个条款揭示了C++类设计的核心封装原则：成员变量应该声明为private，这不仅是技术选择，更是软件设计哲学的体现。通过严格控制数据访问，我们获得了实现灵活性、接口稳定性和维护便利性。</p>
<hr/>
<h3 data-id="heading-0"><strong>思维导图：成员变量封装的完整体系</strong></h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74cc5e2eec1e4da399a97db4ea1713e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKQ5oCh5pe4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152567&amp;x-signature=hc6BMe%2F3o6XKFqTkWFHMZ77aNMw%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-1"><strong>关键洞见与行动指南</strong></h3>
<h4 data-id="heading-2"><strong>必须遵守的核心原则：</strong></h4>
<ol>
<li><strong>严格数据封装</strong>：所有数据成员都应该声明为private，无一例外</li>
<li><strong>行为导向接口</strong>：提供操作而非数据访问，表达"做什么"而非"是什么"</li>
<li><strong>实现自由度</strong>：保持改变内部实现的自由，不影响客户端代码</li>
<li><strong>不变式维护</strong>：在成员函数中集中维护类的不变式</li>
</ol>
<h4 data-id="heading-3"><strong>现代C++开发建议：</strong></h4>
<ol>
<li><strong>统一访问方法</strong>：为需要访问的数据提供一致的get/set接口</li>
<li><strong>移动语义支持</strong>：在访问函数中正确处理移动语义</li>
<li><strong>智能指针管理</strong>：对于动态资源，使用智能指针封装所有权</li>
<li><strong>const正确性</strong>：正确使用const成员函数提供只读访问</li>
</ol>
<h4 data-id="heading-4"><strong>设计原则总结：</strong></h4>
<ol>
<li><strong>最小权限原则</strong>：只暴露必要的最小接口，隐藏所有实现细节</li>
<li><strong>单一责任原则</strong>：数据和行为应该封装在同一个类中</li>
<li><strong>开闭原则</strong>：对扩展开放，对修改封闭</li>
<li><strong>依赖倒置原则</strong>：依赖抽象而非具体实现</li>
</ol>
<h4 data-id="heading-5"><strong>需要警惕的陷阱：</strong></h4>
<ol>
<li><strong>过度封装</strong>：为每个字段提供get/set等于没有封装</li>
<li><strong>protected陷阱</strong>：protected成员几乎和public一样缺乏封装性</li>
<li><strong>友元滥用</strong>：过度使用friend会破坏封装边界</li>
<li><strong>接口膨胀</strong>：暴露不必要的实现细节通过公有接口</li>
</ol>
<p><strong>最终建议：</strong> 将private成员变量视为类设计的防火墙。培养"封装思维"——在设计每个类时都思考："这个数据应该怎样被访问？谁会需要它？如何确保数据的完整性？" 这种思考方式是构建可维护、可扩展软件系统的关键。</p>
<p>记住：<strong>在C++类设计中，将成员变量声明为private不是可选项，而是必选项。这是区分专业设计和业余设计的关键标志。</strong> 条款22教会我们的不仅是一种编码规范，更是软件工程基本原则的具体实践。</p>
<hr/>
<h3 data-id="heading-6"><strong>深入解析：封装的核心价值</strong></h3>
<h4 data-id="heading-7"><strong>1. 实现自由的保障</strong></h4>
<p><strong>封装带来的实现灵活性：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 初始实现：使用数组存储</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StudentRecords</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">size_t</span> MAX_STUDENTS = <span class="hljs-number">1000</span>;
    Student students_[MAX_STUDENTS];
    <span class="hljs-type">size_t</span> count_ = <span class="hljs-number">0</span>;

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addStudent</span><span class="hljs-params">(<span class="hljs-type">const</span> Student&amp; student)</span> </span>{
        <span class="hljs-keyword">if</span> (count_ &lt; MAX_STUDENTS) {
            students_[count_++] = student;
        }
    }
    
    <span class="hljs-function"><span class="hljs-type">size_t</span> <span class="hljs-title">getStudentCount</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> count_; }
};

<span class="hljs-comment">// 升级实现：使用vector，接口不变！</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StudentRecords</span> {
<span class="hljs-keyword">private</span>:
    std::vector&lt;Student&gt; students_;  <span class="hljs-comment">// 实现完全改变！</span>

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addStudent</span><span class="hljs-params">(<span class="hljs-type">const</span> Student&amp; student)</span> </span>{
        students_.<span class="hljs-built_in">push_back</span>(student);
    }
    
    <span class="hljs-function"><span class="hljs-type">size_t</span> <span class="hljs-title">getStudentCount</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ 
        <span class="hljs-keyword">return</span> students_.<span class="hljs-built_in">size</span>();  <span class="hljs-comment">// 接口行为一致</span>
    }
};
</code></pre>
<h4 data-id="heading-8"><strong>2. 访问控制的精确性</strong></h4>
<p><strong>精细的访问控制示例：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccount</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">double</span> balance_;
    std::string accountNumber_;
    <span class="hljs-type">bool</span> isActive_;
    <span class="hljs-keyword">mutable</span> std::mutex balanceMutex_;  <span class="hljs-comment">// 封装同步原语</span>

<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// 只读访问 - 线程安全</span>
    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">getBalance</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(balanceMutex_)</span></span>;
        <span class="hljs-keyword">return</span> balance_;
    }
    
    <span class="hljs-comment">// 受控的写入操作</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">deposit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> </span>{
        <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">"存款金额必须为正"</span>);
        }
        
        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(balanceMutex_)</span></span>;
        balance_ += amount;
        <span class="hljs-built_in">logTransaction</span>(<span class="hljs-string">"存款"</span>, amount);
    }
    
    <span class="hljs-comment">// 条件化操作 - 业务规则封装</span>
    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">withdraw</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> </span>{
        <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">"取款金额必须为正"</span>);
        }
        
        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(balanceMutex_)</span></span>;
        <span class="hljs-keyword">if</span> (balance_ &gt;= amount) {
            balance_ -= amount;
            <span class="hljs-built_in">logTransaction</span>(<span class="hljs-string">"取款"</span>, amount);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// 计算属性 - 不存储但通过接口暴露</span>
    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isOverdrawn</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">getBalance</span>() &lt; <span class="hljs-number">0</span>;
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">logTransaction</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; type, <span class="hljs-type">double</span> amount)</span> </span>{
        <span class="hljs-comment">// 封装日志实现</span>
    }
};
</code></pre>
<hr/>
<h3 data-id="heading-9"><strong>解决方案：正确的封装实践</strong></h3>
<h4 data-id="heading-10"><strong>1. 行为导向的接口设计</strong></h4>
<p><strong>提供操作而非数据访问：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 糟糕的设计：暴露数据成员</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BadTemperatureSensor</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-type">double</span> currentTemperature;  <span class="hljs-comment">// public数据成员！</span>
    <span class="hljs-type">double</span> minTemperature;
    <span class="hljs-type">double</span> maxTemperature;
};

<span class="hljs-comment">// 优秀的设计：封装行为</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GoodTemperatureSensor</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">double</span> currentTemperature_;
    <span class="hljs-type">double</span> minTemperature_;
    <span class="hljs-type">double</span> maxTemperature_;
    <span class="hljs-type">bool</span> isCalibrated_;

<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// 行为接口，而非数据访问</span>
    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">readTemperature</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">if</span> (!isCalibrated_) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">logic_error</span>(<span class="hljs-string">"传感器未校准"</span>);
        }
        <span class="hljs-keyword">return</span> currentTemperature_;
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">calibrate</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// 复杂的校准逻辑</span>
        isCalibrated_ = <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isInSafeRange</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">return</span> currentTemperature_ &gt;= minTemperature_ &amp;&amp; 
               currentTemperature_ &lt;= maxTemperature_;
    }
    
    <span class="hljs-comment">// 必要时提供受控的数据访问</span>
    <span class="hljs-function">TemperatureRange <span class="hljs-title">getSafeRange</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">return</span> {minTemperature_, maxTemperature_};
    }
};
</code></pre>
<h4 data-id="heading-11"><strong>2. 计算属性与延迟初始化</strong></h4>
<p><strong>封装复杂的数据访问逻辑：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentProcessor</span> {
<span class="hljs-keyword">private</span>:
    std::string content_;
    <span class="hljs-keyword">mutable</span> std::unique_ptr&lt;WordCount&gt; wordCountCache_;  <span class="hljs-comment">// 延迟计算</span>
    <span class="hljs-keyword">mutable</span> std::unique_ptr&lt;ReadabilityScore&gt; readabilityCache_;
    <span class="hljs-keyword">mutable</span> <span class="hljs-type">bool</span> isAnalyzed_ = <span class="hljs-literal">false</span>;

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setContent</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; content)</span> </span>{
        content_ = content;
        <span class="hljs-built_in">invalidateCaches</span>();  <span class="hljs-comment">// 状态变化时清理缓存</span>
    }
    
    <span class="hljs-comment">// 计算属性：看起来像数据，实则是计算</span>
    <span class="hljs-function"><span class="hljs-type">const</span> WordCount&amp; <span class="hljs-title">getWordCount</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">if</span> (!wordCountCache_) {
            wordCountCache_ = std::<span class="hljs-built_in">make_unique</span>&lt;WordCount&gt;(<span class="hljs-built_in">analyzeWords</span>());
        }
        <span class="hljs-keyword">return</span> *wordCountCache_;
    }
    
    <span class="hljs-function"><span class="hljs-type">const</span> ReadabilityScore&amp; <span class="hljs-title">getReadability</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">if</span> (!readabilityCache_) {
            <span class="hljs-built_in">ensureAnalysis</span>();  <span class="hljs-comment">// 确保分析完成</span>
            readabilityCache_ = std::<span class="hljs-built_in">make_unique</span>&lt;ReadabilityScore&gt;(<span class="hljs-built_in">calculateReadability</span>());
        }
        <span class="hljs-keyword">return</span> *readabilityCache_;
    }

<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">invalidateCaches</span><span class="hljs-params">()</span> </span>{
        wordCountCache_.<span class="hljs-built_in">reset</span>();
        readabilityCache_.<span class="hljs-built_in">reset</span>();
        isAnalyzed_ = <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ensureAnalysis</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">if</span> (!isAnalyzed_) {
            <span class="hljs-built_in">performDeepAnalysis</span>();
            isAnalyzed_ = <span class="hljs-literal">true</span>;
        }
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">performDeepAnalysis</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-comment">// 昂贵的分析操作</span>
    }
};
</code></pre>
<hr/>
<h3 data-id="heading-12"><strong>protected成员的陷阱</strong></h3>
<h4 data-id="heading-13"><strong>1. protected几乎等于public</strong></h4>
<p><strong>protected成员的封装性缺陷：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> {
<span class="hljs-keyword">protected</span>:
    <span class="hljs-type">int</span> protectedData_;  <span class="hljs-comment">// 以为比public好？</span>
    std::vector&lt;<span class="hljs-type">int</span>&gt; implementationDetails_;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Base</span>() = <span class="hljs-keyword">default</span>;
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">misuseProtected</span><span class="hljs-params">()</span> </span>{
        protectedData_ = <span class="hljs-number">42</span>;  <span class="hljs-comment">// 派生类可以任意修改</span>
        implementationDetails_.<span class="hljs-built_in">clear</span>();  <span class="hljs-comment">// 破坏基类实现假设</span>
    }
};

<span class="hljs-comment">// 问题：一旦修改Base的protected成员，所有派生类都需要修改！</span>
<span class="hljs-comment">// 封装性实际上和public差不多差</span>
</code></pre>
<h4 data-id="heading-14"><strong>2. 更好的替代方案</strong></h4>
<p><strong>使用private + 受保护的访问函数：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WellDesignedBase</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">int</span> implementationDetail_;
    std::vector&lt;<span class="hljs-type">int</span>&gt; internalData_;

<span class="hljs-keyword">protected</span>:
    <span class="hljs-comment">// 为派生类提供受控的扩展点</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">doProcess</span><span class="hljs-params">(<span class="hljs-type">int</span> data)</span> </span>{
        <span class="hljs-comment">// 默认实现</span>
        implementationDetail_ = data;
    }
    
    <span class="hljs-comment">// 只读访问给派生类</span>
    <span class="hljs-function"><span class="hljs-type">const</span> std::vector&lt;<span class="hljs-type">int</span>&gt;&amp; <span class="hljs-title">getInternalData</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">return</span> internalData_;
    }
    
    <span class="hljs-comment">// 受控的写入给派生类</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">safelyModifyData</span><span class="hljs-params">(<span class="hljs-type">size_t</span> index, <span class="hljs-type">int</span> value)</span> </span>{
        <span class="hljs-keyword">if</span> (index &lt; internalData_.<span class="hljs-built_in">size</span>()) {
            internalData_[index] = value;
            <span class="hljs-built_in">onDataModified</span>();  <span class="hljs-comment">// 通知机制</span>
        }
    }

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-type">int</span> data)</span> </span>{
        <span class="hljs-comment">// 参数验证、日志、性能监控...</span>
        <span class="hljs-built_in">doProcess</span>(data);
        <span class="hljs-comment">// 后处理、清理、通知...</span>
    }

<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">onDataModified</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// 状态变化处理</span>
    }
};
</code></pre>
<hr/>
<h3 data-id="heading-15"><strong>现代C++的封装增强</strong></h3>
<h4 data-id="heading-16"><strong>1. 移动语义的封装支持</strong></h4>
<p><strong>自动化的资源管理：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourceHolder</span> {
<span class="hljs-keyword">private</span>:
    std::unique_ptr&lt;ExpensiveResource&gt; resource_;
    std::vector&lt;<span class="hljs-type">int</span>&gt; data_;

<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// 移动操作的自动支持</span>
    <span class="hljs-built_in">ResourceHolder</span>(ResourceHolder&amp;&amp;) = <span class="hljs-keyword">default</span>;
    ResourceHolder&amp; <span class="hljs-keyword">operator</span>=(ResourceHolder&amp;&amp;) = <span class="hljs-keyword">default</span>;
    
    <span class="hljs-comment">// 拷贝操作需要显式处理</span>
    <span class="hljs-built_in">ResourceHolder</span>(<span class="hljs-type">const</span> ResourceHolder&amp; other) 
        : <span class="hljs-built_in">data_</span>(other.data_) {
        <span class="hljs-keyword">if</span> (other.resource_) {
            resource_ = std::<span class="hljs-built_in">make_unique</span>&lt;ExpensiveResource&gt;(*other.resource_);
        }
    }
    
    ResourceHolder&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-type">const</span> ResourceHolder&amp; other) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> != &amp;other) {
            data_ = other.data_;
            <span class="hljs-keyword">if</span> (other.resource_) {
                resource_ = std::<span class="hljs-built_in">make_unique</span>&lt;ExpensiveResource&gt;(*other.resource_);
            } <span class="hljs-keyword">else</span> {
                resource_.<span class="hljs-built_in">reset</span>();
            }
        }
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-comment">// 封装资源访问</span>
    <span class="hljs-function">ExpensiveResource&amp; <span class="hljs-title">getResource</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (!resource_) {
            <span class="hljs-built_in">initializeResource</span>();
        }
        <span class="hljs-keyword">return</span> *resource_;
    }
    
    <span class="hljs-function"><span class="hljs-type">const</span> ExpensiveResource&amp; <span class="hljs-title">getResource</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">if</span> (!resource_) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">logic_error</span>(<span class="hljs-string">"资源未初始化"</span>);
        }
        <span class="hljs-keyword">return</span> *resource_;
    }

<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">initializeResource</span><span class="hljs-params">()</span> </span>{
        resource_ = std::<span class="hljs-built_in">make_unique</span>&lt;ExpensiveResource&gt;();
        <span class="hljs-comment">// 复杂的初始化逻辑</span>
    }
};
</code></pre>
<h4 data-id="heading-17"><strong>2. 智能指针与所有权封装</strong></h4>
<p><strong>明确的所有权语义：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentManager</span> {
<span class="hljs-keyword">private</span>:
    std::vector&lt;std::shared_ptr&lt;Document&gt;&gt; documents_;
    std::unique_ptr&lt;Index&gt; searchIndex_;
    std::shared_ptr&lt;Cache&gt; globalCache_;

<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// 工厂方法：明确所有权转移</span>
    <span class="hljs-function">std::unique_ptr&lt;Document&gt; <span class="hljs-title">createDocument</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; title)</span> </span>{
        <span class="hljs-keyword">auto</span> doc = std::<span class="hljs-built_in">make_unique</span>&lt;Document&gt;(title);
        <span class="hljs-built_in">setupDocument</span>(*doc);
        <span class="hljs-keyword">return</span> doc;
    }
    
    <span class="hljs-comment">// 共享所有权：明确语义</span>
    <span class="hljs-function">std::shared_ptr&lt;Document&gt; <span class="hljs-title">addSharedDocument</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; title)</span> </span>{
        <span class="hljs-keyword">auto</span> doc = std::<span class="hljs-built_in">make_shared</span>&lt;Document&gt;(title);
        documents_.<span class="hljs-built_in">push_back</span>(doc);
        <span class="hljs-built_in">updateIndex</span>(*doc);
        <span class="hljs-keyword">return</span> doc;
    }
    
    <span class="hljs-comment">// 只读访问：不涉及所有权</span>
    <span class="hljs-type">const</span> std::vector&lt;std::shared_ptr&lt;Document&gt;&gt;&amp; <span class="hljs-built_in">getAllDocuments</span>() <span class="hljs-type">const</span> {
        <span class="hljs-keyword">return</span> documents_;
    }
    
    <span class="hljs-comment">// 封装缓存访问</span>
    <span class="hljs-function">std::shared_ptr&lt;Document&gt; <span class="hljs-title">findCachedDocument</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; id)</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> cached = globalCache_-&gt;<span class="hljs-built_in">get</span>(id)) {
            <span class="hljs-keyword">return</span> cached;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
    }

<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setupDocument</span><span class="hljs-params">(Document&amp; doc)</span> </span>{
        <span class="hljs-comment">// 私有设置逻辑</span>
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">updateIndex</span><span class="hljs-params">(<span class="hljs-type">const</span> Document&amp; doc)</span> </span>{
        <span class="hljs-comment">// 索引更新逻辑</span>
    }
};
</code></pre>
<hr/>
<h3 data-id="heading-18"><strong>实际工程中的平衡艺术</strong></h3>
<h4 data-id="heading-19"><strong>1. 性能与封装的平衡</strong></h4>
<p><strong>内联访问函数的合理使用：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vector3D</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">double</span> x_, y_, z_;

<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">Vector3D</span>(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y, <span class="hljs-type">double</span> z) : <span class="hljs-built_in">x_</span>(x), <span class="hljs-built_in">y_</span>(y), <span class="hljs-built_in">z_</span>(z) {}
    
    <span class="hljs-comment">// 内联访问函数 - 零开销抽象</span>
    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">x</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{ <span class="hljs-keyword">return</span> x_; }
    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">y</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{ <span class="hljs-keyword">return</span> y_; } 
    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">z</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{ <span class="hljs-keyword">return</span> z_; }
    
    <span class="hljs-comment">// 可内联的修改函数</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setX</span><span class="hljs-params">(<span class="hljs-type">double</span> x)</span> <span class="hljs-keyword">noexcept</span> </span>{ x_ = x; }
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setY</span><span class="hljs-params">(<span class="hljs-type">double</span> y)</span> <span class="hljs-keyword">noexcept</span> </span>{ y_ = y; }
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setZ</span><span class="hljs-params">(<span class="hljs-type">double</span> z)</span> <span class="hljs-keyword">noexcept</span> </span>{ z_ = z; }
    
    <span class="hljs-comment">// 复杂操作保持非内联</span>
    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">length</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    <span class="hljs-function">Vector3D <span class="hljs-title">normalized</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
};

<span class="hljs-comment">// 使用示例 - 性能与封装的完美结合</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">processVectors</span><span class="hljs-params">(<span class="hljs-type">const</span> std::vector&lt;Vector3D&gt;&amp; vectors)</span> </span>{
    <span class="hljs-type">double</span> totalX = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; vec : vectors) {
        totalX += vec.<span class="hljs-built_in">x</span>();  <span class="hljs-comment">// 内联调用，无性能损失</span>
    }
}
</code></pre>
<h4 data-id="heading-20"><strong>2. 实际测量指导设计</strong></h4>
<p><strong>基于性能数据的决策：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 通过性能测试证明封装的可行性</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ProfiledContainer</span> {
<span class="hljs-keyword">private</span>:
    std::vector&lt;<span class="hljs-type">int</span>&gt; data_;
    <span class="hljs-keyword">mutable</span> std::atomic&lt;<span class="hljs-type">size_t</span>&gt; accessCount_{<span class="hljs-number">0</span>};

<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> </span>{
        data_.<span class="hljs-built_in">push_back</span>(value);
    }
    
    <span class="hljs-comment">// 封装的访问函数</span>
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-type">size_t</span> index)</span> <span class="hljs-type">const</span> </span>{
        accessCount_.<span class="hljs-built_in">fetch_add</span>(<span class="hljs-number">1</span>, std::memory_order_relaxed);
        <span class="hljs-keyword">return</span> data_.<span class="hljs-built_in">at</span>(index);
    }
    
    <span class="hljs-function"><span class="hljs-type">size_t</span> <span class="hljs-title">getAccessCount</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">return</span> accessCount_.<span class="hljs-built_in">load</span>(std::memory_order_relaxed);
    }
    
    <span class="hljs-comment">// 性能关键路径的优化接口</span>
    <span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">int</span>* <span class="hljs-title">data</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{
        <span class="hljs-keyword">return</span> data_.<span class="hljs-built_in">data</span>();
    }
    
    <span class="hljs-function"><span class="hljs-type">size_t</span> <span class="hljs-title">size</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{
        <span class="hljs-keyword">return</span> data_.<span class="hljs-built_in">size</span>();
    }
};

<span class="hljs-comment">// 使用建议：在性能敏感处提供批量访问</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">highPerformanceOperation</span><span class="hljs-params">(<span class="hljs-type">const</span> ProfiledContainer&amp; container)</span> </span>{
    <span class="hljs-type">const</span> <span class="hljs-type">int</span>* rawData = container.<span class="hljs-built_in">data</span>();  <span class="hljs-comment">// 性能关键处</span>
    <span class="hljs-type">size_t</span> size = container.<span class="hljs-built_in">size</span>();
    
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; size; ++i) {
        <span class="hljs-comment">// 直接访问数据</span>
        <span class="hljs-built_in">processElement</span>(rawData[i]);
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-21"><strong>总结：封装的终极价值</strong></h3>
<p><strong>最终设计框架：</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 优秀封装的典范</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WellEncapsulatedClass</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// 所有数据成员都是private</span>
    std::string name_;
    std::vector&lt;<span class="hljs-type">double</span>&gt; measurements_;
    <span class="hljs-keyword">mutable</span> std::shared_mutex dataMutex_;
    std::unique_ptr&lt;ImplementationDetail&gt; pImpl_;  <span class="hljs-comment">// Pimpl惯用法</span>
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// 稳定的公有接口</span>
    <span class="hljs-built_in">WellEncapsulatedClass</span>(<span class="hljs-type">const</span> std::string&amp; name);
    ~<span class="hljs-built_in">WellEncapsulatedClass</span>() = <span class="hljs-keyword">default</span>;
    
    <span class="hljs-comment">// 禁止拷贝（或提供明确语义）</span>
    <span class="hljs-built_in">WellEncapsulatedClass</span>(<span class="hljs-type">const</span> WellEncapsulatedClass&amp;) = <span class="hljs-keyword">delete</span>;
    WellEncapsulatedClass&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-type">const</span> WellEncapsulatedClass&amp;) = <span class="hljs-keyword">delete</span>;
    
    <span class="hljs-comment">// 移动语义支持</span>
    <span class="hljs-built_in">WellEncapsulatedClass</span>(WellEncapsulatedClass&amp;&amp;) = <span class="hljs-keyword">default</span>;
    WellEncapsulatedClass&amp; <span class="hljs-keyword">operator</span>=(WellEncapsulatedClass&amp;&amp;) = <span class="hljs-keyword">default</span>;
    
    <span class="hljs-comment">// 行为导向的接口</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">performCalculation</span><span class="hljs-params">(<span class="hljs-type">double</span> parameter)</span></span>;
    <span class="hljs-function">std::future&lt;Result&gt; <span class="hljs-title">performAsyncCalculation</span><span class="hljs-params">(<span class="hljs-type">double</span> parameter)</span></span>;
    
    <span class="hljs-comment">// 受控的属性访问</span>
    <span class="hljs-function"><span class="hljs-type">const</span> std::string&amp; <span class="hljs-title">getName</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{ <span class="hljs-keyword">return</span> name_; }
    <span class="hljs-function">std::vector&lt;<span class="hljs-type">double</span>&gt; <span class="hljs-title">getMeasurements</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    
    <span class="hljs-comment">// 计算属性</span>
    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isValid</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">getAverage</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    
    <span class="hljs-comment">// 状态查询</span>
    <span class="hljs-function"><span class="hljs-type">size_t</span> <span class="hljs-title">getMeasurementCount</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    
<span class="hljs-keyword">protected</span>:
    <span class="hljs-comment">// 为派生类提供的扩展点</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">onCalculationComplete</span><span class="hljs-params">(<span class="hljs-type">const</span> Result&amp; result)</span></span>;
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// 实现细节完全隐藏</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">validateState</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">updateInternalCache</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">logOperation</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; operation)</span> <span class="hljs-type">const</span></span>;
};

<span class="hljs-comment">// 使用示例：客户端代码只依赖稳定接口</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">clientCode</span><span class="hljs-params">(WellEncapsulatedClass&amp; obj)</span> </span>{
    obj.<span class="hljs-built_in">performCalculation</span>(<span class="hljs-number">42.0</span>);
    <span class="hljs-keyword">auto</span> avg = obj.<span class="hljs-built_in">getAverage</span>();  <span class="hljs-comment">// 封装的计算属性</span>
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-built_in">isValid</span>()) {
        <span class="hljs-comment">// 使用对象...</span>
    }
}
</code></pre>
<p><strong>最终建议：</strong> 将private成员变量视为类的"实现宪法"——它定义了内部实现的边界和规则。通过严格的封装，我们获得了改变实现的自由、维护不变式的保证和演进设计的弹性。在C++中，将成员变量声明为private不是风格选择，而是专业素养的体现。</p>
<p>记住：<strong>封装的价值不在于今天能做什么，而在于明天能改变什么。</strong> 条款22教会我们的不仅是一种技术实践，更是面向未来软件设计的智慧。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[普通人如何免费使用Gemini3-Pro大模型？]]></title>    <link>https://juejin.cn/post/7574105194167910446</link>    <guid>https://juejin.cn/post/7574105194167910446</guid>    <pubDate>2025-11-19T10:26:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574105194167910446" data-draft-id="7574244766423711753" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" 普通人如何免费使用Gemini3-Pro大模型？"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-11-19T10:26:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Java中文社群"/> <meta itemprop="url" content="https://juejin.cn/user/61228381386487"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             普通人如何免费使用Gemini3-Pro大模型？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/61228381386487/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Java中文社群
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T10:26:04.000Z" title="Wed Nov 19 2025 10:26:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>大模型的用法主要分为以下两类：</p>
<ol>
<li><strong>个人用途</strong>：作为日常知识补充、内容创作及辅助工具。</li>
<li><strong>商业用途</strong>：集成至 Dify、Coze 等工作流与应用程序中，或在编程工具及第三方客户端（如 Cherry Studio）中使用。</li>
</ol>
<p>目前，<strong>普通用户几乎可以免费使用各类主流大模型</strong>，Google 最新推出的 Gemini 3 Pro 也不例外。</p>
<h2 data-id="heading-0">使用方法</h2>
<ol>
<li><strong>访问 AI Studio 官网</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Faistudio.google.com%2F" target="_blank" title="https://aistudio.google.com/" ref="nofollow noopener noreferrer">aistudio.google.com/</a></li>
<li><strong>注册并登录 Google 账号</strong></li>
</ol>
<p>登录后，即可免费通过 Gemini 3 Pro 进行对话，或完成代码生成任务。</p>
<p>此外，Google 还提供了其他免费模型，支持图片生成与编辑、音视频制作，甚至播客生成功能。</p>
<p>例如，生成图片可以使用 Google 的 Imagen，视频生成则可以使用 Veo 等模型。</p>
<h2 data-id="heading-1">视频演示</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV14ByjBqEAS%2F" target="_blank" title="https://www.bilibili.com/video/BV14ByjBqEAS/" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV14B…</a></p>
<h2 data-id="heading-2">对话演示</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b148c537f3594584b82237e732d26092~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152764&amp;x-signature=FZru96stpdtxBQseniKeKv04bD4%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a44c55d622b84b60a3b3d7818eca111e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152764&amp;x-signature=B%2B6U6DQi4PFEzEqhG8uGwzSzkFY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">图片生成</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cc3b912ff4c465d93e05299b00cda4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152764&amp;x-signature=uB3kow8Aexel76EsOLU5ClWjRD0%3D" alt="" loading="lazy"/></p>
<p>视频与音频的生成方式与此类似，此处不再赘述。</p>
<h2 data-id="heading-4">代码生成（App / 网站 / 小游戏开发）</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/982a2c2350ef4fe3b1732c87c80dfd9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152764&amp;x-signature=YRG7ioQYzCywBv3vh26oJ2PsDKY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0908336ba7f140b8ade0c02aa0c18f31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764152764&amp;x-signature=lsHFJ4iWhiq0KktvLWTHUPU9OEw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">小结</h2>
<p>本文简要介绍了 Google Gemini 3 Pro 的免费使用渠道，及其在文本对话、代码编写及多模态生成方面的核心功能。</p>
<blockquote>
<p>本文已收录到我的技术小站 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.javacn.site" target="_blank" title="https://www.javacn.site" ref="nofollow noopener noreferrer">www.javacn.site</a>，其中包含的内容有：Spring AI、Spring AI Alibaba、LangChain4j、Dify、Coze、N8N、智能体（AI Agent）、MCP、Function Call、RAG、向量数据库、Prompt、多模态、向量数据库、嵌入模型、AI 常见面试问题等内容。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[基本数据类型Symbol的基本应用场景]]></title>    <link>https://juejin.cn/post/7574250031248637986</link>    <guid>https://juejin.cn/post/7574250031248637986</guid>    <pubDate>2025-11-19T10:32:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574250031248637986" data-draft-id="7574251313883332623" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="基本数据类型Symbol的基本应用场景"/> <meta itemprop="keywords" content="前端,JavaScript,面试"/> <meta itemprop="datePublished" content="2025-11-19T10:32:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="拉不动的猪"/> <meta itemprop="url" content="https://juejin.cn/user/1429793504759630"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            基本数据类型Symbol的基本应用场景
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1429793504759630/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    拉不动的猪
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T10:32:42.000Z" title="Wed Nov 19 2025 10:32:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p><code>Symbol</code> 作为 ES6 新增的基本数据类型，核心特性是<strong>唯一性</strong>和<strong>不可枚举性</strong>，在实际项目中主要用于解决命名冲突、保护对象私有属性等场景。以下是具体的应用举例及代码实现：</p>
<h3 data-id="heading-0">一、作为对象的唯一属性名，避免属性冲突</h3>
<p>当多人协作开发或引入第三方库时，普通字符串属性名容易被覆盖，<code>Symbol</code> 可确保属性唯一。</p>
<h4 data-id="heading-1">示例：组件库的私有属性</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 定义唯一的 Symbol 属性</span>
<span class="hljs-keyword">const</span> internalState = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'internalState'</span>);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Button</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 用 Symbol 作为私有属性名，外部无法直接访问</span>
    <span class="hljs-variable language_">this</span>[internalState] = {
      <span class="hljs-attr">clicked</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">disabled</span>: <span class="hljs-literal">false</span>
    };
  }

  <span class="hljs-title function_">click</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>[internalState].<span class="hljs-property">disabled</span>) {
      <span class="hljs-variable language_">this</span>[internalState].<span class="hljs-property">clicked</span> = <span class="hljs-literal">true</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'按钮被点击'</span>);
    }
  }

  <span class="hljs-title function_">disable</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>[internalState].<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
  }
}

<span class="hljs-keyword">const</span> btn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Button</span>();
btn.<span class="hljs-title function_">click</span>(); <span class="hljs-comment">// 正常执行</span>

<span class="hljs-comment">// 外部无法通过常规方式访问或修改 internalState</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(btn.<span class="hljs-property">internalState</span>); <span class="hljs-comment">// undefined</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(btn[<span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'internalState'</span>)]); <span class="hljs-comment">// undefined（Symbol 是唯一的）</span>
</code></pre>
<h3 data-id="heading-2">二、定义常量，避免魔术字符串</h3>
<p>魔术字符串（直接写在代码中的字符串）易出错且难维护，用 <code>Symbol</code> 定义唯一常量更可靠。</p>
<h4 data-id="heading-3">示例：状态管理中的事件类型</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// event-types.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">EVENT_TYPES</span> = {
  <span class="hljs-attr">LOGIN</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'login'</span>),
  <span class="hljs-attr">LOGOUT</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'logout'</span>),
  <span class="hljs-attr">UPDATE_USER</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'updateUser'</span>)
};

<span class="hljs-comment">// 使用常量</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleEvent</span>(<span class="hljs-params">eventType</span>) {
  <span class="hljs-keyword">switch</span> (eventType) {
    <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">EVENT_TYPES</span>.<span class="hljs-property">LOGIN</span>:
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'用户登录'</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">EVENT_TYPES</span>.<span class="hljs-property">LOGOUT</span>:
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'用户登出'</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-attr">default</span>:
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'未知事件'</span>);
  }
}

<span class="hljs-title function_">handleEvent</span>(<span class="hljs-variable constant_">EVENT_TYPES</span>.<span class="hljs-property">LOGIN</span>); <span class="hljs-comment">// 输出“用户登录”</span>
</code></pre>
<h3 data-id="heading-4">三、实现对象的 “私有属性”</h3>
<p>虽然 JavaScript 没有真正的私有属性，但 <code>Symbol</code> 属性默认不可被 <code>for...in</code>、<code>Object.keys()</code> 枚举，可模拟私有属性。</p>
<h4 data-id="heading-5">示例：类的私有方法 / 属性</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> privateMethod = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'privateMethod'</span>);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// 公共属性</span>
    <span class="hljs-variable language_">this</span>[<span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'id'</span>)] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>().<span class="hljs-title function_">toString</span>(<span class="hljs-number">36</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>); <span class="hljs-comment">// 私有属性</span>
  }

  [privateMethod]() {
    <span class="hljs-comment">// 私有方法，外部无法调用</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">`用户ID：<span class="hljs-subst">${<span class="hljs-variable language_">this</span>[<span class="hljs-built_in">Symbol</span>(<span class="hljs-string">'id'</span>)]}</span>`</span>;
  }

  <span class="hljs-title function_">getInfo</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 公共方法间接调用私有方法</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> - <span class="hljs-subst">${<span class="hljs-variable language_">this</span>[privateMethod]()}</span>`</span>;
  }
}

<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">'Alice'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-title function_">getInfo</span>()); <span class="hljs-comment">// 正常输出</span>

<span class="hljs-comment">// 无法枚举 Symbol 属性</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(user)); <span class="hljs-comment">// ['name']</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> user) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// 仅输出 'name'</span>
}
</code></pre>
<h3 data-id="heading-6">四、自定义迭代器（Iterator）</h3>
<p><code>Symbol.iterator</code> 是内置 Symbol，用于定义对象的迭代器，让对象可被 <code>for...of</code> 遍历。</p>
<h4 data-id="heading-7">示例：自定义可迭代对象</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">const</span> iterableObj = {
  <span class="hljs-keyword">data</span>: [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>],
  [Symbol.iterator]() {
    let index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> {
      next: () =&gt; {
        <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.length) {
          <span class="hljs-keyword">return</span> { value: <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>[index++], done: <span class="hljs-literal">false</span> };
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> { done: <span class="hljs-literal">true</span> };
        }
      }
    };
  }
};

<span class="hljs-comment">// 可通过 for...of 遍历</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item of iterableObj) {
  console.log(item); <span class="hljs-comment">// 输出 a、b、c</span>
}
</code></pre>
<h3 data-id="heading-8">五、Vue 中的应用：自定义组件的 v-model 修饰符</h3>
<p>在 Vue 3 中，可通过 <code>Symbol</code> 定义自定义的 <code>v-model</code> 修饰符，避免与内置修饰符冲突。</p>
<h4 data-id="heading-9">示例：Vue 组件的自定义修饰符</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 定义唯一的修饰符 Symbol</span>
<span class="hljs-keyword">const</span> trimSymbol = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'trim'</span>);

<span class="hljs-comment">// 组件内</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">modelValue</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">modelModifiers</span>: {
      <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> ({})
    }
  },
  <span class="hljs-attr">emits</span>: [<span class="hljs-string">'update:modelValue'</span>],
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">handleInput</span>(<span class="hljs-params">e</span>) {
      <span class="hljs-keyword">let</span> value = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>;
      <span class="hljs-comment">// 判断是否使用自定义修饰符</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">modelModifiers</span>[trimSymbol]) {
        value = value.<span class="hljs-title function_">trim</span>();
      }
      <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">'update:modelValue'</span>, value);
    }
  }
};
</code></pre>
<h3 data-id="heading-10">总结</h3>
<p><code>Symbol</code> 在项目中的核心应用场景包括：</p>
<ol>
<li><strong>避免属性名冲突</strong>（多人协作 / 第三方库集成）；</li>
<li><strong>模拟私有属性 / 方法</strong>（不可枚举特性）；</li>
<li><strong>定义唯一常量</strong>（替代魔术字符串）；</li>
<li><strong>扩展内置对象行为</strong>（如自定义迭代器）。</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【AI省流快讯】Cloudflare 炸了 / Gemini 3 来了 / Antigravity 独家实测 (附：无法登录解法)]]></title>    <link>https://juejin.cn/post/7574269207362224137</link>    <guid>https://juejin.cn/post/7574269207362224137</guid>    <pubDate>2025-11-19T10:30:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574269207362224137" data-draft-id="7574271557938970675" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【AI省流快讯】Cloudflare 炸了 /  Gemini 3 来了 / Antigravity 独家实测 (附：无法登录解法)"/> <meta itemprop="keywords" content="Gemini,AI编程,Google"/> <meta itemprop="datePublished" content="2025-11-19T10:30:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coder_pig"/> <meta itemprop="url" content="https://juejin.cn/user/4142615541321928"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【AI省流快讯】Cloudflare 炸了 /  Gemini 3 来了 / Antigravity 独家实测 (附：无法登录解法)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4142615541321928/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coder_pig
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T10:30:58.000Z" title="Wed Nov 19 2025 10:30:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">1. Cloudflare 挂了</h2>
<p>🤡 昨晚陆续刷到 "<strong>CF挂了</strong>" 的消息，没太在意，直到无法打开" <strong>盗版漫画</strong>" 站点，我才意识到问题的严重性：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f748a25110f745e18f7b1384cef114e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=RhfitPTrWxlvE30pX%2BQsSIBqTDA%3D" alt="" loading="lazy"/></p>
<p>🤣 原因众说纷纭，刷到这哥们的 "<strong>梗图</strong>"，差点把我笑岔气：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d79cda89bb24524ab7ea35be3eaa356~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=s64p2kBzFwzuFJ4NryZHtTIlLj0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49acdbcad2224b208e374262b2e89296~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=6rG0YCpJ8IA37T4eYHPq8B0EJfs%3D" alt="" loading="lazy"/></p>
<p>😃 还有人猜测可能是 <strong>Google</strong> 发布的 "<strong>哈基米 3</strong>" (Gemini) 发起的攻击：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6524514e494417fbbedb925046bbed1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=GjhQ9DPUP6Fy3L%2BHrPGeOcA9Pso%3D" alt="" loading="lazy"/></p>
<p><strong>时间线</strong>：</p>
<ul>
<li>【<strong>19:30</strong>】用户开始报告网站无法访问，出现10xx、52x、50x系列错误；Cloudflare Dashboard无法访问；部分Cloudflare域名解析中断。</li>
<li>【<strong>19:48</strong>】Cloudflare正式确认服务异常，启动紧急调查。</li>
<li>【<strong>20:03</strong>】持续调查中，未发现明显进展。</li>
<li>【<strong>20:13</strong>】部分服务开始恢复，但错误率仍高于正常水平。</li>
<li>【<strong>20:21</strong>】监测到部分服务恢复迹象；多次反复出现故障与恢复的波动；20:23、20:55等时间点再次中断。</li>
<li>【<strong>21:04</strong>】技术团队紧急关闭伦敦节点的WARP服务接入以控制影响范围。</li>
<li>【<strong>21:09</strong>】官方确认定位到根本原因，开始实施修复方案。</li>
<li>【<strong>21:13</strong>】Cloudflare Access与WARP服务全面恢复，错误率回落至日常水平。</li>
<li>【<strong>22:12</strong>】X应用恢复。</li>
<li>【<strong>22:22</strong>】Cloudflare状态页更新："我们正在继续努力修复此问题"。</li>
<li>【<strong>22:34</strong>】状态页再次更新："我们已经部署了一项变更，已恢复仪表板服务。我们仍在努力解决对整体应用服务的影响"。</li>
<li>【<strong>22:42</strong>】全局恢复完成，Cloudflare宣布事件解决，后续监控与处理继续进行中。</li>
</ul>
<p><strong>Cloudflare</strong> 发言人 <strong>Jackie Dutton</strong>在官方声明中表示，故障源于一个 <strong>用于管理威胁流量的自动生成配置文件</strong>。该配置文件原本用于防护潜在安全威胁，但由于文件规模异常庞大，导致多项内部系统在处理流量时发生故障：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89ff32267d3a46e380cc98d00e98437d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=buCsRzkkodHdPmWdqRcioN2r0C8%3D" alt="" loading="lazy"/></p>
<p>截止目前，<strong>Cloudflare</strong> 全球网络服务已全面恢复，受影响的X、ChatGPT、Facebook 等主流平台均已恢复正常使用。😀 在网上看到大佬的原因分析，也贴下：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/988ad6de08034117af68196690d7c032~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=6zQX0kwjkKef24hkdTEZ9baL640%3D" alt="" loading="lazy"/></p>
<p>😆 难兄难弟啊，前阵子 <strong>亚马逊AWS</strong> 的大规模宕机 (10.20，<strong>美东区域数据库权限和DNS管理系统配置故障</strong>)，故障持续约15小时，直接造成全球互联网大面积混乱。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f313f43c8ffc40d48bbd61aa4552ef34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=tXwqQqB9puuYwH%2B4WWOu9ezVCkQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">2. Gemini 3 来了</h2>
<p>😄 千呼万唤的 "<strong>哈基米 3</strong>" (<strong>Gemini</strong>) 终于来了，不过竟然没搞个发布会，只是在 <strong>官方博客</strong> 发下文章：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.google%2Fproducts%2Fgemini%2Fgemini-3%2F%23note-from-ceo" target="_blank" title="https://blog.google/products/gemini/gemini-3/#note-from-ceo" ref="nofollow noopener noreferrer">《A new era of intelligence with Gemini 3》</a></p>
<p>先简要回顾了一下 Gemini 系列的发展历程：</p>
<ul>
<li><strong>Gemini 1</strong>：着重在 "<strong>原生多模态</strong>" (文本+图像) 和 "<strong>长上下文窗口</strong>"。</li>
<li><strong>Gemini 2</strong>：开始推动 "<strong>智能代理式 (agentic)</strong> " 与 "<strong>推理与思考</strong>" 能力。</li>
</ul>
<p><strong>Gemini 3</strong> 在上述基础上进一步提升，方称其为迄今 "<strong>最智能、最安全</strong>" 的模型：</p>
<ul>
<li><strong>推理能力 &amp; 多模态理解</strong>：在各种 AI 基准测试 (benchmarks) 上表现优异：LMArena (1501 Elo)、GPQA Diamond (91.9%)、MMMU-Pro (81%)、Video-MMMU (87.6%)、SimpleQA Verified (72.1%)。<strong>模型能更好理解背景、意图，给予更有深度、少空话的回答</strong>。</li>
<li><strong>Gemini 3 Deep Think</strong>："<strong>深思</strong>" 增强模式，可进行更深的链式推理、更强代码执行与工具调用，提升复杂问题的求解能力，Humanity's Last Exam (41.0%)、GPQA Diamond (93.8%)、ARC-AGI-2 (带代码执行，45.1%)。该模式将在数周内向 <strong>Google AI Ultra</strong> 订阅用户开放。</li>
</ul>
<hr/>
<p><strong>三大应用场景</strong></p>
<p>① <strong>学习</strong></p>
<ul>
<li>模型支持文本、图像、视频、音频、代码等多模态输入，<strong>100w token</strong> 的上下文窗口。</li>
<li>如：可将手写不同语言的食谱翻译并制作家庭食谱；分析视频运动比赛 (如Picklebal) 帮助你提高训练。</li>
<li>可在 Google 搜索中的 "AI Mode" 借助 Gemini 3 提供生成式 UI、互动工具、仿真体验。</li>
</ul>
<p>② <strong>构建</strong></p>
<ul>
<li>强 "<strong>零样本生成</strong>" 能力：不用给示例、不用教，只说想法，直接生成你想要的东西。能处理复杂 <strong>提示/指令</strong> (提示/指令)，生成更丰富、互动性更强的 <strong>Web UI</strong>。基准测试：WebDev Arena (比谁能更好地完成Web开发任务，1487 Elo，战绩亮眼)、Terminal-Bench 2.0 (54.2%，命令行处理真实开发任务的能力)、SWE-bench Verified (软件工程能力-修bug、补功能，76.2%-非常高，大部分模型在30%-40%)。</li>
<li>可在 Google 的 AI Studio、Vertex AI、Gemini CLI、以及新出的 AI IDE-<strong>Google Antigravity</strong> 中使用。第三方平台也支持，如：Cursor、GitHub、JetBrains、Manus、Replit 等。</li>
</ul>
<p>③ <strong>计划</strong></p>
<ul>
<li>在长期多步骤任务中表现提升，如：Vending-Bench 2 中可 "模拟一年" 运营决策。</li>
<li>新增 <strong>Gemini Agent</strong> 工具，能够代表用户自动完成多步骤复杂任务，如管理邮箱、自动化工作流程和旅行计划，且仍受用户控制。已向 Google AI Ultra 用户开放早期体验。</li>
</ul>
<p>😄 打开 <strong>ai.studio</strong> 直接就能看到最新的模型了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff8e7beb48634a0984bc90a9d431803f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=bQ5lG9ujfbKDlQkAuD0MadilBfo%3D" alt="" loading="lazy"/></p>
<hr/>
<p><strong>谷歌官方</strong> 在演示中展示了三个 <strong>Vibe Coding</strong> 例子：</p>
<ul>
<li><strong>AI 课程平台登录页</strong>：通过简单 Prompt ("新布鲁特主义风格，创意有趣设计，平滑滚动动画，谷歌色彩，深浅主题")，直接生成了一个完整的、具有动画效果和深浅主题切换的登陆页。</li>
<li><strong>SaaS 数据看板</strong>：用户上传 CSV 数据文件和参考设计截图，自动生成了一个具有图表、筛选器、深色主题的专业数据仪表盘。</li>
<li><strong>互动游戏</strong>：通过复杂 Prompt (涉及React、Three.js、3D 效果等技术细节)，生成一个完全可玩的3D游戏。</li>
</ul>
<p>😄 国内 <strong>自媒体</strong> 基本都是在吹它的 "<strong>前端能力</strong>" (看效果图确实挺6的)：</p>
<ul>
<li><strong>能生成精确的 SVG 矢量图</strong>：包括复杂的动画 SVG (如：旋转风扇动画)，而非简单栅格图。</li>
<li><strong>3D 和动画</strong>：支持生成 Three.js 3D 模型、WebGL 着色器、CSS 动画等高级视觉效果。</li>
<li><strong>完成应用框架</strong>：能理解复杂的技术栈要求 (React、Three.js Fiber、TypeScript 等)，生成模块化、结构清晰的代码。</li>
<li><strong>注解修改</strong>：用户可以在生成的界面上用 "<strong>标注</strong>" 的方式指出要修改的地方 (画圈、画箭头、添加文字)，Gemini 3 会理解这些视觉标注并精确修改代码。这得益于它 <strong>多模态理解能力的显著提升</strong> (对屏幕截图的理解准确率达到 72.7%，达到现有水平的两倍)。</li>
<li>去 "<strong>AI味</strong>"：排版、色彩搭配、组件结构看起来是 "<strong>精心设计</strong>" 的，而非生硬地套模版。</li>
</ul>
<p>🤔 目前杰哥还没 <strong>深度体验</strong> 这个新模型，不好评价，只实测下这个新出的 <strong>AI IDE</strong> —— <strong>Antigravity</strong> 吧~</p>
<h2 data-id="heading-2">3. Google Antigravity (反重力)</h2>
<h3 data-id="heading-3">3.1. 下载安装</h3>
<p>下载地址：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fantigravity.google%2Fdownload" target="_blank" title="https://antigravity.google/download" ref="nofollow noopener noreferrer">下载 Google Antigravity</a></p>
<p>下载完双击安装：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f0dc3095dc44b0ca0cf7881e2dfa495~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=kwoZJSv81rSQxDuzvI%2FF38LtVRA%3D" alt="" loading="lazy"/></p>
<p>接着是不断按 <strong>Next</strong> 的 傻瓜式安装 (是否从VS Code 或 Cursor 导入设置)：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8dc4c77c9e34df99ccbaa8b27c51700~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=1Ssd75koLOp6fKurn%2Fy3JFOVSV0%3D" alt="" loading="lazy"/></p>
<p>选主题：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbfa6864490e410a92e293cfea5e5aa1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=7Ad3Axa37kqze56yGn1UcOSSgRg%3D" alt="" loading="lazy"/></p>
<p>选使用 Agent 的方式 &amp; 编辑器配置 (默认就好)：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c27ef240035948b8b5dd6a919dbc0bda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=n%2Fzd%2FXpuLQNN%2F4EV%2FbFDjzvlFHY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d819d869d2fc4d78a71be79c518cd8bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=UFhdQWhVVn44M4kfjiyRAnDUKhA%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e29f64e784e242d98edc6fe2ccf8c01f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=8SYQkCeGPtetJBupezBUMqjcO%2BU%3D" alt="" loading="lazy"/></p>
<p>😐 最后，大部分人会卡在登录这里，杰哥也是折腾了一早上，买了两个号才登上的。</p>
<h3 data-id="heading-4">3.2. 登录问题的解决</h3>
<h4 data-id="heading-5">3.2.1. 代理问题</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8aedbbd65c5f421097cf88fc3cbdc74e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=HCIdOwy7%2BWZ8QFzLJOtHnHggpaI%3D" alt="" loading="lazy"/></p>
<p>如图，先检查 <strong>TUN</strong> (全局/系统代理) 模式有没有开：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a105dc54916a4eaba80112af781f414a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=8buUN4h4aZLviQZdGm7pJDhYabE%3D" alt="" loading="lazy"/></p>
<p>接着看 <strong>代理</strong> 的 "<strong>地区</strong>"，香港是不行滴，群里有人说新加坡/日本可以，杰哥用的 <strong>美国</strong>，其次是 <strong>代理</strong> 的 "<strong>质量</strong>"。</p>
<h4 data-id="heading-6">3.2.2. 账号问题</h4>
<p>代理没问题了，基本是能自动打开浏览器，跳转到授权页，然后授权成功的：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7d15c6205f9441ca7c151d1ac13d880~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=z%2FsANOzmUusQfkWxEEB0fQMKmHU%3D" alt="" loading="lazy"/></p>
<p>接着返回 <strong>Antigravity</strong> 可能会出现这两种情况：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a922254431f443999cc54221b18fcd9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=gYQD%2BV%2FBV58yoVV0n%2B0%2FSUxK3Vw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9e8c2b4d91b4980a2cdf8c443443e36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=pZqoAo9vtyU3X7ad0RDCMXWDoNk%3D" alt="" loading="lazy"/></p>
<p>这极大概率就是 "<strong>Google账号</strong>" 的问题，先访问下述网址，查看：<strong>账号当前的国家或地区版本</strong>。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpolicies.google.com%2Fterms" target="_blank" title="https://policies.google.com/terms" ref="nofollow noopener noreferrer">《Google 服务条款》</a></p>
<p>比如我的号：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1aea0ee7bad142fe960251670e891fba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=MXjUnJwVP7NG0OvFXRebhgzAgG0%3D" alt="" loading="lazy"/></p>
<p>🤷‍♀️ 香港肯定是不行的，可以访问下述地址申请修改 (<strong>一年只能改一次</strong> ❗️)</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpolicies.google.com%2Fcountry-association-form" target="_blank" title="https://policies.google.com/country-association-form" ref="nofollow noopener noreferrer">《账号关联地区更改请求》</a></p>
<p>具体操作：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa8f276cf54f49758a266c5e50362190~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=Bky2plOergs8HLeir88atWqCRAU%3D" alt="" loading="lazy"/></p>
<p>😐 改完，如果还不行的话，那应该是 "<strong>账号本身有问题</strong>" 或者触发了 Google 莫名其妙的拦截规则。我一开始在海鲜市场买了一个 "<strong>美区</strong>" 的老号，一直卡 Setting Up 那里转。后面又收了个 "<strong>日区</strong>" 的号，<strong>秒进</strong> ❗️❗️❗️</p>
<p>😄 还有个群友提供了一个野路子：</p>
<p>登Google play，在美区买本0刀的免费电子书，就成美区了。</p>
<p>💡 反正进不去，就是 "<strong>代理</strong>" 和 "<strong>账号</strong>" 的问题！我现在的组合是：<strong>日区号</strong> + <strong>美国代理</strong>。都没问题，会进入这个是否允许采集信息的页面，取消勾选，然后 <strong>Next</strong>：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46ec84fc6f5d4c4b8d0fe7b6876ccb17~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=C5nZ8jS4JigiH0BAZPsGe8alKB4%3D" alt="" loading="lazy"/></p>
<p>接着就能来到 IDE 的主页面了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44095ca4aad04315bec4ce9561c06630~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=CnSEeGObforRnUv1i5MP466ho04%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">3.3. 初体验</h3>
<p>🤣 熟悉的 <strong>VS Code</strong> 套壳界面，还是很有亲切感的，右侧有常规的 <strong>AI Chat</strong>：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20ee9dc59df6427e95e9b15dd02a00b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=icRMFpuRxmEjzevAoQe2C6z1CbU%3D" alt="" loading="lazy"/></p>
<p>除了选模型外，还支持选模式：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/734458dbaae9403185b718c9bb5c3d8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=n2DbCetTmD83npgHvEOh8M8N6rs%3D" alt="" loading="lazy"/></p>
<p>按 <strong>Ctrl + E</strong> 可以打开类似于 <strong>Cursor Agents</strong> 模式的 "<strong>Agent Manager</strong>"：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf2165fbcb0942a2b611b44c51bd0527~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=eztvDb0o6T8x5tQCrFTiNaDrVnE%3D" alt="" loading="lazy"/></p>
<p>上面我写了一个，让 <strong>Antigravity</strong> 基于 <strong>Claudeflare</strong> 故障信息生成一个用于发布到 <strong>自媒体平台</strong> 的长图的 简单的<strong>Prompt</strong>，发送后可以看到 <strong>Agent</strong> 开始干活：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/393aa9190306494a97aa300d3998f6cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=L9MvNVyJSPxQEZYUCjnWUDYSuus%3D" alt="" loading="lazy"/></p>
<p>涉及到命令执行，让你 <strong>Accept</strong>：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64a13d2ee6cb49288740bf93b7c16b03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=O%2B0Axuewk0RhPprdufgibVcQ0Nc%3D" alt="" loading="lazy"/></p>
<p>觉得烦可以点下右侧切成 <strong>Turbo</strong> 模式：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c861f98ad38e450b91efe5a67ced3a32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=rvmMZV%2BSF2eiBx1h9jVUPytMFfQ%3D" alt="" loading="lazy"/></p>
<p>活干完，要预览，跳转 <strong>Chrome</strong>，提示安装一个 <strong>浏览器插件</strong>：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/196ca0fb0165477f9f0453a0fab04956~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=fN%2FnXzqWoXaX6WwkC9CTLwrcCmY%3D" alt="" loading="lazy"/></p>
<p>以便 <strong>Agent</strong> 能直接操作浏览器 (如获取页面节点、自动化、截图等)。最后看下生成效果：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a32643ee997849a7be4d3c4996e1544e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=V%2BQlgfFsKO5EmxQ1QbhTYAwWvgs%3D" alt="" loading="lazy"/></p>
<p>🤔 同样的 <strong>Prompt</strong>，分别看下 <strong>Claude 4.5</strong> 和 <strong>GPT 5</strong> 的生成效果：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b25d3fc7d5ca417fb77f144352b9362f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=OW%2FxxbNu0St16S8CB5BXRs5yL6k%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/809e7c2d40034f6e969a482a9891ec7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=z6Ghp%2BpSHGIYQRXegMr%2BDU6h9Sk%3D" alt="" loading="lazy"/></p>
<p>🤣 哈哈，你更 <strong>Pick</strong> (喜欢) 哪个模型生成的页面呢？</p>
<h3 data-id="heading-8">3.4. 限额</h3>
<p>群里有小伙伴没蹬几次就出现了这个：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7df96168e4874941879e8d340f502648~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=oD6wZoaXXqj5IXH2nJgSwKR8oWU%3D" alt="" loading="lazy"/></p>
<p>看了下官网：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fantigravity.google%2Fdocs%2Fplans" target="_blank" title="https://antigravity.google/docs/plans" ref="nofollow noopener noreferrer">《Google Antigravity Plans》</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/682036ffc70f48bb9f1178dc4fdfb269~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764153058&amp;x-signature=%2FcupRa9MTgvovy1%2FJQ0EXGBqxS8%3D" alt="" loading="lazy"/></p>
<p>💡 <strong>额度</strong> 由Google动态决定 (基于系统容量、防止滥用)，每五小时刷新一次，额度与任务复杂度相关。🐶 官方表示：只有 <strong>极少数高强度用户</strong> 会撞到每5小时上限。</p>
<p>😄 所以这个额度是 "<strong>不透明</strong>" 的，<strong>L站</strong> 有人说不一定得等五个小时，等了十几分钟又可以用了~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[第4章：布局类组件 —— 4.8 LayoutBuilder、AfterLayout]]></title>    <link>https://juejin.cn/post/7574245788948709391</link>    <guid>https://juejin.cn/post/7574245788948709391</guid>    <pubDate>2025-11-19T09:03:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574245788948709391" data-draft-id="7574245883634810932" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="第4章：布局类组件 —— 4.8 LayoutBuilder、AfterLayout"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-11-19T09:03:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="旧时光_"/> <meta itemprop="url" content="https://juejin.cn/user/4442458669718279"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            第4章：布局类组件 —— 4.8 LayoutBuilder、AfterLayout
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4442458669718279/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    旧时光_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:03:23.000Z" title="Wed Nov 19 2025 09:03:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    12
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"🍋"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"🍓"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"🍑"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"🍉"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"🍒"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">4.8 LayoutBuilder、AfterLayout</h2>
<h3 data-id="heading-1">📚 章节概览</h3>
<p>本章节是第4章的最后一节，将学习如何在布局过程中动态构建UI，以及如何获取组件的实际尺寸和位置：</p>
<ul>
<li><strong>LayoutBuilder</strong> - 布局过程中获取约束信息</li>
<li><strong>BoxConstraints</strong> - 约束信息详解</li>
<li><strong>响应式布局</strong> - 根据约束动态构建</li>
<li><strong>AfterLayout</strong> - 布局完成后获取尺寸</li>
<li><strong>RenderAfterLayout</strong> - 自定义RenderObject</li>
<li><strong>localToGlobal</strong> - 坐标转换</li>
<li><strong>Build和Layout</strong> - 交错执行机制</li>
</ul>
<hr/>
<h3 data-id="heading-2">🎯 核心知识点</h3>
<h4 data-id="heading-3">LayoutBuilder vs AfterLayout</h4>






























<table><thead><tr><th>特性</th><th>LayoutBuilder</th><th>AfterLayout</th></tr></thead><tbody><tr><td><strong>执行时机</strong></td><td>布局阶段（Layout）</td><td>布局完成后（Post-Layout）</td></tr><tr><td><strong>获取信息</strong></td><td>约束信息（BoxConstraints）</td><td>实际尺寸和位置</td></tr><tr><td><strong>主要用途</strong></td><td>响应式布局</td><td>尺寸获取</td></tr><tr><td><strong>性能</strong></td><td>较好</td><td>稍差（额外回调）</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-4">1️⃣ LayoutBuilder（布局构建器）</h3>
<h4 data-id="heading-5">1.1 什么是LayoutBuilder</h4>
<p><code>LayoutBuilder</code> 可以在<strong>布局过程</strong>中拿到父组件传递的约束信息（<code>BoxConstraints</code>），然后根据约束信息动态地构建不同的布局。</p>
<h4 data-id="heading-6">1.2 构造函数</h4>
<pre><code class="hljs language-dart" lang="dart">LayoutBuilder({
  Key? key,
  <span class="hljs-keyword">required</span> Widget <span class="hljs-built_in">Function</span>(BuildContext, BoxConstraints) builder,
})
</code></pre>
<h4 data-id="heading-7">1.3 基础用法</h4>
<pre><code class="hljs language-dart" lang="dart">LayoutBuilder(
  builder: (BuildContext context, BoxConstraints constraints) {
    <span class="hljs-comment">// 打印约束信息（调试用）</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'LayoutBuilder约束: <span class="hljs-subst">$constraints</span>'</span>);
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'  maxWidth: <span class="hljs-subst">${constraints.maxWidth}</span>'</span>);
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'  maxHeight: <span class="hljs-subst">${constraints.maxHeight}</span>'</span>);
    
    <span class="hljs-comment">// constraints包含父组件传递的约束信息</span>
    <span class="hljs-keyword">if</span> (constraints.maxWidth &gt; <span class="hljs-number">600</span>) {
      <span class="hljs-keyword">return</span> DesktopLayout();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> MobileLayout();
    }
  },
)
</code></pre>
<p><strong>控制台输出示例：</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">LayoutBuilder约束:</span> <span class="hljs-string">BoxConstraints(0.0&lt;=w&lt;=392.7,</span> <span class="hljs-number">0.0</span><span class="hljs-string">&lt;=h&lt;=Infinity)</span>
  <span class="hljs-attr">maxWidth:</span> <span class="hljs-number">392.7272644042969</span>
  <span class="hljs-attr">maxHeight:</span> <span class="hljs-string">Infinity</span>
</code></pre>
<h4 data-id="heading-8">1.4 BoxConstraints（约束信息）</h4>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BoxConstraints</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> minWidth;   <span class="hljs-comment">// 最小宽度</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> maxWidth;   <span class="hljs-comment">// 最大宽度</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> minHeight;  <span class="hljs-comment">// 最小高度</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> maxHeight;  <span class="hljs-comment">// 最大高度</span>
  
  <span class="hljs-built_in">bool</span> <span class="hljs-keyword">get</span> isTight;        <span class="hljs-comment">// 是否为固定约束</span>
  <span class="hljs-built_in">bool</span> <span class="hljs-keyword">get</span> isNormalized;   <span class="hljs-comment">// 是否标准化</span>
  <span class="hljs-comment">// ... 更多方法</span>
}
</code></pre>
<p><strong>常用属性：</strong></p>
<ul>
<li><code>minWidth</code> / <code>maxWidth</code>：宽度范围</li>
<li><code>minHeight</code> / <code>maxHeight</code>：高度范围</li>
<li><code>isTight</code>：是否固定尺寸（min == max）</li>
<li><code>biggest</code>：最大可用尺寸</li>
<li><code>smallest</code>：最小可用尺寸</li>
</ul>
<hr/>
<h3 data-id="heading-9">2️⃣ 响应式布局实战</h3>
<h4 data-id="heading-10">2.1 响应式Column</h4>
<p>根据可用宽度动态切换单列/双列布局：</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponsiveColumn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> ResponsiveColumn({<span class="hljs-keyword">super</span>.key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.children});

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;Widget&gt; children;

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> LayoutBuilder(
      builder: (BuildContext context, BoxConstraints constraints) {
        <span class="hljs-keyword">if</span> (constraints.maxWidth &lt; <span class="hljs-number">200</span>) {
          <span class="hljs-comment">// 最大宽度小于200，显示单列</span>
          <span class="hljs-keyword">return</span> Column(
            children: children,
            mainAxisSize: MainAxisSize.min,
          );
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-comment">// 大于200，显示双列</span>
          <span class="hljs-keyword">var</span> widgets = &lt;Widget&gt;[];
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; children.length; i += <span class="hljs-number">2</span>) {
            <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> &lt; children.length) {
              widgets.add(Row(
                children: [children[i], children[i + <span class="hljs-number">1</span>]],
                mainAxisSize: MainAxisSize.min,
              ));
            } <span class="hljs-keyword">else</span> {
              widgets.add(children[i]);
            }
          }
          <span class="hljs-keyword">return</span> Column(
            children: widgets,
            mainAxisSize: MainAxisSize.min,
          );
        }
      },
    );
  }
}
</code></pre>
<p><strong>使用示例：</strong></p>
<pre><code class="hljs language-dart" lang="dart">ResponsiveColumn(
  children: [
    Text(<span class="hljs-string">'Item 1'</span>),
    Text(<span class="hljs-string">'Item 2'</span>),
    Text(<span class="hljs-string">'Item 3'</span>),
    Text(<span class="hljs-string">'Item 4'</span>),
  ],
)
</code></pre>
<h4 data-id="heading-11">2.2 响应式断点</h4>
<p>常见的响应式断点：</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">enum</span> DeviceType { mobile, tablet, desktop }

DeviceType getDeviceType(<span class="hljs-built_in">double</span> width) {
  <span class="hljs-keyword">if</span> (width &lt; <span class="hljs-number">600</span>) {
    <span class="hljs-keyword">return</span> DeviceType.mobile;    <span class="hljs-comment">// 手机</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (width &lt; <span class="hljs-number">1200</span>) {
    <span class="hljs-keyword">return</span> DeviceType.tablet;    <span class="hljs-comment">// 平板</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> DeviceType.desktop;   <span class="hljs-comment">// 桌面</span>
  }
}

<span class="hljs-comment">// 使用</span>
LayoutBuilder(
  builder: (context, constraints) {
    <span class="hljs-keyword">final</span> deviceType = getDeviceType(constraints.maxWidth);
    
    <span class="hljs-keyword">switch</span> (deviceType) {
      <span class="hljs-keyword">case</span> DeviceType.mobile:
        <span class="hljs-keyword">return</span> MobileLayout();
      <span class="hljs-keyword">case</span> DeviceType.tablet:
        <span class="hljs-keyword">return</span> TabletLayout();
      <span class="hljs-keyword">case</span> DeviceType.desktop:
        <span class="hljs-keyword">return</span> DesktopLayout();
    }
  },
)
</code></pre>
<h4 data-id="heading-12">2.3 自适应网格</h4>
<p>根据宽度自动调整列数：</p>
<pre><code class="hljs language-dart" lang="dart">LayoutBuilder(
  builder: (context, constraints) {
    <span class="hljs-comment">// 计算列数</span>
    <span class="hljs-keyword">final</span> cardWidth = <span class="hljs-number">120.0</span>;
    <span class="hljs-keyword">final</span> spacing = <span class="hljs-number">8.0</span>;
    <span class="hljs-keyword">final</span> columns = (constraints.maxWidth / (cardWidth + spacing))
        .floor()
        .clamp(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>);  <span class="hljs-comment">// 最少1列，最多6列</span>
    
    <span class="hljs-keyword">return</span> GridView.builder(
      gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
        crossAxisCount: columns,
        crossAxisSpacing: spacing,
        mainAxisSpacing: spacing,
      ),
      itemBuilder: (context, index) =&gt; Card(...),
    );
  },
)
</code></pre>
<hr/>
<h3 data-id="heading-13">3️⃣ AfterLayout（布局后回调）</h3>
<h4 data-id="heading-14">3.1 什么是AfterLayout</h4>
<p><code>AfterLayout</code> 是一个自定义组件，用于在布局完成后获取组件的实际尺寸和位置信息。</p>
<h4 data-id="heading-15">3.2 实现原理</h4>
<p>通过自定义 <code>RenderObject</code>，在 <code>performLayout</code> 方法中添加回调：</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AfterLayout</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SingleChildRenderObjectWidget</span> </span>{
  <span class="hljs-keyword">const</span> AfterLayout({
    <span class="hljs-keyword">super</span>.key,
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.callback,
    <span class="hljs-keyword">super</span>.child,
  });

  <span class="hljs-keyword">final</span> ValueChanged&lt;RenderAfterLayout&gt; callback;

  <span class="hljs-meta">@override</span>
  RenderAfterLayout createRenderObject(BuildContext context) {
    <span class="hljs-keyword">return</span> RenderAfterLayout(callback: callback);
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> updateRenderObject(
    BuildContext context,
    RenderAfterLayout renderObject,
  ) {
    renderObject.callback = callback;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RenderAfterLayout</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RenderProxyBox</span> </span>{
  RenderAfterLayout({<span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.callback});

  ValueChanged&lt;RenderAfterLayout&gt; callback;

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> performLayout() {
    <span class="hljs-keyword">super</span>.performLayout();
    <span class="hljs-comment">// 布局完成后触发回调</span>
    WidgetsBinding.instance.addPostFrameCallback((_) {
      callback(<span class="hljs-keyword">this</span>);
    });
  }

  <span class="hljs-comment">/// <span class="markdown">获取组件在屏幕中的偏移坐标</span></span>
  Offset <span class="hljs-keyword">get</span> offset =&gt; localToGlobal(Offset.zero);
}
</code></pre>
<h4 data-id="heading-16">3.3 基础用法</h4>
<pre><code class="hljs language-dart" lang="dart">AfterLayout(
  callback: (RenderAfterLayout ral) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'AfterLayout回调:'</span>);
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'  尺寸: <span class="hljs-subst">${ral.size}</span>'</span>);        <span class="hljs-comment">// Size(105.0, 17.0)</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'  位置: <span class="hljs-subst">${ral.offset}</span>'</span>);      <span class="hljs-comment">// Offset(42.5, 290.0)</span>
  },
  child: Text(<span class="hljs-string">'flutter@wendux'</span>),
)
</code></pre>
<p><strong>控制台输出：</strong></p>
<pre><code class="hljs language-css" lang="css">AfterLayout回调:
  尺寸: <span class="hljs-built_in">Size</span>(<span class="hljs-number">105.0</span>, <span class="hljs-number">17.0</span>)
  位置: <span class="hljs-built_in">Offset</span>(<span class="hljs-number">42.5</span>, <span class="hljs-number">290.0</span>)
</code></pre>
<h4 data-id="heading-17">3.4 获取相对坐标</h4>
<p>使用 <code>localToGlobal</code> 方法获取相对于某个父组件的坐标：</p>
<pre><code class="hljs language-dart" lang="dart">Builder(builder: (context) {
  <span class="hljs-keyword">return</span> Container(
    color: Colors.grey.shade200,
    width: <span class="hljs-number">100</span>,
    height: <span class="hljs-number">100</span>,
    child: AfterLayout(
      callback: (RenderAfterLayout ral) {
        <span class="hljs-comment">// 获取相对于Container的坐标</span>
        Offset offset = ral.localToGlobal(
          Offset.zero,
          ancestor: context.findRenderObject(),
        );
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'占用空间范围: <span class="hljs-subst">${offset &amp; ral.size}</span>'</span>);
      },
      child: Text(<span class="hljs-string">'A'</span>),
    ),
  );
})
</code></pre>
<hr/>
<h3 data-id="heading-18">4️⃣ RenderAfterLayout详解</h3>
<h4 data-id="heading-19">4.1 继承关系</h4>
<pre><code class="hljs language-markdown" lang="markdown">RenderObject
<span class="hljs-code">    ↓
RenderBox
    ↓
RenderProxyBox
    ↓
RenderAfterLayout
</span></code></pre>
<h4 data-id="heading-20">4.2 主要方法</h4>



































<table><thead><tr><th>方法/属性</th><th>说明</th><th>返回值</th></tr></thead><tbody><tr><td><code>size</code></td><td>组件尺寸</td><td><code>Size</code></td></tr><tr><td><code>offset</code></td><td>屏幕坐标</td><td><code>Offset</code></td></tr><tr><td><code>localToGlobal(Offset)</code></td><td>转换为全局坐标</td><td><code>Offset</code></td></tr><tr><td><code>localToGlobal(..., ancestor)</code></td><td>转换为相对坐标</td><td><code>Offset</code></td></tr><tr><td><code>paintBounds</code></td><td>绘制边界</td><td><code>Rect</code></td></tr></tbody></table>
<h4 data-id="heading-21">4.3 坐标转换</h4>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// 转换为屏幕坐标</span>
Offset screenOffset = ral.localToGlobal(Offset.zero);

<span class="hljs-comment">// 转换为相对于ancestor的坐标</span>
Offset relativeOffset = ral.localToGlobal(
  Offset.zero,
  ancestor: ancestorRenderObject,
);

<span class="hljs-comment">// 计算占用空间</span>
Rect bounds = offset &amp; size;  <span class="hljs-comment">// Rect.fromLTWH(x, y, width, height)</span>
</code></pre>
<hr/>
<h3 data-id="heading-22">5️⃣ Build和Layout的交错执行</h3>
<h4 data-id="heading-23">5.1 执行流程</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[开始Build] --&gt; B[遇到LayoutBuilder]
    B --&gt; C[进入Layout阶段]
    C --&gt; D[执行LayoutBuilder.builder]
    D --&gt; E[返回新Widget]
    E --&gt; F[继续Build新Widget]
    F --&gt; G[完成]
    
    style A fill:#e1f5ff
    style C fill:#ffe1e1
    style F fill:#e1f5ff
</code></pre>
<p><strong>关键点：</strong></p>
<ul>
<li>Build 和 Layout <strong>不是</strong>严格按顺序执行的</li>
<li>LayoutBuilder 的 builder 在 <strong>Layout 阶段</strong>执行</li>
<li>builder 中可以返回新 Widget，触发新的 Build</li>
</ul>
<h4 data-id="heading-24">5.2 执行顺序示例</h4>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-built_in">print</span>(<span class="hljs-string">'1. 开始Build'</span>);

LayoutBuilder(
  builder: (context, constraints) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'3. 执行LayoutBuilder.builder（Layout阶段）'</span>);
    <span class="hljs-keyword">return</span> Column(
      children: [
        Text(<span class="hljs-string">'Hello'</span>),  <span class="hljs-comment">// 4. 触发新的Build</span>
      ],
    );
  },
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">'2. LayoutBuilder创建完成'</span>);
</code></pre>
<p><strong>输出顺序：</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> 开始Build
<span class="hljs-bullet">2.</span> LayoutBuilder创建完成
<span class="hljs-bullet">3.</span> 执行LayoutBuilder.builder（Layout阶段）
<span class="hljs-bullet">4.</span> Build Text Widget
</code></pre>
<hr/>
<h3 data-id="heading-25">🤔 常见问题（FAQ）</h3>
<h4 data-id="heading-26">Q1: LayoutBuilder和MediaQuery的区别？</h4>
<p><strong>A:</strong></p>






























<table><thead><tr><th>特性</th><th>LayoutBuilder</th><th>MediaQuery</th></tr></thead><tbody><tr><td><strong>获取信息</strong></td><td>父组件约束</td><td>屏幕尺寸</td></tr><tr><td><strong>作用范围</strong></td><td>当前组件</td><td>全局</td></tr><tr><td><strong>响应变化</strong></td><td>父约束变化</td><td>屏幕尺寸变化</td></tr><tr><td><strong>使用场景</strong></td><td>组件级响应式</td><td>全局响应式</td></tr></tbody></table>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// LayoutBuilder - 父组件约束</span>
LayoutBuilder(
  builder: (context, constraints) {
    <span class="hljs-comment">// constraints来自父组件</span>
    <span class="hljs-keyword">return</span> Text(<span class="hljs-string">'宽度: <span class="hljs-subst">${constraints.maxWidth}</span>'</span>);
  },
)

<span class="hljs-comment">// MediaQuery - 屏幕尺寸</span>
<span class="hljs-keyword">final</span> screenWidth = MediaQuery.of(context).size.width;
</code></pre>
<h4 data-id="heading-27">Q2: 如何在StatefulWidget中使用AfterLayout？</h4>
<p><strong>A:</strong> 使用 <code>addPostFrameCallback</code> 避免在 build 中调用 setState</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  State&lt;MyWidget&gt; createState() =&gt; _MyWidgetState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyWidgetState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyWidget</span>&gt; </span>{
  Size _size = Size.zero;

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> AfterLayout(
      callback: (RenderAfterLayout ral) {
        <span class="hljs-comment">// ✅ 正确：使用 addPostFrameCallback</span>
        WidgetsBinding.instance.addPostFrameCallback((_) {
          <span class="hljs-keyword">if</span> (mounted) {
            setState(() {
              _size = ral.size;
            });
          }
        });
      },
      child: Text(<span class="hljs-string">'Hello'</span>),
    );
  }
}
</code></pre>
<h4 data-id="heading-28">Q3: LayoutBuilder的builder何时执行？</h4>
<p><strong>A:</strong> 在以下情况会执行：</p>
<ol>
<li><strong>首次布局</strong>：组件首次被添加到树中</li>
<li><strong>约束变化</strong>：父组件传递的约束发生变化</li>
<li><strong>重新布局</strong>：调用 <code>markNeedsLayout()</code></li>
</ol>
<pre><code class="hljs language-dart" lang="dart">LayoutBuilder(
  builder: (context, constraints) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'Builder执行，约束: <span class="hljs-subst">$constraints</span>'</span>);
    <span class="hljs-keyword">return</span> Container();
  },
)
</code></pre>
<h4 data-id="heading-29">Q4: 如何优化LayoutBuilder性能？</h4>
<p><strong>A:</strong></p>
<ol>
<li><strong>避免过度嵌套</strong></li>
<li><strong>缓存计算结果</strong></li>
<li><strong>使用const构造函数</strong></li>
</ol>
<pre><code class="hljs language-dart" lang="dart">LayoutBuilder(
  builder: (context, constraints) {
    <span class="hljs-comment">// ❌ 每次都创建新Widget</span>
    <span class="hljs-keyword">return</span> Column(
      children: [
        Text(<span class="hljs-string">'Item 1'</span>),
        Text(<span class="hljs-string">'Item 2'</span>),
      ],
    );
    
    <span class="hljs-comment">// ✅ 使用const</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> Column(
      children: [
        Text(<span class="hljs-string">'Item 1'</span>),
        Text(<span class="hljs-string">'Item 2'</span>),
      ],
    );
  },
)
</code></pre>
<h4 data-id="heading-30">Q5: AfterLayout会影响性能吗？</h4>
<p><strong>A:</strong> 会有轻微影响，因为：</p>
<ol>
<li>额外的回调开销</li>
<li>可能触发额外的 setState</li>
<li>每次布局都会执行回调</li>
</ol>
<p><strong>优化建议：</strong></p>
<ul>
<li>只在必要时使用</li>
<li>避免在回调中进行重量级操作</li>
<li>使用防抖/节流</li>
</ul>
<hr/>
<h3 data-id="heading-31">🎯 跟着做练习</h3>
<h4 data-id="heading-32">练习1：实现一个响应式导航栏</h4>
<p><strong>目标：</strong> 宽度&gt;600显示完整标签，否则显示图标</p>
<p><strong>步骤：</strong></p>
<ol>
<li>使用 LayoutBuilder</li>
<li>判断 constraints.maxWidth</li>
<li>返回不同的UI</li>
</ol>
<details>
<summary>💡 查看答案</summary>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponsiveNavigationBar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> ResponsiveNavigationBar({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> LayoutBuilder(
      builder: (context, constraints) {
        <span class="hljs-keyword">final</span> showLabels = constraints.maxWidth &gt; <span class="hljs-number">600</span>;
        
        <span class="hljs-keyword">return</span> Container(
          height: <span class="hljs-number">60</span>,
          color: Colors.blue,
          child: Row(
            mainAxisAlignment: MainAxisAlignment.spaceAround,
            children: [
              _buildNavItem(
                icon: Icons.home,
                label: <span class="hljs-string">'首页'</span>,
                showLabel: showLabels,
              ),
              _buildNavItem(
                icon: Icons.search,
                label: <span class="hljs-string">'搜索'</span>,
                showLabel: showLabels,
              ),
              _buildNavItem(
                icon: Icons.person,
                label: <span class="hljs-string">'我的'</span>,
                showLabel: showLabels,
              ),
            ],
          ),
        );
      },
    );
  }

  Widget _buildNavItem({
    <span class="hljs-keyword">required</span> IconData icon,
    <span class="hljs-keyword">required</span> <span class="hljs-built_in">String</span> label,
    <span class="hljs-keyword">required</span> <span class="hljs-built_in">bool</span> showLabel,
  }) {
    <span class="hljs-keyword">return</span> Column(
      mainAxisAlignment: MainAxisAlignment.center,
      children: [
        Icon(icon, color: Colors.white),
        <span class="hljs-keyword">if</span> (showLabel) ...[
          <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">4</span>),
          Text(
            label,
            style: <span class="hljs-keyword">const</span> TextStyle(color: Colors.white, fontSize: <span class="hljs-number">12</span>),
          ),
        ],
      ],
    );
  }
}
</code></pre>
</details>
<hr/>
<h4 data-id="heading-33">练习2：实现文本溢出检测</h4>
<p><strong>目标：</strong> 检测Text是否溢出，显示"展开"按钮</p>
<p><strong>步骤：</strong></p>
<ol>
<li>使用 AfterLayout 获取Text尺寸</li>
<li>计算是否溢出</li>
<li>显示/隐藏展开按钮</li>
</ol>
<details>
<summary>💡 查看答案</summary>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExpandableText</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> ExpandableText({<span class="hljs-keyword">super</span>.key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.text});

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> text;

  <span class="hljs-meta">@override</span>
  State&lt;ExpandableText&gt; createState() =&gt; _ExpandableTextState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_ExpandableTextState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">ExpandableText</span>&gt; </span>{
  <span class="hljs-built_in">bool</span> _expanded = <span class="hljs-keyword">false</span>;
  <span class="hljs-built_in">bool</span> _isOverflow = <span class="hljs-keyword">false</span>;

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        AfterLayout(
          callback: (RenderAfterLayout ral) {
            <span class="hljs-comment">// 检查是否溢出</span>
            <span class="hljs-keyword">final</span> textPainter = TextPainter(
              text: TextSpan(text: widget.text),
              maxLines: _expanded ? <span class="hljs-keyword">null</span> : <span class="hljs-number">3</span>,
              textDirection: TextDirection.ltr,
            )..layout(maxWidth: ral.size.width);

            WidgetsBinding.instance.addPostFrameCallback((_) {
              <span class="hljs-keyword">if</span> (mounted) {
                setState(() {
                  _isOverflow = textPainter.didExceedMaxLines;
                });
              }
            });
          },
          child: Text(
            widget.text,
            maxLines: _expanded ? <span class="hljs-keyword">null</span> : <span class="hljs-number">3</span>,
            overflow: TextOverflow.ellipsis,
          ),
        ),
        <span class="hljs-keyword">if</span> (_isOverflow)
          TextButton(
            onPressed: () {
              setState(() {
                _expanded = !_expanded;
              });
            },
            child: Text(_expanded ? <span class="hljs-string">'收起'</span> : <span class="hljs-string">'展开'</span>),
          ),
      ],
    );
  }
}
</code></pre>
</details>
<hr/>
<h3 data-id="heading-34">📋 小结</h3>
<h4 data-id="heading-35">核心概念</h4>

























<table><thead><tr><th>组件</th><th>用途</th><th>执行时机</th></tr></thead><tbody><tr><td><strong>LayoutBuilder</strong></td><td>获取约束，响应式布局</td><td>Layout阶段</td></tr><tr><td><strong>AfterLayout</strong></td><td>获取尺寸和位置</td><td>Layout完成后</td></tr><tr><td><strong>BoxConstraints</strong></td><td>约束信息</td><td>Layout阶段传递</td></tr></tbody></table>
<h4 data-id="heading-36">LayoutBuilder使用场景</h4>

























<table><thead><tr><th>场景</th><th>示例</th></tr></thead><tbody><tr><td><strong>响应式布局</strong></td><td>根据宽度显示不同UI</td></tr><tr><td><strong>自适应网格</strong></td><td>动态调整列数</td></tr><tr><td><strong>断点设计</strong></td><td>手机/平板/桌面切换</td></tr><tr><td><strong>动态组件</strong></td><td>根据空间大小选择组件</td></tr></tbody></table>
<h4 data-id="heading-37">AfterLayout使用场景</h4>

























<table><thead><tr><th>场景</th><th>示例</th></tr></thead><tbody><tr><td><strong>尺寸获取</strong></td><td>获取组件实际大小</td></tr><tr><td><strong>位置计算</strong></td><td>计算组件坐标</td></tr><tr><td><strong>溢出检测</strong></td><td>判断Text是否溢出</td></tr><tr><td><strong>动画准备</strong></td><td>获取起始位置</td></tr></tbody></table>
<h4 data-id="heading-38">记忆技巧</h4>
<ol>
<li><strong>LayoutBuilder</strong>：Layout阶段<strong>构建</strong>UI</li>
<li><strong>AfterLayout</strong>：Layout<strong>之后</strong>获取信息</li>
<li><strong>Build和Layout</strong>：可以<strong>交错执行</strong></li>
<li><strong>BoxConstraints</strong>：约束向<strong>下</strong>传递</li>
<li><strong>RenderObject</strong>：渲染树的<strong>节点</strong></li>
</ol>
<hr/>
<h3 data-id="heading-39">🔗 相关资源</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.flutter.dev%2Fflutter%2Fwidgets%2FLayoutBuilder-class.html" target="_blank" title="https://api.flutter.dev/flutter/widgets/LayoutBuilder-class.html" ref="nofollow noopener noreferrer">LayoutBuilder 官方文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.flutter.dev%2Fflutter%2Frendering%2FBoxConstraints-class.html" target="_blank" title="https://api.flutter.dev/flutter/rendering/BoxConstraints-class.html" ref="nofollow noopener noreferrer">BoxConstraints 官方文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.flutter.dev%2Fflutter%2Frendering%2FRenderBox-class.html" target="_blank" title="https://api.flutter.dev/flutter/rendering/RenderBox-class.html" ref="nofollow noopener noreferrer">RenderBox 官方文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.flutter.dev%2Fflutter%2Frendering%2FRenderObject-class.html" target="_blank" title="https://api.flutter.dev/flutter/rendering/RenderObject-class.html" ref="nofollow noopener noreferrer">RenderObject 官方文档</a></li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Canvas学习笔记（一）]]></title>    <link>https://juejin.cn/post/7573738017988640811</link>    <guid>https://juejin.cn/post/7573738017988640811</guid>    <pubDate>2025-11-18T09:49:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573738017988640811" data-draft-id="7573855399716470803" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Canvas学习笔记（一）"/> <meta itemprop="keywords" content="前端,JavaScript,Canvas"/> <meta itemprop="datePublished" content="2025-11-18T09:49:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="不是鱼"/> <meta itemprop="url" content="https://juejin.cn/user/1704656590610676"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Canvas学习笔记（一）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1704656590610676/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    不是鱼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T09:49:33.000Z" title="Tue Nov 18 2025 09:49:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">什么是 Canvas</h2>
<p>Canvas 是 HTML5 中新增的一种标签，表示一个画布，只是图形容器，绘制功能必须使用js来实现。</p>
<pre><code class="hljs language-js" lang="js">&lt;!doctype html&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>基础的HTML5页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span> 
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"canvas"</span>&gt;</span>
            这里是canvas标签，当你的浏览器不支持canvas时，会显示这行文字
	<span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span> 

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</span></code></pre>
<p>打开后会是一个完全空白的画面，因为canvas本意就是一块画布，画布在html5中是透明的，不可见的。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/646cf23d6a26415c90537a193f6ecaac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=bBQX5CtrgnfJvTCvVL5dEqMEMbc%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">绘制前的准备</h2>
<h3 data-id="heading-2">获取 Canvas 对象：</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'canvas'</span>);
</code></pre>
<h3 data-id="heading-3">获取画笔</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> context = canvas.<span class="hljs-title function_">getContext</span>(contextType, contextAttributes?);
<span class="hljs-keyword">const</span> context = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);
<span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>, {
  <span class="hljs-attr">alpha</span>: <span class="hljs-literal">true</span>,          <span class="hljs-comment">// 启用透明通道（默认就是true）</span>
});
</code></pre>
<p><code>getContext</code>方法用于获取 Canvas 元素的绘图上下文，来对 Canvas 元素进行绘制操作，通常是 2D 类型，用于二维绘图。第一个参数是必须传的，第二个参数代表配置上下文的行为，不同的上下文的配置属性不同。</p>
<ul>
<li><code>2d</code></li>
</ul>






























<table><thead><tr><th>属性</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td><code>alpha</code></td><td>是否包含alpha通道（透明度）</td><td><code>true</code></td></tr><tr><td><code>colorSpace</code></td><td>指定渲染上下文的色彩空间（<code>srgb</code>或<code>display-p3</code>）</td><td><code>srgb</code></td></tr><tr><td><code>desynchronized</code></td><td>是否将画布绘制周期与事件循环解耦以减少延迟</td><td><code>false</code></td></tr><tr><td><code>willReadFrequently</code></td><td>是否频繁读取像素（用于优化<code>getImageData()</code>性能）</td><td><code>false</code></td></tr></tbody></table>
<ul>
<li><code>webgl</code></li>
</ul>


















































<table><thead><tr><th>属性</th><th>作用</th><th>说明</th></tr></thead><tbody><tr><td><code>alpha</code></td><td>是否包含alpha通道</td><td>和2D一样</td></tr><tr><td><code>antialias</code></td><td>是否开启抗锯齿</td><td>让图形边缘更平滑</td></tr><tr><td><code>depth</code></td><td>是否包含深度缓冲区</td><td>用于3D场景的深度检测</td></tr><tr><td><code>failIfMajorPerformanceCaveat</code></td><td>性能低时是否创建上下文</td><td><code>true</code>：性能差时失败</td></tr><tr><td><code>powerPreference</code></td><td>GPU电源偏好</td><td><code>default</code>/<code>high-performance</code>/<code>low-power</code></td></tr><tr><td><code>premultipliedAlpha</code></td><td>是否预混合alpha</td><td>用于图像合成</td></tr><tr><td><code>preserveDrawingBuffer</code></td><td>是否保存缓冲区</td><td><code>true</code>：可以多次读取</td></tr><tr><td><code>stencil</code></td><td>是否包含模版缓冲区</td><td>用于复杂遮罩效果</td></tr></tbody></table>
<p>小结一下：准备工作就分为三步：</p>
<ol>
<li><strong>布置画布：通过添加</strong><code> &lt;canvas&gt; </code><strong>标签，添加canvas元素</strong></li>
<li><strong>获取画布：通过</strong><code> &lt;canvas&gt; </code><strong>标签的id，获得canvas对象</strong></li>
<li><strong>获得画笔：通过canvas对象的</strong><code>getContext("2d") </code><strong>方法，获得2D环境</strong></li>
</ol>
<hr/>
<h3 data-id="heading-4"><strong>绘制线段：</strong></h3>
<p>在Canvas中，<strong>是基于状态的绘制</strong>，所以前面几步都是在确定状态，直到最后一步才会具体绘制。</p>
<p>绘画步骤和现实中画画差不多，可以分为四步：</p>
<h4 data-id="heading-5">1.  首先移动画笔至绘画的起始位置</h4>
<pre><code class="hljs language-js" lang="js">context.<span class="hljs-title function_">moveTo</span>(x, y)
<span class="hljs-comment">// 将笔画移至 x, y 这个位置，canvas中是以画布的左上角为坐标原点，x轴的正方向向右，y轴的正方向向下</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eddbf10a40c648e79bca69ee62fc8c79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=GbwlNqPfmeiHAeKN9sykgeSq9Uw%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">2.  确定第一笔的停止点</h4>
<pre><code class="hljs language-js" lang="js">context.<span class="hljs-title function_">lineTo</span>(x, y)
<span class="hljs-comment">// 从上一个笔的停止点，移动至x，y这里</span>
</code></pre>
<h4 data-id="heading-7">3.  规划好路线后，选择画笔（粗细，颜色，线条等）</h4>
<p>因为 Canvas 是基于状态的，所以我们在选择画笔粗细和颜色的同时，其实也是选择了线条的粗细和颜色。</p>









































<table><thead><tr><th>属性</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>context.lineWidth</code></td><td><strong>线条粗细（宽度）</strong> ，单位是像素</td><td><code>1.0</code></td><td><code>ctx.lineWidth = 5;</code></td></tr><tr><td><code>context.strokeStyle</code></td><td><strong>描边颜色/样式</strong>（可为颜色、渐变、图案）</td><td><code>#000000</code>（黑色）</td><td><code>ctx.strokeStyle = "#AA394C";``ctx.strokeStyle = "red";``ctx.strokeStyle = gradient;</code></td></tr><tr><td><code>context.lineCap</code></td><td><strong>线段末端样式</strong></td><td><code>"butt"</code></td><td><code>"butt"</code>（平头） <code>"round"</code>（圆头） <code>"square"</code>（方头）</td></tr><tr><td><code>context.lineJoin</code></td><td><strong>两条线相交处的连接样式</strong></td><td><code>"miter"</code></td><td><code>"miter"</code>（尖角） <code>"round"</code>（圆角） <code>"bevel"</code>（斜角）</td></tr><tr><td><code>context.miterLimit</code></td><td><strong>尖角（miter）的最大长度限制</strong>（防止过长尖角）</td><td><code>10</code></td><td><code>ctx.miterLimit = 5;</code></td></tr></tbody></table>
<h4 data-id="heading-8">4. 进行绘制</h4>
<p>确定绘制有两种方法：</p>
<pre><code class="hljs language-js" lang="js">context.<span class="hljs-title function_">fill</span>() <span class="hljs-comment">// 填充</span>
context.<span class="hljs-title function_">stroke</span>() <span class="hljs-comment">// 描边</span>
</code></pre>
<h4 data-id="heading-9">5. 画一个线条！</h4>
<pre><code class="hljs language-js" lang="js">&lt;body&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myCanvas"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"border: 1px solid black;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span></span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'myCanvas'</span>);
        <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);
        
        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>);

        ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">10</span>;
        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">'red'</span>;

        ctx.<span class="hljs-title function_">stroke</span>();
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
&lt;/body&gt;
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4110ef73c4114e18963318062516e274~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=oVnChnunxSkhxZQ4UVGs7pJ4ARk%3D" alt="image.png" loading="lazy"/></p>
<p>一条红色的线条就画好了。但是我们现在只给 Canvas 设置了边框，那它的宽高是从哪来的呢？</p>
<p>这是浏览器默认给 Canvas 分配的尺寸 300x150 像素的画布。如果我们要自己设置 Canvas 宽高的话有两种方法</p>
<ol>
<li>通过标签内部设置</li>
</ol>
<pre><code class="hljs language-js" lang="js"> &lt;canvas id=<span class="hljs-string">"myCanvas"</span> style=<span class="hljs-string">"border: 1px solid black;"</span> width = <span class="hljs-string">"500"</span> height = <span class="hljs-string">"500"</span>&gt;&lt;/canvas&gt;
</code></pre>
<ol start="2">
<li>通过 JS 设置</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'myCanvas'</span>);

canvas.<span class="hljs-property">width</span> = <span class="hljs-number">500</span>;
canvas.<span class="hljs-property">height</span> = <span class="hljs-number">500</span>;
</code></pre>
<p>这两种方式设置的宽高是等效的</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d52a13df55f64a10a2d554ccc2758a14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=JM%2FpMM2SsY%2BoELXFErqSPpIxZWE%3D" alt="image.png" loading="lazy"/>
<strong>这里有一个特别需要注意的点：我们设置的是画布的物理宽高，也就是 Canvas 元素的真实宽高，并不是通过 Css 设置的样式宽高，如果我们通过 Css 设置了 Canvas 的宽高，效果其实是在物理宽高的基础上进行了等比的缩小或者拉伸</strong></p>
<pre><code class="hljs language-js" lang="js">&lt;canvas id=<span class="hljs-string">"myCanvas"</span> 
    style=<span class="hljs-string">"border: 1px solid black; width: 100px; height: 100px;"</span> width=<span class="hljs-string">"500"</span> height=<span class="hljs-string">"500"</span>&gt;
&lt;/canvas&gt;
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/346e123667244b89b96c41c560b51a44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=IhqkmHc8XIiSOrVbJ78O8DJ2h48%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-10">线条组成图形</h2>
<h3 data-id="heading-11">绘制折线</h3>
<p>当我们学会绘制线条后，就可以用线条来组成图形了，方法其实很简单，就是复用上文用过的<code>lineTo()</code> 方法即可：</p>
<pre><code class="hljs language-js" lang="js">    ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">50</span>, <span class="hljs-number">100</span>);
    ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>);

    ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">10</span>;
    ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">'red'</span>;

    ctx.<span class="hljs-title function_">stroke</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acfa8e95b0114d508c7c6a1f1a012e8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=uCoff0U9nEHXFzRwF%2FdeDY6YSPA%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-12">绘制多条折线</h3>
<p>如果需要绘制多条不连接的线条，只需在绘制完一次后，再重新移动画笔，重新绘制一次即可</p>
<pre><code class="hljs language-js" lang="js">        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">50</span>, <span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">10</span>;
        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">'red'</span>;
        ctx.<span class="hljs-title function_">stroke</span>();

        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">150</span>, <span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">200</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">10</span>;
        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">'blue'</span>;
        ctx.<span class="hljs-title function_">stroke</span>(); 
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c6c2b8f523e4707b5718d1f60ca827a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=XiP%2B4fnd%2B4Ec68%2BQd7mggwzOXZQ%3D" alt="image.png" loading="lazy"/>
诶？这是不是很奇怪，明明是先红色再蓝色，为什么就全变为蓝色了呢？<strong>是因为上文说过的 Canvas 是基于状态绘制的。我们每次使用<code>stroke()</code> 时，它都会把之前设置的状态再次绘制一遍，第一次<code>stroke</code>时会绘制一条红色折线，第二次<code>stroke</code>时，会再次重新绘制之前那条红色的折线，但是画笔已经变为蓝色的了，所以画出的折线全是蓝色的</strong>。</p>
<p>为了解决这个问题，我们需要在每次重新绘制时加上<code>beginPath()</code>，这个 API 代表下次绘制的起始处为<code>beginPath()</code>之后的代码。</p>
<pre><code class="hljs language-js" lang="js">        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">50</span>, <span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">10</span>;
        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">'red'</span>;
        ctx.<span class="hljs-title function_">stroke</span>();
        
        ctx.<span class="hljs-title function_">beginPath</span>(); <span class="hljs-comment">// 重新定义起始位置</span>
        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">150</span>, <span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">200</span>, <span class="hljs-number">0</span>);
        ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">10</span>;
        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">'blue'</span>;
        ctx.<span class="hljs-title function_">stroke</span>(); 
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2051424865964361add06983e8ced723~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=SxmjwGWroqhHM1wxxTLE5G8LR3Q%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-13">绘制矩形</h2>
<p>我们先使用绘制线条的方式绘制一个矩形</p>
<pre><code class="hljs language-js" lang="js">        <span class="hljs-comment">// 绘制一个矩形</span>
        ctx.<span class="hljs-title function_">beginPath</span>();
        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>,<span class="hljs-number">50</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>,<span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">50</span>,<span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>);

        ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">5</span>;
        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">"black"</span>;

        ctx.<span class="hljs-title function_">stroke</span>();   
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/411bf8c2bde24ccc82a179d3ae34b4a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=EW0P2Szei%2FGtGhvNb%2BDwER1SV0E%3D" alt="image.png" loading="lazy"/>
会发现此时最后一笔画时有一个小缺口，这种情况是因为我们设置了<code>lineWidth</code>导致的，如果是默认笔触为1的话是不会有问题的，但是如果笔触越大，线条越宽，这个小缺口就会越明显。此时需要使用<code>closePath()</code>闭合图形。</p>
<pre><code class="hljs language-js" lang="js">        <span class="hljs-comment">// 绘制一个矩形</span>
        ctx.<span class="hljs-title function_">beginPath</span>();
        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>,<span class="hljs-number">50</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>,<span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">50</span>,<span class="hljs-number">100</span>);
        <span class="hljs-comment">// ctx.lineTo(50,50); // 最后一笔可以不画</span>
        ctx.<span class="hljs-title function_">closePath</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cbc42c23f5504718ab0fb038c009fabc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=xFAhir2AC8eCxfjR7mto%2FSQzqYY%3D" alt="image.png" loading="lazy"/></p>
<p>所以我们在绘制图形时需要使用<code>beginPath()</code>和 <code>closePath()</code>包裹起来。</p>
<h3 data-id="heading-14">给矩形上色</h3>
<p>上文中有提过绘制的两种方法分别是<code>stroke()</code>和<code>fill()</code>，我们需要使用<code>fill()</code>方法给矩形上色。和使用<code>stroke</code>前相同，我们需要先给它设置好属性。</p>
<pre><code class="hljs language-js" lang="js">        ctx.<span class="hljs-title function_">beginPath</span>();
        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>,<span class="hljs-number">50</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>,<span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">50</span>,<span class="hljs-number">100</span>);
        ctx.<span class="hljs-title function_">closePath</span>();

        ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">5</span>;
        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">"black"</span>;

        ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">"red"</span>;

        ctx.<span class="hljs-title function_">fill</span>();
        ctx.<span class="hljs-title function_">stroke</span>();   
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34d863746af641cf951ba66a6be6130f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=%2FR0lXWgHcn5PPCqibDzvF7E7TwU%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-15">使用<code>rect()</code>方法绘制矩形</h3>
<p>由于矩形是常用的图形，所以 Canvas API 封装好了一个定义矩形位置信息的方法，这个方法接受四个参数，分别表示矩形的起点坐标和宽高。</p>
<pre><code class="hljs language-js" lang="js">        ctx.<span class="hljs-title function_">rect</span>(x,y,width,height);

        ctx.<span class="hljs-title function_">beginPath</span>();
        ctx.<span class="hljs-title function_">rect</span>(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>,<span class="hljs-number">100</span>,<span class="hljs-number">100</span>);
        
        ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">5</span>;
        ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">"black"</span>;
        ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">"red"</span>;

        ctx.<span class="hljs-title function_">fill</span>();
        ctx.<span class="hljs-title function_">stroke</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46338e599a61409da3d39828c7175cb6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5piv6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764065164&amp;x-signature=b3V9TAjlyPZphxf2RgRKBTbLES4%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>今天 Canvas 的学习就到这啦</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript-实现函数方法-改变this指向call apply bind]]></title>    <link>https://juejin.cn/post/7574253222606290985</link>    <guid>https://juejin.cn/post/7574253222606290985</guid>    <pubDate>2025-11-19T09:14:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574253222606290985" data-draft-id="7574230922314448902" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript-实现函数方法-改变this指向call apply bind"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-11-19T09:14:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="地狱恶犬萨煤耶"/> <meta itemprop="url" content="https://juejin.cn/user/485304409010298"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript-实现函数方法-改变this指向call apply bind
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/485304409010298/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    地狱恶犬萨煤耶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:14:05.000Z" title="Wed Nov 19 2025 09:14:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">this</h2>
<ul>
<li>在<strong>函数执行时决定</strong>的不是定义时决定的</li>
<li><strong>this只和函数的调用有关</strong>*</li>
<li><code>obj.fn() </code>中 <code>fn</code>的 <code>this</code>就是<code>obj</code>  <code>arr[0] ()</code> <code>this</code>就是<code>arr</code></li>
</ul>
<h3 data-id="heading-1">重定义</h3>
<h4 data-id="heading-2">call</h4>
<ul>
<li>会直接执行函数</li>
<li>函数的参数逐个传进去
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36894c5eede7407cbc1074441e601003~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148444&amp;x-signature=VlSyv%2BEmrExfJ3pg73AfFtc87aw%3D" alt="call" loading="lazy"/></li>
</ul>
<h5 data-id="heading-3">实现</h5>
<ul>
<li>首先先判断thisArg参数 如果为空就默认window 这里运用了<code>||运算符</code> <strong>有一个t结果就为t</strong> 所以短路效果为<strong>前面的表达式结果为t 后面的表达式就不执行</strong></li>
</ul>
<blockquote>
<p>补充说明<code>&amp;&amp;运算符</code> <strong>前面一个f结果就为f</strong> 所以短路效果是<strong>前面为f后面不执行</strong></p>
</blockquote>
<ul>
<li><strong>symbol(基本数据类型)有唯一性</strong> 可以保证属性与原对象不冲突 <code>  let key = Symbol('temp')</code>创建一个symbol类型的变量key其中<code>temp</code>是这个变量的描述符</li>
<li>利用<strong>对象的方法中的this指向对象</strong> :通过把这个函数给<code>thisArg</code>对象的方法再通过这个对象调用就改变了函数this的指向 其中利用<strong>数组的展开运算符</strong>把value(剩余参数数组)挨个传进这个方法完成了<code>mycall</code>改变this指向和直接执行函数的功能</li>
</ul>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-comment">//实现call</span>
    <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myCall</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">thisArg, ...value</span>) {
      <span class="hljs-comment">//如果参数为空 就默认是window</span>
      <span class="hljs-comment">//利用||特性</span>
      thisArg = thisArg || <span class="hljs-variable language_">window</span>

      <span class="hljs-keyword">let</span> key = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'temp'</span>)
      thisArg[key] = <span class="hljs-variable language_">this</span>
      <span class="hljs-comment">//利用...数组的展开运算符把value的所有元素 逐个全部传入</span>
      thisArg[key](...value)
      <span class="hljs-keyword">delete</span> thisArg[key]

    }
</code></pre>
<ul>
<li>测试用例</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//测试用例</span>
    <span class="hljs-comment">//this指向对象</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">fnCall</span>(<span class="hljs-params">a, b</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>, a, b);
    }
    fnCall.<span class="hljs-title function_">myCall</span>(obj, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
    <span class="hljs-comment">//this指向函数</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn1</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'这是测试函数'</span>);
    }
    fnCall.<span class="hljs-title function_">myCall</span>(fn1, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
</code></pre>
<h4 data-id="heading-4">apply</h4>
<ul>
<li>也会直接执行函数</li>
<li>参数以对象(一般是数组的形式传进去)
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3731b8441924504bfde8d0a87768a67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148444&amp;x-signature=i3sd7Wx2h49aanAauLyiqNwcVO4%3D" alt="apply" loading="lazy"/></li>
</ul>
<h5 data-id="heading-5">实现</h5>
<p>和<code>mycall</code>的基本思想是一样的区别如下</p>
<ul>
<li>因为参数是数组形式 所以<code>myApply</code>中的value参数不需要用剩余参数数组<code>...value</code>直接获取传入的数组<code>value</code>即可  然后还是使用<code>...</code>展开运算符把参数数组展开传入</li>
</ul>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-comment">//实现apply</span>
     <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myApply</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">thisArg, value</span>) {
      thisArg = thisArg || <span class="hljs-variable language_">window</span>
      <span class="hljs-keyword">let</span> key = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'temp'</span>)
      thisArg[key] = <span class="hljs-variable language_">this</span>
      <span class="hljs-comment">//利用...数组的展开运算符把value的所有元素 逐个全部传入</span>
      thisArg[key](...value)
      <span class="hljs-keyword">delete</span> thisArg[key]
    }
    fnCall.<span class="hljs-title function_">myApply</span>(obj, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])
</code></pre>
<ul>
<li>测试用例同<code>mycall</code></li>
</ul>
<h4 data-id="heading-6">bind</h4>
<ul>
<li>参数逐个传入</li>
<li>返回新数组 调用之后才执行(参数自动传进去 this改变)
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f726b0038834767b307d337ac8a606d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148444&amp;x-signature=yHg8zwg0gbaI%2F17uG%2FRAzVDKSqY%3D" alt="bind" loading="lazy"/></li>
</ul>
<h5 data-id="heading-7">实现</h5>
<p>不会立即执行函数 而是返回新的函数</p>
<ul>
<li>因为返回的新函数中的this就不是调用函数了 所以要把this放进fn函数里</li>
<li><strong>返回一个新函数</strong> 先给<code>thisArg</code>对象添加fn方法(就是要改变this的函数) 然后<strong>把原函数的返回结果</strong>也就是对象方法的结果原函数的返回结果<strong>放进<code>result</code>作为新函数的返回结果</strong> 删除属性避免对原thisArg造成干扰 最后把<code>result</code>变量return出去</li>
</ul>
<blockquote>
<p>举例子(没有this干扰)理解<code>result</code>变量的必要性 <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cb32a11ac354c54b6370d8edabb3aa0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148444&amp;x-signature=VKTs%2BquC68jFy3I2Rho2V4pav5o%3D" alt="没有result" loading="lazy"/>
这里把内部函数的返回值return出去 就能实现调用<code>outside</code>函数返回一个<code>inside</code>函数并且把他的她的返回值也复制了<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1ae8e231ad84054be377eaae2d010c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148444&amp;x-signature=P6x4euU6gJ94dNY8ivypP0iF3Jw%3D" alt="有result" loading="lazy"/>最终代码</p>
</blockquote>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-comment">//实现bind</span>
    <span class="hljs-comment">//创建新函数 this绑定到指定对象上</span>
    <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myBind</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">thisArg, ...value</span>) {
      <span class="hljs-comment">//不会立即执行函数 而是返回新的函数</span>
      thisArg = thisArg || <span class="hljs-variable language_">window</span>
      <span class="hljs-keyword">let</span> fn = <span class="hljs-variable language_">this</span> <span class="hljs-comment">//把调用的函数存起来</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
        <span class="hljs-keyword">let</span> key = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'temp'</span>) <span class="hljs-comment">//每次调用都创建新的临时键</span>
        thisArg[key] = fn
        <span class="hljs-keyword">const</span> result = thisArg[key](...value)
        <span class="hljs-keyword">delete</span> thisArg.<span class="hljs-property">fn</span>
        <span class="hljs-keyword">return</span> result  <span class="hljs-comment">//返回原函数的执行结果</span>
      }
    }
</code></pre>
<ul>
<li>测试用例</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//生成新的函数</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">bindFn</span>(<span class="hljs-params">a, b</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'myBind结果'</span>, <span class="hljs-variable language_">this</span>, a, b);
    }
    <span class="hljs-keyword">let</span> <span class="hljs-title class_">Person</span> = {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'a'</span>
    }
    <span class="hljs-keyword">const</span> newBindfn = bindFn.<span class="hljs-title function_">myBind</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>)
<span class="hljs-comment">//传入thisArg为空的情况</span>
    <span class="hljs-keyword">const</span> newBindfn1 = bindFn.<span class="hljs-title function_">myBind</span>(<span class="hljs-string">''</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)  <span class="hljs-comment">//this指向window</span>
<span class="hljs-comment">//新生成的函数返回值</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'函数返回结果'</span>
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fn.<span class="hljs-title function_">myBind</span>(<span class="hljs-title class_">Person</span>)());<span class="hljs-comment">//函数返回结果</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript-小游戏-2048]]></title>    <link>https://juejin.cn/post/7574230922314645510</link>    <guid>https://juejin.cn/post/7574230922314645510</guid>    <pubDate>2025-11-19T09:19:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574230922314645510" data-draft-id="7574245125028069395" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript-小游戏-2048"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-11-19T09:19:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="地狱恶犬萨煤耶"/> <meta itemprop="url" content="https://juejin.cn/user/485304409010298"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript-小游戏-2048
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/485304409010298/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    地狱恶犬萨煤耶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:19:59.000Z" title="Wed Nov 19 2025 09:19:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">需求</h2>
<p>开局生成随机靠边方块
点击方向键移动方块
相邻方块且数值相同发生合并
方块占满界面触发游戏结束提示</p>
<h2 data-id="heading-1">游戏界面</h2>
<h3 data-id="heading-2">标签结构HTML</h3>
<p><code>area</code>区域和<code>death</code>区域分别表示游戏区域和死亡提示区域</p>
<pre><code class="hljs language-js" lang="js"> &lt;!-- 页面 --&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"area"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  &lt;!-- 死亡提示区域 --&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"death"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-3">层叠样式 css</h3>
<p>设置游戏区域为flex布局 主轴默认是水平<code>   flex-wrap: wrap;</code>设置主轴自动换行 注意这里游戏区域的大小是<code>200px*200px</code>的 后面可以算出每个方块的大小</p>
<pre><code class="hljs language-js" lang="js"> .<span class="hljs-property">area</span> {
      <span class="hljs-attr">display</span>: flex;
      flex-<span class="hljs-attr">wrap</span>: wrap;
      <span class="hljs-attr">width</span>: 200px;
      <span class="hljs-attr">height</span>: 200px;
      font-<span class="hljs-attr">size</span>: 30px;
    }
</code></pre>
<h3 data-id="heading-4">获取元素 js</h3>
<p>获取两个游戏区域和游戏结束提示区域的<code>div</code></p>
<pre><code class="hljs language-js" lang="js">   <span class="hljs-keyword">const</span> area = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.area'</span>)
    <span class="hljs-keyword">const</span> death = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.death'</span>)
</code></pre>
<h2 data-id="heading-5">数据分析</h2>
<p><strong>二维数组</strong> 用<code>arr[y][x]</code>第一个索引表示y坐标 第二个索引表示x坐标 数组的值表示方块的数值（2，4，8...)没有值就表示这个坐标位置没有方块
这里还要初始化一个<code>rArr</code>数组是用来将数组旋转结果存入新数组防止重复处理的</p>
<blockquote>
<p>后面的移动和合并都是需要旋转数组进行操作</p>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> arr = [] <span class="hljs-comment">//方块坐标和数值</span>
    <span class="hljs-keyword">let</span> rArr = [] <span class="hljs-comment">//旋转数组</span>
    <span class="hljs-comment">//初始化</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
      arr[i] = []
      rArr[i] = []
    }
</code></pre>
<h2 data-id="heading-6">功能实现</h2>
<h3 data-id="heading-7">渲染方法</h3>
<ul>
<li>像素点的思路渲染游戏区域为<code>5*5</code>个方块 所以算出每个方块 的大小为<code>40px*40px</code>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee013dbcc9e44ca3aaaca311a4fea661~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=hHC0ZHdoOHtd%2B3inAmHIedPODSs%3D" alt="渲染" loading="lazy"/></li>
<li>如果有方块 就渲染为粉色 方块的数值<code>${arr[y][x]}</code>也渲染在<code>div</code>上</li>
<li>其余部分就是画布</li>
<li><code>block</code>字符串累加完毕之后渲染到页面上</li>
</ul>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-comment">//渲染页面</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
      block = <span class="hljs-string">''</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> y = <span class="hljs-number">0</span>; y &lt; <span class="hljs-number">5</span>; y++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">5</span>; x++) {
          <span class="hljs-keyword">if</span> (arr[y][x]) {
            block += <span class="hljs-string">`&lt;div class="square"style="width: 40px;height: 40px;text-align: center; line-height: 40px; background-color: pink;"&gt;<span class="hljs-subst">${arr[y][x]}</span>&lt;/div&gt;`</span>
          }
          <span class="hljs-keyword">else</span> {
            block += <span class="hljs-string">' &lt;div class="block" style="width: 40px;height: 40px;background-color: antiquewhite;"&gt;&lt;/div&gt;'</span>
          }
        }
      }
      area.<span class="hljs-property">innerHTML</span> = block
    }
    <span class="hljs-title function_">render</span>()
</code></pre>
<p>游戏区域页面如下
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1618ae46b6c746978d94d2a2e742d27c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=fAZi6iWgAd52Iwg886BCGvJU81E%3D" alt="游戏区域" loading="lazy"/></p>
<h3 data-id="heading-8">开局随机生成两个方块</h3>
<p>这里的<strong>方块坐标不能重复</strong></p>
<ul>
<li>声明两个数字类型的全局变量 用来表示两个随机生成的坐标</li>
<li>这里的<code>randomStart</code>函数用来<strong>随机生成不重复的两个坐标</strong> <code>a</code>和<code>c</code>变量表示随机生成<code>[0,4]</code>之间的整数坐标 如果生成的随机整数坐标<code>a c</code>重复 就重新调用<code>randomStart</code>函数生成</li>
<li>这里运用了<strong>三元运算符</strong> 来根据<code> Math.random()</code> 随机生成<code>[0,1)</code>范围内的两个小数的大小 决定这两个方块的坐标位置 这里坐标位置可以重复</li>
<li>第一个方块<code>Math.random()&gt; 0.5</code> 执行前面的表达式<code>arr[0][a] = 2 </code>方块随机在上面的边 否则执行后面的表达式<code> arr[a][0] = 2</code>方块随机在左边的边 第二个方块同理</li>
</ul>
<h4 data-id="heading-9">三元运算符</h4>
<p><code>条件?表达式A:表达式B</code> 条件为真执行前面的表达式A 条件为假执行后面的表达式B<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60ddca88c83f4c179b790a4c764c3ad6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=7D8Kkjg%2BRDYt2gos5fCUA%2BGFZSI%3D" alt="三元运算符例" loading="lazy"/>
<strong>常见用法</strong>是处理<code>null</code>值
这里表示 如果传入的参数是假的话name的值为<code> 'stranger'</code> 如果是真的话就是<code>参数name属性</code>的值</p>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-comment">//三元运算符</span>
    <span class="hljs-comment">//以箭头函数形式 定义greeting函数 这里传入的参数是对象</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">greeting</span> = (<span class="hljs-params">person</span>) =&gt; {
      <span class="hljs-keyword">const</span> name = person ? person.<span class="hljs-property">name</span> : <span class="hljs-string">'stranger'</span>
      <span class="hljs-keyword">return</span> <span class="hljs-string">`hello <span class="hljs-subst">${name}</span>`</span>
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">greeting</span>({ <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'a'</span> })); <span class="hljs-comment">//hello a</span>

    <span class="hljs-comment">//这里三元运算符是真 </span>
    <span class="hljs-comment">// 但是字符串本身没有name属性</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">greeting</span>(<span class="hljs-string">'b'</span>)); <span class="hljs-comment">//undefined</span>

    <span class="hljs-comment">//传入的都是字面量 是最简单的表达式 可以通过代码直接看出值</span>
    <span class="hljs-comment">//这些是假值 </span>
    <span class="hljs-comment">//数字字面量</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">greeting</span>(<span class="hljs-number">0</span>)); <span class="hljs-comment">//hello stranger</span>
    <span class="hljs-comment">//null字面量</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">greeting</span>(<span class="hljs-literal">null</span>)); <span class="hljs-comment">//hello stranger</span>
    <span class="hljs-comment">//字符串字面量</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">greeting</span>(<span class="hljs-string">''</span>)); <span class="hljs-comment">//hello stranger</span>
</code></pre>
<p>最终开局随机生成两个方块功能代码如下</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//随机生成两个不相同随机坐标</span>
    <span class="hljs-keyword">let</span> a = <span class="hljs-number">0</span>, c = <span class="hljs-number">0</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">randomStart</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">//生成的随机数不能重复 连续两次的话</span>
      a = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">5</span>)  <span class="hljs-comment">//0-5</span>
      c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">5</span>)
      <span class="hljs-keyword">if</span> (c === a) {
        <span class="hljs-title function_">randomStart</span>()
      }
    }
    <span class="hljs-comment">//开局生成两个不重复的方块</span>
    <span class="hljs-title function_">randomStart</span>()
    <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span> ? arr[<span class="hljs-number">0</span>][a] = <span class="hljs-number">2</span> : arr[a][<span class="hljs-number">0</span>] = <span class="hljs-number">2</span>
    <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span> ? arr[<span class="hljs-number">0</span>][c] = <span class="hljs-number">2</span> : arr[c][<span class="hljs-number">0</span>] = <span class="hljs-number">2</span>
</code></pre>
<p>效果如下
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b46de6fbdf214335923beb3187780b18~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=TgCxieqM%2FOvzgU5XTxG55o0oO0c%3D" alt="随机" loading="lazy"/></p>
<h3 data-id="heading-10">点击方向键移动方块</h3>
<h4 data-id="heading-11">分析点击方向键之后方块变化</h4>
<p>这里有上下左右四个方向 每个方向都要写移动逻辑的话代码冗余了 所以可以<strong>根据要旋转的方向不同对数组进行旋转处理</strong> 然后再左移 这时候再进行左移这个方向的合并判断 最后把数组旋转回去
移动处理完毕之后还需要生成随机新方块</p>
<blockquote>
<p>这里的设计<strong>不太符合单一职责</strong>(一个函数 模块只负责一件事)事件监听承受了太多功能 目前还不知道怎么优化比较好</p>
</blockquote>
<p><strong>根据分析将功能拆分</strong></p>
<ul>
<li><strong>除了向左移动的情况 其他方向都是</strong>  点击键盘方向键之后先更改<code>type</code>的值再根据<code>type</code>调用<code>rotate()</code>函数旋转数组 <code>move()</code>往左移动 <code>add()</code>判断合并最后再<code>rotate()</code>旋转回去</li>
</ul>
<blockquote>
<p>这里的<code>rotate()</code>要传入具体的<code>type</code>参数 因为在上下移动过程中出现了顺时针和逆时针的旋转 这里将数组旋转回去的时候要传入的<code>type</code>就不同了</p>
</blockquote>
<ul>
<li><strong>向左移动的情况很简单</strong> 只需要直接<code>move()</code>移动再执行合并
<strong>移动完之后</strong></li>
<li>生成新随机方块<code> random()</code></li>
<li>此时<code>arr</code>已经处理完毕 <code>rander()</code>渲染页面</li>
<li>判断是否死亡<code>  deathJudge()</code>
键盘按键事件如下</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> type = <span class="hljs-string">''</span><span class="hljs-comment">//移动方向</span>
    <span class="hljs-comment">//每次移动完生成一个边缘新方块</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keydown'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) {
      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'ArrowUp'</span>) {
        type = <span class="hljs-string">'up'</span>
        <span class="hljs-title function_">rotate</span>(<span class="hljs-string">'up'</span>)<span class="hljs-comment">//旋转</span>
        <span class="hljs-title function_">move</span>()<span class="hljs-comment">//移动</span>
        <span class="hljs-title function_">add</span>()
        <span class="hljs-title function_">rotate</span>(<span class="hljs-string">'down'</span>)<span class="hljs-comment">//旋转回去</span>
      }

      <span class="hljs-comment">//这里处理错了down</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'ArrowDown'</span>) {
        type = <span class="hljs-string">'down'</span>
        <span class="hljs-title function_">rotate</span>(<span class="hljs-string">'down'</span>)<span class="hljs-comment">//旋转</span>
        <span class="hljs-title function_">move</span>()<span class="hljs-comment">//移动</span>
        <span class="hljs-title function_">add</span>()
        <span class="hljs-title function_">rotate</span>(<span class="hljs-string">'up'</span>)<span class="hljs-comment">//旋转回去</span>
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'ArrowLeft'</span>) {
        type = <span class="hljs-string">'left'</span>
        <span class="hljs-title function_">move</span>()
        <span class="hljs-title function_">add</span>()
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'ArrowRight'</span>) {
        type = <span class="hljs-string">'right'</span>
        <span class="hljs-title function_">rotate</span>(<span class="hljs-string">'right'</span>)<span class="hljs-comment">//旋转</span>
        <span class="hljs-title function_">move</span>()<span class="hljs-comment">//移动</span>
        <span class="hljs-title function_">add</span>()
        <span class="hljs-comment">//因为这里是翻转 所以和之前一样处理翻转回去就行</span>
        <span class="hljs-title function_">rotate</span>(<span class="hljs-string">'right'</span>)
      }
      <span class="hljs-comment">//移动处理完毕生成新随机方块</span>
      <span class="hljs-title function_">random</span>()
      <span class="hljs-title function_">render</span>()
      <span class="hljs-title function_">deathJudge</span>()
    })

</code></pre>
<h4 data-id="heading-12">旋转处理</h4>
<ul>
<li>如果有值就根据<code>type</code>不同旋转
<strong>right</strong> 这里相当于翻转 所以旋转回去只需要再翻转一次<code>rotate('right')</code>就行<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b067a42e26c40d1a2a97f90975a479d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=XhzfWcMBwpl1eG6EzxRhXvN7fBs%3D" alt="right" loading="lazy"/>
<strong>down</strong>这里相当于<strong>顺时针旋转90度</strong> 所以旋转回去需要逆时针旋转90度也就是<code>rotate(up)</code><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56c67c46f8784030a7f97f0c368b7739~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=c5ZtkJ%2FaZpqUNYqS5Rr0Hmy21q0%3D" alt="down" loading="lazy"/></li>
</ul>
<p><strong>up</strong>这里相当于<strong>逆时针旋转90度</strong> 所以旋转回去需要顺时针旋转90度也就是<code>rotate('down')</code><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf68477dc7444f938e9fcd9e25730880~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=K91IQ20cx%2Bd3MzHPC7s5QxGKca4%3D" alt="up" loading="lazy"/></p>
<ul>
<li>旋转完毕后 删除已经处理完旋转的元素 便于后面将旋转之后的数组给arr</li>
</ul>
<blockquote>
<p>这里删除处理也可以用<code>delete</code> 不会破坏索引!<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46045a909c5248e39b071689b265328b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=PtYUG9ntyrjwodauCawuCygOM4g%3D" alt="delete" loading="lazy"/></p>
</blockquote>
<ul>
<li>然后遍历<code>rArr</code>把数值给arr 再把rArr相应的元素删除方便下次<code>rotate()</code>旋转</li>
</ul>
<blockquote>
<p>放进新数组是为了防止旋转后的元素被重复旋转遍历
最终代码如下</p>
</blockquote>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-comment">//翻转数组 变成左移</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">rotate</span>(<span class="hljs-params">type</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'rotate'</span>, type);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> y = <span class="hljs-number">0</span>; y &lt; <span class="hljs-number">5</span>; y++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">5</span>; x++) {
          <span class="hljs-keyword">if</span> (arr[y][x]) {
            <span class="hljs-comment">//翻转</span>
            <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'right'</span>) {
              <span class="hljs-comment">//这里旋转结果必须放进新数组防止重复处理</span>
              rArr[y][<span class="hljs-number">4</span> - x] = arr[y][x]
            }
            <span class="hljs-comment">//顺时针90</span>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'down'</span>) {
              rArr[x][<span class="hljs-number">4</span> - y] = arr[y][x]
            }
            <span class="hljs-comment">//逆时针90</span>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'up'</span>) {
              rArr[<span class="hljs-number">4</span> - x][y] = arr[y][x]
            }
            <span class="hljs-comment">//删除原位置元素</span>
            <span class="hljs-comment">// arr[y][x] = 0</span>
            <span class="hljs-keyword">delete</span> arr[y][x]
          }
        }
      }
      <span class="hljs-comment">//把旋转之后的数组给arr 方便转回去</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">5</span>; j++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
          <span class="hljs-keyword">if</span> (rArr[j][i]) {
            arr[j][i] = rArr[j][i]
            <span class="hljs-keyword">delete</span> rArr[j][i]
          }
        }
      }
      <span class="hljs-comment">// console.log('rotate旋转处理之后的arr', arr);</span>
    }
</code></pre>
<h4 data-id="heading-13">移动处理</h4>
<p>旋转完毕后 数组只需要左移动就可以</p>
<ul>
<li>首先遍历<code>arr数组</code> 如果这行出现空位 <code>!arr[y][x]</code>为<code>true</code> 表示 <code>arr[y][x]</code>为false也就是为空和0的时候 执行后面的语句</li>
<li>就<strong>遍历这一行空位后面的部分</strong> 这里循环的起始点是<code>i = x</code> 如果后面有值就给前面空位 这里记得删掉后面的值 然后直接<code>break</code>跳出空位后元素遍历循环继续对这一行进行空位搜索</li>
</ul>
<blockquote>
<p>补充说明<code>break</code>和<code>continue</code>的区别
<code>break</code>只跳出一层循环 这里相当于 <code>x&gt;=1</code>的情况下都不执行内层循环了
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/adf1db51f9cc4839b7b6e19e1d64d645~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=BzXB6t7PvZw%2FlkP1uyceaTw5hcc%3D" alt="break" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29b6645af89c4bff9aee8d7154b41f82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=uKxd3qJ5I5Oh%2BB2dOwu9yNSdcHE%3D" alt="break" loading="lazy"/>
<code>continue</code>跳过当前 然后进行下一个迭代 这里相当于只有在<code>x===1</code>的情况下才不执行内层循环 其他情况是正常执行的
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/518ed6e0ce8343bcb9748c0a05962e48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=w%2Beess9IslcPzp2lSM2RtZz8Tog%3D" alt="continue" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b6a551e6e1b47c8905c36359d5fcb33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=cOBhodRSECGA2hKwaUk1i2zdkME%3D" alt="continue" loading="lazy"/></p>
</blockquote>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-comment">// 移动逻辑</span>
    <span class="hljs-comment">//所有数组都旋转处理成左移判断</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">move</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'move'</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> y = <span class="hljs-number">0</span>; y &lt; <span class="hljs-number">5</span>; y++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">5</span>; x++) {
          <span class="hljs-keyword">if</span> (!arr[y][x]) {
            <span class="hljs-comment">//后面如果后面有值就给前面空位</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = x; i &lt; <span class="hljs-number">5</span>; i++) {
              <span class="hljs-comment">//只执行一次 找出最靠近空位的值</span>
              <span class="hljs-keyword">if</span> (arr[y][i]) {
                arr[y][x] = arr[y][i]
                arr[y][i] = <span class="hljs-number">0</span>
                <span class="hljs-comment">//这里用哪个符号比较好</span>
                <span class="hljs-keyword">break</span> <span class="hljs-comment">//跳出for i 循环么</span>
              }
            }
          }
        }
      }
    }
</code></pre>
<p>点击方向键移动方块效果如下
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bdd48d771f914d1a95a70293ddb46f2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=SbhDY6wC1FNK4qw5Ayc7Q8RlOes%3D" alt="移动" loading="lazy"/></p>
<h3 data-id="heading-14">合并判断</h3>
<p>这里合并判断也会根据方向不同 判断的方向不同 所以这里放在数组旋转回去之前 所以无论方向如何都是<strong>对左移进行合并判断</strong></p>
<ul>
<li><strong>合并</strong>这里是向左合并的 判断的是<code>arr[j][i] </code>和右边相邻位置 <code>arr[j][i + 1]</code>的元素数值 这里的判断范围缩小<code>i &lt; 4</code> 如果相等就左边方块数值累加然后右边方块数值清空</li>
</ul>
<blockquote>
<p>注意 这里只完成了数值的合并 合并完之后还要向左移动 如图例<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1377ced2d4c4857ac1cff9860853113~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=S58cd2p%2BJdkxZ2ZuU%2FEtj8BuwL0%3D" alt="合并之后移动" loading="lazy"/></p>
</blockquote>
<ul>
<li>全部合并完之后要都<strong>向左移动</strong><code>move()</code></li>
</ul>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-comment">//合并</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'合并add'</span>, type, arr);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">5</span>; j++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) {
          <span class="hljs-comment">//相邻检测</span>
          <span class="hljs-keyword">if</span> (arr[j][i]) {
            <span class="hljs-keyword">if</span> (arr[j][i] === arr[j][i + <span class="hljs-number">1</span>]) {
              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'找到左移方块'</span>, j, i);
              arr[j][i] += arr[j][i]
              arr[j][i + <span class="hljs-number">1</span>] = <span class="hljs-number">0</span>
            }
          }
        }
      }
      <span class="hljs-comment">//全部合并完之后再向左移动</span>
      <span class="hljs-title function_">move</span>()
    }
</code></pre>
<p>合并效果如下
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c019edda8de84c94b803295551964137~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=fuJ5IDT8GUWrCf%2FJJN9Rp6216zU%3D" alt="合并" loading="lazy"/></p>
<h3 data-id="heading-15">移动完毕生成新随机方块</h3>
<p>这些方块是从没有方块的坐标中随机生成的</p>
<ul>
<li><code>scope</code>数组表示没有方块的坐标 第一个索引表示方块序号可以用来随机选取方块 第二个索引表示方块的x或者y值
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42404ffe36934a10af7bc687023cb03e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=B5TxEe9smTO5HnOgn6a4i5tXcIc%3D" alt="scope" loading="lazy"/></li>
<li>循环遍历<code>arr</code>把没有值的坐标放进<code>scope</code>数组</li>
<li><code>index</code>表示随机的<code>scope</code>索引 范围为<code>[0,scope.length-1]</code></li>
</ul>
<blockquote>
<p>用<code>Math.floor </code>和 <code>Math.random </code>表示从<code>[a,b]</code>随机整数
<code>Math.floor(Math.random() * (b - a + 1)) + a;</code>
<code>Math.random()</code>随机生成<code>[0,1)</code>之间的随机小数  <code>Math.random() * (b - a + 1) </code>生成<code>[0,b-a+1)</code>
<code>Math.floor </code>对小数向下取整得到<code>[0,b-a]</code>之间的整数
最后再加上<code>a</code> 范围偏移成<code>[a,b]</code></p>
</blockquote>
<ul>
<li>这里<code>randomY</code>表示随机到的y坐标 也就是<code>scope[index][0]</code>第<code>index</code>个方块的第0个坐标</li>
<li>最后随机生成的方块数值可能为2和4 继续用<code>Math.random()</code>随机生成的小数和0.5的大小比较决定随机生成方块的数值</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//移动之后再随机生成一个方块 数值可能是4或者2</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">random</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">let</span> scope = []
      <span class="hljs-comment">//因为可能后面没有值 长度实际上小于10</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">5</span>; j++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
          <span class="hljs-comment">//方块不重复</span>
          <span class="hljs-comment">//把没有值的坐标放进数组 然后再随机索引进行选择</span>
          <span class="hljs-keyword">if</span> (!arr[j][i]) {
            scope.<span class="hljs-title function_">push</span>([j, i])
          }
        }
      }
      <span class="hljs-comment">//随机索引</span>
      <span class="hljs-keyword">let</span> index = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * scope.<span class="hljs-property">length</span>)
      <span class="hljs-keyword">let</span> randomY = scope[index][<span class="hljs-number">0</span>]
      <span class="hljs-keyword">let</span> randomX = scope[index][<span class="hljs-number">1</span>]

      <span class="hljs-comment">//随机数值</span>
      <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span> ? arr[randomY][randomX] = <span class="hljs-number">2</span> : arr[randomY][randomX] = <span class="hljs-number">4</span>
    }
</code></pre>
<p>移动完毕生成新随机方块效果如下
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eebb68e73cfc48a9860aea5d3e2123ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=g8sACbcsUe1LSIHD9F8L5M%2Fi8hI%3D" alt="新方块" loading="lazy"/></p>
<h3 data-id="heading-16">死亡功能</h3>
<h4 data-id="heading-17">死亡判断</h4>
<p>开局只生成两个方块不需要判断 之后每次移动完毕都要判断一次</p>
<ul>
<li><code>death</code>表示是否出现死亡 Boolean类型初始值是<code>true</code></li>
<li>遍历<code>arr</code> 如果位置上元素没有值 就还没有死亡 <code>death = false</code>  <strong>这个是要找的非常态 出现这种情况就知道最终结果了</strong> 所以初始值是常态<code>true</code> 元素上有值还要继续往下找</li>
</ul>
<blockquote>
<p>这里不能用<code>!arr[j].every((value) =&gt; value &gt; 1)</code> 因为<code>every</code><strong>对稀疏数组的空槽是不执行</strong>的 在<code>random()</code>和<code>randomStart()</code>给随机坐标赋值的时候造成了<code>arr[j]</code>是稀疏数组 会导致判断失误
补充说明 <strong>稀疏数组创建方式</strong><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec67202d125d4966b80bbc40acabbabd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=VbLkyMo9qbwG5noEnApOqgo%2BjPA%3D" alt="稀疏数组" loading="lazy"/></p>
</blockquote>
<ul>
<li>最终的<code>death</code>值就能表示死亡情况</li>
<li>如果<code>death === true</code>就执行死亡效果</li>
</ul>
<pre><code class="hljs language-js" lang="js">   <span class="hljs-comment">//死亡判断</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">deathJudge</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">let</span> death = <span class="hljs-literal">true</span> <span class="hljs-comment">//表示是否进入死亡</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> y = <span class="hljs-number">0</span>; y &lt; <span class="hljs-number">5</span>; y++) {
        <span class="hljs-comment">//如果这一行有空位 就跳出循环</span>
        <span class="hljs-comment">//这里不是表示每个都大于</span>
        <span class="hljs-comment">//不能用every因为稀疏数组不执行</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">5</span>; x++) {
          <span class="hljs-comment">//有一个位置上的元素没有值 就不是死亡</span>
          <span class="hljs-keyword">if</span> (!arr[y][x]) {
            death = <span class="hljs-literal">false</span>
          }
        }
      }
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(death, <span class="hljs-string">'死亡判断'</span>);
      <span class="hljs-keyword">if</span> (death === <span class="hljs-literal">true</span>) {
        <span class="hljs-title function_">deachCss</span>()  <span class="hljs-comment">//死亡效果</span>
      }
    }
</code></pre>
<h4 data-id="heading-18">死亡效果</h4>
<p>要找出方块数值最大值打印在游戏结束区域</p>
<ul>
<li><code>maxArr</code>数组用来放每行的最大值</li>
<li><code>maxX</code>表示每行的最大值 找出来之后放进<code>maxArr</code>数组</li>
<li><strong><code>arr[y]</code>采用线性遍历 像直线一样逐个排查</strong> 这里默认每行的第一个元素为最大值 然后遍历后面的元素 如果比<code>maxX</code>大 就更新 把值给<code>maxX</code></li>
</ul>
<blockquote>
<p>后面还会更新数组最大值的一些比较方法</p>
</blockquote>
<ul>
<li>把每行的最大值<code>push</code>进<code>maxArr</code>数组</li>
<li>然后再对<code>maxArr</code>进行线性遍历 从而找到整个<code>arr</code>数组的最大值</li>
<li>最后把最大数值渲染到页面</li>
</ul>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-keyword">function</span> <span class="hljs-title function_">deachCss</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">//找到数组中的最大数值</span>
      <span class="hljs-keyword">let</span> maxArr = []
      <span class="hljs-keyword">let</span> maxX = <span class="hljs-number">0</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> y = <span class="hljs-number">0</span>; y &lt; <span class="hljs-number">5</span>; y++) {
        maxX = arr[y][<span class="hljs-number">0</span>]
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = <span class="hljs-number">1</span>; x &lt; <span class="hljs-number">5</span>; x++) {
          <span class="hljs-keyword">if</span> (arr[y][x] &gt; maxX) {
            maxX = arr[y][x]
          }
        }
        maxArr.<span class="hljs-title function_">push</span>(maxX) <span class="hljs-comment">//每行的最大</span>
      }
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(maxArr);
      <span class="hljs-comment">//再从每行的最大里面找</span>
      <span class="hljs-keyword">let</span> max = maxArr[<span class="hljs-number">0</span>]
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> a = <span class="hljs-number">1</span>; a &lt; maxArr.<span class="hljs-property">length</span>; a++) {
        <span class="hljs-keyword">if</span> (max &lt; maxArr[a]) {
          max = maxArr[a]
        }
      }
      <span class="hljs-comment">//死亡效果</span>
      death.<span class="hljs-property">innerText</span> = <span class="hljs-string">`游戏结束 最大方块为<span class="hljs-subst">${max}</span>`</span>
    }
</code></pre>
<p>死亡效果如下
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad7163d2fccd4a27b511584a6a95d1fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyw54ux5oG254qs6JCo54Wk6IC2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148799&amp;x-signature=6%2FXL4uWM6qeQnXYBWqHYuHUw%2FGo%3D" alt="死亡效果" loading="lazy"/></p>
<h2 data-id="heading-19">最终代码</h2>
<pre><code class="hljs language-js" lang="js">&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
  &lt;title&gt;2048&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;!-- 页面 --&gt;
  &lt;div class="area"&gt;&lt;/div&gt;
  &lt;!-- 死亡提示区域 --&gt;
  &lt;div class="death"&gt;&lt;/div&gt;
  &lt;style&gt;
    .area {
      display: flex;
      flex-wrap: wrap;
      width: 200px;
      height: 200px;
      font-size: 25px;
    }
  &lt;/style&gt;
  &lt;script&gt;
    const area = document.querySelector('.area')
    const death = document.querySelector('.death')
    let arr = [] //方块坐标和数值
    let rArr = [] //旋转数组
    //初始化
    for (let i = 0; i &lt; 5; i++) {
      arr[i] = []
      rArr[i] = []
    }
    deathJudge() //开局只随机生成两个方块不需要判断死亡

    //随机生成两个不相同随机坐标
    let a = 0, c = 0
    function randomStart() {
      //生成的随机数不能重复 连续两次的话
      a = Math.floor(Math.random() * 5)  //0-5
      c = Math.floor(Math.random() * 5)
      if (c === a) {
        randomStart()
      }
    }
    //开局生成两个不重复的方块
    randomStart()
    Math.random() &gt; 0.5 ? arr[0][a] = 2 : arr[a][0] = 2
    Math.random() &gt; 0.5 ? arr[0][c] = 2 : arr[c][0] = 2

    //移动之后再随机生成一个方块 数值可能是4或者2
    function random() {
      let scope = []
      for (let j = 0; j &lt; 5; j++) {
        for (let i = 0; i &lt; 5; i++) {
          //方块不重复
          //把没有值的坐标放进数组 然后再随机索引进行选择
          if (!arr[j][i]) {
            scope.push([j, i])
          }
        }
      }
      //随机索引
      let index = Math.floor(Math.random() * scope.length)
      let randomY = scope[index][0]
      let randomX = scope[index][1]

      //随机数值
      Math.random() &gt; 0.5 ? arr[randomY][randomX] = 2 : arr[randomY][randomX] = 4
    }


    let type = ''//移动方向
    //每次移动完生成一个边缘新方块

    document.addEventListener('keydown', function (e) {
      if (e.key === 'ArrowUp') {
        type = 'up'
        rotate('up')//旋转
        move()//移动
        add()
        rotate('down')//旋转回去

      }

      //这里处理错了down
      else if (e.key === 'ArrowDown') {
        type = 'down'
        rotate('down')//旋转
        move()//移动
        add()
        rotate('up')//旋转回去

      }
      else if (e.key === 'ArrowLeft') {
        type = 'left'
        move()
        add()
      }
      else if (e.key === 'ArrowRight') {
        type = 'right'
        rotate('right')//旋转
        move()//移动
        add()
        //因为这里是翻转 所以和之前一样处理翻转回去就行
        rotate('right')
      }
      //移动处理完毕生成新随机方块
      random()
      render()
      deathJudge()
    })

    //翻转数组 变成左移
    function rotate(type) {
      console.log('rotate', type);
      for (let y = 0; y &lt; 5; y++) {
        for (let x = 0; x &lt; 5; x++) {
          if (arr[y][x]) {
            //翻转
            if (type === 'right') {
              //这里旋转结果必须放进新数组防止重复处理
              rArr[y][4 - x] = arr[y][x]
            }
            //顺时针90
            else if (type === 'down') {
              rArr[x][4 - y] = arr[y][x]
            }
            //逆时针90
            else if (type === 'up') {
              rArr[4 - x][y] = arr[y][x]
            }
            //删除原位置元素
            // arr[y][x] = 0
            delete arr[y][x]
          }
        }
      }
      //把旋转之后的数组给arr 方便转回去
      for (let j = 0; j &lt; 5; j++) {
        for (let i = 0; i &lt; 5; i++) {
          if (rArr[j][i]) {
            arr[j][i] = rArr[j][i]
            delete rArr[j][i]
          }
        }
      }
      // console.log('rotate旋转处理之后的arr', arr);
    }


    // 移动逻辑
    //所有数组都旋转处理成左移判断
    function move() {
      console.log('move');
      for (let y = 0; y &lt; 5; y++) {
        for (let x = 0; x &lt; 5; x++) {
          if (!arr[y][x]) {
            //后面如果后面有值就给前面空位
            for (let i = x; i &lt; 5; i++) {
              //只执行一次 找出最靠近空位的值
              if (arr[y][i]) {
                arr[y][x] = arr[y][i]
                arr[y][i] = 0
                //这里用哪个符号比较好
                break //跳出for i 循环么
              }
            }
          }
        }
      }
    }

    //合并
    function add() {
      console.log('合并add', type, arr);
      for (let j = 0; j &lt; 5; j++) {
        for (let i = 0; i &lt; 4; i++) {
          //相邻检测
          if (arr[j][i]) {
            if (arr[j][i] === arr[j][i + 1]) {
              console.log('找到左移方块', j, i);
              arr[j][i] += arr[j][i]
              arr[j][i + 1] = 0
            }
          }
        }
      }
      //全部合并完之后再向左移动
      move()
    }

    //死亡判断
    function deathJudge() {
      let death = true //表示是否进入死亡
      for (let y = 0; y &lt; 5; y++) {
        //如果这一行有空位 就跳出循环
        //这里不是表示每个都大于
        //不能用every因为稀疏数组不执行
        for (let x = 0; x &lt; 5; x++) {
          //有一个位置上的元素没有值 就不是死亡
          if (!arr[y][x]) {
            death = false
          }
        }
      }
      console.log(death, '死亡判断');
      if (death === true) {
        deachCss()  //死亡效果
      }
    }


    function deachCss() {
      //找到数组中的最大数值
      let maxArr = []
      let maxX = 0
      for (let y = 0; y &lt; 5; y++) {
        maxX = arr[y][0]
        for (let x = 1; x &lt; 5; x++) {
          if (arr[y][x] &gt; maxX) {
            maxX = arr[y][x]
          }
        }
        maxArr.push(maxX) //每行的最大
      }
      console.log(maxArr);
      //再从每行的最大里面找
      let max = maxArr[0]
      for (let a = 1; a &lt; maxArr.length; a++) {
        if (max &lt; maxArr[a]) {
          max = maxArr[a]
        }
      }
      //死亡效果
      death.innerText = `游戏结束 最大方块为${max}`
    }


    //渲染页面
    function render() {
      block = ''
      for (let y = 0; y &lt; 5; y++) {
        for (let x = 0; x &lt; 5; x++) {
          if (arr[y][x]) {
            block += `&lt;div class="square"style="width: 40px;height: 40px;text-align: center; line-height: 40px; background-color: pink;"&gt;${arr[y][x]}&lt;/div&gt;`
          }
          else {
            block += ' &lt;div class="block" style="width: 40px;height: 40px;background-color: antiquewhite;"&gt;&lt;/div&gt;'

          }
        }
      }
      area.innerHTML = block
    }
    render()


  &lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[playwright的调试模式，方便调试selector, locator语法及查找效果]]></title>    <link>https://juejin.cn/post/7574217823105531955</link>    <guid>https://juejin.cn/post/7574217823105531955</guid>    <pubDate>2025-11-19T09:20:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574217823105531955" data-draft-id="7574244766423515145" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="playwright的调试模式，方便调试selector, locator语法及查找效果"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T09:20:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="yeyong"/> <meta itemprop="url" content="https://juejin.cn/user/4283353031781063"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            playwright的调试模式，方便调试selector, locator语法及查找效果
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4283353031781063/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    yeyong
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:20:35.000Z" title="Wed Nov 19 2025 09:20:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>下面是一套“<strong>边写边测</strong>”的通用套路，确保 <code>page.locator()</code> / <code>wait_for_selector()</code> 在提交代码前就能一次跑通，<strong>不用每次都重跑完整流程</strong>。</p>
<hr/>
<ol>
<li>官方“秒测”工具：Playwright Inspector</li>
</ol>
<hr/>
<p>命令行里加 <code>--paused</code> 即可打开自带调试器：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Python 例子</span>
PWDEBUG=1 pytest my_test.py
<span class="hljs-comment"># 或直接</span>
playwright codegen https://your-site.com
</code></pre>
<ul>
<li>左侧 <strong>“Pick”</strong> 图标点一下，再点页面元素 → 自动生成最稳的 locator 代码。</li>
<li>右侧 <strong>“Explore”</strong> 面板会实时显示：<br/>
– 匹配到几个节点<br/>
– 实际文本/属性值<br/>
– 高亮渲染<br/>
→ 把生成的代码复制进脚本即可，<strong>零手写</strong>。</li>
</ul>
<hr/>
<ol start="2">
<li>在代码里快速“断言+高亮”</li>
</ol>
<hr/>
<pre><code class="hljs language-python" lang="python">loc = page.locator(<span class="hljs-string">'span.text-20px.font-bold'</span>)

<span class="hljs-comment"># 1) 断言存在且唯一</span>
expect(loc).to_have_count(<span class="hljs-number">1</span>)   <span class="hljs-comment"># 多于 1 个会立即失败</span>

<span class="hljs-comment"># 2) 临时高亮 2 秒，肉眼确认</span>
loc.evaluate(<span class="hljs-string">'el =&gt; el.style.border = "3px solid red"'</span>)
page.wait_for_timeout(<span class="hljs-number">2000</span>)
</code></pre>
<p>跑单条用例时一眼就能看到是不是你想找的元素。</p>
<hr/>
<ol start="3">
<li>交互式 REPL —— 边敲边回车</li>
</ol>
<hr/>
<p>官方提供 <strong>sync_playwright 的交互模式</strong>：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright
p = sync_playwright().start()
browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)
page = browser.new_page()
page.goto(<span class="hljs-string">'https://your-site'</span>)
<span class="hljs-comment"># 现在可以随便敲</span>
loc = page.locator(<span class="hljs-string">'button.el-button--primary'</span>)
loc.count()        <span class="hljs-comment"># 立即返回匹配数量</span>
loc.text_content() <span class="hljs-comment"># 立即返回文本</span>
loc.highlight()    <span class="hljs-comment"># 页面直接闪绿框</span>
</code></pre>
<p>调试完把确认好的 locator 复制到正式脚本即可。</p>
<hr/>
<ol start="4">
<li>脚本内“打印调试法”（最轻量）</li>
</ol>
<hr/>
<pre><code class="hljs language-python" lang="python">loc = page.locator(<span class="hljs-string">'span:has-text("崔新")'</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'匹配数:'</span>, loc.count())      <span class="hljs-comment"># → 1 才继续</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">'文本:'</span>, loc.text_content()) <span class="hljs-comment"># → 崔新</span>
</code></pre>
<hr/>
<ol start="5">
<li>常见踩坑 checklist</li>
</ol>
<hr/>
<ul>
<li>元素在 iframe → 先 <code>page.frame_locator('#xxx').locator(...)</code></li>
<li>等待时机不对 → 外加 <code>loc.wait_for()</code> 或 <code>expect(loc).to_be_visible()</code></li>
<li>动态 class 顺序变化 → 用 <code>[class*="text-20px"]</code> 而非完整串</li>
<li>文本前后有空格 → <code>text=/\s*崔新\s*/</code>（Playwright 正则语法）</li>
</ul>
<hr/>
<h2 data-id="heading-0">一句话流程</h2>
<ol>
<li><code>PWDEBUG=1 pytest</code> → Inspector 自动生成 locator</li>
<li>脚本里 <code>expect(loc).to_have_count(1)</code> + <code>loc.highlight()</code> 确认</li>
<li>通过后再集成到完整用例，<strong>基本一次写对</strong>。</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[基于UniappX开发电销APP，实现CRM后台控制APP自动拨号]]></title>    <link>https://juejin.cn/post/7574040813750272051</link>    <guid>https://juejin.cn/post/7574040813750272051</guid>    <pubDate>2025-11-19T09:21:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574040813750272051" data-draft-id="7574270661871812646" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="基于UniappX开发电销APP，实现CRM后台控制APP自动拨号"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-11-19T09:21:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="爱心发电丶"/> <meta itemprop="url" content="https://juejin.cn/user/79577698543709"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            基于UniappX开发电销APP，实现CRM后台控制APP自动拨号
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/79577698543709/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    爱心发电丶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:21:03.000Z" title="Wed Nov 19 2025 09:21:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>原文：<a href="https://link.juejin.cn?target=https%3A%2F%2Fnicen.cn%2F8532.html" target="_blank" title="https://nicen.cn/8532.html" ref="nofollow noopener noreferrer">nicen.cn/8532.html</a></p>
<p>在上一篇文章中（<a href="https://juejin.cn/post/7573528564025802798" target="_blank" title="https://juejin.cn/post/7573528564025802798">juejin.cn/post/757352…</a>），已经实现了电销APP的基础功能：通时通次记录、通话录音上传。 已经能在工作中进行应用了，但是离成熟的电销APP还是差了不少，还得继续开发。</p>
<p>电销APP大都还有一个与之对应的CRM系统，所以另一个常见的需求，就是通过CRM后台直接控制APP拨号。</p>
<p>相关代码和电销APP已经开源：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffriend-nicen%2Funicall" target="_blank" title="https://github.com/friend-nicen/unicall" ref="nofollow noopener noreferrer">github.com/friend-nice…</a></p>
<h2 data-id="heading-0">开发思路</h2>
<p>常规需求用常规的办法：在保证消息收发高效实时的前提下，后端实现一个Websocket服务用于和APP用户端实时通信，再通过http提供接口给CRM后台调用，触发APP端拨号。从技术栈匹配度来看，用Node实现这个需求再合适不过了。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9b8c8400ad14b87a65b472c91c61f01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix5b-D5Y-R55S15Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764148863&amp;x-signature=OrLQt8sA8mUnMA%2FeJYVFnDYEIqs%3D" alt="基于UniappX开发电销APP，实现CRM后台控制APP自动拨号" loading="lazy"/></p>
<h3 data-id="heading-1">1.实现Websocket服务</h3>
<p>考虑到我的需求面向的是Saas多公司的系统，所以先实现一个方便存取ws链接的连接池对象，嵌套的两层Map对象，第一层是区分哪个公司，然后是哪个用户：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> corpClients = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
</code></pre>
<p>通过ws来实现Websocket服务，简单的几行代码，再加上自己的业务逻辑。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> wss = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketServer</span>({<span class="hljs-attr">host</span>: <span class="hljs-string">'0.0.0.0'</span>, <span class="hljs-attr">port</span>: <span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">ports</span>.<span class="hljs-property">ws</span>});
  <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`WebSocket服务器运行在 ws://localhost:<span class="hljs-subst">${CONFIG.ports.ws}</span>`</span>);

  wss.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connection'</span>, <span class="hljs-function">(<span class="hljs-params">ws, req</span>) =&gt;</span> {

    <span class="hljs-keyword">let</span> ip = req.<span class="hljs-property">headers</span>[<span class="hljs-string">'x-real-ip'</span>]
        || req.<span class="hljs-property">headers</span>[<span class="hljs-string">'x-forwarded-for'</span>]?.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>)[<span class="hljs-number">0</span>].<span class="hljs-title function_">trim</span>()
        || req.<span class="hljs-property">socket</span>.<span class="hljs-property">remoteAddress</span>;

    <span class="hljs-keyword">if</span> (ip.<span class="hljs-title function_">substr</span>(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>) === <span class="hljs-string">'::ffff:'</span>) ip = ip.<span class="hljs-title function_">substr</span>(<span class="hljs-number">7</span>);

    <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">debug</span>(<span class="hljs-string">`新的WebSocket连接，<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({remoteAddress: ip, url: req.url})}</span>`</span>);
    <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`当前连接数: <span class="hljs-subst">${getConnectionCount()}</span>`</span>);

    ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">corp</span> &amp;&amp; ws.<span class="hljs-property">phone</span>) {
        <span class="hljs-keyword">const</span> companyMap = corpClients.<span class="hljs-title function_">get</span>(ws.<span class="hljs-property">corp</span>);
        <span class="hljs-keyword">if</span> (companyMap) {
          companyMap.<span class="hljs-title function_">delete</span>(ws.<span class="hljs-property">phone</span>);
          <span class="hljs-keyword">if</span> (companyMap.<span class="hljs-property">size</span> === <span class="hljs-number">0</span>) corpClients.<span class="hljs-title function_">delete</span>(ws.<span class="hljs-property">corp</span>);
        }
        <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">debug</span>(<span class="hljs-string">'WebSocket连接关闭'</span>, {<span class="hljs-attr">phone</span>: ws.<span class="hljs-property">phone</span>, <span class="hljs-attr">corp</span>: ws.<span class="hljs-property">corp</span>, <span class="hljs-attr">remainingClients</span>: <span class="hljs-title function_">getConnectionCount</span>()});
      }
    });

    ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'WebSocket连接错误'</span>, error);
      <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">corp</span> &amp;&amp; ws.<span class="hljs-property">phone</span>) {
        <span class="hljs-keyword">const</span> companyMap = corpClients.<span class="hljs-title function_">get</span>(ws.<span class="hljs-property">corp</span>);
        <span class="hljs-keyword">if</span> (companyMap) {
          companyMap.<span class="hljs-title function_">delete</span>(ws.<span class="hljs-property">phone</span>);
          <span class="hljs-keyword">if</span> (companyMap.<span class="hljs-property">size</span> === <span class="hljs-number">0</span>) corpClients.<span class="hljs-title function_">delete</span>(ws.<span class="hljs-property">corp</span>);
        }
      }
    });
  });
</code></pre>
<p>考虑到用户连接之后，得区分这个连接是哪个用户，所以还得有一个类似登录的过程，登录之后的链接才会保存到连接池。</p>
<pre><code class="hljs language-javascript" lang="javascript">ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">body</span>) =&gt;</span> {

      <span class="hljs-keyword">const</span> data = body.<span class="hljs-title function_">toString</span>();
      <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`收到消息：<span class="hljs-subst">${data}</span>，<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({remoteAddress: ip})}</span>`</span>);

      <span class="hljs-comment">/* 维持心跳 */</span>
      <span class="hljs-keyword">if</span> (data === <span class="hljs-string">'ping'</span>) {
        ws.<span class="hljs-title function_">send</span>(<span class="hljs-string">"1"</span>);
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> msg = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
        <span class="hljs-keyword">if</span> (!ws.<span class="hljs-property">phone</span> &amp;&amp; msg.<span class="hljs-property">type</span> === <span class="hljs-string">'login'</span>) {
          <span class="hljs-keyword">if</span> (msg?.<span class="hljs-property">name</span> &amp;&amp; msg?.<span class="hljs-property">corp</span>) {
            <span class="hljs-keyword">const</span> phone = msg.<span class="hljs-property">name</span>;
            <span class="hljs-keyword">const</span> corp = <span class="hljs-title class_">String</span>(msg.<span class="hljs-property">corp</span>);
            <span class="hljs-keyword">let</span> companyMap = corpClients.<span class="hljs-title function_">get</span>(corp);
            <span class="hljs-keyword">if</span> (!companyMap) {
              companyMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
              corpClients.<span class="hljs-title function_">set</span>(corp, companyMap);
            }
            <span class="hljs-keyword">const</span> existingClient = companyMap.<span class="hljs-title function_">get</span>(phone);
            <span class="hljs-keyword">if</span> (existingClient) {
              <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`禁止重复登录，通知<span class="hljs-subst">${phone}</span>自动退出！`</span>);
              existingClient.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({<span class="hljs-attr">type</span>: <span class="hljs-string">'quit'</span>, <span class="hljs-attr">name</span>: phone}));
              companyMap.<span class="hljs-title function_">delete</span>(phone);
            }
            <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`新消息：<span class="hljs-subst">${phone}</span>上线`</span>);
            ws.<span class="hljs-property">phone</span> = phone;
            ws.<span class="hljs-property">corp</span> = corp;
            companyMap.<span class="hljs-title function_">set</span>(phone, ws);
          }
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'处理WebSocket消息失败'</span>, error);
      }
    });
</code></pre>
<p>提示：考虑到安全性的问题，可以继续完善做进一步的认证</p>
<h3 data-id="heading-2">2.实现http接口</h3>
<p>CRM后台唤起拨号的这个操作是不定时不定量的，所以不需要考虑到实时性的问题，所以通过提供http接口来实现是完全够用的。</p>
<p>通过Hono来快速实现接口，然后调用上面保存的连接池来向APP发送实时消息：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hono</span>();

<span class="hljs-keyword">const</span> <span class="hljs-title function_">param</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">c</span>) =&gt; {
    <span class="hljs-keyword">let</span> data = {};
    <span class="hljs-keyword">const</span> queryParams = c.<span class="hljs-property">req</span>.<span class="hljs-title function_">query</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(queryParams).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) data = {...data, ...queryParams};
    <span class="hljs-keyword">if</span> (c.<span class="hljs-property">req</span>.<span class="hljs-property">method</span> === <span class="hljs-string">'POST'</span>) {
        <span class="hljs-keyword">const</span> contentType = c.<span class="hljs-property">req</span>.<span class="hljs-title function_">header</span>(<span class="hljs-string">'content-type'</span>) || <span class="hljs-string">''</span>;
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (contentType.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'application/json'</span>)) {
                <span class="hljs-keyword">const</span> jsonData = <span class="hljs-keyword">await</span> c.<span class="hljs-property">req</span>.<span class="hljs-title function_">json</span>();
                data = {...data, ...jsonData};
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (contentType.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'multipart/form-data'</span>) || contentType.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'application/x-www-form-urlencoded'</span>)) {
                <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">await</span> c.<span class="hljs-property">req</span>.<span class="hljs-title function_">parseBody</span>();
                data = {...data, ...formData};
            }
        } <span class="hljs-keyword">catch</span> (parseError) {
            <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'解析请求数据失败'</span>, parseError);
        }
    }
    <span class="hljs-keyword">return</span> data;
};

app.<span class="hljs-title function_">all</span>(<span class="hljs-string">'/send'</span>, <span class="hljs-keyword">async</span> (c) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">param</span>(c);
        <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">debug</span>(<span class="hljs-string">'收到请求'</span>, data);
        <span class="hljs-keyword">if</span> (!!data.<span class="hljs-property">phone</span> &amp;&amp; !!data.<span class="hljs-property">name</span> &amp;&amp; !!data.<span class="hljs-property">type</span> &amp;&amp; !!data.<span class="hljs-property">corp</span>) {
            <span class="hljs-keyword">const</span> companyMap = corpClients.<span class="hljs-title function_">get</span>(<span class="hljs-title class_">String</span>(data.<span class="hljs-property">corp</span>));
            <span class="hljs-keyword">const</span> client = companyMap ? companyMap.<span class="hljs-title function_">get</span>(data.<span class="hljs-property">name</span>) : <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">if</span> (!client) <span class="hljs-keyword">return</span> c.<span class="hljs-title function_">json</span>({<span class="hljs-attr">code</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'你的APP账号没有上线！'</span>}, <span class="hljs-number">200</span>);
            client.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)); <span class="hljs-comment">/* 操作 */</span>
            <span class="hljs-keyword">return</span> c.<span class="hljs-title function_">json</span>({<span class="hljs-attr">code</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'ok'</span>});
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> c.<span class="hljs-title function_">json</span>({<span class="hljs-attr">code</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'fail'</span>});
        }
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'处理webhook请求失败'</span>, error);
        <span class="hljs-keyword">return</span> c.<span class="hljs-title function_">json</span>({<span class="hljs-attr">code</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'error'</span>}, <span class="hljs-number">200</span>);
    }
});

<span class="hljs-title function_">serve</span>({<span class="hljs-attr">fetch</span>: app.<span class="hljs-property">fetch</span>, <span class="hljs-attr">port</span>: <span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">ports</span>.<span class="hljs-property">http</span>}, <span class="hljs-function">(<span class="hljs-params">info</span>) =&gt;</span> {
    <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`HTTP服务器运行在 http://localhost:<span class="hljs-subst">${info.port}</span>`</span>);
    <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`调试模式: <span class="hljs-subst">${CONFIG.debug ? <span class="hljs-string">'开启'</span> : <span class="hljs-string">'关闭'</span>}</span>`</span>);
});

<span class="hljs-keyword">return</span> app;
</code></pre>
<h3 data-id="heading-3">3.APP端初始化Ws链接</h3>
<p>App端运行的稳定性没法保证，所以需要考虑各种极端条件，保证Ws连接的稳定性。下面是通过Vueuse来实现的Ws，Vuesuse已经封装好了自动重连、心跳包等逻辑：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/* 链接websocket */</span>
<span class="hljs-keyword">const</span> {status, data, close, open, send, ws} = <span class="hljs-title function_">useWebSocket</span>(api.<span class="hljs-property">ws</span>, {
    <span class="hljs-title function_">onConnected</span>(<span class="hljs-params">ws</span>) {
        ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
            <span class="hljs-attr">type</span>: <span class="hljs-string">'login'</span>,
            <span class="hljs-attr">corp</span>: user.<span class="hljs-property">corp</span>.<span class="hljs-property">id</span>,
            <span class="hljs-attr">name</span>: user.<span class="hljs-property">username</span>
        }));
    },
    <span class="hljs-title function_">onMessage</span>(<span class="hljs-params">ws, event</span>) {

        <span class="hljs-comment">/* 接受数据 */</span>
        <span class="hljs-keyword">if</span> (event.<span class="hljs-property">data</span> === <span class="hljs-string">"1"</span>) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);

        <span class="hljs-comment">/* 处理，后台应用弹出 */</span>
        <span class="hljs-title function_">moveTop</span>();

        <span class="hljs-comment">/* 登录同一个账号，退出登录 */</span>
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === <span class="hljs-string">"quit"</span>) {
            <span class="hljs-title function_">quit________system</span>();
            <span class="hljs-keyword">return</span> load.<span class="hljs-title function_">info</span>(<span class="hljs-string">'您的账号在别处登录'</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === <span class="hljs-string">"call"</span>) {
            <span class="hljs-title function_">call</span>({<span class="hljs-attr">phone</span>: data.<span class="hljs-property">phone</span>});
        }

    },
    <span class="hljs-attr">heartbeat</span>: {
        <span class="hljs-attr">interval</span>: <span class="hljs-number">5000</span>
    },
    <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">autoClose</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">autoReconnect</span>: <span class="hljs-literal">true</span>
});
</code></pre>
<p>继续封装，用户登录的时候初始化链接，用户退出的时候自动断开：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/* 初始化监听：监控用户 token 登录与退出，自动建立/关闭 ws */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initWsWatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">/* 用户信息 */</span>
    <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">_user</span>();
    <span class="hljs-comment">/* 监听 token 变化：有值则连接，无值则关闭并重置 */</span>
    <span class="hljs-title function_">watch</span>(<span class="hljs-function">() =&gt;</span> user.<span class="hljs-property">token</span>, <span class="hljs-function">(<span class="hljs-params">token</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (token) {
            <span class="hljs-title function_">connectWs</span>();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_">disconnectWs</span>(<span class="hljs-literal">true</span>);
        }
    }, {<span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>});
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gemini 3.0 发布，Antigravity 掀桌，程序员何去何从？]]></title>    <link>https://juejin.cn/post/7574217823105548339</link>    <guid>https://juejin.cn/post/7574217823105548339</guid>    <pubDate>2025-11-19T09:26:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574217823105548339" data-draft-id="7574040813750288435" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gemini 3.0 发布，Antigravity 掀桌，程序员何去何从？"/> <meta itemprop="keywords" content="后端,AI编程,Gemini"/> <meta itemprop="datePublished" content="2025-11-19T09:26:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="该用户已不存在"/> <meta itemprop="url" content="https://juejin.cn/user/64217584778579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gemini 3.0 发布，Antigravity 掀桌，程序员何去何从？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/64217584778579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    该用户已不存在
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:26:02.000Z" title="Wed Nov 19 2025 09:26:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>昨天，谷歌不开任何发布会，直接甩出了一枚重磅炸弹——Gemini 3.0。</p>
<p>这一波更新来得猝不及防。<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com%2Ffeatures%2Follama" target="_blank" title="https://www.servbay.com/features/ollama" ref="nofollow noopener noreferrer">Gemini 3.0</a> 不仅第一时间登陆了 AI Studio 和 Gemini CLI，还直接渗透到了开发者最常用的工具链里：Cursor、GitHub Copilot、JetBrains 全家桶，以及 Cline。甚至连谷歌自家的一系列产品，今天起也都集成了 Gemini 3 Pro 预览版。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c20b1ba099af4780bff19760fc21d871~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149161&amp;x-signature=KZyKXFrXHx1AsSrNzUwS415ckh0%3D" alt="" loading="lazy"/></p>
<p>伴随模型发布，谷歌还掏出了一个全新的开发平台，<strong>Google Antigravity</strong>。谷歌说这是 VS Code 的分支，但它的野心显然不在于做一个编辑器，而是试图将开发模式从编写代码转向任务导向的一次尝试。</p>
<h3 data-id="heading-0">Gemini 3.0 多项基准测试碾压一众模型</h3>
<p>在深入了解 Antigravity 之前，先来了解一下 Gemini 3.0 的三个主要技术特点。</p>
<h4 data-id="heading-1"><strong>逻辑推理能力的提升</strong></h4>
<p>Gemini 3 Pro 在 LMArena 等基准测试中取得了 1501 的高分，显示出接近博士水平的逻辑推理能力。</p>
<p>此外，谷歌还引入了 <strong>Gemini 3 Deep Think</strong> 模式。与普通版的快速响应不同，Deep Think 模式类似于人类的慢思考，在回答前会进行深度的思维链推导，专门用于解决数学、科学及复杂逻辑问题。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3965545fe7f4b9d87774ae4c39ac768~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149161&amp;x-signature=x2f8Kq756CDaP3%2B2yW3gKI5hnjo%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-2"><strong>从生成内容到生成界面</strong></h4>
<p>Gemini 3.0 引入了 Generative UI（生成式界面）。传统的 AI 问答通常返回文本或代码片段，而 Gemini 3.0 支持生成完整的交互式界面。例如查询贷款计算方式时，模型可以直接构建一个包含滑块和输入框的计算器应用界面，而非仅仅列出计算公式。</p>
<h4 data-id="heading-3"><strong>对抽象风格的理解</strong></h4>
<p>新版本强调了对Vibe Coding（氛围感编程）的支持。模型能够理解较为抽象、模糊的需求描述。开发者无需提供法律条文般严谨的指令，只需描述想要的设计风格（如赛博朋克风、故障艺术感），模型即可将其转化为具体的代码实现。</p>
<h3 data-id="heading-4">重点解析：Antigravity 与任务导向型开发</h3>
<p>Antigravity 是此次发布的重头戏。据说这是谷歌基于 VS Code 开发的分支版本，谷歌的亲儿子，但其核心逻辑发生了根本性转变。</p>
<h4 data-id="heading-5"><strong>从文件导向到智能体导向</strong></h4>
<p>传统 IDE 的工作流围绕文件展开：打开文件、编写代码、手动运行。Antigravity 的工作流则围绕智能体（Agent）展开。其核心理念是让开发者从繁琐的实现细节中抽离，转向更高层次的任务管理。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/192503d55d6746d1b9affc0ccd13a597~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149161&amp;x-signature=go%2FDq0xFoGYVOunfCMgG3ta%2FF54%3D" alt="" loading="lazy"/></p>
<p><strong>Antigravity 的工作机制：</strong></p>
<ol>
<li>
<p><strong>任务下发</strong>：开发者以自然语言描述完整需求，例如“构建一个航班追踪器，界面简洁并支持实时更新”。</p>
</li>
<li>
<p><strong>任务拆解</strong>：平台内置的智能体自动将需求拆解为具体的技术步骤。</p>
</li>
<li>
<p><strong>全链路执行</strong>：Antigravity 深度集成了 <strong>Gemini 2.5 Computer Use</strong> 模型。这使得智能体不仅具备编写代码的能力，还拥有浏览器自动化操作的能力。智能体可以编写代码，随后自动打开浏览器进行测试，模拟点击、输入，并在发现错误时自动返回编辑器修正代码。</p>
</li>
<li>
<p><strong>本地与云端协同</strong>：配合最新的 Nano Banana 技术，整个开发过程在本地环境与云端资源之间进行调度。</p>
</li>
</ol>
<p>这种模式将开发者的角色从代码录入者转变为任务指挥官。</p>
<h3 data-id="heading-6">对初级开发岗位的冲击与转型</h3>
<p>Antigravity 展示了一种可能性，那就是基础的代码编写、测试和调试工作，正逐渐被 AI 接管。对于技能仅限于将需求直译为基础代码，或依赖网络搜索复制粘贴的初级程序员而言，职业空间确实面临压缩。</p>
<p>然而，这并不意味着程序员这一职业的消亡，而是职能的向上迁移。未来的开发趋势指向懂代码的架构师。</p>
<p><strong>开发者的新核心竞争力：</strong></p>
<ul>
<li>
<p><strong>代码审查能力</strong>：AI 能够生成代码，但也可能产生幻觉或逻辑漏洞。开发者必须具备阅读和审查 AI 产出的能力，以确保系统的安全性与稳定性。</p>
</li>
<li>
<p><strong>任务拆解与指令工程</strong>：Antigravity 的执行效率取决于指令的清晰度。如何将模糊的业务需求转化为 AI 可精准执行的技术任务，将成为关键技能。</p>
</li>
<li>
<p><strong>系统架构思维</strong>：AI 擅长执行具体的战术任务（如编写函数），但在宏观的战略布局（如高可用架构设计）上仍需人类把控。</p>
</li>
</ul>
<p>初级程序员应当减少对语法细节的死记硬背，转而投入到系统设计原理与调试逻辑的学习中。</p>
<h3 data-id="heading-7">快速构建本地开发环境</h3>
<p>对于希望第一时间体验 Gemini 3.0 新特性（特别是 Gemini CLI）的开发者来说，配置基础环境往往是第一道门槛。<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com" target="_blank" title="https://www.servbay.com" ref="nofollow noopener noreferrer">Node.js 环境</a>的配置、版本管理常常耗费大量精力。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b30167c4ff149a690f4d0ba1d554da1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149161&amp;x-signature=q2GFcow8lOqUX8cM6Hn2FnAADwQ%3D" alt="" loading="lazy"/></p>
<p>此时，ServBay 是一个高效的解决方案。ServBay 专为开发者设计，旨在简化本地开发环境的部署流程.</p>
<ul>
<li>
<p><strong>环境配置</strong>：支持<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com%2Ffeatures%2Fnodejs" target="_blank" title="https://www.servbay.com/features/nodejs" ref="nofollow noopener noreferrer">一键部署 Node.js 环境</a>，无需处理复杂的环境变量和版本冲突，方便开发者快速运行 Gemini CLI。</p>
</li>
<li>
<p><strong>本地 AI 部署</strong>：ServBay 同样支持一键部署本地 AI 模型。开发者可以在本地运行 Gemma、Qwen 3 等开源模型，方便与 Gemini 3.0 进行对比测试，既满足了隐私需求，也便于低延迟调试。</p>
</li>
</ul>
<h3 data-id="heading-8"><strong>结语</strong></h3>
<p>Gemini 3.0 与 Antigravity 的出现，降低了写代码的门槛，却提高了构建软件”=的标准。工具的进化旨在释放生产力，开发者只需善用工具，从繁杂的重复劳动中脱身，专注于更有价值的创造与设计。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[软件苹果商城上架的流程与团队协作模式 一个项目从开发到发布的完整经历]]></title>    <link>https://juejin.cn/post/7574230586970849286</link>    <guid>https://juejin.cn/post/7574230586970849286</guid>    <pubDate>2025-11-19T09:25:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574230586970849286" data-draft-id="7574084898879160361" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="软件苹果商城上架的流程与团队协作模式 一个项目从开发到发布的完整经历"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T09:25:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aiopencode"/> <meta itemprop="url" content="https://juejin.cn/user/1898230261493865"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            软件苹果商城上架的流程与团队协作模式 一个项目从开发到发布的完整经历
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1898230261493865/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aiopencode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:25:50.000Z" title="Wed Nov 19 2025 09:25:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在很多技术团队里，“软件苹果商城上架” 常常被安排在项目周期的末尾，甚至被视为上线前的最后一道关卡。
但经历过多次 iOS 上架之后，你会发现——这不是简单的“把 IPA 传上去”，而是一段涉及角色分工、工具链协同、发布审核管理的完整流程。</p>
<p>在这篇文章中，我将以一个真实团队的视角，讲述我们如何把一款跨平台 App 成功上架到苹果商城（App Store），重点分享工程侧如何配合产品、设计、测试等角色，在没有单一 Mac 依赖的情况下完成上架流程。</p>
<hr/>
<h2 data-id="heading-0"><strong>一、项目收尾阶段：上架并不是“最后一个动作”</strong></h2>
<p>在我们团队的项目中，上架准备往往从开发的后期就开始了。
原因很简单：苹果商城的要求并不只是“技术打包”，还包含大量信息配置和内容校验，例如：</p>
<ul>
<li>软件名称、简介、关键词</li>
<li>权限用途说明</li>
<li>隐私政策 URL</li>
<li>不同设备尺寸的截图</li>
<li>年龄分级问卷</li>
<li>App 类别、版权信息</li>
</ul>
<p>这意味着产品、设计、运营、后端甚至法务都参与其中。</p>
<p>因此，当代码进入稳定阶段时，我们就同步启动“上架准备任务”，让所有角色提前介入，而不是等到开发结束后才匆忙处理。</p>
<hr/>
<h2 data-id="heading-1"><strong>二、证书体系准备：技术团队的责任“链路起点”</strong></h2>
<p>对于技术团队来说，iOS 证书永远是上架链路的第一步。</p>
<p>在这个项目中，我们团队中有成员使用 Windows，也有人使用 Mac，而证书必须集中管理，因此我们采取以下策略：</p>
<h3 data-id="heading-2"><strong>策略 1：证书统一生成、统一保存</strong></h3>
<p>不允许“每个人自己弄一套证书”，这样会导致发布混乱。</p>
<h3 data-id="heading-3"><strong>策略 2：使用开心上架（Appuploader）跨平台生成证书，避免强依赖 Mac</strong></h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c13cafd98eb841cdb3bce19e8b86616a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWlvcGVuY29kZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149150&amp;x-signature=OP2Uosi7N2Xo9SFF8%2FdgSS7%2FSNc%3D" alt="证书" loading="lazy"/></p>
<p>输出内容：</p>
<ul>
<li>p12 证书</li>
<li>provisioning profile</li>
<li>可供整个团队使用的签名文件</li>
</ul>
<p>这样，无论开发者使用的是 Windows、Linux 还是 macOS，都可以拿到统一证书构建 IPA，不再依赖某个人或某台 Mac。</p>
<hr/>
<h2 data-id="heading-4"><strong>三、构建 IPA：跨平台开发团队的多路径实践</strong></h2>
<p>我们的项目基于跨平台技术（部分页面原生、部分页面使用 uni-app），所以构建方式是多样化的：</p>
<h3 data-id="heading-5"><strong>方式 1：原生模块使用 Mac + Xcode 构建</strong></h3>
<p>核心模块依然需要通过 Mac 进行 Xcode 打包。</p>
<h3 data-id="heading-6"><strong>方式 2：uni-app 页面使用云打包服务</strong></h3>
<p>Windows 成员可以直接提交资源，由云端完成 IPA 构建。</p>
<h3 data-id="heading-7"><strong>方式 3：CI 自动打包（自动化 pipeline）</strong></h3>
<p>我们还配置了一个 GitLab Runner，主要用于：</p>
<ul>
<li>每次发布自动打包</li>
<li>保存多个构建版本</li>
<li>自动化测试覆盖基础功能</li>
</ul>
<p>最终，我们能在任意环境中可靠产出 IPA，不再受限于某台 Mac。</p>
<hr/>
<h2 data-id="heading-8"><strong>四、上传 IPA：发布团队最关注的环节</strong></h2>
<p>在我们的流程中，“上传 IPA 到苹果商城后台（App Store Connect）” 是发布阶段最关键的一步。</p>
<p>官方方式只能在 Mac 上执行，例如：</p>
<ul>
<li>Transporter</li>
<li>Xcode Organizer</li>
</ul>
<p>但我们的团队分布式办公，并不是每个人都有 Mac，因此上传环节必须做到 <strong>跨平台</strong>。</p>
<h3 data-id="heading-9"><strong>我们使用的上传方式：开心上架（Appuploader）命令行发布（全平台适配）</strong></h3>
<p>示例命令：</p>
<pre><code class="hljs language-bash" lang="bash">appuploader_cli -u ios@team.com -p xxx-xxx-xxx-xxx -c 2 -f ./build/release.ipa
</code></pre>
<p>这条命令会将 IPA 上传到 App Store Connect → TestFlight → 构建版本列表。</p>
<p>这个方式的好处非常明显：</p>
<ul>
<li>Windows、Linux、macOS 全团队成员可执行</li>
<li>上传日志清晰，易于排查问题</li>
<li>支持集成到 CI/CD，发布流程自动化</li>
<li>不再担心“Mac 离线、软件崩溃”等问题</li>
</ul>
<p>对我们这种跨系统团队来说，这是非常可靠的解决方案。
同时还有图形化界面：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7db35f53a374023bc48d1c093a1acbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWlvcGVuY29kZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149150&amp;x-signature=Y4Ia5RaOmoFXH8l0TsJD4JmSxkI%3D" alt="上传" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-10"><strong>五、准备上架素材：产品与设计的“信息工作”</strong></h2>
<p>技术侧把 IPA 与签名准备好之后，接下来就是 App Store Connect 中大量的内容填充工作。
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b006964636924d19b29654ad860647fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWlvcGVuY29kZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149150&amp;x-signature=e4ZLw%2FDUNyXFColDBEa3YGFoFM4%3D" alt="asc" loading="lazy"/></p>
<h3 data-id="heading-11">产品填写的内容包括：</h3>
<ul>
<li>软件名称、描述、关键词</li>
<li>隐私政策链接</li>
<li>版本更新说明</li>
<li>分类（主类目、次类目）</li>
</ul>
<h3 data-id="heading-12">设计团队需要：</h3>
<ul>
<li>提供 iPhone（6.5 / 5.5）截图</li>
<li>若适配 iPad，还需提供 iPad 截图</li>
<li>App 预览视频（可选）</li>
</ul>
<h3 data-id="heading-13">我们的做法</h3>
<p>通过一个共享文档（Notion/飞书文档）来统一所有上架内容，避免遗漏和重复沟通。</p>
<hr/>
<h2 data-id="heading-14"><strong>六、审核阶段：从风险控制到沟通策略</strong></h2>
<p>苹果审核严格，但逻辑明确。
从我们多次上架的经验看，最常见的拒审理由包括：</p>



































<table><thead><tr><th>典型问题</th><th>审核意见</th><th>实际处理方式</th></tr></thead><tbody><tr><td>启动闪退</td><td>无法正常体验</td><td>增加真机测试覆盖</td></tr><tr><td>截图与实际不符</td><td>有误导性</td><td>重新提供真实截图</td></tr><tr><td>隐私用途描述缺失</td><td>违反 5.1.1</td><td>补充 Info.plist 文案</td></tr><tr><td>第三方登录异常</td><td>无法登录</td><td>检查 OAuth 配置</td></tr><tr><td>内容未达到要求</td><td>信息不完整</td><td>按提示补充</td></tr></tbody></table>
<p>为了减少返工，我们建立了“审核风险清单”，每次提交前都逐项检查。</p>
<hr/>
<h2 data-id="heading-15">团队最终交付：让上架成为“稳定流程”而非“临时任务”</h2>
<p>软件苹果商城上架必须成为“团队协作链路的一部分”，而不是放在最后的临时动作。</p>
<p>我们最终形成了一套可复用的上架流程：</p>
<ol>
<li>跨平台证书统一创建与管理</li>
<li>多构建方式并行产出 IPA</li>
<li>开心上架（Appuploader）跨系统上传通道保证发布可靠性</li>
<li>App Store Connect 素材由产品与设计提前准备</li>
<li>建立审核风险清单</li>
<li>发布记录自动归档</li>
</ol>
<p>这套流程让我们之后的每次上架都变得稳定、可控、易管理。
参考教程:<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.applicationloader.net%2Ftutorial%2Fzh%2F83%2F83.html" target="_blank" title="https://www.applicationloader.net/tutorial/zh/83/83.html" ref="nofollow noopener noreferrer">www.applicationloader.net/tutorial/zh…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[分享一名海外独立开发者的 AI 编程工作流]]></title>    <link>https://juejin.cn/post/7574045294612299811</link>    <guid>https://juejin.cn/post/7574045294612299811</guid>    <pubDate>2025-11-19T09:29:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574045294612299811" data-draft-id="7574250031248097314" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="分享一名海外独立开发者的 AI 编程工作流"/> <meta itemprop="keywords" content="人工智能,LLM,AI编程"/> <meta itemprop="datePublished" content="2025-11-19T09:29:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Baihai_IDP"/> <meta itemprop="url" content="https://juejin.cn/user/3123071228582343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            分享一名海外独立开发者的 AI 编程工作流
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3123071228582343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Baihai_IDP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:29:07.000Z" title="Wed Nov 19 2025 09:29:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读28分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>编者按：</strong> 当 AI 编程智能体宣称能自动化一切时，我们是否在工具与概念的丛林中迷失了方向，反而忘记了如何最简单、直接地解决问题？</p>
<p>本文的核心主张尖锐而明确：与其追逐繁杂的“智能体套件”、子智能体（Subagents）、RAG 等概念，不如回归本质 —— 选择一个强大且高效的模型，像与一位靠谱的工程师同事那样，通过简洁的对话和直觉性的协作来直接解决问题。作者直言不讳地批评了当前生态中许多“华而不实”的工具，认为它们不过是绕开模型本身低效的临时补丁，并分享了他如何用多个终端窗口和经典工具（如 tmux）实现比许多专用工具更灵活、更可控的工作流。</p>
</blockquote>
<p><strong>本文系原作者观点，Baihai IDP 仅进行编译分享</strong></p>
<p><strong>作者 | Peter Steinberger</strong></p>
<p><strong>编译 | 岳扬</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a839239bfda34a20ae1e2b5c1c1ec417~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149347&amp;x-signature=7v4gAVRhqX2rllKELux06AOLrKA%3D" alt="image.png" loading="lazy"/></p>
<p>最近我没怎么在社交平台上活跃，因为我正全身心投入到最新的项目中。如今，智能体工程（Agentic engineering）已经变得非常强大，几乎能编写出我需要的 100% 的代码。然而，我却看到很多人还在费力解决本不该存在的问题，搞出一堆繁复的表演，而不是专注把事搞定。</p>
<p><strong>这篇文章的部分灵感来自最近在伦敦参加的“Claude Code Anonymous”活动[1]上的对话，另一部分则是因为距离我上次更新工作流已经整整一年（还是 AI 年[2]😏）。是时候做个回顾了。</strong></p>
<p>所有基础理念依然适用，像上下文管理这类简单内容本文不再赘述。想了解基础内容，请阅读我之前写的《Optimal AI Workflow》[3]一文。</p>
<h2 data-id="heading-0"><strong>01 我的工作背景与技术栈</strong></h2>
<p>我是一名独立开发者，当前开发的项目是一个约 30 万行代码的 TypeScript React 应用，外加一个 Chrome 扩展、一个 CLI 工具、一个基于 Tauri 的客户端应用，以及一个使用 Expo 的移动应用。网站托管在 Vercel 上，每次 PR 后大约两分钟就能测试新版本，其他应用尚未实现自动化部署。</p>
<h2 data-id="heading-1"><strong>02 我所使用的技术工具和处理开发任务的总体思路</strong></h2>
<p>我已完全改用 codex cli 作为主力工具。通常我会在一个 3x3 的终端网格中同时运行 3 到 8 个实例，它们大多位于同一目录[4]，部分实验性任务则会放在独立文件夹中。我尝试过 worktrees、PR 等方式，但总会回到当前这套配置，因为它能最快地把事情做完。</p>
<p>我的智能体（agents）会自行执行原子化的 Git commits[5]。为了保持相对干净的 commit 历史，我在 agent 配置文件[6]上反复迭代优化。这样一来，Git 操作更精准，每个智能体只提交它实际修改过的文件。</p>
<p>是的，用 Claude 你可以设置 hooks（译者注：可能是 git commit hook），而 codex 目前还不支持 hooks，但大模型极其聪明 —— 一旦它们下定决心，没有任何 hook 能拦得住[7]。</p>
<p>过去我曾因此被嘲讽为垃圾代码制造机[8]，如今看到并行运行智能体的做法逐渐成为主流[9]，深感欣慰。</p>
<h2 data-id="heading-2"><strong>03 模型选择</strong></h2>
<p>我几乎所有的开发工作都交由 gpt-5-codex 在“medium 配置”下完成。它在智能程度与速度之间取得了极佳的平衡，还能自动调节思考深度。我发觉过度纠结这些设置并无明显的回报，而且不用操心“超深度思考”（ultrathink）的感觉真的很轻松。</p>
<h3 data-id="heading-3"><strong>3.1 爆炸半径 💥</strong></h3>
<p>每次工作时，我都会考量“爆炸半径” —— 这个词不是我发明的，但我非常喜欢。当构思某个改动时，我基本能预判其耗时及波及的文件范围。我可以向代码库投掷多枚“小手雷”，或是一发“胖子”配几颗小炸弹。但如果你同时扔下多个大炸弹，就几乎不可能做出隔离良好的提交，一旦出错也更难回滚。</p>
<p>这同时也是我观察智能体运行时的一个重要指标。如果某项任务耗时超出预期，我会直接按 Esc，然后问一句“当前状态如何？”来获取任务进度，再决定是帮模型调整方向、中止任务，还是继续执行。<strong>别害怕在中途打断模型 —— 文件修改是原子性的，它们非常擅长接续未完成的工作。</strong></p>
<p>当我对改动的影响不确定时，会先让模型“在修改前给我几个选项”，以此评估影响范围。</p>
<h3 data-id="heading-4"><strong>3.2 为何不用 Worktree？</strong></h3>
<p>我始终只运行一个开发服务器。在迭代项目时，我会通过实时操作界面，一次性测试多处改动。如果为每个功能变更都创建独立的工作树（worktree）或分支（branch），会严重拖慢我的测试流程。而同时启动多个开发服务器又会带来不必要的操作负担。此外，我的项目受 Twitter OAuth 规则限制，只能注册有限数量的回调域名，这从客观上也不支持多环境并行的开发方式。</p>
<h3 data-id="heading-5"><strong>3.3 那 Claude Code 呢？</strong></h3>
<p>我曾经很喜欢 Claude Code，但如今实在受不了了（即便 codex 对其赞誉有加[10]）。那种语言风格、那种斩钉截铁的“绝对正确”[11]、那种测试明明失败却宣称“100%满足生产要求”的语气——实在令人无法继续。相比之下，codex 更像是那个内向但靠谱的工程师：默默推进，把事情做完。它在开始工作前会读取更多文件，因此即使是简短的提示词，通常也能精准实现我想要的效果。</p>
<p>在我关注的信息流中，大家已普遍认为 codex 才是当前的首选[12-13]。</p>
<h3 data-id="heading-6"><strong>3.4 codex 的其他优势</strong></h3>
<ul>
<li><strong>约 23 万的可用上下文（context），而 Claude 只有 15.6 万。</strong> 是的，如果你运气好或愿意按 API 定价付费，Sonnet 确实有 100 万上下文，但现实中 Claude 在耗尽上下文之前就已经开始胡言乱语了，所以这个超长上下文实际上并不可用。</li>
<li><strong>更高的 token 利用效率。</strong> 我不知道 OpenAI 做了什么不同处理，但我的上下文空间在 codex 中消耗得明显更慢。用 Claude 时我经常看到 “Compacting…” 提示，而在 Codex 中我极少触及上下文上限。</li>
<li><strong>消息队列（Message Queuing）。</strong> Codex 支持消息排队[14]。Claude 以前也有这功能，但几个月前改成了“消息会实时引导模型”的机制。如果我想引导 codex，只需按 Esc 再回车就能发送新消息。能同时选择“排队”或“即时干预”显然更好。我经常一次性将多个相关功能任务放入队列，它总能可靠地逐个完成。</li>
<li>速度。<strong>OpenAI 用 Rust 重写了 codex，效果立竿见影 —— 响应速度快得惊人。</strong> 而用 Claude Code 时，我经常遇到数秒的卡顿，内存占用动辄飙到几个 GB。还有终端显示的闪烁问题，尤其是在用 Ghostty 时。Codex 完全没有这些问题，感觉极其轻量、流畅。</li>
<li><strong>语言风格。</strong> 这点对我的心理健康真的很重要[15]。我曾无数次对 Claude 大吼大叫，但很少对 codex 发火。哪怕 codex 模型能力稍弱，光凭这一点我也愿意用它。只要你两个都用上几周，就懂我在说什么。</li>
<li><strong>不会到处乱生成 markdown 文件</strong>[16]。懂的都懂（IYKYK）[17]。</li>
</ul>
<h3 data-id="heading-7"><strong>3.5 为何不选用其他开发工具</strong></h3>
<p>在我看来，终端用户和大模型公司之间其实没有太多中间空间。我目前通过订阅获得的性价比远高于其他方式。我现在有 4 个 OpenAI 订阅和 1 个 Anthropic 订阅，每月总花费大约 1000 美元，基本可以享受“无限 token”的使用体验。如果改用 API 调用，成本大概会高出 10 倍。别太较真这个数字——我用过像 ccusage 这样的 token 统计工具，数据多少有些不精确，但即便只是五倍，也已是相当划算的交易了。</p>
<p>我很欣赏像 amp 或 Factory 这样的工具，但我不认为它们能长期存活。无论是 codex 还是 Claude Code，每个版本都在变得更强，而且功能理念正在快速趋同。某些工具可能在待办列表、引导控制或细微的开发者体验（DX）上暂时领先，但我不觉得它们能真正超越大型 AI 公司。</p>
<p>amp 已经不再以 GPT-5 为核心驱动，转而称其为“Oracle”（神谕）[18]。而我直接使用 codex，本质上就是一直在和那个更聪明的模型——也就是“Oracle”——打交道。是的，有各种基准测试[19]，但考虑到使用场景的巨大不同，我不太信任那些结果。实际体验中，codex 给我的输出远优于 amp。不过我得承认，他们在会话共享方面确实做了些有趣的创新。</p>
<p>Factory？我还没被说服。他们的演示视频有点尴尬，虽然我在信息流里确实听到一些正面评价 —— 尽管目前还不支持图像（至少现在还不行），而且也有标志性的闪烁问题[20]。</p>
<p>Cursor……如果你还在亲手写代码，那它的 Tab 补全模型确实是业界领先。我主要用 VS Code，但确实欣赏他们在浏览器自动化和计划模式（plan mode）等方面的探索。我试过 GPT-5-Pro，但 Cursor 依然存在那些从五月起就让我烦躁的 bug[21]。听说他们正在修复，所以它还留在我的程序坞里。</p>
<p>像 Auggie 这样的工具，只在我的信息流上昙花一现，之后就再没人提过。归根结底，它们底层无非是封装了 GPT-5 和/或 Sonnet，完全可以被替代。RAG 对 Sonnet 或许有点用，但 GPT-5 本身在代码检索上已经强到根本不需要额外的向量索引。</p>
<p>目前最有希望的是 opencode 和 crush，尤其是搭配开源模型使用时。你当然也能通过它们使用 OpenAI 或 Anthropic 的订阅（得益于一些巧妙的技术手段[22]），但这是否合规仍存疑，况且为何要为一个专为 Codex 或 Claude Code 优化的模型，配上一个能力较弱的“外壳”呢。</p>
<h3 data-id="heading-8"><strong>3.6 关于开源模型</strong></h3>
<p>基准测试只能说明一半的问题。在我看来，智能体工程（agentic engineering）大约在 Sonnet 4.0 发布的五月，才真正从“这玩意儿真烂”迈入“这还不错”的阶段；而随着 gpt-5-codex 的出现，我们又迎来了一次更大的进步 —— 从“不错”直接进入“这简直太棒了”的境界。</p>
<h3 data-id="heading-9"><strong>3.7 计划模式（Plan Mode）与方法</strong></h3>
<p>基准测试所忽略的，是模型与工具在接到指令后所采取的策略。codex 要谨慎得多 —— 它会在决定行动前读取你代码库中更多的文件。当你提出一个荒谬请求时，它也更倾向于明确反对[23]。相比之下，Claude 或其他智能体会更急切地直接动手尝试。虽然可以通过“计划模式”（plan mode）和严谨的结构化文档来缓解这个问题，但对我而言，这感觉像是在给一个有缺陷的系统打补丁。</p>
<p>如今我几乎不再为 codex 使用大型的计划文件。其实 codex 甚至没有专门的计划模式（plan mode） —— 但它对提示词的理解和遵循能力实在太强，我只要写一句“我们先讨论一下”或“给我几个选项”，它就会耐心等待我确认后再行动。完全不需要那些花里胡哨的东西，直接跟它对话就行。</p>
<h3 data-id="heading-10"><strong>3.8 但 Claude Code 现在有插件了</strong></h3>
<p>你听见远处那声叹息了吗？那是我在叹气。这真是彻头彻尾的胡扯。Anthropic 的这一举动让我对他们的产品方向感到非常失望。他们试图用插件[24]来掩盖模型本身的低效。当然，为特定任务维护优质文档是个好主意 —— 我自己就在一个 docs 文件夹里存了大量有用的 Markdown 文档。</p>
<h3 data-id="heading-11"><strong>3.9 但是！子智能体呢</strong></h3>
<p>但关于这场“子智能体”（subagents）的盛宴，我有些话不吐不快。今年五月时，这还叫“子任务”（subtasks），主要是当模型不需要完整上下文时，把任务拆出去单独处理——比如并行执行，或避免把冗长的构建脚本塞进主上下文造成浪费。后来他们重新包装并升级为“子智能体”，让你可以带着指令“优雅地”打包并分派任务。</p>
<p>但使用场景本质上没变。<strong>别人用子智能体干的事，我通常用多个终端窗口就搞定了。</strong> 如果我想调研某个问题，可能会在一个终端窗格里操作，再把结果粘贴到另一个窗格。这种方式让我对上下文工程拥有完全的控制权和可见性，而子智能体反而让上下文变得难以查看、引导或控制。</p>
<p>还有 Anthropic 博客里推荐的那个子智能体 —— 你去看看他们那个所谓的“AI Engineer”智能体[25]。那简直就是一锅大杂烩：一边吹集成了 GPT-4o 和 o1，一边堆砌一堆自动生成的空洞词汇，试图显得有逻辑。里面根本没有能让智能体真正变成更好“AI 工程师”的实质内容。</p>
<p>这到底有什么用？如果你希望获得更好的输出，光告诉模型“你是一位专精于生产级 LLM 应用的 AI 工程师”是没用的。<strong>真正有用的是提供文档、示例，以及明确的“该做什么/不该做什么”。</strong> 我敢打赌，你让智能体去“搜索 AI 智能体构建的最佳实践”并加载几个网页，效果都比那堆废话强得多。你甚至可以说，这种胡扯本身就是一种上下文污染（context poison）[26]。</p>
<h2 data-id="heading-12"><strong>04 我的提示词撰写之道</strong></h2>
<p>以前用 Claude 时，我（当然不是手打，而是靠语音）会写非常详尽的提示词，因为那个模型“给越多上下文，越懂我”。虽然所有模型多少都这样，但我发现换用 codex 后，提示词明显变短了 —— 常常就一两句话，外加一张图。这个模型读代码库的能力极强，就是能精准理解我的意图。有时候我甚至又愿意打字了，因为 codex 根本不需要太多上下文就能明白。</p>
<p><strong>添加图片是个绝妙的技巧，能快速补充上下文。</strong> 模型非常擅长精准定位你截图中的内容 —— 无论是字符串还是界面元素，它都能迅速匹配并跳转到你提到的位置。我至少有一半的提示词都包含截图，虽然添加标注效果更佳但效率更低，而直接拖拽截图到终端仅需两秒。</p>
<p>带语义纠错的 Wispr Flow[27] 仍是当前最优方案。</p>
<h2 data-id="heading-13"><strong>05 Web 端智能体新体验</strong></h2>
<p>最近我又重新尝试了一些 Web 端智能体：Devin、Cursor 和 Codex。Google 的 Jules 界面美观，但配置流程繁琐，且 Gemini 2.5 现在已经算不上好模型了。不过一旦 Gemini 3 Pro 上线[28]，情况或许会有所转变。目前唯一留下来的只有 codex web。虽然它也存在配置复杂的问题，而且现在还有 Bug（终端目前就无法正确加载），但我靠一个旧版环境让它跑起来了，代价是启动速度更慢。</p>
<p>我把 codex web 当作临时的问题追踪器。在外突发灵感时，就用 iOS App 发一条一行字的提词词，回头在 Mac 上再仔细处理。当然，我完全可以在手机上做更多事，比如审查、合并代码，但我刻意保持克制。我的工作已经够让人上瘾了，所以当我出门或和朋友聚会时，不想被进一步拉回工作状态。说这话的人，可是曾花将近两个月专门开发了一款便于使用手机编程的工具啊。</p>
<p>codex web 上的任务原本不计入使用额度，可惜这样的好日子恐怕快到头了。</p>
<h2 data-id="heading-14"><strong>06 The Agentic Journey</strong></h2>
<p>聊聊那些工具吧：Conductor[29]、Terragon[30]、Sculptor[31] 等数以千计的同类产品。有些是个人爱好项目，有些则被 VC 投来的钱淹得喘不过气。我试过太多太多，没一个能让我长期用下去。在我看来，它们都是在绕开当前模型的低效，推行一种并不真正高效的工作流。而且大多数还藏起终端，不让你看到模型的全部输出。</p>
<p>绝大多数不过是 Anthropic SDK 的浅层封装 + 工作树管理，毫无技术护城河可言。我甚至怀疑：我们真的需要在手机上更方便地调用编程智能体吗？这些工具的有限应用场景，现在 codex web 已经完全覆盖了。</p>
<p>不过我确实观察到一个普遍现象：几乎每个工程师都会经历一个“自己造工具”的阶段 —— 主要是因为好玩，也因为现在做这件事确实太容易了。既然如此，还有什么比造一个“（我们以为）能让造工具变得更简单的工具”更自然呢？</p>
<h2 data-id="heading-15"><strong>07 但 Claude Code 能处理后台任务！</strong></h2>
<p>确实如此。<strong>codex 目前缺少一些 Claude 有的小功能，其中最让人头疼的就是后台任务管理。</strong> 虽然理论上应该有超时机制，但我确实多次遇到它卡在不会自动结束的 CLI 任务上，比如启动开发服务器，或者死锁的测试。</p>
<p>这曾是我一度切回 Claude 的原因之一。但鉴于那个模型在其他方面实在太不靠谱，我现在改用 tmux。tmux 是一个老牌工具，能在后台持久化运行 CLI 会话，而且模型里早就内置了大量相关知识 —— 你只需要说一句“用 tmux 运行”，就能搞定，无需任何复杂的智能体配置流程。</p>
<h2 data-id="heading-16"><strong>08 那 MCPs 呢？</strong></h2>
<p>关于 MCP（Model Context Protocol），其他人已经写了很多。在我看来，大多数 MCP 本质都只是市场部门用来打勾炫耀的工具。几乎所有 MCP 其实都应该做成 CLI。这话出自一个自己写过 5 个 MCP[32] 的人之口。</p>
<p>我可以直接按工具名字调用一个 CLI，根本不需要在 agent 配置文件里写任何说明。模型第一次调用时可能会试一些乱七八糟的命令（$randomcrap），CLI 会自动返回帮助菜单，上下文立刻就拥有了完整的使用信息 —— 从此一切顺利。我不用为任何工具付出额外代价，而 MCP 却是持续的成本，还会污染我的上下文。试试 GitHub 的 MCP，瞬间吃掉 23k tokens。好吧，他们后来优化了 —— 刚上线时可是接近 5 万 tokens！换成 gh CLI 呢？功能基本一样，模型本来就认识它，还完全不用交“上下文税”。</p>
<p>我自己开源了一些 CLI 工具，比如 bslog[33] 和 inngest[34]。</p>
<p>我现在确实在用 chrome-devtools-mcp[35] 这个工具来做最终验证[36]，它已经取代了 Playwright，成为我进行网页调试时的首选 MCP 工具。虽然我不常用它，但一旦需要，它就能帮我完成从“代码修改”到“验证结果”这个关键闭环，非常有用。我还专门设计了我的网站，让模型能通过 curl 查询任意接口（通过我生成的 API key）——这在几乎所有场景下都比 MCP 更快、更省 token。所以就连这个 MCP，我也不是每天都需要。</p>
<h2 data-id="heading-17"><strong>09 但生成的代码太糟糕了！</strong></h2>
<p>我约 20% 的时间[37]投入在重构上。当然，这些全由智能体完成，我绝不会手动浪费时间干这种事。当我不太需要高度专注或感到疲惫时，“重构日”就特别有用 —— 即使状态一般，也能取得显著进展。</p>
<p>典型的重构工作包括：用 jscpd 找重复代码，用 knip[38] 清理死代码，运行 eslint 的 react-compiler 和弃用插件（译者注：一类 ESLint 插件，用于检查代码中是否使用了已过时的 API、方法或特性，并提示你改用现代、推荐的替代方案。），检查是否有可合并的 API 路由，更新文档，拆分过大的文件，为复杂逻辑补充测试和注释，更新依赖项，升级工具链，调整目录结构，找出并重写慢测试，引入现代 React 模式（比如你可能根本不需要 useEffect）等等。总有做不完的事。</p>
<p>有人可能会说这些应该在每次提交时就做完。但我发现，先快速迭代、再集中维护和优化代码库——即阶段性偿还技术债务——这种方式不仅效率更高，而且整体上有趣得多。</p>
<h2 data-id="heading-18"><strong>10 你采用规范驱动开发（spec-driven development）吗？</strong></h2>
<p>我去年六月还在用这种方式：先写一份详尽的规格文档，然后让模型去实现，理想情况下能连续跑上好几个小时。但现在我觉得，这种“先设计后构建”的思路已经是过时的软件开发范式了。</p>
<p>我现在的做法通常是：<strong>先直接和 codex 展开讨论，贴一些网站链接、初步构想，让它解读现有代码，然后我们一起把新功能逐步梳理出来。如果问题比较棘手，我会让它把思路整理成一份规范文档，然后交给 GPT-5-Pro（通过 chatgpt.com）做评审，看看是否有更好的建议 —— 出乎意料的是，这经常能大幅优化我的方案！接着，我会把其中我觉得有用的部分粘回主上下文，用于更新实际文件。</strong></p>
<p>现在我对不同任务消耗多少上下文已经有不错的直觉，而 codex 的上下文容量也相当充足，所以很多时候我干脆直接开干。有些人很“虔诚”，总喜欢为每个新计划新开一个上下文窗口 —— 我觉得这在 Sonnet 时代还有点用，但 GPT-5 处理长上下文的能力强得多，如果还这么做，每次都会白白多花 10 分钟，因为模型得重新慢慢加载所有构建功能所需的文件。</p>
<p>更有趣的方式是做基于 UI 的开发。我经常从一个非常简单的东西开始，故意把需求写得极其模糊，然后一边看模型编码，一边在浏览器里实时看到效果。接着我再排队加入更多调整，逐步迭代这个功能。很多时候我自己也不确定最终该长什么样，这种方式让我能边玩边试，看着想法慢慢成形。有时 codex 甚至会做出一些我根本没想到但很妙的设计。我从不重置进度，只是一步步迭代，把混沌慢慢塑造成我觉得对的形状。</p>
<p>开发过程中，我也常会冒出一些关联功能的新点子，顺势对其他部分也做些调整 —— 这部分工作我会放到另一个智能体里处理。通常我主攻一个核心功能，同时并行处理一些次要但相关的任务。</p>
<p>就在我写这段文字时，我正在给 Chrome 扩展开发一个新的 Twitter 数据导入器，为此我正在重构 graphql 导入模块。因为还不确定这个方案是否合理，我把这部分代码放在一个单独的文件夹里，这样可以通过 PR 预览来判断思路是否成立。主仓库则在做重构，让我能专心写这篇文章。</p>
<h2 data-id="heading-19"><strong>11 请分享您的斜杠命令！</strong></h2>
<p>我只有少数几个斜杠命令，而且很少用：</p>
<ul>
<li>/commit（自定义说明文本，用于协调多智能体在同一目录协作时仅提交自身修改。这样能保持提交信息干净，也能防止 GPT 因看到其他改动而 panic，比如 linter 报错时乱 revert（译者注：Git 版本控制中的常用术语，撤销某次或某几次提交（commit）所引入的更改。））</li>
<li>/automerge（一次处理一个 PR：响应机器人评论、回复、等 CI 通过后自动 squash 合并（译者注：Git 版本控制中的常用术语，将多个连续的提交记录合并成一个单一的、干净的提交。））</li>
<li>/massageprs（和 automerge 类似，但不用 squash，方便在有大量 PR 时并行处理）</li>
<li>/review（内置命令，偶尔用 —— 因为 GitHub 上已有 review bot，但有时还是有用）</li>
</ul>
<p>即便如此，大多数时候我其实就直接打 “commit” 两个字。除非我知道当前有太多脏文件，担心智能体在没有引导的情况下出错。如果我确信简单指令就够了，就绝不会搞那些花哨的表演或浪费上下文。这种直觉是慢慢练出来的。到目前为止，我还没见过其他真正有用的斜杠命令。</p>
<h2 data-id="heading-20"><strong>12 其他实用技巧</strong></h2>
<p><strong>与其费尽心思写出完美的提示词去“激励”智能体完成一个长期任务，不如用点偷懒的变通方法。</strong> 比如进行大型重构时，Codex 常会在中途暂停响应。这时候，只要提前排好几条 “continue” 消息，你就可以走开，等回来时活儿就干完了。如果 codex 已经完成了任务，再收到更多消息，它也会愉快地忽略掉。</p>
<p><strong>每次完成一个功能或 Bug 修复后，请让模型在同一上下文中顺手写点测试用例。</strong> 这样做不仅能产出质量高得多的测试用例，还常常能暴露代码实现中的 bug。如果是纯 UI 调整，可能测试意义不大。但对于其他情况，我强烈建议这么做。AI 写测试用例总体上还是不太行，但已经比没有强多了 —— 而且说实话，你自己每次改代码都会写测试用例吗？</p>
<p><strong>让模型“保留你的原始意图”，并“在复杂逻辑处添加代码注释”，这对您和后续模型理解代码都大有裨益。</strong></p>
<p><strong>当遇到棘手难题时，在提示词中加入一些触发词</strong>，比如 “take your time”（慢慢来）、“comprehensive”（全面一点）、“read all code that could be related”（读所有可能相关的代码）、“create possible hypothesis”（提出可能的假设） —— 这些都能让 codex 解决最棘手的问题。</p>
<h2 data-id="heading-21"><strong>13 你的 Agents/Claude 配置文件是什么样的？</strong></h2>
<p>我创建了一个名为 Agents.md 的主配置文件，然后为它创建了一个符号链接（译者注：Linux 操作系统中一个特殊的文件，内容存储指向目标文件或目录的路径字符串），这个链接的名字叫 claude.md。我这么做是因为开发 Claude 的 Anthropic 公司没有采用和其他工具（比如 Codex）统一的配置文件命名标准。我承认这很麻烦也不理想 —— 毕竟 GPT-5 和 Claude 偏好的提示词风格差异很大[39]。如果你还没看过它们各自的提示词指南，建议现在就去读一读。</p>
<p>Claude 对那种 🚨 全大写咆哮式命令 🚨[40]（比如“如果你执行 X 命令，后果将极其严重，100 只小猫会死掉！”）反应良好，但这会让 GPT-5 直接崩溃（也确实该崩溃）。所以，请彻底放弃这种写法，像正常人一样用平实的语言就行。这也意味着这些配置文件很难被最优地共享。不过对我来说问题不大，因为我主要用 codex，即使偶尔让 Claude 上场，我也接受这些指令对它来说可能强度不足。</p>
<p>我的 Agent 配置文件目前大约 800 行，感觉就像一堆“组织创伤”留下的疤痕组织。这不是我手写的，而是 codex 自己生成的。每次出了状况，我都会让它在文件里加一条简洁备注。我应该找个时间清理一下配置文件，但尽管文件很长，它却运行得极其可靠 —— GPT-5 也确实几乎总是遵守里面的规则。至少比 Claude 以前强太多了。（当然也得承认，Sonnet 4.5 在这方面确实有进步）</p>
<p>除了 Git 操作说明，文件里还包含产品说明书、我偏好的命名规范和 API 模式、关于 React Compiler 的注意事项等等 —— 很多内容甚至比模型的“世界知识”还新，因为我的技术栈相当激进。我预计随着模型更新，这部分内容还能进一步精简。例如，Sonnet 4.0 当年需要大量指导才能理解 Tailwind 4，而 Sonnet 4.5 和 GPT-5 已经内置了相关知识，所以我直接删掉了所有冗余的相关说明。</p>
<p>文件里很大一块内容专门描述我偏好的 React 模式、数据库迁移管理策略、测试规范，以及如何使用和编写 ast-grep 规则。（如果你还不知道 ast-grep，或者没把它用作代码库的 linter，请立刻停下来，让模型帮你把它设为 Git hook，用来拦截不符合规范的提交。）</p>
<p>我还尝试过一种基于文本的“设计系统”，用来规定 UI 应该长什么样 —— 不过这个实验目前还没下定论。</p>
<h2 data-id="heading-22"><strong>14 那么 GPT-5-Codex 是完美的吗？</strong></h2>
<p>当然不是。有时候它会花半个小时重构代码，然后突然 panic，把所有改动全 revert 掉 —— 这时候你得重新运行，并像哄小孩一样安抚它：“你有足够的时间，慢慢来。” 有时它会忘记自己其实能执行 bash 命令，需要你鼓励一下。偶尔它还会用俄语或韩语回复。更离谱的是，有时候这个“怪物”一滑手，直接把内部思考过程原样扔进了 bash 终端。但总体而言，这些情况相当罕见，而它在其他几乎所有方面都强到离谱，让我完全可以忽略这些小毛病。毕竟，人类也不是完美的。</p>
<p>我对 codex 最大的不满是它会“丢失文本行” —— 快速向上滚动时，部分文本会莫名其妙消失。真心希望 OpenAI 把这个 Bug 放在修复清单的最顶端，因为这是目前唯一迫使我放慢操作速度的原因，就怕消息突然不见了。</p>
<h2 data-id="heading-23"><strong>15 结论</strong></h2>
<p>别在 RAG、子智能体（subagents）、Agents 2.0 或其他华而不实的花架子上浪费时间了。直接跟它对话，动手试，慢慢培养直觉。你和智能体合作得越多，结果就会越好。</p>
<p>Simon Willison 的文章[41]说得特别到位：<strong>管理智能体所需的许多技能，其实和管理工程师非常相似 —— 而这些能力，几乎全都是资深软件工程师的特质。</strong></p>
<p>而且没错，写出好软件依然很难。我不再亲手写代码，并不意味着我不再深入思考架构、系统设计、依赖关系、功能实现，或者如何让用户感到惊喜。使用 AI 只意味着：大家对你交付成果的期望值变高了。</p>
<p>PS: 本文 100% 原创手写。我热爱 AI，但也清楚有些事用老办法反而更好。保留这些笔误，保留我的声音。🚄✌️</p>
<p>PPS: 文章头图由 Thorsten Ball 提供[42]，特此致谢。</p>
<p><strong>END</strong></p>
<p><strong>本期互动内容 🍻</strong></p>
<p><strong>❓文中哪个观点你极度认同？或者，哪个地方你持保留意见？</strong></p>
<p><strong>文中链接</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fchristianklotz%2Fstatus%2F1977866496001867925" target="_blank" title="https://x.com/christianklotz/status/1977866496001867925" ref="nofollow noopener noreferrer">x.com/christiankl…</a></p>
<p>[2]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fpmddomingos%2Fstatus%2F1976399060052607469" target="_blank" title="https://x.com/pmddomingos/status/1976399060052607469" ref="nofollow noopener noreferrer">x.com/pmddomingos…</a></p>
<p>[3]<a href="https://link.juejin.cn?target=https%3A%2F%2Fsteipete.me%2Fposts%2F2025%2Foptimal-ai-development-workflow" target="_blank" title="https://steipete.me/posts/2025/optimal-ai-development-workflow" ref="nofollow noopener noreferrer">steipete.me/posts/2025/…</a></p>
<p>[4]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1977771686176174352" target="_blank" title="https://x.com/steipete/status/1977771686176174352" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[5]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1977498385172050258" target="_blank" title="https://x.com/steipete/status/1977498385172050258" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[6]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgist.github.com%2Fsteipete%2Fd3b9db3fa8eb1d1a692b7656217d8655" target="_blank" title="https://gist.github.com/steipete/d3b9db3fa8eb1d1a692b7656217d8655" ref="nofollow noopener noreferrer">gist.github.com/steipete/d3…</a></p>
<p>[7]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1977119589860601950" target="_blank" title="https://x.com/steipete/status/1977119589860601950" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[8]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fweberwongwong%2Fstatus%2F1975749583079694398" target="_blank" title="https://x.com/weberwongwong/status/1975749583079694398" ref="nofollow noopener noreferrer">x.com/weberwongwo…</a></p>
<p>[9]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1976353767705457005" target="_blank" title="https://x.com/steipete/status/1976353767705457005" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[10]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1977072732136521836" target="_blank" title="https://x.com/steipete/status/1977072732136521836" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[11]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fvtahowe%2Fstatus%2F1976709116425871772" target="_blank" title="https://x.com/vtahowe/status/1976709116425871772" ref="nofollow noopener noreferrer">x.com/vtahowe/sta…</a></p>
<p>[12]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fs_streichsbier%2Fstatus%2F1974334735829905648" target="_blank" title="https://x.com/s_streichsbier/status/1974334735829905648" ref="nofollow noopener noreferrer">x.com/s_streichsb…</a></p>
<p>[13]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fkimmonismus%2Fstatus%2F1976404152541680038" target="_blank" title="https://x.com/kimmonismus/status/1976404152541680038" ref="nofollow noopener noreferrer">x.com/kimmonismus…</a></p>
<p>[14]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1978099041884897517" target="_blank" title="https://x.com/steipete/status/1978099041884897517" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[15]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1975297275242160395" target="_blank" title="https://x.com/steipete/status/1975297275242160395" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[16]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1977466373363437914" target="_blank" title="https://x.com/steipete/status/1977466373363437914" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[17]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fdeepfates%2Fstatus%2F1975604489634914326" target="_blank" title="https://x.com/deepfates/status/1975604489634914326" ref="nofollow noopener noreferrer">x.com/deepfates/s…</a></p>
<p>[18]<a href="https://link.juejin.cn?target=https%3A%2F%2Fampcode.com%2Fnews%2Fgpt-5-oracle" target="_blank" title="https://ampcode.com/news/gpt-5-oracle" ref="nofollow noopener noreferrer">ampcode.com/news/gpt-5-…</a></p>
<p>[19]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fbtibor91%2Fstatus%2F1976299256383250780" target="_blank" title="https://x.com/btibor91/status/1976299256383250780" ref="nofollow noopener noreferrer">x.com/btibor91/st…</a></p>
<p>[20]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fbadlogicgames%2Fstatus%2F1977103325192667323" target="_blank" title="https://x.com/badlogicgames/status/1977103325192667323" ref="nofollow noopener noreferrer">x.com/badlogicgam…</a></p>
<p>[21]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1976226900516209035" target="_blank" title="https://x.com/steipete/status/1976226900516209035" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[22]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1977286197375647870" target="_blank" title="https://x.com/steipete/status/1977286197375647870" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[23]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fthsottiaux%2Fstatus%2F1975565380388299112" target="_blank" title="https://x.com/thsottiaux/status/1975565380388299112" ref="nofollow noopener noreferrer">x.com/thsottiaux/…</a></p>
<p>[24]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fnews%2Fclaude-code-plugins" target="_blank" title="https://www.anthropic.com/news/claude-code-plugins" ref="nofollow noopener noreferrer">www.anthropic.com/news/claude…</a></p>
<p>[25]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwshobson%2Fagents%2Fblob%2Fmain%2Fplugins%2Fllm-application-dev%2Fagents%2Fai-engineer.md" target="_blank" title="https://github.com/wshobson/agents/blob/main/plugins/llm-application-dev/agents/ai-engineer.md" ref="nofollow noopener noreferrer">github.com/wshobson/ag…</a></p>
<p>[26]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FIanIsSoAwesome%2Fstatus%2F1976662563699245358" target="_blank" title="https://x.com/IanIsSoAwesome/status/1976662563699245358" ref="nofollow noopener noreferrer">x.com/IanIsSoAwes…</a></p>
<p>[27]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwisprflow.ai%2F" target="_blank" title="https://wisprflow.ai/" ref="nofollow noopener noreferrer">wisprflow.ai/</a></p>
<p>[28]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fcannn064%2Fstatus%2F1973415142302830878" target="_blank" title="https://x.com/cannn064/status/1973415142302830878" ref="nofollow noopener noreferrer">x.com/cannn064/st…</a></p>
<p>[29]<a href="https://link.juejin.cn?target=https%3A%2F%2Fconductor.build%2F" target="_blank" title="https://conductor.build/" ref="nofollow noopener noreferrer">conductor.build/</a></p>
<p>[30]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.terragonlabs.com%2F" target="_blank" title="https://www.terragonlabs.com/" ref="nofollow noopener noreferrer">www.terragonlabs.com/</a></p>
<p>[31]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1973132707707113691" target="_blank" title="https://x.com/steipete/status/1973132707707113691" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[32]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsteipete%2Fclaude-code-mcp" target="_blank" title="https://github.com/steipete/claude-code-mcp" ref="nofollow noopener noreferrer">github.com/steipete/cl…</a></p>
<p>[33]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsteipete%2Fbslog" target="_blank" title="https://github.com/steipete/bslog" ref="nofollow noopener noreferrer">github.com/steipete/bs…</a></p>
<p>[34]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsteipete%2Finngest" target="_blank" title="https://github.com/steipete/inngest" ref="nofollow noopener noreferrer">github.com/steipete/in…</a></p>
<p>[35]<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.chrome.com%2Fblog%2Fchrome-devtools-mcp" target="_blank" title="https://developer.chrome.com/blog/chrome-devtools-mcp" ref="nofollow noopener noreferrer">developer.chrome.com/blog/chrome…</a></p>
<p>[36]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1977762275302789197" target="_blank" title="https://x.com/steipete/status/1977762275302789197" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[37]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fsteipete%2Fstatus%2F1976985959242907656" target="_blank" title="https://x.com/steipete/status/1976985959242907656" ref="nofollow noopener noreferrer">x.com/steipete/st…</a></p>
<p>[38]<a href="https://link.juejin.cn?target=https%3A%2F%2Fknip.dev%2F" target="_blank" title="https://knip.dev/" ref="nofollow noopener noreferrer">knip.dev/</a></p>
<p>[39]<a href="https://link.juejin.cn?target=https%3A%2F%2Fcookbook.openai.com%2Fexamples%2Fgpt-5%2Fgpt-5_prompting_guide" target="_blank" title="https://cookbook.openai.com/examples/gpt-5/gpt-5_prompting_guide" ref="nofollow noopener noreferrer">cookbook.openai.com/examples/gp…</a></p>
<p>[40]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FAltimor%2Fstatus%2F1975752110164578576" target="_blank" title="https://x.com/Altimor/status/1975752110164578576" ref="nofollow noopener noreferrer">x.com/Altimor/sta…</a></p>
<p>[41]<a href="https://link.juejin.cn?target=https%3A%2F%2Fsimonwillison.net%2F2025%2FOct%2F7%2Fvibe-engineering%2F" target="_blank" title="https://simonwillison.net/2025/Oct/7/vibe-engineering/" ref="nofollow noopener noreferrer">simonwillison.net/2025/Oct/7/…</a></p>
<p>[42]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fthorstenball%2Fstatus%2F1976224756669309195" target="_blank" title="https://x.com/thorstenball/status/1976224756669309195" ref="nofollow noopener noreferrer">x.com/thorstenbal…</a></p>
<p><em><strong>本文经原作者授权，由 Baihai IDP 编译。如需转载译文，请联系获取授权。</strong></em></p>
<p><strong>原文链接：</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsteipete.me%2Fposts%2Fjust-talk-to-it" target="_blank" title="https://steipete.me/posts/just-talk-to-it" ref="nofollow noopener noreferrer">steipete.me/posts/just-…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI 代码评估的下一阶段已经到来]]></title>    <link>https://juejin.cn/post/7574253222606422057</link>    <guid>https://juejin.cn/post/7574253222606422057</guid>    <pubDate>2025-11-19T09:33:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574253222606422057" data-draft-id="7574230922314776582" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI 代码评估的下一阶段已经到来"/> <meta itemprop="keywords" content="AI编程"/> <meta itemprop="datePublished" content="2025-11-19T09:33:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="是魔丸啊"/> <meta itemprop="url" content="https://juejin.cn/user/3217622495411292"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI 代码评估的下一阶段已经到来
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3217622495411292/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    是魔丸啊
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:33:27.000Z" title="Wed Nov 19 2025 09:33:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读11分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnews.lmarena.ai%2Fcode-arena%2F" target="_blank" title="https://news.lmarena.ai/code-arena/" ref="nofollow noopener noreferrer">转载</a></p>
<h4 data-id="heading-0">Aryan Vichare</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1e7098834d6404bb145067396ceb733~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149607&amp;x-signature=dUQerb0uAQPl5Z9QOCTF8XhnAzA%3D" alt="" loading="lazy"/></p>
<p><strong>介绍 Code Arena：现实世界中 agentic coding 的实时评估</strong></p>
<p>AI 代码模型发展迅速。如今的系统不再只是一次性输出静态代码。它们<strong>构建</strong>。它们搭建完整的 Web 应用和站点，重构复杂系统，并实时自我调试。许多现在扮演着<strong>coding agents</strong>的角色，规划和执行结构化操作来设计和部署完整的应用程序。</p>
<p>但问题不再是"模型能写代码吗？"而是"它在多大程度上能端到端地构建真实的应用程序？"</p>
<p>传统基准测试衡量<strong>正确性</strong>：代码是否能编译并通过一组静态测试用例。正确性很重要，但这只是定义真实开发的部分。构建软件是迭代性和创造性的：你规划、测试、完善和重复。一个可信的评估必须反映这个过程。</p>
<p><strong>Code Arena</strong> 正好做到了这一点。这是我们下一代评估系统，从零开始重建，专为透明度、精确性和现实世界性能而设计。模型在受控的隔离环境中作为交互式 agents 运行，每个提示、渲染和操作都被记录。会话在访问之间可恢复且持久，生成内容可以稍后共享或重新访问。</p>
<p>其结果是一个实时的、可检查的系统，不仅评估代码是否有效，还评估<strong>它运行得如何良好</strong>、<strong>它交互得如何自然</strong>，以及<strong>它如何忠实地满足预期设计</strong>。Code Arena 衡量<strong>动态编码</strong>，捕捉模型在模拟真实开发的条件下如何思考、规划和构建。</p>
<h2 data-id="heading-1">为开发者带来什么新内容</h2>
<p>Code Arena 引入了面向开发者的体验，旨在营造实时编码环境的感觉：交互式、透明，并且从头到尾都是持久的。</p>
<ul>
<li><strong>Agentic behaviors（代理行为）</strong>： 模型使用结构化工具调用（create_file、edit_file、read_file）自主规划和执行，逐步展示推理过程。</li>
<li><strong>Multi-turn, multi-step execution（多轮、多步执行）</strong>： 模型在多次交互中迭代、编辑和完善，在单次评估中完成复杂构建。</li>
<li><strong>Real-time generation（实时生成）</strong>： 输出在模型构建时实时渲染，因此开发者可以在代码演进过程中探索运行中的应用。</li>
<li><strong>Persistent sessions（持久会话）</strong>： 代码会话在访问之间可恢复且持久，保留状态并支持协作审查。</li>
<li><strong>Recursive edits and HTML file trees（递归编辑和HTML文件树）</strong>： 每次生成包含完整的项目结构（HTML、CSS、JS），让评估者检查模型如何管理相互依赖的文件和递归编辑。</li>
<li><strong>Shareable generations（可共享生成）</strong>： 每个构建都可通过唯一链接共享，用于同行测试或模型比较。</li>
<li><strong>Unified workflow（统一工作流）</strong>： 提示、生成和评估现在完全在 Arena 的基础设施内完成，确保受控环境、一致参数和可重现结果。</li>
</ul>
<p>总之，这些更新将基准测试变成一个你可以看到、运行和共享的实验。Code Arena 现在是一个面向开发者、模型构建者、原型制作者、知识工作者、创意专业人士等的透明编码环境。</p>
<h2 data-id="heading-2">Code Arena 如何工作</h2>
<p>每次 Code Arena 评估都是一个可重现的实验，捕捉 AI 辅助开发的完整轨迹，从想法到生成到人类判断。</p>
<ol>
<li><strong>Prompt（提示）</strong>： 评估者或开发者提交一个任务，例如"构建一个带有暗色模式的 markdown 编辑器。"</li>
<li><strong>Plan（规划）</strong>： 模型解释请求并使用结构化工具调用决定采取哪些操作。这种 agentic 规划反映了真实的开发者工作流程。</li>
<li><strong>Generate（生成）</strong>： 模型生成实时的、可部署的 Web 应用和站点。</li>
<li><strong>Record（记录）</strong>： 每个模型操作（文件创建、编辑或执行）都被记录和版本控制。快照存储在 Cloudflare R2 中并链接到 Arena 的数据库以实现透明可追溯性。</li>
<li><strong>Render（渲染）</strong>： 生成的应用通过安全前端流式传输，使用 CodeMirror 6 进行源代码查看，使用实时预览进行交互和测试。</li>
<li><strong>Vote（投票）</strong>： 评估者成对比较输出，评估功能、可用性和保真度以及设计、品味和美学。每个投票都存储有完整的上下文：模型版本、延迟和环境。</li>
<li><strong>Aggregate（聚合）</strong>： 结构化的人类判断实时反馈到排行榜，显示置信区间和性能方差，而不是静态平均值。</li>
</ol>
<p>这个从提示到实时应用再到可验证投票的闭环管道，确保了 Code Arena 中的每个结果都是透明的、可重现的和科学基础的。Code Arena 不仅仅是完善我们评估 AI 代码模型的方式，它重新定义了基础本身。</p>
<h2 data-id="heading-3">从 WebDev Arena 到 Code Arena</h2>
<p>当我们启动 WebDev Arena 时，它引入了第一个大规模的人工参与式 AI 编码基准测试。开发者可以观看模型构建真实应用、与输出交互并对性能投票，使评估具有参与性和透明度。</p>
<p>随着使用规模的扩大，对精确性和可重现性的需求也日益增长。最初为实验设计的系统，无法满足现实世界使用和评估所需的严格性要求。</p>
<p>Code Arena 从零开始重建了这个基础。每个组件都为透明度、可追溯性和方法控制而重新设计。其结果是一个更强大、更具科学基础的系统，不仅衡量代码是否<strong>有效</strong>，还衡量它在实践中<strong>运行得如何良好</strong>。</p>
<h2 data-id="heading-4">重建内部</h2>
<p>Code Arena 不仅仅是基础设施升级。它是一个新的评估框架，为可重现性、透明度和科学严谨性而构建。每次评估都在为精确性和规模而设计的严格控制环境中运行，其中每个操作、渲染和结果都被记录并可重现。</p>
<ul>
<li><strong>Agentic tool use（代理工具使用）</strong>： 模型通过结构化工具调用自主创建、修改和执行代码，实现递归编辑和依赖管理等现实世界行为。</li>
<li><strong>Persistent and shareable sessions（持久和可共享会话）</strong>： 代码会话在访问之间是可恢复和持久的，允许用户重新访问、检查和分发实时生成内容。</li>
<li><strong>Reproducibility（可重现性）</strong>： 每个提示、模型版本和人类投票都链接到可追踪的 ID。</li>
<li><strong>Scoring framework（评分框架）</strong>： 结果结合结构化的人类评估与透明统计聚合，包括评估者间可靠性和置信区间。</li>
</ul>
<p>这种组合将 Code Arena 从排行榜转变为科学测量系统，其中每个数字都是可重现的，每个输出都是可验证的，每个模型都可以在现实世界条件下测试。</p>
<h3 data-id="heading-5">统一评估系统和方法论</h3>
<p>提示、生成、比较和投票现在在 Arena 平台内以一个无缝工作流程中进行。这种集成减少了延迟，提高了可靠性，并允许对数千个同时任务进行精确跟踪。</p>
<p>有了 Code Arena，我们不仅仅是更新了界面。我们重建了编码评估的基础。每个模型都在三个轴上评分，这反映了真实的开发者判断：</p>
<ul>
<li><strong>Functionality（功能性）</strong>： 应用程序是否做到了它应该做的？</li>
<li><strong>Usability（可用性）</strong>： 它是否清晰、响应迅速和直观？</li>
<li><strong>Fidelity（保真度）</strong>： 它是否匹配请求的设计或行为？</li>
</ul>
<p>新系统引入了<strong>agentic、多轮执行</strong>，模型自主规划和执行操作。每个模型可以调用像 create_file、edit_file 和 run_command 这样的工具，在结构化步骤中递归完善自己的工作。这实现了反映真实工程行为的复杂、迭代开发周期。</p>
<p>模型生成和部署完全交互的 Web 应用和站点，每次评估在一致条件下记录从提示到最终渲染的完整链，确保结果是可追溯的、可审计的和可重复的。</p>
<p>评估仍然是人工驱动的，但现在应用结构化评分和透明聚合，产生统计验证和可重现的结果。这次重建为 Code Arena 的演进评估框架奠定了基础，基于三个原则：</p>
<ul>
<li><strong>Humans at the core（人类为核心）</strong>： 每个分数都代表人类判断。投票随上下文记录并透明聚合。</li>
<li><strong>Show our work（展示工作）</strong>： 每个指标都链接到其数据：成本、延迟和方法论。透明度内置于基础设施中。</li>
<li><strong>Embrace uncertainty（拥抱不确定性）</strong>： Arena 发布置信区间和方差，而不仅仅是平均值。评估应该反映细微差别，而不是掩盖它。</li>
</ul>
<h3 data-id="heading-6">干净数据基础和新排行榜</h3>
<p>因为 Code Arena 的架构和方法论已经完全重建，它在为从头开始反映这个新系统而设计的新排行榜上启动。没有数据从 WebDev Arena 合并或改造，确保方法论一致性并保护未来比较的完整性。</p>
<p>将 WebDev Arena 的结果合并会损害数据完整性，因为它结合了在不同评分系统、环境和假设下产生的评估。从头开始允许 Code Arena 在清晰、可重现的评估规则下成熟，免受遗留偏见影响，并符合我们对透明度和可审计性的严格标准。</p>
<p>原始的 WebDev Arena 排行榜（<strong>WebDev Legacy</strong>）将在不久的将来退休，但目前，它仍然保持在线状态，作为 AI 编码评估第一个时代的历史记录。支撑 Code Arena 的新 <strong>WebDev V2 排行榜</strong>定义了现实世界性能的前瞻标准。</p>
<h3 data-id="heading-7">偏见跟踪和数据完整性</h3>
<p>每次 UI 或工作流更改都可以改变人类投票模式。Arena 将其视为评估科学的一部分。在任何更改集成之前，团队运行偏见审计，测量对投票行为的影响并在排行榜更新前进行补偿。这确保人工参与式评估在平台演进时保持一致、公平和统计合理。</p>
<h2 data-id="heading-8">社区为核心</h2>
<p>Arena 的优势一直是其社区：相信进步应该是开放、可测量和可共享的开发者、研究者和构建者。Code Arena 将这种信念付诸实践。</p>
<p>在平台内部，真实参与者推动每次评估。开发者探索实时应用、比较输出，并决定哪些模型在真实场景中表现最佳。他们的集体反馈构成了推动排行榜的数据。人类判断转化为结构化洞察。</p>
<p>Arena Discord 社区保持这个循环活跃。开发者在这里提出新挑战、参加实时测试，并发现帮助完善框架本身的异常情况。这种协作确保 Code Arena 与它所衡量的生态系统共同演进。</p>
<p>Arena Creator Community 延续了这种精神，展示人们如何使用、测试和构建 Arena。他们的项目使评估不仅是开放和透明的，而且是有吸引力和创造力的。</p>
<p>当人们参与 Code Arena 时，他们不仅仅是生成数据。<strong>他们在定义什么是好的 AI 编码。</strong></p>
<h2 data-id="heading-9">下一步</h2>
<p>Code Arena 的启动标志着一个新阶段的开始，专注于深度、可靠性和覆盖范围。在未来几个月，团队将继续完善数据质量、延迟和评估速度，同时扩展模型可以构建的内容以及开发者与它们的交互方式。</p>
<p>下一波更新将引入多文件 React 应用程序，允许模型生成结构化仓库而不是单文件原型，使 Code Arena 更接近现实世界软件开发：迭代、分层和可视化。</p>
<p>在未来几个月内，Arena 将开始推出 agent 支持和多模态输入，以及多文件项目的隔离沙盒。这些扩展将 Code Arena 推向连接的、协作的环境，反映现代 coding agents 实际如何跨系统、界面和媒体工作。</p>
<p>Code Arena 不是静态基准测试。它是一个活系统，随着每个新模型、实验和人类投票而演进。每次更新都加强其基础：为规模而构建的透明、可重现评估。</p>
<p>Arena 的使命一直是衡量重要的东西：AI 在现实世界中的表现。有了 Code Arena，这个使命现在触及软件创造的核心。这是开发者、研究者和模型构建者汇聚一堂、共同测试性能的地方。</p>
<p>AI 代码评估的下一阶段已经到来。</p>
<p>👉 <a href="https://link.juejin.cn?target=https%3A%2F%2Flmarena.ai%2Fcode%3Fref%3Dnews.lmarena.ai" target="_blank" title="https://lmarena.ai/code?ref=news.lmarena.ai" ref="nofollow noopener noreferrer">探索 Code Arena →</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gemini 3深夜来袭：力压GPT 5.1，大模型谷歌时代来了]]></title>    <link>https://juejin.cn/post/7574270661871861798</link>    <guid>https://juejin.cn/post/7574270661871861798</guid>    <pubDate>2025-11-19T09:34:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574270661871861798" data-draft-id="7574254039023075354" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gemini 3深夜来袭：力压GPT 5.1，大模型谷歌时代来了"/> <meta itemprop="keywords" content="人工智能,OpenAI"/> <meta itemprop="datePublished" content="2025-11-19T09:34:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="机器之心"/> <meta itemprop="url" content="https://juejin.cn/user/1873223543167902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gemini 3深夜来袭：力压GPT 5.1，大模型谷歌时代来了
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1873223543167902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    机器之心
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:34:01.000Z" title="Wed Nov 19 2025 09:34:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Gemini 3 还没现身，推特先崩为敬。</p>
<p>没有哪家模型的发布比 Gemini 3 更万众瞩目，根据 Gemini 之前 3 个月更新一次的频率，AI 社区自 9 月起便对 Gemini 3 翘首以盼。</p>
<p>今天，谷歌开发者关系负责人、Google AI Studio 负责人一条仅含「Gemini」一词的推文，积蓄了数月的期待终于迎来了爆发点，推特相关话题瞬间沸腾。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8fdf3a46b4f4c1f8d218977e623dfee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=Z8kDAj7mQj75loo0ry8DMWz%2B4tU%3D" alt="图片" loading="lazy"/></p>
<p>有趣的是，临近发布节点，推特竟「应景」地崩了几次。尽管「幕后黑手」是 Cloudflare，但这崩溃的时机简直精准得让人怀疑有人背后搞鬼（小声蛐蛐：毕竟推特是各家模型的宣传主阵地）。</p>
<p>不知道今早刚发了 Grok 4.1 的马斯克此时作何感想，反正网友的梗图已经铺天盖地了。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9994822a8f49485ebb48cf10cb382ad1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=PydLY2WC%2BYpnYk3uZDkCjFC9lUQ%3D" alt="图片" loading="lazy"/></p>
<p>就在刚刚，Gemini 3 终于正式登场，让我们看看在万众瞩目下登场的它到底有多强。</p>
<p>最智能模型</p>
<p>事实证明，Google 没有让等待的人失望，Gemini 3 正式发布，再一次定义了 SOTA，奥特曼和马斯克也发来贺电。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35da33afde8b4c34bc6ba64ea9e13993~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=VGAsHPu7i%2F3nOg5g%2BI4pdl4gW00%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a056f8d7cf2b41a0b012b608bf31b514~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=9G%2F1JdITkQ2p8TOja5Tebr%2F7dy4%3D" alt="图片" loading="lazy"/></p>
<p>Google 将其定义为「通往 AGI 的重要一步」，并强调这是目前世界上多模态理解能力最强、交互最深度的智能体。</p>
<p>Gemini 3 不仅在基础推理能力上刷新了 SOTA 标准，更通过推出全新的 Google Antigravity 平台和 Deep Think 模式，试图重塑开发者生态与 AI 辅助体验。</p>
<p>全面霸榜的推理怪兽</p>
<p>Gemini 3 Pro 被官方称为「最先进的推理模型」，在几乎所有主流 AI 基准测试中均显著超越了前代 Gemini 2.5 Pro，并且全面压制了 Claude Sonnet 4.5 和 GPT-5.1 等主要竞品。</p>
<p>Gemini 3 Pro 以 1501 Elo 的突破性高分登顶 LMArena Leaderboard，在 Humanity’s Last Exam（在不使用任何工具的情况下达到 37.5%）和 GPQA Diamond（91.9%）上获得最高分，展示了博士级的推理能力。它还在数学方面为前沿模型树立了新标准，在 MathArena Apex 上达到了 23.4% 的最新 SOTA 水平。</p>
<p>除了文本与逻辑，Gemini 3 Pro 还重新定义了多模态推理的上限。它在 MMMU-Pro 和 Video-MMMU 上分别斩获了 81% 和 87.6% 的高分，这意味着无论是解析复杂的科学图表还是理解动态视频流，它都游刃有余。</p>
<p>更值得一提的是，它在 SimpleQA Verified 上取得了 72.1% 的成绩，显示出在事实准确性上的巨大进步 —— 它不仅强，而且可靠。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/baf441b2cc824f8db9237fba0d172c4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=AczIKcVzJG7%2BzNSBldGWW2CeBs4%3D" alt="图片" loading="lazy"/></p>
<p>拒绝奉承的思维伙伴</p>
<p>Gemini 3 Pro 的进化不仅在于跑分，更在于交互的质感。它摒弃了以往 AI 常见的陈词滥调和过度奉承，变得聪明、简洁且直接：告诉你需要听到的，而不仅仅是你爱听的。</p>
<p>它充当真正的思维伙伴，为你提供理解信息和表达自我的新方式，从通过生成高保真可视化的代码来翻译晦涩的科学概念，到创造性的头脑风暴。</p>
<p>Gemini 3 编写代码可视化托卡马克装置中的等离子体流，并创作了一首捕捉聚变物理学原理的诗。</p>
<p>Gemini 3 Deep Think</p>
<p>Gemini 3 Deep Think 模式进一步拓展了智能的边界，带来了 Gemini 3 在推理和多模态理解能力上的重大进步，帮助你解决更复杂的问题。</p>
<p>在测试中，Gemini 3 Deep Think 在 Humanity's Last Exam（不使用工具的情况下得分 41.0%）和 GPQA Diamond（得分 93.8%）上的表现均优于 Gemini 3 Pro 已相当出色的成绩。此外，它在 ARC-AGI-2（代码执行，已通过 ARC Prize 验证）上也取得了前所未有的 45.1% 的得分，展现了其解决全新挑战的能力。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cd550bd28884cbfbfbed05eb76bfca9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=CUOT56ExClY%2ByWarboRwV2P0ZME%3D" alt="图片" loading="lazy"/></p>
<p>Gemini 3 Deep Think 模式在一些最具挑战性的 AI 基准测试中表现出色。</p>
<p>学习、构建与规划</p>
<p>学习任何事情</p>
<p>Gemini 从一开始就旨在无缝整合任何主题的多种模态信息，包括文本、图像、视频、音频和代码。Gemini 3 结合了其先进的推理、视觉和空间理解能力、领先的多语言性能以及百万级 token 上下文窗口，进一步拓展了多模态推理的边界，帮助你以最适合自己的方式学习。</p>
<p>例如，如果你想学习如何烹饪家族传统菜肴，Gemini 3 可以解读并翻译不同语言的手写食谱，生成可与家人分享的食谱。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2725632f8f54eac96a16acd375555df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=lRgk%2FdCqPtiLdSnoOrUWIVtllMI%3D" alt="图片" loading="lazy"/></p>
<p>或者，如果你想学习某个新主题，就可以提供学术论文、长篇视频讲座或教程，它可以生成交互式记忆卡片、可视化或其他格式的代码，帮助你掌握相关知识。</p>
<p>它甚至可以分析你的匹克球比赛视频，找出可以改进的地方，并制定训练计划，帮助你全面提升球技。</p>
<p>为了帮助你更好地理解网络上的信息，搜索中的 AI 模式现在使用 Gemini 3 来实现新的生成式 UI 体验，例如沉浸式视觉布局、交互式工具和模拟，所有这些都是根据你的查询即时生成的。</p>
<p>学习像 RNA 聚合酶如何在 AI 模式下的生成式 UI 中工作这样的复杂主题 。</p>
<p>开发任何东西</p>
<p>在 2.5 Pro 成功的基础上，Gemini 3 兑现了将开发者的任何想法变为现实的承诺。它在零样本生成方面表现出色，能够处理复杂的提示和指令，从而渲染出更丰富、更具交互性的 Web 用户界面。</p>
<p>Gemini 3 是谷歌迄今为止构建的最佳 Vibe 编码和 Agent 编码模型，它使谷歌的产品更加自主，并显著提升了开发者的效率。它在 WebDev Arena 排行榜上名列榜首，获得了令人瞩目的 1487 Elo 分数。此外，它在 Terminal-Bench 2.0 测试中也取得了 54.2% 的成绩，该测试旨在评估模型通过终端操作计算机的工具使用能力。同时，它在 SWE-bench Verified 测试中也大幅超越了 2.5 Pro 版本（得分为 76.2%），该测试用于衡量编码代理的性能。</p>
<p>现在，用户可以使用 Google AI Studio、Vertex AI、Gemini CLI 以及谷歌全新的智能体开发平台 Google Antigravity 中的 Gemini 3 进行构建 。它也适用于 Cursor、GitHub、JetBrains、Manus、Replit 等第三方平台。</p>
<p>比如编写一款具有更丰富的视觉效果和更强交互性的复古 3D 太空飞船游戏。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c680556f960e451a9871df47039e1eff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=y%2B0j1VU1XrxWCapo%2BBcs6b50vdY%3D" alt="图片" loading="lazy"/></p>
<p>再比如编写更丰富、更具交互性的 Web UI 和应用程序：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/007f80b2f7ac49c68f40e7bbc8e46d6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=WhpJiPEl8C93kTc1lyzw3Y8Yzgc%3D" alt="图片" loading="lazy"/></p>
<p>规划任何事</p>
<p>自 Gemini 2 智能体之后，Gemini 显著提升了长周期任务中的规划能力。</p>
<p>Gemini 3 的规划能力在 Vending-Bench 2 测试中进一步得到印证：Gemini 3 在模拟售货机经营测试中登顶该排行榜，全程通过长周期规划管理虚拟商业运营。</p>
<p>在完整模拟年度的运营中，Gemini 3 Pro 始终保持稳定的工具调用与决策连贯性，在持续专注任务目标的同时实现了更高投资回报。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3344f7611f01475ebc0994b52f178b6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=b2GuwBahUHfqCa1b%2BBcl4jHGBqI%3D" alt="图片" loading="lazy"/></p>
<p>Gemini 3 Pro 展现出更卓越的长周期规划能力，与其他前沿模型相比，能创造更高的回报。</p>
<p>Gemini Agent 还可以帮助整理 Gmail 收件箱。</p>
<p>Gemini 3 现已全面开放。即日起，普通用户和订阅用户分别可通过 Gemini App 及搜索 AI 模式使用新模型；开发者与企业客户也能通过 AI Studio、Vertex AI 等渠道接入。至于备受期待的「深度思考模式」，预计将在未来几周内面向 Google AI Ultra 订阅用户独家上线。</p>
<p>另外，根据此前泄露的模型卡，还有许多值得关注的关键信息：Google 使用 TPU 从头开始训练这个模型，作为一个 MoE，具有 1M 输入和 64k token 输出，MoE 意味着他们可以负担得起使其变得便宜。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/488fba85e6bf4d779d80ed172d8904f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=JVTJaLmVzH1q0BR%2B%2BhOLfbNDNSo%3D" alt="图片" loading="lazy"/></p>
<p>定价方面，Gemini 3.0 Pro 引入了基于上下文长度的分级定价机制：200k tokens 以下的任务，输入 / 输出价格为 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2.00</mn><mi mathvariant="normal">/</mi></mrow><annotation encoding="application/x-tex">2.00/</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">2.00/</span></span></span></span></span>12.00（每百万 token）；超过 200k tokens 则分别为 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.00</mn><mtext>和</mtext></mrow><annotation encoding="application/x-tex">4.00 和 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord">4.00</span><span class="mord cjk_fallback">和</span></span></span></span></span>18.00。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d374233fcb8498596cfd2549256b384~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=bV5TRD74hbe32qRTxdLFA7vk9Ww%3D" alt="图片" loading="lazy"/></p>
<p>全新的「智能体优先」开发体验</p>
<p>Google Antigravity 是 Google 全新的智能体开发平台，使开发者能够在更高、以任务为导向的层面上进行操作。利用 Gemini 3 先进的推理、工具使用和智能体编程能力，Google Antigravity 将 AI 辅助从开发者工具箱中的一个工具转变为积极的合作伙伴。</p>
<p>虽然 Google Antigravity 的核心是熟悉的 AI IDE（集成开发环境）体验，但其智能体已被提升到一个专用界面，并被赋予直接访问编辑器、终端和浏览器的权限。现在，智能体可以代表你自主规划并同时执行复杂的端到端软件任务，同时验证它们自己的代码。</p>
<p>除了 Gemini 3 Pro，Google Antigravity 还紧密结合了 Google 最新的用于浏览器控制的 Gemini 2.5 Computer Use 模型，以及其顶级的图像编辑模型 Nano Banana (Gemini 2.5 Image)。</p>
<p>一手体验</p>
<p>既然 Gemini 3 Pro 预览版上线了 AI Studio 平台，我们也来上手体验了一把。</p>
<p>Prompt : SVG of NEW YORK SKYLINE Use whatever libraries to get this done but make sure I can paste it all into a single HTML file and open it in Chrome.make it interesting and highly detail , shows details that no one expected go full creative and full beauty in one code block.</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c80297c85c7f4389a4c266b15053975c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=4MYy1bRx2C0hIgaIjJIaL2kvTxg%3D" alt="图片" loading="lazy"/></p>
<p>Prompt: Create a visually stunning Space Invaders game.</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/132dd356610842099e8b0473e208882f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=Fdu%2BfN6IDx5JmycJCGU5kDxL3Ss%3D" alt="图片" loading="lazy"/></p>
<p>鹈鹕骑自行车曾难倒一众大模型，这次我们也让 Gemini 3 试了下。Prompt：An animated SVG of a pelican riding a bicycle.</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24960717397240ebb7c2013a8b6ba7c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=lM4670T2IyG4xi73Of957ryT8L8%3D" alt="图片" loading="lazy"/></p>
<p>相比之前版本，Gemini 3 已有较大进步，不过仍有 bug，比如自行车的脚蹬在天上空转。</p>
<p>我们又换了一个更为清晰的提示词：Create a single, complete, self-contained animated SVG code (no external files or images) of a cute pelican riding a bicycle from a side view. 这次 Gemini 3 生成的自行车似乎没有脚蹬。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71746c1cb2224d45a6789b5e5b69702b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=JByAwk83QzCF6cJnDuWbQsFxL1k%3D" alt="图片" loading="lazy"/></p>
<p>写在最后</p>
<p>在 X 博主 Chubby 发起的「到 2026 年底，哪家公司拥有最好的 LLM?」投票中，Google Gemini 遥遥领先。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed58ea0be2dc4ac6b7359e9a02e8eabb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=Cj%2BiN2h8Jq%2FPqAyW2IstO7Wxe8k%3D" alt="图片" loading="lazy"/></p>
<p>这种市场信心的回升也体现在了数据上，Alphabet CEO Sundar Pichai 在官方博客中回顾了 Gemini 过去两年的进展：AI Overviews 月活跃用户已达 20 亿，Gemini 应用月活突破 6.5 亿，此外更有超过 70% 的云客户以及 1300 万开发者正在使用其生成式模型。</p>
<p>回望过去两年，从 Bard（Gemini 前身）发布时的仓促应战与股价暴跌，到痛定思痛合并 Google DeepMind、召回创始人、斩获诺贝尔奖，Google 完成了一场教科书般的「大象转身」。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/278308475ebc49a9b95037ca685d7f25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149641&amp;x-signature=O%2B49OZn1jpEP88bzmLy3bjnaiPo%3D" alt="图片" loading="lazy"/></p>
<p>那个曾经定义了 Transformer、如今「All in Gemini」的巨人，已经做好了全面反击的准备。</p>
<p>至于它到底能不能终结「最好的 LLM」之争？别急，让子弹（和服务器）再飞一会儿。</p>
<p>参考链接：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.google%2Fproducts%2Fgemini%2Fgemini-3%2F%255B%23gemini%255D()-3" target="_blank" title="https://blog.google/products/gemini/gemini-3/%5B#gemini%5D()-3" ref="nofollow noopener noreferrer">blog.google/products/ge…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[如视发布空间大模型Argus1.0，支持全景图等多元输入，行业首创！]]></title>    <link>https://juejin.cn/post/7574254039023108122</link>    <guid>https://juejin.cn/post/7574254039023108122</guid>    <pubDate>2025-11-19T09:35:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574254039023108122" data-draft-id="7574105194167730222" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="如视发布空间大模型Argus1.0，支持全景图等多元输入，行业首创！"/> <meta itemprop="keywords" content="人工智能,OpenAI"/> <meta itemprop="datePublished" content="2025-11-19T09:35:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="机器之心"/> <meta itemprop="url" content="https://juejin.cn/user/1873223543167902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            如视发布空间大模型Argus1.0，支持全景图等多元输入，行业首创！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1873223543167902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    机器之心
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:35:31.000Z" title="Wed Nov 19 2025 09:35:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读12分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>近来，世界模型（World Model）很火。多个 AI 实验室纷纷展示出令人惊艳的 Demo：仅凭一张图片甚至一段文字，就能生成一个可交互、可探索的 3D 世界。这些演示当然很是炫酷，它们展现了 AI 强大的生成能力。</p>
<p>但一个关键问题随之而来：这些由 AI 生成的世界中，绝大部分事物都是模型想象和虚构的。</p>
<p>如果我们不满足于「创造」一个虚拟世界，而是想把我们当下生活的这个真实世界（比如我们的家、办公室、工厂和城市）完整地变成一个可交互、可计算的 3D 世界呢？</p>
<p>这正是如视（Realsee）想要解答的问题。11 月 13 日，如视，这家数字空间及空间智能综合解决方案引领者，正式发布了其空间大模型 Argus 1.0，这也是全球首个（目前也是唯一一个）支持全景图输入，推测空间深度的大模型。它所代表的正是与虚拟生成截然不同的另一条路径：真实复刻。而这背后，正是「空间智能」相关技术不断演进的结果。</p>
<p>Argus 1.0 的目标不是「虚构」世界，而是「还原」真实的世界。它能够以毫秒级的速度，从一个场景下的单张或多张全景/普通图像中，推理出所有图像带绝对尺度的相机位姿、深度图和点图。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b5e0b9b61e4467383c70447443a5a94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=Wj%2F%2B6KNQ%2FWVcx%2BBH6ILxXO%2FfzAE%3D" alt="图片" loading="lazy"/></p>
<p>体验地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fh5.realsee.cn%2Fargus%3FUTM%3Darticlejqzx" target="_blank" title="https://h5.realsee.cn/argus?UTM=articlejqzx" ref="nofollow noopener noreferrer">h5.realsee.cn/argus?UTM=a…</a></p>
<p>从想象到测量，从虚拟到真实，Argus 1.0 的出现为 2D 图像通向 3D 真实空间架起了一座高速桥梁。这一技术突破意味着什么？它背后是如视怎样的技术积累与战略布局？</p>
<p>带着这些问题，我们与如视副总裁、首席科学家潘慈辉博士进行了深入对话，试图解码 Argus 模型的技术特性，及其在如视「空间智能」版图中的关键角色。</p>
<p>Argus 1.0 诞生的基石</p>
<p>如视的「数字空间-算法-行业应用」飞轮</p>
<p>任何强大模型的诞生都不是空中楼阁，Argus 1.0 也不例外。它根植于如视自 2017 年成立以来，围绕空间数字化所构建的深厚壁垒。在与潘慈辉博士的交流中，他提到了一个核心概念：「数字空间-算法-行业应用」的飞轮循环。而这个飞轮的核心驱动力，正是如视引以为傲的「真实空间数据库」。</p>
<p>核心资产：全球最大的三维空间数据库</p>
<p>作为最初脱胎于贝壳找房的事业部，如视从房产交易这一刚需场景切入，开启了大规模空间数字化的进程。截至 2025 年 9 月，如视已在全球范围内积累了突破 5300 万套的数字空间数据，覆盖面积超过 44 亿平方米。</p>
<p>潘慈辉解释道：「这个全球最大的真实空间数据库，是如视算法能力迭代的驱动器。」</p>
<p>海量数据的积累，持续驱动着空间智能 AI 算法的提升；而更强的系统能力，又为房产租售、家装家居、商业零售、工业园区等九大行业提供了高质量的解决方案；这些解决方案的落地，反过来又让如视得以触达更多元化的空间场景数据。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0b6ebcc47054e11b4bba7a40798a346~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=VLsrliqXxZ66wy2CHioZ77DB0R8%3D" alt="图片" loading="lazy"/></p>
<p>高质量空间数据：高精度、完备且一致</p>
<p>如果说 5300 万的量构筑了护城河的宽度，那么数据的质则决定了护城河的深度。潘慈辉强调，Argus 1.0 最大的技术突破，正得益于如视坚持自研硬件与算法的技术路线，这为其带来了「完备且一致」的高质量数据。</p>
<p>潘慈辉说：「我们的数据最大的特色，是在硬件设计和标定阶段就保证了最终采集的图像数据和激光点云数据是完备的，并且做到了像素级精度的对齐。」</p>
<p>不同于业内一些只有图像数据（缺乏绝对尺度）或只有激光数据（缺乏纹理）的方案，如视通过自研的伽罗华（Galois）系列 3D 激光扫描仪（其 P4 型号可直出 3 亿像素超高清全景图，图像与点云平均匹配误差小于 2 个像素），确保了每一份数据都是「所见即所得」的高精度数据对。这种在源头就严格标定、高度一致的真实数据，是 Argus 1.0 能够学习到准确深度和绝对尺度的前提，也是其远超其他算法的养料。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ef6c85447144434a5a395be458c1bca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=%2BuchhuszZqzm57ZkTzC4rfj4pIo%3D" alt="图片" loading="lazy"/></p>
<p>伽罗华 Galois P4 亮点概览</p>
<p>应用导向的底层创新</p>
<p>强大的数据飞轮背后，是一支由如视副总裁、首席科学家潘慈辉博士带领的研发团队。据潘博士介绍，如视从创立之初就坚持应用导向的底层技术创新，平均每年的研发投入都在 2 亿人民币以上。这份坚决的技术投入，造就了如视的技术实力和底气。</p>
<p>持续的耕耘也为如视带来了国际上的权威认可。在学术上，如视团队的科研成果近年来多次入选 ICCV、CVPR 等国际顶会；在产品设计上，旗下的伽罗华 3D 激光扫描仪、REALSEE G1 手机云台和庞加莱手持实景扫描仪接连斩获 2021、2022 及 2023 年德国红点产品设计大奖。如今，这些技术和产品已服务于 9 大行业超过 3000+ 品牌客户，团队也已积累了 600 余项国内外授权专利。</p>
<p>正是这个由海量高质数据、软硬一体化和持续研发投入共同驱动的飞轮，为 Argus 1.0 的诞生奠定了基础。</p>
<p>Argus 1.0</p>
<p>从「单眼」到「百眼」的空间智能突破</p>
<p>如视算法团队喜欢用希腊神话人物为产品命名。潘慈辉在采访中分享道，单目图像深度估计算法 Cyclops（希腊神话中的独眼巨人），寓意着从单张图像、单一视角就能推测世界的深度。</p>
<p>而此次发布的 Argus 1.0，名称则源自希腊神话中的「百眼巨人」。这一命名极富象征意义，它预示着如视的重建技术正从「单视」推测跨越到「多视」全局一致性的新阶段。</p>
<p>具体技术上，Argus 1.0 基于 Transformer 架构构建，是一个前馈式神经网络模型。该模型基于如视累积的 近百万套真实高清空间数据（包含对玻璃、镜面等难题的处理）进行训练。得益于 Transformer 架构的通用性及其与大规模 3D 数据训练的协同效应，Argus 1.0 实现了兼容性、实时性与生成质量三大维度的行业突破。</p>
<p>兼容性：业界首个支持全景图输入的推测大模型</p>
<p>首先是输入端的巨大突破。Argus 1.0 是目前业界已知首个、也是唯一一个支持全景图作为输入的深度推测大模型。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa0a5c3438024c0283c9e8fb1e32588e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=Cm5lJbKyOnhwqZ80z7KYMwqIfnA%3D" alt="图片" loading="lazy"/></p>
<p>Argus 1.0 甚至可以将 AI 生成的全景图转换成点云</p>
<p>同时，它还广泛兼容单张 / 多张普通照片乃至 AI 生成的图片，具备极强的多源适应能力。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b494b135316843ea970629cf876cd082~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=OEEgCUag%2FS3E5ptRMD6r9Toy%2Fl0%3D" alt="图片" loading="lazy"/></p>
<p>Argus 1.0 也支持普通图转点云</p>
<p>全景图推测深度的能力之所以重要，在于它直指 VR 内容生产的核心痛点。潘慈辉表示，Argus 1.0 能够「显著降低搭建全景图到 VR 的处理流程的门槛，极大提高处理效率」，让低成本、高效率的 3D 空间复刻成为可能。</p>
<p>实时性与一致性：毫秒级的全局重建</p>
<p>如果说 Cyclops 时代还是两步走，即先用算法推测单张全景图的深度，再通过额外的算法模块计算位姿、进行拼接；那么 Argus 1.0 则实现了一步到位。</p>
<p>潘慈辉向我们揭示了 Argus 1.0 的核心架构创新：「此次 Argus 的能力，是将之前 Cyclops 的深度推测能力和后续的位姿计算能力，融合到了一个算法模块中。」</p>
<p>通过将深度推测和位姿计算进行联合训练，模型得以更好地挖掘多视图之间的关联性，从而在全局尺度上实现更高的点云一致性和位姿精度。这一增量式到全局式的转变，带来了效率的质变。如视的官方报告显示，Argus 1.0 的推理效率达到毫秒级，是首个实时的全景图全局重建系统，真正实现了「全流程无感知响应」。</p>
<p>高质量：源自真实数据的稳健性</p>
<p>Argus 1.0 的高生成质量，则要归功于前文提到的如视独有的高精度、带尺度、像素级对齐的真实数据库。</p>
<p>在 3D 重建领域，玻璃、镜面、毛坯房、长走廊等场景一直是行业公认的难题。潘慈辉指出，其根源在于「一般的激光设备对玻璃镜子的测距能力不足，导致大家在学习过程中没有较好的监督数据」。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/901c5a4008c2417e81c08d2426dec0b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=IGpFM8pJHtM8pG10WFSlCDsszTo%3D" alt="图片" loading="lazy"/></p>
<p>而如视的解决方案是其多年技术的自然结果：「我们的业务场景中会有专门的工具对玻璃镜子进行标注，根据这些标注，我们修正原始的有问题的激光点云。使用修正后的激光数据进行训练就能很好地解决这一难题。」</p>
<p>正是得益于海量、多样化且经过精细业务标注的养料，Argus 1.0 充分学习并掌握了这些困难场景的特征，使其在面对传统重建难题时依然表现稳定，生成的 3D 空间显著优于其他缺乏真实尺度和对齐能力的方案。</p>
<p>如视的版图</p>
<p>空间智能「四层理论」与 AIGC 终局</p>
<p>Argus 1.0 的发布，不仅是一款工具的升级，更是如视「空间智能」版图中的一块关键拼图。潘慈辉在采访中详细阐述了团队的研发脉络：一个结合自身实践总结出的「空间智能四层理论」。</p>
<p>这四层理论清晰地定义了从数字化到智能化的演进路径：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/117dc37d092b46afb2799668a536cbf8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=0kkbBUd%2FWtd6tH9gXwTx4ponM5o%3D" alt="图片" loading="lazy"/></p>
<ol>
<li>
<p>第一层：物理数据（重建）：即 1:1 复刻；</p>
</li>
<li>
<p>第二层：潜藏数据（感知推理）：理解空间结构、语义；</p>
</li>
<li>
<p>第三层：融合数据（业务）：结合 CAD、IoT 等业务数据；</p>
</li>
<li>
<p>第四层：AIGC（生成交互）：解决开集问题，实现泛化交互。</p>
</li>
</ol>
<p>在这个框架下，Argus 1.0 是第一层（重建）的集大成者。它打通的 2D 到 3D 能力已经可以赋能诸多应用场景。例如，它可以用于生成时下流行的动态锁屏空间壁纸；潘慈辉在采访中提到：「Argus 模型推测的深度精度更高，分辨率更高，且深度带有绝对尺度信息」，效果优于苹果披露使用的深度推测算法。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/645e0493659040539e81c8c761979f9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=cmIi4uze%2FGdA9UnJepqiQENkCrw%3D" alt="图片" loading="lazy"/></p>
<p>更进一步，如视透露，预计于明年初发布的 Argus 2.0 及后续版本可进一步用于实时渲染的 3DGS 模型和精细 Mesh 模型，为空间漫游提供沉浸式数字基底。通过与如视自研的空间智能算法结合，它还能驱动空间 CAD 自动生成、高精度语义分割及白模构建等高阶应用，实现从物理世界到数字空间，再赋能现实应用的闭环。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6789159b47d9468094b378751b5a23db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764149731&amp;x-signature=sGOAqeE3ROf9dyK9XKIulD4g6Wg%3D" alt="图片" loading="lazy"/></p>
<p>潘慈辉也明确指出，团队的下一个重点难题，正是攻克第四层：AIGC 层。他认为，许多应用的答案不在空间本身，而在于链接「空间之外的信息」，如行业规范、人类偏好等。他总结道：「我们希望当 AIGC 这一层实现后，利用其空间之外的信息能力，我们能更加快速、低成本地对接更多的行业，输出解决方案。」</p>
<p>开放生态</p>
<p>为空间智能行业铺路</p>
<p>在实现自身技术闭环的同时，如视也发挥自身优势，为整个空间智能行业的基础设施「铺路」。</p>
<p>长期以来，空间智能领域的研究与应用面临着一个瓶颈问题：空间智能的「基石」—— 高质量的空间数据，存在巨大缺口。而如视一直以来的技术成果，恰好为解决这一问题打开了一扇窗。</p>
<p>因此，为了加速整个空间智能应用领域的研究演进，如视计划于今年年底开放 10000 套的室内房屋数据集（其中 1000 套新房数据、9000 套 AI 设计数据），这同时也是目前最大规模的空间三维数据集。这种开放生态，让更多人能站在如视积累的真实数据之上进行创新，从而整个行业的发展。</p>
<p>迈向空间智能的 AIGC 终局</p>
<p>从最初服务于房产交易的 VR 看房，到如今赋能九大行业的空间智能；从打磨软硬一体的采集闭环，到发布毫秒级的深度推测大模型 Argus，如视的路径清晰地展现了其「数字空间 - 算法 - 行业应用」飞轮的强大势能。</p>
<p>Argus 1.0 的发布，不仅是如视的飞轮势能的一次集中爆发，它也是一个空间信息解码器，为 3D 视觉领域带来了一个低门槛、高效率、高质量的基础工具。它向行业证明了一条核心路径：海量、高精度、高一致性的真实世界数据是训练空间基础大模型的决定性优势。</p>
<p>这标志着空间智能领域一个新纪元的开始：以真实数据为基石，从底层重建走向顶层 AIGC 应用的路径被正式打通。</p>
<p>随着如视这样的空间数据巨头不断推动技术演进和生态开放，一个万物可计算、虚实深度融合的未来，正加速向我们走来。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[抓包技术全面指南：原理、工具与应用场景]]></title>    <link>https://juejin.cn/post/7574105194167828526</link>    <guid>https://juejin.cn/post/7574105194167828526</guid>    <pubDate>2025-11-19T09:40:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574105194167828526" data-draft-id="7574217823105630259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="抓包技术全面指南：原理、工具与应用场景"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T09:40:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aiopencode"/> <meta itemprop="url" content="https://juejin.cn/user/1898230261493865"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            抓包技术全面指南：原理、工具与应用场景
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1898230261493865/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aiopencode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:40:30.000Z" title="Wed Nov 19 2025 09:40:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>抓包技术详解：网络通信的幕后英雄</p>
<p>抓包的定义</p>
<p>抓包，简单来说，就是网络抓包。它是一种在网络通信过程中捕获和分析数据包的技术。通过抓包，我们可以了解网络通信的细节，包括数据的来源、去向以及传输内容等。</p>
<p>抓包的基本原理</p>
<p>网络数据以数据包的形式传输。抓包利用网卡的混杂模式，让网卡能够接收所有流经的数据包，而不仅仅是发送给它的。然后通过抓包工具解析、分析这些数据包，将它们以可读的形式呈现出来。</p>
<p>抓包工具</p>
<p>Wireshark：这是一款开源且跨平台的抓包工具，具有强大的协议解析能力。它可以通过图形化界面查看数据包的详细信息，还能过滤和统计，非常便于分析。</p>
<p>tcpdump：主要用于Linux系统，通过命令行进行抓包。它可以通过灵活的命令指定抓包条件，将结果输出到终端或文件。</p>
<p>Fiddler：这款工具主要针对HTTP和HTTPS协议，在Web开发和测试中非常有用。它可以作为代理服务器拦截、查看并修改HTTP通信内容。</p>
<p>Sniffmaster：作为一款全平台抓包工具，Sniffmaster 支持 HTTPS、TCP 和 UDP 协议，可在 iOS、Android、Mac 和 Windows 设备上实现无需代理、越狱或 root 的抓包操作。它提供 HTTPS 暴力抓包、数据流抓包和代理抓包等功能，非常适合移动应用开发和网络调试。</p>
<p>应用场景</p>
<p>网络故障排查：当网络出现访问异常、延迟高或数据错误等问题时，抓包可以帮助我们获取通信信息，定位是网络设备、服务器还是客户端的故障。</p>
<p>网络安全检测：通过分析数据包，可以检测恶意攻击和数据泄露等安全威胁，保障网络安全。</p>
<p>网络性能优化：抓包可以帮助我们分析带宽使用、传输延迟和丢包率等，找到性能瓶颈，以便优化网络配置和应用程序代码。</p>
<p>协议分析与研究：对于研究人员来说，抓包可以让他们了解协议的运行机制，验证协议的正确性，为协议改进和创新提供依据。</p>
<p>希望这篇文章能帮助大家更好地理解抓包技术，下次再遇到网络问题时，不妨试试抓包工具，或许能帮你快速定位问题所在！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【Amis源码阅读】低代码如何实现交互？（上）]]></title>    <link>https://juejin.cn/post/7574245883635204148</link>    <guid>https://juejin.cn/post/7574245883635204148</guid>    <pubDate>2025-11-19T09:40:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574245883635204148" data-draft-id="7574245788948856847" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【Amis源码阅读】低代码如何实现交互？（上）"/> <meta itemprop="keywords" content="前端,低代码"/> <meta itemprop="datePublished" content="2025-11-19T09:40:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="云鹤_"/> <meta itemprop="url" content="https://juejin.cn/user/2647279733054638"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【Amis源码阅读】低代码如何实现交互？（上）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2647279733054638/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    云鹤_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:40:34.000Z" title="Wed Nov 19 2025 09:40:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>基于 6.13.0 版本</p>
</blockquote>
<p><strong>前期回顾</strong></p>
<ol>
<li><a href="https://juejin.cn/post/7559794761037545513" target="_blank" title="https://juejin.cn/post/7559794761037545513">【Amis源码阅读】组件注册方法远比预想的多！</a></li>
<li><a href="https://juejin.cn/post/7561753990247694388" target="_blank" title="https://juejin.cn/post/7561753990247694388">【Amis源码阅读】如何将json配置渲染成页面？</a></li>
</ol>
<h2 data-id="heading-0">前言</h2>
<ul>
<li>组件渲染搞定了，那组件如何进行交互呢？<code>amis</code>提出了<strong>事件动作</strong>的概念，在监听到事件后通过动作做出反应
<ul>
<li>事件：
<ul>
<li>渲染器事件：组件内部执行的事件，会暴露给外部监听。比如初始化、点击、值变化等事件</li>
<li>广播事件：全局事件，其他组件可在自身监听相关广播事件</li>
</ul>
</li>
<li>动作：监听到事件时，希望执行的逻辑。比如打开弹窗、<code>toast</code>提示、刷新接口等</li>
</ul>
</li>
<li>本篇先聊事件的工作逻辑，从常用的渲染器事件入手（渲染器等同组件）</li>
</ul>
<h2 data-id="heading-1">渲染器事件</h2>
<h3 data-id="heading-2">onEvent事件监听</h3>
<ul>
<li><code>amis</code>支持<code>onEvent</code>的形式监听组件事件的触发时机，比如组件被点击时触发一个<code>toast</code>。那写入<code>onEvent</code>中的动作是何时何地被执行的呢？</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx">{
  <span class="hljs-string">"onEvent"</span>: {
    <span class="hljs-string">"click"</span>: {
      <span class="hljs-string">"actions"</span>: [ 
        {
          <span class="hljs-string">"actionType"</span>: <span class="hljs-string">"toast"</span>,
          <span class="hljs-string">"args"</span>: {
            <span class="hljs-string">"msgType"</span>: <span class="hljs-string">"success"</span>,
            <span class="hljs-string">"msg"</span>: <span class="hljs-string">"点击成功"</span>
          }
        }
      ]
    }
  }
}
</code></pre>
<h3 data-id="heading-3">组件中的事件触发</h3>
<ul>
<li>以常见的<code>Page</code>组件中<code>init</code>（初始化）事件为例，它实际就是在类组件的<code>componentDidMount</code>生命周期（挂载阶段）中触发了一次，<code>dispatchEvent</code>就是事件的入口了</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis/src/renderers/Page.tsx</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Page</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&lt;<span class="hljs-title class_">PageProps</span>&gt; {
	...
	
	<span class="hljs-keyword">async</span> <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> {
      initApi,
      initFetch,
      initFetchOn,
      store,
      messages,
      data,
      dispatchEvent,
      env
    } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mounted</span> = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">const</span> rendererEvent = <span class="hljs-keyword">await</span> <span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-string">'init'</span>, data, <span class="hljs-variable language_">this</span>);
		...
  }
}
</code></pre>
<ul>
<li>再以<code>Tpl</code>组件中的<code>click</code>（点击）、<code>mouseenter</code>（鼠标移入）、<code>mouseleave</code>（鼠标移出）事件为例，可以直观的看出他们就是在组件绑定的<code>onClick</code>、<code>onMouseEnter</code>、<code>onMouseLeave</code>事件中执行了一遍<code>dispatchEvent</code></li>
<li>此时可以推测出，<code>onEvent</code>应该是在<code>dispatchEvent</code>中被执行了</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis/src/renderers/Tpl.tsx</span>

<span class="hljs-keyword">export</span> interface <span class="hljs-title class_">TplSchema</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseSchema</span> {
	...
	
	@autobind
  <span class="hljs-title function_">handleClick</span>(<span class="hljs-params">e: React.MouseEvent&lt;HTMLDivElement&gt;</span>) {
    <span class="hljs-keyword">const</span> {dispatchEvent, data} = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>;
    <span class="hljs-title function_">dispatchEvent</span>(e, data);
  }
  
  @autobind
  <span class="hljs-title function_">handleMouseEnter</span>(<span class="hljs-params">e: React.MouseEvent&lt;any&gt;</span>) {
    <span class="hljs-keyword">const</span> {dispatchEvent, data} = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>;
    <span class="hljs-title function_">dispatchEvent</span>(e, data);
  }

  @autobind
  <span class="hljs-title function_">handleMouseLeave</span>(<span class="hljs-params">e: React.MouseEvent&lt;any&gt;</span>) {
    <span class="hljs-keyword">const</span> {dispatchEvent, data} = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>;
    <span class="hljs-title function_">dispatchEvent</span>(e, data);
  }
  
  <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
	  <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span>
	      <span class="hljs-attr">...</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleClick}</span>
        <span class="hljs-attr">onMouseEnter</span>=<span class="hljs-string">{this.handleMouseEnter}</span>
        <span class="hljs-attr">onMouseLeave</span>=<span class="hljs-string">{this.handleMouseLeave}</span>
        {<span class="hljs-attr">...testIdBuilder</span>?<span class="hljs-attr">.getChild</span>('<span class="hljs-attr">tpl</span>')?<span class="hljs-attr">.getTestId</span>()}
      &gt;</span>
        ...
      <span class="hljs-tag">&lt;/<span class="hljs-name">Component</span>&gt;</span></span>
    );
  }
}
</code></pre>
<h3 data-id="heading-4">工作流</h3>
<h4 data-id="heading-5">触发事件（dispatchEvent）</h4>
<ul>
<li><code>broadcast</code>参数可忽略，没用（<code>factory.tsx</code>中的类型定义也说明了这点）</li>
<li><code>rendererEventListeners</code>是个全局变量（事件队列），所有的事件监听器都存储在这</li>
<li><code>dispatchEvent</code>流程
<ul>
<li><code>bindEvent</code>绑定事件，返回<code>unbindEvent</code>销毁函数</li>
<li><code>createRendererEvent</code>创建事件对象</li>
<li>事件队列里的事件按权重排序确定执行优先级</li>
<li>遍历事件队列，若有事件有<code>debounce</code>属性，就设置防抖，同时设置<code>executing</code>为真；若没有就直接执行事件（<code>runAction</code>）</li>
<li>遍历事件队列的时候会通过<code>checkExecuted</code>函数计数，当遍历完毕后（也就意味着事件都执行完毕了，会等待防抖的事件执行完），执行<code>unbindEvent</code>销毁事件</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis-core/src/utils/renderer-event.ts</span>

<span class="hljs-keyword">let</span> <span class="hljs-attr">rendererEventListeners</span>: <span class="hljs-title class_">RendererEventListener</span>[] = [];
...

<span class="hljs-comment">// 触发事件</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-params">
  e: string | React.MouseEvent&lt;any&gt;,
  renderer: React.Component&lt;RendererProps&gt;,
  scoped: IScopedContext,
  data: any,
  broadcast?: RendererEvent&lt;any&gt;
</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">RendererEvent</span>&lt;any&gt; | <span class="hljs-keyword">void</span>&gt; {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">unbindEvent</span>: (<span class="hljs-function">(<span class="hljs-params">eventName?: string</span>) =&gt;</span> <span class="hljs-keyword">void</span>) | <span class="hljs-literal">null</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">const</span> eventName = <span class="hljs-keyword">typeof</span> e === <span class="hljs-string">'string'</span> ? e : e.<span class="hljs-property">type</span>;

  <span class="hljs-keyword">const</span> <span class="hljs-keyword">from</span> = renderer?.<span class="hljs-property">props</span>.<span class="hljs-property">id</span> || renderer?.<span class="hljs-property">props</span>.<span class="hljs-property">name</span> || <span class="hljs-string">''</span>;
	...

  broadcast &amp;&amp; renderer.<span class="hljs-property">props</span>.<span class="hljs-property">onBroadcast</span>?.(e <span class="hljs-keyword">as</span> string, broadcast, data);

  <span class="hljs-keyword">if</span> (!broadcast) {
    <span class="hljs-keyword">const</span> eventConfig = renderer?.<span class="hljs-property">props</span>?.<span class="hljs-property">onEvent</span>?.[eventName];

    <span class="hljs-keyword">if</span> (!eventConfig) {
      <span class="hljs-comment">// 没命中也没关系</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();
    }

    unbindEvent = <span class="hljs-title function_">bindEvent</span>(renderer);
  }
  <span class="hljs-comment">// 没有可处理的监听</span>
  <span class="hljs-keyword">if</span> (!rendererEventListeners.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();
  }
  <span class="hljs-comment">// 如果是广播动作，就直接复用</span>
  <span class="hljs-keyword">const</span> rendererEvent =
    broadcast ||
    <span class="hljs-title function_">createRendererEvent</span>(eventName, {
      <span class="hljs-attr">env</span>: renderer?.<span class="hljs-property">props</span>?.<span class="hljs-property">env</span>,
      <span class="hljs-attr">nativeEvent</span>: e,
      data,
      scoped
    });

  <span class="hljs-comment">// 过滤&amp;排序</span>
  <span class="hljs-keyword">const</span> listeners = rendererEventListeners
    .<span class="hljs-title function_">filter</span>(
      <span class="hljs-function">(<span class="hljs-params">item: RendererEventListener</span>) =&gt;</span>
        item.<span class="hljs-property">type</span> === eventName &amp;&amp;
        (broadcast
          ? <span class="hljs-literal">true</span>
          : item.<span class="hljs-property">renderer</span> === renderer &amp;&amp;
            item.<span class="hljs-property">actions</span> === renderer.<span class="hljs-property">props</span>?.<span class="hljs-property">onEvent</span>?.[eventName].<span class="hljs-property">actions</span>)
    )
    .<span class="hljs-title function_">sort</span>(
      <span class="hljs-function">(<span class="hljs-params">prev: RendererEventListener, next: RendererEventListener</span>) =&gt;</span>
        next.<span class="hljs-property">weight</span> - prev.<span class="hljs-property">weight</span>
    );
  <span class="hljs-keyword">let</span> executedCount = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">checkExecuted</span> = (<span class="hljs-params"/>) =&gt; {
    executedCount++;
    <span class="hljs-keyword">if</span> (executedCount === listeners.<span class="hljs-property">length</span>) {
      unbindEvent?.(eventName);
    }
  };
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> listener <span class="hljs-keyword">of</span> listeners) {
    <span class="hljs-keyword">const</span> {
      wait = <span class="hljs-number">100</span>,
      trailing = <span class="hljs-literal">true</span>,
      leading = <span class="hljs-literal">false</span>,
      maxWait = <span class="hljs-number">10000</span>
    } = listener?.<span class="hljs-property">debounce</span> || {};
    <span class="hljs-keyword">if</span> (listener?.<span class="hljs-property">debounce</span>) {
      <span class="hljs-keyword">const</span> debounced = <span class="hljs-title function_">debounce</span>(
        <span class="hljs-keyword">async</span> () =&gt; {
          <span class="hljs-keyword">await</span> <span class="hljs-title function_">runActions</span>(listener.<span class="hljs-property">actions</span>, listener.<span class="hljs-property">renderer</span>, rendererEvent);
          <span class="hljs-title function_">checkExecuted</span>();
        },
        wait,
        {
          trailing,
          leading,
          maxWait
        }
      );
      rendererEventListeners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
        <span class="hljs-comment">// 找到事件队列中正在执行的事件加上标识，下次待执行队列就会把这个事件过滤掉</span>
        <span class="hljs-keyword">if</span> (
          item.<span class="hljs-property">renderer</span> === listener.<span class="hljs-property">renderer</span> &amp;&amp;
          listener.<span class="hljs-property">type</span> === item.<span class="hljs-property">type</span>
        ) {
          item.<span class="hljs-property">executing</span> = <span class="hljs-literal">true</span>;
          item.<span class="hljs-property">debounceInstance</span> = debounced;
        }
      });
      <span class="hljs-title function_">debounced</span>();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-title function_">runActions</span>(listener.<span class="hljs-property">actions</span>, listener.<span class="hljs-property">renderer</span>, rendererEvent);
      <span class="hljs-title function_">checkExecuted</span>();
    }

    <span class="hljs-keyword">if</span> (listener?.<span class="hljs-property">track</span>) {
      <span class="hljs-keyword">const</span> {<span class="hljs-attr">id</span>: trackId, <span class="hljs-attr">name</span>: trackName} = listener.<span class="hljs-property">track</span>;
      renderer?.<span class="hljs-property">props</span>?.<span class="hljs-property">env</span>?.<span class="hljs-title function_">tracker</span>({
        <span class="hljs-attr">eventType</span>: listener.<span class="hljs-property">type</span>,
        <span class="hljs-attr">eventData</span>: {
          trackId,
          trackName
        }
      });
    }

    <span class="hljs-comment">// 停止后续监听器执行</span>
    <span class="hljs-keyword">if</span> (rendererEvent.<span class="hljs-property">stoped</span>) {
      <span class="hljs-keyword">break</span>;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(rendererEvent);
}
</code></pre>
<h4 data-id="heading-6">绑定事件（bindEvent）</h4>
<ul>
<li>所谓绑定事件就是把事件推入事件队列</li>
<li>首先会遍历<code>onEvent</code>中的内容</li>
<li>然后处理防抖场景：如果存在<strong>相同的事件且在防抖时间内（<code>executing</code>为真）</strong>，则取消旧事件防抖并移除旧事件，把新事件加入事件队列。比如说，事件队列中存有用户触发了3次的事件<code>a</code>（假设都在防抖时间内），则前2次事件在<code>bindEvent</code>阶段会被删除，只保留第3次事件</li>
<li>如果不存在上述情况，直接加入事件队列</li>
<li>最终都是返回解绑事件的函数（从事件队列中移除）</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis-core/src/utils/renderer-event.ts</span>

<span class="hljs-comment">// 绑定事件</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">bindEvent</span> = (<span class="hljs-params">renderer: any</span>) =&gt; {
  <span class="hljs-keyword">if</span> (!renderer) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
  }
  <span class="hljs-keyword">const</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">EventListeners</span> = renderer.<span class="hljs-property">props</span>.<span class="hljs-property">$schema</span>.<span class="hljs-property">onEvent</span>;
  <span class="hljs-keyword">if</span> (listeners) {
    <span class="hljs-comment">// 暂存</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(listeners)) {
      <span class="hljs-keyword">const</span> listener = rendererEventListeners.<span class="hljs-title function_">find</span>(
        <span class="hljs-function">(<span class="hljs-params">item: RendererEventListener</span>) =&gt;</span>
          item.<span class="hljs-property">renderer</span> === renderer &amp;&amp;
          item.<span class="hljs-property">type</span> === key &amp;&amp;
          item.<span class="hljs-property">actions</span> === listeners[key].<span class="hljs-property">actions</span>
      );
	    <span class="hljs-comment">// 存在相同的事件且在防抖时间内</span>
      <span class="hljs-keyword">if</span> (listener?.<span class="hljs-property">executing</span>) {
        listener?.<span class="hljs-property">debounceInstance</span>?.<span class="hljs-property">cancel</span>?.();
        rendererEventListeners = rendererEventListeners.<span class="hljs-title function_">filter</span>(
          <span class="hljs-function">(<span class="hljs-params">item: RendererEventListener</span>) =&gt;</span>
            !(
              item.<span class="hljs-property">renderer</span> === listener.<span class="hljs-property">renderer</span> &amp;&amp; item.<span class="hljs-property">type</span> === listener.<span class="hljs-property">type</span>
            )
        );
        listener.<span class="hljs-property">actions</span>.<span class="hljs-property">length</span> &amp;&amp;
          rendererEventListeners.<span class="hljs-title function_">push</span>({
            renderer,
            <span class="hljs-attr">type</span>: key,
            <span class="hljs-attr">debounce</span>: listener.<span class="hljs-property">debounce</span> || <span class="hljs-literal">null</span>,
            <span class="hljs-attr">track</span>: listeners[key].<span class="hljs-property">track</span> || <span class="hljs-literal">null</span>,
            <span class="hljs-attr">weight</span>: listener.<span class="hljs-property">weight</span> || <span class="hljs-number">0</span>,
            <span class="hljs-attr">actions</span>: listener.<span class="hljs-property">actions</span>
          });
      }
      <span class="hljs-keyword">if</span> (!listener &amp;&amp; listeners[key].<span class="hljs-property">actions</span>?.<span class="hljs-property">length</span>) {
        rendererEventListeners.<span class="hljs-title function_">push</span>({
          renderer,
          <span class="hljs-attr">type</span>: key,
          <span class="hljs-attr">debounce</span>: listeners[key].<span class="hljs-property">debounce</span> || <span class="hljs-literal">null</span>,
          <span class="hljs-attr">track</span>: listeners[key].<span class="hljs-property">track</span> || <span class="hljs-literal">null</span>,
          <span class="hljs-attr">weight</span>: listeners[key].<span class="hljs-property">weight</span> || <span class="hljs-number">0</span>,
          <span class="hljs-attr">actions</span>: listeners[key].<span class="hljs-property">actions</span>
        });
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">eventName?: string</span>) =&gt;</span> {
      <span class="hljs-comment">// eventName用来避免过滤广播事件</span>
      rendererEventListeners = rendererEventListeners.<span class="hljs-title function_">filter</span>(
        <span class="hljs-function">(<span class="hljs-params">item: RendererEventListener</span>) =&gt;</span>
          <span class="hljs-comment">// 如果 eventName 为 undefined，表示全部解绑，否则解绑指定事件</span>
          eventName === <span class="hljs-literal">undefined</span>
            ? item.<span class="hljs-property">renderer</span> !== renderer
            : item.<span class="hljs-property">renderer</span> !== renderer || item.<span class="hljs-property">type</span> !== eventName
      );
    };
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
};
</code></pre>
<h4 data-id="heading-7">执行动作（runActions）</h4>
<ul>
<li>这里只是一个执行动作的前置处理</li>
<li>遍历动作，通过<code>getActionByType</code>查找动作实例，若没有则判断是否是组件专有动作（组件都有可调用），若再没有则判断是否是打开页面相关的动作，若还是没有则直接调用组件自定义的动作</li>
<li>实际的动作执行还是在<code>runAction</code>中，等下一篇再完整的分析动作相关流程</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis-core/src/actions/Action.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">runActions</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">
  actions: ListenerAction | ListenerAction[],
  renderer: ListenerContext,
  event: any
</span>) =&gt; {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(actions)) {
    actions = [actions];
  }

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> actionConfig <span class="hljs-keyword">of</span> actions) {
    <span class="hljs-keyword">let</span> actionInstrance = <span class="hljs-title function_">getActionByType</span>(actionConfig.<span class="hljs-property">actionType</span>);

    <span class="hljs-comment">// 如果存在指定组件ID，说明是组件专有动作</span>
    <span class="hljs-keyword">if</span> (
      !actionInstrance &amp;&amp;
      (actionConfig.<span class="hljs-property">componentId</span> || actionConfig.<span class="hljs-property">componentName</span>)
    ) {
      actionInstrance = [
        <span class="hljs-string">'static'</span>,
        <span class="hljs-string">'nonstatic'</span>,
        <span class="hljs-string">'show'</span>,
        <span class="hljs-string">'visibility'</span>,
        <span class="hljs-string">'hidden'</span>,
        <span class="hljs-string">'enabled'</span>,
        <span class="hljs-string">'disabled'</span>,
        <span class="hljs-string">'usability'</span>
      ].<span class="hljs-title function_">includes</span>(actionConfig.<span class="hljs-property">actionType</span>)
        ? <span class="hljs-title function_">getActionByType</span>(<span class="hljs-string">'status'</span>)
        : <span class="hljs-title function_">getActionByType</span>(<span class="hljs-string">'component'</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ([<span class="hljs-string">'url'</span>, <span class="hljs-string">'link'</span>, <span class="hljs-string">'jump'</span>].<span class="hljs-title function_">includes</span>(actionConfig.<span class="hljs-property">actionType</span>)) {
      <span class="hljs-comment">// 打开页面动作</span>
      actionInstrance = <span class="hljs-title function_">getActionByType</span>(<span class="hljs-string">'openlink'</span>);
    }

    <span class="hljs-comment">// 找不到就通过组件专有动作完成</span>
    <span class="hljs-keyword">if</span> (!actionInstrance) {
      actionInstrance = <span class="hljs-title function_">getActionByType</span>(<span class="hljs-string">'component'</span>);
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// 这些节点的子节点运行逻辑由节点内部实现</span>
      <span class="hljs-keyword">await</span> <span class="hljs-title function_">runAction</span>(actionInstrance, actionConfig, renderer, event);
    } <span class="hljs-keyword">catch</span> (e) {
      ...
    }

    <span class="hljs-keyword">if</span> (event.<span class="hljs-property">stoped</span>) {
      <span class="hljs-keyword">break</span>;
    }
  }
};
</code></pre>
<h3 data-id="heading-8">设计特性</h3>
<h4 data-id="heading-9">全局事件管理</h4>
<ul>
<li>通过<code>rendererEventListeners</code>队列统一管理，和<code>react</code>的事件委托有点类似</li>
<li>支持跨组件通信</li>
<li>支持全局权重排序、防抖</li>
</ul>
<h4 data-id="heading-10">延迟绑定，执行完销毁</h4>
<ul>
<li>事件都是触发后，在<code>bindEvent</code>中绑定的（加入事件队列），<strong>减少内存占用</strong></li>
<li>然后执行完毕会立即销毁，<strong>避免内存泄漏</strong></li>
</ul>
<h2 data-id="heading-11">广播事件</h2>
<ul>
<li>独立于渲染器事件的全局事件，基于<code>BroadcastChannel</code>类实现</li>
</ul>
<h3 data-id="heading-12">工作流</h3>
<ul>
<li>由于是全局事件，肯定得优先绑定了</li>
</ul>
<h4 data-id="heading-13">绑定事件入口</h4>
<ul>
<li>组件渲染（渲染流程可参考之前的组件渲染篇）时绑定</li>
<li>组件生成时都会传入<code>childRef</code>，直接在组件的<code>ref</code>上通过<code>bindGlobalEvent</code>绑定了广播事件</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis-core/src/SchemaRenderer.tsx</span>

<span class="hljs-keyword">import</span> {
  bindEvent,
  bindGlobalEventForRenderer <span class="hljs-keyword">as</span> bindGlobalEvent
} <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils/renderer-event'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SchemaRenderer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&lt;<span class="hljs-title class_">SchemaRendererProps</span>, any&gt; {
	...
	@autobind
  <span class="hljs-title function_">childRef</span>(<span class="hljs-params">ref: any</span>) {
    ...
    <span class="hljs-keyword">while</span> (ref?.<span class="hljs-property">getWrappedInstance</span>?.()) {
      ref = ref.<span class="hljs-title function_">getWrappedInstance</span>();
    }

    ...

    <span class="hljs-keyword">if</span> (ref) {
      <span class="hljs-comment">// 这里无法区分监听的是不是广播，所以又bind一下，主要是为了绑广播</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">unbindEvent</span>?.();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">unbindGlobalEvent</span>?.();

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">unbindEvent</span> = <span class="hljs-title function_">bindEvent</span>(ref);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">unbindGlobalEvent</span> = <span class="hljs-title function_">bindGlobalEvent</span>(ref);
    }
    ...
  }
  
  <span class="hljs-title function_">render</span>(): <span class="hljs-variable constant_">JSX</span>.<span class="hljs-property">Element</span> | <span class="hljs-literal">null</span> {
		...

    <span class="hljs-keyword">let</span> component = supportRef ? (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span> {<span class="hljs-attr">...props</span>} <span class="hljs-attr">ref</span>=<span class="hljs-string">{this.childRef}</span> <span class="hljs-attr">storeRef</span>=<span class="hljs-string">{this.storeRef}</span> /&gt;</span></span>
    ) : (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span>
        {<span class="hljs-attr">...props</span>}
        <span class="hljs-attr">forwardedRef</span>=<span class="hljs-string">{this.childRef}</span>
        <span class="hljs-attr">storeRef</span>=<span class="hljs-string">{this.storeRef}</span>
      /&gt;</span></span>
    );

    ...

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">env</span>.<span class="hljs-property">enableAMISDebug</span> ? (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DebugWrapper</span> <span class="hljs-attr">renderer</span>=<span class="hljs-string">{renderer}</span>&gt;</span>{component}<span class="hljs-tag">&lt;/<span class="hljs-name">DebugWrapper</span>&gt;</span></span>
    ) : (
      component
    );
  }
}
</code></pre>
<h4 data-id="heading-14">绑定事件（bindGlobalEventForRenderer）</h4>
<ul>
<li>这里并未区分广播事件</li>
<li>遍历事件，创建<code>BroadcastChannel</code>对象，推入<code>bcs</code>广播事件队列</li>
<li>挂载<code>onmessage</code>消息监听，接收到广播时通过<code>runActions</code>触发动作</li>
<li>最终返回一个注销广播实例的函数</li>
<li>小疑问：这里直接把<code>renderer.props.$schema.onEvent</code>中所有的动作都绑定了广播事件，虽然统一管理了广播事件的绑定，但是绑定了很多多余的动作，这里实际可以判断<code>actionType</code>为<code>broadcast</code>才绑定？</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis-core/src/utils/renderer-event.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">bindGlobalEventForRenderer</span> = (<span class="hljs-params">renderer: any</span>) =&gt; {
  ...
  <span class="hljs-keyword">const</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">EventListeners</span> = renderer.<span class="hljs-property">props</span>.<span class="hljs-property">$schema</span>.<span class="hljs-property">onEvent</span>;
  <span class="hljs-keyword">let</span> <span class="hljs-attr">bcs</span>: <span class="hljs-title class_">Array</span>&lt;{
    <span class="hljs-attr">renderer</span>: any;
    <span class="hljs-attr">bc</span>: <span class="hljs-title class_">BroadcastChannel</span>;
  }&gt; = [];
  <span class="hljs-keyword">if</span> (listeners) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(listeners)) {
      <span class="hljs-keyword">const</span> listener = listeners[key];
      ...
      <span class="hljs-keyword">const</span> bc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BroadcastChannel</span>(key);
      bcs.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">renderer</span>: renderer,
        bc
      });
      bc.<span class="hljs-property">onmessage</span> = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> { eventName, data } = e.<span class="hljs-property">data</span>;
        <span class="hljs-keyword">const</span> rendererEvent = <span class="hljs-title function_">createRendererEvent</span>(eventName, {
          <span class="hljs-attr">env</span>: renderer?.<span class="hljs-property">props</span>?.<span class="hljs-property">env</span>,
          <span class="hljs-attr">nativeEvent</span>: eventName,
          <span class="hljs-attr">scoped</span>: renderer?.<span class="hljs-property">context</span>,
          data
        });
        <span class="hljs-comment">// 过滤掉当前的广播事件，避免循环广播</span>
        <span class="hljs-keyword">const</span> actions = listener.<span class="hljs-property">actions</span>.<span class="hljs-title function_">filter</span>(
          <span class="hljs-function"><span class="hljs-params">a</span> =&gt;</span> !(a.<span class="hljs-property">actionType</span> === <span class="hljs-string">'broadcast'</span> &amp;&amp; a.<span class="hljs-property">eventName</span> === eventName)
        );

        <span class="hljs-title function_">runActions</span>(actions, renderer, rendererEvent);
      };
    }
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      bcs
        .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">renderer</span> === renderer)
        .<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">bc</span>.<span class="hljs-title function_">close</span>());
    };
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
};
</code></pre>
<h4 data-id="heading-15">触发事件（dispatchGlobalEventForRenderer）</h4>
<ul>
<li>广播动作<code>packages/amis-core/src/actions/BroadcastAction.ts</code>中调用了<code>dispatchGlobalEventForRenderer</code></li>
<li>代码较短，内部直接调用<code>dispatchGlobalEvent</code>方法，然后创建<code>BroadcastChannel</code>实例发送消息，然后关闭，齐活！</li>
<li>接收消息的地方就是上文<code>bindGlobalEventForRenderer</code>中挂载了<code>onmessage</code>事件的地方，不赘述</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis-core/src/utils/renderer-event.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">dispatchGlobalEventForRenderer</span>(<span class="hljs-params">
  eventName: string,
  renderer: React.Component&lt;RendererProps&gt;,
  scoped: IScopedContext,
  data: any,
  broadcast: RendererEvent&lt;any&gt;
</span>) {
  ...
  <span class="hljs-title function_">dispatchGlobalEvent</span>(eventName, data);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">dispatchGlobalEvent</span>(<span class="hljs-params">eventName: string, data: any</span>) {
  ...

  <span class="hljs-keyword">const</span> bc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BroadcastChannel</span>(eventName);
  bc.<span class="hljs-title function_">postMessage</span>({
    eventName,
    data
  });
  bc.<span class="hljs-title function_">close</span>();
}
</code></pre>
<h4 data-id="heading-16">解绑事件</h4>
<ul>
<li>广播事件是长期绑定的，只有在组件卸载时才解绑</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// packages/amis-core/src/SchemaRenderer.tsx</span>

<span class="hljs-keyword">import</span> {
  bindEvent,
  bindGlobalEventForRenderer <span class="hljs-keyword">as</span> bindGlobalEvent
} <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils/renderer-event'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SchemaRenderer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&lt;<span class="hljs-title class_">SchemaRendererProps</span>, any&gt; {
	...
	<span class="hljs-title function_">componentWillUnmount</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">unbindEvent</span>?.();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">unbindGlobalEvent</span>?.();
  }
	
}
</code></pre>
<h2 data-id="heading-17">总结</h2>
<ul>
<li><code>amis</code>的事件管理还是挺值得学习的</li>
<li>渲染器事件就是在组件的执行过程中开了个口子，支持插入想执行的逻辑</li>
<li>广播事件就是依赖<code>BroadcastChannel</code>的原生功能</li>
<li>下篇再写动作，脑子不够用了</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node+Express+MySQL 后端生产环境部署，实现注册功能(三)]]></title>    <link>https://juejin.cn/post/7574245788949004303</link>    <guid>https://juejin.cn/post/7574245788949004303</guid>    <pubDate>2025-11-19T09:47:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574245788949004303" data-draft-id="7573864324713021492" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node+Express+MySQL 后端生产环境部署，实现注册功能(三)"/> <meta itemprop="keywords" content="前端,后端"/> <meta itemprop="datePublished" content="2025-11-19T09:47:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="小胖霞"/> <meta itemprop="url" content="https://juejin.cn/user/3790771822016301"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node+Express+MySQL 后端生产环境部署，实现注册功能(三)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3790771822016301/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    小胖霞
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:47:36.000Z" title="Wed Nov 19 2025 09:47:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">一、部署前准备</h4>
<ul>
<li><strong>本地环境</strong>：MacOS（开发端）</li>
<li><strong>服务器环境</strong>：阿里云 Ubuntu 22.04 轻量应用服务器</li>
<li><strong>技术栈</strong>：Node.js + Express + MySQL</li>
<li><strong>核心目标</strong>：将本地开发完成的 Express 后端项目部署到阿里云，实现公网访问接口</li>
</ul>
<h4 data-id="heading-1">二、服务器环境配置（最终生效配置）</h4>
<h5 data-id="heading-2">1. 登录服务器</h5>
<p>通过 Mac 终端 SSH 连接服务器：</p>
<pre><code class="hljs language-bash" lang="bash">ssh root@你的服务器公网IP <span class="hljs-comment"># 例如：ssh root@47.101.129.155</span>
</code></pre>
<p>输入服务器登录密码即可进入。</p>
<h5 data-id="heading-3">2. 安装核心依赖软件</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 更新系统包</span>
sudo apt update &amp;&amp; sudo apt upgrade -y

<span class="hljs-comment"># 安装Node.js（v16+）</span>
curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash -
sudo apt install -y nodejs

<span class="hljs-comment"># 安装MySQL服务器</span>
sudo apt install -y mysql-server

<span class="hljs-comment"># 安装PM2（Node服务进程管理）</span>
sudo npm install pm2 -g

<span class="hljs-comment"># 安装Nginx（反向代理）</span>
sudo apt install -y nginx

</code></pre>
<h2 data-id="heading-4">创建本地数据库</h2>
<ol>
<li><strong>确保数据库已创建</strong>：用 MySQL Bench 连接本地 MySQL（root/admin123/3306），创建数据库 <code>mydb</code>（字符集 <code>utf8mb4</code>，排序规则 <code>utf8mb4_unicode_ci</code>）。</li>
</ol>
<h4 data-id="heading-5">三、创建用户表（存储注册信息）</h4>
<p>在 MySQL Bench 中，对 <code>mydb</code> 数据库执行以下 SQL，创建 <code>users</code> 表（用于存储注册用户）：</p>
<pre><code class="hljs language-sql" lang="sql">USE mydb; <span class="hljs-comment">-- 切换到 mydb 数据库</span>

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (
  id <span class="hljs-type">INT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY, <span class="hljs-comment">-- 自增主键</span>
  email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">UNIQUE</span>, <span class="hljs-comment">-- 邮箱（唯一，避免重复注册）</span>
  password <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- 加密后的密码（bcrypt 加密后长度固定60）</span>
  created_at DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>, <span class="hljs-comment">-- 注册时间</span>
  updated_at DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-comment">-- 更新时间</span>
);
</code></pre>
<h2 data-id="heading-6">四 新建项目</h2>
<p>创建文件夹node-api-test</p>
<ol>
<li><strong>安装依赖</strong>：需要 <code>mysql2</code>（数据库连接）、<code>bcrypt</code>（密码加密，不能明文存储）、<code>express-validator</code>（参数校验）,dotenv 判断环境变量</li>
</ol>
<pre><code class="hljs language-js" lang="js">
npm init -y

npm install mysql2 bcrypt express-validator deotnev

</code></pre>
<h5 data-id="heading-7">2. 多环境配置文件（区分测试 / 正式）</h5>
<p>在项目根目录创建 <strong>多个 <code>.env</code> 文件</strong>，分别对应不同环境：</p>
<pre><code class="hljs language-plaintext" lang="plaintext">project/
├── .env.development  # 开发环境（本地调试）
├── .env.production   # 生产环境（正式服务器）
├── .env.test         # 测试环境（可选，测试服务器）
└── .gitignore        # 忽略 .env* 文件，避免提交到 Git
</code></pre>
<p><strong>文件内容示例</strong>：</p>
<pre><code class="hljs language-env" lang="env">NODE_ENV=development  # 标识环境
DB_HOST=localhost     # 本地数据库地址
DB_USER=root          # 本地数据库账号
DB_PASSWORD=admin123  # 本地数据库密码
DB_NAME=mydb          # 本地数据库名
API_PORT=3000         # 开发环境端口
</code></pre>
<p><code>.env.production</code>（生产环境）：</p>
<pre><code class="hljs language-env" lang="env">NODE_ENV=production
DB_HOST=10.0.0.1      # 服务器数据库地址（内网 IP）
DB_USER=prod_user     # 服务器数据库账号（非 root，更安全）
DB_PASSWORD=Prod@123  # 服务器数据库密码（复杂密码）
DB_NAME=mydb_prod     # 生产环境数据库名（可与开发环境不同）
API_PORT=3000         # 生产环境端口
</code></pre>
<h5 data-id="heading-8">3. 在代码中加载对应环境的配置</h5>
<p>在<code>db/mysql.js</code>，根据 <code>NODE_ENV</code> 自动加载对应的 <code>.env</code> 文件：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// db/mysql.js（ESM 版）</span>
<span class="hljs-keyword">import</span> mysql <span class="hljs-keyword">from</span> <span class="hljs-string">'mysql2/promise'</span>;
<span class="hljs-keyword">import</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">'dotenv'</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;
<span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'url'</span>;

<span class="hljs-comment">// 解决 ESM 中 __dirname 问题</span>
<span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);
<span class="hljs-keyword">const</span> __dirname = path.<span class="hljs-title function_">dirname</span>(__filename);

<span class="hljs-comment">// 1. 确定当前环境（默认 development）</span>
<span class="hljs-keyword">const</span> env = process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> || <span class="hljs-string">'development'</span>;

<span class="hljs-comment">// 2. 加载对应环境的 .env 文件（如 .env.development 或 .env.production）</span>
<span class="hljs-keyword">const</span> envPath = path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">`../.env.<span class="hljs-subst">${env}</span>`</span>);
dotenv.<span class="hljs-title function_">config</span>({ <span class="hljs-attr">path</span>: envPath });  <span class="hljs-comment">// 加载指定路径的 .env 文件</span>

<span class="hljs-comment">// 3. 从 process.env 中读取配置（环境变量全部是字符串类型）</span>
<span class="hljs-keyword">const</span> dbConfig = {
  <span class="hljs-attr">host</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DB_HOST</span>,
  <span class="hljs-attr">user</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DB_USER</span>,
  <span class="hljs-attr">password</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DB_PASSWORD</span>,
  <span class="hljs-attr">database</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DB_NAME</span>,
  <span class="hljs-attr">port</span>: <span class="hljs-title class_">Number</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">DB_PORT</span>) || <span class="hljs-number">3306</span>,  <span class="hljs-comment">// 转换为数字</span>
  <span class="hljs-attr">connectionLimit</span>: <span class="hljs-number">10</span>,
};

<span class="hljs-comment">// 创建连接池</span>
<span class="hljs-keyword">const</span> pool = mysql.<span class="hljs-title function_">createPool</span>(dbConfig);

<span class="hljs-comment">// 测试连接时打印当前环境</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testDbConnection</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> pool.<span class="hljs-title function_">getConnection</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`✅ 数据库连接成功（环境：<span class="hljs-subst">${env}</span>，数据库：<span class="hljs-subst">${dbConfig.database}</span>`</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`❌ 数据库连接失败（环境：<span class="hljs-subst">${env}</span>）：`</span>, err.<span class="hljs-property">message</span>);
    <span class="hljs-keyword">throw</span> err;
  }
}

<span class="hljs-keyword">export</span> { pool };
</code></pre>
<p><code>app.js如下：</code></p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>
<span class="hljs-keyword">import</span> bodyParser <span class="hljs-keyword">from</span> <span class="hljs-string">'body-parser'</span>
<span class="hljs-keyword">import</span> userRouter <span class="hljs-keyword">from</span> <span class="hljs-string">'./routes/user.js'</span>
<span class="hljs-keyword">import</span> { testDbConnection } <span class="hljs-keyword">from</span> <span class="hljs-string">'./db/mysql.js'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">HttpError</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils/HttpError.js'</span> <span class="hljs-comment">// 导入自定义错误类</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()
<span class="hljs-comment">// 从环境变量读取端口（对应.env中的API_PORT）</span>
<span class="hljs-keyword">const</span> port = process.<span class="hljs-property">env</span>.<span class="hljs-property">API_PORT</span> || <span class="hljs-number">3000</span>

<span class="hljs-comment">// 解析JSON请求（必须，否则无法获取req.body）</span>
app.<span class="hljs-title function_">use</span>(bodyParser.<span class="hljs-title function_">json</span>())

<span class="hljs-comment">// 挂载用户模块路由</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-string">'/api/user'</span>, userRouter)

<span class="hljs-comment">// 全局错误处理中间件（必须放在所有路由和中间件之后）</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> {
  <span class="hljs-comment">// 1. 处理自定义HttpError</span>
  <span class="hljs-keyword">if</span> (err <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">HttpError</span>) {
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(err.<span class="hljs-property">statusCode</span>).<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">status</span>: err.<span class="hljs-property">statusCode</span>, <span class="hljs-comment">// 业务错误状态码（如400）</span>
      <span class="hljs-attr">message</span>: err.<span class="hljs-property">message</span>, <span class="hljs-comment">// 错误提示信息</span>
      <span class="hljs-attr">errors</span>: err.<span class="hljs-property">errors</span>, <span class="hljs-comment">// 详细错误列表（如参数校验错误）</span>
    })
  }

  <span class="hljs-comment">// 2. 处理系统错误（如数据库连接失败、代码bug等）</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'系统错误堆栈：'</span>, err.<span class="hljs-property">stack</span>) <span class="hljs-comment">// 打印堆栈，方便后端调试</span>
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({
    <span class="hljs-attr">status</span>: <span class="hljs-number">500</span>,
    <span class="hljs-attr">message</span>:
      process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">'production'</span>
        ? <span class="hljs-string">'服务器内部错误，请稍后重试'</span> <span class="hljs-comment">// 生产环境隐藏具体错误</span>
        : <span class="hljs-string">`系统错误：<span class="hljs-subst">${err.message}</span>`</span>, <span class="hljs-comment">// 开发环境显示具体错误（便于调试）</span>
    <span class="hljs-attr">errors</span>: [],
  })
})

<span class="hljs-comment">// 启动服务（端口来自环境变量）</span>
app.<span class="hljs-title function_">listen</span>(port, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
    <span class="hljs-string">`服务启动成功（环境：<span class="hljs-subst">${process.env.NODE_ENV}</span>）：http://localhost:<span class="hljs-subst">${port}</span>`</span>
  )
  <span class="hljs-title function_">testDbConnection</span>() <span class="hljs-comment">// 启动时验证数据库连接</span>
})

</code></pre>
<h2 data-id="heading-9">注册接口编写</h2>
<p>在根目录下新建<code>routes/user.js</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>
<span class="hljs-keyword">import</span> { body, validationResult } <span class="hljs-keyword">from</span> <span class="hljs-string">'express-validator'</span>
<span class="hljs-keyword">import</span> bcrypt <span class="hljs-keyword">from</span> <span class="hljs-string">'bcrypt'</span>
<span class="hljs-keyword">import</span> { pool } <span class="hljs-keyword">from</span> <span class="hljs-string">'../db/mysql.js'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">HttpError</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/HttpError.js'</span>

<span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()

<span class="hljs-comment">// 注册接口：POST /api/user/register</span>
router.<span class="hljs-title function_">post</span>(
  <span class="hljs-string">'/register'</span>,
  <span class="hljs-comment">// 参数校验（字段名与前端传入、数据库字段一致）</span>
  [
    <span class="hljs-title function_">body</span>(<span class="hljs-string">'email'</span>).<span class="hljs-title function_">isEmail</span>().<span class="hljs-title function_">withMessage</span>(<span class="hljs-string">'邮箱格式错误'</span>), <span class="hljs-comment">// 对应数据库email字段</span>
    <span class="hljs-title function_">body</span>(<span class="hljs-string">'password'</span>).<span class="hljs-title function_">isLength</span>({ <span class="hljs-attr">min</span>: <span class="hljs-number">6</span> }).<span class="hljs-title function_">withMessage</span>(<span class="hljs-string">'密码至少6位'</span>), <span class="hljs-comment">// 对应password字段</span>
    <span class="hljs-title function_">body</span>(<span class="hljs-string">'nickname'</span>)
      .<span class="hljs-title function_">optional</span>()
      .<span class="hljs-title function_">isLength</span>({ <span class="hljs-attr">max</span>: <span class="hljs-number">50</span> })
      .<span class="hljs-title function_">withMessage</span>(<span class="hljs-string">'昵称最多50字'</span>), <span class="hljs-comment">// 对应nickname字段</span>
  ],
  <span class="hljs-keyword">async</span> (req, res, next) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// 校验参数</span>
      <span class="hljs-keyword">const</span> errors = <span class="hljs-title function_">validationResult</span>(req)
      <span class="hljs-keyword">if</span> (!errors.<span class="hljs-title function_">isEmpty</span>()) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpError</span>(<span class="hljs-number">400</span>, <span class="hljs-string">'参数校验失败'</span>, errors.<span class="hljs-title function_">array</span>())
      }

      <span class="hljs-comment">// 解构前端传入的参数（字段名与数据库字段一致）</span>
      <span class="hljs-keyword">const</span> { email, password, nickname } = req.<span class="hljs-property">body</span>

      <span class="hljs-comment">// 1. 检查邮箱是否已注册（SQL中使用email字段，与数据库一致）</span>
      <span class="hljs-keyword">const</span> [existingUsers] = <span class="hljs-keyword">await</span> pool.<span class="hljs-title function_">query</span>(
        <span class="hljs-string">'SELECT id FROM users WHERE email = ?'</span>, <span class="hljs-comment">// WHERE条件用email字段</span>
        [email]
      )
      <span class="hljs-keyword">if</span> (existingUsers.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpError</span>(<span class="hljs-number">400</span>, <span class="hljs-string">'该邮箱已被注册'</span>)
      }

      <span class="hljs-comment">// 2. 密码加密</span>
      <span class="hljs-comment">//   const hashedPassword = await bcrypt.hash(password, 10)</span>

      <span class="hljs-comment">// 3. 插入数据库（字段名与数据库表完全一致）</span>
      <span class="hljs-keyword">const</span> [result] = <span class="hljs-keyword">await</span> pool.<span class="hljs-title function_">query</span>(
        <span class="hljs-string">'INSERT INTO users (email, password, nickname) VALUES (?, ?, ?)'</span>, <span class="hljs-comment">// 字段顺序：email, password, nickname</span>
        [email, password, nickname || <span class="hljs-literal">null</span>] <span class="hljs-comment">// 对应字段的值</span>
      )

      <span class="hljs-comment">// 4. 返回结果（包含数据库自动生成的id和字段）</span>
      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({
        <span class="hljs-attr">code</span>: <span class="hljs-number">200</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">'注册成功'</span>,
        <span class="hljs-attr">data</span>: {
          <span class="hljs-attr">userId</span>: result.<span class="hljs-property">insertId</span>, <span class="hljs-comment">// 数据库自增id</span>
          <span class="hljs-attr">email</span>: email, <span class="hljs-comment">// 与数据库email字段一致</span>
          <span class="hljs-attr">nickname</span>: nickname || <span class="hljs-literal">null</span>, <span class="hljs-comment">// 与数据库nickname字段一致</span>
          <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
        },
      })
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-title function_">next</span>(err)
    }
  }
)

<span class="hljs-comment">// 获取所有用户</span>
router.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/allUsers'</span>, <span class="hljs-keyword">async</span> (req, res, next) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> [users] = <span class="hljs-keyword">await</span> pool.<span class="hljs-title function_">query</span>(<span class="hljs-string">'SELECT * FROM users'</span>)
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">code</span>: <span class="hljs-number">200</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">'获取成功'</span>,
      <span class="hljs-attr">data</span>: users,
    })
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-title function_">next</span>(err)
  }
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router

</code></pre>
<h2 data-id="heading-10">本地postman测试</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a02ec87429844106afff8dbfa76cdc05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6IOW6Zye:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150455&amp;x-signature=j0%2F%2FjuCc6EZMVzVbbtklfW3GR5Y%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-11">数据库查看这条数据</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b52b30e96419446688ccd6ce9b986970~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6IOW6Zye:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150455&amp;x-signature=glTxtnRbRhOUSlRKP87O9Ti2M1A%3D" alt="image.png" loading="lazy"/></p>
<p>下一篇学习如何把代码发布到服务器，通过域名来访问接口，实现注册，顺便把前端页面也发布上去</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[苹果iOS应用签名与上架App Store完整指南包括注意事项]]></title>    <link>https://juejin.cn/post/7574230922314989574</link>    <guid>https://juejin.cn/post/7574230922314989574</guid>    <pubDate>2025-11-19T09:53:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574230922314989574" data-draft-id="7574253222606635049" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="苹果iOS应用签名与上架App Store完整指南包括注意事项"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-11-19T09:53:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="疯狂的程序猴"/> <meta itemprop="url" content="https://juejin.cn/user/2760245749234147"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            苹果iOS应用签名与上架App Store完整指南包括注意事项
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2760245749234147/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    疯狂的程序猴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:53:35.000Z" title="Wed Nov 19 2025 09:53:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>苹果商城（App Store）应用程序苹果ios签名进行系统怎么上架的注意事项完整教程</p>
<p>导语：苹果签名是保障安全和防止软件篡改的重要措施，也是苹果设备下载应用程序的必要步骤。本文将为大家提供一个详细的教程，介绍如何为应用程序进行苹果签名，以及发布到App Store上架的流程。</p>
<p>一、注册苹果开发者账号</p>
<p>在进行苹果签名和发布应用程序之前，首先需要注册一个苹果开发者账号。通过以下步骤注册：</p>
<p>打开苹果开发者网站
developer.apple.com；</p>
<p>点击右上角的“账户”按钮，然后选择“注册”；</p>
<p>按照页面提示填写相关信息，包括个人身份信息、联系方式以及支付方式；</p>
<p>提交注册申请并完成支付。</p>
<p>二、创建App ID</p>
<p>为了能够对应用程序进行签名，需要在苹果开发者账号中创建一个唯一的App ID。</p>
<p>登录苹果开发者网站
developer.apple.com；</p>
<p>点击右上角的“账户”按钮，然后选择“证书、标识和配置文件”；</p>
<p>在左侧菜单栏中选择“Identifiers”；</p>
<p>点击页面右上角的“添加”按钮；</p>
<p>在创建App ID页面中填写相关信息，包括App的名称、Bundle Identifier等；</p>
<p>点击“Continue”并确认App ID创建成功。</p>
<p>三、创建签名证书</p>
<p>为了进行苹果签名，需要在苹果开发者账号中创建签名证书。</p>
<p>登录苹果开发者网站
developer.apple.com；</p>
<p>点击右上角的“账户”按钮，然后选择“证书、标识和配置文件”；</p>
<p>在左侧菜单栏中选择“Certificates”；</p>
<p>点击页面右上角的“添加”按钮；</p>
<p>根据提示选择合适的证书类型（开发、生产或通用）；</p>
<p>按照页面提示进行操作，包括上传CSR文件等；</p>
<p>最后生成签名证书，并下载保存到本地。</p>
<p>四、下载和安装签名证书</p>
<p>为了在开发环境中使用签名证书，需要将证书下载并安装到本地电脑。</p>
<p>打开Keychain Access应用程序（在Launchpad-工具文件夹中找到）；</p>
<p>在菜单栏中选择“登录”；</p>
<p>点击菜单栏中的“文件”，选择“导入项目”；</p>
<p>在弹出的导入证书对话框中选择之前下载的签名证书文件（扩展名为.cer）；</p>
<p>根据提示完成证书的导入安装。</p>
<p>五、在Xcode中进行签名设置</p>
<p>在Xcode中进行签名设置可以让我们在开发过程中自动对应用程序进行苹果签名。</p>
<p>打开Xcode应用程序，进入项目的“General”选项卡；</p>
<p>在“Identity”部分选择对应的Team；</p>
<p>在“Signing”部分选择对应的Provisioning Profile；</p>
<p>如果没有可用的Provisioning Profile，可以点击“Manage Certificates”按钮创建或下载；</p>
<p>如果需要发布到App Store上架，需要选择“Generic iOS Device”为目标设备；</p>
<p>点击菜单栏中的“Product”，选择“Archive”进行打包。</p>
<p>对于希望简化流程的开发者，可以使用AppUploader等工具来管理iOS证书和描述文件，支持在Windows、Linux或Mac系统中直接创建和上传，无需钥匙串助手或Xcode即可完成部分操作。</p>
<p>六、提交应用程序到App Store</p>
<p>一旦应用程序经过签名，就可以准备将其提交到App Store进行上架了。</p>
<p>打开Xcode应用程序，进入“Organizer”（在菜单栏中选择“Window”-“Organizer”）；</p>
<p>选择之前打包的应用程序，点击“Validate”进行验证；</p>
<p>根据提示进行验证并解决相应问题；</p>
<p>验证通过后，点击“Submit”进行提交申请；</p>
<p>登录iTunes Connect账号，选择App对应的App Store信息和截图等；</p>
<p>提交申请后，等待苹果审核，并按照审核结果进行相应调整和修改；</p>
<p>一旦应用程序通过审核，即可上架App Store，用户可以在App Store中下载和使用。</p>
<p>七、应用程序更新</p>
<p>在应用程序发布后，可能需要对其进行更新。下面是应用程序更新的流程：</p>
<p>在Xcode中打开项目，进行相应的更新和修改；</p>
<p>在Xcode中进行签名设置和打包；</p>
<p>使用之前创建的Provisioning Profile进行签名和验证；</p>
<p>将更新的应用程序提交到App Store进行审核。</p>
<p>结语：本文详细介绍了如何为应用程序进行苹果签名，并将其发布到App Store上架的完整流程。希望能够对开发者和想要发布应用程序的用户提供帮助。同时，我们强调了苹果签名的重要性和安全性，建议用户遵循官方流程进行应用程序的签名和发布，避免绕过苹果签名带来的安全隐患。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[生产环境服务器变慢？从应急到根因的全流程诊断处理指南]]></title>    <link>https://juejin.cn/post/7574245125028413459</link>    <guid>https://juejin.cn/post/7574245125028413459</guid>    <pubDate>2025-11-19T09:54:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574245125028413459" data-draft-id="7574267813734187027" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="生产环境服务器变慢？从应急到根因的全流程诊断处理指南"/> <meta itemprop="keywords" content="后端,分布式"/> <meta itemprop="datePublished" content="2025-11-19T09:54:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="回家路上绕了弯"/> <meta itemprop="url" content="https://juejin.cn/user/536217404587134"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            生产环境服务器变慢？从应急到根因的全流程诊断处理指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/536217404587134/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    回家路上绕了弯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:54:12.000Z" title="Wed Nov 19 2025 09:54:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读13分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">生产环境服务器变慢？从应急到根因的全流程诊断处理指南</h2>
<p>生产环境服务器突然变慢，是运维和开发人员最头疼的场景之一 —— 用户反馈 “页面加载超时”“接口响应慢”，监控面板显示 “响应时间从 100ms 飙到 5s”，但登录服务器后却不知道从哪下手。此时盲目重启服务可能暂时缓解，但会丢失关键日志；逐个排查又怕耽误业务恢复。</p>
<p>本文结合 10 + 年生产环境运维经验，总结出一套 “<strong>先应急恢复，再分层诊断，最后根因解决</strong>” 的标准化流程，覆盖 CPU、内存、磁盘 IO、网络、应用等全链路问题，附具体工具命令与案例，帮你快速搞定服务器变慢问题。</p>
<h3 data-id="heading-1">一、第一步：先明确 “变慢” 的具体现象（避免盲目排查）</h3>
<p>服务器 “变慢” 是个模糊概念，首先要通过 “现象归类” 缩小排查范围，不同现象对应不同的问题方向：</p>






























<table><thead><tr><th>现象类型</th><th>具体表现</th><th>可能的问题方向</th></tr></thead><tbody><tr><td>响应延迟高</td><td>接口响应时间 &gt; 3s，页面加载超时，SSH 连接卡顿</td><td>CPU 过载、内存不足、网络拥堵、应用死锁</td></tr><tr><td>吞吐量下降</td><td>每秒处理请求数从 1000 降至 100，带宽利用率低</td><td>应用线程池满、数据库连接耗尽、依赖服务故障</td></tr><tr><td>资源使用率异常</td><td>CPU&gt;90%、内存使用率 &gt; 95%、磁盘 IO% util&gt;90%</td><td>进程占用过高、内存泄漏、磁盘读写频繁</td></tr><tr><td>间歇性卡顿</td><td>每隔 10 分钟慢一次，持续 30 秒后恢复</td><td>定时任务（如日志切割、备份）、GC 频繁</td></tr></tbody></table>
<p><strong>实战技巧</strong>：用 “对比法” 确认现象 —— 和历史正常数据比（如上周同一时段 CPU 仅 30%），和同集群其他节点比（如节点 A 慢，节点 B 正常），快速判断是 “单节点问题” 还是 “全局问题”。</p>
<h3 data-id="heading-2">二、第二步：应急处理（先恢复业务，再排查根因）</h3>
<p>生产环境的核心目标是 “业务可用”，如果服务器变慢已影响用户，需先执行应急措施，再深入诊断：</p>
<h4 data-id="heading-3">1. 快速恢复业务的 3 个常用手段</h4>
<ul>
<li><strong>重启核心服务</strong>：若确定是应用问题（如线程死锁、内存泄漏），先重启应用（如systemctl restart app.service），重启前记录关键日志（jstack 进程ID &gt; stack.log，避免丢失现场）；</li>
</ul>

<ul>
<li><strong>流量切换</strong>：若有负载均衡（如 Nginx、SLB），将慢节点的流量切到其他正常节点（如 Nginx 注释该节点 IP），待节点恢复后再重新接入；</li>
</ul>

<ul>
<li><strong>资源扩容</strong>：若因资源不足（如 CPU / 内存不够）导致变慢，临时扩容（如云服务器升级配置、增加容器实例），缓解压力后再优化。</li>
</ul>
<h4 data-id="heading-4">2. 关键注意点</h4>
<ul>
<li>不要直接重启服务器：重启会清除所有进程状态和日志，除非是 “SSH 都连不上” 的极端情况；</li>
</ul>

<ul>
<li>先备份日志：重启应用或服务前，备份应用日志、系统日志（/var/log/messages）、GC 日志，方便后续根因分析。</li>
</ul>
<h3 data-id="heading-5">三、第三步：分层诊断（从系统到应用，逐个击破）</h3>
<p>业务恢复后，按 “<strong>系统资源层→网络层→应用层→依赖层</strong>” 的顺序分层诊断，每一层都用工具定位具体问题，避免 “东一榔头西一棒子”。</p>
<h4 data-id="heading-6">第一层：系统资源诊断（CPU、内存、磁盘 IO）</h4>
<p>系统资源是服务器的 “硬件基础”，90% 的变慢问题都和资源过载有关，优先排查这一层。</p>
<h5 data-id="heading-7">1. CPU 问题诊断（用 top、pidstat、pstack）</h5>
<p><strong>核心工具</strong>：top（实时查看 CPU 使用率）、pidstat -u 1（按进程查看 CPU 占用）、pstack 进程ID（查看进程线程栈）。</p>
<p><strong>诊断步骤</strong>：</p>
<ol>
<li>执行top命令，观察关键指标：</li>
</ol>
<ul>
<li>
<ul>
<li>%us（用户态 CPU）：若 &gt; 80%，说明应用进程（如 Java、Python）占用过高；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>%sy（内核态 CPU）：若 &gt; 30%，说明内核操作频繁（如频繁系统调用、网络中断）；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>%wa（IO 等待 CPU）：若 &gt; 20%，说明 CPU 在等待磁盘 IO，磁盘读写是瓶颈；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>Cpu(s)行的id（空闲 CPU）：若 &lt; 10%，说明 CPU 整体过载。</li>
</ul>
</li>
</ul>
<ol start="2">
<li>定位高 CPU 进程：</li>
</ol>
<ul>
<li>
<ul>
<li>在top中按P键，按 CPU 使用率排序，找到占用最高的进程（如java进程 PID=12345，% CPU=95%）；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>执行pidstat -u 1 -p 12345，查看该进程的 CPU 占用是否持续过高，区分是 “瞬时高” 还是 “持续高”。</li>
</ul>
</li>
</ul>
<ol start="3">
<li>定位高 CPU 线程（若进程内多线程）：</li>
</ol>
<ul>
<li>
<ul>
<li>执行top -Hp 12345，按P键排序，找到进程内占用 CPU 最高的线程（如 TID=12346，% CPU=90%）；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>将线程 ID 转为十六进制（printf "%x\n" 12346 → 303a），执行jstack 12345 | grep 303a -A 20（Java 进程），查看线程栈，判断是否是死循环、频繁 GC、大量计算。</li>
</ul>
</li>
</ul>
<p><strong>案例</strong>：某 Java 应用 CPU 持续 95%，jstack发现 10 个线程卡在 “java.util.HashMap.put”，进一步排查发现是多线程并发修改 HashMap 导致的死循环，修改为 ConcurrentHashMap 后恢复正常。</p>
<h5 data-id="heading-8">2. 内存问题诊断（用 free、vmstat、jmap）</h5>
<p><strong>核心工具</strong>：free -h（查看内存使用）、vmstat 1（查看内存交换）、jmap -heap 进程ID（Java 进程内存使用）。</p>
<p><strong>诊断步骤</strong>：</p>
<ol>
<li>执行free -h，观察关键指标：</li>
</ol>
<ul>
<li>
<ul>
<li>used（已用内存）：若used接近total，且available（可用内存）&lt;10%，说明物理内存不足；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>Swap（交换分区）：若used&gt;0，说明物理内存不够，系统开始使用磁盘作为内存（Swap 速度比内存慢 100 倍，会导致服务器变慢）。</li>
</ul>
</li>
</ul>
<ol start="2">
<li>查看内存占用进程：</li>
</ol>
<ul>
<li>
<ul>
<li>执行top，按M键按内存使用率排序，找到占用最高的进程（如mysql进程占用 8GB 内存）；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>若为 Java 进程，执行jmap -heap 12345，查看堆内存使用（如老年代使用率 &gt; 95%，且 GC 后不下降，可能是内存泄漏）。</li>
</ul>
</li>
</ul>
<ol start="3">
<li>检查内存泄漏（长期变慢的常见原因）：</li>
</ol>
<ul>
<li>
<ul>
<li>Java 进程：执行jmap -dump:format=b,file=heap.hprof 12345，导出堆内存快照，用 MAT（Memory Analyzer Tool）分析，查看是否有大对象（如 ArrayList）持续增长且不释放；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>非 Java 进程：用valgrind工具检测内存泄漏（valgrind --leak-check=full ./app），适合 C/C++ 程序。</li>
</ul>
</li>
</ul>
<p><strong>案例</strong>：某 Python 应用运行 3 天后变慢，free发现 Swap 使用 10GB，top显示该进程内存从 2GB 涨到 15GB，排查发现是爬虫程序未释放请求连接，导致内存泄漏，修复连接池释放逻辑后恢复。</p>
<h5 data-id="heading-9">3. 磁盘 IO 问题诊断（用 iostat、iotop、df）</h5>
<p><strong>核心工具</strong>：iostat -x 1（查看磁盘 IO 使用率）、iotop（按进程查看磁盘读写）、df -h（查看磁盘空间）。</p>
<p><strong>诊断步骤</strong>：</p>
<ol>
<li>执行iostat -x 1，观察关键指标：</li>
</ol>
<ul>
<li>
<ul>
<li>%util（磁盘 IO 利用率）：若 &gt; 90%，说明磁盘读写满了（即使rMB/s/wMB/s不高，也可能是随机读写频繁）；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>rawait（读请求平均等待时间）、wawait（写请求平均等待时间）：若 &gt; 10ms，说明磁盘 IO 响应慢；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>svctm（磁盘服务时间）：若接近await，说明 IO 无等待（正常）；若await远大于svctm，说明 IO 队列堆积。</li>
</ul>
</li>
</ul>
<ol start="2">
<li>定位高 IO 进程：</li>
</ol>
<ul>
<li>
<ul>
<li>执行iotop，按O键（大写）只显示有 IO 活动的进程，查看哪个进程的DISK READ/DISK WRITE持续过高（如logrotate进程频繁写日志）；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>若为日志写入过多，检查应用日志级别（如是否误设为DEBUG级别，导致日志暴增）。</li>
</ul>
</li>
</ul>
<ol start="3">
<li>检查磁盘空间：</li>
</ol>
<ul>
<li>
<ul>
<li>执行df -h，查看是否有分区使用率 &gt; 95%（磁盘满会导致无法写入，应用卡住）；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>执行du -sh /<em>逐步排查大文件，删除无用日志（如rm -rf /var/log/app/</em>.log.1）或转移大文件。</li>
</ul>
</li>
</ul>
<p><strong>案例</strong>：某数据库服务器变慢，iostat显示%util=100%，iotop发现mysqld进程写 IO 达 200MB/s，排查发现是某 SQL 语句未加索引，导致全表扫描频繁读写磁盘，添加索引后%util降至 10%。</p>
<h4 data-id="heading-10">第二层：网络层诊断（用 ping、traceroute、tcpdump）</h4>
<p>若系统资源正常，但服务器仍变慢，需排查网络问题（如带宽拥堵、连接数满、网络丢包）。</p>
<h5 data-id="heading-11">1. 网络连通性与延迟</h5>
<ul>
<li>执行ping 目标IP（如ping 数据库IP），查看丢包率（packet loss）和延迟（time）：丢包率 &gt; 5% 或延迟 &gt; 100ms（内网），说明网络链路有问题；</li>
</ul>

<ul>
<li>执行traceroute 目标IP（内网用mtr更详细），查看链路中哪个节点延迟高或丢包（如某交换机节点延迟从 1ms 升至 200ms）。</li>
</ul>
<h5 data-id="heading-12">2. 网络连接与带宽</h5>
<ul>
<li>查看连接数：netstat -an | grep :8080 | wc -l（查看应用端口的连接数），对比应用配置的最大连接数（如 Tomcat 的maxConnections），若接近上限，说明连接数满；</li>
</ul>

<ul>
<li>查看带宽使用：iftop -i eth0（实时查看带宽），若TX（发送）或RX（接收）带宽接近网卡上限（如 1G 网卡达 900Mbps），说明带宽拥堵；</li>
</ul>

<ul>
<li>查看 TIME_WAIT 连接：netstat -an | grep TIME_WAIT | wc -l，若数量 &gt; 10000，可能是 TCP 连接回收慢，可调整内核参数（如net.ipv4.tcp_tw_reuse=1）。</li>
</ul>
<h5 data-id="heading-13">3. 抓包分析（定位异常请求）</h5>
<p>若怀疑是异常请求（如大量无效请求、大文件传输）导致网络拥堵，用tcpdump抓包：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># 抓应用端口8080的包，保存到文件（后续用Wireshark分析）</span>
<span class="hljs-string">tcpdump</span> <span class="hljs-string">-i</span> <span class="hljs-string">eth0</span> <span class="hljs-string">port</span> <span class="hljs-number">8080</span> <span class="hljs-string">-w</span> <span class="hljs-string">network.pcap</span>
</code></pre>
<p>用 Wireshark 打开network.pcap，过滤 “大尺寸数据包”（如ip.len &gt; 10000），查看是否有异常请求（如恶意爬虫频繁发送大请求）。</p>
<h4 data-id="heading-14">第三层：应用层诊断（用日志、线程栈、性能分析工具）</h4>
<p>系统和网络都正常时，问题大概率在应用本身（如代码 bug、配置错误、线程池满）。</p>
<h5 data-id="heading-15">1. 应用日志分析（最直接的问题线索）</h5>
<ul>
<li>查看错误日志：如 Java 应用的error.log、Python 应用的exception.log，搜索ERROR、Exception关键词，定位是否有代码异常（如空指针、数据库连接超时）；</li>
</ul>

<ul>
<li>查看访问日志：如 Nginx 的access.log、Tomcat 的localhost_access_log.txt，统计慢请求（如响应时间 &gt; 3s 的请求），分析是否是某接口 / URL 导致变慢；</li>
</ul>

<ul>
<li>日志分析工具：用grep、awk快速筛选（如awk '<span class="math math-inline"><span class="katex-error" title="ParseError: KaTeX parse error: Expected '}', got 'EOF' at end of input: NF&gt;3 {print " style="color:#cc0000">NF&gt;3 {print </span></span>0}' access.log筛选响应时间 &gt; 3s 的请求），或用 ELK（Elasticsearch+Logstash+Kibana）可视化分析。</li>
</ul>
<h5 data-id="heading-16">2. 应用性能分析（深入代码层面）</h5>
<ul>
<li><strong>Java 应用</strong>：用jprofiler或Arthas（阿里开源，无需重启）分析性能：</li>
</ul>

<ul>
<li>
<ul>
<li>arthas attach 12345（ attach 到 Java 进程）；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>dashboard查看实时 CPU、内存、线程状态；</li>
</ul>
</li>
</ul>

<ul>
<li>
<ul>
<li>trace com.example.AppController query跟踪接口调用链，查看哪个方法耗时最长；</li>
</ul>
</li>
</ul>

<ul>
<li><strong>Python 应用</strong>：用cProfile分析函数耗时（python -m cProfile -s cumulative <a href="https://link.juejin.cn?target=http%3A%2F%2Fapp.py" target="_blank" title="http://app.py" ref="nofollow noopener noreferrer">app.py</a>），定位耗时久的函数；</li>
</ul>

<ul>
<li><strong>Go 应用</strong>：用pprof分析（go tool pprof <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A6060%2Fdebug%2Fpprof%2Fprofile%3Fseconds%3D30" target="_blank" title="http://localhost:6060/debug/pprof/profile?seconds=30" ref="nofollow noopener noreferrer">http://localhost:6060/debug/pprof/profile?seconds=30</a>），生成 CPU 使用报告。</li>
</ul>
<p><strong>案例</strong>：某 Java 接口响应慢，Arthas trace发现query方法中JSONObject.parse耗时占比 80%，排查发现是接口返回的 JSON 数据达 10MB（包含大量冗余字段），精简字段后响应时间从 5s 降至 200ms。</p>
<h4 data-id="heading-17">第四层：依赖层诊断（数据库、Redis、第三方接口）</h4>
<p>应用变慢很多时候是 “依赖服务拖后腿”，需排查应用依赖的中间件和第三方服务：</p>
<h5 data-id="heading-18">1. 数据库问题（最常见的依赖瓶颈）</h5>
<ul>
<li>查看数据库连接数：show processlist（MySQL），若Threads_connected接近max_connections，说明连接数满；</li>
</ul>

<ul>
<li>查看慢查询：show slow logs（MySQL），分析慢 SQL（如无索引、join 过多），用explain分析 SQL 执行计划；</li>
</ul>

<ul>
<li>查看数据库资源：top查看数据库进程 CPU / 内存占用，iostat查看数据库磁盘 IO，判断是否是数据库本身过载。</li>
</ul>
<h5 data-id="heading-19">2. Redis 问题</h5>
<ul>
<li>查看 Redis 连接数：info clients，若connected_clients接近maxclients，说明连接数满；</li>
</ul>

<ul>
<li>查看 Redis 性能：info stats，查看instantaneous_ops_per_sec（每秒操作数），若远超 Redis 性能上限（单实例建议 &lt; 10 万 / 秒），需扩容；</li>
</ul>

<ul>
<li>查看慢命令：slowlog get，查看是否有keys *、hgetall等慢命令，这些命令会阻塞 Redis。</li>
</ul>
<h5 data-id="heading-20">3. 第三方接口问题</h5>
<ul>
<li>直接调用测试：在服务器上用curl -w "%{time_total}\n" -o /dev/null -s "<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.thirdparty.com%2Fpay" target="_blank" title="https://api.thirdparty.com/pay" ref="nofollow noopener noreferrer">api.thirdparty.com/pay</a>"，查看第三方接口响应时间，若 &gt; 3s，说明是第三方服务慢；</li>
</ul>

<ul>
<li>查看应用中第三方接口的超时配置：若超时时间设为 10s，而第三方接口经常 5s 响应，会导致应用线程等待，需调整超时时间并加重试机制。</li>
</ul>
<h3 data-id="heading-21">四、第四步：根因解决（避免问题重复发生）</h3>
<p>定位到具体问题后，需针对性解决，避免 “临时恢复后再次出现”：</p>



































<table><thead><tr><th>问题类型</th><th>根因解决方法</th><th>预防措施</th></tr></thead><tbody><tr><td>CPU 过载（应用计算多）</td><td>优化代码（如减少循环、用缓存）、拆分计算任务</td><td>性能压测时关注 CPU 使用率，设置 CPU 告警阈值</td></tr><tr><td>内存泄漏</td><td>修复代码（如释放无用对象、关闭连接）、用内存分析工具定期检测</td><td>部署内存监控，设置老年代使用率告警（如 &gt; 90%）</td></tr><tr><td>磁盘 IO 高（日志多）</td><td>调整日志级别（如 DEBUG→INFO）、日志轮转（如 logrotate）、用 SSD 替换 HDD</td><td>监控磁盘 IO% util，设置告警阈值（如 &gt; 80%）</td></tr><tr><td>慢 SQL</td><td>加索引、优化 SQL（如拆分 join、避免 select *）、分库分表</td><td>开启慢查询日志，定期优化慢 SQL</td></tr><tr><td>第三方接口慢</td><td>更换第三方服务商、增加本地缓存、异步调用</td><td>监控第三方接口响应时间，设置超时重试</td></tr></tbody></table>
<h3 data-id="heading-22">五、第五步：预防措施（构建长效监控体系）</h3>
<p>最好的处理是 “避免问题发生”，需构建完善的监控体系，提前发现隐患：</p>
<h4 data-id="heading-23">1. 核心监控指标与工具</h4>



































<table><thead><tr><th>监控层面</th><th>核心指标</th><th>推荐工具</th><th>告警阈值</th></tr></thead><tbody><tr><td>系统资源</td><td>CPU% us、内存 available、磁盘 % util、网络丢包率</td><td>Prometheus+Grafana、Zabbix</td><td>CPU&gt;80%、内存 available&lt;10%、IO% util&gt;80%</td></tr><tr><td>应用性能</td><td>接口响应时间、错误率、线程数</td><td>SkyWalking、Pinpoint、Arthas</td><td>响应时间 &gt; 3s、错误率 &gt; 1%、线程数 &gt; 90% 上限</td></tr><tr><td>中间件</td><td>数据库慢查询数、Redis ops、连接数</td><td>Prometheus+Exporter（MySQL/Redis）</td><td>慢查询数 &gt; 10 / 分钟、Redis ops&gt;8 万 / 秒</td></tr><tr><td>业务指标</td><td>每秒请求数、订单成功率、页面加载时间</td><td>自定义监控脚本、APM 工具</td><td>每秒请求数下降 50%、成功率 &lt; 99.9%</td></tr></tbody></table>
<h4 data-id="heading-24">2. 定期巡检与压测</h4>
<ul>
<li>每周巡检：检查服务器资源使用率、应用日志错误率、慢查询数量，及时发现潜在问题；</li>
</ul>

<ul>
<li>每月压测：用 JMeter/LoadRunner 模拟峰值流量，验证服务器和应用的承载能力，提前扩容或优化；</li>
</ul>

<ul>
<li>版本发布前测试：新功能上线前，在测试环境验证 CPU、内存使用，避免上线后导致服务器变慢。</li>
</ul>
<h3 data-id="heading-25">总结：服务器变慢诊断的核心原则</h3>
<ol>
<li><strong>先应急后根因</strong>：生产环境优先恢复业务，再排查问题，避免因排查导致业务中断更久；</li>
</ol>

<ol start="2">
<li><strong>分层诊断</strong>：从系统资源到应用，从本地到依赖，按层排查，不遗漏任何环节；</li>
</ol>

<ol start="3">
<li><strong>工具落地</strong>：熟练使用 top、iostat、jstack 等工具，用数据说话，不凭感觉猜测；</li>
</ol>

<ol start="4">
<li><strong>长效预防</strong>：解决问题后，通过监控和巡检避免重复发生，构建 “发现 - 解决 - 预防” 的闭环。</li>
</ol>
<p>记住：服务器变慢不是 “偶发事件”，而是 “系统隐患的暴露”。每次诊断处理后，都要总结经验，优化监控或流程，让服务器越来越稳定。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[告别泡咖啡等报表！阿里云物化视图，把日志查询速度提升100倍！]]></title>    <link>https://juejin.cn/post/7574245788949069839</link>    <guid>https://juejin.cn/post/7574245788949069839</guid>    <pubDate>2025-11-19T09:55:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574245788949069839" data-draft-id="7574251313882906639" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="告别泡咖啡等报表！阿里云物化视图，把日志查询速度提升100倍！"/> <meta itemprop="keywords" content="云原生"/> <meta itemprop="datePublished" content="2025-11-19T09:55:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="阿里云云原生"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            告别泡咖啡等报表！阿里云物化视图，把日志查询速度提升100倍！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    阿里云云原生
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T09:55:04.000Z" title="Wed Nov 19 2025 09:55:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>作者：戴志勇</p>
<h2 data-id="heading-0">当“即查即算”遇上数据爆炸</h2>
<p>你是否经历过这样的场景？</p>
<p>在阿里云日志服务里，一个看似简单的看板，点开却要等上几十秒；高峰期多人同时查日志，系统直接“卡成 PPT”；更糟的是，有时结果还不准——因为达到资源限制，系统只能“估算”答案。</p>
<p>这背后，是日志规模爆炸式增长带来的现实困境：当数据量从 GB 跃升至 TB 甚至 PB 级，“边查边算”的传统模式已力不从心。</p>
<ul>
<li><strong>查得慢：</strong> 复杂聚合动辄几十秒，看板刷新比泡杯咖啡还久</li>
<li><strong>扛不住：</strong> 一到高峰，查询互相抢资源，一个慢、全链路崩</li>
<li><strong>不准了：</strong> 资源超限被迫降级，数据失真，决策风险陡增</li>
</ul>
<p>而这些痛点，恰恰集中在最常用的场景——监控大屏、运营看板、实时报表。它们有个共同特点：查询模式固定、时间跨度大、但要求秒级响应、结果精准。</p>
<p>现在，<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aliyun.com%2Fproduct%2Fsls%3Fspm%3Da1z389.11499242.0.0.65452413PLWe13%26utm_content%3Dg_1000408139" target="_blank" title="https://www.aliyun.com/product/sls?spm=a1z389.11499242.0.0.65452413PLWe13&amp;utm_content=g_1000408139" ref="nofollow noopener noreferrer">阿里云日志服务</a>带来破局利器——<strong>物化视图</strong>。</p>
<p>它就像给你的日志数据“提前算好答案，存好快照”。通过智能增量预计算 + 自动查询改写，系统在后台默默把高频查询的结果提前准备好。当你发起请求时，不再扫描全量原始日志，而是直接读取预计算结果——查询速度提升数十倍乃至百倍，资源消耗大幅降低，结果还更稳、更准。</p>
<p>用一点额外的存储空间，换回秒级洞察力。从此，再大的日志量，也能做到“点开即见，所见即所得”。</p>
<h2 data-id="heading-1"><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aliyun.com%2Fproduct%2Fsls%3Fspm%3Da1z389.11499242.0.0.65452413PLWe13%26utm_content%3Dg_1000408139" target="_blank" title="https://www.aliyun.com/product/sls?spm=a1z389.11499242.0.0.65452413PLWe13&amp;utm_content=g_1000408139" ref="nofollow noopener noreferrer">日志服务</a>物化视图优势</h2>
<p>物化视图的核心思想是：用额外的存储空间，换来查询速度的飞跃。日志服务的物化视图主要支持两种场景的查询加速。</p>
<p><strong>1. 过滤加速：只留“有用”的日志</strong></p>
<p>比如你只关心“错误日志”，物化视图会提前把所有 error 级别的日志筛选出来单独存好。下次查错误，就不用翻遍全部日志，直接查这个“精选集”，速度提升几十倍。</p>
<p><strong>2. 预聚合加速：提前算好统计结果</strong></p>
<p>比如每天要统计“各地区的用户访问量”，物化视图会每隔一段时间自动算好这个数据并存起来。你查的时候，系统直接拿现成结果，不用再从原始日志里一条条加总——数据量可能从亿行变成百行。</p>
<p>与业界其他物化视图方案相比，日志服务物化视图具有以下优势：</p>
<h3 data-id="heading-2">1. 异步物化视图，增量刷新，不影响写入性能</h3>
<p>物化视图的构建完全独立于数据写入流程，采用异步更新机制，每次刷新只针对新写入的数据，更新任务由后端托管，对用户透明。</p>
<h3 data-id="heading-3">2. 自动数据合并，写入即可查</h3>
<p>自动合并未物化的最近数据和已物化的历史结果，有效解决了同类产品的关键问题：</p>
<ul>
<li>异步刷新痛点：无法读取最新数据，秒级刷新也无法保证数据实时性</li>
<li>同步刷新痛点：严重影响写入性能，系统吞吐量大幅下降</li>
</ul>
<h3 data-id="heading-4">3. 支持复杂聚合函数的改写</h3>
<p>除了常用的聚合函数（sum、count、avg、min、max等），还支持如下复杂的聚合函数：</p>
<ul>
<li><code>count(distinct)</code>：精确去重统计</li>
<li><code>approx_percentile</code>：近似百分位数计算</li>
<li><code>approx_distinct</code>：高效近似去重</li>
</ul>
<h3 data-id="heading-5">4. 支持动态更新物化视图</h3>
<p>更改物化视图的 SQL 定义时，历史物化视图无需重建，不影响已物化的历史结果。对于经常动态增加列或减少列的场景，这一特性显得尤为重要，可以避免频繁更新物化视图带来的存储和计算成本增加。</p>
<h3 data-id="heading-6">5. 透明改写</h3>
<p>除了支持 SQL 的透明改写，对于查询语句也可以做谓词的自动补偿。举例说明：</p>
<p><strong>用户创建物化视图的语句：</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">level:</span><span class="hljs-keyword">error</span> | <span class="hljs-keyword">select</span> latency, host <span class="hljs-keyword">from</span> log <span class="hljs-keyword">where</span> message <span class="hljs-built_in">like</span> <span class="hljs-comment">'%xxx%'</span>
</code></pre>
<p><strong>对于如下的查询请求：</strong></p>
<pre><code class="hljs language-sql" lang="sql">level:error <span class="hljs-keyword">and</span> latency <span class="hljs-operator">&gt;</span> <span class="hljs-number">100</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(latency), host <span class="hljs-keyword">from</span> log <span class="hljs-keyword">where</span> message <span class="hljs-keyword">like</span> <span class="hljs-string">'%xxx%'</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> host
</code></pre>
<p>优化器自动添加 latency &gt; 100<code> </code>作为查询条件去查物化结果，用户完全无感。对于过滤性加速场景，多个 SQL 可以最大化复用物化结果，有效降低了物化带来的存储开销。</p>
<h2 data-id="heading-7">原理介绍</h2>
<p>对于用户创建的物化视图，日志服务会在后台自动托管整个计算与维护流程——无需用户干预，一切静默完成。</p>
<p>具体来说，系统会为每个物化视图启动一个智能定时任务，持续追踪新写入的日志数据。每隔一段时间，它就会自动执行您创建视图时指定的 SQL（无论是简单的过滤条件，还是复杂的聚合逻辑），并将计算结果持久化存储起来。每次任务完成后，系统还会精准记录“已处理到哪个时间点”，为后续查询提供优化依据。这一切对用户完全透明：不用写调度脚本、不用管任务失败、也不用担心数据一致性——日志服务全权负责。</p>
<p>当发起查询时，基于成本的优化器（CBO）会自动介入：</p>
<ul>
<li>如果发现有匹配的物化视图，它会智能选择最优的一个；</li>
<li>对于非聚合类查询，优化器将执行计划改写为“原始数据 + 物化数据”的轻量级 Union；</li>
<li>对于聚合类查询，则巧妙地将新数据实时聚合后，再与预计算结果合并。</li>
</ul>
<p>整个过程无缝衔接，既保证了结果的实时性与准确性，又大幅降低了查询延迟和资源开销。整个架构图如下所示（以聚合场景为例）。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/baeb2e5591a541968f4f6d1554b128a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150904&amp;x-signature=VtQjBQJNcp36Y7Kre77Z2nv%2BfZw%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-8">案例分享：Dashboard 从“超时失败”到“秒级响应”</h2>
<p>在 Dashboard 场景中，用户对仪表盘打开时间极为敏感，通常要求秒级响应。当多个用户同时刷新 Dashboard 时，如果单个 SQL 请求消耗大量计算资源，会导致计算资源争抢，所有用户都在等待，严重影响用户体验。通过物化视图预计算关键指标，可以将原本需要分钟级计算的复杂查询优化为秒级响应，显著提升用户体验。</p>
<p>举个真实场景：当系统延迟突然飙升，如何快速定位问题？</p>
<p>假设一个高并发的在线服务，其日志数据被写入某个 Logstore 中。每条日志记录的关键信息：</p>
<ul>
<li>请求延迟（latency）</li>
<li>请求类型（RequestType）</li>
<li>用户 ID（ProjectId）</li>
<li>状态码（Status）</li>
<li>请求数据量（InFlow）</li>
<li>返回数据量（OutFlow）</li>
</ul>
<p>某时刻，监控告警响起——系统平均延迟突然升高！是正常波动？是流量激增导致？还是某个特定用户或接口出了问题？你需要立刻响应，不想等上几十秒甚至最后超时无法看到结果。</p>
<p><strong>创建物化视图的 SQL：</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">*| <span class="hljs-function"><span class="hljs-keyword">select</span> <span class="hljs-title">avg</span>(<span class="hljs-params">latency</span>) <span class="hljs-keyword">as</span> avg_latency,<span class="hljs-title">date_trunc</span>(<span class="hljs-params"><span class="hljs-string">'hour'</span>, __time__</span>) <span class="hljs-keyword">as</span> time <span class="hljs-keyword">from</span> log <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> time
*| <span class="hljs-keyword">select</span> <span class="hljs-title">sum</span>(<span class="hljs-params">InFlow</span>) <span class="hljs-keyword">as</span> in_flow,<span class="hljs-title">sum</span>(<span class="hljs-params">OutFlow</span>) <span class="hljs-keyword">as</span> out_flow,<span class="hljs-title">avg</span>(<span class="hljs-params">latency</span>) <span class="hljs-keyword">as</span> latency, ProjectId,RequestType,Status <span class="hljs-keyword">from</span> log <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> ProjectId,RequestType,Status
</span></code></pre>
<p>仪表盘使用的 SQL：</p>
<pre><code class="hljs language-sql" lang="sql">统计每个小时的平均延迟同比一天前、三天前和一周前的变化
<span class="hljs-operator">*</span><span class="hljs-operator">|</span> <span class="hljs-keyword">select</span> <span class="hljs-type">time</span>,diff[<span class="hljs-number">1</span>] <span class="hljs-keyword">as</span> day1,diff[<span class="hljs-number">2</span>] <span class="hljs-keyword">as</span> day2,diff[<span class="hljs-number">3</span>] <span class="hljs-keyword">as</span> day3, diff[<span class="hljs-number">4</span>] <span class="hljs-keyword">as</span> day7 <span class="hljs-keyword">from</span> ( <span class="hljs-keyword">select</span> <span class="hljs-type">time</span>,ts_compare(avg_latency, <span class="hljs-number">86400</span>,<span class="hljs-number">172800</span>,<span class="hljs-number">604800</span>) <span class="hljs-keyword">as</span> diff <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(latency) <span class="hljs-keyword">as</span> avg_latency,date_trunc(<span class="hljs-string">'hour'</span>, __time__) <span class="hljs-keyword">as</span> <span class="hljs-type">time</span> <span class="hljs-keyword">from</span> log <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> <span class="hljs-type">time</span>) <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> <span class="hljs-type">time</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-type">time</span>) limit <span class="hljs-keyword">all</span>
按照 ProjectId 维度统计读写流量和延迟的变化
<span class="hljs-operator">*</span><span class="hljs-operator">|</span> <span class="hljs-keyword">select</span> <span class="hljs-built_in">sum</span>(InFlow)<span class="hljs-operator">/</span><span class="hljs-number">1024</span><span class="hljs-operator">/</span><span class="hljs-number">1024</span><span class="hljs-operator">/</span><span class="hljs-number">1024</span> <span class="hljs-keyword">as</span> in_flow,<span class="hljs-built_in">sum</span>(OutFlow)<span class="hljs-operator">/</span><span class="hljs-number">1024</span><span class="hljs-operator">/</span><span class="hljs-number">1024</span><span class="hljs-operator">/</span><span class="hljs-number">1024</span> <span class="hljs-keyword">as</span> out_flow,<span class="hljs-built_in">avg</span>(latency) <span class="hljs-keyword">as</span> latency,ProjectId <span class="hljs-keyword">from</span> log <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> ProjectId <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> in_flow <span class="hljs-keyword">desc</span> limit <span class="hljs-number">10</span>
按照 Status 维度和 ProjectId 的维度，统计平均延迟大于 <span class="hljs-number">200</span> 的读写流量
<span class="hljs-operator">*</span><span class="hljs-operator">|</span> <span class="hljs-keyword">select</span> <span class="hljs-built_in">sum</span>(InFlow)<span class="hljs-operator">/</span><span class="hljs-number">1024</span><span class="hljs-operator">/</span><span class="hljs-number">1024</span><span class="hljs-operator">/</span><span class="hljs-number">1024</span> <span class="hljs-keyword">as</span> in_flow,<span class="hljs-built_in">sum</span>(OutFlow)<span class="hljs-operator">/</span><span class="hljs-number">1024</span><span class="hljs-operator">/</span><span class="hljs-number">1024</span><span class="hljs-operator">/</span><span class="hljs-number">1024</span> <span class="hljs-keyword">as</span> out_flow,<span class="hljs-built_in">avg</span>(latency) <span class="hljs-keyword">as</span> latency,ProjectId <span class="hljs-keyword">from</span> log <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> Status,ProjectId <span class="hljs-keyword">having</span> latency <span class="hljs-operator">&gt;</span> <span class="hljs-number">200</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> in_flow <span class="hljs-keyword">desc</span>  limit <span class="hljs-number">10</span>
</code></pre>
<ol>
<li>查看近一周延迟同比的变化情况，开启了物化视图的请求，千亿以上数据秒内出结果，未开启的请求直接超时。</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24320f24713b412f8d48e0786fa0c375~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150904&amp;x-signature=P5Rx%2FNocJZleif3Rlxaz9bdxwBc%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f77648263c2945daa0dbac9ef863c84b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150904&amp;x-signature=gM6FxE4X0TdW%2B3WXBnAtSg0qEdE%3D" alt="图片" loading="lazy"/></p>
<ol start="2">
<li>按照 ProjectId 维度统计读写流量和延迟的变化，开启了物化视图的请求，千亿以上数据不到 400 毫秒返回结果，而未开启的请求 54 秒才返回，性能提升 100 倍以上。</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e207f96112a643168d6f7fdf094973f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150904&amp;x-signature=YJgUBcilvYIVO1QjOcAzqLElT7g%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f5385986fc04f528c1241df134dd814~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150904&amp;x-signature=cnUHEw7gdlExEWRrKt7xwyApPKU%3D" alt="图片" loading="lazy"/></p>
<ol start="3">
<li>按照 Status 维度和 ProjectId 的维度，统计平均延迟大于 200 的读写流量，由于统计的维度更多了，未使用物化视图的请求最后超时了，而使用物化视图后，800 多毫秒返回。</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1d4dbd843c344b187a5d9138aa4eb7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150904&amp;x-signature=u04GKFZC05kRMURR9PMj48O7tTg%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da3960642ae042998ddc8cfc6c370c9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150904&amp;x-signature=2n4fNB2rVV%2BUNT74x81muxUEzQA%3D" alt="图片" loading="lazy"/></p>
<p>有趣的是，创建物化视图时写的 SQL 和系统实际执行的 SQL 并不完全相同。这正是阿里云日志服务强大的智能优化器在幕后工作——它能自动识别和改写查询逻辑，让用户无需深入了解底层细节，就可以轻松为仪表盘查询加速。</p>
<p>在千亿级数据规模的实测中，采用物化视图的图表可以秒开，而相同的 SQL 若不使用物化视图，即使是最快的情况也需要 50 多秒，更多时候会直接超时无法返回结果。这不仅是性能的提升，更是体验的质的飞跃。理论上来说数据规模越大，加速效果越好。在数据规模更加庞大的另一个 Region 中，万亿级数据的 SQL 查询也能稳定在 3 秒左右完成，进一步验证了随着数据量的增长，物化视图带来的性能收益呈现出更为显著的加速效果。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9cd9316afaab4a51af259215c099e601~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764150904&amp;x-signature=BXJ1Kh0pAHJt4FpfKVA6csor3RM%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-9">展望</h2>
<p>在数据驱动的时代，<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aliyun.com%2Fproduct%2Fsls%3Fspm%3Da1z389.11499242.0.0.65452413PLWe13%26utm_content%3Dg_1000408139" target="_blank" title="https://www.aliyun.com/product/sls?spm=a1z389.11499242.0.0.65452413PLWe13&amp;utm_content=g_1000408139" ref="nofollow noopener noreferrer">阿里云日志服务</a>物化视图通过预计算技术，从根本上解决了大规模日志分析中的性能瓶颈和吞吐量限制问题，为实时日志分析提供了新的技术解决方案。未来，我们将继续在以下方向深耕：</p>
<ul>
<li>智能推荐：自动识别高频查询模式，一键生成最优物化视图</li>
<li>扩展使用场景：支持 join 算子的物化视图，支持数据删除场景</li>
<li>改写增强：支持表达式非精确匹配的改写</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>