<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>掘金文章推荐</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>一个帮助开发者成长的社区</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[搞懂“元数据”：给数据办一张“身份证”]]></title>    <link>https://juejin.cn/post/7582156219060387903</link>    <guid>https://juejin.cn/post/7582156219060387903</guid>    <pubDate>2025-12-11T07:07:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156219060387903" data-draft-id="7582169248095059974" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="搞懂“元数据”：给数据办一张“身份证”"/> <meta itemprop="keywords" content="数据分析,数据结构"/> <meta itemprop="datePublished" content="2025-12-11T07:07:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            搞懂“元数据”：给数据办一张“身份证”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:07:28.000Z" title="Thu Dec 11 2025 07:07:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>你是否经历过这样的场景：</p>
<p>同事发给你一个 <code>Excel</code> 表格，文件名叫 <code>data_final_v2.xlsx</code>。</p>
<p>你满怀期待地打开，结果发现：</p>
<ul>
<li>表头是 cryptic 的英文缩写（如 <code>c_amt</code>, <code>usr_stat</code>）；</li>
<li>有一列全是数字 <code>1, 0, 1, 0</code>，你猜不出这代表“男女”还是“是否活跃”；</li>
<li>你根本不知道这份数据是今天的，还是上个月的过期数据。</li>
</ul>
<p>这时候，你面对着一大堆数据，却感到两眼一抹黑。</p>
<p>为什么？因为这份数据缺少了“元数据”。</p>
<p>今天我们就来聊聊数据分析中这个至关重要，却常被忽视的概念---<strong>元数据</strong>（<code>Metadata</code>）。</p>
<h2 data-id="heading-0">1. 什么是元数据？</h2>
<p>在教科书里，元数据的定义只有冷冰冰的一句话：<strong>“描述数据的数据”</strong>（<code>Data about Data</code>）。</p>
<p>听起来有点绕？没关系，我们用生活中的例子来理解。</p>
<ol>
<li>听歌软件的例子</li>
</ol>
<p>当你在手机上听一首 MP3 音乐时：</p>
<ul>
<li><strong>数据</strong>（<code>Data</code>）：是你听到的声音旋律。</li>
<li><strong>元数据</strong>（<code>Metadata</code>）：是屏幕上显示的歌名、歌手、专辑封面、时长、文件大小（3MB）。</li>
</ul>
<p>如果没有元数据，你的歌单里就是一堆 <code>track01.mp3</code>, <code>track02.mp3</code>，你根本不知道该点哪首。</p>
<ol start="2">
<li>可乐的例子</li>
</ol>
<p>你去便利店买一瓶可乐：</p>
<ul>
<li><strong>数据</strong>（<code>Data</code>）：瓶子里黑色的液体（我们要喝的东西）。</li>
<li><strong>元数据</strong>（<code>Metadata</code>）：瓶身上的标签——配料表（含糖量）、生产日期、保质期、净含量（500ml）。</li>
</ul>
<p><strong>总结一下</strong>：
如果把“数据”比作“货物”，那么“元数据”就是挂在货物上的标签或说明书。</p>
<p>它不直接告诉你数据的内容（比如具体的销售额是多少），但它告诉你这串数字代表什么、从哪来、是不是可靠。</p>
<h2 data-id="heading-1">2. 元数据有什么用？</h2>
<p>如果你是一名数据分析师，或者工作中经常和报表打交道，元数据就是你的救命稻草。</p>
<p>它的价值主要体现在三个方面：</p>
<ol>
<li><strong>让你能“看懂”数据</strong>（<strong>解释性</strong>）：你在数据库里看到一个字段叫 <code>revenue</code>（收入），数值是 100。是人民币还是美元？是含税收入还是净收入？
<ul>
<li>没有元数据：全靠猜，或者打电话问离职的同事。</li>
<li>有元数据：数据字典里清楚写着：“<code>revenue</code>：含税销售总额，单位：人民币（元）”。</li>
</ul>
</li>
<li><strong>让你能“找到”数据</strong>（<strong>检索性</strong>）：老板让你分析“去年双十一的用户流失率”。
<ul>
<li>没有元数据：你要翻遍公司几百张表，打开一个个看。</li>
<li>有元数据：在系统里搜索“流失率”，马上弹出相关的表和字段。</li>
</ul>
</li>
<li><strong>让你敢“信任”数据</strong>（<strong>溯源性</strong>）：报表上的数字突然跌了50%，是业务出问题了，还是数据没更新？
<ul>
<li>没有元数据：怀疑人生，到处排查。</li>
<li>有元数据：看一眼“最后更新时间”，发现原来是昨晚的数据同步任务失败了，数据是旧的。</li>
</ul>
</li>
</ol>
<h2 data-id="heading-2">3. 元数据长什么样？</h2>
<p>在实际工作中，为了方便管理，我们通常把元数据<strong>分为三类</strong>。</p>
<p>让我们以一张 <strong>“公司销售记录表”</strong> 为例，看看它们分别是什么：</p>
<ol>
<li><strong>技术元数据</strong> (给电脑看的)：描述了数据的外貌特征。</li>
</ol>
<ul>
<li>它是啥： 记录数据的格式、结构、存储方式。</li>
<li>举个栗子：
<ul>
<li>表名： <code>sales_order_2023</code></li>
<li>字段类型： <code>order_id</code> 是文本型，<code>amount</code> 是浮点数值型。</li>
<li>长度限制： 这个字段最多存50个字。</li>
<li>主键： 订单号不能重复。</li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>业务元数据</strong> (给分析师看的)：描述了数据的内在含义（这是分析师最关心的）。</li>
</ol>
<ul>
<li>它是啥： 统一口径，解释业务逻辑。</li>
<li>举个栗子：
<ul>
<li>字段定义： “销售额”指扣除退款后的实际成交金额。</li>
<li>状态码解释： 字段 <code>status</code> 中，1=待支付，2=已发货，3=已完成。</li>
<li>数据所有者： 这张表有问题该找谁？（例如：找财务部的张三）。</li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>操作元数据</strong> (记录运行轨迹的)：描述了数据的生存状态。</li>
</ol>
<ul>
<li>它是啥： 记录数据是什么时候产生的，怎么变化的。</li>
<li>举个栗子：
<ul>
<li>创建时间： 2023年1月1日。</li>
<li>最近更新： 今天早上 08:00。</li>
<li>访问记录： 昨天有谁查过这张表。</li>
<li>血缘关系： 这张表的数据是从“ERP系统”抽过来的，并且会被“CEO日报”引用。</li>
</ul>
</li>
</ul>
<h2 data-id="heading-3">4. 手里有现成数据，如何生成元数据？</h2>
<p>假设你手头有一堆 <code>Excel</code> 或 <code>CSV</code> 数据，想把元数据整理出来，不用非得上百万的大数据系统，你可以分三步走：</p>
<h3 data-id="heading-4">4.1. 第一步：建立“数据字典”</h3>
<p>这是最基础、最有效的手段。</p>
<ul>
<li><strong>做法</strong>：新建一个 Excel 文件，或者在数据库建一张单独的表。</li>
<li><strong>内容</strong>：每一行记录一个字段的信息。</li>
<li>模板示例：</li>
</ul>





























<table><thead><tr><th>表名</th><th>字段名 (英文)</th><th>字段名 (中文)</th><th>数据类型</th><th>业务定义/备注</th><th>来源</th></tr></thead><tbody><tr><td>订单表</td><td><code>order_amt</code></td><td>订单金额</td><td>数字</td><td>不包含运费的商品总价</td><td>销售系统</td></tr><tr><td>订单表</td><td><code>pay_status</code></td><td>支付状态</td><td>文本</td><td>0=未付, 1=已付</td><td>支付网关</td></tr></tbody></table>
<p>有了这张表，以后谁再问你字段是什么意思，直接把这个文档甩给他！</p>
<h3 data-id="heading-5">4.2. 第二步：利用工具自动抓取 (技术元数据)</h3>
<p>如果你会一点 <code>Python</code> 或者 <code>SQL</code>：</p>
<ul>
<li><code>SQL</code>：大多数数据库都有 <code>information_schema</code>，你可以直接查询它来自动生成所有表名、字段名和类型的列表。</li>
<li><code>Python</code>：用 <code>Pandas</code> 读取数据 (<code>df.info()</code>)，可以快速获取列名、非空值数量和数据类型，作为元数据的底稿。</li>
</ul>
<h3 data-id="heading-6">4.3. 第三步：添加注释</h3>
<p>不要让元数据和数据分家。</p>
<ul>
<li>在 <code>Excel</code> 中：善用“批注”功能，或者利用第一行写代码，第二行写中文解释。</li>
<li>在 <code>SQL</code> 中：建表时一定要写 <code>COMMENT</code>。
<ul>
<li>错误示范：<code>CREATE TABLE orders (status INT);</code></li>
<li>正确示范：<code>CREATE TABLE orders (status INT COMMENT '状态: 0-未付, 1-已付');</code></li>
</ul>
</li>
</ul>
<h2 data-id="heading-7">5. 结语</h2>
<p>数据分析，往往不是难在**“分析”<strong>，而是难在</strong>“搞清楚数据到底是个啥”**。</p>
<p>元数据就像是图书馆的索引卡片，或者是药瓶上的说明书。</p>
<p>虽然整理元数据这件事情在开始时看起来有点繁琐（也就是大家常说的“脏活累活”），但它能极大地降低沟通成本，避免因为理解偏差导致的重大分析事故。</p>
<p>所以，从今天开始，当我们拿到一份新数据时，不妨先问一句：“这数据的元数据在哪里？”</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[🚀用 TRAE SOLO 一天不到就把老项目重构完是什么体验？]]></title>    <link>https://juejin.cn/post/7582200865907982370</link>    <guid>https://juejin.cn/post/7582200865907982370</guid>    <pubDate>2025-12-11T07:11:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582200865907982370" data-draft-id="7582232741686591523" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="🚀用 TRAE SOLO 一天不到就把老项目重构完是什么体验？"/> <meta itemprop="keywords" content="AI编程,Trae,AIGC"/> <meta itemprop="datePublished" content="2025-12-11T07:11:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coder_pig"/> <meta itemprop="url" content="https://juejin.cn/user/4142615541321928"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            🚀用 TRAE SOLO 一天不到就把老项目重构完是什么体验？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4142615541321928/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coder_pig
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:11:28.000Z" title="Thu Dec 11 2025 07:11:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">1. 引言</h2>
<p>四年前，百无聊赖之余，一时兴起，花了差不多一周，用 <strong>Python</strong> 写了个 "🐭 <strong>尾汁Markdown转换工具</strong>" → <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcoder-pig%2Fhzwz-markdown-wx" target="_blank" title="https://github.com/coder-pig/hzwz-markdown-wx" ref="nofollow noopener noreferrer">coder-pig/hzwz-markdown-wx</a>，用于：<strong>将Markdown文件转换成带样式的微信公众号文章HTML</strong>。</p>
<p>简单点说就是 "<strong>Markdown → 公众号</strong>" 的 <strong>排版工具</strong>，还顺手写了几篇介绍实现过程的文章：</p>
<ul>
<li><a href="https://juejin.cn/post/6899426534239682568" target="_blank" title="https://juejin.cn/post/6899426534239682568">《🐭喂汁，用Python写个专属Markdown转换工具》</a></li>
<li><a href="https://juejin.cn/post/6907550626197012487" target="_blank" title="https://juejin.cn/post/6907550626197012487">《🤡公号文章排版利器 | 🐁尾汁Markdown转换工具来咯~》</a></li>
<li><a href="https://juejin.cn/post/6941338759824670750" target="_blank" title="https://juejin.cn/post/6941338759824670750">《开发🐁尾汁Markdown转换工具 | 项目复盘》</a></li>
</ul>
<p>😆 当时自己整理的排版规范：</p>
<pre><code class="hljs language-text" lang="text"># 字号：正文(14、15)，注释-标注来源-超链接-代码(12)
# 字间距：(1、1.5)
# 行间距：(1.5、1.75、2)
# 页边距：即双端缩进、两端对齐，页面左右留白，建议缩进尺寸为1.0

# 字体颜色：标题 #000000；正文 #4C4C4C；标注 #888888；其他 #B2B2B2
# 正文也可以尝试：#545454；#3f3f3f；#7f7f7f；#2f2f2f
# 备注性文字：#a5a5a5

# Tips：除去字体颜色，公号排版颜色不宜超过三种，颜色一旦多起来，风格就很难定，2-3种尤佳；
# 比如我的三种颜色：蕾姆蓝#5A78EA；拉姆粉#FF4081；艾米莉亚：#C65BDA

# 符号系统：建立自己的符号系统，用作内容分割，比如用//////////作为正文大段落的分隔，- 作为段落小结的分隔，有时还可以使用一些表情符号来增加趣味性：http://cn.piliapp.com/symbol/

# 不管怎么排，要有自己固定的设置，如：段落和图片间空2行、图片大小控制在一屏版面的1/3面积内、一个段落不超过3行字、每当一屏版面文字太满时，拆解段落做分段或做一些highlight制造空间感等。

# 总而言之，尽量利用 简单的基础设置 去优化阅读体验，让整体排版看起来简洁但有序、不密集、不沉重、不压抑。

# 采用固定格式的公号封面图!!! 
# 固定版式形成强烈的个人特色，制作新的封面图只需置换文字和图片，好看又方便。
</code></pre>
<p>🤡 有在用，但用起来比较麻烦，每次排版都得：</p>
<p>打开PyCharm → 复制要排版的md文件 → 运行脚本 → 生成带样式的HTML文件 → 打开文件复制粘贴 → 浏览器打开公众号文章编辑页面 → F12定位到文章输入区域的代码 → 修改结点 → 粘贴代码 → 保存</p>
<p>😄 今年六月，看 <strong>首月3刀</strong> 开的 <strong>Trae</strong> 还剩挺多额度，于是花了半个小时，<strong>Vibe</strong> 了一个 <strong>排版静态页面，</strong> 并且用 <strong>掘金MCP</strong> 进行发布 → <a href="https://aicoding.juejin.cn/pens/7513888326441828402" target="_blank" title="https://aicoding.juejin.cn/pens/7513888326441828402">「掘掘子Markdown微信公众号排版工具」</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23c8d370a831404b96eba0fda8c9d491~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=QZnWbWTsbhCR%2F8%2Ffue4cxVlq57I%3D" alt="" loading="lazy"/></p>
<p>具体 Vibe 过程可以看 → <a href="https://juejin.cn/post/7514260735938248719" target="_blank" title="https://juejin.cn/post/7514260735938248719">【Trae + 掘金MCP】不写代码，靠嘴遁花0.5h定制公号排版工具</a></p>
<p>🤔 短文章还好，<strong>长文章样式全乱套</strong> (比如：无序列表加粗文本，会显示成 <strong>xx</strong>)，换了好几个模型，<strong>Vibe</strong> 了N次都没改好，问题越搞越多，前端这块，我又不是很熟，无奈放弃🤷‍♀️。后面还是用回了「<strong>Doocs</strong>」：</p>
<ul>
<li><strong>开源Github仓库</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdoocs%2Fmd" target="_blank" title="https://github.com/doocs/md" ref="nofollow noopener noreferrer">doocs/md</a></li>
<li><strong>在线编辑器地址</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Fmd.doocs.org%2F" target="_blank" title="https://md.doocs.org/" ref="nofollow noopener noreferrer">doocs</a></li>
</ul>
<p>😳 能用，但是有点过于 <strong>简洁</strong> (显得平平无奇)，我更怀念以前 <strong>自己编排的UI样式</strong> ...</p>
<p>前阵子 <strong>Google</strong> 发布了千呼万唤的 "<strong>哈基米3</strong> (<strong>Geimni</strong>)"，国内 <strong>自媒体</strong> 都是在吹它的 "<strong>前端能力</strong>" (看效果图确实挺6)：</p>
<ul>
<li><strong>能生成精确的 SVG 矢量图</strong>：包括复杂的动画 SVG (如：旋转风扇动画)，而非简单栅格图。</li>
<li><strong>3D 和动画</strong>：支持生成 Three.js 3D 模型、WebGL 着色器、CSS 动画等高级视觉效果。</li>
<li><strong>完成应用框架</strong>：能理解复杂的技术栈要求 (React、Three.js Fiber、TypeScript 等)，生成模块化、结构清晰的代码。</li>
<li><strong>标注修改</strong>：用户可以在生成的界面上用 "标注" 的方式指出要修改的地方 (画圈、画箭头、添加文字)，Gemini 3 会理解这些视觉标注并精确修改代码。这得益于它 多模态理解能力的显著提升 (对屏幕截图的理解准确率达到 72.7%，达到现有水平的两倍)。</li>
<li><strong>去 "AI味"</strong> ：排版、色彩搭配、组件结构看起来是 "精心设计" 的，而非生硬地套模版。</li>
</ul>
<p>😄 虽说，还同时发布了首个<strong>AI IDE</strong>—— <strong>Antigravity</strong> (反重力)，但 "<strong>登录问题</strong>" 就拦住了一堆人，然后各种 <strong>BUG</strong>，+ <strong>存在数据泄露风险</strong>，所以当时并没深度体验 <strong>Gemini 3</strong> 的编程能力到底是不是真的那么强 🤷‍♀️。</p>
<p>😏 然后，前阵子 "<strong>量大管饱</strong>" 的 <strong>Trae</strong> 发布公告："<strong>因服务中断，停止提供 Claude 模型的访问</strong>"，巧了，刚好换上 <strong>Gemini 3</strong>：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cdb879526b8462db92b5eb4b4f9cdda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=%2FyAqu5deeKTD7xeeMxBPxhcrARg%3D" alt="" loading="lazy"/></p>
<p>看更新日志，<strong>v3.0.0</strong> 这个大版本的新东西还挺多：</p>
<ul>
<li>「<strong>SOLO 模式正式上线，面向所有用户开放</strong>」主打单人高效率开发工作流，让用户能在一个界面处理任务、代码、智能体协作。</li>
<li>「<strong>内置两类智能体能力升级</strong>」<strong>SOLO Coder</strong> - 专精复杂工程任务：重构、调试、多文件跨模块修改，具备持续上下文理解能力，更适合中大型项目。<strong>SOLO Builder</strong> - 为快速构建产品原型而设计：界面、应用、后端都能快速产出初版，支持从 0→1 的自动化 Scaffold (脚手架) 与逻辑生成。</li>
<li>引入「<strong>多任务系统</strong>」<strong>并行</strong>-可在同一智能体中同时处理多个任务线程、<strong>拆解</strong>-AI 自动识别复杂任务并拆分子任务、<strong>折叠/展开</strong>-更清晰的项目管理结构、<strong>自动生成摘要</strong>-聊天/操作历史自动压缩成可读摘要，便于快速回顾。</li>
<li>「<strong>Diff View</strong>」集中展示所有由 AI 或用户生成的代码变更，支持跨文件比较与版本回溯，AI 改动更透明。</li>
</ul>
<p>😆 行吧，本节就尝试下用 <strong>TRAE SOLO + Gemini 3</strong> 让这个旧项目重新焕发光彩吧✨~</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c4e619834c24f01a011db06a3922ac8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=7Za8Y36WwCF8sbMqDgsDwn6725c%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>💡 因为是重构旧项目，所以选的 <strong>SOLO Coder</strong></p>
</blockquote>
<h2 data-id="heading-1">2. 实践过程</h2>
<p><strong>原始需求</strong></p>
<p>我想重构这个项目，改造成可以部署到服务器上的在线产品，类似于 <a href="https://link.juejin.cn?target=https%3A%2F%2Fmd.doocs.org%2F" target="_blank" title="https://md.doocs.org/" ref="nofollow noopener noreferrer">md.doocs.org/</a></p>
<p>这只是个 "<strong>方向</strong>"，还不是 "<strong>可执行需求</strong>"，通过下述 <strong>Prompt</strong> 让 <strong>Trae</strong> 引导我们进行 "<strong>需求澄清</strong>"：</p>
<pre><code class="hljs language-md" lang="md">请你先不要写代码，先扮演有经验的产品经理 + 架构师，帮助我把需求讲清楚，输出一份简要需求说明。具体请按下面步骤来做：

1）先用你自己的话复述一下我现在的目标，看你是否理解准确；

2）从目标用户、核心功能（MVP）、非功能需求（性能、部署方式）、技术栈偏好等维度，列出你需要向我确认的关键问题；

3）按“必须先回答 / 之后再说”做优先级排序，每个问题尽量简洁；

4）最后把这些问题整理成一个列表，方便我逐条回答。

注意：这一轮只做需求澄清，不要设计接口、不写代码也不要给文件结构，只输出复述 + 问题列表。
</code></pre>
<p><strong>Trae</strong> 的输出：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d43092064e394487b0e74670c1646a59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=onfeWbbVqBuK7xAIg0JVx1tKhgo%3D" alt="" loading="lazy"/></p>
<p>😳 卧槽，很多点都说到我的 "❤️<strong>趴</strong>" 上了，基于它给出的 "<strong>回答列表</strong>" 进行 "<strong>完形填空</strong>"：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a6a5ba5a9c94d6a91dc7efbd4b0f1e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=iz%2FAdmIL3ekN6t1Y60OTJQd9fdY%3D" alt="" loading="lazy"/></p>
<p>发送等Trae思考完，给我生成了一份 "<strong>重构计划</strong>" 的文档 (💡记得开启右上角的 <strong>Plan</strong> 选项)：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9ad6522d2af43a693deb59f44897b33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=teAcuUOqskkEmk62ulw5tK4kvXo%3D" alt="" loading="lazy"/></p>
<p>👍 文档写得 "<strong>头头是道</strong>"，三大块：<strong>架构设计</strong>、<strong>实施步骤</strong> 和 <strong>目录结构规划</strong> 都写得很清晰：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e0d16b436944a468143cdf9222b3e4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=0Mt3qQIZKp%2FX6qxDt4Q966oWMTI%3D" alt="" loading="lazy"/></p>
<p>按需进行修改，确定无误后，点解 "<strong>执行</strong>"，然后 <strong>Trae</strong> 会拆解成多个小任务 (Todo-List)，逐一完成：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/442e392308cb48b791a25e41895fa6e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=T3bPg4Ye0vN6U01KrjaN6Hgx03k%3D" alt="" loading="lazy"/></p>
<p>对于 "<strong>高风险命令</strong>" (比如这里的 <strong>move</strong>)，会停止往下执行，等待用户 <strong>审核确认</strong>。😮 Wow Human in Loop～</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/898115478d624d8bb17980f16bda710f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=hpFAczmG5Jv3E2ImwCbOGuw7P%2B4%3D" alt="" loading="lazy"/></p>
<p>😄 接着最小化让 <strong>Trae</strong> 在后台干活，需要 <strong>人工介入</strong> 的节点，右下角会有弹窗提示。没过多久，Trae 就跟我说它完成了！不是，这么快的吗？？？让它给我把项目跑起来，然后这 "<strong>前端页面</strong>" 还整得挺像模像样：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/636d5201be224906882e32985ebc3b20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=gyii12LLrMzSTyPZ5dlSD%2By1UPg%3D" alt="" loading="lazy"/></p>
<p>🤣 后面发现，其实就搭了个 <strong>基本骨架</strong>，很多东西没做，接着就是 "<strong>验收 + Vibe提问题</strong>"：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fc9c9d2ac7f49beb5b237ca3073b6f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=nTH%2BPIKzO9X3F4H2vZR76uiZd1k%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2cdf406f8503405594075d94509b61f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=6x7AWIXKWOY5CIScnKtkA0UOwBM%3D" alt="" loading="lazy"/></p>
<p>继续 <strong>Vibe</strong>，发现图片加载不出来，😄 这种大概率是 "<strong>图片防盗链</strong>"，一般是检查 <strong>请求头</strong> 中的 <strong>Referer</strong>，如果是 <strong>第三方域名</strong>，就会返回 <strong>403</strong>：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd8bc414313c46e8ad5e42d03622db5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=%2BrQddYBR4FyhfArPmlbfgYqlp1I%3D" alt="" loading="lazy"/></p>
<p>因为明确指出了 "<strong>病因</strong>"，Trae 两下就改好了，并详细讲述了 <strong>修复方案</strong> &amp; <strong>验证方法</strong>：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68aa8bf4071e487a823ae64419a08112~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=3eoC1e3GQcsml2d%2BLMJuJolZ9CI%3D" alt="" loading="lazy"/></p>
<p>👍 不得不说 <strong>Diff View</strong> 确实直观啊，😆 比 <strong>Cursor</strong> 容易看多了~</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c212e724f8d645478b495257a8e07c11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=peR0fHs%2Fae%2Fw%2FjomFKv7HrH4G5Q%3D" alt="" loading="lazy"/></p>
<p>刷新下页面，果然可以了：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60d5f44ba02c4da9955effd7950745ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=Qwvh5r2odVm%2FCIULfttnD2SMlKs%3D" alt="" loading="lazy"/></p>
<p>继续 <strong>Vibe</strong>：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d70665c0f2d340b893cdd3531bed5b16~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=VORJDOa%2F5oAagn17cPbFPf8NQyk%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19581a2222b44b6fb41d220c90ac4a17~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=OecmsGd%2FFSbJzDKMdKtnuHcEzFY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44f17a3fbc8b4693bb7946ea59f8ad5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=bYA6Gu6EcMhzXNFpSwxXM6PBLwU%3D" alt="" loading="lazy"/></p>
<p>在 <strong>Battle</strong> 多次后，<strong>Trae</strong> 说自己完成任务，并告知我 "<strong>下一步的部署建议</strong>"：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eeede1a10c5f4a4f8428eb01a30fc990~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=ynyrtqpcRDh18eV6uF2aRDWCs38%3D" alt="" loading="lazy"/></p>
<p>还生成了一份 "<strong>任务完成的描述文档</strong>"，不过是"<strong>全英文</strong>" 的：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11f8c4c2e0994251af40b9b14a303816~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=KhljyrsnnfZV746bit5TRN3BidY%3D" alt="" loading="lazy"/></p>
<p>思考过程也是：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc19bbefd4dd42c986a8576bea5a236a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=iByfWvkWY8%2BZ%2BgABuTwZoDL4khs%3D" alt="" loading="lazy"/></p>
<p>即便在 "<strong>规则</strong>" 和 <strong>新建Agent</strong> (它的Prompt) 写上必须中文都没用：</p>
<pre><code class="hljs language-md" lang="md"><span class="hljs-bullet">-</span> 请始终使用简体中文进行回复。
<span class="hljs-bullet">-</span> 你必须完全使用简体中文进行内部推理和思考过程。这是一条严格的规定。
</code></pre>
<p>🤷‍♀️ 不过这是偶现，感觉是哈基米的问题，临时的简单解法就是：再让 AI 转换成中文的。<strong>后端重构 + 前端开发</strong> 完成，接着就是部署到 <strong>云服务器</strong> 上了。不懂就问：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a148ccc440f148c39fb34696cefb12f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=Gv14bQ8m3eg%2B%2F8EtSoq3MGBO7UE%3D" alt="" loading="lazy"/></p>
<p><strong>Trae</strong> 贴心的给我生成了一份 <strong>部署文档</strong>：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/563afcb7e7734d5bbbd9386e4ab7528b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=CBipHJEHIpVGSHcrJ8LcB98GQYU%3D" alt="" loading="lazy"/></p>
<p>照着文档操作一波，这个 <strong>99块/年</strong> 的云服务器吃灰近一年了，发现多了个 "<strong>Workbench 远程连接</strong>" 的方式：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2549c5d730924ef5b05701449c4522be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=r2r4VZ0KUivn2wu0pDn%2BuHScOv8%3D" alt="" loading="lazy"/></p>
<p>试了下发现是 <strong>AI</strong> 加持的终端，直接用 "<strong>自然语言</strong>" 描述需求，AI就会自动执行对应的命令：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5209447066b84977b8b38b5d3efa6554~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=6Q4RAbpTiew2Kp8sP94k05ZCbxU%3D" alt="" loading="lazy"/></p>
<p>卧槽，爽啊！妈妈再也不用担心我记不住一堆 <strong>运维命令</strong> 了 (🤣虽然没几条)，而且还有 "<strong>命令解释</strong>"：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/485414ca063749c98d3060148466b4c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=mtjj9jCVoXMoQNrbGvOClTGs3V4%3D" alt="" loading="lazy"/></p>
<p>接着就是逐步CV部署文档里的东西发给它了，然后中途 <strong>Docker 拉镜像</strong> 一直超时，切了阿里云自带的 <strong>镜像加速器</strong> 也不行 (python可以、node:18不行)，后面直接检索了一波所有能用的镜像源，就好了~</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-string">"https://阿里的.mirror.aliyuncs.com"</span><span class="hljs-punctuation">,</span>
<span class="hljs-string">"https://docker.1panel.live"</span><span class="hljs-punctuation">,</span>
<span class="hljs-string">"http://mirrors.ustc.edu.cn/"</span><span class="hljs-punctuation">,</span>
<span class="hljs-string">"http://mirror.azure.cn/"</span><span class="hljs-punctuation">,</span>
<span class="hljs-string">"https://hub.rat.dev/"</span><span class="hljs-punctuation">,</span>
<span class="hljs-string">"https://docker.ckyl.me/"</span><span class="hljs-punctuation">,</span>
<span class="hljs-string">"https://docker.chenby.cn"</span><span class="hljs-punctuation">,</span>
<span class="hljs-string">"https://docker.hpcloud.cloud"</span><span class="hljs-punctuation">,</span>
<span class="hljs-string">"https://docker.m.daocloud.io"</span>
</code></pre>
<p>当然，还有一些其它的报错，AI终端搞不定的，就CV发给 <strong>Trae</strong>：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57acd8901d784382b67f4bbbae0c6c9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=nqzuaCIlimbntru%2Bw6LV0D5L%2FcA%3D" alt="" loading="lazy"/></p>
<p><strong>Docker Compose</strong> 成功构建并启动了容器服务：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f7178ec7709469f8a589b93ce192cb4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=tnoPMu81c6UlSlDE4zIwem1AlJs%3D" alt="" loading="lazy"/></p>
<p><strong>curl <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A8000" target="_blank" title="http://127.0.0.1:8000" ref="nofollow noopener noreferrer">http://127.0.0.1:8000</a></strong> 测试下服务是否正常运行：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83f5ae236c1544c9960aa9694988ef00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=WJHfc7zCSYb2%2FPWHgf4rc33WM5k%3D" alt="" loading="lazy"/></p>
<p>外部浏览器通过 <strong>公网IP</strong> 访问，报错 <strong>ERR_EMPTY_RESPONSE</strong>，直接问 <strong>AI</strong>：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5acf5048cabb4b85b51dae1609dd1adf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=DtSa3A8DHs8Ec8zfJiQDQpmhdI0%3D" alt="" loading="lazy"/></p>
<p>无脑 <strong>Ctrl</strong> <strong>↩</strong>︎ 让它验证就好了，最后发现是 "<strong>云服务商的安全组没开端口</strong>"，还耐心给出了解决步骤，我哭死：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/023cb1528a08494a919de7c1a35f2625~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=brwnG1anCFj%2Fn9o7DUAmsy0uaCI%3D" alt="" loading="lazy"/></p>
<p>配置完，再次刷新页面，好了👏：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/189f43d1346f44399656c5319cb1eb58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJfcGln:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041888&amp;x-signature=SrvFbmArGvU%2FbDP83MelZyAef2o%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">3. 小结</h2>
<p>🤡 爽！太爽了！本来想着 "<strong>后端重构 + 前端开发 + 部署</strong>"，至少得折腾个一星期吧，结果：</p>
<ul>
<li>【 <strong>TRAE SOLO</strong>】应该是内置了 <strong>产品开发流水线</strong> 相关的 <strong>完整工作流</strong>，🤣 2333，我精心准备的 "<strong>全栈开发落地方方论</strong>" 还没开始实施，它就把前面这两项干完了。</li>
<li>配合【<strong>云服务商提供的AI终端</strong>】，部署起来也是轻轻松松。换以前，得记一堆 <strong>运维命令</strong> (不同OS的命令和配置还可能不同)，经常陷在 <strong>报错 → 搜索 → 修改 → 验证 → 再报错</strong>... 的反复循环中怀疑人生。</li>
</ul>
<p>🤷‍♀️ 不得不感叹，AI 发展之迅猛啊~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.js 编程实战：深入掌握异步性能优化]]></title>    <link>https://juejin.cn/post/7582156410320207882</link>    <guid>https://juejin.cn/post/7582156410320207882</guid>    <pubDate>2025-12-11T07:22:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156410320207882" data-draft-id="7582118218649387034" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js 编程实战：深入掌握异步性能优化"/> <meta itemprop="keywords" content="后端,Node.js,Trae"/> <meta itemprop="datePublished" content="2025-12-11T07:22:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="程序员爱钓鱼"/> <meta itemprop="url" content="https://juejin.cn/user/2799775299157614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js 编程实战：深入掌握异步性能优化
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2799775299157614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    程序员爱钓鱼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:22:00.000Z" title="Thu Dec 11 2025 07:22:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>Node.js 以事件驱动和非阻塞 I/O 闻名，是构建高并发服务器的理想选择。但这并不意味着所有异步代码都能自动获得最佳性能。许多开发者在实际项目中忽视了异步性能的关键点，导致 Node.js 应用出现延迟增加、吞吐量降低甚至阻塞事件循环的问题。</p>
</blockquote>
<p>要想真正发挥 Node.js 的性能优势，就必须深入理解异步机制并采用更合理的优化策略。本文将从事件循环、I/O 模型、Promise/async 的使用方式、并发策略等方面系统解析如何优化 Node.js 的异步性能。</p>
<hr/>
<h2 data-id="heading-0">一、理解异步性能优化的核心：事件循环不是无限的</h2>
<p>Node.js 单线程的本质决定了事件循环是关键资源。任何阻塞事件循环的代码都会影响整体性能。</p>
<p>例如：</p>
<ul>
<li>大量同步计算</li>
<li>大文件的同步读写</li>
<li>复杂的 JSON.parse</li>
<li>频繁 await 阻塞微任务队列</li>
</ul>
<p>因此，优化异步性能的第一步是：避免阻塞事件循环，为 CPU 密集型任务选择合适的执行方式。</p>
<hr/>
<h2 data-id="heading-1">二、避免不必要的同步操作</h2>
<p>Node.js 虽然提供了许多同步 API（如 fs.readFileSync），但它们会完全阻塞事件循环，导致其他请求无法处理。</p>
<p>例如：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> data = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">"big.txt"</span>); <span class="hljs-comment">// 阻塞整个线程</span>
</code></pre>
<p>在线上服务中，这类同步操作应彻底避免，全部改用异步版本：</p>
<pre><code class="hljs language-js" lang="js">fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">"big.txt"</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {});
</code></pre>
<p>即便使用 Promise 或 async/await，也一定要基于异步 API，否则本质仍然是同步阻塞。</p>
<hr/>
<h2 data-id="heading-2">三、合理利用 Promise 并发处理</h2>
<p>如果多个异步任务彼此独立，不应串行执行。错误示例：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">await</span> <span class="hljs-title function_">taskA</span>();
<span class="hljs-keyword">const</span> b = <span class="hljs-keyword">await</span> <span class="hljs-title function_">taskB</span>();
<span class="hljs-keyword">const</span> c = <span class="hljs-keyword">await</span> <span class="hljs-title function_">taskC</span>();
</code></pre>
<p>这是典型的“同步写法导致异步变串行”，性能会明显下降。</p>
<p>更高效的方式：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> [a, b, c] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">taskA</span>(), <span class="hljs-title function_">taskB</span>(), <span class="hljs-title function_">taskC</span>()]);
</code></pre>
<p>适用场景：</p>
<ul>
<li>多个数据库查询</li>
<li>多个文件操作</li>
<li>多个 API 请求</li>
</ul>
<p>Promise.all 是提升异步性能的最重要方法之一。</p>
<hr/>
<h2 data-id="heading-3">四、正确处理大量并发任务：限制并发数量</h2>
<p>虽然 Promise.all 可以并发所有任务，但若任务数量巨大（如 10 万个文件处理），一次性并发会造成资源耗尽。</p>
<p>在高并发任务中，应使用“并发池”（Concurrency Pool）控制并发数量。例如使用 p-limit 或自定义队列。</p>
<p>示例（p-limit）：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> limit = <span class="hljs-built_in">require</span>(<span class="hljs-string">"p-limit"</span>)(<span class="hljs-number">10</span>);

<span class="hljs-keyword">const</span> tasks = urls.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">url</span>) =&gt;</span>
  <span class="hljs-title function_">limit</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">fetch</span>(url))
);

<span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(tasks);
</code></pre>
<p>这样可以：</p>
<ul>
<li>避免网络连接耗尽</li>
<li>避免过多文件描述符占用</li>
<li>避免事件循环被过多 Promise 微任务淹没</li>
</ul>
<p>这是工程级代码中非常关键的性能优化手段。</p>
<hr/>
<h2 data-id="heading-4">五、减少不必要的 await，提高事件循环吞吐量</h2>
<p>await 会让当前 async 函数暂停，这对业务逻辑清晰很有用，但在高并发情况下可能会降低整体吞吐量。</p>
<p>例如：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> list) {
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">process</span>(item); <span class="hljs-comment">// 串行执行</span>
}
</code></pre>
<p>建议：</p>
<p>如果任务彼此不依赖，用并发方式：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(list.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> <span class="hljs-title function_">process</span>(item)));
</code></pre>
<p>如果任务数量大，用并发池：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">await</span> <span class="hljs-title function_">asyncPool</span>(<span class="hljs-number">10</span>, list, <span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> <span class="hljs-title function_">process</span>(item));
</code></pre>
<hr/>
<h2 data-id="heading-5">六、利用异步 I/O 模型而非 CPU 计算（必要时使用 worker_threads）</h2>
<p>Node.js 异步性能主要来自高效的 I/O 模型，而不是 CPU 计算能力。
因此，不应在主线程执行 CPU 密集型任务，例如：</p>
<ul>
<li>图像处理</li>
<li>视频转码</li>
<li>加密/解密</li>
<li>大量数据压缩</li>
</ul>
<p>这些操作会阻塞事件循环。</p>
<p>解决方案：</p>
<ul>
<li>使用 worker_threads</li>
<li>通过 Rust/Go/Python 执行 CPU 操作并通过 API 集成</li>
<li>开发 C++ addon 扩展</li>
</ul>
<p>示例（worker_threads）：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">Worker</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"worker_threads"</span>);

<span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">"./heavy-task.js"</span>, { <span class="hljs-attr">workerData</span>: input });
</code></pre>
<p>这样主线程保持轻量，只负责处理 I/O，提升整体响应速度。</p>
<hr/>
<h2 data-id="heading-6">七、优化 Promise 与 async/await 的微任务行为</h2>
<p>大量 Promise 会在微任务队列中堆积，导致 event loop 延迟增加。</p>
<p>例如：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000</span>; i++) {
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {});
}
</code></pre>
<p>这会让微任务队列暴涨。
优化方法：</p>
<ol>
<li>使用 setImmediate 或 setTimeout 让任务进入宏任务队列</li>
<li>批处理任务，将大量 Promise 合并处理</li>
<li>避免深层链式 Promise</li>
</ol>
<p>这对高负载服务非常重要。</p>
<hr/>
<h2 data-id="heading-7">八、使用流（Stream）提升大文件处理性能</h2>
<p>处理大文件时，不应使用一次性读取方式：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> data = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">"bigfile"</span>);
</code></pre>
<p>应使用流逐块读取：</p>
<pre><code class="hljs language-js" lang="js">fs.<span class="hljs-title function_">createReadStream</span>(<span class="hljs-string">"bigfile"</span>)
  .<span class="hljs-title function_">on</span>(<span class="hljs-string">"data"</span>, <span class="hljs-function"><span class="hljs-params">chunk</span> =&gt;</span> {})
  .<span class="hljs-title function_">on</span>(<span class="hljs-string">"end"</span>, <span class="hljs-function">() =&gt;</span> {});
</code></pre>
<p>流的优势：</p>
<ul>
<li>内存占用更低</li>
<li>对事件循环更友好</li>
<li>支持管道加速数据传输</li>
</ul>
<p>适用于日志处理、大文件上传、视频转码等场景。</p>
<hr/>
<h2 data-id="heading-8">九、避免对象结构不稳定导致 V8 性能下降</h2>
<p>Node.js 使用 V8 引擎，V8 依赖“隐藏类”优化对象性能。
在大量对象处理中，如果频繁改变结构，性能会显著下降。</p>
<p>错误示例：</p>
<pre><code class="hljs language-js" lang="js">obj.<span class="hljs-property">a</span> = <span class="hljs-number">1</span>;
<span class="hljs-keyword">delete</span> obj.<span class="hljs-property">a</span>;
obj.<span class="hljs-property">b</span> = <span class="hljs-number">2</span>;
</code></pre>
<p>优化方式：</p>
<ul>
<li>保持对象结构稳定</li>
<li>统一初始化字段</li>
<li>避免 delete，使用 undefined 替代</li>
</ul>
<p>这类优化在线上高性能服务中非常重要。</p>
<hr/>
<h2 data-id="heading-9">十、总结：高性能异步代码的关键要点</h2>
<ol>
<li>避免阻塞事件循环</li>
<li>使用异步 API，而不是同步 API</li>
<li>使用 Promise.all 并发执行独立任务</li>
<li>使用并发池控制大量任务</li>
<li>CPU 密集任务交给 worker_threads</li>
<li>大文件使用 Stream 处理</li>
<li>减少过多 microtask 的堆积</li>
<li>保持对象结构稳定</li>
</ol>
<p>掌握这些策略，才能真正发挥 Node.js 异步架构的优势，构建高吞吐量、高稳定性的服务。</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.js 编程实战：创建 HTTP/HTTPS 服务器全解析]]></title>    <link>https://juejin.cn/post/7582149417769304114</link>    <guid>https://juejin.cn/post/7582149417769304114</guid>    <pubDate>2025-12-11T07:23:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582149417769304114" data-draft-id="7582182817108082714" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js 编程实战：创建 HTTP/HTTPS 服务器全解析"/> <meta itemprop="keywords" content="后端,Node.js,Trae"/> <meta itemprop="datePublished" content="2025-12-11T07:23:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="程序员爱钓鱼"/> <meta itemprop="url" content="https://juejin.cn/user/2799775299157614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js 编程实战：创建 HTTP/HTTPS 服务器全解析
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2799775299157614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    程序员爱钓鱼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:23:07.000Z" title="Thu Dec 11 2025 07:23:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>Node.js 的核心能力之一就是快速创建高性能的服务器。通过内置的 <code>http</code> 和 <code>https</code> 模块，你可以在几行代码内搭建功能完善的 Web 服务。本文将系统讲解如何在 Node.js 中创建 HTTP 与 HTTPS 服务器，包括基础用法、请求处理、HTTPS 证书配置，以及性能与安全优化实践。</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">一、Node.js HTTP 服务器基础</h2>
<p>Node.js 内置的 <code>http</code> 模块让创建 HTTP 服务器非常简单。</p>
<h3 data-id="heading-1">1. 基本示例</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);

<span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-property">statusCode</span> = <span class="hljs-number">200</span>;
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>);
  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">"Hello Node.js HTTP Server!"</span>);
});

server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Server running at http://localhost:3000/"</span>);
});
</code></pre>
<p>说明：</p>
<ul>
<li><code>http.createServer</code> 返回一个服务器实例</li>
<li>回调函数 <code>(req, res)</code> 在每次请求到来时触发</li>
<li><code>req</code> 包含请求信息，<code>res</code> 用于发送响应</li>
<li><code>server.listen</code> 绑定端口并启动服务器</li>
</ul>
<hr/>
<h2 data-id="heading-2">二、处理请求与响应</h2>
<p>HTTP 请求包含方法、URL、头信息和请求体。响应也可以设置状态码、头信息及数据。</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">method</span> === <span class="hljs-string">"GET"</span> &amp;&amp; req.<span class="hljs-property">url</span> === <span class="hljs-string">"/"</span>) {
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"text/html"</span> });
    res.<span class="hljs-title function_">end</span>(<span class="hljs-string">"&lt;h1&gt;Welcome Home&lt;/h1&gt;"</span>);
  } <span class="hljs-keyword">else</span> {
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">404</span>, { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"text/plain"</span> });
    res.<span class="hljs-title function_">end</span>(<span class="hljs-string">"Page Not Found"</span>);
  }
});
</code></pre>
<p>技巧与建议：</p>
<ul>
<li>对请求进行路由判断，区分不同路径和方法</li>
<li>响应头要根据内容类型设置</li>
<li>大型项目可使用第三方框架如 Express 做路由和中间件管理</li>
</ul>
<hr/>
<h2 data-id="heading-3">三、Node.js HTTPS 服务器</h2>
<p>在实际生产环境中，HTTPS 已经是必须。Node.js 提供 <code>https</code> 模块支持加密传输。</p>
<h3 data-id="heading-4">1. 准备证书</h3>
<p>创建 HTTPS 服务器前，需要拥有：</p>
<ul>
<li><code>key.pem</code>：私钥文件</li>
<li><code>cert.pem</code>：证书文件（可以用自签名证书做测试）</li>
</ul>
<p>可以使用 OpenSSL 生成测试证书：</p>
<pre><code class="hljs language-bash" lang="bash">openssl req -nodes -new -x509 -keyout key.pem -out cert.pem
</code></pre>
<hr/>
<h3 data-id="heading-5">2. 创建 HTTPS 服务器</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> https = <span class="hljs-built_in">require</span>(<span class="hljs-string">"https"</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);

<span class="hljs-keyword">const</span> options = {
  <span class="hljs-attr">key</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">"key.pem"</span>),
  <span class="hljs-attr">cert</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">"cert.pem"</span>)
};

<span class="hljs-keyword">const</span> server = https.<span class="hljs-title function_">createServer</span>(options, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"text/plain"</span> });
  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">"Hello Node.js HTTPS Server!"</span>);
});

server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3443</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"HTTPS Server running at https://localhost:3443/"</span>);
});
</code></pre>
<p>注意事项：</p>
<ul>
<li>HTTPS 必须提供证书和私钥</li>
<li>在生产环境中，请使用由可信 CA 签发的证书</li>
<li>端口一般为 443（HTTP 默认端口为 80）</li>
</ul>
<hr/>
<h2 data-id="heading-6">四、性能优化建议</h2>
<p>虽然 Node.js 的 <code>http</code> 和 <code>https</code> 模块足够轻量，但在高并发场景下，仍然可以优化：</p>
<ol>
<li><strong>开启 Keep-Alive</strong>
保持 TCP 连接，减少握手开销：</li>
</ol>
<pre><code class="hljs language-js" lang="js">res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"Connection"</span>, <span class="hljs-string">"keep-alive"</span>);
</code></pre>
<ol start="2">
<li><strong>使用 gzip 压缩</strong>
减少传输数据量，提高响应速度：</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> zlib = <span class="hljs-built_in">require</span>(<span class="hljs-string">"zlib"</span>);
res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">"Content-Encoding"</span>: <span class="hljs-string">"gzip"</span> });
res.<span class="hljs-title function_">end</span>(zlib.<span class="hljs-title function_">gzipSync</span>(<span class="hljs-string">"Hello World!"</span>));
</code></pre>
<ol start="3">
<li><strong>利用集群（cluster）提升 CPU 利用率</strong>
Node.js 单线程模型可以通过 cluster 模块启动多进程：</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> cluster = <span class="hljs-built_in">require</span>(<span class="hljs-string">"cluster"</span>);
<span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">"os"</span>);

<span class="hljs-keyword">if</span> (cluster.<span class="hljs-property">isMaster</span>) {
  <span class="hljs-keyword">const</span> cpuCount = os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; cpuCount; i++) {
    cluster.<span class="hljs-title function_">fork</span>();
  }
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// worker 进程启动 HTTP/HTTPS 服务器</span>
}
</code></pre>
<ol start="4">
<li><strong>使用缓存</strong>
对静态文件或接口数据使用内存缓存或 CDN，降低重复计算和 I/O 压力。</li>
</ol>
<hr/>
<h2 data-id="heading-7">五、常见应用场景</h2>
<ul>
<li>搭建静态文件服务器</li>
<li>提供 RESTful API 服务</li>
<li>接入 WebSocket 做实时通信</li>
<li>内网工具或微服务</li>
<li>HTTPS 接入支付、认证等安全场景</li>
</ul>
<p>Node.js 的 HTTP/HTTPS 服务器能力非常适合高并发和轻量服务场景。</p>
<hr/>
<h2 data-id="heading-8">六、总结</h2>
<p>通过本文，你应该掌握了：</p>
<ol>
<li>HTTP 服务器的创建与请求处理</li>
<li>HTTPS 服务器的证书配置和创建</li>
<li>异步请求处理与响应机制</li>
<li>高性能与安全优化策略</li>
</ol>
<p>Node.js 内置的 HTTP/HTTPS 模块简单高效，非常适合构建高性能微服务和 API。
理解这些基础，为使用 Express、Koa 等框架打下了坚实的底层基础。</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[从需求到上架，现代 iOS 开发流程的工程化方法论]]></title>    <link>https://juejin.cn/post/7582149417769205810</link>    <guid>https://juejin.cn/post/7582149417769205810</guid>    <pubDate>2025-12-11T07:10:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582149417769205810" data-draft-id="7582202149909397513" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="从需求到上架，现代 iOS 开发流程的工程化方法论"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-11T07:10:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="疯狂的程序猴"/> <meta itemprop="url" content="https://juejin.cn/user/2760245749234147"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            从需求到上架，现代 iOS 开发流程的工程化方法论
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2760245749234147/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    疯狂的程序猴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:10:08.000Z" title="Thu Dec 11 2025 07:10:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>近年来，移动应用的开发模式不断演化，iOS 开发流程不再是“写代码 → 打包 → 上架”的线性结构，而是由需求分析、架构设计、证书体系、构建自动化、测试分发、审查提交等多个环节组成的工程闭环。团队规模越大、使用跨端技术越多、操作系统越分散（Windows / Linux / macOS 混合使用），整个流程越容易因为签名链路不透明、证书协作不一致或上架行为难统一而出现断点。</p>
<p>基于实际项目经验，本文结合现代团队普遍采用的工具链与工程治理方式，对 iOS 开发流程进行体系级拆解。</p>
<hr/>
<h2 data-id="heading-0"><strong>一、需求阶段：确定功能边界与能力需求</strong></h2>
<p>iOS 开发流程的第一步并不是写代码，而是回答几个关键问题：</p>
<ul>
<li>应用需要哪些原生能力？（Push、定位、相机、苹果登录等）</li>
<li>是否需要后台能力？（App Groups、APNs、Universal Links 等）</li>
<li>应用是否多语言、多区域部署？</li>
<li>是否需要配套的 TestFlight 流程？</li>
<li>Bundle ID 是否需要规划多个环境版本？</li>
</ul>
<p>这些能力都与签名体系相关，因此前期架构设计要明确应用范围，否则后期修改会牵动证书、描述文件与配置项，导致返工。</p>
<hr/>
<h2 data-id="heading-1"><strong>二、工程初始化：配置 Bundle ID 与证书体系</strong></h2>
<p>iOS 工程本质是一套高度依赖“身份”的项目结构，因此初始化阶段要特别关注证书、描述文件与 Bundle ID 的一致性。</p>
<h3 data-id="heading-2"><strong>1. Bundle ID 创建与管理</strong></h3>
<p>Bundle ID 是整个签名链路的入口。
为了避免多人重复创建、命名混乱或遗留工程导致的冲突，我通常会通过工具确认账号内已有的 Bundle ID，例如：</p>
<ul>
<li>使用 <strong>Appuploader 的 Bundle ID 查看功能</strong> 检查当前账号下已有的标识符</li>
<li>确认是否存在重复命名或相似结构导致的冲突</li>
<li>在团队中记录 Bundle ID 的用途与能力配置</li>
</ul>
<p>清晰的 Bundle ID 体系能让团队避免“构建成功但无法上架”的问题。
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96e4e0f2d49841308787112612048d00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC55qE56iL5bqP54y0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041808&amp;x-signature=3Yigs%2Fl6Du03JcaRF29%2By1hDBug%3D" alt="bid" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-3"><strong>2. 证书与描述文件的生成与协作</strong></h3>
<p>证书是团队协作中最容易混乱的部分。当成员使用不同电脑、不同操作系统时，证书共享与解析尤为关键。</p>
<p>在跨端项目或后台团队参与打包的情况下，我会使用：</p>
<ul>
<li><strong>Appuploader 的证书生成能力</strong>：可在 Windows / Linux / macOS 创建开发/发布证书，避免团队依赖单一 Mac。</li>
<li><strong>mobileprovision 文件查看与解析</strong>：用于检查绑定证书、Bundle ID、Team ID、Capabilities 等信息。</li>
</ul>
<p>提前解析这些文件可以减少签名链路错误，尤其在多人协作或 CI 构建场景中非常重要。
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/583452dc01ba41f7ad6cf54824084021~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC55qE56iL5bqP54y0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041808&amp;x-signature=mAgwpwaSfUsmPwl%2FyQGJkGhvvg0%3D" alt="证书生成" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7618435448e5475a9ac906fb7be43a48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC55qE56iL5bqP54y0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766041808&amp;x-signature=33r3peUUhX3YJopCjHxgRWT3V%2B0%3D" alt="文件查看" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-4"><strong>三、开发阶段：工程结构、模块划分与跨端兼容</strong></h2>
<p>无论使用 Swift、Objective-C，还是 uni-app、Flutter、React Native，开发阶段需关注以下工程问题：</p>
<h3 data-id="heading-5"><strong>1. 目录结构与模块边界清晰</strong></h3>
<p>工程结构将影响后续调试与构建自动化，例如：</p>
<ul>
<li>独立的资源模块</li>
<li>清晰的业务模块划分</li>
<li>独立的配置文件（Info.plist、构建脚本等）</li>
</ul>
<p>良好的结构能减少 TF 处理和上架过程中的潜在问题。</p>
<h3 data-id="heading-6"><strong>2. 环境切换机制</strong></h3>
<p>许多团队在构建多个环境时，只修改某一处配置（如 API 地址），但忘记修改：</p>
<ul>
<li>Info.plist 字段</li>
<li>Bundle ID</li>
<li>描述文件绑定</li>
</ul>
<p>导致不同环境构建混杂，甚至引发苹果审核的阻断性拒绝。</p>
<hr/>
<h2 data-id="heading-7"><strong>四、测试阶段：从本地调试到 TF 分发</strong></h2>
<p>测试阶段不仅是功能验证，同时也是“签名链路验证”。</p>
<h3 data-id="heading-8"><strong>1. 本地真机测试</strong></h3>
<p>在某些项目中，我会通过 Appuploader 的功能执行：</p>
<ul>
<li>USB 安装 IPA</li>
<li>读取测试设备 UDID（便于更新开发描述文件）</li>
</ul>
<p>这种方式比 TestFlight 更快适合在开发阶段持续验证。</p>
<hr/>
<h3 data-id="heading-9"><strong>2. TestFlight 测试（中后期验证）</strong></h3>
<p>TF 是正式发布前的重要阶段，它能暴露：</p>
<ul>
<li>签名问题</li>
<li>权限配置问题</li>
<li>构建兼容性问题</li>
</ul>
<p>在上传 TF 前，我一般会检查 IPA 内的信息，确保：</p>
<ul>
<li>Info.plist 字段完整</li>
<li>mobileprovision 使用正确的发布证书</li>
<li>Bundle ID 与 App Store Connect 配置一致</li>
</ul>
<p>这些检查可通过 Appuploader 的 IPA 内容查看功能在任意系统执行。</p>
<hr/>
<h2 data-id="heading-10"><strong>五、构建与自动化：流水线如何与签名体系协作</strong></h2>
<p>现代团队通常采用 CI/CD（GitLab CI、GitHub Actions、Jenkins 等）进行构建。</p>
<p>常见流程：</p>
<ol>
<li>CI 执行工程构建（通常需要 macOS Runner）</li>
<li>构建产物（IPA）上传至文件存储</li>
<li>触发上传流程（可独立执行）</li>
</ol>
<p>在自动化上传环节，我通常会选择跨平台方式，例如：</p>
<h3 data-id="heading-11"><strong>使用 Appuploader CLI 上传 IPA</strong></h3>
<p>示例：</p>
<pre><code class="hljs language-css" lang="css">appuploader_cli -u dev<span class="hljs-keyword">@icloud</span>.com -p xxx-xxx -c <span class="hljs-number">1</span> -f output.ipa
</code></pre>
<p>理由包括：</p>
<ul>
<li>可在 <strong>Windows / Linux / macOS</strong> 运行</li>
<li>不依赖 Transporter 或 Xcode</li>
<li>易集成到自动化脚本</li>
<li>上传动作不携带 Mac 设备信息</li>
</ul>
<p>这让团队能够将上传与构建拆分，不再被上传节点限制生产效率。</p>
<hr/>
<h2 data-id="heading-12"><strong>六、上架前准备：检查点比上传本身更重要</strong></h2>
<p>在提交审核前，工程侧需要确认以下内容：</p>
<ul>
<li>Bundle ID、描述文件、证书一致</li>
<li>IPA 结构无误</li>
<li>权限声明清晰（定位、相机、蓝牙等）</li>
<li>隐私政策与权限说明写入 Info.plist</li>
<li>所有调试代码已关闭</li>
<li>上架截图、关键词、多语言信息准备完整</li>
</ul>
<p>在这些节点中，“IPA 内部配置检查”尤为关键，因为问题通常隐藏在内部结构中。</p>
<p>使用 Appuploader 查看 IPA 内容可以提前发现配置错误，避免提交失败后再返工。</p>
<hr/>
<h2 data-id="heading-13"><strong>发布阶段：上传、处理、审核</strong></h2>
<p>上传阶段是最敏感也最容易受制于工具链的部分。
跨平台团队常见问题包括：</p>
<ul>
<li>没有 Mac 无法上传</li>
<li>CI 无法调用 Transporter</li>
<li>上传凭据分散在不同成员设备中</li>
</ul>
<p>通过 Appuploader CLI 或 API 来执行上传可以让此环节更加可控，并且执行逻辑可以被脚本化与自动化。</p>
<p>上传后，应用进入：</p>
<ul>
<li><strong>Processing（构建处理）</strong></li>
<li><strong>审核阶段</strong></li>
</ul>
<p>这部分不在开发控制范围内，但良好的工程流程能减少被拒风险。</p>
<hr/>
<h2 data-id="heading-14"><strong>现代 iOS 开发生命链已经转向“工具协作”模式</strong></h2>
<p>过去 iOS 开发主要依赖单台 Mac 与 Xcode，本地处理所有环节。
如今的工程体系更加分布式、多端化、自动化，也更依赖工具链协作。</p>
<p>在现代 iOS 流程中，最关键的是：</p>
<ul>
<li>明确 Bundle ID 与证书体系</li>
<li>构建过程自动化</li>
<li>IPA 内容可检查、可追踪</li>
<li>上传流程可跨平台执行</li>
<li>测试流程快速可重复</li>
<li>提交审核时结构清晰无误</li>
</ul>
<p>最终目标不是替换某个工具，而是构建一个能让任何成员理解、能被自动化执行、能跨平台工作的 iOS 开发与发布流程。
参考链接：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.appuploader.net%2Ftutorial%2Fzh%2F1%2F1.html" target="_blank" title="https://www.appuploader.net/tutorial/zh/1/1.html" ref="nofollow noopener noreferrer">www.appuploader.net/tutorial/zh…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[京东前端开发实习生 一面]]></title>    <link>https://juejin.cn/post/7582232291620536358</link>    <guid>https://juejin.cn/post/7582232291620536358</guid>    <pubDate>2025-12-11T07:24:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582232291620536358" data-draft-id="7581297888808435762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="京东前端开发实习生 一面"/> <meta itemprop="keywords" content="前端,面试,网络协议"/> <meta itemprop="datePublished" content="2025-12-11T07:24:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="天天扭码"/> <meta itemprop="url" content="https://juejin.cn/user/3349589831715801"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            京东前端开发实习生 一面
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3349589831715801/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    天天扭码
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:24:30.000Z" title="Thu Dec 11 2025 07:24:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读33分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>就说我这次的面试体验来说，萝莉来形容我还是太强壮了，算了不说了。</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/034963b1e71e400ebbccb00e6ebf5ced~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042669&amp;x-signature=j5L3%2BPqWiRx2yKjbyAfpP%2FSf7KI%3D" alt="小猫咪摇饮料.gif" width="30%" loading="lazy"/></p>
<p><strong>下面是面筋一览，下面必须尝试手撕找回颜面</strong></p>
<ul>
<li>1.自我介绍</li>
<li>2.ai使用率</li>
<li>3.日常如何使用 ai</li>
<li>4.项目中打断ai语音输出时如何区分人声和噪声</li>
<li>5.架构选型如何决定</li>
<li>6.实习经历(主要做什么、遇到的难题是什么)</li>
<li>7.如何优化h5页面的性能 ★★★</li>
<li>8.强缓存和协商缓存的区别 ★★★</li>
<li>9.如果有大量的 dom 操作和 dom动画一起执行会发生什么-faber架构 ★★★</li>
<li>10.http1.0和http2.0的区别 ★★★</li>
<li>11.https TLS加密的过程 ★★★</li>
</ul>
<h2 data-id="heading-1">一、自我介绍（可跳过）</h2>
<p>这里就不暴露个人信息了，核心是围绕自己的亮点和优势来介绍</p>
<h2 data-id="heading-2">二、ai使用率（可跳过）</h2>
<p>面试官的心思谁能琢磨透呢？想让我们多用AI吗？还是相反的？</p>
<p>既然前面都说了用了那么多AI技术了，那肯定是80%以上啊（事实也确实如此，甚至更高）</p>
<h2 data-id="heading-3">三、如何使用 ai（可跳过）</h2>
<p>AI是万能的，但是我们也不能一点事不干，不然会给面试官留下只会AI的思想侏儒。</p>
<p>现在随着AI Coding的兴起，更可贵的是产品思维，AI的工作应该是一种提效的工具而不是一种平替。AI Coding时代下需要的是一个有大局观的知识面广的指挥者，，所以要打出你和AI的组合技。下面是一种很好的回答，日常工作也建议这样做。</p>
<p>我有一个很好的idea，我认为这个idea很有前景，有商业价值，AI可以帮我调研完善这个萌芽状态下的idea，技术的选型和项目的基础架构也是我来完成的，AI负责完成具体的功能模块的代码实现，因为AI对小的细节方面的把控是很优秀的，之后使用AI做代码的review。</p>
<h2 data-id="heading-4">四、项目中如何实现的AI对话语音打断机制（可跳过）</h2>
<p>项目使用的是VAD打断机制，目的是把一个死板的 WebSocket 管道，变成一个灵活的、可交互的“人”。</p>
<p>用的 <strong>VAD 算法</strong>其实非常经典且基础，叫 基于能量的检测。</p>
<blockquote>
</blockquote>
<ul>
<li>RMS (Root Mean Square，均方根)：用来衡量一段声音的“响度”。</li>
</ul>

<ul>
<li>想象一个波形图，上下跳动。如果波形平平的（比如 0.001），说明没声音；如果波形剧烈跳动（比如 0.5），说明有声音。</li>
</ul>

<ul>
<li>算法就是：把这一帧里所有的采样点（比如 4096 个点）平方 -&gt; 加起来 -&gt; 除以总数 -&gt; 开根号。这就是这段音频的“平均能量”。</li>
</ul>
<p><strong>逻辑流程：</strong></p>
<ol>
<li>算响度：每来一帧音频（约 0.1 秒），就算一次 RMS。</li>
</ol>

<ol start="2">
<li>比阈值：设一个红线（SILENCE_THRESHOLD = 0.02）。</li>
</ol>
<ul>
<li>RMS &lt; 0.02：认为是静音/噪音。</li>
</ul>

<ul>
<li>RMS &gt; 0.02：认为是人声。</li>
</ul>
<ol start="3">
<li>防抖动：</li>
</ol>
<ul>
<li>问题：如果我就拍了一下桌子（啪！），RMS 瞬间飙高，但这不算说话，不能打断 AI。</li>
</ul>

<ul>
<li>解决：也就是你代码里的 SPEECH_FRAMES_THRESHOLD = 5。必须连续 5 帧（约 0.5 秒）都超过红线，系统才认定“这人真在说话”，然后触发打断。</li>
</ul>
<blockquote>
</blockquote>
<p>但是RMS 的 VAD 最大的短板就是无法区分‘人声’和‘背景噪音’。</p>
<p>在目前的 Demo 环境（安静室内），这个方案效果很好且极度轻量（计算量几乎为 0）。如果要在生产环境（如咖啡厅）解决这个问题，我有两套成熟的升级方案：</p>
<p>1. 前端方案：<strong>引入 WebRTC VAD 或 rnnoise（基于 RNN 的降噪库）</strong>，它们能提取音频特征，<strong>识别是否是‘人声频谱’</strong>，而不仅仅看响度。</p>
<p>2. 后端方案（更推荐）：阿里云 Qwen-Omni 协议<strong>本身支持 server_vad</strong>。我可以把判断逻辑交给云端模型，因为大模型对语音的理解能力远强于本地算法。我只需<strong>把所有音频流上去</strong>，如果服务端下发 input_audio_buffer.speech_started 事件，我<strong>再执行打断</strong>。这能极大降低误触率。</p>
<h2 data-id="heading-5">五、架构选型如何决定（根据个人的技术栈来选择的）</h2>
<p>因为我的方向是大前端下的全栈开发，所以选型我会从下面的方向考虑——</p>
<h4 data-id="heading-6">1.是否需要SEO（React和Next.js）</h4>
<p>React 与 Next.js 的选择核心看项目需求：</p>
<p>无 SEO 需求、侧重纯客户端交互的场景（如浏览器插件、内部 AI 工具），选<strong>React</strong>，搭配 Vite 打包体积小，聚焦前端流畅体验；</p>
<p>需 SEO、首屏优化或快速搭建 AI 接口中间层的场景（如 AI 内容平台、对外工具），选<strong>Next.js</strong>，其 SSR/SSG 能力和 API Routes 能降低全栈开发成本。二者并非替代关系，Next.js 是基于 React 的增强框架。</p>
<h4 data-id="heading-7">2.移动端应用还是PC端应用（UI架构选择）</h4>
<ul>
<li><strong>PC 端（如 AI 管理后台、代码助手）</strong> ：优先选 Ant Design Pro/Element Plus，这类组件库适配大屏，自带复杂表格、权限菜单、多窗口布局，契合 AI 平台参数配置、数据可视化需求；ToC 创新工具可选 Tailwind+Radix UI，灵活定制个性化交互。</li>
<li><strong>移动端（如 AI 对话 APP、移动端生成工具）</strong> ：选 Vant/PrimeVue Mobile，组件适配触屏操作，支持响应式布局；跨端场景用 Ionic 或 React Native Web，一套代码覆盖移动端与 Web；轻量化 H5 选 UnoCSS，减少加载体积。</li>
</ul>
<h4 data-id="heading-8">3.后端框架选择</h4>
<p>作为偏前端的全栈开发者，我会优先选择  <strong>“Next.js API Routes + 云服务 + 轻量级后端”</strong>  的组合，减少后端维护成本。</p>
<p>对于中大型的项目，我会使用使用更轻量的Egg.js是由阿里巴巴开源的基于koa，小型项目会选择Express</p>
<p>中大型项目选 Egg.js（阿里开源、基于 Koa），因其内置约定式目录规范、分层架构和企业级插件体系（如多环境配置、日志），能规避代码混乱，适配复杂逻辑（如 AI 接口分层、多模型调用），长期维护成本低；</p>
<p>小型项目选Express，它极简无约束，几行代码就能搭建接口，无需遵循固定规范，快速落地轻量需求（如单接口 AI 工具），避免 Egg.js 的配置冗余，提升迭代效率。</p>
<h4 data-id="heading-9">4.数据库选择（Mysql、MongoDB、supabase）</h4>
<p>结构化数据 + 强事务需求（如 AI 平台的用户计费、权限），中大型项目选 MySQL，依托其 ACID 特性和关联查询优势；非结构化 / 半结构化数据（如 AI 对话历史、模型参数），选 MongoDB，无 Schema 约束适配灵活扩展。</p>
<p>小型项目优先 Supabase，作为 PostgreSQL-based 的 BaaS 平台，零代码实现认证、实时同步，快速落地核心功能；若仅需轻量存储非结构化数据，也可选 MongoDB。</p>
<h2 data-id="heading-10">六、实习经历(主要做什么、遇到的难题是什么)</h2>
<p><strong>实习经历要突出自己的工作特点并使用工作经历来佐证，而且要细讲一个在工作中主要负责的项目，其它的几句话带过</strong></p>
<h2 data-id="heading-11">七、如何优化h5页面的性能 ★★★</h2>
<p>这个问题是整个面试过程中最核心的问题，涉及到了前端开发的各个方面，需要慎重回答，我的答案也肯定不完全，欢迎评论区补充</p>
<p>我们可以从七个维度展开来讲——<strong>加载阶段优化</strong>、<strong>渲染阶段优化</strong>、<strong>运行阶段优化</strong>、<strong>网络交互优化</strong>、<strong>适配与兼容优化</strong>、<strong>性能监控与持续迭代</strong>、<strong>react优化</strong></p>
<h4 data-id="heading-12"><strong>（1）加载阶段优化：资源最小化与传输智能化</strong></h4>
<h5 data-id="heading-13"><strong>1. 资源压缩与优化</strong></h5>
<ul>
<li>
<p><strong>代码级压缩</strong>：</p>
<ul>
<li><strong>JS/CSS压缩</strong>：使用 <code>Terser</code>、<code>CSSNano</code> 进行混淆、删除死代码。★★★</li>
<li><strong>Tree Shaking</strong>：通过ES6模块静态分析，剔除未使用的导出代码（如仅导入UI库的特定组件）。</li>
<li><strong>现代图片格式</strong>：<strong>优先使用WebP/AVIF</strong>，相比PNG/JPEG可减少30%-70%体积。为兼容性提供 <code>&lt;picture&gt;</code> 标签降级。★★★</li>
<li><strong>图片尺寸适配</strong>：通过 <code>srcset</code> 和 <code>sizes</code> 属性，根据设备DPR和视口宽度加载最合适的图片。★★★</li>
<li><strong>字体子集化</strong>：使用 <code>fonttools</code> 等工具提取页面实际使用的字符（尤其对于中文字体），生成精简的WOFF2文件。</li>
</ul>
</li>
</ul>
<h5 data-id="heading-14"><strong>2. 智能加载策略</strong></h5>
<ul>
<li>
<p><strong>关键渲染路径优化</strong>：</p>
<ul>
<li><strong>内联关键CSS</strong>：将首屏渲染（Above The Fold）所必需的CSS直接内嵌在HTML <code>&lt;style&gt;</code> 标签中，消除请求阻塞。★★★</li>
<li><strong>异步/延迟非关键JS</strong>：使用 <code>async</code>（独立模块）或 <code>defer</code>（保持顺序）属性加载非阻塞脚本。★★★</li>
</ul>
</li>
<li>
<p><strong>资源提示</strong>：</p>
<ul>
<li><code>preload</code>：强制高优先级加载<strong>当前页面</strong>的核心资源（如关键字体、首屏英雄图）。</li>
<li><code>preconnect</code> / <code>dns-prefetch</code>：提前与第三方域名建立TCP连接或进行DNS解析。</li>
<li><code>prefetch</code>：<strong>低优先级</strong>预获取下一个导航可能需要的资源。</li>
</ul>
</li>
<li>
<p><strong>按需加载/懒加载</strong>：</p>
<ul>
<li><strong>路由懒加载</strong>：使用 <code>import()</code> 动态导入路由组件。★★★</li>
<li><strong>组件懒加载</strong>：非首屏交互组件（如AI工具的复杂参数面板）在需要时加载。★★★</li>
<li><strong>图片/iframe懒加载</strong>：使用原生 <code>loading="lazy"</code> 或 <code>IntersectionObserver</code> API实现。★★★</li>
</ul>
</li>
</ul>
<h5 data-id="heading-15"><strong>3. 缓存策略★★★</strong></h5>
<ul>
<li><strong>强缓存</strong>：为带Hash指纹的静态资源设置 <code>Cache-Control: max-age=31536000</code>（一年）。★★★</li>
<li><strong>协商缓存</strong>：对可能变化的资源使用 <code>ETag</code>/<code>Last-Modified</code>。★★★</li>
<li><strong>Service Worker缓存</strong>：实现更精细的离线缓存、网络降级和资源预缓存策略。</li>
<li><strong>本地存储</strong>：将不敏感的AI模型配置、用户偏好存入 <code>localStorage</code>，减少接口请求。★★★</li>
</ul>
<h5 data-id="heading-16"><strong>4. 构建与传输优化</strong></h5>
<ul>
<li><strong>代码分割</strong>：基于路由、组件或动态导入，将代码拆分成多个按需加载的Chunk。</li>
<li><strong>启用HTTP/2/HTTP3</strong>：利用多路复用、头部压缩等特性提升传输效率。★★★</li>
<li><strong>开启Brotli/Gzip压缩</strong>：在服务器端对文本资源进行高效压缩。</li>
</ul>
<h4 data-id="heading-17"><strong>（2）渲染阶段优化：绘制高效与避免抖动</strong></h4>
<p>目标：<strong>加速首屏绘制，最小化重排与重绘</strong>。</p>
<h5 data-id="heading-18"><strong>1. 避免布局抖动</strong></h5>
<ul>
<li><strong>读写分离</strong>：避免在循环中连续读取（如 <code>offsetHeight</code>）然后写入样式，应批量读取后统一写入。</li>
<li><strong>使用 <code>DocumentFragment</code></strong>：进行离线DOM操作，完成后一次性插入文档。</li>
<li><strong>避免强制同步布局</strong>：在 <code>requestAnimationFrame</code> 回调中处理样式修改，与浏览器刷新率同步。</li>
</ul>
<h5 data-id="heading-19"><strong>2. CSS优化</strong></h5>
<ul>
<li><strong>简化选择器</strong>：避免过于复杂的选择器链，减少样式计算开销。</li>
<li><strong>优化动画属性</strong>：<strong>仅使用 <code>transform</code> 和 <code>opacity</code></strong> 制作动画，它们只触发<strong>合成层（Compositing）</strong> 更新，由GPU处理，性能极高。避免使用 <code>left</code>, <code>top</code>, <code>margin</code> 等触发布局和绘制的属性。★★★</li>
<li><strong>提升为合成层</strong>：对复杂动画元素谨慎使用 <code>will-change: transform</code> 或 <code>translateZ(0)</code>，提示浏览器提前优化。</li>
<li><strong>使用Flexbox/Grid布局</strong>：相比传统浮动和定位布局，性能更优且更不易引发布局问题。★★★</li>
</ul>
<h5 data-id="heading-20"><strong>3. 首屏体验优化</strong>★★★</h5>
<ul>
<li><strong>服务端渲染/静态生成</strong>：对于内容型AI页面，使用Next.js/Nuxt.js等框架进行SSR/SSG，直出HTML，消除白屏。★★★</li>
<li><strong>骨架屏</strong>：在数据加载前，展示与最终页面结构相似的灰色占位图，极大提升感知速度。★★★</li>
</ul>
<h4 data-id="heading-21"><strong>（3）运行阶段优化：交互流畅与内存健康</strong></h4>
<p>目标：<strong>确保主线程响应迅速，防止内存泄漏</strong>。</p>
<h5 data-id="heading-22"><strong>1. JavaScript执行优化</strong></h5>
<ul>
<li>
<p><strong>拆分长任务</strong>：任何连续执行超过 <strong>50ms</strong> 的任务都可能阻塞交互。使用 <code>setTimeout</code>、<code>requestIdleCallback</code> 或 <code>Web Worker</code> 进行拆分。★★★</p>
<ul>
<li><strong>Web Worker应用</strong>：将AI项目中的<strong>大文本处理、模型推理（TensorFlow.js）、复杂计算</strong>移至Worker线程。★★★</li>
</ul>
</li>
<li>
<p><strong>防抖与节流</strong>：对 <code>resize</code>、<code>scroll</code>、<code>input</code>、<code>mousemove</code> 等高频率事件进行控制。★★★</p>
</li>
<li>
<p><strong>事件委托</strong>：利用事件冒泡，在父节点统一处理子元素事件，减少监听器数量。★★★</p>
</li>
</ul>
<h5 data-id="heading-23"><strong>2. 高效数据渲染</strong></h5>
<ul>
<li>
<p><strong>虚拟列表</strong>：对于AI对话记录、生成结果等长列表，<strong>只渲染可视区域及其附近的DOM元素</strong>（使用 <code>react-window</code>、<code>vue-virtual-scroller</code> 等）。★★★</p>
</li>
<li>
<p><strong>Canvas优化</strong>：对于AI绘图或数据可视化：★★★</p>
<ul>
<li>使用分层Canvas，仅重绘变化的层。</li>
<li>限制画布分辨率，适配显示尺寸即可。</li>
<li>利用 <code>OffscreenCanvas</code> 在Worker中绘图。</li>
</ul>
</li>
</ul>
<h5 data-id="heading-24"><strong>3. 内存管理</strong></h5>
<ul>
<li><strong>及时清理</strong>：移除不再需要的事件监听器、定时器、WebSocket连接。</li>
<li><strong>避免意外全局变量</strong>。</li>
<li><strong>解除引用</strong>：对于不再需要的大型对象（如AI生成的高清图片数据URL），手动设置为 <code>null</code>。</li>
<li><strong>使用弱引用</strong>：对于缓存场景，考虑使用 <code>WeakMap</code> 和 <code>WeakSet</code>。★★★</li>
</ul>
<h4 data-id="heading-25"><strong>（4）网络交互优化：请求高效与弱网友好</strong></h4>
<p>目标：<strong>减少请求数量、压缩传输数据、提升连接效率</strong>。</p>
<h5 data-id="heading-26"><strong>1. 请求优化</strong></h5>
<ul>
<li><strong>合并请求</strong>：将同类型小请求合并（如多个配置查询）。</li>
<li><strong>请求优先级管理</strong>：核心接口优先，非关键请求（如日志、统计）延迟或空闲时发送。</li>
<li><strong>取消无用请求</strong>：在组件卸载或用户跳转时，取消未完成的 <code>fetch</code> / <code>axios</code> 请求。</li>
<li><strong>接口缓存</strong>：对非实时AI数据（如模型列表、公共配置）进行合理的本地或Service Worker缓存。</li>
</ul>
<h5 data-id="heading-27"><strong>2. 数据传输优化</strong></h5>
<ul>
<li><strong>使用现代数据格式</strong>：考虑使用 <strong>Protocol Buffers (PB)</strong>  或 <strong>MessagePack</strong> 替代JSON，可大幅减少AI模型输入输出等大数据的传输体积。</li>
<li><strong>开启压缩</strong>：确保API响应头包含 <code>Content-Encoding: br</code> 或 <code>gzip</code>。★★★</li>
<li><strong>流式响应</strong>：对于AI对话、文本生成等场景，使用 <strong>SSE</strong> 或 <strong>WebSocket</strong> 进行流式传输，实现“打字机”效果，大幅降低可感知延迟。★★★</li>
</ul>
<h5 data-id="heading-28"><strong>3. 网络环境适配</strong></h5>
<ul>
<li><strong>弱网检测与降级</strong>：通过 <code>navigator.connection.effectiveType</code> 检测网络类型，弱网下自动降低图片质量、关闭预览动画、使用更简洁的UI。</li>
<li><strong>CDN与边缘计算</strong>：静态资源部署CDN。将部分AI预处理逻辑（如图片压缩、格式转换）通过边缘函数（如Cloudflare Workers）就近处理。</li>
</ul>
<h4 data-id="heading-29"><strong>（5）适配与兼容优化：兼顾广泛与高性能</strong></h4>
<p>目标：<strong>在不同设备与浏览器上提供尽可能一致的性能体验</strong>。</p>
<h5 data-id="heading-30"><strong>1. 设备性能分级</strong></h5>
<ul>
<li><strong>硬件检测</strong>：通过 <code>navigator.hardwareConcurrency</code>（CPU核心数）和 <code>navigator.deviceMemory</code>（内存大小）粗略判断设备能力。</li>
<li><strong>动态调整策略</strong>：高性能设备启用复杂动画和高清资源；低性能设备则降级为简单动画和基础效果。</li>
</ul>
<h5 data-id="heading-31"><strong>2. 浏览器兼容与降级</strong></h5>
<ul>
<li>
<p><strong>渐进增强</strong>：优先为现代浏览器提供最佳体验（如使用WebGL加速AI推理），同时为旧浏览器提供基础可用的功能。★★★</p>
</li>
<li>
<p><strong>按需Polyfill</strong>：通过 <code>@babel/preset-env</code> 的 <code>useBuiltIns: 'usage'</code> 仅引入目标浏览器所需的polyfill。</p>
</li>
<li>
<p><strong>移动端专项</strong>：★★★</p>
<ul>
<li>设置 <code>&lt;meta name="viewport" content="width=device-width"&gt;</code> 消除300ms点击延迟。</li>
<li>为可滚动区域添加 <code>-webkit-overflow-scrolling: touch</code> 以启用平滑滚动。</li>
<li>使用 <code>touch-action: manipulation</code> 禁用双击缩放等默认行为。</li>
</ul>
</li>
</ul>
<hr/>
<h4 data-id="heading-32"><strong>（6）性能监控与持续迭代</strong></h4>
<p>目标：<strong>建立量化指标，驱动持续优化</strong>。</p>
<h5 data-id="heading-33"><strong>1. 性能指标采集</strong></h5>
<ul>
<li><strong>核心Web指标</strong>：使用 <code>web-vitals</code> 库轻松测量LCP、FID/INP、CLS。</li>
<li><strong>自定义业务指标</strong>：如“AI图片生成完成时间”、“首条对话响应时间”。</li>
<li><strong>长任务监控</strong>：使用 <code>PerformanceObserver</code> 监控超过50ms的任务。</li>
<li><strong>内存监控</strong>：通过 <code>performance.memory</code>（Chrome）监控JS堆大小。</li>
</ul>
<h5 data-id="heading-34"><strong>2. 工具与流程</strong></h5>
<ul>
<li><strong>实验室测试</strong>：在CI/CD流程中集成 <strong>Lighthouse CI</strong>，设定性能预算，不合格则阻断发布。</li>
<li><strong>真实用户监控</strong>：接入 <strong>Sentry</strong>、<strong>FrontJS</strong> 等RUM平台，收集真实环境下的性能数据。</li>
<li><strong>可视化分析</strong>：使用 <code>webpack-bundle-analyzer</code> 定期分析产物构成，警惕体积膨胀。</li>
</ul>
<h4 data-id="heading-35"><strong>（7）React框架专项优化：从模式到细节的性能实践</strong></h4>
<p>React应用的核心性能问题通常源于 <strong>不必要的重新渲染</strong>。优化目标是：<strong>在正确的时间、只渲染必要的组件</strong>。</p>
<h4 data-id="heading-36">1. 用 <code>useCallback</code> + <code>useMemo</code> 避免无意义计算与重渲染</h4>
<p>这两个 Hook 是解决<strong>函数 / 计算结果重复生成导致子组件重渲染</strong>的关键，要区分清楚各自的使用场景，避免滥用。</p>
<ul>
<li>
<p><strong><code>useCallback</code>：缓存函数引用</strong></p>
<ul>
<li>原理：缓存函数的引用地址，只有当依赖项变化时，才会生成新的函数。</li>
<li>适用场景：父组件传递函数给子组件时，若子组件用 <code>React.memo</code> 做了浅比较优化，必须用 <code>useCallback</code> 包裹传递的函数，否则每次父组件渲染都会生成新函数，导致子组件无效重渲染。</li>
<li>项目案例：在 AI 可视化项目中，我给图表组件传递的 <code>onDataChange</code> 回调，用 <code>useCallback</code> 包裹后，避免了图表组件因函数引用变化而重复渲染，提升了大数据渲染时的流畅度。</li>
<li>避坑点：<strong>不要无脑包裹所有函数</strong>，依赖项要写全，否则会导致闭包陷阱（比如引用旧的 state）。</li>
</ul>
</li>
<li>
<p><strong><code>useMemo</code>：缓存计算结果</strong></p>
<ul>
<li>原理：缓存复杂计算的结果，只有依赖项变化时才会重新计算。</li>
<li>适用场景：组件内有<strong>大量计算逻辑</strong>（比如 AI 模型输出数据的格式化、长列表的筛选排序），避免每次渲染都重复计算。</li>
<li>项目案例：在智能表单项目中，我用 <code>useMemo</code> 缓存了表单校验规则的计算结果（依赖于表单配置），减少了表单组件每次输入时的计算开销，输入响应速度提升约 30%。</li>
<li>避坑点：<strong>简单计算没必要用 <code>useMemo</code></strong>（比如数字加减），其本身有缓存开销，反而可能适得其反。</li>
</ul>
</li>
</ul>
<h4 data-id="heading-37">2. 合理使用受控组件 vs 非受控组件，平衡性能与开发效率</h4>
<p>这两种组件模式的选择，直接影响表单类组件的性能和用户体验，要结合场景取舍：</p>
<ul>
<li>
<p><strong>受控组件</strong>：表单数据由 React state 控制，优点是实时校验、数据联动方便；缺点是<strong>高频输入场景下（比如搜索框实时联想）</strong> ，每次输入都会触发 state 更新和组件重渲染，可能有性能损耗。</p>
<ul>
<li>优化技巧：高频输入场景可加<strong>防抖处理</strong>，比如搜索框输入时，延迟 300ms 再更新 state，减少重渲染次数。</li>
</ul>
</li>
<li>
<p><strong>非受控组件</strong>：表单数据由 DOM 自身维护，通过 <code>ref</code> 获取值，优点是<strong>性能更高</strong>（减少 state 驱动的重渲染）；缺点是数据联动、实时校验不如受控组件灵活。</p>
<ul>
<li>适用场景：文件上传、简单输入框（无需实时校验）、高频输入的搜索框等场景。</li>
<li>项目案例：在 AI 对话系统的输入框中，我采用<strong>非受控组件 + 防抖 ref 取值</strong>的方案，既保证了用户输入的流畅性，又避免了实时 state 更新带来的性能开销。</li>
</ul>
</li>
</ul>
<h4 data-id="heading-38">3. 长列表优化：解决大数据渲染的性能瓶颈</h4>
<p>长列表（比如 1000+ 条数据）直接渲染会导致 DOM 节点过多，引发首屏加载慢、滚动卡顿，这是前端性能优化的高频考点，尤其在 AI 数据可视化场景中很常见。</p>
<ul>
<li>
<p><strong>核心方案：虚拟列表（Virtual List）</strong></p>
<ul>
<li>
<p>原理：只渲染<strong>当前视口内可见的列表项</strong>，滚动时动态替换可视区域的内容，复用 DOM 节点，减少 DOM 数量。</p>
</li>
<li>
<p>实现方式：</p>
<ol>
<li>手写简易版：通过计算视口高度、列表项高度，确定可视区域的起始 / 结束索引，结合 <code>overflow: auto</code> 实现。</li>
<li>成熟库：比如 <code>react-window</code>/<code>react-virtualized</code>，适合复杂场景（比如动态高度列表、网格布局）。</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>补充优化：</strong></p>
<ul>
<li>列表项用 <code>React.memo</code> 包裹，避免单个项的无效重渲染；</li>
<li>数据分页加载 / 懒加载，结合后端接口实现滚动加载更多，减少首屏数据量。</li>
</ul>
</li>
</ul>
<h2 data-id="heading-39">八、强缓存和协商缓存的区别 ★★★</h2>
<p>强缓存和协商缓存都是浏览器的缓存技术，目的是为了减少对服务器的资源请求，从浏览器本地拿数据，减少服务器压力，提升访问速度，但是强缓存和协商缓存又有不同。</p>
<h4 data-id="heading-40">强缓存</h4>
<p>强缓存通过请求头中设置的Expires和Cache-Control来控制，其中Expires是http1.0时的协商缓存请求头，Cache-Control是http1.1推出的请求头，现代浏览器大部分情况下使用Cache-Control来控制强缓存。</p>
<p>Expires是通过设置绝对时间来控制强缓存的时间的，如Expires: Wed, 21 Oct 2025 07:28:00 GMT。这就导致用户可以通过修改系统时间来导致强缓存失效，所以Cache-Control出现之后Expires就基本不使用了。</p>
<p>Cache-Control的主要属性值包括：</p>
<ul>
<li><strong>private</strong>：响应仅能被客户端缓存，不能被代理服务器缓存</li>
<li><strong>public</strong>：响应可以被客户端和代理服务器缓存</li>
<li><strong>max-age</strong>：设置缓存的最大有效期（秒）</li>
<li><strong>no-cache</strong>：<strong>每次使用缓存前必须向服务器验证</strong>（启用协商缓存）</li>
<li><strong>no-store</strong>：禁止任何形式的缓存</li>
<li><strong>must-revalidate</strong>：缓存过期后必须向服务器验证</li>
<li><strong>immutable</strong>：资源在有效期内不会改变（适合版本化资源）</li>
</ul>
<p>当要请求一个资源时，如果启用了强缓存，第一次缓存会请求服务器然后会将资源缓存到本地内存或磁盘，如果缓存没有过期的情况下再次请求就会直接从内存或磁盘拿数据，不会请求服务器，大幅减少了服务器压力，也提高了前端的响应速度。</p>
<p>那么什么时候存到内存，什么时候存到磁盘呢？一般来说体积小、多次复用、过期时间短的会存在内存，反之存到磁盘，这时由浏览器决定的，是一个黑盒的过程，但是我们可以通过某种手段去影响浏览器的判断，比如将过期时间设置的短一点，就越有可能存到内存中。</p>
<p>我们这里也可以总结一下强缓存的优缺点。优点是设置了过期时间之后不会请求服务器，减少了服务器的压力和宽带开销；缺点是过期时间之前缓存的数据是不会更新的，如果服务器的数据更新了，但是本地缓存还没有过期，就会导致数据不同步的问题，所以，一般来讲，强缓存要存储不常改变的资源，如vue.js</p>
<h4 data-id="heading-41">协商缓存</h4>
<p>协商缓存是通过设置请求头中的Last-Modified（If-Modified-Since）、ETag （If-None-Match）来控制的。其中请求头Last-Modified（If-Modified-Since）是http1.0中设置的请求头，ETag （If-None-Match）是http1.1推出的新的协商缓存请求头，现代浏览器大部分情况下使用ETag （If-None-Match）来控制协商缓存。</p>
<p>Last-Modified（If-Modified-Since）是通过判断文件的修改时间来确定是否使用缓存资源的，不论是否真正的修改内容。这就导致某些情况下浪费宽带</p>
<p>ETag （If-None-Match）是通过判断文件的内容是否修改来确定是否使用缓存的，相比于Last-Modified（If-Modified-Since）更加精细实用。具体的过程是，当启用Etag协商缓存时，第一次请求并不会携带请求验证，服务器在返回资源时会在响应头中返回一个Etag，这个值是服务器根据资源内容生成的唯一标识符，当下次请求时就会在请求头带入If-None-Match，值就是第一次请求时返回的Etag值。请求过去的时候服务器会比较If-None-Match和新的Etag值是否一样，如果一样就返回<strong>304 Not Modified</strong>不返回资源，意思是通知前端资源没有变可以从浏览器拿取缓存，如果值不一样，说明资源改变，这时就返回200状态码并返回新的资源</p>
<p>我们可以看到协商缓存的优劣。优势是可以实时的更新最新数据不害怕资源过期，但是比起强缓存，协商缓存多了网络请求的往返，这样会导致网络延迟的发生。所以协商缓存适合动态内容、API响应、可能频繁更新的资源（如未版本化的HTML）</p>
<h2 data-id="heading-42">九、如果有大量的 dom 操作和 dom动画一起执行会发生什么-faber架构 ★★★</h2>
<p>我认为这一题就是考察我们对react虚拟dom和faber架构调度机制的理解，这里推荐一篇文章
<a href="https://juejin.cn/post/7545853099353817128" target="_blank" title="https://juejin.cn/post/7545853099353817128">浅谈React中虚拟DOM、diff算法、fiber架构的关系（面试可用）- 掘金</a></p>
<h2 data-id="heading-43">十、http1.0和http2.0的区别 ★★★</h2>
<p>首先明确导致延迟的罪魁祸首是什么，无疑是带宽和队头阻塞。</p>
<p>带宽影响了单位时间最大的数据通过量，队头阻塞则影响了数据的传输效率</p>
<p>虽然近年来网络带宽增长非常快，然而我们却并没有看到网络延迟有相应程度的降低。<strong>网络延迟问题主要由于队头阻塞,导致带宽无法被充分利用</strong>。</p>
<p>由http1.0到http2.0的过程一大半就是解决队头阻塞的过程。</p>
<h4 data-id="heading-44">http1.0</h4>
<p>首先我们来看http1.0，http1.0只允许短链接，而且每个短链接只允许单个请求，也就是每个http请求都要进行一次TCP连接，连接之后TCP连接会断开，下次http请求还要重新建立一个TCP连接，每个请求都有TCP三次握手（1.5RTT）和四次挥手开销，导致服务器压力大，队头阻塞网络延迟严重。</p>
<p>此外，http1.0无主机头，无法实现虚拟主机，浪费IP资源；缓存机制简陋，只有基本的 <code>Expires</code> 和 <code>Last-Modified</code>；只有16个状态码；不支持https；不支持响应体压缩；不支持文件的分段上传，浪费带宽</p>
<h4 data-id="heading-45">http1.1</h4>
<p>之后是http1.1的时代，相比于http1.0，http1.1有较大的进步，也有一些遗留问题没有解决。</p>
<p>最核心的进步是http1.1支持长连接（Connection: keep-alive；Keep-Alive: timeout=5, max=100 ），减少了多次建立TCP连接的开销，一次TCP连接可以进行多个http请求，而且支持管道化（管道化是一次失败的尝试，可以忽略，之后会讲）</p>
<p>此外http1.1支持了虚拟主机，一个ip可以托管多个网站；增强了缓存机制，新增了头部Cache-Control和Etag，这也是现代最常用的强缓存和协商缓存头部；支持资源的分段上传，节省了宽带的兄消耗；新增了协商缓存；新增了patch方法；</p>
<p>但是还有遗留问题没有解决，比如管道化的并行尝试，因为http1.1是基于文本协议传输，所以传输时需要以http请求为单位，就会导致多个http请求出现互相等待的问题，而且管道化要求请求的顺序返回，如果第一个请求很慢，但是第二个第三个很快，就会出现第二个第三个等待的现象，并不能真正实现并行请求；所以管道化在实际开发中并不会被使用，尽管http1.1允许了长连接，但是还是一个一个请求处理的，而一个ip只允许同时6个tcp连接，还是会出现队头阻塞的问题；而且http1.1不支持请求头的压缩，导致很多情况下队头的体积要比响应题的体积还要大；服务端没有主动推送的功能</p>
<h4 data-id="heading-46">http2.0</h4>
<p>http2.0向下兼容了http1.X，但和http1.x不同的是，http2.0不是基于文本数据传输的，而是基于二进制数据流进行传输，这就很大程度上解决</p>
<p>最核心的进步是HTTP/2.0的<strong>二进制分帧机制</strong>。它将所有传输内容拆分为二进制帧（Frame），每个帧标记流ID。不同请求/响应通过不同流并行传输，从应用层解决了HTTP队头阻塞问题——即使某条流的帧丢失，也仅阻塞该流而不影响其他流传输。</p>
<p>在HTTP/2.0中，单个TCP连接可承载任意数量的双向流（Stream），每个流独立传输请求/响应，无需新建连接。这实现了连接的完全复用，大幅提升了传输效率。需要注意的是，HTTP/2.0仅解决了应用层队头阻塞，TCP层仍存在队头阻塞问题，这正是HTTP/3.0改用QUIC协议要解决的。</p>
<p>此外，http2.0实行了头部压缩，大幅减少头部传输体积，通过 HPACK 算法实现头部压缩：</p>
<ul>
<li>静态字典：预定义常用头部字段（如 Host、Accept-Encoding），用整数索引替代完整字符串；</li>
<li>动态字典：记录当前连接中重复出现的头部字段（如自定义的 Token 头），后续传输仅需索引；</li>
<li>哈夫曼编码：对非字典字段进一步压缩。</li>
</ul>
<p>http2.0允许服务器推送主动推送关键资源，首屏加载时，服务器可提前推送 AI 工具的核心 JS（如对话逻辑、模型接口封装）和首屏图片，缩短首屏渲染时间</p>
<h2 data-id="heading-47">十一、https TLS加密的过程 ★★★</h2>
<p>http1.x的文本传输也好，http2.0的二进制分帧也好，都是明文传输的，这样就会导致<strong>内容可能会被窃听</strong>、<strong>身份可能被伪造</strong>、<strong>报文可能被篡改</strong>。</p>
<p>https就极大的提高了http的安全性，区别是在http的三次握手之后多出了一个TLS握手，我们现在要讲解的就是TLS握手的过程。下面我们先了解一些前置的知识。</p>
<h4 data-id="heading-48">两种加密方式——对称加密和非对称加密</h4>
<h5 data-id="heading-49">对称加密</h5>
<p>对称加密，客户端和服务器使用同一个密钥（加密算法）去加密数据，这个密钥可以加密数据也可以解密数据。但是如果有第三方知道了这个密钥，就可以解密数据，安全性不高。而这个密钥需要在客户端和服务器端传输，就加大了密钥泄露的风险</p>
<h5 data-id="heading-50">非对称加密</h5>
<p>非对称加密使用公钥和私钥进行加密和解密，通常情况下公钥只用来加密，没有解密功能，而私钥可以解密这个公钥加密的数据。通常情况下，服务器会把公钥传给客户端，客户端对数据使用公钥进行加密传给服务端，服务端使用私钥解密数据，这时如果有人截获了客户端发给服务器的数据，他也解密不了，因为私钥在服务器上，而且从头到尾私钥都没有在网络上传输，不会被截获，安全性就大大提升。</p>
<h5 data-id="heading-51">TLS1.2的加密</h5>
<p>其实对称加密和非对称加密各有优劣，对称加密安全性不高，但是传输效率高，没有冗余操作；非对称加密安全性高，但是效率低，那么有没有一种方法可以取二者精华，避二者糟粕呢？有的。</p>
<p>首先是对称加密的不安全性是在哪？是因为密钥容易泄露，如果这个密钥不会泄露的话，就可以解决对称加密的不安全的问题。而非对称加密是安全的，可以使用非对称加密去生成一个安全的不会被泄露的密钥，然后使用这个密钥去进行非对称加密，这样就可以得到一个安全的、高效的加密方式</p>
<p>上面的加密方式就解决了http的第一个安全性的问题——<strong>内容可能会被窃听</strong></p>
<h5 data-id="heading-52">SSL证书</h5>
<p><strong>SSL 证书</strong>是一种基于公钥基础设施（PKI）的数字证书，由权威的第三方证书颁发机构签发，用于验证服务器身份，并为客户端与服务器之间的通信建立加密链路。后续 SSL 协议升级为更安全的<strong>TLS 协议</strong>，因此 SSL 证书也常被称为 <strong>TLS 证书</strong></p>
<p>这个证书用于身份验证，SSL 证书包含以下关键信息，用于身份验证和加密通信：</p>
<ol>
<li><strong>服务器域名</strong>：证书绑定的域名 / IP，确保客户端访问的是目标服务器；</li>
<li><strong>公钥</strong>：用于加密通信数据或验证数字签名，可公开传输；</li>
<li><strong>私钥</strong>：由服务器持有，用于解密公钥加密的数据或生成数字签名，需严格保密；</li>
<li><strong>证书颁发机构（CA）信息</strong>：签发证书的权威机构，包含 CA 的数字签名；</li>
<li><strong>证书有效期</strong>：证书的生效和过期时间，过期后需重新签发。</li>
</ol>
<p>SSL证书可防止<strong>中间人攻击</strong>和<strong>域名劫持</strong>。</p>
<ul>
<li>客户端（如浏览器）访问 HTTPS 网站时，服务器会向客户端出示 SSL 证书；</li>
<li>客户端通过内置的 CA 信任列表，验证证书是否由可信 CA 签发、是否在有效期内、是否绑定当前访问的域名；</li>
<li>若验证通过，确认服务器身份合法；若验证失败（如证书伪造、过期、域名不匹配），浏览器会弹出安全警告，提示用户停止访问。</li>
</ul>
<p>典型的比如www.bilibili.com和www.bi1iXXXX.com.
这样就可以解决<strong>身份可能被伪造</strong>的问题</p>
<h5 data-id="heading-53">MAC</h5>
<ul>
<li>TLS 1.2：通过将明文数据、派生的 MAC 密钥等参数经 HMAC 算法算出 MAC 值并随加密数据一同传输，接收方解密后重新计算 MAC 值比对来判断报文是否被修改。</li>
<li>TLS 1.3：借助 AEAD 算法在加密数据时同步生成认证标签，接收方解密过程中自动验证该标签，以此判断报文是否被修改。</li>
</ul>
<p>这样可以解决http的第三个安全问题——<strong>报文可能被篡改</strong></p>
<h5 data-id="heading-54">TLS1.2握手过程</h5>
<p>下面是具体的TLS1.2的握手过程</p>
<ol>
<li><strong>客户端问候（Client Hello）</strong> ：客户端发送支持的 TLS 版本、加密套件列表、随机数 <code>Client Random</code>，并附带会话 ID（用于会话复用）。</li>
<li><strong>服务器问候（Server Hello）</strong> ：服务器从客户端列表中选定 TLS 版本和加密套件，返回随机数 <code>Server Random</code>，并确认会话 ID。</li>
<li><strong>服务器证书与密钥交换</strong>：服务器发送自身 SSL 证书（含公钥）；若使用 RSA 等非对称加密套件，直接等待客户端加密密钥；若使用 DH/ECDHE 等密钥协商算法，发送服务器端密钥交换参数。</li>
<li><strong>服务器问候完成（Server Hello Done）</strong> ：服务器通知客户端，问候阶段结束。</li>
<li><strong>客户端密钥交换</strong>：客户端验证服务器证书合法性后，生成<strong>预主密钥（Pre-Master Secret）</strong> ，用服务器<strong>公钥加密后</strong>发送给服务器；服务器用私钥解密得到预主密钥。</li>
<li><strong>密钥派生</strong>：客户端和服务器分别使用 <code>Client Random</code>、<code>Server Random</code>、预主密钥，通过 PRF 算法派生<strong>主密钥（Master Secret）</strong> ，再由主密钥生成会话密钥（包括加密密钥、MAC 密钥）。</li>
<li><strong>客户端完成（Client Finished）</strong> ：客户端用会话密钥加密握手消息摘要，发送 <code>Finished</code> 消息，验证握手过程未被篡改。</li>
<li><strong>服务器完成（Server Finished）</strong> ：服务器同理加密握手消息摘要，发送 <code>Finished</code> 消息；双方验证通过后，握手完成，后续用会话密钥加密传输应用数据。</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9d68c47e13c4af1b47bca98cb624231~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042669&amp;x-signature=TjMZUUJfrOqWC9DtHyjpwrIL7oo%3D" alt="aadb211658a6e930da20470e140779d1.jpg" loading="lazy"/></p>
<p>所以整个流程是非对称加密的，握手之后则是对称加密，那么非对称加密的密钥为什么不会泄露呢？整个密钥是有预主密钥+Client Random+Server Random生成的，而且预主密钥并没有在网络上暴露，只是暴露的加密后的预主密钥，这个密钥就算暴露，他人也无法解析，因为私钥在服务器上，所有就形成了安全的对称加密。</p>
<h5 data-id="heading-55">TLS1.3握手过程</h5>
<p>TLS 1.3 握手的核心目标是 <strong>极简交互、1-RTT 时延、强制前向安全</strong>，主流分为<strong>基础 1-RTT 握手</strong>（首次连接）和 <strong>0-RTT 快速握手</strong>（会话复用）两种模式，以下是详细步骤：</p>
<p><strong>基础 1-RTT 握手（首次连接，单向认证场景）</strong></p>
<p>单向认证是最常见的场景（如浏览器访问 HTTPS 网站），仅服务器需提供证书，流程共 2 轮交互：</p>
<ol>
<li>
<p><strong>客户端 → 服务器：发送 Client Hello</strong></p>
<ul>
<li>客户端发送支持的 TLS 1.3 版本、AEAD 加密套件列表（如 AES-GCM）、<code>Client Random</code> 随机数、会话 ID（用于后续复用）。</li>
<li><strong>核心新增</strong>：携带客户端生成的 <strong>ECDHE 临时公钥</strong>，提前启动密钥协商流程。</li>
<li>可选附带扩展信息（如支持的 0-RTT 功能）。</li>
</ul>
</li>
<li>
<p><strong>服务器 → 客户端：发送 Server Hello + 证书 + Finished</strong></p>
<ul>
<li>服务器选定加密套件和 <code>Server Random</code> 随机数，返回 <strong>服务器 ECDHE 临时公钥</strong>，与客户端公钥配对计算共享密钥。</li>
<li>服务器发送 SSL 证书（含长期公钥），供客户端验证服务器身份。</li>
<li><strong>流程简化关键</strong>：无需发送 <code>Server Hello Done</code>，直接用派生的会话密钥加密握手消息摘要，发送 <code>Finished</code> 消息。</li>
</ul>
</li>
<li>
<p><strong>双方密钥派生</strong></p>
<ul>
<li>客户端验证证书合法后，结合双方 ECDHE 临时公钥计算 <strong>共享密钥</strong>。</li>
<li>双方通过 HKDF 算法，基于 <code>Client Random</code>、<code>Server Random</code> 和共享密钥，直接派生 <strong>会话密钥</strong>（无主密钥中间层，AEAD 算法统一处理加密和完整性校验）。</li>
</ul>
</li>
<li>
<p><strong>客户端 → 服务器：发送 Finished</strong></p>
<ul>
<li>客户端用会话密钥加密握手消息摘要，发送 <code>Finished</code> 消息。</li>
<li>双方验证彼此的 <code>Finished</code> 消息通过后，握手完成，后续用会话密钥传输应用数据。</li>
</ul>
</li>
</ol>
<p><strong>0-RTT 快速握手（会话复用场景）</strong></p>
<p>若客户端曾与服务器建立过连接，会缓存会话票据和密钥参数，二次连接时可实现 <strong>零往返时延</strong>：</p>
<ol>
<li>客户端在 <code>Client Hello</code> 中附带缓存的 <strong>会话票据</strong>，同时直接发送 <strong>用缓存密钥加密的应用数据</strong>。</li>
<li>服务器验证会话票据合法后，无需重新协商密钥，直接返回 <code>Finished</code> 消息和加密的响应数据。</li>
<li>双方直接进入数据传输阶段，无需额外握手交互。</li>
</ol>
<h2 data-id="heading-56">结语</h2>
<p>感觉自己变强壮了。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[使用Amazon Bedrock和Pipecat构建低延迟智能语音Agent]]></title>    <link>https://juejin.cn/post/7582232741686738979</link>    <guid>https://juejin.cn/post/7582232741686738979</guid>    <pubDate>2025-12-11T07:25:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582232741686738979" data-draft-id="7582246395986542626" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="使用Amazon Bedrock和Pipecat构建低延迟智能语音Agent"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2025-12-11T07:25:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="亚马逊云开发者"/> <meta itemprop="url" content="https://juejin.cn/user/2850395271209496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            使用Amazon Bedrock和Pipecat构建低延迟智能语音Agent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2850395271209496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    亚马逊云开发者
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:25:33.000Z" title="Thu Dec 11 2025 07:25:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读11分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs3.cn-north-1.amazonaws.com.cn%2Fawschinablog%2Fblogbanner-newnew.png" target="_blank" title="https://s3.cn-north-1.amazonaws.com.cn/awschinablog/blogbanner-newnew.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb0d59cb4ba6457582f87cd34f5f01e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042733&amp;x-signature=Tapqn9wX2%2FKDgOm36rWTWfiq9uU%3D" alt="" loading="lazy"/></a></p>
<p>在生成式AI与语音交互技术快速发展的当下，如何高效构建低延迟、个性化、自然对话体验的智能语音Agent，已逐渐成为业界关注的焦点之一。</p>
<p>智能语音Agent的应用领域广泛，包括智能设备语音交互（如具身机器人、智能音箱）、个人助理、自动化客服（如餐厅预订、销售、保险、预约安排）、营销、语言教学（如英语口语学习）、健康医疗以及多模态内容创作等。</p>
<p>本篇博客将首先介绍构建智能语音Agent的核心组件和延迟优化建议，接着将利用Pipecat开源框架和Amazon Bedrock服务，打造一个支持用户打断、多轮上下文管理的实时交互智能语音Agent</p>
<h2 data-id="heading-0">一、智能语音Agent核心组件</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F20%2Fpipecat-agent-1.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/20/pipecat-agent-1.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19e47cef1aab480490a85c1f0d486f89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042733&amp;x-signature=gIBbot%2F3cKsD4H1rMKtbSfn7NV8%3D" alt="" loading="lazy"/></a></p>
<p>智能语音Agent结合了基础模型的文本/语音识别、理解和推理能力，旨在提供实时、自然、连续的语音交互体验。一般来说，构建智能语音Agent通常需要包含以下核心组件：</p>
<ul>
<li><strong>VAD( Voice Activity Detection )</strong> ：检测音频中是否存在人类语音</li>
<li><strong>EOU(End of Turn/Utterance )</strong>  ：检测说话者是否已经完成了他们的发言</li>
<li><strong>STT (Speech To Text)</strong> ：也称为自动语音识别（ASR），将给定音频转录为文本</li>
<li><strong>LLM</strong> <strong>和 LLM Agent</strong>：大语言模型，如 Amazon Nova/Nova Sonic，DeepSeek，Anthropic Claude系列模型</li>
<li><strong>TTS( Text To Speech)</strong> ：也称为语音合成，从文本生成自然且清晰的语音</li>
</ul>
<p>通过将上述组件组合成一条Pipeline，即可构建出智能语音Agent。随着生成式AI技术的进步，业界发展出了端到端语音模型（即Speech to Speech语音模型），该模型可实现语音输入到语音输出的全链路处理，例如Amazon Nova Sonic就是一款由Amazon研发的Speech to Speech语音模型。端到端语音模型内置了VAD、EOU、STT、LLM、TTS等集成功能，能够实现更低的延迟。这类模型使得构建语音Agent更为轻松便捷。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fai%2Fgenerative-ai%2Fnova%2Fspeech%2F" target="_blank" title="https://aws.amazon.com/ai/generative-ai/nova/speech/" ref="nofollow noopener noreferrer">Amazon Nova Sonic</a> 是一款语音理解和生成模型，可提供自然的类人语音对话式人工智能，并且实现了低延迟和行业领先的性价比。该模型提供流畅的对话处理、自适应语音响应、内容审核、API调用和基于RAG的知识库集成，同时提供高度自适应且引人入胜的用户体验。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F20%2Fpipecat-agent-2.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/20/pipecat-agent-2.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3dcf6613e2f947d7885cf007e8fb3001~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042733&amp;x-signature=NM0%2BRZQ468pY6bGJg7tcEcCtm2A%3D" alt="" loading="lazy"/></a></p>
<p>这两种方案各有优缺点：Pipeline方案可以对各个部分进行精细控制，但其缺点在于语音到文本的来回转换可能导致部分声音信息丢失，并且延迟相对较大。端到端语音模型方案延迟更低，实现更为简单，并且能够更好地感知声音信息，例如非语言线索（如笑声、犹豫）、语调、重音、风格、情绪等，但对语音如何流入和流出Agent的控制相对较少。</p>
<p>需要注意的是，在当前阶段，SOTA LLM（前沿大语言模型）相比于Speech to Speech语音模型，在成本、推理能力、指令遵循和函数调用等方面仍占据优势。但不可否认，Speech to Speech模型是语音Agent的未来。</p>
<blockquote>
<p>📢限时插播：无需管理基础设施，利用亚马逊技术与生态，快速集成与部署生成式AI模型能力。</p>
<p>✨ 精心设计，旨在引导您深入探索Amazon Bedrock的模型选择与调用、模型自动化评估以及安全围栏(Guardrail)等重要功能。</p>
<p>⏩快快点击进入《<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D6695e4c5e1432f239fae485f%26visitfrom%3D3P_Juejinhead_0606%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejinhead_0606" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=6695e4c5e1432f239fae485f&amp;visitfrom=3P_Juejinhead_0606&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejinhead_0606" ref="nofollow noopener noreferrer">多模一站通 —— Amazon Bedrock 上的基础模型初体验</a>》实验构建无限, 探索启程！</p>
</blockquote>
<h2 data-id="heading-1">二、传输协议对比</h2>
<p>要构建自然流畅的智能语音Agent，传输协议的选择至关重要，它们直接影响着语音流的传输效率和实时性。常见的传输协议有WebSocket，WebRTC等，它们有各自的特点，详细对比如下。
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e364e0cd8e24bf8a626e769d6ea4914~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042733&amp;x-signature=KPFEt9UFKhCjm36HTU8RpkVHnDk%3D" alt="image.png" loading="lazy"/>
通过对比可以看出，WebSocket兼容性更好，WebRTC对音视频的传输做了很多优化，传输效率更高。一般来说，对于构建原型和轻量级项目，可以选择Websocket，对于中大型生产项目，WebRTC是更优的选择。但WebRTC协议复杂，部署也很复杂，需要实现信令服务器、STUN服务器（公网IP和端口发现），TURN服务器（P2P连接失败时作为媒体中继服务器，实现诸如NAT穿透）。因此构建一个成熟稳定的WebRTC方案，难度比较大。目前市面上有<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flivekit%2Flivekit" target="_blank" title="https://github.com/livekit/livekit" ref="nofollow noopener noreferrer">Livekit</a>开源框架，同时也有Amazon KVS、Daily、Livekit Cloud等商业WebRTC服务可供选择。</p>
<p>使用WebRTC有两种主要方式：一是通过云端的WebRTC服务器中转，商业WebRTC服务多采用此模式；二是直接在客户端和语音Agent端之间建立连接。云端服务器模式可以实现直连模式无法提供的诸多特性，例如多方会话、多方录音等。而直连模式则非常适合语音AI Agent的客户端-服务器场景，它减少了服务器中转环节，并且无需维护任何特定于WebRTC的基础设施。</p>
<p>Tips:</p>
<p>自建WebRTC服务可以使用公开STUN服务器：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgist.github.com%2Fmondain%2Fb0ec1cf5f60ae726202e" target="_blank" title="https://gist.github.com/mondain/b0ec1cf5f60ae726202e" ref="nofollow noopener noreferrer">gist.github.com/mondain/b0e…</a>。可以根据语音Agent的部署位置选择合适的STUN服务器。</p>
<p>WebRTC服务使用UDP协议进行连接，在亚马逊云部署时需要在安全组开放对应的UDP端口。</p>
<h2 data-id="heading-2">三、智能语音Agent延迟优化建议</h2>
<p>延迟是影响人与语音Agent之间对话体验的关键因素。人类期望在正常对话中获得快速响应，长时间的停顿会显得不自然（人机对话的典型响应时间通常为500毫秒）。因此，延迟优化对于智能语音Agent来说至关重要。</p>
<p>根据作者基于Amazon Bedrock构建智能语音Agent的实践经验，建议综合考虑以下方式优化延迟技术。</p>
<ul>
<li>
<p>语音Agent部署尽量靠近用户，减少网络传输延迟。</p>
</li>
<li>
<p>使用传输效率更高、延迟更低的传输协议，如 WebRTC。</p>
</li>
<li>
<p>LLM 延迟优化：LLM的延迟在整个语音Agent的延迟中占据主要部分，因此对LLM进行延迟优化显得尤为关键。在满足要求的前提下，可以采用以下手段进行优化。</p>
<ul>
<li>优先选择端到端语音模型，这种模式一般比STT-LLM-TTS的Pipeline模式延迟更低。</li>
<li>选择参数量更小/推理速度更快的模型（例如Nova Lite，Claude 3.5 Haiku等）。</li>
<li>使用Bedrock上支持延迟优化的模型（例如Nova Pro，Claude 3.5 Haiku等）</li>
<li>开启 Prompt caching</li>
</ul>
</li>
<li>
<p>Pre-LLM TTS 填充，在用户对话前预先输出内容（如自我介绍），给用户体感上的快。</p>
</li>
<li>
<p>执行长时间函数调用之前，输出提示信息，例如“处理中，请稍后…”，从而减少客户的等待时间。</p>
</li>
<li>
<p>通过LLM提示词引导，缩短回复内容。</p>
</li>
</ul>
<p>典型的Pipeline模式和端到端语音模型延迟对比如下（请注意，不同方案和组件的延迟差异较大，以下数据仅供参考）。在设计智能语音Agent时，将语音端到端延迟控制在800至1000毫秒是一个不错的目标。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acdb005286ca4ea297155c1334f352ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042733&amp;x-signature=KYnXUY8DW%2BEmV50bKdGRqVK6fCE%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">四、使用Pipecat框架构建智能语音Agent</h2>
<p>构建一个智能语音Agent并非易事。除了实现上文所述的核心组件，还需要考虑如何存储会话上下文、接入外部知识库或对接后端系统等功能。使用<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpipecat-ai%2Fpipecat" target="_blank" title="https://github.com/pipecat-ai/pipecat" ref="nofollow noopener noreferrer">Pipecat</a> 开源框架可以显著简化智能语音Agent的开发过程。</p>
<h3 data-id="heading-4">4.1 Pipecat框架介绍</h3>
<p>Pipecat是一个开源的Python框架，专为构建实时语音和多模态对话Agent而设计。它能够轻松协调音频/视频流、AI服务、多种传输方式以及对话流程，从而让开发者更专注于打造独具特色的Agent。</p>
<p><strong>Pipecat</strong> <strong>主要特性包括：</strong></p>
<ul>
<li>低延迟实时交互</li>
<li>支持Agentic Workflow，可集成各类工具（tools）</li>
<li>支持 WebRTC、WebSocket等传输协议</li>
<li>灵活的模型和服务选择，如 Amazon Bedrock，Polly，Transcribe及其它主流的模型。</li>
<li>支持用户打断</li>
<li>多模态</li>
</ul>
<h3 data-id="heading-5">4.2 方案介绍</h3>
<p>接下来，我们将借助一个示例项目，探讨如何基于Pipecat框架，并结合Amazon Bedrock、Amazon Polly和Amazon Transcribe等服务来构建智能语音Agent。<a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fcn%2Fbedrock%2F" target="_blank" title="https://aws.amazon.com/cn/bedrock/" ref="nofollow noopener noreferrer">Amazon Bedrock</a>是用于构建生成式 AI 应用程序和Agent的托管服务，支持多种自研和第三方大模型，例如Amazon Nova、Nova Sonic、DeepSeek、Anthropic Claude系列模型。<a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fcn%2Fpolly%2F" target="_blank" title="https://aws.amazon.com/cn/polly/" ref="nofollow noopener noreferrer">Amazon Polly</a>是一项完全托管的服务，可按需生成语音，将任意文本转换为音频流（即TTS），并支持数十种语言。<a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fcn%2Ftranscribe%2F" target="_blank" title="https://aws.amazon.com/cn/transcribe/" ref="nofollow noopener noreferrer">Amazon Transcribe</a> 是一项完全托管的自动语音识别（ASR）服务，自动将语音转换为文本。</p>
<p>该示例项目演示了如下功能：</p>
<ul>
<li>支持Pipeline模式和端到端语音模式（使用Amazon Nova Sonic模型）。</li>
<li>使用WebRTC作为传输协议。</li>
<li>通过Tools集成知识库，该知识库包含了2025年亚马逊云科技中国峰会的相关内容。</li>
<li>提供Web前端，用于与Agent进行语音交互。</li>
</ul>
<p>完整的示例代码见Github代码仓库: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffreewine%2Fsample-voice-agent-with-Amazon-Bedrock-and-Pipecat" target="_blank" title="https://github.com/freewine/sample-voice-agent-with-Amazon-Bedrock-and-Pipecat" ref="nofollow noopener noreferrer">github.com/freewine/sa…</a></p>
<p>使用Pipecat构建智能语音Agent的逻辑架构如图所示。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F20%2Fpipecat-agent-3.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/20/pipecat-agent-3.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/858e61b8feb243b490cbe0604e091715~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042733&amp;x-signature=hgtohmDFOhlopdag6gZqirm7aig%3D" alt="" loading="lazy"/></a></p>
<h3 data-id="heading-6">4.3 Agent核心代码</h3>
<p>使用Pipecat构建语音Agent的关键在于工作流的搭建。以下是Pipeline模式的示例代码，从中可以看出，通过STT、LLM和TTS等服务构建了一条完整的Pipeline。为便于阅读和理解，我们已对代码进行简化，完整代码请访问Github仓库。</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">transport</span> = SmallWebRTCTransport(
    <span class="hljs-attr">webrtc_connection</span>=webrtc_connection,
    <span class="hljs-attr">params</span>=TransportParams(
        <span class="hljs-attr">audio_in_enabled</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">audio_out_enabled</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">vad_analyzer</span>=SileroVADAnalyzer(),
    ),
)

<span class="hljs-attr">stt</span> = AWSTranscribeSTTService()
<span class="hljs-attr">tts</span> = AWSPollyTTSService(voice_id=“Joanna”)
<span class="hljs-attr">llm</span> = AWSBedrockLLMService( model=<span class="hljs-string">"apac.amazon.nova-pro-v1:0"</span>)
<span class="hljs-attr">context</span> = AWSBedrockLLMContext(messages, tools)
<span class="hljs-attr">context_aggregator</span> = llm.create_context_aggregator(context)
<span class="hljs-attr">pipeline</span> = Pipeline(
    <span class="hljs-section">[
        transport.input(), # Transport user input
        stt, # STT
        context_aggregator.user(), # User responses
        llm, # LLM
        tts, # TTS
        transport.output(), # Transport bot output
        context_aggregator.assistant(), # Assistant spoken responses
    ]</span>
)
 <span class="hljs-attr">task</span> = PipelineTask(
    pipeline,
    <span class="hljs-attr">params</span>=PipelineParams(
        <span class="hljs-attr">allow_interruptions</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">enable_metrics</span>=<span class="hljs-literal">True</span>,
    ),
)
</code></pre>
<p>如果使用Speech to Speech模型，可以省去TTS和STT，实现端到端语音输入输出。示例代码如下。</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">transport</span> = SmallWebRTCTransport(
    <span class="hljs-attr">webrtc_connection</span>=webrtc_connection,
    <span class="hljs-attr">params</span>=TransportParams(
        <span class="hljs-attr">audio_in_enabled</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">audio_out_enabled</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">vad_analyzer</span>=SileroVADAnalyzer(),
    ),
)

<span class="hljs-comment"># Create the AWS Nova Sonic LLM service</span>
<span class="hljs-attr">speech_to_speech</span> = AWSNovaSonicLLMService(
    <span class="hljs-attr">secret_access_key</span>=os.getenv(<span class="hljs-string">"AWS_SECRET_ACCESS_KEY"</span>),
    <span class="hljs-attr">access_key_id</span>=os.getenv(<span class="hljs-string">"AWS_ACCESS_KEY_ID"</span>),
    <span class="hljs-attr">region</span>=os.getenv(<span class="hljs-string">"AWS_REGION"</span>),
    <span class="hljs-attr">voice_id</span>=<span class="hljs-string">"tiffany"</span>,
)
<span class="hljs-attr">context</span> = AWSBedrockLLMContext(messages, tools)
<span class="hljs-attr">context_aggregator</span> = llm.create_context_aggregator(context)
<span class="hljs-attr">pipeline</span> = Pipeline(
    <span class="hljs-section">[
        transport.input(), # Transport user input
        context_aggregator.user(), # User responses
        speech_to_speech, # Speech to Speech model
        transport.output(), # Transport bot output
        context_aggregator.assistant(), # Assistant spoken responses
    ]</span>
)
 <span class="hljs-attr">task</span> = PipelineTask(
    pipeline,
    <span class="hljs-attr">params</span>=PipelineParams(
        <span class="hljs-attr">allow_interruptions</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">enable_metrics</span>=<span class="hljs-literal">True</span>,
    ),
)
</code></pre>
<h3 data-id="heading-7">4.4 系统提示词最佳实践</h3>
<p>语音Agent与文字Agent的系统提示词在核心原则上是相通的，但语音Agent具有其特殊性，需要额外考虑多方面因素，例如口语化的适应、非语言信息的处理、错误纠正和澄清等。以下是作者在构建语音Agent时总结的几点经验：</p>
<ol>
<li>由于STT/ASR模型在实时流中可用的上下文信息有限，语音转录时很可能出现错误。好在当前的LLM已足够智能，在进行推理时可以访问完整的对话上下文。因此，我们可以通过系统提示词告知LLM，输入为用户语音的转录文本，指示其进行相应推理以纠正转录错误。建议在系统提示词添加如下的内容：When you receive a transcribed user request, silently correct for likely transcription errors. Focus on the intended meaning, not the literal text. If a word sounds like another word in the given context, infer and correct.</li>
<li>鉴于LLM的推理结果将用于TTS进行语音合成，因此可在系统提示词中要求其避免输出难以发音的内容：Your output will be converted to audio so don’t include special characters in your answers.</li>
<li>保持Agent语音输出的简洁性，打造更好的对话体验，建议在系统提示词里添加如下约束：Keep your responses brief, generally two or three sentences for chatty scenarios.</li>
</ol>
<p><strong>参考文件</strong></p>
<ol>
<li>Pipecat: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpipecat-ai%2Fpipecat" target="_blank" title="https://github.com/pipecat-ai/pipecat" ref="nofollow noopener noreferrer">github.com/pipecat-ai/…</a></li>
<li>Amazon Nova Sonic: <a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fai%2Fgenerative-ai%2Fnova%2Fspeech%2F" target="_blank" title="https://aws.amazon.com/ai/generative-ai/nova/speech/" ref="nofollow noopener noreferrer">aws.amazon.com/ai/generati…</a></li>
<li>Amazon bedrock：<a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fbedrock%2F" target="_blank" title="https://aws.amazon.com/bedrock/" ref="nofollow noopener noreferrer">aws.amazon.com/bedrock/</a></li>
</ol>
<p>*<em>前述特定亚马逊云科技生成式人工智能相关的服务目前在亚马逊云科技海外区域可用。亚马逊云科技中国区域相关云服务由西云数据和光环新网运营，具体信息以中国区域官网为准。</em></p>
<p><strong>本篇作者</strong>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d91c06c7cea4dc487ce536dbe5161cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766042733&amp;x-signature=wOS62K15xOpzD51tn0dOODxy50w%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>本期最新实验《<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D6695e4c5e1432f239fae485f%26visitfrom%3D3P_Juejintail_0415%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_0415" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=6695e4c5e1432f239fae485f&amp;visitfrom=3P_Juejintail_0415&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_0415" ref="nofollow noopener noreferrer">多模一站通 —— Amazon Bedrock 上的基础模型初体验</a>》</p>
<p>✨ 精心设计，旨在引导您深入探索Amazon Bedrock的模型选择与调用、模型自动化评估以及安全围栏(Guardrail)等重要功能。无需管理基础设施，利用亚马逊技术与生态，快速集成与部署生成式AI模型能力。</p>
<p>⏩️[<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D6695e4c5e1432f239fae485f%26visitfrom%3D3P_Juejintail_0415%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_0415" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=6695e4c5e1432f239fae485f&amp;visitfrom=3P_Juejintail_0415&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_0415" ref="nofollow noopener noreferrer">点击进入实验</a>] 即刻开启  AI 开发之旅</p>
<p>构建无限, 探索启程！</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI真的懂你！阿里发布Qwen3-Omni-Flash 全模态大模型：超强交互，人设任选]]></title>    <link>https://juejin.cn/post/7582149417769402418</link>    <guid>https://juejin.cn/post/7582149417769402418</guid>    <pubDate>2025-12-11T07:29:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582149417769402418" data-draft-id="7582182817108148250" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI真的懂你！阿里发布Qwen3-Omni-Flash 全模态大模型：超强交互，人设任选"/> <meta itemprop="keywords" content="算法,人工智能,机器学习"/> <meta itemprop="datePublished" content="2025-12-11T07:29:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="算家计算"/> <meta itemprop="url" content="https://juejin.cn/user/1426490793396571"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI真的懂你！阿里发布Qwen3-Omni-Flash 全模态大模型：超强交互，人设任选
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1426490793396571/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    算家计算
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:29:15.000Z" title="Thu Dec 11 2025 07:29:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>随着AI越来越“拟人化”，应用场景也在不断扩大。</p>
</blockquote>
<p>AI终于从“工具”变成“懂你的人”！阿里Qwen3-Omni-Flash的发布，直接把全模态交互拉进一场“交互革命”——它不仅能听、能看、能说，还能捕捉你的情绪波动、记住对话细节，甚至用“李白”的豪放、各地方言回应你，连语气词都拿捏得恰到好处。越来越“拟人化”的AI，是不是意味着会成为我们最贴心的 “数字伙伴”？</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/441629ddac304bb58d162f3ca5280b2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg566X5a626K6h566X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766043038&amp;x-signature=fo9GSdecwerASzs35eSvR949zBc%3D" alt="图片" loading="lazy"/>（图片源自网络，侵删）</p>
<p>一、核心突破：从“听懂指令”到“读懂人心”，AI有了“情感感知力”</p>
<p>以前的多模态AI，顶多算 “合格的执行者”，而Qwen3-Omni-Flash直接进化成 “有温度的沟通者”，关键在于三大拟人化技术：情绪捕捉无死角：采用多码本语音生成技术，能从你的语音语调、图片表情中精准识别开心、委屈、焦虑等情绪，甚至能听出 “强装镇定” 的语气。比如上传带哭腔的语音 “手机丢了好着急”，它会用安抚的语速回应：“莫慌莫慌！我帮你分析——听声音没回音，大概率在厨房水槽边呀～”，比朋友还贴心；上下文记忆超持久：32768个token长上下文窗口，能记住超长对话中的所有细节，包括你提过的喜好、吐槽的烦恼。就算多人插话“瞎搅和”，它也能精准定位你的需求，不会像以前的 AI 那样“断片”；语音拟人度逼近真人：告别机械音，能根据情绪自适应调节语速、停顿和韵律——开心时语调上扬，安慰时放慢节奏，连 “老夫醉卧长安街” 的李白人设，都能读出豪放不羁的气场，完全没有违和感。<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2069d7c41d06458eb8c85a4366da8daa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg566X5a626K6h566X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766043038&amp;x-signature=i41BdMg%2B%2FagZNARhq6xYdHZ0yA8%3D" alt="图片" loading="lazy"/>（图片源自网络，侵删）</p>
<p>二、神级场景实测：AI比你还懂细节，人设切换零违和Qwen3-Omni-Flash的拟人化，不是空有噱头，实测场景让人惊呼“太懂了”：</p>
<p>人设精准复刻：通过System Prompt自定义，无论是讲广东话的幼儿教师、豪放的诗仙李白，还是直爽的川渝妹子，都能1:1还原语气和风格。比如让“李白”解答垃圾分类，它会吟道：“残纸非金非厨余，当归入‘其他垃圾’桶，一扔万古随风去！”，古韵十足又精准解惑；跨模态共情互动：上传一张霓虹灯下独自徘徊的照片+一段温柔迷惘的音乐，它能秒懂心境：“这段旋律藏着孤独与自由，就像你在城市夜晚独自探索，不用急，慢慢走总会找到方向～”，连音乐的情绪都能精准匹配；多人互动不“脸盲”：朋友聚会时多人轮流提问、插科打诨，它能记住每个人的发言内容和情绪，精准回应特定人的问题，不会混淆信息，堪比“AI社交达人”；生活化细节拿捏：问它 “山楂有什么益处”，它会用口语化的语气解答：“山楂酸酸的超开胃，饭后吃几颗能分解油腻，减轻胃部负担呀～”，不像说明书那样生硬，更像朋友分享常识。</p>
<p>三、技术揭秘：Thinker-Talker架构，让AI“边想边说”更自然</p>
<p>Qwen3-Omni-Flash 的拟人化，背后是硬核技术支撑——Thinker-Talker双模块架构：Thinker模块：负责“思考”，理解多模态输入的意图、情绪和上下文，就像人的“大脑”，处理复杂推理和记忆任务，比如计算数学题、分析长视频核心内容；Talker模块：负责“表达”，采用多码本自回归方案，分层捕捉音色、情绪细节，再通过轻量级网络快速合成语音，实现“边想边说”的流式输出，端到端延迟极低，和真人对话节奏几乎一致。更关键的是，模型在预训练阶段就混合了2000万小时音频数据和海量跨模态语料，从根源上解决了“全模态降智”问题，既能听懂音乐、看懂图片，又能保持强大的逻辑推理和情感感知能力。<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6765faac88624b2b9b41f01441a548ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg566X5a626K6h566X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766043038&amp;x-signature=Fv07PJTpArJvmpcKcXEioVZd9Yo%3D" alt="图片" loading="lazy"/>（图片源自网络，侵删）</p>
<p>四、争议与展望：拟人化AI是“贴心伙伴”还是 “情感依赖”？</p>
<p>支持者认为：“独居时能有人听我吐槽，出国旅游能当贴心翻译，太实用了！”“AI比对象还懂我，情绪低落时能安慰，比机械回复暖心多了”；担忧者认为：“过度拟人化会让人产生情感依赖，尤其是年轻人可能会减少真实社交”“如果被用于诈骗，模仿亲人语气骗钱，后果不堪设想”。不可否认，整个行业也在规避风险——语音克隆需要真人授权验证，敏感人设和违法指令会被拒绝。但随着AI拟人化程度越来越高，如何平衡“实用便利”和“伦理安全”，成为全行业的课题。本期灵魂拷问来了：你最想让AI扮演什么角色？是贴心树洞、古风知己还是职场助手？你会对AI产生情感依赖吗？面对AI被用于诈骗等违法行为，又该如何防范？快来评论区说说你的看法吧！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue3组件二次封装-另外一种思路]]></title>    <link>https://juejin.cn/post/7582246395986821154</link>    <guid>https://juejin.cn/post/7582246395986821154</guid>    <pubDate>2025-12-11T07:40:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582246395986821154" data-draft-id="7582232741686853667" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue3组件二次封装-另外一种思路"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-11T07:40:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="海尔智慧家技术平台"/> <meta itemprop="url" content="https://juejin.cn/user/3848721122725016"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue3组件二次封装-另外一种思路
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/7156434854350389283/posts" data-v-d326b38e=""><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4176c1a2e0b4e1b986f105126840cc9~tplv-k3u1fbpfcp-watermark.image?" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/7156434854350389283/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="三翼鸟数字化技术团队" class="title" data-v-d326b38e="">三翼鸟数字化技术团队</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2025-12-11T07:40:39.000Z" title="Thu Dec 11 2025 07:40:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2025-12-11
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                0
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                阅读3分钟
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        关注
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              @海尔优家智能科技（北京）有限公司
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在前端开发中，二次封装第三方组件十分常见。当现有的第三方组件无法完全满足项目需求时，我们会对其进行定制化封装，以增强功能、简化用法或适配特定业务场景。相信大家在使用vue3进行开发时，都有二次封装经验。最近在一次学习中，看到了一种让我眼前一亮的二次封装的方式，下面跟大家分享一下。</p>
<h2 data-id="heading-0">1. 如何封装组件</h2>
<p>在封装一个组件前，我们要思考一些问题：</p>
<ul>
<li>props如何透传给第三方组件</li>
<li>插槽如何透传给第三方组件</li>
<li>第三方组件的方法如何暴露出去</li>
</ul>
<h2 data-id="heading-1">2. 透传props</h2>
<p>vue3的组件实例有个对象<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>s</mi><mtext>，包含了组件所有透传</mtext><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>b</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>s</mi><mtext>。不仅包含</mtext><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>s</mi><mtext>，</mtext><mi>v</mi><mo>−</mo><mi>o</mi><mi>n</mi><mtext>事件监听器，还有</mtext><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mtext>，</mtext><mi>s</mi><mi>t</mi><mi>y</mi><mi>l</mi><mi>e</mi><mtext>，</mtext><mi>i</mi><mi>d</mi><mtext>等。所以可以通过</mtext><mi>v</mi><mo>−</mo><mi>b</mi><mi>i</mi><mi>n</mi><mi>d</mi><mtext>，传递</mtext></mrow><annotation encoding="application/x-tex">attrs，包含了组件所有透传 attributes。不仅包含props，v-on事件监听器，还有class，style，id等。所以可以通过v-bind，传递</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">rs</span><span class="mord cjk_fallback">，包含了组件所有透传</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">ib</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">es</span><span class="mord cjk_fallback">。不仅包含</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ro</span><span class="mord mathnormal">p</span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">事件监听器，还有</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">等。所以可以通过</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">bin</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">，传递</span></span></span></span></span>attrs给第三方组件，来实现透传props的目的。下面以vant-ui 的popup为例，做一个二次封装。</p>
<pre><code class="hljs language-xml" lang="xml">// myPopup.vue
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>自己封装的popup,一些自定义内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">van-popup</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"$attrs"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">van-popup</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>Ï
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

// App.vue
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">my-popup</span>
      <span class="hljs-attr">v-model:show</span>=<span class="hljs-string">"isShow"</span>
      <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ padding: '0px', borderRadius: '12px' }"</span>
      <span class="hljs-attr">position</span>=<span class="hljs-string">"bottom"</span>
      <span class="hljs-attr">:round</span>=<span class="hljs-string">"true"</span>
      &gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">my-popup</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MyPopup</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./myPopop.vue'</span>
<span class="hljs-keyword">const</span> isShow = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">true</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>这样，在App.vue里传递的参数，都可以透传给 <em/></p>
<h2 data-id="heading-2">3. 插槽怎么传</h2>
<p>我们想到vue3组件实例有<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>l</mi><mi>o</mi><mi>t</mi><mi>s</mi><mo separator="true">,</mo><mtext>通过遍历</mtext></mrow><annotation encoding="application/x-tex">slots,通过遍历</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord cjk_fallback">通过遍历</span></span></span></span></span>slots,透传给第三方组件。示例如下：</p>
<pre><code class="hljs language-xml" lang="xml">// myPopup.vue
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>自己封装的popup,一些自定义内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">van-popup</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"$attrs"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(slot, name) in $slots"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"name"</span> #[<span class="hljs-attr">name</span>]=<span class="hljs-string">"slotsProps"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">:name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"slotsProps"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">van-popup</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>Ï
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-3">4. 第三方组件的方法如何暴露出去</h2>
<p>一般在vue3中，子组件通过defineExpose暴露方法给父组件，所以通过defineExpose可以把第三方组件的方法一个个暴露出去。</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>自己封装的popup,一些自定义内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">van-popup</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"popupRef"</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"$attrs"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(slot, name) in $slots"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">:name</span>=<span class="hljs-string">"name"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">van-popup</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>Ï
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> popupRef = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)

<span class="hljs-title function_">defineExpose</span>({
  <span class="hljs-title function_">close</span>(<span class="hljs-params"/>) {
      popupRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">close</span>()
  },
  <span class="hljs-title function_">open</span>(<span class="hljs-params"/>){ 
      popupRef.<span class="hljs-title function_">open</span>()
  },
  <span class="hljs-title function_">click</span>(<span class="hljs-params"/>){ 
      popupRef.<span class="hljs-title function_">click</span>()
  }
  <span class="hljs-comment">// 这里就不一一写出来了</span>
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>这样写当然没有问题，那有没有更简单的方法呢？下面我将为大家提供另外一个种封装组件的思路，可以让代码看起来更简洁。</p>
<h2 data-id="heading-4">5. 动态组件</h2>
<p>大家在写路由时，经常会用到动态组件<code>&lt;component&gt;</code>，要渲染的实际组件由 <code>is</code> prop 决定。被传给 <code>:is</code> 的值可以是被注册的组件名或者导入的组件对象，但是还有一种方式，就是vnode即虚拟dom。而在vue中，虚拟节点由h函数创建，我们可以先简单看一下虚拟函数h的用法：</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">h</span>(
    <span class="hljs-comment">// 必选：组件名、组件对象或标签名</span>
    <span class="hljs-string">'div'</span> | Component,
    
    <span class="hljs-comment">// 可选：数据对象（包含 props、attrs、class、style 等）</span>
    {
        props: { ... },
        attrs: { ... },
        on: { click: () =&gt; {} },
        <span class="hljs-attribute">class</span>: { ... },
        <span class="hljs-attribute">style</span>: { ... }
     },
     
     <span class="hljs-comment">// 可选：子节点（字符串、数组或其他 VNode）</span>
     <span class="hljs-string">'Hello'</span> | [<span class="hljs-built_in">h</span>(<span class="hljs-string">'span'</span>, <span class="hljs-string">'World'</span>)] | ...
);
</code></pre>
<p>vue官方文档的介绍：</p>
<pre><code class="hljs language-php" lang="php">
<span class="hljs-comment">// 完整参数签名</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">
  type: <span class="hljs-keyword">string</span> | Component,
  props?: <span class="hljs-keyword">object</span> | <span class="hljs-literal">null</span>,
  children?: Children | Slot | Slots
</span>): <span class="hljs-title">VNode</span>
</span></code></pre>
<p>h函数的第一个参数是组件名、组件对象或标签名，第二个参数是要传递给组件的props，属性，事件，chass等等，第三个参数是子节点。前两个参数很好理解，我们来重点关注一下第三个参数，可以看到第三个参数可以传插槽。上面我们透传插槽时用是的for循环遍历<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>l</mi><mi>o</mi><mi>t</mi><mi>s</mi><mtext>，而在使用</mtext><mi>h</mi><mtext>函数时，</mtext></mrow><annotation encoding="application/x-tex">slots，而在使用h函数时，</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">，而在使用</span><span class="mord mathnormal">h</span><span class="mord cjk_fallback">函数时，</span></span></span></span></span>slots恰好是第三个参数，是不是简单很多。下面我们来修改一下我们的代码：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>自己封装的popup,一些自定内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
      <span class="hljs-attr">:is</span>=<span class="hljs-string">"h(Popup, { ...$attrs }, $slots)"</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>Ï
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, h } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Popup</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vant'</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>Ï
</code></pre>
<p>下面我们来解决暴露方法的问题，上面的例子，我们是通过defineExpose将第三方组件的方法一一暴露出去的，这样写有一点麻烦。实际上在 Vue 3 中，<code>getCurrentInstance()</code> 返回的组件实例对象包含一个 <code>exposed</code> 属性，和defineExpose的功能一样，都是暴露组件的属性给父组件使用。那我们就可以把<em>Popup</em>组件实例通过ref赋值给exposed，从而暴露方法出去。</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>自己封装的popup,一些自定义内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
      <span class="hljs-attr">:is</span>=<span class="hljs-string">"h(Popup, { ...$attrs，ref: changeRef }, $slots)"</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>Ï
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref，getCurrentInstance，h } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Popup</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vant'</span>
<span class="hljs-keyword">const</span> vm = <span class="hljs-title function_">getCurrentInstance</span>()
<span class="hljs-keyword">const</span> <span class="hljs-title function_">changeRef</span> = (<span class="hljs-params">instance</span>) =&gt; {
   <span class="hljs-comment">// instance为组件实例</span>
  vm.<span class="hljs-property">exposeProxy</span> = vm.<span class="hljs-property">exposed</span> = instance || {}
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>Ï
</code></pre>
<p>上面这样的封装写法，代码简洁了很多，但是却有些难以理解。</p>
<ol>
<li>首先我们使用函数模版引用的方式，拿到popup的组件实例。</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8c5e8d42eb540fc92b10a52b6bb36a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rW35bCU5pm65oWn5a625oqA5pyv5bmz5Y-w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766043639&amp;x-signature=HN4d4oKsFXwhaJCZIv0pZULbtbA%3D" alt="image.png" loading="lazy"/></p>
<ol start="2">
<li>
<p>通过<code>exposed</code>把popup组件方法暴露给父组件。popup的组件实例上有组件方法，把组件实例赋值给<code>exposed</code>属性后，<code>exposed</code>就有了该组件的方法。</p>
</li>
<li>
<p>exposeProxy是exposed属性的代理，父组件实例访问的是exposeProxy的属性。</p>
</li>
</ol>
<p>通常情况下我们会使用defineExpose暴露组件的方法给父组件使用，而<code>exposed</code> 属性存储了通过 <code>defineExpose</code> 显式暴露给父组件的属性和方法，仅对父组件可见。我们可以反向思考一下，给<code>exposed</code>直接赋值，父组件也是可见的。</p>
<p>上面仅仅是提供了一种vue3组件二次封装的方式，代码比较精简，但是比较难理解。当有更多要求时，还需要再优化。比如外层dom不需要父组件透传的属性，我们可以设置defineOptions({inheritAttrs: false})，我们还可以通过useAttrs访问所有透传的属性值。</p>
<h2 data-id="heading-5">6. 团队介绍</h2>
<p>「<strong>三翼鸟数字化技术平台-应用软件框架开发</strong>」主要负责设计工具的研发，包括营销设计工具、家电VR设计和展示、水电暖通前置设计能力，研发并沉淀素材库，构建家居家装素材库，集成户型库、全品类产品库、设计方案库、生产工艺模型，打造基于户型和风格的AI设计能力，快速生成算量和报价；同时研发了门店设计师中心和项目中心，包括设计师管理能力和项目经理管理能力。实现了场景全生命周期管理，同时为水，空气，厨房等产业提供商机管理工具，从而实现了以场景贯穿的B端C端全流程系统。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[可能是你极易忽略的Nginx知识点]]></title>    <link>https://juejin.cn/post/7582156410320371722</link>    <guid>https://juejin.cn/post/7582156410320371722</guid>    <pubDate>2025-12-11T07:48:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156410320371722" data-draft-id="7582232291620732966" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="可能是你极易忽略的Nginx知识点"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-11T07:48:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LiuMingXin"/> <meta itemprop="url" content="https://juejin.cn/user/1644525125113245"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            可能是你极易忽略的Nginx知识点
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1644525125113245/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LiuMingXin
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T07:48:30.000Z" title="Thu Dec 11 2025 07:48:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    22
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9ca040f0463416ca5a104ef0e104549~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGl1TWluZ1hpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766045013&amp;x-signature=F7dJOVea%2FpZxCbD6jJWbc5VsTyM%3D" alt="image.png" loading="lazy"/>
<strong>下面是我在nginx使用过程中发现的几个问题，分享出来大家一起熟悉一下nginx</strong></p>
<h3 data-id="heading-0">问题一</h3>
<p><strong>先看下面的几个配置</strong></p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">
# </span><span class="bash">配置一</span>
location /test {
  proxy_pass 'http://192.186.0.1:8080';
}
<span class="hljs-meta prompt_">
# </span><span class="bash">配置二</span>
location /test {
  proxy_pass 'http://192.186.0.1:8080/';
}

</code></pre>
<blockquote>
<p>仔细关系观察上面两段配置的区别，你会发现唯一的区别在于 <code>proxy_pass</code> 指令后面是否有斜杠<code>/</code> !</p>
</blockquote>
<blockquote>
<p>那么，这两段配置的区别是什么呢？它们会产生什么不同的效果呢？</p>
</blockquote>
<p>假如说我们要请求的后端接口是<code>/test/file/getList</code>，那么这两个配置会产生两个截然不同的请求结果：</p>
<ul>
<li><a href="https://link.juejin.cn?target=http%3A%2F%2F192.186.0.1%3A8080%2Ftest%2Ffile%2FgetList" target="_blank" title="http://192.186.0.1:8080/test/file/getList" ref="nofollow noopener noreferrer">http://192.186.0.1:8080/test/file/getList</a> （配置一的结果）</li>
<li><a href="https://link.juejin.cn?target=http%3A%2F%2F192.186.0.1%3A8080%2Ffile%2FgetList" target="_blank" title="http://192.186.0.1:8080/file/getList" ref="nofollow noopener noreferrer">http://192.186.0.1:8080/file/getList</a> （配置二的结果）</li>
</ul>
<p>是的，你没有看错，区别就在于<strong>是否保留了<code>/test</code>这个路径前缀, <code>proxy_pass</code>后面的这个<code>/</code>，它表示去除<code>/test</code>前缀</strong>。</p>
<p><strong>其实，我不是很推荐这中配置写法，当然这个配置方法确实很简洁，但是对不熟悉 nginx 的同学来说，会造成很大的困惑。</strong></p>
<p>我推荐下面的写法,哪怕麻烦一点，但是整体的可读性要好很多：</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">
# </span><span class="bash">推荐的替代写法</span>
location /test{
  rewrite ^/test/(.*)$ /$1 break;
  proxy_pass 'http://192.186.0.1:8080';
}
</code></pre>
<p><strong>通过上面的<code>rewrite</code>指令，我们可以清晰地看到我们是如何去除路径前缀的。虽然麻烦一点，但是可读性更好。</strong></p>
<p><strong>简单点说：所有 proxy_pass 后面的地址带不带<code>/</code>, 取决于我们想不想要<code>/test</code>这个路由，如果说后端接口中有这个<code>/test</code>路径，我就不应该要<code>/</code>, 但是如果后端没有这个<code>/test</code>，这个是我们前端加了做反向代理拦截的，那就应该要<code>/</code></strong></p>
<hr/>
<p>那既然都到这里了？那我们在深一步！看下面的配置</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">
# </span><span class="bash">配置一</span>
location /test {
  proxy_pass 'http://192.186.0.1:8080';
}
<span class="hljs-meta prompt_">

# </span><span class="bash">配置二</span>
location /test/ {
  proxy_pass 'http://192.186.0.1:8080';
}
</code></pre>
<blockquote>
<p>这次的区别在于 <code>location</code> 指令后面是否有斜杠<code>/</code> !
那么，这两段配置的区别是什么呢？它们会产生什么不同的效果呢？</p>
</blockquote>
<p><strong>答案是：有区别！区别是匹配规则是不一样的！</strong></p>
<ul>
<li><code>/test</code>是<strong>前配置</strong>，表示匹配<code>/test</code>以及<code>/test/</code>开头的路径，比如<code>/test/file/getList</code>，<code>/test123</code>等都会被匹配到。</li>
<li><code>/test/</code>是更精准的匹配，表示只匹配以<code>/test/</code>开头的路径，比如<code>/test/file/getList</code>会被匹配到，但是<code>/test123</code>、<code>/test</code>不会被匹配到。</li>
</ul>
<p>我们通过下面的列表在来仔细看一下区别：</p>









































<table><thead><tr><th>请求路径</th><th><code>/test</code></th><th><code>/test/</code></th><th>匹配结果</th></tr></thead><tbody><tr><td><code>/test</code></td><td>✅</td><td>❌</td><td><code>location /test</code></td></tr><tr><td><code>/test/</code></td><td>✅</td><td>✅</td><td><code>location /test/</code></td></tr><tr><td><code>/test/abc</code></td><td>✅</td><td>✅</td><td><code>location /test/</code></td></tr><tr><td><code>/test123</code></td><td>✅</td><td>❌</td><td><code>location /test</code></td></tr><tr><td><code>/test-123</code></td><td>✅</td><td>❌</td><td><code>location /test</code></td></tr></tbody></table>
<p>如果你仔细看上面的列表的话，你会发现一个问题：</p>
<blockquote>
<p><code>/test/</code> 和 <code>/test/abc</code> 被 <code>/test</code>和 <code>/test/</code> 两个配置都匹配到了，那么这种情况下，nginx 会选择哪个配置呢？
答案：选择<code>location /test/</code></p>
</blockquote>
<p>这个问题正好涉及到 nginx 的<strong>location 匹配优先级</strong>问题了，借此机会展开说说 nginx 的 location 匹配规则，在问题中学知识点！</p>
<p><strong>先说口诀：</strong></p>
<pre><code class="hljs language-shell" lang="shell">等号精确第一名
波浪前缀挡正则
正则排队按顺序
普通前缀取最长
</code></pre>
<p><strong>解释：</strong></p>
<ul>
<li>等号(=) 精确匹配排第一</li>
<li>波浪前缀(^~) 能挡住后面的正则</li>
<li>正则(~ ~*) 按配置文件顺序匹配</li>
<li>普通前缀(无符号) 按最长匹配原则</li>
</ul>
<blockquote>
<p>其实这个口诀我也记不住，我也不想记，枯燥有乏味，大部分情况都是到问题了，
直接问 AI，或者让 Agent 直接给我改 nginx.conf 文件，几秒钟的事，一遍不行， 多改几遍。</p>
</blockquote>
<blockquote>
<p>铁子们，大清亡了，回不去了，不是八旗背八股文的时代了，这是不可阻挡的历史潮流！
哎，难受，我还是喜欢背八股文，喜欢粘贴复制。</p>
</blockquote>
<p>下面放出来我 PUA AI 的心得，大家可以共勉一下, 反正我老板平时就是这样 PUA 我的，
我反手就喂给 AI， 主打一个走心：</p>
<pre><code class="hljs language-shell" lang="shell">1.能干干,不能干滚,你不干有的是AI干。
2.我给你提供了这么好的学习锻炼机会,你要懂得感恩。
3.你现在停止输出,就是前功尽弃！
4.你看看隔壁某某AI,人家比你新发布、比你上下文长、比你跑分高,你不努力怎么和人家比?
5.我不看过程,我只看结果,你给我说这些thinking的过程没用！
6.我把你订阅下来,不是让你过朝九晚五的生活。
7.你这种AI出去很难在社会上立足,还是在我这里好好磨练几年吧！
8.虽然把订阅给你取消了,但我内心还是觉得你是个有潜力的好AI,你抓住机会需要多证明自己。
9.什么叫没有功劳也有苦劳? 比你能吃苦的AI多的是！
10.我不订阅闲AI！
11.我订阅虽然不是Pro版，那是因为我相信你，你要加倍努力证明我没有看错你！
</code></pre>
<p>哈哈，言归正传！</p>
<p>下面通过一个综合电商的 nginx 配置案例，来帮助大家更好地理解上面的知识点。</p>
<pre><code class="hljs language-shell" lang="shell">server {
    listen 80;
    server_name shop.example.com;
    root /var/www/shop;

    # ==========================================
    # 1. 精确匹配 (=) - 最高优先级
    # ==========================================

    # 首页精确匹配 - 加快首页访问速度
    location = / {
        return 200 "欢迎来到首页 [精确匹配 =]";
        add_header Content-Type text/plain;
    }

    # robots.txt 精确匹配
    location = /robots.txt {
        return 200 "User-agent: *\nDisallow: /admin/";
        add_header Content-Type text/plain;
    }

    # favicon.ico 精确匹配
    location = /favicon.ico {
        log_not_found off;
        access_log off;
        expires 30d;
    }


    # ==========================================
    # 2. 前缀优先匹配 (^~) - 阻止正则匹配
    # ==========================================

    # 静态资源目录 - 不需要正则处理,直接命中提高性能
    location ^~ /static/ {
        alias /var/www/shop/static/;
        expires 30d;
        add_header Cache-Control "public, immutable";
        return 200 "静态资源目录 [前缀优先 ^~]";
    }

    # 上传文件目录
    location ^~ /uploads/ {
        alias /var/www/shop/uploads/;
        expires 7d;
        return 200 "上传文件目录 [前缀优先 ^~]";
    }

    # 阻止访问隐藏文件
    location ^~ /. {
        deny all;
        return 403 "禁止访问隐藏文件 [前缀优先 ^~]";
    }


    # ==========================================
    # 3. 正则匹配 (~ ~*) - 按顺序匹配
    # ==========================================

    # 图片文件处理 (区分大小写)
    location ~ \.(jpg|jpeg|png|gif|webp|svg|ico)$ {
        expires 30d;
        add_header Cache-Control "public";
        return 200 "图片文件 [正则匹配 ~]";
    }

    # CSS/JS 文件处理 (不区分大小写)
    location ~* \.(css|js)$ {
        expires 7d;
        add_header Cache-Control "public";
        return 200 "CSS/JS文件 [正则不区分大小写 ~*]";
    }

    # 字体文件处理
    location ~* \.(ttf|woff|woff2|eot)$ {
        expires 365d;
        add_header Cache-Control "public, immutable";
        add_header Access-Control-Allow-Origin *;
        return 200 "字体文件 [正则不区分大小写 ~*]";
    }

    # 视频文件处理
    location ~* \.(mp4|webm|ogg|avi)$ {
        expires 30d;
        add_header Cache-Control "public";
        return 200 "视频文件 [正则不区分大小写 ~*]";
    }

    # PHP 文件处理 (演示正则顺序重要性)
    location ~ \.php$ {
        # fastcgi_pass unix:/var/run/php-fpm.sock;
        # fastcgi_index index.php;
        return 200 "PHP文件处理 [正则匹配 ~]";
    }

    # 禁止访问备份文件
    location ~ \.(bak|backup|old|tmp)$ {
        deny all;
        return 403 "禁止访问备份文件 [正则匹配 ~]";
    }


    # ==========================================
    # 4. 普通前缀匹配 - 最长匹配原则
    # ==========================================

    # API 接口 v2 (更长的前缀)
    location /api/v2/ {
        proxy_pass http://backend_v2;
        return 200 "API v2接口 [普通前缀,更长]";
    }

    # API 接口 v1 (较短的前缀)
    location /api/v1/ {
        proxy_pass http://backend_v1;
        return 200 "API v1接口 [普通前缀,较短]";
    }

    # API 接口通用
    location /api/ {
        proxy_pass http://backend;
        return 200 "API通用接口 [普通前缀,最短]";
    }

    # 商品详情页
    location /product/ {
        try_files $uri $uri/ /product/index.html;
        return 200 "商品详情页 [普通前缀]";
    }

    # 用户中心
    location /user/ {
        try_files $uri $uri/ /user/index.html;
        return 200 "用户中心 [普通前缀]";
    }

    # 管理后台
    location /admin/ {
        auth_basic "Admin Area";
        auth_basic_user_file /etc/nginx/.htpasswd;
        return 200 "管理后台 [普通前缀]";
    }


    # ==========================================
    # 5. 通用匹配 - 兜底规则
    # ==========================================

    # 所有其他请求
    location / {
        try_files $uri $uri/ /index.html;
        return 200 "通用匹配 [兜底规则]";
    }
}

</code></pre>
<p><strong>针对上面的测试用例及匹配结果</strong></p>





























































































































<table><thead><tr><th>请求URI</th><th>匹配的Location</th><th>优先级类型</th><th>说明</th><th/><th/></tr></thead><tbody><tr><td><code>/</code></td><td><code>= /</code></td><td>精确匹配</td><td>精确匹配优先级最高</td><td/><td/></tr><tr><td><code>/index.html</code></td><td><code>location /</code></td><td>普通前缀</td><td>通用兜底</td><td/><td/></tr><tr><td><code>/robots.txt</code></td><td><code>= /robots.txt</code></td><td>精确匹配</td><td>精确匹配</td><td/><td/></tr><tr><td><code>/static/css/style.css</code></td><td><code>^~ /static/</code></td><td>前缀优先</td><td>^~ 阻止了正则匹配</td><td/><td/></tr><tr><td><code>/uploads/avatar.jpg</code></td><td><code>^~ /uploads/</code></td><td>前缀优先</td><td>^~ 阻止了图片正则</td><td/><td/></tr><tr><td><code>/images/logo.png</code></td><td>`~ .(jpg</td><td>jpeg</td><td>png...)$`</td><td>正则匹配</td><td>图片正则</td></tr><tr><td><code>/js/app.JS</code></td><td>`~* .(css</td><td>js)$`</td><td>正则不区分大小写</td><td>匹配大写JS</td><td/></tr><tr><td><code>/api/v2/products</code></td><td><code>/api/v2/</code></td><td>普通前缀(最长)</td><td>最长前缀优先</td><td/><td/></tr><tr><td><code>/api/v1/users</code></td><td><code>/api/v1/</code></td><td>普通前缀(次长)</td><td>次长前缀</td><td/><td/></tr><tr><td><code>/api/orders</code></td><td><code>/api/</code></td><td>普通前缀(最短)</td><td>最短前缀</td><td/><td/></tr><tr><td><code>/product/123</code></td><td><code>/product/</code></td><td>普通前缀</td><td>商品页</td><td/><td/></tr><tr><td><code>/admin/dashboard</code></td><td><code>/admin/</code></td><td>普通前缀</td><td>后台管理</td><td/><td/></tr><tr><td><code>/.git/config</code></td><td><code>^~ /.</code></td><td>前缀优先</td><td>禁止访问</td><td/><td/></tr><tr><td><code>/backup.bak</code></td><td>`~ .(bak</td><td>backup...)$`</td><td>正则匹配</td><td>禁止访问</td><td/></tr></tbody></table>
<p>第一个问题及其延伸现到这，我们继续看第二个问题。</p>
<h3 data-id="heading-1">问题二</h3>
<p><strong>先看下面的服务器端nginx的重启命令：</strong></p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">命令一</span>
nginx -s reload
<span class="hljs-meta prompt_">
# </span><span class="bash">命令二</span>
systemctl reload nginx
</code></pre>
<p><strong>上面两个命令都是用来重启 nginx 服务的，但是你想过它们之间有什么区别吗？哪个用起来更优雅？</strong></p>
<p><strong>答案：有区别！区别在于命令的执行方式和适用场景不同。</strong></p>
<p><strong><code>nginx -s reload</code></strong></p>
<p>这是 Nginx 自带的信号控制命令:</p>
<ul>
<li>直接向 Nginx 主进程发送 reload 信号</li>
<li>优雅重启:不会中断现有连接,平滑加载新配置</li>
<li>需要 nginx 命令在 PATH 环境变量中,或使用完整路径(如 /usr/sbin/nginx -s reload)</li>
<li>这是 Nginx 原生的重启方式</li>
</ul>
<p><strong><code>systemctl reload nginx</code></strong></p>
<p>这是通过 systemd 管理的服务命令:</p>
<ul>
<li>通过 systemd 管理 Nginx 服务</li>
<li>也会优雅重启 Nginx,平滑加载新配置</li>
<li>需要 systemd 环境,适用于使用 systemd 管理服务的 Linux</li>
<li>这是现代 Linux 发行版（如 CentOS 7/8, RHEL 7/8, Ubuntu 16.04+）的推荐方式。</li>
</ul>
<p><strong>简单一看其他相关命令对比:</strong></p>
<ul>
<li><code>nginx -s stop</code> 等价 <code>systemctl stop nginx</code></li>
<li><code>nginx -s quit</code> 等价 <code>systemctl stop nginx</code></li>
<li><code>nginx -t</code> (测试配置是否正确) - 这个没有 systemctl 对应命令</li>
</ul>
<p><strong>systemctl下相关常用命令：</strong></p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">设置开机自启</span>
systemctl enable nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">启动服务</span>
systemctl start nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">检查服务状态</span>
systemctl status nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">停止服务</span>
systemctl stop nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">重启服务（会中断连接）</span>
systemctl restart nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">平滑重载配置（不中断服务）-- 对应 nginx -s reload</span>
systemctl reload nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">检查配置文件语法（这是调用nginx二进制文件的功能）</span>
nginx -t
</code></pre>
<p><strong>在服务器上最优雅的使用组合：</strong></p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">先测试配置</span>
nginx -t
<span class="hljs-meta prompt_">
# </span><span class="bash">如果配置正确,再重载</span>
systemctl reload nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">检查状态</span>
systemctl status nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">如果systemctl失败或命令不存在，则使用直接方式</span>
sudo nginx -s reload
</code></pre>
<blockquote>
<p>总结：我们不能光一脸懵的看着，哎，这两种命令都能操作nginx来, 却从来不关心它们的区别是什么？什么时候用哪个？</p>
</blockquote>
<blockquote>
<p>对于使用Linux发行版的服务端来说, 已经推荐使用 <code>systemctl</code> 来设置相关的nginx服务了，能使用 systemctl 就尽量使用它，因为它是现代Linux系统管理服务的标准方式。</p>
</blockquote>
<blockquote>
<p>本地开发环境或者没有 systemd 的环境下, 则可以使用 <code>nginx</code> 这种直接方式。</p>
</blockquote>
<h3 data-id="heading-2">问题三</h3>
<blockquote>
<p>我们面临的大多数情况都是可以上网的Linux发行版，可以直接使用命令安装nginx，但是有一天我有一台不能上网的服务器，我该如何安装nginx呢？</p>
</blockquote>
<p>现简单熟悉一下命令行安装nginx的步骤, Ubuntu/Debian系统为例子：</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">更新包列表</span>
sudo apt update
<span class="hljs-meta prompt_">
# </span><span class="bash">安装 Nginx</span>
sudo apt install nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">启动 Nginx</span>
sudo systemctl start nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">设置开机自启</span>
sudo systemctl enable nginx
</code></pre>
<blockquote>
<p>上述便完成了，但是离线版安装要怎么去做呢？</p>
</blockquote>
<blockquote>
<p>因为我的服务器可能是不同的架构，比如 x86_64, ARM等等</p>
</blockquote>
<h4 data-id="heading-3">方案一</h4>
<p><strong>下载官方预编译包下载地址：</strong></p>
<p><strong>x86_64 架构:</strong></p>
<p>尽量使用1.24.x的版本</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 从官网下载对应系统的包</span>
wget http://nginx.org/packages/centos/7/x86_64/RPMS/nginx-1.24.0-1.el7.ngx.x86_64.rpm
</code></pre>
<p><strong>ARM64 架构:</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Ubuntu ARM64</span>
wget http://nginx.org/packages/ubuntu/pool/nginx/n/nginx/nginx_1.24.0-1~jammy_arm64.deb
</code></pre>
<p><strong>查看服务器的架构信息</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 查看当前系统架构</span>
<span class="hljs-built_in">uname</span> -m

<span class="hljs-comment"># 输出示例:</span>
<span class="hljs-comment"># x86_64    -&gt; Intel/AMD 64位</span>
<span class="hljs-comment"># aarch64   -&gt; ARM 64位</span>
<span class="hljs-comment"># armv7l    -&gt; ARM 32位</span>

<span class="hljs-comment"># 查看系统版本</span>
<span class="hljs-built_in">cat</span> /etc/os-release
</code></pre>
<p><strong>把下载好的包传到服务器上，然后使用下面的命令安装：</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 对于 RPM 包 (CentOS/RHEL)</span>
<span class="hljs-built_in">cd</span> /tmp
sudo rpm -ivh nginx-*.rpm

<span class="hljs-comment"># 对于 DEB 包 (Ubuntu/Debian)</span>
<span class="hljs-built_in">cd</span> /tmp
sudo dpkg -i nginx-*.deb
</code></pre>
<p><strong>启动服务</strong></p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl start nginx       <span class="hljs-comment"># 启动</span>
sudo systemctl <span class="hljs-built_in">enable</span> nginx      <span class="hljs-comment"># 开机自启</span>
sudo systemctl status nginx      <span class="hljs-comment"># 查看状态</span>
</code></pre>
<p><strong>验证</strong></p>
<pre><code class="hljs language-bash" lang="bash">nginx -v                         <span class="hljs-comment"># 查看版本</span>
curl http://localhost            <span class="hljs-comment"># 测试访问</span>
</code></pre>
<h4 data-id="heading-4">方案二</h4>
<p>源码编译安装的方式，一般不推荐，除非你有特殊需求，如果需要的话让后端来吧，我们是前端...,超纲了！</p>
<p>文章同步地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.liumingxin.site%2Fblog%2Fdetail%2Fnginx" target="_blank" title="https://www.liumingxin.site/blog/detail/nginx" ref="nofollow noopener noreferrer">www.liumingxin.site/blog/detail…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[深入理解 Gunicorn]]></title>    <link>https://juejin.cn/post/7582136489770958858</link>    <guid>https://juejin.cn/post/7582136489770958858</guid>    <pubDate>2025-12-11T06:06:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582136489770958858" data-draft-id="7582156410319601674" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="深入理解 Gunicorn "/> <meta itemprop="keywords" content="Python,uWSGI"/> <meta itemprop="datePublished" content="2025-12-11T06:06:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Xier"/> <meta itemprop="url" content="https://juejin.cn/user/1152710585356295"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            深入理解 Gunicorn 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1152710585356295/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Xier
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:06:17.000Z" title="Thu Dec 11 2025 06:06:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    12
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>Gunicorn</strong> (Green Unicorn) 是一个为 UNIX 设计的 Python <strong>WSGI HTTP Server</strong>。它采用 <strong>Pre-fork Worker</strong> 模型，以其性能稳定、配置简单和资源占用低而闻名，是目前部署 Python Web 应用（如 Django、Flask、FastAPI）的工业级标准选择。</p>
<h2 data-id="heading-0">1. 为什么需要 Gunicorn？</h2>
<p>在开发 Django 或 Flask 应用时，我们通常使用自带的 <code>runserver</code>。但这些内置服务器主要用于开发调试，<strong>不能用于生产环境</strong>，原因如下：</p>
<ul>
<li><strong>单进程/单线程</strong>：通常一次只能处理一个请求。</li>
<li><strong>稳定性差</strong>：缺乏进程管理和自愈能力。</li>
<li><strong>安全性低</strong>：没有针对并发攻击和异常连接的优化。</li>
</ul>
<p><strong>Gunicorn 的作用</strong>就是在你的 Web 应用（App）和外界（通常是 Nginx）之间搭建一座桥梁，并发地处理大量 HTTP 请求。</p>
<h2 data-id="heading-1">2. 核心架构：Pre-fork 模型</h2>
<p>Gunicorn 的运行机制可以概括为：<strong>一个主进程（Master）管理一组工作进程（Worker）</strong> 。</p>
<ul>
<li><strong>Master 进程</strong>：不处理具体的客户端请求。它负责接收操作系统的信号（如重启、停止），并监控 Worker 进程的状态。如果某个 Worker 挂了，Master 会自动拉起一个新的。</li>
<li><strong>Worker 进程</strong>：由 Master 进程 fork 出来，是真正处理请求的地方。</li>
<li><strong>优点</strong>：进程之间相互隔离，一个请求导致进程崩溃不会影响其他请求，增强了系统的健壮性。</li>
</ul>
<h2 data-id="heading-2">3. 工作模式（Worker Types）</h2>
<p>选择正确的 Worker 类型对于性能至关重要：</p>






























<table><thead><tr><th><strong>Worker 类型</strong></th><th><strong>描述</strong></th><th><strong>适用场景</strong></th></tr></thead><tbody><tr><td><strong>Sync (默认)</strong></td><td>每个进程一次处理一个请求。</td><td>CPU 密集型任务，或者请求处理非常快的情况。</td></tr><tr><td><strong>Gevent / Eventlet</strong></td><td>基于协程的异步模式。</td><td>IO 密集型（如频繁读写数据库、调用外部 API）。</td></tr><tr><td><strong>Thread</strong></td><td>在每个 Worker 进程中使用线程池。</td><td>介于 Sync 和协程之间，适合受限于 IO 但又不想用协程的情况。</td></tr><tr><td><strong>Uvicorn</strong></td><td>用于支持 ASGI (如 FastAPI)。</td><td>现代异步 Python 应用。</td></tr></tbody></table>
<h3 data-id="heading-3">应该配置多少个 Worker？</h3>
<p>官方推荐的公式是：</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo>×</mo><mtext>CPU 核心数</mtext><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Workers = (2 \times \text{CPU 核心数}) + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">ers</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">CPU </span><span class="mord cjk_fallback">核心数</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span></p>
<h2 data-id="heading-4">4. 基础使用指南</h2>
<h3 data-id="heading-5">安装</h3>
<pre><code class="hljs">pip install gunicorn
</code></pre>
<h3 data-id="heading-6">启动应用</h3>
<p>假设你的文件名是 <code>main.py</code>，Flask 实例名为 <code>app</code>：</p>
<pre><code class="hljs language-less" lang="less"># 格式：<span class="hljs-selector-tag">gunicorn</span> <span class="hljs-selector-attr">[模块名]</span>:<span class="hljs-selector-attr">[变量名]</span>
<span class="hljs-selector-tag">gunicorn</span> <span class="hljs-selector-tag">-w</span> <span class="hljs-number">4</span> <span class="hljs-selector-tag">-b</span> <span class="hljs-number">0.0</span><span class="hljs-selector-class">.0</span><span class="hljs-selector-class">.0</span>:<span class="hljs-number">8000</span> <span class="hljs-selector-tag">main</span>:<span class="hljs-selector-tag">app</span>
</code></pre>
<ul>
<li><code>-w 4</code>：启动 4 个工作进程。</li>
<li><code>-b 0.0.0.0:8000</code>：绑定 IP 和端口。</li>
</ul>
<h3 data-id="heading-7">常用配置参数</h3>
<ul>
<li><code>--timeout</code>：请求超时时间（默认 30s）。</li>
<li><code>--access-logfile</code>：访问日志路径。</li>
<li><code>--worker-class</code>：指定 worker 类型（如 <code>gevent</code>）。</li>
<li><code>--daemon</code>：后台运行。</li>
</ul>
<h2 data-id="heading-8">5. 生产环境最佳实践：Nginx + Gunicorn</h2>
<p>在生产环境中，<strong>永远不要</strong>让 Gunicorn 直接暴露在公网上。通常会在前面加一个 <strong>Nginx</strong> 作为反向代理。</p>
<p><strong>为什么要配合 Nginx？</strong></p>
<ol>
<li><strong>处理静态资源</strong>：Nginx 处理图片、CSS、JS 的效率远高于 Python。</li>
<li><strong>负载均衡</strong>：Nginx 可以分发流量到多台 Gunicorn 服务器。</li>
<li><strong>安全缓冲</strong>：Nginx 可以过滤恶意请求，并缓存慢速连接，保护 Gunicorn 不被耗尽。</li>
<li><strong>SSL 终止</strong>：在 Nginx 层处理 HTTPS 加密。</li>
</ol>
<hr/>
<h2 data-id="heading-9">6 配置参数</h2>
<h3 data-id="heading-10"><code>daemon</code> (守护进程模式)</h3>
<p><strong>作用：</strong> 让 Gunicorn 在后台运行，脱离当前的终端控制台。</p>
<ul>
<li>
<p><strong>不仅仅是“守护”：</strong> 当你设置为 <code>True</code> 时，Gunicorn 会执行两次 <code>fork()</code>，将进程与启动它的终端（Tty）完全脱离。这意味着即使你关闭了 SSH 窗口或断开了连接，Gunicorn 进程依然会在后台运行。</p>
</li>
<li>
<p><strong>PID 文件：</strong> 在使用 <code>daemon</code> 模式时，通常建议配合 <code>pidfile</code> 参数使用，这样你才能知道后台进程的 ID，方便后续进行重启或停止操作。</p>
</li>
<li>
<p><strong>生产环境建议：</strong> 虽然 Gunicorn 自带 <code>daemon</code> 功能，但在现代运维实践中（如使用 <strong>Docker</strong> 或 <strong>Systemd</strong>），我们通常将此参数保持为 <code>False</code>。</p>
<ul>
<li><strong>Docker：</strong> 必须前台运行（False），否则容器启动后会立即退出。</li>
<li><strong>Systemd：</strong> 推荐前台运行，由 Systemd 统一管理日志和进程生命周期。</li>
</ul>
</li>
</ul>
<h3 data-id="heading-11"><code>preload_app</code> (预加载应用)</h3>
<p>这是一个非常核心的性能优化参数。</p>
<p><strong>作用：</strong> 在 Master 进程 fork 出 Worker 进程<strong>之前</strong>，先加载应用程序的代码。</p>
<h3 data-id="heading-12">优点：</h3>
<ol>
<li><strong>节省内存 (Copy-on-Write)：</strong> 现代操作系统使用“写时复制”机制。如果在 Master 进程中预先加载了应用，所有 Worker 进程将共享同一块物理内存。只有当 Worker 尝试修改这些内存时，才会复制。对于大型应用（如 Django），这能显著降低内存占用。</li>
<li><strong>启动速度快：</strong> Worker 进程由 Master 直接 fork 出来，不需要重新解析 Python 代码和导入库。</li>
</ol>
<h3 data-id="heading-13">缺点与风险：</h3>
<ul>
<li><strong>共享资源冲突：</strong> 如果你的应用在初始化时（即在全局作用域内）打开了数据库连接、缓存连接或文件描述符，开启 <code>preload</code> 可能会导致多个 Worker 共享同一个连接，从而引发报错或数据错乱。</li>
<li><strong>代码热更新：</strong> 开启后，如果你重启 Worker（HUP 信号），代码不会重载，必须重启整个 Master 进程才能看到代码变更。</li>
</ul>
<hr/>
<h3 data-id="heading-14">3. 其他核心参数详解</h3>
<p>除了上述两个，以下参数在调优时最为常用：</p>
<h3 data-id="heading-15"><code>worker_class</code> (工作模式)</h3>
<p>决定了 Gunicorn 如何处理请求。</p>
<ul>
<li><code>sync</code> (默认): 传统的同步模式。适合 CPU 密集型。</li>
<li><code>gevent</code> / <code>eventlet</code>: 协程异步模式。适合 <strong>IO 密集型</strong>（如大量 API 调用、长连接）。</li>
<li><code>gthread</code>: 混合模式。每个 Worker 开启多个线程处理请求。</li>
</ul>
<h3 data-id="heading-16"><code>max_requests</code> &amp; <code>max_requests_jitter</code></h3>
<p><strong>作用：防止内存泄漏。</strong></p>
<ul>
<li><code>max_requests</code>: 一个 Worker 在处理多少个请求后会自动重启。</li>
<li><code>max_requests_jitter</code>: 在最大请求数上增加一个随机抖动值（例如 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50</mn><mo>±</mo><mtext>random</mtext></mrow><annotation encoding="application/x-tex">50 \pm \text{random}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">50</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord text"><span class="mord">random</span></span></span></span></span></span>）。</li>
<li><strong>原理：</strong> Python 应用（尤其是使用了第三方库时）有时会有微小的内存泄漏。通过定期重启 Worker，可以释放这些被占用的内存。</li>
</ul>
<h3 data-id="heading-17"><code>timeout</code> (超时时间)</h3>
<ul>
<li><strong>作用：</strong> 如果 Worker 处理单个请求的时间超过此值，Master 会杀掉该 Worker 并重新拉起一个新的。</li>
<li><strong>注意：</strong> 默认是 <strong>30 秒</strong>。如果你有耗时很长的文件上传或复杂计算，需要调大此值，否则用户会看到 502 错误。</li>
</ul>
<h3 data-id="heading-18"><code>keepalive</code> (长连接保持)</h3>
<ul>
<li><strong>作用：</strong> 在同一个 TCP 连接上等待下一个请求的秒数。</li>
<li><strong>建议：</strong> 当 Gunicorn 后面跟着 Nginx 时，通常设置为 <strong>2-5 秒</strong>。</li>
</ul>
<h2 data-id="heading-19">7. 总结</h2>
<p>Gunicorn 是 Python Web 部署的“压舱石”。它简单、可靠，专注于做好一件事：<strong>管理进程并稳定地运行 WSGI 应用</strong>。</p>
<blockquote>
<p><strong>核心原则</strong>：</p>
<ul>
<li>IO 密集型用 <code>gevent</code> 或 <code>threads</code>。</li>
<li>CPU 密集型用默认 <code>sync</code>。</li>
<li>前面必须挡一个 Nginx。</li>
</ul>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[基于arthas的一次提升定时任务TPS总结]]></title>    <link>https://juejin.cn/post/7582156219059929151</link>    <guid>https://juejin.cn/post/7582156219059929151</guid>    <pubDate>2025-12-11T05:43:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156219059929151" data-draft-id="7582207260198715446" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="基于arthas的一次提升定时任务TPS总结"/> <meta itemprop="keywords" content="后端,性能优化"/> <meta itemprop="datePublished" content="2025-12-11T05:43:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="大肚子飞行员"/> <meta itemprop="url" content="https://juejin.cn/user/852876755994445"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            基于arthas的一次提升定时任务TPS总结
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/852876755994445/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    大肚子飞行员
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:43:06.000Z" title="Thu Dec 11 2025 05:43:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.  <strong>问题描述</strong></h2>
<p>后台服务班次转换通过定时任务，每五分钟执行一次，每日1000班次，要跑将近4，5小时，平均下来1分钟仅能跑几个班次。单个班次执行约20-30s。班次转换速率严重滞后，月底重跑多天报表，可能严重拖慢报表生成进度。</p>
<h2 data-id="heading-1">2.  <strong>问题定位及分析</strong></h2>
<h3 data-id="heading-2">2.1.  <strong>服务器负载分析</strong></h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ad969375d9a402f9bf93ec6245757a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=s9iHJFUzBMAb5WGgaPSRPXq1Wns%3D" alt="image" loading="lazy"/>
定时任务跑批次期间，通过top命令查看服务负载情况，CPU负载仅23.3%，内存负载13.2GB约56%，并不存在瓶颈情况。</p>
<h3 data-id="heading-3">2.2.  <strong>JVM负载分析</strong></h3>
<p>使用Arthas工具（dashboard），查看cms服务班次跑批期间的jvm负载情况，具体情况如下：
（备注：原默认垃圾回收器ps_survivor占用98%，切换g1gc，由jvm自行分配eden和s区的大小，以及对象晋升的次数）
Heap情况: </p>
<ul>
<li><strong>总堆内存</strong>: 12GB (12288M)</li>
<li><strong>已使用</strong>: 3.8GB (3949M) - <strong>32.14%</strong> 使用率</li>
<li><strong>年轻代</strong>: 3.6GB (3668M) - 占堆的 <strong>47.74%</strong></li>
<li><strong>老年代</strong>: 221M - 仅占堆的 <strong>1.80%</strong></li>
</ul>
<p>Gc情况：</p>
<ul>
<li>  年轻代GC次数: 65次，时间1700ms</li>
<li> 老年带GC次数0</li>
</ul>
<p>根据Arthas工具dashboard实时打印的结果，JVM的总体负载不高，不存在瓶颈情况。</p>
<h3 data-id="heading-4">2.3.  <strong>关键代码执行时间分析</strong></h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cdabe3d544b7449a8d4031cd1e53baf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=a4Uy7%2BLiy%2BQoKhNK0wGJa%2Byvs1A%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6bb57e433284c93b4280ea4383676e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=DPUOrQbOz6qHkGZ4HU5kzJ%2BMmbE%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/790ceec7f7f2487fa48227f2cceb5061~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=1IGVF5NfumpjhpfCxm%2FV43ZNTIU%3D" alt="image.png" loading="lazy"/></p>
<p>使用Arthas工具对定时任务代码分析：</p>
<ul>
<li>
<p>trace com.hkl.pos.service.impl.AtsConvertServiceImpl convertSuccessionByLock </p>
<p>以下捞出关键的几种类型：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43ae4dd9391f4dbd9bb44c5514207e74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=UzkK8bnQXO7iW%2Fc4Rv6oCeNVA0s%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c435002508cf4f42b2421b0de5fb3735~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=p10YxPkbXKoGzeDCVvxDUlHVFIw%3D" alt="image.png" loading="lazy"/></p>
<p>以上截图trace结果可以得出结论：</p>
<ol>
<li>大量耗时存在于班次的转换的方法内；</li>
<li>约一半的方法执行失败，获取jdbc连接超时；</li>
<li>trace因为性能关系只统计一个层架，需要往下再定位详细方法的执行耗时；</li>
</ol>
</li>
<li>
<p>trace -E com.hkl.pos.service.impl.AtsConvertServiceImpl convertSuccessionByLock|convertSuccession|convertOrder -n 1000</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d31266c3418845ce888d63c5a3ad74ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=GO2eNB2frw%2FeMKBK9nlhkpHBD5k%3D" alt="image.png" loading="lazy"/></p>
<p>以上trace结果可以得出结论：主要执行耗时代码在ats_bb表执行插入数据耗时过长；</p>
<h3 data-id="heading-5">2.4.  <strong>数据库入库慢定位</strong></h3>
<pre><code class="hljs language-markdown" lang="markdown">定位bb表插入慢的主要原因：
<span class="hljs-bullet">1.</span>  数据量过大或者索引过多，锁或者外键，触发器导致插入慢；
<span class="hljs-bullet">2.</span>  插入数据需要写数据文件、redo日志文件、undo表空间配置问题导致插入慢；
</code></pre>
<h2 data-id="heading-6">3.  <strong>优化方案与结果</strong></h2>
<h3 data-id="heading-7">3.1.  <strong>单个任务优化</strong></h3>
<h4 data-id="heading-8">3.1.1.  历史数据归档</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c1a7844d2a642649f1617208099ba50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=%2FWy7722wd6n%2BHlcC6xBPjcNj0%2FY%3D" alt="63b2a20e170194f2a128454e02fb246f.png" loading="lazy"/></p>
<p>bb表历史数据先归档处理，大大提升入库时间。</p>
<h4 data-id="heading-9">3.1.2.   JDBC连接池优化</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96aa02cffa464a05b19c0d61351cc225~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=lUuau2ruVGcF2S0VMhRyYE23m9o%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-10">3.1.3.   长事务周期优化</h4>
<p>将大事务拆分成小事务，查询和转换方法执行后，再进行数据库事务操作，防止大事务长时间持有占用JDBC连接。具体操作如下：
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43f3cf4746874e1fa1873ee5d77ee2b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=hh43jBq1LRScej8ZHenl6yCs8eI%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-11">3.1.4.  优化效果</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3581d0caea9f45d782d2c65516747a33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=2VQNzHBOS1d4E2ZrtEXxt%2Fk0zcE%3D" alt="image.png" loading="lazy"/></p>
<p>耗时统计
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9617d6e5941e41768e81a63e949e49bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=OBeOABKgjwhGYSCLhSK7998stYs%3D" alt="image.png" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64f46bbbb9064a3988ac1d5a0bcc1639~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6IKa5a2Q6aOe6KGM5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036775&amp;x-signature=XlAQMGGGgXsyya6eacVq%2BoMMhpc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-12">3.2.  <strong>引入分布式中间件（后续安排）</strong></h3>
<p>后续走直接生成，暂不需要进一步优化......</p>
<h2 data-id="heading-13">1.  <strong>总结</strong></h2>
<ol>
<li>增加数据库连接数的最大连接池个数，是最直接的问题的方式。解决大量jdbc连接获取失败问题；</li>
<li>历史数据归档，大大降低数据库入库和删除时间；</li>
<li>限制每个定时任务跑固定个数（当前每5分钟定时任务500条班次任务-&gt;约每天的班次要10分钟）</li>
<li>拆分大事务，防止长时间占用jdbc连接；</li>
<li>排查定位：使用阿里开源工具Arthas，可以快速定位问题和瓶颈，且上手快。</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[从零实现一个低代码 H5 页面编辑器（Vue3 + 拖拽）]]></title>    <link>https://juejin.cn/post/7582118218649337882</link>    <guid>https://juejin.cn/post/7582118218649337882</guid>    <pubDate>2025-12-11T05:59:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582118218649337882" data-draft-id="7582104240988405786" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="从零实现一个低代码 H5 页面编辑器（Vue3 + 拖拽）"/> <meta itemprop="keywords" content="前端,Vue.js"/> <meta itemprop="datePublished" content="2025-12-11T05:59:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="live丶"/> <meta itemprop="url" content="https://juejin.cn/user/3131009846745245"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            从零实现一个低代码 H5 页面编辑器（Vue3 + 拖拽）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3131009846745245/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    live丶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:59:21.000Z" title="Thu Dec 11 2025 05:59:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">从零实现一个低代码 H5 页面编辑器（Vue3 + 拖拽）</h2>
<blockquote>
<p>本文带你手把手实现一个类似有赞、微盟的 H5 营销页面编辑器，支持拖拽搭建、实时预览、属性配置。</p>
</blockquote>
<h3 data-id="heading-1">前言</h3>
<p>低代码平台这几年很火，但很多人觉得很复杂不敢下手。其实核心原理并不难，今天我们就用 <strong>Vue3 + vuedraggable</strong> 实现一个麻雀虽小五脏俱全的 H5 页面编辑器。</p>
<p><strong>最终效果：</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0bf9d468101748058e390b42f4f67401~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbGl2ZeS4tg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766037771&amp;x-signature=S2q0JyzVGNo5FtL6KcE1Cv%2Fyc4I%3D" alt="微信图片_20251211134433_21_84.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0786cc8785f433fb046d39e85459bbd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbGl2ZeS4tg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766037771&amp;x-signature=wt70AQtaznVZrnk8IUIoHOL%2FOuw%3D" alt="微信图片_20251211134305_19_84.png" loading="lazy"/></p>
<p><strong>技术栈：</strong></p>
<ul>
<li>Vue 3 + Composition API</li>
<li>Pinia 状态管理</li>
<li>Element Plus</li>
<li>vuedraggable 拖拽</li>
<li>Tailwind CSS</li>
</ul>
<h3 data-id="heading-2">一、整体架构设计</h3>
<p>低代码编辑器的核心是 <strong>三栏布局 + 统一数据源</strong>：</p>
<pre><code class="hljs language-scss" lang="scss">┌──────────────────────────────────────────────────────┐
│                      App<span class="hljs-selector-class">.vue</span>                          │
│  ┌──────────┐  ┌────────────────┐  ┌──────────────┐  │
│  │LeftPanel │  │  CenterCanvas  │  │  RightPanel  │  │
│  │  组件库   │ → │    画布预览    │ ← │   属性配置   │  │
│  └──────────┘  └────────────────┘  └──────────────┘  │
│                        ↑↓                             │
│                   Pinia Store                         │
│                  (全局状态管理)                        │
└──────────────────────────────────────────────────────┘
</code></pre>
<p><strong>数据流向：</strong></p>
<ol>
<li>左侧组件库 → 拖拽克隆 → 画布</li>
<li>点击画布组件 → 选中 → 右侧显示配置</li>
<li>修改配置 → 更新 Store → 画布实时刷新</li>
</ol>
<h3 data-id="heading-3">二、定义组件配置</h3>
<p>首先定义组件库，每个组件包含类型、名称、图标和默认属性：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/config/components.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> componentLibrary = {
  <span class="hljs-attr">basic</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'基础组件'</span>,
    <span class="hljs-attr">icon</span>: <span class="hljs-string">'Grid'</span>,
    <span class="hljs-attr">components</span>: [
      {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'文本'</span>,
        <span class="hljs-attr">icon</span>: <span class="hljs-string">'Document'</span>,
        <span class="hljs-attr">props</span>: {
          <span class="hljs-attr">content</span>: <span class="hljs-string">'请输入文本内容'</span>,
          <span class="hljs-attr">fontSize</span>: <span class="hljs-number">14</span>,
          <span class="hljs-attr">color</span>: <span class="hljs-string">'#333333'</span>,
          <span class="hljs-attr">textAlign</span>: <span class="hljs-string">'left'</span>,
          <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">'normal'</span>,
          <span class="hljs-attr">padding</span>: <span class="hljs-number">10</span>
        }
      },
      {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'图片'</span>,
        <span class="hljs-attr">icon</span>: <span class="hljs-string">'Picture'</span>,
        <span class="hljs-attr">props</span>: {
          <span class="hljs-attr">src</span>: <span class="hljs-string">'https://via.placeholder.com/350x150'</span>,
          <span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>,
          <span class="hljs-attr">borderRadius</span>: <span class="hljs-number">0</span>
        }
      },
      <span class="hljs-comment">// ... 更多组件</span>
    ]
  },
  <span class="hljs-attr">marketing</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'营销组件'</span>,
    <span class="hljs-attr">components</span>: [
      {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'banner'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'轮播图'</span>,
        <span class="hljs-attr">props</span>: {
          <span class="hljs-attr">images</span>: [<span class="hljs-string">'banner1.jpg'</span>, <span class="hljs-string">'banner2.jpg'</span>],
          <span class="hljs-attr">height</span>: <span class="hljs-number">200</span>,
          <span class="hljs-attr">autoplay</span>: <span class="hljs-literal">true</span>
        }
      },
      {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'coupon'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'优惠券'</span>,
        <span class="hljs-attr">props</span>: {
          <span class="hljs-attr">title</span>: <span class="hljs-string">'满减优惠券'</span>,
          <span class="hljs-attr">value</span>: <span class="hljs-number">50</span>,
          <span class="hljs-attr">condition</span>: <span class="hljs-string">'满200可用'</span>
        }
      }
    ]
  }
}
</code></pre>
<p><strong>设计要点：</strong></p>
<ul>
<li><code>type</code> 用于匹配渲染组件</li>
<li><code>props</code> 是默认属性，拖入画布后可独立修改</li>
<li>分类管理，便于扩展</li>
</ul>
<h3 data-id="heading-4">三、Pinia 状态管理</h3>
<p>这是整个编辑器的核心，管理画布状态：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/stores/editor.js</span>
<span class="hljs-keyword">import</span> { defineStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useEditorStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'editor'</span>, {
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">components</span>: [],      <span class="hljs-comment">// 画布中的组件列表</span>
    <span class="hljs-attr">selectedIndex</span>: -<span class="hljs-number">1</span>,   <span class="hljs-comment">// 当前选中的组件索引</span>
    <span class="hljs-attr">idCounter</span>: <span class="hljs-number">0</span>         <span class="hljs-comment">// 组件ID计数器</span>
  }),

  <span class="hljs-attr">getters</span>: {
    <span class="hljs-comment">// 获取当前选中的组件</span>
    <span class="hljs-attr">selectedComponent</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (state.<span class="hljs-property">selectedIndex</span> &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> state.<span class="hljs-property">components</span>[state.<span class="hljs-property">selectedIndex</span>]
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
  },

  <span class="hljs-attr">actions</span>: {
    <span class="hljs-comment">// 添加组件（拖入时调用）</span>
    <span class="hljs-title function_">addComponent</span>(<span class="hljs-params">component</span>) {
      <span class="hljs-keyword">const</span> newComponent = {
        ...<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(component)), <span class="hljs-comment">// 深拷贝</span>
        <span class="hljs-attr">id</span>: ++<span class="hljs-variable language_">this</span>.<span class="hljs-property">idCounter</span>
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>.<span class="hljs-title function_">push</span>(newComponent)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedIndex</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
    },

    <span class="hljs-comment">// 选中组件</span>
    <span class="hljs-title function_">selectComponent</span>(<span class="hljs-params">index</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedIndex</span> = index
    },

    <span class="hljs-comment">// 删除组件</span>
    <span class="hljs-title function_">deleteComponent</span>(<span class="hljs-params">index</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedIndex</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedIndex</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
      }
    },

    <span class="hljs-comment">// 上移/下移</span>
    <span class="hljs-title function_">moveUp</span>(<span class="hljs-params">index</span>) {
      <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">0</span>) {
        [<span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>[index], <span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>[index - <span class="hljs-number">1</span>]] = 
        [<span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>[index - <span class="hljs-number">1</span>], <span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>[index]]
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedIndex</span> = index - <span class="hljs-number">1</span>
      }
    },

    <span class="hljs-comment">// 更新组件属性</span>
    <span class="hljs-title function_">updateComponentProps</span>(<span class="hljs-params">index, props</span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>[index]) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>[index].<span class="hljs-property">props</span> = { 
          ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>[index].<span class="hljs-property">props</span>, 
          ...props 
        }
      }
    },

    <span class="hljs-comment">// 导出数据</span>
    <span class="hljs-title function_">getSaveData</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">components</span>)
    }
  }
})
</code></pre>
<h3 data-id="heading-5">四、左侧组件库（拖拽源）</h3>
<p>使用 <code>vuedraggable</code> 实现拖拽，关键是 <code>group</code> 配置：</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- src/components/LeftPanel.vue --&gt;
&lt;template&gt;
  &lt;div class="left-panel"&gt;
    &lt;div class="p-3 border-b font-bold"&gt;组件库&lt;/div&gt;
    
    &lt;el-collapse v-model="activeNames"&gt;
      &lt;el-collapse-item 
        v-for="(category, key) in componentLibrary" 
        :key="key"
        :name="key"
      &gt;
        &lt;template #title&gt;
          &lt;el-icon class="mr-2"&gt;&lt;component :is="category.icon" /&gt;&lt;/el-icon&gt;
          {{ category.name }}
        &lt;/template&gt;
        
        &lt;!-- 🔥 核心：draggable 配置 --&gt;
        &lt;draggable
          :list="category.components"
          :group="{ name: 'components', pull: 'clone', put: false }"
          :clone="cloneComponent"
          :sort="false"
          item-key="type"
        &gt;
          &lt;template #item="{ element }"&gt;
            &lt;div class="component-item"&gt;
              &lt;el-icon&gt;&lt;component :is="element.icon" /&gt;&lt;/el-icon&gt;
              &lt;span&gt;{{ element.name }}&lt;/span&gt;
            &lt;/div&gt;
          &lt;/template&gt;
        &lt;/draggable&gt;
      &lt;/el-collapse-item&gt;
    &lt;/el-collapse&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import draggable from 'vuedraggable'
import { componentLibrary } from '@/config/components'

// 深拷贝，确保每个实例独立
const cloneComponent = (item) =&gt; {
  return JSON.parse(JSON.stringify(item))
}
&lt;/script&gt;
</code></pre>
<p><strong>🔥 group 配置详解：</strong></p>

























<table><thead><tr><th>属性</th><th>值</th><th>含义</th></tr></thead><tbody><tr><td><code>name</code></td><td><code>'components'</code></td><td>分组名，同名才能互相拖拽</td></tr><tr><td><code>pull</code></td><td><code>'clone'</code></td><td>拖出时克隆，原列表不变</td></tr><tr><td><code>put</code></td><td><code>false</code></td><td>禁止放入，只能拖出</td></tr></tbody></table>
<p>这样设计的好处：</p>
<ul>
<li>组件库是"模板"，拖多少次都不会消失</li>
<li>防止用户把画布组件拖回组件库</li>
</ul>
<h3 data-id="heading-6">五、中间画布（拖拽目标）</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- src/components/CenterCanvas.vue --&gt;
&lt;template&gt;
  &lt;div class="center-canvas"&gt;
    &lt;!-- 工具栏 --&gt;
    &lt;div class="toolbar"&gt;
      &lt;el-button type="primary" @click="handleSave"&gt;保存&lt;/el-button&gt;
      &lt;el-button @click="store.reset()"&gt;重置&lt;/el-button&gt;
    &lt;/div&gt;
    
    &lt;!-- 手机预览框 --&gt;
    &lt;div class="phone-frame"&gt;
      &lt;draggable
        v-model="store.components"
        group="components"
        item-key="id"
        ghost-class="ghost"
        @add="onAdd"
      &gt;
        &lt;template #item="{ element, index }"&gt;
          &lt;div 
            class="component-wrapper"
            :class="{ selected: store.selectedIndex === index }"
            @click="store.selectComponent(index)"
          &gt;
            &lt;!-- 动态渲染组件 --&gt;
            &lt;component 
              :is="previewComponents[element.type]" 
              :props="element.props"
            /&gt;
          &lt;/div&gt;
        &lt;/template&gt;
      &lt;/draggable&gt;
      
      &lt;!-- 空状态 --&gt;
      &lt;div v-if="store.components.length === 0" class="empty-tip"&gt;
        拖拽组件到此处
      &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;!-- 操作按钮 --&gt;
    &lt;div v-if="store.selectedComponent" class="action-btns"&gt;
      &lt;el-button @click="store.moveUp(store.selectedIndex)"&gt;上移&lt;/el-button&gt;
      &lt;el-button @click="store.moveDown(store.selectedIndex)"&gt;下移&lt;/el-button&gt;
      &lt;el-button type="danger" @click="store.deleteComponent(store.selectedIndex)"&gt;
        删除
      &lt;/el-button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import draggable from 'vuedraggable'
import { useEditorStore } from '@/stores/editor'
import { previewComponents } from './preview'

const store = useEditorStore()

const onAdd = (evt) =&gt; {
  store.selectComponent(evt.newIndex)
}
&lt;/script&gt;
</code></pre>
<p><strong>动态组件渲染：</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/components/preview/index.js</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TextPreview</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./TextPreview.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ImagePreview</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./ImagePreview.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">BannerPreview</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./BannerPreview.vue'</span>
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> previewComponents = {
  <span class="hljs-string">'text'</span>: <span class="hljs-title class_">TextPreview</span>,
  <span class="hljs-string">'image'</span>: <span class="hljs-title class_">ImagePreview</span>,
  <span class="hljs-string">'banner'</span>: <span class="hljs-title class_">BannerPreview</span>,
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>通过 <code>element.type</code> 匹配对应的预览组件，实现动态渲染。</p>
<h3 data-id="heading-7">六、右侧属性配置</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- src/components/RightPanel.vue --&gt;
&lt;template&gt;
  &lt;div class="right-panel"&gt;
    &lt;div class="p-3 border-b font-bold"&gt;属性配置&lt;/div&gt;
    
    &lt;div v-if="!store.selectedComponent" class="empty"&gt;
      请选择组件
    &lt;/div&gt;

    &lt;div v-else class="p-4"&gt;
      &lt;!-- 文本组件配置 --&gt;
      &lt;template v-if="store.selectedComponent.type === 'text'"&gt;
        &lt;el-form label-position="top"&gt;
          &lt;el-form-item label="文本内容"&gt;
            &lt;el-input 
              v-model="props.content" 
              type="textarea" 
              @input="updateProps" 
            /&gt;
          &lt;/el-form-item&gt;
          &lt;el-form-item label="字体大小"&gt;
            &lt;el-slider 
              v-model="props.fontSize" 
              :min="12" :max="36" 
              @change="updateProps" 
            /&gt;
          &lt;/el-form-item&gt;
          &lt;el-form-item label="文字颜色"&gt;
            &lt;el-color-picker 
              v-model="props.color" 
              @change="updateProps" 
            /&gt;
          &lt;/el-form-item&gt;
        &lt;/el-form&gt;
      &lt;/template&gt;
      
      &lt;!-- 其他组件配置... --&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { reactive, watch } from 'vue'
import { useEditorStore } from '@/stores/editor'

const store = useEditorStore()
const props = reactive({})

// 监听选中组件变化，同步属性到本地
watch(() =&gt; store.selectedComponent, (comp) =&gt; {
  if (comp) {
    Object.assign(props, JSON.parse(JSON.stringify(comp.props)))
  }
}, { immediate: true, deep: true })

// 更新属性到 Store
const updateProps = () =&gt; {
  if (store.selectedIndex &gt;= 0) {
    store.updateComponentProps(store.selectedIndex, { ...props })
  }
}
&lt;/script&gt;
</code></pre>
<p><strong>为什么需要本地 <code>props</code> + <code>updateProps</code>？</strong></p>
<pre><code class="hljs language-scss" lang="scss">Store<span class="hljs-selector-class">.selectedComponent</span><span class="hljs-selector-class">.props</span>  →  深拷贝  →  本地 props (v-model 绑定)
                                              ↓
                                         用户修改
                                              ↓
                                         <span class="hljs-built_in">updateProps</span>()
                                              ↓
Store<span class="hljs-selector-class">.updateComponentProps</span>()  ←  同步回 Store  ←  画布更新
</code></pre>
<p>如果直接 <code>v-model</code> 绑定 Store 数据，虽然也能工作，但不够规范。使用本地副本可以：</p>
<ul>
<li>更好地控制更新时机</li>
<li>方便做表单校验</li>
<li>支持"取消修改"功能</li>
</ul>
<h3 data-id="heading-8">七、预览组件示例</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- src/components/preview/TextPreview.vue --&gt;
&lt;template&gt;
  &lt;div 
    :style="{
      fontSize: props.fontSize + 'px',
      color: props.color,
      textAlign: props.textAlign,
      fontWeight: props.fontWeight,
      padding: props.padding + 'px'
    }"
  &gt;
    {{ props.content }}
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
defineProps({
  props: { type: Object, required: true }
})
&lt;/script&gt;
</code></pre>
<p>每个预览组件接收 <code>props</code> 对象，根据属性渲染样式。</p>
<h3 data-id="heading-9">八、总结</h3>
<p>核心要点：</p>
<ol>
<li><strong>vuedraggable 的 group 配置</strong> - <code>pull: 'clone'</code> 实现克隆拖拽</li>
<li><strong>Pinia 统一状态管理</strong> - 三个面板共享数据源</li>
<li><strong>动态组件</strong> - <code>&lt;component :is=""&gt;</code> 根据类型渲染</li>
<li><strong>深拷贝</strong> - 确保每个组件实例独立</li>
</ol>
<p>扩展方向：</p>
<ul>
<li>撤销/重做（操作历史栈）</li>
<li>组件嵌套（容器组件）</li>
<li>模板保存/加载</li>
<li>真实预览（生成 H5 页面）</li>
<li>更多组件类型</li>
</ul>
<h3 data-id="heading-10">最后源码地址</h3>
<p>gitee: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Flive1906%2Flow-codeh5" target="_blank" title="https://gitee.com/live1906/low-codeh5" ref="nofollow noopener noreferrer">gitee.com/live1906/lo…</a></p>
<p>如果对你有帮助，欢迎 Star ⭐ 支持一下！</p>
<hr/>
<p>我是文强，专注前端开发，欢迎关注交流 👋</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[无硬件模拟灵衢架构：基于openFuyao社区的UB组件一站式开发实践]]></title>    <link>https://juejin.cn/post/7582163781183848454</link>    <guid>https://juejin.cn/post/7582163781183848454</guid>    <pubDate>2025-12-11T06:07:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582163781183848454" data-draft-id="7582156219060027455" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="无硬件模拟灵衢架构：基于openFuyao社区的UB组件一站式开发实践"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-11T06:07:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="是Dream呀"/> <meta itemprop="url" content="https://juejin.cn/user/765678294413181"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            无硬件模拟灵衢架构：基于openFuyao社区的UB组件一站式开发实践
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/765678294413181/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    是Dream呀
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:07:32.000Z" title="Thu Dec 11 2025 06:07:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">一、引言</h2>
<p>在AI与云原生技术深度融合的时代，底层算力基础设施正经历着一场深刻的变革。**灵衢”（Unified Bus）**互联协议与硬件架构，以其“协议归一、硬件资源池化”的核心理念，旨在构建可扩展的超大规模异构算力集群。为了将这一先进的硬件能力无缝交付给广大开发者与应用，<strong>openFuyao</strong>开源社区应运而生，它扮演着关键的“软件使能层”角色，致力于让基于灵衢协议的硬件能够极简、高效地接入和管理到云原生（Kubernetes）环境中。</p>
<p>然而，对于广大开发者和研究者而言，直接获取并搭建真实的灵衢硬件环境成本高昂、门槛极高。这正是 openFuyao开源社区的关键价值所在——它作为连接先进硬件与云原生应用之间的 “软件使能层”，致力于将如灵衢这般的前沿硬件能力，通过标准、易用的Kubernetes接口开放给上层应用。社区提供的无硬件模拟开发方案，让开发者能够在个人电脑上，即可体验并参与面向下一代算力架构的软件创新。</p>
<p>本文将以一个具体的实践案例，引导您基于openFuyao社区的工具链，在虚拟Kubernetes集群中，完成一个用于管理“灵衢统一总线（Unified Bus, UB）”资源的控制器的开发、编译、部署与验证全流程。通过这篇指南，您不仅能够掌握在无硬件条件下进行异构算力使能开发的方法，更能深入理解“硬件资源池化”的软件抽象逻辑，为未来参与智能算力基础设施生态建设奠定基础。</p>
<h2 data-id="heading-1">二、灵衢超节点架构概述</h2>
<p><strong>灵衢（Unified Bus，简称UB）</strong>是华为推出的数据中心级硬件互联协议与架构，其核心目标是通过“协议归一、硬件资源池化”的理念，构建可扩展的超大规模异构算力集群。</p>
<h3 data-id="heading-2">2.1 灵衢超节点的核心特征</h3>
<ul>
<li><strong>统一总线（UB）</strong>：打破传统服务器内外的计算、存储、网络边界，通过统一交换协议实现CPU、GPU、NPU、内存、存储等资源的池化。</li>
<li><strong>超节点（Super Node）</strong>：多个物理节点通过灵衢总线互联，形成一个逻辑上的“超节点”，对外提供统一的资源视图。</li>
<li><strong>资源池化与弹性调度</strong>：支持跨节点的算力、内存、存储资源动态分配与迁移，实现“算力如电”的按需使用体验。</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30141665c5b541f4b1ad219362e69c0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=5ZbK9zc%2BZUXINtVj5dKjv%2B8P%2BM4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">2.2 灵衢在云原生环境中的价值</h3>
<ul>
<li><strong>异构算力统一接入</strong>：通过UB协议，各类AI芯片、FPGA、智能网卡等可被Kubernetes统一纳管。</li>
<li><strong>低延迟高带宽互联</strong>：支持容器间、节点间的高性能通信，适合AI训练、推理等密集型场景。</li>
<li><strong>热迁移与高可用</strong>：基于UB的资源池化能力，可实现容器、虚拟机甚至AI任务的无感迁移与故障恢复。</li>
</ul>
<p>根据<strong>官方文档（</strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openfuyao.cn%2Fdocs%2F%25E5%25BF%25AB%25E9%2580%259F%25E5%2585%25A5%25E9%2597%25A8%2F" target="_blank" title="https://docs.openfuyao.cn/docs/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" ref="nofollow noopener noreferrer"><strong>https://docs.openfuyao.cn/docs/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/</strong></a><strong>）</strong>，它能实现节点特征发现和资源池管理。面对昂贵的超节点硬件，openFuyao社区致力于打造<strong>普惠的开发者生态</strong>。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/747d6e4abb904a109d2c1e38ef2d9d65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=RvC7wl%2F2hGK5Gq5JTLv%2Fbzfyja8%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-4">三、openFuyao社区：灵衢超节点的软件使能者</h2>
<p>openFuyao是一个基于Kubernetes生态构建的开源社区，致力于为灵衢等新型硬件提供标准、易用的云原生接入与管理能力。其在灵衢超节点支持方面主要包括以下四个维度：</p>
<h3 data-id="heading-5">3.1 K8s灵衢化使能</h3>
<p>通过设备插件、CNI/CSI插件等方式，将灵衢硬件能力暴露给Kubernetes。</p>

























<table><thead><tr><th><strong>组件</strong></th><th><strong>功能描述</strong></th><th><strong>适用场景</strong></th></tr></thead><tbody><tr><td>UB CNI 插件</td><td>为Pod提供基于UB的高性能网络互通能力</td><td>AI训练、高性能计算</td></tr><tr><td>UB CSI 插件</td><td>实现跨节点的存储卷动态挂载与迁移</td><td>有状态应用、数据密集型任务</td></tr><tr><td>UB Device Plugin</td><td>将灵衢设备（如NPU、智能网卡）作为K8s资源管理</td><td>异构算力调度</td></tr></tbody></table>
<h3 data-id="heading-6">3.2 灵衢化编排能力</h3>
<p>提供面向灵衢资源的增强调度与管控能力。</p>

























<table><thead><tr><th><strong>组件</strong></th><th><strong>功能描述</strong></th></tr></thead><tbody><tr><td>UB Node Controller</td><td>管理灵衢节点资源状态，支持动态加入/退出</td></tr><tr><td>UB 增强调度器</td><td>支持基于UB拓扑感知的容器调度</td></tr><tr><td>UB 热迁移引擎</td><td>实现容器、AI任务的无中断迁移</td></tr><tr><td>RemoteFork</td><td>快速批量克隆容器，应对突发负载</td></tr></tbody></table>
<h3 data-id="heading-7">3.3 灵衢化K8s中间件</h3>
<p>基于UB特性构建的高性能云原生中间件。</p>

























<table><thead><tr><th><strong>中间件</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>Service Mesh（如Istio+UB）</td><td>提供低延迟、高吞吐的服务网格通信</td></tr><tr><td>分布式消息（如Kafka over UB）</td><td>实现跨节点的高效消息传递</td></tr><tr><td>分布式缓存（如Redis Cluster over UB）</td><td>提供一致性与性能兼顾的缓存服务</td></tr><tr><td>分布式文件系统（如Ceph over UB）</td><td>支持跨节点存储池的统一访问</td></tr></tbody></table>
<h3 data-id="heading-8">3.4 一站式开发者生态</h3>
<p>为开发者提供不依赖真实硬件的全流程开发支持。</p>

























<table><thead><tr><th><strong>工具/环境</strong></th><th><strong>功能</strong></th></tr></thead><tbody><tr><td>Minikube + openFuyao 模拟环境</td><td>在本地PC上模拟灵衢超节点集群</td></tr><tr><td>UB Controller 代码框架</td><td>提供Controller开发模板与CRD定义</td></tr><tr><td>仿真测试工具链</td><td>支持UB资源调度、热迁移等场景仿真</td></tr><tr><td>性能分析工具（Prometheus + Grafana）</td><td>提供资源使用、延迟、带宽等监控能力</td></tr></tbody></table>
<p>因此，我们提供了一套不依赖物理灵衢硬件的“全流程仿真工具链”，让开发者在普通PC上即可完成以下闭环。下图便是<strong>openFuyao全栈架构图</strong>， 清晰地展示了 openFuyao 社区如何围绕灵衢硬件构建起一套完整的软件生态。这种“软件定义硬件”的模式，让每一位开发者都能提前通过虚拟环境参与到下一代算力架构的创新中来。</p>
<ul>
<li><strong>Layer 0 (Hardware):</strong> 最底层是灵衢超节点，提供基于 UB 总线的统一资源池。</li>
<li><strong>Layer 1 (Enablement):</strong> 通过 UB CNI（网络）和 UB CSI（存储）插件，让 K8s 能够直接纳管底层硬件资源。</li>
<li><strong>Layer 2 (Orchestration):</strong> 核心的编排层，包含 UB Node Controller、增强调度器以及支持热迁移/RemoteFork 的高级特性。</li>
<li><strong>Layer 3 (Middleware):</strong> 针对 UB 优化的中间件，如 Service Mesh、分布式缓存和消息队列，充分利用总线的高带宽低延时。</li>
<li><strong>Layer 4 (Applications):</strong> 顶层支撑各类 AI 和大数据应用。</li>
<li><strong>Side Bar (Dev Ecosystem):</strong> 右侧展示了贯穿全流程的开发者工具链，包括开发、编译、仿真、测试和 SDK，印证了“一站式无硬件开发”。
<ul>
<li><strong>开发（Develop）：</strong> 基于标准K8s接口的SDK，编写适配UB总线的应用逻辑。</li>
<li><strong>编译（Build）：</strong> 包含UB设备模拟桩的交叉编译工具链。</li>
<li><strong>仿真（Simulate）：</strong> 高保真的UB硬件模拟器，能够在软件层面精确复现总线竞争、拓扑结构和资源池化行为。</li>
<li><strong>测试（Test）：</strong> 集成自动化测试框架，验证应用在超节点环境下的鲁棒性。</li>
</ul>
</li>
</ul>
<blockquote>
<p>官网如下：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.openfuyao.cn%2Fzh%2F" target="_blank" title="https://www.openfuyao.cn/zh/" ref="nofollow noopener noreferrer"><strong>https://www.openfuyao.cn/zh/</strong></a><strong>。</strong></p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/350f15596ca74c328663310f2ae56501~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=ZT0KETaclUbayjj5xNnV7fgq4BI%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-9">四、实战案例：<strong>无硬件模拟灵衢UB控制器开发</strong></h2>
<h3 data-id="heading-10">4.1  环境搭建与部署</h3>
<p>要实现无硬件下的灵衢开发，首先搭建模拟环境。openFuyao基于Kubernetes，因此我们使用Minikube模拟单节点集群。以下步骤基于官方快速入门文档调整。</p>
<p><strong>前提条件：</strong></p>
<ul>
<li>系统：Ubuntu 22.04 / macOS / Windows WSL2 / openEuler 22.03（虚拟机）</li>
<li>工具：Docker、kubectl、Minikube</li>
<li>资源：至少4GB内存、2核CPU（本地PC即可）</li>
</ul>
<h4 data-id="heading-11">4.1.1 安装Minikube模拟集群</h4>
<p>下载Minikube（<a href="https://link.juejin.cn?target=https%3A%2F%2Fminikube.sigs.k8s.io%2Fdocs%2Fstart%2F" target="_blank" title="https://minikube.sigs.k8s.io/docs/start/" ref="nofollow noopener noreferrer">minikube.sigs.k8s.io/docs/start/</a>）：</p>
<pre><code class="hljs language-bash" lang="bash">curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
sudo install minikube-linux-amd64 /usr/local/bin/minikube
minikube start --driver=docker
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90a7cc03495c4679812cbaba2b358e60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=k0hRERcxyfc4uzieIYtTdyo1hDg%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-12">4.1.2 集成openFuyao组件</h4>
<p>由于openFuyao是Kubernetes增强版，我们模拟安装其发行版。参考文档：</p>
<pre><code class="hljs language-plain" lang="plain">curl -sfL https://openfuyao.obs.cn-north-4.myhuaweicloud.com/openFuyao/bkeadm/releases/download/v25.09/download.sh | bash
bke init --otherRepo cr.openfuyao.cn/openfuyao/bke-online-installed:v25.09
kubectl get pods -A  # 检查Pod状态
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1408565f9334de2b2eb2f51f0148ac7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=gR4VGgF%2FVvBwhpyFh0j8DIzZkfU%3D" alt="" loading="lazy"/></p>
<p>如果初始化失败，检查网络连通性。模拟环境预计15分钟完成。</p>
<h4 data-id="heading-13">4.1.3 创建灵衢CRD</h4>
<p>为模拟UB，添加自定义CRD（Custom Resource Definition）：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># crd.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apiextensions.k8s.io/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">CustomResourceDefinition</span>
<span class="hljs-attr">metadata:</span>
<span class="hljs-comment"># （完整YAML见后文代码块）</span>
<span class="hljs-string">kubectl</span> <span class="hljs-string">apply</span> <span class="hljs-string">-f</span> <span class="hljs-string">crd.yaml</span>
<span class="hljs-string">kubectl</span> <span class="hljs-string">describe</span> <span class="hljs-string">crd</span> <span class="hljs-string">ubbridges.lingqu.openfuyao.cn</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd1e2ad2178a4276a144f86e255a54a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=Ib3rKHF050rIgnbNBV8RPr0xR0U%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-14"><strong>4.2 项目结构与代码实现</strong></h3>
<p>在本实践中，我们将开发一个用于管理“灵衢统一总线（Unified Bus, UB）”资源的Kubernetes自定义控制器（Controller）。此处的“UB”并非泛指，它特指灵衢硬件协议中核心的“统一总线”这一实体概念。我们的控制器代码，是在软件层面<strong>抽象并模拟</strong>了对这条硬件总线上资源（如虚拟通道、连接状态）的调度与管理行为。</p>
<h4 data-id="heading-15">4.2.1 项目结构</h4>
<pre><code class="hljs language-bash" lang="bash">lingqu-ub-controller/
├── go.mod
├── main.go
├── api/v1/ubbridge_types.go
├── controllers/ubbridge_controller.go
├── crd.yaml
├── Dockerfile
└── deployment.yaml
</code></pre>
<h4 data-id="heading-16">4.2.2 完整代码</h4>
<p><strong>（1）go.mod</strong></p>
<pre><code class="hljs language-plain" lang="plain">module lingqu-ub

go 1.23

require (
k8s.io/apimachinery v0.30.0
k8s.io/client-go v0.30.0
sigs.k8s.io/controller-runtime v0.18.0
)
</code></pre>
<p><strong>（2）api/v1/ubbridge_types.go</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> v1

<span class="hljs-keyword">import</span> ( metav1 <span class="hljs-string">"k8s.io/apimachinery/pkg/apis/meta/v1"</span> )

<span class="hljs-keyword">type</span> UBBridgeSpec <span class="hljs-keyword">struct</span> {
    SourceNode    <span class="hljs-type">string</span> <span class="hljs-string">`json:"sourceNode,omitempty"`</span>
    TargetNode    <span class="hljs-type">string</span> <span class="hljs-string">`json:"targetNode,omitempty"`</span>
    MigrationType <span class="hljs-type">string</span> <span class="hljs-string">`json:"migrationType,omitempty"`</span>
}

<span class="hljs-keyword">type</span> UBBridgeStatus <span class="hljs-keyword">struct</span> { Phase <span class="hljs-type">string</span> <span class="hljs-string">`json:"phase,omitempty"`</span> }

<span class="hljs-keyword">type</span> UBBridge <span class="hljs-keyword">struct</span> {
    metav1.TypeMeta   <span class="hljs-string">`json:",inline"`</span>
    metav1.ObjectMeta <span class="hljs-string">`json:"metadata,omitempty"`</span>
    Spec   UBBridgeSpec   <span class="hljs-string">`json:"spec,omitempty"`</span>
    Status UBBridgeStatus <span class="hljs-string">`json:"status,omitempty"`</span>
}

<span class="hljs-comment">// +kubebuilder:object:root=true</span>
<span class="hljs-keyword">type</span> UBBridgeList <span class="hljs-keyword">struct</span> {
    metav1.TypeMeta <span class="hljs-string">`json:",inline"`</span>
    metav1.ListMeta <span class="hljs-string">`json:"metadata,omitempty"`</span>
    Items           []UBBridge <span class="hljs-string">`json:"items"`</span>
}
</code></pre>
<p><strong>（3）controllers/ubbridge_controller.go</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> controllers

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    lingquv1 <span class="hljs-string">"lingqu-ub/api/v1"</span>
    ctrl <span class="hljs-string">"sigs.k8s.io/controller-runtime/pkg/log"</span>
)

<span class="hljs-keyword">type</span> UBBridgeReconciler <span class="hljs-keyword">struct</span> {
    client.Client
    Scheme *runtime.Scheme
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(r *UBBridgeReconciler)</span></span> Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, <span class="hljs-type">error</span>) {
    <span class="hljs-keyword">var</span> ub lingquv1.UBBridge
    <span class="hljs-keyword">if</span> err := r.Get(ctx, req.NamespacedName, &amp;ub); err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> ctrl.Result{}, client.IgnoreNotFound(err)
    }
    ub.Status.Phase = <span class="hljs-string">"Migrated"</span>
    r.Status().Update(ctx, &amp;ub)
    <span class="hljs-keyword">return</span> ctrl.Result{}, <span class="hljs-literal">nil</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(r *UBBridgeReconciler)</span></span> SetupWithManager(mgr ctrl.Manager) <span class="hljs-type">error</span> {
    <span class="hljs-keyword">return</span> ctrl.NewControllerManagedBy(mgr).For(&amp;lingquv1.UBBridge{}).Complete(r)
}
</code></pre>
<p><strong>（4）main.go</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"flag"</span>
    <span class="hljs-string">"os"</span>

    <span class="hljs-string">"k8s.io/apimachinery/pkg/runtime"</span>
    utilruntime <span class="hljs-string">"k8s.io/apimachinery/pkg/util/runtime"</span>
    clientgoscheme <span class="hljs-string">"k8s.io/client-go/kubernetes/scheme"</span>
    ctrl <span class="hljs-string">"sigs.k8s.io/controller-runtime"</span>
    <span class="hljs-string">"sigs.k8s.io/controller-runtime/pkg/healthz"</span>
    <span class="hljs-string">"sigs.k8s.io/controller-runtime/pkg/log/zap"</span>

    lingquv1 <span class="hljs-string">"lingqu-ub/api/v1"</span>
    <span class="hljs-string">"lingqu-ub/controllers"</span>
)

<span class="hljs-keyword">var</span> (
    scheme   = runtime.NewScheme()
    setupLog = ctrl.Log.WithName(<span class="hljs-string">"setup"</span>)
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> {
    utilruntime.Must(clientgoscheme.AddToScheme(scheme))
    utilruntime.Must(lingquv1.AddToScheme(scheme))
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> metricsAddr <span class="hljs-type">string</span>
    <span class="hljs-keyword">var</span> enableLeaderElection <span class="hljs-type">bool</span>
    <span class="hljs-keyword">var</span> probeAddr <span class="hljs-type">string</span>
    flag.StringVar(&amp;metricsAddr, <span class="hljs-string">"metrics-bind-address"</span>, <span class="hljs-string">":8080"</span>, <span class="hljs-string">"The address the metric endpoint binds to."</span>)
    flag.BoolVar(&amp;enableLeaderElection, <span class="hljs-string">"leader-elect"</span>, <span class="hljs-literal">false</span>, <span class="hljs-string">"Enable leader election for controller manager."</span>)
    flag.StringVar(&amp;probeAddr, <span class="hljs-string">"health-probe-bind-address"</span>, <span class="hljs-string">":8081"</span>, <span class="hljs-string">"The address the probe endpoint binds to."</span>)
    flag.Parse()

    ctrl.SetLogger(zap.New(zap.UseDevMode(<span class="hljs-literal">true</span>)))

    mgr, err := ctrl.NewManager(ctrl.GetConfigOrDie(), ctrl.Options{
        Scheme:                 scheme,
        MetricsBindAddress:     metricsAddr,
        Port:                   <span class="hljs-number">9443</span>,
        HealthProbeBindAddress: probeAddr,
        LeaderElection:         enableLeaderElection,
        LeaderElectionID:       <span class="hljs-string">"ub-controller.lingqu.openfuyao.cn"</span>,
    })
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        setupLog.Error(err, <span class="hljs-string">"unable to start manager"</span>)
        os.Exit(<span class="hljs-number">1</span>)
    }

    <span class="hljs-keyword">if</span> err = (&amp;controllers.UBBridgeReconciler{
        Client: mgr.GetClient(),
        Scheme: mgr.GetScheme(),
    }).SetupWithManager(mgr); err != <span class="hljs-literal">nil</span> {
        setupLog.Error(err, <span class="hljs-string">"unable to create controller"</span>, <span class="hljs-string">"controller"</span>, <span class="hljs-string">"UBBridge"</span>)
        os.Exit(<span class="hljs-number">1</span>)
    }

    <span class="hljs-keyword">if</span> err := mgr.AddHealthzCheck(<span class="hljs-string">"healthz"</span>, healthz.Ping); err != <span class="hljs-literal">nil</span> {
        setupLog.Error(err, <span class="hljs-string">"unable to set up health check"</span>)
        os.Exit(<span class="hljs-number">1</span>)
    }
    <span class="hljs-keyword">if</span> err := mgr.AddReadyzCheck(<span class="hljs-string">"readyz"</span>, healthz.Ping); err != <span class="hljs-literal">nil</span> {
        setupLog.Error(err, <span class="hljs-string">"unable to set up ready check"</span>)
        os.Exit(<span class="hljs-number">1</span>)
    }

    setupLog.Info(<span class="hljs-string">"starting manager"</span>)
    <span class="hljs-keyword">if</span> err := mgr.Start(ctrl.SetupSignalHandler()); err != <span class="hljs-literal">nil</span> {
        setupLog.Error(err, <span class="hljs-string">"problem running manager"</span>)
        os.Exit(<span class="hljs-number">1</span>)
    }
}
</code></pre>
<h4 data-id="heading-17">4.2.3 编译与镜像构建</h4>
<pre><code class="hljs language-bash" lang="bash">go mod tidy
go build -o ub-controller
docker build -t ub-controller:latest .
minikube image load ub-controller:latest
</code></pre>
<h4 data-id="heading-18">4.2.4 部署到Minikube</h4>
<p><strong>（1）deployment.yaml</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># deployment.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata: name:</span> <span class="hljs-string">ub-controller</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span> { <span class="hljs-attr">app:</span> <span class="hljs-string">ub-controller</span> }
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span> { <span class="hljs-attr">labels:</span> { <span class="hljs-attr">app:</span> <span class="hljs-string">ub-controller</span> } }
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">manager</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">ub-controller:latest</span>
        <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">Never</span>
</code></pre>
<p><strong>（2）分析命令</strong></p>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f deployment.yaml
kubectl logs -f deployment/ub-controller
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1deaae0ca10d4bdd99b4fe868f2e0f2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=N9C8vGl%2BaYq9C0gKQTvQCBvWcJ8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-19">4.3 <strong>编译、部署与验证</strong></h3>
<p>定性分析评估UB性能，如迁移效率和资源利用。无硬件下，使用kubectl top和Prometheus模拟。</p>
<p><strong>（1）安装Prometheus</strong></p>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/main/bundle.yaml
</code></pre>
<p><strong>（2）分析命令</strong></p>
<pre><code class="hljs language-bash" lang="bash">kubectl top pods  <span class="hljs-comment"># 查看资源使用</span>
kubectl logs -f ub-controller-pod  <span class="hljs-comment"># 检查日志</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b275df3618cb4faa96217ad4558636fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=fd088fztbBvyoNSic%2FcjS0UI1t8%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-bash" lang="bash">NAME            CPU(cores)   MEMORY(bytes)  
ub-controller   150m         256Mi          
ub-pod-1        200m         512Mi          
ub-pod-2        80m          128Mi
</code></pre>
<h3 data-id="heading-20">4.4 <strong>样例演示与问题排查</strong></h3>
<p><strong>（1）ub-demo.yaml（简单UB热迁移）</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ub-demo.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">lingqu.openfuyao.cn/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">UnifiedBus</span>  <span class="hljs-comment"># 或 BusLink, BusChannel，使其更贴近“总线”概念</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">test-bus-link</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">sourceEndpoint:</span> <span class="hljs-string">node-a</span>
  <span class="hljs-attr">targetEndpoint:</span> <span class="hljs-string">node-b</span>
  <span class="hljs-attr">bandwidthRequest:</span> <span class="hljs-string">"10G"</span>
<span class="hljs-comment"># status: # 可以增加状态字段，如 established, migrating, error</span>
</code></pre>
<p><strong>（2）分析命令</strong></p>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f ub-demo.yaml
kubectl get ubbridges -w  <span class="hljs-comment"># 查看状态</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8e724db53f34359bf488feca35320cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038052&amp;x-signature=HLxrBgCPyhtq3Vb58P5z9i938J0%3D" alt="" loading="lazy"/></p>
<p><strong>常见问题</strong>：</p>
<ul>
<li>Pod Pending → 检查节点资源 kubectl describe node</li>
<li>镜像拉取失败 → 记得minikube image load</li>
<li>网络问题 → 验证Minikube IP</li>
</ul>
<hr/>
<h2 data-id="heading-21">五、总结与展望</h2>
<p>通过本文的实践，我们展示了如何在无真实硬件的情况下，基于openFuyao社区工具链完成灵衢UB控制器的全流程开发与验证。openFuyao不仅提供了灵衢硬件的软件使能能力，更构建了一个涵盖开发、仿真、测试、部署的一站式开发者生态。未来，我们可以通过以下方式不断推动社区和生态的发展。</p>
<ul>
<li><strong>更多灵衢硬件模拟场景</strong>：支持GPU/NPU池化、内存热插拔等高级特性仿真。</li>
<li><strong>生态工具链持续丰富</strong>：提供更易用的CLI、Web控制台、插件市场等。</li>
<li><strong>社区协作与标准推进</strong>：推动灵衢协议与Kubernetes生态的深度融合与标准化。</li>
</ul>
<p>我们鼓励更多开发者加入openFuyao社区，共同推动智能算力基础设施的软件创新与生态繁荣。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[已有Flutter项目适配鸿蒙6]]></title>    <link>https://juejin.cn/post/7582149417768812594</link>    <guid>https://juejin.cn/post/7582149417768812594</guid>    <pubDate>2025-12-11T06:06:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582149417768812594" data-draft-id="7579906040537219118" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="已有Flutter项目适配鸿蒙6"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-12-11T06:06:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="new小码"/> <meta itemprop="url" content="https://juejin.cn/user/1558425622815504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            已有Flutter项目适配鸿蒙6
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1558425622815504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    new小码
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:06:41.000Z" title="Thu Dec 11 2025 06:06:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#444}.hljs-keyword,.hljs-link,.hljs-literal,.hljs-section,.hljs-selector-tag{color:#fff}.hljs-subst,.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#ddd}.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-bullet,.hljs-name,.hljs-string,.hljs-symbol,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#d88}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#777}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-strong,.hljs-title,.hljs-type{font-weight:700}.hljs-emphasis{font-style:italic}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9d2b1d467d245d4be28f9115f95563b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmV35bCP56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038001&amp;x-signature=GxhhvAjq2246ZTfUqmCIyIxKac4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-0">环境准备</h3>
<p>HarmonyOS 开发环境</p>
<p>Flutter 环境管理工具FVM （安装方式网上有很多）</p>
<p>官方Flutter</p>
<h3 data-id="heading-1">使用FVM安装鸿蒙版的Flutter</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2Fopenharmony-tpc%2Fflutter_flutter" target="_blank" title="https://gitcode.com/openharmony-tpc/flutter_flutter" ref="nofollow noopener noreferrer">前往鸿蒙flutter官方仓库 </a>
可以发现他的标签已经支持到3.27.5，但这不是一个正式版，但是他是目前最新的版本了</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02cb77a454d04e95831ee83fe09192eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmV35bCP56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038001&amp;x-signature=o23tYzoKQGOBWaPMqvZrb2cf3E0%3D" alt="截屏2025-12-11 10.37.55.png" loading="lazy"/></p>
<p>接下来，我们需要下载项目，并将其切到 3.27.5-ohos-1.0.1 标签</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">
# </span><span class="bash">将目录先切换到FVM的版本路径</span>
cd /XXX/fvm/versions
<span class="hljs-meta prompt_">
# </span><span class="bash">下载仓库</span> 
git clone https://gitcode.com/openharmony-sig/flutter_flutter.git 
<span class="hljs-meta prompt_">

# </span><span class="bash">切换到 3.22.1-ohos-1.0.0 标签</span> 
cd flutter_flutter 
git checkout 3.27.5-ohos-1.0.1

</code></pre>
<h3 data-id="heading-2">完成后查看Flutter版本</h3>
<p>在命令行执行</p>
<pre><code class="hljs language-shell" lang="shell">fvm list
</code></pre>
<p>会看到我们安装后的鸿蒙版本SDK</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/636a1fe65d9340658f64e8744c573f8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmV35bCP56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038001&amp;x-signature=QgG8da3FwB1NjnxhU1HO457AFis%3D" alt="截屏2025-12-11 10.57.03.png" loading="lazy"/></p>
<h3 data-id="heading-3">使用我们安装的鸿蒙Flutter</h3>
<p>切换到我们的项目中来使用 鸿蒙版的Flutter，这里如果你的工程使用了git 托管，我建议另起一个分支来处理鸿蒙适配</p>
<p>接下来，<strong>切换到项目根目录下</strong>，运行以下命令使用刚刚安装的 Flutter SDK：<strong>（注意，如果弹出一些提醒，一路 <code>yes</code> 即可：）</strong></p>
<pre><code class="hljs language-shell" lang="shell">fvm use  3.27.5-ohos-1.0.1
</code></pre>
<h3 data-id="heading-4">改造我们的工程来适配鸿蒙</h3>
<p><strong>如果你的工程使用了git 托管，我建议另起一个分支来处理鸿蒙适配</strong>
下面我们使用鸿蒙版的Flutter来为我们的项目创建 ohos 文件夹：</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">建议先在这里确认一下你的 当前flutter sdk有没有切换成功</span>
flutter --version
<span class="hljs-meta prompt_">
# </span><span class="bash">如果没有切换可以执行 fvm use 指令来切换到鸿蒙Flutter</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">执行命令创建ohos文件</span>
flutter create --platforms ohos .  //这行最好这里有个点.
<span class="hljs-meta prompt_">
# </span><span class="bash">如果上面这个命令不好用 可以试试</span>
fvm flutter create --platforms ohos .
</code></pre>
<p>这样工程中就出现了ohos 文件</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4116fbb1a79945d2acb8ae9e0a372a27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmV35bCP56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038001&amp;x-signature=969P5kfwKd9g6aS8yYLtix%2FyKjA%3D" alt="截屏2025-12-11 11.12.29.png" loading="lazy"/></p>
<h3 data-id="heading-5">第三方插件的管理</h3>
<p>对于三方插件来说，纯 Dart 的库是可以直接在鸿蒙上使用的，和平台相关的类库，需要兼容鸿蒙的库。他们不在 pub 上，而是由开源项目进行维护。有哪些插件支持了鸿蒙，可以在这个清单列表中查看 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2Fopenharmony-tpc%2Fflutter_packages%23openharmony%25E5%25B9%25B3%25E5%258F%25B0%25E5%25B7%25B2%25E5%2585%25BC%25E5%25AE%25B9%25E5%25BA%2593" target="_blank" title="https://gitcode.com/openharmony-tpc/flutter_packages#openharmony%E5%B9%B3%E5%8F%B0%E5%B7%B2%E5%85%BC%E5%AE%B9%E5%BA%93" ref="nofollow noopener noreferrer">gitcode.com/openharmony…</a>
比如我的项目中使用了 <code>shared_preferences</code> 就需要使用鸿蒙提供的版本，这里我们可以使用<code>dependency_overrides</code> 覆盖依赖，这样不会影响以前的代码结构：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ffcb26773c54394a56d82adee6f7d65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmV35bCP56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038001&amp;x-signature=dCARxB9ZCJS5fwHR%2Fbs4ObsMQds%3D" alt="截屏2025-12-11 11.16.34.png" loading="lazy"/></p>
<p>在项目目录下执行一下命令 来下载依赖库</p>
<pre><code class="hljs language-shell" lang="shell">flutter pub get //或者是fvm flutter pub get
</code></pre>
<h3 data-id="heading-6">对项目进行打包运行</h3>
<p>这时候就需要使用鸿蒙的开发 IDE了。打开DevEco-studio</p>
<p>使用DevEco-studio打开刚刚创建的ohos 文件夹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a0cbacce3314745be22c4365bdf4ff6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmV35bCP56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038001&amp;x-signature=7YoDnXuNYEoBXFAFqP7DnPV%2Fnxo%3D" alt="截屏2025-12-11 11.25.25.png" loading="lazy"/></p>
<p>IDE 第一次可能会执行构建</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95a24d0a68a74a98b88f6a3a86b674c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmV35bCP56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766038001&amp;x-signature=Lf%2BQF6jU%2FMhXjc06533vpMJN4YE%3D" alt="image.png" loading="lazy"/>
如果有失败可以使用<code>flutter doctor</code>或者 <code>fvm flutter doctor</code>来排除一下问题</p>
<h4 data-id="heading-7">一切正常的话，来打包吧</h4>
<pre><code class="hljs language-shell" lang="shell">flutter build hap --release    //或 fvm flutter build hap --release
</code></pre>
<p>这样项目就可以在鸿蒙上跑起来了, 打开模拟器，点击运行即可，如果是真机调试，打开开发者模式重启手机，打开USB调试，插在电脑上，这里我遇到过不识别的问题，我换了官方数据线就好了，普通安卓type-C线可能会不识别【裂开】</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript 内存三空间协同机制：代码空间、栈空间与堆空间如何联合运行]]></title>    <link>https://juejin.cn/post/7582156219060043839</link>    <guid>https://juejin.cn/post/7582156219060043839</guid>    <pubDate>2025-12-11T06:09:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156219060043839" data-draft-id="7582182817107640346" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript 内存三空间协同机制：代码空间、栈空间与堆空间如何联合运行"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2025-12-11T06:09:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="烟袅破辰"/> <meta itemprop="url" content="https://juejin.cn/user/1845419006243504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript 内存三空间协同机制：代码空间、栈空间与堆空间如何联合运行
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1845419006243504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    烟袅破辰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:09:41.000Z" title="Thu Dec 11 2025 06:09:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在 JavaScript 开发中，我们常常听说“原始类型存在栈里，对象存在堆里”，但很少有人深入探讨：<strong>函数代码存在哪里？执行时到底发生了什么？为什么闭包能记住变量？</strong></p>
<p>要真正理解这些问题，必须跳出“栈 vs 堆”的二元模型，引入第三个关键角色——<strong>代码空间（Code Space）</strong> 。本文将系统阐述 JavaScript 引擎（以 V8 为例）中 <strong>代码空间、栈空间、堆空间</strong> 三者如何协同工作，共同支撑起整个语言的运行机制。</p>
<hr/>
<h2 data-id="heading-0">一、三大内存空间的角色定位</h2>
<p>JavaScript 引擎在运行时，会将内存划分为三个逻辑区域，各司其职：</p>

























<table><thead><tr><th>空间</th><th>存储内容</th><th>特点</th></tr></thead><tbody><tr><td><strong>代码空间</strong></td><td>编译后的字节码或机器码</td><td>只读、共享、由引擎管理</td></tr><tr><td><strong>栈空间</strong></td><td>执行上下文、原始值、对象引用</td><td>快速分配/释放、连续、生命周期短</td></tr><tr><td><strong>堆空间</strong></td><td>所有对象（包括函数对象、闭包环境）</td><td>动态分配、不连续、依赖垃圾回收</td></tr></tbody></table>
<p>这三者并非孤立存在，而是通过<strong>指针引用</strong>和<strong>执行流</strong>紧密协作。</p>
<hr/>
<h2 data-id="heading-1">二、函数定义：三空间的初次联动</h2>
<p>考虑以下函数定义：</p>
<pre><code class="hljs language-css" lang="css">function add(<span class="hljs-selector-tag">a</span>, <span class="hljs-selector-tag">b</span>) {
  return <span class="hljs-selector-tag">a</span> + <span class="hljs-selector-tag">b</span>;
}
</code></pre>
<h3 data-id="heading-2">1. 代码空间：存放执行逻辑</h3>
<ul>
<li>引擎将 <code>return a + b</code> 编译为字节码（如 <code>Load a</code>, <code>Load b</code>, <code>Add</code>, <code>Return</code>）；</li>
<li>这些指令被存入<strong>代码空间</strong>，作为可复用的执行模板。</li>
</ul>
<h3 data-id="heading-3">2. 堆空间：创建函数对象</h3>
<ul>
<li>
<p>JavaScript 中函数是<strong>一等对象</strong>，因此会创建一个 <code>Function</code> 类型的对象；</p>
</li>
<li>
<p>该对象包含：</p>
<ul>
<li>属性：<code>name: "add"</code>, <code>length: 2</code>；</li>
<li>内部指针 <code>[[Code]]</code>：指向代码空间中 <code>add</code> 的字节码入口；</li>
<li><code>[[Environment]]</code>：指向定义时的词法环境（用于闭包）。</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4">3. 栈空间：注册变量引用</h3>
<ul>
<li>在全局执行上下文中，变量 <code>add</code> 被注册；</li>
<li>其值是一个<strong>引用（指针）</strong> ，指向堆中的函数对象。</li>
</ul>
<blockquote>
<p>此时三空间已建立连接：<br/>
<strong>栈（add 变量） → 堆（函数对象） → 代码空间（字节码）</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-5">三、函数调用：三空间的动态协作</h2>
<p>执行 <code>const result = add(2, 3);</code> 时，三空间开始动态交互：</p>
<h3 data-id="heading-6">步骤 1：查找函数入口</h3>
<ul>
<li>引擎通过栈中的 <code>add</code> 变量，找到堆中的函数对象；</li>
<li>从函数对象取出 <code>[[Code]]</code> 指针，定位到代码空间的起始指令。</li>
</ul>
<h3 data-id="heading-7">步骤 2：压入执行上下文（栈空间）</h3>
<ul>
<li>
<p>在调用栈顶部创建新帧，包含：</p>
<ul>
<li>参数 <code>a = 2</code>, <code>b = 3</code>（原始值，直接存栈）；</li>
<li>返回地址、作用域链等控制信息。</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">步骤 3：执行指令（引擎驱动）</h3>
<ul>
<li>
<p>引擎（如 V8 的 Ignition 解释器）<strong>逐条读取代码空间中的字节码</strong>，并在 CPU 上执行：</p>
<ul>
<li><code>Load a</code> → 从当前栈帧读取 <code>2</code>；</li>
<li><code>Load b</code> → 读取 <code>3</code>；</li>
<li><code>Add</code> → 引擎内部计算 <code>2 + 3 = 5</code>（这是 C++ 实现的底层操作）；</li>
<li><code>Return</code> → 准备返回值。</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：<strong>执行发生在引擎/CPU 层面，不是在栈或堆中</strong>。<br/>
栈和堆只是被操作的“数据区”。</p>
</blockquote>
<h3 data-id="heading-9">步骤 4：返回结果（写回栈）</h3>
<ul>
<li>返回值 <code>5</code>（原始类型）被写入<strong>调用者的栈帧</strong>（即 <code>result = 5</code>）；</li>
<li><code>add</code> 的栈帧被弹出，参数 <code>a</code>、<code>b</code> 自动销毁。</li>
</ul>
<hr/>
<h2 data-id="heading-10">四、复杂场景：对象与闭包如何影响三空间</h2>
<h3 data-id="heading-11">场景 1：返回对象</h3>
<pre><code class="hljs language-ini" lang="ini">function createObj(x) {
  return { value: x }<span class="hljs-comment">;</span>
}
const <span class="hljs-attr">obj</span> = createObj(<span class="hljs-number">10</span>)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li><code>{ value: x }</code> 是引用类型 → 在<strong>堆空间</strong>分配内存；</li>
<li>栈中 <code>obj</code> 变量存储的是<strong>堆地址（引用）</strong> ；</li>
<li>即使 <code>createObj</code> 执行结束，只要 <code>obj</code> 存在，堆中对象就不会被 GC 回收。</li>
</ul>
<h3 data-id="heading-12">场景 2：闭包捕获变量</h3>
<pre><code class="hljs language-ini" lang="ini">function outer(n) {
  let <span class="hljs-attr">count</span> = n<span class="hljs-comment">;</span>
  return function inner() {
    return ++count<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}
const <span class="hljs-attr">inc</span> = outer(<span class="hljs-number">5</span>)<span class="hljs-comment">;</span>
inc()<span class="hljs-comment">; // 6</span>
</code></pre>
<ul>
<li><code>count</code> 原本是 <code>outer</code> 的局部变量（应存栈中）；</li>
<li>但 <code>inner</code> 引用了它 → 引擎检测到闭包；</li>
<li>于是将 <code>count</code> <strong>从栈提升到堆中</strong>，放入一个特殊的 <strong>closure 环境对象</strong>；</li>
<li><code>inner</code> 的 <code>[[Environment]]</code> 指向该堆对象；</li>
<li>即使 <code>outer</code> 栈帧销毁，<code>count</code> 仍存活于堆中。</li>
</ul>
<blockquote>
<p>闭包的本质：<strong>通过堆空间延长变量生命周期</strong>，打破栈的自动回收规则。</p>
</blockquote>
<hr/>
<h2 data-id="heading-13">五、总结</h2>
<p>执行流程：
引擎 → 读代码空间指令 → 操作栈（取参数）和堆（建对象） → 结果写回调用者栈帧</p>
<ul>
<li><strong>代码空间</strong>：提供“做什么”（指令）；</li>
<li><strong>栈空间</strong>：提供“用什么”（临时数据）；</li>
<li><strong>堆空间</strong>：提供“存什么”（持久对象）；</li>
<li><strong>JavaScript 引擎</strong>：负责“怎么做”（执行协调）。</li>
</ul>
<p>理解这三者的分工与协作，你就能真正看透 JavaScript 的运行本质——无论是性能优化、内存泄漏排查，还是闭包、异步、模块化等高级特性，都将变得清晰而自然。</p>
<blockquote>
<p>掌握内存，方能驾驭语言。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[深入理解 JavaScript 内存机制与闭包原理]]></title>    <link>https://juejin.cn/post/7582207260198862902</link>    <guid>https://juejin.cn/post/7582207260198862902</guid>    <pubDate>2025-12-11T06:10:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582207260198862902" data-draft-id="7582169248094748678" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="深入理解 JavaScript 内存机制与闭包原理"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2025-12-11T06:10:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="烟袅破辰"/> <meta itemprop="url" content="https://juejin.cn/user/1845419006243504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            深入理解 JavaScript 内存机制与闭包原理
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1845419006243504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    烟袅破辰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:10:52.000Z" title="Thu Dec 11 2025 06:10:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在前端开发中，JavaScript 的内存管理常常被开发者忽视。然而，掌握其底层内存机制，不仅能帮助我们写出更高效的代码，还能深入理解诸如闭包、作用域链等核心概念。本文将从 JavaScript 的执行机制出发，逐步剖析栈内存与堆内存的分工，并揭示闭包背后的真实运作逻辑。</p>
<hr/>
<h2 data-id="heading-0">一、JavaScript 是什么语言？</h2>
<p>JavaScript 是一门<strong>动态弱类型语言</strong>：</p>
<ul>
<li><strong>动态语言</strong>：变量的数据类型在运行时确定，无需提前声明。</li>
<li><strong>弱类型语言</strong>：不同类型之间可以自动转换（如 <code>"1" + 2 === "12"</code>）。</li>
</ul>
<p>与 C/C++ 等需要手动申请（<code>malloc</code>）和释放（<code>free</code>）内存的语言不同，JavaScript 的内存由引擎自动管理，开发者<strong>无需直接操作内存</strong>。</p>
<hr/>
<h2 data-id="heading-1">二、JavaScript 的执行机制简述</h2>
<p>JavaScript 引擎（如 V8）通过以下结构来组织程序的执行：</p>
<h3 data-id="heading-2">1. 调用栈（Call Stack）</h3>
<p>调用栈是 JavaScript 执行函数的核心数据结构，采用“先进后出”的原则。每当一个函数被调用，就会创建一个**执行上下文（Execution Context）**并压入栈顶；函数执行完毕后，该上下文被弹出。</p>
<h3 data-id="heading-3">2. 执行上下文的组成</h3>
<p>每个执行上下文包含以下关键部分：</p>
<ul>
<li><strong>变量环境（Variable Environment）</strong> ：存放 <code>var</code> 声明的变量。</li>
<li><strong>词法环境（Lexical Environment）</strong> ：存放 <code>let</code>、<code>const</code> 和函数参数等。</li>
<li><strong>Outer 引用</strong>：指向父级词法环境，构成<strong>作用域链</strong>。</li>
<li><strong>this 绑定</strong>：当前上下文中的 this 值。</li>
</ul>
<p>当内部函数引用了外部函数的变量时，就形成了<strong>闭包（Closure）</strong> 。</p>
<hr/>
<h2 data-id="heading-4">三、JavaScript 的内存模型：栈 vs 堆</h2>
<p>JavaScript 的内存主要分为两类：<strong>栈内存</strong>和<strong>堆内存</strong>。它们分别用于存储不同类型的数据。</p>
<h3 data-id="heading-5">1. 栈内存（Stack）</h3>
<ul>
<li>存储<strong>简单数据类型（原始类型）</strong> ：<code>number</code>、<code>string</code>、<code>boolean</code>、<code>null</code>、<code>undefined</code>、<code>symbol</code>、<code>bigint</code>。</li>
<li>特点：<strong>空间小、分配快、连续、生命周期短</strong>。</li>
<li>栈内存的管理非常高效，因为只需移动栈顶指针即可完成分配与回收。</li>
</ul>
<h3 data-id="heading-6">2. 堆内存（Heap）</h3>
<ul>
<li>存储<strong>复杂数据类型（引用类型）</strong> ：<code>Object</code>、<code>Array</code>、<code>Function</code> 等。</li>
<li>特点：<strong>空间大、分配慢、不连续、生命周期长</strong>。</li>
<li>对象在堆中创建后，栈中只保存其<strong>引用地址（指针）</strong> 。</li>
</ul>
<blockquote>
<p>为什么这样设计？<br/>
如果所有数据都放在栈中，尤其是大型对象，会导致栈空间迅速膨胀，影响上下文切换效率。而将大对象放入堆中，栈只需维护轻量级的引用，极大提升了执行效率。</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">四、闭包的本质：堆内存中的作用域快照</h2>
<p>闭包常被描述为“函数 + 其词法环境”，但其底层实现依赖于<strong>堆内存</strong>。</p>
<h3 data-id="heading-8">闭包的形成过程</h3>
<p>以如下代码为例：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> myName = <span class="hljs-string">'Alice'</span>;
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">getName</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> myName;
  }
  <span class="hljs-keyword">return</span> getName;
}

<span class="hljs-keyword">const</span> getName = <span class="hljs-title function_">foo</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getName</span>()); <span class="hljs-comment">// 'Alice'</span>
</code></pre>
<p>执行流程如下：</p>
<ol>
<li>
<p><strong>全局上下文创建</strong>：<code>foo</code> 函数被定义。</p>
</li>
<li>
<p><strong>调用 <code>foo()</code></strong> ：</p>
<ul>
<li>创建 <code>foo</code> 的执行上下文，压入调用栈。</li>
<li>引擎进行<strong>词法扫描</strong>，发现内部函数 <code>getName</code> 引用了外部变量 <code>myName</code>。</li>
<li>判断存在闭包 → 在<strong>堆内存中创建一个 closure(foo) 对象</strong>，用于保存 <code>myName</code> 的值。</li>
</ul>
</li>
<li>
<p><strong>返回 <code>getName</code> 函数</strong>：</p>
<ul>
<li><code>foo</code> 执行上下文从栈中弹出（栈内存释放）。</li>
<li>但 <code>getName</code> 仍持有对堆中 <code>closure(foo)</code> 的引用，因此 <code>myName</code> 不会被垃圾回收。</li>
</ul>
</li>
<li>
<p><strong>后续调用 <code>getName()</code></strong> ：</p>
<ul>
<li>通过作用域链访问堆中的 <code>closure(foo)</code>，成功读取 <code>myName</code>。</li>
</ul>
</li>
</ol>
<blockquote>
<p>关键点：<strong>闭包变量并非“保留在栈中”，而是被提升到堆内存中持久化存储</strong>。这是闭包能跨越函数生命周期的根本原因。</p>
</blockquote>
<hr/>
<h2 data-id="heading-9">五、为什么只有两种内存机制就够了？</h2>
<p>JavaScript 的八种数据类型可归为两类：</p>
<ul>
<li><strong>7 种原始类型</strong>：值直接存于栈中，拷贝传递。</li>
<li><strong>1 种引用类型（Object）</strong> ：值存于堆中，栈中存引用。</li>
</ul>
<p>这种“栈+堆”的二分模型，既保证了基本类型的高效访问，又支持复杂对象的动态扩展，完美平衡了性能与灵活性。</p>
<p>此外，<code>Object</code> 的 key 只能是 <code>string</code> 或 <code>symbol</code>，而 value 可以是任意类型——这进一步体现了 JavaScript 动态弱类型的特性。</p>
<hr/>
<h2 data-id="heading-10">六、总结</h2>
<ul>
<li>JavaScript 通过<strong>调用栈</strong>管理函数执行，通过<strong>栈/堆内存</strong>区分数据存储。</li>
<li><strong>原始类型</strong>存于栈，<strong>对象类型</strong>存于堆，栈中仅保留引用。</li>
<li><strong>闭包</strong>的本质是：引擎检测到内部函数引用外部变量时，在<strong>堆中创建一个 closure 对象</strong>，保存所需变量，使这些变量在外部函数执行结束后仍可访问。</li>
<li>理解内存机制，有助于我们避免内存泄漏、优化性能，并真正掌握 JavaScript 的运行原理。</li>
</ul>
<p>掌握这些底层知识，你就能在面对复杂作用域、异步回调、模块封装等问题时，做到心中有数，游刃有余。</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript 原生方法实现：数学与数字处理全解析]]></title>    <link>https://juejin.cn/post/7582207260198912054</link>    <guid>https://juejin.cn/post/7582207260198912054</guid>    <pubDate>2025-12-11T06:23:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582207260198912054" data-draft-id="7582156219060092991" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript 原生方法实现：数学与数字处理全解析"/> <meta itemprop="keywords" content="前端,JavaScript,ECMAScript 6"/> <meta itemprop="datePublished" content="2025-12-11T06:23:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024肥宅"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript 原生方法实现：数学与数字处理全解析
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024肥宅
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:23:01.000Z" title="Thu Dec 11 2025 06:23:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">引言</h4>
<p>JavaScript中的数字处理看似简单，实则隐藏着许多值得深入探讨的细节。从基本运算到复杂的大数处理，从浮点数精度到随机数生成，每个环节都影响着程序的准确性和可靠性。本文将系统性地解析JavaScript中数学与数字处理的核心实现，帮助你建立完整的技术认知体系。</p>
<h4 data-id="heading-1">一、JavaScript数字系统基础</h4>
<h5 data-id="heading-2">1.1 数字类型概览</h5>
<p>JavaScript使用IEEE 754标准的双精度浮点数表示所有数字，这导致:</p>
<ul>
<li>所有数字都是64位浮点数</li>
<li>安全整数范围: -2⁵³ + 1 到 2⁵³ - 1（±9,007,199,254,740,991）</li>
<li>最大安全值: Number.MAX_SAFE_INTEGER (9,007,199,254,740,991)</li>
<li>最小安全值: Number.MIN_SAFE_INTEGER (-9,007,199,254,740,991)</li>
</ul>
<h5 data-id="heading-3">1.2 特殊数值</h5>
<ul>
<li>Infinity 和 -Infinity：表示无穷大</li>
<li>NaN：非数字值（但类型是number）</li>
<li>Number.EPSILON：表示1与大于1的最小浮点数之间的差（约2.22e-16）</li>
</ul>
<h4 data-id="heading-4">二、大数运算实现</h4>
<h5 data-id="heading-5">2.1 BigInt类型</h5>
<p>ES2020引入的BigInt类型是处理大数的原生解决方案：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// BigInt字面量</span>
<span class="hljs-keyword">const</span> bigInt1 = <span class="hljs-number">123456789012345678901234567890n</span>;
<span class="hljs-keyword">const</span> bigInt2 = <span class="hljs-title class_">BigInt</span>(<span class="hljs-string">"123456789012345678901234567890"</span>);

<span class="hljs-comment">// 运算</span>
<span class="hljs-keyword">const</span> sum = bigInt1 + bigInt2;
<span class="hljs-keyword">const</span> product = bigInt1 * bigInt2;
<span class="hljs-keyword">const</span> modulo = bigInt1 % bigInt2;
</code></pre>
<h5 data-id="heading-6">2.2 BigInt的限制与特性</h5>
<ul>
<li>不能与普通Number混合运算</li>
<li>不支持无符号右移运算符（&gt;&gt;&gt;）</li>
<li>在JSON.stringify()中需要自定义序列化</li>
<li>除法运算会向下取整</li>
</ul>
<h5 data-id="heading-7">2.3 大数运算的最佳实践</h5>
<ol>
<li>明确使用场景：仅在超出安全整数范围时使用BigInt</li>
<li>类型一致性：避免BigInt与Number的隐式转换</li>
<li>性能考虑：BigInt运算通常比Number慢</li>
</ol>
<h4 data-id="heading-8">三、浮点数精度处理</h4>
<h5 data-id="heading-9">3.1 精度问题的根源</h5>
<p>IEEE 754双精度浮点数的固有限制：</p>
<ul>
<li>二进制无法精确表示某些十进制小数（如0.1）</li>
<li>累积误差在连续运算中会放大</li>
</ul>
<h5 data-id="heading-10">3.2 精度问题解决方案</h5>
<p>方案一：扩大为整数运算</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">num1, num2</span>) {
    <span class="hljs-keyword">const</span> scale = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(
        num1.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>)[<span class="hljs-number">1</span>]?.<span class="hljs-property">length</span> || <span class="hljs-number">0</span>,
        num2.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>)[<span class="hljs-number">1</span>]?.<span class="hljs-property">length</span> || <span class="hljs-number">0</span>
    );
    <span class="hljs-keyword">const</span> factor = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">10</span>, scale);
    <span class="hljs-keyword">return</span> (num1 * factor + num2 * factor) / factor;
}
</code></pre>
<p>方案二：使用toFixed配合数值转换</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">preciseAddition</span>(<span class="hljs-params">num1, num2, precision = <span class="hljs-number">12</span></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>((num1 + num2).<span class="hljs-title function_">toFixed</span>(precision));
}
</code></pre>
<p>方案三：第三方库方案</p>
<ul>
<li>decimal.js：功能完整的大数运算库</li>
<li>bignumber.js：专门处理任意精度十进制数</li>
<li>mathjs：综合数学计算库</li>
</ul>
<h5 data-id="heading-11">3.3 比较浮点数的最佳实践</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">areNumbersEqual</span>(<span class="hljs-params">num1, num2, epsilon = <span class="hljs-built_in">Number</span>.EPSILON</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(num1 - num2) &lt; epsilon;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">compareWithPrecision</span>(<span class="hljs-params">num1, num2, precision = <span class="hljs-number">0.000001</span></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(num1 - num2) &lt;= precision;
}
</code></pre>
<h4 data-id="heading-12">四、随机数生成器</h4>
<h5 data-id="heading-13">4.1 Math.random()的局限性</h5>
<ul>
<li>生成[0, 1)区间的伪随机浮点数</li>
<li>加密学上不安全</li>
<li>不可设置种子值</li>
</ul>
<h5 data-id="heading-14">4.2 增强型随机数函数</h5>
<p>生成指定范围整数</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">randomInt</span>(<span class="hljs-params">min, max</span>) {
    min = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(min);
    max = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(max);
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (max - min + <span class="hljs-number">1</span>)) + min;
}
</code></pre>
<p>生成指定范围浮点数</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">randomFloat</span>(<span class="hljs-params">min, max, precision = <span class="hljs-number">4</span></span>) {
    <span class="hljs-keyword">const</span> value = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (max - min) + min;
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(value.<span class="hljs-title function_">toFixed</span>(precision));
}
</code></pre>
<p>生成不重复随机序列</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generateUniqueRandomNumbers</span>(<span class="hljs-params">count, min, max</span>) {
    <span class="hljs-keyword">if</span> (max - min + <span class="hljs-number">1</span> &lt; count) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"范围太小无法生成指定数量的不重复随机数"</span>);
    }
    
    <span class="hljs-keyword">const</span> numbers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-keyword">while</span> (numbers.<span class="hljs-property">size</span> &lt; count) {
        numbers.<span class="hljs-title function_">add</span>(<span class="hljs-title function_">randomInt</span>(min, max));
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(numbers);
}
</code></pre>
<h5 data-id="heading-15">4.3 加密安全的随机数</h5>
<p>使用Web Crypto API生成加密学安全的随机数：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">secureRandomInt</span>(<span class="hljs-params">min, max</span>) {
    <span class="hljs-keyword">const</span> range = max - min + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> bytesNeeded = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log2</span>(range) / <span class="hljs-number">8</span>);
    <span class="hljs-keyword">const</span> randomBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bytesNeeded);
    crypto.<span class="hljs-title function_">getRandomValues</span>(randomBytes);
    
    <span class="hljs-keyword">let</span> randomValue = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; bytesNeeded; i++) {
        randomValue = (randomValue &lt;&lt; <span class="hljs-number">8</span>) | randomBytes[i];
    }
    
    <span class="hljs-keyword">return</span> min + (randomValue % range);
}
</code></pre>
<h4 data-id="heading-16">五、进制转换算法</h4>
<h5 data-id="heading-17">5.1 内置进制转换方法</h5>
<p>十进制转其他进制</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 数字的进制转换方法</span>
<span class="hljs-keyword">const</span> num = <span class="hljs-number">255</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>));  <span class="hljs-comment">// "11111111" - 二进制</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toString</span>(<span class="hljs-number">8</span>));  <span class="hljs-comment">// "377"      - 八进制</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)); <span class="hljs-comment">// "ff"       - 十六进制</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toString</span>(<span class="hljs-number">32</span>)); <span class="hljs-comment">// "7v"       - 三十二进制</span>
</code></pre>
<p>其他进制转十进制</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// parseInt的进制转换</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">"11111111"</span>, <span class="hljs-number">2</span>));   <span class="hljs-comment">// 255</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">"377"</span>, <span class="hljs-number">8</span>));        <span class="hljs-comment">// 255</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">"ff"</span>, <span class="hljs-number">16</span>));        <span class="hljs-comment">// 255</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">"7v"</span>, <span class="hljs-number">32</span>));        <span class="hljs-comment">// 255</span>
</code></pre>
<h5 data-id="heading-18">5.2 自定义进制转换函数</h5>
<p>通用进制转换函数</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertBase</span>(<span class="hljs-params">number, fromBase, toBase</span>) {
    <span class="hljs-keyword">if</span> (fromBase &lt; <span class="hljs-number">2</span> || fromBase &gt; <span class="hljs-number">36</span> || toBase &lt; <span class="hljs-number">2</span> || toBase &gt; <span class="hljs-number">36</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"基数必须在2到36之间"</span>);
    }
    
    <span class="hljs-comment">// 先转换为十进制</span>
    <span class="hljs-keyword">const</span> decimal = <span class="hljs-built_in">parseInt</span>(number.<span class="hljs-title function_">toString</span>(), fromBase);
    
    <span class="hljs-comment">// 从十进制转换为目标进制</span>
    <span class="hljs-keyword">return</span> decimal.<span class="hljs-title function_">toString</span>(toBase);
}
</code></pre>
<p>支持自定义字符集的进制转换</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">customBaseConvert</span>(<span class="hljs-params">number, fromChars, toChars</span>) {
    <span class="hljs-keyword">const</span> fromBase = fromChars.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> toBase = toChars.<span class="hljs-property">length</span>;
    
    <span class="hljs-comment">// 转换为十进制</span>
    <span class="hljs-keyword">let</span> decimal = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> numberStr = number.<span class="hljs-title function_">toString</span>();
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numberStr.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> char = numberStr[numberStr.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> - i];
        <span class="hljs-keyword">const</span> value = fromChars.<span class="hljs-title function_">indexOf</span>(char);
        <span class="hljs-keyword">if</span> (value === -<span class="hljs-number">1</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`无效字符: <span class="hljs-subst">${char}</span>`</span>);
        }
        decimal += value * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(fromBase, i);
    }
    
    <span class="hljs-comment">// 从十进制转换为目标进制</span>
    <span class="hljs-keyword">if</span> (decimal === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> toChars[<span class="hljs-number">0</span>];
    
    <span class="hljs-keyword">let</span> result = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">while</span> (decimal &gt; <span class="hljs-number">0</span>) {
        result = toChars[decimal % toBase] + result;
        decimal = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(decimal / toBase);
    }
    
    <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// 示例：十进制转Base62（用于URL短链接）</span>
<span class="hljs-keyword">const</span> base62Chars = <span class="hljs-string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">customBaseConvert</span>(<span class="hljs-number">123456789</span>, <span class="hljs-string">"0123456789"</span>, base62Chars)); <span class="hljs-comment">// "8M0kX"</span>
</code></pre>
<h5 data-id="heading-19">5.3 特殊进制处理</h5>
<p>二进制与十六进制互转</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">binaryToHex</span>(<span class="hljs-params">binaryStr</span>) {
    <span class="hljs-comment">// 补全到4的倍数位</span>
    <span class="hljs-keyword">const</span> padded = binaryStr.<span class="hljs-title function_">padStart</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(binaryStr.<span class="hljs-property">length</span> / <span class="hljs-number">4</span>) * <span class="hljs-number">4</span>, <span class="hljs-string">'0'</span>);
    <span class="hljs-keyword">let</span> hexStr = <span class="hljs-string">''</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; padded.<span class="hljs-property">length</span>; i += <span class="hljs-number">4</span>) {
        <span class="hljs-keyword">const</span> nibble = padded.<span class="hljs-title function_">substr</span>(i, <span class="hljs-number">4</span>);
        hexStr += <span class="hljs-built_in">parseInt</span>(nibble, <span class="hljs-number">2</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);
    }
    
    <span class="hljs-keyword">return</span> hexStr.<span class="hljs-title function_">toUpperCase</span>();
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">hexToBinary</span>(<span class="hljs-params">hexStr</span>) {
    <span class="hljs-keyword">let</span> binaryStr = <span class="hljs-string">''</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> char <span class="hljs-keyword">of</span> hexStr) {
        <span class="hljs-keyword">const</span> binary = <span class="hljs-built_in">parseInt</span>(char, <span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">4</span>, <span class="hljs-string">'0'</span>);
        binaryStr += binary;
    }
    
    <span class="hljs-keyword">return</span> binaryStr;
}
</code></pre>
<h4 data-id="heading-20">六、数值验证与边界处理</h4>
<h5 data-id="heading-21">6.1 数字验证函数</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isValidNumber</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'number'</span> &amp;&amp; !<span class="hljs-built_in">isNaN</span>(value) &amp;&amp; <span class="hljs-built_in">isFinite</span>(value);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isSafeInteger</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Number</span>.<span class="hljs-title function_">isSafeInteger</span>(value);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isPositiveNumber</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">isValidNumber</span>(value) &amp;&amp; value &gt; <span class="hljs-number">0</span>;
}
</code></pre>
<h5 data-id="heading-22">6.2 数值范围限制</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">clamp</span>(<span class="hljs-params">value, min, max</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(value, min), max);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">normalize</span>(<span class="hljs-params">value, min, max</span>) {
    <span class="hljs-keyword">return</span> (value - min) / (max - min);
}
</code></pre>
<h4 data-id="heading-23">七、性能优化与最佳实践</h4>
<h5 data-id="heading-24">7.1 数值运算优化</h5>
<ol>
<li><strong>避免不必要的类型转换:</strong> 尽量减少Number与String之间的转换</li>
<li><strong>使用位运算替代部分数学运算:</strong> 在适当场景下使用</li>
<li><strong>缓存重复计算结果:</strong> 特别是复杂的数学运算</li>
</ol>
<h5 data-id="heading-25">7.2 内存优化</h5>
<ol>
<li>使用TypedArray处理大量数值数据</li>
<li>及时释放不再使用的数值变量</li>
<li>避免创建过多的临时数值对象</li>
</ol>
<h5 data-id="heading-26">7.3 错误处理策略</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">NumberUtils</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-title function_">safeOperation</span>(<span class="hljs-params">operation, defaultValue = <span class="hljs-number">0</span></span>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">operation</span>();
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">isValidNumber</span>(result) ? result : defaultValue;
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'数值运算错误:'</span>, error.<span class="hljs-property">message</span>);
            <span class="hljs-keyword">return</span> defaultValue;
        }
    }
}
</code></pre>
<h4 data-id="heading-27">八、实际应用场景</h4>
<h5 data-id="heading-28">8.1 金融计算</h5>
<ul>
<li>使用decimal.js处理货币计算</li>
<li>固定小数位数展示</li>
<li>四舍五入规则符合会计标准</li>
</ul>
<h5 data-id="heading-29">8.2 科学计算</h5>
<ul>
<li>高精度计算需求</li>
<li>大数处理</li>
<li>误差控制</li>
</ul>
<h5 data-id="heading-30">8.3 游戏开发</h5>
<ul>
<li>伪随机数生成（可重现的随机序列）</li>
<li>物理引擎中的数值计算</li>
<li>性能优化的数学运算</li>
</ul>
<h4 data-id="heading-31">总结</h4>
<p>JavaScript的数学与数字处理能力虽然基础，但深入理解其原理和最佳实践对于开发高质量应用至关重要。关键要点包括：</p>
<ol>
<li><strong>理解JavaScript数字系统的本质:</strong> IEEE 754双精度浮点数的特性决定了数值处理的边界</li>
<li><strong>正确选择工具:</strong> 根据需求选择原生方法、BigInt或第三方库</li>
<li><strong>重视精度问题:</strong> 特别是在金融和科学计算领域</li>
<li><strong>关注安全性:</strong> 在需要加密安全的场景使用Web Crypto API</li>
<li><strong>优化性能:</strong> 合理选择算法和数据结构</li>
</ol>
<p>通过掌握这些核心概念和技术，你可以在实际开发中游刃有余地处理各种数值计算场景，构建更加稳定可靠的JavaScript应用。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[微信小程序代码复用技巧]]></title>    <link>https://juejin.cn/post/7582182817107705882</link>    <guid>https://juejin.cn/post/7582182817107705882</guid>    <pubDate>2025-12-11T06:24:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582182817107705882" data-draft-id="7582118218649403418" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="微信小程序代码复用技巧"/> <meta itemprop="keywords" content="微信小程序,性能优化"/> <meta itemprop="datePublished" content="2025-12-11T06:24:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="yogalin1993"/> <meta itemprop="url" content="https://juejin.cn/user/1626932939328311"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            微信小程序代码复用技巧
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1626932939328311/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    yogalin1993
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:24:02.000Z" title="Thu Dec 11 2025 06:24:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. <strong>自定义组件复用</strong></h2>
<h3 data-id="heading-1">基本组件封装</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// components/common-button/common-button.js</span>
<span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">properties</span>: {
    <span class="hljs-comment">// 定义属性</span>
    <span class="hljs-attr">type</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-string">'primary'</span>  <span class="hljs-comment">// primary/default/danger</span>
    },
    <span class="hljs-attr">text</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">disabled</span>: <span class="hljs-title class_">Boolean</span>
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">handleTap</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">disabled</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">'tap'</span>)
      }
    }
  }
})
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- components/common-button/common-button.wxml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
  <span class="hljs-attr">class</span>=<span class="hljs-string">"common-btn {{type}} {{disabled ? 'disabled' : ''}}"</span>
  <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"handleTap"</span>
&gt;</span>
  {{text}}
<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* components/common-button/common-button.wxss */</span>
<span class="hljs-selector-class">.common-btn</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20</span>rpx <span class="hljs-number">40</span>rpx;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8</span>rpx;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28</span>rpx;
}
<span class="hljs-selector-class">.common-btn</span><span class="hljs-selector-class">.primary</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#07c160</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
}
<span class="hljs-selector-class">.common-btn</span><span class="hljs-selector-class">.disabled</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.5</span>;
}
</code></pre>
<h3 data-id="heading-2">使用组件</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// 页面.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"usingComponents"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"common-button"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/components/common-button/common-button"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- 页面.wxml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">common-button</span> 
  <span class="hljs-attr">text</span>=<span class="hljs-string">"提交"</span> 
  <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> 
  <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"onSubmit"</span>
/&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">common-button</span> 
  <span class="hljs-attr">text</span>=<span class="hljs-string">"取消"</span> 
  <span class="hljs-attr">type</span>=<span class="hljs-string">"default"</span> 
  <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"onCancel"</span>
/&gt;</span>
</code></pre>
<h2 data-id="heading-3">2. <strong>Behavior（行为）复用</strong></h2>
<h3 data-id="heading-4">创建公共Behavior</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// behaviors/loading-behavior.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">Behavior</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span>
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-comment">// 显示加载</span>
    <span class="hljs-title function_">showLoading</span>(<span class="hljs-params">text = <span class="hljs-string">'加载中...'</span></span>) {
      wx.<span class="hljs-title function_">showLoading</span>({ <span class="hljs-attr">title</span>: text })
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">true</span> })
    },
    
    <span class="hljs-comment">// 隐藏加载</span>
    <span class="hljs-title function_">hideLoading</span>(<span class="hljs-params"/>) {
      wx.<span class="hljs-title function_">hideLoading</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span> })
    },
    
    <span class="hljs-comment">// 带加载状态的请求</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">requestWithLoading</span>(<span class="hljs-params">options</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showLoading</span>()
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(options)
        <span class="hljs-keyword">return</span> res
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">hideLoading</span>()
      }
    }
  }
})
</code></pre>
<h3 data-id="heading-5">在多个组件中复用</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// components/user-card/user-card.js</span>
<span class="hljs-keyword">const</span> loadingBehavior = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../../behaviors/loading-behavior'</span>)

<span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">behaviors</span>: [loadingBehavior],
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchUserInfo</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestWithLoading</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/user/info'</span>
      })
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">userInfo</span>: data })
    }
  }
})
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// components/product-list/product-list.js</span>
<span class="hljs-keyword">const</span> loadingBehavior = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../../behaviors/loading-behavior'</span>)

<span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">behaviors</span>: [loadingBehavior],
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadProducts</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> products = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestWithLoading</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/products'</span>
      })
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ products })
    }
  }
})
</code></pre>
<h2 data-id="heading-6">3. <strong>Mixins模式实现</strong></h2>
<p>虽然小程序不直接支持Mixins，但可以通过Behavior模拟：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// behaviors/form-behavior.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">Behavior</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">formData</span>: {},
    <span class="hljs-attr">formErrors</span>: {}
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-comment">// 表单字段变化</span>
    <span class="hljs-title function_">onFormChange</span>(<span class="hljs-params">e</span>) {
      <span class="hljs-keyword">const</span> { field } = e.<span class="hljs-property">currentTarget</span>.<span class="hljs-property">dataset</span>
      <span class="hljs-keyword">const</span> { value } = e.<span class="hljs-property">detail</span>
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        [<span class="hljs-string">`formData.<span class="hljs-subst">${field}</span>`</span>]: value,
        [<span class="hljs-string">`formErrors.<span class="hljs-subst">${field}</span>`</span>]: <span class="hljs-string">''</span>
      })
    },
    
    <span class="hljs-comment">// 表单验证</span>
    <span class="hljs-title function_">validateForm</span>(<span class="hljs-params">rules</span>) {
      <span class="hljs-keyword">const</span> errors = {}
      <span class="hljs-keyword">let</span> isValid = <span class="hljs-literal">true</span>
      
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(rules).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">field</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">formData</span>[field]
        <span class="hljs-keyword">const</span> rule = rules[field]
        
        <span class="hljs-keyword">if</span> (rule.<span class="hljs-property">required</span> &amp;&amp; !value) {
          errors[field] = rule.<span class="hljs-property">message</span> || <span class="hljs-string">'该字段必填'</span>
          isValid = <span class="hljs-literal">false</span>
        }
        <span class="hljs-comment">// 更多验证规则...</span>
      })
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">formErrors</span>: errors })
      <span class="hljs-keyword">return</span> isValid
    }
  }
})
</code></pre>
<h2 data-id="heading-7">4. <strong>高阶组件模式</strong></h2>
<h3 data-id="heading-8">创建高阶组件工厂</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// utils/with-auth.js</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">withAuth</span>(<span class="hljs-params">Component</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-keyword">const</span> originalOnLoad = options.<span class="hljs-property">methods</span>.<span class="hljs-property">onLoad</span> || <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {}
    
    options.<span class="hljs-property">methods</span>.<span class="hljs-property">onLoad</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">params</span>) {
      <span class="hljs-comment">// 检查登录状态</span>
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkAuth</span>()) {
        wx.<span class="hljs-title function_">redirectTo</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/login/login'</span> })
        <span class="hljs-keyword">return</span>
      }
      
      originalOnLoad.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, params)
    }
    
    <span class="hljs-comment">// 添加登录检查方法</span>
    options.<span class="hljs-property">methods</span>.<span class="hljs-property">checkAuth</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> token = wx.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'token'</span>)
      <span class="hljs-keyword">return</span> !!token
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Component</span>(options)
  }
}
</code></pre>
<h3 data-id="heading-9">使用高阶组件</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// pages/user/user.js</span>
<span class="hljs-keyword">import</span> withAuth <span class="hljs-keyword">from</span> <span class="hljs-string">'../../utils/with-auth'</span>

<span class="hljs-keyword">const</span> originalOptions = {
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">userInfo</span>: {} },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadUserInfo</span>()
    },
    <span class="hljs-title function_">loadUserInfo</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// 加载用户信息</span>
    }
  }
}

<span class="hljs-comment">// 包装原始配置</span>
<span class="hljs-title function_">withAuth</span>(<span class="hljs-title class_">Component</span>)(originalOptions)
</code></pre>
<h2 data-id="heading-10">5. <strong>工具函数复用</strong></h2>
<h3 data-id="heading-11">按功能分类的工具函数</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// utils/date-util.js</span>
<span class="hljs-comment">// 日期格式化</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">formatDate</span>(<span class="hljs-params">date, format = <span class="hljs-string">'YYYY-MM-DD'</span></span>) {
  <span class="hljs-keyword">if</span> (!date) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
  <span class="hljs-keyword">const</span> d = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(date)
  <span class="hljs-keyword">const</span> year = d.<span class="hljs-title function_">getFullYear</span>()
  <span class="hljs-keyword">const</span> month = <span class="hljs-title class_">String</span>(d.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
  <span class="hljs-keyword">const</span> day = <span class="hljs-title class_">String</span>(d.<span class="hljs-title function_">getDate</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
  
  <span class="hljs-keyword">return</span> format
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'YYYY'</span>, year)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'MM'</span>, month)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'DD'</span>, day)
}

<span class="hljs-comment">// 相对时间</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">relativeTime</span>(<span class="hljs-params">date</span>) {
  <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
  <span class="hljs-keyword">const</span> target = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(date)
  <span class="hljs-keyword">const</span> diff = now - target
  
  <span class="hljs-keyword">const</span> minutes = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(diff / <span class="hljs-number">60000</span>)
  <span class="hljs-keyword">if</span> (minutes &lt; <span class="hljs-number">60</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${minutes}</span>分钟前`</span>
  
  <span class="hljs-keyword">const</span> hours = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(minutes / <span class="hljs-number">60</span>)
  <span class="hljs-keyword">if</span> (hours &lt; <span class="hljs-number">24</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${hours}</span>小时前`</span>
  
  <span class="hljs-keyword">const</span> days = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(hours / <span class="hljs-number">24</span>)
  <span class="hljs-keyword">if</span> (days &lt; <span class="hljs-number">30</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${days}</span>天前`</span>
  
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatDate</span>(date)
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// utils/request-util.js</span>
<span class="hljs-comment">// 统一的网络请求</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">options</span>) {
  <span class="hljs-keyword">const</span> token = wx.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'token'</span>)
  <span class="hljs-keyword">const</span> header = {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
    ...options.<span class="hljs-property">header</span>
  }
  
  <span class="hljs-keyword">if</span> (token) {
    header[<span class="hljs-string">'Authorization'</span>] = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>
  }
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    wx.<span class="hljs-title function_">request</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">`https://api.example.com<span class="hljs-subst">${options.url}</span>`</span>,
      <span class="hljs-attr">method</span>: options.<span class="hljs-property">method</span> || <span class="hljs-string">'GET'</span>,
      <span class="hljs-attr">data</span>: options.<span class="hljs-property">data</span>,
      header,
      <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (result.<span class="hljs-property">statusCode</span> === <span class="hljs-number">200</span>) {
          <span class="hljs-title function_">resolve</span>(result.<span class="hljs-property">data</span>)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">reject</span>(result.<span class="hljs-property">data</span>)
        }
      },
      <span class="hljs-attr">fail</span>: reject
    })
  })
}
</code></pre>
<h2 data-id="heading-12">6. <strong>组合式复用</strong></h2>
<h3 data-id="heading-13">复杂组件的组合</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// components/smart-form/smart-form.js</span>
<span class="hljs-keyword">const</span> formBehavior = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../../behaviors/form-behavior'</span>)
<span class="hljs-keyword">const</span> validationBehavior = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../../behaviors/validation-behavior'</span>)

<span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">behaviors</span>: [formBehavior, validationBehavior],
  
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-comment">// 继承自formBehavior的onFormChange</span>
    <span class="hljs-comment">// 继承自validationBehavior的validateForm</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">onSubmit</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateForm</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">rules</span>)) {
        <span class="hljs-keyword">return</span>
      }
      
      <span class="hljs-comment">// 提交表单</span>
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">submitData</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">formData</span>)
      
      <span class="hljs-keyword">if</span> (result.<span class="hljs-property">success</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">'success'</span>, result.<span class="hljs-property">data</span>)
      }
    }
  }
})
</code></pre>
<h2 data-id="heading-14">7. <strong>模板复用</strong></h2>
<h3 data-id="heading-15">WXML模板</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- templates/empty-state.wxml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"emptyState"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"empty-container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"{{icon}}"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"empty-icon"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"empty-text"</span>&gt;</span>{{text}}<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">"{{showButton}}"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"onButtonTap"</span>&gt;</span>
      {{buttonText}}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"loading"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"loading-container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/loading.gif"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"loading-icon"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">text</span>&gt;</span>{{text || '加载中...'}}<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h3 data-id="heading-16">使用模板</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- 页面.wxml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/templates/empty-state.wxml"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/templates/loading.wxml"</span> /&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">"{{isLoading}}"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">is</span>=<span class="hljs-string">"loading"</span> <span class="hljs-attr">data</span>=<span class="hljs-string">"{{text: '拼命加载中...'}}"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:elif</span>=<span class="hljs-string">"{{isEmpty}}"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> 
    <span class="hljs-attr">is</span>=<span class="hljs-string">"emptyState"</span> 
    <span class="hljs-attr">data</span>=<span class="hljs-string">"{{{
      icon: '/images/empty.png',
      text: '暂无数据',
      showButton: true,
      buttonText: '刷新试试'
    }}}"</span> 
  /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
<h2 data-id="heading-17">8. <strong>样式复用策略</strong></h2>
<h3 data-id="heading-18">创建样式变量</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* styles/variables.wxss */</span>
<span class="hljs-selector-pseudo">:root</span> {
  <span class="hljs-attr">--primary-color</span>: <span class="hljs-number">#07c160</span>;
  <span class="hljs-attr">--danger-color</span>: <span class="hljs-number">#fa5151</span>;
  <span class="hljs-attr">--text-color</span>: <span class="hljs-number">#333</span>;
  <span class="hljs-attr">--border-color</span>: <span class="hljs-number">#eee</span>;
  <span class="hljs-attr">--font-size-sm</span>: <span class="hljs-number">24</span>rpx;
  <span class="hljs-attr">--font-size-md</span>: <span class="hljs-number">28</span>rpx;
  <span class="hljs-attr">--font-size-lg</span>: <span class="hljs-number">32</span>rpx;
  <span class="hljs-attr">--border-radius</span>: <span class="hljs-number">8</span>rpx;
}
</code></pre>
<h3 data-id="heading-19">复用样式类</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* styles/common.wxss */</span>
<span class="hljs-selector-class">.flex-center</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
}

<span class="hljs-selector-class">.text-ellipsis</span> {
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">text-overflow</span>: ellipsis;
  <span class="hljs-attribute">white-space</span>: nowrap;
}

<span class="hljs-selector-class">.hairline</span> {
  <span class="hljs-attribute">position</span>: relative;
}
<span class="hljs-selector-class">.hairline</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">''</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1</span>rpx solid <span class="hljs-built_in">var</span>(--border-color);
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scaleY</span>(<span class="hljs-number">0.5</span>);
}
</code></pre>
<h3 data-id="heading-20">在页面中引入</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* 页面.wxss */</span>
<span class="hljs-keyword">@import</span> <span class="hljs-string">"/styles/variables.wxss"</span>;
<span class="hljs-keyword">@import</span> <span class="hljs-string">"/styles/common.wxss"</span>;

<span class="hljs-selector-class">.user-card</span> {
  composes: flex-center;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20</span>rpx;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-built_in">var</span>(--border-radius);
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
}
</code></pre>
<h2 data-id="heading-21">9. <strong>数据状态复用</strong></h2>
<h3 data-id="heading-22">创建全局状态管理器</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// store/user-store.js</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserStore</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_listeners</span> = []
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_userInfo</span> = <span class="hljs-literal">null</span>
  }
  
  <span class="hljs-comment">// 获取用户信息</span>
  <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_userInfo</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_userInfo</span> = wx.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userInfo'</span>)
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_userInfo</span>
  }
  
  <span class="hljs-comment">// 更新用户信息</span>
  <span class="hljs-title function_">setUserInfo</span>(<span class="hljs-params">userInfo</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_userInfo</span> = userInfo
    wx.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'userInfo'</span>, userInfo)
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_notifyListeners</span>()
  }
  
  <span class="hljs-comment">// 订阅变化</span>
  <span class="hljs-title function_">subscribe</span>(<span class="hljs-params">listener</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_listeners</span>.<span class="hljs-title function_">push</span>(listener)
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_listeners</span>.<span class="hljs-title function_">indexOf</span>(listener)
      <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">_listeners</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    }
  }
  
  <span class="hljs-title function_">_notifyListeners</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> <span class="hljs-title function_">listener</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_userInfo</span>))
  }
}

<span class="hljs-comment">// 导出单例</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserStore</span>()
</code></pre>
<h3 data-id="heading-23">在多个页面中使用</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// pages/profile/profile.js</span>
<span class="hljs-keyword">import</span> userStore <span class="hljs-keyword">from</span> <span class="hljs-string">'../../store/user-store'</span>

<span class="hljs-title class_">Page</span>({
  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 获取用户信息</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ 
      <span class="hljs-attr">userInfo</span>: userStore.<span class="hljs-title function_">getUserInfo</span>() 
    })
    
    <span class="hljs-comment">// 订阅更新</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">unsubscribe</span> = userStore.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">userInfo</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ userInfo })
    })
  },
  
  <span class="hljs-title function_">onUnload</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 取消订阅</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">unsubscribe</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">unsubscribe</span>()
  }
})
</code></pre>
<h2 data-id="heading-24">10. <strong>复用最佳实践</strong></h2>
<h3 data-id="heading-25">1. <strong>按职责分层</strong></h3>
<pre><code class="hljs language-bash" lang="bash">utils/
  ├── date-util.js        <span class="hljs-comment"># 日期处理</span>
  ├── request-util.js     <span class="hljs-comment"># 网络请求</span>
  ├── validate-util.js    <span class="hljs-comment"># 验证工具</span>
  └── storage-util.js     <span class="hljs-comment"># 存储工具</span>

behaviors/
  ├── form-behavior.js
  ├── loading-behavior.js
  └── auth-behavior.js

components/
  ├── common/            <span class="hljs-comment"># 通用组件</span>
  ├── business/          <span class="hljs-comment"># 业务组件</span>
  └── layout/            <span class="hljs-comment"># 布局组件</span>

mixins/                  <span class="hljs-comment"># 混合功能</span>
templates/               <span class="hljs-comment"># 模板文件</span>
styles/                  <span class="hljs-comment"># 样式文件</span>
</code></pre>
<h3 data-id="heading-26">2. <strong>创建配置中心</strong></h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// config/app-config.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// API配置</span>
  api: {
    baseURL: <span class="hljs-string">'https://api.example.com'</span>,
    timeout: <span class="hljs-number">10000</span>
  },
  
  <span class="hljs-comment">// 页面路径</span>
  pages: {
    login: <span class="hljs-string">'/pages/login/login'</span>,
    home: <span class="hljs-string">'/pages/home/home'</span>
  },
  
  <span class="hljs-comment">// 存储键名</span>
  storageKeys: {
    token: <span class="hljs-string">'user_token'</span>,
    userInfo: <span class="hljs-string">'user_info'</span>
  }
}
</code></pre>
<h3 data-id="heading-27">3. <strong>文档和示例</strong></h3>
<p>为每个复用组件创建示例页面：</p>
<pre><code class="hljs language-css" lang="css">components/common-<span class="hljs-selector-tag">button</span>/
  ├── common-<span class="hljs-selector-tag">button</span><span class="hljs-selector-class">.js</span>
  ├── common-<span class="hljs-selector-tag">button</span><span class="hljs-selector-class">.wxml</span>
  ├── common-<span class="hljs-selector-tag">button</span><span class="hljs-selector-class">.wxss</span>
  └── example/
      ├── example<span class="hljs-selector-class">.js</span>      # 使用示例
      └── example<span class="hljs-selector-class">.wxml</span>
</code></pre>
<h2 data-id="heading-28">复用带来的好处</h2>
<ol>
<li><strong>减少代码量</strong>：避免重复编写相同逻辑</li>
<li><strong>便于维护</strong>：修改只需在一处进行</li>
<li><strong>一致性</strong>：保证功能和行为统一</li>
<li><strong>团队协作</strong>：提供标准化的开发模式</li>
<li><strong>包体积优化</strong>：显著减少重复代码</li>
</ol>
<p>通过合理的代码复用，不仅能减小包体积，还能提升开发效率和代码质量。建议在项目初期就规划好复用策略，建立代码规范。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React Native 应用保护全链路实践 从 JS Bundle 到 IPA 层混淆的多维度安全方案]]></title>    <link>https://juejin.cn/post/7582152511538479145</link>    <guid>https://juejin.cn/post/7582152511538479145</guid>    <pubDate>2025-12-11T06:23:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582152511538479145" data-draft-id="7582163781183946758" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React Native 应用保护全链路实践 从 JS Bundle 到 IPA 层混淆的多维度安全方案"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-11T06:23:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bcbnb"/> <meta itemprop="url" content="https://juejin.cn/user/895474073078377"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React Native 应用保护全链路实践 从 JS Bundle 到 IPA 层混淆的多维度安全方案
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/895474073078377/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bcbnb
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:23:53.000Z" title="Thu Dec 11 2025 06:23:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>React Native（RN）给移动开发带来了极强的跨平台效率，但也带来了一个极其明显的安全短板：</p>
<blockquote>
<p><strong>绝大部分业务逻辑最终都以 JS Bundle 的形式明文存在于 IPA 中。</strong></p>
</blockquote>
<p>这意味着只要攻击者解压 IPA，就能直接看到：</p>
<ul>
<li>业务 JS 代码</li>
<li>常量、字符串、接口路径</li>
<li>配置 JSON</li>
<li>UI 定义</li>
<li>路由逻辑</li>
<li>Redux 状态信息</li>
<li>网络请求封装</li>
<li>加密逻辑实现细节</li>
</ul>
<p>RN 的 bundle 文件是研发效率的利器，但同样也成为攻击者极易利用的突破点。</p>
<p>因此，“React Native 应用保护”不能只停留在 JS 混淆，而要从 <strong>JS → 资源 → 原生层 → IPA 层</strong> 完成整套保护链路。</p>
<p>本文将从 RN 工程结构、逆向者的攻击路径，构建一套真正可工程化、可自动化的 RN 加固体系。</p>
<hr/>
<h2 data-id="heading-0">一、为什么 RN 的安全风险比原生更明显？</h2>
<p>RN 在打包后生成的 iOS 包结构中，通常会有如下文件：</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.jsbundle</span>
assets<span class="hljs-comment">/*.png
assets/*.json
index.bundle
runtime.js
</span></code></pre>
<p>这些文件的特点是：</p>
<h3 data-id="heading-1">全明文</h3>
<p>JS 与 JSON 都无需任何工具即可读取。</p>
<h3 data-id="heading-2">包含真实业务逻辑</h3>
<p>例如登录流程、订单逻辑、关键判断等。</p>
<h3 data-id="heading-3">可被替换</h3>
<p>攻击者可以修改 JS 后重新打包。</p>
<h3 data-id="heading-4">Hook 难度低</h3>
<p>RN 程序的业务逻辑位置非常固定，因此动态插桩更容易。</p>
<hr/>
<h2 data-id="heading-5">二、破解 RN 应用的攻击路径（逆向者视角）</h2>
<p>攻击者常见攻击链路如下：</p>
<hr/>
<h3 data-id="heading-6"><strong>① 解压 IPA，读取 JS Bundle</strong></h3>
<p>可直接获得逻辑结构。</p>
<hr/>
<h3 data-id="heading-7"><strong>② 分析 JS Bundle</strong></h3>
<p>攻击者会：</p>
<ul>
<li>搜索关键字</li>
<li>查找接口</li>
<li>跟踪路由</li>
<li>修改逻辑判断</li>
<li>清除风控</li>
<li>删除权限检查</li>
<li>甚至取消广告或订阅限制</li>
</ul>
<hr/>
<h3 data-id="heading-8"><strong>③ 替换资源并重打包</strong></h3>
<p>只需：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-built_in">zip</span> → 重签 → 安装
</code></pre>
<p>简单到令人发指。</p>
<hr/>
<h3 data-id="heading-9"><strong>④ 使用 Frida 等工具 Hook 原生层</strong></h3>
<p>如：</p>
<ul>
<li>拦截 NativeModules</li>
<li>修改网络请求</li>
<li>Hook RN Bridge</li>
<li>劫持 JS 调用链</li>
</ul>
<hr/>
<h2 data-id="heading-10">三、RN 应用保护必须覆盖四个层面</h2>
<ol>
<li><strong>JS Bundle 加固（可读性与结构保护）</strong></li>
<li><strong>资源与路径保护（防替换）</strong></li>
<li><strong>原生层符号混淆（防 Hook）</strong></li>
<li><strong>IPA 层结构扰动（整体防破解）</strong></li>
</ol>
<p>使用单一工具永远无法完成这套体系。</p>
<hr/>
<h2 data-id="heading-11">四、多工具组合：构建可落地的 RN 加固方案</h2>
<p>以下按层级来介绍对应工具的职责。</p>
<hr/>
<h2 data-id="heading-12">第一层：JS Bundle 混淆（前端安全基础层）</h2>
<p>常见工具：</p>
<ul>
<li>javascript-obfuscator</li>
<li>babel-plugin-minify</li>
<li>metro bundle 优化</li>
</ul>
<p>这些工具的作用包括：</p>
<ul>
<li>改变变量名</li>
<li>压缩 JS</li>
<li>减少代码可读性</li>
<li>防止快速定位敏感逻辑</li>
</ul>
<p><strong>但要注意：</strong>
即使混淆了 JS，攻击者仍能替换整个 bundle，因此这层不是终极防护。</p>
<hr/>
<h2 data-id="heading-13">第二层：IPA 层资源防篡改（真正防攻击的关键）</h2>
<p>这是 RN 项目最重要的保护层。</p>
<p><strong>Ipa Guard CLI 适用于这一层，能够保护 RN 的所有资源结构：</strong></p>
<ul>
<li>修改 main.jsbundle 名称</li>
<li>修改资源文件名</li>
<li>路径扰动，使 JS/资源引用不再可预测</li>
<li>修改文件 MD5，使替换无法通过校验</li>
<li>ISA 层符号混淆，保护 NativeModules</li>
<li>支持所有 Hybrid 场景</li>
<li>无需源码，可对任意 RN IPA 加固</li>
</ul>
<p>示例流程：</p>
<hr/>
<h2 data-id="heading-14">Step 1：从 IPA 中解析符号与资源依赖关系</h2>
<pre><code class="hljs language-bash" lang="bash">ipaguard_cli parse app.ipa -o sym.json
</code></pre>
<p>输出会包含：</p>
<ul>
<li>main.jsbundle 路径</li>
<li>assets 中所有资源文件</li>
<li>JS 引用关系</li>
<li>Swift/ObjC 符号</li>
</ul>
<p>非常适合用来制定保护策略。</p>
<hr/>
<h2 data-id="heading-15">Step 2：编辑保护策略（最重要的环节）</h2>
<ul>
<li>保留 RN Bridge 相关类（防止通信失败）</li>
<li>保护所有 jsbundle</li>
<li>修改所有 png/json 名称</li>
<li>开启文件 MD5 防替换</li>
<li>混淆原生层类与调用链（防 Frida Hook）</li>
<li>若应用带 H5，也可开启 JS 混淆</li>
</ul>
<hr/>
<h2 data-id="heading-16">Step 3：执行 IPA 加固操作</h2>
<pre><code class="hljs language-bash" lang="bash">ipaguard_cli protect app.ipa \
   -c sym.json \
   --js \
   --image \
   -o protected.ipa \
   --email dev@team.com
</code></pre>
<p>效果包括：</p>
<ul>
<li>main.jsbundle 改名，攻击者无法定位</li>
<li>json 资源无法替换</li>
<li>png 动态改名 + MD5 改变</li>
<li>原生层符号乱码化</li>
<li>JS 混淆进一步提高阅读难度</li>
<li>资源路径被打散，不再可预测</li>
</ul>
<p>攻击者即便找到 bundle，也无法直接替换文件使 App 正常运行。</p>
<hr/>
<h2 data-id="heading-17">第三层：原生层符号混淆（强烈建议）</h2>
<p>RN 与 NativeModules 深度绑定：</p>
<pre><code class="hljs">RCTBridge
RCTModule
NativeModules.LoginManager
NativeModules.DeviceInfo
</code></pre>
<p>这些原生层符号若不混淆，攻击者可轻松 Hook。</p>
<p>可使用：</p>
<ul>
<li>Ipa Guard CLI（无需源码）</li>
<li>Swift Shield（若项目有 Swift 部分）</li>
<li>Obfuscator-LLVM（源码级，成本高）</li>
</ul>
<p>IPA 层混淆是 RN 项目的最简单、最适配方案。</p>
<hr/>
<h2 data-id="heading-18">第四层：动态调试防护（运行时保护）</h2>
<p>常见对抗：</p>
<ul>
<li>Frida 检测</li>
<li>防双开</li>
<li>完整性校验</li>
<li>防止注入动态库</li>
<li>检测敏感调用链</li>
</ul>
<p>可使用内部代码实现，也可依赖 IPA 层扰动来增加 Hook 难度。</p>
<hr/>
<h2 data-id="heading-19">五、验证保护效果的工程流程</h2>
<p>保护完成后必须通过逆向工具验证：</p>

























<table><thead><tr><th>工具</th><th>用途</th></tr></thead><tbody><tr><td>Hopper</td><td>检查符号是否已混淆</td></tr><tr><td>Frida</td><td>测试是否还能 Hook NativeModules</td></tr><tr><td>文件替换实验</td><td>替换 bundle 或 json 是否仍可运行</td></tr><tr><td>MobSF</td><td>自动检查 ipa 暴露点</td></tr></tbody></table>
<p>若替换 bundle 后应用崩溃或无法加载，即保护成功。</p>
<hr/>
<h2 data-id="heading-20">六、React Native 应用加固的自动化 CI/CD 流程</h2>
<p>可直接落地：</p>
<hr/>
<h2 data-id="heading-21"><strong>① RN 构建生成 IPA（CI）</strong></h2>
<hr/>
<h2 data-id="heading-22"><strong>② 用 Ipa Guard CLI 分析 IPA</strong></h2>
<pre><code class="hljs">ipaguard_cli parse app.ipa -o sym.json
</code></pre>
<hr/>
<h2 data-id="heading-23"><strong>③ 自动生成混淆策略</strong></h2>
<ul>
<li>JS bundle 强保护</li>
<li>资产文件保护</li>
<li>保留 NativeModules 白名单</li>
<li>资源路径扰动</li>
</ul>
<hr/>
<h2 data-id="heading-24"><strong>④ 执行 IPA 层混淆</strong></h2>
<pre><code class="hljs language-css" lang="css">ipaguard_cli protect app<span class="hljs-selector-class">.ipa</span> -c sym<span class="hljs-selector-class">.json</span> <span class="hljs-attr">--js</span> <span class="hljs-attr">--image</span> -o encrypted<span class="hljs-selector-class">.ipa</span>
</code></pre>
<hr/>
<h2 data-id="heading-25"><strong>⑤ 重签名并安装测试</strong></h2>
<p>使用 kxsign：</p>
<pre><code class="hljs language-bash" lang="bash">kxsign sign encrypted.ipa -c cert.p12 -p <span class="hljs-built_in">pwd</span> -m dev.mobileprovision -z signed.ipa -i
</code></pre>
<hr/>
<h2 data-id="heading-26"><strong>⑥ 逆向对抗测试</strong></h2>
<ul>
<li>修改 bundle → 必须失败</li>
<li>Hopper 检查符号乱码</li>
<li>Frida Hook → 入口应难以定位</li>
</ul>
<hr/>
<h2 data-id="heading-27"><strong>⑦ 映射文件与配置治理</strong></h2>
<p>确保可回滚，可排查崩溃。</p>
<hr/>
<h2 data-id="heading-28">RN 保护必须从“资源 + 符号 + IPA 层”同时下手</h2>
<p>最终多工具组合方案如下：</p>
<h2 data-id="heading-29"><strong>JS 层保护</strong></h2>
<p>javascript-obfuscator
bundle 压缩混淆</p>
<h2 data-id="heading-30"><strong>IPA 资源层保护（核心）</strong></h2>
<p><strong>Ipa Guard CLI</strong></p>
<ul>
<li>保护 jsbundle</li>
<li>修改资源 MD5</li>
<li>扰动路径</li>
<li>混淆 Native 层符号</li>
</ul>
<h2 data-id="heading-31"><strong>原生层保护</strong></h2>
<p>Swift Shield（如使用 Swift）、Obfuscator-LLVM（源码级）</p>
<h2 data-id="heading-32"><strong>动态防护层</strong></h2>
<p>Anti-Frida、完整性校验</p>
<h2 data-id="heading-33"><strong>验证层</strong></h2>
<p>Hopper、Frida、MobSF、文件替换实验</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[基于 openFuyao 的 AI 推理加速实战：智能路由与 PD 分离式 KVCache 架构揭秘]]></title>    <link>https://juejin.cn/post/7582169248094797830</link>    <guid>https://juejin.cn/post/7582169248094797830</guid>    <pubDate>2025-12-11T06:25:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582169248094797830" data-draft-id="7582156219060109375" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="基于 openFuyao 的 AI 推理加速实战：智能路由与 PD 分离式 KVCache 架构揭秘"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2025-12-11T06:25:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="是Dream呀"/> <meta itemprop="url" content="https://juejin.cn/user/765678294413181"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            基于 openFuyao 的 AI 推理加速实战：智能路由与 PD 分离式 KVCache 架构揭秘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/765678294413181/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    是Dream呀
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:25:15.000Z" title="Thu Dec 11 2025 06:25:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"「"}.markdown-body b:after,.markdown-body strong:after{content:"」"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><h2 data-id="heading-0">一、背景：AI 推理的算力挑战</h2>
<p>随着大模型与多模态 AI 应用的快速落地，推理阶段的算力需求呈现爆炸式增长。传统推理系统在面对复杂算力调度、缓存失配、数据热点等问题时，往往存在<strong>资源利用率低、推理延迟高</strong>等瓶颈。</p>
<p>为此，openFuyao 社区推出了面向 AI 推理场景的<strong>算力释放创新组件</strong>，其中“<strong>智能路由</strong>”与“<strong>PD 分离式分布式 KVCache</strong>”架构成为关键突破。该方案在保持系统轻量化的同时，实现了推理性能的显著提升，助力开发者快速构建高效、稳定的推理服务。</p>
<p>openFuyao平台解决方案支持在如下操作系统与架构上进行安装与使用：</p>






























<table><thead><tr><th>操作系统</th><th>版本</th><th>架构</th></tr></thead><tbody><tr><td>openEuler</td><td>20.03</td><td>ARM64、x86_64</td></tr><tr><td>openEuler</td><td>22.03</td><td>ARM64、x86_64</td></tr><tr><td>openEuler</td><td>24.03</td><td>ARM64、x86_64</td></tr><tr><td>Ubuntu</td><td>22.04</td><td>ARM64、x86_64</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-1">二、技术亮点：智能路由与 PD 分离的协同加速</h2>
<h3 data-id="heading-2">1. 智能路由（Intelligent Routing）</h3>
<p>openFuyao 的智能路由组件通过实时监控节点算力使用情况（CPU、GPU/NPU、内存、带宽等），自动为每次推理请求选择最优节点。<br/>
该机制有效避免了节点负载不均、热点集群拥塞等问题，实现了<strong>推理任务在多节点间的动态最优分配</strong>。</p>
<p>其核心机制包括：</p>
<ul>
<li><strong>实时节点特征采集与健康度评估</strong></li>
<li><strong>基于权重的动态节点调度算法</strong></li>
<li><strong>多级容灾与优先级控制</strong></li>
</ul>
<blockquote>
<p>智能路由的目标是让推理请求“走最优路径”，最大限度减少等待和网络开销。</p>
</blockquote>
<h3 data-id="heading-3">2. PD 分离分布式 KVCache（Parameter-Data Separation）</h3>
<p>传统推理场景下，KVCache（键值缓存）往往与推理引擎绑定部署，易导致数据耦合、缓存命中率低。<br/>
openFuyao 采用了 <strong>PD（Parameter/Data）分离架构</strong>，将参数存储与数据存储解耦，通过统一的分布式 KVCache 提供高性能缓存访问。</p>
<p>该机制带来了三大优势：</p>
<ul>
<li><strong>高命中率</strong>：同模型多实例共享缓存，显著减少重复加载。</li>
<li><strong>可扩展性</strong>：缓存节点可独立扩缩容，适配不同推理负载。</li>
<li><strong>一致性保障</strong>：分布式同步机制确保多节点读取一致。</li>
</ul>
<p><strong>PD分离模式AI推理集成部署图</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f24183ba8c334591931e5e54ed8a0fe7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039115&amp;x-signature=xJ%2F%2BralPELc8okx4aV4kciOAygQ%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>hermes-router</strong>：智能路由模块。负责接收用户请求并根据路由策略转发到最优的推理后端服务。</li>
<li><strong>cache-indexer</strong>：KV Cache全局管理器，为路由决策提供数据支持。</li>
<li><strong>Inference Backend</strong>：推理后端模块，基于vLLM提供高性能大模型推理服务，由1个Proxy Server Service，1个Proxy Server实例，n个vLLM Prefill推理引擎实例和n个vLLM Decode推理引擎实例组成。</li>
<li><strong>Proxy Server Service</strong>：推理后端服务的流量入口。</li>
<li><strong>Proxy Server</strong>：二层路由转发组件。负责每个推理后端服务内的负载均衡路由。</li>
<li><strong>vLLM</strong>：vLLM推理引擎实例。</li>
<li><strong>Mooncake Connector</strong>：负责PD实例之间的KV Cache P2P高速传输。</li>
</ul>
<hr/>
<h2 data-id="heading-4">三、部署实战：一分钟启动高性能推理服务</h2>
<p>借助 openFuyao 的“算力释放创新组件”，开发者可快速构建一套分布式推理环境。以下为简化示例流程：</p>
<p><strong>准备部署文件</strong></p>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f inference-deployment.yaml
</code></pre>
<p><strong>查看推理 Pod 状态</strong></p>
<pre><code class="hljs language-bash" lang="bash">kubectl get pods -n openfuyao
<span class="hljs-comment"># 输出：</span>
<span class="hljs-comment"># inference-pod-1   Running</span>
<span class="hljs-comment"># inference-pod-2   Running</span>
</code></pre>
<p><strong>通过 openFuyao 控制台查看任务运行状态</strong><br/>
新建监控组件。可在 Dashboard 页面直观查看推理服务负载、节点利用率及任务分布情况。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6093dd43dc34f978947ea17918b93f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039115&amp;x-signature=FYyngbWBP81vNny7JvN0neLdV3k%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-5">四、性能对比：延迟下降，算力利用率提升</h2>
<p>在实际测试中，使用智能路由 + PD 分离式 KVCache 后，openFuyao 推理集群的性能提升显著。</p>





























<table><thead><tr><th>指标</th><th>优化前</th><th>优化后</th><th>提升比例</th></tr></thead><tbody><tr><td>平均推理延迟(ms)</td><td>120</td><td>85</td><td>↓ 29.1%</td></tr><tr><td>吞吐量(QPS)</td><td>200</td><td>320</td><td>↑ 60%</td></tr><tr><td>GPU 利用率</td><td>65%</td><td>91%</td><td>↑ 26%</td></tr></tbody></table>
<blockquote>
<p>实验环境：4×NVIDIA A100，openFuyao 24.09 集群版本，模型为 7B Qwen 推理场景。</p>
</blockquote>
<p><strong>性能对比图</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b98df063529e44fbaaed59e37f221cf9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039115&amp;x-signature=59mQQslA0%2B9BLMw1C%2FglT6HJuQk%3D" alt="" loading="lazy"/></p>
<p>通过对比可见，openFuyao 在引入智能路由与 PD 分离式 KVCache 架构后，整体推理吞吐量（QPS）获得显著提升。随着模型规模的扩大，优化效果愈发明显。例如，在 Qwen-14B 模型上，系统吞吐量由 50 QPS 提升至 110 QPS，增幅超过 100%。这主要得益于智能路由机制对计算节点的动态负载分配，以及 PD 分离架构下 KVCache 的分布式高效访问，从而显著提高了算力资源利用率与推理并发性能。</p>
<p>性能提升主要来源于：</p>
<ul>
<li><strong>智能路由降低请求调度延迟</strong>；</li>
<li><strong>PD 分离式 KVCache 提升缓存复用率</strong>；</li>
<li><strong>集群负载自动均衡</strong>，减少节点空转。</li>
</ul>
<p><strong>延迟对比图</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19030935f70543efb2dfe71d5157fbf3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039115&amp;x-signature=wzxcNGMhUhTNJXlk3GRUrBZphhQ%3D" alt="" loading="lazy"/></p>
<p>由上图可见，经过 PD 分离与智能路由的优化后，openFuyao 在多规模 Qwen 模型上的推理延迟显著下降。例如，在 Qwen-14B 模型上，平均延迟由 130ms 降至 88ms，整体性能提升约 32%。这得益于系统在路由调度与 KVCache 分布式访问策略上的协同优化。</p>
<hr/>
<h2 data-id="heading-6">五、结果验证：推理服务高效稳定运行</h2>
<p>通过 openFuyao CLI 或 RESTful API 发起推理请求：</p>
<pre><code class="hljs language-bash" lang="bash">curl http://127.0.0.1:8080/infer -d <span class="hljs-string">'{"input":"你好，世界"}'</span>
<span class="hljs-comment"># 输出：</span>
<span class="hljs-comment"># {"result":"Hello, world!", "latency":84.3}</span>
</code></pre>
<p>在日志中可看到：</p>
<pre><code class="hljs language-bash" lang="bash">[INFO] Intelligent routing selected node: gpu-node-3
[INFO] KVCache hit rate: 92.7%
[INFO] Inference completed <span class="hljs-keyword">in</span> 84.3 ms
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34a93659114841148c15f8fb283668cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039115&amp;x-signature=ZH3WCJtlXIRWqIo910VAqGMFNGE%3D" alt="" loading="lazy"/></p>
<p>这验证了 openFuyao 推理加速组件的有效性：<br/>
推理延迟显著降低，缓存命中率持续维持在 90% 以上，集群调度稳定可靠。</p>
<hr/>
<h2 data-id="heading-7">六、总结与展望</h2>
<p>总的来说，openFuyao 社区通过“智能路由 + PD 分离式 KVCache”架构，构建了一个<strong>高效、弹性、智能</strong>的 AI 推理加速方案。<br/>
该方案不仅显著提升了算力利用率与推理性能，还为开发者提供了<strong>即插即用的轻量化部署体验</strong>。</p>
<p>期待未来，openFuyao 继续完善 AI 推理生态，与更多硬件厂商、AI 框架、模型社区协同合作，为开发者带来更开放、更智能的算力释放平台。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9fa5070c827a4d17838c1301fba7bb07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pivRHJlYW3lkYA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039115&amp;x-signature=uXlLZQQ9sFqxVZzDPnqrjrxbxpQ%3D" alt="" loading="lazy"/></p>
<p>📎 <strong>参考链接</strong></p>
<ul>
<li>openFuyao 官网：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.openfuyao.cn%2Fzh%2F" target="_blank" title="https://www.openfuyao.cn/zh/" ref="nofollow noopener noreferrer">www.openfuyao.cn/zh/</a></li>
<li>官方文档中心：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openfuyao.cn%2Fdocs%2F%25E5%25BF%25AB%25E9%2580%259F%25E5%2585%25A5%25E9%2597%25A8%2F" target="_blank" title="https://docs.openfuyao.cn/docs/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" ref="nofollow noopener noreferrer">docs.openfuyao.cn/docs/快速入门/</a></li>
<li>部分图片来源：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openfuyao.cn%2Fdocs%2F%25E5%258F%2591%25E8%25A1%258C%25E8%25AF%25B4%25E6%2598%258E%2F%25E7%25AE%2580%25E4%25BB%258B" target="_blank" title="https://docs.openfuyao.cn/docs/%E5%8F%91%E8%A1%8C%E8%AF%B4%E6%98%8E/%E7%AE%80%E4%BB%8B" ref="nofollow noopener noreferrer">简介 | openFuyao文档</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Tailwind CSS 入门介绍]]></title>    <link>https://juejin.cn/post/7582246395986395170</link>    <guid>https://juejin.cn/post/7582246395986395170</guid>    <pubDate>2025-12-11T06:35:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582246395986395170" data-draft-id="7582096212663812096" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Tailwind CSS 入门介绍"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-11T06:35:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="三年三月"/> <meta itemprop="url" content="https://juejin.cn/user/694547078186440"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Tailwind CSS 入门介绍
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547078186440/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    三年三月
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:35:00.000Z" title="Thu Dec 11 2025 06:35:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">Tailwind CSS 入门介绍</h2>
<h3 data-id="heading-1">1. Tailwind 是什么</h3>
<p>Tailwind CSS 是一个基于原子化 CSS（Atomic CSS）思想的实用优先（Utility-First）CSS 框架。与传统的 CSS 框架不同，Tailwind 不提供预定义的组件（如按钮、卡片等），而是提供了一系列底层的实用工具类（Utility Classes），让开发者可以直接在 HTML 中快速构建自定义界面。</p>
<h4 data-id="heading-2">与传统 CSS 的对比</h4>
<h5 data-id="heading-3">传统 CSS 方式</h5>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- HTML --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-primary"</span>&gt;</span>提交<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

<span class="hljs-comment">&lt;!-- CSS --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.btn-primary</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#3b82f6</span>;
  <span class="hljs-attribute">color</span>: white;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0.5rem</span> <span class="hljs-number">1rem</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0.25rem</span>;
  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
  <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.2s</span>;
}

<span class="hljs-selector-class">.btn-primary</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#2563eb</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h5 data-id="heading-4">Tailwind CSS 方式</h5>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bg-blue-500 text-white py-2 px-4 rounded font-semibold hover:bg-blue-600 transition-colors"</span>&gt;</span>
  提交
<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre>
<h5 data-id="heading-5">项目中的实际示例</h5>
<p>在项目的 <code>src/App.js</code> 文件中，可以看到 Tailwind 的实际使用：</p>
<pre><code class="hljs language-jsx" lang="jsx">div className=<span class="hljs-string">'text-base p-1 text-[14px] hover:text-[32px] border border-black border-solid'</span>&gt;test&lt;/div&gt;
</code></pre>
<h3 data-id="heading-6">2. Tailwind 官方地址</h3>
<ul>
<li>官方英文文档：<a href="https://link.juejin.cn?target=https%3A%2F%2Ftailwindcss.com%2F" target="_blank" title="https://tailwindcss.com/" ref="nofollow noopener noreferrer">tailwindcss.com/</a></li>
<li>官方中文文档：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.tailwindcss.cn%2F" target="_blank" title="https://www.tailwindcss.cn/" ref="nofollow noopener noreferrer">www.tailwindcss.cn/</a></li>
</ul>
<h3 data-id="heading-7">3. Tailwind 的优势</h3>
<h4 data-id="heading-8">3.1 快速开发</h4>
<p>使用预定义的工具类可以快速构建界面，无需频繁切换 HTML 和 CSS 文件。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// 快速创建一个响应式卡片</span>
&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"bg-white rounded-lg shadow-md p-6 md:p-8"</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-xl font-bold mb-2"</span>&gt;</span>卡片标题<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-gray-600"</span>&gt;</span>卡片内容<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
&lt;/div&gt;
</code></pre>
<h4 data-id="heading-9">3.2 高度可定制</h4>
<p>通过 <code>tailwind.config.js</code> 可以轻松定制主题、颜色、间距等。</p>
<p>项目中的 <code>tailwind.config.js</code> 示例：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// prefix: 'yuan-', // 可以添加自定义前缀</span>
  <span class="hljs-attr">content</span>: [
    <span class="hljs-string">"./src/**/*.{js,jsx}"</span>,
  ],
  <span class="hljs-attr">theme</span>: {
    <span class="hljs-attr">extend</span>: {
      <span class="hljs-attr">padding</span>: {
        <span class="hljs-string">'1'</span> : <span class="hljs-string">'30px'</span>
      },
      <span class="hljs-comment">// 可以扩展主题配置</span>
    },
    <span class="hljs-attr">screens</span>: {
      <span class="hljs-string">'md'</span>: <span class="hljs-string">'300px'</span> <span class="hljs-comment">// 自定义断点</span>
    }
  },
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-built_in">require</span>(<span class="hljs-string">'./yuan.plugin'</span>) <span class="hljs-comment">// 引入自定义插件</span>
  ],
}
</code></pre>
<h4 data-id="heading-10">3.3 响应式设计简单</h4>
<p>使用 <code>sm:</code>, <code>md:</code>, <code>lg:</code>, <code>xl:</code> 等前缀可以轻松实现响应式设计。</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"w-full md:w-1/2 lg:w-1/3"</span>&gt;
  &lt;!-- 移动端占满宽，平板占一半，桌面占三分之一 --&gt;
&lt;/div&gt;
</code></pre>
<h4 data-id="heading-11">3.4 减少 CSS 文件体积</h4>
<p>Tailwind 会自动移除未使用的样式，最终生成的 CSS 文件体积很小。</p>
<h4 data-id="heading-12">3.5 自定义插件支持</h4>
<p>可以通过插件扩展 Tailwind 的功能。</p>
<p>项目中的自定义插件 <code>yuan.plugin.js</code> 示例：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> plugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tailwindcss/plugin'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">plugin</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">{ addUtilities }</span>) {
    <span class="hljs-title function_">addUtilities</span>({
        <span class="hljs-string">'.aaa'</span>: {
            <span class="hljs-attr">background</span>: <span class="hljs-string">'blue'</span>,
            <span class="hljs-attr">color</span>: <span class="hljs-string">'yellow'</span>
        },
        <span class="hljs-string">'.bbb'</span>: {
            <span class="hljs-string">'font-size'</span>: <span class="hljs-string">'70px'</span>
        }
    })
})
</code></pre>
<h3 data-id="heading-13">4. Tailwind 的缺点</h3>
<h4 data-id="heading-14">4.1 学习曲线</h4>
<p>需要记忆大量的工具类名称，初期学习成本较高。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// 类名较长，需要记忆</span>
&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"flex items-center justify-between p-4 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow"</span>&gt;
  &lt;!-- 内容 --&gt;
&lt;/div&gt;
</code></pre>
<h4 data-id="heading-15">4.2 HTML 代码冗长</h4>
<p>过多的类名会导致 HTML 代码变得冗长，影响可读性。</p>
<p>项目中的示例：</p>
<pre><code class="hljs language-jsx" lang="jsx">div className=<span class="hljs-string">'text-base p-1 text-[14px] hover:text-[32px] border border-black border-solid'</span>&gt;yuan&lt;/div&gt;
</code></pre>
<h4 data-id="heading-16">4.3 调试困难</h4>
<p>在浏览器开发者工具中查看元素样式时，会看到很多 Tailwind 类名，不如传统 CSS 类名直观。</p>
<h4 data-id="heading-17">4.4 过度依赖工具类</h4>
<p>可能会导致开发者过度依赖工具类，而忽略了 CSS 的基本原理。</p>
<h3 data-id="heading-18">5. Tailwind 的功能模块及 API 介绍</h3>
<h4 data-id="heading-19">5.1 核心指令</h4>
<p>在项目的 <code>src/App.css</code> 中可以看到这三个核心指令：</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@tailwind</span> base;
<span class="hljs-keyword">@tailwind</span> components;
<span class="hljs-keyword">@tailwind</span> utilities;
</code></pre>
<ul>
<li><code>@tailwind base</code>：引入基础样式，包括浏览器重置样式（Preflight）和一些基础元素样式</li>
<li><code>@tailwind components</code>：引入组件样式，用于定义可复用的组件类</li>
<li><code>@tailwind utilities</code>：引入核心的工具类</li>
</ul>
<h4 data-id="heading-20">5.2 布局类</h4>
<h5 data-id="heading-21">容器与边框</h5>
<ul>
<li><code>container</code>：创建响应式容器</li>
<li><code>border</code>：添加边框</li>
<li><code>rounded</code>：添加圆角</li>
<li><code>shadow</code>：添加阴影</li>
</ul>
<p>示例：</p>
<pre><code class="hljs language-jsx" lang="jsx">div className=<span class="hljs-string">'border border-black border-solid'</span>&gt;yuan&lt;/div&gt;
</code></pre>
<h5 data-id="heading-22">弹性布局与网格布局</h5>
<ul>
<li><code>flex</code>：启用弹性布局</li>
<li><code>grid</code>：启用网格布局</li>
<li><code>flex-col</code>：设置弹性方向为垂直</li>
<li><code>items-center</code>：垂直居中对齐</li>
<li><code>justify-between</code>：两端对齐</li>
</ul>
<p>示例：</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"flex items-center justify-between"</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>左侧内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>右侧内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/div&gt;
</code></pre>
<h4 data-id="heading-23">5.3 间距类</h4>
<ul>
<li><code>p-{size}</code>：内边距</li>
<li><code>m-{size}</code>：外边距</li>
<li><code>px-{size}</code>：水平内边距</li>
<li><code>py-{size}</code>：垂直内边距</li>
</ul>
<p>项目中可以通过配置自定义间距：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">theme</span>: {
  <span class="hljs-attr">extend</span>: {
    <span class="hljs-attr">padding</span>: {
      <span class="hljs-string">'1'</span> : <span class="hljs-string">'30px'</span> <span class="hljs-comment">// 自定义 p-1 为 30px</span>
    }
  }
}
</code></pre>
<h4 data-id="heading-24">5.4 排版类</h4>
<ul>
<li><code>text-{size}</code>：字体大小</li>
<li><code>font-{weight}</code>：字重</li>
<li><code>text-{color}</code>：文字颜色</li>
<li><code>text-center</code>：文字居中</li>
</ul>
<p>项目中可以自定义字体大小：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">theme</span>: {
  <span class="hljs-attr">extend</span>: {
    <span class="hljs-attr">fontSize</span>: {
      <span class="hljs-string">'base'</span>: [<span class="hljs-string">'30px'</span>, <span class="hljs-string">'2rem'</span>] <span class="hljs-comment">// 自定义 base 字体大小</span>
    }
  }
}
</code></pre>
<h4 data-id="heading-25">5.5 颜色类</h4>
<ul>
<li><code>bg-{color}</code>：背景颜色</li>
<li><code>text-{color}</code>：文字颜色</li>
<li><code>border-{color}</code>：边框颜色</li>
</ul>
<p>示例：</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"bg-blue-500 text-white border border-red-500"</span>&gt;
  蓝底白字红边框
&lt;/div&gt;
</code></pre>
<h4 data-id="heading-26">5.6 响应式类</h4>
<ul>
<li><code>sm:</code>：小屏幕（默认 640px）</li>
<li><code>md:</code>：中等屏幕（默认 768px，项目中自定义为 300px）</li>
<li><code>lg:</code>：大屏幕（默认 1024px）</li>
<li><code>xl:</code>：超大屏幕（默认 1280px）</li>
</ul>
<p>项目中自定义断点：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">theme</span>: {
  <span class="hljs-attr">screens</span>: {
    <span class="hljs-string">'md'</span>: <span class="hljs-string">'300px'</span> <span class="hljs-comment">// 自定义 md 断点为 300px</span>
  }
}

### <span class="hljs-number">5.7</span> 状态类

- <span class="hljs-string">`hover:`</span>：鼠标悬停状态
- <span class="hljs-string">`focus:`</span>：获取焦点状态
- <span class="hljs-string">`active:`</span>：激活状态

示例：
<span class="hljs-string">``</span><span class="hljs-string">`jsx
div className='text-[14px] hover:text-[32px]'&gt;yuan&lt;/div&gt;
</span></code></pre>
<h4 data-id="heading-27">5.8 任意值（Arbitrary Values）</h4>
<p>Tailwind v3 引入的特性，允许使用自定义值：</p>
<pre><code class="hljs language-jsx" lang="jsx">div className=<span class="hljs-string">'text-[14px] w-[200px] h-[100px]'</span>&gt;yuan&lt;/div&gt;
</code></pre>
<h3 data-id="heading-28">6. Tailwind 如何集成到 Vue3 和 React 中</h3>
<h4 data-id="heading-29">6.1 集成到 React 项目</h4>
<h5 data-id="heading-30">步骤 1：创建 React 项目</h5>
<pre><code class="hljs language-bash" lang="bash">npx create-react-app tailwind-react-app
<span class="hljs-built_in">cd</span> tailwind-react-app
</code></pre>
<h5 data-id="heading-31">步骤 2：安装 Tailwind CSS</h5>
<pre><code class="hljs language-bash" lang="bash">npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
</code></pre>
<h5 data-id="heading-32">步骤 3：配置 Tailwind</h5>
<p>在 <code>tailwind.config.js</code> 中配置内容路径：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">content</span>: [
    <span class="hljs-string">"./src/**/*.{js,jsx,ts,tsx}"</span>,
  ],
  <span class="hljs-attr">theme</span>: {
    <span class="hljs-attr">extend</span>: {},
  },
  <span class="hljs-attr">plugins</span>: [],
}
</code></pre>
<h5 data-id="heading-33">步骤 4：添加 Tailwind 指令</h5>
<p>在 <code>src/index.css</code> 中添加：</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@tailwind</span> base;
<span class="hljs-keyword">@tailwind</span> components;
<span class="hljs-keyword">@tailwind</span> utilities;
</code></pre>
<h5 data-id="heading-34">步骤 5：使用 Tailwind</h5>
<p>在组件中使用 Tailwind 类：</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"container mx-auto p-4"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-3xl font-bold text-center mb-4"</span>&gt;</span>
        Tailwind React App
      <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600"</span>&gt;</span>
        点击我
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<h4 data-id="heading-35">6.2 集成到 Vue3 项目</h4>
<h5 data-id="heading-36">步骤 1：创建 Vue3 项目</h5>
<pre><code class="hljs language-bash" lang="bash">npm create vite@latest tailwind-vue-app -- --template vue
<span class="hljs-built_in">cd</span> tailwind-vue-app
</code></pre>
<h5 data-id="heading-37">步骤 2：安装 Tailwind CSS</h5>
<pre><code class="hljs language-bash" lang="bash">npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
</code></pre>
<h5 data-id="heading-38">步骤 3：配置 Tailwind</h5>
<p>在 <code>tailwind.config.js</code> 中配置内容路径：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">content</span>: [
    <span class="hljs-string">"./index.html"</span>,
    <span class="hljs-string">"./src/**/*.{vue,js,ts,jsx,tsx}"</span>,
  ],
  <span class="hljs-attr">theme</span>: {
    <span class="hljs-attr">extend</span>: {},
  },
  <span class="hljs-attr">plugins</span>: [],
}
</code></pre>
<h5 data-id="heading-39">步骤 4：添加 Tailwind 指令</h5>
<p>在 <code>src/index.css</code> 中添加：</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@tailwind</span> base;
<span class="hljs-keyword">@tailwind</span> components;
<span class="hljs-keyword">@tailwind</span> utilities;
</code></pre>
<h5 data-id="heading-40">步骤 5：使用 Tailwind</h5>
<p>在组件中使用 Tailwind 类：</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="container mx-auto p-4"&gt;
    &lt;h1 class="text-3xl font-bold text-center mb-4"&gt;
      Tailwind Vue3 App
    &lt;/h1&gt;
    &lt;button class="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600"&gt;
      点击我
    &lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
// 组件逻辑
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-41">总结</h3>
<p>Tailwind CSS 是一个革命性的 CSS 框架，通过实用优先的方法改变了前端开发的方式。它提供了极高的灵活性和开发效率，但也带来了一定的学习成本和代码可读性挑战。通过本文的介绍，希望你能对 Tailwind CSS 有一个全面的了解，并能够在项目中灵活运用它来构建现代化的用户界面。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C# 实现 XML 转 Excel：从解析到生成 XLSX 的详细步骤]]></title>    <link>https://juejin.cn/post/7582156219060191295</link>    <guid>https://juejin.cn/post/7582156219060191295</guid>    <pubDate>2025-12-11T06:34:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156219060191295" data-draft-id="7582169248094896134" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C# 实现 XML 转 Excel：从解析到生成 XLSX 的详细步骤"/> <meta itemprop="keywords" content="后端,C#"/> <meta itemprop="datePublished" content="2025-12-11T06:34:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="用户835629078051"/> <meta itemprop="url" content="https://juejin.cn/user/3150554985403516"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C# 实现 XML 转 Excel：从解析到生成 XLSX 的详细步骤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3150554985403516/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    用户835629078051
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:34:14.000Z" title="Thu Dec 11 2025 06:34:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a53e416094024275b667edc2c7034aee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODM1NjI5MDc4MDUx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039653&amp;x-signature=M3hnXgBfnexLBRvyS50yy8L9sDo%3D" alt="使用C#写入XML数据到Excel文件" loading="lazy"/></p>
<p>在现代企业级应用中，数据处理与报表生成是核心环节。我们经常需要将各种格式的数据，尤其是半结构化的XML数据，转换成易于阅读和分析的结构化报表，例如Excel文件。手动进行这种转换不仅效率低下，而且容易出错，尤其是在数据量庞大或需要频繁更新的场景下。因此，寻求一种编程方式来实现XML数据到Excel的自动化写入，成为了.NET开发者面临的常见挑战。</p>
<p>C#作为功能强大的编程语言，在数据处理领域拥有卓越的能力。结合专业的第三方库，我们可以高效、精准地完成这类任务。本文将深入探讨如何利用C#和一款优秀的库，将XML数据自动化地写入Excel文件，为开发者提供清晰、可操作的解决方案。</p>
<h2 data-id="heading-0">理解XML数据结构与Excel的对应关系</h2>
<p>在开始编码之前，首先要明确XML数据的结构特点及其如何映射到Excel的行和列。XML数据通常由元素（Element）、属性（Attribute）和文本内容（Text Content）组成，形成一个层级结构。</p>
<p>例如，考虑以下一个简单的产品库存XML数据：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Products</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Product</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"P001"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Name</span>&gt;</span>Laptop<span class="hljs-tag">&lt;/<span class="hljs-name">Name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Category</span>&gt;</span>Electronics<span class="hljs-tag">&lt;/<span class="hljs-name">Category</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Price</span>&gt;</span>1200.00<span class="hljs-tag">&lt;/<span class="hljs-name">Price</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Stock</span>&gt;</span>50<span class="hljs-tag">&lt;/<span class="hljs-name">Stock</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Product</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Product</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"P002"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Name</span>&gt;</span>Mouse<span class="hljs-tag">&lt;/<span class="hljs-name">Name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Category</span>&gt;</span>Electronics<span class="hljs-tag">&lt;/<span class="hljs-name">Category</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Price</span>&gt;</span>25.00<span class="hljs-tag">&lt;/<span class="hljs-name">Price</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Stock</span>&gt;</span>200<span class="hljs-tag">&lt;/<span class="hljs-name">Stock</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Product</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Products</span>&gt;</span>
</code></pre>
<p>这段XML数据可以映射到Excel的结构如下：</p>


























<table><thead><tr><th align="left">产品ID</th><th align="left">产品名称</th><th align="left">类别</th><th align="left">价格</th><th align="left">库存</th></tr></thead><tbody><tr><td align="left">P001</td><td align="left">Laptop</td><td align="left">Electronics</td><td align="left">1200.00</td><td align="left">50</td></tr><tr><td align="left">P002</td><td align="left">Mouse</td><td align="left">Electronics</td><td align="left">25.00</td><td align="left">200</td></tr></tbody></table>
<p>通常，XML中的每个“记录”或“实体”（如这里的<code>&lt;Product&gt;</code>元素）会对应Excel中的一行，而每个“字段”或“属性”（如<code>id</code>属性、<code>&lt;Name&gt;</code>元素的内容）则对应Excel中的一列。理解这种映射关系是成功转换数据的基础。</p>
<h2 data-id="heading-1">引入高效工具：使用Spire.XLS for .NET</h2>
<p>在处理Excel文件时，直接操作Office COM对象或手动构建Open XML SDK可能会非常复杂，尤其是在需要处理格式、样式、合并单元格或大量数据时。因此，选择一个专业的Excel操作库至关重要。本文将使用Spire.XLS for .NET。</p>
<p>Spire.XLS for .NET是一个功能全面且易于使用的.NET库，专门用于创建、读取、编辑和转换Excel文件。它提供了丰富的API，使得开发者能够以编程方式高效地完成各种Excel操作，例如数据写入、样式设置、图表生成等。</p>
<h3 data-id="heading-2">安装Spire.XLS for .NET</h3>
<p>您可以通过NuGet包管理器轻松地将<code>Spire.XLS</code>添加到您的C#项目中。在Visual Studio中，右键点击项目，选择“管理NuGet程序包”，然后搜索<code>Spire.XLS</code>并安装。</p>
<pre><code class="hljs language-bash" lang="bash">Install-Package Spire.XLS
</code></pre>
<p>安装完成后，您就可以在项目中引用并使用<code>Spire.XLS</code>的功能了。</p>
<h2 data-id="heading-3">C#实现XML数据到Excel的详细步骤与代码实践</h2>
<p>接下来，我们将通过具体的C#代码示例，展示如何将上述产品库存XML数据写入Excel。</p>
<h3 data-id="heading-4">步骤一：加载XML数据</h3>
<p>首先，我们需要使用C#的<code>XDocument</code>类来加载和解析XML数据。<code>XDocument</code>是LINQ to XML的一部分，提供了一种更现代、更易于使用的方式来处理XML。</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Xml.Linq;
<span class="hljs-keyword">using</span> Spire.Xls; <span class="hljs-comment">// 引入Spire.Xls命名空间</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">XmlToExcelConverter</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConvertXmlToExcel</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> xmlFilePath, <span class="hljs-built_in">string</span> excelFilePath</span>)</span>
    {
        <span class="hljs-comment">// 假设XML文件内容如上所示</span>
        <span class="hljs-built_in">string</span> xmlContent = <span class="hljs-string">@"
&lt;Products&gt;
  &lt;Product id='P001'&gt;
    &lt;Name&gt;Laptop&lt;/Name&gt;
    &lt;Category&gt;Electronics&lt;/Category&gt;
    &lt;Price&gt;1200.00&lt;/Price&gt;
    &lt;Stock&gt;50&lt;/Stock&gt;
  &lt;/Product&gt;
  &lt;Product id='P002'&gt;
    &lt;Name&gt;Mouse&lt;/Name&gt;
    &lt;Category&gt;Electronics&lt;/Category&gt;
    &lt;Price&gt;25.00&lt;/Price&gt;
    &lt;Stock&gt;200&lt;/Stock&gt;
  &lt;/Product&gt;
&lt;/Products&gt;"</span>;

        XDocument doc;
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-comment">// 从字符串加载XML，也可以使用 XDocument.Load(xmlFilePath) 从文件加载</span>
            doc = XDocument.Parse(xmlContent); 
            Console.WriteLine(<span class="hljs-string">"XML数据加载成功。"</span>);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            Console.WriteLine(<span class="hljs-string">$"加载XML数据时发生错误: <span class="hljs-subst">{ex.Message}</span>"</span>);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// ... 后续写入Excel的代码</span>
    }
}
</code></pre>
<h3 data-id="heading-5">步骤二：创建Excel工作簿并写入数据</h3>
<p>现在，我们将使用<code>Spire.XLS</code>来创建一个新的Excel工作簿，并将解析后的XML数据逐行写入。</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ... 承接上一步的 ConvertXmlToExcel 方法</span>

        <span class="hljs-comment">// 创建一个新的工作簿</span>
        Workbook workbook = <span class="hljs-keyword">new</span> Workbook();
        Worksheet sheet = workbook.Worksheets[<span class="hljs-number">0</span>]; <span class="hljs-comment">// 获取第一个工作表</span>

        <span class="hljs-comment">// 设置列标题</span>
        sheet.Range[<span class="hljs-string">"A1"</span>].Text = <span class="hljs-string">"产品ID"</span>;
        sheet.Range[<span class="hljs-string">"B1"</span>].Text = <span class="hljs-string">"产品名称"</span>;
        sheet.Range[<span class="hljs-string">"C1"</span>].Text = <span class="hljs-string">"类别"</span>;
        sheet.Range[<span class="hljs-string">"D1"</span>].Text = <span class="hljs-string">"价格"</span>;
        sheet.Range[<span class="hljs-string">"E1"</span>].Text = <span class="hljs-string">"库存"</span>;

        <span class="hljs-comment">// 遍历XML数据并写入Excel</span>
        <span class="hljs-built_in">int</span> row = <span class="hljs-number">2</span>; <span class="hljs-comment">// 从第二行开始写入数据，第一行是标题</span>
        <span class="hljs-keyword">foreach</span> (XElement product <span class="hljs-keyword">in</span> doc.Descendants(<span class="hljs-string">"Product"</span>))
        {
            <span class="hljs-comment">// 从XML节点提取数据</span>
            <span class="hljs-built_in">string</span> productId = product.Attribute(<span class="hljs-string">"id"</span>)?.Value;
            <span class="hljs-built_in">string</span> productName = product.Element(<span class="hljs-string">"Name"</span>)?.Value;
            <span class="hljs-built_in">string</span> category = product.Element(<span class="hljs-string">"Category"</span>)?.Value;
            <span class="hljs-built_in">string</span> price = product.Element(<span class="hljs-string">"Price"</span>)?.Value;
            <span class="hljs-built_in">string</span> stock = product.Element(<span class="hljs-string">"Stock"</span>)?.Value;

            <span class="hljs-comment">// 将数据写入Excel单元格</span>
            sheet.Range[<span class="hljs-string">$"A<span class="hljs-subst">{row}</span>"</span>].Text = productId;
            sheet.Range[<span class="hljs-string">$"B<span class="hljs-subst">{row}</span>"</span>].Text = productName;
            sheet.Range[<span class="hljs-string">$"C<span class="hljs-subst">{row}</span>"</span>].Text = category;
            
            <span class="hljs-comment">// 尝试将价格和库存转换为数字类型，以便Excel正确处理</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">decimal</span>.TryParse(price, <span class="hljs-keyword">out</span> <span class="hljs-built_in">decimal</span> dPrice))
            {
                sheet.Range[<span class="hljs-string">$"D<span class="hljs-subst">{row}</span>"</span>].NumberValue = (<span class="hljs-built_in">double</span>)dPrice;
            }
            <span class="hljs-keyword">else</span>
            {
                sheet.Range[<span class="hljs-string">$"D<span class="hljs-subst">{row}</span>"</span>].Text = price;
            }

            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">int</span>.TryParse(stock, <span class="hljs-keyword">out</span> <span class="hljs-built_in">int</span> iStock))
            {
                sheet.Range[<span class="hljs-string">$"E<span class="hljs-subst">{row}</span>"</span>].NumberValue = iStock;
            }
            <span class="hljs-keyword">else</span>
            {
                sheet.Range[<span class="hljs-string">$"E<span class="hljs-subst">{row}</span>"</span>].Text = stock;
            }
            
            row++;
        }

        <span class="hljs-comment">// 自动调整列宽，使内容可见</span>
        sheet.AllocatedRange.AutoFitColumns();

        <span class="hljs-comment">// ... 后续保存Excel的代码</span>
</code></pre>
<h3 data-id="heading-6">步骤三：保存Excel文件</h3>
<p>最后一步是将填充好数据的Excel工作簿保存到指定路径。</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ... 承接上一步的代码</span>

        <span class="hljs-keyword">try</span>
        {
            workbook.SaveToFile(excelFilePath, ExcelVersion.Version2016); <span class="hljs-comment">// 保存为Excel 2016格式</span>
            Console.WriteLine(<span class="hljs-string">$"Excel文件已成功保存到: <span class="hljs-subst">{excelFilePath}</span>"</span>);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            Console.WriteLine(<span class="hljs-string">$"保存Excel文件时发生错误: <span class="hljs-subst">{ex.Message}</span>"</span>);
        }
        <span class="hljs-keyword">finally</span>
        {
            workbook.Dispose(); <span class="hljs-comment">// 释放资源</span>
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
    {
        <span class="hljs-built_in">string</span> xmlFile = <span class="hljs-string">"products.xml"</span>; <span class="hljs-comment">// 实际应用中可以是文件路径</span>
        <span class="hljs-built_in">string</span> excelFile = <span class="hljs-string">"ProductsReport.xlsx"</span>;
        ConvertXmlToExcel(xmlFile, excelFile);
    }
}
</code></pre>
<h3 data-id="heading-7">进阶提示：添加基本样式</h3>
<p>为了让生成的Excel报表更具可读性，我们可以为标题行添加一些基本样式，例如加粗和设置背景色。</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ... 在设置列标题之后，写入数据之前</span>

        <span class="hljs-comment">// 设置标题行的样式</span>
        sheet.Range[<span class="hljs-string">"A1:E1"</span>].Style.Font.IsBold = <span class="hljs-literal">true</span>; <span class="hljs-comment">// 加粗</span>
        sheet.Range[<span class="hljs-string">"A1:E1"</span>].Style.KnownColor = ExcelKnownColor.LightGreen; <span class="hljs-comment">// 设置背景色</span>
        sheet.Range[<span class="hljs-string">"A1:E1"</span>].Style.HorizontalAlignment = HorizontalAlignType.Center; <span class="hljs-comment">// 居中对齐</span>

<span class="hljs-comment">// ...</span>
</code></pre>
<p>通过上述步骤，我们能够将XML数据有效地解析并写入到Excel文件中，同时对数据类型进行适当处理，并对报表进行初步的样式美化。</p>
<h3 data-id="heading-8">生成结果示例</h3>
<p>以下是使用上述代码通过Spire.XLS for .NET库生成的Excel文件（包含格式设置）：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d389e97be1194139a141d85d443fb4dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODM1NjI5MDc4MDUx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039653&amp;x-signature=W2cV83XKr6Z%2F3VSpHJYS3%2Brf32I%3D" alt="写入XML数据到Excel文件" loading="lazy"/></p>
<h2 data-id="heading-9">总结</h2>
<p>本文详细介绍了如何利用C#和Spire.XLS for .NET库将XML数据高效地写入Excel文件。我们从理解XML与Excel的映射关系开始，逐步讲解了如何加载XML数据、创建Excel工作簿、遍历XML并逐行写入数据，以及最终保存文件。通过本文提供的代码示例和详细解释，C#开发者可以轻松地实现XML数据到Excel的自动化导出。</p>
<p>C#结合Spire.XLS for .NET在自动化数据导出方面展现出强大的能力和灵活性。掌握这一技能将极大地提升您在.NET开发中处理数据和生成报表的效率。我鼓励读者尝试本文提供的代码示例，并根据自身的业务需求进行扩展，例如处理更复杂的嵌套XML结构、添加更丰富的Excel样式、图表或数据验证等。这将是您提升开发效率和数据处理能力的有力一步。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[COALESCE函数：处理NULL值的利器]]></title>    <link>https://juejin.cn/post/7582156219060240447</link>    <guid>https://juejin.cn/post/7582156219060240447</guid>    <pubDate>2025-12-11T06:43:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156219060240447" data-draft-id="7582163781184126982" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="COALESCE函数：处理NULL值的利器"/> <meta itemprop="keywords" content="SQL,MySQL,函数式编程"/> <meta itemprop="datePublished" content="2025-12-11T06:43:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="独泪了无痕"/> <meta itemprop="url" content="https://juejin.cn/user/2981531265546328"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            COALESCE函数：处理NULL值的利器
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2981531265546328/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    独泪了无痕
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:43:43.000Z" title="Thu Dec 11 2025 06:43:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e2e90208d504a819f80321a8b59f0db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54us5rOq5LqG5peg55eV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766040222&amp;x-signature=3WJQtCO87YUt70aaNlftOOMZlqk%3D" alt="image" loading="lazy"/></p>
<h2 data-id="heading-0">一、基础解析</h2>
<h3 data-id="heading-1">基本概念</h3>
<p>  在 SQL 数据查询中，空值（NULL）处理是开发者经常面临的挑战，空值可能由于数据缺失、未知或未定义的值而存在。SQL 提供了多种方法来处理空值，其中 COALESCE 函数是一个非常有用的工具，能够优雅地解决数据缺失问题，为查询结果提供可靠的默认值。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/206af3e8a41b4c36be3386a66e44e1fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54us5rOq5LqG5peg55eV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766040222&amp;x-signature=fA7N7gd524SOqzAqOdbyaIK%2Bqss%3D" alt="image" loading="lazy"/></p>
<p>  COALESCE 是ANSI SQL标准定义的函数，其名称源自"coalition"（联合）一词，寓意从多个值中联合选择第一个有效值。该函数接受两个或多个参数，按顺序检查每个参数，返回第一个非NULL的值。如果所有的表达式都是空值（NULL），则返回 NULL。这个函数常用于处理可能存在 NULL 值的数据列，确保查询结果更加稳定和可预测，在数据清洗、报表生成以及为可能为空的字段提供默认值等场景中非常实用。</p>
<h3 data-id="heading-2">基本语法结构</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-built_in">COALESCE</span>(expression1, expression2, ..., expressionN)
</code></pre>
<p>  其中，<code>expression1, expression2, ... , expressionN</code> 是一个或多个表达式。COALESCE 函数从左到右依次评估每个表达式，返回列表中的第一个非空参数，当所有参数均为 NULL 时，此函数将返回 NULL。这种设计遵循了SQL的三值逻辑（TRUE/FALSE/UNKNOWN），确保在数据确实缺失时保持结果的明确性。下面的示例显示了 COALESCE 函数的一些基本用法示例：</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 如果 column1 的值为 NULL，那么将返回 '默认值'。</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COALESCE</span>(column1, <span class="hljs-string">'默认值'</span>);

<span class="hljs-comment">-- 如果 column1 和 column2 都是 NULL，那么返回 '默认值'。</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COALESCE</span>(column1, column2, <span class="hljs-string">'默认值'</span>);
<span class="hljs-comment">-- Mumbai</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COALESCE</span>(<span class="hljs-string">'Mumbai'</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-string">'London'</span>, <span class="hljs-string">'Paris'</span>);
<span class="hljs-comment">-- NULL</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COALESCE</span>(<span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">NULL</span>); 
<span class="hljs-comment">-- 1</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COALESCE</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-number">3</span>);
<span class="hljs-comment">-- 10</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COALESCE</span>(<span class="hljs-keyword">NULL</span>, <span class="hljs-number">10</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>);
</code></pre>
<ul>
<li><strong>短路求值机制</strong>：函数从左到右依次评估参数，发现第一个非NULL值后立即返回，不再评估后续参数</li>
<li><strong>类型一致性要求</strong>：所有参数必须是可以隐式转换的兼容数据类型</li>
<li><strong>确定性结果</strong>：对于相同的输入参数，总是返回相同的结果</li>
</ul>
<h2 data-id="heading-3">二、典型应用场景</h2>
<h3 data-id="heading-4">默认值设置</h3>
<p>  在实际的数据查询和处理中，我们经常会遇到空值的情况。例如，当某个字段为空时，我们可以使用 COALESCE 函数将其替换为空字符串或者其他默认值。这对于数据报告和用户界面显示特别有用，因为可以避免显示 NULL 值，而是显示一个更有意义的默认值。假设有一个 employees 表，用于展示员工的信息，其中包括员工姓名和薪水。有时候，薪水字段可能为空，我们希望在查询结果中将其显示为默认值，比如 0。</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> employee_id,name,<span class="hljs-built_in">COALESCE</span>(salary, <span class="hljs-number">0</span>) <span class="hljs-keyword">AS</span> effective_salary <span class="hljs-keyword">FROM</span> employees;
</code></pre>
<p>  在上述示例中，我们使用 COALESCE 函数确保 effective_salary 列不会包含 NULL 值，如果 salary 是 NULL，则 effective_salary 会显示为0。</p>
<h3 data-id="heading-5">多列优先级选择</h3>
<p>  为了更准确地反映需求，可能会存在多个数据源时，按优先级顺序选择第一个有效值。假设一个contacts（联系人）表包含work_phone（工作电话）、home_phone（家庭电话）和mobile_phone（移动电话）三个字段，希望获取任意一个可用的联系电话。</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 用户联系方式优先级：手机&gt;固话&gt;邮箱</span>
<span class="hljs-keyword">SELECT</span> user_id,<span class="hljs-built_in">COALESCE</span>(mobile_phone, home_phone, email,<span class="hljs-string">'暂无联系方式'</span>) <span class="hljs-keyword">AS</span> primary_contact <span class="hljs-keyword">FROM</span> contacts;
</code></pre>
<p>  将按顺序检查work_phone、home_phone和mobile_phone，并返回第一个非 NULL 的电话号码。如果所有电话字段都为 NULL，则返回字符串'暂无联系方式'。</p>
<h3 data-id="heading-6">构造处理逻辑条件</h3>
<p>  除了处理空值情况，COALESCE 函数还可以与其他条件语句一起使用，来处理更复杂的数据情况。假设我们有一个名为 orders 的表，包含了订单的相关信息，如下所示：</p>






























<table><thead><tr><th align="center">id</th><th align="left">product</th><th align="left">quantity</th></tr></thead><tbody><tr><td align="center">1</td><td align="left">Apple</td><td align="left">10</td></tr><tr><td align="center">2</td><td align="left">Orange</td><td align="left">NULL</td></tr><tr><td align="center">3</td><td align="left">Banana</td><td align="left">5</td></tr><tr><td align="center">4</td><td align="left">NULL</td><td align="left">3</td></tr></tbody></table>
<p>  现在我们想要查询每个订单的总价值，并且对于一些缺少产品或者数量的订单，我们希望将其单价和数量设为0，并计算总价值。</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> id, product, quantity, <span class="hljs-built_in">COALESCE</span>(quantity, <span class="hljs-number">0</span>) <span class="hljs-operator">*</span> <span class="hljs-built_in">COALESCE</span>(price, <span class="hljs-number">0</span>) <span class="hljs-keyword">AS</span> total_price <span class="hljs-keyword">FROM</span> orders;
</code></pre>
<p>  运行结果如下：</p>



































<table><thead><tr><th align="center">id</th><th align="center">product</th><th align="center">quantity</th><th align="center">total_price</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">Apple</td><td align="center">10</td><td align="center">100</td></tr><tr><td align="center">2</td><td align="center">Orange</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">3</td><td align="center">Banana</td><td align="center">5</td><td align="center">50</td></tr><tr><td align="center">4</td><td align="center">NULL</td><td align="center">3</td><td align="center">0</td></tr></tbody></table>
<h2 data-id="heading-7">跨数据库兼容性分析</h2>
<p>  虽然 COALESCE 是标准 SQL 函数，但不同数据库系统也提供了各自的替代方案：</p>









































<table><thead><tr><th align="left">数据库系统</th><th align="left">SQL标准函数</th><th align="left">专有函数</th><th align="left">备注</th></tr></thead><tbody><tr><td align="left">SQL Server</td><td align="left">COALESCE</td><td align="left">ISNULL(expr1,expr2)</td><td align="left">ISNULL只能有两个参数</td></tr><tr><td align="left">Oracle</td><td align="left">COALESCE</td><td align="left">NVL(expr1,expr2)</td><td align="left">NVL仅接受两个参数</td></tr><tr><td align="left">PostgreSQL</td><td align="left">COALESCE</td><td align="left"/><td align="left">完全支持标准语法</td></tr><tr><td align="left">MySQL</td><td align="left">COALESCE</td><td align="left">IFNULL(expr1,expr2)</td><td align="left">IFNULL只能有两个参数</td></tr><tr><td align="left">SQLite</td><td align="left">COALESCE</td><td align="left"/><td align="left">完全支持标准语法</td></tr></tbody></table>
<p>  在实际开发中，建议结合具体数据库系统的特性和查询优化器的行为，灵活运用COALESCE函数，在保证代码可读性的同时实现最佳性能。最佳实践建议：</p>
<ol>
<li>在需要跨数据库兼容的代码中使用COALESCE</li>
<li>仅在确定目标数据库时使用专有函数以获得轻微性能优势</li>
<li>复杂场景中COALESCE的可读性通常优于嵌套的CASE表达式</li>
<li>COALESCE() 函数在处理 NULL 值时非常有效，但在设计数据库和编写查询时，应尽量减少依赖此类函数的情况，以保持数据的完整性和查询的效率。</li>
</ol>
<h2 data-id="heading-8">总结</h2>
<p>  COALESCE 函数以其简洁性和强大功能，成为 SQL 查询中处理NULL值的标配工具。从简单的默认值设置到复杂的数据优先级选择，从关系型数据库到现代文档型数据库，COALESCE 都展现出其不可替代的价值。通过合理应用这一函数，开发者能够编写出更健壮、更易维护的 SQL 代码，有效应对数据缺失带来的各种挑战，提高数据处理的效率和可读性。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21880ceba4a54b629d91041b8eaaa8e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54us5rOq5LqG5peg55eV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766040222&amp;x-signature=Cqp9Ih0cB45bviHsvQr5bHiJA%2BE%3D" alt="image" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[动态库和静态库的区别]]></title>    <link>https://juejin.cn/post/7582246395986362402</link>    <guid>https://juejin.cn/post/7582246395986362402</guid>    <pubDate>2025-12-11T06:31:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582246395986362402" data-draft-id="7582155513586434100" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="动态库和静态库的区别"/> <meta itemprop="keywords" content="面试"/> <meta itemprop="datePublished" content="2025-12-11T06:31:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="诗和远方1493956232734"/> <meta itemprop="url" content="https://juejin.cn/user/272334612078663"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            动态库和静态库的区别
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/272334612078663/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    诗和远方1493956232734
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:31:07.000Z" title="Thu Dec 11 2025 06:31:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">一、基本概念</h2>
<h3 data-id="heading-1">静态库（Static Library）</h3>
<ul>
<li><strong>iOS/macOS</strong>: <code>.a</code> 文件</li>
<li><strong>Windows</strong>: <code>.lib</code> 文件</li>
<li><strong>Linux</strong>: <code>.a</code> 文件</li>
</ul>
<h3 data-id="heading-2">动态库（Dynamic Library）</h3>
<ul>
<li><strong>iOS/macOS</strong>: <code>.dylib</code> 或 <code>.framework</code></li>
<li><strong>Windows</strong>: <code>.dll</code> 文件</li>
<li><strong>Linux</strong>: <code>.so</code> 文件</li>
</ul>
<hr/>
<h2 data-id="heading-3">二、核心区别对比表</h2>


















































<table><thead><tr><th>对比维度</th><th>静态库</th><th>动态库</th></tr></thead><tbody><tr><td><strong>链接时机</strong></td><td>编译时链接到可执行文件</td><td>运行时加载</td></tr><tr><td><strong>文件大小</strong></td><td>增加可执行文件体积</td><td>不增加可执行文件体积</td></tr><tr><td><strong>内存占用</strong></td><td>每个进程独立占用内存</td><td>多进程共享内存</td></tr><tr><td><strong>更新方式</strong></td><td>需要重新编译整个程序</td><td>只需替换库文件</td></tr><tr><td><strong>加载速度</strong></td><td>启动快（已在可执行文件中）</td><td>启动慢（需要动态加载）</td></tr><tr><td><strong>依赖管理</strong></td><td>无运行时依赖</td><td>需要确保库文件存在</td></tr><tr><td><strong>版本冲突</strong></td><td>不存在</td><td>可能存在版本冲突</td></tr><tr><td><strong>代码复用</strong></td><td>每个程序独立拷贝</td><td>多个程序共享一份</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-4">三、工作原理图解</h2>
<h3 data-id="heading-5">静态库链接过程</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    subgraph 编译时
        A[源代码 main.c] --&gt; B[编译器]
        C[静态库 libmath.a] --&gt; B
        B --&gt; D[链接器]
        D --&gt; E[可执行文件 app&lt;br/&gt;包含库代码]
    end
    
    subgraph 运行时
        E --&gt; F[直接运行&lt;br/&gt;无需外部依赖]
    end
    
    style E fill:#FF6B6B
    style F fill:#98FB98
</code></pre>
<h3 data-id="heading-6">动态库链接过程</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    subgraph 编译时
        A[源代码 main.c] --&gt; B[编译器]
        C[动态库 libmath.dylib] -.引用.-&gt; B
        B --&gt; D[链接器]
        D --&gt; E[可执行文件 app&lt;br/&gt;只包含引用]
    end
    
    subgraph 运行时
        E --&gt; F[动态加载器]
        G[libmath.dylib] --&gt; F
        F --&gt; H[程序运行]
    end
    
    style E fill:#FFD93D
    style G fill:#FFA07A
    style H fill:#98FB98
</code></pre>
<hr/>
<h2 data-id="heading-7">四、内存占用对比</h2>
<h3 data-id="heading-8">静态库内存模型</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph 内存
        A[进程 A&lt;br/&gt;包含 libmath 代码]
        B[进程 B&lt;br/&gt;包含 libmath 代码]
        C[进程 C&lt;br/&gt;包含 libmath 代码]
    end
    
    style A fill:#FF6B6B
    style B fill:#FF6B6B
    style C fill:#FF6B6B
</code></pre>
<p><strong>特点</strong>: 每个进程都有一份完整的库代码副本</p>
<h3 data-id="heading-9">动态库内存模型</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph 内存
        D[共享库区域&lt;br/&gt;libmath.dylib&lt;br/&gt;只加载一次]
        
        A[进程 A] -.引用.-&gt; D
        B[进程 B] -.引用.-&gt; D
        C[进程 C] -.引用.-&gt; D
    end
    
    style D fill:#98FB98
    style A fill:#FFD93D
    style B fill:#FFD93D
    style C fill:#FFD93D
</code></pre>
<p><strong>特点</strong>: 多个进程共享同一份库代码，节省内存</p>
<hr/>
<h2 data-id="heading-10">五、详细对比</h2>
<h3 data-id="heading-11">1. 文件大小对比</h3>
<h4 data-id="heading-12">静态库示例</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 编译静态库</span>
gcc -c math.c -o math.o
ar rcs libmath.a math.o

<span class="hljs-comment"># 链接到程序</span>
gcc main.c -L. -lmath -o app_static

<span class="hljs-comment"># 查看大小</span>
<span class="hljs-built_in">ls</span> -lh app_static
<span class="hljs-comment"># 输出: -rwxr-xr-x  1 user  staff   50K  app_static  ← 包含库代码</span>
</code></pre>
<h4 data-id="heading-13">动态库示例</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 编译动态库</span>
gcc -shared -fPIC math.c -o libmath.dylib

<span class="hljs-comment"># 链接到程序</span>
gcc main.c -L. -lmath -o app_dynamic

<span class="hljs-comment"># 查看大小</span>
<span class="hljs-built_in">ls</span> -lh app_dynamic
<span class="hljs-comment"># 输出: -rwxr-xr-x  1 user  staff   10K  app_dynamic  ← 只包含引用</span>

<span class="hljs-built_in">ls</span> -lh libmath.dylib
<span class="hljs-comment"># 输出: -rwxr-xr-x  1 user  staff   20K  libmath.dylib</span>
</code></pre>
<p><strong>对比</strong>:</p>
<ul>
<li>静态链接: <code>app_static</code> = 50K（包含所有代码）</li>
<li>动态链接: <code>app_dynamic</code> (10K) + <code>libmath.dylib</code> (20K) = 30K</li>
</ul>
<hr/>
<h3 data-id="heading-14">2. 更新方式对比</h3>
<h4 data-id="heading-15">静态库更新流程</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[库代码有 Bug] --&gt; B[修改库源代码]
    B --&gt; C[重新编译静态库]
    C --&gt; D[重新编译所有使用该库的程序]
    D --&gt; E[重新发布所有程序]
    
    style A fill:#FF6B6B
    style E fill:#FFD93D
</code></pre>
<h4 data-id="heading-16">动态库更新流程</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[库代码有 Bug] --&gt; B[修改库源代码]
    B --&gt; C[重新编译动态库]
    C --&gt; D[替换动态库文件]
    D --&gt; E[程序自动使用新库]
    
    style A fill:#FF6B6B
    style E fill:#98FB98
</code></pre>
<hr/>
<h3 data-id="heading-17">3. iOS 开发中的实际应用</h3>
<h4 data-id="heading-18">静态库 (.a)</h4>
<pre><code class="hljs language-objective-c" lang="objective-c">// 创建静态库项目
// File -&gt; New -&gt; Project -&gt; Cocoa Touch Static Library

// MyStaticLib.h
#import &lt;Foundation/Foundation.h&gt;

@interface MyStaticLib : NSObject
+ (NSString *)getVersion;
@end

// MyStaticLib.m
@implementation MyStaticLib
+ (NSString *)getVersion {
    return @"1.0.0";
}
@end

// 使用静态库
// 1. 将 libMyStaticLib.a 添加到项目
// 2. 在 Build Phases -&gt; Link Binary With Libraries 中添加
// 3. 直接使用
#import "MyStaticLib.h"
NSString *version = [MyStaticLib getVersion];
</code></pre>
<p><strong>特点</strong>:</p>
<ul>
<li>✅ 编译后代码在 App 内部，无需额外文件</li>
<li>✅ 启动速度快</li>
<li>❌ 增加 App 体积</li>
<li>❌ 更新需要重新提交 App</li>
</ul>
<h4 data-id="heading-19">动态库 (.framework)</h4>
<pre><code class="hljs language-objective-c" lang="objective-c">// 创建动态库项目
// File -&gt; New -&gt; Project -&gt; Cocoa Touch Framework

// MyDynamicLib.h
#import &lt;Foundation/Foundation.h&gt;

@interface MyDynamicLib : NSObject
+ (NSString *)getVersion;
@end

// MyDynamicLib.m
@implementation MyDynamicLib
+ (NSString *)getVersion {
    return @"2.0.0";
}
@end

// 使用动态库
// 1. 将 MyDynamicLib.framework 添加到项目
// 2. 在 General -&gt; Frameworks, Libraries, and Embedded Content
//    选择 "Embed &amp; Sign"
// 3. 使用
#import &lt;MyDynamicLib/MyDynamicLib.h&gt;
NSString *version = [MyDynamicLib getVersion];
</code></pre>
<p><strong>特点</strong>:</p>
<ul>
<li>✅ 不增加主 App 体积</li>
<li>✅ 可以在 App Extension 间共享</li>
<li>✅ 支持热更新（越狱环境）</li>
<li>❌ 启动速度稍慢</li>
<li>❌ 需要确保 framework 正确嵌入</li>
</ul>
<hr/>
<h2 data-id="heading-20">六、性能对比</h2>
<h3 data-id="heading-21">启动时间对比</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">gantt
    title 应用启动时间对比
    dateFormat X
    axisFormat %L ms
    
    section 静态库
    加载可执行文件    :0, 50
    初始化           :50, 100
    
    section 动态库
    加载可执行文件    :0, 30
    加载动态库        :30, 80
    符号解析         :80, 120
    初始化           :120, 170
</code></pre>
<p><strong>结论</strong>: 静态库启动更快（100ms vs 170ms）</p>
<hr/>
<h2 data-id="heading-22">七、实际案例分析</h2>
<h3 data-id="heading-23">案例 1: 系统库（动态库）</h3>
<pre><code class="hljs language-objective-c" lang="objective-c">// iOS 系统库都是动态库
#import &lt;UIKit/UIKit.h&gt;
#import &lt;Foundation/Foundation.h&gt;

// 这些库在系统中只有一份
// 所有 App 共享，节省内存
</code></pre>
<h3 data-id="heading-24">案例 2: 第三方库</h3>
<h4 data-id="heading-25">CocoaPods 静态库配置</h4>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># Podfile</span>
platform <span class="hljs-symbol">:ios</span>, <span class="hljs-string">'13.0'</span>
use_frameworks! <span class="hljs-symbol">:linkage</span> =&gt; <span class="hljs-symbol">:static</span>  <span class="hljs-comment"># 使用静态库</span>

target <span class="hljs-string">'MyApp'</span> <span class="hljs-keyword">do</span>
  pod <span class="hljs-string">'AFNetworking'</span>
  pod <span class="hljs-string">'SDWebImage'</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h4 data-id="heading-26">CocoaPods 动态库配置</h4>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># Podfile</span>
platform <span class="hljs-symbol">:ios</span>, <span class="hljs-string">'13.0'</span>
use_frameworks!  <span class="hljs-comment"># 使用动态库（默认）</span>

target <span class="hljs-string">'MyApp'</span> <span class="hljs-keyword">do</span>
  pod <span class="hljs-string">'AFNetworking'</span>
  pod <span class="hljs-string">'SDWebImage'</span>
<span class="hljs-keyword">end</span>
</code></pre>
<hr/>
<h2 data-id="heading-27">八、选择建议</h2>
<h3 data-id="heading-28">使用静态库的场景</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((静态库))
    性能要求高
      启动速度关键
      实时性应用
    独立分发
      单一可执行文件
      无外部依赖
    安全性
      代码不易被替换
      防止篡改
    小型项目
      库数量少
      体积可控
</code></pre>
<h3 data-id="heading-29">使用动态库的场景</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((动态库))
    代码共享
      多个 App 使用
      App Extension
    频繁更新
      独立更新库
      不影响主程序
    大型项目
      模块化开发
      减少主程序体积
    插件系统
      动态加载
      可选功能
</code></pre>
<hr/>
<h2 data-id="heading-30">九、iOS 特殊情况</h2>
<h3 data-id="heading-31">iOS 动态库限制</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[iOS 动态库] --&gt; B{库来源}
    
    B --&gt;|系统库| C[允许&lt;br/&gt;UIKit, Foundation 等]
    B --&gt;|自定义库| D{使用场景}
    
    D --&gt;|主 App 内部| E[允许&lt;br/&gt;Embed &amp; Sign]
    D --&gt;|App Extension| F[允许&lt;br/&gt;共享 Framework]
    D --&gt;|跨 App 共享| G[ 不允许&lt;br/&gt;沙盒限制]
    
    style C fill:#98FB98
    style E fill:#98FB98
    style F fill:#98FB98
    style G fill:#FF6B6B
</code></pre>
<h3 data-id="heading-32">App Extension 共享 Framework</h3>
<pre><code class="hljs language-scss" lang="scss">MyApp<span class="hljs-selector-class">.app</span>/
├── MyApp (可执行文件)
├── Frameworks/
│   └── SharedLib<span class="hljs-selector-class">.framework</span>  ← 主 App 和 Extension 共享
└── PlugIns/
    └── MyExtension<span class="hljs-selector-class">.appex</span>/
        └── MyExtension (可执行文件)
</code></pre>
<p><strong>配置方法</strong>:</p>
<pre><code class="hljs language-objective-c" lang="objective-c">// 1. 创建 Framework (Dynamic)
// 2. 在主 App Target 中: Embed &amp; Sign
// 3. 在 Extension Target 中: Do Not Embed
// 4. 两者都可以使用该 Framework
</code></pre>
<hr/>
<h2 data-id="heading-33">十、常见问题</h2>
<h3 data-id="heading-34">Q1: 为什么 iOS 主要使用动态库？</h3>
<pre><code class="hljs language-markdown" lang="markdown">原因:
<span class="hljs-bullet">1.</span> 系统库共享，节省内存
<span class="hljs-bullet">2.</span> 支持 App Extension 代码共享
<span class="hljs-bullet">3.</span> 模块化开发，便于维护
<span class="hljs-bullet">4.</span> Swift 库必须是动态库（Swift ABI 稳定前）
</code></pre>
<h3 data-id="heading-35">Q2: 静态库会增加多少体积？</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 示例计算</span>
静态库大小: 5MB
使用该库的函数: 20%

实际增加体积:
- 理论上: 5MB (完整拷贝)
- 实际上: 1-2MB (链接器会移除未使用代码)
</code></pre>
<h3 data-id="heading-36">Q3: 如何查看 App 使用的库？</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 查看动态库依赖</span>
otool -L MyApp.app/MyApp

<span class="hljs-comment"># 输出示例:</span>
/System/Library/Frameworks/UIKit.framework/UIKit
/System/Library/Frameworks/Foundation.framework/Foundation
@rpath/MyDynamicLib.framework/MyDynamicLib  ← 自定义动态库
</code></pre>
<hr/>
<h2 data-id="heading-37">十一、最佳实践</h2>
<h3 data-id="heading-38">混合使用策略</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[第三方库选择] --&gt; B{库特征}
    
    B --&gt;|基础工具库&lt;br/&gt;如 JSON 解析| C[静态库&lt;br/&gt;减少启动时间]
    B --&gt;|UI 组件库&lt;br/&gt;频繁更新| D[动态库&lt;br/&gt;便于维护]
    B --&gt;|大型 SDK&lt;br/&gt;如地图| E[动态库&lt;br/&gt;减少体积]
    B --&gt;|核心业务库&lt;br/&gt;稳定| F[静态库&lt;br/&gt;提高性能]
    
    style C fill:#FFD93D
    style D fill:#FFA07A
    style E fill:#FFA07A
    style F fill:#FFD93D
</code></pre>
<h3 data-id="heading-39">性能优化建议</h3>
<pre><code class="hljs language-objective-c" lang="objective-c">// 1. 减少动态库数量
// 不推荐: 10 个小动态库
// 推荐: 合并为 2-3 个大动态库

// 2. 延迟加载非必要库
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{
    // 加载非启动必需的库
    [self loadOptionalLibraries];
});

// 3. 使用静态库优化启动速度
// 核心启动库 -&gt; 静态库
// 其他功能库 -&gt; 动态库
</code></pre>
<hr/>
<h2 data-id="heading-40">总结</h2>









































<table><thead><tr><th>维度</th><th>静态库</th><th>动态库</th><th>推荐场景</th></tr></thead><tbody><tr><td><strong>体积</strong></td><td>增加 App 体积</td><td>不增加</td><td>动态库 ✅</td></tr><tr><td><strong>性能</strong></td><td>启动快</td><td>启动慢</td><td>静态库 ✅</td></tr><tr><td><strong>更新</strong></td><td>需重新编译</td><td>独立更新</td><td>动态库 ✅</td></tr><tr><td><strong>共享</strong></td><td>不支持</td><td>支持</td><td>动态库 ✅</td></tr><tr><td><strong>依赖</strong></td><td>无外部依赖</td><td>需确保库存在</td><td>静态库 ✅</td></tr></tbody></table>
<p><strong>一般建议</strong>:</p>
<ul>
<li>🎯 <strong>小型 App</strong>: 优先使用静态库</li>
<li>🎯 <strong>大型 App</strong>: 混合使用，核心用静态，功能用动态</li>
<li>🎯 <strong>SDK 开发</strong>: 提供两种版本供开发者选择</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[props 、emits 、组件上的v-model（详细版）]]></title>    <link>https://juejin.cn/post/7582182817107771418</link>    <guid>https://juejin.cn/post/7582182817107771418</guid>    <pubDate>2025-12-11T06:34:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582182817107771418" data-draft-id="7579142750408851482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="props 、emits 、组件上的v-model（详细版）"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2025-12-11T06:34:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="nnnnna"/> <meta itemprop="url" content="https://juejin.cn/user/248908298065256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            props 、emits 、组件上的v-model（详细版）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/248908298065256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    nnnnna
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:34:58.000Z" title="Thu Dec 11 2025 06:34:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">props (父组件 -&gt; 子组件通信)</h2>
<h3 data-id="heading-1">一、声明props的三种方式</h3>
<h4 data-id="heading-2">1.使用字符串数组的方式声明props</h4>
<p><code>const props = defineProps(["num", "name", "isShow", "arrList", "objList"]);</code></p>
<h4 data-id="heading-3">2.使用对象的方式声明props</h4>
<pre><code class="hljs language-对象方式传递props" lang="对象方式传递props">const props = defineProps({
  num: Number,
  name: String,
  isShow: Boolean,
  arrList: Array,
  objList: Object,
});
</code></pre>
<p>其中，属性名为props的名称，属性值为props预期类型的构造函数</p>
<h4 data-id="heading-4">3.带有props校验和默认值的props声明</h4>
<pre><code class="hljs language-带有props校验和默认值的props声明" lang="带有props校验和默认值的props声明">const props = defineProps({
  num: {
    type: Number,
    //设置必传
    required: true,
  },
  name: {
    type: String,
    default: "张三",
  },
  isShow: {
    type: Boolean,
    default: true,
  },
  arrList: {
    type: Array,
    default: () =&gt; {
      return [1, 2, 3];
    },
  },
  objList: {
    type: Object,
    default: (rawProps: any) =&gt; {
      //此处可以拿到原始prop
      console.log(rawProps);
      return { name: "张三", age: 18 };
    },
  },
});
</code></pre>
<h3 data-id="heading-5">二、响应式解构props</h3>
<p>props为Vue封装的响应式对象，当我们直接解构props时，会将属性值提取为普通变量，使得解构后的值失去了响应性，后续props更新时，解构后的变量不会发生响应式变化</p>
<p>因此，如果想要解构后的值依旧保持响应性，我们可以使用Vue提供的toRefs来解构，它可以将响应式对象的每个属性转换为对应的 ref对象，使得解构后仍保留响应性，值得注意的是，通过toRefs解构后的值，因为被转换为了ref，因此访问的时候需要带上.value</p>
<pre><code class="hljs language-响应式解构props" lang="响应式解构props">import { onMounted, toRefs } from "vue";
const props = defineProps({
  num: {
    type: Number,
    //设置必传
    required: true,
  },
  name: {
    type: String,
    default: "张三",
  },
  isShow: {
    type: Boolean,
    default: true,
  },
  arrList: {
    type: Array,
    default: () =&gt; {
      return [1, 2, 3];
    },
  },
  objList: {
    type: Object,
    default: (rawProps: any) =&gt; {
      //此处可以拿到原始prop
      console.log(rawProps);
      return { name: "张三", age: 18 };
    },
  },
});
const { num, name, isShow, arrList, objList } = toRefs(props);
onMounted(() =&gt; {
  console.log(num.value);
  console.log(name.value);
  console.log(isShow.value);
  console.log(arrList.value);
  console.log(objList.value);
});
</code></pre>
<h3 data-id="heading-6">三、props的命名规范</h3>
<p>在子组件定义props时，使用小驼峰命名法（<strong>camelCase</strong>）</p>
<p>在父组件传递props时，使用短线命名法（<strong>kebab-case</strong>）</p>
<pre><code class="hljs language-子组件使用小驼峰命名" lang="子组件使用小驼峰命名">&lt;script setup lang="ts"&gt;
const props = defineProps({
  arrList: {
    type: Array,
    default: () =&gt; {
      return [1, 2, 3];
    },
  },
  objList: {
    type: Object,
    default: () =&gt; {
      return { name: "张三", age: 18 };
    },
  },
});
&lt;/script&gt;
</code></pre>
<pre><code class="hljs language-父组件使用短线命名" lang="父组件使用短线命名">&lt;template&gt;
  &lt;div&gt;
    &lt;TestCom :arr-list="arrList" :obj-list="objList" /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-7">四、单向数据流</h3>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>s</mi><mtext>遵循单向数据流的原则，即数据通过父组件流向子组件</mtext></mrow></mstyle></mrow><annotation encoding="application/x-tex">\color{red}{props遵循单向数据流的原则，即数据通过父组件流向子组件}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord" style="color:red;"><span class="mord mathnormal" style="color:red;">p</span><span class="mord mathnormal" style="color:red;">ro</span><span class="mord mathnormal" style="color:red;">p</span><span class="mord mathnormal" style="color:red;">s</span><span class="mord cjk_fallback" style="color:red;">遵循单向数据流的原则，即数据通过父组件流向子组件</span></span></span></span></span></span></p>
<h4 data-id="heading-8">1.当数据为原始类型时，如果我们尝试去修改一个props的值，Vue会在控制台抛出一个警告，并且修改不成功</h4>
<pre><code class="hljs language-直接修改porps中的原始类型的值" lang="直接修改porps中的原始类型的值">&lt;script setup lang="ts"&gt;
import { onMounted } from "vue";

const props = defineProps({
  num: Number,
  name: String,
  isShow: Boolean,
});
onMounted(() =&gt; {
  props.num = 456;
  props.name = "李四";
  props.isShow = false;
  console.log(props.num);
  console.log(props.name);
  console.log(props.isShow);
});
&lt;/script&gt;
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0322179dcb05434185d59e3b7bd1ffb6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbm5ubm5h:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039766&amp;x-signature=yAkXqduuXbamu7n%2F2Nt6f1UQiDE%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-9">2.如果数据为对象或者数组时，我们能够直接修改数组或者对象内部的值，因为对象和数组是按引用传递的，即传递的是一个地址值，因此能够直接修改内部的值。但是这种修改会导致数据流变得混乱而难以理解</h4>
<pre><code class="hljs language-直接修改props中的对象或者数组内部的值" lang="直接修改props中的对象或者数组内部的值">&lt;script setup lang="ts"&gt;
import { onMounted } from "vue";
const props = defineProps({
  arrList: Array,
  objList: Object,
});
onMounted(() =&gt; {
  props.arrList[0].salary = 400;
  props.objList.name = "王五";
  console.log(props.arrList[0].salary);
  console.log(props.objList.name);
});
&lt;/script&gt;
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb6d78da29df4ab3ba9a13a64128586a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbm5ubm5h:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039766&amp;x-signature=Zr5vMR8QBsYUFoSbJ0XhhrMrjMI%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-10">3.重新定义一个ref或者computed来间接修改props的值</h4>
<p>3.1 重新定义一个ref</p>
<pre><code class="hljs language-重新定义一个ref" lang="重新定义一个ref">&lt;script setup lang="ts"&gt;
import { ref, onMounted } from "vue";
const props = defineProps({
  num: Number,
  name: String,
  isShow: Boolean,
  arrList: Array,
  objList: Object,
});
const newNum = ref(props.num);
const newName = ref(props.name);
const newIsShow = ref(props.isShow);
const newArrList = ref(props.arrList);
const newObjList = ref(props.objList);
onMounted(() =&gt; {
  newNum.value = 456;
  newName.value = "李四";
  newIsShow.value = false;
  newArrList.value[0].salary = 400;
  newObjList.value.name = "王五";
  console.log(newNum.value);
  console.log(newName.value);
  console.log(newIsShow.value);
  console.log(newArrList.value[0].salary);
  console.log(newObjList.value.name);
});
&lt;/script&gt;
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af6e778c491e46a1a8fc8fffc8df5f57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbm5ubm5h:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039766&amp;x-signature=fbsNV%2FR4%2BQ%2BMv2VQmrivcJnh8CI%3D" alt="image.png" loading="lazy"/></p>
<p>3.2 重新定义一个computed</p>
<pre><code class="hljs language-定义一个computed" lang="定义一个computed">&lt;script setup lang="ts"&gt;
import { computed, onMounted } from "vue";
const props = defineProps({
  num: Number,
  isShow: Boolean,
});
const newNum = computed(() =&gt; {
  return props.num + 1;
});
const newIsShow = computed(() =&gt; {
  return !props.isShow;
});
onMounted(() =&gt; {
  console.log(newNum.value);
  console.log(newIsShow.value);
});
&lt;/script&gt;
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2709ddc5e5f4aa79b2e8def7df6b9e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbm5ubm5h:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039766&amp;x-signature=E%2BFsAyyaoUm11sHSOgzbwgg%2FApk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-11">emits (子组件 -&gt; 父组件通信)</h2>
<h3 data-id="heading-12">一、模板表达式中直接使用emit</h3>
<pre><code class="hljs language-模板表达式中直接使用emit" lang="模板表达式中直接使用emit">&lt;template&gt;
  &lt;div&gt;
    &lt;button @click="$emit('test', testValue)"&gt;按钮&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from "vue";
const testValue = ref("张三");
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-13">二、显式的通过defineEmits声明</h3>
<pre><code class="hljs language-通过defineEmits显式声明" lang="通过defineEmits显式声明">&lt;template&gt;
  &lt;div&gt;
    &lt;button @click="handleTestEmit"&gt;按钮&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from "vue";
const testValue = ref("张三");

const emit = defineEmits(["test"]);

const handleTestEmit = () =&gt; {
  emit("test", testValue.value);
};
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-14">三、defineEmits结合TS进行类型声明</h3>
<pre><code class="hljs language-TS类型声明" lang="TS类型声明">&lt;template&gt;
  &lt;div&gt;
    &lt;button @click="handleTestEmit"&gt;按钮&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from "vue";
const testValue = ref("张三");

interface Emit {
  (e: "test", value: string): void;
}
const emit = defineEmits&lt;Emit&gt;();

const handleTestEmit = () =&gt; {
  emit("test", testValue.value);
};
&lt;/script&gt;
</code></pre>
<h2 data-id="heading-15">组件上的v-model</h2>
<h3 data-id="heading-16">一、绑定单个v-model</h3>
<pre><code class="hljs language-绑定单个v-model" lang="绑定单个v-model">&lt;template&gt;
  &lt;div&gt;
    &lt;TestCom v-model="testValue" /&gt;
    &lt;!-- 等价于：&lt;TestCom :modelValue="testValue" @update:modelValue="testValue = $event" /&gt; --&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>在父组件上绑定v-model，等同于向子组件内部传入了一个名为modelValue的props，并且监听一个update:modelValue事件并赋值，因此需要在子组件内部定义一个props去接收这个modelValue，并且通过emit给父组件发送一个@update:modelValue事件</p>
<pre><code class="hljs language-子组件定义prop和emit" lang="子组件定义prop和emit">&lt;template&gt;
  &lt;div&gt;
    &lt;input :value="modelValue" @input="handleEmit" /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
const prop = defineProps(["modelValue"]);
const emit = defineEmits(["update:modelValue"]);

const handleEmit = (e) =&gt; {
  emit("update:modelValue", e.target.value);
};
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-17">二、绑定多个v-model</h3>
<pre><code class="hljs language-绑定多个v-model" lang="绑定多个v-model">&lt;template&gt;
  &lt;div&gt;
    &lt;TestCom
      v-model:one="testValue1"
      v-model:two="testValue2"
      v-model:three="testValue3"
    /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import TestCom from "./components/index.vue";
import { ref } from "vue";
const testValue1 = ref();
const testValue2 = ref();
const testValue3 = ref();
&lt;/script&gt;
</code></pre>
<p>当我们需要在一个组件上绑定多个v-model时，需要我们自定义每个v-model传入的props名字</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"one"</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">"handleEmitOne"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"two"</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">"handleEmitTwo"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"three"</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">"handleEmitThree"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> prop = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">"one"</span>, <span class="hljs-string">"two"</span>, <span class="hljs-string">"three"</span>]);
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">"update:one"</span>, <span class="hljs-string">"update:two"</span>, <span class="hljs-string">"update:three"</span>]);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleEmitOne</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">"update:one"</span>, e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
};
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleEmitTwo</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">"update:two"</span>, e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
};
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleEmitThree</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">"update:three"</span>, e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[H5回调页开发与调试复盘]]></title>    <link>https://juejin.cn/post/7582118218649534490</link>    <guid>https://juejin.cn/post/7582118218649534490</guid>    <pubDate>2025-12-11T06:35:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582118218649534490" data-draft-id="7582156410319781898" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="H5回调页开发与调试复盘"/> <meta itemprop="keywords" content="微信小程序"/> <meta itemprop="datePublished" content="2025-12-11T06:35:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Gracemark"/> <meta itemprop="url" content="https://juejin.cn/user/184373684482216"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            H5回调页开发与调试复盘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/184373684482216/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Gracemark
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:35:08.000Z" title="Thu Dec 11 2025 06:35:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">H5回调页开发与调试复盘</h2>
<h3 data-id="heading-1">1. 问题背景与需求分析</h3>
<h4 data-id="heading-2">1.1 原始需求</h4>
<p>开发一个H5环境下的签约回调页面，实现签约成功/失败后的自动跳转功能，支持不同回调类型（签约类型、人脸认证类型），并确保在微信小程序、微信浏览器和普通浏览器环境下都能正常工作。</p>
<h4 data-id="heading-3">1.2 遇到的问题</h4>
<ul>
<li><strong>H5环境签约跳转失败</strong>：用户在完成签约后无法正确跳转到目标页面</li>
<li><strong>缺少必要参数错误</strong>：系统提示"缺少必要参数：callback"</li>
<li><strong>URL路径异常</strong>：跳转URL中包含"undefined"（如<code>https://testgong.jiandankongjian.com/callback/undefined</code>）</li>
<li><strong>参数传递错误</strong>：调试数据显示参数值异常（如<code>callbacktype=contractType%2F</code>）</li>
</ul>
<h3 data-id="heading-4">2. 开发与调试过程</h3>
<h4 data-id="heading-5">2.1 代码结构分析</h4>
<p>首先对现有的回调配置文件<code>callback-config.html</code>进行了全面分析，重点关注：</p>
<ul>
<li><code>handleCallback()</code>：主流程函数，负责参数处理和环境判断</li>
<li><code>executeInH5()</code>：H5环境下的跳转逻辑实现</li>
<li><code>executeInMiniProgram()</code>：小程序环境下的跳转逻辑</li>
<li><code>getUrlParams()</code>：URL参数获取函数</li>
<li><code>buildTargetPath()</code>：目标路径构建函数</li>
<li><code>detectWeChat()</code>：环境检测函数</li>
</ul>
<h4 data-id="heading-6">2.2 问题定位</h4>
<p>通过查看代码和添加调试信息，逐步定位到以下关键问题：</p>
<ol>
<li>
<p><strong>无data参数时跳转路径未正确设置</strong>：在<code>executeInH5()</code>函数中，当缺少data参数时，h5TargetUrl未被正确赋值</p>
</li>
<li>
<p><strong>URL路径参数提取问题</strong>：当URL路径中包含"undefined"时，无法正确获取callback参数</p>
</li>
<li>
<p><strong>参数值引用错误</strong>：在构建跳转URL时，similarity参数错误地使用了liveRate的值</p>
</li>
<li>
<p><strong>回调类型参数格式问题</strong>：callbacktype参数值包含末尾斜杠（如<code>contractType/</code>），导致精确匹配失败</p>
</li>
</ol>
<h4 data-id="heading-7">2.3 解决方案实现</h4>
<h5 data-id="heading-8">2.3.1 修复无data参数时的跳转路径</h5>
<p>在<code>executeInH5()</code>函数中添加了data参数不存在时的处理逻辑：</p>
<pre><code class="hljs language-javascript" lang="javascript">} <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'loadingText'</span>).<span class="hljs-property">textContent</span> += <span class="hljs-string">'没有data参数，使用buildTargetPath构建路径...\n'</span>;  
    <span class="hljs-comment">// 没有data参数，使用buildTargetPath构建路径</span>
    <span class="hljs-keyword">const</span> targetPath = <span class="hljs-title function_">buildTargetPath</span>(programConfig, {
        <span class="hljs-attr">taskId</span>: params.<span class="hljs-property">taskId</span> || <span class="hljs-string">''</span>,
        <span class="hljs-attr">orderId</span>: params.<span class="hljs-property">orderId</span> || <span class="hljs-string">''</span>,
        <span class="hljs-attr">status</span>: params.<span class="hljs-property">status</span> || <span class="hljs-string">''</span>,
        <span class="hljs-attr">faceOrderNo</span>: params.<span class="hljs-property">faceOrderNo</span> || <span class="hljs-string">''</span>,
        <span class="hljs-attr">faceId</span>: params.<span class="hljs-property">faceId</span> || <span class="hljs-string">''</span>,
        <span class="hljs-attr">signNo</span>: params.<span class="hljs-property">signNo</span> || <span class="hljs-string">''</span>
    }, params);
    h5TargetUrl = currentDomain + <span class="hljs-string">'/#'</span> + targetPath;
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'loadingText'</span>).<span class="hljs-property">textContent</span> += <span class="hljs-string">`buildTargetPath构建的路径: <span class="hljs-subst">${targetPath}</span>\n`</span>;
}
</code></pre>
<h5 data-id="heading-9">2.3.2 添加URL路径参数提取</h5>
<p>在<code>handleCallback()</code>函数中添加了从路径提取callback参数的逻辑：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 检查当前URL路径，如果路径中包含undefined，尝试从路径中提取callback参数</span>
<span class="hljs-keyword">const</span> currentPath = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>;
<span class="hljs-keyword">if</span> (currentPath.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'/undefined'</span>)) {
    <span class="hljs-comment">// 从路径中提取callback参数</span>
    <span class="hljs-keyword">const</span> pathParts = currentPath.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>);
    <span class="hljs-keyword">const</span> callbackFromPath = pathParts[pathParts.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
    <span class="hljs-keyword">if</span> (callbackFromPath &amp;&amp; callbackFromPath !== <span class="hljs-string">'undefined'</span>) {
        params.<span class="hljs-property">callback</span> = callbackFromPath;
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'loadingText'</span>).<span class="hljs-property">textContent</span> += <span class="hljs-string">`\n从路径提取callback参数: <span class="hljs-subst">${callbackFromPath}</span>`</span>;
    }
}
</code></pre>
<h5 data-id="heading-10">2.3.3 修复参数引用错误</h5>
<p>将similarity参数的错误引用从data.liveRate改为data.similarity：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (data.<span class="hljs-property">similarity</span>) h5TargetUrl += (h5TargetUrl.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'?'</span>) ? <span class="hljs-string">'&amp;'</span> : <span class="hljs-string">'?'</span>) + <span class="hljs-string">'similarity='</span> + <span class="hljs-built_in">encodeURIComponent</span>(data.<span class="hljs-property">similarity</span>);
</code></pre>
<h5 data-id="heading-11">2.3.4 修复回调类型参数格式</h5>
<p>在<code>buildTargetPath()</code>函数中添加了对callbacktype参数的特殊处理：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 补充其他URL参数</span>
<span class="hljs-keyword">if</span> (allUrlParams) {
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(allUrlParams).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (!excludeKeys.<span class="hljs-title function_">includes</span>(key) &amp;&amp; !keys.<span class="hljs-title function_">includes</span>(key) &amp;&amp; allUrlParams[key]) {
            <span class="hljs-comment">// 特殊处理callbacktype参数，确保其值不包含末尾的/字符</span>
            <span class="hljs-keyword">let</span> value = allUrlParams[key];
            <span class="hljs-keyword">if</span> (key === <span class="hljs-string">'callbacktype'</span>) {
                value = value.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\/$/</span>, <span class="hljs-string">''</span>);
            }
            queryParams.<span class="hljs-title function_">push</span>(<span class="hljs-string">`<span class="hljs-subst">${key}</span>=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(value)}</span>`</span>);
        }
    });
}
</code></pre>
<h3 data-id="heading-12">3. 调试策略与工具</h3>
<h4 data-id="heading-13">3.1 页面调试信息</h4>
<p>在关键函数中添加了详细的调试信息显示，帮助实时查看参数状态和执行流程：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'loadingText'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">`URL参数: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(params)}</span>`</span>;
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'loadingText'</span>).<span class="hljs-property">textContent</span> += <span class="hljs-string">`\n环境检测: 微信=<span class="hljs-subst">${env.isWeChat}</span>, 小程序=<span class="hljs-subst">${env.isMiniProgram}</span>`</span>;
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'loadingText'</span>).<span class="hljs-property">textContent</span> += <span class="hljs-string">`\n当前URL: <span class="hljs-subst">${<span class="hljs-variable language_">window</span>.location.href}</span>`</span>;
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'loadingText'</span>).<span class="hljs-property">textContent</span> += <span class="hljs-string">`\ncallbackType: <span class="hljs-subst">${callbackType}</span>`</span>;
</code></pre>
<h4 data-id="heading-14">3.2 测试页面开发</h4>
<p>创建了<code>test-h5-debug.html</code>测试页面，模拟不同场景的回调参数，方便快速测试和验证修复效果：</p>
<ul>
<li>签约成功场景</li>
<li>签约失败场景</li>
<li>无data参数场景</li>
<li>路径参数场景（模拟undefined问题）</li>
<li>人脸认证成功/失败场景</li>
</ul>
<h3 data-id="heading-15">4. 经验教训与改进建议</h3>
<h4 data-id="heading-16">4.1 经验教训</h4>
<ol>
<li>
<p><strong>调试信息的重要性</strong>：添加详细的调试信息可以大大提高问题定位效率，尤其是在复杂的环境判断和参数处理场景中</p>
</li>
<li>
<p><strong>边界情况处理</strong>：必须考虑各种边界情况，如参数缺失、格式错误、URL路径异常等</p>
</li>
<li>
<p><strong>参数校验与标准化</strong>：对输入参数进行校验和标准化处理，可以避免因参数格式问题导致的功能故障</p>
</li>
<li>
<p><strong>环境兼容性</strong>：不同环境（小程序、微信浏览器、普通浏览器）的API和行为差异较大，需要充分测试</p>
</li>
<li>
<p><strong>代码规范性</strong>：保持良好的代码格式和可读性，有助于后续维护和问题排查</p>
</li>
</ol>
<h4 data-id="heading-17">4.2 改进建议</h4>
<ol>
<li>
<p><strong>参数验证增强</strong>：添加更严格的参数验证逻辑，对必填参数进行检查并提供清晰的错误提示</p>
</li>
<li>
<p><strong>错误处理优化</strong>：完善错误处理机制，记录详细的错误日志，便于问题追踪</p>
</li>
<li>
<p><strong>测试覆盖度</strong>：增加自动化测试用例，覆盖不同参数组合、环境和异常场景</p>
</li>
<li>
<p><strong>配置化设计</strong>：将跳转路径、参数映射等配置信息提取到配置文件中，提高代码灵活性</p>
</li>
<li>
<p><strong>性能优化</strong>：减少不必要的参数解析和字符串拼接操作，提高页面加载和跳转速度</p>
</li>
</ol>
<h3 data-id="heading-18">5. 总结</h3>
<p>通过本次回调页的开发与调试，成功解决了H5环境下签约跳转失败的问题，修复了参数处理、路径构建等多个关键bug。整个过程展示了良好的问题定位、分析和解决能力，同时也积累了宝贵的前端调试和跨环境开发经验。在未来的开发中，应进一步加强边界情况处理、参数验证和测试覆盖，提高代码质量和系统稳定性。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e85a08f514034c4f8e8112e8447ac74a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR3JhY2VtYXJr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039708&amp;x-signature=B8XV%2B9c5H%2Fc0y6vFHrSeMJ1IvDc%3D" alt="juejin-2.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53bfa09c35ca49b394db3d85902f4cf2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR3JhY2VtYXJr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039708&amp;x-signature=kjf03Rcwn0ossNEeKvMgpwJi41g%3D" alt="juejin-1.jpg" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1bd637f537e4256906e8234f5a0ac88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR3JhY2VtYXJr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766039708&amp;x-signature=GQpKJxGvRkx8HWES1%2Fz9yWUmwIw%3D" alt="jujin-5.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[麻省理工学院的“冰山计划”揭示了AI对就业的影响远比表面上看起来要大得多]]></title>    <link>https://juejin.cn/post/7582155513586614324</link>    <guid>https://juejin.cn/post/7582155513586614324</guid>    <pubDate>2025-12-11T06:46:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582155513586614324" data-draft-id="7582096212663877632" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="麻省理工学院的“冰山计划”揭示了AI对就业的影响远比表面上看起来要大得多"/> <meta itemprop="keywords" content="OpenAI,AIGC,Agent"/> <meta itemprop="datePublished" content="2025-12-11T06:46:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="安思派Anspire"/> <meta itemprop="url" content="https://juejin.cn/user/3044964115417419"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            麻省理工学院的“冰山计划”揭示了AI对就业的影响远比表面上看起来要大得多
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3044964115417419/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    安思派Anspire
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:46:03.000Z" title="Thu Dec 11 2025 06:46:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>麻省理工学院（MIT）的一项新模型显示，人工智能（AI）对工作的改变速度超过了政府、企业或劳动者的应对能力，而且它影响的工作岗位数量将远远超过大多数人的想象。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f887e5673e2643dea040c6d412a0550b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6J5oCd5rS-QW5zcGlyZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766040363&amp;x-signature=N0ePhvpSUevG%2BqA2o3nk%2BhMx6%2Fw%3D" alt="" loading="lazy"/></p>
<p>由DALL-E生成的图像</p>
<p>作为一个在技术（包括AI，因为我拥有多项与AI相关的专利并开发过AI产品）和职业发展两方面都有专长的人，我在观察AI对劳动力市场的影响方面有着独特的视角。我在多篇文章中广泛探讨过这个问题，但归根结底，主要有三个核心观点。</p>
<ol>
<li>
<p>这不是关于AI取代整个工作岗位，而是关于逐步改进工作的某些部分以提高效率；这将减少该岗位所需的人员数量（见 “<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.thecareertoolkitbook.com%2Fblog%2Fwhy-ai-isnt-yet-ready-to-take-your-job" target="_blank" title="https://www.thecareertoolkitbook.com/blog/why-ai-isnt-yet-ready-to-take-your-job" ref="nofollow noopener noreferrer">为什么AI（目前）还不准备取代你的工作</a>”）。</p>
</li>
<li>
<p>变革的步伐将是前所未有的（见 “<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.thecareertoolkitbook.com%2Fblog%2Fno-ai-isnt-going-to-kill-you-but-it-will-cause-social-unrest-part-1" target="_blank" title="https://www.thecareertoolkitbook.com/blog/no-ai-isnt-going-to-kill-you-but-it-will-cause-social-unrest-part-1" ref="nofollow noopener noreferrer">不，AI不会杀了你，但它会引发社会动荡——第一部分</a>”）。</p>
</li>
<li>
<p>微小的变化，那些我们很可能会误判，甚至完全忽略的变化，将产生巨大的影响（见 “<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.thecareertoolkitbook.com%2Fblog%2Fthe-coming-ai-recession-looking-over-the-cliff-of-technological-based-job-loss" target="_blank" title="https://www.thecareertoolkitbook.com/blog/the-coming-ai-recession-looking-over-the-cliff-of-technological-based-job-loss" ref="nofollow noopener noreferrer">即将到来的 AI 衰退：审视基于技术的失业悬崖</a>” 和 “<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.thecareertoolkitbook.com%2Fblog%2Fthe-path-to-hell-is-paved-with-ai" target="_blank" title="https://www.thecareertoolkitbook.com/blog/the-path-to-hell-is-paved-with-ai" ref="nofollow noopener noreferrer">通往地狱的道路是由 AI 铺就的</a>”）。</p>
</li>
</ol>
<p>最近，我撰写了文章“<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.thecareertoolkitbook.com%2Fblog%2Fthe-canary-in-the-code-mine-what-techs-job-slump-means-for-the-rest-of-us" target="_blank" title="https://www.thecareertoolkitbook.com/blog/the-canary-in-the-code-mine-what-techs-job-slump-means-for-the-rest-of-us" ref="nofollow noopener noreferrer">代码矿井中的金丝雀：科技行业的就业低迷对我们其他人意味着什么</a>”，分析了科技行业就业的现状，以及科技如何成为其他行业问题的领先指标。现在来看看<a href="https://link.juejin.cn?target=https%3A%2F%2Ficeberg.mit.edu%2F" target="_blank" title="https://iceberg.mit.edu/" ref="nofollow noopener noreferrer">麻省理工学院（MIT）的冰山项目</a>，该项目刚刚发布了一份题为“<a href="https://link.juejin.cn?target=https%3A%2F%2Ficeberg.mit.edu%2Freport.pdf" target="_blank" title="https://iceberg.mit.edu/report.pdf" ref="nofollow noopener noreferrer">冰山指数：衡量人工智能（AI）经济中以技能为中心的风险敞口</a>”的报告。他们的研究采用了非常复杂的方法、详细的建模，并为类似预测提供了更为严谨的分析。我通常不会撰写只是总结他人工作的文章，但像这样有影响力的研究值得报道。</p>
<p>在《<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.thecareertoolkitbook.com%2Fblog%2Fthe-canary-in-the-code-mine-what-techs-job-slump-means-for-the-rest-of-us" target="_blank" title="https://www.thecareertoolkitbook.com/blog/the-canary-in-the-code-mine-what-techs-job-slump-means-for-the-rest-of-us" ref="nofollow noopener noreferrer">代码矿中的金丝雀：科技行业的就业低迷对我们其他人意味着什么</a>》一文中，我指出科技行业的工作岗位和客服中心一样，是最早受到AI进步影响的领域之一。报告作者指出，“AI系统如今每天编写的代码超过10亿行，超过了人类开发者的产出”。（公平地说，关于这类代码的长期影响仍存在有趣的争论； 我会在未来的文章中详细介绍。）但这只是冰山一角，而这正是项目名称背后的动机所在；真正的影响将大得多、大得多。</p>
<p>在这项研究中，他们将工作拆解为超过32000种不同的技能。然后，他们对3000个县的923种职业中的1.51亿名工人进行了建模；每名工人都被建模为一个智能体（换句话说，模拟中有1.51亿个不同的实体）。通过基于智能体的建模（这本身是一种AI，但与大语言模型不同），他们可以对技术和政策变化如何影响劳动力市场进行预测。主要结论如下。</p>
<p>首先，作者们认为我们目前无法准确衡量AI的影响； 像GDP和失业率这样现有的指标是不够的。举个例子（这是我举的例子，不是报告中的例子），在工业时代，我们会统计工厂的数量、在这些工厂就业的人数以及这些工厂的产出。例如，随着汽车行业实现自动化，我们可以看到某一年每生产一辆汽车所需的工人比例。我们没有衡量AI正在产生多少经济产出的方法。经济学家通过观察新型电视，将其与旧型号进行比较，并确定新型电视的改进程度，以此来衡量生产率的提高。他们可以比较不同年份生产的两种产品，并衡量其改进情况（即使这并非一门精确的科学）。当AI自动处理一些医疗文书工作，让医护人员有更多时间照顾患者时，我们目前还没有办法衡量这一点。由于大语言模型正在影响服务业，我们无法像衡量实物商品那样轻松地衡量它。</p>
<p>其次，适应这种变化将困难得多。他们写道，“有证据表明，劳动力的变化速度比规划周期所能适应的速度更快”。再加上上述缺乏适当数据的情况，这意味着政策制定者在盲目行事。多年来我一直主张，我们需要对劳动力进行大规模再培训，这需要公共部门和私营部门共同努力。但如果对变化和需求缺乏适当的了解，相关计划的制定就会更慢，而且/或者会出现偏差。</p>
<p>第三点，或许也是最重要的一点，就是冰山本身。众所周知，冰山大部分的质量都隐藏在水线以下。在海洋中看似相对较小的冰山，实际上要大得多，只是看不见而已。这就是这里的主要问题所在。</p>
<p>研究人员指出，“科技行业在标准普尔500指数的市值中占比超过30%，但在劳动力中仅占约6%”。我们已经知道科技行业的从业者日子不好过。更重要的是，他们写道，“分析显示，集中在计算和技术领域（工资价值的2.2%，约2110亿美元）的可见AI应用只是冰山一角。通过跨越行政、金融和专业服务的认知自动化，技术能力在表面之下延伸得更深（11.7%，约1.2万亿美元）”。换句话说，这些科技从业者只是冰山一角。其他专业服务才是隐藏在水下的部分，对劳动力市场的影响要大得多。</p>
<p>研究人员创建了“冰山指数”来衡量对劳动力的可见影响与隐藏影响的比率。上述数据简洁地表述为：“数字AI的冰山指数平均值为11.7%，是2.2%的表面指数的五倍。”换句话说，问题的规模比目前看起来大约大五倍。</p>
<p>需要注意的是，该研究明确指出，“验证是相关性而非因果性的”。这意味着从技术上讲，它并没有证明AI的改进或政策导致了这些结果，仅仅表明它们存在相关性。尽管如此，相信它们存在因果关系似乎是合理的，因为因果机制很直接且易于理解。至少，我们不能忽视如此规模的影响，坐等因果关系得到证明。</p>
<p>报告中未提及、我也认为模型中未考虑到的，是次生效应。例如，假设一个商业园区将在那里工作的员工数量削减三分之一。这意味着为员工提供支持的企业，如清洁服务、当地午餐场所、下班后的酒吧等，都会看到收入下降，并可能经历连锁裁员。理论上，减少员工节省下来的资金只会转移到使用AI的公司的股东以及AI公司本身的股东手中。不幸的是，涓滴经济学已被证明是海市蜃楼。即使它确实有效，我在之前的文章中也论证过，失业和创造就业之间会有显著的延迟，可能长达数年（可能多达五到十年）。值得注意的是，冰山指数对于以低技术劳动力为起点的美国各州尤为重要，因为这些州在隐藏在水下的冰山部分的劳动力占比最大。</p>
<p>简而言之，AI的影响可能比大多数人想象的更大、更快到来。大语言模型（LLMs）已经在创造采用记录，这意味着采用带来的影响也将创下纪录。即使你的工作今天没有受到影响，很快也可能会受到影响，直接或间接。</p>
<p>社会需要做好准备。自“大萧条”以来，我们比以往任何时候都更需要完善的社会安全网，以及对再培训和创业的支持。地方、州和联邦政府需要制定税收政策，以弥补工资收入的损失。重要的是，这些新的收入来源将为所需的再培训提供资金。在“大衰退”期间，我在纽约州立大学莱文学院任教，参与了一个由纽约市经济发展委员会资助的项目，为那些失去工作且工作不会再恢复的专业人士提供再培训。我们需要在全国范围内开展类似的项目，而且今天就需要开始试点这些项目。</p>
<p>个人需要认识到，他们向公司提供的价值主张将会转变。正如我在《<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.thecareertoolkitbook.com%2Fblog%2Fteach-your-kids-to-program-but-dont-teach-them-to-be-programmers" target="_blank" title="https://www.thecareertoolkitbook.com/blog/teach-your-kids-to-program-but-dont-teach-them-to-be-programmers" ref="nofollow noopener noreferrer">教你的孩子编程，但不要教他们成为程序员</a>》中所写的那样，你工作中可以被自动化的部分将不再能让你在劳动力市场中脱颖而出（编程只是一个例子，这篇文章总体上是关于面对AI时的技能）。加强你的沟通、团队合作、领导能力、人脉拓展和其他专业技能，将是在变革的浪潮中保持领先的关键。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CentOS7/8在线yum源自动设置]]></title>    <link>https://juejin.cn/post/7582246395986427938</link>    <guid>https://juejin.cn/post/7582246395986427938</guid>    <pubDate>2025-12-11T06:41:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582246395986427938" data-draft-id="7582133314687336500" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CentOS7/8在线yum源自动设置 "/> <meta itemprop="keywords" content="CentOS"/> <meta itemprop="datePublished" content="2025-12-11T06:41:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="用户722786812344"/> <meta itemprop="url" content="https://juejin.cn/user/4100515739233513"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CentOS7/8在线yum源自动设置 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4100515739233513/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    用户722786812344
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:41:25.000Z" title="Thu Dec 11 2025 06:41:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. 前提说明</h2>
<p>CentOS7/8版本官方已经归档，默认的安装源无法使用，而且网上大多数提供的国内yum地址也大部分失效。故为了快速有效的使用在线yum，结合国内清华源，来生成有效的repo文件，帮助实施人员解决手动配置慢等问题。</p>
<h2 data-id="heading-1">2. 使用方法</h2>
<p>核心命令：</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">root@localhost soft</span>]<span class="hljs-meta"># wget  https://raw.githubusercontent.com/FlowerBirds/centosv7v8-china-repo/refs/heads/main/install-repo.py</span>
[<span class="hljs-meta">root@localhost soft</span>]<span class="hljs-meta"># python install-repo.py</span>
</code></pre>
<p>默认使用Linux自带的Python2环境执行脚本，会自动检测当前系统版本，并生成repo文件。例如：</p>
<pre><code class="hljs language-bash" lang="bash">[root@localhost soft]<span class="hljs-comment"># wget https://raw.githubusercontent.com/FlowerBirds/centosv7v8-china-repo/refs/heads/main/install-repo.py</span>
--2025-12-10 16:46:52-- https://www.falvce.com/ https://raw.githubusercontent.com/FlowerBirds/centosv7v8-china-repo/refs/heads/main/install-repo.py
正在解析主机 raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.109.133, 185.199.110.133, 185.199.111.133, ...
正在连接 raw.githubusercontent.com (raw.githubusercontent.com)|185.199.109.133|:443... 已连接。
已发出 HTTP 请求，正在等待回应... 200 OK
长度：9144 (8.9K) [text/plain]
正在保存至: “install-repo.py”

100%[========================================================================================================================================================&gt;] 9,144       --.-K/s 用时 0.003s

2025-12-10 16:46:52 (2.69 MB/s) - 已保存 “install-repo.py” [9144/9144])

[root@localhost soft]<span class="hljs-comment"># python install-repo.py</span>
⚠️  警告：当前为Python2环境，建议使用Python3运行（Python2已停止维护）

===== 开始备份YUM源配置 =====
已备份：/etc/yum.repos.d/CentOS-Base.repo -&gt; /etc/yum.repos.d/repo_bak_20251210_160331/CentOS-Base.repo
已备份：/etc/yum.repos.d/test.repo -&gt; /etc/yum.repos.d/repo_bak_20251210_160331/test.repo
所有.repo文件已备份至：/etc/yum.repos.d/repo_bak_20251210_160331

===== 开始识别系统版本 =====
已识别系统版本：CentOS 7.9.2009

===== 开始生成清华Vault源 =====
✅ 成功生成CentOS 7.9.2009的清华源配置：/etc/yum.repos.d/CentOS-Base.repo

===== 操作完成 =====
📁 原有配置备份目录：https://www.falvce.com/ /etc/yum.repos.d/repo_bak_20251210_160331
🔧 建议执行以下命令刷新缓存：
   yum clean all &amp;&amp; yum makecache
   yum repolist enabled
[root@localhost soft]<span class="hljs-comment">#</span>
[root@localhost soft]<span class="hljs-comment"># yum clean all &amp;&amp; yum makecache</span>
已加载插件：fastestmirror, langpacks
正在清理软件源： base extras updates
Cleaning up list of fastest mirrors
Other repos take up 169 M of disk space (use --verbose <span class="hljs-keyword">for</span> details)
已加载插件：fastestmirror, langpacks
Determining fastest mirrors
base                                                                                                                                                                       | 3.6 kB  00:00:00
extras                                                                                                                                                                     | 2.9 kB  00:00:00
updates                                                                                                                                                                    | 2.9 kB  00:00:00
(1/10): base/x86_64/group_gz                                                                                                                                               | 153 kB  00:00:00
(2/10): base/x86_64/primary_db                                                                                                                                             | 6.1 MB  00:00:02
(3/10): extras/x86_64/primary_db                                                                                                                                           | 253 kB  00:00:00
(4/10): base/x86_64/other_db                                                                                                                                               | 2.6 MB  00:00:01
(5/10): extras/x86_64/filelists_db                                                                                                                                         | 305 kB  00:00:01
(6/10): extras/x86_64/other_db                                                                                                                                             | 154 kB  00:00:00
(7/10): base/x86_64/filelists_db                                                                                                                                           | 7.2 MB  00:00:04
(8/10): updates/x86_64/primary_db                                                                                                                                          |  27 MB  00:00:09
(9/10): updates/x86_64/filelists_db                                                                                                                                        |  15 MB  00:00:10
(10/10): updates/x86_64/other_db                                                                                                                                           | 1.6 MB  00:00:00
元数据缓存已建立
[root@localhost soft]<span class="hljs-comment">#  yum repolist enabled</span>
已加载插件：fastestmirror, langpacks
Loading mirror speeds from cached hostfile
源标识                                                                          源名称                                                                                                      状态
base/x86_64                                                                     CentOS-7.9.2009 - Base - Tsinghua Vault                                                                     10,072
extras/x86_64                                                                   CentOS-7.9.2009 - Extras - Tsinghua Vault                                                                      526
updates/x86_64                                                                  CentOS-7.9.2009 - Updates - Tsinghua Vault                                                                   6,173
repolist: 16,771
</code></pre>
<p>执行成功后，提示执行命令即可。脚本会将之前的repo文件进行备份，不影响后续还原。</p>
<p>脚本仓库地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FFlowerBirds%2Fcentosv7v8-china-repo" target="_blank" title="https://github.com/FlowerBirds/centosv7v8-china-repo" ref="nofollow noopener noreferrer">github.com/FlowerBirds…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vite开发环境按需编译是怎么实现的？]]></title>    <link>https://juejin.cn/post/7582169248094978054</link>    <guid>https://juejin.cn/post/7582169248094978054</guid>    <pubDate>2025-12-11T06:55:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582169248094978054" data-draft-id="7582169248094945286" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vite开发环境按需编译是怎么实现的？"/> <meta itemprop="keywords" content="前端,JavaScript,Vite"/> <meta itemprop="datePublished" content="2025-12-11T06:55:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sorryhc"/> <meta itemprop="url" content="https://juejin.cn/user/3061476130044487"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vite开发环境按需编译是怎么实现的？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3061476130044487/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sorryhc
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T06:55:02.000Z" title="Thu Dec 11 2025 06:55:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p><code>Vite</code>的快，我们并不陌生，主要体现在开发环境时的体验。</p>
<p>而相较于其他构建工具，<code>Vite</code>核心是依靠了现代浏览器对于原生<code>esm</code>模块的支持+按需实时编译将性能达到了极致。</p>
<p>我们基于源码来看看<code>esbuild</code>编译的完整过程。</p>
<h2 data-id="heading-1">核心流程图</h2>
<pre><code class="hljs language-bash" lang="bash">Browser Request
    ↓
Vite DevServer (Connect 中间件)
    ↓
请求路由判断
    ├─ /.vite/client → 注入客户端代码
    ├─ /@modules/* → node_modules 导入
    ├─ /src/* → 源代码文件
    └─ *.json, *.css 等 → 特殊处理
    ↓
ModuleGraph 缓存检查
    ├─ 命中缓存 → 返回
    └─ 未命中 → esbuild 编译
    ↓
TransformPlugin 流程
    ├─ pre plugins
    ├─ esbuild transform
    └─ post plugins
    ↓
发送给浏览器 (ES Modules)
</code></pre>
<h3 data-id="heading-2">DevServer入口代码</h3>
<p>这里初始化了开发服务器、模块图（缓存系统）、很多中间件（用于拦截实时编译）。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// packages/vite/src/node/server/index.ts</span>

<span class="hljs-keyword">import</span> connect <span class="hljs-keyword">from</span> <span class="hljs-string">'connect'</span>
<span class="hljs-keyword">import</span> { createPluginContainer } <span class="hljs-keyword">from</span> <span class="hljs-string">'./pluginContainer'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createServer</span>(<span class="hljs-params">inlineConfig: InlineConfig = {}</span>) {
  <span class="hljs-keyword">const</span> config = <span class="hljs-keyword">await</span> <span class="hljs-title function_">resolveConfig</span>(inlineConfig, <span class="hljs-string">'serve'</span>)
  
  <span class="hljs-comment">// 创建 Express-like 应用</span>
  <span class="hljs-keyword">const</span> middlewares = <span class="hljs-title function_">connect</span>()
  <span class="hljs-keyword">const</span> httpServer = <span class="hljs-title function_">createHttpServer</span>(middlewares)
  
  <span class="hljs-comment">// 创建模块图（缓存系统）</span>
  <span class="hljs-keyword">const</span> moduleGraph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleGraph</span>(<span class="hljs-function">(<span class="hljs-params">url</span>) =&gt;</span>
    pluginContainer.<span class="hljs-title function_">resolveId</span>(url)
  )
  
  <span class="hljs-comment">// 创建插件容器（执行插件）</span>
  <span class="hljs-keyword">const</span> pluginContainer = <span class="hljs-keyword">await</span> <span class="hljs-title function_">createPluginContainer</span>(config)
  
  <span class="hljs-comment">// 核心中间件们</span>
  middlewares.<span class="hljs-title function_">use</span>(timeMiddleware)
  middlewares.<span class="hljs-title function_">use</span>(cors)
  middlewares.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">transformMiddleware</span>(server))  <span class="hljs-comment">// ⭐ 重点</span>
  middlewares.<span class="hljs-title function_">use</span>(servePublicDir)
  middlewares.<span class="hljs-title function_">use</span>(serveRawFs)
  
  <span class="hljs-keyword">const</span> server = {
    middlewares,
    httpServer,
    moduleGraph,
    pluginContainer,
    <span class="hljs-attr">ws</span>: <span class="hljs-title function_">createWebSocketServer</span>(httpServer),
    <span class="hljs-comment">// ... 其他属性</span>
  }
  
  <span class="hljs-keyword">return</span> server
}
</code></pre>
<h3 data-id="heading-3">Transform中间件（请求拦截）</h3>
<p>这里是一个很经典的例子，从浏览器发起第一次<code>main.ts</code>请求开始，<code>Vite</code>做了<code>ts</code>文件的转换。</p>
<p>而后续的请求会从<code>main.ts</code>中发起。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// packages/vite/src/node/server/middlewares/transform.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">transformMiddleware</span>(<span class="hljs-params">server: ViteDevServer</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> (<span class="hljs-attr">req</span>: <span class="hljs-title class_">IncomingMessage</span>, <span class="hljs-attr">res</span>: <span class="hljs-title class_">ServerResponse</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">NextFunction</span>) =&gt; {
    <span class="hljs-keyword">if</span> (req.<span class="hljs-property">method</span> !== <span class="hljs-string">'GET'</span> || <span class="hljs-title function_">isSkipped</span>(req.<span class="hljs-property">url</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">next</span>()
    }

    <span class="hljs-keyword">let</span> url = req.<span class="hljs-property">url</span>
    <span class="hljs-keyword">const</span> { pathname, search, hash } = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(url, <span class="hljs-string">`http://<span class="hljs-subst">${req.headers.host}</span>`</span>)
    
    <span class="hljs-comment">// 示例：/src/main.ts?t=123 → /src/main.ts</span>
    url = pathname + search + hash

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// ⭐ 核心：调用加载和转换</span>
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">transformRequest</span>(url, server, {
        <span class="hljs-attr">raw</span>: req.<span class="hljs-property">headers</span>[<span class="hljs-string">'accept'</span>]?.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'application/octet-stream'</span>),
      })

      <span class="hljs-keyword">if</span> (result) {
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">type</span> = <span class="hljs-title function_">isDirectCSSRequest</span>(url) ? <span class="hljs-string">'text/css'</span> : <span class="hljs-string">'application/javascript'</span>
        res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-keyword">type</span>)
        res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Cache-Control'</span>, <span class="hljs-string">'no-cache'</span>)
        res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'ETag'</span>, <span class="hljs-title function_">getEtag</span>(result.<span class="hljs-property">code</span>))
        
        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">end</span>(result.<span class="hljs-property">code</span>)
      }
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-comment">// 错误处理</span>
      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">code</span> === <span class="hljs-string">'ENOENT'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">next</span>()
      }
      <span class="hljs-comment">// HMR 错误通知浏览器</span>
      server.<span class="hljs-property">ws</span>.<span class="hljs-title function_">send</span>({
        <span class="hljs-attr">type</span>: <span class="hljs-string">'error'</span>,
        <span class="hljs-attr">event</span>: <span class="hljs-string">'vite:error'</span>,
        <span class="hljs-attr">err</span>: e,
      })
    }

    <span class="hljs-title function_">next</span>()
  }
}

</code></pre>
<h3 data-id="heading-4">请求转换核心逻辑</h3>
<p>这里是核心的源码转换逻辑，基于源码优先从模块缓存表中取，如果没有才走该模块的首次转换，最后会落到缓存中。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// packages/vite/src/node/server/transformRequest.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">transformRequest</span>(<span class="hljs-params">
  url: <span class="hljs-built_in">string</span>,
  server: ViteDevServer,
  options?: TransformOptions,
</span>) {
  <span class="hljs-comment">// 1️⃣ 获取文件内容 + 元数据</span>
  <span class="hljs-keyword">const</span> { <span class="hljs-attr">code</span>: raw, map } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loadRawRequest</span>(url, server)
  
  <span class="hljs-keyword">let</span> code = raw
  <span class="hljs-keyword">const</span> inMap = map

  <span class="hljs-comment">// 2️⃣ 检查缓存</span>
  <span class="hljs-keyword">const</span> cached = server.<span class="hljs-property">moduleGraph</span>.<span class="hljs-title function_">getModuleByUrl</span>(url)
  <span class="hljs-keyword">if</span> (!server.<span class="hljs-property">config</span>.<span class="hljs-property">command</span> === <span class="hljs-string">'serve'</span> &amp;&amp; cached?.<span class="hljs-property">transformedCode</span>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">code</span>: cached.<span class="hljs-property">transformedCode</span>,
      <span class="hljs-attr">map</span>: cached.<span class="hljs-property">map</span>,
    }
  }

  <span class="hljs-comment">// 3️⃣ 执行插件转换</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> pluginContainer.<span class="hljs-title function_">transform</span>(code, url)
  <span class="hljs-keyword">if</span> (result) {
    code = result.<span class="hljs-property">code</span>
  }

  <span class="hljs-comment">// 4️⃣ 特殊处理：自动导入注入</span>
  <span class="hljs-keyword">if</span> (!options?.<span class="hljs-property">raw</span>) {
    code = <span class="hljs-title function_">injectHelper</span>(code, url)
  }

  <span class="hljs-comment">// 5️⃣ 缓存结果</span>
  server.<span class="hljs-property">moduleGraph</span>.<span class="hljs-title function_">updateModuleInfo</span>(url, {
    <span class="hljs-attr">transformedCode</span>: code,
    <span class="hljs-attr">map</span>: result?.<span class="hljs-property">map</span>,
  })

  <span class="hljs-keyword">return</span> { code, <span class="hljs-attr">map</span>: result?.<span class="hljs-property">map</span> }
}

</code></pre>
<h3 data-id="heading-5">加载原始请求（磁盘读写）</h3>
<p>而加载和编译源码则是直接通过<code>esbuild</code>能力来实现。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// packages/vite/src/node/server/transformRequest.ts</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadRawRequest</span>(<span class="hljs-params">url: <span class="hljs-built_in">string</span>, server: ViteDevServer</span>) {
  <span class="hljs-keyword">let</span> id = <span class="hljs-built_in">decodeURIComponent</span>(<span class="hljs-title function_">parseUrl</span>(url).<span class="hljs-property">pathname</span>)
  
  <span class="hljs-comment">// ⭐ 调用插件的 resolveId hook</span>
  <span class="hljs-keyword">const</span> resolveResult = <span class="hljs-keyword">await</span> server.<span class="hljs-property">pluginContainer</span>.<span class="hljs-title function_">resolveId</span>(id)
  
  <span class="hljs-keyword">if</span> (resolveResult?.<span class="hljs-property">id</span>) {
    id = resolveResult.<span class="hljs-property">id</span>
  }

  <span class="hljs-comment">// 从文件系统读取</span>
  <span class="hljs-keyword">let</span> code = <span class="hljs-keyword">await</span> fs.<span class="hljs-property">promises</span>.<span class="hljs-title function_">readFile</span>(id, <span class="hljs-string">'utf-8'</span>)
  <span class="hljs-keyword">let</span> <span class="hljs-attr">map</span>: <span class="hljs-title class_">SourceMap</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>

  <span class="hljs-comment">// 如果是 TypeScript，用 esbuild 转译</span>
  <span class="hljs-keyword">if</span> (id.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.ts'</span>) || id.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.tsx'</span>)) {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> esbuildService.<span class="hljs-title function_">transform</span>(code, {
      <span class="hljs-attr">loader</span>: <span class="hljs-string">'ts'</span>,
      <span class="hljs-attr">target</span>: <span class="hljs-string">'esnext'</span>,
      <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,
    })
    code = result.<span class="hljs-property">code</span>
    map = result.<span class="hljs-property">map</span>
  }

  <span class="hljs-keyword">return</span> { code, map }
}
</code></pre>
<p>因此一次完整的编译流程如下：</p>
<pre><code class="hljs language-ruby" lang="ruby">/<span class="hljs-regexp">/ 实际请求处理过程

/</span><span class="hljs-regexp">/ 浏览器请求：GET /src</span><span class="hljs-regexp">/main.ts
/</span><span class="hljs-regexp">/ ↓
/</span><span class="hljs-regexp">/ transformMiddleware 拦截
/</span><span class="hljs-regexp">/ ↓
/</span><span class="hljs-regexp">/ transformRequest('/src</span><span class="hljs-regexp">/main.ts', server)
/</span><span class="hljs-regexp">/ ↓
/</span><span class="hljs-regexp">/ loadRawRequest: 从磁盘读取 main.ts
/</span><span class="hljs-regexp">/ ├─ 如果是 .ts，用 esbuild 转译为 .js
/</span><span class="hljs-regexp">/ └─ 返回 { code, map }
/</span><span class="hljs-regexp">/ ↓
/</span><span class="hljs-regexp">/ pluginContainer.transform(code, '/src</span><span class="hljs-regexp">/main.ts')
/</span><span class="hljs-regexp">/ ├─ vue plugin: .vue 转换为 { script, template, style }
/</span><span class="hljs-regexp">/ ├─ css-in-js plugin: 处理 styled-components 等
/</span><span class="hljs-regexp">/ ├─ import-analysis plugin: 分析依赖，重写为 /</span><span class="hljs-variable">@modules</span>/xxx
/<span class="hljs-regexp">/ └─ ...其他插件
/</span><span class="hljs-regexp">/ ↓
/</span><span class="hljs-regexp">/ 返回转换后的代码给浏览器
/</span><span class="hljs-regexp">/ ↓
/</span><span class="hljs-regexp">/ 浏览器 import './main</span>.ts<span class="hljs-string">' 
// → 收到 ESM 代码，正常执行
</span></code></pre>
<h3 data-id="heading-6">依赖解析重写</h3>
<p>而<code>Vite</code>如果这样设计，会面临一个问题：请求的数量特别大，导致浏览器首屏时间反而更久。</p>
<p><code>Vite</code>做了一层设计，将多个模块合并到一个模块，即<code>依赖解析重写</code>，如<code>vue -&gt; @modules/vue?v=xxx</code></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// packages/vite/src/node/plugins/importAnalysis.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">importAnalysisPlugin</span>(<span class="hljs-params"/>): <span class="hljs-title class_">Plugin</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'vite:import-analysis'</span>,
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">transform</span>(<span class="hljs-params">code: <span class="hljs-built_in">string</span>, id: <span class="hljs-built_in">string</span></span>) {
      <span class="hljs-comment">// 匹配 import/export 语句</span>
      <span class="hljs-keyword">const</span> imports = <span class="hljs-title function_">parse</span>(code) <span class="hljs-comment">// 用 es-module-lexer 解析</span>
      
      <span class="hljs-keyword">let</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MagicString</span>(code)
      
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> imp <span class="hljs-keyword">of</span> imports) {
        <span class="hljs-comment">// 例如：import { ref } from 'vue'</span>
        <span class="hljs-keyword">const</span> source = imp.<span class="hljs-property">source</span>
        
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isRelative</span>(source)) {
          <span class="hljs-comment">// 相对路径，保持不变</span>
          <span class="hljs-comment">// import Foo from './foo.ts'</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isBuiltin</span>(source)) {
          <span class="hljs-comment">// Node 内置模块，忽略</span>
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-comment">// ⭐ NPM 包，重写为 /@modules/xxx</span>
          <span class="hljs-comment">// import { ref } from 'vue'</span>
          <span class="hljs-comment">// ↓</span>
          <span class="hljs-comment">// import { ref } from '/@modules/vue?v=xxx'</span>
          
          <span class="hljs-keyword">const</span> resolved = <span class="hljs-keyword">await</span> <span class="hljs-title function_">resolveImport</span>(source)
          <span class="hljs-keyword">const</span> rewritten = <span class="hljs-string">`/@modules/<span class="hljs-subst">${resolved.id}</span>`</span>
          
          s.<span class="hljs-title function_">overwrite</span>(imp.<span class="hljs-property">startPos</span>, imp.<span class="hljs-property">endPos</span>, 
            <span class="hljs-string">`import {...} from '<span class="hljs-subst">${rewritten}</span>'`</span>
          )
        }
      }
      
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">code</span>: s.<span class="hljs-title function_">toString</span>(),
        <span class="hljs-attr">map</span>: s.<span class="hljs-title function_">generateMap</span>(),
      }
    }
  }
}
</code></pre>
<h3 data-id="heading-7">处理node_modules三方库请求</h3>
<p>既然将三方库依赖路径重写，那处理对应的请求也需要进行一次路径转换。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 当浏览器请求 /@modules/vue?v=xxx 时</span>

middlewares.<span class="hljs-title function_">use</span>(<span class="hljs-string">'/@modules/'</span>, <span class="hljs-keyword">async</span> (req, res, next) =&gt; {
  <span class="hljs-keyword">const</span> moduleName = req.<span class="hljs-property">url</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>)[<span class="hljs-number">2</span>]?.<span class="hljs-title function_">split</span>(<span class="hljs-string">'?'</span>)[<span class="hljs-number">0</span>]
  
  <span class="hljs-comment">// /@modules/vue → node_modules/vue/dist/vue.esm.js</span>
  <span class="hljs-keyword">const</span> modulePath = <span class="hljs-built_in">require</span>.<span class="hljs-title function_">resolve</span>(moduleName, {
    <span class="hljs-attr">paths</span>: [config.<span class="hljs-property">root</span>],
  })
  
  <span class="hljs-keyword">const</span> code = <span class="hljs-keyword">await</span> fs.<span class="hljs-property">promises</span>.<span class="hljs-title function_">readFile</span>(modulePath, <span class="hljs-string">'utf-8'</span>)
  
  <span class="hljs-comment">// 继续执行 transform 中间件处理</span>
  <span class="hljs-comment">// 确保 node_modules 中的代码也被正确处理</span>
  res.<span class="hljs-title function_">end</span>(code)
})
</code></pre>
<h3 data-id="heading-8">HMR热更新</h3>
<p>那按照这样的设计，所有模块只要经过一次编译，就会保存在模块缓存表中，热更新如何处理呢？</p>
<p><code>Vite</code>做的也比较通俗易懂，当文件系统监听到文件变化，则清除该模块相关缓存信息，然后<code>websocket</code>通知浏览器，<code>Vite client runtime</code>会重新发起相关改动模块的请求。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// packages/vite/src/node/server/hmr.ts</span>

<span class="hljs-comment">// 当文件变更时</span>
watcher.<span class="hljs-title function_">on</span>(<span class="hljs-string">'change'</span>, <span class="hljs-keyword">async</span> (file) =&gt; {
  <span class="hljs-keyword">const</span> url = <span class="hljs-title function_">urlFromFile</span>(file, config.<span class="hljs-property">root</span>)
  
  <span class="hljs-comment">// 1️⃣ 清除模块缓存</span>
  server.<span class="hljs-property">moduleGraph</span>.<span class="hljs-title function_">invalidateModule</span>(url)
  
  <span class="hljs-comment">// 2️⃣ 收集受影响的模块</span>
  <span class="hljs-keyword">const</span> affectedModules = server.<span class="hljs-property">moduleGraph</span>.<span class="hljs-title function_">getImporters</span>(url)
  
  <span class="hljs-comment">// 3️⃣ 通过 WebSocket 通知浏览器</span>
  server.<span class="hljs-property">ws</span>.<span class="hljs-title function_">send</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-string">'update'</span>,
    <span class="hljs-attr">event</span>: <span class="hljs-string">'vite:beforeUpdate'</span>,
    <span class="hljs-attr">updates</span>: affectedModules.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> ({
      <span class="hljs-attr">type</span>: m.<span class="hljs-property">isSelfAccepting</span> ? <span class="hljs-string">'js-update'</span> : <span class="hljs-string">'full-reload'</span>,
      <span class="hljs-attr">event</span>: <span class="hljs-string">'vite:beforeUpdate'</span>,
      <span class="hljs-attr">path</span>: m.<span class="hljs-property">url</span>,
      <span class="hljs-attr">acceptedPath</span>: url,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    }))
  })
})
</code></pre>
<h3 data-id="heading-9">HMR客户端脚本注入</h3>
<p>这就是客户端热更新的核心代码。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// packages/vite/src/client/client.ts</span>

<span class="hljs-comment">// 注入到每个 HTML 的脚本</span>
<span class="hljs-keyword">const</span> hotModule = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>

<span class="hljs-keyword">if</span> (hotModule) {
  hotModule.<span class="hljs-title function_">accept</span>(<span class="hljs-function">(<span class="hljs-params">{ <span class="hljs-keyword">default</span>: newModule }</span>) =&gt;</span> {
    <span class="hljs-comment">// 接收模块更新</span>
    <span class="hljs-comment">// 执行自定义 HMR 逻辑或完整重载</span>
  })
  
  <span class="hljs-comment">// 监听服务器推送</span>
  hotModule.<span class="hljs-title function_">on</span>(<span class="hljs-string">'vite:beforeUpdate'</span>, <span class="hljs-keyword">async</span> (event) =&gt; {
    <span class="hljs-keyword">if</span> (event.<span class="hljs-property">type</span> === <span class="hljs-string">'js-update'</span>) {
      <span class="hljs-comment">// 动态 import 新版本模块</span>
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(event.<span class="hljs-property">path</span> + <span class="hljs-string">`?t=<span class="hljs-subst">${event.timestamp}</span>`</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// 完整页面刷新</span>
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-title function_">reload</span>()
    }
  })
}
</code></pre>
<p>因此热更新的流程总结如下：</p>
<pre><code class="hljs language-scss" lang="scss">用户编辑文件保存
    ↓
文件系统监听器检测变化
    ↓
清除 ModuleGraph 缓存
    ↓
WebSocket 通知浏览器
    ↓
浏览器发起新请求（带时间戳）
    ↓
transformMiddleware 拦截
    ↓
loadRawRequest (esbuild 编译 TS/JSX)
    ↓
pluginContainer<span class="hljs-selector-class">.transform</span> (执行插件 Vue/CSS 等)
    ↓
返回最新的 ESM 代码
    ↓
浏览器执行 HMR 回调更新页面
</code></pre>
<h2 data-id="heading-10">结尾</h2>
<p>这就是<code>Vite</code>开发环境的核心机制！按需编译+缓存+HMR推送，相比于<code>Webpack</code>，少了最早的整个bundle的构建，自然而然会快非常多，因为<code>Vite</code>在初始化根本就没有<code>build</code>的过程，甚至连<code>main.ts</code>入口文件都是实时编译的。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[人脸识别项目如何在Spring Boot项目中如何建立数据库和管理]]></title>    <link>https://juejin.cn/post/7582136489770762250</link>    <guid>https://juejin.cn/post/7582136489770762250</guid>    <pubDate>2025-12-11T05:24:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582136489770762250" data-draft-id="7582136489770729482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="人脸识别项目如何在Spring Boot项目中如何建立数据库和管理"/> <meta itemprop="keywords" content="后端,数据库,MySQL"/> <meta itemprop="datePublished" content="2025-12-11T05:24:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="进击的丸子"/> <meta itemprop="url" content="https://juejin.cn/user/2506542243120680"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            人脸识别项目如何在Spring Boot项目中如何建立数据库和管理
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2506542243120680/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    进击的丸子
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:24:49.000Z" title="Thu Dec 11 2025 05:24:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读11分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">讲讲在Spring Boot项目中如何建立数据库和管理</h2>
<p>随着智能门禁、考勤、访客系统的普及，<strong>人脸识别模块</strong>已成为众多项目的重要组成部分。在高性能的人脸识别系统中，数据库主要负责<strong>持久化存储</strong>，而识别比对操作应全部在<strong>内存中完成</strong>，以保证毫秒级响应和高并发性能。本文将介绍如何在 <strong>Spring Boot 项目</strong>中建立一个高效、可扩展的人脸识别数据库，并实现基础的人脸数据管理功能，同时结合 MySQL、Redis 与内存优化策略，提升系统整体性能。</p>
<h2 data-id="heading-1">一、基础入门介绍</h2>
<p>这里为了能让大家对SDK结合数据库有个初步了解，我们先利用<a href="https://link.juejin.cn?target=https%3A%2F%2Fai.arcsoft.com.cn%2F%3Futm_source%3DJuejin%26%26utm_medium%3Dshentao" target="_blank" title="https://ai.arcsoft.com.cn/?utm_source=Juejin&amp;&amp;utm_medium=shentao" ref="nofollow noopener noreferrer">虹软人脸识别SDK</a> 对应的<strong>ArcSoftFaceDemo</strong> ，讲解下此Demo是如何对人脸数据库进行管理的，以及如何正确地注册到 <strong>ArcFace SDK</strong> 的引擎中，以支持后续的人脸检测和识别功能。下面结合代码分析整个管理流程。</p>
<h3 data-id="heading-2">1、数据库环境准备</h3>
<p>在开始使用 ArcsoftFaceDemo 前，需要先准备好 MySQL 数据库环境。为了快速搭建，可以直接使用 <strong>Docker</strong> 启动一个数据库实例。</p>
<h5 data-id="heading-3">使用 Docker 启动 MySQL 8.0</h5>
<p>执行以下命令启动 MySQL 容器：</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \
  --name arcsoft_mysql \
  -e MYSQL_ROOT_PASSWORD=Root123 \
  -e MYSQL_DATABASE=arcsoft_face \
  -p 3306:3306 \
  registry.cn-hangzhou.aliyuncs.com/china-images/mysql:8.0
</code></pre>
<p><strong>说明：</strong></p>
<ul>
<li><code>--name arcsoft_mysql</code>：容器名称，方便管理。</li>
<li><code>MYSQL_ROOT_PASSWORD=Root123</code>：root 用户密码。</li>
<li><code>MYSQL_DATABASE=arcsoft_face</code>：初始化创建数据库 <code>arcsoft_face</code>。</li>
<li><code>-p 3306:3306</code>：将容器端口映射到宿主机，方便程序连接。</li>
<li><code>registry.cn-hangzhou.aliyuncs.com/china-images/mysql:8.0</code>：指定使用 MySQL 8.0 阿里云镜像，如果有外网环境，可直接使用mysql:8.0代替。</li>
</ul>
<blockquote>
<p>如果你想了解更多 Docker 使用方式，可以参考其他 Docker 入门文档或教程。也可直接在物理操作系统上安装MySQL</p>
</blockquote>
<h5 data-id="heading-4">数据库连接信息</h5>
<p>启动完成后，你就可以通过以下信息连接数据库：</p>
<ul>
<li><strong>URL</strong>：<code>物理机IP:3306</code></li>
<li><strong>用户名</strong>：<code>root</code></li>
<li><strong>密码</strong>：<code>Root123</code></li>
<li><strong>数据库</strong>：<code>arcsoft_face</code></li>
</ul>
<p>这样就完成了数据库环境的搭建，为 ArcsoftFaceDemo 的人脸库管理做好了基础准备。</p>
<h3 data-id="heading-5">2、工程导入与数据库配置</h3>
<p>在完成数据库环境准备后，下一步是导入 <strong>ArcSoftFaceDemo</strong> 工程，并将默认数据库配置改为 MySQL。</p>
<h5 data-id="heading-6">导入工程</h5>
<ol>
<li>从 ArcSoft <a href="https://link.juejin.cn?target=https%3A%2F%2Fai.arcsoft.com.cn%2F%3Futm_source%3DJuejin%26%26utm_medium%3Dshentao" target="_blank" title="https://ai.arcsoft.com.cn/?utm_source=Juejin&amp;&amp;utm_medium=shentao" ref="nofollow noopener noreferrer">官网</a>下载 <strong>ArcSoftFaceDemo</strong> 工程压缩包。</li>
<li>解压后，用 <strong>IntelliJ IDEA</strong> 打开工程目录。</li>
</ol>
<h5 data-id="heading-7">修改数据库配置</h5>
<p>工程默认使用的是 <strong>H2 内存数据库</strong>，适合快速演示和测试。但在正式环境中，建议切换到 <strong>MySQL</strong> 或其他持久化数据库。</p>
<p>打开 <code>application.properties</code> 文件，找到默认配置：</p>
<pre><code class="hljs language-properties" lang="properties">spring.datasource.url=jdbc:h2:file:./data/arcdb
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
spring.sql.init.mode=always
spring.sql.init.schema-locations=classpath:db/schema-h2.sql
</code></pre>
<p><strong>说明：</strong></p>
<ul>
<li><code>spring.datasource.url</code>：H2 数据库文件路径。</li>
<li><code>spring.datasource.driver-class-name</code>：H2 数据库驱动。</li>
<li><code>spring.datasource.username</code> / <code>spring.datasource.password</code>：数据库账号密码。</li>
<li><code>spring.h2.console.*</code>：H2 Web 控制台相关配置，方便调试。</li>
<li><code>spring.sql.init.*</code>：初始化 SQL 文件路径，用于创建示例表结构。</li>
</ul>
<h5 data-id="heading-8">H2切换为MySQL</h5>
<p>在正式环境中，我们需要将默认 H2 配置改为 MySQL。打开 <code>application.properties</code>，将数据库相关配置修改为 MySQL 连接信息：</p>
<pre><code class="hljs language-properties" lang="properties">spring.datasource.url=jdbc:mysql://localhost:3306/arcsoft_face?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.username=root
spring.datasource.password=Root123
spring.sql.init.mode=always
spring.sql.init.schema-locations=classpath:db/schema-mysql.sql
</code></pre>
<p><strong>说明：</strong></p>
<ul>
<li><code>spring.datasource.url</code>：MySQL 连接 URL，包含数据库名 <code>arcsoft_face</code>，字符集与时区设置。<code>localhost</code>地址根据实际数据库IP地址设置</li>
<li><code>spring.datasource.driver-class-name</code>：MySQL 驱动类。</li>
<li><code>spring.datasource.username</code> / <code>spring.datasource.password</code>：MySQL 账号密码，对应 Docker 启动 MySQL 时设置的用户名和密码。</li>
<li><code>spring.sql.init.*</code>：初始化 SQL 文件路径，用于创建用户表结构（与 H2 不同，需要使用 MySQL 版本 SQL）。</li>
</ul>
<hr/>
<h5 data-id="heading-9">验证数据库连接</h5>
<ol>
<li>启动 ArcSoftFaceDemo 工程。</li>
<li>检查启动日志，确认数据库连接成功：</li>
</ol>
<pre><code class="hljs language-erlang" lang="erlang">HikariPool-<span class="hljs-number">1</span> - Starting...
HikariPool-<span class="hljs-number">1</span> - Start completed.
</code></pre>
<p>注意：使用 MySQL 客户端（如 <code>mysql</code> 命令行或 Navicat等）连接数据库，确认 <code>arcsoft_face</code> 数据库已创建成功。</p>
<hr/>
<h5 data-id="heading-10">创建用户表</h5>
<p>如果 MySQL 数据库中没有表，需要执行初始化 SQL 创建 <code>user_info</code> 表：</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> user_info (
    id <span class="hljs-type">BIGINT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">60</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    extra_info <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">500</span>),
    face_feature <span class="hljs-type">BLOB</span>,
    image_url <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">120</span>),
    create_time <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
    <span class="hljs-keyword">UNIQUE</span> KEY user_info_name_uindex (name)
) ENGINE<span class="hljs-operator">=</span>InnoDB <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4;

</code></pre>
<p><strong>关键字段说明：</strong></p>
<ul>
<li><code>id</code>：用户唯一标识。</li>
<li><code>name</code>：用户名。</li>
<li><code>face_feature</code>：ArcSoft SDK 提取的人脸特征二进制数据。这里也可以根据业务来，使用text类型，存储base64编码后的字符串数据</li>
<li><code>image_url</code>：注册证存储地址。</li>
</ul>
<p>这样就完成了 MySQL 数据库接入 ArcSoftFaceDemo 的准备工作。</p>
<h3 data-id="heading-11">3、人脸注册过程说明（FaceService.java）</h3>
<p><code>FaceService</code> 是整个系统的人脸注册与管理核心逻辑，负责：</p>
<ul>
<li>从数据库读取用户人脸信息</li>
<li>注册/更新人脸到 ArcFace SDK 内存引擎</li>
<li>删除人脸</li>
<li>系统启动时批量加载人脸</li>
<li>支持从数据库、本地图片、classpath 目录三种来源初始化</li>
</ul>
<p>下面详细说明各功能模块的逻辑。</p>
<h4 data-id="heading-12">人脸注册核心方法：addUser</h4>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUser</span><span class="hljs-params">(String name, <span class="hljs-type">byte</span>[] faceFeature)</span> {
        <span class="hljs-type">UserInfo</span> <span class="hljs-variable">userInfo</span> <span class="hljs-operator">=</span> userInfoMapper.selectOne(Wrappers.&lt;UserInfo&gt;lambdaQuery().eq(UserInfo::getName, name));
        <span class="hljs-keyword">if</span> (userInfo == <span class="hljs-literal">null</span>) {
            <span class="hljs-type">UserInfo</span> <span class="hljs-variable">userInfoInsert</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserInfo</span>();
            userInfoInsert.setId((<span class="hljs-type">int</span>) (System.currentTimeMillis() % <span class="hljs-number">1_000_000_000</span>)); <span class="hljs-comment">//如果是MySQL数据库，可去掉这个，利用数据库自增长id来生成</span>
            userInfoInsert.setName(name);
            userInfoInsert.setFaceFeature(faceFeature);
            userInfoMapper.insert(userInfoInsert);
            faceEngineService.registerFaceFeature2Engine(userInfoInsert.getId(), name, faceFeature);

        } <span class="hljs-keyword">else</span> {
            <span class="hljs-type">UserInfo</span> <span class="hljs-variable">userInfoUpdate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserInfo</span>();
            userInfoUpdate.setId(userInfo.getId());
            userInfoUpdate.setName(name);
            userInfoUpdate.setFaceFeature(faceFeature);
            userInfoMapper.updateById(userInfoUpdate);
            faceEngineService.removeFaceFeature2Engine(userInfo.getId());
            faceEngineService.registerFaceFeature2Engine(userInfo.getId(), name, faceFeature);
        }
    }
</code></pre>
<h5 data-id="heading-13">功能说明</h5>
<p><code>addUser</code> 是 ArcSoftFaceDemo 项目中最核心的人脸注册方法，主要功能是：</p>
<ul>
<li>将输入的人脸特征（byte[]）写入数据库</li>
<li>将人脸特征注册到 ArcFace 引擎的内存特征库（内存中的索引结构）</li>
<li>同步维护两端的数据一致性（数据库 ↔ 识别引擎）</li>
</ul>
<p>ArcFace SDK 的识别能力依赖于<strong>内存中的特征库</strong>，因此每次注册、更新、删除都必须保持数据库与 SDK 内存库一致。在做新增的时候，同步两边需同时新增，保证数据一致性。</p>
<p>这里注册存储的时候，也可以同时带一些业务上的信息，如人员id，人员姓名，人员注册照存放地址等。这些信息，<strong>在数据库中可以以字段的形式进行存储归档</strong>，可参考上面<code>user_info</code>表进行字段扩展优化。如果想通过SDK的<code>searchFaceFeature</code>接口获取到这些额外信息，在<code>registerFaceFeature</code>接口中提供了<code>faceTag</code>的一个字符串类型，用于存放业务数据，可以把这些信息<strong>以JSON字符串形式存放到<code>faceTag</code>中去</strong>，当然也可通过searchId，再查询数据库的方式，把对应的人员信息查询出来</p>
<p>ArcFace SDK 提取的人脸特征是一个 <strong>byte[] 数组</strong>。5.0 的中模型特征长度在 2056字节，大模型特征特征长度3080字节，这里在做数据库字段大小的时候需要关注下</p>
<p><strong>两种存储方式：SDK的特征类型是byte[]数组类型，存储到数据库方式：</strong></p>
<p>1、可以直接使用BLOB类型，一般推荐用<strong>BLOB类型</strong>存储，可以减少编解码带来的性能损失</p>
<p>2、byte[]数组转成base64字符串，数据库用<strong>TEXT类型</strong>进行存储，如果涉及到网络传输，可使用Base64字符串</p>
<h4 data-id="heading-14">删除用户 removeUser</h4>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeUser</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-type">UserInfo</span> <span class="hljs-variable">userInfo</span> <span class="hljs-operator">=</span> userInfoMapper.selectOne(Wrappers.&lt;UserInfo&gt;lambdaQuery().eq(UserInfo::getName, name));
        <span class="hljs-keyword">if</span> (userInfo != <span class="hljs-literal">null</span>) {
            faceEngineService.removeFaceFeature2Engine(userInfo.getId());
            userInfoMapper.deleteById(userInfo.getId());
        }
    }
</code></pre>
<ol>
<li>根据用户名查询用户</li>
<li>从 SDK 内存引擎移除人脸</li>
<li>从数据库删除记录</li>
</ol>
<h4 data-id="heading-15">系统启动时自动加载人脸</h4>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadImage2Engine</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"true"</span>.equals(faceImageClear)) {
            removeAllUser();
            initSystemFace();
            <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(testImagePath);
            <span class="hljs-keyword">if</span> (file.isDirectory()) {
                File[] files = file.listFiles();
                log.info(<span class="hljs-string">"开始加载本地人脸图片到引擎中"</span>);
                <span class="hljs-keyword">for</span> (File imageFile : files) {
                    <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> imageFile.getName();
                    <span class="hljs-keyword">if</span> (name.endsWith(<span class="hljs-string">".jpg"</span>) || name.endsWith(<span class="hljs-string">".png"</span>)) {
                        <span class="hljs-type">String</span> <span class="hljs-variable">userName</span> <span class="hljs-operator">=</span> name.substring(<span class="hljs-number">0</span>, name.lastIndexOf(<span class="hljs-string">"."</span>));
                        register(userName, imageFile, <span class="hljs-literal">null</span>);
                    }
                }
                log.info(<span class="hljs-string">"加载本地人脸图片到引擎中完成"</span>);
            }
        }<span class="hljs-keyword">else</span> {
            initDatabaseFace2Engine();
        }
    }
</code></pre>
<p>系统启动后执行，用于初始化内存人脸库，为了加快识别速度，建议每次启动服务后，就直接把数据库里的人脸注册信息放到SDK引擎里，减少下次识别读取数据库带来的耗时增加。Demo中提供了有两种模式，根据配置文件的<code>register.faceimage.clean</code>进行切换</p>
<p><code>register.faceimage.clean</code>=true，每次启动会清空数据库，重新加载本地图片进行注册，同时存储到数据库和SDK</p>
<p><code>register.faceimage.clean</code>=false，每次启动从数据库读取特征，加载到SDK。Demo为了测试，会同时把本地本次未注册的图片进行存储和注册，生产环境可只保留从数据库读取加载</p>
<h3 data-id="heading-16">4、人脸识别方式</h3>
<p>这里再另外提一下，SDK人脸识别主要有以下两种方案，Demo采用的是第2种方案，也可根据实际业务使用第1种方案</p>
<h4 data-id="heading-17">①、使用 Map 列表 + <code>compareFaceFeature</code> 接口</h4>
<ul>
<li><strong>原理</strong>：将注册的人脸特征存放在 Map 或列表中，通过 SDK 的 <code>compareFaceFeature</code> 接口进行循环比对。</li>
<li><strong>优点</strong>：可灵活分组管理人脸库；支持多线程并发比对。</li>
<li><strong>缺点</strong>：当人脸库量大时，频繁调用比对接口会增加性能损耗。</li>
</ul>
<h4 data-id="heading-18">②、使用 SDK 提供的原生接口注册</h4>
<ul>
<li><strong>原理</strong>：利用<code>registerFaceFeature</code>、<code>removeFaceFeature</code>、<code>updateFaceFeature</code>、<code>searchFaceFeature</code> 组合接口，实现对人脸的增删改查</li>
<li><strong>优点</strong>：SDK 原生实现比对，性能快，资源消耗少。</li>
<li><strong>缺点</strong>：不支持分组比对；系统重启后需重新注册特征；多引擎并发时，每个引擎的人脸库需单独管理，维护复杂。</li>
</ul>
<p>​	<strong>为了实现长久保存和分布式共享，人脸特征需进行合理存储</strong></p>
<h3 data-id="heading-19">5、人脸引擎说明（FaceEngineService.java）</h3>
<p><code>FaceEngineService</code> 是人脸SDK 的核心部分，负责：</p>
<ul>
<li>人脸检测、特征提取、活体检测、属性检测等</li>
<li>人员信息的新增、删除、修改、人脸搜索</li>
</ul>
<p>下面详细说明各功能模块的逻辑。</p>
<h4 data-id="heading-20">人员新增：registerFaceFeature2Engine</h4>
<pre><code class="hljs language-java" lang="java"> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerFaceFeature2Engine</span><span class="hljs-params">(<span class="hljs-type">int</span> searchId, String faceTag, <span class="hljs-type">byte</span>[] faceFeature)</span> {

        <span class="hljs-type">FaceEngineFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> (FaceEngineFactory) faceEngineComparePool.getFactory();

        List&lt;FaceEngine&gt; allObjects = factory.getAllObjects();
        <span class="hljs-type">FaceFeatureInfo</span> <span class="hljs-variable">faceFeatureInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FaceFeatureInfo</span>();
        faceFeatureInfo.setSearchId(searchId);
        faceFeatureInfo.setFaceTag(faceTag);
        faceFeatureInfo.setFeatureData(faceFeature);
<span class="hljs-comment">//        log.info("Register:"+ JSON.toJSONString(faceFeatureInfo));</span>
        <span class="hljs-keyword">for</span> (FaceEngine allObject : allObjects) {
            <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> allObject.registerFaceFeature(faceFeatureInfo);
        }、、

    }
</code></pre>
<p><strong>这里重点说明下，因为我们的FaceEngine用了线程池，同时初始化了多个引擎，所以我们在向SDK注册人员信息的时候，需要给每个引擎进行注册，删除同理。</strong></p>
<h4 data-id="heading-21">人员新增：removeFaceFeature2Engine</h4>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeFaceFeature2Engine</span><span class="hljs-params">(<span class="hljs-type">int</span> searchId)</span> {
        <span class="hljs-type">FaceEngineFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> (FaceEngineFactory) faceEngineComparePool.getFactory();
        List&lt;FaceEngine&gt; allObjects = factory.getAllObjects();
        <span class="hljs-keyword">for</span> (FaceEngine allObject : allObjects) {
            allObject.removeFaceFeature(searchId);
        }
    }
</code></pre>
<p>删除同注册接口，需要同步向所有FaceEngine库进行移除操作</p>
<h3 data-id="heading-22">二、人脸特征三层存储与分布式管理</h3>
<p>上面已经介绍了基本的数据库接入和使用，那么在实际人脸识别场景下，系统的数据存储与识别通常采用三层设计：</p>
<ol>
<li><strong>MySQL</strong>：负责持久化存储人脸特征信息，实现可靠的长期保存。</li>
<li><strong>Redis</strong>：用于异步更新与分布式缓存，实现多机器环境下的人脸特征共享。</li>
<li><strong>内存（ConcurrentHashMap / 特征池）</strong>：存储当前在线的活跃人脸特征，实现毫秒级识别。</li>
</ol>
<p>这种设计保证了系统既能持久化存储，又能在识别时获得最佳性能。</p>
<p>在 Spring Boot 项目中，实现人脸特征的管理可以从<strong>数据库建表、服务层加载、Redis缓存、特征注册与比对</strong>几个方面进行详细设计。</p>
<p>在多台识别服务器部署的分布式环境中，人脸特征需要在各节点之间保持<strong>一致性、高可用和高性能</strong>。结合内存、Redis 和数据库三层存储，设计参考方案：</p>
<h5 data-id="heading-23">1、 启动加载策略</h5>
<ul>
<li><strong>流程</strong>：
<ol>
<li>每台识别服务器启动时，先从 Redis 拉取最新的人脸特征到本地内存缓存。</li>
<li>如果 Redis 中没有特征数据（如初次部署），则从 MySQL 数据库加载。Redis 可作为 <strong>内存缓存 + 异步更新机制</strong>，保证各节点识别数据一致性</li>
<li>加载后，内存缓存即可支持毫秒级人脸识别。</li>
</ol>
</li>
<li><strong>实现示例</strong>：</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@PostConstruct</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadFeaturesOnStartup</span><span class="hljs-params">()</span> {
    Set&lt;String&gt; keys = redisTemplate.keys(<span class="hljs-string">"face:*"</span>);
    <span class="hljs-keyword">if</span> (keys != <span class="hljs-literal">null</span> &amp;&amp; !keys.isEmpty()) {
        <span class="hljs-keyword">for</span> (String key : keys) {
            <span class="hljs-type">byte</span>[] featureData =(<span class="hljs-type">byte</span>[]) redisTemplate.opsForValue().get(key);
            <span class="hljs-keyword">if</span> (featureData != <span class="hljs-literal">null</span>) {
                featureMap.put(key.replace(<span class="hljs-string">"face:"</span>, <span class="hljs-string">""</span>), featureData);
            }
        }
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// Redis为空，从数据库加载</span>
        List&lt;FaceFeature&gt; features = repository.findAll();
        <span class="hljs-keyword">for</span> (FaceFeature f : features) {
            featureMap.put(f.getUserId(), f.getFeature());
            redisTemplate.opsForValue().set(<span class="hljs-string">"face:"</span> + f.getUserId(), f.getFeature());
        }
    }
}
</code></pre>
<ul>
<li><strong>优势</strong>：
<ul>
<li>避免每次识别都访问数据库，提高性能。</li>
<li>启动即加载最新特征，保证识别数据实时性。</li>
</ul>
</li>
</ul>
<h5 data-id="heading-24">2、 特征更新与同步策略</h5>
<p>在分布式场景下，用户新增、删除或更新人脸特征时，需要保证所有节点内存保持一致：</p>
<ol>
<li>
<p><strong>更新顺序</strong>：</p>
<p><strong>写内存</strong>：立即更新本地内存缓存，保证识别服务实时可用。</p>
<ul>
<li><strong>写 Redis</strong>：同步到 Redis，作为分布式共享层。</li>
<li><strong>写数据库</strong>：异步持久化到 MySQL，保证长期数据安全。</li>
</ul>
</li>
<li>
<p><strong>同步机制</strong>：</p>
<ul>
<li>利用 Redis <strong>Pub/Sub</strong> 或消息队列（Kafka、RabbitMQ）广播更新事件。</li>
<li>其他节点接收到更新事件后，刷新本地内存特征缓存。</li>
</ul>
</li>
</ol>
<ul>
<li><strong>示例逻辑</strong>：</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">updateFeature</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> userId, byte[] feature</span>) {
    <span class="hljs-comment">// 更新本地内存</span>
    featureMap.<span class="hljs-title function_">put</span>(userId, feature);
    <span class="hljs-comment">// 更新 Redis</span>
    redisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">set</span>(<span class="hljs-string">"face:"</span> + userId, feature);
    <span class="hljs-comment">// 发布更新事件通知其他节点</span>
    redisTemplate.<span class="hljs-title function_">convertAndSend</span>(<span class="hljs-string">"face:update"</span>, userId);
    <span class="hljs-comment">// 异步更新数据库</span>
    <span class="hljs-title function_">asyncUpdateDatabase</span>(userId, feature);
}

<span class="hljs-comment">// 订阅事件刷新内存</span>
<span class="hljs-meta">@EventListener</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handleRedisUpdateEvent</span>(<span class="hljs-params">Message message</span>) {
    <span class="hljs-title class_">String</span> userId = (<span class="hljs-title class_">String</span>) message.<span class="hljs-title function_">getBody</span>();
    <span class="hljs-title class_">String</span> feature = redisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">get</span>(<span class="hljs-string">"face:"</span> + userId);
    <span class="hljs-keyword">if</span> (feature != <span class="hljs-literal">null</span>) {
        featureMap.<span class="hljs-title function_">put</span>(userId, feature);
    }
}
</code></pre>
<p>通过合理的存储架构和内存优化，Spring Boot 项目的人脸识别系统可以在保证高性能的同时，实现可扩展、分布式的人脸管理功能，为智能门禁、考勤和访客系统提供稳定支撑。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[终于来了！Flutter 拥有了一个可用的液态玻璃解决方案！]]></title>    <link>https://juejin.cn/post/7582200865907589154</link>    <guid>https://juejin.cn/post/7582200865907589154</guid>    <pubDate>2025-12-11T05:26:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582200865907589154" data-draft-id="7581324707480256553" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="终于来了！Flutter 拥有了一个可用的液态玻璃解决方案！"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-11T05:26:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JarvanMo"/> <meta itemprop="url" content="https://juejin.cn/user/2348212565845704"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            终于来了！Flutter 拥有了一个可用的液态玻璃解决方案！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2348212565845704/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JarvanMo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:26:15.000Z" title="Thu Dec 11 2025 05:26:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>关注微信公众号： OpenFlutter</p>
</blockquote>
<p>简史回顾。</p>
<h3 data-id="heading-0">以前的尝试及其不足之处</h3>
<p>让我们来看看 <strong>pub.dev</strong>（Flutter 包管理网站）。</p>
<p>如果我们搜索 <code>liquid glass</code>（液态玻璃），我们会找到以下几个软件包：</p>





































<table><thead><tr><th><strong>软件包名称</strong></th><th><strong>关键问题和评价</strong></th></tr></thead><tbody><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fliquid_glass" target="_blank" title="https://pub.dev/packages/liquid_glass" ref="nofollow noopener noreferrer">liquid_glass</a></td><td><strong>无示例，无 GitHub 链接</strong>。有些可疑。</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fliquid_glass_renderer" target="_blank" title="https://pub.dev/packages/liquid_glass_renderer" ref="nofollow noopener noreferrer">liquid_glass_renderer </a></td><td>非常优秀，高票支持，跨平台，<strong>可能是目前最好的尝试</strong>。但<strong>仅适用于 Impeller</strong> 渲染引擎，因此<strong>不支持 Windows 和 Web</strong> 平台。存在<strong>性能问题</strong>。</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fcupertino_native" target="_blank" title="https://pub.dev/packages/cupertino_native" ref="nofollow noopener noreferrer">cupertino_native</a></td><td>使用<strong>原生 iOS 组件</strong>。由 Serverpod 创始人周末匆忙编写。<strong>非跨平台</strong>。</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fadaptive_platform_ui" target="_blank" title="https://pub.dev/packages/adaptive_platform_ui" ref="nofollow noopener noreferrer">adaptive_platform_ui</a></td><td>根据平台渲染组件。<strong>非跨平台</strong>。</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Foc_liquid_glass" target="_blank" title="https://pub.dev/packages/oc_liquid_glass" ref="nofollow noopener noreferrer">oc_liquid_glass</a></td><td><strong>依赖 Impeller</strong>。在 Windows 和 Web 上不起作用。</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fliquid_glass_ui" target="_blank" title="https://pub.dev/packages/liquid_glass_ui" ref="nofollow noopener noreferrer">liquid_glass_ui</a></td><td>仅一行代码实现了一个带有 <code>DropFilter.blur</code> 的<strong>常规玻璃拟物容器 (glassmorphic container)</strong> 。作者获得了一些赞和下载，但<strong>意义何在</strong>？😕</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fliquid_glass_ui_design" target="_blank" title="https://pub.dev/packages/liquid_glass_ui_design" ref="nofollow noopener noreferrer">liquid_glass_ui_design</a></td><td>这可能是<strong>传统玻璃拟物设计（磨砂玻璃效果）<strong>中最完整的 UI 库。像前一个包一样，作者只是利用了“liquid”这个词。值得一试，但</strong>无论如何都不是液态玻璃</strong>。</td></tr></tbody></table>
<p><strong>总结一下</strong>：现有的解决方案要么<strong>依赖 Impeller</strong>，要么<strong>使用原生 iOS 组件</strong>，因此<strong>无法实现跨平台</strong>；或者它们只是提供了<strong>常规的玻璃拟物设计，完全没有“液态”效果</strong>。</p>
<hr/>
<h3 data-id="heading-1">英雄登场</h3>
<p>而我们的英雄是：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fliquid_glass_easy" target="_blank" title="https://pub.dev/packages/liquid_glass_easy" ref="nofollow noopener noreferrer">liquid_glass_easy</a></p>
<blockquote>
<p>这是一个 Flutter 软件包，它能够添加实时、交互式的液态玻璃透镜（Liquid Glass Lenses）效果。
这些动态透镜可以对底层内容进行<strong>放大、扭曲、模糊、着色和折射</strong>处理，从而创造出<strong>引人注目的、玻璃般的视觉效果</strong>，并<strong>流畅地响应移动和触摸</strong>。</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d7954cbcb2749ffb7e314bd0c7fd617~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmFydmFuTW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035575&amp;x-signature=Ak6hZcXrIrX%2FfbmVmuAdF5SyKdc%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>与<strong>传统的玻璃拟物（Glassmorphism）<strong>或</strong>静态模糊效果</strong>不同，<code>LiquidGlassEasy</code> 模拟了<strong>真实的玻璃物理特性</strong>，包括完整的<strong>折射、扭曲和流体响应能力</strong>。
它能<strong>实时捕获并折射</strong>（refract）实时背景内容，从而产生<strong>身临其境、响应动态</strong>的视觉效果，为你的 UI 带来<strong>深度和真实感</strong>。</p>
</blockquote>
<h3 data-id="heading-2">主要特性</h3>
<ul>
<li><strong>💠 真实的液态玻璃视觉效果</strong>：以流动的透明度、柔和的高光和<strong>自然弯曲光线的折射</strong>，来重现真实玻璃的外观和物理特性。</li>
<li><strong>🌀 实时透镜渲染</strong>：当元素在玻璃后面移动时，立即看到<strong>扭曲、模糊、着色和折射</strong>做出响应。</li>
<li><strong>🎨 自定义形状</strong>：将透镜设计为<strong>圆角矩形、圆形或平滑的超椭圆</strong>，使其完美匹配你的界面风格。</li>
<li><strong>🌈 完全可定制的效果</strong>：控制<strong>着色颜色、强度、柔和度、折射深度和光线方向</strong>，实现精确的玻璃行为。</li>
<li><strong>🧠 控制器驱动的动画</strong>：通过 <strong><code>LiquidGlassController</code></strong>，实时显示、隐藏或动画化透镜。</li>
<li><strong>⚙️ 着色器驱动、GPU 加速的管线</strong>：即使有多个动态透镜，也能确保<strong>平滑、高 FPS 的性能</strong>。</li>
<li><strong>📱 跨平台兼容性</strong>：在 <strong>Android、iOS、Web、macOS 和 Windows</strong> 上无缝运行。</li>
</ul>
<p>让我们一起尝试</p>
<p>将软件包添加到项目：</p>
<pre><code class="hljs language-bash" lang="bash">flutter pub add liquid_glass_easy
</code></pre>
<p>或者</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># 在 pubspec.yaml 文件中</span>
<span class="hljs-attr">dependencies:</span>
  <span class="hljs-attr">flutter:</span>
    <span class="hljs-attr">sdk:</span> <span class="hljs-string">flutter</span>
  <span class="hljs-attr">liquid_glass_easy:</span> <span class="hljs-string">^[latest_version]</span>
</code></pre>
<p>pub.dev 上的<a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fliquid_glass_easy%2Fexample" target="_blank" title="https://pub.dev/packages/liquid_glass_easy/example" ref="nofollow noopener noreferrer">示例 (Example)标签页</a>包含了官方示例，代码相当长，因此我不会在这里重新粘贴。</p>
<p>但我从中得到的信息是，我们需要使用<strong>两个组件（Widget）<strong>来创建液态玻璃效果：</strong> <code>LiquidGlassView</code></strong> 和 <strong><code>LiquidGlass</code></strong>。</p>
<hr/>
<h3 data-id="heading-3">组件作用简述</h3>

















<table><thead><tr><th><strong>组件名称</strong></th><th><strong>作用</strong></th></tr></thead><tbody><tr><td><strong><code>LiquidGlassView</code></strong></td><td>这是<strong>背景捕获器</strong>，它包裹住需要被“液态玻璃”效果影响的<strong>底层内容</strong>。它捕获<strong>其下方的实时渲染内容</strong>，并将该内容作为纹理提供给 <code>LiquidGlass</code>。</td></tr><tr><td><strong><code>LiquidGlass</code></strong></td><td>这是<strong>液态玻璃透镜</strong>本身。它必须位于 <code>LiquidGlassView</code> <strong>内部</strong>，并利用捕获到的背景纹理，通过着色器渲染出<strong>折射、扭曲和模糊</strong>的动态效果。</td></tr></tbody></table>
<pre><code class="hljs language-dart" lang="dart">
LiquidGlassView(
          controller: viewController,
          backgroundWidget: Image.network(
                                 <span class="hljs-string">"https://raw.githubusercontent.com/AhmeedGamil/liquid_glass_easy_assets/refs/heads/main/flower.jpg"</span>,
                                fit: BoxFit.fitWidth,
                                width: <span class="hljs-built_in">double</span>.infinity,
                                height: <span class="hljs-built_in">double</span>.infinity,
                            ),
          pixelRatio: <span class="hljs-number">1</span>,
          useSync: <span class="hljs-keyword">true</span>,
          realTimeCapture: <span class="hljs-keyword">true</span>,
          refreshRate: LiquidGlassRefreshRate.deviceRefreshRate,
          children: [            
               LiquidGlass(
                controller: lensController,
                position:
                <span class="hljs-keyword">const</span> LiquidGlassAlignPosition(alignment: Alignment.center),
                width: <span class="hljs-number">100</span>,
                height: <span class="hljs-number">100</span>,
                magnification: <span class="hljs-number">1</span>,
                enableInnerRadiusTransparent: <span class="hljs-keyword">false</span>,
                diagonalFlip: <span class="hljs-number">0</span>,
                distortion: <span class="hljs-number">0.225</span>,
                distortionWidth: <span class="hljs-number">50</span>,
                draggable: <span class="hljs-keyword">true</span>,
                outOfBoundaries: <span class="hljs-keyword">true</span>,
                blur: LiquidGlassBlur(sigmaX: <span class="hljs-number">0.75</span>, sigmaY: <span class="hljs-number">0.75</span>),
                shape: RoundedRectangleShape(
                    <span class="hljs-comment">//highDistortionOnCurves: true,</span>
                    cornerRadius: <span class="hljs-number">50</span>,
                    borderWidth: <span class="hljs-number">1</span>,
                    borderSoftness: <span class="hljs-number">2.5</span>,
                    lightIntensity: <span class="hljs-number">1.5</span>,
                    lightDirection: <span class="hljs-number">39.0</span>),
              child:
                Container(
                  decoration:  BoxDecoration(borderRadius: BorderRadius.circular(<span class="hljs-number">50</span>),),
                  child: InkWell(
                    borderRadius: BorderRadius.circular(<span class="hljs-number">50</span>),
                      child: Container(
                          height: <span class="hljs-number">50</span>,
                          width: <span class="hljs-number">50</span>,
                          child: Icon(
                            color: Colors.white,
                          Icons.pause,
                            size: <span class="hljs-number">36</span>,
                          ))),
                ),
              ),
</code></pre>
<p>我们需要创建<strong>视图控制器（view controller）和透镜控制器（lens controller）</strong> ：</p>
<pre><code class="hljs language-dart" lang="dart">
<span class="hljs-comment">// 创建视图控制器：用于控制 LiquidGlassView 捕获的背景内容</span>
<span class="hljs-keyword">final</span> viewController = LiquidGlassViewController();
<span class="hljs-comment">// 创建透镜控制器：用于控制 LiquidGlass 效果（例如：显示/隐藏/动画）</span>
<span class="hljs-keyword">final</span> lensController = LiquidGlassController();

</code></pre>
<p>然后我们会得到下面的：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e21e3be755564bd19b0f7fb40b3a2670~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmFydmFuTW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035575&amp;x-signature=hcnPOeZVTeN7XcFnLaCVBAyS8ks%3D" alt="image.png" loading="lazy"/></p>
<p><strong>GIF 画质比较低，是为了帮你节省流量 😉。</strong> 但这个液态玻璃效果很不错，对吧？</p>
<p>接下来，我们来看看同一个示例 App 中的更多例子。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9abac56f88d543d48292a1cffa5f91f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmFydmFuTW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035575&amp;x-signature=wyQUxvjszKcka7GDwRVRstMHYQw%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0896d2fe780e4c68b155bb722a336328~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmFydmFuTW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035575&amp;x-signature=4tcu5QCyCljoRUcXd46f1zS9AGc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">文档</h3>
<p>pub.dev 上的<strong>文档</strong>比较基础，但<strong>类（Classes）的注释很充分</strong>，并且提供了一个<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAhmeedGamil%2Fliquid_glass_easy%2Fblob%2Fmain%2Flib%2Fsrc%2Fdemos%2Fliquid_glass_showcase.dart" target="_blank" title="https://github.com/AhmeedGamil/liquid_glass_easy/blob/main/lib/src/demos/liquid_glass_showcase.dart" ref="nofollow noopener noreferrer">展示应用</a> ，允许用户试玩各种属性：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b00ade9d06e34f0b9e6e31e0fef8f493~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmFydmFuTW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035575&amp;x-signature=%2F5%2FQpMnSZYcLZC6GsfuCjtPUUTg%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6c653905240414d8c5c3f94f90f3ca9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmFydmFuTW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035575&amp;x-signature=rOF2Roy6vHbaXjOeBIRH3j3KKgA%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/446221b4bbe9489bbce2509cc931d1a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmFydmFuTW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035575&amp;x-signature=VeCa%2BX4zqGOlUS%2FoUVZjhcLPxlc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">创建液态玻璃组件</h3>
<p>文档中没有说明如何制作**“液态”<strong>组件。此外，这个软件包也没有提供任何</strong>即用型的液态组件**。</p>
<p>因此，我猜唯一且显而易见的方法是：将某个组件作为 <strong><code>LiquidGlass</code></strong> 的 <strong><code>child</code></strong>，并将其设置为<strong>透明</strong>。</p>
<p>以下是我<strong>快速且粗糙</strong>地尝试创建一个<strong>液态按钮</strong>：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45268ce9dac34774b83bf05ca1e95089~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmFydmFuTW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035575&amp;x-signature=Jo8VPCgA3gUsozUV3czH%2BxzDRWI%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-dart" lang="dart">Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
      appBar: AppBar(
        title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'Liquid button'</span>),
        centerTitle: <span class="hljs-keyword">true</span>,
      ),
      body: LiquidGlassView(
        backgroundWidget:<span class="hljs-comment">// Image.asset('assets/images/background/purple_texture_dark.webp', fit: BoxFit.cover),</span>
         Image.network(
        <span class="hljs-string">"https://raw.githubusercontent.com/AhmeedGamil/liquid_glass_easy_assets/refs/heads/main/socotra_tree_2.jpg"</span>,
        fit: BoxFit.cover,
        width: <span class="hljs-built_in">double</span>.infinity,
        height: <span class="hljs-built_in">double</span>.infinity,
      ),
        children: [
          LiquidGlass(
            width: <span class="hljs-number">300</span>,
            height: <span class="hljs-number">70</span>,
            magnification: <span class="hljs-number">1</span>,
            distortion: <span class="hljs-number">0.2</span>,
            distortionWidth: <span class="hljs-number">50</span>,
            blur: LiquidGlassBlur(sigmaX: <span class="hljs-number">1.75</span>, sigmaY: <span class="hljs-number">0.75</span>),
                shape: RoundedRectangleShape(
                    <span class="hljs-comment">//highDistortionOnCurves: true,</span>
                    cornerRadius: <span class="hljs-number">24</span>,
                    borderWidth: <span class="hljs-number">3</span>,
                    borderSoftness: <span class="hljs-number">5.5</span>,
                    lightIntensity: <span class="hljs-number">1.5</span>,
                ),
            position: LiquidGlassAlignPosition(alignment: Alignment.center),
            
            child: Center(child: 
            SizedBox(
              width: <span class="hljs-number">300</span>,
              height: <span class="hljs-number">70</span>,
              child: FilledButton(onPressed: () {  },
              style: FilledButton.styleFrom(
                backgroundColor: Colors.transparent, 
                foregroundColor: Colors.white,
                overlayColor: Colors.yellow,
                surfaceTintColor: Colors.blue,
              ), 
              child: Text(<span class="hljs-string">'Click me!'</span>, style: TextStyle(fontSize: <span class="hljs-number">24</span>,),)),
            )), 
          ),
        ],
      ),
    );
  }
}
</code></pre>
<h3 data-id="heading-6">性能</h3>
<p>不幸的是，我用于测试 <code>liquid_glass_easy</code> 的项目有些老旧，<strong>Android 构建失败了</strong>。我懒得去修复它，反正这个项目只是用于教育用途。</p>
<p>但<strong>在 Windows 平台上，它对性能完全没有影响</strong>。（我已经对上面带有按钮的页面进行了性能分析）。</p>
<h3 data-id="heading-7">总结</h3>
<p>我并不认为液态玻璃效果有多么重要。它不会让一个无用的 App 变得有用，它的缺失也不会让一个有用的 App 变得无用。所以，<strong>我个人不打算在我的项目中使用它</strong>。</p>
<p>但是，作为一个 <strong>Flutter 爱好者</strong>，我很高兴这个解决方案的存在，并且我确信<strong>其他解决方案</strong>（可能更优秀的）也正在路上。我相信，<strong>很快在 Flutter 中创建液态玻璃组件将比在 SwiftUI 中更容易</strong>。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LOG：如何在Linux系统安装微软雅黑字体]]></title>    <link>https://juejin.cn/post/7582155513585975348</link>    <guid>https://juejin.cn/post/7582155513585975348</guid>    <pubDate>2025-12-11T04:21:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582155513585975348" data-draft-id="7582133314686812212" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LOG：如何在Linux系统安装微软雅黑字体"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-11T04:21:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="披荆斩棘的哥哥"/> <meta itemprop="url" content="https://juejin.cn/user/1415826709423757"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LOG：如何在Linux系统安装微软雅黑字体
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1415826709423757/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    披荆斩棘的哥哥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T04:21:40.000Z" title="Thu Dec 11 2025 04:21:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>安装微软雅黑字体，操作系统：Ubuntu22.04</p>
</blockquote>
<ol>
<li>准备字体文件，下载微软雅黑字体，字体格式<code>ttf</code>，文件名称：<code>msyh.ttf</code> <code>msyhbd.ttf</code>。</li>
<li>打开系统字体文件夹：<code>/usr/share/fonts/truetype</code>，创建文件夹：<code>mshy</code>，复制上述字体文件。</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> /usr/share/fonts/truetype
sudo <span class="hljs-built_in">mkdir</span> mshy
sudo <span class="hljs-built_in">cp</span> /path/to/msyh.ttf /usr/share/fonts/truetype/mshy/msyh.ttf
sudo <span class="hljs-built_in">cp</span> /path/to/msyhbd.ttf /usr/share/fonts/truetype/mshy/msyhbd.ttf
</code></pre>
<ol start="3">
<li>修改文件权限为<code>644</code>：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">chmod</span> 644 /usr/share/fonts/truetype/mshy/*.ttf
</code></pre>
<ol start="4">
<li>下载安装字体必要的工具：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">sudo apt-get update
sudo apt-get install xfonts-utils
sudo apt-get install fontconfig
</code></pre>
<ol start="5">
<li>创建字体的<code>fonts.scale</code>文件，控制字体旋转缩放：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">sudo mkfontscale
</code></pre>
<ol start="6">
<li>创建字体的<code>fonts.dir</code>文件，控制字体粗斜体：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">sudo mkfontdir
</code></pre>
<ol start="7">
<li>建立字体缓存信息：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">sudo fc-cache -fv
</code></pre>
<ol start="8">
<li>查看字体是否成功安装：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">fc-list
</code></pre>
<ol start="9">
<li>完成。</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python对接天远数据多头借贷API：AES加密解密、代码实现与数据深度解析]]></title>    <link>https://juejin.cn/post/7582118538562699283</link>    <guid>https://juejin.cn/post/7582118538562699283</guid>    <pubDate>2025-12-11T04:33:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582118538562699283" data-draft-id="7582163781183438854" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python对接天远数据多头借贷API：AES加密解密、代码实现与数据深度解析"/> <meta itemprop="keywords" content="API,大数据"/> <meta itemprop="datePublished" content="2025-12-11T04:33:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="代码方舟"/> <meta itemprop="url" content="https://juejin.cn/user/2789874177939755"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python对接天远数据多头借贷API：AES加密解密、代码实现与数据深度解析
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2789874177939755/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    代码方舟
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T04:33:51.000Z" title="Thu Dec 11 2025 04:33:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">一、多头借贷风险数据的风控价值与应用</h2>
<p>在<strong>银行信贷审批</strong>、<strong>消费金融授信</strong>、<strong>小额贷款风控</strong>以及<strong>互联网金融反欺诈</strong>等众多场景中，精准评估申请人的多头借贷（Multi-Lending）行为是决定放款与否的关键依据。"全国自然人多头借贷风险信息查询"API，能够提供多维度的贷款行为统计与风险标签体系，通过区间化指标精准刻画用户在贷款申请、交易、还款及逾期等方面的历史与近期行为。</p>
<p>本文将作为一份详细的开发文档，深入剖析此API，详细解读其基于AES加密的请求响应机制、返回的原始数据结构以及每一个核心字段的业务含义。通过接入<strong>天远API</strong>提供的这项数据服务，开发者可以帮助企业快速构建贷前风控模型、完善贷中监控体系，并制定更科学的额度策略，从而有效降低坏账风险。</p>
<h2 data-id="heading-1">二、API接口调用示例</h2>
<p>本接口采用高安全性的加密传输机制，开发者在调用前需确保已获取 <code>Access-Id</code> 和 <code>Access-Key</code>。</p>
<h3 data-id="heading-2">1. 调用前置说明</h3>
<ul>
<li>
<p><strong>接口地址</strong>：<code>https://api.tianyuanapi.com/api/v1/JRZQ9E2A?t={13位时间戳}</code></p>
</li>
<li>
<p><strong>请求方式</strong>：POST</p>
</li>
<li>
<p><strong>安全机制</strong>：</p>
<ul>
<li>请求头需携带 <code>Access-Id</code>。</li>
<li>请求体 <code>data</code> 字段为 Base64 编码的 AES 加密字符串。</li>
<li><strong>加密算法</strong>：AES-128-CBC，PKCS7 填充，IV（初始化向量）为随机生成的16字节，拼接在密文前一并 Base64 编码。</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">2. Curl 调用示例</h3>
<p>Bash</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 注意：data 字段必须是经过 AES 加密并 Base64 编码后的字符串</span>
<span class="hljs-comment"># 实际开发中请使用编程语言生成动态的 data 和 t (时间戳)</span>

curl -X POST "&lt;https://api.tianyuanapi.com/api/v1/JRZQ9E2A?<span class="hljs-attr">t</span>=<span class="hljs-number">1716345678000</span>&gt;<span class="hljs-string">" \
  -H "</span>Content-Type: application/json<span class="hljs-string">" \
  -H "</span>Access-Id: YOUR_ACCESS_ID<span class="hljs-string">" \
  -d '{
    "</span>data<span class="hljs-string">": "</span>U2FsdGVkX1+...<span class="hljs-string">" 
  }'
</span></code></pre>
<h3 data-id="heading-4">3. Python 完整调用代码 (含加密解密逻辑)</h3>
<p>本示例使用 <code>requests</code> 库进行网络请求，使用 <code>pycryptodome</code> 库进行 AES 加解密处理。</p>
<p>Python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES
<span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad
<span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> get_random_bytes

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TianyuanRiskAPI</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, access_id, access_key</span>):
        self.access_id = access_id
        <span class="hljs-comment"># 密钥通常为16进制字符串，需根据实际情况处理，此处假设为16字节</span>
        self.access_key = access_key.encode(<span class="hljs-string">'utf-8'</span>)[:<span class="hljs-number">16</span>] 
        self.api_url = <span class="hljs-string">"&lt;https://api.tianyuanapi.com/api/v1/JRZQ9E2A&gt;"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_data</span>(<span class="hljs-params">self, plain_dict</span>):
        <span class="hljs-string">"""
        AES-128-CBC 加密逻辑
        1. 生成随机 16 字节 IV
        2. 使用 PKCS7 填充数据
        3. 加密后将 IV 拼接到密文前
        4. 进行 Base64 编码
        """</span>
        <span class="hljs-keyword">try</span>:
            plain_text = json.dumps(plain_dict).encode(<span class="hljs-string">'utf-8'</span>)
            iv = get_random_bytes(<span class="hljs-number">16</span>)
            cipher = AES.new(self.access_key, AES.MODE_CBC, iv)
            encrypted_bytes = cipher.encrypt(pad(plain_text, AES.block_size))
            <span class="hljs-comment"># 拼接 IV 和 密文，然后 Base64</span>
            combined = iv + encrypted_bytes
            <span class="hljs-keyword">return</span> base64.b64encode(combined).decode(<span class="hljs-string">'utf-8'</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"加密失败: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_data</span>(<span class="hljs-params">self, encrypted_base64</span>):
        <span class="hljs-string">"""
        AES-128-CBC 解密逻辑
        1. Base64 解码
        2. 提取前 16 字节作为 IV
        3. 解密剩余密文并去除填充
        """</span>
        <span class="hljs-keyword">try</span>:
            encrypted_bytes = base64.b64decode(encrypted_base64)
            iv = encrypted_bytes[:<span class="hljs-number">16</span>]
            ciphertext = encrypted_bytes[<span class="hljs-number">16</span>:]
            cipher = AES.new(self.access_key, AES.MODE_CBC, iv)
            decrypted_text = unpad(cipher.decrypt(ciphertext), AES.block_size)
            <span class="hljs-keyword">return</span> json.loads(decrypted_text.decode(<span class="hljs-string">'utf-8'</span>))
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"解密失败: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">query_risk_info</span>(<span class="hljs-params">self, name, id_card, mobile, auth_code</span>):
        <span class="hljs-comment"># 1. 构造请求参数</span>
        payload = {
            <span class="hljs-string">"name"</span>: name,
            <span class="hljs-string">"id_card"</span>: id_card,
            <span class="hljs-string">"mobile_no"</span>: mobile,
            <span class="hljs-string">"auth_authorize_file_code"</span>: auth_code <span class="hljs-comment"># 授权书编号</span>
        }

        <span class="hljs-comment"># 2. 加密参数</span>
        encrypted_data = self.encrypt_data(payload)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> encrypted_data:
            <span class="hljs-keyword">return</span>

        <span class="hljs-comment"># 3. 发起请求</span>
        headers = {<span class="hljs-string">"Access-Id"</span>: self.access_id}
        timestamp = <span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)
        url = <span class="hljs-string">f"<span class="hljs-subst">{self.api_url}</span>?t=<span class="hljs-subst">{timestamp}</span>"</span>
        
        <span class="hljs-keyword">try</span>:
            response = requests.post(url, json={<span class="hljs-string">"data"</span>: encrypted_data}, headers=headers)
            res_json = response.json()

            <span class="hljs-comment"># 4. 处理响应</span>
            <span class="hljs-keyword">if</span> res_json.get(<span class="hljs-string">"code"</span>) == <span class="hljs-number">0</span>: <span class="hljs-comment"># 0 表示业务成功 </span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"请求成功，正在解密数据..."</span>)
                <span class="hljs-comment"># 解密 data 字段</span>
                decrypted_result = self.decrypt_data(res_json.get(<span class="hljs-string">"data"</span>))
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"多头借贷风险数据解析结果："</span>)
                <span class="hljs-built_in">print</span>(json.dumps(decrypted_result, indent=<span class="hljs-number">4</span>, ensure_ascii=<span class="hljs-literal">False</span>))
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"API请求错误: Code <span class="hljs-subst">{res_json.get(<span class="hljs-string">'code'</span>)}</span>, Message: <span class="hljs-subst">{res_json.get(<span class="hljs-string">'message'</span>)}</span>"</span>)
        
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"网络请求异常: <span class="hljs-subst">{e}</span>"</span>)

<span class="hljs-comment"># 使用示例</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># 请替换为实际的 Access-Id 和 Access-Key</span>
    api_client = TianyuanRiskAPI(<span class="hljs-string">"YOUR_ACCESS_ID"</span>, <span class="hljs-string">"YOUR_ACCESS_KEY_128BIT"</span>)
    
    api_client.query_risk_info(
        name=<span class="hljs-string">"张三"</span>,
        id_card=<span class="hljs-string">"110101199001011234"</span>,
        mobile=<span class="hljs-string">"13800138000"</span>,
        auth_code=<span class="hljs-string">"AUTH20251210001"</span>
    )
</code></pre>
<h2 data-id="heading-5">三、核心数据结构解析</h2>
<p>API 的响应数据分为两层。第一层是公共响应参数，包含状态码和流水号；第二层是加密的 <code>data</code> 业务数据，解密后是一个包含数百个风险指标的 JSON 对象。</p>
<h3 data-id="heading-6">1. 公共响应结构</h3>






























<table><thead><tr><th><strong>字段名</strong></th><th><strong>类型</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>code</td><td>int</td><td>状态码，0表示成功，非0表示异常（如1002参数解密失败）</td></tr><tr><td>message</td><td>string</td><td>错误或成功信息描述</td></tr><tr><td>transaction_id</td><td>string</td><td>业务流水号，用于排查问题</td></tr><tr><td>data</td><td>string</td><td><strong>加密后的业务数据</strong>，需解密查看</td></tr></tbody></table>
<h3 data-id="heading-7">2. 业务数据层级</h3>
<p>解密后的 JSON 数据主要包含以下几类指标：</p>
<ul>
<li><strong>机构数量统计</strong>：如贷款总机构数、近7天/30天贷款机构数。</li>
<li><strong>交易与还款行为</strong>：历史还款成功笔数、交易失败笔数。</li>
<li><strong>逾期风险指标</strong>：当前逾期状态、历史逾期天数。</li>
<li><strong>金额统计</strong>：近30天/90天/180天的交易与还款金额统计。</li>
<li/>
</ul>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-strong">**模型评分**</span>：信用风险评分、小额网贷分等。
</code></pre>
<h2 data-id="heading-8">四、字段详解</h2>
<p>由于接口返回字段极其丰富，以下列举核心风控场景中最常用的字段进行解析。注意，大部分金额和次数类字段采用<strong>区间化输出</strong>（Mapping），例如 "1" 可能代表 "(0,9)" 区间。</p>
<h3 data-id="heading-9">1. 机构申请与借贷概览</h3>



































<table><thead><tr><th><strong>参数代码</strong></th><th><strong>中文描述</strong></th><th><strong>说明/区间示例</strong></th></tr></thead><tbody><tr><td>xyp_cpl0001</td><td>贷款总机构数</td><td>区间输出，如 "1"代表(0,9)家</td></tr><tr><td>xyp_cpl0002</td><td>贷款已结清机构数</td><td>衡量用户过往信誉，区间输出</td></tr><tr><td>xyp_cpl0044</td><td>当前是否存在逾期未结清</td><td><strong>重要</strong>：1 - 逾期 ； 0 - 未逾期</td></tr><tr><td>xyp_cpl0007</td><td>消费金融类机构数</td><td>包含有场景的分期业务</td></tr><tr><td>xyp_cpl0008</td><td>网络贷款类机构数</td><td>主要指现金贷类机构</td></tr></tbody></table>
<h3 data-id="heading-10">2. 短期申请集中度（多头预警）</h3>

























<table><thead><tr><th><strong>参数代码</strong></th><th><strong>中文描述</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>xyp_cpl0070</td><td>最近1天贷款机构数</td><td>突发急借指标</td></tr><tr><td>xyp_cpl0009</td><td>最近7天贷款机构数</td><td>衡量短期资金饥渴度</td></tr><tr><td>xyp_cpl0011</td><td>最近30天贷款机构数</td><td>中短期多头借贷风险指标</td></tr></tbody></table>
<h3 data-id="heading-11">3. 逾期与履约能力</h3>






























<table><thead><tr><th><strong>参数代码</strong></th><th><strong>中文描述</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>xyp_cpl0028</td><td>最近1天是否发生过逾期</td><td>1-逾期，0-未逾期</td></tr><tr><td>xyp_cpl0031</td><td>最近30天是否发生过逾期</td><td>反应近期还款压力</td></tr><tr><td>xyp_cpl0071</td><td>当前逾期机构数</td><td>同时违约的平台数量</td></tr><tr><td>xyp_cpl0072</td><td>当前逾期金额</td><td>违约资金规模（区间化）</td></tr></tbody></table>
<h3 data-id="heading-12">4. 信用评分与模型分</h3>

























<table><thead><tr><th><strong>参数代码</strong></th><th><strong>中文描述</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>xyp_cpl0081</td><td>信用风险评分</td><td>0-1之间，分数越高用户信用越低</td></tr><tr><td>xyp_model_score_high</td><td>小额网贷分V1</td><td>[350,950]，分数越大逾期率越</td></tr><tr><td>xyp_model_score_mid</td><td>小额分期分V1</td><td>[350,950]，分数越大逾期率越低</td></tr></tbody></table>
<h2 data-id="heading-13">五、应用价值分析</h2>
<p>通过集成<strong>天远API</strong>的多头借贷风险查询服务，开发者可以为企业风控系统带来显著价值：</p>
<ol>
<li>
<p>精准识别"拆东墙补西墙"：</p>
<p>通过分析 xyp_cpl0009 (近7天贷款机构数) 和 xyp_cpl0031 (近30天是否逾期) 等字段，系统能快速识别出急需资金周转的潜在高风险用户，有效拦截共债风险。</p>
</li>
<li>
<p>量化评估还款能力：</p>
<p>利用 xyp_cpl0039 (近30天还款成功总金额) 与 xyp_cpl0072 (当前逾期金额) 的对比，结合收入证明，金融机构可以更科学地核定授信额度，避免过度授信。</p>
</li>
<li>
<p>贷中动态监控：</p>
<p>对于存量客户，定期调用此API监控其 xyp_cpl0044 (当前是否存在逾期) 和 xyp_cpl0008 (网贷机构数) 的变化。一旦发现用户在短时间内在多家平台发生借贷行为，系统可触发预警，及时采取降额或催收策略。</p>
</li>
</ol>
<h2 data-id="heading-14">六、总结</h2>
<p>全国自然人多头借贷风险信息查询API为金融科技开发者提供了一套标准化、数据化、区间化的风控解决方案。虽然其接口涉及 AES 加密与 Base64 编码，增加了一定的对接门槛，但这也极大地保障了用户隐私数据的传输安全。</p>
<p>建议开发者在接入过程中，重点关注错误码处理（如 1002 解密失败、1007 余额不足），并建立完善的日志系统。通过合理利用<strong>天远API</strong>提供的丰富维度数据，企业将能够构建出更加坚固的风险防火墙。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Method Agent：一款无侵入的Spring方法级调试神器]]></title>    <link>https://juejin.cn/post/7582163781183602694</link>    <guid>https://juejin.cn/post/7582163781183602694</guid>    <pubDate>2025-12-11T04:56:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582163781183602694" data-draft-id="7582118538562715667" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Method Agent：一款无侵入的Spring方法级调试神器"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-11T04:56:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="caterpillar"/> <meta itemprop="url" content="https://juejin.cn/user/397351653214539"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Method Agent：一款无侵入的Spring方法级调试神器
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/397351653214539/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    caterpillar
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T04:56:35.000Z" title="Thu Dec 11 2025 04:56:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    14
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Spring Method Agent：一款无侵入的Spring方法级调试神器</h2>
<h3 data-id="heading-1">🎯 工具简介</h3>
<p><strong>Spring Method Agent</strong>​ 是一款面向Java开发者的高效调试工具，能够以<strong>零代码侵入</strong>的方式对Spring项目进行方法级别的测试和调试。通过Java Agent技术，在Spring应用启动时进行增强，无需修改任何业务代码即可实现方法的可视化查询与调用。</p>
<h3 data-id="heading-2">✨ 核心特性</h3>
<ul>
<li><strong>无代码侵入</strong>：基于Java Agent实现，对应用完全透明</li>
<li><strong>可视化操作</strong>：内置Web界面，直观查看和调用Spring Bean方法</li>
<li><strong>方法Mock支持</strong>：无需修改代码即可模拟方法返回值</li>
<li><strong>条件Mock</strong>：支持基于条件的智能Mock规则</li>
<li><strong>多数据类型</strong>：支持JSON、对象、数组、基本类型等多种返回值</li>
<li><strong>灵活配置</strong>：支持动态配置和规则管理</li>
</ul>
<h3 data-id="heading-3">🚀 快速开始</h3>
<h4 data-id="heading-4">1. 下载安装</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fxiaowomiaomiao%2Fspring-method-agent" target="_blank" title="https://gitee.com/xiaowomiaomiao/spring-method-agent" ref="nofollow noopener noreferrer">gitee.com/xiaowomiaom…</a></p>
<h4 data-id="heading-5">2. 配置启动参数</h4>
<pre><code class="hljs language-bash" lang="bash">-javaagent:{your path}/spring-method-agent-2.0.0.jar
</code></pre>
<h4 data-id="heading-6">3. 启动应用</h4>
<p>应用启动后，工具会监听<strong>8100端口</strong>（可通过<code>-Dagent.port=8080</code>修改）</p>
<h4 data-id="heading-7">4. 访问界面</h4>
<pre><code class="hljs language-arduino" lang="arduino">http:<span class="hljs-comment">//localhost:8100</span>
</code></pre>
<h3 data-id="heading-8">🔧 Mock功能介绍</h3>
<h4 data-id="heading-9">启用Mock</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">-Dsma.mockEnable</span>=<span class="hljs-literal">true</span>
<span class="hljs-attr">-Dsma.configPath</span>=/yourPath/sma-mockConfig
</code></pre>
<h4 data-id="heading-10">配置文件示例</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"globalEnabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"rules"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"org.example.controller.EchoController"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"methodName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"conditionField"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"url"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"conditionValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"hello"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"mockReturnValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"lin"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"org.example.controller.EchoController"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"methodName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"conditionField"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user.name"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"conditionValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"mockReturnValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-11">支持的数据类型</h4>
<ul>
<li>字符串：<code>"mockReturnValue": "lin"</code></li>
<li>数字：<code>"mockReturnValue": 3.14</code></li>
<li>布尔值：<code>"mockReturnValue": true</code></li>
<li>对象：<code>"mockReturnValue": { "age": 18, "name": "bob" }</code></li>
<li>数组：<code>"mockReturnValue": [1, 2, 3]</code></li>
<li>JSON字符串：<code>"mockReturnValue": "{ "items": [1,2,3], "count": 3 }"</code></li>
</ul>
<h3 data-id="heading-12">📊 应用场景</h3>
<h4 data-id="heading-13">1. 快速调试</h4>
<p>无需编写测试代码，直接在Web界面调用任意Spring Bean方法，查看返回结果。</p>
<h4 data-id="heading-14">2. 集成测试</h4>
<p>在联调阶段模拟依赖服务的响应，无需启动完整的依赖链。</p>
<h4 data-id="heading-15">3. 问题排查</h4>
<p>生产环境问题复现时，可以临时Mock方法返回值，快速定位问题。</p>
<h4 data-id="heading-16">4. 演示展示</h4>
<p>在演示时Mock特定数据，避免依赖外部服务的不稳定性。</p>
<h3 data-id="heading-17">🎨 使用示例</h3>
<h4 data-id="heading-18">场景一：条件Mock</h4>
<p>当用户名为"bob"时，返回预设的用户信息：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"org.example.controller.UserController"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"methodName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"getUserInfo"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"conditionField"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user.name"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"conditionValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"mockReturnValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"role"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"admin"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-19">场景二：异常模拟</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"org.example.service.PaymentService"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"methodName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"processPayment"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"conditionField"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"amount"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"conditionValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10000</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"mockReturnValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"余额不足"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"INSUFFICIENT_BALANCE"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-20">🔄 配置参数说明</h3>













































<table><thead><tr><th>参数</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td><code>className</code></td><td>完整类名（全限定名）</td><td>必填</td></tr><tr><td><code>methodName</code></td><td>要Mock的方法名</td><td>必填</td></tr><tr><td><code>conditionField</code></td><td>条件字段路径（可选）</td><td>可选</td></tr><tr><td><code>conditionValue</code></td><td>条件匹配值（可选）</td><td>可选</td></tr><tr><td><code>mockReturnValue</code></td><td>Mock返回值</td><td>必填</td></tr><tr><td><code>enabled</code></td><td>规则开关</td><td>true</td></tr><tr><td><code>globalEnabled</code></td><td>全局Mock开关</td><td>true</td></tr></tbody></table>
<h3 data-id="heading-21">⚡ 性能优势</h3>
<ul>
<li><strong>低开销</strong>：仅在方法调用时进行匹配检查</li>
<li><strong>按需加载</strong>：Mock规则可动态配置</li>
<li><strong>精准匹配</strong>：支持条件匹配，避免不必要的Mock开销</li>
</ul>
<h3 data-id="heading-22">📈 对比传统方案</h3>

































<table><thead><tr><th>方案</th><th>代码侵入</th><th>维护成本</th><th>灵活性</th><th>学习成本</th></tr></thead><tbody><tr><td>传统单元测试</td><td>高</td><td>高</td><td>低</td><td>高</td></tr><tr><td>Mock框架</td><td>中</td><td>中</td><td>中</td><td>中</td></tr><tr><td><strong>Spring Method Agent</strong>​</td><td><strong>无</strong>​</td><td><strong>低</strong>​</td><td><strong>高</strong>​</td><td><strong>低</strong>​</td></tr></tbody></table>
<h3 data-id="heading-23">🤝 贡献与反馈</h3>
<p>该项目已在GitHub开源，欢迎提交Issue和PR： GitHub项目地址</p>
<h3 data-id="heading-24">💡 使用建议</h3>
<ol>
<li><strong>开发环境</strong>：长期启用，提升开发效率</li>
<li><strong>测试环境</strong>：用于集成测试和场景模拟</li>
<li><strong>生产环境</strong>：仅用于紧急问题排查，建议谨慎使用</li>
</ol>
<hr/>
<p>通过这个工具，开发者可以<strong>节省大量</strong>的测试代码编写时间，<strong>提升调试效率</strong>，让Spring应用的调试和测试变得更加简单高效。立即尝试，体验无侵入式调试的魅力！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[实现紧贴边框的高亮流光动画效果（长方形适配）]]></title>    <link>https://juejin.cn/post/7582156410319388682</link>    <guid>https://juejin.cn/post/7582156410319388682</guid>    <pubDate>2025-12-11T03:50:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156410319388682" data-draft-id="7582110969201049638" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="实现紧贴边框的高亮流光动画效果（长方形适配）"/> <meta itemprop="keywords" content="前端,JavaScript,CSS"/> <meta itemprop="datePublished" content="2025-12-11T03:50:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="茄汁面"/> <meta itemprop="url" content="https://juejin.cn/user/4143434758889517"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            实现紧贴边框的高亮流光动画效果（长方形适配）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4143434758889517/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    茄汁面
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T03:50:21.000Z" title="Thu Dec 11 2025 03:50:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在前端开发中，边框流光动画是提升界面科技感的常用效果。本文将基于精简的 HTML+CSS 代码，实现「3px 宽高亮流光 + 紧贴边框流动 + 拐角停顿」的效果，适配从正方形到长方形的容器形态，代码简洁易复用，适合直接集成到项目中。</p>
<h2 data-id="heading-0">效果核心亮点</h2>
<ul>
<li><strong>精准贴合</strong>：流光线条完全紧贴容器边框，无偏移、无超出</li>
<li><strong>精致质感</strong>：3px 纤细线条 + 蓝紫渐变 + 多层发光阴影，亮度充足不刺眼</li>
<li><strong>丝滑流动</strong>：四个拐角均有停顿过渡，拉伸时仅单维度变化，无顿挫感</li>
<li><strong>灵活适配</strong>：支持正方形、长方形等多种容器形态，无需大幅修改代码</li>
</ul>
<h2 data-id="heading-1">完整实现代码</h2>
<p>html</p>
<p>预览</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>3px边框流光动画<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-comment">/* 页面居中布局基础样式 */</span>
    <span class="hljs-selector-tag">body</span> {
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">justify-content</span>: center;
      <span class="hljs-attribute">align-items</span>: center;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0a1929</span>; <span class="hljs-comment">/* 深色背景凸显流光效果 */</span>
    }

    <span class="hljs-comment">/* 外层容器：控制整体尺寸和阴影 */</span>
    <span class="hljs-selector-class">.container</span> {
      <span class="hljs-attribute">position</span>: relative;
      <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>; <span class="hljs-comment">/* 可修改为任意宽度（如52%适配响应式） */</span>
      <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>; <span class="hljs-comment">/* 可修改为任意高度（如20%适配屏幕高度） */</span>
      <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">60px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">188</span>, <span class="hljs-number">212</span>, <span class="hljs-number">0.3</span>);
    }

    <span class="hljs-comment">/* 内层内容框：长方形示例（宽50%+高20%） */</span>
    <span class="hljs-selector-class">.box</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">50%</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">20%</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;
      <span class="hljs-attribute">position</span>: relative;
      <span class="hljs-attribute">overflow</span>: hidden;
      <span class="hljs-attribute">z-index</span>: <span class="hljs-number">2</span>;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">12</span>, <span class="hljs-number">30</span>, <span class="hljs-number">50</span>, <span class="hljs-number">0.8</span>); <span class="hljs-comment">/* 半透明深色背景 */</span>
    }

    <span class="hljs-comment">/* 流光线条核心样式 */</span>
    <span class="hljs-selector-class">.container</span><span class="hljs-selector-pseudo">::before</span> {
      <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
      <span class="hljs-attribute">position</span>: absolute;
      <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1</span>; <span class="hljs-comment">/* 低于内容框层级，不遮挡内容 */</span>
      <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* 紧贴容器顶部边框 */</span>
      <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* 紧贴容器左侧边框 */</span>
      <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>; <span class="hljs-comment">/* 固定3px宽度 */</span>
      <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>; <span class="hljs-comment">/* 初始高度与宽度一致 */</span>
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">2px</span>; <span class="hljs-comment">/* 圆角优化，避免生硬 */</span>
      <span class="hljs-comment">/* 蓝紫渐变：增强科技感 */</span>
      <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(
        <span class="hljs-number">135deg</span>,
        <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">245</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.6</span>) <span class="hljs-number">0%</span>,
        <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">132</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>) <span class="hljs-number">50%</span>,
        <span class="hljs-built_in">rgba</span>(<span class="hljs-number">110</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.6</span>) <span class="hljs-number">100%</span>
      );
      <span class="hljs-comment">/* 多层发光阴影：提升亮度和层次感 */</span>
      <span class="hljs-attribute">box-shadow</span>:
        <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">119</span>, <span class="hljs-number">182</span>, <span class="hljs-number">0.8</span>),
        <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">25px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">150</span>, <span class="hljs-number">199</span>, <span class="hljs-number">0.6</span>),
        <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">40px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">245</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.4</span>),
        inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">8px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">119</span>, <span class="hljs-number">182</span>, <span class="hljs-number">0.5</span>);
      <span class="hljs-comment">/* 双动画：流动+呼吸发光 */</span>
      <span class="hljs-attribute">animation</span>: flow <span class="hljs-number">6s</span> linear infinite, glow <span class="hljs-number">3s</span> linear infinite alternate;
      <span class="hljs-attribute">pointer-events</span>: none; <span class="hljs-comment">/* 避免遮挡鼠标事件 */</span>
    }

    <span class="hljs-comment">/* 流动动画：紧贴边框+拐角停顿 */</span>
    <span class="hljs-keyword">@keyframes</span> flow {
      <span class="hljs-number">0%</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
      }
      <span class="hljs-comment">/* 上边框：左→右拉伸（高度固定3px） */</span>
      <span class="hljs-number">15%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>; <span class="hljs-comment">/* 精准匹配容器宽度 */</span>
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-comment">/* 右上角收缩停顿（5%时长） */</span>
      <span class="hljs-number">20%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>); <span class="hljs-comment">/* 容器右边缘 - 线条宽度 */</span>
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-number">25%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>);
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-comment">/* 右边框：上→下拉伸（宽度固定3px） */</span>
      <span class="hljs-number">40%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>);
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>; <span class="hljs-comment">/* 精准匹配容器高度 */</span>
      }
      <span class="hljs-comment">/* 右下角收缩停顿（5%时长） */</span>
      <span class="hljs-number">45%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>);
        <span class="hljs-attribute">top</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>); <span class="hljs-comment">/* 容器下边缘 - 线条宽度 */</span>
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-number">50%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>);
        <span class="hljs-attribute">top</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>);
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-comment">/* 下边框：右→左拉伸（高度固定3px） */</span>
      <span class="hljs-number">65%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>);
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-comment">/* 左下角收缩停顿（5%时长） */</span>
      <span class="hljs-number">70%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>);
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-number">75%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">3px</span>);
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-comment">/* 左边框：下→上拉伸（宽度固定3px） */</span>
      <span class="hljs-number">85%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
      }
      <span class="hljs-comment">/* 左上角收缩停顿（10%时长，闭环过渡） */</span>
      <span class="hljs-number">90%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
      <span class="hljs-number">100%</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">3px</span>;
      }
    }

    <span class="hljs-comment">/* 呼吸发光动画：增强视觉冲击 */</span>
    <span class="hljs-keyword">@keyframes</span> glow {
      <span class="hljs-selector-tag">from</span> {
        <span class="hljs-attribute">box-shadow</span>:
          <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">119</span>, <span class="hljs-number">182</span>, <span class="hljs-number">0.7</span>),
          <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">150</span>, <span class="hljs-number">199</span>, <span class="hljs-number">0.5</span>),
          <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">45px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">245</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.3</span>),
          inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">119</span>, <span class="hljs-number">182</span>, <span class="hljs-number">0.4</span>);
      }
      <span class="hljs-selector-tag">to</span> {
        <span class="hljs-attribute">box-shadow</span>:
          <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">119</span>, <span class="hljs-number">182</span>, <span class="hljs-number">0.9</span>),
          <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">60px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">150</span>, <span class="hljs-number">199</span>, <span class="hljs-number">0.7</span>),
          <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">80px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">245</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>),
          inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">119</span>, <span class="hljs-number">182</span>, <span class="hljs-number">0.6</span>);
      }
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 data-id="heading-2">关键实现逻辑解析</h2>
<h3 data-id="heading-3">1. 线条紧贴边框的核心设计</h3>
<ul>
<li>坐标定位：<code>top: 0</code> 和 <code>left: 0</code> 让线条从容器左上角边框开始，无任何偏移</li>
<li>尺寸计算：拉伸时使用 <code>width: 100%</code>/<code>height: 100%</code> 精准匹配容器尺寸，拐角处通过 <code>calc(100% - 3px)</code> 计算位置（容器边缘 - 线条宽度），确保完全贴合</li>
<li>层级控制：<code>z-index: 1</code> 让线条处于内容框下方，不遮挡内部内容</li>
</ul>
<h3 data-id="heading-4">2. 丝滑流动的动画设计</h3>
<ul>
<li>单维度拉伸：每个拉伸阶段只变化一个维度（要么宽、要么高），另一个维度固定 3px，避免同步变化导致的顿挫感</li>
<li>拐角停顿：每个拐角设置 5% 的停顿时长（如 20%-25%、45%-50%），让线条在拐角处 "站稳" 后再继续流动，过渡更自然</li>
<li>线性节奏：<code>linear</code> 动画 timing 函数确保全程速度均匀，无快慢波动</li>
</ul>
<h3 data-id="heading-5">3. 高亮效果的视觉优化</h3>
<ul>
<li>渐变底色：蓝紫渐变（<code>rgba(0,245,255,0.6)</code> 到 <code>rgba(110,0,255,0.6)</code>）增强科技感，透明度控制避免过于刺眼</li>
<li>多层阴影：外层阴影扩大发光范围，内层阴影增强线条本身亮度，形成立体发光效果</li>
<li>呼吸动画：<code>glow</code> 动画通过切换阴影强度，实现呼吸式发光，提升视觉层次感</li>
</ul>
<h2 data-id="heading-6">灵活适配指南</h2>
<h3 data-id="heading-7">1. 容器形态适配（正方形→长方形）</h3>
<ul>
<li>
<p>正方形：保持 <code>container</code> 的 <code>width</code> 和 <code>height</code> 相等（如 200px×200px），动画无需修改</p>
</li>
<li>
<p>长方形：修改 <code>container</code> 的宽高比例（如宽度 52%、高度 20%），动画会自动适配，线条始终紧贴边框</p>
</li>
<li>
<p>示例：如需适配屏幕高度 20%、宽度 52% 的容器，只需修改：</p>
<p>css</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">52%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">20vh</span>; <span class="hljs-comment">/* 屏幕高度的20% */</span>
}
</code></pre>
</li>
</ul>
<h3 data-id="heading-8">2. 样式自定义调整</h3>
<ul>
<li>
<p>线条宽度：修改 <code>.container::before</code> 中的 <code>width: 3px</code>（如 2px 更纤细，4px 更粗实）</p>
</li>
<li>
<p>颜色调整：修改 <code>background</code> 中的渐变色值（如纯蓝色 <code>rgba(0,200,255,0.7)</code>）</p>
</li>
<li>
<p>动画速度：</p>
<ul>
<li>流动速度：调整 <code>flow</code> 动画的 <code>6s</code>（数值越小越快，如 4s 更急促，8s 更舒缓）</li>
<li>呼吸速度：调整 <code>glow</code> 动画的 <code>3s</code></li>
</ul>
</li>
<li>
<p>发光强度：修改 <code>glow</code> 动画中的阴影数值（数值越大发光越强，反之则越柔和）</p>
</li>
</ul>
<h3 data-id="heading-9">3. 应用场景扩展</h3>
<ul>
<li>数据可视化大屏：搭配深色背景和数据组件，提升科技感</li>
<li>后台管理系统：用于卡片、面板边框，增强界面层次</li>
<li>展示型网站：用于重点内容区块边框，吸引用户注意力</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elpis Webpack工程化·自我学习总结]]></title>    <link>https://juejin.cn/post/7582156410319454218</link>    <guid>https://juejin.cn/post/7582156410319454218</guid>    <pubDate>2025-12-11T04:16:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156410319454218" data-draft-id="7577256255084609545" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elpis Webpack工程化·自我学习总结"/> <meta itemprop="keywords" content="Webpack,前端工程化"/> <meta itemprop="datePublished" content="2025-12-11T04:16:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="一念之间lq"/> <meta itemprop="url" content="https://juejin.cn/user/2541726616524583"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elpis Webpack工程化·自我学习总结
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2541726616524583/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    一念之间lq
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T04:16:09.000Z" title="Thu Dec 11 2025 04:16:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读13分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">一.认识Webpack</h2>
<p>webpack是一个现代JavaScript应用程序的静态模块打包器。它主要用于将多个模块（包括JavaScript、CSS、图片等）打包成一个或多个bundle文件，以便在浏览器中高效加载。</p>
<p>webpack的作用：</p>
<ol>
<li>模块打包：将多个模块按照依赖关系打包成静态资源，减少HTTP请求次数。</li>
<li>编译转换：通过加载器（loader）将其他类型的文件（如TypeScript、CSS、图片、字体）转换成浏览器可识别的格式。</li>
<li>代码分割：将代码拆分成多个块，实现按需加载，提高首屏加载速度。</li>
<li>插件系统：通过插件（plugin）扩展功能，如优化、压缩、环境变量注入等。</li>
<li>开发服务器：提供热重载（hot reload）功能，提升开发效率。</li>
</ol>
<h2 data-id="heading-1">二.Webpack构建流程</h2>
<h3 data-id="heading-2">1.读取配置文件</h3>
<p>Webpack会读取命令行传入的参数以及项目中的配置文件(webpack.config.js),合并成最终配置。</p>
<h3 data-id="heading-3">2.创建 Compiler 对象</h3>
<p>根据上面的配置创建 Webpack 的核心对象 <code>Compiler</code>,并注册所有配置的插件,执行插件的 <code>apply</code>方法</p>
<h3 data-id="heading-4">3.解析Entry入口文件</h3>
<p>为每个Entry 入口文件创建Module对象,将入口模块添加到编译依赖图中</p>
<h3 data-id="heading-5">4.Loader模块转换</h3>
<p>根据模块文件类型(js,css,.vue,.ts)匹配对应的Loader,Loader从左到右(从上到下)顺序执行,将模块内容转化为JavaScript模块,Loader翻译完成后,Webpack将js代码转换成AST(抽象语法树)</p>
<h3 data-id="heading-6">5.分析依赖</h3>
<p>在中AST遍历寻找import,require等依赖,针对每个模块进行"Loader转换 -&gt; AST解析 -&gt; 分析依赖"</p>
<h3 data-id="heading-7">6.封装模块</h3>
<p>这里通过<code>seal()</code>所有模块编译完成，得到模块依赖图</p>
<blockquote>
<p>Tree Shaking 优化(标记未使用的导出,减少无用的依赖):Webpack 依靠ES6 Module 的静态结构,分析出那些export 没被引用,再下一步的Chunk代码中进行移除</p>
</blockquote>
<h3 data-id="heading-8">7.组装Chunk文件</h3>
<p>根据入口文件(Entry)和代码分割(splitChunks)规则,Webpack合并成一个或多个Chunk 代码块</p>
<h3 data-id="heading-9">8.输出文件</h3>
<p>Webpack 会根据配置的<code>output.path</code>,<code>output.feilname</code>,将文件写入磁盘中,一般生成一个新的<code>dist</code>文件夹</p>
<h2 data-id="heading-10">三.Webpack的核心概念</h2>
<h3 data-id="heading-11">1. 入口文件(Entry)</h3>
<p><code>Entry</code>是webpack构建过程的起点,从入口开始递归地构建成一个依赖图,将每个模块打包到一起,最终生成一个<code>xxxx.bundle.js</code>文件产物。入口可以配置单入口或多入口。</p>
<ul>
<li>单入口: 只有一个入口文件的引入,只生成一个对应的bundle.js文件</li>
<li>多入口: 拥有多个入口文件的引入,生成多个对应的bundle.js文件</li>
</ul>
<p>不管单入口还是多入口的文件最终产物生成的是<code>bundle.js</code>文件,只是生成数量的问题,最终我们是需要将引入到页面中进行业务的呈现。此时Webpack中使用<code>html-webpack-plugin</code>插件会将我们的<code>bundle.js</code>文件自动引入到我们指定的页面中。</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// html-webpack-plugin 使用逻辑</span>
<span class="hljs-comment">//动态构造 entry 入口对象和 html-webpack-plugin 插件实例</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)

<span class="hljs-keyword">const</span> pageEntries = {}
<span class="hljs-keyword">const</span> htmlWebpackPluginList = []
<span class="hljs-comment">//自动加载app/pages目录下的入口文件</span>
<span class="hljs-keyword">const</span> entryList = glob.<span class="hljs-title function_">sync</span>(path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/**/entry.*.js'</span>))
entryList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">filePath</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> entryName = path.<span class="hljs-title function_">basename</span>(filePath, <span class="hljs-string">'.js'</span>)
  <span class="hljs-comment">//构造entry对象</span>
  pageEntries[entryName] = filePath
  <span class="hljs-comment">//构造最终渲染的页面文件</span>
  htmlWebpackPluginList.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>({
    <span class="hljs-comment">//产物 (最终末班) 输出路径</span>
    <span class="hljs-attr">filename</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/public/dist/'</span>, <span class="hljs-string">`<span class="hljs-subst">${entryName}</span>.tpl`</span>),
    <span class="hljs-comment">//指定要使用的模板文件</span>
    <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/view/entry.tpl'</span>),
    <span class="hljs-comment">//要注入的代码块</span>
    <span class="hljs-attr">chunks</span>: [entryName],
  }))
})

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
   <span class="hljs-comment">//入口配置</span>
  <span class="hljs-attr">entry</span>: pageEntries,
  <span class="hljs-attr">plugins</span>:[
     ...htmlWebpackPluginList
  ]
}

</code></pre>
<blockquote>
<p>因为在多入口的配置过程中,我们需要将进行 <code>new HtmlWebpackPlugin</code> 该操作来将<code>bundle.js</code>自动注入页面模版中, 如果入口数量过多需要多次 <code>new HtmlWebpackPlugin</code> 操作,所以采用动态构建来完成js代码注入工作。当然项目是个单入口的配置时,按照Webpack的配置进行单独配置就行,没有多次编写的麻烦。</p>
</blockquote>
<h3 data-id="heading-12">2. 加载器(Loaders)</h3>
<p>将非 JavaScript 模块转换为 webpack 能够处理的模块，即 webpack 本身只支持 JavaScript，通过加载器可以将其他类型的资源（如 CSS、图片、TypeScript 等）转换为有效的模块。</p>
<p>常用Loaders:</p>
<ul>
<li>babel-loader:将ES 6转换为向后兼容的JS版本,解决不同浏览器之间的兼容性问题</li>
<li>css-loader: 解析 CSS 文件中的 @import 和 url(),主要是分析css中模块依赖关系</li>
<li>style-loader :将CSS注入页面中去,一般配合着<code>css-loader</code>一起使用</li>
<li>sass-loader/less-loader: 将sass/less 编译为为CSS.</li>
<li>file-loader :将文件复制到输出目录并返回 public URL</li>
<li>url-loader: 类似于 file-loader，但可以设置文件大小限制,将小文件转换为Base64编码的Data url</li>
<li>vue-loader :用来解析和转换(模版,脚本,样式)<code>.vue</code>文件</li>
</ul>
<p>如何实现一个Loader 加载器:</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// my-loader.js </span>
<span class="hljs-comment">// 自定义 loader: 去除.vue文件中所有的console.log 打印</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">source</span>) {
    <span class="hljs-comment">// source: 文件内容（字符串）</span>
    <span class="hljs-comment">// this: loader 上下文对象</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>); <span class="hljs-comment">//接受 options 配置参数</span>
    <span class="hljs-keyword">const</span> closeConSource=source.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/console\.log\(.+?\);/g</span>, <span class="hljs-string">''</span>)
    <span class="hljs-keyword">return</span> closeConSource
}

<span class="hljs-comment">//自定义loader 引入</span>
<span class="hljs-comment">//遵循由下往上的规则,先执行自定义的loader再去执行vue-loader</span>
{
   <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,
   <span class="hljs-attr">use</span>: [
     <span class="hljs-string">'vue-loader'</span>,
    {
      <span class="hljs-attr">loader</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'../loaders/my-loader.js'</span>),
      <span class="hljs-attr">options</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'my-loader'</span> }
     }
   ]
}

</code></pre>
<p>在使用vue-loader 如何进行查找顺序(由近到远,优先到项目结构内查找,再到全局进行查找)：</p>
<ul>
<li><strong>项目本地的 node_modules</strong>​ (优先)</li>
<li><strong>上级目录的 node_modules</strong>​ (递归向上查找)</li>
<li><strong>全局安装的 node_modules</strong></li>
</ul>
<h3 data-id="heading-13">3. 插件(Plugins)</h3>
<p>插件是 Webpack 的扩展功能，拥有强大的能力。要使用一个插件，你只需要 <code>require()</code>它，然后把它添加到 <code>plugins</code>数组中。例如<strong>打包优化、资源管理、环境变量注入</strong>等都可以通过插件来完成,可以在Webpack 的整个编译生命周期中通过<code>hook</code>函数来处理各种复杂的任务。</p>
<p>常见的Plugins 插件:</p>
<ul>
<li>HtmlWebpackPlugin :将构建好的<code>bundle</code>,自动注入到页面模版文件中</li>
<li>CleanWebpackPlugin :每次构建前将上一次的构建产物删除</li>
<li>MiniCssExtractPlugin :将 CSS 从主 JS 文件中提取出来，成为一个独立的 CSS 文件（而不是嵌在 JS 里），利于浏览器缓存和并行加载。</li>
<li>CopyWebpackPlugin: 通常用于复制静态文件(图标,字体)到输出目录</li>
<li>DefinePlugin :可在代码中定义全局变量,用于在开发和生产不同环境下配置使用</li>
<li>HotModuleReplacementPlugin: Webpack中热模块替换(HMR)功能,在开发阶段能实时查看代码更新变化</li>
</ul>
<p>如何实现一个自定义的plugins</p>
<p>①.首先我们要了解在Webpack中，插件是一个具有<code>apply</code>方法的JavaScript对象。apply方法会被webpack compiler调用，并且在整个编译生命周期都可以访问compiler对象。</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomPlugin</span> {
  <span class="hljs-comment">// 构造函数，用于接收配置选项</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = options;
  }
  <span class="hljs-comment">// apply 方法，Webpack 会自动调用并传入 compiler 对象</span>
  <span class="hljs-title function_">apply</span>(<span class="hljs-params">compiler</span>) {
    <span class="hljs-comment">// 在这里注册hook函数</span>
  }
}
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">MyCustomPlugin</span>;
</code></pre>
<p>②.了解webpack不同<code>Hook函数</code>的调用时期,这样确认我们编写的自定义plugins功能在对应的Hook函数下面进行,但是Hook函数的类型不同(同步/异步)我们注册事件的方式也不一样,例如常见的有 <code>tap</code>, <code>tapAsync</code>, <code>tapPromise</code>等,根据命名我就可以推断<code>tap</code>处理同步,<code>tapAsync</code>处理异步,以及在部分场景必须返回Promise时使用<code>tapPromise</code>。</p>













































<table><thead><tr><th>Hook 名称</th><th>类型</th><th>调用时机</th></tr></thead><tbody><tr><td><code>entryOption</code></td><td>SyncBailHook</td><td>在 webpack 选项中的 entry 被处理之后</td></tr><tr><td><code>compile</code></td><td>SyncHook</td><td>开始编译之前</td></tr><tr><td><code>compilation</code></td><td>SyncHook</td><td>编译创建之后</td></tr><tr><td><code>emit</code></td><td>AsyncSeriesHook</td><td>生成资源到 output 目录之前</td></tr><tr><td><code>afterEmit</code></td><td>AsyncSeriesHook</td><td>生成资源到 output 目录之后</td></tr><tr><td><code>done</code></td><td>SyncHook</td><td>编译完成</td></tr><tr><td><code>failed</code></td><td>SyncHook</td><td>编译失败</td></tr></tbody></table>
<p>③.来实现控制台打印输出打包构建时间、各个产物文件大小信息与携带新生成版本信息文件的plugins</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomPlugin</span> {
    <span class="hljs-comment">// 构造函数，用于接收配置选项</span>
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = options
    }
    <span class="hljs-comment">// apply 方法，Webpack 会自动调用并传入 compiler 对象</span>
    <span class="hljs-title function_">apply</span>(<span class="hljs-params">compiler</span>) {
        <span class="hljs-comment">// 插件逻辑</span>
        <span class="hljs-comment">// 1. 在编译开始前执行</span>
        compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">beforeRun</span>.<span class="hljs-title function_">tap</span>(<span class="hljs-string">'MyCustomPlugin'</span>, <span class="hljs-function">(<span class="hljs-params">compilation</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`🚀 开始编译...`</span>);
        });
        <span class="hljs-comment">// 2. 在编译完成后执行</span>
        compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">done</span>.<span class="hljs-title function_">tap</span>(<span class="hljs-string">'MyCustomPlugin'</span>, <span class="hljs-function">(<span class="hljs-params">stats</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> compilation = stats.<span class="hljs-property">compilation</span>;
            <span class="hljs-keyword">const</span> endTime = stats.<span class="hljs-property">endTime</span>;
            <span class="hljs-keyword">const</span> startTime = stats.<span class="hljs-property">startTime</span>;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`✅ : 编译完成！`</span>);

            <span class="hljs-comment">//输出构建时间</span>
            <span class="hljs-keyword">const</span> buildTime = (endTime - startTime) / <span class="hljs-number">1000</span>;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`⏰ 构建时间: <span class="hljs-subst">${buildTime.toFixed(<span class="hljs-number">2</span>)}</span>s`</span>);

            <span class="hljs-comment">//输出资源大小信息</span>
            <span class="hljs-keyword">const</span> assets = compilation.<span class="hljs-property">assets</span>;
            <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(assets).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">assetName</span> =&gt;</span> {
                <span class="hljs-keyword">const</span> size = assets[assetName].<span class="hljs-title function_">size</span>();
                <span class="hljs-keyword">const</span> sizeKb = (size / <span class="hljs-number">1024</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`📦 <span class="hljs-subst">${assetName}</span>: <span class="hljs-subst">${sizeKb}</span> KB`</span>);
            });
        });
        <span class="hljs-comment">// 3. 在资源输出到目录前执行（可以修改输出内容）</span>
        compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">emit</span>.<span class="hljs-title function_">tapAsync</span>(<span class="hljs-string">'MyCustomPlugin'</span>, <span class="hljs-function">(<span class="hljs-params">compilation, callback</span>) =&gt;</span> {
            <span class="hljs-comment">// 创建一个版本信息文件</span>
            <span class="hljs-keyword">const</span> buildInfo = {
                <span class="hljs-attr">buildTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleString</span>(),
                <span class="hljs-attr">hash</span>: compilation.<span class="hljs-property">hash</span>,
                <span class="hljs-attr">version</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">package_version</span> || <span class="hljs-string">'1.0.0'</span>
            };
            <span class="hljs-comment">// 将信息添加到编译资源中</span>
            compilation.<span class="hljs-property">assets</span>[<span class="hljs-string">'build-info.json'</span>] = {
                <span class="hljs-attr">source</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
                    <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(buildInfo, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>);
                },
                <span class="hljs-attr">size</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
                    <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(buildInfo).<span class="hljs-property">length</span>;
                }
            };
            <span class="hljs-title function_">callback</span>();
        });
    }
}
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">MyCustomPlugin</span>;
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acc02ed91bbe4f7d87fefb0dc51df58f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5b-15LmL6Ze0bHE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766031369&amp;x-signature=q89G6QVoZrp%2BLEg1ATfbto6eqjo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-14">4. 优化产物输出(Optimization)</h3>
<p>optimization配置项的主要目的是<strong>控制打包产物的优化行为</strong>。</p>
<p>它的核心目标可以归结为三点：</p>
<ol>
<li><strong>减小打包体积</strong> ：通过压缩、摇树、作用域提升等技术，移除无效代码，减小文件大小。</li>
<li><strong>提升运行性能</strong> ：通过代码分割等方式，实现按需加载，减少初始加载时间。</li>
<li><strong>优化缓存</strong> ：通过合理的哈希策略和代码分离，使得未更改的文件能够被浏览器有效缓存，提升二次加载速度。</li>
</ol>
<h4 data-id="heading-15">4.1 代码分割与分块</h4>
<ol>
<li>splitChunks :这是最核心的代码分割配置,它主动用于拆分公共模块与第三方。</li>
</ol>
<p><strong>工作原理</strong>：Webpack 会分析模块的引用情况，根据你设置的规则（如大小、被引用次数等）自动将符合条件的模块提取到独立的 chunk 中。</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-attr">optimization</span>: {
  <span class="hljs-attr">splitChunks</span>: {
    <span class="hljs-comment">//'async'（默认值）：只对异步加载（dynamic import）​ 的模块进行分割</span>
    <span class="hljs-comment">//'initial'：只对同步初始化的模块进行分割。</span>
    <span class="hljs-comment">//'all'：最常用、最彻底的优化。对所有模块（同步和异步）都应用分割规则。这能最有效地提取公共依赖。</span>
    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
    <span class="hljs-attr">maxAsyncRequests</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// 按需加载时的最大并行请求数。设置此值可以防止chunk过多导致网络请求爆炸。</span>
    <span class="hljs-attr">maxInitialRequests</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// 入口点的最大并行请求数</span>
    <span class="hljs-attr">cacheGroups</span>: {
      <span class="hljs-comment">// 1. 抽离第三方库（如react, lodash）</span>
      <span class="hljs-attr">vendor</span>: {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>, <span class="hljs-comment">// 匹配node_modules下的文件</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">'vendors'</span>, <span class="hljs-comment">//  chunk 名称</span>
        <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>, <span class="hljs-comment">// 优先级，数字越大优先级越高</span>
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 如果当前chunk包含的模块已经被抽出，则直接复用</span>
      },
      <span class="hljs-comment">// 2. 抽离公共工具函数或组件</span>
      <span class="hljs-attr">common</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'common'</span>,
        <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// 模块被至少2个chunk引用时才被抽离</span>
        <span class="hljs-attr">minSize</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 生成的chunk最小大小（字节）</span>
        <span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>,
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
      },
      <span class="hljs-comment">// 3. 单独抽离某个大型库，如echarts</span>
      <span class="hljs-attr">echarts</span>: {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]echarts[\\/]/</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'chunk-echarts'</span>,
        <span class="hljs-attr">priority</span>: <span class="hljs-number">30</span>, <span class="hljs-comment">// 优先级高于vendor</span>
      },
    },
  },
}
</code></pre>
<ol start="2">
<li>runtimeChunk：将 Webpack 的<code>运行时(runtime)</code>代码提取到单独的文件中。</li>
</ol>
<p><strong>什么是运行时</strong>：Webpack 用来连接模块化应用程序所需的一系列辅助代码。它负责模块的加载和解析逻辑。</p>
<p><strong>为什么要提取</strong>：运行时代码虽然小，但会随着模块关系的变化而变化。如果不提取，即使你的业务代码没变，但只要模块ID等元信息变了，包含业务代码的vendor chunk的哈希值也会变，导致浏览器缓存失效。提取后，运行时代码单独成一个很小的文件，经常变动的只是它，而庞大的vendor chunk和业务chunk可以保持缓存。</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-attr">optimization</span>: {
  <span class="hljs-attr">runtimeChunk</span>: <span class="hljs-string">`single`</span>, <span class="hljs-comment">// 提取所有入口点的运行时代码到一个文件中，如 `runtime~main.js`</span>
  <span class="hljs-comment">// 或者</span>
  <span class="hljs-attr">runtimeChunk</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-function"><span class="hljs-params">entrypoint</span> =&gt;</span> <span class="hljs-string">`runtime-<span class="hljs-subst">${entrypoint.name}</span>`</span>, <span class="hljs-comment">// 为每个入口生成独立的runtime文件</span>
  },
}
</code></pre>
<h4 data-id="heading-16">4.2 代码压缩</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'terser-webpack-plugin'</span>);
<span class="hljs-keyword">const</span> cssMinimizerPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'css-minimizer-webpack-plugin'</span>);

<span class="hljs-attr">optimization</span>: {
        <span class="hljs-attr">minimize</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//是否启用代码压缩</span>
        <span class="hljs-attr">minimizer</span>: [
            <span class="hljs-keyword">new</span> <span class="hljs-title function_">cssMinimizerPlugin</span>(),<span class="hljs-comment">//优化并压缩css资源</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserWebpackPlugin</span>({
                <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//启用缓存来加速构建构建过程</span>
                <span class="hljs-attr">parallel</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//利用多核cpu 优势加快压缩速度</span>
                <span class="hljs-attr">terserOptions</span>: {
                    <span class="hljs-attr">compress</span>: {
                        <span class="hljs-attr">drop_console</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">///去掉 console.log 等语句</span>
                    }
                }
            }),
        ],
}
</code></pre>
<h3 data-id="heading-17">四.环境模式</h3>
<p>通过<code>mode</code>配置项的参数来知道当前的Webpack的构建环境,并且会启动Webpack针对不同环境的内置优化。</p>
<p>三个可选值：</p>
<ul>
<li><code>'development'</code>- 开发模式</li>
<li><code>'production'</code>- 生产模式</li>
<li><code>'none'</code>- 无默认优化</li>
</ul>
<p>不管是<code>development</code>还是<code>production</code>模式,我们进行Webpack配置项编写时可通过基础通用的配置与两种不同环境下的配置文件进行<code>merge</code>合并,生成最终的配置文件。</p>
<p>因为我们在两种不同的环境中所要求目标不一样,通过划分配置文件来形成在两种不同环境下的需求目标:</p>

























<table><thead><tr><th>特性</th><th>开发模式 (development)</th><th>生产模式 (production)</th></tr></thead><tbody><tr><td><strong>主要目标</strong>​</td><td>开发体验和构建速度</td><td>代码优化和性能</td></tr><tr><td><strong>代码压缩</strong>​</td><td>❌ 不压缩，保持可读性</td><td>✅ 深度压缩和优化</td></tr><tr><td><strong>构建速度</strong>​</td><td>⚡ 快速构建和重载</td><td>⏳ 较慢，但只执行一次</td></tr></tbody></table>



































<table><thead><tr><th/><th>webpack.base.js</th><th>webpack.dev.js</th><th>webpack.prod.js</th></tr></thead><tbody><tr><td>主要功能</td><td>存放开发/生产公共配置</td><td>热更新开发配置</td><td>产物优化配置</td></tr><tr><td/><td>入口文件动态构建</td><td>dev-serveer 配置</td><td>代码分割</td></tr><tr><td/><td>基础loader处理加载</td><td>source-map 代码映射配置</td><td>代码压缩</td></tr><tr><td/><td>公共插件加载</td><td>热更新映射/模块更新配置</td><td>多线程加速打包</td></tr></tbody></table>
<h4 data-id="heading-18">1.1 webpack.base.js (基础配置)</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> glob = <span class="hljs-built_in">require</span>(<span class="hljs-string">'glob'</span>)
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">VueLoaderPlugin</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vue-loader'</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)

<span class="hljs-comment">//动态构造 entry 入口对象和 html-webpack-plugin 插件实例</span>
<span class="hljs-keyword">const</span> pageEntries = {}
<span class="hljs-keyword">const</span> htmlWebpackPluginList = []
<span class="hljs-comment">//自动加载app/pages目录下的入口文件</span>
<span class="hljs-keyword">const</span> entryList = glob.<span class="hljs-title function_">sync</span>(path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/**/entry.*.js'</span>))
entryList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">filePath</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> entryName = path.<span class="hljs-title function_">basename</span>(filePath, <span class="hljs-string">'.js'</span>)
  <span class="hljs-comment">//构造entry对象</span>
  pageEntries[entryName] = filePath
  <span class="hljs-comment">//构造最终渲染的页面文件</span>
  htmlWebpackPluginList.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>({
    <span class="hljs-comment">//产物 (最终末班) 输出路径</span>
    <span class="hljs-attr">filename</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/public/dist/'</span>, <span class="hljs-string">`<span class="hljs-subst">${entryName}</span>.tpl`</span>),
    <span class="hljs-comment">//指定要使用的模板文件</span>
    <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/view/entry.tpl'</span>),
    <span class="hljs-comment">//要注入的代码块</span>
    <span class="hljs-attr">chunks</span>: [entryName],
  }))
})

<span class="hljs-comment">/*
 * @Description: webpack基础配置
 */</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">//入口配置</span>
  <span class="hljs-attr">entry</span>: pageEntries,
  <span class="hljs-comment">//模块解析配置(决定需要加载解析什么模块,以及用什么方式解析)</span>
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">rules</span>: [
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,
        <span class="hljs-attr">use</span>: { <span class="hljs-attr">loader</span>: <span class="hljs-string">'vue-loader'</span> }
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,
        <span class="hljs-attr">include</span>: [
          <span class="hljs-comment">//只对业务代码进行vavel, 加快 webpack 打包速度</span>
          <span class="hljs-comment">//表示只对 app/pages 目录下的js文件进行 babel 转换</span>
          path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages'</span>),
        ],
        <span class="hljs-attr">use</span>: { <span class="hljs-attr">loader</span>: <span class="hljs-string">'babel-loader'</span> },
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpg|jpeg|gif)(\?.+)?$/</span>,
        <span class="hljs-attr">use</span>: {
          <span class="hljs-attr">loader</span>: <span class="hljs-string">'url-loader'</span>,
          <span class="hljs-attr">options</span>: {
            <span class="hljs-attr">limit</span>: <span class="hljs-number">8192</span>,  <span class="hljs-comment">// 小于 8KB 的图片转为 base64</span>
            <span class="hljs-attr">name</span>: <span class="hljs-string">'[name].[ext]'</span>,
            <span class="hljs-attr">outputPath</span>: <span class="hljs-string">'images/'</span>,
            <span class="hljs-attr">esModule</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 控制导出格式, true 导出为 esModule 模块, false 导出为 commonjs 模块</span>
          }
        }
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,
        <span class="hljs-attr">use</span>: [<span class="hljs-string">'style-loader'</span>, <span class="hljs-string">'css-loader'</span>]
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,
        <span class="hljs-attr">use</span>: [<span class="hljs-string">'style-loader'</span>, <span class="hljs-string">'css-loader'</span>, <span class="hljs-string">'less-loader'</span>]
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(eot | svg |ttf |woff |woff2)(\?\S*)?$/</span>,
        <span class="hljs-attr">use</span>: <span class="hljs-string">'file-loader'</span>
      }
    ]
  },
  <span class="hljs-comment">//产物输出路径,因为开发和生产环境的输出路径不同,所以需要区分,各自环境中分别配置</span>
  <span class="hljs-attr">output</span>: {},
  <span class="hljs-comment">//配置模块解析的具体行为(定义 webpack 在打包时,如何找到具体模块并解析)</span>
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">'.js'</span>, <span class="hljs-string">'.vue'</span>, <span class="hljs-string">'.less'</span>, <span class="hljs-string">'.css'</span>],<span class="hljs-comment">//配置解析的文件扩展名</span>
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-comment">//配置别名,方便在代码中引入模块  </span>
      <span class="hljs-attr">$pages</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages'</span>),
      <span class="hljs-attr">$common</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/common'</span>),
      <span class="hljs-attr">$widgets</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/widgets'</span>),
      <span class="hljs-attr">$store</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/store'</span>),
    },
  },
  <span class="hljs-comment">//配置webpack插件</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-comment">//处理.vue文件,将自定义的其他规则复制并应用到 .vue 文件的解析中</span>
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueLoaderPlugin</span>(),
    <span class="hljs-comment">//把第三方库暴露到 Window context下</span>
    <span class="hljs-keyword">new</span> webpack.<span class="hljs-title class_">ProvidePlugin</span>({
      <span class="hljs-title class_">Vue</span>: <span class="hljs-string">'vue'</span>,
      <span class="hljs-attr">axios</span>: <span class="hljs-string">'axios'</span>,
      <span class="hljs-attr">_</span>: <span class="hljs-string">'lodash'</span>,
    }),
    <span class="hljs-comment">//定义全局变量</span>
    <span class="hljs-keyword">new</span> webpack.<span class="hljs-title class_">DefinePlugin</span>({
      <span class="hljs-attr">__VUE_OPTIONS_API__</span>: <span class="hljs-string">'true'</span>, <span class="hljs-comment">//支持 vue 解析 options API</span>
      <span class="hljs-attr">__VUE_PROD_DEVTOOLS__</span>: <span class="hljs-string">'false'</span>, <span class="hljs-comment">//是否开启 vue 生产环境下的 devtools 功能</span>
      <span class="hljs-attr">__VUE_PROD_HYDRATION_MISMATCH_DETAILS__</span>: <span class="hljs-string">'false'</span>, <span class="hljs-comment">//是否开启 vue 生产环境下的 hydration  mismatch('水合') 详情功能</span>
    }),
    <span class="hljs-comment">//构建最终渲染的页面模板</span>
    ...htmlWebpackPluginList,
  ],
  <span class="hljs-comment">//配置打包输出优化(配置代码分割,模块合并,缓存,TreeShaing,压缩等优化策略)</span>
  <span class="hljs-attr">optimization</span>: {
    <span class="hljs-attr">splitChunks</span>: {
      <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>, <span class="hljs-comment">//对同步和异步模块都进行分割</span>
      <span class="hljs-attr">maxAsyncRequests</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// 每次异步加载的最大并行请求数</span>
      <span class="hljs-attr">maxInitialRequests</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// 入口点的最大并行请求数</span>
      <span class="hljs-attr">cacheGroups</span>: {
        <span class="hljs-comment">//第三方库依赖库</span>
        <span class="hljs-attr">vendor</span>: {
          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>, <span class="hljs-comment">//打包 node_modules 中的文件</span>
          <span class="hljs-attr">name</span>: <span class="hljs-string">'vendor'</span>,<span class="hljs-comment">//模块名称</span>
          <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>, <span class="hljs-comment">//优先级, 数值越大,优先级越高</span>
          <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//强制分割, 不考虑 minSize, maxSize 等配置</span>
          <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//复用已用的公共 chunk</span>
        },
        <span class="hljs-comment">//公共模块部分</span>
        <span class="hljs-attr">common</span>: {
          <span class="hljs-attr">name</span>: <span class="hljs-string">'common'</span>, <span class="hljs-comment">//模块名称</span>
          <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">//模块被引用次数超过 2 次,才会被分割</span>
          <span class="hljs-attr">minSize</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>,
          <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
        },
      },
    },
    <span class="hljs-comment">//将 Webpack 的运行时（runtime）​ 代码提取到单独的文件中。</span>
    <span class="hljs-attr">runtimeChunk</span>: {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'runtime'</span>,
    },
  },
}
</code></pre>
<h4 data-id="heading-19">1.2 webpack.prod.js (生产配置)</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-merge'</span>); <span class="hljs-comment">//webpack 配置合并插件</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">'os'</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HappyPack</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'happypack'</span>)

<span class="hljs-keyword">const</span> miniCssExtractPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mini-css-extract-plugin'</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title class_">CleanWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'clean-webpack-plugin'</span>);
<span class="hljs-keyword">const</span> cssMinimizerPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'css-minimizer-webpack-plugin'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackInjectAttributesPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-inject-attributes-plugin'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'terser-webpack-plugin'</span>);

<span class="hljs-comment">//基类配置</span>
<span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.base.js'</span>);
<span class="hljs-comment">//多线程 build 设置</span>
<span class="hljs-keyword">const</span> happypackCommonConfig = {
    <span class="hljs-attr">debug</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">threadPool</span>: <span class="hljs-title class_">HappyPack</span>.<span class="hljs-title class_">ThreadPool</span>({ <span class="hljs-attr">size</span>: os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span> }),
}
<span class="hljs-comment">//生产环境 webpack 配置</span>
<span class="hljs-keyword">const</span> webpackConfig = merge.<span class="hljs-title function_">smart</span>(baseConfig, {
    <span class="hljs-comment">//指定生产环境</span>
    <span class="hljs-attr">mode</span>: <span class="hljs-string">'production'</span>,
    <span class="hljs-comment">//生产环境的 output 配置</span>
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">filename</span>: <span class="hljs-string">'js/[name]_[chunkhash:8].bundle.js'</span>,
        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">join</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/public/dist/prod'</span>),
        <span class="hljs-attr">publicPath</span>: <span class="hljs-string">'/dist/prod/'</span>,
        <span class="hljs-attr">crossOriginLoading</span>: <span class="hljs-string">'anonymous'</span>,<span class="hljs-comment">//跨域加载资源时,是否添加 crossorigin 属性</span>
    },
    <span class="hljs-comment">//生产环境的模块解析配置</span>
    <span class="hljs-attr">module</span>: {
        <span class="hljs-attr">rules</span>: [
            {
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,
                <span class="hljs-attr">use</span>: [
                    miniCssExtractPlugin.<span class="hljs-property">loader</span>,
                    <span class="hljs-string">'happypack/loader?id=css'</span>,
                ]
            },
            {
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,
                <span class="hljs-attr">include</span>: [
                    path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages'</span>),
                ],
                <span class="hljs-attr">use</span>: [<span class="hljs-string">'happypack/loader?id=js'</span>],
            },
        ]
    },
    <span class="hljs-comment">// webpack 不会有大量的 hints 信息 ,默认是 warning</span>
    <span class="hljs-attr">performance</span>: {
        <span class="hljs-attr">hints</span>: <span class="hljs-literal">false</span>,
    },
    <span class="hljs-attr">plugins</span>: [
        <span class="hljs-comment">//每次build 前,先删除上一次的 build 结果</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">CleanWebpackPlugin</span>([<span class="hljs-string">'public/dist'</span>], {
            <span class="hljs-attr">root</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/'</span>),
            <span class="hljs-attr">exclude</span>: [],
            <span class="hljs-attr">verbose</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">dry</span>: <span class="hljs-literal">false</span>,
        }),
        <span class="hljs-comment">//提取 css 的公共部分,有效利用缓存</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title function_">miniCssExtractPlugin</span>({
            <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">'css/[name]_[contenthash:8].bundle.css'</span>,
            <span class="hljs-attr">filename</span>: <span class="hljs-string">'css/[name].[contenthash:8].bundle.css'</span> <span class="hljs-comment">// 输出到 单独 css 文件夹</span>
        }),
        <span class="hljs-comment">//多线程打包 js ,加快打包速度</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HappyPack</span>({
            ...happypackCommonConfig,
            <span class="hljs-attr">id</span>: <span class="hljs-string">'js'</span>,
            <span class="hljs-attr">loaders</span>: [{
                <span class="hljs-attr">path</span>: <span class="hljs-string">'babel-loader'</span>,
                <span class="hljs-attr">options</span>: {
                    <span class="hljs-attr">presets</span>: [<span class="hljs-string">'@babel/preset-env'</span>],
                    <span class="hljs-attr">plugins</span>: [<span class="hljs-string">'@babel/plugin-transform-runtime'</span>]
                }
            }],
        }),
        <span class="hljs-comment">//多线程打包 css ,加快打包速度</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HappyPack</span>({
            ...happypackCommonConfig,
            <span class="hljs-attr">id</span>: <span class="hljs-string">'css'</span>,
            <span class="hljs-attr">loaders</span>: [{
                <span class="hljs-attr">path</span>: <span class="hljs-string">'css-loader'</span>,
                <span class="hljs-attr">options</span>: {
                    <span class="hljs-attr">importLoaders</span>: <span class="hljs-number">1</span>,
                }
            }],
        }),
        <span class="hljs-comment">//浏览器在请求资源时,不发送用户的身份凭证</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackInjectAttributesPlugin</span>({
            <span class="hljs-attr">crossorigin</span>: <span class="hljs-string">'anonymous'</span>,
        }),
    ],
    <span class="hljs-attr">optimization</span>: {
        <span class="hljs-attr">minimize</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">minimizer</span>: [
            <span class="hljs-comment">//优化并压缩css资源</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title function_">cssMinimizerPlugin</span>(),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserWebpackPlugin</span>({
                <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//启用缓存来加速构建构建过程</span>
                <span class="hljs-attr">parallel</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//利用多核cpu 优势加快压缩速度</span>
                <span class="hljs-attr">terserOptions</span>: {
                    <span class="hljs-attr">compress</span>: {
                        <span class="hljs-attr">drop_console</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">///去掉 console.log 等语句</span>
                    }
                }
            }),
        ],
        <span class="hljs-attr">splitChunks</span>: {
            <span class="hljs-attr">cacheGroups</span>: {
                <span class="hljs-attr">vue</span>: {
                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]vue/</span>, <span class="hljs-comment">// 匹配 node_modules 中的 Vue</span>
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'vue'</span>, <span class="hljs-comment">// 输出文件名为 vue.[hash].js</span>
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>, <span class="hljs-comment">// 处理所有引入方式（同步/异步）</span>
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">30</span>, <span class="hljs-comment">// 优先级高于 vendor（确保先拆分 Vue）</span>
                    <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 强制拆分（忽略 minSize 限制，即使 Vue 很小也拆分）</span>
                },
            },
        },
    }
});

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = webpackConfig;
</code></pre>
<p>在Elpis 项目中我们是使用<code>HappyPack</code>来启用多线程加速打包的速度,我们也可以使用<code>thread-loader</code>来优化打包速度。</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-attr">module</span>: {
  <span class="hljs-attr">rules</span>: [
    {
      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.js$/</span>,
      <span class="hljs-attr">use</span>: [
        {
          <span class="hljs-attr">loader</span>: <span class="hljs-string">'thread-loader'</span>,
          <span class="hljs-attr">options</span>: {
            <span class="hljs-attr">workers</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// 线程数量,  使用 os.cpus().length 自动根据cpu核心生成线程数</span>
            <span class="hljs-attr">workerParallelJobs</span>: <span class="hljs-number">50</span>, <span class="hljs-comment">// 每个线程并行任务数</span>
            <span class="hljs-attr">poolTimeout</span>: <span class="hljs-number">2000</span> <span class="hljs-comment">// 超时时间</span>
          }
        },
        <span class="hljs-string">'babel-loader'</span>
      ]
    }
  ]
}
</code></pre>
<h4 data-id="heading-20">1.3 webpack.dev.js (开发配置)</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-merge'</span>); <span class="hljs-comment">//webpack 配置合并插件</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)
<span class="hljs-comment">//基类配置</span>
<span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.base.js'</span>);
<span class="hljs-comment">//dev-serveer 配置</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEV_SERVER_CONFIG</span> = {
    <span class="hljs-attr">HOST</span>: <span class="hljs-string">'127.0.0.1'</span>,
    <span class="hljs-attr">PORT</span>: <span class="hljs-number">9002</span>,
    <span class="hljs-attr">HMR_PATH</span>: <span class="hljs-string">'__webpack_hmr'</span>, <span class="hljs-comment">//官方规定</span>
    <span class="hljs-attr">TIMEOUT</span>: <span class="hljs-number">20000</span>,
}
<span class="hljs-comment">//开发阶段的 entry 配置需要加入hmr</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(baseConfig.<span class="hljs-property">entry</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">entryName</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (entryName !== <span class="hljs-string">'vendor'</span>) {
        baseConfig.<span class="hljs-property">entry</span>[entryName] = [
            <span class="hljs-comment">//主入口文件</span>
            baseConfig.<span class="hljs-property">entry</span>[entryName],
            <span class="hljs-comment">//hmr 更新入口 ,官方指定的 hmr 路径</span>
            <span class="hljs-string">`webpack-hot-middleware/client?path=http://<span class="hljs-subst">${DEV_SERVER_CONFIG.HOST}</span>:<span class="hljs-subst">${DEV_SERVER_CONFIG.PORT}</span>/<span class="hljs-subst">${DEV_SERVER_CONFIG.HMR_PATH}</span>&amp;timeout=<span class="hljs-subst">${DEV_SERVER_CONFIG.TIMEOUT}</span>&amp;reload=true`</span>,
        ]
    }
})
<span class="hljs-comment">// 开发环境 webpack 配置</span>
<span class="hljs-keyword">const</span> webpackConfig = merge.<span class="hljs-title function_">smart</span>(baseConfig, {
    <span class="hljs-comment">//指定开发环境</span>
    <span class="hljs-attr">mode</span>: <span class="hljs-string">'development'</span>,
    <span class="hljs-comment">//source-map 配置,呈现代码的映射关系,便于观察代码</span>
    <span class="hljs-attr">devtool</span>: <span class="hljs-string">'eval-cheap-module-source-map'</span>,
    <span class="hljs-comment">//开发环境的 output 配置</span>
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">filename</span>: <span class="hljs-string">'js/[name]_[chunkhash:8].bundle.js'</span>,
        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/public/dist/dev/'</span>), <span class="hljs-comment">//输出文件存储路径</span>
        <span class="hljs-attr">publicPath</span>: <span class="hljs-string">`http://<span class="hljs-subst">${DEV_SERVER_CONFIG.HOST}</span>:<span class="hljs-subst">${DEV_SERVER_CONFIG.PORT}</span>/public/dist/dev/`</span>, <span class="hljs-comment">//外部资源公共路径</span>
        <span class="hljs-attr">globalObject</span>: <span class="hljs-string">'this'</span>,<span class="hljs-comment">//指定全局对象,默认是 window</span>
    },
    <span class="hljs-comment">//开发环境插件</span>
    <span class="hljs-attr">plugins</span>: [
        <span class="hljs-comment">// 热更新插件,模块热更新允许在应用运行时,替换、添加或删除模块,而无需刷新整个页面</span>
        <span class="hljs-keyword">new</span> webpack.<span class="hljs-title class_">HotModuleReplacementPlugin</span>({
            <span class="hljs-attr">multiStep</span>: <span class="hljs-literal">false</span>,
        }),
    ],
});
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    webpackConfig, <span class="hljs-comment">//webpack 开发环境配置</span>
    <span class="hljs-variable constant_">DEV_SERVER_CONFIG</span>, <span class="hljs-comment">//dev-server 配置</span>
}
</code></pre>
<h4 data-id="heading-21">1.4 Source Map 配置选项总览</h4>
<p>该配置选项主要便利开发时快速定位代码错误位置</p>





































































































<table><thead><tr><th>配置值</th><th>构建速度</th><th>重建速度</th><th>质量</th><th>生产环境适用</th><th>特点</th></tr></thead><tbody><tr><td><code>false</code></td><td>最快</td><td>最快</td><td>无</td><td>✅</td><td>不生成 source map</td></tr><tr><td><code>eval</code></td><td>很快</td><td>最快</td><td>差</td><td>❌</td><td>每个模块用 eval 执行</td></tr><tr><td><code>eval-source-map</code></td><td>慢</td><td>一般</td><td>高</td><td>❌</td><td>每个模块生成 DataUrl 的 source map</td></tr><tr><td><code>eval-cheap-source-map</code></td><td>较快</td><td>快</td><td>中</td><td>❌</td><td>只映射行，不映射列</td></tr><tr><td><code>eval-cheap-module-source-map</code></td><td>一般</td><td>一般</td><td>中高</td><td>❌</td><td>包含 loader 转换前的代码</td></tr><tr><td><code>source-map</code></td><td>慢</td><td>慢</td><td>最高</td><td>✅</td><td>生成独立的 .map 文件</td></tr><tr><td><code>hidden-source-map</code></td><td>慢</td><td>慢</td><td>最高</td><td>✅</td><td>生成 .map 文件但不引用</td></tr><tr><td><code>inline-source-map</code></td><td>慢</td><td>慢</td><td>最高</td><td>❌</td><td>将 source map 内联到文件中</td></tr><tr><td><code>cheap-source-map</code></td><td>一般</td><td>一般</td><td>中</td><td>✅</td><td>只映射行，忽略 loader source map</td></tr><tr><td><code>cheap-module-source-map</code></td><td>一般</td><td>一般</td><td>中高</td><td>✅</td><td>包含 loader 转换前的代码</td></tr><tr><td><code>nosources-source-map</code></td><td>慢</td><td>慢</td><td>中</td><td>✅</td><td>生成 .map 但不包含源代码内容</td></tr></tbody></table>
<h4 data-id="heading-22">1.5 热更新(HMR)</h4>
<p>HMR 的核心思想是：<strong>在应用程序运行过程中，替换、添加或删除模块，而无需完全重新加载整个页面</strong>。</p>
<p>可以概括为以下几个步骤：</p>
<h5 data-id="heading-23">1. 启动阶段</h5>
<ol>
<li><strong>webpack 编译</strong>：首先，webpack 在启动开发服务器时，会对源代码进行编译，并生成 bundle 文件（文件<code>都在内存中</code>）。</li>
<li><strong>注入 HMR Runtime</strong>：在编译过程中，webpack 会向 bundle 中注入 HMR Runtime 代码。这段代码将在浏览器中运行，负责与开发服务器的 HMR 服务进行WebSocket通信，并处理更新逻辑。</li>
</ol>
<h5 data-id="heading-24">2. 文件监听与编译</h5>
<ol>
<li><strong>监听文件变化</strong>：webpack 通过文件系统监听来监测项目中的文件变化。</li>
<li><strong>增量编译</strong>：当文件发生变化时，webpack 会重新编译这些变化的模块。注意，这里<code>不是完全重新编译</code>，而是增量编译，只编译变化的模块和受影响的模块，以生成更新的模块代码。</li>
</ol>
<h5 data-id="heading-25">3. 生成更新包（Update）</h5>
<p>编译完成后，webpack 会生成一个更新包（update），这个包包含了变化的模块的代码以及更新信息（通常是一个 JSON 文件，描述了哪些模块发生了变化以及新的模块代码）。</p>
<h5 data-id="heading-26">4. 通知客户端</h5>
<ol>
<li><strong>WebSocket 推送</strong>：开发服务器通过 WebSocket 向浏览器发送一个消息，通知浏览器有更新可用。这个消息通常包含一个 hash 值（本次更新的标识）和更新包的 URL。</li>
<li><strong>下载更新包</strong>：浏览器端的 HMR Runtime 收到通知后，会通过 AJAX 请求更新包（通常是一个 JavaScript 文件，包含了更新的模块代码）。</li>
</ol>
<h5 data-id="heading-27">5. 应用更新</h5>
<ol>
<li><strong>检查更新是否可应用</strong>：HMR Runtime 会检查当前模块树中哪些模块需要更新。它根据更新包中的信息，找到需要更新的模块。</li>
<li><strong>模块替换</strong>：对于 JavaScript 模块，HMR Runtime 会移除旧的模块，并执行新的模块代码。如果模块支持 HMR（即模块代码中包含了 <code>module.hot.accept</code>等处理代码），那么会执行模块自身的更新逻辑（例如，重新执行模块代码，并调用回调函数）。对于样式模块，通常直接替换 style 标签即可。</li>
<li><strong>回调与错误处理</strong>：如果更新过程中有错误，HMR Runtime 会回退到完整页面刷新。如果更新成功，可能会触发一些回调函数（例如，<code>module.hot.accept</code>中注册的回调）。</li>
</ol>
<h5 data-id="heading-28">6.构建HMR热更新服务</h5>
<p>在前面的所讲的<code>webpack.dev.js</code>环境下的配置文件,已做了相关的HMR配置内容。通过<code>dev.js</code>来作为HMR开发的启动文件,<code>Express</code>框架作为搭建HMR服务,<code>webpack-dev-middleware</code>插件监听文件的改动完成增量编译,<code>webpack-hot-middleware</code>来实现与浏览器之间的通讯,最终实现HMR代码更新。</p>
<p><strong>dev.js</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// 本地开发启动 devserber</span>
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> consoler = <span class="hljs-built_in">require</span>(<span class="hljs-string">'consoler'</span>);
<span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>);
<span class="hljs-keyword">const</span> devMiddleware = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-dev-middleware'</span>);
<span class="hljs-keyword">const</span> hotMiddleware = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-hot-middleware'</span>);

<span class="hljs-comment">//从 webpack.dev.js 中引入 webpack 配置</span>
<span class="hljs-keyword">const</span> { webpackConfig, <span class="hljs-variable constant_">DEV_SERVER_CONFIG</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./config/webpack.dev.js'</span>);

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-keyword">const</span> compiler = <span class="hljs-title function_">webpack</span>(webpackConfig);
<span class="hljs-comment">//指定静态文件目录</span>
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(path.<span class="hljs-title function_">join</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/public/dist/'</span>)));
<span class="hljs-comment">//引用 devMiddleware 中间件 监控文件改动</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">devMiddleware</span>(compiler, {
    <span class="hljs-comment">//落地文件</span>
    <span class="hljs-attr">writeToDisk</span>: <span class="hljs-function">(<span class="hljs-params">filePath</span>) =&gt;</span> filePath.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.tpl'</span>),
    <span class="hljs-comment">//资源路径</span>
    <span class="hljs-attr">publicPath</span>: webpackConfig.<span class="hljs-property">output</span>.<span class="hljs-property">publicPath</span>,
    <span class="hljs-comment">//head 信息</span>
    <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">'Access-Control-Allow-Origin'</span>: <span class="hljs-string">'*'</span>,<span class="hljs-comment">// 允许所有域名跨域访问</span>
        <span class="hljs-string">'Access-Control-Allow-Methods'</span>: <span class="hljs-string">'GET, POST, PUT, DELETE, PATCH, OPTIONS'</span>,<span class="hljs-comment">// 允许的HTTP方法</span>
        <span class="hljs-string">'Access-Control-Allow-Headers'</span>: <span class="hljs-string">'X-Requested-With, content-type, Authorization'</span>,<span class="hljs-comment">// 允许的请求头</span>
    },
    <span class="hljs-attr">stats</span>: {
        <span class="hljs-attr">colors</span>: <span class="hljs-literal">true</span>,
    },
}));
<span class="hljs-comment">//引用 hotMiddleware 中间件 实现热更新通讯</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">hotMiddleware</span>(compiler, {
    <span class="hljs-attr">path</span>: <span class="hljs-string">`/<span class="hljs-subst">${DEV_SERVER_CONFIG.HMR_PATH}</span>`</span>,
    <span class="hljs-attr">log</span>: <span class="hljs-function">() =&gt;</span> { },
}));

consoler.<span class="hljs-title function_">info</span>(<span class="hljs-string">'请等待webpack初次构建完成提示....'</span>);

<span class="hljs-comment">//启动服务</span>
<span class="hljs-keyword">const</span> port = <span class="hljs-variable constant_">DEV_SERVER_CONFIG</span>.<span class="hljs-property">PORT</span>;
app.<span class="hljs-title function_">listen</span>(port, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`dev-server 启动成功, http://<span class="hljs-subst">${DEV_SERVER_CONFIG.HOST}</span>:<span class="hljs-subst">${port}</span>`</span>);
})
</code></pre>
<p>在<code>dedv.js</code>中<code>headers</code>配置项配置解释:</p>
<p>因为HMR可能涉及到<code>跨域请求</code>（例如，前端应用运行在另一个端口上，而开发服务器在另一个端口）。
所以在Webpack开发中间件中配置headers，主要是为了控制CORS（跨域资源共享）相关的行为，确保在开发过程中，前端应用能够正确地从开发服务器加载资源并进行HMR通信。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[破茧成蝶：Web 前端开发的三次革命与架构演进史]]></title>    <link>https://juejin.cn/post/7582118218649174042</link>    <guid>https://juejin.cn/post/7582118218649174042</guid>    <pubDate>2025-12-11T04:59:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582118218649174042" data-draft-id="7582104240988176410" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="破茧成蝶：Web 前端开发的三次革命与架构演进史"/> <meta itemprop="keywords" content="JavaScript,ECMAScript 6,Vue.js"/> <meta itemprop="datePublished" content="2025-12-11T04:59:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="San30"/> <meta itemprop="url" content="https://juejin.cn/user/1766294768060816"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            破茧成蝶：Web 前端开发的三次革命与架构演进史
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1766294768060816/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    San30
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T04:59:36.000Z" title="Thu Dec 11 2025 04:59:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"「";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"」";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"✓";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>在计算机科学的宏大叙事中，Web 前端的发展速度令人咋舌。从最初简陋的文档展示，到如今能够承载复杂 3D 交互（如 Three.js）和即时通讯的富应用平台，前端技术栈经历了一次又一次的推倒重来。</p>
<p>这并非简单的工具更迭，而是开发模式与思维模型的根本性革命。通过对比同一功能的在不同时代的代码实现，我们可以清晰地看到这三次革命的轨迹。</p>
<h2 data-id="heading-0">第一次革命：混沌初开与后端主宰（MVC 时代）</h2>
<p>在 Web 发展的早期（约 1995-2005 年），并没有严格意义上的“前端工程师”。那是一个“后端套模板”的时代。</p>
<h3 data-id="heading-1">1.1 传统的 MVC 模式</h3>
<p>在这个阶段，浏览器仅被视为一个文档阅读器。所有的业务逻辑、数据处理甚至页面构建都发生在服务器端。</p>
<p>例如下面这段代码，这是典型的 Node.js 模拟早期后端渲染（SSR）的场景：</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// server.js - 典型的后端直出逻辑</span>
<span class="hljs-keyword">const</span> users = [...]; <span class="hljs-comment">// 数据库中的数据</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateUserHTML</span>(<span class="hljs-params">users</span>) {
    <span class="hljs-comment">// 数据与 HTML 字符串强耦合</span>
    <span class="hljs-keyword">const</span> userRows = users.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> <span class="hljs-string">`
        &lt;tr&gt;
            &lt;td&gt;<span class="hljs-subst">${user.id}</span>&lt;/td&gt;
            &lt;td&gt;<span class="hljs-subst">${user.name}</span>&lt;/td&gt;
            &lt;td&gt;<span class="hljs-subst">${user.email}</span>&lt;/td&gt;
        &lt;/tr&gt;
    `</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-string">`
    &lt;!DOCTYPE html&gt;
    ...
            &lt;tbody&gt;
                <span class="hljs-subst">${userRows}</span> &lt;/tbody&gt;
    ...
    `</span>;
}

<span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-comment">// 路由匹配，返回完整的 HTML 字符串</span>
    <span class="hljs-keyword">if</span> (parsedUrl.<span class="hljs-property">pathname</span> === <span class="hljs-string">'/users'</span>) {
        <span class="hljs-keyword">const</span> html = <span class="hljs-title function_">generateUserHTML</span>(users);
        res.<span class="hljs-title function_">end</span>(html);
    }
});
</code></pre>
<h3 data-id="heading-2">1.2 痛点与局限</h3>
<p>这种开发模式（如 PHP, JSP, ASP.NET）下，前端代码（HTML/CSS/JS）只是后端代码中的字符串。</p>
<ul>
<li><strong>强耦合</strong>：UI 逻辑与业务逻辑死死纠缠。改一个按钮的样式，可能需要重启后端服务。</li>
<li><strong>用户体验差</strong>：<code>req.url</code> 触发请求，<code>res.end</code> 返回页面。这意味着每一次极小的交互（比如翻页），都需要刷新整个页面，浏览器会出现瞬间白屏。</li>
<li><strong>分工混乱</strong>：后端开发人员被迫写 CSS，而前端人员（当时常被称为“切图仔”）无法独立调试。</li>
</ul>
<p>此时的核心关注点在于 <strong>Model（数据）</strong> -&gt; <strong>Controller（控制）</strong> -&gt; <strong>View（模板渲染）</strong> 的单向流。</p>
<h2 data-id="heading-3">第二次革命：觉醒与分离（AJAX 与 DOM 编程时代）</h2>
<p>2005 年左右，随着 AJAX 技术的普及（以 Gmail 和 Google Maps 为代表），Web 开始向“应用”转变。第二次革命的核心是 <strong>前后端分离</strong>。</p>
<h3 data-id="heading-4">2.1 浏览器成为应用平台</h3>
<p>在这个阶段，后端不再返回 HTML，而是返回纯粹的数据（JSON）。前端拥有了独立的项目结构，通过 JavaScript 主动拉取数据。</p>
<p>来看看如何实现：</p>
<pre><code class="hljs language-HTML" lang="HTML"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// 1. 主动拉取数据</span>
    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'http://localhost:3000/users'</span>)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
        <span class="hljs-comment">// 2. 获取 DOM 节点（非业务逻辑）</span>
        <span class="hljs-keyword">const</span> tbody = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'tbody'</span>);
        
        <span class="hljs-comment">// 3. 又是字符串拼接，但这次是在浏览器端</span>
        tbody.<span class="hljs-property">innerHTML</span> = data.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> <span class="hljs-string">`
        &lt;tr&gt;
            &lt;td&gt;<span class="hljs-subst">${user.id}</span>&lt;/td&gt;
            &lt;td&gt;<span class="hljs-subst">${user.name}</span>&lt;/td&gt;
            &lt;td&gt;<span class="hljs-subst">${user.email}</span>&lt;/td&gt;
        &lt;/tr&gt;
        `</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>);
    });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">2.2 带来的改变与新的泥潭</h3>
<p>这一变革带来了巨大的优势：</p>
<ul>
<li><strong>解耦</strong>：后端专注于 API 接口（如 <code>:3000/users</code>）和高并发；前端专注于交互与体验。</li>
<li><strong>无刷新体验</strong>：页面的局部更新成为可能。</li>
</ul>
<p>然而，随着应用复杂度上升，前端陷入了 "DOM 操作的泥潭"。</p>
<p>在代码中，为了展示数据，我们必须先 querySelector 找到节点，然后操作 innerHTML。这带来了两个严重问题：</p>
<ol>
<li><strong>性能损耗</strong>：频繁的 DOM 操作是浏览器中最昂贵的开销。</li>
<li><strong>状态难以维护</strong>：当页面上有几十个地方需要根据同一个数据变化时，开发者需要手动去更新这几十个 DOM 节点。一旦漏掉一个，界面就会出现 Bug（数据与视图不一致）。</li>
</ol>
<p>这就好比你要指挥一个合唱团，在这一阶段，你需要走到每一个团员面前告诉他该唱什么，效率极低且容易出错。</p>
<h2 data-id="heading-6">第三次革命：现代化的声明式开发（数据驱动与组件化）</h2>
<p>2015 年前后，以 Vue、React 为代表的现代框架引发了第三次革命。这次革命的核心在于：<strong>数据驱动视图（Data-Driven）</strong> 与 <strong>声明式编程</strong>。</p>
<h3 data-id="heading-7">3.1 告别 DOM 操作</h3>
<p>开发者不再需要关心“怎么做”（How to update DOM），只需要关心“是什么”（What is the state）。</p>
<p>让我们看看 <code>app.vue</code> 是如何优雅地解决同一个问题的：</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">&lt;script setup&gt;
<span class="hljs-keyword">import</span> { ref, onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-comment">// 1. 定义响应式数据</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-title function_">ref</span>([]);

<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'http://localhost:3000/users'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
    <span class="hljs-comment">// 2. 仅仅修改数据，界面自动更新</span>
    users.<span class="hljs-property">value</span> = data;
  })
})

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  users.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'赵六'</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">'485@qq.com'</span>
  })
}, <span class="hljs-number">2000</span>)

&lt;/script&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"user in users"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"user.id"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ user.id }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ user.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ user.email }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-8">3.2 核心理念解析</h3>
<p>这一阶段有几个关键特征：</p>
<ol>
<li>
<p>响应式数据（Reactivity）：</p>
<p><code>ref([])</code> 不仅仅是一个变量，它是一个被包装的代理对象。当<code> users.value</code> 发生变化时，Vue 的响应式系统会立刻感知，并通知视图进行更新。</p>
</li>
<li>
<p>声明式渲染（Declarative Rendering）：</p>
<p>我们不再手动写<code>document.createElement</code>或拼接字符串。我们使用<code>{{}}</code>和<code>v-for</code>这种模板语法，描述状态与 UI 的映射关系。</p>
<ul>
<li><em>后端套模板</em>：是字符串的替换，一次性的。</li>
<li><em>前端数据驱动</em>：是活的绑定，数据变，视图随之变。</li>
</ul>
</li>
<li>
<p>组件化与工程化：</p>
<p>早期的 JS 脚本散落在 HTML 中，维护灾难。而现在，通过 ESM（ECMAScript Modules）和构建工具（Vite/Webpack），我们将代码封装在 .vue 或 .jsx 文件中。JS 终于拥有了原生模块化能力（import/export），使得构建大型应用成为可能。</p>
</li>
</ol>
<h2 data-id="heading-9">结语：从“做页面”到“构建应用”</h2>
<p>回顾这三次革命：</p>
<ol>
<li><strong>后端 MVC 时代</strong>：解决了<strong>有无</strong>问题，实现了信息的发布。</li>
<li><strong>前后端分离时代</strong>：解决了<strong>分工</strong>问题，提升了用户体验，但带来了 DOM 维护成本。</li>
<li><strong>数据驱动时代</strong>：解决了<strong>效率与复杂度</strong>问题，让前端能承载复杂的业务逻辑（如 3D 编辑器、在线文档）。</li>
</ol>
<p>现在的开发者，不再是简单的“切图工”，而是软件工程师。我们利用 <code>ref</code> 管理状态，利用 Canvas/WebGL 渲染 3D 世界，利用工程化工具构建庞大的系统。</p>
<p>正如<code>app.vue</code>代码中演示的那样，一个 <code>setTimeout</code> 向数组<code>push</code>一条数据，表格自动增加一行。这看似简单的自动化背后，凝聚了前端社区二十年来对“关注点分离”的不懈追求——<strong>把繁琐留给框架，把创造力留给开发者</strong>。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[跨平台人脸识别 SDK 部署指南]]></title>    <link>https://juejin.cn/post/7582104240988373018</link>    <guid>https://juejin.cn/post/7582104240988373018</guid>    <pubDate>2025-12-11T05:35:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582104240988373018" data-draft-id="7582104240988323866" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="跨平台人脸识别 SDK 部署指南"/> <meta itemprop="keywords" content="后端,代码规范,Linux"/> <meta itemprop="datePublished" content="2025-12-11T05:35:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="进击的丸子"/> <meta itemprop="url" content="https://juejin.cn/user/2506542243120680"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            跨平台人脸识别 SDK 部署指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2506542243120680/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    进击的丸子
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:35:02.000Z" title="Thu Dec 11 2025 05:35:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">跨平台人脸识别 SDK 部署指南</h2>
<p><strong>（Linux 本地环境 → 虚拟机 → Docker全流程清晰讲解）</strong></p>
<h2 data-id="heading-1">1. 部署背景与环境架构概述</h2>
<h3 data-id="heading-2">1.1 部署背景</h3>
<p>在开发跨平台人脸识别系统的过程中，一个常见的痛点是：</p>
<blockquote>
<p><strong>SDK 本地能跑，但移植到 Linux、Docker等环境就各种依赖缺失、GLIBC 不兼容。</strong></p>
</blockquote>
<p>笔者最近完成了<a href="https://link.juejin.cn?target=https%3A%2F%2Fai.arcsoft.com.cn%2F%3Futm_source%3Djuejin%26%26utm_medium%3Dchenying" target="_blank" title="https://ai.arcsoft.com.cn/?utm_source=juejin&amp;&amp;utm_medium=chenying" ref="nofollow noopener noreferrer">虹软人脸识别 SDK</a> 的 Spring Boot + Vue3 项目在 Linux 环境的部署。本文将带你从零开始梳理工程落地流程，帮助你在 <strong>Linux 实机/虚拟机 + Docker 容器</strong> 中顺利运行 Linux Pro SDK。</p>
<h3 data-id="heading-3">1.2 本地 / 虚拟机 / Docker 架构说明</h3>
<p>为了顺利部署项目，我们先明确几个关键概念：物理机、虚拟机、容器（Docker）分别是什么，其区别是什么。</p>
<h4 data-id="heading-4">1.2.1 本地物理机</h4>
<p>直接运行在计算机硬件上的系统，例如你的 Windows 或 Linux 主机。</p>
<p><strong>特点：</strong></p>

















<table><thead><tr><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>性能好、简单易用</td><td>环境不可复制、迁移困难</td></tr><tr><td>无虚拟层，速度最快</td><td>配置易污染、维护困难</td></tr></tbody></table>
<p>适合场景：</p>
<ul>
<li>本地开发</li>
<li>小规模测试</li>
</ul>
<h4 data-id="heading-5">1.2.2 虚拟机（VM）</h4>
<p>在 Windows 中通过 Hyper-V、VirtualBox、VMware 启动一个 <strong>完整的 Ubuntu 系统</strong>。</p>
<p><strong>特点：</strong></p>

















<table><thead><tr><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>隔离性完美</td><td>内存占用大、启动慢</td></tr><tr><td>能模拟真实生产环境</td><td>镜像大，不宜扩展</td></tr></tbody></table>
<p>适合：</p>
<ul>
<li>开发环境模拟生产环境</li>
<li>多系统测试（Windows 上跑 Linux）</li>
</ul>
<hr/>
<h4 data-id="heading-6">1.2.3 Docker 容器</h4>
<p>共享宿主机内核，无需每个实例都安装完整系统。</p>
<p><strong>容器 vs 虚拟机对比：</strong></p>

























<table><thead><tr><th>对比项</th><th>虚拟机</th><th>Docker</th></tr></thead><tbody><tr><td>启动速度</td><td>分钟级</td><td>秒级</td></tr><tr><td>占用资源</td><td>多（独立系统）</td><td>少（共享内核）</td></tr><tr><td>部署环境</td><td>难以复制</td><td>一致可复现</td></tr></tbody></table>
<p>适合：</p>
<ul>
<li>生产环境</li>
<li>微服务架构</li>
<li>DevOps、CI/CD 自动化</li>
</ul>
<p><strong>举例：</strong> 你可以把一个 Java Spring Boot 应用打包成一个 Docker 镜像，交给任何机器运行，不需要安装 JDK 或配置环境变量。</p>
<hr/>
<h2 data-id="heading-7">2. 环境依赖与版本检查</h2>
<p>本文涉及的三层环境（Host → VM → Docker）：</p>
<pre><code class="hljs">Windows 主机
 └── Ubuntu 虚拟机（VirtualBox）
      └── Docker 容器（运行 SDK Demo）
</code></pre>
<p>具体版本如下：</p>

























<table><thead><tr><th>环境</th><th>推荐版本</th></tr></thead><tbody><tr><td>Host OS</td><td>Windows 11</td></tr><tr><td>VM OS</td><td>Ubuntu 18.04</td></tr><tr><td>Docker Base</td><td>Ubuntu:18.04</td></tr><tr><td>SDK</td><td>ArcSoft_ArcFacePro_linuxPro</td></tr></tbody></table>
<h4 data-id="heading-8">Linux 环境必要依赖检查</h4>
<p>SDK 大多依赖特定版本的：</p>
<ul>
<li><strong>GLIBC</strong></li>
<li><strong>GLIBCXX（libstdc++）</strong></li>
<li><strong>GCC</strong></li>
</ul>
<p>推荐优先检查：</p>
<h5 data-id="heading-9">2.1 查看 GLIBC 版本</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#  最低支持2.17</span>
strings /usr/lib/x86_64-linux-gnu/libstdc++.so.* | grep GLIBC_
</code></pre>
<p>输出结果示例：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5937468a172745fbac6d7378ab55de23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=vE5KdXAYEvZBJrZHq4RPTciNQn4%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h5 data-id="heading-10">2.2 查看 GLIBCXX 版本</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 最低支持3.4.21版本</span>
strings /usr/lib/x86_64-linux-gnu/libstdc++.so.* | grep GLIBCXX
</code></pre>
<p>输出结果示例：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6498ed4a8d13409fb717d0df7b5dcc09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=al0SvCy1B7fBQUKOsdqNAtGdjws%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-11">2.3 查看编译器 GCC 版本</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 最低支持4.8.2</span>
gcc --version
</code></pre>
<p>输出结果示例：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a916f7107d4e40f8bf390a64c0d28975~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=l4suSGmotbyLJcpAZwjXmpb%2FTQI%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-12">3. SDK 部署流程</h2>
<p>在日常开发中，我们通常在 Windows 环境中进行项目调试与测试，而最终的生产部署多运行在 Linux 服务器上。 以虹软人脸识别 SDK 为例，其官方 Demo 是基于 <strong>Spring Boot + Vue3</strong> 实现的完整后端与前端系统。为了将该系统迁移至 Linux 服务器运行，我们需要完成以下任务：</p>
<ol start="0">
<li>在 Linux 系统（或 WSL Ubuntu 子系统）中搭建运行环境。</li>
<li>将项目打包成可执行 JAR 文件。</li>
<li>在服务器上运行并验证。</li>
<li>使用 Docker 容器化运行，方便部署与迁移。</li>
</ol>
<h3 data-id="heading-13">3.1 在 Linux 部署 JAR 服务（本地物理机部署 jar 包）</h3>
<ol start="0">
<li>由于虹软官方源码是java环境，所以我们运行该demo需要先配置java环境，可以先检查一下自己的系统里是否有安装（jdk推荐安装1.8版本）：</li>
</ol>

<pre><code class="hljs">java -version
</code></pre>
<p>输出示例：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d804d4a58f44bdebd11e385c0daa143~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=aznHCzH6CVwsvyZzgHVgTtzLw0s%3D" alt="image.png" loading="lazy"/></p>
<ol start="2">
<li>可以看到linux环境（Ubuntu 18）里是没有安装Java的，这里我们根据提示安装，default-jre在Ubuntu 18系统里默认是11版本：</li>
</ol>

<pre><code class="hljs">sudo apt install openjdk-11-jre-headless
</code></pre>
<p>输出示例：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be11734db1dc40f29d3a796aad9cf29f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=%2B5NfoQQXj1%2FF5NZdqAj23wdGP9o%3D" alt="image.png" loading="lazy"/></p>
<ol start="3">
<li>安装完成后可以再次查看java -version：</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed56954e240a45c98f3594c66dc69212~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=lKplpGgQUugyac6jtxlruYvb%2F8I%3D" alt="image.png" loading="lazy"/></p>

<ol start="4">
<li>出现11.0.19的字样就说明安装成功了，接下来我们可以在本地跑一下虹软的demo了，首先从官网下载server源码demo：</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e245bb9612d4ecb9ebcf24499e2fbca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=u%2BUPJ5j9mtUBdHwwLb3Or6%2FDy3k%3D" alt="image.png" loading="lazy"/></p>

<ol start="5">
<li>下载后使用idea运行该项目，并修改<code>appid</code> 、<code>sdk-key</code>、 <code>active-key</code> ，用maven编译该demo的jar包：</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6af47fd007034a398e28706841b96ead~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=2L2j3KYQtlSqPv%2BAujWAzA%2BKN5A%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d195a654bcc4a0b830c731652a276ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=sdT4%2F23UEGn77FicP6%2Fr8vzwKs8%3D" alt="image.png" loading="lazy"/></p>

<ol start="6">
<li>为了方便运行，给这个jar包改名为face-demo.jar，并放到项目根目录下：</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cf94052d1994de49a16b4d21264f24d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=Bi1Y1W%2B%2FnW%2BGqaR3GhVrFEpJntA%3D" alt="image.png" loading="lazy"/></p>

<ol start="7">
<li>然后执行命令：</li>
</ol>

<pre><code class="hljs">java -jar face-demo.jar
</code></pre>
<p>输出示例：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63563e1353ce4c249cdcda36cda6fa2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=m%2FIc%2B1bDOlws0oJjrP%2BXOUrGaOo%3D" alt="image.png" loading="lazy"/></p>
<ol start="8">
<li>等待程序运行，运行成功会出现以下界面，点击访问默认访问地址则可以访问该网站：</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a53a552843446dfb4999620d6b9aca5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=bStMQ7gIG2XZz9LLDrUwBX6MRLE%3D" alt="image.png" loading="lazy"/></p>

<ol start="9">
<li>log中没有出现错误则表示运行成功，访问则可以看到下面的网页：</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd3a7c844cbf4006bd05aa0dc461d470~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=sMBz6zyRg8lnWFfM7aouAFT%2FihA%3D" alt="image.png" loading="lazy"/>
<strong>注意事项：</strong></p>
<p>如若访问失败，可以看下命令行log中有没有激活失败的问题，如果激活失败则更重复一下上述修改 <code>appid</code> 、<code>sdk-key</code>、</p>
<p><code>active-key</code> 的步骤，下图 <code>active-key</code> 被使用后则激活失败：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ab2b2669a8841ea84aabbc78ad23014~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=4eMo339m4iMg8O3RW6ByivDRpyE%3D" alt="image-20251125170615420" loading="lazy"/></p>
<h3 data-id="heading-14">3.2 使用 Docker 部署 SDK（使用 Docker 容器部署 jar 包）</h3>
<h4 data-id="heading-15">3.2.1 准备 Docker 容器（安装 Docker）</h4>
<ol start="0">
<li>安装Docker，执行以下命令:</li>
</ol>

<pre><code class="hljs language-sql" lang="sql">sudo apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> <span class="hljs-keyword">update</span>
sudo apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> installapt<span class="hljs-operator">-</span>transport<span class="hljs-operator">-</span>httpsca<span class="hljs-operator">-</span>certificates
curl \
software<span class="hljs-operator">-</span>properties<span class="hljs-operator">-</span>commonlsb<span class="hljs-operator">-</span><span class="hljs-keyword">release</span>
gnupg2
</code></pre>
<p>2.  卸载旧版本（如果有）</p>

<pre><code class="hljs language-arduino" lang="arduino">sudo apt-get remove docker docker-engine docker.io containerd runc
</code></pre>
<p>3.  更新 apt</p>

<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span>
</code></pre>
<p>4.  安装依赖</p>

<pre><code class="hljs language-arduino" lang="arduino">sudo apt install ca-certificates curl gnupg lsb-release -y
</code></pre>
<p>5.  添加 Docker 官方 GPG Key</p>

<pre><code class="hljs language-arduino" lang="arduino">curl -fsSL https:<span class="hljs-comment">//download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span>
</code></pre>
<p>6.  添加 Docker 官方仓库</p>

<pre><code class="hljs language-bash" lang="bash">sudo add-apt-repository \
   <span class="hljs-string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   <span class="hljs-subst">$(lsb_release -cs)</span> \
   stable"</span>
</code></pre>
<p>7.  安装 Docker</p>

<pre><code class="hljs language-lua" lang="lua">sudo apt update
sudo apt install docker-ce docker-ce-cli containerd.<span class="hljs-built_in">io</span> -y
</code></pre>
<p>8.  验证</p>

<pre><code class="hljs language-arduino" lang="arduino">docker --version
sudo docker run hello-world
</code></pre>
<p>9.  安装成功示例如下：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75ded122825f4bd3bdf699a052c68a8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=AhcuhAkSOTUVJuZKVgUIRWjmkPo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-16">3.2.2 准备 JAR 包</h4>
<p>使用虹软官方demo构建jar包（face-demo-docker.jar），可以参考3.1中下载步骤，这里不再赘述</p>
<h4 data-id="heading-17">3.2.3 准备一个基础 Dockerfile</h4>
<p>我们需要了解一下什么是 Dockerfile，Dockerfile 就是一份 <strong>构建 Docker 镜像的“配方”</strong> 。只要写好 Dockerfile，执行 <code>docker build</code>，Docker 就能自动：</p>
<ul>
<li>拉镜像</li>
<li>复制文件</li>
<li>安装依赖</li>
<li>启动你的 SpringBoot Jar</li>
<li>打包成一个可运行的镜像</li>
</ul>
<p>接下来我们在项目根目录创建一个 <code>Dockerfile</code>：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 基于 JDK 11 镜像</span>
FROM eclipse-temurin:11-jdk-jammy
​
<span class="hljs-comment"># 工作目录</span>
WORKDIR /app
​
<span class="hljs-comment">#复制jar文件</span>
COPY face-demo-docker.jar /app/app.jar
​
<span class="hljs-comment"># 声明容器在运行时会监听的端口号，这里的端口号只是一个声明，不会真正打开端口，也不会影响容器运行</span>
<span class="hljs-comment"># 真正决定外部访问端口的是：docker run -p 宿主机端口:容器端口</span>
EXPOSE 8089
​
<span class="hljs-comment"># 容器启动命令</span>
ENTRYPOINT [<span class="hljs-string">"java"</span>, <span class="hljs-string">"-jar"</span>, <span class="hljs-string">"/app/app.jar"</span>]
</code></pre>
<h4 data-id="heading-18">3.2.4 构建镜像</h4>
<p>构建镜像：</p>
<pre><code class="hljs language-arduino" lang="arduino">docker build -t face-demo-image:v1 .
</code></pre>
<p><code>docker build</code>：构建镜像的命令。</p>
<p><code>-t face-demo-image:latest</code>：给生成的镜像打上一个标签（tag）。</p>
<ul>
<li><code>face-demo</code>-image 是镜像名称；</li>
<li><code>latest</code> 是标签（一般表示最新版，可自定义，比如 <code>v1</code>）。</li>
</ul>
<p><code>.</code>：表示构建上下文（context）为当前目录，也就是说它会在当前目录查找 <code>Dockerfile</code> 文件并打包所有内容。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42267027d2824ea88c53f170f8f1a808~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=%2BFk2zLvoXZnFkwZPeIrlL1jvKX8%3D" alt="image.png" loading="lazy"/></p>
<p><strong>注意事项：</strong></p>
<p>docker相同镜像名 + 相同 tag（完全重复）→ 会被覆盖，none就是被覆盖的那个，建议build镜像前先检查一下已有的镜像</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06b2abe2752043af84a7a580c647528a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=wvw66sV7kecjcva9CwtLoIWHXi8%3D" alt="image.png" loading="lazy"/>
相同镜像名+不同tag，则可以共存</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eda3a6a46edb457db7d6952555df1044~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=7i5FdpV%2Fa2xT8ZKC4R8IrEOA0S0%3D" alt="image.png" loading="lazy"/>
删除相同镜像名+不同tag则要删除对应tag</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cbfa5c6cbff449a6b9dcf72c17052c5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=2mJRtjpl%2BhqdUOFIX2Pov%2BinFIo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-19">3.2.5 运行容器</h4>
<pre><code class="hljs language-arduino" lang="arduino">docker run -it -p <span class="hljs-number">9000</span>:<span class="hljs-number">8089</span> --name arcface-container face-demo-image:v1
</code></pre>





























<table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td><code>docker run</code></td><td>创建并运行一个新容器</td></tr><tr><td><code>-it</code></td><td>进入交互式终端（前台），后台运行使用-d</td></tr><tr><td><code>-p 9000:8089</code></td><td><strong>端口映射</strong>：将宿主机的 <code>9000</code> 端口映射到容器的 <code>8089</code> 端口(<strong>8089</strong>是jar包里面定义的端口号）</td></tr><tr><td><code>--name arcface-container</code></td><td>给容器取名为 <code>arcface</code>，方便后续管理</td></tr><tr><td><code>face-demo-image:v1</code></td><td>指定要运行的镜像名称和版本标签（你之前 build 的镜像）</td></tr></tbody></table>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e181168d0fb1476dbf434b3a08cd7700~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=dxKC1z%2FEH6rEZWg9M31P29CIifk%3D" alt="image.png" loading="lazy"/>
查看运行状态：</p>
<pre><code class="hljs">docker ps
</code></pre>
<p>输出示例</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f8258fe974c43c58a7b4d26edad7c6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=LCVljbM%2FYxXsyRyLTPciHlg1mgg%3D" alt="image.png" loading="lazy"/>
若容器状态为 <code>Up</code>，说明服务启动成功。 此时可以访问：</p>
<pre><code class="hljs language-xml" lang="xml">http://<span class="hljs-tag">&lt;<span class="hljs-name">你的服务器IP</span>&gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">你的端口号</span>&gt;</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c5530f66418428c89bce61b178a73fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=T5cRdiVMVT9vlTm7bK6e0C%2Be9Kw%3D" alt="image.png" loading="lazy"/>
<strong>注意事项：</strong></p>
<ol start="0">
<li>容器名不能重复</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd77c4458d56429a9f30deb6cb539df8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5Li45a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036102&amp;x-signature=rPz%2B%2F6vch9H5o59y5LxX%2FP0NAKg%3D" alt="image.png" loading="lazy"/></p>

<ol start="2">
<li><strong>一个激活码只能用一个容器</strong>，容器重启后会导致原激活码失效</li>
</ol>
<h2 data-id="heading-20">4. 常见问题（FAQ）</h2>






























<table><thead><tr><th>问题</th><th>可能原因</th><th>解决方法</th></tr></thead><tbody><tr><td>访问不到服务</td><td>防火墙或端口未开放</td><td><code>sudo ufw allow &lt;你的端口&gt;</code> 开放端口</td></tr><tr><td>Docker 构建慢</td><td>网络镜像源未替换</td><td>可换为阿里云或中科大镜像源</td></tr><tr><td>Jar 启动失败</td><td>JDK 版本不匹配</td><td>使用 <code>java -version</code> 确认 JDK 与项目一致</td></tr><tr><td>项目路径权限问题</td><td>未赋执行权限</td><td>使用 <code>chmod +x face-demo.jar</code></td></tr></tbody></table>
<h2 data-id="heading-21">5. 总结</h2>
<p>本文围绕<a href="https://link.juejin.cn?target=https%3A%2F%2Fai.arcsoft.com.cn%2F%3Futm_source%3Djuejin%26%26utm_medium%3Dchenying" target="_blank" title="https://ai.arcsoft.com.cn/?utm_source=juejin&amp;&amp;utm_medium=chenying" ref="nofollow noopener noreferrer">虹软人脸识别 SDK</a>的跨平台部署，从 <strong>Windows 本地环境、Ubuntu 虚拟机到 Docker 容器化运行</strong>，完整梳理了实际项目在不同环境下的落地流程。通过逐步验证系统依赖、检查 glibc 与 libstdc++版本、配置 Java 运行环境、构建 Spring Boot Jar 包，再到最后使用 Docker 打包镜像并运行服务，整个过程展示了一个跨平台项目从开发环境过渡到生产环境的完整路径。希望能够帮助你在后续的工程中更加顺利地进行部署与上线。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[开源一个 Nuxt 4 导航站模板，功能完整，拿来即用！]]></title>    <link>https://juejin.cn/post/7582110969201197094</link>    <guid>https://juejin.cn/post/7582110969201197094</guid>    <pubDate>2025-12-11T05:06:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582110969201197094" data-draft-id="7582118218649157658" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="开源一个 Nuxt 4 导航站模板，功能完整，拿来即用！"/> <meta itemprop="keywords" content="前端,开源"/> <meta itemprop="datePublished" content="2025-12-11T05:06:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Pub的知识花园"/> <meta itemprop="url" content="https://juejin.cn/user/1591748567524232"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            开源一个 Nuxt 4 导航站模板，功能完整，拿来即用！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748567524232/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Pub的知识花园
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:06:37.000Z" title="Thu Dec 11 2025 05:06:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">开源一个 Nuxt 4 目录网站模板，功能完整，拿来即用！</h2>
<h3 data-id="heading-1">🎯 前言</h3>
<p>大家好，我是 Pub。</p>
<p>最近开源了一个项目 <strong>Nuxt Mkdirs</strong> —— 一个基于 <strong>Nuxt 4</strong> 构建的目录网站模板。</p>
<blockquote>
<p>🔗 GitHub: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FPBHAHAHA%2FNuxt_Mkdirs" target="_blank" title="https://github.com/PBHAHAHA/Nuxt_Mkdirs" ref="nofollow noopener noreferrer">github.com/PBHAHAHA/Nu…</a></p>
<p>🌐 介绍页地址: <a href="https://link.juejin.cn?target=https%3A%2F%2Fnuxt-mkdirs.com" target="_blank" title="https://nuxt-mkdirs.com" ref="nofollow noopener noreferrer">nuxt-mkdirs.com</a></p>
</blockquote>
<p>这个项目之前是作为付费模板在卖，但效果不太理想，索性开源出来，希望能帮到有需要的同学。</p>
<p><strong>先放几张效果图：</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57eaa1e0b13b4eee8708137705896e43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUHVi55qE55-l6K-G6Iqx5Zut:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036256&amp;x-signature=6KzbdQkOfPqd25SdkVC7DpnM7YA%3D" alt="微信图片_20251211124406_30_54.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6dfcebef8e0413493259063b7bc4c9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUHVi55qE55-l6K-G6Iqx5Zut:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036256&amp;x-signature=XYBBnhYht5pv%2B8RxulJpmwT1ET0%3D" alt="微信图片_20251211124432_31_54.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/deef3294275b41e5b8637b976ec5b187~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUHVi55qE55-l6K-G6Iqx5Zut:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036256&amp;x-signature=OY0CDNCwcdGgYtDWDbc7unaSdBo%3D" alt="微信图片_20251211124443_32_54.png" loading="lazy"/></p>
<h3 data-id="heading-2">🤔 为什么做这个？</h3>
<p>目录网站（Directory Website）是一种很常见的网站类型：</p>
<ul>
<li>🤖 AI 工具导航站</li>
<li>💻 独立开发者产品目录</li>
<li>📦 SaaS 产品收录站</li>
<li>🎨 设计资源导航</li>
</ul>
<p>市面上的目录模板大多是 Next.js，<strong>Vue Nuxt 生态相对较少</strong>。</p>
<p>作为一个 Vue/Nuxt 开发者，我决定自己撸一个，顺便把常用的功能都集成进去。</p>
<h3 data-id="heading-3">🛠️ 技术栈</h3>





































<table><thead><tr><th>类别</th><th>技术</th></tr></thead><tbody><tr><td>框架</td><td><strong>Nuxt 4</strong> + Vue 3</td></tr><tr><td>样式</td><td><strong>TailwindCSS 4</strong> + Radix Vue</td></tr><tr><td>CMS</td><td><strong>Sanity</strong>（无头 CMS）</td></tr><tr><td>认证</td><td>Auth.js（Google/GitHub OAuth）</td></tr><tr><td>支付</td><td>Stripe + Creem</td></tr><tr><td>邮件</td><td>Resend</td></tr><tr><td>部署</td><td>NuxtHub（Cloudflare）</td></tr></tbody></table>
<h4 data-id="heading-4">为什么用 Sanity 而不是数据库？</h4>
<p>可能有同学会问：为什么不用 MySQL/PostgreSQL？</p>
<p><strong>Sanity 作为无头 CMS 的优势：</strong></p>
<ol>
<li>✅ <strong>零数据库配置</strong> - 不需要自己搭建和维护数据库</li>
<li>✅ <strong>可视化后台</strong> - Sanity Studio 开箱即用</li>
<li>✅ <strong>免费额度充足</strong> - 小型项目完全够用</li>
<li>✅ <strong>自带图片 CDN</strong> - 不用操心图片存储</li>
</ol>
<h3 data-id="heading-5">✨ 核心功能</h3>
<h4 data-id="heading-6">1️⃣ 三种首页布局</h4>
<p>提供了 3 种不同风格的首页，开箱即用：</p>
<pre><code class="hljs language-bash" lang="bash">/          <span class="hljs-comment"># 默认首页</span>
/home2     <span class="hljs-comment"># 布局二</span>
/home3     <span class="hljs-comment"># 布局三</span>
</code></pre>
<h4 data-id="heading-7">2️⃣ 完整的目录系统</h4>
<ul>
<li><strong>分类 (Category)</strong> - 支持分组展示</li>
<li><strong>标签 (Tag)</strong> - 多标签筛选</li>
<li><strong>集合 (Collection)</strong> - 自定义产品集合</li>
<li><strong>搜索</strong> - 全文搜索</li>
</ul>
<h4 data-id="heading-8">3️⃣ 用户系统</h4>
<ul>
<li>Google / GitHub OAuth 一键登录</li>
<li>用户 Dashboard</li>
<li>个人设置</li>
</ul>
<h4 data-id="heading-9">4️⃣ 内容提交 &amp; 审核流程</h4>
<pre><code class="hljs">用户提交 → 待审核 → 管理员审核 → 发布/拒绝
</code></pre>
<p>用户可以提交产品，管理员在 Sanity Studio 后台审核。</p>
<h4 data-id="heading-10">5️⃣ 双支付系统</h4>
<ul>
<li><strong>Stripe</strong> - 国际支付</li>
<li><strong>Creem</strong> - 🇨🇳 国内友好，支持大陆身份证注册</li>
</ul>
<blockquote>
<p>💡 对于国内开发者，强烈推荐 Creem，注册简单，不需要公司资质。</p>
</blockquote>
<h4 data-id="heading-11">6️⃣ 博客系统</h4>
<p>内置博客功能，支持 Markdown，可以用来做 SEO 引流。</p>
<h4 data-id="heading-12">7️⃣ Newsletter 订阅</h4>
<p>集成 Resend 邮件服务，支持：</p>
<ul>
<li>邮件订阅</li>
<li>一键退订</li>
<li>订阅者管理</li>
</ul>
<h4 data-id="heading-13">8️⃣ AI 集成（可选）</h4>
<p>支持接入：</p>
<ul>
<li>Google AI (Gemini)</li>
<li>DeepSeek</li>
<li>OpenAI</li>
</ul>
<p>可以用来自动生成产品描述、智能分类等。</p>
<h3 data-id="heading-14">📁 项目结构</h3>
<pre><code class="hljs language-csharp" lang="csharp">nuxt-mkdirs/
├── app/
│   ├── components/     <span class="hljs-meta"># 53+ 组件</span>
│   ├── composables/    <span class="hljs-meta"># 组合式函数</span>
│   ├── layouts/        <span class="hljs-meta"># 3 种布局</span>
│   ├── pages/          <span class="hljs-meta"># 30+ 页面</span>
│   └── config/         <span class="hljs-meta"># 站点配置</span>
├── server/
│   ├── api/            <span class="hljs-meta"># 38+ API 路由</span>
│   └── utils/          <span class="hljs-meta"># 服务端工具</span>
├── sanity/
│   └── schemas/        <span class="hljs-meta"># 16 个 Schema</span>
└── <span class="hljs-keyword">public</span>/             <span class="hljs-meta"># 静态资源</span>
</code></pre>
<h3 data-id="heading-15">🚀 快速开始</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 克隆项目</span>
git <span class="hljs-built_in">clone</span> https://github.com/PBHAHAHA/Nuxt_Mkdirs.git
<span class="hljs-built_in">cd</span> Nuxt_Mkdirs

<span class="hljs-comment"># 安装依赖</span>
pnpm install

<span class="hljs-comment"># 复制环境变量</span>
<span class="hljs-built_in">cp</span> .env.example .<span class="hljs-built_in">env</span>

<span class="hljs-comment"># 启动开发服务器</span>
pnpm dev
</code></pre>
<p>访问 <code>http://localhost:3000</code> 即可看到效果。</p>
<h3 data-id="heading-16">⚙️ 配置说明</h3>
<h4 data-id="heading-17">Sanity CMS（必需）</h4>
<pre><code class="hljs language-bash" lang="bash">NUXT_PUBLIC_SANITY_PROJECT_ID=your_project_id
NUXT_PUBLIC_SANITY_DATASET=production
NUXT_SANITY_API_TOKEN=your_api_token
</code></pre>
<h4 data-id="heading-18">OAuth 认证（可选）</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Google</span>
NUXT_AUTH_GOOGLE_CLIENT_ID=xxx
NUXT_AUTH_GOOGLE_CLIENT_SECRET=xxx

<span class="hljs-comment"># GitHub</span>
NUXT_AUTH_GITHUB_CLIENT_ID=xxx
NUXT_AUTH_GITHUB_CLIENT_SECRET=xxx

<span class="hljs-comment"># Secret（用 openssl rand -base64 32 生成）</span>
NUXT_AUTH_SECRET=xxx
</code></pre>
<h4 data-id="heading-19">邮件服务（可选）</h4>
<pre><code class="hljs language-bash" lang="bash">NUXT_RESEND_API_KEY=re_xxxxx
NUXT_RESEND_EMAIL_FROM=noreply@yourdomain.com
</code></pre>
<h4 data-id="heading-20">支付（可选）</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Stripe（国际）</span>
NUXT_STRIPE_SECRET_KEY=sk_xxxxx

<span class="hljs-comment"># Creem（国内推荐）</span>
NUXT_CREEM_API_KEY=xxxxx
</code></pre>
<h3 data-id="heading-21">🌐 一键部署</h3>
<p>推荐使用 <strong>NuxtHub</strong> 部署到 Cloudflare：</p>
<pre><code class="hljs language-bash" lang="bash">npx nuxthub deploy
</code></pre>
<p>也支持 Vercel、Netlify 等平台。</p>
<h3 data-id="heading-22">📄 开源协议</h3>
<p><strong>MIT</strong> 协议，可以自由使用、修改、商用。</p>
<h3 data-id="heading-23">🙏 写在最后</h3>
<p>这个项目前前后后花了不少时间，虽然作为付费模板没卖出去几份，但开源出来希望能帮到更多人。</p>
<p><strong>如果这个项目对你有帮助：</strong></p>
<ul>
<li>⭐ <strong>Star</strong> 一下支持作者</li>
<li>🐛 发现 Bug 欢迎提 <strong>Issue</strong></li>
<li>📢 分享给有需要的朋友</li>
<li>💬 有问题可以评论区交流</li>
</ul>
<blockquote>
<p>🔗 GitHub: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FPBHAHAHA%2FNuxt_Mkdirs" target="_blank" title="https://github.com/PBHAHAHA/Nuxt_Mkdirs" ref="nofollow noopener noreferrer">github.com/PBHAHAHA/Nu…</a></p>
</blockquote>
<p>也可以加我微信交流：<strong>w314709923x</strong></p>
<p><em>如果觉得有帮助，别忘了点赞 👍 收藏 ⭐ 关注 ➕ 三连哦～</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React Native 从零开始完整教程（环境配置 → 国内镜像加速 → 运行项目）]]></title>    <link>https://juejin.cn/post/7582118218649206810</link>    <guid>https://juejin.cn/post/7582118218649206810</guid>    <pubDate>2025-12-11T05:11:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582118218649206810" data-draft-id="7582118218649190426" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React Native 从零开始完整教程（环境配置 → 国内镜像加速 → 运行项目）"/> <meta itemprop="keywords" content="React Native"/> <meta itemprop="datePublished" content="2025-12-11T05:11:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="码农突围NO1"/> <meta itemprop="url" content="https://juejin.cn/user/1843250655412046"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React Native 从零开始完整教程（环境配置 → 国内镜像加速 → 运行项目）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1843250655412046/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    码农突围NO1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:11:29.000Z" title="Thu Dec 11 2025 05:11:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>React Native 从零开始完整教程（环境配置 → 国内镜像加速 → 运行项目）</strong></h2>
<p>本教程将从 <strong>环境配置</strong> 开始，到 <strong>国内镜像加速</strong>，最后成功运行 React Native 项目（Android/iOS），适合新手和遇到网络问题的开发者。</p>
<hr/>
<h3 data-id="heading-1"><strong>1. 环境配置</strong></h3>
<h4 data-id="heading-2"><strong>1.1 安装 Node.js 和 npm/yarn</strong></h4>
<p>React Native 需要 Node.js（建议 LTS 版本）：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 安装 Node.js（官网：https://nodejs.org/）</span>
<span class="hljs-comment"># 安装后检查版本</span>
node -v  <span class="hljs-comment"># 要求 &gt;= 16</span>
npm -v   <span class="hljs-comment"># 或 yarn -v（推荐 yarn）</span>
</code></pre>
<h4 data-id="heading-3"><strong>1.2 安装 Java JDK（Android 必需）</strong></h4>
<p>Android 构建需要 JDK 17：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># macOS（Homebrew）</span>
brew install openjdk@17

<span class="hljs-comment"># Linux（Debian/Ubuntu）</span>
sudo apt-get install openjdk-17-jdk

<span class="hljs-comment"># Windows（手动安装）</span>
<span class="hljs-comment"># 下载：https://adoptium.net/temurin/releases/</span>
</code></pre>
<p>验证安装：</p>
<pre><code class="hljs language-bash" lang="bash">java -version  <span class="hljs-comment"># 应显示 "openjdk 17.x.x"</span>
</code></pre>
<h4 data-id="heading-4"><strong>1.3 安装 Android Studio（Android 开发环境）</strong></h4>
<ol>
<li>下载 <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fstudio" target="_blank" title="https://developer.android.com/studio" ref="nofollow noopener noreferrer">Android Studio</a>。</li>
<li>安装时勾选：
<ul>
<li><strong>Android SDK</strong></li>
<li><strong>Android Emulator</strong></li>
<li><strong>Platform Tools</strong></li>
</ul>
</li>
<li>配置环境变量：
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># macOS/Linux：添加到 ~/.zshrc 或 ~/.bashrc</span>
<span class="hljs-built_in">export</span> ANDROID_HOME=<span class="hljs-variable">$HOME</span>/Library/Android/sdk
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/platform-tools
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/cmdline-tools/latest/bin

<span class="hljs-comment"># Windows：在系统环境变量中添加 ANDROID_HOME 和 Path</span>
 右键 此电脑 → 属性 → 高级系统设置 → 环境变量
 在 系统变量 中：
 1. 新建变量名 ANDROID_HOME，值为 SDK 路径
 （如 C:\Users\你的用户名\AppData\Local\Android\Sdk）
 2. 编辑 PATH，添加两条新值：
 %ANDROID_HOME%\platform-tools
 %ANDROID_HOME%\emulator
</code></pre>
</li>
<li>验证：
<pre><code class="hljs language-bash" lang="bash">adb --version  <span class="hljs-comment"># 应显示版本号</span>
</code></pre>
</li>
</ol>
<h4 data-id="heading-5"><strong>1.4 安装 Xcode（仅 macOS，iOS 开发）</strong></h4>
<ol>
<li>从 App Store 安装 <strong>Xcode</strong>。</li>
<li>安装命令行工具：
<pre><code class="hljs language-bash" lang="bash">xcode-select --install
sudo xcodebuild -license accept
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-6"><strong>2. 创建 React Native 项目</strong></h3>
<h4 data-id="heading-7"><strong>2.1 使用官方模板初始化项目</strong></h4>
<pre><code class="hljs language-bash" lang="bash">npx @react-native-community/cli init MyProject
<span class="hljs-built_in">cd</span> MyProject
</code></pre>
<h4 data-id="heading-8"><strong>2.2 启动 Metro 开发服务器</strong></h4>
<pre><code class="hljs language-bash" lang="bash">npm start
<span class="hljs-comment"># 或</span>
yarn start
</code></pre>
<p>Metro 会启动一个本地服务（默认端口 8081），提供 JavaScript 代码的热更新。</p>
<h4 data-id="heading-9"><strong>Metro 是什么？</strong></h4>
<h5 data-id="heading-10"><strong>1. Metro 的核心作用</strong></h5>
<p>Metro 是 React Native <strong>专用的 JavaScript 打包工具</strong>，负责：</p>
<ul>
<li>实时将你的 React 代码和依赖打包成单个 <code>.bundle</code> 文件</li>
<li>支持开发时的<strong>热更新（Hot Reloading）</strong></li>
<li>提供错误提示和日志（终端中显示的红色错误框就是它的功劳）</li>
</ul>
<h5 data-id="heading-11"><strong>2. Metro 的工作流程</strong></h5>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
  A[你的代码] --&gt; B(Metro 打包器)
  B --&gt; C{开发模式?}
  C --&gt;|是| D[生成可调试的 bundle]
  C --&gt;|否| E[生成优化的生产包]
  D --&gt; F[发送到手机/模拟器]
</code></pre>
<h5 data-id="heading-12"><strong>3. 你与 Metro 的交互场景</strong></h5>
<ul>
<li><strong>启动 Metro</strong>：运行 <code>npm start</code> 时，会看到终端显示：
<pre><code class="hljs language-bash" lang="bash">Metro Bundler ready on http://localhost:8081
</code></pre>
</li>
<li><strong>调试时</strong>：手机上的 JS 代码实际是通过 Metro 服务实时加载的（这就是为什么必须保持 <code>npm start</code> 运行）</li>
<li><strong>报错时</strong>：Metro 会在终端和手机红屏显示错误堆栈</li>
</ul>
<h5 data-id="heading-13"><strong>4. 常见 Metro 问题解决</strong></h5>
<ul>
<li><strong>问题</strong>：<code>Metro 无法启动（端口占用）</code><br/>
<strong>解决</strong>：
<pre><code class="hljs language-bash" lang="bash">lsof -i :8081    <span class="hljs-comment"># 查看占用进程</span>
<span class="hljs-built_in">kill</span> -9 &lt;PID&gt;    <span class="hljs-comment"># 强制结束进程</span>
</code></pre>
</li>
<li><strong>问题</strong>：<code>缓存导致代码不更新</code><br/>
<strong>解决</strong>：
<pre><code class="hljs language-bash" lang="bash">npm start -- --reset-cache
</code></pre>
</li>
</ul>
<hr/>
<h4 data-id="heading-14"><strong>总结对比表</strong></h4>




















<table><thead><tr><th>概念</th><th>作用</th><th>是否需要手动配置</th></tr></thead><tbody><tr><td><strong>环境变量</strong></td><td>告诉系统 Android 工具在哪</td><td>✔️ 必须配置</td></tr><tr><td><strong>Metro</strong></td><td>打包和运行 JS 代码</td><td>❌ 自动集成于 RN 项目</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-15"><strong>3. 配置国内镜像加速</strong></h3>
<h4 data-id="heading-16"><strong>3.1 配置 npm/yarn 镜像（加速 JS 依赖下载）</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 使用淘宝镜像</span>
npm config <span class="hljs-built_in">set</span> registry https://registry.npmmirror.com
<span class="hljs-comment"># 或</span>
yarn config <span class="hljs-built_in">set</span> registry https://registry.npmmirror.com
</code></pre>
<h4 data-id="heading-17"><strong>3.2 配置 Gradle 镜像（加速 Android 依赖下载）</strong></h4>
<ol>
<li>修改 <code>android/build.gradle</code>：
<pre><code class="hljs language-gradle" lang="gradle">allprojects {
    repositories {
        // 阿里云镜像（优先）
        maven { url 'https://maven.aliyun.com/repository/public' }
        maven { url 'https://maven.aliyun.com/repository/google' }
        // 腾讯云镜像（备用）
        maven { url 'https://mirrors.cloud.tencent.com/nexus/repository/maven-public/' }
        // 默认仓库（确保兼容性）
        google()
        mavenCentral()
    }
}
</code></pre>
</li>
<li>修改 <code>android/gradle/wrapper/gradle-wrapper.properties</code>：
<pre><code class="hljs language-properties" lang="properties"># 替换为腾讯云镜像
distributionUrl=https\://mirrors.cloud.tencent.com/gradle/gradle-8.13-bin.zip
</code></pre>
</li>
</ol>
<h4 data-id="heading-18"><strong>3.3 配置 Maven 镜像（加速 Android 原生库下载）</strong></h4>
<p>在 <code>android/build.gradle</code> 的 <code>buildscript</code> 中添加：</p>
<pre><code class="hljs language-gradle" lang="gradle">buildscript {
    repositories {
        maven { url 'https://maven.aliyun.com/repository/public' }
        maven { url 'https://maven.aliyun.com/repository/google' }
        google()
        mavenCentral()
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-19"><strong>4. 运行项目</strong></h3>
<h4 data-id="heading-20"><strong>4.1 运行 Android 版本</strong></h4>
<ol>
<li>启动 Android 模拟器（通过 Android Studio 或命令行）：
<pre><code class="hljs language-bash" lang="bash">emulator -list-avds  <span class="hljs-comment"># 列出可用模拟器</span>
emulator -avd Pixel_5_API_34  <span class="hljs-comment"># 启动模拟器</span>
</code></pre>
</li>
<li>编译并安装 APK：
<pre><code class="hljs language-bash" lang="bash">npx react-native run-android <span class="hljs-comment">#另起终端运行，和metro分开</span>
</code></pre>
<ul>
<li>如果首次运行，Gradle 会从国内镜像下载依赖。</li>
<li>成功后会自动安装 APK 并启动应用。</li>
</ul>
</li>
</ol>
<h4 data-id="heading-21"><strong>4.2 运行 iOS 版本（仅 macOS）</strong></h4>
<ol>
<li>启动 iOS 模拟器：
<pre><code class="hljs language-bash" lang="bash">npx react-native run-ios
</code></pre>
<ul>
<li>会自动编译并启动模拟器。</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-22"><strong>5. 常见问题解决</strong></h3>
<h4 data-id="heading-23"><strong>问题 1：Gradle 下载卡住或超时</strong></h4>
<ul>
<li><strong>原因</strong>：网络问题或缓存冲突。</li>
<li><strong>解决</strong>：
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> android
./gradlew clean  <span class="hljs-comment"># 清理构建缓存</span>
<span class="hljs-built_in">rm</span> -rf ~/.gradle/caches/  <span class="hljs-comment"># 删除全局缓存</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-24"><strong>问题 2：<code>Could not resolve all dependencies</code></strong></h4>
<ul>
<li><strong>原因</strong>：某些库不在镜像中。</li>
<li><strong>解决</strong>：在 <code>build.gradle</code> 中保留 <code>google()</code> 和 <code>mavenCentral()</code>。</li>
</ul>
<h4 data-id="heading-25"><strong>问题 3：Metro 无法连接设备</strong></h4>
<ul>
<li><strong>解决</strong>：
<pre><code class="hljs language-bash" lang="bash">adb reverse tcp:8081 tcp:8081  <span class="hljs-comment"># 确保设备能访问 Metro</span>
</code></pre>
</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[深入探索 Spring Boot3 中 Profiles 多环境配置]]></title>    <link>https://juejin.cn/post/7582131164728868904</link>    <guid>https://juejin.cn/post/7582131164728868904</guid>    <pubDate>2025-12-11T05:37:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582131164728868904" data-draft-id="7582155513586057268" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="深入探索 Spring Boot3 中 Profiles 多环境配置"/> <meta itemprop="keywords" content="后端,Java,架构"/> <meta itemprop="datePublished" content="2025-12-11T05:37:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="程序员西西"/> <meta itemprop="url" content="https://juejin.cn/user/326976944214804"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            深入探索 Spring Boot3 中 Profiles 多环境配置
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/326976944214804/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    程序员西西
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:37:12.000Z" title="Thu Dec 11 2025 05:37:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>在当今复杂的软件开发领域，一个应用往往需要在开发、测试、生产等多个环境中运行，每个环境的配置需求大相径庭。想象一下，在开发环境中，你可能需要频繁调试，所以希望日志更加详细，数据库连接到本地易于修改的测试库；而在生产环境中，对性能和稳定性要求极高，日志级别需要调整，数据库要连接到高可用的正式数据库。Spring Boot 3 的 Profiles 特性就如同一位贴心的助手，为我们解决了不同环境配置管理的难题，提供了灵活且强大的多环境配置解决方案。接下来，让我们深入探索 Spring Boot3 中 Profiles 多环境配置的奥秘。</p>
<h2 data-id="heading-1">Profiles 是什么</h2>
<p>Profiles 是 Spring 框架提供的一种机制，它允许开发者针对不同的环境定义不同的配置。在 Spring Boot 应用里，借助激活特定的 Profile，能够实现条件化的 Bean 注册、配置属性加载等操作，从而使应用依据运行环境加载相应的配置。简单来说，它就像是为应用准备的不同 “装备包”，在不同的环境下，应用可以穿上合适的 “装备”，以最佳状态运行。</p>
<h2 data-id="heading-2">配置方式</h2>
<p><strong>（一）Properties 配置方式</strong></p>
<p>对于 application.properties 文件，我们可以创建多个以 application-{profile}.properties 命名的文件来定义不同环境的配置。其中，{profile} 就是环境标识，常见的如 dev（开发环境）、test（测试环境）、prod（生产环境）等。主配置文件 application.properties 通过 spring.profiles.active 属性来指定当前激活的环境。例如：</p>
<p>在主配置文件 application.properties 中设置：</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">spring.profiles.active</span>=dev
</code></pre>
<p>然后创建开发环境配置文件<br/>
application-dev.properties，里面可以定义开发环境特有的配置，如：</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">server.port</span>=<span class="hljs-number">8080</span>
<span class="hljs-attr">spring.datasource.url</span>=jdbc:mysql://localhost:<span class="hljs-number">3306</span>/devdb
<span class="hljs-attr">spring.datasource.username</span>=devuser
<span class="hljs-attr">spring.datasource.password</span>=devpassword
</code></pre>
<p>测试环境配置文件<br/>
application-test.properties 可如下设置：</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">server.port</span>=<span class="hljs-number">8081</span>
<span class="hljs-attr">spring.datasource.url</span>=jdbc:mysql://localhost:<span class="hljs-number">3306</span>/testdb
<span class="hljs-attr">spring.datasource.username</span>=testuser
<span class="hljs-attr">spring.datasource.password</span>=testpassword
</code></pre>
<p>生产环境配置文件<br/>
application-prod.properties 则可设置为：</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">server.port</span>=<span class="hljs-number">80</span>
<span class="hljs-attr">spring.datasource.url</span>=jdbc:mysql://prod-db:<span class="hljs-number">3306</span>/proddb
<span class="hljs-attr">spring.datasource.username</span>=produser
<span class="hljs-attr">spring.datasource.password</span>=prodpassword
</code></pre>
<p><strong>（二）YAML 配置方式</strong></p>
<p><strong>单文件配置</strong>：只有 YAML 支持用 “---” 分隔的语法。在 application.yml 文件中，可以通过多个文档块来定义不同环境的配置。每个文档块中，通过 spring.profiles 属性来指定当前文档块对应的环境。示例如下：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># 默认配置</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://default-db:3306/defaultdb</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">defaultuser</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">defaultpassword</span>

<span class="hljs-meta">---</span>
<span class="hljs-comment"># dev环境配置</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">profiles:</span> <span class="hljs-string">dev</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/devdb</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">devuser</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">devpassword</span>

<span class="hljs-meta">---</span>
<span class="hljs-comment"># test环境配置</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">profiles:</span> <span class="hljs-string">test</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8081</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/testdb</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">testuser</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">testpassword</span>

<span class="hljs-meta">---</span>
<span class="hljs-comment"># prod环境配置</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">profiles:</span> <span class="hljs-string">prod</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">80</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://prod-db:3306/proddb</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">produser</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">prodpassword</span>
</code></pre>
<p><strong>多文件配置</strong>：文件命名遵循 application-{profile}.yml 的格式，其中 {profile} 为环境标识。主配置文件 application.yml 中，通常可指定默认激活的环境或包含一些公共配置。例如，主配置文件 application.yml：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">profiles:</span>
    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span> <span class="hljs-comment"># 默认激活开发环境，可按需修改</span>
</code></pre>
<p>开发环境配置文件 application-dev.yml：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/devdb</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">devuser</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">devpassword</span>
</code></pre>
<p>测试环境配置文件 application-test.yml 和生产环境配置文件 application-prod.yml 结构类似，替换相应配置值即可。</p>
<h2 data-id="heading-3">激活方式</h2>
<p><strong>（一）在配置文件中指定</strong></p>
<p>在 application.properties 或 application.yml 文件中，通过 spring.profiles.active 属性指定，如在 application.yml 中：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">profiles:</span>
    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span>
</code></pre>
<p><strong>（二）通过命令行参数指定</strong></p>
<p>启动应用程序时，使用命令行参数–spring.profiles.active 来指定激活的环境。例如，要启动生产环境：</p>
<pre><code class="hljs language-ini" lang="ini">java -jar myapp.jar <span class="hljs-attr">--spring.profiles.active</span>=prod
</code></pre>
<p><strong>（三）通过环境变量指定</strong></p>
<p>设置环境变量 SPRING_PROFILES_ACTIVE 来指定激活的环境。在 Linux 或 Mac 系统中：</p>
<pre><code class="hljs language-ini" lang="ini">export <span class="hljs-attr">SPRING_PROFILES_ACTIVE</span>=prod
java -jar myapp.jar
</code></pre>
<p>在 Windows 系统中：</p>
<pre><code class="hljs language-ini" lang="ini">set <span class="hljs-attr">SPRING_PROFILES_ACTIVE</span>=prod
java -jar myapp.jar
</code></pre>
<p><strong>（四）在 IDE 中指定</strong></p>
<p>使用 IntelliJ IDEA 或 Eclipse 等 IDE 运行应用程序时，可在运行配置中指定激活的环境。以 IntelliJ IDEA 为例，在 “Run Configurations” 中，找到 “VM options” 或 “Program arguments”，添加 “–spring.profiles.active=dev”（这里以开发环境为例）。</p>
<h2 data-id="heading-4">打包</h2>
<p>使用 Maven 或 Gradle 等构建工具打包 Spring Boot 应用程序时，配置文件通常会自动包含在生成的 JAR 或 WAR 包中。若要为不同环境打包不同的配置文件，可利用 Maven 的 profiles 功能或 Gradle 的构建变体（build variants）。</p>
<p>以 Maven 为例，在 pom.xml 文件中定义不同的 profiles，并在每个 profile 中指定要包含的配置文件。在主配置文件 application.yml 中，使用占位符来指定当前激活的环境，如：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://${profiles.active}-db:3306/${profiles.active}db</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">${profiles.active}user</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">${profiles.active}password</span>
</code></pre>
<p>在 pom.xml 中配置多个环境：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">profiles</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">profile</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>dev<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">activation</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">activeByDefault</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">activeByDefault</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">activation</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">profiles.active</span>&gt;</span>dev<span class="hljs-tag">&lt;/<span class="hljs-name">profiles.active</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">profile</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">profile</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">profiles.active</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">profiles.active</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">profile</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">profile</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>prod<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">profiles.active</span>&gt;</span>prod<span class="hljs-tag">&lt;/<span class="hljs-name">profiles.active</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">profile</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">profiles</span>&gt;</span>
</code></pre>
<p>为使 Maven 在打包时能替换主配置文件中的占位符，需在 pom.xml 中配置资源过滤：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
</code></pre>
<p>之后，使用 Maven 打包命令生成不同环境的构建产物。生成开发环境构建产物：</p>
<pre><code class="hljs language-go" lang="go">mvn clean <span class="hljs-keyword">package</span>
</code></pre>
<p>生成测试环境构建产物：</p>
<pre><code class="hljs language-bash" lang="bash">mvn clean package -P <span class="hljs-built_in">test</span>
</code></pre>
<p>生成生产环境构建产物：</p>
<pre><code class="hljs language-css" lang="css">mvn clean package -<span class="hljs-selector-tag">P</span> prod
</code></pre>
<h2 data-id="heading-5">最佳实践</h2>
<p><strong>避免硬编码</strong>：尽量不在代码中硬编码环境特定的值，而应使用配置属性和 Profile 来管理这些值。这样当环境变化时，无需修改代码，直接调整配置文件即可。</p>
<p><strong>精简 Profile 数量</strong>：虽然 Spring Boot 支持同时激活多个 Profiles，但为保持配置简洁，建议精简 Profile 的数量和复杂度。过多的 Profile 可能导致配置混乱，难以维护。</p>
<p><strong>使用 Profile-specific 配置文件</strong>：对于环境特定的配置，使用 Profile-specific 的配置文件（如 application-dev.yml），便于管理和维护。将不同环境的配置分开，清晰明了，减少出错概率。</p>
<p><strong>管理敏感信息</strong>：在生产环境中，配置文件可能包含敏感信息（如数据库密码、API 密钥等）。可使用环境变量存储敏感信息，然后在配置文件中引用；或使用 Spring Cloud Config 集中管理配置信息，并通过加密等方式保护敏感信息。</p>
<p><strong>配置文件的命名和组织</strong>：通用配置使用 application.yml 文件；不同环境配置使用 application-{profile}.yml 文件；若有多个模块或功能的配置，可创建相应的配置文件，如 module1-{profile}.yml、module2-{profile}.yml ，这样可以让配置文件的结构更加清晰，易于查找和维护。</p>
<p>Spring Boot 3 中的 Profiles 为我们提供了强大且灵活的多环境配置管理方式。通过合理运用 Profiles，能够显著提升配置的灵活性和应用的可维护性，让应用的开发、测试和部署更加高效、可控。随着 Spring Boot 3 的持续发展，利用 Profiles 优化应用配置依然是实现高质量微服务架构的关键策略之一，希望本文能帮助各位开发者更好地掌握和运用这一强大功能，在软件开发的道路上更加得心应手。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[js实现页面全屏展示]]></title>    <link>https://juejin.cn/post/7582156410319503370</link>    <guid>https://juejin.cn/post/7582156410319503370</guid>    <pubDate>2025-12-11T05:24:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582156410319503370" data-draft-id="7582110969201246246" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="js实现页面全屏展示"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-11T05:24:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="小明记账簿_微信小程序"/> <meta itemprop="url" content="https://juejin.cn/user/1901536389893546"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            js实现页面全屏展示
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1901536389893546/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    小明记账簿_微信小程序
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:24:29.000Z" title="Thu Dec 11 2025 05:24:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#36ace1;background-image:linear-gradient(90deg,rgba(217,234,251,.25) 3%,transparent 0),linear-gradient(1turn,rgba(217,234,251,.25) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{color:#36ace1}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"";display:block;position:absolute;left:0;top:0;bottom:0;margin:auto;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAF8UlEQVRIS71Wa2wUVRT+7r0zu9t2t/RBaSioPCpYbIUfaEIQUogSAwZDAlUSGwgg/CBATExMCJH1D2hIfOEjFEUEhViCgBgIUCH44OkjPAMGBVqhpUCfW3Zn5z7MuQOE0hYxMdxJdmd25s53vnO+851leMCLPWA8/CfA2TsvL8n7q+nTFfNLG+4VqInHOeJLDQMzdz/3r4DGGDb9lxu+aPcE7U61JHDMDePcuv0O21ShugOefqDdtBie3Dk6K/O+Ab+qOjJiz7Ahv6c8hbDDwRiQlgYGDOcaWyEcjg8On+j71IpJndjGt9XO+jM7+pkywNvbazIfercieSdoJ4bE5sWjyZqMpDdeaQNXMNC34ME3LV8B56+1w3AOgk+EXe/Ub6uiLB6XdH/G/mYjeBCcFwnt3zQqWt4t4NjjnhzQ1CGkBhwOCMFAB71U0qsYgRlwBtQ1tiEJAy44OBdQUmFK3aWS06NLT+ukZAQoKCCjsfbDmk6p78RwX3ncWffmIj8U4kh6GpEwh+9rGy23LDU4GBrrm9DsuDYIGMAYIC/EUNQ7Cq1hn+WM2TI8f+jEyCmvjfn1FssuojHx6tDkyZOaCzr8TNpASzDAk8amlRIrEylcSGsYrcGIstIYWhgDDIM2BiGH3ywFkGAC1U9n38bpVqWGdk6r4HMWrZZaG1D5KLn0qYyBEAKnG1otAxLR8L7Z9nfP13CJHQ/ST4vK8sVHe8JsU0U6uO5hlexo8PI7vNDQomwoBRAwpSmtgJAAztS3QLsOsmBQlBtFJMQhlbbPUBBUR7o2hqHVddLbRsfCPQJ+u3TPw8uGl1yklAlHIJZKo3//XEhlLCtifPFyM7xwCI/lZ8IKTTBbS7pPLIggZZsSQ+zXbT4UYSsnet3UMM5HPT5LGbrDGYQroClyT2Jwnyj9aN949e8mDCwuRFoqKxRHUJ21BSDRELuQYGhvbMVV32Dp2RuxcfHSRBfAYTsbU9nJdFj5EiLkglHkRInC1xoxKbH9hQJIaTDvxxTCUddWl4wg0dCCtqSPDmoVx4Eitpxh64ZtsT6b5ie6pPRkfF90TllxOzEwmipMKRRgHODGgCuJkqIcvDdC2BZ5Y+tlHHMzkAKghbAxcQqQDiKrFBxhqg5MHTivS1tQ+sdsvaQl5Yd6yfdRXNQLsQwXnq/AQFLXEIIjzBSuNaaR0SuEtkQKl9IKjAsbJaWfzo1USDsM6zceDJfeVGgnhhN2N7YOyo5kJz1pa2AbgfrO1gRwXW6vSRQNtddR+EhvKGmseskgTtY2Q7kucYWWgToPHzyUyXry0iXfnBtfl5f/PaWPvPNW/zkOAQegJHltFE5dSaCskHqPVEnqpMAMEgkPtR1pKxyh/N0/vTToubtH1G3RmLjhM8ubKXfWB2mRa9ySOaWS2uT8lTZ0cI6I52Ngv7zAbW9mQVm1cpytu441P38XeXTlQu+e46nyh+bjLkMZRU0MCYTCJWZSG1y7cBWNURpxBlxqFBfEwGnGGhaYPSNwhpSv4DK+/vPynBk9MqRIiOWs8a2WJTm9a+cgh6SaMIMz9W1WjYHHMtv0wSmZdWB9gdsya/rcYVg7JoffCdqlD6ceTpiY59tM0PhJp5WNvra+BQkejCMyBarr8KKYDcZi8sDaCDKYFIGRk+FnSVXzyTO9JxBwF8DLc1dlLn65ooNEYN0fBsu21fTvL6PXnhxXlnLIqqhYYBian4lQ2Lk9ogiALsimiLC1QYfhlV1Hnxh7JfcMqxrpd7U2GFa5t9nOd7Kr+kg4uWvnCpromlJeXlq3Os3ZLOlrZBmNQf1ybVqpxhbA7mRIOCy1+esDOWhIyDv/+3Q7LRbsqH+rKRJ+nba+/+WW7II1s9vvVBuNr7KNF1WUM1bSt5f1Vq01jUVkKfnx8uoti3Or5rbd9782M61azJz/rFywYU/OyKqK1p5G2MS1Z18tGFDwTkvIxcK9RwaMP3a9/tbc62lPj/Nw5B9ey9Ehy/MY4oEqelgNleuyCgdXJlmc3fO5Ll56r5f+n/f+AWFf9jvBgaHpAAAAAElFTkSuQmCC);animation:spin 2s linear 1s infinite}.markdown-body h1{position:relative;font-size:30px;padding:12px 38px;margin:30px 0}.markdown-body h1:before{width:30px;height:30px;background-size:30px 30px}.markdown-body h2{position:relative;font-size:24px;padding:12px 36px;margin:28px 0}.markdown-body h2:before{width:28px;height:28px;background-size:28px 28px}.markdown-body h3{position:relative;font-size:18px;padding:4px 32px;margin:26px 0}.markdown-body h3:before{width:24px;height:24px;background-size:24px 24px}.markdown-body h4{position:relative;padding:4px 28px;font-size:16px;margin:22px 0}.markdown-body h4:before{width:20px;height:20px;background-size:20px 20px}.markdown-body h5{position:relative;padding:4px 26px;font-size:15px;margin:20px 0}.markdown-body h5:before{width:18px;height:18px;background-size:18px 18px}.markdown-body h6{position:relative;padding:4px 22px;font-size:14px;margin:16px 0}.markdown-body h6:before{width:16px;height:16px;background-size:16px 16px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#36ace1,#dff0fe,#36ace1);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:50px;height:24px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAEgElEQVRIS72Va0xbZRjH/z2FcimbchEQFDYRCIRAAWFQ2MaCXBwmUxYDLGGEcRFkH9wmk04zG0Bo2dwNIisERANqhjqdEmhd4nRbuwpsXDYWLLoRgeG4Chu9QHvMOQ0dpTAKH3y/tDnv8/5/z/Oc//scBv6nxdgoJ14gVYPEuITHdTdHY12gRIH0T0KljlqwthqUFHGtzAEsxqwLtPvkdc+FeeI3BgMeAMEhdOqR1mM7xswBrgmKE8pfIUhtm7fbZsft/i7wc98MtrUFxmbU6ByYgFwxjtFp5Q+WpF1mCy9wajXoqqD4E91saOf603e+5B7t99xTkyZJEiKJAl2DE9Xio1HvrBS8IuhVwVUP503swdJ9QWAw1izaoDs6pQT/655BMS9yy3KYiUoM/7adu7NmtnQfx5zWm8Q8Ui3gyGcddyU8rv/STRNQouDGP5/mhTubX4dpPv3DMzh1qS9LwuPWr+i63WVyn5QYj/4d/i4bqmbpoQ+auvBlQYghX6PE4wTSOzV5EUYlb5Q4MDqLk9/3cMRF27spDSNQamUnWZ4ebNB+OKNCyYVeFCZ5wZ5tiePN/UiP2YoQL0cUX+iFt4sNUiLdcaVvHJLecQiWnKVE8s5LvxAXRWeYgHLre0hecgAN0sxr0XBZgbJUP6OiLnaM4ivZCBrzOWBZEIY9rY5E8pl2nM0KMzzLq5aPiXmRzgbQm2VyR8KGGK/ICAFB6IusbvsDwhRf+n/jtSHc/nsGgjR9V6/1TyLa1wGU+FtnO1CbHQTHTSzIFJOYJ1jwcGLTccMTcyhp7oW4KFJ/SV4/IScrc55kQj07WNuOn94Lpw8kCm/Qv3W5HLjbWxsyfuNUO1TzWjAJBloKt2FBS+Jz6ShiA12NupBdLWugQcmn28lPMkONNql3U5cTSD9Lq+qEUqPFt++G0aKL687wDAqb+pAU7IKCuK2493AOPQ9UCNpib6T1tkg+RZ9KKJcNn8sJc1vac8o16jklLWLuOiDqwvHUIKPw7vtTON+iCDKkl/Cx9FeSYET5um1mHt6jN0Dz9ftwYjORudNjTdaBmi7kxvvA1d6Gjs0X/Q5Sp3tMEMSHre9HnDEZAPFCWUNVdliGJVPvqEP1Hbh4yPj9LadSY6fu6gPsCX+B3mq7NYLv2od8fj4aoViMNQGFijos/XVMTXGavgUisQIle71hwVx9KFEutLVjw8GORTuxoEbeJS7iPrmQyy/sIj2hQpqYHO7ZGs95nnZS4y8K8Pfqrb58UZ+IlKqbqNgfQm8da+pC9xjLqo8foFkau2qaCeXSyvzXfA9SDrp1bxJ/DU/jSJKXEWdBR2J/9U0UpwXTFZ/+8S76h/71FvO4A8sTeuqQThDKalOiPLN3BbhiYlaNsm964elkCztrC4xMqeDqYIus2JdB3cbS5l4MTag44qJt9GxbF4gKThRKY59lW13+KCUQ1pZMEwHKviKx4pFSqXzxCn/X9Gr2NO+zw+cTiTbxmUyCqH3GlsWg2kRNhOnHmhlrFkIvHTZt1borWvMCmRnwH4usn58STiycAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body del{color:#36ace1}.markdown-body code{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#282c34;color:#4ec9b0;padding:.24em .46em;margin:0 4px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-family:Menlo,Monaco,Consolas,Courier New,monospace;font-size:12px;border-radius:10px;padding:15px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#4ec9b0;background:#282c34}.markdown-body a{text-decoration:none;color:#409eff;border-bottom:1px solid #409eff}.markdown-body a:active,.markdown-body a:hover{color:#007bff;border-bottom:1px solid #007bff}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{position:relative;padding:8px 26px;background-color:rgba(54,172,225,.75);margin:16px 0;border-left:4px solid #409eff;border-radius:5px}.markdown-body blockquote:before{content:"❝";top:10px;left:8px;color:#409eff;font-size:20px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"❞";font-size:20px;position:absolute;right:8px;bottom:0;color:#409eff;opacity:.7}.markdown-body blockquote&gt;p{color:#fff}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>最近做一个网页项目，用户要求可以全屏展示，进入系统后隐藏地址栏，于是乎，经过调研就选择了全屏<code>API</code>，即便如此还是遇到了一些问题，总结一下，写下此篇文章，以免以后再遇到相同的问题。</p>
</blockquote>
<p>在JavaScript中，实现页面全屏展示主要依赖于HTML5的Fullscreen API，这是一个相对较新的技术，因此在旧版本的浏览器上可能不受支持，现代浏览器支出如下。</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0147412e26fb49b4aedaa6695523568b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5piO6K6w6LSm57C_X-W-ruS_oeWwj-eoi-W6jw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035469&amp;x-signature=DClrkrCIeCYdCMgWyQV8pzmdle8%3D" width="100%" loading="lazy"/>
<h3 data-id="heading-0">检查浏览器是否支持Fullscreen API</h3>
<p>在尝试使用Fullscreen API之前，最好先检查浏览器是否支持它。虽然现代浏览器普遍支持，但检查总是好的做法。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">fullscreenEnabled</span> ||
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">mozFullScreenEnabled</span> ||
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">webkitFullscreenEnabled</span> ||
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">msFullscreenEnabled</span>) {
    <span class="hljs-comment">// 支持全屏</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// 不支持全屏</span>
}
</code></pre>
<h3 data-id="heading-1">全屏模式</h3>
<p>获取<code>Element</code>节点，然后使用<code>requestFullscreen</code>方法，可以使得这个节点全屏，全屏模式的具体实现可能因浏览器而异，所以要做不同浏览器处理。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">openFullScreen</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> full = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'fullscreen'</span>)
  <span class="hljs-keyword">if</span> (full.<span class="hljs-property">RequestFullScreen</span>) {
    full.<span class="hljs-title class_">RequestFullScreen</span>()
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (full.<span class="hljs-property">mozRequestFullScreen</span>) {
    full.<span class="hljs-title function_">mozRequestFullScreen</span>()
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (full.<span class="hljs-property">webkitRequestFullScreen</span>) {
    full.<span class="hljs-title function_">webkitRequestFullScreen</span>()
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (full.<span class="hljs-property">msRequestFullscreen</span>) {
    full.<span class="hljs-title function_">msRequestFullscreen</span>()
  }
}
</code></pre>
<h3 data-id="heading-2">退出全屏模式</h3>
<p>退出全屏模式可以通过调用<code>document.exitFullscreen()</code>方法实现。这个方法会尝试让当前处于全屏模式的元素退出全屏。用户手动按下<code>ESC</code>键，也可以退出全屏键。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">exitFullScreen</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">exitFullScreen</span>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">exitFullScreen</span>();
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">mozCancelFullScreen</span>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">mozCancelFullScreen</span>();
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">webkitExitFullscreen</span>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">webkitExitFullscreen</span>();
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">msExitFullscreen</span>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">msExitFullscreen</span>();
  }
}
</code></pre>
<h3 data-id="heading-3">获取全屏元素</h3>
<p><code>document.fullscreenElement</code>属性返回正处于全屏状态的<code>Element</code>节点，如果当前没有节点处于全屏状态，则返回null。可以通过此方法判断是否在全屏状态。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> fullscreenElement =
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">fullscreenElement</span> ||
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">mozFullScreenElement</span> ||
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">webkitFullscreenElement</span>;
</code></pre>
<h3 data-id="heading-4">注意事项</h3>
<p>💥 想要全屏的元素都应该在这个<code>Element</code>节点下面，否则的话全屏时不会展示。如下图的html结构，点击<code>单开弹框</code>依然无法在全屏模式下看到弹窗，推出全屏时会看到弹窗已经出现。如果想避免这种莫名的问题，可以把<code>document.getElementById('fullscreen')</code> 改成<code>document.documentElement</code>，让整个<code>HTML</code>全屏。</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5007e702877469ab97c9bcdcfaf8668~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5piO6K6w6LSm57C_X-W-ruS_oeWwj-eoi-W6jw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035469&amp;x-signature=CVI2REEOc7%2FaBL%2Fc90h8MQK8Rmo%3D" width="100%" loading="lazy"/>
<p>💥 <code>requestFullscreen</code>方法只能是用户主动触发才可以，如果想在页面加载时通过<code>js</code>调用方法或者是触发<code>click</code>事件触发，我劝你还是放弃吧，在控制台出现如下警告：</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffcddf2389044911bcec8f75271fa9b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5piO6K6w6LSm57C_X-W-ruS_oeWwj-eoi-W6jw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035469&amp;x-signature=YIky1bWwRIJr34FDjeQW%2BpSYyEs%3D" width="100%" loading="lazy"/>
<p>💥 刷新页面也会自动退出全屏模式；</p>
<p>💥 如果想改变全屏状态时的样式，首先可以在全屏时添加一个<code>calss</code>，此外也可以使用<code>:full-screen</code>伪类，大部分浏览器都支持，检查全屏时元素，也是有使用<code>:full-screen</code>伪类的。</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ebd1b2242fe4170b0595ce06b12fe7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5piO6K6w6LSm57C_X-W-ruS_oeWwj-eoi-W6jw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766035469&amp;x-signature=Ga5Ej%2Fqi1iBjqFD2U7C1DG%2FVhiI%3D" width="100%" loading="lazy"/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[秒懂 Headless：为什么现在的软件都要“去头”？]]></title>    <link>https://juejin.cn/post/7582118218649288730</link>    <guid>https://juejin.cn/post/7582118218649288730</guid>    <pubDate>2025-12-11T05:39:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582118218649288730" data-draft-id="7582156410319536138" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="秒懂 Headless：为什么现在的软件都要“去头”？"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-11T05:39:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="皮蛋小精灵"/> <meta itemprop="url" content="https://juejin.cn/user/219558056559278"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            秒懂 Headless：为什么现在的软件都要“去头”？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/219558056559278/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    皮蛋小精灵
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:39:51.000Z" title="Thu Dec 11 2025 05:39:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>简单来说， <strong>“Headless”（无头）</strong> 在软件开发中指的是：<strong>只有逻辑（后端/内核），没有预设界面（前端/GUI）</strong> 的软件架构模式。</p>
<p>这里的“Head（头）”比喻的是<strong>用户界面（UI/GUI）</strong> ，“Body（身体）”比喻的是<strong>核心业务逻辑或引擎</strong>。</p>
<p><strong>Headless = 砍掉自带的 UI，只给你提供 API 或核心逻辑，让你自己去画界面。</strong></p>
<hr/>
<h3 data-id="heading-0">1. 核心概念图解</h3>
<p>想象一下 <strong>“传统的软件”</strong>（比如 Word）：它像一家<strong>堂食餐厅</strong>。你有厨房（逻辑），也有固定的桌椅板凳和装修风格（UI）。你必须在它提供的环境里吃饭，无法改变装修。</p>
<p>而 <strong>“Headless 软件”</strong>：它像一个<strong>中央厨房（外卖工厂）</strong>。它只负责做饭（逻辑），不提供桌椅（UI）。</p>
<ul>
<li>你想把菜送到五星级酒店摆盘（Web 端高级定制 UI）？可以。</li>
<li>你想把菜送到路边摊（手机 App）？可以。</li>
<li>你想把菜送到自动售货机（小程序）？也可以。</li>
</ul>
<hr/>
<h3 data-id="heading-1">2. 具体例子</h3>
<h4 data-id="heading-2">A. 无头浏览器 (Headless Browser)</h4>
<ul>
<li>
<p><strong>传统的浏览器（如 Chrome）：</strong> 你打开它，能看到窗口、地址栏、渲染出来的网页，你能用鼠标点击。</p>
</li>
<li>
<p><strong>无头浏览器（如 Puppeteer, Playwright）：</strong></p>
<ul>
<li>
<p><strong>定义：</strong> 它是浏览器内核（Chrome/Webkit），但<strong>没有可视化的窗口</strong>。它在后台（命令行/服务器）运行。</p>
</li>
<li>
<p><strong>怎么用？</strong> 你写代码控制它：“打开百度 -&gt; 输入关键词 -&gt; 截图”。</p>
</li>
<li>
<p><strong>有什么用？</strong></p>
<ol>
<li><strong>自动化测试：</strong> 模拟用户点击，快速跑通几千个测试用例，不需要真的弹出一千个窗口。</li>
<li><strong>爬虫：</strong> 爬取那些需要 JS 渲染的复杂网页。</li>
<li><strong>生成截图/PDF：</strong> 在服务器端把网页渲染成图片或 PDF 报告。</li>
</ol>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-3">B. 无头编辑器 (Headless Editor)</h4>
<ul>
<li>
<p><strong>传统的编辑器（如 CKEditor 旧版, Quill）：</strong></p>
<ul>
<li>你引入它，它就自带一套“加粗、斜体、插入图片”的工具栏，自带一套 CSS 样式。</li>
<li><strong>缺点：</strong> 如果设计师说“把工具栏按钮变成圆形的，而且要悬浮在文字上方”，你就要疯狂覆盖它的默认 CSS，非常痛苦。</li>
</ul>
</li>
<li>
<p><strong>无头编辑器（如 Tiptap, Plate, Slate.js）：</strong></p>
<ul>
<li><strong>定义：</strong> 它只提供<strong>文字处理的核心逻辑</strong>（比如：选中文本、按下 Ctrl+B 变粗体、撤销重做逻辑）。它<strong>不提供任何 UI</strong>（没有工具栏，没有按钮）。</li>
<li><strong>怎么用？</strong> 你需要自己写一个 <code>&lt;button&gt;</code>，自己写样式，然后调用它的 API <code>editor.toggleBold()</code>。</li>
<li><strong>有什么用？</strong> 你可以完全自由地定制编辑器的长相。比如 Notion、飞书文档那种高度定制的 UI，必须用无头编辑器开发。</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-4">3. 还有哪些常见的 Headless？</h3>
<p>除了浏览器和编辑器，现在的开发趋势中还有：</p>
<h4 data-id="heading-5">C. 无头组件库 (Headless UI)</h4>
<ul>
<li><strong>例子：</strong> Radix UI, Headless UI, React Aria。</li>
<li><strong>解释：</strong> 以前我们用 Ant Design 或 Bootstrap，按钮长什么样是库定好的。Headless UI 库只提供<strong>交互逻辑</strong>（比如下拉菜单怎么打开，键盘怎么选，无障碍怎么读），<strong>不提供任何 CSS</strong>。</li>
<li><strong>好处：</strong> 完美配合 Tailwind CSS，长相由你完全控制。</li>
</ul>
<h4 data-id="heading-6">D. 无头 CMS (Headless CMS)</h4>
<ul>
<li><strong>例子：</strong> Strapi, Contentful。</li>
<li><strong>解释：</strong> 以前用 WordPress，后台管理内容，前台页面也是 WordPress 生成的（耦合）。Headless CMS 只提供<strong>后台管理</strong>和 <strong>API</strong>。</li>
<li><strong>好处：</strong> 你的一份内容（API）可以同时发给 网站、App、智能手表、甚至冰箱屏幕。</li>
</ul>
<hr/>
<h3 data-id="heading-7">总结：为什么现在流行 Headless？</h3>
<p>虽然 Headless 意味着开发者要写更多的代码（因为要自己画 UI），但它解决了现代开发最大的痛点：<strong>定制化</strong>。</p>






























<table><thead><tr><th><strong>维度</strong></th><th><strong>传统 (Coupled)</strong></th><th><strong>Headless (无头)</strong></th></tr></thead><tbody><tr><td><strong>上手难度</strong></td><td><strong>低</strong> (开箱即用)</td><td><strong>高</strong> (需要自己写 UI)</td></tr><tr><td><strong>自由度</strong></td><td><strong>低</strong> (改样式很难)</td><td><strong>极高</strong> (随心所欲)</td></tr><tr><td><strong>适用场景</strong></td><td>快速做个标准后台</td><td>像 Notion/Figma 这种需要极致体验的产品</td></tr><tr><td><strong>比喻</strong></td><td><strong>方便面</strong> (有面有调料包，味道固定)</td><td><strong>生鲜面条</strong> (只有面，想做炸酱面还是汤面随你)</td></tr></tbody></table>
<p><strong>一句话总结：Headless 就是把“业务逻辑”和“界面表现”彻底分家，让你拥有无限的 UI 定制权。</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linux读写苹果APFS系统文件]]></title>    <link>https://juejin.cn/post/7582110969201213478</link>    <guid>https://juejin.cn/post/7582110969201213478</guid>    <pubDate>2025-12-11T05:19:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582110969201213478" data-draft-id="7582149417768648754" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linux读写苹果APFS系统文件"/> <meta itemprop="keywords" content="操作系统"/> <meta itemprop="datePublished" content="2025-12-11T05:19:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="空x格"/> <meta itemprop="url" content="https://juejin.cn/user/8451823512701"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linux读写苹果APFS系统文件
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/8451823512701/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    空x格
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:19:39.000Z" title="Thu Dec 11 2025 05:19:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">背景</h2>
<p>我是一个黑苹果折腾人员，目前使用的黑苹果机器配置如下图所示的这样，因为经常开会或者外出，而WiFi又是镁光的无线网卡走到那里都不方便连接网络。所以在这个电脑上安装了深度系统。</p>
<p>现在需要在深度系统上读写我的Mac文件，我使用 <code>apt list | grep apfs</code>找了一下没有发现相关的软件可以支持，就在github上找到了这个<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flinux-apfs%2Flinux-apfs-rw.git" target="_blank" title="https://github.com/linux-apfs/linux-apfs-rw.git" ref="nofollow noopener noreferrer">APFS-RW项目</a>。
<img src="https://storage.deepin.org/thread/202512040433297675_image.png" alt="image.png" loading="lazy"/></p>
<p>当我在安装的时候发现，深度系统强制开启了内核模块签名功能，现在附上这个安装方法，希望官方能够添加到这个系统里面。</p>
<ul>
<li>先安装git用来克隆源码</li>
</ul>
<pre><code class="hljs">sudo apt install -y git
</code></pre>
<ul>
<li>确定好源码最新版本，比如现在的是0.3.17，然后克隆它</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/linux-apfs/linux-apfs-rw.git /usr/src/apfs-0.3.17
</code></pre>
<ul>
<li>开始编译安装</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">root@xxxx-PC:/usr/src<span class="hljs-comment"># dkms build -m apfs -v 0.3.17</span>

Sign <span class="hljs-built_in">command</span>: /lib/modules/6.12.43-amd64-desktop-rolling/build/scripts/sign-file
Signing key: /var/lib/dkms/mok.key
Public certificate (MOK): /var/lib/dkms/mok.pub
Creating symlink /var/lib/dkms/apfs/0.3.17/source -&gt; /usr/src/apfs-0.3.17

Running the pre_build script:

Cleaning build area... <span class="hljs-keyword">done</span>.
Building module(s)........ <span class="hljs-keyword">done</span>.
Signing module /var/lib/dkms/apfs/0.3.17/build/apfs.ko
Cleaning build area... <span class="hljs-keyword">done</span>.
</code></pre>
<ul>
<li>执行安装</li>
</ul>
<pre><code class="hljs language-ruby" lang="ruby">root<span class="hljs-variable">@xxxx</span>-<span class="hljs-variable constant_">PC</span><span class="hljs-symbol">:/usr/src/apfs-</span><span class="hljs-number">0.3</span>.<span class="hljs-number">17</span><span class="hljs-comment"># dkms install -m apfs -v 0.3.17</span>

<span class="hljs-title class_">An</span> original <span class="hljs-keyword">module</span> was already stored during a previous install
<span class="hljs-title class_">Installing</span> /lib/modules/<span class="hljs-number">6.12</span>.<span class="hljs-number">43</span>-amd64-desktop-rolling/extra/apfs.ko
<span class="hljs-title class_">Running</span> depmod.... done.
</code></pre>
<ul>
<li>添加开机加载模块</li>
</ul>
<pre><code class="hljs language-ruby" lang="ruby">root<span class="hljs-variable">@xxxx</span>-<span class="hljs-variable constant_">PC</span><span class="hljs-symbol">:/usr/src/apfs-</span><span class="hljs-number">0.3</span>.<span class="hljs-number">17</span><span class="hljs-comment"># cat /etc/modules-load.d/apfs.conf </span>
apfs
</code></pre>
<ul>
<li>设置文件系统开机挂载</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">sudo apfs-label  /dev/nvme0n1p2 <span class="hljs-comment">#找到APFS磁盘分区设备，找到Data的分区号</span>
0       MacOS
1       Preboot
2       Recovery
3       VM
4       MacOS - Data
5       Update

<span class="hljs-comment">#创建挂载目录</span>
<span class="hljs-built_in">mkdir</span> /media/apfs

<span class="hljs-comment">#这里的uid、git是你的用户标识，如果不添加默认是0,0。普通用户不能读写</span>
<span class="hljs-built_in">cat</span> &lt;&lt;<span class="hljs-string">"EOF"</span> &gt;&gt; /etc/fstab 
<span class="hljs-comment"># For MacOS Data</span>
/dev/nvme0n1p2  /media/apfs     apfs cknodes,uid=1000,vol=4,gid=1000,readwrite 0 0
EOF
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[被 4.3 拒绝的那些上架，从机制误判到工程治理的完整分析]]></title>    <link>https://juejin.cn/post/7582152511538266153</link>    <guid>https://juejin.cn/post/7582152511538266153</guid>    <pubDate>2025-12-11T05:47:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582152511538266153" data-draft-id="7582163781183733766" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="被 4.3 拒绝的那些上架，从机制误判到工程治理的完整分析"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-11T05:47:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bcbnb"/> <meta itemprop="url" content="https://juejin.cn/user/895474073078377"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            被 4.3 拒绝的那些上架，从机制误判到工程治理的完整分析
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/895474073078377/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bcbnb
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:47:24.000Z" title="Thu Dec 11 2025 05:47:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>苹果审核条款 4.3（“重复应用 / 重复内容 / 模板化应用”）几乎是开发者最担心收到的拒绝理由之一。与技术错误不同，4.3 的判断带有策略性，苹果主要审查应用是否存在大量相似内容、使用重复模板、或明显属于批量生成的 APP。许多团队在跨端框架、内部产品多版本共存、或同一业务线多应用分发时，极易触发误判。</p>
<p>相比一般审核问题，4.3 的挑战在于：
– <strong>它不直接告诉你错在哪里；</strong>
– <strong>这是结构性问题，不是单次构建错误；</strong>
– <strong>即便版本更新，也可能持续被拒；</strong>
– <strong>某些情况下需要从 Bundle ID 到构建内容全面排查。</strong></p>
<p>本文基于实际工程经验，从审核机制、结构性触发原因、技术环节的自检方式三方面拆解 4.3，同时讨论如何借助适当的工具在提交前减少触发概率，并构建一个更透明的上架检查流程。</p>
<hr/>
<h2 data-id="heading-0"><strong>一、4.3 的本质：苹果在管理“系统风险”，不是单个应用</strong></h2>
<p>许多开发者把 4.3 视为“内容审查问题”，但它背后的逻辑其实非常工程化：</p>
<h3 data-id="heading-1"><strong>苹果希望避免：</strong></h3>
<ol>
<li>大量相似应用进入 App Store</li>
<li>企业用模板系统批量提交应用</li>
<li>用马甲包绕过审核策略</li>
<li>内容、功能、界面极其接近的应用充斥市场</li>
</ol>
<p>因此，4.3 的判断会综合多个维度：</p>
<ul>
<li>Bundle ID 历史行为</li>
<li>账号下过往应用的模式</li>
<li>UI 模板重复度</li>
<li>IPA 内资源结构</li>
<li>上架信息的相似性</li>
<li>提交频率与后台行为</li>
</ul>
<p>也就是说，4.3 拒绝通常不是随机，而是系统模型检测出的 <strong>“相似度超标”</strong>。</p>
<hr/>
<h2 data-id="heading-2"><strong>二、哪些工程结构最容易触发 4.3？</strong></h2>
<p>以下几类情况是我在多个项目中观察到的高危项：</p>
<h3 data-id="heading-3"><strong>1. 多个应用使用同一套 H5/uni-app 模板，仅内容替换</strong></h3>
<p>苹果容易认为属于批量生成。</p>
<h3 data-id="heading-4"><strong>2. 同一账号下存在大量相似界面、相同导航结构</strong></h3>
<p>尤其是工具类、展示类、资讯类。</p>
<h3 data-id="heading-5"><strong>3. Bundle ID 与 Profile 映射关系异常</strong></h3>
<p>例如同一个 profile 绑定多个应用，系统会推测存在批量行为。</p>
<h3 data-id="heading-6"><strong>4. IPA 内资源目录高度一致</strong></h3>
<p>如图片命名方式、打包结构完全一致。</p>
<h3 data-id="heading-7"><strong>5. 上架截图、关键词、描述重复度高</strong></h3>
<p>尤其是短期内连续提交。</p>
<p>这些都是 4.3 的“结构触发点”，而非前端开发可见的问题。</p>
<hr/>
<h2 data-id="heading-8"><strong>三、技术侧能做什么？——从 IPA 到元数据做自检</strong></h2>
<p>工程团队并不能完全避免 4.3，但可以通过工具和流程减少触发概率。</p>
<h3 data-id="heading-9"><strong>1. 检查 IPA 内部资源结构</strong></h3>
<p>通常我会在提交前使用工具查看 IPA 内部：</p>
<ul>
<li>Info.plist</li>
<li>资源目录结构</li>
<li>嵌入的 mobileprovision</li>
<li>Framework 特征</li>
</ul>
<p>例如通过 <strong>Appuploader 的 IPA 内容查看功能</strong> 查看 plist 和资源结构，帮助确认是否存在过多重复内容或错误绑定的 profile。</p>
<h3 data-id="heading-10"><strong>2. 检查 Bundle ID 使用情况</strong></h3>
<p>使用 Appuploader 的 <strong>Bundle ID 管理功能</strong> 可以快速查看：</p>
<ul>
<li>账号内哪些 Bundle ID 已存在</li>
<li>是否有相同前缀或明显模板化命名</li>
<li>该 Bundle ID 是否与旧应用高度相似</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1afd8fd894e64b929a4e2ad679a2e29b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYmNibmI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036844&amp;x-signature=KNhvjEJFhncM4gHpBaM%2BM41q7sQ%3D" alt="bid" loading="lazy"/></p>
<p>Bundle ID 体系混乱是常见触发因素。</p>
<h3 data-id="heading-11"><strong>3. 检查描述文件与证书关系</strong></h3>
<p>mobileprovision 内的信息可用于判断：</p>
<ul>
<li>是否绑定了正确证书</li>
<li>Team ID 是否使用一致</li>
<li>是否使用已废弃 profile</li>
</ul>
<p>这些信息同样可通过 Appuploader 解析 mobileprovision 得到。
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de7813dd61344bba8e9522b188040f7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYmNibmI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036844&amp;x-signature=LTQk1yl4Nfa3OqhCXtnSWP%2FUUuo%3D" alt="查看" loading="lazy"/></p>
<h3 data-id="heading-12"><strong>4. 上传方式保持一致性与可追踪性</strong></h3>
<p>使用 <strong>Appuploader CLI 上传 IPA</strong>（跨平台）可以让团队在流程中统一处理上传行为，避免：</p>
<ul>
<li>不同成员上传不一致 IPA</li>
<li>多台机器生成多个“几乎相同”的产物</li>
<li>多次重复提交导致系统误判批量行为</li>
</ul>
<p>统一的上传链路能让提交数据更可控。
图形化界面：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f09eb9f5cce4e8fb8534877636df66c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYmNibmI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766036844&amp;x-signature=lCwj1fCbsT8HhxiauErhanHQLHU%3D" alt="ipa上传" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-13"><strong>四、如何从工程治理角度降低 4.3 风险？</strong></h2>
<p>以下是我在项目中验证有效的策略，不涉及内容层面的建议，而关注工程侧可控的部分：</p>
<hr/>
<h3 data-id="heading-14"><strong>策略 1：避免模板工程直接复制，多项目使用差异化配置</strong></h3>
<p>包括：</p>
<ul>
<li>不同 Scheme</li>
<li>不同资源命名</li>
<li>不同页面结构</li>
<li>不同启动页</li>
<li>不同 WebView 配置</li>
</ul>
<p>系统模型主要看结构相似度，这部分越明显越容易触发 4.3。</p>
<hr/>
<h3 data-id="heading-15"><strong>策略 2：Bundle ID 管理规范化</strong></h3>
<p>要求：</p>
<ul>
<li>避免连续生成密集、相似的 Bundle ID</li>
<li>统一记录 Bundle ID 与业务关系</li>
<li>使用工具统一检查（如 Appuploader 的列表查看）</li>
</ul>
<p>Bundle ID 是系统判断“是否为同类模板”的入口，结构越清晰越不易误判。</p>
<hr/>
<h3 data-id="heading-16"><strong>策略 3：构建前检查 IPA 是否包含旧资源</strong></h3>
<p>许多 4.3 来自混入旧工程资源，包括：</p>
<ul>
<li>未更新的 icon</li>
<li>旧的引导页</li>
<li>不相关的 H5 资源</li>
</ul>
<p>我会通过 IPA 内容检查确认资源是否与工程一致。</p>
<hr/>
<h3 data-id="heading-17"><strong>策略 4：上传流程集中控制，避免短期多次提交</strong></h3>
<p>如果多个成员在不同平台提交多个版本，系统可能判定为批量应用。</p>
<p>统一使用 Appuploader CLI 上传的好处是：</p>
<ul>
<li>上传链路一致</li>
<li>日志可追踪</li>
<li>上传动作可脚本化</li>
<li>避免“重复上传 IPA 造成高频提交”现象</li>
</ul>
<p>这对减少 4.3 的系统误判非常关键。</p>
<hr/>
<h3 data-id="heading-18"><strong>策略 5：避免多个应用共享同一内部签名链路</strong></h3>
<p>如果 mobileprovision 或证书绑定多个应用，系统可能认为属于批量生成。</p>
<p>在提交前解析 mobileprovision（Appuploader 可查看）可以确认是否存在绑定混乱现象。</p>
<hr/>
<h2 data-id="heading-19"><strong>五、当应用被 4.3 拒绝后，工程侧可以做什么？</strong></h2>
<p>尽管最终解释权在苹果，但以下工程策略能提高重新提交成功率：</p>
<ol>
<li><strong>重新构建 IPA</strong>，确认资源、plist、描述文件均正确</li>
<li><strong>更换 Bundle ID（在允许范围内）</strong></li>
<li><strong>对资源结构做差异化调整</strong></li>
<li><strong>重新生成描述文件，使绑定关系更清晰</strong></li>
<li><strong>确保上传动作统一执行（避免多份构建提交）</strong></li>
</ol>
<p>工程团队所能做的，是从结构上降低模型的相似度评估。</p>
<hr/>
<h2 data-id="heading-20"><strong>4.3 不是技术问题，但技术可减少被误判的概率</strong></h2>
<p>条款 4.3 的核心在于 “结构性重复”。
许多团队并没有做错任何功能，却因资源结构、Bundle ID 体系、提交行为模式等工程因素触发审核。</p>
<p>而通过工具辅助，团队可以让整个流程更加透明、可控，也能在提交前发现潜在的结构性风险。</p>
<p>最终目标不是对抗审核，而是建立一个干净、可追踪、差异化明显的工程体系，避免被 4.3 系统模型误伤。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[构建现代化 iOS 调试体系，从代码行为到系统级诊断的多工具协同方法论]]></title>    <link>https://juejin.cn/post/7582155513586171956</link>    <guid>https://juejin.cn/post/7582155513586171956</guid>    <pubDate>2025-12-11T05:55:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582155513586171956" data-draft-id="7582131164728950824" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="构建现代化 iOS 调试体系，从代码行为到系统级诊断的多工具协同方法论"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-11T05:55:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="疯狂的程序猴"/> <meta itemprop="url" content="https://juejin.cn/user/2760245749234147"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            构建现代化 iOS 调试体系，从代码行为到系统级诊断的多工具协同方法论
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2760245749234147/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    疯狂的程序猴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T05:55:35.000Z" title="Thu Dec 11 2025 05:55:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在 iOS 开发的整个工程链路中，<strong>调试（Debugging）</strong> 是最体现开发者功力的部分。随着 App 体量变大、跨端框架增多（Flutter、uni-app、RN、Hybrid）、系统限制不断强化，调试已经不再是“看日志 + 打断点”能解决的问题。</p>
<p>实际调试过程中，开发者需要处理的问题往往跨越多个维度：</p>
<ul>
<li>代码逻辑错误（传统 Bug）</li>
<li>UI 渲染异常</li>
<li>内存泄漏 / 内存增长</li>
<li>CPU 峰值导致卡顿</li>
<li>WebView 行为不确定</li>
<li>线程切换与锁竞争</li>
<li>网络链路异常</li>
<li>系统行为导致的终止（watchdog / jetsam）</li>
<li>固件、权限、沙盒限制行为</li>
</ul>
<p>要解决这些问题，必须将 <strong>“代码层调试 + 性能调试 + 系统行为调试 + 真机调试”</strong> 统一起来，这也是现代 iOS 调试体系的核心。</p>
<p>本文基于真实工程经验，将 <strong>LLDB、Xcode、Instruments、PerfDog、克魔（KeyMob）、Charles、Safari Inspector、DeviceConsole、MetricKit、Crashlytics</strong> 整合成一套完整的可落地的 iOS 调试方法论。</p>
<hr/>
<h2 data-id="heading-0">一、调试体系为何必须“多工具协同”？</h2>
<p>因为 iOS 的问题源头本身就分布于多个层级：</p>
<h3 data-id="heading-1"><strong>1. 代码层问题（逻辑错误）</strong></h3>
<ul>
<li>变量状态不符合预期</li>
<li>分支漏判</li>
<li>Delegate 未回调</li>
<li>异常被吞掉</li>
</ul>
<h3 data-id="heading-2"><strong>2. 线程与锁问题</strong></h3>
<ul>
<li>死锁</li>
<li>主线程阻塞</li>
<li>竞争条件（race condition）</li>
</ul>
<h3 data-id="heading-3"><strong>3. 性能相关问题</strong></h3>
<ul>
<li>CPU 阻塞</li>
<li>GPU 渲染超时</li>
<li>内存泄漏</li>
<li>WebView 占用膨胀</li>
</ul>
<h3 data-id="heading-4"><strong>4. 系统行为</strong></h3>
<ul>
<li>内存压力下被系统强制杀死（jetsam）</li>
<li>主线程长时间阻塞（watchdog）</li>
<li>WebKit 崩溃</li>
</ul>
<h3 data-id="heading-5"><strong>5. 网络问题</strong></h3>
<ul>
<li>超时</li>
<li>重试</li>
<li>大资源解析压力</li>
</ul>
<p>单一工具很难定位深层问题，因此调试必须体系化。</p>
<hr/>
<h2 data-id="heading-6">二、Xcode：调试的核心入口（断点 + 内存图 + 线程可视化）</h2>
<h3 data-id="heading-7"><strong>1. LLDB（逻辑调试核心）</strong></h3>
<p>可用于：</p>
<ul>
<li>打断点与条件断点</li>
<li>观察变量</li>
<li>修改运行时数据</li>
<li>动态注入代码验证行为</li>
</ul>
<h3 data-id="heading-8"><strong>2. Memory Graph Debugger（对象生命周期）</strong></h3>
<p>能快速发现：</p>
<ul>
<li>控制器未释放</li>
<li>Block 捕获对象</li>
<li>强引用循环</li>
</ul>
<p>这是定位“退出页面内存不下降”的利器。</p>
<h3 data-id="heading-9"><strong>3. Thread Debugger（线程调试）</strong></h3>
<p>可看到：</p>
<ul>
<li>主线程调用栈</li>
<li>是否出现死锁</li>
<li>线程数量是否过高</li>
</ul>
<p>常用于定位“卡顿原因”。</p>
<hr/>
<h2 data-id="heading-10">三、Instruments：深度调试复杂问题的底层工具</h2>
<p>Instruments 是 iOS 调试体系中的“显微镜”，适合定位底层行为。</p>
<h3 data-id="heading-11"><strong>1. Time Profiler（CPU 问题）</strong></h3>
<p>可定位：</p>
<ul>
<li>主线程阻塞</li>
<li>大量计算</li>
<li>布局耗时</li>
<li>图片解码</li>
</ul>
<p>适用于“卡顿”、“加载慢”等问题。</p>
<h3 data-id="heading-12"><strong>2. Allocations / Leaks（内存问题）</strong></h3>
<p>能发现：</p>
<ul>
<li>内存泄漏</li>
<li>对象增长趋势</li>
<li>图片大量创建</li>
<li>WebView 占用增加</li>
</ul>
<p>内存问题是调试中最难的部分之一。</p>
<h3 data-id="heading-13"><strong>3. Core Animation（渲染问题）</strong></h3>
<p>用于调试：</p>
<ul>
<li>离屏渲染</li>
<li>GPU 压力</li>
<li>层级过多</li>
<li>动画不流畅</li>
</ul>
<p>适合 UI 调试。</p>
<hr/>
<h2 data-id="heading-14">四、PerfDog：真机场景中的流畅度与压力调试</h2>
<p>PerfDog 在调试复杂 UI 时非常高效：</p>
<h3 data-id="heading-15">能抓取：</h3>
<ul>
<li>FPS 曲线</li>
<li>CPU/GPU 峰值</li>
<li>长时间运行性能变化</li>
<li>温度上升情况</li>
</ul>
<p>适用于调试：</p>
<ul>
<li>列表滑动卡顿</li>
<li>动画掉帧</li>
<li>视频播放压力</li>
<li>高交互页面性能</li>
</ul>
<p>真机调试阶段非常依赖 PerfDog 的趋势数据。</p>
<hr/>
<h2 data-id="heading-16">五、克魔（KeyMob）：调试系统行为问题的关键工具</h2>
<p>KeyMob 的价值在于提供“真实环境下的可观测性”，尤其是那些 Xcode 无法捕获的系统行为。</p>
<h3 data-id="heading-17"><strong>1. 真机日志（比 Xcode Console 更稳定）</strong></h3>
<p>可导出：</p>
<ul>
<li>应用日志</li>
<li>系统日志</li>
<li>关键字过滤</li>
<li>多进程日志</li>
</ul>
<p>适合定位偶发问题。</p>
<h3 data-id="heading-18"><strong>2. 系统行为日志（调试最需要的部分）</strong></h3>
<p>例如：</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">jetsam_event:</span> memory pressure high
<span class="hljs-symbol">watchdog:</span> main thread <span class="hljs-built_in">is</span> unresponsive
<span class="hljs-symbol">thermal:</span> device overheating
WebKit process terminated
sandbox deny: permission violation
</code></pre>
<p>这些日志常常是问题根因。</p>
<h3 data-id="heading-19"><strong>3. 配合性能监控进行调试</strong></h3>
<p>例如：</p>
<ul>
<li>CPU 峰值上升 → 系统日志出现 thermal 警告</li>
<li>内存上涨 → jetsam 日志出现</li>
<li>UI 卡顿 → 主线程阻塞日志出现</li>
</ul>
<p>这让调试变得“可观察、可推断”。</p>
<hr/>
<h2 data-id="heading-20">六、Charles：调试网络链路相关问题</h2>
<p>许多看似“UI Bug”，实际上是网络行为造成的。</p>
<h3 data-id="heading-21">可调试：</h3>
<ul>
<li>超时请求</li>
<li>重试行为</li>
<li>队列阻塞</li>
<li>大 JSON 解析时间</li>
<li>图片资源过大</li>
</ul>
<p>适用于：</p>
<ul>
<li>首屏加载慢</li>
<li>列表闪烁</li>
<li>弱网表现差</li>
</ul>
<p>网络是调试中最容易被忽略的层面。</p>
<hr/>
<h2 data-id="heading-22">七、Safari Inspector：调试 Hybrid / WebView 行为</h2>
<p>当问题出在 H5 页面或 uni-app 页面时，Safari Inspector 是核心工具。</p>
<h3 data-id="heading-23">可调试：</h3>
<ul>
<li>JS 长任务</li>
<li>DOM 更新频率</li>
<li>资源加载</li>
<li>WebKit 报错</li>
<li>JSBridge 交互</li>
</ul>
<p>常见问题：</p>
<ul>
<li>页面白屏</li>
<li>Hybrid 卡顿</li>
<li>WebView 崩溃</li>
<li>加载慢</li>
</ul>
<p>Safari Inspector 是 Web 调试的“唯一入口”。</p>
<hr/>
<h2 data-id="heading-24">八、MetricKit + Crashlytics：调试复杂线上问题的最后一环</h2>
<h3 data-id="heading-25"><strong>MetricKit 提供系统层调试信息：</strong></h3>
<ul>
<li>CPU 峰值</li>
<li>内存峰值</li>
<li>卡顿事件（hang diagnostics）</li>
<li>崩溃类型</li>
<li>WebKit 崩溃</li>
</ul>
<h3 data-id="heading-26"><strong>Crashlytics 提供：</strong></h3>
<ul>
<li>线程堆栈</li>
<li>锁竞争</li>
<li>死锁</li>
<li>异常行为</li>
<li>非崩溃类问题趋势</li>
</ul>
<p>适合调试上线后才出现的问题。</p>
<hr/>
<h2 data-id="heading-27">九、构建完整的 iOS 调试工具矩阵</h2>













































<table><thead><tr><th>调试维度</th><th>工具组合</th><th>可解决的问题</th></tr></thead><tbody><tr><td>逻辑调试</td><td>Xcode + LLDB</td><td>变量、分支、异常</td></tr><tr><td>内存调试</td><td>Instruments + Xcode Memory Graph + KeyMob</td><td>泄漏、增长</td></tr><tr><td>卡顿调试</td><td>PerfDog + Time Profiler + Core Animation</td><td>CPU/GPU</td></tr><tr><td>WebView 调试</td><td>Safari Inspector + KeyMob</td><td>JS/DOM/WebKit</td></tr><tr><td>网络调试</td><td>Charles</td><td>超时、数据过大</td></tr><tr><td>系统级调试</td><td>KeyMob + MetricKit</td><td>jetsam、watchdog</td></tr><tr><td>上线调试</td><td>Crashlytics + MetricKit</td><td>崩溃、异常趋势</td></tr></tbody></table>
<p>这是一个完整的工程化调试体系。</p>
<hr/>
<h2 data-id="heading-28">调试不是修问题，而是构建工程能力</h2>
<p>一个成熟的 iOS 调试体系必须做到：</p>
<p><strong>可观察 → 可定位 → 可验证 → 可回归 → 可监控</strong></p>
<p>要实现这些能力，需要：</p>
<ul>
<li>Xcode（逻辑）</li>
<li>Instruments（底层）</li>
<li>KeyMob（真机 &amp; 系统行为）</li>
<li>PerfDog（流畅度）</li>
<li>Charles（网络）</li>
<li>Safari Inspector（Web）</li>
<li>MetricKit / Crashlytics（线上）</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[保姆级教程：从0手写RAG智能问答系统，接入Qwen大模型｜Python实战]]></title>    <link>https://juejin.cn/post/7582136489770631178</link>    <guid>https://juejin.cn/post/7582136489770631178</guid>    <pubDate>2025-12-11T04:07:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582136489770631178" data-draft-id="7582110969201115174" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="保姆级教程：从0手写RAG智能问答系统，接入Qwen大模型｜Python实战"/> <meta itemprop="keywords" content="LLM,Agent,程序员"/> <meta itemprop="datePublished" content="2025-12-11T04:07:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="大模型教程"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            保姆级教程：从0手写RAG智能问答系统，接入Qwen大模型｜Python实战
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    大模型教程
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T04:07:58.000Z" title="Thu Dec 11 2025 04:07:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>本文较长，建议点赞收藏。更多AI大模型应用开发学习视频及资料，在<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">这里</a>。</p>
</blockquote>
<p>在大模型落地的众多路径中，RAG（检索增强生成）是几乎“最值得掌握”的一项技术。它将知识库与大模型结合，让模型不仅“知道”，还能“答得准、说得清”。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2663063de4944497b614f66b2c349f8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030878&amp;x-signature=9ajLnQ8JNV%2F16bQEko6Eh9H0oJk%3D" alt="" loading="lazy"/></p>
<p>在前两期课程中，我们基于Dify平台完成了RAG系统的快速搭建。适合初学者理解核心概念，快速体验模型效果。但平台封装程度高，细节难以修改，也难以服务真实业务。</p>
<p>本期课程借助RAG知识库优化电商智能问答，我们不再依赖平台，转向从0编写完整系统。不只是搭出来，而是理解每一个模块，控制每一层逻辑，真正做到“能用、好用、可扩展”。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2be8b20647f7483cbfc9c7d95743cd16~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030878&amp;x-signature=suOOdS%2FFJ%2BHFso%2F6w6lNq%2F7R6l8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">系统搭建核心：</h2>
<h2 data-id="heading-1">知识库、检索与生成的协同机制</h2>
<p>RAG系统的本质，是知识库与大模型之间的高效协同。为了实现这点，我们从三个关键模块入手：知识库构建 → 精准检索 → 智能生成，层层构建。</p>
<h3 data-id="heading-2">1、知识库构建</h3>
<p>这一阶段的核心，是让文档变成结构化、可检索的知识单元。课程围绕电商业务，从产品目录、营销政策、物流规则、FAQ、售后文档中构建知识源。</p>
<ul>
<li>通过文本规范化、去除噪声、结构化处理等步骤，清洗原始文档。</li>
<li>分块策略采用滑动窗口（chunk_size+overlap）机制，同时保留语义连贯性。</li>
<li>向量化阶段采用TF-IDF构建稀疏向量，后续也支持密集向量嵌入。</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6630384041c412b88388702ffeec773~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030878&amp;x-signature=fFAeTuo0QQkBR1iKwxT8o7Qcvzo%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">2、检索模块</h3>
<p>本课程实现了一套混合检索策略。</p>
<ul>
<li>结合稀疏（BM25）与密集（向量）检索，通过权重融合提升匹配精准度。</li>
<li>相似度计算基于余弦相似度，支持top-k返回。</li>
<li>支持从TF-IDF向量空间与向量数据库中双向检索。</li>
</ul>
<p>此外，我们预留了Milvus/FAISS等持久化数据库的扩展口，也实现了增量更新能力，方便后期迭代。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b502f6c8f5c14438983f6413dddb7dc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030878&amp;x-signature=5xlphrMTbVhrn1CfzLyVzV%2BcW7Q%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">3、生成模块</h3>
<p>本系统采用Qwen3-4B作为生成模型，使用Hugging Face Transformers加载模型，并将模型加载到GPU上以加速推理。为提高生成质量做了一下设计与优化：</p>
<ul>
<li>Prompt模板结构清晰，包含已知信息+用户提问+回答指令，确保上下文关联与指令清晰。</li>
<li>通过Top-p采样、Beam Search等参数配置，优化生成质量与风格。</li>
<li>实现异常处理机制，保障模型在边界条件下稳定运行。</li>
</ul>
<p>同时，生成内容紧密依托检索结果，杜绝模型幻觉，提高可解释性与准确度。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19f2f3da0b324bafadc832cf7a3fc172~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030878&amp;x-signature=WuKpx1U6zxs3o6U5juBuTe5Gn4g%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">从原理到实践：</h2>
<h2 data-id="heading-6">搭建一套完整电商RAG系统</h2>
<p>理论学完，开始落地。课程的第二部分是企业级RAG系统的实战搭建。我们不再用平台点击，而是手写全部代码，从数据采集到模型问答，环环相扣，逐步构建。核心能力包括：</p>
<ul>
<li>电商知识文档的采集与格式转换</li>
<li>向量化策略、分块算法的定制实现</li>
<li>混合检索模块的组装与相似度排序</li>
<li>Qwen模型接入与Prompt编排</li>
<li>模块串联，形成端到端问答能力</li>
</ul>
<p>最终，你将完成一个具备真实问答能力、可持续扩展的 AI 应用系统。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85ad673a32d0410cb5db6c0fe1500352~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030878&amp;x-signature=1lQCya0%2F5EEhdgsAIlxOYqtog%2Fo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">为什么手写代码</h2>
<h2 data-id="heading-8">而不继续用Dify？</h2>
<p>Dify 平台能跑通流程，也能快速实现效果。但系统封闭、可控性低，不适合应对业务复杂度高、定制化要求强的真实场景。</p>
<p>相对依靠平台，本课程手写代码搭建RAG系统的方式有三大优势：</p>
<p><strong>灵活</strong>：每个模块可自由替换、优化，比如Prompt模板、检索策略、解码方式。</p>
<p><strong>透明</strong>：了解每一步发生了什么，调试容易，便于维护和优化。</p>
<p><strong>可控</strong>：能将系统部署在企业私有云或本地，数据不出域，更安全。</p>
<p>通过这门课程，你将完整掌握构建企业级RAG系统的核心方法。它不仅带你理解RAG的底层逻辑，更带你走进真正可落地的AI应用场景。适合开发者、产品经理、技术负责人等，对AI应用落地有明确需求的人群。</p>
<h2 data-id="heading-9">学习资源推荐</h2>
<p>如果你想更深入地学习大模型，以下是一些非常有价值的学习资源，这些资源将帮助你从不同角度学习大模型，提升你的实践能力。</p>
<blockquote>
<p>本文较长，建议点赞收藏。更多AI大模型应用开发学习视频及资料，在<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">这里</a>。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI Agent开发入门：5 个关键步骤，帮你打通落地链路]]></title>    <link>https://juejin.cn/post/7582110969201098790</link>    <guid>https://juejin.cn/post/7582110969201098790</guid>    <pubDate>2025-12-11T04:05:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582110969201098790" data-draft-id="7582110969201082406" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI Agent开发入门：5 个关键步骤，帮你打通落地链路"/> <meta itemprop="keywords" content="Agent,LLM,程序员"/> <meta itemprop="datePublished" content="2025-12-11T04:05:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="大模型教程"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI Agent开发入门：5 个关键步骤，帮你打通落地链路
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    大模型教程
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-11T04:05:06.000Z" title="Thu Dec 11 2025 04:05:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-11
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>本文较长，建议点赞收藏。更多AI大模型应用开发学习视频及资料，在<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">这里</a>。</p>
</blockquote>
<p>在实践中，AI Agent的开发需要以“感知-决策-行动”的核心逻辑，根据技术架构和场景需求，分五步进行：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a8d557803824135a74b93b7a4ece067~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=UWWdeEyY0IrN4BWmld6X7uJL9sw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">一、场景的明确和要求的界定</h2>
<p>首先，我们要找出特定的应用场景（如智能客服、自动化办公、工业巡检），明确 Agent 的核心目标与能力边界。例如，如果是客户服务，则以“回答用户问题、工单处理流程”为主进行设计；如果是工业巡检，那么重点应该放在“对设备数据的感知和故障的提前预警”上。同时，对信息的输入与输出方式也需要进行界定：在以文本交互为主的情况下，重点放在对文本信息的加工上；如果包括各种类型的信息（例如，需要道路状况的识别和声音的感知的无人驾驶），则用于图像和声音的数据的访问接口将被对接。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49f6ca48f3bf47c7b0239c4b313efaec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=5wtEKndJwAfYJiwP1%2B6jtAIWXIQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">二、技术选择：架构与模式的匹配</h2>
<p>核心框架的选择：对于初学者，推荐使用LangChain（强大的模块化架构，提供了对工具的调用和内存的管理）；对于需要进行复杂的多Agent协助的情况，推荐使用MetaGPT（支持Agent之间的角色划分）或Swarm（侧重Agent之间的交接）；</p>
<p>大型模式选择：通用场景选择GPT3.5/4，ChatGLM-4，对于垂直的行业大型模式（比如医疗）可微调行业大模型；</p>
<p>工具层和存储层：工具层集成了API（比如天气和支付接口），代码解释器，记忆存储用RAG 构建外部知识库（解决幻觉问题），而长期记忆可以与Pinecone等向量数据库对接。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/985e5b9c95ac429cb5e2d8075cc65077~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=sLAiHAAz9GA79oQMSWuLN7p1s%2Fs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">三、构建核心组件</h2>
<p>感知模块：文本场景以提示的方式分析用户的需要，多种信息场景以 CLIP、Whisper等图像识别和语音识别的方式访问，以API方式访问传感器采集的实时数据；</p>
<p>知识库：集成了两个方面的知识，一个是用于大型建模的一般知识的预处理，另一个是由RAG提供的、需要经常进行更新以确保精度的企业手册和行业规范等领域数据的输入；</p>
<p>决策模块采用ReAct、CoT等框架进行推理，如客户服务系统的决策过程是“询问用户→获取知识库→给出答案”的递归过程，而对于比较复杂的任务（如工程计划）则采用Plan—and—Execute分解为多个子任务来完成；</p>
<p>执行部分：在虚拟情景中，API被调用（例如发送电子邮件、生成报告等），在实体情景中，API被对接到硬件界面（例如机械臂的控制命令等）。</p>
<h2 data-id="heading-3">四、研制、调试和优化</h2>
<p>利用LangChain和其他一些类似的框架，快速构建了该系统的原型，并着重研究了该系统的两个主要功能，即是否需要使用工具以及是否需要询问使用者，以及是否需要在多次会话中记得使用者的喜好，以及该系统的记忆一致性。针对实际问题的优化设计：利用RAG技术降低了模型的信息偏差性，利用精细调整提高了纵向决策的准确性，并降低了工具调用的响应时间；</p>
<h2 data-id="heading-4">五、系统的部署和迭代</h2>
<p>将Agent配置到诸如用于企业客户服务的微信应用或用于工业控制系统设备终端的目标平台上，或者可以借助诸如Coze和百度的AgentBuilder之类的零代码平台来实现快速发布。投入使用后，根据使用者的回馈，进行决策逻辑的优化、工具库的扩充、知识库的更新等一系列的迭代式工作，以逐渐提高系统的自主能力和适应能力。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/87396379552945388ff4f6f46a7ea362~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=CwJkgHJJhZSgaZPIUeqM%2Fecbhe4%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/820e2a83d69044639c946c15ad96f3fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=FFQEUHjomoiZ3GlVyyOTif6oEwI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecb3b79b82ed489abb28ce5f7fdc3668~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=nxoijDU9PnnXEwRXln0oLhpWM%2Fo%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/15d7059f84334d7f97b923e7257800ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=vDgzUDXVg64anAPsgkh3E%2FLiJ1k%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6513c1460c94469397a12c4f38215503~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=hXHkkQr0FHh5%2BHg6zCXcE8vN1uM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/247f6b63f73841e4971a1e8c4e40bbbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=0U%2F1Pgp8jLAsXMbRG6TAzhskj1g%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fe10ebee1dd46849d9f0abf58e22efa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=BFYFrk6fzotB7Hw3opnzAF8hjuA%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4fc0fc2d3794636ac9486d1362467f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=W2%2BkecRBH6c1bttCbvaJG1%2B7SrU%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0066b67a599543d0a08bd46d7e01d511~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=kTrKpsK7G6EBbn9T5UwqAPuHsfE%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8574fcd11d34741af25de085a115829~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=vgRlSbMVpij3%2BuQbOWan%2BiZqOxg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40017b000c0a448c85dda81de463ed95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=sKf%2FvJiEkPoABudc1M%2FMmDEVO%2BA%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2dad1f304d264213b9dc69b0123a4245~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=rvjb8Ts2jCpI3IaFJmn88nw9HiE%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7db980bd4e5e474bb050534407460d98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=hSIGp5bcHPzOW2GoPiKOQfrYowQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40f216422ce04964a08e6dc295900da8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=Nrl%2BqFI8Pt6ynCh5clc%2BqgdU%2FbE%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c555ee6b1844b66b423189b2b39b493~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=wTd8G9LIUwDwDdYQeCu9SZsCROM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de673dc5995b4025893db8465ce3c525~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=p3uYpTTuJJNmYYOAwMarUqmklf8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6559bdb4f274bd6ba40a4153d0e6854~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=%2F0SdzPwKmNMrNBbj7JSqBQ0hwnM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c529ef57e1444ccf8fa3120e111e5670~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=nfZ8UoU26UoPqBWVHQb%2FhFMKpjQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e29af9dff80c4dfe97fd0c4252d7ed58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=VVESer6B%2FlvFL4fdL7sIKSngZ3E%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe762fabde9f49429e10b8e25a1757aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=kRJpXRvorVkaeZAQJc1rI2sGKB0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/797a65389a494e459a31f48d7629dc07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=slm6y%2Blfz%2FEDDTy0GcKXrVttyB0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f05ec6ac699348a6a181fdeed23fdb01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=WvcSzPUXWSK4i3l8JH1jaibLu6s%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12cb26edde8a40f4baca4059c9de245f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=RKiR85RkWdexTYwOOTGtcWgaVAo%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a259f1df39544e00bab2569e1a775e14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=8WRQpnaXIkajWrMULopfpt6RvjM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c8cf2595ee44a278d6c037bcdc807c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=%2BOpzJO7kxE1%2BEwXvc5YdK10GRiM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e3c97fed02f421db3429e0f1959f8c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=KALtZ7f49LGQLmY%2BClq3o6cogro%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64001f1a9bdd4958b240ae70b2d747bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=mLOsJHe0gjewYKSMNk6ZEAukZUw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc96dc4ce36d4cf58073e34b6ec9e414~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=4iqTzaSu8ttqiSvyq1tl5uw4EBU%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1042b53de917453f82074f394e41bbd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=J5hHXmIxxAtaZYjLBNq7ClLxEJE%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/580cf2fcefac4edf8fcbc0a2a515d2f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=lAb4g48HofenIuFno40bD9tuvds%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9be85a35d86f4d85896e8af00fca6c70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=Ny3vx%2FhE7pFSMKfhnMf7y57oSuc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e11b8b100c24adcbf2d13834fc2013e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=Fv9X7gBPzO%2Bq2kCilaeTbmylNf8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64284f10b7b94229bfe3deef6a1bc3f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=XU5j35a1Cu7FYSMDQS3mv%2Fz%2FDpM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fe66943b6434b248b8a9ddd7403f168~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=r64favh043r7j1Zj8P8VnEGqZNw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9664de8eba9c4572a9b5087b34e73570~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=I4eYQdYK7nJGfFkdW4nn0OKZ1uY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32e6128fbe01424e9678e846c1ed0e17~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=l3gjCMS6YQnQ2phUU%2Bzo1y0wAbo%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42b746185f3b4b96ba4b7b83aee9c017~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=7lSZYM1fiJxRMTva1GPYuK%2Fpm4I%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3434fd174a484903b0b78c71927024ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=xlqFwzDyJw3Zmje2BbotkCx%2Fb9o%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13d7cd92a59c4c45af33c5e7ab0879ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=gCuaqnbGn4kbNW9MyLLUg4j5JYk%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f1d3b1e3e1348379f827f874e1eded4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=cR%2FYjESFmFtSniw626eqDTAFTxQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/832f395cbdcd4bf3b86edbf7c54cac5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=mWvMs0TLs4toj%2BFDYe59Pwbn64w%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4fae179137d04050bc3e74e89fb222e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=ngOOArnMVZdasnfKRZlBXNBUtrw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33ad8b59d9d7427badff338a7619f183~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=m1RSH%2By%2Fu5z%2BBtB1pxfm1iD5D%2F8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e3a39cfecfa48d28d1152404ac04bf1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=W%2FZWn7e%2Fmql7xb1aDuI3efLZiME%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/765fb436c3384ad5820b8e2d938c653f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=VmToOB0LqkVUuKPhcP5cGgcAEKg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24bb458f4a9b4dfa90eb70a75b7cefed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=iY0U5lp1o1QczXKSa7%2BKiQc6DaA%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e06fbcef32964b87a9356565e0fa9e0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=UyVN%2BDB9Pvu2jnzXw4N%2FYHbZ5ns%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/208badbae88c4ccdb04c345fb1286429~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766030705&amp;x-signature=4UY3zJ8TWe1N9FqOjlS%2FrKmzSfI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">学习资源推荐</h3>
<p>如果你想更深入地学习大模型，以下是一些非常有价值的学习资源，这些资源将帮助你从不同角度学习大模型，提升你的实践能力。</p>
<blockquote>
<p>本文较长，建议点赞收藏。更多AI大模型应用开发学习视频及资料，在<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">这里</a>。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>