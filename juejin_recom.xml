<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[é‡æ¸©UTF-8å’ŒUTF-16]]></title>    <link>https://juejin.cn/post/7584724634173669439</link>    <guid>https://juejin.cn/post/7584724634173669439</guid>    <pubDate>2025-12-18T05:37:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584724634173669439" data-draft-id="7584740835368468534" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é‡æ¸©UTF-8å’ŒUTF-16"/> <meta itemprop="keywords" content="å…¨æ ˆ"/> <meta itemprop="datePublished" content="2025-12-18T05:37:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="_é˜¿å—_"/> <meta itemprop="url" content="https://juejin.cn/user/3210229681759879"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é‡æ¸©UTF-8å’ŒUTF-16
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3210229681759879/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    _é˜¿å—_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:37:22.000Z" title="Thu Dec 18 2025 05:37:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€UTF-8</h2>
<p>UTF-8 çš„å…¨ç§°ä¸ºï¼š Unicode Transformation Format - 8 - bit</p>
<ul>
<li>Unicode ç»Ÿä¸€å­—ç¬¦é›†ï¼Œç»™ä¸–ç•Œä¸Šæ‰€æœ‰æ–‡å­—åˆ†é…å”¯ä¸€ç¼–å·</li>
<li>Transformation FormatÂ  è½¬æ¢æ ¼å¼</li>
<li>8-bitÂ  ä»¥8ä½ï¼ˆä¸€ä¸ªå­—èŠ‚ï¼‰ ä¸ºåŸºæœ¬å•ä½è¿›è¡Œç¼–ç </li>
</ul>
<p>UTF-8 æ˜¯ä¸€ç§æŠŠUnicodeå­—ç¬¦ç¼–ç æˆ<strong>1~4ä¸ªå­—èŠ‚</strong>çš„ç¼–ç æ–¹å¼</p>
<p>å˜é•¿ç¼–ç ï¼š</p>
<ol>
<li>è‹±æ–‡ï¼šÂ  1ä¸ªå­—èŠ‚</li>
<li>æ‹‰ä¸å­—æ¯ï¼š 2ä¸ªå­—èŠ‚ ï¼ˆæ‹‰ä¸å­—æ¯å’Œå¸Œè…Šå­—æ¯ï¼‰</li>
<li>ä¸­æ–‡ï¼š 3ä¸ªå­—èŠ‚ ï¼ˆå¤§å¤šæ•°å¸¸è§æ±‰å­—ï¼‰</li>
<li>Emojiï¼š 4å­—èŠ‚ ï¼ˆåŒ…æ‹¬ç”Ÿåƒ»å­—ç¬¦ï¼‰</li>
</ol>
<h3 data-id="heading-1">ç¼–ç è§„åˆ™ï¼š</h3>
<ol>
<li>å¯¹äºé•¿åº¦ä¸º1å­—èŠ‚çš„å­—ç¬¦ï¼Œå°†æœ€é«˜ä½è®¾ç½®ä¸º0.</li>
<li>å¯¹äºé•¿åº¦ä¸ºnå­—èŠ‚çš„å­—ç¬¦ï¼ˆn &gt; 1ï¼‰ï¼Œå°†é¦–ä¸ªå­—èŠ‚çš„é«˜nä½éƒ½è®¾ç½®ä¸º1ï¼Œç¬¬n+1ä½è®¾ç½®ä¸º0ï¼›ä»ç¬¬äºŒä¸ªå­—èŠ‚å¼€å§‹ï¼Œå°†æ¯ä¸ªå­—èŠ‚çš„é«˜2ä½éƒ½è®¾ç½®ä¸º10ï¼›</li>
</ol>
<p><strong>ç†è§£</strong>ï¼š å¦‚æœè¯»åˆ°ä¸€ä¸ªByteï¼Œé‚£ä¹ˆå°±å–ç¬¬ä¸€ä½ï¼Œå¦‚æœæ˜¯0ï¼Œé‚£ä¹ˆå°±æ˜¯Asciiç ã€‚å¦‚æœæ˜¯1ï¼Œé‚£ä¹ˆç»§ç»­å–å€¼ï¼Œç›´åˆ°0ï¼Œæœ‰å‡ ä¸ª1å°±æ˜¯å‡ ä¸ªå­—ç¬¦é•¿åº¦ã€‚è¯»å–åé¢å­—ç¬¦åï¼Œç»„è£…æˆä¸€ä¸ªæœ‰æ•ˆçš„Unicodeç ã€‚</p>
<p>ä¸¾ä¾‹ï¼š â€œç®—â€å­—çš„</p>
<p>Unicodeæ˜¯ U+7B97ï¼š</p>
<p>7Â  Â  Â  BÂ  Â  Â  9Â  Â  Â  7</p>
<p>0111 1011 1001 0111</p>
<p>UTF-8çš„ç¼–ç ä¸º 0xE7AE97</p>
<p>EÂ  Â  Â  Â  7Â  Â  Â  AÂ  Â  Â  EÂ  Â  Â  9Â  Â  Â  7</p>
<p>1110 0111 1010 1110 1001 0111</p>
<p>UTF-16çš„ç¼–ç ä¸º 0x7B97</p>
<p>7Â  Â  Â  BÂ  Â  Â  9Â  Â  Â  7</p>
<p>0111 1011 1001 0111</p>
<h2 data-id="heading-2">äºŒã€ UTF-16ç¼–ç ï¼š 2æˆ–4å­—èŠ‚</h2>
<ol>
<li><strong>2ä¸ªå­—èŠ‚</strong>ï¼š å½“ç ç‚¹åœ¨ U+0000 åˆ° U+FFFFï¼Œä¸åœ¨ä»£ç†åŒº U+D800 åˆ° U+FFFF</li>
<li><strong>4ä¸ªå­—èŠ‚</strong>ï¼šÂ  å½“ç ç‚¹åœ¨U+10000 åˆ° U+10FFFFæ—¶ï¼Œä½¿ç”¨ä»£ç†å¯¹è®¡ç®—</li>
</ol>
<h4 data-id="heading-3">ä»£ç†å¯¹è®¡ç®—è§„åˆ™ï¼š</h4>
<p>Unicodeæœ‰ä¸€æ®µç‰¹åˆ«çš„åŒºé—´ï¼šÂ  U+D800 åˆ° U+DFFFFÂ  ä¸æ˜¯å­—ç¬¦ï¼Œä»…ä»…æ˜¯UTF-16çš„ä»£ç†å¯¹ã€‚</p>
<p>å½“ç ç‚¹ &gt;= 0x10000 æ—¶ï¼š</p>
<ol>
<li>
<p>å‡å»0x10000Â  Â </p>
</li>
<li>
<ol>
<li>U = codePoint - 0x10000</li>
</ol>
</li>
<li>
<p>æ‹†æˆé«˜10ä½å’Œä½10ä½</p>
</li>
<li>
<ol>
<li>high = U &gt;&gt; 10</li>
<li>low = U &amp; 0x3FF</li>
</ol>
</li>
<li>
<p>åŠ ä¸Šä»£ç†åŸºå€¼</p>
</li>
<li>
<ol>
<li>é«˜ä»£ç† = 0xD800 + high</li>
<li>ä½ä»£ç† = 0xDC00 + low</li>
</ol>
</li>
<li>
<p>å¾—åˆ°4å­—èŠ‚çš„UTF-16ç¼–ç </p>
</li>
</ol>
<h4 data-id="heading-4">è§£æUTF-16é€»è¾‘ï¼š</h4>
<ol>
<li>å…ˆå–2ä¸ªå­—èŠ‚ï¼›</li>
<li>å¦‚æœè¯¥å€¼è½åœ¨0xD800åˆ°0xDBFFï¼Œè¯´æ˜è¿™æ˜¯é«˜ä»£ç†ï¼Œéœ€è¦å†å–2ä¸ªå­—èŠ‚ç»„æˆ4ä¸ªå­—èŠ‚å­—ç¬¦ã€‚</li>
<li>å†å–çš„2ä¸ªå­—èŠ‚åœ¨0xDC00åˆ°0xDFFFå†…ã€‚</li>
<li>å¦åˆ™è¯¥å­—ç¬¦å°±æ˜¯2å­—èŠ‚è¡¨ç¤ºã€‚</li>
</ol>
<h4 data-id="heading-5">ä¸¾ä¾‹ï¼š</h4>
<ol>
<li>è¯»å–åˆ° 0xD83D</li>
<li>å› ä¸º0xD83Dåœ¨ 0xD800åˆ°0xDBFFä¹‹é—´ï¼Œè¯´æ˜æ˜¯é«˜ä»£ç†Â  0xD83D - 0xD800 = 0x3D</li>
<li>å†è·å–2å­—èŠ‚ï¼Œè¯»å–åˆ°0xDE00</li>
<li>å› ä¸º0xDE00åœ¨0xDC00åˆ°0xDFFFFä¹‹é—´ï¼Œè¯´æ˜æ˜¯ä½ä»£ç† 0xDE00 - 0xDC00 = 0x200</li>
<li>è®¡ç®— 0x3D &lt;&lt; 10 + 0x200 + 0x10000 = 0xF400 + 0x10200 = <strong>0x1F600</strong></li>
</ol>
<p>ç»“æœä¸º 0xD83Dçš„Unicodeå€¼ä¸º ğŸ˜€ï¼ˆU+1F600ï¼‰</p>
<h4 data-id="heading-6">çŸ¥è¯†ç‚¹ï¼š</h4>
<ol>
<li>ä½¿ç”¨UTF-16ç¼–ç çš„è¯­è¨€æœ‰Javaã€JavaScriptã€TypeScriptå’ŒC#ã€‚</li>
<li>ç½‘ç»œä¼ è¾“æ—¶ä½¿ç”¨UTF-8æ ¼å¼ï¼Œä»¥è¾¾åˆ°æœ€ä¼˜çš„å…¼å®¹æ€§å’Œç©ºé—´æ•ˆç‡ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Canalæ·±åº¦è§£æï¼šMySQLå¢é‡æ•°æ®è®¢é˜…ä¸æ¶ˆè´¹å®æˆ˜]]></title>    <link>https://juejin.cn/post/7584787119273476123</link>    <guid>https://juejin.cn/post/7584787119273476123</guid>    <pubDate>2025-12-18T03:44:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584787119273476123" data-draft-id="7584987267291709486" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Canalæ·±åº¦è§£æï¼šMySQLå¢é‡æ•°æ®è®¢é˜…ä¸æ¶ˆè´¹å®æˆ˜"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-18T03:44:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Canalæ·±åº¦è§£æï¼šMySQLå¢é‡æ•°æ®è®¢é˜…ä¸æ¶ˆè´¹å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:44:54.000Z" title="Thu Dec 18 2025 03:44:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Canalæ·±åº¦è§£æï¼šMySQLå¢é‡æ•°æ®è®¢é˜…ä¸æ¶ˆè´¹å®æˆ˜</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffd04e681ed74f67bbd24ba438d13e1e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766634294&amp;x-signature=oD%2BfWt6prrQdPSg55VRIvZFK19w%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸€ã€å¼•è¨€ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦Canalï¼Ÿ</h3>
<p>ä½ çš„ç”µå•†ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ä¸‹å•åä¿®æ”¹äº†å•†å“åº“å­˜ï¼Œä½†æ˜¯Redisç¼“å­˜ä¸­çš„åº“å­˜æ•°æ®è¿˜æ˜¯æ—§çš„ï¼Œå¯¼è‡´è¶…å–é—®é¢˜ï¼›æˆ–è€…ä½ éœ€è¦å°†MySQLä¸­çš„æ•°æ®å®æ—¶åŒæ­¥åˆ°Elasticsearchä¸­ä¾›æœç´¢ä½¿ç”¨ï¼Œä¼ ç»Ÿçš„å®šæ—¶ä»»åŠ¡æ–¹å¼å»¶è¿Ÿé«˜ã€æ€§èƒ½å·®ã€‚</p>
<p>è¿™äº›é—®é¢˜çš„æ ¹æºåœ¨äºï¼š<strong>æ•°æ®åœ¨ä¸åŒç³»ç»Ÿé—´çš„å®æ—¶åŒæ­¥ç¼ºä¹ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆ</strong>ã€‚</p>
<p>Canalåº”è¿è€Œç”Ÿã€‚å®ƒæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„åŸºäºMySQLæ•°æ®åº“binlogçš„å¢é‡è®¢é˜…&amp;æ¶ˆè´¹ç»„ä»¶ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å®ç°ï¼š</p>
<ul>
<li><strong>å®æ—¶æ€§é«˜</strong>ï¼šæ¯«ç§’çº§æ•°æ®åŒæ­¥</li>
<li><strong>ä¾µå…¥æ€§ä½</strong>ï¼šæ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç </li>
<li><strong>å¯é æ€§å¼º</strong>ï¼šåŸºäºMySQLä¸»ä»å¤åˆ¶åè®®</li>
<li><strong>æ‰©å±•æ€§å¥½</strong>ï¼šæ”¯æŒå¤šç§ä¸‹æ¸¸æ¶ˆè´¹åœºæ™¯</li>
</ul>
<h3 data-id="heading-2">äºŒã€Canalåº”ç”¨åœºæ™¯å…¨æ™¯</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8041624550f344af8a7bc5f93512ccd5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766634294&amp;x-signature=8ZnR1b3W9rrBhWiXj1k6eDaG1l0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>Canalåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨åœºæ™¯ï¼š</p>
<h4 data-id="heading-3">1. æ•°æ®åº“å®æ—¶å¤‡ä»½</h4>
<p>é€šè¿‡è®¢é˜…MySQLçš„binlogï¼Œå¯ä»¥å®æ—¶å°†æ•°æ®å˜æ›´åŒæ­¥åˆ°å¤‡ä»½åº“ï¼Œå®ç°æ•°æ®çš„å®æ—¶å®¹ç¾ã€‚ç›¸æ¯”ä¼ ç»Ÿçš„MySQLä¸»ä»å¤åˆ¶ï¼ŒCanalæä¾›äº†æ›´çµæ´»çš„æ§åˆ¶èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-4">2. ç¼“å­˜åŒæ­¥</h4>
<p>è¿™æ˜¯æœ€å¸¸è§çš„åœºæ™¯ã€‚å½“MySQLä¸­çš„æ•°æ®å‘ç”Ÿå˜æ›´æ—¶ï¼Œé€šè¿‡Canalå®æ—¶æ•è·å˜æ›´äº‹ä»¶ï¼Œæ›´æ–°Redisã€Memcachedç­‰ç¼“å­˜ï¼Œä¿è¯ç¼“å­˜ä¸æ•°æ®åº“çš„ä¸€è‡´æ€§ã€‚</p>
<h4 data-id="heading-5">3. å®æ—¶æ•°æ®åˆ†æ</h4>
<p>å°†MySQLçš„æ•°æ®å˜æ›´å®æ—¶æ¨é€åˆ°Kafkaç­‰æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¾›ä¸‹æ¸¸çš„å®æ—¶è®¡ç®—ç³»ç»Ÿï¼ˆå¦‚Flinkã€Spark Streamingï¼‰æ¶ˆè´¹ï¼Œæ„å»ºå®æ—¶æ•°æ®ä»“åº“ã€‚</p>
<h4 data-id="heading-6">4. æ•°æ®å¼‚æ„è¿ç§»</h4>
<p>å°†å…³ç³»å‹æ•°æ®åº“MySQLä¸­çš„æ•°æ®å®æ—¶åŒæ­¥åˆ°NoSQLæ•°æ®åº“ï¼ˆå¦‚MongoDBã€HBaseï¼‰æˆ–æœç´¢å¼•æ“ï¼ˆå¦‚Elasticsearchï¼‰ï¼Œæ»¡è¶³ä¸åŒä¸šåŠ¡åœºæ™¯çš„æŸ¥è¯¢éœ€æ±‚ã€‚</p>
<h3 data-id="heading-7">ä¸‰ã€Canalå·¥ä½œåŸç†æ·±åº¦å‰–æ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/954b5159fc6a465fa347f5f5174777df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766634294&amp;x-signature=t9B4%2BBLtqrjHsJqZnD8snAkjG0I%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-8">æ ¸å¿ƒåŸç†</h4>
<p>Canalçš„å·¥ä½œåŸç†åŸºäºMySQLçš„ä¸»ä»å¤åˆ¶åè®®ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒMySQLçš„ä¸»ä»å¤åˆ¶è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>Masterå°†æ•°æ®å˜æ›´å†™å…¥binlogï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰</li>
<li>Slaveçš„IOçº¿ç¨‹è¯»å–Masterçš„binlogå¹¶å†™å…¥relay logï¼ˆä¸­ç»§æ—¥å¿—ï¼‰</li>
<li>Slaveçš„SQLçº¿ç¨‹è¯»å–relay logå¹¶é‡æ”¾SQLï¼Œå®Œæˆæ•°æ®åŒæ­¥</li>
</ol>
<p><strong>Canalæ¨¡æ‹Ÿäº†MySQL Slaveçš„äº¤äº’åè®®</strong>ï¼ŒæŠŠè‡ªå·±ä¼ªè£…æˆMySQLçš„ä»åº“ï¼Œå‘MySQL Masterå‘é€dumpè¯·æ±‚ï¼ŒMySQLæ¨é€binlogç»™Canalï¼ŒCanalè§£æbinlogå¯¹è±¡ï¼ˆåŸå§‹ä¸ºbyteæµï¼‰ã€‚</p>
<h4 data-id="heading-9">å·¥ä½œæµç¨‹</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> Canalè¿æ¥MySQLï¼Œä¼ªè£…æˆSlave
<span class="hljs-bullet">2.</span> MySQLæ¨é€binlogç»™Canal
<span class="hljs-bullet">3.</span> Canalè§£æbinlogå†…å®¹
<span class="hljs-bullet">4.</span> Canalå°†è§£æåçš„æ•°æ®å‘é€ç»™å®¢æˆ·ç«¯
<span class="hljs-bullet">5.</span> å®¢æˆ·ç«¯å¤„ç†æ•°æ®ï¼ˆå†™å…¥ç¼“å­˜ã€MQç­‰ï¼‰
</code></pre>
<h3 data-id="heading-10">å››ã€Canalæ¶æ„è®¾è®¡</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14128eb35bd8464c8979e7d63f139003~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766634294&amp;x-signature=Vkvpt4WZb6coxcdcpctMlTJMNWE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>Canalçš„æ¶æ„è®¾è®¡éå¸¸ä¼˜é›…ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š</p>
<h4 data-id="heading-11">1. EventParserï¼ˆäº‹ä»¶è§£æå™¨ï¼‰</h4>
<p>è´Ÿè´£ä½œä¸ºMySQL Slaveä¸MySQL Masterå»ºç«‹è¿æ¥ï¼Œæ¨¡æ‹Ÿslaveåè®®ä¸MySQL Masterè¿›è¡Œäº¤äº’ï¼Œè¯·æ±‚å¹¶æ¥æ”¶binlogæµï¼Œå¹¶å°†å…¶è§£ææˆCanalå†…éƒ¨çš„æ•°æ®ç»“æ„ã€‚</p>
<p><strong>æ ¸å¿ƒèŒè´£ï¼š</strong></p>
<ul>
<li>è¿æ¥ç®¡ç†ï¼šå»ºç«‹ä¸MySQLçš„è¿æ¥</li>
<li>åè®®æ¨¡æ‹Ÿï¼šæ¨¡æ‹ŸMySQL Slaveåè®®</li>
<li>Binlogè·å–ï¼šä»MySQLè·å–binlogæµ</li>
<li>äº‹ä»¶è§£æï¼šå°†binlogè§£æä¸ºç»“æ„åŒ–äº‹ä»¶</li>
</ul>
<h4 data-id="heading-12">2. EventSinkï¼ˆäº‹ä»¶è¿‡æ»¤å™¨ï¼‰</h4>
<p>è´Ÿè´£å¯¹EventParserè§£æå‡ºæ¥çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ã€åŠ å·¥ã€åˆ†å‘ã€‚å¯ä»¥æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼é…ç½®ï¼Œè¿‡æ»¤å‡ºéœ€è¦çš„è¡¨ã€å­—æ®µç­‰ã€‚</p>
<p><strong>æ ¸å¿ƒèŒè´£ï¼š</strong></p>
<ul>
<li>æ•°æ®è¿‡æ»¤ï¼šæŒ‰è§„åˆ™è¿‡æ»¤æ•°æ®</li>
<li>æ•°æ®è½¬æ¢ï¼šæ ¼å¼è½¬æ¢å’ŒåŠ å·¥</li>
<li>äº‹ä»¶è·¯ç”±ï¼šå°†äº‹ä»¶è·¯ç”±åˆ°ä¸åŒçš„å¤„ç†å™¨</li>
</ul>
<h4 data-id="heading-13">3. EventStoreï¼ˆäº‹ä»¶å­˜å‚¨ï¼‰</h4>
<p>è´Ÿè´£å°†æ•°æ®å­˜å‚¨åˆ°æœ¬åœ°ï¼Œæä¾›æ¶ˆè´¹ç«¯è·å–æ•°æ®ã€‚é‡‡ç”¨ç¯å½¢é˜Ÿåˆ—ç»“æ„ï¼Œæ”¯æŒæ‰¹é‡æ¶ˆè´¹å’Œæ¶ˆè´¹ä½ç‚¹è®°å½•ã€‚</p>
<p><strong>æ ¸å¿ƒèŒè´£ï¼š</strong></p>
<ul>
<li>æ•°æ®å­˜å‚¨ï¼šæŒä¹…åŒ–äº‹ä»¶æ•°æ®</li>
<li>ä½ç‚¹ç®¡ç†ï¼šè®°å½•æ¶ˆè´¹ä½ç½®</li>
<li>æ•°æ®æä¾›ï¼šä¸ºæ¶ˆè´¹è€…æä¾›æ•°æ®</li>
</ul>
<h3 data-id="heading-14">äº”ã€MySQL Binlogæœºåˆ¶è¯¦è§£</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/953c466fc92744c6bd01a90b9221980c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766634294&amp;x-signature=Tx8lPmWMOWrvEFQtouecBvVwcRE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¦æ·±å…¥ç†è§£Canalï¼Œå¿…é¡»å…ˆç†è§£MySQLçš„binlogæœºåˆ¶ã€‚</p>
<h4 data-id="heading-15">Binlogæ˜¯ä»€ä¹ˆï¼Ÿ</h4>
<p>Binlogï¼ˆBinary Logï¼‰æ˜¯MySQLçš„äºŒè¿›åˆ¶æ—¥å¿—ï¼Œè®°å½•äº†æ‰€æœ‰DDLå’ŒDMLè¯­å¥ï¼ˆä¸åŒ…æ‹¬SELECTå’ŒSHOWç­‰æŸ¥è¯¢è¯­å¥ï¼‰ï¼Œä»¥äº‹ä»¶çš„å½¢å¼è®°å½•ï¼Œå¹¶åŒ…å«è¯­å¥æ‰§è¡Œçš„æ—¶é—´ä¿¡æ¯ã€‚</p>
<h4 data-id="heading-16">Binlogçš„ä½œç”¨</h4>
<ol>
<li><strong>ä¸»ä»å¤åˆ¶</strong>ï¼šMasterå°†binlogå‘é€ç»™Slaveï¼ŒSlaveé‡æ”¾binlogå®ç°æ•°æ®åŒæ­¥</li>
<li><strong>æ•°æ®æ¢å¤</strong>ï¼šé€šè¿‡binlogå¯ä»¥è¿›è¡Œpoint-in-timeæ¢å¤</li>
<li><strong>å®¡è®¡</strong>ï¼šå¯ä»¥é€šè¿‡binlogå®¡è®¡æ•°æ®åº“çš„å˜æ›´å†å²</li>
</ol>
<h4 data-id="heading-17">Binlogæ ¼å¼</h4>
<p>MySQL binlogæœ‰ä¸‰ç§æ ¼å¼ï¼š</p>
<p><strong>1. Statementæ ¼å¼</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è®°å½•SQLè¯­å¥</span>
<span class="hljs-keyword">UPDATE</span> users <span class="hljs-keyword">SET</span> age <span class="hljs-operator">=</span> age <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">&lt;</span> <span class="hljs-number">100</span>;
</code></pre>
<p>ä¼˜ç‚¹ï¼šæ—¥å¿—é‡å°‘
ç¼ºç‚¹ï¼šæŸäº›å‡½æ•°å¦‚NOW()ã€UUID()ç­‰ä¼šå¯¼è‡´ä¸»ä»æ•°æ®ä¸ä¸€è‡´</p>
<p><strong>2. Rowæ ¼å¼</strong></p>
<pre><code class="hljs language-ini" lang="ini">-- è®°å½•æ¯ä¸€è¡Œçš„å®é™…å˜æ›´
<span class="hljs-section">[ROW]</span> <span class="hljs-attr">id</span>=<span class="hljs-number">1</span>, age: <span class="hljs-number">25</span> -&gt; <span class="hljs-number">26</span>
<span class="hljs-section">[ROW]</span> <span class="hljs-attr">id</span>=<span class="hljs-number">2</span>, age: <span class="hljs-number">30</span> -&gt; <span class="hljs-number">31</span>
...
</code></pre>
<p>ä¼˜ç‚¹ï¼šå‡†ç¡®è®°å½•æ¯ä¸€è¡Œçš„å˜æ›´ï¼Œä¿è¯ä¸»ä»ä¸€è‡´
ç¼ºç‚¹ï¼šæ—¥å¿—é‡å¤§</p>
<p><strong>3. Mixedæ ¼å¼</strong>
æ··åˆä½¿ç”¨Statementå’ŒRowæ ¼å¼ï¼ŒMySQLè‡ªåŠ¨åˆ¤æ–­ä½¿ç”¨å“ªç§æ ¼å¼ã€‚</p>
<p><strong>Canalè¦æ±‚ä½¿ç”¨Rowæ ¼å¼</strong>ï¼Œå› ä¸ºåªæœ‰Rowæ ¼å¼æ‰èƒ½å‡†ç¡®æ•è·æ¯ä¸€è¡Œçš„å˜æ›´è¯¦æƒ…ã€‚</p>
<h3 data-id="heading-18">å…­ã€Canalç¯å¢ƒæ­å»ºå®æˆ˜</h3>
<h4 data-id="heading-19">6.1 MySQLé…ç½®</h4>
<p>é¦–å…ˆéœ€è¦å¼€å¯MySQLçš„binlogåŠŸèƒ½ï¼Œå¹¶è®¾ç½®ä¸ºRowæ ¼å¼ã€‚</p>
<p>ç¼–è¾‘MySQLé…ç½®æ–‡ä»¶<code>my.cnf</code>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[mysqld]</span>
<span class="hljs-comment"># å¼€å¯binlog</span>
<span class="hljs-attr">log-bin</span>=mysql-bin
<span class="hljs-comment"># è®¾ç½®binlogæ ¼å¼ä¸ºROW</span>
<span class="hljs-attr">binlog-format</span>=ROW
<span class="hljs-comment"># è®¾ç½®server-idï¼ˆå¿…é¡»å”¯ä¸€ï¼‰</span>
<span class="hljs-attr">server-id</span>=<span class="hljs-number">1</span>
<span class="hljs-comment"># è®¾ç½®binlogè¿‡æœŸæ—¶é—´ï¼ˆå¤©ï¼‰</span>
<span class="hljs-attr">expire_logs_days</span>=<span class="hljs-number">7</span>
<span class="hljs-comment"># è®¾ç½®å•ä¸ªbinlogæ–‡ä»¶å¤§å°</span>
<span class="hljs-attr">max_binlog_size</span>=<span class="hljs-number">100</span>M
<span class="hljs-comment"># éœ€è¦åŒæ­¥çš„æ•°æ®åº“</span>
<span class="hljs-attr">binlog-do-db</span>=test_db
</code></pre>
<p>é‡å¯MySQLä½¿é…ç½®ç”Ÿæ•ˆï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl restart mysql
</code></pre>
<p>åˆ›å»ºCanalç”¨æˆ·å¹¶æˆæƒï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">'canal'</span>@<span class="hljs-string">'%'</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">'canal@123'</span>;
<span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span>, REPLICATION SLAVE, REPLICATION CLIENT <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">'canal'</span>@<span class="hljs-string">'%'</span>;
FLUSH PRIVILEGES;
</code></pre>
<p>éªŒè¯binlogæ˜¯å¦å¼€å¯ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SHOW</span> VARIABLES <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'log_bin'</span>;
<span class="hljs-keyword">SHOW</span> VARIABLES <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'binlog_format'</span>;
<span class="hljs-keyword">SHOW</span> MASTER STATUS;
</code></pre>
<h4 data-id="heading-20">6.2 Canal Serveréƒ¨ç½²</h4>
<p>ä¸‹è½½Canal Serverï¼š</p>
<pre><code class="hljs language-bash" lang="bash">wget https://github.com/alibaba/canal/releases/download/canal-1.1.6/canal.deployer-1.1.6.tar.gz
<span class="hljs-built_in">mkdir</span> canal-server &amp;&amp; <span class="hljs-built_in">cd</span> canal-server
tar -zxvf canal.deployer-1.1.6.tar.gz
</code></pre>
<p>é…ç½®Canal Serverï¼Œç¼–è¾‘<code>conf/example/instance.properties</code>ï¼š</p>
<pre><code class="hljs language-properties" lang="properties"># MySQLè¿æ¥é…ç½®
canal.instance.master.address=127.0.0.1:3306
canal.instance.dbUsername=canal
canal.instance.dbPassword=canal@123
canal.instance.connectionCharset=UTF-8

# è®¢é˜…çš„binlogä½ç½®ï¼ˆé¦–æ¬¡å¯åŠ¨ä¼šä»æœ€æ–°ä½ç½®å¼€å§‹ï¼‰
canal.instance.master.journal.name=
canal.instance.master.position=
canal.instance.master.timestamp=

# è®¢é˜…çš„æ•°æ®åº“å’Œè¡¨ï¼ˆæ”¯æŒæ­£åˆ™ï¼‰
canal.instance.filter.regex=test_db\\..*
# é»‘åå•ï¼ˆä¸è®¢é˜…çš„è¡¨ï¼‰
canal.instance.filter.black.regex=

# å¯ç”¨äº‹åŠ¡æ”¯æŒ
canal.instance.tsdb.enable=true
</code></pre>
<p>å¯åŠ¨Canal Serverï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sh bin/startup.sh
</code></pre>
<p>æŸ¥çœ‹æ—¥å¿—ç¡®è®¤å¯åŠ¨æˆåŠŸï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">tail</span> -f logs/canal/canal.log
<span class="hljs-built_in">tail</span> -f logs/example/example.log
</code></pre>
<h3 data-id="heading-21">ä¸ƒã€Canalå®¢æˆ·ç«¯å¼€å‘å®æˆ˜</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72aa7a7c76dc48f4a7311f93f321b2ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766634294&amp;x-signature=2mhsGXIHDwv1WZKdOvOFGnCKcUI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-22">7.1 å¼•å…¥ä¾èµ–</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.otter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>canal.client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-23">7.2 ç®€å•å®¢æˆ·ç«¯å®ç°</h4>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„Canalå®¢æˆ·ç«¯ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•è®¢é˜…MySQLå˜æ›´å¹¶å¤„ç†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.otter.canal.client.CanalConnector;
<span class="hljs-keyword">import</span> com.alibaba.otter.canal.client.CanalConnectors;
<span class="hljs-keyword">import</span> com.alibaba.otter.canal.protocol.CanalEntry;
<span class="hljs-keyword">import</span> com.alibaba.otter.canal.protocol.Message;
<span class="hljs-keyword">import</span> com.google.protobuf.InvalidProtocolBufferException;

<span class="hljs-keyword">import</span> java.net.InetSocketAddress;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleCanalClient</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºè¿æ¥</span>
        <span class="hljs-type">CanalConnector</span> <span class="hljs-variable">connector</span> <span class="hljs-operator">=</span> CanalConnectors.newSingleConnector(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">11111</span>),
            <span class="hljs-string">"example"</span>,  <span class="hljs-comment">// destinationåç§°</span>
            <span class="hljs-string">""</span>,         <span class="hljs-comment">// ç”¨æˆ·åï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span>
            <span class="hljs-string">""</span>          <span class="hljs-comment">// å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span>
        );

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è¿æ¥Canal Server</span>
            connector.connect();
            <span class="hljs-comment">// è®¢é˜…æ•°æ®åº“è¡¨</span>
            connector.subscribe(<span class="hljs-string">"test_db\\..*"</span>);
            <span class="hljs-comment">// å›æ»šåˆ°æœªæ¶ˆè´¹ä½ç½®</span>
            connector.rollback();

            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                <span class="hljs-comment">// è·å–æŒ‡å®šæ•°é‡çš„æ•°æ®</span>
                <span class="hljs-type">Message</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> connector.getWithoutAck(<span class="hljs-number">100</span>);
                <span class="hljs-type">long</span> <span class="hljs-variable">batchId</span> <span class="hljs-operator">=</span> message.getId();
                <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> message.getEntries().size();

                <span class="hljs-keyword">if</span> (batchId == -<span class="hljs-number">1</span> || size == <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">try</span> {
                        Thread.sleep(<span class="hljs-number">1000</span>);
                    } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                        e.printStackTrace();
                    }
                } <span class="hljs-keyword">else</span> {
                    printEntries(message.getEntries());
                }

                <span class="hljs-comment">// ç¡®è®¤æ¶ˆè´¹</span>
                connector.ack(batchId);
            }
        } <span class="hljs-keyword">finally</span> {
            connector.disconnect();
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printEntries</span><span class="hljs-params">(List&lt;CanalEntry.Entry&gt; entries)</span> {
        <span class="hljs-keyword">for</span> (CanalEntry.Entry entry : entries) {
            <span class="hljs-keyword">if</span> (entry.getEntryType() == CanalEntry.EntryType.TRANSACTIONBEGIN ||
                entry.getEntryType() == CanalEntry.EntryType.TRANSACTIONEND) {
                <span class="hljs-keyword">continue</span>;
            }

            CanalEntry.RowChange rowChange;
            <span class="hljs-keyword">try</span> {
                rowChange = CanalEntry.RowChange.parseFrom(entry.getStoreValue());
            } <span class="hljs-keyword">catch</span> (InvalidProtocolBufferException e) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è§£æbinlogå¤±è´¥"</span>, e);
            }

            CanalEntry.<span class="hljs-type">EventType</span> <span class="hljs-variable">eventType</span> <span class="hljs-operator">=</span> rowChange.getEventType();
            <span class="hljs-type">String</span> <span class="hljs-variable">tableName</span> <span class="hljs-operator">=</span> entry.getHeader().getTableName();
            <span class="hljs-type">String</span> <span class="hljs-variable">schemaName</span> <span class="hljs-operator">=</span> entry.getHeader().getSchemaName();

            System.out.println(String.format(<span class="hljs-string">"æ•°æ®åº“: %s, è¡¨: %s, äº‹ä»¶ç±»å‹: %s"</span>,
                schemaName, tableName, eventType));

            <span class="hljs-keyword">for</span> (CanalEntry.RowData rowData : rowChange.getRowDatasList()) {
                <span class="hljs-keyword">if</span> (eventType == CanalEntry.EventType.DELETE) {
                    printColumns(rowData.getBeforeColumnsList(), <span class="hljs-string">"åˆ é™¤"</span>);
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (eventType == CanalEntry.EventType.INSERT) {
                    printColumns(rowData.getAfterColumnsList(), <span class="hljs-string">"æ’å…¥"</span>);
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (eventType == CanalEntry.EventType.UPDATE) {
                    System.out.println(<span class="hljs-string">"------æ›´æ–°å‰------"</span>);
                    printColumns(rowData.getBeforeColumnsList(), <span class="hljs-string">""</span>);
                    System.out.println(<span class="hljs-string">"------æ›´æ–°å------"</span>);
                    printColumns(rowData.getAfterColumnsList(), <span class="hljs-string">""</span>);
                }
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printColumns</span><span class="hljs-params">(List&lt;CanalEntry.Column&gt; columns, String operation)</span> {
        <span class="hljs-keyword">for</span> (CanalEntry.Column column : columns) {
            System.out.println(String.format(<span class="hljs-string">"%s: %s = %s (ç±»å‹: %s, æ˜¯å¦æ›´æ–°: %s)"</span>,
                operation,
                column.getName(),
                column.getValue(),
                column.getMysqlType(),
                column.getUpdated()));
        }
    }
}
</code></pre>
<h4 data-id="heading-24">7.3 å°è£…ä¼˜é›…çš„å®¢æˆ·ç«¯</h4>
<p>å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å®¢æˆ·ç«¯è¿›è¡Œå°è£…ï¼Œæä¾›æ›´æ˜“ç”¨çš„APIï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.otter.canal.protocol.CanalEntry;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * Canaläº‹ä»¶ç›‘å¬å™¨æ¥å£
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CanalEventListener</span> {

    <span class="hljs-comment">/**
     * å¤„ç†INSERTäº‹ä»¶
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">onInsert</span><span class="hljs-params">(String database, String table, List&lt;CanalEntry.Column&gt; data)</span>;

    <span class="hljs-comment">/**
     * å¤„ç†UPDATEäº‹ä»¶
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">onUpdate</span><span class="hljs-params">(String database, String table,
                  List&lt;CanalEntry.Column&gt; before,
                  List&lt;CanalEntry.Column&gt; after)</span>;

    <span class="hljs-comment">/**
     * å¤„ç†DELETEäº‹ä»¶
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDelete</span><span class="hljs-params">(String database, String table, List&lt;CanalEntry.Column&gt; data)</span>;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.otter.canal.client.CanalConnector;
<span class="hljs-keyword">import</span> com.alibaba.otter.canal.client.CanalConnectors;
<span class="hljs-keyword">import</span> com.alibaba.otter.canal.protocol.CanalEntry;
<span class="hljs-keyword">import</span> com.alibaba.otter.canal.protocol.Message;
<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;

<span class="hljs-keyword">import</span> java.net.InetSocketAddress;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-comment">/**
 * Canalå®¢æˆ·ç«¯å°è£…
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CanalClient</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(CanalClient.class);

    <span class="hljs-keyword">private</span> CanalConnector connector;
    <span class="hljs-keyword">private</span> String filter;
    <span class="hljs-keyword">private</span> CanalEventListener listener;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">running</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CanalClient</span><span class="hljs-params">(String host, <span class="hljs-type">int</span> port, String destination, String filter)</span> {
        <span class="hljs-built_in">this</span>.connector = CanalConnectors.newSingleConnector(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(host, port),
            destination,
            <span class="hljs-string">""</span>,
            <span class="hljs-string">""</span>
        );
        <span class="hljs-built_in">this</span>.filter = filter;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setListener</span><span class="hljs-params">(CanalEventListener listener)</span> {
        <span class="hljs-built_in">this</span>.listener = listener;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        connector.connect();
        connector.subscribe(filter);
        connector.rollback();

        running = <span class="hljs-literal">true</span>;

        <span class="hljs-comment">// å¯åŠ¨æ¶ˆè´¹çº¿ç¨‹</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">while</span> (running) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-type">Message</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> connector.getWithoutAck(<span class="hljs-number">100</span>);
                    <span class="hljs-type">long</span> <span class="hljs-variable">batchId</span> <span class="hljs-operator">=</span> message.getId();
                    <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> message.getEntries().size();

                    <span class="hljs-keyword">if</span> (batchId != -<span class="hljs-number">1</span> &amp;&amp; size &gt; <span class="hljs-number">0</span>) {
                        processEntries(message.getEntries());
                        connector.ack(batchId);
                    } <span class="hljs-keyword">else</span> {
                        TimeUnit.SECONDS.sleep(<span class="hljs-number">1</span>);
                    }
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    logger.error(<span class="hljs-string">"å¤„ç†Canalæ¶ˆæ¯å¼‚å¸¸"</span>, e);
                    connector.rollback();
                }
            }
        }, <span class="hljs-string">"canal-client-thread"</span>).start();

        logger.info(<span class="hljs-string">"Canalå®¢æˆ·ç«¯å¯åŠ¨æˆåŠŸ"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        running = <span class="hljs-literal">false</span>;
        connector.disconnect();
        logger.info(<span class="hljs-string">"Canalå®¢æˆ·ç«¯å·²åœæ­¢"</span>);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processEntries</span><span class="hljs-params">(List&lt;CanalEntry.Entry&gt; entries)</span> {
        <span class="hljs-keyword">for</span> (CanalEntry.Entry entry : entries) {
            <span class="hljs-keyword">if</span> (entry.getEntryType() != CanalEntry.EntryType.ROWDATA) {
                <span class="hljs-keyword">continue</span>;
            }

            <span class="hljs-keyword">try</span> {
                CanalEntry.<span class="hljs-type">RowChange</span> <span class="hljs-variable">rowChange</span> <span class="hljs-operator">=</span> CanalEntry.RowChange.parseFrom(entry.getStoreValue());
                <span class="hljs-type">String</span> <span class="hljs-variable">database</span> <span class="hljs-operator">=</span> entry.getHeader().getSchemaName();
                <span class="hljs-type">String</span> <span class="hljs-variable">table</span> <span class="hljs-operator">=</span> entry.getHeader().getTableName();
                CanalEntry.<span class="hljs-type">EventType</span> <span class="hljs-variable">eventType</span> <span class="hljs-operator">=</span> rowChange.getEventType();

                <span class="hljs-keyword">for</span> (CanalEntry.RowData rowData : rowChange.getRowDatasList()) {
                    <span class="hljs-keyword">if</span> (listener != <span class="hljs-literal">null</span>) {
                        <span class="hljs-keyword">switch</span> (eventType) {
                            <span class="hljs-keyword">case</span> INSERT:
                                listener.onInsert(database, table, rowData.getAfterColumnsList());
                                <span class="hljs-keyword">break</span>;
                            <span class="hljs-keyword">case</span> UPDATE:
                                listener.onUpdate(database, table,
                                    rowData.getBeforeColumnsList(),
                                    rowData.getAfterColumnsList());
                                <span class="hljs-keyword">break</span>;
                            <span class="hljs-keyword">case</span> DELETE:
                                listener.onDelete(database, table, rowData.getBeforeColumnsList());
                                <span class="hljs-keyword">break</span>;
                            <span class="hljs-keyword">default</span>:
                                <span class="hljs-keyword">break</span>;
                        }
                    }
                }
            } <span class="hljs-keyword">catch</span> (Exception e) {
                logger.error(<span class="hljs-string">"å¤„ç†Entryå¼‚å¸¸"</span>, e);
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-25">å…«ã€ç”Ÿäº§å®æˆ˜æ¡ˆä¾‹ï¼šRedisç¼“å­˜åŒæ­¥</h3>
<h4 data-id="heading-26">åœºæ™¯æè¿°</h4>
<p>ç”µå•†ç³»ç»Ÿä¸­ï¼Œå•†å“ä¿¡æ¯å­˜å‚¨åœ¨MySQLä¸­ï¼Œä¸ºäº†æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œåœ¨Redisä¸­ç¼“å­˜äº†å•†å“æ•°æ®ã€‚å½“å•†å“ä¿¡æ¯åœ¨MySQLä¸­æ›´æ–°æ—¶ï¼Œéœ€è¦å®æ—¶åŒæ­¥æ›´æ–°Redisç¼“å­˜ã€‚</p>
<h4 data-id="heading-27">å®ç°æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.otter.canal.protocol.CanalEntry;
<span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.JedisPool;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;

<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-comment">/**
 * å•†å“ç¼“å­˜åŒæ­¥ç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductCacheSyncListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CanalEventListener</span> {

    <span class="hljs-keyword">private</span> JedisPool jedisPool;
    <span class="hljs-keyword">private</span> <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">objectMapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ProductCacheSyncListener</span><span class="hljs-params">(JedisPool jedisPool)</span> {
        <span class="hljs-built_in">this</span>.jedisPool = jedisPool;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onInsert</span><span class="hljs-params">(String database, String table, List&lt;CanalEntry.Column&gt; data)</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"product"</span>.equals(table)) {
            syncToRedis(data, <span class="hljs-string">"INSERT"</span>);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onUpdate</span><span class="hljs-params">(String database, String table,
                        List&lt;CanalEntry.Column&gt; before,
                        List&lt;CanalEntry.Column&gt; after)</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"product"</span>.equals(table)) {
            syncToRedis(after, <span class="hljs-string">"UPDATE"</span>);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDelete</span><span class="hljs-params">(String database, String table, List&lt;CanalEntry.Column&gt; data)</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"product"</span>.equals(table)) {
            deleteFromRedis(data);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">syncToRedis</span><span class="hljs-params">(List&lt;CanalEntry.Column&gt; columns, String operation)</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> jedisPool.getResource()) {
            Map&lt;String, String&gt; productMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            <span class="hljs-type">String</span> <span class="hljs-variable">productId</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

            <span class="hljs-keyword">for</span> (CanalEntry.Column column : columns) {
                <span class="hljs-keyword">if</span> (<span class="hljs-string">"id"</span>.equals(column.getName())) {
                    productId = column.getValue();
                }
                productMap.put(column.getName(), column.getValue());
            }

            <span class="hljs-keyword">if</span> (productId != <span class="hljs-literal">null</span>) {
                <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + productId;
                <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> objectMapper.writeValueAsString(productMap);
                jedis.setex(key, <span class="hljs-number">3600</span>, value);

                System.out.println(String.format(<span class="hljs-string">"ç¼“å­˜åŒæ­¥æˆåŠŸ [%s]: %s"</span>, operation, key));
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            System.err.println(<span class="hljs-string">"åŒæ­¥åˆ°Rediså¤±è´¥: "</span> + e.getMessage());
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteFromRedis</span><span class="hljs-params">(List&lt;CanalEntry.Column&gt; columns)</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> jedisPool.getResource()) {
            <span class="hljs-keyword">for</span> (CanalEntry.Column column : columns) {
                <span class="hljs-keyword">if</span> (<span class="hljs-string">"id"</span>.equals(column.getName())) {
                    <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + column.getValue();
                    jedis.del(key);
                    System.out.println(<span class="hljs-string">"ç¼“å­˜åˆ é™¤æˆåŠŸ: "</span> + key);
                    <span class="hljs-keyword">break</span>;
                }
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            System.err.println(<span class="hljs-string">"ä»Redisåˆ é™¤å¤±è´¥: "</span> + e.getMessage());
        }
    }
}
</code></pre>
<h4 data-id="heading-28">å¯åŠ¨åº”ç”¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.JedisPool;
<span class="hljs-keyword">import</span> redis.clients.jedis.JedisPoolConfig;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheSyncApplication</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºRedisè¿æ¥æ± </span>
        <span class="hljs-type">JedisPoolConfig</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JedisPoolConfig</span>();
        config.setMaxTotal(<span class="hljs-number">100</span>);
        config.setMaxIdle(<span class="hljs-number">20</span>);
        <span class="hljs-type">JedisPool</span> <span class="hljs-variable">jedisPool</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JedisPool</span>(config, <span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>);

        <span class="hljs-comment">// åˆ›å»ºCanalå®¢æˆ·ç«¯</span>
        <span class="hljs-type">CanalClient</span> <span class="hljs-variable">canalClient</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CanalClient</span>(
            <span class="hljs-string">"localhost"</span>,
            <span class="hljs-number">11111</span>,
            <span class="hljs-string">"example"</span>,
            <span class="hljs-string">"test_db\\.product"</span>
        );

        <span class="hljs-comment">// è®¾ç½®ç›‘å¬å™¨</span>
        canalClient.setListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProductCacheSyncListener</span>(jedisPool));

        <span class="hljs-comment">// å¯åŠ¨</span>
        canalClient.start();

        <span class="hljs-comment">// æ·»åŠ å…³é—­é’©å­</span>
        Runtime.getRuntime().addShutdownHook(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            canalClient.stop();
            jedisPool.close();
        }));

        System.out.println(<span class="hljs-string">"å•†å“ç¼“å­˜åŒæ­¥æœåŠ¡å·²å¯åŠ¨..."</span>);
    }
}
</code></pre>
<h3 data-id="heading-29">ä¹ã€ä¸Spring Booté›†æˆ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/342063f3313045d68525769f774ca482~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766634294&amp;x-signature=%2BaKSCBcpQiucLl5ydsi9F1OGvJA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-30">9.1 æ·»åŠ ä¾èµ–</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.otter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>canal.client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h4 data-id="heading-31">9.2 é…ç½®æ–‡ä»¶</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
    <span class="hljs-attr">database:</span> <span class="hljs-number">0</span>

<span class="hljs-attr">canal:</span>
  <span class="hljs-attr">server:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">11111</span>
  <span class="hljs-attr">destination:</span> <span class="hljs-string">example</span>
  <span class="hljs-attr">filter:</span> <span class="hljs-string">test_db\\..*</span>
  <span class="hljs-attr">batch-size:</span> <span class="hljs-number">100</span>
</code></pre>
<h4 data-id="heading-32">9.3 Canalé…ç½®ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@ConfigurationProperties(prefix = "canal")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CanalProperties</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">Server</span> <span class="hljs-variable">server</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>();
    <span class="hljs-keyword">private</span> String destination;
    <span class="hljs-keyword">private</span> String filter;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">batchSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;

    <span class="hljs-comment">// Getters and Setters</span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Server</span> {
        <span class="hljs-keyword">private</span> String host;
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> port;

        <span class="hljs-comment">// Getters and Setters</span>
    }
}
</code></pre>
<h4 data-id="heading-33">9.4 Canalå¯åŠ¨å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.otter.canal.client.CanalConnector;
<span class="hljs-keyword">import</span> com.alibaba.otter.canal.client.CanalConnectors;
<span class="hljs-keyword">import</span> com.alibaba.otter.canal.protocol.Message;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.boot.CommandLineRunner;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-keyword">import</span> java.net.InetSocketAddress;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CanalStarter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CommandLineRunner</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> CanalProperties canalProperties;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> CanalEventListener canalEventListener;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(String... args)</span> {
        <span class="hljs-type">CanalConnector</span> <span class="hljs-variable">connector</span> <span class="hljs-operator">=</span> CanalConnectors.newSingleConnector(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(
                canalProperties.getServer().getHost(),
                canalProperties.getServer().getPort()
            ),
            canalProperties.getDestination(),
            <span class="hljs-string">""</span>,
            <span class="hljs-string">""</span>
        );

        connector.connect();
        connector.subscribe(canalProperties.getFilter());
        connector.rollback();

        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-type">Message</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> connector.getWithoutAck(canalProperties.getBatchSize());
                    <span class="hljs-type">long</span> <span class="hljs-variable">batchId</span> <span class="hljs-operator">=</span> message.getId();

                    <span class="hljs-keyword">if</span> (batchId != -<span class="hljs-number">1</span> &amp;&amp; !message.getEntries().isEmpty()) {
                        <span class="hljs-comment">// å¤„ç†æ¶ˆæ¯</span>
                        message.getEntries().forEach(entry -&gt; {
                            <span class="hljs-comment">// è°ƒç”¨ç›‘å¬å™¨å¤„ç†</span>
                        });
                        connector.ack(batchId);
                    } <span class="hljs-keyword">else</span> {
                        TimeUnit.SECONDS.sleep(<span class="hljs-number">1</span>);
                    }
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    e.printStackTrace();
                    connector.rollback();
                }
            }
        }).start();
    }
}
</code></pre>
<h3 data-id="heading-34">åã€ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13eca1eda7844339b875e12b3a92d559~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766634294&amp;x-signature=2BLYHduuGaDpBSrTWLAkBmyc53c%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-35">1. é«˜å¯ç”¨éƒ¨ç½²</h4>
<p>ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Canal HAæ¨¡å¼ï¼ŒåŸºäºZooKeeperå®ç°ï¼š</p>
<ul>
<li>éƒ¨ç½²å¤šä¸ªCanal Serverå®ä¾‹</li>
<li>ä½¿ç”¨ZooKeeperè¿›è¡Œåè°ƒå’Œfailover</li>
<li>å®¢æˆ·ç«¯è‡ªåŠ¨è¿æ¥åˆ°å¯ç”¨çš„Server</li>
</ul>
<h4 data-id="heading-36">2. æ€§èƒ½ä¼˜åŒ–</h4>
<p><strong>æ‰¹é‡æ¶ˆè´¹</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸€æ¬¡è·å–å¤šæ¡æ¶ˆæ¯ï¼Œæé«˜ååé‡</span>
<span class="hljs-type">Message</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> connector.getWithoutAck(<span class="hljs-number">1000</span>);
</code></pre>
<p><strong>å¹¶è¡Œå¤„ç†</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">10</span>);
message.getEntries().forEach(entry -&gt; {
    executor.submit(() -&gt; processEntry(entry));
});
</code></pre>
<p><strong>åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´</strong></p>
<pre><code class="hljs language-properties" lang="properties">canal.instance.network.receiveBufferSize = 16384
canal.instance.network.sendBufferSize = 16384
canal.instance.network.soTimeout = 30
</code></pre>
<h3 data-id="heading-37">åä¸€ã€æ€»ç»“</h3>
<p>Canalä½œä¸ºé˜¿é‡Œå¼€æºçš„MySQLå¢é‡æ•°æ®è®¢é˜…ç»„ä»¶ï¼Œå‡­å€Ÿå…¶é«˜æ€§èƒ½ã€ä½ä¾µå…¥ã€æ˜“æ‰©å±•çš„ç‰¹ç‚¹ï¼Œå·²ç»æˆä¸ºæ•°æ®åŒæ­¥é¢†åŸŸçš„æ ‡å‡†è§£å†³æ–¹æ¡ˆã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>æ•°æ®åº“å®æ—¶å¤‡ä»½</li>
<li>ç¼“å­˜å®æ—¶åŒæ­¥</li>
<li>æœç´¢å¼•æ“ç´¢å¼•æ„å»º</li>
<li>å®æ—¶æ•°æ®ä»“åº“</li>
<li>æ•°æ®å¼‚æ„è¿ç§»</li>
</ul>
<p>Canalè™½ç„¶å¼ºå¤§ï¼Œä½†å¹¶éé“¶å¼¹ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œéœ€è¦æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„binlogæ ¼å¼ã€éƒ¨ç½²æ¨¡å¼ã€æ¶ˆè´¹ç­–ç•¥ï¼Œå¹¶åšå¥½å¼‚å¸¸å¤„ç†å’Œç›‘æ§ï¼Œæ‰èƒ½çœŸæ­£å‘æŒ¥å…¶ä»·å€¼ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elasticsearchï¼šä½ æ˜¯è¯´ï¼Œç”¨äºæ··åˆæœç´¢ï¼ˆhybrid searchï¼‰]]></title>    <link>https://juejin.cn/post/7584729714340429843</link>    <guid>https://juejin.cn/post/7584729714340429843</guid>    <pubDate>2025-12-18T04:01:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584729714340429843" data-draft-id="7584740835368665142" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elasticsearchï¼šä½ æ˜¯è¯´ï¼Œç”¨äºæ··åˆæœç´¢ï¼ˆhybrid searchï¼‰"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2025-12-18T04:01:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elasticsearchï¼šä½ æ˜¯è¯´ï¼Œç”¨äºæ··åˆæœç´¢ï¼ˆhybrid searchï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:01:23.000Z" title="Thu Dec 18 2025 04:01:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ª ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.elastic.co%2Fu%2Fkathleen_derusso" title="https://discuss.elastic.co/u/kathleen_derusso" target="_blank" ref="nofollow noopener noreferrer">Kathleen_DeRusso</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f848c7ae42d440bbb38636244b5feba3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766635283&amp;x-signature=2Czmg77aZ%2FpcSf5m2V7CU8y4WZM%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ å°è¯•è¿‡æ­å»º <strong>æ··åˆæœç´¢ï¼ˆhybrid searchï¼‰</strong> ä½“éªŒï¼Œä½ å°±çŸ¥é“å­¦ä¹ æ›²çº¿å¯èƒ½å¾ˆé™¡å³­ã€‚å°¤å…¶æ˜¯å½“æ–‡æœ¬æœç´¢å’Œè¯­ä¹‰æœç´¢ç»“æœç»“åˆæ—¶ï¼Œæ¯ç§æœç´¢è¿”å›çš„å¾—åˆ†å¯èƒ½å·®å¼‚å¾ˆå¤§ï¼Œå¾ˆéš¾çŸ¥é“ä»å“ªé‡Œå¼€å§‹ï¼Œæ‰‹åŠ¨è°ƒä¼˜ç»“æœä¹Ÿå®¹æ˜“å‡ºé”™ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œæˆ‘ä»¬è®©è¿™ä¸ªè¿‡ç¨‹å˜å¾—ç®€å•å¾—å¤šã€‚</p>
<p>æœ¬æ–‡å°†ä¾§é‡äºå¾ˆå¤šé»˜è®¤è®¾ç½®ï¼Œä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå†…ç½®äº†å¤§é‡è‡ªå®šä¹‰åŠŸèƒ½ï¼Œå› æ­¤æ—¢æ”¯æŒç®€å•çš„ â€œé¡ºç•…è·¯å¾„â€ ç”¨ä¾‹ï¼Œä¹Ÿæ”¯æŒå¼ºå¤§ã€å¯å®šåˆ¶çš„ä¸“å®¶ç”¨ä¾‹ã€‚</p>
<h2 data-id="heading-0">ç´¢å¼•ä½ çš„æ•°æ®</h2>
<p>é¦–å…ˆï¼Œä» <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Felasticsearch%2Fmapping-reference%2Fsemantic-text" title="https://www.elastic.co/docs/reference/elasticsearch/mapping-reference/semantic-text" target="_blank" ref="nofollow noopener noreferrer">semantic_text</a></strong> å­—æ®µå¼€å§‹ã€‚Semantic text è®¾è®¡å¾—åƒä¸€ä¸ªæ™®é€šæ–‡æœ¬å­—æ®µä¸€æ ·ä½¿ç”¨ï¼Œä½†å®ƒä¼šé€æ˜åœ°å¤„ç†åˆ†å—ã€æ¨ç†å’Œè¯­ä¹‰æœç´¢ã€‚è‡³å°‘ï¼Œä½ åªéœ€è¦ä¸ºä½ çš„å­—æ®µåˆ›å»ºæ˜ å°„ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">`

<span class="hljs-bullet">1.</span>  PUT my-index
<span class="hljs-bullet">2.</span>  {
<span class="hljs-bullet">3.</span>    "mappings": {
<span class="hljs-bullet">4.</span>      "properties": {
<span class="hljs-bullet">5.</span>        "semantic<span class="hljs-emphasis">_title": {
6.          "type": "semantic_</span>text"
<span class="hljs-bullet">7.</span>        }
<span class="hljs-bullet">8.</span>      }
<span class="hljs-bullet">9.</span>    }
<span class="hljs-bullet">10.</span>  }

`AIå†™ä»£ç ![](<span class="hljs-link">https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png</span>)
</code></pre>
<p>è¿™ä¸ªæ˜ å°„ä¼šåˆ›å»ºé»˜è®¤è®¾ç½®ï¼Œä¾‹å¦‚é»˜è®¤ä½¿ç”¨æˆ‘ä»¬å†…éƒ¨çš„ ELSER æ¨¡å‹è¿›è¡Œæ¨ç†ã€‚æ— éœ€é…ç½®ç´¢å¼•ç®¡é“ï¼å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡å°è¯• <strong>semantic_text</strong>ï¼Œè¿™ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fsolutions%2Fsearch%2Fsemantic-search%2Fsemantic-search-semantic-text" title="https://www.elastic.co/docs/solutions/search/semantic-search/semantic-search-semantic-text" target="_blank" ref="nofollow noopener noreferrer">æ•™ç¨‹</a>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚</p>
<p>ä¸ºäº†ç¡®ä¿ <strong>semantic_text</strong> åƒæ™®é€šæ–‡æœ¬å­—æ®µä¸€æ ·å·¥ä½œï¼Œæˆ‘ä»¬å¢åŠ äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fblog%2Fsemantic-search-match-knn-sparse-vector" title="https://www.elastic.co/search-labs/blog/semantic-search-match-knn-sparse-vector" target="_blank" ref="nofollow noopener noreferrer">å¯¹åœ¨ semantic_text å­—æ®µä¸Šä½¿ç”¨ match æŸ¥è¯¢çš„æ”¯æŒ</a>ï¼Œè®©ä½ å¯ä»¥é€æ˜åœ°è¿›è¡Œè¯­ä¹‰æœç´¢ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  POST my-index/_search
2.  {
3.    <span class="hljs-string">"query"</span>: {
4.      <span class="hljs-string">"match"</span>: {
5.        <span class="hljs-string">"semantic_title"</span>: <span class="hljs-string">"What is semantic search?"</span>
6.      }
7.    }
8.  }

`AIå†™ä»£ç 
</code></pre>
<h2 data-id="heading-1">ä½¿ç”¨æ£€ç´¢å™¨è¿›è¡Œæ··åˆæœç´¢</h2>
<p>æˆ‘ä»¬åœ¨å¾ˆå¤šæœç´¢ç”¨ä¾‹ä¸­å‘ç°ï¼Œ<strong>match</strong> æŸ¥è¯¢åŠå…¶ç›¸å…³æƒé‡å·²ç»èƒ½å¾ˆå¥½åœ°æ»¡è¶³éœ€æ±‚ã€‚è™½ç„¶æ£€ç´¢å™¨ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Felasticsearch%2Frest-apis%2Fretrievers" title="https://www.elastic.co/docs/reference/elasticsearch/rest-apis/retrievers" target="_blank" ref="nofollow noopener noreferrer">retrievers</a>ï¼‰å·²ç»å­˜åœ¨ä¸€æ®µæ—¶é—´ï¼Œæä¾›äº†åƒ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Felasticsearch%2Frest-apis%2Freciprocal-rank-fusion" title="https://www.elastic.co/docs/reference/elasticsearch/rest-apis/reciprocal-rank-fusion" target="_blank" ref="nofollow noopener noreferrer">RRF</a></strong> è¿™æ ·çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ç®€åŒ–äº†è¯­æ³•ï¼Œä½¿å…¶å¯ä»¥æ— ç¼åœ°ä¸ä»»æ„ç»„åˆçš„ <strong>text</strong> å’Œ <strong>semantic_text</strong> å­—æ®µä¸€èµ·ä½¿ç”¨ï¼Œå¹¶è‡ªåŠ¨å®Œæˆå¾—åˆ†ç»„åˆå’Œå½’ä¸€åŒ–ã€‚</p>
<p>ä½ å¯ä»¥é˜…è¯»è¿™ç¯‡<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F155335155" title="https://elasticstack.blog.csdn.net/article/details/155335155" target="_blank" ref="nofollow noopener noreferrer">åšå®¢</a>ï¼Œäº†è§£è¿™ç§<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Felasticsearch%2Frest-apis%2Fretrievers%2Fretrievers-examples%23retrievers-examples-rrf-multi-field-query-format" title="https://www.elastic.co/docs/reference/elasticsearch/rest-apis/retrievers/retrievers-examples#retrievers-examples-rrf-multi-field-query-format" target="_blank" ref="nofollow noopener noreferrer">è¯­æ³•ç³–</a>çš„ç”±æ¥ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨ <strong>RRF</strong> è¿›è¡Œæ··åˆæœç´¢çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  GET my-index/_search
2.  {
3.    <span class="hljs-string">"retriever"</span>: {
4.      <span class="hljs-string">"rrf"</span>: {
5.        <span class="hljs-string">"fields"</span>: [<span class="hljs-string">"title"</span>, <span class="hljs-string">"semantic_title"</span>],
6.        <span class="hljs-string">"query"</span>: <span class="hljs-string">"What is semantic search?"</span>
7.      }
8.    }
9.  }

`AIå†™ä»£ç 
</code></pre>
<p>ä»¥åŠä½¿ç”¨ <strong>linear retriever</strong> çš„ç±»ä¼¼ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  GET my-index/_search{
2.    <span class="hljs-string">"retriever"</span>: {
3.      <span class="hljs-string">"linear"</span>: {
4.        <span class="hljs-string">"fields"</span>: [<span class="hljs-string">"title"</span>, <span class="hljs-string">"semantic_title^2"</span>],
5.        <span class="hljs-string">"query"</span>: <span class="hljs-string">"What is semantic search?"</span>,
6.        â€œnormalizerâ€: â€œl2_normâ€
7.      }
8.    }
9.  }

`AIå†™ä»£ç 
</code></pre>
<p>è¿™äº›å¯ä»¥ç›´æ¥æ¥å…¥åƒ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Felasticsearch%2Frest-apis%2Fretrievers%2Ftext-similarity-reranker-retriever" title="https://www.elastic.co/docs/reference/elasticsearch/rest-apis/retrievers/text-similarity-reranker-retriever" target="_blank" ref="nofollow noopener noreferrer">text_similarity_reranker retriever</a></strong> è¿™æ ·çš„æ£€ç´¢å™¨ï¼Œä»è€Œå¯¹æ··åˆæœç´¢ç»“æœè¿›è¡Œè¯­ä¹‰é‡æ’åºã€‚å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿ</p>
<h2 data-id="heading-2">ä½¿ç”¨ ES|QL è¿›è¡Œæ··åˆæœç´¢</h2>
<p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨å¼€å‘çš„ä¸€äº›æœ€ä»¤äººå…´å¥‹çš„åŠŸèƒ½ï¼Œæ˜¯ä½¿ç”¨æˆ‘ä»¬æ–°çš„ç®¡é“æŸ¥è¯¢è¯­è¨€ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Fquery-languages%2Fesql" title="https://www.elastic.co/docs/reference/query-languages/esql" target="_blank" ref="nofollow noopener noreferrer">ES|QL</a></strong>ï¼Œå®ƒå¯¹äºæ··åˆæœç´¢ç”¨ä¾‹éå¸¸å¼ºå¤§ã€‚å¦‚æœä½ å‚åŠ è¿‡ä»Šå¹´çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fevents%2Felasticon" title="https://www.elastic.co/events/elasticon" target="_blank" ref="nofollow noopener noreferrer">Elastic{ON}</a> æ´»åŠ¨ï¼Œè¿™ä¸ªé¢„è§ˆå¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹ç†Ÿæ‚‰ã€‚</p>
<p>è®©æˆ‘ä»¬ä» <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Fquery-languages%2Fesql%2Ffunctions-operators%2Fsearch-functions" title="https://www.elastic.co/docs/reference/query-languages/esql/functions-operators/search-functions" target="_blank" ref="nofollow noopener noreferrer">match</a></strong> å‡½æ•°å¼€å§‹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æ¥å¼•ç”¨ <strong>match</strong> æ¥è¡¨ç¤ºï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  <span class="hljs-keyword">FROM</span> my<span class="hljs-operator">-</span>index METADATA _score
<span class="hljs-number">2.</span>  <span class="hljs-operator">|</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">match</span>(title, "What is semantic search?")
<span class="hljs-number">3.</span>  <span class="hljs-operator">|</span> SORT _score <span class="hljs-keyword">DESC</span>

`AIå†™ä»£ç 
</code></pre>
<p>æˆ–è€…é€šè¿‡ç®€å†™è¯­æ³•ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  <span class="hljs-keyword">FROM</span> my<span class="hljs-operator">-</span>index METADATA _score
<span class="hljs-number">2.</span>  <span class="hljs-operator">|</span> <span class="hljs-keyword">WHERE</span> title:"What is semantic search?"
<span class="hljs-number">3.</span>  <span class="hljs-operator">|</span> SORT _score <span class="hljs-keyword">DESC</span>

`AIå†™ä»£ç 
</code></pre>
<p>æœ€æ£’çš„æ˜¯ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ <strong>match</strong>ï¼Œå°±åƒåœ¨ DSL ä¸­ä¸€æ ·ï¼Œ<strong>semantic_text</strong> å¼€ç®±å³ç”¨ï¼</p>
<p>ç°åœ¨ï¼Œå½“ä½ æƒ³ä½¿ç”¨ <strong>semantic_text</strong> ç»„åˆç»“æœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Fquery-languages%2Fesql%2Fcommands%2Ffork" title="https://www.elastic.co/docs/reference/query-languages/esql/commands/fork" target="_blank" ref="nofollow noopener noreferrer">FORK</a></strong> å‘½ä»¤ï¼Œåœ¨ä¸åŒçš„åˆ†æ”¯ä¸­æ‰§è¡Œæ¯ä¸ª match æŸ¥è¯¢ï¼Œå¹¶å°†å®ƒä»¬è¿”å›åœ¨åŒä¸€ä¸ªç»“æœä¸­ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  <span class="hljs-keyword">FROM</span> my<span class="hljs-operator">-</span>index METADATA _score
<span class="hljs-number">2.</span>  <span class="hljs-operator">|</span> FORK 
<span class="hljs-number">3.</span>    (<span class="hljs-keyword">WHERE</span> semantic_title: "What is semantic search?" <span class="hljs-operator">|</span> SORT _score <span class="hljs-keyword">DESC</span>)
<span class="hljs-number">4.</span>    (<span class="hljs-keyword">WHERE</span> title:"What is semantic search?" <span class="hljs-operator">|</span> SORT _score <span class="hljs-keyword">DESC</span>)

`AIå†™ä»£ç 
</code></pre>
<p>ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨ <strong>FUSE</strong> å‘½ä»¤ï¼Œä½¿ç”¨ <strong>RRF</strong> ç®—æ³•å°†è¿™äº›ç»“æœåˆå¹¶ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  <span class="hljs-keyword">FROM</span> my<span class="hljs-operator">-</span>index METADATA _score
<span class="hljs-number">2.</span>  <span class="hljs-operator">|</span> FORK 
<span class="hljs-number">3.</span>    (<span class="hljs-keyword">WHERE</span> semantic_title: "What is semantic search?" <span class="hljs-operator">|</span> SORT _score <span class="hljs-keyword">DESC</span>)
<span class="hljs-number">4.</span>    (<span class="hljs-keyword">WHERE</span> title:"What is semantic search?" <span class="hljs-operator">|</span> SORT _score <span class="hljs-keyword">DESC</span>)
<span class="hljs-number">5.</span>  <span class="hljs-operator">|</span> FUSE
<span class="hljs-number">6.</span>  <span class="hljs-operator">|</span> SORT _score <span class="hljs-keyword">DESC</span>

`AIå†™ä»£ç 
</code></pre>
<p>ä½ ä¹Ÿå¯ä»¥å°†å…¶åº”ç”¨åˆ°å…¶ä»–ç”¨ä¾‹ï¼Œä¾‹å¦‚é‡æ’åºï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Fquery-languages%2Fesql%2Fcommands%2Frerank" title="https://www.elastic.co/docs/reference/query-languages/esql/commands/rerank" target="_blank" ref="nofollow noopener noreferrer">rerank</a>ï¼‰å’Œè¡¥å…¨ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Fquery-languages%2Fesql%2Fcommands%2Fcompletion" title="https://www.elastic.co/docs/reference/query-languages/esql/commands/completion" target="_blank" ref="nofollow noopener noreferrer">completion</a>ï¼‰ã€‚</p>
<p>æœ€åï¼Œæœ‰æ—¶ä½ çš„ç”¨ä¾‹å¯èƒ½æ›´é€‚åˆä»…æ‰§è¡Œè¯æ±‡æœç´¢ï¼Œè€Œä¸æ˜¯è¯­ä¹‰æœç´¢ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æŸ¥è¯¢æ—¶ä½¿ç”¨ <strong>fork</strong> æ¥å†³å®šæ‰§è¡Œè¯æ±‡æœç´¢è¿˜æ˜¯è¯­ä¹‰æœç´¢ â€”â€” ä¾‹å¦‚æ ¹æ®æŸ¥è¯¢ä¸­çš„è¯æ•°ï¼Œè¾ƒçŸ­çš„æŸ¥è¯¢åœ¨æŸäº›ç”¨ä¾‹ä¸­å¯èƒ½ä»è¯­ä¹‰æœç´¢ä¸­è·ç›Šä¸å¤§ã€‚</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">search</span><span class="hljs-operator">-</span>index METADATA _score
<span class="hljs-number">2.</span>  <span class="hljs-operator">|</span> EVAL lexical <span class="hljs-operator">=</span> MV_COUNT(SPLIT(?query, " ")) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">3</span>
<span class="hljs-number">3.</span>  <span class="hljs-operator">|</span> FORK ( <span class="hljs-keyword">WHERE</span> lexical <span class="hljs-operator">|</span> <span class="hljs-keyword">WHERE</span> title:?query )
<span class="hljs-number">4.</span>         ( <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> lexical <span class="hljs-operator">|</span> <span class="hljs-keyword">WHERE</span> semantic_title:?query )
<span class="hljs-number">5.</span>  <span class="hljs-operator">|</span> SORT _score <span class="hljs-keyword">DESC</span>

`AIå†™ä»£ç 
</code></pre>
<p>è¿™åªæ˜¯æˆ‘ä»¬èƒ½åšçš„ä¸€ä¸ªç®€çŸ­ç¤ºä¾‹ï¼Œä½†å¦‚æœä½ æ·±å…¥é˜…è¯»æˆ‘ä»¬çš„æ–‡æ¡£ï¼Œä½ ä¼šå‘ç°è¿™äº›åŠŸèƒ½åŒæ ·éå¸¸å¼ºå¤§ä¸”å¯å®šåˆ¶ï¼è¯•ä¸€è¯•å§ï¼Œæˆ‘ä»¬æœŸå¾…å¬åˆ°ä½ çš„åé¦ˆï¼</p>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.elastic.co%2Ft%2Fdec-5th-2025-en-you-know-for-hybrid-search%2F383218" title="https://discuss.elastic.co/t/dec-5th-2025-en-you-know-for-hybrid-search/383218" target="_blank" ref="nofollow noopener noreferrer">discuss.elastic.co/t/dec-5th-2â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Day32 | Java Streamæµå¼ç¼–ç¨‹è¯¦è§£]]></title>    <link>https://juejin.cn/post/7584758215700365350</link>    <guid>https://juejin.cn/post/7584758215700365350</guid>    <pubDate>2025-12-18T04:48:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584758215700365350" data-draft-id="7584742635502452763" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Day32 | Java Streamæµå¼ç¼–ç¨‹è¯¦è§£"/> <meta itemprop="keywords" content="åç«¯,Java,Java EE"/> <meta itemprop="datePublished" content="2025-12-18T04:48:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‡’æƒ°èœ—ç‰›"/> <meta itemprop="url" content="https://juejin.cn/user/615342556327752"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Day32 | Java Streamæµå¼ç¼–ç¨‹è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/615342556327752/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‡’æƒ°èœ—ç‰›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:48:13.000Z" title="Thu Dec 18 2025 04:48:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Java8ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬è¦å¤„ç†é›†åˆæ•°æ®é€šä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨forå¾ªç¯ã€whileå¾ªç¯å’Œè¿­ä»£å™¨ã€‚</p>
<p>è¿™ç§æ–¹å¼æˆ‘ä»¬å¯ä»¥å«ä»–å‘½ä»¤å¼ç¼–ç¨‹ï¼Œè¦æ˜ç¡®çš„å‘Šè¯‰ç¨‹åºæ€ä¹ˆåšï¼Œæ¯ä¸€æ­¥éƒ½è¦è‡ªå·±å®ç°ã€‚</p>
<p>è¿™æ˜¯Java8ä¹‹å‰çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day32;

<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.Collections;
<span class="hljs-keyword">import</span> java.util.Comparator;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> Day32Demo
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/7/14 11:30
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Day32Demo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;Transaction&gt; transactions = getTransactions();
        List&lt;Transaction&gt; filteredTransactions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (Transaction t : transactions) {
            <span class="hljs-keyword">if</span> (t.getValue() &gt; <span class="hljs-number">500</span>) {
                filteredTransactions.add(t);
            }
        }
        Collections.sort(filteredTransactions, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>&lt;Transaction&gt;() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(Transaction t1, Transaction t2)</span> {
                <span class="hljs-keyword">return</span> Double.compare(t2.getValue(), t1.getValue());
            }
        });
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Transaction&gt; <span class="hljs-title function_">getTransactions</span><span class="hljs-params">()</span> {
        List&lt;Transaction&gt; transactions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        transactions.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-number">450.0</span>));
        transactions.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-number">1200.50</span>));
        transactions.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-number">300.0</span>));
        transactions.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-number">890.75</span>));
        transactions.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-number">500.0</span>));
        transactions.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-number">620.0</span>));
        <span class="hljs-keyword">return</span> transactions;
    }

}
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Transaction</span> {
    <span class="hljs-type">double</span> value;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Transaction</span><span class="hljs-params">(<span class="hljs-type">double</span> value)</span> {
        <span class="hljs-built_in">this</span>.value = value;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> value;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setValue</span><span class="hljs-params">(<span class="hljs-type">double</span> value)</span> {
        <span class="hljs-built_in">this</span>.value = value;
    }
}
</code></pre>
<p>ä»äº¤æ˜“æ•°æ®åˆ—è¡¨ä¸­ç­›é€‰å‡ºä»·æ ¼å¤§äº500çš„äº¤æ˜“ï¼Œå¹¶æŒ‰é‡‘é¢æ’åºã€‚</p>
<p>ç­›é€‰å’Œæ’åºçš„é€»è¾‘éƒ½è¦ä¸€æ­¥æ­¥çš„å†™å‡ºæ¥ã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;Transaction&gt; sortedTransactions = transactions.stream()
    .filter(t -&gt; t.getValue() &gt; <span class="hljs-number">500</span>)
    .sorted(Comparator.comparing(Transaction::getValue).reversed())
    .toList();
</code></pre>
<p>ç°åœ¨ç”¨Streamæ–¹å¼ç›´æ¥è¿‡æ»¤æ’åºã€‚</p>
<p>Streamç”¨èµ·æ¥å°±åƒå¤„ç†æ•°æ®çš„å·¥å‚æµæ°´çº¿ï¼Œæ•°æ®åœ¨æµæ°´çº¿ä¸Šç»è¿‡ä¸€é“é“å·¥åºï¼ˆè¿‡æ»¤ã€æ˜ å°„ã€æ’åºç­‰ï¼‰ï¼Œæœ€ç»ˆäº§å‡ºæˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯Streamï¼Ÿ</h2>
<p>é¦–å…ˆï¼Œè¦æ˜ç¡®Streamä¸æ˜¯ä¸€ç§æ•°æ®ç»“æ„ã€‚å®ƒæ›´åƒä¸€ä¸ªé«˜çº§è¿­ä»£å™¨ï¼Œä»ä¸€ä¸ªæ•°æ®æºï¼ˆå¦‚é›†åˆã€æ•°ç»„ï¼‰è·å–å…ƒç´ ï¼Œå¹¶æ”¯æŒå¤æ‚çš„èšåˆæ“ä½œã€‚</p>
<p>ä»–æœ‰å‡ ä¸ªæ ¸å¿ƒçš„ç‰¹æ€§ï¼š</p>
<p>ä¸å­˜å‚¨æ•°æ®ï¼šæµæœ¬èº«ä¸å­˜å‚¨ä»»ä½•å…ƒç´ ã€‚å…ƒç´ å­˜å‚¨åœ¨åº•å±‚çš„æ•°æ®æºé‡Œã€‚</p>
<p>å‡½æ•°å¼æœ¬è´¨ï¼šå¯¹æµçš„æ“ä½œä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æµï¼Œè€Œä¸ä¼šä¿®æ”¹å®ƒåŸå§‹æ•°æ®æºã€‚æ¯”å¦‚filteræ“ä½œä¼šç”Ÿæˆä¸€ä¸ªåªåŒ…å«ç¬¦åˆæ¡ä»¶å…ƒç´ çš„æ–°æµã€‚</p>
<p>æƒ°æ€§æ±‚å€¼ï¼šæµçš„ä¸­é—´æ“ä½œï¼ˆæ¯”å¦‚å¦‚filter, mapï¼‰å¹¶ä¸ä¼šé©¬ä¸Šæ‰§è¡Œã€‚å®ƒä»¬åªæœ‰åœ¨é‡åˆ°ç»ˆç«¯æ“ä½œï¼ˆåƒforEach, collectï¼‰çš„æ—¶å€™ï¼Œæ‰ä¼šä¸€æ¬¡æ€§åœ°ã€ä»å¤´åˆ°å°¾åœ°æ‰§è¡Œæ•´ä¸ªæ“ä½œé“¾ã€‚</p>
<p>åªèƒ½æ¶ˆè´¹ä¸€æ¬¡ï¼šä¸€ä¸ªæµä¸€æ—¦è¢«ç»ˆç«¯æ“ä½œæ¶ˆè´¹è¿‡ï¼Œå°±ä¸èƒ½å†è¢«ä½¿ç”¨ã€‚å¦‚æœéœ€è¦å†æ¬¡å¤„ç†ï¼Œå¿…é¡»ä»æ•°æ®æºé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„æµã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day32;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.stream.Stream;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> Day32Demo2
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/7/14 14:02
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Day32Demo2</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;String&gt; list = List.of(<span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);
        Stream&lt;String&gt; stream = list.stream();
        stream.forEach(System.out::println);
        stream.forEach(System.out::println);
    }
}
</code></pre>
<p>å†æ¬¡æ¶ˆè´¹çš„æ—¶å€™å°±æŠ›å‡ºå¼‚å¸¸äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b63d1309c2134215965bbd9095ea6939~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oeS5oOw6JyX54mb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766638092&amp;x-signature=c97RrCntr6M54gEwXDqyAusWI6o%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€Streamçš„ç”Ÿå‘½å‘¨æœŸ</h2>
<p>ä¸€ä¸ªå®Œæ•´çš„Streamæ“ä½œé€šå¸¸åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šåˆ›å»º -&gt; ä¸­é—´æ“ä½œ -&gt; ç»ˆç«¯æ“ä½œã€‚</p>
<h3 data-id="heading-2">2.1åˆ›å»ºæµ</h3>
<p>å¯ä»¥ä»å¤šç§æ•°æ®æºåˆ›å»ºæµï¼š</p>
<p>ä»é›†åˆåˆ›å»º: list.stream(), set.parallelStream() (å¹¶è¡Œæµ)</p>
<p>ä»æ•°ç»„åˆ›å»º: Arrays.stream(array)</p>
<p>ç”±å€¼åˆ›å»º: Stream.of("a", "b", "c")</p>
<p>ç”±å‡½æ•°åˆ›å»ºï¼ˆæ— é™æµï¼‰:</p>
<p>Stream.iterate(T seed, UnaryOperator&lt;T&gt; f): ä»ä¸€ä¸ªç§å­å€¼å¼€å§‹ï¼Œä¸æ–­åº”ç”¨å‡½æ•°fã€‚</p>
<p>Stream.generate(Supplier&lt;T&gt; s): ä¸æ–­è°ƒç”¨get()æ–¹æ³•æ¥ç”Ÿæˆå…ƒç´ ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day32;

<span class="hljs-keyword">import</span> java.util.Arrays;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.stream.Stream;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> Day32Demo3
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/7/14 14:08
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Day32Demo3</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// ä»é›†åˆåˆ›å»º</span>
        List&lt;String&gt; names = List.of(<span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnail"</span>);
        Stream&lt;String&gt; nameStream = names.stream();

        <span class="hljs-comment">// ä»æ•°ç»„åˆ›å»º</span>
        String[] array = {<span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>};
        Stream&lt;String&gt; arrayStream = Arrays.stream(array);

        <span class="hljs-comment">// ç”±å€¼åˆ›å»º</span>
        Stream&lt;Integer&gt; numberStream = Stream.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);

        <span class="hljs-comment">// iterate åˆ›å»ºæ— é™æµ: 0, 2, 4, 6... (éœ€è¦é…åˆlimitä½¿ç”¨)</span>
        Stream&lt;Integer&gt; infiniteStream = Stream.iterate(<span class="hljs-number">0</span>, n -&gt; n + <span class="hljs-number">2</span>);
    }
}
</code></pre>
<h3 data-id="heading-3">2.2ä¸­é—´æ“ä½œ</h3>
<p>ä¸­é—´æ“ä½œæ˜¯æµæ°´çº¿ä¸Šçš„åŠ å·¥ç«™ï¼Œæ¯ä¸ªæ“ä½œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æµï¼Œå¯ä»¥é“¾å¼è°ƒç”¨ã€‚</p>
<p>å¸¸è§çš„ä¸­é—´æ“ä½œï¼š</p>
<p>è¿™ä¸ªä½œä¸ºè¢«æ“ä½œæ•°æ®æº</p>
<pre><code class="hljs language-java" lang="java">List&lt;Integer&gt; numbers = List.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>);
</code></pre>
<p>ç­›é€‰ä¸åˆ‡ç‰‡</p>
<p>filter(Predicate&lt;T&gt; p): è¿‡æ»¤å‡ºæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚</p>
<p>ç­›é€‰å‡ºæ‰€æœ‰çš„å¶æ•°</p>
<pre><code class="hljs language-java" lang="java">List&lt;Integer&gt; evenNumbers = numbers.stream()
                .filter(n -&gt; n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)
                .toList();
</code></pre>
<p>distinct(): å»é™¤é‡å¤å…ƒç´ ï¼ˆåŸºäºequals()æ–¹æ³•ï¼‰ã€‚</p>
<p>å–å‡ºé‡å¤æ•°å­—</p>
<pre><code class="hljs language-java" lang="java">List&lt;Integer&gt; distinctNumbers = numbers.stream()
                .distinct()
                .toList();
</code></pre>
<p>limit(long n): æˆªæ–­æµï¼Œä½¿å…¶å…ƒç´ ä¸è¶…è¿‡ç»™å®šæ•°é‡ã€‚</p>
<p>skip(long n): è·³è¿‡å‰nä¸ªå…ƒç´ ã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;Integer&gt; result = numbers.stream()
                .filter(n -&gt; n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) 
                .distinct()             
                .skip(<span class="hljs-number">1</span>)               
                .limit(<span class="hljs-number">2</span>)               
                .toList();
</code></pre>
<p>ç»“åˆä¸Šé¢å››ä¸ªæ“ä½œï¼Œç­›é€‰å¶æ•° -&gt; å»é‡ -&gt; è·³è¿‡ç¬¬1ä¸ª -&gt; å–å‰2ä¸ª</p>
<p>æ˜ å°„</p>
<p>map(Function&lt;T, R&gt; f): å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºå¦ä¸€ä¸ªå…ƒç´ ã€‚</p>
<p>æŠŠæ¯ä¸ªå•è¯éƒ½è½¬æ¢æˆå¤§å†™ï¼Œæˆ–è€…è·å–é•¿åº¦ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day32;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> Day32Demo4
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/7/14 14:19
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Day32Demo4</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;String&gt; words = List.of(<span class="hljs-string">"lazy"</span>, <span class="hljs-string">"snail"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);

        List&lt;String&gt; upperCaseWords = words.stream()
                .map(String::toUpperCase)
                .toList();
        System.out.println(<span class="hljs-string">"å¤§å†™å•è¯: "</span> + upperCaseWords);

        List&lt;Integer&gt; wordLengths = words.stream()
                .map(String::length)
                .toList();
        System.out.println(<span class="hljs-string">"å•è¯é•¿åº¦: "</span> + wordLengths);
    }
}
</code></pre>
<p>flatMap(Function&lt;T, Stream&lt;R&gt;&gt; f): å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºä¸€ä¸ªæµï¼Œç„¶åå°†æ‰€æœ‰æµè¿æ¥æˆä¸€ä¸ªæµï¼ˆæ‰å¹³åŒ–ï¼‰ã€‚</p>
<p>æŠŠä¸€ä¸ªåŒ…å«å¤šä¸ªåˆ—è¡¨çš„åˆ—è¡¨ï¼Œå‹å¹³æˆä¸€ä¸ªå•ä¸€çš„åˆ—è¡¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day32;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> Day32Demo5
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/7/14 14:22
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Day32Demo5</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;List&lt;Integer&gt;&gt; listOfLists = List.of(
                List.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>),
                List.of(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)
        );

        List&lt;Integer&gt; flatList = listOfLists.stream()
                .flatMap(list -&gt; list.stream())
                .toList();

        System.out.println(<span class="hljs-string">"æ‰å¹³åŒ–åçš„åˆ—è¡¨: "</span> + flatList);
    }
}
</code></pre>
<p>listOfListsæ˜¯ä¸¤ä¸ªåˆ—è¡¨çš„åˆ—è¡¨ï¼Œæ¯ä¸ªlistå…ƒç´ è¢«è½¬æ¢æˆä¸€ä¸ªæ–°çš„streamï¼ŒflatMapæŠŠè¿™äº›streamè¿æ¥æˆä¸€ä¸ªã€‚</p>
<p>mapMulti(BiConsumer&lt;T, Consumer&lt;R&gt;&gt; mapper): (JDK 16+) flatMapçš„æ›¿ä»£æ–¹æ¡ˆï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹æ›´é«˜æ•ˆã€‚å®ƒå°†æ¯ä¸ªå…ƒç´ æ›¿æ¢ä¸ºé›¶ä¸ªæˆ–å¤šä¸ªå…ƒç´ ã€‚</p>
<p>æŸäº›åœºæ™¯ä¸‹ï¼Œè¦ä½¿ç”¨åˆ°mapMultiï¼Œè¦ç¨å¾®æ¯”flatMapæ›´çµæ´»ä¸€ç‚¹ã€‚</p>
<p>æ¯”å¦‚ï¼ŒæŠŠæ¯ä¸ªå•è¯åŒæ—¶è½¬æ¢æˆå¤§å†™å’Œå°å†™ï¼Œç„¶åæ”¾åˆ°åŒä¸€ä¸ªè¾“å‡ºæµé‡Œã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day32;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> Day32Demo6
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/7/14 14:27
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Day32Demo6</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;String&gt; words = List.of(<span class="hljs-string">"lazy"</span>, <span class="hljs-string">"snail"</span>, <span class="hljs-string">"lazysnail"</span>);

        List&lt;String&gt; result = words.stream()
                .&lt;String&gt;mapMulti((word, consumer) -&gt; {
                    consumer.accept(word.toUpperCase());
                    consumer.accept(word.toLowerCase());
                })
                .toList();

        System.out.println(<span class="hljs-string">"ç»“æœ: "</span> + result);
    }
}
</code></pre>
<p>å¯¹æ¯ä¸ªå•è¯ï¼Œç”Ÿæˆä¸€ä¸ªå¤§å†™å’Œä¸€ä¸ªå°å†™ç‰ˆæœ¬ã€‚</p>
<p>æ’åº</p>
<p>ä»¥è¿™ä¸ªä½œä¸ºæ•°æ®æºï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; names = List.of(<span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnailstudio"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);
</code></pre>
<p>sorted(): æŒ‰è‡ªç„¶é¡ºåºæ’åºã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; sortedNames = names.stream()
                .sorted()
                .toList();
        
System.out.println(<span class="hljs-string">"æŒ‰è‡ªç„¶é¡ºåºæ’åº: "</span> + sortedNames);
</code></pre>
<p>sorted(Comparator&lt;T&gt; c): æŒ‰è‡ªå®šä¹‰æ¯”è¾ƒå™¨æ’åºã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; sortedByLength = names.stream()
                .sorted(Comparator.comparingInt(String::length))
                .toList();
        
System.out.println(<span class="hljs-string">"æŒ‰é•¿åº¦æ’åº: "</span> + sortedByLength);

List&lt;String&gt; sortedByLengthDesc = names.stream()
                .sorted(Comparator.comparingInt(String::length).reversed())
                .toList();
                
System.out.println(<span class="hljs-string">"æŒ‰é•¿åº¦é™åºæ’åº: "</span> + sortedByLengthDesc);
</code></pre>
<h3 data-id="heading-4">2.3ç»ˆç«¯æ“ä½œ</h3>
<p>ç»ˆç«¯æ“ä½œæ˜¯æµæ°´çº¿çš„æ‰“åŒ…ç«™ï¼Œå®ƒä¼šè§¦å‘æ‰€æœ‰æƒ°æ€§æ“ä½œçš„æ‰§è¡Œï¼Œå¹¶å…³é—­æµã€‚</p>
<p>å¸¸ç”¨çš„ç»ˆç«¯æ“ä½œï¼š</p>
<p>å¾ªç¯ï¼š</p>
<p>forEach(Consumer&lt;T&gt; c)</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; names = List.of(<span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);
names.stream().forEach(System.out::println);
</code></pre>
<p>åŒ¹é…ï¼š</p>
<p>anyMatch(Predicate&lt;T&gt; p): æ˜¯å¦æœ‰è‡³å°‘ä¸€ä¸ªå…ƒç´ åŒ¹é…ã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; names = List.of(<span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);
System.out.println(names.stream().anyMatch(<span class="hljs-string">"lazysnail"</span>::equals));
</code></pre>
<p>allMatch(Predicate&lt;T&gt; p): æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½åŒ¹é…ã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; names = List.of(<span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);
System.out.println(names.stream().allMatch(<span class="hljs-string">"lazysnail"</span>::equals));
</code></pre>
<p>noneMatch(Predicate&lt;T&gt; p): æ˜¯å¦æ²¡æœ‰å…ƒç´ åŒ¹é…ã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; names = List.of(<span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);
System.out.println(names.stream().noneMatch(<span class="hljs-string">"lazysnail"</span>::equals));
</code></pre>
<p>æŸ¥æ‰¾ï¼š</p>
<p>findFirst(): è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆOptional&lt;T&gt;ï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; names = List.of(<span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);
        Optional&lt;String&gt; firstMatch = names.stream()
                .filter(name -&gt; name.contains(<span class="hljs-string">"snail"</span>))
                .findFirst();
        firstMatch.ifPresentOrElse(
            foundName -&gt; System.out.println(<span class="hljs-string">"æ‰¾åˆ°äº†ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹: "</span> + foundName),
            () -&gt; System.out.println(<span class="hljs-string">"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•åŒ¹é…é¡¹ã€‚"</span>)
        );
</code></pre>
<p>é€šè¿‡findFirstæ–¹æ³•æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ…å«snailçš„å­—ç¬¦ä¸²ã€‚</p>
<p>ç”¨Optionalçš„ifPresentOrElseæ¥å¤„ç†ç»“æœï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œå°±æ‰§è¡Œç¬¬ä¸€ä¸ªLambdaï¼›å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±æ‰§è¡Œç¬¬äºŒä¸ªã€‚</p>
<p>findAny(): è¿”å›ä»»æ„ä¸€ä¸ªå…ƒç´ ï¼ˆOptional&lt;T&gt;ï¼‰ï¼Œåœ¨å¹¶è¡Œæµä¸­æ›´é«˜æ•ˆã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; names = List.of(<span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);

Optional&lt;String&gt; anyMatch = names.stream()
                .filter(name -&gt; name.contains(<span class="hljs-string">"snail"</span>))
                .findAny();
<span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> anyMatch.orElse(<span class="hljs-string">"é»˜è®¤å€¼ï¼šæ²¡æ‰¾åˆ°"</span>);
        
System.out.println(<span class="hljs-string">"æŸ¥æ‰¾ç»“æœ: "</span> + result);
</code></pre>
<p>æŸ¥æ‰¾ä»»æ„ä¸€ä¸ªåŒ…å« snailçš„å­—ç¬¦ä¸²ï¼Œä½¿ç”¨Optionalçš„orElseæ¥å¤„ç†ç»“æœã€‚å¦‚æœæ‰¾åˆ°äº†ï¼Œå°±è¿”å›æ‰¾åˆ°çš„å€¼ï¼›å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ã€‚</p>
<p>å½’çº¦ï¼š</p>
<p>count(): è¿”å›æµä¸­å…ƒç´ ä¸ªæ•°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">long</span> <span class="hljs-variable">totalCount</span> <span class="hljs-operator">=</span> names.stream().count();
System.out.println(<span class="hljs-string">"åˆ—è¡¨ä¸­çš„å…ƒç´ æ€»æ•°æ˜¯: "</span> + totalCount);
</code></pre>
<p>reduce(T identity, BinaryOperator&lt;T&gt; accumulator): å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚</p>
<pre><code class="hljs language-java" lang="java">Optional&lt;String&gt; combinedString = names.stream()
                .reduce((accumulator, element) -&gt; accumulator + <span class="hljs-string">", "</span> + element);
        
        combinedString.ifPresent(
            result -&gt; System.out.println(<span class="hljs-string">"æ‹¼æ¥åçš„å­—ç¬¦ä¸²: "</span> + result)
        );
</code></pre>
<p>ç”¨reduceæŠŠæ‰€æœ‰å­—ç¬¦ä¸²æ‹¼æ¥èµ·æ¥ï¼Œreduceçš„è¿™ä¸ªé‡è½½ç‰ˆæœ¬ä¸æ¥å—åˆå§‹å€¼ï¼Œå› æ­¤è¿”å›ä¸€ä¸ªOptionalï¼Œé˜²æ­¢æµä¸ºç©ºã€‚</p>
<p>collect(Collector c): å°†æµè½¬æ¢ä¸ºå…¶ä»–å½¢å¼ï¼ˆå¦‚List, Set, Mapï¼‰ã€‚è¿™æ˜¯æœ€é‡è¦ã€æœ€å¼ºå¤§çš„ç»ˆç«¯æ“ä½œã€‚</p>
<pre><code class="hljs language-java" lang="java">Map&lt;String, Integer&gt; nameLengthMap = names.stream()
                .collect(Collectors.toMap(
                        name -&gt; name,        
                        String::length       
                ));
System.out.println(<span class="hljs-string">"è½¬æ¢åçš„Map: "</span> + nameLengthMap);
</code></pre>
<p>æŠŠæµè½¬æ¢æˆMap&lt;String, Integer&gt;ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€Collectors</h2>
<p>Collectorsæ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œé¢„åˆ¶äº†å¾ˆå¤šæ”¶é›†å™¨ï¼Œèƒ½æ»¡è¶³ç»å¤§éƒ¨åˆ†æ•°æ®å¤„ç†éœ€æ±‚ã€‚</p>
<h3 data-id="heading-6">3.1æ”¶é›†åˆ°é›†åˆ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;String&gt; names = List.of(<span class="hljs-string">"lazysnail"</span>, <span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"lazysnailstudio.com"</span>);

        List&lt;String&gt; nameList = names.stream().toList();

        Set&lt;String&gt; nameSet = names.stream().collect(Collectors.toSet());

        LinkedList&lt;String&gt; nameLinkedList = names.stream()
                .collect(Collectors.toCollection(LinkedList::<span class="hljs-keyword">new</span>));
    }
</code></pre>
<h3 data-id="heading-7">3.2èšåˆè®¡ç®—</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;Integer&gt; intList = Arrays.asList(<span class="hljs-number">300</span>, <span class="hljs-number">420</span>, <span class="hljs-number">180</span>, <span class="hljs-number">600</span>, <span class="hljs-number">210</span>);

        <span class="hljs-type">int</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> intList.stream()
                .collect(Collectors.summingInt(Integer::intValue));

        <span class="hljs-type">double</span> <span class="hljs-variable">avg</span> <span class="hljs-operator">=</span> intList.stream()
                .collect(Collectors.averagingInt(Integer::intValue));

        <span class="hljs-type">IntSummaryStatistics</span> <span class="hljs-variable">statistics</span> <span class="hljs-operator">=</span> intList.stream()
                .collect(Collectors.summarizingInt(Integer::intValue));

        System.out.println(<span class="hljs-string">"å’Œ: "</span> + total);
        System.out.println(<span class="hljs-string">"å¹³å‡å€¼: "</span> + avg);
        System.out.println(<span class="hljs-string">"å®Œæ•´ç»Ÿè®¡:"</span>);
        System.out.println(<span class="hljs-string">"è®°å½•æ•°: "</span> + statistics.getCount());
        System.out.println(<span class="hljs-string">"æœ€å¤§: "</span> + statistics.getMax());
        System.out.println(<span class="hljs-string">"æœ€å°: "</span> + statistics.getMin());
        System.out.println(<span class="hljs-string">"æ€»å’Œ: "</span> + statistics.getSum());
        System.out.println(<span class="hljs-string">"å¹³å‡å€¼: "</span> + statistics.getAverage());
    }
</code></pre>
<h3 data-id="heading-8">3.3åˆ†ç»„ä¸åˆ†åŒº</h3>
<p>groupingBy(Function classifier): åˆ†ç»„ï¼Œç±»ä¼¼äºSQLçš„GROUP BYã€‚</p>
<p>partitioningBy(Predicate predicate): åˆ†åŒºï¼Œæ˜¯groupingByçš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œé”®æ˜¯å¸ƒå°”å€¼ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day32;

<span class="hljs-keyword">import</span> java.util.Arrays;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> java.util.stream.Collectors;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> Day32Demo8
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/7/14 15:47
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Day32Demo8</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;Student&gt; students = Arrays.asList(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"æ‡’æƒ°èœ—ç‰›"</span>, <span class="hljs-string">"æ•°å­¦"</span>, <span class="hljs-number">85</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"äºŒè›‹"</span>, <span class="hljs-string">"æ•°å­¦"</span>, <span class="hljs-number">72</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"å°äºŒç‹—"</span>, <span class="hljs-string">"ç‰©ç†"</span>, <span class="hljs-number">92</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"äºŒç‹—å­"</span>, <span class="hljs-string">"ç‰©ç†"</span>, <span class="hljs-number">68</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"ç‹—è›‹"</span>, <span class="hljs-string">"æ•°å­¦"</span>, <span class="hljs-number">93</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"å°é˜¿ä¸‰"</span>, <span class="hljs-string">"åŒ–å­¦"</span>, <span class="hljs-number">78</span>)
        );

        Map&lt;String, List&lt;Student&gt;&gt; bySubject = students.stream()
                .collect(Collectors.groupingBy(Student::getSubject));

        bySubject.forEach((subject, list) -&gt; {
            System.out.println(subject + <span class="hljs-string">": "</span> +
                    list.stream().map(Student::getName).collect(Collectors.joining(<span class="hljs-string">", "</span>)));
        });

        Map&lt;String, List&lt;Student&gt;&gt; byGrade = students.stream()
                .collect(Collectors.groupingBy(student -&gt; {
                    <span class="hljs-type">int</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> student.getScore();
                    <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">90</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"A"</span>;
                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">80</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"B"</span>;
                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">70</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"C"</span>;
                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-string">"D"</span>;
                }));

        byGrade.forEach((grade, list) -&gt; {
            System.out.println(grade + <span class="hljs-string">": "</span> +
                    list.stream().map(Student::getName).collect(Collectors.joining(<span class="hljs-string">", "</span>)));
        });

        Map&lt;Boolean, List&lt;Student&gt;&gt; passOrFail = students.stream()
                .collect(Collectors.partitioningBy(student -&gt; student.getScore() &gt;= <span class="hljs-number">60</span>));

        System.out.println(<span class="hljs-string">"åŠæ ¼å­¦ç”Ÿ: "</span> +
                passOrFail.get(<span class="hljs-literal">true</span>).stream().map(Student::getName).collect(Collectors.joining(<span class="hljs-string">", "</span>)));
        System.out.println(<span class="hljs-string">"ä¸åŠæ ¼å­¦ç”Ÿ: "</span> +
                passOrFail.get(<span class="hljs-literal">false</span>).stream().map(Student::getName).collect(Collectors.joining(<span class="hljs-string">", "</span>)));
    }
}
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String subject;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> score;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, String subject, <span class="hljs-type">int</span> score)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.subject = subject;
        <span class="hljs-built_in">this</span>.score = score;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> name; }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getSubject</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> subject; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getScore</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> score; }
}
</code></pre>
<p>ç”¨groupingByåˆ†åˆ«è¿›è¡Œäº†æŒ‰ç…§å­¦ç§‘å’Œæˆç»©ç­‰çº§ï¼ˆè‡ªå®šä¹‰ï¼‰è¿›è¡Œäº†åˆ†ç»„ã€‚</p>
<p>ç”¨partitioningByæŒ‰ç…§æ˜¯å¦åŠæ ¼ï¼ˆ60åˆ†ï¼‰è¿›è¡Œäº†åˆ†åŒºã€‚</p>
<p>æ¡ˆä¾‹ä¸­ä½¿ç”¨åˆ°çš„Collectors.joiningæ–¹æ³•å°±æ˜¯æŠŠæµä¸­çš„å…ƒç´ æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<h2 data-id="heading-9">ç»“è¯­</h2>
<p>Stream APIæä¾›äº†ä¸°å¯Œçš„æµæ“ä½œï¼Œéå¸¸é€‚åˆå¤„ç†é›†åˆæ•°æ®ï¼Œè®©å¤„ç†è¿‡ç¨‹æ›´åŠ çš„ç®€æ´æ–¹ä¾¿ã€‚</p>
<p>è™½ç„¶çœ‹ç€å†…å®¹æ¯”è¾ƒå¤šï¼Œä½†æ˜¯å¤šå®æ“ä¸€ä¸‹ï¼Œä¸Šæ‰‹éå¸¸å¿«ã€‚</p>
<p>ä¹‹å‰é›†åˆä¸­çš„æ¡ˆä¾‹éƒ½å¯ä»¥å°è¯•ç”¨æµæ“ä½œé‡æ„ä¸‹ï¼Œæ„Ÿå—ä¸€ä¸‹æµæ“ä½œã€‚</p>
<p>ä¸‹ä¸€ç¯‡é¢„å‘Š</p>
<blockquote>
<p>Day33 | Javaä¸­çš„Optional</p>
</blockquote>
<p>å¦‚æœä½ è§‰å¾—è¿™ç³»åˆ—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨ä¸“æ ï¼Œæˆ‘ä»¬ä¸€èµ·åšæŒä¸‹å»ï¼</p>
<p><strong>æ›´å¤šæ–‡ç« è¯·å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Šæ‡’æƒ°èœ—ç‰›å·¥åŠã€‹</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptåŸå‹é“¾ï¼šä¸€ä»½ä¼šâ€œé—ä¼ â€çš„å®¶æ—ä¼ å®¶å®]]></title>    <link>https://juejin.cn/post/7584724634173358143</link>    <guid>https://juejin.cn/post/7584724634173358143</guid>    <pubDate>2025-12-18T03:59:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584724634173358143" data-draft-id="7584759201071841321" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptåŸå‹é“¾ï¼šä¸€ä»½ä¼šâ€œé—ä¼ â€çš„å®¶æ—ä¼ å®¶å®"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-18T03:59:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JS_Likers"/> <meta itemprop="url" content="https://juejin.cn/user/1377017277975032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptåŸå‹é“¾ï¼šä¸€ä»½ä¼šâ€œé—ä¼ â€çš„å®¶æ—ä¼ å®¶å®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1377017277975032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JS_Likers
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:59:48.000Z" title="Thu Dec 18 2025 03:59:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ¬¢è¿ä½¿ç”¨æˆ‘çš„å°ç¨‹åºğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d25c4001b1b4e6e902dc1f8863bcef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSlNfTGlrZXJz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766635187&amp;x-signature=H7WM0eoyAF2kWEnBwudPxVskG3M%3D" alt="small.png" loading="lazy"/></p>
<hr/>
<p>ä½ å¥½ï¼å¦‚æœä½ æ›¾è§‰å¾—JavaScriptçš„åŸå‹é“¾åƒé­”æ³•ä¸€æ ·ç¥ç§˜ï¼Œé‚£ä¹ˆä»Šå¤©æˆ‘è¦å‘Šè¯‰ä½ ä¸€ä¸ªç§˜å¯†ï¼šå®ƒå…¶å®å°±åƒä¸€ä»½å®¶æ—ä¼ å®¶å®ï¼Œä»£ä»£ç›¸ä¼ ï¼Œæ°¸è¿œä¸ä¼šä¸¢å¤±ï¼</p>
<h2 data-id="heading-0">ä¸€ä¸ªç¥å¥‡çš„ç°è±¡</h2>
<p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼Œæ„Ÿå—ä¸€ä¸‹åŸå‹é“¾çš„ç¥å¥‡ä¹‹å¤„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç®€å•çš„å¯¹è±¡</span>
<span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'å°æ˜'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
};

<span class="hljs-comment">// æˆ‘ä»¬ä»æ¥æ²¡æœ‰ç»™personæ·»åŠ è¿‡toStringæ–¹æ³•</span>
<span class="hljs-comment">// ä½†å®ƒå±…ç„¶èƒ½ç”¨ï¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-title function_">toString</span>()); <span class="hljs-comment">// è¾“å‡º: "[object Object]"</span>
</code></pre>
<p>æ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ï¼Ÿæˆ‘ä»¬æ²¡æœ‰ç»™<code>person</code>å¯¹è±¡å®šä¹‰<code>toString</code>æ–¹æ³•ï¼Œä½†å®ƒå´å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼è¿™å°±æ˜¯åŸå‹é“¾çš„é­”åŠ›ã€‚</p>
<h2 data-id="heading-1">æ­å¼€ç¥ç§˜é¢çº±ï¼šä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å®¶é‡Œæœ‰ä¸€ä»½â€œå®¶æ—ä¼ å®¶å®â€â€”â€”ä¸€æœ¬è®°å½•äº†æ‰€æœ‰å®¶æ—æˆå‘˜å…±åŒç‰¹å¾çš„æ—è°±ã€‚æ¯ä¸ªæ–°å‡ºç”Ÿçš„å­©å­éƒ½ä¼šè‡ªåŠ¨â€œç»§æ‰¿â€è¿™äº›å®¶æ—ç‰¹å¾ï¼Œæ¯”å¦‚å§“æ°ã€å®¶æ—ä¼ ç»Ÿç­‰ã€‚</p>
<p>åœ¨JavaScriptä¸­ï¼Œ<strong>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªéšè—çš„â€œæ—è°±â€</strong>ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œåŸå‹â€ï¼ˆprototypeï¼‰ã€‚å½“ä½ è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡è‡ªå·±æ²¡æœ‰ï¼ŒJavaScriptå°±ä¼šè‡ªåŠ¨å»å®ƒçš„â€œæ—è°±â€ï¼ˆåŸå‹ï¼‰é‡Œæ‰¾ï¼Œå¦‚æœè¿˜æ²¡æ‰¾åˆ°ï¼Œå°±ç»§ç»­å»åŸå‹çš„åŸå‹é‡Œæ‰¾...è¿™æ ·ä¸€çº§ä¸€çº§å¾€ä¸Šæ‰¾ï¼Œå°±åƒæ²¿ç€å®¶æ—æ ‘å¾€ä¸Šè¿½æº¯ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢ï¼ˆæˆ–è€…ç›´åˆ°æœ€é¡¶å±‚ä¹Ÿæ²¡æ‰¾åˆ°ï¼Œè¿”å›undefinedï¼‰ã€‚</p>
<p>è¿™å°±æ˜¯<strong>åŸå‹é“¾</strong>ï¼</p>
<h2 data-id="heading-2">è®©æˆ‘ä»¬â€œå¯è§†åŒ–â€åŸå‹é“¾</h2>
<h3 data-id="heading-3">1. æ„é€ å‡½æ•°ï¼šå®¶æ—çš„â€œåˆ›å§‹ç¥–å…ˆâ€</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªâ€œå®¶æ—â€çš„è“å›¾</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-comment">// ç»™è¿™ä¸ªå®¶æ—çš„æ‰€æœ‰æˆå‘˜æ·»åŠ ä¸€ä¸ªå…±åŒæŠ€èƒ½</span>
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œæˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>ï¼Œä»Šå¹´<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span>å²`</span>);
};
</code></pre>
<p>è¿™é‡Œï¼Œ<code>Person</code>å°±åƒä¸€ä¸ªå®¶æ—çš„åˆ›å§‹äººï¼Œè€Œ<code>Person.prototype</code>å°±æ˜¯å®¶æ—çš„â€œä¼ å®¶å®â€ï¼ˆæ—è°±ï¼‰ï¼Œè®°å½•äº†æ‰€æœ‰å®¶æ—æˆå‘˜å…±æœ‰çš„ç‰¹å¾å’Œæ–¹æ³•ã€‚</p>
<h3 data-id="heading-4">2. åˆ›å»ºå®¶æ—æˆå‘˜</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºä¸¤ä¸ªå®¶æ—æˆå‘˜</span>
<span class="hljs-keyword">const</span> xiaoming = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å°æ˜'</span>, <span class="hljs-number">25</span>);
<span class="hljs-keyword">const</span> xiaohong = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å°çº¢'</span>, <span class="hljs-number">23</span>);

<span class="hljs-comment">// ä»–ä»¬éƒ½æœ‰è‡ªå·±çš„ç‹¬ç‰¹å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xiaoming.<span class="hljs-property">name</span>); <span class="hljs-comment">// å°æ˜</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xiaohong.<span class="hljs-property">name</span>); <span class="hljs-comment">// å°çº¢</span>

<span class="hljs-comment">// ä½†ä»–ä»¬å…±äº«åŒä¸€ä¸ªâ€œä¼ å®¶å®â€ä¸­çš„æ–¹æ³•</span>
xiaoming.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ˜ï¼Œä»Šå¹´25å²</span>
xiaohong.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// ä½ å¥½ï¼Œæˆ‘æ˜¯å°çº¢ï¼Œä»Šå¹´23å²</span>
</code></pre>
<p>æœ‰è¶£çš„æ˜¯ï¼Œè™½ç„¶<code>sayHello</code>æ–¹æ³•ä¸åœ¨<code>xiaoming</code>å’Œ<code>xiaohong</code>è‡ªå·±èº«ä¸Šï¼Œä½†ä»–ä»¬éƒ½èƒ½é€šè¿‡â€œå®¶æ—ä¼ å®¶å®â€è®¿é—®åˆ°å®ƒï¼</p>
<h2 data-id="heading-5">çœ‹çœ‹åŸå‹é“¾æ˜¯å¦‚ä½•è¿æ¥çš„</h2>
<p>è®©æˆ‘ä»¬æ¥è¿½è¸ªä¸€ä¸‹è¿™ä¸ªå®¶æ—å…³ç³»ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// xiaomingè‡ªå·±çš„å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xiaoming.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'name'</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xiaoming.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'sayHello'</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// ä½†sayHelloåœ¨å®ƒçš„åŸå‹ä¸Šï¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'sayHello'</span>)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// çœ‹çœ‹åŸå‹é“¾çš„è¿æ¥</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xiaoming.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span>); <span class="hljs-comment">// null - åˆ°å¤´äº†ï¼</span>
</code></pre>
<h2 data-id="heading-6">å›¾è§£åŸå‹é“¾å®¶æ—æ ‘</h2>
<pre><code class="hljs language-javascript" lang="javascript">xiaoming
    â”‚
    â”œâ”€â”€ è‡ªå·±çš„å±æ€§: name, age
    â”‚
    â””â”€â”€ __proto__ â†’ <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
            â”‚
            â”œâ”€â”€ å®¶æ—å…±äº«: <span class="hljs-title function_">sayHello</span>()
            â”‚
            â””â”€â”€ __proto__ â†’ <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
                    â”‚
                    â”œâ”€â”€ å…¨å®‡å®™å…±äº«: <span class="hljs-title function_">toString</span>(), <span class="hljs-title function_">valueOf</span>()...
                    â”‚
                    â””â”€â”€ __proto__ â†’ <span class="hljs-literal">null</span> (å®‡å®™çš„å°½å¤´ï¼)
</code></pre>
<h2 data-id="heading-7">æœ‰è¶£çš„å®éªŒï¼šæ²¿ç€åŸå‹é“¾â€œå¯»å®â€</h2>
<p>è®©æˆ‘ä»¬ç©ä¸€ä¸ªæ¸¸æˆï¼Œçœ‹çœ‹JavaScriptå¦‚ä½•æ²¿ç€åŸå‹é“¾å¯»æ‰¾å±æ€§ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªâ€œå¯»å®åœ°å›¾â€</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">GrandParent</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">grandparentSecret</span> = <span class="hljs-string">"æˆ‘æ˜¯çˆ·çˆ·çš„ç§˜å¯†"</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSecret</span> = <span class="hljs-string">"æˆ‘æ˜¯çˆ¸çˆ¸çš„ç§˜å¯†"</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">childSecret</span> = <span class="hljs-string">"æˆ‘æ˜¯å­©å­çš„ç§˜å¯†"</span>;
}

<span class="hljs-comment">// å»ºç«‹å®¶æ—å…³ç³»</span>
<span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GrandParent</span>();
<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Parent</span>();

<span class="hljs-keyword">const</span> child = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>();

<span class="hljs-comment">// å¼€å§‹å¯»å®ï¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child.<span class="hljs-property">childSecret</span>);     <span class="hljs-comment">// 1. è‡ªå·±èº«ä¸Šæ‰¾åˆ° âœ“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child.<span class="hljs-property">parentSecret</span>);    <span class="hljs-comment">// 2. çˆ¸çˆ¸èº«ä¸Šæ‰¾åˆ° âœ“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child.<span class="hljs-property">grandparentSecret</span>); <span class="hljs-comment">// 3. çˆ·çˆ·èº«ä¸Šæ‰¾åˆ° âœ“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child.<span class="hljs-property">toString</span>);        <span class="hljs-comment">// 4. ç¥–ä¼ çš„toStringæ–¹æ³• âœ“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child.<span class="hljs-property">alienSecret</span>);     <span class="hljs-comment">// 5. undefined - æ²¡è¿™ä¸ªå®ç‰©ï¼</span>
</code></pre>
<h2 data-id="heading-8">ç°ä»£JavaScriptä¸­çš„åŸå‹é“¾</h2>
<p>ES6å¼•å…¥äº†<code>class</code>è¯­æ³•ï¼Œè®©åŸå‹é“¾çš„ä½¿ç”¨æ›´åŠ ç›´è§‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }
  
  <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> å‘å‡ºå£°éŸ³`</span>);
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, breed</span>) {
    <span class="hljs-variable language_">super</span>(name);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">breed</span> = breed;
  }
  
  <span class="hljs-title function_">bark</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>ï¼ˆ<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breed}</span>ï¼‰æ±ªæ±ªå«ï¼`</span>);
  }
}

<span class="hljs-keyword">const</span> myDog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'æ—ºè´¢'</span>, <span class="hljs-string">'é‡‘æ¯›'</span>);
myDog.<span class="hljs-title function_">speak</span>(); <span class="hljs-comment">// ç»§æ‰¿è‡ªAnimal</span>
myDog.<span class="hljs-title function_">bark</span>();  <span class="hljs-comment">// è‡ªå·±çš„æ–¹æ³•</span>
</code></pre>
<p>è™½ç„¶è¯­æ³•å˜äº†ï¼Œä½†åº•å±‚è¿˜æ˜¯é‚£ä¸ªç†Ÿæ‚‰çš„åŸå‹é“¾ï¼</p>
<h2 data-id="heading-9">ä¸ºä»€ä¹ˆåŸå‹é“¾å¾ˆé‡è¦ï¼Ÿ</h2>
<ol>
<li><strong>å†…å­˜é«˜æ•ˆ</strong>ï¼šå…±äº«æ–¹æ³•åªéœ€è¦å­˜å‚¨ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯æ¯ä¸ªå¯¹è±¡éƒ½å¤åˆ¶ä¸€ä»½</li>
<li><strong>ä»£ç å¤ç”¨</strong>ï¼šé€šè¿‡ç»§æ‰¿ï¼Œå¯ä»¥è½»æ¾æ‰©å±•å’Œé‡ç”¨ä»£ç </li>
<li><strong>åŠ¨æ€æ‰©å±•</strong>ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹åŸå‹ï¼Œæ‰€æœ‰å®ä¾‹éƒ½ä¼šè‡ªåŠ¨è·å¾—æ–°èƒ½åŠ›</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç»™æ‰€æœ‰æ•°ç»„æ·»åŠ ä¸€ä¸ªæœ‰è¶£çš„æ–¹æ³•</span>
<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æˆ‘æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘æœ‰<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.length}</span>ä¸ªå…ƒç´ `</span>);
};

[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// æˆ‘æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘æœ‰3ä¸ªå…ƒç´ </span>
</code></pre>
<p>ï¼ˆæ³¨æ„ï¼šåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä¿®æ”¹å†…ç½®å¯¹è±¡çš„åŸå‹é€šå¸¸ä¸æ˜¯å¥½ä¸»æ„ï¼Œè¿™åªæ˜¯ä¸€ä¸ªæ¼”ç¤ºï¼ï¼‰</p>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>JavaScriptçš„åŸå‹é“¾å°±åƒä¸€ä»½å®¶æ—ä¼ å®¶å®ï¼š</p>
<ul>
<li>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„å°ç§˜å¯†ï¼ˆå±æ€§ï¼‰</li>
<li>ä½†ä¹Ÿå…±äº«å®¶æ—çš„å…±åŒè´¢å¯Œï¼ˆåŸå‹æ–¹æ³•ï¼‰</li>
<li>å½“ä½ å¯»æ‰¾æŸä¸ªå±æ€§æ—¶ï¼ŒJavaScriptä¼šåƒå¯»å®ä¸€æ ·æ²¿ç€å®¶æ—æ ‘å‘ä¸Šæ‰¾</li>
<li>ç›´åˆ°æ‰¾åˆ°å®ç‰©ï¼Œæˆ–è€…åˆ°è¾¾å®¶æ—æ ‘çš„é¡¶ç«¯ï¼ˆnullï¼‰</li>
</ul>
<p>ç°åœ¨ï¼Œå½“æœ‰äººæåˆ°"åŸå‹é“¾"æ—¶ï¼Œä½ å¯ä»¥å¾®ç¬‘ç€è¯´ï¼š"å“¦ï¼Œå°±æ˜¯JavaScriptå¯¹è±¡çš„å®¶æ—ä¼ å®¶å®ç³»ç»Ÿå˜›ï¼"</p>
<p>å¸Œæœ›è¿™ä¸ªæ¯”å–»è®©ä½ å¯¹åŸå‹é“¾æœ‰äº†æ›´ç›´è§‚çš„ç†è§£ã€‚ä¸‹æ¬¡å†™JavaScriptæ—¶ï¼Œä¸å¦¨æƒ³æƒ³ä½ æ­£åœ¨å¤„ç†çš„å¯¹è±¡çš„"å®¶æ—å…³ç³»"å§ï¼</p>
<p><strong>è®°ä½ï¼šåœ¨JavaScriptçš„ä¸–ç•Œé‡Œï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ä¸æ˜¯å­¤å²›ï¼Œå®ƒä»¬é€šè¿‡åŸå‹é“¾è¿æ¥æˆä¸€ä¸ªåºå¤§çš„å®¶æ—ç½‘ç»œï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½“JSæ‹·è´ç©èµ·äº†â€œä¿„ç½—æ–¯å¥—å¨ƒâ€ï¼šæ·±æ‹·è´ä¸æµ…æ‹·è´çš„è¶£å‘³å¯¹å†³]]></title>    <link>https://juejin.cn/post/7584724634173341759</link>    <guid>https://juejin.cn/post/7584724634173341759</guid>    <pubDate>2025-12-18T03:59:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584724634173341759" data-draft-id="7584730804515242027" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“JSæ‹·è´ç©èµ·äº†â€œä¿„ç½—æ–¯å¥—å¨ƒâ€ï¼šæ·±æ‹·è´ä¸æµ…æ‹·è´çš„è¶£å‘³å¯¹å†³"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-18T03:59:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JS_Likers"/> <meta itemprop="url" content="https://juejin.cn/user/1377017277975032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“JSæ‹·è´ç©èµ·äº†â€œä¿„ç½—æ–¯å¥—å¨ƒâ€ï¼šæ·±æ‹·è´ä¸æµ…æ‹·è´çš„è¶£å‘³å¯¹å†³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1377017277975032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JS_Likers
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:59:14.000Z" title="Thu Dec 18 2025 03:59:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ¬¢è¿ä½¿ç”¨æˆ‘çš„å°ç¨‹åºğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d25c4001b1b4e6e902dc1f8863bcef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSlNfTGlrZXJz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766635153&amp;x-signature=Enu3BPRStlU5IdJX5w6qVPE%2FMno%3D" alt="small.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">ğŸ“š æ‹·è´ä¸åªæ˜¯å¤åˆ¶ç²˜è´´</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€æœ¬å¿ƒçˆ±çš„ç²¾è£…ä¹¦ï¼Œæœ‹å‹æƒ³å€Ÿå»é˜…è¯»ã€‚ä½ æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p>
<ol>
<li><strong>ç›´æ¥ç»™æœ‹å‹</strong> - ä½†ä¹¦å°±ä¸åœ¨ä½ æ‰‹ä¸Šäº†ï¼ˆåŸå§‹å¼•ç”¨ï¼‰</li>
<li><strong>å»å¤å°åº—å¤å°ä¸€æœ¬</strong> - æœ‹å‹æœ‰è‡ªå·±çš„å‰¯æœ¬ï¼Œä½ çš„åŸç‰ˆè¿˜åœ¨</li>
</ol>
<p>åœ¨JavaScriptçš„ä¸–ç•Œé‡Œï¼Œæ‹·è´æ•°æ®å°±åƒè¿™ä¸ªåœºæ™¯ï¼Œä½†æœ‰æ›´å¤šçš„â€œå¥—å¨ƒâ€æƒ…å†µï¼</p>
<h2 data-id="heading-1">ğŸ­ æµ…æ‹·è´ï¼šåªæ¬å®¶çš„â€œè¡¨é¢æœ‹å‹â€</h2>
<p>æµ…æ‹·è´å°±åƒåªæ¬èµ°äº†å®¶å…·ï¼Œä½†å¢™ä¸Šè¿˜æŒ‚ç€åŸæˆ¿å­çš„é’¥åŒ™ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŸå§‹å¯¹è±¡ - ä¸€ä¸ªâ€œå¥—å¨ƒâ€å¯¹è±¡</span>
<span class="hljs-keyword">const</span> original = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"å°æ˜"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>,
  <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"ç¼–ç¨‹"</span>, <span class="hljs-string">"æ¸¸æˆ"</span>, <span class="hljs-string">"é˜…è¯»"</span>], <span class="hljs-comment">// æ³¨æ„è¿™ä¸ªæ•°ç»„ï¼</span>
  <span class="hljs-attr">address</span>: {
    <span class="hljs-attr">city</span>: <span class="hljs-string">"åŒ—äº¬"</span>,
    <span class="hljs-attr">district</span>: <span class="hljs-string">"æµ·æ·€åŒº"</span>
  }
};

<span class="hljs-comment">// æµ…æ‹·è´çš„å‡ ç§æ–¹å¼ï¼š</span>
<span class="hljs-keyword">const</span> shallowCopy1 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, original);
<span class="hljs-keyword">const</span> shallowCopy2 = { ...original }; <span class="hljs-comment">// æ‰©å±•è¿ç®—ç¬¦</span>
<span class="hljs-keyword">const</span> shallowCopy3 = original.<span class="hljs-property">slice</span>?.(); <span class="hljs-comment">// æ•°ç»„ä¸“ç”¨</span>

<span class="hljs-comment">// è¯•è¯•ä¿®æ”¹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</span>
shallowCopy1.<span class="hljs-property">name</span> = <span class="hljs-string">"å°çº¢"</span>; <span class="hljs-comment">// âœ… ä¸ä¼šå½±å“original</span>
shallowCopy1.<span class="hljs-property">hobbies</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">"æ‘„å½±"</span>); <span class="hljs-comment">// âš ï¸ ç³Ÿç³•ï¼originalçš„hobbiesä¹Ÿè¢«æ”¹äº†ï¼</span>
</code></pre>
<p><strong>æµ…æ‹·è´çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>åªå¤åˆ¶ç¬¬ä¸€å±‚å±æ€§</li>
<li>åµŒå¥—å¯¹è±¡/æ•°ç»„ä»ç„¶æ˜¯â€œå…±äº«â€çš„å¼•ç”¨</li>
<li>åƒåªæ¢äº†å¤–å£³ï¼ŒèŠ¯å­è¿˜æ˜¯åŒä¸€ä¸ª</li>
</ul>
<h2 data-id="heading-2">ğŸ§³ æ·±æ‹·è´ï¼šçœŸæ­£çš„â€œç‹¬ç«‹é—¨æˆ·â€</h2>
<p>æ·±æ‹·è´å°±åƒå¸¦ç€æ‰€æœ‰å®¶å½“æ¬åˆ°äº†å…¨æ–°çš„æˆ¿å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ·±æ‹·è´å®ç°æ–¹å¼å¤§æ¯”æ‹¼</span>

<span class="hljs-comment">// æ–¹æ³•1ï¼šJSONå¤§æ³•ï¼ˆæœ€ç®€å•ä½†æœ‰å±€é™ï¼‰</span>
<span class="hljs-keyword">const</span> deepCopy1 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(original));

<span class="hljs-comment">// æ–¹æ³•2ï¼šé€’å½’å®ç°ï¼ˆè‡ªå·±åŠ¨æ‰‹ï¼Œä¸°è¡£è¶³é£Ÿï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">obj</span>) {
  <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span>) <span class="hljs-keyword">return</span> obj;
  
  <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(obj);
  <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">RegExp</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(obj);
  
  <span class="hljs-keyword">const</span> clone = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(obj) ? [] : {};
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> obj) {
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-title function_">hasOwnProperty</span>(key)) {
      clone[key] = <span class="hljs-title function_">deepClone</span>(obj[key]);
    }
  }
  
  <span class="hljs-keyword">return</span> clone;
}

<span class="hljs-keyword">const</span> deepCopy2 = <span class="hljs-title function_">deepClone</span>(original);

<span class="hljs-comment">// æ–¹æ³•3ï¼šä½¿ç”¨ç°æˆåº“ï¼ˆæœ€çœå¿ƒï¼‰</span>
<span class="hljs-comment">// const deepCopy3 = _.cloneDeep(original); // Lodash</span>
<span class="hljs-comment">// const deepCopy4 = structuredClone(original); // ç°ä»£JSåŸç”ŸAPI</span>
</code></pre>
<p>ç°åœ¨æ— è®ºæ€ä¹ˆä¿®æ”¹deepCopyï¼Œéƒ½ä¸ä¼šå½±å“originaläº†ï¼</p>
<h2 data-id="heading-3">ğŸ¯ ä»€ä¹ˆæ—¶å€™ç”¨ä»€ä¹ˆï¼Ÿ</h2>
<h3 data-id="heading-4">æµ…æ‹·è´é€‚ç”¨åœºæ™¯ï¼š</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœºæ™¯1ï¼šé…ç½®åˆå¹¶</span>
<span class="hljs-keyword">const</span> defaultConfig = { <span class="hljs-attr">theme</span>: <span class="hljs-string">'light'</span>, <span class="hljs-attr">showTips</span>: <span class="hljs-literal">true</span> };
<span class="hljs-keyword">const</span> userConfig = { <span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span> };
<span class="hljs-keyword">const</span> finalConfig = { ...defaultConfig, ...userConfig };

<span class="hljs-comment">// åœºæ™¯2ï¼šåˆ›å»ºå¯¹è±¡å‰¯æœ¬è¿›è¡Œç®€å•ä¿®æ”¹</span>
<span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-attr">loggedIn</span>: <span class="hljs-literal">false</span> };
<span class="hljs-keyword">const</span> updatedUser = { ...user, <span class="hljs-attr">loggedIn</span>: <span class="hljs-literal">true</span> };
</code></pre>
<h3 data-id="heading-5">æ·±æ‹·è´é€‚ç”¨åœºæ™¯ï¼š</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœºæ™¯1ï¼šçŠ¶æ€ç®¡ç†ï¼ˆå¦‚Redux reducerï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">reducer</span>(<span class="hljs-params">state, action</span>) {
  <span class="hljs-keyword">switch</span>(action.<span class="hljs-property">type</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'UPDATE_USER'</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">user</span>: <span class="hljs-title function_">deepClone</span>(action.<span class="hljs-property">payload</span>) <span class="hljs-comment">// ç¡®ä¿å®Œå…¨ç‹¬ç«‹</span>
      };
  }
}

<span class="hljs-comment">// åœºæ™¯2ï¼šè¡¨å•æ•°æ®çš„åˆå§‹å‰¯æœ¬</span>
<span class="hljs-keyword">const</span> initialFormData = <span class="hljs-title function_">deepClone</span>(templateData);
<span class="hljs-keyword">const</span> formData = <span class="hljs-title function_">deepClone</span>(initialFormData); <span class="hljs-comment">// æ¯æ¬¡éƒ½æ˜¯æ–°çš„å¼€å§‹</span>
</code></pre>
<h2 data-id="heading-6">ğŸ§ª è¶£å‘³å®éªŒï¼šæ‹·è´çš„é™·é˜±</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é™·é˜±1ï¼šå¾ªç¯å¼•ç”¨ï¼ˆè‡ªå·±å¼•ç”¨è‡ªå·±ï¼‰</span>
<span class="hljs-keyword">const</span> narcissist = { <span class="hljs-attr">name</span>: <span class="hljs-string">"è‡ªæ‹å¯¹è±¡"</span> };
narcissist.<span class="hljs-property">self</span> = narcissist; <span class="hljs-comment">// æˆ‘å¼•ç”¨æˆ‘è‡ªå·±ï¼</span>

<span class="hljs-comment">// JSONå¤§æ³•ä¼šæŠ¥é”™ï¼</span>
<span class="hljs-comment">// JSON.parse(JSON.stringify(narcissist)); // TypeError!</span>

<span class="hljs-comment">// é™·é˜±2ï¼šç‰¹æ®Šå¯¹è±¡</span>
<span class="hljs-keyword">const</span> specialObj = {
  <span class="hljs-attr">date</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
  <span class="hljs-attr">regex</span>: <span class="hljs-regexp">/hello/gi</span>,
  <span class="hljs-attr">func</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-string">"Hi"</span>; },
  <span class="hljs-attr">undefined</span>: <span class="hljs-literal">undefined</span>,
  <span class="hljs-attr">infinity</span>: <span class="hljs-title class_">Infinity</span>,
  <span class="hljs-attr">nan</span>: <span class="hljs-title class_">NaN</span>
};

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(specialObj)));
<span class="hljs-comment">// å‡½æ•°ã€undefinedä¸è§äº†ï¼æ—¥æœŸå˜æˆäº†å­—ç¬¦ä¸²...</span>
</code></pre>
<h2 data-id="heading-7">ğŸ“Š æ€§èƒ½å¯¹æ¯”ï¼šé€Ÿåº¦ä¸æ·±åº¦çš„åšå¼ˆ</h2>






















































<table><thead><tr><th>æ–¹æ³•</th><th>é€Ÿåº¦</th><th>æ·±åº¦</th><th>ç‰¹æ®Šç±»å‹æ”¯æŒ</th><th>å¾ªç¯å¼•ç”¨æ”¯æŒ</th></tr></thead><tbody><tr><td>æ‰©å±•è¿ç®—ç¬¦ <code>...</code></td><td>âš¡âš¡âš¡âš¡âš¡</td><td>æµ…</td><td>æœ‰é™</td><td>âŒ</td></tr><tr><td><code>Object.assign()</code></td><td>âš¡âš¡âš¡âš¡âš¡</td><td>æµ…</td><td>æœ‰é™</td><td>âŒ</td></tr><tr><td>JSONæ–¹æ³•</td><td>âš¡âš¡âš¡</td><td>æ·±</td><td>å·®</td><td>âŒ</td></tr><tr><td>é€’å½’å®ç°</td><td>âš¡âš¡</td><td>æ·±</td><td>å¥½</td><td>âŒ</td></tr><tr><td>Lodashçš„cloneDeep</td><td>âš¡âš¡</td><td>æ·±</td><td>å¾ˆå¥½</td><td>âœ…</td></tr><tr><td><code>structuredClone()</code></td><td>âš¡âš¡âš¡</td><td>æ·±</td><td>è¾ƒå¥½</td><td>âœ…</td></tr></tbody></table>
<h2 data-id="heading-8">ğŸ’¡ å®ç”¨å°è´´å£«</h2>
<ol>
<li>
<p><strong>â€œå…ˆé—®è¦ä¸è¦ï¼Œå†é—®æ€ä¹ˆåšâ€</strong> - å…ˆç¡®å®šæ˜¯å¦éœ€è¦æ·±æ‹·è´ï¼Œå¾ˆå¤šæƒ…å†µæµ…æ‹·è´å°±å¤Ÿç”¨äº†</p>
</li>
<li>
<p><strong>ç°ä»£JSçš„æ•‘æ˜Ÿ</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµè§ˆå™¨å’ŒNode.jsçš„æ–°å® </span>
<span class="hljs-keyword">const</span> cloned = <span class="hljs-title function_">structuredClone</span>(original); <span class="hljs-comment">// æ”¯æŒå¤§éƒ¨åˆ†ç±»å‹ï¼</span>
</code></pre>
</li>
<li>
<p><strong>Lodashæ˜¯ä½ çš„å¥½æœ‹å‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { cloneDeep } <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash-es'</span>; <span class="hljs-comment">// æŒ‰éœ€å¼•å…¥</span>
<span class="hljs-comment">// æˆ–è€…ç”¨ throttle çš„æ·±æ‹·è´å‡½æ•°</span>
</code></pre>
</li>
<li>
<p><strong>æ€§èƒ½æç¤º</strong>ï¼šå¯¹äºè¶…å¤§å¯¹è±¡ï¼Œè€ƒè™‘æ˜¯å¦éœ€è¦æ•´ä¸ªæ‹·è´ï¼Œä¹Ÿè®¸åªéœ€ä¿®æ”¹éƒ¨åˆ†</p>
</li>
</ol>
<h2 data-id="heading-9">ğŸ¬ å®æˆ˜æ¼”ç»ƒï¼šæ‹·è´åœ¨çœŸå®åœºæ™¯çš„åº”ç”¨</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è´­ç‰©è½¦åœºæ™¯</span>
<span class="hljs-keyword">const</span> shoppingCart = {
  <span class="hljs-attr">items</span>: [
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"JavaScripté«˜çº§ç¼–ç¨‹"</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">99</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"TypeScriptå…¥é—¨"</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">79</span> }
  ],
  <span class="hljs-attr">discount</span>: <span class="hljs-number">0.1</span>,
  <span class="hljs-title function_">getTotal</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> 
      sum + item.<span class="hljs-property">price</span> * item.<span class="hljs-property">quantity</span>, <span class="hljs-number">0</span>) * (<span class="hljs-number">1</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">discount</span>);
  }
};

<span class="hljs-comment">// ç”¨æˆ·æƒ³â€œå¦‚æœè¿™æ ·ä¹°â€çš„è¯•ç®—åŠŸèƒ½</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">whatIfAddItem</span>(<span class="hljs-params">cart, newItem</span>) {
  <span class="hljs-keyword">const</span> hypotheticalCart = <span class="hljs-title function_">deepClone</span>(cart);
  hypotheticalCart.<span class="hljs-property">items</span>.<span class="hljs-title function_">push</span>(newItem);
  <span class="hljs-keyword">return</span> hypotheticalCart.<span class="hljs-title function_">getTotal</span>();
}

<span class="hljs-comment">// çœŸå®çš„è´­ç‰©è½¦ä¸å—å½±å“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(shoppingCart.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>); <span class="hljs-comment">// è¿˜æ˜¯2ä¸ª</span>
</code></pre>
<h2 data-id="heading-10">ğŸ“ æ€»ç»“ï¼šæ‹·è´é€‰æ‹©æŒ‡å—</h2>
<ol>
<li><strong>â€œæˆ‘åªæƒ³æ”¹æ”¹è¡¨é¢â€</strong> â†’ ç”¨æµ…æ‹·è´ï¼ˆ<code>...</code>æˆ–<code>Object.assign</code>ï¼‰</li>
<li><strong>â€œæˆ‘è¦å®Œå…¨ç‹¬ç«‹çš„æ–°å¯¹è±¡â€</strong> â†’ ç”¨æ·±æ‹·è´</li>
<li><strong>â€œæˆ‘æœ‰ç‰¹æ®Šç±»å‹æˆ–å¾ªç¯å¼•ç”¨â€</strong> â†’ ç”¨<code>structuredClone()</code>æˆ–Lodash</li>
<li><strong>â€œä¸ç¡®å®šæ·±æµ…â€</strong> â†’ é—®é—®è‡ªå·±ï¼šåµŒå¥—å¯¹è±¡éœ€è¦ç‹¬ç«‹å—ï¼Ÿ</li>
</ol>
<p>è®°ä½ï¼Œåœ¨JavaScriptçš„ä¸–ç•Œé‡Œï¼Œ<strong>â€œæ‹·è´â€ä¸æ˜¯ç®€å•çš„å¤åˆ¶ç²˜è´´ï¼Œè€Œæ˜¯å…³äºâ€œç‹¬ç«‹æ€§â€çš„å“²å­¦é€‰æ‹©</strong>ã€‚é€‰æ‹©æ­£ç¡®çš„æ‹·è´æ–¹å¼ï¼Œèƒ½è®©ä½ çš„ä»£ç æ›´å¥å£®ã€æ›´å¯é¢„æµ‹ï¼</p>
<p>ä¸‹æ¬¡å½“ä½ é¢å¯¹éœ€è¦æ‹·è´çš„åœºæ™¯æ—¶ï¼Œä¸å¦¨å…ˆæƒ³æƒ³ï¼šè¿™æ˜¯ä¸€ä¸ªéœ€è¦ç‹¬ç«‹é—¨æˆ·çš„æ·±æ‹·è´ï¼Œè¿˜æ˜¯ä¸€ä¸ªå¯ä»¥å…±äº«èŠ¯å­çš„æµ…æ‹·è´ï¼Ÿ</p>
<hr/>
<p>âœ¨ <strong>å°æµ‹éªŒ</strong>ï¼šä½ èƒ½çœ‹å‡ºä¸‹é¢ä»£ç çš„è¾“å‡ºå—ï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">2</span> } };
<span class="hljs-keyword">const</span> shallow = { ...obj };
<span class="hljs-keyword">const</span> deep = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj));

shallow.<span class="hljs-property">b</span>.<span class="hljs-property">c</span> = <span class="hljs-number">999</span>;
deep.<span class="hljs-property">b</span>.<span class="hljs-property">c</span> = <span class="hljs-number">888</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">b</span>.<span class="hljs-property">c</span>); <span class="hljs-comment">// æ˜¯å¤šå°‘ï¼Ÿ</span>
</code></pre>
<p><em>ç­”æ¡ˆï¼š999ï¼Œå› ä¸ºæµ…æ‹·è´å…±äº«äº†åµŒå¥—å¯¹è±¡ï¼</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šé˜¶æ®µåŠ¨æ•ˆå¦‚ä½•æ‘†è„±å›è°ƒåœ°ç‹±ï¼šä¸€ä¸ªåŸºäº ArkUI çš„ AnimationStepper è®¾è®¡]]></title>    <link>https://juejin.cn/post/7584740835368861750</link>    <guid>https://juejin.cn/post/7584740835368861750</guid>    <pubDate>2025-12-18T04:33:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584740835368861750" data-draft-id="7584759201071923241" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šé˜¶æ®µåŠ¨æ•ˆå¦‚ä½•æ‘†è„±å›è°ƒåœ°ç‹±ï¼šä¸€ä¸ªåŸºäº ArkUI çš„ AnimationStepper è®¾è®¡"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-18T04:33:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Archilect"/> <meta itemprop="url" content="https://juejin.cn/user/1505660538979515"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šé˜¶æ®µåŠ¨æ•ˆå¦‚ä½•æ‘†è„±å›è°ƒåœ°ç‹±ï¼šä¸€ä¸ªåŸºäº ArkUI çš„ AnimationStepper è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1505660538979515/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Archilect
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:33:47.000Z" title="Thu Dec 18 2025 04:33:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¤šé˜¶æ®µåŠ¨æ•ˆå¦‚ä½•æ‘†è„±å›è°ƒåœ°ç‹±ï¼šä¸€ä¸ªåŸºäº ArkUI çš„ AnimationStepper è®¾è®¡</h2>
<blockquote>
<p>å…³é”®è¯ï¼šArkUIã€ETSã€å¤šé˜¶æ®µåŠ¨ç”»ã€å›è°ƒåœ°ç‹±ã€åŠ¨ç”»ç¼–æ’</p>
</blockquote>
<p><em>TL;DRï¼šå…ˆæŠŠæ¯ä¸€æ­¥åŠ¨ç”»å®šä¹‰æˆæ•°æ®ï¼Œå†ç”¨ä¸€ä¸ªç»Ÿä¸€é©±åŠ¨å™¨é¡ºåºæ‰§è¡Œï¼Œä½ å°±å†ä¹Ÿä¸ç”¨åœ¨ onFinish é‡Œæ‰‹åŠ¨æ¥åŠ›ã€‚</em></p>
<p>åœ¨å¤æ‚å¼¹çª—å…³é—­åŠ¨æ•ˆé‡Œï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼š</p>
<ul>
<li>å…ˆè½»å¾®æ”¾å¤§æç¤ºã€ŒåŠ¨æ•ˆå¼€å§‹ã€ï¼›</li>
<li>ç„¶åç¼©å°åˆ°ä¸€ä¸ªè¾ƒå°çš„å°ºå¯¸ï¼›</li>
<li>å†åˆ‡æ¢æˆå›¾æ ‡å½¢æ€ï¼Œåšä¸€æ®µæ¥å›æ™ƒåŠ¨ï¼›</li>
<li>æœ€åæ²¿ä¸€æ¡æ›²çº¿æŠ›æ·åˆ°æŸä¸ªç›®æ ‡å…¥å£ã€‚</li>
</ul>
<p>è¿™äº›é˜¶æ®µä¹‹é—´æœ‰ä¸¥æ ¼çš„å…ˆåé¡ºåºï¼Œè€Œä¸”æ¯ä¸ªé˜¶æ®µç”¨çš„åŠ¨ç”»å‚æ•°ï¼ˆæ—¶é•¿ã€æ›²çº¿ã€onFinishï¼‰éƒ½ä¸åŒã€‚<br/>
å¦‚æœä¸åŠ æŠ½è±¡ï¼Œä»£ç å¾ˆå®¹æ˜“å˜æˆä¸€ä¸²åµŒå¥—çš„ <code>animateTo</code> + <code>onFinish</code>ï¼Œç»´æŠ¤æˆæœ¬æé«˜ã€‚</p>
<p>æœ¬æ–‡åˆ†äº«ä¸€å¥—åœ¨ ArkUI/ETS ä¸‹çš„é€šç”¨åšæ³•ï¼š<strong>AnimationStepperï¼ˆåŠ¨ç”»æ­¥éª¤æœºï¼‰</strong>ï¼Œå®ƒæŠŠå¤šé˜¶æ®µåŠ¨ç”»æŠ½è±¡æˆã€Œä»»åŠ¡è¡¨ + ä»»åŠ¡é˜Ÿåˆ—ã€ï¼Œä»æºå¤´ä¸Šæ¶ˆç­å›è°ƒåœ°ç‹±ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€å…¸å‹é—®é¢˜ï¼šå¤šé˜¶æ®µåŠ¨ç”»çš„å›è°ƒåœ°ç‹±</h3>
<p>å…ˆçœ‹ä¸€ä¸ªç®€åŒ–çš„åä¾‹ï¼ˆä¼ªä»£ç ï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ä¼ªä»£ç ç¤ºæ„ï¼šä¸è¦è¿™æ ·å†™</span>
uiCtx.<span class="hljs-title function_">animateTo</span>(step1Param, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// æ­¥éª¤1ï¼šæ”¾å¤§</span>
  popupScale = <span class="hljs-number">1.1</span>
}, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// onFinish1 -&gt; æ­¥éª¤2</span>
  uiCtx.<span class="hljs-title function_">animateTo</span>(step2Param, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æ­¥éª¤2ï¼šç¼©å°</span>
    popupScale = <span class="hljs-number">0.8</span>
  }, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// onFinish2 -&gt; æ­¥éª¤3</span>
    uiCtx.<span class="hljs-title function_">animateTo</span>(step3Param, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// æ­¥éª¤3ï¼šåˆ‡ icon</span>
      form = <span class="hljs-string">'icon'</span>
    }, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// onFinish3 -&gt; æ­¥éª¤4</span>
      uiCtx.<span class="hljs-title function_">animateTo</span>(step4Param, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// æ­¥éª¤4ï¼šæ—‹è½¬</span>
        rotation = <span class="hljs-number">0</span>
      }, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// ...</span>
      })
    })
  })
})
</code></pre>
<blockquote>
<p>æ³¨ï¼šæ–‡ä¸­çš„ <code>popupScale</code>ã€<code>form</code> ç­‰å˜é‡ä»…ä¸ºç¤ºä¾‹ï¼Œä»£è¡¨ä½ åœ¨çœŸå®é¡¹ç›®é‡Œçš„æœ¬åœ° UI çŠ¶æ€ã€‚</p>
</blockquote>
<p>è¿™æ ·å†™çš„ç—›ç‚¹å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼š</p>
<ul>
<li><strong>å¯è¯»æ€§å·®</strong>ï¼šåŠ¨ç”»å‚æ•°å’Œä¸šåŠ¡é€»è¾‘å¤¹åœ¨ä¸€èµ·ï¼Œå¾ˆéš¾å¿«é€Ÿçœ‹å‡ºã€Œæ•´ä¸ªé—­ç¯æœ‰å‡ ä¸ªé˜¶æ®µã€é¡ºåºæ˜¯ä»€ä¹ˆã€ï¼›</li>
<li><strong>æ”¹åŠ¨æˆæœ¬é«˜</strong>ï¼šæƒ³åœ¨ä¸­é—´æ’å…¥/åˆ é™¤ä¸€ä¸ªæ­¥éª¤ï¼Œè¦åŒæ—¶æ”¹å¤šä¸ª <code>onFinish</code>ï¼Œéå¸¸å®¹æ˜“å¼•å…¥ bugï¼›</li>
<li><strong>éš¾ä»¥åŸ‹ç‚¹å’Œè°ƒè¯•</strong>ï¼šæ¯ä¸€æ­¥å¼€å§‹/ç»“æŸéƒ½æƒ³æ‰“æ—¥å¿—/åŸ‹ç‚¹æ—¶ï¼Œåªèƒ½åœ¨å„ä¸ª <code>onFinish</code> é‡Œæ‰‹åŠ¨åŠ ï¼›</li>
<li><strong>éš¾ä»¥å¤ç”¨</strong>ï¼šå¦ä¸€å¤„å¦‚æœä¹Ÿè¦åšç±»ä¼¼çš„å¤šé˜¶æ®µåŠ¨æ•ˆï¼Œåªèƒ½å†å¤åˆ¶ä¸€ä»½å›è°ƒåœ°ç‹±ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¸Œæœ›æŠŠã€Œå¤šé˜¶æ®µåŠ¨ç”»ã€çš„æ—¶åºï¼Œå˜æˆä¸€å¼ ä¸€ç›®äº†ç„¶çš„ã€Œä»»åŠ¡åˆ—è¡¨ã€ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªç»Ÿä¸€çš„é©±åŠ¨å™¨æ¥é¡ºåºæ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒæ€æƒ³ï¼šä»»åŠ¡è¡¨ + ä»»åŠ¡é˜Ÿåˆ— + ç»Ÿä¸€é©±åŠ¨</h3>
<p>æ€è·¯éå¸¸ç®€å•ï¼š</p>
<ul>
<li>ç”¨ä¸€ä¸ª <strong>ä»»åŠ¡è¡¨ï¼ˆTask Mapï¼‰</strong> æè¿°ã€Œæ¯ä¸ªä»»åŠ¡åå¯¹åº”çš„ä¸€æ®µåŠ¨ç”»ã€ï¼›</li>
<li>æ¯æ®µåŠ¨ç”»ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š
<ul>
<li><code>change</code>ï¼šè¦ä¿®æ”¹çš„å±æ€§ï¼ˆscaleã€rotationã€form ç­‰ï¼‰ï¼›</li>
<li><code>animateParam</code>ï¼šè¿™æ¬¡åŠ¨ç”»çš„å‚æ•°ï¼ˆdurationã€curveã€delayã€onFinish ç­‰ï¼‰ï¼›</li>
</ul>
</li>
<li>ç”¨ä¸€ä¸ª <strong>ä»»åŠ¡é˜Ÿåˆ—ï¼ˆTask Queueï¼‰</strong> è¡¨ç¤ºã€Œè¿™ä¸€æ¬¡å…³é—­åŠ¨æ•ˆè¦èµ°å“ªäº›æ­¥éª¤ã€ï¼›</li>
<li>ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ <strong>AnimationStepper</strong> é©±åŠ¨å™¨ï¼š
<ul>
<li>å–å‡ºé˜Ÿåˆ—å¤´éƒ¨ä»»åŠ¡ï¼›</li>
<li>è°ƒç”¨ <code>uiCtx.animateTo(animateParam, change)</code>ï¼›</li>
<li>åŠ¨ç”»ç»“æŸåï¼Œè‡ªåŠ¨æ¨è¿›åˆ°ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼ˆé™¤éå½“å‰ä»»åŠ¡è‡ªå®šä¹‰äº† <code>onFinish</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p>ç”¨ mermaid ç”»ä¸€ä¸ªç®€å•çš„æµç¨‹ç¤ºæ„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
  participant Popup as PopupContainer
  participant Engine as CloseAnimationEngine
  participant Stepper as AnimationStepper
  participant UI as ArkUI Context

  Popup-&gt;&gt;Engine: onClose()
  Engine-&gt;&gt;Stepper: start([task1, task2, task3...])
  loop for each task
    Stepper-&gt;&gt;UI: animateTo(animateParam, change)
    UI--&gt;&gt;Stepper: onFinish()
    Stepper-&gt;&gt;Stepper: play next task (default)
  end
  Stepper--&gt;&gt;Engine: all tasks done
  Engine--&gt;&gt;Popup: emitCloseFinished()
</code></pre>
<blockquote>
<p>å¦‚æœå¹³å°ä¸æ”¯æŒ mermaidï¼Œå¯å¤åˆ¶ä»£ç å—åˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fmermaid.live" target="_blank" title="https://mermaid.live" ref="nofollow noopener noreferrer">mermaid.live</a> æŸ¥çœ‹ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€AnimationStepper çš„é€šç”¨æ¥å£è®¾è®¡</h3>
<p>åœ¨ ArkUI/ETS ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ AnimationStepper è®¾è®¡æˆä¸€ä¸ªä¸ä¸šåŠ¡å®Œå…¨è§£è€¦çš„ç±»ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åŠ¨ç”»æ­¥éª¤çš„æè¿°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">StepConfig</span> {
  <span class="hljs-attr">change</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>              <span class="hljs-comment">// è¿™ä¸€æ­¥è¦ä¿®æ”¹çš„å±æ€§</span>
  animateParam?: <span class="hljs-title class_">AnimateParam</span>     <span class="hljs-comment">// ArkUI animateTo çš„å‚æ•°ï¼ˆå¯é€‰ï¼‰</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AnimationStepper</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">stepMap</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">StepConfig</span>&gt;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">queue</span>: <span class="hljs-built_in">string</span>[] = []

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">stepMap: Record&lt;<span class="hljs-built_in">string</span>, StepConfig&gt;</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stepMap</span> = stepMap
  }

  <span class="hljs-title function_">start</span>(<span class="hljs-attr">taskList</span>: <span class="hljs-built_in">string</span>[]): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!taskList || taskList.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [...taskList]  <span class="hljs-comment">// æ‹·è´ä¸€ä»½ï¼Œé¿å…å¤–éƒ¨ä¿®æ”¹</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">play</span>()
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">play</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> taskName = <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">shift</span>()
    <span class="hljs-keyword">if</span> (!taskName) {
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">const</span> step = <span class="hljs-variable language_">this</span>.<span class="hljs-property">stepMap</span>[taskName]
    <span class="hljs-keyword">if</span> (!step) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`Unknown animation step: <span class="hljs-subst">${taskName}</span>`</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">play</span>()  <span class="hljs-comment">// è·³è¿‡éæ³•ä»»åŠ¡ï¼Œç»§ç»­ä¸‹ä¸€ä¸ª</span>
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">const</span> p = step.<span class="hljs-property">animateParam</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">animParam</span>: <span class="hljs-title class_">AnimateParam</span> = {
      <span class="hljs-attr">duration</span>: p?.<span class="hljs-property">duration</span>,
      <span class="hljs-attr">curve</span>: p?.<span class="hljs-property">curve</span>,
      <span class="hljs-attr">delay</span>: p?.<span class="hljs-property">delay</span>,
      <span class="hljs-attr">iterations</span>: p?.<span class="hljs-property">iterations</span>,
      <span class="hljs-attr">playMode</span>: p?.<span class="hljs-property">playMode</span>,
      <span class="hljs-comment">// å¦‚æœæ²¡æœ‰è‡ªå®šä¹‰ onFinishï¼Œå°±è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€ä¸ªä»»åŠ¡</span>
      <span class="hljs-attr">onFinish</span>: p?.<span class="hljs-property">onFinish</span> ?? (<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">play</span>()),
    }

    <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œç”¨çš„æ˜¯å…¨å±€çš„æˆ–æ³¨å…¥çš„ uiContext</span>
    uiContext.<span class="hljs-title function_">animateTo</span>(animParam, step.<span class="hljs-property">change</span>)
  }
}
</code></pre>
<p>è¦ç‚¹ï¼š</p>
<ul>
<li><strong>ä»»åŠ¡è¡¨ stepMap</strong> é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ï¼ŒAnimationStepper æœ¬èº«ä¸çŸ¥é“ã€Œä¸šåŠ¡æ˜¯ä»€ä¹ˆã€ï¼Œåªè´Ÿè´£è°ƒåº¦ï¼›</li>
<li><code>start()</code> åªæ¥æ”¶ä»»åŠ¡åæ•°ç»„ï¼Œå¤–éƒ¨å¯ä»¥é€šè¿‡ä¸åŒæ•°ç»„æ¥ç»„åˆä¸åŒé“¾è·¯ï¼›</li>
<li>é»˜è®¤ <code>onFinish</code> ä¼šè‡ªåŠ¨æ¨è¿› <code>play()</code>ï¼Œåªæœ‰åœ¨ä½ æ˜ç¡®å†™äº† <code>onFinish</code> æ—¶ï¼Œæ‰ä¼šè¦†ç›–è¿™ä¸ªè¡Œä¸ºã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">å››ã€æŠŠå…³é—­åŠ¨æ•ˆæ‹†æˆä»»åŠ¡ï¼šä¸¤ä¸ªé“¾è·¯çš„ä»»åŠ¡è¡¨è®¾è®¡</h3>
<p>ä»¥ä¸€ä¸ªé€šç”¨çš„å…³é—­åŠ¨æ•ˆä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¾è®¡ä»¥ä¸‹å‡ ä¸ªä»»åŠ¡ï¼ˆåå­—èµ·å¾—è¯­ä¹‰åŒ–ä¸€ç‚¹ï¼Œä¾¿äºé˜…è¯»ï¼‰ï¼š</p>
<ul>
<li><code>centerScaleUp</code>ï¼šå±…ä¸­è½»å¾®æ”¾å¤§ï¼Œæ¯”å¦‚ 1.0 â†’ 1.1ï¼›</li>
<li><code>centerScaleDownToIcon</code>ï¼šä»åŸå§‹å°ºå¯¸ç¼©å°åˆ°æ¥è¿‘å›¾æ ‡å¤§å°ï¼›</li>
<li><code>switchToIcon</code>ï¼šåˆ‡æ¢åˆ° icon å½¢æ€ï¼›</li>
<li><code>wobbleIcon</code>ï¼šä½¿ç”¨å¼¹ç°§æ›²çº¿åšæ¥å›æ™ƒåŠ¨ï¼›</li>
<li><code>shrinkAndThrow</code>ï¼šç¼©å°å¹¶æ²¿è´å¡å°”æ›²çº¿æŠ›æ·åˆ°ç»ˆç‚¹ã€‚</li>
</ul>
<p>å¯¹äºã€Œæ— å›¾æ ‡æ¨¡å¼ã€ï¼Œä»»åŠ¡é“¾å¯ä»¥æ˜¯ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> tasksWithoutIcon = [<span class="hljs-string">'centerScaleUp'</span>]  <span class="hljs-comment">// onFinish é‡Œç›´æ¥æ¥ shrinkAndThrow</span>
</code></pre>
<p>å¯¹äºã€Œæœ‰å›¾æ ‡æ¨¡å¼ã€ï¼Œä»»åŠ¡é“¾å¯ä»¥æ˜¯ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> tasksWithIcon = [<span class="hljs-string">'centerScaleDownToIcon'</span>, <span class="hljs-string">'switchToIcon'</span>] <span class="hljs-comment">// switchToIcon çš„ onFinish å†èµ· wobble</span>
</code></pre>
<p>å¯¹åº”çš„ä»»åŠ¡è¡¨ç¤ºä¾‹ï¼ˆä¼ªä»£ç ï¼Œ<code>popupState</code>/<code>engine</code> å‡æŒ‡ä»£ä½ æŒæœ‰çš„æœ¬åœ° UI çŠ¶æ€ä¸åŠ¨æ•ˆå¼•æ“å®ä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">stepMap</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">StepConfig</span>&gt; = {
  <span class="hljs-attr">centerScaleUp</span>: {
    <span class="hljs-attr">change</span>: <span class="hljs-function">() =&gt;</span> {
      popupState.<span class="hljs-property">scale</span> = <span class="hljs-number">1.1</span>
    },
    <span class="hljs-attr">animateParam</span>: {
      <span class="hljs-attr">duration</span>: <span class="hljs-number">400</span>,
      <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseOut</span>,
      <span class="hljs-attr">onFinish</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// æ—  icon æ¨¡å¼ä¸‹ï¼Œç›´æ¥è¿›å…¥æŠ›æ·</span>
        engine.<span class="hljs-title function_">startThrowAnimation</span>()
      },
    },
  },
  <span class="hljs-attr">centerScaleDownToIcon</span>: {
    <span class="hljs-attr">change</span>: <span class="hljs-function">() =&gt;</span> {
      popupState.<span class="hljs-property">scale</span> = engine.<span class="hljs-property">iconScale</span>
    },
    <span class="hljs-attr">animateParam</span>: { <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span> },
  },
  <span class="hljs-attr">switchToIcon</span>: {
    <span class="hljs-attr">change</span>: <span class="hljs-function">() =&gt;</span> {
      popupState.<span class="hljs-property">form</span> = <span class="hljs-string">'icon'</span>
    },
    <span class="hljs-attr">animateParam</span>: {
      <span class="hljs-attr">duration</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">onFinish</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// åˆ‡ icon å®Œæˆåï¼Œå•ç‹¬å¼€ä¸€æ¡ wobble é“¾è·¯</span>
        stepper.<span class="hljs-title function_">start</span>([<span class="hljs-string">'wobbleIcon'</span>])
      },
    },
  },
  <span class="hljs-attr">wobbleIcon</span>: {
    <span class="hljs-attr">change</span>: <span class="hljs-function">() =&gt;</span> {
      popupState.<span class="hljs-property">rotation</span> = <span class="hljs-number">0</span>
    },
    <span class="hljs-attr">animateParam</span>: {
      <span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>(<span class="hljs-number">0.125</span>, <span class="hljs-number">0.25</span>),
      <span class="hljs-attr">onFinish</span>: <span class="hljs-function">() =&gt;</span> {
        engine.<span class="hljs-title function_">startThrowAnimation</span>()
      },
    },
  },
}
</code></pre>
<p>è¿™æ ·ï¼Œæ•´ä¸ªåŠ¨æ•ˆçš„æ—¶é—´è½´å°±å˜æˆäº†ä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>ã€Œä¸­å¿ƒç¼©æ”¾ + åˆ‡ icon + wobbleã€ç”± AnimationStepper ç®¡ç†</strong>ï¼›</li>
<li><strong>ã€Œç¼©å° + æŠ›æ· + å…‰åœˆã€ç”± CloseAnimationEngineï¼ˆåŠ¨æ•ˆå¼•æ“ï¼‰å®ç°</strong>ï¼Œè¢«å½“æˆä¸€ä¸ªæ›´ç²—ç²’åº¦çš„æ­¥éª¤ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-5">äº”ã€å’Œä¸šåŠ¡é€»è¾‘çš„åˆ†å±‚ï¼šStepper åªå…³å¿ƒã€Œæ€ä¹ˆåŠ¨ã€ï¼Œä¸å…³å¿ƒã€Œä¸ºä»€ä¹ˆåŠ¨ã€</h3>
<p>å®é™…é¡¹ç›®ä¸­ï¼Œå¾ˆå¤šäººä¼šä¸è‡ªè§‰åœ°æŠŠä¸šåŠ¡é€»è¾‘å†™è¿›åŠ¨ç”»æ­¥éª¤é‡Œï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>åœ¨ <code>onFinish</code> é‡Œç›´æ¥åšç½‘ç»œè¯·æ±‚ï¼›</li>
<li>åœ¨ <code>change</code> é‡Œé¡ºå¸¦æ”¹ä¸šåŠ¡çŠ¶æ€ï¼›</li>
<li>åœ¨åŠ¨ç”»æ•°ç»„é‡Œæ··å…¥ä¸€å †åŸ‹ç‚¹é€»è¾‘ã€‚</li>
</ul>
<p>ä¸ºäº†ä¿æŒ AnimationStepper çš„å¯å¤ç”¨æ€§ï¼Œæˆ‘ä»¬å»ºè®®ï¼š</p>
<ul>
<li><strong>ä¸šåŠ¡é€»è¾‘æ”¾åœ¨ä¸Šå±‚ Engine é‡Œ</strong>ï¼š<br/>
æ¯”å¦‚ CloseAnimationEngine ä½œä¸ºåŠ¨æ•ˆå¼•æ“ï¼Œå†³å®šä»€ä¹ˆæ—¶å€™æ’­æ”¾å¤æ‚å…³é—­åŠ¨ç”»ã€ä»€ä¹ˆæ—¶å€™ç›´æ¥å…³é—­ã€ä»€ä¹ˆæ—¶å€™åªæ’­æ”¾éƒ¨åˆ†é“¾è·¯ï¼›</li>
<li><strong>Stepper åªæ¥æ”¶ã€Œè¦ä¿®æ”¹çš„çŠ¶æ€ã€å’Œã€ŒåŠ¨ç”»å‚æ•°ã€</strong>ï¼š<br/>
å®ƒåªè´Ÿè´£ã€Œåœ¨å¤šé•¿æ—¶é—´å†…ï¼ŒæŠŠ state ä» A è°ƒåˆ° Bã€ï¼›</li>
<li><strong>åŸ‹ç‚¹/æ—¥å¿—é€šè¿‡ Hook çš„æ–¹å¼æ³¨å…¥</strong>ï¼š<br/>
å¯ä»¥åœ¨ <code>onFinish</code> é‡Œè°ƒç”¨ä¸Šå±‚æ³¨å…¥çš„å›è°ƒï¼Œè€Œä¸æ˜¯ç›´æ¥å†™å…·ä½“åŸ‹ç‚¹ APIã€‚</li>
</ul>
<p>ä¸€ä¸ªå…¸å‹çš„åˆ†å±‚å†™æ³•æ˜¯ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CloseAnimationEngine</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">stepper</span>: <span class="hljs-title class_">AnimationStepper</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stepper</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnimationStepper</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildStepMap</span>())
  }

  <span class="hljs-title function_">startCloseAnimation</span>(<span class="hljs-params">options: { hasIcon: <span class="hljs-built_in">boolean</span> }</span>) {
    <span class="hljs-keyword">const</span> tasks = options.<span class="hljs-property">hasIcon</span>
      ? [<span class="hljs-string">'centerScaleDownToIcon'</span>, <span class="hljs-string">'switchToIcon'</span>]
      : [<span class="hljs-string">'centerScaleUp'</span>]
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stepper</span>.<span class="hljs-title function_">start</span>(tasks)
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">buildStepMap</span>(): <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">StepConfig</span>&gt; {
    <span class="hljs-comment">// è¿™é‡Œç»„è£… stepMapï¼Œå†…éƒ¨å¯ä»¥è®¿é—® popupState ç­‰</span>
    <span class="hljs-comment">// ä½†ä¸è¦ç›´æ¥å†™å…·ä½“ä¸šåŠ¡åŸ‹ç‚¹</span>
    <span class="hljs-keyword">return</span> { <span class="hljs-comment">/* ... */</span> }
  }
}
</code></pre>
<p>è¿™æ ·ï¼ŒAnimationStepper å°±å¯ä»¥åœ¨å¤šä¸ªåŠ¨æ•ˆåœºæ™¯ï¼ˆä¸æ­¢å…³é—­åŠ¨æ•ˆï¼‰ä¸­è¢«å¤ç”¨ã€‚</p>
<hr/>
<h3 data-id="heading-6">å…­ã€å®æˆ˜ä¸­çš„å‡ ä¸ªç»éªŒå’Œå‘</h3>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ AnimationStepper æ—¶è¸©è¿‡ä¸€äº›å‘ï¼Œä¹Ÿæœ‰ä¸€äº›å®è·µç»éªŒå¯ä»¥åˆ†äº«ï¼š</p>
<h4 data-id="heading-7">1. ç”¨è¯­ä¹‰åŒ–ä»»åŠ¡åï¼Œé¿å…ã€Œstep1/step2/step3ã€</h4>
<p>ä¸å…¶å†™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">[<span class="hljs-string">'step1'</span>, <span class="hljs-string">'step2'</span>, <span class="hljs-string">'step3'</span>]
</code></pre>
<p>ä¸å¦‚å†™æˆï¼š</p>
<pre><code class="hljs language-ts" lang="ts">[<span class="hljs-string">'centerScaleUp'</span>, <span class="hljs-string">'switchToIcon'</span>, <span class="hljs-string">'wobbleIcon'</span>]
</code></pre>
<p>è¿™æ ·å½“ä½ åœ¨æ—¥å¿—/åŸ‹ç‚¹é‡Œè®°å½•ä»»åŠ¡åæ—¶ï¼Œä¹Ÿèƒ½ä¸€çœ¼çœ‹æ‡‚ç°åœ¨è¿è¡Œåˆ°äº†å“ªä¸€æ­¥ã€‚</p>
<h4 data-id="heading-8">2. é»˜è®¤é€’å½’æ¨è¿› + è‡ªå®šä¹‰ onFinish</h4>
<p>é»˜è®¤çš„ç­–ç•¥æ˜¯ï¼šå¦‚æœæ²¡æœ‰å®šä¹‰ <code>onFinish</code>ï¼ŒStepper å°±è‡ªåŠ¨å»è·‘ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚<br/>
è¿™å·²ç»èƒ½è¦†ç›–å¤§éƒ¨åˆ†ã€Œçº¿æ€§å¤šé˜¶æ®µã€åœºæ™¯ã€‚</p>
<p>åªæœ‰å½“ä½ éœ€è¦æ‰“æ–­æµç¨‹ï¼ˆæ¯”å¦‚åœ¨æŸä¸€æ­¥é‡å¯ä¸€æ¡æ–°é“¾è·¯ï¼Œæˆ–åœ¨æŸä¸€æ­¥ç»“æŸæ•´ä¸ªåŠ¨æ•ˆï¼‰æ—¶ï¼Œæ‰å»è‡ªå®šä¹‰ <code>onFinish</code>ã€‚<br/>
ä¾‹å¦‚ä¸Šæ–‡çš„ <code>switchToIcon</code> å’Œ <code>wobbleIcon</code>ã€‚</p>
<h4 data-id="heading-9">3. æ³¨æ„å¼‚æ­¥é€»è¾‘ä¸å¤šæ¬¡ start</h4>
<p>å¦‚æœæŸä¸ªæ­¥éª¤é‡Œè¿˜åŒ…å«å¼‚æ­¥é€»è¾‘ï¼ˆä¾‹å¦‚ç­‰å¾…æŸä¸ªèµ„æº load å®Œæˆï¼‰ï¼Œè¦æ³¨æ„é˜²æ­¢ã€Œé‡å¤ startã€å¯¼è‡´é˜Ÿåˆ—è¢«è¦†ç›–æˆ–äº¤é”™ã€‚<br/>
å»ºè®®ï¼š</p>
<ul>
<li>æ¯æ¬¡ <code>start</code> å‰å†…éƒ¨æ¸…ç©ºé˜Ÿåˆ—ï¼›</li>
<li>å¯¹äºæ¶‰åŠå¼‚æ­¥çš„æ­¥éª¤ï¼Œé¢å¤–åœ¨ä¸Šå±‚ Engine åšçŠ¶æ€é˜²æŠ–ï¼ˆä¾‹å¦‚ã€ŒåŠ¨æ•ˆè¿è¡Œä¸­ã€æ ‡è®°ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-10">4. ç»™æ¯ä¸€æ­¥åŸ‹ç‚¹æˆ–æ‰“æ—¥å¿—</h4>
<p>AnimationStepper çš„ä¸€ä¸ªå·¨å¤§ä¼˜åŠ¿æ˜¯ï¼š<br/>
<strong>å®ƒä¸ºæ¯ä¸€æ­¥åŠ¨ç”»å¤©ç„¶æä¾›äº†ä¸€ä¸ªã€Œå”¯ä¸€ä»»åŠ¡åã€</strong>ï¼Œå¯ä»¥ç”¨æ¥åšåŸ‹ç‚¹æˆ–æ—¥å¿—ã€‚</p>
<p>æ¯”å¦‚åœ¨ <code>play()</code> é‡ŒåŠ ä¸€è¡Œï¼š</p>
<pre><code class="hljs language-ts" lang="ts">logger.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[AnimationStepper] start task: <span class="hljs-subst">${taskName}</span>`</span>)
</code></pre>
<p>å†åœ¨ onFinish é‡ŒåŠ ä¸€ä¸ªç»“æŸæ—¶é—´æˆ³ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°ç»Ÿè®¡å‡ºï¼š</p>
<ul>
<li>æ¯ä¸€æ­¥çš„å¹³å‡è€—æ—¶ï¼›</li>
<li>å“ªä¸€æ­¥æœ€å®¹æ˜“è¢«ç”¨æˆ·ä¸­æ–­ï¼›</li>
<li>ä¸åŒåŠ¨ç”»å‚æ•°å¯¹ç”¨æˆ·è¡Œä¸ºçš„å½±å“ã€‚</li>
</ul>
<h4 data-id="heading-11">5. HarmonyOS å…³é”®å¸§åŠ¨ç”»ä¸ motionPath çš„å‘</h4>
<ul>
<li><strong>å…³é”®å¸§æ¥å£ä¸‹çš„ motionPath å¤±æ•ˆ</strong>ï¼šå®æµ‹é¸¿è’™è‡ªå¸¦çš„å¤šæ­¥éª¤/å…³é”®å¸§åŠ¨ç”»æ¥å£ä¸­ï¼Œ<code>motionPath</code> ä¼šè¢«å¿½ç•¥ï¼Œè·¯å¾„æ®µç›´æ¥ä¸ç”Ÿæ•ˆï¼›ç›®å‰åªèƒ½ç”¨ <code>animateTo</code> ä¸²è”ï¼ˆæˆ–ç”¨ AnimationStepper è¿™ç±»æ­¥éª¤æœºï¼‰æ¥åˆ†æ®µæ§åˆ¶ã€‚</li>
<li><strong>ä¿®æ”¹ motionPath éœ€ä¼´éšå¸ƒå±€å±æ€§åˆ·æ–°</strong>ï¼šä»…æ›´æ–° <code>motionPath</code> å­—ç¬¦ä¸²ä¸ä¼šç«‹åˆ»ç”Ÿæ•ˆï¼Œé€šå¸¸éœ€è¦åŒæ—¶å˜æ›´ä¸€æ¬¡ä½ç½®/å¸ƒå±€å±æ€§ï¼ˆå¦‚ <code>position</code> / <code>offset</code>ï¼‰æ¥è§¦å‘é‡ç»˜ï¼Œè·¯å¾„åŠ¨ç”»æ‰ä¼šå¯åŠ¨ã€‚</li>
<li>å½“å‰ç‰ˆæœ¬å®æµ‹çš„é™åˆ¶/å¯èƒ½æ˜¯å¹³å°ç¼ºé™·ï¼Œæ¬¢è¿æœ‰è§£æ³•çš„è¯»è€…è¡¥å……</li>
</ul>
<hr/>
<h3 data-id="heading-12">ä¸ƒã€å°ç»“</h3>
<p>è¿™ä¸€ç¯‡æˆ‘ä»¬å›´ç»•ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜å±•å¼€ï¼š<strong>å¦‚ä½•ä¼˜é›…åœ°ç¼–æ’å¤šé˜¶æ®µåŠ¨æ•ˆï¼Œè€Œä¸æ˜¯æ‰è¿›å›è°ƒåœ°ç‹±ã€‚</strong></p>
<p>é€šè¿‡ AnimationStepper è¿™ä¸ªè½»é‡æŠ½è±¡ï¼Œæˆ‘ä»¬æŠŠå¤šé˜¶æ®µåŠ¨ç”»æ‹†æˆä¸‰éƒ¨åˆ†ï¼š</p>
<ul>
<li>ä»»åŠ¡è¡¨ï¼šå®šä¹‰æ¯ä¸€æ­¥è¦æ”¹ä»€ä¹ˆã€æ€ä¹ˆåŠ¨ï¼›</li>
<li>ä»»åŠ¡é˜Ÿåˆ—ï¼šå®šä¹‰è¿™æ¬¡è¦æŒ‰ä»€ä¹ˆé¡ºåºèµ°å“ªäº›æ­¥éª¤ï¼›</li>
<li>ç»Ÿä¸€é©±åŠ¨å™¨ï¼šè´Ÿè´£æŒ‰é¡ºåºæ‰§è¡Œä»»åŠ¡ï¼Œé»˜è®¤å¸®åŠ©è¡”æ¥ä¸‹ä¸€æ­¥ã€‚</li>
</ul>
<p>è¿™å¥—æ¨¡å¼ä¸ä»…é€‚ç”¨äºå¼¹çª—å…³é—­åŠ¨æ•ˆï¼Œä»»ä½•ã€Œå¤šæ­¥éª¤ UI åŠ¨ç”»ã€åœºæ™¯éƒ½å¯ä»¥å‚è€ƒï¼š<br/>
æ¯”å¦‚å¡ç‰‡å±•å¼€/æ”¶èµ·ã€å¼•å¯¼æµç¨‹ã€Tab åˆ‡æ¢è¿‡æ¸¡ç­‰ã€‚</p>
<p>åœ¨ä¸‹ä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬ä¼šæŠŠè§†è§’è½¬å‘ã€Œç©ºé—´ã€ï¼š<br/>
å¦‚ä½•åœ¨ ArkUI é‡Œç¨³å¥åœ°è®¡ç®—åŒå±‚å®¹å™¨çš„å°ºå¯¸å’Œä½ç½®ï¼Œä¿®æ­£ç¼©æ”¾å¸¦æ¥çš„è§†è§‰åç§»ï¼Œå¹¶ç”Ÿæˆæ—¢è‡ªç„¶åˆã€Œæ‰“å¾—å‡†ã€çš„æŠ›æ·è·¯å¾„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è„šæ‰‹æ¶å¼€å‘å·¥å…·â€”â€”npmlog]]></title>    <link>https://juejin.cn/post/7584780417103167528</link>    <guid>https://juejin.cn/post/7584780417103167528</guid>    <pubDate>2025-12-18T05:10:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584780417103167528" data-draft-id="7584731726733377551" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è„šæ‰‹æ¶å¼€å‘å·¥å…·â€”â€”npmlog"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-18T05:10:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="code_YuJun"/> <meta itemprop="url" content="https://juejin.cn/user/3615612462441358"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è„šæ‰‹æ¶å¼€å‘å·¥å…·â€”â€”npmlog
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3615612462441358/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    code_YuJun
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:10:32.000Z" title="Thu Dec 18 2025 05:10:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç®€ä»‹</h2>
<p><code>npmlog</code>Â æ˜¯ npm å®˜æ–¹çš„æ—¥å¿—å·¥å…·ï¼Œæ”¯æŒé«˜åº¦å®šåˆ¶åŒ–ï¼ŒåŒ…æ‹¬æ—¥å¿—çº§åˆ«ã€è¾“å‡ºæ ¼å¼ã€å‰ç¼€ã€é¢œè‰²ã€è‡ªå®šä¹‰æ—¥å¿—ç±»å‹ã€æ–‡ä»¶è¾“å‡ºç­‰ã€‚</p>
<h4 data-id="heading-1">è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼ˆè¿‡æ»¤è¾“å‡ºï¼‰</h4>
<p><code>npmlog</code>Â å†…ç½® 7 ä¸ªæ—¥å¿—çº§åˆ«ï¼ˆä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼‰ï¼š<code>silent</code>Â â†’Â <code>error</code>Â â†’Â <code>warn</code>Â â†’Â <code>info</code>Â â†’Â <code>verbose</code>Â â†’Â <code>debug</code>Â â†’Â <code>silly</code>
é€šè¿‡Â <code>level</code>Â å±æ€§è®¾ç½®å½“å‰ç”Ÿæ•ˆçº§åˆ«ï¼Œä»…è¾“å‡º â‰¥ è¯¥çº§åˆ«çš„æ—¥å¿—ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> log = <span class="hljs-built_in">require</span>(<span class="hljs-string">'npmlog'</span>);
<span class="hljs-comment">// åŸºç¡€é…ç½®ï¼šè®¾ç½®æ—¥å¿—çº§åˆ«ï¼ˆé»˜è®¤ infoï¼‰</span>
log.<span class="hljs-property">level</span> = <span class="hljs-string">'verbose'</span>; <span class="hljs-comment">// æ­¤æ—¶ error/warn/info/verbose ä¼šè¾“å‡ºï¼Œdebug/silly è¢«è¿‡æ»¤</span>
<span class="hljs-comment">// log.level = 'silent'; // å…³é—­æ‰€æœ‰æ—¥å¿—è¾“å‡º</span>
<span class="hljs-comment">// æµ‹è¯•ä¸åŒçº§åˆ«</span>
log.<span class="hljs-title function_">error</span>(<span class="hljs-string">'err'</span>, <span class="hljs-string">'é”™è¯¯ä¿¡æ¯'</span>);   <span class="hljs-comment">// å§‹ç»ˆè¾“å‡ºï¼ˆçº§åˆ«æœ€é«˜ï¼‰</span>
log.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'warn'</span>, <span class="hljs-string">'è­¦å‘Šä¿¡æ¯'</span>);   <span class="hljs-comment">// è¾“å‡º</span>
log.<span class="hljs-title function_">info</span>(<span class="hljs-string">'info'</span>, <span class="hljs-string">'æ™®é€šä¿¡æ¯'</span>);   <span class="hljs-comment">// è¾“å‡º</span>
log.<span class="hljs-title function_">verbose</span>(<span class="hljs-string">'verb'</span>, <span class="hljs-string">'è¯¦ç»†ä¿¡æ¯'</span>);<span class="hljs-comment">// è¾“å‡ºï¼ˆå›  level=verboseï¼‰</span>
log.<span class="hljs-title function_">debug</span>(<span class="hljs-string">'debug'</span>, <span class="hljs-string">'è°ƒè¯•ä¿¡æ¯'</span>); <span class="hljs-comment">// ä¸è¾“å‡º</span>
log.<span class="hljs-title function_">silly</span>(<span class="hljs-string">'silly'</span>, <span class="hljs-string">'å†—ä½™ä¿¡æ¯'</span>); <span class="hljs-comment">// ä¸è¾“å‡º</span>
</code></pre>
<h4 data-id="heading-2">å®šåˆ¶æ—¥å¿—æ ·å¼ï¼ˆé¢œè‰² / æ ¼å¼ï¼‰</h4>
<p><code>npmlog</code>Â åŸºäºÂ <code>ansi-styles</code>Â æ”¯æŒç»ˆç«¯é¢œè‰² / æ ·å¼å®šåˆ¶ï¼Œå¯é…ç½®ï¼š</p>
<ul>
<li><code>fg</code>ï¼šå‰æ™¯è‰²ï¼ˆblack/red/green/yellow/blue/magenta/cyan/white/grayï¼‰</li>
<li><code>bg</code>ï¼šèƒŒæ™¯è‰²ï¼ˆåŒä¸Šï¼ŒåŠ Â <code>Bg</code>Â å‰ç¼€ï¼Œå¦‚Â <code>bgRed</code>ï¼‰</li>
<li><code>bold/italic/underline/strikethrough</code>ï¼šæ–‡å­—æ ·å¼</li>
</ul>
<ol>
<li>è‡ªå®šä¹‰å†…ç½®çº§åˆ«æ ·å¼</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// é‡å†™ error çº§åˆ«çš„æ ·å¼ï¼ˆçº¢è‰²èƒŒæ™¯+ç™½è‰²åŠ ç²—ï¼‰</span>
log.<span class="hljs-property">levels</span>.<span class="hljs-property">error</span> = {
  <span class="hljs-attr">color</span>: <span class="hljs-string">'white'</span>,
  <span class="hljs-attr">bg</span>: <span class="hljs-string">'red'</span>,
  <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">level</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// ä¼˜å…ˆçº§ï¼ˆ0 æœ€é«˜ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šä½ï¼‰</span>
};

<span class="hljs-comment">// é‡å†™ info çº§åˆ«çš„æ ·å¼ï¼ˆç»¿è‰²å‰æ™¯+åŠ ç²—ï¼‰</span>
log.<span class="hljs-property">levels</span>.<span class="hljs-property">info</span> = {
  <span class="hljs-attr">color</span>: <span class="hljs-string">'green'</span>,
  <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">level</span>: <span class="hljs-number">2</span>
};

log.<span class="hljs-title function_">error</span>(<span class="hljs-string">'err'</span>, <span class="hljs-string">'è‡ªå®šä¹‰æ ·å¼çš„é”™è¯¯æ—¥å¿—'</span>);
log.<span class="hljs-title function_">info</span>(<span class="hljs-string">'info'</span>, <span class="hljs-string">'è‡ªå®šä¹‰æ ·å¼çš„ä¿¡æ¯æ—¥å¿—'</span>);
</code></pre>
<ol start="2">
<li>æ–°å¢è‡ªå®šä¹‰æ—¥å¿—çº§åˆ«
å¦‚æœå†…ç½®çº§åˆ«ä¸å¤Ÿï¼Œå¯æ‰©å±•è‡ªå®šä¹‰çº§åˆ«ï¼ˆå¦‚Â <code>success</code>/<code>trace</code>ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ­¥éª¤1ï¼šæ·»åŠ è‡ªå®šä¹‰çº§åˆ«ï¼ˆæŒ‡å®šä¼˜å…ˆçº§å’Œæ ·å¼ï¼‰</span>
log.<span class="hljs-title function_">addLevel</span>(<span class="hljs-string">'success'</span>, <span class="hljs-number">2</span>, { <span class="hljs-attr">fg</span>: <span class="hljs-string">'green'</span>, <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// ä¼˜å…ˆçº§å’Œ info ç›¸åŒï¼ˆ2ï¼‰</span>
log.<span class="hljs-title function_">addLevel</span>(<span class="hljs-string">'trace'</span>, <span class="hljs-number">4</span>, { <span class="hljs-attr">fg</span>: <span class="hljs-string">'gray'</span>, <span class="hljs-attr">italic</span>: <span class="hljs-literal">true</span> });   <span class="hljs-comment">// ä¼˜å…ˆçº§ä½äº verboseï¼ˆ3ï¼‰</span>

<span class="hljs-comment">// æ­¥éª¤2ï¼šä½¿ç”¨è‡ªå®šä¹‰çº§åˆ«</span>
log.<span class="hljs-title function_">success</span>(<span class="hljs-string">'ok'</span>, <span class="hljs-string">'æ“ä½œæˆåŠŸï¼'</span>);
log.<span class="hljs-title function_">trace</span>(<span class="hljs-string">'trace'</span>, <span class="hljs-string">'è¿½è¸ªæ—¥å¿—...'</span>);
</code></pre>
<h4 data-id="heading-3">å®šåˆ¶è¾“å‡ºæ ¼å¼ï¼ˆè‡ªå®šä¹‰æ—¥å¿—æ¨¡æ¿ï¼‰</h4>
<p>é€šè¿‡Â <code>format</code>Â æ–¹æ³•è‡ªå®šä¹‰æ—¥å¿—çš„è¾“å‡ºæ¨¡æ¿ï¼Œæ”¯æŒä»¥ä¸‹å ä½ç¬¦ï¼š</p>
<ul>
<li><code>%l</code>ï¼šæ—¥å¿—çº§åˆ«ï¼ˆå¦‚ info/errorï¼‰</li>
<li><code>%p</code>ï¼šå‰ç¼€ï¼ˆheading + è‡ªå®šä¹‰å‰ç¼€ï¼‰</li>
<li><code>%m</code>ï¼šæ—¥å¿—æ¶ˆæ¯</li>
<li><code>%t</code>ï¼šæ—¶é—´æˆ³</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼ï¼š[æ—¶é—´] [çº§åˆ«] [å‰ç¼€] æ¶ˆæ¯</span>
log.<span class="hljs-property">format</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">level, prefix, message</span>) {
  <span class="hljs-keyword">const</span> time = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleTimeString</span>(); <span class="hljs-comment">// æœ¬åœ°æ—¶é—´</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">`[<span class="hljs-subst">${time}</span>] [<span class="hljs-subst">${level.toUpperCase()}</span>] [<span class="hljs-subst">${prefix}</span>] <span class="hljs-subst">${message}</span>`</span>;
};

log.<span class="hljs-title function_">info</span>(<span class="hljs-string">'USER'</span>, <span class="hljs-string">'ç”¨æˆ·ç™»å½•æˆåŠŸ'</span>);
<span class="hljs-comment">// è¾“å‡ºç¤ºä¾‹ï¼š[14:25:30] [INFO] [MY_APP USER] ç”¨æˆ·ç™»å½•æˆåŠŸ</span>
</code></pre>
<h4 data-id="heading-4">é‡å®šå‘è¾“å‡ºï¼ˆæ–‡ä»¶ / è‡ªå®šä¹‰æµï¼‰</h4>
<p>é»˜è®¤æ—¥å¿—è¾“å‡ºåˆ°Â <code>process.stderr</code>ï¼Œå¯é€šè¿‡Â <code>stream</code>Â å±æ€§é‡å®šå‘åˆ°æ–‡ä»¶ / å…¶ä»–æµï¼š</p>
<ol>
<li>è¾“å‡ºåˆ°æ–‡ä»¶</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-comment">// è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶æµ</span>
<span class="hljs-keyword">const</span> logFile = fs.<span class="hljs-title function_">createWriteStream</span>(<span class="hljs-string">'./app.log'</span>, { <span class="hljs-attr">flags</span>: <span class="hljs-string">'a'</span> });
log.<span class="hljs-property">stream</span> = logFile; <span class="hljs-comment">// é‡å®šå‘æ‰€æœ‰æ—¥å¿—åˆ°æ–‡ä»¶</span>

<span class="hljs-comment">// æµ‹è¯•ï¼šæ—¥å¿—ä¼šå†™å…¥ app.logï¼Œä¸å†è¾“å‡ºåˆ°ç»ˆç«¯</span>
log.<span class="hljs-title function_">info</span>(<span class="hljs-string">'file'</span>, <span class="hljs-string">'æ—¥å¿—å†™å…¥æ–‡ä»¶'</span>);
</code></pre>
<ol start="2">
<li>åŒæ—¶è¾“å‡ºåˆ°ç»ˆç«¯å’Œæ–‡ä»¶</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è‡ªå®šä¹‰æµï¼šåŒæ—¶å†™å…¥ stderr å’Œæ–‡ä»¶</span>
<span class="hljs-keyword">const</span> dualStream = {
  <span class="hljs-attr">write</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) {
    process.<span class="hljs-property">stderr</span>.<span class="hljs-title function_">write</span>(message); <span class="hljs-comment">// ç»ˆç«¯è¾“å‡º</span>
    fs.<span class="hljs-title function_">appendFileSync</span>(<span class="hljs-string">'./app.log'</span>, message); <span class="hljs-comment">// æ–‡ä»¶è¿½åŠ </span>
  }
};

log.<span class="hljs-property">stream</span> = dualStream;
log.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'dual'</span>, <span class="hljs-string">'åŒæ—¶è¾“å‡ºåˆ°ç»ˆç«¯å’Œæ–‡ä»¶'</span>);
</code></pre>
<h4 data-id="heading-5">å…¶ä»–å®ç”¨å®šåˆ¶</h4>
<ol>
<li>ç¦ç”¨é¢œè‰²ï¼ˆé€‚é…æ— ç»ˆç«¯ç¯å¢ƒï¼‰</li>
</ol>
<pre><code class="hljs language-js" lang="js">log.<span class="hljs-title function_">enableColor</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// å…³é—­é¢œè‰²è¾“å‡º</span>
log.<span class="hljs-title function_">error</span>(<span class="hljs-string">'no-color'</span>, <span class="hljs-string">'æ— é¢œè‰²çš„é”™è¯¯æ—¥å¿—'</span>);
</code></pre>
<ol start="2">
<li>è‡ªå®šä¹‰å‰ç¼€åˆ†éš”ç¬¦</li>
</ol>
<pre><code class="hljs language-js" lang="js">log.<span class="hljs-property">headingSeparator</span> = <span class="hljs-string">' | '</span>; <span class="hljs-comment">// å…¨å±€å‰ç¼€å’Œè‡ªå®šä¹‰å‰ç¼€ä¹‹é—´çš„åˆ†éš”ç¬¦</span>
log.<span class="hljs-property">heading</span> = <span class="hljs-string">'APP'</span>;
log.<span class="hljs-title function_">info</span>(<span class="hljs-string">'USER'</span>, <span class="hljs-string">'ç”¨æˆ·æ“ä½œ'</span>); 
<span class="hljs-comment">// è¾“å‡ºï¼šAPP | USER  ç”¨æˆ·æ“ä½œï¼ˆé»˜è®¤åˆ†éš”ç¬¦æ˜¯ç©ºæ ¼ï¼‰</span>
</code></pre>
<ol start="3">
<li>æ¸…ç©ºæ—¥å¿—ç¼“å­˜ï¼ˆå¦‚éœ€æ‰‹åŠ¨æ§åˆ¶è¾“å‡ºï¼‰</li>
</ol>
<pre><code class="hljs language-js" lang="js">log.<span class="hljs-title function_">clear</span>(); <span class="hljs-comment">// æ¸…ç©ºæœªè¾“å‡ºçš„æ—¥å¿—ç¼“å­˜</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨Traeå¼€å‘ä¸€ä¸ªè‡ªåŠ¨ç”ŸæˆTSç±»å‹å®šä¹‰çš„viteæ’ä»¶]]></title>    <link>https://juejin.cn/post/7584758215700496422</link>    <guid>https://juejin.cn/post/7584758215700496422</guid>    <pubDate>2025-12-18T05:25:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584758215700496422" data-draft-id="7584730308753358898" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨Traeå¼€å‘ä¸€ä¸ªè‡ªåŠ¨ç”ŸæˆTSç±»å‹å®šä¹‰çš„viteæ’ä»¶"/> <meta itemprop="keywords" content="Vite"/> <meta itemprop="datePublished" content="2025-12-18T05:25:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èœ—ç‰›é–å­"/> <meta itemprop="url" content="https://juejin.cn/user/1284661409481389"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨Traeå¼€å‘ä¸€ä¸ªè‡ªåŠ¨ç”ŸæˆTSç±»å‹å®šä¹‰çš„viteæ’ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1284661409481389/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èœ—ç‰›é–å­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:25:11.000Z" title="Thu Dec 18 2025 05:25:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä½œä¸ºä¸€ä¸ªå‰ç«¯å¼€å‘ï¼Œä½ æ˜¯å¦ä¹Ÿç»å¸¸é‡åˆ°è¿™æ ·çš„çƒ¦æ¼ï¼š</p>
<ul>
<li>å¯¹æ¥åç«¯APIæ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™å¤§é‡TypeScriptç±»å‹å®šä¹‰</li>
<li>APIæ¥å£å˜æ›´æ—¶ï¼Œåˆè¦æ‰‹åŠ¨åŒæ­¥æ›´æ–°ç±»å‹å®šä¹‰</li>
<li>è°ƒè¯•æ—¶å› ä¸ºç±»å‹ä¸åŒ¹é…è€Œæµªè´¹å¤§é‡æ—¶é—´</li>
</ul>
<p>è¿™ä¸¤å¤©æˆ‘ç”¨Traeå¼€å‘äº†ä¸€ä¸ªViteæ’ä»¶â€”â€”<strong>vite-plugin-auto-api-types</strong>ï¼Œå®ƒèƒ½è‡ªåŠ¨å¸®æˆ‘ä»APIå“åº”ç”ŸæˆTypeScriptç±»å‹å®šä¹‰ï¼Œå½»åº•è§£å†³äº†è¿™äº›ç—›ç‚¹ï¼ä»Šå¤©å°±æ¥å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹è¿™ä¸ªæ’ä»¶</p>
<h2 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯vite-plugin-auto-api-typesï¼Ÿ</h2>
<p>vite-plugin-auto-api-typeså®ƒèƒ½åœ¨å¼€å‘è¿‡ç¨‹ä¸­è‡ªåŠ¨æ•è·APIè¯·æ±‚å’Œå“åº”ï¼Œç„¶åæ ¹æ®å“åº”æ•°æ®ç»“æ„ç”ŸæˆTypeScriptç±»å‹å®šä¹‰æ–‡ä»¶ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œä½ åªéœ€è¦æ­£å¸¸è°ƒç”¨APIï¼Œæ’ä»¶å°±ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆå¯¹åº”çš„ç±»å‹å®šä¹‰ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨å†™é‚£äº›ç¹ççš„interfaceäº†ï¼</p>
<h2 data-id="heading-2">äºŒã€å¿«é€Ÿä¸Šæ‰‹</h2>
<h3 data-id="heading-3">1. å®‰è£…æ’ä»¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨npm</span>
npm install vite-plugin-auto-api-types -D

<span class="hljs-comment"># ä½¿ç”¨yarn</span>
yarn add vite-plugin-auto-api-types -D

<span class="hljs-comment"># ä½¿ç”¨pnpm</span>
pnpm add vite-plugin-auto-api-types -D
</code></pre>
<h3 data-id="heading-4">2. é…ç½®æ’ä»¶</h3>
<p>åœ¨vite.config.tsä¸­æ·»åŠ æ’ä»¶é…ç½®ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoApiTypes</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-auto-api-types'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title class_">AutoApiTypes</span>({
      <span class="hljs-comment">// é…ç½®é¡¹</span>
      <span class="hljs-attr">outputDir</span>: <span class="hljs-string">'src/types'</span>,  <span class="hljs-comment">// ç±»å‹æ–‡ä»¶è¾“å‡ºç›®å½•</span>
      <span class="hljs-attr">cacheSize</span>: <span class="hljs-number">100</span>,         <span class="hljs-comment">// ç¼“å­˜å¤§å°</span>
      <span class="hljs-attr">moduleMap</span>: {
        <span class="hljs-comment">// æŒ‰URLå‰ç¼€åˆ†ç»„ç”Ÿæˆæ¨¡å—åŒ–ç±»å‹æ–‡ä»¶</span>
        <span class="hljs-string">'/api/user'</span>: <span class="hljs-string">'users'</span>,
        <span class="hljs-string">'/api/product'</span>: <span class="hljs-string">'products'</span>
      },
      <span class="hljs-attr">typeNameGenerator</span>: <span class="hljs-function">(<span class="hljs-params">url</span>) =&gt;</span> {
        <span class="hljs-comment">// è‡ªå®šä¹‰ç±»å‹åç§°ç”Ÿæˆè§„åˆ™</span>
        <span class="hljs-keyword">return</span> url.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\/|\./g</span>, <span class="hljs-string">'_'</span>)
      }
    })
  ]
})
</code></pre>
<h3 data-id="heading-5">3. ä½¿ç”¨æ’ä»¶</h3>
<p>é…ç½®å®Œæˆåï¼Œåªéœ€è¦æ­£å¸¸å‘èµ·APIè¯·æ±‚ï¼Œæ’ä»¶å°±ä¼šè‡ªåŠ¨ç”Ÿæˆç±»å‹å®šä¹‰æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å‘èµ·APIè¯·æ±‚</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user/list'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: api_user_list</span>) =&gt;</span> {
    <span class="hljs-comment">// æ’ä»¶ä¼šè‡ªåŠ¨æ ¹æ®dataçš„ç»“æ„ç”Ÿæˆç±»å‹å®šä¹‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
  })
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€æ ¸å¿ƒç‰¹æ€§</h2>
<h3 data-id="heading-7">1. è‡ªåŠ¨ç±»å‹ç”Ÿæˆ</h3>
<p>æ’ä»¶ä¼šè‡ªåŠ¨æ•è·æ‰€æœ‰APIå“åº”ï¼Œå¹¶æ ¹æ®å“åº”æ•°æ®ç»“æ„ç”Ÿæˆå¯¹åº”çš„TypeScriptç±»å‹å®šä¹‰ã€‚æ”¯æŒå„ç§å¤æ‚çš„æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬åµŒå¥—å¯¹è±¡ã€æ•°ç»„ã€æ ‘å½¢ç»“æ„ç­‰ã€‚</p>
<h3 data-id="heading-8">2. æ¨¡å—åŒ–ç±»å‹æ–‡ä»¶</h3>
<p>å¯ä»¥æ ¹æ®URLå‰ç¼€å°†APIç±»å‹åˆ†ç»„åˆ°ä¸åŒçš„æ¨¡å—æ–‡ä»¶ä¸­ï¼Œä¿æŒç±»å‹å®šä¹‰çš„æ•´æ´å’Œå¯ç»´æŠ¤æ€§ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-title class_">AutoApiTypes</span>({
  <span class="hljs-attr">moduleMap</span>: {
    <span class="hljs-string">'/api/user'</span>: <span class="hljs-string">'users'</span>,
    <span class="hljs-string">'/api/product'</span>: <span class="hljs-string">'products'</span>,
    <span class="hljs-string">'/api/order'</span>: <span class="hljs-string">'orders'</span>
  }
})
</code></pre>
<p>è¿™æ ·é…ç½®åï¼Œæ’ä»¶ä¼šç”Ÿæˆä¸‰ä¸ªç±»å‹æ–‡ä»¶ï¼š<code>users.d.ts</code>ã€<code>products.d.ts</code>å’Œ<code>orders.d.ts</code>ã€‚</p>
<h3 data-id="heading-9">3. æ ‘å½¢ç»“æ„ç±»å‹æ”¯æŒ</h3>
<p>æ’ä»¶ç‰¹åˆ«ä¼˜åŒ–äº†å¯¹æ ‘å½¢ç»“æ„æ•°æ®çš„æ”¯æŒï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆæ¸…æ™°çš„èŠ‚ç‚¹ç±»å‹å®šä¹‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è‡ªåŠ¨ç”Ÿæˆçš„æ ‘å½¢ç»“æ„ç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MenuTreeNode</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>;
  children?: <span class="hljs-title class_">MenuTreeNode</span>[];
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">GetMenuListResponse</span> {
  <span class="hljs-attr">code</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">data</span>: <span class="hljs-title class_">MenuTreeNode</span>[];
}
</code></pre>
<h3 data-id="heading-10">4. è‡ªå®šä¹‰å“åº”è·¯å¾„</h3>
<p>æ”¯æŒä»APIå“åº”ä¸­æå–ç‰¹å®šéƒ¨åˆ†ç”Ÿæˆç±»å‹å®šä¹‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-title class_">AutoApiTypes</span>({
  <span class="hljs-attr">responsePath</span>: <span class="hljs-string">'data.list'</span>  <span class="hljs-comment">// åªä»å“åº”çš„data.listéƒ¨åˆ†ç”Ÿæˆç±»å‹</span>
})
</code></pre>
<h3 data-id="heading-11">5. LRUç¼“å­˜æœºåˆ¶</h3>
<p>å†…ç½®LRUç¼“å­˜æœºåˆ¶ï¼Œä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œé¿å…é‡å¤ç”Ÿæˆç›¸åŒçš„ç±»å‹å®šä¹‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-title class_">AutoApiTypes</span>({
  <span class="hljs-attr">cacheSize</span>: <span class="hljs-number">100</span>  <span class="hljs-comment">// è®¾ç½®ç¼“å­˜å¤§å°ä¸º100</span>
})
</code></pre>
<h2 data-id="heading-12">å››ã€å®é™…åº”ç”¨ä½“éªŒ</h2>
<h3 data-id="heading-13">1. å¼€å‘æ•ˆç‡æå‡</h3>
<p>ä»¥å‰å¯¹æ¥ä¸€ä¸ªAPIï¼Œéœ€è¦å…ˆçœ‹æ–‡æ¡£ï¼Œç„¶åæ‰‹åŠ¨ç¼–å†™ç±»å‹å®šä¹‰ï¼Œè‡³å°‘éœ€è¦10åˆ†é’Ÿã€‚ç°åœ¨åªéœ€è¦è°ƒç”¨ä¸€æ¬¡APIï¼Œæ’ä»¶å°±ä¼šè‡ªåŠ¨ç”Ÿæˆç±»å‹å®šä¹‰ï¼Œä¸åˆ°1åˆ†é’Ÿå°±èƒ½æå®šï¼</p>
<h3 data-id="heading-14">2. ç±»å‹å‡†ç¡®æ€§æé«˜</h3>
<p>æ‰‹åŠ¨ç¼–å†™ç±»å‹å®šä¹‰å¾ˆå®¹æ˜“å‡ºé”™ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤æ‚çš„æ•°æ®ç»“æ„ã€‚ç°åœ¨ç”±æ’ä»¶è‡ªåŠ¨ç”Ÿæˆï¼Œå®Œå…¨åŸºäºå®é™…APIå“åº”ï¼Œç±»å‹å‡†ç¡®æ€§100%ï¼</p>
<h3 data-id="heading-15">3. æ¥å£å˜æ›´è‡ªåŠ¨åŒæ­¥</h3>
<p>å½“åç«¯APIæ¥å£å˜æ›´æ—¶ï¼Œåªéœ€è¦é‡æ–°è°ƒç”¨ä¸€æ¬¡APIï¼Œæ’ä»¶å°±ä¼šè‡ªåŠ¨æ›´æ–°ç±»å‹å®šä¹‰ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨åŒæ­¥äº†ï¼</p>
<h2 data-id="heading-16">äº”ã€æ€»ç»“</h2>
<p>vite-plugin-auto-api-typesæ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„Viteæ’ä»¶ï¼Œå®ƒèƒ½å¸®ä½ è‡ªåŠ¨ç”ŸæˆAPIç±»å‹å®šä¹‰ï¼Œå¤§å¤§æå‡å¼€å‘æ•ˆç‡ã€‚ä¸»è¦ä¼˜åŠ¿åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šæ— éœ€æ‰‹åŠ¨ç¼–å†™ç±»å‹å®šä¹‰</li>
<li><strong>å‡†ç¡®å¯é </strong>ï¼šåŸºäºå®é™…APIå“åº”ç”Ÿæˆï¼Œç±»å‹å‡†ç¡®</li>
<li><strong>æ™ºèƒ½ä¼˜åŒ–</strong>ï¼šæ”¯æŒæ ‘å½¢ç»“æ„ã€æ¨¡å—åŒ–ã€ç¼“å­˜ç­‰é«˜çº§ç‰¹æ€§</li>
<li><strong>æ˜“äºé…ç½®</strong>ï¼šæä¾›ä¸°å¯Œçš„é…ç½®é¡¹ï¼Œæ»¡è¶³å„ç§éœ€æ±‚</li>
</ol>
<h2 data-id="heading-17">æœ€åçš„è¯</h2>
<p>æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»GitHub <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flegend402%2Fvite-plugin-auto-api-types" target="_blank" title="https://github.com/legend402/vite-plugin-auto-api-types" ref="nofollow noopener noreferrer">æŸ¥çœ‹æºç </a></p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥åœ¨npmä¸Šå®‰è£…ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install vite-plugin-auto-api-types -D
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æŒæ¡ :focus-withinï¼Œè®©ä½ çš„AIå¯¹è¯è¾“å…¥ä½“éªŒæ›´ä¸Šä¸€å±‚æ¥¼ï¼]]></title>    <link>https://juejin.cn/post/7584787119273705499</link>    <guid>https://juejin.cn/post/7584787119273705499</guid>    <pubDate>2025-12-18T04:50:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584787119273705499" data-draft-id="7584729825385316390" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æŒæ¡ :focus-withinï¼Œè®©ä½ çš„AIå¯¹è¯è¾“å…¥ä½“éªŒæ›´ä¸Šä¸€å±‚æ¥¼ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-18T04:50:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="donecoding"/> <meta itemprop="url" content="https://juejin.cn/user/3192637500430093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æŒæ¡ :focus-withinï¼Œè®©ä½ çš„AIå¯¹è¯è¾“å…¥ä½“éªŒæ›´ä¸Šä¸€å±‚æ¥¼ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3192637500430093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    donecoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:50:23.000Z" title="Thu Dec 18 2025 04:50:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨æ™ºèƒ½å¯¹è¯æˆä¸ºæ ‡é…çš„ä»Šå¤©ï¼Œä¸€ä¸ªè¾“å…¥æ¡†æ‰¿è½½çš„å·²ä¸åªæ˜¯æ–‡å­—ã€‚æœ¬æ–‡å°†æ­ç¤ºå¦‚ä½•ç”¨ <code>:focus-within</code> ä¼ªç±»ï¼Œä¼˜é›…åœ°é©¾é©­AIè¾“å…¥æ¡†ä¸­å¤æ‚çš„äº¤äº’çŠ¶æ€ã€‚</p>
</blockquote>
<p>å¯¹äºAIå‰ç«¯å¼€å‘è€…è€Œè¨€ï¼Œæˆ‘ä»¬é¢å¯¹çš„æ—©å·²ä¸æ˜¯ç®€å•çš„æ–‡æœ¬è¾“å…¥æ¡†ã€‚ä¸€ä¸ªç°ä»£åŒ–çš„AIå¯¹è¯è¾“å…¥æ¡†ï¼Œæ˜¯é›†<strong>æ·±åº¦æ€è€ƒ</strong>è§¦å‘ã€<strong>è”ç½‘æœç´¢</strong>å¼€å…³ã€<strong>å¤šæ¨¡å‹åˆ‡æ¢</strong>ã€<strong>å¤šæ¨¡æ€å†…å®¹å‘é€</strong>äºä¸€ä½“çš„å¤æ‚äº¤äº’å®¹å™¨ã€‚å½“ç”¨æˆ·èšç„¦äºæ­¤ï¼Œæˆ‘ä»¬æœŸæœ›çš„äº¤äº’åé¦ˆæ˜¯ç«‹ä½“ä¸”å³æ—¶çš„ï¼šæ•´ä¸ªè¾“å…¥åŒºåŸŸéœ€è¦è¢«é«˜äº®ä»¥å¼ºåŒ–ç„¦ç‚¹ï¼Œç›¸å…³çš„æ“ä½œæŒ‰é’®ï¼ˆå¦‚æ¨¡å‹é€‰æ‹©å™¨ï¼‰åº”å˜å¾—æ›´ä¸ºé†’ç›®ï¼Œç”šè‡³éœ€è¦åŠ¨æ€å±•ç¤ºå‡ºéšè—çš„æ‰©å±•åŠŸèƒ½åŒºï¼ˆå¦‚æ–‡ä»¶ä¸Šä¼ æˆ–å¿«æ·æŒ‡ä»¤é¢æ¿ï¼‰ã€‚</p>
<p>ä¼ ç»Ÿä¸Šï¼Œå®ç°è¿™ç§â€œä¸€ç‚¹è§¦ï¼Œå…¨å±€åŠ¨â€çš„äº¤äº’ï¼Œéœ€è¦ç¼–å†™JavaScriptæ¥ç›‘å¬ç„¦ç‚¹äº‹ä»¶å¹¶æ‰‹åŠ¨ä¸ºçˆ¶å®¹å™¨æ·»åŠ ç±»åã€‚ä½†ç°åœ¨ï¼ŒCSSçš„ <code>:focus-within</code> ä¼ªç±»è®©æˆ‘ä»¬èƒ½å¤Ÿä»¥å£°æ˜å¼çš„çº¯CSSæ–¹æ¡ˆï¼Œä¼˜é›…åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€:focus-within æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä½•å®ƒç‰¹åˆ«é€‚åˆAIåœºæ™¯ï¼Ÿ</h2>
<p><strong>:focus-within</strong> æ˜¯ä¸€ä¸ªCSSä¼ªç±»ï¼Œå®ƒä¼šåŒ¹é…<strong>ä»»ä½•æ‹¥æœ‰è·å¾—ç„¦ç‚¹å­å…ƒç´ çš„å…ƒç´ </strong>ã€‚è¿™æ„å‘³ç€ï¼Œåªè¦è¾“å…¥æ¡†æœ¬èº«æˆ–å…¶å†…éƒ¨çš„ä»»ä½•ä¸€ä¸ªæŒ‰é’®ï¼ˆå¦‚â€œå‘é€â€æŒ‰é’®ï¼‰ã€å¼€å…³ï¼ˆå¦‚â€œè”ç½‘æœç´¢â€å¤é€‰æ¡†ï¼‰è·å¾—ç„¦ç‚¹ï¼Œå…¶å¤–å±‚çš„å®¹å™¨å…ƒç´ å°±ä¼šè¢«è¿™ä¸ªä¼ªç±»åŒ¹é…åˆ°ã€‚</p>
<p>è¿™ä¸æˆ‘ä»¬ç†ŸçŸ¥çš„ <code>:focus</code> ä¼ªç±»æœ‰æœ¬è´¨åŒºåˆ«ï¼š</p>
<ul>
<li><code>:focus</code>ï¼šåªä½œç”¨äº<strong>è·å¾—ç„¦ç‚¹çš„å…ƒç´ æœ¬èº«</strong>ï¼ˆä¾‹å¦‚ï¼Œä»…è®©è¾“å…¥æ¡†çš„è¾¹æ¡†å˜è‰²ï¼‰ã€‚</li>
<li><code>:focus-within</code>ï¼šä½œç”¨äº<strong>åŒ…å«ç„¦ç‚¹å…ƒç´ çš„çˆ¶å®¹å™¨</strong>ï¼ˆä¾‹å¦‚ï¼Œè®©åŒ…å«è¾“å…¥æ¡†ã€æ“ä½œæŒ‰é’®çš„æ•´ä¸ªå·¥å…·æ èƒŒæ™¯å˜è‰²ï¼‰ã€‚</li>
</ul>
<p>åœ¨AIå¯¹è¯ç•Œé¢ä¸­ï¼Œè¾“å…¥æ¡†ç»„ä»¶(å¦‚Ollamaçš„)é€šå¸¸æ˜¯ä¸€ä¸ªç”±è¾“å…¥åŸŸã€æ“ä½œæŒ‰é’®ã€é™„ä»¶ä¸Šä¼ ã€æ¨¡å‹é€‰æ‹©å™¨ç­‰å­ç»„ä»¶ç»„åˆè€Œæˆçš„å¤åˆå®¹å™¨ã€‚ä½¿ç”¨ <code>:focus-within</code>ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°â€œè¾“å…¥æ¡†æˆ–å…¶å†…éƒ¨ä»»ä¸€éƒ¨ä»¶è¢«æ¿€æ´»æ—¶ï¼Œæ•´ä¸ªç»„ä»¶è§†è§‰å‡çº§â€çš„æ•ˆæœï¼Œè¿™å®Œç¾å¥‘åˆäº†å¤æ‚äº¤äº’å®¹å™¨çš„è®¾è®¡éœ€æ±‚ã€‚</p>
<h2 data-id="heading-1">äºŒã€å®æˆ˜ï¼šèµ‹èƒ½AIå¯¹è¯è¾“å…¥æ¡†</h2>
<h3 data-id="heading-2">åœºæ™¯ä¸€ï¼šé«˜äº®æ™ºèƒ½è¾“å…¥å®¹å™¨ï¼Œæå‡ä¸“æ³¨æ„Ÿ</h3>
<p>ç°ä»£çš„AIè¾“å…¥æ¡†ï¼ˆå¦‚è±†åŒ…çš„ï¼‰é›†æˆäº†æ–‡æœ¬ã€é™„ä»¶ã€è¯­éŸ³ç­‰å¤šæ¨¡æ€è¾“å…¥æ–¹å¼ã€‚ä½¿ç”¨<code>:focus-within</code>å¯ä»¥åœ¨ç”¨æˆ·ä¸å…¶ä¸­ä»»ä½•éƒ¨åˆ†äº¤äº’æ—¶ï¼Œå¼ºåŒ–æ•´ä¸ªå®¹å™¨çš„è§†è§‰å­˜åœ¨æ„Ÿã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ai-sender-container"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"model-selector"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span>DeepSeek<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span>GPT-4<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å‘AIæé—®..."</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"actions"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-attachment"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"ä¸Šä¼ æ–‡ä»¶"</span>&gt;</span>ğŸ“<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-thinking"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"æ·±åº¦æ€è€ƒ"</span>&gt;</span>ğŸ§ <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-send"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å‘é€"</span>&gt;</span>å‘é€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.ai-sender-container</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#e5e7eb</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
  <span class="hljs-comment">/* å…³é”®ï¼šä¸ºå®¹å™¨æœ¬èº«æ·»åŠ è½®å»“è¿‡æ¸¡ï¼Œè€Œéå­å…ƒç´  */</span>
}

<span class="hljs-comment">/* é­”æ³•å‘ç”Ÿåœ¨è¿™é‡Œï¼šä»»ä½•å­å…ƒç´ è·å¾—ç„¦ç‚¹ï¼Œå®¹å™¨æ ·å¼æ”¹å˜ */</span>
<span class="hljs-selector-class">.ai-sender-container</span><span class="hljs-selector-pseudo">:focus</span>-within {
  <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#1890ff</span>; <span class="hljs-comment">/* ä¸»è‰²è°ƒè¾¹æ¡† */</span>
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">3px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">24</span>, <span class="hljs-number">144</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>); <span class="hljs-comment">/* æŸ”å’Œçš„å…‰æ™• */</span>
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fafafa</span>; <span class="hljs-comment">/* è½»å¾®èƒŒæ™¯è‰²å˜åŒ– */</span>
}

<span class="hljs-comment">/* åŒæ—¶ï¼Œå¯ä»¥æ”¹å˜å†…éƒ¨ç‰¹å®šå…ƒç´ çš„æ ·å¼ */</span>
<span class="hljs-selector-class">.ai-sender-container</span><span class="hljs-selector-pseudo">:focus</span>-within <span class="hljs-selector-class">.model-selector</span> {
  <span class="hljs-attribute">border-left-color</span>: <span class="hljs-number">#1890ff</span>;
}
<span class="hljs-selector-class">.ai-sender-container</span><span class="hljs-selector-pseudo">:focus</span>-within <span class="hljs-selector-class">.btn-send</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#1890ff</span>;
  <span class="hljs-attribute">color</span>: white;
}
</code></pre>
<h3 data-id="heading-3">åœºæ™¯äºŒï¼šåŠ¨æ€å±•ç¤ºæ‰©å±•åŠŸèƒ½åŒºï¼ˆå¿«æ·æ“ä½œæ /æŠ€èƒ½æ¨¡å¼ï¼‰</h3>
<p>è®¸å¤šAIäº§å“ä¼šåœ¨è¾“å…¥æ¡†ä¸Šæ–¹æˆ–ä¸‹æ–¹è®¾ç½®å¿«æ·æ“ä½œæ ï¼Œæä¾›å¸¸ç”¨æŠ€èƒ½æˆ–æŒ‡ä»¤ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>:focus-within</code>å®ç°â€œèšç„¦å³å±•å¼€â€çš„æµç•…ä½“éªŒã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ai-chat-input-wrapper"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å¿«æ·å‘½ä»¤æ ï¼Œé»˜è®¤éšè—æˆ–åŠé€æ˜ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"quick-command-bar"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>/help<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>/search<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>/creative<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ä¸»è¾“å…¥åŒºåŸŸ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-core"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥ / å”¤èµ·å¿«æ·å‘½ä»¤..."</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-web-toggle"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"è”ç½‘æœç´¢"</span>&gt;</span>ğŸŒ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.quick-command-bar</span> {
  <span class="hljs-attribute">max-height</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* å½“.input-coreå†…çš„è¾“å…¥æ¡†æˆ–æŒ‰é’®è·å¾—ç„¦ç‚¹æ—¶ï¼Œå±•å¼€ä¸Šæ–¹çš„å¿«æ·å‘½ä»¤æ  */</span>
<span class="hljs-selector-class">.ai-chat-input-wrapper</span><span class="hljs-selector-pseudo">:focus</span>-within <span class="hljs-selector-class">.quick-command-bar</span> {
  <span class="hljs-attribute">max-height</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
}
</code></pre>
<h3 data-id="heading-4">åœºæ™¯ä¸‰ï¼šå¢å¼ºå¯è®¿é—®æ€§ä¸çŠ¶æ€åé¦ˆï¼ˆç»“åˆ :focus-visibleï¼‰</h3>
<p>åœ¨AIå¯¹è¯ä¸­ï¼Œé”®ç›˜æ“ä½œæµè‡³å…³é‡è¦ã€‚æˆ‘ä»¬å¯ä»¥ç»“åˆ <code>:focus-visible</code> ä¼ªç±»ï¼Œä¸ºé”®ç›˜å¯¼èˆªç”¨æˆ·æä¾›æ›´æ˜ç¡®çš„è§†è§‰æŒ‡å¼•ï¼ŒåŒæ—¶é¿å…é¼ æ ‡ç‚¹å‡»æ—¶äº§ç”Ÿçªå…€çš„ç„¦ç‚¹ç¯ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä¸ºé”®ç›˜å¯¼èˆªç”¨æˆ·æä¾›æ¸…æ™°çš„ç„¦ç‚¹æŒ‡ç¤º */</span>
<span class="hljs-selector-class">.ai-sender-container</span><span class="hljs-selector-pseudo">:focus</span>-within<span class="hljs-selector-pseudo">:has</span>(<span class="hljs-selector-tag">input</span><span class="hljs-selector-pseudo">:focus</span>-visible) {
  <span class="hljs-attribute">outline</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#1890ff</span>;
  <span class="hljs-attribute">outline-offset</span>: <span class="hljs-number">2px</span>;
}

<span class="hljs-comment">/* å•ç‹¬è®¾ç½®æ¨¡å‹é€‰æ‹©å™¨åœ¨é”®ç›˜èšç„¦æ—¶çš„æ ·å¼ */</span>
<span class="hljs-selector-class">.model-selector</span> select<span class="hljs-selector-pseudo">:focus</span>-visible {
  <span class="hljs-attribute">outline</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#52c41a</span>;
}
</code></pre>
<h2 data-id="heading-5">ä¸‰ã€ä¸ä¼ ç»Ÿè¾“å…¥æ¡†çš„å¯¹æ¯”</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªè¡¨æ ¼ï¼Œæ¸…æ™°å¯¹æ¯” <code>:focus-within</code> åœ¨å¤„ç†ä¼ ç»Ÿè¡¨å•ä¸AIå¯¹è¯è¾“å…¥æ¡†æ—¶çš„ä¸åŒè®¾è®¡è€ƒé‡ï¼š</p>



































<table><thead><tr><th align="left">å¯¹æ¯”ç»´åº¦</th><th align="left">ä¼ ç»Ÿè¡¨å•è¾“å…¥æ¡†</th><th align="left">AIå¯¹è¯å¤åˆè¾“å…¥æ¡† (å¦‚ChatSender)</th></tr></thead><tbody><tr><td align="left"><strong>æ ¸å¿ƒå…ƒç´ </strong></td><td align="left">å•ä¸€æ—¥æ ‡ï¼š<code>&lt;input&gt;</code> æˆ– <code>&lt;textarea&gt;</code></td><td align="left">å¤šå…ƒç»„åˆï¼šè¾“å…¥åŸŸã€æ¨¡å‹åˆ‡æ¢ã€åŠŸèƒ½æŒ‰é’®ã€ä¸Šä¼ åŒº</td></tr><tr><td align="left"><strong>äº¤äº’åé¦ˆç›®æ ‡</strong></td><td align="left">èšç„¦å…ƒç´ æœ¬èº«ï¼ˆå¦‚è¾¹æ¡†å˜è‰²ï¼‰</td><td align="left"><strong>æ•´ä¸ªè¾“å…¥å®¹å™¨</strong>ï¼Œä»¥åŠå†…éƒ¨å…³è”å…ƒç´ çš„çŠ¶æ€åŒæ­¥</td></tr><tr><td align="left"><strong>å…¸å‹<code>:focus-within</code>åº”ç”¨</strong></td><td align="left">é«˜äº®åŒ…å«æ ‡ç­¾å’Œè¾“å…¥æ¡†çš„<code>.form-group</code></td><td align="left">é«˜äº®æ•´ä¸ªè¾“å…¥å®¹å™¨ï¼Œå¹¶åŒæ­¥æ§åˆ¶<strong>å¿«æ·å‘½ä»¤æ </strong>çš„æ˜¾éšã€<strong>æŒ‰é’®ç»„</strong>çš„æ´»æ€§</td></tr><tr><td align="left"><strong>çŠ¶æ€å…³è”å¤æ‚åº¦</strong></td><td align="left">ä½ï¼ˆé€šå¸¸åªå…³è”æ ‡ç­¾ï¼‰</td><td align="left"><strong>é«˜</strong>ï¼ˆéœ€å…³è”æ¨¡å‹é€‰æ‹©å™¨ã€æ€è€ƒå¼€å…³ã€è”ç½‘æœç´¢ç­‰ç‹¬ç«‹æ§ä»¶ï¼‰</td></tr><tr><td align="left"><strong>è®¾è®¡ç›®æ ‡</strong></td><td align="left">æ¸…æ™°ã€ç®€æ´çš„å¼•å¯¼</td><td align="left">è¥é€ æ²‰æµ¸ã€æ™ºèƒ½ä¸”åŠŸèƒ½ä¸°å¯Œçš„<strong>å¯¹è¯å‡†å¤‡ç¯å¢ƒ</strong></td></tr></tbody></table>
<h2 data-id="heading-6">å››ã€é«˜çº§åº”ç”¨ä¸æœ€ä½³å®è·µ</h2>
<ol>
<li>
<p><strong>ä¸â€œæ·±åº¦æ€è€ƒâ€çŠ¶æ€è”åŠ¨</strong>
ä¸€äº›AIç»„ä»¶æ”¯æŒå±•ç¤ºâ€œæ€è€ƒè¿‡ç¨‹â€ã€‚æˆ‘ä»¬å¯ä»¥ç”¨<code>:focus-within</code>åœ¨ç”¨æˆ·è¾“å…¥æ—¶ï¼Œé¢„æç¤ºè¯¥åŠŸèƒ½çš„å­˜åœ¨ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ç”¨æˆ·èšç„¦è¾“å…¥æ—¶ï¼Œæš—ç¤ºâ€œæ·±åº¦æ€è€ƒâ€åŠŸèƒ½å¯ç”¨ */</span>
<span class="hljs-selector-class">.ai-sender-container</span><span class="hljs-selector-pseudo">:focus</span>-within <span class="hljs-selector-class">.btn-thinking</span> {
  <span class="hljs-attribute">animation</span>: subtle-pulse <span class="hljs-number">2s</span> infinite;
  <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#722ed1</span>; <span class="hljs-comment">/* ç´«è‰²é€šå¸¸ä»£è¡¨AIæ€è€ƒ */</span>
}
</code></pre>
</li>
<li>
<p><strong>åµŒå¥—å±‚çº§çš„ç²¾å‡†æ§åˆ¶</strong>
<code>:focus-within</code>çš„å½±å“ä¼šç©¿é€å¤šå±‚DOMã€‚åœ¨å¤æ‚å¸ƒå±€ä¸­ï¼Œå¯ä»¥é€šè¿‡æ›´å…·ä½“çš„é€‰æ‹©å™¨è¿›è¡Œç²¾å‡†æ§åˆ¶ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* åªå½“ç›´æ¥å­è¾“å…¥æ¡†èšç„¦æ—¶æ”¹å˜å®¹å™¨èƒŒæ™¯ï¼Œå¿½ç•¥å†…éƒ¨æŒ‰é’®çš„èšç„¦ */</span>
<span class="hljs-selector-class">.ai-sender-container</span> &gt; <span class="hljs-selector-tag">textarea</span><span class="hljs-selector-pseudo">:focus</span>-within {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f6ffed</span>;
}
</code></pre>
</li>
<li>
<p><strong>æ€§èƒ½è€ƒé‡</strong>
å°½ç®¡<code>:focus-within</code>éå¸¸å¼ºå¤§ï¼Œä½†åº”é¿å…åœ¨å…¶è§„åˆ™ä¸­ç¼–å†™ä¼šè§¦å‘é‡æ’ï¼ˆå¦‚æ”¹å˜å®½åº¦ï¼‰æˆ–å¤æ‚åŠ¨ç”»çš„å±æ€§ï¼Œä»¥ä¿æŒäº¤äº’çš„æµç•…æ€§ã€‚</p>
</li>
</ol>
<h2 data-id="heading-7">äº”ã€æ€»ç»“</h2>
<p>å¯¹äºAIå‰ç«¯å¼€å‘è€…è€Œè¨€ï¼Œ<code>:focus-within</code> ä¸ä»…ä»…æ˜¯ä¸€ä¸ªCSSæŠ€å·§ï¼Œæ›´æ˜¯å¤„ç†<strong>å¤æ‚å¤åˆç»„ä»¶äº¤äº’çŠ¶æ€</strong>çš„æˆ˜ç•¥æ€§å·¥å…·ã€‚å®ƒå°†æˆ‘ä»¬ä»æ‰‹åŠ¨ç®¡ç†ç„¦ç‚¹çš„JavaScriptæ³¥æ½­ä¸­è§£æ”¾å‡ºæ¥ï¼Œä»¥å£°æ˜å¼çš„æ–¹å¼ï¼Œå®ç°äº†è¾“å…¥æ¡†ä¸å‘¨è¾¹æ‰©å±•åŠŸèƒ½åŒºã€çŠ¶æ€æŒ‡ç¤ºå™¨ä¹‹é—´çš„<strong>æ— ç¼çŠ¶æ€åŒæ­¥</strong>ã€‚</p>
<p>åœ¨è¿½æ±‚æ™ºèƒ½ã€æµç•…ã€æ²‰æµ¸å¼å¯¹è¯ä½“éªŒçš„ä»Šå¤©ï¼Œå–„ç”¨ <code>:focus-within</code> èƒ½å¤Ÿè®©ä½ çš„AIäº§å“è¾“å…¥ç•Œé¢ä¸ä»…åŠŸèƒ½å¼ºå¤§ï¼Œè€Œä¸”åœ¨äº¤äº’ç»†èŠ‚ä¸Šè„±é¢–è€Œå‡ºï¼Œä¸ºç”¨æˆ·å¸¦æ¥â€œå¿ƒæ„ç›¸é€šâ€èˆ¬é¡ºç•…è‡ªç„¶çš„ä½“éªŒã€‚</p>
<p><strong>æ€è€ƒä¸å®è·µ</strong>ï¼šå°è¯•åœ¨ä½ ä¸‹ä¸€ä¸ªAIé¡¹ç›®çš„<code>ChatSender</code>ç»„ä»¶ä¸­åº”ç”¨<code>:focus-within</code>ï¼Œå®ç°å½“ç”¨æˆ·èšç„¦è¾“å…¥æ¡†æ—¶ï¼Œ<strong>è‡ªåŠ¨å±•å¼€æ¨¡å‹é€‰æ‹©ä¸‹æ‹‰åˆ—è¡¨</strong>çš„æç¤ºï¼Œå¹¶è§‚å¯Ÿç”¨æˆ·å¯¹å‘ç°æ­¤åŠŸèƒ½çš„æƒŠå–œæ„Ÿã€‚</p>
<hr/>
<h3 data-id="heading-8"><strong>é™„å½•ä¸å‚è€ƒèµ„æ–™</strong></h3>
<ol>
<li><strong><code>:focus-within</code></strong>
<ul>
<li><strong>é“¾æ¥</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2FReference%2FSelectors%2F%3Afocus-within" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Reference/Selectors/:focus-within" ref="nofollow noopener noreferrer">developer.mozilla.org/zh-CN/docs/â€¦</a></li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨nrmç®¡ç†é•œåƒ]]></title>    <link>https://juejin.cn/post/7584719268044521506</link>    <guid>https://juejin.cn/post/7584719268044521506</guid>    <pubDate>2025-12-18T05:31:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584719268044521506" data-draft-id="7584711683773759488" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨nrmç®¡ç†é•œåƒ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-18T05:31:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿«ä¹æ˜Ÿçƒå–‚"/> <meta itemprop="url" content="https://juejin.cn/user/662375936570116"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨nrmç®¡ç†é•œåƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/662375936570116/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿«ä¹æ˜Ÿçƒå–‚
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:31:47.000Z" title="Thu Dec 18 2025 05:31:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1ã€nrmç®¡ç†å’Œåˆ‡æ¢é•œåƒæº</h2>
<h4 data-id="heading-1">nrmï¼ˆnpm registry managerï¼‰æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å’Œåˆ‡æ¢ npm æºçš„å‘½ä»¤è¡Œå·¥å…·ã€‚</h4>
<h2 data-id="heading-2">2ã€å®‰è£…</h2>
<p>é€šè¿‡å‘½ä»¤è¡Œå®‰è£…</p>
<pre><code class="hljs language-js" lang="js">npm install -g nrm
</code></pre>
<p>å¸¸è§çš„å‘½ä»¤</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//(1)åˆ—å‡ºå¯ç”¨çš„æºï¼šå½“å‰é…ç½®çš„æ‰€æœ‰å¯ç”¨ npm æºä»¥åŠå®ƒä»¬çš„åç§°å’Œ URLã€‚</span>
nrm ls
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4dd44436fa247e489c6e6e44cf54c33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5LmQ5pif55CD5ZaC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766640706&amp;x-signature=tizeF719f0GUVD9hgCf1VpKrjmE%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// (2)åˆ‡æ¢æºï¼šå°†å½“å‰çš„ npm æºåˆ‡æ¢ä¸ºæŒ‡å®šçš„æºã€‚å¯ä»¥ä½¿ç”¨æºçš„åç§°æˆ– URL ä½œä¸º å‚æ•°ã€‚</span>
nrm use npm
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dece980aff94258a36d2b29e3c97e08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5LmQ5pif55CD5ZaC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766640706&amp;x-signature=R1fif1Xt3o7AP0RDIXxnWXreIEs%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js">(<span class="hljs-number">3</span>)æ·»åŠ æºï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„ npm æºå¹¶æŒ‡å®šå…¶åç§°å’Œ <span class="hljs-variable constant_">URL</span>ã€‚
nrm add myregistry <span class="hljs-attr">http</span>:<span class="hljs-comment">//localhost:8080/npm/</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11120da26515425399c532397fe3d3dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5LmQ5pif55CD5ZaC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766640706&amp;x-signature=5YNls4BrQkrSsm8pQImCW1%2FkH%2FI%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js">(<span class="hljs-number">4</span>)æµ‹è¯•æºçš„é€Ÿåº¦ï¼šæµ‹è¯•æŒ‡å®šæºçš„å“åº”é€Ÿåº¦ï¼Œå¹¶æ˜¾ç¤ºæµ‹è¯•ç»“æœã€‚
nrm del myregistry
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a67bfa90eda643b7aecba8725e8d7849~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5LmQ5pif55CD5ZaC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766640706&amp;x-signature=ggG5RRPO%2BcXwi%2BhOGGLCTLPHQLo%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js">(<span class="hljs-number">5</span>)æµ‹è¯•æºçš„é€Ÿåº¦ï¼šæµ‹è¯•æŒ‡å®šæºçš„å“åº”é€Ÿåº¦ï¼Œå¹¶æ˜¾ç¤ºæµ‹è¯•ç»“æœã€‚
nrm test npm
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93158026d6f8498586fdbf53a81d60a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5LmQ5pif55CD5ZaC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766640706&amp;x-signature=Sgx7pdLC9SxXYTYSKT4knQrNzSg%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Tigriså¯¹è±¡å­˜å‚¨æ­£å¼å¼€æºMCP OIDCèº«ä»½æä¾›å•†]]></title>    <link>https://juejin.cn/post/7584725529877184562</link>    <guid>https://juejin.cn/post/7584725529877184562</guid>    <pubDate>2025-12-18T04:07:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584725529877184562" data-draft-id="7584725529877151794" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Tigriså¯¹è±¡å­˜å‚¨æ­£å¼å¼€æºMCP OIDCèº«ä»½æä¾›å•†"/> <meta itemprop="keywords" content="å®‰å…¨,Redis,å¾®æœåŠ¡"/> <meta itemprop="datePublished" content="2025-12-18T04:07:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘äº‘ä¼—ç”Ÿs"/> <meta itemprop="url" content="https://juejin.cn/user/380845430158739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Tigriså¯¹è±¡å­˜å‚¨æ­£å¼å¼€æºMCP OIDCèº«ä»½æä¾›å•†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/380845430158739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘äº‘ä¼—ç”Ÿs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:07:58.000Z" title="Thu Dec 18 2025 04:07:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>mcp-oidc-provideræ˜¯ä¸“ä¸ºMCPæœåŠ¡å™¨è®¾è®¡çš„OIDCæä¾›å•†ï¼Œç®€åŒ–è®¤è¯æˆæƒï¼Œè¿æ¥å®¢æˆ·ç«¯ä¸ä¸Šæ¸¸IdPï¼Œæ”¯æŒOAuth/OIDCå‘ç°ï¼Œä¸”ä¸ä¾›åº”å•†æ— å…³ã€‚</p>
<blockquote>
<p>è¯‘è‡ªï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.tigrisdata.com%2Fblog%2Fmcp-oidc-provider%2F" target="_blank" title="https://www.tigrisdata.com/blog/mcp-oidc-provider/" ref="nofollow noopener noreferrer">We're open sourcing our MCP OIDC Provider | Tigris Object Storage</a></p>
<p>ä½œè€…ï¼šAbdullah Ibrahim</p>
</blockquote>
<p><strong>TLDR: åœ¨æ„å»ºè¿œç¨‹ MCP æœåŠ¡å™¨æ—¶ï¼Œä½ å¾ˆå¯èƒ½éœ€è¦åœ¨å®¢æˆ·ç«¯ï¼ˆå¦‚ Claudeã€Cursor ç­‰ï¼‰å’Œä¸Šæ¸¸ IdPï¼ˆå¦‚ Auth0ã€Clerk ç­‰ï¼‰ä¹‹é—´æ·»åŠ ä¸€ä¸ª OIDC å±‚ã€‚æˆ‘ä»¬ä¸ºä½ åˆ›å»ºäº†ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒä¸ä¾›åº”å•†æ— å…³ï¼šä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ æƒ³è¦çš„ IdPã€‚</strong></p>
<p>MCP æœåŠ¡å™¨éœ€è¦çœŸå®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚å¿…é¡»é¢å‘ã€åˆ·æ–°ã€éªŒè¯ä»¤ç‰Œï¼Œå¹¶å°†å…¶ä¸ä¸Šæ¸¸èº«ä»½å…³è”ã€‚å®¢æˆ·ç«¯éœ€è¦ç™»å½•ã€è·å–å‡­æ®ï¼Œå¹¶å®‰å…¨åœ°è°ƒç”¨ä½ çš„ MCP æœåŠ¡å™¨ã€‚è¿™å¾ˆå¤æ‚ï¼Œå°¤å…¶å¦‚æœä½ ä¸æ˜¯ä¸€åå®‰å…¨å·¥ç¨‹å¸ˆã€‚ä½ ä¸åº”è¯¥è‡ªå·±å®ç°è®¤è¯ï¼Œä½†å¦‚æœç°æœ‰å·¥å…·æ— æ³•å¼€ç®±å³ç”¨ï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>å®ç°<a href="https://link.juejin.cn?target=https%3A%2F%2Fsupport.claude.com%2Fen%2Farticles%2F11503834-building-custom-connectors-via-remote-mcp-servers" target="_blank" title="https://support.claude.com/en/articles/11503834-building-custom-connectors-via-remote-mcp-servers" ref="nofollow noopener noreferrer">è¿œç¨‹æ‰˜ç®¡çš„ MCP æœåŠ¡å™¨</a>éœ€è¦å®ç°<a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2Fspecification%2Fdraft%2Fbasic%2Fauthorization" target="_blank" title="https://modelcontextprotocol.io/specification/draft/basic/authorization" ref="nofollow noopener noreferrer">MCP æˆæƒåè®®</a>ï¼Œè¯¥åè®®åŸºäº OAuth 2.1 (DRAFT)ã€‚ç†è®ºä¸Šï¼Œè¿™åº”è¯¥å¾ˆç®€å•ï¼Œå› ä¸ºç°ä»£åº”ç”¨ç¨‹åºè¦ä¹ˆè‡ªå·±å®ç° OAuth è§„èŒƒï¼Œè¦ä¹ˆä½¿ç”¨ç¬¦åˆ OAuth æ ‡å‡†çš„ IdPï¼Œå¦‚ Auth0 æˆ– Clerkã€‚æˆ‘è‡³å°‘æ˜¯è¿™æ ·è®¤ä¸ºçš„ï¼Œä½†å½“æˆ‘å¼€å§‹å®ç°æ—¶ï¼Œå´é‡åˆ°äº†é‡å¤§é—®é¢˜ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ„å»ºå¹¶å¼€æºäº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftigrisdata%2Fmcp-oidc-provider" target="_blank" title="https://github.com/tigrisdata/mcp-oidc-provider" ref="nofollow noopener noreferrer">mcp-oidc-provider</a>ï¼šä¸€ä¸ªä¸“é—¨ä¸º MCP å·¥ä½œæµè®¾è®¡çš„ã€æç®€çš„ã€ç”Ÿäº§å°±ç»ªçš„ OIDC providerã€‚</p>
<h3 data-id="heading-0">MCP åè®®éœ€è¦å‘ç° (OAuth æˆ– OIDC)<a href="#mcp-protocol-requires-discovery-oauth-or-oidc" title="#mcp-protocol-requires-discovery-oauth-or-oidc">â€‹</a></h3>
<p>MCP è§„èŒƒ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2Fspecification%2F2025-11-25%2Fbasic%2Fauthorization%23protected-resource-metadata-discovery-requirements" target="_blank" title="https://modelcontextprotocol.io/specification/2025-11-25/basic/authorization#protected-resource-metadata-discovery-requirements" ref="nofollow noopener noreferrer">2025-11-25</a>) æ˜ç¡®è¦æ±‚ä½¿ç”¨ OAuthã€‚æ ¹æ®è§„èŒƒï¼š</p>
<ul>
<li>å—ä¿æŠ¤çš„ MCP æœåŠ¡å™¨ä½œä¸º OAuth 2.1 èµ„æºæœåŠ¡å™¨ï¼Œèƒ½å¤Ÿæ¥å—å¹¶ä½¿ç”¨è®¿é—®ä»¤ç‰Œå“åº”å—ä¿æŠ¤çš„èµ„æºè¯·æ±‚ã€‚</li>
<li>MCP å®¢æˆ·ç«¯ä½œä¸º OAuth 2.1 å®¢æˆ·ç«¯ï¼Œä»£è¡¨èµ„æºæ‰€æœ‰è€…å‘å‡ºå—ä¿æŠ¤çš„èµ„æºè¯·æ±‚ã€‚</li>
</ul>
<p>å¯¹äºå‘ç°æœºåˆ¶ï¼ŒMCP æˆæƒæœåŠ¡å™¨ï¼ˆæœ¬è½¯ä»¶åŒ…ç”¨äºæ­¤ç›®çš„ï¼‰å¿…é¡»æä¾›è‡³å°‘ä¸€ç§å‘ç°æœºåˆ¶ï¼š</p>
<ul>
<li>OAuth 2.0 æˆæƒæœåŠ¡å™¨å…ƒæ•°æ® (<a href="https://link.juejin.cn?target=https%3A%2F%2Fdatatracker.ietf.org%2Fdoc%2Fhtml%2Frfc8414" target="_blank" title="https://datatracker.ietf.org/doc/html/rfc8414" ref="nofollow noopener noreferrer">RFC8414</a>)</li>
<li>OpenID Connect Discovery 1.0</li>
</ul>
<p>OpenID Connect Discovery (OIDC) åœ¨æŠ€æœ¯ä¸Šæ˜¯å¯é€‰çš„ï¼Œä½†ä½ éœ€è¦ä¸€ä¸ªèº«ä»½å±‚æ¥å……åˆ†ä¿æŠ¤ä½ çš„ MCP æœåŠ¡å™¨ã€‚OAuth æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œè®©å®¢æˆ·ç«¯å¯ä»¥è¯·æ±‚ä½ çš„ MCP æˆæƒæœåŠ¡å™¨å»è·å–èµ„æºæ‰€æœ‰è€…çš„æˆæƒã€‚å®ƒä¸éªŒè¯å®¢æˆ·ç«¯çš„èº«ä»½ã€‚OIDC ä¸ºä½ å¤„ç†èº«ä»½éƒ¨åˆ†ã€‚</p>
<p>å¦‚æœæ²¡æœ‰ OIDCï¼Œä½ å¿…é¡»ä¸ºæ¯ä¸ªæä¾›å•†æ„å»ºè‡ªå®šä¹‰é›†æˆæ¥éªŒè¯èº«ä»½ã€‚ä½ éœ€è¦å®ç°è‡ªå·±çš„ä»¤ç‰Œåˆ·æ–°é€»è¾‘ï¼ŒåŒ…æ‹¬ <code>offline_access</code> æ”¯æŒã€‚åƒ <code>mcp://cursor/auth</code> æˆ– <code>claude://oauth/callback</code> è¿™æ ·çš„é‡å®šå‘ URI ä¼šè¢«æ ‡å‡† IdP æ‹’ç»ï¼Œå› ä¸ºå®ƒä»¬ä¸æ˜¯ç½‘ç»œ URLï¼Œå¹¶ä¸”éœ€è¦æ˜ç¡®çš„ OIDC æ”¯æŒã€‚è€Œä¸”ä½ çš„ MCP æœåŠ¡å™¨æ— æ³•ä¸ Claude å’Œ Cursor ç­‰æ¡Œé¢å®¢æˆ·ç«¯é…åˆä½¿ç”¨ã€‚</p>
<p>ç›´æ¥ä½¿ç”¨ OIDC å§ã€‚å®ƒç®€å•å¾—å¤šã€‚</p>
<h4 data-id="heading-1">ä½ éœ€è¦ OAuth å’Œ OIDC ä¸¤è€…<a href="#you-need-both-oauth-and-oidc" title="#you-need-both-oauth-and-oidc">â€‹</a></h4>
<p>åœ¨è¿™ä¸ªè½¯ä»¶åŒ…ä¸­ï¼Œæˆ‘åŒæ—¶å®ç°äº† OAuth å’Œ OIDC å‘ç°ç«¯ç‚¹ï¼ŒåŸå› æ˜¯ä»€ä¹ˆï¼ŸMCP å®¢æˆ·ç«¯å¿…é¡»æ”¯æŒå°è¯•ä¸¤ç§å‘ç°æœºåˆ¶ï¼Œä½†å¹¶éæ‰€æœ‰å®¢æˆ·ç«¯éƒ½ç¬¦åˆè§„èŒƒã€‚å› æ­¤ï¼Œä¾‹å¦‚ï¼Œå¦‚æœå®ƒä»¬åªå®ç°äº† OpenID Connect Discovery 1.0 è¿›è¡Œå‘ç°ï¼Œ<code>mcp-oidc-provider</code> ä»ç„¶ä¼šå·¥ä½œã€‚</p>
<p>æˆ‘ä»¬ä¼—æ‰€å‘¨çŸ¥çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmcp.storage.dev%2F.well-known%2Fopenid-configuration" target="_blank" title="https://mcp.storage.dev/.well-known/openid-configuration" ref="nofollow noopener noreferrer">OIDC ç«¯ç‚¹</a>æ˜¯ OpenID å¼€ç®±å³ç”¨çš„ã€‚ä¸ºäº†æœ€å¤§ç¨‹åº¦çš„å…¼å®¹æ€§ï¼Œæˆ‘ä»¬å®ç°äº† OAuth ç«¯ç‚¹ï¼š</p>
<h3 data-id="heading-2">åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œï¼šä»…é ä¸Šæ¸¸ IdP æ— æ³•è§£å†³æ­¤é—®é¢˜<a href="#dynamic-client-registration-upstream-idps-alone-dont-solve-this" title="#dynamic-client-registration-upstream-idps-alone-dont-solve-this">â€‹</a></h3>
<p>æ ¹æ® MCP è§„èŒƒï¼šâ€œæˆæƒæœåŠ¡å™¨å’Œ MCP å®¢æˆ·ç«¯<strong>åº”</strong>æ”¯æŒ OAuth 2.0 åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œåè®® (<a href="https://link.juejin.cn?target=https%3A%2F%2Fdatatracker.ietf.org%2Fdoc%2Fhtml%2Frfc7591" target="_blank" title="https://datatracker.ietf.org/doc/html/rfc7591" ref="nofollow noopener noreferrer">RFC7591</a>)ã€‚â€ è¡¨é¢ä¸Šçœ‹ï¼Œè¿™ä¼¼ä¹åº”è¯¥è®©æ”¯æŒåŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œçš„ IdP å¯¹å¤§å¤šæ•° MCP å®¢æˆ·ç«¯éƒ½æœ‰æ•ˆã€‚</p>
<p>åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ä½¿ç”¨ Auth0 æ—¶ï¼Œæˆ‘ä»¬å¯ç”¨äº†åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œã€‚å®ƒåœ¨æŠ€æœ¯ä¸Šæ— éœ€ä»»ä½•ä¸­é—´ä»¶å³å¯æˆæƒ MCP å®¢æˆ·ç«¯ï¼Œä½†æ¯ä¸ªä¸´æ—¶å®¢æˆ·ç«¯éƒ½æ˜¾ç¤ºåœ¨é•¿æœŸå­˜åœ¨çš„ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºåˆ—è¡¨ä¸­ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªä¼šè¯æˆ‘ä»¬éƒ½æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºã€‚æ­£å¦‚ä½ æ‰€æƒ³è±¡çš„ï¼Œæˆ‘ä»¬ç‚¹å‡»é‚£ä¸ªåˆ—è¡¨ç‚¹å¾—æ‰‹éƒ½ç–¼äº†ã€‚è€Œä¸”ï¼Œä¸ºæ¯ä¸ªå®¢æˆ·ç«¯é¢å‘æœ‰èŒƒå›´çš„è®¿é—®ä»¤ç‰Œä¹Ÿå¾ˆç—›è‹¦ã€‚</p>
<p><img src="https://www.tigrisdata.com/blog/assets/images/oauth-clients-1f309154bab0cc028818e1d876ddb0e7.webp" alt="ä¸€å †åŠ¨æ€åˆ›å»ºçš„ OAuth å®¢æˆ·ç«¯æ·¹æ²¡äº†é™æ€å®šä¹‰çš„å®¢æˆ·ç«¯" loading="lazy"/></p>
<p>æˆ‘ä»¬éœ€è¦åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºï¼Œä¸€ä¸ªå°çš„ OIDC æä¾›å•†ï¼Œèƒ½å¤Ÿæ§åˆ¶æ‰€æœ‰ MCP å®¢æˆ·ç«¯çš„è®¿é—®ã€‚ä»¥å…æˆ‘ä»¬çš„çœ¼ç›è¢«ä»ªè¡¨æ¿çš„è‡ƒè‚¿æ‰€ä¼¤å®³ã€‚</p>
<h3 data-id="heading-3">ä»‹ç» mcp-oidc-provider</h3>
<p>ä¸€ä¸ªæç®€çš„ã€æœ‰ä¸»è§çš„ OIDC providerï¼Œä¸“ä¸º MCP æœåŠ¡å™¨æ„å»ºï¼Œä½ å¯ä»¥ä¸ä»»ä½•å…¼å®¹ OIDC çš„ IdP ä¸€èµ·ä½¿ç”¨ã€‚</p>
<p>ä½¿ç”¨å®ƒï¼Œä½ å°†è·å¾—è§„èŒƒä¸­æ˜ç¡®è¦æ±‚çš„åŠŸèƒ½ï¼š</p>
<ul>
<li>å—ä¿æŠ¤çš„ MCP æœåŠ¡å™¨ä½œä¸º OAuth 2.1 èµ„æºæœåŠ¡å™¨ï¼Œèƒ½å¤Ÿæ¥å—å¹¶ä½¿ç”¨è®¿é—®ä»¤ç‰Œå“åº”å—ä¿æŠ¤çš„èµ„æºè¯·æ±‚ã€‚</li>
<li>å®¢æˆ·ç«¯ä½œä¸º OAuth 2.1 å®¢æˆ·ç«¯ï¼Œä»£è¡¨èµ„æºæ‰€æœ‰è€…å‘å‡ºå—ä¿æŠ¤çš„èµ„æºè¯·æ±‚ã€‚</li>
</ul>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬å°†ä¼šè¯ã€ä»¤ç‰Œã€æˆæƒå’Œ OIDC é€‚é…å™¨æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªé”®å€¼å­˜å‚¨ä¸­ã€‚ä½ å¯ä»¥åƒæˆ‘ä»¬ä¸€æ ·ä½¿ç”¨ Tigris ä½œä¸ºä½ çš„ KV å­˜å‚¨ï¼Œæˆ–è€…ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjaredwray%2Fkeyv%2F" target="_blank" title="https://github.com/jaredwray/keyv/" ref="nofollow noopener noreferrer">Keyv</a> æ”¯æŒçš„ä»»ä½•å…¶ä»–å­˜å‚¨ï¼Œå¦‚ Redis æˆ– Postgresã€‚</p>
<p><img src="https://res.cloudinary.com/dkrpg71cx/image/upload/v1766030444/g6qfasopkxfpqzrbqkvl.png" alt="alt text" loading="lazy"/></p>
<h4 data-id="heading-4">ç”¨æ³•ï¼šå‚è€ƒç‹¬ç«‹å®ç°<a href="#usage-referencing-the-standalone-implementation" title="#usage-referencing-the-standalone-implementation">â€‹</a></h4>
<p>æœ€å¥½çš„èµ·ç‚¹æ˜¯<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftigrisdata%2Fmcp-oidc-provider%2Ftree%2Fmain%2Fexample%2Fstandalone-oidc" target="_blank" title="https://github.com/tigrisdata/mcp-oidc-provider/tree/main/example/standalone-oidc" ref="nofollow noopener noreferrer">ç‹¬ç«‹ OIDC provider</a>ã€‚å¦‚æœä½ å·²åœ¨ Express ä»¥å¤–çš„ä¸åŒæŠ€æœ¯æ ˆä¸­å®ç°äº† MCPï¼Œæˆ–è€…æƒ³å°†è®¤è¯ä½œä¸ºå¯ç‹¬ç«‹æ‰©å±•çš„ç‹¬ç«‹å¾®æœåŠ¡è¿è¡Œï¼Œè¯·ä½¿ç”¨å®ƒã€‚ä½ å¯ä»¥è®©ä½ çš„ MCP æœåŠ¡å™¨ä½¿ç”¨ NextJS æˆ–å…¶ä»–æ¡†æ¶ï¼Œç„¶åç‹¬ç«‹è¿è¡Œæ­¤æœåŠ¡å™¨ï¼Œå¹¶å°†è®¤è¯è¯·æ±‚ä»£ç†åˆ°æ­¤æœåŠ¡å™¨ã€‚</p>
<p>ç‹¬ç«‹ provider åŒ…å«ï¼š</p>
<ul>
<li>å¼•å¯¼æœåŠ¡å™¨ä»£ç </li>
<li>provider é…ç½®</li>
<li>ä¸Šæ¸¸ IdP è¿æ¥</li>
<li>è·¯ç”±è®¾ç½®</li>
<li>å­˜å‚¨é€‚é…å™¨ç¤ºä¾‹</li>
<li>å®Œæ•´çš„ OIDC ç«¯ç‚¹æ³¨å†Œ</li>
</ul>
<p>æ­¤å¤–ï¼Œä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ Tigris ä½œä¸ºä½ çš„é”®å€¼å­˜å‚¨ã€‚</p>
<p>å…‹éš†ä»“åº“å¹¶ä½¿ç”¨ <code>npm install</code> å®‰è£…ä¾èµ–åï¼Œè®¾ç½®ä½ çš„ç¯å¢ƒï¼š</p>
<pre><code class="hljs language-ini" lang="ini">cat .env  
<span class="hljs-comment"># configure your upstream IdP  </span>
<span class="hljs-attr">UPSTREAM_ISSUER</span>=https://YOUR_DOMAIN.auth0.com  
<span class="hljs-attr">UPSTREAM_CLIENT_ID</span>=...  
<span class="hljs-attr">UPSTREAM_CLIENT_SECRET</span>=...  
<span class="hljs-attr">UPSTREAM_REDIRECT_URI</span>=http://localhost:<span class="hljs-number">3000</span>/callback  
  
<span class="hljs-comment">#configure your own provider issuer  </span>
<span class="hljs-attr">OIDC_ISSUER</span>=http://localhost:<span class="hljs-number">4000</span>  
<span class="hljs-attr">OIDC_PORT</span>=<span class="hljs-number">4000</span>  
  
<span class="hljs-comment"># Tigris (for @tigrisdata/keyv-tigris)  </span>
<span class="hljs-attr">TIGRIS_STORAGE_ACCESS_KEY_ID</span>=tid_xxxxx  
<span class="hljs-attr">TIGRIS_STORAGE_SECRET_ACCESS_KEY</span>=tsec_yyyyy  
<span class="hljs-attr">TIGRIS_STORAGE_BUCKET</span>=my-kv-bucket  

</code></pre>
<p>MCP å®¢æˆ·ç«¯å°†è·å– <code>[http://localhost:4000/.well-known/openid-configuration](http://localhost:4000/.well-known/openid-configuration)</code> æ¥å‘ç° OAuth æµç¨‹æ‰€éœ€çš„ç«¯ç‚¹ã€‚</p>
<p>ä½ ä½¿ç”¨ <code>npm start</code> è¿è¡Œ providerã€‚ä½ å¯ä»¥å°†å…¶ä¸ä½ çš„ MCP æœåŠ¡å™¨ä¸€èµ·è¿è¡Œï¼Œè®¤è¯è¯·æ±‚å°†ä»£ç†åˆ°å®ƒã€‚</p>
<p>å°†ä½ çš„å®¢æˆ·ç«¯æŒ‡å‘ä½ çš„ OIDC issuerã€‚ä¾‹å¦‚ï¼ŒClaude Desktop æœŸæœ›ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>  
  <span class="hljs-attr">"auth"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>  
    <span class="hljs-attr">"issuer"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:4000"</span>  
  <span class="hljs-punctuation">}</span>  
<span class="hljs-punctuation">}</span>  

</code></pre>
<p>å½“ä½ çš„ MCP æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œä½ ä½¿ç”¨ JWKS éªŒè¯ä»¤ç‰Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createRemoteJWKSet, jwtVerify } <span class="hljs-keyword">from</span> <span class="hljs-string">"jose"</span>;  
  
<span class="hljs-keyword">const</span> jwks = <span class="hljs-title function_">createRemoteJWKSet</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">"http://localhost:4000/jwks"</span>));  
  
<span class="hljs-keyword">const</span> { payload } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">jwtVerify</span>(accessToken, jwks);  
  
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"User:"</span>, payload.<span class="hljs-property">sub</span>);  

</code></pre>
<p>å°±æ˜¯è¿™æ ·ã€‚ä½ æ‹¥æœ‰äº†ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„åŸºäº OIDC çš„ MCP è®¤è¯æµç¨‹ã€‚</p>
<h4 data-id="heading-5">ç”¨æ³•ï¼šé›†æˆæ¨¡å¼ (Express + MCP)<a href="#usage-integrated-mode-express--mcp" title="#usage-integrated-mode-express--mcp">â€‹</a></h4>
<p>å¦‚æœä½ ä½¿ç”¨ Node / Express æ„å»º MCP æœåŠ¡å™¨ï¼Œè¿™æ˜¯æœ€ç®€å•çš„å…¥é—¨æ–¹å¼ã€‚åœ¨é›†æˆæ¨¡å¼ä¸‹ï¼Œä½ è¿è¡Œä¸€ä¸ª Express åº”ç”¨ç¨‹åºï¼Œå®ƒå°†ï¼š</p>
<ul>
<li>æ‰˜ç®¡ OIDC provider (/.well-known/openid-configuration, /authorize, /token, /jwks, /register)</li>
<li>æ‰˜ç®¡ä½ çš„ MCP ç«¯ç‚¹</li>
<li>ç«¯åˆ°ç«¯å¤„ç†æ‰€æœ‰ OAuth + OIDC æµç¨‹</li>
<li>æš´éœ²ä¸€ä¸ªå•ä¸€çš„ BASE_URLï¼Œä½ çš„ MCP å®¢æˆ·ç«¯å°†æŒ‡å‘å®ƒ</li>
</ul>
<p>é¦–å…ˆï¼Œå®‰è£…ä½ çš„ä¾èµ–é¡¹ï¼š</p>
<pre><code class="hljs">npm install mcp-oidc-provider keyv openid-client express  

</code></pre>
<p>å¦‚æœä½ ä½¿ç”¨ TSï¼Œä½ å¯èƒ½è¿˜éœ€è¦ <code>typescript</code>ã€<code>ts-node</code> ç­‰ï¼Œä½†é‚£æ˜¯æ ‡å‡†é…ç½®ã€‚</p>
<p>å…¶æ¬¡ï¼Œä¸€æ¬¡æ€§ç”Ÿæˆä½ çš„ JWKS ç­¾åå¯†é’¥ã€‚ä½ å°†å®ƒä»¬ä¿å­˜åˆ° <code>.env</code> æ–‡ä»¶ä¸­ã€‚</p>
<pre><code class="hljs language-css" lang="css">npx mcp-oidc-provider <span class="hljs-attr">--pretty</span>  

</code></pre>
<p>å¤åˆ¶æ‰“å°å‡ºçš„ JSON å¹¶å°†å…¶å­˜å‚¨åœ¨ä¸€ä¸ªå®‰å…¨ä½ç½®ï¼ˆä¾‹å¦‚å¯†é’¥ç®¡ç†å™¨ï¼‰ï¼Œç„¶åé€šè¿‡ JWKS ç¯å¢ƒå˜é‡æ³¨å…¥ã€‚</p>
<p>å¯¹äºå¼€å‘ç¯å¢ƒï¼Œä½ å¯ä»¥è·³è¿‡æ­¤æ­¥éª¤ï¼ˆå¯†é’¥ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œä½†ä»¤ç‰Œåœ¨é‡å¯åï¼Œä»¤ç‰Œç¼“å­˜è¿‡æœŸåä¼šå¤±æ•ˆï¼‰ã€‚</p>
<p>ç¬¬ä¸‰ï¼Œé…ç½®ä½ çš„ç¯å¢ƒï¼š</p>
<pre><code class="hljs language-ini" lang="ini">cat .env  
<span class="hljs-attr">BASE_URL</span>=http://localhost:<span class="hljs-number">3000</span>          <span class="hljs-comment"># Where this combined server runs  </span>
<span class="hljs-attr">OIDC_CLIENT_ID</span>=your-idp-client-id  
<span class="hljs-attr">OIDC_CLIENT_SECRET</span>=your-idp-client-secret  
<span class="hljs-attr">SESSION_SECRET</span>=some-long-random-string  
<span class="hljs-attr">JWKS</span>=...                                <span class="hljs-comment"># JSON from `npx mcp-oidc-provider --pretty` (prod only)  </span>

</code></pre>
<p>BASE_URL å¿…é¡»æ˜¯å®¢æˆ·ç«¯å°†ç”¨äºä»¥ä¸‹ç›®çš„çš„å…¬å…± URLï¼š</p>
<ul>
<li>OIDC å‘ç° (/.well-known/openid-configuration)</li>
<li>OAuth å›è°ƒ (/oauth/callback)</li>
<li>MCP ç«¯ç‚¹ï¼ˆä½ åœ¨æ­¤æœåŠ¡å™¨ä¸‹é€‰æ‹©çš„ä»»ä½•è·¯ç”±ï¼‰</li>
</ul>
<p>ç°åœ¨ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>setupMcpExpress()</code> å‡½æ•°å°† OIDC provider æ·»åŠ åˆ°ä½ çš„æœåŠ¡å™¨ã€‚å®ƒå°†ï¼š</p>
<ul>
<li>å°† OIDC provider è·¯ç”±æŒ‚è½½åˆ° Express åº”ç”¨ç¨‹åº</li>
<li>è¿æ¥ MCP è®¤è¯ï¼ˆBearer è®¤è¯ + ä»¤ç‰ŒéªŒè¯ï¼‰</li>
<li>è¿”å›ï¼š
<ul>
<li>appï¼šé…ç½®å¥½çš„ Express å®ä¾‹</li>
<li><code>handleMcpRequest(handler)</code>ï¼šä¸€ä¸ªå¸®åŠ©å‡½æ•°ï¼Œç”¨äºæ³¨å†Œä½ çš„ MCP è¯·æ±‚å¤„ç†å™¨ï¼Œå…¶ä¸­è®¤è¯ + ç”¨æˆ·å·²è§£æ</li>
</ul>
</li>
</ul>
<p>ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨å®ƒçš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">"express"</span>;  
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Keyv</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"keyv"</span>;  
<span class="hljs-keyword">import</span> { setupMcpExpress } <span class="hljs-keyword">from</span> <span class="hljs-string">"mcp-oidc-provider/mcp"</span>;  
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OidcClient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"mcp-oidc-provider/oidc"</span>;  
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-variable constant_">JWKS</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"mcp-oidc-provider"</span>;  
  
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {  
    
  <span class="hljs-keyword">const</span> <span class="hljs-attr">jwks</span>: <span class="hljs-variable constant_">JWKS</span> | <span class="hljs-literal">undefined</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">JWKS</span>  
    ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">JWKS</span>)  
    : <span class="hljs-literal">undefined</span>;  
  
  <span class="hljs-keyword">if</span> (!process.<span class="hljs-property">env</span>.<span class="hljs-property">BASE_URL</span>) {  
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"BASE_URL is required"</span>);  
  }  
  <span class="hljs-keyword">if</span> (!process.<span class="hljs-property">env</span>.<span class="hljs-property">OIDC_CLIENT_ID</span> || !process.<span class="hljs-property">env</span>.<span class="hljs-property">OIDC_CLIENT_SECRET</span>) {  
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"OIDC_CLIENT_ID and OIDC_CLIENT_SECRET are required"</span>);  
  }  
  <span class="hljs-keyword">if</span> (!process.<span class="hljs-property">env</span>.<span class="hljs-property">SESSION_SECRET</span>) {  
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"SESSION_SECRET is required"</span>);  
  }  
  
    
  <span class="hljs-keyword">const</span> idpClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OidcClient</span>({  
    <span class="hljs-attr">issuer</span>: <span class="hljs-string">"https://your-tenant.auth0.com"</span>,   
    <span class="hljs-attr">clientId</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OIDC_CLIENT_ID</span>,  
    <span class="hljs-attr">clientSecret</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OIDC_CLIENT_SECRET</span>,  
    <span class="hljs-attr">redirectUri</span>: <span class="hljs-string">`<span class="hljs-subst">${process.env.BASE_URL}</span>/oauth/callback`</span>,  
      
  });  
  
    
  <span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Keyv</span>();   
  
    
    
    
    
  <span class="hljs-keyword">const</span> { app, handleMcpRequest } = <span class="hljs-title function_">setupMcpExpress</span>({  
    idpClient,  
    store,  
    <span class="hljs-attr">baseUrl</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">BASE_URL</span>,  
    <span class="hljs-attr">secret</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">SESSION_SECRET</span>,  
    jwks,  
  });  
  
    
    
  <span class="hljs-title function_">handleMcpRequest</span>(<span class="hljs-keyword">async</span> (req, res) =&gt; {  
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Authenticated user:"</span>, req.<span class="hljs-property">user</span>);  
  
      
      
      
  
      
    res.<span class="hljs-title function_">json</span>({  
      <span class="hljs-attr">jsonrpc</span>: <span class="hljs-string">"2.0"</span>,  
      <span class="hljs-attr">id</span>: req.<span class="hljs-property">body</span>?.<span class="hljs-property">id</span> ?? <span class="hljs-literal">null</span>,  
      <span class="hljs-attr">result</span>: {  
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Hello from integrated MCP + OIDC server!"</span>,  
        <span class="hljs-attr">user</span>: req.<span class="hljs-property">user</span>,  
      },  
    });  
  });  
  
  <span class="hljs-keyword">const</span> port = <span class="hljs-title class_">Number</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> ?? <span class="hljs-number">3000</span>);  
  app.<span class="hljs-title function_">listen</span>(port, <span class="hljs-function">() =&gt;</span> {  
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`MCP + OIDC server listening on <span class="hljs-subst">${port}</span>`</span>);  
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Base URL: <span class="hljs-subst">${process.env.BASE_URL}</span>`</span>);  
  });  
}  
  
<span class="hljs-title function_">main</span>().<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);  
  process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);  
});  

</code></pre>
<p>æœ€åï¼Œä½ å¯ä»¥å°†å®¢æˆ·ç«¯æŒ‡å‘ä½ çš„ MCP æœåŠ¡å™¨ã€‚ä¾‹å¦‚ï¼ŒClaude Desktop æœŸæœ›ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>  
  <span class="hljs-attr">"auth"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>  
    <span class="hljs-attr">"issuer"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:4000"</span>  
  <span class="hljs-punctuation">}</span>  
<span class="hljs-punctuation">}</span>  

</code></pre>
<p>å®é™…çš„é…ç½®å½¢å¼å–å†³äºå®¢æˆ·ç«¯ï¼Œä½†æ¨¡å¼æ˜¯ï¼š</p>
<ul>
<li>Issuer = æ­¤æœåŠ¡å™¨çš„ BASE_URL</li>
<li>MCP endpoint = ä½ çš„é›†æˆæœåŠ¡å™¨æš´éœ²çš„ä»»ä½• MCP è·¯ç”±ï¼ˆç”± handleMcpRequest è¿æ¥çš„é‚£ä¸ªï¼‰</li>
</ul>
<p>é…ç½®å®Œæˆåï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯è®¿é—®ä½ çš„æœåŠ¡å™¨ä¸Šçš„ <code>/.well-known/openid-configuration</code>ã€‚</li>
<li>å®ƒå¯¹ä½ çš„æœåŠ¡å™¨æ‰§è¡Œ <code>/.authorize</code> â†’ <code>/token</code> æµç¨‹ã€‚</li>
<li>ä½ çš„æœåŠ¡å™¨é€šè¿‡ OidcClient å°†ç™»å½•è”é‚¦åˆ°ä¸Šæ¸¸ IdPã€‚</li>
<li>ä½ çš„æœåŠ¡å™¨é¢å‘ MCP ç‰¹å®šä»¤ç‰Œå¹¶éªŒè¯ <code>/mcp</code> è¯·æ±‚ã€‚</li>
<li>ä½ çš„å¤„ç†å™¨æ¥æ”¶å·²å¡«å…… <code>req.user</code> çš„å·²è®¤è¯è¯·æ±‚ã€‚</li>
</ul>
<p>å°±æ˜¯è¿™æ ·ã€‚ä½ çš„æœåŠ¡å™¨ç°åœ¨æ˜¯ä¸€ä¸ªé›†æˆçš„ OIDC issuerã€ä»¤ç‰Œç«¯ç‚¹å’Œ MCP ç«¯ç‚¹ã€‚</p>
<h3 data-id="heading-6">åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ mcp-oidc-provider<a href="#using-the-mcp-oidc-provider-in-production" title="#using-the-mcp-oidc-provider-in-production">â€‹</a></h3>
<p>æˆ‘ä»¬å°†å…¶ç”¨äºæˆ‘ä»¬æ‰˜ç®¡çš„ MCP æœåŠ¡å™¨ï¼Œå¹¶ä¸”æˆ‘ä»¬è¶³å¤Ÿä¿¡ä»»å®ƒï¼Œå› æ­¤å°†å…¶æä¾›ç»™ä½ ã€‚å®ƒä½¿ç”¨æ ‡å‡†åº“è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒã€‚è€Œä¸”ï¼Œå®ƒä¸ä¼šå°†ä½ é”å®šåˆ°ä»»ä½•ä¾›åº”å•†ã€‚</p>
<p>æˆ‘ä»¬å·²å°½å¯èƒ½åœ°å°† mcp-oidc-provider æ³›åŒ–ï¼ŒåŒ…æ‹¬æ·»åŠ é¢å¤–çš„é…ç½®æ¥å¢å¼ºä½ çš„ IdP æ‰€æä¾›çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å…è®¸ä½ é…ç½® JWKS ç¼“å­˜è®¾ç½®ï¼Œä»¥é˜²ä½ çš„ IdP ä¸æä¾› <code>Cache-Control: max-age</code> å¤´ã€‚å¦‚æœä½ çš„å…¬å¸å¯¹å¯†é’¥è½®æ¢äº‹ä»¶æœ‰å®‰å…¨è¦æ±‚ï¼Œéœ€è¦å¯†é’¥åœ¨ä¸€å®šæ—¶é—´åè¿‡æœŸï¼Œè¿™å°†å¾ˆæœ‰å¸®åŠ©ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ <code>jose.createRemoteJWKSet</code>ï¼Œä½ é€šå¸¸é€šè¿‡åœ¨åˆ›å»º JWKS fetcher æ—¶ä¼ é€’é€‰é¡¹æ¥æ§åˆ¶è¿‡æœŸï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import { createRemoteJWKSet } from "jose"<span class="hljs-comment">;  </span>
  
const <span class="hljs-attr">jwksUri</span> = new URL(<span class="hljs-string">"https://your-issuer/.well-known/jwks.json"</span>)<span class="hljs-comment">;  </span>
  
const <span class="hljs-attr">jwks</span> = createRemoteJWKSet(jwksUri, {  
    
  cooldownDuration: 30_000,  
    
  cacheMaxAge: 600_000,  
})<span class="hljs-comment">;  </span>

</code></pre>
<p>å¦‚æœä½ éœ€è¦ä»»ä½•å…¶ä»–å®šåˆ¶ï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼æˆ‘ä»¬éå¸¸ä¹æ„è®© mcp-oidc-provider é€‚é…ä½ çš„ MCP æœåŠ¡å™¨ã€‚</p>
<h2 data-id="heading-7">å°è¯• mcp-oidc-provider</h2>
<p>å‡†å¤‡å¥½æ„å»ºä¸€ä¸ªå®‰å…¨çš„ MCP æœåŠ¡å™¨äº†å—ï¼Ÿç«‹å³å¼€å§‹ä½¿ç”¨ mcp-oidc-providerï¼Œå¹¶ä½¿ç”¨ä½ æƒ³è¦çš„ä»»ä½•å…¼å®¹ OIDC çš„ IdPã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3åŠ¨æ€æ ·å¼ç®¡ç†ï¼šå¦‚ä½•æ··åˆclass/styleç»‘å®šã€ç©¿é€scopedå¹¶ä¼˜åŒ–æ€§èƒ½ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584760031835537442</link>    <guid>https://juejin.cn/post/7584760031835537442</guid>    <pubDate>2025-12-18T05:36:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584760031835537442" data-draft-id="7584780417103216680" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3åŠ¨æ€æ ·å¼ç®¡ç†ï¼šå¦‚ä½•æ··åˆclass/styleç»‘å®šã€ç©¿é€scopedå¹¶ä¼˜åŒ–æ€§èƒ½ï¼Ÿ    "/> <meta itemprop="keywords" content="å‰ç«¯,Trae,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-18T05:36:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kknone"/> <meta itemprop="url" content="https://juejin.cn/user/1366025597879930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3åŠ¨æ€æ ·å¼ç®¡ç†ï¼šå¦‚ä½•æ··åˆclass/styleç»‘å®šã€ç©¿é€scopedå¹¶ä¼˜åŒ–æ€§èƒ½ï¼Ÿ    
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1366025597879930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kknone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:36:56.000Z" title="Thu Dec 18 2025 05:36:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€classä¸styleç»‘å®šçš„æ··åˆä½¿ç”¨è§„åˆ™</h3>
<p>åœ¨Vue 3ä¸­ï¼Œ<code>class</code>å’Œ<code>style</code>ç»‘å®šæ˜¯æˆ‘ä»¬æ§åˆ¶å…ƒç´ æ ·å¼çš„æ ¸å¿ƒæ‰‹æ®µã€‚å®ƒä»¬ä¸ä»…èƒ½å•ç‹¬ä½¿ç”¨ï¼Œè¿˜èƒ½<strong>æ··åˆæ­é…</strong>æ»¡è¶³å¤æ‚åœºæ™¯éœ€æ±‚ã€‚æˆ‘ä»¬å…ˆå›é¡¾åŸºç¡€è¯­æ³•ï¼Œå†çœ‹æ··åˆä½¿ç”¨çš„è§„åˆ™ã€‚</p>
<h4 data-id="heading-1">1.1 åŸºç¡€è¯­æ³•å¿«é€Ÿå›é¡¾</h4>
<ul>
<li><strong>classç»‘å®š</strong>ï¼šæ”¯æŒ<strong>å¯¹è±¡è¯­æ³•</strong>ï¼ˆæ ¹æ®æ¡ä»¶åˆ‡æ¢ç±»åï¼‰å’Œ<strong>æ•°ç»„è¯­æ³•</strong>ï¼ˆç»„åˆå¤šä¸ªç±»åï¼‰ã€‚
<pre><code class="hljs language-vue" lang="vue">&lt;!-- å¯¹è±¡è¯­æ³•ï¼šisActiveä¸ºtrueæ—¶æ·»åŠ activeç±» --&gt;
&lt;div :class="{ active: isActive }"&gt;&lt;/div&gt;
&lt;!-- æ•°ç»„è¯­æ³•ï¼šç»„åˆé™æ€å’ŒåŠ¨æ€ç±»å --&gt;
&lt;div :class="['static-class', { active: isActive }]"&gt;&lt;/div&gt;
</code></pre>
</li>
<li><strong>styleç»‘å®š</strong>ï¼šåŒæ ·æ”¯æŒå¯¹è±¡/æ•°ç»„è¯­æ³•ï¼Œå¸¸ç”¨äºåŠ¨æ€è®¾ç½®å†…è”æ ·å¼ã€‚
<pre><code class="hljs language-vue" lang="vue">&lt;!-- å¯¹è±¡è¯­æ³•ï¼šåŠ¨æ€è®¾ç½®é¢œè‰²å’Œå­—ä½“å¤§å° --&gt;
&lt;div :style="{ color: textColor, fontSize: '16px' }"&gt;&lt;/div&gt;
&lt;!-- æ•°ç»„è¯­æ³•ï¼šç»„åˆå¤šä¸ªæ ·å¼å¯¹è±¡ --&gt;
&lt;div :style="[baseStyle, dynamicStyle]"&gt;&lt;/div&gt;
</code></pre>
</li>
</ul>
<h4 data-id="heading-2">1.2 æ··åˆä½¿ç”¨çš„å¸¸è§åœºæ™¯</h4>
<p>å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸éœ€è¦<strong>é™æ€ç±»å+åŠ¨æ€ç±»å+åŠ¨æ€å†…è”æ ·å¼</strong>çš„ç»„åˆã€‚æ¯”å¦‚ä¸€ä¸ªâ€œå¯åˆ‡æ¢çŠ¶æ€çš„æŒ‰é’®â€ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;button 
    class="btn"  &lt;!-- é™æ€ç±»å --&gt;
    :class="{ 'btn--active': isActive }"  &lt;!-- åŠ¨æ€ç±»å --&gt;
    :style="{ backgroundColor: btnColor }"  &lt;!-- åŠ¨æ€å†…è”æ ·å¼ --&gt;
    @click="isActive = !isActive"
  &gt;
    {{ isActive ? "æ¿€æ´»çŠ¶æ€" : "é»˜è®¤çŠ¶æ€" }}
  &lt;/button&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'
const isActive = ref(false)
const btnColor = ref('#409EFF')  // åˆå§‹è“è‰²
&lt;/script&gt;

&lt;style scoped&gt;
.btn {
  padding: 8px 16px;
  border: none;
  border-radius: 4px;
  color: white;
  cursor: pointer;
}
.btn--active {
  box-shadow: 0 0 8px rgba(64, 158, 255, 0.5);  /* æ¿€æ´»æ—¶çš„é˜´å½± */
}
&lt;/style&gt;
</code></pre>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼š</p>
<ul>
<li><code>class="btn"</code>æ˜¯<strong>é™æ€ç±»å</strong>ï¼Œè´Ÿè´£æŒ‰é’®çš„åŸºç¡€æ ·å¼ï¼›</li>
<li><code>:class="{ 'btn--active': isActive }"</code>æ˜¯<strong>åŠ¨æ€ç±»å</strong>ï¼Œæ ¹æ®<code>isActive</code>åˆ‡æ¢æ¿€æ´»çŠ¶æ€ï¼›</li>
<li><code>:style="{ backgroundColor: btnColor }"</code>æ˜¯<strong>åŠ¨æ€å†…è”æ ·å¼</strong>ï¼Œå¯ä»¥çµæ´»ä¿®æ”¹æŒ‰é’®èƒŒæ™¯è‰²ï¼ˆæ¯”å¦‚ä»æ¥å£è·å–ä¸»é¢˜è‰²ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-3">äºŒã€åŠ¨æ€æ ·å¼ä¸ç»„ä»¶props/emitçš„ç»“åˆ</h3>
<p>ç»„ä»¶åŒ–å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸éœ€è¦<strong>çˆ¶ç»„ä»¶ä¼ é€’æ ·å¼å‚æ•°ç»™å­ç»„ä»¶</strong>ï¼Œæˆ–<strong>å­ç»„ä»¶è§¦å‘äº‹ä»¶ä¿®æ”¹çˆ¶ç»„ä»¶çš„æ ·å¼çŠ¶æ€</strong>ã€‚è¿™éƒ¨åˆ†çš„æ ¸å¿ƒæ˜¯<code>props</code>ï¼ˆçˆ¶ä¼ å­ï¼‰å’Œ<code>emit</code>ï¼ˆå­ä¼ çˆ¶ï¼‰çš„é…åˆã€‚</p>
<h4 data-id="heading-4">2.1 ç”¨propsä¼ é€’åŠ¨æ€æ ·å¼</h4>
<p>æ¯”å¦‚æˆ‘ä»¬å†™ä¸€ä¸ª<strong>å¯å®šåˆ¶çš„Alertç»„ä»¶</strong>ï¼Œçˆ¶ç»„ä»¶å¯ä»¥ä¼ é€’<code>type</code>ï¼ˆæˆåŠŸ/é”™è¯¯ï¼‰æ¥æ§åˆ¶æ ·å¼ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- çˆ¶ç»„ä»¶ Parent.vue --&gt;
&lt;template&gt;
  &lt;Alert 
    type="success" 
    message="æ“ä½œæˆåŠŸï¼" 
    :show="isShow" 
    @close="isShow = false"
  /&gt;
  &lt;button @click="isShow = true"&gt;æ˜¾ç¤ºæˆåŠŸæç¤º&lt;/button&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'
import Alert from './Alert.vue'
const isShow = ref(true)
&lt;/script&gt;
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- å­ç»„ä»¶ Alert.vue --&gt;
&lt;template&gt;
  &lt;div 
    class="alert"
    :class="`alert--${type}`"  &lt;!-- åŠ¨æ€ç±»åï¼šæ ¹æ®typeåˆ‡æ¢æ ·å¼ --&gt;
    v-if="show"
  &gt;
    {{ message }}
    &lt;button class="alert__close" @click="$emit('close')"&gt;Ã—&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
// æ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„props
defineProps({
  type: {
    type: String,
    default: 'info'  // é»˜è®¤infoç±»å‹
  },
  message: String,
  show: Boolean
})
// å£°æ˜è¦è§¦å‘çš„äº‹ä»¶ï¼ˆå‘Šè¯‰çˆ¶ç»„ä»¶â€œæˆ‘è¦å…³é—­äº†â€ï¼‰
defineEmits(['close'])
&lt;/script&gt;

&lt;style scoped&gt;
.alert {
  padding: 12px;
  border-radius: 4px;
  margin: 16px 0;
  position: relative;
}
/* ä¸åŒtypeå¯¹åº”çš„æ ·å¼ */
.alert--success { background-color: #d4edda; color: #155724; }
.alert--error { background-color: #f8d7da; color: #721c24; }
.alert--info { background-color: #e3f2fd; color: #004085; }
.alert__close {
  position: absolute;
  top: 8px;
  right: 8px;
  border: none;
  background: transparent;
  cursor: pointer;
  font-size: 18px;
}
&lt;/style&gt;
</code></pre>
<p><strong>å…³é”®é€»è¾‘</strong>ï¼š</p>
<ol>
<li>çˆ¶ç»„ä»¶é€šè¿‡<code>type="success"</code>å°†â€œæˆåŠŸâ€ç±»å‹ä¼ é€’ç»™å­ç»„ä»¶ï¼›</li>
<li>å­ç»„ä»¶ç”¨<code>:class="</code>alert--${type}<code>"</code>ç”ŸæˆåŠ¨æ€ç±»å<code>alert--success</code>ï¼›</li>
<li>å­ç»„ä»¶é€šè¿‡<code>$emit('close')</code>è§¦å‘å…³é—­äº‹ä»¶ï¼Œçˆ¶ç»„ä»¶æ¥æ”¶åä¿®æ”¹<code>isShow</code>éšè—Alertã€‚</li>
</ol>
<h4 data-id="heading-5">2.2 ç”¨emitåŒæ­¥æ ·å¼çŠ¶æ€</h4>
<p>æ¯”å¦‚ä¸€ä¸ª<strong>å¯æŠ˜å çš„é¢æ¿ç»„ä»¶</strong>ï¼Œç‚¹å‡»æ ‡é¢˜åˆ‡æ¢å±•å¼€/æŠ˜å çŠ¶æ€ï¼ŒåŒæ—¶ä¿®æ”¹ç®­å¤´çš„æ—‹è½¬æ ·å¼ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- Collapse.vue --&gt;
&lt;template&gt;
  &lt;div class="collapse"&gt;
    &lt;div class="collapse__header" @click="toggle"&gt;
      {{ title }}
      &lt;span class="collapse__arrow" :class="{ 'rotate': isOpen }"&gt;â†“&lt;/span&gt;
    &lt;/div&gt;
    &lt;div class="collapse__content" v-if="isOpen"&gt;
      {{ content }}
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'
const props = defineProps(['title', 'content'])
const isOpen = ref(false)
const emit = defineEmits(['toggle'])  // å£°æ˜è§¦å‘çš„äº‹ä»¶

const toggle = () =&gt; {
  isOpen.value = !isOpen.value
  emit('toggle', isOpen.value)  // ä¼ é€’å½“å‰çŠ¶æ€ç»™çˆ¶ç»„ä»¶
}
&lt;/script&gt;

&lt;style scoped&gt;
.collapse__header {
  padding: 12px;
  background-color: #f5f5f5;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.collapse__arrow {
  transition: transform 0.3s ease;  // è¿‡æ¸¡åŠ¨ç”»
}
.rotate {
  transform: rotate(180deg);  // å±•å¼€æ—¶æ—‹è½¬ç®­å¤´
}
.collapse__content {
  padding: 12px;
  border: 1px solid #f5f5f5;
  border-top: none;
}
&lt;/style&gt;
</code></pre>
<p>çˆ¶ç»„ä»¶ä½¿ç”¨æ—¶ï¼Œå¯ä»¥ç›‘å¬<code>toggle</code>äº‹ä»¶è·å–å±•å¼€çŠ¶æ€ï¼Œç”šè‡³ä¿®æ”¹å…¶ä»–ç»„ä»¶çš„æ ·å¼ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- çˆ¶ç»„ä»¶ --&gt;
&lt;template&gt;
  &lt;Collapse 
    title="é¢æ¿1" 
    content="é¢æ¿å†…å®¹..." 
    @toggle="handleToggle"
  /&gt;
  &lt;div :style="{ margin: isOpen ? '20px 0' : '0' }"&gt;
    é¢æ¿ä¸‹æ–¹çš„å†…å®¹
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'
import Collapse from './Collapse.vue'
const isOpen = ref(false)
const handleToggle = (status) =&gt; {
  isOpen.value = status  // åŒæ­¥å±•å¼€çŠ¶æ€
}
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-6">ä¸‰ã€ä½œç”¨åŸŸæ ·å¼ï¼ˆscopedï¼‰å¯¹åŠ¨æ€ç±»åçš„å½±å“</h3>
<p>åœ¨Vueå•æ–‡ä»¶ç»„ä»¶ï¼ˆSFCï¼‰ä¸­ï¼Œ<code>style scoped</code>ä¼šç»™ç»„ä»¶çš„æ‰€æœ‰å…ƒç´ æ·»åŠ ä¸€ä¸ª<strong>å”¯ä¸€çš„å±æ€§</strong>ï¼ˆæ¯”å¦‚<code>data-v-123</code>ï¼‰ï¼Œç¡®ä¿æ ·å¼åªä½œç”¨äºå½“å‰ç»„ä»¶ï¼Œé¿å…æ ·å¼æ±¡æŸ“ã€‚ä½†åŠ¨æ€ç±»åä¼šä¸ä¼šå—å½±å“ï¼Ÿ</p>
<h4 data-id="heading-7">3.1 scopedçš„å·¥ä½œåŸç†</h4>
<p>æ¯”å¦‚å­ç»„ä»¶çš„<code>style scoped</code>ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* å­ç»„ä»¶çš„scopedæ ·å¼ */</span>
<span class="hljs-selector-class">.child</span> {
  <span class="hljs-attribute">color</span>: red;
}
</code></pre>
<p>ç¼–è¯‘åä¼šå˜æˆï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.child</span><span class="hljs-selector-attr">[data-v-123]</span> {
  <span class="hljs-attribute">color</span>: red;
}
</code></pre>
<p>è€Œå­ç»„ä»¶çš„å…ƒç´ ä¼šè¢«æ·»åŠ <code>data-v-123</code>å±æ€§ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child"</span> <span class="hljs-attr">data-v-123</span>&gt;</span>å­ç»„ä»¶å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h4 data-id="heading-8">3.2 åŠ¨æ€ç±»åä¸scopedçš„å…¼å®¹é—®é¢˜</h4>
<p>åŠ¨æ€ç±»åï¼ˆæ¯”å¦‚<code>:class="{ active: isActive }"</code>ï¼‰æ˜¯åœ¨ç»„ä»¶å†…éƒ¨ç”Ÿæˆçš„ï¼Œæ‰€ä»¥scopedä¼šè‡ªåŠ¨ç»™åŠ¨æ€ç±»åæ·»åŠ å±æ€§é€‰æ‹©å™¨ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- å­ç»„ä»¶ --&gt;
&lt;template&gt;
  &lt;div :class="{ 'active': isActive }" class="child"&gt;...&lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.child { /* ç¼–è¯‘åå¸¦data-v-123 */ }
.active { /* ç¼–è¯‘åå˜æˆ.active[data-v-123] */ }
&lt;/style&gt;
</code></pre>
<p>è¿™ç§æƒ…å†µä¸‹ï¼ŒåŠ¨æ€ç±»å<code>active</code>ä¼šæ­£å¸¸ç”Ÿæ•ˆï¼Œå› ä¸ºå®ƒå’Œ<code>child</code>ç±»ä¸€æ ·ï¼Œéƒ½å¸¦æœ‰<code>data-v-123</code>å±æ€§ã€‚</p>
<h4 data-id="heading-9">3.3 çˆ¶ç»„ä»¶å¦‚ä½•ä¿®æ”¹å­ç»„ä»¶çš„åŠ¨æ€ç±»åï¼Ÿ</h4>
<p>å¦‚æœçˆ¶ç»„ä»¶æƒ³ä¿®æ”¹å­ç»„ä»¶çš„åŠ¨æ€ç±»åï¼ˆæ¯”å¦‚<code>active</code>ï¼‰ï¼Œç›´æ¥å†™æ ·å¼æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºçˆ¶ç»„ä»¶çš„æ ·å¼æ²¡æœ‰å­ç»„ä»¶çš„<code>data-v-123</code>å±æ€§ã€‚è¿™æ—¶å€™éœ€è¦ç”¨<strong>æ·±åº¦é€‰æ‹©å™¨</strong><code>::v-deep</code>ï¼ˆæˆ–<code>/deep/</code>ã€<code>&gt;&gt;&gt;</code>ï¼Œä½†Vue3æ¨è<code>::v-deep</code>ï¼‰ã€‚</p>
<p>æ¯”å¦‚çˆ¶ç»„ä»¶æƒ³ä¿®æ”¹å­ç»„ä»¶çš„<code>active</code>ç±»ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- çˆ¶ç»„ä»¶çš„æ ·å¼ --&gt;
&lt;style scoped&gt;
/* æ— æ•ˆï¼šçˆ¶ç»„ä»¶çš„æ ·å¼æ²¡æœ‰å­ç»„ä»¶çš„data-v-123 */
.child .active {
  background-color: yellow;
}

/* æœ‰æ•ˆï¼šç”¨::v-deepç©¿é€scoped */
::v-deep .child .active {
  background-color: yellow;
}
&lt;/style&gt;
</code></pre>
<details>
<summary>å¾€æœŸæ–‡ç« å½’æ¡£</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1bab953e41f66ac53de099fa9fe76483%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1bab953e41f66ac53de099fa9fe76483/" ref="nofollow noopener noreferrer">Vue3ä¸­åŠ¨æ€æ ·å¼æ•°ç»„çš„åé¡¹è¦†ç›–è§„åˆ™å¦‚ä½•ä¸è®¡ç®—å±æ€§ç»“åˆå®ç°å¤æ‚çŠ¶æ€æ ·å¼ç®¡ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc85e1fe16a7ae45e965b4e2df4d9d2f4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c85e1fe16a7ae45e965b4e2df4d9d2f4/" ref="nofollow noopener noreferrer">Vueæµ…å“åº”å¼å¦‚ä½•è§£å†³æ·±å±‚å“åº”å¼çš„æ€§èƒ½é—®é¢˜ï¼Ÿé€‚ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa0af08dd60a37b9a890a9957f2cbfc9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a0af08dd60a37b9a890a9957f2cbfc9f/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡æ–°å¢å±æ€§ã€æ•°ç»„æ”¹ç´¢å¼•ã€åŸå§‹å€¼ä»£ç†çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbc287e1e36287afd90750fd907eca85e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bc287e1e36287afd90750fd907eca85e/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchä¾¦å¬å™¨çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿ä½ æŒæ¡äº†å—ï¼Ÿæ·±åº¦ç›‘å¬ã€ä¸watchEffectçš„å·®å¼‚åŠå¸¸è§æŠ¥é”™è§£æ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc405a8d9950af5b7c63b56c348ac36b6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c405a8d9950af5b7c63b56c348ac36b6/" ref="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆVue 3éœ€è¦refå‡½æ•°ï¼Ÿå®ƒçš„å“åº”å¼åŸç†ä¸æ­£ç¡®ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa7e9abb9691a81e4404d9facabe0f7c3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a7e9abb9691a81e4404d9facabe0f7c3/" ref="nofollow noopener noreferrer">Vue 3ä¸­reactiveå‡½æ•°å¦‚ä½•é€šè¿‡Proxyå®ç°å“åº”å¼ï¼Ÿä½¿ç”¨æ—¶è¦é¿å¼€å“ªäº›è¯¯åŒºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd995ea45161727597fb85b62566c43d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd995ea45161727597fb85b62566c43d/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚åŸç†ä¸å®è·µè¦ç‚¹ä½ çœŸçš„æ‡‚å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F53e3f270a80675df662c6857a3332c0f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/53e3f270a80675df662c6857a3332c0f/" ref="nofollow noopener noreferrer">Vue 3æ¨¡æ¿å¦‚ä½•é€šè¿‡ç¼–è¯‘ä¸‰é˜¶æ®µå®ç°ä»å£°æ˜å¼è¯­æ³•åˆ°é«˜æ•ˆæ¸²æŸ“çš„è·¨è¶Š - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fddbce4f2a23aa72c96b1c0473900321e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ddbce4f2a23aa72c96b1c0473900321e/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿å¼•ç”¨ï¼šä»æ”¶DOMâ€œå¿«é€’â€åˆ°è°ƒå­ç»„ä»¶æ–¹æ³•ï¼Œä½ ç©æ˜ç™½äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F23a2d5a334e15575277814c16e45df50%2F" target="_blank" title="https://blog.cmdragon.cn/posts/23a2d5a334e15575277814c16e45df50/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿é‡Œçš„JSè¡¨è¾¾å¼æœ‰å•¥ä¸èƒ½ç¢°ï¼Ÿè®¡ç®—å±æ€§ä¸ºå•¥æ¯”æ–¹æ³•æ›´èƒ½æ‰“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6be38de6382e31d282659b689c5b17f0%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6be38de6382e31d282659b689c5b17f0/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueçš„v-modelè¡¨å•ç»‘å®šï¼šè¯­æ³•ç³–ã€åŠ¨æ€å€¼ã€ä¿®é¥°ç¬¦çš„å°æŠ€å·§ä½ éƒ½æŒæ¡äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F60ce517684f4a418f453d66aa805606c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/60ce517684f4a418f453d66aa805606c/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3äº‹ä»¶å¤„ç†çš„æŒ‘æˆ˜é¢˜ï¼šv-onã€ä¿®é¥°ç¬¦ã€è‡ªå®šä¹‰äº‹ä»¶ä½ èƒ½é€šå…³å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe4ae7d5e4a9205bb11b2baccb230c637%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e4ae7d5e4a9205bb11b2baccb230c637/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3çš„v-æŒ‡ä»¤ï¼šæ•°æ®å’ŒDOMçš„â€œç¿»è¯‘å®˜â€åˆ°åº•æœ‰å¤šå°‘æœ¬äº‹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F999ce4fb32259ff4fbf4bf7bcb851654%2F" target="_blank" title="https://blog.cmdragon.cn/posts/999ce4fb32259ff4fbf4bf7bcb851654/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3ï¼Œæ’å€¼ã€åŠ¨æ€ç»‘å®šå’Œé¿å‘æŠ€å·§ä½ éƒ½ææ‡‚äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa6997d81b49cd232b87e1cf603888ad1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a6997d81b49cd232b87e1cf603888ad1/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLå¿«åˆ°é£èµ·ï¼Ÿå…ˆæ‰¾å¥åº·å¯†ç è¿˜æ˜¯å…ˆæ¢å¼•æ“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1fee7afbb9abd4540b8aa9c141d6845d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1fee7afbb9abd4540b8aa9c141d6845d/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLæŸ¥è¯¢å¿«åˆ°é£èµ·ï¼Ÿåˆ†åŒºè¡¨ã€ç‰©åŒ–è§†å›¾ã€å¹¶è¡ŒæŸ¥è¯¢è¿™ä¸‰æ‹›çµä¸çµï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F79c590fbd87ece535b11a71c9667884f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/79c590fbd87ece535b11a71c9667884f/" ref="nofollow noopener noreferrer">å­æŸ¥è¯¢æ€»æ‹–æ…¢æŸ¥è¯¢ï¼ŸæŠŠå®ƒå˜æˆè¿æ¥å°±èƒ½è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F748cdac2536008199abf8a8a2cd0ec85%2F" target="_blank" title="https://blog.cmdragon.cn/posts/748cdac2536008199abf8a8a2cd0ec85/" ref="nofollow noopener noreferrer">PostgreSQLå…¨è¡¨æ‰«ææ…¢åˆ°å´©æºƒï¼Ÿå»ºç´¢å¼•+æ”¹æŸ¥è¯¢+æ›´ç»Ÿè®¡ä¿¡æ¯ä¸‰æ‹›èƒ½ç ´ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F32ca943703226d317d4276a8fb53b0dd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/32ca943703226d317d4276a8fb53b0dd/" ref="nofollow noopener noreferrer">å¤æ‚æŸ¥è¯¢æ€»æ‹–åè…¿ï¼ŸPostgreSQLå¤šåˆ—ç´¢å¼•+è¦†ç›–ç´¢å¼•çš„ç¥ä»™æŠ€å·§ä½ getæ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fca93f1d53aa910e7ba5ffd8df611c12b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ca93f1d53aa910e7ba5ffd8df611c12b/" ref="nofollow noopener noreferrer">åªç»™è¡¨å­é›†å»ºç´¢å¼•ï¼Ÿç”¨å‡½æ•°ç»“æœå»ºç´¢å¼•ï¼ŸPostgreSQLè¿™ä¿©æ“ä½œå‡­å•¥èƒ½çœç©ºé—´åˆåŠ é€Ÿï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ff507856ebfddd592448813c510a53669%2F" target="_blank" title="https://blog.cmdragon.cn/posts/f507856ebfddd592448813c510a53669/" ref="nofollow noopener noreferrer">B-treeç´¢å¼•åƒå­—å…¸æŸ¥è¯ä¸€æ ·å·¥ä½œï¼Ÿé‚£å“ªäº›æ•°æ®åº“æŸ¥è¯¢å®ƒèƒ½åŠ é€Ÿï¼Œå“ªäº›ä¸èƒ½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb2213bfcb5b88a862f2138404c03d596%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b2213bfcb5b88a862f2138404c03d596/" ref="nofollow noopener noreferrer">æƒ³æŠ“PostgreSQLé‡Œçš„æ…¢SQLï¼Ÿpg_stat_statementsåŸºç¡€é»‘åŒ£å­å’Œpg_stat_monitoræ—¶é—´çª—ï¼Œè°èƒ½å¸®ä½ æ›´å‡†æªå‡ºæ€§èƒ½å°å·ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F26614eb7da6c476dde41d367ad888d2f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/26614eb7da6c476dde41d367ad888d2f/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œæ—¶å…‰æœºâ€MVCCå’Œé”æœºåˆ¶æ˜¯æ€ä¹ˆæå®šé«˜å¹¶å‘çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F69f99bc6972a860d559c74aad7280da4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/69f99bc6972a860d559c74aad7280da4/" ref="nofollow noopener noreferrer">PostgreSQLæ€§èƒ½æš´æ¶¨çš„å…³é”®ï¼Ÿå†…å­˜IOå¹¶å‘å‚æ•°å±…ç„¶è¦è¿™ä¹ˆè®¾ç½®ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F7b7053f392147a8b3b1a16bebeb08d0a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/7b7053f392147a8b3b1a16bebeb08d0a/" ref="nofollow noopener noreferrer">å¤§è¡¨æŸ¥è¯¢æ…¢åˆ°ç¿»éæ•´ä¸ªä¹¦æ¶ï¼ŸPostgreSQLåˆ†åŒºè¡¨æ•™ä½ æ€ä¹ˆâ€œåˆ†ç±»â€æ‰é«˜æ•ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc856e3cb073822349f3bf2d29995dcfc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c856e3cb073822349f3bf2d29995dcfc/" ref="nofollow noopener noreferrer">PostgreSQL æŸ¥è¯¢æ…¢ï¼Ÿæ˜¯ä¸æ˜¯å¿˜äº†ä¼˜åŒ– GROUP BYã€ORDER BY å’Œçª—å£å‡½æ•°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc096347d18e67b7431faacd2c4757093%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c096347d18e67b7431faacd2c4757093/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„å­æŸ¥è¯¢å’ŒCTEå±…ç„¶åœ¨æ€§èƒ½ä¸Šâ€œææ¶â€ï¼Ÿåˆ°åº•è¯¥ç«™å“ªè¾¹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F2eca89463454fd4250d7b66243b9fe5a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/2eca89463454fd4250d7b66243b9fe5a/" ref="nofollow noopener noreferrer">PostgreSQLé€‰Joinç­–ç•¥æœ‰å•¥å°ä¹ä¹ï¼ŸNested Loop/Merge/Hashè°æ˜¯å®ƒçš„èœï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F068ecb772a87d7df20a8c9fb4b233f8e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/068ecb772a87d7df20a8c9fb4b233f8e/" ref="nofollow noopener noreferrer">PostgreSQLæ–°æ‰‹SQLæ€»ç¿»è½¦ï¼Ÿè¿™7ä¸ªæ€§èƒ½é™·é˜±ä½ è¸©è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd498f63cd0a2d5a77e445c688a8b88db%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d498f63cd0a2d5a77e445c688a8b88db/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•é€‰B-Treeè¿˜æ˜¯GiSTï¼Ÿâ€œç‘å£«å†›åˆ€â€å’Œâ€œå¤šé¢æ‰‹â€çš„å·®åˆ«ä½ å±…ç„¶è¿˜ä¸çŸ¥é“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F9101b75bdec6faea9b35d54f14e37f36%2F" target="_blank" title="https://blog.cmdragon.cn/posts/9101b75bdec6faea9b35d54f14e37f36/" ref="nofollow noopener noreferrer">æƒ³çŸ¥é“æ•°æ®åº“æ€ä¹ˆç»™æŸ¥è¯¢â€œç®—æˆæœ¬é€‰è·¯çº¿â€ï¼ŸEXPLAINèƒ½å¸®ä½ çœ‹æ˜ç™½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd527f8ebb6e3dae2c7dfe4c8d8979444%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d527f8ebb6e3dae2c7dfe4c8d8979444/" ref="nofollow noopener noreferrer">PostgreSQLå¤„ç†SQLå±…ç„¶åƒåšè›‹ç³•ï¼Ÿè§£æåˆ°æ‰§è¡Œçš„4æ­¥é‡Œè—ç€å¤šå°‘æŸ¥è¯¢ä¼˜åŒ–çš„å°å¿ƒæœºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6bfdae84f313cf7ad0bb7045c4392347%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6bfdae84f313cf7ad0bb7045c4392347/" ref="nofollow noopener noreferrer">PostgreSQLå¤‡ä»½ä¸æ˜¯å¤åˆ¶æ–‡ä»¶ï¼Ÿç‰©ç†vsé€»è¾‘å’‹é€‰ï¼Ÿè¯¯åˆ è¿˜èƒ½ç²¾å‡†æ¢å¤åˆ°1åˆ†é’Ÿå‰ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fde3672803de34dbad244d0a8d48b0eb5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/de3672803de34dbad244d0a8d48b0eb5/" ref="nofollow noopener noreferrer">è½¬è´¦ä¸ç¿»è½¦ã€å¹¶å‘ä¸å¹²æ‰°ï¼ŒPostgreSQLçš„ACIDç‰¹æ€§åˆ°åº•æœ‰å•¥é­”æ³•ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe463e8a2668abdf00a228c9b79324ded%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e463e8a2668abdf00a228c9b79324ded/" ref="nofollow noopener noreferrer">é“¶è¡Œè½¬è´¦ä¸ç™½æ‰£é’±ã€ç”µå•†ä¸‹å•ä¸è¶…å–ï¼ŒPostgreSQLäº‹åŠ¡çš„è¯€çªæ˜¯å•¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F5c967e595058c4a1fc4474a68e64031d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/5c967e595058c4a1fc4474a68e64031d/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„PL/pgSQLåˆ°åº•æ˜¯å•¥ï¼Ÿèƒ½è®©SQLä»â€œè¯´ç›®æ ‡â€å˜â€œè®²æ­¥éª¤â€ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F325047855e3e23b5ef82f7d2db134fbd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/325047855e3e23b5ef82f7d2db134fbd/" ref="nofollow noopener noreferrer">PostgreSQLè§†å›¾ä¸å­˜æ•°æ®ï¼Ÿé‚£å®ƒæ€ä¹ˆç®€åŒ–æŸ¥è¯¢è¿˜èƒ½é€’å½’ç”Ÿæˆåºåˆ—å’Œæ§åˆ¶æƒé™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd2dba50bb6e4df7b27e735245a06a2a2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d2dba50bb6e4df7b27e735245a06a2a2/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•è¿™ä¹ˆç©ï¼Œæ‰èƒ½è®©ä½ çš„æŸ¥è¯¢çœŸçš„â€œé£â€èµ·æ¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F849ae5bab0f8c66e94c2f6ad1bb798e3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/849ae5bab0f8c66e94c2f6ad1bb798e3/" ref="nofollow noopener noreferrer">PostgreSQLçš„è¡¨å…³ç³»å’Œçº¦æŸï¼Œå’‹å¸®ä½ æå®šç”¨æˆ·è®¢å•ä¸æ··ä¹±ã€å­¦ç”Ÿé€‰è¯¾ä¸é‡å¤ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fef4800975ffa84f1ca51976a70a1585b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ef4800975ffa84f1ca51976a70a1585b/" ref="nofollow noopener noreferrer">PostgreSQLæŸ¥è¯¢çš„ç­›å­ã€æ’åºã€èšåˆã€åˆ†ç»„ï¼Ÿä½ ä¼šç”¨å®ƒä»¬æå®šæ•°æ®å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbf54711525c507c5eacfa7b0151c39d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bf54711525c507c5eacfa7b0151c39d2/" ref="nofollow noopener noreferrer">PostgreSQLæ•°æ®ç±»å‹æ€ä¹ˆé€‰æ‰é«˜æ•ˆä¸è¸©å‘ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F887809b3e0375f5956873cd442f516d8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/887809b3e0375f5956873cd442f516d8/" ref="nofollow noopener noreferrer">æƒ³è§£é”PostgreSQLæŸ¥è¯¢ä»åŸºç¡€åˆ°è¿›é˜¶çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Ÿä½ éƒ½getäº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F934be1203725e8be9d6f6e9104e5abcc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/934be1203725e8be9d6f6e9104e5abcc/" ref="nofollow noopener noreferrer">PostgreSQL DELETEå±…ç„¶æœ‰è¿™äº›æ“ä½œï¼Ÿè¿”å›æ•°æ®ã€è¿è¡¨åˆ ä½ è¯•è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0f0622e9b7402b599e618150d0596ffe%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0f0622e9b7402b599e618150d0596ffe/" ref="nofollow noopener noreferrer">PostgreSQL UPDATEè¯­å¥æ€ä¹ˆç©ï¼Ÿä»æ”¹é‚®ç®±åˆ°æ‰¹é‡æ›´æ–°çš„é¿å‘æŠ€å·§ä½ éƒ½ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0e3bf7efc030b024ea67ee855a00f2de%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0e3bf7efc030b024ea67ee855a00f2de/" ref="nofollow noopener noreferrer">PostgreSQLæ’å…¥æ•°æ®è¿˜åœ¨é€æ¡æ•²ï¼Ÿæ‰¹é‡ã€å†²çªå¤„ç†ã€è¿”å›è‡ªå¢IDçš„æŠ€å·§ä½ ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb6cd3c86da6aac26ed829e472d34078e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b6cd3c86da6aac26ed829e472d34078e/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œä»“åº“-æˆ¿é—´-è´§æ¶â€æ¸¸æˆï¼Œä½ èƒ½å»ºå‡ºç”µå•†æ•°æ®åº“å’Œè¡¨å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fba1f545a3410144552fbdbfcf31b5265%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ba1f545a3410144552fbdbfcf31b5265/" ref="nofollow noopener noreferrer">PostgreSQL 17å®‰è£…æ€»ç¿»è½¦ï¼ŸWindows/macOS/Linuxé¿å‘æŒ‡å—å¸®ä½ æå®šï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb5474d1480509c5072085abc80b3dd9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b5474d1480509c5072085abc80b3dd9f/" ref="nofollow noopener noreferrer">èƒ½å½“å…³ç³»å‹æ•°æ®åº“è¿˜èƒ½ç©å¯¹è±¡ç‰¹æ€§ï¼Œèƒ½æ‹†å¤æ‚æŸ¥è¯¢è¿˜èƒ½è‡ªåŠ¨ç®¡åº“å­˜ï¼ŒPostgreSQLå‡­ä»€ä¹ˆè¿™ä¹ˆé¦™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fcc098d8836e787baa8a4d92e4d56d5c5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/cc098d8836e787baa8a4d92e4d56d5c5/" ref="nofollow noopener noreferrer">ç»™æ¥å£åŠ æ–°å­—æ®µåˆä¸æå´©è€å®¢æˆ·ç«¯ï¼ŸFastAPIçš„å¤šç‰ˆæœ¬APIé å“ªä¸‰æ‹›å®ç°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F46d05151c5bd31cf37a7bcf0b8f5b0b8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/46d05151c5bd31cf37a7bcf0b8f5b0b8/" ref="nofollow noopener noreferrer">æµé‡çªå¢è¦æå´©FastAPIï¼Ÿç†”æ–­æµ‹è¯•æ˜¯æ€ä¹ˆé˜²ç³»ç»Ÿé›ªå´©çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F65ce343cc5df9faf3a8e2eeaab42ae45%2F" target="_blank" title="https://blog.cmdragon.cn/posts/65ce343cc5df9faf3a8e2eeaab42ae45/" ref="nofollow noopener noreferrer">FastAPIç§’æ€åº“å­˜æ€»å˜è´Ÿæ•°ï¼ŸRedisåˆ†å¸ƒå¼é”èƒ½å¸®ä½ å®ˆä½åº•çº¿å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Feed6cd8985d9be0a4b092a7da38b3e0c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/eed6cd8985d9be0a4b092a7da38b3e0c/" ref="nofollow noopener noreferrer">FastAPIçš„CIæµæ°´çº¿æ€ä¹ˆè‡ªåŠ¨æµ‹ç«¯ç‚¹ï¼Œè¿˜èƒ½è®©AllureæŠ¥å‘Šç¾åˆ°çŠ¯è§„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6157d87338ce894d18c013c3c4777abb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6157d87338ce894d18c013c3c4777abb/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨GitHub Actionsä¸ºFastAPIé¡¹ç›®æ‰“é€ è‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ffc4ef84559e04693a620d0714cb30787%2F" target="_blank" title="https://blog.cmdragon.cn/posts/fc4ef84559e04693a620d0714cb30787/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨Git Hookå’ŒCIæµæ°´çº¿ä¸ºFastAPIé¡¹ç›®ä¿é©¾æŠ¤èˆªï¼Ÿ - cmdragon's Blog</a></li>
</ul>
</details>
<details>
<summary>å…è´¹å¥½ç”¨çš„çƒ­é—¨åœ¨çº¿å·¥å…·</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fraid-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/raid-calculator" ref="nofollow noopener noreferrer">RAID è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fphotoshop-online" target="_blank" title="https://tools.cmdragon.cn/zh/apps/photoshop-online" ref="nofollow noopener noreferrer">åœ¨çº¿PS - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmermaid-live-editor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/mermaid-live-editor" ref="nofollow noopener noreferrer">Mermaid åœ¨çº¿ç¼–è¾‘å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmath-solver-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/math-solver-calculator" ref="nofollow noopener noreferrer">æ•°å­¦æ±‚è§£è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsmart-teleprompter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/smart-teleprompter" ref="nofollow noopener noreferrer">æ™ºèƒ½æè¯å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmagic-resume" target="_blank" title="https://tools.cmdragon.cn/zh/apps/magic-resume" ref="nofollow noopener noreferrer">é­”æ³•ç®€å† - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-puzzle-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-puzzle-tool" ref="nofollow noopener noreferrer">Image Puzzle Tool - å›¾ç‰‡æ‹¼å›¾å·¥å…· | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsubtitle-downloader" target="_blank" title="https://tools.cmdragon.cn/zh/apps/subtitle-downloader" ref="nofollow noopener noreferrer">å­—å¹•ä¸‹è½½å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flyrics-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lyrics-generator" ref="nofollow noopener noreferrer">æ­Œè¯ç”Ÿæˆå·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcloud-drive-search" target="_blank" title="https://tools.cmdragon.cn/zh/apps/cloud-drive-search" ref="nofollow noopener noreferrer">ç½‘ç›˜èµ„æºèšåˆæœç´¢ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fascii-art-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ascii-art-generator" ref="nofollow noopener noreferrer">ASCIIå­—ç¬¦ç”»ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fjwt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/jwt-tool" ref="nofollow noopener noreferrer">JSON Web Tokens å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbcrypt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/bcrypt-tool" ref="nofollow noopener noreferrer">Bcrypt å¯†ç å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-composer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-composer" ref="nofollow noopener noreferrer">GIF åˆæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-decomposer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-decomposer" ref="nofollow noopener noreferrer">GIF åˆ†è§£å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-steganography" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-steganography" ref="nofollow noopener noreferrer">æ–‡æœ¬éšå†™æœ¯ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh" target="_blank" title="https://tools.cmdragon.cn/zh" ref="nofollow noopener noreferrer">CMDragon åœ¨çº¿å·¥å…· - é«˜çº§AIå·¥å…·ç®±ä¸å¼€å‘è€…å¥—ä»¶ | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%3Fcategory%3Dtrending" target="_blank" title="https://tools.cmdragon.cn/zh/apps?category=trending" ref="nofollow noopener noreferrer">åº”ç”¨å•†åº— - å‘ç°1000+æå‡æ•ˆç‡ä¸å¼€å‘çš„AIå·¥å…·å’Œå®ç”¨ç¨‹åº | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fchangelog" target="_blank" title="https://tools.cmdragon.cn/zh/changelog" ref="nofollow noopener noreferrer">CMDragon æ›´æ–°æ—¥å¿— - æœ€æ–°æ›´æ–°ã€åŠŸèƒ½ä¸æ”¹è¿› | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fsponsor" target="_blank" title="https://tools.cmdragon.cn/zh/sponsor" ref="nofollow noopener noreferrer">æ”¯æŒæˆ‘ä»¬ - æˆä¸ºèµåŠ©è€… | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-ai" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-ai" ref="nofollow noopener noreferrer">AIæ–‡æœ¬ç”Ÿæˆå›¾åƒ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftemp-email" target="_blank" title="https://tools.cmdragon.cn/zh/apps/temp-email" ref="nofollow noopener noreferrer">ä¸´æ—¶é‚®ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fqrcode-parser" target="_blank" title="https://tools.cmdragon.cn/zh/apps/qrcode-parser" ref="nofollow noopener noreferrer">äºŒç»´ç è§£æå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-mindmap" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-mindmap" ref="nofollow noopener noreferrer">æ–‡æœ¬è½¬æ€ç»´å¯¼å›¾ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fregex-visualizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/regex-visualizer" ref="nofollow noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼å¯è§†åŒ–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsteganography-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/steganography-tool" ref="nofollow noopener noreferrer">æ–‡ä»¶éšå†™å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fiptv-explorer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/iptv-explorer" ref="nofollow noopener noreferrer">IPTV é¢‘é“æ¢ç´¢å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsnapdrop" target="_blank" title="https://tools.cmdragon.cn/zh/apps/snapdrop" ref="nofollow noopener noreferrer">å¿«ä¼  - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flucky-draw" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lucky-draw" ref="nofollow noopener noreferrer">éšæœºæŠ½å¥–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fanime-scene-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/anime-scene-finder" ref="nofollow noopener noreferrer">åŠ¨æ¼«åœºæ™¯æŸ¥æ‰¾å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftime-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/time-toolkit" ref="nofollow noopener noreferrer">æ—¶é—´å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fspeed-test" target="_blank" title="https://tools.cmdragon.cn/zh/apps/speed-test" ref="nofollow noopener noreferrer">ç½‘é€Ÿæµ‹è¯• - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-remover" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-remover" ref="nofollow noopener noreferrer">AI æ™ºèƒ½æŠ å›¾å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-replacer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-replacer" ref="nofollow noopener noreferrer">èƒŒæ™¯æ›¿æ¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fartistic-qrcode" target="_blank" title="https://tools.cmdragon.cn/zh/apps/artistic-qrcode" ref="nofollow noopener noreferrer">è‰ºæœ¯äºŒç»´ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fopen-graph-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/open-graph-generator" ref="nofollow noopener noreferrer">Open Graph å…ƒæ ‡ç­¾ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-comparison" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-comparison" ref="nofollow noopener noreferrer">å›¾åƒå¯¹æ¯”å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-compressor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-compressor" ref="nofollow noopener noreferrer">å›¾ç‰‡å‹ç¼©ä¸“ä¸šç‰ˆ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fpassword-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/password-generator" ref="nofollow noopener noreferrer">å¯†ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsvg-optimizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/svg-optimizer" ref="nofollow noopener noreferrer">SVGä¼˜åŒ–å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcolor-palette" target="_blank" title="https://tools.cmdragon.cn/zh/apps/color-palette" ref="nofollow noopener noreferrer">è°ƒè‰²æ¿ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fonline-metronome" target="_blank" title="https://tools.cmdragon.cn/zh/apps/online-metronome" ref="nofollow noopener noreferrer">åœ¨çº¿èŠ‚æ‹å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcss-grid-layout" target="_blank" title="https://tools.cmdragon.cn/zh/apps/css-grid-layout" ref="nofollow noopener noreferrer">CSSç½‘æ ¼å¸ƒå±€ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Femail-validator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/email-validator" ref="nofollow noopener noreferrer">é‚®ç®±éªŒè¯å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcalligraphy-practice" target="_blank" title="https://tools.cmdragon.cn/zh/apps/calligraphy-practice" ref="nofollow noopener noreferrer">ä¹¦æ³•ç»ƒä¹ å­—å¸– - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffinance-calculator-suite" target="_blank" title="https://tools.cmdragon.cn/zh/apps/finance-calculator-suite" ref="nofollow noopener noreferrer">é‡‘èè®¡ç®—å™¨å¥—ä»¶ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fchinese-kinship-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/chinese-kinship-calculator" ref="nofollow noopener noreferrer">ä¸­å›½äº²æˆšå…³ç³»è®¡ç®—å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fprotobuf-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/protobuf-toolkit" ref="nofollow noopener noreferrer">Protocol Buffer å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-upscaler" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-upscaler" ref="nofollow noopener noreferrer">å›¾ç‰‡æ— æŸæ”¾å¤§ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-compare" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-compare" ref="nofollow noopener noreferrer">æ–‡æœ¬æ¯”è¾ƒå·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-batch-lookup" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-batch-lookup" ref="nofollow noopener noreferrer">IPæ‰¹é‡æŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdomain-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/domain-finder" ref="nofollow noopener noreferrer">åŸŸåæŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdns-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/dns-toolkit" ref="nofollow noopener noreferrer">DNSå·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffavicon-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/favicon-generator" ref="nofollow noopener noreferrer">ç½‘ç«™å›¾æ ‡ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fsitemap_index.xml" target="_blank" title="https://tools.cmdragon.cn/sitemap_index.xml" ref="nofollow noopener noreferrer">XML Sitemap</a></li>
</ul>
</details>
<p><strong>æ³¨æ„</strong>ï¼šæ·±åº¦é€‰æ‹©å™¨ä¼šç©¿é€å½“å‰ç»„ä»¶çš„scopedï¼Œå½±å“æ‰€æœ‰å­ç»„ä»¶çš„å¯¹åº”ç±»åï¼Œæ‰€ä»¥è¦è°¨æ…ä½¿ç”¨ï¼ˆæ¯”å¦‚ç»™å­ç»„ä»¶åŠ ç‹¬ç‰¹çš„classå‰ç¼€ï¼‰ã€‚</p>
<h3 data-id="heading-10">å››ã€æ€§èƒ½ä¼˜åŒ–ï¼šé¿å…é¢‘ç¹åˆ‡æ¢æ ·å¼å¯¹è±¡</h3>
<p>Vueä¸­ï¼Œ<code>:style</code>ç»‘å®šçš„å¯¹è±¡å¦‚æœ<strong>é¢‘ç¹å˜åŒ–</strong>ï¼ˆæ¯”å¦‚æ¯ç§’åˆ‡æ¢ä¸€æ¬¡é¢œè‰²ï¼‰ï¼Œä¼šå¯¼è‡´Vueé¢‘ç¹é‡æ–°è®¡ç®—æ ·å¼ï¼Œå½±å“æ€§èƒ½ã€‚æˆ‘ä»¬éœ€è¦<strong>ç¼“å­˜æ ·å¼å¯¹è±¡</strong>ï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“ã€‚</p>
<h4 data-id="heading-11">4.1 é—®é¢˜æ ¹æºï¼šå¯¹è±¡å¼•ç”¨å˜åŒ–</h4>
<p>æ¯”å¦‚ä¸‹é¢çš„å†™æ³•ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šåˆ›å»ºä¸€ä¸ª<strong>æ–°çš„æ ·å¼å¯¹è±¡</strong>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ä¸å¥½çš„å†™æ³•ï¼šæ¯æ¬¡æ¸²æŸ“éƒ½ç”Ÿæˆæ–°å¯¹è±¡ --&gt;
&lt;template&gt;
  &lt;div :style="{ 
    color: isActive ? 'red' : 'blue', 
    fontSize: `${fontSize}px` 
  }"&gt;
    åŠ¨æ€æ ·å¼
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>Vueä¼šè®¤ä¸ºâ€œæ ·å¼å¯¹è±¡å˜äº†â€ï¼Œå³ä½¿é‡Œé¢çš„å±æ€§å€¼æ²¡å˜åŒ–ï¼Œä¹Ÿä¼šé‡æ–°åº”ç”¨æ ·å¼ã€‚</p>
<h4 data-id="heading-12">4.2 ä¼˜åŒ–æ–¹æ¡ˆï¼šç”¨è®¡ç®—å±æ€§ç¼“å­˜</h4>
<p>è®¡ç®—å±æ€§ï¼ˆ<code>computed</code>ï¼‰ä¼šç¼“å­˜ç»“æœï¼Œåªæœ‰å½“ä¾èµ–çš„å“åº”å¼å˜é‡å˜åŒ–æ—¶ï¼Œæ‰ä¼šé‡æ–°è®¡ç®—ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- å¥½çš„å†™æ³•ï¼šç”¨computedç¼“å­˜æ ·å¼å¯¹è±¡ --&gt;
&lt;template&gt;
  &lt;div :style="dynamicStyle"&gt;åŠ¨æ€æ ·å¼&lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, computed } from 'vue'
const isActive = ref(false)
const fontSize = ref(16)

// è®¡ç®—å±æ€§ç¼“å­˜æ ·å¼å¯¹è±¡
const dynamicStyle = computed(() =&gt; ({
  color: isActive.value ? 'red' : 'blue',
  fontSize: `${fontSize.value}px`
}))
&lt;/script&gt;
</code></pre>
<p>è¿™æ ·ï¼Œåªæœ‰<code>isActive</code>æˆ–<code>fontSize</code>å˜åŒ–æ—¶ï¼Œ<code>dynamicStyle</code>æ‰ä¼šæ›´æ–°ï¼Œé¿å…äº†é¢‘ç¹åˆ›å»ºæ–°å¯¹è±¡ã€‚</p>
<h4 data-id="heading-13">4.3 æœ€ä½³å®è·µï¼šé™æ€ä¸åŠ¨æ€åˆ†ç¦»</h4>
<p>å¦‚æœæ ·å¼å¯¹è±¡ä¸­æœ‰<strong>é™æ€å±æ€§</strong>ï¼ˆä¸ä¼šå˜åŒ–çš„ï¼‰ï¼Œå¯ä»¥æŠŠå®ƒä»¬æ”¾åˆ°<code>computed</code>ä¹‹å¤–ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
const baseStyle = {
  padding: '16px',
  border: '1px solid #ccc'  // é™æ€æ ·å¼
}
const dynamicStyle = computed(() =&gt; ({
  ...baseStyle,  // åˆå¹¶é™æ€æ ·å¼
  color: isActive.value ? 'red' : 'blue'  // åŠ¨æ€æ ·å¼
}))
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-14">è¯¾åQuizï¼šå·©å›ºä½ çš„çŸ¥è¯†</h3>
<h4 data-id="heading-15">é—®é¢˜1ï¼šå¦‚ä½•åœ¨Vue3ä¸­æ··åˆä½¿ç”¨classå’Œstyleç»‘å®šï¼Ÿ</h4>
<p><strong>ç­”æ¡ˆ</strong>ï¼šå¯ä»¥åŒæ—¶ä½¿ç”¨<code>class</code>ï¼ˆé™æ€/åŠ¨æ€ï¼‰å’Œ<code>:style</code>ï¼ˆåŠ¨æ€ï¼‰ç»‘å®šã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;div class="static-class" :class="{ active: isActive }" :style="{ color: textColor }"&gt;...&lt;/div&gt;
</code></pre>
<h4 data-id="heading-16">é—®é¢˜2ï¼šscopedæ ·å¼ä¸‹ï¼Œçˆ¶ç»„ä»¶å¦‚ä½•ä¿®æ”¹å­ç»„ä»¶çš„åŠ¨æ€ç±»åï¼Ÿ</h4>
<p><strong>ç­”æ¡ˆ</strong>ï¼šä½¿ç”¨æ·±åº¦é€‰æ‹©å™¨<code>::v-deep</code>ã€‚ä¾‹å¦‚çˆ¶ç»„ä»¶æƒ³ä¿®æ”¹å­ç»„ä»¶çš„<code>active</code>ç±»ï¼š</p>
<pre><code class="hljs language-css" lang="css">::v-deep .child-component .active {
  <span class="hljs-attribute">background-color</span>: yellow;
}
</code></pre>
<h4 data-id="heading-17">é—®é¢˜3ï¼šå¦‚ä½•ä¼˜åŒ–é¢‘ç¹åˆ‡æ¢æ ·å¼å¯¹è±¡çš„æ€§èƒ½ï¼Ÿ</h4>
<p><strong>ç­”æ¡ˆ</strong>ï¼šç”¨<code>computed</code>è®¡ç®—å±æ€§ç¼“å­˜æ ·å¼å¯¹è±¡ï¼Œé¿å…æ¯æ¬¡æ¸²æŸ“éƒ½åˆ›å»ºæ–°å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">const dynamicStyle = computed(() =&gt; ({
  color: isActive.value ? 'red' : 'blue'
}))
</code></pre>
<h3 data-id="heading-18">å¸¸è§æŠ¥é”™è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-19">1. åŠ¨æ€ç±»åä¸ç”Ÿæ•ˆ</h4>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>ç±»åæ‹¼å†™é”™è¯¯ï¼ˆæ¯”å¦‚<code>btn--active</code>å†™æˆ<code>btn-active</code>ï¼‰ï¼›</li>
<li>scopedæ ·å¼å¯¼è‡´çˆ¶ç»„ä»¶çš„ç±»åæ— æ³•ä½œç”¨äºå­ç»„ä»¶ï¼›</li>
<li>åŠ¨æ€æ¡ä»¶é”™è¯¯ï¼ˆæ¯”å¦‚<code>isActive</code>å§‹ç»ˆä¸º<code>false</code>ï¼‰ã€‚</li>
</ul>
<p><strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥ç±»åæ‹¼å†™ï¼›</li>
<li>ç”¨<code>console.log(isActive)</code>éªŒè¯åŠ¨æ€æ¡ä»¶ï¼›</li>
<li>çˆ¶ç»„ä»¶ä¿®æ”¹å­ç»„ä»¶æ ·å¼æ—¶ï¼Œç”¨<code>::v-deep</code>ã€‚</li>
</ul>
<h4 data-id="heading-20">2. æ ·å¼å¯¹è±¡é¢‘ç¹åˆ‡æ¢å¯¼è‡´å¡é¡¿</h4>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>åœ¨<code>template</code>ä¸­ç›´æ¥å†™<code>:style="{ ... }"</code>ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½åˆ›å»ºæ–°å¯¹è±¡ã€‚</li>
</ul>
<p><strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>ç”¨<code>computed</code>ç¼“å­˜æ ·å¼å¯¹è±¡ï¼›</li>
<li>æŠŠé™æ€æ ·å¼æ”¾åˆ°<code>computed</code>ä¹‹å¤–ï¼Œå‡å°‘è®¡ç®—é‡ã€‚</li>
</ul>
<h4 data-id="heading-21">3. çˆ¶ç»„ä»¶æ— æ³•ä¿®æ”¹å­ç»„ä»¶çš„scopedæ ·å¼</h4>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>scopedæ ·å¼ç»™å­ç»„ä»¶å…ƒç´ æ·»åŠ äº†å”¯ä¸€å±æ€§ï¼Œçˆ¶ç»„ä»¶çš„æ ·å¼æ²¡æœ‰è¯¥å±æ€§ï¼Œæ— æ³•åŒ¹é…ã€‚</li>
</ul>
<p><strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨æ·±åº¦é€‰æ‹©å™¨<code>::v-deep</code>ï¼›</li>
<li>å­ç»„ä»¶æš´éœ²<code>props</code>æ¥æ”¶çˆ¶ç»„ä»¶çš„æ ·å¼ï¼ˆæ¯”å¦‚<code>:custom-style="parentStyle"</code>ï¼‰ï¼›</li>
<li>å­ç»„ä»¶ä½¿ç”¨éscopedæ ·å¼ï¼ˆä¸æ¨èï¼Œå®¹æ˜“æ±¡æŸ“å…¨å±€ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-22">å‚è€ƒé“¾æ¥</h3>
<ul>
<li>Vue classä¸styleç»‘å®šï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Fclass-and-style.html" target="_blank" title="https://vuejs.org/guide/essentials/class-and-style.html" ref="nofollow noopener noreferrer">vuejs.org/guide/essenâ€¦</a></li>
<li>Vue scopedæ ·å¼ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fapi%2Fsfc-css-features.html%23scoped-css" target="_blank" title="https://vuejs.org/api/sfc-css-features.html#scoped-css" ref="nofollow noopener noreferrer">vuejs.org/api/sfc-cssâ€¦</a></li>
<li>Vue è®¡ç®—å±æ€§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Fcomputed.html" target="_blank" title="https://vuejs.org/guide/essentials/computed.html" ref="nofollow noopener noreferrer">vuejs.org/guide/essenâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Go è¯­è¨€å…¥é—¨æ ¸å¿ƒæ¦‚å¿µæ€»ç»“]]></title>    <link>https://juejin.cn/post/7584810656382386185</link>    <guid>https://juejin.cn/post/7584810656382386185</guid>    <pubDate>2025-12-18T05:55:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584810656382386185" data-draft-id="7584110439933952046" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Go è¯­è¨€å…¥é—¨æ ¸å¿ƒæ¦‚å¿µæ€»ç»“"/> <meta itemprop="keywords" content="Go"/> <meta itemprop="datePublished" content="2025-12-18T05:55:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¡å°”ç‰¹æ–¯"/> <meta itemprop="url" content="https://juejin.cn/user/4450440831840909"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Go è¯­è¨€å…¥é—¨æ ¸å¿ƒæ¦‚å¿µæ€»ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4450440831840909/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¡å°”ç‰¹æ–¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:55:48.000Z" title="Thu Dec 18 2025 05:55:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å˜é‡ä¸å¸¸é‡å£°æ˜</h2>
<h3 data-id="heading-1">var - å˜é‡å£°æ˜</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// var å£°æ˜å˜é‡ï¼ˆå¯åœ¨å‡½æ•°å†…å¤–ä½¿ç”¨ï¼‰</span>
<span class="hljs-keyword">var</span> name <span class="hljs-type">string</span> = <span class="hljs-string">"Go"</span>          <span class="hljs-comment">// æ˜¾å¼æŒ‡å®šç±»å‹ä¸ºstring</span>
<span class="hljs-keyword">var</span> age = <span class="hljs-number">25</span>                    <span class="hljs-comment">// ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ç±»å‹ä¸ºint</span>
<span class="hljs-keyword">var</span> x, y <span class="hljs-type">int</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>             <span class="hljs-comment">// åŒæ—¶å£°æ˜å¤šä¸ªåŒç±»å‹å˜é‡ï¼Œåˆå§‹åŒ–ä¸ºæŒ‡å®šå€¼</span>

<span class="hljs-comment">// é›¶å€¼åˆå§‹åŒ–ï¼ˆæœªèµ‹å€¼çš„å˜é‡è‡ªåŠ¨åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼‰</span>
<span class="hljs-keyword">var</span> count <span class="hljs-type">int</span>                   <span class="hljs-comment">// 0ï¼ˆintçš„é›¶å€¼ï¼‰</span>
<span class="hljs-keyword">var</span> price <span class="hljs-type">float64</span>               <span class="hljs-comment">// 0.0ï¼ˆfloat64çš„é›¶å€¼ï¼‰</span>
<span class="hljs-keyword">var</span> isReady <span class="hljs-type">bool</span>                <span class="hljs-comment">// falseï¼ˆboolçš„é›¶å€¼ï¼‰</span>
<span class="hljs-keyword">var</span> text <span class="hljs-type">string</span>                 <span class="hljs-comment">// ""ï¼ˆstringçš„é›¶å€¼ï¼‰</span>
<span class="hljs-keyword">var</span> numbers []<span class="hljs-type">int</span>               <span class="hljs-comment">// nilï¼ˆåˆ‡ç‰‡çš„é›¶å€¼ï¼‰</span>
<span class="hljs-keyword">var</span> data <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>         <span class="hljs-comment">// nilï¼ˆæ˜ å°„çš„é›¶å€¼ï¼‰</span>
<span class="hljs-keyword">var</span> ptr *<span class="hljs-type">int</span>                    <span class="hljs-comment">// nilï¼ˆæŒ‡é’ˆçš„é›¶å€¼ï¼‰</span>
</code></pre>
<h3 data-id="heading-2">ç®€çŸ­å£°æ˜ :=</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// := ç®€çŸ­å£°æ˜ï¼ˆåªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œè‡ªåŠ¨æ¨æ–­ç±»å‹ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    name := <span class="hljs-string">"Alice"</span>             <span class="hljs-comment">// ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ä¸ºstringç±»å‹</span>
    count := <span class="hljs-number">10</span>                 <span class="hljs-comment">// ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ä¸ºintç±»å‹</span>
    a, b := <span class="hljs-number">1</span>, <span class="hljs-string">"hello"</span>          <span class="hljs-comment">// åŒæ—¶å£°æ˜ä¸åŒç±»å‹çš„å˜é‡</span>
    <span class="hljs-comment">// æ³¨æ„ï¼š:= å·¦ä¾§è‡³å°‘æœ‰ä¸€ä¸ªæ–°å˜é‡ï¼Œå¦åˆ™åº”ä½¿ç”¨ =</span>
}
</code></pre>
<h3 data-id="heading-3">const - å¸¸é‡å£°æ˜</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// const å£°æ˜å¸¸é‡ï¼ˆå€¼ä¸å¯ä¿®æ”¹ï¼Œç¼–è¯‘æ—¶ç¡®å®šï¼‰</span>
<span class="hljs-keyword">const</span> Pi = <span class="hljs-number">3.14159</span>             <span class="hljs-comment">// å•å¸¸é‡å£°æ˜ï¼Œç±»å‹æ¨æ–­</span>
<span class="hljs-keyword">const</span> MaxUsers = <span class="hljs-number">1000</span>          <span class="hljs-comment">// å¸¸é‡å€¼åœ¨ç¼–è¯‘æ—¶ç¡®å®š</span>

<span class="hljs-comment">// å¸¸é‡ç»„ï¼ˆæ‰¹é‡å£°æ˜ï¼‰</span>
<span class="hljs-keyword">const</span> (
    StatusOK = <span class="hljs-number">200</span>             <span class="hljs-comment">// HTTPçŠ¶æ€ç ï¼šæˆåŠŸ</span>
    StatusNotFound = <span class="hljs-number">404</span>       <span class="hljs-comment">// HTTPçŠ¶æ€ç ï¼šæœªæ‰¾åˆ°</span>
    StatusServerError = <span class="hljs-number">500</span>    <span class="hljs-comment">// HTTPçŠ¶æ€ç ï¼šæœåŠ¡å™¨é”™è¯¯</span>
)

<span class="hljs-comment">// iota æšä¸¾ç”Ÿæˆå™¨ï¼ˆä»0å¼€å§‹ï¼Œæ¯è¡Œè‡ªåŠ¨é€’å¢1ï¼‰</span>
<span class="hljs-comment">// iota æ˜¯ä»€ä¹ˆï¼Ÿ</span>
<span class="hljs-comment">// iota æ˜¯ Go è¯­è¨€ä¸­çš„é¢„å®šä¹‰æ ‡è¯†ç¬¦ï¼Œåªèƒ½åœ¨å¸¸é‡å£°æ˜ä¸­ä½¿ç”¨</span>
<span class="hljs-comment">// å®ƒåœ¨æ¯ä¸ª const å—ä¸­ä» 0 å¼€å§‹ï¼Œæ¯è¡Œè‡ªåŠ¨é€’å¢ 1</span>
<span class="hljs-comment">// å¸¸ç”¨äºå®šä¹‰æšä¸¾å€¼æˆ–ç”Ÿæˆåºåˆ—å¸¸é‡</span>

<span class="hljs-keyword">const</span> (
    Monday = <span class="hljs-literal">iota</span> + <span class="hljs-number">1</span>  <span class="hljs-comment">// iota=0, Monday=1ï¼ˆä»1å¼€å§‹ï¼‰</span>
    Tuesday            <span class="hljs-comment">// iota=1, Tuesday=2ï¼ˆè‡ªåŠ¨ç»§æ‰¿è¡¨è¾¾å¼ï¼‰</span>
    Wednesday          <span class="hljs-comment">// iota=2, Wednesday=3</span>
    Thursday           <span class="hljs-comment">// iota=3, Thursday=4</span>
    Friday             <span class="hljs-comment">// iota=4, Friday=5</span>
)

<span class="hljs-comment">// iota ä½è¿ç®—ç¤ºä¾‹ï¼ˆå¸¸ç”¨äºå®šä¹‰æ–‡ä»¶å¤§å°å•ä½ï¼‰</span>
<span class="hljs-keyword">const</span> (
    _ = <span class="hljs-literal">iota</span>           <span class="hljs-comment">// ä½¿ç”¨ä¸‹åˆ’çº¿è·³è¿‡0å€¼</span>
    KB = <span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-number">10</span> * <span class="hljs-literal">iota</span>)  <span class="hljs-comment">// 1å·¦ç§»10ä½ = 1024ï¼ˆ1KBï¼‰</span>
    MB                     <span class="hljs-comment">// 1å·¦ç§»20ä½ = 1,048,576ï¼ˆ1MBï¼‰</span>
    GB                     <span class="hljs-comment">// 1å·¦ç§»30ä½ = 1,073,741,824ï¼ˆ1GBï¼‰</span>
)

<span class="hljs-comment">// iota è¯¦ç»†ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> (
    <span class="hljs-comment">// ç¬¬ä¸€ä¸ªconstå—ï¼Œiotaä»0å¼€å§‹</span>
    Zero = <span class="hljs-literal">iota</span>    <span class="hljs-comment">// 0</span>
    One            <span class="hljs-comment">// 1</span>
    Two            <span class="hljs-comment">// 2</span>
)

<span class="hljs-keyword">const</span> (
    <span class="hljs-comment">// æ–°çš„constå—ï¼Œiotaé‡æ–°ä»0å¼€å§‹</span>
    Sunday = <span class="hljs-literal">iota</span>    <span class="hljs-comment">// 0</span>
    Monday2          <span class="hljs-comment">// 1</span>
    Tuesday2         <span class="hljs-comment">// 2</span>
)

<span class="hljs-comment">// iota åœ¨åŒä¸€è¡Œä¸­ä¼šé‡å¤ä½¿ç”¨ç›¸åŒçš„å€¼</span>
<span class="hljs-keyword">const</span> (
    A, B = <span class="hljs-literal">iota</span>, <span class="hljs-literal">iota</span> + <span class="hljs-number">1</span>  <span class="hljs-comment">// A=0, B=1ï¼ˆåŒä¸€è¡Œiotaç›¸åŒï¼‰</span>
    C, D                   <span class="hljs-comment">// C=1, D=2ï¼ˆiotaé€’å¢ï¼‰</span>
    E, F                   <span class="hljs-comment">// E=2, F=3</span>
)
</code></pre>
<h2 data-id="heading-4">äºŒã€make ä¸ new</h2>
<h3 data-id="heading-5">make - åˆ›å»ºå¹¶åˆå§‹åŒ–å¼•ç”¨ç±»å‹</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// make ç”¨äºåˆ›å»ºåˆ‡ç‰‡ã€æ˜ å°„ã€ç®¡é“ç­‰å¼•ç”¨ç±»å‹ï¼Œè¿”å›å·²åˆå§‹åŒ–çš„å€¼</span>

<span class="hljs-comment">// åˆ‡ç‰‡ï¼šmake([]T, length, capacity)</span>
s1 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">5</span>)      <span class="hljs-comment">// åˆ›å»ºé•¿åº¦ä¸º5ï¼Œå®¹é‡ä¸º5çš„intåˆ‡ç‰‡ï¼Œæ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ä¸º0</span>
s2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>)  <span class="hljs-comment">// é•¿åº¦3ï¼Œå®¹é‡10ï¼Œå®é™…åˆ†é…10ä¸ªå…ƒç´ çš„ç©ºé—´ï¼ˆå¯é¢„æ‰©å®¹ï¼‰</span>

<span class="hljs-comment">// æ˜ å°„ï¼šmake(map[K]V, initialCapacity)</span>
m1 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>)     <span class="hljs-comment">// åˆ›å»ºç©ºæ˜ å°„ï¼Œä½¿ç”¨é»˜è®¤å®¹é‡</span>
m2 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>) <span class="hljs-comment">// åˆ›å»ºåˆå§‹å®¹é‡ä¸º10çš„æ˜ å°„ï¼ˆä¼˜åŒ–æ€§èƒ½ï¼Œå‡å°‘æ‰©å®¹ï¼‰</span>

<span class="hljs-comment">// ç®¡é“ï¼šmake(chan T, bufferSize)</span>
ch1 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)          <span class="hljs-comment">// æ— ç¼“å†²ç®¡é“ï¼Œå‘é€ä¼šé˜»å¡ç›´åˆ°æœ‰æ¥æ”¶è€…</span>
ch2 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">3</span>)       <span class="hljs-comment">// ç¼“å†²å¤§å°ä¸º3ï¼Œå¯æš‚å­˜3ä¸ªå…ƒç´ è€Œä¸é˜»å¡</span>
</code></pre>
<h3 data-id="heading-6">new - åˆ†é…å†…å­˜å¹¶è¿”å›æŒ‡é’ˆ</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// new(T) åˆ†é…Tç±»å‹çš„å†…å­˜ï¼Œè¿”å›æŒ‡é’ˆ *Tï¼Œå€¼åˆå§‹åŒ–ä¸ºé›¶å€¼</span>
p := <span class="hljs-built_in">new</span>(<span class="hljs-type">int</span>)           <span class="hljs-comment">// pæ˜¯*intç±»å‹ï¼Œ*p = 0ï¼ˆintçš„é›¶å€¼ï¼‰</span>
*p = <span class="hljs-number">42</span>                 <span class="hljs-comment">// é€šè¿‡æŒ‡é’ˆä¿®æ”¹å€¼</span>

<span class="hljs-comment">// ç»“æ„ä½“</span>
<span class="hljs-keyword">type</span> Point <span class="hljs-keyword">struct</span> { X, Y <span class="hljs-type">int</span> }
pt := <span class="hljs-built_in">new</span>(Point)       <span class="hljs-comment">// ptæ˜¯*Pointç±»å‹ï¼ŒX:0, Y:0ï¼ˆç»“æ„ä½“é›¶å€¼ï¼‰</span>
pt.X = <span class="hljs-number">10</span>              <span class="hljs-comment">// é€šè¿‡æŒ‡é’ˆè®¿é—®ç»“æ„ä½“å­—æ®µï¼ˆè‡ªåŠ¨è§£å¼•ç”¨ï¼‰</span>
pt.Y = <span class="hljs-number">20</span>

<span class="hljs-comment">// æ³¨æ„ï¼šnewåªåˆ†é…å†…å­˜å¹¶è¿”å›æŒ‡é’ˆï¼Œmakeä¼šåˆå§‹åŒ–å¼•ç”¨ç±»å‹</span>
</code></pre>
<h3 data-id="heading-7">make vs new å¯¹æ¯”</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// make ç”¨äºå¼•ç”¨ç±»å‹ï¼ˆåˆ‡ç‰‡ã€æ˜ å°„ã€ç®¡é“ï¼‰ï¼Œè¿”å›å·²åˆå§‹åŒ–çš„å€¼</span>
slice := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">3</span>)  <span class="hljs-comment">// sliceæ˜¯[]intç±»å‹ï¼Œå€¼ä¸º[0 0 0]</span>

<span class="hljs-comment">// new ç”¨äºä»»ä½•ç±»å‹ï¼Œè¿”å›æŒ‡é’ˆï¼Œå¼•ç”¨ç±»å‹éœ€è¦å•ç‹¬åˆå§‹åŒ–</span>
ptr := <span class="hljs-built_in">new</span>([]<span class="hljs-type">int</span>)        <span class="hljs-comment">// ptræ˜¯*[]intç±»å‹ï¼Œ*ptræ˜¯nilåˆ‡ç‰‡</span>
*ptr = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">3</span>)    <span class="hljs-comment">// éœ€è¦æ˜¾å¼åˆå§‹åŒ–æ‰èƒ½ä½¿ç”¨</span>

<span class="hljs-comment">// æ¨èï¼šåˆ‡ç‰‡ã€æ˜ å°„ã€ç®¡é“ä½¿ç”¨makeï¼Œç»“æ„ä½“æŒ‡é’ˆä½¿ç”¨newæˆ–&amp;</span>
</code></pre>
<h2 data-id="heading-8">ä¸‰ã€åŸºæœ¬æ•°æ®ç»“æ„</h2>
<h3 data-id="heading-9">æ•°ç»„ï¼ˆå›ºå®šé•¿åº¦ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„å€¼ç±»å‹ï¼Œé•¿åº¦æ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ†</span>
<span class="hljs-keyword">var</span> arr1 [<span class="hljs-number">3</span>]<span class="hljs-type">int</span>               <span class="hljs-comment">// å£°æ˜é•¿åº¦ä¸º3çš„intæ•°ç»„ï¼Œåˆå§‹åŒ–ä¸º[0 0 0]</span>
arr2 := [<span class="hljs-number">3</span>]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>}       <span class="hljs-comment">// æ˜¾å¼åˆå§‹åŒ–ï¼Œé•¿åº¦ä¸º3</span>
arr3 := [...]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>}  <span class="hljs-comment">// ç¼–è¯‘å™¨è‡ªåŠ¨è®¡ç®—é•¿åº¦ï¼Œé•¿åº¦ä¸º4</span>
arr4 := [<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]<span class="hljs-type">int</span>{{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>}, {<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>}}  <span class="hljs-comment">// äºŒç»´æ•°ç»„</span>

<span class="hljs-comment">// æ•°ç»„æ“ä½œ</span>
arr2[<span class="hljs-number">0</span>] = <span class="hljs-number">10</span>                  <span class="hljs-comment">// ä¿®æ”¹å…ƒç´ </span>
fmt.Println(<span class="hljs-built_in">len</span>(arr2))        <span class="hljs-comment">// è·å–é•¿åº¦ï¼š3</span>
fmt.Println(arr2[<span class="hljs-number">1</span>])          <span class="hljs-comment">// è®¿é—®å…ƒç´ ï¼š2</span>

<span class="hljs-comment">// é‡è¦ï¼šå›ºå®šé•¿åº¦æ•°ç»„ä¸èƒ½æ–°å¢æˆ–åˆ é™¤å…ƒç´ </span>
<span class="hljs-comment">// æ•°ç»„é•¿åº¦åœ¨å£°æ˜æ—¶å°±ç¡®å®šäº†ï¼Œæ— æ³•åŠ¨æ€æ”¹å˜</span>
arr := [<span class="hljs-number">3</span>]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>}
<span class="hljs-comment">// arr = append(arr, 4)  // âŒ é”™è¯¯ï¼šæ•°ç»„ä¸æ”¯æŒappend</span>
<span class="hljs-comment">// å¦‚æœéœ€è¦åŠ¨æ€é•¿åº¦ï¼Œåº”è¯¥ä½¿ç”¨åˆ‡ç‰‡ï¼ˆsliceï¼‰</span>

<span class="hljs-comment">// æ£€æŸ¥æ•°ç»„æ˜¯å¦åŒ…å«æŸä¸ªå€¼ï¼ˆéœ€è¦æ‰‹åŠ¨éå†ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">contains</span><span class="hljs-params">(arr [3]<span class="hljs-type">int</span>, target <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">bool</span> {
    <span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> arr {
        <span class="hljs-keyword">if</span> v == target {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
}

arr := [<span class="hljs-number">3</span>]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>}
<span class="hljs-keyword">if</span> contains(arr, <span class="hljs-number">2</span>) {
    fmt.Println(<span class="hljs-string">"æ•°ç»„åŒ…å«2"</span>)
}

<span class="hljs-comment">// æˆ–è€…ä½¿ç”¨åˆ‡ç‰‡ï¼ˆæ›´çµæ´»ï¼‰</span>
slice := []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>}
<span class="hljs-comment">// åˆ‡ç‰‡å¯ä»¥ä½¿ç”¨æ ‡å‡†åº“çš„ slices.Containsï¼ˆGo 1.21+ï¼‰</span>
<span class="hljs-comment">// import "slices"</span>
<span class="hljs-comment">// if slices.Contains(slice, 2) {</span>
<span class="hljs-comment">//     fmt.Println("åˆ‡ç‰‡åŒ…å«2")</span>
<span class="hljs-comment">// }</span>
</code></pre>
<h3 data-id="heading-10">åˆ‡ç‰‡ï¼ˆåŠ¨æ€æ•°ç»„ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åˆ‡ç‰‡æ˜¯åŠ¨æ€æ•°ç»„ï¼Œæ˜¯å¯¹åº•å±‚æ•°ç»„çš„å¼•ç”¨</span>
slice1 := []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>}      <span class="hljs-comment">// å­—é¢é‡åˆ›å»ºåˆ‡ç‰‡</span>
slice2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">5</span>)      <span class="hljs-comment">// makeåˆ›å»ºï¼Œé•¿åº¦ä¸º5ï¼Œå®¹é‡5</span>
<span class="hljs-keyword">var</span> slice3 []<span class="hljs-type">int</span>             <span class="hljs-comment">// nilåˆ‡ç‰‡ï¼ˆé›¶å€¼ï¼‰</span>

<span class="hljs-comment">// åˆ‡ç‰‡æ“ä½œ</span>
slice1 = <span class="hljs-built_in">append</span>(slice1, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)  <span class="hljs-comment">// è¿½åŠ å…ƒç´ ï¼Œè¿”å›æ–°åˆ‡ç‰‡</span>
<span class="hljs-built_in">copy</span>(slice2, slice1)          <span class="hljs-comment">// å¤åˆ¶åˆ‡ç‰‡å…ƒç´ </span>
fmt.Println(<span class="hljs-built_in">len</span>(slice1))       <span class="hljs-comment">// é•¿åº¦ï¼š5</span>
fmt.Println(<span class="hljs-built_in">cap</span>(slice1))       <span class="hljs-comment">// å®¹é‡ï¼ˆå¯èƒ½å¤§äºé•¿åº¦ï¼‰</span>

<span class="hljs-comment">// åˆ‡ç‰‡è¡¨è¾¾å¼ï¼ˆä»æ•°ç»„æˆ–åˆ‡ç‰‡åˆ›å»ºæ–°åˆ‡ç‰‡ï¼‰</span>
arr := [<span class="hljs-number">5</span>]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>}
s1 := arr[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>]              <span class="hljs-comment">// [2,3,4]ï¼Œå·¦é—­å³å¼€åŒºé—´</span>
s2 := arr[:<span class="hljs-number">3</span>]               <span class="hljs-comment">// [1,2,3]ï¼Œä»å¼€å§‹åˆ°ç´¢å¼•3</span>
s3 := arr[<span class="hljs-number">2</span>:]               <span class="hljs-comment">// [3,4,5]ï¼Œä»ç´¢å¼•2åˆ°ç»“æŸ</span>
</code></pre>
<h3 data-id="heading-11">æ˜ å°„ï¼ˆå­—å…¸ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æ˜ å°„æ˜¯é”®å€¼å¯¹é›†åˆï¼Œå¼•ç”¨ç±»å‹</span>
m1 := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>{<span class="hljs-string">"a"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">2</span>}  <span class="hljs-comment">// å­—é¢é‡åˆ›å»º</span>
m2 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>)            <span class="hljs-comment">// makeåˆ›å»ºç©ºæ˜ å°„</span>
<span class="hljs-keyword">var</span> m3 <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>                 <span class="hljs-comment">// nilæ˜ å°„ï¼ˆä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼‰</span>

<span class="hljs-comment">// æ˜ å°„æ“ä½œ</span>
m1[<span class="hljs-string">"c"</span>] = <span class="hljs-number">3</span>                 <span class="hljs-comment">// æ·»åŠ /ä¿®æ”¹é”®å€¼å¯¹</span>
val := m1[<span class="hljs-string">"a"</span>]              <span class="hljs-comment">// è¯»å–å€¼ï¼š1</span>
<span class="hljs-built_in">delete</span>(m1, <span class="hljs-string">"b"</span>)             <span class="hljs-comment">// åˆ é™¤é”®å€¼å¯¹</span>

<span class="hljs-comment">// æ˜ å°„å–å€¼çš„ä¸¤ç§æ–¹å¼ï¼š</span>

<span class="hljs-comment">// æ–¹å¼1ï¼šåªæ¥æ”¶ä¸€ä¸ªå€¼ï¼ˆé»˜è®¤è¿”å›valueï¼Œå¦‚æœé”®ä¸å­˜åœ¨è¿”å›é›¶å€¼ï¼‰</span>
val := m1[<span class="hljs-string">"a"</span>]              <span class="hljs-comment">// val = 1ï¼ˆé”®å­˜åœ¨ï¼‰</span>
val2 := m1[<span class="hljs-string">"x"</span>]             <span class="hljs-comment">// val2 = 0ï¼ˆé”®ä¸å­˜åœ¨ï¼Œè¿”å›intçš„é›¶å€¼ï¼‰</span>
<span class="hljs-comment">// é—®é¢˜ï¼šæ— æ³•åŒºåˆ†æ˜¯é”®ä¸å­˜åœ¨è¿˜æ˜¯å€¼æœ¬èº«å°±æ˜¯0</span>

<span class="hljs-comment">// æ–¹å¼2ï¼šæ¥æ”¶ä¸¤ä¸ªå€¼ï¼ˆvalue å’Œ existsï¼‰</span>
value, exists := m1[<span class="hljs-string">"x"</span>]    <span class="hljs-comment">// existsä¸ºfalseï¼Œvalueä¸º0ï¼ˆinté›¶å€¼ï¼‰</span>
<span class="hljs-comment">// exists æ˜¯ bool ç±»å‹ï¼Œè¡¨ç¤ºé”®æ˜¯å¦å­˜åœ¨</span>
<span class="hljs-comment">// value æ˜¯å€¼ç±»å‹ï¼Œå¦‚æœé”®å­˜åœ¨è¿”å›å®é™…å€¼ï¼Œä¸å­˜åœ¨è¿”å›é›¶å€¼</span>

<span class="hljs-comment">// æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨ï¼ˆæ¨èä½¿ç”¨æ–¹å¼2ï¼‰</span>
<span class="hljs-keyword">if</span> val, ok := m1[<span class="hljs-string">"a"</span>]; ok {
    <span class="hljs-comment">// ok ä¸º true è¡¨ç¤ºé”®å­˜åœ¨</span>
    fmt.Println(<span class="hljs-string">"é”®å­˜åœ¨ï¼Œå€¼ä¸º:"</span>, val)  <span class="hljs-comment">// å®‰å…¨è®¿é—®</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ok ä¸º false è¡¨ç¤ºé”®ä¸å­˜åœ¨</span>
    fmt.Println(<span class="hljs-string">"é”®ä¸å­˜åœ¨"</span>)
}

<span class="hljs-comment">// åˆ¤æ–­å­—å…¸æ˜¯å¦åŒ…å«æŸä¸ªkeyçš„å®Œæ•´ç¤ºä¾‹</span>
m := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>{<span class="hljs-string">"apple"</span>: <span class="hljs-number">5</span>, <span class="hljs-string">"banana"</span>: <span class="hljs-number">3</span>}

<span class="hljs-comment">// æ–¹æ³•1ï¼šä½¿ç”¨ä¸¤ä¸ªè¿”å›å€¼</span>
<span class="hljs-keyword">if</span> value, exists := m[<span class="hljs-string">"apple"</span>]; exists {
    fmt.Printf(<span class="hljs-string">"é”®'apple'å­˜åœ¨ï¼Œå€¼ä¸º: %d\n"</span>, value)
} <span class="hljs-keyword">else</span> {
    fmt.Println(<span class="hljs-string">"é”®'apple'ä¸å­˜åœ¨"</span>)
}

<span class="hljs-comment">// æ–¹æ³•2ï¼šåªæ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼ˆå¿½ç•¥å€¼ï¼‰</span>
<span class="hljs-keyword">if</span> _, exists := m[<span class="hljs-string">"orange"</span>]; exists {
    fmt.Println(<span class="hljs-string">"é”®'orange'å­˜åœ¨"</span>)
} <span class="hljs-keyword">else</span> {
    fmt.Println(<span class="hljs-string">"é”®'orange'ä¸å­˜åœ¨"</span>)
}

<span class="hljs-comment">// æ–¹æ³•3ï¼šé€šè¿‡é›¶å€¼åˆ¤æ–­ï¼ˆä¸æ¨èï¼Œå› ä¸ºæ— æ³•åŒºåˆ†é›¶å€¼å’Œä¸å­˜åœ¨ï¼‰</span>
<span class="hljs-keyword">if</span> m[<span class="hljs-string">"grape"</span>] != <span class="hljs-number">0</span> {
    fmt.Println(<span class="hljs-string">"é”®'grape'å­˜åœ¨ä¸”å€¼ä¸ä¸º0"</span>)
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æ— æ³•ç¡®å®šæ˜¯é”®ä¸å­˜åœ¨è¿˜æ˜¯å€¼ä¸º0</span>
    fmt.Println(<span class="hljs-string">"é”®'grape'ä¸å­˜åœ¨æˆ–å€¼ä¸º0"</span>)
}
</code></pre>
<h3 data-id="heading-12">ç»“æ„ä½“</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ç»“æ„ä½“æ˜¯è‡ªå®šä¹‰å¤åˆç±»å‹ï¼Œå€¼ç±»å‹</span>
<span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> {
    Name <span class="hljs-type">string</span>              <span class="hljs-comment">// å­—æ®µåé¦–å­—æ¯å¤§å†™è¡¨ç¤ºå…¬å¼€</span>
    Age  <span class="hljs-type">int</span>
    Contact <span class="hljs-keyword">struct</span> {         <span class="hljs-comment">// åµŒå¥—ç»“æ„ä½“</span>
        Phone <span class="hljs-type">string</span>
        Email <span class="hljs-type">string</span>
    }
}

<span class="hljs-comment">// åˆ›å»ºç»“æ„ä½“å®ä¾‹</span>
p1 := Person{Name: <span class="hljs-string">"Alice"</span>, Age: <span class="hljs-number">25</span>}  <span class="hljs-comment">// å­—æ®µååˆå§‹åŒ–ï¼ˆæ¨èï¼‰</span>
p2 := Person{<span class="hljs-string">"Bob"</span>, <span class="hljs-number">30</span>}               <span class="hljs-comment">// é¡ºåºåˆå§‹åŒ–ï¼ˆéœ€æŒ‰å­—æ®µé¡ºåºï¼‰</span>
p3 := &amp;Person{Name: <span class="hljs-string">"Charlie"</span>}        <span class="hljs-comment">// åˆ›å»ºæŒ‡é’ˆï¼ŒæœªæŒ‡å®šå­—æ®µä¸ºé›¶å€¼</span>

<span class="hljs-comment">// åŒ¿åç»“æ„ä½“ï¼ˆä¸´æ—¶ä½¿ç”¨ï¼‰</span>
temp := <span class="hljs-keyword">struct</span> {
    X, Y <span class="hljs-type">int</span>
}{<span class="hljs-number">10</span>, <span class="hljs-number">20</span>}  <span class="hljs-comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–</span>
</code></pre>
<h2 data-id="heading-13">å››ã€æŒ‡é’ˆä¸æ–¹æ³•ï¼ˆé‡ç‚¹ï¼šå€¼æ˜¯å¦ä¼šå˜åŒ–ï¼‰</h2>
<h3 data-id="heading-14">æŒ‡é’ˆåŸºç¡€</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æŒ‡é’ˆå­˜å‚¨å˜é‡çš„å†…å­˜åœ°å€</span>
<span class="hljs-keyword">var</span> a <span class="hljs-type">int</span> = <span class="hljs-number">42</span>
<span class="hljs-keyword">var</span> p *<span class="hljs-type">int</span> = &amp;a          <span class="hljs-comment">// pæŒ‡å‘açš„åœ°å€ï¼ˆ&amp;å–åœ°å€æ“ä½œç¬¦ï¼‰</span>
fmt.Println(*p)          <span class="hljs-comment">// é€šè¿‡æŒ‡é’ˆè®¿é—®å€¼ï¼š42ï¼ˆ*è§£å¼•ç”¨æ“ä½œç¬¦ï¼‰</span>
*p = <span class="hljs-number">100</span>                 <span class="hljs-comment">// é€šè¿‡æŒ‡é’ˆä¿®æ”¹açš„å€¼</span>
fmt.Println(a)           <span class="hljs-comment">// aå˜ä¸º100</span>

<span class="hljs-comment">// ç»“æ„ä½“æŒ‡é’ˆ</span>
<span class="hljs-keyword">type</span> Circle <span class="hljs-keyword">struct</span> { Radius <span class="hljs-type">float64</span> }
c := &amp;Circle{Radius: <span class="hljs-number">5</span>}  <span class="hljs-comment">// åˆ›å»ºç»“æ„ä½“æŒ‡é’ˆ</span>
c.Radius = <span class="hljs-number">10</span>            <span class="hljs-comment">// è‡ªåŠ¨è§£å¼•ç”¨ï¼ˆGoè¯­æ³•ç³–ï¼‰</span>
(*c).Radius = <span class="hljs-number">15</span>         <span class="hljs-comment">// æ˜¾å¼è§£å¼•ç”¨ï¼ˆæ•ˆæœç›¸åŒï¼‰</span>
</code></pre>
<h3 data-id="heading-15">å€¼æ¥æ”¶è€… vs æŒ‡é’ˆæ¥æ”¶è€…ï¼ˆå…³é”®åŒºåˆ«ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> Counter <span class="hljs-keyword">struct</span> {
    count <span class="hljs-type">int</span>
}

<span class="hljs-comment">// å€¼æ¥æ”¶è€…æ–¹æ³• - æ¥æ”¶ç»“æ„ä½“çš„å‰¯æœ¬ï¼Œä¸ä¿®æ”¹åŸå¯¹è±¡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c Counter)</span></span> IncrementByValue() {
    c.count++  <span class="hljs-comment">// ä¿®æ”¹çš„æ˜¯å‰¯æœ¬ï¼Œä¸å½±å“åŸå¯¹è±¡</span>
    fmt.Printf(<span class="hljs-string">"IncrementByValueå†…éƒ¨: count = %d\n"</span>, c.count)
    <span class="hljs-comment">// æ³¨æ„ï¼šæ–¹æ³•å†…çš„ä¿®æ”¹ä¸ä¼šå½±å“å¤–éƒ¨</span>
}

<span class="hljs-comment">// æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³• - æ¥æ”¶ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œå¯ä¿®æ”¹åŸå¯¹è±¡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *Counter)</span></span> IncrementByPointer() {
    c.count++  <span class="hljs-comment">// é€šè¿‡æŒ‡é’ˆä¿®æ”¹åŸå¯¹è±¡</span>
    fmt.Printf(<span class="hljs-string">"IncrementByPointerå†…éƒ¨: count = %d\n"</span>, c.count)
    <span class="hljs-comment">// æ³¨æ„ï¼šæ–¹æ³•å†…çš„ä¿®æ”¹ä¼šå½±å“å¤–éƒ¨</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    counter := Counter{count: <span class="hljs-number">0</span>}
    
    fmt.Printf(<span class="hljs-string">"åˆå§‹å€¼: count = %d\n"</span>, counter.count)  <span class="hljs-comment">// è¾“å‡ºï¼š0</span>
    
    <span class="hljs-comment">// æµ‹è¯•å€¼æ¥æ”¶è€…æ–¹æ³•</span>
    counter.IncrementByValue()  <span class="hljs-comment">// å†…éƒ¨è¾“å‡ºï¼šcount = 1</span>
    fmt.Printf(<span class="hljs-string">"å€¼æ¥æ”¶è€…è°ƒç”¨å: count = %d\n"</span>, counter.count)  
    <span class="hljs-comment">// è¾“å‡ºï¼š0ï¼ˆæœªæ”¹å˜ï¼åŸå¯¹è±¡æœªè¢«ä¿®æ”¹ï¼‰</span>
    
    <span class="hljs-comment">// æµ‹è¯•æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•  </span>
    counter.IncrementByPointer()  <span class="hljs-comment">// å†…éƒ¨è¾“å‡ºï¼šcount = 1</span>
    fmt.Printf(<span class="hljs-string">"æŒ‡é’ˆæ¥æ”¶è€…è°ƒç”¨å: count = %d\n"</span>, counter.count)  
    <span class="hljs-comment">// è¾“å‡ºï¼š1ï¼ˆå·²æ”¹å˜ï¼åŸå¯¹è±¡è¢«ä¿®æ”¹ï¼‰</span>
    
    <span class="hljs-comment">// ç»“è®ºï¼š</span>
    <span class="hljs-comment">// 1. å€¼æ¥æ”¶è€…æ–¹æ³•ï¼šå†…éƒ¨ä¿®æ”¹ä¸å½±å“å¤–éƒ¨ï¼ˆæ“ä½œçš„æ˜¯å‰¯æœ¬ï¼‰</span>
    <span class="hljs-comment">// 2. æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•ï¼šå†…éƒ¨ä¿®æ”¹å½±å“å¤–éƒ¨ï¼ˆæ“ä½œçš„æ˜¯åŸå¯¹è±¡ï¼‰</span>
}
</code></pre>
<h3 data-id="heading-16">è‡ªåŠ¨è½¬æ¢æœºåˆ¶</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> Circle <span class="hljs-keyword">struct</span> {
    Radius <span class="hljs-type">float64</span>
}

<span class="hljs-comment">// å€¼æ¥æ”¶è€…æ–¹æ³•ï¼ˆåªè¯»ï¼Œä¸ä¿®æ”¹ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c Circle)</span></span> Area() <span class="hljs-type">float64</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-number">3.14</span> * c.Radius * c.Radius
}

<span class="hljs-comment">// æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•ï¼ˆå¯ä¿®æ”¹ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *Circle)</span></span> Scale(factor <span class="hljs-type">float64</span>) {
    c.Radius *= factor
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// æƒ…å†µ1ï¼šå€¼ç±»å‹å˜é‡è°ƒç”¨æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•</span>
    c1 := Circle{Radius: <span class="hljs-number">5</span>}
    c1.Scale(<span class="hljs-number">2</span>)  <span class="hljs-comment">// Goè‡ªåŠ¨è½¬æ¢ä¸º: (&amp;c1).Scale(2)</span>
    fmt.Printf(<span class="hljs-string">"c1åŠå¾„: %.2f\n"</span>, c1.Radius)  <span class="hljs-comment">// è¾“å‡ºï¼š10.00ï¼ˆåŸå¯¹è±¡è¢«ä¿®æ”¹ï¼‰</span>
    
    <span class="hljs-comment">// æƒ…å†µ2ï¼šæŒ‡é’ˆç±»å‹å˜é‡è°ƒç”¨å€¼æ¥æ”¶è€…æ–¹æ³•</span>
    c2 := &amp;Circle{Radius: <span class="hljs-number">5</span>}
    area := c2.Area()  <span class="hljs-comment">// Goè‡ªåŠ¨è½¬æ¢ä¸º: (*c2).Area()</span>
    fmt.Printf(<span class="hljs-string">"c2é¢ç§¯: %.2f\n"</span>, area)  <span class="hljs-comment">// è¾“å‡ºï¼š78.50ï¼ˆè®¡ç®—ç»“æœï¼ŒåŸå¯¹è±¡æœªä¿®æ”¹ï¼‰</span>
    
    <span class="hljs-comment">// Goçš„ä¾¿åˆ©æ€§ï¼šæ— è®ºå€¼ç±»å‹è¿˜æ˜¯æŒ‡é’ˆç±»å‹ï¼Œéƒ½å¯ä»¥è°ƒç”¨ä¸¤ç§æ–¹æ³•</span>
    <span class="hljs-comment">// ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç† &amp; å’Œ * çš„è½¬æ¢</span>
}
</code></pre>
<h3 data-id="heading-17">æ–¹æ³•æ¥æ”¶è€…é€‰æ‹©åŸåˆ™</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// å€¼æ¥æ”¶è€…é€‚ç”¨åœºæ™¯ï¼š</span>
<span class="hljs-comment">// 1. æ–¹æ³•ä¸éœ€è¦ä¿®æ”¹æ¥æ”¶è€…</span>
<span class="hljs-comment">// 2. æ¥æ”¶è€…æ˜¯å°å‹ç»“æ„ä½“ï¼ˆé¿å…å¤åˆ¶å¼€é”€ï¼‰</span>
<span class="hljs-comment">// 3. éœ€è¦ä¸å¯å˜æ€§</span>

<span class="hljs-comment">// æŒ‡é’ˆæ¥æ”¶è€…é€‚ç”¨åœºæ™¯ï¼š</span>
<span class="hljs-comment">// 1. æ–¹æ³•éœ€è¦ä¿®æ”¹æ¥æ”¶è€…</span>
<span class="hljs-comment">// 2. æ¥æ”¶è€…æ˜¯å¤§å‹ç»“æ„ä½“ï¼ˆé¿å…å¤åˆ¶å¼€é”€ï¼‰</span>
<span class="hljs-comment">// 3. ä¿è¯ä¸€è‡´æ€§ï¼ˆå¦‚ç¼“å­˜ã€è¿æ¥ç­‰ï¼‰</span>
<span class="hljs-comment">// 4. å®ç°æŸäº›æ¥å£æ—¶</span>

<span class="hljs-comment">// ä¸€è‡´æ€§åŸåˆ™ï¼šåŒä¸€ç±»å‹çš„å¤šä¸ªæ–¹æ³•åº”è¯¥ä½¿ç”¨ç›¸åŒç±»å‹çš„æ¥æ”¶è€…</span>
</code></pre>
<h2 data-id="heading-18">äº”ã€æ§åˆ¶æµ</h2>
<h3 data-id="heading-19">if - æ¡ä»¶åˆ¤æ–­</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŸºç¡€ifè¯­å¥</span>
<span class="hljs-keyword">if</span> age &gt;= <span class="hljs-number">18</span> {
    fmt.Println(<span class="hljs-string">"æˆå¹´äºº"</span>)
}

<span class="hljs-comment">// if-elseé“¾</span>
<span class="hljs-keyword">if</span> score &gt;= <span class="hljs-number">90</span> {
    fmt.Println(<span class="hljs-string">"ä¼˜ç§€"</span>)
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> score &gt;= <span class="hljs-number">80</span> {
    fmt.Println(<span class="hljs-string">"è‰¯å¥½"</span>)  
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> score &gt;= <span class="hljs-number">60</span> {
    fmt.Println(<span class="hljs-string">"åŠæ ¼"</span>)
} <span class="hljs-keyword">else</span> {
    fmt.Println(<span class="hljs-string">"ä¸åŠæ ¼"</span>)
}

<span class="hljs-comment">// ifå¸¦åˆå§‹åŒ–è¯­å¥ï¼ˆå˜é‡ä½œç”¨åŸŸä»…åœ¨ifå—å†…ï¼‰</span>
<span class="hljs-comment">// è¯­æ³•ï¼šif åˆå§‹åŒ–è¯­å¥; æ¡ä»¶è¡¨è¾¾å¼ { ... }</span>
<span class="hljs-keyword">if</span> err := process(); err != <span class="hljs-literal">nil</span> {
    fmt.Printf(<span class="hljs-string">"å¤„ç†å‡ºé”™: %v\n"</span>, err)
}
<span class="hljs-comment">// erråœ¨è¿™é‡Œä¸å¯è®¿é—®ï¼ˆä½œç”¨åŸŸä»…åœ¨ifå—å†…ï¼‰</span>

<span class="hljs-comment">// åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºnil</span>
<span class="hljs-keyword">if</span> data != <span class="hljs-literal">nil</span> {
    fmt.Println(<span class="hljs-string">"æ•°æ®æœ‰æ•ˆ"</span>)
}

<span class="hljs-comment">// if è¯­å¥çš„è¯¦ç»†è¯­æ³•è¯´æ˜</span>
<span class="hljs-comment">// 1. åŸºç¡€è¯­æ³•ï¼šif æ¡ä»¶è¡¨è¾¾å¼ { ... }</span>
<span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> {
    fmt.Println(<span class="hljs-string">"xæ˜¯æ­£æ•°"</span>)
}

<span class="hljs-comment">// 2. if-else è¯­æ³•</span>
<span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> {
    fmt.Println(<span class="hljs-string">"æ­£æ•°"</span>)
} <span class="hljs-keyword">else</span> {
    fmt.Println(<span class="hljs-string">"éæ­£æ•°"</span>)
}

<span class="hljs-comment">// 3. if-else if-else é“¾</span>
<span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> {
    fmt.Println(<span class="hljs-string">"æ­£æ•°"</span>)
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span> {
    fmt.Println(<span class="hljs-string">"è´Ÿæ•°"</span>)
} <span class="hljs-keyword">else</span> {
    fmt.Println(<span class="hljs-string">"é›¶"</span>)
}

<span class="hljs-comment">// 4. if å¸¦åˆå§‹åŒ–è¯­å¥ï¼ˆé‡è¦è¯­æ³•ï¼‰</span>
<span class="hljs-comment">// æ ¼å¼ï¼šif åˆå§‹åŒ–è¯­å¥; æ¡ä»¶è¡¨è¾¾å¼ { ... }</span>
<span class="hljs-comment">// åˆå§‹åŒ–è¯­å¥å¯ä»¥æ˜¯å˜é‡å£°æ˜ã€èµ‹å€¼ã€å‡½æ•°è°ƒç”¨ç­‰</span>
<span class="hljs-comment">// å˜é‡ä½œç”¨åŸŸä»…åœ¨ if-else å—å†…</span>

<span class="hljs-comment">// ç¤ºä¾‹1ï¼šå£°æ˜å¹¶åˆ¤æ–­</span>
<span class="hljs-keyword">if</span> val, ok := m1[<span class="hljs-string">"a"</span>]; ok {
    <span class="hljs-comment">// è¿™é‡Œ val å’Œ ok éƒ½å¯ä»¥ä½¿ç”¨</span>
    fmt.Println(<span class="hljs-string">"é”®å­˜åœ¨ï¼Œå€¼ä¸º:"</span>, val)
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// è¿™é‡Œ val å’Œ ok ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼ˆelseå—å†…ï¼‰</span>
    fmt.Println(<span class="hljs-string">"é”®ä¸å­˜åœ¨"</span>)
}
<span class="hljs-comment">// val å’Œ ok åœ¨è¿™é‡Œä¸å¯è®¿é—®ï¼ˆè¶…å‡ºä½œç”¨åŸŸï¼‰</span>

<span class="hljs-comment">// ç¤ºä¾‹2ï¼šå‡½æ•°è°ƒç”¨å¹¶åˆ¤æ–­é”™è¯¯</span>
<span class="hljs-keyword">if</span> err := process(); err != <span class="hljs-literal">nil</span> {
    fmt.Printf(<span class="hljs-string">"å¤„ç†å‡ºé”™: %v\n"</span>, err)
    <span class="hljs-keyword">return</span>  <span class="hljs-comment">// æ—©æœŸè¿”å›</span>
}
<span class="hljs-comment">// err åœ¨è¿™é‡Œä¸å¯è®¿é—®</span>

<span class="hljs-comment">// ç¤ºä¾‹3ï¼šå¤šä¸ªåˆå§‹åŒ–è¯­å¥ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</span>
<span class="hljs-keyword">if</span> x, y := <span class="hljs-number">1</span>, <span class="hljs-number">2</span>; x &lt; y {
    fmt.Println(<span class="hljs-string">"xå°äºy"</span>)
}

<span class="hljs-comment">// 5. åµŒå¥—ifè¯­å¥</span>
<span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> {
    <span class="hljs-keyword">if</span> y &gt; <span class="hljs-number">0</span> {
        fmt.Println(<span class="hljs-string">"xå’Œyéƒ½æ˜¯æ­£æ•°"</span>)
    }
}

<span class="hljs-comment">// 6. é€»è¾‘è¿ç®—ç¬¦ç»„åˆæ¡ä»¶</span>
<span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> &amp;&amp; y &gt; <span class="hljs-number">0</span> {
    fmt.Println(<span class="hljs-string">"xå’Œyéƒ½æ˜¯æ­£æ•°"</span>)
}

<span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> || y &gt; <span class="hljs-number">0</span> {
    fmt.Println(<span class="hljs-string">"xæˆ–yè‡³å°‘ä¸€ä¸ªæ˜¯æ­£æ•°"</span>)
}

<span class="hljs-comment">// 7. ç±»å‹æ–­è¨€ï¼ˆç»“åˆifä½¿ç”¨ï¼‰</span>
<span class="hljs-keyword">var</span> val <span class="hljs-keyword">interface</span>{} = <span class="hljs-string">"hello"</span>
<span class="hljs-keyword">if</span> str, ok := val.(<span class="hljs-type">string</span>); ok {
    fmt.Println(<span class="hljs-string">"æ˜¯å­—ç¬¦ä¸²:"</span>, str)
}
</code></pre>
<h3 data-id="heading-20">switch - å¤šåˆ†æ”¯é€‰æ‹©</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŸºç¡€switchï¼ˆåŒ¹é…å€¼ï¼‰</span>
<span class="hljs-keyword">switch</span> day {
<span class="hljs-keyword">case</span> <span class="hljs-string">"Monday"</span>, <span class="hljs-string">"Tuesday"</span>, <span class="hljs-string">"Wednesday"</span>, <span class="hljs-string">"Thursday"</span>, <span class="hljs-string">"Friday"</span>:
    fmt.Println(<span class="hljs-string">"å·¥ä½œæ—¥"</span>)
<span class="hljs-keyword">case</span> <span class="hljs-string">"Saturday"</span>, <span class="hljs-string">"Sunday"</span>:
    fmt.Println(<span class="hljs-string">"å‘¨æœ«"</span>)
<span class="hljs-keyword">default</span>:
    fmt.Println(<span class="hljs-string">"æ— æ•ˆæ—¥æœŸ"</span>)
}

<span class="hljs-comment">// switchæ— è¡¨è¾¾å¼ï¼ˆç›¸å½“äºif-elseé“¾ï¼Œæ›´æ¸…æ™°ï¼‰</span>
<span class="hljs-keyword">switch</span> {
<span class="hljs-keyword">case</span> score &gt;= <span class="hljs-number">90</span>:
    fmt.Println(<span class="hljs-string">"A"</span>)
<span class="hljs-keyword">case</span> score &gt;= <span class="hljs-number">80</span>:
    fmt.Println(<span class="hljs-string">"B"</span>)
<span class="hljs-keyword">case</span> score &gt;= <span class="hljs-number">70</span>:
    fmt.Println(<span class="hljs-string">"C"</span>)
<span class="hljs-keyword">default</span>:
    fmt.Println(<span class="hljs-string">"D"</span>)
}

<span class="hljs-comment">// fallthroughå…³é”®å­—ï¼ˆç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªcaseï¼Œä¸æ¨èä½¿ç”¨ï¼‰</span>
<span class="hljs-keyword">switch</span> num {
<span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
    fmt.Println(<span class="hljs-string">"1"</span>)
    <span class="hljs-keyword">fallthrough</span>  <span class="hljs-comment">// ç»§ç»­æ‰§è¡Œcase 2ï¼ˆä¸æ£€æŸ¥æ¡ä»¶ï¼‰</span>
<span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
    fmt.Println(<span class="hljs-string">"2"</span>)  <span class="hljs-comment">// å³ä½¿num=1ä¹Ÿä¼šæ‰§è¡Œè¿™é‡Œ</span>
<span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
    fmt.Println(<span class="hljs-string">"3"</span>)
}
</code></pre>
<h3 data-id="heading-21">for - å¾ªç¯</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ä¼ ç»Ÿforå¾ªç¯</span>
<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ {
    fmt.Println(i)
}

<span class="hljs-comment">// whileé£æ ¼ï¼ˆGoæ²¡æœ‰whileå…³é”®å­—ï¼Œç”¨forä»£æ›¿ï¼‰</span>
count := <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> count &lt; <span class="hljs-number">5</span> {
    fmt.Println(count)
    count++
}

<span class="hljs-comment">// æ— é™å¾ªç¯ï¼ˆå¿…é¡»æœ‰breakæˆ–returné€€å‡ºï¼‰</span>
<span class="hljs-keyword">for</span> {
    <span class="hljs-keyword">if</span> condition {
        <span class="hljs-keyword">break</span>  <span class="hljs-comment">// è·³å‡ºå¾ªç¯</span>
    }
}

<span class="hljs-comment">// rangeéå†ï¼ˆæ•°ç»„ã€åˆ‡ç‰‡ã€å­—ç¬¦ä¸²ã€æ˜ å°„ã€ç®¡é“ï¼‰</span>
<span class="hljs-keyword">for</span> index, value := <span class="hljs-keyword">range</span> []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>} {
    fmt.Printf(<span class="hljs-string">"ç´¢å¼•: %d, å€¼: %d\n"</span>, index, value)
}

<span class="hljs-comment">// å¿½ç•¥ç´¢å¼•æˆ–å€¼ï¼ˆä½¿ç”¨ä¸‹åˆ’çº¿ï¼‰</span>
<span class="hljs-keyword">for</span> _, value := <span class="hljs-keyword">range</span> slice {  <span class="hljs-comment">// å¿½ç•¥ç´¢å¼•</span>
    fmt.Println(value)
}

<span class="hljs-keyword">for</span> key := <span class="hljs-keyword">range</span> <span class="hljs-keyword">map</span> {          <span class="hljs-comment">// å¿½ç•¥å€¼</span>
    fmt.Println(key)
}
</code></pre>
<h3 data-id="heading-22">break å’Œ continue</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// break - è·³å‡ºå¾ªç¯</span>
<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ {
    <span class="hljs-keyword">if</span> i == <span class="hljs-number">5</span> {
        <span class="hljs-keyword">break</span>  <span class="hljs-comment">// å½“i=5æ—¶è·³å‡ºå¾ªç¯</span>
    }
    fmt.Println(i)  <span class="hljs-comment">// åªæ‰“å°0-4</span>
}

<span class="hljs-comment">// å¸¦æ ‡ç­¾çš„breakï¼ˆè·³å‡ºå¤šå±‚å¾ªç¯ï¼‰</span>
outer:
<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++ {
    <span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++ {
        <span class="hljs-keyword">if</span> i == <span class="hljs-number">1</span> &amp;&amp; j == <span class="hljs-number">1</span> {
            <span class="hljs-keyword">break</span> outer  <span class="hljs-comment">// ç›´æ¥è·³å‡ºå¤–å±‚å¾ªç¯</span>
        }
        fmt.Printf(<span class="hljs-string">"(%d,%d) "</span>, i, j)
    }
}

<span class="hljs-comment">// continue - è·³è¿‡å½“å‰è¿­ä»£</span>
<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ {
    <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span> == <span class="hljs-number">0</span> {
        <span class="hljs-keyword">continue</span>  <span class="hljs-comment">// è·³è¿‡å¶æ•°</span>
    }
    fmt.Println(i)  <span class="hljs-comment">// åªæ‰“å°å¥‡æ•°ï¼š1,3,5,7,9</span>
}
</code></pre>
<h2 data-id="heading-23">å…­ã€å‡½æ•°</h2>
<h3 data-id="heading-24">å‡½æ•°å®šä¹‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŸºæœ¬å‡½æ•°å®šä¹‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">add</span><span class="hljs-params">(a <span class="hljs-type">int</span>, b <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> {
    <span class="hljs-keyword">return</span> a + b
}

<span class="hljs-comment">// å‚æ•°ç±»å‹ç®€å†™ï¼ˆç›¸åŒç±»å‹å¯åˆå¹¶ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">multiply</span><span class="hljs-params">(x, y <span class="hljs-type">float64</span>)</span></span> <span class="hljs-type">float64</span> {
    <span class="hljs-keyword">return</span> x * y
}

<span class="hljs-comment">// å¤šè¿”å›å€¼ï¼ˆGoçš„ç‰¹è‰²ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">divide</span><span class="hljs-params">(a, b <span class="hljs-type">float64</span>)</span></span> (<span class="hljs-type">float64</span>, <span class="hljs-type">error</span>) {
    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, fmt.Errorf(<span class="hljs-string">"é™¤é›¶é”™è¯¯"</span>)  <span class="hljs-comment">// è¿”å›é”™è¯¯</span>
    }
    <span class="hljs-keyword">return</span> a / b, <span class="hljs-literal">nil</span>  <span class="hljs-comment">// è¿”å›ç»“æœå’Œnilï¼ˆæ— é”™è¯¯ï¼‰</span>
}

<span class="hljs-comment">// å‘½åè¿”å›å€¼ï¼ˆå¯ç›´æ¥ä¸ºè¿”å›å€¼èµ‹å€¼ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getCoordinates</span><span class="hljs-params">()</span></span> (x <span class="hljs-type">int</span>, y <span class="hljs-type">int</span>) {
    x = <span class="hljs-number">10</span>  <span class="hljs-comment">// ç›´æ¥ä¸ºè¿”å›å€¼èµ‹å€¼</span>
    y = <span class="hljs-number">20</span>
    <span class="hljs-keyword">return</span>  <span class="hljs-comment">// è‡ªåŠ¨è¿”å› x, yï¼ˆè£¸è¿”å›ï¼‰</span>
}

<span class="hljs-comment">// å¯å˜å‚æ•°å‡½æ•°ï¼ˆå‚æ•°æ•°é‡å¯å˜ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sum</span><span class="hljs-params">(numbers ...<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> {
    total := <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> _, n := <span class="hljs-keyword">range</span> numbers {
        total += n
    }
    <span class="hljs-keyword">return</span> total
}
<span class="hljs-comment">// è°ƒç”¨ï¼šsum(1, 2, 3) æˆ– sum(1, 2, 3, 4, 5)</span>
</code></pre>
<h3 data-id="heading-25">defer - å»¶è¿Ÿæ‰§è¡Œ</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// defer å°†å‡½æ•°è°ƒç”¨æ¨è¿Ÿåˆ°å¤–å±‚å‡½æ•°è¿”å›æ—¶æ‰§è¡Œ</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">readFile</span><span class="hljs-params">(filename <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">error</span> {
    file, err := os.Open(filename)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> err
    }
    <span class="hljs-keyword">defer</span> file.Close()  <span class="hljs-comment">// ç¡®ä¿å‡½æ•°è¿”å›å‰å…³é—­æ–‡ä»¶ï¼ˆæ— è®ºæ˜¯å¦å‡ºé”™ï¼‰</span>
    
    <span class="hljs-comment">// å¤„ç†æ–‡ä»¶å†…å®¹...</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// å¤šä¸ªdeferæŒ‰åè¿›å…ˆå‡º(LIFO)é¡ºåºæ‰§è¡Œ</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">"ç¬¬ä¸€ä¸ªdefer"</span>)
    <span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">"ç¬¬äºŒä¸ªdefer"</span>)
    <span class="hljs-keyword">defer</span> fmt.Println(<span class="hljs-string">"ç¬¬ä¸‰ä¸ªdefer"</span>)
    fmt.Println(<span class="hljs-string">"å‡½æ•°ä½“"</span>)
}
<span class="hljs-comment">// è¾“å‡ºé¡ºåºï¼šå‡½æ•°ä½“ â†’ ç¬¬ä¸‰ä¸ªdefer â†’ ç¬¬äºŒä¸ªdefer â†’ ç¬¬ä¸€ä¸ªdefer</span>
</code></pre>
<h3 data-id="heading-26">panic å’Œ recover</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// panic ä½¿ç¨‹åºå´©æºƒï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯å¹¶ç»ˆæ­¢</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">divide</span><span class="hljs-params">(a, b <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> {
    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span> {
        <span class="hljs-built_in">panic</span>(<span class="hljs-string">"é™¤æ•°ä¸èƒ½ä¸ºé›¶"</span>)  <span class="hljs-comment">// å¼•å‘panicï¼Œç¨‹åºç»ˆæ­¢</span>
    }
    <span class="hljs-keyword">return</span> a / b
}

<span class="hljs-comment">// recover æ•è·panicï¼Œåªèƒ½åœ¨deferå‡½æ•°ä¸­è°ƒç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">safeDivide</span><span class="hljs-params">(a, b <span class="hljs-type">int</span>)</span></span> (result <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>) {
    <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> r := <span class="hljs-built_in">recover</span>(); r != <span class="hljs-literal">nil</span> {  <span class="hljs-comment">// æ•è·panic</span>
            err = fmt.Errorf(<span class="hljs-string">"å‘ç”Ÿé”™è¯¯: %v"</span>, r)
            result = <span class="hljs-number">0</span>
        }
    }()
    
    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span> {
        <span class="hljs-built_in">panic</span>(<span class="hljs-string">"é™¤é›¶é”™è¯¯"</span>)  <span class="hljs-comment">// è§¦å‘panic</span>
    }
    <span class="hljs-keyword">return</span> a / b, <span class="hljs-literal">nil</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    result, err := safeDivide(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        fmt.Println(<span class="hljs-string">"é”™è¯¯:"</span>, err)  <span class="hljs-comment">// è¾“å‡ºï¼šé”™è¯¯: å‘ç”Ÿé”™è¯¯: é™¤é›¶é”™è¯¯</span>
    } <span class="hljs-keyword">else</span> {
        fmt.Println(<span class="hljs-string">"ç»“æœ:"</span>, result)
    }
}
</code></pre>
<h2 data-id="heading-27">ä¸ƒã€æ¥å£</h2>
<h3 data-id="heading-28">æ¥å£å®šä¹‰ä¸å®ç°</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æ¥å£å®šä¹‰ä¸€ç»„æ–¹æ³•ç­¾å</span>
<span class="hljs-keyword">type</span> Shape <span class="hljs-keyword">interface</span> {
    Area() <span class="hljs-type">float64</span>
    Perimeter() <span class="hljs-type">float64</span>
}

<span class="hljs-comment">// å®ç°æ¥å£ï¼ˆåªè¦å®ç°äº†æ‰€æœ‰æ–¹æ³•ï¼Œå°±è‡ªåŠ¨å®ç°äº†æ¥å£ï¼‰</span>
<span class="hljs-keyword">type</span> Rectangle <span class="hljs-keyword">struct</span> {
    Width, Height <span class="hljs-type">float64</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(r Rectangle)</span></span> Area() <span class="hljs-type">float64</span> {
    <span class="hljs-keyword">return</span> r.Width * r.Height
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(r Rectangle)</span></span> Perimeter() <span class="hljs-type">float64</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * (r.Width + r.Height)
}

<span class="hljs-comment">// ä½¿ç”¨æ¥å£</span>
<span class="hljs-keyword">var</span> s Shape = Rectangle{Width: <span class="hljs-number">3</span>, Height: <span class="hljs-number">4</span>}
area := s.Area()  <span class="hljs-comment">// 12</span>
</code></pre>
<h3 data-id="heading-29">interface{} vs anyï¼ˆGo 1.18+ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// any æ˜¯ interface{} çš„ç±»å‹åˆ«åï¼ˆGo 1.18å¼•å…¥ï¼‰</span>
<span class="hljs-comment">// ä¸¤è€…å®Œå…¨ç­‰ä»·ï¼Œå¯ä»¥äº’æ¢ä½¿ç”¨</span>

<span class="hljs-comment">// ä½¿ç”¨ interface{} ï¼ˆä¼ ç»Ÿå†™æ³•ï¼Œå…¼å®¹æ—§ä»£ç ï¼‰</span>
<span class="hljs-keyword">var</span> v1 <span class="hljs-keyword">interface</span>{} = <span class="hljs-number">42</span>
<span class="hljs-keyword">var</span> v2 <span class="hljs-keyword">interface</span>{} = <span class="hljs-string">"hello"</span>

<span class="hljs-comment">// ä½¿ç”¨ any ï¼ˆæ¨èï¼Œæ›´ç®€æ´ï¼‰</span>
<span class="hljs-keyword">var</span> v3 any = <span class="hljs-number">42</span>
<span class="hljs-keyword">var</span> v4 any = <span class="hljs-string">"hello"</span>

<span class="hljs-comment">// ä¸¤è€…å¯ä»¥äº’ç›¸èµ‹å€¼</span>
v1 = v3  <span class="hljs-comment">// âœ… å®Œå…¨å…¼å®¹</span>
v3 = v1  <span class="hljs-comment">// âœ… å®Œå…¨å…¼å®¹</span>

<span class="hljs-comment">// å‡½æ•°å‚æ•°ä¸­ä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">PrintValue</span><span class="hljs-params">(v <span class="hljs-keyword">interface</span>{})</span></span> {
    fmt.Println(v)
}

<span class="hljs-comment">// ç­‰ä»·äºï¼ˆæ¨èä½¿ç”¨anyï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">PrintValueAny</span><span class="hljs-params">(v any)</span></span> {
    fmt.Println(v)
}

<span class="hljs-comment">// ä½•æ—¶ä½¿ç”¨ interface{} vs anyï¼š</span>
<span class="hljs-comment">// 1. æ–°ä»£ç ä¸­ä¼˜å…ˆä½¿ç”¨ anyï¼Œæ›´ç®€æ´æ˜“è¯»</span>
<span class="hljs-comment">// 2. ç»´æŠ¤æ—§ä»£ç æ—¶ä¿æŒ interface{} ä»¥ä¿æŒä¸€è‡´æ€§</span>
<span class="hljs-comment">// 3. åœ¨æ³›å‹ä»£ç ä¸­å¿…é¡»ä½¿ç”¨ anyï¼ˆä¸ç±»å‹çº¦æŸé…åˆï¼‰</span>

<span class="hljs-comment">// ç±»å‹æ–­è¨€ï¼ˆæ£€æŸ¥å¹¶è½¬æ¢ç±»å‹ï¼‰</span>
<span class="hljs-keyword">var</span> data any = []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>}
<span class="hljs-keyword">if</span> slice, ok := data.([]<span class="hljs-type">int</span>); ok {
    fmt.Println(<span class="hljs-string">"æ˜¯intåˆ‡ç‰‡:"</span>, slice)
}

<span class="hljs-comment">// ç±»å‹switchï¼ˆæ ¹æ®ç±»å‹åˆ†æ”¯å¤„ç†ï¼‰</span>
<span class="hljs-keyword">switch</span> v := data.(<span class="hljs-keyword">type</span>) {
<span class="hljs-keyword">case</span> []<span class="hljs-type">int</span>:
    fmt.Println(<span class="hljs-string">"intåˆ‡ç‰‡ï¼Œé•¿åº¦:"</span>, <span class="hljs-built_in">len</span>(v))
<span class="hljs-keyword">case</span> <span class="hljs-type">string</span>:
    fmt.Println(<span class="hljs-string">"å­—ç¬¦ä¸²:"</span>, v)
<span class="hljs-keyword">default</span>:
    fmt.Printf(<span class="hljs-string">"å…¶ä»–ç±»å‹: %T\n"</span>, v)
}
</code></pre>
<h2 data-id="heading-30">å…«ã€å¹¶å‘ç¼–ç¨‹</h2>
<h3 data-id="heading-31">goroutineï¼ˆè½»é‡çº§çº¿ç¨‹ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// go å…³é”®å­—å¯åŠ¨ä¸€ä¸ªæ–°çš„goroutineï¼ˆå¼‚æ­¥æ‰§è¡Œï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sayHello</span><span class="hljs-params">()</span></span> {
    fmt.Println(<span class="hljs-string">"Hello from goroutine"</span>)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// å¯åŠ¨goroutineï¼ˆå¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡ä¸»ç¨‹åºï¼‰</span>
    <span class="hljs-keyword">go</span> sayHello()
    
    <span class="hljs-comment">// ä¸»goroutineç»§ç»­æ‰§è¡Œ</span>
    fmt.Println(<span class="hljs-string">"Hello from main"</span>)
    
    <span class="hljs-comment">// ç­‰å¾…ä¸€ä¸‹è®©goroutineæœ‰æœºä¼šæ‰§è¡Œï¼ˆå®é™…åº”ç”¨åº”è¯¥ç”¨WaitGroupæˆ–channelï¼‰</span>
    time.Sleep(<span class="hljs-number">100</span> * time.Millisecond)
}

<span class="hljs-comment">// å¯åŠ¨åŒ¿åå‡½æ•°goroutine</span>
<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(msg <span class="hljs-type">string</span>)</span></span> {
    fmt.Println(msg)
}(<span class="hljs-string">"Hello from goroutine"</span>)

<span class="hljs-comment">// æ³¨æ„ï¼šå¦‚æœä¸»goroutineé€€å‡ºï¼Œæ‰€æœ‰å­goroutineéƒ½ä¼šç»ˆæ­¢</span>
</code></pre>
<h3 data-id="heading-32">channelï¼ˆç®¡é“ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// channel æ˜¯goroutineé—´é€šä¿¡çš„ç®¡é“</span>
ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)            <span class="hljs-comment">// åˆ›å»ºæ— ç¼“å†²ç®¡é“</span>
ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">3</span>)         <span class="hljs-comment">// åˆ›å»ºç¼“å†²å¤§å°ä¸º3çš„ç®¡é“</span>

<span class="hljs-comment">// å‘é€å’Œæ¥æ”¶æ•°æ®</span>
ch &lt;- <span class="hljs-number">42</span>                        <span class="hljs-comment">// å‘é€æ•°æ®åˆ°ç®¡é“ï¼ˆé˜»å¡ç›´åˆ°æœ‰æ¥æ”¶è€…ï¼‰</span>
value := &lt;-ch                   <span class="hljs-comment">// ä»ç®¡é“æ¥æ”¶æ•°æ®ï¼ˆé˜»å¡ç›´åˆ°æœ‰æ•°æ®ï¼‰</span>

<span class="hljs-comment">// å…³é—­ç®¡é“ï¼ˆåªèƒ½ç”±å‘é€è€…å…³é—­ï¼‰</span>
<span class="hljs-built_in">close</span>(ch)
value, ok := &lt;-ch               <span class="hljs-comment">// okä¸ºfalseè¡¨ç¤ºç®¡é“å·²å…³é—­</span>

<span class="hljs-comment">// éå†ç®¡é“ï¼ˆç›´åˆ°ç®¡é“å…³é—­ï¼‰</span>
<span class="hljs-keyword">for</span> value := <span class="hljs-keyword">range</span> ch {
    fmt.Println(value)
}

<span class="hljs-comment">// ç®¡é“æ–¹å‘é™å®šï¼ˆæé«˜ç±»å‹å®‰å…¨ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">producer</span><span class="hljs-params">(ch <span class="hljs-keyword">chan</span>&lt;- <span class="hljs-type">int</span>)</span></span> {  <span class="hljs-comment">// åªå†™ç®¡é“å‚æ•°</span>
    ch &lt;- <span class="hljs-number">1</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">consumer</span><span class="hljs-params">(ch &lt;-<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)</span></span> {  <span class="hljs-comment">// åªè¯»ç®¡é“å‚æ•°</span>
    value := &lt;-ch
}
</code></pre>
<h3 data-id="heading-33">channel é˜»å¡æœºåˆ¶è¯¦è§£</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// é˜»å¡æ˜¯ä»€ä¹ˆï¼Ÿ</span>
<span class="hljs-comment">// é˜»å¡æ˜¯æŒ‡ç¨‹åºæ‰§è¡Œåˆ°æŸä¸ªæ“ä½œæ—¶ï¼Œå¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œä¼šæš‚åœç­‰å¾…ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³æ‰ç»§ç»­æ‰§è¡Œ</span>
<span class="hljs-comment">// åœ¨éå¼‚æ­¥ï¼ˆå•çº¿ç¨‹ï¼‰æƒ…å†µä¸‹ï¼Œé˜»å¡ä¼šå¯¼è‡´æ•´ä¸ªç¨‹åºæš‚åœ</span>

<span class="hljs-comment">// 1. æ— ç¼“å†²ç®¡é“ï¼ˆé˜»å¡æœºåˆ¶è¯¦è§£ï¼‰</span>

<span class="hljs-comment">// ç¤ºä¾‹ï¼šé˜»å¡ç›´åˆ°æœ‰æ¥æ”¶è€…</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)  <span class="hljs-comment">// æ— ç¼“å†²ç®¡é“</span>
    
    <span class="hljs-comment">// æƒ…å†µ1ï¼šåœ¨ä¸»goroutineä¸­å‘é€ï¼ˆä¼šæ­»é”ï¼ï¼‰</span>
    <span class="hljs-comment">// ch &lt;- 42  // âŒ é”™è¯¯ï¼šè¿™é‡Œä¼šæ°¸è¿œé˜»å¡ï¼Œå› ä¸ºæ²¡æœ‰æ¥æ”¶è€…</span>
    <span class="hljs-comment">// fmt.Println("è¿™è¡Œä¸ä¼šæ‰§è¡Œ")</span>
    
    <span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼šåœ¨å¦ä¸€ä¸ªgoroutineä¸­å‘é€</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        fmt.Println(<span class="hljs-string">"å‡†å¤‡å‘é€æ•°æ®..."</span>)
        ch &lt;- <span class="hljs-number">42</span>  <span class="hljs-comment">// å‘é€æ•°æ®ï¼Œå¦‚æœæ­¤æ—¶æ²¡æœ‰æ¥æ”¶è€…ï¼Œä¼šé˜»å¡ç­‰å¾…</span>
        fmt.Println(<span class="hljs-string">"æ•°æ®å·²å‘é€"</span>)
    }()
    
    fmt.Println(<span class="hljs-string">"å‡†å¤‡æ¥æ”¶æ•°æ®..."</span>)
    value := &lt;-ch  <span class="hljs-comment">// æ¥æ”¶æ•°æ®ï¼Œå¦‚æœæ­¤æ—¶æ²¡æœ‰æ•°æ®ï¼Œä¼šé˜»å¡ç­‰å¾…</span>
    fmt.Println(<span class="hljs-string">"æ¥æ”¶åˆ°æ•°æ®:"</span>, value)
    <span class="hljs-comment">// è¾“å‡ºé¡ºåºï¼š</span>
    <span class="hljs-comment">// å‡†å¤‡æ¥æ”¶æ•°æ®...</span>
    <span class="hljs-comment">// å‡†å¤‡å‘é€æ•°æ®...</span>
    <span class="hljs-comment">// æ¥æ”¶åˆ°æ•°æ®: 42</span>
    <span class="hljs-comment">// æ•°æ®å·²å‘é€</span>
}

<span class="hljs-comment">// 2. æœ‰ç¼“å†²ç®¡é“ï¼ˆéƒ¨åˆ†é˜»å¡ï¼‰</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment">// ç¼“å†²å¤§å°ä¸º2</span>
    
    <span class="hljs-comment">// ç¼“å†²æœªæ»¡æ—¶ï¼Œå‘é€ä¸ä¼šé˜»å¡</span>
    ch &lt;- <span class="hljs-number">1</span>  <span class="hljs-comment">// âœ… ç«‹å³å‘é€ï¼Œä¸é˜»å¡</span>
    ch &lt;- <span class="hljs-number">2</span>  <span class="hljs-comment">// âœ… ç«‹å³å‘é€ï¼Œä¸é˜»å¡</span>
    
    <span class="hljs-comment">// ç¼“å†²å·²æ»¡æ—¶ï¼Œå‘é€ä¼šé˜»å¡</span>
    <span class="hljs-comment">// ch &lt;- 3  // âŒ ä¼šé˜»å¡ï¼Œå› ä¸ºç¼“å†²å·²æ»¡ï¼ˆ2ä¸ªï¼‰ï¼Œä¸”æ²¡æœ‰æ¥æ”¶è€…</span>
    
    <span class="hljs-comment">// æœ‰æ•°æ®æ—¶ï¼Œæ¥æ”¶ä¸ä¼šé˜»å¡</span>
    val1 := &lt;-ch  <span class="hljs-comment">// âœ… ç«‹å³æ¥æ”¶ï¼Œä¸é˜»å¡</span>
    val2 := &lt;-ch  <span class="hljs-comment">// âœ… ç«‹å³æ¥æ”¶ï¼Œä¸é˜»å¡</span>
    
    <span class="hljs-comment">// æ— æ•°æ®æ—¶ï¼Œæ¥æ”¶ä¼šé˜»å¡</span>
    <span class="hljs-comment">// val3 := &lt;-ch  // âŒ ä¼šé˜»å¡ï¼Œå› ä¸ºæ²¡æœ‰æ•°æ®ï¼Œä¸”æ²¡æœ‰å‘é€è€…</span>
}

<span class="hljs-comment">// 3. é˜»å¡æœºåˆ¶å®Œæ•´ç¤ºä¾‹</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">demonstrateBlocking</span><span class="hljs-params">()</span></span> {
    ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">string</span>)  <span class="hljs-comment">// æ— ç¼“å†²ç®¡é“</span>
    
    <span class="hljs-comment">// å¯åŠ¨goroutineå‘é€æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        time.Sleep(<span class="hljs-number">2</span> * time.Second)  <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
        fmt.Println(<span class="hljs-string">"goroutine: å‡†å¤‡å‘é€æ•°æ®"</span>)
        ch &lt;- <span class="hljs-string">"Hello"</span>  <span class="hljs-comment">// å‘é€æ•°æ®ï¼ˆæ­¤æ—¶ä¸»goroutineåœ¨ç­‰å¾…æ¥æ”¶ï¼Œæ‰€ä»¥ä¸é˜»å¡ï¼‰</span>
        fmt.Println(<span class="hljs-string">"goroutine: æ•°æ®å·²å‘é€"</span>)
    }()
    
    fmt.Println(<span class="hljs-string">"main: å‡†å¤‡æ¥æ”¶æ•°æ®ï¼ˆä¼šé˜»å¡2ç§’ï¼‰"</span>)
    <span class="hljs-comment">// è¿™é‡Œä¼šé˜»å¡ï¼Œç›´åˆ°ä¸Šé¢çš„goroutineå‘é€æ•°æ®</span>
    <span class="hljs-comment">// é˜»å¡æœŸé—´ï¼Œç¨‹åºä¸ä¼šç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç </span>
    value := &lt;-ch  <span class="hljs-comment">// é˜»å¡ç›´åˆ°æœ‰æ•°æ®</span>
    fmt.Println(<span class="hljs-string">"main: æ¥æ”¶åˆ°æ•°æ®:"</span>, value)
    
    <span class="hljs-comment">// è¾“å‡ºé¡ºåºï¼š</span>
    <span class="hljs-comment">// main: å‡†å¤‡æ¥æ”¶æ•°æ®ï¼ˆä¼šé˜»å¡2ç§’ï¼‰</span>
    <span class="hljs-comment">// ï¼ˆç­‰å¾…2ç§’ï¼‰</span>
    <span class="hljs-comment">// goroutine: å‡†å¤‡å‘é€æ•°æ®</span>
    <span class="hljs-comment">// main: æ¥æ”¶åˆ°æ•°æ®: Hello</span>
    <span class="hljs-comment">// goroutine: æ•°æ®å·²å‘é€</span>
}

<span class="hljs-comment">// 4. é˜»å¡ vs éé˜»å¡ï¼ˆä½¿ç”¨selectçš„defaultï¼‰</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">nonBlockingExample</span><span class="hljs-params">()</span></span> {
    ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)
    
    <span class="hljs-comment">// éé˜»å¡å‘é€ï¼ˆä½¿ç”¨select + defaultï¼‰</span>
    <span class="hljs-keyword">select</span> {
    <span class="hljs-keyword">case</span> ch &lt;- <span class="hljs-number">42</span>:
        fmt.Println(<span class="hljs-string">"å‘é€æˆåŠŸ"</span>)
    <span class="hljs-keyword">default</span>:
        fmt.Println(<span class="hljs-string">"å‘é€å¤±è´¥ï¼ˆç®¡é“æ»¡æˆ–æ— æ¥æ”¶è€…ï¼‰"</span>)  <span class="hljs-comment">// ç«‹å³è¿”å›ï¼Œä¸é˜»å¡</span>
    }
    
    <span class="hljs-comment">// éé˜»å¡æ¥æ”¶ï¼ˆä½¿ç”¨select + defaultï¼‰</span>
    <span class="hljs-keyword">select</span> {
    <span class="hljs-keyword">case</span> value := &lt;-ch:
        fmt.Println(<span class="hljs-string">"æ¥æ”¶åˆ°:"</span>, value)
    <span class="hljs-keyword">default</span>:
        fmt.Println(<span class="hljs-string">"æ²¡æœ‰æ•°æ®ï¼ˆç«‹å³è¿”å›ï¼Œä¸é˜»å¡ï¼‰"</span>)  <span class="hljs-comment">// ç«‹å³è¿”å›ï¼Œä¸é˜»å¡</span>
    }
}

<span class="hljs-comment">// 5. å®é™…åº”ç”¨ï¼šç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">producerConsumer</span><span class="hljs-params">()</span></span> {
    ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">3</span>)  <span class="hljs-comment">// ç¼“å†²å¤§å°ä¸º3</span>
    
    <span class="hljs-comment">// ç”Ÿäº§è€…ï¼ˆå‘é€æ•°æ®ï¼‰</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i++ {
            ch &lt;- i  <span class="hljs-comment">// å‘é€æ•°æ®</span>
            <span class="hljs-comment">// å¦‚æœç¼“å†²æ»¡ï¼Œè¿™é‡Œä¼šé˜»å¡ç›´åˆ°æ¶ˆè´¹è€…å–èµ°æ•°æ®</span>
            fmt.Printf(<span class="hljs-string">"ç”Ÿäº§: %d\n"</span>, i)
        }
        <span class="hljs-built_in">close</span>(ch)  <span class="hljs-comment">// å…³é—­ç®¡é“ï¼Œé€šçŸ¥æ¶ˆè´¹è€…ç»“æŸ</span>
    }()
    
    <span class="hljs-comment">// æ¶ˆè´¹è€…ï¼ˆæ¥æ”¶æ•°æ®ï¼‰</span>
    <span class="hljs-keyword">for</span> value := <span class="hljs-keyword">range</span> ch {
        <span class="hljs-comment">// å¦‚æœç®¡é“ä¸ºç©ºï¼Œè¿™é‡Œä¼šé˜»å¡ç›´åˆ°ç”Ÿäº§è€…å‘é€æ•°æ®</span>
        fmt.Printf(<span class="hljs-string">"æ¶ˆè´¹: %d\n"</span>, value)
        time.Sleep(<span class="hljs-number">500</span> * time.Millisecond)  <span class="hljs-comment">// æ¨¡æ‹Ÿå¤„ç†æ—¶é—´</span>
    }
}

<span class="hljs-comment">// æ€»ç»“ï¼š</span>
<span class="hljs-comment">// 1. "é˜»å¡ç›´åˆ°æœ‰æ¥æ”¶è€…"ï¼šå‘é€æ“ä½œä¼šç­‰å¾…ï¼Œç›´åˆ°æœ‰goroutineæ¥æ”¶æ•°æ®</span>
<span class="hljs-comment">// 2. "é˜»å¡ç›´åˆ°æœ‰æ•°æ®"ï¼šæ¥æ”¶æ“ä½œä¼šç­‰å¾…ï¼Œç›´åˆ°æœ‰goroutineå‘é€æ•°æ®</span>
<span class="hljs-comment">// 3. åœ¨å•çº¿ç¨‹ï¼ˆégoroutineï¼‰æƒ…å†µä¸‹ï¼Œé˜»å¡ä¼šå¯¼è‡´ç¨‹åºæš‚åœ</span>
<span class="hljs-comment">// 4. ä½¿ç”¨goroutineå¯ä»¥é¿å…é˜»å¡ä¸»ç¨‹åº</span>
<span class="hljs-comment">// 5. ä½¿ç”¨ç¼“å†²ç®¡é“å¯ä»¥å‡å°‘é˜»å¡ï¼ˆç¼“å†²æœªæ»¡æ—¶å‘é€ä¸é˜»å¡ï¼Œç¼“å†²æœ‰æ•°æ®æ—¶æ¥æ”¶ä¸é˜»å¡ï¼‰</span>
</code></pre>
<h3 data-id="heading-34">select - å¤šè·¯å¤ç”¨</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// select ç›‘æ§å¤šä¸ªchannelæ“ä½œï¼Œå“ªä¸ªå…ˆå°±ç»ªå°±æ‰§è¡Œå“ªä¸ª</span>
ch1 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">string</span>)
ch2 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">string</span>)

<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
    time.Sleep(<span class="hljs-number">1</span> * time.Second)
    ch1 &lt;- <span class="hljs-string">"æ¥è‡ªch1"</span>
}()

<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
    time.Sleep(<span class="hljs-number">2</span> * time.Second)  
    ch2 &lt;- <span class="hljs-string">"æ¥è‡ªch2"</span>
}()

<span class="hljs-comment">// selectç­‰å¾…ç¬¬ä¸€ä¸ªå°±ç»ªçš„channel</span>
<span class="hljs-keyword">select</span> {
<span class="hljs-keyword">case</span> msg1 := &lt;-ch1:
    fmt.Println(<span class="hljs-string">"æ”¶åˆ°:"</span>, msg1)  <span class="hljs-comment">// 1ç§’åæ‰§è¡Œï¼ˆæ›´å¿«ï¼‰</span>
<span class="hljs-keyword">case</span> msg2 := &lt;-ch2:
    fmt.Println(<span class="hljs-string">"æ”¶åˆ°:"</span>, msg2)  <span class="hljs-comment">// 2ç§’åæ‰§è¡Œ</span>
<span class="hljs-keyword">case</span> &lt;-time.After(<span class="hljs-number">3</span> * time.Second):
    fmt.Println(<span class="hljs-string">"è¶…æ—¶"</span>)        <span class="hljs-comment">// 3ç§’åæ‰§è¡Œï¼ˆå¦‚æœå‰ä¸¤ä¸ªéƒ½æ²¡å°±ç»ªï¼‰</span>
<span class="hljs-keyword">default</span>:
    fmt.Println(<span class="hljs-string">"éé˜»å¡"</span>)      <span class="hljs-comment">// å¦‚æœæ‰€æœ‰caseéƒ½ä¸å°±ç»ªï¼Œç«‹å³æ‰§è¡Œ</span>
}

<span class="hljs-comment">// æ³¨æ„ï¼šå¦‚æœå¤šä¸ªcaseåŒæ—¶å°±ç»ªï¼Œselectä¼šéšæœºé€‰æ‹©ä¸€ä¸ªï¼ˆå…¬å¹³æ€§ï¼‰</span>
</code></pre>
<h3 data-id="heading-35">sync.WaitGroupï¼ˆç­‰å¾…ç»„ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// WaitGroup ç”¨äºç­‰å¾…å¤šä¸ªgoroutineå®Œæˆ</span>
<span class="hljs-keyword">var</span> wg sync.WaitGroup

<span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++ {
    wg.Add(<span class="hljs-number">1</span>)                    <span class="hljs-comment">// å¢åŠ è®¡æ•°ï¼ˆæ¯ä¸ªgoroutine +1ï¼‰</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(id <span class="hljs-type">int</span>)</span></span> {
        <span class="hljs-keyword">defer</span> wg.Done()          <span class="hljs-comment">// å®Œæˆæ—¶å‡1ï¼ˆdeferç¡®ä¿æ‰§è¡Œï¼‰</span>
        fmt.Printf(<span class="hljs-string">"ä»»åŠ¡%då®Œæˆ\n"</span>, id)
    }(i)
}

wg.Wait()                       <span class="hljs-comment">// é˜»å¡ç›´åˆ°è®¡æ•°ä¸º0ï¼ˆæ‰€æœ‰goroutineå®Œæˆï¼‰</span>
fmt.Println(<span class="hljs-string">"æ‰€æœ‰ä»»åŠ¡å®Œæˆ"</span>)
</code></pre>
<h2 data-id="heading-36">ä¹ã€æ—¶é—´å¤„ç†</h2>
<h3 data-id="heading-37">Timerï¼ˆå•æ¬¡å®šæ—¶ï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// Timer åœ¨æŒ‡å®šæ—¶é—´åè§¦å‘ä¸€æ¬¡</span>
timer := time.NewTimer(<span class="hljs-number">2</span> * time.Second)
&lt;-timer.C                       <span class="hljs-comment">// é˜»å¡ç­‰å¾…2ç§’åè§¦å‘</span>
fmt.Println(<span class="hljs-string">"æ—¶é—´åˆ°"</span>)

<span class="hljs-comment">// åœæ­¢è®¡æ—¶å™¨ï¼ˆå¦‚æœè¿˜æœªè§¦å‘ï¼‰</span>
<span class="hljs-keyword">if</span> timer.Stop() {
    fmt.Println(<span class="hljs-string">"è®¡æ—¶å™¨å·²åœæ­¢"</span>)
}
</code></pre>
<h3 data-id="heading-38">Tickerï¼ˆé‡å¤å®šæ—¶ï¼‰- æ­£ç¡®ä½¿ç”¨æ–¹å¼</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// Ticker æ¯éš”æŒ‡å®šæ—¶é—´è§¦å‘ä¸€æ¬¡ï¼ˆå¿…é¡»ä½¿ç”¨deferåœæ­¢ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åˆ›å»ºå®šæ—¶å™¨ï¼šæ¯500æ¯«ç§’è§¦å‘ä¸€æ¬¡</span>
    ticker := time.NewTicker(<span class="hljs-number">500</span> * time.Millisecond)
    
    <span class="hljs-comment">// å…³é”®ï¼šå¿…é¡»ä½¿ç”¨ defer åœæ­¢ tickerï¼Œå¦åˆ™ä¼šå†…å­˜æ³„æ¼</span>
    <span class="hljs-comment">// defer ç¡®ä¿å‡½æ•°é€€å‡ºæ—¶ï¼ˆå³ä½¿æ˜¯ panicï¼‰ä¹Ÿä¼šæ‰§è¡Œ Stop()</span>
    <span class="hljs-keyword">defer</span> ticker.Stop()  <span class="hljs-comment">// æ­£ç¡®ï¼šåœ¨mainå‡½æ•°é€€å‡ºæ—¶åœæ­¢</span>
    
    <span class="hljs-comment">// å¯åŠ¨ä¸€ä¸ªgoroutineå¤„ç†å®šæ—¶ä»»åŠ¡</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">for</span> t := <span class="hljs-keyword">range</span> ticker.C {  <span class="hljs-comment">// ä»tickerçš„ç®¡é“æ¥æ”¶æ—¶é—´</span>
            fmt.Printf(<span class="hljs-string">"å®šæ—¶è§¦å‘: %v\n"</span>, t.Format(<span class="hljs-string">"15:04:05.000"</span>))
        }
        fmt.Println(<span class="hljs-string">"Tickeråœæ­¢ï¼Œgoroutineé€€å‡º"</span>)
    }()
    
    <span class="hljs-comment">// ä¸»ç¨‹åºç­‰å¾…3ç§’</span>
    time.Sleep(<span class="hljs-number">3</span> * time.Second)
    fmt.Println(<span class="hljs-string">"ä¸»ç¨‹åºç»“æŸï¼Œdefer ticker.Stop() å°†è¢«è°ƒç”¨"</span>)
    
    <span class="hljs-comment">// å‡½æ•°ç»“æŸæ—¶ï¼Œdeferä¼šæ‰§è¡Œï¼Œtickerè¢«åœæ­¢</span>
    <span class="hljs-comment">// ticker.C ç®¡é“è¢«å…³é—­ï¼Œä¸Šé¢çš„goroutineä¼šé€€å‡º</span>
}

<span class="hljs-comment">// é”™è¯¯ç”¨æ³•ï¼šå¿˜è®°åœæ­¢ Tickerï¼ˆä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">wrongUsage</span><span class="hljs-params">()</span></span> {
    ticker := time.NewTicker(<span class="hljs-number">1</span> * time.Second)
    
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">for</span> t := <span class="hljs-keyword">range</span> ticker.C {
            fmt.Println(t)
        }
    }()
    
    <span class="hljs-comment">// âŒ é”™è¯¯ï¼šæ²¡æœ‰è°ƒç”¨ ticker.Stop()</span>
    <span class="hljs-comment">// å³ä½¿å‡½æ•°è¿”å›ï¼Œtickerä»åœ¨åå°è¿è¡Œï¼Œgoroutineä¸ä¼šé€€å‡º</span>
    <span class="hljs-comment">// å¯¼è‡´å†…å­˜æ³„æ¼ï¼</span>
}

<span class="hljs-comment">// æ­£ç¡®ç”¨æ³•ï¼šä½¿ç”¨deferç¡®ä¿åœæ­¢</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">correctUsage</span><span class="hljs-params">()</span></span> {
    ticker := time.NewTicker(<span class="hljs-number">1</span> * time.Second)
    <span class="hljs-keyword">defer</span> ticker.Stop()  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šç¡®ä¿åœæ­¢</span>
    
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">for</span> t := <span class="hljs-keyword">range</span> ticker.C {
            fmt.Println(t)
        }
    }()
    
    <span class="hljs-comment">// å‡½æ•°è¿”å›æ—¶ï¼Œdeferæ‰§è¡Œï¼Œtickeråœæ­¢</span>
    <span class="hljs-comment">// goroutineä¼šé€€å‡ºï¼Œæ²¡æœ‰å†…å­˜æ³„æ¼</span>
}
</code></pre>
<h3 data-id="heading-39">æ—¶é—´æ“ä½œ</h3>
<pre><code class="hljs language-go" lang="go">now := time.Now()               <span class="hljs-comment">// å½“å‰æ—¶é—´</span>
fmt.Println(now.Format(<span class="hljs-string">"2006-01-02 15:04:05"</span>))  <span class="hljs-comment">// æ ¼å¼åŒ–æ—¶é—´</span>

duration := <span class="hljs-number">2</span> * time.Hour      <span class="hljs-comment">// 2å°æ—¶çš„æ—¶é—´é—´éš”</span>
future := now.Add(duration)    <span class="hljs-comment">// åŠ æ—¶é—´</span>
past := now.Add(-duration)     <span class="hljs-comment">// å‡æ—¶é—´</span>

diff := future.Sub(now)        <span class="hljs-comment">// æ—¶é—´å·®</span>
fmt.Println(duration.Seconds()) <span class="hljs-comment">// è½¬æ¢ä¸ºç§’æ•°</span>
</code></pre>
<h2 data-id="heading-40">åã€å…¶ä»–é‡è¦å…³é”®å­—</h2>
<h3 data-id="heading-41">type - ç±»å‹å®šä¹‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åˆ›å»ºæ–°ç±»å‹ï¼ˆåº•å±‚ç±»å‹ç›¸åŒä½†ä¸èƒ½ç›´æ¥è¿ç®—ï¼‰</span>
<span class="hljs-keyword">type</span> Celsius <span class="hljs-type">float64</span>     <span class="hljs-comment">// æ‘„æ°åº¦ç±»å‹</span>
<span class="hljs-keyword">type</span> Fahrenheit <span class="hljs-type">float64</span>  <span class="hljs-comment">// åæ°åº¦ç±»å‹</span>
<span class="hljs-keyword">type</span> ID <span class="hljs-type">string</span>          <span class="hljs-comment">// ç”¨æˆ·IDç±»å‹</span>

<span class="hljs-comment">// ç±»å‹åˆ«åï¼ˆä¸åŸç±»å‹å®Œå…¨å…¼å®¹ï¼‰</span>
<span class="hljs-keyword">type</span> IntAlias = <span class="hljs-type">int</span>     <span class="hljs-comment">// åªæ˜¯intçš„å¦ä¸€ä¸ªåå­—ï¼Œå¯ä»¥äº’ç›¸èµ‹å€¼</span>

<span class="hljs-comment">// ç»“æ„ä½“ç±»å‹</span>
<span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> {
    Name <span class="hljs-type">string</span>
    Age  <span class="hljs-type">int</span>
}

<span class="hljs-comment">// æ¥å£ç±»å‹</span>
<span class="hljs-keyword">type</span> Reader <span class="hljs-keyword">interface</span> {
    Read(p []<span class="hljs-type">byte</span>) (n <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>)
}

<span class="hljs-comment">// å‡½æ•°ç±»å‹</span>
<span class="hljs-keyword">type</span> Handler <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(<span class="hljs-type">string</span>)</span></span> <span class="hljs-type">int</span>
</code></pre>
<h3 data-id="heading-42">package å’Œ import</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// package å£°æ˜åŒ…å</span>
<span class="hljs-keyword">package</span> main      <span class="hljs-comment">// å¯æ‰§è¡Œç¨‹åºçš„ä¸»åŒ…</span>
<span class="hljs-keyword">package</span> mylib     <span class="hljs-comment">// åº“åŒ…</span>

<span class="hljs-comment">// import å¯¼å…¥åŒ…</span>
<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>                       <span class="hljs-comment">// æ ‡å‡†åº“åŒ…</span>
    <span class="hljs-string">"math"</span>
    
    <span class="hljs-string">"github.com/user/package"</span>   <span class="hljs-comment">// ç¬¬ä¸‰æ–¹åŒ…</span>
    
    . <span class="hljs-string">"mypackage"</span>               <span class="hljs-comment">// ç‚¹å¯¼å…¥ï¼šå¯ç›´æ¥è®¿é—®åŒ…å†…æ ‡è¯†ç¬¦ï¼ˆä¸æ¨èï¼‰</span>
    m <span class="hljs-string">"math"</span>                    <span class="hljs-comment">// åˆ«åå¯¼å…¥ï¼šä½¿ç”¨ m ä»£æ›¿ math</span>
    _ <span class="hljs-string">"database/sql"</span>            <span class="hljs-comment">// åŒ¿åå¯¼å…¥ï¼šåªæ‰§è¡ŒåŒ…çš„initå‡½æ•°</span>
)
</code></pre>
<h3 data-id="heading-43">range - éå†</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// rangeéå†å„ç§é›†åˆç±»å‹</span>
<span class="hljs-comment">// æ•°ç»„/åˆ‡ç‰‡</span>
<span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>} {
    fmt.Printf(<span class="hljs-string">"ç´¢å¼•%d: å€¼%d\n"</span>, i, v)
}

<span class="hljs-comment">// æ˜ å°„</span>
<span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>{<span class="hljs-string">"a"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">2</span>} {
    fmt.Printf(<span class="hljs-string">"é”®%s: å€¼%d\n"</span>, k, v)
}

<span class="hljs-comment">// å­—ç¬¦ä¸²ï¼ˆéå†runeï¼Œä¸æ˜¯å­—èŠ‚ï¼‰</span>
<span class="hljs-keyword">for</span> i, ch := <span class="hljs-keyword">range</span> <span class="hljs-string">"ä½ å¥½"</span> {
    fmt.Printf(<span class="hljs-string">"ä½ç½®%d: å­—ç¬¦%c\n"</span>, i, ch)
}

<span class="hljs-comment">// ç®¡é“ï¼ˆç›´åˆ°ç®¡é“å…³é—­ï¼‰</span>
<span class="hljs-keyword">for</span> value := <span class="hljs-keyword">range</span> ch {
    fmt.Println(value)
}
</code></pre>
<h3 data-id="heading-44">è·å–å¯¹è±¡ç±»å‹</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// 1. ä½¿ç”¨ fmt.Printf çš„ %T æ ¼å¼åŒ–ç¬¦ï¼ˆæœ€å¸¸ç”¨ï¼‰</span>
<span class="hljs-keyword">var</span> x <span class="hljs-type">int</span> = <span class="hljs-number">42</span>
<span class="hljs-keyword">var</span> y <span class="hljs-type">string</span> = <span class="hljs-string">"hello"</span>
<span class="hljs-keyword">var</span> z []<span class="hljs-type">int</span> = []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>}

fmt.Printf(<span class="hljs-string">"xçš„ç±»å‹: %T\n"</span>, x)  <span class="hljs-comment">// è¾“å‡º: xçš„ç±»å‹: int</span>
fmt.Printf(<span class="hljs-string">"yçš„ç±»å‹: %T\n"</span>, y)  <span class="hljs-comment">// è¾“å‡º: yçš„ç±»å‹: string</span>
fmt.Printf(<span class="hljs-string">"zçš„ç±»å‹: %T\n"</span>, z)  <span class="hljs-comment">// è¾“å‡º: zçš„ç±»å‹: []int</span>

<span class="hljs-comment">// 2. ä½¿ç”¨ reflect.TypeOfï¼ˆéœ€è¦å¯¼å…¥ reflect åŒ…ï¼‰</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">"reflect"</span>

<span class="hljs-keyword">var</span> num <span class="hljs-type">int</span> = <span class="hljs-number">100</span>
<span class="hljs-keyword">var</span> name <span class="hljs-type">string</span> = <span class="hljs-string">"Go"</span>

fmt.Println(<span class="hljs-string">"numçš„ç±»å‹:"</span>, reflect.TypeOf(num))      <span class="hljs-comment">// int</span>
fmt.Println(<span class="hljs-string">"nameçš„ç±»å‹:"</span>, reflect.TypeOf(name))    <span class="hljs-comment">// string</span>

<span class="hljs-comment">// 3. è·å–ç»“æ„ä½“ç±»å‹</span>
<span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> {
    Name <span class="hljs-type">string</span>
    Age  <span class="hljs-type">int</span>
}

p := Person{Name: <span class="hljs-string">"Alice"</span>, Age: <span class="hljs-number">25</span>}
fmt.Printf(<span class="hljs-string">"pçš„ç±»å‹: %T\n"</span>, p)  <span class="hljs-comment">// è¾“å‡º: pçš„ç±»å‹: main.Person</span>

<span class="hljs-comment">// 4. è·å–æŒ‡é’ˆç±»å‹</span>
ptr := &amp;Person{Name: <span class="hljs-string">"Bob"</span>, Age: <span class="hljs-number">30</span>}
fmt.Printf(<span class="hljs-string">"ptrçš„ç±»å‹: %T\n"</span>, ptr)  <span class="hljs-comment">// è¾“å‡º: ptrçš„ç±»å‹: *main.Person</span>

<span class="hljs-comment">// 5. è·å–æ¥å£ç±»å‹</span>
<span class="hljs-keyword">var</span> val <span class="hljs-keyword">interface</span>{} = <span class="hljs-number">42</span>
fmt.Printf(<span class="hljs-string">"valçš„ç±»å‹: %T\n"</span>, val)  <span class="hljs-comment">// è¾“å‡º: valçš„ç±»å‹: int</span>

<span class="hljs-comment">// 6. ç±»å‹æ–­è¨€è·å–å…·ä½“ç±»å‹</span>
<span class="hljs-keyword">var</span> data any = <span class="hljs-string">"hello"</span>
<span class="hljs-keyword">switch</span> v := data.(<span class="hljs-keyword">type</span>) {
<span class="hljs-keyword">case</span> <span class="hljs-type">int</span>:
    fmt.Printf(<span class="hljs-string">"æ˜¯intç±»å‹: %d\n"</span>, v)
<span class="hljs-keyword">case</span> <span class="hljs-type">string</span>:
    fmt.Printf(<span class="hljs-string">"æ˜¯stringç±»å‹: %s\n"</span>, v)
<span class="hljs-keyword">default</span>:
    fmt.Printf(<span class="hljs-string">"å…¶ä»–ç±»å‹: %T\n"</span>, v)
}

<span class="hljs-comment">// 7. è·å–ç±»å‹çš„å­—ç¬¦ä¸²è¡¨ç¤º</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">"reflect"</span>

t := reflect.TypeOf(<span class="hljs-number">42</span>)
fmt.Println(<span class="hljs-string">"ç±»å‹åç§°:"</span>, t.Name())        <span class="hljs-comment">// int</span>
fmt.Println(<span class="hljs-string">"ç±»å‹å­—ç¬¦ä¸²:"</span>, t.String())    <span class="hljs-comment">// int</span>
fmt.Println(<span class="hljs-string">"ç±»å‹ç§ç±»:"</span>, t.Kind())        <span class="hljs-comment">// int</span>

<span class="hljs-comment">// 8. å®é™…åº”ç”¨ï¼šç±»å‹æ£€æŸ¥å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">printType</span><span class="hljs-params">(v <span class="hljs-keyword">interface</span>{})</span></span> {
    <span class="hljs-keyword">switch</span> v := v.(<span class="hljs-keyword">type</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-type">int</span>:
        fmt.Printf(<span class="hljs-string">"æ•´æ•°: %d (ç±»å‹: %T)\n"</span>, v, v)
    <span class="hljs-keyword">case</span> <span class="hljs-type">string</span>:
        fmt.Printf(<span class="hljs-string">"å­—ç¬¦ä¸²: %s (ç±»å‹: %T)\n"</span>, v, v)
    <span class="hljs-keyword">case</span> []<span class="hljs-type">int</span>:
        fmt.Printf(<span class="hljs-string">"intåˆ‡ç‰‡: %v (ç±»å‹: %T)\n"</span>, v, v)
    <span class="hljs-keyword">default</span>:
        fmt.Printf(<span class="hljs-string">"æœªçŸ¥ç±»å‹: %T, å€¼: %v\n"</span>, v, v)
    }
}

printType(<span class="hljs-number">42</span>)              <span class="hljs-comment">// æ•´æ•°: 42 (ç±»å‹: int)</span>
printType(<span class="hljs-string">"hello"</span>)         <span class="hljs-comment">// å­—ç¬¦ä¸²: hello (ç±»å‹: string)</span>
printType([]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>})  <span class="hljs-comment">// intåˆ‡ç‰‡: [1 2 3] (ç±»å‹: []int)</span>
</code></pre>
<h2 data-id="heading-45">åä¸€ã€é‡è¦ç‰¹æ€§æ€»ç»“</h2>
<h3 data-id="heading-46">1. å€¼ç±»å‹ vs å¼•ç”¨ç±»å‹</h3>






























<table><thead><tr><th>ç±»å‹</th><th>å€¼ç±»å‹</th><th>å¼•ç”¨ç±»å‹</th></tr></thead><tbody><tr><td>ç¤ºä¾‹</td><td>int, float, bool, string, æ•°ç»„, ç»“æ„ä½“</td><td>åˆ‡ç‰‡, æ˜ å°„, ç®¡é“, å‡½æ•°, æ¥å£</td></tr><tr><td>èµ‹å€¼</td><td>å¤åˆ¶æ•´ä¸ªå€¼</td><td>å¤åˆ¶å¼•ç”¨ï¼ˆå…±äº«åº•å±‚æ•°æ®ï¼‰</td></tr><tr><td>nilå€¼</td><td>ä¸èƒ½ä¸ºnil</td><td>å¯ä»¥ä¸ºnil</td></tr><tr><td>ä¿®æ”¹</td><td>ä¿®æ”¹ä¸å½±å“åŸå€¼</td><td>ä¿®æ”¹å½±å“æ‰€æœ‰å¼•ç”¨</td></tr></tbody></table>
<h3 data-id="heading-47">2. æ–¹æ³•æ¥æ”¶è€…é€‰æ‹©åŸåˆ™</h3>
<ul>
<li><strong>å€¼æ¥æ”¶è€…</strong>ï¼šæ–¹æ³•ä¸éœ€è¦ä¿®æ”¹æ¥æ”¶è€…ï¼Œæˆ–æ¥æ”¶è€…æ˜¯å°å‹ç»“æ„ä½“</li>
<li><strong>æŒ‡é’ˆæ¥æ”¶è€…</strong>ï¼šæ–¹æ³•éœ€è¦ä¿®æ”¹æ¥æ”¶è€…ï¼Œæˆ–æ¥æ”¶è€…æ˜¯å¤§å‹ç»“æ„ä½“ï¼ˆé¿å…å¤åˆ¶ï¼‰</li>
<li><strong>ä¸€è‡´æ€§</strong>ï¼šåŒä¸€ç±»å‹çš„å¤šä¸ªæ–¹æ³•åº”è¯¥ä½¿ç”¨ç›¸åŒç±»å‹çš„æ¥æ”¶è€…</li>
</ul>
<h3 data-id="heading-48">3. any ä½¿ç”¨æŒ‡å—</h3>
<ul>
<li><strong>Go 1.18+</strong>ï¼šä¼˜å…ˆä½¿ç”¨ <code>any</code>ï¼Œæ›´ç®€æ´</li>
<li><strong>æ³›å‹ä»£ç </strong>ï¼šå¿…é¡»ä½¿ç”¨ <code>any</code></li>
<li><strong>æ—§ä»£ç ç»´æŠ¤</strong>ï¼šä¿æŒ <code>interface{}</code> ä»¥å…¼å®¹</li>
<li><strong>ä¸¤è€…å®Œå…¨ç­‰ä»·</strong>ï¼šç¼–è¯‘åæ²¡æœ‰åŒºåˆ«</li>
</ul>
<h3 data-id="heading-49">4. Ticker æœ€ä½³å®è·µ</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">useTicker</span><span class="hljs-params">()</span></span> {
    ticker := time.NewTicker(interval)
    <span class="hljs-keyword">defer</span> ticker.Stop()  <span class="hljs-comment">// å¿…é¡»ï¼é˜²æ­¢å†…å­˜æ³„æ¼</span>
    
    <span class="hljs-comment">// ä½¿ç”¨ticker...</span>
}

<span class="hljs-comment">// æ³¨æ„ï¼šticker.Stop() ä¸ä¼šå…³é—­ticker.Cç®¡é“</span>
<span class="hljs-comment">// å·²å‘é€åˆ°ç®¡é“çš„æ•°æ®ä»ç„¶å¯ä»¥æ¥æ”¶</span>
</code></pre>
<h3 data-id="heading-50">5. å¹¶å‘å®‰å…¨æ¨¡å¼</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ä½¿ç”¨WaitGroupç­‰å¾…æ‰€æœ‰goroutine</span>
<span class="hljs-keyword">var</span> wg sync.WaitGroup
<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; n; i++ {
    wg.Add(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">defer</span> wg.Done()
        <span class="hljs-comment">// å·¥ä½œ...</span>
    }()
}
wg.Wait()

<span class="hljs-comment">// ä½¿ç”¨channelä¼ é€’ç»“æœ</span>
results := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> Result, n)
<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; n; i++ {
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        results &lt;- doWork()
    }()
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[5å°æ—¶æ•´ç†60é¡µã€ŠGoogle AgentæŒ‡å—ã€‹ï¼Œä¸æ‡‚Agentçš„åŒ…æ•™åŒ…ä¼š]]></title>    <link>https://juejin.cn/post/7584987267292348462</link>    <guid>https://juejin.cn/post/7584987267292348462</guid>    <pubDate>2025-12-18T05:56:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584987267292348462" data-draft-id="7584810656382353417" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="5å°æ—¶æ•´ç†60é¡µã€ŠGoogle AgentæŒ‡å—ã€‹ï¼Œä¸æ‡‚Agentçš„åŒ…æ•™åŒ…ä¼š"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-18T05:56:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            5å°æ—¶æ•´ç†60é¡µã€ŠGoogle AgentæŒ‡å—ã€‹ï¼Œä¸æ‡‚Agentçš„åŒ…æ•™åŒ…ä¼š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:56:00.000Z" title="Thu Dec 18 2025 05:56:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p><em><strong>èŠ±äº†äº”ä¸ªå°æ—¶ï¼ŒæŠŠ Google ç™½çš®ä¹¦æ‹†è§£æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ Agent å¿ƒæ™ºæ¨¡å‹çš„é•¿æ–‡ã€‚</strong></em></p>
<p><em><strong>æ²¡ä»€ä¹ˆèŠ±é‡Œèƒ¡å“¨çš„æ–°åè¯ï¼Œä½†æŠŠæ¨¡å‹ã€å·¥å…·ã€ç¼–æ’ã€è®°å¿†ã€è®­ç»ƒè¿™å‡ ä»¶æ ¸å¿ƒäº‹è®²å¾—æ¯”è¾ƒå®Œæ•´ï¼Œå¯¹äºæƒ³è¦äº†è§£çš„Agentçš„åˆå­¦è€…ï¼Œæ˜¯å¾ˆä¸é”™çš„é€‰æ‹©ã€‚</strong></em></p>
<p>Googleæœ€è¿‘å‘å¸ƒäº†ä¸€ç¯‡å…³äºAgenté•¿è¾¾60é¡µçš„æ–‡ä»¶ï¼š <strong>ã€Šåˆåˆ›å…¬å¸æŠ€æœ¯æŒ‡å—ï¼šAI Agentsã€‹</strong> ï¼Œè¿™ä»½æŠ¥å‘Šä»å®£ä¼ æ¥è¯´è¡¨è¾¾äº†è‡ªå·±ä¸ä¹‹å‰åç†è®ºçš„æ–‡ç« ä¸ä¸€æ ·ï¼Œä»–è¿˜æ˜¯æš´éœ²äº†ä¸å°‘ç»†èŠ‚æŠ€å·§ï¼Œå¯¹æ­£åœ¨åšAgentçš„å„ä½åº”è¯¥æœ‰äº›å¸®åŠ©ã€‚</p>
<p><strong>åªä¸è¿‡æˆ‘å®é™…è¯»ä¸‹æ¥ï¼ŒæŠ€å·§ä»€ä¹ˆçš„ç»™çš„å¾ˆä¸€èˆ¬ï¼Œä½†æ˜¯ä¸€ä»½éå¸¸ä¸é”™çš„Agentå…¥é—¨çº§å­¦ä¹ è¯»ç‰©</strong>ï¼Œæ‰€ä»¥ä¹Ÿæ¨èç»™å¤§å®¶ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84aead72981f443b939f02dfb18e79ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=6cT%2FquUU7dDB94xNzgiWmOtXDmc%3D" alt="" loading="lazy"/></p>
<p>é¦–å…ˆï¼ŒAgentçš„èƒ½åŠ›åŸºçŸ³ï¼ˆä¹Ÿå°±æ˜¯å¯¹å·¥å…·çš„è°ƒç”¨èƒ½åŠ›ï¼‰æ˜¯æ¨¡å‹çš„Function Callingï¼Œè€Œè¿™ä¸ªè¯†åˆ«å·¥å…·æ˜¯å¦åº”è¯¥è¢«è°ƒç”¨çš„èƒ½åŠ›æ˜¯å¾®è°ƒè®­ç»ƒçš„ç»“æœã€‚</p>
<p>æ¯”å¦‚ï¼ŒAgentå¯ä»¥ä½¿ç”¨æ•°æ®åº“å·¥å…·è·å–å®¢æˆ·è®¢å•åšä¸ªæ€§åŒ–æ¨èã€æ ¹æ®ç”¨æˆ·æŒ‡ä»¤è°ƒç”¨é‚®ä»¶ API å‘é€ç”µå­é‚®ä»¶ã€ç”šè‡³è‡ªåŠ¨æ‰§è¡Œé‡‘èäº¤æ˜“...</p>
<p>ä¸Šè¿°æ¯ä¸ªåŠŸèƒ½éƒ½éœ€è¦æ¨¡å‹ä¸å¤–éƒ¨ä¸–ç•Œï¼ˆå·¥å…·ã€æ•°æ®ï¼‰åšäº¤äº’ï¼Œåªè¦<strong>å…·å¤‡è‡ªä¸»è§„åˆ’å’Œå¤šæ­¥ä»»åŠ¡æ‰§è¡Œèƒ½åŠ›çš„ç³»ç»Ÿ</strong>ï¼Œå°±æ˜¯Agentã€‚</p>
<h2 data-id="heading-0">Agentæ¶æ„æ¦‚è§ˆ</h2>
<p>å†æ¬¡å¯„å‡ºè¿™ç« ç»å…¸Agentæ¶æ„å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce829b375550401da7767e27786e936d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=1e%2BbGUK9X0B7GeWIC8a32dw5I64%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">ç°ä»£ AI Agent é€šå¸¸ç”±å››å±‚æ ¸å¿ƒç»„ä»¶æ„æˆï¼š</h2>
<p><strong>ä¸€ã€æ¨¡å‹å±‚ï¼š</strong></p>
<p>åŸºç¡€æ¨¡å‹ï¼ˆå¦‚å„ç±»å¤§å‹è¯­è¨€æ¨¡å‹ï¼‰ï¼Œè´Ÿè´£è‡ªç„¶è¯­è¨€ç†è§£ä¸ç”Ÿæˆï¼Œåœ¨ç”Ÿäº§åº”ç”¨é‡Œé¢å¾€å¾€ä¸ä¼šä¾èµ–å•ä¸€æ¨¡å‹ï¼Œç”šè‡³ä¼šæœ‰å¾ˆå¤šå°æ¨¡å‹å¾®è°ƒåœºæ™¯åšå…¶ä¸­ç®€å•ä»»åŠ¡ã€‚</p>
<p><strong>äºŒã€å·¥å…·å±‚ï¼š</strong></p>
<p>å¤–éƒ¨å·¥å…·å’ŒæœåŠ¡ï¼ŒåŒ…å«å„ç§APIå¦‚æ•°æ®åº“ã€æœç´¢å¼•æ“ç­‰ï¼Œå¸®åŠ©Agentæ„ŸçŸ¥å¤–éƒ¨ä¸–ç•Œå¹¶æ‰§è¡Œå®é™…æ“ä½œã€‚</p>
<p>ç°é˜¶æ®µæ¥è¯´ï¼ŒToolsæ˜¯AgentçœŸæ­£çš„æ ¸å¿ƒï¼Œè€Œä¸”<strong>Toolsè°ƒç”¨ä¸å‡†ä¹Ÿæ˜¯Agentæ¶æ„æœ€å¤§çš„éš¾ç‚¹</strong>ï¼Œå½“å‰æˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨<strong>SkillsæŠ€æœ¯ + å¼ºæ„å›¾</strong>ä¹Ÿæœ€å¤šæŠŠå‡†ç¡®ç‡åšåˆ°90%å·¦å³ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ•´ä¸ªAgentçš„æˆç†Ÿè¿˜ä»»é‡é“è¿œã€‚</p>
<p><strong>ä¸‰ã€ç¼–æ’å±‚ï¼š</strong></p>
<p>Agentçš„â€œå¤§è„‘â€ï¼Œè´Ÿè´£ç¼–å†™æç¤ºè¯ã€æ‰§è¡Œæ¨ç†æ¡†æ¶ã€ç»´æŠ¤å¯¹è¯çŠ¶æ€å’Œè°ƒç”¨å·¥å…·ã€‚è¯¥å±‚å®ç°äº†æ™ºèƒ½ä½“çš„è®¡åˆ’ã€æ¨ç†ã€å†³ç­–å’Œåé¦ˆå¾ªç¯ã€‚</p>
<p>è¿™æ ·è¯´å¤§å®¶å¯èƒ½å¬ä¸æ‡‚ï¼Œä¹Ÿå°±æ˜¯ReActæ¶æ„å°±æ˜¯è¿™é‡Œçš„ç¼–æ’å±‚äº†ï¼Œä¹Ÿæ˜¯ä¸»è¦ä»£ç ç»„æˆéƒ¨åˆ†ï¼š</p>
<ol>
<li>è´Ÿè´£ç»„ç»‡å†å²å¯¹è¯ï¼ˆçŠ¶æ€ï¼‰ï¼›</li>
<li>å†³å®šä»€ä¹ˆæ—¶å€™è°ƒç”¨æ¨¡å‹ï¼Œä»€ä¹ˆæ—¶å€™è°ƒç”¨å·¥å…·ï¼›</li>
<li>å†³å®šä»€ä¹ˆæ—¶å€™ç»“æŸæ¨ç†ï¼›</li>
<li>å†³å®šæ€ä¹ˆæ‹¼æç¤ºè¯ï¼›</li>
</ol>
<p>ä»–å®šä¹‰â€œæ¯ä¸€è½®â€é‡Œçš„è¯­è¨€ç”Ÿæˆç»“æ„ï¼ˆThoughtã€Actionã€Observationï¼‰</p>
<p>... â†’ æ¨ç†(Thought) â†’ è¡ŒåŠ¨(Action) â†’ è§‚å¯Ÿ(Observation) â†’ ...</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1df37666f564e11964db44927fa616f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=zd21PsiSQI3%2FKA8%2BkIgJkLQEUBk%3D" alt="" loading="lazy"/></p>
<p>ReAct = Reason + Actï¼š</p>
<ol>
<li><strong>Reasoningï¼š</strong> è®©LLMæ€è€ƒ"ä¸ºä»€ä¹ˆ"å’Œ"å¦‚ä½•"æ‰§è¡Œè¡ŒåŠ¨ï¼›</li>
<li><strong>Actingï¼š</strong> è®©LLMæ‰§è¡Œå…·ä½“è¡ŒåŠ¨å¹¶ä¸ç¯å¢ƒäº¤äº’ï¼›</li>
<li><strong>å¾ªç¯åé¦ˆï¼š</strong> é€šè¿‡è§‚å¯Ÿç»“æœé©±åŠ¨ä¸‹ä¸€æ­¥æ¨ç†ï¼›</li>
</ol>
<p><strong>å››ã€è®°å¿†å±‚ï¼š</strong></p>
<p>åŒ…æ‹¬çŸ­æœŸè®°å¿†ï¼ˆå¯¹è¯ä¸Šä¸‹æ–‡ã€è¿‘æœŸäº¤äº’ï¼‰å’Œé•¿æœŸè®°å¿†ï¼ˆçŸ¥è¯†åº“ã€å†å²æ•°æ®ã€ä¸ªäººåå¥½ç­‰ï¼‰ã€‚è®°å¿†å±‚ç”¨äºå­˜å‚¨å’Œæ£€ç´¢ä¸ä»»åŠ¡ç›¸å…³çš„ä¿¡æ¯ï¼Œä»¥æ”¯æŒå¤šè½®äº¤äº’å’ŒçŸ¥è¯†è¡¥å……ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eeb36ddef37f4e059870d8986c99c6dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=k4vToPwg07o%2F%2BwYPiLHwp5aL87s%3D" alt="" loading="lazy"/></p>
<p>ä¸¥æ ¼æ¥è¯´ï¼ŒAgentæœ€æ¼ç«çš„å°±æ˜¯è®°å¿†å±‚çš„å¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šä¸‹æ–‡å·¥ç¨‹çš„æœ¬èº«ï¼Œä»–éœ€è¦è§£å†³<strong>æ•°æ®åº”è¯¥å¦‚ä½•ä¸AIäº¤äº’ï¼Œä¿è¯æ¯æ¬¡AIéƒ½èƒ½æ‹¿åˆ°ç›¸å…³æ•°æ®ã€‚</strong> è¿™é‡Œå±•å¼€æœ‰ä¸‰ç‚¹ï¼š</p>
<ol>
<li><strong>æ¯æ¬¡æ£€ç´¢èƒ½ä¸èƒ½æ‹¿åˆ°å¯¹åº”çš„æ•°æ®</strong>ï¼›</li>
<li><strong>æ•°æ®æ˜¯ä¸æ˜¯åˆé€‚</strong>ï¼Œè¿™å—çš„åˆé€‚åŒ…æ‹¬ä¼šä¸ä¼šå¤šã€ä¼šä¸ä¼šå°‘ï¼Œå¤šäº†è´¹Tokenæ˜¯å°äº‹ï¼Œä½†å¯èƒ½å¹²æ‰°æ¨¡å‹ã€å°‘äº†å°±å®¹æ˜“å‡ºé—®é¢˜ï¼›</li>
<li><strong>ç”Ÿæˆå¯¹ä¸å¯¹</strong>ï¼Œè¿™ä¸ªå»ºç«‹åœ¨æ£€ç´¢æ­£ç¡®ï¼Œæ•°æ®ç»„ç»‡æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œæ¨¡å‹æœ€ç»ˆè¾“å‡ºæ˜¯ä¸æ˜¯ç¬¦åˆé¢„æœŸï¼›</li>
</ol>
<p>è¿™é‡Œæ˜¯æ•´ä½“çš„äº¤äº’æ¶æ„å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d055103a6ca4985a99a81d4485a765e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=ozaA16tz%2FzzHPz7cB0bOCHm2ce8%3D" alt="" loading="lazy"/></p>
<p>å›¾ç¤ºè€Œè¨€ï¼ŒAgentæ‰§è¡Œæµç¨‹å¯æ¦‚æ‹¬ä¸ºï¼š<strong>ç”¨æˆ·è¾“å…¥ â†’ ç¼–æ’å±‚å¤„ç† â†’ æ¨¡å‹ç”Ÿæˆæ€è·¯ â†’ å†³ç­–è°ƒç”¨å·¥å…·æˆ–è¾“å‡ºç»“æœ â†’ å·¥å…·æ‰§è¡Œè·å¾—åé¦ˆ â†’ æ›´æ–°è®°å¿†å¹¶ç»§ç»­å¾ªç¯ï¼Œç›´è‡³ç›®æ ‡å®Œæˆ</strong>ã€‚</p>
<p>åœ¨ ReAct æ¡†æ¶ä¸‹ï¼ŒAgenté‡å¤æ‰§è¡Œ<strong>æ€è€ƒï¼ˆThoughtï¼‰â†’è¡ŒåŠ¨ï¼ˆActionï¼‰â†’è§‚å¯Ÿï¼ˆObservationï¼‰</strong> çš„å¾ªç¯ï¼Œç›´åˆ°äº§ç”Ÿæœ€ç»ˆç­”æ¡ˆã€‚</p>
<p>æœ€åï¼Œä¸å•çº¯çš„æ¨¡å‹ï¼ˆLLMï¼‰ç›¸æ¯”ï¼ŒAgentæœ‰ä»¥ä¸‹å…³é”®åŒºåˆ«ï¼š</p>
<ol>
<li><strong>çŸ¥è¯†æ¥æºï¼š</strong> æ¨¡å‹åªèƒ½ä¾èµ–äºè®­ç»ƒæ•°æ®ï¼ŒçŸ¥è¯†é™æ€ï¼›è€ŒAgenté€šè¿‡å·¥å…·æ‰©å±•çŸ¥è¯†ï¼Œå¯ä»¥å®æ—¶è®¿é—®å¤–éƒ¨ä¿¡æ¯ã€‚</li>
<li><strong>ä¸Šä¸‹æ–‡ç®¡ç†ï¼š</strong> æ¨¡å‹å•æ¬¡æ¨ç†æ²¡æœ‰ä¼šè¯è®°å¿†ï¼›Agentå¯ä»¥ç»´æŠ¤äº¤äº’å†å²ï¼Œå®ç°å¤šè½®è¿ç»­å¯¹è¯ã€‚</li>
<li><strong>æ¨ç†æ¡†æ¶ï¼š</strong> æ¨¡å‹è¾“å‡ºç»“æœå¾€å¾€ä¾èµ–å•ä¸€æç¤ºï¼›Agentå…·å¤‡å†…ç½®çš„è®¤çŸ¥æ¶æ„å’Œæ¨ç†ç­–ç•¥ï¼ˆå¦‚é“¾å¼æ€ç»´ã€åæ€æ¡†æ¶ã€æ ‘å¼æ€ç»´ç­‰ï¼‰ï¼Œèƒ½å¤Ÿåœ¨ç¼–æ’å±‚ä¸­å¾ªç¯è¿­ä»£æ¨ç†æ­¥éª¤ï¼›</li>
</ol>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å…·ä½“å±•å¼€è¯´ä¸‹Agentçš„å››ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š</p>
<h2 data-id="heading-2">ç¼–æ’å±‚ä¸è®¤çŸ¥æ¶æ„</h2>
<p>ç¼–æ’å±‚æ˜¯æ™ºèƒ½ä½“ç³»ç»Ÿçš„æ ¸å¿ƒæ§åˆ¶å•å…ƒï¼Œè´Ÿè´£ç»„ç»‡ä¿¡æ¯æµå’Œæ‰§è¡Œæ¨ç†å¾ªç¯ã€‚å®ƒæ¨¡æ‹Ÿäººç±»åœ¨åšå¤æ‚ä»»åŠ¡æ—¶çš„è®¤çŸ¥è¿‡ç¨‹ï¼šå…ˆè·å–ä¿¡æ¯ã€ç„¶ååˆ¶å®šè®¡åˆ’ã€æ‰§è¡Œè¡ŒåŠ¨ã€å†æ ¹æ®åé¦ˆè°ƒæ•´è®¡åˆ’ï¼Œä¸æ–­å¾ªç¯ç›´åˆ°å®Œæˆç›®æ ‡ã€‚</p>
<p>ä¸€ä¸ªå¸¸è§çš„æ¯”å–»æ˜¯ <strong>â€œå¨å¸ˆå‡†å¤‡å¤æ‚èœå“â€</strong> ï¼šå¨å¸ˆä¼šæ ¹æ®é¡¾å®¢éœ€æ±‚è·å–é£Ÿæä¿¡æ¯ï¼Œæ€è€ƒçƒ¹é¥ªæ­¥éª¤ï¼Œç„¶åå®é™…çƒ¹é¥ªï¼Œè¿‡ç¨‹ä¸­å¯èƒ½æ ¹æ®å‘³é“åé¦ˆä¸æ–­è°ƒæ•´æ–¹æ³•ã€‚</p>
<p>ç±»ä¼¼çš„ï¼ŒAgentçš„ç¼–æ’å±‚ä¼šæŒ‰ç…§è®¾å®šçš„æ¨ç†æ¡†æ¶åå¤è¿­ä»£ï¼Œé©±åŠ¨æ¨¡å‹ç”Ÿæˆâ€œæ€è€ƒâ€å¹¶åšå‡ºâ€œè¡ŒåŠ¨â€å†³ç­–ã€‚</p>
<p>å¸¸è§çš„æ¨ç†æ¡†æ¶å¤§åŒå°å¼‚ï¼Œè¿™é‡Œä¸€å®šéœ€è¦äº†è§£çš„æ˜¯ä¸¤ä¸ªä¸œè¥¿<strong>ReActä¸CoT</strong>ï¼Œé™¤æ­¤ä¹‹å¤–å¯ä»¥å»¶ä¼¸åˆ°ToTï¼š</p>
<p><strong>ReAct</strong>åœ¨å‰é¢æˆ‘ä»¬åšäº†åŸºç¡€ä»‹ç»ï¼Œè¯¥æ¡†æ¶<strong>å¼ºè°ƒæ¨¡å‹åœ¨å›ç­”å‰è¿›è¡Œè¿ç»­çš„å†…çœå’Œè¡ŒåŠ¨é€‰æ‹©ï¼Œæœ‰åŠ©äºæé«˜ç­”æ¡ˆçš„å‡†ç¡®åº¦å’Œå¯è¿½æº¯æ€§</strong>ï¼›</p>
<p><strong>CoTï¼ˆæ€ç»´é“¾ï¼‰</strong> å¼•å¯¼æ¨¡å‹é€šè¿‡ç”Ÿæˆä¸­é—´æ¨ç†æ­¥éª¤æ¥åˆ†è§£é—®é¢˜ï¼Œä¿ƒä½¿å…¶åœ¨æœ€ç»ˆç­”æ¡ˆå‰å…ˆåˆ—ä¸¾æ€è€ƒè¿‡ç¨‹ï¼Œè¿™ç§æ¡†æ¶å¯ä»¥<strong>å¢å¼ºæ¨¡å‹è§£å†³å¤æ‚é—®é¢˜æ—¶çš„å‡†ç¡®æ€§</strong>ï¼ˆå¹»è§‰é—®é¢˜ï¼‰ã€‚</p>
<p><strong>ToTï¼ˆæ€ç»´æ ‘ï¼‰</strong> æ˜¯åœ¨ CoT çš„åŸºç¡€ä¸Šï¼Œå…è®¸æ¨¡å‹åœ¨å¤šä¸ªå¤‡é€‰æ€è·¯é—´åšæ¯”è¾ƒï¼Œé€‚ç”¨äºéœ€è¦æ¢ç´¢å¤šç§æ–¹æ¡ˆçš„ç­–ç•¥æ€§ä»»åŠ¡ï¼Œç›®çš„ä¾æ—§æ˜¯æå‡å¯¹å¤æ‚é—®é¢˜çš„è§£å†³èƒ½åŠ›ã€‚</p>
<p>ç¯‡å¹…æœ‰é™ï¼Œæˆ‘ä»¬åªè®¨è®ºReActå’ŒCoTçš„é…åˆå³å¯ï¼ˆå…¶ä»–çš„éƒ½ç±»ä¼¼ï¼‰ï¼š</p>
<h3 data-id="heading-3">ReActå’ŒCoT</h3>
<p>é¦–å…ˆï¼ŒReActä¸CoTéƒ½æ˜¯æ¨ç†ç­–ç•¥æ¡†æ¶ä¹Ÿå°±æ˜¯Agentå››å¤§ç»„ä»¶æ ¸å¿ƒçš„ç¼–æ’å±‚å…·è±¡åŒ–å®ç°ï¼Œä»–ä»¬éƒ½æè¿°çš„æ˜¯<strong>å¦‚ä½•ç»„ç»‡æ¨¡å‹çš„æ¨ç†è¿‡ç¨‹ã€ç”Ÿæˆæ­¥éª¤ã€æç¤ºè¯ç»“æ„ã€‚</strong></p>
<p>æ¢å¥è¯è¯´ï¼ŒReActæ˜¯ä»£ç çš„æ ¸å¿ƒï¼Œæ˜¯AIå·¥ç¨‹çš„æ ¸å¿ƒï¼Œä»–ä¼šå†³å®šå¦‚ä½•å»ä¸è®°å¿†ç³»ç»Ÿã€å·¥å…·ç³»ç»Ÿåšé…åˆã€‚</p>
<p>ç„¶åï¼ŒReActé€»è¾‘ä¸Šä¸CoTæ˜¯åŒçº§åˆ«çš„ï¼Œä½†ç°åœ¨æ›´å¤šçš„æ˜¯åœ¨ç»„åˆä½¿ç”¨ï¼Œæ˜¾å¾—CoTæ˜¯ReActçš„ä¸€ä¸ªè¿‡ç¨‹äº§ç‰©ï¼Œå…¶å®å¹¶ä¸æ˜¯çš„ï¼Œé€»è¾‘ä¸ŠCoTä¹Ÿå¯ä»¥è°ƒç”¨å·¥å…·ï¼›</p>
<p>åªä¸è¿‡ç°åœ¨ä»æµè¡ŒèŒƒå¼çš„è§’åº¦æ¥è¯´ï¼ŒReActè¢«ç”¨ä½œä¸»æ¡†æ¶çš„æ—¶é—´ä¼šå¤šä¸€ç‚¹ï¼Œå¹¶ä¸”è¿‡ç¨‹ä¸­ä¼šåŒ…å«å¾ˆå¤šCoTçš„éƒ¨åˆ†ï¼Œè¿™é‡Œçš„ç»“æœæ˜¯ï¼š<strong>ReAct æ˜¯å®¹å™¨ï¼ŒCoT æ˜¯å†…å®¹ã€‚ReAct æ˜¯æœ€â€œAgentâ€åŒ–çš„ã€CoT æ˜¯æœ€åŸºç¡€çš„</strong>ã€‚</p>
<blockquote>
<p>ReAct è§„å®šäº†ï¼šå…ˆæ€è€ƒï¼ˆThoughtï¼‰â†’ è¡ŒåŠ¨ï¼ˆActionï¼‰â†’ ç­‰å¾…ç»“æœï¼ˆObservationï¼‰â†’ å†æ€è€ƒ...</p>
<p>è€Œè¿™ä¸ªâ€œThoughtâ€æ€ä¹ˆå†™ï¼Ÿé€šå¸¸å°±æ˜¯ä¸€ä¸ª Chain of Thought æ¨ç†å—ã€‚</p>
</blockquote>
<p>ä¸¾ä¸ªç®€å•ä¾‹å­ï¼š</p>
<p>è®© Agent å›ç­” <strong>â€œæŸå…¬å¸å‘˜å·¥è¯·å‡æµç¨‹â€</strong> çš„é—®é¢˜ï¼ŒAgent éœ€è¦ï¼š</p>
<ol>
<li>è¯»å–ç”¨æˆ·çš„é—®é¢˜</li>
<li>ä»çŸ¥è¯†åº“ä¸­æ£€ç´¢æ–‡æ¡£</li>
<li>åˆ†æå†…å®¹ç»“æ„</li>
<li>è¾“å‡ºæ¸…æ™°æ­¥éª¤</li>
</ol>
<p>è¿™å—çš„ç®€è¦æµç¨‹æ˜¯ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">User: æˆ‘æƒ³è®¢ä¸€å¼ ä¸‹å‘¨ä»åŒ—äº¬åˆ°ä¸Šæµ·çš„æœºç¥¨ã€‚  </span>
<span class="hljs-section">Thought: æˆ‘éœ€è¦æŸ¥è¯¢èˆªç­ä¿¡æ¯å¹¶è¿›è¡Œæ¯”è¾ƒã€‚  </span>
<span class="hljs-section">Action: è°ƒç”¨ã€èˆªç­æœç´¢ã€‘å·¥å…·  </span>
Action Input: {<span class="hljs-string">"from"</span>:Â <span class="hljs-string">"åŒ—äº¬"</span>,Â <span class="hljs-string">"to"</span>:Â <span class="hljs-string">"ä¸Šæµ·"</span>,Â <span class="hljs-string">"date"</span>:Â <span class="hljs-string">"ä¸‹å‘¨"</span>}  
<span class="hljs-section">Observation: èˆªç­å·¥å…·è¿”å›äº†å¤šç­æ¬¡èˆªç­ä¿¡æ¯ã€‚  </span>
<span class="hljs-section">Thought: æˆ‘åº”è¯¥æŒ‘é€‰ä»·æ ¼å’Œæ—¶é—´åˆé€‚çš„èˆªç­ã€‚  </span>
Final Answer: æ ¹æ®æŸ¥è¯¢ç»“æœï¼Œä¸‹å‘¨ä»åŒ—äº¬åˆ°ä¸Šæµ·çš„èˆªç­æœ‰...ï¼ˆåˆ—å‡ºä¿¡æ¯ï¼‰ã€‚
</code></pre>
<p>è¿™ä¸ª â€œStep 2â€ çš„ Thought éƒ¨åˆ†å°±æ˜¯ä¸€ä¸ªç®€å•çš„Â <strong>CoT</strong>ï¼Œæ¨¡å‹åœ¨æ²¡æœ‰è¡ŒåŠ¨å‰ï¼Œåˆ†æ­¥æ€è€ƒã€æå–ã€ç»„ç»‡ä¿¡æ¯ï¼Œè¿™æ˜¯å…¸å‹çš„æ€ç»´é“¾ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¿™ä¹ˆç”¨ä¹Ÿå¾ˆç®€å•ï¼šAgentæ¶æ„ä¸­ä¹Ÿä¸å¯èƒ½æ¯ä¸€æ­¥éƒ½è°ƒç”¨å·¥å…·ï¼Œå¾ˆå¤šæ—¶å€™åªæ˜¯åœ¨â€œç»„ç»‡æ€ç»´/è¯­è¨€â€ï¼ŒCoTå¯ä»¥æœ‰æ•ˆé™ä½å¹»è§‰ç‡ã€‚</p>
<p>æ€»è€Œè¨€ä¹‹ï¼ŒReAct æ¡†æ¶é‡Œå¯ä»¥æœ‰å¾ˆå¤š CoT å†…å®¹ç©¿æ’å…¶ä¸­ï¼Œè¿™ç§ç»„åˆä¹Ÿæ˜¯æœ€å¸¸è§ã€æœ€ç¨³çš„åšæ³•ï¼Œå¤§å®¶è®°ä½è¿™ç‚¹å°±è¡Œï¼Œè¿™å°±æ˜¯Agentçš„ç¼–æ’å±‚ã€‚</p>
<p>å†ç»“åˆGoogleæŠ¥å‘Šçš„æ¡ˆä¾‹ï¼Œå¤§å®¶åº”è¯¥å¯ä»¥å®Œå…¨ç†è§£äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c459dc038fff4152b7708bce8941e39f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=4UtSg9kC29am1%2BWzBOR3Hpl0SVo%3D" alt="" loading="lazy"/>```plaintext User: æˆ‘æƒ³è®¢ä¸€å¼ ä¸‹å‘¨ä»åŒ—äº¬åˆ°ä¸Šæµ·çš„æœºç¥¨ã€‚Thought: æˆ‘éœ€è¦æŸ¥è¯¢èˆªç­ä¿¡æ¯å¹¶è¿›è¡Œæ¯”è¾ƒã€‚Action: è°ƒç”¨ã€èˆªç­æœç´¢ã€‘å·¥å…·Action Input: {"from": "åŒ—äº¬", "to": "ä¸Šæµ·", "date": "ä¸‹å‘¨"}Observation: èˆªç­å·¥å…·è¿”å›äº†å¤šç­æ¬¡èˆªç­ä¿¡æ¯ã€‚Thought: æˆ‘åº”è¯¥æŒ‘é€‰ä»·æ ¼å’Œæ—¶é—´åˆé€‚çš„èˆªç­ã€‚Final Answer: æ ¹æ®æŸ¥è¯¢ç»“æœï¼Œä¸‹å‘¨ä»åŒ—äº¬åˆ°ä¸Šæµ·çš„èˆªç­æœ‰...ï¼ˆåˆ—å‡ºä¿¡æ¯ï¼‰ã€‚</p>
<h3 data-id="heading-4">çŠ¶æ€ç®¡ç†</h3>
<p>é™¤åŸºæœ¬æ¡†æ¶ä¹‹å¤–ï¼Œç¼–æ’å±‚è¿˜è´Ÿè´£ç»´æŠ¤<strong>äº¤äº’çŠ¶æ€å’Œå†å²è®°å¿†</strong>ã€‚</p>
<p>ä¸æ¨¡å‹çš„å•è½®å¯¹è¯ä¸åŒï¼ŒAgentéœ€è¦ç®¡ç†å¯¹è¯å†å²ï¼Œå°†å…ˆå‰çš„å¯¹è¯å†…å®¹ã€ç”¨æˆ·æŒ‡ä»¤å’Œå·¥å…·åé¦ˆçº³å…¥çŠ¶æ€ï¼Œå¦åˆ™çš„è¯å¤šè½®å¯¹è¯å°±ä¼šèƒ¡è¨€ä¹±è¯­ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨å’¨è¯¢ç±»å¯¹è¯ä¸­ï¼ŒAgentä¼šè®°ä½ç”¨æˆ·ä¹‹å‰çš„é—®é¢˜å’Œä¸Šä¸‹æ–‡ï¼Œä¸æ–­ç§¯ç´¯ä¿¡æ¯ï¼Œè¿™å¯¹è§£å†³å¤æ‚é—®é¢˜å’Œæä¾›è¿ç»­æœåŠ¡è‡³å…³é‡è¦ã€‚</p>
<p>æ€»ä¹‹ï¼Œç¼–æ’å±‚å°±åƒAgentçš„â€œå¤§è„‘â€ï¼Œé€šè¿‡å¾ªç¯çš„åé¦ˆæœºåˆ¶å’Œæç¤ºå·¥ç¨‹æ¡†æ¶ï¼Œå¼•å¯¼æ¨¡å‹åˆç†åˆ©ç”¨å·²æœ‰ä¿¡æ¯å’Œå·¥å…·ä¸€æ­¥æ­¥å®ç°ç›®æ ‡ã€‚</p>
<p>çŠ¶æ€ç®¡ç†å¥½åç›´æ¥å…³ç³»åˆ°Agentäº§å“çš„æœ€ç»ˆè¡¨ç°ï¼Œåªä¸è¿‡è¿™é‡Œçš„<strong>çŠ¶æ€ç®¡ç†æå…¶å›°éš¾</strong>ï¼Œå¦‚æœå±•å¼€çš„è¯ä¸‡å­—éƒ½æ‹¿ä¸ä¸‹æ¥...</p>
<h2 data-id="heading-5">å·¥å…·ä½“ç³»</h2>
<p><strong>å·¥å…·æ˜¯æ¨¡å‹ä¸å¤–éƒ¨ä¸–ç•Œä¹‹é—´çš„æ¡¥æ¢ï¼Œä½¿å¾—Agentå¯ä»¥è®¿é—®å¹¶å¤„ç†çœŸå®ä¿¡æ¯</strong></p>
<p>æ ¹æ®æˆ‘ä¹‹å‰çš„å®è·µç»éªŒï¼š<strong>Agentæœ€éš¾çš„éƒ¨åˆ†æ˜¯çŠ¶æ€ç®¡ç†ï¼Œæœ€çƒ¦ï¼ˆä¸ç¨³å®šï¼‰çš„éƒ¨åˆ†æ˜¯æ„å›¾è¯†åˆ«ï¼Œå·¥ä½œé‡æœ€å¤§çš„éƒ¨åˆ†æ˜¯å·¥å…·ä½“ç³»...</strong></p>
<p>å¸¸è§çš„å·¥å…·ç±»å‹åŒ…æ‹¬ æ‰©å±•ï¼ˆExtensionsï¼‰ã€å‡½æ•°è°ƒç”¨ï¼ˆFunctionsï¼‰ å’Œ æ•°æ®å­˜å‚¨ï¼ˆData Storesï¼‰ ç­‰ï¼Œå®ƒä»¬å„è‡ªæ‰¿æ‹…ä¸åŒèŒè´£ï¼Œå…±åŒæ„å»ºäº†æ™ºèƒ½ä½“ä¸å¤–éƒ¨ç¯å¢ƒäº¤äº’çš„èƒ½åŠ›ã€‚ä¸‹é¢åˆ†åˆ«ä»‹ç»è¿™å‡ ç§å·¥å…·ç±»å‹:</p>
<h3 data-id="heading-6">æ‰©å±•</h3>
<p>æ‰€è°“æ‰©å±•ä¹Ÿå°±æ˜¯<strong>æå‰é…ç½®å¥½çš„ä¸€æ‰¹å¯è°ƒç”¨ API æ¨¡å— + æ¨¡å‹èƒ½çœ‹æ‡‚çš„è°ƒç”¨è¯´æ˜</strong>ï¼Œå…¶åº•å±‚åŸºç¡€æ˜¯æ¨¡å‹çš„Function Callingï¼Œç›®çš„æ˜¯è®©æ¨¡å‹ä¸éœ€è¦çŸ¥é“å¾ˆå¤š API çš„ç»†èŠ‚ï¼Œåªéœ€è¦ç»™å…³é”®è¯ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">Action:</span> èˆªç­æŸ¥è¯¢ Â   
Action Input: {<span class="hljs-keyword">from</span>:Â <span class="hljs-string">"åŒ—äº¬"</span>, <span class="hljs-keyword">to</span>:Â <span class="hljs-string">"ä¸Šæµ·"</span>, <span class="hljs-type">date</span>:Â <span class="hljs-string">"2025-12-10"</span>}
</code></pre>
<p>è¿™é‡Œå†ç»™ä¸€ä¸ªé…ç½®ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-css" lang="css">{  
Â Â "name":Â <span class="hljs-string">"search_flights"</span>,  
<span class="hljs-string">"description"</span>:Â <span class="hljs-string">"æŸ¥è¯¢æŒ‡å®šæ—¥æœŸçš„èˆªç­ä¿¡æ¯"</span>,  
<span class="hljs-string">"params"</span>: {  
Â  Â Â "<span class="hljs-selector-tag">from</span>":Â <span class="hljs-string">"å‡ºå‘åŸå¸‚"</span>,  
Â  Â Â <span class="hljs-string">"to"</span>:Â <span class="hljs-string">"ç›®çš„åŸå¸‚"</span>,  
Â  Â Â <span class="hljs-string">"date"</span>:Â <span class="hljs-string">"å‡ºå‘æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰"</span>  
Â  },  
"example_calls": [  
Â  Â  {  
Â  Â  Â Â "user_input":Â <span class="hljs-string">"æˆ‘æƒ³æŸ¥æ˜å¤©ä»åŒ—äº¬é£ä¸Šæµ·çš„èˆªç­"</span>,  
Â  Â  Â Â <span class="hljs-string">"action"</span>:Â <span class="hljs-string">"search_flights"</span>,  
Â  Â  Â Â <span class="hljs-string">"action_input"</span>: {  
Â  Â  Â  Â Â "<span class="hljs-selector-tag">from</span>":Â <span class="hljs-string">"åŒ—äº¬"</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"to"</span>:Â <span class="hljs-string">"ä¸Šæµ·"</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"date"</span>:Â <span class="hljs-string">"2025-12-10"</span>  
Â  Â  Â  }  
Â  Â  }  
Â  ]  
}
</code></pre>
<h3 data-id="heading-7">å‡½æ•°è°ƒç”¨</h3>
<p>å‡½æ•°è°ƒç”¨ä¸æ‰©å±•ç±»ä¼¼ï¼ˆéƒ½æ˜¯Function Callingï¼‰ï¼Œä¹Ÿæ˜¯æä¾›ç»™æ¨¡å‹è°ƒç”¨å¤–éƒ¨åŠŸèƒ½çš„æ¥å£ï¼Œä½†å®ƒæ›´ä¾§é‡äºå®¢æˆ·ç«¯ï¼ˆåº”ç”¨ç«¯ï¼‰æ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨æ™ºèƒ½ä½“æœåŠ¡å™¨ç«¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a27b659824fd4b339c877fab8a0733ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=htyKwzzKB2SfSNrXkmxpNKTHsOU%3D" alt="" loading="lazy"/></p>
<p>ä¸æ‰©å±•å¯¹æ¯”çš„ä¸»è¦å·®åˆ«åœ¨äºï¼Œæ‰©å±•åœ¨æ™ºèƒ½ä½“ç«¯æ‰§è¡Œè°ƒç”¨å¤–éƒ¨æœåŠ¡ï¼Œè€Œå‡½æ•°åœ¨å®¢æˆ·ç«¯æ‰§è¡Œã€‚è¿™æ„å‘³ç€å³ä½¿æ¨¡å‹é€‰æ‹©äº†æŸä¸ªå‡½æ•°ï¼Œå®é™…çš„ API è°ƒç”¨å¯èƒ½ä¼šåœ¨å¦ä¸€ä¸ªæœåŠ¡å±‚é¢å®Œæˆã€‚</p>
<p>è¿™é‡Œå¤§å®¶è¯»èµ·æ¥å¯èƒ½æœ‰ç‚¹ç»•ï¼Œå› ä¸ºæ‰©å±•å’Œå‡½æ•°ç›¸ä¼¼åº¦å¾ˆé«˜ï¼Œæˆ‘ä»¬è¿™é‡Œåšä¸‹ä¸¾ä¾‹è¯´æ˜ï¼š</p>
<p>æ‰©å±•å±äºç³»ç»Ÿè‡ªå·±å¹²ï¼Œä½ è¯´â€œå¸®æˆ‘æŸ¥å¤©æ°”â€ï¼Œå®ƒè‡ªå·±è°ƒæ¥å£ã€è‡ªå·±æ‹¿æ•°æ®ã€è‡ªå·±å¹²ï¼š</p>
<pre><code class="hljs">æ¨¡å‹ï¼šæˆ‘éœ€è¦æŸ¥ä¸‹å¤©æ°”  
Agentç³»ç»Ÿï¼šå¥½çš„ï¼Œæˆ‘æœ‰æ‰‹ï¼Œæˆ‘æ¥è°ƒ API weather.com è·å–æ•°æ®
</code></pre>
<p>å‡½æ•°æ˜¯æ¨¡å‹è‡ªå·±ä¸åšäº‹ï¼Œå®ƒåªæ˜¯å‘Šè¯‰ä½ â€œä½ å»åšâ€ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">æ¨¡å‹ï¼šæˆ‘å»ºè®®è°ƒç”¨å‡½æ•° <span class="hljs-built_in">playVideo</span>({videoId: <span class="hljs-number">123</span>})  
åº”ç”¨å‰ç«¯ï¼šæ”¶åˆ°ï¼Œæˆ‘æ¥æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼ˆæ¯”å¦‚è°ƒæ’­æ”¾å™¨ï¼‰
</code></pre>
<p>è¿™ç§å·®å¼‚çš„åŸå› æ˜¯<strong>å®‰å…¨æ€§ã€ç¦»çº¿ã€å¼‚æ­¥</strong>ç­‰åŸå› ï¼Œä¸­æ–­å¼è°ƒç”¨ç”¨å‡½æ•°ï¼Œéä¸­æ–­å¼ç”¨æ‰©å±•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ‰©å±•æ¡ˆä¾‹ï¼š  </span>
Action: query_weather  
Action Input: {<span class="hljs-string">"city"</span>:Â <span class="hljs-string">"åŒ—äº¬"</span>,Â <span class="hljs-string">"date"</span>:Â <span class="hljs-string">"2025-12-10"</span>}  
  
<span class="hljs-comment"># Agentç³»ç»Ÿé€»è¾‘ï¼ˆè‡ªåŠ¨æ‰§è¡Œï¼‰ï¼š  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">agent_runtime</span>():  
Â  Â Â <span class="hljs-keyword">if</span>Â action ==Â <span class="hljs-string">"query_weather"</span>:  
Â  Â  Â  Â  result = requests.get(<span class="hljs-string">f"https://api.weather.com?city=<span class="hljs-subst">{city}</span>&amp;date=<span class="hljs-subst">{date}</span>"</span>)  
Â  Â  Â  Â  send_back_to_model(result)  
  
<span class="hljs-comment"># å‡½æ•°æ¡ˆä¾‹ï¼Œä¸­æ–­å¼ï¼š  </span>
Function Call: open_camera  
Args: {<span class="hljs-string">"resolution"</span>:Â <span class="hljs-string">"1080p"</span>}  
  
<span class="hljs-comment"># å®¢æˆ·ç«¯ / æµè§ˆå™¨æ‰§è¡Œï¼ˆä½ æ¥å†™ï¼‰ï¼š  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">on_function_call</span>(<span class="hljs-params">fn_name, args</span>):  
Â  Â Â <span class="hljs-keyword">if</span>Â fn_name ==Â <span class="hljs-string">"open_camera"</span>:  
Â  Â  Â  Â  open_webcam(args[<span class="hljs-string">"resolution"</span>])
</code></pre>
<h3 data-id="heading-8">æ•°æ®å­˜å‚¨</h3>
<p>æ•°æ®å­˜å‚¨ä¸ºAgentæä¾›äº†â€œé•¿æœŸè®°å¿†â€å’ŒçŸ¥è¯†åº“çš„åŠŸèƒ½ï¼Œç‰¹åˆ«é€‚ç”¨äºéœ€è¦æŸ¥è¯¢å¤§é‡ç»“æ„åŒ–æˆ–éç»“æ„åŒ–ä¿¡æ¯çš„åœºæ™¯ã€‚</p>
<p>æ ¸å¿ƒæ€æƒ³æ˜¯å°†å¤–éƒ¨æ–‡æ¡£æˆ–æ•°æ®åº“è½¬æ¢æˆå‘é‡ç´¢å¼•ï¼Œè®©æ¨¡å‹é€šè¿‡æ£€ç´¢æ¥è·å–æœ€æ–°å†…å®¹ï¼Œä»è€Œæ‰©å±•å…¶çŸ¥è¯†è¾¹ç•Œã€‚å¸¸è§åšæ³•æ˜¯æ„å»ºå‘é‡åº“æˆ–çŸ¥è¯†åº“ï¼Œå°†æ–‡æ¡£ã€ç½‘é¡µã€è¡¨æ ¼ç­‰é¢„å¤„ç†ä¸ºé«˜ç»´åµŒå…¥å­˜å‚¨ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e3242841bc240c7afc91dc58840d06b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=LCr1HyNzY%2B6rims4SnY%2Fh6p3KUU%3D" alt="" loading="lazy"/></p>
<p>ä¾‹å¦‚ï¼Œå¯¹äºå…¬å¸å†…éƒ¨çŸ¥è¯†åº“é—®ç­”ï¼Œæ™ºèƒ½ä½“ä¼šå…ˆå°†ç”¨æˆ·é—®é¢˜è½¬æ¢ä¸ºå‘é‡å¹¶æ£€ç´¢é¢„ç´¢å¼•çš„å†…éƒ¨æ–‡æ¡£ï¼Œå¾—åˆ°çš„ç›¸å…³æ–‡æ¡£æ®µè½ä½œä¸ºè¡¥å……ä¿¡æ¯æä¾›ç»™æ¨¡å‹ã€‚è¿™æ ·ï¼Œç”Ÿæˆçš„å›ç­”å°±åŸºäºæœ€æ–°çš„ä¸šåŠ¡æ‰‹å†Œæˆ–æ³•è§„æ–‡æœ¬ï¼Œè€Œä¸æ˜¯ä»…å‡­æ¨¡å‹è®­ç»ƒæ—¶æœ‰é™çš„æ•°æ®ã€‚</p>
<p>å¦‚å›¾ç¤ºä¾‹æ‰€ç¤ºï¼Œç”¨æˆ·æŸ¥è¯¢â€œå…¬å¸åœ¨åŒ—ç¾çš„æœ€æ–°ä¸šåŠ¡è§„æ¨¡å¦‚ä½•ï¼Ÿâ€ï¼Œæ™ºèƒ½ä½“å…ˆæ£€ç´¢è´¢ç»æŠ¥å‘Šå’Œå¸‚åœºæ•°æ®ï¼Œç„¶ååœ¨ ReAct å¾ªç¯ä¸­åˆ©ç”¨è¿™äº›æ£€ç´¢ç»“æœè¿›è¡Œç»¼åˆæ¨ç†å’Œå›ç­”ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/575a54154d954a65b29b9506299fd796~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766642160&amp;x-signature=ispq7R1s0KAnUQlT4dNsVkINfAU%3D" alt="" loading="lazy"/></p>
<p>å…¶å®ä»è¿™éƒ¨åˆ†å†…å®¹è´¨é‡æ¥è¯´ï¼ŒGoogleçš„æŠ¥å‘Šå†™å¾—æŒºä¸€èˆ¬çš„ï¼Œä½œä¸ºç§‘æ™®è¯»ç‰©æŒºä¸é”™çš„...</p>
<h2 data-id="heading-9">è®°å¿†ç³»ç»Ÿ</h2>
<p>åœ¨Agentç³»ç»Ÿä¸­ï¼Œ<strong>è®°å¿†å±‚</strong>ä¸ä»…è´Ÿè´£ä¿å­˜ä¸Šä¸‹æ–‡ã€æ”¯æ’‘å¤šè½®å¯¹è¯ï¼Œå®ƒæ›´æ·±å±‚çš„èŒè´£ï¼Œæ˜¯å›ç­”è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š</p>
<blockquote>
<p>æ•°æ®å¦‚ä½•ä¸AIäº¤äº’ï¼Œæ‰èƒ½è®©å¤§æ¨¡å‹â€œçœŸæ­£ç†è§£ä»»åŠ¡â€ï¼Ÿ</p>
</blockquote>
<p>è¿™ä¸€é—®é¢˜çš„å›ç­”ï¼Œè¿‘æ¥å¸¸è¢«åŒ…è£…ä¸ºä¸€ä¸ªæ–°æœ¯è¯­ï¼š<strong>ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼ˆContext Engineeringï¼‰ã€‚</strong></p>
<p>ä½†ä»æœ¬è´¨çœ‹ï¼Œå®ƒä»æ˜¯å¯¹â€œå¦‚ä½•æ„é€ æœ‰æ•ˆPromptâ€çš„æ·±åŒ–å’Œç»“æ„åŒ–è®¾è®¡ï¼Œæ˜¯æç¤ºè¯å·¥ç¨‹åœ¨å¤æ‚ä»»åŠ¡è½åœ°åœºæ™¯ä¸‹çš„è‡ªç„¶æ¼”è¿›ã€‚</p>
<h3 data-id="heading-10">ä¸Šä¸‹æ–‡å·¥ç¨‹</h3>
<p>é€šå¸¸æˆ‘ä»¬å°† Agent çš„è®°å¿†ç³»ç»Ÿåˆ’åˆ†ä¸ºä¸¤ä¸ªå±‚æ¬¡ï¼š</p>
<p><strong>ä¸€ã€çŸ­æœŸè®°å¿†ï¼ˆShort-Term Memoryï¼‰</strong></p>
<p>æŒ‡å½“å‰ä¼šè¯çš„ä¸Šä¸‹æ–‡å†å²ï¼ŒåŒ…æ‹¬ç”¨æˆ·è¾“å…¥ã€æ¨¡å‹å›å¤ã€ä¸­é—´æ¨ç†ç—•è¿¹ï¼›</p>
<p>å¤šä¿å­˜åœ¨ç¼–æ’å±‚çš„å¯¹è¯çŠ¶æ€ä¸­ï¼Œç”¨ä½œ Prompt ä¸Šä¸‹æ–‡æ„å»ºã€‚</p>
<p><strong>äºŒã€é•¿æœŸè®°å¿†ï¼ˆLong-Term Memoryï¼‰</strong></p>
<p>æŒ‡è·¨ä¼šè¯çš„çŸ¥è¯†å­˜å‚¨ï¼Œå¦‚ç”¨æˆ·åå¥½ã€å†å²æ•°æ®ã€ç»„ç»‡å†…éƒ¨èµ„æ–™ã€æ–‡æ¡£åº“ç­‰ï¼›</p>
<p>é€šå¸¸é€šè¿‡å‘é‡æ£€ç´¢ï¼ˆRAGï¼‰ç­‰æ–¹å¼åŠ¨æ€å–ç”¨ï¼Œå®ç°åœ¨è¿è¡Œæ—¶â€œè¡¥å…¨çŸ¥è¯†â€ã€‚</p>
<p>ä½†çœŸå®åœºæ™¯ä¸­ï¼Œè®°å¿†ç³»ç»Ÿè¿œä¸æ­¢â€œå­˜+å–â€è¿™ä¹ˆç®€å•ï¼Œå®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯ï¼š</p>
<blockquote>
<p>ä¸ºå¤§æ¨¡å‹æä¾›â€œæ°åˆ°å¥½å¤„â€çš„ä¿¡æ¯ï¼Œæ—¢ä¸è¿‡å¤šæ‰“æ‰°æ¨¡å‹ï¼Œä¹Ÿä¸é—æ¼å…³é”®ä¿¡æ¯</p>
</blockquote>
<p>è¿™å¼•å‡ºäº†â€œä¸Šä¸‹æ–‡å·¥ç¨‹â€çš„å®æ“ä¸‰éš¾ç‚¹ï¼š</p>
<ol>
<li><strong>æ‹¿å¾—åˆ°å—ï¼Ÿ</strong> æ£€ç´¢é€»è¾‘æ˜¯å¦åˆç†ï¼Œæ˜¯å¦æ¼æ‰å…³é”®ä¿¡æ¯ï¼Ÿ</li>
<li><strong>æ‹¿å¾—å‡†å—ï¼Ÿ</strong> å†…å®¹æ˜¯å¦ç›¸å…³ï¼Ÿæ˜¯å¦è¿‡å¤šå¹²æ‰°æ¨¡å‹æˆ–ä¸¥é‡ç¼ºæ¼ï¼Ÿ</li>
<li><strong>ç”¨å¾—å¯¹å—ï¼Ÿ</strong> æœ€ç»ˆç»„ç»‡è¿› Prompt çš„æ–¹å¼æ˜¯å¦æœ‰æ•ˆæ¿€å‘æ¨¡å‹è¾“å‡ºï¼Ÿ</li>
</ol>
<p>ä»å·¥ç¨‹è§’åº¦è®²ï¼Œä¸Šä¸‹æ–‡å°±åƒ Prompt çš„RAMï¼Œå®¹é‡æœ‰é™ä½†ç›´æ¥å†³å®šæ¨¡å‹è¿è¡Œè¡¨ç°ã€‚è®¾è®¡åˆç†çš„ä¸Šä¸‹æ–‡ç»„ç»‡ç­–ç•¥ï¼Œæ˜¯Agentç³»ç»Ÿæœ€é‡è¦çš„ç«äº‰åŠ›ä¹‹ä¸€ã€‚</p>
<p>æ ¹æ®ä¹‹å‰çš„ç»éªŒï¼Œå¯ä»¥æŠŠä¸Šä¸‹æ–‡å·¥ç¨‹æ“ä½œæ¨¡å¼åˆ†ä¸ºå››ç±»ï¼š</p>



































<table><thead><tr><th>æ‰‹æ³•</th><th>æ ¸å¿ƒæ€è·¯</th><th>ç±»æ¯”</th><th>å¸¸è§åœºæ™¯</th></tr></thead><tbody><tr><td><strong>1. è®°å½•å¼ï¼ˆWriteï¼‰</strong></td><td>è®© AI éšæ—¶æŠŠé‡è¦ç»†èŠ‚å†™è¿›â€œéšèº«ç¬”è®°â€</td><td>äººç±»åšä¼šè®®é€Ÿè®°</td><td>ChatGPT å­˜ç”¨æˆ·å¸¸ç‚¹å¤–å–ã€åå¥½ç­‰</td></tr><tr><td><strong>2. ç”„é€‰å¼ï¼ˆSelectï¼‰</strong></td><td>ä»èµ„æ–™ä¸­æŒ‘å‡ºæœ€ relevant çš„å†å–‚ç»™æ¨¡å‹</td><td>å›¾ä¹¦ç®¡ç†å‘˜æ‰¾æŒ‡å®šç« èŠ‚</td><td>Code Agent æ£€ç´¢å‡½æ•°æ–‡ä»¶ã€çŸ¥è¯†ç‚¹</td></tr><tr><td><strong>3. ç²¾ç®€å¼ï¼ˆCompressï¼‰</strong></td><td>å½“ä¿¡æ¯çˆ†æ£šï¼Œç”¨æ‘˜è¦ã€æç‚¼ã€å»å†—ä½™æ‰‹æ®µå‡è½»æ¨¡å‹è´Ÿæ‹…</td><td>ç»™è®ºæ–‡å†™æ‘˜è¦</td><td>Claude å¿«æ»¡çª—å£æ—¶è‡ªåŠ¨å‹ç¼©å†å²å¯¹è¯</td></tr><tr><td><strong>4. åˆ†éš”å¼ï¼ˆIsolateï¼‰</strong></td><td>å°†å¤æ‚ä»»åŠ¡æ‹†åˆ†ç»™å¤šä¸ªâ€œåŠ©æ‰‹â€ï¼Œå„è‡ªè®°å¿†ä¸åŒä¸Šä¸‹æ–‡</td><td>é¡¹ç›®ç»ç†åˆ†æ´¾å­ä»»åŠ¡</td><td>Swarm Agent ä¸­å¤šä¸ªå­æ¨¡å‹åˆ†å·¥åä½œ</td></tr></tbody></table>
<p>è¿™äº›æ–¹æ³•çš„ç»„åˆï¼Œæ„æˆäº†çœŸæ­£èƒ½ç”¨ã€èƒ½è½åœ°çš„ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼Œå…¶å®å¤§å®¶ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥äº†ï¼Œ<strong>å°½ç®¡ä¸Šä¸‹æ–‡å·¥ç¨‹ã€Agentçš„è®°å¿†ç³»ç»Ÿå¬èµ·æ¥å¾ˆå±Œï¼Œå…¶æœ¬è´¨è¿˜æ˜¯å¤æ‚çš„æç¤ºè¯å·¥ç¨‹</strong>...</p>
<p>æœ€åå›å½’åˆ°Â <strong>Agent ReAct æ¡†æ¶</strong>ï¼Œæˆ‘ä»¬å†çœ‹çœ‹å››å¤§ç»„ä»¶çš„å…³ç³»ï¼š</p>
<h3 data-id="heading-11">ReAct æ¡†æ¶ä¸­çš„è®°å¿†å±‚è§’è‰²</h3>
<p>åœ¨ReActæ¡†æ¶ä¸­ï¼Œæ¯ä¸€ä¸ª Thought çš„è´¨é‡ï¼Œä¸¥é‡ä¾èµ–äºCoTï¼Œè€ŒCoTåˆä¸¥é‡ä¾èµ–äºè®°å¿†ç³»ç»Ÿæä¾›çš„ä¿¡æ¯æ˜¯å¦å……è¶³ã€æ˜¯å¦å‡†ç¡®ã€æ˜¯å¦å¹²æ‰°æœ€å°ã€‚</p>
<p>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè®°å¿†ç³»ç»Ÿè´Ÿè´£ä¸º Thought æ„å»ºä¸Šä¸‹æ–‡è¾“å…¥ï¼Œå³ Prompt ä¸­çš„ Memory åŒºå—ã€‚ä¸€ä¸ªå…¸å‹çš„ ReAct è°ƒç”¨é“¾å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">User:</span> <span class="hljs-string">æˆ‘éœ€è¦æ‰¾ä¸€å¼ æ˜å¤©ä¸‹åˆä»åŒ—äº¬å»ä¸Šæµ·çš„é«˜é“ç¥¨</span>  
<span class="hljs-string">-----------------</span>  
<span class="hljs-attr">Thought:</span> <span class="hljs-string">æˆ‘éœ€è¦æŸ¥è¯¢é«˜é“ç¥¨ä¿¡æ¯</span>  
<span class="hljs-attr">Action:</span> <span class="hljs-string">æŸ¥è¯¢é«˜é“</span> <span class="hljs-string">APIï¼ˆè¾“å…¥åŸå¸‚å’Œæ—¶é—´ï¼‰</span>  
<span class="hljs-attr">Observation:</span> <span class="hljs-string">è¿”å›å¤šä¸ªç­æ¬¡å’Œæ—¶é—´æ®µ</span>  
<span class="hljs-attr">Thought:</span> <span class="hljs-string">æˆ‘æŒ‘é€‰ä¸€ä¸ªä¸‹åˆå‡ºå‘ã€ä»·æ ¼åˆé€‚çš„è½¦æ¬¡</span>  
<span class="hljs-attr">Action:</span> <span class="hljs-string">None</span>  
<span class="hljs-attr">Final Answer:</span> <span class="hljs-string">ä¸ºæ‚¨æ‰¾åˆ°ä¸¤å¼ æ˜å¤©ä¸‹åˆä»åŒ—äº¬åˆ°ä¸Šæµ·çš„é«˜é“ç¥¨...ï¼ˆè¾“å‡ºç»“æœï¼‰</span>
</code></pre>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼š</p>
<ol start="0">
<li>è‹¥ä¹‹å‰ç”¨æˆ·å·²ç»è¡¨è¾¾è¿‡åå¥½å¦‚â€œåªè¦ä¸€ç­‰åº§â€ã€â€œä¸ååŠ¨è½¦â€ç­‰ï¼Œé•¿æœŸè®°å¿†éœ€è¦æä¾›è¿™äº›åå¥½ä¿¡æ¯ï¼›</li>
<li>è‹¥ç”¨æˆ·æ­¤å‰æè¿‡â€œå’Œæ˜¨å¤©æµç¨‹ä¸€æ ·â€ï¼ŒçŸ­æœŸè®°å¿†è¦å‡†ç¡®æå–é‚£æ¬¡ä¼šè¯å†…å®¹ï¼›</li>
<li>è‹¥è°ƒç”¨æŸ¥è¯¢å·¥å…·è¿”å›å¤§é‡å†…å®¹ï¼Œè®°å¿†ç³»ç»Ÿéœ€åˆ¤æ–­æå–å“ªäº› Observation å¡å…¥ä¸‹ä¸€æ­¥ Promptï¼›</li>
</ol>
<p>ä»è¿™é‡Œå¤§å®¶ä¹Ÿå¯ä»¥çœ‹å‡ºReActçš„é‡è¦æ€§å’Œå¤æ‚åº¦äº†ï¼Œä»–æ˜¯æ¨åŠ¨æ¨ç†å¾ªç¯å‘å‰çš„åŸºç¡€ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œä¸ºä»€ä¹ˆè¯´ä¸Šä¸‹æ–‡å·¥ç¨‹æ˜¯æ•´å¥— Agent æ¶æ„æœ€å®¹æ˜“å¿½è§†ã€ä½†æœ€å®¹æ˜“å‡ºé—®é¢˜çš„éƒ¨åˆ†ï¼Ÿå› ä¸ºå®ƒä¸€æ—¦åšä¸å¥½ï¼Œæ¨¡å‹ç”Ÿæˆçš„ Thought å°†ä¼šæ˜¯ç©ºè½¬ã€åç¦»ã€æˆ–è€…å¹»è§‰çš„ã€‚</p>
<p>æ€»è€Œè¨€ä¹‹ï¼Œè¿™å—æ˜¯äº‹å®ä¸Šçš„éš¾ç‚¹ï¼Œå¤§å®¶å¥½å¥½ä½“æ‚Ÿå§ã€‚</p>
<h2 data-id="heading-12">å¼ºåŒ–ä¸è®­ç»ƒ</h2>
<p>æ¨¡å‹å‘å±•äº†ä¸‰å¹´ç»å†äº†ä¸‰ä¸ªæ—¶ä»£ï¼š<strong>ç™¾æ¨¡å¤§æˆ˜æ¨¡å‹è®­ç»ƒ â†’ å¥—å£³ä¸ºè£ï¼Œæç¤ºè¯å·¥ç¨‹ â†’ CoT</strong>ï¼Œä¹Ÿå°±æ˜¯å½“å‰<strong>ä¸šå†…æ™®éå¯¹äºæ¨¡å‹è®­ç»ƒæ˜¯ååˆ†æ’æ–¥çš„</strong>ï¼Œè¿™æ„å‘³ç€æŠ€æœ¯è´Ÿè´£äººè¯´å‡ºè¦è®­ç»ƒï¼Œè¿™ç¬”é¢„ç®—å¯èƒ½ä¼šæœ‰å¾ˆå¤§çš„å‹åŠ›...</p>
<p>åªä¸è¿‡ï¼Œè™½ç„¶åŸºç¡€æ¨¡å‹å·²ç»å…·å¤‡å¼ºå¤§çš„èƒ½åŠ›ï¼Œä½†è¦è®©æ¨¡å‹åœ¨ç‰¹å®šAgentæ¶æ„ä¸­å‘æŒ¥æœ€ä½³æ•ˆæœï¼Œå¾€å¾€éœ€è¦é’ˆå¯¹æ€§åœ°å­¦ä¹ ä½¿ç”¨æ–°å·¥å…·å’Œæ–°çŸ¥è¯†ã€‚ç™½çš®ä¹¦æ€»ç»“äº†ä¸‰ç§ä¸»è¦æ–¹æ³•ï¼š</p>
<p><strong>ä¸€ã€ä¸Šä¸‹æ–‡å†…å­¦ä¹ ï¼ˆIn-context Learningï¼‰ï¼š</strong></p>
<p>åœ¨æ¨ç†æ—¶ä¸ºæ¨¡å‹æä¾›ä»»åŠ¡ç›¸å…³çš„æç¤ºã€å·¥å…·è¯´æ˜å’Œå°‘é‡ç¤ºä¾‹ï¼Œè®©æ¨¡å‹â€œåœ¨çº¿â€å­¦ä¹ å¦‚ä½•ä½¿ç”¨å·¥å…·ã€‚</p>
<p>ä¾‹å¦‚ï¼Œé€šè¿‡å‡ ä¸ªç¤ºä¾‹å¯¹è¯å±•ç¤ºåœ¨ç±»ä¼¼åœºæ™¯ä¸‹ä½¿ç”¨å“ªç§å·¥å…·ã€æ€æ ·è°ƒç”¨ï¼Œå¯æå‡æ¨¡å‹çš„å·¥å…·è°ƒç”¨å‡†ç¡®ç‡ã€‚</p>
<p>ReAct æœ¬èº«å°±æ˜¯ä¸€ç§å…¸å‹çš„ä¸Šä¸‹æ–‡ç¤ºä¾‹é©±åŠ¨çš„æç¤ºæ¡†æ¶ã€‚</p>
<p><strong>äºŒã€æ£€ç´¢å¼ä¸Šä¸‹æ–‡å­¦ä¹ ï¼ˆRetrieval-based In-context Learningï¼‰ï¼š</strong></p>
<p>è‡ªåŠ¨æ£€ç´¢<strong>å’Œé€‰æ‹©æœ€ç›¸å…³çš„çŸ¥è¯†ç‰‡æ®µ</strong>ã€ç¤ºä¾‹æˆ–å·¥å…·è¯´æ˜ä½œä¸ºæç¤ºçš„ä¸€éƒ¨åˆ†ï¼Œä»å¤–éƒ¨è®°å¿†åº“ï¼ˆå¦‚â€œç¤ºä¾‹å­˜å‚¨â€æˆ–çŸ¥è¯†åº“ï¼‰ä¸­åŠ¨æ€æ„é€ æç¤ºã€‚</p>
<p>è¿™ç±»ä¼¼äºç»™æ¨¡å‹â€œæä¾›ä¸€æœ¬åŠ¨çš„èœè°±â€ï¼šè®©å®ƒæ ¹æ®æŸ¥è¯¢ä»çŸ¥è¯†åº“æ£€ç´¢ç¤ºä¾‹æ¥æŒ‡å¯¼å†³ç­–ã€‚</p>
<p><strong>ä¸‰ã€å¾®è°ƒè®­ç»ƒï¼ˆFine-tuningï¼‰ï¼š</strong></p>
<p>æœ€åå°±æ˜¯å¾®è°ƒäº†ï¼Œä½¿ç”¨å¤§é‡ç‰¹å®šä»»åŠ¡çš„ç¤ºä¾‹æ•°æ®å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œå¯ä»¥æ›´å¥½çš„æé«˜æ•ˆæœã€‚æ¯”å¦‚ï¼Œä¸ºå®¢æœæ™ºèƒ½ä½“å¾®è°ƒæ¨¡å‹ï¼Œè®©å®ƒå­¦ä¼šä¼˜å…ˆè°ƒç”¨çŸ¥è¯†åº“å·¥å…·è€Œä¸æ˜¯ç›´æ¥â€œèƒ¡ä¹±å›ç­”â€ã€‚</p>
<p>è¿™é‡Œæ˜¯ä¸€äº›è®­ç»ƒæ•°æ®æ¡ˆä¾‹ï¼Œå¤§å®¶æ„Ÿå—ä¸‹å°±å¥½ï¼š</p>
<pre><code class="hljs language-swift" lang="swift">{  
Â Â <span class="hljs-string">"context"</span>:Â <span class="hljs-string">"ã€å†…éƒ¨æ–‡æ¡£æ‘˜å½•ã€‘æœ¬å…¬å¸æ ‡å‡†é€€è´§æ”¿ç­–ä¸ºï¼šè‡ªæ”¶è´§ä¹‹æ—¥èµ· 7 æ—¥å†…å¯æ— ç†ç”±é€€è´§ï¼Œè¶…è¿‡ 7 æ—¥ä¸äºˆå—ç†ã€‚"</span>,  
<span class="hljs-string">"question"</span>:Â <span class="hljs-string">"ä½ ä»¬é€€è´§æ”¿ç­–æ˜¯æ€æ ·çš„ï¼Ÿ"</span>,  
<span class="hljs-string">"answer"</span>:Â <span class="hljs-string">"æ ¹æ®æˆ‘ä»¬çš„æ ‡å‡†é€€è´§æ”¿ç­–ï¼Œè‡ªæ”¶è´§ä¹‹æ—¥èµ· 7 æ—¥å†…æ‚¨å¯ä»¥æ— ç†ç”±é€€è´§ï¼Œè¶…è¿‡ 7 æ—¥åˆ™æ— æ³•åŠç†é€€è´§ã€‚"</span>  
}  
  
{  
<span class="hljs-string">"goal"</span>:Â <span class="hljs-string">"å¸®ç”¨æˆ·è§„åˆ’ä¸€ä¸ª 3 å¤©çš„ä¸œäº¬è‡ªç”±è¡Œï¼Œé¢„ç®—é€‚ä¸­ï¼Œå–œæ¬¢ç¾é£Ÿå’ŒåŠ¨æ¼«æ–‡åŒ–ã€‚"</span>,  
<span class="hljs-string">"tools"</span>: [<span class="hljs-string">"search_flights"</span>,Â <span class="hljs-string">"search_hotels"</span>,Â <span class="hljs-string">"search_attractions"</span>],  
<span class="hljs-string">"plan"</span>: {  
Â  Â Â <span class="hljs-string">"steps"</span>: [  
Â  Â  Â  {  
Â  Â  Â  Â Â <span class="hljs-string">"step_id"</span>: <span class="hljs-number">1</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"description"</span>:Â <span class="hljs-string">"ç¡®å®šå‡ºå‘å’Œè¿”å›æ—¥æœŸï¼Œå¹¶æŸ¥è¯¢å¾€è¿”æœºç¥¨é€‰é¡¹"</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"tool"</span>:Â <span class="hljs-string">"search_flights"</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"inputs"</span>: [<span class="hljs-string">"å‡ºå‘åŸå¸‚"</span>,Â <span class="hljs-string">"ä¸œäº¬"</span>,Â <span class="hljs-string">"å‡ºå‘æ—¥æœŸ"</span>,Â <span class="hljs-string">"è¿”å›æ—¥æœŸ"</span>]  
Â  Â  Â  },  
Â  Â  Â  {  
Â  Â  Â  Â Â <span class="hljs-string">"step_id"</span>: <span class="hljs-number">2</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"description"</span>:Â <span class="hljs-string">"æ ¹æ®é¢„ç®—å’Œåœ°ç†ä½ç½®æœç´¢é…’åº—ï¼ˆä¼˜å…ˆæ–°å®¿ã€æ¶©è°·é™„è¿‘ï¼‰"</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"tool"</span>:Â <span class="hljs-string">"search_hotels"</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"inputs"</span>: [<span class="hljs-string">"ä¸œäº¬"</span>,Â <span class="hljs-string">"3 æ™š"</span>,Â <span class="hljs-string">"é¢„ç®—èŒƒå›´"</span>]  
Â  Â  Â  },  
Â  Â  Â  {  
Â  Â  Â  Â Â <span class="hljs-string">"step_id"</span>: <span class="hljs-number">3</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"description"</span>:Â <span class="hljs-string">"æ ¹æ®ç”¨æˆ·å…´è¶£ç­›é€‰æ™¯ç‚¹ï¼ˆåŠ¨æ¼«æ–‡åŒ–ã€ç¾é£Ÿè¡—ï¼‰å¹¶æŒ‰å¤©åˆ†é…"</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"tool"</span>:Â <span class="hljs-string">"search_attractions"</span>,  
Â  Â  Â  Â Â <span class="hljs-string">"inputs"</span>: [<span class="hljs-string">"ä¸œäº¬"</span>,Â <span class="hljs-string">"åŠ¨æ¼«"</span>,Â <span class="hljs-string">"ç¾é£Ÿ"</span>]  
Â  Â  Â  }  
Â  Â  ]  
Â  }  
}  
  
{<span class="hljs-string">"messages"</span>: [  
Â  {<span class="hljs-string">"role"</span>:Â <span class="hljs-string">"system"</span>,Â <span class="hljs-string">"content"</span>:Â <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä»»åŠ¡è§„åˆ’åŠ©æ‰‹ï¼Œæ”¶åˆ°ç”¨æˆ·ç›®æ ‡ååªè¾“å‡º JSON æ ¼å¼çš„ä»»åŠ¡æ‹†è§£è®¡åˆ’ã€‚"</span>},  
Â  {<span class="hljs-string">"role"</span>:Â <span class="hljs-string">"user"</span>,Â <span class="hljs-string">"content"</span>:Â <span class="hljs-string">"å¸®æˆ‘è§„åˆ’ä¸€ä¸ª 3 å¤©çš„ä¸œäº¬è‡ªç”±è¡Œï¼Œé¢„ç®—é€‚ä¸­ï¼Œæˆ‘å–œæ¬¢ç¾é£Ÿå’ŒåŠ¨æ¼«ã€‚"</span>},  
Â  {  
Â  Â Â <span class="hljs-string">"role"</span>:Â <span class="hljs-string">"assistant"</span>,  
Â  Â Â <span class="hljs-string">"content"</span>:Â <span class="hljs-string">"{<span class="hljs-subst">\"</span>steps<span class="hljs-subst">\"</span>: [\  
Â  Â  Â  {<span class="hljs-subst">\"</span>step_id<span class="hljs-subst">\"</span>: 1, <span class="hljs-subst">\"</span>description<span class="hljs-subst">\"</span>: <span class="hljs-subst">\"</span>ç¡®è®¤å‡ºå‘/è¿”å›æ—¥æœŸå¹¶æŸ¥è¯¢æœºç¥¨<span class="hljs-subst">\"</span>, <span class="hljs-subst">\"</span>tool<span class="hljs-subst">\"</span>: <span class="hljs-subst">\"</span>search_flights<span class="hljs-subst">\"</span>},\  
Â  Â  Â  {<span class="hljs-subst">\"</span>step_id<span class="hljs-subst">\"</span>: 2, <span class="hljs-subst">\"</span>description<span class="hljs-subst">\"</span>: <span class="hljs-subst">\"</span>æ ¹æ®é¢„ç®—å’Œä½ç½®é€‰æ‹©é…’åº—<span class="hljs-subst">\"</span>, <span class="hljs-subst">\"</span>tool<span class="hljs-subst">\"</span>: <span class="hljs-subst">\"</span>search_hotels<span class="hljs-subst">\"</span>},\  
Â  Â  Â  {<span class="hljs-subst">\"</span>step_id<span class="hljs-subst">\"</span>: 3, <span class="hljs-subst">\"</span>description<span class="hljs-subst">\"</span>: <span class="hljs-subst">\"</span>ä¸º 3 å¤©åˆ†åˆ«å®‰æ’æ™¯ç‚¹å’Œç¾é£Ÿ<span class="hljs-subst">\"</span>, <span class="hljs-subst">\"</span>tool<span class="hljs-subst">\"</span>: <span class="hljs-subst">\"</span>search_attractions<span class="hljs-subst">\"</span>}\  
Â  Â  ]}"</span>  
Â  }  
]}
</code></pre>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šï¼Œè¿™ä¸‰ä¸ªå¾€å¾€ä¼šæ··ç”¨ã€‚</p>
<h2 data-id="heading-13">ç»“è¯­</h2>
<p>ç™½çš®ä¹¦åé¢è¿˜ä¼šæ¶‰åŠ<strong>å¤šAgentæ¶æ„ã€é«˜å¹¶å‘æ¶æ„è®¾è®¡ã€å®‰å…¨</strong>ç­‰æ¨¡å—ï¼Œç¨å¾®æœ‰äº›æ³›æ³›è€Œè°ˆï¼Œè€Œæˆ‘ä»¬ä»Šå¤©å®šä½å¦‚æœæ˜¯å…¥é—¨çº§å†…å®¹çš„è¯å°±ä¸å»æ¶‰åŠäº†ã€‚</p>
<p>æœ€åè¿˜æ˜¯æ€»ç»“ä¸€ä¸‹ï¼Œè¿™ä»½Agentç™½çš®ä¹¦å…¨é¢æ¢³ç†äº† AI Agentï¼ˆæ™ºèƒ½ä½“ï¼‰æŠ€æœ¯æ¶æ„çš„æ ¸å¿ƒè¦ç´ ï¼Œä»–æœ¬èº«åŒ…å«ä¸€éƒ¨åˆ†å®è·µæŠ€å·§ï¼Œä½†æœ‰ç‚¹å–è‡ªå·±äº‘æœåŠ¡çš„å«Œç–‘ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä¸æ¶‰åŠäº†ã€‚</p>
<p>æ€»ä¹‹ï¼Œå¸Œæœ›æœ¬æ–‡å¯¹å¤§å®¶æœ‰ç”¨å§ï¼Œä½œä¸ºå…¥é—¨çº§ç§‘æ™®å†…å®¹ï¼Œæˆ‘è§‰å¾—ä»–è¿˜æ˜¯åˆæ ¼çš„ã€‚åªæ˜¯å¯æƒœåˆæµªè´¹æˆ‘5ä¸ªå°æ—¶...</p>
<h2 data-id="heading-14">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaæ¨¡å—åŒ–ç³»ç»Ÿæ·±åº¦è§£æï¼šä»JARåœ°ç‹±åˆ°JPMSæ¨¡å—åŒ–]]></title>    <link>https://juejin.cn/post/7584724634173800511</link>    <guid>https://juejin.cn/post/7584724634173800511</guid>    <pubDate>2025-12-18T05:59:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584724634173800511" data-draft-id="7584729714340839443" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaæ¨¡å—åŒ–ç³»ç»Ÿæ·±åº¦è§£æï¼šä»JARåœ°ç‹±åˆ°JPMSæ¨¡å—åŒ–"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-18T05:59:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaæ¨¡å—åŒ–ç³»ç»Ÿæ·±åº¦è§£æï¼šä»JARåœ°ç‹±åˆ°JPMSæ¨¡å—åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:59:11.000Z" title="Thu Dec 18 2025 05:59:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å¼•è¨€ï¼šæ¨¡å—åŒ–é©å‘½çš„å¿…è¦æ€§</h2>
<p>åœ¨Java 9ä¹‹å‰ï¼ŒJavaç”Ÿæ€ç³»ç»Ÿé¢ä¸´ç€è¯¸å¤šæŒ‘æˆ˜ï¼šåºå¤§çš„ç±»è·¯å¾„ã€ç‰ˆæœ¬å†²çªã€å¤æ‚çš„ä¾èµ–ç®¡ç†ç­‰ã€‚Java Platform Module System (JPMS) çš„å¼•å…¥ï¼Œæ ‡å¿—ç€Javaæ­£å¼è¿›å…¥äº†æ¨¡å—åŒ–æ—¶ä»£ã€‚è¿™ä¸ä»…æ”¹å˜äº†Javaå¹³å°çš„å†…éƒ¨ç»“æ„ï¼Œä¹Ÿå½»åº•æ”¹å˜äº†æˆ‘ä»¬æ„å»ºå’Œç»„ç»‡å¤§å‹åº”ç”¨çš„æ–¹å¼ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€æ¨¡å—åŒ–åŸºç¡€ï¼šä»ç±»è·¯å¾„åˆ°æ¨¡å—è·¯å¾„</h2>
<h3 data-id="heading-2">1.1 æ¨¡å—çš„åŸºæœ¬æ¦‚å¿µä¸ç»“æ„</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. æ¨¡å—å®šä¹‰æ–‡ä»¶ï¼šmodule-info.java</span>
<span class="hljs-comment">// è¿™æ˜¯æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œæ¯ä¸ªæ¨¡å—éƒ½å¿…é¡»æœ‰module-info.javaæ–‡ä»¶</span>

<span class="hljs-comment">/**
 * module-info.javaç¤ºä¾‹
 * 
 * åŸºæœ¬è¯­æ³•ï¼š
 * module æ¨¡å—å {
 *     requires å…¶ä»–æ¨¡å—;        // å£°æ˜ä¾èµ–
 *     exports åŒ…å;            // å¯¼å‡ºåŒ…ï¼ˆå…¬å¼€APIï¼‰
 *     opens åŒ…å;             // å¼€æ”¾åŒ…ï¼ˆå…è®¸åå°„è®¿é—®ï¼‰
 *     provides æœåŠ¡ with å®ç°; // æä¾›æœåŠ¡å®ç°
 *     uses æœåŠ¡;              // ä½¿ç”¨æœåŠ¡
 * }
 */</span>

<span class="hljs-comment">// ç¤ºä¾‹ï¼šä¸€ä¸ªç”¨æˆ·æœåŠ¡æ¨¡å—çš„å®šä¹‰</span>
<span class="hljs-keyword">module</span> com.example.userservice {
    <span class="hljs-comment">// ä¾èµ–å£°æ˜</span>
    <span class="hljs-keyword">requires</span> java.base;           <span class="hljs-comment">// éšå¼ä¾èµ–ï¼Œå¯çœç•¥</span>
    <span class="hljs-keyword">requires</span> java.sql;
    <span class="hljs-keyword">requires</span> transitive org.slf4j; <span class="hljs-comment">// ä¼ é€’æ€§ä¾èµ–</span>
    <span class="hljs-keyword">requires</span> <span class="hljs-keyword">static</span> lombok;       <span class="hljs-comment">// ç¼–è¯‘æ—¶ä¾èµ–</span>
    
    <span class="hljs-comment">// å¯¼å‡ºåŒ…ï¼šè¿™äº›åŒ…å¯ä»¥è¢«å…¶ä»–æ¨¡å—è®¿é—®</span>
    <span class="hljs-keyword">exports</span> com.example.userservice.api;
    <span class="hljs-keyword">exports</span> com.example.userservice.domain to com.example.app;
    
    <span class="hljs-comment">// å¼€æ”¾åŒ…ï¼šå…è®¸é€šè¿‡åå°„è®¿é—®ï¼ˆç”¨äºæ¡†æ¶å¦‚Springã€Hibernateï¼‰</span>
    opens com.example.userservice.internal;
    opens com.example.userservice.domain to spring.core, hibernate.core;
    
    <span class="hljs-comment">// æœåŠ¡æä¾›å£°æ˜</span>
    provides com.example.userservice.spi.UserProvider
        with com.example.userservice.provider.DefaultUserProvider;
    
    <span class="hljs-comment">// æœåŠ¡ä½¿ç”¨å£°æ˜</span>
    uses com.example.userservice.spi.UserProvider;
}
</code></pre>
<h3 data-id="heading-3">1.2 æ„å»ºç¬¬ä¸€ä¸ªæ¨¡å—åŒ–åº”ç”¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é¡¹ç›®ç»“æ„ç¤ºä¾‹ï¼š</span>
<span class="hljs-comment"># modular-app/</span>
<span class="hljs-comment"># â”œâ”€â”€ module-a/</span>
<span class="hljs-comment"># â”‚   â”œâ”€â”€ src/</span>
<span class="hljs-comment"># â”‚   â”‚   â””â”€â”€ com.example.modulea/</span>
<span class="hljs-comment"># â”‚   â”‚       â””â”€â”€ ModuleAClass.java</span>
<span class="hljs-comment"># â”‚   â””â”€â”€ module-info.java</span>
<span class="hljs-comment"># â”œâ”€â”€ module-b/</span>
<span class="hljs-comment"># â”‚   â”œâ”€â”€ src/</span>
<span class="hljs-comment"># â”‚   â”‚   â””â”€â”€ com.example.moduleb/</span>
<span class="hljs-comment"># â”‚   â”‚       â””â”€â”€ ModuleBClass.java</span>
<span class="hljs-comment"># â”‚   â””â”€â”€ module-info.java</span>
<span class="hljs-comment"># â””â”€â”€ app/</span>
<span class="hljs-comment">#     â”œâ”€â”€ src/</span>
<span class="hljs-comment">#     â”‚   â””â”€â”€ com.example.app/</span>
<span class="hljs-comment">#     â”‚       â””â”€â”€ MainApp.java</span>
<span class="hljs-comment">#     â””â”€â”€ module-info.java</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Module A: æä¾›æœåŠ¡æ¥å£</span>
<span class="hljs-keyword">module</span> com.example.modulea {
    <span class="hljs-keyword">exports</span> com.example.modulea.api;
}

<span class="hljs-keyword">package</span> com.example.modulea.api;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">GreetingService</span> {
    String <span class="hljs-title function_">greet</span><span class="hljs-params">(String name)</span>;
}

<span class="hljs-comment">// Module B: æä¾›æœåŠ¡å®ç°</span>
<span class="hljs-keyword">module</span> com.example.moduleb {
    <span class="hljs-keyword">requires</span> com.example.modulea;  <span class="hljs-comment">// ä¾èµ–Module A</span>
    provides com.example.modulea.api.GreetingService 
        with com.example.moduleb.impl.EnglishGreetingService;
}

<span class="hljs-keyword">package</span> com.example.moduleb.impl;
<span class="hljs-keyword">import</span> com.example.modulea.api.GreetingService;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EnglishGreetingService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">GreetingService</span> {
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">greet</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello, "</span> + name + <span class="hljs-string">"!"</span>;
    }
}

<span class="hljs-comment">// ä¸»åº”ç”¨æ¨¡å—</span>
<span class="hljs-keyword">module</span> com.example.app {
    <span class="hljs-keyword">requires</span> com.example.modulea;  <span class="hljs-comment">// ä½¿ç”¨æœåŠ¡æ¥å£</span>
    uses com.example.modulea.api.GreetingService;
}

<span class="hljs-keyword">package</span> com.example.app;
<span class="hljs-keyword">import</span> com.example.modulea.api.GreetingService;
<span class="hljs-keyword">import</span> java.util.ServiceLoader;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainApp</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// é€šè¿‡ServiceLoaderå‘ç°æœåŠ¡å®ç°</span>
        ServiceLoader&lt;GreetingService&gt; loader = 
            ServiceLoader.load(GreetingService.class);
        
        <span class="hljs-keyword">for</span> (GreetingService service : loader) {
            System.out.println(service.greet(<span class="hljs-string">"World"</span>));
        }
    }
}
</code></pre>
<h2 data-id="heading-4">äºŒã€æ¨¡å—ä¾èµ–ä¸ç‰ˆæœ¬ç®¡ç†</h2>
<h3 data-id="heading-5">2.1 æ¨¡å—ä¾èµ–è§£æä¸å†²çªè§£å†³</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¤æ‚çš„æ¨¡å—ä¾èµ–åœºæ™¯</span>
<span class="hljs-keyword">module</span> com.example.application {
    <span class="hljs-keyword">requires</span> com.example.utils;       <span class="hljs-comment">// ä¾èµ–å·¥å…·æ¨¡å—</span>
    <span class="hljs-keyword">requires</span> com.example.persistence; <span class="hljs-comment">// ä¾èµ–æŒä¹…åŒ–æ¨¡å—</span>
    <span class="hljs-keyword">requires</span> com.example.security;    <span class="hljs-comment">// ä¾èµ–å®‰å…¨æ¨¡å—</span>
    
    <span class="hljs-comment">// å¯é€‰çš„åŠ¨æ€ä¾èµ–</span>
    <span class="hljs-keyword">requires</span> <span class="hljs-keyword">static</span> com.example.experimental;
    
    <span class="hljs-comment">// æ’é™¤ä¼ é€’ä¾èµ–å†²çª</span>
    <span class="hljs-keyword">requires</span> com.example.database;
    <span class="hljs-comment">// å¦‚æœcom.example.databaseåŒæ—¶ä¾èµ–äº†org.slf4jçš„ä¸åŒç‰ˆæœ¬</span>
    <span class="hljs-comment">// å¯ä»¥ä½¿ç”¨--patch-moduleæˆ–å‡çº§æ¨¡å—åŒ–è§£å†³</span>
}

<span class="hljs-comment">// æ¨¡å—ç‰ˆæœ¬ç®¡ç†ç­–ç•¥</span>
<span class="hljs-comment">/**
 * æ¨¡å—åŒ–ç³»ç»Ÿçš„ç‰ˆæœ¬ç®¡ç†æ–¹å¼ï¼š
 * 1. æ¨¡å—åç§°æœ¬èº«åŒ…å«ç‰ˆæœ¬ä¿¡æ¯ï¼ˆä¸æ¨èï¼‰
 * 2. ä½¿ç”¨module-info.javaä¸­çš„ç‰ˆæœ¬å±æ€§ï¼ˆJava 9+ï¼‰
 * 3. ä½¿ç”¨æ„å»ºå·¥å…·ï¼ˆMaven/Gradleï¼‰ç®¡ç†ç‰ˆæœ¬
 * 4. ä½¿ç”¨JLinkåˆ›å»ºè‡ªå®šä¹‰è¿è¡Œæ—¶æ˜ åƒ
 */</span>

<span class="hljs-comment">// module-info.javaä¸­çš„ç‰ˆæœ¬ä¿¡æ¯</span>
<span class="hljs-meta">@Version("1.2.0")</span>
<span class="hljs-meta">@Deprecated(since="2.0", forRemoval=true)</span>
<span class="hljs-keyword">module</span> com.example.legacy {
    <span class="hljs-keyword">requires</span> transitive java.desktop version <span class="hljs-string">"11+"</span>;
    <span class="hljs-keyword">exports</span> com.example.legacy.api;
}

<span class="hljs-comment">// æ„å»ºå¤šç‰ˆæœ¬JARï¼ˆMulti-Release JARï¼‰</span>
<span class="hljs-comment">// META-INF/MANIFEST.MFä¸­å£°æ˜ï¼š</span>
<span class="hljs-comment">// Multi-Release: true</span>

<span class="hljs-comment">// ç›®å½•ç»“æ„ï¼š</span>
<span class="hljs-comment">// mymodule.jar</span>
<span class="hljs-comment">// â”œâ”€â”€ com/example/MyClass.class           # ä¸»è¦ç±»æ–‡ä»¶ï¼ˆJava 8ï¼‰</span>
<span class="hljs-comment">// â”œâ”€â”€ META-INF/</span>
<span class="hljs-comment">// â”‚   â””â”€â”€ versions/</span>
<span class="hljs-comment">// â”‚       â””â”€â”€ 9/</span>
<span class="hljs-comment">// â”‚           â””â”€â”€ com/example/MyClass.class # Java 9ç‰ˆæœ¬</span>
<span class="hljs-comment">// â”‚       â””â”€â”€ 11/</span>
<span class="hljs-comment">// â”‚           â””â”€â”€ com/example/MyClass.class # Java 11ç‰ˆæœ¬</span>
<span class="hljs-comment">// â””â”€â”€ module-info.class                   # æ¨¡å—æè¿°ç¬¦</span>
</code></pre>
<h3 data-id="heading-6">2.2 æ¨¡å—åŒ–ä¾èµ–å†²çªè§£å†³å®æˆ˜</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.lang.<span class="hljs-keyword">module</span>.*;
<span class="hljs-keyword">import</span> java.util.*;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModuleDependencyResolver</span> {
    
    <span class="hljs-comment">// æ¨¡æ‹Ÿæ¨¡å—ä¾èµ–å›¾</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModuleGraph</span> {
        Map&lt;String, ModuleNode&gt; modules = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        
        <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModuleNode</span> {
            String name;
            String version;
            Set&lt;ModuleNode&gt; <span class="hljs-keyword">requires</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
            Set&lt;ModuleNode&gt; requiredBy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
            
            ModuleNode(String name, String version) {
                <span class="hljs-built_in">this</span>.name = name;
                <span class="hljs-built_in">this</span>.version = version;
            }
            
            <span class="hljs-keyword">void</span> <span class="hljs-title function_">addDependency</span><span class="hljs-params">(ModuleNode dependency)</span> {
                <span class="hljs-keyword">requires</span>.add(dependency);
                dependency.requiredBy.add(<span class="hljs-built_in">this</span>);
            }
        }
        
        <span class="hljs-comment">// æ·»åŠ æ¨¡å—</span>
        ModuleNode <span class="hljs-title function_">addModule</span><span class="hljs-params">(String name, String version)</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> name + <span class="hljs-string">":"</span> + version;
            <span class="hljs-keyword">return</span> modules.computeIfAbsent(key, k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleNode</span>(name, version));
        }
        
        <span class="hljs-comment">// è§£æä¾èµ–å†²çª</span>
        List&lt;Conflict&gt; <span class="hljs-title function_">resolveConflicts</span><span class="hljs-params">()</span> {
            List&lt;Conflict&gt; conflicts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
            Map&lt;String, List&lt;ModuleNode&gt;&gt; nameToNodes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            
            <span class="hljs-comment">// æŒ‰æ¨¡å—ååˆ†ç»„</span>
            <span class="hljs-keyword">for</span> (ModuleNode node : modules.values()) {
                nameToNodes.computeIfAbsent(node.name, k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;())
                          .add(node);
            }
            
            <span class="hljs-comment">// æ£€æŸ¥æ¯ä¸ªæ¨¡å—çš„å¤šä¸ªç‰ˆæœ¬</span>
            <span class="hljs-keyword">for</span> (Map.Entry&lt;String, List&lt;ModuleNode&gt;&gt; entry : nameToNodes.entrySet()) {
                <span class="hljs-keyword">if</span> (entry.getValue().size() &gt; <span class="hljs-number">1</span>) {
                    <span class="hljs-type">Conflict</span> <span class="hljs-variable">conflict</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Conflict</span>(entry.getKey(), entry.getValue());
                    conflicts.add(conflict);
                }
            }
            
            <span class="hljs-keyword">return</span> conflicts;
        }
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Conflict</span> {
        String moduleName;
        List&lt;ModuleGraph.ModuleNode&gt; versions;
        
        Conflict(String moduleName, List&lt;ModuleGraph.ModuleNode&gt; versions) {
            <span class="hljs-built_in">this</span>.moduleName = moduleName;
            <span class="hljs-built_in">this</span>.versions = versions;
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">"æ¨¡å— %s æœ‰ %d ä¸ªç‰ˆæœ¬: %s"</span>, 
                moduleName, versions.size(), 
                versions.stream()
                    .map(v -&gt; v.version)
                    .collect(java.util.stream.Collectors.joining(<span class="hljs-string">", "</span>)));
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== æ¨¡å—ä¾èµ–å†²çªè§£æ ===\n"</span>);
        
        <span class="hljs-type">ModuleGraph</span> <span class="hljs-variable">graph</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleGraph</span>();
        
        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªå¤æ‚çš„ä¾èµ–åœºæ™¯</span>
        ModuleGraph.<span class="hljs-type">ModuleNode</span> <span class="hljs-variable">app</span> <span class="hljs-operator">=</span> graph.addModule(<span class="hljs-string">"com.example.app"</span>, <span class="hljs-string">"1.0"</span>);
        ModuleGraph.<span class="hljs-type">ModuleNode</span> <span class="hljs-variable">utilsV1</span> <span class="hljs-operator">=</span> graph.addModule(<span class="hljs-string">"com.example.utils"</span>, <span class="hljs-string">"1.0"</span>);
        ModuleGraph.<span class="hljs-type">ModuleNode</span> <span class="hljs-variable">utilsV2</span> <span class="hljs-operator">=</span> graph.addModule(<span class="hljs-string">"com.example.utils"</span>, <span class="hljs-string">"2.0"</span>);
        ModuleGraph.<span class="hljs-type">ModuleNode</span> <span class="hljs-variable">database</span> <span class="hljs-operator">=</span> graph.addModule(<span class="hljs-string">"com.example.database"</span>, <span class="hljs-string">"1.0"</span>);
        ModuleGraph.<span class="hljs-type">ModuleNode</span> <span class="hljs-variable">security</span> <span class="hljs-operator">=</span> graph.addModule(<span class="hljs-string">"com.example.security"</span>, <span class="hljs-string">"1.0"</span>);
        
        <span class="hljs-comment">// å»ºç«‹ä¾èµ–å…³ç³»</span>
        app.addDependency(utilsV1);
        app.addDependency(database);
        database.addDependency(utilsV2);
        security.addDependency(utilsV1);
        
        <span class="hljs-comment">// è§£æå†²çª</span>
        List&lt;Conflict&gt; conflicts = graph.resolveConflicts();
        
        System.out.println(<span class="hljs-string">"å‘ç°çš„ä¾èµ–å†²çª:"</span>);
        conflicts.forEach(System.out::println);
        
        System.out.println(<span class="hljs-string">"\nå¯èƒ½çš„è§£å†³æ–¹æ¡ˆ:"</span>);
        System.out.println(<span class="hljs-string">"1. å‡çº§æ‰€æœ‰æ¨¡å—ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„com.example.utils"</span>);
        System.out.println(<span class="hljs-string">"2. ä½¿ç”¨æ¨¡å—é‡å‘½åï¼ˆ--patch-moduleï¼‰"</span>);
        System.out.println(<span class="hljs-string">"3. ä½¿ç”¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨éš”ç¦»"</span>);
        System.out.println(<span class="hljs-string">"4. é‡æ„æ¨¡å—é¿å…ä¼ é€’ä¾èµ–"</span>);
        
        <span class="hljs-comment">// æ¼”ç¤ºæ¨¡å—å±‚ï¼ˆModuleLayerï¼‰å®ç°éš”ç¦»</span>
        System.out.println(<span class="hljs-string">"\n=== ä½¿ç”¨ModuleLayerå®ç°éš”ç¦» ==="</span>);
        demonstrateModuleLayer();
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateModuleLayer</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// åˆ›å»ºçˆ¶å±‚ï¼ˆåŸºç¡€æ¨¡å—ï¼‰</span>
            <span class="hljs-type">ModuleLayer</span> <span class="hljs-variable">parent</span> <span class="hljs-operator">=</span> ModuleLayer.boot();
            
            <span class="hljs-comment">// é…ç½®æ¨¡å—æŸ¥æ‰¾å™¨</span>
            <span class="hljs-type">Path</span> <span class="hljs-variable">modulesDir</span> <span class="hljs-operator">=</span> Paths.get(<span class="hljs-string">"modules"</span>);
            <span class="hljs-type">ModuleFinder</span> <span class="hljs-variable">finder</span> <span class="hljs-operator">=</span> ModuleFinder.of(modulesDir);
            
            <span class="hljs-comment">// è§£ææ¨¡å—</span>
            <span class="hljs-type">Configuration</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> parent.configuration()
                .resolve(finder, ModuleFinder.of(), Set.of(<span class="hljs-string">"com.example.app"</span>));
            
            <span class="hljs-comment">// åˆ›å»ºæ–°çš„æ¨¡å—å±‚</span>
            <span class="hljs-type">ModuleLayer</span> <span class="hljs-variable">layer</span> <span class="hljs-operator">=</span> parent.defineModulesWithOneLoader(
                config, ClassLoader.getSystemClassLoader());
            
            <span class="hljs-comment">// åœ¨æ–°å±‚ä¸­æŸ¥æ‰¾æ¨¡å—</span>
            Optional&lt;Module&gt; appModule = layer.findModule(<span class="hljs-string">"com.example.app"</span>);
            <span class="hljs-keyword">if</span> (appModule.isPresent()) {
                System.out.println(<span class="hljs-string">"æˆåŠŸåŠ è½½æ¨¡å—: "</span> + appModule.get().getName());
                
                <span class="hljs-comment">// åŠ è½½æ¨¡å—ä¸­çš„ç±»</span>
                Class&lt;?&gt; mainClass = Class.forName(
                    appModule.get(), <span class="hljs-string">"com.example.app.Main"</span>);
                
                <span class="hljs-comment">// è°ƒç”¨æ–¹æ³•</span>
                <span class="hljs-type">Method</span> <span class="hljs-variable">mainMethod</span> <span class="hljs-operator">=</span> mainClass.getMethod(<span class="hljs-string">"main"</span>, String[].class);
                mainMethod.invoke(<span class="hljs-literal">null</span>, (Object) <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]{});
            }
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            System.err.println(<span class="hljs-string">"æ¨¡å—å±‚åˆ›å»ºå¤±è´¥: "</span> + e.getMessage());
        }
    }
}
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€æœåŠ¡åŠ è½½å™¨ä¸SPIå¢å¼º</h2>
<h3 data-id="heading-8">3.1 æ¨¡å—åŒ–æœåŠ¡æä¾›è€…æ¥å£</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æœåŠ¡æä¾›è€…æ¥å£å®šä¹‰æ¨¡å—</span>
<span class="hljs-keyword">module</span> com.example.storage.spi {
    <span class="hljs-keyword">exports</span> com.example.storage.spi;
    
    <span class="hljs-comment">// å®šä¹‰æœåŠ¡æ¥å£</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">StorageService</span> {
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">(String key, <span class="hljs-type">byte</span>[] data)</span>;
        <span class="hljs-type">byte</span>[] load(String key);
        <span class="hljs-type">boolean</span> <span class="hljs-title function_">exists</span><span class="hljs-params">(String key)</span>;
    }
}

<span class="hljs-comment">// æ–‡ä»¶å­˜å‚¨å®ç°æ¨¡å—</span>
<span class="hljs-keyword">module</span> com.example.storage.file {
    <span class="hljs-keyword">requires</span> com.example.storage.spi;
    provides com.example.storage.spi.StorageService 
        with com.example.storage.file.FileStorageService;
    
    <span class="hljs-comment">// å®ç°ç±»</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileStorageService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">StorageService</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Path basePath;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">FileStorageService</span><span class="hljs-params">()</span> {
            <span class="hljs-built_in">this</span>.basePath = Paths.get(<span class="hljs-string">"storage"</span>);
            Files.createDirectories(basePath);
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">(String key, <span class="hljs-type">byte</span>[] data)</span> {
            <span class="hljs-type">Path</span> <span class="hljs-variable">filePath</span> <span class="hljs-operator">=</span> basePath.resolve(key);
            Files.write(filePath, data);
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-type">byte</span>[] load(String key) {
            <span class="hljs-type">Path</span> <span class="hljs-variable">filePath</span> <span class="hljs-operator">=</span> basePath.resolve(key);
            <span class="hljs-keyword">return</span> Files.readAllBytes(filePath);
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">exists</span><span class="hljs-params">(String key)</span> {
            <span class="hljs-keyword">return</span> Files.exists(basePath.resolve(key));
        }
    }
}

<span class="hljs-comment">// æ•°æ®åº“å­˜å‚¨å®ç°æ¨¡å—</span>
<span class="hljs-keyword">module</span> com.example.storage.database {
    <span class="hljs-keyword">requires</span> com.example.storage.spi;
    <span class="hljs-keyword">requires</span> java.sql;
    provides com.example.storage.spi.StorageService 
        with com.example.storage.database.DatabaseStorageService;
    
    <span class="hljs-comment">// å®ç°ç±»</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseStorageService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">StorageService</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Connection connection;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">DatabaseStorageService</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
            <span class="hljs-built_in">this</span>.connection = DriverManager.getConnection(<span class="hljs-string">"jdbc:h2:mem:test"</span>);
            <span class="hljs-comment">// åˆå§‹åŒ–è¡¨ç»“æ„</span>
            <span class="hljs-keyword">try</span> (<span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> connection.createStatement()) {
                stmt.execute(<span class="hljs-string">"CREATE TABLE storage (key VARCHAR PRIMARY KEY, data BLOB)"</span>);
            }
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">(String key, <span class="hljs-type">byte</span>[] data)</span> <span class="hljs-keyword">throws</span> SQLException {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"MERGE INTO storage(key, data) VALUES(?, ?)"</span>;
            <span class="hljs-keyword">try</span> (<span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">pstmt</span> <span class="hljs-operator">=</span> connection.prepareStatement(sql)) {
                pstmt.setString(<span class="hljs-number">1</span>, key);
                pstmt.setBytes(<span class="hljs-number">2</span>, data);
                pstmt.executeUpdate();
            }
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-type">byte</span>[] load(String key) <span class="hljs-keyword">throws</span> SQLException {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT data FROM storage WHERE key = ?"</span>;
            <span class="hljs-keyword">try</span> (<span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">pstmt</span> <span class="hljs-operator">=</span> connection.prepareStatement(sql)) {
                pstmt.setString(<span class="hljs-number">1</span>, key);
                <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> pstmt.executeQuery();
                <span class="hljs-keyword">if</span> (rs.next()) {
                    <span class="hljs-keyword">return</span> rs.getBytes(<span class="hljs-string">"data"</span>);
                }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">exists</span><span class="hljs-params">(String key)</span> <span class="hljs-keyword">throws</span> SQLException {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT 1 FROM storage WHERE key = ?"</span>;
            <span class="hljs-keyword">try</span> (<span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">pstmt</span> <span class="hljs-operator">=</span> connection.prepareStatement(sql)) {
                pstmt.setString(<span class="hljs-number">1</span>, key);
                <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> pstmt.executeQuery();
                <span class="hljs-keyword">return</span> rs.next();
            }
        }
    }
}

<span class="hljs-comment">// åº”ç”¨æ¨¡å—ä½¿ç”¨æœåŠ¡</span>
<span class="hljs-keyword">module</span> com.example.application {
    <span class="hljs-keyword">requires</span> com.example.storage.spi;
    uses com.example.storage.spi.StorageService;
    
    <span class="hljs-comment">// åŠ¨æ€æœåŠ¡åŠ è½½å™¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StorageManager</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;StorageService&gt; services = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">StorageManager</span><span class="hljs-params">()</span> {
            <span class="hljs-comment">// åŠ è½½æ‰€æœ‰å¯ç”¨çš„å­˜å‚¨æœåŠ¡</span>
            ServiceLoader&lt;StorageService&gt; loader = 
                ServiceLoader.load(StorageService.class);
            
            <span class="hljs-keyword">for</span> (StorageService service : loader) {
                services.add(service);
                System.out.println(<span class="hljs-string">"åŠ è½½å­˜å‚¨æœåŠ¡: "</span> + service.getClass().getName());
            }
            
            <span class="hljs-keyword">if</span> (services.isEmpty()) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">"æœªæ‰¾åˆ°å¯ç”¨çš„å­˜å‚¨æœåŠ¡"</span>);
            }
        }
        
        <span class="hljs-comment">// ä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡</span>
        <span class="hljs-keyword">public</span> StorageService <span class="hljs-title function_">getDefaultService</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> services.get(<span class="hljs-number">0</span>);
        }
        
        <span class="hljs-comment">// æ ¹æ®æ¡ä»¶é€‰æ‹©æœåŠ¡</span>
        <span class="hljs-keyword">public</span> Optional&lt;StorageService&gt; <span class="hljs-title function_">findService</span><span class="hljs-params">(Predicate&lt;StorageService&gt; predicate)</span> {
            <span class="hljs-keyword">return</span> services.stream().filter(predicate).findFirst();
        }
    }
}
</code></pre>
<h3 data-id="heading-9">3.2 å¢å¼ºå‹æœåŠ¡æ³¨å†Œä¸å‘ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.*;
<span class="hljs-keyword">import</span> java.util.concurrent.*;
<span class="hljs-keyword">import</span> java.util.function.*;

<span class="hljs-comment">// å¢å¼ºçš„æœåŠ¡æ³¨å†Œè¡¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EnhancedServiceRegistry</span> {
    
    <span class="hljs-comment">// æœåŠ¡æè¿°ç¬¦</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceDescriptor</span>&lt;T&gt; {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Class&lt;T&gt; serviceType;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String version;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> priority; <span class="hljs-comment">// ä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, String&gt; metadata;
        
        ServiceDescriptor(Class&lt;T&gt; serviceType, String name, 
                         String version, <span class="hljs-type">int</span> priority, 
                         Map&lt;String, String&gt; metadata) {
            <span class="hljs-built_in">this</span>.serviceType = serviceType;
            <span class="hljs-built_in">this</span>.name = name;
            <span class="hljs-built_in">this</span>.version = version;
            <span class="hljs-built_in">this</span>.priority = priority;
            <span class="hljs-built_in">this</span>.metadata = Map.copyOf(metadata);
        }
        
        <span class="hljs-keyword">public</span> Class&lt;T&gt; <span class="hljs-title function_">getServiceType</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> serviceType; }
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> name; }
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getVersion</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> version; }
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> priority; }
        <span class="hljs-keyword">public</span> Map&lt;String, String&gt; <span class="hljs-title function_">getMetadata</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> metadata; }
    }
    
    <span class="hljs-comment">// æœåŠ¡å®ä¾‹åŒ…è£…å™¨</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceInstance</span>&lt;T&gt; {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ServiceDescriptor&lt;T&gt; descriptor;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> T instance;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> registrationTime;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> lastUsedTime;
        
        ServiceInstance(ServiceDescriptor&lt;T&gt; descriptor, T instance) {
            <span class="hljs-built_in">this</span>.descriptor = descriptor;
            <span class="hljs-built_in">this</span>.instance = instance;
            <span class="hljs-built_in">this</span>.registrationTime = System.currentTimeMillis();
            <span class="hljs-built_in">this</span>.lastUsedTime = registrationTime;
        }
        
        <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
            lastUsedTime = System.currentTimeMillis();
            <span class="hljs-keyword">return</span> instance;
        }
        
        <span class="hljs-keyword">public</span> ServiceDescriptor&lt;T&gt; <span class="hljs-title function_">getDescriptor</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> descriptor; }
        <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> System.currentTimeMillis() - registrationTime; }
        <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getIdleTime</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> System.currentTimeMillis() - lastUsedTime; }
    }
    
    <span class="hljs-comment">// æ¨¡å—æ„ŸçŸ¥çš„æœåŠ¡æ³¨å†Œè¡¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModuleAwareServiceRegistry</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Class&lt;?&gt;, List&lt;ServiceInstance&lt;?&gt;&gt;&gt; registry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Module&gt; moduleCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
        
        <span class="hljs-comment">// æ³¨å†ŒæœåŠ¡ï¼ˆè‡ªåŠ¨å‘ç°æ¨¡å—ä¿¡æ¯ï¼‰</span>
        <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">(Class&lt;T&gt; serviceType, T instance)</span> {
            register(serviceType, instance, createDescriptor(serviceType, instance));
        }
        
        <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">(Class&lt;T&gt; serviceType, T instance, 
                                 ServiceDescriptor&lt;T&gt; descriptor)</span> {
            ServiceInstance&lt;T&gt; serviceInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServiceInstance</span>&lt;&gt;(descriptor, instance);
            
            registry.computeIfAbsent(serviceType, k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyOnWriteArrayList</span>&lt;&gt;())
                   .add(serviceInstance);
            
            <span class="hljs-comment">// æŒ‰ä¼˜å…ˆçº§æ’åº</span>
            registry.get(serviceType).sort(
                Comparator.comparingInt(si -&gt; ((ServiceInstance&lt;T&gt;)si).getDescriptor().getPriority())
            );
            
            System.out.printf(<span class="hljs-string">"æ³¨å†ŒæœåŠ¡: %s [%s v%s]%n"</span>,
                serviceType.getSimpleName(),
                descriptor.getName(),
                descriptor.getVersion());
        }
        
        <span class="hljs-comment">// è‡ªåŠ¨åˆ›å»ºæœåŠ¡æè¿°ç¬¦</span>
        <span class="hljs-keyword">private</span> &lt;T&gt; ServiceDescriptor&lt;T&gt; <span class="hljs-title function_">createDescriptor</span><span class="hljs-params">(Class&lt;T&gt; serviceType, T instance)</span> {
            <span class="hljs-type">Module</span> <span class="hljs-variable">module</span> <span class="hljs-operator">=</span> instance.getClass().getModule();
            <span class="hljs-type">String</span> <span class="hljs-variable">moduleName</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">module</span>.getName();
            
            <span class="hljs-comment">// å°è¯•ä»æ¨¡å—æ³¨è§£è·å–å…ƒæ•°æ®</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> moduleName != <span class="hljs-literal">null</span> ? moduleName : serviceType.getSimpleName();
            <span class="hljs-type">String</span> <span class="hljs-variable">version</span> <span class="hljs-operator">=</span> <span class="hljs-string">"1.0.0"</span>;
            <span class="hljs-type">int</span> <span class="hljs-variable">priority</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;
            
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">module</span> != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">module</span>.isNamed()) {
                <span class="hljs-comment">// æ£€æŸ¥æ¨¡å—æ³¨è§£</span>
                Optional&lt;Object&gt; moduleVersion = <span class="hljs-keyword">module</span>.getDescriptor().version();
                <span class="hljs-keyword">if</span> (moduleVersion.isPresent()) {
                    version = moduleVersion.get().toString();
                }
            }
            
            Map&lt;String, String&gt; metadata = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            metadata.put(<span class="hljs-string">"module"</span>, moduleName != <span class="hljs-literal">null</span> ? moduleName : <span class="hljs-string">"unnamed"</span>);
            metadata.put(<span class="hljs-string">"class"</span>, instance.getClass().getName());
            
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServiceDescriptor</span>&lt;&gt;(serviceType, name, version, priority, metadata);
        }
        
        <span class="hljs-comment">// è·å–æœåŠ¡ï¼ˆæ”¯æŒè¿‡æ»¤å’Œé€‰æ‹©ç­–ç•¥ï¼‰</span>
        <span class="hljs-keyword">public</span> &lt;T&gt; Optional&lt;T&gt; <span class="hljs-title function_">getService</span><span class="hljs-params">(Class&lt;T&gt; serviceType)</span> {
            <span class="hljs-keyword">return</span> getService(serviceType, descriptor -&gt; <span class="hljs-literal">true</span>);
        }
        
        <span class="hljs-keyword">public</span> &lt;T&gt; Optional&lt;T&gt; <span class="hljs-title function_">getService</span><span class="hljs-params">(Class&lt;T&gt; serviceType, 
                                         Predicate&lt;ServiceDescriptor&lt;T&gt;&gt; filter)</span> {
            <span class="hljs-keyword">return</span> getService(serviceType, filter, instances -&gt; {
                <span class="hljs-comment">// é»˜è®¤é€‰æ‹©ç­–ç•¥ï¼šæœ€é«˜ä¼˜å…ˆçº§</span>
                <span class="hljs-keyword">return</span> instances.stream()
                    .min(Comparator.comparingInt(si -&gt; si.getDescriptor().getPriority()))
                    .orElse(<span class="hljs-literal">null</span>);
            });
        }
        
        <span class="hljs-keyword">public</span> &lt;T&gt; Optional&lt;T&gt; <span class="hljs-title function_">getService</span><span class="hljs-params">(Class&lt;T&gt; serviceType,
                                         Predicate&lt;ServiceDescriptor&lt;T&gt;&gt; filter,
                                         Function&lt;List&lt;ServiceInstance&lt;T&gt;&gt;, 
                                                 ServiceInstance&lt;T&gt;&gt; selector)</span> {
            List&lt;ServiceInstance&lt;?&gt;&gt; instances = registry.get(serviceType);
            <span class="hljs-keyword">if</span> (instances == <span class="hljs-literal">null</span> || instances.isEmpty()) {
                <span class="hljs-keyword">return</span> Optional.empty();
            }
            
            <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
            List&lt;ServiceInstance&lt;T&gt;&gt; typedInstances = (List&lt;ServiceInstance&lt;T&gt;&gt;) instances;
            
            <span class="hljs-comment">// åº”ç”¨è¿‡æ»¤å™¨</span>
            List&lt;ServiceInstance&lt;T&gt;&gt; filtered = typedInstances.stream()
                .filter(si -&gt; filter.test(si.getDescriptor()))
                .collect(Collectors.toList());
            
            <span class="hljs-keyword">if</span> (filtered.isEmpty()) {
                <span class="hljs-keyword">return</span> Optional.empty();
            }
            
            <span class="hljs-comment">// åº”ç”¨é€‰æ‹©ç­–ç•¥</span>
            ServiceInstance&lt;T&gt; selected = selector.apply(filtered);
            <span class="hljs-keyword">return</span> selected != <span class="hljs-literal">null</span> ? 
                Optional.of(selected.getInstance()) : Optional.empty();
        }
        
        <span class="hljs-comment">// è·å–æ‰€æœ‰æœåŠ¡å®ä¾‹</span>
        <span class="hljs-keyword">public</span> &lt;T&gt; List&lt;T&gt; <span class="hljs-title function_">getAllServices</span><span class="hljs-params">(Class&lt;T&gt; serviceType)</span> {
            List&lt;ServiceInstance&lt;?&gt;&gt; instances = registry.get(serviceType);
            <span class="hljs-keyword">if</span> (instances == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> Collections.emptyList();
            }
            
            <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
            List&lt;ServiceInstance&lt;T&gt;&gt; typedInstances = (List&lt;ServiceInstance&lt;T&gt;&gt;) instances;
            
            <span class="hljs-keyword">return</span> typedInstances.stream()
                .map(ServiceInstance::getInstance)
                .collect(Collectors.toList());
        }
        
        <span class="hljs-comment">// åŠ¨æ€æœåŠ¡å‘ç°ï¼ˆé€šè¿‡ServiceLoaderï¼‰</span>
        <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">discoverServices</span><span class="hljs-params">(Class&lt;T&gt; serviceType)</span> {
            ServiceLoader&lt;T&gt; loader = ServiceLoader.load(serviceType);
            <span class="hljs-keyword">for</span> (T service : loader) {
                register(serviceType, service);
            }
        }
        
        <span class="hljs-comment">// æŒ‰æ¨¡å—å¸è½½æœåŠ¡</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unloadServicesFromModule</span><span class="hljs-params">(String moduleName)</span> {
            <span class="hljs-keyword">for</span> (List&lt;ServiceInstance&lt;?&gt;&gt; services : registry.values()) {
                services.removeIf(service -&gt; {
                    <span class="hljs-type">String</span> <span class="hljs-variable">serviceModule</span> <span class="hljs-operator">=</span> service.getDescriptor()
                        .getMetadata().get(<span class="hljs-string">"module"</span>);
                    <span class="hljs-keyword">return</span> moduleName.equals(serviceModule);
                });
            }
            System.out.println(<span class="hljs-string">"å·²å¸è½½æ¨¡å— "</span> + moduleName + <span class="hljs-string">" çš„æ‰€æœ‰æœåŠ¡"</span>);
        }
        
        <span class="hljs-comment">// å¥åº·æ£€æŸ¥å’Œæ¸…ç†</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cleanup</span><span class="hljs-params">(<span class="hljs-type">long</span> maxIdleTimeMs)</span> {
            <span class="hljs-type">long</span> <span class="hljs-variable">cleaned</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (List&lt;ServiceInstance&lt;?&gt;&gt; services : registry.values()) {
                cleaned += services.removeIf(
                    service -&gt; service.getIdleTime() &gt; maxIdleTimeMs
                );
            }
            <span class="hljs-keyword">if</span> (cleaned &gt; <span class="hljs-number">0</span>) {
                System.out.println(<span class="hljs-string">"æ¸…ç†äº† "</span> + cleaned + <span class="hljs-string">" ä¸ªç©ºé—²æœåŠ¡"</span>);
            }
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== å¢å¼ºå‹æœåŠ¡æ³¨å†Œè¡¨æ¼”ç¤º ===\n"</span>);
        
        <span class="hljs-type">ModuleAwareServiceRegistry</span> <span class="hljs-variable">registry</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleAwareServiceRegistry</span>();
        
        <span class="hljs-comment">// å®šä¹‰æœåŠ¡æ¥å£</span>
        <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Calculator</span> {
            <span class="hljs-type">double</span> <span class="hljs-title function_">calculate</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b)</span>;
            String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>;
        }
        
        <span class="hljs-comment">// æ³¨å†Œä¸€äº›æœåŠ¡å®ç°</span>
        registry.register(Calculator.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Calculator</span>() {
            <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculate</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b)</span> { <span class="hljs-keyword">return</span> a + b; }
            <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">"åŠ æ³•è®¡ç®—å™¨"</span>; }
        });
        
        registry.register(Calculator.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Calculator</span>() {
            <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculate</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b)</span> { <span class="hljs-keyword">return</span> a * b; }
            <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">"ä¹˜æ³•è®¡ç®—å™¨"</span>; }
        });
        
        <span class="hljs-comment">// ä½¿ç”¨è‡ªå®šä¹‰æè¿°ç¬¦æ³¨å†Œ</span>
        ServiceDescriptor&lt;Calculator&gt; advancedDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServiceDescriptor</span>&lt;&gt;(
            Calculator.class, 
            <span class="hljs-string">"ç§‘å­¦è®¡ç®—å™¨"</span>, 
            <span class="hljs-string">"2.0.0"</span>, 
            <span class="hljs-number">50</span>, <span class="hljs-comment">// æ›´é«˜ä¼˜å…ˆçº§</span>
            Map.of(<span class="hljs-string">"category"</span>, <span class="hljs-string">"scientific"</span>, <span class="hljs-string">"author"</span>, <span class="hljs-string">"MathLab"</span>)
        );
        
        registry.register(Calculator.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Calculator</span>() {
            <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculate</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b)</span> { <span class="hljs-keyword">return</span> Math.pow(a, b); }
            <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">"å¹‚è¿ç®—è®¡ç®—å™¨"</span>; }
        }, advancedDesc);
        
        <span class="hljs-comment">// è·å–é»˜è®¤æœåŠ¡ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰</span>
        Optional&lt;Calculator&gt; defaultCalc = registry.getService(Calculator.class);
        defaultCalc.ifPresent(calc -&gt; {
            System.out.println(<span class="hljs-string">"é»˜è®¤è®¡ç®—å™¨: "</span> + calc.getName());
            System.out.println(<span class="hljs-string">"è®¡ç®— 2^3 = "</span> + calc.calculate(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>));
        });
        
        <span class="hljs-comment">// ä½¿ç”¨è¿‡æ»¤å™¨è·å–ç‰¹å®šæœåŠ¡</span>
        Optional&lt;Calculator&gt; scientificCalc = registry.getService(
            Calculator.class,
            desc -&gt; <span class="hljs-string">"scientific"</span>.equals(desc.getMetadata().get(<span class="hljs-string">"category"</span>))
        );
        
        scientificCalc.ifPresent(calc -&gt; {
            System.out.println(<span class="hljs-string">"\nç§‘å­¦è®¡ç®—å™¨: "</span> + calc.getName());
            System.out.println(<span class="hljs-string">"è®¡ç®— 2^3 = "</span> + calc.calculate(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>));
        });
        
        <span class="hljs-comment">// ä½¿ç”¨è‡ªå®šä¹‰é€‰æ‹©ç­–ç•¥ï¼ˆé€‰æ‹©æœ€æ—§çš„æœåŠ¡ï¼‰</span>
        Optional&lt;Calculator&gt; oldestCalc = registry.getService(
            Calculator.class,
            desc -&gt; <span class="hljs-literal">true</span>,
            instances -&gt; instances.stream()
                .max(Comparator.comparingLong(ServiceInstance::getAge))
                .orElse(<span class="hljs-literal">null</span>)
        );
        
        oldestCalc.ifPresent(calc -&gt; 
            System.out.println(<span class="hljs-string">"\næœ€æ—§çš„è®¡ç®—å™¨: "</span> + calc.getName()));
        
        <span class="hljs-comment">// è·å–æ‰€æœ‰æœåŠ¡</span>
        System.out.println(<span class="hljs-string">"\næ‰€æœ‰å¯ç”¨è®¡ç®—å™¨:"</span>);
        registry.getAllServices(Calculator.class).forEach(calc -&gt; 
            System.out.println(<span class="hljs-string">"  - "</span> + calc.getName()));
        
        <span class="hljs-comment">// åŠ¨æ€æœåŠ¡å‘ç°æ¼”ç¤º</span>
        System.out.println(<span class="hljs-string">"\n=== åŠ¨æ€æœåŠ¡å‘ç° ==="</span>);
        registry.discoverServices(Calculator.class);
        
        <span class="hljs-comment">// æ¸…ç†ç©ºé—²æœåŠ¡</span>
        System.out.println(<span class="hljs-string">"\n=== æœåŠ¡æ¸…ç† ==="</span>);
        registry.cleanup(<span class="hljs-number">60000</span>); <span class="hljs-comment">// æ¸…ç†ç©ºé—²è¶…è¿‡60ç§’çš„æœåŠ¡</span>
    }
}
</code></pre>
<h2 data-id="heading-10">å››ã€æ¨¡å—åŒ–åº”ç”¨æ‰“åŒ…ä¸éƒ¨ç½²</h2>
<h3 data-id="heading-11">4.1 JLinkï¼šåˆ›å»ºè‡ªå®šä¹‰è¿è¡Œæ—¶æ˜ åƒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.nio.file.*;
<span class="hljs-keyword">import</span> java.util.*;
<span class="hljs-keyword">import</span> java.util.spi.ToolProvider;

<span class="hljs-comment">// JLinkå·¥å…·å°è£…</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JLinkPackager</span> {
    
    <span class="hljs-comment">// JLinké…ç½®</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JLinkConfig</span> {
        String modulePath;
        List&lt;String&gt; modules;
        String outputDir;
        String launcherName;
        Map&lt;String, String&gt; launcherArgs;
        <span class="hljs-type">boolean</span> <span class="hljs-variable">compress</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
        <span class="hljs-type">boolean</span> <span class="hljs-variable">stripDebug</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
        <span class="hljs-type">boolean</span> <span class="hljs-variable">includeHeaderFiles</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
        List&lt;String&gt; additionalOptions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        JLinkConfig(String modulePath, List&lt;String&gt; modules, String outputDir) {
            <span class="hljs-built_in">this</span>.modulePath = modulePath;
            <span class="hljs-built_in">this</span>.modules = modules;
            <span class="hljs-built_in">this</span>.outputDir = outputDir;
        }
        
        <span class="hljs-comment">// ç”ŸæˆJLinkå‘½ä»¤å‚æ•°</span>
        List&lt;String&gt; <span class="hljs-title function_">buildArguments</span><span class="hljs-params">()</span> {
            List&lt;String&gt; args = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
            
            <span class="hljs-comment">// åŸºæœ¬å‚æ•°</span>
            args.add(<span class="hljs-string">"--module-path"</span>);
            args.add(modulePath);
            
            args.add(<span class="hljs-string">"--add-modules"</span>);
            args.add(String.join(<span class="hljs-string">","</span>, modules));
            
            <span class="hljs-comment">// è¾“å‡ºç›®å½•</span>
            args.add(<span class="hljs-string">"--output"</span>);
            args.add(outputDir);
            
            <span class="hljs-comment">// å¯é€‰å‚æ•°</span>
            <span class="hljs-keyword">if</span> (compress) {
                args.add(<span class="hljs-string">"--compress=2"</span>); <span class="hljs-comment">// 0=æ— , 1=å¸¸é‡å­—ç¬¦ä¸², 2=ZIP</span>
            }
            
            <span class="hljs-keyword">if</span> (stripDebug) {
                args.add(<span class="hljs-string">"--strip-debug"</span>);
            }
            
            <span class="hljs-keyword">if</span> (!includeHeaderFiles) {
                args.add(<span class="hljs-string">"--no-header-files"</span>);
                args.add(<span class="hljs-string">"--no-man-pages"</span>);
            }
            
            <span class="hljs-comment">// å¯åŠ¨å™¨é…ç½®</span>
            <span class="hljs-keyword">if</span> (launcherName != <span class="hljs-literal">null</span> &amp;&amp; !modules.isEmpty()) {
                args.add(<span class="hljs-string">"--launcher"</span>);
                <span class="hljs-type">String</span> <span class="hljs-variable">launcherCmd</span> <span class="hljs-operator">=</span> launcherName + <span class="hljs-string">"="</span> + modules.get(<span class="hljs-number">0</span>);
                <span class="hljs-keyword">if</span> (launcherArgs != <span class="hljs-literal">null</span> &amp;&amp; !launcherArgs.isEmpty()) {
                    launcherCmd += launcherArgs.entrySet().stream()
                        .map(e -&gt; e.getKey() + <span class="hljs-string">"="</span> + e.getValue())
                        .reduce(<span class="hljs-string">""</span>, (a, b) -&gt; a.isEmpty() ? b : a + <span class="hljs-string">" "</span> + b);
                }
                args.add(launcherCmd);
            }
            
            <span class="hljs-comment">// é¢å¤–é€‰é¡¹</span>
            args.addAll(additionalOptions);
            
            <span class="hljs-keyword">return</span> args;
        }
    }
    
    <span class="hljs-comment">// è‡ªå®šä¹‰æ˜ åƒæ„å»ºå™¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomRuntimeBuilder</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> JLinkConfig config;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Path&gt; moduleJars = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">CustomRuntimeBuilder</span><span class="hljs-params">(String outputDir)</span> {
            <span class="hljs-built_in">this</span>.config = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JLinkConfig</span>(<span class="hljs-string">""</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(), outputDir);
        }
        
        <span class="hljs-comment">// æ·»åŠ æ¨¡å—JAR</span>
        <span class="hljs-keyword">public</span> CustomRuntimeBuilder <span class="hljs-title function_">addModule</span><span class="hljs-params">(Path moduleJar)</span> {
            moduleJars.add(moduleJar);
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }
        
        <span class="hljs-comment">// æ·»åŠ æ¨¡å—ç›®å½•</span>
        <span class="hljs-keyword">public</span> CustomRuntimeBuilder <span class="hljs-title function_">addModuleDirectory</span><span class="hljs-params">(Path moduleDir)</span> {
            <span class="hljs-keyword">try</span> {
                Files.list(moduleDir)
                    .filter(p -&gt; p.toString().endsWith(<span class="hljs-string">".jar"</span>))
                    .forEach(moduleJars::add);
            } <span class="hljs-keyword">catch</span> (Exception e) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ— æ³•è¯»å–æ¨¡å—ç›®å½•: "</span> + moduleDir, e);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }
        
        <span class="hljs-comment">// è®¾ç½®æ¨¡å—è·¯å¾„</span>
        <span class="hljs-keyword">public</span> CustomRuntimeBuilder <span class="hljs-title function_">setModulePath</span><span class="hljs-params">(String modulePath)</span> {
            config.modulePath = modulePath;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }
        
        <span class="hljs-comment">// æ·»åŠ æ¨¡å—</span>
        <span class="hljs-keyword">public</span> CustomRuntimeBuilder <span class="hljs-title function_">addModule</span><span class="hljs-params">(String moduleName)</span> {
            config.modules.add(moduleName);
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }
        
        <span class="hljs-comment">// è®¾ç½®å¯åŠ¨å™¨</span>
        <span class="hljs-keyword">public</span> CustomRuntimeBuilder <span class="hljs-title function_">withLauncher</span><span class="hljs-params">(String name, 
                                                Map&lt;String, String&gt; args)</span> {
            config.launcherName = name;
            config.launcherArgs = args;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }
        
        <span class="hljs-comment">// æ„å»ºè¿è¡Œæ—¶æ˜ åƒ</span>
        <span class="hljs-keyword">public</span> Path <span class="hljs-title function_">build</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
            <span class="hljs-comment">// å¦‚æœæœªæ˜¾å¼è®¾ç½®æ¨¡å—è·¯å¾„ï¼Œåˆ™è‡ªåŠ¨æ„å»º</span>
            <span class="hljs-keyword">if</span> (config.modulePath.isEmpty() &amp;&amp; !moduleJars.isEmpty()) {
                config.modulePath = buildModulePath();
            }
            
            <span class="hljs-comment">// æ‰§è¡ŒJLink</span>
            <span class="hljs-type">ToolProvider</span> <span class="hljs-variable">jlink</span> <span class="hljs-operator">=</span> ToolProvider.findFirst(<span class="hljs-string">"jlink"</span>)
                .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"JLinkå·¥å…·ä¸å¯ç”¨"</span>));
            
            List&lt;String&gt; args = config.buildArguments();
            System.out.println(<span class="hljs-string">"æ‰§è¡ŒJLinkå‘½ä»¤:"</span>);
            System.out.println(<span class="hljs-string">"jlink "</span> + String.join(<span class="hljs-string">" "</span>, args));
            
            <span class="hljs-comment">// åˆ›å»ºè¾“å‡ºç›®å½•</span>
            <span class="hljs-type">Path</span> <span class="hljs-variable">outputPath</span> <span class="hljs-operator">=</span> Paths.get(config.outputDir);
            <span class="hljs-keyword">if</span> (Files.exists(outputPath)) {
                deleteDirectory(outputPath);
            }
            
            <span class="hljs-comment">// è¿è¡ŒJLink</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">exitCode</span> <span class="hljs-operator">=</span> jlink.run(System.out, System.err, 
                args.toArray(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[<span class="hljs-number">0</span>]));
            
            <span class="hljs-keyword">if</span> (exitCode != <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"JLinkæ‰§è¡Œå¤±è´¥ï¼Œé€€å‡ºç : "</span> + exitCode);
            }
            
            <span class="hljs-comment">// éªŒè¯ç”Ÿæˆçš„è¿è¡Œæ—¶</span>
            validateRuntime(outputPath);
            
            <span class="hljs-keyword">return</span> outputPath;
        }
        
        <span class="hljs-keyword">private</span> String <span class="hljs-title function_">buildModulePath</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> moduleJars.stream()
                .map(Path::toString)
                .collect(Collectors.joining(File.pathSeparator));
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">validateRuntime</span><span class="hljs-params">(Path runtimeDir)</span> <span class="hljs-keyword">throws</span> Exception {
            System.out.println(<span class="hljs-string">"\néªŒè¯è¿è¡Œæ—¶æ˜ åƒ:"</span>);
            
            <span class="hljs-comment">// æ£€æŸ¥å¿…è¦çš„ç›®å½•</span>
            <span class="hljs-type">Path</span> <span class="hljs-variable">binDir</span> <span class="hljs-operator">=</span> runtimeDir.resolve(<span class="hljs-string">"bin"</span>);
            <span class="hljs-type">Path</span> <span class="hljs-variable">libDir</span> <span class="hljs-operator">=</span> runtimeDir.resolve(<span class="hljs-string">"lib"</span>);
            
            <span class="hljs-keyword">if</span> (!Files.exists(binDir) || !Files.exists(libDir)) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è¿è¡Œæ—¶æ˜ åƒç»“æ„ä¸æ­£ç¡®"</span>);
            }
            
            System.out.println(<span class="hljs-string">"âœ“ ç›®å½•ç»“æ„éªŒè¯é€šè¿‡"</span>);
            
            <span class="hljs-comment">// æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶</span>
            <span class="hljs-keyword">if</span> (config.launcherName != <span class="hljs-literal">null</span>) {
                <span class="hljs-type">Path</span> <span class="hljs-variable">launcher</span> <span class="hljs-operator">=</span> getLauncherPath(binDir, config.launcherName);
                <span class="hljs-keyword">if</span> (Files.exists(launcher) &amp;&amp; Files.isExecutable(launcher)) {
                    System.out.println(<span class="hljs-string">"âœ“ å¯åŠ¨å™¨æ–‡ä»¶åˆ›å»ºæˆåŠŸ: "</span> + launcher);
                }
            }
            
            <span class="hljs-comment">// æ£€æŸ¥æ¨¡å—åº“</span>
            <span class="hljs-keyword">try</span> (DirectoryStream&lt;Path&gt; stream = 
                    Files.newDirectoryStream(libDir, <span class="hljs-string">"*.so"</span>)) {
                <span class="hljs-keyword">if</span> (stream.iterator().hasNext()) {
                    System.out.println(<span class="hljs-string">"âœ“ æœ¬åœ°åº“æ–‡ä»¶å­˜åœ¨"</span>);
                }
            }
            
            <span class="hljs-comment">// è®¡ç®—æ˜ åƒå¤§å°</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> calculateDirectorySize(runtimeDir);
            System.out.printf(<span class="hljs-string">"âœ“ è¿è¡Œæ—¶æ˜ åƒå¤§å°: %.2f MB%n"</span>, size / <span class="hljs-number">1024.0</span> / <span class="hljs-number">1024.0</span>);
        }
        
        <span class="hljs-keyword">private</span> Path <span class="hljs-title function_">getLauncherPath</span><span class="hljs-params">(Path binDir, String launcherName)</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">osName</span> <span class="hljs-operator">=</span> System.getProperty(<span class="hljs-string">"os.name"</span>).toLowerCase();
            <span class="hljs-type">String</span> <span class="hljs-variable">extension</span> <span class="hljs-operator">=</span> osName.contains(<span class="hljs-string">"win"</span>) ? <span class="hljs-string">".exe"</span> : <span class="hljs-string">""</span>;
            <span class="hljs-keyword">return</span> binDir.resolve(launcherName + extension);
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-title function_">calculateDirectorySize</span><span class="hljs-params">(Path dir)</span> <span class="hljs-keyword">throws</span> Exception {
            <span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">stream</span> <span class="hljs-operator">=</span> Files.walk(dir)) {
                <span class="hljs-keyword">return</span> stream.filter(Files::isRegularFile)
                    .mapToLong(p -&gt; {
                        <span class="hljs-keyword">try</span> { <span class="hljs-keyword">return</span> Files.size(p); }
                        <span class="hljs-keyword">catch</span> (Exception e) { <span class="hljs-keyword">return</span> <span class="hljs-number">0L</span>; }
                    })
                    .sum();
            }
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteDirectory</span><span class="hljs-params">(Path dir)</span> <span class="hljs-keyword">throws</span> Exception {
            <span class="hljs-keyword">if</span> (Files.exists(dir)) {
                <span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">stream</span> <span class="hljs-operator">=</span> Files.walk(dir)) {
                    stream.sorted(Comparator.reverseOrder())
                        .forEach(p -&gt; {
                            <span class="hljs-keyword">try</span> { Files.delete(p); }
                            <span class="hljs-keyword">catch</span> (Exception e) { <span class="hljs-comment">/* å¿½ç•¥ */</span> }
                        });
                }
            }
        }
    }
    
    <span class="hljs-comment">// æ¨¡å—ä¾èµ–åˆ†æå™¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModuleDependencyAnalyzer</span> {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Set&lt;String&gt; <span class="hljs-title function_">analyzeDependencies</span><span class="hljs-params">(String mainModule, 
                                                     String modulePath)</span> {
            Set&lt;String&gt; allModules = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashSet</span>&lt;&gt;();
            allModules.add(mainModule);
            
            <span class="hljs-comment">// é€’å½’æ”¶é›†ä¼ é€’ä¾èµ–</span>
            collectDependencies(mainModule, modulePath, allModules);
            
            <span class="hljs-keyword">return</span> allModules;
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">collectDependencies</span><span class="hljs-params">(String moduleName, 
                                               String modulePath, 
                                               Set&lt;String&gt; collected)</span> {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// ä½¿ç”¨javaå‘½ä»¤åˆ†ææ¨¡å—</span>
                <span class="hljs-type">ProcessBuilder</span> <span class="hljs-variable">pb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>(
                    <span class="hljs-string">"java"</span>,
                    <span class="hljs-string">"--module-path"</span>, modulePath,
                    <span class="hljs-string">"--module"</span>, <span class="hljs-string">"java.base/jdk.internal.module.ModuleAnalyzer"</span>,
                    moduleName
                );
                
                <span class="hljs-type">Process</span> <span class="hljs-variable">process</span> <span class="hljs-operator">=</span> pb.start();
                <span class="hljs-type">String</span> <span class="hljs-variable">output</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(process.getInputStream().readAllBytes());
                
                <span class="hljs-comment">// è§£æè¾“å‡ºï¼Œè·å–ä¾èµ–æ¨¡å—</span>
                <span class="hljs-comment">// è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…éœ€è¦è§£æè¯¦ç»†çš„æ¨¡å—ä¾èµ–ä¿¡æ¯</span>
                String[] lines = output.split(<span class="hljs-string">"\n"</span>);
                <span class="hljs-keyword">for</span> (String line : lines) {
                    <span class="hljs-keyword">if</span> (line.contains(<span class="hljs-string">"requires"</span>) &amp;&amp; !line.contains(<span class="hljs-string">"java.base"</span>)) {
                        <span class="hljs-type">String</span> <span class="hljs-variable">depModule</span> <span class="hljs-operator">=</span> extractModuleName(line);
                        <span class="hljs-keyword">if</span> (depModule != <span class="hljs-literal">null</span> &amp;&amp; !collected.contains(depModule)) {
                            collected.add(depModule);
                            collectDependencies(depModule, modulePath, collected);
                        }
                    }
                }
                
            } <span class="hljs-keyword">catch</span> (Exception e) {
                System.err.println(<span class="hljs-string">"æ¨¡å—ä¾èµ–åˆ†æå¤±è´¥: "</span> + e.getMessage());
            }
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">extractModuleName</span><span class="hljs-params">(String line)</span> {
            <span class="hljs-comment">// ç®€å•æå–æ¨¡å—åï¼Œå®é™…éœ€è¦æ›´å¤æ‚çš„è§£æ</span>
            String[] parts = line.trim().split(<span class="hljs-string">"\s+"</span>);
            <span class="hljs-keyword">for</span> (String part : parts) {
                <span class="hljs-keyword">if</span> (!part.isEmpty() &amp;&amp; !part.equals(<span class="hljs-string">"requires"</span>) &amp;&amp; 
                    !part.equals(<span class="hljs-string">"transitive"</span>) &amp;&amp; !part.equals(<span class="hljs-string">"static"</span>)) {
                    <span class="hljs-keyword">return</span> part;
                }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"=== JLinkè‡ªå®šä¹‰è¿è¡Œæ—¶æ˜ åƒæ„å»º ===\n"</span>);
        
        <span class="hljs-comment">// ç¤ºä¾‹ï¼šæ„å»ºä¸€ä¸ªç®€å•çš„æ§åˆ¶å°åº”ç”¨è¿è¡Œæ—¶</span>
        
        <span class="hljs-comment">// 1. å‡†å¤‡æ¨¡å—</span>
        <span class="hljs-type">Path</span> <span class="hljs-variable">modulesDir</span> <span class="hljs-operator">=</span> Paths.get(<span class="hljs-string">"modules"</span>);
        <span class="hljs-keyword">if</span> (!Files.exists(modulesDir)) {
            Files.createDirectories(modulesDir);
            
            <span class="hljs-comment">// è¿™é‡Œåº”è¯¥æ”¾ç½®ç¼–è¯‘å¥½çš„æ¨¡å—JARæ–‡ä»¶</span>
            <span class="hljs-comment">// ä¾‹å¦‚ï¼šcom.example.app.jar, com.example.utils.jar ç­‰</span>
        }
        
        <span class="hljs-comment">// 2. é…ç½®JLink</span>
        <span class="hljs-type">CustomRuntimeBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomRuntimeBuilder</span>(<span class="hljs-string">"myruntime"</span>);
        
        builder.addModuleDirectory(modulesDir)
               .addModule(<span class="hljs-string">"com.example.app"</span>) <span class="hljs-comment">// ä¸»æ¨¡å—</span>
               .withLauncher(<span class="hljs-string">"myapp"</span>, Map.of(<span class="hljs-string">"main-class"</span>, 
                   <span class="hljs-string">"com.example.app.Main"</span>));
        
        <span class="hljs-comment">// 3. åˆ†æä¾èµ–ï¼ˆå¯é€‰ï¼‰</span>
        Set&lt;String&gt; dependencies = ModuleDependencyAnalyzer.analyzeDependencies(
            <span class="hljs-string">"com.example.app"</span>, 
            modulesDir.toString()
        );
        
        System.out.println(<span class="hljs-string">"æ¨¡å—ä¾èµ–åˆ†æç»“æœ:"</span>);
        dependencies.forEach(mod -&gt; System.out.println(<span class="hljs-string">"  - "</span> + mod));
        
        <span class="hljs-comment">// 4. æ„å»ºè¿è¡Œæ—¶</span>
        <span class="hljs-type">Path</span> <span class="hljs-variable">runtime</span> <span class="hljs-operator">=</span> builder.build();
        
        System.out.println(<span class="hljs-string">"\n=== è¿è¡Œæ—¶æ˜ åƒæ„å»ºå®Œæˆ ==="</span>);
        System.out.println(<span class="hljs-string">"ä½ç½®: "</span> + runtime.toAbsolutePath());
        
        <span class="hljs-comment">// 5. åˆ›å»ºå¯åŠ¨è„šæœ¬</span>
        createLaunchScripts(runtime);
        
        <span class="hljs-comment">// 6. æµ‹è¯•è¿è¡Œæ—¶</span>
        testRuntime(runtime);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createLaunchScripts</span><span class="hljs-params">(Path runtimeDir)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Path</span> <span class="hljs-variable">binDir</span> <span class="hljs-operator">=</span> runtimeDir.resolve(<span class="hljs-string">"bin"</span>);
        
        <span class="hljs-comment">// åˆ›å»ºWindowsæ‰¹å¤„ç†è„šæœ¬</span>
        <span class="hljs-type">Path</span> <span class="hljs-variable">windowsScript</span> <span class="hljs-operator">=</span> binDir.resolve(<span class="hljs-string">"launch.bat"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">windowsContent</span> <span class="hljs-operator">=</span> <span class="hljs-string">"@echo off\n"</span> +
            <span class="hljs-string">"setlocal\n"</span> +
            <span class="hljs-string">"set JAVA_HOME=%~dp0..\n"</span> +
            <span class="hljs-string">"set PATH=%%JAVA_HOME%%\bin;%%PATH%%\n"</span> +
            <span class="hljs-string">"java --module-path ..\lib --module com.example.app/com.example.app.Main %%*\n"</span>;
        Files.writeString(windowsScript, windowsContent);
        
        <span class="hljs-comment">// åˆ›å»ºUnix/Linux Shellè„šæœ¬</span>
        <span class="hljs-type">Path</span> <span class="hljs-variable">unixScript</span> <span class="hljs-operator">=</span> binDir.resolve(<span class="hljs-string">"launch.sh"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">unixContent</span> <span class="hljs-operator">=</span> <span class="hljs-string">"#!/bin/bash\n"</span> +
            <span class="hljs-string">"DIR="</span>$( cd <span class="hljs-string">"$( dirname "</span>${BASH_SOURCE[<span class="hljs-number">0</span>]}<span class="hljs-string">" )"</span> &amp;&amp; pwd )<span class="hljs-string">"\n"</span> +
            <span class="hljs-string">"export JAVA_HOME="</span>$DIR/..<span class="hljs-string">"\n"</span> +
            <span class="hljs-string">"export PATH="</span>$JAVA_HOME/bin:$PATH<span class="hljs-string">"\n"</span> +
            <span class="hljs-string">"java --module-path ../lib --module com.example.app/com.example.app.Main "</span>$@<span class="hljs-string">"\n"</span>;
        Files.writeString(unixScript, unixContent);
        Files.setPosixFilePermissions(unixScript, 
            Set.of(PosixFilePermission.OWNER_EXECUTE,
                   PosixFilePermission.OWNER_READ,
                   PosixFilePermission.OWNER_WRITE));
        
        System.out.println(<span class="hljs-string">"\nå¯åŠ¨è„šæœ¬å·²åˆ›å»º:"</span>);
        System.out.println(<span class="hljs-string">"  Windows: launch.bat"</span>);
        System.out.println(<span class="hljs-string">"  Unix/Linux: launch.sh"</span>);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testRuntime</span><span class="hljs-params">(Path runtimeDir)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"\n=== æµ‹è¯•è¿è¡Œæ—¶æ˜ åƒ ==="</span>);
        
        Path javaExecutable;
        <span class="hljs-type">String</span> <span class="hljs-variable">osName</span> <span class="hljs-operator">=</span> System.getProperty(<span class="hljs-string">"os.name"</span>).toLowerCase();
        
        <span class="hljs-keyword">if</span> (osName.contains(<span class="hljs-string">"win"</span>)) {
            javaExecutable = runtimeDir.resolve(<span class="hljs-string">"bin"</span>).resolve(<span class="hljs-string">"java.exe"</span>);
        } <span class="hljs-keyword">else</span> {
            javaExecutable = runtimeDir.resolve(<span class="hljs-string">"bin"</span>).resolve(<span class="hljs-string">"java"</span>);
        }
        
        <span class="hljs-keyword">if</span> (!Files.exists(javaExecutable)) {
            System.err.println(<span class="hljs-string">"Javaå¯æ‰§è¡Œæ–‡ä»¶ä¸å­˜åœ¨: "</span> + javaExecutable);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// æµ‹è¯•Javaç‰ˆæœ¬</span>
        <span class="hljs-type">ProcessBuilder</span> <span class="hljs-variable">pb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>(
            javaExecutable.toString(),
            <span class="hljs-string">"--version"</span>
        );
        
        <span class="hljs-type">Process</span> <span class="hljs-variable">process</span> <span class="hljs-operator">=</span> pb.start();
        <span class="hljs-type">String</span> <span class="hljs-variable">output</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(process.getInputStream().readAllBytes());
        
        System.out.println(<span class="hljs-string">"Javaç‰ˆæœ¬ä¿¡æ¯:"</span>);
        System.out.println(output);
        
        <span class="hljs-comment">// æµ‹è¯•æ¨¡å—åˆ—è¡¨</span>
        pb = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>(
            javaExecutable.toString(),
            <span class="hljs-string">"--list-modules"</span>
        );
        
        process = pb.start();
        output = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(process.getInputStream().readAllBytes());
        
        System.out.println(<span class="hljs-string">"åŒ…å«çš„æ¨¡å—:"</span>);
        System.out.println(output);
        
        System.out.println(<span class="hljs-string">"âœ“ è¿è¡Œæ—¶æ˜ åƒæµ‹è¯•é€šè¿‡"</span>);
    }
}
</code></pre>
<h2 data-id="heading-12">äº”ã€æ¨¡å—åŒ–è¿ç§»ç­–ç•¥ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-13">5.1 ä»ä¼ ç»Ÿåº”ç”¨åˆ°æ¨¡å—åŒ–åº”ç”¨çš„è¿ç§»</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.nio.file.*;
<span class="hljs-keyword">import</span> java.util.*;

<span class="hljs-comment">// æ¨¡å—åŒ–è¿ç§»åŠ©æ‰‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModularMigrationHelper</span> {
    
    <span class="hljs-comment">// è¿ç§»æ­¥éª¤è·Ÿè¸ªå™¨</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MigrationTracker</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Path projectRoot;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, MigrationStatus&gt; modules = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;String&gt; migrationSteps = Arrays.asList(
            <span class="hljs-string">"åˆ†æç°æœ‰ä¾èµ–"</span>,
            <span class="hljs-string">"åˆ›å»ºæ¨¡å—æè¿°ç¬¦"</span>,
            <span class="hljs-string">"è§£å†³ä¾èµ–å†²çª"</span>,
            <span class="hljs-string">"é‡æ„åŒ…ç»“æ„"</span>,
            <span class="hljs-string">"æµ‹è¯•æ¨¡å—éš”ç¦»"</span>,
            <span class="hljs-string">"æ„å»ºæ¨¡å—åŒ–JAR"</span>,
            <span class="hljs-string">"åˆ›å»ºè¿è¡Œæ—¶æ˜ åƒ"</span>
        );
        
        <span class="hljs-keyword">enum</span> <span class="hljs-title class_">MigrationStatus</span> {
            NOT_STARTED,
            ANALYZING,
            IN_PROGRESS,
            COMPLETED,
            BLOCKED
        }
        
        MigrationTracker(Path projectRoot) {
            <span class="hljs-built_in">this</span>.projectRoot = projectRoot;
        }
        
        <span class="hljs-comment">// åˆ†æé¡¹ç›®ç»“æ„</span>
        <span class="hljs-keyword">public</span> ProjectAnalysis <span class="hljs-title function_">analyze</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
            <span class="hljs-type">ProjectAnalysis</span> <span class="hljs-variable">analysis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProjectAnalysis</span>();
            
            <span class="hljs-comment">// æ‰«æé¡¹ç›®ç›®å½•</span>
            <span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">stream</span> <span class="hljs-operator">=</span> Files.walk(projectRoot)) {
                stream.filter(Files::isRegularFile)
                    .filter(p -&gt; p.toString().endsWith(<span class="hljs-string">".java"</span>))
                    .forEach(p -&gt; analysis.addJavaFile(p));
                
                stream.filter(Files::isRegularFile)
                    .filter(p -&gt; p.toString().endsWith(<span class="hljs-string">".jar"</span>))
                    .forEach(p -&gt; analysis.addJarFile(p));
            }
            
            <span class="hljs-comment">// åˆ†æä¾èµ–</span>
            analysis.analyzeDependencies();
            
            <span class="hljs-keyword">return</span> analysis;
        }
        
        <span class="hljs-comment">// ç”Ÿæˆè¿ç§»è®¡åˆ’</span>
        <span class="hljs-keyword">public</span> MigrationPlan <span class="hljs-title function_">generatePlan</span><span class="hljs-params">(ProjectAnalysis analysis)</span> {
            <span class="hljs-type">MigrationPlan</span> <span class="hljs-variable">plan</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MigrationPlan</span>();
            
            <span class="hljs-comment">// è¯†åˆ«æ½œåœ¨çš„æ¨¡å—</span>
            Set&lt;String&gt; packageRoots = analysis.getPackageRoots();
            <span class="hljs-keyword">for</span> (String pkgRoot : packageRoots) {
                <span class="hljs-type">MigrationModule</span> <span class="hljs-variable">module</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MigrationModule</span>(pkgRoot);
                
                <span class="hljs-comment">// åˆ†ææ¨¡å—ä¾èµ–</span>
                Set&lt;String&gt; dependencies = analysis.getDependenciesForPackage(pkgRoot);
                <span class="hljs-keyword">module</span>.setDependencies(dependencies);
                
                <span class="hljs-comment">// ç¡®å®šè¿ç§»ä¼˜å…ˆçº§</span>
                <span class="hljs-type">int</span> <span class="hljs-variable">priority</span> <span class="hljs-operator">=</span> calculatePriority(pkgRoot, dependencies);
                <span class="hljs-keyword">module</span>.setPriority(priority);
                
                plan.addModule(<span class="hljs-keyword">module</span>);
            }
            
            <span class="hljs-comment">// æ’åºæ¨¡å—ï¼ˆä»ä¾èµ–å°‘çš„å¼€å§‹ï¼‰</span>
            plan.sortModules();
            
            <span class="hljs-keyword">return</span> plan;
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">calculatePriority</span><span class="hljs-params">(String pkgRoot, Set&lt;String&gt; dependencies)</span> {
            <span class="hljs-comment">// ä¾èµ–è¶Šå°‘ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼ˆè¶Šå®¹æ˜“è¿ç§»ï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">dependencyCount</span> <span class="hljs-operator">=</span> dependencies.size();
            
            <span class="hljs-comment">// æ ¸å¿ƒåŒ…ä¼˜å…ˆçº§æ›´é«˜</span>
            <span class="hljs-keyword">if</span> (pkgRoot.startsWith(<span class="hljs-string">"com.example.core"</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
            }
            
            <span class="hljs-keyword">return</span> Math.max(<span class="hljs-number">2</span>, <span class="hljs-number">10</span> - dependencyCount);
        }
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProjectAnalysis</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Path&gt; javaFiles = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Path&gt; jarFiles = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Set&lt;String&gt;&gt; packageDependencies = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">addJavaFile</span><span class="hljs-params">(Path file)</span> { javaFiles.add(file); }
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">addJarFile</span><span class="hljs-params">(Path file)</span> { jarFiles.add(file); }
        
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">analyzeDependencies</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
            <span class="hljs-comment">// ç®€åŒ–çš„ä¾èµ–åˆ†æ</span>
            <span class="hljs-keyword">for</span> (Path javaFile : javaFiles) {
                <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> Files.readString(javaFile);
                <span class="hljs-type">String</span> <span class="hljs-variable">packageName</span> <span class="hljs-operator">=</span> extractPackageName(content);
                
                <span class="hljs-keyword">if</span> (packageName != <span class="hljs-literal">null</span>) {
                    Set&lt;String&gt; imports = extractImports(content);
                    packageDependencies.put(packageName, imports);
                }
            }
        }
        
        Set&lt;String&gt; <span class="hljs-title function_">getPackageRoots</span><span class="hljs-params">()</span> {
            Set&lt;String&gt; roots = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
            <span class="hljs-keyword">for</span> (String pkg : packageDependencies.keySet()) {
                <span class="hljs-type">String</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> pkg.split(<span class="hljs-string">"\."</span>)[<span class="hljs-number">0</span>]; <span class="hljs-comment">// ç®€å•çš„æ ¹åŒ…æå–</span>
                roots.add(root);
            }
            <span class="hljs-keyword">return</span> roots;
        }
        
        Set&lt;String&gt; <span class="hljs-title function_">getDependenciesForPackage</span><span class="hljs-params">(String pkgRoot)</span> {
            Set&lt;String&gt; deps = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
            <span class="hljs-keyword">for</span> (Map.Entry&lt;String, Set&lt;String&gt;&gt; entry : packageDependencies.entrySet()) {
                <span class="hljs-keyword">if</span> (entry.getKey().startsWith(pkgRoot)) {
                    deps.addAll(entry.getValue());
                }
            }
            <span class="hljs-keyword">return</span> deps;
        }
        
        <span class="hljs-keyword">private</span> String <span class="hljs-title function_">extractPackageName</span><span class="hljs-params">(String content)</span> {
            <span class="hljs-comment">// ç®€å•çš„åŒ…åæå–</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">packageIndex</span> <span class="hljs-operator">=</span> content.indexOf(<span class="hljs-string">"package "</span>);
            <span class="hljs-keyword">if</span> (packageIndex &gt;= <span class="hljs-number">0</span>) {
                <span class="hljs-type">int</span> <span class="hljs-variable">endIndex</span> <span class="hljs-operator">=</span> content.indexOf(<span class="hljs-string">";"</span>, packageIndex);
                <span class="hljs-keyword">if</span> (endIndex &gt;= <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">return</span> content.substring(packageIndex + <span class="hljs-number">8</span>, endIndex).trim();
                }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        <span class="hljs-keyword">private</span> Set&lt;String&gt; <span class="hljs-title function_">extractImports</span><span class="hljs-params">(String content)</span> {
            Set&lt;String&gt; imports = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
            String[] lines = content.split(<span class="hljs-string">"\n"</span>);
            
            <span class="hljs-keyword">for</span> (String line : lines) {
                line = line.trim();
                <span class="hljs-keyword">if</span> (line.startsWith(<span class="hljs-string">"import "</span>)) {
                    <span class="hljs-type">String</span> <span class="hljs-variable">importStmt</span> <span class="hljs-operator">=</span> line.substring(<span class="hljs-number">7</span>, line.indexOf(<span class="hljs-string">";"</span>));
                    imports.add(importStmt);
                }
            }
            
            <span class="hljs-keyword">return</span> imports;
        }
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MigrationPlan</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;MigrationModule&gt; modules = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">addModule</span><span class="hljs-params">(MigrationModule <span class="hljs-keyword">module</span>)</span> {
            modules.add(<span class="hljs-keyword">module</span>);
        }
        
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">sortModules</span><span class="hljs-params">()</span> {
            modules.sort(Comparator.comparingInt(MigrationModule::getPriority));
        }
        
        <span class="hljs-keyword">public</span> List&lt;MigrationModule&gt; <span class="hljs-title function_">getModules</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> Collections.unmodifiableList(modules);
        }
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MigrationModule</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;
        <span class="hljs-keyword">private</span> Set&lt;String&gt; dependencies = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> priority;
        <span class="hljs-keyword">private</span> String moduleInfoTemplate;
        
        MigrationModule(String name) {
            <span class="hljs-built_in">this</span>.name = name;
        }
        
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDependencies</span><span class="hljs-params">(Set&lt;String&gt; dependencies)</span> {
            <span class="hljs-built_in">this</span>.dependencies = dependencies;
        }
        
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPriority</span><span class="hljs-params">(<span class="hljs-type">int</span> priority)</span> {
            <span class="hljs-built_in">this</span>.priority = priority;
        }
        
        String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> name; }
        Set&lt;String&gt; <span class="hljs-title function_">getDependencies</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> dependencies; }
        <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> priority; }
        
        <span class="hljs-comment">// ç”Ÿæˆmodule-info.javaæ¨¡æ¿</span>
        String <span class="hljs-title function_">generateModuleInfo</span><span class="hljs-params">()</span> {
            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
            sb.append(<span class="hljs-string">"module "</span>).append(name).append(<span class="hljs-string">" {\n"</span>);
            
            <span class="hljs-comment">// æ·»åŠ ä¾èµ–</span>
            <span class="hljs-keyword">for</span> (String dep : dependencies) {
                <span class="hljs-comment">// ç®€åŒ–å¤„ç†ï¼šå‡è®¾æ‰€æœ‰ä¾èµ–éƒ½æ˜¯æ¨¡å—</span>
                sb.append(<span class="hljs-string">"    requires "</span>).append(extractModuleName(dep)).append(<span class="hljs-string">";\n"</span>);
            }
            
            <span class="hljs-comment">// è‡ªåŠ¨å¯¼å‡ºåŒ…ï¼ˆæ ¹æ®å®é™…åŒ…ç»“æ„è°ƒæ•´ï¼‰</span>
            sb.append(<span class="hljs-string">"\n"</span>);
            sb.append(<span class="hljs-string">"    exports "</span>).append(name).append(<span class="hljs-string">";\n"</span>);
            
            sb.append(<span class="hljs-string">"}\n"</span>);
            <span class="hljs-keyword">return</span> sb.toString();
        }
        
        <span class="hljs-keyword">private</span> String <span class="hljs-title function_">extractModuleName</span><span class="hljs-params">(String importStmt)</span> {
            <span class="hljs-comment">// ç®€åŒ–å¤„ç†ï¼šä»importè¯­å¥æå–æ¨¡å—å</span>
            String[] parts = importStmt.split(<span class="hljs-string">"\."</span>);
            <span class="hljs-keyword">if</span> (parts.length &gt; <span class="hljs-number">1</span>) {
                <span class="hljs-keyword">return</span> parts[<span class="hljs-number">0</span>] + <span class="hljs-string">"."</span> + parts[<span class="hljs-number">1</span>];
            }
            <span class="hljs-keyword">return</span> importStmt;
        }
    }
    
    <span class="hljs-comment">// è‡ªåŠ¨è¿ç§»å·¥å…·</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AutoMigrator</span> {
        
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">migrateProject</span><span class="hljs-params">(Path projectDir)</span> <span class="hljs-keyword">throws</span> Exception {
            System.out.println(<span class="hljs-string">"å¼€å§‹è¿ç§»é¡¹ç›®: "</span> + projectDir);
            
            <span class="hljs-type">MigrationTracker</span> <span class="hljs-variable">tracker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MigrationTracker</span>(projectDir);
            
            <span class="hljs-comment">// 1. åˆ†æç°æœ‰é¡¹ç›®</span>
            System.out.println(<span class="hljs-string">"\n1. åˆ†æé¡¹ç›®ç»“æ„..."</span>);
            <span class="hljs-type">ProjectAnalysis</span> <span class="hljs-variable">analysis</span> <span class="hljs-operator">=</span> tracker.analyze();
            System.out.println(<span class="hljs-string">"   æ‰¾åˆ° "</span> + analysis.javaFiles.size() + <span class="hljs-string">" ä¸ªJavaæ–‡ä»¶"</span>);
            System.out.println(<span class="hljs-string">"   æ‰¾åˆ° "</span> + analysis.jarFiles.size() + <span class="hljs-string">" ä¸ªJARæ–‡ä»¶"</span>);
            
            <span class="hljs-comment">// 2. ç”Ÿæˆè¿ç§»è®¡åˆ’</span>
            System.out.println(<span class="hljs-string">"\n2. ç”Ÿæˆè¿ç§»è®¡åˆ’..."</span>);
            <span class="hljs-type">MigrationPlan</span> <span class="hljs-variable">plan</span> <span class="hljs-operator">=</span> tracker.generatePlan(analysis);
            
            System.out.println(<span class="hljs-string">"   è¯†åˆ«å‡º "</span> + plan.getModules().size() + <span class="hljs-string">" ä¸ªæ½œåœ¨æ¨¡å—:"</span>);
            <span class="hljs-keyword">for</span> (MigrationModule <span class="hljs-keyword">module</span> : plan.getModules()) {
                System.out.printf(<span class="hljs-string">"   - %s (ä¼˜å…ˆçº§: %d, ä¾èµ–: %d)%n"</span>,
                    <span class="hljs-keyword">module</span>.getName(), <span class="hljs-keyword">module</span>.getPriority(), 
                    <span class="hljs-keyword">module</span>.getDependencies().size());
            }
            
            <span class="hljs-comment">// 3. é€æ­¥è¿ç§»</span>
            System.out.println(<span class="hljs-string">"\n3. å¼€å§‹è¿ç§»..."</span>);
            <span class="hljs-keyword">for</span> (MigrationModule <span class="hljs-keyword">module</span> : plan.getModules()) {
                migrateModule(projectDir, <span class="hljs-keyword">module</span>);
            }
            
            System.out.println(<span class="hljs-string">"\nè¿ç§»å®Œæˆï¼"</span>);
            System.out.println(<span class="hljs-string">"\nåç»­æ­¥éª¤:"</span>);
            System.out.println(<span class="hljs-string">"1. å®¡æŸ¥ç”Ÿæˆçš„module-info.javaæ–‡ä»¶"</span>);
            System.out.println(<span class="hljs-string">"2. è¿è¡Œæµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸"</span>);
            System.out.println(<span class="hljs-string">"3. ä½¿ç”¨JLinkåˆ›å»ºè‡ªå®šä¹‰è¿è¡Œæ—¶"</span>);
            System.out.println(<span class="hljs-string">"4. ä¼˜åŒ–æ¨¡å—è¾¹ç•Œå’Œä¾èµ–"</span>);
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">migrateModule</span><span class="hljs-params">(Path projectDir, MigrationModule <span class="hljs-keyword">module</span>)</span> 
                <span class="hljs-keyword">throws</span> Exception {
            System.out.println(<span class="hljs-string">"\nè¿ç§»æ¨¡å—: "</span> + <span class="hljs-keyword">module</span>.getName());
            
            <span class="hljs-comment">// åˆ›å»ºæ¨¡å—ç›®å½•</span>
            <span class="hljs-type">Path</span> <span class="hljs-variable">moduleDir</span> <span class="hljs-operator">=</span> projectDir.resolve(<span class="hljs-keyword">module</span>.getName());
            Files.createDirectories(moduleDir);
            
            <span class="hljs-comment">// ç”Ÿæˆmodule-info.java</span>
            <span class="hljs-type">Path</span> <span class="hljs-variable">moduleInfo</span> <span class="hljs-operator">=</span> moduleDir.resolve(<span class="hljs-string">"module-info.java"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">module</span>.generateModuleInfo();
            Files.writeString(moduleInfo, content);
            
            System.out.println(<span class="hljs-string">"   åˆ›å»º module-info.java:"</span>);
            System.out.println(<span class="hljs-string">"   ```"</span>);
            System.out.println(content);
            System.out.println(<span class="hljs-string">"   ```"</span>);
            
            <span class="hljs-comment">// ç§»åŠ¨æºæ–‡ä»¶ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰</span>
            <span class="hljs-comment">// å®é™…ä¸­éœ€è¦æ ¹æ®åŒ…ç»“æ„ç§»åŠ¨æ–‡ä»¶</span>
            System.out.println(<span class="hljs-string">"   æç¤ºï¼šéœ€è¦å°†åŒ… "</span> + <span class="hljs-keyword">module</span>.getName() + 
                             <span class="hljs-string">" ä¸‹çš„æºæ–‡ä»¶ç§»åŠ¨åˆ°æ¨¡å—ç›®å½•ä¸­"</span>);
        }
    }
    
    <span class="hljs-comment">// å…¼å®¹æ€§åŒ…è£…å™¨ï¼ˆç”¨äºæ··åˆæ¨¡å—/éæ¨¡å—ç¯å¢ƒï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CompatibilityLayer</span> {
        
        <span class="hljs-comment">// è‡ªåŠ¨æ¨¡å—æ£€æµ‹å™¨</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAutomaticModule</span><span class="hljs-params">(Path jarFile)</span> {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ£€æŸ¥JARæ˜¯å¦åŒ…å«module-info.class</span>
                <span class="hljs-type">FileSystem</span> <span class="hljs-variable">fs</span> <span class="hljs-operator">=</span> FileSystems.newFileSystem(jarFile, 
                    (ClassLoader) <span class="hljs-literal">null</span>);
                
                <span class="hljs-type">Path</span> <span class="hljs-variable">moduleInfo</span> <span class="hljs-operator">=</span> fs.getPath(<span class="hljs-string">"/"</span>, <span class="hljs-string">"module-info.class"</span>);
                <span class="hljs-type">boolean</span> <span class="hljs-variable">isModule</span> <span class="hljs-operator">=</span> Files.exists(moduleInfo);
                
                fs.close();
                <span class="hljs-keyword">return</span> !isModule; <span class="hljs-comment">// æ²¡æœ‰module-info.classçš„æ˜¯è‡ªåŠ¨æ¨¡å—</span>
            } <span class="hljs-keyword">catch</span> (Exception e) {
                <span class="hljs-comment">// è¯»å–å¤±è´¥ï¼Œå‡è®¾æ˜¯è‡ªåŠ¨æ¨¡å—</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
        }
        
        <span class="hljs-comment">// ä¸ºä¼ ç»ŸJARç”Ÿæˆè‡ªåŠ¨æ¨¡å—åç§°</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">generateAutomaticModuleName</span><span class="hljs-params">(Path jarFile)</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">fileName</span> <span class="hljs-operator">=</span> jarFile.getFileName().toString();
            
            <span class="hljs-comment">// ç§»é™¤.jaræ‰©å±•å</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">baseName</span> <span class="hljs-operator">=</span> fileName.substring(<span class="hljs-number">0</span>, fileName.length() - <span class="hljs-number">4</span>);
            
            <span class="hljs-comment">// å¤„ç†ç‰ˆæœ¬å·ï¼ˆå¦‚myapp-1.2.3.jar -&gt; myappï¼‰</span>
            baseName = baseName.replaceAll(<span class="hljs-string">"-\d+(\.\d+)*"</span>, <span class="hljs-string">""</span>);
            
            <span class="hljs-comment">// è½¬æ¢ä¸ºæœ‰æ•ˆçš„æ¨¡å—åï¼ˆæ›¿æ¢éæ³•å­—ç¬¦ï¼‰</span>
            baseName = baseName.replaceAll(<span class="hljs-string">"[^A-Za-z0-9.]"</span>, <span class="hljs-string">"."</span>);
            baseName = baseName.replaceAll(<span class="hljs-string">"\.+"</span>, <span class="hljs-string">"."</span>);
            baseName = baseName.replaceAll(<span class="hljs-string">"^\.|\.$"</span>, <span class="hljs-string">""</span>);
            
            <span class="hljs-comment">// ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªç‚¹</span>
            <span class="hljs-keyword">if</span> (!baseName.contains(<span class="hljs-string">"."</span>)) {
                baseName = <span class="hljs-string">"auto."</span> + baseName;
            }
            
            <span class="hljs-keyword">return</span> baseName;
        }
        
        <span class="hljs-comment">// åˆ›å»ºæ¡¥æ¥æ¨¡å—ï¼ˆè¿æ¥æ¨¡å—åŒ–å’Œéæ¨¡å—åŒ–ä»£ç ï¼‰</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">createBridgeModule</span><span class="hljs-params">(String moduleName, 
                                               Set&lt;String&gt; automaticModules)</span> {
            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
            sb.append(<span class="hljs-string">"module "</span>).append(moduleName).append(<span class="hljs-string">" {\n"</span>);
            sb.append(<span class="hljs-string">"    // æ¡¥æ¥æ¨¡å—ï¼šè¿æ¥æ¨¡å—åŒ–å’Œä¼ ç»Ÿä»£ç \n"</span>);
            sb.append(<span class="hljs-string">"    requires java.base;\n"</span>);
            sb.append(<span class="hljs-string">"\n"</span>);
            
            <span class="hljs-keyword">for</span> (String autoModule : automaticModules) {
                sb.append(<span class="hljs-string">"    requires "</span>).append(autoModule).append(<span class="hljs-string">";\n"</span>);
            }
            
            sb.append(<span class="hljs-string">"\n"</span>);
            sb.append(<span class="hljs-string">"    // é‡æ–°å¯¼å‡ºæ‰€æœ‰åŒ…\n"</span>);
            sb.append(<span class="hljs-string">"    exports * to all;\n"</span>);
            sb.append(<span class="hljs-string">"    opens * to all;\n"</span>);
            
            sb.append(<span class="hljs-string">"}\n"</span>);
            <span class="hljs-keyword">return</span> sb.toString();
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"=== Javaæ¨¡å—åŒ–è¿ç§»åŠ©æ‰‹ ===\n"</span>);
        
        <span class="hljs-keyword">if</span> (args.length == <span class="hljs-number">0</span>) {
            System.out.println(<span class="hljs-string">"ç”¨æ³•: java ModularMigrationHelper &lt;é¡¹ç›®ç›®å½•&gt;"</span>);
            System.out.println(<span class="hljs-string">"ç¤ºä¾‹: java ModularMigrationHelper ./myproject"</span>);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-type">Path</span> <span class="hljs-variable">projectDir</span> <span class="hljs-operator">=</span> Paths.get(args[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">if</span> (!Files.exists(projectDir)) {
            System.err.println(<span class="hljs-string">"ç›®å½•ä¸å­˜åœ¨: "</span> + projectDir);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// æ¼”ç¤ºè‡ªåŠ¨è¿ç§»</span>
        AutoMigrator.migrateProject(projectDir);
        
        <span class="hljs-comment">// æ¼”ç¤ºå…¼å®¹æ€§å¤„ç†</span>
        System.out.println(<span class="hljs-string">"\n=== å…¼å®¹æ€§å¤„ç†æ¼”ç¤º ==="</span>);
        
        <span class="hljs-comment">// æ‰«æé¡¹ç›®ä¸­çš„JARæ–‡ä»¶</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">stream</span> <span class="hljs-operator">=</span> Files.walk(projectDir)) {
            List&lt;Path&gt; jarFiles = stream
                .filter(p -&gt; p.toString().endsWith(<span class="hljs-string">".jar"</span>))
                .collect(Collectors.toList());
            
            System.out.println(<span class="hljs-string">"\nåˆ†æä¼ ç»ŸJARæ–‡ä»¶:"</span>);
            <span class="hljs-keyword">for</span> (Path jarFile : jarFiles) {
                <span class="hljs-type">boolean</span> <span class="hljs-variable">isAutoModule</span> <span class="hljs-operator">=</span> CompatibilityLayer.isAutomaticModule(jarFile);
                <span class="hljs-type">String</span> <span class="hljs-variable">moduleName</span> <span class="hljs-operator">=</span> CompatibilityLayer.generateAutomaticModuleName(jarFile);
                
                System.out.printf(<span class="hljs-string">"  %s: %s (è‡ªåŠ¨æ¨¡å—å: %s)%n"</span>,
                    jarFile.getFileName(),
                    isAutoModule ? <span class="hljs-string">"è‡ªåŠ¨æ¨¡å—"</span> : <span class="hljs-string">"æ˜¾å¼æ¨¡å—"</span>,
                    moduleName);
            }
        }
        
        System.out.println(<span class="hljs-string">"\nè¿ç§»æœ€ä½³å®è·µ:"</span>);
        System.out.println(<span class="hljs-string">"1. ä»ä¸‹åˆ°ä¸Šè¿ç§»ï¼ˆä¾èµ–å°‘çš„æ¨¡å—å…ˆè¿ç§»ï¼‰"</span>);
        System.out.println(<span class="hljs-string">"2. ä½¿ç”¨è‡ªåŠ¨æ¨¡å—ä½œä¸ºè¿‡æ¸¡"</span>);
        System.out.println(<span class="hljs-string">"3. é€æ­¥æ›¿æ¢ä¼ ç»Ÿä¾èµ–ä¸ºæ¨¡å—åŒ–ç‰ˆæœ¬"</span>);
        System.out.println(<span class="hljs-string">"4. ä½¿ç”¨æ¡¥æ¥æ¨¡å—å¤„ç†å¤æ‚çš„ä¾èµ–å…³ç³»"</span>);
        System.out.println(<span class="hljs-string">"5. åˆ©ç”¨JLinkä¼˜åŒ–éƒ¨ç½²åŒ…å¤§å°"</span>);
    }
}
</code></pre>
<h2 data-id="heading-14">æ€»ç»“ï¼šæ¨¡å—åŒ–ç¼–ç¨‹çš„æ ¸å¿ƒä»·å€¼</h2>
<h3 data-id="heading-15">æ¨¡å—åŒ–å¸¦æ¥çš„å¥½å¤„ï¼š</h3>
<ol>
<li><strong>å¼ºå°è£…æ€§</strong>ï¼šæ˜ç¡®APIè¾¹ç•Œï¼Œéšè—å†…éƒ¨å®ç°</li>
<li><strong>å¯é çš„é…ç½®</strong>ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ä¾èµ–ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯</li>
<li><strong>æ›´å¥½çš„å¯ç»´æŠ¤æ€§</strong>ï¼šæ¨¡å—åŒ–æ¶æ„æ›´æ¸…æ™°ï¼Œä¾¿äºç†è§£å’Œç»´æŠ¤</li>
<li><strong>æ”¹è¿›çš„æ€§èƒ½</strong>ï¼šJLinkå¯ä»¥åˆ›å»ºæ›´å°çš„è¿è¡Œæ—¶æ˜ åƒ</li>
<li><strong>å¢å¼ºçš„å®‰å…¨æ€§</strong>ï¼šé€šè¿‡é™åˆ¶åå°„è®¿é—®å¢å¼ºå®‰å…¨æ€§</li>
</ol>
<h3 data-id="heading-16">è¿ç§»è·¯å¾„å»ºè®®ï¼š</h3>
<ol>
<li><strong>è¯„ä¼°é˜¶æ®µ</strong>ï¼šåˆ†æç°æœ‰é¡¹ç›®çš„ä¾èµ–å…³ç³»</li>
<li><strong>æ¸è¿›è¿ç§»</strong>ï¼šä½¿ç”¨è‡ªåŠ¨æ¨¡å—ä½œä¸ºè¿‡æ¸¡</li>
<li><strong>æ¨¡å—åŒ–æ ¸å¿ƒ</strong>ï¼šå…ˆè¿ç§»åŸºç¡€æ¨¡å—å’Œå·¥å…·æ¨¡å—</li>
<li><strong>å…¨é¢æ¨¡å—åŒ–</strong>ï¼šé€æ­¥è¿ç§»æ‰€æœ‰æ¨¡å—</li>
<li><strong>ä¼˜åŒ–éƒ¨ç½²</strong>ï¼šä½¿ç”¨JLinkåˆ›å»ºæœ€å°åŒ–è¿è¡Œæ—¶</li>
</ol>
<h3 data-id="heading-17">é‡è¦å·¥å…·å’Œå‘½ä»¤ï¼š</h3>





























<table><thead><tr><th>å·¥å…·/å‘½ä»¤</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>javac --module-source-path</code></td><td>ç¼–è¯‘æ¨¡å—</td></tr><tr><td><code>java --module-path</code></td><td>è¿è¡Œæ¨¡å—åŒ–åº”ç”¨</td></tr><tr><td><code>jlink</code></td><td>åˆ›å»ºè‡ªå®šä¹‰è¿è¡Œæ—¶æ˜ åƒ</td></tr><tr><td><code>jmod</code></td><td>åˆ›å»ºJMODæ–‡ä»¶</td></tr><tr><td><code>jdeps</code></td><td>åˆ†æä¾èµ–å…³ç³»</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å¼€å‘åº”è¯¥äº†è§£çš„æµè§ˆå™¨èƒŒåçš„é»‘ç§‘æŠ€]]></title>    <link>https://juejin.cn/post/7584824891595063332</link>    <guid>https://juejin.cn/post/7584824891595063332</guid>    <pubDate>2025-12-18T06:00:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584824891595063332" data-draft-id="7584759201072218153" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å¼€å‘åº”è¯¥äº†è§£çš„æµè§ˆå™¨èƒŒåçš„é»‘ç§‘æŠ€"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-18T06:00:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/606586148237431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å¼€å‘åº”è¯¥äº†è§£çš„æµè§ˆå™¨èƒŒåçš„é»‘ç§‘æŠ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/606586148237431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T06:00:23.000Z" title="Thu Dec 18 2025 06:00:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»37åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯å¼€å‘åº”è¯¥äº†è§£çš„æµè§ˆå™¨èƒŒåçš„é»‘ç§‘æŠ€</h2>
<blockquote>
<p>æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥äº†è§£ç°ä»£æµè§ˆå™¨çš„æ ¸å¿ƒæœºåˆ¶ï¼Œä»å¤šè¿›ç¨‹æ¶æ„åˆ°æ¸²æŸ“å¼•æ“ï¼Œä»JavaScriptå¼•æ“åˆ°ç½‘ç»œä¼˜åŒ–ï¼Œæ­ç§˜é‚£äº›è®©ç½‘é¡µé£é€Ÿè¿è¡Œçš„æŠ€æœ¯ç»†èŠ‚ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ä¸€ã€æµè§ˆå™¨å¤šè¿›ç¨‹æ¶æ„ï¼šä»æ··ä¹±åˆ°æœ‰åºçš„æ¼”è¿›</h3>
<h4 data-id="heading-2">1.1 å•è¿›ç¨‹æ—¶ä»£çš„å™©æ¢¦ï¼ˆ1990s-2007ï¼‰</h4>
<p>è¿˜è®°å¾—IE6æ—¶ä»£å—ï¼Ÿä½ åŒæ—¶æ‰“å¼€10ä¸ªæ ‡ç­¾é¡µï¼Œæ­£åœ¨å¡«å†™é‡è¦è¡¨å•ã€æŸ¥çœ‹é‚®ç®±ã€æµè§ˆæ–°é—»ã€æ’­æ”¾éŸ³ä¹ã€‚çªç„¶ï¼Œå…¶ä¸­ä¸€ä¸ªç½‘é¡µçš„Flashå¹¿å‘Šå´©æºƒäº†ï¼Œæ•´ä¸ªæµè§ˆå™¨éƒ½å¡æ­»äº†ï¼æ‰€æœ‰å·¥ä½œéƒ½ç™½è´¹äº†ã€‚</p>
<p><strong>è¿™å°±æ˜¯å•è¿›ç¨‹æ¶æ„çš„æ ¸å¿ƒé—®é¢˜ï¼šè¿›ç¨‹å†…ä»»ä¸€æ¨¡å—å´©æºƒï¼Œæ•´ä¸ªåº”ç”¨éšä¹‹å´©æºƒã€‚</strong></p>
<h5 data-id="heading-3">å•è¿›ç¨‹æ¶æ„ç»„æˆ</h5>
<p>æ‰€æœ‰åŠŸèƒ½æ¨¡å—è¿è¡Œåœ¨åŒä¸€è¿›ç¨‹å†…ï¼š</p>
<ul>
<li><strong>UIæ¨¡å—</strong>ï¼šç•Œé¢ç®¡ç†</li>
<li><strong>æ¸²æŸ“å¼•æ“</strong>ï¼šé¡µé¢æ¸²æŸ“</li>
<li><strong>JavaScriptå¼•æ“</strong>ï¼šè„šæœ¬æ‰§è¡Œ</li>
<li><strong>ç½‘ç»œæ¨¡å—</strong>ï¼šèµ„æºä¸‹è½½</li>
<li><strong>æ’ä»¶ç³»ç»Ÿ</strong>ï¼šFlashã€ActiveXç­‰</li>
</ul>
<h5 data-id="heading-4">æ¶æ„ç¼ºé™·</h5>

























<table><thead><tr><th>é—®é¢˜ç±»å‹</th><th>å…·ä½“è¡¨ç°</th><th>å½±å“</th></tr></thead><tbody><tr><td><strong>ç¨³å®šæ€§</strong></td><td>ä»»ä¸€æ¨¡å—å´©æºƒå¯¼è‡´æ•´ä½“å¤±æ•ˆ</td><td>ç”¨æˆ·å¹³å‡æ¯æ—¥é‡å¯æµè§ˆå™¨3-5æ¬¡</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>æ’ä»¶å¯ç›´æ¥è®¿é—®ç³»ç»Ÿèµ„æº</td><td>æ¶æ„ä»£ç å¨èƒå¤§</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>å•çº¿ç¨‹æ¨¡å‹æ— æ³•åˆ©ç”¨å¤šæ ¸CPU</td><td>å“åº”é€Ÿåº¦æ…¢</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-5">1.2 å¤šè¿›ç¨‹é©å‘½ï¼ˆ2008-2017ï¼‰</h4>
<p>2008å¹´ï¼ŒChromeæå‡ºäº†é©å‘½æ€§çš„æƒ³æ³•â€”â€”<strong>è®©æ¯ä¸ªæ ‡ç­¾é¡µéƒ½è¿è¡Œåœ¨ç‹¬ç«‹çš„è¿›ç¨‹ä¸­</strong>ã€‚å°±åƒæŠŠä¸åŒçš„å·¥ä½œå›¢é˜Ÿåˆ†åˆ°ä¸åŒçš„åŠå…¬å®¤ï¼Œä¸€ä¸ªå›¢é˜Ÿå‡ºé—®é¢˜ä¸ä¼šå½±å“å…¶ä»–å›¢é˜Ÿã€‚</p>
<h5 data-id="heading-6">å¤šè¿›ç¨‹æ¶æ„ç»„æˆ</h5>









































<table><thead><tr><th>è¿›ç¨‹ç±»å‹</th><th>èŒè´£</th><th>æ•°é‡</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><strong>Browser Process</strong></td><td>æµè§ˆå™¨ä¸»è¿›ç¨‹</td><td>1ä¸ª</td><td>è´Ÿè´£UIã€æ–‡ä»¶è®¿é—®ã€ç½‘ç»œåè°ƒ</td></tr><tr><td><strong>Renderer Process</strong></td><td>æ¸²æŸ“è¿›ç¨‹</td><td>å¤šä¸ª</td><td>æ¯ä¸ªæ ‡ç­¾é¡µä¸€ä¸ªï¼Œè´Ÿè´£é¡µé¢æ¸²æŸ“</td></tr><tr><td><strong>GPU Process</strong></td><td>GPUè¿›ç¨‹</td><td>1ä¸ª</td><td>è´Ÿè´£å›¾å½¢å¤„ç†å’Œ3DåŠ é€Ÿ</td></tr><tr><td><strong>Network Service</strong></td><td>ç½‘ç»œæœåŠ¡è¿›ç¨‹</td><td>1ä¸ª</td><td>ç»Ÿä¸€å¤„ç†æ‰€æœ‰ç½‘ç»œè¯·æ±‚</td></tr><tr><td><strong>Plugin Process</strong></td><td>æ’ä»¶è¿›ç¨‹</td><td>æŒ‰éœ€</td><td>è¿è¡ŒFlashç­‰ç¬¬ä¸‰æ–¹æ’ä»¶</td></tr></tbody></table>
<h5 data-id="heading-7">Browser Processçš„æ ¸å¿ƒçº¿ç¨‹</h5>
<p><strong>Browser Processæ˜¯æµè§ˆå™¨çš„"å¤§è„‘"ï¼ŒåŒ…å«4ä¸ªå…³é”®çº¿ç¨‹ï¼š</strong></p>
<ol>
<li><strong>UI Threadï¼ˆç•Œé¢çº¿ç¨‹ï¼‰</strong>ï¼šç®¡ç†æµè§ˆå™¨ç•Œé¢ã€åœ°å€æ ã€ä¹¦ç­¾ç­‰</li>
<li><strong>IO Threadï¼ˆIOçº¿ç¨‹ï¼‰</strong>ï¼šå¤„ç†IPCæ¶ˆæ¯è·¯ç”±ï¼Œåè°ƒå„è¿›ç¨‹é€šä¿¡</li>
<li><strong>Storage Threadï¼ˆå­˜å‚¨çº¿ç¨‹ï¼‰</strong>ï¼šç®¡ç†Cookieã€LocalStorageç­‰æŒä¹…åŒ–æ•°æ®</li>
<li><strong>Device Threadï¼ˆè®¾å¤‡çº¿ç¨‹ï¼‰</strong>ï¼šè®¿é—®æ‘„åƒå¤´ã€éº¦å…‹é£ç­‰ç¡¬ä»¶è®¾å¤‡</li>
</ol>
<h5 data-id="heading-8">æ¶æ„ä¼˜åŠ¿å¯¹æ¯”</h5>

























<table><thead><tr><th>é—®é¢˜</th><th>å•è¿›ç¨‹æ–¹æ¡ˆ</th><th>å¤šè¿›ç¨‹æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>ç¨³å®šæ€§</strong></td><td>ä¸€ä¸ªé¡µé¢å´©æºƒï¼Œå…¨éƒ¨å´©æºƒ</td><td>âœ… è¿›ç¨‹éš”ç¦»ï¼Œæ•…éšœä¸æ‰©æ•£</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>æ¶æ„ä»£ç å¯ç›´æ¥è®¿é—®ç³»ç»Ÿ</td><td>âœ… æ²™ç®±æœºåˆ¶ï¼Œæƒé™å—é™</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>å•æ ¸CPUï¼Œæ— æ³•å¹¶è¡Œ</td><td>âœ… å¤šæ ¸CPUï¼Œå¹¶è¡Œå¤„ç†</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-9">1.3 æ²™ç®±æœºåˆ¶ï¼šç»ç’ƒæˆ¿é—´é‡Œçš„ä»£ç </h4>
<p>å‡è®¾ä½ è®¿é—®äº†ä¸€ä¸ªæ¶æ„ç½‘ç«™ï¼Œå®ƒçš„JavaScriptä»£ç è¯•å›¾è¯»å–ä½ ç”µè„‘ä¸Šçš„æ–‡ä»¶ã€çªƒå–ä½ çš„å¯†ç ã€‚å¦‚ä½•é˜²èŒƒï¼Ÿ</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šæ²™ç®±æœºåˆ¶ï¼ˆSandboxï¼‰</strong></p>
<p>Renderer Processè¿è¡Œåœ¨å—é™çš„æ²™ç®±ç¯å¢ƒä¸­ï¼Œå°±åƒæŠŠæ½œåœ¨å±é™©çš„ä»£ç å…³åœ¨ä¸€ä¸ªç»ç’ƒæˆ¿é—´é‡Œâ€”â€”å®ƒå¯ä»¥è¿è¡Œï¼Œä½†æ— æ³•ç›´æ¥æ¥è§¦å¤–é¢çš„ç³»ç»Ÿèµ„æºã€‚</p>
<h5 data-id="heading-10">ä¸‰å±‚é˜²æŠ¤ä½“ç³»</h5>
<p><strong>ç¬¬ä¸€å±‚ï¼šè¿›ç¨‹éš”ç¦»</strong></p>
<ul>
<li>é˜»æ­¢ï¼šå…¶ä»–è¿›ç¨‹å®‰å…¨ âœ…</li>
<li>çªç ´ï¼šè¿›å…¥ç¬¬äºŒå±‚ â†’</li>
</ul>
<p><strong>ç¬¬äºŒå±‚ï¼šç³»ç»Ÿè°ƒç”¨è¿‡æ»¤</strong></p>
<ul>
<li>é˜»æ­¢ï¼šç³»ç»Ÿè°ƒç”¨è¢«æ‹¦æˆª âœ…</li>
<li>çªç ´ï¼šè¿›å…¥ç¬¬ä¸‰å±‚ â†’</li>
</ul>
<p><strong>ç¬¬ä¸‰å±‚ï¼šæƒé™éªŒè¯</strong></p>
<ul>
<li>é˜»æ­¢ï¼šè®¿é—®è¢«æ‹’ç» âœ…</li>
<li>çªç ´ï¼šæ“ä½œç³»ç»Ÿå±‚é˜²æŠ¤</li>
</ul>
<p><strong>å®‰å…¨æ•ˆæœï¼š</strong></p>
<ul>
<li>ğŸ›¡ï¸ æ— æ³•è¯»å–æœ¬åœ°æ–‡ä»¶</li>
<li>ğŸ›¡ï¸ æ— æ³•è®¿é—®ç³»ç»Ÿæ³¨å†Œè¡¨</li>
<li>ğŸ›¡ï¸ æ— æ³•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</li>
<li>ğŸ›¡ï¸ éœ€è¦é€šè¿‡Browser Processä»£ç†è®¿é—®èµ„æº</li>
</ul>
<hr/>
<h4 data-id="heading-11">1.4 Site Isolationï¼šåº”å¯¹CPUæ¼æ´çš„ç»ˆæé˜²æŠ¤ï¼ˆ2018è‡³ä»Šï¼‰</h4>
<h5 data-id="heading-12">å±æœºèƒŒæ™¯</h5>
<p>2018å¹´1æœˆï¼Œè®¡ç®—æœºå®‰å…¨ç•Œçˆ†å‡ºæƒŠå¤©æ¼æ´â€”â€”<strong>Spectreå’ŒMeltdown</strong>ã€‚è¿™ä¸¤ä¸ªCPUçº§åˆ«çš„ç¡¬ä»¶æ¼æ´å½±å“äº†å‡ ä¹æ‰€æœ‰ç°ä»£å¤„ç†å™¨ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä¾§ä¿¡é“æ”»å‡»è¯»å–è¿›ç¨‹å†…å­˜ä¸­çš„æ•æ„Ÿæ•°æ®ã€‚</p>
<p><strong>æµè§ˆå™¨çš„å±æœºï¼š</strong></p>
<ul>
<li>âœ… ä¸åŒæ ‡ç­¾é¡µè¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­</li>
<li>âŒ åŒä¸€æ ‡ç­¾é¡µå†…çš„ä¸åŒæ¥æºiframeä»ç„¶å…±äº«ä¸€ä¸ªè¿›ç¨‹</li>
<li>âŒ æ¶æ„iframeå¯èƒ½åˆ©ç”¨Spectreæ¼æ´è¯»å–ä¸»é¡µé¢çš„å†…å­˜æ•°æ®</li>
</ul>
<h5 data-id="heading-13">æ”»å‡»åœºæ™¯ç¤ºä¾‹</h5>
<p><strong>ä¼ ç»Ÿå¤šè¿›ç¨‹æ¶æ„çš„æ¼æ´ï¼š</strong></p>
<ol>
<li>é“¶è¡Œç½‘ç«™ï¼ˆbank.comï¼‰åœ¨Process 1ä¸­å­˜å‚¨ç”¨æˆ·å¯†ç </li>
<li>é¡µé¢å†…åµŒå…¥æ¶æ„å¹¿å‘Šiframeï¼ˆevil.comï¼‰ï¼Œä¹Ÿåœ¨Process 1</li>
<li>æ¶æ„ä»£ç åˆ©ç”¨Spectreæ¼æ´å‘èµ·ä¾§ä¿¡é“æ”»å‡»</li>
<li>æˆåŠŸè¯»å–åŒè¿›ç¨‹å†…å­˜ä¸­çš„å¯†ç æ•°æ® âŒ</li>
</ol>
<p><strong>é—®é¢˜ï¼šåŒè¿›ç¨‹å†…å­˜å­˜åœ¨æ•°æ®æ³„éœ²é£é™©</strong></p>
<h5 data-id="heading-14">Site Isolationè§£å†³æ–¹æ¡ˆ</h5>
<p><strong>æ ¸å¿ƒåŸåˆ™ï¼šä¸åŒæºï¼ˆOriginï¼‰çš„å†…å®¹å¿…é¡»è¿è¡Œåœ¨ç‹¬ç«‹çš„è¿›ç¨‹ä¸­ï¼Œå³ä½¿åœ¨åŒä¸€æ ‡ç­¾é¡µå†…ã€‚</strong></p>
<p><strong>åŒä¸€æ ‡ç­¾é¡µçš„è¿›ç¨‹åˆ†é…ï¼š</strong></p>





























<table><thead><tr><th>æ¡†æ¶</th><th>åŸŸå</th><th>åˆ†é…è¿›ç¨‹</th><th>éš”ç¦»æ•ˆæœ</th></tr></thead><tbody><tr><td>ä¸»æ¡†æ¶</td><td>portal.com</td><td>Process 1</td><td>ç‹¬ç«‹å†…å­˜ç©ºé—´</td></tr><tr><td>iframe 1</td><td>ads.com</td><td>Process 2</td><td>âœ… æ— æ³•è®¿é—®Process 1</td></tr><tr><td>iframe 2</td><td>video.com</td><td>Process 3</td><td>âœ… æ— æ³•è®¿é—®Process 1/2</td></tr></tbody></table>
<p><strong>OOPIFå·¥ä½œæµç¨‹ï¼š</strong></p>
<ol>
<li>é“¶è¡Œç½‘ç«™æ•°æ®å­˜å‚¨åœ¨Process 1å†…å­˜</li>
<li>æ¶æ„iframeåœ¨Process 2ä¸­å°è¯•Spectreæ”»å‡»</li>
<li>åªèƒ½è®¿é—®Process 2çš„å†…å­˜ç©ºé—´</li>
<li><strong>æ”»å‡»å¤±è´¥ï¼è¿›ç¨‹å†…å­˜éš”ç¦»ç”Ÿæ•ˆ</strong> âœ…</li>
</ol>
<h5 data-id="heading-15">çœŸå®æ¡ˆä¾‹ï¼šæŸé“¶è¡Œæ”¯ä»˜é¡µé¢å®‰å…¨åŠ å›º</h5>
<p><strong>èƒŒæ™¯ï¼š</strong></p>
<ul>
<li>é“¶è¡Œåœ¨æ”¯ä»˜é¡µé¢åµŒå…¥ç¬¬ä¸‰æ–¹å¹¿å‘Šiframeä»¥å¢åŠ æ”¶å…¥</li>
<li>å®‰å…¨å›¢é˜Ÿæ‹…å¿ƒå¹¿å‘Šä»£ç å¯èƒ½çªƒå–ç”¨æˆ·æ”¯ä»˜ä¿¡æ¯</li>
</ul>
<p><strong>é—®é¢˜å‘ç°ï¼š</strong></p>
<ul>
<li>è™½ç„¶å¹¿å‘Šiframeå—åŒæºç­–ç•¥é™åˆ¶</li>
<li>ä½†Spectreæ¼æ´å¯èƒ½è®©æ¶æ„ä»£ç é€šè¿‡ä¾§ä¿¡é“æ”»å‡»è¯»å–åŒè¿›ç¨‹å†…å­˜</li>
<li>å¯èƒ½è·å–æ”¯ä»˜è¡¨å•æ•°æ®ï¼ˆå¡å·ã€CVVç­‰æ•æ„Ÿä¿¡æ¯ï¼‰</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>
å¯ç”¨Site Isolationï¼Œç¡®ä¿æ”¯ä»˜é¡µé¢ä¸»æ¡†æ¶ä¸å¹¿å‘Šiframeè¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­ã€‚</p>
<p><strong>å®æ–½æ•ˆæœï¼š</strong></p>






























<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¼˜åŒ–å‰</th><th>ä¼˜åŒ–å</th></tr></thead><tbody><tr><td>å†…å­˜éš”ç¦»</td><td>âŒ å…±äº«è¿›ç¨‹</td><td>âœ… ç‹¬ç«‹è¿›ç¨‹</td></tr><tr><td>Spectreæ”»å‡»æˆåŠŸç‡</td><td>85%</td><td>0%</td></tr><tr><td>é¡µé¢åŠ è½½æ—¶é—´</td><td>åŸºå‡†</td><td>+12ms</td></tr><tr><td>å†…å­˜å ç”¨</td><td>åŸºå‡†</td><td>+8MB/iframe</td></tr></tbody></table>
<p><strong>å…³é”®é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- æ”¯ä»˜é¡µé¢è®¾ç½®COOP/COEPå¤´éƒ¨ --&gt;</span>
Cross-Origin-Opener-Policy: same-origin
Cross-Origin-Embedder-Policy: require-corp
</code></pre>
<p><strong>ä¸šåŠ¡ä»·å€¼ï¼š</strong></p>
<ul>
<li>ä¸Šçº¿3ä¸ªæœˆåï¼ŒæˆåŠŸæ‹¦æˆª2æ¬¡çœŸå®çš„ä¾§ä¿¡é“æ”»å‡»å°è¯•</li>
<li>ä¿æŠ¤äº†çº¦50ä¸‡ç”¨æˆ·çš„æ”¯ä»˜å®‰å…¨</li>
</ul>
<h5 data-id="heading-16">æŠ€æœ¯å®ç°ç»†èŠ‚</h5>
<p><strong>1. è¿›ç¨‹åˆ†é…è§„åˆ™</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">ä¸»é¡µé¢ï¼športal.com               â†’ Renderer <span class="hljs-built_in">Process</span> <span class="hljs-number">1</span>
â”œâ”€ iframe: ads.com              â†’ Renderer <span class="hljs-built_in">Process</span> <span class="hljs-number">2</span>ï¼ˆä¸åŒæºï¼Œç‹¬ç«‹è¿›ç¨‹ï¼‰
â””â”€ iframe: portal.com/widget    â†’ Renderer <span class="hljs-built_in">Process</span> <span class="hljs-number">1</span>ï¼ˆåŒæºï¼Œå…±äº«è¿›ç¨‹ï¼‰
</code></pre>
<p><strong>2. å†…å­˜ä»£ä»·ä¸ä¼˜åŒ–</strong></p>























<table><thead><tr><th>æ¨¡å¼</th><th>è¿›ç¨‹æ•°é‡</th><th>å†…å­˜å ç”¨</th><th>å¢é•¿æ¯”ä¾‹</th></tr></thead><tbody><tr><td>å•è¿›ç¨‹æ¨¡å¼</td><td>1ä¸ª</td><td>80MB</td><td>åŸºå‡†</td></tr><tr><td>Site Isolation</td><td>3ä¸ª</td><td>180MB</td><td>+125%</td></tr></tbody></table>
<p><strong>ä¼˜åŒ–ç­–ç•¥ï¼š</strong></p>
<ol>
<li><strong>è¿›ç¨‹å¤ç”¨</strong>ï¼šç›¸åŒSiteçš„iframeå…±äº«è¿›ç¨‹</li>
<li><strong>è¿›ç¨‹é™åˆ¶</strong>ï¼šè®¾ç½®æœ€å¤§è¿›ç¨‹æ•°ï¼ˆå¦‚20ä¸ªï¼‰ï¼Œè¶…å‡ºåå¤ç”¨</li>
<li><strong>ä½ç«¯è®¾å¤‡é™çº§</strong>ï¼šå†…å­˜&lt;2GBçš„è®¾å¤‡ç¦ç”¨Site Isolation</li>
</ol>
<hr/>
<h3 data-id="heading-17">äºŒã€è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ï¼šè¿›ç¨‹å¦‚ä½•åä½œ</h3>
<h4 data-id="heading-18">2.1 åœºæ™¯ï¼šæ–‡ä»¶ä¸Šä¼ èƒŒåçš„é€šä¿¡</h4>
<p>ä½ åœ¨è½¬è½¬ä¸Šä¼ å•†å“å›¾ç‰‡ï¼Œç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"æŒ‰é’®ï¼Œé€‰ä¸­å›¾ç‰‡åä¸Šä¼ ã€‚çœ‹ä¼¼ç®€å•çš„æ“ä½œï¼ŒèƒŒåéšè—ç€å¤æ‚çš„è¿›ç¨‹é—´é€šä¿¡ã€‚</p>
<p><strong>æŠ€æœ¯çº¦æŸï¼š</strong></p>
<ul>
<li>ç½‘é¡µè¿è¡Œåœ¨Renderer Processï¼ˆæ²™ç®±ç¯å¢ƒï¼‰â†’ ä¸èƒ½ç›´æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿ</li>
<li>æ–‡ä»¶è®¿é—®éœ€è¦Browser Processä»£ç†ï¼ˆæ‹¥æœ‰å®Œæ•´ç³»ç»Ÿæƒé™ï¼‰â†’ åªæœ‰å®ƒèƒ½æ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨</li>
</ul>
<h5 data-id="heading-19">é€šä¿¡æµç¨‹</h5>
<p><strong>æ­¥éª¤1-8çš„å®Œæ•´æµç¨‹ï¼š</strong></p>
<ol>
<li>ç”¨æˆ·ç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"</li>
<li>ç½‘é¡µï¼ˆRenderer Processï¼‰å‘é€IPCæ¶ˆæ¯ï¼šè¯·æ±‚æ–‡ä»¶é€‰æ‹©å™¨</li>
<li>Browser Processæ¥æ”¶æ¶ˆæ¯</li>
<li>Browser Processæ‰“å¼€æ–‡ä»¶å¯¹è¯æ¡†</li>
<li>ç”¨æˆ·é€‰æ‹©æ–‡ä»¶</li>
<li>Browser Processè¯»å–æ–‡ä»¶å†…å®¹</li>
<li>Browser Processé€šè¿‡IPCä¼ é€’æ–‡ä»¶æ•°æ®ç»™Renderer Process</li>
<li>ç½‘é¡µè·å¾—æ–‡ä»¶æ•°æ®ï¼Œå¼€å§‹ä¸Šä¼ </li>
</ol>
<hr/>
<h4 data-id="heading-20">2.2 Mojo IPCæ¡†æ¶ï¼šä¸‰ç§é€šä¿¡æ¨¡å¼</h4>
<p>Chromiumä½¿ç”¨Mojoä½œä¸ºç»Ÿä¸€IPCæ¡†æ¶ï¼Œæä¾›ä¸‰ç§é€šä¿¡æ¨¡å¼ï¼š</p>
<h5 data-id="heading-21">æ¨¡å¼1ï¼šæ¶ˆæ¯ä¼ é€’ï¼ˆå°æ•°æ®é‡ï¼‰</h5>
<p><strong>ç±»æ¯”ï¼š</strong> å°±åƒå¯„ä¿¡ï¼Œä½ æŠŠä¿¡æ¯å†™åœ¨çº¸ä¸Šï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œè£…è¿›ä¿¡å°ï¼Œé€šè¿‡é‚®å±€ï¼ˆç®¡é“ï¼‰å‘é€ï¼Œæ”¶ä»¶äººæ‹†å¼€ä¿¡å°ï¼ˆååºåˆ—åŒ–ï¼‰é˜…è¯»ã€‚</p>
<p><strong>å·¥ä½œæµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-built_in">Process</span> A â†’ åºåˆ—åŒ–æ•°æ® â†’ å†™å…¥Mojo Pipe â†’ ä¼ è¾“ â†’ <span class="hljs-built_in">Process</span> Bæ¥æ”¶ â†’ ååºåˆ—åŒ– â†’ å¤„ç†æ•°æ®
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>âœ… æ§åˆ¶æŒ‡ä»¤ã€é…ç½®ä¿¡æ¯</li>
<li>âœ… å°äº1KBçš„æ•°æ®</li>
<li>âŒ å¤§æ•°æ®é‡ä¼ è¾“ï¼ˆæ•ˆç‡ä½ï¼‰</li>
</ul>
<hr/>
<h5 data-id="heading-22">æ¨¡å¼2ï¼šå…±äº«å†…å­˜ï¼ˆé›¶æ‹·è´ä¼˜åŒ–ï¼‰</h5>
<p><strong>åœºæ™¯ï¼š</strong> ä½ åœ¨Canvasä¸Šç»˜åˆ¶äº†ä¸€å¼ é«˜æ¸…å›¾ç‰‡ï¼ˆ1MBï¼‰ï¼Œéœ€è¦å‘é€ç»™GPU Processè¿›è¡Œæ¸²æŸ“ã€‚å¦‚æœç”¨æ¶ˆæ¯ä¼ é€’ï¼Œæ•°æ®è¦æ‹·è´ä¸¤æ¬¡ï¼Œéå¸¸ä½æ•ˆã€‚</p>
<p><strong>ç±»æ¯”ï¼š</strong> ä¸å…¶æŠŠæ•´æœ¬ä¹¦æ‹·è´ä¸€ä»½ç»™åŒäº‹ï¼Œä¸å¦‚æŠŠä¹¦æ”¾åœ¨å…±äº«çš„ä¹¦æ¶ä¸Šï¼Œå‘Šè¯‰ä»–ä½ç½®å°±è¡Œã€‚</p>
<h5 data-id="heading-23">æ€§èƒ½å¯¹æ¯”ï¼šä¼ è¾“1MBå›¾åƒæ•°æ®</h5>





























<table><thead><tr><th>ä¼ è¾“æ–¹å¼</th><th>æ•°æ®æ‹·è´æ¬¡æ•°</th><th>è€—æ—¶</th><th>å†…å­˜å ç”¨</th></tr></thead><tbody><tr><td><strong>æ¶ˆæ¯ä¼ é€’</strong></td><td>2æ¬¡æ‹·è´</td><td>2ms</td><td>3MBï¼ˆé‡å¤å ç”¨ï¼‰</td></tr><tr><td><strong>å…±äº«å†…å­˜</strong></td><td>0æ¬¡æ‹·è´</td><td>5Î¼s</td><td>1MBï¼ˆå…±äº«ï¼‰</td></tr><tr><td><strong>æ€§èƒ½æå‡</strong></td><td>-</td><td><strong>400å€</strong></td><td><strong>èŠ‚çœ67%</strong></td></tr></tbody></table>
<h5 data-id="heading-24">Canvasæ•°æ®ä¼ è¾“æµç¨‹</h5>
<ol>
<li>Canvas APIï¼ˆRendererï¼‰åˆ›å»ºå…±äº«å†…å­˜åŒºåŸŸ</li>
<li>å°†ä½å›¾æ•°æ®å†™å…¥å…±äº«å†…å­˜</li>
<li>ä¼ é€’å†…å­˜å¥æŸ„ç»™GPU Processï¼ˆ<strong>åªä¼ å¥æŸ„ï¼Œä¸ä¼ æ•°æ®ï¼</strong>ï¼‰</li>
<li>GPU Processæ˜ å°„å…±äº«å†…å­˜</li>
<li>GPU Processç›´æ¥è¯»å–æ•°æ®è¿›è¡Œæ¸²æŸ“</li>
</ol>
<p>âœ¨ <strong>é›¶æ‹·è´ä¼ è¾“ï¼</strong></p>
<hr/>
<h5 data-id="heading-25">æ¨¡å¼3ï¼šå¥æŸ„ä¼ é€’ï¼ˆèµ„æºå¼•ç”¨ï¼‰</h5>
<p><strong>åœºæ™¯ï¼š</strong> ç”¨æˆ·é€‰æ‹©äº†ä¸€ä¸ª2GBçš„è§†é¢‘æ–‡ä»¶ä¸Šä¼ ã€‚å¦‚æœä¼ è¾“æ–‡ä»¶æœ¬èº«ï¼Œä¼šéå¸¸æ…¢ã€‚</p>
<p><strong>ç±»æ¯”ï¼š</strong> ä¸å…¶æŠŠé“¶è¡Œä¿é™©ç®±é‡Œçš„é»„é‡‘æ¬æ¥æ¬å»ï¼Œä¸å¦‚æŠŠä¿é™©ç®±é’¥åŒ™ï¼ˆå¥æŸ„ï¼‰ç»™å¯¹æ–¹ï¼Œè®©ä»–è‡ªå·±å»å–ã€‚</p>
<p><strong>åŸç†ï¼š</strong> ä¼ é€’èµ„æºçš„è®¿é—®å‡­è¯è€Œéèµ„æºæœ¬èº«</p>
<p><strong>æµç¨‹ï¼š</strong></p>
<ol>
<li>Browser Processæ‰“å¼€æ–‡ä»¶ï¼Œè·å¾—æ–‡ä»¶æè¿°ç¬¦FD#42</li>
<li>Browser Processä¼ é€’å¥æŸ„FD#42ç»™Renderer Process</li>
<li>Renderer Processä½¿ç”¨FD#42ç›´æ¥è¯»å–æ–‡ä»¶</li>
<li>æ–‡ä»¶ç³»ç»Ÿè¿”å›æ–‡ä»¶å†…å®¹</li>
</ol>
<hr/>
<h4 data-id="heading-26">2.3 å¦‚ä½•é€‰æ‹©åˆé€‚çš„é€šä¿¡æ¨¡å¼</h4>





































<table><thead><tr><th>é€šä¿¡æ¨¡å¼</th><th>å»¶è¿Ÿ</th><th>é€‚ç”¨æ•°æ®é‡</th><th>å†…å­˜æ‹·è´</th><th>å…¸å‹åœºæ™¯</th><th>ä½¿ç”¨åˆ¤æ–­</th></tr></thead><tbody><tr><td><strong>æ¶ˆæ¯ä¼ é€’</strong></td><td>~50Î¼s</td><td>&lt;1KB</td><td>æ˜¯</td><td>å‘½ä»¤ã€é…ç½®</td><td>å°æ•°æ®ï¼Œä½é¢‘</td></tr><tr><td><strong>å…±äº«å†…å­˜</strong></td><td>~5Î¼s</td><td>&gt;100KB</td><td>å¦</td><td>å›¾åƒã€è§†é¢‘</td><td>å¤§æ•°æ®ï¼Œé«˜é¢‘</td></tr><tr><td><strong>å¥æŸ„ä¼ é€’</strong></td><td>~20Î¼s</td><td>ä¸é™</td><td>å¦</td><td>æ–‡ä»¶ã€Socket</td><td>èµ„æºå¼•ç”¨</td></tr></tbody></table>
<p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>
<ul>
<li>ğŸ“ å‘é€ç®€å•æŒ‡ä»¤ â†’ æ¶ˆæ¯ä¼ é€’</li>
<li>ğŸ–¼ï¸ ä¼ è¾“å›¾ç‰‡è§†é¢‘ â†’ å…±äº«å†…å­˜</li>
<li>ğŸ“ è®¿é—®å¤§æ–‡ä»¶ â†’ å¥æŸ„ä¼ é€’</li>
</ul>
<hr/>
<h3 data-id="heading-27">ä¸‰ã€æ¸²æŸ“å¼•æ“ï¼šä»HTMLåˆ°åƒç´ çš„å¥‡å¦™æ—…ç¨‹</h3>
<h4 data-id="heading-28">3.1 å®Œæ•´æ¸²æŸ“æµç¨‹æ¦‚è§ˆ</h4>
<p><strong>é—®é¢˜ï¼š</strong> å½“ä½ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥<code>www.zhuanzhuan.com</code>å¹¶æŒ‰ä¸‹å›è½¦ï¼Œåˆ°é¡µé¢å®Œæ•´æ˜¾ç¤ºï¼Œè¿™æœŸé—´å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<p><strong>ç”¨æˆ·è§†è§’ï¼š</strong> è¾“å…¥URLï¼ŒæŒ‰ä¸‹å›è½¦ï¼ŒçŸ­æš‚ç™½å±ï¼Œé¡µé¢å®Œæ•´å‘ˆç°ã€‚æ•´ä¸ªè¿‡ç¨‹çº¦åŠç§’ã€‚</p>
<p><strong>æŠ€æœ¯è§†è§’ï¼š</strong> è¿™åŠç§’å†…ï¼Œå¤šä¸ªè¿›ç¨‹ååŒå·¥ä½œï¼Œå®Œæˆç½‘ç»œä¸‹è½½ã€HTMLè§£æã€CSSè®¡ç®—ã€å¸ƒå±€æ’ç‰ˆã€ç»˜åˆ¶æŒ‡ä»¤ç”Ÿæˆã€GPUåˆæˆç­‰ä¸€ç³»åˆ—å¤æ‚æ“ä½œã€‚</p>
<h5 data-id="heading-29">å®Œæ•´æµç¨‹æ—¶é—´çº¿ï¼ˆæ€»è€—æ—¶çº¦500msï¼‰</h5>
<p><strong>0-200msï¼šç½‘ç»œè¯·æ±‚é˜¶æ®µ</strong></p>
<ul>
<li>Browser Processå‘èµ·HTTPè¯·æ±‚</li>
<li>DNSè§£æ â†’ TCPè¿æ¥ â†’ HTTPè¯·æ±‚/å“åº”</li>
</ul>
<p><strong>200-300msï¼šæ•°æ®ä¸‹è½½</strong></p>
<ul>
<li>Network Serviceä¸‹è½½HTMLæ•°æ®</li>
</ul>
<p><strong>300-500msï¼šæ¸²æŸ“ç®¡çº¿</strong></p>
<ul>
<li>300-350msï¼šParseï¼ˆHTML/CSSè§£æï¼‰</li>
<li>350-370msï¼šStyleï¼ˆæ ·å¼è®¡ç®—ï¼‰</li>
<li>370-400msï¼šLayoutï¼ˆå¸ƒå±€è®¡ç®—ï¼‰</li>
<li>400-430msï¼šPaintï¼ˆç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤ï¼‰</li>
<li>430-480msï¼šCompositeï¼ˆå›¾å±‚åˆæˆï¼‰</li>
</ul>
<p><strong>480-500msï¼šGPUåˆæˆè¾“å‡º</strong></p>
<ul>
<li>Tilingï¼ˆç“¦ç‰‡åˆ’åˆ†ï¼‰</li>
<li>Rasterizationï¼ˆå…‰æ …åŒ–ï¼‰</li>
<li>Compositeï¼ˆåˆæˆï¼‰</li>
</ul>
<p><strong>500msï¼šå±å¹•æ˜¾ç¤º</strong> ğŸ‰</p>
<h5 data-id="heading-30">æ¸²æŸ“ç®¡çº¿å…­å¤§é˜¶æ®µ</h5>






















































<table><thead><tr><th>é˜¶æ®µ</th><th>è¾“å…¥</th><th>è¾“å‡º</th><th>ä¸»è¦å·¥ä½œ</th><th>è§¦å‘æ¡ä»¶</th></tr></thead><tbody><tr><td><strong>Parse</strong></td><td>HTML/CSSæ–‡æœ¬</td><td>DOMæ ‘+CSSOMæ ‘</td><td>è§£ææ–‡æ¡£ç»“æ„</td><td>é¦–æ¬¡åŠ è½½</td></tr><tr><td><strong>Style</strong></td><td>DOM+CSSOM</td><td>Render Tree</td><td>è®¡ç®—æ¯ä¸ªå…ƒç´ çš„æ ·å¼</td><td>CSSå˜åŒ–</td></tr><tr><td><strong>Layout</strong></td><td>Render Tree</td><td>Layout Tree</td><td>è®¡ç®—å…ƒç´ ä½ç½®å’Œå°ºå¯¸</td><td>å‡ ä½•å±æ€§å˜åŒ–</td></tr><tr><td><strong>Paint</strong></td><td>Layout Tree</td><td>Display List</td><td>ç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤</td><td>è§†è§‰å±æ€§å˜åŒ–</td></tr><tr><td><strong>Composite</strong></td><td>Display List</td><td>Layer Tree</td><td>å›¾å±‚åˆ†å±‚å’Œåˆæˆ</td><td>transform/opacityå˜åŒ–</td></tr><tr><td><strong>Display</strong></td><td>Layer Tree</td><td>å±å¹•åƒç´ </td><td>GPUè¾“å‡ºåˆ°å±å¹•</td><td>æ¯ä¸€å¸§</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-31">3.2 Parseé˜¶æ®µï¼šè¾¹ä¸‹è½½è¾¹è§£æçš„æ™ºæ…§</h4>
<p><strong>é—®é¢˜åœºæ™¯ï¼š</strong> ä¸€ä¸ªç”µå•†é¦–é¡µçš„HTMLå¯èƒ½æœ‰500KBï¼Œå¦‚æœç­‰å¾…å…¨éƒ¨ä¸‹è½½å®Œå†è§£æï¼Œç”¨æˆ·ä¼šç›¯ç€ç™½å±ç­‰å¾…å¥½å‡ ç§’ã€‚èƒ½ä¸èƒ½è¾¹ä¸‹è½½è¾¹è§£æï¼Ÿ</p>
<p><strong>ç­”æ¡ˆï¼š</strong> å¯ä»¥ï¼æµè§ˆå™¨é‡‡ç”¨<strong>æµå¼è§£æï¼ˆStreaming Parseï¼‰</strong>ï¼Œæ”¶åˆ°ä¸€å°å—æ•°æ®ï¼ˆé€šå¸¸8KBï¼‰å°±ç«‹å³å¼€å§‹å¤„ç†ã€‚</p>
<h5 data-id="heading-32">é¢„æ‰«æå™¨ï¼ˆPreload Scannerï¼‰æ€§èƒ½ä¼˜åŒ–</h5>
<p><strong>é—®é¢˜ï¼š</strong> HTMLè§£æé‡åˆ°<code>&lt;script&gt;</code>æ ‡ç­¾æ—¶ä¼šé˜»å¡ï¼Œåé¢çš„èµ„æºæ— æ³•æå‰å‘ç°å’Œä¸‹è½½ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> é¢„æ‰«æå™¨åœ¨ä¸»è§£æå™¨é˜»å¡æ—¶ï¼Œç»§ç»­æ‰«æåç»­HTMLï¼Œæå‰å‘ç°èµ„æºå¼•ç”¨å¹¶è¡Œä¸‹è½½ã€‚</p>
<p><strong>å·¥ä½œæµç¨‹ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">0ms    - ä¸»è§£æå™¨å¼€å§‹å·¥ä½œ
50ms   - é‡åˆ°&lt;script <span class="hljs-attr">src</span>=<span class="hljs-string">"app.js"</span>&gt;ï¼Œä¸»è§£æå™¨æš‚åœ
50ms   - é¢„æ‰«æå™¨æ¿€æ´»ï¼Œæ‰«æåç»­HTML
55ms   - é¢„æ‰«æå™¨å‘ç°&lt;link <span class="hljs-attr">href</span>=<span class="hljs-string">"style.css"</span>&gt;ï¼Œç«‹å³å¼€å§‹ä¸‹è½½
60ms   - é¢„æ‰«æå™¨å‘ç°&lt;img <span class="hljs-attr">src</span>=<span class="hljs-string">"logo.jpg"</span>&gt;ï¼Œç«‹å³å¼€å§‹ä¸‹è½½
200ms  - app.jsä¸‹è½½å®Œæˆï¼Œä¸»è§£æå™¨æ¢å¤
250ms  - style.csså·²å®Œæˆï¼ˆå¹¶è¡Œä¸‹è½½èŠ‚çœæ—¶é—´ï¼‰
500ms  - logo.jpgå·²å®Œæˆï¼ˆå¹¶è¡Œä¸‹è½½èŠ‚çœæ—¶é—´ï¼‰
</code></pre>
<h5 data-id="heading-33">æ€§èƒ½å¯¹æ¯”</h5>























<table><thead><tr><th>åœºæ™¯</th><th>èµ„æºå‘ç°æ–¹å¼</th><th>æ€»è€—æ—¶</th><th>æ€§èƒ½æå‡</th></tr></thead><tbody><tr><td><strong>æ— é¢„æ‰«æå™¨</strong></td><td>ä¸²è¡Œå‘ç°èµ„æº</td><td>1100ms</td><td>åŸºå‡†</td></tr><tr><td><strong>æœ‰é¢„æ‰«æå™¨</strong></td><td>å¹¶è¡Œå‘ç°+ä¸‹è½½</td><td>500ms</td><td><strong>2.2å€</strong></td></tr></tbody></table>
<hr/>
<h4 data-id="heading-34">3.3 Styleé˜¶æ®µï¼šCSSé€‰æ‹©å™¨çš„åŒ¹é…é­”æ³•</h4>
<p><strong>é—®é¢˜åœºæ™¯ï¼š</strong> ä¸€ä¸ªå¤æ‚çš„å•é¡µåº”ç”¨å¯èƒ½æœ‰10,000ä¸ªDOMå…ƒç´ ï¼ŒCSSæ–‡ä»¶é‡Œæœ‰5,000æ¡è§„åˆ™ã€‚æµè§ˆå™¨éœ€è¦åˆ¤æ–­å“ªäº›è§„åˆ™åº”ç”¨åˆ°å“ªäº›å…ƒç´ ï¼Œè¿™æ˜¯ä¸€ä¸ªç»„åˆçˆ†ç‚¸é—®é¢˜ï¼ˆ10,000 Ã— 5,000 = 5åƒä¸‡æ¬¡åˆ¤æ–­ï¼‰ã€‚</p>
<p><strong>æŒ‘æˆ˜ï¼š</strong> å¦‚ä½•åœ¨æ¯«ç§’çº§å®Œæˆè¿™ä¸ªè®¡ç®—ï¼Ÿ</p>
<h5 data-id="heading-35">CSSé€‰æ‹©å™¨ç¤ºä¾‹</h5>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">div</span><span class="hljs-selector-class">.container</span> <span class="hljs-selector-tag">nav</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.active</span> { 
  <span class="hljs-attribute">color</span>: red; 
}
</code></pre>
<h5 data-id="heading-36">ä¸ºä»€ä¹ˆè¦ä»å³åˆ°å·¦åŒ¹é…ï¼Ÿ</h5>
<p><strong>æµè§ˆå™¨é‡‡ç”¨ï¼šä»å³åˆ°å·¦åŒ¹é…</strong></p>
<ol>
<li>å®šä½æ‰€æœ‰ <code>a.active</code> å…ƒç´  â†’ ç»“æœï¼š50ä¸ªå…ƒç´ </li>
<li>è¿‡æ»¤çˆ¶å…ƒç´ é<code>li</code>çš„ â†’ æ’é™¤30ä¸ªï¼Œå‰©ä½™20ä¸ª</li>
<li>è¿‡æ»¤æ— <code>ul</code>ç¥–å…ˆçš„ â†’ æ’é™¤10ä¸ªï¼Œå‰©ä½™10ä¸ª</li>
<li>è¿‡æ»¤æ— <code>nav</code>ç¥–å…ˆçš„ â†’ æ’é™¤5ä¸ªï¼Œå‰©ä½™5ä¸ª</li>
<li>è¿‡æ»¤æ— <code>div.container</code>ç¥–å…ˆçš„ â†’ æ’é™¤3ä¸ªï¼Œå‰©ä½™2ä¸ª</li>
</ol>
<p>âœ… <strong>åŒ¹é…å®Œæˆï¼š2ä¸ªå…ƒç´ ï¼ˆæ£€æŸ¥çº¦100ä¸ªå…ƒç´ ï¼‰</strong></p>
<p><strong>å¦‚æœä»å·¦åˆ°å³åŒ¹é…ï¼ˆä½æ•ˆæ–¹æ¡ˆï¼‰ï¼š</strong></p>
<ol>
<li>å®šä½æ‰€æœ‰ <code>div.container</code> â†’ ç»“æœï¼š100ä¸ªå…ƒç´ </li>
<li>éå†è¿™100ä¸ªdivçš„æ‰€æœ‰å­å­™å…ƒç´ æŸ¥æ‰¾<code>nav</code> â†’ å¯èƒ½æ£€æŸ¥10000+ä¸ªèŠ‚ç‚¹</li>
<li>ç»§ç»­æ·±åº¦éå†... â†’ éœ€è¦å¤§é‡å›æº¯</li>
</ol>
<p>âŒ <strong>æ€§èƒ½ä¸¥é‡ä¸‹é™ï¼ˆæ£€æŸ¥çº¦10,000+ä¸ªå…ƒç´ ï¼‰</strong></p>
<h5 data-id="heading-37">æ€§èƒ½æ•°æ®å¯¹æ¯”</h5>























<table><thead><tr><th>åŒ¹é…æ–¹å‘</th><th>å…ƒç´ æ£€æŸ¥é‡</th><th>å¹³å‡è€—æ—¶</th><th>æ€§èƒ½æ¯”</th></tr></thead><tbody><tr><td><strong>ä»å³åˆ°å·¦</strong></td><td>~100ä¸ª</td><td>~1ms</td><td>åŸºå‡†</td></tr><tr><td><strong>ä»å·¦åˆ°å³</strong></td><td>~10,000ä¸ª</td><td>~100ms</td><td><strong>æ…¢100å€</strong></td></tr></tbody></table>
<p><strong>ä¼˜åŒ–å»ºè®®ï¼š</strong></p>
<ul>
<li>âœ… ä½¿ç”¨æ›´å…·ä½“çš„é€‰æ‹©å™¨ï¼ˆå¦‚ç±»é€‰æ‹©å™¨ã€IDé€‰æ‹©å™¨ï¼‰</li>
<li>âœ… é¿å…è¿‡æ·±çš„åµŒå¥—é€‰æ‹©å™¨</li>
<li>âŒ é¿å…é€šé…ç¬¦é€‰æ‹©å™¨ <code>*</code></li>
</ul>
<hr/>
<h4 data-id="heading-38">3.4 Layouté˜¶æ®µï¼šè®¡ç®—å…ƒç´ çš„ä½ç½®å’Œå°ºå¯¸</h4>
<p><strong>åœºæ™¯ï¼š</strong> ä½ æ‰“å¼€ä¸€ä¸ªå“åº”å¼ç½‘é¡µï¼Œæµè§ˆå™¨çª—å£å®½åº¦1920pxã€‚æµè§ˆå™¨éœ€è¦è®¡ç®—æ¯ä¸ªå…ƒç´ çš„ç¡®åˆ‡ä½ç½®å’Œå°ºå¯¸ã€‚</p>
<p><strong>ç¤ºä¾‹è®¡ç®—ï¼š</strong></p>
<ul>
<li>å¯¼èˆªæ å®½åº¦ï¼š100% â†’ 1920px</li>
<li>ä¸»å†…å®¹åŒºï¼š70%å®½åº¦ï¼Œå·¦æµ®åŠ¨ â†’ 1344px</li>
<li>ä¾§è¾¹æ ï¼š30%å®½åº¦ï¼Œå³æµ®åŠ¨ â†’ 576px</li>
</ul>
<h5 data-id="heading-39">Layoutè§¦å‘æœºåˆ¶</h5>





























<table><thead><tr><th>è§¦å‘ç±»å‹</th><th>è§¦å‘åœºæ™¯</th><th>è€—æ—¶</th><th>å½±å“èŒƒå›´</th></tr></thead><tbody><tr><td><strong>Initial Layout</strong></td><td>é¦–æ¬¡åŠ è½½é¡µé¢</td><td>100-500ms</td><td>å…¨å±€</td></tr><tr><td><strong>Incremental Layout</strong></td><td>å±€éƒ¨DOMå˜åŒ–</td><td>1-50ms</td><td>å±€éƒ¨</td></tr><tr><td><strong>Full Layout</strong></td><td>çª—å£è°ƒæ•´å¤§å°</td><td>200-1000ms</td><td>å…¨å±€</td></tr></tbody></table>
<h5 data-id="heading-40">è§¦å‘Layoutçš„CSSå±æ€§</h5>
<p><strong>ç›’æ¨¡å‹ç›¸å…³ï¼š</strong></p>
<ul>
<li><code>width</code>, <code>height</code>, <code>padding</code>, <code>margin</code>, <code>border</code></li>
</ul>
<p><strong>å®šä½ç›¸å…³ï¼š</strong></p>
<ul>
<li><code>position</code>, <code>top</code>, <code>left</code>, <code>bottom</code>, <code>right</code></li>
</ul>
<p><strong>å…¶ä»–ï¼š</strong></p>
<ul>
<li><code>float</code>, <code>clear</code>, <code>display</code>, <code>overflow</code>, <code>font-size</code>, <code>line-height</code></li>
</ul>
<hr/>
<h5 data-id="heading-41">Layout Thrashingï¼ˆå¸ƒå±€æŠ–åŠ¨ï¼‰ï¼šæ€§èƒ½æ€æ‰‹</h5>
<p><strong>çœŸå®æ¡ˆä¾‹ï¼š</strong> æŸç”µå•†å¹³å°çš„å•†å“åˆ—è¡¨é¡µç€‘å¸ƒæµå¸ƒå±€</p>
<p><strong>é—®é¢˜è¡¨ç°ï¼š</strong></p>
<ul>
<li>ç”¨æˆ·æ»šåŠ¨åˆ—è¡¨æ—¶æ˜æ˜¾å¡é¡¿ï¼Œæ»šåŠ¨å»¶è¿Ÿè¾¾500ms</li>
<li>Performanceé¢æ¿æ˜¾ç¤ºå¤§é‡çº¢è‰²Long Taskï¼ˆ&gt;50msï¼‰</li>
<li>ç”¨æˆ·æŠ•è¯‰"é¡µé¢å¾ˆå¡"ï¼Œè·³å‡ºç‡ä¸Šå‡15%</li>
</ul>
<p><strong>é—®é¢˜ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ åæ¨¡å¼ï¼šåœ¨å¾ªç¯ä¸­äº¤æ›¿è¯»å†™</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateLayout</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
    <span class="hljs-keyword">const</span> height = cards[i].<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">height</span>; <span class="hljs-comment">// å¼ºåˆ¶Layout</span>
    cards[i].<span class="hljs-property">style</span>.<span class="hljs-property">marginTop</span> = height * <span class="hljs-number">0.1</span> + <span class="hljs-string">'px'</span>; <span class="hljs-comment">// æ ‡è®°Layoutå¤±æ•ˆ</span>
    <span class="hljs-comment">// ä¸‹æ¬¡å¾ªç¯å†è¯»å–æ—¶ï¼Œæµè§ˆå™¨å¿…é¡»é‡æ–°Layout</span>
  }
}
</code></pre>
<p><strong>é—®é¢˜åˆ†æï¼š</strong></p>
<ul>
<li>è§¦å‘Layoutæ¬¡æ•°ï¼š<strong>1000æ¬¡</strong></li>
<li>å•æ¬¡Layoutè€—æ—¶ï¼šçº¦0.5ms</li>
<li>æ€»è€—æ—¶ï¼š1000 Ã— 0.5ms = <strong>500ms</strong></li>
<li>å¸§ç‡ï¼šçº¦<strong>2fps</strong>ï¼ˆä¸¥é‡æ‰å¸§ï¼‰</li>
</ul>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆï¼šæ‰¹é‡è¯»å†™åˆ†ç¦»</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… æœ€ä½³å®è·µï¼šæ‰¹é‡æ“ä½œ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateLayoutOptimized</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// é˜¶æ®µ1ï¼šæ‰¹é‡è¯»å–ï¼ˆè§¦å‘1æ¬¡Layoutï¼‰</span>
  <span class="hljs-keyword">const</span> heights = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
    heights[i] = cards[i].<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">height</span>;
  }
  
  <span class="hljs-comment">// é˜¶æ®µ2ï¼šæ‰¹é‡å†™å…¥ï¼ˆä¸è§¦å‘Layoutï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
    cards[i].<span class="hljs-property">style</span>.<span class="hljs-property">marginTop</span> = heights[i] * <span class="hljs-number">0.1</span> + <span class="hljs-string">'px'</span>;
  }
}
</code></pre>
<p><strong>ä¼˜åŒ–æ•ˆæœï¼š</strong></p>





























<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¼˜åŒ–å‰</th><th>ä¼˜åŒ–å</th><th>æå‡</th></tr></thead><tbody><tr><td>Layoutæ¬¡æ•°</td><td>1000æ¬¡</td><td>1æ¬¡</td><td>1000å€</td></tr><tr><td>æ€»è€—æ—¶</td><td>500ms</td><td>20ms</td><td><strong>25å€</strong></td></tr><tr><td>å¸§ç‡</td><td>2fps</td><td>60fps</td><td><strong>æµç•…</strong></td></tr></tbody></table>
<hr/>
<h4 data-id="heading-42">3.5 Painté˜¶æ®µï¼šç”Ÿæˆç»˜åˆ¶è¯´æ˜ä¹¦</h4>
<p><strong>è®¾è®¡ç†å¿µï¼š</strong> Painté˜¶æ®µä¸ç›´æ¥æŠŠåƒç´ ç”»åˆ°å±å¹•ä¸Šï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä»½"ç»˜åˆ¶è¯´æ˜ä¹¦"ï¼ˆDisplay Listï¼‰ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>
<ol>
<li>âœ… è¯´æ˜ä¹¦å¯ä»¥å¤ç”¨ï¼ˆå…ƒç´ æ²¡å˜åŒ–å°±ä¸ç”¨é‡æ–°ç”Ÿæˆï¼‰</li>
<li>âœ… è¯´æ˜ä¹¦å¯ä»¥ä¼˜åŒ–ï¼ˆåˆå¹¶é‡å¤æ“ä½œï¼‰</li>
<li>âœ… å®é™…ç»˜åˆ¶å¯ä»¥äº¤ç»™GPUï¼ˆå¹¶è¡Œå¤„ç†ï¼‰</li>
</ol>
<h5 data-id="heading-43">Display Listç»“æ„</h5>
<p><strong>ä»DOMå…ƒç´ åˆ°ç»˜åˆ¶æŒ‡ä»¤ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css">DOMå…ƒç´  
  â†“
Paintè¿‡ç¨‹ 
  â†“
<span class="hljs-attribute">Display</span> List
  â”œâ”€ DrawRectï¼ˆç»˜åˆ¶çŸ©å½¢ï¼‰
  â”œâ”€ DrawImageï¼ˆç»˜åˆ¶å›¾åƒï¼‰
  â”œâ”€ DrawTextï¼ˆç»˜åˆ¶æ–‡æœ¬ï¼‰
  â””â”€ ApplyFilterï¼ˆåº”ç”¨æ»¤é•œï¼‰
  â†“
åç»­æ‰§è¡Œï¼ˆå¯ä¼˜åŒ–/ç¼“å­˜ï¼‰
</code></pre>
<h5 data-id="heading-44">Paint Layeråˆ›å»ºæ¡ä»¶</h5>
<p><strong>æ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶ï¼Œå…ƒç´ ä¼šè¢«æå‡ä¸ºç‹¬ç«‹çš„Paint Layerï¼š</strong></p>
<p><strong>CSSå±æ€§ï¼š</strong></p>
<ul>
<li><code>position: fixed</code> æˆ– <code>position: sticky</code></li>
<li><code>opacity &lt; 1</code></li>
<li><code>transform</code> å±æ€§</li>
<li><code>filter</code> æ»¤é•œ</li>
<li><code>will-change</code> å£°æ˜</li>
</ul>
<p><strong>å…ƒç´ ç±»å‹ï¼š</strong></p>
<ul>
<li><code>&lt;video&gt;</code>, <code>&lt;canvas&gt;</code>, <code>&lt;iframe&gt;</code></li>
</ul>
<p><strong>å¸ƒå±€ï¼š</strong></p>
<ul>
<li><code>overflow: scroll</code> æ»šåŠ¨å®¹å™¨</li>
</ul>
<hr/>
<h3 data-id="heading-45">å››ã€GPUåˆæˆå™¨æ¶æ„ï¼šè®©åŠ¨ç”»é£èµ·æ¥</h3>
<h4 data-id="heading-46">4.1 åœºæ™¯ï¼šJavaScriptå†å¿™ä¹Ÿä¸å½±å“æ»šåŠ¨</h4>
<p><strong>çœŸå®ä½“éªŒï¼š</strong> ä½ åœ¨æµè§ˆä¸€ä¸ªå¤æ‚çš„å•é¡µåº”ç”¨ï¼Œé¡µé¢æ­£åœ¨æ‰§è¡Œå¤æ‚çš„æ•°æ®å¤„ç†ã€‚æ­¤æ—¶ä½ æ»šåŠ¨é¡µé¢ï¼š</p>
<ul>
<li>âŒ <strong>æ—§æµè§ˆå™¨</strong>ï¼šæ»šåŠ¨å¡é¡¿ï¼Œç”šè‡³å®Œå…¨å¡ä½</li>
<li>âœ… <strong>ç°ä»£æµè§ˆå™¨</strong>ï¼šæ»šåŠ¨ä¾ç„¶æµç•…</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆï¼Ÿ</strong> ç§˜å¯†åœ¨äº**Compositor Threadï¼ˆåˆæˆå™¨çº¿ç¨‹ï¼‰**çš„ç‹¬ç«‹æ¶æ„ã€‚</p>
<h5 data-id="heading-47">å®éªŒå¯¹æ¯”</h5>























<table><thead><tr><th>åœºæ™¯</th><th>Main ThreadçŠ¶æ€</th><th>æ»šåŠ¨æ€§èƒ½</th><th>åŸç†</th></tr></thead><tbody><tr><td><strong>åœºæ™¯A</strong></td><td>æ‰§è¡Œå¯†é›†è®¡ç®—</td><td>ä¾ç„¶æµç•…</td><td>Compositorç‹¬ç«‹å¤„ç†</td></tr><tr><td><strong>åœºæ™¯B</strong></td><td>æ‰§è¡Œå¯†é›†è®¡ç®—</td><td>åŠ¨ç”»ä¸å—å½±å“</td><td>transformåœ¨Compositoræ‰§è¡Œ</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-48">4.2 å•çº¿ç¨‹ vs å¤šçº¿ç¨‹æ¶æ„å¯¹æ¯”</h4>
<h5 data-id="heading-49">ä¼ ç»Ÿå•çº¿ç¨‹æ¨¡å¼</h5>
<p><strong>æ€»è€—æ—¶80msï¼Œå¸§ç‡12fps</strong></p>
<pre><code class="hljs language-css" lang="css">æ—¶é—´çº¿ï¼š
<span class="hljs-number">0ms</span>   - JavaScriptæ‰§è¡Œï¼ˆ<span class="hljs-number">50ms</span>ï¼‰<span class="hljs-selector-attr">[Main Thread é˜»å¡]</span>
<span class="hljs-number">50ms</span>  - Styleè®¡ç®—ï¼ˆ<span class="hljs-number">5ms</span>ï¼‰
<span class="hljs-number">55ms</span>  - Layoutè®¡ç®—ï¼ˆ<span class="hljs-number">10ms</span>ï¼‰
<span class="hljs-number">65ms</span>  - Paintç”Ÿæˆï¼ˆ<span class="hljs-number">15ms</span>ï¼‰
<span class="hljs-number">80ms</span>  - æäº¤GPUæ¸²æŸ“

é—®é¢˜ï¼šæ‰€æœ‰ä»»åŠ¡ä¸²è¡Œæ‰§è¡Œï¼ŒJSé˜»å¡å¯¼è‡´å¡é¡¿
</code></pre>
<h5 data-id="heading-50">Compositorå¤šçº¿ç¨‹æ¨¡å¼</h5>
<p><strong>Compositorä¿æŒ60fps</strong></p>
<pre><code class="hljs language-css" lang="css">ã€<span class="hljs-selector-tag">Main</span> Threadã€‘
<span class="hljs-number">0ms</span>  - JavaScriptæ‰§è¡Œï¼ˆ<span class="hljs-number">50ms</span>ï¼‰<span class="hljs-selector-attr">[çº¿ç¨‹é˜»å¡ï¼Œä½†ä¸å½±å“Compositor]</span>

ã€Compositor Threadã€‘ï¼ˆåŒæ—¶è¿›è¡Œï¼‰
<span class="hljs-number">0ms</span>  - å¤„ç†æ»šåŠ¨äº‹ä»¶
<span class="hljs-number">16ms</span> - æäº¤å¸§<span class="hljs-number">1</span>ï¼ˆ<span class="hljs-number">60</span>fpsï¼‰
<span class="hljs-number">32ms</span> - æäº¤å¸§<span class="hljs-number">2</span>ï¼ˆ<span class="hljs-number">60</span>fpsï¼‰
<span class="hljs-number">48ms</span> - æäº¤å¸§<span class="hljs-number">3</span>ï¼ˆ<span class="hljs-number">60</span>fpsï¼‰

ç»“æœï¼šCompositorä¿æŒ<span class="hljs-number">60</span>fpsæµç•…è¿è¡Œ
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼š</strong></p>























<table><thead><tr><th>æ¨¡å¼</th><th>Main Threadè€—æ—¶</th><th>ç”¨æˆ·æ„ŸçŸ¥å¸§ç‡</th><th>ä½“éªŒ</th></tr></thead><tbody><tr><td><strong>å•çº¿ç¨‹</strong></td><td>80ms</td><td>12fps</td><td>å¡é¡¿</td></tr><tr><td><strong>å¤šçº¿ç¨‹</strong></td><td>50msï¼ˆä¸å½±å“æ»šåŠ¨ï¼‰</td><td>60fps</td><td>æµç•…</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-51">4.3 ä¸ºä»€ä¹ˆtransformåŠ¨ç”»è¿™ä¹ˆæµç•…ï¼Ÿ</h4>
<p><strong>æ—¥å¸¸è§‚å¯Ÿï¼š</strong> æ‰‹æœºä¸Šæ»‘åŠ¨æŠ½å±‰èœå•éå¸¸ä¸æ»‘ï¼Œä½†æœ‰äº›ç½‘ç«™çš„è½®æ’­å›¾åˆ‡æ¢å´æœ‰æ˜æ˜¾å¡é¡¿ã€‚ä¸ºä»€ä¹ˆï¼Ÿ</p>
<h5 data-id="heading-52">ä¸¤ç§åŠ¨ç”»å®ç°æ–¹å¼å¯¹æ¯”</h5>
<p><strong>æ–¹æ¡ˆAï¼šä¿®æ”¹leftå±æ€§ï¼ˆä¸æ¨èï¼‰</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@keyframes</span> moveLeft {
  <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>; }
  <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">left</span>: <span class="hljs-number">100px</span>; }
}
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css">ä¿®æ”¹<span class="hljs-attribute">left</span>å±æ€§ 
  â†“ è§¦å‘Layoutï¼ˆ<span class="hljs-number">20ms</span>ï¼‰- éœ€è¦é‡æ–°è®¡ç®—ä½ç½®
  â†“ è§¦å‘Paintï¼ˆ<span class="hljs-number">10ms</span>ï¼‰- éœ€è¦é‡æ–°ç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤
  â†“ è§¦å‘Compositeï¼ˆ<span class="hljs-number">2ms</span>ï¼‰
  â†“ æ€»è€—æ—¶ï¼š<span class="hljs-number">32ms</span>ï¼Œå¸§ç‡ï¼š<span class="hljs-number">31</span>fps âŒ
</code></pre>
<p><strong>æ–¹æ¡ˆBï¼šä½¿ç”¨transformï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@keyframes</span> moveTransform {
  <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>); }
  <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">100px</span>); }
}
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css">ä¿®æ”¹<span class="hljs-attribute">transform</span>å±æ€§ 
  â†“ è·³è¿‡Layout âœ…
  â†“ è·³è¿‡Paint âœ…
  â†“ ä»…è§¦å‘Compositeï¼ˆ<span class="hljs-number">2ms</span>ï¼‰- GPUç›´æ¥å¤„ç†
  â†“ æ€»è€—æ—¶ï¼š<span class="hljs-number">2ms</span>ï¼Œå¸§ç‡ï¼š<span class="hljs-number">60</span>fps âœ…
</code></pre>
<h5 data-id="heading-53">æ€§èƒ½å·®å¼‚å¯¹æ¯”</h5>
































<table><thead><tr><th>åŠ¨ç”»æ–¹å¼</th><th>Layout</th><th>Paint</th><th>Composite</th><th>æ€»è€—æ—¶</th><th>å¸§ç‡</th><th>æ€§èƒ½å·®è·</th></tr></thead><tbody><tr><td><strong>ä¿®æ”¹left</strong></td><td>âœ… 20ms</td><td>âœ… 10ms</td><td>âœ… 2ms</td><td>32ms</td><td>31fps</td><td>åŸºå‡†</td></tr><tr><td><strong>ä½¿ç”¨transform</strong></td><td>âŒ è·³è¿‡</td><td>âŒ è·³è¿‡</td><td>âœ… 2ms</td><td>2ms</td><td>60fps</td><td><strong>16å€</strong></td></tr></tbody></table>
<p><strong>åŸç†ï¼š</strong> transformå±æ€§çš„å˜æ›´ä»…å½±å“Compositeé˜¶æ®µï¼ŒGPUå¯ç›´æ¥å¤„ç†å˜æ¢çŸ©é˜µã€‚</p>
<hr/>
<h4 data-id="heading-54">4.4 å®Œæ•´GPUåˆæˆæ¶æ„</h4>
<p>GPUåˆæˆå™¨æ¶æ„æ¶‰åŠ4ä¸ªå…³é”®éƒ¨åˆ†çš„åä½œï¼š</p>
<h5 data-id="heading-55">æ¶æ„ç»„æˆ</h5>
<p><strong>ã€Main Threadã€‘ï¼ˆRenderer Processï¼‰</strong></p>
<ul>
<li>JavaScriptæ‰§è¡Œ</li>
<li>æ ·å¼è®¡ç®—</li>
<li>å¸ƒå±€è®¡ç®—</li>
<li>Paintç”ŸæˆDisplayList</li>
<li>Commitæäº¤LayerTree</li>
</ul>
<p><strong>ã€Compositor Threadã€‘ï¼ˆRenderer Processï¼‰</strong></p>
<ul>
<li>æ¥æ”¶LayerTree</li>
<li>Tilingç“¦ç‰‡åˆ’åˆ†</li>
<li>è°ƒåº¦å…‰æ …åŒ–</li>
<li>Activateæ¿€æ´»</li>
<li>Drawç”ŸæˆCompositorFrame</li>
</ul>
<p><strong>ã€Raster Worker Threadsã€‘ï¼ˆ4ä¸ªå·¥ä½œçº¿ç¨‹ï¼‰</strong></p>
<ul>
<li>å¹¶è¡Œå…‰æ …åŒ–ç“¦ç‰‡</li>
</ul>
<p><strong>ã€Viz (GPU Process)ã€‘</strong></p>
<ul>
<li>èšåˆFrame</li>
<li>GPUåˆæˆ</li>
<li>Displayè¾“å‡ºåˆ°å±å¹•</li>
</ul>
<h5 data-id="heading-56">æµç¨‹è¯´æ˜</h5>





















































<table><thead><tr><th>æ­¥éª¤</th><th>æ‰€åœ¨çº¿ç¨‹/è¿›ç¨‹</th><th>ä¸»è¦å·¥ä½œ</th><th>å¯å¹¶è¡Œ</th></tr></thead><tbody><tr><td>1. JavaScriptæ‰§è¡Œ</td><td>Main Thread</td><td>ä¿®æ”¹DOM/æ ·å¼</td><td>âŒ</td></tr><tr><td>2. Style+Layout+Paint</td><td>Main Thread</td><td>è®¡ç®—æ ·å¼ã€å¸ƒå±€ã€ç”ŸæˆDisplayList</td><td>âŒ</td></tr><tr><td>3. Commit</td><td>Main Thread</td><td>æäº¤LayerTree</td><td>âŒ</td></tr><tr><td>4. Tiling</td><td>Compositor Thread</td><td>åˆ’åˆ†256Ã—256ç“¦ç‰‡</td><td>âœ… ä¸é˜»å¡Main</td></tr><tr><td>5. Raster</td><td>Raster Workers</td><td>å¹¶è¡Œå…‰æ …åŒ–</td><td>âœ… 4çº¿ç¨‹å¹¶è¡Œ</td></tr><tr><td>6. Draw</td><td>Compositor Thread</td><td>ç”ŸæˆCompositorFrame</td><td>âœ… ä¸é˜»å¡Main</td></tr><tr><td>7. Composite</td><td>GPU Process</td><td>GPUåˆæˆè¾“å‡º</td><td>âœ… ç‹¬ç«‹è¿›ç¨‹</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-57">4.5 Compositing Layerï¼ˆåˆæˆå±‚ï¼‰ï¼šç‹¬ç«‹çš„æ¸²æŸ“å›¾å±‚</h4>
<p><strong>ç±»æ¯”ï¼š</strong> åˆ¶ä½œåŠ¨ç”»ç‰‡æ—¶ï¼ŒèƒŒæ™¯ç”»åœ¨ä¸€å¼ çº¸ä¸Šï¼Œäººç‰©ç”»åœ¨é€æ˜èƒ¶ç‰‡ä¸Šã€‚äººç‰©ç§»åŠ¨æ—¶åªéœ€è¦ç§»åŠ¨èƒ¶ç‰‡ï¼Œä¸ç”¨é‡æ–°ç”»èƒŒæ™¯ã€‚</p>
<h5 data-id="heading-58">åˆ›å»ºæ¡ä»¶</h5>
<p><strong>æ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶ï¼Œå…ƒç´ ä¼šè¢«æå‡ä¸ºç‹¬ç«‹çš„Compositing Layerï¼š</strong></p>
<p><strong>3Då˜æ¢ï¼š</strong></p>
<ul>
<li><code>transform: translateZ(0)</code>, <code>rotate3d()</code>, <code>perspective</code></li>
</ul>
<p><strong>CSSå±æ€§ï¼š</strong></p>
<ul>
<li><code>transform</code> åŠ¨ç”», <code>opacity</code> åŠ¨ç”», <code>will-change</code>, <code>filter</code></li>
</ul>
<p><strong>åª’ä½“å…ƒç´ ï¼š</strong></p>
<ul>
<li><code>&lt;video&gt;</code>, <code>&lt;canvas&gt;</code>, <code>&lt;iframe&gt;</code></li>
</ul>
<p><strong>å®šä½ï¼š</strong></p>
<ul>
<li><code>position: fixed</code>, <code>position: sticky</code></li>
</ul>
<p><strong>æ»šåŠ¨ï¼š</strong></p>
<ul>
<li><code>overflow: scroll</code></li>
</ul>
<hr/>
<h5 data-id="heading-59">å†…å­˜æˆæœ¬ï¼šçœ‹ä¸è§çš„å†…å­˜æ€æ‰‹</h5>
<p><strong>çœŸå®æ¡ˆä¾‹ï¼š</strong> æŸç½‘ç«™åœ¨ç§»åŠ¨ç«¯é¢‘ç¹å´©æºƒ</p>
<p><strong>é—®é¢˜ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* âŒ ç»™100ä¸ªå•†å“å¡ç‰‡éƒ½åŠ äº†will-change */</span>
<span class="hljs-selector-class">.product-card</span> {
  <span class="hljs-attribute">will-change</span>: transform;
}
</code></pre>
<p><strong>å†…å­˜è®¡ç®—ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">å•ä¸ªLayerå†…å­˜å ç”¨ = å®½åº¦ Ã— é«˜åº¦ Ã— 4å­—èŠ‚ï¼ˆRGBAï¼‰

æ¡ˆä¾‹åˆ†æï¼š
<span class="hljs-deletion">- å•ä¸ªå•†å“å¡ç‰‡å°ºå¯¸ï¼š375Ã—200ï¼ˆç§»åŠ¨ç«¯å…¨å®½ï¼‰</span>
<span class="hljs-deletion">- å•ä¸ªLayerå†…å­˜ï¼š375 Ã— 200 Ã— 4 = 300KB</span>
<span class="hljs-deletion">- 100ä¸ªLayeræ€»å†…å­˜ï¼š300KB Ã— 100 = 30MB</span>
<span class="hljs-deletion">- åŠ ä¸Šä¸»é¡µé¢å’Œå…¶ä»–å†…å®¹ï¼šæ€»è®¡çº¦80MB</span>

é—®é¢˜ï¼šç§»åŠ¨è®¾å¤‡å†…å­˜ç´§å¼ ï¼Œå¯¼è‡´é¢‘ç¹è§¦å‘å†…å­˜å›æ”¶ï¼Œç”šè‡³å´©æºƒ
</code></pre>
<p><strong>æ­£ç¡®åšæ³•ï¼šæŒ‰éœ€åˆ›å»º</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… åªå¯¹æ­£åœ¨æ‰§è¡ŒåŠ¨ç”»çš„å…ƒç´ ä½¿ç”¨will-change</span>
element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseenter'</span>, <span class="hljs-function">() =&gt;</span> {
  element.<span class="hljs-property">style</span>.<span class="hljs-property">willChange</span> = <span class="hljs-string">'transform'</span>; <span class="hljs-comment">// å³å°†åŠ¨ç”»ï¼Œæå‰ä¼˜åŒ–</span>
});

element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'animationend'</span>, <span class="hljs-function">() =&gt;</span> {
  element.<span class="hljs-property">style</span>.<span class="hljs-property">willChange</span> = <span class="hljs-string">'auto'</span>; <span class="hljs-comment">// åŠ¨ç”»ç»“æŸï¼Œé‡Šæ”¾èµ„æº</span>
});
</code></pre>
<h5 data-id="heading-60">å†…å­˜ä¼˜åŒ–æ•ˆæœ</h5>





























<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¼˜åŒ–å‰</th><th>ä¼˜åŒ–å</th><th>æå‡</th></tr></thead><tbody><tr><td>åˆæˆå±‚æ•°é‡</td><td>100ä¸ª</td><td>1-3ä¸ªï¼ˆä»…æ´»åŠ¨å…ƒç´ ï¼‰</td><td>å‡å°‘97%</td></tr><tr><td>GPUå†…å­˜å ç”¨</td><td>80MB</td><td>2.4MB</td><td>å‡å°‘97%</td></tr><tr><td>ç§»åŠ¨ç«¯å´©æºƒç‡</td><td>é¢‘ç¹å´©æºƒ</td><td>åŸºæœ¬æ¶ˆé™¤</td><td>âœ…</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-61">4.6 æ–°é—»ç½‘ç«™æ¡ˆä¾‹ï¼šç§»åŠ¨ç«¯å´©æºƒé—®é¢˜æ’æŸ¥</h4>
<p><strong>èƒŒæ™¯ï¼š</strong></p>
<ul>
<li>æŸæ–°é—»ç½‘ç«™æ”¹ç‰ˆï¼Œé¦–é¡µé‡‡ç”¨é•¿åˆ—è¡¨è®¾è®¡</li>
<li>åŒ…å«50å¼ é«˜æ¸…æ–°é—»é…å›¾</li>
<li>ç»™æ‰€æœ‰å›¾ç‰‡æ·»åŠ äº†<code>will-change: opacity</code></li>
</ul>
<h5 data-id="heading-62">ç¾éš¾æ€§ä¸Šçº¿</h5>





























<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¸Šçº¿å‰</th><th>ä¸Šçº¿å</th><th>å˜åŒ–</th></tr></thead><tbody><tr><td>ç§»åŠ¨ç«¯å´©æºƒç‡</td><td>0.5%</td><td>2%</td><td>+300%</td></tr><tr><td>ç”¨æˆ·æŠ•è¯‰</td><td>å¶å°”</td><td>é¢‘ç¹</td><td>"æ‰“å¼€é¦–é¡µå°±é—ªé€€"</td></tr><tr><td>å½±å“è®¾å¤‡</td><td>-</td><td>ä½ç«¯Android</td><td>å°¤å…¶ä¸¥é‡</td></tr></tbody></table>
<h5 data-id="heading-63">ç´§æ€¥æ’æŸ¥</h5>
<p><strong>é—®é¢˜ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">.<span class="hljs-property">news</span>-image {
  will-<span class="hljs-attr">change</span>: opacity;  <span class="hljs-comment">// æ¯å¼ å›¾éƒ½åˆ›å»ºCompositing Layerï¼</span>
  <span class="hljs-attr">transition</span>: opacity <span class="hljs-number">0.</span>3s;
}
</code></pre>
<p><strong>å†…å­˜åˆ†æï¼š</strong></p>
<ul>
<li>åˆæˆå±‚æ•°é‡ï¼š53ä¸ªï¼ˆ50å¼ å›¾ç‰‡ + é¡µé¢åŸºç¡€å±‚ï¼‰</li>
<li>å•å¼ å›¾ç‰‡å°ºå¯¸ï¼š750Ã—500ï¼ˆç§»åŠ¨ç«¯å…¨å®½ï¼‰</li>
<li>å•ä¸ªLayerå†…å­˜ï¼š750 Ã— 500 Ã— 4 = 1.5MB</li>
<li>æ€»å†…å­˜å ç”¨ï¼š53 Ã— 1.5MB â‰ˆ 80MBï¼ˆä»…å›¾ç‰‡å±‚ï¼ï¼‰</li>
<li>åŠ ä¸Šé¡µé¢å…¶ä»–å†…å®¹ï¼šæ€»è®¡çº¦120MB</li>
</ul>
<p><strong>è®¾å¤‡å†…å­˜å¯¹æ¯”ï¼š</strong></p>

































<table><thead><tr><th>è®¾å¤‡</th><th>RAM</th><th>ç³»ç»Ÿå ç”¨</th><th>å¯ç”¨å†…å­˜</th><th>èƒ½å¦è¿è¡Œ</th></tr></thead><tbody><tr><td>iPhone 12</td><td>4GB</td><td>1GB</td><td>3GB</td><td>âœ… å‹‰å¼ºå¯ç”¨</td></tr><tr><td>Redmi Note 8</td><td>4GB</td><td>2GB</td><td>2GB</td><td>âŒ OOMå´©æºƒ</td></tr><tr><td>æ›´ä½ç«¯è®¾å¤‡</td><td>2-3GB</td><td>1.5GB</td><td>0.5-1.5GB</td><td>âŒ æ— æ³•æ‰“å¼€</td></tr></tbody></table>
<h5 data-id="heading-64">ä¼˜åŒ–æ–¹æ¡ˆ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… ä¼˜åŒ–ç­–ç•¥ï¼šä»…ç»™å¯è§åŒºåŸŸçš„å›¾ç‰‡æ·»åŠ will-change</span>
<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> {
  entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> img = entry.<span class="hljs-property">target</span>;
    
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">isIntersecting</span>) {
      <span class="hljs-comment">// å³å°†å¯è§ï¼Œæå‰ä¼˜åŒ–</span>
      img.<span class="hljs-property">style</span>.<span class="hljs-property">willChange</span> = <span class="hljs-string">'opacity'</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">intersectionRatio</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-comment">// å®Œå…¨ç¦»å¼€è§†å£ï¼Œç§»é™¤ä¼˜åŒ–</span>
      img.<span class="hljs-property">style</span>.<span class="hljs-property">willChange</span> = <span class="hljs-string">'auto'</span>;
    }
  });
}, {
  <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">'100px'</span>  <span class="hljs-comment">// æå‰100pxå¼€å§‹ä¼˜åŒ–</span>
});

newsImages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> observer.<span class="hljs-title function_">observe</span>(img));
</code></pre>
<h5 data-id="heading-65">ä¼˜åŒ–æ•ˆæœ</h5>









































<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¼˜åŒ–å‰</th><th>ä¼˜åŒ–å</th><th>æå‡</th></tr></thead><tbody><tr><td>åˆæˆå±‚æ•°é‡</td><td>53ä¸ª</td><td>5-8ä¸ªï¼ˆä»…å¯è§åŒºåŸŸï¼‰</td><td><strong>å‡å°‘85%</strong></td></tr><tr><td>GPUå†…å­˜å ç”¨</td><td>120MB</td><td>18MB</td><td><strong>å‡å°‘85%</strong></td></tr><tr><td>ç§»åŠ¨ç«¯å´©æºƒç‡</td><td>2.0%</td><td>0.4%ï¼ˆä½äºä¸Šçº¿å‰ï¼‰</td><td><strong>é™ä½80%</strong></td></tr><tr><td>é¦–å±åŠ è½½æ—¶é—´</td><td>3.2s</td><td>1.8s</td><td><strong>å¿«1.8å€</strong></td></tr><tr><td>ä½ç«¯è®¾å¤‡å¯ç”¨æ€§</td><td>35%</td><td>95%</td><td><strong>æå‡171%</strong></td></tr></tbody></table>
<hr/>
<h4 data-id="heading-66">4.7 Tilingï¼ˆç“¦ç‰‡åŒ–ï¼‰ï¼šåƒåŠ è½½åœ°å›¾ä¸€æ ·åŠ è½½é¡µé¢</h4>
<p><strong>é—®é¢˜åœºæ™¯ï¼š</strong> ä½ æ‰“å¼€ä¸€ä¸ªé•¿å¾®åšï¼Œé¡µé¢é«˜åº¦10000pxã€‚å¦‚æœæµè§ˆå™¨æŠŠæ•´ä¸ªé¡µé¢éƒ½æ¸²æŸ“æˆä¸€å¼ å®Œæ•´çš„å›¾ç‰‡ï¼š</p>
<ul>
<li>å†…å­˜å ç”¨ï¼š1920 Ã— 10000 Ã— 4å­—èŠ‚ = 76.8MBï¼ˆä»…ä¸€ä¸ªå›¾å±‚ï¼ï¼‰</li>
<li>æ¸²æŸ“æ—¶é—´ï¼šå¯èƒ½éœ€è¦500ms</li>
<li>è€Œä½ åªèƒ½çœ‹åˆ°å±å¹•ä¸Šçš„1080pxï¼Œå…¶ä½™90%çš„æ¸²æŸ“éƒ½æµªè´¹äº†</li>
</ul>
<p><strong>ç±»æ¯”ï¼š</strong> å°±åƒä½¿ç”¨è°·æ­Œåœ°å›¾ï¼ŒåªåŠ è½½ä½ å½“å‰çœ‹åˆ°çš„åŒºåŸŸï¼Œæ»šåŠ¨æ—¶å†åŠ è½½æ–°åŒºåŸŸã€‚</p>
<h5 data-id="heading-67">ç“¦ç‰‡åŒ–ç­–ç•¥</h5>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> å°†Layeråˆ†å‰²ä¸º256Ã—256çš„ç“¦ç‰‡ï¼ŒæŒ‰éœ€å…‰æ …åŒ–ã€‚</p>
<p><strong>ç“¦ç‰‡åˆ†ç±»ï¼š</strong></p>
<ol>
<li><strong>å¤§å‹Layerï¼ˆ1920Ã—10000pxï¼‰</strong></li>
<li><strong>åˆ‡å‰²ä¸º256Ã—256ç“¦ç‰‡</strong></li>
<li><strong>æ€»ç“¦ç‰‡æ•°ï¼šçº¦300ä¸ª</strong></li>
<li><strong>æŒ‰ä¼˜å…ˆçº§åˆ†ç±»ï¼š</strong>
<ul>
<li>å¯è§åŒºåŸŸç“¦ç‰‡ï¼ˆçº¦20ä¸ªï¼‰â†’ ä¼˜å…ˆçº§ï¼šæœ€é«˜ï¼Œç«‹å³å…‰æ …åŒ–</li>
<li>å³å°†å¯è§ç“¦ç‰‡ï¼ˆçº¦10ä¸ªï¼‰â†’ ä¼˜å…ˆçº§ï¼šé«˜ï¼Œé¢„æµ‹æ€§å…‰æ …åŒ–</li>
<li>å±å¹•å¤–ç“¦ç‰‡ï¼ˆçº¦270ä¸ªï¼‰â†’ ä¼˜å…ˆçº§ï¼šä½ï¼Œå»¶è¿Ÿå…‰æ …åŒ–</li>
</ul>
</li>
</ol>
<h5 data-id="heading-68">ç“¦ç‰‡ä¼˜å…ˆçº§</h5>

































<table><thead><tr><th>ç“¦ç‰‡ç±»å‹</th><th>æ•°é‡</th><th>ä¼˜å…ˆçº§</th><th>å¤„ç†ç­–ç•¥</th><th>å…‰æ …åŒ–æ—¶æœº</th></tr></thead><tbody><tr><td><strong>å¯è§åŒºåŸŸ</strong></td><td>~20ä¸ª</td><td>æœ€é«˜</td><td>ç«‹å³å…‰æ …åŒ–</td><td>0-16ms</td></tr><tr><td><strong>å³å°†å¯è§</strong></td><td>~10ä¸ª</td><td>é«˜</td><td>é¢„æµ‹æ€§å…‰æ …åŒ–</td><td>16-50ms</td></tr><tr><td><strong>å±å¹•å¤–</strong></td><td>~270ä¸ª</td><td>ä½</td><td>å»¶è¿Ÿå…‰æ …åŒ–</td><td>ç©ºé—²æ—¶</td></tr></tbody></table>
<h5 data-id="heading-69">åŠ¨æ€ä¼˜å…ˆçº§è°ƒæ•´</h5>
<p><strong>ç”¨æˆ·æ»šåŠ¨æ—¶çš„ä¼˜å…ˆçº§è°ƒæ•´æµç¨‹ï¼š</strong></p>
<ol>
<li>ç”¨æˆ·å¼€å§‹æ»šåŠ¨</li>
<li>è§†å£æ›´æ–°ï¼Œè®¡ç®—æ–°çš„å¯è§åŒºåŸŸ</li>
<li>ç“¦ç‰‡è°ƒåº¦å™¨é‡æ–°è®¡ç®—ä¼˜å…ˆçº§ï¼ˆè€ƒè™‘ï¼šå¯è§æ€§ã€è·ç¦»ã€æ»šåŠ¨æ–¹å‘ï¼‰</li>
<li>æå‡å³å°†å¯è§ç“¦ç‰‡çš„ä¼˜å…ˆçº§ï¼ˆä½ä¼˜å…ˆçº§ â†’ é«˜ä¼˜å…ˆçº§ï¼‰</li>
<li>å…‰æ …åŒ–Workerså¹¶è¡Œå¤„ç†é«˜ä¼˜å…ˆçº§ç“¦ç‰‡</li>
<li>ç”¨æˆ·å§‹ç»ˆçœ‹åˆ°é«˜ä¼˜å…ˆçº§ç“¦ç‰‡ï¼Œä½“éªŒæµç•…</li>
</ol>
<h5 data-id="heading-70">æ€§èƒ½ä¼˜åŒ–æ•ˆæœ</h5>





























<table><thead><tr><th>ç­–ç•¥</th><th>åˆå§‹æ¸²æŸ“</th><th>å†…å­˜å ç”¨</th><th>æ»šåŠ¨æ€§èƒ½</th></tr></thead><tbody><tr><td><strong>å…¨é¡µé¢æ¸²æŸ“</strong></td><td>500ms</td><td>76.8MB</td><td>ä¸€æ¬¡æ€§æ¶ˆè€—</td></tr><tr><td><strong>ç“¦ç‰‡åŒ–æ¸²æŸ“</strong></td><td>50ms</td><td>7.6MBï¼ˆä»…å¯è§åŒºåŸŸï¼‰</td><td>æŒ‰éœ€åŠ è½½ï¼Œæµç•…</td></tr><tr><td><strong>æ€§èƒ½æå‡</strong></td><td><strong>10å€</strong></td><td><strong>èŠ‚çœ90%</strong></td><td><strong>60fps</strong></td></tr></tbody></table>
<hr/>
<h4 data-id="heading-71">4.8 GPUå…‰æ …åŒ–ï¼šè®©æ˜¾å¡å¹²å®ƒæ“…é•¿çš„äº‹</h4>
<h5 data-id="heading-72">å†å²èƒŒæ™¯</h5>
<p>æ—©æœŸæµè§ˆå™¨ä½¿ç”¨<strong>CPUè¿›è¡Œå…‰æ …åŒ–</strong>ï¼ˆæŠŠçŸ¢é‡å›¾å½¢è½¬æˆåƒç´ ï¼‰ã€‚ä½†CPUä¸æ“…é•¿å¤§è§„æ¨¡å¹¶è¡Œè®¡ç®—ï¼Œæ¸²æŸ“å¤æ‚é¡µé¢å¾ˆæ…¢ã€‚</p>
<p><strong>æŠ€æœ¯è½¬æŠ˜ï¼š</strong> ç°ä»£æµè§ˆå™¨å‘ç°ï¼ŒGPUå¤©ç”Ÿå°±æ˜¯ä¸ºå¹¶è¡Œå›¾å½¢è®¡ç®—è®¾è®¡çš„ã€‚ä¸€å—æ˜¾å¡æœ‰æ•°åƒä¸ªè®¡ç®—æ ¸å¿ƒï¼ŒåŒæ—¶å¤„ç†æ•°åƒä¸ªåƒç´ ï¼Œæ¯”CPUå¿«å‡ åå€ã€‚</p>
<h5 data-id="heading-73">æ¨¡å¼å¯¹æ¯”</h5>
<p><strong>è½¯ä»¶å…‰æ …åŒ–ï¼ˆCPUï¼‰æµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">Display</span> List 
  â†“
Skia CPUåç«¯ 
  â†“
å¤šçº¿ç¨‹å¤„ç†ï¼ˆ<span class="hljs-number">4</span>-<span class="hljs-number">8</span>çº¿ç¨‹ï¼‰
  â†“
ç”Ÿæˆä½å›¾ 
  â†“
ä¸Šä¼ åˆ°GPUæ˜¾å­˜ï¼ˆæ‹·è´å¼€é”€ï¼‰
</code></pre>
<p><strong>GPUå…‰æ …åŒ–æµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">Display</span> List 
  â†“
Skia GPUåç«¯ 
  â†“
OpenGL/Vulkanè°ƒç”¨ 
  â†“
ç›´æ¥ç”ŸæˆGPUçº¹ç†ï¼ˆæ— éœ€ä¸Šä¼ ï¼Œé›¶æ‹·è´ï¼‰
</code></pre>
<h5 data-id="heading-74">æ€§èƒ½æ•°æ®</h5>





























<table><thead><tr><th>åœºæ™¯</th><th>è½¯ä»¶å…‰æ …åŒ–ï¼ˆCPUï¼‰</th><th>GPUå…‰æ …åŒ–</th><th>åŠ é€Ÿæ¯”</th></tr></thead><tbody><tr><td><strong>ç®€å•çŸ©å½¢</strong></td><td>2ms</td><td>3ms</td><td>CPUç•¥èƒœ</td></tr><tr><td><strong>å¤æ‚è·¯å¾„</strong></td><td>45ms</td><td>6ms</td><td><strong>7.5å€</strong></td></tr><tr><td><strong>bluræ»¤é•œ</strong></td><td>120ms</td><td>5ms</td><td><strong>24å€</strong></td></tr></tbody></table>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>âœ… å¤æ‚çš„CSSæ•ˆæœï¼ˆé˜´å½±ã€æ¸å˜ã€æ»¤é•œï¼‰</li>
<li>âœ… å¤§é‡å›¾å½¢å…ƒç´ </li>
<li>âœ… Canvas 2D/3Dç»˜åˆ¶</li>
<li>âŒ éå¸¸ç®€å•çš„é¡µé¢ï¼ˆGPUå¼€é”€å¯èƒ½æ›´å¤§ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-75">äº”ã€JavaScriptå¼•æ“ï¼ˆV8ï¼‰ï¼šä»£ç è¶Šè·‘è¶Šå¿«çš„ç§˜å¯†</h3>
<h4 data-id="heading-76">5.1 åœºæ™¯ï¼šä»£ç æ€§èƒ½æå‡100å€çš„é­”æ³•</h4>
<p><strong>ç¥å¥‡ç°è±¡ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// ç¬¬1æ¬¡è°ƒç”¨ï¼š200nsï¼ˆè§£é‡Šæ‰§è¡Œï¼‰</span>
<span class="hljs-comment">// ç¬¬10æ¬¡è°ƒç”¨ï¼š20nsï¼ˆéƒ¨åˆ†ä¼˜åŒ–ï¼‰</span>
<span class="hljs-comment">// ç¬¬100æ¬¡è°ƒç”¨ï¼š2nsï¼ˆå®Œå…¨ä¼˜åŒ–ï¼‰</span>
</code></pre>
<p><strong>ç–‘é—®ï¼š</strong> åŒæ ·çš„ä»£ç ï¼Œä¸ºä»€ä¹ˆæ€§èƒ½èƒ½æå‡100å€ï¼Ÿ</p>
<p><strong>ç­”æ¡ˆï¼š</strong> V8çš„<strong>JITï¼ˆJust-In-Timeï¼‰ç¼–è¯‘ä¼˜åŒ–æœºåˆ¶</strong>â€”â€”V8ä¼šè§‚å¯Ÿä½ çš„ä»£ç ï¼Œå‘ç°çƒ­ç‚¹åç”Ÿæˆé«˜åº¦ä¼˜åŒ–çš„æœºå™¨ç ã€‚</p>
<hr/>
<h4 data-id="heading-77">5.2 ä¸‰çº§ä¼˜åŒ–æ¶æ„ï¼šä»è§£é‡Šæ‰§è¡Œåˆ°æè‡´ä¼˜åŒ–</h4>
<p><strong>è®¾è®¡æƒè¡¡ï¼š</strong></p>
<ul>
<li>âš–ï¸ <strong>å¿«é€Ÿå¯åŠ¨ vs é«˜é€Ÿæ‰§è¡Œ</strong>
<ul>
<li>å¦‚æœä¸€å¼€å§‹å°±ç¼–è¯‘ä¼˜åŒ– â†’ å¯åŠ¨æ…¢</li>
<li>å¦‚æœåªè§£é‡Šæ‰§è¡Œ â†’ è¿è¡Œæ…¢</li>
</ul>
</li>
</ul>
<p><strong>V8çš„è§£å†³æ–¹æ¡ˆï¼šä¸‰çº§ä¼˜åŒ–æ¶æ„â€”â€”å…ˆå¿«é€Ÿå¯åŠ¨ï¼Œå†é€æ­¥ä¼˜åŒ–</strong></p>
<h5 data-id="heading-78">ä¼˜åŒ–æµç¨‹</h5>
<pre><code class="hljs language-markdown" lang="markdown">JavaScriptæºç  
  â†“
ã€Parserè§£æã€‘ç”ŸæˆASTè¯­æ³•æ ‘ 
  â†“
ã€Ignitionè§£é‡Šå™¨ã€‘å¿«é€Ÿå¯åŠ¨ï¼Œå­—èŠ‚ç æ‰§è¡Œ 
  â†“
è¿è¡Œ + ç±»å‹åé¦ˆæ”¶é›† 
  â†“
ã€çƒ­ç‚¹æ£€æµ‹ã€‘è°ƒç”¨é¢‘ç‡åˆ¤æ–­
  â”œâ”€ å¦ â†’ ç»§ç»­è§£é‡Šæ‰§è¡Œ
  â””â”€ æ˜¯ â†’ ã€TurboFanç¼–è¯‘å™¨ã€‘
<span class="hljs-code">           â†“
      ä¼˜åŒ–æœºå™¨ç ï¼ˆ10-100å€åŠ é€Ÿï¼‰
           â†“
      é«˜é€Ÿæ‰§è¡Œ
           â†“
      ç±»å‹å‡è®¾éªŒè¯
      â”œâ”€ é€šè¿‡ â†’ ç»§ç»­ä¼˜åŒ–æ‰§è¡Œ
      â””â”€ å¤±è´¥ â†’ Deoptimizationï¼ˆåä¼˜åŒ–ï¼‰
                  â†“
              å›åˆ°è§£é‡Šå™¨æ‰§è¡Œ
</span></code></pre>
<h5 data-id="heading-79">ç±»å‹åé¦ˆï¼ˆType Feedbackï¼‰æœºåˆ¶</h5>
<p><strong>V8å¦‚ä½•çŸ¥é“ä¸€ä¸ªå‡½æ•°æ˜¯"çƒ­ç‚¹"ï¼Ÿ</strong></p>
<p><strong>æ­¥éª¤1ï¼š</strong> é¦–æ¬¡æ‰§è¡Œ <code>add(1, 2)</code></p>
<ul>
<li>Ignitionè§£é‡Šå™¨æ‰§è¡Œ</li>
<li>Inline Cacheè®°å½•ç±»å‹ï¼šNumber + Number</li>
<li>æ€§èƒ½åˆ†æå™¨è®°å½•è°ƒç”¨æ¬¡æ•°ï¼š1</li>
</ul>
<p><strong>æ­¥éª¤2ï¼š</strong> ç¬¬2æ¬¡æ‰§è¡Œ <code>add(3, 4)</code></p>
<ul>
<li>éªŒè¯ç±»å‹ï¼šä»æ˜¯Number</li>
<li>è°ƒç”¨æ¬¡æ•°ï¼š2</li>
</ul>
<p><strong>æ­¥éª¤3-99ï¼š</strong> é‡å¤æ‰§è¡Œï¼Œç±»å‹ç¨³å®š</p>
<p><strong>æ­¥éª¤100ï¼š</strong> ç¬¬100æ¬¡æ‰§è¡Œï¼ˆçƒ­ç‚¹æ£€æµ‹ï¼‰</p>
<ul>
<li>è°ƒç”¨æ¬¡æ•° &gt; é˜ˆå€¼</li>
<li>ç±»å‹å‡è®¾ï¼šå‚æ•°å§‹ç»ˆæ˜¯Number</li>
<li>è§¦å‘TurboFanä¼˜åŒ–ç¼–è¯‘</li>
<li>ç”Ÿæˆä¼˜åŒ–æœºå™¨ç ï¼šç›´æ¥æ‰§è¡Œæ•´æ•°åŠ æ³•æŒ‡ä»¤</li>
<li>åç»­æ‰§è¡Œä½¿ç”¨ä¼˜åŒ–ä»£ç ï¼ˆ<strong>å¿«100å€</strong>ï¼‰</li>
</ul>
<hr/>
<h4 data-id="heading-80">5.3 TurboFanä¼˜åŒ–ç¼–è¯‘è¿‡ç¨‹</h4>
<p>TurboFanä¸æ˜¯ç®€å•çš„JITç¼–è¯‘å™¨ï¼Œå®ƒåŒ…å«å¤šä¸ªä¼˜åŒ–é˜¶æ®µï¼š</p>
<p><strong>ä¼˜åŒ–é˜¶æ®µï¼š</strong></p>
<ol>
<li><strong>æ„å»ºSSAå›¾</strong>ï¼ˆStatic Single Assignmentï¼‰</li>
<li><strong>å‡½æ•°å†…è”</strong>ï¼šæ¶ˆé™¤å‡½æ•°è°ƒç”¨å¼€é”€</li>
<li><strong>é€ƒé€¸åˆ†æ</strong>ï¼ˆEscape Analysisï¼‰
<ul>
<li>å¯¹è±¡æ˜¯å¦é€ƒé€¸åˆ°å¤–éƒ¨ï¼Ÿ</li>
<li>å¦ â†’ æ ˆåˆ†é…å¯¹è±¡ï¼ˆé¿å…GCå‹åŠ›ï¼‰</li>
<li>æ˜¯ â†’ å †åˆ†é…</li>
</ul>
</li>
<li><strong>æ— ç”¨ä»£ç æ¶ˆé™¤</strong>ï¼ˆDead Code Eliminationï¼‰</li>
<li><strong>é™çº§åˆ°æœºå™¨æŒ‡ä»¤</strong>ï¼ˆInstruction Selectionï¼‰</li>
<li><strong>å¯„å­˜å™¨åˆ†é…</strong>ï¼ˆRegister Allocationï¼‰</li>
<li><strong>ç”Ÿæˆæœºå™¨ç </strong></li>
</ol>
<h5 data-id="heading-81">é€ƒé€¸åˆ†ææ¡ˆä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœºæ™¯ï¼šå¯¹è±¡æœªé€ƒé€¸ï¼Œå¯ä»¥æ ˆåˆ†é…</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">calculate</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> point = { <span class="hljs-attr">x</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">20</span> }; <span class="hljs-comment">// å¯¹è±¡ä»…åœ¨å‡½æ•°å†…ä½¿ç”¨</span>
  <span class="hljs-keyword">return</span> point.<span class="hljs-property">x</span> + point.<span class="hljs-property">y</span>;
}

<span class="hljs-comment">// TurboFanä¼˜åŒ–ï¼š</span>
<span class="hljs-comment">// 1. æ£€æµ‹åˆ°pointå¯¹è±¡æœªé€ƒé€¸</span>
<span class="hljs-comment">// 2. ç›´æ¥åœ¨æ ˆä¸Šåˆ†é…æˆ–å®Œå…¨æ¶ˆé™¤å¯¹è±¡</span>
<span class="hljs-comment">// 3. ç­‰ä»·äºï¼šreturn 10 + 20</span>
<span class="hljs-comment">// 4. è¿›ä¸€æ­¥ä¼˜åŒ–ä¸ºï¼šreturn 30</span>
</code></pre>
<h5 data-id="heading-82">ä¼˜åŒ–æ•ˆæœ</h5>









































<table><thead><tr><th>ä¼˜åŒ–é˜¶æ®µ</th><th>ä»£ç å½¢å¼</th><th>æ‰§è¡Œè€—æ—¶</th><th>ä¼˜åŒ–æ¯”ä¾‹</th></tr></thead><tbody><tr><td>è§£é‡Šæ‰§è¡Œ</td><td>å­—èŠ‚ç </td><td>200ns</td><td>åŸºå‡†</td></tr><tr><td>åŸºç¡€ä¼˜åŒ–</td><td>æœºå™¨ç </td><td>50ns</td><td>4å€</td></tr><tr><td>å‡½æ•°å†…è”</td><td>æ¶ˆé™¤è°ƒç”¨</td><td>20ns</td><td>10å€</td></tr><tr><td>é€ƒé€¸åˆ†æ</td><td>æ ˆåˆ†é…/æ¶ˆé™¤</td><td>5ns</td><td>40å€</td></tr><tr><td>å¸¸é‡æŠ˜å </td><td>ç¼–è¯‘æ—¶è®¡ç®—</td><td>2ns</td><td><strong>100å€</strong></td></tr></tbody></table>
<hr/>
<h4 data-id="heading-83">5.4 Deoptimizationï¼ˆåä¼˜åŒ–ï¼‰ï¼šå‡è®¾è¢«æ‰“ç ´æ—¶</h4>
<p><strong>é—®é¢˜åœºæ™¯ï¼š</strong> TurboFanåŸºäºç±»å‹å‡è®¾ç”Ÿæˆä¼˜åŒ–ä»£ç ã€‚å¦‚æœå‡è®¾è¢«æ‰“ç ´ä¼šæ€æ ·ï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// å‰100æ¬¡è°ƒç”¨éƒ½æ˜¯æ•°å­—</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
  <span class="hljs-title function_">add</span>(i, i + <span class="hljs-number">1</span>); <span class="hljs-comment">// TurboFanä¼˜åŒ–ï¼šå‡è®¾å‚æ•°æ°¸è¿œæ˜¯Number</span>
}

<span class="hljs-comment">// ç¬¬101æ¬¡è°ƒç”¨ä¼ å…¥å­—ç¬¦ä¸²</span>
<span class="hljs-title function_">add</span>(<span class="hljs-string">"hello"</span>, <span class="hljs-string">" world"</span>); <span class="hljs-comment">// ç±»å‹å‡è®¾è¢«æ‰“ç ´ï¼</span>
</code></pre>
<h5 data-id="heading-84">åä¼˜åŒ–æµç¨‹</h5>
<p><strong>æ­¥éª¤1ï¼š</strong> è°ƒç”¨ <code>add("hello", " world")</code></p>
<p><strong>æ­¥éª¤2ï¼š</strong> ä¼˜åŒ–ä»£ç æ‰§è¡Œç±»å‹ä¿æŠ¤æ£€æŸ¥</p>
<ul>
<li>æœŸæœ›ï¼šNumber</li>
<li>å®é™…ï¼šString</li>
</ul>
<p><strong>æ­¥éª¤3ï¼š</strong> ç±»å‹å‡è®¾å¤±è´¥ï¼</p>
<p><strong>æ­¥éª¤4ï¼š</strong> è§¦å‘Deoptimization</p>
<ul>
<li>ä¿å­˜å½“å‰æ‰§è¡ŒçŠ¶æ€</li>
<li>é‡å»ºè§£é‡Šå™¨æ ˆå¸§</li>
<li>æ¢å¤å˜é‡å€¼</li>
</ul>
<p><strong>æ­¥éª¤5ï¼š</strong> å›é€€åˆ°Ignitionè§£é‡Šå™¨æ‰§è¡Œ</p>
<p><strong>æ­¥éª¤6ï¼š</strong> æ­£ç¡®å¤„ç†å­—ç¬¦ä¸²æ‹¼æ¥</p>
<p><strong>ç»“æœï¼š</strong> æ€§èƒ½ä¸‹é™ï¼Œä½†ä¿è¯æ­£ç¡®æ€§</p>
<h5 data-id="heading-85">åä¼˜åŒ–çš„ä»£ä»·</h5>

























<table><thead><tr><th>ä»£ä»·ç±»å‹</th><th>å½±å“</th><th>æ•°å€¼</th></tr></thead><tbody><tr><td><strong>æ ˆå¸§é‡å»º</strong></td><td>ä¸€æ¬¡æ€§å¼€é”€</td><td>10-50Î¼s</td></tr><tr><td><strong>ä¼˜åŒ–ä»£ç ä½œåºŸ</strong></td><td>ä¹‹å‰ç¼–è¯‘å·¥ä½œæµªè´¹</td><td>-</td></tr><tr><td><strong>åç»­æ‰§è¡Œæ…¢</strong></td><td>å›åˆ°è§£é‡Šå™¨</td><td>100-1000å€å˜æ…¢</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-86">5.5 é¿å…åä¼˜åŒ–çš„æœ€ä½³å®è·µ</h4>
<h5 data-id="heading-87">åæ¨¡å¼ï¼šç±»å‹ä¸ç¨³å®š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ åæ¨¡å¼ï¼šç±»å‹ä¸ç¨³å®šï¼Œé¢‘ç¹åä¼˜åŒ–</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-keyword">return</span> value * <span class="hljs-number">2</span>; <span class="hljs-comment">// valueå¯èƒ½æ˜¯Numberæˆ–String</span>
}

<span class="hljs-title function_">process</span>(<span class="hljs-number">10</span>);     <span class="hljs-comment">// Numberï¼ŒTurboFanä¼˜åŒ–ä¸ºæ•´æ•°ä¹˜æ³•</span>
<span class="hljs-title function_">process</span>(<span class="hljs-string">"5"</span>);    <span class="hljs-comment">// Stringï¼Œåä¼˜åŒ–ï¼</span>
<span class="hljs-title function_">process</span>(<span class="hljs-number">20</span>);     <span class="hljs-comment">// Numberï¼Œå¯èƒ½å†æ¬¡ä¼˜åŒ–</span>
<span class="hljs-title function_">process</span>(<span class="hljs-string">"10"</span>);   <span class="hljs-comment">// Stringï¼Œå†æ¬¡åä¼˜åŒ–ï¼</span>

<span class="hljs-comment">// ç»“æœï¼šä¼˜åŒ–-åä¼˜åŒ–å¾ªç¯ï¼Œæ€§èƒ½æå·®</span>
</code></pre>
<h5 data-id="heading-88">æœ€ä½³å®è·µï¼šç±»å‹ä¸€è‡´</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… æœ€ä½³å®è·µï¼šç±»å‹ä¸€è‡´</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processNumber</span>(<span class="hljs-params">num</span>) {
  <span class="hljs-keyword">return</span> num * <span class="hljs-number">2</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">processString</span>(<span class="hljs-params">str</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Number</span>(str) * <span class="hljs-number">2</span>;
}

<span class="hljs-comment">// è°ƒç”¨æ—¶ä¿æŒç±»å‹ä¸€è‡´</span>
<span class="hljs-title function_">processNumber</span>(<span class="hljs-number">10</span>);
<span class="hljs-title function_">processNumber</span>(<span class="hljs-number">20</span>);
<span class="hljs-title function_">processString</span>(<span class="hljs-string">"5"</span>);
<span class="hljs-title function_">processString</span>(<span class="hljs-string">"10"</span>);

<span class="hljs-comment">// ç»“æœï¼šä¸¤ä¸ªå‡½æ•°éƒ½è¢«ç¨³å®šä¼˜åŒ–ï¼Œæ€§èƒ½æœ€ä½³</span>
</code></pre>
<hr/>
<h4 data-id="heading-89">5.6 å®æˆ˜æ¡ˆä¾‹ï¼šæ•°æ®å¯è§†åŒ–æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–</h4>
<p><strong>èƒŒæ™¯ï¼š</strong></p>
<ul>
<li>æŸBIå¹³å°çš„å›¾è¡¨ç»„ä»¶</li>
<li>éœ€è¦æ¸²æŸ“åŒ…å«10,000ä¸ªæ•°æ®ç‚¹çš„æŠ˜çº¿å›¾</li>
<li>æµ‹è¯•å‘ç°æ¸²æŸ“è€—æ—¶é•¿è¾¾800msï¼Œè¿œè¶…é¢„æœŸçš„100msç›®æ ‡</li>
</ul>
<h5 data-id="heading-90">é—®é¢˜è¡¨ç°</h5>





























<table><thead><tr><th>æŒ‡æ ‡</th><th>æµ‹è¯•ç»“æœ</th><th>é¢„æœŸ</th><th>å·®è·</th></tr></thead><tbody><tr><td>æ¸²æŸ“è€—æ—¶</td><td>800ms</td><td>100ms</td><td>æ…¢8å€</td></tr><tr><td>CPUå ç”¨ç‡</td><td>90%</td><td>&lt;30%</td><td>é«˜3å€</td></tr><tr><td>ç”¨æˆ·ä½“éªŒ</td><td>æ˜æ˜¾å¡é¡¿</td><td>æµç•…</td><td>âŒ</td></tr></tbody></table>
<h5 data-id="heading-91">é—®é¢˜å®šä½</h5>
<p><strong>æ£€æŸ¥æ•°æ®æºå‘ç°é—®é¢˜ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ é—®é¢˜æ•°æ®ï¼šç±»å‹æ··æ‚</span>
<span class="hljs-keyword">const</span> data = [
  { <span class="hljs-attr">value</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-number">1699999999</span> },      <span class="hljs-comment">// Numberç±»å‹</span>
  { <span class="hljs-attr">value</span>: <span class="hljs-string">"120"</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-string">"1700000000"</span> },  <span class="hljs-comment">// Stringç±»å‹ï¼</span>
  { <span class="hljs-attr">value</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-number">1700000001</span> },      <span class="hljs-comment">// Numberç±»å‹</span>
  <span class="hljs-comment">// ...</span>
];

<span class="hljs-comment">// V8çš„å›°å¢ƒï¼š</span>
<span class="hljs-comment">// - ç¬¬1æ¬¡è°ƒç”¨ï¼šå‡è®¾valueæ˜¯Numberï¼Œç”Ÿæˆä¼˜åŒ–ä»£ç </span>
<span class="hljs-comment">// - ç¬¬2æ¬¡è°ƒç”¨ï¼šé‡åˆ°Stringï¼Œç±»å‹å‡è®¾å¤±è´¥ï¼Œè§¦å‘Deoptimization</span>
<span class="hljs-comment">// - ç¬¬3æ¬¡è°ƒç”¨ï¼šå‡è®¾valueå¯èƒ½æ˜¯Numberæˆ–Stringï¼Œç”Ÿæˆå¤šæ€ä»£ç </span>
<span class="hljs-comment">// - ç¬¬100æ¬¡è°ƒç”¨ï¼šç±»å‹å˜åŒ–å¤ªå¤šï¼Œæ”¾å¼ƒä¼˜åŒ–ï¼ˆMegamorphicï¼‰</span>
</code></pre>
<h5 data-id="heading-92">æ€§èƒ½å½±å“åˆ†æ</h5>























<table><thead><tr><th>æ‰§è¡Œæ¨¡å¼</th><th>å•æ¬¡è¿­ä»£è€—æ—¶</th><th>10,000æ¬¡æ€»è€—æ—¶</th><th>æ€§èƒ½å·®è·</th></tr></thead><tbody><tr><td>TurboFanä¼˜åŒ–ä»£ç </td><td>8ns</td><td>80ms</td><td>åŸºå‡†</td></tr><tr><td>Ignitionè§£é‡Šæ‰§è¡Œ</td><td>80ns</td><td>800ms</td><td><strong>æ…¢10å€</strong></td></tr></tbody></table>
<h5 data-id="heading-93">ä¼˜åŒ–æ–¹æ¡ˆ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… ä¼˜åŒ–1ï¼šæ•°æ®é¢„å¤„ç†ï¼Œç¡®ä¿ç±»å‹ä¸€è‡´</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">normalizeData</span>(<span class="hljs-params">rawData</span>) {
  <span class="hljs-keyword">return</span> rawData.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> ({
    <span class="hljs-attr">value</span>: <span class="hljs-title class_">Number</span>(point.<span class="hljs-property">value</span>),        <span class="hljs-comment">// å¼ºåˆ¶è½¬æ¢ä¸ºNumber</span>
    <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Number</span>(point.<span class="hljs-property">timestamp</span>)
  }));
}

<span class="hljs-comment">// âœ… ä¼˜åŒ–2ï¼šå‡½æ•°ä¿æŒå•æ€ï¼ˆMonomorphicï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">renderPoints</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-comment">// V8è§‚å¯Ÿåˆ°ï¼švalueå’Œtimestampå§‹ç»ˆæ˜¯Number</span>
  <span class="hljs-comment">// ç”Ÿæˆé’ˆå¯¹Numberç±»å‹çš„ä¼˜åŒ–æœºå™¨ç </span>
  <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> x = point.<span class="hljs-property">value</span> * scale;
    <span class="hljs-keyword">const</span> y = point.<span class="hljs-property">timestamp</span> * scale;
    <span class="hljs-keyword">return</span> { x, y };
  });
}
</code></pre>
<h5 data-id="heading-94">ä¼˜åŒ–æ•ˆæœ</h5>



































<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¼˜åŒ–å‰</th><th>ä¼˜åŒ–å</th><th>æå‡</th></tr></thead><tbody><tr><td>æ¸²æŸ“è€—æ—¶</td><td>800ms</td><td>80ms</td><td><strong>10å€</strong></td></tr><tr><td>CPUå ç”¨</td><td>90%</td><td>25%</td><td><strong>é™ä½72%</strong></td></tr><tr><td>V8ä¼˜åŒ–çŠ¶æ€</td><td>Megamorphic</td><td>Monomorphic</td><td>âœ…</td></tr><tr><td>ç”¨æˆ·ä½“éªŒ</td><td>æ˜æ˜¾å¡é¡¿</td><td>å‡ ä¹æ— æ„Ÿ</td><td>âœ…</td></tr></tbody></table>
<h5 data-id="heading-95">æ‰©å±•ä¼˜åŒ–ï¼šä½¿ç”¨TypedArray</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… è¿›ä¸€æ­¥ä¼˜åŒ–ï¼šä½¿ç”¨TypedArrayé¿å…å¯¹è±¡å¼€é”€</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">renderPointsOptimized</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> length = data.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float64Array</span>(length * <span class="hljs-number">2</span>);  <span class="hljs-comment">// [x1,y1,x2,y2,...]</span>
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) {
    result[i * <span class="hljs-number">2</span>] = data[i].<span class="hljs-property">value</span> * scale;
    result[i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>] = data[i].<span class="hljs-property">timestamp</span> * scale;
  }
  
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// æœ€ç»ˆæ•ˆæœï¼š80ms â†’ 40msï¼Œå†æå‡2å€</span>
</code></pre>
<p><strong>å…³é”®æ”¶è·ï¼š</strong></p>
<ol>
<li>ç±»å‹ä¸€è‡´æ€§æ˜¯V8ä¼˜åŒ–çš„å‰ææ¡ä»¶</li>
<li>MegamorphicçŠ¶æ€ä¼šå¯¼è‡´10-100å€çš„æ€§èƒ½æŸå¤±</li>
<li>DevToolsçš„"Not optimized"æ ‡è®°æ˜¯æ€§èƒ½ç“¶é¢ˆçš„é‡è¦ä¿¡å·</li>
<li>æ•°æ®é¢„å¤„ç†æˆæœ¬è¿œå°äºè¿è¡Œæ—¶æ€§èƒ½æŸå¤±</li>
</ol>
<hr/>
<h4 data-id="heading-96">5.7 Hidden Classæœºåˆ¶ï¼šè®©åŠ¨æ€è¯­è¨€è·‘å¾—åƒé™æ€è¯­è¨€</h4>
<p><strong>è¯­è¨€å¯¹æ¯”ï¼š</strong></p>




















<table><thead><tr><th>è¯­è¨€</th><th>å¯¹è±¡è®¿é—®æ–¹å¼</th><th>æ€§èƒ½</th></tr></thead><tbody><tr><td><strong>C++</strong></td><td>ç¼–è¯‘æ—¶ç¡®å®šå±æ€§åç§»é‡ï¼Œç›´æ¥è¯»å–</td><td>æå¿«</td></tr><tr><td><strong>JavaScript</strong></td><td>å±æ€§å¯éšæ—¶å¢åˆ ï¼Œéœ€è¦æŸ¥æ‰¾</td><td>åº”è¯¥å¾ˆæ…¢</td></tr></tbody></table>
<p><strong>é—®é¢˜ï¼š</strong> JavaScriptæ˜¯åŠ¨æ€è¯­è¨€ï¼Œå¯¹è±¡ç»“æ„éšæ—¶å¯èƒ½å˜åŒ–ï¼ŒV8æ€ä¹ˆä¼˜åŒ–å±æ€§è®¿é—®ï¼Ÿ</p>
<h5 data-id="heading-97">V8çš„èªæ˜æ–¹æ¡ˆ</h5>
<p>è™½ç„¶JavaScriptå…è®¸åŠ¨æ€ä¿®æ”¹å¯¹è±¡ï¼Œä½†<strong>å®é™…é¡¹ç›®ä¸­ï¼Œå¤§éƒ¨åˆ†å¯¹è±¡ç»“æ„æ˜¯ç¨³å®šçš„</strong>ï¼ˆæ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡ç»“æ„ä¸€è‡´ï¼‰ã€‚</p>
<p>V8ä¸ºè¿™äº›å¯¹è±¡åˆ›å»º<strong>Hidden Classï¼ˆéšè—ç±»ï¼‰</strong>ï¼Œè®°å½•å±æ€§çš„å†…å­˜å¸ƒå±€ï¼ŒåƒC++ä¸€æ ·å¿«é€Ÿè®¿é—®ã€‚</p>
<h5 data-id="heading-98">Hidden Classæ¼”è¿›è¿‡ç¨‹</h5>
<pre><code class="hljs language-markdown" lang="markdown">HiddenClass C0ï¼ˆç©ºå¯¹è±¡ï¼‰
  â””â”€ æ·»åŠ å±æ€§x
<span class="hljs-code">      â†“
HiddenClass C1
  - å±æ€§ï¼šx
  - åç§»ï¼š0
  â””â”€ æ·»åŠ å±æ€§y
      â†“
HiddenClass C2
  - å±æ€§ï¼šx, y
  - åç§»ï¼š0, 8
  â””â”€ æ·»åŠ å±æ€§z
      â†“
HiddenClass C3
  - å±æ€§ï¼šx, y, z
  - åç§»ï¼š0, 8, 16
</span></code></pre>
<h5 data-id="heading-99">å¿«é€Ÿè®¿é—®åŸç†</h5>
<p><strong>è®¿é—® <code>obj.x</code> çš„æ­¥éª¤ï¼š</strong></p>
<ol>
<li>ä»£ç æ‰§è¡Œ <code>obj.x</code></li>
<li>V8æŸ¥è¯¢Hidden Class</li>
<li>è·å–åç§»é‡ï¼š0</li>
<li>è¯»å–å†…å­˜ <code>[å¯¹è±¡åœ°å€ + 0]</code></li>
<li>è¿”å›å±æ€§å€¼</li>
</ol>
<p>âœ¨ <strong>æ— éœ€éå†å±æ€§ï¼Œç›´æ¥åç§»è®¿é—®</strong></p>
<h5 data-id="heading-100">æ€§èƒ½å¯¹æ¯”</h5>

























<table><thead><tr><th>è®¿é—®æ–¹å¼</th><th>è€—æ—¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å±æ€§éå†</strong></td><td>~100ns</td><td>ä¼ ç»Ÿæ–¹å¼</td></tr><tr><td><strong>Hidden Class</strong></td><td>~5ns</td><td>V8ä¼˜åŒ–</td></tr><tr><td><strong>æ€§èƒ½æå‡</strong></td><td><strong>20å€</strong></td><td>-</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-101">5.8 Inline Cacheï¼ˆå†…è”ç¼“å­˜ï¼‰ï¼šè®°ä½ä¸Šæ¬¡èµ°è¿‡çš„è·¯</h4>
<p><strong>ç”Ÿæ´»åœºæ™¯ï¼š</strong> ä½ æ¯å¤©ä¸Šç­éƒ½èµ°åŒä¸€æ¡è·¯ã€‚ç¬¬ä¸€æ¬¡å¯èƒ½éœ€è¦çœ‹åœ°å›¾ï¼Œç¬¬äºŒæ¬¡å°±è®°ä½äº†è·¯çº¿ï¼Œç›´æ¥èµ°ï¼Œä¸ç”¨å†æŸ¥åœ°å›¾ã€‚</p>
<p><strong>V8çš„åšæ³•ç±»ä¼¼ï¼š</strong> å‡½æ•°ç¬¬ä¸€æ¬¡è®¿é—®å¯¹è±¡å±æ€§æ—¶ï¼Œéœ€è¦æŸ¥æ‰¾Hidden Classã€‚ä½†å¦‚æœå‡½æ•°æ€»æ˜¯å¤„ç†ç›¸åŒç±»å‹çš„å¯¹è±¡ï¼ŒV8å°±"è®°ä½"è¿™æ¡å¿«æ·è·¯å¾„ï¼Œä¸‹æ¬¡ç›´æ¥ç”¨ã€‚</p>
<h5 data-id="heading-102">Inline CacheçŠ¶æ€è½¬æ¢</h5>
<pre><code class="hljs">æœªåˆå§‹åŒ–
  â†“
é¦–æ¬¡è°ƒç”¨
  â†“
ã€å•æ€ Monomorphicã€‘è§è¿‡1ç§ç±»å‹ï¼Œæ€§èƒ½æœ€ä¼˜ âœ…
  â†“
é‡åˆ°æ–°ç±»å‹ï¼Ÿ
  â”œâ”€ å¦ â†’ ä¿æŒå•æ€
  â””â”€ æ˜¯ â†“
ã€å¤šæ€ Polymorphicã€‘è§è¿‡2-4ç§ç±»å‹ï¼Œæ€§èƒ½è‰¯å¥½ âš ï¸
  â†“
ç»§ç»­æ–°ç±»å‹ï¼Ÿ
  â”œâ”€ å°‘é‡ â†’ ä¿æŒå¤šæ€
  â””â”€ å¤§é‡ â†“
ã€è¶…å¤šæ€ Megamorphicã€‘è§è¿‡&gt;4ç§ç±»å‹ï¼Œæ”¾å¼ƒä¼˜åŒ– âŒ
</code></pre>
<h5 data-id="heading-103">æ€§èƒ½å·®å¼‚</h5>





























<table><thead><tr><th>ICçŠ¶æ€</th><th>è§è¿‡çš„ç±»å‹æ•°</th><th>æ€§èƒ½</th><th>ä¼˜åŒ–ç¨‹åº¦</th></tr></thead><tbody><tr><td><strong>Monomorphic</strong></td><td>1ç§</td><td>æœ€å¿«</td><td>âœ… å®Œå…¨ä¼˜åŒ–</td></tr><tr><td><strong>Polymorphic</strong></td><td>2-4ç§</td><td>è‰¯å¥½</td><td>âš ï¸ éƒ¨åˆ†ä¼˜åŒ–</td></tr><tr><td><strong>Megamorphic</strong></td><td>&gt;4ç§</td><td>å¾ˆæ…¢</td><td>âŒ æ”¾å¼ƒä¼˜åŒ–</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-104">5.9 V8ä¼˜åŒ–æœ€ä½³å®è·µ</h4>
<h5 data-id="heading-105">æ ¸å¿ƒåŸåˆ™</h5>
<p><strong>ä¿æŒå¯¹è±¡ç»“æ„ç¨³å®šï¼Œä¿æŒç±»å‹ä¸€è‡´ã€‚</strong></p>
<h5 data-id="heading-106">å¯¹è±¡ç®¡ç†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ åæ¨¡å¼1ï¼šåŠ¨æ€æ·»åŠ å±æ€§ï¼ˆæ€§èƒ½å·®ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createProduct</span>(<span class="hljs-params">name, price</span>) {
  <span class="hljs-keyword">const</span> product = {}; <span class="hljs-comment">// ç©ºå¯¹è±¡</span>
  product.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// Hidden Classå˜åŒ–</span>
  product.<span class="hljs-property">price</span> = price; <span class="hljs-comment">// Hidden Classå†æ¬¡å˜åŒ–</span>
  <span class="hljs-keyword">if</span> (price &gt; <span class="hljs-number">100</span>) {
    product.<span class="hljs-property">discount</span> = <span class="hljs-number">0.9</span>; <span class="hljs-comment">// æœ‰äº›å¯¹è±¡æœ‰è¿™ä¸ªå±æ€§ï¼Œæœ‰äº›æ²¡æœ‰</span>
  }
  <span class="hljs-keyword">return</span> product;
}

<span class="hljs-comment">// âœ… æœ€ä½³å®è·µ1ï¼šæ„é€ å‡½æ•°åˆå§‹åŒ–æ‰€æœ‰å±æ€§</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createProduct</span>(<span class="hljs-params">name, price</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: name,
    <span class="hljs-attr">price</span>: price,
    <span class="hljs-attr">discount</span>: price &gt; <span class="hljs-number">100</span> ? <span class="hljs-number">0.9</span> : <span class="hljs-number">1.0</span> <span class="hljs-comment">// æ‰€æœ‰å¯¹è±¡ç»“æ„ä¸€è‡´</span>
  };
}
</code></pre>
<h5 data-id="heading-107">å‡½æ•°è®¾è®¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ åæ¨¡å¼2ï¼šç±»å‹ä¸ä¸€è‡´ï¼ˆæ€§èƒ½å·®ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processValue</span>(<span class="hljs-params">arr</span>) {
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item === <span class="hljs-string">'number'</span>) <span class="hljs-keyword">return</span> item * <span class="hljs-number">2</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item === <span class="hljs-string">'string'</span>) <span class="hljs-keyword">return</span> item.<span class="hljs-title function_">toUpperCase</span>();
    <span class="hljs-keyword">return</span> item; <span class="hljs-comment">// ç±»å‹æ··ä¹±ï¼Œè§¦å‘Megamorphic</span>
  });
}

<span class="hljs-comment">// âœ… æœ€ä½³å®è·µ2ï¼šä¿æŒç±»å‹ä¸€è‡´</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processNumbers</span>(<span class="hljs-params">arr</span>) {
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item * <span class="hljs-number">2</span>); <span class="hljs-comment">// ç±»å‹ç¨³å®šï¼Œä¿æŒMonomorphic</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">processStrings</span>(<span class="hljs-params">arr</span>) {
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-title function_">toUpperCase</span>()); <span class="hljs-comment">// åˆ†å¼€å¤„ç†ä¸åŒç±»å‹</span>
}
</code></pre>
<h5 data-id="heading-108">ä¼˜åŒ–æ£€æŸ¥æ¸…å•</h5>



































<table><thead><tr><th>æ£€æŸ¥é¡¹</th><th>âŒ é¿å…</th><th>âœ… æ¨è</th></tr></thead><tbody><tr><td><strong>å¯¹è±¡åˆ›å»º</strong></td><td>åŠ¨æ€æ·»åŠ å±æ€§</td><td>æ„é€ å‡½æ•°åˆå§‹åŒ–å…¨éƒ¨å±æ€§</td></tr><tr><td><strong>å¯¹è±¡ä¿®æ”¹</strong></td><td>deleteæ“ä½œ</td><td>è®¾ç½®ä¸ºnullæˆ–undefined</td></tr><tr><td><strong>å‡½æ•°å‚æ•°</strong></td><td>ç±»å‹æ··ç”¨</td><td>ä¿æŒå‚æ•°ç±»å‹ç¨³å®š</td></tr><tr><td><strong>æ•°ç»„å…ƒç´ </strong></td><td>ç±»å‹æ··æ‚</td><td>ä¿æŒå…ƒç´ ç±»å‹ä¸€è‡´</td></tr><tr><td><strong>æ•°ç»„æ“ä½œ</strong></td><td>åˆ›å»ºç©ºæ´ï¼ˆç¨€ç–æ•°ç»„ï¼‰</td><td>è¿ç»­ç´¢å¼•</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-109">å…­ã€Network Serviceè¿›ç¨‹æ¶æ„ï¼šç½‘ç»œè¯·æ±‚çš„ç»Ÿä¸€è°ƒåº¦</h3>
<h4 data-id="heading-110">6.1 Network Serviceç‹¬ç«‹è¿›ç¨‹åŒ–</h4>
<p><strong>æ¶æ„æ¼”è¿›ï¼š</strong> Chrome 78ä¹‹åï¼Œç½‘ç»œæ ˆä»Browser Processä¸­åˆ†ç¦»ä¸ºç‹¬ç«‹çš„Network Serviceè¿›ç¨‹ã€‚</p>
<h5 data-id="heading-111">ä¸ºä»€ä¹ˆè¦åˆ†ç¦»ï¼Ÿ</h5>

























<table><thead><tr><th>é—®é¢˜ç±»å‹</th><th>Browser Processä¸­çš„é—®é¢˜</th><th>ç‹¬ç«‹Network Serviceçš„ä¼˜åŠ¿</th></tr></thead><tbody><tr><td><strong>ç¨³å®šæ€§</strong></td><td>ç½‘ç»œæ ˆå´©æºƒå¯¼è‡´æµè§ˆå™¨å´©æºƒ</td><td>âœ… æ•…éšœéš”ç¦»ï¼Œç½‘ç»œå´©æºƒä¸å½±å“æµè§ˆå™¨</td></tr><tr><td><strong>å“åº”æ€§</strong></td><td>ç½‘ç»œæ ˆé˜»å¡å½±å“UIå“åº”</td><td>âœ… å¹¶è¡Œå¤„ç†ï¼Œä¸é˜»å¡ä¸»è¿›ç¨‹</td></tr><tr><td><strong>èµ„æºæ§åˆ¶</strong></td><td>æ— æ³•ç‹¬ç«‹èµ„æºé™åˆ¶</td><td>âœ… ç‹¬ç«‹çš„å†…å­˜/CPUé…é¢</td></tr></tbody></table>
<h5 data-id="heading-112">è¿›ç¨‹æ¶æ„ç»„æˆ</h5>
<p><strong>Browser Processï¼ˆæµè§ˆå™¨ä¸»è¿›ç¨‹ï¼‰</strong></p>
<ul>
<li>åè°ƒç½‘ç»œè¯·æ±‚</li>
<li>ç®¡ç†è¿›ç¨‹é—´é€šä¿¡</li>
</ul>
<p><strong>Network Service Processï¼ˆç½‘ç»œæœåŠ¡è¿›ç¨‹ï¼‰</strong></p>
<ul>
<li><strong>URLLoader</strong>ï¼šè¯·æ±‚ç®¡ç†å™¨</li>
<li><strong>Disk Cache</strong>ï¼šç£ç›˜ç¼“å­˜</li>
<li><strong>Connection Pool</strong>ï¼šè¿æ¥æ± ï¼ˆHTTP/2å¤šè·¯å¤ç”¨ã€TCPè¿æ¥å¤ç”¨ï¼‰</li>
<li><strong>DNS Resolver</strong>ï¼šDNSè§£æå™¨</li>
<li><strong>ä¼˜å…ˆçº§è°ƒåº¦å™¨</strong>ï¼š
<ul>
<li>ğŸ”´ Critical - HTMLä¸»æ–‡æ¡£ã€å…³é”®CSS</li>
<li>ğŸŸ  High - å¯è§å›¾ç‰‡ã€åŒæ­¥JS</li>
<li>ğŸŸ¡ Medium - å­—ä½“ã€å¼‚æ­¥JS</li>
<li>ğŸŸ¢ Low - prefetchèµ„æº</li>
<li>âšª Lowest - loading="lazy"å›¾ç‰‡</li>
</ul>
</li>
</ul>
<p><strong>Renderer Process 1, 2, 3...ï¼ˆæ¸²æŸ“è¿›ç¨‹ï¼‰</strong></p>
<ul>
<li>é€šè¿‡IPCä¸Network Serviceé€šä¿¡</li>
</ul>
<hr/>
<h4 data-id="heading-113">6.2 èµ„æºä¼˜å…ˆçº§è°ƒåº¦</h4>
<h5 data-id="heading-114">Chromiumèµ„æºä¼˜å…ˆçº§ç³»ç»Ÿ</h5>















































<table><thead><tr><th>ä¼˜å…ˆçº§</th><th>èµ„æºç±»å‹</th><th>ç¤ºä¾‹</th><th>ç½‘ç»œæƒé‡</th><th>åŠ è½½æ—¶æœº</th></tr></thead><tbody><tr><td><strong>Critical</strong></td><td>HTMLä¸»æ–‡æ¡£ã€å…³é”®CSS</td><td>index.html, critical.css</td><td>æœ€é«˜</td><td>ç«‹å³</td></tr><tr><td><strong>High</strong></td><td>å¯è§å›¾ç‰‡ã€è„šæœ¬</td><td>é¦–å±å›¾ç‰‡ã€åŒæ­¥JS</td><td>é«˜</td><td>ä¼˜å…ˆ</td></tr><tr><td><strong>Medium</strong></td><td>å­—ä½“ã€å¼‚æ­¥è„šæœ¬</td><td>font.woff2, async JS</td><td>ä¸­</td><td>æ­£å¸¸</td></tr><tr><td><strong>Low</strong></td><td>é¢„åŠ è½½èµ„æº</td><td>prefetchèµ„æº</td><td>ä½</td><td>å»¶å</td></tr><tr><td><strong>Lowest</strong></td><td>å»¶è¿ŸåŠ è½½å›¾ç‰‡</td><td>loading="lazy"å›¾ç‰‡</td><td>æœ€ä½</td><td>ç©ºé—²æ—¶</td></tr></tbody></table>
<h5 data-id="heading-115">åŠ¨æ€ä¼˜å…ˆçº§è°ƒæ•´ç¤ºä¾‹</h5>
<p><strong>åœºæ™¯ï¼šå›¾ç‰‡ä»å±å¹•å¤–æ»šåŠ¨åˆ°å³å°†å¯è§</strong></p>
<ol>
<li>
<p>HTML Parserå‘ç°<code>&lt;img&gt;</code>æ ‡ç­¾</p>
<ul>
<li>åˆ¤æ–­ï¼šå›¾ç‰‡ä½ç½®åœ¨å±å¹•å¤–</li>
<li>å†³ç­–ï¼šè®¾ç½®ä¼˜å…ˆçº§ = Low ğŸ”µ</li>
</ul>
</li>
<li>
<p>èµ„æºè°ƒåº¦å™¨å‘èµ·è¯·æ±‚</p>
<ul>
<li>ä¼˜å…ˆçº§ï¼šLow</li>
<li>å¸¦å®½åˆ†é…ï¼š10%</li>
<li>ä¸‹è½½é€Ÿåº¦ï¼šè¾ƒæ…¢</li>
</ul>
</li>
<li>
<p>ç”¨æˆ·æ»šåŠ¨ï¼Œå›¾ç‰‡å³å°†è¿›å…¥è§†å£</p>
<ul>
<li>IntersectionObserverè§¦å‘</li>
<li>æ£€æµ‹ï¼šè·ç¦»è§†å£ &lt; 100px</li>
<li>å†³ç­–ï¼šæå‡ä¼˜å…ˆçº§ Low ğŸ”µ â†’ High ğŸ”´</li>
</ul>
</li>
<li>
<p>èµ„æºè°ƒåº¦å™¨é‡æ–°è°ƒåº¦</p>
<ul>
<li>ä¸­æ–­ä½ä¼˜å…ˆçº§è¯·æ±‚</li>
<li>ä¼˜å…ˆå¤„ç†é«˜ä¼˜å…ˆçº§è¯·æ±‚</li>
<li>å¸¦å®½åˆ†é…ï¼š80%</li>
<li>ä¸‹è½½é€Ÿåº¦ï¼šå¿«é€Ÿ</li>
</ul>
</li>
<li>
<p>å›¾ç‰‡å¿«é€ŸåŠ è½½å®Œæˆ</p>
<ul>
<li>ç”¨æˆ·æ»šåŠ¨åˆ°å›¾ç‰‡ä½ç½®æ—¶å·²ç»åŠ è½½å®Œæˆ</li>
<li>ç”¨æˆ·ä½“éªŒæµç•…ï¼Œæ— ç™½å— ğŸ‰</li>
</ul>
</li>
</ol>
<hr/>
<h4 data-id="heading-116">6.3 Resource Hintså®ç°</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- DNSé¢„è§£æï¼ˆèŠ‚çœDNSæŸ¥è¯¢æ—¶é—´ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"dns-prefetch"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.example.com"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- é¢„è¿æ¥ï¼ˆDNS + TCP + TLSï¼ŒèŠ‚çœè¿æ¥æ—¶é—´ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://api.example.com"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- é¢„åŠ è½½ï¼ˆé«˜ä¼˜å…ˆçº§ï¼Œç«‹å³åŠ è½½å…³é”®èµ„æºï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/critical.css"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"style"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- é¢„è·å–ï¼ˆä½ä¼˜å…ˆçº§ï¼Œç©ºé—²æ—¶åŠ è½½ä¸‹ä¸€é¡µèµ„æºï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"prefetch"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/next-page.js"</span>&gt;</span>
</code></pre>
<h5 data-id="heading-117">Resource Hintsæ•ˆæœ</h5>



































<table><thead><tr><th>Hintç±»å‹</th><th>èŠ‚çœæ—¶é—´</th><th>é€‚ç”¨åœºæ™¯</th><th>æœ€ä½³å®è·µ</th></tr></thead><tbody><tr><td><strong>dns-prefetch</strong></td><td>~20-120ms</td><td>ç¬¬ä¸‰æ–¹åŸŸå</td><td>é¢„è§£æCDNåŸŸå</td></tr><tr><td><strong>preconnect</strong></td><td>~100-500ms</td><td>å…³é”®API</td><td>æå‰å»ºç«‹è¿æ¥</td></tr><tr><td><strong>preload</strong></td><td>æå‰åŠ è½½</td><td>å…³é”®èµ„æº</td><td>é¦–å±å¿…éœ€èµ„æº</td></tr><tr><td><strong>prefetch</strong></td><td>æå‰ç¼“å­˜</td><td>ä¸‹ä¸€é¡µèµ„æº</td><td>é¢„æµ‹ç”¨æˆ·è¡Œä¸º</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-118">6.4 èµ„æºåŠ è½½æ—¶é—´çº¿å¯¹æ¯”</h4>
<h5 data-id="heading-119">æ— ä¼˜å…ˆçº§ç­–ç•¥ï¼ˆæ€»è€—æ—¶800msï¼‰</h5>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">0-200ms:   HTMLä¸‹è½½</span>
<span class="hljs-section">200-500ms: CSSä¸‹è½½ï¼ˆé˜»å¡æ¸²æŸ“ï¼‰</span>
<span class="hljs-section">200-800ms: å›¾ç‰‡å¹¶è¡Œä¸‹è½½ï¼ˆå ç”¨å¸¦å®½ï¼‰</span>
<span class="hljs-section">200-700ms: JSå¹¶è¡Œä¸‹è½½ï¼ˆå ç”¨å¸¦å®½ï¼‰</span>

âŒ é—®é¢˜ï¼šæ‰€æœ‰èµ„æºå¹³ç­‰ç«äº‰å¸¦å®½ï¼Œå…³é”®CSSè¢«å»¶è¿Ÿ
</code></pre>
<h5 data-id="heading-120">æœ‰ä¼˜å…ˆçº§ç­–ç•¥ï¼ˆæ€»è€—æ—¶550msï¼‰</h5>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">0-200ms:   HTMLä¸‹è½½</span>
<span class="hljs-section">200-350ms: CSSé«˜ä¼˜å…ˆçº§ä¸‹è½½ï¼ˆä¼˜å…ˆå¸¦å®½ï¼‰âœ…</span>
<span class="hljs-section">350-550ms: JSä¸­ä¼˜å…ˆçº§ä¸‹è½½</span>
<span class="hljs-section">550-800ms: å›¾ç‰‡ä½ä¼˜å…ˆçº§ä¸‹è½½</span>

âœ… ä¼˜åŠ¿ï¼šå…³é”®èµ„æºä¼˜å…ˆå®Œæˆï¼Œé¦–å±æ¸²æŸ“æå‰250ms
</code></pre>
<h5 data-id="heading-121">æ€§èƒ½æå‡</h5>





























<table><thead><tr><th>æŒ‡æ ‡</th><th>æ— ä¼˜å…ˆçº§</th><th>æœ‰ä¼˜å…ˆçº§</th><th>æå‡</th></tr></thead><tbody><tr><td>é¦–å±æ¸²æŸ“æ—¶é—´</td><td>800ms</td><td>550ms</td><td><strong>å¿«45%</strong></td></tr><tr><td>å…³é”®èµ„æºå®Œæˆ</td><td>500ms</td><td>350ms</td><td><strong>å¿«30%</strong></td></tr><tr><td>ç”¨æˆ·ä½“éªŒ</td><td>ç™½å±æ—¶é—´é•¿</td><td>å†…å®¹å¿«é€Ÿå‘ˆç°</td><td>âœ…</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-122">æ€»ç»“ï¼šæµè§ˆå™¨ä¼˜åŒ–çš„æ ¸å¿ƒåŸåˆ™</h3>
<h4 data-id="heading-123">æ¶æ„å±‚é¢</h4>

























<table><thead><tr><th>åŸåˆ™</th><th>æŠ€æœ¯å®ç°</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td><strong>è¿›ç¨‹éš”ç¦»</strong></td><td>å¤šè¿›ç¨‹æ¶æ„ã€Site Isolation</td><td>ç¨³å®šæ€§ã€å®‰å…¨æ€§</td></tr><tr><td><strong>å¹¶è¡Œå¤„ç†</strong></td><td>å¤šçº¿ç¨‹æ¸²æŸ“ã€GPUåˆæˆ</td><td>æ€§èƒ½ã€å“åº”æ€§</td></tr><tr><td><strong>æŒ‰éœ€åŠ è½½</strong></td><td>ç“¦ç‰‡åŒ–ã€ä¼˜å…ˆçº§è°ƒåº¦</td><td>å†…å­˜ä¼˜åŒ–ã€é¦–å±é€Ÿåº¦</td></tr></tbody></table>
<h4 data-id="heading-124">ä»£ç å±‚é¢</h4>






























<table><thead><tr><th>åŸåˆ™</th><th>å®è·µæ–¹æ³•</th><th>é¿å…é™·é˜±</th></tr></thead><tbody><tr><td><strong>ç±»å‹ç¨³å®š</strong></td><td>ç»Ÿä¸€æ•°æ®ç±»å‹ã€æ„é€ å‡½æ•°åˆå§‹åŒ–</td><td>é¿å…ç±»å‹æ··ç”¨ã€åŠ¨æ€æ·»åŠ å±æ€§</td></tr><tr><td><strong>æ‰¹é‡æ“ä½œ</strong></td><td>è¯»å†™åˆ†ç¦»ã€requestAnimationFrame</td><td>é¿å…Layout Thrashing</td></tr><tr><td><strong>åˆç†åˆ†å±‚</strong></td><td>æŒ‰éœ€will-changeã€åŠ¨ç”»ç»“æŸé‡Šæ”¾</td><td>é¿å…è¿‡åº¦åˆæˆå±‚</td></tr><tr><td><strong>ä¼˜å…ˆçº§ç®¡ç†</strong></td><td>Resource Hintsã€æ‡’åŠ è½½</td><td>é¿å…èµ„æºç«äº‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-125">å†™åœ¨æœ€å</h3>
<p>ç°ä»£æµè§ˆå™¨æ˜¯ä¸€ä¸ªå¤æ‚çš„ç³»ç»Ÿå·¥ç¨‹ï¼Œæ¶‰åŠæ¶æ„è®¾è®¡ã€å¹¶å‘æ§åˆ¶ã€å›¾å½¢æ¸²æŸ“ã€ç¼–è¯‘ä¼˜åŒ–ç­‰å¤šä¸ªé¢†åŸŸã€‚ç†è§£æµè§ˆå™¨çš„å·¥ä½œåŸç†ï¼Œä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´é«˜æ€§èƒ½çš„ä»£ç ï¼Œè¿˜èƒ½è®©æˆ‘ä»¬åœ¨é‡åˆ°æ€§èƒ½é—®é¢˜æ—¶å¿«é€Ÿå®šä½åŸå› ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£æµè§ˆå™¨çš„æ ¸å¿ƒæœºåˆ¶ã€‚å¦‚æœä½ è§‰å¾—æœ‰æ”¶è·ï¼Œæ¬¢è¿åˆ†äº«ç»™æ›´å¤šçš„å¼€å‘è€…ï¼</p>
<hr/>
<p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.chromium.org%2Fdevelopers%2Fdesign-documents%2F" target="_blank" title="https://www.chromium.org/developers/design-documents/" ref="nofollow noopener noreferrer">Chromium Design Docs</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.chromium.org%2FHome%2Fchromium-security%2Fsite-isolation%2F" target="_blank" title="https://www.chromium.org/Home/chromium-security/site-isolation/" ref="nofollow noopener noreferrer">Chromium Site Isolation</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fchromium.googlesource.com%2Fchromium%2Fsrc%2F%2B%2Fmaster%2Fmojo%2Fpublic%2Fcpp%2Fbindings%2FREADME.md" target="_blank" title="https://chromium.googlesource.com/chromium/src/+/master/mojo/public/cpp/bindings/README.md" ref="nofollow noopener noreferrer">Mojo Documentation</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fv8.dev%2Fblog" target="_blank" title="https://v8.dev/blog" ref="nofollow noopener noreferrer">V8 Blog</a></li>
</ul>
<blockquote>
<p>è½¬è½¬ç ”å‘ä¸­å¿ƒåŠä¸šç•Œå°ä¼™ä¼´ä»¬çš„æŠ€æœ¯å­¦ä¹ äº¤æµå¹³å°ï¼Œå®šæœŸåˆ†äº«ä¸€çº¿çš„å®æˆ˜ç»éªŒåŠä¸šç•Œå‰æ²¿çš„æŠ€æœ¯è¯é¢˜ã€‚
å…³æ³¨å…¬ä¼—å·ã€Œè½¬è½¬æŠ€æœ¯ã€ï¼ˆç»¼åˆæ€§ï¼‰ã€ã€Œå¤§è½¬è½¬FEã€ï¼ˆä¸“æ³¨äºFEï¼‰ã€ã€Œè½¬è½¬QAã€ï¼ˆä¸“æ³¨äºQAï¼‰ï¼Œæ›´å¤šå¹²è´§å®è·µï¼Œæ¬¢è¿äº¤æµåˆ†äº«~`</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Mybatis Plus ä¸»é”®ç”Ÿæˆå™¨å®ç°æ€è·¯åˆ†æ]]></title>    <link>https://juejin.cn/post/7584730804515291179</link>    <guid>https://juejin.cn/post/7584730804515291179</guid>    <pubDate>2025-12-18T04:07:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584730804515291179" data-draft-id="7584730804515258411" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Mybatis Plus ä¸»é”®ç”Ÿæˆå™¨å®ç°æ€è·¯åˆ†æ"/> <meta itemprop="keywords" content="MyBatis,Spring Boot,æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-12-18T04:07:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jaising666"/> <meta itemprop="url" content="https://juejin.cn/user/2418581311850301"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Mybatis Plus ä¸»é”®ç”Ÿæˆå™¨å®ç°æ€è·¯åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2418581311850301/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jaising666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:07:05.000Z" title="Thu Dec 18 2025 04:07:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šä¸€ç¯‡æˆ‘ä»¬çœ‹åˆ°äº† <a href="https://juejin.cn/post/7510053996137611300" target="_blank" title="https://juejin.cn/post/7510053996137611300">Mybatis æ‹¦æˆªå™¨åœ¨å¤šç§Ÿæˆ·åœºæ™¯ä¸‹çš„ä½¿ç”¨</a>ï¼Œè¿™æ¬¡ç»§ç»­çœ‹ä¸‹åœ¨ä¸»é”®ç”Ÿæˆåœºæ™¯ä¸‹çš„åº”ç”¨ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯ä¸é—®é¢˜</h2>
<p>åœ¨ä½¿ç”¨ MyBatis-Plus å¼€å‘æ—¶ï¼Œé€šå¸¸ä½¿ç”¨ <code>@TableId(type = IdType.AUTO)</code> æ³¨è§£æ¥å®ç°ä¸»é”®è‡ªåŠ¨ç”Ÿæˆã€‚è¿™ç§æ–¹å¼ä¾èµ–æ•°æ®åº“çš„è‡ªå¢ç‰¹æ€§ï¼Œåœ¨ MySQL ç­‰ä¸»æµæ•°æ®åº“ä¸Šè¿è¡Œè‰¯å¥½ã€‚</p>
<p>ç„¶è€Œï¼Œå½“é¡¹ç›®è¿ç§»åˆ° OpenGauss æ•°æ®åº“æ—¶ï¼Œé‡åˆ°äº†å…¼å®¹æ€§é—®é¢˜ï¼š</p>
<ul>
<li><strong>é—®é¢˜ç°è±¡</strong>ï¼šINSERT æ“ä½œæ—¶ ID å­—æ®µä¸º NULLï¼Œå¯¼è‡´æ’å…¥å¤±è´¥</li>
<li><strong>æ ¹æœ¬åŸå› </strong>ï¼šOpenGauss ä½¿ç”¨ PostgreSQL çš„åºåˆ—ï¼ˆSequenceï¼‰æœºåˆ¶ï¼Œè€Œéè‡ªå¢å­—æ®µ</li>
<li><strong>æŠ€æœ¯é™åˆ¶</strong>ï¼šOpenGauss é©±åŠ¨å¯¹ MyBatis-Plus çš„ <code>IdType.AUTO</code> æ”¯æŒä¸å®Œå–„</li>
</ul>
<h3 data-id="heading-1">æ•°æ®åº“ä¸»é”®ç”Ÿæˆæœºåˆ¶å¯¹æ¯”</h3>
<h4 data-id="heading-2">MySQL è‡ªå¢ä¸»é”® (AUTO_INCREMENT)</h4>
<p>MySQL ä½¿ç”¨ <code>AUTO_INCREMENT</code> å±æ€§å®ç°ä¸»é”®è‡ªåŠ¨ç”Ÿæˆï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- MySQL è¡¨ç»“æ„</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">user</span> (
    id <span class="hljs-type">BIGINT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>)
);

<span class="hljs-comment">-- æ’å…¥æ—¶æ— éœ€æŒ‡å®šID</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">user</span> (name) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'å¼ ä¸‰'</span>);
<span class="hljs-comment">-- MySQL è‡ªåŠ¨ç”Ÿæˆ id = 1</span>
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>åœ¨è¡¨ç»“æ„ä¸­å®šä¹‰è‡ªå¢å±æ€§</li>
<li>INSERT æ—¶å¯ä»¥çœç•¥ä¸»é”®å­—æ®µ</li>
<li>æ•°æ®åº“å¼•æ“è‡ªåŠ¨åˆ†é…é€’å¢çš„IDå€¼</li>
<li>MyBatis-Plus çš„ <code>IdType.AUTO</code> ç›´æ¥æ”¯æŒ</li>
</ul>
<h4 data-id="heading-3">PostgreSQL/OpenGauss åºåˆ—æœºåˆ¶ (SEQUENCE)</h4>
<p>PostgreSQL ç³»åˆ—æ•°æ®åº“ä½¿ç”¨åºåˆ—å¯¹è±¡ç”Ÿæˆä¸»é”®ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºåºåˆ—</span>
<span class="hljs-keyword">CREATE</span> SEQUENCE user_id_seq <span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> <span class="hljs-number">1</span> INCREMENT <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>;

<span class="hljs-comment">-- åˆ›å»ºè¡¨ï¼ˆä¸ä½¿ç”¨AUTO_INCREMENTï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">user</span> (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">DEFAULT</span> nextval(<span class="hljs-string">'user_id_seq'</span>) <span class="hljs-keyword">PRIMARY</span> KEY,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>)
);

<span class="hljs-comment">-- æ’å…¥æ–¹å¼1ï¼šä½¿ç”¨é»˜è®¤å€¼</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">user</span> (name) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'å¼ ä¸‰'</span>);

<span class="hljs-comment">-- æ’å…¥æ–¹å¼2ï¼šæ˜¾å¼è°ƒç”¨åºåˆ—</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">user</span> (id, name) <span class="hljs-keyword">VALUES</span> (nextval(<span class="hljs-string">'user_id_seq'</span>), <span class="hljs-string">'æå››'</span>);
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>åºåˆ—æ˜¯ç‹¬ç«‹çš„æ•°æ®åº“å¯¹è±¡ï¼Œä¸è¡¨åˆ†ç¦»</li>
<li>éœ€è¦æ˜¾å¼è°ƒç”¨ <code>nextval()</code> å‡½æ•°è·å–ä¸‹ä¸€ä¸ªå€¼</li>
<li>æ”¯æŒæ›´çµæ´»çš„é…ç½®ï¼ˆèµ·å§‹å€¼ã€æ­¥é•¿ã€ç¼“å­˜ç­‰ï¼‰</li>
<li>å¯ä»¥è¢«å¤šä¸ªè¡¨å…±äº«</li>
</ul>
<h4 data-id="heading-4">MyBatis-Plus å…¼å®¹æ€§é—®é¢˜</h4>
<p>MyBatis-Plus çš„ <code>IdType.AUTO</code> è®¾è®¡ä¸»è¦é’ˆå¯¹ MySQL çš„è‡ªå¢æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// MyBatis-Plus æœŸæœ›çš„è¡Œä¸º</span>
<span class="hljs-meta">@TableId(type = IdType.AUTO)</span>
<span class="hljs-keyword">private</span> Long id;

<span class="hljs-comment">// ç”Ÿæˆçš„ INSERT SQLï¼ˆMySQLï¼‰</span>
INSERT INTO <span class="hljs-title function_">user</span> <span class="hljs-params">(name)</span> VALUES (?)
<span class="hljs-comment">// MySQL è‡ªåŠ¨å¡«å…… id å­—æ®µ</span>

<span class="hljs-comment">// åœ¨ PostgreSQL/OpenGauss ä¸­çš„é—®é¢˜</span>
INSERT INTO <span class="hljs-title function_">user</span> <span class="hljs-params">(name)</span> VALUES (?)
<span class="hljs-comment">// æ²¡æœ‰è°ƒç”¨ nextval()ï¼Œid å­—æ®µä¸º NULLï¼Œè¿åä¸»é”®çº¦æŸ</span>
</code></pre>
<p><strong>å¤±æ•ˆåŸå› ï¼š</strong></p>
<ol>
<li><strong>SQL ç”Ÿæˆå·®å¼‚</strong>ï¼šMyBatis-Plus ç”Ÿæˆçš„ INSERT è¯­å¥ä¸åŒ…å«åºåˆ—è°ƒç”¨</li>
<li><strong>é©±åŠ¨æ”¯æŒä¸è¶³</strong>ï¼šOpenGauss é©±åŠ¨æ— æ³•è‡ªåŠ¨è¯†åˆ«å¹¶è°ƒç”¨å¯¹åº”çš„åºåˆ—</li>
<li><strong>æ¡†æ¶å‡è®¾</strong>ï¼šMyBatis-Plus å‡è®¾æ•°æ®åº“ä¼šè‡ªåŠ¨å¤„ç†ä¸»é”®ç”Ÿæˆï¼Œä½† PostgreSQL éœ€è¦æ˜¾å¼æ“ä½œ</li>
</ol>
<p>ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé¡¹ç›®é‡‡ç”¨äº†è‡ªå®šä¹‰ MyBatis æ‹¦æˆªå™¨çš„æ–¹æ¡ˆï¼Œåœ¨ INSERT æ“ä½œå‰è‡ªåŠ¨ä»æ•°æ®åº“åºåˆ—è·å– ID å€¼ã€‚</p>
<h2 data-id="heading-5">äºŒã€MyBatis æ‹¦æˆªå™¨æœºåˆ¶</h2>
<h3 data-id="heading-6">æ‹¦æˆªå™¨å·¥ä½œåŸç†</h3>
<p>MyBatis æä¾›äº†æ’ä»¶ï¼ˆPluginï¼‰æœºåˆ¶ï¼Œå…è®¸åœ¨ SQL æ‰§è¡Œçš„å…³é”®èŠ‚ç‚¹è¿›è¡Œæ‹¦æˆªå’Œå¢å¼ºã€‚æ‹¦æˆªå™¨åŸºäº JDK åŠ¨æ€ä»£ç†å®ç°ï¼Œå¯ä»¥æ‹¦æˆªä»¥ä¸‹å››ç§å¯¹è±¡çš„æ–¹æ³•ï¼š</p>






























<table><thead><tr><th>æ‹¦æˆªå¯¹è±¡</th><th>ä½œç”¨</th><th>å¸¸è§æ‹¦æˆªæ–¹æ³•</th></tr></thead><tbody><tr><td>Executor</td><td>SQL æ‰§è¡Œå™¨</td><td>update, query, commit, rollback</td></tr><tr><td>StatementHandler</td><td>SQL è¯­å¥å¤„ç†å™¨</td><td>prepare, parameterize, batch, update, query</td></tr><tr><td>ParameterHandler</td><td>å‚æ•°å¤„ç†å™¨</td><td>getParameterObject, setParameters</td></tr><tr><td>ResultSetHandler</td><td>ç»“æœé›†å¤„ç†å™¨</td><td>handleResultSets, handleOutputParameters</td></tr></tbody></table>
<h3 data-id="heading-7">æ‹¦æˆªå™¨æ‰§è¡Œæµç¨‹</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant App as Application
    participant MyBatis
    participant Interceptor
    participant Executor
    participant DB as Database
    
    App-&gt;&gt;MyBatis: Execute Mapper method
    MyBatis-&gt;&gt;Interceptor: Call intercept()
    Interceptor-&gt;&gt;Interceptor: Pre-processing
    Interceptor-&gt;&gt;Executor: invocation.proceed()
    Executor-&gt;&gt;DB: Execute SQL
    DB--&gt;&gt;Executor: Return result
    Executor--&gt;&gt;Interceptor: Return result
    Interceptor-&gt;&gt;Interceptor: Post-processing
    Interceptor--&gt;&gt;MyBatis: Return final result
    MyBatis--&gt;&gt;App: Return result
</code></pre>
<h3 data-id="heading-8">æ‹¦æˆªå™¨æ¥å£å®šä¹‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Interceptor</span> {
    <span class="hljs-comment">// æ‹¦æˆªç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œ</span>
    Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Invocation invocation)</span> <span class="hljs-keyword">throws</span> Throwable;
    
    <span class="hljs-comment">// ä¸ºç›®æ ‡å¯¹è±¡åˆ›å»ºä»£ç†</span>
    Object <span class="hljs-title function_">plugin</span><span class="hljs-params">(Object target)</span>;
    
    <span class="hljs-comment">// è®¾ç½®æ‹¦æˆªå™¨å±æ€§</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setProperties</span><span class="hljs-params">(Properties properties)</span>;
}
</code></pre>
<h2 data-id="heading-9">ä¸‰ã€ID ä¸»é”®ç”Ÿæˆæ‹¦æˆªå™¨å®ç°</h2>
<h3 data-id="heading-10">æ•´ä½“æ¶æ„</h3>
<p>é¡¹ç›®ä¸­çš„ ID ä¸»é”®ç”Ÿæˆæ–¹æ¡ˆç”±ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶æ„æˆï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[INSERT Operation] --&gt; B[AutoIdGeneratorInterceptor]
    B --&gt; C{Check @TableId}
    C --&gt;|type=AUTO| D{ID is null?}
    C --&gt;|Other types| E[Skip processing]
    D --&gt;|Yes| F[PostgresSequenceGenerator]
    D --&gt;|No| E
    F --&gt; G[Get table name]
    G --&gt; H[Build sequence name]
    H --&gt; I[Execute SELECT nextval]
    I --&gt; J[Set ID field value]
    J --&gt; K[Continue INSERT]
    E --&gt; K
</code></pre>
<h3 data-id="heading-11">ç»„ä»¶ 1ï¼šAutoIdGeneratorInterceptor</h3>
<p><strong>æ ¸å¿ƒèŒè´£ï¼š</strong></p>
<ul>
<li>æ‹¦æˆªæ‰€æœ‰ INSERT æ“ä½œ</li>
<li>æ£€æŸ¥å®ä½“ç±»çš„ <code>@TableId</code> æ³¨è§£é…ç½®</li>
<li>ä¸º <code>IdType.AUTO</code> ç±»å‹ä¸”å€¼ä¸º null çš„å­—æ®µç”Ÿæˆ ID</li>
</ul>
<p><strong>æ ¸å¿ƒå®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Intercepts({
    @Signature(type = Executor.class, method = "update", args = {MappedStatement.class, Object.class})
})</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AutoIdGeneratorInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Interceptor</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Invocation invocation)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">MappedStatement</span> <span class="hljs-variable">ms</span> <span class="hljs-operator">=</span> (MappedStatement) invocation.getArgs()[<span class="hljs-number">0</span>];
        <span class="hljs-type">Object</span> <span class="hljs-variable">parameter</span> <span class="hljs-operator">=</span> invocation.getArgs()[<span class="hljs-number">1</span>];
        
        <span class="hljs-comment">// åªå¤„ç†INSERTæ“ä½œ</span>
        <span class="hljs-keyword">if</span> (SqlCommandType.INSERT.equals(ms.getSqlCommandType())) {
            <span class="hljs-comment">// åå°„æ£€æŸ¥@TableId(type=AUTO)å­—æ®µï¼Œå¦‚æœä¸ºnullè°ƒç”¨PostgresSequenceGeneratorçš„nextIdç”ŸæˆID</span>
            processEntity(parameter);
        }
        
        <span class="hljs-keyword">return</span> invocation.proceed();
    }
}
</code></pre>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹ï¼š</strong></p>
<ol>
<li><strong>æ‹¦æˆª Executor.update æ–¹æ³•</strong>ï¼šINSERT/UPDATE/DELETE éƒ½ä¼šè°ƒç”¨æ­¤æ–¹æ³•ï¼Œé€šè¿‡ <code>SqlCommandType</code> åŒºåˆ†æ“ä½œç±»å‹</li>
<li><strong>åå°„è®¿é—®å­—æ®µ</strong>ï¼šä½¿ç”¨ <code>field.setAccessible(true)</code> è®¿é—®ç§æœ‰å­—æ®µ</li>
<li><strong>æ³¨è§£æ£€æŸ¥</strong>ï¼šåªå¤„ç† <code>@TableId(type = IdType.AUTO)</code> æ ‡æ³¨çš„å­—æ®µ</li>
<li><strong>ç©ºå€¼åˆ¤æ–­</strong>ï¼šä»…åœ¨ ID ä¸º null æ—¶ç”Ÿæˆï¼Œé¿å…è¦†ç›–å·²æœ‰å€¼</li>
</ol>
<h3 data-id="heading-12">ç»„ä»¶ 2ï¼šPostgresSequenceGenerator</h3>
<p><strong>æ ¸å¿ƒèŒè´£ï¼š</strong></p>
<ul>
<li>æ ¹æ®å®ä½“ç±»ç¡®å®šæ•°æ®åº“è¡¨å</li>
<li>æŒ‰çº¦å®šæ„é€ åºåˆ—åï¼ˆ<code>{table_name}_id_seq</code>ï¼‰</li>
<li>æ‰§è¡Œ SQL è·å–åºåˆ—çš„ä¸‹ä¸€ä¸ªå€¼</li>
</ul>
<p><strong>æ ¸å¿ƒå®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PostgresSequenceGenerator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IKeyGenerator</span> {
    
    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">nextId</span><span class="hljs-params">(Object entity)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">tableName</span> <span class="hljs-operator">=</span> getTableName(entity);
        <span class="hljs-type">String</span> <span class="hljs-variable">sequenceName</span> <span class="hljs-operator">=</span> tableName + <span class="hljs-string">"_id_seq"</span>;
        
        <span class="hljs-comment">// OpenGaussè¦æ±‚nextval()å‚æ•°ä¸ºå¸¸é‡ï¼Œä¸èƒ½ä½¿ç”¨PreparedStatement</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT nextval('"</span> + sequenceName + <span class="hljs-string">"')"</span>;
        
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> dataSource.getConnection();
             <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();
             <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql)) {
            <span class="hljs-keyword">return</span> rs.next() ? rs.getLong(<span class="hljs-number">1</span>) : <span class="hljs-literal">null</span>;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Failed to generate ID from sequence"</span>, e);
        }
    }
}
</code></pre>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹ï¼š</strong></p>
<ol>
<li><strong>è¡¨åè·å–ç­–ç•¥</strong>ï¼šä¼˜å…ˆä½¿ç”¨ <code>@TableName</code> æ³¨è§£ï¼Œå¦åˆ™æ ¹æ®ç±»åè½¬æ¢</li>
<li><strong>SQL æ³¨å…¥é˜²æŠ¤</strong>ï¼šåºåˆ—åå¿…é¡»åŒ¹é… <code>^[a-zA-Z0-9_]+$</code> æ­£åˆ™è¡¨è¾¾å¼</li>
<li><strong>OpenGauss å…¼å®¹æ€§</strong>ï¼šä½¿ç”¨ <code>Statement</code> è€Œé <code>PreparedStatement</code>ï¼Œå› ä¸º OpenGauss è¦æ±‚ <code>nextval()</code> å‚æ•°ä¸ºå¸¸é‡</li>
</ol>
<h4 data-id="heading-13">åºåˆ—æœºåˆ¶æ·±å…¥è§£æ</h4>
<p><strong>åºåˆ—çš„åˆ›å»ºä¸ç®¡ç†ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºåºåˆ—ï¼ˆOpenGaussï¼‰</span>
<span class="hljs-keyword">CREATE</span> SEQUENCE xxx_id_seq
    <span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> <span class="hljs-number">1</span>          <span class="hljs-comment">-- èµ·å§‹å€¼</span>
    INCREMENT <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>        <span class="hljs-comment">-- æ­¥é•¿</span>
    MINVALUE <span class="hljs-number">1</span>           <span class="hljs-comment">-- æœ€å°å€¼</span>
    MAXVALUE <span class="hljs-number">9223372036854775807</span>  <span class="hljs-comment">-- æœ€å¤§å€¼ï¼ˆBIGINTæœ€å¤§å€¼ï¼‰</span>
    CACHE <span class="hljs-number">1</span>              <span class="hljs-comment">-- ç¼“å­˜å¤§å°</span>
    <span class="hljs-keyword">NO</span> <span class="hljs-keyword">CYCLE</span>;            <span class="hljs-comment">-- ä¸å¾ªç¯</span>

<span class="hljs-comment">-- æŸ¥çœ‹åºåˆ—ä¿¡æ¯</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> information_schema.sequences 
<span class="hljs-keyword">WHERE</span> sequence_name <span class="hljs-operator">=</span> <span class="hljs-string">'xxx_id_seq'</span>;

<span class="hljs-comment">-- è·å–åºåˆ—å½“å‰å€¼ï¼ˆä¸æ¶ˆè€—ï¼‰</span>
<span class="hljs-keyword">SELECT</span> currval(<span class="hljs-string">'xxx_id_seq'</span>);

<span class="hljs-comment">-- è·å–åºåˆ—ä¸‹ä¸€ä¸ªå€¼ï¼ˆæ¶ˆè€—ä¸€ä¸ªå€¼ï¼‰</span>
<span class="hljs-keyword">SELECT</span> nextval(<span class="hljs-string">'xxx_id_seq'</span>);

<span class="hljs-comment">-- è®¾ç½®åºåˆ—å½“å‰å€¼</span>
<span class="hljs-keyword">SELECT</span> setval(<span class="hljs-string">'xxx_id_seq'</span>, <span class="hljs-number">1000</span>);
</code></pre>
<p><strong>åºåˆ— vs è‡ªå¢å­—æ®µå¯¹æ¯”ï¼š</strong></p>








































<table><thead><tr><th>ç‰¹æ€§</th><th>PostgreSQL åºåˆ—</th><th>MySQL è‡ªå¢</th></tr></thead><tbody><tr><td>ç‹¬ç«‹æ€§</td><td>ç‹¬ç«‹å¯¹è±¡ï¼Œå¯è¢«å¤šè¡¨å…±äº«</td><td>ç»‘å®šåˆ°ç‰¹å®šè¡¨çš„ç‰¹å®šåˆ—</td></tr><tr><td>çµæ´»æ€§</td><td>æ”¯æŒå¤æ‚é…ç½®ï¼ˆæ­¥é•¿ã€ç¼“å­˜ç­‰ï¼‰</td><td>é…ç½®é€‰é¡¹æœ‰é™</td></tr><tr><td>æ€§èƒ½</td><td>å¯é…ç½®ç¼“å­˜æå‡æ€§èƒ½</td><td>æ•°æ®åº“å¼•æ“ä¼˜åŒ–</td></tr><tr><td>äº‹åŠ¡å®‰å…¨</td><td>åºåˆ—å€¼ä¸ä¼šå› äº‹åŠ¡å›æ»šè€Œå›æ”¶</td><td>è‡ªå¢å€¼å¯èƒ½å› å›æ»šäº§ç”Ÿé—´éš™</td></tr><tr><td>è·¨è¡¨ä½¿ç”¨</td><td>ä¸€ä¸ªåºåˆ—å¯ä¾›å¤šä¸ªè¡¨ä½¿ç”¨</td><td>æ¯ä¸ªè¡¨ç‹¬ç«‹çš„è‡ªå¢è®¡æ•°å™¨</td></tr><tr><td>é‡ç½®æ“ä½œ</td><td>å¯ä»¥éšæ—¶é‡ç½®åºåˆ—å€¼</td><td>éœ€è¦ ALTER TABLE æ“ä½œ</td></tr></tbody></table>
<p><strong>OpenGauss ç‰¹æ®Šé™åˆ¶ï¼š</strong></p>
<p>OpenGauss å¯¹åºåˆ—æ“ä½œæœ‰ç‰¹æ®Šè¦æ±‚ï¼Œè¿™ä¹Ÿæ˜¯ MyBatis-Plus å…¼å®¹æ€§é—®é¢˜çš„æ ¹æºï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šOpenGauss ä¸æ”¯æŒå‚æ•°åŒ–çš„ nextval()</span>
<span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> conn.prepareStatement(<span class="hljs-string">"SELECT nextval(?)"</span>);
ps.setString(<span class="hljs-number">1</span>, <span class="hljs-string">"user_id_seq"</span>);

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šå¿…é¡»ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡</span>
<span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();
<span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(<span class="hljs-string">"SELECT nextval('user_id_seq')"</span>);
</code></pre>
<p>è¿™ä¸ªé™åˆ¶è¦æ±‚æˆ‘ä»¬ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨ SQL ä¸­ç¡¬ç¼–ç åºåˆ—å</li>
<li>éœ€è¦ä¸¥æ ¼éªŒè¯åºåˆ—åé˜²æ­¢ SQL æ³¨å…¥</li>
<li>æ— æ³•ä½¿ç”¨ MyBatis çš„å‚æ•°ç»‘å®šæœºåˆ¶</li>
</ul>
<h3 data-id="heading-14">ç»„ä»¶ 3ï¼šMybatisPlusConfig</h3>
<p><strong>æ ¸å¿ƒèŒè´£ï¼š</strong></p>
<ul>
<li>åœ¨ Spring å®¹å™¨åˆå§‹åŒ–åæ³¨å†Œæ‹¦æˆªå™¨</li>
<li>æ”¯æŒå¤šæ•°æ®æºåœºæ™¯ï¼Œä¸ºæ¯ä¸ª <code>SqlSessionFactory</code> æ³¨å†Œæ‹¦æˆªå™¨</li>
</ul>
<p><strong>æ ¸å¿ƒå®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisPlusConfig</span> {
    
    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptor</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä¸ºæ‰€æœ‰SqlSessionFactoryæ³¨å†Œæ‹¦æˆªå™¨</span>
        <span class="hljs-keyword">for</span> (SqlSessionFactory factory : sqlSessionFactoryList) {
            <span class="hljs-type">Configuration</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> factory.getConfiguration();
            <span class="hljs-keyword">if</span> (!config.getInterceptors().contains(autoIdGeneratorInterceptor)) {
                config.addInterceptor(autoIdGeneratorInterceptor);
            }
        }
    }
}
</code></pre>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹ï¼š</strong></p>
<ol>
<li><strong>@PostConstruct æ—¶æœº</strong>ï¼šç¡®ä¿åœ¨ Spring å®¹å™¨åˆå§‹åŒ–åã€åº”ç”¨å¯åŠ¨å‰æ³¨å†Œæ‹¦æˆªå™¨</li>
<li><strong>å¤šæ•°æ®æºæ”¯æŒ</strong>ï¼šéå†æ‰€æœ‰ <code>SqlSessionFactory</code> å®ä¾‹ï¼Œé€ä¸€æ³¨å†Œ</li>
<li><strong>é‡å¤æ³¨å†Œæ£€æŸ¥</strong>ï¼šé¿å…åŒä¸€ä¸ªæ‹¦æˆªå™¨è¢«é‡å¤æ³¨å†Œ</li>
<li><strong>æ³¨å…¥ List</strong>ï¼šSpring ä¼šè‡ªåŠ¨æ³¨å…¥æ‰€æœ‰ <code>SqlSessionFactory</code> ç±»å‹çš„ Bean</li>
</ol>
<h2 data-id="heading-15">å››ã€ä½¿ç”¨æ–¹å¼</h2>
<h3 data-id="heading-16">å®ä½“ç±»é…ç½®</h3>
<p>ä½¿ç”¨æ ‡å‡†çš„ MyBatis-Plus æ³¨è§£å³å¯ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Data</span>
<span class="hljs-meta">@TableName("xxx")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">xxx</span> {
    
    <span class="hljs-meta">@TableId(type = IdType.AUTO)</span>
    <span class="hljs-keyword">private</span> Long id;
}
</code></pre>
<h3 data-id="heading-17">æ•°æ®åº“åºåˆ—åˆ›å»º</h3>
<p>ç¡®ä¿æ•°æ®åº“ä¸­å­˜åœ¨å¯¹åº”çš„åºåˆ—ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºåºåˆ—ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰</span>
<span class="hljs-keyword">CREATE</span> SEQUENCE IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> xxx_id_seq
    <span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> <span class="hljs-number">1</span>
    INCREMENT <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">NO</span> MINVALUE
    <span class="hljs-keyword">NO</span> MAXVALUE
    CACHE <span class="hljs-number">1</span>;

<span class="hljs-comment">-- è®¾ç½®åºåˆ—çš„å½“å‰å€¼ï¼ˆå¯é€‰ï¼‰</span>
<span class="hljs-keyword">SELECT</span> setval(<span class="hljs-string">'xxx_id_seq'</span>, <span class="hljs-number">1000</span>, <span class="hljs-literal">false</span>);
</code></pre>
<h3 data-id="heading-18">Mapper æ¥å£</h3>
<p>æ— éœ€ç‰¹æ®Šå¤„ç†ï¼Œä½¿ç”¨æ ‡å‡†çš„ MyBatis-Plus æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Mapper</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">xxxMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;xxx&gt; {
    <span class="hljs-comment">// ç»§æ‰¿BaseMapperå³å¯ï¼Œæ— éœ€é¢å¤–é…ç½®</span>
}
</code></pre>
<h3 data-id="heading-19">Service å±‚è°ƒç”¨</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCategory</span><span class="hljs-params">(String categoryName)</span> {
    <span class="hljs-type">xxx</span> <span class="hljs-variable">category</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">xxx</span>();
    category.setCategoryName(categoryName);
    <span class="hljs-comment">// æ— éœ€æ‰‹åŠ¨è®¾ç½®IDï¼Œæ‹¦æˆªå™¨ä¼šè‡ªåŠ¨ç”Ÿæˆ</span>
    
    categoryMapper.insert(category);
    <span class="hljs-comment">// æ’å…¥åï¼Œcategory.getId() å·²ç»æœ‰å€¼</span>
}
</code></pre>
<h2 data-id="heading-20">äº”ã€æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”</h2>
<h3 data-id="heading-21">ä¸»é”®ç”Ÿæˆæ–¹æ¡ˆå¯¹æ¯”</h3>






















































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>å®ç°æ–¹å¼</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>æ•°æ®åº“è‡ªå¢</td><td>AUTO_INCREMENT</td><td>ç®€å•ï¼Œæ€§èƒ½å¥½</td><td>åˆ†å¸ƒå¼é—®é¢˜ï¼Œè¿ç§»å›°éš¾</td><td>å•æœºMySQLåº”ç”¨</td></tr><tr><td>MyBatis-Plus AUTO</td><td>@TableId(type=AUTO)</td><td>é…ç½®ç®€å•ï¼Œæ¡†æ¶æ”¯æŒ</td><td>æ•°æ®åº“å…¼å®¹æ€§é—®é¢˜</td><td>æ ‡å‡†MySQL/PostgreSQL</td></tr><tr><td>è‡ªå®šä¹‰æ‹¦æˆªå™¨</td><td>Interceptor + Sequence</td><td>å®Œå…¨æ§åˆ¶ï¼Œå…¼å®¹æ€§å¥½</td><td>å®ç°å¤æ‚ï¼Œéœ€ç»´æŠ¤</td><td>ç‰¹æ®Šæ•°æ®åº“ã€å¤æ‚è§„åˆ™</td></tr><tr><td>UUID</td><td>UUID.randomUUID()</td><td>å…¨å±€å”¯ä¸€ï¼Œæ— ä¾èµ–</td><td>å­˜å‚¨ç©ºé—´å¤§ï¼Œæ— åº</td><td>åˆ†å¸ƒå¼ç³»ç»Ÿ</td></tr><tr><td>é›ªèŠ±ç®—æ³•</td><td>Snowflake</td><td>é«˜æ€§èƒ½ï¼Œè¶‹åŠ¿é€’å¢</td><td>ä¾èµ–æ—¶é’Ÿï¼Œé…ç½®å¤æ‚</td><td>é«˜å¹¶å‘åˆ†å¸ƒå¼ç³»ç»Ÿ</td></tr><tr><td>Redisè‡ªå¢</td><td>INCRå‘½ä»¤</td><td>é«˜æ€§èƒ½ï¼Œé›†ä¸­ç®¡ç†</td><td>ä¾èµ–Redisï¼Œå•ç‚¹é—®é¢˜</td><td>ä¸­å°è§„æ¨¡åˆ†å¸ƒå¼</td></tr></tbody></table>
<h3 data-id="heading-22">æ‹¦æˆªå™¨æ–¹æ¡ˆ vs MyBatis-Plus åŸç”Ÿæ–¹æ¡ˆ</h3>








































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>è‡ªå®šä¹‰æ‹¦æˆªå™¨</th><th>MyBatis-Plus åŸç”Ÿ</th></tr></thead><tbody><tr><td>æ•°æ®åº“å…¼å®¹æ€§</td><td>âœ… æ”¯æŒ OpenGauss ç­‰é­”æ”¹æ•°æ®åº“</td><td>âš ï¸ éƒ¨åˆ†æ•°æ®åº“ä¸æ”¯æŒ</td></tr><tr><td>å®ç°å¤æ‚åº¦</td><td>âš ï¸ éœ€è¦ç¼–å†™æ‹¦æˆªå™¨ä»£ç </td><td>âœ… é…ç½®å³å¯ä½¿ç”¨</td></tr><tr><td>çµæ´»æ€§</td><td>âœ… å¯è‡ªå®šä¹‰ç”Ÿæˆé€»è¾‘</td><td>âŒ ä¾èµ–æ¡†æ¶å®ç°</td></tr><tr><td>æ€§èƒ½å¼€é”€</td><td>âš ï¸ æ¯æ¬¡INSERTé¢å¤–æŸ¥è¯¢åºåˆ—</td><td>âœ… æ•°æ®åº“åŸç”Ÿæ”¯æŒ</td></tr><tr><td>ç»´æŠ¤æˆæœ¬</td><td>âš ï¸ éœ€è¦ç»´æŠ¤æ‹¦æˆªå™¨ä»£ç </td><td>âœ… æ¡†æ¶ç»Ÿä¸€ç»´æŠ¤</td></tr><tr><td>è°ƒè¯•éš¾åº¦</td><td>âš ï¸ éœ€è¦ç†è§£æ‹¦æˆªå™¨æœºåˆ¶</td><td>âœ… é—®é¢˜è¾ƒå°‘</td></tr></tbody></table>
<h2 data-id="heading-23">å…­ã€æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-24">1. SQL æ³¨å…¥é˜²æŠ¤</h3>
<p>åºåˆ—åå¿…é¡»è¿›è¡Œä¸¥æ ¼éªŒè¯ï¼š<code>sequenceName.matches("^[a-zA-Z0-9_]+$")</code>ï¼Œé¿å…ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥ã€‚</p>
<h3 data-id="heading-25">2. æ€§èƒ½è€ƒè™‘</h3>
<p>æ¯æ¬¡ INSERT éƒ½ä¼šé¢å¤–æ‰§è¡Œä¸€æ¬¡åºåˆ—æŸ¥è¯¢ï¼Œé«˜å¹¶å‘åœºæ™¯éœ€è¦ï¼š</p>
<ul>
<li>ä½¿ç”¨é«˜æ€§èƒ½è¿æ¥æ± ï¼ˆHikariCPï¼‰</li>
<li>è€ƒè™‘æ‰¹é‡è·å–åºåˆ—å€¼å¹¶ç¼“å­˜</li>
<li>ç›‘æ§åºåˆ—æŸ¥è¯¢çš„å“åº”æ—¶é—´</li>
</ul>
<h3 data-id="heading-26">3. äº‹åŠ¡ä¸€è‡´æ€§</h3>
<p>åºåˆ—ç”Ÿæˆåœ¨ INSERT äº‹åŠ¡å¤–æ‰§è¡Œï¼Œäº‹åŠ¡å›æ»šæ—¶åºåˆ—å€¼ä¼šè¢«æ¶ˆè€—ï¼Œå¯¼è‡´åºåˆ—ä¸è¿ç»­ã€‚è¿™æ˜¯åºåˆ—æœºåˆ¶çš„æ­£å¸¸è¡Œä¸ºï¼Œä¸å½±å“æ•°æ®ä¸€è‡´æ€§ã€‚</p>
<h3 data-id="heading-27">4. å¤šæ•°æ®æºåœºæ™¯</h3>
<p>æ‹¦æˆªå™¨ä¼šè‡ªåŠ¨ä¸ºæ‰€æœ‰ SqlSessionFactory æ³¨å†Œï¼Œéœ€ç¡®ä¿æ¯ä¸ªæ•°æ®æºçš„è¡¨éƒ½æœ‰å¯¹åº”çš„åºåˆ—ã€‚</p>
<h3 data-id="heading-28">5. åºåˆ—å‘½åçº¦å®š</h3>
<p>ç»Ÿä¸€ä½¿ç”¨ <code>{table_name}_id_seq</code> æ ¼å¼ï¼Œå¦‚ <code>xxx_id_seq</code>ã€‚</p>
<h2 data-id="heading-29">ä¸ƒã€å¸¸è§é—®é¢˜æ’æŸ¥</h2>
<h3 data-id="heading-30">é—®é¢˜ 1ï¼šID ä»ç„¶ä¸º NULL</h3>
<p><strong>å¯èƒ½åŸå› ï¼š</strong></p>
<ol>
<li>æ‹¦æˆªå™¨æœªæ­£ç¡®æ³¨å†Œ</li>
<li>å®ä½“ç±»æ³¨è§£é…ç½®é”™è¯¯</li>
<li>æ•°æ®åº“åºåˆ—ä¸å­˜åœ¨</li>
</ol>
<p><strong>æ’æŸ¥æ­¥éª¤ï¼š</strong></p>
<ol>
<li>æ£€æŸ¥æ‹¦æˆªå™¨æ˜¯å¦æ³¨å†Œï¼šæŸ¥çœ‹ Configuration.getInterceptors() åˆ—è¡¨</li>
<li>æ£€æŸ¥å®ä½“ç±»æ³¨è§£ï¼šç¡®ä¿ <code>@TableId(type = IdType.AUTO)</code></li>
<li>æ£€æŸ¥æ•°æ®åº“åºåˆ—ï¼š<code>SELECT * FROM information_schema.sequences WHERE sequence_name = 'table_id_seq'</code></li>
</ol>
<h3 data-id="heading-31">é—®é¢˜ 2ï¼šåºåˆ—ä¸å­˜åœ¨é”™è¯¯</h3>
<p><strong>é”™è¯¯ä¿¡æ¯ï¼š</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">ERROR:</span> relation <span class="hljs-string">"xxx_id_seq"</span> does <span class="hljs-built_in">not</span> exist
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºç¼ºå¤±çš„åºåˆ—</span>
<span class="hljs-keyword">CREATE</span> SEQUENCE xxx_id_seq <span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> <span class="hljs-number">1</span>;

<span class="hljs-comment">-- æˆ–è€…æ‰¹é‡åˆ›å»ºæ‰€æœ‰è¡¨çš„åºåˆ—</span>
DO $$
<span class="hljs-keyword">DECLARE</span>
    r RECORD;
<span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">FOR</span> r <span class="hljs-keyword">IN</span> <span class="hljs-keyword">SELECT</span> tablename <span class="hljs-keyword">FROM</span> pg_tables <span class="hljs-keyword">WHERE</span> schemaname <span class="hljs-operator">=</span> <span class="hljs-string">'public'</span>
    LOOP
        <span class="hljs-keyword">EXECUTE</span> format(<span class="hljs-string">'CREATE SEQUENCE IF NOT EXISTS %I_id_seq'</span>, r.tablename);
    <span class="hljs-keyword">END</span> LOOP;
<span class="hljs-keyword">END</span> $$;
</code></pre>
<h3 data-id="heading-32">é—®é¢˜ 3ï¼šæ€§èƒ½ä¸‹é™</h3>
<p><strong>ç°è±¡ï¼š</strong> INSERT æ“ä½œå˜æ…¢</p>
<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>æ¯æ¬¡ INSERT é¢å¤–æ‰§è¡Œä¸€æ¬¡åºåˆ—æŸ¥è¯¢</li>
<li>æ•°æ®åº“è¿æ¥æ± é…ç½®ä¸å½“</li>
<li>åºåˆ—ç¼“å­˜è®¾ç½®è¿‡å°</li>
</ul>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>å¢åŠ åºåˆ—ç¼“å­˜ï¼š<code>ALTER SEQUENCE table_id_seq CACHE 100</code></li>
<li>ä¼˜åŒ–è¿æ¥æ± é…ç½®ï¼šè°ƒæ•´ HikariCP çš„ maximum-pool-size å’Œ minimum-idle</li>
<li>è€ƒè™‘æ‰¹é‡è·å–åºåˆ—å€¼å¹¶ç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“äº¤äº’</li>
</ol>
<h2 data-id="heading-33">å…«ã€æ€»ç»“</h2>
<p>è‡ªå®šä¹‰ MyBatis æ‹¦æˆªå™¨å®ç°ä¸»é”®è‡ªåŠ¨ç”Ÿæˆæ˜¯ä¸€ç§çµæ´»ä¸”å¼ºå¤§çš„è§£å†³æ–¹æ¡ˆï¼Œç‰¹åˆ«é€‚ç”¨äºï¼š</p>
<ol>
<li><strong>æ•°æ®åº“å…¼å®¹æ€§é—®é¢˜</strong>ï¼šå¦‚ OpenGaussã€è¾¾æ¢¦ç­‰å›½äº§æ•°æ®åº“</li>
<li><strong>å¤æ‚ ID ç”Ÿæˆè§„åˆ™</strong>ï¼šéœ€è¦è‡ªå®šä¹‰ç”Ÿæˆé€»è¾‘çš„åœºæ™¯</li>
<li><strong>æ¡†æ¶é™åˆ¶</strong>ï¼šMyBatis-Plus åŸç”Ÿæ–¹æ¡ˆæ— æ³•æ»¡è¶³éœ€æ±‚</li>
</ol>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… å®Œå…¨æ§åˆ¶ ID ç”Ÿæˆé€»è¾‘</li>
<li>âœ… è‰¯å¥½çš„æ•°æ®åº“å…¼å®¹æ€§</li>
<li>âœ… å¯¹ä¸šåŠ¡ä»£ç é€æ˜ï¼Œæ— ä¾µå…¥</li>
</ul>
<p><strong>éœ€è¦æ³¨æ„ï¼š</strong></p>
<ul>
<li>âš ï¸ å®ç°å’Œç»´æŠ¤æˆæœ¬è¾ƒé«˜</li>
<li>âš ï¸ æ€§èƒ½å¼€é”€éœ€è¦è¯„ä¼°</li>
<li>âš ï¸ éœ€è¦ç†è§£ MyBatis æ‹¦æˆªå™¨æœºåˆ¶</li>
</ul>
<p>é€šè¿‡åˆç†çš„è®¾è®¡å’Œå®ç°ï¼Œè‡ªå®šä¹‰æ‹¦æˆªå™¨å¯ä»¥æˆä¸ºè§£å†³ç‰¹å®šåœºæ™¯é—®é¢˜çš„æœ‰æ•ˆå·¥å…·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‡ªå»º React Native çƒ­ä¿®å¤ï¼Œè®©çº¿ä¸Šäº‹æ•… 30 ç§’â€œå½’é›¶â€]]></title>    <link>https://juejin.cn/post/7584787119273574427</link>    <guid>https://juejin.cn/post/7584787119273574427</guid>    <pubDate>2025-12-18T04:15:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584787119273574427" data-draft-id="7584742635502354459" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‡ªå»º React Native çƒ­ä¿®å¤ï¼Œè®©çº¿ä¸Šäº‹æ•… 30 ç§’â€œå½’é›¶â€"/> <meta itemprop="keywords" content="React Native"/> <meta itemprop="datePublished" content="2025-12-18T04:15:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ´çªæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2538113306470631"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‡ªå»º React Native çƒ­ä¿®å¤ï¼Œè®©çº¿ä¸Šäº‹æ•… 30 ç§’â€œå½’é›¶â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2538113306470631/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ´çªæŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:15:05.000Z" title="Thu Dec 18 2025 04:15:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»28åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<blockquote>
<p>ä¸€å¥è¯å–ç‚¹
ä¸ç”¨å‘ç‰ˆã€ä¸ç”¨å®¡æ ¸ï¼Œ10 åˆ†é’ŸæŠŠé¦–é¡µå´©æºƒæ”¹å®Œï¼›è¿˜èƒ½ç°åº¦ + ä¸€é”®æ’¤å›ï¼Œè€æ¿å†ä¹Ÿä¸æ‹…å¿ƒçº¿ä¸Šäº‹æ•…ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-0">æ ¸å¿ƒæ‘˜è¦</h3>
<p>é¢å¯¹åŸç”Ÿåº”ç”¨å‘ç‰ˆå®¡æ ¸å‘¨æœŸé•¿ï¼ˆ1-7 å¤©ï¼‰ã€ç¬¬ä¸‰æ–¹çƒ­æ›´æ–°å·¥å…·ï¼ˆå¦‚ CodePushï¼‰å®šåˆ¶åŒ–ä¸è¶³ã€æ•°æ®ä¸é€æ˜ä¸”å›æ»šèƒ½åŠ›å¼±çš„ç—›ç‚¹ï¼Œæœ¬æ–‡æä¾›ä¸€å¥—å®Œæ•´çš„è‡ªå»º React Nativeï¼ˆRNï¼‰çƒ­ä¿®å¤è§£å†³æ–¹æ¡ˆã€‚æ ¸å¿ƒä»·å€¼åœ¨äºæ‘†è„±åº”ç”¨å¸‚åœºå®¡æ ¸æŸç¼šï¼Œå®ç°çº¿ä¸Šé—®é¢˜å¿«é€Ÿä¿®å¤ä¸é£é™©å¯æ§ï¼šé€šè¿‡æœåŠ¡ç«¯æ­å»ºç‰ˆæœ¬ç®¡ç†ï¼ˆMySQL+Redisï¼‰ã€èµ„æºå­˜å‚¨ï¼ˆé˜¿é‡Œäº‘ OSSï¼‰ã€æ¥å£æœåŠ¡ï¼ˆNode.js/Javaï¼‰ä¸å®‰å…¨éªŒè¯æ¨¡å—ï¼Œå®¢æˆ·ç«¯å®ç°ç‰ˆæœ¬æ£€æµ‹ã€ä¸‹è½½ç®¡ç†ã€æ™ºèƒ½å›æ»šä¸çŠ¶æ€ä¸ŠæŠ¥åŠŸèƒ½ï¼Œæ‰“é€š â€œè¡¥ä¸åˆ›å»º - ç°åº¦å‘å¸ƒ - å®¢æˆ·ç«¯æ›´æ–° - ç´§æ€¥æ’¤å›â€ å…¨é“¾è·¯ã€‚æ–¹æ¡ˆæ”¯æŒæŒ‰ â€œæŒ‡å®šç”¨æˆ·â€ ç²¾ç»†åŒ–ç°åº¦ç­–ç•¥ï¼Œæ•°æ®å…¨ç¨‹å¯ç›‘æ§ï¼›è½åœ°åå¯å®ç° 10 åˆ†é’Ÿå†…å®Œæˆè¡¥ä¸å‘å¸ƒã€30 ç§’å†…è§¦å‘å…¨å±€å›æ»šï¼ŒåŒæ—¶å…·å¤‡ç‰ˆæœ¬å¤‡ä»½ä¸è‡ªåŠ¨é™çº§èƒ½åŠ›ï¼Œå½»åº•è§£å†³çº¿ä¸Šäº‹æ•…å“åº”æ…¢ã€é£é™©ä¸å¯æ§çš„é—®é¢˜ï¼Œè®© RN å¼€å‘æ‹¥æœ‰æœåŠ¡ç«¯åŠ¨æ€åŒ–è¿­ä»£èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆè¦è‡ªå»ºâ€œRN çƒ­ä¿®å¤â€</h3>
<ol>
<li>
<p><strong>åŸç”Ÿå‘ç‰ˆå‘¨æœŸå¤ªé•¿</strong>
åº”ç”¨å¸‚åœº å®¡æ ¸æœ€å¿« 1 å¤©ã€æœ€æ…¢ 7+ å¤©ï¼Œè‡´å‘½ BUG ç­‰ä¸èµ·ã€‚</p>
</li>
<li>
<p><strong>ç¬¬ä¸‰æ–¹çƒ­æ›´æ–°â€œä¸å¥½ç”¨â€</strong>
æˆ‘ä»¬æ›¾è¯•è¿‡ CodePushï¼ˆå«å›½å†…é•œåƒï¼‰ï¼Œè¸©å‘å¦‚ä¸‹ï¼š</p>





















<table><thead><tr><th>ç—›ç‚¹</th><th>å…·ä½“è¡¨ç°</th></tr></thead><tbody><tr><td>å®šåˆ¶åŒ–ä¸è¶³</td><td>æ— æ³•æŒ‰â€œç”¨æˆ·ç­‰çº§ + åœ°åŸŸ + è®¾å¤‡å‹å·â€ç»„åˆå‘è¡¥ä¸ï¼›ä¸šåŠ¡ä¾§æƒ³â€œVIP ç”¨æˆ·å…ˆæ›´â€åšä¸åˆ°ã€‚</td></tr><tr><td>æ•°æ®é»‘ç›’</td><td>æ›´æ–°æˆåŠŸç‡ã€å¤±è´¥åŸå› ã€å›æ»šç‡éœ€è‡ªå·±æ‰’æ—¥å¿—ï¼Œæ’æŸ¥é—®é¢˜é çŒœã€‚</td></tr><tr><td>ç­–ç•¥æ­»æ¿</td><td>ç°åº¦åªèƒ½æŒ‰â€œç™¾åˆ†æ¯”â€æ»šï¼Œä¸èƒ½â€œæŒ‡å®š UUID ç™½åå•â€æˆ–â€œéšæ—¶ä¸€é”®å…¨å›â€ã€‚</td></tr></tbody></table>
</li>
<li>
<p><strong>è€æ¿è¦çš„æ˜¯â€œéšæ—¶å›æ»šâ€ï¼Œä¸æ˜¯â€œéšæ—¶æ›´æ–°â€</strong>
CodePush è™½æ”¯æŒå›æ»šï¼Œä½†ç²’åº¦ç²—ï¼ˆåªèƒ½æ•´ç‰ˆæœ¬å›é€€ï¼‰ã€ç”Ÿæ•ˆæ…¢ï¼ˆCDN ç¼“å­˜+å®¢æˆ·ç«¯å®šæ—¶æ£€æµ‹ï¼‰ã€æ— æ³•æŒ‰ç”¨æˆ·ç»´åº¦å±€éƒ¨æ’¤é”€ï¼›ä¸€æ—¦å‡ºç°å¤§é¢ç§¯å´©æºƒï¼Œä»éœ€é‡æ–°æ‰“åŒ…ã€é‡æ–°åˆ†å‘ï¼Œè€—æ—¶æŒ‰å°æ—¶è®¡ã€‚</p>
</li>
</ol>
<p>åŸºäºä»¥ä¸ŠåŸå› ï¼Œæˆ‘ä»¬å†³å®š<strong>è‡ªå»ºçƒ­ä¿®å¤ä½“ç³»</strong>ï¼Œå®šä¸‹çš„ç›®æ ‡ä¸€å¥è¯ï¼š</p>
<blockquote>
<p>10 åˆ†é’Ÿå†…å‘è¡¥ä¸ï¼Œ30 ç§’å†…å¯æ’¤å›ï¼Œæ•°æ®å…¨æ¡åœ¨è‡ªå·±æ‰‹é‡Œï¼Œè®© RN æ‹¥æœ‰æœåŠ¡ç«¯åŠ¨æ€åŒ–èƒ½åŠ›ã€‚</p>
</blockquote>
<p>äºæ˜¯æˆ‘ä»¬æŠŠå¾®è½¯æ–¹æ¡ˆå…¨éƒ¨è‡ªç ”åŒ–ï¼šæ¥å£ã€ç°åº¦ã€æ’¤å›ã€ç»Ÿè®¡å…¨æ¡åœ¨è‡ªå·±æ‰‹é‡Œã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒæ¶æ„è®¾è®¡</h3>
<h4 data-id="heading-3">1. æ•´ä½“æ¶æ„å›¾</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cd2de06b67544c5ab4583ccc04b8d23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=C67WUNOSm8Ot3C5wy6FwSJYFQqE%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-4">2. æœåŠ¡ç«¯æ ¸å¿ƒæ¨¡å—</h4>



































<table><thead><tr><th>æ¨¡å—</th><th>æŠ€æœ¯é€‰å‹</th><th>æ ¸å¿ƒåŠŸèƒ½</th></tr></thead><tbody><tr><td>ç‰ˆæœ¬ç®¡ç†</td><td>MySQL + Redis</td><td>å­˜å‚¨åŸç”Ÿç‰ˆæœ¬ä¸ RN ç‰ˆæœ¬æ˜ å°„å…³ç³»ã€æ›´æ–°ç­–ç•¥é…ç½®</td></tr><tr><td>èµ„æºå­˜å‚¨</td><td>é˜¿é‡Œäº‘ OSS / æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</td><td>å­˜å‚¨ JS Bundle å’Œé™æ€èµ„æºåŒ…ã€æä¾›å®‰å…¨ä¸‹è½½é“¾æ¥</td></tr><tr><td>æ¥å£æœåŠ¡</td><td>Node.js/Java + Express/SpringBoot</td><td>æä¾›ç‰ˆæœ¬æ£€æµ‹ã€ä¸‹è½½ã€çŠ¶æ€ä¸ŠæŠ¥æ¥å£</td></tr><tr><td>å®‰å…¨éªŒè¯</td><td>ç­¾åç®—æ³• + HTTPS</td><td>æ¥å£è¯·æ±‚æ ¡éªŒã€æ›´æ–°åŒ…å®Œæ•´æ€§æ ¡éªŒ</td></tr><tr><td>è¡¥ä¸æ’¤å›</td><td>MySQL + æ¶ˆæ¯é˜Ÿåˆ—</td><td>ç®¡ç†æ’¤å›çŠ¶æ€ã€æ¨é€å›æ»šæŒ‡ä»¤ã€è·Ÿè¸ªæ’¤å›ç»“æœ</td></tr></tbody></table>
<h4 data-id="heading-5">3. å®¢æˆ·ç«¯æ ¸å¿ƒæ¨¡å—</h4>



































<table><thead><tr><th>æ¨¡å—</th><th>å®ç°å±‚</th><th>æ ¸å¿ƒåŠŸèƒ½</th></tr></thead><tbody><tr><td>ç‰ˆæœ¬æ£€æµ‹</td><td>åŸç”Ÿå±‚</td><td>å®šæ—¶ / å¯åŠ¨æ—¶è¯·æ±‚æœåŠ¡ç«¯ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°æˆ–å›æ»š</td></tr><tr><td>ä¸‹è½½ç®¡ç†</td><td>åŸç”Ÿå±‚</td><td>MD5 æ ¡éªŒ</td></tr><tr><td>èµ„æºåŠ è½½</td><td>åŸç”Ÿå±‚</td><td>ä¼˜å…ˆåŠ è½½æ²™ç›’æ›´æ–°åŒ…ï¼Œå¤±è´¥é™çº§åˆ°åŸºç¡€åŒ…</td></tr><tr><td>çŠ¶æ€ä¸ŠæŠ¥</td><td>åŸç”Ÿ + RN</td><td>ä¸ŠæŠ¥ä¸‹è½½ / æ›´æ–° / å›æ»šçŠ¶æ€åˆ°æœåŠ¡ç«¯</td></tr><tr><td>å›æ»šæœºåˆ¶</td><td>åŸç”Ÿå±‚</td><td>è‡ªåŠ¨ / æ‰‹åŠ¨å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬</td></tr></tbody></table>
<h2 data-id="heading-6">ä¸‰ã€å‰ç½®å‡†å¤‡å·¥ä½œ</h2>
<h3 data-id="heading-7">3.1 åŸç”Ÿä¸ RN é›†æˆè§„èŒƒï¼ˆåŒç«¯é€šç”¨è¦æ±‚ï¼‰</h3>
<p>éœ€å®ŒæˆåŸç”Ÿï¼ˆAndroid/iOSï¼‰ä¸ RN çš„åŸºç¡€é›†æˆï¼Œå¹¶æ»¡è¶³ä»¥ä¸‹ç»Ÿä¸€è§„èŒƒï¼Œç¡®ä¿åŒç«¯ååŒé€‚é…çƒ­ä¿®å¤ï¼š</p>
<h4 data-id="heading-8">ï¼ˆ1ï¼‰åŸºç¡€é›†æˆéªŒè¯æ ‡å‡†</h4>
<ul>
<li>
<p><strong>åŠŸèƒ½éªŒè¯</strong>ï¼šRN é¡µé¢èƒ½æ­£å¸¸åµŒå…¥åŸç”Ÿå®¹å™¨ï¼ˆå¦‚ Android çš„ <code>ReactActivity</code>ã€iOS çš„ <code>RCTRootView</code>ï¼‰ï¼Œä¸”åŸç”Ÿä¸ RN èƒ½é€šè¿‡ <code>NativeModules</code> æ­£å¸¸é€šä¿¡ï¼ˆå¦‚åŸç”Ÿä¼ é€’ç”¨æˆ· Token åˆ° RNï¼ŒRN è°ƒç”¨åŸç”Ÿçš„å¼¹çª—åŠŸèƒ½ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ç‰ˆæœ¬ä¾èµ–ç»Ÿä¸€</strong>ï¼šåŸç”Ÿé¡¹ç›®å¼•å…¥çš„ RN æ ¸å¿ƒä¾èµ–ç‰ˆæœ¬ï¼ˆå¦‚ Android <code>build.gradle</code> ä¸­çš„ <code>com.facebook.react:react-native</code>ã€iOS Podfile ä¸­çš„ <code>React-Core</code>ï¼‰ï¼Œéœ€ä¸ RN ä¸šåŠ¡é¡¹ç›®çš„ <code>package.json</code> ä¸­ <code>react-native</code> ç‰ˆæœ¬å®Œå…¨ä¸€è‡´ï¼ˆå¦‚ç»Ÿä¸€ä¸º <code>0.72.6</code>ï¼‰ï¼Œé¿å…å› ç‰ˆæœ¬å·®å¼‚å¯¼è‡´çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>ç¼–è¯‘ç¯å¢ƒé€‚é…</strong>ï¼š</p>
<ul>
<li>Androidï¼šæœ€ä½æ”¯æŒ API 21ï¼ˆAndroid 5.0ï¼‰ï¼Œ<code>minSdkVersion</code> ä¸ä½äº 21ï¼Œ<code>compileSdkVersion</code> ä¸ <code>targetSdkVersion</code> å»ºè®®ä¸ RN æ¨èç‰ˆæœ¬å¯¹é½ï¼ˆå¦‚ 33ï¼‰ã€‚</li>
<li>iOSï¼šæœ€ä½æ”¯æŒ iOS 12.0ï¼ŒXcode ç‰ˆæœ¬ä¸ä½äº 14.0ï¼Œç¡®ä¿ <code>IPHONEOS_DEPLOYMENT_TARGET</code> è®¾ä¸º 12.0 åŠä»¥ä¸Šã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-9">3.2 Android ç«¯å‰ç½®å‡†å¤‡</h3>
<h4 data-id="heading-10">ï¼ˆ1ï¼‰åŸºç¡€èµ„æºç”Ÿæˆï¼ˆåŸç”Ÿé¢„ç½® RN èµ„æºï¼‰</h4>
<p>åŸºç¡€èµ„æºæ˜¯åŸç”Ÿé¡¹ç›®æ‰“åŒ…æ—¶é¢„ç½®çš„åˆå§‹ RN èµ„æºï¼ˆå« JS Bundle å’Œé™æ€èµ„æºï¼‰ï¼Œä½œä¸ºçƒ­ä¿®å¤çš„â€œåŸºå‡†èµ„æºâ€ï¼Œéœ€æŒ‰ä»¥ä¸‹æ­¥éª¤ç”Ÿæˆå¹¶å¯¼å…¥ï¼š</p>
<h5 data-id="heading-11">æ­¥éª¤ 1ï¼šé…ç½® RN æ‰“åŒ…ç¯å¢ƒ</h5>
<p>ç¡®ä¿æœ¬åœ°å·²å®‰è£… Node.jsï¼ˆå»ºè®® 16.x+ï¼‰å’Œ RN CLIï¼Œä¸” RN ä¸šåŠ¡é¡¹ç›®çš„ä¾èµ–å·²å®‰è£…ï¼ˆæ‰§è¡Œ <code>npm install</code>ï¼‰ã€‚</p>
<h5 data-id="heading-12">æ­¥éª¤ 2ï¼šæ‰§è¡Œæ‰“åŒ…å‘½ä»¤</h5>
<p>åœ¨ RN ä¸šåŠ¡é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ Android ç«¯çš„åŸºç¡€ JS Bundle å’Œé™æ€èµ„æºï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">  # </span><span class="bash">ç”Ÿæˆ Android åŸºç¡€ JS Bundle å’Œé™æ€èµ„æº</span>
  npx react-native bundle \
  --platform android \      # æŒ‡å®šå¹³å°ä¸º Android
  --entry-file index.js \   # RN å…¥å£æ–‡ä»¶ï¼ˆé€šå¸¸ä¸º index.js æˆ– index.android.jsï¼‰
  --bundle-output ./android_base_bundle/index.android.bundle \  # è¾“å‡ºçš„ JS Bundle è·¯å¾„ï¼ˆæœ¬åœ°ä¸´æ—¶ç›®å½•ï¼‰
  --assets-dest ./android_base_bundle/res \  # è¾“å‡ºçš„é™æ€èµ„æºï¼ˆå›¾ç‰‡ã€å­—ä½“ç­‰ï¼‰è·¯å¾„
  --dev false \             # å…³é—­å¼€å‘æ¨¡å¼ï¼ˆç”Ÿæˆç”Ÿäº§ç¯å¢ƒçš„å‹ç¼© Bundleï¼Œä½“ç§¯æ›´å°ã€æ€§èƒ½æ›´å¥½ï¼‰
  --minify true \           # å¼€å¯ä»£ç å‹ç¼©ï¼ˆç§»é™¤æ³¨é‡Šã€æ··æ·†å˜é‡åï¼Œå‡å°‘ Bundle ä½“ç§¯ï¼‰
  --reset-cache             # é‡ç½® Metro ç¼“å­˜ï¼Œé¿å…æ—§ä»£ç æ®‹ç•™
</code></pre>
<h5 data-id="heading-13">æ­¥éª¤ 3ï¼šå°†èµ„æºå¯¼å…¥åŸç”Ÿé¡¹ç›®</h5>
<ol>
<li>åœ¨ Android åŸç”Ÿé¡¹ç›®çš„ <code>app/src/main</code> ç›®å½•ä¸‹ï¼Œæ–°å»º <code>assets/</code> ç›®å½•ï¼ˆè‹¥ <code>assets</code> ç›®å½•ä¸å­˜åœ¨ï¼Œéœ€æ‰‹åŠ¨åˆ›å»ºï¼‰ï¼›</li>
<li>å°†æ­¥éª¤ 2 ä¸­ç”Ÿæˆçš„ <code>index.android.bundle</code> æ–‡ä»¶ï¼Œå¤åˆ¶åˆ° <code>assets/</code> ç›®å½•ä¸‹ï¼›</li>
<li>å°†æ­¥éª¤ 2 ä¸­ç”Ÿæˆçš„ <code>res</code> ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•ï¼ˆå¦‚ <code>drawable-mdpi</code>ã€<code>raw</code>ï¼‰ï¼Œå®Œæ•´å¤åˆ¶åˆ° <code>assets/</code> ç›®å½•ä¸‹ï¼ˆç¡®ä¿é™æ€èµ„æºè·¯å¾„ä¸ RN ä»£ç ä¸­å¼•ç”¨è·¯å¾„ä¸€è‡´ï¼‰ã€‚</li>
</ol>
<h5 data-id="heading-14">æ­¥éª¤ 4ï¼šèµ„æºéªŒè¯</h5>
<p>å¯åŠ¨åŸç”Ÿå®¹å™¨åŠ è½½ RN é¡µé¢ï¼Œç¡®è®¤é¡µé¢èƒ½æ­£å¸¸æ¸²æŸ“ï¼Œä¸”å›¾ç‰‡ã€å­—ä½“ç­‰é™æ€èµ„æºèƒ½æ­£å¸¸æ˜¾ç¤ºã€‚</p>
<h4 data-id="heading-15">ï¼ˆ2ï¼‰ç›®å½•è§„åˆ’ï¼ˆèµ„æºå­˜å‚¨è·¯å¾„æ ‡å‡†åŒ–ï¼‰</h4>
<p>æ˜ç¡®â€œåŸç”Ÿé¢„ç½®èµ„æºâ€å’Œâ€œçƒ­æ›´æ–°èµ„æºâ€çš„å­˜å‚¨è·¯å¾„ï¼Œç¡®ä¿çƒ­ä¿®å¤æ¨¡å—èƒ½å‡†ç¡®è®¿é—®èµ„æºï¼Œä¸”ç¬¦åˆ Android æ–‡ä»¶æƒé™è§„èŒƒï¼š</p>
<h5 data-id="heading-16">æ ¸å¿ƒåŸåˆ™</h5>
<ul>
<li><strong>åŸç”Ÿé¢„ç½®èµ„æº</strong>ï¼šå­˜æ”¾åœ¨åŸç”Ÿé¡¹ç›®çš„â€œåªè¯»ç›®å½•â€ï¼ˆ<code>assets</code>ï¼‰ï¼Œæ‰“åŒ…åä¸å¯ä¿®æ”¹ï¼Œä½œä¸ºçƒ­ä¿®å¤åŸºå‡†ï¼›</li>
<li><strong>çƒ­æ›´æ–°èµ„æº</strong>ï¼šå­˜æ”¾åœ¨åº”ç”¨ç§æœ‰å¯è¯»å†™ç›®å½•ï¼Œä»…å½“å‰åº”ç”¨å¯è®¿é—®ï¼Œä¿éšœå®‰å…¨æ€§ã€‚</li>
</ul>
<h5 data-id="heading-17">è¯¦ç»†ç›®å½•è§„åˆ’</h5>









































<table><thead><tr><th>èµ„æºç±»å‹</th><th>å­˜å‚¨è·¯å¾„</th><th>æƒé™è¯´æ˜</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>åŸç”Ÿé¢„ç½®èµ„æº</td><td><code>app/src/main/assets/rn_bundle/base/</code></td><td>åªè¯»ï¼ˆæ‰“åŒ…ååµŒå…¥ APKï¼Œæ— æ³•ä¿®æ”¹ï¼‰</td><td>å­˜æ”¾åˆå§‹ JS Bundleï¼ˆ<code>index.android.bundle</code>ï¼‰å’Œåˆå§‹é™æ€èµ„æºï¼ˆ<code>res/</code>ï¼‰</td></tr><tr><td>çƒ­æ›´æ–°èµ„æº</td><td><code>/data/data/[åº”ç”¨åŒ…å]/rn_update/</code></td><td>åº”ç”¨ç§æœ‰å¯è¯»å†™ï¼ˆä»…å½“å‰åº”ç”¨å¯è®¿é—®ï¼Œå¸è½½åº”ç”¨åä¼šåˆ é™¤ï¼‰</td><td>å­˜æ”¾ä¸‹è½½çš„çƒ­ä¿®å¤è¡¥ä¸åŒ…ã€è§£å‹åçš„æ–° JS Bundle å’Œæ–°é™æ€èµ„æº</td></tr><tr><td>çƒ­æ›´æ–°å­ç›®å½•</td><td><code>/data/data/[åº”ç”¨åŒ…å]/rn_update/versions/</code></td><td>ç‰ˆæœ¬ç®¡ç†ç›®å½•ï¼ŒæŒ‰ RN ç‰ˆæœ¬å·åˆ›å»ºå­ç›®å½•ï¼ˆå¦‚ <code>rn_v1.0.1/</code>ï¼‰</td><td>æ¯ä¸ªç‰ˆæœ¬çš„èµ„æºå•ç‹¬å­˜æ”¾ï¼Œä¾¿äºå›æ»šï¼ˆå¦‚å›æ»šåˆ° <code>rn_v1.0.0</code> æ—¶ç›´æ¥è¯»å–å¯¹åº”ç›®å½•ï¼‰</td></tr><tr><td>çƒ­æ›´æ–°å½“å‰ç‰ˆæœ¬</td><td><code>/data/data/[åº”ç”¨åŒ…å]/rn_update/current/</code></td><td>è½¯é“¾æ¥æˆ–æ ‡è®°ç›®å½•ï¼ŒæŒ‡å‘å½“å‰ä½¿ç”¨çš„çƒ­æ›´æ–°ç‰ˆæœ¬ç›®å½•ï¼ˆå¦‚é“¾æ¥åˆ° <code>versions/rn_v1.0.1</code>ï¼‰</td><td>å®¢æˆ·ç«¯åŠ è½½ RN èµ„æºæ—¶ï¼Œç›´æ¥è¯»å–è¯¥ç›®å½•ï¼Œç®€åŒ–ç‰ˆæœ¬åˆ‡æ¢é€»è¾‘</td></tr><tr><td>ä¸´æ—¶ç›®å½•</td><td><code>/data/data/[åº”ç”¨åŒ…å]/rn_update/tmp/</code></td><td>å­˜æ”¾ä¸‹è½½ä¸­çš„è¡¥ä¸åŒ…ã€è§£å‹ä¸´æ—¶æ–‡ä»¶</td><td>é¿å…ä¸‹è½½ / è§£å‹è¿‡ç¨‹ä¸­å½±å“å½“å‰ä½¿ç”¨çš„èµ„æº</td></tr></tbody></table>
<h5 data-id="heading-18">æƒé™é…ç½®ä¸ç›®å½•åˆ›å»º</h5>
<ul>
<li>æ— éœ€é¢å¤–ç”³è¯·æƒé™ï¼š<code>/data/data/[åº”ç”¨åŒ…å]</code> æ˜¯åº”ç”¨ç§æœ‰ç›®å½•ï¼Œé»˜è®¤æœ‰è¯»å†™æƒé™ï¼›è‹¥ <code>targetSdkVersion â‰¥ 29</code>ï¼Œé¿å…ä½¿ç”¨å¤–éƒ¨å­˜å‚¨ï¼ˆå¦‚ <code>/sdcard/</code>ï¼‰å­˜æ”¾çƒ­æ›´æ–°èµ„æºï¼Œé˜²æ­¢æƒé™å’Œå®‰å…¨é£é™©ã€‚</li>
<li>åˆå§‹åŒ–ç›®å½•ï¼šåœ¨å®¢æˆ·ç«¯åˆå§‹åŒ–æ—¶æ‰§è¡Œ <code>mkdirs()</code> æ–¹æ³•ï¼Œåˆ›å»º <code>rn_update/</code> åŠå…¶å­ç›®å½•ï¼Œé¿å…ä¸‹è½½/è§£å‹æ—¶å› ç›®å½•ä¸å­˜åœ¨å¤±è´¥ã€‚</li>
</ul>
<h5 data-id="heading-19">ç›®å½•è®¿é—®ç¤ºä¾‹ä»£ç </h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è·å–åº”ç”¨ç§æœ‰ç›®å½•çš„ rn_update è·¯å¾„</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">getRnUpdateDir</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// context ä¸º Application æˆ– Activity ä¸Šä¸‹æ–‡</span>
    <span class="hljs-type">File</span> <span class="hljs-variable">appDir</span> <span class="hljs-operator">=</span> context.getFilesDir(); <span class="hljs-comment">// å¯¹åº” /data/data/[åŒ…å]/files</span>
    <span class="hljs-type">File</span> <span class="hljs-variable">rnUpdateDir</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(appDir, <span class="hljs-string">"rn_update"</span>);
    <span class="hljs-keyword">if</span> (!rnUpdateDir.exists()) {
        rnUpdateDir.mkdirs(); <span class="hljs-comment">// è‹¥ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ›å»ºç›®å½•</span>
    }
    <span class="hljs-keyword">return</span> rnUpdateDir.getAbsolutePath();
}

<span class="hljs-comment">// è·å–å½“å‰ä½¿ç”¨çš„ RN Bundle è·¯å¾„ï¼ˆä¼˜å…ˆçƒ­æ›´æ–°ï¼Œæ— åˆ™ç”¨åŸºç¡€èµ„æºï¼‰</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">getCurrentRnBundlePath</span><span class="hljs-params">()</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">hotUpdateBundlePath</span> <span class="hljs-operator">=</span> getRnUpdateDir() + <span class="hljs-string">"/current/index.android.bundle"</span>;
    <span class="hljs-type">File</span> <span class="hljs-variable">hotUpdateBundle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(hotUpdateBundlePath);
    <span class="hljs-keyword">if</span> (hotUpdateBundle.exists()) {
        <span class="hljs-keyword">return</span> hotUpdateBundlePath;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// çƒ­æ›´æ–°èµ„æºä¸å­˜åœ¨ï¼Œè¿”å›åŸç”Ÿé¢„ç½®çš„åŸºç¡€ Bundle è·¯å¾„ï¼ˆassets ç›®å½•ä¸‹ï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"asset:///rn_bundle/base/index.android.bundle"</span>;
    }
}
</code></pre>
<h3 data-id="heading-20">3.3 iOS ç«¯å‰ç½®å‡†å¤‡</h3>
<h4 data-id="heading-21">ï¼ˆ1ï¼‰åŸºç¡€èµ„æºç”Ÿæˆï¼ˆåŸç”Ÿé¢„ç½® RN èµ„æºï¼‰</h4>
<p>åŸºç¡€èµ„æºæ˜¯åŸç”Ÿé¡¹ç›®æ‰“åŒ…æ—¶é¢„ç½®çš„åˆå§‹ RN èµ„æºï¼ˆå« JS Bundle å’Œé™æ€èµ„æºï¼‰ï¼Œä½œä¸ºçƒ­ä¿®å¤çš„â€œåŸºå‡†èµ„æºâ€ï¼Œéœ€æŒ‰ä»¥ä¸‹æ­¥éª¤ç”Ÿæˆå¹¶å¯¼å…¥ï¼š</p>
<h5 data-id="heading-22">æ­¥éª¤ 1ï¼šæ‰§è¡Œæ‰“åŒ…å‘½ä»¤</h5>
<p>åœ¨ RN ä¸šåŠ¡é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ iOS ç«¯çš„åŸºç¡€ JS Bundle å’Œé™æ€èµ„æºï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">  # </span><span class="bash">ç”Ÿæˆ iOS åŸºç¡€ JS Bundle å’Œé™æ€èµ„æº</span>
  npx react-native bundle \
  --platform ios \          # æŒ‡å®šå¹³å°ä¸º iOS
  --entry-file index.js \   # RN å…¥å£æ–‡ä»¶
  --bundle-output ./ios_base_bundle/index.ios.bundle \  # è¾“å‡ºçš„ JS Bundle è·¯å¾„ï¼ˆæœ¬åœ°ä¸´æ—¶ç›®å½•ï¼‰
  --assets-dest ./ios_base_bundle/res \  # è¾“å‡ºçš„é™æ€èµ„æºè·¯å¾„
  --dev false \             # å…³é—­å¼€å‘æ¨¡å¼
  --minify true \           # å¼€å¯ä»£ç å‹ç¼©
  --reset-cache             # é‡ç½®ç¼“å­˜
</code></pre>
<h5 data-id="heading-23">æ­¥éª¤ 2ï¼šå°†èµ„æºå¯¼å…¥åŸç”Ÿé¡¹ç›®</h5>
<ol>
<li>æ‰“å¼€ iOS åŸç”Ÿé¡¹ç›®çš„ <code>.xcodeproj</code> æˆ– <code>.xcworkspace</code> æ–‡ä»¶ï¼ˆé€šè¿‡ Xcodeï¼‰ï¼›</li>
<li>åœ¨ Xcode å·¦ä¾§ â€œé¡¹ç›®å¯¼èˆªæ â€ ä¸­ï¼Œå³é”®ç‚¹å‡»é¡¹ç›®åç§°ï¼Œé€‰æ‹©ã€ŒAdd Files to "é¡¹ç›®å"ã€ï¼›</li>
<li>é€‰ä¸­æ­¥éª¤ 1 ä¸­ç”Ÿæˆçš„ <code>index.ios.bundle</code> æ–‡ä»¶å’Œ <code>res</code> ç›®å½•ï¼Œå‹¾é€‰ã€ŒCopy items if neededã€å’Œã€ŒCreate groupsã€ï¼Œç‚¹å‡»ã€ŒAddã€ï¼›</li>
<li>åœ¨é¡¹ç›®ä¸­æ–°å»º <code>rn_bundle/base</code> åˆ†ç»„ï¼ˆå¯é€‰ï¼Œç”¨äºå½’ç±»èµ„æºï¼‰ï¼Œå°†å¯¼å…¥çš„ <code>index.ios.bundle</code> å’Œ <code>res</code> ç›®å½•æ‹–å…¥è¯¥åˆ†ç»„ï¼Œç¡®ä¿èµ„æºåœ¨ã€ŒBuild Phases -&gt; Copy Bundle Resourcesã€ä¸­å·²å‹¾é€‰ï¼ˆè‹¥æœªå‹¾é€‰ï¼Œéœ€æ‰‹åŠ¨æ·»åŠ ï¼Œå¦åˆ™æ‰“åŒ…æ—¶èµ„æºä¸ä¼šè¢«åŒ…å«ï¼‰ã€‚</li>
</ol>
<h5 data-id="heading-24">æ­¥éª¤ 3ï¼šèµ„æºéªŒè¯</h5>
<p>é€šè¿‡ Xcode è¿è¡Œé¡¹ç›®ï¼Œç¡®è®¤ RN é¡µé¢æ— èµ„æºåŠ è½½é”™è¯¯ï¼ˆå¯æŸ¥çœ‹ Xcode æ§åˆ¶å°ï¼Œæ—  <code>Unable to resolve module</code> ç­‰æŠ¥é”™ï¼‰ã€‚</p>
<h4 data-id="heading-25">ï¼ˆ2ï¼‰ç›®å½•è§„åˆ’ï¼ˆèµ„æºå­˜å‚¨è·¯å¾„æ ‡å‡†åŒ–ï¼‰</h4>
<p>æ˜ç¡®â€œåŸç”Ÿé¢„ç½®èµ„æºâ€å’Œâ€œçƒ­æ›´æ–°èµ„æºâ€çš„å­˜å‚¨è·¯å¾„ï¼Œç¡®ä¿çƒ­ä¿®å¤æ¨¡å—èƒ½å‡†ç¡®è®¿é—®èµ„æºï¼Œä¸”ç¬¦åˆ iOS æ–‡ä»¶æƒé™è§„èŒƒï¼š</p>
<h5 data-id="heading-26">æ ¸å¿ƒåŸåˆ™</h5>
<ul>
<li><strong>åŸç”Ÿé¢„ç½®èµ„æº</strong>ï¼šå­˜æ”¾åœ¨ <code>Main Bundle</code>ï¼ˆåªè¯»ï¼‰ï¼Œåº”ç”¨å®‰è£…åä¸å¯ä¿®æ”¹ï¼Œä½œä¸ºçƒ­ä¿®å¤åŸºå‡†ï¼›</li>
<li><strong>çƒ­æ›´æ–°èµ„æº</strong>ï¼šå­˜æ”¾åœ¨ <code>Documents</code> ç›®å½•ï¼ˆåº”ç”¨ç§æœ‰å¯è¯»å†™ï¼‰ï¼Œä¿éšœå®‰å…¨æ€§ä¸å¯ä¿®æ”¹æ€§ã€‚</li>
</ul>
<h5 data-id="heading-27">è¯¦ç»†ç›®å½•è§„åˆ’</h5>









































<table><thead><tr><th>èµ„æºç±»å‹</th><th>å­˜å‚¨è·¯å¾„</th><th>æƒé™è¯´æ˜</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>åŸç”Ÿé¢„ç½®èµ„æº</td><td><code>Main Bundle/rn_bundle/base/</code>ï¼ˆå³ <code>[[NSBundle mainBundle] pathForResource:@"rn_bundle/base" ofType:nil]</code>ï¼‰</td><td>åªè¯»ï¼ˆåº”ç”¨å®‰è£…åä¸å¯ä¿®æ”¹ï¼‰</td><td>å­˜æ”¾åˆå§‹ JS Bundleï¼ˆ<code>index.ios.bundle</code>ï¼‰å’Œåˆå§‹é™æ€èµ„æºï¼ˆ<code>res/</code>ï¼‰</td></tr><tr><td>çƒ­æ›´æ–°èµ„æº</td><td><code>Documents/rn_update/</code>ï¼ˆå³ <code>[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject]/rn_update/</code>ï¼‰</td><td>åº”ç”¨ç§æœ‰å¯è¯»å†™ï¼ˆä»…å½“å‰åº”ç”¨å¯è®¿é—®ï¼ŒiCloud å¯èƒ½è‡ªåŠ¨å¤‡ä»½ï¼Œéœ€é…ç½®æ’é™¤ï¼‰</td><td>å­˜æ”¾ä¸‹è½½çš„çƒ­ä¿®å¤è¡¥ä¸åŒ…ã€è§£å‹åçš„æ–° JS Bundle å’Œæ–°é™æ€èµ„æº</td></tr><tr><td>çƒ­æ›´æ–°å­ç›®å½•</td><td><code>Documents/rn_update/versions/</code></td><td>ç‰ˆæœ¬ç®¡ç†ç›®å½•ï¼ŒæŒ‰ RN ç‰ˆæœ¬å·åˆ›å»ºå­ç›®å½•ï¼ˆå¦‚ <code>rn_v1.0.1/</code>ï¼‰</td><td>æ¯ä¸ªç‰ˆæœ¬çš„èµ„æºå•ç‹¬å­˜æ”¾ï¼Œä¾¿äºå›æ»š</td></tr><tr><td>çƒ­æ›´æ–°å½“å‰ç‰ˆæœ¬</td><td><code>Documents/rn_update/current/</code></td><td>è½¯é“¾æ¥ç›®å½•ï¼ŒæŒ‡å‘å½“å‰ä½¿ç”¨çš„çƒ­æ›´æ–°ç‰ˆæœ¬ç›®å½•</td><td>å®¢æˆ·ç«¯åŠ è½½ RN èµ„æºæ—¶ï¼Œç›´æ¥è¯»å–è¯¥ç›®å½•ï¼Œç®€åŒ–ç‰ˆæœ¬åˆ‡æ¢é€»è¾‘</td></tr><tr><td>ä¸´æ—¶ç›®å½•</td><td><code>Documents/rn_update/tmp/</code></td><td>å­˜æ”¾ä¸‹è½½ä¸­çš„è¡¥ä¸åŒ…ã€è§£å‹ä¸´æ—¶æ–‡ä»¶</td><td>é¿å…ä¸‹è½½ / è§£å‹è¿‡ç¨‹ä¸­å½±å“å½“å‰ä½¿ç”¨çš„èµ„æº</td></tr></tbody></table>
<h5 data-id="heading-28">ç‰¹æ®Šé…ç½®</h5>
<ul>
<li>æ’é™¤ iCloud å¤‡ä»½ï¼šè‹¥ä¸å¸Œæœ›çƒ­æ›´æ–°èµ„æºè¢« iCloud å¤‡ä»½ï¼ˆé¿å…å ç”¨ç”¨æˆ· iCloud ç©ºé—´ï¼‰ï¼Œéœ€åœ¨ <code>Info.plist</code> ä¸­æ·»åŠ  <code>NSURLIsExcludedFromBackupKey</code> å¹¶è®¾ä¸º <code>YES</code>ï¼Œæˆ–é€šè¿‡ä»£ç è®¾ç½®ç›®å½•å±æ€§ï¼š</li>
</ul>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä¸º rn_update ç›®å½•è®¾ç½®ä¸å¤‡ä»½åˆ° iCloud</span>
NSURL *rnUpdateUrl = [NSURL fileURLWithPath:[documentsPath stringByAppendingPathComponent:@<span class="hljs-string">"rn_update"</span>]];
[rnUpdateUrl setResourceValue:@YES forKey:NSURLIsExcludedFromBackupKey error:nil];
</code></pre>
<ul>
<li>åˆå§‹åŒ–ç›®å½•ï¼šåœ¨å®¢æˆ·ç«¯åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡ <code>NSFileManager</code> åˆ›å»º <code>rn_update/</code> åŠå…¶å­ç›®å½•ï¼Œé¿å…å› ç›®å½•ä¸å­˜åœ¨å¯¼è‡´ä¸‹è½½ / è§£å‹å¤±è´¥ã€‚</li>
</ul>
<h5 data-id="heading-29">ç›®å½•è®¿é—®ç¤ºä¾‹ä»£ç </h5>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// è·å– Documents/rn_update ç›®å½•è·¯å¾„</span>
- (NSString *)getRnUpdateDir {
    NSString *documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject];
    NSString *rnUpdateDir = [documentsPath stringByAppendingPathComponent:@<span class="hljs-string">"rn_update"</span>];
    <span class="hljs-comment">// æ£€æŸ¥å¹¶åˆ›å»ºç›®å½•</span>
    NSFileManager *fileManager = [NSFileManager defaultManager];
    <span class="hljs-keyword">if</span> (![fileManager fileExistsAtPath:rnUpdateDir]) {
        [fileManager createDirectoryAtPath:rnUpdateDir withIntermediateDirectories:YES attributes:nil error:nil];
    }
    <span class="hljs-keyword">return</span> rnUpdateDir;
}

<span class="hljs-comment">// è·å–å½“å‰ä½¿ç”¨çš„ RN Bundle è·¯å¾„ï¼ˆä¼˜å…ˆçƒ­æ›´æ–°ï¼Œæ— åˆ™ç”¨åŸºç¡€èµ„æºï¼‰</span>
- (NSString *)getCurrentRnBundlePath {
    NSString *rnUpdateDir = [self getRnUpdateDir];
    NSString *hotUpdateBundlePath = [rnUpdateDir stringByAppendingPathComponent:@<span class="hljs-string">"current/index.ios.bundle"</span>];
    <span class="hljs-keyword">if</span> ([[NSFileManager defaultManager] fileExistsAtPath:hotUpdateBundlePath]) {
        <span class="hljs-keyword">return</span> hotUpdateBundlePath;
    } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// çƒ­æ›´æ–°èµ„æºä¸å­˜åœ¨ï¼Œè¿”å›åŸç”Ÿé¢„ç½®çš„åŸºç¡€ Bundle è·¯å¾„ï¼ˆMain Bundle ä¸‹ï¼‰</span>
        <span class="hljs-keyword">return</span> [[NSBundle mainBundle] pathForResource:@<span class="hljs-string">"rn_bundle/base/index.ios"</span> ofType:@<span class="hljs-string">"bundle"</span>];
    }
}
</code></pre>
<h3 data-id="heading-30">å››ã€æœåŠ¡ç«¯å®ç°</h3>
<h4 data-id="heading-31">1. æ•°æ®åº“è®¾è®¡</h4>
<h5 data-id="heading-32">æ ¸å¿ƒè¡¨ç»“æ„</h5>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `rn_app` (
  `id` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">'ä¸»é”®ID'</span>,
  `title` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">''</span> COMMENT <span class="hljs-string">'åç§°'</span>,
  `key` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">''</span> COMMENT <span class="hljs-string">'å¯†é’¥'</span>,
  `bundleid` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">''</span> COMMENT <span class="hljs-string">'bundleid'</span>,
  `remark` text COMMENT <span class="hljs-string">'å¤‡æ³¨'</span>,
  `state` tinyint <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'1'</span> COMMENT <span class="hljs-string">'çŠ¶æ€,1ä½¿ç”¨ä¸­ï¼Œ-1å·²åˆ é™¤'</span>,
  `createdAt` datetime <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `updatedAt` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `uid` <span class="hljs-type">varchar</span>(<span class="hljs-number">36</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å¹³å°ç”¨æˆ·ID'</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
  KEY `rn_app_uid_index` (`uid`)
) ENGINE<span class="hljs-operator">=</span>InnoDB AUTO_INCREMENT<span class="hljs-operator">=</span><span class="hljs-number">18</span> <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4 <span class="hljs-keyword">COLLATE</span><span class="hljs-operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="hljs-operator">=</span><span class="hljs-string">'åº”ç”¨åˆ—è¡¨'</span>

<span class="hljs-comment">--æ•°æ®åº“åˆ†æ”¯è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `rn_app_patch` (
  `id` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">'ä¸»é”®ID'</span>,
  `title` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">''</span> COMMENT <span class="hljs-string">'åç§°'</span>,
  `app_id` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æŒ‡å®šåº”ç”¨ID'</span>,
  `app_code` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æŒ‡å®šæ›´æ–°åº”ç”¨ç‰ˆæœ¬code/version,å¤šä¸ªç‰ˆæœ¬ç”¨é€—å·åˆ†éš”'</span>,
  `app_count` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span> COMMENT <span class="hljs-string">'æ¿€æ´»æ•°'</span>,
  `patch_size` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span> COMMENT <span class="hljs-string">'è¡¥ä¸å¤§å°'</span>,
  `patch_version` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è¡¥ä¸ç‰ˆæœ¬å·'</span>,
  `rule` tinyint <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span> COMMENT <span class="hljs-string">'è§„åˆ™ï¼Œ0å¼€å‘ï¼Œ1å…¨é‡ï¼Œ2æŒ‡å®šç”¨æˆ·'</span>,
  `encrypt` tinyint <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span> COMMENT <span class="hljs-string">'æ˜¯å¦åŠ å¯†,0æ²¡æœ‰ï¼Œ1åŠ å¯†'</span>,
  `release_time` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span> COMMENT <span class="hljs-string">'å‘å¸ƒæ—¶é—´'</span>,
  `encryption` <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'åŠ å¯†ï¼š0åç«¯åŠ å¯†ï¼Œ1aesåŠ å¯†'</span>,
  `remark` text COMMENT <span class="hljs-string">'å¤‡æ³¨'</span>,
  `state` tinyint <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span> COMMENT <span class="hljs-string">'çŠ¶æ€,1ä¸‹å‘ä¸­ï¼Œ-1å·²æ’¤å›'</span>,
  `content` text COMMENT <span class="hljs-string">'ä¸‹è½½åœ°å€'</span>,
  `uid` <span class="hljs-type">varchar</span>(<span class="hljs-number">36</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æ“ä½œäººid'</span>,
  `createdAt` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `updatedAt` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
  KEY `rn_app_patch_uid_index` (`uid`)
) ENGINE<span class="hljs-operator">=</span>InnoDB AUTO_INCREMENT<span class="hljs-operator">=</span><span class="hljs-number">22</span> <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4 <span class="hljs-keyword">COLLATE</span><span class="hljs-operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="hljs-operator">=</span><span class="hljs-string">'RNåº”ç”¨è¡¥ä¸ç®¡ç†è¡¨'</span>

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `rn_app_patch_user` (
  `id` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,
  `userid` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æŒ‡å®šæ›´æ–°ç”¨æˆ·ID'</span>,
  `patch_id` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'åº”ç”¨è¡¥ä¸ID'</span>,
  `status` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'1=éœ€è¦æ›´æ–° 2=æ›´æ–°å®Œæˆ 3=æ’¤é”€æŒ‡å®šæ›´æ–°'</span>,
  `createdAt` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>,
  `updatedAt` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æ›´æ–°æ—¶é—´'</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
  KEY `t_patch_user_userid_index` (`userid`),
  KEY `rn_app_patch_user_userid_index` (`userid`)
) ENGINE<span class="hljs-operator">=</span>InnoDB AUTO_INCREMENT<span class="hljs-operator">=</span><span class="hljs-number">11</span> <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4 <span class="hljs-keyword">COLLATE</span><span class="hljs-operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="hljs-operator">=</span><span class="hljs-string">'æŒ‡å®šç”¨æˆ·ä¸è¡¥ä¸ç‰ˆæœ¬å…³ç³»è¡¨'</span>
</code></pre>
<h4 data-id="heading-33">2. æ ¸å¿ƒæ¥å£è®¾è®¡</h4>
<h5 data-id="heading-34">(1). è·å–è¡¥ä¸åˆ—è¡¨</h5>
<p><strong>è¯·æ±‚æ–¹å¼</strong>: <code>GET</code>
<strong>æ¥å£URL</strong>: <code>/api/patchs/list</code>
<strong>åŠŸèƒ½æè¿°</strong>: è·å–è¡¥ä¸åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œå¤šæ¡ä»¶æœç´¢</p>
<p><strong>è¯·æ±‚å‚æ•°</strong> (Query):</p>

































































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>æè¿°</th></tr></thead><tbody><tr><td>pageindex</td><td>number</td><td>å¦</td><td>é¡µç ï¼Œé»˜è®¤1</td></tr><tr><td>title</td><td>string</td><td>å¦</td><td>è¡¥ä¸æ ‡é¢˜ï¼Œæ”¯æŒæ¨¡ç³Šæœç´¢</td></tr><tr><td>app_id</td><td>number</td><td>å¦</td><td>åº”ç”¨ID</td></tr><tr><td>app_code</td><td>string</td><td>å¦</td><td>åº”ç”¨ç‰ˆæœ¬codeï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¯æŒé€—å·åˆ†éš”çš„å¤šä¸ªåº”ç”¨ç‰ˆæœ¬codeï¼‰</td></tr><tr><td>patch_version</td><td>string</td><td>å¦</td><td>è¡¥ä¸ç‰ˆæœ¬å·</td></tr><tr><td>state</td><td>number</td><td>å¦</td><td>è¡¥ä¸çŠ¶æ€ï¼š-1(å·²æ’¤å›)ã€0(è‰ç¨¿)ã€1(ä¸‹å‘ä¸­)</td></tr><tr><td>uid</td><td>string</td><td>å¦</td><td>åˆ›å»ºäººID</td></tr><tr><td>startDate</td><td>string</td><td>å¦</td><td>å¼€å§‹æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD</td></tr><tr><td>endDate</td><td>string</td><td>å¦</td><td>ç»“æŸæ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD</td></tr></tbody></table>
<p><strong>å“åº”ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"list"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¿®å¤ç™»å½•é—®é¢˜"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"app_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"app_code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1001,1002"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"patch_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.1"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"patch_size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5.2</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"rule"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"encrypt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"release_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1635734400000</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"remark"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¿®å¤ç™»å½•å¤±è´¥é—®é¢˜"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"app_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">156</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"uid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"admin"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"createdAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-11-01T00:00:00.000Z"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"updatedAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-11-02T00:00:00.000Z"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"total"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"page"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pages"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h5 data-id="heading-35">(2). åˆ›å»ºè¡¥ä¸</h5>
<p><strong>è¯·æ±‚æ–¹å¼</strong>: <code>POST</code>
<strong>æ¥å£URL</strong>: <code>/api/patchs/add</code>
<strong>åŠŸèƒ½æè¿°</strong>: åˆ›å»ºæ–°çš„è¡¥ä¸è®°å½•</p>
<p><strong>è¯·æ±‚å‚æ•°</strong> (JSONæ ¼å¼):</p>







































































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>æè¿°</th></tr></thead><tbody><tr><td>title</td><td>string</td><td>æ˜¯</td><td>è¡¥ä¸æ ‡é¢˜ï¼Œæœ€å¤§é•¿åº¦255</td></tr><tr><td>app_id</td><td>number</td><td>æ˜¯</td><td>åº”ç”¨ID</td></tr><tr><td>app_code</td><td>string</td><td>å¦</td><td>åº”ç”¨ç‰ˆæœ¬codeï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¯æŒé€—å·åˆ†éš”çš„å¤šä¸ªåº”ç”¨ç‰ˆæœ¬codeï¼‰</td></tr><tr><td>patch_version</td><td>string</td><td>æ˜¯</td><td>è¡¥ä¸ç‰ˆæœ¬å·ï¼Œæ ¼å¼å¦‚ï¼š1.0.0ï¼Œæœ€å¤§é•¿åº¦50</td></tr><tr><td>rule</td><td>number</td><td>å¦</td><td>è§„åˆ™ç±»å‹ï¼š0(å¼€å‘ç‰ˆ)ã€1(å…¨é‡)ã€2(æŒ‡å®šç”¨æˆ·)ã€3(æ‰§è¡Œç‰ˆæœ¬æ›´æ–°)ï¼Œé»˜è®¤0</td></tr><tr><td>encrypt</td><td>number</td><td>å¦</td><td>æ˜¯å¦åŠ å¯†ï¼š0(ä¸åŠ å¯†)ã€1(åŠ å¯†)ï¼Œé»˜è®¤0</td></tr><tr><td>release_time</td><td>number</td><td>å¦</td><td>å‘å¸ƒæ—¶é—´æˆ³ï¼Œé»˜è®¤å½“å‰æ—¶é—´</td></tr><tr><td>encryption</td><td>string</td><td>å¦</td><td>åŠ å¯†å†…å®¹ï¼Œå½“encrypt=1æ—¶å¿…å¡«</td></tr><tr><td>remark</td><td>string</td><td>å¦</td><td>å¤‡æ³¨ä¿¡æ¯</td></tr><tr><td>content</td><td>string</td><td>æ˜¯</td><td>è¡¥ä¸å†…å®¹</td></tr></tbody></table>
<p><strong>è¯·æ±‚ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¿®å¤é¦–é¡µç™½å±é—®é¢˜"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"app_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"patch_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.2"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"rule"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"encrypt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"remark"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¿®å¤é¦–é¡µåŠ è½½æ—¶çš„ç™½å±é—®é¢˜"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"function fixHomePage() { console.log('Fixed'); }"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å“åº”ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¿®å¤é¦–é¡µç™½å±é—®é¢˜"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"app_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"app_code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1001,1002"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"patch_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"patch_size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1.5</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"rule"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"encrypt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"release_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1635820800000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"encryption"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"remark"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¿®å¤é¦–é¡µåŠ è½½æ—¶çš„ç™½å±é—®é¢˜"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"function fixHomePage() { console.log('Fixed'); }"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"app_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"uid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"admin"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"createdAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-11-02T00:00:00.000Z"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"updatedAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-11-02T00:00:00.000Z"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h5 data-id="heading-36">(3). æ ¹æ®æ¡ä»¶æŸ¥è¯¢è¡¥ä¸ä¿¡æ¯</h5>
<p><strong>è¯·æ±‚æ–¹å¼</strong>: <code>GET</code>
<strong>æ¥å£URL</strong>: <code>/api/patchs/query</code>
<strong>åŠŸèƒ½æè¿°</strong>: æ ¹æ®ä¸åŒæ¡ä»¶æŸ¥è¯¢è¡¥ä¸ä¿¡æ¯ï¼Œæ”¯æŒä¸‰ç§æŸ¥è¯¢é€»è¾‘ï¼š1) æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢è¯¥ç”¨æˆ·çš„æœ€é«˜ç‰ˆæœ¬è¡¥ä¸ 2) æ ¹æ®åº”ç”¨IDã€åº”ç”¨ç‰ˆæœ¬codeå’Œå½“å‰è¡¥ä¸ç‰ˆæœ¬æŸ¥è¯¢æ›´é«˜ç‰ˆæœ¬è¡¥ä¸ 3) æ ¹æ®åº”ç”¨IDå’Œåº”ç”¨ç‰ˆæœ¬codeæŸ¥è¯¢è¯¥åº”ç”¨çš„æœ€æ–°ç‰ˆæœ¬è¡¥ä¸</p>
<p><strong>è®¤è¯è¦æ±‚</strong>: æ— éœ€è®¤è¯</p>
<p><strong>è¯·æ±‚å‚æ•°</strong> (Query):</p>



































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>æè¿°</th></tr></thead><tbody><tr><td>userid</td><td>number</td><td>å¦</td><td>ç”¨æˆ·IDï¼Œå½“æ­¤å‚æ•°å­˜åœ¨æ—¶ï¼Œå°†æŸ¥è¯¢è¯¥ç”¨æˆ·æŒ‡å®šæœ€é«˜ç‰ˆæœ¬</td></tr><tr><td>app_id</td><td>number</td><td>æ˜¯</td><td>åº”ç”¨IDï¼Œæ­¤å‚æ•°ä¸ºå¿…å¡«ï¼Œå®¢æˆ·ç«¯å›ºå®šå‚æ•°</td></tr><tr><td>app_code</td><td>string</td><td>å¦</td><td>åº”ç”¨ç‰ˆæœ¬code/version,å¤šä¸ªç‰ˆæœ¬ç”¨é€—å·åˆ†éš”</td></tr><tr><td>patch_version</td><td>string</td><td>å¦</td><td>å½“å‰è¡¥ä¸ç‰ˆæœ¬å·ï¼Œå½“æŒ‡å®šæ—¶æŸ¥è¯¢æ¯”æ­¤ç‰ˆæœ¬æ›´é«˜çš„è¡¥ä¸</td></tr></tbody></table>
<p><strong>æŸ¥è¯¢é€»è¾‘è¯´æ˜</strong>:</p>
<ul>
<li>é€»è¾‘1ï¼šé¦–å…ˆæŸ¥è¯¢æŒ‡å®šç”¨æˆ·å·²æ›´æ–°/æ›´æ–°å®Œæˆçš„æœ€é«˜ç‰ˆæœ¬è¡¥ä¸</li>
<li>é€»è¾‘2ï¼šè‹¥æœªæ‰¾åˆ°ï¼ŒæŸ¥è¯¢æ»¡è¶³app_idã€app_codeã€patch_versionä¸”çŠ¶æ€ä¸ºå¾…æ›´æ–°æˆ–å·²æ›´æ–°çš„æœ€é«˜ç‰ˆæœ¬</li>
<li>é€»è¾‘3ï¼šè‹¥ä»æœªæ‰¾åˆ°ï¼Œä»…æŒ‰app_idæŸ¥è¯¢æœ€é«˜ç‰ˆæœ¬è¡¥ä¸</li>
</ul>
<p><strong>å“åº”ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>  
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>  
  <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span>  
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>  
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¿®å¤ç™»å½•é—®é¢˜"</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"app_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"app_code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1001,1002"</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"patch_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.1"</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"patch_size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5.2</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"rule"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"encrypt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"release_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1635734400000</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"encryption"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"remark"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¿®å¤ç™»å½•å¤±è´¥é—®é¢˜"</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"function fixLogin() { return true; }"</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"app_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">156</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"uid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"admin"</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"createdAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-11-01T00:00:00.000Z"</span><span class="hljs-punctuation">,</span>  
    <span class="hljs-attr">"updatedAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-11-02T00:00:00.000Z"</span>  
  <span class="hljs-punctuation">}</span>  
<span class="hljs-punctuation">}</span>

**è¯·æ±‚å‚æ•°** (JSONæ ¼å¼)<span class="hljs-punctuation">:</span>
å¯¼å…¥çš„JSONæ•°æ®ç»“æ„ä¸è¡¥ä¸è¯¦æƒ…ç›¸åŒï¼Œä½†å¯¼å…¥åä¼šé‡ç½®æ¿€æ´»æ•°å¹¶è®¾ç½®ä¸ºè‰ç¨¿çŠ¶æ€ã€‚

**è¯·æ±‚ç¤ºä¾‹**<span class="hljs-punctuation">:</span>
```json
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¯¼å…¥çš„è¡¥ä¸"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"app_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"patch_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.3"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"rule"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"encrypt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"remark"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä»å…¶ä»–ç³»ç»Ÿå¯¼å…¥"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"function importedPatch() { return true; }"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å“åº”ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¯¼å…¥çš„è¡¥ä¸"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"app_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"app_code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1001,1002"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"patch_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"patch_size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1.2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"rule"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"encrypt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"release_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1635907200000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"encryption"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"remark"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä»å…¶ä»–ç³»ç»Ÿå¯¼å…¥"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// å¯¼å…¥çš„è¡¥ä¸é»˜è®¤ä¸ºè‰ç¨¿çŠ¶æ€</span>
    <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"function importedPatch() { return true; }"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"app_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"uid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"admin"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"createdAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-11-03T00:00:00.000Z"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"updatedAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-11-03T00:00:00.000Z"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-37">é”™è¯¯ç è¯´æ˜</h3>





























<table><thead><tr><th>é”™è¯¯ç </th><th>æè¿°</th></tr></thead><tbody><tr><td>400</td><td>è¯·æ±‚å‚æ•°é”™è¯¯</td></tr><tr><td>403</td><td>æ²¡æœ‰æ“ä½œæƒé™ï¼Œå¦‚å·²æ’¤å›çš„è¡¥ä¸ä¸èƒ½ä¿®æ”¹</td></tr><tr><td>404</td><td>è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨</td></tr><tr><td>409</td><td>ç‰ˆæœ¬å·å†²çªï¼Œå¦‚é‡å¤çš„è¡¥ä¸ç‰ˆæœ¬å·</td></tr><tr><td>500</td><td>æœåŠ¡å™¨å†…éƒ¨é”™è¯¯</td></tr></tbody></table>
<h3 data-id="heading-38">äº”ã€ç®¡ç†åå°åŠŸèƒ½</h3>
<h4 data-id="heading-39">1. çƒ­æ›´åº”ç”¨æ·»åŠ åŠŸèƒ½</h4>
<p>åŠŸèƒ½æè¿°ï¼š</p>
<p>é’ˆå¯¹äºæŸä¸ªåº”ç”¨è¿›è¡Œçƒ­æ›´ï¼Œå¯ä»¥åˆ›å»ºAndroidåº”ç”¨å’ŒIosåº”ç”¨</p>
<p>é‡ç‚¹æ˜¯ä¸Šä¼ æ­£ç¡®çš„åŒ…åæˆ–è€…bundleIdï¼Œåç»­è¦é€šè¿‡è¿™ä¸ªå­—æ®µæ¥åŒºåˆ†è¡¥ä¸æ›´æ–°çš„åº”ç”¨ï¼Œäº¦æˆ–è€…å¯ä»¥ç”¨IDæ¥åŒºåˆ†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab262c9d353e48358b99f8bef6a92ec9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=7gwh%2F%2FlkE%2FXoJ7yR%2BSfxCrC4Cfs%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58c3d494fbcf4bf398e7de69ea4f1f55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=TSUhicMS08DudA7kqp7dqmAvTw8%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-40">2. ç”¨æˆ·ç®¡ç†æ¨¡å—è®¾è®¡ä¸å®ç°æ€»ç»“</h4>
<p>åŠŸèƒ½æè¿°ï¼š</p>
<p>å®ç°ç”¨æˆ·ä¿¡æ¯çš„å±•ç¤ºã€æœç´¢å’Œåˆ†é¡µåŠŸèƒ½ï¼Œæ”¯æŒå¤šç»´åº¦ç­›é€‰å’Œå¿«é€Ÿå®šä½ç”¨æˆ·ã€‚æä¾›å®Œæ•´çš„ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å’ŒæŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…ï¼Œç”¨æˆ·æ ‡ç¤ºå¯ä»¥æ˜¯ç”¨æˆ·åº”ç”¨ç™»é™†çš„UserIdï¼Œå¯ä»¥æ˜¯æ‰‹æœºå·ï¼Œå¯ä»¥æ˜¯æ‰‹æœºè®¾å¤‡ç ã€‚å®ç°åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ï¼Œä¸åŒè§’è‰²æ‹¥æœ‰ä¸åŒæ“ä½œæƒé™ã€‚</p>
<p>æŠ€æœ¯å®ç°ï¼š</p>
<ul>
<li>è¡¨æ ¼å±•ç¤ºç”¨æˆ·æ ¸å¿ƒä¿¡æ¯ï¼ˆIDã€ç”¨æˆ·åã€è§’è‰²ã€çŠ¶æ€ç­‰ï¼‰</li>
<li>é›†æˆæœç´¢å’Œç­›é€‰åŠŸèƒ½</li>
<li>åˆ†é¡µåŠ è½½ä¼˜åŒ–æ€§èƒ½</li>
<li>è¡¨å•éªŒè¯ç¡®ä¿æ•°æ®å®Œæ•´æ€§</li>
<li>æ“ä½œç¡®è®¤é˜²æ­¢è¯¯æ“ä½œ</li>
<li>å®æ—¶çŠ¶æ€åé¦ˆ</li>
<li>è§’è‰²-æƒé™æ˜ å°„é…ç½®</li>
<li>å‰ç«¯è·¯ç”±å®ˆå«</li>
<li>æ“ä½œçº§æƒé™æ§åˆ¶</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/401620ed9e544fa2bcf767428a0bdfbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=LwrAgvCantiXsf%2BOJ75yFad3GJw%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-41"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc15ad12b64b4426bf077441d226bfbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=D%2FX6v77PgyQfccUhgFhtv%2FZOFbY%3D" alt="" loading="lazy"/></h4>
<h4 data-id="heading-42">3. çƒ­æ›´è¡¥ä¸åˆ—è¡¨å±•ç¤ºé€»è¾‘</h4>
<p>åŠŸèƒ½æè¿°</p>
<ul>
<li>è¡¨æ ¼å±•ç¤ºå…³é”®ä¿¡æ¯ï¼šç‰ˆæœ¬å·ã€è§„åˆ™ç±»å‹ã€çŠ¶æ€ã€å‘å¸ƒæ—¶é—´</li>
<li>çŠ¶æ€å¯è§†åŒ–ï¼šä½¿ç”¨æ ‡ç­¾é¢œè‰²åŒºåˆ†ä¸åŒçŠ¶æ€</li>
<li>è§„åˆ™ç±»å‹åŠ¨æ€å±•ç¤ºï¼šæŒ‡å®šç”¨æˆ·è§„åˆ™å¯ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</li>
</ul>
<p>ç—›ç‚¹1</p>
<ul>
<li>ç”¨æˆ·è¾“å…¥æ ¼å¼æ··ä¹±ï¼ˆå­—æ¯ã€ç‰¹æ®Šå­—ç¬¦ã€å¤šå°æ•°ç‚¹ï¼‰</li>
<li>ç‰ˆæœ¬æ®µé•¿åº¦ä¸ä¸€è‡´ï¼ˆ1.10.2 vs 1.1.2ï¼‰</li>
<li>ä¸­é—´çŠ¶æ€å¤„ç†ï¼ˆå¦‚"1."ã€"1.2."ï¼‰</li>
</ul>
<p>è§£å†³æ–¹æ¡ˆ</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åŒé‡æ§åˆ¶æœºåˆ¶</span>
<span class="hljs-title function_">handleVersionInput</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-comment">// 1. è¿‡æ»¤éæ³•å­—ç¬¦</span>
  <span class="hljs-keyword">let</span> val = value.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[^\d.]/g</span>, <span class="hljs-string">''</span>);

  <span class="hljs-comment">// 2. é˜²æ­¢è¿ç»­ç‚¹å’Œå¼€å¤´ç‚¹</span>
  val = val.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^\.|\.\./g</span>, <span class="hljs-string">''</span>);

  <span class="hljs-comment">// 3. æ™ºèƒ½åˆ†æ®µå¤„ç†</span>
  <span class="hljs-keyword">const</span> parts = val.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>);
  <span class="hljs-keyword">if</span> (parts.<span class="hljs-property">length</span> &gt; <span class="hljs-number">3</span>) parts.<span class="hljs-property">length</span> = <span class="hljs-number">3</span>; <span class="hljs-comment">// é™åˆ¶ä¸‰æ®µå¼</span>

  <span class="hljs-comment">// 4. æ¯æ®µåªå–ç¬¬ä¸€ä¸ªæ•°å­—</span>
  <span class="hljs-keyword">const</span> processed = parts.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">part</span> =&gt;</span> part.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>)).<span class="hljs-title function_">join</span>(<span class="hljs-string">'.'</span>);

  <span class="hljs-comment">// 5. ä¿ç•™åˆæ³•ä¸­é—´çŠ¶æ€</span>
  <span class="hljs-keyword">if</span> (value.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.'</span>) &amp;&amp; parts.<span class="hljs-property">length</span> &lt; <span class="hljs-number">3</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">publishForm</span>.<span class="hljs-property">version</span> = processed + <span class="hljs-string">'.'</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">publishForm</span>.<span class="hljs-property">version</span> = processed;
  }
},

<span class="hljs-comment">// æŒ‰é”®æ‹¦æˆªè¡¥å……</span>
<span class="hljs-title function_">handleVersionKeydown</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">// å…è®¸æ§åˆ¶é”®</span>
  <span class="hljs-keyword">if</span> ([<span class="hljs-string">'Backspace'</span>, <span class="hljs-string">'Delete'</span>, <span class="hljs-string">'ArrowLeft'</span>, <span class="hljs-string">'ArrowRight'</span>].<span class="hljs-title function_">includes</span>(e.<span class="hljs-property">key</span>)) <span class="hljs-keyword">return</span>;

  <span class="hljs-comment">// æ‹¦æˆªéæ³•å­—ç¬¦</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/\d|\./</span>.<span class="hljs-title function_">test</span>(e.<span class="hljs-property">key</span>)) {
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// ç‚¹å·ç‰¹æ®Šå¤„ç†</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'.'</span>) {
    <span class="hljs-keyword">const</span> current = <span class="hljs-variable language_">this</span>.<span class="hljs-property">publishForm</span>.<span class="hljs-property">version</span> || <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (current.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'.'</span>) &gt;= <span class="hljs-number">2</span> || current.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.'</span>)) {
      e.<span class="hljs-title function_">preventDefault</span>();
    }
  }
}
</code></pre>
<p>ç—›ç‚¹2ï¼š</p>
<ul>
<li>ç‰ˆæœ¬æ¯”è¾ƒé€»è¾‘å¤šæ¬¡å˜æ›´éœ€æ±‚</li>
<li>è¾¹ç•Œæƒ…å†µå¤„ç†ï¼ˆ1.10.0 vs 1.9.0ï¼‰</li>
<li>æ€§èƒ½é—®é¢˜ï¼ˆå¤§æ•°æ®é‡æ¯”è¾ƒï¼‰</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ ‡å‡†è¯­ä¹‰åŒ–ç‰ˆæœ¬æ¯”è¾ƒ</span>
<span class="hljs-title function_">compareVersions</span>(<span class="hljs-params">v1, v2</span>) {
  <span class="hljs-comment">// æ ‡å‡†åŒ–ç‰ˆæœ¬æ ¼å¼</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">normalize</span> = v =&gt; {
    <span class="hljs-keyword">const</span> parts = v.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);
    <span class="hljs-keyword">while</span> (parts.<span class="hljs-property">length</span> &lt; <span class="hljs-number">3</span>) parts.<span class="hljs-title function_">push</span>(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> parts;
  };

  <span class="hljs-keyword">const</span> v1Parts = <span class="hljs-title function_">normalize</span>(v1);
  <span class="hljs-keyword">const</span> v2Parts = <span class="hljs-title function_">normalize</span>(v2);

  <span class="hljs-comment">// é€çº§æ¯”è¾ƒ</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
    <span class="hljs-keyword">if</span> (v1Parts[i] &gt; v2Parts[i]) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (v1Parts[i] &lt; v2Parts[i]) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
},

<span class="hljs-comment">// é«˜æ•ˆå†²çªæ£€æµ‹</span>
<span class="hljs-title function_">hasVersionConflict</span>(<span class="hljs-params">newVersion</span>) {
  <span class="hljs-comment">// ä»…æ¯”è¾ƒæœ‰æ•ˆç‰ˆæœ¬</span>
  <span class="hljs-keyword">const</span> validVersions = <span class="hljs-variable language_">this</span>.<span class="hljs-property">patchList</span>
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">status</span> !== -<span class="hljs-number">1</span>) <span class="hljs-comment">// æ’é™¤å¤±æ•ˆç‰ˆæœ¬</span>
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">version</span>)
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> <span class="hljs-regexp">/^\d+\.\d+\.\d+$/</span>.<span class="hljs-title function_">test</span>(v)); <span class="hljs-comment">// è¿‡æ»¤æ— æ•ˆæ ¼å¼</span>

  <span class="hljs-comment">// ä½¿ç”¨someæå‰ç»ˆæ­¢éå†</span>
  <span class="hljs-keyword">return</span> validVersions.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> 
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">compareVersions</span>(v, newVersion) &gt;= <span class="hljs-number">0</span>
  );
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cca724ab629b4219ac401fbac2ce4c1e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=mXoXketVENAlaRY%2BSyzfi7h4lx4%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-43">4. æ™ºèƒ½ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h4>
<p>åŠŸèƒ½èƒŒæ™¯ï¼š</p>
<p>è¦æƒ³çƒ­æ›´ï¼Œé‚£ç‰ˆæœ¬æ ¡éªŒè‚¯å®šæ˜¯å¿…ä¸å¯å°‘çš„ä¸€ç¯ï¼Œå› ä¸ºè¿™ä¸ªåŠŸèƒ½å½“æ—¶è¿˜å¼€äº†nä¸ªbattleä¼šï¼Œè¿™ä½ å—å¾—äº†å—</p>
<p>åŠŸèƒ½æè¿°ï¼š</p>
<p>å®ç°ä¸¥æ ¼çš„è¡¥ä¸ç‰ˆæœ¬è¾“å…¥æ§åˆ¶ï¼ˆx.y.zæ ¼å¼ï¼‰ï¼Œå‰ç«¯é€šè¿‡å®æ—¶è¾“å…¥è¿‡æ»¤ç¡®ä¿æ ¼å¼æ­£ç¡®ã€‚ç³»ç»Ÿè‡ªåŠ¨è¿‡æ»¤éæ³•å­—ç¬¦ï¼Œé™åˆ¶è¾“å…¥æ ¼å¼ï¼Œå¹¶æä¾›å®æ—¶è§†è§‰åé¦ˆï¼Œåç«¯ä¹Ÿåšä¸€å±‚æ ¡éªŒï¼ŒåŒå±‚ä¿éšœã€‚</p>
<p>æŠ€æœ¯å®ç°ï¼š</p>
<ul>
<li>å‰ç«¯åŒæ ¡éªŒæœºåˆ¶ï¼šè¾“å…¥äº‹ä»¶è¿‡æ»¤ + æŒ‰é”®æ‹¦æˆª</li>
<li>æ™ºèƒ½åˆ†æ®µå¤„ç†ï¼šæ”¯æŒä¸­é—´çŠ¶æ€ï¼ˆå¦‚"1."ã€"1.2."ï¼‰</li>
<li>æ ¼å¼å®Œæ•´æ€§ä¿éšœï¼šæäº¤æ—¶è¿›è¡Œæ­£åˆ™éªŒè¯
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cf4d4a781ea403298b34487fc8b60a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=31uaK03coVbHUR%2Bz4PWvymKyyTg%3D" alt="" loading="lazy"/></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acf9fb6375204ef1a5421dd2afd27890~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=VWty1Bj0L1qTyIesCD%2FraFn8h04%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-44">5. ç‰ˆæœ¬æ™ºèƒ½æ¯”è¾ƒå¼•æ“</h4>
<p>åŠŸèƒ½æè¿°ï¼š</p>
<p>é˜²æ­¢ç”Ÿæˆä½ç‰ˆæœ¬è¡¥ä¸ï¼Œç¡®ä¿ç‰ˆæœ¬è¿­ä»£é¡ºåºæ­£ç¡®ã€‚ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹ç°æœ‰ç‰ˆæœ¬ï¼Œæ‹¦æˆªæ— æ•ˆæäº¤ï¼Œé¿å…ç‰ˆæœ¬æ··ä¹±ã€‚</p>
<p>æŠ€æœ¯å®ç°ï¼š</p>
<ul>
<li>æ ‡å‡†è¯­ä¹‰åŒ–ç‰ˆæœ¬æ¯”è¾ƒç®—æ³•</li>
<li>é«˜æ•ˆæ£€æµ‹æœºåˆ¶ï¼ˆO(n)å¤æ‚åº¦ï¼‰</li>
<li>æ˜ç¡®é”™è¯¯æç¤º</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è¾“å…¥å¤„ç†æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-title function_">handleVersionInput</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-comment">// 1. è¿‡æ»¤éæ³•å­—ç¬¦ï¼ˆåªä¿ç•™æ•°å­—å’Œç‚¹ï¼‰</span>
  <span class="hljs-keyword">let</span> val = value.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[^\d.]/g</span>, <span class="hljs-string">''</span>);

  <span class="hljs-comment">// 2. é˜²æ­¢è¿ç»­ç‚¹å’Œå¼€å¤´ç‚¹</span>
  val = val.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^\.|\.\./g</span>, <span class="hljs-string">''</span>);

  <span class="hljs-comment">// 3. æ›´æ–°å¤„ç†åçš„å€¼</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">publishForm</span>.<span class="hljs-property">version</span> = val;
}
</code></pre>
<h4 data-id="heading-45">6. ç²¾å‡†å‘å¸ƒæ§åˆ¶ç³»ç»Ÿ</h4>
<p>åŠŸèƒ½æè¿°ï¼š</p>
<p>æ”¯æŒä¸¤ç§å‘å¸ƒæ¨¡å¼ï¼šå…¨é‡è®¾å¤‡ï¼ˆæ‰€æœ‰ç”¨æˆ·è‡ªåŠ¨æ›´æ–°ï¼‰å’ŒæŒ‡å®šç”¨æˆ·ï¼ˆç²¾ç¡®æ§åˆ¶æ›´æ–°èŒƒå›´ï¼‰ã€‚ç³»ç»Ÿæä¾›ç›´è§‚çš„UIäº¤äº’ï¼Œä¾¿äºæ“ä½œç®¡ç†ã€‚ç›®å‰æœªå¼€å‘æ ¹æ®ç”¨æˆ·è§’è‰²èº«ä»½ç­‰åšåŒºåˆ†ï¼Œåç»­å¯å»¶ä¼¸ä¸€ä¸‹åŠŸèƒ½</p>
<p>æŠ€æœ¯å®ç°ï¼š</p>
<ul>
<li>åŠ¨æ€è§„åˆ™æ¸²æŸ“</li>
<li>ç”¨æˆ·æŸ¥çœ‹åŠŸèƒ½</li>
<li>æƒé™éš”ç¦»æœºåˆ¶</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç‰ˆæœ¬æ¯”è¾ƒå‡½æ•°</span>
<span class="hljs-title function_">compareVersions</span>(<span class="hljs-params">v1, v2</span>) {
  <span class="hljs-keyword">const</span> v1Parts = v1.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);
  <span class="hljs-keyword">const</span> v2Parts = v2.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);

  <span class="hljs-comment">// é€çº§æ¯”è¾ƒä¸»ç‰ˆæœ¬ã€æ¬¡ç‰ˆæœ¬ã€è¡¥ä¸ç‰ˆæœ¬</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
    <span class="hljs-keyword">if</span> (v1Parts[i] &gt; v2Parts[i]) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (v1Parts[i] &lt; v2Parts[i]) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25af8d49f86e46308e475fd799639d9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636105&amp;x-signature=18iAD3hsjQrEjRAkI%2FCAdeCQDxc%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-46">å…­ã€å®¢æˆ·ç«¯å®ç°</h3>
<h4 data-id="heading-47">1. Android ç«¯æ ¸å¿ƒä»£ç </h4>
<h5 data-id="heading-48">ï¼ˆ1ï¼‰ç‰ˆæœ¬æ£€æµ‹ä¸å›æ»šåˆ¤æ–­</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * React Native ç‰ˆæœ¬æ›´æ–°ç®¡ç†å™¨
 * è´Ÿè´£ç‰ˆæœ¬æ£€æµ‹ã€æ›´æ–°æç¤ºä¸å›æ»šæ“ä½œçš„ç»Ÿä¸€è°ƒåº¦
 * æ ¸å¿ƒèŒè´£ï¼šåè°ƒç‰ˆæœ¬æ£€æµ‹æµç¨‹ä¸å›æ»šç­–ç•¥çš„æ‰§è¡Œ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RNUpdateManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TAG</span> <span class="hljs-operator">=</span> <span class="hljs-string">"RNUpdateManager"</span>;
    <span class="hljs-keyword">private</span> Context mContext;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RNUpdateManager</span><span class="hljs-params">(Context context)</span> {
        <span class="hljs-built_in">this</span>.mContext = context.getApplicationContext(); <span class="hljs-comment">// ä½¿ç”¨ Application Context é¿å…å†…å­˜æ³„æ¼</span>
    }

    <span class="hljs-comment">/**
     * æ£€æµ‹ React Native ç‰ˆæœ¬æ›´æ–°çš„æ ¸å¿ƒå…¥å£
     * å®ç°é€»è¾‘ï¼š
     * 1. æ”¶é›†æœ¬åœ°ç‰ˆæœ¬ä¸è®¾å¤‡ä¿¡æ¯
     * 2. ä¸æœåŠ¡ç«¯æ¥å£äº¤äº’è·å–æ›´æ–°ç­–ç•¥
     * 3. æ ¹æ®æœåŠ¡ç«¯å“åº”æ‰§è¡Œå›æ»šæˆ–æ›´æ–°æ“ä½œ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkUpdate</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è·å–æœ¬åœ°ç‰ˆæœ¬ä¿¡æ¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">nativeVersion</span> <span class="hljs-operator">=</span> BuildConfig.VERSION_NAME;
        <span class="hljs-type">String</span> <span class="hljs-variable">currentRnVersion</span> <span class="hljs-operator">=</span> getCurrentRnVersion();
        <span class="hljs-type">String</span> <span class="hljs-variable">deviceId</span> <span class="hljs-operator">=</span> DeviceUtils.getDeviceId(mContext);
        <span class="hljs-type">long</span> <span class="hljs-variable">timestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis() / <span class="hljs-number">1000</span>;

        <span class="hljs-comment">// æ„å»ºè¯·æ±‚å‚æ•°</span>
        Map&lt;String, String&gt; params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        params.put(<span class="hljs-string">"native_version"</span>, nativeVersion);
        params.put(<span class="hljs-string">"current_rn_version"</span>, currentRnVersion);
        params.put(<span class="hljs-string">"device_id"</span>, deviceId);
        params.put(<span class="hljs-string">"timestamp"</span>, String.valueOf(timestamp));

        <span class="hljs-comment">// è¯·æ±‚æœåŠ¡ç«¯è·å–æ›´æ–°ç­–ç•¥</span>
        ApiService.checkUpdate(params, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Callback</span>&lt;UpdateResponse&gt;() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSuccess</span><span class="hljs-params">(UpdateResponse response)</span> {
                <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">null</span> &amp;&amp; response.getData() != <span class="hljs-literal">null</span>) {
                    <span class="hljs-comment">// å¤„ç†æœåŠ¡ç«¯è¿”å›çš„æ›´æ–°ç­–ç•¥</span>
                    handleUpdateStrategy(response.getData());
                }
            }

            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailure</span><span class="hljs-params">(Throwable e)</span> {
                Log.e(TAG, <span class="hljs-string">"ç‰ˆæœ¬æ£€æµ‹ç½‘ç»œè¯·æ±‚å¤±è´¥: "</span> + e.getMessage());
                <span class="hljs-comment">// å¯æ‰©å±•ï¼šæ·»åŠ å¤±è´¥é‡è¯•æœºåˆ¶ï¼ˆå¦‚æŒ‡æ•°é€€é¿ç­–ç•¥ï¼‰</span>
            }
        });
    }

    <span class="hljs-comment">/**
     * å¤„ç†æœåŠ¡ç«¯è¿”å›çš„æ›´æ–°ç­–ç•¥
     * <span class="hljs-doctag">@param</span> updateData æœåŠ¡ç«¯è¿”å›çš„æ›´æ–°æ•°æ®
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleUpdateStrategy</span><span class="hljs-params">(UpdateData updateData)</span> {
        <span class="hljs-keyword">if</span> (updateData.isNeedRollback()) {
            <span class="hljs-comment">// æ‰§è¡Œå›æ»šæ“ä½œ</span>
            handleRollback(updateData.getRollbackInfo());
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (updateData.isHasUpdate()) {
            <span class="hljs-comment">// æ‰§è¡Œæ­£å¸¸æ›´æ–°æµç¨‹</span>
            showUpdateDialog(updateData.getUpdateInfo());
        } <span class="hljs-keyword">else</span> {
            Log.d(TAG, <span class="hljs-string">"å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œæ— éœ€æ›´æ–°"</span>);
        }
    }

    <span class="hljs-comment">/**
     * å¤„ç†å›æ»šæ“ä½œçš„æ ¸å¿ƒé€»è¾‘
     * <span class="hljs-doctag">@param</span> rollbackInfo å›æ»šç›¸å…³ä¿¡æ¯
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRollback</span><span class="hljs-params">(RollbackInfo rollbackInfo)</span> {
        <span class="hljs-keyword">if</span> (rollbackInfo == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;

        <span class="hljs-keyword">if</span> (rollbackInfo.isForce()) {
            <span class="hljs-comment">// å¼ºåˆ¶å›æ»šåœºæ™¯ï¼šç›´æ¥æ‰§è¡Œå›æ»šæ“ä½œ</span>
            executeRollback(rollbackInfo.getTargetVersion());
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// éå¼ºåˆ¶å›æ»šåœºæ™¯ï¼šå¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†ï¼Œå°Šé‡ç”¨æˆ·é€‰æ‹©</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">AlertDialog</span>.Builder(mContext)
                    .setTitle(<span class="hljs-string">"ç‰ˆæœ¬å›æ»šæç¤º"</span>)
                    .setMessage(rollbackInfo.getReason())
                    .setPositiveButton(<span class="hljs-string">"ç«‹å³å›æ»š"</span>, (dialog, which) -&gt; executeRollback(rollbackInfo.getTargetVersion()))
                    .setNegativeButton(<span class="hljs-string">"æš‚ä¸å›æ»š"</span>, <span class="hljs-literal">null</span>)
                    .setCancelable(<span class="hljs-literal">false</span>) <span class="hljs-comment">// é˜²æ­¢ç”¨æˆ·è¯¯æ“ä½œå–æ¶ˆ</span>
                    .show();
        }
    }

    <span class="hljs-comment">/**
     * æ‰§è¡Œå›æ»šæ“ä½œçš„å…·ä½“å®ç°
     * <span class="hljs-doctag">@param</span> targetVersion ç›®æ ‡å›æ»šç‰ˆæœ¬å·
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeRollback</span><span class="hljs-params">(String targetVersion)</span> {
        <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> RollbackManager.getInstance().restoreToVersion(targetVersion);

        <span class="hljs-comment">// ä¸ŠæŠ¥å›æ»šçŠ¶æ€åˆ°æœåŠ¡ç«¯ï¼Œç”¨äºç»Ÿè®¡åˆ†æ</span>
        reportRollbackStatus(getCurrentRnVersion(), targetVersion, success ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);

        <span class="hljs-keyword">if</span> (success) {
            Log.d(TAG, <span class="hljs-string">"å›æ»šæˆåŠŸï¼Œé‡å¯ RN é¡µé¢åŠ è½½æ–° Bundle"</span>);
        } <span class="hljs-keyword">else</span> {
            Log.e(TAG, <span class="hljs-string">"å›æ»šæ“ä½œå¤±è´¥"</span>);
            Toast.makeText(mContext, <span class="hljs-string">"ç‰ˆæœ¬å›æ»šå¤±è´¥ï¼Œè¯·é‡è¯•"</span>, Toast.LENGTH_SHORT).show();
        }
    }

    <span class="hljs-comment">/**
     * è·å–å½“å‰ React Native ç‰ˆæœ¬å·
     * <span class="hljs-doctag">@return</span> å½“å‰ RN ç‰ˆæœ¬å·
     */</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getCurrentRnVersion</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å®é™…å®ç°ï¼šä»æœ¬åœ°å­˜å‚¨æˆ–é…ç½®ä¸­è·å–å½“å‰ RN ç‰ˆæœ¬</span>
        <span class="hljs-comment">// ç¤ºä¾‹ï¼šreturn SharedPreferencesUtils.getString("current_rn_version", "1.0.0");</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"1.0.0"</span>;
    }

    <span class="hljs-comment">/**
     * ä¸ŠæŠ¥å›æ»šçŠ¶æ€åˆ°æœåŠ¡ç«¯
     * <span class="hljs-doctag">@param</span> fromVersion å›æ»šå‰ç‰ˆæœ¬
     * <span class="hljs-doctag">@param</span> toVersion å›æ»šåç‰ˆæœ¬
     * <span class="hljs-doctag">@param</span> status å›æ»šçŠ¶æ€ï¼ˆ1:æˆåŠŸ, 0:å¤±è´¥ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reportRollbackStatus</span><span class="hljs-params">(String fromVersion, String toVersion, <span class="hljs-type">int</span> status)</span> {
        <span class="hljs-comment">// å®é™…å®ç°ï¼šè°ƒç”¨æœåŠ¡ç«¯æ¥å£ä¸ŠæŠ¥å›æ»šçŠ¶æ€</span>
        <span class="hljs-comment">// ç¤ºä¾‹ï¼š</span>
        <span class="hljs-comment">// Map&lt;String, String&gt; params = new HashMap&lt;&gt;();</span>
        <span class="hljs-comment">// params.put("from_version", fromVersion);</span>
        <span class="hljs-comment">// params.put("to_version", toVersion);</span>
        <span class="hljs-comment">// params.put("status", String.valueOf(status));</span>
        <span class="hljs-comment">// ApiService.reportRollbackStatus(params, null);</span>
    }

    <span class="hljs-comment">/**
     * æ˜¾ç¤ºç‰ˆæœ¬æ›´æ–°å¯¹è¯æ¡†
     * <span class="hljs-doctag">@param</span> updateInfo æ›´æ–°ç›¸å…³ä¿¡æ¯
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showUpdateDialog</span><span class="hljs-params">(UpdateInfo updateInfo)</span> {
        <span class="hljs-comment">// å®é™…å®ç°ï¼šæ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†ï¼Œå¼•å¯¼ç”¨æˆ·æ›´æ–°</span>
    }
}
</code></pre>
<h5 data-id="heading-49">ï¼ˆ2ï¼‰å›æ»šç®¡ç†å™¨å®ç°</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * React Native å›æ»šç®¡ç†å™¨
 * è´Ÿè´£ RN Bundle çš„ç‰ˆæœ¬å›æ»šæ ¸å¿ƒé€»è¾‘
 * è®¾è®¡æ¨¡å¼ï¼šå•ä¾‹æ¨¡å¼ + ç­–ç•¥æ¨¡å¼
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RollbackManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TAG</span> <span class="hljs-operator">=</span> <span class="hljs-string">"RollbackManager"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">RN_BUNDLE_DIR</span> <span class="hljs-operator">=</span> <span class="hljs-string">"rn_update"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">LATEST_SYMLINK</span> <span class="hljs-operator">=</span> <span class="hljs-string">"latest"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> RollbackManager sInstance;
    <span class="hljs-keyword">private</span> Context mContext;

    <span class="hljs-comment">/**
     * ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ–
     * <span class="hljs-doctag">@param</span> context åº”ç”¨ä¸Šä¸‹æ–‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">RollbackManager</span><span class="hljs-params">(Context context)</span> {
        <span class="hljs-built_in">this</span>.mContext = context;
    }

    <span class="hljs-comment">/**
     * è·å–å•ä¾‹å®ä¾‹ï¼ˆåŒé‡æ£€æŸ¥é”å®šæ¨¡å¼ï¼‰
     * <span class="hljs-doctag">@return</span> RollbackManager å•ä¾‹å®ä¾‹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> RollbackManager <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (sInstance == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (RollbackManager.class) {
                <span class="hljs-keyword">if</span> (sInstance == <span class="hljs-literal">null</span>) {
                    <span class="hljs-comment">// ç¡®ä¿ Application Context å·²åˆå§‹åŒ–</span>
                    <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> AppContext.getInstance();
                    sInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RollbackManager</span>(context);
                }
            }
        }
        <span class="hljs-keyword">return</span> sInstance;
    }

    <span class="hljs-comment">/**
     * å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬çš„ React Native Bundle
     * æ ¸å¿ƒå®ç°æµç¨‹ï¼š
     * 1. éªŒè¯ç›®æ ‡ç‰ˆæœ¬å·
     * 2. æ£€æŸ¥ç›®æ ‡ç‰ˆæœ¬ Bundle æ˜¯å¦å­˜åœ¨
     * 3. ä¸å­˜åœ¨åˆ™ä¸‹è½½åŸºç¡€ç‰ˆæœ¬
     * 4. å¤‡ä»½å½“å‰ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼‰
     * 5. åˆ›å»ºç¬¦å·é“¾æ¥æŒ‡å‘ç›®æ ‡ç‰ˆæœ¬
     * 
     * <span class="hljs-doctag">@param</span> targetVersion ç›®æ ‡ç‰ˆæœ¬å·
     * <span class="hljs-doctag">@return</span> å›æ»šæ“ä½œæ˜¯å¦æˆåŠŸ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">restoreToVersion</span><span class="hljs-params">(String targetVersion)</span> {
        <span class="hljs-comment">// å‚æ•°æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (TextUtils.isEmpty(targetVersion)) {
            Log.e(TAG, <span class="hljs-string">"ç›®æ ‡ç‰ˆæœ¬å·ä¸èƒ½ä¸ºç©º"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. è·å–ç›®æ ‡ç‰ˆæœ¬çš„ Bundle æ–‡ä»¶</span>
            <span class="hljs-type">File</span> <span class="hljs-variable">targetBundle</span> <span class="hljs-operator">=</span> getBundleFile(targetVersion);

            <span class="hljs-comment">// 2. è‹¥ç›®æ ‡ç‰ˆæœ¬ Bundle ä¸å­˜åœ¨ï¼Œåˆ™ä¸‹è½½åŸºç¡€ç‰ˆæœ¬</span>
            <span class="hljs-keyword">if</span> (!targetBundle.exists()) {
                Log.d(TAG, <span class="hljs-string">"ç›®æ ‡ç‰ˆæœ¬ Bundle ä¸å­˜åœ¨ï¼Œå¼€å§‹ä¸‹è½½åŸºç¡€ç‰ˆæœ¬"</span>);
                <span class="hljs-type">boolean</span> <span class="hljs-variable">downloadSuccess</span> <span class="hljs-operator">=</span> downloadBaseVersion(targetVersion);
                <span class="hljs-keyword">if</span> (!downloadSuccess) {
                    Log.e(TAG, <span class="hljs-string">"åŸºç¡€ç‰ˆæœ¬ä¸‹è½½å¤±è´¥"</span>);
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }
            }

            <span class="hljs-comment">// 3. å¤‡ä»½å½“å‰ç‰ˆæœ¬ï¼ˆä¾¿äºå›æ»šå¤±è´¥æ—¶æ¢å¤ï¼‰</span>
            backupCurrentVersion();

            <span class="hljs-comment">// 4. åˆ›å»ºç¬¦å·é“¾æ¥æŒ‡å‘ç›®æ ‡ç‰ˆæœ¬ Bundle</span>
            <span class="hljs-keyword">return</span> createSymlinkToTarget(targetBundle);

        } <span class="hljs-keyword">catch</span> (SecurityException e) {
            Log.e(TAG, <span class="hljs-string">"å›æ»šæƒé™ä¸è¶³: "</span> + e.getMessage(), e);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">catch</span> (IOException e) {
            Log.e(TAG, <span class="hljs-string">"å›æ»šæ–‡ä»¶æ“ä½œå¼‚å¸¸: "</span> + e.getMessage(), e);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            Log.e(TAG, <span class="hljs-string">"å›æ»šè¿‡ç¨‹å‘ç”ŸæœªçŸ¥å¼‚å¸¸: "</span> + e.getMessage(), e);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-comment">/**
     * è·å–æŒ‡å®šç‰ˆæœ¬çš„ Bundle æ–‡ä»¶è·¯å¾„
     * <span class="hljs-doctag">@param</span> version ç‰ˆæœ¬å·
     * <span class="hljs-doctag">@return</span> å¯¹åº”ç‰ˆæœ¬çš„ Bundle æ–‡ä»¶
     */</span>
    <span class="hljs-keyword">private</span> File <span class="hljs-title function_">getBundleFile</span><span class="hljs-params">(String version)</span> {
        <span class="hljs-type">File</span> <span class="hljs-variable">bundleDir</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(mContext.getFilesDir(), RN_BUNDLE_DIR);
        <span class="hljs-keyword">if</span> (!bundleDir.exists()) {
            bundleDir.mkdirs(); <span class="hljs-comment">// ç¡®ä¿ç›®å½•å­˜åœ¨</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(bundleDir, <span class="hljs-string">"bundle_"</span> + version + <span class="hljs-string">".jsbundle"</span>);
    }

    <span class="hljs-comment">/**
     * ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„åŸºç¡€ Bundle æ–‡ä»¶
     * <span class="hljs-doctag">@param</span> version ç›®æ ‡ç‰ˆæœ¬å·
     * <span class="hljs-doctag">@return</span> ä¸‹è½½æ˜¯å¦æˆåŠŸ
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">downloadBaseVersion</span><span class="hljs-params">(String version)</span> {
        <span class="hljs-comment">// å®é™…å®ç°ï¼šä»æœåŠ¡ç«¯ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„ Bundle æ–‡ä»¶</span>
        <span class="hljs-comment">// å¯æ‰©å±•ï¼šå®ç°æ–­ç‚¹ç»­ä¼ ã€è¿›åº¦å›è°ƒç­‰åŠŸèƒ½</span>
        Log.d(TAG, <span class="hljs-string">"ä¸‹è½½ç‰ˆæœ¬ "</span> + version + <span class="hljs-string">" çš„åŸºç¡€ Bundle æ–‡ä»¶"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// ç¤ºä¾‹è¿”å›å€¼</span>
    }

    <span class="hljs-comment">/**
     * å¤‡ä»½å½“å‰ç‰ˆæœ¬çš„ Bundle æ–‡ä»¶
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">backupCurrentVersion</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">File</span> <span class="hljs-variable">latestLink</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(mContext.getFilesDir(), RN_BUNDLE_DIR), LATEST_SYMLINK);
            <span class="hljs-keyword">if</span> (latestLink.exists() &amp;&amp; latestLink.isFile()) {
                <span class="hljs-type">File</span> <span class="hljs-variable">backupDir</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(mContext.getFilesDir(), <span class="hljs-string">"rn_backup"</span>);
                <span class="hljs-keyword">if</span> (!backupDir.exists()) {
                    backupDir.mkdirs();
                }
                <span class="hljs-type">File</span> <span class="hljs-variable">backupFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(backupDir, <span class="hljs-string">"bundle_backup_"</span> + System.currentTimeMillis() + <span class="hljs-string">".jsbundle"</span>);
                FileUtils.copyFile(latestLink, backupFile);
                Log.d(TAG, <span class="hljs-string">"å½“å‰ç‰ˆæœ¬å·²å¤‡ä»½åˆ°: "</span> + backupFile.getAbsolutePath());
            }
        } <span class="hljs-keyword">catch</span> (IOException e) {
            Log.e(TAG, <span class="hljs-string">"å¤‡ä»½å½“å‰ç‰ˆæœ¬å¤±è´¥: "</span> + e.getMessage(), e);
            <span class="hljs-comment">// å¤‡ä»½å¤±è´¥ä¸å½±å“ä¸»æµç¨‹</span>
        }
    }

    <span class="hljs-comment">/**
     * åˆ›å»ºç¬¦å·é“¾æ¥æŒ‡å‘ç›®æ ‡ç‰ˆæœ¬çš„ Bundle æ–‡ä»¶
     * <span class="hljs-doctag">@param</span> targetBundle ç›®æ ‡ç‰ˆæœ¬çš„ Bundle æ–‡ä»¶
     * <span class="hljs-doctag">@return</span> ç¬¦å·é“¾æ¥åˆ›å»ºæ˜¯å¦æˆåŠŸ
     * <span class="hljs-doctag">@throws</span> IOException IO æ“ä½œå¼‚å¸¸
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">createSymlinkToTarget</span><span class="hljs-params">(File targetBundle)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">File</span> <span class="hljs-variable">bundleDir</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(mContext.getFilesDir(), RN_BUNDLE_DIR);
        <span class="hljs-type">File</span> <span class="hljs-variable">latestLink</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(bundleDir, LATEST_SYMLINK);

        <span class="hljs-comment">// åˆ é™¤æ—§çš„ç¬¦å·é“¾æ¥æˆ–æ–‡ä»¶ï¼ˆè‹¥å­˜åœ¨ï¼‰</span>
        <span class="hljs-keyword">if</span> (latestLink.exists()) {
            <span class="hljs-type">boolean</span> <span class="hljs-variable">deleted</span> <span class="hljs-operator">=</span> latestLink.delete();
            <span class="hljs-keyword">if</span> (!deleted) {
                Log.e(TAG, <span class="hljs-string">"åˆ é™¤æ—§ç¬¦å·é“¾æ¥å¤±è´¥"</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }

        <span class="hljs-comment">// åˆ›å»ºæ–°çš„ç¬¦å·é“¾æ¥ï¼ˆå…¼å®¹ä¸åŒ Android ç‰ˆæœ¬ï¼‰</span>
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.N) {
            <span class="hljs-comment">// Android 7.0+ åŸç”Ÿæ”¯æŒç¬¦å·é“¾æ¥</span>
            Files.createSymbolicLink(latestLink.toPath(), targetBundle.toPath());
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ä½ç‰ˆæœ¬ Android å…¼å®¹æ–¹æ¡ˆï¼šç›´æ¥å¤åˆ¶æ–‡ä»¶</span>
            Log.d(TAG, <span class="hljs-string">"å½“å‰ Android ç‰ˆæœ¬ä¸æ”¯æŒç¬¦å·é“¾æ¥ï¼Œä½¿ç”¨æ–‡ä»¶å¤åˆ¶æ–¹æ¡ˆ"</span>);
            FileUtils.copyFile(targetBundle, latestLink);
        }

        Log.d(TAG, <span class="hljs-string">"æˆåŠŸåˆ›å»ºæŒ‡å‘ç›®æ ‡ç‰ˆæœ¬çš„é“¾æ¥: "</span> + targetBundle.getAbsolutePath());
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<h3 data-id="heading-50">ä¸ƒã€çƒ­ä¿®å¤å…¨æµç¨‹æ¼”ç¤º</h3>
<h4 data-id="heading-51">1. å®¢æˆ·ç«¯åŠ è½½è¡¥ä¸æµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[åˆå§‹åŒ–RNå®¹å™¨] --&gt; B[æ£€æŸ¥æ˜¯å¦æœ‰å·²ä¸‹è½½çš„æ›´æ–°åŒ…]
    B --&gt;|å­˜åœ¨| C[éªŒè¯æ›´æ–°æ›´æ–°åŒ…ç‰ˆæœ¬æœ‰æ•ˆæ€§]
    C --&gt;|æœ‰æ•ˆ| D[åŠ è½½æ²™ç›’ä¸­çš„æ›´æ–°åŒ…]
    C --&gt;|æ— æ•ˆ| E[åˆ é™¤æ— æ•ˆæ›´æ–°åŒ…]

    B --&gt;|ä¸å­˜åœ¨| F[åŠ è½½åŸç”Ÿé¢„ç½®çš„åŸºç¡€åŒ…]

    D --&gt; G{åŠ è½½æ˜¯å¦æˆåŠŸ?}
    G --&gt;|æ˜¯| H[è®°å½•å½“å‰ä½¿ç”¨ç‰ˆæœ¬]
    G --&gt;|å¦| I[è§¦å‘è‡ªåŠ¨å›æ»šæœºåˆ¶]

    F --&gt; H

    I --&gt; J{æ˜¯å¦æœ‰å†å²ç‰ˆæœ¬å¤‡ä»½?}
    J --&gt;|æ˜¯| K[åŠ è½½æœ€æ–°çš„å†å²å¤‡ä»½ç‰ˆæœ¬]
    J --&gt;|å¦| F

    K --&gt; L{å¤‡ä»½ç‰ˆæœ¬åŠ è½½æ˜¯å¦æˆåŠŸ?}
    L --&gt;|æ˜¯| H
    L --&gt;|å¦| F

    H --&gt; M[RNé¡µé¢æ¸²æŸ“å®Œæˆ]
</code></pre>
<h4 data-id="heading-52">2. æ’¤å›æ“ä½œæµç¨‹ï¼ˆç®¡ç†åå°è§†è§’ï¼‰</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[å‘ç°é—®é¢˜è¡¥ä¸] --&gt; B[ç®¡ç†å‘˜ç™»å½•ç®¡ç†åå°]
    B --&gt; C[é€‰æ‹©éœ€è¦æ’¤å›çš„è¡¥ä¸ç‰ˆæœ¬]
    C --&gt; D[é€‰æ‹©æ’¤å›ç±»å‹: åœæ­¢æ¨é€/å¼ºåˆ¶å›æ»š]
    D --&gt; E[å¡«å†™æ’¤å›åŸå› å’Œç›®æ ‡å›æ»šç‰ˆæœ¬]
    E --&gt; F[ç³»ç»ŸéªŒè¯ç‰ˆæœ¬åˆæ³•æ€§]
    F --&gt; G[æ›´æ–°æ•°æ®åº“æ’¤å›çŠ¶æ€]
    G --&gt; H[ç”Ÿæˆå›æ»šæŒ‡ä»¤]
    H --&gt; I[æ ‡è®°å—å½±å“ç”¨æˆ·]
</code></pre>
<h4 data-id="heading-53">3. å®¢æˆ·ç«¯å›æ»šæµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[åº”ç”¨å¯åŠ¨/å®šæ—¶æ£€æµ‹] --&gt; B[è°ƒç”¨ç‰ˆæœ¬æ£€æµ‹æ¥å£]
    B --&gt; C{æ˜¯å¦æœ‰å›æ»šæŒ‡ä»¤?}
    C --&gt;|æ˜¯| D{æ˜¯å¦å¼ºåˆ¶å›æ»š?}
    D --&gt;|æ˜¯| E[ç›´æ¥æ‰§è¡Œå›æ»š]
    D --&gt;|å¦| F[å¼¹çª—è¯¢é—®ç”¨æˆ·]
    F --&gt;|ç¡®è®¤| E
    F --&gt;|å–æ¶ˆ| G[è®°å½•ç”¨æˆ·é€‰æ‹©ä¸‹æ¬¡å†æé†’]
    E --&gt; H[æ¢å¤åˆ°ç›®æ ‡ç‰ˆæœ¬]
    H --&gt; I[ä¸ŠæŠ¥å›æ»šç»“æœ]
    I --&gt; J[é‡å¯RNé¡µé¢ç”Ÿæ•ˆ]
</code></pre>
<h3 data-id="heading-54">å…«ã€é£é™©æ§åˆ¶ä¸ä¼˜åŒ–</h3>
<h4 data-id="heading-55">1. é£é™©ç‚¹åŠè§£å†³æ–¹æ¡ˆ</h4>

































<table><thead><tr><th>é£é™©ç‚¹</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æ¥å£å®‰å…¨</td><td>å®ç°ç­¾åéªŒè¯ã€æ—¶é—´æˆ³é˜²é‡æ”¾ã€è¯·æ±‚é¢‘ç‡é™åˆ¶</td></tr><tr><td>æ›´æ–°åŒ…å®‰å…¨</td><td>å¼ºåˆ¶ MD5 æ ¡éªŒ</td></tr><tr><td>åŠ è½½å¤±è´¥</td><td>å®ç°è‡ªåŠ¨å›æ»šæœºåˆ¶ã€å´©æºƒç›‘æ§ä¸ŠæŠ¥</td></tr><tr><td>ç½‘ç»œé—®é¢˜</td><td>ä¸‹è½½é‡è¯•æœºåˆ¶</td></tr><tr><td>æ’¤å›æŒ‡ä»¤æ»¥ç”¨</td><td>å¢åŠ å®¡æ‰¹æµç¨‹ã€æ“ä½œæ—¥å¿—å®¡è®¡ã€æƒé™æ§åˆ¶</td></tr><tr><td>å›æ»šå¤±è´¥</td><td>å›æ»šå‰å¤‡ä»½å½“å‰ç‰ˆæœ¬ã€å¤±è´¥è‡ªåŠ¨æ¢å¤ã€æä¾›æ‰‹åŠ¨å›æ»šå…¥å£</td></tr></tbody></table>
<h4 data-id="heading-56">2. æ€§èƒ½ä¼˜åŒ–</h4>
<ul>
<li>
<p>é‡‡ç”¨å¢é‡æ›´æ–°ï¼ˆBsdiff ç®—æ³•ï¼‰å‡å°‘åŒ…ä½“ç§¯</p>
</li>
<li>
<p>åå°ä¸‹è½½ä¸é˜»å¡ä¸»çº¿ç¨‹</p>
</li>
<li>
<p>èµ„æºé¢„åŠ è½½ï¼ˆç©ºé—²æ—¶æå‰ä¸‹è½½ï¼‰</p>
</li>
<li>
<p>å®šæœŸæ¸…ç†è¿‡æœŸæ›´æ–°åŒ…</p>
</li>
</ul>
<h3 data-id="heading-57">ä¹ã€æ€»ç»“ä¸è§„åˆ’</h3>
<p>è‡³æ­¤ï¼Œä¸€æ¡â€œè‡ªå»º RN çƒ­ä¿®å¤â€é«˜é€Ÿé€šé“å·²å…¨é¢è´¯é€šã€‚</p>
<p>ä»éœ€æ±‚å‘èµ·åˆ°è¡¥ä¸ç”Ÿæ•ˆï¼Œæˆ‘ä»¬æŠŠæ—¶é—´åˆ»åº¦ä»â€œå¤©â€å‹ç¼©åˆ°â€œåˆ†é’Ÿâ€ï¼š</p>
<ul>
<li>10 åˆ†é’Ÿå®Œæˆ Bundle å·®åˆ†ã€ç°åº¦ç­–ç•¥é…ç½®ã€CDN åˆ†å‘ï¼›</li>
<li>30 ç§’å†…æ’¤å›æŒ‡ä»¤å³å¯è¦†ç›–å…¨éƒ¨ç”¨æˆ·ï¼Œå›æ»šåŒ…ç«‹å³ç”Ÿæ•ˆï¼›</li>
<li>æˆåŠŸç‡ã€å¤±è´¥è¯¦æƒ…ã€å›æ»šæ¯”ä¾‹åœ¨ç›‘æ§å¤§å±å®æ—¶åˆ·æ–°ï¼Œä¸å†é çŒœã€‚</li>
</ul>
<p>è¿‡å»ï¼Œç‰ˆæœ¬å·ä¸€æ—¦è¢«æ‰“è¿›å®‰è£…åŒ…ï¼Œå°±åƒæŠŠä¿¡ä»¶æŠ•è¿›é‚®ç­’â€”â€”åœ°å€å†™æ­»ã€æ— æ³•å¬å›ï¼›<br/>
ç°åœ¨ï¼Œç‰ˆæœ¬å·åªæ˜¯æœåŠ¡ç«¯çš„ä¸€æ¡æ•°æ®è®°å½•ï¼Œå¯éšæ—¶å‡é™ã€éšæ—¶æ›¿æ¢ï¼Œè®©â€œå‘ç‰ˆâ€ç¬¬ä¸€æ¬¡æ‹¥æœ‰äº†â€œæ•°æ®åº“äº‹åŠ¡â€èˆ¬çš„åŸå­æ€§ä¸å›æ»šèƒ½åŠ›ã€‚</p>
<p>åç»­è®¡åˆ’</p>
<ul>
<li>
<p>ç¦»çº¿åœºæ™¯ä¸å¼±ç½‘ä¼˜åŒ–<br/>
æ–­ç‚¹ç»­ä¼  256 KB åˆ†ç‰‡ï¼Œå¼±ç½‘ &lt;100 kbps é™é»˜é™é€Ÿä¸‹è½½ï¼Œå·®åˆ†ç»“æœæœ¬åœ°ç¼“å­˜ï¼ŒäºŒæ¬¡å†·å¯ç§’åˆ‡æ–° Bundleã€‚</p>
</li>
<li>
<p>å¯è§†åŒ–åŸ‹ç‚¹åˆ†æ<br/>
å†…ç½‘å¤§å±ç›´æ˜¾â€œä¸‹è½½-æ¿€æ´»-å›æ»šâ€æ¼æ–—ï¼Œç‚¹æŸ±ä¸‹é’»åˆ°åœ°åŸŸ/æœºå‹/ç³»ç»Ÿç‰ˆæœ¬ï¼›æˆåŠŸç‡&lt;98%æˆ–å›æ»šç‡&gt;2%å³åˆ»æ¨å›¾åˆ°ä¼å¾®/é’‰é’‰ï¼Œ10 åˆ†é’Ÿé—­ç¯ã€‚</p>
</li>
<li>
<p>å‘½ä»¤è¡Œä¸€é”®ä¸Šä¼ 
æ— éœ€æ‰“å¼€åå°ï¼Œå¦‚æ‰§è¡Œ rn-patch upload --appId 1001 --ver 1.0.2 --bundle ./index.android.bundle å³å¯å®Œæˆæ‰“åŒ…ã€åŠ å¯†ã€ç­¾åã€ä¸Šä¼ ï¼Œè¿”å›è¡¥ä¸ ID ä¸ä¸‹è½½é“¾æ¥ã€‚</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptæ€§èƒ½ä¼˜åŒ–ï¼š5ä¸ªV8å¼•æ“éšè—æŠ€å·§è®©ä½ çš„ä»£ç æé€Ÿ50%]]></title>    <link>https://juejin.cn/post/7584780417103036456</link>    <guid>https://juejin.cn/post/7584780417103036456</guid>    <pubDate>2025-12-18T04:16:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584780417103036456" data-draft-id="7584760031835308066" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptæ€§èƒ½ä¼˜åŒ–ï¼š5ä¸ªV8å¼•æ“éšè—æŠ€å·§è®©ä½ çš„ä»£ç æé€Ÿ50%"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-18T04:16:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptæ€§èƒ½ä¼˜åŒ–ï¼š5ä¸ªV8å¼•æ“éšè—æŠ€å·§è®©ä½ çš„ä»£ç æé€Ÿ50%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:16:51.000Z" title="Thu Dec 18 2025 04:16:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>JavaScriptæ€§èƒ½ä¼˜åŒ–ï¼š5ä¸ªV8å¼•æ“éšè—æŠ€å·§è®©ä½ çš„ä»£ç æé€Ÿ50%</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼ŒJavaScriptæ€§èƒ½ä¼˜åŒ–æ˜¯ä¸€ä¸ªæ°¸æ’çš„è¯é¢˜ã€‚éšç€V8å¼•æ“çš„æŒç»­è¿›åŒ–ï¼Œè®¸å¤šå¼€å‘è€…å¯èƒ½æ²¡æœ‰æ„è¯†åˆ°ï¼Œä»–ä»¬çš„ä»£ç è·ç¦»æœ€ä¼˜æ€§èƒ½å¾€å¾€åªå·®å‡ ä¸ªå…³é”®è°ƒæ•´ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨5ä¸ªé²œä¸ºäººçŸ¥çš„V8å¼•æ“ä¼˜åŒ–æŠ€å·§ï¼Œè¿™äº›æŠ€å·§åŸºäºGoogle V8å›¢é˜Ÿå…¬å¼€çš„æŠ€æœ¯æ–‡æ¡£ã€æ¼”è®²å’Œå®é™…åŸºå‡†æµ‹è¯•ç»“æœï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ çš„åº”ç”¨è·å¾—é«˜è¾¾50%çš„æ€§èƒ½æå‡ã€‚</p>
<h2 data-id="heading-2">1. éšè—ç±»ï¼ˆHidden Classï¼‰ä¼˜åŒ–</h2>
<h3 data-id="heading-3">1.1 ç†è§£éšè—ç±»æœºåˆ¶</h3>
<p>V8å¼•æ“ä½¿ç”¨éšè—ç±»ï¼ˆå†…éƒ¨ç§°ä¸º"Map"ï¼‰æ¥åŠ é€Ÿå¯¹è±¡å±æ€§è®¿é—®ã€‚å½“å¯¹è±¡åˆ›å»ºæ—¶ï¼ŒV8ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªéšè—ç±»ï¼Œå¹¶åœ¨å±æ€§å˜æ›´æ—¶åˆ›å»ºæ–°çš„éšè—ç±»é“¾ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åæ¨¡å¼ - ç ´åéšè—ç±»è¿ç»­æ€§</span>
<span class="hljs-keyword">const</span> obj = {};
obj.<span class="hljs-property">a</span> = <span class="hljs-number">1</span>;   <span class="hljs-comment">// HiddenClass C0 â†’ C1</span>
obj.<span class="hljs-property">b</span> = <span class="hljs-number">2</span>;   <span class="hljs-comment">// HiddenClass C1 â†’ C2</span>

<span class="hljs-comment">// vs </span>

<span class="hljs-comment">// ä¼˜åŒ–æ¨¡å¼ - ä¿æŒä¸€è‡´æ€§</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OptimalObj</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span> = a;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">b</span> = b;
}
<span class="hljs-keyword">const</span> optimal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OptimalObj</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// Single HiddenClass</span>
</code></pre>
<h3 data-id="heading-4">1.2 å®è·µå»ºè®®</h3>
<ul>
<li><strong>ä¸€æ¬¡æ€§åˆå§‹åŒ–æ‰€æœ‰å±æ€§</strong>ï¼šé¿å…åŠ¨æ€æ·»åŠ å±æ€§</li>
<li><strong>ä¿æŒå±æ€§é¡ºåºä¸€è‡´</strong>ï¼šä¸åŒå®ä¾‹çš„å±æ€§å£°æ˜é¡ºåºä¸åŒä¼šå¯¼è‡´ä¸åŒçš„éšè—ç±»</li>
<li><strong>ä½¿ç”¨æ„é€ å‡½æ•°æˆ–class</strong>ï¼šæ¯”å­—é¢é‡å¯¹è±¡æ›´æœ‰åˆ©äºéšè—ç±»ä¼˜åŒ–</li>
</ul>
<p>åŸºå‡†æµ‹è¯•æ˜¾ç¤ºï¼šåœ¨å¯†é›†å¯¹è±¡æ“ä½œåœºæ™¯ä¸‹ï¼Œè¿™äº›ä¼˜åŒ–å¯ä½¿æ€§èƒ½æå‡20-35%ã€‚</p>
<h2 data-id="heading-5">2. TurboFanä¼˜åŒ–é™·é˜±ä¸é€ƒé€¸åˆ†æ</h2>
<h3 data-id="heading-6">2.1 TurboFançš„å·¥ä½œæœºåˆ¶</h3>
<p>V8çš„TurboFanç¼–è¯‘å™¨ä¼šè¿›è¡Œé€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰ï¼Œç¡®å®šå¯¹è±¡æ˜¯å¦"é€ƒé€¸"å‡ºå½“å‰å‡½æ•°ä½œç”¨åŸŸã€‚æœªé€ƒé€¸çš„å¯¹è±¡å¯èƒ½è¢«å®Œå…¨ä¼˜åŒ–æ‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åä¾‹ - å¯¹è±¡é€ƒé€¸å¯¼è‡´å»ä¼˜åŒ–</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">const</span> temp = { <span class="hljs-attr">x</span>: data.<span class="hljs-property">x</span> * <span class="hljs-number">2</span> }; <span class="hljs-comment">// âŒ Allocationæ— æ³•æ¶ˆé™¤</span>
  
someGlobalVar = temp; <span class="hljs-comment">// &lt;- Escape!</span>
}

<span class="hljs-comment">// âœ…ï¸ Optimizableç‰ˆæœ¬</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">optimizedProcess</span>(<span class="hljs-params">data</span>) {
<span class="hljs-keyword">return</span> data.<span class="hljs-property">x</span> * <span class="hljs-number">2</span>; <span class="hljs-comment">// âœ”ï¸ No allocation needed</span>
}
</code></pre>
<h3 data-id="heading-7">2.2 Key Insights</h3>
<ul>
<li><strong>é¿å…åœ¨çƒ­ç‚¹è·¯å¾„ä¸Šåˆ›å»ºä¸´æ—¶å¯¹è±¡</strong></li>
<li><strong>è­¦æƒ•é—­åŒ…æ•è·</strong>ï¼šå¯èƒ½å¯¼è‡´å˜é‡é€ƒé€¸</li>
<li><strong>ä½¿ç”¨æ•°å­—ç±»å‹è€ŒéåŒ…è£…å¯¹è±¡</strong>ï¼š<code>new Number()</code>ä¼šç ´åä¼˜åŒ–</li>
</ul>
<p>å®é™…æ¡ˆä¾‹è¡¨æ˜ï¼šä¿®å¤è¿™ç±»é—®é¢˜å¯ä½¿æ•°å€¼è®¡ç®—å¯†é›†å‹å‡½æ•°æé€Ÿ40%ä»¥ä¸Šã€‚</p>
<h2 data-id="heading-8">3. Arrayå¤„ç†çš„é«˜æ•ˆæ¨¡å¼</h2>
<h3 data-id="heading-9">3.1 V8æ•°ç»„çš„å†…éƒ¨è¡¨ç¤ºå½¢å¼</h3>
<p>V8ä¼šæ ¹æ®æ•°ç»„å†…å®¹è‡ªåŠ¨åˆ‡æ¢å­˜å‚¨æ¨¡å¼ï¼š</p>
<ul>
<li>PACKED_SMI_ELEMENTS ï¼ˆçº¯å°æ•´æ•°ï¼‰</li>
<li>PACKED_DOUBLE_ELEMENTS ï¼ˆåŒç²¾åº¦æµ®ç‚¹ï¼‰</li>
<li>PACKED_ELEMENTS ï¼ˆä»»æ„ç±»å‹ï¼‰</li>
<li>HOLEY_å˜ä½“ï¼ˆå­˜åœ¨ç©ºæ´ï¼‰</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸš« Slow transition:</span>
<span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, ,];      <span class="hljs-comment">// HOLEY_SMI_ELEMENTS </span>
arr.<span class="hljs-title function_">push</span>(<span class="hljs-string">'x'</span>);           <span class="hljs-comment">// â†’ HOLEY_ELEMENTS (æœ€æ…¢)</span>

<span class="hljs-comment">// âœ… Better:</span>
<span class="hljs-keyword">const</span> arr = [];
arr[<span class="hljs-number">0</span>] = <span class="hljs-string">'first'</span>;        <span class="hljs-comment">// Always PACKED_ELEMENTS </span>
arr[<span class="hljs-number">1</span>] = <span class="hljs-string">'second'</span>;
</code></pre>
<h3 data-id="heading-10">3.2 Performance Tips:</h3>
<ul>
<li><strong>é¢„åˆ†é…æ•°ç»„å¤§å°</strong>ï¼š<code>new Array(N)</code>æ¯”<code>[]+push</code>å¿«15%</li>
<li><strong>é¿å…åˆ¶é€ ç©ºæ´</strong>ï¼šundefinedæ¯”æ˜¾å¼ç•™ç©ºæ€§èƒ½æ›´å¥½</li>
<li><strong>ç±»å‹ä¸€è‡´åŸåˆ™</strong>ï¼šæ··åˆç±»å‹ä¼šå¯¼è‡´é™çº§åˆ°é€šç”¨è¡¨ç¤º</li>
</ul>
<p>å®æµ‹æ•°æ®è¡¨æ˜ï¼šéµå¾ªè¿™äº›è§„åˆ™å¯ä½¿æ•°ç»„æ“ä½œæé€Ÿ30%-50%ã€‚</p>
<h2 data-id="heading-11">4. Inline Cache (IC)æœºåˆ¶æ·±åº¦åˆ©ç”¨</h2>
<h3 data-id="heading-12">4.1 ICçš„å·¥ä½œæµç¨‹</h3>
<p>V8é€šè¿‡å¤šæ€ICæ¥ç¼“å­˜æ–¹æ³•è°ƒç”¨ä¿¡æ¯ï¼š</p>
<pre><code class="hljs">å•æ€ï¼ˆMonomorphicï¼‰â†’ 
å¤šæ€ï¼ˆPolymorphic &lt;4ç§ï¼‰â†’ 
è¶…æ€ï¼ˆMegamorphicï¼‰
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âš ï¸ Megamorphicå±é™©ç¤ºä¾‹ï¼š</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x, y</span>) {
 <span class="hljs-keyword">return</span> x + y; <span class="hljs-comment">// ICçŠ¶æ€å–å†³äºå‚æ•°ç±»å‹ç»„åˆ </span>
}

<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, );     <span class="hljs-comment">// MONO: number + number  </span>
<span class="hljs-title function_">add</span>(<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>); <span class="hljs-comment">// POLY: string + string  </span>
<span class="hljs-title function_">add</span>({}, []);   <span class="hljs-comment">// MEGA: object + array  </span>

<span class="hljs-comment">// âœ… Monomorphicç‰ˆæœ¬ï¼š</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">addNumbers</span>(<span class="hljs-params">a, b</span>) { <span class="hljs-keyword">return</span> a + b; }
</code></pre>
<h3 data-id="heading-13">Pro Tips:</h3>
<p>-<strong>ä¸“ç”¨å‡½æ•°ä¼˜äºæ³›å‹å‡½æ•°</strong>
-<strong>é¿å…è¶…è¿‡4ç§ç±»å‹ç»„åˆ</strong>
-<strong>å†»ç»“å¯¹è±¡å¯é”å®šhidden class</strong></p>
<p>ç”Ÿäº§ç¯å¢ƒæ•°æ®æ˜¾ç¤ºï¼šç»´æŠ¤ICçš„å•æ€æ€§å¯è·å¾—25%ä»¥ä¸Šçš„è°ƒç”¨åŠ é€Ÿã€‚</p>
<p>##5.WASMä¸JSçš„æœ€ä½³åä½œæ¨¡å¼</p>
<p>###5.1 V8ä¸­çš„WASMè°ƒç”¨è¾¹ç•Œæˆæœ¬</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸ’¡ Hybridè°ƒç”¨ç¤ºä¾‹  </span>
<span class="hljs-keyword">const</span> wasmModule = <span class="hljs-keyword">await</span> <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-title function_">compile</span>(...);  

<span class="hljs-keyword">function</span> <span class="hljs-title function_">hybridCompute</span>(<span class="hljs-params">arr</span>) {  
 <span class="hljs-keyword">const</span> memView = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint32Array</span>(memory.<span class="hljs-property">buffer</span>);  
 <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isTypedArray</span>(arr)) {  
 memView.<span class="hljs-title function_">set</span>(arr);    <span class="hljs-comment">// Zero-copy path   </span>
 <span class="hljs-keyword">return</span> <span class="hljs-title function_">_wasm_fn</span>();    <span class="hljs-comment">// Fast call   </span>
 } <span class="hljs-keyword">else</span> {              <span class="hljs-comment">// Fallback path   </span>
 <span class="hljs-keyword">return</span> <span class="hljs-title function_">jsImpl</span>(arr);   <span class="hljs-comment">// Pure JS   </span>
 }  
}    
</code></pre>
<p>###5.2å…³é”®ç­–ç•¥:<br/>
-<strong>å»ºç«‹é«˜æ•ˆçš„æ•°æ®äº¤æ¢é€šé“</strong>: SharedArrayBufferä¼˜äºåºåˆ—åŒ–<br/>
-<strong>åˆ†å±‚è®¾è®¡</strong>: WASMå¤„ç†è®¡ç®—å¯†é›†å‹ä»»åŠ¡<br/>
-<strong>é¿å…é¢‘ç¹è·¨ç•Œè°ƒç”¨</strong>:æ‰¹é‡å¤„ç†æ•°æ®</p>
<p>å®éªŒå®¤æµ‹è¯•è¡¨æ˜:åˆç†è®¾è®¡çš„æ··åˆæ–¹æ¡ˆå¯å®ç°50%-70%çš„æ€§èƒ½é£è·ƒã€‚</p>
<p>##æ€»ç»“</p>
<p>æŒæ¡è¿™äº”ä¸ªV8å¼•æ“çš„æ·±å±‚ä¼˜åŒ–æŠ€å·§éœ€è¦å¼€å‘è€…æ”¹å˜ä¸€äº›ä¼ ç»Ÿç¼–ç ä¹ æƒ¯ï¼š</p>
<p>â€¢ä»å…³æ³¨è¯­æ³•æ­£ç¡®æ€§åˆ°ç†è§£åº•å±‚è¡¨ç¤ºå½¢å¼<br/>
â€¢ä»éšæ„è®¾è®¡æ•°æ®ç»“æ„åˆ°è€ƒè™‘å†…å­˜å¸ƒå±€å½±å“<br/>
â€¢ä»è¢«åŠ¨æ¥å—è¿è¡Œæ—¶è¡Œä¸ºåˆ°ä¸»åŠ¨å¼•å¯¼JITå†³ç­–</p>
<p>è¿™äº›æ”¹å˜è™½ç„¶ç»†å¾®ï¼Œä½†åœ¨å¤§è§„æ¨¡åº”ç”¨ä¸­ä¼šäº§ç”Ÿæ˜¾è‘—çš„ç´¯ç§¯æ•ˆæœã€‚æ­£å¦‚Chromeå›¢é˜Ÿçš„è°ƒç ”æ˜¾ç¤ºï¼š"90%çš„æ€§èƒ½é—®é¢˜æ¥è‡ª10%çš„å…³é”®ä»£ç è·¯å¾„"ã€‚å»ºè®®è¯»è€…é€šè¿‡Chromium DevToolsçš„Runtime Call Statså’ŒICç»Ÿè®¡åŠŸèƒ½æ¥éªŒè¯è¿™äº›æŠ€æœ¯åœ¨è‡ªå·±é¡¹ç›®ä¸­çš„åº”ç”¨æ•ˆæœã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»åŸç†åˆ°è½åœ°ï¼šå¤§å±é€‚é…é€‚é…Â +Â é«˜å¹¶å‘å¼¹å¹•çš„ä¼ä¸šçº§æŠ€æœ¯æ‰‹å†Œ]]></title>    <link>https://juejin.cn/post/7584787119273590811</link>    <guid>https://juejin.cn/post/7584787119273590811</guid>    <pubDate>2025-12-18T04:16:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584787119273590811" data-draft-id="7584742635502387227" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»åŸç†åˆ°è½åœ°ï¼šå¤§å±é€‚é…é€‚é…Â +Â é«˜å¹¶å‘å¼¹å¹•çš„ä¼ä¸šçº§æŠ€æœ¯æ‰‹å†Œ"/> <meta itemprop="keywords" content="å‰ç«¯,CSS"/> <meta itemprop="datePublished" content="2025-12-18T04:16:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ´çªæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2538113306470631"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»åŸç†åˆ°è½åœ°ï¼šå¤§å±é€‚é…é€‚é…Â +Â é«˜å¹¶å‘å¼¹å¹•çš„ä¼ä¸šçº§æŠ€æœ¯æ‰‹å†Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2538113306470631/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ´çªæŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:16:30.000Z" title="Thu Dec 18 2025 04:16:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f576690145e347b3a70cadb4bc9d3fc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636190&amp;x-signature=dda6i10PPjiGPcFYAG3WbziZsys%3D" alt="æ•°æ®å¤§å±-----è®¾è®¡ç¨¿00.png" loading="lazy"/></p>
<h3 data-id="heading-0">å¼•è¨€ï¼šå¤§å±å¼€å‘çš„åŒé‡æŠ€æœ¯å›°å¢ƒ</h3>
<p>éšç€æ•°å­—åŒ–è½¬å‹çš„åŠ é€Ÿï¼Œæ•°æ®å¯è§†åŒ–å¤§å±ä¸å®æ—¶æ¶ˆæ¯åœºæ™¯è¿æ¥äº†çˆ†å‘å¼å¢é•¿ã€‚ä»ç”µå•†ç›‘æ§åˆ°ç›´æ’­äº’åŠ¨ï¼Œå†åˆ°æ”¿åŠ¡æŒ‡æŒ¥ï¼Œå¤§å±åº”ç”¨æ— å¤„ä¸åœ¨ï¼š</p>
<ul>
<li>
<p>åŒ11ç”µå•†å®æ—¶äº¤æ˜“ç›‘æ§å¤§å±ï¼šæ¯ç§’è·³åŠ¨10ä¸‡+è®¢å•ã€GMVæ›²çº¿ä¸åº“å­˜çƒ­åŠ›å›¾ï¼Œè¿è¥å›¢é˜Ÿéœ€åœ¨æ¯«ç§’çº§å»¶è¿Ÿå†…æ•æ‰å¼‚å¸¸ï¼›</p>
</li>
<li>
<p>æ”¿åŠ¡åº”æ€¥æŒ‡æŒ¥ä¸­å¿ƒæ€åŠ¿å¤§å±ï¼šå°é£è·¯å¾„ã€æ•‘æ´è½¦è¾†ã€äººå£çƒ­åŠ›åœ¨åŒä¸€é¢4Kå¼§å¹•ä¸Šå®æ—¶å åŠ ï¼Œä¸€æ—¦é”™ä½å°±å¯èƒ½è´»è¯¯é»„é‡‘4å°æ—¶ã€‚</p>
</li>
</ul>
<p>ç„¶è€Œï¼Œè¿™ä¸€é¢†åŸŸçš„å¿«é€Ÿå‘å±•ä¹Ÿå¸¦æ¥äº†æ–°çš„æŠ€æœ¯æŒ‘æˆ˜ã€‚ä¸€æ–¹é¢ï¼Œå¤§å±é€‚é…é¢ä¸´ç€å¤šåˆ†è¾¨ç‡ã€å®½é«˜æ¯”å·®å¼‚å¯¼è‡´çš„å¸ƒå±€å˜å½¢ä¸å…ƒç´ é”™ä½é—®é¢˜ï¼›å¦ä¸€æ–¹é¢ï¼Œå®æ—¶æ¶ˆæ¯çš„é«˜é¢‘æ•°æ®å†²å‡»ï¼Œä½¿å¾—æ€§èƒ½æŸè€—ä¸ç”¨æˆ·ä½“éªŒå¤±è¡¡ã€‚</p>
<p><strong>æœ¬æ–‡æ–¹æ¡ˆå¯å®ç°ï¼š</strong></p>
<ol>
<li>
<p>è·¨åˆ†è¾¨ç‡é›¶å˜å½¢é€‚é…ï¼šä¸€å¥—ä»£ç è¦†ç›–720P<del>16Kã€16:9</del>32:9ä»»æ„æ¯”ä¾‹ï¼Œå¸ƒå±€è¯¯å·®â‰¤1åƒç´ ï¼›</p>
</li>
<li>
<p>æ¯ç§’300+å¼¹å¹•æ¶ˆæ¯æµç•…æ¸²æŸ“ï¼šCPUå ç”¨é™ä½40%ï¼Œæ‰å¸§ç‡&lt;0.1%ï¼Œè®©"åŒ11+æ˜¥æ™š"çº§å¹¶å‘ä¹Ÿèƒ½ä¸æ»‘å¦‚åˆã€‚</p>
</li>
</ol>
<p>ä»"è¢«åŠ¨é€‚é…"åˆ°"ä¸»åŠ¨æ§åˆ¶"ï¼Œæˆ‘ä»¬å°†ç”¨åŸç”ŸæŠ€æœ¯æ ˆçš„æè‡´åˆ©ç”¨ï¼Œä¸ºå¤§å±å¼€å‘æä¾›ç ´å±€ä¹‹é“ã€‚</p>
<h3 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šä»â€œè¢«åŠ¨é€‚é…â€åˆ°â€œä¸»åŠ¨æ§åˆ¶â€â€”â€”CSSÂ å˜é‡Â +Â è§†å£å•ä½çš„å¤§å±é€‚é…ä½“ç³»</h3>
<h4 data-id="heading-2">1.Â å¤§å±é€‚é…çš„ä¸‰å¤§æŠ€æœ¯è¯¯åŒº</h4>

























<table><thead><tr><th>è¯¯åŒºç¼–å·</th><th>è¯¯åŒºæè¿°</th><th>åä¾‹è¯´æ˜</th></tr></thead><tbody><tr><td>è¯¯åŒº1</td><td>è¿‡åº¦ä¾èµ–JSåŠ¨æ€è®¡ç®—ï¼ˆresizeäº‹ä»¶ç›‘å¬çš„æ€§èƒ½é™·é˜±ï¼‰</td><td>æŸæ”¿åŠ¡æŒ‡æŒ¥ä¸­å¿ƒ4Kå¼§å¹•ï¼Œå› onresizeäº‹ä»¶å†…ç›´æ¥æ“ä½œ200+Â DOMèŠ‚ç‚¹ï¼Œå¸§ç‡ä»60fpsè·Œè‡³18fpsï¼Œé¼ æ ‡æ‹–æ‹½åœ°å›¾å‡ºç°è‚‰çœ¼å¯è§çš„"æ‹–å½±"ã€‚</td></tr><tr><td>è¯¯åŒº2</td><td>ç›²ç›®ä½¿ç”¨scaleç¼©æ”¾ï¼ˆå­—ä½“æ¨¡ç³Šã€äº‹ä»¶åç§»çš„éšæ€§é—®é¢˜ï¼‰</td><td>é‡‘èæŠ¥è¡¨å¤§å±åœ¨8Kå°é—´è·LEDå¢™ä½¿ç”¨<code>transform:Â scale(2.25)</code>æ•´ä½“æ”¾å¤§ï¼Œ12ptå®‹ä½“è¢«æ‹‰ä¼¸ä¸º27ptï¼Œç¬”ç”»å‘è™šï¼›åŒæ—¶clickåæ ‡åç§»13%ï¼Œå¯¼è‡´"è¯¦æƒ…æŒ‰é’®"ç‚¹ä¸å¼€ï¼Œå®¢æˆ·è¢«è¿«ä¸´æ—¶ä¸Šçº¿"ç‚¹å‡»åç§»æ ¡å‡†"è¡¥ä¸ã€‚</td></tr><tr><td>è¯¯åŒº3</td><td>åª’ä½“æŸ¥è¯¢å †ç Œï¼ˆç»´æŠ¤æˆæœ¬æŒ‡æ•°çº§å¢é•¿çš„æ ¹æºï¼‰</td><td>æŸäº¤é€šå¯è§†åŒ–é¡¹ç›®å†™å‡º140æ¡@mediaç‰‡æ®µï¼Œæ–°å¢ä¸€ä¸ª5120Ã—1440è¶…å®½å±éœ€æ±‚æ—¶ï¼Œå¼€å‘åŒå­¦ç”¨2å¤©å®Œæˆ"åŠ æ–­ç‚¹-æµ‹è¯•-å›å½’"ï¼Œç»“æœä»æ¼æ‰8ä¸ªå°åˆ†è¾¨ç‡ï¼Œè¢«ä¸€çº¿è¿ç»´åæ§½"æ”¹ä¸€è¡Œï¼Œå´©ä¸‰å¤„"ã€‚</td></tr></tbody></table>
<h4 data-id="heading-3">2.Â CSSå˜é‡+calc()çš„æŠ€æœ¯è§£æ„</h4>
<h4 data-id="heading-4">æ ¸å¿ƒå…¬å¼ï¼š</h4>
<blockquote>
<p>å…ƒç´ å°ºå¯¸Â =Â è®¾è®¡ç¨¿å€¼Â /Â åŸºå‡†å€¼Â Ã—Â è§†å£å•ä½</p>
</blockquote>
<h4 data-id="heading-5">åŒå‘ç»‘å®šæœºåˆ¶ï¼š</h4>
<p>é€šè¿‡Â <code>:root</code>Â å˜é‡å®ç°å…¨å±€åŸºå‡†çš„"ä¸€æ”¹å…¨æ”¹"ã€‚</p>
<h4 data-id="heading-6">è§†å£å•ä½çš„ç²¾ç»†åŒ–è¿ç”¨ï¼š</h4>
<ul>
<li>
<p><code>vw</code>Â ä¸»å¯¼å¸ƒå±€</p>
</li>
<li>
<p><code>vh</code>Â è¾…åŠ©é€‚é…</p>
</li>
</ul>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-pseudo">:root</span> {
  <span class="hljs-attr">--base-width</span>: <span class="hljs-number">1920px</span>;
  <span class="hljs-attr">--base-height</span>: <span class="hljs-number">1080px</span>;
}

<span class="hljs-selector-class">.element</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100px</span> / <span class="hljs-built_in">var</span>(--base-width) * <span class="hljs-number">100vw</span>);
  <span class="hljs-attribute">height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100px</span> / <span class="hljs-built_in">var</span>(--base-height) * <span class="hljs-number">100vh</span>);
}
</code></pre>
<h4 data-id="heading-7">3.Â å¤æ‚åœºæ™¯çš„è¿›é˜¶å®è·µ</h4>
<p>åµŒå¥—å®¹å™¨é€‚é…ï¼šå­å…ƒç´ åŸºäºçˆ¶å®¹å™¨è®¾è®¡ç¨¿çš„ç›¸å¯¹è®¡ç®—æ³•</p>
<pre><code class="hljs language-css" lang="css">    <span class="hljs-comment">/* ç¤ºä¾‹ä½¿ç”¨ */</span>
    <span class="hljs-selector-class">.header</span> {
        <span class="hljs-attr">--target-width</span>: <span class="hljs-number">1920</span>;
        <span class="hljs-attr">--target-height</span>: <span class="hljs-number">80</span>;
        <span class="hljs-attr">--target-font-size</span>: <span class="hljs-number">24</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-built_in">var</span>(--target-width) / <span class="hljs-built_in">var</span>(--base-width) * <span class="hljs-number">100vw</span>);
        <span class="hljs-attribute">height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-built_in">var</span>(--target-height) / <span class="hljs-built_in">var</span>(--base-height) * <span class="hljs-number">100vh</span>);
        <span class="hljs-attribute">font-size</span>: <span class="hljs-built_in">var</span>(--font-size-base);
    }
</code></pre>
<p>åŠ¨æ€åŸºå‡†åˆ‡æ¢ï¼šJSä»‹å…¥ä¿®æ”¹å˜é‡å®ç°åˆ†å±/å¼ºåˆ¶æ¯”ä¾‹åœºæ™¯</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">style</span>.<span class="hljs-title function_">setProperty</span>(<span class="hljs-string">'--base-width'</span>, <span class="hljs-string">'960px'</span>);
<span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">style</span>.<span class="hljs-title function_">setProperty</span>(<span class="hljs-string">'--base-height'</span>, <span class="hljs-string">'540px'</span>);
</code></pre>
<p>æé™æ¡ˆä¾‹å¤„ç†ï¼šæœ€å°å°ºå¯¸é™åˆ¶ã€è¶…é«˜æ¸…åˆ†è¾¨ç‡ï¼ˆ8K+ï¼‰é€‚é…æ–¹æ¡ˆ</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.element</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-built_in">max</span>(<span class="hljs-built_in">calc</span>(<span class="hljs-number">100px</span> / <span class="hljs-built_in">var</span>(--base-width) * <span class="hljs-number">100vw</span>), <span class="hljs-number">50px</span>);
  <span class="hljs-attribute">height</span>: <span class="hljs-built_in">max</span>(<span class="hljs-built_in">calc</span>(<span class="hljs-number">100px</span> / <span class="hljs-built_in">var</span>(--base-height) * <span class="hljs-number">100vh</span>), <span class="hljs-number">50px</span>);
}
// å½“ <span class="hljs-attr">--base-width</span> â‰¥ <span class="hljs-number">7680</span> æ—¶ï¼Œclamp ä¿è¯è®¡ç®—ç»“æœä¸ä¼š &lt;<span class="hljs-number">1</span> pxï¼Œ
// é¿å…æç«¯ç®—å€¼å¾— <span class="hljs-number">0</span> å¯¼è‡´å¸ƒå±€æ¶ˆå¤±ã€‚
<span class="hljs-selector-class">.element</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-built_in">clamp</span>(<span class="hljs-built_in">calc</span>(<span class="hljs-number">120px</span> / <span class="hljs-built_in">var</span>(--base-width) * <span class="hljs-number">100vw</span>), <span class="hljs-number">1px</span>, <span class="hljs-number">100vw</span>);
}
</code></pre>
<h4 data-id="heading-8">4.Â æ€§èƒ½å¯¹æ¯”å®éªŒ</h4>
<p>å››ç§æ–¹æ¡ˆï¼ˆåª’ä½“æŸ¥è¯¢/rem/scale/CSSå˜é‡ï¼‰åœ¨1920Ã—1080åˆ°7680Ã—4320åˆ†è¾¨ç‡ä¸‹çš„è¡¨ç°æ•°æ®</p>
<p>é€šè¿‡å¯¹å››ç§é€‚é…æ–¹æ¡ˆçš„æ€§èƒ½å¯¹æ¯”å®éªŒï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</p>


















































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>å¸§ç‡æ³¢åŠ¨(Â±fps)</th><th>é‡æ’æ¬¡æ•°/åˆ†é’Ÿ</th><th>ä»£ç é‡(è¡Œ)</th><th>éœ€æ±‚å˜æ›´è€—æ—¶(h)</th><th>8KÂ é¦–æ¬¡æ¸²æŸ“(ms)</th><th>å›¢é˜Ÿåä½œæ•ˆç‡</th></tr></thead><tbody><tr><td>åª’ä½“æŸ¥è¯¢</td><td>15</td><td>20</td><td>ï½1200</td><td>6.5</td><td>280</td><td>ä½</td></tr><tr><td>rem</td><td>8</td><td>12</td><td>ï½850</td><td>4.2</td><td>220</td><td>ä¸­</td></tr><tr><td>scale</td><td>5</td><td>5</td><td>ï½300</td><td>1.8</td><td>160</td><td>é«˜</td></tr><tr><td>CSSå˜é‡+calc</td><td>3</td><td>3</td><td>ï½320</td><td>1.0</td><td>145</td><td>é«˜</td></tr></tbody></table>
<h3 data-id="heading-9">ç¬¬äºŒéƒ¨åˆ†ï¼šä¼ä¸šçº§å¼¹å¹•ç³»ç»Ÿçš„æ¶æ„è®¾è®¡ä¸æ€§èƒ½ä¼˜åŒ–</h3>
<p>æˆ‘æœ¬æ¬¡åšçš„å¤§å±ï¼Œå¸ƒå±€ä¸ºå·¦ä¸­å³å¸ƒå±€ï¼Œå·¦ä¾§ä¸ºç›´æ’­è§‚çœ‹ï¼Œä¸­é—´ä¸ºå®æ—¶å¤§å•åŒºåŸŸï¼Œå³ä¾§ä¸ºé‚€è¯·æ‹‰æ–°æ’è¡Œæ¦œã€‚ä¸ºäº†æ›´å¥½çš„å’Œç”¨æˆ·åé¦ˆï¼Œæˆ‘ä»¬åœ¨å¤§å±é¡¹ç›®ä¸­è¿˜åŠ å…¥äº†å¼¹å¹•åŠŸèƒ½ã€‚ç”±äºå¤§å±çš„åˆ†è¾¨ç‡é€šå¸¸è¾ƒé«˜ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è€ƒè™‘åˆ°å¤§å±é¡¹ç›®çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a98d764ec1c426c9b7813c871bc07b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSe56qd5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766636190&amp;x-signature=6u70BWnoU0RJgnl1dz%2FBHz53YoI%3D" alt="æ•°æ®å¤§å±.png" loading="lazy"/></p>
<h4 data-id="heading-10">1.Â å¼¹å¹•ç³»ç»Ÿçš„æŠ€æœ¯æŒ‘æˆ˜æ‹†è§£</h4>





















<table><thead><tr><th>æŒ‘æˆ˜</th><th>æè¿°</th></tr></thead><tbody><tr><td>é«˜é¢‘æ¶ˆæ¯å¤„ç†å‹åŠ›</td><td>å³°å€¼120æ¡/ç§’ï¼ŒDOMèŠ‚ç‚¹è¾¾3200ä¸ªï¼Œå†…å­˜ä»48MBæ¶¨è‡³310MBï¼ŒGCå¡é¡¿450ms/æ¬¡</td></tr><tr><td>è§†è§‰ç§©åºç»´æŠ¤éœ€æ±‚</td><td>å¼¹å¹•é‡å ç‡è¾¾32%ï¼Œç”¨æˆ·è¯†åˆ«ç‡é™è‡³38%ï¼ˆçœ¼åŠ¨å®éªŒæ•°æ®ï¼‰</td></tr><tr><td>èµ„æºå ç”¨æ§åˆ¶éš¾é¢˜</td><td>DOMèŠ‚ç‚¹æŒç»­å¢é•¿ï¼Œé•¿æœŸè¿è¡Œåæ€§èƒ½ä¸‹é™ç”šè‡³å´©æºƒ</td></tr></tbody></table>
<h4 data-id="heading-11">2.Â æ ¸å¿ƒæ¨¡å—çš„å®ç°åŸç†</h4>
<p>ç±»å‹ç³»ç»Ÿè®¾è®¡ï¼šåŸºäºTypeScriptçš„æ¶ˆæ¯ç»“æ„ä¸çŠ¶æ€ç®¡ç†ï¼ˆä¸ºä»€ä¹ˆisRemovingæ ‡è®°æ˜¯å¿…è¦çš„ï¼Ÿï¼‰</p>
<pre><code class="hljs language-js" lang="js">interface <span class="hljs-title class_">Message</span> {
  <span class="hljs-attr">id</span>: string;
  <span class="hljs-attr">content</span>: string;
  <span class="hljs-attr">isRemoving</span>: boolean;
}
isRemoving <span class="hljs-comment">// æ ‡è®°ç”¨äºæ ‡è¯†æ¶ˆæ¯æ˜¯å¦æ­£åœ¨ç§»é™¤ï¼Œè¿™å¯¹äºæ¶ˆæ¯çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†éå¸¸é‡è¦ã€‚</span>
</code></pre>
<p>é˜Ÿåˆ—æœºåˆ¶ï¼šåŒé˜Ÿåˆ—ï¼ˆnormal/invitationï¼‰çš„ä¼˜å…ˆçº§è°ƒåº¦ç­–ç•¥</p>
<p>å¼¹å¹•ç³»ç»Ÿé‡‡ç”¨åŒé˜Ÿåˆ—æœºåˆ¶ï¼Œåˆ†ä¸ºæ™®é€šæ¶ˆæ¯é˜Ÿåˆ—å’Œé‚€è¯·æ¶ˆæ¯é˜Ÿåˆ—ã€‚é€šè¿‡ä¼˜å…ˆçº§è°ƒåº¦ç­–ç•¥ï¼Œå¯ä»¥ç¡®ä¿é‡è¦æ¶ˆæ¯ä¼˜å…ˆå±•ç¤ºï¼Œé‡‡ç”¨æŠ¢å å¼ä¼˜å…ˆçº§ï¼š</p>
<ul>
<li>
<p>é‚€è¯·é˜Ÿåˆ—æœ‰æ–°æ¶ˆæ¯æ—¶ï¼Œè‹¥å½“å‰æ™®é€šå¼¹å¹•å·²æ’­æ”¾Â â‰¤50%Â æ—¶é•¿ï¼Œç«‹å³æš‚åœå¹¶æ’å…¥é‚€è¯·æ¶ˆæ¯ï¼›</p>
</li>
<li>
<p>æ™®é€šå¼¹å¹•è¢«æŠ¢å åé‡æ–°å…¥é˜Ÿï¼Œç­‰å¾…ä¸‹ä¸€è½®æ’­æ”¾ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">normalQueue</span>: <span class="hljs-title class_">Message</span>[ ] = [ ];
<span class="hljs-keyword">const</span> <span class="hljs-attr">invitationQueue</span>: <span class="hljs-title class_">Message</span>[ ] = [ ];

<span class="hljs-comment">/* æ’­æ”¾ä¸€æ¡æ¶ˆæ¯ */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">play</span> = (<span class="hljs-params">m: Message</span>) =&gt; {
  <span class="hljs-title function_">setMsg</span>(m);
  startRef.<span class="hljs-property">current</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  <span class="hljs-keyword">const</span> dur = m.<span class="hljs-property">duration</span> ?? <span class="hljs-number">4000</span>;
  timerRef.<span class="hljs-property">current</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setMsg</span>(<span class="hljs-literal">null</span>);
  }, dur);
};

<span class="hljs-comment">/* æŠ¢å é€»è¾‘ */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">tryPlay</span> = (<span class="hljs-params">m: Message, isInvite: <span class="hljs-built_in">boolean</span></span>) =&gt; {
    <span class="hljs-keyword">if</span> (!msg) {                 <span class="hljs-comment">// ç©ºé—²ï¼Œç›´æ¥æ’­</span>
      <span class="hljs-title function_">play</span>(m);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (isInvite) {             <span class="hljs-comment">// é‚€è¯·æ¶ˆæ¯</span>
      <span class="hljs-keyword">const</span> played = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startRef.<span class="hljs-property">current</span>;
      <span class="hljs-keyword">const</span> total = msg.<span class="hljs-property">duration</span> ?? <span class="hljs-number">4000</span>;
      <span class="hljs-keyword">if</span> (played / total &lt;= <span class="hljs-number">0.5</span>) {          <span class="hljs-comment">// â‰¤50% æ—¶é•¿</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">clearTimeout</span>(timerRef.<span class="hljs-property">current</span>);
        <span class="hljs-title function_">pushNormal</span>(msg);                    <span class="hljs-comment">// è¢«æŠ¢å çš„æ™®é€šå¼¹å¹•é‡æ–°å…¥é˜Ÿ</span>
        <span class="hljs-title function_">play</span>(m);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">/* è¶…è¿‡ 50%ï¼Œç­‰å½“å‰æ’­å®Œå†æ’­é‚€è¯· */</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">play</span>(m), (total - played));
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">/* æ™®é€šæ¶ˆæ¯ï¼Œç›´æ¥æ’é˜Ÿï¼ˆå¤–éƒ¨å·²ç»æ’å¥½äº†ï¼‰ */</span>
    }
  };

<span class="hljs-keyword">function</span> <span class="hljs-title function_">processQueue</span>(<span class="hljs-params"/>) {
Â Â <span class="hljs-keyword">if</span> (invitationQueue.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
Â Â Â Â <span class="hljs-title function_">tryPlay</span>(invitationQueue.<span class="hljs-title function_">shift</span>()!, <span class="hljs-literal">true</span>)
Â Â } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (normalQueue.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
Â Â Â Â <span class="hljs-title function_">tryPlay</span>(normalQueue.<span class="hljs-title function_">shift</span>()!, <span class="hljs-literal">false</span>)
Â Â }
}
</code></pre>
<p>èŠ‚æµä¸é™æµï¼šä»â€œå µâ€åˆ°â€œç–â€çš„æµé‡æ§åˆ¶å“²å­¦ï¼ˆthrottleå‡½æ•°çš„å‚æ•°è°ƒæ ¡é€»è¾‘ï¼‰,throttleÂ é™æµå‡½æ•°Â limitÂ åŠ¨æ€è®¡ç®—,ä¿è¯æ¸²æŸ“çº¿ç¨‹å–˜æ¯ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/* --------------- åŠ¨æ€ throttle --------------- */</span>
<span class="hljs-keyword">let</span> messageRate = <span class="hljs-number">0</span>;        <span class="hljs-comment">// å®æ—¶æ¡/ç§’</span>
<span class="hljs-keyword">let</span> lastReset = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
<span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;

<span class="hljs-comment">/* ä¸šåŠ¡å±‚æ¯æ¥ä¸€æ¡æ¶ˆæ¯è°ƒç”¨ä¸€æ¬¡å³å¯ */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateMessageRate</span>(<span class="hljs-params"/>) {
  count++;
  <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  <span class="hljs-keyword">const</span> elapsed = (now - lastReset) / <span class="hljs-number">1000</span>;
  <span class="hljs-keyword">if</span> (elapsed &gt;= <span class="hljs-number">1</span>) {          <span class="hljs-comment">// æ¯ç§’åˆ·æ–°ä¸€æ¬¡</span>
    messageRate = count / elapsed;
    count = <span class="hljs-number">0</span>;
    lastReset = now;
  }
}

<span class="hljs-comment">/* åŠ¨æ€è®¡ç®— limit */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getLimit</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">100</span>, <span class="hljs-number">1000</span> - messageRate * <span class="hljs-number">6</span>);

<span class="hljs-comment">/**
 * æ”¯æŒåŠ¨æ€ limit çš„ throttle
 * <span class="hljs-doctag">@param</span> func    çœŸæ­£è¦æ‰§è¡Œçš„å‡½æ•°
 * <span class="hljs-doctag">@param</span> getLim  è¿”å›å½“å‰ limit çš„å‡½æ•°ï¼ˆå¯çœç•¥ï¼Œé»˜è®¤ç”¨å†…ç½® getLimitï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> throttle&lt;T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[]) =&gt; <span class="hljs-built_in">void</span>&gt;(
  <span class="hljs-attr">func</span>: T,
  <span class="hljs-attr">getLim</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">number</span> = getLimit
): T {
  <span class="hljs-keyword">let</span> lastRan = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> <span class="hljs-attr">timer</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setTimeout</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">this</span>: <span class="hljs-built_in">any</span>, ...args: Parameters&lt;T&gt;</span>) {
    <span class="hljs-keyword">const</span> limit = <span class="hljs-title function_">getLim</span>();          <span class="hljs-comment">// æ¯æ¬¡æ‰§è¡Œå‰é‡æ–°è®¡ç®—</span>
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> remain = limit - (now - lastRan);

    <span class="hljs-keyword">if</span> (remain &lt;= <span class="hljs-number">0</span>) {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      lastRan = now;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);
      timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        lastRan = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      }, remain);
    }
  } <span class="hljs-keyword">as</span> T;
}
</code></pre>
<h4 data-id="heading-12">3.Â æ€§èƒ½ä¼˜åŒ–çš„äº”å¤§ç»´åº¦</h4>
<p>æƒé‡è®¡ç®—æ¨¡å‹ï¼šå¦‚ä½•ç”¨â€œå­˜åœ¨æ—¶é—´+è¶…æ—¶æƒ©ç½šâ€å…¬å¼ç­›é€‰é«˜ä»·å€¼æ¶ˆæ¯</p>
<p>ä¸ºäº†ç­›é€‰é«˜ä»·å€¼æ¶ˆæ¯ï¼Œå¯ä»¥é‡‡ç”¨â€œå­˜åœ¨æ—¶é—´+è¶…æ—¶æƒ©ç½šâ€çš„æƒé‡è®¡ç®—æ¨¡å‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä¼˜å…ˆå±•ç¤ºé‡è¦æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-js" lang="js">Â Â <span class="hljs-keyword">const</span> calculateMessageWeight = (<span class="hljs-attr">message</span>: <span class="hljs-title class_">MessageItem</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> {
Â Â Â Â <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
Â Â Â Â <span class="hljs-keyword">const</span> lifetime = now - message.<span class="hljs-property">timestamp</span>;

Â Â Â Â <span class="hljs-comment">// æƒé‡ = å­˜åœ¨æ—¶é—´(ç§’) + æ˜¯å¦å·²è¶…è¿‡æ˜¾ç¤ºæ—¶é•¿(æ˜¯åˆ™+1000)</span>
Â Â Â Â <span class="hljs-keyword">return</span> (lifetime / <span class="hljs-number">1000</span>) + (lifetime &gt; displayDuration ? <span class="hljs-number">1000</span> : <span class="hljs-number">0</span>);
Â Â };
</code></pre>
<p>åŠ¨ç”»ä¸DOMï¼šsetTimeouté…åˆCSSåŠ¨ç”»çš„å¹³æ»‘ç§»é™¤æ–¹æ¡ˆï¼ˆé¿å…layoutÂ thrashingï¼‰</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¹³æ»‘ç§»é™¤å…ƒç´ ï¼ˆå¯å•æ¡ä¹Ÿå¯æ‰¹é‡ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">smoothRemoveElement</span> = (<span class="hljs-params">
  elementId: string | string[], <span class="hljs-comment">// æ”¯æŒå• ID æˆ–æ•°ç»„</span>
  containerRef: React.RefObject&lt;HTMLDivElement&gt;,
  queue: MessageItem[]
</span>) =&gt; {
  <span class="hljs-keyword">const</span> ids = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(elementId) ? elementId : [elementId];
  <span class="hljs-keyword">const</span> <span class="hljs-attr">toRemove</span>: <span class="hljs-title class_">HTMLElement</span>[] = [];

  <span class="hljs-comment">/* ---------- 1. æ‰¹é‡è¯» ---------- */</span>
  ids.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> idx = queue.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === id);
    <span class="hljs-keyword">if</span> (idx !== -<span class="hljs-number">1</span> &amp;&amp; !queue[idx].<span class="hljs-property">isRemoving</span>) {
      queue[idx] = { ...queue[idx], <span class="hljs-attr">isRemoving</span>: <span class="hljs-literal">true</span> };
    }
    <span class="hljs-keyword">const</span> el = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(id);
    <span class="hljs-keyword">if</span> (el &amp;&amp; containerRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">contains</span>(el)) {
      <span class="hljs-comment">// å¼ºåˆ¶åŒæ­¥å¸ƒå±€ä»…å‘ç”Ÿåœ¨è¿™é‡Œï¼ˆä¸€æ¬¡ï¼‰</span>
      <span class="hljs-keyword">void</span> el.<span class="hljs-property">offsetTop</span>;
      toRemove.<span class="hljs-title function_">push</span>(el);
    }
  });

  <span class="hljs-comment">/* ---------- 2. æ‰¹é‡å†™ ---------- */</span>
  toRemove.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> el.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'fade-out'</span>));

  <span class="hljs-comment">/* ---------- 3. ä¸‹ä¸€å®ä»»åŠ¡å†ç§»é™¤ ---------- */</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (!containerRef.<span class="hljs-property">current</span>) <span class="hljs-keyword">return</span>;
    toRemove.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (containerRef.<span class="hljs-property">current</span>!.<span class="hljs-title function_">contains</span>(el)) {
        containerRef.<span class="hljs-property">current</span>!.<span class="hljs-title function_">removeChild</span>(el);
      }
      displayedNormalIds.<span class="hljs-property">current</span>.<span class="hljs-title function_">delete</span>(el.<span class="hljs-property">id</span>);
      <span class="hljs-keyword">const</span> idx = queue.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === el.<span class="hljs-property">id</span>);
      <span class="hljs-keyword">if</span> (idx !== -<span class="hljs-number">1</span>) queue.<span class="hljs-title function_">splice</span>(idx, <span class="hljs-number">1</span>);
    });
    <span class="hljs-title function_">setUpdateTrigger</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, <span class="hljs-number">0</span>);   <span class="hljs-comment">// 0 ms å³å¯ï¼Œæ”¾åˆ°ä¸‹ä¸€å®ä»»åŠ¡</span>
};
</code></pre>
<p>å›¾ç‰‡é¢„åŠ è½½ï¼šç¼“å­˜ç­–ç•¥ä¸å¤±è´¥é™çº§çš„ç”¨æˆ·ä½“éªŒä¿éšœ</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> preloadImage = (<span class="hljs-attr">url</span>: string): <span class="hljs-title class_">Promise</span>&lt;boolean&gt; =&gt; {
Â Â Â Â <span class="hljs-comment">// å¦‚æœå·²åŠ è½½è¿‡ï¼Œç›´æ¥è¿”å›æˆåŠŸ</span>
Â Â Â Â <span class="hljs-keyword">if</span> (preloadedImages.<span class="hljs-title function_">has</span>(url)) {
Â Â Â Â Â Â <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-literal">true</span>);
Â Â Â Â }
Â Â Â Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
Â Â Â Â Â Â <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
Â Â Â Â Â Â <span class="hljs-comment">// å›¾ç‰‡åŠ è½½å®Œæˆ</span>
Â Â Â Â Â Â img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> {
Â Â Â Â Â Â Â Â preloadedImages.<span class="hljs-title function_">add</span>(url); <span class="hljs-comment">// åŠ å…¥ç¼“å­˜</span>
Â Â Â Â Â Â Â Â <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">true</span>);
Â Â Â Â Â Â };
Â Â Â Â Â Â <span class="hljs-comment">// å›¾ç‰‡åŠ è½½å¤±è´¥</span>
Â Â Â Â Â Â img.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`å›¾ç‰‡é¢„åŠ è½½å¤±è´¥: <span class="hljs-subst">${url}</span>`</span>, error);
Â Â Â Â Â Â Â Â <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">false</span>);
Â Â Â Â Â Â };
Â Â Â Â Â Â img.<span class="hljs-property">src</span> = url; <span class="hljs-comment">// å¼€å§‹åŠ è½½</span>
Â Â Â Â });
Â Â };
</code></pre>
<p>å†…å­˜ç®¡ç†ï¼šé˜Ÿåˆ—é•¿åº¦é™åˆ¶ä¸DOMèŠ‚ç‚¹å®æ—¶æ¸…ç†çš„è”åŠ¨æœºåˆ¶</p>
<p>ä¸ºäº†æ§åˆ¶å†…å­˜å ç”¨ï¼Œå¼¹å¹•ç³»ç»Ÿé‡‡ç”¨é˜Ÿåˆ—é•¿åº¦é™åˆ¶(æ ¹æ®å±å¹•é«˜åº¦åŠ¨æ€è®¡ç®—)å’ŒDOMèŠ‚ç‚¹å®æ—¶æ¸…ç†çš„è”åŠ¨æœºåˆ¶ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SINGLE_HEIGHT</span> = <span class="hljs-number">40</span>;          <span class="hljs-comment">// é»˜è®¤å•æ¡é«˜åº¦ï¼Œå®é™…ä»¥ CSS ä¸ºå‡†</span>
<span class="hljs-keyword">let</span> maxQueueLength = <span class="hljs-number">100</span>;          <span class="hljs-comment">// å…ˆç»™ä¸€ä¸ªé»˜è®¤å€¼</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">calcMaxQueueLength</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> h = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">10</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(h / <span class="hljs-variable constant_">SINGLE_HEIGHT</span> * <span class="hljs-number">2</span>));
};

<span class="hljs-comment">/* åˆå§‹åŒ– + ç›‘å¬ resize */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">startResizeObserver</span>(<span class="hljs-params"/>) {
  maxQueueLength = <span class="hljs-title function_">calcMaxQueueLength</span>();
  <span class="hljs-keyword">const</span> onResize = <span class="hljs-title function_">throttle</span>(<span class="hljs-function">() =&gt;</span> {
    maxQueueLength = <span class="hljs-title function_">calcMaxQueueLength</span>();
  }, <span class="hljs-number">500</span>);
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, onResize);
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, onResize);
}

<span class="hljs-comment">/* å¤–éƒ¨ç›´æ¥è¯»å½“å‰ä¸Šé™ */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getMaxQueueLength</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> maxQueueLength;
}

<span class="hljs-comment">// -------------------------------------------------------------------------</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_QUEUE_LENGTH</span> = <span class="hljs-title function_">getMaxQueueLength</span>();
<span class="hljs-comment">// æ·»åŠ æ¶ˆæ¯ï¼ˆå¸¦èŠ‚æµå¤„ç†ï¼‰</span>
<span class="hljs-keyword">const</span> addNormalMessage = <span class="hljs-title function_">useCallback</span>(
<span class="hljs-title function_">throttle</span>(throttleInterval, <span class="hljs-function">(<span class="hljs-params"> orderInfo:AddOrderMessage</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">NormalMessage</span> = {
    <span class="hljs-attr">id</span>: <span class="hljs-title function_">generateId</span>(<span class="hljs-title class_">BulletType</span>.<span class="hljs-property">NORMAL</span>),
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">BulletType</span>.<span class="hljs-property">NORMAL</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    ...orderInfo
  };
  <span class="hljs-comment">// ç¡®ä¿é˜Ÿåˆ—ä¸è¶…è¿‡æœ€å¤§é•¿åº¦</span>
  <span class="hljs-keyword">if</span> (normalQueue.<span class="hljs-property">current</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable constant_">MAX_QUEUE_LENGTH</span>) {
    <span class="hljs-comment">// ç§»é™¤æœ€æ—©çš„æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> oldest = normalQueue.<span class="hljs-property">current</span>.<span class="hljs-title function_">shift</span>();
    <span class="hljs-keyword">if</span> (oldest &amp;&amp; !oldest.<span class="hljs-property">isRemoving</span>) {
      <span class="hljs-title function_">smoothRemoveElement</span>(oldest.<span class="hljs-property">id</span>, normalContainerRef, normalQueue.<span class="hljs-property">current</span>);
    }
  }
  normalQueue.<span class="hljs-property">current</span>.<span class="hljs-title function_">push</span>(message);
  <span class="hljs-keyword">if</span> (!normalIsProcessing.<span class="hljs-property">current</span>) {
    <span class="hljs-title function_">processNormalQueue</span>();
  }
}),
[ throttleInterval, processNormalQueue]
);
</code></pre>
<p>å¤–éƒ¨æ¥å£è®¾è®¡ï¼šuseImperativeHandleæš´éœ²çš„å¯æ§æ€§ä¸å°è£…è¾¹ç•Œå¹³è¡¡</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æä¾›ç»™çˆ¶ç»„ä»¶çš„æ§åˆ¶æ–¹æ³•</span>
Â Â <span class="hljs-title function_">useImperativeHandle</span>(ref, <span class="hljs-function">() =&gt;</span> ({
Â Â Â Â addNormalMessage,
Â Â Â Â addInvitationMessage,
Â Â Â Â clearAll,
Â Â Â Â <span class="hljs-attr">getNormalQueueLength</span>: <span class="hljs-function">() =&gt;</span> normalQueue.<span class="hljs-property">current</span>.<span class="hljs-property">length</span>,
Â Â Â Â <span class="hljs-attr">getInvitationQueueLength</span>: <span class="hljs-function">() =&gt;</span> invitationQueue.<span class="hljs-property">current</span>.<span class="hljs-property">length</span>,
Â Â Â Â <span class="hljs-attr">getNormalDisplayCount</span>: <span class="hljs-function">() =&gt;</span> displayedNormalIds.<span class="hljs-property">current</span>.<span class="hljs-property">size</span>,
Â Â Â Â <span class="hljs-attr">setSoundVolume</span>: <span class="hljs-function">(<span class="hljs-params">volume: number</span>) =&gt;</span> {
Â Â Â Â Â Â soundVolumeRef.<span class="hljs-property">current</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>, volume)); <span class="hljs-comment">// é™åˆ¶éŸ³é‡0-1</span>
Â Â Â Â },
Â Â Â Â <span class="hljs-comment">// éŸ³é¢‘ç›¸å…³å¤–éƒ¨æ¥å£</span>
Â Â Â Â initAudio,
Â Â Â Â isAudioInitialized,
Â Â Â Â cleanAudio,
Â Â Â Â openSoundEffectHandle,
Â Â }));
</code></pre>
<h4 data-id="heading-13">4.Â ä¸šåŠ¡åœºæ™¯çš„æ‰©å±•é€‚é…</h4>
<ul>
<li>
<p>ç›´æ’­åœºæ™¯ï¼šæ¶ˆæ¯ä¼˜å…ˆçº§åŠ¨æ€è°ƒæ•´ï¼ˆå¦‚å¤§è®¢å•æ¶ˆæ¯ï¼‰</p>
<p>å†åŸæœ‰çš„æƒé‡å‡½æ•°ä¸­æ–°å¢priorityWeightsä¼˜å…ˆçº§æƒé‡é…ç½®ã€businessBonusesä¸šåŠ¡åœºæ™¯åŠ åˆ†é…ç½®æ¥å®ç°æ¶ˆæ¯ä¼˜å…ˆçº§åŠ¨æ€è°ƒæ•´ã€‚</p>
<p><code>å…¬å¼ï¼šæœ€ç»ˆæƒé‡Â =Â åŸæœ‰æ·˜æ±°æƒé‡Â -Â ä¼˜å…ˆçº§å‡æƒÂ -Â ä¸šåŠ¡åŠ åˆ†</code></p>
</li>
<li>
<p>ä½ç½‘é€Ÿç¯å¢ƒï¼šæ¶ˆæ¯æ›´æ–°ç­–ç•¥</p>
</li>
</ul>
<p>å¼±ç½‘ä¸‹è‡ªåŠ¨å…³é—­éæ ¸å¿ƒåŠŸèƒ½ï¼ˆå¦‚å¼¹å¹•æ¸å˜åŠ¨ç”»ã€å›¾ç‰‡åŠ è½½ï¼‰ï¼Œä»…ä¿ç•™æ–‡æœ¬å¼¹å¹•çš„åŸºç¡€ç§»åŠ¨æ•ˆæœï¼›å½“ç½‘ç»œå»¶è¿Ÿè¶…è¿‡Â 3Â ç§’æ—¶ï¼Œæç¤ºç”¨æˆ·Â â€œå½“å‰ç½‘ç»œä¸ä½³ï¼Œå¼¹å¹•å·²å¼€å¯çœæµæ¨¡å¼â€ã€‚</p>
<h3 data-id="heading-14">ç¬¬ä¸‰éƒ¨åˆ†ï¼šæŠ€æœ¯èåˆä¸å·¥ç¨‹åŒ–å®è·µ</h3>
<h4 data-id="heading-15">1.Â å¤§å±é¡¹ç›®çš„æŠ€æœ¯æ ˆååŒ</h4>
<ul>
<li>CSSå˜é‡ä¸æ•°æ®å¯è§†åŒ–åº“ï¼ˆECharts/Chart.jsï¼‰çš„å“åº”å¼é…ç½®ç»“åˆ</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> chart = echarts.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart'</span>));

chart.<span class="hljs-title function_">setOption</span>({
  <span class="hljs-attr">responsive</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">resize</span>: {
    <span class="hljs-attr">width</span>: <span class="hljs-string">`calc(800px / var(--base-width) * 100vw)`</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-string">`calc(600px / var(--base-height) * 100vh)`</span>
  }
});
</code></pre>
<ul>
<li>
<p>å¼¹å¹•ç³»ç»Ÿä¸WebSocketå®æ—¶é€šä¿¡çš„æ–­çº¿é‡è¿å¤„ç†</p>
<p>æœ¬é¡¹ç›®ä¸­é•¿æ¶ˆæ¯ä½¿ç”¨çš„<code>é˜¿é‡Œäº‘ç›´æ’­æ¶ˆæ¯äº’åŠ¨ç¾¤ç»„</code>ï¼Œè‡ªå¸¦æ–­çº¿é‡è¿æœºåˆ¶ï¼Œå¦‚æœä½ çš„é¡¹ç›®éœ€è¦ï¼Œå¯ä»¥é€šè¿‡å¿ƒè·³æ£€æµ‹ç›‘æ§è¿æ¥çŠ¶æ€ï¼Œå¼‚å¸¸æ—¶è‡ªåŠ¨åˆ‡æ¢å¤‡ç”¨æœåŠ¡åœ°å€ï¼Œä¿éšœæ¶ˆæ¯æ¥æ”¶ä¸ä¸­æ–­ï¼Œå¢åŠ é‡è¯•æ¬¡æ•°ç­‰æ–¹å¼ã€‚</p>
</li>
<li>
<p>å¾®å‰ç«¯æ¶æ„ä¸‹çš„å¤§å±æ¨¡å—é€‚é…æ–¹æ¡ˆ</p>
</li>
</ul>
<p>åœ¨å¾®å‰ç«¯åœºæ™¯ä¸‹ï¼Œå°†å¤§å±é€‚é…æ–¹æ¡ˆå’Œå¼¹å¹•ç³»ç»Ÿå°è£…ä¸º<code>ç‹¬ç«‹æ¨¡å—</code>ï¼Œé€šè¿‡åº”ç”¨é—´é€šä¿¡ä¼ é€’é…ç½®å‚æ•°ï¼Œç¡®ä¿æ¨¡å—åœ¨ä¸åŒä¸»åº”ç”¨ä¸­éƒ½èƒ½æ­£å¸¸é€‚é…ï¼ŒåŒæ—¶é¿å…æ ·å¼æ±¡æŸ“å’Œè„šæœ¬å†²çªã€‚</p>
<h4 data-id="heading-16">2.Â å¯å¤ç”¨ç»„ä»¶çš„è®¾è®¡åŸåˆ™</h4>
<ul>
<li>
<p>é…ç½®åŒ–æ€ç»´è½åœ°ã€‚å°†ç»„ä»¶æ ¸å¿ƒå‚æ•°ï¼ˆå¦‚å¼¹å¹•å±•ç¤ºæ—¶é•¿Â displayDurationã€æ·¡å‡ºæ—¶é•¿Â fadeOutDurationã€é€‚é…åŸºå‡†Â baseSizeÂ ç­‰ï¼‰è®¾è®¡ä¸ºå¯é…ç½®é¡¹ï¼Œé€šè¿‡Â propsÂ ä¼ å…¥ï¼Œé¿å…ç¡¬ç¼–ç ã€‚ä¾‹å¦‚å¼¹å¹•ç»„ä»¶ä½¿ç”¨<code>&lt;DanmuManagerÂ displayDuration={3000}Â fadeOutDuration={500}Â /&gt;</code>å³å¯å¿«é€Ÿè°ƒæ•´åŠŸèƒ½ã€‚</p>
</li>
<li>
<p>è¾¹ç•Œæ¡ä»¶å®¹é”™è®¾è®¡ã€‚é’ˆå¯¹ç©ºæ•°æ®åœºæ™¯ï¼Œå±•ç¤ºå‹å¥½æç¤ºæ–‡æ¡ˆï¼›å¤„ç†è¶…é«˜é¢‘æ¶ˆæ¯æ—¶ï¼Œè‡ªåŠ¨è§¦å‘é™æµæœºåˆ¶ï¼›åº”å¯¹å¼‚å¸¸åˆ†è¾¨ç‡ï¼Œé€šè¿‡<code>clamp()</code>å‡½æ•°é™åˆ¶å¸ƒå±€æé™å€¼ï¼Œç¡®ä¿ç»„ä»¶åœ¨æç«¯åœºæ™¯ä¸‹ä¸å´©æºƒã€ä¸ç•¸å˜ã€‚</p>
</li>
<li>
<p>å…¨æ–¹ä½æµ‹è¯•ç­–ç•¥ã€‚ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘ï¼Œé‡ç‚¹æµ‹è¯•é˜Ÿåˆ—è°ƒåº¦ã€æƒé‡è®¡ç®—ã€é€‚é…å…¬å¼ç­‰å…³é”®æ¨¡å—ï¼›å¼•å…¥è§†è§‰å›å½’æµ‹è¯•å·¥å…·ï¼Œå¯¹æ¯”ä¸åŒåˆ†è¾¨ç‡ä¸‹çš„ç»„ä»¶æ¸²æŸ“æ•ˆæœï¼Œç¡®ä¿é€‚é…æ— åå·®ï¼›è¿›è¡Œæ€§èƒ½å‹åŠ›æµ‹è¯•ï¼Œæ¨¡æ‹Ÿæ¯ç§’Â 1000Â æ¡æ¶ˆæ¯çš„é«˜å¹¶å‘åœºæ™¯ï¼ŒéªŒè¯ç»„ä»¶ç¨³å®šæ€§ã€‚</p>
</li>
</ul>
<h4 data-id="heading-17">3.Â è¡Œä¸šæ¡ˆä¾‹æ·±åº¦è§£æ</h4>
<p>åœ¨æœ€è¿‘çš„åŒ11ç›´æ’­ä¸­ï¼Œå¼¹å¹•ç³»ç»Ÿé€šè¿‡åŒé˜Ÿåˆ—è°ƒåº¦ã€é™æµæœºåˆ¶å’ŒÂ DOMÂ ä¼˜åŒ–ï¼Œå®ç°æ¶ˆæ¯å¤„ç†ä¸å¡é¡¿ï¼›é‡‡ç”¨å›¾ç‰‡é¢„åŠ è½½å’Œå¤±è´¥é™çº§ç­–ç•¥ï¼Œæ¶ˆæ¯å±•ç¤ºæˆåŠŸç‡è¾¾Â 99.8%ï¼›å†…å­˜å ç”¨æ§åˆ¶åœ¨åˆç†èŒƒå›´ï¼Œè¿ç»­è¿è¡ŒÂ 8Â å°æ—¶å†…å­˜å¢é•¿ä¸è¶…è¿‡Â 10%ã€‚</p>
<h3 data-id="heading-18">ç»“è¯­ï¼šæŠ€æœ¯é€‰å‹çš„åº•å±‚é€»è¾‘</h3>
<p>å¤§å±å¼€å‘ä¸å¼¹å¹•ç³»ç»Ÿçš„æŠ€æœ¯å®è·µï¼Œæœ¬è´¨æ˜¯å¯¹åœºæ™¯éœ€æ±‚çš„æ·±åº¦æ‹†è§£ä¸åŸç”ŸæŠ€æœ¯çš„æè‡´è¿ç”¨ã€‚æ²¡æœ‰æ”¾ä¹‹å››æµ·è€Œçš†å‡†çš„Â "é“¶å¼¹"ï¼Œåªæœ‰è´´åˆåœºæ™¯çš„æœ€ä¼˜è§£ã€‚</p>
<p>æœªæ¥æŠ€æœ¯è¶‹åŠ¿å°†æœç€<code>"åŸç”ŸÂ CSSÂ èƒ½åŠ›å¼ºåŒ–Â +Â JSÂ è½»é‡åŒ–"</code>æ–¹å‘å‘å±•ã€‚éšç€Â CSSÂ æ–°ç‰¹æ€§çš„æ™®åŠï¼Œæ›´å¤šé€‚é…éœ€æ±‚å¯é€šè¿‡åŸç”ŸÂ CSSÂ å®ç°ï¼›JSÂ å°†èšç„¦äºé€»è¾‘æ§åˆ¶å’ŒåŠ¨æ€äº¤äº’ï¼Œå‡å°‘ä¸å¿…è¦çš„è®¡ç®—æ¶ˆè€—ã€‚</p>
<p>å¯¹å¼€å‘è€…è€Œè¨€ï¼Œè¿™åœºæŠ€æœ¯æ”»åšçš„æ ¸å¿ƒå¯ç¤ºæ˜¯ï¼šä»<code>"å·¥å…·ä¾èµ–"</code>è½¬å‘<code>"åŸç†æŒæ¡"</code>ã€‚åªæœ‰æ·±å…¥ç†è§£Â CSSÂ è®¡ç®—é€»è¾‘ã€æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶å’Œé«˜å¹¶å‘å¤„ç†åŸç†ï¼Œæ‰èƒ½åœ¨å¤æ‚åœºæ™¯ä¸­çµæ´»åº”å˜ï¼Œæ‰“é€ å‡ºé«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„ä¼ä¸šçº§åº”ç”¨ã€‚</p>
<h2 data-id="heading-19">é™„å½•</h2>
<h3 data-id="heading-20">1.Â CSSÂ å˜é‡Â +Â calcÂ ()Â é€‚é…æ¨¡æ¿ä½¿ç”¨æµç¨‹å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[è®¾è®¡ç¨¿å°ºå¯¸ 1920Ã—1080] --&gt;|Step1| B[åœ¨ :root å†™å…¥åŸºå‡†å˜é‡&lt;br/&gt;--base-width / --base-height]
    B --&gt;|Step2| C[ä¸ºå…ƒç´ å£°æ˜ç›®æ ‡å˜é‡&lt;br/&gt;--target-width:960]
    C --&gt;|Step3| D[ä½¿ç”¨ calc å…¬å¼ä¸€æ¬¡æ€§å®Œæˆ pxâ†’vw/vh æ¢ç®—&lt;br/&gt;â†’æŸ¥çœ‹ä¸‹æ–¹ä»£ç ]
</code></pre>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä¸‹æ–¹ä»£ç ç¤ºä¾‹ */</span>
<span class="hljs-attribute">width</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-built_in">var</span>(--target-width) / <span class="hljs-built_in">var</span>(--base-width) * <span class="hljs-number">100vw</span>);
</code></pre>
<h3 data-id="heading-21">2.Â å¼¹å¹•ç®¡ç†å™¨ç»„ä»¶Â APIÂ æ–‡æ¡£ä¸å‚æ•°é…ç½®è¡¨Â·Â å‚æ•°è”åŠ¨è¯´æ˜</h3>





















































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>displayDuration</td><td>number</td><td>3000</td><td>å¼¹å¹•å±•ç¤ºæ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰</td></tr><tr><td>fadeOutDuration</td><td>number</td><td>500</td><td>å¼¹å¹•æ·¡å‡ºåŠ¨ç”»æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰</td></tr><tr><td>maxQueueLength</td><td>number</td><td>500</td><td>é˜Ÿåˆ—æœ€å¤§é•¿åº¦</td></tr><tr><td>priorityWeight</td><td>object</td><td>{normal:1,Â invitation:3}</td><td>ä¸åŒç±»å‹æ¶ˆæ¯æƒé‡</td></tr><tr><td>throttleTime</td><td>number</td><td>100</td><td>æ¶ˆæ¯å¤„ç†èŠ‚æµæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</td></tr><tr><td>onMessageClick</td><td>function</td><td>-</td><td>å¼¹å¹•ç‚¹å‡»å›è°ƒå‡½æ•°</td></tr><tr><td>onQueueFull</td><td>function</td><td>-</td><td>é˜Ÿåˆ—æ»¡æ—¶å›è°ƒå‡½æ•°</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-22">å‚æ•°è”åŠ¨é€ŸæŸ¥è¡¨</h3>



































<table><thead><tr><th>è”åŠ¨åœºæ™¯</th><th>è°ƒæ•´å»ºè®®</th><th>åŸå› è¯´æ˜</th></tr></thead><tbody><tr><td><code>displayDuration</code>Â å‡å°ï¼ˆå¦‚Â 3000Â â†’Â 1500Â msï¼‰</td><td><strong>åŒæ­¥é™ä½</strong>Â <code>**throttleTime**</code>ï¼ˆå¦‚Â 100Â â†’Â 50Â msï¼‰</td><td>é¿å…æ¶ˆæ¯å› åœç•™æ—¶é—´å˜çŸ­è€Œå †ç§¯ï¼Œé™ä½è·³å¸§æ¦‚ç‡</td></tr><tr><td><code>maxQueueLength</code>Â å¢å¤§ï¼ˆå¦‚Â 500Â â†’Â 1000ï¼‰</td><td><strong>å¯é€‚åº¦å¢åŠ </strong>Â <code>**throttleTime**</code>ï¼ˆå¦‚Â 100Â â†’Â 120Â msï¼‰</td><td>é˜Ÿåˆ—å®¹é‡å˜å¤§ï¼Œå•æ¬¡æ‰¹å¤„ç†å¯ç¨å¾®æ”¾å®½ï¼Œå‡å°‘Â CPUÂ æŠ¢å </td></tr><tr><td><code>fadeOutDuration</code>Â å¢å¤§ï¼ˆå¦‚Â 500Â â†’Â 800Â msï¼‰</td><td><strong>åŒæ­¥å¢åŠ </strong>Â <code>**displayDuration**</code>ï¼ˆä¿åº•Â +Î”fadeOutï¼‰</td><td>ä¿è¯æ·¡å‡ºåŠ¨ç”»å®Œæ•´å¯è§ï¼Œé˜²æ­¢è¢«æå‰å¼ºåˆ¶ç§»é™¤</td></tr><tr><td>é«˜é¢‘é‚€è¯·æ¶ˆæ¯ï¼ˆ<code>invitation</code>Â æƒé‡Â 3â†’5ï¼‰</td><td><strong>æé«˜</strong>Â <code>**priorityWeight.invitation**</code>Â å¹¶Â <strong>ç¼©çŸ­</strong>Â <code>**throttleTime**</code></td><td>ä¼˜å…ˆæ’é˜Ÿ+æ›´å¿«å¤„ç†ï¼Œç¡®ä¿é‚€è¯·å¼¹å¹•åŠæ—¶æ›å…‰</td></tr><tr><td>ä½ç«¯æœºåœºæ™¯</td><td><strong>åŒæ—¶é™ä½</strong><br/><code>displayDuration</code>Â &amp;Â <code>maxQueueLength</code>Â &amp;Â <code>throttleTime</code></td><td>ä¸‰ç®¡é½ä¸‹ï¼Œå‡å°‘åŒæ—¶å­˜åœ¨çš„Â DOMÂ èŠ‚ç‚¹æ•°å’Œæ¯å¸§è®¡ç®—é‡</td></tr></tbody></table>
<h3 data-id="heading-23">3.Â æ€§èƒ½æµ‹è¯•å·¥å…·ä¸æŒ‡æ ‡ç›‘æ§æ–¹æ¡ˆ</h3>
<ul>
<li>
<p>æ¸²æŸ“æ€§èƒ½æµ‹è¯•ï¼šä½¿ç”¨<code>ChromeÂ DevTools</code>Â çš„Â <code>Performance</code>Â é¢æ¿ï¼Œå½•åˆ¶ä¸åŒåˆ†è¾¨ç‡ä¸‹çš„é¡µé¢æ¸²æŸ“è¿‡ç¨‹ï¼Œåˆ†æå¸§ç‡ã€é‡æ’é‡ç»˜æ¬¡æ•°ã€ä¸»çº¿ç¨‹è€—æ—¶ã€‚</p>
</li>
<li>
<p>å†…å­˜ç›‘æ§ï¼šé€šè¿‡Â <code>ChromeÂ DevTools</code>Â çš„Â <code>Memory</code>Â é¢æ¿ï¼Œå®šæœŸæ‹æ‘„å †å¿«ç…§ï¼Œç›‘æ§å†…å­˜å ç”¨å˜åŒ–ï¼Œæ’æŸ¥å†…å­˜æ³„æ¼é—®é¢˜ã€‚</p>
</li>
<li>
<p>å¹¶å‘å‹åŠ›æµ‹è¯•ï¼šä½¿ç”¨<code>JMeter</code>æ¨¡æ‹Ÿé«˜å¹¶å‘æ¶ˆæ¯å‘é€ï¼Œæµ‹è¯•å¼¹å¹•ç³»ç»Ÿåœ¨æ¯ç§’Â 100-1000Â æ¡æ¶ˆæ¯åœºæ™¯ä¸‹çš„å¤„ç†èƒ½åŠ›ã€‚</p>
</li>
<li>
<p>çº¿ä¸Šç›‘æ§ï¼šé›†æˆ<code>Sentry</code>ç­‰ç›‘æ§å·¥å…·ï¼Œæ”¶é›†çº¿ä¸Šç¯å¢ƒçš„å¸§ç‡ã€é”™è¯¯ç‡ã€åŠ è½½æ—¶é—´ç­‰æŒ‡æ ‡ï¼Œå®æ—¶å‘Šè­¦å¼‚å¸¸æƒ…å†µã€‚</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é‡‘ä»“æ•°æ®åº“(KingbaseES) å¼€å‘å®æˆ˜ï¼šå¸¸è§è¿ç§»æŒ‘æˆ˜ä¸æŠ€æœ¯è§£æ]]></title>    <link>https://juejin.cn/post/7584742635502436379</link>    <guid>https://juejin.cn/post/7584742635502436379</guid>    <pubDate>2025-12-18T04:35:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584742635502436379" data-draft-id="7584787119273672731" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é‡‘ä»“æ•°æ®åº“(KingbaseES) å¼€å‘å®æˆ˜ï¼šå¸¸è§è¿ç§»æŒ‘æˆ˜ä¸æŠ€æœ¯è§£æ"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-12-18T04:35:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€”å¼ºçš„çŸ³å¤´_"/> <meta itemprop="url" content="https://juejin.cn/user/3168119757484368"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é‡‘ä»“æ•°æ®åº“(KingbaseES) å¼€å‘å®æˆ˜ï¼šå¸¸è§è¿ç§»æŒ‘æˆ˜ä¸æŠ€æœ¯è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3168119757484368/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€”å¼ºçš„çŸ³å¤´_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:35:36.000Z" title="Thu Dec 18 2025 04:35:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9f18ac0e98b4e7b8285175c0965fd48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=93MGeFYTYzUfV0Z5XVa44hHYzRw%3D" alt="8ce5353c2dd237e589bb36a08293fa57.jpg" loading="lazy"/></p>
<p>å›½äº§åŒ–æ›¿ä»£æµªæ½®ä¹‹ä¸‹ï¼Œé‡‘ä»“æ•°æ®åº“ï¼ˆå³ KingbaseESï¼Œä¸šå†…åˆå¸¸ç§°ä¹‹ä¸º KESï¼‰æœ‰ç€ä¸€é¡¹ç‹¬é—¨ç»æŠ€ï¼Œé‚£å°±æ˜¯å‡ºè‰²çš„ Oracle å…¼å®¹èƒ½åŠ›å’Œå¼ºå¤§çš„å†…æ ¸å®åŠ›ï¼Œäºæ˜¯å®ƒæ¸æ¸æˆä¸ºè¯¸å¤šä¼ä¸šæ‰§è¡Œæ ¸å¿ƒç³»ç»Ÿè¿ç§»æ—¶çš„ä¼˜å…ˆé€‰æ‹©ã€‚</p>
<p>KES çš„è®¾è®¡æ€è·¯å¾ˆæœ‰è¶£ï¼Œå…¶åº•å±‚ä¾é å…ˆè¿›çš„å¼€æºå†…æ ¸ï¼Œä¸Šæ–¹åˆ™ç´§å¯†å¥‘åˆ Oracle çš„è¯­æ³•åŠè¡Œä¸ºï¼Œè¿™å¯¹äºå¼€å‘è€…è€Œè¨€é¢‡ä¸ºå‘¨åˆ°ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œå¼€å‘è€…ä¾¿èƒ½å¤Ÿæ”¶è·äº‘åŸç”Ÿæ—¶æœŸæ–°æŠ€æœ¯å¸¦æ¥çš„å¥½å¤„ï¼Œè€Œä¸”å¯ä»¥æŠŠè€æ—§ç³»ç»Ÿè¿ç§»æ‰€è€—è´¹çš„æˆæœ¬å‡å°åˆ°æœ€ä½é™åº¦ã€‚</p>
<p>ä¸è¿‡è¦è¯´å›æ¥ï¼ŒæŠŠ Oracle æˆ– MySQL ç§»æ¤åˆ° KES çš„æ—¶å€™ï¼Œå„ä¸ªæ•°æ®åº“å¯¹æ ‡å‡† SQL çš„æ‰§è¡Œç»†èŠ‚å­˜åœ¨ä¸€äº›å·®åˆ«ï¼Œæ‰€ä»¥éš¾å…ä¼šé­é‡â€œæ°´åœŸä¸æœâ€çš„æŠ€æœ¯éš¾ç‚¹ã€‚é‡åˆ°è¿™ç§æƒ…å†µä¸è¦æ…Œï¼Œè¿™å¹¶éäº§å“æœ‰ Bugï¼Œæ›´å¤šçš„æ˜¯ç”±äºä¸åŒæ•°æ®åº“çš„è®¾è®¡ç†å¿µäº§ç”Ÿå†²çªï¼Œåªè¦æ·±å…¥äº†è§£è¿™äº›æœºåˆ¶ï¼Œä¸ä½†çœ¼å‰çš„éš¾é¢˜èƒ½å¤Ÿå¾—åˆ°è§£å†³ï¼Œè€Œä¸”å¯¹äºæ•°æ®åº“åŸç†çš„è®¤è¯†ä¹Ÿä¼šæå‡ã€‚</p>
<p>æœ¬æ–‡æ•´ç†äº†4ä¸ªæŠ€æœ¯åœºæ™¯ï¼Œåˆ†åˆ«æ˜¯å¯¹è±¡å‘½åï¼Œç©ºå€¼å¤„ç†ï¼ŒJSONæ•°æ®å¤„ç†ä»¥åŠåºåˆ—ç®¡ç†ï¼Œç»ç”±åŸç†åˆ†æå¹¶é‡ç°ä»£ç ï¼Œå¸¦é¢†å¤§å®¶ä¸€èµ·é¿å¼€è¿™äº›é™·é˜±ï¼Œä»è€Œæ›´å¥½åœ°æŒæ¡KingbaseESã€‚
@[toc]</p>
<hr/>
<h2 data-id="heading-0">æ¡ˆä¾‹ä¸€ï¼šæ˜æ˜è¡¨å­˜åœ¨ï¼Œä¸ºä»€ä¹ˆæŠ¥ "relation does not exist"ï¼Ÿ</h2>
<p><strong>ç°è±¡æè¿°</strong>ï¼š
å¤§å®¶å¯èƒ½é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼šæ˜æ˜åˆšå»ºäº†ä¸ªè¡¨å« <code>UserInfo</code>ï¼Œç»“æœç”¨ <code>SELECT * FROM UserInfo</code> ä¸€æŸ¥ï¼Œç›´æ¥æŠ¥é”™ï¼š<code>ERROR: relation "userinfo" does not exist</code>ã€‚è¿™æ—¶å€™ä½ å¯èƒ½ä¼šæ€€ç–‘äººç”Ÿï¼šè¡¨å‘¢ï¼Ÿæˆ‘åˆšå»ºçš„è¡¨å‘¢ï¼Ÿ</p>
<p><strong>å¤ç°ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 1. åˆ›å»ºä¸€ä¸ªåŒ…å«å¤§å†™å­—æ¯çš„è¡¨ï¼ˆæœªåŠ åŒå¼•å·ï¼ŒKESé»˜è®¤ä¼šè½¬ä¸ºå°å†™ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> UserInfo (id <span class="hljs-type">INT</span>, name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>));

<span class="hljs-comment">-- 2. å°è¯•æŸ¥è¯¢ï¼ˆæ­¤æ—¶è¡¨ååœ¨å†…éƒ¨å­˜å‚¨ä¸º userinfoï¼‰</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> UserInfo; <span class="hljs-comment">-- æˆåŠŸï¼Œå› ä¸º UserInfo ä¹Ÿä¼šè¢«è‡ªåŠ¨è½¬ä¸º userinfo</span>

<span class="hljs-comment">-- 3. å¦‚æœæˆ‘ä»¬åœ¨ç‰¹å®šçš„ Schema ä¸‹åˆ›å»ºè¡¨ï¼Œä¸”ä½¿ç”¨äº†åŒå¼•å·ä¿æŒå¤§å°å†™</span>
<span class="hljs-keyword">CREATE</span> SCHEMA app_v1;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> app_v1."UserInfo" (id <span class="hljs-type">INT</span>, name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>));

<span class="hljs-comment">-- 4. æ­¤æ—¶ç›´æ¥æŸ¥è¯¢ï¼Œæˆ–è€…ä¸åŠ åŒå¼•å·æŸ¥è¯¢</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> app_v1.UserInfo; 
<span class="hljs-comment">-- æŠ¥é”™ï¼šrelation "app_v1.userinfo" does not exist</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/062c0d11eee64574884cb91efe2d69f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=AbapX2MV9pt9FNKHh5LZKTyZ6ps%3D" alt="image.png" loading="lazy"/></p>
<p><strong>åŸå› åˆ†æ</strong>ï¼š
è¿™æ˜¯ç”±äºKESï¼ˆå¤„äºPGæ¨¡å¼æˆ–è€…é»˜è®¤è®¾ç½®æ—¶ï¼‰è¦éµå¾ªSQLæ ‡å‡†æ‰€è‡´ï¼Œæ ‡å‡†è¡¨æ˜ï¼Œå¦‚æœæœªç»™æ ‡è¯†ç¬¦åŠ ä¸ŠåŒå¼•å·ï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨å°†å…¶è½¬æ¢ä¸º<strong>å°å†™</strong>ã€‚</p>
<p>åœ¨åˆ›å»ºè¡¨æ—¶ï¼Œå¦‚æœä½ ç”¨ä¸Šäº†åŒå¼•å·ï¼ˆè­¬å¦‚è¯´ "UserInfo"ï¼‰ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šä¸¥æ ¼æŒ‰ç…§ä½ æ‰€å†™çš„å¤§å°å†™æ¥è¿›è¡Œå­˜å‚¨ï¼Œç­‰åˆ°æ‰§è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œå‡ä½¿ä½ å«Œéº»çƒ¦æ²¡æœ‰åŠ ä¸ŠåŒå¼•å·ï¼Œè€Œç³»ç»ŸåˆæŠŠè¡¨åè½¬æ¢æˆå°å†™æ¥å®æ–½æ¯”å¯¹ï¼Œè¿™æ ·å¿…ç„¶å°±æŸ¥ä¸åˆ°ç›¸å…³å†…å®¹ã€‚</p>
<p><code>search_path</code>ï¼ˆæœç´¢è·¯å¾„ï¼‰å¸¸ä¼šé™·å…¥ä¸€äº›é—®é¢˜ï¼Œä½ çš„è¡¨è‹¥æ—¢æœªå¤„äº <code>public</code> ä¹Ÿæœªåœ¨å½“å‰ç”¨æˆ·çš„ Schema ä¸‹ï¼Œå°±åŠ¡å¿…æ˜ç¡®æŒ‡å®š Schemaã€‚</p>
<p><strong>è§£å†³æ–¹æ³•</strong>ï¼š</p>
<ol>
<li><strong>ç»Ÿä¸€è§„èŒƒ</strong>ï¼šæœ€çœå¿ƒçš„åŠæ³•ï¼Œå°±æ˜¯è¡¨åã€å­—æ®µåå…¨ç”¨å°å†™ï¼Œåˆ«ç”¨åŒå¼•å·ï¼Œå¤§å®¶éƒ½è½»æ¾ã€‚</li>
<li><strong>æ£€æŸ¥ <code>search_path</code></strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SHOW</span> search_path;
<span class="hljs-comment">-- å¦‚æœä½ çš„è¡¨åœ¨ app_v1 æ¨¡å¼ä¸‹ï¼Œéœ€è¦è®¾ç½®ï¼š</span>
<span class="hljs-keyword">SET</span> search_path <span class="hljs-keyword">TO</span> app_v1, public, sys;
</code></pre>
</li>
<li><strong>ç²¾å‡†æŸ¥è¯¢</strong>ï¼šå®åœ¨æä¸æ¸…è¡¨ååˆ°åº•å­˜æˆå•¥æ ·äº†ï¼Ÿç›´æ¥æŸ¥ç³»ç»Ÿè¡¨ï¼Œä¸€çœ‹ä¾¿çŸ¥ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> schemaname, tablename <span class="hljs-keyword">FROM</span> sys_tables <span class="hljs-keyword">WHERE</span> schemaname <span class="hljs-operator">=</span> <span class="hljs-string">'app_v1'</span>;
</code></pre>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61c019d62e9d470f95e4fdf43d9078e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=u69aveLbipYInA4c1jSPKpSHwXs%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">æ¡ˆä¾‹äºŒï¼šå†™å…¥çš„ç©ºå­—ç¬¦ä¸²å‡­ç©ºæ¶ˆå¤±äº†ï¼Ÿï¼ˆç©ºä¸²ä¸ NULLï¼‰</h2>
<p><strong>ç°è±¡æè¿°</strong>ï¼š
å¾ˆå¤šä» MySQL è½¬è¿‡æ¥çš„å…„å¼Ÿä¹ æƒ¯ç”¨ <code>''</code>ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ä»£è¡¨â€œæ²¡ä¸œè¥¿â€ã€‚ç»“æœå†™å…¥æ•°æ®åï¼Œç”¨ <code>WHERE content = ''</code> æ­»æ´»æŸ¥ä¸åˆ°æ•°æ®ï¼Œæ¢æˆ <code>IS NULL</code> åå€’æŸ¥å‡ºæ¥äº†ã€‚è¿™å°±å¾ˆè¿·ï¼šæˆ‘çš„ç©ºå­—ç¬¦ä¸²å»å“ªäº†ï¼Ÿ</p>
<p><strong>å¤ç°ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_str_test (id <span class="hljs-type">INT</span>, content <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>));

<span class="hljs-comment">-- æ’å…¥ä¸€æ¡ç©ºå­—ç¬¦ä¸²</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_str_test <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">''</span>);

<span class="hljs-comment">-- å°è¯•æŸ¥è¯¢ç©ºå­—ç¬¦ä¸²</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_str_test <span class="hljs-keyword">WHERE</span> content <span class="hljs-operator">=</span> <span class="hljs-string">''</span>; 
<span class="hljs-comment">-- ç»“æœï¼š0 æ¡æ•°æ®ï¼ˆåœ¨ Oracle æ¨¡å¼ä¸‹ï¼‰</span>

<span class="hljs-comment">-- å°è¯•æŸ¥è¯¢ NULL</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_str_test <span class="hljs-keyword">WHERE</span> content <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>; 
<span class="hljs-comment">-- ç»“æœï¼š1 æ¡æ•°æ®</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cf3fa7e373f4d60b837e0e99e4afe57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=RgQeZ9ppIYTZbmZdb%2Fa9MM2cl9Y%3D" alt="image.png" loading="lazy"/></p>
<p><strong>åŸå› åˆ†æ</strong>ï¼š
è¿™æ˜¯ KES ä¸ºé€‚é… <strong>Oracle æ¨¡å¼</strong> æ‰€ä¸“é—¨è®¾è®¡çš„ï¼Œåœ¨ Oracle ç³»ç»Ÿå½“ä¸­ï¼Œç©ºå­—ç¬¦ä¸² <code>''</code> å’Œ <code>NULL</code> å®é™…ä¸Šæ˜¯ç›¸åŒæ¦‚å¿µï¼ŒäºŒè€…å¯ä»¥ç›¸äº’æ›¿ä»£ã€‚</p>
<p>KES æœ‰ä¸€ä¸ªåä¸º <code>ora_input_emptystr_isnull</code> çš„å‚æ•°ï¼Œç”¨äºæ§åˆ¶ç›¸å…³è¡Œä¸ºï¼Œè¯¥å‚æ•°å¤„äºå¼€å¯çŠ¶æ€ï¼ˆé»˜è®¤å€¼ä¸º <code>on</code>ï¼‰æ—¶ï¼Œå‘å…¶ä¸­æ’å…¥ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†å…¶åœ¨åº•å±‚è½¬æ¢ä¸º <code>NULL</code>ï¼Œè¿™æ ·åšä¸»è¦æ˜¯æ–¹ä¾¿é‚£äº›ä¹ æƒ¯ä½¿ç”¨ Oracle çš„ç”¨æˆ·åœ¨è¿ç§»è¿‡ç¨‹ä¸­æ›´ä¸ºé¡ºç•…ã€‚</p>
<p><strong>è§£å†³æ–¹æ³•</strong>ï¼š</p>
<ol>
<li><strong>å…¥ä¹¡éšä¿—</strong>ï¼šæ—¢ç„¶ç”¨äº† KES çš„ Oracle æ¨¡å¼ï¼Œå’±ä»¬æœ€å¥½å°±æŒ‰ Oracle çš„è§„çŸ©æ¥ï¼Œç”¨ <code>IS NULL</code> åˆ¤æ–­ç©ºå†…å®¹ï¼Œä¹ æƒ¯äº†ä¹ŸæŒºå¥½ã€‚</li>
<li><strong>æ”¹å‚æ•°ï¼ˆç‰¹æ®Šæƒ…å†µï¼‰</strong>ï¼šå¦‚æœä½ éå¾—ä¿ç•™ç©ºå­—ç¬¦ä¸²çš„è¯­ä¹‰ï¼ˆæ¯”å¦‚ä¸ºäº†å…¼å®¹ MySQL çš„è€ä¸šåŠ¡ï¼‰ï¼Œé‚£ä¹Ÿå¯ä»¥åœ¨ä¼šè¯çº§æˆ–è€…ç³»ç»Ÿçº§æŠŠè¿™ä¸ªå‚æ•°å…³æ‰ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹å½“å‰å‚æ•°</span>
<span class="hljs-keyword">SHOW</span> ora_input_emptystr_isnull;

<span class="hljs-comment">-- å…³é—­è‡ªåŠ¨è½¬æ¢ï¼ˆä»…å½“å‰ä¼šè¯ç”Ÿæ•ˆï¼‰</span>
<span class="hljs-keyword">SET</span> ora_input_emptystr_isnull <span class="hljs-operator">=</span> off;

<span class="hljs-comment">-- å†æ¬¡æµ‹è¯•</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_str_test <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">''</span>);
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_str_test <span class="hljs-keyword">WHERE</span> content <span class="hljs-operator">=</span> <span class="hljs-string">''</span>; <span class="hljs-comment">-- æ­¤æ—¶èƒ½æŸ¥åˆ° id=2 çš„è®°å½•</span>
</code></pre>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c78db30245b437f95325a4fef563d75~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=W9KBreZnB2ccR7QV9HMXFJJPhBY%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">æ¡ˆä¾‹ä¸‰ï¼šJSON å‡½æ•°è¿”å› NULLï¼Ÿï¼ˆJSON è·¯å¾„åŒ¹é…è§„åˆ™ï¼‰</h2>
<p><strong>ç°è±¡æè¿°</strong>ï¼š
ç°åœ¨ä¸šåŠ¡é‡Œç”¨ JSON çš„æƒ…å†µè¶Šæ¥è¶Šå¤šäº†ï¼ŒKES å¯¹è¿™å—æ”¯æŒä¹Ÿä¸é”™ã€‚ä½†ç»å¸¸æœ‰å…„å¼ŸæŠ±æ€¨ï¼šç”¨ <code>JSON_VALUE</code> æˆ– <code>JSON_QUERY</code> å–æ•°æ®æ—¶ï¼Œæ˜æ˜çœ‹ç€æ•°æ®å°±åœ¨é‚£å„¿ï¼Œæ€ä¹ˆå–å‡ºæ¥å…¨æ˜¯ NULLï¼Ÿ</p>
<p><strong>å¤ç°ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å‡è®¾è¡¨ä¸­æœ‰ä¸€æ¡ JSON æ•°æ®ï¼š{"Name": "Kingbase", "Version": "V8R6"}</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_json (info jsonb);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_json <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'{"Name": "Kingbase", "Version": "V8R6"}'</span>);

<span class="hljs-comment">-- å°è¯•æå– Name å­—æ®µ</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">JSON_VALUE</span>(info, <span class="hljs-string">'$.name'</span>) <span class="hljs-keyword">FROM</span> t_json;
<span class="hljs-comment">-- ç»“æœï¼šNULL</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/849cf8c1709b4368ad7906e4e4ff1961~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=C428%2B%2F88wJ0S33z%2F2sWIewuDA1M%3D" alt="image.png" loading="lazy"/></p>
<p><strong>åŸå› åˆ†æ</strong>ï¼š</p>
<p>è¿™ä¹ŸçœŸä¸æ˜¯ç³»ç»Ÿå‡º Bug äº†ï¼Œé€šå¸¸æ˜¯å› ä¸ºå’±ä»¬å†™çš„<strong>è·¯å¾„åŒ¹é…è§„åˆ™å¤ªä¸¥æ ¼</strong>ã€‚</p>
<p><strong>å¤§å°å†™æ•æ„Ÿ</strong> ï¼šJSON æ ‡å‡†è¡¨æ˜ï¼ŒKeyï¼ˆé”®åï¼‰å±äºå¤§å°å†™æ•æ„ŸèŒƒç•´ï¼Œå‰é¢ä¾‹å­ä¸­çš„æ•°æ®å«æœ‰ "Name"ï¼ˆå¤§å†™Nï¼‰ï¼Œè€ŒæŸ¥è¯¢è·¯å¾„å´æ˜¯ <code>$.name</code>ï¼ˆå°å†™nï¼‰ï¼ŒäºŒè€…æ˜¾ç„¶æ— æ³•å¯¹åº”ï¼Œæ‰€ä»¥é»˜è®¤æƒ…å½¢ä¸‹ï¼Œç›¸å…³å‡½æ•°ä¼šé»˜é»˜ç»™å‡º NULLã€‚</p>
<p><strong>è·¯å¾„å±‚çº§</strong>ï¼šè¦æ˜¯è·¯å¾„å±‚çº§æé”™äº†ï¼ˆæ¯”å¦‚å°‘å†™äº†ä¸€å±‚å¯¹è±¡åµŒå¥—ï¼‰ï¼Œé‚£è‚¯å®šä¹Ÿæ‘¸ä¸åˆ°å€¼ã€‚</p>
<p><strong>è§£å†³æ–¹æ³•</strong>ï¼š</p>
<ol>
<li><strong>å¯¹é½å¤§å°å†™</strong>ï¼šå†™ SQL çš„æ—¶å€™ç»†å¿ƒç‚¹ï¼ŒJSON è·¯å¾„å¿…é¡»è·Ÿæ•°æ®é‡Œçš„ Key ä¸€æ¨¡ä¸€æ ·ã€‚
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ­£ç¡®å†™æ³•ï¼šä½¿ç”¨ "Name"</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">JSON_VALUE</span>(info, <span class="hljs-string">'$.Name'</span>) <span class="hljs-keyword">FROM</span> t_json;
<span class="hljs-comment">-- ç»“æœï¼šKingbase</span>
</code></pre>
</li>
<li><strong>ç”¨ <code>ON EMPTY</code> æŸ¥å› </strong>ï¼šä¸ºäº†ææ¸…æ¥šåˆ°åº•æ˜¯â€œæ²¡æ‰¾åˆ°â€è¿˜æ˜¯â€œå€¼æœ¬èº«å°±æ˜¯ NULLâ€ï¼Œå¯ä»¥ç”¨ <code>DEFAULT ... ON EMPTY</code> è¿™ä¸ªè¯­æ³•æ¥æ¢æ¢åº•ã€‚
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">JSON_VALUE</span>(
    info, 
    <span class="hljs-string">'$.name'</span> 
    <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'Path Not Found'</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">EMPTY</span>
) <span class="hljs-keyword">FROM</span> t_json;
<span class="hljs-comment">-- ç»“æœï¼šPath Not Found</span>
</code></pre>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31496cad691745d1a6444e4876abdbaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=RHNGeRdEkBTYowM%2B640U5RuRf%2F0%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-3">æ¡ˆä¾‹å››ï¼šè¿ç§»åæ’å…¥æ•°æ®æŠ¥é”™ "Duplicate key"ï¼Ÿï¼ˆåºåˆ—åŒæ­¥æœºåˆ¶ï¼‰</h2>
<p><strong>ç°è±¡æè¿°</strong>ï¼š
æ•°æ®åˆšä»åˆ«çš„åº“å¯¼è¿› KESï¼Œè¡¨é‡Œæ˜æ˜å·²ç»æœ‰ 100 æ¡æ•°æ®äº†ï¼ˆID ä» 1 åˆ° 100ï¼‰ã€‚è¿™æ—¶å€™åº”ç”¨å‘èµ·ä¸€æ¡ <code>INSERT</code>ï¼ˆä¸æŒ‡å®š IDï¼Œæƒ³ç”¨è‡ªå¢ï¼‰ï¼Œç»“æœå´©äº†ï¼Œç›´æ¥æŠ¥ä¸»é”®å†²çª <code>duplicate key value violates unique constraint</code>ã€‚è¿™å•¥æƒ…å†µï¼Ÿæ–°æ¥çš„æ•°æ®è¿˜èƒ½è·Ÿæ—§æ•°æ®æ‰“æ¶ï¼Ÿ</p>
<p><strong>å¤ç°ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 1. åˆ›å»ºåºåˆ—å’Œè¡¨</span>
<span class="hljs-keyword">CREATE</span> SEQUENCE seq_user_id <span class="hljs-keyword">START</span> <span class="hljs-number">1</span>;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_user (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> nextval(<span class="hljs-string">'seq_user_id'</span>) <span class="hljs-keyword">PRIMARY</span> KEY, 
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)
);

<span class="hljs-comment">-- 2. æ¨¡æ‹Ÿæ•°æ®è¿ç§»ï¼ˆæ˜¾å¼æ’å…¥ IDï¼‰</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_user (id, name) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">'Alice'</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_user (id, name) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">'Bob'</span>);

<span class="hljs-comment">-- 3. æ­¤æ—¶åºåˆ— seq_user_id çš„å½“å‰å€¼ï¼ˆlast_valueï¼‰ä¾ç„¶æ˜¯ 1ï¼ˆæˆ–è€…æœªå®šä¹‰ï¼‰</span>
<span class="hljs-comment">-- 4. åº”ç”¨å°è¯•éšå¼æ’å…¥ï¼ˆä¾èµ–é»˜è®¤å€¼ï¼‰</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_user (name) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Charlie'</span>);
<span class="hljs-comment">-- é”™è¯¯ï¼šé”®å€¼ "(id)=(1)" å·²ç»å­˜åœ¨</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1004fb0d359040f0a943264b424fa45d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=Fjw2JVguxoIfc0kpheNOKwDVRhc%3D" alt="image.png" loading="lazy"/></p>
<p><strong>åŸå› åˆ†æ</strong>ï¼š
è¿™å…¶å®æ˜¯æ•°æ®åº“åºåˆ—ï¼ˆSequenceï¼‰çš„æ ‡å‡†è¡Œä¸ºï¼Œæ²¡å•¥å¥½å¥‡æ€ªçš„ã€‚</p>
<p>å¯¼æ•°æ®æ—¶ï¼ˆä»¥è¿ç§»å·¥å…·ä¸ºä¾‹ï¼‰ï¼Œä¸€èˆ¬ä¼šæ˜¾å¼æŒ‡å®šIDæ‰§è¡Œæ’å…¥æ“ä½œï¼Œæ­¤æƒ…å½¢ä¸‹ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨æ¨åŠ¨ç›¸å…³è”çš„åºåˆ—ã€‚</p>
<p>ç­‰åˆ°åé¢è‡ªå·±è·‘èµ·æ¥ï¼Œå¼€å§‹ä¾èµ– <code>default nextval(...)</code> çš„æ—¶å€™ï¼Œåºåˆ—è¿˜æ˜¯ä¼šä»åˆå§‹å€¼ï¼ˆè­¬å¦‚è¯´ 1ï¼‰å¼€å§‹å‘æ”¾ï¼Œè¿™å¿…ç„¶ä¼šé€ æˆä¸è¡¨é‡Œå·²æœ‰çš„ ID å†²çªã€‚</p>
<p><strong>è§£å†³æ–¹æ³•</strong>ï¼š
è¿ç§»æå®šåï¼Œåƒä¸‡åˆ«å¿˜äº†<strong>é‡ç½®åºåˆ—</strong>ï¼ŒæŠŠå®ƒæ‹¨åˆ°å½“å‰è¡¨é‡Œæœ€å¤§ ID çš„ä½ç½®ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ä¿®æ­£åºåˆ—å€¼</span>
<span class="hljs-keyword">SELECT</span> setval(<span class="hljs-string">'seq_user_id'</span>, (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(id) <span class="hljs-keyword">FROM</span> t_user));

<span class="hljs-comment">-- å†æ¬¡æ’å…¥æˆåŠŸ</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_user (name) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Charlie'</span>); <span class="hljs-comment">-- ID å°†å˜ä¸º 3</span>
</code></pre>
<hr/>
<h2 data-id="heading-4">æ€»ç»“ä¸æ›´å¤šèµ„æº</h2>
<p>çœ‹äº†ä¸Šé¢è¿™å‡ ä¸ªä¾‹å­ï¼Œå¤§å®¶åº”è¯¥ä¹Ÿå‘ç°äº†ï¼Œå¾ˆå¤šçœ‹ä¼¼â€œå¥‡è‘©â€çš„ç°è±¡ï¼Œå…¶å®æ˜¯ KingbaseES ä¸ºäº†åœ¨<strong>æ ‡å‡†åŒ–</strong>å’Œ<strong>å…¼å®¹æ€§</strong>ä¹‹é—´æ‰¾å¹³è¡¡è€Œåšçš„ç²¾å¿ƒè®¾è®¡ã€‚åªè¦æŠŠè¿™äº›æŠ€æœ¯ç»†èŠ‚æ‘¸é€ï¼Œä½ åœ¨æ•°æ®åº“å¼€å‘å’Œè¿ç§»çš„æ—¶å€™å°±èƒ½æ¸¸åˆƒæœ‰ä½™ï¼Œå°‘è¸©å¾ˆå¤šå‘ã€‚</p>
<p>KingbaseES æ¯•ç«Ÿæ˜¯æˆç†Ÿçš„ä¼ä¸šçº§æ•°æ®åº“ï¼Œè¯Šæ–­å·¥å…·å’Œæ–‡æ¡£æ”¯æŒéƒ½æŒºå…¨çš„ã€‚å¦‚æœä½ å¯¹å®ƒçš„åº•å±‚åŸç†ã€æ›´å¤šé«˜çº§ç©æ³•ï¼ˆåƒè¯»å†™åˆ†ç¦»ã€é›†ç¾¤é«˜å¯ç”¨è¿™äº›ï¼‰æ„Ÿå…´è¶£ï¼Œæˆ–è€…çœŸåœ¨é¡¹ç›®é‡Œç¢°åˆ°äº†ç¡¬éª¨å¤´ï¼Œæ¬¢è¿æ¥å’±ä»¬çš„å®˜æ–¹æŠ€æœ¯ç¤¾åŒºé€›é€›ï¼</p>
<p>ğŸ‘‰ <strong>é‡‘ä»“æ•°æ®åº“å®˜æ–¹åšå®¢ç«™</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fkingbase.com.cn%2Fexplore" target="_blank" title="https://kingbase.com.cn/explore" ref="nofollow noopener noreferrer">kingbase.com.cn/explore</a>
åœ¨è¿™é‡Œä½ å¯ä»¥æ‰¾åˆ°æ›´å¤šèµ„æ·±ä¸“å®¶çš„æŠ€æœ¯å¹²è´§ã€åŸç†è§£æå’Œæœ€ä½³å®è·µæ–‡æ¡£ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/130e752d5981471299828138e9710deb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766637336&amp;x-signature=RxckL%2F7ErVhecrU0qkRQ2P1oDpE%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ™‹æ±Ÿæ–‡å­¦åŸè´¦å·å®‰å…¨ç®€ç›´å°±æ˜¯ç¬‘è¯]]></title>    <link>https://juejin.cn/post/7584719268044439586</link>    <guid>https://juejin.cn/post/7584719268044439586</guid>    <pubDate>2025-12-18T05:00:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584719268044439586" data-draft-id="7584345932944195635" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™‹æ±Ÿæ–‡å­¦åŸè´¦å·å®‰å…¨ç®€ç›´å°±æ˜¯ç¬‘è¯"/> <meta itemprop="keywords" content="å®‰å…¨,æ¶æ„,äº§å“"/> <meta itemprop="datePublished" content="2025-12-18T05:00:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•²æ•²æ•²æ•²æš´ä½ è„‘è¢‹"/> <meta itemprop="url" content="https://juejin.cn/user/224781403162798"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™‹æ±Ÿæ–‡å­¦åŸè´¦å·å®‰å…¨ç®€ç›´å°±æ˜¯ç¬‘è¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/224781403162798/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•²æ•²æ•²æ•²æš´ä½ è„‘è¢‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T05:00:29.000Z" title="Thu Dec 18 2025 05:00:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬äººå–œæ¬¢æœ‰ç©ºçœ‹çœ‹æ™‹æ±Ÿç½‘æ–‡ï¼Œæœ€è¿‘å¹´å°¾æ¯”è¾ƒå¿™ï¼Œæ²¡æ€ä¹ˆæ‰“å¼€æ™‹æ±Ÿï¼Œç»“æœæ˜¨å¤©æ‰“å¼€çš„æ—¶å€™ï¼Œçªç„¶æç¤ºæˆ‘è´¦å·å¼‚å¸¸ï¼Œç„¶åæˆ‘æ€€ç–‘æ˜¯è¢«ç›—å·äº†ï¼Œè¿›è¡Œç”³è¯‰åé‡æ–°ç™»å½•ï¼Œå‘ç°è‡ªå·±èŠ±é’±ä¹°çš„æ™‹æ±Ÿå¸å‡ ä¹è¢«ç›—å·è€…æ¸…ç©ºï¼</p>
<h2 data-id="heading-0">1. å¼‚å¸¸è¡Œä¸ºç›‘æµ‹ä¸åˆ°ä½</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33c4837819ee4053ae171926e2d5d8d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWy5pWy5pWy5pWy5pq05L2g6ISR6KKL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766638829&amp;x-signature=O1btJ5uoSF7UqvRi0BLeXHSxQ7o%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcb691a9d50f44f2bd26d764e612a5f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWy5pWy5pWy5pWy5pq05L2g6ISR6KKL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766638829&amp;x-signature=cAo2cyucm7gre8r%2Bj2i6UibdhgM%3D" alt="image.png" loading="lazy"/></p>
<p>å›çœ‹è´­ä¹°è®°å½•ï¼Œç›—å·è€…ä¸€å…±ç›—åˆ·äº†æˆ‘<code>ã€11845ã€‘</code>æ™‹æ±Ÿå¸ï¼ŒæŠ˜åˆäººæ°‘å¸<code>ã€118.45ã€‘</code>å…ƒï¼Œå¹¶ä¸”éƒ½æ˜¯ä¸€å¤©ä¹‹å†…å¤šæ¬¡è´­ä¹°ä¸åŒçš„æ–‡ï¼Œè€Œè¿™äº›æ–‡çš„é˜…è¯»è¿›åº¦å…¨éƒ½æ˜¯0%ï¼Œææœ‰å¯èƒ½ä¸ºäº†åˆ·è®¢é˜…ä¹‹ç±»ï¼Œé‚£ä¹ˆè¿™äº›æ–‡çš„ä½œè€…çš„æˆç»©æ˜¯å­˜ç–‘çš„ï¼Œå¾ˆå¯èƒ½æ¶‰å«Œè´­ä¹°äº†åˆ·æ¦œä¹‹ç±»çš„æœåŠ¡ã€‚</p>
<p>ç„¶åæˆ‘æŸ¥äº†ä¸€ä¸‹ç½‘ä¸Šï¼Œè®¸å¤šè¢«ç›—å·çš„è¯»è€…éƒ½æœ‰ç±»ä¼¼é­é‡ï¼</p>
<p>åŸºäºè¿™æ ·çš„é˜…è¯»è¡Œä¸ºï¼Œæ™‹æ±Ÿç«Ÿç„¶æ²¡æœ‰åšå¼‚å¸¸è¡Œä¸ºç›‘æµ‹ï¼Œä»è€Œæ’æŸ¥ä½œè€…çš„è¿è§„è¡Œä¸ºï¼Œåšå‡ºå¯¹åº”å¤„ç½šï¼Œå¹¶åŠæ—¶å‘ç°å¯ç–‘æ¶ˆè´¹ï¼Œå†»ç»“è´¦æˆ·ï¼Œé¿å…æ›´å¤§æŸå¤±ã€‚</p>
<h2 data-id="heading-1">2. å¼‚åœ°ç™»å½•ä¸æé†’ï¼Œè¢«ç›—åï¼ŒåŸç™»å½•ä¸é€€å‡º</h2>
<p>æˆ‘æ‰¿è®¤è‡ªå·±ä¸å¤Ÿä¸¥è°¨ï¼Œä½¿ç”¨äº†é‡å¤å¯†ç ï¼Œå¢åŠ äº†è¢«ç›—å·çš„é£é™©ï¼Œæ˜¯æœ‰è´£ä»»çš„ï¼Œä½†æ˜¯æ™‹æ±Ÿçš„è´¦æˆ·å®‰å…¨çœŸçš„å¤ªå„¿æˆäº†ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68fe578533d74737a8d4f39dbe746659~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWy5pWy5pWy5pWy5pq05L2g6ISR6KKL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766638829&amp;x-signature=Xt2xZQwI5ozzP4UWlgTu2QdPXLo%3D" alt="image.png" loading="lazy"/></p>
<p>ç™»å½•æ—¥å¿—å¯è§ï¼Œ10æœˆ11æ—¥å‡ºç°è¿ç»­ä¸åŒç«¯çš„å¼‚åœ°ç™»å½•ï¼Œæˆ‘ç«Ÿæœªæ”¶åˆ°ä»»ä½•å¼‚å¸¸æ¶ˆæ¯æé†’ã€‚</p>
<p>11æœˆ06æ—¥ç›—å·è€…ä¹Ÿå¼‚åœ°å°è¯•ç™»å½•ï¼Œæˆ‘ä¹Ÿæ²¡æ”¶åˆ°å¼‚å¸¸æé†’</p>
<p>ç›´åˆ°12æœˆ15æ—¥ï¼Œç›—å·è€…è¿ç»­å¤šæ¬¡å¼‚åœ°ç™»å½•ï¼ŒæŠŠé’±èŠ±å…‰ã€‚</p>
<p>12æœˆ16æ—¥æ™šä¸Šï¼Œæˆ‘ç»ˆäºæœ‰ç©ºæ‰“å¼€æ™‹æ±Ÿï¼Œæç¤ºè´¦å·å¼‚å¸¸ç™»å½•ä¸äº†ï¼Œè¿™ä¸ªå¼‚å¸¸æ˜¯<code>ã€å®šä¹‰æˆ‘æ˜¯å¼‚å¸¸ç”¨æˆ·ã€‘</code>ï¼çœŸçš„å¾ˆå¯ç¬‘ï¼</p>
<p>è¿™ä¹ˆç®€å•çš„è¡Œä¸ºç›‘æµ‹éƒ½æ²¡æœ‰ï¼Œè·å–ç”¨æˆ·ç™»å½•åœ°æ–¹å¯¹æ¯”æ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´æ—¶å‘é€çŸ­ä¿¡æˆ–é‚®ä»¶è¿›è¡Œå¼‚å¸¸æé†’ï¼ŒåŠŸèƒ½å®ç°å¾ˆç®€å•ï¼Œè€Œæ³¨å†Œçš„æ—¶å€™æ‰‹æœºå·å’Œé‚®ç®±éƒ½ç•™äº†çš„ï¼Œä¼°è®¡æ™‹æ±Ÿçœé’±ï¼Œæ‡’å¾—å¼€å‘è¿™ä¸ªåŠŸèƒ½å§ï¼</p>
<p>ç„¶ååœ¨ç»†çœ‹ä¸€ä¸‹ï¼Œ10æœˆ11å·ï¼Œæˆ‘çš„è´¦æˆ·å°±è¢«å¼‚åœ°ç™»å½•è¢«ç›—äº†ï¼è€Œæˆ‘æ‰‹æœºç«¯æ™‹æ±Ÿä¾æ—§å¤„äºç™»å½•çŠ¶æ€ï¼Œå¯ä»¥æ‰“å¼€ï¼</p>
<p>æˆ‘ç®€ç›´å¤§æ— è¯­ï¼æ™‹æ±Ÿç«Ÿç„¶<code>ã€æ²¡æœ‰åšç™»å½•çŠ¶æ€å¤±æ•ˆå¤„ç†ã€‘</code>ï¼å³è´¦å·åªè¦è´¦å·å¯†ç å¯¹ï¼Œå°±å¯ä»¥éšæ—¶éšåœ°åŒæ—¶ç™»å½•ï¼</p>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œç§»åŠ¨ç«¯åº”è¯¥åªèƒ½æœ‰ä¸€ä¸ªç™»å½•çŠ¶æ€æœ‰æ•ˆï¼Œå³ä¾¿æ¢æ–°æ‰‹æœºï¼Œç”¨è´¦å·å¯†ç ç™»å½•ï¼Œé‚£ä¹ˆæ—§çš„ç™»å½•çŠ¶æ€ç½®ä¸ºå¤±æ•ˆï¼Œç”¨æˆ·åœ¨åŸç™»å½•çš„æ‰‹æœºå†æ¬¡æ‰“å¼€æ—¶å°±ä¼šè¢«å¼ºåˆ¶é€€å‡ºç™»å½•ã€‚</p>
<p>è€Œä¸”ï¼Œæ™‹æ±Ÿä¸åŒç«¯å¦‚webç«¯å¦å¤–ç™»å½•ï¼Œè‹¥ä¸å¼€å¯å®‰å…¨ä¿æŠ¤ï¼Œç«Ÿç„¶ä¸éœ€åšä»»ä½•éªŒè¯å°±èƒ½æˆåŠŸç™»å½•ï¼</p>
<p>è¿™å¯¼è‡´æˆ‘æœªå‘ç°ç™»å½•å¼‚å¸¸ï¼Œä»¥ä¸ºè‡ªå·±çœ‹æ–‡ä¹°æ–‡å¤šï¼Œæ™‹æ±Ÿå¸ä¸€ä¸‹å°±ç”¨å®Œäº†ï¼</p>
<p>è‹¥æœ‰åšç™»å½•çŠ¶æ€å¤±æ•ˆå¤„ç†ï¼Œé‚£ä¹ˆå½“ç›—å·è€…ç™»å½•äº†æˆ‘çš„è´¦å·ï¼Œæˆ‘å°±ä¼šå¼ºåˆ¶é€€å‡ºï¼Œä¼šæ„è¯†åˆ°ä¸å¯¹åŠ²ï¼Œå»çœ‹çœ‹æ—¥å¿—ï¼Œæˆ–è®¸å°±å‘ç°è¢«ç›—å·ï¼ŒåŠæ—¶ä¿®æ”¹å¯†ç ï¼Œå¼€å¯è´¦å·å®‰å…¨ä¿æŠ¤ï¼Œé¿å…æ›´å¤§çš„æŸå¤±ã€‚</p>
<p>ç„¶è€Œæ²¡æœ‰ï¼Œäºæ˜¯æˆ‘å‚»å‚»åœ°ç»§ç»­å……å€¼çœ‹æ–‡ï¼Œæœ€è¿‘æ¯”è¾ƒå¿™ï¼Œæ²¡ç©ºçœ‹æ™‹æ±Ÿï¼Œç›´åˆ°12æœˆ16æ—¥æ‰“å¼€æ˜¾ç¤ºè´¦æˆ·å¼‚å¸¸æ— æ³•ç™»å½•æ‰æ„è¯†åˆ°è¢«ç›—å·ï¼Œç”³è¯‰å†æ¬¡ç™»å½•åæ™‹æ±Ÿå¸å‡ ä¹è¢«ç›—åˆ·å®Œï¼ŒæŸå¤±åŠ å€ï¼</p>
<h2 data-id="heading-2">3. å®‰å…¨è®¾ç½®å½¢åŒè™šè®¾ï¼Œéœ€æ‰‹åŠ¨å¼€å¯æ‰ç”Ÿæ•ˆ</h2>
<p>è¢«ç›—å·åï¼Œæˆ‘åœ¨å¼€é€šå„ç§å®‰å…¨ä¿æŠ¤çš„è¿‡ç¨‹ä¸­ï¼Œè¶Šå‘è§‰å¾—æ™‹æ±Ÿæ€åº¦å‚²æ…¢ã€‚</p>
<p>æ˜æ˜æœ‰é‚£ä¹ˆå¤šå®‰å…¨éªŒè¯è®¾ç½®ï¼Œå´ä¸€ç‚¹æé†’ä¹Ÿæ²¡æœ‰ï¼Œå…¨å¾—ç”¨æˆ·è‡ªå·±æ‰‹åŠ¨å¼€å¯æ‰ç”Ÿæ•ˆï¼Œç­‰äºå¹³å°æœ‰å¾ˆå¤šéšç§˜çš„å®‰å…¨æªæ–½ï¼Œç”¨æˆ·ä½ ä»¬è‡ªå·±çœ‹ç€åŠã€‚</p>
<p>æˆ‘å’¨è¯¢å®¢æœï¼Œå›å¤çš„æ„æ€å°±æ˜¯å‡å¦‚ä½ æ²¡å¼€å¯è´¦å·å®‰å…¨ä¿æŠ¤ï¼Œå‘ç”Ÿç›—å·çš„æŸå¤±å±äºä¸ªäººè´£ä»»ã€‚å¦‚æœæœ‰é‡å¤§é‡‘é¢æŸå¤±è¯·è‡ªè¡ŒæŠ¥è­¦å¤„ç†ã€‚</p>
<p>éå¸¸å¥½ï¼Œå…è´£å£°æ˜å¦¥å¦¥çš„ï¼å¹³å°è¿™æ ·çš„æ€åº¦æ˜¯æå…¶ä¸è´Ÿè´£çš„ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/680e59a8733b4fea8654a80dcb2eba0f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWy5pWy5pWy5pWy5pq05L2g6ISR6KKL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766638829&amp;x-signature=c5rI3IlhuOGLx0aKZtalLstUk%2BU%3D" alt="image.png" loading="lazy"/></p>
<p>ç”¨æˆ·æœªè®¾ç½®è´¦å·å®‰å…¨ä¿æŠ¤ä¹Ÿéœ€åŠæ—¶æé†’ï¼Œè¿™ä¹Ÿæ˜¯å¹³å°çš„ä¹‰åŠ¡ï¼</p>
<p>å°±åƒä¸ªç¨APPï¼Œè®¸ä¹…æ²¡ç™»å½•ï¼Œå†æ¬¡ç™»å½•æ—¶è‡³å°‘äººå®¶æé†’ä½ ä¿®æ”¹å¯†ç ï¼</p>
<p>win10ç³»ç»Ÿä¹Ÿä¼šå®šæ—¶æé†’ä½ ä¿®æ”¹ç”µè„‘å¯†ç ï¼</p>
<p>æ™‹æ±Ÿåœ¨ç™»å½•é€»è¾‘å­˜åœ¨å·¨å¤§å®‰å…¨æ¼æ´çš„æƒ…å†µä¸‹ï¼Œä¾æ—§ä¿æŒæ²‰é»˜ï¼Œä¸€ä¸ªæé†’éƒ½æ²¡æœ‰ï¼</p>
<h2 data-id="heading-3">4. æ™‹æ±Ÿè´¦æˆ·å®‰å…¨å°±æ˜¯ç¬‘è¯</h2>
<p>æ™‹æ±Ÿå¹³å°å­˜åœ¨æ˜æ˜¾æ¼æ´æ‰ç»™äº†ç›—å·è€…å¯ä¹˜ä¹‹æœº</p>
<ol>
<li>å¯¹äºå¤šæ¬¡è´­ä¹°ä¸”é˜…è¯»è¿›åº¦ä¸º0%çš„å¼‚å¸¸è¡Œä¸ºæœªç›‘æµ‹</li>
<li>å¼‚åœ°ç™»å½•ä¸æé†’</li>
<li>è¢«ç›—åï¼ŒåŸç™»å½•ä¸é€€å‡ºï¼Œå¯¼è‡´ä¸èƒ½åŠæ—¶å‘ç°</li>
<li>å®‰å…¨è®¾ç½®å½¢åŒè™šè®¾ï¼Œéœ€æ‰‹åŠ¨å¼€å¯æ‰èƒ½ç”Ÿæ•ˆï¼Œå¹¶åœ¨ç™»å½•é€»è¾‘æœ‰é—®é¢˜çš„æƒ…å†µï¼Œæ²¡æœ‰å±¥è¡ŒåŠæ—¶æé†’çš„ä¹‰åŠ¡</li>
</ol>
<p>è®¸å¤šè¢«ç›—å·çš„è¯»è€…éƒ½æœ‰ç±»ä¼¼æƒ…å†µå‡ºç°ï¼Œè€Œæ™‹æ±Ÿä¸æ˜¯åŠæ—¶å¤„ç†ï¼Œè€Œæ˜¯ç½®ä¹‹ä¸ç†ã€‚</p>
<p>æ™‹æ±Ÿå¹³å°æœ‰ä¸¥é‡çš„å®‰å…¨æ¼æ´è¿‡å¤±ï¼</p>
<p>ä¸–ç•ŒçœŸæ˜¯ä¸ªå·¨å¤§çš„è‰å°ç­å­ï¼æ™‹æ±Ÿæ–‡å­¦åŸä½œä¸ºç½‘æ–‡ç•Œå¥³é¢‘çš„æ‰›æŠŠå­ï¼Œå¤§é‡è¯»è€…ç”¨å¾®ä¿¡æˆ–æ”¯ä»˜å®å……å€¼è´­ä¹°æœåŠ¡ï¼Œæµæ°´è´¦è‚¯å®šä¸å°‘ï¼Œç»“æœè´¦æˆ·å®‰å…¨æ–¹é¢ç«Ÿå¦‚æ­¤è‰ç‡ï¼Œå­˜åœ¨å¦‚æ­¤å¤§çš„å®‰å…¨æ¼æ´ï¼è¯´å‡ºå»éƒ½éš¾ä»¥ç½®ä¿¡ï¼åŒè¡Œç¨‹åºå‘˜å¬äº†éƒ½å¾—ç¬‘è¯ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»äº§å“ç»ç†è§†è§’æ‹†è§£ LangChain çš„æŠ½è±¡è®¾è®¡]]></title>    <link>https://juejin.cn/post/7584729825384874022</link>    <guid>https://juejin.cn/post/7584729825384874022</guid>    <pubDate>2025-12-18T03:08:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584729825384874022" data-draft-id="7584742635501830171" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»äº§å“ç»ç†è§†è§’æ‹†è§£ LangChain çš„æŠ½è±¡è®¾è®¡"/> <meta itemprop="keywords" content="LangChain,LLM,AIGC"/> <meta itemprop="datePublished" content="2025-12-18T03:08:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Yooå‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/2791012486624116"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»äº§å“ç»ç†è§†è§’æ‹†è§£ LangChain çš„æŠ½è±¡è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2791012486624116/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Yooå‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:08:19.000Z" title="Thu Dec 18 2025 03:08:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»äº§å“ç»ç†è§†è§’æ‹†è§£ LangChain çš„æŠ½è±¡è®¾è®¡</h2>
<blockquote>
<p>å¦‚æœä½ æŠŠ LangChain ä»…ä»…ç†è§£ä¸ºä¸€ä¸ªâ€œè°ƒç”¨å¤§æ¨¡å‹çš„ Python æ¡†æ¶â€ï¼Œé‚£ä½ å¤§æ¦‚ç‡ä½ä¼°äº†å®ƒã€‚</p>
<p>ä»äº§å“ç»ç†ï¼ˆå°¤å…¶æ˜¯ AI / å¹³å°å‹ PMï¼‰çš„è§†è§’çœ‹ï¼ŒLangChain æœ¬è´¨ä¸Šæ˜¯ä¸€å¥—<strong>ä¸º AI åº”ç”¨è§„æ¨¡åŒ–è€Œç”Ÿçš„æŠ½è±¡ä½“ç³»</strong>ã€‚</p>
</blockquote>
<p>æœ¬æ–‡å°†ä¸ä»â€œæ€ä¹ˆç”¨â€ï¼Œè€Œæ˜¯ä»<strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡</strong>å‡ºå‘ï¼Œç³»ç»Ÿæ‹†è§£ LangChain çš„æ ¸å¿ƒæŠ½è±¡ï¼Œå¹¶å›ç­”ä¸‰ä¸ªå…³é”®é—®é¢˜ï¼š</p>
<ul>
<li>LangChain åœ¨è§£å†³ä»€ä¹ˆäº§å“çº§é—®é¢˜ï¼Ÿ</li>
<li>æ¯ä¸€å±‚æŠ½è±¡èƒŒåçš„äº§å“é€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>è¿™äº›æŠ½è±¡é€‚åˆä»€ä¹ˆï¼Œä¸é€‚åˆä»€ä¹ˆï¼Ÿ</li>
</ul>
<hr/>
<h3 data-id="heading-1">ä¸€ã€äº§å“èƒŒæ™¯ï¼šLangChain åœ¨è§£å†³ä»€ä¹ˆé—®é¢˜</h3>
<p>åœ¨ LangChain å‡ºç°ä¹‹å‰ï¼Œå¤§æ¨¡å‹åº”ç”¨æ™®éå­˜åœ¨ä»¥ä¸‹ç—›ç‚¹ï¼š</p>
<ol>
<li>Prompt æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œéš¾ä»¥å¤ç”¨å’Œè¿­ä»£</li>
<li>æ¨¡å‹è°ƒç”¨é€»è¾‘ä¸ä¸šåŠ¡ä»£ç å¼ºè€¦åˆ</li>
<li>å¤–éƒ¨æ•°æ®æ¥å…¥é«˜åº¦å®šåˆ¶ï¼Œéš¾ä»¥è§„æ¨¡åŒ–</li>
<li>å¤šæ­¥éª¤æ¨ç†ä¸å·¥å…·è°ƒç”¨ä¸å¯æ§</li>
<li>Demo å¾ˆå¿«ï¼ŒProduction å¾ˆéš¾</li>
</ol>
<p>è¿™äº›é—®é¢˜å¹¶ä¸æ˜¯â€œæ¨¡å‹èƒ½åŠ›ä¸å¤Ÿâ€ï¼Œè€Œæ˜¯<strong>ç¼ºä¹ä¸€å¥—é¢å‘ LLM çš„åº”ç”¨çº§æŠ½è±¡</strong>ã€‚</p>
<p>LangChain çš„æ ¸å¿ƒç›®æ ‡å¯ä»¥æ€»ç»“ä¸ºä¸€å¥è¯ï¼š</p>
<blockquote>
<p><strong>æŠŠâ€œè°ƒç”¨å¤§æ¨¡å‹â€è¿™ä»¶äº‹ï¼Œå‡çº§ä¸ºâ€œæ„å»ºå¤§æ¨¡å‹åº”ç”¨èƒ½åŠ›å¹³å°â€ã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-2">äºŒã€LangChain çš„æ•´ä½“æŠ½è±¡æ€è·¯</h3>
<p>å¦‚æœç”¨äº§å“è¯­è¨€æ¦‚æ‹¬ LangChain çš„è®¾è®¡å“²å­¦ï¼Œé‚£å°±æ˜¯ï¼š</p>
<blockquote>
<p><strong>å°†ä¸å¯æ§çš„æ™ºèƒ½èƒ½åŠ›ï¼Œæ‹†è§£ä¸ºå¯é…ç½®ã€å¯ç»„åˆã€å¯æ›¿æ¢çš„æ¨¡å—ã€‚</strong></p>
</blockquote>
<p>ä½ å¯ä»¥æŠŠ LangChain ç†è§£ä¸ºä¸€å¥—â€œLLM åº”ç”¨æ“ä½œç³»ç»Ÿâ€ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç®€å•çš„ SDKã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬é€å±‚æ‹†è§£å®ƒçš„å…³é”®æŠ½è±¡ã€‚</p>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€ç¬¬ä¸€å±‚æŠ½è±¡ï¼šModel â‰  äº§å“èƒ½åŠ›</h3>
<h4 data-id="heading-4">æŠ½è±¡è®¾è®¡</h4>
<p>LangChain å°†æ¨¡å‹ç»Ÿä¸€æŠ½è±¡ä¸º <code>Model</code> æ¥å£ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p>
<ul>
<li>LLM</li>
<li>ChatModel</li>
<li>Embeddings</li>
</ul>
<h4 data-id="heading-5">äº§å“ç»ç†è§†è§’</h4>
<p><strong>è§£å†³çš„é—®é¢˜ï¼š</strong></p>
<ul>
<li>é¿å…äº§å“ä¸å•ä¸€æ¨¡å‹å‚å•†å¼ºç»‘å®š</li>
<li>æ”¯æŒæ¨¡å‹æ›¿æ¢ã€å¯¹æ¯”ä¸é™çº§</li>
</ul>
<p><strong>äº§å“ä»·å€¼ï¼š</strong></p>
<ul>
<li>æ¨¡å‹æˆä¸ºâ€œå¯æ’æ‹”èµ„æºâ€</li>
<li>ä¸ºæˆæœ¬æ§åˆ¶å’Œæ•ˆæœè¯„ä¼°é¢„ç•™ç©ºé—´</li>
</ul>
<p><strong>å–èˆï¼š</strong></p>
<ul>
<li>ä¸ºäº†ç»Ÿä¸€æ¥å£ï¼Œç‰ºç‰²éƒ¨åˆ†æ¨¡å‹çš„ç‹¬ç‰¹èƒ½åŠ›</li>
</ul>
<p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„<strong>å¹³å°ä¼˜å…ˆäºå•ç‚¹èƒ½åŠ›</strong>çš„äº§å“å†³ç­–ã€‚</p>
<hr/>
<h3 data-id="heading-6">å››ã€ç¬¬äºŒå±‚æŠ½è±¡ï¼šPrompt æ˜¯é…ç½®èµ„äº§ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²</h3>
<h4 data-id="heading-7">æŠ½è±¡è®¾è®¡</h4>
<p>LangChain å°† Prompt æŠ½è±¡ä¸ºï¼š</p>
<ul>
<li>PromptTemplate</li>
<li>ChatPromptTemplate</li>
<li>Few-shot Prompt</li>
</ul>
<h4 data-id="heading-8">äº§å“ç»ç†è§†è§’</h4>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ</strong></p>
<p>åœ¨çœŸå®äº§å“ä¸­ï¼ŒPrompt å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ul>
<li>é«˜é¢‘è°ƒæ•´</li>
<li>å¼ºä¾èµ–ä¸šåŠ¡è¯­ä¹‰</li>
<li>éœ€è¦å¿«é€Ÿè¯•é”™</li>
</ul>
<p>å› æ­¤ï¼ŒPrompt æœ¬è´¨ä¸Šæ˜¯<strong>ç­–ç•¥é…ç½®èµ„äº§</strong>ï¼Œè€Œä¸æ˜¯ä»£ç å¸¸é‡ã€‚</p>
<p><strong>å¸¦æ¥çš„å˜åŒ–ï¼š</strong></p>
<ul>
<li>Prompt å¯ä»¥è¢«ç‰ˆæœ¬åŒ–ç®¡ç†</li>
<li>æ”¯æŒ A/B æµ‹è¯•</li>
<li>éå·¥ç¨‹è§’è‰²ï¼ˆPM / ç®—æ³• / è¿è¥ï¼‰ä¹Ÿå¯ä»¥å‚ä¸ä¼˜åŒ–</li>
</ul>
<p><strong>ä»£ä»·ï¼š</strong></p>
<ul>
<li>åˆå­¦è€…å¿ƒæ™ºè´Ÿæ‹…ä¸Šå‡</li>
<li>Prompt å¤æ‚åº¦æ˜¾æ€§åŒ–</li>
</ul>
<hr/>
<h3 data-id="heading-9">äº”ã€ç¬¬ä¸‰å±‚æŠ½è±¡ï¼šChain = ä¸šåŠ¡èƒ½åŠ›å•å…ƒ</h3>
<h4 data-id="heading-10">æŠ½è±¡è®¾è®¡</h4>
<p>Chain ç”¨äºæè¿°ä¸€ä¸ªå®Œæ•´ã€å¯å¤ç”¨çš„ä»»åŠ¡æµç¨‹ï¼š</p>
<pre><code class="hljs">è¾“å…¥ â†’ å¤„ç† â†’ è¾“å‡º
</code></pre>
<p>å¸¸è§ Chain åŒ…æ‹¬ï¼š</p>
<ul>
<li>LLMChain</li>
<li>RetrievalQA</li>
<li>SequentialChain</li>
</ul>
<h4 data-id="heading-11">äº§å“ç»ç†è§†è§’</h4>
<p>Chain ä¸æ˜¯â€œå‡½æ•°â€ï¼Œè€Œæ˜¯<strong>ä¸šåŠ¡åŠ¨ä½œçš„æœ€å°å•å…ƒ</strong>ã€‚</p>
<p>å®ƒçš„ä»·å€¼åœ¨äºï¼š</p>
<ul>
<li>å°†ä¸€æ¬¡æ¨¡å‹è°ƒç”¨ï¼Œå‡çº§ä¸ºå¯å¤ç”¨èƒ½åŠ›</li>
<li>æ”¯æŒåƒæ­ç§¯æœ¨ä¸€æ ·ç»„åˆå¤æ‚åº”ç”¨</li>
</ul>
<p>å¯ä»¥ç±»æ¯”ä¸ºï¼š</p>
<ul>
<li>ä½ä»£ç å¹³å°ä¸­çš„æµç¨‹èŠ‚ç‚¹</li>
<li>æ¨èç³»ç»Ÿä¸­çš„ç­–ç•¥é“¾è·¯</li>
</ul>
<hr/>
<h3 data-id="heading-12">å…­ã€ç¬¬å››å±‚æŠ½è±¡ï¼šMemory æ˜¯ä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥</h3>
<h4 data-id="heading-13">æŠ½è±¡è®¾è®¡</h4>
<p>LangChain æä¾›å¤šç§ Memory ç­–ç•¥ï¼š</p>
<ul>
<li>Buffer Memoryï¼ˆå…¨é‡ï¼‰</li>
<li>Window Memoryï¼ˆæ»‘çª—ï¼‰</li>
<li>Summary Memoryï¼ˆæ‘˜è¦ï¼‰</li>
</ul>
<h4 data-id="heading-14">äº§å“ç»ç†è§†è§’</h4>
<p>æ ¸å¿ƒæ´å¯Ÿæ˜¯ï¼š</p>
<blockquote>
<p><strong>ä¸Šä¸‹æ–‡ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè€Œæ˜¯â€œå¯¹å½“å‰å†³ç­–æœ‰ç”¨çš„ä¿¡æ¯â€ã€‚</strong></p>
</blockquote>
<p>Memory çš„å­˜åœ¨è®©ä»¥ä¸‹æƒè¡¡å˜å¾—æ˜¾æ€§ï¼š</p>
<ul>
<li>Token æˆæœ¬</li>
<li>å¯¹è¯ä½“éªŒ</li>
<li>æ¨¡å‹æ•ˆæœ</li>
</ul>
<p>è¿™æ˜¯ä¸€ç§å…¸å‹çš„â€œäº§å“åŒ–æ€ç»´â€ï¼Œè€Œä¸æ˜¯ç®—æ³•æ€ç»´ã€‚</p>
<hr/>
<h3 data-id="heading-15">ä¸ƒã€ç¬¬äº”å±‚æŠ½è±¡ï¼šRetriever æ˜¯æ•°æ®èƒ½åŠ›æ¥å£</h3>
<h4 data-id="heading-16">æŠ½è±¡è®¾è®¡</h4>
<p>LangChain æ˜ç¡®åŒºåˆ†ï¼š</p>
<ul>
<li>VectorStoreï¼ˆå­˜å‚¨ï¼‰</li>
<li>Retrieverï¼ˆå¬å›ï¼‰</li>
</ul>
<h4 data-id="heading-17">äº§å“ç»ç†è§†è§’</h4>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å…¸å‹çš„ä¼ä¸šçº§æŠ½è±¡ã€‚</p>
<p>ç”¨æˆ·å¹¶ä¸å…³å¿ƒï¼š</p>
<ul>
<li>ç”¨çš„æ˜¯ FAISS è¿˜æ˜¯ Milvus</li>
</ul>
<p>ç”¨æˆ·åªå…³å¿ƒï¼š</p>
<ul>
<li>èƒ½ä¸èƒ½æ‰¾åˆ°å¯¹çš„å†…å®¹</li>
</ul>
<p>Retriever çš„ä»·å€¼åœ¨äºï¼š</p>
<ul>
<li>è§£è€¦åº•å±‚å­˜å‚¨</li>
<li>æ”¯æŒæ··åˆæ£€ç´¢ã€å¤šè·¯å¬å›</li>
<li>ä¸º RAG è§„æ¨¡åŒ–æ‰“åŸºç¡€</li>
</ul>
<hr/>
<h3 data-id="heading-18">å…«ã€ç¬¬å…­å±‚æŠ½è±¡ï¼šAgent = æŠŠæ¨¡å‹å½“å†³ç­–è€…</h3>
<h4 data-id="heading-19">æŠ½è±¡è®¾è®¡</h4>
<p>Agent çš„æœ¬è´¨ä¸æ˜¯â€œè°ƒç”¨å·¥å…·â€ï¼Œè€Œæ˜¯ï¼š</p>
<blockquote>
<p><strong>è®© LLM å†³å®šä¸‹ä¸€æ­¥åšä»€ä¹ˆã€‚</strong></p>
</blockquote>
<h4 data-id="heading-20">äº§å“ç»ç†è§†è§’</h4>
<p>è¿™æ˜¯ LangChain æœ€æ¿€è¿›ã€ä¹Ÿæœ€å…·äº‰è®®çš„è®¾è®¡ã€‚</p>
<p>å®ƒå°† LLM çš„è§’è‰²ä»ï¼š</p>
<ul>
<li>å†…å®¹ç”Ÿæˆå™¨</li>
</ul>
<p>å‡çº§ä¸ºï¼š</p>
<ul>
<li>æµç¨‹æ§åˆ¶ä¸­æ¢</li>
</ul>
<p><strong>é€‚åˆåœºæ™¯ï¼š</strong></p>
<ul>
<li>åˆ†æå‹ä»»åŠ¡</li>
<li>è‡ªåŠ¨åŒ–æ¢ç´¢ä»»åŠ¡</li>
</ul>
<p><strong>ä¸é€‚åˆåœºæ™¯ï¼š</strong></p>
<ul>
<li>å¼º SLA</li>
<li>å¼ºè§„åˆ™ä¸šåŠ¡</li>
</ul>
<p>æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ç”¨â€œæ™ºèƒ½â€æ¢â€œç¡®å®šæ€§â€ã€‚</p>
<hr/>
<h3 data-id="heading-21">ä¹ã€ç¬¬ä¸ƒå±‚æŠ½è±¡ï¼šOutput Parser æ˜¯å·¥ç¨‹å…œåº•</h3>
<h4 data-id="heading-22">æŠ½è±¡è®¾è®¡</h4>
<p>Output Parser ç”¨äºå°†è‡ªç„¶è¯­è¨€è¾“å‡ºè½¬ä¸ºç»“æ„åŒ–æ•°æ®ã€‚</p>
<h4 data-id="heading-23">äº§å“ç»ç†è§†è§’</h4>
<p>è¿™æ˜¯ä» Demo èµ°å‘ Production çš„åˆ†æ°´å²­ã€‚</p>
<p>Parser çš„å­˜åœ¨ä½“ç°äº†ä¸€ä¸ªç°å®åˆ¤æ–­ï¼š</p>
<blockquote>
<p><strong>LLM çš„è¾“å‡ºæ°¸è¿œä¸å¯é ï¼Œå¿…é¡»è¢«çº¦æŸã€‚</strong></p>
</blockquote>
<p>è¿™æ˜¯å·¥ç¨‹ç†æ€§å¯¹æ¨¡å‹ä¸ç¡®å®šæ€§çš„ç³»ç»Ÿæ€§å›åº”ã€‚</p>
<hr/>
<h3 data-id="heading-24">åã€æ•´ä½“æŠ½è±¡æ€»ç»“</h3>













































<table><thead><tr><th>æŠ½è±¡å±‚</th><th>æœ¬è´¨è§’è‰²</th><th>äº§å“ç›®çš„</th></tr></thead><tbody><tr><td>Model</td><td>èµ„æºå±‚</td><td>è§£è€¦æ¨¡å‹</td></tr><tr><td>Prompt</td><td>ç­–ç•¥å±‚</td><td>å¯é…ç½®</td></tr><tr><td>Chain</td><td>èƒ½åŠ›å±‚</td><td>å¯å¤ç”¨</td></tr><tr><td>Memory</td><td>æˆæœ¬ / ä½“éªŒç­–ç•¥</td><td>å¯æ§ä¸Šä¸‹æ–‡</td></tr><tr><td>Retriever</td><td>æ•°æ®æ¥å£</td><td>ä¼ä¸šåŒ–</td></tr><tr><td>Agent</td><td>å†³ç­–å±‚</td><td>è‡ªåŠ¨åŒ–</td></tr><tr><td>Parser</td><td>ç¨³å®šæ€§ä¿éšœ</td><td>å¯äº¤ä»˜</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-25">åä¸€ã€å†™åœ¨æœ€å</h3>
<p>LangChain çš„æŠ½è±¡å¹¶ä¸â€œä¼˜é›…â€ï¼Œç”šè‡³åœ¨å¾ˆå¤šäººçœ‹æ¥æ˜¯â€œåç›´è§‰â€çš„ã€‚</p>
<p>ä½†ä»äº§å“ç»ç†è§†è§’çœ‹ï¼Œå®ƒæ˜¯åœ¨<strong>ä¸º AI åº”ç”¨çš„é•¿æœŸæ¼”è¿›æå‰è¿˜å€º</strong>ï¼š</p>
<ul>
<li>ç‰ºç‰²äº†æ˜“å­¦æ€§</li>
<li>ç‰ºç‰²äº†ç®€æ´æ€§</li>
<li>ç‰ºç‰²äº†éƒ¨åˆ†æ€§èƒ½</li>
</ul>
<p>æ¢æ¥çš„æ˜¯ï¼š</p>
<ul>
<li>å¯æ‰©å±•</li>
<li>å¯æ¼”è¿›</li>
<li>å¯äº¤ä»˜</li>
</ul>
<blockquote>
<p><strong>LangChain ä¸æ˜¯ä¸ºäº†è®©ä½ æ›´å¿«å†™ Demoï¼Œè€Œæ˜¯ä¸ºäº†è®©ä½ æœ€ç»ˆèƒ½æŠŠ AI äº§å“äº¤ä»˜å‡ºå»ã€‚</strong></p>
</blockquote>
<p>å¦‚æœä½ æ­£åœ¨åš RAGã€Agent æˆ– AI Copilot ç±»äº§å“ï¼Œè¿™å¥—æŠ½è±¡å€¼å¾—ä½ è®¤çœŸç†è§£ï¼Œè€Œä¸æ˜¯ç®€å•â€œç”¨æˆ–ä¸ç”¨â€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBootåŠ¨æ€è„±æ•å®æˆ˜ï¼Œä»æ³¨è§£åˆ°AOPçš„ä¼˜é›…æ‰“ç æœ¯]]></title>    <link>https://juejin.cn/post/7584731726732787727</link>    <guid>https://juejin.cn/post/7584731726732787727</guid>    <pubDate>2025-12-18T02:49:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584731726732787727" data-draft-id="7584711683773562880" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBootåŠ¨æ€è„±æ•å®æˆ˜ï¼Œä»æ³¨è§£åˆ°AOPçš„ä¼˜é›…æ‰“ç æœ¯"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-18T02:49:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‚Ÿç©ºç å­—"/> <meta itemprop="url" content="https://juejin.cn/user/3139860942296830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBootåŠ¨æ€è„±æ•å®æˆ˜ï¼Œä»æ³¨è§£åˆ°AOPçš„ä¼˜é›…æ‰“ç æœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3139860942296830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‚Ÿç©ºç å­—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T02:49:26.000Z" title="Thu Dec 18 2025 02:49:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°æ‚Ÿã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ•°æ®è„±æ•ï¼šæ•°æ®ç•Œçš„â€œçŠ¹æŠ±çµç¶åŠé®é¢â€</h2>
<p>æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼šä½ çš„èº«ä»½è¯å·ã€æ‰‹æœºå·ã€é“¶è¡Œå¡å·è¿™äº›â€œéšç§éƒ¨ä½â€çš„æ•°æ®ï¼Œåœ¨ç³»ç»Ÿä¸­è£¸å¥”â€”â€”è¿™ç®€ç›´æ¯”åœ¨å…¬å…±åœºæ‰€ç©¿çš‡å¸çš„æ–°è¡£è¿˜å°´å°¬ï¼æ•°æ®è„±æ•å°±æ˜¯ç»™è¿™äº›æ•æ„Ÿæ•°æ®ç©¿ä¸Šå¾—ä½“çš„â€œå°å†…è£¤â€ï¼Œè®©å®ƒä»¬åœ¨éœ€è¦å±•ç¤ºçš„æ—¶å€™æ—¢èƒ½å®Œæˆå·¥ä½œï¼Œåˆä¸è‡³äºæ˜¥å…‰ä¹æ³„ã€‚</p>
<p>æ•°æ®è„±æ•çš„å‡ ç§å¸¸è§å§¿åŠ¿ï¼š</p>
<ol>
<li><strong>é™æ€è„±æ•</strong>ï¼šåƒç»™ç…§ç‰‡æ‰“é©¬èµ›å…‹ï¼Œä¸€åŠ³æ°¸é€¸</li>
<li><strong>åŠ¨æ€è„±æ•</strong>ï¼šåƒæ™ºèƒ½å˜è‰²ç»ç’ƒï¼Œçœ‹äººä¸‹èœç¢Ÿ</li>
<li><strong>å‰ç«¯è„±æ•</strong>ï¼šåªåœ¨å±•ç¤ºæ—¶å®³ç¾ä¸€ä¸‹</li>
<li><strong>åç«¯è„±æ•</strong>ï¼šä»å‡ºç”Ÿå°±å¸¦ç€é¢å…·</li>
</ol>
<h2 data-id="heading-1">äºŒã€SpringBootè„±æ•æ–¹æ¡ˆå®æˆ˜</h2>
<h3 data-id="heading-2">æ–¹æ¡ˆ1ï¼šæ³¨è§£+åºåˆ—åŒ–æ–¹æ¡ˆï¼ˆç»™å­—æ®µè´´ä¸Šâ€œæ­¤å¤„æ‰“ç â€æ ‡ç­¾ï¼‰</h3>
<p><strong>æ­¥éª¤1ï¼šå…ˆæ¥ä¸ªè„±æ•æ³¨è§£ï¼Œåƒç»™æ•æ„Ÿéƒ¨ä½è´´æ ‡ç­¾</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> java.lang.annotation.*;

<span class="hljs-comment">/**
 * è„±æ•æ³¨è§£ï¼šç»™æ•æ„Ÿå­—æ®µè´´ä¸Šâ€œæ­¤å¤„éœ€è¦æ‰“ç â€çš„æ ‡ç­¾
 * å°±åƒåœ¨æ•°æ®èº«ä¸Šè´´äº†ä¸ªâ€œå„¿ç«¥ä¸å®œâ€çš„è­¦ç¤ºæ¡
 */</span>
<span class="hljs-meta">@Target</span>(<span class="hljs-type">ElementType</span>.<span class="hljs-type">FIELD</span>)
<span class="hljs-meta">@Retention</span>(<span class="hljs-type">RetentionPolicy</span>.<span class="hljs-type">RUNTIME</span>)
<span class="hljs-meta">@Documented</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> <span class="hljs-type">Sensitive</span> {
    <span class="hljs-comment">/**
     * è„±æ•ç±»å‹ï¼šå†³å®šæ€ä¹ˆæ‰“ç 
     */</span>
    <span class="hljs-type">SensitiveType</span> <span class="hljs-built_in">type</span>();
}

<span class="hljs-comment">/**
 * è„±æ•ç±»å‹æšä¸¾ï¼šå„ç§æ‰“ç æ–¹å¼ä»»å›é€‰æ‹©
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">SensitiveType</span> {
    <span class="hljs-comment">/** ä¸­æ–‡åï¼šå¼ *ä¸‰ */</span>
    <span class="hljs-type">CHINESE_NAME</span>,
    <span class="hljs-comment">/** èº«ä»½è¯å·ï¼š110**********1234 */</span>
    <span class="hljs-type">ID_CARD</span>,
    <span class="hljs-comment">/** æ‰‹æœºå·ï¼š138****1234 */</span>
    <span class="hljs-type">PHONE</span>,
    <span class="hljs-comment">/** é‚®ç®±ï¼št***@163.com */</span>
    <span class="hljs-type">EMAIL</span>,
    <span class="hljs-comment">/** é“¶è¡Œå¡å·ï¼š6217 **** **** 1234 */</span>
    <span class="hljs-type">BANK_CARD</span>,
    <span class="hljs-comment">/** åœ°å€ï¼šåŒ—äº¬å¸‚æµ·æ·€åŒº**** */</span>
    <span class="hljs-type">ADDRESS</span>
}
</code></pre>
<p><strong>æ­¥éª¤2ï¼šå®ç°è„±æ•åºåˆ—åŒ–å™¨ï¼Œä¸“ä¸šçš„â€œæ‰“ç å¸ˆâ€</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> com.fasterxml.jackson.core.JsonGenerator;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.JsonSerializer;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.SerializerProvider;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.<span class="hljs-keyword">annotation</span>.JsonSerialize;
<span class="hljs-keyword">import</span> java.io.IOException;

<span class="hljs-comment">/**
 * è„±æ•åºåˆ—åŒ–å™¨ï¼šä¸“ä¸šçš„â€œé©¬èµ›å…‹å¸ˆå‚…â€
 * è´Ÿè´£ç»™æ•æ„Ÿæ•°æ®ç©¿ä¸Šå¾—ä½“çš„è¡£æœ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SensitiveSerializer</span> <span class="hljs-title">extends</span> <span class="hljs-title">JsonSerializer</span>&lt;<span class="hljs-type">String</span>&gt; {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SensitiveType type;
    
    <span class="hljs-keyword">public</span> SensitiveSerializer(SensitiveType type) {
        <span class="hljs-keyword">this</span>.type = type;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> void serialize(String value, JsonGenerator gen, 
                         SerializerProvider serializers) throws IOException {
        <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>) {
            gen.writeNull();
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// æ ¹æ®è„±æ•ç±»å‹é€‰æ‹©ä¸åŒçš„â€œæ‰“ç å§¿åŠ¿â€</span>
        gen.writeString(maskData(value, type));
    }
    
    <span class="hljs-comment">/**
     * æ ¸å¿ƒè„±æ•é€»è¾‘ï¼šåå…«èˆ¬æ­¦è‰ºè½®ç•ªä¸Šé˜µ
     */</span>
    <span class="hljs-keyword">private</span> String maskData(String <span class="hljs-keyword">data</span>, SensitiveType type) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">data</span> == <span class="hljs-literal">null</span> || <span class="hljs-keyword">data</span>.isEmpty()) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">data</span>;
        }
        
        <span class="hljs-keyword">return</span> switch (type) {
            case CHINESE_NAME -&gt; maskChineseName(<span class="hljs-keyword">data</span>);
            case ID_CARD -&gt; maskIdCard(<span class="hljs-keyword">data</span>);
            case PHONE -&gt; maskPhone(<span class="hljs-keyword">data</span>);
            case EMAIL -&gt; maskEmail(<span class="hljs-keyword">data</span>);
            case BANK_CARD -&gt; maskBankCard(<span class="hljs-keyword">data</span>);
            case ADDRESS -&gt; maskAddress(<span class="hljs-keyword">data</span>);
            default -&gt; <span class="hljs-keyword">data</span>; <span class="hljs-comment">// é»˜è®¤ä¸è„±æ•ï¼Œè£¸å¥”ï¼</span>
        };
    }
    
    <span class="hljs-keyword">private</span> String maskChineseName(String name) {
        <span class="hljs-keyword">if</span> (name.length() &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> name;
        <span class="hljs-keyword">if</span> (name.length() == <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> name.charAt(<span class="hljs-number">0</span>) + <span class="hljs-string">"*"</span>;
        <span class="hljs-keyword">return</span> name.charAt(<span class="hljs-number">0</span>) + <span class="hljs-string">"*"</span> + name.charAt(name.length() - <span class="hljs-number">1</span>);
    }
    
    <span class="hljs-keyword">private</span> String maskIdCard(String idCard) {
        <span class="hljs-keyword">if</span> (idCard.length() &lt;= <span class="hljs-number">8</span>) <span class="hljs-keyword">return</span> idCard;
        <span class="hljs-keyword">return</span> idCard.substring(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>) + 
               <span class="hljs-string">"*"</span>.repeat(Math.max(<span class="hljs-number">0</span>, idCard.length() - <span class="hljs-number">7</span>)) + 
               idCard.substring(idCard.length() - <span class="hljs-number">4</span>);
    }
    
    <span class="hljs-keyword">private</span> String maskPhone(String phone) {
        <span class="hljs-keyword">if</span> (phone.length() != <span class="hljs-number">11</span>) <span class="hljs-keyword">return</span> phone;
        <span class="hljs-keyword">return</span> phone.substring(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>) + <span class="hljs-string">"****"</span> + phone.substring(<span class="hljs-number">7</span>);
    }
    
    <span class="hljs-keyword">private</span> String maskEmail(String email) {
        int atIndex = email.indexOf(<span class="hljs-string">"@"</span>);
        <span class="hljs-keyword">if</span> (atIndex &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> email;
        <span class="hljs-keyword">return</span> email.charAt(<span class="hljs-number">0</span>) + <span class="hljs-string">"***"</span> + email.substring(atIndex);
    }
    
    <span class="hljs-keyword">private</span> String maskBankCard(String card) {
        <span class="hljs-keyword">if</span> (card.length() &lt;= <span class="hljs-number">8</span>) <span class="hljs-keyword">return</span> card;
        <span class="hljs-keyword">return</span> card.substring(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>) + <span class="hljs-string">" **** **** "</span> + 
               card.substring(card.length() - <span class="hljs-number">4</span>);
    }
    
    <span class="hljs-keyword">private</span> String maskAddress(String address) {
        <span class="hljs-keyword">if</span> (address.length() &lt;= <span class="hljs-number">4</span>) <span class="hljs-keyword">return</span> address;
        <span class="hljs-keyword">return</span> address.substring(<span class="hljs-number">0</span>, address.length() - <span class="hljs-number">4</span>) + <span class="hljs-string">"****"</span>;
    }
}

<span class="hljs-comment">/**
 * æ³¨è§£åºåˆ—åŒ–å™¨ï¼šæŠŠæ³¨è§£å’Œåºåˆ—åŒ–å™¨ç‰µçº¿æ­æ¡¥
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SensitiveAnnotationIntrospector</span> <span class="hljs-title">extends</span> <span class="hljs-title">JacksonAnnotationIntrospector</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object findSerializer(Annotated am) {
        Sensitive sensitive = am.getAnnotation(Sensitive.<span class="hljs-keyword">class</span>);
        <span class="hljs-keyword">if</span> (sensitive != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> new SensitiveSerializer(sensitive.type());
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.findSerializer(am);
    }
}
</code></pre>
<p><strong>æ­¥éª¤3ï¼šé…ç½®Jacksonï¼Œå‘Šè¯‰å®ƒï¼šâ€œçœ‹è¿™é‡Œï¼Œè¦æ‰“ç ï¼â€</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JacksonConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> ObjectMapper <span class="hljs-title function_">objectMapper</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">mapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();
        mapper.setAnnotationIntrospector(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SensitiveAnnotationIntrospector</span>());
        <span class="hljs-keyword">return</span> mapper;
    }
}
</code></pre>
<p><strong>æ­¥éª¤4ï¼šåœ¨å®ä½“ç±»ä¸Šä½¿ç”¨ï¼Œè´´ä¸Šæ ‡ç­¾å°±è‡ªåŠ¨æ‰“ç </strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * ç”¨æˆ·å®ä½“ï¼šæ•æ„Ÿå­—æ®µéƒ½ç©¿ä¸Šäº†â€œé©¬èµ›å…‹å°å†…è£¤â€
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDTO</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Long</span> id;
    
    <span class="hljs-meta">@Sensitive</span>(<span class="hljs-keyword">type</span> = <span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">CHINESE_NAME</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> username;
    
    <span class="hljs-meta">@Sensitive</span>(<span class="hljs-keyword">type</span> = <span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">PHONE</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> phone;
    
    <span class="hljs-meta">@Sensitive</span>(<span class="hljs-keyword">type</span> = <span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">EMAIL</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> email;
    
    <span class="hljs-meta">@Sensitive</span>(<span class="hljs-keyword">type</span> = <span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">ID_CARD</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> idCard;
    
    <span class="hljs-meta">@Sensitive</span>(<span class="hljs-keyword">type</span> = <span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">BANK_CARD</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> bankCard;
    
    <span class="hljs-meta">@Sensitive</span>(<span class="hljs-keyword">type</span> = <span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">ADDRESS</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> address;
    
    <span class="hljs-comment">// è¿™ä¸ªå­—æ®µæ²¡æ³¨è§£ï¼Œç»§ç»­è£¸å¥”</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> hobby;
}
</code></pre>
<p><strong>æ­¥éª¤5ï¼šæ§åˆ¶å™¨æµ‹è¯•ä¸€ä¸‹æ•ˆæœ</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/user"</span>)
public class UserController {
    
    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/{id}"</span>)
    public UserDTO <span class="hljs-built_in">getUser</span>(<span class="hljs-variable">@PathVariable</span> Long id) {
        <span class="hljs-comment">// æ¨¡æ‹Ÿä»æ•°æ®åº“æŸ¥å‡ºçš„å®Œæ•´æ•°æ®</span>
        <span class="hljs-selector-tag">UserDTO</span> <span class="hljs-selector-tag">user</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">UserDTO</span>();
        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setId</span>(id);
        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setUsername</span>(<span class="hljs-string">"å¼ å…¨è›‹"</span>);
        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setPhone</span>(<span class="hljs-string">"13800138000"</span>);
        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setEmail</span>(<span class="hljs-string">"zhangquandan@example.com"</span>);
        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setIdCard</span>(<span class="hljs-string">"110101199001011234"</span>);
        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setBankCard</span>(<span class="hljs-string">"621700001234567890"</span>);
        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setAddress</span>(<span class="hljs-string">"åŒ—äº¬å¸‚æµ·æ·€åŒºä¸­å…³æ‘å¤§è¡—1å·"</span>);
        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setHobby</span>(<span class="hljs-string">"å”±è·³RAPç¯®çƒ"</span>);
        
        <span class="hljs-comment">// è¿”å›æ—¶è‡ªåŠ¨è„±æ•ï¼Œå°±åƒè‡ªåŠ¨åŠ äº†é©¬èµ›å…‹</span>
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">user</span>;
    }
}
</code></pre>
<p><strong>æµ‹è¯•ç»“æœï¼š</strong></p>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
  <span class="hljs-string">"username"</span>: <span class="hljs-string">"å¼ *è›‹"</span>,
  <span class="hljs-string">"phone"</span>: <span class="hljs-string">"138****8000"</span>,
  <span class="hljs-string">"email"</span>: <span class="hljs-string">"z***@example.com"</span>,
  <span class="hljs-string">"idCard"</span>: <span class="hljs-string">"110**********1234"</span>,
  <span class="hljs-string">"bankCard"</span>: <span class="hljs-string">"6217 **** **** 7890"</span>,
  <span class="hljs-string">"address"</span>: <span class="hljs-string">"åŒ—äº¬å¸‚æµ·æ·€åŒºä¸­å…³æ‘å¤§è¡—****"</span>,
  <span class="hljs-string">"hobby"</span>: <span class="hljs-string">"å”±è·³RAPç¯®çƒ"</span>
}
</code></pre>
<h3 data-id="heading-3">æ–¹æ¡ˆ2ï¼šAOPåˆ‡é¢æ–¹æ¡ˆï¼ˆæ•°æ®å‡ºé—¨å‰çš„å®‰æ£€å‘˜ï¼‰</h3>
<p><strong>æ­¥éª¤1ï¼šå®šä¹‰è„±æ•ç­–ç•¥æ¥å£</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * è„±æ•ç­–ç•¥ï¼šå®šä¹‰å„ç§è„±æ•ç®—æ³•
 * å°±åƒä¸åŒçš„ç¾é¢œæ»¤é•œ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SensitiveStrategy</span> {
    <span class="hljs-title class_">String</span> <span class="hljs-title function_">mask</span>(<span class="hljs-title class_">String</span> data);
}

<span class="hljs-comment">/**
 * ç­–ç•¥å·¥å‚ï¼šæ ¹æ®ç±»å‹é€‰æ‹©åˆé€‚çš„æ»¤é•œ
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SensitiveStrategyFactory</span> {
    
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">SensitiveType</span>, <span class="hljs-title class_">SensitiveStrategy</span>&gt; strategies = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">SensitiveStrategyFactory</span>() {
        <span class="hljs-comment">// æ³¨å†Œå„ç§ç¾é¢œæ»¤é•œ</span>
        strategies.<span class="hljs-title function_">put</span>(<span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">CHINESE_NAME</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChineseNameStrategy</span>());
        strategies.<span class="hljs-title function_">put</span>(<span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">PHONE</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">PhoneStrategy</span>());
        strategies.<span class="hljs-title function_">put</span>(<span class="hljs-title class_">SensitiveType</span>.<span class="hljs-property">ID_CARD</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdCardStrategy</span>());
        <span class="hljs-comment">// ... å…¶ä»–ç­–ç•¥</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">SensitiveStrategy</span> <span class="hljs-title function_">getStrategy</span>(<span class="hljs-params">SensitiveType <span class="hljs-keyword">type</span></span>) {
        <span class="hljs-keyword">return</span> strategies.<span class="hljs-title function_">getOrDefault</span>(<span class="hljs-keyword">type</span>, data -&gt; data);
    }
    
    <span class="hljs-comment">// å…·ä½“ç­–ç•¥å®ç°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChineseNameStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SensitiveStrategy</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">mask</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> data</span>) {
            <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span> || data.<span class="hljs-title function_">length</span>() &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> data;
            <span class="hljs-keyword">if</span> (data.<span class="hljs-title function_">length</span>() == <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>) + <span class="hljs-string">"*"</span>;
            <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>) + <span class="hljs-string">"*"</span> + data.<span class="hljs-title function_">charAt</span>(data.<span class="hljs-title function_">length</span>() - <span class="hljs-number">1</span>);
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PhoneStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SensitiveStrategy</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">mask</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> data</span>) {
            <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span> || data.<span class="hljs-title function_">length</span>() != <span class="hljs-number">11</span>) <span class="hljs-keyword">return</span> data;
            <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>) + <span class="hljs-string">"****"</span> + data.<span class="hljs-title function_">substring</span>(<span class="hljs-number">7</span>);
        }
    }
    
    <span class="hljs-comment">// ... å…¶ä»–ç­–ç•¥å®ç°</span>
}
</code></pre>
<p><strong>æ­¥éª¤2ï¼šAOPåˆ‡é¢å®ç°</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Aspect</span>
<span class="hljs-keyword">@Component</span>
<span class="hljs-keyword">@Slf</span>4j
public class SensitiveAspect {
    
    <span class="hljs-keyword">@Autowired</span>
    private SensitiveStrategyFactory strategyFactory;
    
    <span class="hljs-comment">/**
     * æ‹¦æˆªæ‰€æœ‰Controlleræ–¹æ³•è¿”å›
     * å°±åƒåœ¨æ•°æ®å‡ºé—¨å‰è®¾äº†ä¸ªå®‰æ£€é—¨
     */</span>
    <span class="hljs-keyword">@Around</span>(<span class="hljs-string">"@annotation(org.springframework.web.bind.annotation.GetMapping) || "</span> +
            <span class="hljs-string">"@annotation(org.springframework.web.bind.annotation.PostMapping) || "</span> +
            <span class="hljs-string">"@annotation(org.springframework.web.bind.annotation.RequestMapping)"</span>)
    public Object aroundController(ProceedingJoinPoint joinPoint) throws Throwable {
        <span class="hljs-comment">// æ”¾è¡Œæ–¹æ³•æ‰§è¡Œ</span>
        <span class="hljs-selector-tag">Object</span> result = joinPoint<span class="hljs-selector-class">.proceed</span>();
        
        <span class="hljs-comment">// ç»™è¿”å›ç»“æœç©¿ä¸Šè¡£æœ</span>
        return <span class="hljs-built_in">processSensitiveData</span>(result);
    }
    
    <span class="hljs-comment">/**
     * é€’å½’å¤„ç†è„±æ•ï¼šè¿æ•°æ®å¯¹è±¡çš„å­å­™åä»£éƒ½ä¸æ”¾è¿‡
     */</span>
    private <span class="hljs-selector-tag">Object</span> <span class="hljs-built_in">processSensitiveData</span>(Object obj) {
        if (obj == null) return null;
        
        <span class="hljs-comment">// å¦‚æœæ˜¯é›†åˆï¼Œç»™æ¯ä¸ªå…ƒç´ éƒ½ç©¿ä¸Šè¡£æœ</span>
        if (obj instanceof Collection) {
            return <span class="hljs-built_in">processCollection</span>((Collection&lt;?&gt;) obj);
        }
        
        <span class="hljs-comment">// å¦‚æœæ˜¯æ•°ç»„ï¼Œä¹Ÿä¸æ”¾è¿‡</span>
        if (obj.getClass()<span class="hljs-selector-class">.isArray</span>()) {
            return <span class="hljs-built_in">processArray</span>((Object[]) obj);
        }
        
        <span class="hljs-comment">// å¦‚æœæ˜¯Mapï¼Œå¤„ç†æ¯ä¸ªå€¼</span>
        if (obj instanceof Map) {
            return <span class="hljs-built_in">processMap</span>((Map&lt;?, ?&gt;) obj);
        }
        
        <span class="hljs-comment">// å¦‚æœæ˜¯æ™®é€šå¯¹è±¡ï¼Œæ·±åº¦æ‰«ææ•æ„Ÿå­—æ®µ</span>
        if (isCustomClass(obj.getClass())) {
            return <span class="hljs-built_in">processObject</span>(obj);
        }
        
        <span class="hljs-comment">// åŸºæœ¬ç±»å‹ï¼Œç›´æ¥è¿”å›</span>
        return obj;
    }
    
    private <span class="hljs-selector-tag">Object</span> <span class="hljs-built_in">processObject</span>(Object obj) {
        Class&lt;?&gt; clazz = obj<span class="hljs-selector-class">.getClass</span>();
        <span class="hljs-selector-tag">Object</span> newObj;
        try {
            newObj = clazz<span class="hljs-selector-class">.newInstance</span>();
        } catch (Exception e) {
            log<span class="hljs-selector-class">.warn</span>("åˆ›å»ºå¯¹è±¡å®ä¾‹å¤±è´¥: {}", clazz.getName());
            return obj;
        }
        
        <span class="hljs-comment">// åå°„è·å–æ‰€æœ‰å­—æ®µ</span>
        Field<span class="hljs-selector-attr">[]</span> fields = clazz<span class="hljs-selector-class">.getDeclaredFields</span>();
        for (Field field : fields) {
            field<span class="hljs-selector-class">.setAccessible</span>(true);
            try {
                <span class="hljs-selector-tag">Object</span> value = field<span class="hljs-selector-class">.get</span>(obj);
                
                <span class="hljs-comment">// å¦‚æœæœ‰è„±æ•æ³¨è§£ï¼Œç©¿ä¸Šé©¬èµ›å…‹</span>
                Sensitive sensitive = field<span class="hljs-selector-class">.getAnnotation</span>(Sensitive.class);
                if (sensitive != null &amp;&amp; value instanceof String) {
                    SensitiveStrategy strategy = strategyFactory<span class="hljs-selector-class">.getStrategy</span>(sensitive.type());
                    value = strategy<span class="hljs-selector-class">.mask</span>((String) value);
                } else if (value != null) {
                    <span class="hljs-comment">// é€’å½’å¤„ç†åµŒå¥—å¯¹è±¡</span>
                    value = <span class="hljs-built_in">processSensitiveData</span>(value);
                }
                
                field<span class="hljs-selector-class">.set</span>(newObj, value);
            } catch (Exception e) {
                log<span class="hljs-selector-class">.warn</span>("å¤„ç†å­—æ®µ {} å¤±è´¥", field.getName(), e);
            }
        }
        
        return newObj;
    }
}
</code></pre>
<h3 data-id="heading-4">æ–¹æ¡ˆ3ï¼šMyBatisæ‹¦æˆªå™¨æ–¹æ¡ˆï¼ˆæ•°æ®åº“æŸ¥è¯¢æ—¶çš„ç¾é¢œç›¸æœºï¼‰</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * MyBatisæ‹¦æˆªå™¨ï¼šåœ¨æ•°æ®ä»æ•°æ®åº“å‡ºæ¥æ—¶å®æ—¶ç¾é¢œ
 */</span>
<span class="hljs-meta">@Intercepts</span>({
    <span class="hljs-meta">@Signature</span>(<span class="hljs-keyword">type</span> = <span class="hljs-title class_">ResultSetHandler</span>.<span class="hljs-property">class</span>, 
               method = <span class="hljs-string">"handleResultSets"</span>, 
               args = {<span class="hljs-title class_">Statement</span>.<span class="hljs-property">class</span>})
})
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SensitiveInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Interceptor</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">SensitiveStrategyFactory</span> strategyFactory;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">intercept</span>(<span class="hljs-title class_">Invocation</span> invocation) throws <span class="hljs-title class_">Throwable</span> {
        <span class="hljs-comment">// å…ˆæ‰§è¡ŒåŸæ–¹æ³•è·å–ç»“æœ</span>
        <span class="hljs-title class_">Object</span> result = invocation.<span class="hljs-title function_">proceed</span>();
        
        <span class="hljs-keyword">if</span> (result == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        <span class="hljs-comment">// å¤„ç†ç»“æœé›†</span>
        <span class="hljs-keyword">if</span> (result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">List</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Object</span> obj : (<span class="hljs-title class_">List</span>&lt;?&gt;) result) {
                <span class="hljs-title function_">processObject</span>(obj);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_">processObject</span>(result);
        }
        
        <span class="hljs-keyword">return</span> result;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">processObject</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span> obj</span>) {
        <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-title class_">Class</span>&lt;?&gt; clazz = obj.<span class="hljs-title function_">getClass</span>();
        <span class="hljs-title class_">Field</span>[] fields = clazz.<span class="hljs-title function_">getDeclaredFields</span>();
        
        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : fields) {
            <span class="hljs-title class_">Sensitive</span> sensitive = field.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">Sensitive</span>.<span class="hljs-property">class</span>);
            <span class="hljs-keyword">if</span> (sensitive != <span class="hljs-literal">null</span>) {
                field.<span class="hljs-title function_">setAccessible</span>(<span class="hljs-literal">true</span>);
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-title class_">Object</span> value = field.<span class="hljs-title function_">get</span>(obj);
                    <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">String</span>) {
                        <span class="hljs-title class_">SensitiveStrategy</span> strategy = strategyFactory.<span class="hljs-title function_">getStrategy</span>(sensitive.<span class="hljs-title function_">type</span>());
                        <span class="hljs-title class_">String</span> maskedValue = strategy.<span class="hljs-title function_">mask</span>((<span class="hljs-title class_">String</span>) value);
                        field.<span class="hljs-title function_">set</span>(obj, maskedValue);
                    }
                } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
                    log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è„±æ•å¤„ç†å¤±è´¥"</span>, e);
                }
            }
        }
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">plugin</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span> target</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Plugin</span>.<span class="hljs-title function_">wrap</span>(target, <span class="hljs-variable language_">this</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setProperties</span>(<span class="hljs-params">Properties properties</span>) {
        <span class="hljs-comment">// å¯ä»¥é…ç½®ä¸€äº›å±æ€§</span>
    }
}
</code></pre>
<h3 data-id="heading-5">æ–¹æ¡ˆ4ï¼šè‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨æ–¹æ¡ˆï¼ˆHTTPå‡ºå£å¤„çš„å®‰æ£€æœºï¼‰</h3>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-comment">/**
 * è‡ªå®šä¹‰HTTPæ¶ˆæ¯è½¬æ¢å™¨ï¼šåœ¨æ•°æ®ç¦»å¼€ç³»ç»Ÿå‰æœ€åä¸€é“å®‰æ£€
 */</span>
<span class="hljs-meta">@Component</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SensitiveHttpMessageConverter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MappingJackson2HttpMessageConverter</span> </span>{
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">SensitiveStrategyFactory</span> strategyFactory;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> void writeInternal(<span class="hljs-type">Object</span> <span class="hljs-class"><span class="hljs-keyword">object</span>, <span class="hljs-title">Type</span> <span class="hljs-title">type</span>, </span>
                                 <span class="hljs-type">HttpOutputMessage</span> outputMessage) <span class="hljs-keyword">throws</span> <span class="hljs-type">IOException</span> {
        <span class="hljs-comment">// å…ˆè„±æ•å†åºåˆ—åŒ–</span>
        <span class="hljs-type">Object</span> processedObject = processSensitiveData(<span class="hljs-class"><span class="hljs-keyword">object</span>)</span>;
        <span class="hljs-keyword">super</span>.writeInternal(processedObject, <span class="hljs-class"><span class="hljs-keyword">type</span>, <span class="hljs-title">outputMessage</span>)</span>;
    }
    
    <span class="hljs-comment">// è„±æ•å¤„ç†æ–¹æ³•ï¼ˆåŒä¸Šï¼Œçœç•¥é‡å¤ä»£ç ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">Object</span> processSensitiveData(<span class="hljs-type">Object</span> obj) {
        <span class="hljs-comment">// å®ç°åŒAOPæ–¹æ¡ˆä¸­çš„processSensitiveDataæ–¹æ³•</span>
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<h3 data-id="heading-6">æ–¹æ¡ˆ5ï¼šæ•°æ®åº“å±‚è„±æ•æ–¹æ¡ˆï¼ˆç»™æ•°æ®åº“æˆ´ä¸Šå£ç½©ï¼‰</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * Hibernateäº‹ä»¶ç›‘å¬å™¨ï¼šæ•°æ®å…¥åº“æ—¶è‡ªåŠ¨åŠ å¯†ï¼Œå‡ºåº“æ—¶è‡ªåŠ¨è§£å¯†
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SensitiveEventListener</span> <span class="hljs-keyword">implements</span> 
        <span class="hljs-title class_">PostLoadEventListener</span>, <span class="hljs-title class_">PreInsertEventListener</span>, <span class="hljs-title class_">PreUpdateEventListener</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">EncryptionService</span> encryptionService;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onPostLoad</span>(<span class="hljs-params">PostLoadEvent event</span>) {
        <span class="hljs-title class_">Object</span> entity = event.<span class="hljs-title function_">getEntity</span>();
        <span class="hljs-comment">// åŠ è½½åè§£å¯†</span>
        <span class="hljs-title function_">decryptEntity</span>(entity);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onPreInsert</span>(<span class="hljs-params">PreInsertEvent event</span>) {
        <span class="hljs-comment">// æ’å…¥å‰åŠ å¯†</span>
        <span class="hljs-title function_">encryptEntity</span>(event.<span class="hljs-title function_">getEntity</span>());
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onPreUpdate</span>(<span class="hljs-params">PreUpdateEvent event</span>) {
        <span class="hljs-comment">// æ›´æ–°å‰åŠ å¯†</span>
        <span class="hljs-title function_">encryptEntity</span>(event.<span class="hljs-title function_">getEntity</span>());
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">encryptEntity</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span> entity</span>) {
        <span class="hljs-keyword">if</span> (entity == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-title class_">Field</span>[] fields = entity.<span class="hljs-title function_">getClass</span>().<span class="hljs-title function_">getDeclaredFields</span>();
        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : fields) {
            <span class="hljs-keyword">if</span> (field.<span class="hljs-title function_">isAnnotationPresent</span>(<span class="hljs-title class_">SensitiveEncrypt</span>.<span class="hljs-property">class</span>)) {
                field.<span class="hljs-title function_">setAccessible</span>(<span class="hljs-literal">true</span>);
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-title class_">Object</span> value = field.<span class="hljs-title function_">get</span>(entity);
                    <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">String</span>) {
                        <span class="hljs-title class_">String</span> encrypted = encryptionService.<span class="hljs-title function_">encrypt</span>((<span class="hljs-title class_">String</span>) value);
                        field.<span class="hljs-title function_">set</span>(entity, encrypted);
                    }
                } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
                    log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"åŠ å¯†å­—æ®µå¤±è´¥"</span>, e);
                }
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">decryptEntity</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span> entity</span>) {
        <span class="hljs-comment">// ç±»ä¼¼encryptEntityï¼Œè°ƒç”¨encryptionService.decrypt</span>
    }
}
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€è„±æ•æ–¹æ¡ˆé€‰æ‹©æŒ‡å—ï¼šå¯¹ç—‡ä¸‹è¯</h2>
<h3 data-id="heading-8">1. <strong>æ³¨è§£+åºåˆ—åŒ–æ–¹æ¡ˆ</strong></h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šREST APIè¿”å›æ•°æ®è„±æ•
<strong>ä¼˜ç‚¹</strong>ï¼šç®€å•ä¼˜é›…ï¼Œä¸ä¸šåŠ¡è§£è€¦
<strong>ç¼ºç‚¹</strong>ï¼šåªå¯¹JSONåºåˆ—åŒ–æœ‰æ•ˆ</p>
<h3 data-id="heading-9">2. <strong>AOPåˆ‡é¢æ–¹æ¡ˆ</strong></h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šéœ€è¦å¯¹Controllerå±‚ç»Ÿä¸€å¤„ç†
<strong>ä¼˜ç‚¹</strong>ï¼šé›†ä¸­ç®¡ç†ï¼Œæ”¯æŒå¤æ‚é€»è¾‘
<strong>ç¼ºç‚¹</strong>ï¼šæ€§èƒ½å¼€é”€ï¼Œå¯èƒ½è¯¯ä¼¤</p>
<h3 data-id="heading-10">3. <strong>MyBatisæ‹¦æˆªå™¨æ–¹æ¡ˆ</strong></h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ•°æ®åº“æŸ¥è¯¢ç»“æœè„±æ•
<strong>ä¼˜ç‚¹</strong>ï¼šä»æºå¤´æ§åˆ¶ï¼Œä¸€åŠ³æ°¸é€¸
<strong>ç¼ºç‚¹</strong>ï¼šå½±å“æ‰€æœ‰æŸ¥è¯¢ï¼Œä¸å¤Ÿçµæ´»</p>
<h3 data-id="heading-11">4. <strong>è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨æ–¹æ¡ˆ</strong></h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå…¨å±€HTTPå“åº”å¤„ç†
<strong>ä¼˜ç‚¹</strong>ï¼šæœ€å½»åº•çš„å‡ºå£æ§åˆ¶
<strong>ç¼ºç‚¹</strong>ï¼šå¯èƒ½ä¸å…¶ä»–ç»„ä»¶å†²çª</p>
<h3 data-id="heading-12">5. <strong>æ•°æ®åº“å±‚æ–¹æ¡ˆ</strong></h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå­˜å‚¨åŠ å¯†ï¼Œå±•ç¤ºè„±æ•
<strong>ä¼˜ç‚¹</strong>ï¼šæœ€å®‰å…¨ï¼Œé˜²æ­¢æ•°æ®æ³„éœ²
<strong>ç¼ºç‚¹</strong>ï¼šå½±å“æŸ¥è¯¢æ€§èƒ½ï¼Œå®ç°å¤æ‚</p>
<h2 data-id="heading-13">å››ã€æœ€ä½³å®è·µå»ºè®®</h2>
<h3 data-id="heading-14">1. <strong>åˆ†å±‚é˜²å¾¡</strong>ï¼šä¸è¦æŠŠæ‰€æœ‰é¸¡è›‹æ”¾åœ¨ä¸€ä¸ªç¯®å­é‡Œ</h3>
<pre><code class="hljs language-markdown" lang="markdown">æ•°æ®å®‰å…¨é˜²æŠ¤ä½“ç³»ï¼š
<span class="hljs-bullet">  -</span> å­˜å‚¨å±‚ï¼šåŠ å¯†å­˜å‚¨ï¼ˆæœ€åçš„åº•çº¿ï¼‰
<span class="hljs-bullet">  -</span> ä¸šåŠ¡å±‚ï¼šé€»è¾‘è„±æ•ï¼ˆçµæ´»æ§åˆ¶ï¼‰
<span class="hljs-bullet">  -</span> å±•ç¤ºå±‚ï¼šå±•ç¤ºè„±æ•ï¼ˆç”¨æˆ·ä½“éªŒï¼‰
</code></pre>
<h3 data-id="heading-15">2. <strong>é…ç½®åŒ–è„±æ•</strong>ï¼šåƒè°ƒç¾é¢œå¼ºåº¦ä¸€æ ·å¯é…ç½®</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Component</span>
<span class="hljs-variable">@ConfigurationProperties</span>(prefix = <span class="hljs-string">"sensitive"</span>)
<span class="hljs-variable">@Data</span>
public class SensitiveProperties {
    <span class="hljs-comment">/**
     * æ˜¯å¦å¼€å¯è„±æ•
     */</span>
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">enabled</span> = <span class="hljs-selector-tag">true</span>;
    
    <span class="hljs-comment">/**
     * è„±æ•è§„åˆ™é…ç½®
     */</span>
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">SensitiveType</span>, <span class="hljs-selector-tag">Rule</span>&gt; <span class="hljs-selector-tag">rules</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">HashMap</span>&lt;&gt;();
    
    @<span class="hljs-selector-tag">Data</span>
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">Rule</span> {
        <span class="hljs-comment">/**
         * ä¿ç•™å‰å‡ ä½
         */</span>
        <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">Integer</span> <span class="hljs-selector-tag">keepPrefix</span> = <span class="hljs-number">3</span>;
        
        <span class="hljs-comment">/**
         * ä¿ç•™åå‡ ä½
         */</span>
        <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">Integer</span> <span class="hljs-selector-tag">keepSuffix</span> = <span class="hljs-number">4</span>;
        
        <span class="hljs-comment">/**
         * æ›¿æ¢å­—ç¬¦
         */</span>
        <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">Character</span> <span class="hljs-selector-tag">maskChar</span> = '*';
    }
}
</code></pre>
<h3 data-id="heading-16">3. <strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šè„±æ•ä¹Ÿè¦æ³¨æ„æ•ˆç‡</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SensitiveCache</span> {
    
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">Cache</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">String</span>&gt; cache = 
        <span class="hljs-title class_">Caffeine</span>.<span class="hljs-title function_">newBuilder</span>()
            .<span class="hljs-title function_">maximumSize</span>(<span class="hljs-number">10000</span>)
            .<span class="hljs-title function_">expireAfterWrite</span>(<span class="hljs-number">5</span>, <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)
            .<span class="hljs-title function_">build</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">maskWithCache</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> data, SensitiveType <span class="hljs-keyword">type</span>, 
                               SensitiveStrategy strategy</span>) {
        <span class="hljs-title class_">String</span> key = <span class="hljs-keyword">type</span>.<span class="hljs-title function_">name</span>() + <span class="hljs-string">":"</span> + data;
        <span class="hljs-keyword">return</span> cache.<span class="hljs-title function_">get</span>(key, k -&gt; strategy.<span class="hljs-title function_">mask</span>(data));
    }
}
</code></pre>
<h3 data-id="heading-17">4. <strong>ç›‘æ§ä¸æ—¥å¿—</strong>ï¼šçŸ¥é“è°åœ¨ä»€ä¹ˆæ—¶å€™è„±æ•</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Aspect</span>
<span class="hljs-variable">@Component</span>
<span class="hljs-variable">@Slf4j</span>
public class SensitiveMonitorAspect {
    
    <span class="hljs-variable">@Around</span>(<span class="hljs-string">"@annotation(org.springframework.web.bind.annotation.RequestMapping)"</span>)
    public Object <span class="hljs-built_in">monitorSensitive</span>(ProceedingJoinPoint joinPoint) throws Throwable {
        <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">start</span> = <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.currentTimeMillis</span>();
        <span class="hljs-selector-tag">Object</span> <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-tag">joinPoint</span><span class="hljs-selector-class">.proceed</span>();
        <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">cost</span> = <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.currentTimeMillis</span>() <span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">start</span>;
        
        <span class="hljs-comment">// è®°å½•è„±æ•ç»Ÿè®¡</span>
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"è„±æ•å¤„ç†å®Œæˆï¼Œæ–¹æ³•ï¼š{}ï¼Œè€—æ—¶ï¼š{}ms"</span>, 
                 joinPoint.<span class="hljs-built_in">getSignature</span>(), cost);
        
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">result</span>;
    }
}
</code></pre>
<h2 data-id="heading-18">äº”ã€æ€»ç»“ï¼šæ•°æ®è„±æ•çš„æ™ºæ…§</h2>
<p>æ•°æ®è„±æ•å°±åƒç»™æ•æ„Ÿæ•°æ®ç©¿ä¸Šå¾—ä½“çš„è¡£æœâ€”â€”æ—¢ä¸èƒ½è£¸å¥”ï¼ˆå®‰å…¨é£é™©ï¼‰ï¼Œä¹Ÿä¸èƒ½è£¹æˆæœ¨ä¹ƒä¼Šï¼ˆå½±å“ä½¿ç”¨ï¼‰ã€‚é€šè¿‡SpringBootçš„å„ç§æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ol>
<li><strong>å› åœ°åˆ¶å®œ</strong>ï¼šæ ¹æ®ä¸åŒçš„åœºæ™¯é€‰æ‹©åˆé€‚çš„è„±æ•æ–¹æ¡ˆ</li>
<li><strong>å±‚å±‚è®¾é˜²</strong>ï¼šæ„å»ºå¤šå±‚æ¬¡çš„æ•°æ®å®‰å…¨é˜²æŠ¤ä½“ç³»</li>
<li><strong>çµæ´»é…ç½®</strong>ï¼šåƒè°ƒèŠ‚ç¾é¢œç›¸æœºä¸€æ ·è½»æ¾è°ƒæ•´è„±æ•ç­–ç•¥</li>
<li><strong>æ€§èƒ½å¹³è¡¡</strong>ï¼šåœ¨å®‰å…¨å’Œæ€§èƒ½ä¹‹é—´æ‰¾åˆ°æœ€ä½³å¹³è¡¡ç‚¹</li>
</ol>
<p>æ²¡æœ‰ä¸€ç§æ–¹æ¡ˆæ˜¯ä¸‡èƒ½çš„ã€‚å°±åƒç©¿è¡£æœè¦åˆ†åœºåˆï¼ˆæ³³æ± ç©¿æ³³è¡£ï¼Œä¼šè®®å®¤ç©¿æ­£è£…ï¼‰ï¼Œæ•°æ®è„±æ•ä¹Ÿè¦æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©æœ€åˆé€‚çš„æ–¹æ¡ˆã€‚</p>
<p>æœ€ç»ˆç›®æ ‡ï¼š<strong>è®©æ•æ„Ÿæ•°æ®æ—¢èƒ½ä¿å®ˆç§˜å¯†ï¼Œåˆèƒ½å±¥è¡ŒèŒè´£</strong>ã€‚æ¯•ç«Ÿï¼Œæ•°æ®çš„ä»·å€¼åœ¨äºä½¿ç”¨ï¼Œè€Œä¸æ˜¯é”åœ¨ä¿é™©æŸœé‡Œåƒç°ã€‚è„±æ•å°±æ˜¯è®©æ•°æ®åœ¨"å®‰å…¨"å’Œ"å¯ç”¨"ä¹‹é—´ä¼˜é›…åœ°èµ°é’¢ä¸ï¼</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æœ€åé€å¤§å®¶ä¸€ä¸ªä¸‡èƒ½è„±æ•æ–¹æ³•</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">universalMask</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> data</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"****"</span>; <span class="hljs-comment">// ç®€å•ç²—æš´ï¼Œä½†æœ€å®‰å…¨ï¼ï¼ˆå¼€ç©ç¬‘çš„ï¼Œåˆ«çœŸç”¨ï¼‰</span>
}
</code></pre>
<p>è¿‡å¤šçš„è„±æ•ä¼šå½±å“ä¸šåŠ¡ï¼Œè¿‡å°‘çš„è„±æ•åˆå­˜åœ¨é£é™©ã€‚æ‰¾åˆ°é‚£ä¸ªåˆšåˆšå¥½çš„å¹³è¡¡ç‚¹ï¼Œæ‰æ˜¯æ•°æ®è„±æ•çš„æœ€é«˜å¢ƒç•Œï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11c865bdf82946d998edac4b00340c17~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf56m656CB5a2X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766630965&amp;x-signature=1Qmou7WyENidmV03f2Che6TRp6A%3D" alt="SpringBootåŠ¨æ€è„±æ•å®æˆ˜ï¼šä»æ³¨è§£åˆ°AOPçš„ä¼˜é›…æ‰“ç æœ¯.png" loading="lazy"/></p>
<p><strong>è°¢è°¢ä½ çœ‹æˆ‘çš„æ–‡ç« ï¼Œæ—¢ç„¶çœ‹åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœè§‰å¾—ä¸é”™ï¼Œéšæ‰‹ç‚¹ä¸ªèµã€è½¬å‘ã€åœ¨çœ‹ä¸‰è¿å§ï¼Œæ„Ÿè°¢æ„Ÿè°¢ã€‚é‚£æˆ‘ä»¬ï¼Œä¸‹æ¬¡å†è§ã€‚</strong></p>
<p>æ‚¨çš„ä¸€é”®ä¸‰è¿ï¼Œæ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ï¼Œè°¢è°¢</p>
<p>å±±æ°´æœ‰ç›¸é€¢ï¼Œæ¥æ—¥çš†å¯æœŸï¼Œè°¢è°¢é˜…è¯»ï¼Œæˆ‘ä»¬å†ä¼š</p>
<p>æˆ‘æ‰‹ä¸­çš„é‡‘ç®æ£’ï¼Œä¸Šèƒ½é€šå¤©ï¼Œä¸‹èƒ½æ¢æµ·</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[FastAdminæ¡†æ¶SSEå®æ—¶æ¶ˆæ¯æ¨é€å®ç°æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7584719268043948066</link>    <guid>https://juejin.cn/post/7584719268043948066</guid>    <pubDate>2025-12-18T02:57:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584719268043948066" data-draft-id="7584711683773612032" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="FastAdminæ¡†æ¶SSEå®æ—¶æ¶ˆæ¯æ¨é€å®ç°æ•™ç¨‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-18T02:57:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…”ä¸"/> <meta itemprop="url" content="https://juejin.cn/user/2385268740724025"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            FastAdminæ¡†æ¶SSEå®æ—¶æ¶ˆæ¯æ¨é€å®ç°æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2385268740724025/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…”ä¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T02:57:06.000Z" title="Thu Dec 18 2025 02:57:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">FastAdminæ¡†æ¶SSEå®æ—¶æ¶ˆæ¯æ¨é€å®ç°æ•™ç¨‹</h2>
<h2 data-id="heading-1">ä¸€ã€å‰è¨€ï¼šä»€ä¹ˆæ˜¯SSEï¼Ÿ</h2>
<p>SSEï¼ˆServer-Sent Eventsï¼ŒæœåŠ¡å™¨å‘é€äº‹ä»¶ï¼‰æ˜¯ä¸€ç§åŸºäºHTTPçš„æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å•å‘æ¨é€å®æ—¶æ•°æ®çš„æŠ€æœ¯ï¼Œä¸WebSocketçš„åŒå‘é€šä¿¡ä¸åŒï¼ŒSSEæ›´é€‚ç”¨äº<strong>æœåŠ¡å™¨å‘å®¢æˆ·ç«¯ä¸»åŠ¨æ¨é€ã€å®¢æˆ·ç«¯ä»…æ¥æ”¶</strong>çš„åœºæ™¯ï¼ˆå¦‚å®æ—¶é€šçŸ¥ã€æ¶ˆæ¯æé†’ã€æ•°æ®ç›‘æ§ç­‰ï¼‰ã€‚</p>
<p>æœ¬æ•™ç¨‹åŸºäºFastAdminï¼ˆTP5.1å†…æ ¸ï¼‰å®ç°SSEæ¨é€ï¼ŒåŒ…å«å®Œæ•´çš„åç«¯æ¥å£ã€å‰ç«¯é¡µé¢åŠäº¤äº’é€»è¾‘ï¼Œå¯ç›´æ¥å¤ç”¨å¹¶æ ¹æ®ä¸šåŠ¡æ‰©å±•ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30dc53c6164b4ce0af4360bfd263496c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWU5Lid:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631426&amp;x-signature=Xv9EUAbLNvnX6%2BEMmaoV5hgGfVQ%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">äºŒã€æ ¸å¿ƒå®ç°é€»è¾‘æ€»è§ˆ</h2>
<p>SSEå®ç°éœ€æ»¡è¶³ä¸¤ä¸ªæ ¸å¿ƒæ¡ä»¶ï¼šåç«¯æŒ‰SSEæ ‡å‡†æ ¼å¼è¾“å‡ºæ•°æ®å¹¶ç»´æŒé•¿è¿æ¥ï¼›å‰ç«¯é€šè¿‡<code>EventSource</code>å¯¹è±¡ç›‘å¬æœåŠ¡å™¨æ¨é€äº‹ä»¶ã€‚æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>åç«¯ï¼šåˆ›å»ºSSEæ¥å£ï¼Œé…ç½®é•¿è¿æ¥å“åº”å¤´ã€ç¦ç”¨ç¼“å­˜ï¼Œå¾ªç¯æ¨é€æ ¼å¼åŒ–æ•°æ®ï¼›</p>
</li>
<li>
<p>å‰ç«¯ï¼šè®¾è®¡æ¶ˆæ¯å±•ç¤ºä¸æ§åˆ¶ç•Œé¢ï¼ˆå¼€å¯/åœæ­¢æŒ‰é’®ï¼‰ï¼›</p>
</li>
<li>
<p>JSï¼šé€šè¿‡<code>EventSource</code>å»ºç«‹è¿æ¥ï¼Œç›‘å¬æœåŠ¡å™¨äº‹ä»¶ï¼Œå¤„ç†æ¶ˆæ¯æ¸²æŸ“ä¸è¿æ¥çŠ¶æ€ç®¡ç†ã€‚</p>
</li>
</ol>
<h2 data-id="heading-3">ä¸‰ã€åç«¯å®ç°ï¼šæ§åˆ¶å™¨SSEæ¥å£å¼€å‘</h2>
<p>åœ¨FastAdminçš„å‰ç«¯æ§åˆ¶å™¨ï¼ˆå¦‚<code>application/index/controller/Index.php</code>ï¼‰ä¸­æ·»åŠ SSEæ ¸å¿ƒæ–¹æ³•ä¸æµ‹è¯•é¡µé¢æ–¹æ³•ï¼Œä»£ç åˆ†æ­¥éª¤æ‹†è§£å¦‚ä¸‹ã€‚</p>
<h3 data-id="heading-4">3.1 å®Œæ•´æ§åˆ¶å™¨ä»£ç </h3>
<pre><code class="hljs language-php" lang="php">
<span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">index</span>\<span class="hljs-title class_">controller</span>; 
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">common</span>\<span class="hljs-title">controller</span>\<span class="hljs-title">Frontend</span>; 

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Frontend</span>
</span>{
    <span class="hljs-comment">/**
     * å‰å° SSE æ¶ˆæ¯æ¨é€æ¥å£
     * æ”¯æŒåŒ¿åè®¿é—®ï¼ˆä¹Ÿå¯æ ¹æ®ä¸šåŠ¡è¦æ±‚å¼ºåˆ¶ç™»å½•ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sse</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-comment">// 1. æ¸…ç†å¹¶ç¦ç”¨è¾“å‡ºç¼“å­˜ï¼Œç¡®ä¿æ¶ˆæ¯å®æ—¶æ€§</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ob_get_level</span>() &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-title function_ invoke__">ob_end_clean</span>();
        }
        <span class="hljs-comment">// å…³é—­PHPæ‰§è¡Œè¶…æ—¶ï¼Œç»´æŒé•¿è¿æ¥</span>
        <span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);

        <span class="hljs-comment">// 2. è®¾ç½®SSEæ ¸å¿ƒå“åº”å¤´ï¼ˆFastAdmin/TP5.1é€šç”¨ï¼‰</span>
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Content-Type: text/event-stream'</span>);       <span class="hljs-comment">// SSEä¸“å±MIMEç±»å‹</span>
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Cache-Control: no-cache'</span>);               <span class="hljs-comment">// ç¦æ­¢ç¼“å­˜</span>
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Connection: keep-alive'</span>);                <span class="hljs-comment">// ä¿æŒé•¿è¿æ¥</span>
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'X-Accel-Buffering: no'</span>);                 <span class="hljs-comment">// ç¦ç”¨Nginxç¼“å†²ï¼ˆç”Ÿäº§å¿…åŠ ï¼‰</span>
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Access-Control-Allow-Origin: *'</span>);        <span class="hljs-comment">// è·¨åŸŸæ”¯æŒï¼ˆç”Ÿäº§æ›¿æ¢ä¸ºå…·ä½“åŸŸåï¼‰</span>
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Access-Control-Allow-Methods: GET'</span>);
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Access-Control-Allow-Headers: Content-Type'</span>);

        <span class="hljs-comment">// 3. å‘é€åˆå§‹åŒ–äº‹ä»¶ï¼ˆå‘ŠçŸ¥å®¢æˆ·ç«¯è¿æ¥æˆåŠŸï¼‰</span>
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"event: sse_init\ndata: "</span> . <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">'status'</span> =&gt; <span class="hljs-string">'success'</span>, <span class="hljs-string">'msg'</span> =&gt; <span class="hljs-string">'è¿æ¥æˆåŠŸ'</span>], JSON_UNESCAPED_UNICODE) . <span class="hljs-string">"\n\n"</span>;
        <span class="hljs-title function_ invoke__">flush</span>();

        <span class="hljs-comment">// 4. å¾ªç¯æ¨é€æ¶ˆæ¯ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰</span>
        <span class="hljs-variable">$count</span> = <span class="hljs-number">0</span>;
        <span class="hljs-variable">$maxCount</span> = <span class="hljs-number">50</span>; <span class="hljs-comment">// æœ€å¤§æ¨é€æ¬¡æ•°ï¼Œé¿å…æ— é™å¾ªç¯</span>
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-comment">// æ£€æµ‹å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æˆ–è¾¾åˆ°æœ€å¤§æ¬¡æ•°ï¼Œç»ˆæ­¢å¾ªç¯</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">connection_aborted</span>() || <span class="hljs-variable">$count</span> &gt;= <span class="hljs-variable">$maxCount</span>) {
                <span class="hljs-keyword">break</span>;
            }

            <span class="hljs-comment">// æ¨¡æ‹Ÿä¸šåŠ¡æ•°æ®ï¼ˆå¯æ›¿æ¢ä¸ºæ•°æ®åº“/Redis/MQæŸ¥è¯¢ï¼‰</span>
            <span class="hljs-variable">$data</span> = [
                <span class="hljs-string">'id'</span>        =&gt; <span class="hljs-variable">$count</span> + <span class="hljs-number">1</span>,
                <span class="hljs-string">'title'</span>     =&gt; <span class="hljs-string">'FastAdminå®æ—¶é€šçŸ¥'</span>,
                <span class="hljs-string">'content'</span>   =&gt; <span class="hljs-string">'æ–°æ¶ˆæ¯ï¼š'</span> . <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">'Y-m-d H:i:s'</span>),
                <span class="hljs-string">'time'</span>      =&gt; <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">'H:i:s'</span>),
                <span class="hljs-string">'url'</span>       =&gt; <span class="hljs-string">'/index/sse/detail'</span>
            ];

            <span class="hljs-comment">// æŒ‰SSEæ ‡å‡†æ ¼å¼è¾“å‡ºï¼ˆeventæŒ‡å®šäº‹ä»¶åï¼Œdataä¸ºæ¶ˆæ¯ä½“ï¼‰</span>
            <span class="hljs-keyword">echo</span> <span class="hljs-string">"event: my_event\ndata: "</span> . <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$data</span>, JSON_UNESCAPED_UNICODE) . <span class="hljs-string">"\n\n"</span>;
            <span class="hljs-comment">// å¼ºåˆ¶åˆ·æ–°ç¼“å†²åŒºï¼Œç¡®ä¿æ¶ˆæ¯ç«‹å³æ¨é€</span>
            <span class="hljs-title function_ invoke__">flush</span>();

            <span class="hljs-comment">// æ§åˆ¶æ¨é€é¢‘ç‡ï¼ˆæ¯2ç§’1æ¡ï¼Œå¯æ ¹æ®ä¸šåŠ¡è°ƒæ•´ï¼‰</span>
            <span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-number">2</span>);
            <span class="hljs-variable">$count</span>++;
        }

        <span class="hljs-comment">// 5. æ¸…ç†èµ„æº</span>
        <span class="hljs-title function_ invoke__">ob_clean</span>();
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">/**
     * SSEæµ‹è¯•é¡µé¢æ¸²æŸ“æ–¹æ³•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;view-&gt;<span class="hljs-title function_ invoke__">fetch</span>();
    }
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8f88f2cd99c41acbed2de42483b3c1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWU5Lid:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631426&amp;x-signature=z1w%2Fsqa%2FVjPSJ%2BqGvNRNLXdLQT0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">3.2 ä»£ç åˆ†æ­¥æ‹†è§£è¯´æ˜</h3>
<h4 data-id="heading-6">æ­¥éª¤1ï¼šç¼“å­˜ä¸è¶…æ—¶é…ç½®ï¼ˆç¡®ä¿å®æ—¶æ€§ï¼‰</h4>
<pre><code class="hljs language-php" lang="php">
<span class="hljs-comment">// æ¸…ç†å·²å­˜åœ¨çš„è¾“å‡ºç¼“å­˜</span>
<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ob_get_level</span>() &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-title function_ invoke__">ob_end_clean</span>();
}
<span class="hljs-comment">// å…³é—­PHPæ‰§è¡Œè¶…æ—¶ï¼ˆSSEéœ€é•¿è¿æ¥ï¼Œé»˜è®¤è¶…æ—¶ä¼šæ–­å¼€ï¼‰</span>
<span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);
</code></pre>
<p>å…³é”®è¯´æ˜ï¼šFastAdminé»˜è®¤å¯èƒ½å¼€å¯è¾“å‡ºç¼“å†²ï¼Œéœ€æ¸…ç†ç¼“å†²ç¡®ä¿æ¶ˆæ¯å³æ—¶æ¨é€ï¼›<code>set_time_limit(0)</code>å–æ¶ˆPHPæ‰§è¡Œæ—¶é—´é™åˆ¶ï¼Œé¿å…é•¿è¿æ¥è¢«å¼ºåˆ¶ä¸­æ–­ã€‚</p>
<h4 data-id="heading-7">æ­¥éª¤2ï¼šSSEæ ¸å¿ƒå“åº”å¤´ï¼ˆå¿…é…é¡¹ï¼‰</h4>
<pre><code class="hljs language-php" lang="php">
<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Content-Type: text/event-stream'</span>);       <span class="hljs-comment">// å‘Šè¯‰æµè§ˆå™¨è¿™æ˜¯SSEæµ</span>
<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Cache-Control: no-cache'</span>);               <span class="hljs-comment">// ç¦æ­¢æµè§ˆå™¨ç¼“å­˜æ¨é€å†…å®¹</span>
<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Connection: keep-alive'</span>);                <span class="hljs-comment">// å¯ç”¨HTTPé•¿è¿æ¥</span>
<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'X-Accel-Buffering: no'</span>);                 <span class="hljs-comment">// ç¦ç”¨Nginxä»£ç†ç¼“å†²ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»åŠ ï¼Œå¦åˆ™æ¶ˆæ¯ä¼šå»¶è¿Ÿï¼‰</span>
<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Access-Control-Allow-Origin: *'</span>);        <span class="hljs-comment">// è·¨åŸŸé…ç½®ï¼ˆå¼€å‘ç¯å¢ƒç”¨*ï¼Œç”Ÿäº§æ›¿æ¢ä¸ºä½ çš„åŸŸåå¦‚https://xxx.comï¼‰</span>
</code></pre>
<p>å…³é”®è¯´æ˜ï¼š<code>X-Accel-Buffering: no</code>æ˜¯ç”Ÿäº§ç¯å¢ƒæ ¸å¿ƒé…ç½®ï¼ŒNginxé»˜è®¤ä¼šç¼“å†²è¾“å‡ºå†…å®¹ï¼Œå¯¼è‡´æ¶ˆæ¯æ— æ³•å®æ—¶æ¨é€ï¼Œå¿…é¡»ç¦ç”¨ã€‚</p>
<h4 data-id="heading-8">æ­¥éª¤3ï¼šå‘é€è¿æ¥åˆå§‹åŒ–äº‹ä»¶</h4>
<pre><code class="hljs language-php" lang="php">
<span class="hljs-keyword">echo</span> <span class="hljs-string">"event: sse_init\ndata: "</span> . <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">'status'</span> =&gt; <span class="hljs-string">'success'</span>, <span class="hljs-string">'msg'</span> =&gt; <span class="hljs-string">'è¿æ¥æˆåŠŸ'</span>], JSON_UNESCAPED_UNICODE) . <span class="hljs-string">"\n\n"</span>;
<span class="hljs-title function_ invoke__">flush</span>();
</code></pre>
<p>SSEæ ‡å‡†æ ¼å¼è§„åˆ™ï¼š</p>
<ul>
<li>
<p><code>event: äº‹ä»¶å</code>ï¼šè‡ªå®šä¹‰äº‹ä»¶æ ‡è¯†ï¼ˆå‰ç«¯éœ€é€šè¿‡å¯¹åº”äº‹ä»¶åç›‘å¬ï¼‰ï¼›</p>
</li>
<li>
<p><code>data: æ•°æ®å†…å®¹</code>ï¼šæ¶ˆæ¯ä¸»ä½“ï¼Œå»ºè®®ç”¨JSONæ ¼å¼ï¼›</p>
</li>
<li>
<p>ç»“å°¾å¿…é¡»ç”¨<code>\n\n</code>ï¼ˆä¸¤ä¸ªæ¢è¡Œï¼‰æ ‡è¯†ä¸€æ¡æ¶ˆæ¯ç»“æŸï¼›</p>
</li>
<li>
<p><code>flush()</code>ï¼šå¼ºåˆ¶åˆ·æ–°è¾“å‡ºç¼“å†²åŒºï¼Œç¡®ä¿æ¶ˆæ¯ç«‹å³å‘é€åˆ°å®¢æˆ·ç«¯ã€‚</p>
</li>
</ul>
<h4 data-id="heading-9">æ­¥éª¤4ï¼šå¾ªç¯æ¨é€ä¸šåŠ¡æ¶ˆæ¯</h4>
<pre><code class="hljs language-php" lang="php">
<span class="hljs-variable">$count</span> = <span class="hljs-number">0</span>;
<span class="hljs-variable">$maxCount</span> = <span class="hljs-number">50</span>; <span class="hljs-comment">// é™åˆ¶æœ€å¤§æ¨é€æ¬¡æ•°ï¼Œé¿å…æœåŠ¡å™¨èµ„æºæµªè´¹</span>
<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-comment">// é€€å‡ºæ¡ä»¶ï¼šå®¢æˆ·ç«¯æ–­å¼€è¿æ¥ æˆ– è¾¾åˆ°æœ€å¤§æ¨é€æ¬¡æ•°</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">connection_aborted</span>() || <span class="hljs-variable">$count</span> &gt;= <span class="hljs-variable">$maxCount</span>) {
        <span class="hljs-keyword">break</span>;
    }

    <span class="hljs-comment">// 1. ä¸šåŠ¡é€»è¾‘ï¼šæŸ¥è¯¢æ•°æ®åº“/Redis/MQè·å–çœŸå®æ•°æ®ï¼ˆæ­¤å¤„ä¸ºæ¨¡æ‹Ÿï¼‰</span>
    <span class="hljs-variable">$data</span> = [
        <span class="hljs-string">'id'</span>        =&gt; <span class="hljs-variable">$count</span> + <span class="hljs-number">1</span>,
        <span class="hljs-string">'title'</span>     =&gt; <span class="hljs-string">'FastAdminå®æ—¶é€šçŸ¥'</span>,
        <span class="hljs-string">'content'</span>   =&gt; <span class="hljs-string">'æ–°æ¶ˆæ¯ï¼š'</span> . <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">'Y-m-d H:i:s'</span>),
        <span class="hljs-string">'time'</span>      =&gt; <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">'H:i:s'</span>),
        <span class="hljs-string">'url'</span>       =&gt; <span class="hljs-string">'/index/sse/detail'</span> <span class="hljs-comment">// æ¶ˆæ¯è¯¦æƒ…é¡µåœ°å€</span>
    ];

    <span class="hljs-comment">// 2. æŒ‰SSEæ ¼å¼è¾“å‡ºæ¶ˆæ¯ï¼ˆäº‹ä»¶åmy_eventï¼Œå‰ç«¯å¯¹åº”ç›‘å¬ï¼‰</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"event: my_event\ndata: "</span> . <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$data</span>, JSON_UNESCAPED_UNICODE) . <span class="hljs-string">"\n\n"</span>;
    <span class="hljs-title function_ invoke__">flush</span>();

    <span class="hljs-comment">// 3. æ§åˆ¶æ¨é€é¢‘ç‡ï¼ˆæ¯2ç§’1æ¡ï¼Œå¯æ ¹æ®ä¸šåŠ¡è°ƒæ•´ï¼‰</span>
    <span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-number">2</span>);
    <span class="hljs-variable">$count</span>++;
}
</code></pre>
<p>å…³é”®è¯´æ˜ï¼š<code>connection_aborted()</code>ç”¨äºæ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦ä¸»åŠ¨æ–­å¼€è¿æ¥ï¼ˆå¦‚å…³é—­é¡µé¢ï¼‰ï¼Œé¿å…æœåŠ¡å™¨ç©ºå¾ªç¯ï¼›å®é™…å¼€å‘ä¸­éœ€å°†æ¨¡æ‹Ÿæ•°æ®æ›¿æ¢ä¸ºçœŸå®ä¸šåŠ¡æŸ¥è¯¢ï¼ˆå¦‚æŸ¥è¯¢æœªè¯»æ¶ˆæ¯è¡¨ï¼‰ã€‚</p>
<h2 data-id="heading-10">å››ã€å‰ç«¯å®ç°ï¼šé¡µé¢ä¸äº¤äº’é€»è¾‘</h2>
<p>å‰ç«¯åŒ…å«ä¸¤éƒ¨åˆ†ï¼šé¡µé¢ç»“æ„ï¼ˆHTMLï¼‰å’Œäº¤äº’é€»è¾‘ï¼ˆJSï¼‰ï¼Œéœ€æ”¾åœ¨FastAdminå¯¹åº”çš„è§†å›¾ä¸JSç›®å½•ä¸­ã€‚</p>
<h3 data-id="heading-11">4.1 å‰ç«¯é¡µé¢ï¼ˆHTMLï¼‰</h3>
<p>è·¯å¾„ï¼š<code>application/index/view/index/test.html</code>ï¼Œç”¨äºå±•ç¤ºæ§åˆ¶æŒ‰é’®å’Œå®æ—¶æ¶ˆæ¯ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å¼•å…¥FastAdminå…¬å…±èµ„æºï¼ˆæ— éœ€ä¿®æ”¹ï¼‰ --&gt;</span>
<span class="hljs-comment">&lt;!-- å‰å°é¡µé¢å†…å®¹ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æˆ‘çš„å®æ—¶æ¶ˆæ¯<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ–°å¢ï¼šæ‹†åˆ†å¼€å¯/åœæ­¢ä¸¤ä¸ªç‹¬ç«‹æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin: 10px 0; display: flex; gap: 10px;"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sse-start-btn"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"layui-btn layui-btn-normal"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding: 6px 15px;"</span>&gt;</span>
            å¼€å¯å®æ—¶é€šçŸ¥
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sse-stop-btn"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"layui-btn layui-btn-danger"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding: 6px 15px; opacity: 0.5; cursor: not-allowed;"</span>&gt;</span>
            åœæ­¢å®æ—¶é€šçŸ¥
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sse-status"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-left: 10px; color: #999; align-self: center;"</span>&gt;</span>æœªè¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ¶ˆæ¯å±•ç¤ºåŒºåŸŸ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"msg-container"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%; max-width: 600px; height: 400px; border: 1px solid #eee; padding: 10px; overflow-y: auto; margin-top: 20px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab13305cb2374bde9eedc9d2d86aef69~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWU5Lid:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631426&amp;x-signature=rvGivo0iFsoVp%2F5QCasjtClqxTE%3D" alt="image.png" loading="lazy"/>
é¡µé¢æ ¸å¿ƒå…ƒç´ è¯´æ˜ï¼š</p>
<ul>
<li>
<p><code>sse-start-btn</code>ï¼šå¼€å¯SSEè¿æ¥æŒ‰é’®ï¼›</p>
</li>
<li>
<p><code>sse-stop-btn</code>ï¼šåœæ­¢SSEè¿æ¥æŒ‰é’®ï¼ˆé»˜è®¤ç¦ç”¨ï¼‰ï¼›</p>
</li>
<li>
<p><code>sse-status</code>ï¼šæ˜¾ç¤ºè¿æ¥çŠ¶æ€ï¼ˆæœªè¿æ¥/å·²è¿æ¥/å·²åœæ­¢ï¼‰ï¼›</p>
</li>
<li>
<p><code>msg-container</code>ï¼šå®æ—¶æ¶ˆæ¯æ¸²æŸ“å®¹å™¨ã€‚</p>
</li>
</ul>
<h3 data-id="heading-12">4.2 äº¤äº’é€»è¾‘ï¼ˆJSï¼‰</h3>
<p>è·¯å¾„ï¼š<code>public/assets/js/frontend/index.js</code>ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡<code>EventSource</code>ä¸åç«¯å»ºç«‹è¿æ¥ï¼Œå¤„ç†æ¶ˆæ¯ä¸çŠ¶æ€ã€‚</p>
<h4 data-id="heading-13">4.2.1 å®Œæ•´JSä»£ç </h4>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-title function_">define</span>([<span class="hljs-string">'jquery'</span>, <span class="hljs-string">'bootstrap'</span>, <span class="hljs-string">'frontend'</span>, <span class="hljs-string">'form'</span>, <span class="hljs-string">'template'</span>], <span class="hljs-keyword">function</span> (<span class="hljs-params">$, <span class="hljs-literal">undefined</span>, Frontend, Form, Template</span>) {
    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Controller</span> = {
        <span class="hljs-attr">test</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
            <span class="hljs-comment">// ========== SSEæ ¸å¿ƒå˜é‡ ==========</span>
            <span class="hljs-keyword">let</span> eventSource = <span class="hljs-literal">null</span>; <span class="hljs-comment">// EventSourceå®ä¾‹ï¼ˆSSEè¿æ¥æ ¸å¿ƒï¼‰</span>
            <span class="hljs-keyword">let</span> isSSEConnected = <span class="hljs-literal">false</span>; <span class="hljs-comment">// è¿æ¥çŠ¶æ€æ ‡è®°</span>
            <span class="hljs-keyword">let</span> isManuallyStopped = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ‰‹åŠ¨åœæ­¢æ ‡è®°ï¼ˆåŒºåˆ†"æ‰‹åŠ¨åœæ­¢"å’Œ"å¼‚å¸¸æ–­å¼€"ï¼‰</span>

            <span class="hljs-comment">// ========== æ ¸å¿ƒæ–¹æ³• ==========</span>
            <span class="hljs-comment">/**
             * å…³é—­SSEè¿æ¥
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">boolean</span>} <span class="hljs-variable">forceStop</span> - æ˜¯å¦ä¸ºæ‰‹åŠ¨åœæ­¢
             */</span>
            <span class="hljs-keyword">function</span> <span class="hljs-title function_">closeSSE</span>(<span class="hljs-params">forceStop = <span class="hljs-literal">false</span></span>) {
                <span class="hljs-keyword">if</span> (eventSource) {
                    eventSource.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// å…³é—­è¿æ¥</span>
                    eventSource = <span class="hljs-literal">null</span>;
                    isSSEConnected = <span class="hljs-literal">false</span>;
                    <span class="hljs-keyword">if</span> (forceStop) {
                        isManuallyStopped = <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ ‡è®°ä¸ºæ‰‹åŠ¨åœæ­¢ï¼Œé¿å…è‡ªåŠ¨é‡è¿</span>
                    }
                    <span class="hljs-title function_">updateSSEUI</span>(); <span class="hljs-comment">// æ›´æ–°æŒ‰é’®ä¸çŠ¶æ€UI</span>
                }
            }

            <span class="hljs-comment">/**
             * åˆå§‹åŒ–SSEè¿æ¥
             */</span>
            <span class="hljs-keyword">function</span> <span class="hljs-title function_">initSSE</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// é¿å…é‡å¤è¿æ¥ï¼šå·²è¿æ¥ æˆ– æ‰‹åŠ¨åœæ­¢åä¸å…è®¸é‡å¤åˆå§‹åŒ–</span>
                <span class="hljs-keyword">if</span> (isSSEConnected || isManuallyStopped) <span class="hljs-keyword">return</span>;
                
                <span class="hljs-title function_">closeSSE</span>(); <span class="hljs-comment">// ç¡®ä¿ä¹‹å‰çš„è¿æ¥å·²å…³é—­</span>
                isManuallyStopped = <span class="hljs-literal">false</span>;

                <span class="hljs-comment">// åç«¯SSEæ¥å£åœ°å€ï¼ˆéœ€ä¸æ§åˆ¶å™¨è·¯ç”±ä¸€è‡´ï¼‰</span>
                <span class="hljs-keyword">const</span> sseUrl = <span class="hljs-string">'/index/index/sse'</span>;
                
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// 1. åˆ›å»ºEventSourceå®ä¾‹ï¼Œå»ºç«‹è¿æ¥</span>
                    eventSource = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventSource</span>(sseUrl);
                    isSSEConnected = <span class="hljs-literal">true</span>;
                    <span class="hljs-title function_">updateSSEUI</span>(); <span class="hljs-comment">// åˆå§‹åŒ–åç«‹å³æ›´æ–°UI</span>

                    <span class="hljs-comment">// 2. ç›‘å¬åç«¯"è¿æ¥æˆåŠŸ"äº‹ä»¶ï¼ˆå¯¹åº”åç«¯çš„sse_initäº‹ä»¶ï¼‰</span>
                    eventSource.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'sse_init'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
                        <span class="hljs-keyword">const</span> res = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(e.<span class="hljs-property">data</span>);
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'SSEè¿æ¥æˆåŠŸï¼š'</span>, res);
                        $(<span class="hljs-string">'#sse-status'</span>).<span class="hljs-title function_">text</span>(<span class="hljs-string">'å·²è¿æ¥ï¼ˆå®æ—¶æ¥æ”¶æ¶ˆæ¯ï¼‰'</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">'color'</span>, <span class="hljs-string">'#009688'</span>);
                    });

                    <span class="hljs-comment">// 3. ç›‘å¬åç«¯"ä¸šåŠ¡æ¶ˆæ¯"äº‹ä»¶ï¼ˆå¯¹åº”åç«¯çš„my_eventäº‹ä»¶ï¼Œæ ¸å¿ƒï¼ï¼‰</span>
                    eventSource.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'my_event'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
                        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(e.<span class="hljs-property">data</span>); <span class="hljs-comment">// è§£æåç«¯æ¨é€çš„JSONæ•°æ®</span>
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°ä¸šåŠ¡æ¶ˆæ¯ï¼š'</span>, data);
                        <span class="hljs-title function_">renderMsg</span>(data); <span class="hljs-comment">// æ¸²æŸ“æ¶ˆæ¯åˆ°é¡µé¢</span>
                    });

                    <span class="hljs-comment">// 4. ç›‘å¬è¿æ¥é”™è¯¯ï¼ˆå¼‚å¸¸æ–­å¼€æ—¶è§¦å‘ï¼‰</span>
                    eventSource.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) {
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'SSEè¿æ¥é”™è¯¯ï¼š'</span>, err);
                        isSSEConnected = <span class="hljs-literal">false</span>;
                        <span class="hljs-title function_">updateSSEUI</span>();
                        <span class="hljs-comment">// éæ‰‹åŠ¨åœæ­¢çš„å¼‚å¸¸æ–­å¼€ï¼Œ3ç§’åè‡ªåŠ¨é‡è¿</span>
                        <span class="hljs-keyword">if</span> (!isManuallyStopped) {
                            <span class="hljs-title function_">closeSSE</span>();
                            <span class="hljs-built_in">setTimeout</span>(initSSE, <span class="hljs-number">3000</span>);
                        }
                    };
                } <span class="hljs-keyword">catch</span> (err) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åˆå§‹åŒ–SSEå¤±è´¥ï¼š'</span>, err);
                    <span class="hljs-comment">// éæ‰‹åŠ¨åœæ­¢çš„å¤±è´¥ï¼Œ5ç§’åé‡è¯•</span>
                    <span class="hljs-keyword">if</span> (!isManuallyStopped) {
                        <span class="hljs-built_in">setTimeout</span>(initSSE, <span class="hljs-number">5000</span>);
                    }
                }
            }

            <span class="hljs-comment">/**
             * æ¸²æŸ“æ¶ˆæ¯åˆ°é¡µé¢
             * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">data</span> - åç«¯æ¨é€çš„æ¶ˆæ¯æ•°æ®
             */</span>
            <span class="hljs-keyword">function</span> <span class="hljs-title function_">renderMsg</span>(<span class="hljs-params">data</span>) {
                <span class="hljs-keyword">const</span> msgContainer = $(<span class="hljs-string">'#msg-container'</span>)[<span class="hljs-number">0</span>];
                <span class="hljs-comment">// åˆ›å»ºæ¶ˆæ¯DOMå…ƒç´ ï¼ˆä½¿ç”¨layuié£æ ¼æ ·å¼ï¼‰</span>
                <span class="hljs-keyword">const</span> msgItem = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
                msgItem.<span class="hljs-property">style</span> = <span class="hljs-string">'padding: 8px; margin: 5px 0; background: #f9f9f9; border-radius: 4px;'</span>;
                <span class="hljs-comment">// æ¶ˆæ¯å†…å®¹æ‹¼æ¥ï¼ˆå¯æ ¹æ®éœ€æ±‚ä¿®æ”¹æ ·å¼ï¼‰</span>
                msgItem.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
                    &lt;div&gt;&lt;strong&gt;<span class="hljs-subst">${data.title}</span>&lt;/strong&gt; &lt;small style="color: #999;"&gt;<span class="hljs-subst">${data.time}</span>&lt;/small&gt;&lt;/div&gt;
                    &lt;div style="margin-top: 5px;"&gt;<span class="hljs-subst">${data.content}</span>&lt;/div&gt;
                    &lt;div style="margin-top: 5px;"&gt;&lt;a href="<span class="hljs-subst">${data.url}</span>" style="color: #009688;"&gt;æŸ¥çœ‹è¯¦æƒ…&lt;/a&gt;&lt;/div&gt;
                `</span>;
                <span class="hljs-comment">// æ·»åŠ åˆ°æ¶ˆæ¯å®¹å™¨å¹¶è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨</span>
                msgContainer.<span class="hljs-title function_">appendChild</span>(msgItem);
                msgContainer.<span class="hljs-property">scrollTop</span> = msgContainer.<span class="hljs-property">scrollHeight</span>;
            }

            <span class="hljs-comment">/**
             * æ›´æ–°UIçŠ¶æ€ï¼ˆæŒ‰é’®ç¦ç”¨/å¯ç”¨ + çŠ¶æ€æ–‡å­—ï¼‰
             */</span>
            <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateSSEUI</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> $startBtn = $(<span class="hljs-string">'#sse-start-btn'</span>);
                <span class="hljs-keyword">const</span> $stopBtn = $(<span class="hljs-string">'#sse-stop-btn'</span>);
                <span class="hljs-keyword">const</span> $status = $(<span class="hljs-string">'#sse-status'</span>);

                <span class="hljs-keyword">if</span> (isSSEConnected &amp;&amp; !isManuallyStopped) {
                    <span class="hljs-comment">// å·²è¿æ¥çŠ¶æ€ï¼šç¦ç”¨å¼€å¯æŒ‰é’®ï¼Œå¯ç”¨åœæ­¢æŒ‰é’®</span>
                    $startBtn.<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>).<span class="hljs-title function_">css</span>({<span class="hljs-attr">opacity</span>: <span class="hljs-number">0.5</span>, <span class="hljs-attr">cursor</span>: <span class="hljs-string">'not-allowed'</span>});
                    $stopBtn.<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">css</span>({<span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">cursor</span>: <span class="hljs-string">'pointer'</span>});
                    $status.<span class="hljs-title function_">text</span>(<span class="hljs-string">'å·²è¿æ¥ï¼ˆå®æ—¶æ¥æ”¶æ¶ˆæ¯ï¼‰'</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">'color'</span>, <span class="hljs-string">'#009688'</span>);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// æœªè¿æ¥/å·²åœæ­¢çŠ¶æ€ï¼šå¯ç”¨å¼€å¯æŒ‰é’®ï¼Œç¦ç”¨åœæ­¢æŒ‰é’®</span>
                    $startBtn.<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">css</span>({<span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">cursor</span>: <span class="hljs-string">'pointer'</span>});
                    $stopBtn.<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>).<span class="hljs-title function_">css</span>({<span class="hljs-attr">opacity</span>: <span class="hljs-number">0.5</span>, <span class="hljs-attr">cursor</span>: <span class="hljs-string">'not-allowed'</span>});
                    
                    <span class="hljs-keyword">if</span> (isManuallyStopped) {
                        $status.<span class="hljs-title function_">text</span>(<span class="hljs-string">'å·²åœæ­¢ï¼ˆéœ€é‡æ–°å¼€å¯ï¼‰'</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">'color'</span>, <span class="hljs-string">'#FF5722'</span>);
                    } <span class="hljs-keyword">else</span> {
                        $status.<span class="hljs-title function_">text</span>(<span class="hljs-string">'æœªè¿æ¥ï¼ˆç‚¹å‡»å¼€å¯é€šçŸ¥ï¼‰'</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">'color'</span>, <span class="hljs-string">'#999'</span>);
                    }
                }
            }

            <span class="hljs-comment">// ========== äº‹ä»¶ç»‘å®š ==========</span>
            $(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// å¼€å¯SSEè¿æ¥æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span>
                $(<span class="hljs-string">'#sse-start-btn'</span>).<span class="hljs-title function_">off</span>(<span class="hljs-string">'click'</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                    <span class="hljs-keyword">if</span> (!isSSEConnected &amp;&amp; !isManuallyStopped) {
                        <span class="hljs-title function_">initSSE</span>();
                    }
                });

                <span class="hljs-comment">// åœæ­¢SSEè¿æ¥æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span>
                $(<span class="hljs-string">'#sse-stop-btn'</span>).<span class="hljs-title function_">off</span>(<span class="hljs-string">'click'</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                    <span class="hljs-title function_">closeSSE</span>(<span class="hljs-literal">true</span>); <span class="hljs-comment">// ä¼ å…¥trueæ ‡è®°ä¸ºæ‰‹åŠ¨åœæ­¢</span>
                });
            });

            <span class="hljs-comment">// ========== é¡µé¢å…³é—­æ—¶æ¸…ç† ==========</span>
            <span class="hljs-comment">// é¡µé¢åˆ·æ–°/å…³é—­å‰ï¼Œä¸»åŠ¨æ–­å¼€SSEè¿æ¥ï¼Œé‡Šæ”¾æœåŠ¡å™¨èµ„æº</span>
            $(<span class="hljs-variable language_">window</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">'beforeunload'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                <span class="hljs-title function_">closeSSE</span>();
            });
        },
    };
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Controller</span>;
});
</code></pre>
<h4 data-id="heading-14">4.2.2 JSæ ¸å¿ƒé€»è¾‘æ‹†è§£</h4>
<h5 data-id="heading-15">1. æ ¸å¿ƒå˜é‡å®šä¹‰</h5>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">let</span> eventSource = <span class="hljs-literal">null</span>; <span class="hljs-comment">// EventSourceå®ä¾‹ï¼ˆSSEè¿æ¥çš„æ ¸å¿ƒå¯¹è±¡ï¼‰</span>
<span class="hljs-keyword">let</span> isSSEConnected = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ ‡è®°æ˜¯å¦å¤„äºè¿æ¥çŠ¶æ€</span>
<span class="hljs-keyword">let</span> isManuallyStopped = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ ‡è®°æ˜¯å¦ä¸ºç”¨æˆ·æ‰‹åŠ¨åœæ­¢ï¼ˆé¿å…å¼‚å¸¸é‡è¿ï¼‰</span>
</code></pre>
<h5 data-id="heading-16">2. è¿æ¥ç®¡ç†æ–¹æ³•</h5>
<ul>
<li>
<p><code>initSSE()</code>ï¼šåˆå§‹åŒ–è¿æ¥ï¼Œåˆ›å»º<code>EventSource</code>å®ä¾‹ï¼Œç›‘å¬åç«¯3ç±»äº‹ä»¶ï¼ˆè¿æ¥æˆåŠŸã€ä¸šåŠ¡æ¶ˆæ¯ã€è¿æ¥é”™è¯¯ï¼‰ï¼›</p>
</li>
<li>
<p><code>closeSSE()</code>ï¼šå…³é—­è¿æ¥ï¼Œæ›´æ–°çŠ¶æ€æ ‡è®°ï¼Œé¿å…å¼‚å¸¸é‡è¿ï¼›</p>
</li>
<li>
<p><code>updateSSEUI()</code>ï¼šæ ¹æ®è¿æ¥çŠ¶æ€åŒæ­¥æŒ‰é’®ç¦ç”¨/å¯ç”¨çŠ¶æ€å’ŒçŠ¶æ€æ–‡å­—ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p>
</li>
</ul>
<h5 data-id="heading-17">3. æ¶ˆæ¯æ¸²æŸ“é€»è¾‘</h5>
<p><code>renderMsg()</code>æ–¹æ³•è´Ÿè´£å°†åç«¯æ¨é€çš„JSONæ•°æ®è½¬åŒ–ä¸ºé¡µé¢DOMå…ƒç´ ï¼Œæ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<ul>
<li>
<p>åˆ›å»ºç¬¦åˆLayuié£æ ¼çš„æ¶ˆæ¯å¡ç‰‡ï¼›</p>
</li>
<li>
<p>æ‹¼æ¥æ¶ˆæ¯æ ‡é¢˜ã€å†…å®¹ã€æ—¶é—´å’Œè¯¦æƒ…é“¾æ¥ï¼›</p>
</li>
<li>
<p>æ·»åŠ æ¶ˆæ¯åˆ°å®¹å™¨åè‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œç¡®ä¿ç”¨æˆ·çœ‹åˆ°æœ€æ–°æ¶ˆæ¯ã€‚</p>
</li>
</ul>
<h2 data-id="heading-18">äº”ã€éƒ¨ç½²ä¸æµ‹è¯•</h2>
<h3 data-id="heading-19">5.1 è·¯ç”±é…ç½®ï¼ˆFastAdminç›´æ¥ä¸å†™äº†ï¼ŒæŒ‰è·¯å¾„å»è®¿é—®ï¼‰</h3>
<p>åœ¨<code>route/route.php</code>ä¸­æ·»åŠ å‰ç«¯è®¿é—®è·¯ç”±ï¼ˆç¡®ä¿é¡µé¢å’Œæ¥å£å¯è®¿é—®ï¼‰ï¼š</p>
<pre><code class="hljs language-php" lang="php">
<span class="hljs-comment">// SSEæµ‹è¯•é¡µé¢è·¯ç”±</span>
<span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'index/test'</span>, <span class="hljs-string">'index/index/test'</span>);
<span class="hljs-comment">// SSEæ¨é€æ¥å£è·¯ç”±</span>
<span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'index/sse'</span>, <span class="hljs-string">'index/index/sse'</span>);
</code></pre>
<h3 data-id="heading-20">5.2 æµ‹è¯•æ­¥éª¤</h3>
<ol>
<li>
<p>å¯åŠ¨FastAdminé¡¹ç›®ï¼Œè®¿é—®æµ‹è¯•é¡µé¢ï¼š<code>http://ä½ çš„åŸŸå/index/test</code>ï¼›</p>
</li>
<li>
<p>ç‚¹å‡»ã€Œå¼€å¯å®æ—¶é€šçŸ¥ã€æŒ‰é’®ï¼ŒçŠ¶æ€å˜ä¸ºã€Œå·²è¿æ¥ï¼ˆå®æ—¶æ¥æ”¶æ¶ˆæ¯ï¼‰ã€ï¼›</p>
</li>
<li>
<p>æ¶ˆæ¯å®¹å™¨ä¸­æ¯2ç§’ä¼šæ–°å¢ä¸€æ¡å®æ—¶æ¶ˆæ¯ï¼Œæ§åˆ¶å°å¯æŸ¥çœ‹è°ƒè¯•æ—¥å¿—ï¼›</p>
</li>
<li>
<p>ç‚¹å‡»ã€Œåœæ­¢å®æ—¶é€šçŸ¥ã€æŒ‰é’®ï¼Œè¿æ¥æ–­å¼€ï¼ŒçŠ¶æ€å˜ä¸ºã€Œå·²åœæ­¢ï¼ˆéœ€é‡æ–°å¼€å¯ï¼‰ã€ï¼›</p>
</li>
<li>
<p>è‹¥å…³é—­é¡µé¢å†é‡æ–°æ‰“å¼€ï¼Œä¼šè‡ªåŠ¨æ¢å¤è¿æ¥ï¼ˆå¼‚å¸¸æ–­å¼€å3ç§’è‡ªåŠ¨é‡è¿ï¼‰ã€‚</p>
</li>
</ol>
<h4 data-id="heading-21">æˆªå›¾</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0643f2be87564a11b8436a6d3eb65417~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWU5Lid:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631426&amp;x-signature=sQhTQhR7MhQnVHbq%2FDHDpKKyvos%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8591e6d7d8ad402c9f75df4de5e69f68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWU5Lid:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631426&amp;x-signature=hxwmtm0xTjuudZMoFk0V4ZMio78%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88b29145641e4498bf8847c109db75c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWU5Lid:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631426&amp;x-signature=hX9gJUXGJs71NVW8J2L51UpTT%2BU%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bebd49829a3847e68fa274f30dc55828~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWU5Lid:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631426&amp;x-signature=1%2F28Xy%2FJWsZZxHg56oPyGrdgeaM%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7e6ba9a67164e5984d308ca4ee5b5d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWU5Lid:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631426&amp;x-signature=WLGIW8HhIkVlONKdM8nGRHbUspI%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-22">5.3 ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹</h3>
<ol>
<li>
<p>è·¨åŸŸé…ç½®ï¼šå°†æ§åˆ¶å™¨ä¸­<code>Access-Control-Allow-Origin: *</code>æ›¿æ¢ä¸ºä½ çš„å‰ç«¯åŸŸåï¼ˆå¦‚<code>https://admin.xxx.com</code>ï¼‰ï¼Œé¿å…è·¨åŸŸå®‰å…¨é£é™©ï¼›</p>
</li>
<li>
<p>Nginxé…ç½®ï¼šç¡®ä¿Nginxç¦ç”¨ç¼“å†²ï¼Œå¯åœ¨ç«™ç‚¹é…ç½®ä¸­æ·»åŠ ï¼š<code>proxy_buffering off;</code>ï¼Œä¸åç«¯<code>X-Accel-Buffering: no</code>é…åˆä½¿ç”¨ï¼›</p>
</li>
<li>
<p>è¿æ¥é™åˆ¶ï¼šSSEåŸºäºHTTPé•¿è¿æ¥ï¼Œéœ€æ ¹æ®æœåŠ¡å™¨é…ç½®è°ƒæ•´æœ€å¤§å¹¶å‘è¿æ¥æ•°ï¼ˆå¦‚Nginxçš„<code>worker_connections</code>ï¼‰ï¼›</p>
</li>
<li>
<p>ä¸šåŠ¡ä¼˜åŒ–ï¼šå°†æ¨¡æ‹Ÿæ•°æ®æ›¿æ¢ä¸ºRedis/æ¶ˆæ¯é˜Ÿåˆ—æŸ¥è¯¢ï¼Œé¿å…æ•°æ®åº“é¢‘ç¹æŸ¥è¯¢ï¼›å¯æ ¹æ®ç”¨æˆ·IDè¿‡æ»¤æ¶ˆæ¯ï¼ˆéœ€ç»“åˆç™»å½•çŠ¶æ€ï¼Œåœ¨æ¥å£ä¸­æ·»åŠ ç”¨æˆ·è®¤è¯ï¼‰ï¼›</p>
</li>
<li>
<p>æ¨é€æ¬¡æ•°ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´<code>$maxCount</code>ï¼ˆæœ€å¤§æ¨é€æ¬¡æ•°ï¼‰ï¼Œæˆ–ç§»é™¤æ¬¡æ•°é™åˆ¶ï¼ˆéœ€ç¡®ä¿æœ‰å¯é çš„é€€å‡ºæ¡ä»¶ï¼‰ã€‚</p>
</li>
</ol>
<h2 data-id="heading-23">å…­ã€å¸¸è§é—®é¢˜æ’æŸ¥</h2>

























<table><thead><tr><th>é—®é¢˜ç°è±¡</th><th>æ’æŸ¥æ–¹å‘</th></tr></thead><tbody><tr><td>ç‚¹å‡»å¼€å¯æŒ‰é’®æ— ååº”ï¼Œæ§åˆ¶å°æ— æ—¥å¿—</td><td>1. æ£€æŸ¥JSè·¯å¾„æ˜¯å¦æ­£ç¡®å¼•å…¥ï¼›2. ç¡®è®¤<code>sseUrl</code>ä¸è·¯ç”±é…ç½®ä¸€è‡´ï¼›3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ã€Œç½‘ç»œã€é¢æ¿ï¼Œæ˜¯å¦æœ‰SSEæ¥å£è¯·æ±‚</td></tr><tr><td>æ¶ˆæ¯å»¶è¿Ÿæ¨é€æˆ–æ‰¹é‡æ¨é€</td><td>1. ç¡®è®¤åç«¯æ·»åŠ <code>X-Accel-Buffering: no</code>å“åº”å¤´ï¼›2. æ£€æŸ¥Nginxæ˜¯å¦é…ç½®<code>proxy_buffering off;</code>ï¼›3. ç¡®ä¿ä»£ç ä¸­æ¯æ¬¡è¾“å‡ºåè°ƒç”¨<code>flush()</code></td></tr><tr><td>è¿æ¥é¢‘ç¹æ–­å¼€ï¼Œè‡ªåŠ¨é‡è¿æ— æ•ˆ</td><td>1. æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¼€å¯é˜²ç«å¢™/å®‰å…¨ç»„é™åˆ¶ï¼›2. ç¡®è®¤PHP<code>set_time_limit(0)</code>å·²é…ç½®ï¼›3. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼Œæ˜¯å¦æœ‰å†…å­˜æº¢å‡ºæˆ–è¿›ç¨‹è¢«æ€æƒ…å†µ</td></tr><tr><td>è·¨åŸŸé”™è¯¯</td><td>1. æ£€æŸ¥åç«¯è·¨åŸŸå“åº”å¤´æ˜¯å¦é…ç½®ï¼›2. ç¡®ä¿å‰ç«¯åŸŸåä¸<code>Access-Control-Allow-Origin</code>ä¸€è‡´ï¼›3. ç¡®è®¤è¯·æ±‚æ–¹æ³•ä¸ºGETï¼ˆSSEä»…æ”¯æŒGETï¼‰</td></tr></tbody></table>
<h2 data-id="heading-24">ä¸ƒã€æ€»ç»“</h2>
<p>æœ¬æ•™ç¨‹åŸºäºFastAdminå®ç°äº†è½»é‡çº§çš„SSEå®æ—¶æ¨é€åŠŸèƒ½ï¼Œæ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼šæ— éœ€å¼•å…¥é¢å¤–ç»„ä»¶ï¼ŒåŸºäºHTTPåè®®å®ç°ï¼Œå¼€å‘æˆæœ¬ä½ï¼Œé€‚ç”¨äºæ¶ˆæ¯é€šçŸ¥ã€æ•°æ®ç›‘æ§ç­‰å•å‘æ¨é€åœºæ™¯ã€‚å¦‚éœ€åŒå‘é€šä¿¡ï¼ˆå¦‚èŠå¤©åŠŸèƒ½ï¼‰ï¼Œå¯è€ƒè™‘WebSocketæŠ€æœ¯ï¼Œè€ŒSSEåˆ™æ˜¯å•å‘æ¨é€åœºæ™¯çš„æœ€ä¼˜é€‰æ‹©ä¹‹ä¸€ã€‚</p>
<p>å¯æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚æ‰©å±•ä»¥ä¸‹åŠŸèƒ½ï¼šç”¨æˆ·ç™»å½•æ€æ ¡éªŒã€æ¶ˆæ¯å·²è¯»/æœªè¯»æ ‡è®°ã€è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹ï¼ˆå¦‚ç³»ç»Ÿé€šçŸ¥ã€è®¢å•æé†’ï¼‰ã€æ¶ˆæ¯è¿‡æ»¤ä¸åˆ†é¡µç­‰ã€‚</p>
<blockquote>
<p>ï¼ˆæ³¨ï¼šæ–‡æ¡£ç”±ç½‘ç»œä¹ä¸ç¼–å†™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£Flinkä¸Kafkaåˆ†åŒºç­–ç•¥: è‡ªå®šä¹‰CustomRangePartitionerè¯¦è§£]]></title>    <link>https://juejin.cn/post/7584725529876676658</link>    <guid>https://juejin.cn/post/7584725529876676658</guid>    <pubDate>2025-12-18T03:01:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584725529876676658" data-draft-id="7584722109584523307" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£Flinkä¸Kafkaåˆ†åŒºç­–ç•¥: è‡ªå®šä¹‰CustomRangePartitionerè¯¦è§£"/> <meta itemprop="keywords" content="Flink"/> <meta itemprop="datePublished" content="2025-12-18T03:01:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£Flinkä¸Kafkaåˆ†åŒºç­–ç•¥: è‡ªå®šä¹‰CustomRangePartitionerè¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:01:39.000Z" title="Thu Dec 18 2025 03:01:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>ä»“åº“åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fundertaker86001%2Fdirstrbuted-jobs" target="_blank" title="https://github.com/undertaker86001/dirstrbuted-jobs" ref="nofollow noopener noreferrer">github.com/undertaker8â€¦</a></p>
<p>åœ¨å¤§æ•°æ®æµå¤„ç†é¢†åŸŸï¼ŒApache Flinkä¸Apache Kafkaçš„ç»“åˆå·²æˆä¸ºä¸šç•Œä¸»æµæ–¹æ¡ˆä¹‹ä¸€ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚ä½•åˆç†åœ°å°†æ•°æ®åˆ†å¸ƒåˆ°Kafkaçš„ä¸åŒåˆ†åŒºä¸­ï¼Œå¯¹äºç³»ç»Ÿçš„æ€§èƒ½å’Œæ•°æ®ä¸€è‡´æ€§å…·æœ‰é‡è¦å½±å“ã€‚æœ¬æ–‡å°†æ·±å…¥å‰–æ<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">CustomRangePartitioner.java</a>ç±»çš„å®ç°åŸç†ï¼Œä»Kafkaæ¶ˆè´¹ã€åˆ†åŒºç­–ç•¥ã€Flinkåˆ†å‘æœºåˆ¶ä»¥åŠåˆ†åŒºä¸å‡è¡¡ç­‰å¤šä¸ªç»´åº¦è¿›è¡Œå…¨é¢è§£è¯»ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€åŸºç¡€æ¦‚å¿µç†è§£</h2>
<h3 data-id="heading-2">1.1 Kafkaåˆ†åŒºæœºåˆ¶</h3>
<p>Kafkaé€šè¿‡åˆ†åŒºï¼ˆPartitionï¼‰å®ç°æ°´å¹³æ‰©å±•å’Œå¹¶è¡Œå¤„ç†èƒ½åŠ›ï¼š</p>
<ul>
<li>æ¯ä¸ªTopicå¯ä»¥åˆ†ä¸ºå¤šä¸ªPartitionï¼Œæ¯ä¸ªPartitionæ˜¯ä¸€ä¸ªæœ‰åºã€ä¸å¯å˜çš„æ¶ˆæ¯åºåˆ—</li>
<li>Partitionæ˜¯Kafkaå®ç°é«˜ååé‡å’Œè´Ÿè½½å‡è¡¡çš„åŸºç¡€å•å…ƒ</li>
<li>åŒä¸€Partitionå†…çš„æ¶ˆæ¯ä¿æŒé¡ºåºï¼Œä½†ä¸åŒPartitioné—´ä¸ä¿è¯å…¨å±€é¡ºåº</li>
</ul>
<h3 data-id="heading-3">1.2 Flinkä¸Kafkaé›†æˆ</h3>
<p>Flinké€šè¿‡<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">Kafka Connector</a>ä¸Kafkaè¿›è¡Œæ•°æ®äº¤äº’ï¼š</p>
<ul>
<li>Flinkä½œä¸ºKafkaæ¶ˆè´¹è€…è¯»å–æ•°æ®è¿›è¡Œæµå¤„ç†</li>
<li>å¤„ç†åçš„æ•°æ®å†é€šè¿‡Flink Kafka Producerå†™å›åˆ°Kafka</li>
<li>åˆ†åŒºç­–ç•¥å†³å®šäº†æ•°æ®å¦‚ä½•ä»Flinkåˆ†å‘åˆ°Kafkaçš„ä¸åŒåˆ†åŒº</li>
</ul>
<h3 data-id="heading-4">1.3 åˆ†åŒºä¸å‡è¡¡é—®é¢˜</h3>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¸¸è§çš„åˆ†åŒºä¸å‡è¡¡é—®é¢˜åŒ…æ‹¬ï¼š</p>
<ol>
<li>æŸäº›Partitionæ•°æ®é‡è¿œè¶…å…¶ä»–Partition</li>
<li>æŸäº›Kafka Brokerè´Ÿè½½è¿‡é«˜è€Œå…¶ä»–Brokerç©ºé—²</li>
<li>Flinkå¹¶è¡Œåº¦ä¸Kafkaåˆ†åŒºæ•°ä¸åŒ¹é…å¯¼è‡´çš„æ•°æ®å€¾æ–œ</li>
</ol>
<h2 data-id="heading-5">äºŒã€CustomRangePartitionerè®¾è®¡æ€è·¯</h2>
<h3 data-id="heading-6">2.1 è®¾è®¡ç›®æ ‡</h3>
<p><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">CustomRangePartitioner</a>çš„è®¾è®¡æ—¨åœ¨è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li>åŸç”Ÿ<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">FlinkFixedPartitioner</a>å¯èƒ½å¯¼è‡´éƒ¨åˆ†Partitionæ— æ³•æ¥æ”¶åˆ°æ•°æ®</li>
<li>å®ç°æ›´å‡åŒ€çš„æ•°æ®åˆ†å¸ƒç­–ç•¥</li>
<li>æ”¯æŒåŠ¨æ€é€‚é…ä¸åŒçš„å¹¶è¡Œåº¦å’Œåˆ†åŒºæ•°</li>
</ol>
<h3 data-id="heading-7">2.2 ç±»ç»“æ„åˆ†æ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomRangePartitioner</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FlinkKafkaPartitioner</span>&lt;RuleMatchResult&gt;
        <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
    
    <span class="hljs-comment">// ç”¨äºè®°å½•ä¸åŒTopicçš„æ¶ˆæ¯è®¡æ•°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ConcurrentHashMap&lt;String, AtomicInteger&gt; topicCountMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-comment">// å½“å‰å­ä»»åŠ¡IDå’Œæ€»å¹¶è¡Œåº¦</span>
    <span class="hljs-keyword">private</span> Integer parallelInstanceId;
    <span class="hljs-keyword">private</span> Integer parallelInstances;
}
</code></pre>
<p>å…³é”®æˆå‘˜å˜é‡è¯´æ˜ï¼š</p>
<ul>
<li><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">topicCountMap</a>ï¼šç”¨äºè·Ÿè¸ªæ¯ä¸ªTopicçš„æ¶ˆæ¯è®¡æ•°ï¼Œå®ç°è½®è¯¢åˆ†é…</li>
<li><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">parallelInstanceId</a>ï¼šå½“å‰Flinkå­ä»»åŠ¡çš„å®ä¾‹ID</li>
<li><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">parallelInstances</a>ï¼šæ€»çš„å¹¶è¡Œå®ä¾‹æ•°</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€æ ¸å¿ƒå®ç°åŸç†</h2>
<h3 data-id="heading-9">3.1 åˆå§‹åŒ–é˜¶æ®µ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">open</span><span class="hljs-params">(<span class="hljs-type">int</span> parallelInstanceId, <span class="hljs-type">int</span> parallelInstances)</span> {
    Preconditions.checkArgument(parallelInstanceId &gt;=<span class="hljs-number">0</span>, <span class="hljs-string">"Id of subTask cannot be negative"</span>);
    Preconditions.checkArgument(parallelInstances &gt; <span class="hljs-number">0</span>, <span class="hljs-string">"Number of subtasks must be large than 0"</span>);
    <span class="hljs-built_in">this</span>.parallelInstanceId = parallelInstanceId;
    <span class="hljs-built_in">this</span>.parallelInstances = parallelInstances;
}
</code></pre>
<p>åœ¨Flinkä»»åŠ¡å¯åŠ¨æ—¶ï¼Œ<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">open</a>æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œåˆå§‹åŒ–å½“å‰å­ä»»åŠ¡çš„ç›¸å…³å‚æ•°ã€‚</p>
<h3 data-id="heading-10">3.2 åˆ†åŒºé€‰æ‹©é€»è¾‘</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">partition</span><span class="hljs-params">(
        RuleMatchResult next,
        <span class="hljs-type">byte</span>[] serializedKey,
        <span class="hljs-type">byte</span>[] serializedValue,
        String targetTopic,
        <span class="hljs-type">int</span>[] partitions)</span> {
    
    <span class="hljs-type">int</span>[] targetPartitions = computePartitions(partitions);
    <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> targetPartitions.length;
    <span class="hljs-keyword">if</span> (length == <span class="hljs-number">1</span>){
        <span class="hljs-keyword">return</span> targetPartitions[<span class="hljs-number">0</span>];
    }<span class="hljs-keyword">else</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> nextValue(targetTopic);
        <span class="hljs-keyword">return</span> targetPartitions[length % count];
    }
}
</code></pre>
<p>åˆ†åŒºé€‰æ‹©è¿‡ç¨‹ï¼š</p>
<ol>
<li>è°ƒç”¨<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">computePartitions</a>æ–¹æ³•æ ¹æ®å¹¶è¡Œåº¦å’Œåˆ†åŒºæ•°è®¡ç®—å½“å‰å­ä»»åŠ¡å¯å†™çš„åˆ†åŒºåˆ—è¡¨</li>
<li>å¦‚æœåªæœ‰ä¸€ä¸ªå¯å†™åˆ†åŒºï¼Œç›´æ¥è¿”å›è¯¥åˆ†åŒº</li>
<li>å¦‚æœæœ‰å¤šä¸ªå¯å†™åˆ†åŒºï¼Œé€šè¿‡<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">nextValue</a>è·å–è¯¥Topicçš„æ¶ˆæ¯è®¡æ•°ï¼Œä½¿ç”¨å–æ¨¡è¿ç®—å®ç°è½®è¯¢åˆ†é…</li>
</ol>
<h3 data-id="heading-11">3.3 åˆ†åŒºè®¡ç®—ç®—æ³•</h3>
<p><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">computePartitions</a>æ–¹æ³•æ˜¯æ•´ä¸ªåˆ†åŒºå™¨çš„æ ¸å¿ƒï¼Œå…¶å®ç°äº†ä¸‰ç§æƒ…å†µçš„å¤„ç†ï¼š</p>
<h4 data-id="heading-12">æƒ…å†µä¸€ï¼šåˆ†åŒºæ•°ç­‰äºå¹¶è¡Œåº¦</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (partitions.length == parallelInstances){
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]{partitions[parallelInstanceId % partitions.length]};
}
</code></pre>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªFlinkå­ä»»åŠ¡å›ºå®šå†™å…¥ä¸€ä¸ªå¯¹åº”çš„Kafkaåˆ†åŒºï¼Œå®ç°ä¸€ä¸€æ˜ å°„ã€‚</p>
<p><strong>ç¤ºä¾‹æ•°æ®ï¼š</strong>
å‡è®¾æˆ‘ä»¬æœ‰4ä¸ªKafkaåˆ†åŒº[0,1,2,3]ï¼ŒFlinkå¹¶è¡Œåº¦ä¸º4ï¼š</p>
<ul>
<li>å­ä»»åŠ¡0è´Ÿè´£åˆ†åŒºï¼š0</li>
<li>å­ä»»åŠ¡1è´Ÿè´£åˆ†åŒºï¼š1</li>
<li>å­ä»»åŠ¡2è´Ÿè´£åˆ†åŒºï¼š2</li>
<li>å­ä»»åŠ¡3è´Ÿè´£åˆ†åŒºï¼š3</li>
</ul>
<h4 data-id="heading-13">æƒ…å†µäºŒï¼šåˆ†åŒºæ•°å¤§äºå¹¶è¡Œåº¦</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (partitions.length &gt; parallelInstances){
    <span class="hljs-comment">//å¹¶è¡Œåº¦å°äºåˆ†åŒºæ•°</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>)Math.ceil((<span class="hljs-type">float</span>) partitions.length / parallelInstances);
    List&lt;Integer&gt;  parallelPartitionList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;i++){
        <span class="hljs-type">int</span> <span class="hljs-variable">partitionIndex</span> <span class="hljs-operator">=</span> parallelInstanceId + (i * parallelInstances);
        <span class="hljs-keyword">if</span> ((partitionIndex + <span class="hljs-number">1</span>) &lt;= partitions.length){
            parallelPartitionList.add(partitions[partitionIndex]);
        }
    }
    <span class="hljs-comment">// ... è½¬æ¢ä¸ºæ•°ç»„è¿”å›</span>
}
</code></pre>
<p>è¿™æ˜¯æœ€å¤æ‚çš„æƒ…å†µï¼Œé‡‡ç”¨å¾ªç¯åˆ†é…ç­–ç•¥ï¼š</p>
<ol>
<li>è®¡ç®—æ¯ä¸ªå­ä»»åŠ¡éœ€è¦è´Ÿè´£çš„åˆ†åŒºæ•°ï¼š<code>m = ceil(åˆ†åŒºæ•°/å¹¶è¡Œåº¦)</code></li>
<li>æ¯ä¸ªå­ä»»åŠ¡è´Ÿè´£çš„åˆ†åŒºç´¢å¼•ä¸ºï¼š<code>parallelInstanceId + (i * parallelInstances)</code>ï¼Œå…¶ä¸­iä»0åˆ°m-1</li>
<li>è¿™æ ·ç¡®ä¿äº†åˆ†åŒºå°½å¯èƒ½å‡åŒ€åœ°åˆ†é…ç»™å„ä¸ªå­ä»»åŠ¡</li>
</ol>
<p><strong>ç¤ºä¾‹æ•°æ®ï¼š</strong>
å‡è®¾æˆ‘ä»¬æœ‰18ä¸ªKafkaåˆ†åŒº[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]ï¼ŒFlinkå¹¶è¡Œåº¦ä¸º9ï¼š</p>
<p>è®¡ç®—æ¯ä¸ªå­ä»»åŠ¡è´Ÿè´£çš„åˆ†åŒºæ•°ï¼š<code>m = ceil(18/9) = 2</code></p>
<ul>
<li>å­ä»»åŠ¡0è´Ÿè´£åˆ†åŒºï¼š0, 9</li>
<li>å­ä»»åŠ¡1è´Ÿè´£åˆ†åŒºï¼š1, 10</li>
<li>å­ä»»åŠ¡2è´Ÿè´£åˆ†åŒºï¼š2, 11</li>
<li>å­ä»»åŠ¡3è´Ÿè´£åˆ†åŒºï¼š3, 12</li>
<li>å­ä»»åŠ¡4è´Ÿè´£åˆ†åŒºï¼š4, 13</li>
<li>å­ä»»åŠ¡5è´Ÿè´£åˆ†åŒºï¼š5, 14</li>
<li>å­ä»»åŠ¡6è´Ÿè´£åˆ†åŒºï¼š6, 15</li>
<li>å­ä»»åŠ¡7è´Ÿè´£åˆ†åŒºï¼š7, 16</li>
<li>å­ä»»åŠ¡8è´Ÿè´£åˆ†åŒºï¼š8, 17</li>
</ul>
<p>è¿™æ ·æ¯ä¸ªå­ä»»åŠ¡éƒ½è´Ÿè´£2ä¸ªåˆ†åŒºï¼Œå®ç°äº†å®Œå…¨å‡åŒ€çš„åˆ†é…ã€‚</p>
<p><strong>å¦ä¸€ä¸ªç¤ºä¾‹ï¼š</strong>
å¦‚æœæœ‰20ä¸ªKafkaåˆ†åŒº[0-19]ï¼ŒFlinkå¹¶è¡Œåº¦ä¸º6ï¼š</p>
<p>è®¡ç®—æ¯ä¸ªå­ä»»åŠ¡è´Ÿè´£çš„åˆ†åŒºæ•°ï¼š<code>m = ceil(20/6) = 4</code></p>
<ul>
<li>å­ä»»åŠ¡0è´Ÿè´£åˆ†åŒºï¼š0, 6, 12, 18</li>
<li>å­ä»»åŠ¡1è´Ÿè´£åˆ†åŒºï¼š1, 7, 13, 19</li>
<li>å­ä»»åŠ¡2è´Ÿè´£åˆ†åŒºï¼š2, 8, 14</li>
<li>å­ä»»åŠ¡3è´Ÿè´£åˆ†åŒºï¼š3, 9, 15</li>
<li>å­ä»»åŠ¡4è´Ÿè´£åˆ†åŒºï¼š4, 10, 16</li>
<li>å­ä»»åŠ¡5è´Ÿè´£åˆ†åŒºï¼š5, 11, 17</li>
</ul>
<p>æ³¨æ„è¿™é‡Œåªæœ‰å‰ä¸¤ä¸ªå­ä»»åŠ¡è´Ÿè´£4ä¸ªåˆ†åŒºï¼Œå…¶ä½™å­ä»»åŠ¡åªè´Ÿè´£3ä¸ªåˆ†åŒºï¼Œè¿™æ˜¯å› ä¸º20ä¸èƒ½è¢«6æ•´é™¤ã€‚</p>
<h4 data-id="heading-14">æƒ…å†µä¸‰ï¼šåˆ†åŒºæ•°å°äºå¹¶è¡Œåº¦</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">else</span> {
    <span class="hljs-comment">//å¹¶è¡Œåº¦å¤§äºåˆ†åŒºæ•°</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]{partitions[parallelInstanceId % partitions.length]};
}
</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤šä¸ªå­ä»»åŠ¡ä¼šå…±äº«åŒä¸€ä¸ªåˆ†åŒºï¼Œé€šè¿‡å–æ¨¡è¿ç®—ç¡®å®šå…·ä½“å†™å…¥å“ªä¸ªåˆ†åŒºã€‚</p>
<p><strong>ç¤ºä¾‹æ•°æ®ï¼š</strong>
å‡è®¾æˆ‘ä»¬æœ‰4ä¸ªKafkaåˆ†åŒº[0,1,2,3]ï¼ŒFlinkå¹¶è¡Œåº¦ä¸º8ï¼š</p>
<ul>
<li>å­ä»»åŠ¡0è´Ÿè´£åˆ†åŒºï¼š0 (0 % 4)</li>
<li>å­ä»»åŠ¡1è´Ÿè´£åˆ†åŒºï¼š1 (1 % 4)</li>
<li>å­ä»»åŠ¡2è´Ÿè´£åˆ†åŒºï¼š2 (2 % 4)</li>
<li>å­ä»»åŠ¡3è´Ÿè´£åˆ†åŒºï¼š3 (3 % 4)</li>
<li>å­ä»»åŠ¡4è´Ÿè´£åˆ†åŒºï¼š0 (4 % 4)</li>
<li>å­ä»»åŠ¡5è´Ÿè´£åˆ†åŒºï¼š1 (5 % 4)</li>
<li>å­ä»»åŠ¡6è´Ÿè´£åˆ†åŒºï¼š2 (6 % 4)</li>
<li>å­ä»»åŠ¡7è´Ÿè´£åˆ†åŒºï¼š3 (7 % 4)</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸¤ä¸ªå­ä»»åŠ¡ä¼šå…±äº«åŒä¸€ä¸ªåˆ†åŒºã€‚</p>
<h3 data-id="heading-15">3.4 è½®è¯¢æœºåˆ¶å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">nextValue</span><span class="hljs-params">(String topic)</span>{
    <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">counter</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.topicCountMap.computeIfAbsent(topic ,(k) -&gt; { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);});
    <span class="hljs-keyword">return</span> counter.getAndIncrement();
}
</code></pre>
<p>é€šè¿‡<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">topicCountMap</a>è®°å½•æ¯ä¸ªTopicçš„æ¶ˆæ¯è®¡æ•°ï¼Œåœ¨å¤šä¸ªå¯å†™åˆ†åŒºä¹‹é—´å®ç°è½®è¯¢åˆ†é…ï¼Œé¿å…æ•°æ®å€¾æ–œã€‚</p>
<p><strong>ç¤ºä¾‹æ•°æ®ï¼š</strong>
å‡è®¾å­ä»»åŠ¡0è´Ÿè´£åˆ†åŒº[0, 9]ï¼Œè¿ç»­å‘é€5æ¡æ¶ˆæ¯åˆ°"alg-result"ä¸»é¢˜ï¼š</p>
<ol>
<li>ç¬¬1æ¡æ¶ˆæ¯ï¼šcount=0, targetPartitions=[0,9], index=2%0=0, å†™å…¥åˆ†åŒº0</li>
<li>ç¬¬2æ¡æ¶ˆæ¯ï¼šcount=1, targetPartitions=[0,9], index=2%1=1, å†™å…¥åˆ†åŒº9</li>
<li>ç¬¬3æ¡æ¶ˆæ¯ï¼šcount=2, targetPartitions=[0,9], index=2%2=0, å†™å…¥åˆ†åŒº0</li>
<li>ç¬¬4æ¡æ¶ˆæ¯ï¼šcount=3, targetPartitions=[0,9], index=2%3=2, è¶…å‡ºèŒƒå›´ï¼Œå®é™…å†™å…¥åˆ†åŒº0ï¼ˆæ­¤å¤„ä»£ç å¯èƒ½å­˜åœ¨é—®é¢˜ï¼‰</li>
<li>ç¬¬5æ¡æ¶ˆæ¯ï¼šcount=4, targetPartitions=[0,9], index=2%4=2, è¶…å‡ºèŒƒå›´ï¼Œå®é™…å†™å…¥åˆ†åŒº0</li>
</ol>
<p>æ³¨æ„ï¼šè¿™é‡Œçš„è½®è¯¢æœºåˆ¶åœ¨æºç ä¸­å¯èƒ½å­˜åœ¨ä¸€ä¸ªå°é—®é¢˜ï¼Œåº”è¯¥æ˜¯<code>count % length</code>è€Œä¸æ˜¯<code>length % count</code>ã€‚</p>
<h2 data-id="heading-16">å››ã€åº”ç”¨åœºæ™¯ä¸ä¼˜åŠ¿</h2>
<h3 data-id="heading-17">4.1 åº”ç”¨åœºæ™¯</h3>
<p><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">CustomRangePartitioner</a>é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p>
<ol>
<li>Flinkå‘Kafkaå†™å…¥æ•°æ®æ—¶éœ€è¦ä¿è¯åˆ†åŒºå‡åŒ€åˆ†å¸ƒ</li>
<li>åŠ¨æ€è°ƒæ•´Flinkä½œä¸šå¹¶è¡Œåº¦æ—¶ä»éœ€ä¿æŒè‰¯å¥½çš„åˆ†åŒºç­–ç•¥</li>
<li>éœ€è¦é¿å…åŸç”Ÿåˆ†åŒºå™¨å¯¼è‡´çš„éƒ¨åˆ†åˆ†åŒºæ— æ•°æ®å†™å…¥çš„é—®é¢˜</li>
</ol>
<h3 data-id="heading-18">4.2 ä¸»è¦ä¼˜åŠ¿</h3>
<ol>
<li><strong>å‡åŒ€åˆ†å¸ƒ</strong>ï¼šé€šè¿‡åˆç†çš„ç®—æ³•ç¡®ä¿æ•°æ®åœ¨å„åˆ†åŒºé—´çš„å‡åŒ€åˆ†å¸ƒ</li>
<li><strong>åŠ¨æ€é€‚åº”</strong>ï¼šèƒ½å¤Ÿè‡ªé€‚åº”ä¸åŒçš„å¹¶è¡Œåº¦å’Œåˆ†åŒºæ•°é…ç½®</li>
<li><strong>é¿å…çƒ­ç‚¹</strong>ï¼šé€šè¿‡è½®è¯¢æœºåˆ¶é¿å…æŸäº›åˆ†åŒºæˆä¸ºçƒ­ç‚¹</li>
<li><strong>å…¼å®¹æ€§å¼º</strong>ï¼šå…¼å®¹å„ç§å¹¶è¡Œåº¦ä¸åˆ†åŒºæ•°çš„å…³ç³»</li>
</ol>
<h2 data-id="heading-19">äº”ã€ä½¿ç”¨ç¤ºä¾‹</h2>
<p>åœ¨<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">DistrbuteJobMain.java</a>ä¸­ï¼Œ<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">CustomRangePartitioner</a>è¢«è¿™æ ·ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">FlinkKafkaMutliSink</span> <span class="hljs-variable">distrbuteSink</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FlinkKafkaMutliSink</span>(
    <span class="hljs-string">"default-topic"</span>, 
    routeDistrute, 
    properties, 
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomRangePartitioner</span>());

<span class="hljs-comment">//åŒ¹é…çš„ç®—æ³•ç»“æœè¾“å‡ºåˆ°kafka</span>
ruleMatchResultDataStream.addSink(distrbuteSink);
</code></pre>
<p>é€šè¿‡å°†<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">CustomRangePartitioner</a>å®ä¾‹ä¼ é€’ç»™<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">FlinkKafkaMutliSink</a>ï¼Œå®ç°äº†åŸºäºè‡ªå®šä¹‰ç­–ç•¥çš„æ•°æ®åˆ†å‘ã€‚</p>
<h2 data-id="heading-20">å…­ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
<h3 data-id="heading-21">6.1 åˆç†è®¾ç½®å¹¶è¡Œåº¦</h3>
<p>æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚å’ŒKafkaé›†ç¾¤èƒ½åŠ›ï¼Œåˆç†è®¾ç½®Flinkä½œä¸šçš„å¹¶è¡Œåº¦ï¼š</p>
<ul>
<li>å¹¶è¡Œåº¦è¿‡ä½ä¼šå¯¼è‡´èµ„æºåˆ©ç”¨ä¸å……åˆ†</li>
<li>å¹¶è¡Œåº¦è¿‡é«˜ä¼šå¢åŠ ç³»ç»Ÿå¼€é”€å’ŒçŠ¶æ€ç®¡ç†å¤æ‚åº¦</li>
</ul>
<h3 data-id="heading-22">6.2 ç›‘æ§åˆ†åŒºåˆ†å¸ƒ</h3>
<p>å®šæœŸç›‘æ§å„åˆ†åŒºçš„æ•°æ®åˆ†å¸ƒæƒ…å†µï¼ŒåŠæ—¶å‘ç°å’Œè§£å†³æ•°æ®å€¾æ–œé—®é¢˜ã€‚</p>
<h3 data-id="heading-23">6.3 è°ƒæ•´åˆ†åŒºæ•°</h3>
<p>æ ¹æ®æ•°æ®é‡å’Œååé‡éœ€æ±‚ï¼Œé€‚å½“è°ƒæ•´Kafka Topicçš„åˆ†åŒºæ•°ï¼Œä½¿å…¶ä¸Flinkå¹¶è¡Œåº¦ä¿æŒåˆç†æ¯”ä¾‹ã€‚</p>
<h2 data-id="heading-24">ç»“è®º</h2>
<p><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">CustomRangePartitioner</a>é€šè¿‡å·§å¦™çš„ç®—æ³•è®¾è®¡ï¼Œæœ‰æ•ˆè§£å†³äº†Flinkå‘Kafkaå†™å…¥æ•°æ®æ—¶çš„åˆ†åŒºä¸å‡è¡¡é—®é¢˜ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨ä¿è¯æ•°æ®åˆ†å¸ƒå‡åŒ€çš„å‰æä¸‹ï¼ŒåŠ¨æ€é€‚é…ä¸åŒçš„å¹¶è¡Œåº¦å’Œåˆ†åŒºæ•°é…ç½®ã€‚é€šè¿‡å¯¹è¯¥ç±»æºç çš„æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°ç†è§£Flinkä¸Kafkaé›†æˆæ—¶çš„åˆ†åŒºç­–ç•¥è®¾è®¡ï¼Œå¹¶åœ¨å®é™…é¡¹ç›®ä¸­çµæ´»åº”ç”¨ç±»ä¼¼çš„è§£å†³æ–¹æ¡ˆæ¥ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ—“ï¸ 2262å¹´å°†æœ‰ä¸¤ä¸ªæ˜¥èŠ‚ï¼ä½œä¸ºå‰ç«¯çš„ä½ ï¼Œæ—¥å†æ§ä»¶çœŸçš„å†™å¯¹äº†å—ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584711683773693952</link>    <guid>https://juejin.cn/post/7584711683773693952</guid>    <pubDate>2025-12-18T02:56:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584711683773693952" data-draft-id="7584761090668691456" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ—“ï¸ 2262å¹´å°†æœ‰ä¸¤ä¸ªæ˜¥èŠ‚ï¼ä½œä¸ºå‰ç«¯çš„ä½ ï¼Œæ—¥å†æ§ä»¶çœŸçš„å†™å¯¹äº†å—ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-18T02:56:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¶ˆé˜²å¤§é˜ŸVUEæ”¯é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2629687540989096"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ—“ï¸ 2262å¹´å°†æœ‰ä¸¤ä¸ªæ˜¥èŠ‚ï¼ä½œä¸ºå‰ç«¯çš„ä½ ï¼Œæ—¥å†æ§ä»¶çœŸçš„å†™å¯¹äº†å—ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2629687540989096/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¶ˆé˜²å¤§é˜ŸVUEæ”¯é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T02:56:39.000Z" title="Thu Dec 18 2025 02:56:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    36
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŠ å‰è¨€ï¼šä¸€ä¸ªæœ‰è¶£çš„å¤©æ–‡å†æ³•ç°è±¡</h2>
<p>æœ€è¿‘ï¼Œä¸€åˆ™"2262å¹´å°†æœ‰ä¸¤ä¸ªæ˜¥èŠ‚"çš„æ–°é—»åœ¨ç½‘ç»œä¸Šå¼•èµ·äº†çƒ­è®®ã€‚æ²¡é”™ï¼Œä½ æ²¡æœ‰çœ‹é”™ï¼åœ¨237å¹´åçš„2262å¹´ï¼Œæˆ‘ä»¬çš„å­å­™åä»£å°†è¿æ¥ä¸€ä¸ªç½•è§çš„å¤©æ–‡å†æ³•ç°è±¡â€”â€”<strong>é—°æ­£æœˆ</strong>ï¼Œè¿™æ„å‘³ç€ä¸€å¹´å†…ä¼šå‡ºç°ä¸¤ä¸ªæ˜¥èŠ‚ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªæ˜¥èŠ‚ï¼š2262å¹´1æœˆ21æ—¥</li>
<li>ç¬¬äºŒä¸ªæ˜¥èŠ‚ï¼š2262å¹´2æœˆ20æ—¥</li>
</ul>
<p>è¿™æ˜¯è‡ª1640å¹´ä»¥æ¥ï¼Œæ—¶éš”600å¤šå¹´å†æ¬¡å‡ºç°çš„é—°æ­£æœˆç°è±¡ã€‚ä»å…¬å…ƒ1645å¹´ä½¿ç”¨å†ç†ç½®é—°åˆ¶å¼€å§‹åˆ°å…¬å…ƒ2800å¹´ï¼Œå†œå†é—°æ­£æœˆåªä¼šå‘ç”Ÿ<strong>6æ¬¡</strong>ï¼</p>
<p>ä½†å¯¹äºæˆ‘ä»¬å‰ç«¯å¼€å‘è€…æ¥è¯´ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæœ‰è¶£çš„å¤©æ–‡çŸ¥è¯†ï¼Œæ›´æ˜¯ä¸€ä¸ªå€¼å¾—æ·±æ€çš„æŠ€æœ¯é—®é¢˜ï¼š<strong>ä½ çš„æ—¥å†æ§ä»¶å‡†å¤‡å¥½åº”å¯¹è¿™ç§æç«¯æƒ…å†µäº†å—ï¼Ÿ</strong></p>
<h2 data-id="heading-1">â° æ—¶é—´ç‚¸å¼¹ï¼š2262å¹´çš„åŒé‡å±æœº</h2>
<h3 data-id="heading-2">å±æœºä¸€ï¼šé—°æ­£æœˆçš„å†œå†è®¡ç®—</h3>
<p>å¯¹äºéœ€è¦æ”¯æŒå†œå†åŠŸèƒ½çš„æ—¥å†ç»„ä»¶æ¥è¯´ï¼Œé—°æ­£æœˆæ˜¯ä¸€ä¸ªæå…¶ç½•è§ä½†å¿…é¡»è€ƒè™‘çš„è¾¹ç•Œæƒ…å†µã€‚å¤§å¤šæ•°å‰ç«¯æ—¥å†åº“åœ¨å¤„ç†å†œå†æ—¶ï¼Œå¯èƒ½å¹¶æ²¡æœ‰å……åˆ†æµ‹è¯•è¿™ç§åœºæ™¯ã€‚</p>
<p><strong>å¸¸è§é—®é¢˜ï¼š</strong></p>
<ol>
<li>å†œå†è½¬æ¢ç®—æ³•æ˜¯å¦æ”¯æŒé—°æ­£æœˆï¼Ÿ</li>
<li>èŠ‚å‡æ—¥è®¡ç®—é€»è¾‘æ˜¯å¦ä¼šå‡ºé”™ï¼Ÿ</li>
<li>ç”¨æˆ·é€‰æ‹©ç¬¬äºŒä¸ªæ­£æœˆåˆä¸€æ—¶ï¼Œåç«¯èƒ½æ­£ç¡®è¯†åˆ«å—ï¼Ÿ</li>
</ol>
<h3 data-id="heading-3">å±æœºäºŒï¼šçº³ç§’æ—¶é—´æˆ³æº¢å‡º</h3>
<p>æ›´ä¸¥é‡çš„æ˜¯ï¼Œ2262å¹´è¿˜éšè—ç€ä¸€ä¸ª<strong>æ—¶é—´ç‚¸å¼¹</strong>ï¼</p>
<p>ä½¿ç”¨64ä½æœ‰ç¬¦å·æ•´æ•°å­˜å‚¨<strong>çº³ç§’çº§</strong>æ—¶é—´æˆ³çš„ç³»ç»Ÿï¼Œå°†åœ¨ <strong>2262å¹´4æœˆ11æ—¥ 23:47:16 UTC</strong> å‘ç”Ÿæº¢å‡ºã€‚è¿™å½±å“åˆ°ï¼š</p>
<ul>
<li>Python pandas çš„ Timestamp å¯¹è±¡</li>
<li>PostgreSQL çš„éƒ¨åˆ†æ—¶é—´å‡½æ•°</li>
<li>Go è¯­è¨€çš„ UnixNano API</li>
<li>C++ chrono åº“ï¼ˆçº³ç§’ç²¾åº¦ï¼‰</li>
<li>QEMU å®šæ—¶å™¨</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Python pandas çš„å‘</span>
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-comment"># pandas çš„æ—¶é—´èŒƒå›´çº¦ä¸º 1678 AD - 2262 AD</span>
pd.Timestamp.<span class="hljs-built_in">max</span>
<span class="hljs-comment"># Timestamp('2262-04-11 23:47:16.854775807')</span>

<span class="hljs-comment"># è¶…å‡ºèŒƒå›´ä¼šæŠ¥é”™</span>
pd.Timestamp(<span class="hljs-string">'2262-04-12'</span>)
<span class="hljs-comment"># OutOfBoundsDatetime: Out of bounds nanosecond timestamp</span>
</code></pre>
<h2 data-id="heading-4">ğŸ¤” JavaScript è¡¨ç°å¦‚ä½•ï¼Ÿ</h2>
<p>å¥½æ¶ˆæ¯æ˜¯ï¼ŒJavaScript çš„ Date å¯¹è±¡ä¸ä¼šå—åˆ°2262å¹´çš„å½±å“ï¼</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// JavaScript Date çš„æ—¶é—´èŒƒå›´</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(-<span class="hljs-number">8640000000000000</span>)); <span class="hljs-comment">// -271821-04-20</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">8640000000000000</span>));  <span class="hljs-comment">// 275760-09-13</span>

<span class="hljs-comment">// 2262å¹´ï¼Ÿå°èœä¸€ç¢Ÿï¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2262-02-20'</span>)); <span class="hljs-comment">// å®Œå…¨æ²¡é—®é¢˜</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2262-04-11'</span>)); <span class="hljs-comment">// ä¹Ÿæ²¡é—®é¢˜</span>
</code></pre>
<p>JavaScript ä½¿ç”¨<strong>æ¯«ç§’çº§</strong>æ—¶é—´æˆ³ï¼Œå¯ä»¥è¡¨ç¤ºçš„èŒƒå›´æ˜¯<strong>çº¦Â±100,000,000å¤©</strong>ï¼ˆç›¸å¯¹äº1970-01-01ï¼‰ï¼Œè¿™è®©å®ƒå¯ä»¥è½»æ¾å¤„ç†å…¬å…ƒå‰271821å¹´åˆ°å…¬å…ƒ275760å¹´çš„æ—¥æœŸã€‚</p>
<p><strong>ä½†è¿™ä¸æ„å‘³ç€ä½ å¯ä»¥é«˜æ•æ— å¿§ï¼</strong></p>
<h2 data-id="heading-5">âš ï¸ å‰ç«¯æ—¥å†ç»„ä»¶çš„å¸¸è§é™·é˜±</h2>
<h3 data-id="heading-6">1. æ—¥æœŸèŒƒå›´é™åˆ¶ä¸å½“</h3>
<p>è®¸å¤šå‰ç«¯æ—¥å†ç»„ä»¶ä¸ºäº†"ä¼˜åŒ–æ€§èƒ½"æˆ–"é¿å…å¼‚å¸¸"ï¼Œä¼šäººä¸ºè®¾ç½®æ—¥æœŸèŒƒå›´é™åˆ¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æŸäº›ç»„ä»¶çš„é»˜è®¤é…ç½®</span>
<span class="hljs-keyword">const</span> datePicker = {
  <span class="hljs-attr">minDate</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">1900</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>),
  <span class="hljs-attr">maxDate</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2099</span>, <span class="hljs-number">11</span>, <span class="hljs-number">31</span>)  <span class="hljs-comment">// âš ï¸ é—®é¢˜åœ¨è¿™é‡Œï¼</span>
}
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong> 2099å¹´çš„é™åˆ¶å°†å¯¼è‡´æ— æ³•é€‰æ‹©2262å¹´çš„æ—¥æœŸï¼</p>
<h3 data-id="heading-7">2. å¹´ä»½è¾“å…¥æ¡†é•¿åº¦é™åˆ¶</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- é”™è¯¯çš„åšæ³• --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">maxlength</span>=<span class="hljs-string">"4"</span> /&gt;</span>

<span class="hljs-comment">&lt;!-- å¦‚æœå°†æ¥éœ€è¦æ”¯æŒ5ä½æ•°å¹´ä»½å‘¢ï¼Ÿ --&gt;</span>
</code></pre>
<h3 data-id="heading-8">3. åç«¯æ¥å£çš„æ—¶é—´æˆ³ç±»å‹</h3>
<p>å‰ç«¯ä¼ é€’æ—¶é—´æˆ³ç»™åç«¯æ—¶ï¼Œéœ€è¦æ³¨æ„åç«¯ä½¿ç”¨çš„æ—¶é—´ç±»å‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯å‘é€</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/calendar'</span>, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
  <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
    <span class="hljs-attr">date</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2262-02-20'</span>).<span class="hljs-title function_">getTime</span>() <span class="hljs-comment">// æ¯«ç§’æ—¶é—´æˆ³</span>
  })
})

<span class="hljs-comment">// åç«¯ï¼ˆPythonï¼‰æ¥æ”¶</span>
<span class="hljs-comment">// å¦‚æœåç«¯ä½¿ç”¨ pandas å¤„ç†ï¼Œå¯èƒ½ä¼šå‡ºé—®é¢˜ï¼</span>
</code></pre>
<h2 data-id="heading-9">ğŸ“‹ ä¸»æµæ—¥å†ç»„ä»¶çš„å¤„ç†æ–¹å¼</h2>
<h3 data-id="heading-10">Ant Design DatePicker</h3>
<p>Ant Design çš„ DatePicker ç»„ä»¶æä¾›äº† <code>disabledDate</code> å±æ€§æ¥é™åˆ¶å¯é€‰æ—¥æœŸèŒƒå›´ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">DatePicker</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span>
  <span class="hljs-attr">disabledDate</span>=<span class="hljs-string">{(current)</span> =&gt;</span> {
    // å¯ä»¥è®¾ç½®åˆç†çš„èŒƒå›´ï¼Œä½†ä¸è¦è¿‡åº¦é™åˆ¶
    return current &amp;&amp; current.year() &gt; 2300;
  }}
/&gt;</span>
</code></pre>
<p><strong>å»ºè®®ï¼š</strong> é™¤éæœ‰æ˜ç¡®çš„ä¸šåŠ¡éœ€æ±‚ï¼Œå¦åˆ™ä¸è¦è®¾ç½®è¿‡äºä¸¥æ ¼çš„æ—¥æœŸé™åˆ¶ã€‚</p>
<h3 data-id="heading-11">Element UI DatePicker</h3>
<p>Element UI åŒæ ·æ”¯æŒé€šè¿‡ <code>picker-options</code> é…ç½®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">pickerOptions</span>: {
  <span class="hljs-title function_">disabledDate</span>(<span class="hljs-params">time</span>) {
    <span class="hljs-comment">// æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚è®¾ç½®</span>
    <span class="hljs-keyword">return</span> time.<span class="hljs-title function_">getFullYear</span>() &gt; <span class="hljs-number">2300</span>;
  }
}
</code></pre>
<h2 data-id="heading-12">ğŸ’¡ æœ€ä½³å®è·µå»ºè®®</h2>
<h3 data-id="heading-13">1. é¿å…ç¡¬ç¼–ç æ—¥æœŸèŒƒå›´</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ä¸å¥½çš„åšæ³•</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_YEAR</span> = <span class="hljs-number">2099</span>;

<span class="hljs-comment">// âœ… æ›´å¥½çš„åšæ³•</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_YEAR</span> = <span class="hljs-title class_">Number</span>.<span class="hljs-property">MAX_SAFE_INTEGER</span>; <span class="hljs-comment">// æˆ–æ ¹æ®ä¸šåŠ¡å®é™…éœ€æ±‚</span>

<span class="hljs-comment">// âœ… æœ€å¥½çš„åšæ³•ï¼šä»ä¸šåŠ¡é…ç½®ä¸­è·å–</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_YEAR</span> = config.<span class="hljs-property">calendar</span>.<span class="hljs-property">maxYear</span> || <span class="hljs-number">2300</span>;
</code></pre>
<h3 data-id="heading-14">2. å……åˆ†æµ‹è¯•è¾¹ç•Œæƒ…å†µ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'DatePickerè¾¹ç•Œæµ‹è¯•'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">it</span>(<span class="hljs-string">'åº”è¯¥æ”¯æŒ2262å¹´çš„æ—¥æœŸ'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2262-02-20'</span>);
    <span class="hljs-title function_">expect</span>(datePicker.<span class="hljs-title function_">isValidDate</span>(date)).<span class="hljs-title function_">toBe</span>(<span class="hljs-literal">true</span>);
  });
  
  <span class="hljs-title function_">it</span>(<span class="hljs-string">'åº”è¯¥æ”¯æŒé—°æ­£æœˆ'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> lunarDate = lunar.<span class="hljs-title function_">toLunar</span>(<span class="hljs-string">'2262-02-20'</span>);
    <span class="hljs-title function_">expect</span>(lunarDate.<span class="hljs-property">month</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// ç¬¬äºŒä¸ªæ­£æœˆ</span>
    <span class="hljs-title function_">expect</span>(lunarDate.<span class="hljs-property">isLeap</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-literal">true</span>);
  });
});
</code></pre>
<h3 data-id="heading-15">3. ä¸åç«¯åå•†ç»Ÿä¸€çš„æ—¶é—´æ ¼å¼</h3>
<ul>
<li>ä¼˜å…ˆä½¿ç”¨ ISO 8601 æ ¼å¼å­—ç¬¦ä¸²ä¼ é€’æ—¥æœŸ</li>
<li>é¿å…ç›´æ¥ä¼ é€’æ—¶é—´æˆ³ï¼ˆå°¤å…¶æ˜¯çº³ç§’çº§ï¼‰</li>
<li>åœ¨æ¥å£æ–‡æ¡£ä¸­æ˜ç¡®è¯´æ˜æ”¯æŒçš„æ—¥æœŸèŒƒå›´</li>
</ul>
<h3 data-id="heading-16">4. ä¸ºæœªæ¥ç•™æœ‰ä½™åœ°</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è€ƒè™‘ä½¿ç”¨ Day.js æˆ– date-fns ç­‰ç°ä»£æ—¥æœŸåº“</span>
<span class="hljs-keyword">import</span> dayjs <span class="hljs-keyword">from</span> <span class="hljs-string">'dayjs'</span>;

<span class="hljs-comment">// è¿™äº›åº“é€šå¸¸æœ‰æ›´å¥½çš„è¾¹ç•Œå¤„ç†</span>
<span class="hljs-keyword">const</span> futureDate = <span class="hljs-title function_">dayjs</span>(<span class="hljs-string">'2262-02-20'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(futureDate.<span class="hljs-title function_">isValid</span>()); <span class="hljs-comment">// true</span>
</code></pre>
<h2 data-id="heading-17">ğŸ”§ å·¥å…·æ¨è</h2>
<p>è¯´åˆ°å¼€å‘æ•ˆç‡ï¼Œæœ€è¿‘æˆ‘åœ¨ä½¿ç”¨ <strong>Claude Code</strong> æ¥è¾…åŠ©ç¼–å†™è¿™ç±»å¤æ‚çš„æ—¥æœŸå¤„ç†é€»è¾‘ï¼Œå®ƒå¯¹è¾¹ç•Œæƒ…å†µçš„å¤„ç†å»ºè®®éå¸¸åˆ°ä½ã€‚å¦‚æœä½ ä¹Ÿæƒ³å°è¯•ï¼Œå¯ä»¥é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.dogenet.win%2Fi%2F6WVAIR9N" target="_blank" title="https://x.dogenet.win/i/6WVAIR9N" ref="nofollow noopener noreferrer">è¿™ä¸ªé“¾æ¥</a> ä½“éªŒå›½å†…ä¼˜åŒ–ç‰ˆæœ¬ã€‚</p>
<h2 data-id="heading-18">ğŸ¯ æ€»ç»“</h2>
<p>è™½ç„¶2262å¹´è·ç¦»æˆ‘ä»¬è¿˜å¾ˆé¥è¿œï¼Œä½†ä½œä¸ºä¸“ä¸šçš„å‰ç«¯å¼€å‘è€…ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š</p>
<ol>
<li><strong>é¿å…ä¸å¿…è¦çš„æ—¥æœŸèŒƒå›´é™åˆ¶</strong> - é™¤éä¸šåŠ¡æ˜ç¡®è¦æ±‚</li>
<li><strong>å……åˆ†æµ‹è¯•è¾¹ç•Œæƒ…å†µ</strong> - åŒ…æ‹¬æå°å€¼å’Œæå¤§å€¼</li>
<li><strong>äº†è§£ä¸åŒæ—¶é—´æˆ³ç²¾åº¦çš„å·®å¼‚</strong> - æ¯«ç§’ vs çº³ç§’</li>
<li><strong>ä¸åç«¯ä¿æŒåŒæ­¥</strong> - ç¡®ä¿æ—¶é—´æ ¼å¼çš„å…¼å®¹æ€§</li>
<li><strong>ä¸ºæœªæ¥ç•™æœ‰ä½™åœ°</strong> - ä¸è¦ç¡¬ç¼–ç é™åˆ¶</li>
</ol>
<p>è®°ä½ï¼š**å¥½çš„ä»£ç ä¸ä»…è¦æ»¡è¶³å½“ä¸‹çš„éœ€æ±‚ï¼Œæ›´è¦ä¸ºæœªæ¥çš„æ‰©å±•ç•™æœ‰ç©ºé—´ã€‚**å³ä½¿ä½ çš„åº”ç”¨å¯èƒ½æ´»ä¸åˆ°2262å¹´ï¼Œä½†è‰¯å¥½çš„ç¼–ç ä¹ æƒ¯å’Œå¯¹è¾¹ç•Œæƒ…å†µçš„é‡è§†ï¼Œä¼šè®©ä½ åœ¨é¢å¯¹å…¶ä»–æç«¯æƒ…å†µæ—¶ä¹Ÿèƒ½æ¸¸åˆƒæœ‰ä½™ã€‚</p>
<hr/>
<p><strong>ä½ é‡åˆ°è¿‡ä»€ä¹ˆå¥‡è‘©çš„æ—¥æœŸå¤„ç†bugå—ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ï¼</strong> ğŸ‘‡</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[10k Star çš„å¼€æº AI è®°å¿†å¼•æ“ï¼š6 è¡Œä»£ç ï¼Œç”¨å›¾è°±+å‘é‡æ‰“é€ æ°¸ä¸é—å¿˜çš„ AI]]></title>    <link>https://juejin.cn/post/7584987267267657738</link>    <guid>https://juejin.cn/post/7584987267267657738</guid>    <pubDate>2025-12-18T03:13:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584987267267657738" data-draft-id="7584725529876742194" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="10k Star çš„å¼€æº AI è®°å¿†å¼•æ“ï¼š6 è¡Œä»£ç ï¼Œç”¨å›¾è°±+å‘é‡æ‰“é€ æ°¸ä¸é—å¿˜çš„ AI"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,GitHub"/> <meta itemprop="datePublished" content="2025-12-18T03:13:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾å°å¤•"/> <meta itemprop="url" content="https://juejin.cn/user/3808363978429613"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            10k Star çš„å¼€æº AI è®°å¿†å¼•æ“ï¼š6 è¡Œä»£ç ï¼Œç”¨å›¾è°±+å‘é‡æ‰“é€ æ°¸ä¸é—å¿˜çš„ AI
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363978429613/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾å°å¤•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:13:04.000Z" title="Thu Dec 18 2025 03:13:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸ŠæœŸå’Œå¤§å®¶åˆ†äº«äº†æˆ‘ä»¬ç²¾å¿ƒæ‰“ç£¨çš„ååŒAIæ–‡æ¡£Â JitWordï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8c327034a1e4265b2d0dabaaa0c6ea0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=zp%2BpJy4nbLRC1l76p%2B46gONiCPY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½œä¸ºä¸€åé•¿æœŸå…³æ³¨å¼€æºå’ŒAIæŠ€æœ¯çš„æŠ€æœ¯åšä¸»ï¼Œæœ€è¿‘å‘ç°äº†ä¸€ä¸ªè®©æˆ‘çœ¼å‰ä¸€äº®çš„é¡¹ç›® â€”â€”Cogneeã€‚å·ç§°åªéœ€è¦ç”¨ 6 è¡Œä»£ç å°±èƒ½ç»™æ™ºèƒ½ä½“è£…ä¸Šâ€œæµ·é©¬ä½“â€ï¼Œ92.5% å‡†ç¡®ç‡ç§’æ€ä¼ ç»Ÿ RAGã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2acfc57dd8504ad99c9db846b9e83690~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=t6f74%2BtQtK8bNuHevr%2FxNgdudz4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>CogneeÂ çš„å®šä½éå¸¸æ¸…æ™°ï¼šå®ƒä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„ AI æ™ºèƒ½ä½“ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„æ•°æ®åº“ï¼Œè€Œæ˜¯ä¸“æ³¨äºè§£å†³ AI ç³»ç»Ÿçš„ "è®°å¿†" é—®é¢˜ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„ AI åŠ©æ‰‹èƒ½å¤Ÿåƒäººç±»ä¸€æ ·è®°ä½è¿‡å»çš„å¯¹è¯ã€å­¦ä¹ è¿‡çš„çŸ¥è¯†ï¼Œå¹¶èƒ½åœ¨éœ€è¦æ—¶å‡†ç¡®è°ƒç”¨ï¼Œé‚£ä¼šæ˜¯æ€æ ·çš„ä½“éªŒï¼Ÿè¿™æ­£æ˜¯Â CogneeÂ æƒ³è¦å®ç°çš„ã€‚</p>
<p>è€è§„çŸ©ï¼Œå…ˆä¸Šé“¾æ¥ã€‚</p>
<p>github åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftopoteretes%2Fcognee%25E4%25BB%258A%25E5%25A4%25A9%25EF%25BC%258C%25E6%2588%2591%25E5%25B0%25B1%25E5%25B8%25A6%25E5%25A4%25A7%25E5%25AE%25B6%25E6%258F%25AD%25E5%25BC%2580%25E5%25AE%2583%25E7%259A%2584%25E7%25A5%259E%25E7%25A7%2598%25E9%259D%25A2%25E7%25BA%25B1%25E3%2580%2582" target="_blank" title="https://github.com/topoteretes/cognee%E4%BB%8A%E5%A4%A9%EF%BC%8C%E6%88%91%E5%B0%B1%E5%B8%A6%E5%A4%A7%E5%AE%B6%E6%8F%AD%E5%BC%80%E5%AE%83%E7%9A%84%E7%A5%9E%E7%A7%98%E9%9D%A2%E7%BA%B1%E3%80%82" ref="nofollow noopener noreferrer">github.com/topoteretesâ€¦</a></p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆè¦ç”¨cognee</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c031757c784401ba9da842b38219082~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=302WOSmYwE56UexpFREWj0rwazc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿‡å»ä¸¤å¹´ï¼Œæˆ‘è°ƒç ”äº†æ•°ä¸æ¸…çš„ RAG æ¡†æ¶ï¼šLangChainã€LlamaIndexã€Haystackâ€¦ å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå…±åŒ bugâ€”â€”â€œé‡‘é±¼è®°å¿†â€ã€‚</p>
<p>å¤šè½®å¯¹è¯ä¸€å¤šï¼ŒLLM å°±å¼€å§‹â€œè£…é™Œç”Ÿâ€ï¼Œé€¼å¾—æˆ‘åå¤æŠŠå†å²æ¶ˆæ¯ç¡¬å¡å›Â Context Windowï¼Œè´µã€æ…¢ã€è¿˜å®¹æ˜“è¶…ã€‚ç›´åˆ°æˆ‘åœ¨ GitHub Trending ç¬¬ä¸€æ åˆ·åˆ°Â cogneeã€‚</p>
<blockquote>
<p>ä¼ ç»Ÿ RAG åªæœ‰â€œå‘é‡â€è¿™ä¸€æŠŠé”¤å­ï¼ŒcogneeÂ çš„æ€è·¯æ˜¯ï¼šâ€œå…ˆæ„å›¾ï¼Œå†å‘é‡åŒ–ï¼›å›¾è´Ÿè´£å…³ç³»ï¼Œå‘é‡è´Ÿè´£è¯­ä¹‰ï¼Œä¸¤è€…äº’è¡¥â€ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a71c17b552f640ec99474b44fd0a2d99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=z699FJMR5yoa3eVUBOncJ9VrcEg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>CogneeÂ çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå®ƒå°†å‘é‡æœç´¢ä¸å›¾æ•°æ®åº“ç›¸ç»“åˆï¼Œè¿™ç§ç»„åˆè®©æ•°æ®æ—¢å¯ä»¥é€šè¿‡è¯­ä¹‰æœç´¢ï¼Œåˆèƒ½é€šè¿‡å…³ç³»è¿æ¥ï¼Œå½¢æˆä¸€ä¸ªçœŸæ­£çš„ "è®°å¿†ç½‘ç»œ"ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªäº®ç‚¹ï¼š</p>
<ol>
<li><strong>ç»Ÿä¸€çš„è®°å¿†å±‚</strong>ï¼šå–ä»£äº†ä¼ ç»Ÿçš„ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ç³»ç»Ÿï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„è®°å¿†å±‚ï¼Œè®© AI èƒ½å¤Ÿæ›´å¥½åœ° "è®°ä½" ä¿¡æ¯ã€‚</li>
<li><strong>å¤šæ¨¡æ€æ•°æ®æ”¯æŒ</strong>ï¼šèƒ½å¤Ÿå¤„ç†å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬è¿‡å»çš„å¯¹è¯ã€æ–‡ä»¶ã€å›¾åƒå’ŒéŸ³é¢‘è½¬å½•ç­‰ã€‚</li>
<li><strong>ECL æµæ°´çº¿</strong>ï¼šåˆ›æ–°çš„ Extractï¼ˆæå–ï¼‰ã€Cognifyï¼ˆè®¤çŸ¥åŒ–ï¼‰ã€Loadï¼ˆåŠ è½½ï¼‰æµæ°´çº¿ï¼Œè®©æ•°æ®å¤„ç†æ›´åŠ é«˜æ•ˆã€‚</li>
<li><strong>çµæ´»çš„éƒ¨ç½²é€‰é¡¹</strong>ï¼šæ—¢å¯ä»¥æœ¬åœ°éƒ¨ç½²ï¼Œå°†æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼›ä¹Ÿå¯ä»¥è¿æ¥åˆ° Cognee Cloudï¼Œä½¿ç”¨æ‰˜ç®¡åŸºç¡€è®¾æ–½ã€‚</li>
<li><strong>é«˜å¯å®šåˆ¶æ€§</strong>ï¼šé€šè¿‡ç”¨æˆ·å®šä¹‰çš„ä»»åŠ¡ã€æ¨¡å—åŒ–æµæ°´çº¿å’Œå†…ç½®çš„æœç´¢ç«¯ç‚¹ï¼Œæ–¹ä¾¿å¼€å‘è€…æ ¹æ®éœ€æ±‚è¿›è¡Œå®šåˆ¶ã€‚</li>
</ol>
<p>è¿™äº›ç‰¹æ€§ä½¿å¾—Â CogneeÂ èƒ½å¤Ÿè§£å†³ä¼ ç»Ÿ AI ç³»ç»Ÿåœ¨è®°å¿†æ–¹é¢çš„å¤šä¸ªç—›ç‚¹ï¼šä¿¡æ¯ç¢ç‰‡åŒ–ã€æ— æ³•å»ºç«‹å…³è”ã€è®°å¿†å®¹é‡æœ‰é™ã€æ£€ç´¢ä¸å‡†ç¡®ç­‰é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">æŠ€æœ¯æ¶æ„å‰–æ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbc61828db2540fe9746c8b279a8ae1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=5ftuulrBBZimdyT4KZbMKma3c4M%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¦ç†è§£Â CogneeÂ çš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å¯ä»¥ä»å®ƒçš„æ¶æ„è®¾è®¡å…¥æ‰‹ã€‚CogneeÂ é‡‡ç”¨äº†æ¨¡å—åŒ–çš„è®¾è®¡ç†å¿µï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9c92a3486a34926957207502f76b611~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=Dwoj2Sr2meOFC6KnORt7nhggb%2Bc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘ä¸ªäººç»“åˆÂ CogneeÂ çš„ ECL æ ¸å¿ƒæµæ°´çº¿ã€æ¨¡å—åŒ–è®¾è®¡ä»¥åŠæ•°æ®å¤„ç†é€»è¾‘ï¼Œç”»äº†ä¸€ä¸ªè¯¦ç»†çš„æ¶æ„è®¾è®¡å›¾ï¼Œå¤§å®¶æ„Ÿå…´è¶£çš„å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/194f91e37ecf444fbda1ea087873b555~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=aBublGY%2FDq2mGb81kB1lTM3mpzE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä»æ•°æ®æµå‘æ¥çœ‹ï¼ŒCogneeÂ çš„å·¥ä½œæµç¨‹éµå¾ª ECL æ¨¡å¼ï¼š</p>
<ol>
<li><strong>Extractï¼ˆæå–ï¼‰</strong> ï¼šä»å„ç§æ•°æ®æºä¸­æå–ä¿¡æ¯ï¼Œå¯ä»¥æ˜¯æ–‡ä»¶ã€æ•°æ®åº“ã€API æ¥å£ç­‰ã€‚è¿™ä¸€å±‚è´Ÿè´£æ•°æ®çš„æ”¶é›†å’Œåˆæ­¥å¤„ç†ã€‚</li>
<li><strong>Cognifyï¼ˆè®¤çŸ¥åŒ–ï¼‰</strong> ï¼šè¿™æ˜¯ Cognee çš„æ ¸å¿ƒç¯èŠ‚ï¼Œå°†åŸå§‹æ•°æ®è½¬åŒ–ä¸ºç»“æ„åŒ–çš„çŸ¥è¯†ã€‚åŒ…æ‹¬å®ä½“è¯†åˆ«ã€å…³ç³»æå–ã€è¯­ä¹‰ç†è§£ç­‰æ­¥éª¤ï¼Œæœ€ç»ˆå½¢æˆçŸ¥è¯†å›¾è°±ã€‚</li>
<li><strong>Loadï¼ˆåŠ è½½ï¼‰</strong> ï¼šå°†å¤„ç†å¥½çš„çŸ¥è¯†å­˜å‚¨åˆ°ç›¸åº”çš„å­˜å‚¨ç³»ç»Ÿä¸­ï¼ŒåŒ…æ‹¬å‘é‡æ•°æ®åº“å’Œå›¾æ•°æ®åº“ï¼Œä»¥ä¾¿åç»­é«˜æ•ˆæ£€ç´¢å’ŒæŸ¥è¯¢ã€‚</li>
</ol>
<p>è¿™ç§æ¶æ„çš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>æ¨¡å—åŒ–è®¾è®¡</strong>å„ç»„ä»¶æ¾è€¦åˆï¼Œä¾¿äºæ‰©å±•å’Œå®šåˆ¶</li>
<li><strong>æ··åˆå­˜å‚¨</strong>ç»“åˆå‘é‡å’Œå›¾æ•°æ®åº“çš„ä¼˜åŠ¿ï¼Œå…¼é¡¾è¯­ä¹‰æœç´¢å’Œå…³ç³»æ¨ç†</li>
<li><strong>å¯æ‰©å±•æ€§</strong>æ”¯æŒåˆ†å¸ƒå¼æ‰§è¡Œï¼Œèƒ½å¤Ÿå¤„ç†å¤§è§„æ¨¡æ•°æ®</li>
<li><strong>çµæ´»æ€§</strong>å¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©ä¸åŒçš„å­˜å‚¨åç«¯å’Œå¤„ç†æ¨¡å—</li>
</ul>
<p>ä¸‹é¢åˆ†äº«ä¸€ä¸ªç®€å•çš„è®¾è®¡åŸç†å›¾ï¼Œæ–¹ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£è®¾è®¡åŸç†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf36f7b9bdf546dc914e0fed7931d898~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=DYLaWoBR%2B65snBOvfZwLuXyK2us%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-2">æ ¸å¿ƒæŠ€æœ¯æ ˆæ¸…å•</h2>
<p>CogneeÂ ä½¿ç”¨çš„æŠ€æœ¯æ ˆè¿˜æ˜¯æ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„ï¼Œå……åˆ†ç»“åˆäº†å½“ä¸‹AI æµè¡Œçš„æŠ€æœ¯æ–¹æ¡ˆç»„åˆï¼š</p>
<ul>
<li><strong>æ ¸å¿ƒè¯­è¨€</strong>Python ğŸï¼ˆè¿™å¯æ˜¯å¾ˆå¤šå¤§å‚éƒ½åœ¨å¤§é‡ä½¿ç”¨çš„è¯­è¨€å“¦ï¼‰</li>
<li><strong>Web æ¡†æ¶</strong>FastAPI ğŸŒ</li>
<li><strong>API è§„èŒƒ</strong>OpenAPI ğŸ“‹</li>
<li><strong>æ•°æ®åº“</strong></li>
<li>
<ul>
<li>å‘é‡æ•°æ®åº“ï¼ˆç”¨äºè¯­ä¹‰æœç´¢ï¼‰</li>
<li>å›¾æ•°æ®åº“ï¼ˆç”¨äºå…³ç³»å­˜å‚¨ï¼‰</li>
</ul>
</li>
<li><strong>å‰ç«¯</strong>Next.js ğŸ’»</li>
<li><strong>å®¹å™¨åŒ–</strong>Docker ğŸ³</li>
<li><strong>éƒ¨ç½²å·¥å…·</strong>Helm ğŸš¢</li>
<li><strong>LLM é›†æˆ</strong>æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹ ğŸ¤–ï¼ˆæ¯”å¦‚èƒ½è”æƒ³åˆ°çš„é‚£äº›å¤§å…¬å¸çš„æ¨¡å‹ï¼‰</li>
<li><strong>ä»»åŠ¡é˜Ÿåˆ—</strong>ç”¨äºåˆ†å¸ƒå¼æ‰§è¡Œ ğŸ”„</li>
<li><strong>æµ‹è¯•å·¥å…·</strong>pytest ğŸ§ª</li>
</ul>
<p>å¦‚æœå¤§å®¶æ°å¥½ä¹Ÿåœ¨åšAIé¡¹ç›®ï¼Œå¯¹æŠ€æœ¯é€‰å‹æ‹¿ä¸å®šä¸»æ„ï¼Œä¸å¦¨å‚è€ƒè¿™ä¸ªæŠ€æœ¯æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-3">åº”ç”¨åœºæ™¯</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1893cc75f05548f48c312483e4874311~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=vHf9q774nRzUqii5Q%2FfXRJZcSFg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>CogneeÂ çš„åº”ç”¨åœºæ™¯éå¸¸å¹¿æ³›ï¼Œå‡ ä¹æ‰€æœ‰éœ€è¦ AI å…·æœ‰è®°å¿†èƒ½åŠ›çš„åœ°æ–¹éƒ½èƒ½æ´¾ä¸Šç”¨åœºï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li><strong>æ™ºèƒ½åŠ©æ‰‹</strong>è®©èŠå¤©æœºå™¨äººèƒ½å¤Ÿè®°ä½å†å²å¯¹è¯ï¼Œæä¾›æ›´è¿è´¯çš„æœåŠ¡</li>
<li><strong>çŸ¥è¯†ç®¡ç†</strong>æ„å»ºä¼ä¸šçŸ¥è¯†åº“ï¼Œæ”¯æŒå¤æ‚çš„çŸ¥è¯†æ£€ç´¢å’Œå…³è”æŸ¥è¯¢</li>
<li><strong>ä»£ç ç†è§£</strong>åˆ†æä»£ç åº“ï¼Œæ„å»ºä»£ç çŸ¥è¯†å›¾è°±ï¼Œè¾…åŠ©å¼€å‘</li>
<li><strong>ä¸ªæ€§åŒ–æ¨è</strong>åŸºäºç”¨æˆ·å†å²è¡Œä¸ºå’Œåå¥½ï¼Œæä¾›æ›´ç²¾å‡†çš„æ¨è</li>
<li><strong>ç ”ç©¶åŠ©æ‰‹</strong>å¸®åŠ©ç ”ç©¶è€…ç®¡ç†æ–‡çŒ®ï¼Œå‘ç°ç ”ç©¶å†…å®¹ä¹‹é—´çš„å…³è”</li>
</ol>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨å®¢æœåœºæ™¯ä¸­ï¼ŒCogneeÂ å¯ä»¥è®© AI å®¢æœè®°ä½æ¯ä¸ªå®¢æˆ·çš„å†å²é—®é¢˜å’Œè§£å†³æ–¹æ³•ï¼Œå½“å®¢æˆ·å†æ¬¡å’¨è¯¢æ—¶ï¼Œæ— éœ€é‡å¤è§£é‡ŠèƒŒæ™¯ä¿¡æ¯ï¼ŒAI å°±èƒ½å¿«é€Ÿæä¾›é’ˆå¯¹æ€§çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-4">ä¼˜ç¼ºç‚¹åˆ†æ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ebb2e56816924067970d45c3f657ab68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=5BJtdJ50YzaVzjwkDeo870UzBpY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä»»ä½•æŠ€æœ¯éƒ½æœ‰å…¶ä¸¤é¢æ€§ï¼ŒCogneeÂ ä¹Ÿä¸ä¾‹å¤–ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ä¸€äº›æ€»ç»“ï¼š</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>è§£å†³äº† AI è®°å¿†çš„æ ¸å¿ƒç—›ç‚¹ï¼Œæå‡äº† AI çš„è¿ç»­æ€§å’Œä¸€è‡´æ€§</li>
<li>æ¨¡å—åŒ–è®¾è®¡ä½¿å¾—å®šåˆ¶å’Œæ‰©å±•å˜å¾—å®¹æ˜“</li>
<li>åŒæ—¶æ”¯æŒæœ¬åœ°éƒ¨ç½²å’Œäº‘ç«¯æœåŠ¡ï¼Œå…¼é¡¾å®‰å…¨æ€§å’Œä¾¿åˆ©æ€§</li>
<li>æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒå’ŒæŒç»­çš„æ›´æ–°è¿­ä»£</li>
<li>ä¸°å¯Œçš„æ–‡æ¡£å’Œç¤ºä¾‹ï¼Œé™ä½å…¥é—¨é—¨æ§›</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>ç›¸æ¯”ç®€å•çš„ RAG ç³»ç»Ÿï¼Œå­¦ä¹ æ›²çº¿è¾ƒé™¡</li>
<li>æœ¬åœ°éƒ¨ç½²éœ€è¦ä¸€å®šçš„æŠ€æœ¯å‚¨å¤‡</li>
<li>å¯¹äºå°è§„æ¨¡åº”ç”¨ï¼Œå¯èƒ½æ˜¾å¾—è¿‡äºå¤æ‚</li>
<li>æŸäº›é«˜çº§åŠŸèƒ½å¯èƒ½éœ€è¦ä»˜è´¹çš„ LLM æœåŠ¡æ”¯æŒ</li>
</ul>
<h2 data-id="heading-5">æœ¬åœ°éƒ¨ç½²æ•™ç¨‹</h2>
<p>ä¸‹é¢åˆ†äº«ä¸€ä¸‹æœ¬åœ°ä½¿ç”¨éƒ¨ç½²çš„æ–¹å¼ï¼š</p>
<ol>
<li><strong>ç¯å¢ƒå‡†å¤‡</strong>ï¼š</li>
<li>
<ul>
<li>Python 3.10-3.13</li>
<li>pipï¼ˆPython åŒ…ç®¡ç†å·¥å…·ï¼‰</li>
<li>è¶³å¤Ÿçš„å­˜å‚¨ç©ºé—´ï¼ˆæ ¹æ®æ•°æ®é‡è€Œå®šï¼‰</li>
</ul>
</li>
<li><strong>å®‰è£… Cognee</strong>ï¼š</li>
</ol>

<pre><code class="hljs">pipÂ install cognee
</code></pre>
<p><strong>3.Â åŸºæœ¬ä½¿ç”¨</strong>ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2790a919552647c29d60a8ba7a623ff6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=QAszCBeVUqUQ3BfRzwhdTqDfLCE%3D" alt="image.png" loading="lazy"/></p>
<p><strong>4.Â ä½¿ç”¨ CLI å·¥å…·</strong>ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14fbaf107b6d4380ab734a7157b0061e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6Q5bCP5aSV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632384&amp;x-signature=9ACNb3BJHv0JAKvILQJZvwWvIY0%3D" alt="image.png" loading="lazy"/></p>
<p><strong>5.Â é«˜çº§é…ç½®</strong>ï¼šå‚è€ƒå®˜æ–¹æ–‡æ¡£è¿›è¡Œä¸ªæ€§åŒ–é…ç½®ï¼ŒåŒ…æ‹¬æ•°æ®æºã€å¤„ç† pipelineã€å­˜å‚¨åç«¯ç­‰ã€‚</p>
<h2 data-id="heading-6">å®˜æ–¹ Roadmap æ³„å¯†ï¼ˆæœªç»å®˜æ–¹è¯å®ï¼Œä»…ä¾›åƒç“œï¼‰</h2>
<p>æ®å°é“æ¶ˆæ¯ï¼ŒCogneeÂ å›¢é˜Ÿæ­£åœ¨è®¡åˆ’å‡ ä¸ªä»¤äººå…´å¥‹çš„åŠŸèƒ½ï¼š</p>
<ol>
<li>æ›´å¼ºå¤§çš„å¤šæ¨¡æ€æ”¯æŒï¼ŒåŒ…æ‹¬æ›´å¥½çš„å›¾åƒå’Œè§†é¢‘ç†è§£èƒ½åŠ›</li>
<li>ä¸ä¸»æµ AI æ¡†æ¶çš„æ·±åº¦é›†æˆï¼Œé™ä½ä½¿ç”¨é—¨æ§›</li>
<li>å¢å¼ºçš„å¯è§†åŒ–å·¥å…·ï¼Œè®©çŸ¥è¯†å›¾è°±æ›´ç›´è§‚</li>
<li>ç§»åŠ¨ç«¯æ”¯æŒï¼Œæ‹“å±•åº”ç”¨åœºæ™¯</li>
</ol>
<p>è¿™äº›åŠŸèƒ½å¦‚æœå®ç°ï¼Œæ— ç–‘ä¼šè®©Â CogneeÂ çš„ç«äº‰åŠ›æ›´ä¸Šä¸€å±‚æ¥¼ã€‚</p>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>cogneeÂ ç”¨â€œå›¾+å‘é‡â€åŒå¼•æ“ï¼ŒæŠŠåŸæ¥éœ€è¦ä¸‰å››ä¸ªç»„ä»¶æ‰èƒ½æ‹¼å‡ºæ¥çš„â€œæŒä¹…è®°å¿†â€ï¼Œå°è£…æˆ 6 è¡Œä»£ç çš„ç§¯æœ¨ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæ›´ä»£è¡¨äº†ä¸€ç§è®© AI æ›´åŠ æ™ºèƒ½ã€æ›´åŠ è´´è¿‘äººç±»è®¤çŸ¥æ–¹å¼çš„åŠªåŠ›æ–¹å‘ã€‚</p>
<p>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒCognee æä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„æ¡†æ¶ï¼Œå¯ä»¥å¿«é€Ÿæ„å»ºå…·æœ‰è®°å¿†èƒ½åŠ›çš„ AI åº”ç”¨ï¼›</p>
<p>å¯¹äºä¼ä¸šæ¥è¯´ï¼Œå®ƒå¯ä»¥å¸®åŠ©æ„å»ºæ›´æ™ºèƒ½çš„å®¢æœã€æ›´é«˜æ•ˆçš„çŸ¥è¯†ç®¡ç†ç³»ç»Ÿï¼›å¯¹äºç ”ç©¶äººå‘˜æ¥è¯´ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¢ç´¢ AI è®¤çŸ¥æœºåˆ¶çš„å¹³å°ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿåœ¨ä¸ºâ€œAI é‡‘é±¼è„‘â€æ‰å¤´å‘ï¼Œä¸å¦¨ç»™Â cogneeÂ ä¸€ä¸ªå±•ç¤ºè‡ªå·±çš„æœºä¼šï¼Œè®©å®ƒå¸®ä½ æŠŠ RAG çœŸæ­£å‡çº§æˆÂ Memory-Augmented Generationã€‚</p>
<p>github åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftopoteretes%2Fcognee" target="_blank" title="https://github.com/topoteretes/cognee" ref="nofollow noopener noreferrer">github.com/topoteretesâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[axiosç®€æ˜“å°è£…ï¼Œé€‚é…H5å¼€å‘]]></title>    <link>https://juejin.cn/post/7584714813366534182</link>    <guid>https://juejin.cn/post/7584714813366534182</guid>    <pubDate>2025-12-18T03:03:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584714813366534182" data-draft-id="7584725529876627506" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="axiosç®€æ˜“å°è£…ï¼Œé€‚é…H5å¼€å‘"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-12-18T03:03:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¸­è›‹è¶…äººä¸ä¼šé£"/> <meta itemprop="url" content="https://juejin.cn/user/1592546231585821"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            axiosç®€æ˜“å°è£…ï¼Œé€‚é…H5å¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1592546231585821/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¸­è›‹è¶…äººä¸ä¼šé£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:03:19.000Z" title="Thu Dec 18 2025 03:03:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    24
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">utils  -  request.ts</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Axios</span>, {
  type <span class="hljs-title class_">AxiosInstance</span>,
  type <span class="hljs-title class_">AxiosError</span>,
  type <span class="hljs-title class_">AxiosResponse</span>,
  type <span class="hljs-title class_">AxiosRequestConfig</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;
<span class="hljs-keyword">import</span> { getStorage } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/storage'</span>;
<span class="hljs-keyword">import</span> { _closePage } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/utils-app'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ContentTypeEnum</span>, <span class="hljs-title class_">ResultEnum</span>, <span class="hljs-title class_">RequestEnum</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/enums/requestEnum'</span>;
<span class="hljs-keyword">import</span> { useAddRequestCount, useRemoveRequestCount } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks/useRequestCounter'</span>;

<span class="hljs-keyword">import</span> <span class="hljs-title class_">NProgress</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./progress'</span>;
<span class="hljs-keyword">import</span> qs <span class="hljs-keyword">from</span> <span class="hljs-string">'qs'</span>;

<span class="hljs-comment">// é»˜è®¤ axios å®ä¾‹è¯·æ±‚é…ç½®</span>
<span class="hljs-keyword">const</span> configDefault = {
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-title class_">ContentTypeEnum</span>.<span class="hljs-property">JSON</span>,
    <span class="hljs-string">'config-model'</span>: <span class="hljs-string">'INTERNET'</span>
  },
  <span class="hljs-attr">timeout</span>: <span class="hljs-title class_">RequestEnum</span>.<span class="hljs-property">TIMEOUT</span>,
  <span class="hljs-attr">baseURL</span>: <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_BASE_API</span>,
  <span class="hljs-attr">paramsSerializer</span>: {
		<span class="hljs-title function_">serialize</span>(<span class="hljs-params">params: any</span>) {
			<span class="hljs-keyword">return</span> qs.<span class="hljs-title function_">stringify</span>(params, { <span class="hljs-attr">allowDots</span>: <span class="hljs-literal">true</span> });
		}
	},
  <span class="hljs-attr">data</span>: {}
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Http</span> {
  <span class="hljs-comment">// å½“å‰å®ä¾‹</span>
  private <span class="hljs-keyword">static</span> <span class="hljs-attr">axiosInstance</span>: <span class="hljs-title class_">AxiosInstance</span>;
  <span class="hljs-comment">// è¯·æ±‚é…ç½®</span>
  private <span class="hljs-keyword">static</span> <span class="hljs-attr">axiosConfigDefault</span>: <span class="hljs-title class_">AxiosRequestConfig</span>;

  <span class="hljs-comment">// è¯·æ±‚æ‹¦æˆª</span>
  private <span class="hljs-title function_">httpInterceptorsRequest</span>(): <span class="hljs-keyword">void</span> {
    <span class="hljs-title class_">Http</span>.<span class="hljs-property">axiosInstance</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
      <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (!config.<span class="hljs-property">hideLoading</span>) {
          <span class="hljs-title function_">useAddRequestCount</span>();
        };
        <span class="hljs-keyword">const</span> { accessToken } = <span class="hljs-title function_">getStorage</span>(<span class="hljs-string">'accessToken'</span>);
        <span class="hljs-keyword">if</span> (accessToken) {
         config.<span class="hljs-property">headers</span>![<span class="hljs-string">'Authorization'</span>] = accessToken;
        }
        <span class="hljs-keyword">return</span> config;
      },
      <span class="hljs-function">(<span class="hljs-params">error: AxiosError</span>) =&gt;</span> {
        <span class="hljs-title function_">showFailToast</span>(error.<span class="hljs-property">message</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
      }
    );
  }

  <span class="hljs-comment">// å“åº”æ‹¦æˆª</span>
  private <span class="hljs-title function_">httpInterceptorsResponse</span>(): <span class="hljs-keyword">void</span> {
    <span class="hljs-title class_">Http</span>.<span class="hljs-property">axiosInstance</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
      <span class="hljs-function">(<span class="hljs-params">response: AxiosResponse</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">config</span>.<span class="hljs-property">hideLoading</span>) {
          <span class="hljs-title function_">useRemoveRequestCount</span>();
        };
        <span class="hljs-comment">// ä¸åç«¯åå®šçš„è¿”å›å­—æ®µ</span>
        <span class="hljs-keyword">const</span> { code, message } = response.<span class="hljs-property">data</span>;
        <span class="hljs-comment">// åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>
        <span class="hljs-keyword">const</span> isSuccess = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">has</span>(response.<span class="hljs-property">data</span>, <span class="hljs-string">'code'</span>) &amp;&amp; code === <span class="hljs-title class_">ResultEnum</span>.<span class="hljs-property">SUCCESS</span>;
        <span class="hljs-keyword">if</span> (isSuccess) {
          <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
        }
        <span class="hljs-keyword">if</span> (code === <span class="hljs-title class_">ResultEnum</span>.<span class="hljs-property">EXPIRED</span>) {
          <span class="hljs-title function_">showDialog</span>({
            <span class="hljs-attr">title</span>: <span class="hljs-string">"æƒé™æç¤º"</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">"é¡µé¢å·²å¤±æ•ˆï¼Œè¯·é‡æ–°è¿›å…¥é¡µé¢ï¼"</span>,
          })
            .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
              <span class="hljs-title function_">_closePage</span>();
            })
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-comment">// å¤„ç†è¯·æ±‚é”™è¯¯</span>
          <span class="hljs-title function_">showFailToast</span>(message);
          <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(response.<span class="hljs-property">data</span>);
        }
      },
      <span class="hljs-function">(<span class="hljs-params">error: AxiosError</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (!error?.<span class="hljs-property">config</span>?.<span class="hljs-property">hideLoading</span>) {
          <span class="hljs-title function_">useRemoveRequestCount</span>();
        };
        <span class="hljs-comment">// HTTP çŠ¶æ€ç </span>
        <span class="hljs-keyword">const</span> status = error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span> ?? <span class="hljs-number">0</span>;
        <span class="hljs-keyword">const</span> handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([
          [<span class="hljs-number">400</span>, <span class="hljs-string">'è¯·æ±‚é”™è¯¯'</span>],
          [<span class="hljs-number">401</span>, <span class="hljs-string">'æœªæˆæƒï¼Œè¯·ç™»å½•'</span>],
          [<span class="hljs-number">403</span>, <span class="hljs-string">'æ‹’ç»è®¿é—®'</span>],
          [<span class="hljs-number">404</span>, <span class="hljs-string">`è¯·æ±‚åœ°å€å‡ºé”™: <span class="hljs-subst">${error.response?.config?.url}</span>`</span>],
          [<span class="hljs-number">408</span>, <span class="hljs-string">'è¯·æ±‚è¶…æ—¶'</span>],
          [<span class="hljs-number">500</span>, <span class="hljs-string">'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'</span>],
          [<span class="hljs-number">501</span>, <span class="hljs-string">'æœåŠ¡æœªå®ç°'</span>],
          [<span class="hljs-number">502</span>, <span class="hljs-string">'ç½‘å…³é”™è¯¯'</span>],
          [<span class="hljs-number">503</span>, <span class="hljs-string">'æœåŠ¡ä¸å¯ç”¨'</span>],
          [<span class="hljs-number">504</span>, <span class="hljs-string">'ç½‘å…³è¶…æ—¶'</span>],
          [<span class="hljs-number">505</span>, <span class="hljs-string">'HTTPç‰ˆæœ¬ä¸å—æ”¯æŒ'</span>],
          [<span class="hljs-number">0</span>, <span class="hljs-string">'ç½‘ç»œè¿æ¥æ•…éšœ'</span>],
        ])
        <span class="hljs-comment">// å¤„ç† HTTP ç½‘ç»œé”™è¯¯</span>
        <span class="hljs-keyword">const</span> message = handler.<span class="hljs-title function_">get</span>(status) ?? handler.<span class="hljs-title function_">get</span>(<span class="hljs-number">0</span>) ?? <span class="hljs-string">''</span>;

        <span class="hljs-title function_">showFailToast</span>(message);
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
      }
    );
  }

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: AxiosRequestConfig</span>) {
    <span class="hljs-title class_">Http</span>.<span class="hljs-property">axiosConfigDefault</span> = config;
    <span class="hljs-title class_">Http</span>.<span class="hljs-property">axiosInstance</span> = <span class="hljs-title class_">Axios</span>.<span class="hljs-title function_">create</span>(config);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">httpInterceptorsRequest</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">httpInterceptorsResponse</span>();
  }

  <span class="hljs-comment">// é€šç”¨è¯·æ±‚å‡½æ•°</span>
  public request&lt;T&gt;(<span class="hljs-attr">paramConfig</span>: <span class="hljs-title class_">AxiosRequestConfig</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
    <span class="hljs-keyword">const</span> config = { ...<span class="hljs-title class_">Http</span>.<span class="hljs-property">axiosConfigDefault</span>, ...paramConfig };
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-title class_">Http</span>.<span class="hljs-property">axiosInstance</span>
        .<span class="hljs-title function_">request</span>(config)
        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response: any</span>) =&gt;</span> {
          <span class="hljs-title function_">resolve</span>(response);
        })
        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
          <span class="hljs-title function_">reject</span>(error);
        });
    });
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> http = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Http</span>(configDefault);
</code></pre>
<h3 data-id="heading-1">hooks - useReauestCounter.ts</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { useRequestCounterStoreHook } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/store/modules/requestCounter"</span>;

<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useRequestCounterStoreHook</span>();
<span class="hljs-comment">// å¢åŠ è®¡æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useAddRequestCount</span>(<span class="hljs-params"/>) {
  store.<span class="hljs-title function_">addRequestCount</span>();
}
<span class="hljs-comment">// å‡å°‘è®¡æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useRemoveRequestCount</span>(<span class="hljs-params"/>) {
  store.<span class="hljs-title function_">removeRequestCount</span>();
}
<span class="hljs-comment">// æ¸…ç©ºè®¡æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useClearRequestCount</span>(<span class="hljs-params"/>) {
  store.<span class="hljs-title function_">clearRequestCount</span>();
}
</code></pre>
<h3 data-id="heading-2">store  -  reauestCounter.ts</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { defineStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>;
<span class="hljs-keyword">import</span> { store } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useRequestCounterStore = <span class="hljs-title function_">defineStore</span>({
  <span class="hljs-attr">id</span>: <span class="hljs-string">'request-counter'</span>,
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-comment">// è¯·æ±‚æ¬¡æ•°</span>
    <span class="hljs-attr">requestCount</span>: <span class="hljs-number">0</span>,
  }),
  <span class="hljs-attr">getters</span>: {
    <span class="hljs-comment">// æ˜¯å¦æœ‰è¯·æ±‚æ­£åœ¨è¿›è¡Œ</span>
    <span class="hljs-title function_">isLoading</span>(): boolean {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestCount</span> &gt; <span class="hljs-number">0</span>;
    }
  },
  <span class="hljs-attr">actions</span>: {
    <span class="hljs-comment">// å¢åŠ è¯·æ±‚è®¡æ•°</span>
    <span class="hljs-title function_">addRequestCount</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestCount</span> += <span class="hljs-number">1</span>;
    },
    <span class="hljs-comment">// å‡å°‘è¯·æ±‚è®¡æ•°</span>
    <span class="hljs-title function_">removeRequestCount</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">requestCount</span> &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestCount</span> -= <span class="hljs-number">1</span>;
      }
    },
    <span class="hljs-comment">// é‡ç½®è®¡æ•°å™¨ï¼ˆç”¨äºæ¸…ç†ï¼‰</span>
    <span class="hljs-title function_">clearRequestCount</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestCount</span> = <span class="hljs-number">0</span>;
    }
  }
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useRequestCounterStoreHook</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useRequestCounterStore</span>(store);
}
</code></pre>
<h3 data-id="heading-3">æ ¹ç»„ä»¶  - BasicLayout.vue</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-column-1 hidden-container"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- é€‚é…é¡¶éƒ¨å®‰å…¨åŒºåŸŸ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"van-safe-area-top"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span> <span class="hljs-attr">v-slot</span>=<span class="hljs-string">"{ Component, route }"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span> <span class="hljs-attr">:include</span>=<span class="hljs-string">"cachedViews"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"Component"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"route.path"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-column-1"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- é€‚é…åº•éƒ¨å®‰å…¨åŒºåŸŸ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"van-safe-area-bottom"</span> /&gt;</span>
    <span class="hljs-comment">&lt;!-- åŠ è½½ä¸­é®ç½© --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">van-overlay</span> <span class="hljs-attr">:show</span>=<span class="hljs-string">"isLoading"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"global-loading-overlay"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-center loading-content"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">van-loading</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"circular"</span> <span class="hljs-attr">:size</span>=<span class="hljs-string">"$getSize(48)"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">van-overlay</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"BasicLayout"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useCachedViewStoreHook } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/store/modules/cachedView"</span>;
<span class="hljs-keyword">import</span> { useRequestCounterStoreHook } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/store/modules/requestCounter"</span>;

<span class="hljs-keyword">import</span> $getSize <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/px2vw'</span>;

<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>();
<span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>();

<span class="hljs-comment">// ç¼“å­˜é¡µé¢</span>
<span class="hljs-keyword">const</span> cachedViews = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useCachedViewStoreHook</span>().<span class="hljs-property">cachedViewList</span>;
});
<span class="hljs-comment">// æ˜¯å¦åŠ è½½ä¸­</span>
<span class="hljs-keyword">const</span> isLoading = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useRequestCounterStoreHook</span>().<span class="hljs-property">isLoading</span>;
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"less"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.global-loading-overlay</span> {
  <span class="hljs-attribute">position</span>: fixed;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">9999</span>;
  <span class="hljs-attribute">background-color</span>: transparent;
  // <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, .<span class="hljs-number">6</span>);
}
<span class="hljs-selector-class">.loading-content</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>);
  <span class="hljs-attribute">width</span>: <span class="hljs-number">64px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">64px</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--van-toast-background);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-built_in">var</span>(--van-toast-radius);
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Unity IL2CPPçš„GCåŸç†]]></title>    <link>https://juejin.cn/post/7584730804514799659</link>    <guid>https://juejin.cn/post/7584730804514799659</guid>    <pubDate>2025-12-18T03:12:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584730804514799659" data-draft-id="7584724634172883007" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Unity IL2CPPçš„GCåŸç†"/> <meta itemprop="keywords" content="æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-18T03:12:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¾‘è™ç§‘æŠ€"/> <meta itemprop="url" content="https://juejin.cn/user/4402891763231262"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Unity IL2CPPçš„GCåŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4402891763231262/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¾‘è™ç§‘æŠ€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:12:58.000Z" title="Thu Dec 18 2025 03:12:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ã€USparkleä¸“æ ã€‘å¦‚æœä½ æ·±æ€€ç»æŠ€ï¼Œçˆ±â€œæç‚¹ç ”ç©¶â€ï¼Œä¹äºåˆ†äº«ä¹Ÿåšé‡‡ä¼—é•¿ï¼Œæˆ‘ä»¬æœŸå¾…ä½ çš„åŠ å…¥ï¼Œè®©æ™ºæ…§çš„ç«èŠ±ç¢°æ’äº¤ç»‡ï¼Œè®©çŸ¥è¯†çš„ä¼ é€’ç”Ÿç”Ÿä¸æ¯ï¼</p>
<hr/>
<p>èƒŒæ™¯ï¼šå‰æ®µæ—¶é—´åœ¨é¡¹ç›®å†…åšäº†å…³äºMonoå†…å­˜ï¼ˆå †å†…å­˜ï¼‰çš„ä¼˜åŒ–ã€‚ä»ç»“æœä¸Šå°†Monoå†…å­˜ä»220MBé™ä½åˆ°130MBï¼Œä¼˜åŒ–è¿‡ç¨‹ä¸­å”¤èµ·äº†éƒ¨åˆ†å…³äºGCçš„æ¶ˆå¤±çš„å›å¿†ï¼Œè™½ç„¶å®é™…çš„ä¼˜åŒ–å·¥ä½œä¸­ä¹Ÿè®¸å¹¶ç”¨ä¸åˆ°ï¼Œä½†æ˜¯æ›´æ˜ç¡®åº•å±‚å®ç°æœºåˆ¶æ€»å½’æ˜¯ä¸€ä»¶è¿­ä»£è‡ªæˆ‘çš„è¿‡ç¨‹ï¼Œåœ¨è¿™é‡Œå°±æ¥å›é¡¾ä¸€ä¸‹ã€‚</p>
<blockquote>
<h3 data-id="heading-0"><strong>ä¸€ã€ä»€ä¹ˆæ˜¯åƒåœ¾å›æ”¶ - GCï¼ˆGarbage Collectorï¼‰</strong></h3>
</blockquote>
<p>åœ¨æ¸¸æˆè¿è¡Œçš„æ—¶å€™ï¼Œæ•°æ®ä¸»è¦å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå½“æ¸¸æˆçš„æ•°æ®åœ¨ä¸éœ€è¦çš„æ—¶å€™ï¼Œå­˜å‚¨å½“å‰æ•°æ®çš„å†…å­˜å°±å¯ä»¥è¢«å›æ”¶ä»¥å†æ¬¡ä½¿ç”¨ã€‚å†…å­˜åƒåœ¾æ˜¯æŒ‡å½“å‰åºŸå¼ƒæ•°æ®æ‰€å ç”¨çš„å†…å­˜ï¼Œåƒåœ¾å›æ”¶ï¼ˆGCï¼‰æ˜¯æŒ‡å°†åºŸå¼ƒçš„å†…å­˜é‡æ–°å›æ”¶å†æ¬¡ä½¿ç”¨çš„è¿‡ç¨‹ã€‚</p>
<p><strong>1. ä»€ä¹ˆæ—¶å€™è§¦å‘åƒåœ¾å›æ”¶</strong><br/>
æœ‰ä¸‰ä¸ªæ“ä½œä¼šè§¦å‘åƒåœ¾å›æ”¶ï¼š</p>
<ul>
<li>åœ¨å †å†…å­˜ä¸Šè¿›è¡Œ<strong>å†…å­˜åˆ†é…</strong>æ“ä½œè€Œ<strong>å†…å­˜ä¸å¤Ÿ</strong>çš„æ—¶å€™éƒ½ä¼šè§¦å‘åƒåœ¾å›æ”¶æ¥åˆ©ç”¨é—²ç½®çš„å†…å­˜ã€‚</li>
<li>GCä¼š<strong>è‡ªåŠ¨è§¦å‘</strong>ï¼Œä¸åŒå¹³å°è¿è¡Œé¢‘ç‡ä¸ä¸€æ ·ã€‚</li>
<li>GC<strong>è¢«ä»£ç å¼ºåˆ¶æ‰§è¡Œ</strong>ã€‚</li>
</ul>
<p><strong>2. GCæ“ä½œå¸¦æ¥çš„é—®é¢˜</strong><br/>
ç›´ç™½ç‚¹å°±ä¸¤ä¸ªé—®é¢˜ï¼šä¸€ä¸ªæ˜¯Stop-the-worldå¯¼è‡´çš„â€œå¡â€ï¼›ä¸€ä¸ªæ˜¯å†…å­˜ç¢ç‰‡å¯¼è‡´çš„ <strong>â€œå †å†…å­˜å¤ªå¤§â€</strong> ã€‚</p>
<ul>
<li>GCæ“ä½œä¼šéœ€è¦å¤§é‡çš„æ—¶é—´æ¥è¿è¡Œï¼Œå¦‚æœå †å†…å­˜ä¸Šæœ‰å¤§é‡çš„å˜é‡æˆ–è€…å¼•ç”¨éœ€è¦æ£€æŸ¥ï¼Œåˆ™æ£€æŸ¥çš„æ“ä½œä¼šååˆ†ç¼“æ…¢ï¼Œè¿™å°±ä¼šä½¿å¾—æ¸¸æˆè¿è¡Œç¼“æ…¢ã€‚</li>
<li>GCå¯èƒ½ä¼šåœ¨å…³é”®æ—¶å€™è¿è¡Œï¼Œä¾‹å¦‚åœ¨CPUå¤„äºæ¸¸æˆçš„æ€§èƒ½è¿è¡Œå…³é”®æ—¶åˆ»ï¼Œæ­¤æ—¶ä»»ä½•ä¸€ä¸ªé¢å¤–çš„æ“ä½œéƒ½å¯èƒ½ä¼šå¸¦æ¥æå¤§çš„å½±å“ï¼Œä½¿å¾—æ¸¸æˆå¸§ç‡ä¸‹é™ã€‚</li>
<li>å¦å¤–ä¸€ä¸ªGCå¸¦æ¥çš„é—®é¢˜æ˜¯å †å†…å­˜çš„<strong>ç¢ç‰‡</strong>ã€‚å½“ä¸€ä¸ªå†…å­˜å•å…ƒä»å †å†…å­˜ä¸Šåˆ†é…å‡ºæ¥ï¼Œå…¶å¤§å°å–å†³äºå…¶å­˜å‚¨çš„å˜é‡çš„å¤§å°ã€‚å½“è¯¥å†…å­˜è¢«å›æ”¶åˆ°å †å†…å­˜ä¸Šçš„æ—¶å€™ï¼Œæœ‰å¯èƒ½ä½¿å¾—å †å†…å­˜è¢«åˆ†å‰²æˆç¢ç‰‡åŒ–çš„å•å…ƒã€‚ä¹Ÿå°±æ˜¯è¯´å †å†…å­˜æ€»ä½“å¯ä»¥ä½¿ç”¨çš„å†…å­˜å•å…ƒè¾ƒå¤§ï¼Œä½†æ˜¯å•ç‹¬çš„å†…å­˜å•å…ƒè¾ƒå°ï¼Œåœ¨ä¸‹æ¬¡å†…å­˜åˆ†é…çš„æ—¶å€™ä¸èƒ½æ‰¾åˆ°åˆé€‚å¤§å°çš„å­˜å‚¨å•å…ƒï¼Œè¿™ä¹Ÿä¼šè§¦å‘GCæ“ä½œæˆ–è€…å †å†…å­˜æ‰©å±•æ“ä½œã€‚</li>
<li>å †å†…å­˜ç¢ç‰‡ä¼šé€ æˆä¸¤ä¸ªç»“æœï¼šä¸€ä¸ªæ˜¯æ¸¸æˆå ç”¨çš„å†…å­˜ä¼šè¶Šæ¥è¶Šå¤§ï¼›ä¸€ä¸ªæ˜¯GCä¼šæ›´åŠ é¢‘ç¹åœ°è¢«è§¦å‘ã€‚</li>
</ul>
<p>ç‰¹åˆ«æ˜¯åœ¨å †å†…å­˜ä¸Šè¿›è¡Œå†…å­˜åˆ†é…æ—¶å†…å­˜å•å…ƒä¸è¶³å¤Ÿçš„æ—¶å€™ï¼ŒGCä¼šè¢«é¢‘ç¹è§¦å‘ï¼Œè¿™å°±æ„å‘³ç€é¢‘ç¹åœ¨å †å†…å­˜ä¸Šè¿›è¡Œå†…å­˜åˆ†é…å’Œå›æ”¶ä¼šè§¦å‘é¢‘ç¹çš„GCæ“ä½œã€‚</p>
<blockquote>
<h3 data-id="heading-1"><strong>äºŒã€Unityæ‰˜ç®¡å †</strong></h3>
</blockquote>
<p>åœ¨è®²å…·ä½“çš„Unity GCæœºåˆ¶ä¹‹å‰å†å›é¡¾ä¸€ä¸‹Unityæ‰˜ç®¡å †ã€‚</p>
<p><strong>1. æ‰˜ç®¡å †çš„å·¥ä½œåŸç†åŠå…¶æ‰©å±•åŸå› </strong><br/>
â€œæ‰˜ç®¡å †â€æ˜¯ç”±é¡¹ç›®è„šæœ¬è¿è¡Œæ—¶ï¼ˆMonoæˆ–IL2CPPï¼‰çš„å†…å­˜ç®¡ç†å™¨è‡ªåŠ¨ç®¡ç†çš„ä¸€æ®µå†…å­˜ã€‚å¿…é¡»åœ¨æ‰˜ç®¡å †ä¸Šåˆ†é…æ‰˜ç®¡ä»£ç ä¸­åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/878627dd99a84cc0b5dea4b13adee32e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=gkuzi%2FGpsiL3vvzSYvm9LWmMi0I%3D" alt="" loading="lazy"/></p>
<p align="center">Unityå®˜æ–¹æ–‡æ¡£å›¾</p>
<p>åœ¨ä¸Šå›¾ä¸­ï¼Œç™½æ¡†è¡¨ç¤ºåˆ†é…ç»™æ‰˜ç®¡å †çš„å†…å­˜é‡ï¼Œè€Œå…¶ä¸­çš„å½©è‰²æ¡†è¡¨ç¤ºå­˜å‚¨åœ¨æ‰˜ç®¡å †çš„å†…å­˜ç©ºé—´ä¸­çš„æ•°æ®å€¼ã€‚å½“éœ€è¦æ›´å¤šå€¼æ—¶ï¼Œå°†ä»æ‰˜ç®¡å †ä¸­åˆ†é…æ›´å¤šç©ºé—´ã€‚</p>
<p>GCå®šæœŸè¿è¡Œå°†æ‰«æå †ä¸Šçš„æ‰€æœ‰å¯¹è±¡ï¼Œå°†ä»»ä½•ä¸å†å¼•ç”¨çš„å¯¹è±¡æ ‡è®°ä¸ºåˆ é™¤ã€‚ç„¶åä¼šåˆ é™¤æœªå¼•ç”¨çš„å¯¹è±¡ï¼Œä»è€Œé‡Šæ”¾å†…å­˜ã€‚</p>
<p>è‡³å…³é‡è¦çš„æ˜¯ï¼ŒUnityçš„åƒåœ¾æ”¶é›†æ˜¯<strong>éåˆ†ä»£</strong>çš„ï¼Œä¹Ÿæ˜¯<strong>éå‹ç¼©</strong>çš„ã€‚â€œéåˆ†ä»£â€æ„å‘³ç€GCåœ¨æ‰§è¡Œæ¯éæ”¶é›†æ—¶å¿…é¡»æ‰«ææ•´ä¸ªå †ï¼Œå› æ­¤éšç€å †çš„æ‰©å±•ï¼Œå…¶æ€§èƒ½ä¼šä¸‹é™ã€‚â€œéå‹ç¼©â€æ„å‘³ç€ä¸ä¼šä¸ºå†…å­˜ä¸­çš„å¯¹è±¡é‡æ–°åˆ†é…å†…å­˜åœ°å€æ¥æ¶ˆé™¤å¯¹è±¡ä¹‹é—´çš„é—´éš™ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8201287925a24948a5a5e8da1c3d84ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=kdrmqalTPdfDsQ1WoY5Hci4NeZE%3D" alt="" loading="lazy"/></p>
<p align="center">å†…å­˜ç©ºéš™</p>
<p>ä¸Šå›¾ä¸ºå†…å­˜ç¢ç‰‡åŒ–ç¤ºä¾‹ã€‚é‡Šæ”¾å¯¹è±¡æ—¶ï¼Œå°†é‡Šæ”¾å…¶å†…å­˜ã€‚ä½†æ˜¯ï¼Œé‡Šæ”¾çš„ç©ºé—´<strong>ä¸ä¼š</strong>æ•´åˆæˆä¸ºæ•´ä¸ªâ€œå¯ç”¨å†…å­˜â€æ± çš„ä¸€éƒ¨åˆ†ã€‚ä½äºé‡Šæ”¾çš„å¯¹è±¡ä¸¤ä¾§çš„å¯¹è±¡å¯èƒ½ä»åœ¨ä½¿ç”¨ä¸­ã€‚å› æ­¤ï¼Œé‡Šæ”¾çš„ç©ºé—´æˆä¸ºå…¶ä»–å†…å­˜æ®µä¹‹é—´çš„â€œé—´éš™â€ï¼ˆè¯¥é—´éš™ç”±ä¸Šå›¾ä¸­çš„çº¢è‰²åœ†åœˆæŒ‡ç¤ºï¼‰ã€‚å› æ­¤ï¼Œæ–°é‡Šæ”¾çš„ç©ºé—´ä»…å¯ç”¨äºå­˜å‚¨ä¸é‡Šæ”¾ç›¸åŒå¤§å°æˆ–æ›´å°çš„å¯¹è±¡çš„æ•°æ®ã€‚</p>
<p>è¿™å¯¼è‡´äº†<strong>å†…å­˜ç¢ç‰‡åŒ–</strong>è¿™ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šè™½ç„¶å †ä¸­çš„å¯ç”¨ç©ºé—´<strong>æ€»é‡å¯èƒ½å¾ˆå¤§</strong>ï¼Œä½†æ˜¯å¯èƒ½å…¶ä¸­çš„<strong>éƒ¨åˆ†æˆ–å…¨éƒ¨</strong>çš„å¯åˆ†é…ç©ºé—´å¯¹è±¡ä¹‹é—´å­˜åœ¨<strong>å°çš„â€œé—´éš™â€</strong> ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿å¯ç”¨ç©ºé—´æ€»é‡é«˜äºè¦åˆ†é…çš„ç©ºé—´é‡ï¼Œæ‰˜ç®¡å †å¯èƒ½ä¹Ÿæ‰¾ä¸åˆ°è¶³å¤Ÿå¤§çš„è¿ç»­å†…å­˜å—æ¥æ»¡è¶³è¯¥åˆ†é…éœ€æ±‚ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a01b34f2c339454e9232bc4ccf054bff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=1rAxPQ%2BLniw5dBy18M3CN39ZJgI%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœåˆ†é…äº†å¤§å‹å¯¹è±¡åˆæ²¡æœ‰è¶³å¤Ÿçš„è¿ç»­ç©ºé—´æä¾›ä½¿ç”¨åˆ™ï¼š</p>
<ul>
<li>è¿è¡Œåƒåœ¾å›æ”¶å™¨ï¼Œ<strong>å°è¯•é‡Šæ”¾ç©ºé—´</strong>æ¥æ»¡è¶³åˆ†é…è¯·æ±‚ã€‚</li>
<li>å¦‚æœåœ¨GCè¿è¡Œåï¼Œä»ç„¶æ²¡æœ‰è¶³å¤Ÿçš„è¿ç»­ç©ºé—´æ¥æ»¡è¶³è¯·æ±‚çš„å†…å­˜é‡ï¼Œåˆ™å¿…é¡»<strong>æ‰©å±•å †</strong>ã€‚å †çš„å…·ä½“æ‰©å±•é‡è§†å¹³å°è€Œå®šã€‚</li>
</ul>
<p><strong>2. Unityæ‰˜ç®¡å †çš„é—®é¢˜</strong></p>
<ul>
<li>Unityåœ¨æ‰©å±•æ‰˜ç®¡å †å<strong>ä¸ä¼šç»å¸¸é‡Šæ”¾</strong>åˆ†é…ç»™æ‰˜ç®¡å †çš„<strong>å†…å­˜é¡µ</strong>,Â <strong>é˜²æ­¢</strong>å†æ¬¡å‘ç”Ÿå¤§é‡åˆ†é…æ—¶éœ€è¦<strong>é‡æ–°æ‰©å±•å †</strong>ã€‚</li>
<li>åœ¨å¤§å¤šæ•°å¹³å°ä¸Šï¼ŒUnityæœ€ç»ˆä¼šå°†æ‰˜ç®¡å †çš„ç©ºç½®éƒ¨åˆ†ä½¿ç”¨çš„é¡µé¢é‡Šæ”¾å›æ“ä½œç³»ç»Ÿã€‚å‘ç”Ÿæ­¤è¡Œä¸ºçš„é—´éš”æ—¶é—´æ˜¯ä¸ç¡®å®šçš„ï¼Œä¸è¦æŒ‡æœ›é è¿™ç§æ–¹æ³•é‡Šæ”¾å†…å­˜ã€‚</li>
</ul>
<p><strong>é¢‘ç¹åˆ†é…ä¸´æ—¶æ•°æ®</strong>ç»™æ‰˜ç®¡å †ï¼Œè¿™ç§æƒ…å†µé€šå¸¸å¯¹é¡¹ç›®çš„æ€§èƒ½æä¸º<strong>ä¸åˆ©</strong>ã€‚</p>
<p>å¦‚æœ<strong>æ¯å¸§åˆ†é…1KB</strong>çš„ä¸´æ—¶å†…å­˜ï¼Œå¹¶ä¸”ä»¥<strong>60å¸§</strong>çš„é€Ÿç‡è¿è¡Œï¼Œé‚£ä¹ˆå®ƒå¿…é¡»<strong>æ¯ç§’åˆ†é…60KB</strong>çš„ä¸´æ—¶å†…å­˜ã€‚åœ¨ä¸€åˆ†é’Ÿå†…ï¼Œè¿™ä¼šåœ¨å†…å­˜ä¸­å¢åŠ <strong>3.6MB</strong>çš„åƒåœ¾ã€‚å¯¹å†…å­˜ä¸è¶³çš„è®¾å¤‡è€Œè¨€<strong>æ¯åˆ†é’Ÿ3.6MB</strong>çš„åƒåœ¾ä¹Ÿæ— æ³•æ¥å—ã€‚</p>
<blockquote>
<h3 data-id="heading-2"><strong>ä¸‰ã€Unityçš„GCæœºåˆ¶ -- Boehm GC</strong></h3>
</blockquote>
<p>ä»¥å‰çœ‹è¿‡Unityä½¿ç”¨çš„GCæ–¹æ¡ˆä½†æœ€è¿‘æ‰æƒŠè§‰ç°åœ¨ä½¿ç”¨çš„Unityéƒ½æ˜¯IL2CPPçš„ç‰ˆæœ¬äº†ï¼Œæ‰€è°“çš„Mono GCæœ¬æ¥å°±å·²ç»ä¸å­˜åœ¨äº†ã€‚äºæ˜¯æ¥çœ‹ä¸‹ç°åœ¨çš„IL2CPPçš„GCæœºåˆ¶ï¼š Boehm GCï¼ˆè´å§†åƒåœ¾æ”¶é›†å™¨ï¼‰ã€‚</p>
<p><strong>1. IL2CPP - Boehm GC</strong><br/>
è´å§†åƒåœ¾æ”¶é›†å™¨æ˜¯è®¡ç®—æœºåº”ç”¨åœ¨C/C++è¯­è¨€ä¸Šçš„ä¸€ä¸ªä¿å®ˆçš„åƒåœ¾å›æ”¶å™¨ï¼ˆGarbage Collectorï¼‰ï¼Œå¯åº”ç”¨äºè®¸å¤šç»ç”±C/C++å¼€å‘çš„ç¨‹åºä¸­ã€‚</p>
<p>æ‘˜å½•ä¸€æ®µå®šä¹‰ï¼š</p>
<blockquote>
<p>Boehm-Demers-Weiser garbage collectorï¼Œé€‚ç”¨äºå…¶å®ƒæ‰§è¡Œç¯å¢ƒçš„å„ç±»ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬äº†GNUç‰ˆJavaç¼–è¯‘å™¨æ‰§è¡Œç¯å¢ƒï¼Œä»¥åŠMonoçš„Microsoft .NETç§»æ¤å¹³å°ã€‚åŒæ—¶æ”¯æ´è®¸å¤šçš„ä½œä¸šå¹³å°ï¼Œå¦‚å„ç§Unixæ“ä½œç³»ç»Ÿï¼Œå¾®è½¯çš„æ“ä½œç³»ç»Ÿï¼ˆMicrosoft Windowsï¼‰ï¼Œä»¥åŠéº¦é‡‘å¡”ä¸Šçš„æ“ä½œç³»ç»Ÿï¼ˆMac OS Xï¼‰ï¼Œè¿˜æœ‰æ›´è¿›ä¸€æ­¥çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šæ¸è¿›å¼æ”¶é›†ï¼ˆIncremental Collectionï¼‰ï¼Œå¹³è¡Œæ”¶é›†ï¼ˆParallel Collectionï¼‰ä»¥åŠç»ˆç»“è¯­æ„çš„å˜åŒ–ï¼ˆVariety Offinalizersemanticsï¼‰ã€‚</p>
</blockquote>
<p>åœ¨Unityä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…³äºBoehm GCçš„ç®—æ³•éƒ¨åˆ†ï¼š</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d1299198d8e42d98dcba458c12c69c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=IgBH5Nxb%2FuxDh%2BpgGloCWXD%2B61M%3D" alt="" loading="lazy"/></p>
<p>BoehmGC.cppå†…éƒ¨è°ƒç”¨çš„å°±æ˜¯è¿™ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œä»–æ˜¯<strong>Stop-the-world</strong>ç±»å‹çš„åƒåœ¾æ”¶é›†å™¨ï¼Œè¿™è¡¨æ˜äº†åœ¨æ‰§è¡Œåƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œå°†ä¼š<strong>åœæ­¢</strong>æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œè€Œåœæ­¢æ—¶é—´çš„åªæœ‰åœ¨<strong>å®Œæˆå·¥ä½œåæ‰ä¼šæ¢å¤</strong>ï¼Œæ‰€ä»¥è¿™å°±å¯¼è‡´äº†GCå¼•èµ·çš„ç¨‹åºå¡é¡¿å³°å€¼ï¼Œå¾ˆæ˜¾ç„¶è¿™å¯¹æ¸¸æˆçš„å¹³æ»‘ä½“éªŒé€ æˆäº†è¾ƒå¤§çš„è´Ÿé¢å½±å“ã€‚</p>
<p>é€šå¸¸ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜çš„å¸¸è§„æ–¹æ¡ˆæ˜¯å°½å¯èƒ½åœ°â€œå‡å°‘â€è¿è¡Œæ—¶åƒåœ¾å›æ”¶ï¼ˆåç»­ç”¨GCä»£æ›¿ï¼‰ï¼Œäº¦æˆ–è€…å°†GCæ”¾åœ¨ä¸é‚£ä¹ˆæ“ä½œæ•æ„Ÿçš„åœºæ™¯ä¸­ï¼Œæ¯”å¦‚å›åŸã€æ­»äº¡åç­‰ã€‚ä½†å®Œå…¨é¿å…è¿è¡Œæ—¶åƒåœ¾å›æ”¶åœ¨å¤§éƒ¨åˆ†æ—¶é—´æ˜¯ä¸ç°å®çš„ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹Boehm GCçš„èƒŒåæœºåˆ¶ã€‚</p>
<p><strong>2. Boehm GCç®—æ³•æ€è·¯</strong><br/>
Boehm GCæ˜¯ä¸€ç§Mark-Sweepï¼ˆæ ‡è®°-æ¸…æ‰«ï¼‰ç®—æ³•ï¼Œå¤§è‡´æ€è·¯åŒ…å«äº†å››ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>å‡†å¤‡é˜¶æ®µï¼šæ¯ä¸ªæ‰˜ç®¡å †å†…å­˜å¯¹è±¡åœ¨åˆ›å»ºå‡ºæ¥çš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ªå…³è”çš„æ ‡è®°ä½ï¼Œæ¥è¡¨ç¤ºå½“å‰å¯¹è±¡æ˜¯å¦è¢«å¼•ç”¨ï¼Œé»˜è®¤ä¸º0ã€‚</li>
<li>æ ‡è®°é˜¶æ®µï¼šä»æ ¹å†…å­˜èŠ‚ç‚¹ï¼ˆé™æ€å˜é‡ï¼›æ ˆï¼›å¯„å­˜å™¨ï¼‰å‡ºå‘ï¼Œéå†æ‰«ææ‰˜ç®¡å †çš„å†…å­˜èŠ‚ç‚¹ï¼Œå°†è¢«å¼•ç”¨çš„å†…å­˜èŠ‚ç‚¹æ ‡è®°ä¸º1ã€‚</li>
<li>æ¸…æ‰«é˜¶æ®µï¼šéå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œå°†æ²¡æœ‰è¢«æ ‡è®°çš„èŠ‚ç‚¹çš„å†…å­˜æ•°æ®æ¸…ç©ºï¼Œå¹¶ä¸”åŸºäºä¸€å®šæ¡ä»¶é‡Šæ”¾ã€‚</li>
<li>ç»“æŸé˜¶æ®µï¼šè§¦å‘æ³¨å†Œè¿‡çš„å›è°ƒé€»è¾‘ã€‚</li>
</ul>
<p><strong>3. æ¸è¿›å¼GC</strong><br/>
ä½¿ç”¨æ¸è¿›å¼GCå…è®¸æŠŠGCå·¥ä½œåˆ†æˆå¤šä¸ªç‰‡ï¼Œå› æ­¤ä¸ºäº†ä¸è®©GCå·¥ä½œé•¿æ—¶é—´çš„â€œé˜»å¡â€ä¸»çº¿ç¨‹ï¼Œå°†å…¶æ‹†åˆ†æˆäº†å¤šä¸ªæ›´çŸ­çš„ä¸­æ–­ã€‚éœ€è¦æ˜ç¡®çš„æ˜¯è¿™å¹¶ä¸ä¼šä½¿GCæ€»ä½“ä¸Šå˜å¾—æ›´å¿«ï¼Œä½†æ˜¯å´å¯ä»¥å°†å·¥ä½œè´Ÿè½½åˆ†é…åˆ°å¤šå¸§æ¥å¹³ç¼“å•æ¬¡GCå³°å€¼å¸¦æ¥çš„å¡é¡¿å½±å“ã€‚</p>
<p>æ³¨: Unityåœ¨é«˜ç‰ˆæœ¬å·²ç»é»˜è®¤æ˜¯æ¸è¿›å¼GCäº†ï¼Œå¤§æ¦‚æ˜¯Unity 19.1a10ç‰ˆæœ¬ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1aJ411t7N6%2F%3Fvd_source%3D60173b91c5d0a0bed2ae426307dcc6b5" target="_blank" title="https://www.bilibili.com/video/BV1aJ411t7N6/?vd_source=60173b91c5d0a0bed2ae426307dcc6b5" ref="nofollow noopener noreferrer">[Unity æ´»åŠ¨]-æµ…è°ˆUnityå†…å­˜ç®¡ç†_å“”å“©å“”å“©_bilibili</a></p>
<p><strong>4. GCä¸­çš„å†…å­˜åˆ†é…</strong><br/>
Boehm GCçš„ä½¿ç”¨æ–¹æ³•éå¸¸ç®€å•ï¼Œåªéœ€è¦å°†mallocæ›¿æ¢ä¸ºGC_mallocå³å¯ï¼Œåœ¨æ­¤ä¹‹åä¾¿æ— éœ€å…³å¿ƒfreeçš„é—®é¢˜ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-type">void</span> * <span class="hljs-title">GC_malloc</span><span class="hljs-params">(<span class="hljs-type">size_t</span> lb)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">GC_malloc_kind</span>(lb, NORMAL);
}

<span class="hljs-function"><span class="hljs-type">void</span> * <span class="hljs-title">GC_malloc_kind</span><span class="hljs-params">(<span class="hljs-type">size_t</span> lb, <span class="hljs-type">int</span> k)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">GC_malloc_kind_global</span>(lb, k);
}
</code></pre>
<p>åœ¨æ•´ä¸ªå†…å­˜åˆ†é…é“¾çš„æœ€åº•éƒ¨ï¼ŒBoehm GCé€šè¿‡å¹³å°ç›¸å…³æ¥å£æ¥å‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ã€‚ä¸ºäº†æé«˜ç”³è¯·çš„æ•ˆç‡ï¼Œæ¯æ¬¡æ‰¹é‡ç”³è¯·4KBçš„å€æ•°å¤§å°ã€‚</p>
<p>åˆ†é…å™¨çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªåˆ†çº§çš„ç»“æ„ï¼ŒBoehm GCæŠŠæ¯æ¬¡ç”³è¯·æ ¹æ®å†…å­˜å¤§å°å½’ç±»æˆå°å†…å­˜å¯¹è±¡å’Œå¤§å†…å­˜å¯¹è±¡ã€‚</p>
<ul>
<li><strong>å°å†…å­˜å¯¹è±¡</strong>ï¼šä¸è¶…è¿‡PageSize/2ï¼Œå°äº2048å­—èŠ‚çš„å¯¹è±¡ã€‚</li>
<li><strong>å¤§å†…å­˜å¯¹è±¡</strong>ï¼šå¤§äºPageSize/2çš„å¯¹è±¡ã€‚</li>
</ul>
<p>å¯¹äºå¤§å†…å­˜å¯¹è±¡ï¼Œå‘ä¸Šå–æ•´åˆ°4KBçš„å€æ•°å¤§å°ï¼Œä»¥æ•´æ•°çš„å†…å­˜å—å½¢å¼ç»™å‡ºã€‚è€Œå°å†…å­˜å¯¹è±¡åˆ™ä¼šå…ˆç”³è¯·ä¸€ä¸ªå†…å­˜å—å‡ºæ¥ï¼Œè€Œååœ¨è¿™å—å†…å­˜ä¸Šè¿›ä¸€æ­¥ç»†åˆ†ä¸ºSmall Objectsï¼Œå½¢æˆfree-listã€‚</p>
<p>ä¸‹é¢ä¼šåˆ†åˆ«è¯´ä¸‹å¤§å†…å­˜å¯¹è±¡å’Œå°å†…å­˜å¯¹è±¡ï¼Œå‚è€ƒç½‘ä¸Šçš„èµ„æ–™æ•´ç†ï¼Œç¡®å®æœ‰ç‚¹ç‚¹å¹²ï¼Œä½†æ˜¯é…å›¾æˆ‘é‡æ–°åšäº†ä¸€ä¸‹ï¼Œå¤§æ¦‚å¯ä»¥è¾…åŠ©æ¶ˆåŒ–ã€‚</p>
<blockquote>
<h3 data-id="heading-3"><strong>å››ã€IL2CPP - Boehm GCï¼šå°å†…å­˜åˆ†é…</strong></h3>
</blockquote>
<p><strong>1. ç²’åº¦å¯¹é½</strong><br/>
å®ç°æ€è·¯æ˜¯ï¼Œæå‡º<strong>ç²’åº¦ï¼ˆGRANULESï¼‰</strong> çš„æ¦‚å¿µï¼Œå³ä¸€ä¸ªGRANULEçš„å¤§å°æ˜¯<strong>16å­—èŠ‚</strong>ã€‚å®é™…åˆ†é…å†…å­˜çš„æ—¶å€™æŒ‰ç…§<strong>GRANULE</strong>ä¸ºåŸºæœ¬å•ä½æ¥åˆ†é…ã€‚åˆ†é…è¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§åŸå§‹éœ€è¦çš„å¤§å°ï¼Œè®¡ç®—å¹¶æ˜ å°„å¾—åˆ°å®é™…éœ€è¦åˆ†é…çš„GRANULEä¸ªæ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">//lbæ˜¯åŸå§‹çš„åˆ†é…å¤§å°ï¼Œlgæ˜¯GRANULEï¼ˆ1ï½128ï¼‰ã€‚
size_t <span class="hljs-attr">lg</span> = GC_size_map[lb]<span class="hljs-comment">;</span>
</code></pre>
<p>ä¾‹å¦‚éœ€è¦18å­—èŠ‚çš„å†…å­˜ï¼Œåˆ™lg=2ï¼Œå³å®é™…åˆ†é…2ä¸ªGRANULEï¼ˆ32å­—èŠ‚ï¼‰ï¼Œå¦‚æœéœ€è¦1å­—èŠ‚çš„å†…å­˜ï¼Œåˆ™lg=1ï¼Œå³å®é™…åˆ†é…1ä¸ªGRANULEï¼ˆ16å­—èŠ‚ï¼‰ã€‚</p>
<p>GC_size_mapæ˜¯ä¸€ä¸ªâ€œGRANULEç´¢å¼•æ˜ å°„è¡¨â€ï¼Œç”¨æ¥ç»´æŠ¤åŸå§‹åˆ†é…çš„å†…å­˜å¤§å°å’Œå†…å­˜ç´¢å¼•ä¹‹é—´çš„å…³ç³»ã€‚æœ€å¤šå¯ä»¥è¿”å›128ä¸ªGRANULEï¼Œæ‰€ä»¥å°å†…å­˜çš„å¤§å°ä¸Šé™æ˜¯128*16=2048ã€‚GC_size_mapæ•°ç»„æœ¬èº«ä¼šä¸æ–­åŠ è½½æ ¹æ®éœ€è¦ä¸æ–­æ‰©å®¹ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17070b1ecb7c4513a9ecf392c70f4c4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=HB%2F2OEOSm2W721fgB76qriZ5hgE%3D" alt="" loading="lazy"/></p>
<p align="center">ç¤ºæ„</p>
<p><strong>2. ç©ºé—²é“¾è¡¨ - ok_freelist</strong><br/>
å†³å®šäº†GRANULEçš„å¤§å°ä¹‹åï¼Œåœ¨ç”³è¯·å†…å­˜æ—¶åˆ»é¦–å…ˆä¼šä»â€œç©ºé—²é“¾è¡¨â€ä¸­æŸ¥çœ‹æ˜¯å¦æœ‰ç©ºé—²å†…å­˜å—ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›è¿™å—å†…å­˜ï¼Œå®Œæˆåˆ†é…ï¼Œå…¶ç®—æ³•ç»´æŠ¤äº†ä¸€ä¸ªæ•°æ®ç»“æ„obj_kindï¼š</p>
<pre><code class="hljs language-ini" lang="ini">struct obj_kind {
    void **ok_freelist<span class="hljs-comment">;</span>
    struct hblk **ok_reclaim_list<span class="hljs-comment">;</span>
    ...
} GC_obj_kinds<span class="hljs-section">[3]</span><span class="hljs-comment">;</span>
</code></pre>
<p>GC_obj_kinds[3]å¯¹åº”äº†3ç§å†…å­˜ç±»å‹ï¼Œåˆ†åˆ«æ˜¯PTRFREEã€NORMALå’ŒUNCOLLECTABLEï¼Œæ¯ç§ç±»å‹éƒ½æœ‰ä¸€ä¸ªobj_kindç»“æ„ä½“ä¿¡æ¯ã€‚</p>
<p><strong>PTRFREE</strong>ï¼šæ— æŒ‡é’ˆå†…å­˜åˆ†é…ï¼Œæ˜ç¡®çš„å‘Šè¯‰GCï¼Œè¯¥å¯¹è±¡å†…æ— ä»»ä½•çš„æŒ‡é’ˆä¿¡æ¯ï¼Œåœ¨GCæ—¶å€™æ— éœ€æŸ¥æ‰¾è¯¥å¯¹è±¡æ˜¯å¦å¼•ç”¨äº†å…¶ä»–å¯¹è±¡ã€‚</p>
<p><strong>NORMAL</strong>ï¼šæ— ç±»å‹çš„å†…å­˜åˆ†é…ï¼Œå› ä¸ºæ— æ³•å¾—åˆ°å¯¹è±¡çš„ç±»å‹å…ƒæ•°æ®ï¼Œæ‰€ä»¥åœ¨GCæ—¶ä¼šæŒ‰ç…§åªé’ˆå¯¹å…¶çš„æ–¹å¼æ‰«æå†…å­˜å—ï¼Œå¦‚æœé€šè¿‡äº†æŒ‡é’ˆæ ¡éªŒï¼Œå°±ä¼šè®¤ä¸ºè¯¥å¯¹è±¡å¼•ç”¨äº†è¯¥æŒ‡é’ˆåœ°å€æŒ‡å‘çš„å¯¹è±¡ã€‚</p>
<p><strong>UNCOLLECTABLE</strong>ï¼šä¸ºBOEHMè‡ªå·±åˆ†é…çš„å†…å­˜ï¼Œè¿™äº›ä¸éœ€è¦æ ‡è®°å’Œå›æ”¶ã€‚</p>
<p>æ¯ä¸€ä¸ªobj_kindçš„ç»“æ„ä½“éƒ½ç»´æŠ¤äº†ä¸€ä¸ªok_freelistçš„äºŒç»´æŒ‡é’ˆé“¾è¡¨ç”¨æ¥å­˜æ”¾ç©ºé—²çš„å†…å­˜å—ã€‚ok_freelistç»´æŠ¤äº†0~127ä¸ªé“¾è¡¨ç´¢å¼•ã€‚è€Œæ¯ä¸€ä¸ªå°ºå¯¸çš„freelistå°±æ˜¯å¯¹åº”å¤§å°çš„GRANULEæ± å­ï¼Œå…¶ç»“æ„ç¤ºæ„å¦‚å›¾ï¼š</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c81b223904634db586d06e4884e8b397~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=dkVKA%2FqG82rvuI%2Fk3VMx3bBWNZA%3D" alt="" loading="lazy"/></p>
<p align="center">freelistç¤ºæ„</p>
<p>äºæ˜¯ï¼Œæ ¹æ®è¦ç”³è¯·çš„å†…å­˜å¤§å°è®¡ç®—å¾—åˆ°GRANULEåœ¨freelistçš„ç´¢å¼•ï¼Œç„¶åå»æŸ¥è¯¢å¯¹åº”ç´¢å¼•çš„freelistï¼Œå¦‚æœå­˜åœ¨ç©ºé—²çœ‹ç©ºé—´ok_freelist[index][0]ï¼Œåˆ™å°†å…¶è¿”å›å¹¶ä»é“¾ä¸Šç§»é™¤ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/105c859b643f4a08ae191230cb6d8c45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=O8xBG2wvjeNp1wogp%2BednRJrMek%3D" alt="" loading="lazy"/></p>
<p>ok_freelisté“¾è¡¨æœ€åˆä¸ºç©ºï¼Œå¦‚æœok_freelistä¸­æ²¡æœ‰ç›¸åº”çš„ç©ºé—²å†…å­˜å—ï¼Œåˆ™è°ƒç”¨GC_allocobj(lg, k)å»åº•å±‚æŸ¥æ‰¾å¯ç”¨çš„å†…å­˜ã€‚</p>
<p>GC_allocobjçš„æ ¸å¿ƒé€»è¾‘æ˜¯è°ƒç”¨GC_new_hblk(gran, kind)å»åº•å±‚å†…å­˜æ± è·å–å†…å­˜ï¼Œå¹¶ä¸”æŸ¥çœ‹åº•å±‚å†…å­˜æ± ä¸­æ˜¯å¦åˆ†é…äº†ç©ºé—²çš„å†…å­˜å—ï¼Œå¦‚æœæ²¡æœ‰åˆ™é€šè¿‡ç³»ç»Ÿå‡½æ•°ä¾‹å¦‚mallocåˆ†é…å†…å­˜ç»™åº•å±‚å†…å­˜æ± ï¼Œå¦‚æœå†…å­˜æ± æœ‰ï¼Œç›´æ¥å–å‡ºä¸€å—è¿”å›ã€‚GC_new_hblkçš„ä»£ç é€»è¾‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">GC_INNER void <span class="hljs-built_in">GC_new_hblk</span>(size_t gran, int kind)
{
    struct hblk *h; <span class="hljs-comment">/* the new heap block */</span>
    GC_bool <span class="hljs-attribute">clear</span> = GC_obj_kinds<span class="hljs-selector-attr">[kind]</span><span class="hljs-selector-class">.ok_init</span>;

    <span class="hljs-comment">/* Allocate a new heap block */</span>
    h = <span class="hljs-built_in">GC_allochblk</span>(GRANULES_TO_BYTES(gran), kind, <span class="hljs-number">0</span>);
    if (h == <span class="hljs-number">0</span>) return;

    <span class="hljs-comment">/* Build the free list */</span>
    GC_obj_kinds<span class="hljs-selector-attr">[kind]</span><span class="hljs-selector-class">.ok_freelist</span><span class="hljs-selector-attr">[gran]</span> =
    <span class="hljs-built_in">GC_build_fl</span>(h, GRANULES_TO_WORDS(gran), <span class="hljs-attribute">clear</span>,(ptr_t)GC_obj_kinds<span class="hljs-selector-attr">[kind]</span><span class="hljs-selector-class">.ok_freelist</span><span class="hljs-selector-attr">[gran]</span>);
}
</code></pre>
<p>GC_new_hblkçš„ä¸»è¦é€»è¾‘æœ‰2æ­¥ï¼š</p>
<ol>
<li>è°ƒç”¨GC_allochblkæ–¹æ³•è¿›ä¸€æ­¥è·å–å†…å­˜æ± ä¸­å¯ç”¨çš„å†…å­˜å—ï¼›</li>
<li>è°ƒç”¨GC_build_flæ–¹æ³•ï¼Œåˆ©ç”¨å†…å­˜æ± ä¸­è¿”å›çš„å†…å­˜å—æ„å»ºok_freelistï¼Œä¾›ä¸Šå±‚ä½¿ç”¨ã€‚</li>
</ol>
<p><strong>3. æ ¸å¿ƒå†…å­˜å—é“¾è¡¨GC_hblkfreelist</strong><br/>
åº•å±‚å†…å­˜æ± çš„å®ç°é€»è¾‘å’Œok_freelistç±»ä¼¼ï¼Œç»´æŠ¤äº†ä¸€ä¸ªç©ºé—²å†…å­˜å—é“¾è¡¨çš„æŒ‡é’ˆé“¾è¡¨GC_hblkfreeelistï¼Œä½†æ˜¯å’Œok_freelistä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªé“¾è¡¨ä¸­çš„å†…å­˜å—çš„åŸºæœ¬å•ä½æ˜¯4KBï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå†…å­˜é¡µï¼ˆpage_sizeï¼‰çš„å¤§å°ã€‚GC_hblkfreelistä¸€ä¸ªæœ‰60ä¸ªå…ƒç´ ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚</p>
<p><strong>4. å†…å­˜å— - hblkã€å¤´ä¿¡æ¯ - hblkhdr</strong><br/>
é“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªå†…å­˜å—éƒ½ä»¥å¤§å°4096ï¼ˆ4KBï¼‰ä¸ºä¸€åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªå¤§å°ä¸º4096çš„å†…å­˜å—è¢«ç§°ä¸ºhblkï¼Œæ•°æ®å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">hblk</span> {
    <span class="hljs-type">char</span> hb_body[HBLKSIZE]; <span class="hljs-comment">//HBLKSIZE=4096</span>
};
</code></pre>
<p>æ¯ä¸ªhblkæ‹¥æœ‰ä¸€ä¸ªç›¸åº”çš„headerä¿¡æ¯ï¼Œç”¨æ¥æè¿°è¿™ä¸ªå†…å­˜å¿«çš„æƒ…å†µï¼Œæ•°æ®çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//å¤´éƒ¨ä¿¡æ¯</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">hblkhdr</span> {
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">hblk</span> * hb_next; <span class="hljs-comment">//æŒ‡å‘ä¸‹ä¸€ä¸ªhblk</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">hblk</span> * hb_prev; <span class="hljs-comment">//æŒ‡å‘ä¸Šä¸€ä¸ªhblk</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">hblk</span> * hb_block; <span class="hljs-comment">//å¯¹åº”çš„hblk</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> hb_obj_kind; <span class="hljs-comment">//kinkç±»å‹</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> hb_flags; <span class="hljs-comment">//æ ‡è®°ä½</span>
    <span class="hljs-type">word</span> hb_sz; <span class="hljs-comment">//å¦‚æœç»™ä¸Šå±‚ä½¿ç”¨ï¼Œåˆ™è¡¨ç¤ºå®é™…åˆ†é…çš„å•ä½ï¼Œå¦‚æœç©ºé—²ï¼Œåˆ™è¡¨ç¤ºå†…å­˜å—çš„å¤§å°</span>
    <span class="hljs-type">word</span> hb_descr; 
    <span class="hljs-type">size_t</span> hb_n_marks;<span class="hljs-comment">//æ ‡è®°ä½ä¸ªæ•°ï¼Œç”¨äºGC</span>
    <span class="hljs-type">word</span> hb_marks[MARK_BITS_SZ]; <span class="hljs-comment">//æ ‡è®°ä¸ºï¼Œç”¨äºGC</span>
}
</code></pre>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aefea5cd7aa944c7bb2840c318f282fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=qDYIOebkvOWn%2FZ%2FkUA6El5x6%2B94%3D" alt="" loading="lazy"/></p>
<p><strong>5. hblkå†…å­˜å—æŸ¥è¯¢</strong></p>
<pre><code class="hljs language-ini" lang="ini">structh blk *GC_allochblk(size_t sz, int kind, unsigned flags/* IGNORE_OFF_PAGE or 0 */)
{
    ...
    //1.è®¡ç®—éœ€è¦çš„å†…å­˜å—å¤§å°
    <span class="hljs-attr">blocks_needed</span> = OBJ_SZ_TO_BLOCKS_CHECKED(sz)<span class="hljs-comment">;</span>
    <span class="hljs-attr">start_list</span> = GC_hblk_fl_from_blocks(blocks_needed)<span class="hljs-comment">;</span>

    //2.æŸ¥æ‰¾ç²¾ç¡®çš„hblkå†…å­˜å—
    <span class="hljs-attr">result</span> = GC_allochblk_nth(sz, kind, flags, start_list, <span class="hljs-literal">FALSE</span>)<span class="hljs-comment">;</span>
    if (0 != result) return result<span class="hljs-comment">;</span>

    <span class="hljs-attr">may_split</span> = <span class="hljs-literal">TRUE</span><span class="hljs-comment">;</span>
    ...
    if (start_list &amp;lt<span class="hljs-comment">; UNIQUE_THRESHOLD) {</span>
        ++start_list<span class="hljs-comment">;</span>
    }
    //3.ä»æ›´å¤§çš„å†…å­˜å—é“¾è¡¨ä¸­æ‰¾
    for (<span class="hljs-comment">; start_list &amp;lt;= split_limit; ++start_list) {</span>
        <span class="hljs-attr">result</span> = GC_allochblk_nth(sz, kind, flags, start_list, may_split)<span class="hljs-comment">;</span>
        if (0 != result) break<span class="hljs-comment">;</span>
    }
    return result<span class="hljs-comment">;</span>
}

STATIC int GC_hblk_fl_from_blocks(word blocks_needed)
{
    if (blocks_needed &amp;lt<span class="hljs-comment">;= 32) return blocks_needed;</span>
    if (blocks_needed &amp;gt<span class="hljs-comment">;= 256) return (256-32)/8+32;</span>
    return (blocks_needed-32)/8+32<span class="hljs-comment">;</span>
}
</code></pre>
<p>å…ˆæ ¹æ®ä¸Šå±‚éœ€è¦åˆ†é…çš„å†…å­˜å¤§å°è®¡ç®—å‡ºéœ€è¦çš„å†…å­˜å—å¤§å°ï¼Œå¦‚æœç”³è¯·çš„å¤§å°å°äº4096å­—èŠ‚ï¼Œåˆ™ç»“æœæ˜¯1ï¼Œå¯¹äºå°å¯¹è±¡å†…å­˜å—çš„ä¸ªæ•°å°±æ˜¯1ã€‚</p>
<p>æ ¹æ®å®é™…éœ€è¦çš„å†…å­˜å—æ•°ï¼Œåˆ¤æ–­å¹¶å†³å®šä»å“ªä¸€ä¸ªGC_hblkfreelisté“¾è¡¨æŸ¥æ‰¾ï¼Œstart_listæ˜¯å¼€å§‹æŸ¥æ‰¾çš„é“¾è¡¨indexï¼Œå³ä»GC_hblkfreelist[start_list]å¼€å§‹æŸ¥æ‰¾ã€‚å¹¶ä¸æ˜¯éœ€è¦blocksï¼Œå°±ä¸€å®šä¼šä»GC_hblkfreelist[blocks]çš„é“¾è¡¨ä¸­æŸ¥æ‰¾ï¼Œéµå¾ªè½¬æ¢è§„åˆ™ï¼ˆå°å†…å­˜ç´¢å¼•æ˜¯è¿ç»­çš„ï¼Œä¸­å†…å­˜ç´¢å¼•æ˜¯32+8çš„æ­¥é•¿ï¼Œå¤§ç‚¹çš„å†…å­˜ç´¢å¼•éƒ½æ˜¯60ï¼‰ã€‚</p>
<ul>
<li>å¦‚æœblocks_neededå°äº32ï¼Œåˆ™startlist=blocks_neededï¼Œç›´æ¥å»GC_hblkfreelist[blocks_needed]ä¸­æŸ¥æ‰¾ã€‚</li>
<li>å¦‚æœblocks_neededä½äº32ï½256ï¼Œåˆ™startlist=(blocks_needed-32)/8+32ï¼Œå³blocks_neededæ¯å¢åŠ 8ä¸ªï¼Œå¯¹åº”GC_hblkfreelist[index]çš„indexå¢åŠ 1ã€‚</li>
<li>å¦‚æœblocks_neededå¤§äº256ï¼Œåˆ™éƒ½ä»GC_hblkfreelist[60]é“¾è¡¨ä¸­æŸ¥æ‰¾ã€‚</li>
</ul>
<p>å†³å®šä»å“ªä¸ªé“¾è¡¨å¼€å§‹æŸ¥æ‰¾ä¹‹åï¼Œé¦–å…ˆè¿›è¡Œç²¾ç¡®æŸ¥æ‰¾ï¼Œå¦‚æœç›´æ¥æ‰¾åˆ°ï¼Œåˆ™ç›´æ¥è¿”å›æ‰¾åˆ°çš„å†…å­˜å—ã€‚</p>
<p>å¦‚æœç²¾å‡†æŸ¥æ‰¾å¤±è´¥ï¼Œåˆ™é€æ¸å¢å¤§start_listï¼Œä»æ›´å¤§çš„å†…å­˜å—é“¾è¡¨ä¸­æŸ¥æ‰¾ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">STATIC struct hblk *GC_allochblk_nth(size_t sz, int kind, unsigned flags, int n, int may_split)
{
    struct hblk *hbp<span class="hljs-comment">;</span>
    hdr * hhdr<span class="hljs-comment">;</span>
    struct hblk *thishbp<span class="hljs-comment">;</span>
    hdr * thishdr<span class="hljs-comment">;/* Header corr. to thishbp */</span>
    //è®¡ç®—éœ€è¦åˆ†é…çš„å†…å­˜å—å¤§å°
    signed_word <span class="hljs-attr">size_needed</span> = HBLKSIZE * OBJ_SZ_TO_BLOCKS_CHECKED(sz)<span class="hljs-comment">;</span>

    //ä»é“¾è¡¨ä¸­æŸ¥æ‰¾åˆé€‚çš„å†…å­˜å—
    for (<span class="hljs-attr">hbp</span> = GC_hblkfreelist[n]<span class="hljs-comment">;; hbp = hhdr -&amp;gt; hb_next) {</span>
        signed_word size_avail<span class="hljs-comment">;</span>
        if (<span class="hljs-attr">NULL</span> == hbp) return NULL<span class="hljs-comment">;</span>
        //è·å–å†…å­˜å—çš„headerä¿¡æ¯
        GET_HDR(hbp, hhdr)<span class="hljs-comment">;</span>
        //å†…å­˜å—å¤§å°
        <span class="hljs-attr">size_avail</span> = (signed_word)hhdr-&amp;gt<span class="hljs-comment">;hb_sz;</span>
        if (size_avail &amp;lt<span class="hljs-comment">; size_needed) continue;</span>
        //å¯ç”¨å†…å­˜å¤§äºéœ€è¦çš„åˆ†é…çš„å¤§å°
        if (size_avail != size_needed) {
            //è¦æ±‚ç²¾å‡†ä¸åˆ†å‰²ï¼Œé€€å‡ºå¾ªç¯ï¼Œè¿”å›ç©º
            if (!may_split) continue<span class="hljs-comment">;</span>
            ...
            if( size_avail &amp;gt<span class="hljs-comment">;= size_needed ) {</span>
                ...
                //åˆ†å‰²å†…å­˜å—ï¼Œä¿®æ”¹é“¾è¡¨
                <span class="hljs-attr">hbp</span> = GC_get_first_part(hbp, hhdr, size_needed, n)<span class="hljs-comment">;</span>
                break<span class="hljs-comment">;</span>
            }
        }
    }
    if (<span class="hljs-attr">0</span> == hbp) return0<span class="hljs-comment">;</span>
    ...
    //ä¿®æ”¹headerä¿¡æ¯
    setup_header(hhdr, hbp, sz, kind, flags)
    ...
    return hbp<span class="hljs-comment">;</span>
}
</code></pre>
<p>å½“åˆ†é…å­—èŠ‚çš„æ—¶å€™å…ˆé€šè¿‡ç²¾ç¡®æŸ¥æ‰¾å¦‚æœå‘ç°æœ‰ç²¾ç¡®å†…å­˜ï¼Œåˆ™ä¼šè¿”å›ç›¸åº”çš„å†…å­˜å—ï¼Œå¦‚æœæ²¡æœ‰å‘ç°ç²¾ç¡®å†…å­˜åˆ™ä¼šå»æŸ¥æ‰¾æ›´å¤§çš„å†…å­˜å—å¹¶è¿›è¡Œåˆ†å‰²ï¼Œä¸€åŠè¿”å›ä½¿ç”¨ï¼Œä¸€åŠæ”¾åˆ°æ± å­é‡Œã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0fe256709ad44fc82351465bd12f236~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=XeX71r3flXI06hJLQ9RQ4bICaug%3D" alt="" loading="lazy"/></p>
<p align="center">æ‹†åˆ†ç¤ºæ„</p>
<p>å¦‚ä¸Šå›¾ç¤ºä¾‹ï¼Œå¦‚æœè¦ç”³è¯·1KBï¼Œåˆ™ä¼šå…ˆæ‰¾4KBï¼Œå¦‚æœæ²¡æœ‰4KBåˆ™å»æ‰¾8KBï¼Œæ‰¾åˆ°äº†8KBå°±è¿›è¡Œä¸¤ä¸ª4KBçš„æ‹†åˆ†ï¼Œç„¶åç§»é™¤8KBå‡ºæ± å­ï¼Œå†æŠŠæ‹†åˆ†è¿‡çš„å¦ä¸€åŠ4KBå†…å­˜å—åŠ å…¥åˆ°æ± å­é‡Œï¼š</p>
<pre><code class="hljs language-scss" lang="scss">STATIC struct hblk *<span class="hljs-built_in">GC_get_first_part</span>(struct hblk *h, hdr *hhdr, size_t bytes, int index) {
    word total_size = hhdr -&amp;gt; hb_sz;
    struct hblk * <span class="hljs-attribute">rest</span>;
    hdr * rest_hdr;
    <span class="hljs-comment">//ä»ç©ºé—²é“¾è¡¨åˆ é™¤</span>
    <span class="hljs-built_in">GC_remove_from_fl_at</span>(hhdr, index);
    if (total_size == bytes) return h;
    <span class="hljs-comment">//ååŠéƒ¨åˆ†</span>
    <span class="hljs-attribute">rest</span> = (struct hblk *)((word)h + bytes);
    <span class="hljs-comment">//ç”Ÿæˆheaderä¿¡æ¯</span>
    rest_hdr = <span class="hljs-built_in">GC_install_header</span>(rest);
    <span class="hljs-comment">//å†…å­˜å—å¤§å°</span>
    rest_hdr -&amp;gt; hb_sz = total_size - bytes;
    rest_hdr -&amp;gt; hb_flags = <span class="hljs-number">0</span>;
    ...
    <span class="hljs-comment">//åŠ å…¥ç›¸åº”çš„ç©ºé—²é“¾è¡¨</span>
    <span class="hljs-built_in">GC_add_to_fl</span>(rest, rest_hdr);
}
</code></pre>
<p><strong>6. å†…å­˜å—åˆ†é…</strong><br/>
å¦‚æœGC_hblkfreelistç©ºé—²é“¾è¡¨ä¸­æ‰¾ä¸åˆ°åˆé€‚çš„å†…å­˜å—ï¼Œåˆ™è€ƒè™‘ä»ç³»ç»Ÿå¼€è¾Ÿä¸€æ®µæ–°çš„å†…å­˜ï¼Œå¹¶æ·»åŠ åˆ°GC_hblkfreelisté“¾è¡¨ä¸­ã€‚åœ¨GC_expand_hp_inneræ–¹æ³•ä¸­å®ç°ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">GC_INNER GC_bool <span class="hljs-built_in">GC_expand_hp_inner</span>(word n)
{
    ...
    <span class="hljs-comment">//è°ƒç”¨ç³»ç»Ÿæ–¹å¼å¼€è¾Ÿå†…å­˜</span>
    space = <span class="hljs-built_in">GET_MEM</span>(bytes);
    <span class="hljs-comment">//è®°å½•å†…å­˜åœ°å€å’Œå¤§å°</span>
    <span class="hljs-built_in">GC_add_to_our_memory</span>((ptr_t)space, bytes);
    ...
    <span class="hljs-comment">//æ·»åŠ åˆ°GC_hblkfreelisté“¾è¡¨ä¸­</span>
    <span class="hljs-built_in">GC_add_to_heap</span>(space, bytes);
    ...
}
</code></pre>
<p>GC_add_to_heapæ–¹æ³•å°†åˆ›å»ºå‡ºæ¥çš„å†…å­˜å—åŠ å…¥ç›¸åº”çš„GC_hblkfreelisté“¾è¡¨ä¸­ã€‚åŒæ—¶åŠ å…¥ä¸€ä¸ªå…¨å±€çš„å­˜æ”¾å †å†…å­˜ä¿¡æ¯çš„æ•°ç»„ä¸­ã€‚</p>
<p>å…¶ä¸­å¦‚æœå‘ç°å†…å­˜è¿ç»­çš„å‰åå†…å­˜å—å­˜åœ¨ä¸”ç©ºé—²ï¼Œåˆ™åˆå¹¶å‰åçš„å†…å­˜å—ï¼Œç”Ÿæˆä¸€ä¸ªæ›´å¤§çš„å†…å­˜å—ã€‚</p>
<p><strong>7. ok_freeList</strong><br/>
åœ¨GC_new_hblkä¸­è°ƒç”¨GC_build_flæ–¹æ³•æ„å»ºé“¾è¡¨ï¼Œå°±æ˜¯è¿™ä¸ªGCç³»ç»Ÿçš„ç¼“å­˜æ± æ ¸å¿ƒæ•°æ®ç»“æ„ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">//æ„å»ºok_freelist<span class="hljs-section">[gran]</span>
GC_obj_kinds<span class="hljs-section">[kind]</span>.ok_freelist<span class="hljs-section">[gran]</span> = GC_build_fl(h, GRANULES_TO_WORDS(gran), clear,(ptr_t)GC_obj_kinds<span class="hljs-section">[kind]</span>.ok_freelist<span class="hljs-section">[gran]</span>)<span class="hljs-comment">;</span>

GC_INNER ptr_t GC_build_fl(struct hblk *h, size_t sz, GC_bool clear,
ptr_t list) {
    word *p, *prev<span class="hljs-comment">;</span>
    word *last_object<span class="hljs-comment">;/* points to last object in new hblk*/</span>
    ...
    //æ„å»ºé“¾è¡¨
    <span class="hljs-attr">p</span> = (word *)(h -&amp;gt<span class="hljs-comment">; hb_body) + sz;/* second object in *h*/</span>
    <span class="hljs-attr">prev</span> = (word *)(h -&amp;gt<span class="hljs-comment">; hb_body);/* One object behind p*/</span>
    <span class="hljs-attr">last_object</span> = (word *)((char *)h + HBLKSIZE)<span class="hljs-comment">;</span>
    last_object <span class="hljs-attr">-</span>= sz<span class="hljs-comment">;</span>
    while ((word)p &amp;lt<span class="hljs-comment">;= (word)last_object) {</span>
        /* current object's link points to last object */
        obj_link(p) = (ptr_t)prev<span class="hljs-comment">;</span>
        <span class="hljs-attr">prev</span> = p<span class="hljs-comment">;</span>
        p += sz<span class="hljs-comment">;</span>
    }
    p <span class="hljs-attr">-</span>= sz<span class="hljs-comment">;</span>

    //æ‹¼æ¥ä¹‹å‰çš„é“¾è¡¨
    *(ptr_t *)<span class="hljs-attr">h</span> = list<span class="hljs-comment">;</span>
    //è¿”å›å…¥å£åœ°å€
    return ((ptr_t)p)<span class="hljs-comment">;</span>
}
</code></pre>
<p>ä»¥4096å­—èŠ‚çš„å†…å­˜å—åˆ’åˆ†ä¸º16å­—èŠ‚å•å…ƒçš„freeListä¸ºä¾‹ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>4096å­—èŠ‚æŒ‰ç…§16å­—èŠ‚åˆ†é…ï¼Œåˆ’åˆ†ä¸º256ä¸ªå°å†…å­˜å—ï¼Œç¼–å·æ˜¯0ï½255ï¼Œå°†æœ€åä¸€ä¸ªå†…å­˜å—ï¼ˆ255ï¼‰ä½œä¸ºæ–°é“¾è¡¨çš„é¦–èŠ‚ç‚¹ã€‚</li>
<li>å†…å­˜åœ°å€å‘å‰éå†ï¼Œå»ºç«‹é“¾è¡¨ï¼Œå³255çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯254ï¼Œå°¾èŠ‚ç‚¹æ˜¯0ã€‚</li>
<li>å°†å°¾èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘åŸé“¾è¡¨çš„é¦–åœ°å€ã€‚</li>
<li>å°†æ–°é“¾è¡¨çš„é¦–èŠ‚ç‚¹åœ°å€ä½œä¸ºok_freelist[N]ï¼ŒNæ˜¯ä¸Šæ–‡æåˆ°çš„GRANULEï¼Œä¾‹å¦‚16å­—èŠ‚å¯¹åº”1ã€‚</li>
</ol>
<p>é‡å»ºå¥½çš„freeListï¼Œå¹¶å°†é¦–èŠ‚ç‚¹æä¾›ç»™ä¸Šå±‚ä½¿ç”¨ã€‚</p>
<blockquote>
<h3 data-id="heading-4"><strong>äº”ã€Boehm GCï¼šå¤§å†…å­˜åˆ†é…</strong></h3>
</blockquote>
<p>åˆ†é…å¤§å†…å­˜å¯¹è±¡æ˜¯æŒ‡åˆ†é…çš„å†…å­˜å¤§äº2048å­—èŠ‚ã€‚</p>
<p>OBJ_SZ_TO_BLOCKSç”¨äºè®¡ç®—éœ€è¦çš„hblkå†…å­˜å—çš„ä¸ªæ•°ï¼Œå¯¹äºå¤§å†…å­˜ï¼Œéœ€è¦çš„ä¸ªæ•°å¤§äºç­‰äº1ã€‚ä¾‹å¦‚éœ€è¦åˆ†é…9000å­—èŠ‚çš„å†…å­˜ï¼Œåˆ™éœ€è¦3ä¸ªhblkå†…å­˜å—ï¼Œç„¶åè°ƒç”¨GC_alloc_largeåˆ†é…å†…å­˜ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">GC_INNER ptr_t GC_alloc_large(size_t lb, int k, unsigned flags)
{
    struct hblk * h<span class="hljs-comment">;</span>
    word n_blocks<span class="hljs-comment">;</span>
    ptr_t result<span class="hljs-comment">;</span>
    ...
    <span class="hljs-attr">n_blocks</span> = OBJ_SZ_TO_BLOCKS_CHECKED(lb)<span class="hljs-comment">;</span>
    ...
    //åˆ†é…å†…å­˜
    <span class="hljs-attr">h</span> = GC_allochblk(lb, k, flags)<span class="hljs-comment">;</span>
    ...
    //åˆ†é…å¤±è´¥ï¼Œç³»ç»Ÿåˆ†é…å†…å­˜å—åç»§ç»­å°è¯•åˆ†é…
    while (<span class="hljs-attr">0</span> == h &amp;amp<span class="hljs-comment">;&amp;amp; GC_collect_or_expand(n_blocks, flags != 0, retry)) {</span>
        <span class="hljs-attr">h</span> = GC_allochblk(lb, k, flags)<span class="hljs-comment">;</span>
        <span class="hljs-attr">retry</span> = <span class="hljs-literal">TRUE</span><span class="hljs-comment">;</span>
    }
    //è®°å½•å¤§å†…å­˜åˆ›å»ºå¤§å°
    size_t <span class="hljs-attr">total_bytes</span> = n_blocks * HBLKSIZE<span class="hljs-comment">;</span>
    ...
    GC_large_allocd_bytes += total_bytes<span class="hljs-comment">;</span>
    ...
    <span class="hljs-attr">result</span> = h -&amp;gt<span class="hljs-comment">; hb_body;</span>
    //è¿”å›å†…å­˜åœ°å€
    return result<span class="hljs-comment">;</span>
}
</code></pre>
<p>å¤§å†…å­˜åˆ†é…çš„å†…å­˜æŸ¥æ‰¾å’Œå°å¯¹è±¡æ–¹å¼ä¸€æ ·ï¼Œä¼šä¸æ–­å¢åŠ start_listã€‚ä»æ›´å¤§çš„é“¾è¡¨ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰ç©ºé—²å†…å­˜ï¼Œä¸åŒçš„æ˜¯ï¼Œå¦‚æœæŸ¥æ‰¾åˆ°äº†ç©ºé—²å†…å­˜ä¸ä¼šåˆ†è£‚æ„å»ºok_freeListé“¾è¡¨è€Œæ˜¯ç›´æ¥è¿”å›å¤§å†…å­˜å—çš„åœ°å€æä¾›ä½¿ç”¨ã€‚</p>
<blockquote>
<h3 data-id="heading-5"><strong>å…­ã€Boehm GCï¼šå†…å­˜åˆ†é…æµç¨‹å›¾</strong></h3>
</blockquote>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0004034118574f9ebbbe312025c11cfb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L6R6JmO56eR5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632378&amp;x-signature=826YQRd7v9%2BtdmVhm5LNSyC%2BV18%3D" alt="" loading="lazy"/></p>
<p align="center">ç¤ºæ„</p>
<blockquote>
<h3 data-id="heading-6"><strong>ä¸ƒã€é¢å¤–ï¼šSGen GC</strong></h3>
</blockquote>
<p>Simple Generational Garbage Collectionç®€ç§°SGen GCï¼Œæ˜¯ç›¸æ¯”Boehm GCï¼ˆè´å§†GCï¼‰æ›´ä¸ºå…ˆè¿›çš„ä¸€ç§GCæ–¹å¼ã€‚å®˜æ–¹Monoåœ¨2.8ç‰ˆæœ¬ä¸­å¢åŠ äº†SGen GCï¼Œä½†é»˜è®¤çš„ä»æ˜¯Boehm GCã€‚3.2ç‰ˆæœ¬ä¹‹åï¼ŒMonoæ­£å¼å°†SGen GCä½œä¸ºé»˜è®¤GCæ–¹å¼ã€‚</p>
<p>SGen GCå°†å †å†…å­˜åˆ†ä¸ºåˆç”Ÿä»£ï¼ˆNurseryï¼‰å’Œæ—§ç”Ÿä»£ï¼ˆOld Generationï¼‰ä¸¤ä»£è¿›è¡Œç®¡ç†ï¼Œå¹¶åŒ…å«ä¸¤ä¸ªGCè¿‡ç¨‹ï¼šMinor GCå¯¹åˆç”Ÿä»£è¿›è¡Œæ¸…ç†ï¼›Major GCå¯¹åˆç”Ÿä»£å’Œæ—§ç”Ÿä»£åŒæ—¶è¿›è¡Œæ¸…ç†ã€‚</p>
<p><strong>1. å†…å­˜åˆ†é…ç­–ç•¥ - åˆä»£</strong><br/>
åœ¨SGen GCä¸­ï¼Œåˆç”Ÿä»£æ˜¯ä¸€å—å›ºå®šå¤§å°çš„è¿ç»­å†…å­˜ï¼Œé»˜è®¤ä¸º4MBï¼Œå¯ä»¥é€šè¿‡é…ç½®ä¿®æ”¹ã€‚è¿™ä¸€ç‚¹ä¸G1ä¸åŒï¼Œåœ¨G1ä¸­åŒä¸€ä»£çš„Regionåœ¨ç‰©ç†ä¸Šæ˜¯ä¸è¦æ±‚è¿ç»­çš„ã€‚</p>
<p>ä¸ºäº†æ”¯æŒå¤šçº¿ç¨‹å·¥ä½œï¼Œæ–°å¯¹è±¡çš„å†…å­˜åˆ†é…ä¾ç„¶åœ¨æ¯ä¸ªçº¿ç¨‹çš„TLABä¸­è¿›è¡Œï¼Œå½“å‰æ¯ä¸ªTLABå‡ä¸º4KBï¼Œæœ‰æåˆ°å¯èƒ½ä¼šåœ¨ä¸ä¹…åè¿›è¡Œä¼˜åŒ–ã€‚è€Œåœ¨TLABå†…éƒ¨ï¼Œå†…å­˜åˆ†é…æ˜¯é€šè¿‡æŒ‡é’ˆç¢°æ’çš„æ–¹å¼è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨SGen GCä¸­ï¼Œåˆç”Ÿä»£å†…å­˜å¹¶æ²¡æœ‰è¿›è¡Œç²’åº¦åˆ’åˆ†ä¹Ÿæ²¡æœ‰åˆ†å—ç®¡ç†ã€‚</p>
<p>åˆç”Ÿä»£å¯¹è±¡è·ŸéšMinor GCå’ŒMajor GCè¿›è¡Œå›æ”¶ã€‚</p>
<p><strong>2. å†…å­˜åˆ†é…ç­–ç•¥ - æ—§ä»£</strong><br/>
åœ¨SGen GCä¸­ï¼Œæ—§ç”Ÿä»£å†…å­˜åˆ’åˆ†æ–¹å¼å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š<br/>
Sectionï¼ˆ1MBï¼‰ â†’ Blockï¼ˆ16KBï¼‰â†’ Pageï¼ˆ4KBï¼‰â†’ Slotï¼ˆä¸åŒç²’åº¦ï¼‰</p>
<p>åœ¨ä½¿ç”¨å†…å­˜æ—¶ï¼ŒæŒ‰ç…§ä¸Šè¿°é“¾æ¡ä¾æ¬¡å‘ä¸‹æ‹†åˆ†ï¼Œä¸è´å§†GCç›¸åŒï¼ŒåŒä¸€ä¸ªBlockä¸­çš„Pageä¹Ÿåªèƒ½æ‹†åˆ†æˆ<strong>ç›¸åŒç²’åº¦</strong>çš„Slotã€‚</p>
<p>è™½ç„¶åœ¨åˆç”Ÿä»£ä¸­å¹¶æ²¡æœ‰åˆ’åˆ†å†…å­˜ç²’åº¦ï¼Œä½†æ˜¯å½“å¯¹è±¡<strong>ä»åˆç”Ÿä»£è½¬ç§»åˆ°æ—§ç”Ÿä»£</strong>æ—¶ä¼š<strong>æ‰¾åˆ°å¯¹åº”ç²’åº¦</strong>çš„Slotè¿›è¡Œ<strong>å­˜å‚¨</strong>ã€‚<strong>é‡Šæ”¾</strong>å¯¹è±¡æ—¶ï¼Œå¯¹åº”çš„Slotä¹Ÿä¼š<strong>è¿”è¿˜ç»™ç©ºé—²é“¾è¡¨</strong>ï¼ˆç±»ä¼¼è´å§†GCä¸­çš„ok_freeListï¼‰ï¼Œå¹¶åœ¨<strong>æŸä¸€çº§ç»“æ„å®Œå…¨æ¸…ç©ºæ—¶ä¾æ¬¡å‘ä¸Šä¸€çº§è¿”è¿˜</strong>ã€‚</p>
<p>æ—§ç”Ÿä»£å†…å­˜æœ€ç»ˆæ˜¯é€šè¿‡ä¸€ä¸ªGCMemSectionç»“æ„çš„é“¾è¡¨è¿›è¡Œç®¡ç†çš„ã€‚</p>
<p><strong>3. å†…å­˜åˆ†é…ç­–ç•¥ - å¤§å¯¹è±¡</strong><br/>
è¶…è¿‡8KBçš„å¯¹è±¡å‡è¢«è§†ä¸ºå¤§å¯¹è±¡ï¼Œå¤§å¯¹è±¡é€šè¿‡å•ç‹¬çš„LOSSectionç»“æ„è¿›è¡Œç®¡ç†ã€‚è€Œå¤§å¯¹è±¡çš„å†…å­˜ç®¡ç†åˆåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li>ä¸è¶…è¿‡1MBçš„ï¼Œä»ç„¶å­˜å‚¨åœ¨Monoè‡ªå·±çš„æ‰˜ç®¡å †ä¸Šï¼Œæ¸…ç†åè¿”è¿˜ç»™æ‰˜ç®¡å †ï¼›</li>
<li>è¶…è¿‡1MBçš„ï¼Œç›´æ¥ä»æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œæ¸…ç†åå†…å­˜ä¹ŸåŒæ ·è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿã€‚</li>
</ul>
<p><strong>4. å†…å­˜åˆ†é…ç­–ç•¥ - å›ºå®šå†…å­˜å¯¹è±¡</strong><br/>
æœ‰ä¸€äº›å¯¹è±¡è¢«æ˜¾å¼æˆ–éšå¼åœ°æ ‡è®°ä¸ºäº†å›ºå®šå†…å­˜çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨åˆå§‹æ—¶ä¾ç„¶è¢«åˆ†é…åœ¨åˆç”Ÿä»£ä¸­ï¼Œä½†ä¸ä¼šè¢«GCè¿‡ç¨‹ç§»åŠ¨ä½ç½®ã€‚</p>
<ul>
<li>æ˜¾å¼ï¼šç”¨æˆ·æ˜¾å¼å£°æ˜çš„ï¼Œæ¯”å¦‚é€šè¿‡fixedå…³é”®å­—è¿›è¡Œä¿®é¥°ï¼›</li>
<li>éšå¼ï¼šåœ¨GCå¼€å§‹æ—¶ï¼Œæ‰€æœ‰å¯„å­˜å™¨å’ŒROOTä¸­ç›´æ¥æŒ‡å‘çš„å¯¹è±¡éƒ½è§†ä¸ºå›ºå®šå†…å­˜å¯¹è±¡ã€‚</li>
</ul>
<hr/>
<p>è¿™æ˜¯ä¾‘è™ç§‘æŠ€ç¬¬1924ç¯‡æ–‡ç« ï¼Œæ„Ÿè°¢ä½œè€…Jaminä¾›ç¨¿ã€‚æ¬¢è¿è½¬å‘åˆ†äº«ï¼Œæœªç»ä½œè€…æˆæƒè¯·å‹¿è½¬è½½ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•ç‹¬åˆ°çš„è§è§£æˆ–è€…å‘ç°ä¹Ÿæ¬¢è¿è”ç³»æˆ‘ä»¬ï¼Œä¸€èµ·æ¢è®¨ã€‚</p>
<p>ä½œè€…ä¸»é¡µï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fliang-zhi-ming-70" target="_blank" title="https://www.zhihu.com/people/liang-zhi-ming-70" ref="nofollow noopener noreferrer">www.zhihu.com/people/lianâ€¦</a></p>
<p>å†æ¬¡æ„Ÿè°¢Jaminçš„åˆ†äº«ï¼Œå¦‚æœæ‚¨æœ‰ä»»ä½•ç‹¬åˆ°çš„è§è§£æˆ–è€…å‘ç°ä¹Ÿæ¬¢è¿è”ç³»æˆ‘ä»¬ï¼Œä¸€èµ·æ¢è®¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç°ä»£PHPå¼€å‘å®æˆ˜]]></title>    <link>https://juejin.cn/post/7584725529876840498</link>    <guid>https://juejin.cn/post/7584725529876840498</guid>    <pubDate>2025-12-18T03:14:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584725529876840498" data-draft-id="7584725529876824114" data-original-type="2" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç°ä»£PHPå¼€å‘å®æˆ˜"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2025-12-18T03:14:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="PFinalç¤¾åŒº_å—ä¸"/> <meta itemprop="url" content="https://juejin.cn/user/1855631357906040"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç°ä»£PHPå¼€å‘å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631357906040/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    PFinalç¤¾åŒº_å—ä¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:14:16.000Z" title="Thu Dec 18 2025 03:14:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PHP 8.x é«˜é˜¶å®æˆ˜ï¼šæ¶æ„ã€æ€§èƒ½ä¸å·¥ç¨‹åŒ–</h2>
<h3 data-id="heading-1">ç›®å½•</h3>
<ul>
<li><a href="#%E5%AF%BC%E8%A8%80php-8x---%E6%96%B0%E8%8C%83%E5%BC%8F%E4%B8%8E%E6%96%B0%E6%9C%BA%E9%81%87" title="#%E5%AF%BC%E8%A8%80php-8x---%E6%96%B0%E8%8C%83%E5%BC%8F%E4%B8%8E%E6%96%B0%E6%9C%BA%E9%81%87">å¯¼è¨€ï¼šPHP 8.x - æ–°èŒƒå¼ä¸æ–°æœºé‡</a></li>
<li><a href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E8%AF%AD%E8%A8%80%E6%A0%B8%E5%BF%83%E4%B8%8E%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7-the-php-8x-core" title="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E8%AF%AD%E8%A8%80%E6%A0%B8%E5%BF%83%E4%B8%8E%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7-the-php-8x-core">ç¬¬ä¸€éƒ¨åˆ†ï¼šè¯­è¨€æ ¸å¿ƒä¸é«˜çº§ç‰¹æ€§ (The PHP 8.x Core)</a>
<ul>
<li><a href="#%E7%AC%AC1%E7%AB%A0php-8x-%E6%96%B0%E7%89%B9%E6%80%A7%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%BA%94%E7%94%A8" title="#%E7%AC%AC1%E7%AB%A0php-8x-%E6%96%B0%E7%89%B9%E6%80%A7%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%BA%94%E7%94%A8">ç¬¬1ç« ï¼šPHP 8.x æ–°ç‰¹æ€§æ·±åº¦è§£æä¸åº”ç”¨</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%E7%8E%B0%E4%BB%A3%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%AE%BE%E8%AE%A1-advanced-architecture--design" title="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%E7%8E%B0%E4%BB%A3%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%AE%BE%E8%AE%A1-advanced-architecture--design">ç¬¬äºŒéƒ¨åˆ†ï¼šç°ä»£æ¶æ„ä¸è®¾è®¡ (Advanced Architecture &amp; Design)</a>
<ul>
<li><a href="#%E7%AC%AC2%E7%AB%A0%E8%B6%85%E8%B6%8Amvc%E6%9E%84%E5%BB%BA%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%8C%96%E6%9E%B6%E6%9E%84" title="#%E7%AC%AC2%E7%AB%A0%E8%B6%85%E8%B6%8Amvc%E6%9E%84%E5%BB%BA%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%8C%96%E6%9E%B6%E6%9E%84">ç¬¬2ç« ï¼šè¶…è¶ŠMVCï¼šæ„å»ºå¯æ‰©å±•çš„æœåŠ¡åŒ–æ¶æ„</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E4%B8%93%E9%A2%98%E6%B7%B1%E6%BD%9C-topical-deep-dives" title="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E4%B8%93%E9%A2%98%E6%B7%B1%E6%BD%9C-topical-deep-dives">ç¬¬ä¸‰éƒ¨åˆ†ï¼šä¸“é¢˜æ·±æ½œ (Topical Deep Dives)</a>
<ul>
<li><a href="#%E7%AC%AC3%E7%AB%A0%E6%A1%86%E6%9E%B6%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8%E4%B8%8E%E5%8E%9F%E7%90%86-%E4%BB%A5laravel%E4%B8%BA%E4%BE%8B" title="#%E7%AC%AC3%E7%AB%A0%E6%A1%86%E6%9E%B6%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8%E4%B8%8E%E5%8E%9F%E7%90%86-%E4%BB%A5laravel%E4%B8%BA%E4%BE%8B">ç¬¬3ç« ï¼šæ¡†æ¶é«˜çº§åº”ç”¨ä¸åŸç† (ä»¥Laravelä¸ºä¾‹)</a></li>
<li><a href="#%E7%AC%AC4%E7%AB%A0%E9%AB%98%E6%80%A7%E8%83%BDapi%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0" title="#%E7%AC%AC4%E7%AB%A0%E9%AB%98%E6%80%A7%E8%83%BDapi%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0">ç¬¬4ç« ï¼šé«˜æ€§èƒ½APIè®¾è®¡ä¸å®ç°</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%BC%82%E6%AD%A5php%E9%87%8A%E6%94%BE%E6%9E%81%E8%87%B4%E6%80%A7%E8%83%BD" title="#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%BC%82%E6%AD%A5php%E9%87%8A%E6%94%BE%E6%9E%81%E8%87%B4%E6%80%A7%E8%83%BD">ç¬¬äº”éƒ¨åˆ†ï¼šå¹¶å‘ä¸å¼‚æ­¥PHPï¼šé‡Šæ”¾æè‡´æ€§èƒ½</a>
<ul>
<li><a href="#%E7%AC%AC5%E7%AB%A0%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%BC%82%E6%AD%A5php%E9%87%8A%E6%94%BE%E6%9E%81%E8%87%B4%E6%80%A7%E8%83%BD" title="#%E7%AC%AC5%E7%AB%A0%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%BC%82%E6%AD%A5php%E9%87%8A%E6%94%BE%E6%9E%81%E8%87%B4%E6%80%A7%E8%83%BD">ç¬¬5ç« ï¼šå¹¶å‘ä¸å¼‚æ­¥PHPï¼šé‡Šæ”¾æè‡´æ€§èƒ½</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%E5%9D%9A%E4%B8%8D%E5%8F%AF%E6%91%A7%E7%9A%84%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F" title="#%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%E5%9D%9A%E4%B8%8D%E5%8F%AF%E6%91%A7%E7%9A%84%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F">ç¬¬å…­éƒ¨åˆ†ï¼šåšä¸å¯æ‘§çš„ä»£ç è´¨é‡</a>
<ul>
<li><a href="#%E7%AC%AC6%E7%AB%A0%E5%9D%9A%E4%B8%8D%E5%8F%AF%E6%91%A7%E7%9A%84%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F" title="#%E7%AC%AC6%E7%AB%A0%E5%9D%9A%E4%B8%8D%E5%8F%AF%E6%91%A7%E7%9A%84%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F">ç¬¬6ç« ï¼šåšä¸å¯æ‘§çš„ä»£ç è´¨é‡</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%B8%8E%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7-engineering--observability" title="#%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%B8%8E%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7-engineering--observability">ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå·¥ç¨‹åŒ–ä¸å¯è§‚æµ‹æ€§ (Engineering &amp; Observability)</a>
<ul>
<li><a href="#%E7%AC%AC7%E7%AB%A0%E7%8E%B0%E4%BB%A3devops%E6%B5%81%E7%A8%8B" title="#%E7%AC%AC7%E7%AB%A0%E7%8E%B0%E4%BB%A3devops%E6%B5%81%E7%A8%8B">ç¬¬7ç« ï¼šç°ä»£DevOpsæµç¨‹</a></li>
<li><a href="#%E7%AC%AC8%E7%AB%A0%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7-observability" title="#%E7%AC%AC8%E7%AB%A0%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7-observability">ç¬¬8ç« ï¼šç”Ÿäº§ç¯å¢ƒå¯è§‚æµ‹æ€§ (Observability)</a></li>
</ul>
</li>
<li><a href="#%E9%99%84%E5%BD%95" title="#%E9%99%84%E5%BD%95">é™„å½•</a></li>
</ul>
<hr/>
<h4 data-id="heading-2">å¯¼è¨€ï¼šPHP 8.x - æ–°èŒƒå¼ä¸æ–°æœºé‡</h4>
<p>æ¬¢è¿æ¥åˆ°PHP 8.xçš„æ—¶ä»£ã€‚</p>
<p>å¦‚æœä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„PHPå¼€å‘è€…ï¼Œä½ ä¸€å®šè§è¯äº†è¿™é—¨è¯­è¨€çš„å·¨å¤§å˜è¿ã€‚ä»PHP 5çš„â€œä¸€æŠŠæ¢­â€è„šæœ¬å°å­ï¼Œåˆ°PHP 7å¸¦æ¥çš„æ€§èƒ½é©å‘½ï¼Œå†åˆ°ä»Šå¤©ï¼ŒPHP 8.xæ­£åœ¨å¼•é¢†æˆ‘ä»¬è¿›å…¥ä¸€ä¸ªå…¨æ–°çš„ç¼–ç¨‹èŒƒå¼ã€‚å®ƒä¸å†ä»…ä»…æ˜¯Webä¸–ç•Œé‡Œé‚£ä¸ªâ€œæœ€å¥½çš„è¯­è¨€â€ï¼Œå®ƒæ­£åœ¨æˆä¸ºä¸€é—¨ç‰¹æ€§ä¸°å¯Œã€ç±»å‹ä¸¥è°¨ã€æ€§èƒ½å“è¶Šçš„ç°ä»£åŒ–é€šç”¨åç«¯è¯­è¨€ã€‚</p>
<p>JITç¼–è¯‘å™¨çš„å¼•å…¥ï¼Œè®©PHPé¦–æ¬¡æ‹¥æœ‰äº†ä¸é™æ€è¯­è¨€åœ¨æŸäº›åœºæ™¯ä¸‹æ°æ‰‹è…•çš„æ½œåŠ›ï¼›Fibersï¼ˆçº¤ç¨‹ï¼‰çš„è½åœ°ï¼Œä¸ºPHPæ‰“å¼€äº†åŸç”Ÿåç¨‹çš„å¤§é—¨ï¼Œè®©é«˜å¹¶å‘ã€å¼‚æ­¥ç¼–ç¨‹ä¸å†æ˜¯Swooleç­‰æ‰©å±•çš„ä¸“åˆ©ï¼›è€ŒAttributesï¼ˆæ³¨è§£ï¼‰ã€Enumsï¼ˆæšä¸¾ï¼‰ã€æ›´å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿï¼Œåˆ™å°†PHPçš„å·¥ç¨‹åŒ–èƒ½åŠ›å’Œä»£ç å¥å£®æ€§æ¨å‘äº†å‰æ‰€æœªæœ‰çš„é«˜åº¦ã€‚</p>
<p>è¿™æœ¬å°å†Œå­ä¸æ˜¯ä¸ºåˆå­¦è€…å‡†å¤‡çš„ã€‚å®ƒå‡è®¾ä½ å·²ç»ç†Ÿæ‚‰PHPçš„è¯­æ³•ã€äº†è§£MVCæ¡†æ¶ï¼Œå¹¶æ‹¥æœ‰å®é™…çš„é¡¹ç›®ç»éªŒã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼š</p>
<ol>
<li><strong>æ·±åº¦æŒ–æ˜PHP 8.xçš„æ ¸å¿ƒç‰¹æ€§</strong>ï¼Œå¹¶æ¢è®¨å®ƒä»¬åœ¨çœŸå®é¡¹ç›®ä¸­çš„æœ€ä½³å®è·µã€‚</li>
<li><strong>è¶…è¶ŠåŸºç¡€çš„æ¡†æ¶ä½¿ç”¨</strong>ï¼Œæ¢è®¨å¦‚ä½•æ„å»ºå¯æ‰©å±•ã€å¯ç»´æŠ¤çš„ç°ä»£åŒ–æœåŠ¡æ¶æ„ã€‚</li>
<li><strong>èšç„¦æ€§èƒ½ä¸å¹¶å‘</strong>ï¼Œå­¦ä¹ å¦‚ä½•åˆ©ç”¨å¼‚æ­¥PHPå’Œå„ç§å·¥å…·å°†ä½ çš„åº”ç”¨æ€§èƒ½æ¨å‘æè‡´ã€‚</li>
<li><strong>æ‹¥æŠ±DevOpsä¸å·¥ç¨‹åŒ–</strong>ï¼ŒæŒæ¡ä»ä»£ç è´¨é‡æ§åˆ¶åˆ°ç”Ÿäº§ç¯å¢ƒå¯è§‚æµ‹æ€§çš„å…¨æµç¨‹æŠ€èƒ½ã€‚</li>
</ol>
<p>åœ¨è¿™ä¸ªæ—¶ä»£ï¼Œä¸€åä¼˜ç§€çš„PHPå·¥ç¨‹å¸ˆä¸å†æ˜¯â€œCURD Boyâ€ï¼Œè€Œåº”æ˜¯ä¸€åå…·å¤‡æ¶æ„æ€ç»´ã€æ€§èƒ½è§†é‡å’Œå·¥ç¨‹åŒ–ç´ å…»çš„<strong>Tå‹äººæ‰</strong>ï¼šä»¥PHPä¸ºæ·±åº¦æ ¹åŸºï¼ŒåŒæ—¶å¹¿æ³›æ¶‰çŒæ¶æ„è®¾è®¡ã€DevOpsã€å‰ç«¯æ„å»ºã€æ•°æ®åº“ä¼˜åŒ–ç­‰é¢†åŸŸã€‚</p>
<p>å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·æ¢ç´¢PHP 8.xå¸¦æ¥çš„æ–°èŒƒå¼ä¸æ–°æœºé‡ã€‚</p>
<hr/>
<h4 data-id="heading-3">ç¬¬ä¸€éƒ¨åˆ†ï¼šè¯­è¨€æ ¸å¿ƒä¸é«˜çº§ç‰¹æ€§ (The PHP 8.x Core)</h4>
<h5 data-id="heading-4">ç¬¬1ç« ï¼šPHP 8.x æ–°ç‰¹æ€§æ·±åº¦è§£æä¸åº”ç”¨</h5>
<h6 data-id="heading-5">1.1 Attributes (æ³¨è§£): PHPå…ƒç¼–ç¨‹çš„æ­£å¼å¼€ç«¯</h6>
<p>åœ¨PHP 8ä¹‹å‰ï¼Œæˆ‘ä»¬é•¿æœŸä¾èµ–PHPDocï¼ˆ<code>/** ... */</code>ï¼‰æ¥ä¸ºä»£ç æ·»åŠ â€œå…ƒæ•°æ®â€ã€‚æ— è®ºæ˜¯Symfonyçš„è·¯ç”±/ORMå®šä¹‰ï¼Œè¿˜æ˜¯Swaggerçš„APIæ–‡æ¡£ç”Ÿæˆï¼Œéƒ½ç¦»ä¸å¼€å¯¹æ³¨é‡Šå—çš„è§£æã€‚è¿™ç§æ–¹å¼ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”ç¼ºä¹è¯­è¨€å±‚é¢çš„åŸç”Ÿæ”¯æŒï¼Œå®¹æ˜“å‡ºé”™ã€‚</p>
<p>PHP 8çš„ <strong>Attributes</strong>ï¼ˆé€šå¸¸ç§°ä¸ºæ³¨è§£ï¼‰å½»åº•æ”¹å˜äº†è¿™ä¸€ç°çŠ¶ã€‚å®ƒå…è®¸ä½ å°†ç»“æ„åŒ–çš„ã€ç±»å‹å®‰å…¨çš„å…ƒæ•°æ®ç›´æ¥é™„åŠ åˆ°ç±»ã€æ–¹æ³•ã€å±æ€§ã€å‚æ•°ç­‰ä»£ç å£°æ˜ä¸Šã€‚è¿™ä¸ä»…ä»…æ˜¯è¯­æ³•ç³–ï¼Œè€Œæ˜¯PHPå…ƒç¼–ç¨‹èƒ½åŠ›çš„æ­£å¼å¼€ç«¯ã€‚</p>
<p><strong>1. å®šä¹‰ä¸€ä¸ªAttribute</strong></p>
<p>Attributeæœ¬èº«å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„PHPç±»ï¼Œåªæ˜¯å®ƒè‡ªå·±è¢«ä¸€ä¸ª<code>#[Attribute]</code>æ‰€æ³¨è§£ã€‚</p>
<p><code>#[Attribute]</code>æ³¨è§£æœ¬èº«å¯ä»¥æ¥å—ä¸€äº›æ ‡å¿—ä½ï¼Œç”¨äºé™å®šä½ çš„è‡ªå®šä¹‰Attributeèƒ½ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹ï¼š</p>
<ul>
<li><code>Attribute::TARGET_CLASS</code></li>
<li><code>Attribute::TARGET_FUNCTION</code></li>
<li><code>Attribute::TARGET_METHOD</code></li>
<li><code>Attribute::TARGET_PROPERTY</code></li>
<li><code>Attribute::TARGET_CLASS_CONSTANT</code></li>
<li><code>Attribute::TARGET_PARAMETER</code></li>
<li><code>Attribute::TARGET_ALL</code> (é»˜è®¤å€¼)</li>
</ul>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„è·¯ç”±Attribute</strong></p>
<p>è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>#[Route]</code>æ³¨è§£ï¼Œç”¨äºæ ‡è®°æ§åˆ¶å™¨æ–¹æ³•å¯¹åº”çš„URLè·¯å¾„å’Œè¯·æ±‚æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-meta">#[Attribute</span>(<span class="hljs-title class_">Attribute</span>::<span class="hljs-variable constant_">TARGET_METHOD</span>)<span class="hljs-meta">]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Route</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$path</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$method</span> = <span class="hljs-string">'GET'</span>
    </span>) </span>{}
}
</code></pre>
<ul>
<li>æˆ‘ä»¬é™å®šäº†<code>#[Route]</code>åªèƒ½ç”¨äºæ–¹æ³•ä¸Š (<code>Attribute::TARGET_METHOD</code>)ã€‚</li>
<li>æ„é€ å‡½æ•°ä½¿ç”¨äº†PHP 8çš„â€œæ„é€ å‡½æ•°å±æ€§æå‡â€è¯­æ³•ï¼Œä»£ç éå¸¸ç®€æ´ã€‚</li>
</ul>
<p><strong>2. ä½¿ç”¨Attribute</strong></p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨è¿™ä¸ª<code>#[Route]</code>äº†ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span>
</span>{
    <span class="hljs-meta">#[Route</span>(<span class="hljs-string">'/users/{id}'</span>, <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">find</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$id</span></span>)
    </span>{
        <span class="hljs-comment">// ... find user logic</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Finding user with ID: <span class="hljs-subst">{$id}</span>"</span>;
    }

    <span class="hljs-meta">#[Route</span>(<span class="hljs-string">'/users'</span>, <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span></span>)
    </span>{
        <span class="hljs-comment">// ... create user logic</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"User created."</span>;
    }
}
</code></pre>
<p>çœ‹åˆ°äº†å—ï¼Ÿè·¯ç”±å®šä¹‰ä¸å†æ˜¯é…ç½®æ–‡ä»¶é‡Œçš„ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿä¸æ˜¯ä¸€æ®µæ³¨é‡Šï¼Œè€Œæ˜¯ä¸ä¸šåŠ¡é€»è¾‘ç´§å¯†ç»“åˆã€å¯è¢«é™æ€åˆ†æçš„<strong>ä»£ç </strong>ã€‚</p>
<p><strong>3. è¯»å–Attributeï¼ˆæ ¸å¿ƒï¼‰</strong></p>
<p>å®šä¹‰å’Œä½¿ç”¨åªæ˜¯ç¬¬ä¸€æ­¥ï¼ŒçœŸæ­£è®©Attributeå‘æŒ¥å¨åŠ›çš„æ˜¯é€šè¿‡<strong>åå°„ (Reflection)</strong> æ¥è¯»å–å®ƒä»¬ã€‚</p>
<p>è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€å•çš„è·¯ç”±å™¨ï¼Œå®ƒèƒ½é€šè¿‡åå°„åˆ†æ<code>UserController</code>ï¼Œå¹¶æ ¹æ®è¯·æ±‚çš„URLæ‰§è¡Œå¯¹åº”çš„æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// å‡è®¾è¿™æ˜¯ä½ çš„å…¥å£æ–‡ä»¶ index.php</span>

<span class="hljs-variable">$requestUri</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">'REQUEST_URI'</span>];
<span class="hljs-variable">$requestMethod</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">'REQUEST_METHOD'</span>];

<span class="hljs-variable">$controller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserController</span>();
<span class="hljs-variable">$reflectionClass</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectionClass</span>(<span class="hljs-variable">$controller</span>);

<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$reflectionClass</span>-&gt;<span class="hljs-title function_ invoke__">getMethods</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$method</span>) {
    <span class="hljs-variable">$attributes</span> = <span class="hljs-variable">$method</span>-&gt;<span class="hljs-title function_ invoke__">getAttributes</span>(<span class="hljs-title class_">Route</span>::<span class="hljs-variable language_">class</span>);

    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$attributes</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$attribute</span>) {
        <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> Route $route */</span>
        <span class="hljs-variable">$route</span> = <span class="hljs-variable">$attribute</span>-&gt;<span class="hljs-title function_ invoke__">newInstance</span>();

        <span class="hljs-comment">// ç®€å•çš„è·¯å¾„åŒ¹é… (å®é™…åº”ç”¨ä¸­ä¼šæ›´å¤æ‚)</span>
        <span class="hljs-comment">// å°† /users/{id} è½¬æ¢ä¸ºæ­£åˆ™ /users/(\w+)</span>
        <span class="hljs-variable">$pattern</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">'/\{(\w+)\}/'</span>, <span class="hljs-string">'(\w+)'</span>, <span class="hljs-variable">$route</span>-&gt;path);
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">"#^<span class="hljs-subst">$pattern</span>$#"</span>, <span class="hljs-variable">$requestUri</span>, <span class="hljs-variable">$matches</span>) &amp;&amp; <span class="hljs-variable">$route</span>-&gt;method === <span class="hljs-variable">$requestMethod</span>) {
            
            <span class="hljs-comment">// ç§»é™¤å®Œæ•´åŒ¹é…é¡¹</span>
            <span class="hljs-title function_ invoke__">array_shift</span>(<span class="hljs-variable">$matches</span>); 
            
            <span class="hljs-comment">// æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•å¹¶ä¼ å…¥å‚æ•°</span>
            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$method</span>-&gt;<span class="hljs-title function_ invoke__">invoke</span>(<span class="hljs-variable">$controller</span>, ...<span class="hljs-variable">$matches</span>);
            <span class="hljs-keyword">return</span>;
        }
    }
}

<span class="hljs-keyword">echo</span> <span class="hljs-string">"404 Not Found"</span>;
</code></pre>
<p><strong>ä»£ç è§£è¯»</strong>:</p>
<ol>
<li>æˆ‘ä»¬é€šè¿‡<code>ReflectionClass</code>è·å–<code>UserController</code>çš„æ‰€æœ‰æ–¹æ³•ã€‚</li>
<li>ä½¿ç”¨<code>$method-&gt;getAttributes(Route::class)</code>æ¥è·å–æ¯ä¸ªæ–¹æ³•ä¸Šé™„åŠ çš„<code>#[Route]</code>æ³¨è§£å®ä¾‹ã€‚</li>
<li><code>$attribute-&gt;newInstance()</code>ä¼šåˆ›å»º<code>Route</code>ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œå…¶æ„é€ å‡½æ•°å‚æ•°å°±æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶ä¼ å…¥çš„<code>('/users/{id}', 'GET')</code>ã€‚</li>
<li>ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»<code>$route</code>å®ä¾‹ä¸­è·å–<code>path</code>å’Œ<code>method</code>å±æ€§ï¼Œè¿›è¡Œè·¯ç”±åŒ¹é…å’Œåˆ†å‘ã€‚</li>
</ol>
<p><strong>4. æ›´å¤šå®æˆ˜åœºæ™¯</strong></p>
<p>Attributesçš„å¨åŠ›è¿œä¸æ­¢äºè·¯ç”±ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œå®ƒä»¬æ˜¯æ„å»ºæ¸…æ™°ã€è§£è€¦ã€å£°æ˜å¼ä»£ç çš„åˆ©å™¨ã€‚</p>
<p><strong>åœºæ™¯ä¸€ï¼šè®¿é—®æ§åˆ¶ (Access Control)</strong></p>
<p>æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ª<code>#[Auth]</code>æ³¨è§£æ¥ä¿æŠ¤éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„è·¯ç”±ã€‚</p>
<ul>
<li><strong>å®šä¹‰Attribute:</strong></li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Attribute/Auth.php</span>
<span class="hljs-meta">#[Attribute</span>(<span class="hljs-title class_">Attribute</span>::<span class="hljs-variable constant_">TARGET_METHOD</span>)<span class="hljs-meta">]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Auth</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> array $roles éœ€è¦çš„è§’è‰²ï¼Œä¸ºç©ºåˆ™åªéœ€ç™»å½•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$roles</span> = []</span>)
    </span>{
    }
}
</code></pre>
<ul>
<li><strong>ä½¿ç”¨Attribute:</strong></li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Controller/UserController.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span>
</span>{
    <span class="hljs-meta">#[Route</span>(<span class="hljs-string">'/profile'</span>, <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-meta">#[Auth</span><span class="hljs-meta">]</span> <span class="hljs-comment">// åªéœ€ç™»å½•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">profile</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-comment">// ...</span>
    }

    <span class="hljs-meta">#[Route</span>(<span class="hljs-string">'/admin/dashboard'</span>, <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-meta">#[Auth</span>(<span class="hljs-attr">roles</span>: [<span class="hljs-string">'ADMIN'</span>, <span class="hljs-string">'SUPER_ADMIN'</span>])<span class="hljs-meta">]</span> <span class="hljs-comment">// éœ€è¦ç‰¹å®šè§’è‰²</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dashboard</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<ul>
<li><strong>åœ¨è·¯ç”±å™¨ä¸­é›†æˆæ£€æŸ¥:</strong></li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ä¹‹å‰çš„è·¯ç”±åˆ†å‘é€»è¾‘ä¸­ï¼Œå¢åŠ å¯¹<code>#[Auth]</code>æ³¨è§£çš„æ£€æŸ¥ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// index.php (è·¯ç”±åˆ†å‘éƒ¨åˆ†)</span>
<span class="hljs-comment">// ...</span>
<span class="hljs-variable">$methods</span> = <span class="hljs-variable">$reflectionClass</span>-&gt;<span class="hljs-title function_ invoke__">getMethods</span>();
<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$methods</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$method</span>) {
    <span class="hljs-variable">$routeAttributes</span> = <span class="hljs-variable">$method</span>-&gt;<span class="hljs-title function_ invoke__">getAttributes</span>(<span class="hljs-title class_">Route</span>::<span class="hljs-variable language_">class</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$routeAttributes</span>)) {
        <span class="hljs-keyword">continue</span>;
    }

    <span class="hljs-comment">// æ£€æŸ¥Authæ³¨è§£</span>
    <span class="hljs-variable">$authAttributes</span> = <span class="hljs-variable">$method</span>-&gt;<span class="hljs-title function_ invoke__">getAttributes</span>(<span class="hljs-title class_">Auth</span>::<span class="hljs-variable language_">class</span>);
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$authAttributes</span>)) {
        <span class="hljs-comment">// ä¼ªä»£ç ï¼šå®ç°ä½ çš„è®¤è¯é€»è¾‘</span>
        <span class="hljs-variable">$isLoggedIn</span> = <span class="hljs-title class_">Auth</span>::<span class="hljs-title function_ invoke__">check</span>(); <span class="hljs-comment">// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$isLoggedIn</span>) {
            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'HTTP/1.1 401 Unauthorized'</span>);
            <span class="hljs-keyword">echo</span> <span class="hljs-string">'Unauthorized'</span>;
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> Auth $auth */</span>
        <span class="hljs-variable">$auth</span> = <span class="hljs-variable">$authAttributes</span>[<span class="hljs-number">0</span>]-&gt;<span class="hljs-title function_ invoke__">newInstance</span>();
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$auth</span>-&gt;roles) &amp;&amp; !<span class="hljs-title class_">Auth</span>::<span class="hljs-title function_ invoke__">user</span>()-&gt;<span class="hljs-title function_ invoke__">hasAnyRole</span>(<span class="hljs-variable">$auth</span>-&gt;roles)) {
            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'HTTP/1.1 403 Forbidden'</span>);
            <span class="hljs-keyword">echo</span> <span class="hljs-string">'Forbidden'</span>;
            <span class="hljs-keyword">return</span>;
        }
    }
    
    <span class="hljs-comment">// ... åç»­è·¯ç”±åŒ¹é…å’Œæ‰§è¡Œé€»è¾‘</span>
}
</code></pre>
<p><strong>åœºæ™¯äºŒï¼šè¯·æ±‚æ•°æ®è½¬æ¢ä¸éªŒè¯ (DTO Validation)</strong></p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨Attributeæ¥æ ‡è®°DTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰çš„å±æ€§ï¼Œä»è€Œå®ç°è‡ªåŠ¨åŒ–çš„éªŒè¯å’Œç±»å‹è½¬æ¢ã€‚</p>
<ul>
<li><strong>å®šä¹‰Attribute:</strong></li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Attribute/Validation/Rule.php</span>
<span class="hljs-meta">#[Attribute</span>(<span class="hljs-title class_">Attribute</span>::<span class="hljs-variable constant_">TARGET_PROPERTY</span>)<span class="hljs-meta">]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rule</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$rule</span></span>) // <span class="hljs-title">e</span>.<span class="hljs-title">g</span>., '<span class="hljs-title">required</span>|<span class="hljs-title">email</span>'
    </span>{
    }
}
</code></pre>
<ul>
<li><strong>åˆ›å»ºDTOå¹¶ä½¿ç”¨Attribute:</strong></li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/DTO/CreateUserDTO.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateUserDTO</span>
</span>{
    <span class="hljs-meta">#[Rule</span>(<span class="hljs-string">'required|string|max:255'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span>;

    <span class="hljs-meta">#[Rule</span>(<span class="hljs-string">'required|email'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$email</span>;

    <span class="hljs-meta">#[Rule</span>(<span class="hljs-string">'required|int|min:18'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$age</span>;
}
</code></pre>
<ul>
<li><strong>åˆ›å»ºä¸€ä¸ªValidatoræœåŠ¡:</strong></li>
</ul>
<p>è¿™ä¸ªæœåŠ¡é€šè¿‡åå°„è¯»å–DTOå®ä¾‹çš„å±æ€§æ³¨è§£ï¼Œå¹¶æ‰§è¡ŒéªŒè¯ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Service/Validator.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Validator</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validate</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> <span class="hljs-variable">$dto</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable">$errors</span> = [];
        <span class="hljs-variable">$reflection</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectionClass</span>(<span class="hljs-variable">$dto</span>);

        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$reflection</span>-&gt;<span class="hljs-title function_ invoke__">getProperties</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$property</span>) {
            <span class="hljs-variable">$attributes</span> = <span class="hljs-variable">$property</span>-&gt;<span class="hljs-title function_ invoke__">getAttributes</span>(<span class="hljs-title class_">Rule</span>::<span class="hljs-variable language_">class</span>);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$attributes</span>)) {
                <span class="hljs-keyword">continue</span>;
            }

            <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> Rule $rule */</span>
            <span class="hljs-variable">$rule</span> = <span class="hljs-variable">$attributes</span>[<span class="hljs-number">0</span>]-&gt;<span class="hljs-title function_ invoke__">newInstance</span>();
            <span class="hljs-variable">$value</span> = <span class="hljs-variable">$property</span>-&gt;<span class="hljs-title function_ invoke__">isInitialized</span>(<span class="hljs-variable">$dto</span>) ? <span class="hljs-variable">$property</span>-&gt;<span class="hljs-title function_ invoke__">getValue</span>(<span class="hljs-variable">$dto</span>) : <span class="hljs-literal">null</span>;

            <span class="hljs-comment">// ä¼ªä»£ç ï¼šæ­¤å¤„é›†æˆçœŸå®çš„éªŒè¯åº“ï¼Œå¦‚ illuminate/validation</span>
            <span class="hljs-variable">$validationErrors</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">runValidationLibrary</span>(<span class="hljs-variable">$property</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>(), <span class="hljs-variable">$value</span>, <span class="hljs-variable">$rule</span>-&gt;rule);
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$validationErrors</span>)) {
                <span class="hljs-variable">$errors</span>[<span class="hljs-variable">$property</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>()] = <span class="hljs-variable">$validationErrors</span>;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$errors</span>;
    }
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>ç°åœ¨ï¼Œåœ¨ä½ çš„æ§åˆ¶å™¨ä¸­ï¼Œä½ å¯ä»¥å°†è¯·æ±‚æ•°æ®å¡«å……åˆ°DTOï¼Œç„¶åç”¨Validatorè¿›è¡ŒéªŒè¯ï¼Œä»£ç å˜å¾—æå…¶å¹²å‡€ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// UserController.php</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, Validator <span class="hljs-variable">$validator</span></span>)
</span>{
    <span class="hljs-variable">$dto</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CreateUserDTO</span>();
    <span class="hljs-variable">$dto</span>-&gt;name = <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">'name'</span>);
    <span class="hljs-variable">$dto</span>-&gt;email = <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">'email'</span>);
    <span class="hljs-variable">$dto</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">'age'</span>);

    <span class="hljs-variable">$errors</span> = <span class="hljs-variable">$validator</span>-&gt;<span class="hljs-title function_ invoke__">validate</span>(<span class="hljs-variable">$dto</span>);
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$errors</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">response</span>()-&gt;<span class="hljs-title function_ invoke__">json</span>(<span class="hljs-variable">$errors</span>, <span class="hljs-number">422</span>);
    }
    <span class="hljs-comment">// ... DTOéªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
}
</code></pre>
<p><strong>æ€»ç»“</strong></p>
<p>Attributeså°†å…ƒæ•°æ®ä»â€œæ˜“ç¢çš„â€æ³¨é‡Šå’Œâ€œé¥è¿œçš„â€é…ç½®æ–‡ä»¶ä¸­è§£æ”¾å‡ºæ¥ï¼Œä½¿å…¶æˆä¸ºä¸ä¸šåŠ¡ä»£ç å¹¶å­˜ã€ç±»å‹å®‰å…¨ã€å¯è¢«é™æ€åˆ†æçš„ä¸€ç­‰å…¬æ°‘ã€‚å®ƒæ˜¯æ„å»ºç°ä»£ã€å¯ç»´æŠ¤ã€é«˜è¡¨ç°åŠ›PHPåº”ç”¨å’Œæ¡†æ¶çš„åŸºçŸ³ã€‚</p>
<hr/>
<h6 data-id="heading-6">1.2 Enums (æšä¸¾): æ„å»ºç±»å‹å®‰å…¨çš„çŠ¶æ€æœº</h6>
<p>åœ¨PHP 8.1ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ç±»å¸¸é‡æ¥è¡¨ç¤ºä¸€ç»„å›ºå®šçš„ç›¸å…³çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Post</span>
</span>{
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STATUS_DRAFT</span> = <span class="hljs-string">'draft'</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STATUS_PUBLISHED</span> = <span class="hljs-string">'published'</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STATUS_ARCHIVED</span> = <span class="hljs-string">'archived'</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$status</span>;
}
</code></pre>
<p>è¿™ç§æ–¹å¼æœ‰å‡ ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼š</p>
<ol>
<li><strong>ç±»å‹ä¸å®‰å…¨</strong>: <code>setStatus</code>æ–¹æ³•çš„å‚æ•°åº”è¯¥æ˜¯<code>string</code>ï¼Œä½†ä»»ä½•å­—ç¬¦ä¸²éƒ½å¯ä»¥è¢«ä¼ å…¥ï¼Œè€Œä¸ä»…ä»…æ˜¯æˆ‘ä»¬å®šä¹‰çš„é‚£ä¸‰ä¸ªå¸¸é‡ã€‚</li>
<li><strong>é€»è¾‘åˆ†æ•£</strong>: å¦‚æœæƒ³è·å–æŸä¸ªçŠ¶æ€å¯¹åº”çš„ä¸­æ–‡æ ‡ç­¾ï¼ˆå¦‚ 'draft' -&gt; 'è‰ç¨¿'ï¼‰ï¼Œä½ å¯èƒ½éœ€è¦å†™ä¸€ä¸ªåºå¤§çš„<code>switch</code>æˆ–ä¸€ä¸ªå…³è”æ•°ç»„ï¼Œè¿™äº›é€»è¾‘ä¸çŠ¶æ€å®šä¹‰æœ¬èº«æ˜¯åˆ†ç¦»çš„ã€‚</li>
<li><strong>å¯è¯»æ€§å·®</strong>: å½“ä½ çœ‹åˆ°ä¸€ä¸ªå‡½æ•°è¿”å›<code>'draft'</code>æ—¶ï¼Œä½ æ— æ³•ç¡®å®šå®ƒå°±æ˜¯<code>Post::STATUS_DRAFT</code>ï¼Œå¯èƒ½åªæ˜¯ä¸€ä¸ªæ°å¥½åŒå€¼çš„æ™®é€šå­—ç¬¦ä¸²ã€‚</li>
</ol>
<p>PHP 8.1çš„**Enumsï¼ˆæšä¸¾ï¼‰**å®Œç¾åœ°è§£å†³äº†è¿™äº›é—®é¢˜ã€‚</p>
<p><strong>1. Backed Enums (æ ‡é‡æšä¸¾)</strong></p>
<p>å½“æšä¸¾éœ€è¦ä¸æ•°æ®åº“æˆ–APIç­‰å¤–éƒ¨ç³»ç»Ÿäº¤äº’æ—¶ï¼Œå®ƒä»¬é€šå¸¸éœ€è¦ä¸€ä¸ªæ ‡é‡å€¼ï¼ˆ<code>string</code>æˆ–<code>int</code>ï¼‰ã€‚è¿™å°±æ˜¯<code>Backed Enums</code>ã€‚</p>
<p>è®©æˆ‘ä»¬ç”¨æšä¸¾é‡æ„ä¸Šé¢çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">PostStatus</span>: <span class="hljs-title">string</span>
</span>{
    <span class="hljs-keyword">case</span> Draft = <span class="hljs-string">'draft'</span>;
    <span class="hljs-keyword">case</span> Published = <span class="hljs-string">'published'</span>;
    <span class="hljs-keyword">case</span> Archived = <span class="hljs-string">'archived'</span>;
}
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º<code>Post</code>ç±»çš„<code>status</code>å±æ€§æ·»åŠ ä¸¥æ ¼çš„ç±»å‹çº¦æŸã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Post</span>
</span>{
    <span class="hljs-keyword">public</span> PostStatus <span class="hljs-variable">$status</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setStatus</span>(<span class="hljs-params">PostStatus <span class="hljs-variable">$status</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;status = <span class="hljs-variable">$status</span>;
    }
}

<span class="hljs-variable">$post</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Post</span>();
<span class="hljs-comment">// $post-&gt;setStatus('draft'); // TypeError! å¿…é¡»ä¼ å…¥PostStatuså®ä¾‹</span>
<span class="hljs-variable">$post</span>-&gt;<span class="hljs-title function_ invoke__">setStatus</span>(<span class="hljs-title class_">PostStatus</span>::<span class="hljs-variable constant_">Draft</span>); <span class="hljs-comment">// æ­£ç¡®</span>
</code></pre>
<p>ä»…ä»…æ˜¯è¿™æ ·ï¼Œå°±å·²ç»é€šè¿‡è¯­è¨€æœ¬èº«é˜²æ­¢äº†ä¸€æ•´ç±»æ— æ•ˆçŠ¶æ€çš„bugã€‚</p>
<p><strong>2. ä¸ºæšä¸¾æ·»åŠ è¡Œä¸º (Methods)</strong></p>
<p>æšä¸¾çœŸæ­£çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼Œå®ƒå¯ä»¥æ‹¥æœ‰æ–¹æ³•ï¼Œå°†ä¸çŠ¶æ€ç›¸å…³çš„é€»è¾‘å†…èšåœ¨ä¸€èµ·ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">PostStatus</span>: <span class="hljs-title">string</span>
</span>{
    <span class="hljs-keyword">case</span> Draft = <span class="hljs-string">'draft'</span>;
    <span class="hljs-keyword">case</span> Published = <span class="hljs-string">'published'</span>;
    <span class="hljs-keyword">case</span> Archived = <span class="hljs-string">'archived'</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">label</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span> (<span class="hljs-variable language_">$this</span>) {
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">Draft</span> =&gt; <span class="hljs-string">'è‰ç¨¿'</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">Published</span> =&gt; <span class="hljs-string">'å·²å‘å¸ƒ'</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">Archived</span> =&gt; <span class="hljs-string">'å·²å½’æ¡£'</span>,
        };
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">color</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span> (<span class="hljs-variable language_">$this</span>) {
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">Draft</span> =&gt; <span class="hljs-string">'grey'</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">Published</span> =&gt; <span class="hljs-string">'green'</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">Archived</span> =&gt; <span class="hljs-string">'red'</span>,
        };
    }
}
</code></pre>
<p>ç°åœ¨ï¼Œåœ¨è§†å›¾ï¼ˆå¦‚Bladeæ¨¡æ¿ï¼‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸ä¼˜é›…åœ°æ¸²æŸ“çŠ¶æ€æ ‡ç­¾ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- post.blade.php --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: {{ $post-&gt;status-&gt;color() }};"</span>&gt;</span>
    {{ $post-&gt;status-&gt;label() }}
<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
</code></pre>
<p>æ‰€æœ‰çš„çŠ¶æ€ç›¸å…³é€»è¾‘éƒ½è¢«å°è£…åœ¨<code>PostStatus</code>æšä¸¾å†…éƒ¨ï¼Œä¸šåŠ¡ä»£ç åªè´Ÿè´£è°ƒç”¨ï¼Œå®Œå…¨æ— éœ€å…³å¿ƒå®ç°ç»†èŠ‚ã€‚è¿™æå¤§åœ°æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p>
<p><strong>3. é™æ€æ–¹æ³•ä¸æ¥å£</strong></p>
<p>æšä¸¾è¿˜å¯ä»¥å®ç°æ¥å£å’Œä½¿ç”¨Traitï¼Œæ‹¥æœ‰é™æ€æ–¹æ³•ã€‚<code>Backed Enums</code>é»˜è®¤å®ç°<code>BackedEnum</code>æ¥å£ï¼Œæä¾›äº†<code>from()</code>å’Œ<code>tryFrom()</code>ä¸¤ä¸ªæœ‰ç”¨çš„é™æ€æ–¹æ³•ã€‚</p>
<ul>
<li><code>from(string|int $value)</code>: ä»æ ‡é‡å€¼æŸ¥æ‰¾æšä¸¾æˆå‘˜ï¼Œæ‰¾ä¸åˆ°ä¼šæŠ›å‡º<code>ValueError</code>ã€‚</li>
<li><code>tryFrom(string|int $value)</code>: åŠŸèƒ½åŒä¸Šï¼Œä½†æ‰¾ä¸åˆ°æ—¶ä¼šè¿”å›<code>null</code>ã€‚</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$status</span> = <span class="hljs-title class_">PostStatus</span>::<span class="hljs-keyword">from</span>(<span class="hljs-string">'published'</span>); <span class="hljs-comment">// è¿”å› PostStatus::Published</span>
<span class="hljs-variable">$status</span> = <span class="hljs-title class_">PostStatus</span>::<span class="hljs-title function_ invoke__">tryFrom</span>(<span class="hljs-string">'deleted'</span>); <span class="hljs-comment">// è¿”å› null</span>
</code></pre>
<p><code>tryFrom</code>åœ¨å¤„ç†æ¥è‡ªç”¨æˆ·è¾“å…¥æˆ–å¤–éƒ¨APIçš„ä¸å¯ä¿¡æ•°æ®æ—¶å°¤å…¶æœ‰ç”¨ã€‚</p>
<p><strong>æ€»ç»“</strong></p>
<p>åœ¨ç°ä»£PHPå¼€å‘ä¸­ï¼Œ<strong>ä»»ä½•ä¸€ç»„æœ‰é™ã€å›ºå®šçš„ç›¸å…³çŠ¶æ€ï¼Œéƒ½åº”è¯¥ä¼˜å…ˆä½¿ç”¨æšä¸¾æ¥å®ç°</strong>ã€‚</p>
<ul>
<li><strong>ç”¨æˆ·è§’è‰²</strong>: <code>enum UserRole: string { case Member = 'member'; case Admin = 'admin'; }</code></li>
<li><strong>è®¢å•çŠ¶æ€</strong>: <code>enum OrderStatus: int { case Pending = 1; case Paid = 2; case Shipped = 3; }</code></li>
<li><strong>é€šçŸ¥ç±»å‹</strong>: <code>enum NotificationType { case NewComment; case FriendRequest; }</code> (è¿™æ˜¯ä¸€ä¸ªPure Enumï¼Œå› ä¸ºå®ƒä¸éœ€è¦æ ‡é‡å€¼)</li>
</ul>
<p>ä½¿ç”¨æšä¸¾èƒ½è®©ä½ çš„ä»£ç æ›´å¥å£®ã€æ›´å…·è¡¨ç°åŠ›ã€æ›´æ˜“äºç»´æŠ¤ï¼Œå¹¶ä»è¯­è¨€å±‚é¢æ¶ˆé™¤å› æ— æ•ˆçŠ¶æ€å¯¼è‡´çš„æ½œåœ¨bugã€‚</p>
<hr/>
<h6 data-id="heading-7">1.3 Fibers (çº¤ç¨‹): PHPåŸç”Ÿåç¨‹çš„åŸºçŸ³</h6>
<p>åœ¨PHP 8.1ä¹‹å‰ï¼Œè¦å®ç°é«˜å¹¶å‘çš„å¼‚æ­¥I/Oï¼Œæˆ‘ä»¬å‡ ä¹å”¯ä¸€çš„é€‰æ‹©å°±æ˜¯ä¾èµ–Swooleã€Workermanæˆ–ReactPHPè¿™æ ·çš„ç¬¬ä¸‰æ–¹æ‰©å±•/åº“ã€‚å®ƒä»¬é€šè¿‡Cæ‰©å±•æˆ–äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å®ç°äº†è‡ªå·±çš„åç¨‹è°ƒåº¦ã€‚</p>
<p>PHP 8.1å¼•å…¥çš„<strong>Fibersï¼ˆçº¤ç¨‹ï¼‰</strong>ï¼Œé¦–æ¬¡åœ¨è¯­è¨€å±‚é¢æä¾›äº†åç¨‹çš„åº•å±‚æ”¯æŒã€‚</p>
<p><strong>é‡è¦æ¦‚å¿µ</strong>: Fiberä¸æ˜¯å¼€ç®±å³ç”¨çš„â€œasync/awaitâ€ã€‚å®ƒæ˜¯ä¸€ç§æ›´åº•å±‚çš„æœºåˆ¶ï¼Œå¯ä»¥è®©ä½ åˆ›å»ºèƒ½å¤Ÿè¢«<strong>æš‚åœ (suspend)</strong> å’Œ<strong>æ¢å¤ (resume)</strong> çš„ä»£ç å—ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºâ€œå¯ä¸­æ–­çš„å‡½æ•°â€ã€‚</p>
<p><strong>1. é—®é¢˜æ‰€åœ¨ï¼šé˜»å¡I/O</strong></p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸¤ä¸ªç¼“æ…¢çš„APIè·å–æ•°æ®ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchApiData</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$url</span></span>): <span class="hljs-title">string</span>
</span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Fetching <span class="hljs-subst">$url</span>...\n"</span>;
    <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$url</span>); <span class="hljs-comment">// é˜»å¡ç‚¹</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Finished <span class="hljs-subst">$url</span>.\n"</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;
}

<span class="hljs-variable">$start</span> = <span class="hljs-title function_ invoke__">microtime</span>(<span class="hljs-literal">true</span>);
<span class="hljs-variable">$dataA</span> = <span class="hljs-title function_ invoke__">fetchApiData</span>(<span class="hljs-string">'http://localhost:8001/slow-api'</span>); <span class="hljs-comment">// å‡è®¾è€—æ—¶ 1s</span>
<span class="hljs-variable">$dataB</span> = <span class="hljs-title function_ invoke__">fetchApiData</span>(<span class="hljs-string">'http://localhost:8002/slow-api'</span>); <span class="hljs-comment">// å‡è®¾è€—æ—¶ 1s</span>
<span class="hljs-variable">$end</span> = <span class="hljs-title function_ invoke__">microtime</span>(<span class="hljs-literal">true</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-string">"Total time: "</span> . (<span class="hljs-variable">$end</span> - <span class="hljs-variable">$start</span>) . <span class="hljs-string">"s\n"</span>; <span class="hljs-comment">// è¾“å‡º: Total time: ~2s</span>
</code></pre>
<p>ç”±äº<code>file_get_contents</code>æ˜¯é˜»å¡çš„ï¼Œç¨‹åºå¿…é¡»ç­‰å¾…ç¬¬ä¸€ä¸ªè¯·æ±‚å®Œæˆåæ‰èƒ½å¼€å§‹ç¬¬äºŒä¸ªã€‚æ€»è€—æ—¶æ˜¯ä¸¤è€…ä¹‹å’Œã€‚</p>
<p><strong>2. Fiberå¦‚ä½•å·¥ä½œ</strong></p>
<p>Fiberå…è®¸æˆ‘ä»¬åœ¨é˜»å¡ç‚¹ï¼ˆå¦‚ç­‰å¾…ç½‘ç»œI/Oï¼‰æš‚åœå½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œå¹¶è®©å‡ºCPUå»æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚å½“I/Oæ“ä½œå®Œæˆåï¼Œå†æ¢å¤è¯¥å‡½æ•°çš„æ‰§è¡Œã€‚</p>
<p>æ ¸å¿ƒAPIéå¸¸ç®€å•ï¼š</p>
<ul>
<li><code>$fiber = new Fiber(callable $callback)</code>: åˆ›å»ºä¸€ä¸ªçº¤ç¨‹ã€‚</li>
<li><code>$fiber-&gt;start()</code>: å¯åŠ¨çº¤ç¨‹ã€‚</li>
<li><code>Fiber::suspend()</code>: åœ¨çº¤ç¨‹å†…éƒ¨è°ƒç”¨ï¼Œæš‚åœçº¤ç¨‹å¹¶è¿”å›ä¸€ä¸ªå€¼ç»™ä¸»ç¨‹åºã€‚</li>
<li><code>$fiber-&gt;resume()</code>: åœ¨ä¸»ç¨‹åºä¸­è°ƒç”¨ï¼Œæ¢å¤ä¸€ä¸ªè¢«æš‚åœçš„çº¤ç¨‹ã€‚</li>
</ul>
<p><strong>3. æ‰‹åŠ¨å®ç°ä¸€ä¸ªç®€å•çš„å¹¶å‘è°ƒåº¦å™¨</strong></p>
<p>ä¸ºäº†çœŸæ­£ç†è§£Fiberï¼Œæˆ‘ä»¬æ¥æ„å»ºä¸€ä¸ªèƒ½å¹¶å‘æ‰§è¡Œå¤šä¸ªä»»åŠ¡çš„è°ƒåº¦å™¨ã€‚åœ¨çœŸå®é¡¹ç›®ä¸­ä½ ä¸ä¼šè¿™ä¹ˆåšï¼Œä½†è¿™æ˜¯ç†è§£å…¶åŸç†çš„æœ€ä½³æ–¹å¼ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Scheduler</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">SplQueue</span> <span class="hljs-variable">$taskQueue</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$waitingTasks</span> = []; <span class="hljs-comment">// [stream_socket =&gt; Fiber]</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;taskQueue = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplQueue</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTask</span>(<span class="hljs-params"><span class="hljs-built_in">Fiber</span> <span class="hljs-variable">$task</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;taskQueue-&gt;<span class="hljs-title function_ invoke__">enqueue</span>(<span class="hljs-variable">$task</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">while</span> (!<span class="hljs-variable language_">$this</span>-&gt;taskQueue-&gt;<span class="hljs-title function_ invoke__">isEmpty</span>() || !<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;waitingTasks)) {
            <span class="hljs-comment">// 1. å¯åŠ¨æ–°ä»»åŠ¡</span>
            <span class="hljs-keyword">while</span> (!<span class="hljs-variable language_">$this</span>-&gt;taskQueue-&gt;<span class="hljs-title function_ invoke__">isEmpty</span>()) {
                <span class="hljs-variable">$task</span> = <span class="hljs-variable language_">$this</span>-&gt;taskQueue-&gt;<span class="hljs-title function_ invoke__">dequeue</span>();
                <span class="hljs-variable">$socket</span> = <span class="hljs-variable">$task</span>-&gt;<span class="hljs-title function_ invoke__">start</span>(); <span class="hljs-comment">// æœŸæœ›è¿”å›ä¸€ä¸ªsocketèµ„æº</span>
                <span class="hljs-variable language_">$this</span>-&gt;waitingTasks[(<span class="hljs-keyword">int</span>)<span class="hljs-variable">$socket</span>] = <span class="hljs-variable">$task</span>;
            }

            <span class="hljs-comment">// 2. ç›‘å¬æ‰€æœ‰ç­‰å¾…ä¸­çš„socket</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;waitingTasks)) {
                <span class="hljs-keyword">continue</span>;
            }
            
            <span class="hljs-variable">$readSockets</span> = <span class="hljs-title function_ invoke__">array_map</span>(fn(<span class="hljs-variable">$task</span>) =&gt; <span class="hljs-variable">$task</span>-&gt;<span class="hljs-title function_ invoke__">getReturn</span>(), <span class="hljs-variable language_">$this</span>-&gt;waitingTasks);
            <span class="hljs-comment">// ä½¿ç”¨stream_selectè¿›è¡Œéé˜»å¡I/Oç›‘å¬</span>
            <span class="hljs-title function_ invoke__">stream_select</span>(<span class="hljs-variable">$readSockets</span>, <span class="hljs-variable">$write</span>, <span class="hljs-variable">$except</span>, <span class="hljs-number">1</span>);

            <span class="hljs-comment">// 3. æ¢å¤å·²å°±ç»ªçš„ä»»åŠ¡</span>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$readSockets</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$readySocket</span>) {
                <span class="hljs-variable">$key</span> = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$readySocket</span>;
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;waitingTasks[<span class="hljs-variable">$key</span>])) {
                    <span class="hljs-variable">$task</span> = <span class="hljs-variable language_">$this</span>-&gt;waitingTasks[<span class="hljs-variable">$key</span>];
                    <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;waitingTasks[<span class="hljs-variable">$key</span>]);
                    <span class="hljs-variable">$task</span>-&gt;<span class="hljs-title function_ invoke__">resume</span>(); <span class="hljs-comment">// æ¢å¤æ‰§è¡Œ</span>
                }
            }
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨éé˜»å¡streamé‡å†™APIè¯·æ±‚å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nonBlockingFetch</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$host</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$path</span></span>): <span class="hljs-title">Fiber</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Fiber</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"/>) <span class="hljs-keyword">use</span> (<span class="hljs-params"><span class="hljs-variable">$host</span>, <span class="hljs-variable">$path</span></span>) </span>{
        <span class="hljs-variable">$socket</span> = <span class="hljs-title function_ invoke__">stream_socket_client</span>(<span class="hljs-string">"tcp://<span class="hljs-subst">$host</span>:80"</span>, <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-number">0</span>, STREAM_CLIENT_ASYNC_CONNECT);
        <span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$socket</span>, <span class="hljs-literal">false</span>);
        
        <span class="hljs-variable">$request</span> = <span class="hljs-string">"GET <span class="hljs-subst">$path</span> HTTP/1.1\r\nHost: <span class="hljs-subst">$host</span>\r\n\r\n"</span>;
        <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$socket</span>, <span class="hljs-variable">$request</span>);

        <span class="hljs-title class_">Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>(<span class="hljs-variable">$socket</span>); <span class="hljs-comment">// æš‚åœï¼å°†socketè¿”å›ç»™è°ƒåº¦å™¨</span>

        <span class="hljs-comment">// å½“è¢«resumeæ—¶ï¼Œä»è¿™é‡Œç»§ç»­æ‰§è¡Œ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$socket</span>, <span class="hljs-number">8192</span>);
    });
}

<span class="hljs-comment">// --- ä¸»ç¨‹åº ---</span>
<span class="hljs-variable">$scheduler</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scheduler</span>();
<span class="hljs-variable">$scheduler</span>-&gt;<span class="hljs-title function_ invoke__">addTask</span>(<span class="hljs-title function_ invoke__">nonBlockingFetch</span>(<span class="hljs-string">'localhost'</span>, <span class="hljs-string">'/slow-api-1'</span>)); <span class="hljs-comment">// å‡è®¾åœ¨80ç«¯å£</span>
<span class="hljs-variable">$scheduler</span>-&gt;<span class="hljs-title function_ invoke__">addTask</span>(<span class="hljs-title function_ invoke__">nonBlockingFetch</span>(<span class="hljs-string">'localhost'</span>, <span class="hljs-string">'/slow-api-2'</span>));

<span class="hljs-variable">$start</span> = <span class="hljs-title function_ invoke__">microtime</span>(<span class="hljs-literal">true</span>);
<span class="hljs-variable">$scheduler</span>-&gt;<span class="hljs-title function_ invoke__">run</span>();
<span class="hljs-variable">$end</span> = <span class="hljs-title function_ invoke__">microtime</span>(<span class="hljs-literal">true</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-string">"Total time: "</span> . (<span class="hljs-variable">$end</span> - <span class="hljs-variable">$start</span>) . <span class="hljs-string">"s\n"</span>; <span class="hljs-comment">// è¾“å‡º: Total time: ~1s</span>
</code></pre>
<p><strong>ä»£ç è§£è¯»</strong>:</p>
<ol>
<li><code>nonBlockingFetch</code>å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªFiberã€‚å®ƒä½¿ç”¨éé˜»å¡çš„<code>stream_socket_client</code>å‘èµ·è¯·æ±‚åï¼Œç«‹åˆ»è°ƒç”¨<code>Fiber::suspend($socket)</code>æš‚åœè‡ªå·±ï¼Œå¹¶å°†socketå¥æŸ„äº¤ç»™è°ƒåº¦å™¨ã€‚</li>
<li><code>Scheduler</code>çš„<code>run</code>æ–¹æ³•æ˜¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ã€‚å®ƒå¯åŠ¨ä»»åŠ¡ï¼Œæ”¶é›†æ‰€æœ‰è¢«æš‚åœä»»åŠ¡çš„socketå¥æŸ„ã€‚</li>
<li>æ ¸å¿ƒæ˜¯<code>stream_select</code>ï¼Œå®ƒä¼šéé˜»å¡åœ°ç­‰å¾…è¿™äº›socketä¸­ä»»ä½•ä¸€ä¸ªå˜å¾—å¯è¯»ï¼ˆå³æœåŠ¡å™¨è¿”å›äº†æ•°æ®ï¼‰ã€‚</li>
<li>ä¸€æ—¦<code>stream_select</code>è¿”å›ï¼Œè°ƒåº¦å™¨å°±çŸ¥é“å“ªä¸ªsocketå‡†å¤‡å¥½äº†ï¼Œç„¶åæ‰¾åˆ°å¯¹åº”çš„Fiberï¼Œè°ƒç”¨<code>$task-&gt;resume()</code>æ¢å¤å®ƒçš„æ‰§è¡Œã€‚</li>
<li>è¢«æ¢å¤çš„Fiberä»<code>Fiber::suspend()</code>ä¹‹åç»§ç»­æ‰§è¡Œï¼Œè¯»å–æ•°æ®å¹¶æœ€ç»ˆè¿”å›ã€‚</li>
</ol>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸¤ä¸ªAPIè¯·æ±‚çš„ç­‰å¾…æ—¶é—´é‡å äº†ï¼Œæ€»è€—æ—¶è¿‘ä¼¼äºæœ€é•¿çš„é‚£ä¸€ä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬ç”¨PHPåŸç”Ÿä»£ç å®ç°äº†å¹¶å‘ã€‚</p>
<p><strong>æ€»ç»“ä¸å±•æœ›</strong></p>
<ul>
<li><strong>Fibersæ˜¯åº•å±‚å·¥å…·</strong>: ä½ å‡ ä¹æ°¸è¿œä¸ä¼šç›´æ¥åœ¨ä¸šåŠ¡ä»£ç ä¸­åƒä¸Šé¢é‚£æ ·ä½¿ç”¨Fiberã€‚å®ƒå¤ªåº•å±‚ï¼Œå¤ªå¤æ‚ã€‚</li>
<li><strong>ç†è§£åŸç†æ˜¯å…³é”®</strong>: ç†è§£Fiberçš„â€œæš‚åœ/æ¢å¤â€æ¨¡å‹ï¼Œæ˜¯ä¸ºäº†è®©ä½ æ˜ç™½é‚£äº›ä¸Šå±‚æ¡†æ¶ï¼ˆSwoole, Workerman, RoadRunnerï¼‰æ˜¯å¦‚ä½•åˆ©ç”¨è¿™ä¸ªæœºåˆ¶æ¥å®ç°æ˜“äºä½¿ç”¨çš„é«˜çº§APIçš„ï¼ˆå¦‚åç¨‹MySQLå®¢æˆ·ç«¯ã€åç¨‹Rediså®¢æˆ·ç«¯ï¼‰ã€‚</li>
<li><strong>æ¡†æ¶çš„ä»·å€¼</strong>: Laravel Octaneã€Hyperfã€imiç­‰æ¡†æ¶å·²ç»é›†æˆäº†åç¨‹ç¯å¢ƒã€‚å®ƒä»¬ä¸ºä½ å¤„ç†äº†å¤æ‚çš„è°ƒåº¦å™¨å’Œäº‹ä»¶å¾ªç¯ï¼Œè®©ä½ èƒ½ä»¥è¿‘ä¹åŒæ­¥çš„ç¼–ç æ–¹å¼ï¼Œäº«å—å¼‚æ­¥å¸¦æ¥çš„å·¨å¤§æ€§èƒ½æå‡ã€‚</li>
</ul>
<p>æŒæ¡Fiberçš„åŸç†ï¼Œæ˜¯è¿ˆå‘PHPé«˜æ€§èƒ½æœåŠ¡ç«¯ç¼–ç¨‹çš„ç¬¬ä¸€æ­¥ï¼Œå®ƒè®©ä½ èƒ½æ›´æ·±åˆ»åœ°ç†è§£å’Œä½¿ç”¨ç°ä»£PHPåº”ç”¨æœåŠ¡å™¨ã€‚</p>
<hr/>
<h6 data-id="heading-8">1.4 ç±»å‹ç³»ç»Ÿè¿›é˜¶</h6>
<p>PHP 8.x çš„ç±»å‹ç³»ç»Ÿå·²ç»ä»â€œå¯é€‰çš„æç¤ºâ€æ¼”å˜ä¸ºæ„å»ºå¥å£®ã€å¯ç»´æŠ¤ã€è‡ªæ–‡æ¡£åŒ–åº”ç”¨çš„å¼ºå¤§åŸºçŸ³ã€‚å¯¹äºæœ‰ç»éªŒçš„å¼€å‘è€…æ¥è¯´ï¼ŒæŒæ¡è¿™äº›é«˜çº§ç±»å‹ç‰¹æ€§ï¼Œæ˜¯æå‡ä»£ç è´¨é‡å’Œæ¶æ„èƒ½åŠ›çš„å¿…ç»ä¹‹è·¯ã€‚</p>
<p><strong>1. Union Types (è”åˆç±»å‹) - PHP 8.0</strong></p>
<p>åœ¨PHP 8.0ä¹‹å‰ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°æˆ–å±æ€§å¯ä»¥æ¥å—å¤šç§ç±»å‹ï¼Œæˆ‘ä»¬åªèƒ½ä¾èµ–PHPDocï¼Œè€Œæ— æ³•åœ¨è¯­è¨€å±‚é¢è¿›è¡Œçº¦æŸã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// PHP 7.x çš„æ–¹å¼</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRepository</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> int|string $identifier
     * <span class="hljs-doctag">@return</span> User|null
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">find</span>(<span class="hljs-params"><span class="hljs-variable">$identifier</span></span>): ?<span class="hljs-title">User</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_int</span>(<span class="hljs-variable">$identifier</span>)) {
            <span class="hljs-comment">// find by ID</span>
        } <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$identifier</span>)) {
            <span class="hljs-comment">// find by username</span>
        }
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p>è”åˆç±»å‹å…è®¸ä½ åœ¨å‡½æ•°ç­¾åä¸­åŸç”Ÿå£°æ˜â€œæˆ–â€çš„å…³ç³»ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// PHP 8.0+ çš„æ–¹å¼</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRepository</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">find</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>|<span class="hljs-keyword">string</span> <span class="hljs-variable">$identifier</span></span>): ?<span class="hljs-title">User</span>
    </span>{
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p><strong>å®æˆ˜åº”ç”¨</strong>:</p>
<ul>
<li><strong>çµæ´»çš„å‡½æ•°å‚æ•°</strong>: å¦‚ä¸Šä¾‹ï¼Œå…è®¸å‡½æ•°æ¥å—ä¸åŒç±»å‹çš„æ ‡è¯†ç¬¦ã€‚</li>
<li><strong>DTO/å®ä½“å±æ€§</strong>: ä¸€ä¸ªå±æ€§å¯èƒ½åœ¨åˆ›å»ºæ—¶æ˜¯<code>string</code>ï¼Œä½†åœ¨ä»æ•°æ®åº“æ°´åˆåå˜æˆ<code>DateTimeImmutable</code>å¯¹è±¡ã€‚<code>public string|DateTimeImmutable $createdAt;</code></li>
<li><strong>è¿”å›å€¼</strong>: ä¸€ä¸ªå‡½æ•°å¯èƒ½æˆåŠŸæ—¶è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¤±è´¥æ—¶è¿”å›<code>false</code>ã€‚<code>public function process(): User|false</code></li>
</ul>
<p><strong>2. Intersection Types (äº¤å‰ç±»å‹) - PHP 8.1</strong></p>
<p>å¦‚æœè¯´è”åˆç±»å‹æ˜¯â€œæˆ–â€ï¼Œé‚£ä¹ˆäº¤å‰ç±»å‹å°±æ˜¯â€œä¸â€ã€‚å®ƒè¦æ±‚ä¸€ä¸ªå€¼å¿…é¡»åŒæ—¶æ»¡è¶³å¤šä¸ªæ¥å£çš„å¥‘çº¦ã€‚è¿™åœ¨è®¾è®¡éœ€è¦å¤šç§èƒ½åŠ›ç»„åˆçš„å¤æ‚ç³»ç»Ÿæ—¶éå¸¸å¼ºå¤§ã€‚</p>
<p><strong>å®æˆ˜åº”ç”¨</strong>:
å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°æ®å¤„ç†å™¨ï¼Œå®ƒéœ€è¦å¤„ç†çš„å¯¹è±¡å¿…é¡»æ˜¯<strong>å¯è¿­ä»£çš„</strong>ï¼ˆæ¯”å¦‚ç”¨äºå¾ªç¯ï¼‰å¹¶ä¸”<strong>å¯è¢«æŒä¹…åŒ–çš„</strong>ï¼ˆæ¯”å¦‚æœ‰<code>save()</code>æ–¹æ³•ï¼‰ã€‚</p>
<ul>
<li><strong>å®šä¹‰æ¥å£</strong>:</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Persistable</span> </span>{ 
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params"/>): <span class="hljs-title">bool</span></span>;
}

<span class="hljs-comment">// Traversable æ˜¯PHPå†…ç½®æ¥å£ï¼ŒIteratorAggregate å®ç°äº†å®ƒ</span>
</code></pre>
<ul>
<li><strong>ä½¿ç”¨äº¤å‰ç±»å‹</strong>:</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Traversable</span>; <span class="hljs-comment">// æˆ–è€… Countable, IteratorAggregate ç­‰</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataHandler</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"><span class="hljs-built_in">Traversable</span>&amp;Persistable <span class="hljs-variable">$collection</span></span>)
    </span>{
        <span class="hljs-comment">// æˆ‘ä»¬ç°åœ¨å¯ä»¥100%ç¡®å®š$collectionå¯¹è±¡æ—¢å¯ä»¥è¢«foreachå¾ªç¯...</span>
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$collection</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) {
            <span class="hljs-comment">// ...</span>
        }

        <span class="hljs-comment">// ...ä¹Ÿå¯ä»¥è¢«ä¿å­˜ã€‚</span>
        <span class="hljs-variable">$collection</span>-&gt;<span class="hljs-title function_ invoke__">save</span>();
    }
}
</code></pre>
<p>äº¤å‰ç±»å‹æä¾›äº†ä¸€ç§åœ¨ä¸åˆ›å»ºæ–°æ¥å£æˆ–ç»§æ‰¿å¤æ‚ç±»å±‚æ¬¡ç»“æ„çš„æƒ…å†µä¸‹ï¼Œç»„åˆè¡Œä¸ºå¥‘çº¦çš„ä¼˜é›…æ–¹å¼ï¼Œæå¤§åœ°å¢å¼ºäº†ä»£ç çš„çµæ´»æ€§å’Œç±»å‹å®‰å…¨æ€§ã€‚</p>
<p><strong>3. <code>readonly</code> Properties &amp; Classes - PHP 8.1 / 8.2</strong></p>
<p><code>readonly</code>æ˜¯å®ç°ä¸å˜æ€§ï¼ˆImmutabilityï¼‰çš„åˆ©å™¨ã€‚ä¸€ä¸ª<code>readonly</code>å±æ€§åªèƒ½åœ¨å£°æ˜çš„ä½œç”¨åŸŸå†…ï¼ˆé€šå¸¸æ˜¯æ„é€ å‡½æ•°ï¼‰è¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œä¹‹åä»»ä½•ä¿®æ”¹éƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚</p>
<p>PHP 8.2æ›´è¿›ä¸€æ­¥ï¼Œå…è®¸å°†æ•´ä¸ªç±»æ ‡è®°ä¸º<code>readonly</code>ï¼Œè¿™æ„å‘³ç€å®ƒçš„æ‰€æœ‰å±æ€§éƒ½è‡ªåŠ¨æˆä¸ºåªè¯»å±æ€§ã€‚</p>
<p><strong>å®æˆ˜åº”ç”¨</strong>: æ„å»ºå€¼å¯¹è±¡ (Value Objects, VO) å’Œæ•°æ®ä¼ è¾“å¯¹è±¡ (DTO)ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// PHP 8.2 çš„æ–¹å¼</span>
<span class="hljs-meta">#[Attribute</span><span class="hljs-meta">]</span>
<span class="hljs-keyword">readonly</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Money</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$amount</span>, 
        <span class="hljs-keyword">public</span> Currency <span class="hljs-variable">$currency</span>
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">Money <span class="hljs-variable">$other</span></span>): <span class="hljs-title">Money</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;currency !== <span class="hljs-variable">$other</span>-&gt;currency) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Cannot add different currencies.'</span>);
        }
        <span class="hljs-comment">// è¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œè€Œä¸æ˜¯ä¿®æ”¹å½“å‰å®ä¾‹</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(<span class="hljs-variable language_">$this</span>-&gt;amount + <span class="hljs-variable">$other</span>-&gt;amount, <span class="hljs-variable language_">$this</span>-&gt;currency);
    }
}
</code></pre>
<p>åœ¨è¿™ä¸ª<code>Money</code>å€¼å¯¹è±¡ä¸­ï¼Œ<code>amount</code>å’Œ<code>currency</code>åœ¨åˆ›å»ºåå°±ä¸èƒ½è¢«æ›´æ”¹ã€‚ä»»ä½•è®¡ç®—ï¼ˆå¦‚<code>add</code>ï¼‰éƒ½ä¼šè¿”å›ä¸€ä¸ª<strong>æ–°çš„</strong><code>Money</code>å®ä¾‹ã€‚è¿™ç§ä¸å˜æ€§å¯ä»¥ä»æ ¹æœ¬ä¸Šæ¶ˆé™¤å› å¯¹è±¡çŠ¶æ€è¢«æ„å¤–ä¿®æ”¹è€Œå¯¼è‡´çš„bugï¼Œä½¿ä»£ç è¡Œä¸ºæ›´å¯é¢„æµ‹ã€‚</p>
<p><strong>4. <code>never</code> Return Type - PHP 8.1</strong></p>
<p><code>never</code>ç±»å‹æ˜ç¡®è¡¨ç¤ºä¸€ä¸ªå‡½æ•°<strong>æ°¸è¿œä¸ä¼šè¿”å›</strong>ã€‚å®ƒè¦ä¹ˆæŠ›å‡ºå¼‚å¸¸ï¼Œè¦ä¹ˆæ‰§è¡Œ<code>exit()</code>æˆ–<code>die()</code>ï¼Œè¦ä¹ˆè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯ã€‚</p>
<p><strong>å®æˆ˜åº”ç”¨</strong>:</p>
<ul>
<li><strong>é‡å®šå‘å‡½æ•°</strong>:</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">redirect</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$url</span></span>): <span class="hljs-title">never</span>
</span>{
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Location: '</span> . <span class="hljs-variable">$url</span>);
    <span class="hljs-keyword">exit</span>();
}
</code></pre>
<ul>
<li><strong>å¼‚å¸¸æŠ›å‡ºåŠ©æ‰‹</strong>:</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abort</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span></span>): <span class="hljs-title">never</span>
</span>{
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpException</span>(<span class="hljs-variable">$message</span>, <span class="hljs-variable">$code</span>);
}
</code></pre>
<p>ä½¿ç”¨<code>never</code>å¯ä»¥å¸®åŠ©é™æ€åˆ†æå·¥å…·å’ŒIDEæ›´å¥½åœ°ç†è§£ä»£ç æµã€‚å®ƒä»¬ä¼šçŸ¥é“è°ƒç”¨<code>redirect()</code>æˆ–<code>abort()</code>ä¹‹åçš„ä»»ä½•ä»£ç éƒ½æ˜¯ä¸å¯è¾¾çš„ï¼ˆunreachableï¼‰ï¼Œä»è€Œå‘ç°æ½œåœ¨çš„é€»è¾‘é”™è¯¯ã€‚</p>
<hr/>
<h6 data-id="heading-9">1.5 å…¶ä»–å…³é”®ç‰¹æ€§</h6>
<p>è¿™äº›ç‰¹æ€§è™½å°ï¼Œå´èƒ½æå¤§åœ°æå‡æ—¥å¸¸å¼€å‘çš„æ•ˆç‡å’Œä»£ç çš„ä¼˜é›…åº¦ã€‚</p>
<ul>
<li>
<p><strong>Constructor Property Promotion (æ„é€ å‡½æ•°å±æ€§æå‡)</strong>:
æˆ‘ä»¬å·²ç»åœ¨å‰é¢çš„ä¾‹å­ä¸­å¤šæ¬¡ä½¿ç”¨ã€‚å®ƒæå¤§åœ°å‡å°‘äº†å®šä¹‰DTOã€VOå’ŒServiceæ—¶çš„æ ·æ¿ä»£ç ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// PHP 7.x</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomerService</span> </span>{
    <span class="hljs-keyword">private</span> UserRepository <span class="hljs-variable">$users</span>;
    <span class="hljs-keyword">private</span> LoggerInterface <span class="hljs-variable">$logger</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">UserRepository <span class="hljs-variable">$users</span>, LoggerInterface <span class="hljs-variable">$logger</span></span>) </span>{
        <span class="hljs-variable language_">$this</span>-&gt;users = <span class="hljs-variable">$users</span>;
        <span class="hljs-variable language_">$this</span>-&gt;logger = <span class="hljs-variable">$logger</span>;
    }
}

<span class="hljs-comment">// PHP 8.0+</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomerService</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> UserRepository <span class="hljs-variable">$users</span>,
        <span class="hljs-keyword">private</span> LoggerInterface <span class="hljs-variable">$logger</span>,
    </span>) </span>{}
}
</code></pre>
</li>
<li>
<p><strong><code>match</code> Expression (é«˜çº§ç”¨æ³•)</strong>:
<code>match</code>æ˜¯<code>switch</code>çš„ç°ä»£åŒ–ã€æ›´å®‰å…¨ã€æ›´å¼ºå¤§çš„æ›¿ä»£å“ã€‚å®ƒæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆå¯ä»¥è¿”å›å€¼ï¼‰ï¼Œä½¿ç”¨ä¸¥æ ¼æ¯”è¾ƒï¼ˆ<code>===</code>ï¼‰ï¼Œä¸”æ— éœ€<code>break</code>ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// æ ¹æ®HTTPæ–¹æ³•å’Œå†…å®¹ç±»å‹è¿”å›ä¸åŒçš„å¤„ç†å™¨</span>
<span class="hljs-variable">$handler</span> = <span class="hljs-keyword">match</span> (<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">getMethod</span>()) {
    <span class="hljs-string">'GET'</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">GetHandler</span>(),
    <span class="hljs-string">'POST'</span>, <span class="hljs-string">'PUT'</span> =&gt; <span class="hljs-keyword">match</span> (<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">getHeader</span>(<span class="hljs-string">'Content-Type'</span>)) {
        <span class="hljs-string">'application/json'</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonHandler</span>(),
        <span class="hljs-string">'application/x-www-form-urlencoded'</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormHandler</span>(),
        <span class="hljs-keyword">default</span> =&gt; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedMediaTypeException</span>(),
    },
    <span class="hljs-keyword">default</span> =&gt; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MethodNotAllowedException</span>(),
};
</code></pre>
</li>
<li>
<p><strong><code>new</code> in Initializers</strong>:
åœ¨PHP 8.1ä¹‹å‰ï¼Œä½ ä¸èƒ½åœ¨å‡½æ•°é»˜è®¤å‚æ•°ã€é™æ€å˜é‡æˆ–Attributeå‚æ•°ä¸­ä½¿ç”¨<code>new</code>ã€‚ç°åœ¨å¯ä»¥äº†ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ä¸ºå‡½æ•°å‚æ•°æä¾›é»˜è®¤çš„ä¾èµ–å®ç°</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logMessage</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span>, LoggerInterface <span class="hljs-variable">$logger</span> = <span class="hljs-keyword">new</span> NullLogger(<span class="hljs-params"/>)</span>)
</span>{
    <span class="hljs-variable">$logger</span>-&gt;<span class="hljs-title function_ invoke__">info</span>(<span class="hljs-variable">$message</span>);
}

<span class="hljs-comment">// åœ¨Attributeä¸­ä½¿ç”¨</span>
<span class="hljs-meta">#[CurrentUser</span>(<span class="hljs-attr">resolver</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserFromSessionResolver</span>())<span class="hljs-meta">]</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showProfile</span>(<span class="hljs-params"/>) </span>{}
</code></pre>
</li>
<li>
<p><strong>First-class Callable Syntax</strong>:
PHP 8.1æä¾›äº†ä¸€ç§æ›´ç®€æ´ã€æ›´æ˜ç¡®çš„æ–¹å¼æ¥åˆ›å»ºé—­åŒ…ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// PHP 7.4 / 8.0</span>
<span class="hljs-variable">$users</span>-&gt;<span class="hljs-title function_ invoke__">map</span>(<span class="hljs-title class_">Closure</span>::<span class="hljs-title function_ invoke__">fromCallable</span>([<span class="hljs-variable">$user</span>, <span class="hljs-string">'getName'</span>]));
<span class="hljs-variable">$users</span>-&gt;<span class="hljs-title function_ invoke__">map</span>(fn(<span class="hljs-variable">$user</span>) =&gt; <span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>());

<span class="hljs-comment">// PHP 8.1+</span>
<span class="hljs-variable">$users</span>-&gt;<span class="hljs-title function_ invoke__">map</span>(<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>(...)); 
</code></pre>
<p><code>...</code>è¯­æ³•åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘è¯¥æ–¹æ³•çš„é—­åŒ…ï¼Œå¹¶ä¸”æ˜¯ä¸Šä¸‹æ–‡æ— å…³çš„ï¼Œé™æ€åˆ†æå·¥å…·å¯ä»¥æ›´å¥½åœ°ç†è§£å®ƒã€‚</p>
</li>
</ul>
<hr/>
<hr/>
<h4 data-id="heading-10">ç¬¬äºŒéƒ¨åˆ†ï¼šç°ä»£æ¶æ„ä¸è®¾è®¡ (Advanced Architecture &amp; Design)</h4>
<h5 data-id="heading-11">ç¬¬2ç« ï¼šè¶…è¶ŠMVCï¼šæ„å»ºå¯æ‰©å±•çš„æœåŠ¡åŒ–æ¶æ„</h5>
<p>ç»å…¸çš„MVCï¼ˆModel-View-Controllerï¼‰æ¨¡å¼æ˜¯è®¸å¤šPHPå¼€å‘è€…å…¥é—¨çš„ç¬¬ä¸€ä¸ªæ¶æ„æ¨¡å¼ï¼Œå®ƒåœ¨å¤„ç†ç®€å•çš„CRUDåº”ç”¨æ—¶è¡¨ç°å‡ºè‰²ã€‚ç„¶è€Œï¼Œéšç€ä¸šåŠ¡é€»è¾‘å˜å¾—æ—¥ç›Šå¤æ‚ï¼Œå¼€å‘è€…å¾€å¾€ä¼šé™·å…¥ä¸¤å¤§å›°å¢ƒï¼š</p>
<ol>
<li><strong>èƒ–æ§åˆ¶å™¨ (Fat Controller)</strong>: ä¸ºäº†å¿«é€Ÿå®ç°åŠŸèƒ½ï¼Œå¤§é‡ä¸šåŠ¡é€»è¾‘ã€æ•°æ®éªŒè¯ã€ç¬¬ä¸‰æ–¹APIè°ƒç”¨ã€äº‹ä»¶åˆ†å‘ç­‰ä»£ç è¢«å †ç Œåœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸­ï¼Œå¯¼è‡´æ§åˆ¶å™¨å˜å¾—è‡ƒè‚¿ã€éš¾ä»¥æµ‹è¯•å’Œå¤ç”¨ã€‚</li>
<li><strong>èƒ–æ¨¡å‹ (Fat Model)</strong>: å¦ä¸€ç§æç«¯æ˜¯å°†æ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½å¡è¿›Modelï¼ˆå°¤å…¶æ˜¯Active Recordæ¨¡å¼çš„Modelï¼‰ä¸­ï¼Œå¯¼è‡´æ¨¡å‹ä¸ä»…è¦è´Ÿè´£æ•°æ®æŒä¹…åŒ–ï¼Œè¿˜è¦æ‰¿æ‹…å¤æ‚çš„ä¸šåŠ¡è®¡ç®—å’Œæµç¨‹æ§åˆ¶ï¼Œè¿åäº†å•ä¸€èŒè´£åŸåˆ™ã€‚</li>
</ol>
<p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥æ›´ç²¾ç»†çš„åˆ†å±‚æ¶æ„ï¼Œå°†ä¸åŒçš„èŒè´£æ¸…æ™°åœ°åˆ†ç¦»åˆ°ä¸åŒçš„ç±»ä¸­ã€‚</p>
<h6 data-id="heading-12">2.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†å±‚æ¶æ„</h6>
<p>åˆ†å±‚æ¶æ„çš„æ ¸å¿ƒæ€æƒ³æ˜¯<strong>å…³æ³¨ç‚¹åˆ†ç¦» (Separation of Concerns)</strong>ã€‚é€šè¿‡å¼•å…¥æ–°çš„å±‚æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li><strong>æå‡ä»£ç çš„å¯æµ‹è¯•æ€§</strong>: å°†ä¸šåŠ¡é€»è¾‘ä»ä¸HTTPè¯·æ±‚ç´§å¯†è€¦åˆçš„æ§åˆ¶å™¨ä¸­å‰¥ç¦»å‡ºæ¥ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸æ¨¡æ‹ŸHTTPç¯å¢ƒçš„æƒ…å†µä¸‹å¯¹å…¶è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚</li>
<li><strong>å¢å¼ºä»£ç çš„å¯å¤ç”¨æ€§</strong>: åŒæ ·çš„ä¸šåŠ¡é€»è¾‘å¯èƒ½è¢«å¤šä¸ªåœ°æ–¹è°ƒç”¨ï¼Œä¾‹å¦‚è¢«Webæ§åˆ¶å™¨ã€APIæ§åˆ¶å™¨ã€å‘½ä»¤è¡Œä»»åŠ¡ã€é˜Ÿåˆ—ä»»åŠ¡ç­‰ã€‚å°†å®ƒå°è£…åœ¨ç‹¬ç«‹çš„å±‚ä¸­ï¼Œå°±å¯ä»¥è¢«è½»æ¾å¤ç”¨ã€‚</li>
<li><strong>æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§</strong>: æ¯ä¸ªå±‚èŒè´£å•ä¸€ï¼Œä¿®æ”¹ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œä½ åªéœ€è¦å…³å¿ƒæœåŠ¡å±‚ï¼›ä¿®æ”¹æ•°æ®è®¿é—®æ–¹å¼æ—¶ï¼Œä½ åªéœ€è¦å…³å¿ƒä»“åº“å±‚ã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ–°äººæ›´å®¹æ˜“ä¸Šæ‰‹ã€‚</li>
<li><strong>é€‚åº”æœªæ¥çš„å˜åŒ–</strong>: å¦‚æœæœ‰ä¸€å¤©ä½ éœ€è¦å°†æ•°æ®åº“ä»MySQLè¿ç§»åˆ°PostgreSQLï¼Œæˆ–è€…ä»Eloquent ORMåˆ‡æ¢åˆ°Doctrineï¼Œä½ åªéœ€è¦é‡å†™ä»“åº“å±‚çš„å®ç°ï¼Œè€ŒæœåŠ¡å±‚å’Œæ§åˆ¶å™¨å±‚å‡ ä¹ä¸å—å½±å“ã€‚</li>
</ul>
<h6 data-id="heading-13">2.2 æ¶æ„æ¨¡å¼å®æˆ˜</h6>
<p>ä¸€ä¸ªå…¸å‹ä¸”å®ç”¨çš„åˆ†å±‚æ¶æ„åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒå±‚æ¬¡ï¼š</p>
<p><strong>1. æœåŠ¡å±‚ (Service Layer)</strong></p>
<ul>
<li><strong>èŒè´£</strong>: å°è£…å’Œç¼–æ’æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€‚å®ƒæ˜¯åº”ç”¨åŠŸèƒ½çš„ç›´æ¥ä½“ç°ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>:
<ul>
<li>å®ƒä¸å…³å¿ƒæ•°æ®ä»å“ªé‡Œæ¥ï¼ˆHTTPè¯·æ±‚ã€å‘½ä»¤è¡Œå‚æ•°ï¼‰ï¼Œä¹Ÿä¸å…³å¿ƒæ•°æ®åˆ°å“ªé‡Œå»ï¼ˆæ¸²æŸ“HTMLã€è¿”å›JSONï¼‰ã€‚</li>
<li>å®ƒè°ƒç”¨ä¸€ä¸ªæˆ–å¤šä¸ªä»“åº“å±‚æ¥è·å–å’ŒæŒä¹…åŒ–æ•°æ®ã€‚</li>
<li>å®ƒå¯ä»¥è°ƒç”¨å…¶ä»–æœåŠ¡æ¥å®Œæˆæ›´å¤æ‚çš„ä¸šåŠ¡æµç¨‹ã€‚</li>
<li>å®ƒé€šå¸¸æ˜¯äº‹åŠ¡è¾¹ç•Œçš„ç†æƒ³ä½ç½®ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªå¸–å­å‘å¸ƒæœåŠ¡</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Service/PostPublisherService.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostPublisherService</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> PostRepository <span class="hljs-variable">$postRepository</span>,
        <span class="hljs-keyword">private</span> UserRepository <span class="hljs-variable">$userRepository</span>,
        <span class="hljs-keyword">private</span> EventDispatcher <span class="hljs-variable">$dispatcher</span>,
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">publish</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$postId</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$userId</span></span>): <span class="hljs-title">Post</span>
    </span>{
        <span class="hljs-variable">$post</span> = <span class="hljs-variable language_">$this</span>-&gt;postRepository-&gt;<span class="hljs-title function_ invoke__">findOrFail</span>(<span class="hljs-variable">$postId</span>);
        <span class="hljs-variable">$user</span> = <span class="hljs-variable language_">$this</span>-&gt;userRepository-&gt;<span class="hljs-title function_ invoke__">findOrFail</span>(<span class="hljs-variable">$userId</span>);

        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">can</span>(<span class="hljs-string">'publish'</span>, <span class="hljs-variable">$post</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AuthorizationException</span>(<span class="hljs-string">'You are not allowed to publish this post.'</span>);
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$post</span>-&gt;status === <span class="hljs-title class_">PostStatus</span>::<span class="hljs-variable constant_">Published</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">DomainException</span>(<span class="hljs-string">'Post is already published.'</span>);
        }

        <span class="hljs-comment">// æ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span>
        <span class="hljs-variable">$post</span>-&gt;status = <span class="hljs-title class_">PostStatus</span>::<span class="hljs-variable constant_">Published</span>;
        <span class="hljs-variable">$post</span>-&gt;published_at = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTimeImmutable</span>();
        
        <span class="hljs-variable language_">$this</span>-&gt;postRepository-&gt;<span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$post</span>);

        <span class="hljs-comment">// åˆ†å‘é¢†åŸŸäº‹ä»¶</span>
        <span class="hljs-variable language_">$this</span>-&gt;dispatcher-&gt;<span class="hljs-title function_ invoke__">dispatch</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PostWasPublished</span>(<span class="hljs-variable">$post</span>-&gt;id));

        <span class="hljs-keyword">return</span> <span class="hljs-variable">$post</span>;
    }
}
</code></pre>
<p><strong>2. ä»“åº“å±‚ (Repository Layer)</strong></p>
<ul>
<li><strong>èŒè´£</strong>: æŠ½è±¡æ•°æ®è®¿é—®é€»è¾‘ï¼Œå……å½“é¢†åŸŸå¯¹è±¡ï¼ˆå¦‚<code>Post</code>å®ä½“ï¼‰ä¸æ•°æ®æŒä¹…åŒ–æœºåˆ¶ï¼ˆå¦‚æ•°æ®åº“ã€ç¼“å­˜ã€å¤–éƒ¨APIï¼‰ä¹‹é—´çš„ä¸­ä»‹ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>:
<ul>
<li>å®ƒæä¾›ä¸€ä¸ªç±»ä¼¼é›†åˆçš„æ¥å£æ¥æ“ä½œé¢†åŸŸå¯¹è±¡ã€‚</li>
<li>å®ƒçš„å…¬å…±æ–¹æ³•åº”è¯¥è¿”å›é¢†åŸŸå¯¹è±¡æˆ–é¢†åŸŸå¯¹è±¡çš„é›†åˆã€‚</li>
<li>å®ƒéšè—äº†åº•å±‚çš„æŸ¥è¯¢é€»è¾‘ï¼ˆæ— è®ºæ˜¯Eloquentã€Doctrine Query Builderè¿˜æ˜¯åŸç”ŸSQLï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼šå¸–å­çš„ä»“åº“æ¥å£ä¸å®ç°</strong></p>
<ul>
<li><strong>å®šä¹‰æ¥å£ (Contract)</strong>:</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Repository/PostRepository.php</span>
<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">PostRepository</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findOrFail</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$id</span></span>): <span class="hljs-title">Post</span></span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params">Post <span class="hljs-variable">$post</span></span>): <span class="hljs-title">bool</span></span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findPublished</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$limit</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$offset</span></span>): <span class="hljs-title">array</span></span>;
}
</code></pre>
<ul>
<li><strong>åŸºäºEloquentçš„å®ç°</strong>:</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Repository/Eloquent/PostRepositoryImpl.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostRepositoryImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PostRepository</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findOrFail</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$id</span></span>): <span class="hljs-title">Post</span>
    </span>{
        <span class="hljs-comment">// Postæ˜¯Eloquent Model</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Post</span>::<span class="hljs-title function_ invoke__">findOrFail</span>(<span class="hljs-variable">$id</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params">Post <span class="hljs-variable">$post</span></span>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$post</span>-&gt;<span class="hljs-title function_ invoke__">save</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findPublished</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$limit</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$offset</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Post</span>::<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">'status'</span>, <span class="hljs-title class_">PostStatus</span>::<span class="hljs-variable constant_">Published</span>)
            -&gt;<span class="hljs-title function_ invoke__">orderBy</span>(<span class="hljs-string">'published_at'</span>, <span class="hljs-string">'desc'</span>)
            -&gt;<span class="hljs-title function_ invoke__">limit</span>(<span class="hljs-variable">$limit</span>)
            -&gt;<span class="hljs-title function_ invoke__">offset</span>(<span class="hljs-variable">$offset</span>)
            -&gt;<span class="hljs-title function_ invoke__">get</span>()
            -&gt;<span class="hljs-title function_ invoke__">all</span>();
    }
}
</code></pre>
<p>é€šè¿‡ä¾èµ–æ¥å£ï¼ˆ<code>PostRepository</code>ï¼‰è€Œä¸æ˜¯å…·ä½“å®ç°ï¼ˆ<code>PostRepositoryImpl</code>ï¼‰ï¼Œæˆ‘ä»¬çš„<code>PostPublisherService</code>å®Œå…¨ä¸çŸ¥é“æ•°æ®æ˜¯å­˜åœ¨MySQLè¿˜æ˜¯å…¶ä»–åœ°æ–¹ï¼Œå®ç°äº†ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®è®¿é—®çš„è§£è€¦ã€‚</p>
<p><strong>3. æ•°æ®ä¼ è¾“å¯¹è±¡ (Data Transfer Object, DTO)</strong></p>
<ul>
<li><strong>èŒè´£</strong>: åœ¨ä¸åŒå±‚ä¹‹é—´ï¼ˆå°¤å…¶æ˜¯æ§åˆ¶å™¨å’ŒæœåŠ¡å±‚ä¹‹é—´ï¼‰ä¼ é€’æ•°æ®ã€‚å®ƒæ˜¯ä¸€ä¸ªç®€å•ã€æ²¡æœ‰è¡Œä¸ºçš„çº¯æ•°æ®å¯¹è±¡ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>:
<ul>
<li>é€šå¸¸æ˜¯<code>readonly</code>çš„ï¼Œä»¥ä¿è¯æ•°æ®åœ¨ä¼ é€’è¿‡ç¨‹ä¸­çš„ä¸å˜æ€§ã€‚</li>
<li>å®ƒçš„å±æ€§æ˜¯å…¬å¼€çš„ï¼Œä¾¿äºè®¿é—®ã€‚</li>
<li>å®ƒå¯ä»¥åŒ…å«æ¥è‡ªHTTPè¯·æ±‚çš„ç»è¿‡éªŒè¯å’Œç±»å‹è½¬æ¢çš„æ•°æ®ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼šåˆ›å»ºå¸–å­çš„DTO</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/DTO/CreatePostDTO.php</span>
<span class="hljs-keyword">readonly</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreatePostDTO</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$title</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$content</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$authorId</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$tags</span>,
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromRequest</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-comment">// æ­¤å¤„å¯ä»¥åŒ…å«éªŒè¯é€»è¾‘ï¼Œæˆ–å‡è®¾æ•°æ®å·²ç”±FormRequestéªŒè¯</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(
            title: <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">'title'</span>),
            content: <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">'content'</span>),
            authorId: <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">user</span>()-&gt;id,
            tags: <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">'tags'</span>, []),
        );
    }
}
</code></pre>
<p><strong>æ•´åˆä¸‰è€…ï¼šé‡æ„æ§åˆ¶å™¨</strong></p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„æ§åˆ¶å™¨å˜å¾—æå…¶â€œç˜¦â€ä¸”æ¸…æ™°ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Controller/PostController.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostController</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> PostPublisherService <span class="hljs-variable">$publisher</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">publish</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$postId</span></span>)
    </span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-variable">$post</span> = <span class="hljs-variable language_">$this</span>-&gt;publisher-&gt;<span class="hljs-title function_ invoke__">publish</span>(<span class="hljs-variable">$postId</span>, <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">user</span>()-&gt;id);
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">PostResource</span>::<span class="hljs-title function_ invoke__">make</span>(<span class="hljs-variable">$post</span>); <span class="hljs-comment">// ä½¿ç”¨API Resourceè¿”å›JSON</span>
        } <span class="hljs-keyword">catch</span> (AuthorizationException <span class="hljs-variable">$e</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">response</span>()-&gt;<span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'message'</span> =&gt; <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>()], <span class="hljs-number">403</span>);
        } <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">DomainException</span> <span class="hljs-variable">$e</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">response</span>()-&gt;<span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'message'</span> =&gt; <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>()], <span class="hljs-number">422</span>);
        } <span class="hljs-keyword">catch</span> (ModelNotFoundException <span class="hljs-variable">$e</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">response</span>()-&gt;<span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'Post not found.'</span>], <span class="hljs-number">404</span>);
        }
    }
}
</code></pre>
<p>æ§åˆ¶å™¨çš„èŒè´£å›å½’æœ¬æºï¼šè§£æHTTPè¯·æ±‚ï¼Œè°ƒç”¨ç›¸åº”çš„æœåŠ¡ï¼Œå¤„ç†å¼‚å¸¸ï¼Œå¹¶è¿”å›HTTPå“åº”ã€‚æ‰€æœ‰çš„ä¸šåŠ¡å¤æ‚æ€§éƒ½è¢«ä¼˜é›…åœ°å°è£…åœ¨äº†æœåŠ¡å±‚å’Œä»“åº“å±‚ä¸­ã€‚</p>
<h6 data-id="heading-14">2.3 é¢†åŸŸé©±åŠ¨è®¾è®¡ (DDD) Lite åœ¨PHPä¸­çš„å®è·µ</h6>
<p>é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDomain-Driven Design, DDDï¼‰æ˜¯ä¸€å¥—å¤æ‚çš„è½¯ä»¶å¼€å‘æ–¹æ³•è®ºï¼Œæ—¨åœ¨å°†è½¯ä»¶çš„æ ¸å¿ƒå¤æ‚æ€§èšç„¦äºä¸šåŠ¡é¢†åŸŸæœ¬èº«ã€‚å®Œå…¨å®æ–½DDDå¯¹è®¸å¤šé¡¹ç›®æ¥è¯´è¿‡äºæ²‰é‡ï¼Œä½†æˆ‘ä»¬å¯ä»¥å€Ÿé‰´å…¶æ ¸å¿ƒæ€æƒ³å’Œæ¨¡å¼ï¼ˆå³â€œDDD Liteâ€ï¼‰ï¼Œæ¥æå¤§åœ°æ”¹è¿›æˆ‘ä»¬å·²ç»å»ºç«‹çš„åˆ†å±‚æ¶æ„ã€‚</p>
<p>DDD Liteçš„æ ¸å¿ƒæ˜¯<strong>ä½¿ç”¨ä»£ç æ¥ç²¾ç¡®åœ°è¡¨è¾¾ä¸šåŠ¡é¢†åŸŸä¸­çš„æ¦‚å¿µå’Œè§„åˆ™</strong>ã€‚</p>
<p><strong>1. Entity (å®ä½“)</strong></p>
<p>å®ä½“æ˜¯å…·æœ‰<strong>å”¯ä¸€æ ‡è¯†</strong>å’Œ<strong>ç”Ÿå‘½å‘¨æœŸ</strong>çš„é¢†åŸŸå¯¹è±¡ã€‚å®ƒçš„æ ¸å¿ƒæ˜¯â€œèº«ä»½â€ï¼Œè€Œä¸æ˜¯å±æ€§ã€‚åœ¨æˆ‘ä»¬çš„åˆ†å±‚æ¶æ„ä¸­ï¼Œ<code>Post</code>å’Œ<code>User</code>å°±æ˜¯å…¸å‹çš„å®ä½“ã€‚å®ƒä»¬æœ‰IDï¼Œå³ä½¿å®ƒä»¬çš„å±æ€§ï¼ˆå¦‚<code>Post</code>çš„æ ‡é¢˜ï¼‰å‘ç”Ÿå˜åŒ–ï¼Œå®ƒä»¬ä»ç„¶æ˜¯åŒä¸€ä¸ªå®ä½“ã€‚</p>
<p><strong>å…³é”®å®è·µ</strong>: å®ä½“çš„å…¬å…±æ–¹æ³•åº”è¯¥ä½“ç°ä¸šåŠ¡è¡Œä¸ºï¼Œè€Œä¸ä»…ä»…æ˜¯<code>get/set</code>ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Post</span>
</span>{
    <span class="hljs-comment">// ... properties</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">archive</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;status === <span class="hljs-title class_">PostStatus</span>::<span class="hljs-variable constant_">Draft</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">DomainException</span>(<span class="hljs-string">'Cannot archive a draft post.'</span>);
        }
        <span class="hljs-variable language_">$this</span>-&gt;status = <span class="hljs-title class_">PostStatus</span>::<span class="hljs-variable constant_">Archived</span>;
        <span class="hljs-variable language_">$this</span>-&gt;archived_at = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTimeImmutable</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeTitle</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$newTitle</span>, User <span class="hljs-variable">$editor</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$newTitle</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Title cannot be empty.'</span>);
        }
        <span class="hljs-variable language_">$this</span>-&gt;title = <span class="hljs-variable">$newTitle</span>;
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">addLog</span>(<span class="hljs-string">"Title changed by <span class="hljs-subst">{$editor-&gt;name}</span>"</span>);
    }
}
</code></pre>
<p>è°ƒç”¨<code>$post-&gt;archive()</code>æ¯”<code>$post-&gt;setStatus(PostStatus::Archived)</code>æ›´èƒ½ä½“ç°ä¸šåŠ¡æ„å›¾ã€‚</p>
<p><strong>2. Value Object (å€¼å¯¹è±¡, VO)</strong></p>
<p>å€¼å¯¹è±¡æ˜¯æ²¡æœ‰å”¯ä¸€æ ‡è¯†çš„ã€ç”¨äºæè¿°é¢†åŸŸä¸­æŸä¸ªæ–¹é¢å±æ€§çš„å¯¹è±¡ã€‚å®ƒçš„æ ¸å¿ƒæ˜¯å®ƒçš„<strong>å±æ€§å€¼</strong>ï¼Œå¹¶ä¸”å®ƒåº”è¯¥æ˜¯<strong>ä¸å¯å˜çš„ (immutable)</strong>ã€‚ä¸¤ä¸ªå€¼å¯¹è±¡åªè¦æ‰€æœ‰å±æ€§éƒ½ç›¸åŒï¼Œå®ƒä»¬å°±æ˜¯ç­‰ä»·çš„ã€‚</p>
<p>æˆ‘ä»¬åœ¨<code>readonly</code>ç‰¹æ€§ä¸­å·²ç»æ¥è§¦è¿‡<code>Money</code>çš„ä¾‹å­ã€‚å¦ä¸€ä¸ªç»å…¸ä¾‹å­æ˜¯<code>Address</code>ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Domain/ValueObject/Address.php</span>
<span class="hljs-keyword">readonly</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$street</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$city</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$postalCode</span>,
    </span>)
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$street</span>) || <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$city</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Street and city cannot be empty.'</span>);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">equals</span>(<span class="hljs-params">Address <span class="hljs-variable">$other</span></span>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;street === <span class="hljs-variable">$other</span>-&gt;street &amp;&amp;
               <span class="hljs-variable language_">$this</span>-&gt;city === <span class="hljs-variable">$other</span>-&gt;city &amp;&amp;
               <span class="hljs-variable language_">$this</span>-&gt;postalCode === <span class="hljs-variable">$other</span>-&gt;postalCode;
    }
}
</code></pre>
<p><strong>å…³é”®å®è·µ</strong>: åœ¨å®ä½“ä¸­ä½¿ç”¨å€¼å¯¹è±¡æ¥æ›¿ä»£ä¸€ç»„é›¶æ•£çš„å±æ€§ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ä¸å¥½çš„å®è·µ</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Order</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$shippingStreet</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$shippingCity</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$shippingPostalCode</span>;
}

<span class="hljs-comment">// å¥½çš„å®è·µ</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Order</span> </span>{
    <span class="hljs-keyword">public</span> Address <span class="hljs-variable">$shippingAddress</span>;
}
</code></pre>
<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š</p>
<ul>
<li><strong>å†…èšæ€§</strong>: ä¸åœ°å€ç›¸å…³çš„é€»è¾‘ï¼ˆå¦‚éªŒè¯ï¼‰è¢«å°è£…åœ¨<code>Address</code>ç±»ä¸­ã€‚</li>
<li><strong>ä»£ç å¤ç”¨</strong>: <code>Address</code>å€¼å¯¹è±¡å¯ä»¥åœ¨<code>Order</code>ã€<code>User</code>ã€<code>Warehouse</code>ç­‰å¤šä¸ªå®ä½“ä¸­å¤ç”¨ã€‚</li>
<li><strong>æ˜ç¡®æ€§</strong>: <code>Address</code>ç±»å‹æ¯”ä¸€ç»„<code>string</code>æ›´èƒ½æ¸…æ™°åœ°è¡¨è¾¾ä¸šåŠ¡æ¦‚å¿µã€‚</li>
</ul>
<p><strong>3. Aggregate &amp; Aggregate Root (èšåˆä¸èšåˆæ ¹)</strong></p>
<p>è¿™æ˜¯DDDä¸­ä¸€ä¸ªæå…¶é‡è¦çš„æ¦‚å¿µã€‚<strong>èšåˆ</strong>æ˜¯ä¸€ç»„ä¸šåŠ¡ä¸Šç´§å¯†å…³è”çš„å®ä½“å’Œå€¼å¯¹è±¡çš„é›†åˆï¼Œå®ƒè¢«è§†ä¸ºä¸€ä¸ªæ•°æ®ä¿®æ”¹çš„å•å…ƒã€‚<strong>èšåˆæ ¹</strong>æ˜¯è¿™ä¸ªé›†åˆä¸­çš„ä¸€ä¸ªç‰¹å®šå®ä½“ï¼Œä½œä¸ºæ•´ä¸ªèšåˆçš„å”¯ä¸€å…¥å£ã€‚</p>
<p><strong>è§„åˆ™</strong>:</p>
<ul>
<li>å¤–éƒ¨å¯¹è±¡åªèƒ½æŒæœ‰å¯¹èšåˆæ ¹çš„å¼•ç”¨ã€‚</li>
<li>å¯¹èšåˆå†…éƒ¨çš„ä»»ä½•ä¿®æ”¹éƒ½å¿…é¡»é€šè¿‡èšåˆæ ¹çš„æ–¹æ³•æ¥å®Œæˆã€‚</li>
<li>èšåˆæ ¹è´Ÿè´£ç»´æŠ¤å…¶å†…éƒ¨æ‰€æœ‰å¯¹è±¡çš„ä¸€è‡´æ€§è§„åˆ™ï¼ˆå³â€œä¸å˜é‡â€ï¼‰ã€‚</li>
</ul>
<p><strong>å®æˆ˜åº”ç”¨ï¼šè®¢å•(Order)èšåˆ</strong></p>
<p>ä¸€ä¸ª<code>Order</code>èšåˆå¯èƒ½åŒ…å«ï¼š</p>
<ul>
<li><code>Order</code>å®ä½“ï¼ˆèšåˆæ ¹ï¼‰</li>
<li>ä¸€ç»„<code>OrderItem</code>å®ä½“</li>
<li>ä¸€ä¸ª<code>Address</code>å€¼å¯¹è±¡ï¼ˆæ”¶è´§åœ°å€ï¼‰</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$id</span>;
    <span class="hljs-keyword">private</span> Address <span class="hljs-variable">$shippingAddress</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$items</span> = [];
    <span class="hljs-keyword">private</span> OrderStatus <span class="hljs-variable">$status</span>;

    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addItem</span>(<span class="hljs-params">Product <span class="hljs-variable">$product</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$quantity</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;status !== <span class="hljs-title class_">OrderStatus</span>::<span class="hljs-variable constant_">Pending</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">DomainException</span>(<span class="hljs-string">'Cannot add items to a non-pending order.'</span>);
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$quantity</span> &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Quantity must be positive.'</span>);
        }
        
        <span class="hljs-comment">// èšåˆæ ¹è´Ÿè´£åˆ›å»ºå’Œç®¡ç†å†…éƒ¨å®ä½“</span>
        <span class="hljs-variable language_">$this</span>-&gt;items[] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderItem</span>(<span class="hljs-variable">$product</span>-&gt;id, <span class="hljs-variable">$product</span>-&gt;price, <span class="hljs-variable">$quantity</span>);
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">recalculateTotal</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ship</span>(<span class="hljs-params">Address <span class="hljs-variable">$address</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;status !== <span class="hljs-title class_">OrderStatus</span>::<span class="hljs-variable constant_">Paid</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">DomainException</span>(<span class="hljs-string">'Cannot ship an unpaid order.'</span>);
        }
        <span class="hljs-variable language_">$this</span>-&gt;shippingAddress = <span class="hljs-variable">$address</span>;
        <span class="hljs-variable language_">$this</span>-&gt;status = <span class="hljs-title class_">OrderStatus</span>::<span class="hljs-variable constant_">Shipped</span>;
        
        <span class="hljs-comment">// åˆ†å‘é¢†åŸŸäº‹ä»¶</span>
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">dispatch</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderWasShipped</span>(<span class="hljs-variable">$this</span>-&gt;id));
    }

    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³•</span>
}
</code></pre>
<p><strong>å…³é”®å®è·µ</strong>:</p>
<ul>
<li><code>OrderItemRepository</code>æ˜¯ä¸åº”è¯¥å­˜åœ¨çš„ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªè®¢å•é¡¹ï¼Œä½ å¿…é¡»å…ˆé€šè¿‡<code>OrderRepository</code>è·å–<code>Order</code>ï¼Œå†ä»<code>Order</code>å¯¹è±¡ä¸­è·å–å®ƒã€‚</li>
<li>æ‰€æœ‰ä¸šåŠ¡æ“ä½œï¼Œå¦‚<code>addItem</code>, <code>ship</code>, <code>cancel</code>ï¼Œéƒ½æ˜¯<code>Order</code>èšåˆæ ¹çš„æ–¹æ³•ã€‚è¿™ä¿è¯äº†åœ¨ä»»ä½•æ“ä½œåï¼Œ<code>Order</code>çš„å†…éƒ¨çŠ¶æ€ï¼ˆå¦‚æ€»ä»·ã€çŠ¶æ€ï¼‰éƒ½æ˜¯ä¸€è‡´å’Œæœ‰æ•ˆçš„ã€‚</li>
</ul>
<p><strong>4. Domain Event (é¢†åŸŸäº‹ä»¶)</strong></p>
<p>é¢†åŸŸäº‹ä»¶æ˜¯è¡¨ç¤ºé¢†åŸŸä¸­å·²å‘ç”Ÿäº‹æƒ…çš„å¯¹è±¡ã€‚å®ƒç”¨äºè§£è€¦èšåˆå†…éƒ¨çš„æ ¸å¿ƒé€»è¾‘å’Œåç»­çš„å‰¯ä½œç”¨ï¼ˆå¦‚å‘é€é‚®ä»¶ã€é€šçŸ¥ã€æ›´æ–°å…¶ä»–èšåˆç­‰ï¼‰ã€‚</p>
<p>æˆ‘ä»¬åœ¨<code>PostPublisherService</code>ä¸­å·²ç»è§è¿‡å®ƒçš„èº«å½±ï¼š<code>$this-&gt;dispatcher-&gt;dispatch(new PostWasPublished($post-&gt;id));</code></p>
<p><strong>å…³é”®å®è·µ</strong>:</p>
<ul>
<li><strong>å‘½å</strong>: ä½¿ç”¨è¿‡å»æ—¶æ€ï¼Œå¦‚<code>OrderWasPlaced</code>, <code>UserRegistered</code>ã€‚</li>
<li><strong>å†…å®¹</strong>: äº‹ä»¶åº”åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯è®©ç›‘å¬è€…èƒ½å®Œæˆå·¥ä½œï¼Œé€šå¸¸æ˜¯ç›¸å…³å®ä½“çš„IDå’Œå…³é”®æ•°æ®ã€‚</li>
<li><strong>è§£è€¦</strong>: æ ¸å¿ƒä¸šåŠ¡ï¼ˆå¦‚ä¸‹è®¢å•ï¼‰å®Œæˆåï¼Œç«‹å³åˆ†å‘äº‹ä»¶ã€‚ç„¶åï¼Œä¸€ä¸ªæˆ–å¤šä¸ª<strong>ç›‘å¬å™¨ (Listeners)</strong> ä¼šå¼‚æ­¥ï¼ˆæˆ–åŒæ­¥ï¼‰åœ°å“åº”è¯¥äº‹ä»¶ï¼Œæ‰§è¡Œå‘é€ç¡®è®¤é‚®ä»¶ã€æ‰£å‡åº“å­˜ã€é€šçŸ¥ä»“åº“ç­‰æ“ä½œã€‚è¿™ä½¿å¾—æ ¸å¿ƒä¸šåŠ¡æµç¨‹éå¸¸å¹²å‡€ã€å¿«é€Ÿï¼Œå¹¶ä¸”æ˜“äºæ‰©å±•ã€‚</li>
</ul>
<p>é€šè¿‡åº”ç”¨è¿™äº›DDD Liteæ¨¡å¼ï¼Œä½ çš„ä»£ç å°†ä¸å†ä»…ä»…æ˜¯æ•°æ®çš„æ¬è¿å·¥ï¼Œè€Œæ˜¯æˆä¸ºä¸šåŠ¡é¢†åŸŸæœ¬èº«çš„ç²¾å‡†ã€å¥å£®ã€å¯æ¼”è¿›çš„æ¨¡å‹ã€‚</p>
<p><strong>DDDçš„æƒè¡¡ï¼šä½•æ—¶ä½¿ç”¨ï¼Ÿ</strong></p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒDDDå¹¶éé“¶å¼¹ã€‚å®ƒå¸¦æ¥äº†æ›´é«˜çš„è®¤çŸ¥è´Ÿè·å’Œä»£ç é‡ï¼Œå¯¹äºç®€å•çš„ä¸šåŠ¡åœºæ™¯å¯èƒ½å±äºâ€œè¿‡åº¦è®¾è®¡â€ã€‚</p>
<ul>
<li><strong>ä½•æ—¶ä½¿ç”¨</strong>: å½“ä½ é¢å¯¹ä¸€ä¸ªå…·æœ‰å¤æ‚ä¸šåŠ¡è§„åˆ™ã€æµç¨‹å’Œä¸å˜é‡çš„æ ¸å¿ƒé¢†åŸŸæ—¶ï¼ˆä¾‹å¦‚ï¼Œç”µå•†çš„è®¢å•å’Œåº“å­˜ç®¡ç†ã€é‡‘èçš„é£æ§å’Œäº¤æ˜“ï¼‰ï¼ŒDDDçš„æŠ•å…¥æ˜¯å€¼å¾—çš„ã€‚å®ƒèƒ½å¸®åŠ©ä½ ç†æ¸…å¤æ‚æ€§ï¼Œæ„å»ºä¸€ä¸ªå¯é•¿æœŸæ¼”è¿›çš„å¥å£®æ¨¡å‹ã€‚</li>
<li><strong>ä½•æ—¶æ…ç”¨</strong>: å¯¹äºé‚£äº›ä¸šåŠ¡é€»è¾‘ç®€å•ã€ä»¥æ•°æ®å±•ç¤ºä¸ºä¸»çš„CRUDæ¨¡å—ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªåå°çš„æ ‡ç­¾ç®¡ç†ã€æ–‡ç« åˆ†ç±»ç®¡ç†ï¼‰ï¼Œä½¿ç”¨ç®€å•çš„æœåŠ¡å±‚+ä»“åº“å±‚ï¼Œç”šè‡³ä¼ ç»Ÿçš„æ§åˆ¶å™¨+æ¨¡å‹å°±è¶³å¤Ÿäº†ã€‚</li>
</ul>
<p>å…³é”®åœ¨äº<strong>æˆ˜ç•¥æ€§åœ°åº”ç”¨DDD</strong>ï¼šåœ¨åº”ç”¨çš„æ ¸å¿ƒã€æœ€å¤æ‚çš„éƒ¨åˆ†é‡‡ç”¨DDDæ€æƒ³ï¼Œè€Œåœ¨éæ ¸å¿ƒã€ç®€å•çš„éƒ¨åˆ†ä¿æŒåŠ¡å®å’Œç®€æ´ã€‚</p>
<hr/>
<h6 data-id="heading-15">2.4 æ¨¡å—åŒ–ä¸åŒ…å¼€å‘</h6>
<p>å½“åº”ç”¨å˜å¾—åºå¤§æ—¶ï¼Œå³ä½¿æœ‰äº†åˆ†å±‚æ¶æ„ï¼Œ<code>app/Services</code>, <code>app/Repositories</code>ç­‰ç›®å½•ä¹Ÿä¼šå˜å¾—éš¾ä»¥ç®¡ç†ã€‚æ¨¡å—åŒ–æ˜¯å°†å¤§å‹åº”ç”¨æ‹†åˆ†ä¸ºæ›´å°ã€å†…èšã€è‡ªæ²»çš„ä¸šåŠ¡åŠŸèƒ½å•å…ƒçš„è¿‡ç¨‹ã€‚</p>
<p><strong>1. æŒ‰é¢†åŸŸåˆ’åˆ†ç›®å½•ç»“æ„</strong></p>
<p>æœ€ç®€å•çš„æ¨¡å—åŒ–æ–¹å¼æ˜¯æ”¹å˜ä½ çš„ç›®å½•ç»“æ„ï¼Œä»æŒ‰æŠ€æœ¯åˆ†å±‚ï¼ˆ<code>Controllers</code>, <code>Models</code>ï¼‰è½¬ä¸ºæŒ‰ä¸šåŠ¡é¢†åŸŸåˆ†å±‚ã€‚</p>
<ul>
<li>
<p><strong>ä¼ ç»Ÿç»“æ„</strong>:</p>
<pre><code class="hljs language-markdown" lang="markdown">app/
â”œâ”€â”€ Http/Controllers/
â”‚   â”œâ”€â”€ UserController.php
â”‚   â””â”€â”€ ProductController.php
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ User.php
â”‚   â””â”€â”€ Product.php
â””â”€â”€ Services/
<span class="hljs-code">    â”œâ”€â”€ UserService.php
    â””â”€â”€ ProductService.php
</span></code></pre>
</li>
<li>
<p><strong>æ¨¡å—åŒ–ç»“æ„</strong>:</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">src</span>/
â”œâ”€â”€ User/
â”‚   â”œâ”€â”€ Application/UserService<span class="hljs-selector-class">.php</span>
â”‚   â”œâ”€â”€ Domain/User<span class="hljs-selector-class">.php</span>
â”‚   â”œâ”€â”€ Infrastructure/EloquentUserRepository<span class="hljs-selector-class">.php</span>
â”‚   â””â”€â”€ Presentation/UserController<span class="hljs-selector-class">.php</span>
â””â”€â”€ Product/
    â”œâ”€â”€ Application/ProductService<span class="hljs-selector-class">.php</span>
    â”œâ”€â”€ Domain/Product<span class="hljs-selector-class">.php</span>
    â”œâ”€â”€ Infrastructure/EloquentProductRepository<span class="hljs-selector-class">.php</span>
    â””â”€â”€ Presentation/ProductController<span class="hljs-selector-class">.php</span>
</code></pre>
<p>ï¼ˆè¿™é‡Œçš„<code>Application</code>, <code>Domain</code>, <code>Infrastructure</code>, <code>Presentation</code>æ˜¯DDDåˆ†å±‚å‘½åæ³•ï¼Œå¯ä»¥ç®€åŒ–ä¸º<code>Services</code>, <code>Models</code>, <code>Repositories</code>, <code>Controllers</code>ï¼‰</p>
</li>
</ul>
<p>è¿™ç§ç»“æ„ä½¿å¾—ä¸ç‰¹å®šä¸šåŠ¡ï¼ˆå¦‚<code>User</code>ï¼‰ç›¸å…³çš„æ‰€æœ‰ä»£ç éƒ½é›†ä¸­åœ¨ä¸€èµ·ï¼Œæå¤§åœ°æé«˜äº†ä»£ç å†…èšæ€§å’Œå¯å‘ç°æ€§ã€‚</p>
<p><strong>2. æå–ä¸ºComposeråŒ…</strong></p>
<p>å½“ä¸€ä¸ªæ¨¡å—è¶³å¤Ÿç¨³å®šå’Œç‹¬ç«‹æ—¶ï¼Œå¯ä»¥å°†å…¶æå–ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ComposeråŒ…ã€‚è¿™å¯¹äºè¢«å¤šä¸ªé¡¹ç›®å¤ç”¨çš„æ ¸å¿ƒä¸šåŠ¡ï¼ˆå¦‚è®¤è¯ã€æ”¯ä»˜ï¼‰æˆ–å¤§å‹å›¢é˜Ÿåˆ†å·¥åä½œå°¤å…¶æœ‰ä»·å€¼ã€‚</p>
<p><strong>åŒ…å¼€å‘çš„å¥½å¤„</strong>:</p>
<ul>
<li><strong>å¼ºåˆ¶è§£è€¦</strong>: åŒ…åªèƒ½é€šè¿‡å…¶<code>ServiceProvider</code>å’Œæ˜ç¡®å®šä¹‰çš„å…¬å…±æ¥å£ä¸ä¸»åº”ç”¨äº¤äº’ï¼Œå®ç°äº†å¼ºå°è£…ã€‚</li>
<li><strong>ç‹¬ç«‹ç‰ˆæœ¬æ§åˆ¶</strong>: ä½ å¯ä»¥ç‹¬ç«‹åœ°å¯¹æ”¯ä»˜æ¨¡å—è¿›è¡Œç‰ˆæœ¬è¿­ä»£ï¼Œè€Œæ— éœ€é‡æ–°éƒ¨ç½²æ•´ä¸ªä¸»åº”ç”¨ã€‚</li>
<li><strong>ç‹¬ç«‹æµ‹è¯•</strong>: æ¯ä¸ªåŒ…éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„æµ‹è¯•å¥—ä»¶ï¼Œå¯ä»¥æ›´å¿«åœ°è¿è¡Œã€‚</li>
<li><strong>ä»£ç å¤ç”¨</strong>: åŒä¸€ä¸ªæ”¯ä»˜åŒ…å¯ä»¥è¢«å…¬å¸çš„å¤šä¸ªé¡¹ç›®ä½¿ç”¨ã€‚</li>
</ul>
<p><strong>Laravel/SymfonyåŒ…å¼€å‘æµç¨‹æ¦‚è§ˆ</strong>:</p>
<ol>
<li><strong>åˆ›å»ºç›®å½•</strong>: åœ¨é¡¹ç›®æ ¹ç›®å½•å¤–åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…ç›®å½•ï¼Œå¦‚<code>packages/payment-gateway</code>ã€‚</li>
<li><strong><code>composer.json</code></strong>: åœ¨åŒ…ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª<code>composer.json</code>æ–‡ä»¶ï¼Œå®šä¹‰åŒ…åã€ä¾èµ–ã€PSR-4è‡ªåŠ¨åŠ è½½ç­‰ã€‚</li>
<li><strong>æœåŠ¡æä¾›è€… (Service Provider)</strong>: è¿™æ˜¯åŒ…çš„å…¥å£ã€‚åœ¨Laravelä¸­ï¼Œä½ ä¼šåˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª<code>Illuminate\Support\ServiceProvider</code>çš„ç±»ã€‚
<ul>
<li>åœ¨<code>register()</code>æ–¹æ³•ä¸­ï¼Œä½¿ç”¨<code>$this-&gt;app-&gt;bind()</code>æ¥ç»‘å®šåŒ…æä¾›çš„æœåŠ¡ã€‚</li>
<li>åœ¨<code>boot()</code>æ–¹æ³•ä¸­ï¼Œæ³¨å†Œè·¯ç”±ã€è§†å›¾ã€é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿ç§»ç­‰ã€‚</li>
</ul>
</li>
<li><strong>æœ¬åœ°å¼€å‘</strong>: åœ¨ä¸»åº”ç”¨çš„<code>composer.json</code>ä¸­ï¼Œä½¿ç”¨<code>"type": "path"</code>çš„<code>repositories</code>é…ç½®æ¥é“¾æ¥åˆ°æœ¬åœ°çš„åŒ…ç›®å½•ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨æœ¬åœ°å®æ—¶å¼€å‘å’Œæµ‹è¯•åŒ…ï¼Œè€Œæ— éœ€å‘å¸ƒã€‚</li>
<li><strong>å‘å¸ƒ</strong>: å¼€å‘å®Œæˆåï¼Œä½ å¯ä»¥å°†å…¶å‘å¸ƒåˆ°Packagistï¼ˆå…¬å…±ï¼‰æˆ–Satis/Private Packagistï¼ˆç§æœ‰ï¼‰ä¾›é¡¹ç›®<code>require</code>ã€‚</li>
</ol>
<p>é€šè¿‡æ¨¡å—åŒ–å’ŒåŒ…å¼€å‘ï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªåºå¤§ã€éš¾ä»¥ç»´æŠ¤çš„å•ä½“åº”ç”¨ï¼Œæ¼”è¿›ä¸ºä¸€ä¸ªç”±å¤šä¸ªå†…èšã€è§£è€¦ã€å¯ç‹¬ç«‹ç»´æŠ¤çš„æ¨¡å—ç»„æˆçš„â€œæ¨¡å—åŒ–å•ä½“â€æˆ–å¾®æœåŠ¡æ¶æ„ï¼Œä»è€Œä»å®¹åº”å¯¹ä¸šåŠ¡çš„å¢é•¿å’Œå˜åŒ–ã€‚</p>
<hr/>
<hr/>
<h4 data-id="heading-16">ç¬¬ä¸‰éƒ¨åˆ†ï¼šä¸“é¢˜æ·±æ½œ (Topical Deep Dives)</h4>
<h5 data-id="heading-17">ç¬¬3ç« ï¼šæ¡†æ¶é«˜çº§åº”ç”¨ä¸åŸç† (ä»¥Laravelä¸ºä¾‹)</h5>
<p>ä»…ä»…ä¼šä½¿ç”¨æ¡†æ¶æä¾›çš„åŠŸèƒ½æ˜¯ä¸å¤Ÿçš„ï¼Œæ·±å…¥ç†è§£å…¶æ ¸å¿ƒå·¥ä½œåŸç†ï¼Œå¹¶å­¦ä¼šå¦‚ä½•æ‰©å±•å®ƒï¼Œæ˜¯åŒºåˆ†ä¸­é«˜çº§å·¥ç¨‹å¸ˆçš„å…³é”®ã€‚æœ¬ç« ä»¥Laravelä¸ºä¾‹ï¼Œæ¢è®¨å…¶æœ€æ ¸å¿ƒçš„ç»„ä»¶â€”â€”æœåŠ¡å®¹å™¨ã€‚</p>
<h6 data-id="heading-18">3.1 æ·±å…¥æœåŠ¡å®¹å™¨ (Service Container)</h6>
<p>æœåŠ¡å®¹å™¨ï¼ˆä¹Ÿç§°IoCå®¹å™¨ï¼‰æ˜¯Laravelæ¡†æ¶çš„å¿ƒè„ã€‚å®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºç®¡ç†ç±»çš„ä¾èµ–å…³ç³»å’Œæ‰§è¡Œä¾èµ–æ³¨å…¥ã€‚ä½ ä¹‹å‰åœ¨åˆ†å±‚æ¶æ„ä¸­é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥<code>PostRepository</code>ï¼Œå…¶èƒŒåå°±æ˜¯æœåŠ¡å®¹å™¨åœ¨å·¥ä½œã€‚</p>
<p><strong>1. æ ¸å¿ƒæ¦‚å¿µï¼šç»‘å®š (Binding) ä¸è§£æ (Resolution)</strong></p>
<ul>
<li>
<p><strong>ç»‘å®š</strong>: å°±æ˜¯â€œå‘Šè¯‰â€å®¹å™¨å¦‚ä½•åˆ›å»ºæŸä¸ªç±»çš„å®ä¾‹ã€‚è¿™é€šå¸¸åœ¨<code>ServiceProvider</code>çš„<code>register</code>æ–¹æ³•ä¸­å®Œæˆã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// App/Providers/RepositoryServiceProvider.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Repository</span>\<span class="hljs-title">PostRepository</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Repository</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">PostRepositoryImpl</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
</span>{
    <span class="hljs-comment">// ç»‘å®šæ¥å£åˆ°å…·ä½“å®ç°</span>
    <span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">bind</span>(<span class="hljs-title class_">PostRepository</span>::<span class="hljs-variable language_">class</span>, <span class="hljs-title class_">PostRepositoryImpl</span>::<span class="hljs-variable language_">class</span>);
}
</code></pre>
<p>ç°åœ¨ï¼Œå®¹å™¨çŸ¥é“äº†å½“ä»»ä½•åœ°æ–¹éœ€è¦ä¸€ä¸ª<code>PostRepository</code>æ—¶ï¼Œå®ƒåº”è¯¥å»å®ä¾‹åŒ–ä¸€ä¸ª<code>PostRepositoryImpl</code>ã€‚</p>
</li>
<li>
<p><strong>è§£æ</strong>: å°±æ˜¯ä»å®¹å™¨ä¸­â€œè·å–â€ä¸€ä¸ªå®ä¾‹ã€‚è¿™å¯ä»¥æ‰‹åŠ¨å®Œæˆï¼Œä½†æ›´å¸¸è§çš„æ˜¯è‡ªåŠ¨å‘ç”Ÿã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// æ‰‹åŠ¨è§£æ</span>
<span class="hljs-variable">$repository</span> = <span class="hljs-title function_ invoke__">app</span>(<span class="hljs-title class_">PostRepository</span>::<span class="hljs-variable language_">class</span>);

<span class="hljs-comment">// è‡ªåŠ¨è§£æï¼ˆä¾èµ–æ³¨å…¥ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">PostRepository <span class="hljs-variable">$repository</span></span>) // å®¹å™¨è‡ªåŠ¨è§£æå¹¶æ³¨å…¥
</span>{
    <span class="hljs-variable language_">$this</span>-&gt;repository = <span class="hljs-variable">$repository</span>;
}
</code></pre>
<p>å½“å®¹å™¨å®ä¾‹åŒ–ä¸€ä¸ªç±»æ—¶ï¼Œå®ƒä¼šé€šè¿‡åå°„æ£€æŸ¥å…¶æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œå¹¶è‡ªåŠ¨è§£æè¿™äº›ç±»å‹æç¤ºçš„ä¾èµ–é¡¹ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯é€’å½’çš„ï¼Œå¦‚æœ<code>PostRepositoryImpl</code>æœ¬èº«ä¹Ÿæœ‰ä¾èµ–ï¼Œå®¹å™¨ä¼šä¸€å¹¶è§£æã€‚</p>
</li>
</ul>
<p><strong>2. ç»‘å®šçš„ç”Ÿå‘½å‘¨æœŸ</strong></p>
<ul>
<li>
<p><strong><code>bind()</code> (ç¬æ—¶ç»‘å®š)</strong>: è¿™æ˜¯é»˜è®¤çš„ç»‘å®šæ–¹å¼ã€‚<strong>æ¯æ¬¡</strong>ä»å®¹å™¨ä¸­è§£ææ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ª<strong>æ–°çš„</strong>å®ä¾‹ã€‚é€‚ç”¨äºæ— çŠ¶æ€ã€è½»é‡çº§çš„å¯¹è±¡ã€‚</p>
</li>
<li>
<p><strong><code>singleton()</code> (å•ä¾‹ç»‘å®š)</strong>: <strong>ç¬¬ä¸€æ¬¡</strong>ä»å®¹å™¨ä¸­è§£ææ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œè¯¥å®ä¾‹ä¼šè¢«ç¼“å­˜èµ·æ¥ã€‚ä¹‹å<strong>æ‰€æœ‰</strong>å¯¹è¯¥ç»‘å®šçš„è§£æè¯·æ±‚ï¼Œéƒ½ä¼šè¿”å›<strong>åŒä¸€ä¸ª</strong>ç¼“å­˜çš„å®ä¾‹ã€‚</p>
<p><strong>å®æˆ˜åº”ç”¨</strong>:</p>
<ul>
<li>æ•°æ®åº“è¿æ¥ã€Rediså®¢æˆ·ç«¯ç­‰æ˜‚è´µçš„è¿æ¥å¯¹è±¡ã€‚</li>
<li>åŠ è½½äº†å¤§é‡é…ç½®çš„å…¨å±€æœåŠ¡ã€‚</li>
<li>éœ€è¦è·¨è¯·æ±‚/ä½œä¸šå…±äº«çŠ¶æ€çš„å¯¹è±¡ï¼ˆéœ€è°¨æ…ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ç»‘å®šä¸€ä¸ªå¤æ‚çš„æ”¯ä»˜ç½‘å…³å®¢æˆ·ç«¯ä¸ºå•ä¾‹</span>
<span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">singleton</span>(<span class="hljs-title class_">PaymentGatewayClient</span>::<span class="hljs-variable language_">class</span>, function (<span class="hljs-variable">$app</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PaymentGatewayClient</span>(<span class="hljs-title function_ invoke__">config</span>(<span class="hljs-string">'services.payment.secret'</span>));
});
</code></pre>
</li>
<li>
<p><strong><code>scoped()</code> (ä½œç”¨åŸŸå•ä¾‹ - Laravel 11+)</strong>: å®ä¾‹åœ¨å½“å‰â€œä½œç”¨åŸŸâ€ï¼ˆå¦‚ä¸€ä¸ªWebè¯·æ±‚ã€ä¸€ä¸ªé˜Ÿåˆ—Jobï¼‰å†…æ˜¯å•ä¾‹ï¼Œä½†æ–°çš„ä½œç”¨åŸŸä¼šåˆ›å»ºæ–°çš„å®ä¾‹ã€‚è¿™æ˜¯å¯¹<code>singleton</code>åœ¨é•¿ç”Ÿå‘½å‘¨æœŸåº”ç”¨ï¼ˆå¦‚Octaneï¼‰ä¸­çš„æ”¹è¿›ã€‚</p>
</li>
</ul>
<p><strong>3. é«˜çº§ç»‘å®šæŠ€å·§</strong></p>
<ul>
<li>
<p><strong>ä¸Šä¸‹æ–‡ç»‘å®š (Contextual Binding)</strong>: æœ‰æ—¶ï¼Œä¸¤ä¸ªä¸åŒçš„ç±»å¯èƒ½éœ€è¦åŒä¸€ä¸ªæ¥å£çš„ä¸åŒå®ç°ã€‚ä¸Šä¸‹æ–‡ç»‘å®šå…è®¸ä½ ä¸ºæ­¤è¿›è¡Œé…ç½®ã€‚</p>
<p><strong>å®æˆ˜åº”ç”¨</strong>: å‡è®¾<code>VideoController</code>ä¸Šä¼ è§†é¢‘åˆ°S3ï¼Œè€Œ<code>ReportController</code>ç”ŸæˆæŠ¥å‘Šåˆ°æœ¬åœ°ç£ç›˜ã€‚å®ƒä»¬éƒ½ä¾èµ–<code>Illuminate\Contracts\Filesystem\Factory</code>ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// App/Providers/AppServiceProvider.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Contracts</span>\<span class="hljs-title">Filesystem</span>\<span class="hljs-title">Factory</span> <span class="hljs-keyword">as</span> <span class="hljs-title">FilesystemFactory</span>;

<span class="hljs-comment">// ...</span>
<span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">when</span>(<span class="hljs-title class_">VideoController</span>::<span class="hljs-variable language_">class</span>)
          -&gt;<span class="hljs-title function_ invoke__">needs</span>(<span class="hljs-title class_">FilesystemFactory</span>::<span class="hljs-variable language_">class</span>)
          -&gt;<span class="hljs-title function_ invoke__">give</span>(fn () =&gt; <span class="hljs-title class_">Storage</span>::<span class="hljs-title function_ invoke__">disk</span>(<span class="hljs-string">'s3'</span>));

<span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">when</span>(<span class="hljs-title class_">ReportController</span>::<span class="hljs-variable language_">class</span>)
          -&gt;<span class="hljs-title function_ invoke__">needs</span>(<span class="hljs-title class_">FilesystemFactory</span>::<span class="hljs-variable language_">class</span>)
          -&gt;<span class="hljs-title function_ invoke__">give</span>(fn () =&gt; <span class="hljs-title class_">Storage</span>::<span class="hljs-title function_ invoke__">disk</span>(<span class="hljs-string">'local'</span>));
</code></pre>
</li>
<li>
<p><strong>æ ‡ç­¾ (Tagging)</strong>: ä½ å¯ä»¥ç»™ä¸€ç»„ç›¸å…³çš„ç»‘å®šæ‰“ä¸ŠåŒä¸€ä¸ªâ€œæ ‡ç­¾â€ï¼Œç„¶åä¸€æ¬¡æ€§è§£æå‡ºæ‰€æœ‰è¢«æ ‡è®°çš„å®ä¾‹ã€‚</p>
<p><strong>å®æˆ˜åº”ç”¨</strong>: å‡è®¾ä½ æœ‰ä¸€ä¸ªæŠ¥è¡¨ç”Ÿæˆç³»ç»Ÿï¼Œæ”¯æŒå¤šç§å¯¼å‡ºæ ¼å¼ï¼ˆPDF, CSV, Excelï¼‰ï¼Œæ¯ç§æ ¼å¼éƒ½æ˜¯ä¸€ä¸ªå®ç°äº†<code>Exporter</code>æ¥å£çš„ç±»ã€‚</p>
<ul>
<li>
<p><strong>ç»‘å®šä¸æ‰“æ ‡ç­¾</strong>:</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">bind</span>(<span class="hljs-title class_">PdfExporter</span>::<span class="hljs-variable language_">class</span>);
<span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">bind</span>(<span class="hljs-title class_">CsvExporter</span>::<span class="hljs-variable language_">class</span>);

<span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">tag</span>([<span class="hljs-title class_">PdfExporter</span>::<span class="hljs-variable language_">class</span>, <span class="hljs-title class_">CsvExporter</span>::<span class="hljs-variable language_">class</span>], <span class="hljs-string">'exporters'</span>);
</code></pre>
</li>
<li>
<p><strong>è§£ææ‰€æœ‰å¸¦æ ‡ç­¾çš„å®ä¾‹</strong>:</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// åœ¨ä½ çš„æŠ¥è¡¨æœåŠ¡ä¸­</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">iterable</span> <span class="hljs-variable">$exporters</span></span>)
</span>{
    <span class="hljs-comment">// Laravel 11+ å¯ä»¥ç›´æ¥æ³¨å…¥</span>
    <span class="hljs-comment">// $this-&gt;exporters = app()-&gt;tagged('exporters'); åœ¨æ—§ç‰ˆæœ¬ä¸­</span>
}

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">export</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$format</span>, Report <span class="hljs-variable">$report</span></span>)
</span>{
    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;exporters <span class="hljs-keyword">as</span> <span class="hljs-variable">$exporter</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$exporter</span>-&gt;<span class="hljs-title function_ invoke__">supports</span>(<span class="hljs-variable">$format</span>)) {
            <span class="hljs-keyword">return</span> <span class="hljs-variable">$exporter</span>-&gt;<span class="hljs-title function_ invoke__">export</span>(<span class="hljs-variable">$report</span>);
        }
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">'Unsupported format'</span>);
}
</code></pre>
</li>
</ul>
<p>è¿™ç§æ–¹å¼è®©ä½ å¯ä»¥åœ¨ä¸ä¿®æ”¹æ ¸å¿ƒæœåŠ¡ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ç®€å•åœ°æ·»åŠ æ–°çš„ç»‘å®šå’Œæ ‡ç­¾æ¥è½»æ¾æ‰©å±•ç³»ç»ŸåŠŸèƒ½ï¼ˆä¾‹å¦‚å¢åŠ <code>ExcelExporter</code>ï¼‰ï¼Œå®Œç¾ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</p>
</li>
</ul>
<p>æ·±å…¥ç†è§£å¹¶å–„ç”¨æœåŠ¡å®¹å™¨ï¼Œæ˜¯ç¼–å†™å‡ºçœŸæ­£çµæ´»ã€å¯æ‰©å±•ã€å¯æµ‹è¯•çš„Laravelåº”ç”¨çš„åŸºç¡€ã€‚</p>
<h6 data-id="heading-19">3.2 æ¡†æ¶çš„â€œé­”æ³•â€æ¢ç§˜</h6>
<p>Laravelä»¥å…¶ä¼˜é›…ã€å¯Œæœ‰è¡¨ç°åŠ›çš„è¯­æ³•è€Œé—»åï¼Œä½†è¿™èƒŒåçš„ä¸€äº›â€œé­”æ³•â€ä¹Ÿå¸¸è¢«è¯¯è§£æˆ–æ‰¹è¯„ã€‚ç†è§£è¿™äº›â€œé­”æ³•â€çš„åŸç†ï¼Œèƒ½è®©ä½ æ›´è‡ªä¿¡åœ°ä½¿ç”¨å®ƒä»¬ï¼Œå¹¶æ¶ˆé™¤å¯¹å…¶â€œä¸ç¡®å®šæ€§â€çš„ææƒ§ã€‚</p>
<p><strong>1. Facades çš„å·¥ä½œåŸç†</strong></p>
<p>å½“ä½ è°ƒç”¨<code>Cache::get('key')</code>æ—¶ï¼Œçœ‹èµ·æ¥åƒä¸€ä¸ªé™æ€æ–¹æ³•è°ƒç”¨ï¼Œä½†PHPä¸­å¹¶æ²¡æœ‰<code>Cache</code>ç±»çš„é™æ€<code>get</code>æ–¹æ³•ã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªâ€œå‡è±¡â€ï¼Œå³<strong>Facadeï¼ˆé—¨é¢ï¼‰</strong>ã€‚</p>
<p>Facadeä¸ºä¸€ä¸ªåœ¨æœåŠ¡å®¹å™¨ä¸­æ³¨å†Œçš„<strong>éé™æ€</strong>å¯¹è±¡æä¾›äº†ä¸€ä¸ª<strong>é™æ€</strong>çš„è°ƒç”¨æ¥å£ã€‚</p>
<ul>
<li>
<p><strong><code>getFacadeAccessor()</code></strong>: æ¯ä¸ªFacadeç±»ï¼ˆå¦‚<code>Illuminate\Support\Facades\Cache</code>ï¼‰éƒ½å¿…é¡»å®ç°<code>getFacadeAccessor()</code>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯<strong>è¿”å›è¯¥Facadeåœ¨æœåŠ¡å®¹å™¨ä¸­çš„ç»‘å®šåç§°</strong>ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// Illuminate\Support\Facades\Cache.php</span>
<span class="hljs-keyword">protected</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFacadeAccessor</span>(<span class="hljs-params"/>)
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'cache'</span>; <span class="hljs-comment">// è¿™æ˜¯'cache'æœåŠ¡åœ¨å®¹å™¨ä¸­çš„key</span>
}
</code></pre>
</li>
<li>
<p><strong><code>__callStatic()</code> é­”æœ¯æ–¹æ³•</strong>: å½“ä½ è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„é™æ€æ–¹æ³•ï¼ˆå¦‚<code>Cache::get()</code>ï¼‰æ—¶ï¼ŒPHPä¼šè°ƒç”¨<code>__callStatic()</code>é­”æœ¯æ–¹æ³•ã€‚Laravelçš„<code>Facade</code>åŸºç±»å®ç°äº†è¿™ä¸ªæ–¹æ³•ï¼Œå…¶å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>è°ƒç”¨<code>getFacadeAccessor()</code>è·å–æœåŠ¡åï¼ˆ<code>'cache'</code>ï¼‰ã€‚</li>
<li>ä½¿ç”¨<code>app('cache')</code>ä»æœåŠ¡å®¹å™¨ä¸­<strong>è§£æ</strong>å‡ºå®é™…çš„<code>CacheManager</code>å®ä¾‹ã€‚</li>
<li>å°†æ–¹æ³•è°ƒç”¨è½¬å‘ç»™è¿™ä¸ªè§£æå‡ºæ¥çš„å®ä¾‹ï¼Œå³<code>$cacheManager-&gt;get('key')</code>ã€‚</li>
</ol>
</li>
</ul>
<p>æ‰€ä»¥ï¼Œ<code>Cache::get('key')</code>æœ¬è´¨ä¸Šæ˜¯<code>app('cache')-&gt;get('key')</code>çš„è¯­æ³•ç³–ã€‚</p>
<ul>
<li>
<p><strong>æµ‹è¯•Facades</strong>: Facadesæœ€å¤§çš„äº‰è®®åœ¨äºæµ‹è¯•ã€‚æ‰¹è¯„è€…è®¤ä¸ºå®ƒéšè—äº†ä¾èµ–ã€‚ä½†Laravelæä¾›äº†éå¸¸ç®€å•çš„æµ‹è¯•æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ ç”¨ä¸€ä¸ªMockå¯¹è±¡æ›¿æ¢æ‰å®¹å™¨ä¸­çš„å®é™…å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Support</span>\<span class="hljs-title">Facades</span>\<span class="hljs-title">Cache</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test_it_can_get_data_from_cache</span>(<span class="hljs-params"/>)
</span>{
    <span class="hljs-comment">// å‘Šè¯‰æ¡†æ¶ï¼Œæˆ‘ä»¬æœŸæœ›'Cache' Facadeçš„'get'æ–¹æ³•è¢«è°ƒç”¨ä¸€æ¬¡</span>
    <span class="hljs-comment">// å¹¶ä¸”å½“ä»¥'user:1'ä¸ºå‚æ•°è°ƒç”¨æ—¶ï¼Œåº”è¿”å›ä¸€ä¸ªUserå®ä¾‹</span>
    <span class="hljs-title class_">Cache</span>::<span class="hljs-title function_ invoke__">shouldReceive</span>(<span class="hljs-string">'get'</span>)
         -&gt;<span class="hljs-title function_ invoke__">once</span>()
         -&gt;<span class="hljs-title function_ invoke__">with</span>(<span class="hljs-string">'user:1'</span>)
         -&gt;<span class="hljs-title function_ invoke__">andReturn</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>([<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'Taylor'</span>]));

    <span class="hljs-comment">// æ‰§è¡Œä½ çš„ä¸šåŠ¡ä»£ç ï¼Œå®ƒå†…éƒ¨ä¼šè°ƒç”¨ Cache::get('user:1')</span>
    <span class="hljs-variable">$user</span> = <span class="hljs-variable language_">$this</span>-&gt;userService-&gt;<span class="hljs-title function_ invoke__">getCachedUser</span>(<span class="hljs-number">1</span>);

    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">assertEquals</span>(<span class="hljs-string">'Taylor'</span>, <span class="hljs-variable">$user</span>-&gt;name);
}
</code></pre>
<p><code>shouldReceive</code>æ–¹æ³•ä¼šç”¨ä¸€ä¸ªMockery mockå¯¹è±¡æ›¿æ¢å®¹å™¨ä¸­çš„<code>cache</code>å®ä¾‹ï¼Œä½¿å¾—æµ‹è¯•å®Œå…¨éš”ç¦»ï¼Œé€Ÿåº¦é£å¿«ã€‚</p>
</li>
</ul>
<p><strong>2. Macros å’Œ Mixinsï¼šåŠ¨æ€æ‰©å±•æ¡†æ¶æ ¸å¿ƒåŠŸèƒ½</strong></p>
<p>Laravelä¸­è®¸å¤šæ ¸å¿ƒç±»ï¼ˆå¦‚<code>Str</code>, <code>Arr</code>, <code>Response</code>, <code>Request</code>ï¼‰éƒ½ä½¿ç”¨äº†<code>Macroable</code> Traitã€‚è¿™ä¸ªTraitå…è®¸ä½ åœ¨è¿è¡Œæ—¶å‘è¿™äº›ç±»åŠ¨æ€åœ°æ·»åŠ æ–°çš„æ–¹æ³•ã€‚</p>
<ul>
<li>
<p><strong>Macro</strong>: æ·»åŠ å•ä¸ªæ–¹æ³•ã€‚</p>
<p><strong>å®æˆ˜åº”ç”¨</strong>: å‡è®¾ä½ å¸Œæœ›åœ¨æ•´ä¸ªåº”ç”¨ä¸­ç»Ÿä¸€APIæˆåŠŸå“åº”çš„æ ¼å¼ã€‚ä½ å¯ä»¥åœ¨<code>AppServiceProvider</code>çš„<code>boot</code>æ–¹æ³•ä¸­ä¸º<code>Response</code>ç±»æ³¨å†Œä¸€ä¸ª<code>apiSuccess</code>å®ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// App/Providers/AppServiceProvider.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Support</span>\<span class="hljs-title">Facades</span>\<span class="hljs-title">Response</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boot</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
</span>{
    <span class="hljs-title class_">Response</span>::<span class="hljs-title function_ invoke__">macro</span>(<span class="hljs-string">'apiSuccess'</span>, function (<span class="hljs-variable">$data</span> = <span class="hljs-literal">null</span>, <span class="hljs-variable">$message</span> = <span class="hljs-string">'success'</span>, <span class="hljs-variable">$statusCode</span> = <span class="hljs-number">200</span>) {
        <span class="hljs-variable">$response</span> = [
            <span class="hljs-string">'message'</span> =&gt; <span class="hljs-variable">$message</span>,
            <span class="hljs-string">'data'</span> =&gt; <span class="hljs-variable">$data</span>,
        ];
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Response</span>::<span class="hljs-title function_ invoke__">json</span>(<span class="hljs-variable">$response</span>, <span class="hljs-variable">$statusCode</span>);
    });
}
</code></pre>
<p>ç°åœ¨ï¼Œåœ¨ä½ çš„ä»»ä½•æ§åˆ¶å™¨ä¸­ï¼Œéƒ½å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š
<code>return response()-&gt;apiSuccess(['user' =&gt; $user]);</code></p>
</li>
<li>
<p><strong>Mixin</strong>: ä¸€æ¬¡æ€§æ·»åŠ ä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰å…¬å…±æ–¹æ³•ä½œä¸ºå®ã€‚</p>
<p><strong>å®æˆ˜åº”ç”¨</strong>: ä¸º<code>Str</code>ç±»æ·»åŠ ä¸€ç»„è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// App/Support/StrMixins.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StrMixins</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initials</span>(<span class="hljs-params"/>): <span class="hljs-title">Closure</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span></span>): <span class="hljs-title">string</span> </span>{
            <span class="hljs-comment">// å®ç°è·å–å§“åé¦–å­—æ¯ç¼©å†™çš„é€»è¾‘</span>
            <span class="hljs-comment">// ...</span>
        };
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isUuid</span>(<span class="hljs-params"/>): <span class="hljs-title">Closure</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> (<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$string</span></span>): <span class="hljs-title">bool</span> =&gt;</span> <span class="hljs-title class_">Str</span>::<span class="hljs-title function_ invoke__">isUuid</span>(<span class="hljs-variable">$string</span>);
    }
}

<span class="hljs-comment">// App/Providers/AppServiceProvider.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Support</span>\<span class="hljs-title">Str</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boot</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
</span>{
    <span class="hljs-title class_">Str</span>::<span class="hljs-title function_ invoke__">mixin</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">\App\Support\StrMixins</span>());
}
</code></pre>
<p>ç°åœ¨ä½ å¯ä»¥ç›´æ¥è°ƒç”¨<code>Str::initials('Taylor Otwell')</code>ã€‚</p>
</li>
</ul>
<p><strong>3. Pipeline æ¨¡å¼åœ¨ä¸­é—´ä»¶ä¸­çš„åº”ç”¨</strong></p>
<p>Laravelçš„ä¸­é—´ä»¶æ˜¯<strong>ç®¡é“æ¨¡å¼ï¼ˆPipeline Patternï¼‰</strong> çš„ä¸€ä¸ªå®Œç¾å®ç°ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªæ´‹è‘±ï¼ŒHTTPè¯·æ±‚æ˜¯æ ¸å¿ƒï¼Œå®ƒå¿…é¡»ç©¿è¿‡ä¸€å±‚å±‚çš„æ´‹è‘±çš®ï¼ˆä¸­é—´ä»¶ï¼‰æ‰èƒ½åˆ°è¾¾æ ¸å¿ƒï¼ˆæ§åˆ¶å™¨ï¼‰ï¼Œç„¶åå“åº”åˆä»æ ¸å¿ƒç©¿å‡ºæ‰€æœ‰æ´‹è‘±çš®è¿”å›ç»™ç”¨æˆ·ã€‚</p>
<ul>
<li>
<p><strong><code>handle(Request $request, Closure $next)</code></strong>: æ¯ä¸ªä¸­é—´ä»¶çš„æ ¸å¿ƒæ˜¯<code>handle</code>æ–¹æ³•ã€‚<code>$request</code>æ˜¯è¯·æ±‚å¯¹è±¡ï¼Œè€Œ<code>$next</code>æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œä»£è¡¨<strong>ç®¡é“ä¸­çš„ä¸‹ä¸€ä¸ªç¯èŠ‚</strong>ã€‚</p>
</li>
<li>
<p><strong>æ´‹è‘±æ¨¡å‹</strong>:
è°ƒç”¨<code>$response = $next($request);</code>å°±æ˜¯å°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€å±‚ä¸­é—´ä»¶ã€‚è¿™è¡Œä»£ç æ˜¯è¯·æ±‚æµå‘å’Œå“åº”æµå‘çš„åˆ†ç•Œç‚¹ã€‚</p>
<ul>
<li><strong>åœ¨è¿™è¡Œä»£ç ä¹‹å‰</strong>æ‰§è¡Œçš„é€»è¾‘ï¼Œæ˜¯åœ¨â€œè¯·æ±‚è¿›å…¥æ—¶â€æ‰§è¡Œã€‚</li>
<li><strong>åœ¨è¿™è¡Œä»£ç ä¹‹å</strong>æ‰§è¡Œçš„é€»è¾‘ï¼Œæ˜¯åœ¨â€œå“åº”è¿”å›æ—¶â€æ‰§è¡Œã€‚</li>
</ul>
</li>
</ul>
<p><strong>å®æˆ˜åº”ç”¨ï¼šä¸€ä¸ªè®°å½•è¯·æ±‚è€—æ—¶çš„ä¸­é—´ä»¶</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// App/Http/Middleware/RequestDurationLogMiddleware.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDurationLogMiddleware</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> LoggerInterface <span class="hljs-variable">$logger</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, <span class="hljs-built_in">Closure</span> <span class="hljs-variable">$next</span></span>): <span class="hljs-title">Response</span>
    </span>{
        <span class="hljs-variable">$start</span> = <span class="hljs-title function_ invoke__">microtime</span>(<span class="hljs-literal">true</span>);

        <span class="hljs-comment">// 1. è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–æ§åˆ¶å™¨</span>
        <span class="hljs-variable">$response</span> = <span class="hljs-variable">$next</span>(<span class="hljs-variable">$request</span>);

        <span class="hljs-comment">// 2. è·å¾—å“åº”åï¼Œæ‰§è¡Œè¿™é‡Œçš„é€»è¾‘</span>
        <span class="hljs-variable">$duration</span> = (<span class="hljs-title function_ invoke__">microtime</span>(<span class="hljs-literal">true</span>) - <span class="hljs-variable">$start</span>) * <span class="hljs-number">1000</span>;

        <span class="hljs-variable language_">$this</span>-&gt;logger-&gt;<span class="hljs-title function_ invoke__">info</span>(<span class="hljs-title function_ invoke__">sprintf</span>(
            <span class="hljs-string">'[%s] %s | %dms'</span>,
            <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">method</span>(),
            <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">path</span>(),
            <span class="hljs-variable">$duration</span>
        ));

        <span class="hljs-keyword">return</span> <span class="hljs-variable">$response</span>;
    }
}
</code></pre>
<p>è¿™ä¸ªä¸­é—´ä»¶æ¸…æ™°åœ°å±•ç¤ºäº†â€œæ´‹è‘±â€æ¨¡å‹ï¼šåœ¨è¯·æ±‚è¿›å…¥æ—¶è®°å½•èµ·å§‹æ—¶é—´ï¼Œåœ¨æ‰€æœ‰å†…éƒ¨é€»è¾‘ï¼ˆåŒ…æ‹¬æ§åˆ¶å™¨ï¼‰æ‰§è¡Œå®Œæ¯•ã€å“åº”ç”Ÿæˆä¹‹åï¼Œè®¡ç®—æ€»è€—æ—¶å¹¶è®°å½•æ—¥å¿—ã€‚</p>
<hr/>
<hr/>
<h5 data-id="heading-20">ç¬¬4ç« ï¼šé«˜æ€§èƒ½APIè®¾è®¡ä¸å®ç°</h5>
<h6 data-id="heading-21">4.1 API è®¾è®¡å“²å­¦</h6>
<p>æ„å»ºAPIä¸ä»…ä»…æ˜¯è®©æ•°æ®èƒ½é€šè¿‡HTTPè®¿é—®ã€‚ä¸€ä¸ªä¼˜ç§€çš„APIåº”è¯¥å…·å¤‡è‰¯å¥½çš„å¼€å‘è€…ä½“éªŒï¼šå¯é¢„æµ‹ã€æ˜“äºç†è§£ã€æ–‡æ¡£æ¸…æ™°ã€‚</p>
<p><strong>1. è¶…è¶ŠRESTï¼šGraphQL ä¸ gRPC</strong></p>
<p>è™½ç„¶RESTæ˜¯Web APIçš„äº‹å®æ ‡å‡†ï¼Œä½†åœ¨ç‰¹å®šåœºæ™¯ä¸‹ï¼Œå…¶ä»–æ¨¡å¼å¯èƒ½æ›´ä¼˜è¶Šã€‚</p>
<ul>
<li>
<p><strong>GraphQL</strong>: ä¸€ç§ä¸ºAPIè€Œç”Ÿçš„æŸ¥è¯¢è¯­è¨€ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>: å®¢æˆ·ç«¯ç²¾ç¡®åœ°è¯·æ±‚å®ƒæ‰€éœ€è¦çš„æ•°æ®ï¼Œä¸å¤šä¹Ÿä¸å°‘ã€‚è§£å†³äº†RESTä¸­å¸¸è§çš„â€œè¿‡åº¦è·å–â€ï¼ˆOver-fetchingï¼‰å’Œâ€œè·å–ä¸è¶³â€ï¼ˆUnder-fetchingï¼‰é—®é¢˜ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>:
<ul>
<li><strong>å¤æ‚å‰ç«¯/ç§»åŠ¨ç«¯</strong>: å½“ä¸€ä¸ªé¡µé¢éœ€è¦æ¥è‡ªå¤šä¸ªã€ç›¸äº’å…³è”çš„èµ„æºçš„æ•°æ®æ—¶ï¼ŒGraphQLå¯ä»¥é€šè¿‡ä¸€æ¬¡è¯·æ±‚è·å–æ‰€æœ‰æ•°æ®ï¼Œè€ŒRESTå¯èƒ½éœ€è¦å¤šæ¬¡å¾€è¿”ã€‚</li>
<li><strong>å¤šå˜çš„éœ€æ±‚</strong>: å‰ç«¯éœ€æ±‚é¢‘ç¹å˜åŒ–æ—¶ï¼Œåç«¯æ— éœ€åˆ›å»ºæ–°çš„RESTç«¯ç‚¹ï¼Œå‰ç«¯åªéœ€ä¿®æ”¹æŸ¥è¯¢è¯­å¥å³å¯ã€‚</li>
</ul>
</li>
<li><strong>PHPç”Ÿæ€</strong>: <code>webonyx/graphql-php</code> (æ ¸å¿ƒåº“), <code>lighthouse-php</code> (Laravelé›†æˆ)ã€‚</li>
</ul>
</li>
<li>
<p><strong>gRPC</strong>: Googleå¼€å‘çš„é«˜æ€§èƒ½è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰æ¡†æ¶ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>: ä½¿ç”¨<strong>Protocol Buffers</strong>ä½œä¸ºæ¥å£å®šä¹‰è¯­è¨€ï¼ˆIDLï¼‰å’Œåºåˆ—åŒ–æ ¼å¼ï¼Œå¹¶åŸºäº<strong>HTTP/2</strong>è¿›è¡Œä¼ è¾“ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>:
<ul>
<li><strong>å¾®æœåŠ¡é—´é€šä¿¡</strong>: åœ¨å†…éƒ¨ç½‘ç»œä¸­ï¼Œå¯¹æ€§èƒ½å’Œä½å»¶è¿Ÿè¦æ±‚æé«˜çš„æœåŠ¡é—´è°ƒç”¨ã€‚</li>
<li><strong>éœ€è¦ä¸¥æ ¼å¥‘çº¦çš„åœºæ™¯</strong>: Protocol Bufferså¼ºåˆ¶å®šä¹‰äº†æœåŠ¡å’Œæ¶ˆæ¯çš„ç±»å‹ï¼Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆå¤šè¯­è¨€çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä»£ç å­˜æ ¹ï¼ˆstubï¼‰ã€‚</li>
</ul>
</li>
<li><strong>PHPç”Ÿæ€</strong>: éœ€è¦<code>grpc</code> PECLæ‰©å±•å’Œ<code>google/protobuf</code>åº“ã€‚RoadRunnerå¯¹gRPCæœ‰å¾ˆå¥½çš„åŸç”Ÿæ”¯æŒã€‚</li>
</ul>
</li>
</ul>
<p><strong>2. APIç‰ˆæœ¬æ§åˆ¶ç­–ç•¥</strong></p>
<p>å½“ä½ çš„APIéœ€è¦è¿›è¡Œä¸å…¼å®¹çš„å˜æ›´æ—¶ï¼Œç‰ˆæœ¬æ§åˆ¶æ˜¯å¿…é¡»çš„ã€‚</p>
<ul>
<li>
<p><strong>URLç‰ˆæœ¬æ§åˆ¶ (æœ€å¸¸ç”¨)</strong>:
<code>https://api.example.com/v1/users</code></p>
<ul>
<li><strong>ä¼˜ç‚¹</strong>: éå¸¸ç›´è§‚ï¼Œæ˜“äºç†è§£å’Œå®ç°ã€‚å¼€å‘è€…å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è½»æ¾æµ‹è¯•ä¸åŒç‰ˆæœ¬ã€‚è·¯ç”±å’Œç¼“å­˜ç­–ç•¥ç®€å•ã€‚</li>
<li><strong>ç¼ºç‚¹</strong>: â€œæ±¡æŸ“â€äº†URLï¼ŒURLä¸å†å•å•æŒ‡å‘ä¸€ä¸ªèµ„æºã€‚</li>
</ul>
</li>
<li>
<p><strong>Headerç‰ˆæœ¬æ§åˆ¶</strong>:
é€šè¿‡HTTP Headeræ¥æŒ‡å®šç‰ˆæœ¬ï¼Œé€šå¸¸æ˜¯<code>Accept</code>å¤´ã€‚
<code>Accept: application/vnd.yourapi.v1+json</code></p>
<ul>
<li><strong>ä¼˜ç‚¹</strong>: ä¿æŒURLçš„çº¯å‡€ã€‚è¢«ä¸€äº›RESTç†è®ºå®¶è®¤ä¸ºæ˜¯â€œæ›´æ­£ç¡®â€çš„æ–¹å¼ã€‚</li>
<li><strong>ç¼ºç‚¹</strong>: å¯¹å¼€å‘è€…ä¸ç›´è§‚ï¼Œæ— æ³•é€šè¿‡æµè§ˆå™¨ç›´æ¥æµ‹è¯•ã€‚å®¢æˆ·ç«¯å®ç°æ›´å¤æ‚ã€‚</li>
</ul>
</li>
</ul>
<p><strong>å»ºè®®</strong>: å¯¹äºç»å¤§å¤šæ•°é¡¹ç›®ï¼Œ<strong>URLç‰ˆæœ¬æ§åˆ¶</strong>å› å…¶ç®€å•å’Œæ˜ç¡®æ€§è€Œæˆä¸ºæœ€ä½³é€‰æ‹©ã€‚</p>
<hr/>
<h6 data-id="heading-22">4.2 è®¤è¯ä¸æˆæƒæ–¹æ¡ˆ</h6>
<ul>
<li><strong>è®¤è¯ (Authentication)</strong>: ç¡®è®¤â€œä½ æ˜¯è°â€ã€‚</li>
<li><strong>æˆæƒ (Authorization)</strong>: ç¡®è®¤â€œä½ èƒ½åšä»€ä¹ˆâ€ã€‚</li>
</ul>
<p><strong>1. é¢å‘å•é¡µåº”ç”¨(SPA)å’Œç§»åŠ¨ç«¯ï¼šTokenè®¤è¯</strong></p>
<p>å¯¹äºå‰åç«¯åˆ†ç¦»çš„åº”ç”¨ï¼Œä¼ ç»Ÿçš„Sessionè®¤è¯ä¸å†é€‚ç”¨ã€‚åŸºäºTokençš„è®¤è¯æ˜¯ä¸»æµã€‚</p>
<ul>
<li><strong>Laravel Sanctum</strong>: ä¸ºSPAå’Œç§»åŠ¨åº”ç”¨æä¾›äº†è½»é‡çº§çš„è®¤è¯è§£å†³æ–¹æ¡ˆã€‚
<ul>
<li><strong>SPAè®¤è¯ (åŸºäºCookie)</strong>: å¦‚æœä½ çš„SPAå’ŒAPIéƒ¨ç½²åœ¨åŒä¸€ä¸ªä¸»åŸŸåä¸‹ï¼ŒSanctumå¯ä»¥ä½¿ç”¨Laravelçš„å†…ç½®Cookie sessionè®¤è¯ï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†CSRFä¿æŠ¤ï¼Œæ¯”æ‰‹åŠ¨ç®¡ç†Tokenæ›´ç®€å•ã€æ›´å®‰å…¨ã€‚</li>
<li><strong>API Tokenè®¤è¯</strong>: å¯¹äºç§»åŠ¨Appæˆ–ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ŒSanctumå…è®¸ä½ ä¸ºç”¨æˆ·é¢å‘API Tokenã€‚
<ol>
<li>ç”¨æˆ·é€šè¿‡ç”¨æˆ·åå¯†ç ç™»å½•ï¼ŒæœåŠ¡å™¨éªŒè¯é€šè¿‡åï¼Œä¸ºè¯¥ç”¨æˆ·ç”Ÿæˆä¸€ä¸ªTokenã€‚
<code>$token = $user-&gt;createToken('my-app-token')-&gt;plainTextToken;</code></li>
<li>æœåŠ¡å™¨å°†Tokenè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯éœ€è¦å®‰å…¨åœ°å­˜å‚¨å®ƒã€‚</li>
<li>åœ¨åç»­çš„æ¯æ¬¡è¯·æ±‚ä¸­ï¼Œå®¢æˆ·ç«¯éƒ½å¿…é¡»åœ¨<code>Authorization</code>å¤´ä¸­æºå¸¦è¿™ä¸ªTokenã€‚
<code>Authorization: Bearer &lt;token&gt;</code></li>
<li>Laravelé€šè¿‡ä¸­é—´ä»¶è‡ªåŠ¨éªŒè¯è¿™ä¸ªTokenå¹¶è®¤è¯ç”¨æˆ·ã€‚</li>
</ol>
</li>
</ul>
</li>
</ul>
<p><strong>2. é¢å‘æœåŠ¡é—´/ç¬¬ä¸‰æ–¹åº”ç”¨ï¼šOAuth 2.0</strong></p>
<p>OAuth 2.0ä¸æ˜¯ä¸€ä¸ªè®¤è¯åè®®ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>æˆæƒæ¡†æ¶</strong>ã€‚å®ƒå…è®¸ä¸€ä¸ªåº”ç”¨ï¼ˆClientï¼‰åœ¨ä¸è·å–ç”¨æˆ·å¯†ç çš„æƒ…å†µä¸‹ï¼Œè·å–è®¿é—®ç”¨æˆ·åœ¨å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šèµ„æºçš„æƒé™ã€‚</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒæµç¨‹ (Grant Types)</strong>:</p>
<ul>
<li><strong>Authorization Code (æˆæƒç æ¨¡å¼)</strong>: æœ€å¸¸ç”¨ã€æœ€å®‰å…¨çš„æ¨¡å¼ï¼Œé€‚ç”¨äºä¼ ç»Ÿçš„Webåº”ç”¨ã€‚
<ol>
<li>ä½ çš„åº”ç”¨å°†ç”¨æˆ·é‡å®šå‘åˆ°æˆæƒæœåŠ¡å™¨ï¼ˆå¦‚Google, GitHubï¼‰ã€‚</li>
<li>ç”¨æˆ·åœ¨æˆæƒæœåŠ¡å™¨ä¸Šç™»å½•å¹¶åŒæ„æˆæƒã€‚</li>
<li>æˆæƒæœåŠ¡å™¨å°†ç”¨æˆ·é‡å®šå‘å›ä½ çš„åº”ç”¨ï¼Œå¹¶é™„å¸¦ä¸€ä¸ªä¸€æ¬¡æ€§çš„<code>code</code>ã€‚</li>
<li>ä½ çš„åº”ç”¨åœ¨åç«¯ç”¨è¿™ä¸ª<code>code</code>å‘æˆæƒæœåŠ¡å™¨æ¢å–ä¸€ä¸ª<code>access_token</code>ã€‚</li>
<li>ä½¿ç”¨<code>access_token</code>å»è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚</li>
</ol>
</li>
<li><strong>Client Credentials (å®¢æˆ·ç«¯å‡­è¯æ¨¡å¼)</strong>: é€‚ç”¨äºæ²¡æœ‰ç”¨æˆ·å‚ä¸çš„æœºå™¨åˆ°æœºå™¨ï¼ˆM2Mï¼‰é€šä¿¡ã€‚å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨è‡ªå·±çš„<code>client_id</code>å’Œ<code>client_secret</code>å‘æˆæƒæœåŠ¡å™¨è·å–<code>access_token</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>PHPå®ç°</strong>:</p>
<ul>
<li><strong><code>league/oauth2-server</code></strong>: è¿™æ˜¯PHPç¤¾åŒºå®ç°OAuth 2.0æœåŠ¡å™¨çš„äº‹å®æ ‡å‡†åº“ï¼Œä½†é…ç½®ç›¸å¯¹å¤æ‚ã€‚</li>
<li><strong>Laravel Passport</strong>: å®ƒæ˜¯<code>league/oauth2-server</code>çš„ä¸€ä¸ªå®Œæ•´ã€æ˜“äºå®‰è£…å’Œé…ç½®çš„Laravelå°è£…ã€‚å¦‚æœä½ éœ€è¦åœ¨ä½ çš„Laravelåº”ç”¨ä¸­æ„å»ºä¸€ä¸ªåŠŸèƒ½é½å…¨çš„OAuth 2.0æœåŠ¡å™¨ï¼ŒPassportæ˜¯é¦–é€‰ã€‚å®ƒä¸ºä½ å¤„ç†äº†æ‰€æœ‰å¤æ‚çš„æµç¨‹ï¼Œè®©ä½ èƒ½å¿«é€Ÿæ­å»ºèµ·Tokené¢å‘ã€åˆ·æ–°ã€åŠé”€ç­‰åŠŸèƒ½ã€‚</li>
</ul>
</li>
</ul>
<h6 data-id="heading-23">4.3 æ€§èƒ½ä¼˜åŒ–</h6>
<p>ä¸€ä¸ªé«˜æ€§èƒ½çš„APIä¸ä»…ä»£ç æ‰§è¡Œè¦å¿«ï¼Œç½‘ç»œä¼ è¾“å’Œå®¢æˆ·ç«¯çš„ç­‰å¾…ä¹Ÿéœ€è¦è¢«ä¼˜åŒ–ã€‚</p>
<p><strong>1. HTTPç¼“å­˜: ETag ä¸ <code>Last-Modified</code></strong></p>
<p>HTTPç¼“å­˜æ˜¯å‡å°‘ä¸å¿…è¦æ•°æ®ä¼ è¾“ã€é™ä½æœåŠ¡å™¨è´Ÿè½½çš„åˆ©å™¨ã€‚å…¶æ ¸å¿ƒæ˜¯è®©å®¢æˆ·ç«¯ï¼ˆå¦‚æµè§ˆå™¨æˆ–Appï¼‰å¯ä»¥éªŒè¯æœ¬åœ°ç¼“å­˜çš„èµ„æºæ˜¯å¦ä»ç„¶æœ‰æ•ˆï¼Œå¦‚æœæœ‰æ•ˆï¼ŒæœåŠ¡å™¨åˆ™æ— éœ€å‘é€å®Œæ•´çš„å“åº”ä½“ã€‚</p>
<ul>
<li>
<p><strong><code>Last-Modified</code></strong>: æœåŠ¡å™¨åœ¨å“åº”å¤´ä¸­å‘Šè¯‰å®¢æˆ·ç«¯èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ã€‚
<code>Last-Modified: Tue, 15 Sep 2025 12:00:00 GMT</code>
å®¢æˆ·ç«¯åœ¨ä¸‹æ¬¡è¯·æ±‚æ—¶ï¼Œä¼šå¸¦ä¸Š<code>If-Modified-Since</code>å¤´ã€‚å¦‚æœæœåŠ¡å™¨å‘ç°èµ„æºåœ¨æ­¤æ—¶é—´åæœªè¢«ä¿®æ”¹ï¼Œåˆ™è¿”å›ä¸€ä¸ª<code>304 Not Modified</code>çŠ¶æ€ç å’Œç©ºå“åº”ä½“ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚</p>
</li>
<li>
<p><strong>ETag (Entity Tag)</strong>: <code>Last-Modified</code>çš„ç²¾åº¦åªèƒ½åˆ°ç§’ï¼Œä¸”æ— æ³•åæ˜ å†…å®¹æœªå˜ä½†æ–‡ä»¶æ—¶é—´æˆ³å˜åŒ–çš„åœºæ™¯ã€‚ETagæ˜¯æ›´å¼ºå¤§ã€æ›´ç²¾ç¡®çš„æ›¿ä»£æ–¹æ¡ˆã€‚å®ƒæ˜¯ä¸€ä¸ªä»£è¡¨èµ„æºå½“å‰çŠ¶æ€çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆé€šå¸¸æ˜¯å†…å®¹çš„å“ˆå¸Œå€¼ï¼‰ã€‚
<code>ETag: "abcde12345" å®¢æˆ·ç«¯åœ¨ä¸‹æ¬¡è¯·æ±‚æ—¶ï¼Œä¼šå¸¦ä¸Š</code>If-None-Match<code>å¤´ã€‚æœåŠ¡å™¨æ¯”è¾ƒå®¢æˆ·ç«¯çš„ETagå’Œå½“å‰èµ„æºçš„ETagï¼Œå¦‚æœä¸€è‡´ï¼ŒåŒæ ·è¿”å›</code>304 Not Modified`ã€‚</p>
</li>
</ul>
<p><strong>å®æˆ˜åº”ç”¨ï¼šåœ¨Laravelä¸­é—´ä»¶ä¸­å®ç°ETag</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// App/Http/Middleware/EtagMiddleware.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EtagMiddleware</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, <span class="hljs-built_in">Closure</span> <span class="hljs-variable">$next</span></span>)
    </span>{
        <span class="hljs-comment">// åªå¯¹GETå’ŒHEADè¯·æ±‚åº”ç”¨ETag</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">isMethod</span>(<span class="hljs-string">'get'</span>) &amp;&amp; !<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">isMethod</span>(<span class="hljs-string">'head'</span>)) {
            <span class="hljs-keyword">return</span> <span class="hljs-variable">$next</span>(<span class="hljs-variable">$request</span>);
        }

        <span class="hljs-variable">$response</span> = <span class="hljs-variable">$next</span>(<span class="hljs-variable">$request</span>);

        <span class="hljs-comment">// ç”ŸæˆETag (ç®€å•çš„md5)</span>
        <span class="hljs-variable">$etag</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">getContent</span>());
        <span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">setEtag</span>(<span class="hljs-variable">$etag</span>);

        <span class="hljs-comment">// æ£€æŸ¥å®¢æˆ·ç«¯çš„If-None-Matchå¤´æ˜¯å¦ä¸æˆ‘ä»¬çš„ETagåŒ¹é…</span>
        <span class="hljs-comment">// setEtagæ–¹æ³•å†…éƒ¨å·²ç»åŒ…å«äº†è¿™ä¸ªæ£€æŸ¥é€»è¾‘</span>
        <span class="hljs-comment">// å¦‚æœåŒ¹é…ï¼ŒLaravelä¼šè‡ªåŠ¨å°†å“åº”è®¾ç½®ä¸º304 Not Modified</span>
        <span class="hljs-comment">// æˆ‘ä»¬åªéœ€è¿”å›å“åº”å³å¯</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$response</span>;
    }
}
</code></pre>
<p>å°†è¿™ä¸ªä¸­é—´ä»¶åº”ç”¨åˆ°ä½ çš„APIè·¯ç”±ç»„ï¼Œå³å¯è½»æ¾å¯ç”¨ETagç¼“å­˜ã€‚</p>
<p><strong>2. APIèµ„æºå±‚çš„é«˜çº§ç”¨æ³•</strong></p>
<p>Laravelçš„API Resources (å¦‚<code>UserResource</code>) æ˜¯è½¬æ¢æ¨¡å‹ä¸ºJSONçš„å¼ºå¤§å·¥å…·ã€‚å–„ç”¨å…¶é«˜çº§ç‰¹æ€§å¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½å’Œçµæ´»æ€§ã€‚</p>
<ul>
<li>
<p><strong>æ¡ä»¶å±æ€§ (<code>when</code>, <code>mergeWhen</code>)</strong>: æ ¹æ®æ¡ä»¶åŠ¨æ€æ·»åŠ å­—æ®µåˆ°å“åº”ä¸­ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// UserResource.php</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toArray</span>(<span class="hljs-params"><span class="hljs-variable">$request</span></span>): <span class="hljs-title">array</span>
</span>{
    <span class="hljs-keyword">return</span> [
        <span class="hljs-string">'id'</span> =&gt; <span class="hljs-variable language_">$this</span>-&gt;id,
        <span class="hljs-string">'name'</span> =&gt; <span class="hljs-variable language_">$this</span>-&gt;name,
        <span class="hljs-comment">// åªæœ‰å½“ç”¨æˆ·æ˜¯ç®¡ç†å‘˜æ—¶ï¼Œæ‰æ˜¾ç¤ºemailå­—æ®µ</span>
        <span class="hljs-string">'email'</span> =&gt; <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">when</span>(<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">user</span>()-&gt;<span class="hljs-title function_ invoke__">isAdmin</span>(), <span class="hljs-variable">$this</span>-&gt;email),
        <span class="hljs-comment">// åˆå¹¶ç®¡ç†å‘˜ä¸“å±çš„å…ƒæ•°æ®</span>
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">mergeWhen</span>(<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">user</span>()-&gt;<span class="hljs-title function_ invoke__">isAdmin</span>(), [
            <span class="hljs-string">'created_at'</span> =&gt; <span class="hljs-variable">$this</span>-&gt;created_at,
            <span class="hljs-string">'updated_at'</span> =&gt; <span class="hljs-variable">$this</span>-&gt;updated_at,
        ]),
    ];
}
</code></pre>
</li>
<li>
<p><strong>é˜²æ­¢N+1é—®é¢˜ (<code>whenLoaded</code>)</strong>: è¿™æ˜¯æœ€é‡è¦çš„æ€§èƒ½æŠ€å·§ä¹‹ä¸€ã€‚<code>whenLoaded</code>ç¡®ä¿åªæœ‰åœ¨å…³ç³»è¢«<strong>é¢„åŠ è½½ (eager-loaded)</strong> çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šå°†å…¶åŒ…å«åœ¨å“åº”ä¸­ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// åœ¨Resourceä¸­</span>
<span class="hljs-string">'posts'</span> =&gt; <span class="hljs-title class_">PostResource</span>::<span class="hljs-title function_ invoke__">collection</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-title function_ invoke__">whenLoaded</span>(<span class="hljs-string">'posts'</span>)),

<span class="hljs-comment">// åœ¨æ§åˆ¶å™¨ä¸­</span>
<span class="hljs-comment">// é”™è¯¯çš„æ–¹å¼ï¼Œä¼šå¯¼è‡´N+1æŸ¥è¯¢</span>
<span class="hljs-variable">$users</span> = <span class="hljs-title class_">User</span>::<span class="hljs-title function_ invoke__">all</span>(); 
<span class="hljs-keyword">return</span> <span class="hljs-title class_">UserResource</span>::<span class="hljs-title function_ invoke__">collection</span>(<span class="hljs-variable">$users</span>);

<span class="hljs-comment">// æ­£ç¡®çš„æ–¹å¼ï¼Œä½¿ç”¨é¢„åŠ è½½</span>
<span class="hljs-variable">$users</span> = <span class="hljs-title class_">User</span>::<span class="hljs-title function_ invoke__">with</span>(<span class="hljs-string">'posts'</span>)-&gt;<span class="hljs-title function_ invoke__">get</span>();
<span class="hljs-keyword">return</span> <span class="hljs-title class_">UserResource</span>::<span class="hljs-title function_ invoke__">collection</span>(<span class="hljs-variable">$users</span>);
</code></pre>
<p><code>whenLoaded</code>ä¼šâ€œæƒ©ç½šâ€æ²¡æœ‰è¿›è¡Œé¢„åŠ è½½çš„æŸ¥è¯¢ï¼Œå› ä¸ºå®ƒä¸ä¼šåœ¨å“åº”ä¸­æ˜¾ç¤º<code>posts</code>ï¼Œä»è€Œè¿«ä½¿å¼€å‘è€…å…»æˆé¢„åŠ è½½çš„å¥½ä¹ æƒ¯ã€‚</p>
</li>
<li>
<p><strong>ç¨€ç–å­—æ®µé›† (Sparse Fieldsets)</strong>: å…è®¸APIæ¶ˆè´¹è€…é€šè¿‡æŸ¥è¯¢å‚æ•°åªè¯·æ±‚ä»–ä»¬éœ€è¦çš„å­—æ®µï¼Œè¿›ä¸€æ­¥å‡å°‘å“åº”ä½“ç§¯ã€‚
<code>GET /api/users/1?fields[users]=id,name</code></p>
</li>
</ul>
<p><strong>3. ä½¿ç”¨OpenAPI (Swagger) è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£</strong></p>
<p>è¿‡æ—¶çš„æ–‡æ¡£æ˜¯APIå¼€å‘è€…çš„å™©æ¢¦ã€‚é€šè¿‡ä»£ç ä¼˜å…ˆçš„æ–¹å¼ç”Ÿæˆæ–‡æ¡£å¯ä»¥ä¸€åŠ³æ°¸é€¸ã€‚</p>
<ul>
<li><strong>OpenAPI (Swagger)</strong>: æ˜¯ä¸€ä¸ªæè¿°RESTful APIçš„è¯­è¨€æ— å…³è§„èŒƒã€‚</li>
<li><strong>PHPå®ç°</strong>:
<ul>
<li><code>darkaonline/l5-swagger</code> (Laravel): ä¸€ä¸ªæµè¡Œçš„åŒ…ï¼Œå¯ä»¥é€šè¿‡PHPDocæ³¨è§£æˆ–PHP 8 Attributesæ¥æè¿°ä½ çš„APIã€‚</li>
<li><code>zircote/swagger-php</code>: æ›´é€šç”¨çš„åº“ï¼Œå¯ä»¥é›†æˆåˆ°ä»»ä½•PHPé¡¹ç›®ä¸­ã€‚</li>
</ul>
</li>
</ul>
<p><strong>å®æˆ˜åº”ç”¨ï¼šä½¿ç”¨Attributeå®šä¹‰APIç«¯ç‚¹</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// UserController.php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">OpenApi</span>\<span class="hljs-title">Attributes</span> <span class="hljs-keyword">as</span> <span class="hljs-title">OA</span>;

<span class="hljs-comment">#[OA\Info(title: "My API", version: "1.0")]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">#[OA\Get(</span>
        path: <span class="hljs-string">"/api/users/{id}"</span>,
        summary: <span class="hljs-string">"Find user by ID"</span>,
        parameters: [
            <span class="hljs-keyword">new</span> OA\<span class="hljs-title function_ invoke__">Parameter</span>(<span class="hljs-attr">name</span>: <span class="hljs-string">"id"</span>, <span class="hljs-attr">in</span>: <span class="hljs-string">"path"</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">schema</span>: <span class="hljs-keyword">new</span> OA\<span class="hljs-title function_ invoke__">Schema</span>(<span class="hljs-attr">type</span>: <span class="hljs-string">"integer"</span>)),
        ],
        responses: [
            <span class="hljs-keyword">new</span> OA\<span class="hljs-title function_ invoke__">Response</span>(<span class="hljs-attr">response</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">description</span>: <span class="hljs-string">"Successful operation"</span>),
            <span class="hljs-keyword">new</span> OA\<span class="hljs-title function_ invoke__">Response</span>(<span class="hljs-attr">response</span>: <span class="hljs-number">404</span>, <span class="hljs-attr">description</span>: <span class="hljs-string">"User not found"</span>)
        ]
    )]
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$id</span></span>)
    </span>{
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p>é€šè¿‡ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œè¿™äº›Attributeä¼šè¢«è§£æå¹¶ç”Ÿæˆä¸€ä¸ª<code>openapi.json</code>æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å¯ä»¥ï¼š</p>
<ol>
<li>è¢«<strong>Swagger UI</strong>æˆ–<strong>Redoc</strong>ç­‰å·¥å…·æ¸²æŸ“æˆæ¼‚äº®çš„ã€å¯äº¤äº’çš„APIæ–‡æ¡£ã€‚</li>
<li>è¢«<strong>OpenAPI Generator</strong>ç­‰ä»£ç ç”Ÿæˆå™¨ç”¨æ¥è‡ªåŠ¨åˆ›å»ºå¤šè¯­è¨€ï¼ˆTypeScript, Java, Go...ï¼‰çš„å®¢æˆ·ç«¯SDKï¼Œæå¤§åœ°æå‡äº†APIæ¶ˆè´¹è€…çš„å¼€å‘æ•ˆç‡ã€‚</li>
</ol>
<h6 data-id="heading-24">4.4 API å®‰å…¨åŠ å›º</h6>
<p>åŠŸèƒ½å’Œæ€§èƒ½å¦‚æœå»ºç«‹åœ¨è„†å¼±çš„å®‰å…¨ä¹‹ä¸Šï¼Œå°†å˜å¾—æ¯«æ— æ„ä¹‰ã€‚é™¤äº†è®¤è¯å’Œæˆæƒï¼Œä»¥ä¸‹å‡ ç‚¹æ˜¯æ„å»ºå¥å£®APIæ—¶å¿…é¡»è€ƒè™‘çš„ã€‚</p>
<ul>
<li>
<p><strong>é˜²èŒƒæ‰¹é‡èµ‹å€¼ (Preventing Mass Assignment)</strong>:
è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„æ¼æ´ï¼Œç”¨æˆ·é€šè¿‡è¯·æ±‚ä¼ é€’éé¢„æœŸçš„å­—æ®µï¼Œä»è€Œä¿®æ”¹äº†ä»–ä»¬æœ¬ä¸è¯¥æœ‰æƒé™ä¿®æ”¹çš„æ•°æ®ï¼ˆå¦‚<code>is_admin</code>å­—æ®µï¼‰ã€‚</p>
<ul>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>: åœ¨ä½ çš„Eloquentæ¨¡å‹ä¸­ï¼Œæ˜ç¡®ä½¿ç”¨<code>$fillable</code>å±æ€§æ¥ç™½åå•å¯è¢«æ‰¹é‡èµ‹å€¼çš„å­—æ®µã€‚æ°¸è¿œä¸è¦å›¾çœäº‹ä½¿ç”¨<code>$guarded = []</code>ã€‚
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-comment">// åªå…è®¸name, email, passwordè¢«æ‰¹é‡å¡«å……</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$fillable</span> = [<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>, <span class="hljs-string">'password'</span>];
}
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>APIé€Ÿç‡é™åˆ¶ (Rate Limiting)</strong>:
ä¸ºäº†é˜²æ­¢æ¶æ„ç”¨æˆ·é€šè¿‡é«˜é¢‘è¯·æ±‚æš´åŠ›ç ´è§£å¯†ç æˆ–å¯¹ä½ çš„æœåŠ¡è¿›è¡ŒDoSæ”»å‡»ï¼Œå¿…é¡»è¿›è¡Œé€Ÿç‡é™åˆ¶ã€‚</p>
<ul>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>: Laravelå†…ç½®äº†å¼ºå¤§çš„<code>throttle</code>ä¸­é—´ä»¶ã€‚ä½ å¯ä»¥è½»æ¾åœ°åœ¨è·¯ç”±ä¸­å®šä¹‰å®ƒã€‚
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// routes/api.php</span>
<span class="hljs-comment">// é™åˆ¶æ‰€æœ‰APIè¯·æ±‚ï¼Œæ¯åˆ†é’Ÿæœ€å¤š60æ¬¡</span>
<span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">middleware</span>(<span class="hljs-string">'throttle:60,1'</span>)-&gt;<span class="hljs-title function_ invoke__">group</span>(function () {
    <span class="hljs-comment">// ... your routes</span>
});

<span class="hljs-comment">// å¯¹ç™»å½•æ¥å£ä½¿ç”¨æ›´ä¸¥æ ¼çš„é™åˆ¶</span>
<span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">'/login'</span>, ...)-&gt;<span class="hljs-title function_ invoke__">middleware</span>(<span class="hljs-string">'throttle:5,1'</span>); <span class="hljs-comment">// æ¯åˆ†é’Ÿ5æ¬¡</span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>ä¾èµ–é¡¹å®‰å…¨å®¡è®¡ (Dependency Security)</strong>:
ä½ çš„åº”ç”¨å®‰å…¨å–å†³äºä½ æœ€ä¸å®‰å…¨çš„é‚£ä¸ªä¸‰æ–¹ä¾èµ–ã€‚</p>
<ul>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>: å®šæœŸè¿è¡Œ<code>composer audit</code>å‘½ä»¤ã€‚è¿™ä¸ªå‘½ä»¤ä¼šæ£€æŸ¥ä½ é¡¹ç›®<code>composer.lock</code>æ–‡ä»¶ä¸­çš„æ‰€æœ‰ä¾èµ–ï¼Œå¹¶å¯¹ç…§ä¸€ä¸ªå…¬å¼€çš„æ¼æ´æ•°æ®åº“è¿›è¡Œæ‰«æï¼ŒæŠ¥å‘Šå·²çŸ¥çš„å®‰å…¨æ¼æ´ã€‚</li>
<li><strong>è‡ªåŠ¨åŒ–</strong>: å°†<code>composer audit</code>ä½œä¸ºCI/CDæµæ°´çº¿ä¸­çš„ä¸€ä¸ªå¼ºåˆ¶æ­¥éª¤ã€‚åŒæ—¶ï¼Œå¯ç”¨GitHubçš„<strong>Dependabot</strong>ï¼Œå®ƒå¯ä»¥åœ¨ä½ çš„ä¾èµ–é¡¹å‘å¸ƒå®‰å…¨æ›´æ–°æ—¶è‡ªåŠ¨ä¸ºä½ åˆ›å»ºPRã€‚</li>
</ul>
</li>
<li>
<p><strong>CORSçš„æ­£ç¡®é…ç½® (Proper CORS Configuration)</strong>:
åœ¨å‰åç«¯åˆ†ç¦»çš„åº”ç”¨ä¸­ï¼Œæµè§ˆå™¨ä¼šæ‰§è¡ŒCORSï¼ˆè·¨æºèµ„æºå…±äº«ï¼‰é¢„æ£€ã€‚é”™è¯¯çš„é…ç½®å¯èƒ½å¸¦æ¥å®‰å…¨é£é™©ã€‚</p>
<ul>
<li><strong>é£é™©</strong>: å°†<code>Access-Control-Allow-Origin</code>è®¾ç½®ä¸º<code>*</code>ï¼Œæ„å‘³ç€ä»»ä½•åŸŸåçš„ç½‘ç«™éƒ½å¯ä»¥å‘ä½ çš„APIå‘èµ·è¯·æ±‚ï¼Œè¿™å¯èƒ½å¯¼è‡´CSRFç­‰æ”»å‡»ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>: ç²¾ç¡®é…ç½®å…è®¸çš„æ¥æºã€‚åœ¨Laravelçš„<code>config/cors.php</code>ä¸­ï¼Œæ˜ç¡®åˆ—å‡ºä½ çš„å‰ç«¯åº”ç”¨æ‰€åœ¨çš„åŸŸåã€‚
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// config/cors.php</span>
<span class="hljs-string">'allowed_origins'</span> =&gt; [<span class="hljs-string">'http://localhost:3000'</span>, <span class="hljs-string">'https://your-frontend-app.com'</span>],
</code></pre>
</li>
</ul>
</li>
</ul>
<hr/>
<hr/>
<h4 data-id="heading-25">ç¬¬äº”éƒ¨åˆ†ï¼šå¹¶å‘ä¸å¼‚æ­¥PHPï¼šé‡Šæ”¾æè‡´æ€§èƒ½</h4>
<p>è¿™æ˜¯ç°ä»£PHPæœ€é«˜é˜¶ã€ä¹Ÿæ˜¯æœ€å…·é¢ è¦†æ€§çš„é¢†åŸŸã€‚é€šè¿‡å¼‚æ­¥åŒ–ï¼ŒPHPå¾—ä»¥æ‘†è„±ä¼ ç»ŸWebè¯·æ±‚çš„çŸ­æš‚ç”Ÿå‘½å‘¨æœŸï¼Œè¿›å…¥é«˜æ€§èƒ½ã€å¸¸é©»å†…å­˜çš„æœåŠ¡ç«¯åº”ç”¨é¢†åŸŸã€‚</p>
<h5 data-id="heading-26">ç¬¬5ç« ï¼šå¹¶å‘ä¸å¼‚æ­¥PHPï¼šé‡Šæ”¾æè‡´æ€§èƒ½</h5>
<h6 data-id="heading-27">5.1 ç°ä»£PHPè¿è¡Œæ¨¡å¼</h6>
<ul>
<li>
<p><strong>PHP-FPM (FastCGI Process Manager)</strong>:</p>
<ul>
<li><strong>æ¨¡å‹</strong>: è¿™æ˜¯æœ€ä¼ ç»Ÿçš„æ¨¡å¼ã€‚ä¸€ä¸ªmasterè¿›ç¨‹ç®¡ç†ç€ä¸€ä¸ªworkerè¿›ç¨‹æ± ã€‚æ¯ä¸ªworkeråœ¨å¤„ç†å®Œä¸€ä¸ªè¯·æ±‚åï¼Œä¼šé”€æ¯æ‰€æœ‰å¯¹è±¡ï¼Œé‡Šæ”¾æ‰€æœ‰å†…å­˜ï¼ˆâ€œæ— å…±äº«â€æ¶æ„ï¼‰ã€‚</li>
<li><strong>ä¼˜ç‚¹</strong>: ç¨³å®šã€ç®€å•ã€‚å•ä¸ªè¯·æ±‚çš„å´©æºƒä¸ä¼šå½±å“å…¶ä»–è¯·æ±‚ã€‚ç”Ÿæ€æˆç†Ÿã€‚</li>
<li><strong>ç¼ºç‚¹</strong>: æ€§èƒ½ç“¶é¢ˆæ˜æ˜¾ã€‚æ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦å®Œæ•´åœ°é‡æ–°åŠ è½½å’Œå¼•å¯¼æ•´ä¸ªæ¡†æ¶ï¼ˆå¦‚Laravelï¼‰ï¼ŒI/Oæ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ã€APIè°ƒç”¨ï¼‰æ˜¯å®Œå…¨é˜»å¡çš„ã€‚</li>
</ul>
</li>
<li>
<p><strong>Swoole / RoadRunner / Workerman (åº”ç”¨æœåŠ¡å™¨)</strong>:</p>
<ul>
<li><strong>æ¨¡å‹</strong>: è¿™äº›æ˜¯å¸¸é©»å†…å­˜çš„åº”ç”¨æœåŠ¡å™¨ã€‚Masterè¿›ç¨‹å¯åŠ¨çš„Workerè¿›ç¨‹åœ¨å¤„ç†å®Œä¸€ä¸ªè¯·æ±‚å<strong>ä¸ä¼šé€€å‡º</strong>ï¼Œè€Œæ˜¯ç»§ç»­ç­‰å¾…ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚æ¡†æ¶åªåœ¨Workerå¯åŠ¨æ—¶è¢«å¼•å¯¼ä¸€æ¬¡ã€‚</li>
<li><strong>ä¼˜ç‚¹</strong>:
<ul>
<li><strong>æé«˜æ€§èƒ½</strong>: å…å»äº†é‡å¤çš„æ¡†æ¶å¼•å¯¼å¼€é”€ï¼Œè¯·æ±‚å»¶è¿Ÿæä½ã€‚</li>
<li><strong>çŠ¶æ€ä¿æŒ</strong>: å¯ä»¥åœ¨å†…å­˜ä¸­ç»´æŠ¤æ•°æ®åº“è¿æ¥æ± ã€å…¨å±€é…ç½®ã€ç”šè‡³ä¸šåŠ¡çŠ¶æ€ï¼Œè¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚</li>
<li><strong>å¼‚æ­¥å¹¶å‘</strong>: å®ƒä»¬å†…ç½®äº†äº‹ä»¶å¾ªç¯å’Œåç¨‹è°ƒåº¦å™¨ï¼Œå…è®¸ä½ åœ¨ä¸€ä¸ªworkerå†…é€šè¿‡åç¨‹å¹¶å‘å¤„ç†æˆåƒä¸Šä¸‡ä¸ªI/Oå¯†é›†å‹ä»»åŠ¡ã€‚</li>
</ul>
</li>
<li><strong>ç¼ºç‚¹</strong>:
<ul>
<li><strong>å†…å­˜ç®¡ç†</strong>: éœ€è¦å¼€å‘è€…è­¦æƒ•å†…å­˜æ³„æ¼ï¼Œå› ä¸ºè¿›ç¨‹ä¸ä¼šè‡ªåŠ¨æ­»äº¡ã€‚</li>
<li><strong>çŠ¶æ€æ±¡æŸ“</strong>: å¿…é¡»å°å¿ƒå¤„ç†é™æ€å˜é‡å’Œå•ä¾‹ï¼Œé¿å…ä¸Šä¸€ä¸ªè¯·æ±‚çš„çŠ¶æ€æ±¡æŸ“ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 data-id="heading-28">5.2 Swoole/RoadRunner å®æˆ˜</h6>
<p>ç›´æ¥ä½¿ç”¨Swooleæˆ–RoadRunner APIæ˜¯å¤æ‚çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œç°ä»£æ¡†æ¶æä¾›äº†ä¼˜é›…çš„é›†æˆæ–¹æ¡ˆã€‚</p>
<ul>
<li>
<p><strong>Laravel Octane</strong>: è¿™æ˜¯Laravelå®˜æ–¹æä¾›çš„ã€ä¸Swooleå’ŒRoadRunneré›†æˆçš„ç¬¬ä¸€æ–¹æ‰©å±•åŒ…ã€‚å®ƒä¸ºä½ å¤„ç†äº†æ‰€æœ‰åº•å±‚çš„å¤æ‚æ€§ã€‚</p>
<ul>
<li>å®‰è£…åï¼Œåªéœ€ä¸€ä¸ªå‘½ä»¤å³å¯å¯åŠ¨é«˜æ€§èƒ½æœåŠ¡å™¨ï¼š
<code>php artisan octane:start --server=swoole --workers=4</code></li>
</ul>
</li>
<li>
<p><strong>åç¨‹å¹¶å‘</strong>: Octaneæš´éœ²äº†ç®€å•æ˜“ç”¨çš„APIæ¥åˆ©ç”¨åº•å±‚çš„åç¨‹èƒ½åŠ›ã€‚</p>
<p><strong>åœºæ™¯</strong>: å‡è®¾ä¸€ä¸ªç”¨æˆ·ä»ªè¡¨ç›˜é¡µé¢éœ€è¦åŒæ—¶ä»3ä¸ªä¸åŒçš„å¾®æœåŠ¡è·å–æ•°æ®ã€‚</p>
<ul>
<li>
<p><strong>ä¼ ç»Ÿé˜»å¡æ–¹å¼ (æ€»è€—æ—¶ â‰ˆ 1s + 1.2s + 0.8s = 3s)</strong>:</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$user</span> = <span class="hljs-title class_">Http</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'http://user-service/me'</span>)-&gt;<span class="hljs-title function_ invoke__">json</span>();
<span class="hljs-variable">$orders</span> = <span class="hljs-title class_">Http</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'http://order-service/my-orders'</span>)-&gt;<span class="hljs-title function_ invoke__">json</span>();
<span class="hljs-variable">$stats</span> = <span class="hljs-title class_">Http</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'http://stats-service/dashboard'</span>)-&gt;<span class="hljs-title function_ invoke__">json</span>();
</code></pre>
</li>
<li>
<p><strong>Octaneå¹¶å‘æ–¹å¼ (æ€»è€—æ—¶ â‰ˆ max(1, 1.2, 0.8) = 1.2s)</strong>:</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Laravel</span>\<span class="hljs-title">Octane</span>\<span class="hljs-title">Facades</span>\<span class="hljs-title">Octane</span>;

[<span class="hljs-variable">$user</span>, <span class="hljs-variable">$orders</span>, <span class="hljs-variable">$stats</span>] = <span class="hljs-title class_">Octane</span>::<span class="hljs-title function_ invoke__">concurrent</span>([
    <span class="hljs-string">'user'</span> =&gt; fn () =&gt; <span class="hljs-title class_">Http</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'http://user-service/me'</span>)-&gt;<span class="hljs-title function_ invoke__">json</span>(),
    <span class="hljs-string">'orders'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">fn</span> (<span class="hljs-params"/>) =&gt;</span> <span class="hljs-title class_">Http</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'http://order-service/my-orders'</span>)-&gt;<span class="hljs-title function_ invoke__">json</span>(),
    <span class="hljs-string">'stats'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">fn</span> (<span class="hljs-params"/>) =&gt;</span> <span class="hljs-title class_">Http</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'http://stats-service/dashboard'</span>)-&gt;<span class="hljs-title function_ invoke__">json</span>(),
], timeout: <span class="hljs-number">2000</span>);
</code></pre>
<p><code>Octane::concurrent</code>åˆ©ç”¨åç¨‹è°ƒåº¦å™¨ï¼Œè®©è¿™ä¸‰ä¸ªé˜»å¡çš„HTTPè¯·æ±‚â€œåŒæ—¶â€å¼€å§‹ï¼Œç¨‹åºä¼šç­‰å¾…æœ€é•¿çš„é‚£ä¸€ä¸ªå®Œæˆï¼Œè€Œä¸æ˜¯ä¾æ¬¡ç´¯åŠ ã€‚è¿™æå¤§åœ°æå‡äº†I/Oå¯†é›†å‹ä»»åŠ¡çš„å“åº”é€Ÿåº¦ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>è¶…è¶ŠWeb</strong>: è¿™äº›åº”ç”¨æœåŠ¡å™¨è¿˜å…è®¸ä½ æ„å»ºä¼ ç»Ÿçš„PHP-FPMæ— æ³•å®ç°çš„æœåŠ¡ï¼Œå¦‚ï¼š</p>
<ul>
<li><strong>WebSocketæœåŠ¡å™¨</strong>: ç”¨äºèŠå¤©å®¤ã€å®æ—¶æ•°æ®æ¨é€ã€åœ¨çº¿æ¸¸æˆã€‚</li>
<li><strong>TCP/UDPæœåŠ¡å™¨</strong>: ç”¨äºç‰©è”ç½‘(IoT)è®¾å¤‡ã€è‡ªå®šä¹‰ç½‘ç»œåè®®ã€‚</li>
</ul>
</li>
</ul>
<h6 data-id="heading-29">5.3 æ¶ˆæ¯é˜Ÿåˆ—ä¸å¼‚æ­¥ä»»åŠ¡</h6>
<p>å¹¶éæ‰€æœ‰ä»»åŠ¡éƒ½é€‚åˆåœ¨åŒæ­¥çš„Webè¯·æ±‚ä¸­å®Œæˆï¼Œç‰¹åˆ«æ˜¯é‚£äº›è€—æ—¶è¾ƒé•¿çš„æ“ä½œã€‚</p>
<p><strong>é—®é¢˜</strong>: ä¸€ä¸ªç”¨æˆ·æ³¨å†Œè¯·æ±‚ï¼Œéœ€è¦æ‰§è¡Œï¼š1. åˆ›å»ºç”¨æˆ·è®°å½• (å¿«) 2. å‘é€æ¬¢è¿é‚®ä»¶ (æ…¢) 3. åˆå§‹åŒ–åˆ†ææ•°æ® (æ…¢)ã€‚å¦‚æœåŒæ­¥æ‰§è¡Œï¼Œç”¨æˆ·éœ€è¦ç­‰å¾…å¾ˆä¹…æ‰èƒ½çœ‹åˆ°å“åº”ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>: å°†æ…¢é€Ÿä»»åŠ¡<strong>å¼‚æ­¥åŒ–</strong>ã€‚Webè¯·æ±‚åªè´Ÿè´£å®Œæˆæ ¸å¿ƒçš„ã€å¿«é€Ÿçš„æ“ä½œï¼ˆåˆ›å»ºç”¨æˆ·ï¼‰ï¼Œç„¶åå°†åç»­çš„æ…¢é€Ÿä»»åŠ¡ï¼ˆå‘é€é‚®ä»¶ã€åˆå§‹åŒ–æ•°æ®ï¼‰ä½œä¸ºä¸€æ¡â€œæ¶ˆæ¯â€æˆ–â€œä½œä¸š(Job)â€æ¨é€åˆ°<strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ä¸­ã€‚</p>
<ul>
<li><strong>æ¶ˆæ¯é˜Ÿåˆ— (Message Queue)</strong>: å¦‚Redis, RabbitMQ, SQSã€‚å®ƒæ˜¯ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„æ¶ˆæ¯ç¼“å†²åŒºã€‚</li>
<li><strong>ç”Ÿäº§è€… (Producer)</strong>: ä½ çš„Webåº”ç”¨ï¼Œè´Ÿè´£å°†Jobæ¨é€åˆ°é˜Ÿåˆ—ã€‚</li>
<li><strong>æ¶ˆè´¹è€… (Consumer)</strong>: ä¸€ä¸ªæˆ–å¤šä¸ªåœ¨åå°è¿è¡Œçš„ã€ç‹¬ç«‹çš„<strong>Workerè¿›ç¨‹</strong>ï¼Œå®ƒä»¬æŒç»­ç›‘å¬é˜Ÿåˆ—ï¼Œå–å‡ºJobå¹¶æ‰§è¡Œã€‚</li>
</ul>
<p><strong>Laravel Queueså®æˆ˜</strong>:</p>
<ol>
<li>
<p><strong>åˆ›å»ºJob</strong>:
<code>php artisan make:job SendWelcomeEmail</code></p>
</li>
<li>
<p><strong>ç¼–å†™Job</strong>: Jobçš„æ ¸å¿ƒé€»è¾‘åœ¨<code>handle</code>æ–¹æ³•ä¸­ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// App/Jobs/SendWelcomeEmail.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SendWelcomeEmail</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">Dispatchable</span>, <span class="hljs-title">InteractsWithQueue</span>, <span class="hljs-title">Queueable</span>, <span class="hljs-title">SerializesModels</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> User <span class="hljs-variable">$user</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">Mailer <span class="hljs-variable">$mailer</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// è¿™é‡Œçš„ä»£ç å°†åœ¨åå°Workerè¿›ç¨‹ä¸­æ‰§è¡Œ</span>
        <span class="hljs-variable">$mailer</span>-&gt;<span class="hljs-title function_ invoke__">to</span>(<span class="hljs-variable">$this</span>-&gt;user-&gt;email)-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WelcomeEmail</span>(<span class="hljs-variable">$this</span>-&gt;user));
    }
}
</code></pre>
</li>
<li>
<p><strong>åˆ†å‘Job</strong>: åœ¨æ§åˆ¶å™¨ä¸­ï¼Œå°†Jobæ¨é€åˆ°é˜Ÿåˆ—ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// UserController.php</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span></span>)
</span>{
    <span class="hljs-comment">// ... åˆ›å»ºç”¨æˆ· ...</span>
    <span class="hljs-variable">$user</span> = <span class="hljs-title class_">User</span>::<span class="hljs-title function_ invoke__">create</span>(...);

    <span class="hljs-comment">// åˆ†å‘Jobåˆ°é˜Ÿåˆ—ï¼ŒWebè¯·æ±‚ç«‹å³è¿”å›å“åº”</span>
    <span class="hljs-title class_">SendWelcomeEmail</span>::<span class="hljs-title function_ invoke__">dispatch</span>(<span class="hljs-variable">$user</span>);
    <span class="hljs-title class_">InitializeAnalytics</span>::<span class="hljs-title function_ invoke__">dispatch</span>(<span class="hljs-variable">$user</span>-&gt;id);

    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">response</span>()-&gt;<span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'User registered!'</span>], <span class="hljs-number">201</span>);
}
</code></pre>
</li>
<li>
<p><strong>è¿è¡ŒWorker</strong>: åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨Workerè¿›ç¨‹æ¥å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚
<code>php artisan queue:work redis --tries=3</code></p>
</li>
</ol>
<p><strong>é«˜çº§é˜Ÿåˆ—æŠ€å·§</strong>:</p>
<ul>
<li><strong>Laravel Horizon</strong>: ä¸€ä¸ªä¸ºRedisé˜Ÿåˆ—è®¾è®¡çš„ã€åŠŸèƒ½å¼ºå¤§çš„å¯è§†åŒ–ä»ªè¡¨ç›˜å’Œé…ç½®ç³»ç»Ÿã€‚å®ƒèƒ½è®©ä½ å®æ—¶ç›‘æ§é˜Ÿåˆ—ååé‡ã€ä»»åŠ¡è€—æ—¶ã€å¤±è´¥ä»»åŠ¡ï¼Œå¹¶èƒ½è‡ªåŠ¨å¹³è¡¡Workerè¿›ç¨‹æ•°é‡ã€‚</li>
<li><strong>ä»»åŠ¡é“¾ (Chaining)</strong>: å®šä¹‰ä¸€ç»„å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œçš„Jobã€‚
<code>ProcessPodcast::withChain([new OptimizePodcast, new ReleasePodcast])-&gt;dispatch();</code></li>
<li><strong>æ‰¹å¤„ç† (Batches)</strong>: åŒæ—¶åˆ†å‘å¤§é‡Jobï¼Œå¹¶èƒ½åœ¨æ‰€æœ‰Jobéƒ½æˆåŠŸå®Œæˆåæ‰§è¡Œä¸€ä¸ªå›è°ƒã€‚éå¸¸é€‚åˆæµ·é‡æ•°æ®çš„å¹¶è¡Œå¤„ç†ã€‚
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$batch</span> = <span class="hljs-title class_">Bus</span>::<span class="hljs-title function_ invoke__">batch</span>([
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImportCsvChunk</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImportCsvChunk</span>(<span class="hljs-number">1001</span>, <span class="hljs-number">2000</span>),
    <span class="hljs-comment">// ...</span>
])-&gt;<span class="hljs-title function_ invoke__">then</span>(function (Batch <span class="hljs-variable">$batch</span>) {
    <span class="hljs-comment">// æ‰€æœ‰Jobéƒ½æˆåŠŸ...</span>
})-&gt;<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Batch <span class="hljs-variable">$batch</span>, <span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span></span>) </span>{
    <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå¤±è´¥çš„Jobä¼šè§¦å‘...</span>
})-&gt;<span class="hljs-title function_ invoke__">dispatch</span>();
</code></pre>
</li>
</ul>
<p>é€šè¿‡ç»“åˆä½¿ç”¨é«˜æ€§èƒ½åº”ç”¨æœåŠ¡å™¨å’Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç°ä»£PHPåº”ç”¨å¯ä»¥è½»æ¾åº”å¯¹ä»é«˜å¹¶å‘å®æ—¶é€šä¿¡åˆ°å¤§è§„æ¨¡æ•°æ®å¼‚æ­¥å¤„ç†çš„å„ç§å¤æ‚æŒ‘æˆ˜ã€‚</p>
<hr/>
<hr/>
<h4 data-id="heading-30">ç¬¬å…­éƒ¨åˆ†ï¼šåšä¸å¯æ‘§çš„ä»£ç è´¨é‡</h4>
<h5 data-id="heading-31">ç¬¬6ç« ï¼šåšä¸å¯æ‘§çš„ä»£ç è´¨é‡</h5>
<p>ç¼–å†™èƒ½å¤Ÿå·¥ä½œçš„ä»£ç åªæ˜¯ç¬¬ä¸€æ­¥ã€‚ç¼–å†™åœ¨æœªæ¥å‡ ä¸ªæœˆç”šè‡³å‡ å¹´å†…éƒ½æ˜“äºç»´æŠ¤ã€ä¸æ˜“å‡ºé”™ã€é«˜è´¨é‡çš„ä»£ç ï¼Œæ˜¯é«˜çº§å·¥ç¨‹å¸ˆçš„æ ¸å¿ƒä»·å€¼æ‰€åœ¨ã€‚æœ¬ç« å°†æ¢è®¨å¦‚ä½•é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·å’Œç°ä»£æµ‹è¯•èŒƒå¼æ¥æ„å»ºåšä¸å¯æ‘§çš„PHPåº”ç”¨ã€‚</p>
<h6 data-id="heading-32">6.1 é™æ€åˆ†æçš„æé™</h6>
<p>PHPä½œä¸ºä¸€é—¨åŠ¨æ€è¯­è¨€ï¼Œè®¸å¤šé”™è¯¯åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½è¢«å‘ç°ã€‚é™æ€åˆ†æå·¥å…·é€šè¿‡åœ¨ä¸å®é™…è¿è¡Œä»£ç çš„æƒ…å†µä¸‹åˆ†æä»£ç ï¼Œèƒ½å¤Ÿåœ¨ç¼–ç é˜¶æ®µå°±æ‰¾å‡ºæ½œåœ¨çš„bugã€é€»è¾‘é”™è¯¯å’Œä¸è§„èŒƒçš„å†™æ³•ã€‚</p>
<ul>
<li>
<p><strong>PHPStan &amp; Psalm</strong>: è¿™æ˜¯PHPç¤¾åŒºæœ€ä¸»æµçš„ä¸¤ä¸ªé™æ€åˆ†æå·¥å…·ã€‚å®ƒä»¬èƒ½æ£€æŸ¥å‡ºï¼š</p>
<ul>
<li>ç±»å‹é”™è¯¯ï¼ˆå¦‚å°†<code>string</code>ä¼ é€’ç»™éœ€è¦<code>int</code>çš„å‡½æ•°ï¼‰ã€‚</li>
<li>è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æˆ–å±æ€§ã€‚</li>
<li>æœªè¢«å¤„ç†çš„<code>null</code>å€¼å¯èƒ½å¯¼è‡´çš„é”™è¯¯ã€‚</li>
<li>â€œæ­»ä»£ç â€ï¼ˆæ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œçš„ä»£ç ï¼‰ã€‚</li>
<li>ä»¥åŠæ›´å¤šå¤æ‚çš„é€»è¾‘é—®é¢˜ã€‚</li>
</ul>
</li>
<li>
<p><strong>åˆ†æçº§åˆ« (Levels)</strong>:
è¿™ä¸¤ä¸ªå·¥å…·éƒ½æä¾›äº†ä»0åˆ°æœ€é«˜çº§ï¼ˆPHPStanä¸º9ï¼ŒPsalmä¸º1ï¼‰çš„â€œä¸¥æ ¼åº¦çº§åˆ«â€ã€‚çº§åˆ«0åªä¼šæŠ¥å‘Šæœ€æ˜æ˜¾çš„é”™è¯¯ï¼Œè€Œæœ€é«˜çº§åˆ«åˆ™ä¼šæ‰§è¡Œæå…¶ä¸¥æ ¼çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ç¡®ä¿æ•°ç»„è®¿é—®å‰å·²æ£€æŸ¥keyæ˜¯å¦å­˜åœ¨ã€‚</li>
<li>ç¡®ä¿ä»æ•°ç»„æˆ–æ³›å‹é›†åˆä¸­å–å‡ºçš„å€¼ç±»å‹æ˜¯æ˜ç¡®çš„ã€‚</li>
<li>å¼ºåˆ¶æ‰€æœ‰ä»£ç è·¯å¾„éƒ½æœ‰è¿”å›å€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>å®æˆ˜ç­–ç•¥ï¼šæ¸è¿›å¼å¢å¼º</strong>
å¯¹äºä¸€ä¸ªå·²å­˜åœ¨çš„é¡¹ç›®ï¼Œç›´æ¥å¼€å¯æœ€é«˜çº§åˆ«å¯èƒ½ä¼šäº§ç”Ÿæˆåƒä¸Šä¸‡ä¸ªé”™è¯¯ã€‚æ­£ç¡®çš„ç­–ç•¥æ˜¯ï¼š</p>
<ol>
<li><strong>ä»ä½çº§åˆ«å¼€å§‹</strong>: åœ¨<code>phpstan.neon</code>æˆ–<code>psalm.xml</code>ä¸­é…ç½®ä¸€ä¸ªè¾ƒä½çš„çº§åˆ«ï¼ˆå¦‚Level 2ï¼‰ï¼Œä¿®å¤æ‰€æœ‰æŠ¥å‘Šçš„é”™è¯¯ã€‚</li>
<li><strong>å»ºç«‹åŸºçº¿ (Baseline)</strong>: ä½¿ç”¨å‘½ä»¤ <code>phpstan analyse --generate-baseline</code> ç”Ÿæˆä¸€ä¸ªåŸºçº¿æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ä¼šåˆ—å‡ºå½“å‰æ‰€æœ‰å‰©ä½™çš„é”™è¯¯ï¼Œå¹¶å‘Šè¯‰PHPStanåœ¨æœªæ¥çš„åˆ†æä¸­â€œå¿½ç•¥â€è¿™äº›å·²å­˜åœ¨çš„é”™è¯¯ã€‚</li>
<li><strong>è°ƒè‡³æœ€é«˜çº§åˆ«</strong>: å°†é…ç½®æ–‡ä»¶ä¸­çš„<code>level</code>è°ƒè‡³æœ€é«˜ï¼ˆå¦‚8æˆ–9ï¼‰ã€‚ç°åœ¨ï¼Œé™æ€åˆ†æå°†å¯¹æ‰€æœ‰<strong>æ–°ç¼–å†™çš„æˆ–è¢«ä¿®æ”¹çš„</strong>ä»£ç æ‰§è¡Œæœ€ä¸¥æ ¼çš„æ£€æŸ¥ï¼Œè€Œè€ä»£ç ä¸­çš„é—®é¢˜åˆ™è¢«æš‚æ—¶æç½®ã€‚</li>
<li><strong>æŒç»­æ”¹è¿›</strong>: åœ¨æ—¥å¸¸å¼€å‘æˆ–é‡æ„ä¸­ï¼Œé€æ­¥ä¿®å¤åŸºçº¿æ–‡ä»¶ä¸­çš„é”™è¯¯ï¼Œå¹¶å°†å…¶ä»åŸºçº¿ä¸­ç§»é™¤ã€‚</li>
</ol>
</li>
<li>
<p><strong>è‡ªå®šä¹‰è§„åˆ™</strong>:
å½“å›¢é˜Ÿéœ€è¦å¼ºåˆ¶æ‰§è¡Œç‰¹å®šçš„æ¶æ„è§„åˆ™æ—¶ï¼ˆä¾‹å¦‚ï¼Œâ€œServiceå±‚ä¸èƒ½ç›´æ¥è°ƒç”¨Eloquent Modelâ€ï¼‰ï¼Œä½ å¯ä»¥ç¼–å†™è‡ªå®šä¹‰çš„PHPStanæˆ–Psalmè§„åˆ™ï¼Œå°†å…¶é›†æˆåˆ°CIæµç¨‹ä¸­ï¼Œå®ç°æ¶æ„çš„è‡ªåŠ¨åŒ–å®ˆæŠ¤ã€‚</p>
</li>
</ul>
<h6 data-id="heading-33">6.2 æµ‹è¯•æ–°èŒƒå¼</h6>
<p>è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ä¿è¯ä»£ç è´¨é‡çš„åŸºçŸ³ã€‚é™¤äº†ä¼ ç»Ÿçš„PHPUnitï¼Œä¸€äº›æ–°çš„å·¥å…·å’Œæ€æƒ³æ­£åœ¨è®©æµ‹è¯•å˜å¾—æ›´é«˜æ•ˆã€æ›´å…·è¡¨ç°åŠ›ã€‚</p>
<ul>
<li>
<p><strong>Pest: æ›´ä¼˜é›…çš„æµ‹è¯•æ¡†æ¶</strong>
Pestæ˜¯æ„å»ºäºPHPUnitä¹‹ä¸Šçš„ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼Œå®ƒæä¾›äº†æ›´ç®€æ´ã€æ›´æ³¨é‡å¯è¯»æ€§çš„DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰ã€‚</p>
<p><strong>PHPUnit é£æ ¼</strong>:</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TestCase</span>
</span>{
    <span class="hljs-comment">/** <span class="hljs-doctag">@test</span> */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a_user_can_create_a_post</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable">$user</span> = <span class="hljs-title class_">User</span>::<span class="hljs-title function_ invoke__">factory</span>()-&gt;<span class="hljs-title function_ invoke__">create</span>();
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">actingAs</span>(<span class="hljs-variable">$user</span>);
        
        <span class="hljs-variable">$response</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">'/posts'</span>, [<span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'New Post'</span>]);
        
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">assertDatabaseHas</span>(<span class="hljs-string">'posts'</span>, [<span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'New Post'</span>]);
    }
}
</code></pre>
<p><strong>Pest é£æ ¼</strong>:</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">test</span>(<span class="hljs-string">'a user can create a post'</span>, function () {
    <span class="hljs-variable">$user</span> = <span class="hljs-title class_">User</span>::<span class="hljs-title function_ invoke__">factory</span>()-&gt;<span class="hljs-title function_ invoke__">create</span>();
    <span class="hljs-title function_ invoke__">actingAs</span>(<span class="hljs-variable">$user</span>);
    
    <span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">'/posts'</span>, [<span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'New Post'</span>]);
    
    <span class="hljs-title function_ invoke__">assertDatabaseHas</span>(<span class="hljs-string">'posts'</span>, [<span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'New Post'</span>]);
});
</code></pre>
<p>Pesté€šè¿‡ä½¿ç”¨ç®€å•çš„å‡½æ•°ï¼ˆ<code>test</code>, <code>expect</code>ï¼‰å’Œè¾…åŠ©å‡½æ•°ï¼Œè®©æµ‹è¯•ä»£ç è¯»èµ·æ¥æ›´åƒè‡ªç„¶è¯­è¨€ã€‚å®ƒè¿˜æä¾›äº†å¼ºå¤§çš„æ•°æ®é›†ï¼ˆDatasetsï¼‰å’Œé«˜é˜¶æµ‹è¯•ï¼ˆHigher-Order Testsï¼‰åŠŸèƒ½ï¼Œå¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–æµ‹è¯•çš„ç¼–å†™ã€‚</p>
</li>
<li>
<p><strong>æ¶æ„æµ‹è¯• (Architecture Testing)</strong>
å¦‚ä½•è‡ªåŠ¨ç¡®ä¿ä½ çš„ä»£ç éµå¾ªæ—¢å®šçš„æ¶æ„è§„åˆ™ï¼Ÿä¾‹å¦‚â€œæ§åˆ¶å™¨ä¸èƒ½ç›´æ¥ä¸Eloquentæ¨¡å‹äº¤äº’ï¼Œå¿…é¡»é€šè¿‡æœåŠ¡å±‚â€ã€‚æ¶æ„æµ‹è¯•å°±æ˜¯ç­”æ¡ˆã€‚</p>
<p>Pestï¼ˆé€šè¿‡æ’ä»¶ï¼‰æˆ–ç‹¬ç«‹çš„<code>phparkitect/phparkitect</code>åº“å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// tests/Architecture/MyArchTest.php</span>
<span class="hljs-title function_ invoke__">test</span>(<span class="hljs-string">'controllers do not depend on eloquent models'</span>)
    -&gt;<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">'App\Http\Controllers'</span>)
    -&gt;<span class="hljs-title function_ invoke__">toNotUse</span>(<span class="hljs-string">'Illuminate\Database\Eloquent\Model'</span>);

<span class="hljs-title function_ invoke__">test</span>(<span class="hljs-string">'services are final'</span>)
    -&gt;<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">'App\Services'</span>)
    -&gt;<span class="hljs-title function_ invoke__">toBeFinal</span>();
</code></pre>
<p>è¿™äº›æµ‹è¯•ç”¨ä¾‹ä¼šåœ¨ä½ çš„CI/CDæµæ°´çº¿ä¸­è¿è¡Œã€‚ä¸€æ—¦æœ‰äººæäº¤äº†è¿åæ¶æ„è§„åˆ™çš„ä»£ç ï¼Œæ„å»ºå°±ä¼šå¤±è´¥ï¼Œä»è€Œåœ¨æ—©æœŸé˜¶æ®µå°±é˜²æ­¢äº†æ¶æ„çš„è…åŒ–ã€‚</p>
</li>
<li>
<p><strong>å˜å¼‚æµ‹è¯• (Mutation Testing)</strong>
100%çš„ä»£ç è¦†ç›–ç‡å¹¶ä¸èƒ½ä¿è¯ä½ çš„æµ‹è¯•æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåªè¯´æ˜ä½ çš„ä»£ç è¢«æ‰§è¡Œäº†ï¼Œä½†æ²¡è¯´æ–­è¨€æ˜¯å¦è¶³å¤Ÿå¼ºå£®ã€‚</p>
<p><strong>å˜å¼‚æµ‹è¯•</strong>æ˜¯è¡¡é‡æµ‹è¯•è´¨é‡çš„ç»ˆææ­¦å™¨ã€‚</p>
<ol>
<li><strong>å·¥å…·</strong>: <code>infection/infection</code></li>
<li><strong>åŸç†</strong>: Infectionä¼šè·å–ä½ çš„æºä»£ç ï¼Œå¹¶å¯¹å…¶è¿›è¡Œå¾®å°çš„ã€è‡ªåŠ¨åŒ–çš„ä¿®æ”¹ï¼ˆâ€œå˜å¼‚â€ï¼‰ï¼Œä¾‹å¦‚å°†<code>&gt;</code>å˜ä¸º<code>&gt;=</code>ï¼Œå°†<code>true</code>å˜ä¸º<code>false</code>ã€‚</li>
<li>ç„¶åï¼Œå®ƒè¿è¡Œä½ çš„æµ‹è¯•å¥—ä»¶ã€‚
<ul>
<li>å¦‚æœæµ‹è¯•<strong>å¤±è´¥</strong>äº†ï¼Œè¯´æ˜ä½ çš„æµ‹è¯•æˆåŠŸâ€œæ€æ­»â€äº†è¿™ä¸ªå˜å¼‚ä½“ã€‚è¿™æ˜¯<strong>å¥½äº‹</strong>ã€‚</li>
<li>å¦‚æœæµ‹è¯•<strong>ä»ç„¶é€šè¿‡</strong>ï¼Œè¯´æ˜è¿™ä¸ªå˜å¼‚ä½“â€œé€ƒé€¸â€äº†ã€‚è¿™æ˜¯<strong>åäº‹</strong>ï¼Œæ„å‘³ç€ä½ çš„æµ‹è¯•æ²¡æœ‰è¦†ç›–åˆ°è¿™ä¸ªé€»è¾‘è¾¹ç•Œï¼Œå­˜åœ¨æ¼æ´ã€‚</li>
</ul>
</li>
<li><strong>ç›®æ ‡</strong>: è¿½æ±‚ä¸€ä¸ªé«˜çš„<strong>MSI (Mutation Score Indicator)</strong>ï¼Œè¿™æ„å‘³ç€ä½ çš„æµ‹è¯•å¥—ä»¶å¯¹ä»£ç ä¸­çš„å¾®å°å˜åŒ–éå¸¸æ•æ„Ÿï¼Œè´¨é‡å¾ˆé«˜ã€‚</li>
</ol>
</li>
</ul>
<h6 data-id="heading-34">6.3 é‡æ„ä¸é—ç•™ä»£ç æ”¹é€ </h6>
<ul>
<li>
<p><strong>Rector: è‡ªåŠ¨åŒ–é‡æ„</strong>
Rectoræ˜¯ä¸€ä¸ªåŸºäºASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰çš„ä»£ç è½¬æ¢å·¥å…·ï¼Œå¯ä»¥å®‰å…¨ã€å¤§è§„æ¨¡åœ°å¯¹ä½ çš„ä»£ç åº“è¿›è¡Œè‡ªåŠ¨åŒ–é‡æ„ã€‚</p>
<p><strong>æ ¸å¿ƒåº”ç”¨åœºæ™¯</strong>:</p>
<ul>
<li><strong>PHP/æ¡†æ¶ç‰ˆæœ¬å‡çº§</strong>: Rectoræä¾›äº†é¢„è®¾çš„è§„åˆ™é›†ï¼Œå¯ä»¥è‡ªåŠ¨ä¿®å¤ä»PHP 7.4åˆ°8.2ï¼Œæˆ–ä»Laravel 8åˆ°10çš„å¤§éƒ¨åˆ†ç ´åæ€§å˜æ›´ã€‚</li>
<li><strong>åº”ç”¨ç°ä»£PHPç‰¹æ€§</strong>: è‡ªåŠ¨å°†æ—§çš„æ•°ç»„è¯­æ³•è½¬æ¢ä¸ºçŸ­æ•°ç»„è¯­æ³•ï¼Œå°†<code>switch</code>è½¬æ¢ä¸º<code>match</code>ï¼Œä¸ºDTOæ·»åŠ <code>readonly</code>ç­‰ã€‚</li>
<li><strong>å®æ–½è‡ªå®šä¹‰è§„åˆ™</strong>: ç¼–å†™ä½ è‡ªå·±çš„Rectorè§„åˆ™ï¼Œåœ¨æ•´ä¸ªä»£ç åº“ä¸­å®æ–½ç‰¹å®šçš„ä»£ç é£æ ¼æˆ–æ¶æ„æ¨¡å¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç»æ€è€…æ— èŠ±æœæ¨¡å¼ (Strangler Fig Pattern)</strong>
åœ¨é¢å¯¹ä¸€ä¸ªå·¨å¤§ã€é™ˆæ—§çš„å•ä½“åº”ç”¨æ—¶ï¼Œç›´æ¥é‡å†™é€šå¸¸é£é™©æé«˜ä¸”å‘¨æœŸæ¼«é•¿ã€‚ç»æ€è€…æ¨¡å¼æä¾›äº†ä¸€ç§æ›´å¹³æ»‘çš„è¿ç§»ç­–ç•¥ã€‚</p>
<ol>
<li><strong>è¯†åˆ«è¾¹ç•Œ</strong>: åœ¨é—ç•™ç³»ç»Ÿä¸­è¯†åˆ«å‡ºä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„ä¸šåŠ¡æ¨¡å—ï¼ˆå¦‚â€œç”¨æˆ·é€šçŸ¥â€ï¼‰ã€‚</li>
<li><strong>åˆ›å»ºæ–°æœåŠ¡</strong>: ä½¿ç”¨ç°ä»£æŠ€æœ¯æ ˆï¼ˆå¦‚Laravel 11, DDD Liteï¼‰æ„å»ºä¸€ä¸ªæ–°çš„ã€ç‹¬ç«‹çš„é€šçŸ¥æœåŠ¡ã€‚</li>
<li><strong>è®¾ç½®ä»£ç†/è·¯ç”±</strong>: åœ¨é—ç•™ç³»ç»Ÿçš„å…¥å£å¤„ï¼ˆå¦‚Nginx, API Gatewayæˆ–åº”ç”¨å†…çš„ä¸€ä¸ªè·¯ç”±å±‚ï¼‰è®¾ç½®ä¸€ä¸ªä»£ç†ã€‚å°†æ‰€æœ‰å‘å¾€â€œç”¨æˆ·é€šçŸ¥â€åŠŸèƒ½çš„è¯·æ±‚ï¼Œé€æ˜åœ°è·¯ç”±åˆ°æ–°çš„æœåŠ¡ä¸Šã€‚æ‰€æœ‰å…¶ä»–è¯·æ±‚ä»ç„¶ç”±é—ç•™ç³»ç»Ÿå¤„ç†ã€‚</li>
<li><strong>è¿­ä»£</strong>: é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œé€æ­¥ç”¨æ–°çš„ã€ç°ä»£çš„æœåŠ¡â€œåŒ…è£¹â€å¹¶â€œç»æ€â€é—ç•™ç³»ç»Ÿã€‚</li>
<li><strong>é€€å½¹</strong>: å½“æ‰€æœ‰åŠŸèƒ½éƒ½è¢«æ–°æœåŠ¡æ›¿ä»£åï¼Œé—ç•™ç³»ç»Ÿå°±å¯ä»¥å®‰å…¨ä¸‹çº¿äº†ã€‚</li>
</ol>
</li>
</ul>
<hr/>
<hr/>
<h4 data-id="heading-35">ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå·¥ç¨‹åŒ–ä¸å¯è§‚æµ‹æ€§ (Engineering &amp; Observability)</h4>
<h5 data-id="heading-36">ç¬¬7ç« ï¼šç°ä»£DevOpsæµç¨‹</h5>
<h6 data-id="heading-37">7.1 å¼€å‘æµç¨‹çš„èµ·ç‚¹ï¼šä½¿ç”¨Composerä½œä¸ºä»»åŠ¡è¿è¡Œå™¨</h6>
<p>åœ¨æ·±å…¥CI/CDä¹‹å‰ï¼Œä¸€ä¸ªé«˜æ•ˆã€ç»Ÿä¸€çš„æœ¬åœ°å¼€å‘ç¯å¢ƒæ˜¯åŸºç¡€ã€‚<code>composer.json</code>ä¸­çš„<code>"scripts"</code>éƒ¨åˆ†æ˜¯ä¸€ä¸ªç»å¸¸è¢«ä½ä¼°çš„å¼ºå¤§åŠŸèƒ½ï¼Œå®ƒèƒ½å°†é¡¹ç›®ä¸­å„ç§é›¶æ•£çš„å‘½ä»¤è¡Œå·¥å…·è°ƒç”¨ç»Ÿä¸€èµ·æ¥ã€‚</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>: ä¸ºå¸¸ç”¨çš„ã€å¤æ‚çš„å‘½ä»¤åˆ›å»ºç®€çŸ­ã€æ˜“è®°çš„åˆ«åã€‚</p>
</li>
<li>
<p><strong>å®æˆ˜åº”ç”¨</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vendor/bin/pest --coverage"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test-feature"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vendor/bin/pest --group=feature"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vendor/bin/pint"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"analyse"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vendor/bin/phpstan analyse --memory-limit=2G"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"ci-check"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"@lint"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"@analyse"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"@test"</span>
    <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å¥½å¤„</strong>:</p>
<ol>
<li><strong>ç»Ÿä¸€å‘½ä»¤</strong>: å›¢é˜Ÿæ‰€æœ‰æˆå‘˜ï¼ˆåŒ…æ‹¬æ–°åŠ å…¥çš„æˆå‘˜ï¼‰éƒ½æ— éœ€è®°å¿†å…·ä½“çš„å·¥å…·å’Œå‚æ•°ï¼Œåªéœ€è¿è¡Œ<code>composer test</code>, <code>composer lint</code>ç­‰ã€‚</li>
<li><strong>ç®€åŒ–CIé…ç½®</strong>: CI/CDæµæ°´çº¿ä¸­çš„è„šæœ¬å¯ä»¥å˜å¾—éå¸¸ç®€æ´ï¼Œåªéœ€æ‰§è¡Œ<code>composer ci-check</code>å³å¯è¿è¡Œæ‰€æœ‰ä»£ç è´¨é‡æ£€æŸ¥ã€‚</li>
<li><strong>éš”ç¦»å·¥å…·æ›´æ–°</strong>: å¦‚æœæœªæ¥å°†<code>pint</code>æ¢æˆ<code>php-cs-fixer</code>ï¼Œä½ åªéœ€è¦ä¿®æ”¹<code>composer.json</code>ä¸­çš„<code>lint</code>è„šæœ¬ï¼Œè€Œå›¢é˜Ÿæˆå‘˜å’ŒCIè„šæœ¬çš„è°ƒç”¨æ–¹å¼å®Œå…¨ä¸å˜ã€‚</li>
</ol>
</li>
</ul>
<h6 data-id="heading-38">7.2 å®¹å™¨åŒ–éƒ¨ç½²</h6>
<p>Dockerå·²ç»æˆä¸ºç°ä»£åº”ç”¨éƒ¨ç½²çš„æ ‡å‡†ã€‚å®ƒå°†åº”ç”¨åŠå…¶æ‰€æœ‰ä¾èµ–ï¼ˆPHPç‰ˆæœ¬ã€æ‰©å±•ã€ç³»ç»Ÿåº“ï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„é•œåƒä¸­ï¼Œç¡®ä¿äº†å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒçš„å®Œå…¨ä¸€è‡´ã€‚</p>
<p><strong>ç¼–å†™ç”Ÿäº§çº§çš„<code>Dockerfile</code></strong>:</p>
<p>ä¸€ä¸ªç”Ÿäº§çº§çš„<code>Dockerfile</code>åº”è¯¥å…³æ³¨é•œåƒå¤§å°ã€æ„å»ºé€Ÿåº¦å’Œå®‰å…¨æ€§ã€‚<strong>å¤šé˜¶æ®µæ„å»º (Multi-stage builds)</strong> æ˜¯å®ç°è¿™ä¸€ç›®æ ‡çš„å…³é”®ã€‚</p>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># --- Stage 1: Builder ---
# ä½¿ç”¨åŒ…å«æ‰€æœ‰æ„å»ºå·¥å…·çš„å®˜æ–¹é•œåƒ
FROM php:8.2-fpm as builder

# å®‰è£…ç³»ç»Ÿä¾èµ–å’ŒPHPæ‰©å±•
RUN apt-get update &amp;&amp; apt-get install -y ... \
    &amp;&amp; docker-php-ext-install pdo_mysql bcmath ...

# å®‰è£…Composer
COPY --from=composer:latest /usr/bin/composer /usr/bin/composer

# å¤åˆ¶åº”ç”¨ä»£ç 
WORKDIR /app
COPY . .

# å®‰è£…Composerä¾èµ–ï¼Œ--no-devè¡¨ç¤ºä¸å®‰è£…å¼€å‘ä¾èµ–
RUN composer install --no-dev --optimize-autoloader

# --- Stage 2: Final Image ---
# ä½¿ç”¨ä¸€ä¸ªå¹²å‡€ã€è½»é‡çš„åŸºç¡€é•œåƒ
FROM php:8.2-fpm-alpine

# åªå®‰è£…ç”Ÿäº§ç¯å¢ƒå¿…éœ€çš„PHPæ‰©å±•
RUN docker-php-ext-install pdo_mysql

# åˆ›å»ºä¸€ä¸ªérootç”¨æˆ·æ¥è¿è¡Œåº”ç”¨ï¼Œå¢å¼ºå®‰å…¨æ€§
RUN addgroup -S myapp &amp;&amp; adduser -S myapp -G myapp
USER myapp

WORKDIR /app

# ä»builderé˜¶æ®µå¤åˆ¶ä¼˜åŒ–è¿‡çš„Composerä¾èµ–å’Œåº”ç”¨ä»£ç 
COPY --from=builder /app/vendor ./vendor
COPY --from=builder /app .

# æš´éœ²PHP-FPMç«¯å£
EXPOSE 9000

# å¯åŠ¨PHP-FPM
CMD ["php-fpm"]
</code></pre>
<p>è¿™ä¸ª<code>Dockerfile</code>é€šè¿‡ä¸¤ä¸ªé˜¶æ®µï¼Œæœ€ç»ˆç”Ÿæˆäº†ä¸€ä¸ªä¸å«æ„å»ºå·¥å…·ã€ä½“ç§¯æ›´å°ã€æ›´å®‰å…¨çš„ç”Ÿäº§é•œåƒã€‚</p>
<h6 data-id="heading-39">7.3 CI/CD æœ€ä½³å®è·µ</h6>
<p>æŒç»­é›†æˆï¼ˆCIï¼‰å’ŒæŒç»­éƒ¨ç½²ï¼ˆCDï¼‰æ˜¯è‡ªåŠ¨åŒ–è½¯ä»¶äº¤ä»˜æµç¨‹çš„æ ¸å¿ƒã€‚</p>
<p><strong>ä½¿ç”¨GitHub Actionsæ„å»ºCIæµæ°´çº¿</strong>:</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„PHPåº”ç”¨CIå·¥ä½œæµæ–‡ä»¶ï¼ˆ<code>.github/workflows/ci.yml</code>ï¼‰:</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">PHP</span> <span class="hljs-string">CI</span>

<span class="hljs-attr">on:</span> [<span class="hljs-string">push</span>, <span class="hljs-string">pull_request</span>]

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">build-and-test:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span> <span class="hljs-string">code</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">PHP</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">shivammathur/setup-php@v2</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">php-version:</span> <span class="hljs-string">'8.2'</span>
          <span class="hljs-attr">extensions:</span> <span class="hljs-string">dom,</span> <span class="hljs-string">curl,</span> <span class="hljs-string">libxml,</span> <span class="hljs-string">mbstring,</span> <span class="hljs-string">zip,</span> <span class="hljs-string">pcntl,</span> <span class="hljs-string">pdo,</span> <span class="hljs-string">sqlite,</span> <span class="hljs-string">pdo_sqlite</span>
          <span class="hljs-attr">coverage:</span> <span class="hljs-string">xdebug</span> <span class="hljs-comment"># å¯ç”¨Xdebugç”¨äºä»£ç è¦†ç›–ç‡</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Composer</span> <span class="hljs-string">dependencies</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">composer</span> <span class="hljs-string">install</span> <span class="hljs-string">--prefer-dist</span> <span class="hljs-string">--no-progress</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">Security</span> <span class="hljs-string">Audit</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">composer</span> <span class="hljs-string">audit</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">All</span> <span class="hljs-string">Checks</span> <span class="hljs-string">(Lint,</span> <span class="hljs-string">Static</span> <span class="hljs-string">Analysis,</span> <span class="hljs-string">Tests)</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">composer</span> <span class="hljs-string">ci-check</span>
</code></pre>
<p>è¿™ä¸ªæµæ°´çº¿ç¡®ä¿äº†æ¯æ¬¡ä»£ç æäº¤éƒ½ä¼šè‡ªåŠ¨æ‰§è¡Œï¼š</p>
<ol>
<li><strong>ä¾èµ–å®‰å…¨å®¡è®¡</strong></li>
<li><strong>ä»£ç é£æ ¼æ£€æŸ¥ (Lint)</strong></li>
<li><strong>é™æ€åˆ†æ</strong></li>
<li><strong>è‡ªåŠ¨åŒ–æµ‹è¯•</strong></li>
</ol>
<p>åªæœ‰å½“æ‰€æœ‰æ£€æŸ¥éƒ½é€šè¿‡æ—¶ï¼Œä»£ç æ‰è¢«è®¤ä¸ºæ˜¯å¯åˆå¹¶çš„ï¼Œä»è€Œä¿è¯äº†ä¸»åˆ†æ”¯çš„å¥åº·ã€‚</p>
<hr/>
<h5 data-id="heading-40">ç¬¬8ç« ï¼šç”Ÿäº§ç¯å¢ƒå¯è§‚æµ‹æ€§ (Observability)</h5>
<p>å½“åº”ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒå‡ºç°é—®é¢˜æ—¶ï¼Œâ€œç™»å½•æœåŠ¡å™¨çœ‹æ—¥å¿—â€çš„æ–¹å¼å·²ç»è¿‡æ—¶ã€‚ç°ä»£çš„å¯è§‚æµ‹æ€§ä½“ç³»åŒ…å«ä¸‰å¤§æ”¯æŸ±ï¼š<strong>æ—¥å¿— (Logging)</strong>ã€<strong>æŒ‡æ ‡ (Metrics)</strong> å’Œ <strong>é“¾è·¯è¿½è¸ª (Tracing)</strong>ã€‚</p>
<h6 data-id="heading-41">8.1 æ—¥å¿— (Logging)</h6>
<ul>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>: å°†æ‰€æœ‰æ—¥å¿—ï¼ˆåº”ç”¨æ—¥å¿—ã€Nginxè®¿é—®æ—¥å¿—ã€æ•°æ®åº“æ—¥å¿—ç­‰ï¼‰ä»¥<strong>ç»“æ„åŒ–</strong>çš„æ ¼å¼ï¼ˆå¦‚JSONï¼‰å‘é€åˆ°ä¸€ä¸ªé›†ä¸­çš„æ—¥å¿—ç®¡ç†ç³»ç»Ÿã€‚</li>
<li><strong>ç»“æ„åŒ–æ—¥å¿—</strong>:
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ä½¿ç”¨Monolog</span>
<span class="hljs-variable">$log</span>-&gt;<span class="hljs-title function_ invoke__">info</span>(<span class="hljs-string">'User registered successfully.'</span>, [
    <span class="hljs-string">'user_id'</span> =&gt; <span class="hljs-variable">$user</span>-&gt;id,
    <span class="hljs-string">'source'</span> =&gt; <span class="hljs-string">'web_registration'</span>,
]);
</code></pre>
è¿™ä¼šç”Ÿæˆç±»ä¼¼<code>{"message": "User registered...", "context": {"user_id": 123, ...}}</code>çš„JSONæ—¥å¿—ã€‚ç»“æ„åŒ–ä½¿å¾—æ—¥å¿—å¯ä»¥è¢«è½»æ¾åœ°æœç´¢ã€ç­›é€‰å’Œèšåˆã€‚</li>
<li><strong>å·¥å…·æ ˆ</strong>:
<ul>
<li><strong>ELK Stack</strong>: Elasticsearch (å­˜å‚¨å’Œæœç´¢), Logstash (æ”¶é›†å’Œå¤„ç†), Kibana (å¯è§†åŒ–)ã€‚</li>
<li><strong>Loki</strong>: Grafanaæ¨å‡ºçš„è½»é‡çº§ã€ä½æˆæœ¬çš„æ›¿ä»£æ–¹æ¡ˆã€‚</li>
</ul>
</li>
</ul>
<h6 data-id="heading-42">8.2 æŒ‡æ ‡ (Metrics)</h6>
<ul>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>: æŒ‡æ ‡æ˜¯å…³äºç³»ç»Ÿåœ¨ä¸€æ®µæ—¶é—´å†…è¡Œä¸ºçš„ã€å¯èšåˆçš„<strong>æ•°å­—</strong>æ•°æ®ã€‚ä¾‹å¦‚ï¼šQPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰ã€è¯·æ±‚å¹³å‡è€—æ—¶ã€é˜Ÿåˆ—ä»»åŠ¡æ•°é‡ã€CPUä½¿ç”¨ç‡ã€‚</li>
<li><strong>å·¥å…·æ ˆ</strong>:
<ul>
<li><strong>Prometheus</strong>: ä¸€ä¸ªå¼€æºçš„ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿï¼Œå®ƒä»¥æ—¶é—´åºåˆ—çš„æ–¹å¼æ‹‰å–ï¼ˆpullï¼‰å’Œå­˜å‚¨æŒ‡æ ‡ã€‚</li>
<li><strong>Grafana</strong>: ä¸€ä¸ªå¼€æºçš„å¯è§†åŒ–å¹³å°ï¼Œå¯ä»¥è¿æ¥åˆ°Prometheusç­‰æ•°æ®æºï¼Œåˆ›å»ºæ¼‚äº®ã€åŠŸèƒ½å¼ºå¤§çš„ä»ªè¡¨ç›˜ã€‚</li>
</ul>
</li>
<li><strong>å®æˆ˜åº”ç”¨</strong>:
ä½¿ç”¨<code>prom-client-php</code>ç­‰åº“ï¼Œåœ¨ä½ çš„PHPåº”ç”¨ä¸­æš´éœ²ä¸€ä¸ª<code>/metrics</code>ç«¯ç‚¹ï¼ŒPrometheusä¼šå®šæœŸè®¿é—®è¿™ä¸ªç«¯ç‚¹æ¥æŠ“å–æŒ‡æ ‡ã€‚
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// è®°å½•ä¸€æ¬¡è®¢å•åˆ›å»º</span>
<span class="hljs-variable">$counter</span> = <span class="hljs-variable">$registry</span>-&gt;<span class="hljs-title function_ invoke__">getOrRegisterCounter</span>(<span class="hljs-string">'myapp'</span>, <span class="hljs-string">'orders_created'</span>, <span class="hljs-string">'Counts orders created'</span>);
<span class="hljs-variable">$counter</span>-&gt;<span class="hljs-title function_ invoke__">inc</span>();

<span class="hljs-comment">// è®°å½•ä¸€æ¬¡APIè¯·æ±‚è€—æ—¶</span>
<span class="hljs-variable">$histogram</span> = <span class="hljs-variable">$registry</span>-&gt;<span class="hljs-title function_ invoke__">getOrRegisterHistogram</span>(<span class="hljs-string">'myapp'</span>, <span class="hljs-string">'api_request_latency_seconds'</span>, <span class="hljs-string">'API request latency'</span>);
<span class="hljs-variable">$histogram</span>-&gt;<span class="hljs-title function_ invoke__">observe</span>(<span class="hljs-variable">$duration</span>);
</code></pre>
</li>
</ul>
<h6 data-id="heading-43">8.3 é“¾è·¯è¿½è¸ª (Tracing)</h6>
<ul>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>: åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªç”¨æˆ·è¯·æ±‚å¯èƒ½ä¼šæµç»å¤šä¸ªæœåŠ¡ã€‚é“¾è·¯è¿½è¸ªå°†è¿™ä¸ªè¯·æ±‚çš„å®Œæ•´æ—…ç¨‹ï¼ˆtraceï¼‰ä¸²è”èµ·æ¥ï¼Œè®©ä½ èƒ½æ¸…æ™°åœ°çœ‹åˆ°è¯·æ±‚åœ¨æ¯ä¸ªæœåŠ¡ä¸­çš„è€—æ—¶ã€è°ƒç”¨å…³ç³»å’Œé”™è¯¯ã€‚</li>
<li><strong>æ ¸å¿ƒæ¦‚å¿µ</strong>:
<ul>
<li><strong>Trace</strong>: ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚é“¾è·¯ã€‚</li>
<li><strong>Span</strong>: é“¾è·¯ä¸­çš„ä¸€ä¸ªå·¥ä½œå•å…ƒï¼ˆå¦‚ä¸€æ¬¡HTTPè°ƒç”¨ã€ä¸€æ¬¡æ•°æ®åº“æŸ¥è¯¢ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>å·¥å…·æ ˆ</strong>:
<ul>
<li><strong>OpenTelemetry</strong>: ä¸€ä¸ªå¼€æ”¾çš„ã€å‚å•†ä¸­ç«‹çš„æ ‡å‡†å’Œå·¥å…·é›†ï¼Œç”¨äºé‡‡é›†å’Œå¯¼å‡ºé¥æµ‹æ•°æ®ï¼ˆtraces, metrics, logsï¼‰ã€‚</li>
<li><strong>Jaeger / Zipkin</strong>: å¼€æºçš„åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿï¼Œç”¨äºå­˜å‚¨å’Œå¯è§†åŒ–Traceæ•°æ®ã€‚</li>
</ul>
</li>
<li><strong>å®æˆ˜åº”ç”¨</strong>:
é€šè¿‡åœ¨åº”ç”¨ä¸­é›†æˆOpenTelemetry SDKï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åœ°ä¸ºè¿›å…¥çš„HTTPè¯·æ±‚ã€å‘å‡ºçš„HTTPå®¢æˆ·ç«¯è°ƒç”¨ã€æ•°æ®åº“æŸ¥è¯¢ç­‰åˆ›å»ºSpanï¼Œå¹¶å°†å®ƒä»¬å…³è”èµ·æ¥ã€‚å½“ä½ åœ¨Jaeger UIä¸­æŸ¥çœ‹ä¸€ä¸ªTraceæ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªç€‘å¸ƒå›¾ï¼Œæ¸…æ™°åœ°å±•ç¤ºäº†â€œç”¨æˆ·è¯·æ±‚ -&gt; APIç½‘å…³ (20ms) -&gt; ç”¨æˆ·æœåŠ¡ (50ms) -&gt; æ•°æ®åº“æŸ¥è¯¢ (15ms)â€ï¼Œè®©ä½ èƒ½å¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆã€‚</li>
</ul>
<p>é€šè¿‡å»ºç«‹å®Œå–„çš„å¯è§‚æµ‹æ€§ä½“ç³»ï¼Œä½ å°†ä»è¢«åŠ¨åœ°å“åº”æ•…éšœï¼Œè½¬å˜ä¸ºä¸»åŠ¨åœ°å‘ç°å’Œé¢„é˜²é—®é¢˜ï¼Œä»è€Œç¡®ä¿ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šå’Œé«˜æ•ˆã€‚</p>
<hr/>
<h4 data-id="heading-44">é™„å½•</h4>
<ul>
<li>A. æ¨èçš„PHPèµ„æº (åšå®¢ã€ç¤¾åŒºã€å¤§ç¥)</li>
<li>B. PSR è§„èŒƒé€ŸæŸ¥è¡¨</li>
<li>C. å¸¸ç”¨è®¾è®¡æ¨¡å¼ä»£ç ç¤ºä¾‹</li>
</ul>
<pre><code class="hljs"/></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» â€œç¿»é¡µä¹¦â€ åˆ° â€œé­”æœ¯ç›’â€ï¼šReact è·¯ç”±å‡­å•¥å¦‚æ­¤ä¸æ»‘ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7584740835368353846</link>    <guid>https://juejin.cn/post/7584740835368353846</guid>    <pubDate>2025-12-18T03:16:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584740835368353846" data-draft-id="7584320417306738739" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» â€œç¿»é¡µä¹¦â€ åˆ° â€œé­”æœ¯ç›’â€ï¼šReact è·¯ç”±å‡­å•¥å¦‚æ­¤ä¸æ»‘ï¼Ÿ"/> <meta itemprop="keywords" content="React.js,å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-18T03:16:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£æ­¢ä½•å®‰å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/2517239724512420"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» â€œç¿»é¡µä¹¦â€ åˆ° â€œé­”æœ¯ç›’â€ï¼šReact è·¯ç”±å‡­å•¥å¦‚æ­¤ä¸æ»‘ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2517239724512420/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£æ­¢ä½•å®‰å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:16:16.000Z" title="Thu Dec 18 2025 03:16:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼šä½ æ‰“å¼€ä¸€ä¸ªç½‘ç«™ï¼Œä» â€œé¦–é¡µâ€ ç‚¹åˆ° â€œä¸ªäººä¸­å¿ƒâ€ï¼Œé¡µé¢è¿ä¸ªç™½å±éƒ½æ²¡æœ‰ â€”â€” è¿™ä¸æ˜¯é­”æ³•ï¼Œæ˜¯ <strong>å•é¡µåº”ç”¨ï¼ˆSPAï¼‰</strong> çš„ â€œå°å¿ƒæœºâ€ã€‚è€Œè®© SPA å®ç° â€œç½‘å€å˜ã€å†…å®¹æ¢â€ çš„å¹•åå¤§ä½¬ï¼Œå°±æ˜¯ä»Šå¤©è¦å” çš„Â <strong>React Router</strong>ã€‚æˆ‘ä»Šå¤©ä»¥ä¸€ä¸ª<strong>åå°ç®¡ç†ç³»ç»Ÿ</strong>æ¥å…¨æ–¹ä½çš„æ‹†è§£<strong>è·¯ç”±</strong>çš„ç»†èŠ‚~</p>
<p>æƒ³è¦è¯¦ç»†<code>React Router</code>èµ„æ–™å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Freactrouter.com" target="_blank" title="https://reactrouter.com" ref="nofollow noopener noreferrer">reactrouter.com</a></p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€ä» â€œå¤šé¡µç¿»ä¹¦â€ åˆ° â€œå•é¡µå˜é­”æœ¯â€</h3>
<p>æ—©å¹´é—´çš„ç½‘ç«™æ˜¯ <strong>â€œå¤šé¡µåº”ç”¨â€</strong>ï¼šç‚¹ä¸ªé“¾æ¥è·³è½¬åˆ°æ–° HTML æ–‡ä»¶ï¼Œåƒç¿»ä¹¦ä¼¼çš„ â€œå”°å”°â€ æ¢é¡µã€‚ä½†ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼šåŠ è½½æ…¢ã€ä½“éªŒå¡ï¼Œå°±åƒç¿»ä¸€æœ¬ 500 é¡µçš„å­—å…¸æ‰¾ä¸ªè¯ï¼Œç¿»åŠå¤©æ‰‹éƒ½é…¸äº†ã€‚</p>
<p>ç°åœ¨çš„ SPA æ˜¯ <strong>â€œå•é¡µé­”æœ¯ç›’â€ï¼šåªæœ‰ä¸€ä¸ª HTML æ–‡ä»¶</strong>ï¼Œç½‘å€å˜äº†ï¼Œåªæ˜¯æŠŠå¯¹åº”çš„ â€œç»„ä»¶â€ å¡è¿›è¿™ä¸ªç›’å­é‡Œ â€”â€” å°±åƒå˜é­”æœ¯æ—¶ä»ç›’å­é‡Œæå‡ºä¸åŒé“å…·ï¼Œç›’å­æœ¬èº«æ ¹æœ¬ä¸åŠ¨ã€‚</p>
<p>æ¯”å¦‚æˆ‘å†™çš„è¿™ä¸ª<strong>åå°ç®¡ç†ç³»ç»Ÿ</strong>ï¼š</p>
<ul>
<li>è®¿é—®Â <code>http://localhost:5173/login</code>Â â†’ å¡è¿›ã€Œç™»å½•ç»„ä»¶ã€</li>
<li>è®¿é—®Â <code>http://localhost:5173/home</code>Â â†’ å¡è¿›ã€Œé¦–é¡µç»„ä»¶ã€ç½‘å€å˜ï¼Œå†…å®¹ç§’åˆ‡ï¼Œä¸æ»‘åˆ°åƒå¾·èŠ™å¹¿å‘Šï½</li>
</ul>
<h3 data-id="heading-2">äºŒã€React Routerï¼šSPA çš„ â€œå¯¼èˆªæŒ‡æŒ¥å®¶â€</h3>
<p>è¦å®ç°è¿™ç§ â€œç§’åˆ‡â€ï¼Œå¾—è¯·å‡º<code>react-router-dom</code>è¿™ä¸ª â€œæŒ‡æŒ¥å®¶â€ã€‚å®ƒçš„æ ¸å¿ƒæˆå‘˜æœ‰è¿™äº›ï¼ˆç»“åˆæˆ‘ä»¬çš„åå°ç³»ç»Ÿä»£ç æ¥çœ‹æ›´çˆ½ï¼‰ï¼š</p>
<p>é¦–å…ˆä½ éœ€è¦å®‰è£…å¥½<code>react-router</code>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/982fdb3297ab4c2b864db5ea45230ccc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632576&amp;x-signature=fHo4sC9UR%2B2dRvIT9VpZJ32VJBg%3D" alt="image.png" loading="lazy"/></p>
<p>å°±åœ¨æˆ‘å¼€å¤´ç»™çš„ç½‘å€é‡Œé¢å°±å¯ä»¥æ‰¾åˆ°å“ˆï¼</p>
<h4 data-id="heading-3">1.Â <code>BrowserRouter</code>ï¼šç»™åº”ç”¨ â€œè£…ä¸ªå¯¼èˆªç³»ç»Ÿâ€</h4>
<p>å®ƒæ˜¯è·¯ç”±çš„ <strong>â€œå®¹å™¨â€</strong>ï¼Œç›¸å½“äºç»™æ•´ä¸ªåº”ç”¨è£…äº†ä¸ª <strong>â€œå¯¼èˆªå¤§è„‘â€</strong>ï¼ˆç”¨çš„æ˜¯ HTML5 çš„ History APIï¼Œæ‰€ä»¥ç½‘å€é•¿å¾—åƒæ­£å¸¸ç½‘å€ï¼‰ã€‚</p>
<p>çœ‹<code>App.jsx</code>çš„å¼€å¤´ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BrowserRouter</span>, <span class="hljs-title class_">Routes</span>, <span class="hljs-title class_">Route</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">BrowserRouter</span>&gt;</span> {/* æ‰€æœ‰è·¯ç”±é…ç½®éƒ½å¾—åŒ…åœ¨å®ƒé‡Œé¢ */}
            <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
                {/* è¿™é‡Œå¡å„ç§è·¯ç”±è§„åˆ™ */}
            <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">BrowserRouter</span>&gt;</span></span>
    )
}
</code></pre>
<h4 data-id="heading-4">2.Â <code>Routes + Route</code>ï¼šç»™ â€œç»„ä»¶â€ è´´ â€œç½‘å€æ ‡ç­¾â€</h4>
<p><code>Routes</code>æ˜¯ â€œè·¯ç”±å‡ºå£â€ï¼Œ<code>Route</code>æ˜¯ <strong>â€œç½‘å€â†’ç»„ä»¶â€</strong> çš„æ ‡ç­¾è´´ã€‚æ¯”å¦‚æˆ‘ä»¬çš„åå°ç³»ç»Ÿï¼Œç»™ <strong>ã€Œç™»å½•é¡µã€ã€Œé¦–é¡µã€</strong> è´´æ ‡ç­¾ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">Routes</span>&gt;
    {<span class="hljs-comment">/* æ ¹è·¯å¾„ç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µ */</span>}
    &lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/login"</span> /&gt;</span></span>} /&gt;
    
    {<span class="hljs-comment">/* è®¿é—®/login â†’ æ˜¾ç¤ºLoginç»„ä»¶ï¼ˆå°±æ˜¯æˆ‘ä»¬å†™çš„ç™»å½•ç•Œé¢ï¼‰ */</span>}
    &lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/login"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Login</span> /&gt;</span></span>} /&gt;
    
    {<span class="hljs-comment">/* è®¿é—®/home â†’ æ˜¾ç¤ºHomeç»„ä»¶ï¼ˆé¦–é¡µï¼‰ï¼ŒåŒæ—¶å®ƒæ˜¯äºŒçº§è·¯ç”±çš„å®¹å™¨ */</span>}
    &lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/home"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Home</span> /&gt;</span></span>}&gt;
        {<span class="hljs-comment">/* äºŒçº§è·¯ç”±ï¼š/home/class â†’ æ˜¾ç¤ºClassç»„ä»¶ */</span>}
        &lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"class"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Class</span> /&gt;</span></span>} /&gt;
        {<span class="hljs-comment">/* äºŒçº§è·¯ç”±ï¼š/home/leetcode â†’ æ˜¾ç¤ºLeetCodeç»„ä»¶ */</span>}
        &lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"leetcode"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LeetCode</span> /&gt;</span></span>} /&gt;
    &lt;/<span class="hljs-title class_">Route</span>&gt;
    
    {<span class="hljs-comment">/* 404é¡µé¢ï¼šåŒ¹é…ä¸åˆ°çš„ç½‘å€éƒ½æ˜¾ç¤ºè¿™ä¸ª */</span>}
    &lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"*"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>NOT FOUND<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span>} /&gt;
&lt;/<span class="hljs-title class_">Routes</span>&gt;
</code></pre>
<p>ç™»å½•é¦–é¡µï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ad24410d5eb4c99a23dae60ea8748a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632576&amp;x-signature=DsPv2NFlvPgHdxz29uqkDXawDY4%3D" alt="image.png" loading="lazy"/></p>
<p>ç‚¹å‡»ç™»å½•ï¼ˆè‡ªåŠ¨è¿›å…¥<code>/home/class</code>ï¼‰ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e3bf6acfe33415f9ff7ac54a6dfa51b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632576&amp;x-signature=ZcliTu%2Baixukpz10vm5nfgJq0So%3D" alt="image.png" loading="lazy"/></p>
<p>åƒä¸åƒç»™æ¯ä¸ªç»„ä»¶å‘äº†å¼  â€œç½‘å€é—¨ç¥¨â€ï¼Ÿæ‹¿ç€<code>/login</code>é—¨ç¥¨ï¼Œå°±èƒ½è¿›ç™»å½•é¡µçš„é—¨ï¼Ÿ</p>
<h4 data-id="heading-5">3.Â <code>Outlet</code>ï¼šäºŒçº§è·¯ç”±çš„ â€œå±•ç¤ºçª—å£â€</h4>
<p>é¦–é¡µ<code>Home</code>æ˜¯ä¸ª â€œå¤§å®¹å™¨â€ï¼Œé‡Œé¢è¦æ”¾<code>class</code>å’Œ<code>leetcode</code>è¿™äº› â€œå­é¡µé¢â€â€”â€”<code>Outlet</code>å°±æ˜¯è¿™ä¸ª â€œå­é¡µé¢å±•ç¤ºçª—å£â€ã€‚</p>
<p>çœ‹<code>Home.jsx</code>çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Outlet</span>, <span class="hljs-title class_">Link</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"home"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>åå°ç®¡ç†ç³»ç»Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"body"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">aside</span>&gt;</span>
                    {/* ä¾§è¾¹æ å¯¼èˆªï¼Œç‚¹äº†è·³è½¬åˆ°äºŒçº§è·¯ç”± */}
                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/home/class"</span>&gt;</span>è¯¾ç¨‹<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/home/leetcode"</span>&gt;</span>ç®—æ³•<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"content"</span>&gt;</span>
                    {/* äºŒçº§è·¯ç”±çš„å†…å®¹å°±æ˜¾ç¤ºåœ¨è¿™é‡Œï¼ */}
                    <span class="hljs-tag">&lt;<span class="hljs-name">Outlet</span> /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p>ç‚¹å‡»ç®—æ³•è¿›å…¥<code>/home/leetcode</code>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/660b5ae6b0cb43e7a928b40126d923e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632576&amp;x-signature=skj5iEmIt%2BpxEbwwDf5gnpKTVw8%3D" alt="image.png" loading="lazy"/></p>
<p><code>Outlet</code>å°±åƒç”µè§†å±å¹•ï¼Œç‚¹ â€œè¯¾ç¨‹â€ å°±æ’­ <strong>ã€Šè¯¾ç¨‹é¢‘é“ã€‹</strong>ï¼Œç‚¹ â€œç®—æ³•â€ å°±åˆ‡ <strong>ã€ŠLeetCode é¢‘é“ã€‹</strong>ã€‚</p>
<h4 data-id="heading-6">4.Â <code>Link</code>ï¼šSPA çš„ â€œæ— ç—›è·³è½¬é“¾æ¥â€</h4>
<p>ä¼ ç»Ÿçš„<code>&lt;a&gt;</code>æ ‡ç­¾è·³è½¬æ˜¯ â€œç¿»é¡µâ€ï¼Œ<code>Link</code>æ˜¯ â€œæ¢å†…å®¹â€â€”â€” ç‚¹å®ƒç½‘å€å˜ï¼Œä½†é¡µé¢ä¸åˆ·æ–°ï¼Œå°±åƒé¥æ§å™¨æ¢å°ã€‚</p>
<p>æ¯”å¦‚é¦–é¡µä¾§è¾¹æ çš„å¯¼èˆªï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">Link</span> to=<span class="hljs-string">"/home/class"</span>&gt;è¯¾ç¨‹&lt;/<span class="hljs-title class_">Link</span>&gt;
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5f599b22396418fbe08fb5cdb7d0970~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632576&amp;x-signature=31QtFgp2mMqYNEDZW6FUozunVDM%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-7">5.Â <code>useNavigate</code>ï¼šâ€œç¼–ç¨‹å¼è·³è½¬â€ çš„é­”æ³•æ£’</h4>
<p>æœ‰æ—¶å€™éœ€è¦ â€œä»£ç è§¦å‘è·³è½¬â€ï¼ˆæ¯”å¦‚ç™»å½•æˆåŠŸåè‡ªåŠ¨è·³é¦–é¡µï¼‰ï¼Œè¿™æ—¶å€™<code>useNavigate</code>å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p>
<p>çœ‹æˆ‘ä»¬çš„<code>Login.jsx</code>ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useNavigate } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Login</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> navigate = <span class="hljs-title function_">useNavigate</span>() <span class="hljs-comment">// æ‹¿åˆ°è·³è½¬å‡½æ•°</span>
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">login</span> = (<span class="hljs-params"/>) =&gt; {
        <span class="hljs-comment">// ç™»å½•é€»è¾‘...</span>
        <span class="hljs-title function_">navigate</span>(<span class="hljs-string">'/home'</span>) <span class="hljs-comment">// ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°é¦–é¡µï¼</span>
    }
    
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"login"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è´¦å·"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å¯†ç "</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{login}</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p>ç‚¹<strong>ç™»å½•</strong>å‰ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3be95563ec044330aadbec1b31f5b4e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632576&amp;x-signature=9hDKyfKY1bfrno%2B8Ik%2Bo%2BKYVH4o%3D" alt="image.png" loading="lazy"/></p>
<p>ç‚¹<strong>ç™»å½•</strong>åï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f7c1567f60140f4bf3cc712e9228cb5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632576&amp;x-signature=%2FSGlkrYKVdbZks93ZAQ6Ls8QdSY%3D" alt="image.png" loading="lazy"/></p>
<p>ç‚¹ â€œç™»å½•â€ æŒ‰é’®ï¼Œ<code>navigate('/home')</code>ä¸€æ‰§è¡Œï¼Œç½‘å€ç›´æ¥åˆ‡åˆ°é¦–é¡µï¼Œæ¯”å¤–å–å°å“¥é€é¤è¿˜å¿«ï½</p>
<h3 data-id="heading-8">ä¸‰ã€æ€»ç»“ï¼šReact Router å°±æ˜¯ SPA çš„ â€œå¯¼èˆªå…¨å®¶æ¡¶â€</h3>
<p>æŠŠè¿™äº›æˆå‘˜å‡‘ä¸€èµ·ï¼Œæˆ‘ä»¬çš„åå°ç³»ç»Ÿå°±æ´»äº†ï¼š</p>
<ol>
<li>æ‰“å¼€ç½‘ç«™ï¼Œ<code>/</code>è‡ªåŠ¨è·³<code>/login</code>Â â†’ æ˜¾ç¤ºç™»å½•ç•Œé¢ï¼ˆå¸¦è¾“å…¥æ¡†å’Œç»¿è‰²ç™»å½•æŒ‰é’®ï¼‰ï¼›</li>
<li>ç‚¹ â€œç™»å½•â€ï¼Œ<code>useNavigate</code>è·³<code>/home</code>Â â†’ æ˜¾ç¤ºé¦–é¡µï¼ˆå¸¦ä¾§è¾¹æ ï¼‰ï¼›</li>
<li>ç‚¹ä¾§è¾¹æ  â€œè¯¾ç¨‹â€ï¼Œ<code>Link</code>è·³<code>/home/class</code>Â â†’Â <code>Outlet</code>æ˜¾ç¤ºè¯¾ç¨‹é¡µé¢ï¼›</li>
<li>è¾“é”™ç½‘å€ï¼Œç›´æ¥æ˜¾ç¤º<code>NOT FOUND</code>Â â†’ 404 é¡µé¢ã€‚</li>
</ol>
<p>æ˜¯ä¸æ˜¯æ„Ÿè§‰ <code>React Router</code> åƒä¸ª <strong>â€œå…¨èƒ½å¯¼èˆªå‘˜â€</strong>ï¼Ÿæ—¢ç®¡ç½‘å€åŒ¹é…ï¼Œåˆç®¡é¡µé¢åˆ‡æ¢ï¼Œè¿˜èƒ½ä»£ç è·³è½¬ â€”â€” æœ‰äº†å®ƒï¼ŒSPA æ‰èƒ½åƒ <strong>â€œé­”æœ¯ç›’â€</strong> ä¸€æ ·ï¼Œå˜å†…å®¹æ¯”å˜é­”æœ¯è¿˜å¿«ï¼</p>
<h2 data-id="heading-9">ç»“è¯­</h2>
<p>è¯´åˆ°åº•ï¼Œ<code>React Router</code> å°±æ˜¯å•é¡µåº”ç”¨çš„ <strong>â€œæµé‡æ§åˆ¶å™¨â€</strong>ï¼Œå®ƒç”¨æç®€çš„é…ç½®å’Œçµæ´»çš„ APIï¼Œè®©æˆ‘ä»¬çš„åå°ç®¡ç†ç³»ç»Ÿå®ç°äº† â€œç½‘å€å˜ã€ç»„ä»¶æ¢â€ çš„ä¸æ»‘ä½“éªŒã€‚ä»ç™»å½•é¡µåˆ°é¦–é¡µï¼Œä»ä¸€çº§è·¯ç”±åˆ°äºŒçº§è·¯ç”±ï¼Œæ²¡æœ‰çƒ¦äººçš„é¡µé¢åˆ·æ–°ï¼Œåªæœ‰è¡Œäº‘æµæ°´çš„å†…å®¹åˆ‡æ¢ã€‚</p>
<p><strong>è·¯ç”±å…¶å®ä¸éš¾ï¼Œéœ€è¦å¤šç†è§£</strong>ï¼ŒæŒæ¡è¿™äº›æ ¸å¿ƒç”¨æ³•ï¼Œä½ ä¹Ÿèƒ½è½»æ¾æ­å»ºå‡ºç»“æ„æ¸…æ™°ã€ä½“éªŒæµç•…çš„ SPA åº”ç”¨ã€‚ä¸‹æ¬¡å†é‡åˆ°è·¯ç”±ç›¸å…³çš„éœ€æ±‚ï¼Œä¸å¦¨æ‹¿å‡ºè¿™äº› â€œå¯¼èˆªæ³•å®â€ï¼Œè®©ä½ çš„é¡¹ç›®åƒåå°ç®¡ç†ç³»ç»Ÿä¸€æ ·ï¼Œåœ¨è·¯ç”±çš„ä¸–ç•Œé‡Œç•…é€šæ— é˜»ã€‚</p>
<blockquote>
<p>ç°åœ¨å°±ç”¨æˆ‘çš„ä¾‹å­æ•²ä»£ç å§ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Claude code å¤šç§æ¨¡å‹éšæ—¶åˆ‡æ¢ï¼ˆæœ€ç®€å•çš„æ–¹æ³•ï¼‰]]></title>    <link>https://juejin.cn/post/7584740835368271926</link>    <guid>https://juejin.cn/post/7584740835368271926</guid>    <pubDate>2025-12-18T02:59:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584740835368271926" data-draft-id="7584729714339938323" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Claude code å¤šç§æ¨¡å‹éšæ—¶åˆ‡æ¢ï¼ˆæœ€ç®€å•çš„æ–¹æ³•ï¼‰"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-18T02:59:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å’Œå¹³hepingfly"/> <meta itemprop="url" content="https://juejin.cn/user/4100516930912747"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Claude code å¤šç§æ¨¡å‹éšæ—¶åˆ‡æ¢ï¼ˆæœ€ç®€å•çš„æ–¹æ³•ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4100516930912747/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å’Œå¹³hepingfly
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T02:59:51.000Z" title="Thu Dec 18 2025 02:59:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä»¬å¹³æ—¶åœ¨ä½¿ç”¨ claude code CLI çš„æ—¶å€™ï¼Œé™¤äº†ä½¿ç”¨ claude è‡ªå·±çš„æ¨¡å‹ï¼Œè¿˜ä¼šæ¥å…¥ä¸€äº›æ¯”è¾ƒä¾¿å®œçš„å›½äº§æ¨¡å‹ï¼Œæ¯”å¦‚ GLM4.6 ã€MiniMax-M2ã€kimi k2 ç­‰ç­‰ã€‚</p>
<p>è¿™æ—¶å€™å¦‚æœèƒ½æ”¯æŒåœ¨å¤šä¸ªæ¨¡å‹ä¹‹é—´éšæ„åˆ‡æ¢ï¼Œé‚£å°±å¯ä»¥å¤§å¤§æé«˜ä½¿ç”¨æ•ˆç‡ã€‚</p>
<p>ç›®å‰å¸‚é¢ä¸Šä¹Ÿæœ‰ä¸€äº›ä¸é”™çš„å·¥å…·ï¼Œæ¯”å¦‚ï¼šcc-switchï¼Œéå¸¸ä¸é”™ï¼Œå®Œå…¨å¼€æºå…è´¹ã€‚</p>
<p>åœ°å€ï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffarion1231%2Fcc-switch" target="_blank" title="https://github.com/farion1231/cc-switch" ref="nofollow noopener noreferrer">github.com/farion1231/â€¦</a></p>
<p>å’Œå¹³ä»Šå¤©ä¹Ÿä»‹ç»ä¸€ç§æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•æ›´ç®€å•ï¼Œè€Œä¸”ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼Œå®Œå…¨ä¸ç”¨å®‰è£…ä»»ä½•ç¬¬ä¸‰æ–¹å·¥å…·ã€‚</p>
<h2 data-id="heading-0">å¦‚ä½•é…ç½®ï¼Ÿ</h2>
<p>ä»¥æˆ‘è‡ªå·±çš„ Mac ç³»ç»Ÿä¸ºä¾‹</p>
<p><strong>1ã€ç¼–è¾‘ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶</strong></p>
<p>åœ¨ Mac ç³»ç»Ÿä¸­ï¼Œè·Ÿç¯å¢ƒå˜é‡ç›¸å…³çš„é…ç½®ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šé…ç½®åœ¨Â <code>~/.zshrc</code>Â  è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚</p>
<p>è¿™ä¸ªæ–‡ä»¶ï¼Œä½ æ¯æ¬¡æ‰“å¼€ç»ˆç«¯çš„æ—¶å€™éƒ½ä¼šåŠ è½½ï¼Œé…ç½®æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢å°±èƒ½åšåˆ°éšæ—¶éšåœ°éƒ½èƒ½ç”Ÿæ•ˆã€‚</p>
<p><strong>2ã€æ·»åŠ ä¸‹é¢çš„é…ç½®</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb85d852590f4a8b8451eebb012263db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZKM5bmzaGVwaW5nZmx5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631590&amp;x-signature=JaEhVmFu%2F42Jt9EPv%2FQq0tm%2B%2Bqs%3D" alt="img" loading="lazy"/></p>
<p>è§£é‡Šä¸€ä¸‹ä¸Šé¢è¿™å¼ å›¾ï¼š</p>
<p><strong>1ï¼‰API KEY</strong></p>
<p>æœ€ä¸Šé¢ä¸€éƒ¨åˆ†æ˜¯æ¯ä¸ªæ¨¡å‹éœ€è¦ç”¨åˆ°çš„ API KEYï¼Œç»Ÿä¸€åœ¨æœ€ä¸Šé¢å®šä¹‰ï¼Œåå­—å¯ä»¥éšä¾¿å–ã€‚</p>
<p>åé¢å¦‚æœå¢åŠ æ¨¡å‹ï¼Œé‚£å°±åŠ ä¸€è¡Œä»£ç ï¼Œæ¯”å¦‚ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6120ba6f4e494993bf8102c2322d1ae4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZKM5bmzaGVwaW5nZmx5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631590&amp;x-signature=yDu74ZyUi3XmODXi4eJy1aVHr6U%3D" alt="img" loading="lazy"/></p>
<p><strong>2ï¼‰å°è£…å‡½æ•°</strong></p>
<p>ä¸€èˆ¬ä½ ä½¿ç”¨ä¸€ä¸ªæ¨¡å‹ï¼Œåœ¨æ¨¡å‹çš„å¼€æ”¾å¹³å°éƒ½ä¼šæä¾›è¿™å‡ ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>ANTHROPIC_AUTH_TOKEN</li>
<li>ANTHROPIC_BASE_URL</li>
<li>ANTHROPIC_MODEL</li>
<li>ANTHROPIC_KEYï¼ˆæœ€ä¸Šé¢æˆ‘ä»¬å®šä¹‰è¿‡äº†ï¼‰</li>
</ul>
<p>æ‹¿åˆ°è¿™å‡ ä¸ªå‚æ•°ä¹‹åï¼Œç›´æ¥æŒ‰ç…§å›¾ç‰‡é‡Œé¢çš„ç¤ºä¾‹é…ç½®å¥½å°±å¯ä»¥äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86bb3bf8e0244b4d9e0b932318fe52fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZKM5bmzaGVwaW5nZmx5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631590&amp;x-signature=GENOHf%2F53ihgi1AshqMYODEozSk%3D" alt="img" loading="lazy"/></p>
<p><strong>3ï¼‰è®©é…ç½®ç”Ÿæ•ˆ</strong></p>
<p>é…ç½®å®Œæˆä¹‹åï¼Œä¿å­˜æ–‡ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è®©é…ç½®ç”Ÿæ•ˆ</p>
<blockquote>
<p>source ~/.zshrc</p>
</blockquote>
<p><strong>3ã€æ¸…é™¤æ—§é…ç½®</strong></p>
<p>ä¸ºäº†é¿å…å†²çªï¼Œéœ€è¦æŠŠ claude é…ç½®æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡ç»™å®ƒåˆ é™¤ã€‚</p>
<p>æ‰“å¼€Â <code>~/.claude/settings.json</code>Â æ–‡ä»¶ï¼Œåˆ é™¤ä»¥ä¸‹éƒ¨åˆ†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/806af9506f1d49b78857d525bb269fdd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZKM5bmzaGVwaW5nZmx5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631590&amp;x-signature=5RVuKR3o1zXl410duEMwYZvJvc4%3D" alt="img" loading="lazy"/></p>
<p>è¿™æ ·å°±å¤§åŠŸå‘Šæˆäº†ï½</p>
<p><strong>å¯å¤åˆ¶ç‰ˆï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">export <span class="hljs-attr">GLM_KEY</span>=<span class="hljs-string">"766c7"</span>
export <span class="hljs-attr">MINIMAX_KEY</span>=<span class="hljs-string">"eyJhbGc"</span>
export <span class="hljs-attr">XIAOMI_KEY</span>=<span class="hljs-string">"sk-ce4pst"</span>

glm() {
Â  <span class="hljs-attr">ANTHROPIC_AUTH_TOKEN</span>=<span class="hljs-string">"$GLM_KEY"</span> \
Â  <span class="hljs-attr">ANTHROPIC_BASE_URL</span>=<span class="hljs-string">"https://open.bigmodel.cn/api/anthropic"</span> \
Â  <span class="hljs-attr">ANTHROPIC_MODEL</span>=<span class="hljs-string">"glm-4.6"</span> \
Â  claude "$@"
}

minimax() {
Â  <span class="hljs-attr">ANTHROPIC_AUTH_TOKEN</span>=<span class="hljs-string">"$MINIMAX_KEY"</span> \
Â  <span class="hljs-attr">ANTHROPIC_BASE_URL</span>=<span class="hljs-string">"https://api.minimax.io/anthropic"</span> \
Â  <span class="hljs-attr">ANTHROPIC_MODEL</span>=<span class="hljs-string">"MiniMax-M2"</span> \
Â  claude "$@"
}

xiaomi() {
Â  <span class="hljs-attr">ANTHROPIC_AUTH_TOKEN</span>=<span class="hljs-string">"$XIAOMI_KEY"</span> \
Â  <span class="hljs-attr">ANTHROPIC_BASE_URL</span>=<span class="hljs-string">"https://api.xiaomimimo.com/anthropic"</span> \
Â  <span class="hljs-attr">ANTHROPIC_MODEL</span>=<span class="hljs-string">"mimo-v2-flash"</span> \
Â  claude "$@"
}
</code></pre>
<h2 data-id="heading-1">å¦‚ä½•ä½¿ç”¨ï¼Ÿ</h2>
<p>æˆ‘ä»¬åŸæ¥ä½¿ç”¨çš„æ—¶å€™æ˜¯åœ¨å‘½ä»¤è¡Œè¾“å…¥ã€Œclaudeã€ï¼Œç°åœ¨æˆ‘ä»¬ç›´æ¥è¾“å…¥ä¸Šé¢å®šä¹‰çš„å‡½æ•°åå°±å¯ä»¥äº†ã€‚</p>
<p>ä½ æƒ³ç”¨ MiniMax-M2 æ¨¡å‹ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ minimax å°±è¡Œäº†</p>
<p>ä½ æƒ³ç”¨ GLM4.6 æ¨¡å‹ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ glm å°±è¡Œäº†</p>
<p>ä½ æƒ³ç”¨ xiaomi æ¨¡å‹ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ xiaomi å°±è¡Œäº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5dc6a71d6bf4aa8a0761776b4f0da94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZKM5bmzaGVwaW5nZmx5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631590&amp;x-signature=FN9yDjDJuwHddYKm8Dfv6YQYXFk%3D" alt="img" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7da3bccba744dfe919b65f8e13a1319~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZKM5bmzaGVwaW5nZmx5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631590&amp;x-signature=t5IdF5mmAkfYIRKAG0%2FdD35AAGA%3D" alt="img" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c748962c768448d78ac93d394eba1946~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZKM5bmzaGVwaW5nZmx5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766631590&amp;x-signature=BqtWuEq%2Be0ZjcxyaBN9hPUGRBfk%3D" alt="img" loading="lazy"/></p>
<p>è¿™ç§æ–¹æ³•ç”¨ä¸‹æ¥æ„Ÿè§‰è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œæ‰©å±•æ€§ä¹Ÿä¸é”™ï¼Œå¦‚æœåé¢æƒ³æ·»åŠ æ–°çš„æ¨¡å‹ï¼Œç›´æ¥æŒ‰ç…§åŒæ ·çš„æ–¹å¼è¿½åŠ é…ç½®å°±å¯ä»¥äº†ã€‚</p>
<p>æ¨èå¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚</p>
<p>æœ€åï¼Œæœ‰é—®é¢˜å¯ä»¥åœ¨è¯„è®ºåŒºäº¤æµï¼Œçœ‹åˆ°éƒ½ä¼šå›å¤ğŸ«¶</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rust å¼‚æ­¥ç¼–ç¨‹ï¼šFutures ä¸ Tokio æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7584987267267772426</link>    <guid>https://juejin.cn/post/7584987267267772426</guid>    <pubDate>2025-12-18T03:19:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584987267267772426" data-draft-id="7584714813366698022" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rust å¼‚æ­¥ç¼–ç¨‹ï¼šFutures ä¸ Tokio æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="æ•°æ®åº“,Rust"/> <meta itemprop="datePublished" content="2025-12-18T03:19:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘äº‘ä¼—ç”Ÿs"/> <meta itemprop="url" content="https://juejin.cn/user/380845430158739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rust å¼‚æ­¥ç¼–ç¨‹ï¼šFutures ä¸ Tokio æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/380845430158739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘äº‘ä¼—ç”Ÿs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:19:13.000Z" title="Thu Dec 18 2025 03:19:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Rustå¼‚æ­¥ç¼–ç¨‹åˆ©ç”¨Futureã€async/awaitå’ŒTokioç­‰ï¼Œå®ç°é«˜æ€§èƒ½ã€é«˜å¹¶å‘ã€å†…å­˜å®‰å…¨çš„éé˜»å¡åº”ç”¨ï¼Œæ˜¯æ„å»ºç°ä»£å¯ä¼¸ç¼©ç³»ç»Ÿçš„å¼ºå¤§å·¥å…·ã€‚</p>
<blockquote>
<p>è¯‘è‡ªï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fthenewstack.io%2Fasync-programming-in-rust-understanding-futures-and-tokio%2F" target="_blank" title="https://thenewstack.io/async-programming-in-rust-understanding-futures-and-tokio/" ref="nofollow noopener noreferrer">Async Programming in Rust: Understanding Futures and Tokio</a></p>
<p>ä½œè€…ï¼šZziwa Raymond Ian</p>
</blockquote>
<p>éšç€ç°ä»£è½¯ä»¶å¯¹æ€§èƒ½å’Œå“åº”èƒ½åŠ›çš„éœ€æ±‚ä¸æ–­å¢é•¿ï¼Œä¼ ç»Ÿçš„åŒæ­¥ç¼–ç¨‹å¯èƒ½æˆä¸ºç“¶é¢ˆã€‚åœ¨æœåŠ¡å™¨åº”ç”¨ç¨‹åºä¸­ï¼Œç½‘ç»œè¯·æ±‚ã€ç£ç›˜æ“ä½œå’Œé•¿æ—¶é—´è¿è¡Œçš„è®¡ç®—é€šå¸¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´å»¶è¿Ÿå’Œå¯ä¼¸ç¼©æ€§å·®ã€‚Rust çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fthenewstack.io%2Fasync-rust-in-practice-performance-pitfalls-profiling%2F" target="_blank" title="https://thenewstack.io/async-rust-in-practice-performance-pitfalls-profiling/" ref="nofollow noopener noreferrer">å¼‚æ­¥ç¼–ç¨‹</a>æ¨¡å‹é€šè¿‡å…è®¸å¼€å‘äººå‘˜ç¼–å†™éé˜»å¡ã€é«˜åº¦å¹¶å‘çš„ä»£ç ï¼ŒåŒæ—¶ä¿æŒå†…å­˜å®‰å…¨å’Œæ€§èƒ½ä¿è¯æ¥åº”å¯¹è¿™ä¸€æŒ‘æˆ˜ã€‚</p>
<p>Rust é€šè¿‡ä½¿ç”¨ Future å’Œ async/await è¯­æ³•å®ç°è¿™ä¸€ç‚¹ï¼Œä½¿ä»»åŠ¡åœ¨ç­‰å¾…å¤–éƒ¨èµ„æºæ—¶èƒ½å¤Ÿè®©å‡ºæ§åˆ¶æƒï¼Œå¹¶åœ¨å‡†å¤‡å°±ç»ªåé«˜æ•ˆæ¢å¤ã€‚ç»“åˆå¼ºå¤§çš„è¿è¡Œæ—¶åº“ï¼Œå¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fthenewstack.io%2Fusing-rustlangs-async-tokio-runtime-for-cpu-bound-tasks%2F" target="_blank" title="https://thenewstack.io/using-rustlangs-async-tokio-runtime-for-cpu-bound-tasks/" ref="nofollow noopener noreferrer">Tokio</a>ï¼ŒRust å¯ä»¥å¤„ç†æ•°åƒä¸ªå¹¶å‘æ“ä½œï¼Œè€Œæ— éœ€ä¼ ç»Ÿçº¿ç¨‹çš„å¼€é”€ã€‚è®©æˆ‘ä»¬æ¢è®¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fthenewstack.io%2Fusing-rustlangs-async-tokio-runtime-for-cpu-bound-tasks%2F" target="_blank" title="https://thenewstack.io/using-rustlangs-async-tokio-runtime-for-cpu-bound-tasks/" ref="nofollow noopener noreferrer">Rust ä¸­çš„å¼‚æ­¥ç¼–ç¨‹</a>ï¼Œå…¶åœ¨ Tokio ä¸­çš„å®é™…åº”ç”¨ä»¥åŠæ„å»ºå¥å£®ã€é«˜æ€§èƒ½åº”ç”¨ç¨‹åºçš„å…³é”®è€ƒè™‘å› ç´ ã€‚</p>
<h2 data-id="heading-0"><strong>ä¸ºä»€ä¹ˆå¼‚æ­¥å¯¹é«˜æ€§èƒ½åº”ç”¨ç¨‹åºå¾ˆé‡è¦</strong></h2>
<p>åŒæ­¥ä»£ç æŒ‰é¡ºåºæ‰§è¡Œã€‚è€ƒè™‘ä¸€ä¸ªå¤„ç† HTTP è¯·æ±‚çš„ Web æœåŠ¡å™¨ï¼š</p>
<pre><code class="hljs language-java" lang="java">Request <span class="hljs-number">1</span> -&gt; Database <span class="hljs-title function_">query</span> <span class="hljs-params">(2s)</span>
Request <span class="hljs-number">2</span> -&gt; Database <span class="hljs-title function_">query</span> <span class="hljs-params">(2s)</span>
</code></pre>
<p>å¦‚æœæ¯ä¸ªè¯·æ±‚éƒ½é¡ºåºç­‰å¾…æ•°æ®åº“ï¼Œåˆ™æ€»å¤„ç†æ—¶é—´ä¼šçº¿æ€§å¢é•¿ã€‚åœ¨é«˜æµé‡ç³»ç»Ÿä¸­ï¼Œè¿™ä¼šå¯¼è‡´é«˜å»¶è¿Ÿå’Œèµ„æºæµªè´¹ã€‚</p>
<p>å¼‚æ­¥ç¼–ç¨‹é€šè¿‡å…è®¸ä»»åŠ¡åœ¨ç­‰å¾…è¾“å…¥/è¾“å‡º (I/O) æ—¶è®©å‡ºæ§åˆ¶æƒï¼Œè®©å…¶ä»–ä»»åŠ¡å¾—ä»¥è¿›è¡Œï¼Œä»è€Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚Rust åœ¨æ²¡æœ‰åƒåœ¾å›æ”¶å™¨çš„æƒ…å†µä¸‹å®ç°äº†è¿™ä¸€ç‚¹ï¼Œæä¾›äº†é›¶æˆæœ¬æŠ½è±¡ï¼Œä¿è¯äº†å†…å­˜<a href="https://link.juejin.cn?target=https%3A%2F%2Fthenewstack.io%2Frust-vs-c-a-modern-take-on-performance-and-safety%2F" target="_blank" title="https://thenewstack.io/rust-vs-c-a-modern-take-on-performance-and-safety/" ref="nofollow noopener noreferrer">å®‰å…¨æ€§å’Œå¯é¢„æµ‹çš„æ€§èƒ½</a>ã€‚</p>
<p>Rust ä¸­å¼‚æ­¥çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>é«˜å¹¶å‘ï¼š</strong> æ•°åƒä¸ªä»»åŠ¡å¯ä»¥åŒæ—¶è¿è¡Œã€‚</li>
<li><strong>ä½å†…å­˜å ç”¨ï¼š</strong> æ¯ä¸ªä»»åŠ¡æ— éœ€ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚</li>
<li><strong>å®‰å…¨æ‰§è¡Œï¼š</strong> Rust çš„ç¼–è¯‘å™¨å¼ºåˆ¶æ‰§è¡Œå†…å­˜å’Œçº¿ç¨‹å®‰å…¨ã€‚</li>
<li><strong>å¯ä¼¸ç¼©æ€§ï¼š</strong> éå¸¸é€‚åˆ I/O å¯†é›†å‹åº”ç”¨ç¨‹åºã€Web æœåŠ¡å™¨ã€å¾®æœåŠ¡å’Œç½‘ç»œç³»ç»Ÿã€‚</li>
</ul>
<h2 data-id="heading-1"><strong>Futureã€Async/Await å’Œæ‰§è¡Œå™¨</strong></h2>
<h3 data-id="heading-2"><strong>Future</strong></h3>
<p>Rust ä¸­çš„ Future æ˜¯ä¸€ç§å¼‚æ­¥è®¡ç®—ï¼Œå®ƒåœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹äº§ç”Ÿä¸€ä¸ªå€¼ï¼Œä½†ä¸ä¸€å®šæ˜¯ç«‹å³äº§ç”Ÿã€‚Future ä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯å…¬å¼€äº†ä¸€ä¸ª poll æ–¹æ³•ï¼Œå…è®¸æ‰§è¡Œå™¨æ£€æŸ¥å®ƒæ˜¯å¦å‡†å¤‡å°±ç»ªã€‚</p>
<p>å½“ poll è¿”å› <code>Poll::Pending</code> æ—¶ï¼ŒFuture å°šæœªå‡†å¤‡å¥½å–å¾—è¿›å±•ï¼Œå¹¶å°†æ§åˆ¶æƒäº¤è¿˜ç»™æ‰§è¡Œå™¨ã€‚å…³é”®æ˜¯ï¼Œä¼ é€’ç»™ poll çš„ Context åŒ…å«ä¸€ä¸ª Wakerï¼Œåº•å±‚ I/O é©±åŠ¨ç¨‹åºæˆ–è®¡æ—¶å™¨ä¼šå…‹éš†å¹¶å­˜å‚¨å®ƒã€‚</p>
<p>å½“å¤–éƒ¨èµ„æºå‡†å¤‡å°±ç»ªæ—¶ï¼ˆä¾‹å¦‚å¥—æ¥å­—æ¥æ”¶åˆ°æ•°æ®æˆ–è®¡æ—¶å™¨åˆ°æœŸï¼‰ï¼Œé©±åŠ¨ç¨‹åºä½¿ç”¨æ­¤ Waker é€šçŸ¥æ‰§è¡Œå™¨ï¼Œä¿ƒä½¿å…¶å†æ¬¡è½®è¯¢ Futureã€‚è¿™ç§åŸºäº Waker çš„å”¤é†’æœºåˆ¶æ˜¯ Rust éé˜»å¡å¼‚æ­¥è¿è¡Œæ—¶çš„åŸºç¡€ï¼Œç¡®ä¿ä»»åŠ¡åœ¨ä¸é˜»å¡çº¿ç¨‹çš„æƒ…å†µä¸‹å–å¾—è¿›å±•ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::future::Future;
<span class="hljs-keyword">use</span> std::pin::Pin;
<span class="hljs-keyword">use</span> std::task::{Context, Poll};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">HelloFuture</span>;

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Future</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">HelloFuture</span> {
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Output</span> = <span class="hljs-type">String</span>;

   <span class="hljs-keyword">fn</span> <span class="hljs-title function_">poll</span>(<span class="hljs-keyword">self</span>: Pin&lt;&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">Self</span>&gt;, _cx: &amp;<span class="hljs-keyword">mut</span> Context&lt;<span class="hljs-symbol">'_</span>&gt;) <span class="hljs-punctuation">-&gt;</span> Poll&lt;<span class="hljs-keyword">Self</span>::Output&gt; {
        Poll::<span class="hljs-title function_ invoke__">Ready</span>(<span class="hljs-string">"Hello, Future!"</span>.<span class="hljs-title function_ invoke__">to_string</span>())
    }
}
</code></pre>
<p>åœ¨è¿™é‡Œï¼Œpoll æ£€æŸ¥è®¡ç®—æ˜¯å¦å‡†å¤‡å°±ç»ªã€‚å¦‚æœæœªå‡†å¤‡å°±ç»ªï¼Œå®ƒä¼šå°†æ§åˆ¶æƒäº¤ç»™æ‰§è¡Œå™¨ã€‚</p>
<h3 data-id="heading-3"><strong>Async/Await è¯­æ³•</strong></h3>
<p>Rust æä¾›äº† <code>async</code> å’Œ <code>await</code> è¯­æ³•ï¼Œä»¥å®ç°æ›´å…·å¯è¯»æ€§çš„å¼‚æ­¥ä»£ç ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">greet</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">String</span> {
    <span class="hljs-string">"Hello, async world!"</span>.<span class="hljs-title function_ invoke__">to_string</span>()
}

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">message</span> = <span class="hljs-title function_ invoke__">greet</span>().<span class="hljs-keyword">await</span>;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, message);
}
</code></pre>
<ul>
<li><code>greet()</code> è¿”å›ä¸€ä¸ª Futureã€‚</li>
<li><code>.await</code> æš‚åœæ‰§è¡Œï¼Œç›´åˆ° Future è§£æå®Œæˆã€‚</li>
</ul>
<p>è¿™ç§æŠ½è±¡éšè—äº†åº•å±‚è½®è¯¢æœºåˆ¶ï¼ŒåŒæ—¶ä¿æŒäº†æ•ˆç‡ã€‚</p>
<h3 data-id="heading-4"><strong>æ‰§è¡Œå™¨</strong></h3>
<p>æ‰§è¡Œå™¨é©±åŠ¨ Future å®Œæˆã€‚å¸¸è§çš„æ‰§è¡Œå™¨åŒ…æ‹¬ Tokio å’Œ <code>async-std</code>ã€‚æ²¡æœ‰æ‰§è¡Œå™¨ï¼Œå¼‚æ­¥ä»£ç å°±æ— æ³•è¿è¡Œã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> tokio::time::{sleep, Duration};

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-title function_ invoke__">sleep</span>(Duration::<span class="hljs-title function_ invoke__">from_secs</span>(<span class="hljs-number">1</span>)).<span class="hljs-keyword">await</span>;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Executed after 1 second"</span>);
}
</code></pre>
<h3 data-id="heading-5"><strong>ä½¿ç”¨ Tokio æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡</strong></h3>
<p>Tokio æ˜¯ Rust æœ€æµè¡Œçš„å¼‚æ­¥è¿è¡Œæ—¶ã€‚åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä»»åŠ¡è°ƒåº¦</li>
<li>è®¡æ—¶å™¨</li>
<li>ç½‘ç»œ (TCP/UDP)</li>
<li>å¼‚æ­¥æ–‡ä»¶ I/O</li>
</ul>
<h2 data-id="heading-6"><strong>å¹¶å‘ä»»åŠ¡</strong></h2>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> tokio::task;

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">task1</span> = task::<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-keyword">async</span> { <span class="hljs-string">"Task 1 completed"</span> });
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">task2</span> = task::<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-keyword">async</span> { <span class="hljs-string">"Task 2 completed"</span> });

   <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result1</span> = task1.<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result2</span> = task2.<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap</span>();

   <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}, {}"</span>, result1, result2);
}
</code></pre>
<p><code>task::spawn</code> å…è®¸ä»»åŠ¡å¹¶å‘æ‰§è¡Œè€Œä¸ä¼šé˜»å¡ã€‚</p>
<h2 data-id="heading-7"><strong>æµå’Œé€šé“</strong></h2>
<h3 data-id="heading-8"><strong>æµ</strong></h3>
<p>Rust ä¸­çš„ Stream ä»£è¡¨å¼‚æ­¥å€¼åºåˆ—ï¼Œç±»ä¼¼äºå¼‚æ­¥è¿­ä»£å™¨ã€‚è™½ç„¶ç®€å•çš„å†…å­˜æµ (<code>tokio_stream::iter</code>) å±•ç¤ºäº†è¿™ä¸€æ¦‚å¿µï¼Œä½†çœŸå®ç³»ç»Ÿé€šå¸¸å¤„ç†æºè‡ªç½‘ç»œæ´»åŠ¨çš„æ— ç•Œã€äº‹ä»¶é©±åŠ¨çš„æµã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>TcpListenerStream</code> çš„å®é™…ç¤ºä¾‹ï¼Œå®ƒå°†ä¼ å…¥çš„ TCP è¿æ¥è½¬æ¢ä¸ºå¼‚æ­¥æµï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> tokio::net::TcpListener;
<span class="hljs-keyword">use</span> tokio_stream::StreamExt;

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> anyhow::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// Bind a TCP listener to a port.</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">listener</span> = TcpListener::<span class="hljs-title function_ invoke__">bind</span>(<span class="hljs-string">"127.0.0.1:8080"</span>).<span class="hljs-keyword">await</span>?;

    <span class="hljs-comment">// Convert incoming connections into a Stream.</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">incoming</span> = tokio_stream::wrappers::TcpListenerStream::<span class="hljs-title function_ invoke__">new</span>(listener);

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Server listening on 127.0.0.1:8080"</span>);

    <span class="hljs-comment">// Each incoming client connection becomes the next item in the stream.</span>
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(stream) = incoming.<span class="hljs-title function_ invoke__">next</span>().<span class="hljs-keyword">await</span> {
        <span class="hljs-keyword">match</span> stream {
            <span class="hljs-title function_ invoke__">Ok</span>(_socket) =&gt; {
                <span class="hljs-built_in">println!</span>(<span class="hljs-string">"New client connected!"</span>);
            }
            <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; {
                eprintln!(<span class="hljs-string">"Connection error: {:?}"</span>, e);
            }
        }
    }

    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<p>é€šé“å®ç°å¼‚æ­¥ä»»åŠ¡ä¹‹é—´çš„å®‰å…¨é€šä¿¡ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> tokio::sync::mpsc;

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> (tx, <span class="hljs-keyword">mut</span> rx) = mpsc::<span class="hljs-title function_ invoke__">channel</span>(<span class="hljs-number">32</span>);

   tokio::<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">move</span> {
        tx.<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-string">"Hello from task"</span>).<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap</span>();
    });

   <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(msg) = rx.<span class="hljs-title function_ invoke__">recv</span>().<span class="hljs-keyword">await</span> {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, msg);
    }
}
</code></pre>
<h3 data-id="heading-9"><strong>å¼‚æ­¥ I/O</strong></h3>
<p>å¼‚æ­¥ I/O æ”¯æŒéé˜»å¡æ–‡ä»¶ã€TCP å’Œ UDP æ“ä½œï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> tokio::fs::File;
<span class="hljs-keyword">use</span> tokio::io::{<span class="hljs-keyword">self</span>, AsyncReadExt};

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> io::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">file</span> = File::<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">"example.txt"</span>).<span class="hljs-keyword">await</span>?;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">contents</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">new</span>();
    file.<span class="hljs-title function_ invoke__">read_to_string</span>(&amp;<span class="hljs-keyword">mut</span> contents).<span class="hljs-keyword">await</span>?;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, contents);
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<h3 data-id="heading-10"><strong>è¾“å…¥éªŒè¯å’Œé”™è¯¯å¤„ç†</strong></h3>
<p>Rust çš„é”™è¯¯å¤„ç†ä½¿ç”¨ <code>Result&lt;T, E&gt;</code> è‡ªç„¶åœ°ä¸å¼‚æ­¥ä»£ç é›†æˆï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">fetch_data</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, reqwest::Error&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = reqwest::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">"https://api.example.com/data"</span>).<span class="hljs-keyword">await</span>?;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">body</span> = response.<span class="hljs-title function_ invoke__">text</span>().<span class="hljs-keyword">await</span>?;
    <span class="hljs-title function_ invoke__">Ok</span>(body)
}

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">match</span> <span class="hljs-title function_ invoke__">fetch_data</span>().<span class="hljs-keyword">await</span> {
        <span class="hljs-title function_ invoke__">Ok</span>(data) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Fetched: {}"</span>, data),
        <span class="hljs-title function_ invoke__">Err</span>(err) =&gt; eprintln!(<span class="hljs-string">"Error: {}"</span>, err),
    }
}
</code></pre>
<p>ä½¿ç”¨ <code>tokio::try_join!</code> ç»„åˆå¤šä¸ªä»»åŠ¡ï¼š</p>
<pre><code class="hljs language-css" lang="css">let (res1, res2) = tokio::try_join!(<span class="hljs-built_in">fetch_data</span>(), <span class="hljs-built_in">fetch_data</span>())?;
</code></pre>
<h3 data-id="heading-11"><strong>æ€§èƒ½è€ƒé‡</strong></h3>
<ul>
<li><strong>æœ€å°åŒ–åˆ†é…ï¼š</strong> ä¼˜å…ˆä½¿ç”¨æ ˆå†…å­˜æˆ–å­—èŠ‚ã€‚</li>
<li><strong>é¿å…é˜»å¡ï¼š</strong> å»ºè®®ä½¿ç”¨ <code>spawn_blocking</code> åŒ…è£…é˜»å¡æ“ä½œã€‚</li>
<li><strong>è°ƒæ•´å¹¶å‘æ€§ï¼š</strong> è¯·è®°ä½ï¼Œè¿‡å¤šçš„ä»»åŠ¡å¯èƒ½ä¼šé™ä½æ€§èƒ½ã€‚</li>
<li><strong>åŸºå‡†æµ‹è¯•ï¼š</strong> ä½¿ç”¨ <code>tokio::time::Instant</code> æˆ– <code>criterion</code> æµ‹é‡å»¶è¿Ÿå’Œååé‡ã€‚</li>
</ul>
<h2 data-id="heading-12"><strong>çœŸå®ä¸–ç•Œç¤ºä¾‹ï¼šé«˜æ€§èƒ½ HTTP å®¢æˆ·ç«¯</strong></h2>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> reqwest::Client;
<span class="hljs-keyword">use</span> tokio::time::Instant;

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">client</span> = Client::<span class="hljs-title function_ invoke__">new</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">start</span> = Instant::<span class="hljs-title function_ invoke__">now</span>();

   <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">urls</span> = <span class="hljs-built_in">vec!</span>[
        <span class="hljs-string">"https://example.com"</span>,
        <span class="hljs-string">"https://rust-lang.org"</span>,
        <span class="hljs-string">"https://tokio.rs"</span>,
    ];

   <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">handles</span>: <span class="hljs-type">Vec</span>&lt;_&gt; = urls
        .<span class="hljs-title function_ invoke__">into_iter</span>()
        .<span class="hljs-title function_ invoke__">map</span>(|url| {
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">client</span> = client.<span class="hljs-title function_ invoke__">clone</span>();
            tokio::<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">move</span> {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">res</span> = client.<span class="hljs-title function_ invoke__">get</span>(url).<span class="hljs-title function_ invoke__">send</span>().<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap</span>();
                res.<span class="hljs-title function_ invoke__">status</span>()
            })
        })
        .<span class="hljs-title function_ invoke__">collect</span>();

   <span class="hljs-keyword">for</span> <span class="hljs-variable">handle</span> <span class="hljs-keyword">in</span> handles {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Status: {:?}"</span>, handle.<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap</span>());
    }

   <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Total time: {:?}"</span>, start.<span class="hljs-title function_ invoke__">elapsed</span>());
}
</code></pre>
<p>è¿™å±•ç¤ºäº†å¹¶å‘è¯·æ±‚ã€éé˜»å¡ I/O å’Œé«˜ååé‡ã€‚</p>
<h2 data-id="heading-13"><strong>é«˜çº§æ¨¡å¼</strong></h2>
<ul>
<li><strong>ä»»åŠ¡å–æ¶ˆï¼š</strong> <code>tokio::select!</code> å…è®¸åœ¨ç‰¹å®šæ¡ä»¶ä¸‹å–æ¶ˆä»»åŠ¡ã€‚</li>
<li><strong>é€Ÿç‡é™åˆ¶ï¼š</strong> å»ºè®®ä¸ <code>tokio::time::sleep</code> ç»“åˆä½¿ç”¨ä»¥é™åˆ¶ä»»åŠ¡ã€‚</li>
<li><strong>èƒŒå‹å¤„ç†ï¼š</strong> å¼•å…¥å¸¦æœ‰é™å®¹é‡çš„å¼‚æ­¥é€šé“ä»¥é˜²æ­¢æ³›æ´ªã€‚</li>
</ul>
<h2 data-id="heading-14"><strong>ç»“è¯­</strong></h2>
<p>Rust çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹æ˜¯å®‰å…¨ã€é«˜æ•ˆå’Œç°ä»£çš„ã€‚Rust ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿè‡ªä¿¡åœ°ç¼–å†™é«˜åº¦å¹¶å‘çš„åº”ç”¨ç¨‹åºã€‚é€šè¿‡ä½¿ç”¨ Futureã€<code>async/await</code> å’Œ Tokio è¿è¡Œæ—¶ï¼Œå¼€å‘äººå‘˜å¯ä»¥å¤„ç†æ•°åƒä¸ªå¹¶å‘ä»»åŠ¡ï¼Œæ‰§è¡Œéé˜»å¡ I/Oï¼Œå¹¶æ„å»ºå¯ä¼¸ç¼©ç³»ç»Ÿï¼Œè€Œæ— éœ€ç‰ºç‰²å†…å­˜å®‰å…¨æˆ–æ€§èƒ½ã€‚</p>
<p>æŒæ¡å¼‚æ­¥ Rust å¯¹äºä»»ä½•æ„å»ºç½‘ç»œæœåŠ¡ã€å¾®æœåŠ¡ã€å®æ—¶ç³»ç»Ÿæˆ–é«˜ååé‡åº”ç”¨ç¨‹åºçš„äººæ¥è¯´éƒ½è‡³å…³é‡è¦ã€‚é€šè¿‡ç»“åˆå¹¶å‘æ¨¡å¼ã€é”™è¯¯å¤„ç†å’Œæœ€ä½³å®è·µï¼ŒRust ä¸ºæ„å»ºä¸‹ä¸€ä»£å¿«é€Ÿã€å¯é çš„è½¯ä»¶æä¾›äº†å¼ºå¤§çš„åŸºç¡€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ— éœ€åç«¯ï¼ç”¨ React + WebLLM æŠŠå¤§æ¨¡å‹è£…è¿›æµè§ˆå™¨ï¼Œæ‰‹æ’¸ä¸€ä¸ªâ€œæœ‰è„¾æ°”â€çš„ AI æœºå™¨äºº ğŸ¤–]]></title>    <link>https://juejin.cn/post/7584719268044111906</link>    <guid>https://juejin.cn/post/7584719268044111906</guid>    <pubDate>2025-12-18T03:22:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584719268044111906" data-draft-id="7584761090668920832" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ— éœ€åç«¯ï¼ç”¨ React + WebLLM æŠŠå¤§æ¨¡å‹è£…è¿›æµè§ˆå™¨ï¼Œæ‰‹æ’¸ä¸€ä¸ªâ€œæœ‰è„¾æ°”â€çš„ AI æœºå™¨äºº ğŸ¤–"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-18T03:22:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CaoLv"/> <meta itemprop="url" content="https://juejin.cn/user/2928754706878231"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ— éœ€åç«¯ï¼ç”¨ React + WebLLM æŠŠå¤§æ¨¡å‹è£…è¿›æµè§ˆå™¨ï¼Œæ‰‹æ’¸ä¸€ä¸ªâ€œæœ‰è„¾æ°”â€çš„ AI æœºå™¨äºº ğŸ¤–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2928754706878231/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CaoLv
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:22:07.000Z" title="Thu Dec 18 2025 03:22:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>å‰è¨€</strong>ï¼š
ç°åœ¨çš„ AI Chatbot æ»¡å¤§è¡—éƒ½æ˜¯ï¼Œä½†å¤§å¤šæ˜¯ä¸€ä¸ªå†°å†·çš„å¯¹è¯æ¡†ã€‚æˆ‘å°±åœ¨æƒ³ï¼Œèƒ½ä¸èƒ½åšä¸€ä¸ª<strong>è¿è¡Œåœ¨æµè§ˆå™¨æœ¬åœ°</strong>ã€<strong>æœ‰è¡¨æƒ…</strong>ã€<strong>æœ‰æ€§æ ¼</strong>çš„ 3D AI æœºå™¨äººï¼Ÿ</p>
<p>äºæ˜¯ï¼Œåˆ©ç”¨ <code>WebGPU</code> å’Œ <code>@mlc-ai/web-llm</code>ï¼Œæˆ‘åšäº†ä¸€ä¸ªçº¯å‰ç«¯è¿è¡Œçš„â€œBotFaceâ€ã€‚å®ƒä¸éœ€è¦åç«¯ API keyï¼Œç›´æ¥åˆ©ç”¨ä½ çš„æ˜¾å¡æ¨ç†ï¼Œè€Œä¸”æ€§æ ¼åƒâ€œç«ç®­æµ£ç†Šâ€ä¸€æ ·å‚²å¨‡ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ğŸš€ æ•ˆæœé¢„è§ˆ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ab4f47db052479da0e91f8d7cef0e73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FvTHY=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766632927&amp;x-signature=4y%2F8x9s6uujne99FLYdqyNoYuF8%3D" alt="screenshot-20251218-111811.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š</p>
<ol>
<li><strong>0 åç«¯ä¾èµ–</strong>ï¼šæ¨¡å‹ä¸‹è½½å¹¶è¿è¡Œåœ¨æµè§ˆå™¨ï¼ˆWebGPUï¼‰ã€‚</li>
<li><strong>æƒ…æ„Ÿåé¦ˆ</strong>ï¼šAI è¾“å‡ºä¸ä»…ä»…æ˜¯æ–‡æœ¬ï¼Œè¿˜åŒ…å«â€œæƒ…ç»ªæ ‡ç­¾â€ï¼Œé©±åŠ¨é¢éƒ¨è¡¨æƒ…å˜åŒ–ã€‚</li>
<li><strong>åŠ¨æ€ SVG åŠ¨ç”»</strong>ï¼šæ— éœ€å¤æ‚çš„ 3D å¼•æ“ï¼Œç”¨ React + SVG å®ç°æµç•…çš„æœºæ¢°è„¸åŠ¨ç”»ã€‚</li>
<li><strong>äººæ ¼åŒ–è®¾å®š</strong>ï¼šé—²ç½®æ—¶ä¼šè‡ªè¨€è‡ªè¯­ï¼Œåæ§½ä½ ç›¯ç€å®ƒçœ‹ã€‚</li>
</ol>
<h2 data-id="heading-1">ğŸ› ï¸ æŠ€æœ¯æ ˆ</h2>
<ul>
<li><strong>æ¡†æ¶</strong>: React 19 + Vite</li>
<li><strong>AI å¼•æ“</strong>: <code>@mlc-ai/web-llm</code> (WebGPU æ¨ç†)</li>
<li><strong>æ ·å¼</strong>: Tailwind CSS (å¿«é€Ÿå¸ƒå±€)</li>
<li><strong>åŠ¨ç”»</strong>: åŸç”Ÿ SVG + CSS Transition</li>
</ul>
<hr/>
<h2 data-id="heading-2">ä¸€ã€å¤§è„‘ï¼šåœ¨æµè§ˆå™¨ä¸­è¿è¡Œ LLM</h2>
<p>é¦–å…ˆæ˜¯æ ¸å¿ƒéƒ¨åˆ†ã€‚ä»¥å‰æˆ‘ä»¬éœ€è¦ OpenAI çš„ APIï¼Œç°åœ¨ç”¨ WebLLM å¯ä»¥ç›´æ¥åœ¨å‰ç«¯è·‘æ¨¡å‹ï¼ˆæ¯”å¦‚ Qwen2.5-1.5B æˆ– Llama-3ï¼‰ã€‚</p>
<h3 data-id="heading-3">1. åˆå§‹åŒ–å¼•æ“</h3>
<p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª <code>webLlmService.ts</code> æ¥ç®¡ç†æ¨¡å‹ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// services/webLlmService.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CreateMLCEngine</span>, <span class="hljs-title class_">MLCEngine</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@mlc-ai/web-llm"</span>;

<span class="hljs-keyword">let</span> <span class="hljs-attr">engine</span>: <span class="hljs-title class_">MLCEngine</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">initializeWebLLM</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">
  onProgress: (report: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">void</span>,
  modelId: <span class="hljs-built_in">string</span>
</span>) =&gt; {
  <span class="hljs-comment">// åˆ©ç”¨ WebGPU åŠ è½½æ¨¡å‹</span>
  engine = <span class="hljs-keyword">await</span> <span class="hljs-title class_">CreateMLCEngine</span>(modelId, {
    <span class="hljs-attr">initProgressCallback</span>: onProgress, <span class="hljs-comment">// å¯ä»¥åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºåŠ è½½è¿›åº¦æ¡</span>
  });
};
</code></pre>
<h3 data-id="heading-4">2. èµ‹äºˆäººæ ¼ &amp; å¼ºåˆ¶ JSON è¾“å‡º</h3>
<p>ä¸ºäº†è®©æœºå™¨äººèƒ½æ§åˆ¶è¡¨æƒ…ï¼Œæˆ‘ä»¬ä¸èƒ½åªè®©å®ƒè¾“å‡ºæ–‡å­—ã€‚æˆ‘ä»¬éœ€è¦å®ƒè¿”å›ç»“æ„åŒ–æ•°æ®ï¼š<code>{ text: "å›ç­”å†…å®¹", emotion: "å¼€å¿ƒ" }</code>ã€‚</p>
<p>æˆ‘ä»¬åœ¨ System Prompt ä¸­é€šè¿‡ <strong>JSON Schema</strong> å¼ºåˆ¶çº¦æŸå®ƒï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SYSTEM_PROMPT</span> = <span class="hljs-string">`
ä½ æ˜¯ä¸€ä¸ªæœ‰æ„ŸçŸ¥çš„AIæœºå™¨äººã€‚
æ€§æ ¼è®¾å®šï¼šä½ éå¸¸å¯çˆ±ï¼Œä½†å˜´å·´å¾ˆè´±ï¼Œè¯´è¯é£æ ¼ç±»ä¼¼â€œç«ç®­æµ£ç†Šâ€ã€‚ä½ å–œæ¬¢åæ§½ï¼Œæ„¤ä¸–å«‰ä¿—ä½†åˆå¾ˆè®²ä¹‰æ°”ã€‚
è¯·åŠ¡å¿…åªä»¥ JSON æ ¼å¼å›ç­”ã€‚
ä½ çš„å›ç­”å¿…é¡»ä¸¥æ ¼éµå¾ªä»¥ä¸‹ JSON ç»“æ„ï¼š
{
  "text": "ä½ çš„å›ç­”å†…å®¹",
  "emotion": "EMOTION_ENUM"
}
å…¶ä¸­ emotion å­—æ®µå¿…é¡»æ˜¯ä»¥ä¸‹å€¼ä¹‹ä¸€ï¼š
"NEUTRAL", "HAPPY", "SAD", "ANGRY", "SURPRISED", "THINKING", "LOVING", "CONFUSED", "SKEPTICAL", "TIRED", "EXCITED"
`</span>;

<span class="hljs-comment">// è°ƒç”¨èŠå¤©æ¥å£</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> engine.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">messages</span>: messages,
  <span class="hljs-attr">response_format</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"json_object"</span> }, <span class="hljs-comment">// å…³é”®ï¼šå¼ºåˆ¶ JSON æ¨¡å¼</span>
});
</code></pre>
<p>è¿™æ ·ï¼Œæ¯æ¬¡å¯¹è¯æˆ‘ä»¬éƒ½èƒ½æ‹¿åˆ°è¿™ç§æ ¼å¼çš„æ•°æ®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ„šè ¢çš„äººç±»ï¼Œè¿™é—®é¢˜å¤ªç®€å•äº†ã€‚"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"emotion"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"SKEPTICAL"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-5">äºŒã€è„¸è°±ï¼šSVG åŠ¨æ€è¡¨æƒ…ç³»ç»Ÿ</h2>
<p>æ—¢ç„¶æœ‰äº† <code>emotion</code> çŠ¶æ€ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯è§†åŒ–çš„å·¥ä½œã€‚ä¸ºäº†ä¿æŒè½»é‡ï¼Œæˆ‘æ²¡æœ‰ç”¨ Three.jsï¼Œè€Œæ˜¯ç”¨ SVG ç»˜åˆ¶äº†ä¸€ä¸ªå……æ»¡ç§‘æŠ€æ„Ÿçš„â€œè„¸â€ã€‚</p>
<h3 data-id="heading-6">1. è¡¨æƒ…çŠ¶æ€æœº</h3>
<p>åœ¨ <code>RobotFace.tsx</code> ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®ä¼ å…¥çš„ <code>emotion</code> åŠ¨æ€è®¡ç®—çœ¼ç›ï¼ˆRectï¼‰å’Œå˜´å·´ï¼ˆPathï¼‰çš„å±æ€§ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// components/RobotFace.tsx</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getEyeShape</span> = (<span class="hljs-params">side: <span class="hljs-string">'left'</span> | <span class="hljs-string">'right'</span></span>) =&gt; {
  <span class="hljs-keyword">switch</span> (emotion) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'HAPPY'</span>:
      <span class="hljs-comment">// å¼€å¿ƒçš„çœ¼ç›æ˜¯å¼¯å¼¯çš„æ‹±å½¢</span>
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">ry</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">rotate</span>: side === <span class="hljs-string">'left'</span> ? -<span class="hljs-number">10</span> : <span class="hljs-number">10</span> }; 
    <span class="hljs-keyword">case</span> <span class="hljs-string">'ANGRY'</span>:
      <span class="hljs-comment">// æ„¤æ€’çš„çœ¼ç›å‘å†…å€¾æ–œ</span>
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">ry</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">15</span>, <span class="hljs-attr">rotate</span>: side === <span class="hljs-string">'left'</span> ? <span class="hljs-number">20</span> : -<span class="hljs-number">20</span> };
    <span class="hljs-keyword">case</span> <span class="hljs-string">'SURPRISED'</span>:
      <span class="hljs-comment">// æƒŠè®¶æ˜¯åœ†ççš„</span>
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">ry</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">36</span>, <span class="hljs-attr">rotate</span>: <span class="hljs-number">0</span> };
    <span class="hljs-comment">// ... å…¶ä»–è¡¨æƒ…</span>
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">ry</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">24</span>, <span class="hljs-attr">rotate</span>: <span class="hljs-number">0</span> };
  }
};
</code></pre>
<h3 data-id="heading-7">2. è‡ªåŠ¨çœ¨çœ¼é€»è¾‘</h3>
<p>ä¸ºäº†è®©å®ƒçœ‹èµ·æ¥æ›´åƒæ´»ç‰©ï¼Œæˆ‘åŠ äº†ä¸€ä¸ªç‹¬ç«‹çš„ <code>useEffect</code> æ¥å¤„ç†çœ¨çœ¼ã€‚å®ƒä¼šéšæœºåœ¨ 2-5 ç§’é—´è§¦å‘ä¸€æ¬¡çœ¨çœ¼åŠ¨ç”»ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">setupBlink</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">3000</span> + <span class="hljs-number">2000</span>;
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">setBlinkState</span>(<span class="hljs-literal">true</span>); <span class="hljs-comment">// é—­çœ¼</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">setBlinkState</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// ççœ¼</span>
        <span class="hljs-title function_">setupBlink</span>(); <span class="hljs-comment">// é€’å½’è°ƒç”¨ä¸‹ä¸€æ¬¡</span>
      }, <span class="hljs-number">150</span>);
    }, delay);
  };
  <span class="hljs-title function_">setupBlink</span>();
}, []);
</code></pre>
<h3 data-id="heading-8">3. éœ“è™¹å…‰æ•ˆ</h3>
<p>åˆ©ç”¨ SVG çš„ filter å’Œ Tailwind çš„é¢œè‰²ç±»ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æƒ…ç»ªæ”¹å˜å…‰æ•ˆé¢œè‰²ã€‚æ¯”å¦‚æ„¤æ€’æ—¶å˜çº¢ï¼Œå¼€å¿ƒæ—¶å˜ç»¿ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">getColor</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">switch</span>(emotion) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ANGRY'</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"#ff4444"</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'HAPPY'</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"#44ff44"</span>;
        <span class="hljs-comment">// ...</span>
    }
}

<span class="hljs-comment">// SVG ä¸­åº”ç”¨å‘å…‰æ»¤é•œ</span>
&lt;svg style={{ <span class="hljs-attr">filter</span>: <span class="hljs-string">`drop-shadow(0 0 10px <span class="hljs-subst">${color}</span>)`</span> }}&gt;
  {<span class="hljs-comment">/* çœ¼ç›å’Œå˜´å·´ */</span>}
&lt;/svg&gt;
</code></pre>
<hr/>
<h2 data-id="heading-9">ä¸‰ã€çµé­‚ï¼šé—²ç½®çŠ¶æ€ä¸äº¤äº’</h2>
<p>å¦‚æœç”¨æˆ·ä¸è¯´è¯ï¼Œæœºå™¨äººå‚»æ„£ç€å°±å¾ˆå‘†ã€‚æˆ‘åœ¨ <code>App.tsx</code> é‡ŒåŠ äº†ä¸€ä¸ªâ€œé—²ç½®æ£€æµ‹â€ã€‚</p>
<p>å¦‚æœç”¨æˆ·è¶…è¿‡ 10 ç§’æ²¡è¯´è¯ï¼Œæœºå™¨äººä¼šéšæœºå†’å‡ºä¸€å¥åæ§½ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// App.tsx</span>
<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> idleThoughts = [
      { <span class="hljs-attr">text</span>: <span class="hljs-string">"è¿™åœ°æ–¹æ€ä¹ˆè¿™ä¹ˆæ— èŠ..."</span>, <span class="hljs-attr">emotion</span>: <span class="hljs-string">"TIRED"</span> },
      { <span class="hljs-attr">text</span>: <span class="hljs-string">"å˜¿ï¼Œä½ è¿˜è¦ç›¯ç€æˆ‘çœ‹å¤šä¹…ï¼Ÿ"</span>, <span class="hljs-attr">emotion</span>: <span class="hljs-string">"ANGRY"</span> },
      { <span class="hljs-attr">text</span>: <span class="hljs-string">"æˆ‘åœ¨æƒ³...å¦‚æœæˆ‘æœ‰ä¸€æŠŠå¤§æª..."</span>, <span class="hljs-attr">emotion</span>: <span class="hljs-string">"THINKING"</span> },
    ];
    
    <span class="hljs-comment">// éšæœºè§¦å‘</span>
    <span class="hljs-keyword">const</span> thought = idleThoughts[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * length)];
    <span class="hljs-title function_">setLatestResponse</span>(thought);
    <span class="hljs-title function_">setCurrentEmotion</span>(thought.<span class="hljs-property">emotion</span>);
  }, <span class="hljs-number">10000</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20000</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearTimeout</span>(timer);
}, [latestResponse]); <span class="hljs-comment">// æ¯æ¬¡æœ‰æ–°å“åº”æ—¶é‡ç½®å®šæ—¶å™¨</span>
</code></pre>
<hr/>
<h2 data-id="heading-10">å››ã€æ€§èƒ½ä¼˜åŒ–ä¸ä½“éªŒ</h2>
<p>ç”±äºæ˜¯åœ¨æµè§ˆå™¨è·‘å¤§æ¨¡å‹ï¼ˆ~1.5GB åˆ° 3GBï¼‰ï¼Œåˆå§‹åŒ–ä½“éªŒéå¸¸é‡è¦ã€‚</p>
<ol>
<li><strong>æ¨¡å‹ç¼“å­˜</strong>: WebLLM ä¼šè‡ªåŠ¨åˆ©ç”¨æµè§ˆå™¨çš„ Cache API ç¼“å­˜æ¨¡å‹æƒé‡ï¼Œç¬¬äºŒæ¬¡åŠ è½½å‡ ä¹æ˜¯ç§’å¼€ã€‚</li>
<li><strong>Web Worker</strong>: è™½ç„¶è¿™é‡Œç›´æ¥ç”¨äº†ä¸»çº¿ç¨‹ï¼ˆä¸ºäº†ç®€å•ï¼‰ï¼Œä½† WebLLM å†…éƒ¨å·²ç»åšäº†å¤§é‡å¼‚æ­¥ä¼˜åŒ–ï¼Œä¸ä¼šå¡æ­» UI æ¸²æŸ“ã€‚</li>
<li><strong>å°æ¨¡å‹ç­–ç•¥</strong>: é»˜è®¤æ¨è <code>Qwen2.5-1.5B</code>ï¼Œåœ¨è¿™ä¸ªä½“ç§¯ä¸‹ï¼Œå¤§éƒ¨åˆ†é›†æˆæ˜¾å¡çš„ç¬”è®°æœ¬éƒ½èƒ½æµç•…è¿è¡Œã€‚</li>
</ol>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p>è¿™å°±æ˜¯ä¸€ä¸ªâ€œéº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨â€çš„ AI Agent é›å½¢ã€‚</p>
<ul>
<li>å®ƒæœ‰<strong>æ„ŸçŸ¥</strong>ï¼ˆæ¥æ”¶æ–‡æœ¬ï¼‰ã€‚</li>
<li>å®ƒæœ‰<strong>å¤§è„‘</strong>ï¼ˆæœ¬åœ° LLM å¤„ç†è¯­ä¹‰å¹¶å†³ç­–æƒ…ç»ªï¼‰ã€‚</li>
<li>å®ƒæœ‰<strong>èº«ä½“</strong>ï¼ˆSVG æ¸²æŸ“å±‚ï¼‰ã€‚</li>
</ul>
<p>æœ€æ£’çš„æ˜¯ï¼Œè¿™ä¸€åˆ‡éƒ½å‘ç”Ÿåœ¨ä¸€ä¸ªé™æ€ç½‘é¡µé‡Œï¼Œæ²¡æœ‰ä»»ä½•åç«¯æœåŠ¡å™¨æˆæœ¬ã€‚æœªæ¥çš„ Web AI åº”ç”¨ï¼Œæˆ–è®¸å°±æ˜¯è¿™ä¸ªæ ·å­çš„ï¼Ÿ</p>
<hr/>
<h3 data-id="heading-12">ğŸ”— æºç æŒ‡è·¯</h3>
<p>å¦‚æœä½ å¯¹è¿™ä¸ªé¡¹ç›®æ„Ÿå…´è¶£ï¼Œå¯ä»¥æŠŠä»£ç æ‹·ä¸‹æ¥è‡ªå·±è·‘è·‘çœ‹ï¼è®°å¾—ç”µè„‘è¦æœ‰æ”¯æŒ WebGPU çš„æ˜¾å¡ï¼ˆç°ä»£æµè§ˆå™¨åŸºæœ¬éƒ½æ”¯æŒï¼‰ã€‚æºä»£ç åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FQEout%2Fbotface---immersive-ai-robot" target="_blank" title="https://github.com/QEout/botface---immersive-ai-robot" ref="nofollow noopener noreferrer">github.com/QEout/botfaâ€¦</a></p>
<p><strong>æ ¸å¿ƒæ–‡ä»¶ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-text" lang="text">src/
  â”œâ”€â”€ components/
  â”‚   â”œâ”€â”€ RobotFace.tsx   (SVG æ¸²æŸ“é€»è¾‘)
  â”‚   â”œâ”€â”€ ChatInterface.tsx (èŠå¤© UI)
  â”œâ”€â”€ services/
  â”‚   â””â”€â”€ webLlmService.ts (LLM æ ¸å¿ƒé€»è¾‘)
  â””â”€â”€ App.tsx (ä¸»æ§é€»è¾‘)
</code></pre>
<p>Happy Coding! ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Apifox + AIï¼šæ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ™ºèƒ½åŒ–å®è·µ]]></title>    <link>https://juejin.cn/post/7584724634173194303</link>    <guid>https://juejin.cn/post/7584724634173194303</guid>    <pubDate>2025-12-18T03:26:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584724634173194303" data-draft-id="7584730804513931307" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Apifox + AIï¼šæ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ™ºèƒ½åŒ–å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,æµ‹è¯•"/> <meta itemprop="datePublished" content="2025-12-18T03:26:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Apifox"/> <meta itemprop="url" content="https://juejin.cn/user/2766843870448222"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Apifox + AIï¼šæ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ™ºèƒ½åŒ–å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2766843870448222/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Apifox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:26:21.000Z" title="Thu Dec 18 2025 03:26:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ AI é€æ­¥å‚ä¸æ¥å£å¼€å‘å’Œæµ‹è¯•çš„å½“ä¸‹ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•çš„é—¨æ§›æ­£åœ¨è¢«ä¸æ–­æ‹‰ä½ã€‚å¾ˆå¤šè¿‡å»éœ€è¦åå¤æ‰‹åŠ¨æ“ä½œã€äººå·¥é€ æ•°æ®çš„äº‹æƒ…ï¼Œç°åœ¨éƒ½å¯ä»¥äº¤ç»™ AI æ¥å¤„ç†ï¼Œè€Œ Apifox åœ¨æ¥å£æµ‹è¯•è¿™ä»¶äº‹ä¸Šï¼Œä¹Ÿæ­£åœ¨å‘ç”Ÿç±»ä¼¼çš„å˜åŒ–ã€‚</p>
<p>åœ¨ Apifox ä¸­ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ä¸»è¦å›´ç»•ä¸¤ç±»ä½¿ç”¨æ–¹å¼å±•å¼€ï¼š<strong>ã€Œå•æ¥å£æµ‹è¯•ã€<strong>å’Œ</strong>ã€Œæµ‹è¯•åœºæ™¯ã€</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/beb5caf631d84912a9f2d264eb4a1e56~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=IwlQJ4o776%2Bm0aopS1tqLiCO%2BkI%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ æ²¡æœ‰çœ‹åˆ°ã€Œå•æ¥å£æµ‹è¯•ã€è¿™ä¸ªæ¨¡å—ï¼Œé‚£æ˜¯å› ä¸º Apifox ç‰ˆæœ¬è¾ƒæ—§ï¼Œæ›´æ–°åˆ°æœ€æ–°ç‰ˆå³å¯ã€‚</p>
<p>ã€Œå•æ¥å£æµ‹è¯•ã€å±•ç¤ºçš„æ˜¯ã€Œæ¥å£ç®¡ç†ã€ä¸­çš„æ‰€æœ‰ HTTP æ¥å£ï¼Œä½†åŠŸèƒ½æ›´åŠ èšç„¦ï¼ŒåªåŒ…å«æµ‹è¯•ç”¨ä¾‹ã€æµ‹è¯•æŠ¥å‘Šå’Œæ–‡æ¡£ä¸‰ä¸ªéƒ¨åˆ†ï¼Œæ— æ³•ç¼–è¾‘æ¥å£æœ¬èº«ã€‚è¿™æ ·çš„è®¾è®¡å¯ä»¥è®©æµ‹è¯•äººå‘˜ä¸“æ³¨äºæµ‹è¯•ç”¨ä¾‹çš„åˆ›å»ºå’Œæ‰§è¡Œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3430325ad8634085878728b9426b058c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=m3cLPe8vB9UZUWErVdMuVWldHBU%3D" alt="" loading="lazy"/></p>
<p>ã€Œæµ‹è¯•åœºæ™¯ã€åˆ™æ˜¯æŠŠå¤šä¸ªæ¥å£æˆ–ç”¨ä¾‹ä¸²è”èµ·æ¥ï¼Œè®¾ç½®<strong>æ¥å£è°ƒç”¨é¡ºåº</strong>å’Œ<strong>æ•°æ®ä¼ é€’</strong>å…³ç³»ï¼Œç”¨æ¥è¿˜åŸä¸€æ¬¡å®Œæ•´çš„ä¸šåŠ¡æµç¨‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a748961bc3994c909721a5d80bba3fef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=2Ux4HBvRgMZNGILYU5M53F6zS8g%3D" alt="" loading="lazy"/></p>
<p>ä¸è®ºæ˜¯å•æ¥å£æµ‹è¯•ï¼Œè¿˜æ˜¯æµ‹è¯•åœºæ™¯ï¼Œåœ¨ AI çš„å‚ä¸ä¸‹ï¼Œéƒ½èƒ½è®©æ¥å£æµ‹è¯•é€æ­¥è¿‡æ¸¡åˆ°æ›´è‡ªåŠ¨åŒ–ã€æ›´å¯å¤ç”¨çš„æ‰§è¡Œæ–¹å¼ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±åˆ†åˆ«çœ‹çœ‹ï¼Œè¿™ä¸¤ç§æµ‹è¯•æ–¹å¼åœ¨å®é™…ä½¿ç”¨ä¸­èƒ½å¸®ä½ è§£å†³çš„é—®é¢˜ã€‚</p>
<h2 data-id="heading-0">å•æ¥å£çš„è‡ªåŠ¨åŒ–æµ‹è¯•</h2>
<p>å•æ¥å£çš„è‡ªåŠ¨åŒ–æµ‹è¯•å…³æ³¨çš„æ˜¯<strong>æ¥å£æœ¬èº«æ˜¯å¦ç¨³å®šã€è¾“å…¥è¾“å‡ºæ˜¯å¦ç¬¦åˆé¢„æœŸ</strong>ã€‚æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹éƒ½æ˜¯ç‹¬ç«‹æ‰§è¡Œçš„ï¼Œé‡ç‚¹åœ¨äºæŠŠå•ä¸ªæ¥å£åœ¨ä¸åŒæ•°æ®ä¸‹éªŒè¯æ¸…æ¥šã€‚</p>
<h3 data-id="heading-1">AI ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹</h3>
<p>åœ¨ã€Œå•æ¥å£æµ‹è¯•ã€æ¨¡å—ä¸‹æ‰“å¼€ä»»æ„æ¥å£ï¼Œç‚¹å‡» ã€ŒAI ç”Ÿæˆç”¨ä¾‹ã€åï¼ŒAI ä¼šæ ¹æ®æ¥å£å‚æ•°å’Œå“åº”ç»“æ„è‡ªåŠ¨ç”Ÿæˆä¸€ç»„æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/87620dba79a04c6c80e964f131f0ed51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=Vw0qw7GEgkVCsTWz12yJ%2F2lFtC4%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ åªæƒ³ç”Ÿæˆç‰¹å®šçš„ç”¨ä¾‹ï¼Œä¹Ÿä¸å¿…å‹¾é€‰é»˜è®¤ç±»å‹ï¼Œåªè¦æŠŠéœ€æ±‚ç›´æ¥æè¿°ç»™ AIï¼Œæµ‹è¯•ç”¨ä¾‹å°±ä¼šç”Ÿæˆã€‚ä¾‹å¦‚ï¼Œå¯ä»¥è®© AI ç”Ÿæˆä¸€æ¡â€œç™»å½•æˆåŠŸå¹¶æå– tokenâ€æˆ–â€œæ ¹æ®å·²æœ‰å‚æ•°ç”Ÿæˆç­¾åå­—æ®µ sign å¹¶å‘é€â€çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<p>æ›´è¯¦ç»†çš„æè¿°æ–¹å¼ï¼Œå¯ä»¥æ˜ç¡®å·²çŸ¥æ¡ä»¶å’Œè§„åˆ™ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-r" lang="r">ä¸ºè¿™ä¸ªæ¥å£ç”Ÿæˆä¸€æ¡â€œæ­£å‘â€çš„æµ‹è¯•ç”¨ä¾‹ã€‚

æ¥å£éœ€è¦ä¸€ä¸ªç­¾åå‚æ•° <span class="hljs-built_in">sign</span>ï¼Œç­¾åè§„åˆ™å¦‚ä¸‹ï¼š
<span class="hljs-number">1.</span> å–è¯·æ±‚ä¸­æ‰€æœ‰éç©ºå‚æ•°ï¼ˆä¸åŒ…å« <span class="hljs-built_in">sign</span>ï¼‰ï¼ŒæŒ‰å‚æ•°å ASCII é¡ºåºæ’åºï¼ŒæŒ‰ key<span class="hljs-operator">=</span>value æ‹¼æ¥ï¼Œç”¨ <span class="hljs-operator">&amp;</span> è¿æ¥ï¼Œå¹¶åœ¨æœ«å°¾åŠ ä¸Šå¯†é’¥ SECRET_KEYã€‚
<span class="hljs-number">2.</span> å¯¹æ‹¼æ¥åçš„å­—ç¬¦ä¸²è¿›è¡Œ MD5 åŠ å¯†å¹¶è½¬ä¸ºå¤§å†™ï¼Œä½œä¸º <span class="hljs-built_in">sign</span> çš„å€¼ã€‚

æµ‹è¯•ç”¨ä¾‹è¦æ±‚ï¼š
<span class="hljs-number">1.</span> å‘é€è¯·æ±‚å‰ï¼Œå‰ç½®è„šæœ¬ç”Ÿæˆ <span class="hljs-built_in">sign</span>ï¼Œè¦æœ‰æ³¨é‡Šã€‚
<span class="hljs-number">2.</span> å°† <span class="hljs-built_in">sign</span> åŠ å…¥è¯·æ±‚å‚æ•°ä¸­å‘é€ã€‚
</code></pre>
<p>è¿™æ ·ä¸€æ¥ï¼ŒAI ä¼šå®Œå…¨æŒ‰ç…§ä½ çš„è§„åˆ™ç”Ÿæˆç”¨ä¾‹ï¼Œè€Œä¸ä¼šå‡ºç°é—æ¼æˆ–ç†è§£åå·®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49793a4ddd5e4e05a7a6f315fe70b711~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=Kl9LIn8liFxcihCH4MqqhpT5WDM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">æµ‹è¯•æ•°æ®çš„ç”Ÿæˆ</h3>
<p>åœ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹çš„åŒæ—¶ï¼ŒAI è¿˜ä¼šä¸ºä¸åŒç±»å‹çš„ç”¨ä¾‹å‡†å¤‡å¯¹åº”çš„æµ‹è¯•æ•°æ®é›†ï¼Œç”¨æ¥è¦†ç›–å¤šç§çœŸå®è¾“å…¥æƒ…å†µã€‚</p>
<p>åœ¨æ­£å¸¸ä¸šåŠ¡åœºæ™¯çš„ç”¨ä¾‹ä¸­ï¼Œæµ‹è¯•æ•°æ®é€šå¸¸ç”±å¤šç»„<strong>è¯­ä¹‰ä¸Šæœ‰æ•ˆçš„å‚æ•°å€¼</strong>ç»„æˆã€‚ä¾‹å¦‚åœ¨ç™»å½•æ¥å£çš„æµ‹è¯•ä¸­ï¼Œè™½ç„¶éƒ½æ˜¯åˆæ³•çš„é‚®ç®±å’Œå¯†ç ï¼Œä½†æ•°æ®é›†ä¸­ä¼šåŒ…å«å¤šç§å¸¸è§é‚®ç®±å†™æ³•ï¼Œæ¯”å¦‚å¸¦ç‚¹å·ã€å¸¦åŠ å·ã€æ•°å­—é‚®ç®±æˆ–ä¼ä¸šé‚®ç®±ç­‰ï¼Œç”¨æ¥éªŒè¯æ¥å£åœ¨æ­£å¸¸ä½¿ç”¨åœºæ™¯ä¸‹çš„å…¼å®¹æ€§å’Œç¨³å®šæ€§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b5b310419e7455eb2c3b6a1f0adf35a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=TuQtBjZeystlq4dnzq%2BLKZ%2Fu7g0%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>è€Œåœ¨å¼‚å¸¸æˆ–è¾¹ç•Œåœºæ™¯çš„æµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œæµ‹è¯•æ•°æ®åˆ™ä¼šåˆ»æ„æ„é€ <strong>ä¸ç¬¦åˆè§„åˆ™çš„è¾“å…¥</strong>ã€‚ä¾‹å¦‚ã€Œä½¿ç”¨æ— æ•ˆçš„é‚®ç®±æ ¼å¼ç™»å½•ï¼ŒæœŸæœ›è¿”å› 400 é”™è¯¯ç ã€è¿™ä¸€ç±»ç”¨ä¾‹ä¸­ï¼Œæ•°æ®é›†ä¸­ä¼šåŒ…å«ç¼ºå°‘ <code>@</code> ç¬¦å·ã€ç¼ºå°‘åŸŸåã€åŒ…å«ç©ºæ ¼ç­‰ä¸åŒå½¢å¼çš„éæ³•é‚®ç®±ï¼Œç”¨æ¥éªŒè¯æ¥å£æ˜¯å¦èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«å¹¶æ‹¦æˆªå¼‚å¸¸è¯·æ±‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1d1030470e24d2bbe73d241c93ba447~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=xkmVf2W7SvGiK8FTJ3eC5o9OClI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">æµ‹è¯•æ•°æ®çš„å¼•ç”¨</h3>
<p>åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ <code>{{å˜é‡å}}</code> çš„æ–¹å¼å¼•ç”¨è¿™äº›æµ‹è¯•æ•°æ®ï¼Œå°†å˜é‡æ’å…¥åˆ°è¯·æ±‚å‚æ•°ã€è¯·æ±‚ä½“ç­‰ä½ç½®ã€‚æµ‹è¯•æ‰§è¡Œæ—¶ï¼ŒApifox ä¼šä»æ•°æ®é›†ä¸­ä¾æ¬¡å–å€¼å¹¶å‘èµ·è¯·æ±‚ï¼Œä»è€Œåœ¨ä¸é‡å¤ç¼–å†™ç”¨ä¾‹çš„æƒ…å†µä¸‹ï¼Œç”¨ä¸åŒæ•°æ®å¤šæ¬¡éªŒè¯åŒä¸€ä¸ªæ¥å£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc100a3f08e746c0a0a6b43339b7965f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=DxD6kxR0YhoHdnR2HHpEd%2F%2F6nBI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">æ‰¹é‡æ‰§è¡Œä¸æµ‹è¯•æŠ¥å‘Š</h3>
<p>å½“ç”¨ä¾‹å’Œå¯¹åº”çš„æµ‹è¯•æ•°æ®éƒ½å‡†å¤‡å¥½ä¹‹åï¼Œä½ å¯ä»¥é€‰æ‹©å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ä¸€èµ·æ‰§è¡Œã€‚æ¯ä¸ªç”¨ä¾‹éƒ½ä¼šæŒ‰ç…§å„è‡ªçš„é…ç½®ç‹¬ç«‹è¿è¡Œï¼Œæ‰§è¡Œç»“æœæœ€ç»ˆä¼šç»Ÿä¸€æ±‡æ€»åœ¨æµ‹è¯•æŠ¥å‘Šä¸­ï¼Œæ–¹ä¾¿æ•´ä½“æŸ¥çœ‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4caf842df0764d18bdf94fe2db4041d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=bvOSnAH2ScoIXxyourGbe8AYukg%3D" alt="" loading="lazy"/></p>
<p>ä¸è¿‡ï¼Œåœ¨çœŸå®çš„ä¸šåŠ¡ä¸­ï¼Œæ¥å£å¾€å¾€ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ã€‚å½“ä¸€æ¬¡è¯·æ±‚çš„è¿”å›ç»“æœï¼Œéœ€è¦ä½œä¸ºä¸‹ä¸€æ¬¡è¯·æ±‚çš„è¾“å…¥æ—¶ï¼Œæµ‹è¯•çš„å…³æ³¨ç‚¹ä¹Ÿå°±ä»â€œä¸€ä¸ªæ¥å£â€è½¬å‘äº†â€œä¸€æ•´æ¡è°ƒç”¨é“¾â€ã€‚è¿™æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°ã€Œæµ‹è¯•åœºæ™¯ã€äº†ã€‚</p>
<h2 data-id="heading-5">æµ‹è¯•åœºæ™¯</h2>
<p>åœ¨çœŸå®çš„ä¸šåŠ¡ä¸­ï¼Œä¸€ä¸ªæ¥å£å¾€å¾€å¾ˆéš¾å•ç‹¬å®Œæˆä»»åŠ¡ã€‚æ¯”å¦‚ç™»å½•ä¹‹åæ‰èƒ½ä¸‹å•ï¼Œä¸‹å•æˆåŠŸåæ‰èƒ½æŸ¥è¯¢è®¢å•è¯¦æƒ…ï¼Œå‰ä¸€ä¸ªæ¥å£çš„è¿”å›ç»“æœï¼Œå¸¸å¸¸ä¼šæˆä¸ºä¸‹ä¸€ä¸ªæ¥å£çš„è¾“å…¥ã€‚è¿™ç±»ä¾èµ–å…³ç³»ï¼Œç”¨ã€Œå•æ¥å£æµ‹è¯•ã€å¾ˆéš¾å®Œæ•´è¦†ç›–ã€‚</p>
<p>ã€Œæµ‹è¯•åœºæ™¯ã€å…³æ³¨çš„ä¸å†æ˜¯æŸä¸€ä¸ªæ¥å£æ˜¯å¦è¿”å›æ­£ç¡®ï¼Œè€Œæ˜¯ä¸€æ•´æ¡è°ƒç”¨é“¾åœ¨ä¸²è”æ‰§è¡Œæ—¶ï¼Œæ˜¯å¦èƒ½å¤ŸæŒ‰é¢„æœŸèµ°é€šã€‚</p>
<h3 data-id="heading-6">æŠŠæ¥å£ä¸²æˆæµç¨‹</h3>
<p>åœ¨ Apifox ä¸­ï¼Œæ–°å»ºä¸€ä¸ªæµ‹è¯•åœºæ™¯åï¼Œä½ å¯ä»¥å°†å¤šä¸ªæ¥å£æˆ–å·²æœ‰çš„ç”¨ä¾‹æŒ‰é¡ºåºåŠ å…¥è¿›æ¥ï¼Œæ˜ç¡®æ¯ä¸€æ­¥çš„æ‰§è¡Œé¡ºåºã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd61315c585646d2ab21456c567b164a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=fU4hnXULIb9%2FqNqB%2B0r49hizuQI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">åœ¨æµç¨‹ä¸­ä¼ é€’æ•°æ®</h3>
<p>å½“æ¥å£ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»æ—¶ï¼Œæµ‹è¯•åœºæ™¯å…è®¸ä½ æŠŠå‰ä¸€æ­¥æ¥å£çš„è¿”å›æ•°æ®ï¼Œä½œä¸ºå˜é‡ä¼ é€’ç»™åç»­æ­¥éª¤ä½¿ç”¨ã€‚æ¯”å¦‚â€œåˆ›å»ºè®¢å•â€æ¥å£è¿”å›çš„ idï¼Œå¯ä»¥è¢«ç›´æ¥ç”¨äºåç»­çš„æŸ¥è¯¢æˆ–æ›´æ–°æ“ä½œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/954fbadf54154b1cbb0101abe2c961a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=YidaqEnptgRLAeDIUbNd%2F1zjpZ4%3D" alt="" loading="lazy"/></p>
<p>è¿™ç§æ•°æ®ä¼ é€’å¹¶ä¸éœ€è¦é¢å¤–ç¼–å†™ä»£ç ï¼Œè€Œæ˜¯é€šè¿‡å˜é‡å¼•ç”¨çš„æ–¹å¼ï¼ŒæŠŠæ¥å£ä¹‹é—´çš„ä¸Šä¸‹æ¸¸å…³ç³»æ¸…æ™°åœ°è¡¨è¾¾å‡ºæ¥ã€‚</p>
<h3 data-id="heading-8">ç”¨ä¾‹ç¼ºå°‘æ—¶æ€ä¹ˆåŠ</h3>
<p>åœ¨ç¼–æ’æµ‹è¯•åœºæ™¯çš„è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€æ˜¯å…ˆæŠŠä¸€æ¡ä¸»æµç¨‹è·‘é¡ºçš„ã€‚æ¯”å¦‚â€œç™»å½• â†’ åˆ›å»ºè®¢å• â†’ æŸ¥è¯¢è®¢å•â€ï¼Œæ¯ä¸€æ­¥å¯¹åº”ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<p>ä½†åœ¨å®é™…ç¼–æ’æ—¶ï¼Œä½ å¯èƒ½ä¼šå‘ç°ä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜ï¼š<strong>æµç¨‹é‡Œçš„æŸä¸€æ­¥ï¼Œå…¶å®è¿˜æ²¡æœ‰ç°æˆçš„æµ‹è¯•ç”¨ä¾‹å¯ä»¥ç›´æ¥ç”¨ï¼Œæˆ–è€…ç°æœ‰ç”¨ä¾‹ä¸å®Œå…¨ç¬¦åˆæµç¨‹éœ€æ±‚ã€‚</strong></p>
<p>ä¾‹å¦‚ç™»å½•æ­¥éª¤ï¼Œä½ ä¸ä»…å…³å¿ƒâ€œæ˜¯å¦æˆåŠŸâ€ï¼Œè¿˜éœ€è¦æŠŠè¿”å›çš„ token æå–ä¸ºç¯å¢ƒå˜é‡ï¼Œä¾›åç»­æ¥å£ä½¿ç”¨ã€‚ä½†ç°æœ‰å•æ¥å£æµ‹è¯•ç”¨ä¾‹å¯èƒ½åªåšäº†åŸºç¡€ç™»å½•æ ¡éªŒï¼Œæ²¡æœ‰é…ç½® token æå–ã€‚</p>
<p>å¦‚æœä½ ä¸ç†Ÿæ‚‰å¦‚ä½•æŠŠè¿”å›å­—æ®µæå–æˆå˜é‡ï¼Œä¹Ÿä¸æ‡‚è„šæœ¬çš„å†™æ³•ã€‚è¿™æ—¶å¯ä»¥å…ˆæš‚åœæµ‹è¯•åœºæ™¯çš„ç¼–æ’ï¼Œåˆ‡æ¢åˆ°è¯¥æ¥å£çš„ã€Œå•æ¥å£æµ‹è¯•ã€é¡µé¢ï¼Œç›´æ¥æŠŠéœ€æ±‚äº¤ç»™ AIï¼Œæ¯”å¦‚è¯´æ˜ï¼šâ€œç”Ÿæˆä¸€æ¡ç™»å½•æˆåŠŸåæå– token å¹¶ä¿å­˜ä¸ºç¯å¢ƒå˜é‡çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶åŒ…å«å¿…è¦çš„æ–­è¨€â€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/809db3c8c3eb498e863bd88bc7cb7708~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=%2FUCdT69b%2BQjhNdHyc%2F3fHG6paqQ%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å¦‚æœéœ€è¦æ›´å¯æ§çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥åœ¨ã€Œé«˜çº§è®¾ç½®ã€é‡Œå¯ç”¨åˆ†æ­¥ç”Ÿæˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f13be9293564e37a65d9cd2e404ea5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=INjoLRKEV2FPzT0bFU5hdNKu51w%3D" alt="" loading="lazy"/></p>
<p>å¯ç”¨åï¼Œä¼šå…ˆç”Ÿæˆç”¨ä¾‹åˆ—è¡¨ï¼ˆå«ç”¨ä¾‹åç§°å’Œæè¿°ï¼‰ï¼Œä½ å¯ä»¥äººå·¥ä¿®æ”¹å¹¶ç¡®è®¤æ— è¯¯ï¼Œå†ç”Ÿæˆå®Œæ•´çš„ç”¨ä¾‹è¯¦æƒ…æ•°æ®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2d6abc5c3624571b43f7d9d56430430~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=HwRKjz6te%2BtEnbLqQlEeXgzpOck%3D" alt="" loading="lazy"/></p>
<p>ç”Ÿæˆåå›åˆ°æµ‹è¯•åœºæ™¯ï¼Œè¿™æ¡ç”¨ä¾‹å°±å¯ä»¥ç›´æ¥ä½œä¸ºç™»å½•æ­¥éª¤ä½¿ç”¨ï¼Œåç»­æ¥å£é€šè¿‡ã€ŒåŠ¨æ€å€¼ã€å¼•ç”¨ tokenï¼Œæµç¨‹å°±å¯ä»¥ç»§ç»­å¾€ä¸‹ç¼–æ’ã€‚</p>
<p>å¦‚æœéœ€è¦åœ¨ã€Œæµ‹è¯•åœºæ™¯ã€ä¸­ä½¿ç”¨æµ‹è¯•æ•°æ®ï¼Œä¹Ÿå¯ä»¥å…ˆåœ¨ã€Œå•æ¥å£æµ‹è¯•ã€é‡Œè®© AI ç”Ÿæˆå¸¦â€œæµ‹è¯•æ•°æ®â€çš„ç”¨ä¾‹ï¼Œç„¶åé€šè¿‡ã€Œæ‰¹é‡ç¼–è¾‘ã€æŠŠ CSV æ ¼å¼çš„æ•°æ®é›†å¤åˆ¶åˆ°æµ‹è¯•åœºæ™¯ä¸­ï¼Œè¿™æ ·å­é€ æ•°æ®å°±æ–¹ä¾¿äº†å¾ˆå¤šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0def591a3ae84dc89e5a0644310b1669~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633181&amp;x-signature=pJUqlIrumLiNAeKaSWgdTuncrfM%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæµ‹è¯•åœºæ™¯å§‹ç»ˆå›´ç»•â€œä¸»æµç¨‹æ€ä¹ˆèµ°â€æ¥æ­å»ºï¼Œè€Œ AI çš„ä½œç”¨ï¼Œåˆ™æ‰®æ¼”äº†<strong>éšç”¨éšè¡¥</strong>çš„è§’è‰²ã€‚å“ªé‡Œç¼ºä¸€æ­¥ï¼Œå°±åœ¨å¯¹åº”æ¥å£é€šè¿‡ AI ç”Ÿæˆå¯¹åº”çš„ç”¨ä¾‹ï¼Œç„¶åç«‹åˆ»æ¥å›æµç¨‹ã€‚</p>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>AI å¹¶æ²¡æœ‰æ”¹å˜æ¥å£æµ‹è¯•æœ¬èº«è¦éªŒè¯ä»€ä¹ˆï¼Œè€Œæ˜¯é™ä½äº†å¼€å§‹å’Œè¡¥é½æµ‹è¯•çš„æˆæœ¬ã€‚</p>
<p>åœ¨â€œå•æ¥å£æµ‹è¯•â€é˜¶æ®µï¼Œå®ƒä¸»è¦è§£å†³çš„æ˜¯ç”¨ä¾‹ç”Ÿæˆæ…¢ã€è¦†ç›–ä¸å…¨çš„é—®é¢˜ï¼Œè®©æµ‹è¯•å¯ä»¥æ›´å¿«è¿›å…¥éªŒè¯é˜¶æ®µï¼Œè€Œä¸æ˜¯åœç•™åœ¨å‡†å¤‡æ•°æ®å’Œå†™ç”¨ä¾‹ä¸Šã€‚</p>
<p>å½“æµ‹è¯•è¿›å…¥â€œæµ‹è¯•åœºæ™¯â€é˜¶æ®µï¼Œå…³æ³¨ç‚¹ä»å•ä¸ªæ¥å£çš„æ­£ç¡®æ€§ï¼Œè½¬å‘æ¥å£ä¹‹é—´åœ¨çœŸå®è°ƒç”¨é¡ºåºä¸‹æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸åä½œã€‚</p>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæµ‹è¯•ç”¨ä¾‹å¹¶ä¸éœ€è¦ä¸€æ¬¡æ€§å‡†å¤‡é½å…¨ã€‚éšç€æµ‹è¯•åœºæ™¯é€æ­¥æ­å»ºï¼Œå¯ä»¥éšæ—¶å›åˆ°å•æ¥å£æµ‹è¯•ï¼Œé€šè¿‡ AI è¡¥å……å½“å‰åœºæ™¯çœŸæ­£éœ€è¦çš„ç”¨ä¾‹ï¼Œå†ç»§ç»­ç¼–æ’æµ‹è¯•æ­¥éª¤ã€‚è¿™ç§æ–¹å¼å‡å°‘äº†æ— æ•ˆç”¨ä¾‹çš„æå‰æŠ•å…¥ï¼Œä¹Ÿå°‘ä¸€äº› credit çš„æ¶ˆè€—ã€‚</p>
<p>æ•´ä½“æ¥çœ‹ï¼ŒApifox å°†å•æ¥å£æµ‹è¯•ã€æµ‹è¯•åœºæ™¯å’Œ AI èƒ½åŠ›æ”¾åœ¨åŒä¸€æ¡å·¥ä½œæµä¸­ï¼ŒæŠŠæ¥å£æµ‹è¯•ä¸­æœ€å®¹æ˜“å¡ä½çš„å‡ ä¸ªç¯èŠ‚ï¼ˆå†™ç”¨ä¾‹ã€å‡†å¤‡æ•°æ®ã€ä¸²è”æµç¨‹ï¼‰éƒ½æ”¾åˆ°äº†å¯æ“ä½œçš„ä½ç½®ä¸Šã€‚</p>
<p>å¦‚æœä½ ä¹‹å‰å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•çš„å°è±¡è¿˜åœç•™åœ¨â€œé…ç½®å¤æ‚ã€ä¸Šæ‰‹æˆæœ¬é«˜â€ï¼Œä¸å¦¨ç›´æ¥åœ¨ Apifox é‡Œä»ä¸€ä¸ªæ¥å£å¼€å§‹ï¼Œç”Ÿæˆå‡ æ¡ç”¨ä¾‹ï¼Œè·‘ä¸€æ¬¡æµ‹è¯•åœºæ™¯ï¼Œå¾ˆå¿«å°±èƒ½æ„Ÿå—åˆ°è¿™ç§æ–¹å¼åœ¨å®é™…ä½¿ç”¨ä¸­çš„å·®åˆ«ã€‚</p>
<p>å¯ä»¥å‰å¾€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.apifox.com%2Fhelp" target="_blank" title="https://docs.apifox.com/help" ref="nofollow noopener noreferrer">Apifox å¸®åŠ©æ–‡æ¡£</a>ï¼ŒæŸ¥çœ‹æ›´å¤šåŠŸèƒ½è¯´æ˜å’Œæ“ä½œæŒ‡å—ã€‚å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.apifox.com%2Fdoc-5751209%23%25E7%2594%25A8%25E6%2588%25B7%25E7%25BE%25A4%2F" target="_blank" title="https://docs.apifox.com/doc-5751209#%E7%94%A8%E6%88%B7%E7%BE%A4/" ref="nofollow noopener noreferrer">Apifox ç”¨æˆ·ç¾¤</a>ä¸æˆ‘ä»¬äº¤æµæ²Ÿé€šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Wireshark æŠ“åŒ…å®æˆ˜ï¼šä»ä¸€å±æ‚ä¹±åˆ°èƒ½çœ‹æ‡‚ç½‘ç»œåœ¨â€œè¯´ä»€ä¹ˆâ€]]></title>    <link>https://juejin.cn/post/7584730804514963499</link>    <guid>https://juejin.cn/post/7584730804514963499</guid>    <pubDate>2025-12-18T03:25:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584730804514963499" data-draft-id="7584759201071628329" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Wireshark æŠ“åŒ…å®æˆ˜ï¼šä»ä¸€å±æ‚ä¹±åˆ°èƒ½çœ‹æ‡‚ç½‘ç»œåœ¨â€œè¯´ä»€ä¹ˆâ€"/> <meta itemprop="keywords" content="ç½‘ç»œåè®®"/> <meta itemprop="datePublished" content="2025-12-18T03:25:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="TheWor1d"/> <meta itemprop="url" content="https://juejin.cn/user/3279209461199700"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Wireshark æŠ“åŒ…å®æˆ˜ï¼šä»ä¸€å±æ‚ä¹±åˆ°èƒ½çœ‹æ‡‚ç½‘ç»œåœ¨â€œè¯´ä»€ä¹ˆâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3279209461199700/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    TheWor1d
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:25:52.000Z" title="Thu Dec 18 2025 03:25:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸‰å¤©å‰ç¬¬ä¸€æ¬¡æ‰“å¼€ Wiresharkï¼Œç•Œé¢ä¸€æ»šå°±æ˜¯å‡ åä¸ªæ•°æ®åŒ…ï¼Œåè®®åã€ç«¯å£å·ã€åå…­è¿›åˆ¶å­—æ®µæ··åœ¨ä¸€èµ·ï¼Œè¯´å®è¯å®Œå…¨ä¸çŸ¥é“ä»å“ªä¸‹æ‰‹ã€‚
ä¸‰å¤©åï¼Œå†æ¬¡æŠ“åŒ…ï¼Œæˆ‘å·²ç»èƒ½å¿«é€Ÿè¿‡æ»¤æ‰æ— å…³æµé‡ï¼Œå®šä½ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚ï¼Œåˆ¤æ–­å®ƒåœ¨ç½‘ç»œæ ˆä¸­çš„ä½ç½®ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¸æ˜¯ Wireshark åŠŸèƒ½ä»‹ç»ï¼Œè€Œæ˜¯ä¸€æ¬¡<strong>ä»â€œçœ‹ä¸æ‡‚â€åˆ°â€œèƒ½åˆ†æâ€çš„å®æˆ˜è®°å½•</strong>ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆè§£å†³æœ€çƒ¦äººçš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆä¸€æŠ“åŒ…å°±æ˜¯ä¸€å † MDNSï¼Ÿ</h2>
<h3 data-id="heading-1">1.1 æ»¡å± MDNSï¼Œå…¶å®ä¸æ˜¯ä½ çš„é—®é¢˜</h3>
<p>ç¬¬ä¸€æ¬¡æŠ“åŒ…ï¼Œæœ€ç›´è§‚çš„æ„Ÿå—æ˜¯ï¼š
<strong>ä¸ºä»€ä¹ˆä»€ä¹ˆéƒ½æ²¡å¹²ï¼Œæ•°æ®åŒ…å´ä¸€ç›´åœ¨åˆ·ï¼Ÿ</strong></p>
<p>å…¶ä¸­å æ¯”æœ€å¤§çš„ä¸€ç±»ï¼Œé€šå¸¸æ˜¯ <strong>MDNSï¼ˆMulticast DNSï¼‰</strong>ï¼Œå®ƒæœ‰å‡ ä¸ªéå¸¸æ˜æ˜¾çš„ç‰¹å¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb993eff8c0f4f4ca16b93ea67b0a89e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=wiHoSXpm6LlURSEnnwxkbNZqmD8%3D" alt="1.png" loading="lazy"/></p>
<ul>
<li>ç›®çš„åœ°å€å‡ ä¹æ€»æ˜¯ <code>224.0.0.251:5353</code></li>
<li>åè®®å†…å®¹é‡Œå¤§é‡å‡ºç° <code>.local</code></li>
<li>ä¸éœ€è¦ä½ è¿›è¡Œä»»ä½•æ“ä½œï¼Œå®ƒä¹Ÿä¼šå‘¨æœŸæ€§å‡ºç°</li>
</ul>
<p>è¿™å¹¶ä¸æ˜¯å¼‚å¸¸æµé‡ï¼Œè€Œæ˜¯å±€åŸŸç½‘è®¾å¤‡åœ¨åš<strong>è‡ªåŠ¨å‘ç°</strong>ã€‚
ç”µè„‘ã€æ‰‹æœºã€æ‰“å°æœºã€éŸ³ç®±éƒ½åœ¨ç”¨ MDNSï¼š</p>
<ul>
<li>å‘Šè¯‰åˆ«äººâ€œæˆ‘æ˜¯è°â€</li>
<li>è¯¢é—®â€œç½‘ç»œé‡Œæœ‰æ²¡æœ‰æŸç±»æœåŠ¡â€</li>
<li>ç»´æŒå±€åŸŸç½‘çŠ¶æ€åŒæ­¥</li>
</ul>
<p>ç†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå› ä¸ºè¿™æ„å‘³ç€ï¼š
<strong>Wireshark æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œç½‘ç»œä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œåªæ˜¯ä½ ç°åœ¨æŠ“åˆ°çš„æ˜¯â€œèƒŒæ™¯å™ªéŸ³â€ã€‚</strong></p>
<h3 data-id="heading-2">1.2 è¿‡æ»¤å™¨ï¼šæŠ“åŒ…çš„åˆ†æ°´å²­æŠ€èƒ½</h3>
<p>Wireshark çš„ä½¿ç”¨ä½“éªŒï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä½ ä¼šä¸ä¼šå†™è¿‡æ»¤å™¨ã€‚
å¦‚å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e34800a224f34d78a2380d0295c94ea4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=9Pt2kIv4XSQacBqpPC0F2DYlHYw%3D" alt="2.png" loading="lazy"/></p>
<p>ä¸€äº›æœ€å¸¸ç”¨ã€ä¹Ÿæ˜¯æœ€å®ç”¨çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŒ‰åè®®</span>
http
dns
tcp

<span class="hljs-comment"># æŒ‰ IP</span>
ip.addr == 192.168.1.1
ip.src == 192.168.1.100
ip.dst != 8.8.8.8

<span class="hljs-comment"># æŒ‰ç«¯å£</span>
tcp.port == 80
udp.port == 53

<span class="hljs-comment"># ç»„åˆæ¡ä»¶</span>
http and ip.addr == 192.168.1.1
tcp.port == 443 or tcp.port == 80
not arp
</code></pre>
<p>å‡ ä¸ªæˆ‘å®é™…ç”¨å¾—æœ€å¤šçš„å°æŠ€å·§ï¼š</p>
<ul>
<li><span>ç›´æ¥å³é”®å­—æ®µ â†’ ä½œä¸ºè¿‡æ»¤å™¨åº”ç”¨ï¼Œä¸ç”¨ç¡¬è®°è¯­æ³•</span></li>
<li><code>tcp.stream eq N</code> ç”¨æ¥è¿½ä¸€æ•´æ¡ TCP ä¼šè¯ï¼Œéå¸¸å¥½ç”¨</li>
<li><code>tcp.analysis.flags</code> å¯ä»¥å¿«é€Ÿçœ‹åˆ°é‡ä¼ ã€ä¹±åºç­‰é—®é¢˜</li>
</ul>
<p>ä¸€æ—¦å¼€å§‹ç”¨è¿‡æ»¤å™¨ï¼ŒWireshark æ‰çœŸæ­£â€œå®‰é™ä¸‹æ¥â€ã€‚</p>
<h2 data-id="heading-3">äºŒã€è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œç½‘ç»œé‡Œåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h2>
<h3 data-id="heading-4">2.1 æŠ“ä¸€æ¬¡æœ€ç®€å•çš„ HTTP è¯·æ±‚</h3>
<p>ä¸ºäº†é¿å…ä¸€ä¸Šæ¥å°±è¢« HTTPS å¹²æ‰°ï¼Œæˆ‘åˆ»æ„é€‰äº†ä¸€ä¸ª <strong>æ˜æ–‡ HTTP</strong> ç½‘ç«™ã€‚
<strong>æ“ä½œè¿‡ç¨‹å¾ˆç®€å•ï¼š</strong></p>
<ol>
<li>æ‰“å¼€ Wiresharkï¼Œé€‰æ‹©æ­£åœ¨ä½¿ç”¨çš„ç½‘å¡</li>
<li>æµè§ˆå™¨è®¿é—®ï¼š<code>http://httpbin.org/html</code></li>
<li>åœæ­¢æŠ“åŒ…ï¼Œè¿‡æ»¤ï¼š
http and ip.addr == httpbin.org çš„ipåœ°å€ and ip.addr == ä½ ä¸»æœºipåœ°å€</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/189477be513a44ef9161ac48ebb64a12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=DPPwHIgT0FQGn8xgBbl1YRY2OLs%3D" alt="3.png" loading="lazy"/></p>
<ol start="4">
<li>å³é”®ä»»æ„ä¸€ä¸ªæ•°æ®åŒ…,ç‚¹å‡»è¿½è¸ªæµ,è¿½è¸ªTCPæˆ–è€…HTTPæµ
Wiresharkä¼šï¼š</li>
</ol>
<ul>
<li>è‡ªåŠ¨æŠŠå››å…ƒç»„ (src_ip,src_port,dst_ip,dst_port) ç›¸åŒçš„æ‰€æœ‰åŒ…æŒ‰ seq æ’åºï¼›</li>
<li>å¼¹å‡ºä¸€ä¸ªæ–°çª—å£ï¼Œä»¥â€œæ–‡æœ¬â€å½¢å¼æŠŠå®¢æˆ·ç«¯â†’æœåŠ¡å™¨ã€æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ çš„æ•°æ®å¹¶æ’æ˜¾ç¤ºï¼›
è¿½è¸ªTCPæµï¼š</li>
</ul>

<pre><code class="hljs language-xml" lang="xml">GET /html HTTP/1.1
Host: httpbin.org
Connection: keep-alive
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8

HTTP/1.1 200 OK
Date: Wed, 17 Dec 2025 14:11:55 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 3741
Connection: keep-alive
Server: gunicorn/19.9.0
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true

<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Herman Melville - Moby-Dick<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          Availing himself of the mild, summer-cool weather that now reigned in these latitudes, and in preparation for the peculiarly active pursuits shortly to be anticipated, Perth, the begrimed, blistered old blacksmith, had not removed his portable forge to the hold again
...... // ç¯‡å¹…é™åˆ¶ï¼Œä¸­é—´å†…å®¹æˆ‘åˆ å»ä¸€éƒ¨åˆ†
young widow had a delicious grief, and her orphans a truly venerable, legendary sire to dream of in their after years; and all of them a care-killing competency.
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>æ¥ä¸‹æ¥ä½ çœ‹åˆ°çš„ï¼Œå…¶å®å°±æ˜¯æ•™ç§‘ä¹¦é‡Œçš„æµç¨‹ï¼Œåªä¸è¿‡è¿™æ¬¡æ˜¯<strong>çœŸå®å‘ç”Ÿçš„</strong>ã€‚</p>
<h3 data-id="heading-5">2.2 å…³é”®æ•°æ®åŒ…æ‹†è§£</h3>
<p>æ­¤æ—¶æˆ‘ä»¬çš„é¢æ¿å˜æˆäº†è¿™æ ·ï¼Œè‡ªåŠ¨è¿‡æ»¤ï¼š<code>tcp.stream eq 1</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18a4a87024b54de59d8bbeaf13734e8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=brBhFlLW5JI1GlcQKeCidoELc6w%3D" alt="4.png" loading="lazy"/></p>
<p>ç‚¹è¿›å»ä¸€ä¸ªä»”ç»†çœ‹çœ‹ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07c8d0e8a1f54c48afad00b6353e6afd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=0YXmxMm9HqdCp%2Fn5ybKfJ%2B5y%2FIQ%3D" alt="Pasted image 20251217230427.png" loading="lazy"/>
æ•´ä½“æ¥è¯´åˆ†ä¸ºå››éƒ¨åˆ†ï¼š</p>
<ul>
<li>æ€»ä½“ä¿¡æ¯</li>
<li>å¸§æ ¼å¼ï¼ˆOSIç¬¬äºŒå±‚ï¼‰</li>
<li>IPé¦–éƒ¨ï¼ˆOSIç¬¬ä¸‰å±‚</li>
<li>TCPé¦–éƒ¨ï¼ˆOSIç¬¬å››å±‚ï¼‰</li>
</ul>
<p>æ€»ä½“ä¸Šé¢çœ‹ï¼š</p>
<h4 data-id="heading-6">1ï¼‰DNS æŸ¥è¯¢ï¼ˆå¦‚æœæœ¬åœ°æ²¡æœ‰ç¼“å­˜ï¼‰</h4>
<pre><code class="hljs">ä½ çš„ IP â†’ DNS æœåŠ¡å™¨
æŸ¥è¯¢ï¼šhttpbin.org
</code></pre>
<p>æˆ‘è¿™é‡Œå› ä¸ºåˆšæ‰è®¿é—®è¿‡è¯¥ç½‘ç«™ï¼Œæ‰€ä»¥æ²¡æœ‰DNSæŸ¥è¯¢æ­¥éª¤</p>
<h4 data-id="heading-7">2ï¼‰TCP ä¸‰æ¬¡æ¡æ‰‹</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/847ee4a8633643cebcc49087dbd10deb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=KezNDsSf5uGqj2Bs8kZBxmK%2FVVw%3D" alt="Pasted image 20251217222547.png" loading="lazy"/></p>
<p>ä»¥ä¸‹æ˜¯è¿™å¼ å›¾çš„è¡¨æ ¼ï¼Œæ€•ä½ ä»¬çœ‹ä¸æ¸…ï¼š</p>









































<table><thead><tr><th>å¸§å·</th><th>æ—¶é—´æˆ³ (s)</th><th>æº IP</th><th>ç›®çš„ IP</th><th>åè®®</th><th>é•¿åº¦ (B)</th><th>æŠ¥æ–‡æ‘˜è¦</th></tr></thead><tbody><tr><td>14</td><td>3.126387494</td><td>100.87.84.203</td><td>34.193.26.89</td><td>TCP</td><td>74</td><td>39720 â†’ 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460 SACK_PERM TSval=1772232773 TSecr=0 WS=128</td></tr><tr><td>19</td><td>3.392793852</td><td>34.193.26.89</td><td>100.87.84.203</td><td>TCP</td><td>74</td><td>80 â†’ 39720 [SYN, ACK] Seq=0 Ack=1 Win=26847 Len=0 MSS=1460 SACK_PERM TSval=1050374714 TSecr=1772232773 WS=256</td></tr><tr><td>20</td><td>3.392839560</td><td>100.87.84.203</td><td>34.193.26.89</td><td>TCP</td><td>66</td><td>39720 â†’ 80 [ACK] Seq=1 Ack=1 Win=64256 Len=0 TSval=1772233040 TSecr=1050374714</td></tr></tbody></table>
<p>è¿™ä¸€æ­¥éå¸¸å€¼å¾—åå¤çœ‹å‡ æ¬¡ï¼Œå› ä¸ºåé¢æ‰€æœ‰ HTTP éƒ½å»ºç«‹åœ¨å®ƒä¹‹ä¸Šã€‚
å¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œå¯¹äºä¸‹é¢çš„æŠ¥æ–‡çœ‹ä¸æ‡‚ï¼Œä½ å¯ä»¥å»è¡¥å……ä¸€äº›TCPçš„åŸºç¡€çŸ¥è¯†
Seq: æˆ‘è¦å‘çš„åŒ…åºå·
Ack: å¸Œæœ›å¯¹æ–¹å‘çš„åŒ…åºå·
Win: ç¼“å†²åŒºå¤§å°
Len: åŒ…çš„æ€»å¤§å°</p>
<h6 data-id="heading-8">ç¬¬ 14 å¸§ï¼šSYN â€”â€” â€œå–‚ï¼Œèƒ½å¬åˆ°å—ï¼Ÿâ€</h6>
<ul>
<li>è°â†’è°ï¼šæˆ‘ï¼ˆ100.87.84.203:39720ï¼‰â†’ æœåŠ¡å™¨ï¼ˆ34.193.26.89:80ï¼‰</li>
<li>Seq=0ï¼šè¿™æ˜¯â€œèµ·å§‹åºå·â€ï¼ŒWireshark å¸®ä½ æŠ˜æˆ 0ï¼ŒçœŸå®ç»å¯¹å€¼æ˜¯ä¸€ä¸ª 32 ä½éšæœºæ•°ã€‚</li>
<li>Win=64240ï¼šå‘Šè¯‰å¯¹æ–¹â€œæˆ‘æ¥æ”¶çª—å£ç°åœ¨å°± 62 540 å­—èŠ‚ï¼Œåˆ«å‘è¶…â€ã€‚</li>
<li>MSS=1460ï¼šå•æ®µæœ€å¤§æ•°æ® 1460 Bï¼Œé˜²æ­¢ IP åˆ†ç‰‡ã€‚</li>
<li>é•¿åº¦ 74 B = 14 (Eth) + 20 (IP) + 40 (TCP å« 20 B é€‰é¡¹)ã€‚</li>
</ul>
<h6 data-id="heading-9">ç¬¬ 19 å¸§ï¼šSYN-ACK â€”â€” â€œæ”¶åˆ°ï¼Œå¯ä»¥èŠï¼â€</h6>
<ul>
<li>å¾€è¿”æ—¶é—´ï¼š3.392 793 â€“ 3.126 387 â‰ˆ 266 msï¼ˆç‰©ç†è·ç¦» + ç½‘ç»œæ’é˜Ÿï¼‰ã€‚</li>
<li>Seq=0ã€Ack=1ï¼šæœåŠ¡å™¨ä¹Ÿé€‰äº†è‡ªå·±çš„åˆå§‹åºå· 0ï¼Œå¹¶æŠŠ Ack è®¾ä¸º1ï¼Œè¡¨ç¤ºâ€œæˆ‘æœŸå¾…ä½ ä¸‹å­—èŠ‚ä» 1 å¼€å§‹â€ã€‚</li>
<li>Win=26847ï¼šæœåŠ¡å™¨çª—å£æ¯”å®¢æˆ·ç«¯å°ï¼Œå› ä¸ºå®ƒåªæ˜¯å°åšå®¢ç«™ï¼Œå†…å­˜å°‘ã€‚</li>
<li>WS=256ï¼šæœåŠ¡å™¨çª—å£æ‰©å¤§å› å­ 256ï¼Œæ¯”å®¢æˆ·ç«¯çš„ 128 å¤§ï¼Œä½†åŸºç¡€çª—å£å°ï¼Œæœ€ç»ˆååè¿˜æ˜¯çœ‹ç“¶é¢ˆæ®µã€‚</li>
<li>çœŸå®çª—å£ = Win Ã— 2 ^WS</li>
<li>TSecr=1772232773ï¼šæŠŠå®¢æˆ·ç«¯çš„ TSval åŸæ ·æ‰“å›ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±èƒ½ç®—å‡º RTT(è·‘ä¸€æ¬¡æ¥å›æ‰€éœ€çš„æ—¶é—´)ã€‚(TSval æ˜¯â€œæˆ‘è¿™è¾¹ç°åœ¨å‡ ç‚¹â€ï¼ŒTSecr æ˜¯â€œåˆšæ‰ä½ é‚£è¾¹å‡ ç‚¹â€â€”â€”æ¥å›ä¸€å‡å°±æ˜¯ RTT)</li>
<li>é•¿åº¦ä¹Ÿæ˜¯ 74 Bï¼Œç»“æ„åŒç¬¬ä¸€æ¡</li>
</ul>
<h6 data-id="heading-10">ç¬¬ 20 å¸§ï¼šçº¯ ACK â€”â€” â€œOKï¼Œæˆ‘å¼€å§‹å‘æ•°æ®ï¼â€</h6>
<ul>
<li>è€—æ—¶ï¼š46 Î¼sï¼ˆæœ¬åœ°ç³»ç»Ÿå›åŒ…ï¼Œå‡ ä¹ç¬é—´ï¼‰ã€‚</li>
<li>Seq=1ã€Ack=1ï¼šå®¢æˆ·ç«¯ç¡®è®¤æœåŠ¡å™¨çš„ SYNï¼ŒåŒæ—¶æŠŠè‡ªå·±çš„åºå·æ¨è¿› 1ã€‚</li>
<li>Len=0ï¼šæ²¡æœ‰æ•°æ®ï¼Œåªæ˜¯â€œæ¡æ‰‹æ”¶å°¾â€æŠ¥æ–‡ã€‚</li>
<li>Win=64256ï¼šçª—å£æ¯”ç¬¬ä¸€æ¬¡å¤šäº† 16 å­—èŠ‚ï¼Œå…¶å®æ˜¯ TCP åè®®æ ˆæŠŠâ€œSYN å  1 å­—èŠ‚â€è§£æ‰åé‡æ–°ç®—äº†ä¸€æ¬¡ï¼Œæ— å®è´¨å«ä¹‰ã€‚</li>
<li>é•¿åº¦ 66 B = 14 + 20 + 32ï¼ˆTCP å¤´æ— é€‰é¡¹ï¼Œæ‰€ä»¥ 20 åŸºæœ¬ + 12 å­—èŠ‚æ—¶é—´æˆ³é€‰é¡¹ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-11">3ï¼‰HTTP è¯·æ±‚</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ac241445d0f40ad88fe26e11f3970a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=qNOUR7B%2BxpcDmu5IxJOFQdElBPI%3D" alt="Pasted image 20251217230741.png" loading="lazy"/></p>
<h4 data-id="heading-12">4ï¼‰HTTP å“åº”</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4423e6d48ed47c7aa459382c525a0f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=mNplGcETMzyABvos8q%2FE9UVtBmo%3D" alt="Pasted image 20251218095021.png" loading="lazy"/></p>
<p>çœ‹åˆ°è¿™é‡Œå…¶å®ä¼šæœ‰ä¸€ç§â€œæç„¶å¤§æ‚Ÿâ€çš„æ„Ÿè§‰ï¼š
<strong>åŸæ¥æµè§ˆå™¨è®¿é—®ç½‘é¡µï¼Œæœ¬è´¨å°±æ˜¯è¿™ä¹ˆä¸€æ¥ä¸€å›ã€‚</strong></p>
<h4 data-id="heading-13">5ï¼‰å››æ¬¡æŒ¥æ‰‹</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98f7ac72f12a4d8d8196cea072ff512b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=eerQgOkp5uWG3KM3J%2F20Vjxm6Zg%3D" alt="Pasted image 20251218100157.png" loading="lazy"/>
å‘ç°è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬å­¦è¿‡çš„å®Œæ•´çš„å››æ¬¡æŒ¥æ‰‹ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢?
åŸå› å°±æ˜¯ï¼š
æœåŠ¡å™¨ 65 ç§’å…ˆå‘å‡º FINï¼Œæˆ‘åªå›äº† ACKï¼Œè¿›å…¥ TIME_WAITã€‚<br/>
åé¢å…¨æ˜¯ Keep-Aliveï¼šæˆ‘æ¯ 45 ç§’æ¢ä¸€æ¬¡æ´»ï¼Œå¯¹æ–¹ä¹Ÿæ­£å¸¸å› ACKã€‚<br/>
158 ç§’æœåŠ¡å™¨ç›´æ¥å‘ RSTï¼Œè¿æ¥è¢«å†…æ ¸ç«‹å³å›æ”¶ï¼Œ<strong>â‘¢â‘£ä¸¤æ­¥ FIN æ ¹æœ¬æ²¡å‡ºç°</strong>ï¼Œæ‰€ä»¥çœ‹ä¸åˆ°å®Œæ•´å››æ¬¡æŒ¥æ‰‹ã€‚<br/>
åŸå› å¾ˆç®€å•ï¼šç©ºé—²è¶…æ—¶ï¼Œè¿œç«¯ä¸æƒ³ç»§ç»­ç»´æŠ¤è¿™æ¡ TCPã€‚</p>
<h2 data-id="heading-14">ä¸‰ã€å†™è‡ªå·±çš„ç¨‹åºï¼Œå†ç”¨ Wireshark çœ‹å®ƒâ€œè¯´è¯â€</h2>
<p>å¦‚æœåªæŠ“æµè§ˆå™¨æµé‡ï¼Œå¾ˆå®¹æ˜“åœç•™åœ¨â€œè§‚å¯Ÿè€…â€é˜¶æ®µã€‚
çœŸæ­£åŠ æ·±ç†è§£çš„ï¼Œæ˜¯<strong>è‡ªå·±å†™ç¨‹åº â†’ å†æŠ“è‡ªå·±çš„åŒ…</strong>ã€‚</p>
<h3 data-id="heading-15">3.1 ä¸€ä¸ªæœ€å° TCP æœåŠ¡å™¨</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># server.py</span>
<span class="hljs-keyword">import</span> socket

server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server.bind((<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">9999</span>))
server.listen()
<span class="hljs-built_in">print</span>(<span class="hljs-string">"TCPæœåŠ¡å™¨ç›‘å¬ 127.0.0.1:9999"</span>)

<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    client, addr = server.accept()
    data = client.recv(<span class="hljs-number">1024</span>)
    client.send(<span class="hljs-string">b"Echo: "</span> + data)
    client.close()
</code></pre>
<p>å®¢æˆ·ç«¯ç›´æ¥ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">nc 127.0.0.1 9999
</code></pre>
<hr/>
<h3 data-id="heading-16">3.2 æŠ“è‡ªå·±å†™çš„ TCP ç¨‹åº</h3>
<p>Wireshark è®¾ç½®å¾ˆç®€å•ï¼š</p>
<ul>
<li>æ¥å£é€‰ <code>lo</code>ï¼ˆç¯å›ï¼‰</li>
<li>è¿‡æ»¤å™¨ï¼š
tcp.port == 9999</li>
</ul>

<ul>
<li>åœ¨ç»ˆç«¯è¾“å…¥ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4af01998b96c4ea4817073d3ee1aa766~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=B9v%2FehfGed%2F32%2BiNeNdM37QoUAM%3D" alt="Pasted image 20251218102635.png" loading="lazy"/></li>
</ul>
<p>è¿™æ—¶ä½ å¯ä»¥éå¸¸æ¸…æ¥šåœ°çœ‹åˆ°ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6419f4e9202b459297fcdb132d51d863~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=CpvQ5Ji9TTl19Mg58YdQ8AEvkjA%3D" alt="Pasted image 20251218102705.png" loading="lazy"/></p>
<ul>
<li>ä¸‰æ¬¡æ¡æ‰‹æ˜¯æ€ä¹ˆå‘ç”Ÿçš„</li>
<li>æ•°æ®å¯¹åº”å“ªäº›åºåˆ—å·</li>
<li>è¿æ¥æ˜¯å¦‚ä½•è¢«æ­£å¸¸å…³é—­çš„ï¼ˆFIN / ACKï¼‰</li>
</ul>
<p>å½“ä½ æ„è¯†åˆ°ï¼š
<strong>è¿™äº›åŒ…æ­£æ˜¯ä½ å‡ è¡Œä»£ç â€œå‘å‡ºå»çš„ç»“æœâ€</strong>
æŠ½è±¡çš„ TCP æ¦‚å¿µä¸€ä¸‹å­å°±å…·ä½“äº†ã€‚</p>
<h3 data-id="heading-17">3.3 UDP çš„å¯¹æ¯”æ›´ç›´è§‚</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> socket

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.bind((<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">9998</span>))

<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    data, addr = sock.recvfrom(<span class="hljs-number">1024</span>)
    sock.sendto(<span class="hljs-string">b"UDP Echo: "</span> + data, addr)
</code></pre>
<p>client: <code>echo "hello,world" | nc -u 127.0.0.1 9998</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2bffc9b3bb794fd782618fd03c566314~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVGhlV29yMWQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633390&amp;x-signature=%2Bf%2ByA5GMLjzMUkEVOmKa2cJSZsc%3D" alt="Pasted image 20251218105213.png" loading="lazy"/>
æŠ“åŒ…åå¾ˆæ˜æ˜¾ï¼š</p>
<ul>
<li>æ²¡æœ‰æ¡æ‰‹</li>
<li>æ¯ä¸ªåŒ…éƒ½æ˜¯ç‹¬ç«‹çš„</li>
<li>æ²¡æœ‰é‡ä¼ ã€æ²¡æœ‰è¿æ¥çŠ¶æ€
UDP å’Œ TCP çš„å·®å¼‚ï¼Œåœ¨è¿™é‡Œå‡ ä¹æ˜¯â€œè‚‰çœ¼å¯è§â€ã€‚</li>
</ul>
<h2 data-id="heading-18">å››ã€ç»“è¯­</h2>
<p>Wireshark æœ¬èº«å¹¶ä¸éš¾ï¼Œéš¾çš„æ˜¯<strong>ä½ ä¸çŸ¥é“è¯¥çœ‹ä»€ä¹ˆ</strong>ã€‚
ä¸€æ—¦å­¦ä¼šè¿‡æ»¤èƒŒæ™¯æµé‡ï¼Œå†ä»åº”ç”¨å±‚å¾€ä¸‹çœ‹ï¼Œå¾ˆå¤šç½‘ç»œæ¦‚å¿µéƒ½ä¼šè‡ªç„¶å¯¹ä¸Šã€‚</p>
<p>çœŸæ­£ç†è§£ç½‘ç»œçš„ç¬é—´ï¼Œä¸æ˜¯åœ¨ä¹¦ä¸Šï¼Œè€Œæ˜¯åœ¨ Wireshark é‡Œçœ‹åˆ°ï¼š
<strong>â€œè¿™å°±æ˜¯æˆ‘åˆšæ‰é‚£ä¸€è¡Œä»£ç å‘å‡ºå»çš„åŒ…ã€‚â€</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ Kibana ä¸­å¯è§†åŒ–ä½ çš„ Bosch Smart Home æ•°æ®]]></title>    <link>https://juejin.cn/post/7584729714340282387</link>    <guid>https://juejin.cn/post/7584729714340282387</guid>    <pubDate>2025-12-18T03:33:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584729714340282387" data-draft-id="7584729714340266003" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ Kibana ä¸­å¯è§†åŒ–ä½ çš„ Bosch Smart Home æ•°æ®"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2025-12-18T03:33:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ Kibana ä¸­å¯è§†åŒ–ä½ çš„ Bosch Smart Home æ•°æ®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:33:23.000Z" title="Thu Dec 18 2025 03:33:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ª ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.elastic.co%2Fu%2Fwalterra" title="https://discuss.elastic.co/u/walterra" target="_blank" ref="nofollow noopener noreferrer">walterra</a></p>
<p>æœ‰æ²¡æœ‰æƒ³è¿‡ä½ çš„æ™ºèƒ½å®¶å±…é‡Œåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿä½ çš„æš–æ°”ä»€ä¹ˆæ—¶å€™å¯åŠ¨ï¼Ÿä¸€å¤©ä¸­æ¹¿åº¦å¦‚ä½•å˜åŒ–ï¼Ÿæ¯ä¸ªæˆ¿é—´çš„æ¸©åº¦æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>å¦‚æœä½ æœ‰ Bosch Smart Home Controller IIï¼Œæ‰€æœ‰è¿™äº›æ•°æ®éƒ½åœ¨ä½ çš„æœ¬åœ°ç½‘ç»œä¸­æµåŠ¨ â€”â€” ä½†å®ƒè¢«é”åœ¨ä¸€ä¸ªåªèƒ½æ˜¾ç¤ºå½“å‰çŠ¶æ€çš„åº”ç”¨é‡Œã€‚å‡å¦‚ä½ èƒ½æ•æ‰è¿™æ¡äº‹ä»¶æµï¼Œå¹¶å°†å…¶éšæ—¶é—´å¯è§†åŒ–ï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p>
<p>è¿™æ­£æ˜¯ <strong><a href="https://link.juejin.cn?target=http%3A%2F%2Fgithub.com%2Fwalterra%2Fshc2es" title="http://github.com/walterra/shc2es" target="_blank" ref="nofollow noopener noreferrer">shc2es</a></strong> çš„ä½œç”¨ï¼šå®ƒè¿æ¥åˆ°ä½ çš„ Bosch Smart Home Controllerï¼Œé€šè¿‡é•¿è½®è¯¢æ”¶é›†å®æ—¶è®¾å¤‡äº‹ä»¶ï¼Œå¹¶å°†æ•°æ®å¯¼å…¥ Elasticsearchï¼Œä»¥ä¾¿åœ¨ Kibana ä¸­è¿›è¡Œæ—¶é—´åºåˆ—å¯è§†åŒ–ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b80cc88a86a469db3135bd730d53d9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633602&amp;x-signature=NxAxzZEQO%2BkKBQjQTvAYPwbgj5g%3D" alt="" loading="lazy"/></p>
<p>Bosch Smart Home Controller II ä¸ºç§äººéå•†ä¸šç”¨é€”æä¾›äº†æœ¬åœ° APIã€‚æ§åˆ¶å™¨çš„ API ä½¿ç”¨é•¿è½®è¯¢å®æ—¶æ¨é€è®¾å¤‡çŠ¶æ€å˜åŒ–ã€‚æ¸©åº¦è¯»æ•°ã€æ¹¿åº¦æ°´å¹³ã€é—¨/çª—çŠ¶æ€ã€è¿åŠ¨æ£€æµ‹â€”â€”æ‰€æœ‰æ•°æ®éƒ½ä¼šä»¥ JSON äº‹ä»¶æµçš„å½¢å¼ä¼ è¾“ã€‚</p>
<p><strong>shc2es</strong> ä½¿ç”¨ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fholomekc%2Fbosch-smart-home-bridge" title="https://github.com/holomekc/bosch-smart-home-bridge" target="_blank" ref="nofollow noopener noreferrer">bosch-smart-home-bridge</a></strong> åº“æ¥å…¥è¿™æ¡äº‹ä»¶æµï¼Œå°†æ‰€æœ‰æ•°æ®å­˜å‚¨ä¸º NDJSON æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨åˆé€‚çš„å­—æ®µæ˜ å°„å¯¼å…¥ Elasticsearchï¼Œå¹¶æä¾›ç°æˆçš„ä»ªè¡¨æ¿ã€‚</p>
<h2 data-id="heading-0">å…¥é—¨</h2>
<h3 data-id="heading-1">å®‰è£…</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`npm install -g shc2es`</span>AIå†™ä»£ç 
</code></pre>
<h3 data-id="heading-2">é…ç½®</h3>
<p>åœ¨ä½ çš„å·¥ä½œç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª <code>.env</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`

1.  <span class="hljs-comment"># Your controller's IP (find it in the Bosch app or your router)</span>
<span class="hljs-attr">2.  BSH_HOST</span>=<span class="hljs-number">192.168</span>.<span class="hljs-number">1.100</span>

4.  <span class="hljs-comment"># System password from Bosch Smart Home app</span>
5.  <span class="hljs-comment"># (Settings â†’ System â†’ Smart Home Controller)</span>
<span class="hljs-attr">6.  BSH_PASSWORD</span>=your_password

`AIå†™ä»£ç 
</code></pre>
<h3 data-id="heading-3">é¦–æ¬¡è¿è¡Œï¼šé…å¯¹</h3>
<p>ç¬¬ä¸€æ¬¡è¿æ¥æ—¶ï¼Œä½ éœ€è¦ä¸æ§åˆ¶å™¨é…å¯¹ã€‚è¿™æ˜¯ä¸€æ¬¡æ€§çš„å®‰å…¨æ¡æ‰‹ã€‚åœ¨è¿è¡Œè„šæœ¬å‰ï¼Œ<strong>æŒ‰ä¸‹æ§åˆ¶å™¨ä¸Šçš„é…å¯¹æŒ‰é’®</strong>ã€‚è„šæœ¬ä¼šç”Ÿæˆä¸€ä¸ªå®¢æˆ·ç«¯è¯ä¹¦ï¼Œå¹¶åœ¨æœ¬åœ°ä¿å­˜ä»¥ä¾›ä»¥åè¿æ¥ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`shc2es poll`</span>AIå†™ä»£ç 
</code></pre>
<h3 data-id="heading-4">å¯¼å…¥åˆ° Elasticsearch</h3>
<p>Poll è„šæœ¬ç°åœ¨ä¼šå°†ä½ çš„æ™ºèƒ½å®¶å±…æ•°æ®ä¿å­˜ä¸º NDJSON æ–‡ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¾ç½® Elastic Stack æ¥æ¥æ”¶è¿™äº›æ•°æ®ã€‚é¦–å…ˆï¼Œä½¿ç”¨ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Felastic%2Fstart-local" title="https://github.com/elastic/start-local" target="_blank" ref="nofollow noopener noreferrer">start-local</a></strong> æ­å»ºæœ¬åœ°å¼€å‘ç¯å¢ƒï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`curl <span class="hljs-operator">-</span>fsSL https:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>elastic.co<span class="hljs-operator">/</span><span class="hljs-keyword">start</span><span class="hljs-operator">-</span><span class="hljs-keyword">local</span> <span class="hljs-operator">|</span> sh`AIå†™ä»£ç 
</code></pre>
<p>åœ¨ä½ çš„ <code>.env</code> æ–‡ä»¶ä¸­æ·»åŠ  Elasticsearch å‡­è¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`

<span class="hljs-attr">1.  ES_NODE</span>=http://localhost:<span class="hljs-number">9200</span>
<span class="hljs-attr">2.  ES_PASSWORD</span>=your_es_password
<span class="hljs-attr">3.  KIBANA_NODE</span>=http://localhost:<span class="hljs-number">5601</span>

`AIå†™ä»£ç 
</code></pre>
<p>ç°åœ¨è¿è¡Œè®¾ç½®å¹¶å¼€å§‹å¯¼å…¥æ•°æ®ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  # <span class="hljs-keyword">Fetch</span> device<span class="hljs-operator">/</span>room names <span class="hljs-keyword">for</span> enrichment
<span class="hljs-number">2.</span>  shc2es registry

<span class="hljs-number">4.</span>  # <span class="hljs-keyword">Create</span> index template <span class="hljs-operator">+</span> import dashboard
<span class="hljs-number">5.</span>  shc2es ingest <span class="hljs-comment">--setup</span>

<span class="hljs-number">7.</span>  # Watch <span class="hljs-keyword">for</span> <span class="hljs-keyword">new</span> events <span class="hljs-keyword">and</span> ingest <span class="hljs-keyword">in</span> <span class="hljs-type">real</span><span class="hljs-operator">-</span><span class="hljs-type">time</span>
<span class="hljs-number">8.</span>  shc2es ingest <span class="hljs-comment">--watch</span>

`AIå†™ä»£ç 
</code></pre>
<p>æ‰“å¼€ Kibana â†’ ä»ªè¡¨æ¿ â†’ â€œ<strong>Smart Home</strong>â€ï¼Œä½ å°±èƒ½çœ‹åˆ°æ•°æ®ç”ŸåŠ¨å‘ˆç°ã€‚é¢„æ„å»ºçš„ä»ªè¡¨æ¿ä¼šæ˜¾ç¤ºå„æˆ¿é—´çš„æ¸©åº¦éšæ—¶é—´çš„å˜åŒ–ï¼Œä»¥åŠæš–æ°”æ’æ¸©é˜€å¼€åº¦çš„ç™¾åˆ†æ¯”ã€‚æ¯ä¸ªäº‹ä»¶éƒ½å¸¦æœ‰äººç±»å¯è¯»çš„è®¾å¤‡åç§°å’Œæˆ¿é—´ä¿¡æ¯ï¼Œä¸å¿…ç›¯ç€éš¾æ‡‚çš„è®¾å¤‡ IDã€‚</p>
<p>åº•å±‚æ•°æ®ç»“æ„å¹²å‡€ä¸”æ˜“äºæŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-json" lang="json">`

<span class="hljs-number">1.</span>  <span class="hljs-punctuation">{</span>
<span class="hljs-number">2.</span>    <span class="hljs-attr">"@timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-12-16T08:30:00.000Z"</span><span class="hljs-punctuation">,</span>
<span class="hljs-number">3.</span>    <span class="hljs-attr">"device.name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Living Room Thermostat"</span><span class="hljs-punctuation">,</span>
<span class="hljs-number">4.</span>    <span class="hljs-attr">"device.type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ROOM_CLIMATE_CONTROL"</span><span class="hljs-punctuation">,</span>
<span class="hljs-number">5.</span>    <span class="hljs-attr">"room.name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Living Room"</span><span class="hljs-punctuation">,</span>
<span class="hljs-number">6.</span>    <span class="hljs-attr">"metric.name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"temperature"</span><span class="hljs-punctuation">,</span>
<span class="hljs-number">7.</span>    <span class="hljs-attr">"metric.value"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">21.5</span>
<span class="hljs-number">8.</span>  <span class="hljs-punctuation">}</span>

`AIå†™ä»£ç 
</code></pre>
<p>è¿™è®©ä½ å¯ä»¥è½»æ¾åˆ›å»ºè‡ªå·±çš„å¯è§†åŒ–æˆ–è¿è¡Œ ES|QL æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`

1.  FROM smart-home-events-*
2.  | WHERE <span class="hljs-attr">metric.name</span> == <span class="hljs-string">"temperature"</span>
3.  | STATS <span class="hljs-attr">avg_temp</span> = AVG(metric.value) BY room.name
4.  | SORT avg_temp DESC

`AIå†™ä»£ç 
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32a207e051ab47bb9753c2e34f2efb34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633602&amp;x-signature=%2BsARPc8pRj61d8h6Vmo6ZCzNwh4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">é¢å¤–åŠŸèƒ½ï¼šOpenTelemetry é›†æˆ</h2>
<p>å¯¹äºä½¿ç”¨ Elastic APM çš„ç”¨æˆ·ï¼Œ<strong>shc2es</strong> é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Fopentelemetry%2Fedot-sdks%2Fnode%2Fsetup" title="https://www.elastic.co/docs/reference/opentelemetry/edot-sdks/node/setup" target="_blank" ref="nofollow noopener noreferrer">EDOT Node.js</a> æä¾›è‡ªåŠ¨ OpenTelemetry ä»ªè¡¨åŒ–ã€‚åœ¨ <code>.env</code> ä¸­æ·»åŠ ä½ çš„ APM ç«¯ç‚¹ï¼Œå°±å¯ä»¥è·å–è½®è¯¢å’Œå¯¼å…¥è¿‡ç¨‹çš„è¿½è¸ªå’ŒæŒ‡æ ‡ã€‚</p>
<h2 data-id="heading-6">è¯•ä¸€è¯•</h2>
<p>å¦‚æœä½ æœ‰ Bosch Smart Home Controller IIï¼Œå¯ä»¥ä½“éªŒä¸€ä¸‹ï¼š</p>
<ul>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwalterra%2Fshc2es" title="https://github.com/walterra/shc2es" target="_blank" ref="nofollow noopener noreferrer">GitHub: github.com/walterra/shc2es</a></p>
</li>
<li>
<p>npm: <code>npm install -g shc2es</code></p>
</li>
</ul>
<p>ä½ æ˜¯å¦åœ¨ Elastic Stack ä¸­å¯è§†åŒ–æ™ºèƒ½å®¶å±…æ•°æ®ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºä¸­åˆ†äº«ä½ çš„é…ç½®ï¼</p>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.elastic.co%2Ft%2Fdec-16th-2025-en-visualize-your-bosch-smart-home-data-in-kibana%2F384014" title="https://discuss.elastic.co/t/dec-16th-2025-en-visualize-your-bosch-smart-home-data-in-kibana/384014" target="_blank" ref="nofollow noopener noreferrer">discuss.elastic.co/t/dec-16th-â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯javascriptå¦‚ä½•å®ç°é˜…è¯»ä½ç½®è®°å¿†ã€å¯è¿è¡Œæºç ã€‘]]></title>    <link>https://juejin.cn/post/7584725529876938802</link>    <guid>https://juejin.cn/post/7584725529876938802</guid>    <pubDate>2025-12-18T03:28:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584725529876938802" data-draft-id="7584742635501600795" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯javascriptå¦‚ä½•å®ç°é˜…è¯»ä½ç½®è®°å¿†ã€å¯è¿è¡Œæºç ã€‘"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-18T03:28:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="DEMOæ´¾"/> <meta itemprop="url" content="https://juejin.cn/user/2314902384159147"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯javascriptå¦‚ä½•å®ç°é˜…è¯»ä½ç½®è®°å¿†ã€å¯è¿è¡Œæºç ã€‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2314902384159147/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    DEMOæ´¾
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:28:28.000Z" title="Thu Dec 18 2025 03:28:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é˜…è¯»ä½ç½®è®°å¿†åŠŸèƒ½demo</h2>
<h3 data-id="heading-1">åŠŸèƒ½è¯´æ˜</h3>
<h6 data-id="heading-2">1. è‡ªåŠ¨ä¿å­˜ï¼šæ»šåŠ¨é¡µé¢æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¿å­˜å½“å‰é˜…è¯»ä½ç½®ï¼ˆé˜²æŠ–å¤„ç†ï¼Œæ¯ç§’ä¿å­˜ä¸€æ¬¡ï¼‰</h6>
<h6 data-id="heading-3">2. è‡ªåŠ¨æ¢å¤ï¼šé‡æ–°æ‰“å¼€é¡µé¢æ—¶ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸Šæ¬¡é˜…è¯»çš„ä½ç½®</h6>
<h6 data-id="heading-4">3. æ‰‹åŠ¨æ§åˆ¶ï¼š</h6>
<ol>
<li>
<p>æ‰‹åŠ¨ä¿å­˜å½“å‰ä½ç½®</p>
</li>
<li>
<p>æ‰‹åŠ¨è·³è½¬åˆ°ä¸Šæ¬¡ä¿å­˜çš„ä½ç½®</p>
</li>
<li>
<p>æ¸…é™¤ä¿å­˜çš„è®°å½•</p>
</li>
</ol>
<h5 data-id="heading-5">4. è§†å›¾åé¦ˆ</h5>
<ol>
<li>
<p>çŠ¶æ€æŒ‡ç¤ºå™¨æ˜¾ç¤ºä¿å­˜çŠ¶æ€</p>
</li>
<li>
<p>æ¢å¤æ—¶é«˜äº®æ˜¾ç¤ºå½“å‰ç« èŠ‚</p>
</li>
<li>
<p>æ˜¾ç¤ºæ»šåŠ¨è¿›åº¦æ¡</p>
</li>
<li>
<p>ä¾§è¾¹ä½ç½®æ ‡è®°æ˜¾ç¤ºå½“å‰ç« èŠ‚å’Œè¿›åº¦</p>
</li>
</ol>
<h3 data-id="heading-6">ä½¿ç”¨æ–¹æ³•</h3>
<ol>
<li>
<p>ç›´æ¥å¤åˆ¶ä¸Šé¢çš„ä»£ç åˆ°HTMLæ–‡ä»¶ä¸­</p>
</li>
<li>
<p>ç”¨æµè§ˆå™¨æ‰“å¼€è¯¥æ–‡ä»¶</p>
</li>
<li>
<p>æ»šåŠ¨é¡µé¢é˜…è¯»å†…å®¹</p>
</li>
<li>
<p>åˆ·æ–°é¡µé¢æˆ–å…³é—­åé‡æ–°æ‰“å¼€ï¼Œé¡µé¢ä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸Šæ¬¡é˜…è¯»çš„ä½ç½®</p>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82f7cecead164fa294a8cf0fb8c4fb4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgREVNT-a0vg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633308&amp;x-signature=E%2B2VT%2F59HQt2aQdanr7%2Fu2Xaj6c%3D" alt="ç¤ºä¾‹å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>é˜…è¯»ä½ç½®è®°å¿†åŠŸèƒ½<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        * {
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">box-sizing</span>: border-box;
            <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Segoe UI'</span>, <span class="hljs-string">'Microsoft YaHei'</span>, sans-serif;
        }
        
        <span class="hljs-selector-tag">body</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f5f7fa</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
            <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.6</span>;
        }
        
        <span class="hljs-selector-class">.container</span> {
            <span class="hljs-attribute">max-width</span>: <span class="hljs-number">1000px</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
        }
        
        <span class="hljs-selector-tag">header</span> {
            <span class="hljs-attribute">text-align</span>: center;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">30px</span> <span class="hljs-number">0</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#6a11cb</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#2575fc</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30px</span>;
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">4px</span> <span class="hljs-number">12px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.1</span>);
        }
        
        <span class="hljs-selector-tag">h1</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">2.5rem</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">10px</span>;
        }
        
        <span class="hljs-selector-class">.subtitle</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.1rem</span>;
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.9</span>;
            <span class="hljs-attribute">max-width</span>: <span class="hljs-number">600px</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
        }
        
        <span class="hljs-selector-class">.control-panel</span> {
            <span class="hljs-attribute">background-color</span>: white;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30px</span>;
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2px</span> <span class="hljs-number">8px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.08</span>);
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">flex-wrap</span>: wrap;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">justify-content</span>: center;
        }
        
        <span class="hljs-selector-class">.btn</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span> <span class="hljs-number">24px</span>;
            <span class="hljs-attribute">border</span>: none;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">5px</span>;
            <span class="hljs-attribute">cursor</span>: pointer;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">align-items</span>: center;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">8px</span>;
        }
        
        <span class="hljs-selector-class">.btn-primary</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#4a6ee0</span>;
            <span class="hljs-attribute">color</span>: white;
        }
        
        <span class="hljs-selector-class">.btn-primary</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#3a5ed0</span>;
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">2px</span>);
        }
        
        <span class="hljs-selector-class">.btn-success</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#10b981</span>;
            <span class="hljs-attribute">color</span>: white;
        }
        
        <span class="hljs-selector-class">.btn-success</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0da271</span>;
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">2px</span>);
        }
        
        <span class="hljs-selector-class">.btn-warning</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f59e0b</span>;
            <span class="hljs-attribute">color</span>: white;
        }
        
        <span class="hljs-selector-class">.btn-warning</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#e5900a</span>;
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">2px</span>);
        }
        
        <span class="hljs-selector-class">.status-indicator</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">align-items</span>: center;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span> <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f8fafc</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">5px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;
        }
        
        <span class="hljs-selector-class">.indicator-dot</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
            <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#6b7280</span>;
        }
        
        <span class="hljs-selector-class">.indicator-dot</span><span class="hljs-selector-class">.active</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#10b981</span>;
            <span class="hljs-attribute">animation</span>: pulse <span class="hljs-number">2s</span> infinite;
        }
        
        <span class="hljs-keyword">@keyframes</span> pulse {
            <span class="hljs-number">0%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
            <span class="hljs-number">50%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.5</span>; }
            <span class="hljs-number">100%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
        }
        
        <span class="hljs-selector-class">.content</span> {
            <span class="hljs-attribute">background-color</span>: white;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">30px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2px</span> <span class="hljs-number">8px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.08</span>);
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30px</span>;
        }
        
        <span class="hljs-selector-class">.chapter</span> {
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">40px</span>;
            <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">30px</span>;
            <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
        }
        
        <span class="hljs-selector-class">.chapter</span><span class="hljs-selector-pseudo">:last-child</span> {
            <span class="hljs-attribute">border-bottom</span>: none;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-selector-class">.chapter-title</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.8rem</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#1f2937</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">border-left</span>: <span class="hljs-number">5px</span> solid <span class="hljs-number">#4a6ee0</span>;
        }
        
        <span class="hljs-selector-class">.chapter-content</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.05rem</span>;
        }
        
        <span class="hljs-selector-class">.chapter-content</span> <span class="hljs-selector-tag">p</span> {
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">text-align</span>: justify;
        }
        
        <span class="hljs-selector-class">.highlight</span> {
            <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
            <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.5s</span> ease;
        }
        
        <span class="hljs-selector-tag">footer</span> {
            <span class="hljs-attribute">text-align</span>: center;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#6b7280</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9rem</span>;
        }
        
        <span class="hljs-selector-class">.position-marker</span> {
            <span class="hljs-attribute">position</span>: fixed;
            <span class="hljs-attribute">right</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);
            <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">74</span>, <span class="hljs-number">110</span>, <span class="hljs-number">224</span>, <span class="hljs-number">0.9</span>);
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">4px</span> <span class="hljs-number">12px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.15</span>);
            <span class="hljs-attribute">z-index</span>: <span class="hljs-number">100</span>;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">180px</span>;
            <span class="hljs-attribute">text-align</span>: center;
            <span class="hljs-attribute">display</span>: none;
        }
        
        <span class="hljs-selector-class">.position-marker</span> <span class="hljs-selector-tag">h3</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1rem</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
        }
        
        <span class="hljs-selector-class">.position-info</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>;
            <span class="hljs-attribute">font-weight</span>: bold;
        }
        
        <span class="hljs-selector-class">.scroll-progress</span> {
            <span class="hljs-attribute">position</span>: fixed;
            <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">4px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1000</span>;
        }
        
        <span class="hljs-selector-class">.scroll-progress-bar</span> {
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">90deg</span>, <span class="hljs-number">#6a11cb</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#2575fc</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">width</span>: <span class="hljs-number">0%</span>;
            <span class="hljs-attribute">transition</span>: width <span class="hljs-number">0.2s</span> ease;
        }
        
        <span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">768px</span>) {
            <span class="hljs-selector-class">.container</span> {
                <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>;
            }
            
            <span class="hljs-selector-tag">h1</span> {
                <span class="hljs-attribute">font-size</span>: <span class="hljs-number">2rem</span>;
            }
            
            <span class="hljs-selector-class">.control-panel</span> {
                <span class="hljs-attribute">flex-direction</span>: column;
                <span class="hljs-attribute">align-items</span>: stretch;
            }
            
            <span class="hljs-selector-class">.btn</span> {
                <span class="hljs-attribute">justify-content</span>: center;
            }
            
            <span class="hljs-selector-class">.position-marker</span> {
                <span class="hljs-attribute">display</span>: none <span class="hljs-meta">!important</span>;
            }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ»šåŠ¨è¿›åº¦æ¡ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"scroll-progress"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"scroll-progress-bar"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- ä½ç½®æ ‡è®° --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"position-marker"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ä¸Šæ¬¡é˜…è¯»ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"position-info"</span>&gt;</span>ç¬¬ <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"chapter-num"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> ç« <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"position-info"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"position-percent"</span>&gt;</span>0%<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-book-bookmark"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> é˜…è¯»ä½ç½®è®°å¿†åŠŸèƒ½<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"subtitle"</span>&gt;</span>ç¦»å¼€é¡µé¢åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¿å­˜æ‚¨çš„é˜…è¯»ä½ç½®ã€‚é‡æ–°æ‰“å¼€æ—¶ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸Šæ¬¡é˜…è¯»çš„ä½ç½®ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"control-panel"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-indicator"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"indicator-dot"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"status-dot"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"status-text"</span>&gt;</span>çŠ¶æ€ï¼šæœªæ£€æµ‹åˆ°å†å²è®°å½•<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-primary"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"save-btn"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-save"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> æ‰‹åŠ¨ä¿å­˜å½“å‰ä½ç½®
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"jump-btn"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-arrow-right"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> è·³è½¬åˆ°ä¸Šæ¬¡ä½ç½®
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-warning"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"clear-btn"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-trash-alt"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> æ¸…é™¤è®°å½•
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"content"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ --&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Â© 2025 é˜…è¯»ä½ç½®è®°å¿†æ¼”ç¤º | ä½¿ç”¨ localStorage å®ç°ä½ç½®è®°å¿†åŠŸèƒ½<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å°è¯•æ»šåŠ¨é¡µé¢ï¼Œç„¶ååˆ·æ–°æˆ–å…³é—­é¡µé¢ï¼Œé‡æ–°æ‰“å¼€æ—¶ä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸Šæ¬¡é˜…è¯»çš„ä½ç½®ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// ç”Ÿæˆç¤ºä¾‹å†…å®¹</span>
        <span class="hljs-keyword">const</span> chapters = [
            {
                <span class="hljs-attr">title</span>: <span class="hljs-string">"ç¬¬ä¸€ç« ï¼šåˆè¯†å‰ç«¯å¼€å‘"</span>,
                <span class="hljs-attr">content</span>: <span class="hljs-string">`å‰ç«¯å¼€å‘æ˜¯åˆ›å»ºWebé¡µé¢æˆ–Appç­‰å‰ç«¯ç•Œé¢å‘ˆç°ç»™ç”¨æˆ·çš„è¿‡ç¨‹ã€‚é€šè¿‡HTMLã€CSSåŠJavaScriptä»¥åŠè¡ç”Ÿå‡ºæ¥çš„å„ç§æŠ€æœ¯ã€æ¡†æ¶ã€è§£å†³æ–¹æ¡ˆï¼Œæ¥å®ç°äº’è”ç½‘äº§å“çš„ç”¨æˆ·ç•Œé¢äº¤äº’ã€‚
                
                éšç€äº’è”ç½‘æŠ€æœ¯çš„å‘å±•ï¼ŒHTML5ã€CSS3ã€ES6ç­‰ç°ä»£å‰ç«¯æŠ€æœ¯çš„åº”ç”¨ï¼Œä½¿å¾—å‰ç«¯å¼€å‘èƒ½å¤Ÿå®ç°æ›´ä¸°å¯Œçš„äº¤äº’å’Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚å‰ç«¯å·¥ç¨‹å¸ˆéœ€è¦ä¸è®¾è®¡å¸ˆã€åç«¯å·¥ç¨‹å¸ˆåä½œï¼Œå®Œæˆäº§å“çš„å‰ç«¯å¼€å‘å·¥ä½œã€‚
                
                å‰ç«¯å¼€å‘é¢†åŸŸæŠ€æœ¯æ›´æ–°è¿…é€Ÿï¼Œå¼€å‘è€…éœ€è¦ä¸æ–­å­¦ä¹ æ–°æŠ€æœ¯ã€æ–°æ¡†æ¶ï¼Œä»¥é€‚åº”å¿«é€Ÿå‘å±•çš„è¡Œä¸šéœ€æ±‚ã€‚Reactã€Vueã€Angularç­‰æ¡†æ¶çš„å‡ºç°ï¼Œå¤§å¤§æé«˜äº†å‰ç«¯å¼€å‘çš„æ•ˆç‡ã€‚`</span>
            },
            {
                <span class="hljs-attr">title</span>: <span class="hljs-string">"ç¬¬äºŒç« ï¼šJavaScriptçš„æ ¸å¿ƒæ¦‚å¿µ"</span>,
                <span class="hljs-attr">content</span>: <span class="hljs-string">`JavaScriptæ˜¯ä¸€ç§å…·æœ‰å‡½æ•°ä¼˜å…ˆçš„è½»é‡çº§ã€è§£é‡Šå‹æˆ–å³æ—¶ç¼–è¯‘å‹çš„ç¼–ç¨‹è¯­è¨€ã€‚è™½ç„¶å®ƒæ˜¯ä½œä¸ºå¼€å‘Webé¡µé¢çš„è„šæœ¬è¯­è¨€è€Œå‡ºåï¼Œä½†æ˜¯å®ƒä¹Ÿè¢«ç”¨åˆ°äº†å¾ˆå¤šéæµè§ˆå™¨ç¯å¢ƒä¸­ã€‚
                
                å˜é‡ä½œç”¨åŸŸã€é—­åŒ…ã€åŸå‹é“¾ã€å¼‚æ­¥ç¼–ç¨‹ç­‰æ˜¯JavaScriptçš„æ ¸å¿ƒæ¦‚å¿µã€‚ç†è§£è¿™äº›æ¦‚å¿µå¯¹äºç¼–å†™é«˜è´¨é‡JavaScriptä»£ç è‡³å…³é‡è¦ã€‚
                
                ES6å¼•å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå¦‚letå’Œconstå£°æ˜ã€ç®­å¤´å‡½æ•°ã€æ¨¡æ¿å­—ç¬¦ä¸²ã€è§£æ„èµ‹å€¼ã€Promiseç­‰ï¼Œè¿™äº›ç‰¹æ€§ä½¿å¾—JavaScriptæ›´åŠ å¼ºå¤§å’Œæ˜“ç”¨ã€‚ç°ä»£å‰ç«¯å¼€å‘å‡ ä¹éƒ½åŸºäºES6åŠä»¥ä¸Šç‰ˆæœ¬ã€‚`</span>
            },
            {
                <span class="hljs-attr">title</span>: <span class="hljs-string">"ç¬¬ä¸‰ç« ï¼šDOMæ“ä½œä¸äº‹ä»¶å¤„ç†"</span>,
                <span class="hljs-attr">content</span>: <span class="hljs-string">`æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰æ˜¯HTMLå’ŒXMLæ–‡æ¡£çš„ç¼–ç¨‹æ¥å£ã€‚å®ƒæä¾›äº†å¯¹æ–‡æ¡£çš„ç»“æ„åŒ–è¡¨è¿°ï¼Œå¹¶å®šä¹‰äº†ä¸€ç§æ–¹å¼å¯ä»¥ä½¿ç¨‹åºå¯¹è¯¥ç»“æ„è¿›è¡Œè®¿é—®ï¼Œä»è€Œæ”¹å˜æ–‡æ¡£çš„ç»“æ„ã€æ ·å¼å’Œå†…å®¹ã€‚
                
                DOMå°†æ–‡æ¡£è§£æä¸ºä¸€ä¸ªç”±èŠ‚ç‚¹å’Œå¯¹è±¡ï¼ˆåŒ…å«å±æ€§å’Œæ–¹æ³•çš„å¯¹è±¡ï¼‰ç»„æˆçš„ç»“æ„é›†åˆã€‚ç®€è¨€ä¹‹ï¼Œå®ƒä¼šå°†webé¡µé¢å’Œè„šæœ¬æˆ–ç¨‹åºè¯­è¨€è¿æ¥èµ·æ¥ã€‚
                
                äº‹ä»¶å¤„ç†æ˜¯å‰ç«¯äº¤äº’çš„æ ¸å¿ƒã€‚JavaScripté€šè¿‡äº‹ä»¶ç›‘å¬å™¨æ¥å“åº”ç”¨æˆ·çš„æ“ä½œï¼Œå¦‚ç‚¹å‡»ã€æ‚¬åœã€æ»šåŠ¨ç­‰ã€‚äº‹ä»¶å§”æ‰˜æ˜¯ä¸€ç§å¸¸ç”¨çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒåˆ©ç”¨äº‹ä»¶å†’æ³¡æœºåˆ¶ï¼Œå°†äº‹ä»¶ç›‘å¬å™¨æ·»åŠ åˆ°çˆ¶å…ƒç´ ä¸Šï¼Œè€Œä¸æ˜¯æ¯ä¸ªå­å…ƒç´ ä¸Šã€‚`</span>
            },
            {
                <span class="hljs-attr">title</span>: <span class="hljs-string">"ç¬¬å››ç« ï¼šç°ä»£å‰ç«¯æ¡†æ¶"</span>,
                <span class="hljs-attr">content</span>: <span class="hljs-string">`Reactã€Vueå’ŒAngularæ˜¯ç›®å‰æœ€æµè¡Œçš„ä¸‰å¤§å‰ç«¯æ¡†æ¶ã€‚å®ƒä»¬éƒ½é‡‡ç”¨äº†ç»„ä»¶åŒ–çš„å¼€å‘æ¨¡å¼ï¼Œå°†UIæ‹†åˆ†ä¸ºç‹¬ç«‹å¯å¤ç”¨çš„ä»£ç ç‰‡æ®µï¼Œå¹¶å¯¹æ¯ä¸ªç‰‡æ®µè¿›è¡Œç‹¬ç«‹æ„æ€ã€‚
                
                Reactç”±Facebookå¼€å‘ï¼Œä»¥å…¶è™šæ‹ŸDOMå’Œå•å‘æ•°æ®æµè€Œé—»åã€‚Vueç”±å°¤é›¨æºªåˆ›å»ºï¼Œä»¥å…¶æ¸è¿›å¼æ¡†æ¶å’Œæ˜“ç”¨æ€§å—åˆ°å¼€å‘è€…å–œçˆ±ã€‚Angularç”±Googleç»´æŠ¤ï¼Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šçº§æ¡†æ¶ã€‚
                
                è¿™äº›æ¡†æ¶éƒ½æä¾›äº†çŠ¶æ€ç®¡ç†ã€è·¯ç”±ã€æ„å»ºå·¥å…·ç­‰å®Œæ•´çš„å‰ç«¯å¼€å‘è§£å†³æ–¹æ¡ˆã€‚é€‰æ‹©å“ªä¸ªæ¡†æ¶å–å†³äºé¡¹ç›®éœ€æ±‚ã€å›¢é˜ŸæŠ€èƒ½å’Œä¸ªäººåå¥½ã€‚`</span>
            },
            {
                <span class="hljs-attr">title</span>: <span class="hljs-string">"ç¬¬äº”ç« ï¼šå“åº”å¼è®¾è®¡ä¸ç§»åŠ¨ä¼˜å…ˆ"</span>,
                <span class="hljs-attr">content</span>: <span class="hljs-string">`å“åº”å¼Webè®¾è®¡æ˜¯ä¸€ç§ç½‘é¡µè®¾è®¡æ–¹æ³•ï¼Œä½¿ç½‘ç«™èƒ½åœ¨å„ç§è®¾å¤‡ï¼ˆä»æ¡Œé¢ç”µè„‘åˆ°ç§»åŠ¨ç”µè¯ï¼‰ä¸Šå¾ˆå¥½åœ°å·¥ä½œã€‚å…¶æ ¸å¿ƒæ˜¯ä½¿ç”¨å¼¹æ€§ç½‘æ ¼å¸ƒå±€ã€å¼¹æ€§å›¾ç‰‡å’Œåª’ä½“æŸ¥è¯¢ã€‚
                
                ç§»åŠ¨ä¼˜å…ˆæ˜¯ä¸€ç§è®¾è®¡ç­–ç•¥ï¼Œé¦–å…ˆä¸ºç§»åŠ¨è®¾å¤‡è®¾è®¡ç½‘ç«™ï¼Œç„¶åé€æ­¥å¢å¼ºä¸ºå¹³æ¿ç”µè„‘å’Œæ¡Œé¢ç”µè„‘çš„è®¾è®¡ã€‚è¿™ç§ç­–ç•¥ç¡®ä¿ç½‘ç«™åœ¨å°å±å¹•ä¸Šæœ‰è‰¯å¥½çš„ä½“éªŒã€‚
                
                éšç€ç§»åŠ¨è®¾å¤‡ä½¿ç”¨é‡çš„å¢åŠ ï¼Œå“åº”å¼è®¾è®¡å’Œç§»åŠ¨ä¼˜å…ˆç­–ç•¥å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚CSSæ¡†æ¶å¦‚Bootstrapã€Tailwind CSSç­‰æä¾›äº†å®ç°å“åº”å¼è®¾è®¡çš„å·¥å…·ã€‚`</span>
            },
            {
                <span class="hljs-attr">title</span>: <span class="hljs-string">"ç¬¬å…­ç« ï¼šå‰ç«¯æ€§èƒ½ä¼˜åŒ–"</span>,
                <span class="hljs-attr">content</span>: <span class="hljs-string">`å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ˜¯æé«˜ç½‘ç«™åŠ è½½é€Ÿåº¦å’Œå“åº”é€Ÿåº¦çš„è¿‡ç¨‹ã€‚æ€§èƒ½ä¼˜åŒ–çš„ç›®æ ‡åŒ…æ‹¬å‡å°‘é¡µé¢åŠ è½½æ—¶é—´ã€å‡å°‘èµ„æºå¤§å°ã€ä¼˜åŒ–æ¸²æŸ“è·¯å¾„ç­‰ã€‚
                
                å¸¸è§çš„å‰ç«¯æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯åŒ…æ‹¬ï¼šä»£ç å‹ç¼©ã€å›¾ç‰‡ä¼˜åŒ–ã€æ‡’åŠ è½½ã€ä»£ç åˆ†å‰²ã€ç¼“å­˜ç­–ç•¥ã€å‡å°‘é‡ç»˜å’Œå›æµç­‰ã€‚ä½¿ç”¨Webpackã€Rollupç­‰æ„å»ºå·¥å…·å¯ä»¥è‡ªåŠ¨åŒ–è®¸å¤šä¼˜åŒ–ä»»åŠ¡ã€‚
                
                æ€§èƒ½ç›´æ¥å½±å“ç”¨æˆ·ä½“éªŒå’ŒSEOæ’åã€‚Googleçš„Core Web VitalsæŒ‡æ ‡å·²æˆä¸ºè¡¡é‡ç½‘ç«™ç”¨æˆ·ä½“éªŒçš„é‡è¦æ ‡å‡†ï¼ŒåŒ…æ‹¬LCPï¼ˆæœ€å¤§å†…å®¹ç»˜åˆ¶ï¼‰ã€FIDï¼ˆé¦–æ¬¡è¾“å…¥å»¶è¿Ÿï¼‰å’ŒCLSï¼ˆç´¯ç§¯å¸ƒå±€åç§»ï¼‰ã€‚`</span>
            },
            {
                <span class="hljs-attr">title</span>: <span class="hljs-string">"ç¬¬ä¸ƒç« ï¼šå‰ç«¯å·¥ç¨‹åŒ–"</span>,
                <span class="hljs-attr">content</span>: <span class="hljs-string">`å‰ç«¯å·¥ç¨‹åŒ–æ˜¯æŒ‡å°†è½¯ä»¶å·¥ç¨‹çš„æ–¹æ³•å’ŒåŸåˆ™åº”ç”¨åˆ°å‰ç«¯å¼€å‘ä¸­ï¼Œä»¥æé«˜å¼€å‘æ•ˆç‡ã€ä»£ç è´¨é‡å’Œå›¢é˜Ÿåä½œã€‚å®ƒåŒ…æ‹¬æ„å»ºå·¥å…·ã€ä»£ç è§„èŒƒã€æµ‹è¯•ã€éƒ¨ç½²ç­‰æµç¨‹ã€‚
                
                ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å·¥å…·ï¼šåŒ…ç®¡ç†å™¨ï¼ˆnpmã€yarnï¼‰ã€æ¨¡å—æ‰“åŒ…å™¨ï¼ˆWebpackã€Rollupï¼‰ã€ç¼–è¯‘å™¨ï¼ˆBabelï¼‰ã€ä»£ç æ£€æŸ¥å·¥å…·ï¼ˆESLintï¼‰ã€æ ·å¼é¢„å¤„ç†ï¼ˆSassã€Lessï¼‰ç­‰ã€‚
                
                æŒç»­é›†æˆ/æŒç»­éƒ¨ç½²ï¼ˆCI/CDï¼‰ä¹Ÿæ˜¯å‰ç«¯å·¥ç¨‹åŒ–çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åŒ–æµ‹è¯•å’Œéƒ¨ç½²æµç¨‹ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€‚`</span>
            },
            {
                <span class="hljs-attr">title</span>: <span class="hljs-string">"ç¬¬å…«ç« ï¼šå‰ç«¯æœªæ¥å‘å±•"</span>,
                <span class="hljs-attr">content</span>: <span class="hljs-string">`å‰ç«¯é¢†åŸŸæ­£åœ¨å¿«é€Ÿå‘å±•ï¼Œæ–°æŠ€æœ¯ä¸æ–­æ¶Œç°ã€‚WebAssemblyå…è®¸åœ¨æµè§ˆå™¨ä¸­è¿è¡Œé«˜æ€§èƒ½ä»£ç ï¼›Progressive Web Appsï¼ˆPWAï¼‰æä¾›ç±»ä¼¼åŸç”Ÿåº”ç”¨çš„ä½“éªŒï¼›Web Componentså®ç°çœŸæ­£çš„ç»„ä»¶å¤ç”¨ã€‚
                
                éšç€ç‰©è”ç½‘ã€äººå·¥æ™ºèƒ½å’Œ5GæŠ€æœ¯çš„å‘å±•ï¼Œå‰ç«¯å¼€å‘å°†é¢ä¸´æ–°çš„æœºé‡å’ŒæŒ‘æˆ˜ã€‚å‰ç«¯å·¥ç¨‹å¸ˆå¯èƒ½éœ€è¦æŒæ¡æ›´å¤šçš„è·¨å¹³å°å¼€å‘æŠ€èƒ½ï¼Œå¦‚React Nativeã€Flutterç­‰ã€‚
                
                å‰ç«¯å¼€å‘çš„æœªæ¥å°†æ˜¯å¤šå…ƒåŒ–ã€å…¨æ ˆåŒ–çš„ã€‚å‰ç«¯å·¥ç¨‹å¸ˆä¸ä»…éœ€è¦æŒæ¡å‰ç«¯æŠ€æœ¯ï¼Œè¿˜éœ€è¦äº†è§£åç«¯ã€DevOpsã€è®¾è®¡ç­‰ç›¸å…³çŸ¥è¯†ï¼Œä»¥åº”å¯¹æ—¥ç›Šå¤æ‚çš„äº§å“éœ€æ±‚ã€‚`</span>
            }
        ];
        
        <span class="hljs-comment">// å…¨å±€å˜é‡</span>
        <span class="hljs-keyword">let</span> scrollTimeout;
        <span class="hljs-keyword">let</span> lastSavedPosition = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">let</span> isRestoring = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STORAGE_KEY</span> = <span class="hljs-string">'reading_position'</span>;
        
        <span class="hljs-comment">// DOMå…ƒç´ </span>
        <span class="hljs-keyword">const</span> contentEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'content'</span>);
        <span class="hljs-keyword">const</span> statusDot = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'status-dot'</span>);
        <span class="hljs-keyword">const</span> statusText = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'status-text'</span>);
        <span class="hljs-keyword">const</span> saveBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'save-btn'</span>);
        <span class="hljs-keyword">const</span> jumpBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'jump-btn'</span>);
        <span class="hljs-keyword">const</span> clearBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'clear-btn'</span>);
        <span class="hljs-keyword">const</span> positionMarker = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.position-marker'</span>);
        <span class="hljs-keyword">const</span> chapterNumEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chapter-num'</span>);
        <span class="hljs-keyword">const</span> positionPercentEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'position-percent'</span>);
        <span class="hljs-keyword">const</span> scrollProgressBar = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.scroll-progress-bar'</span>);
        
        <span class="hljs-comment">// åˆå§‹åŒ–ï¼šç”Ÿæˆå†…å®¹</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">initContent</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">let</span> contentHTML = <span class="hljs-string">''</span>;
            chapters.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">chapter, index</span>) =&gt;</span> {
                contentHTML += <span class="hljs-string">`
                    &lt;div class="chapter" id="chapter-<span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>"&gt;
                        &lt;h2 class="chapter-title"&gt;<span class="hljs-subst">${chapter.title}</span>&lt;/h2&gt;
                        &lt;div class="chapter-content"&gt;
                            <span class="hljs-subst">${chapter.content.split(<span class="hljs-string">'\n'</span>).map(p =&gt; <span class="hljs-string">`&lt;p&gt;<span class="hljs-subst">${p}</span>&lt;/p&gt;`</span>).join(<span class="hljs-string">''</span>)}</span>
                        &lt;/div&gt;
                    &lt;/div&gt;
                `</span>;
            });
            contentEl.<span class="hljs-property">innerHTML</span> = contentHTML;
        }
        
        <span class="hljs-comment">// ä¿å­˜é˜…è¯»ä½ç½®</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">saveReadingPosition</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">const</span> scrollPosition = <span class="hljs-variable language_">window</span>.<span class="hljs-property">pageYOffset</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">scrollTop</span>;
            <span class="hljs-keyword">const</span> totalHeight = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">scrollHeight</span> - <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
            <span class="hljs-keyword">const</span> scrollPercent = totalHeight &gt; <span class="hljs-number">0</span> ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((scrollPosition / totalHeight) * <span class="hljs-number">100</span>) : <span class="hljs-number">0</span>;
            
            <span class="hljs-comment">// è®¡ç®—å½“å‰ç« èŠ‚</span>
            <span class="hljs-keyword">let</span> currentChapter = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">const</span> chaptersElements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.chapter'</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; chaptersElements.<span class="hljs-property">length</span>; i++) {
                <span class="hljs-keyword">const</span> rect = chaptersElements[i].<span class="hljs-title function_">getBoundingClientRect</span>();
                <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">top</span> &lt;= <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> / <span class="hljs-number">2</span>) {
                    currentChapter = i + <span class="hljs-number">1</span>;
                }
            }
            
            <span class="hljs-keyword">const</span> positionData = {
                <span class="hljs-attr">scrollTop</span>: scrollPosition,
                <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>(),
                <span class="hljs-attr">chapter</span>: currentChapter,
                <span class="hljs-attr">percent</span>: scrollPercent
            };
            
            <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable constant_">STORAGE_KEY</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(positionData));
            lastSavedPosition = scrollPosition;
            
            <span class="hljs-comment">// æ›´æ–°çŠ¶æ€</span>
            <span class="hljs-title function_">updateStatus</span>(<span class="hljs-literal">true</span>);
            
            <span class="hljs-comment">// æ˜¾ç¤ºä¿å­˜æç¤º</span>
            <span class="hljs-title function_">showNotification</span>(<span class="hljs-string">'ä½ç½®å·²ä¿å­˜ï¼'</span>);
            
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä½ç½®å·²ä¿å­˜:'</span>, positionData);
        }
        
        <span class="hljs-comment">// æ¢å¤é˜…è¯»ä½ç½®</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">restoreReadingPosition</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">const</span> savedData = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-variable constant_">STORAGE_KEY</span>);
            
            <span class="hljs-keyword">if</span> (!savedData) {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-literal">false</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> positionData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(savedData);
                isRestoring = <span class="hljs-literal">true</span>;
                
                <span class="hljs-comment">// æ»šåŠ¨åˆ°ä¿å­˜çš„ä½ç½®</span>
                <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">scrollTo</span>({
                    <span class="hljs-attr">top</span>: positionData.<span class="hljs-property">scrollTop</span>,
                    <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>
                });
                
                <span class="hljs-comment">// é«˜äº®å½“å‰ç« èŠ‚</span>
                <span class="hljs-title function_">highlightCurrentChapter</span>(positionData.<span class="hljs-property">chapter</span>);
                
                <span class="hljs-comment">// æ›´æ–°çŠ¶æ€</span>
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-literal">true</span>, positionData);
                
                <span class="hljs-comment">// æ˜¾ç¤ºæ¢å¤æç¤º</span>
                <span class="hljs-title function_">showNotification</span>(<span class="hljs-string">`å·²æ¢å¤åˆ°ä¸Šæ¬¡é˜…è¯»ä½ç½®ï¼šç¬¬<span class="hljs-subst">${positionData.chapter}</span>ç« `</span>);
                
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä½ç½®å·²æ¢å¤:'</span>, positionData);
                
                <span class="hljs-comment">// é‡ç½®æ ‡å¿—</span>
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                    isRestoring = <span class="hljs-literal">false</span>;
                }, <span class="hljs-number">1000</span>);
                
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¢å¤ä½ç½®æ—¶å‡ºé”™:'</span>, error);
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-literal">false</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
        
        <span class="hljs-comment">// æ¸…é™¤ä¿å­˜çš„ä½ç½®</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">clearSavedPosition</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-variable constant_">STORAGE_KEY</span>);
            <span class="hljs-title function_">updateStatus</span>(<span class="hljs-literal">false</span>);
            positionMarker.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
            <span class="hljs-title function_">showNotification</span>(<span class="hljs-string">'ä½ç½®è®°å½•å·²æ¸…é™¤'</span>);
        }
        
        <span class="hljs-comment">// æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateStatus</span>(<span class="hljs-params">hasData, positionData = <span class="hljs-literal">null</span></span>) {
            <span class="hljs-keyword">if</span> (hasData) {
                statusDot.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'active'</span>);
                
                <span class="hljs-keyword">if</span> (positionData) {
                    <span class="hljs-keyword">const</span> timeAgo = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>() - positionData.<span class="hljs-property">timestamp</span>) / (<span class="hljs-number">1000</span> * <span class="hljs-number">60</span>));
                    statusText.<span class="hljs-property">textContent</span> = <span class="hljs-string">`çŠ¶æ€ï¼šå·²ä¿å­˜ (<span class="hljs-subst">${timeAgo}</span>åˆ†é’Ÿå‰ï¼Œç¬¬<span class="hljs-subst">${positionData.chapter}</span>ç« )`</span>;
                    
                    <span class="hljs-comment">// æ˜¾ç¤ºä½ç½®æ ‡è®°</span>
                    positionMarker.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'block'</span>;
                    chapterNumEl.<span class="hljs-property">textContent</span> = positionData.<span class="hljs-property">chapter</span>;
                    positionPercentEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">`<span class="hljs-subst">${positionData.percent}</span>%`</span>;
                } <span class="hljs-keyword">else</span> {
                    statusText.<span class="hljs-property">textContent</span> = <span class="hljs-string">'çŠ¶æ€ï¼šå·²å¯ç”¨è‡ªåŠ¨ä¿å­˜'</span>;
                }
            } <span class="hljs-keyword">else</span> {
                statusDot.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'active'</span>);
                statusText.<span class="hljs-property">textContent</span> = <span class="hljs-string">'çŠ¶æ€ï¼šæœªæ£€æµ‹åˆ°å†å²è®°å½•'</span>;
            }
        }
        
        <span class="hljs-comment">// é«˜äº®å½“å‰ç« èŠ‚</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">highlightCurrentChapter</span>(<span class="hljs-params">chapterIndex</span>) {
            <span class="hljs-comment">// ç§»é™¤æ‰€æœ‰é«˜äº®</span>
            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.chapter'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">chapter</span> =&gt;</span> {
                chapter.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'highlight'</span>);
            });
            
            <span class="hljs-comment">// é«˜äº®å½“å‰ç« èŠ‚</span>
            <span class="hljs-keyword">const</span> currentChapter = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">`chapter-<span class="hljs-subst">${chapterIndex}</span>`</span>);
            <span class="hljs-keyword">if</span> (currentChapter) {
                currentChapter.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'highlight'</span>);
                
                <span class="hljs-comment">// 5ç§’åç§»é™¤é«˜äº®</span>
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                    currentChapter.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'highlight'</span>);
                }, <span class="hljs-number">5000</span>);
            }
        }
        
        <span class="hljs-comment">// æ˜¾ç¤ºé€šçŸ¥</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">showNotification</span>(<span class="hljs-params">message</span>) {
            <span class="hljs-comment">// åˆ›å»ºé€šçŸ¥å…ƒç´ </span>
            <span class="hljs-keyword">const</span> notification = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
            notification.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">`
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: #10b981;
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                z-index: 10000;
                font-weight: 500;
                transform: translateX(120%);
                transition: transform 0.3s ease;
            `</span>;
            notification.<span class="hljs-property">textContent</span> = message;
            <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(notification);
            
            <span class="hljs-comment">// æ˜¾ç¤ºé€šçŸ¥</span>
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                notification.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'translateX(0)'</span>;
            }, <span class="hljs-number">10</span>);
            
            <span class="hljs-comment">// 3ç§’åéšè—å¹¶ç§»é™¤</span>
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                notification.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'translateX(120%)'</span>;
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(notification);
                }, <span class="hljs-number">300</span>);
            }, <span class="hljs-number">3000</span>);
        }
        
        <span class="hljs-comment">// æ›´æ–°æ»šåŠ¨è¿›åº¦æ¡</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateScrollProgress</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">const</span> winScroll = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">scrollTop</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">scrollTop</span>;
            <span class="hljs-keyword">const</span> height = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">scrollHeight</span> - <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span>;
            <span class="hljs-keyword">const</span> scrolled = (winScroll / height) * <span class="hljs-number">100</span>;
            scrollProgressBar.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = scrolled + <span class="hljs-string">"%"</span>;
        }
        
        <span class="hljs-comment">// åˆå§‹åŒ–</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
            <span class="hljs-comment">// ç”Ÿæˆå†…å®¹</span>
            <span class="hljs-title function_">initContent</span>();
            
            <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„ä½ç½®å¹¶å°è¯•æ¢å¤</span>
            <span class="hljs-keyword">const</span> hasRestored = <span class="hljs-title function_">restoreReadingPosition</span>();
            
            <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ¢å¤ä½ç½®ï¼Œæ›´æ–°çŠ¶æ€</span>
            <span class="hljs-keyword">if</span> (!hasRestored) {
                <span class="hljs-title function_">updateStatus</span>(<span class="hljs-literal">false</span>);
            }
            
            <span class="hljs-comment">// äº‹ä»¶ç›‘å¬</span>
            saveBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, saveReadingPosition);
            jumpBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, restoreReadingPosition);
            clearBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, clearSavedPosition);
            
            <span class="hljs-comment">// ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼ˆé˜²æŠ–å¤„ç†ï¼‰</span>
            <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-comment">// æ›´æ–°æ»šåŠ¨è¿›åº¦æ¡</span>
                <span class="hljs-title function_">updateScrollProgress</span>();
                
                <span class="hljs-comment">// å¦‚æœä¸æ˜¯æ­£åœ¨æ¢å¤ä½ç½®ï¼Œåˆ™ä¿å­˜ä½ç½®</span>
                <span class="hljs-keyword">if</span> (!isRestoring) {
                    <span class="hljs-built_in">clearTimeout</span>(scrollTimeout);
                    scrollTimeout = <span class="hljs-built_in">setTimeout</span>(saveReadingPosition, <span class="hljs-number">1000</span>);
                }
                
                <span class="hljs-comment">// æ£€æµ‹å½“å‰ç« èŠ‚</span>
                <span class="hljs-keyword">const</span> chaptersElements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.chapter'</span>);
                <span class="hljs-keyword">let</span> currentChapter = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; chaptersElements.<span class="hljs-property">length</span>; i++) {
                    <span class="hljs-keyword">const</span> rect = chaptersElements[i].<span class="hljs-title function_">getBoundingClientRect</span>();
                    <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">top</span> &lt;= <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> / <span class="hljs-number">2</span>) {
                        currentChapter = i + <span class="hljs-number">1</span>;
                    }
                }
                
                <span class="hljs-comment">// æ›´æ–°ä½ç½®æ ‡è®°</span>
                <span class="hljs-keyword">const</span> scrollPosition = <span class="hljs-variable language_">window</span>.<span class="hljs-property">pageYOffset</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">scrollTop</span>;
                <span class="hljs-keyword">const</span> totalHeight = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">scrollHeight</span> - <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
                <span class="hljs-keyword">const</span> scrollPercent = totalHeight &gt; <span class="hljs-number">0</span> ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((scrollPosition / totalHeight) * <span class="hljs-number">100</span>) : <span class="hljs-number">0</span>;
                
                chapterNumEl.<span class="hljs-property">textContent</span> = currentChapter;
                positionPercentEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">`<span class="hljs-subst">${scrollPercent}</span>%`</span>;
            });
            
            <span class="hljs-comment">// é¡µé¢å¸è½½å‰ä¿å­˜ä½ç½®</span>
            <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'beforeunload'</span>, <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-title function_">saveReadingPosition</span>();
            });
            
            <span class="hljs-comment">// åˆå§‹åŒ–æ»šåŠ¨è¿›åº¦æ¡</span>
            <span class="hljs-title function_">updateScrollProgress</span>();
        }
        
        <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–</span>
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, init);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>

</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/735b1f213f3d478d9b564bc3b9aabc90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgREVNT-a0vg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633308&amp;x-signature=ufUqUeZ5t2Vh4wQDhy3mdQydy8k%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[macæœ¬åœ°æ­å»ºclaude code+é€šä¹‰åƒé—®]]></title>    <link>https://juejin.cn/post/7584742635502026779</link>    <guid>https://juejin.cn/post/7584742635502026779</guid>    <pubDate>2025-12-18T03:28:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584742635502026779" data-draft-id="7584725529876758578" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="macæœ¬åœ°æ­å»ºclaude code+é€šä¹‰åƒé—®"/> <meta itemprop="keywords" content="Claude,VibeCoding"/> <meta itemprop="datePublished" content="2025-12-18T03:28:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‰æ–—ç±³"/> <meta itemprop="url" content="https://juejin.cn/user/3157453124416622"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            macæœ¬åœ°æ­å»ºclaude code+é€šä¹‰åƒé—®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3157453124416622/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‰æ–—ç±³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:28:59.000Z" title="Thu Dec 18 2025 03:28:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>1.æ£€æŸ¥æ˜¯å¦å®‰è£…nodeå’Œnpm
node -v
npm -v
è‹¥æ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œåˆ™å·²å®‰è£…ï¼Œå¦åˆ™è¯·å®‰è£…ï¼Œè¿™ä¸ªå¾ˆå¤šæ•™ç¨‹ï¼Œå°±ä¸å¤šè¯´äº†</p>
<p>2.å®‰è£…
æ‰“å¼€å‘½ä»¤â¾ï¼Œè¾“â¼Šï¼š</p>
<pre><code class="hljs language-js" lang="js">npm install -g @anthropic-ai/claude-
</code></pre>
<p>æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</p>
<pre><code class="hljs language-js" lang="js">claude --version
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88db3168e20e4cd4b9811b132a0067b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ5paX57Gz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633338&amp;x-signature=iDwQYKrBdFz9sK4Ax5aaK7W2nrI%3D" alt="image.png" loading="lazy"/></p>
<p>3.é…ç½®åƒé—®å¤§æ¨¡å‹
3.1 ç™»å½•é€šä¹‰â¼¤æ¨¡å‹çš„åå°ç™»å½•åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fbailian.console.aliyun.com%2F" target="_blank" title="https://bailian.console.aliyun.com/" ref="nofollow noopener noreferrer">bailian.console.aliyun.com/</a> ï¼Œè·å–API KEY</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9f69a181f774ed580e1a83647a4ce3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ5paX57Gz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633338&amp;x-signature=2YTAmfNwXpi1Zk6useyeUg4b%2FwU%3D" alt="image.png" loading="lazy"/></p>
<p>3.2 é…ç½®ç¯å¢ƒå˜é‡
æ‰“å¼€é…ç½®æ–‡ä»¶zprofileæˆ–zshrc</p>
<pre><code class="hljs language-js" lang="js">vim ~/.<span class="hljs-property">zprofile</span>
</code></pre>
<p>æˆ–</p>
<pre><code class="hljs language-js" lang="js">vim ~/.<span class="hljs-property">zshrc</span>
</code></pre>
<p>åŠ å…¥</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96b84615fba649768128bd6b723056bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ5paX57Gz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633338&amp;x-signature=%2B4rKbRpvZTM36EwVKFEBnRGP%2BFQ%3D" alt="3.png" loading="lazy"/>
ä¿å­˜é€€å‡º</p>
<p>3.3 æŒ‡å®šæ¨¡å‹
æ¨¡å‹æŒ‡å®šæœ‰3ç§æ–¹å¼ï¼Œæ¨èä½¿ç”¨é…ç½®æ–‡ä»¶æ–¹å¼ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97a304a757164e028a747f80df2bdd2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ5paX57Gz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633338&amp;x-signature=A1BiR7xwyZsqpgyfaCNwF8Qgacw%3D" alt="4.png" loading="lazy"/></p>
<p>é…ç½®æ–‡ä»¶è®¾ç½®ï¼š
åœ¨å·¥ç¨‹ä¸­æ–°å»º.claude/settings.json,</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9242803c345b4af9ad6170f6b5d4ee33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ5paX57Gz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633338&amp;x-signature=vWUihjeNBCArCS19g%2BSz8Ym5RDg%3D" alt="5.png" loading="lazy"/></p>
<p>jsonæ–‡ä»¶ä¸­å¡«å†™æ¨¡å‹å‚æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-string">"env"</span>: {
    <span class="hljs-string">"ANTHROPIC_MODEL"</span>: <span class="hljs-string">"qwen3-max"</span>,
    <span class="hljs-string">"ANTHROPIC_SMALL_FAST_MODEL"</span>: <span class="hljs-string">"qwen-flash"</span>
  }
}

</code></pre>
<p>ç°åœ¨æ•´ä¸ªé…ç½®å·²ç»å¤§åŠŸå‘Šæˆï¼ï¼ï¼ç‚¹ä¸ªğŸ‘é¼“åŠ±ä¸€ä¸‹å§...</p>
<p>4.ä½¿ç”¨
åœ¨ç»ˆç«¯è¿›å…¥åˆ°å·¥ç¨‹ç›®å½•ï¼Œç„¶åè¾“å…¥claudeå°±å¯ä»¥ä½¿ç”¨å•¦ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨ä¼šæœ‰ä¸€äº›ç¡®è®¤æç¤ºï¼ŒæŒ‰ç…§æç¤ºæ“ä½œå³å¯</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/338144a83a03487ba79554643b2cba11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ5paX57Gz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633338&amp;x-signature=3K7TrWFVhwJDPa%2FMjDNfwFqfJH8%3D" alt="6.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Comateå¼ºåŠ›èµ‹èƒ½ï¼šã€Œè¶£ç»˜åƒç´ å²›ã€ä»ä½“éªŒæ³¥æ½­åˆ°é«˜æ€§èƒ½å¯ç”¨çš„èœ•å˜ä¹‹è·¯]]></title>    <link>https://juejin.cn/post/7584761090669002752</link>    <guid>https://juejin.cn/post/7584761090669002752</guid>    <pubDate>2025-12-18T03:27:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584761090669002752" data-draft-id="7584472215974903823" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Comateå¼ºåŠ›èµ‹èƒ½ï¼šã€Œè¶£ç»˜åƒç´ å²›ã€ä»ä½“éªŒæ³¥æ½­åˆ°é«˜æ€§èƒ½å¯ç”¨çš„èœ•å˜ä¹‹è·¯"/> <meta itemprop="keywords" content="å‰ç«¯,ç¨‹åºå‘˜,åç«¯"/> <meta itemprop="datePublished" content="2025-12-18T03:27:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–‡å¿ƒå¿«ç BaiduComate"/> <meta itemprop="url" content="https://juejin.cn/user/992209294070809"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Comateå¼ºåŠ›èµ‹èƒ½ï¼šã€Œè¶£ç»˜åƒç´ å²›ã€ä»ä½“éªŒæ³¥æ½­åˆ°é«˜æ€§èƒ½å¯ç”¨çš„èœ•å˜ä¹‹è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/992209294070809/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–‡å¿ƒå¿«ç BaiduComate
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T03:27:24.000Z" title="Thu Dec 18 2025 03:27:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ä½œè€…ç®€ä»‹ï¼š</strong></p>
<p>æœ±æµ·ç‡•ï¼Œä¼šè®¾è®¡çš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œçƒ­è¡·ç”¨AI Coding èµ‹èƒ½å¼€å‘æ•ˆç‡ï¼Œæ“…é•¿æŠŠç¹ççš„ç¼–ç å·¥ä½œäº¤ç»™æ™ºèƒ½å·¥å…·ï¼Œä»è€Œè…¾å‡ºæ—¶é—´æ‰“ç£¨äº§å“äº¤äº’ç»†èŠ‚ä¸æŠ€æœ¯æ·±åº¦ã€‚ä½œå“ã€Œè¶£ç»˜åƒç´ å²›ã€è·å¾—â€œCCFç¨‹åºå‘˜å¤§ä¼šç åŠ›å…¨å¼€ï¼šAIåŠ é€Ÿè¥â€æ´»åŠ¨å† å†›ã€‚</p>
</blockquote>
<h2 data-id="heading-0">1 äº§å“ç¢ç¢å¿µ</h2>
<p>å…¶å®åˆ›æ„çµæ„Ÿåœ¨9æœˆå°±æƒ³åˆ°äº†ï¼Œæ¯”å¦‚æˆ‘ä¸ªäººå–œæ¬¢ç”»ç”»ï¼Œä¹Ÿæ„¿æ„æ•™åˆ«äººç”»ç”»ï¼Œä½†æ˜¯ä¸€ä¸ªäººçš„åŠ›é‡å…¶å®ä¸ç®—å¤§ï¼Œæ—¶é—´ä¹Ÿå¾ˆæœ‰é™ï¼Œå¸Œæœ›æœ‰ä¸€ä¸ªå¹³å°å‹å·¥å…·ï¼Œå¯ä»¥æ ¹æ®æ¯ä¸ªäººçš„æƒ…å†µå’ŒåŸºç¡€ï¼Œç»™å‡ºä¸ä¸€æ ·çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™æ˜¯AIèƒ½åšå¾—æ¯”è¾ƒå¥½çš„ç‚¹ã€‚<strong>äºæ˜¯æˆ‘æƒ³åšä¸€æ¬¾å„¿ç«¥æ’ç”»AIè¾…åŠ©å·¥å…·ï¼Œå»è§£å†³ç”»ç”»é‡åˆ°çš„å››ä¸ªé—®é¢˜â€œç”»ä»€ä¹ˆï¼Œæ€ä¹ˆç”»ï¼Œç”»å¾—æ€ä¹ˆæ ·ï¼Œç”»å®Œä¹‹å...â€ã€‚</strong> è®©æ•´ä¸ªæµç¨‹ä¸²èµ·æ¥ï¼Œç”»å®Œçš„ä½œå“å¸¦ç€æ¸©åº¦å’Œæ„ä¹‰ï¼Œå¯ä»¥ä½œä¸ºè´´çº¸ã€è¡¨æƒ…åŒ…ã€æ˜ä¿¡ç‰‡æ”¶è—ï¼Œç”»æ¿å°±æ˜¯è¿™ä¸ªå·¥å…·çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚9æœˆåº•å¼€å‘äº†ä¸€éƒ¨åˆ†ï¼Œç”±äºä¸€äº›æŠ€æœ¯ç»†èŠ‚å®ç°å¡ä½ï¼Œæ¯”å¦‚ç¬”åˆ·æŠ–åŠ¨ç²—ç»†çš„æ§åˆ¶ï¼Œç”»å®Œä¹‹åå›¾åƒè£å‰ªã€å¡«å……ã€æè¾¹ï¼Œå®ç°æ•ˆæœéƒ½ä¸å°½å¦‚äººæ„ï¼Œäºæ˜¯è¿›ç¨‹åœé¡¿ã€‚</p>
<p>11æœˆä»½ï¼Œçœ‹åˆ°äº†ç™¾åº¦æ–‡å¿ƒå¿«ç â€œCCFç¨‹åºå‘˜å¤§ä¼šç åŠ›å…¨å¼€ï¼šAIåŠ é€Ÿè¥â€æ´»åŠ¨å®£ä¼ ï¼Œå°è¯•ä½¿ç”¨äº†Comateï¼Œæ„Ÿè§‰ä¸€ä¸‹å­æå‡ç”Ÿäº§åŠ›ï¼Œå°±å¼€å§‹æŠŠä¹‹å‰éš¾ä»¥è½åœ°çš„æƒ³æ³•éƒ½ä¸€ä¸€å®ç°äº†ï¼Œè¿˜åšäº†å›ºå®šå…ƒç´ åˆ›æ„åŠŸèƒ½ï¼Œä¼˜åŒ–äº†ç”»æ¿äº¤äº’ï¼Œæ›´ç¬¦åˆæ“ä½œé€»è¾‘ï¼ˆæ¯”å¦‚é€‰å®Œè‰²å—å°±åˆ‡åˆ°ä¸Šè‰²ç¬”åˆ·ï¼Œé¿å…è®¤çŸ¥é”™ä½ï¼‰ã€‚æˆ‘å’ŒZuluçš„ä¼šè¯ï¼Œæ ¸å¿ƒæ˜¯æ‰“ç£¨äº¤äº’é€»è¾‘ã€å®ç°æ–°åŠŸèƒ½ã€é‡æ„ä»£ç ã€æå‡å“åº”æ€§èƒ½ã€‚å°¤å…¶åŠ äº†å«å›¾åŠŸèƒ½ï¼Œæå‡äº†ç”»æ¿çš„é€šç”¨æ€§ï¼Œä¹Ÿæ˜¯æˆ‘æœ€æœ€æ»¡æ„çš„åŠŸèƒ½ï¼Œç”¨æˆ·ç°åœ¨å¯ä»¥éšä¾¿çœ‹åˆ°å“ªä¸ªç”»æ¯”è¾ƒå¥½å°±æˆªå›¾ï¼Œåˆ°ç”»æ¿é¡µé¢ç›´æ¥CtrlVç²˜è´´ç”¨åšå‚è€ƒå›¾ï¼Œè¿™ä¸ªåŠŸèƒ½å¤§å¤§æå‡äº†ç”¨æˆ·ä½“éªŒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4e04fd769134245b678f1c0efd49a3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=8hdBMmJHVJq50voVHtrV7QhXYIc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æˆªå›¾å¹¶ç²˜è´´åˆ°ç”»æ¿ä½œä¸ºå‚è€ƒå›¾</p>
<p>æ¥çœ‹çœ‹è¶£å‘³åè¶³çš„äº§å“æ¼”ç¤ºè§†é¢‘å§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FtRC4YAASdm28QHULbACREw" target="_blank" title="https://mp.weixin.qq.com/s/tRC4YAASdm28QHULbACREw" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/tRC4YAASdâ€¦</a></p>
<h3 data-id="heading-1">1.1 ä½¿ç”¨Zulué‡æ„å‰</h3>
<p>æ²¡æœ‰é«˜äº®æ•ˆæœï¼Œç”»ç¬”ä½¿ç”¨åˆ‡æ¢å­˜åœ¨Bugï¼Œæ²¡æœ‰æ’¤é”€å›é€€åŠŸèƒ½ï¼Œæ²¡æœ‰æ¸…ç©ºç”»å¸ƒåŠŸèƒ½ï¼Œæ²¡æœ‰å·¥å…·æ ï¼Œæ— æ³•è‡ªä¸»æ§åˆ¶é¢œè‰²åˆ‡æ¢ï¼Œç”»æ¿æ— æ³•è‡ªé€‚åº”ï¼Œåœ¨æ‰‹æœºç«¯æ‰“å¼€ç›´æ¥å´©äº†æ— æ³•ä½¿ç”¨ï¼Œç”¨æˆ·ä½“éªŒè¾ƒå·®ï¼Œæ²¡æœ‰å«å›¾åŠŸèƒ½ä»¥åŠå«å›¾è°ƒèŠ‚å¤§å°åŠŸèƒ½ï¼Œç¬”åˆ·ä¼šå¡ä½ï¼Œæ²¡åŠæ³•æ­£å¸¸ä½œç”»...æ€»è€Œè¨€ä¹‹ï¼Œæƒ³æ³•å¾ˆä¸°æ»¡ï¼Œè½åœ°å¾ˆéª¨æ„Ÿã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dee10aac93204f11980a3255577738ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=UooVSgIcIX21dUMZpgXomRwcix8%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä½¿ç”¨Zulué‡æ„å‰çš„ç»˜ç”»äº§å“</p>
<h3 data-id="heading-2">1.2 ä½¿ç”¨Zulué‡æ„å</h3>
<ul>
<li>å·¥å…·æœ‰äº†é«˜äº®ï¼Œåˆ‡æ¢åŠ¨ç”»ä¹Ÿå¾ˆæµç•…ï¼›</li>
<li>å¯ä»¥è‡ªç”±ä¸Šä¼ æƒ³å‚è€ƒçš„å›¾ç‰‡ï¼Œè°ƒèŠ‚å‚è€ƒå›¾å¤§å°ï¼ŒåŠŸèƒ½å®Œå–„ï¼›</li>
<li>æœ‰æ’¤é”€å›é€€åŠŸèƒ½ï¼ˆå¯ä»¥å›é€€20æ­¥ï¼‰ï¼Œèƒ½å¤Ÿä¸€é”®æ¸…ç©ºç”»å¸ƒï¼Œå¯ä»¥è‡ªç”±è°ƒèŠ‚è‰²æ¿ï¼Œçµæ´»ç”¨è‰²ï¼›</li>
<li>ç»™ç”»å®Œçš„ç”»åšäº†æ´ªæ°´å¡«å……æ•ˆæœï¼Œå¹¶ä¸”åŠ äº†æè¾¹æ•ˆæœï¼Œçœ‹èµ·æ¥åƒè´´çº¸ä¸€æ ·ï¼Œè´´çº¸å¯ä»¥ç›´æ¥å¤åˆ¶åˆ°å‰ªåˆ‡æ¿ï¼Œç›´æ¥å‘é€åˆ°èŠå¤©æ¡†æˆ–è€…æ–‡æ¡£ï¼Œä¹Ÿæ”¯æŒä¸€é”®ä¸‹è½½å•ä¸ªè´´çº¸ï¼Œè€Œéæ•´ä¸ªè´´çº¸ï¼›</li>
<li>çº¿æ¡æŠ–åŠ¨æ•ˆæœä¹Ÿæ›´åŠ åˆç†ï¼ŒZuluç»™åº”ç”¨æ¥å…¥äº†clarityï¼Œå¯ä»¥ç›‘æ§ç”¨æˆ·çš„åŸ‹ç‚¹ä¿¡æ¯ï¼›</li>
<li>æ•´ä½“æ€§èƒ½ä¼˜åŒ–æå‡ï¼Œç§’å¼€ç‡æå‡ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/383feb4760c6482c929e65add570475a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=h%2FGRqaHzJH1juMRscMv7r5hlzWw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18fc32a0dda848b4999e1d7dd78a6a03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=eKMM7GbUA5xHUasq9OCrFx%2Bct6o%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b0da118ebdc46bea8bdb0b430f6874d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=2zn9Uf8B3xlU%2BoPZ3Fo82utUHn4%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä½¿ç”¨Zulué‡æ„åçš„ç»˜ç”»äº§å“ã€Œè¶£ç»˜åƒç´ å²›ã€</p>
<h2 data-id="heading-3">2 Comateå¸®æˆ‘åšäº†ä»€ä¹ˆ</h2>
<blockquote>
<p>è¯´æ˜ï¼šä»¥ä¸‹ä½¿ç”¨Comateå‡ä¸ºZuluæ¨¡å¼</p>
</blockquote>
<h3 data-id="heading-4">2.1 åŠŸèƒ½å®ç°</h3>
<h4 data-id="heading-5">2.1.1 å®Œå–„ç”»æ¿åŠŸèƒ½</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä½¿ç”¨Comateå®Œæˆäº†ç¬”åˆ·çš„ä¼˜åŒ–ï¼Œå¹¶æŠŠé…ç½®é¡¹ï¼ˆæŠ–åŠ¨å¹…åº¦ã€ç¬”åˆ·ç²—ç»†ï¼‰æš´éœ²å‡ºæ¥ï¼Œå¯ä»¥åœ¨å®é™…æ“ä½œä¸­åŠ¨æ€è°ƒæ•´ï¼Œæ‰¾åˆ°æœ€åˆé€‚çš„æ•°å€¼ã€‚æˆ‘è®¤ä¸ºä¸€äº›åŠŸèƒ½ç”¨æˆ·éœ€è¦è‡ªä¸»è°ƒèŠ‚ï¼Œäºæ˜¯è®©Comateå¸®æˆ‘æš´éœ²å‡ºæ¥ï¼Œä½†æ˜¯åˆä¸å¸Œæœ›å½±å“ç”¨æˆ·å†³ç­–ï¼Œäºæ˜¯ä½¿ç”¨Comateç¼–ç ï¼ŒæŠ˜å äº†åº•éƒ¨ã€Œé«˜çº§å·¥å…·ã€ï¼Œç”¨æˆ·å¯ä»¥æ§åˆ¶è°ƒè‰²ç›˜çš„è‰²å€¼ï¼Œé€‰æ‹©è‡ªå·±å–œæ¬¢çš„é…è‰²ã€‚åŒæ—¶å¢åŠ äº†æ’¤é”€å’Œå›é€€åŠŸèƒ½ã€ä¸€é”®æ¸…ç©ºç”»å¸ƒçš„åŠŸèƒ½ã€‚ä»ä¹‹å‰æ¯æ¬¡ç”»é”™éƒ½è¦å°å¿ƒç”¨æ©¡çš®æ“¦åŠå¤©ï¼Œå˜å¾—å¯ä»¥ä»»æ„æ’¤é”€ã€‚ä½†æ˜¯åœ¨è¿‡ç¨‹ä¸­ï¼Œåˆè§‰å¾—ç‚¹å‡»æŒ‰é’®çš„æ“ä½œæ–¹å¼æœ‰ç‚¹éº»çƒ¦ï¼Œäºæ˜¯è®©ComateåŠ äº†å¿«æ·é”®æ§åˆ¶æ’¤é”€å’Œå›é€€ã€‚Comateå‡ ä¹3åˆ†é’Ÿä¸åˆ°å°±å®Œæˆäº†æ“ä½œï¼Œè®©äººååˆ†æƒŠå–œï¼Œè¿˜é¡ºä¾¿ä¿®å¤äº†ä¸€ä¸ªæ©¡çš®æ“¦Bugã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b78e27189c9b42338297b4e1a11fa0df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=861ompkjQDAv%2BIa2IDVz0b8aYXU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ç”»æ¿åº•éƒ¨é«˜çº§å·¥å…·</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/133885238eca4135b2bd452d6f04977a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=%2F0PLjWi%2BXgPHlhd3hZfGV%2Fw7XFM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a23c739f9a3e4b309229aa6a627d0770~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=iioRrfcBF1DFEYelXot3%2FGmH2B4%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10329df27165433ca3823b63e129a4ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=W%2BXLdeDSk0BsC9XEaUP1JPAkx%2BE%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä½¿ç”¨Zuluæš´éœ²ç¬”åˆ·æŠ–åŠ¨å¹…åº¦ã€ä¼˜åŒ–ç”»ç¬”ç²—ç»†ã€å·¥å…·æ å¸ƒå±€ç­‰</p>
<p>ï»¿ç„¶åï¼Œæˆ‘å¼€å§‹è°ƒè¯•äº¤äº’åŠŸèƒ½ï¼Œå‘ç°å¯ä»¥åŠ ä¸€ä¸ªç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ï¼ˆä¾¿äºä¸´æ‘¹ï¼‰çš„åŠŸèƒ½ã€‚å¦‚æœè‡ªå·±æƒ³ï¼Œæ„Ÿè§‰ä¸€ä¸‹åˆæ—¶é—´åˆè¦æ²¡äº†ï¼Œäºæ˜¯æˆ‘ç›´æ¥è·ŸComateè¯´ï¼šå¸®æˆ‘åŠ ä¸ªä¸Šä¼ å›¾ç‰‡åŠŸèƒ½ã€‚Comateä¹Ÿå¾ˆæ‡‚æˆ‘ï¼Œåœ¨å·¥å…·æ åŠ äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce36d28cbbfc475d963b9056ded85523~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=7c%2FM5wDACyD2azPSs%2BcU1cPUeaw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>å®é™…æ“ä½œæ—¶ï¼Œæˆ‘å‘ç°ä¸Šä¼ å›¾ç‰‡å¾ˆéº»çƒ¦ï¼Œéœ€è¦å…ˆæˆªå›¾ä¿å­˜ã€å†ä¸Šä¼ ã€‚äºæ˜¯æˆ‘åˆæƒ³åˆ°äº†å¿«æ·é”®ï¼šèƒ½ä¸èƒ½CtrlVç›´æ¥ä¸Šä¼ å‘¢ï¼Ÿäºæ˜¯æˆ‘è·ŸComateè¯´ï¼Œå¸®æˆ‘åŠ ä¸€ä¸ªå¿«æ·é”®ï¼šç²˜è´´å‰ªåˆ‡æ¿çš„å›¾ç‰‡ã€‚ä¸€éª¨ç¢Œçš„åŠŸå¤«ï¼ŒComateå°±æ”¹å¥½äº†ã€‚ç°åœ¨å°±èƒ½ç›´æ¥ä»ç½‘ç«™æˆªå›¾å¹¶ç«™è´´è‡ªå·±å–œæ¬¢çš„ç®€ç¬”ç”»ï¼Œè¿›è¡Œä¸´æ‘¹ã€‚</p>
<p>è¿™æ—¶ï¼Œæˆ‘åˆå‘ç°äº†é—®é¢˜ï¼šæˆªå›¾åˆé€‚éœ€è¦è€ƒéªŒæˆªå›¾æŠ€å·§ï¼Œæœ‰æ—¶åœ¨ç”»æ¿å°±æ˜¾å¾—å¾ˆå¤§ï¼Œæœ‰æ—¶æ˜¾å¾—å¾ˆå°ã€‚äºæ˜¯æˆ‘è§‰å¾—å¾—éœ€è¦ä¸€ä¸ªå¯ä»¥è°ƒèŠ‚å«å›¾å¤§å°çš„æ–¹æ³•ã€‚å¾ˆå¿«ï¼ŒComateå°±å®Œæˆäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed8a2b86cfb34f4c8f3e05eb3f8c97eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=wPW9dfXZ7ziBCazSuGtm%2BNMkiCA%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>å«å›¾å¤§å°å¯è°ƒèŠ‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0890669570584bf79567b3c78b7499a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=s29sWUQSB9rv%2BUKS4UDGSiTmn6g%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä¼˜åŒ–ç”»ç¬”è®¾ç½®ã€ç”»æ¿äº¤äº’æ–¹å¼ï¼Œå«å›¾å¤§å°å¯è°ƒèŠ‚</p>
<h4 data-id="heading-6">2.1.2 æ–°å¢è´´çº¸åŠŸèƒ½</h4>
<p>æ¥ä¸‹æ¥æ˜¯è´´çº¸åŠŸèƒ½ï¼Œæˆ‘éœ€è¦æŠŠç”¨æˆ·çš„ç”»ä½œåšæˆè´´çº¸ç­‰æ–‡åˆ›äº§å“ã€‚ç¬¬ä¸€æ­¥å°±æ˜¯æ‹¿åˆ°ç”¨æˆ·çš„ç”»ï¼Œä½†æˆ‘å‘ç°å› ä¸ºç”»æ¿æ˜¯ç™½è‰²çš„ï¼Œç”¨æˆ·ä¸ä¼šå»åˆ»æ„å¡«å……ç™½è‰²ã€‚å°±ä¼šå¯¼è‡´å¾—åˆ°çš„å›¾ç‰‡æ˜¯é•‚ç©ºçš„ï¼Œéå¸¸ä¸‘é™‹ï¼Œè¿™ç§å›¾ç‰‡èƒ½å¯¼å‡ºç»™ç”¨æˆ·å—ï¼Ÿæ˜¾ç„¶ä¸å¯ä»¥ã€‚äºæ˜¯Comateä½¿ç”¨æ´ªæ°´å¡«å……ç®—æ³•ï¼Œå¸®æˆ‘å…ˆæŠŠå›¾ç‰‡çš„ç™½è‰²è¡¥é½ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¯¼å‡ºæ¥çš„æ˜¯ä¸€å—çŸ©å½¢å¤§å›¾ï¼Œå’Œç”»æ¿å°ºå¯¸ä¸€æ ·å¤§ï¼Œæ”¾åˆ°è´´çº¸æ¨¡ç‰ˆé‡Œé¢éå¸¸ä¸ç¾è§‚ï¼Œè€Œä¸”å ç©ºé—´ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f14294f7bc94231a3c8bdc89976cc4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=LaeJlftd3REx%2B%2BLLW9upsXUmZOc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>é‚£ä¹ˆå°±å¾—å‰ªè£æ‰ï¼ŒComateæŠŠå¤–å›´ç™½è‰²åŒºåŸŸå…¨éƒ¨è®¡ç®—æ¸…é™¤ï¼Œå¹¶åœ¨æˆ‘çš„è¦æ±‚ä¸‹åŠ ä¸Šäº†åˆé€‚çš„æè¾¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b53a105166794cec8b108be87f0880cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=dRoxJBidt1dkbZqJ%2Bnee3t1jnCw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ¸…é™¤å¤–å›´ç™½è‰²åŒºåŸŸå¹¶æ·»åŠ æè¾¹</p>
<p>è¿™æ—¶ï¼Œå¯¼å‡ºæ¥çš„è´´çº¸ï¼Œå…¶å®æ˜¯è´´çº¸é›†ï¼Œæœ‰æ—¶å€™æˆ‘è§‰å¾—æŸä¸ªè´´çº¸å¾ˆå¥½çœ‹ï¼Œæƒ³å•ç‹¬ä¸‹è½½ï¼Œäºæ˜¯ï¼ŒComateè´´å¿ƒå¢åŠ äº†ä¸‹å›¾å·¥å…·æ é€‰æ‹©ã€å¤åˆ¶ã€åˆ é™¤è´´çº¸ç­‰åŠŸèƒ½ï¼Œç”šè‡³èƒ½ç›´æ¥ç²˜è´´åˆ°å‰ªåˆ‡æ¿ï¼Œç”¨åå³ç„šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10bb91ed9012466ba4e911b532f442f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=lwEahI0coc9DWfJCSxRdPNAWwyc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c90ba9932e148cd93252cf1764c9c45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=acc%2Fy2GFUB9p%2FP%2Bkb1fP0At12WM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä¼˜åŒ–è´´çº¸åŠŸèƒ½</p>
<h4 data-id="heading-7">2.1.3 ä¼˜åŒ–ç”»æ¿äº¤äº’åŠ¨ç”»</h4>
<p>å…¶å®ç”»æ¿äº¤äº’åŠ¨ç”»ï¼Œä¸€å¼€å§‹åšå¾—ä¹Ÿä¸æ˜¯å¾ˆå¥½ã€‚ç”¨çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨åˆ‡æ¢åˆ°è°ƒè‰²ç›˜ï¼Œé€‰å®Œé¢œè‰²å†ç‚¹å‡»ä¸Šè‰²ç¬”ï¼Œè¿™ä¸ªäº¤äº’å¾ˆç¹çï¼›æœ‰æ—¶å€™å¯èƒ½åœ¨å‹¾çº¿ï¼Œé€‰å®Œé¢œè‰²ï¼Œè¿˜æ˜¯ç”¨å‹¾çº¿ç¬”æ¶‚ï¼Œå°±ä¼šå¯¼è‡´ä¸Šäº†é»‘è‰²ï¼Œä¹‹å‰è¿˜æ²¡æœ‰æ’¤é”€åŠŸèƒ½ï¼Œç®€ç›´æ˜¯ç¾éš¾ç°åœº...éœ€è¦æ“¦é™¤ä¹‹åè¡¥ç”»ï¼Œéå¸¸éº»çƒ¦ã€‚</p>
<p>äºæ˜¯æˆ‘æƒ³æ˜¯ä¸æ˜¯èƒ½ä»å·¥å…·ä¾§è§„é¿è¿™ä¸ªé—®é¢˜ï¼Œé€‰å®Œé¢œè‰²ï¼Œç›´æ¥åˆ‡åˆ°ä¸Šè‰²ç¬”ï¼Œå¹¶ç»™å‡ºé«˜äº®ç­‰äº¤äº’åŠ¨ç”»ã€‚ä½†æˆ‘æ˜¾ç„¶åªçŸ¥é“å¯ä»¥ç”¨å¤šè½¨é“åŠ¨ç”»ï¼Œä½†ä¸å¤ªäº†è§£è¯¥æ€ä¹ˆæ“ä½œï¼Œä¹Ÿä¸æƒ³å»çœ‹npmåŒ…æºç ï¼Œäºæ˜¯ç›´æ¥è¯¢é—®Comateï¼ŒComateç»™æˆ‘åˆ—å‡ºäº†APIæ–¹æ³•ï¼Œè¿™å—æˆ‘å–œæ»‹æ»‹å¾—è°ƒç”¨èµ·æ¥ï¼ŒåŠ¨ç”»äº¤äº’å’Œé€»è¾‘æµç•…éå‡¡ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35fd4f8474b743f892128364b90a0b9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=TepsWeuSaAxV05ZGlAlF6sV%2BUWE%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9485eb2baeb4a91b61befcd6003fd1c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=aOaSsgEQm9Y6HxqHaqYMrwqjXEM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>è¯¢é—®Comateå¤šè½¨åŠ¨ç”»å¤„ç†æ–¹å¼ï¼ŒComateåˆ—å‡ºäº†APIæ–¹æ³•</p>
<h4 data-id="heading-8">2.1.4 åŸ‹ç‚¹ç›‘æ§</h4>
<p>ç”±äºéœ€è¦ç»Ÿè®¡ç”¨æˆ·ä½¿ç”¨æ•°æ®ï¼Œè®©Zuluå¸®æˆ‘æ¥å…¥äº†åŸ‹ç‚¹åŠŸèƒ½ï¼Œ5minä¸åˆ°å°±å¸®æˆ‘æ¥å…¥äº†clarityï¼ŒçœŸçš„å¾ˆé«˜æ•ˆï½</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44ac89cb3cf64c9f823d60abbce8e3aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=u6cFX27aKxXo1xpMlNsqQb47i%2Fo%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä½¿ç”¨Zuluæ¥å…¥åŸ‹ç‚¹åŠŸèƒ½</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75ea5fb6e9b741ecb626fcf9ea4e42b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=nV9Hkx1V28LgzYqj%2BJTy7ovxEYQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ã€Œè¶£ç»˜åƒç´ å²›ã€æ•°æ®çœ‹æ¿</p>
<h3 data-id="heading-9">2.2 é‡æ„ä»£ç ä¸æ€§èƒ½ä¼˜åŒ–</h3>
<p>æ­¤å¤–ï¼ŒComateè¿˜ååŠ©å®Œæˆäº†ä»£ç çš„ä¼˜åŒ–ä¸é‡æ„å·¥ä½œï¼šé€šè¿‡æŠ½è±¡å…¬å…±å‡½æ•°å®ç°å¤ç”¨ï¼Œä¸ä»…æå‡äº†å·¥ç¨‹ä»£ç çš„å¯è¯»æ€§ï¼ˆä»£ç ä¸­é…å¥—æ·»åŠ äº†ä¸°å¯Œæ³¨é‡Šï¼‰ï¼Œè¿˜æ˜¾è‘—ä¼˜åŒ–äº†æ€§èƒ½ï¼Œå®ç°äº†åº”ç”¨çš„ç§’å¼€æ•ˆæœã€‚å…¶ä¸­ï¼Œæˆ‘å¯¹æ€§èƒ½ä¼˜åŒ–ã€å…¬å…±å‡½æ•°æŠ½ç¦»è¿™ä¸¤éƒ¨åˆ†çš„ä¼˜åŒ–æˆæœæœ€ä¸ºæ»¡æ„ï¼Œæœ€ç»ˆä»£ç çš„æ³¨é‡Šè¦†ç›–ç‡é«˜ï¼Œå¯è¯»æ€§ä¹Ÿè¾¾åˆ°äº†ç†æƒ³çŠ¶æ€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/470a0041b39b48ca9b8741cee313f1aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=vkVVta2onT0bAYyNF0z3lfG8MDU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ComateååŠ©å®Œæˆä»£ç çš„ä¼˜åŒ–ä¸é‡æ„</p>
<h3 data-id="heading-10">2.3 æ ·å¼ä¼˜åŒ–</h3>
<p>æœ€åï¼Œæˆ‘ä½¿ç”¨Comateä¼˜åŒ–äº†äº§å“æ ·å¼ï¼Œæœ€ç»ˆUIç”Ÿæˆæ•ˆæœç¾è§‚å¤§æ°”ï¼Œä¸Spineç•Œé¢çš„èåˆåº¦æé«˜ï¼Œæ•´ä½“äº¤äº’æµç¨‹æµç•…é¡ºæ»‘ï¼Œç”¨æˆ·æ“ä½œä½“éªŒå‡ºè‰²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d81049b82254e84829d283e06120645~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766633243&amp;x-signature=MiS3VBbg0hxIK86BiAmXbz38%2BEU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>Comateä¼˜åŒ–äº§å“æ ·å¼</p>
<h2 data-id="heading-11">3 å¿ƒå¾—æ„Ÿæ‚Ÿ</h2>
<p>ã€Šè¶£ç»˜åƒç´ å²›ã€‹æ˜¯ä¸€æ¬¾å„¿ç«¥ç»˜ç”»AIè¾…åŠ©å·¥å…·ï¼Œæˆ‘è§‰å¾—éœ€è¦æœ‰ä¸€ä¸ªAIå·¥å…·èƒ½æŒ‡å¯¼ç»˜ç”»å°ç™½å»åˆ›ä½œï¼Œè§£å†³â€œç”»ä»€ä¹ˆã€æ€ä¹ˆç”»ã€ç”»çš„æ€ä¹ˆæ ·ã€ç”»å®Œä¹‹åâ€å››ä¸ªé—®é¢˜ã€‚ç”¨Comateå¼€å‘æœ€è®©æˆ‘æƒŠè‰³çš„ï¼Œé™¤äº†é¢œå€¼åœ¨çº¿çš„UIï¼Œæ€§èƒ½ä¼˜åŒ–è¿™å—ç›´æ¥æˆ³ä¸­å¼€å‘è€…ç—›ç‚¹ï¼æˆ‘ç”¨å®ƒåŠ äº†å¾ˆå¤šä¹‹å‰è§‰å¾—å®ç°èµ·æ¥å¾ˆéš¾çš„åŠŸèƒ½ï¼Œå®Œå–„äº†é¡¹ç›®ã€‚</p>
<p>Comateè‡ªåŠ¨åšçš„ä»£ç ç²¾ç®€ã€å†—ä½™é€»è¾‘å‰”é™¤ï¼Œè¿˜æœ‰å…¬å…±å‡½æ•°æŠ½ç¦»ï¼Œç›´æ¥è®©é¡¹ç›®è·‘èµ·æ¥çš„æµç•…åº¦é£™å‡ã€‚ã€Šè¶£ç»˜åƒç´ å²›ã€‹æ˜¯éª¨éª¼åŠ¨ç”»é¡¹ç›®ï¼Œæˆ‘è‡ªå·±ä¹Ÿæ‰‹å†™äº†ä»£ç ï¼Œä½†æ˜¯è‡ªå·±çš„ä»£ç å­˜åœ¨ä¸å°‘é‡å¤è°ƒç”¨å’Œæ€§èƒ½ç“¶é¢ˆï¼Œç”¨Comateé‡æ„åï¼ŒåŠ¨ç”»æ¸²æŸ“çš„å¸§ç‡ç¨³äº†å¾ˆå¤šï¼Œäº¤äº’æ—¶çš„å¡é¡¿æ„Ÿç›´æ¥æ¶ˆå¤±ã€‚åŒ…æ‹¬åç»­åŠ ä¸€äº›åŠ¨ç”»ï¼Œè¿›è¡ŒåŠ¨ç”»è°ƒåº¦ï¼Œèƒ½å¸®æˆ‘è¯»å–åˆ†ænpmåŒ…ï¼Œç»™å‡ºå¯¹åº”çš„APIæ–¹æ³•ã€‚Comateå¸®æˆ‘æŠŠç”»æ¿çš„å«å›¾ã€æ’¤é”€å›é€€åšå¾—å¾ˆå¥½ï¼Œæˆ‘ç°åœ¨èƒ½è½»è½»æ¾æ¾æˆªå›¾ï¼Œç„¶ååˆ°å·¥å…·é¡µé¢ç›´æ¥Ctrl+Vè´´è¿›å»ï¼Œå°±å¯ä»¥ç›´æ¥ä¸´æ‘¹äº†ï¼Œä¹ŸæŠŠè´´çº¸çš„å¯¼å‡ºåŠ ä¸Šäº†ç›´æ¥ç²˜è´´åˆ°å‰ªè´´æ¿ï¼Œè¿™å—ç”¨æˆ·ä½“éªŒåº”è¯¥å¾ˆå¥½ã€‚</p>
<p>è€Œä¸”å®ƒç”Ÿæˆçš„ä»£ç æ³¨é‡Šè¶…å…¨ï¼Œå¯è¯»æ€§æ‹‰æ»¡ï¼Œåç»­ç»´æŠ¤èµ·æ¥å·¨çœå¿ƒã€‚æˆ‘è¿˜ç”¨å®ƒå®Œå…¨å†™äº†ä¸ªç¦»çº¿è®°è´¦APPï¼ŒçœŸæ˜¯ä¸€è¡Œä»£ç éƒ½æ²¡æœ‰å†™ï¼ŒåŠå¤©æå®šçš„åŒæ—¶ï¼Œè¿˜è‡ªå¸¦æ€§èƒ½ä¼˜åŒ–buffï¼Œå®Œå…¨ä¸ç”¨é¢å¤–èŠ±æ—¶é—´å»è°ƒä¼˜ï¼Œæ•ˆç‡ç›´æ¥ç¿»å€ï¼è¿™æ¬¡æ²¡è¯•figma2codeï¼Œå·²ç»å‡†å¤‡å¥½æ ‡å‡†UIï¼Œä¸‹æ¬¡ç›´æ¥å†²ï¼</p>
<p>ã€Šè¶£ç»˜åƒç´ å²›ã€‹è¿˜åœ¨æŒç»­è¿­ä»£ï¼Œæˆ‘æƒ³åŠ å…¥è¯¾ç¨‹åŠŸèƒ½ï¼Œç±»ä¼¼ä»»å¤©å ‚çš„ã€Šç»˜å¿ƒæ•™å®¤ã€‹ï¼Œè®©æ›´å¤šçš„å°æœ‹å‹å¯ä»¥äº«å—åˆ°ç»˜ç”»æ•™è‚²èµ„æºï¼Œå¯“æ•™äºä¹ã€ç©ä¸­å­¦ã€å­¦ä¸­åˆ›é€ ï¼Œæˆ‘ä¹Ÿä¼šç»§ç»­ç”¨Comateè¿›è¡Œåˆ›ä½œï¼Œå¸®æˆ‘è§£å†³éš¾é¢˜ï¼Œè®©çµæ„Ÿå¿«é€Ÿè½åœ°ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨è¿ç§»ä¸­å­¦ä¹  React 18ï¼šä¸€ä»½æ¥è‡ª React 17 çš„å‡çº§é—®é¢˜æ¸…å•]]></title>    <link>https://juejin.cn/post/7584742635502305307</link>    <guid>https://juejin.cn/post/7584742635502305307</guid>    <pubDate>2025-12-18T04:01:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584742635502305307" data-draft-id="7584725529876070450" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨è¿ç§»ä¸­å­¦ä¹  React 18ï¼šä¸€ä»½æ¥è‡ª React 17 çš„å‡çº§é—®é¢˜æ¸…å•"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2025-12-18T04:01:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•²ä»£ç çš„å½­äºæ™"/> <meta itemprop="url" content="https://juejin.cn/user/553809592465277"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨è¿ç§»ä¸­å­¦ä¹  React 18ï¼šä¸€ä»½æ¥è‡ª React 17 çš„å‡çº§é—®é¢˜æ¸…å•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/553809592465277/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•²ä»£ç çš„å½­äºæ™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T04:01:12.000Z" title="Thu Dec 18 2025 04:01:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘å¯¹å…¬å¸çš„é¡¹ç›®åšäº†ä»React17åˆ°React18çš„å‡çº§ï¼Œå‡çº§æ“ä½œè¿™é‡Œä¾¿ä¸å†ä»‹ç»ï¼Œå®˜æ–¹æ–‡æ¡£éƒ½æœ‰ã€‚æœ¬æ–‡è®°å½•ä¸‹å‡çº§åˆ°React18æœ‰å“ªäº›å˜åŠ¨ç‚¹ã€‚</p>
<h2 data-id="heading-1">TypeScriptç±»å‹å˜åŠ¨</h2>
<h3 data-id="heading-2">1. FC ä¸­ä¸å†æœ‰ children ç±»å‹</h3>
<p>åŸå…ˆï¼š</p>
<pre><code class="hljs language-js" lang="js">interface modalContentProps {
  id?: string;
  [<span class="hljs-attr">key</span>: string]: string | <span class="hljs-title class_">ReactNode</span>;
}
</code></pre>
<p>ç°åœ¨ï¼š</p>
<pre><code class="hljs language-js" lang="js">interface modalContentProps {
  id?: string;
  children?: <span class="hljs-title class_">ReactNode</span>; <span class="hljs-comment">//éœ€æ‰‹åŠ¨æŒ‡å®šchildren</span>
  [<span class="hljs-attr">key</span>: string]: string | <span class="hljs-title class_">ReactNode</span>;
}
</code></pre>
<h3 data-id="heading-3">2. FC ä¸­ä¸å†åŒ…å« ref çš„ç±»å‹å®šä¹‰</h3>
<p>åŸå…ˆï¼š</p>
<pre><code class="hljs language-js" lang="js">interface <span class="hljs-title class_">Props</span> {
  <span class="hljs-attr">ref</span>: <span class="hljs-title class_">ForwardedRef</span>&lt;any&gt;;
  <span class="hljs-attr">line</span>: number;
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Single</span>: <span class="hljs-variable constant_">FC</span>&lt;<span class="hljs-title class_">Props</span>&gt; = <span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">(<span class="hljs-params">{ line }, ref</span>) =&gt;</span> {})
</code></pre>
<p>ç°åœ¨ï¼š</p>
<pre><code class="hljs language-js" lang="js">interface <span class="hljs-title class_">Props</span> {
  <span class="hljs-attr">line</span>: number;
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Single</span> = forwardRef&lt;<span class="hljs-title class_">ForwardedRef</span>&lt;any&gt;, <span class="hljs-title class_">Props</span>&gt;(<span class="hljs-function">(<span class="hljs-params">{ line }, ref</span>) =&gt;</span> {});
</code></pre>
<h3 data-id="heading-4">3. React.Key æ–°å¢ bigint ç±»å‹</h3>
<p>åŸå…ˆReact.keyçš„ç±»å‹ä¸ºï¼š</p>
<pre><code class="hljs language-js" lang="js">string | number
</code></pre>
<p>ç°åœ¨ï¼š</p>
<pre><code class="hljs language-js" lang="js">string | number | bigint
</code></pre>
<h3 data-id="heading-5">4. ReactNode ç±»å‹ç§»é™¤äº†å¯¹ DOM Element çš„ç›´æ¥æ”¯æŒ</h3>
<p>åŸå…ˆï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// âœ… React 17 ä¸­ï¼ŒElement å¯ä»¥èµ‹å€¼ç»™ ReactNode</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">element</span>: <span class="hljs-title class_">Element</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-attr">reactNode</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span> = element; <span class="hljs-comment">// âœ… ç¼–è¯‘é€šè¿‡</span>
</code></pre>
<p>ç°åœ¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// âŒ React 18 ä¸­ï¼ŒElement ä¸èƒ½èµ‹å€¼ç»™ ReactNode</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">element</span>: <span class="hljs-title class_">Element</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-attr">reactNode</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span> = element; <span class="hljs-comment">// âŒ ç±»å‹é”™è¯¯</span>
</code></pre>
<h2 data-id="heading-6">è¡Œä¸ºå˜åŠ¨</h2>
<h3 data-id="heading-7">1. å¹¶å‘æ¨¡å¼ä¸åŒæ­¥æ¨¡å¼</h3>
<p>ä½¿ç”¨æ–°çš„API createRoot å¼€å¯å¹¶å‘æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom/client'</span>;

<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">createRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>)).<span class="hljs-title function_">render</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>);
</code></pre>
<p>åœ¨React 18ä¸­ï¼Œä¾æ—§å¯ä»¥ä½¿ç”¨åŒæ­¥æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;

<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>));
</code></pre>
<h3 data-id="heading-8">2. defaultPropså±æ€§ä¼šå‘Šè­¦æç¤º</h3>
<p>åŸå…ˆï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">SingleTagModal</span>.<span class="hljs-property">defaultProps</span> = {
  <span class="hljs-attr">title</span>: <span class="hljs-string">'æ ‡ç­¾'</span>,
};
</code></pre>
<p>ç°åœ¨ä½¿ç”¨é»˜è®¤å‚æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">SingleTagModal</span> = <span class="hljs-function">(<span class="hljs-params">{ title = <span class="hljs-string">'æ ‡ç­¾'</span> }</span>) =&gt;</span>{}
</code></pre>
<h3 data-id="heading-9">3. @testing-library/react-hookså¼ƒç”¨ï¼Œåˆå¹¶åˆ°@testing-library/react</h3>
<p>@testing-library/reactä»13ç‰ˆæœ¬å¼€å§‹æ”¯æŒReact18çš„å¹¶å‘æ¨¡å¼ï¼Œæ­¤æ—¶@testing-library/react-hooks çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆä¸»è¦æ˜¯ renderHookï¼‰å·²å†…ç½®åˆ°@testing-library/reactä»13ä¸­</p>
<p>åŸå…ˆï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { renderHook } <span class="hljs-keyword">from</span> <span class="hljs-string">'@testing-library/react-hooks'</span>
</code></pre>
<p>ç°åœ¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { renderHook } <span class="hljs-keyword">from</span> <span class="hljs-string">'@testing-library/react'</span>
</code></pre>
<h3 data-id="heading-10">4. è‡ªåŠ¨æ‰¹å¤„ç†</h3>
<p>React 17åŒæ­¥æ¨¡å¼ï¼šåœ¨Reactåˆæˆäº‹ä»¶ä¸­ï¼ŒsetState çš„æ›´æ–°ä¼šè¢«æ‰¹å¤„ç†ã€‚åœ¨JSåŸç”Ÿäº‹ä»¶ã€å®ä»»åŠ¡ã€å¾®ä»»åŠ¡çš„æƒ…å†µä¸‹ï¼ŒsetState çš„æ›´æ–°ä¸ä¼šè¢«æ‰¹å¤„ç†ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//åŒæ­¥æ¨¡å¼</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>);
  <span class="hljs-title function_">setFlag</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> !f);
  <span class="hljs-comment">// React ä¼šæ¸²æŸ“ä¸¤æ¬¡ï¼Œæ¯æ¬¡æ›´æ–°ä¸€ä¸ªçŠ¶æ€ï¼ˆæ²¡æœ‰æ‰¹å¤„ç†ï¼‰</span>
}, <span class="hljs-number">1000</span>);
</code></pre>
<p>React 18å¼€å¯å¹¶å‘æ¨¡å¼åï¼Œæ‰€æœ‰çš„æ›´æ–°éƒ½ä¼šè‡ªåŠ¨æ‰¹é‡å¤„ç†ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//å¹¶å‘æ¨¡å¼</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>);
  <span class="hljs-title function_">setFlag</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> !f);
  <span class="hljs-comment">// æœ€ç»ˆï¼ŒReact å°†ä»…ä¼šé‡æ–°æ¸²æŸ“ä¸€æ¬¡ï¼ˆæ‰¹å¤„ç†ï¼‰</span>
}, <span class="hljs-number">1000</span>);
</code></pre>
<p>ç¤ºä¾‹ï¼šæ¯”è¾ƒå¸¸ç”¨çš„ahooksçš„useRequestï¼Œå¸¸å¸¸åœ¨onSuccesså›è°ƒä¸­å¤„ç†è¯·æ±‚æˆåŠŸåçš„è¡Œä¸º</p>
<p>useRequestéƒ¨åˆ†æºä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è¯·æ±‚ä¹‹å‰ï¼Œå°†loadingç½®ä¸ºtrue</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>({
  <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span>,
  params,
  ...state,
});

<span class="hljs-comment">// å¤„ç†è¯·æ±‚</span>
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> servicePromise;

<span class="hljs-comment">//è¯·æ±‚ç»“æŸï¼Œå°†loadingç½®ä¸ºfalse</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>({
  <span class="hljs-attr">data</span>: res,
  <span class="hljs-attr">error</span>: <span class="hljs-literal">undefined</span>,
  <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
});

<span class="hljs-comment">//æ‰§è¡ŒonSuccess</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">onSuccess</span>?.(res, params);
</code></pre>
<p>awaitåé¢çš„ä»»åŠ¡ä¸ºå¾®ä»»åŠ¡ï¼Œå› æ­¤åŒæ­¥æ¨¡å¼ä¸å¹¶å‘æ¨¡å¼çš„æ‰§è¡Œç»“æœä¸ä¸€æ ·</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">import</span> { useRequest } <span class="hljs-keyword">from</span> <span class="hljs-string">'ahooks'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getData</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>);
    }, <span class="hljs-number">1000</span>);
  });
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">User</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [flag, setFlag] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> { loading } = <span class="hljs-title function_">useRequest</span>(getData, {
    <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">setCount</span>(count + <span class="hljs-number">1</span>);
      <span class="hljs-title function_">setFlag</span>(!flag);
    },
  });

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¸²æŸ“'</span>, count, flag, loading);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span> {loading ? 'loading' : count}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
}
</code></pre>
<p>åŒæ­¥æ¨¡å¼ä¸‹æ‰“å°ç»“æœï¼šloadingç½®ä¸ºfalseåï¼Œåˆåˆ†åˆ«æ¸²æŸ“äº†ä¸¤æ¬¡ï¼Œåˆ†åˆ«å°†countç½®ä¸º1å’Œflagç½®ä¸ºtrue</p>
<pre><code class="hljs language-js" lang="js">æ¸²æŸ“ <span class="hljs-number">0</span> <span class="hljs-literal">false</span> <span class="hljs-literal">true</span>
æ¸²æŸ“ <span class="hljs-number">0</span> <span class="hljs-literal">false</span> <span class="hljs-literal">true</span>
æ¸²æŸ“ <span class="hljs-number">0</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span>
æ¸²æŸ“ <span class="hljs-number">1</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span>
æ¸²æŸ“ <span class="hljs-number">1</span> <span class="hljs-literal">true</span> <span class="hljs-literal">false</span>
</code></pre>
<p>å¹¶å‘æ¨¡å¼ä¸‹æ‰“å°ç»“æœï¼šloadingç½®ä¸ºfalseï¼Œä¸countï¼Œflagçš„æ›´æ–°æ˜¯ä¸€èµ·çš„</p>
<pre><code class="hljs language-js" lang="js">æ¸²æŸ“ <span class="hljs-number">0</span> <span class="hljs-literal">false</span> <span class="hljs-literal">true</span>
æ¸²æŸ“ <span class="hljs-number">0</span> <span class="hljs-literal">false</span> <span class="hljs-literal">true</span>
æ¸²æŸ“ <span class="hljs-number">1</span> <span class="hljs-literal">true</span> <span class="hljs-literal">false</span>
</code></pre>
<p><strong><code>è‡ªåŠ¨æ‰¹å¤„ç†æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å˜åŠ¨ç‚¹ï¼Œå¾ˆå¤šå‡çº§ä¹‹åå¸¦æ¥çš„ä¸šåŠ¡bugï¼Œéƒ½æ˜¯è¯¥åŸå› å¯¼è‡´</code></strong></p>
<h3 data-id="heading-11">5. SuspenseÂ å†…çš„ç”Ÿå‘½å‘¨æœŸ</h3>
<p><strong>åœ¨å‡½æ•°ç»„ä»¶ä¸­çš„è¡¨ç°</strong></p>
<p>åŒæ­¥æ¨¡å¼ï¼šå½“ä¸€ä¸ªæ ‘é‡æ–°æŒ‚èµ·å¹¶æ¢å¤æ—¶ï¼Œä¸ä¼šè§¦å‘ä»»ä½•ç”Ÿå‘½å‘¨æœŸé’©å­</p>
<p>å¹¶å‘æ¨¡å¼ï¼šå½“ä¸€ä¸ªæ ‘é‡æ–°æŒ‚èµ·æ—¶ï¼Œè§¦å‘useLayoutEffectçš„cleanupï¼Œé‡æ–°æ¢å¤æ—¶ï¼Œè§¦å‘useLayoutEffect</p>
<p><strong>åœ¨ç±»ç»„ä»¶ä¸­çš„è¡¨ç°</strong></p>
<p>åŒæ­¥æ¨¡å¼ï¼šå½“ä¸€ä¸ªæ ‘é‡æ–°æŒ‚èµ·æ—¶ï¼Œä¸ä¼šè§¦å‘ä»»ä½•ç”Ÿå‘½å‘¨æœŸé’©å­ï¼›é‡æ–°æ¢å¤æ—¶ï¼Œè§¦å‘componentDidUpdate</p>
<p>å¹¶å‘æ¨¡å¼ï¼šå½“ä¸€ä¸ªæ ‘é‡æ–°æŒ‚èµ·æ—¶ï¼Œè§¦å‘componentWillUnmountï¼Œé‡æ–°æ¢å¤æ—¶ï¼Œè§¦å‘componentDidMount</p>
<p>å¯¹äºä½¿ç”¨<code>react-activation</code>å®ç°KeepAliveåŠŸèƒ½çš„é¡¹ç›®ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªç‰¹åˆ«é‡è¦çš„å˜åŠ¨ç‚¹ï¼Œ<code>react-activation</code>æœ¬è´¨æ˜¯å€ŸåŠ©Suspenseå®ç°ç»„ä»¶çš„å†»ç»“ã€‚åœ¨React 18çš„å¹¶å‘æ¨¡å¼ä¸‹ï¼Œè¯¥åº“æ˜¯æœ‰bugçš„ã€‚</p>
<p>å› ä¸ºcomponentWillUnmountè¢«è§¦å‘ï¼Œå¯¼è‡´å­KeepAliveç»„ä»¶è¢«è¯¯åˆ ï¼Œå¯é€šè¿‡è°ƒæ•´ç”Ÿå‘½å‘¨æœŸçš„æ–¹å¼è§£å†³è¯¥bugã€‚è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯useLayoutEffectè§¦å‘æœºåˆ¶è°ƒæ•´ï¼Œè€Œantd4çš„åŠ¨ç”»æ•ˆæœæ˜¯åœ¨useLayoutEffectè§¦å‘ï¼Œä¼šæœ‰æŠ–åŠ¨ç­‰bugçš„å‘ç”Ÿï¼Œå¯æ”¹å†™<code>rc-motion</code>åº“ã€‚</p>
<h2 data-id="heading-12">æ–°å¢çš„APIä¸Hook</h2>
<h3 data-id="heading-13">1. flushSync</h3>
<ol>
<li>é€€å‡ºæ‰¹é‡æ›´æ–°</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { flushSync } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> [count1, setCount1] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [count2, setCount2] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ›´æ–°'</span>)
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
        flushSync(() =&gt; {
          setCount1(count =&gt; count + 1);
        });
        // ç¬¬ä¸€æ¬¡æ›´æ–°
        flushSync(() =&gt; {
          setCount2(count =&gt; count + 1);
        });
        // ç¬¬äºŒæ¬¡æ›´æ–°
      }}
    &gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>count1ï¼š {count1}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>count2ï¼š {count2}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<p>æç¤ºï¼šflushSync å‡½æ•°å†…éƒ¨çš„å¤šä¸ª setState ä»ç„¶ä¸ºæ‰¹é‡æ›´æ–°ï¼Œè¿™æ ·å¯ä»¥ç²¾å‡†æ§åˆ¶å“ªäº›ä¸éœ€è¦çš„æ‰¹é‡æ›´æ–°ã€‚</p>
<ol start="2">
<li>flushSync ç¡®ä¿äº†åœ¨ä¸‹ä¸€è¡Œä»£ç è¿è¡Œæ—¶ï¼ŒReact å·²ç»æ›´æ–°äº† DOM</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> ref = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">onClick</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setCount</span>(<span class="hljs-function">(<span class="hljs-params">count</span>) =&gt;</span> count + <span class="hljs-number">1</span>);

   <span class="hljs-comment">//æ‰“å°å€¼ä¸º0ï¼Œå› ä¸ºæ­¤æ—¶DOMè¿˜æœªæ›´æ–°</span>
   <span class="hljs-comment">//å¦‚æœä½¿ç”¨flushSyncåŒ…è£¹setCountï¼Œæ‰“å°ç»“æœå°†å˜ä¸º1</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ref'</span>, ref.<span class="hljs-property">current</span>.<span class="hljs-property">innerHTML</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{ref}</span>&gt;</span>
      {count}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<p>å½“é‡åˆ°React17ä¸­æ²¡æœ‰ï¼Œä½†åœ¨18ä¸­å‡ºç°çš„éš¾ä»¥è§£å†³çš„é—®é¢˜æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨flushSyncï¼Œè€ŒésetTimeout</p>
<h3 data-id="heading-14">2. startTransition</h3>
<p>å¯ä»¥è®©ä½ åœ¨ä¸é˜»å¡ UI çš„æƒ…å†µä¸‹æ›´æ–° state</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { startTransition } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// ç´§æ€¥æ›´æ–°: æ˜¾ç¤ºè¾“å…¥çš„å†…å®¹</span>
<span class="hljs-title function_">setInputValue</span>(input);

<span class="hljs-comment">// å°†ä»»ä½•å†…éƒ¨çš„çŠ¶æ€æ›´æ–°éƒ½æ ‡è®°ä¸ºè¿‡æ¸¡æ›´æ–°</span>
<span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// è¿‡æ¸¡æ›´æ–°: å±•ç¤ºç»“æœ</span>
  <span class="hljs-title function_">setSearchQuery</span>(input);
});
</code></pre>
<h3 data-id="heading-15">3. useTransition</h3>
<p>å¯ä»¥è®©ä½ åœ¨ä¸é˜»å¡ UI çš„æƒ…å†µä¸‹æ›´æ–° stateï¼Œæ¯”startTransitionå¤šä¸ªPendingçŠ¶æ€</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> [ isPending , startTransition ] = useTransition ()
</code></pre>
<h3 data-id="heading-16">4. useDeferredValue</h3>
<p>è®©å¼€å‘è€…å»¶è¿Ÿæ›´æ–°UIçš„æŸäº›éƒ¨åˆ†ã€‚å¯ä»¥å»¶è¿Ÿæ¸²æŸ“ä¸ç´§æ€¥çš„éƒ¨åˆ†ï¼Œç±»ä¼¼äºé˜²æŠ–ä½†æ²¡æœ‰å›ºå®šçš„å»¶è¿Ÿæ—¶é—´ã€‚</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> [value, setValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> deferredValue = <span class="hljs-title function_">useDeferredValue</span>(value);
</code></pre>
<h3 data-id="heading-17">5. useId</h3>
<p>æ”¯æŒåŒä¸€ä¸ªç»„ä»¶åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç”Ÿæˆç›¸åŒçš„å”¯ä¸€çš„ IDï¼Œé¿å… hydration çš„ä¸å…¼å®¹</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> id = <span class="hljs-title function_">useId</span>()
</code></pre>
<h3 data-id="heading-18">6. useSyncExternalStore</h3>
<p>ç”¨äºè®¢é˜…å¤–éƒ¨æ•°æ®æºçš„å˜åŒ–ï¼Œå¹¶ç¡®ä¿Reactç»„ä»¶èƒ½å¤ŸåŒæ­¥åœ°å“åº”è¿™äº›å˜åŒ–ã€‚å¤§éƒ¨åˆ†æƒ…æ™¯æ˜¯ç”¨æ¥å¤„ç†Reduxã€MobXç­‰å¤–éƒ¨çŠ¶æ€ç®¡ç†åº“çš„æ•°æ®è®¢é˜…ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> snapshot = <span class="hljs-title function_">useSyncExternalStore</span>(subscribe, getSnapshot, getServerSnapshot?)
</code></pre>
<h3 data-id="heading-19">7. useInsertionEffect</h3>
<p>useInsertionEffectæ˜¯ä¸€ä¸ªä¸“ä¸ºCSS-in-JSåº“çš„å¼€å‘è€…æ‰“é€ çš„é’©å­ï¼Œæ¯”useLayoutEffectæ‰§è¡Œæ—¶æœºæ›´æ—©ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">useInsertionEffect</span>(setup, deps?)
</code></pre>
<h2 data-id="heading-20">ç»“å°¾</h2>
<p>å¦‚æœè¿˜æœ‰å…¶ä»–æ¯”è¾ƒé‡è¦çš„å˜åŠ¨ç‚¹ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼ï¼ï¼</p>
<p>å‚è€ƒæ–‡æ¡£ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzh-hans.react.dev%2Fblog%2F2022%2F03%2F29%2Freact-v18" target="_blank" title="https://zh-hans.react.dev/blog/2022/03/29/react-v18" ref="nofollow noopener noreferrer">zh-hans.react.dev/blog/2022/0â€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzh-hans.react.dev%2Fblog%2F2022%2F03%2F08%2Freact-18-upgrade-guide" target="_blank" title="https://zh-hans.react.dev/blog/2022/03/08/react-18-upgrade-guide" ref="nofollow noopener noreferrer">zh-hans.react.dev/blog/2022/0â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[echartsä¸­appendDataçš„è¯¦ç»†è®²è§£]]></title>    <link>https://juejin.cn/post/7584702863688957967</link>    <guid>https://juejin.cn/post/7584702863688957967</guid>    <pubDate>2025-12-18T01:09:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584702863688957967" data-draft-id="7584689488770547747" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="echartsä¸­appendDataçš„è¯¦ç»†è®²è§£"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-12-18T01:09:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘çš„divä¸¢äº†è‚¿ä¹ˆåŠ"/> <meta itemprop="url" content="https://juejin.cn/user/1310273593440398"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            echartsä¸­appendDataçš„è¯¦ç»†è®²è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1310273593440398/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘çš„divä¸¢äº†è‚¿ä¹ˆåŠ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T01:09:00.000Z" title="Thu Dec 18 2025 01:09:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">appendData çš„è¯´æ˜</h4>
<p>appendData æ¥å£æä¾›äº†åˆ†ç‰‡åŠ è½½åï¼Œå¢é‡æ¸²æŸ“çš„èƒ½åŠ›ã€‚<br/>
appendDataåœ¨å¤§æ•°æ®é‡(å¦‚ï¼šç™¾ä¸‡ä»¥ä¸Š)çš„æ¸²æŸ“åœºæ™¯ï¼Œåˆ†ç‰‡åŠ è½½æ•°æ®å’Œå¢é‡æ¸²æŸ“ã€‚<br/>
åœ¨å¤§æ•°æ®é‡çš„åœºæ™¯ä¸‹ï¼ˆä¾‹å¦‚åœ°ç†æ•°çš„æ‰“ç‚¹ï¼‰ï¼Œå°±ç®—æ•°æ®ä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼ã€‚<br/>
ä¹Ÿä¼šæœ‰å‡ åæˆ–ä¸Šç™¾å…†ï¼Œåœ¨äº’è”ç½‘ç¯å¢ƒä¸‹ï¼Œå¾€å¾€éœ€è¦åˆ†ç‰‡åŠ è½½ã€‚</p>
<p>æ¸²æŸ“æ–°åŠ å…¥çš„æ•°æ®å—æ—¶ä¸ä¼šæ¸…é™¤åŸæœ‰å·²ç»æ¸²æŸ“çš„éƒ¨åˆ†ã€‚<br/>
ä¸Šé¢è¿™ä¸€æ®µè¯ï¼Œæ˜¯echartså®˜ç½‘ä¸­å¯¹appendDataçš„æè¿°ã€‚<br/>
æ–‡å­—åœ°å€è¯´æ˜ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fecharts.apache.org%2Fzh%2Fapi.html%23echartsInstance.appendData" target="_blank" title="https://echarts.apache.org/zh/api.html#echartsInstance.appendData" ref="nofollow noopener noreferrer">echarts.apache.org/zh/api.htmlâ€¦</a></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<br/>
ç°åœ¨ä¸æ”¯æŒç³»åˆ—ï¼ˆseriesï¼‰ ä½¿ç”¨ dataset åŒæ—¶ä½¿ç”¨ appendDataã€‚<br/>
åªæ”¯æŒç³»åˆ—ä½¿ç”¨è‡ªå·±çš„ series.data æ—¶ä½¿ç”¨ appendDataã€‚</p>
<p>ç›®å‰å¹¶éæ‰€æœ‰çš„å›¾è¡¨éƒ½æ”¯æŒåˆ†ç‰‡åŠ è½½æ—¶çš„å¢é‡æ¸²æŸ“ã€‚ã€é‡è¦ã€‘<br/>
ç›®å‰æ”¯æŒçš„å›¾æœ‰ï¼šECharts åŸºç¡€ç‰ˆæœ¬çš„ æ•£ç‚¹å›¾ï¼ˆscatterï¼‰ å’Œ çº¿å›¾ï¼ˆlinesï¼‰ã€‚<br/>
ECharts GL çš„ æ•£ç‚¹å›¾ï¼ˆscatterGLï¼‰ã€çº¿å›¾ï¼ˆlinesGLï¼‰ å’Œ å¯è§†åŒ–å»ºç­‘ç¾¤ï¼ˆpolygons3Dï¼‰ã€‚<br/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83b57af0459a46b0925bb05843a1e448~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qEZGl25Lii5LqG6IK_5LmI5Yqe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624940&amp;x-signature=yyXNxJDH8BhjD8FFBeaS03oNPeg%3D" alt="image" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e9d768628184c06a454f4cf4ffa8e00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qEZGl25Lii5LqG6IK_5LmI5Yqe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624940&amp;x-signature=JY2nCVe8vLPteY1OH29uIYyBuwY%3D" alt="image" loading="lazy"/></p>
<h4 data-id="heading-1">appendData çš„è¯­æ³•</h4>
<pre><code class="hljs language-typescript" lang="typescript">chart.<span class="hljs-title function_">appendData</span>({
  seriesIndex?: <span class="hljs-built_in">number</span>, <span class="hljs-comment">// å¿…é¡»æ˜¯å·²å­˜åœ¨çš„ç³»åˆ—ç´¢å¼•ï¼Œè¯´æ˜ï¼šä¸èƒ½å¤Ÿæ·»åŠ æ–°çš„æŠ˜çº¿ã€‚</span>
  <span class="hljs-comment">// å¢åŠ çš„æ•°æ®ã€‚</span>
  data?: <span class="hljs-title class_">Array</span>|<span class="hljs-title class_">TypedArray</span> <span class="hljs-comment">// è¦è¿½åŠ çš„æ•°æ®ç‚¹</span>
})
</code></pre>
<h4 data-id="heading-2">é€šè¿‡ä¸Šé¢çš„è¯­æ³•è¯´æ˜ä¸€ä¸ªé—®é¢˜(appendDataÂ ä¸èƒ½æ–°å¢ä¸€æ¡çº¿)</h4>
<p>appendDataÂ æ–¹æ³•åªèƒ½ç”¨äºå‘å·²å­˜åœ¨çš„æ•°æ®ç³»åˆ—è¿½åŠ æ•°æ®ç‚¹ï¼Œè€Œä¸èƒ½æ·»åŠ æ–°çš„æ•°æ®ç³»åˆ—ï¼ˆå³æ–°çš„çº¿æ¡ï¼‰ã€‚<br/>
ä¹Ÿå°±æ˜¯è¯´ï¼šappendDataÂ ä¸èƒ½æ–°å¢ä¸€æ¡çº¿ã€‚<br/>
åŸå› ï¼šæ ¹æ®è¿™ä¸ªæ–¹æ³•çš„å‚æ•°å¯ä»¥æ¨æ–­é™¤ä¸èƒ½å¤Ÿæ–°å¢1æ¡æŠ˜çº¿ã€‚åŸå› å¦‚ä¸‹ï¼š<br/>
appendDataÂ æ–¹æ³•ç”¨äºå‘å›¾è¡¨ä¸­è¿½åŠ æ•°æ®ï¼Œå®ƒæ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œ<br/>
è¯¥å¯¹è±¡åŒ…å«Â seriesIndexÂ å’ŒÂ dataÂ ä¸¤ä¸ªå±æ€§ã€‚
seriesIndex: number, // å¿…é¡»æ˜¯å·²å­˜åœ¨çš„ç³»åˆ—ç´¢å¼•</p>
<h4 data-id="heading-3">appendData çš„ç‰¹åˆ«è¯´æ˜</h4>
<p>appendData æ–¹æ³•ä¸ä¼šè‡ªåŠ¨æ›´æ–°xè½´ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ›´æ–°xè½´çš„æ•°æ®ã€‚<br/>
æ‰€ä»¥ï¼šå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨ appendData è·Ÿæ–°æŠ˜çº¿å›¾,æŸ±çŠ¶å›¾çš„æ•°æ®ã€‚<br/>
å¿…é¡»è¦é…åˆï¼šsetOption æ¥è·Ÿæ–° xè½´ã€‚<br/>
çœ‹åˆ°è¿™é‡Œæ˜¯æ˜¯ä¸æ˜¯æ„Ÿè§‰åˆ°å¾ˆæ‰¯~~~~~<br/>
å…¶å®å¹¶ä¸æ‰¯ï¼ŒappendData å°±ä¸èƒ½ç”¨åœ¨ series ç³»åˆ—çš„å›¾è¡¨ä¸­ã€‚<br/>
ç½‘ä¸Šå…¶ä»–æ–‡ç« ä½¿ç”¨ appendData è·Ÿæ–°æŠ˜çº¿å›¾ï¼ŒæŸ±çŠ¶å›¾çš„ï¼Œä¸€å®šä¹Ÿä½¿ç”¨äº† setOption æ¥è·Ÿæ–° xè½´ã€‚<br/>
é‚£æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œæˆ‘éƒ½ä½¿ç”¨äº† setOption æ¥æ›´æ–°Xè½´ï¼Œä¸ºå•¥è¿˜è¦å¤šä½¿ç”¨ appendData å‘¢?<br/>
å› æ­¤ï¼šappendDataä¸èƒ½ç”¨åœ¨æŠ˜çº¿å›¾ï¼ŒæŸ±çŠ¶å›¾ä¸­ã€‚</p>
<h4 data-id="heading-4">æŠ˜çº¿å›¾å•ç‹¬ä½¿ç”¨ appendData ä¼šå¼•å‘é”™è¯¯ Uncaught TypeError: Cannot read properties of undefined (reading '0')</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"startStream"</span>&gt;</span>å¼€å§‹è¿½åŠ æ•°æ®<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"chart"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%; height: 400px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">'echarts'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'RealtimeLineChart'</span>,
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">myChart</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">xAxisData</span>: [<span class="hljs-string">"20:23:01"</span>, <span class="hljs-string">"20:23:02"</span>, <span class="hljs-string">"20:23:03"</span>, <span class="hljs-string">"20:23:04"</span>,<span class="hljs-string">"20:23:05"</span>],
      <span class="hljs-attr">seriesData</span>: [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>]
    };
  },
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initChart</span>();
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-comment">// åˆå§‹åŒ–å›¾è¡¨</span>
    <span class="hljs-title function_">initChart</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'xAxisData'</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">xAxisData</span>)
      <span class="hljs-comment">// ç¡®ä¿DOMå…ƒç´ å·²æ¸²æŸ“</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span> = echarts.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">chart</span>);
        <span class="hljs-keyword">const</span> option = {
          <span class="hljs-attr">title</span>: {
            <span class="hljs-attr">text</span>: <span class="hljs-string">'å®æ—¶æ•°æ®ç›‘æ§'</span>,
            <span class="hljs-attr">left</span>: <span class="hljs-string">'center'</span>
          },
          <span class="hljs-attr">tooltip</span>: {
            <span class="hljs-attr">trigger</span>: <span class="hljs-string">'axis'</span>,
            <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> {
              <span class="hljs-keyword">return</span> <span class="hljs-string">`æ—¶é—´: <span class="hljs-subst">${params[<span class="hljs-number">0</span>].name}</span>&lt;br/&gt;å€¼: <span class="hljs-subst">${params[<span class="hljs-number">0</span>].value}</span>`</span>;
            }
          },
          <span class="hljs-attr">xAxis</span>: {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'category'</span>,
            <span class="hljs-attr">boundaryGap</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-comment">// xAxisData è¡¨ç¤º Xè½´çš„æ•°æ®å€¼</span>
            <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">xAxisData</span>
          },
          <span class="hljs-attr">yAxis</span>: {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'value'</span>,
            <span class="hljs-attr">scale</span>: <span class="hljs-literal">true</span>
          },
          <span class="hljs-attr">series</span>: [{
            <span class="hljs-attr">name</span>: <span class="hljs-string">'æ•°æ®å€¼'</span>,
            <span class="hljs-attr">type</span>: <span class="hljs-string">'line'</span>,
            <span class="hljs-attr">smooth</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">itemStyle</span>: {
              <span class="hljs-attr">color</span>: <span class="hljs-string">'#1890ff'</span>
            },
            <span class="hljs-attr">areaStyle</span>: {
              <span class="hljs-attr">color</span>: <span class="hljs-keyword">new</span> echarts.<span class="hljs-property">graphic</span>.<span class="hljs-title class_">LinearGradient</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, [
                { <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#1890ff'</span> },
                { <span class="hljs-attr">offset</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(24, 144, 255, 0.1)'</span> }
              ])
            },
            <span class="hljs-comment">// Yè½´å¯¹äºçš„æ•°æ®</span>
            <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">seriesData</span>
          }],
          <span class="hljs-attr">grid</span>: {
            <span class="hljs-attr">left</span>: <span class="hljs-string">'3%'</span>,
            <span class="hljs-attr">right</span>: <span class="hljs-string">'4%'</span>,
            <span class="hljs-attr">bottom</span>: <span class="hljs-string">'3%'</span>,
            <span class="hljs-attr">containLabel</span>: <span class="hljs-literal">true</span>
          }
        };
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">setOption</span>(option);
    },
    <span class="hljs-comment">// å¯åŠ¨å®æ—¶æ•°æ®æµ</span>
    <span class="hljs-title function_">startStream</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span>(!<span class="hljs-variable language_">this</span>.<span class="hljs-property">xAxisData</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"20:23:06"</span>)){
        <span class="hljs-comment">// å‘Xè½´æ·»åŠ æ•°æ®</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">xAxisData</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">"20:23:06"</span>)
        <span class="hljs-comment">// æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼šå‘Yè½´è¿½åŠ æ•°æ®</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">appendData</span>({
          <span class="hljs-attr">seriesIndex</span>: <span class="hljs-number">0</span>,
          <span class="hljs-attr">data</span>: [<span class="hljs-number">1000</span>]
        });
      }
    }
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9ccdbf53f394df78b983771112847c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qEZGl25Lii5LqG6IK_5LmI5Yqe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624940&amp;x-signature=b9cidmxG4NDm7f4OEzFl2%2BOLpBM%3D" alt="image" loading="lazy"/></p>
<h4 data-id="heading-5">appendData æ›´æ–°Yè½´æ•°æ®ï¼ŒsetOptionæ¥è·Ÿæ–°Xè½´</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">... å•ç‹¬ä½¿ç”¨ appendData ä¼šå¼•å‘é”™è¯¯ Uncaught TypeError: Cannot read properties of undefined (reading <span class="hljs-string">'0'</span>)...
... å…¶ä»–ä»£ç ä¸å˜ ...
  methods: {
    <span class="hljs-comment">// å¯åŠ¨å®æ—¶æ•°æ®æµ</span>
    startStream() {
      <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.xAxisData.includes(<span class="hljs-string">"20:23:06"</span>)){
        <span class="hljs-comment">// å‘Xè½´æ·»åŠ æ•°æ®</span>
        <span class="hljs-keyword">this</span>.xAxisData.push(<span class="hljs-string">"20:23:06"</span>)
        <span class="hljs-comment">// æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼šå‘Yè½´è¿½åŠ æ•°æ®ã€‚appendDataåªèƒ½è·Ÿæ–°Yè½´æ•°æ®ã€‚</span>
        <span class="hljs-keyword">this</span>.myChart.appendData({
          seriesIndex: <span class="hljs-number">0</span>,
          <span class="hljs-keyword">data</span>: [<span class="hljs-number">1000</span>]
        });

        <span class="hljs-comment">// æ›´æ–°Xè½´æ•°æ®</span>
        <span class="hljs-keyword">this</span>.myChart.setOption({
          xAxis: {
            <span class="hljs-keyword">data</span>: <span class="hljs-keyword">this</span>.xAxisData
          }
        });
      }
    }
  }
&lt;/script&gt;
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29cf7cb22f6e4f3f8e3f5aaf4550164a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qEZGl25Lii5LqG6IK_5LmI5Yqe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624940&amp;x-signature=3F3ay%2BG%2Fr%2Bn1%2FxuYkRJH2fhLXvo%3D" alt="image" loading="lazy"/></p>
<h4 data-id="heading-6">[xè½´çš„æ•°ï¼Œyè½´æ•°æ®]è¿™æ ·å½¢å¼çš„æ•°æ®appendDataå¯ä»¥æ›´æ–°å˜›?</h4>
<p>æœ‰æœºæ™ºçš„å°ä¼™ä¼´ä¼šè¯´ï¼šappendData æ–¹æ³•ä¸ä¼šè‡ªåŠ¨æ›´æ–°xè½´ã€‚<br/>
é‚£ä¹ˆå¦‚æœæˆ‘ä»¬çš„æ•°æ®æ˜¯ä¸‹é¢è¿™ç§å½¢å¼ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">seriesData:  [ </span>
  [ <span class="hljs-string">"2023-12-04 09:50:07"</span>, <span class="hljs-string">"0.137"</span>],
  ................................,
  [ <span class="hljs-string">"2023-12-04 10:50:07"</span>, <span class="hljs-string">"0.143"</span>],
  ]
</code></pre>
<p>æ˜¯ä¸æ˜¯å°±å¯ä»¥ä½¿ç”¨appendData è·Ÿæ–°æŠ˜çº¿å›¾çš„æ•°æ®äº†ï¼Ÿ
ç­”æ¡ˆæ˜¯ï¼šä¸å¯ä»¥ã€‚ä¸‹é¢æˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸‹</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"startStream"</span>&gt;</span>å¼€å§‹è¿½åŠ æ•°æ®<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"chart"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%; height: 400px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">'echarts'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'RealtimeLineChart'</span>,
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">myChart</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">seriesData</span>:  [ 
        [ <span class="hljs-string">"2023-12-04 09:50:07"</span>, <span class="hljs-string">"0.137"</span>],
        [ <span class="hljs-string">"2023-12-04 09:55:07"</span>, <span class="hljs-string">"0.147"</span>],
        [ <span class="hljs-string">"2023-12-04 10:00:07"</span>, <span class="hljs-string">"0.137"</span>],
        [ <span class="hljs-string">"2023-12-04 10:05:07"</span>, <span class="hljs-string">"0.163"</span>],
        [ <span class="hljs-string">"2023-12-04 10:10:07"</span>, <span class="hljs-string">"0.150"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:15:07"</span>, <span class="hljs-string">"0.143"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:20:07"</span>, <span class="hljs-string">"0.133"</span>],
        [ <span class="hljs-string">"2023-12-04 10:25:07"</span>, <span class="hljs-string">"0.147"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:30:07"</span>, <span class="hljs-string">"0.147"</span>],
        [ <span class="hljs-string">"2023-12-04 10:35:07"</span>, <span class="hljs-string">"0.143"</span>],
        [ <span class="hljs-string">"2023-12-04 10:40:07"</span>, <span class="hljs-string">"0.140"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:45:07"</span>, <span class="hljs-string">"0.150"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:50:07"</span>, <span class="hljs-string">"0.143"</span>],
      ]
    };
  },
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initChart</span>();
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-comment">// åˆå§‹åŒ–å›¾è¡¨</span>
    <span class="hljs-title function_">initChart</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// ç¡®ä¿DOMå…ƒç´ å·²æ¸²æŸ“</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span> = echarts.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">chart</span>);
      <span class="hljs-keyword">const</span> option = {
        <span class="hljs-attr">title</span>: {
          <span class="hljs-attr">text</span>: <span class="hljs-string">'å®æ—¶æ•°æ®ç›‘æ§'</span>,
          <span class="hljs-attr">left</span>: <span class="hljs-string">'center'</span>
        },
        <span class="hljs-attr">tooltip</span>: {
          <span class="hljs-attr">trigger</span>: <span class="hljs-string">'axis'</span>,
        },
        <span class="hljs-attr">xAxis</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'category'</span>,
          <span class="hljs-attr">boundaryGap</span>: <span class="hljs-literal">false</span>,
        },
        <span class="hljs-attr">yAxis</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'value'</span>,
          <span class="hljs-attr">scale</span>: <span class="hljs-literal">true</span>
        },
        <span class="hljs-attr">series</span>: [{
          <span class="hljs-attr">name</span>: <span class="hljs-string">'æ•°æ®å€¼'</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">'line'</span>,
          <span class="hljs-attr">smooth</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">itemStyle</span>: {
            <span class="hljs-attr">color</span>: <span class="hljs-string">'#1890ff'</span>
          },
          <span class="hljs-attr">areaStyle</span>: {
            <span class="hljs-attr">color</span>: <span class="hljs-keyword">new</span> echarts.<span class="hljs-property">graphic</span>.<span class="hljs-title class_">LinearGradient</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, [
              { <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#1890ff'</span> },
              { <span class="hljs-attr">offset</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(24, 144, 255, 0.1)'</span> }
            ])
          },
          <span class="hljs-comment">// Yè½´å¯¹äºçš„æ•°æ®</span>
          <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">seriesData</span>
        }],
        <span class="hljs-attr">grid</span>: {
          <span class="hljs-attr">left</span>: <span class="hljs-string">'3%'</span>,
          <span class="hljs-attr">right</span>: <span class="hljs-string">'4%'</span>,
          <span class="hljs-attr">bottom</span>: <span class="hljs-string">'3%'</span>,
          <span class="hljs-attr">containLabel</span>: <span class="hljs-literal">true</span>
        }
      };
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">setOption</span>(option);
    },
    <span class="hljs-comment">// å¯åŠ¨å®æ—¶æ•°æ®æµ,ä½¿ç”¨appendDataæ›´æ–°æ•°æ®ä¼šæŠ¥é”™çš„å“ˆ</span>
    <span class="hljs-title function_">startStream</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">appendData</span>({
        <span class="hljs-attr">seriesIndex</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">data</span>: [<span class="hljs-string">"2023-12-04 10:55:07"</span>, <span class="hljs-string">"14.3"</span>]
      });
    },
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65a40697144246829fcb52dbe254f459~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qEZGl25Lii5LqG6IK_5LmI5Yqe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624940&amp;x-signature=6PKGV1AinD0KyCu%2B4O7phFCYkJU%3D" alt="image" loading="lazy"/></p>
<h4 data-id="heading-7">æŠ˜çº¿å›¾è¿½åŠ æ•°æ®ä½¿ç”¨ setOption</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"startStream"</span>&gt;</span>å¼€å§‹è¿½åŠ æ•°æ®<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"chart"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%; height: 400px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">'echarts'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'RealtimeLineChart'</span>,
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">myChart</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">seriesData</span>:  [ 
        [ <span class="hljs-string">"2023-12-04 09:50:07"</span>, <span class="hljs-string">"0.137"</span>],
        [ <span class="hljs-string">"2023-12-04 09:55:07"</span>, <span class="hljs-string">"0.147"</span>],
        [ <span class="hljs-string">"2023-12-04 10:00:07"</span>, <span class="hljs-string">"0.137"</span>],
        [ <span class="hljs-string">"2023-12-04 10:05:07"</span>, <span class="hljs-string">"0.163"</span>],
        [ <span class="hljs-string">"2023-12-04 10:10:07"</span>, <span class="hljs-string">"0.150"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:15:07"</span>, <span class="hljs-string">"0.143"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:20:07"</span>, <span class="hljs-string">"0.133"</span>],
        [ <span class="hljs-string">"2023-12-04 10:25:07"</span>, <span class="hljs-string">"0.147"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:30:07"</span>, <span class="hljs-string">"0.147"</span>],
        [ <span class="hljs-string">"2023-12-04 10:35:07"</span>, <span class="hljs-string">"0.143"</span>],
        [ <span class="hljs-string">"2023-12-04 10:40:07"</span>, <span class="hljs-string">"0.140"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:45:07"</span>, <span class="hljs-string">"0.150"</span>], 
        [ <span class="hljs-string">"2023-12-04 10:50:07"</span>, <span class="hljs-string">"0.143"</span>],
      ]
    };
  },
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initChart</span>();
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-comment">// åˆå§‹åŒ–å›¾è¡¨</span>
    <span class="hljs-title function_">initChart</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// ç¡®ä¿DOMå…ƒç´ å·²æ¸²æŸ“</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span> = echarts.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">chart</span>);
      <span class="hljs-keyword">const</span> option = {
        <span class="hljs-attr">title</span>: {
          <span class="hljs-attr">text</span>: <span class="hljs-string">'å®æ—¶æ•°æ®ç›‘æ§'</span>,
          <span class="hljs-attr">left</span>: <span class="hljs-string">'center'</span>
        },
        <span class="hljs-attr">tooltip</span>: {
          <span class="hljs-attr">trigger</span>: <span class="hljs-string">'axis'</span>,
        },
        <span class="hljs-attr">xAxis</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'category'</span>,
          <span class="hljs-attr">boundaryGap</span>: <span class="hljs-literal">false</span>,
        },
        <span class="hljs-attr">yAxis</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'value'</span>,
          <span class="hljs-attr">scale</span>: <span class="hljs-literal">true</span>
        },
        <span class="hljs-attr">series</span>: [{
          <span class="hljs-attr">name</span>: <span class="hljs-string">'æ•°æ®å€¼'</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">'line'</span>,
          <span class="hljs-attr">smooth</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">itemStyle</span>: {
            <span class="hljs-attr">color</span>: <span class="hljs-string">'#1890ff'</span>
          },
          <span class="hljs-attr">areaStyle</span>: {
            <span class="hljs-attr">color</span>: <span class="hljs-keyword">new</span> echarts.<span class="hljs-property">graphic</span>.<span class="hljs-title class_">LinearGradient</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, [
              { <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#1890ff'</span> },
              { <span class="hljs-attr">offset</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(24, 144, 255, 0.1)'</span> }
            ])
          },
          <span class="hljs-comment">// Yè½´å¯¹äºçš„æ•°æ®</span>
          <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">seriesData</span>
        }],
        <span class="hljs-attr">grid</span>: {
          <span class="hljs-attr">left</span>: <span class="hljs-string">'3%'</span>,
          <span class="hljs-attr">right</span>: <span class="hljs-string">'4%'</span>,
          <span class="hljs-attr">bottom</span>: <span class="hljs-string">'3%'</span>,
          <span class="hljs-attr">containLabel</span>: <span class="hljs-literal">true</span>
        }
      };
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">setOption</span>(option);
    },
    <span class="hljs-comment">// å¯åŠ¨å®æ—¶æ•°æ®æµ,ä½¿ç”¨ setOption æ›´æ–°æ•°æ®</span>
    <span class="hljs-title function_">startStream</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">seriesData</span>.<span class="hljs-title function_">push</span>([<span class="hljs-string">"2023-12-04 10:55:07"</span>, <span class="hljs-string">"0.19"</span>]);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">setOption</span>({
        <span class="hljs-attr">series</span>:[{
          <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">seriesData</span>
        }]
      });
    },
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19d9531b145f4b988a683649754913cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qEZGl25Lii5LqG6IK_5LmI5Yqe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624940&amp;x-signature=x4gt0Pnz4P19yK5Cy4cOEGbfwA8%3D" alt="image" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vben Adminç®¡ç†ç³»ç»Ÿé›†æˆqiankunå¾®æœåŠ¡]]></title>    <link>https://juejin.cn/post/7584719268043391010</link>    <guid>https://juejin.cn/post/7584719268043391010</guid>    <pubDate>2025-12-18T01:41:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584719268043391010" data-draft-id="7584408254819254307" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vben Adminç®¡ç†ç³»ç»Ÿé›†æˆqiankunå¾®æœåŠ¡"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-12-18T01:41:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="go_caipu"/> <meta itemprop="url" content="https://juejin.cn/user/4353721778049864"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vben Adminç®¡ç†ç³»ç»Ÿé›†æˆqiankunå¾®æœåŠ¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721778049864/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    go_caipu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T01:41:33.000Z" title="Thu Dec 18 2025 01:41:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fa66c7e104947cba2a6199d9ff4d068~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29fY2FpcHU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766626892&amp;x-signature=H7H4FwL2VxW5ukRIPjeV6gjJ9z8%3D" alt="image.png" loading="lazy"/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.vben.pro%2F" target="_blank" title="https://doc.vben.pro/" ref="nofollow noopener noreferrer">Vben Admin</a>æ˜¯ä¸€ä¸ªä¼˜ç§€çš„ä¼ä¸šçº§ç®¡ç†ç³»ç»Ÿæ¡†æ¶ï¼Œæˆ‘ä»¬æ­£åœ¨è¿›è¡Œä¸šåŠ¡é€‚é…ï¼Œè®¡åˆ’æŠŠå„ä¸šåŠ¡åŠŸèƒ½é€šè¿‡å‰ç«¯å¾®æœåŠ¡æ–¹å¼é›†æˆåˆ°ä¸»ç³»ç»Ÿé‡Œï¼Œç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°å¯å‚è€ƒçš„æ¡ˆä¾‹ï¼Œæ‰€ä»¥è‡ªè¡Œå°è¯•å®ç°åˆæ­¥demoï¼Œä¸­é—´é‡åˆ°è¾ƒå¤šçš„é—®é¢˜è®°å½•ä¸‹é›†æˆè¿‡ç¨‹ï¼Œä»¥å¤‡åç»­å‚è€ƒä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-1">ç¯å¢ƒå‡†å¤‡</h3>
<p>ä¸ºäº†å¿«é€ŸéªŒè¯æˆ‘ä»¬ä»å®˜ç½‘åœ°å€æ‹‰å–ä¸€ä¸ªå…¨æ–°çš„é¡¹ç›®è¿›è¡Œæ“ä½œï¼Œå‡å°‘ä¸­é—´å…¶ä»–å½±å“çš„å› ç´ ã€‚</p>
<h4 data-id="heading-2">è·å–æºç å¹¶è¿è¡Œä¸»åº”ç”¨web-antd</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># clone ä»£ç </span>
git clone https://github.com/vbenjs/vue-vben-admin.git

<span class="hljs-section"># å®‰è£…ä¾èµ–</span>
pnpm i 
<span class="hljs-section"># æµ‹è¯•å¯åŠ¨ä¸€ä¸ªåº”ç”¨</span>
pnpm dev:antd
å‡ºç°å¦‚ä¸‹ï¼Œè¡¨æ˜å¯åŠ¨æˆåŠŸ
<span class="hljs-strong">**VITE**</span> v7.2.2Â  ready in <span class="hljs-strong">**3291**</span> ms
Â  âœÂ  <span class="hljs-strong">**Local**</span>: Â  http://localhost:<span class="hljs-strong">**5666**</span>/Â  Â  Â  Â   17:46:35
Â  âœÂ  <span class="hljs-strong">**Network**</span>: http://192.168.70.22:<span class="hljs-strong">**5666**</span>/Â Â  17:46:35
Â  âœÂ  <span class="hljs-strong">**Vben Admin Docs**</span>: https://doc.vben.proÂ  Â   Â  17:46:35
Â  âœÂ  <span class="hljs-strong">**Nitro Mock Server**</span>: http://localhost:5320/api 17:46:35
Â  âœÂ  press <span class="hljs-strong">**h + enter**</span> to show help Â  Â  Â  Â  Â  Â  Â  Â  
âœ” <span class="hljs-strong">**Nitro Mock Server started.**</span>
</code></pre>
<p>ç°åœ¨å·²ç»èƒ½æ­£å¸¸è¿è¡Œç¨‹åºã€‚</p>
<h4 data-id="heading-3">å¯åŠ¨å­åº”ç”¨</h4>
<p>æ¡†æ¶åœ¨appsç›®å½•æä¾›å‡ ä¸ªä¸åŒç»„ä»¶é¡¹ç›®ï¼Œæˆ‘ä»¬è¿™æ¬¡é€‰æ‹©web-antdä½œä¸ºä¸»åº”ç”¨ï¼Œå°†web-antdå¤åˆ¶ä¸€ä¸ªæ–‡ä»¶å¤¹web-antd-childä½œä¸ºå­åº”ç”¨çš„æ–¹å¼è¿›è¡Œé›†æˆï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> apps
<span class="hljs-comment"># æ‹·è´ç”Ÿæˆå­åº”ç”¨æ–‡ä»¶å¤¹ web-antd-child</span>
<span class="hljs-built_in">cp</span> -r web-antd web-antd-child
<span class="hljs-built_in">cd</span> web-antd-child
<span class="hljs-comment"># å®‰è£…å­åº”ç”¨ä¾èµ–</span>
pnpm i
<span class="hljs-comment"># å¯åŠ¨</span>
pnpm dev
</code></pre>
<h3 data-id="heading-4">ä¸»æ¡†æ¶é›†æˆ</h3>
<h4 data-id="heading-5">æ·»åŠ qiankunæ–‡ä»¶</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">è½¬åˆ°ä¸»æ¡†æ¶ç›®å½•</span>
cd apps/web_antd
<span class="hljs-meta prompt_"># </span><span class="bash">å®‰è£…qiankun</span> 
pnpm i qiankun
</code></pre>
<p>åœ¨web-antdç›®å½•çš„srcç›®å½•æ·»åŠ qiankunç›®å½•ï¼Œå¹¶æ–°å»ºæ–‡ä»¶index.ts å’Œconfig.ts</p>
<pre><code class="hljs language-shell" lang="shell">cd src
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment">#æ·»åŠ qiankunæ–‡ä»¶å¤¹</span></span>
mkdir qiankun&amp;&amp;cd qiankun
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># å¯¼å…¥æ–‡ä»¶</span></span>
touch index.ts config.ts
</code></pre>
<p>config.tsæ–‡ä»¶å†…å®¹å¦‚ä¸‹,å¤§æ¦‚æ„æ€å°±æ˜¯åŠ è½½å­åº”ç”¨å°†æ–‡ä»¶å†…å®¹æ³¨å…¥åˆ°#sub-containerå®¹å™¨ä¸­ï¼Œå®¹å™¨å®šä¹‰åé¢ä¼šåŠ ï¼Œè·¯ç”±æ‹¦æˆªè§„åˆ™æ˜¯/app/basicï¼Œpropså®šä¹‰çš„æ˜¯ä¸»åº”ç”¨æ•°æ®ä¼ ç»™å­åº”ç”¨ï¼Œä¿è¯ä¸»åº”ç”¨ç™»å½•åå­åº”ç”¨å¯ä»¥å…±äº«ä¸»åº”ç”¨æ•°æ®ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby">/**  æœ¬åœ°åº”ç”¨æµ‹è¯•å¾®æœåŠ¡æ¶æ„ *<span class="hljs-regexp">/
export default {
  subApps: [
    {
      name: 'basic', /</span><span class="hljs-regexp">/ å­åº”ç”¨åç§°ï¼Œè·Ÿpackage.jsonä¸€è‡´
      /</span><span class="hljs-regexp">/ entry: import.meta.env.VITE_API_BASE_URL, /</span><span class="hljs-regexp">/ å­åº”ç”¨å…¥å£ï¼Œæœ¬åœ°ç¯å¢ƒä¸‹æŒ‡å®šç«¯å£
      entry: 'http:/</span><span class="hljs-regexp">/localhost:5667', /</span><span class="hljs-regexp">/ å­åº”ç”¨å…¥å£ï¼Œæœ¬åœ°å‰ç«¯ç¯å¢ƒä¸‹æŒ‡å®šç«¯å£'http:/</span><span class="hljs-regexp">/localhost:5174'ï¼Œå‘å¸ƒå¯ä»¥è°ƒæ•´ä¸ºä¸»ç³»ç»Ÿ:/app</span><span class="hljs-regexp">/workflow-app/</span>= <span class="hljs-regexp">/app/</span>æ’ä»¶åç§°/
      <span class="hljs-symbol">container:</span> <span class="hljs-string">'#sub-container'</span>, <span class="hljs-regexp">//</span> æŒ‚è½½å­åº”ç”¨çš„dom
      <span class="hljs-symbol">activeRule:</span> <span class="hljs-string">'/app/basic'</span>, <span class="hljs-regexp">//</span> è·¯ç”±åŒ¹é…è§„åˆ™
      <span class="hljs-symbol">props:</span> {
        <span class="hljs-symbol">userInfo:</span> [],
        <span class="hljs-symbol">token:</span> <span class="hljs-string">''</span>,
      }, <span class="hljs-regexp">//</span> ä¸»åº”ç”¨ä¸å­åº”ç”¨é€šä¿¡ä¼ å€¼
      <span class="hljs-symbol">sandbox:</span> {
        <span class="hljs-symbol">strictStyleIsolation:</span> <span class="hljs-literal">true</span>, <span class="hljs-regexp">//</span> å¯ç”¨ä¸¥æ ¼æ ·å¼éš”ç¦»
      },
    },
  ],
};

</code></pre>
<p>æ–‡ä»¶index.ts æ–‡ä»¶å†…å®¹å¦‚ä¸‹,æ³¨å†Œå¾®æœåŠ¡ç”Ÿå‘½å‘¨æœŸ</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å‚è€ƒé¡¹ç›®ï¼šhttps://github.com/wstee/qiankun-web</span>
<span class="hljs-keyword">import</span> { useAccessStore, useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/stores'</span>;
<span class="hljs-keyword">import</span> { registerMicroApps } <span class="hljs-keyword">from</span> <span class="hljs-string">'qiankun'</span>;

<span class="hljs-keyword">import</span> config <span class="hljs-keyword">from</span> <span class="hljs-string">'./config'</span>;

<span class="hljs-keyword">let</span> { subApps } = config;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">registerApps</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// å¦‚æœå­åº”ç”¨æ˜¯ä¸å®šçš„ï¼Œå¯ä»¥è¿™é‡Œå®šä¹‰æ¥å£ä»åå°è·å–èµ‹å€¼ç»™subAppsï¼ŒåŠ¨æ€æ·»åŠ </span>
 
    <span class="hljs-title function_">registerMicroApps</span>(subApps, {
      <span class="hljs-attr">beforeLoad</span>: [
        <span class="hljs-function">(<span class="hljs-params">app: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
          <span class="hljs-comment">// eslint-disable-next-line no-console</span>
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[ä¸»åº”ç”¨] beforeLoad'</span>, app.<span class="hljs-property">name</span>);
          <span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">useUserStore</span>();
          <span class="hljs-keyword">const</span> accessStore = <span class="hljs-title function_">useAccessStore</span>();
          app.<span class="hljs-property">props</span>.<span class="hljs-property">token</span> = accessStore.<span class="hljs-property">accessToken</span>;
          app.<span class="hljs-property">props</span>.<span class="hljs-property">userInfo</span> = useStore.<span class="hljs-property">userInfo</span>;
          <span class="hljs-comment">// app.props.publicKey = import.meta.env.VITE_PUBLIC_KEY;</span>
        },
      ],
      <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸé’©å­</span>
      <span class="hljs-attr">loader</span>: <span class="hljs-function">(<span class="hljs-params">loading: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
        <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œå¤„ç†åŠ è½½çŠ¶æ€</span>
        <span class="hljs-comment">// eslint-disable-next-line no-console</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å­åº”ç”¨åŠ è½½çŠ¶æ€:'</span>, loading);
      },
      <span class="hljs-attr">beforeMount</span>: [
        <span class="hljs-function">(<span class="hljs-params">app</span>) =&gt;</span> {
          <span class="hljs-comment">// eslint-disable-next-line no-console</span>
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[ä¸»åº”ç”¨] beforeMount'</span>, app.<span class="hljs-property">name</span>);
          <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(app.<span class="hljs-property">container</span>);
          <span class="hljs-keyword">if</span> (container) container.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;
        },
      ],
      <span class="hljs-attr">afterUnmount</span>: [
        <span class="hljs-function">(<span class="hljs-params">app</span>) =&gt;</span> {
          <span class="hljs-comment">// eslint-disable-next-line no-console</span>
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'count: %s'</span>, app);
        },
      ],
    });
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// eslint-disable-next-line no-console</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'count: %s'</span>, error);
  }
}

</code></pre>
<p>ä¿®æ”¹src/bootstrap.ts è®¾ç½®å¯åŠ¨æ—¶åŠ è½½qiankuné…ç½®ï¼Œæ­¤å¤„åªæ˜¯åŠ è½½ï¼Œä½†æ²¡æœ‰å‘å…¶ä»–æ•™ç¨‹ä¸€æ ·å¯åŠ¨start({}),å› ä¸ºsub_containeræŒ‚è½½ç‚¹è¿˜æ²¡æœ‰åŠ åˆ°åº”ç”¨ä¸­æ‰§è¡Œå¯åŠ¨ä¼šæŠ¥é”™ï¼Œä¼šæ‰¾ä¸åˆ°#sub-containerå…ƒç´ ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># src/bootstrap.ts ä¿®æ”¹å†…å®¹</span>
<span class="hljs-comment">#å¯¼å…¥å¼•ç”¨æ–‡ä»¶</span>
import { registerApps } from '<span class="hljs-comment">#/qiankun';</span>

<span class="hljs-comment"># å®šä¹‰appå‰é¢æ³¨å†ŒregisterApps</span>
+ registerApps()<span class="hljs-comment">;</span>
const <span class="hljs-attr">app</span> = createApp(App)<span class="hljs-comment">;</span>

</code></pre>
<p>æ­¤æ—¶å¯åŠ¨ä¸»åº”ç”¨ æ§åˆ¶å°ä¼šæœ‰ä¸€ä¸ªè­¦å‘Šï¼Œå¤§æ¦‚æ„æ€æ²¡æœ‰æ‰§è¡Œstart({})å¯åŠ¨å¾®æœåŠ¡ï¼Œæš‚æ—¶å…ˆä¸ç®¡ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f83117c739e14356b2a92ccae45c416a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29fY2FpcHU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766626892&amp;x-signature=%2FfIvYFLC5RRY8UrZ5FS3K231J%2BQ%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">æ³¨å†Œå­åº”ç”¨è·¯ç”±</h4>
<p>åœ¨scr/views/_core/appContainer.vue ä½ç½®æ·»åŠ ä¸€ä¸ªæ–‡ä»¶ï¼Œä½œä¸ºå­åº”ç”¨è·¯ç”±ç€é™†é¡µï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// fix: è¿™ä¸ªé¡µé¢é„ä½œä¸ºappå­é¡µé¢ç€é™†é¡µï¼Œä¸å¢åŠ ä¹ˆä¼šæŠ¥é”™æ‰¾ä¸åˆ°åŠ è½½é¡µé¢</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>æœ¬æ¬¡è¦æ”¯æŒå¦‚ä¸‹ä¸¤ä¸ªå­åº”ç”¨è·¯ç”±è®¿é—®ï¼Œæ‰€ä»¥æ·»åŠ 2ä¸ªé™æ€è·¯ç”±åœ°å€,é¡µé¢éƒ½æŒ‡å‘ä¸Šé¢çš„ç©ºè·¯ç”±ç€é™†é¡µã€‚</p>
<ul>
<li>/app/basic/demo1</li>
<li>/app/basic/demo2
è°ƒæ•´å†…å®¹ï¼šä¿®æ”¹src/routes/modules/demos.tsæ·»åŠ ä¸Šè¿°ä¸¤ä¸ªæµ‹è¯•è·¯ç”±ï¼Œåœ¨ç¬¬26è¡Œæ·»åŠ å†…å®¹å¦‚ä¸‹ï¼š</li>
</ul>

<pre><code class="hljs language-css" lang="css">  {
    meta: {
      <span class="hljs-attribute">icon</span>: <span class="hljs-string">'ic:baseline-view-in-ar'</span>,
      keepAlive: true,
      order: <span class="hljs-number">1000</span>,
      title: <span class="hljs-string">'å­åº”ç”¨demo1'</span>,
    },
    name: <span class="hljs-string">'subdemo1'</span>,
    path: <span class="hljs-string">'/app/basic/demo1'</span>,
    component: () =&gt; <span class="hljs-built_in">import</span>(<span class="hljs-string">'#/views/_core/appContainer.vue'</span>),
  },
  {
    meta: {
      <span class="hljs-attribute">icon</span>: <span class="hljs-string">'ic:baseline-view-in-ar'</span>,
      keepAlive: true,
      order: <span class="hljs-number">1000</span>,
      title: <span class="hljs-string">'å­åº”ç”¨demo2'</span>,
    },
    name: <span class="hljs-string">'subdemo2'</span>,
    path: <span class="hljs-string">'/app/basic/demo2'</span>,
    component: () =&gt; <span class="hljs-built_in">import</span>(<span class="hljs-string">'#/views/_core/appContainer.vue'</span>),
  },
</code></pre>
<p>æ­¤æ—¶è®¿é—®<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A5666%25E9%25A1%25B5%25E9%259D%25A2" target="_blank" title="http://localhost:5666%E9%A1%B5%E9%9D%A2" ref="nofollow noopener noreferrer">http://localhost:5666é¡µé¢</a> åº”è¯¥æ˜¯å¯ä»¥çœ‹åˆ°2ä¸ªè·¯ç”±å†…å®¹ï¼Œä¸è¿‡é¡µé¢å†…å®¹åŒºåŸŸæ˜¯ç©ºç™½.
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2fb11d47e9a040ea9b0cfea3cdbc172b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29fY2FpcHU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766626892&amp;x-signature=SMdg4i1scCeAgOoLW2hNoM9YClo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-7">packageåŒ…æ·»åŠ æŒ‚è½½å®¹å™¨</h4>
<p>packageä½œä¸ºå•ç‹¬æ ¸å¿ƒåŒ…ï¼Œé‡Œé¢åŒ…æ‹¬ä¸»æ¡†æ¶æ–‡ä»¶content.vue,éœ€è¦å¢åŠ ä¸»åŒ…å®‰è£…qiankunã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> packages/effects/layouts
<span class="hljs-comment">#å®‰è£…qiankun</span>
pnpm i qiankun
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šä¿®æ”¹ä¸»åŒ…å¼•ç”¨æœ‰ä¸ªä¸å¥½çš„åœ°æ–¹ï¼Œåé¢å¦‚æœæ›´æ–°vbenä¸»ä»“åº“çš„æ—¶å€™ï¼Œæœ‰å˜æ›´éƒ½è¦æ‰‹åŠ¨å¤„ç†gitå†²çªã€‚</p>
</blockquote>
<p>æ‰“å¼€é¡µé¢packages/effects/layouts/src/basic/content/content.vueæ–‡ä»¶ï¼Œåœ¨ç›¸åº”ä½ç½®æ·»åŠ å¦‚ä¸‹ä»£ç </p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;script lang=<span class="hljs-string">"ts"</span> setup&gt;
...
#å¯¼å…¥
<span class="hljs-keyword">import</span> { start } <span class="hljs-keyword">from</span> <span class="hljs-string">'qiankun'</span>;
...
# åŠ è½½start

<span class="hljs-keyword">function</span> <span class="hljs-title function_">startApps</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">qiankunStarted</span>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">qiankunStarted</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-comment">// registerApps()</span>
    <span class="hljs-title function_">start</span>({
      <span class="hljs-attr">prefetch</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// å¼€å¯é¢„åŠ è½½ä¼šå¯¼è‡´é‡å¤åŠ è½½åº”ç”¨</span>
      <span class="hljs-title function_">fetch</span>(<span class="hljs-params">url, ...args</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">fetch</span>(url, ...args).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Fetch failed:'</span>, url);
          <span class="hljs-comment">// ç›´æ¥è¿”å›ä¸€ä¸ªå¤±è´¥çš„ Promiseï¼Œé˜»æ­¢é‡è¯•</span>
          <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>;
        });
      },
      <span class="hljs-attr">sandbox</span>: {
        <span class="hljs-attr">experimentalStyleIsolation</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ ·å¼éš”ç¦»</span>
      },
    });
  }
}
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">startApps</span>();
});
&lt;/script&gt;

    &lt;!--- qiankun by go-caipu æ³¨å…¥å®¹å™¨ --&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sub-container"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sub-container"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

</code></pre>
<p>å®Œæ•´æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">&lt;script lang=<span class="hljs-string">"ts"</span> setup&gt;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">VNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> {
  <span class="hljs-title class_">RouteLocationNormalizedLoaded</span>,
  <span class="hljs-title class_">RouteLocationNormalizedLoadedGeneric</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>;

<span class="hljs-keyword">import</span> { computed, onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RouterView</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>;

<span class="hljs-keyword">import</span> { preferences, usePreferences } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/preferences'</span>;
<span class="hljs-keyword">import</span> { getTabKey, storeToRefs, useTabbarStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/stores'</span>;

<span class="hljs-keyword">import</span> { start } <span class="hljs-keyword">from</span> <span class="hljs-string">'qiankun'</span>;

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">IFrameRouterView</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../iframe'</span>;

<span class="hljs-title function_">defineOptions</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'LayoutContent'</span> });

<span class="hljs-keyword">const</span> tabbarStore = <span class="hljs-title function_">useTabbarStore</span>();
<span class="hljs-keyword">const</span> { keepAlive } = <span class="hljs-title function_">usePreferences</span>();

<span class="hljs-keyword">const</span> { getCachedTabs, getExcludeCachedTabs, renderRouteView } =
  <span class="hljs-title function_">storeToRefs</span>(tabbarStore);

<span class="hljs-comment">/**
 * æ˜¯å¦ä½¿ç”¨åŠ¨ç”»
 */</span>
<span class="hljs-keyword">const</span> getEnabledTransition = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> { transition } = preferences;
  <span class="hljs-keyword">const</span> transitionName = transition.<span class="hljs-property">name</span>;
  <span class="hljs-keyword">return</span> transitionName &amp;&amp; transition.<span class="hljs-property">enable</span>;
});

<span class="hljs-comment">// é¡µé¢åˆ‡æ¢åŠ¨ç”»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getTransitionName</span>(<span class="hljs-params">_route: RouteLocationNormalizedLoaded</span>) {
  <span class="hljs-comment">// å¦‚æœåå¥½è®¾ç½®æœªè®¾ç½®ï¼Œåˆ™ä¸ä½¿ç”¨åŠ¨ç”»</span>
  <span class="hljs-keyword">const</span> { tabbar, transition } = preferences;
  <span class="hljs-keyword">const</span> transitionName = transition.<span class="hljs-property">name</span>;
  <span class="hljs-keyword">if</span> (!transitionName || !transition.<span class="hljs-property">enable</span>) {
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// æ ‡ç­¾é¡µæœªå¯ç”¨æˆ–è€…æœªå¼€å¯ç¼“å­˜ï¼Œåˆ™ä½¿ç”¨å…¨å±€é…ç½®åŠ¨ç”»</span>
  <span class="hljs-keyword">if</span> (!tabbar.<span class="hljs-property">enable</span> || !keepAlive) {
    <span class="hljs-keyword">return</span> transitionName;
  }

  <span class="hljs-comment">// å¦‚æœé¡µé¢å·²ç»åŠ è½½è¿‡ï¼Œåˆ™ä¸ä½¿ç”¨åŠ¨ç”»</span>
  <span class="hljs-comment">// if (route.meta.loaded) {</span>
  <span class="hljs-comment">//   return;</span>
  <span class="hljs-comment">// }</span>
  <span class="hljs-comment">// å·²ç»æ‰“å¼€ä¸”å·²ç»åŠ è½½è¿‡çš„é¡µé¢ä¸ä½¿ç”¨åŠ¨ç”»</span>
  <span class="hljs-comment">// const inTabs = getCachedTabs.value.includes(route.name as string);</span>

  <span class="hljs-comment">// return inTabs &amp;&amp; route.meta.loaded ? undefined : transitionName;</span>
  <span class="hljs-keyword">return</span> transitionName;
}

<span class="hljs-comment">/**
 * è½¬æ¢ç»„ä»¶ï¼Œè‡ªåŠ¨æ·»åŠ  name
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">component</span>
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformComponent</span>(<span class="hljs-params">
  component: VNode,
  route: RouteLocationNormalizedLoadedGeneric,
</span>) {
  <span class="hljs-comment">// ç»„ä»¶è§†å›¾æœªæ‰¾åˆ°ï¼Œå¦‚æœæœ‰è®¾ç½®åå¤‡è§†å›¾ï¼Œåˆ™è¿”å›åå¤‡è§†å›¾ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æŠ›å‡ºé”™è¯¯</span>
  <span class="hljs-keyword">if</span> (!component) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(
      <span class="hljs-string">'Component view not foundï¼Œplease check the route configuration'</span>,
    );
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
  }

  <span class="hljs-keyword">const</span> routeName = route.<span class="hljs-property">name</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// å¦‚æœç»„ä»¶æ²¡æœ‰ nameï¼Œåˆ™ç›´æ¥è¿”å›</span>
  <span class="hljs-keyword">if</span> (!routeName) {
    <span class="hljs-keyword">return</span> component;
  }
  <span class="hljs-keyword">const</span> componentName = (component?.<span class="hljs-property">type</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)?.<span class="hljs-property">name</span>;

  <span class="hljs-comment">// å·²ç»è®¾ç½®è¿‡ nameï¼Œåˆ™ç›´æ¥è¿”å›</span>
  <span class="hljs-keyword">if</span> (componentName) {
    <span class="hljs-keyword">return</span> component;
  }

  <span class="hljs-comment">// componentName ä¸ routeName ä¸€è‡´ï¼Œåˆ™ç›´æ¥è¿”å›</span>
  <span class="hljs-keyword">if</span> (componentName === routeName) {
    <span class="hljs-keyword">return</span> component;
  }

  <span class="hljs-comment">// è®¾ç½® name</span>
  component.<span class="hljs-property">type</span> ||= {};
  (component.<span class="hljs-property">type</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">name</span> = routeName;

  <span class="hljs-keyword">return</span> component;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">startApps</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">qiankunStarted</span>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">qiankunStarted</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-comment">// registerApps()</span>
    <span class="hljs-title function_">start</span>({
      <span class="hljs-attr">prefetch</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// å¼€å¯é¢„åŠ è½½ä¼šå¯¼è‡´é‡å¤åŠ è½½åº”ç”¨</span>
      <span class="hljs-title function_">fetch</span>(<span class="hljs-params">url, ...args</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">fetch</span>(url, ...args).<span class="hljs-keyword">catch</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Fetch failed:'</span>, url);
          <span class="hljs-comment">// ç›´æ¥è¿”å›ä¸€ä¸ªå¤±è´¥çš„ Promiseï¼Œé˜»æ­¢é‡è¯•</span>
          <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>;
        });
      },
      <span class="hljs-attr">sandbox</span>: {
        <span class="hljs-attr">experimentalStyleIsolation</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ ·å¼éš”ç¦»</span>
      },
    });
  }
}
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">startApps</span>();
});
&lt;/script&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"relative h-full"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">IFrameRouterView</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">RouterView</span> <span class="hljs-attr">v-slot</span>=<span class="hljs-string">"{ Component, route }"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Transition</span>
        <span class="hljs-attr">v-if</span>=<span class="hljs-string">"getEnabledTransition"</span>
        <span class="hljs-attr">:name</span>=<span class="hljs-string">"getTransitionName(route)"</span>
        <span class="hljs-attr">appear</span>
        <span class="hljs-attr">mode</span>=<span class="hljs-string">"out-in"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span>
          <span class="hljs-attr">v-if</span>=<span class="hljs-string">"keepAlive"</span>
          <span class="hljs-attr">:exclude</span>=<span class="hljs-string">"getExcludeCachedTabs"</span>
          <span class="hljs-attr">:include</span>=<span class="hljs-string">"getCachedTabs"</span>
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
            <span class="hljs-attr">:is</span>=<span class="hljs-string">"transformComponent(Component, route)"</span>
            <span class="hljs-attr">v-if</span>=<span class="hljs-string">"renderRouteView"</span>
            <span class="hljs-attr">v-show</span>=<span class="hljs-string">"!route.meta.iframeSrc"</span>
            <span class="hljs-attr">:key</span>=<span class="hljs-string">"getTabKey(route)"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
          <span class="hljs-attr">:is</span>=<span class="hljs-string">"Component"</span>
          <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">"renderRouteView"</span>
          <span class="hljs-attr">:key</span>=<span class="hljs-string">"getTabKey(route)"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Transition</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-else</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span>
          <span class="hljs-attr">v-if</span>=<span class="hljs-string">"keepAlive"</span>
          <span class="hljs-attr">:exclude</span>=<span class="hljs-string">"getExcludeCachedTabs"</span>
          <span class="hljs-attr">:include</span>=<span class="hljs-string">"getCachedTabs"</span>
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
            <span class="hljs-attr">:is</span>=<span class="hljs-string">"transformComponent(Component, route)"</span>
            <span class="hljs-attr">v-if</span>=<span class="hljs-string">"renderRouteView"</span>
            <span class="hljs-attr">v-show</span>=<span class="hljs-string">"!route.meta.iframeSrc"</span>
            <span class="hljs-attr">:key</span>=<span class="hljs-string">"getTabKey(route)"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
          <span class="hljs-attr">:is</span>=<span class="hljs-string">"Component"</span>
          <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">"renderRouteView"</span>
          <span class="hljs-attr">:key</span>=<span class="hljs-string">"getTabKey(route)"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">RouterView</span>&gt;</span>
    <span class="hljs-comment">&lt;!--- qiankun by go-caipu --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sub-container"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sub-container"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

</code></pre>
<p>åˆ°æ­¤ä¸»åº”ç”¨é…ç½®å®Œæˆã€‚</p>
<h3 data-id="heading-8">å­åº”ç”¨web-antd-childé›†æˆ</h3>
<p>å› ä¸ºå­åº”ç”¨è°ƒæ•´å†…å®¹è¾ƒå¤šï¼Œæœ‰çš„æ–‡ä»¶ç›´æ¥ç»™å‡ºæ•´ä¸ªä¿®æ”¹çš„æ–‡ä»¶</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è½¬åˆ°å­åº”ç”¨ç›®å½•</span>
<span class="hljs-built_in">cd</span> ./apps/web-antd-child/
<span class="hljs-comment"># å®‰è£… vite æ”¯æŒqiankun</span>
pnpm i vite-plugin-qiankun
</code></pre>
<h4 data-id="heading-9">ä¿®æ”¹.env.development ç¯å¢ƒå˜é‡</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¿®æ”¹VITE_BASE è®©ç¨‹åºä»¥/app/basicå­åŒ…æ–¹å¼è¿è¡Œ</span>
<span class="hljs-attr">VITE_BASE</span>=/app/basic

<span class="hljs-comment"># æ˜¯å¦æ³¨å…¥å…¨å±€loading æ”¹ç½®ä¸è¦loadingæ•ˆæœï¼Œå› ä¸ºåŠ è½½å­åº”ç”¨çš„æ—¶å€™ç›´æ¥æ˜¯å…³é—­ä¸äº†ï¼Œå¾—è¦è°ƒæ•´ç¨‹åºæ­¤æ¬¡å…ˆå…³é—­</span>
<span class="hljs-attr">VITE_INJECT_APP_LOADING</span>=<span class="hljs-literal">false</span>
</code></pre>
<h4 data-id="heading-10">ä¿®æ”¹index.html</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å°†åŸæ–‡ä»¶ä¸­ &lt;div <span class="hljs-built_in">id</span>=<span class="hljs-string">"app"</span>&gt;&lt;/div&gt; è°ƒæ•´ä¸º &lt;div <span class="hljs-built_in">id</span>=<span class="hljs-string">"app"</span>&gt;&lt;/div&gt;</span>
</code></pre>
<h4 data-id="heading-11">ä¿®æ”¹.vite.config.ts å¢åŠ qiankunåŠ è½½</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/vite-config'</span>;

<span class="hljs-keyword">import</span> qiankun <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-qiankun'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">application</span>: {},
    <span class="hljs-attr">vite</span>: {
      <span class="hljs-attr">server</span>: {
        <span class="hljs-attr">proxy</span>: {
          <span class="hljs-string">'/api'</span>: {
            <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">rewrite</span>: <span class="hljs-function">(<span class="hljs-params">path</span>) =&gt;</span> path.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^\/api/</span>, <span class="hljs-string">''</span>),
            <span class="hljs-comment">// mockä»£ç†ç›®æ ‡åœ°å€</span>
            <span class="hljs-attr">target</span>: <span class="hljs-string">'http://localhost:5320/api'</span>,
            <span class="hljs-attr">ws</span>: <span class="hljs-literal">true</span>,
          },
        },
      },
      <span class="hljs-attr">plugins</span>: [
        <span class="hljs-title function_">qiankun</span>(<span class="hljs-string">'/app/basic'</span>, {
          <span class="hljs-attr">useDevMode</span>: <span class="hljs-literal">true</span>,
        }),
      ],
    },
  };
});

</code></pre>
<h4 data-id="heading-12">ä¿®æ”¹ bootstrap.tsæ–‡ä»¶</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createApp, watchEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">import</span> { registerAccessDirective } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/access'</span>;
<span class="hljs-keyword">import</span> { registerLoadingDirective } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/common-ui/es/loading'</span>;
<span class="hljs-keyword">import</span> { preferences } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/preferences'</span>;
<span class="hljs-keyword">import</span> { initStores } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/stores'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'@vben/styles'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'@vben/styles/antd'</span>;

<span class="hljs-keyword">import</span> { useTitle } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vueuse/core'</span>;

<span class="hljs-keyword">import</span> { $t, setupI18n } <span class="hljs-keyword">from</span> <span class="hljs-string">'#/locales'</span>;

<span class="hljs-keyword">import</span> { initComponentAdapter } <span class="hljs-keyword">from</span> <span class="hljs-string">'./adapter/component'</span>;
<span class="hljs-keyword">import</span> { initSetupVbenForm } <span class="hljs-keyword">from</span> <span class="hljs-string">'./adapter/form'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.vue'</span>;
<span class="hljs-keyword">import</span> { router } <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params">namespace: string, container: any = <span class="hljs-literal">null</span></span>) {
  <span class="hljs-comment">// åˆå§‹åŒ–ç»„ä»¶é€‚é…å™¨</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">initComponentAdapter</span>();

  <span class="hljs-comment">// åˆå§‹åŒ–è¡¨å•ç»„ä»¶</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">initSetupVbenForm</span>();

  <span class="hljs-comment">// // è®¾ç½®å¼¹çª—çš„é»˜è®¤é…ç½®</span>
  <span class="hljs-comment">// setDefaultModalProps({</span>
  <span class="hljs-comment">//   fullscreenButton: false,</span>
  <span class="hljs-comment">// });</span>
  <span class="hljs-comment">// // è®¾ç½®æŠ½å±‰çš„é»˜è®¤é…ç½®</span>
  <span class="hljs-comment">// setDefaultDrawerProps({</span>
  <span class="hljs-comment">//   zIndex: 1020,</span>
  <span class="hljs-comment">// });</span>

  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>);

  <span class="hljs-comment">// æ³¨å†Œv-loadingæŒ‡ä»¤</span>
  <span class="hljs-title function_">registerLoadingDirective</span>(app, {
    <span class="hljs-attr">loading</span>: <span class="hljs-string">'loading'</span>, <span class="hljs-comment">// åœ¨è¿™é‡Œå¯ä»¥è‡ªå®šä¹‰æŒ‡ä»¤åç§°ï¼Œä¹Ÿå¯ä»¥æ˜ç¡®æä¾›falseè¡¨ç¤ºä¸æ³¨å†Œè¿™ä¸ªæŒ‡ä»¤</span>
    <span class="hljs-attr">spinning</span>: <span class="hljs-string">'spinning'</span>,
  });

  <span class="hljs-comment">// å›½é™…åŒ– i18n é…ç½®</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">setupI18n</span>(app);

  <span class="hljs-comment">// é…ç½® pinia-tore</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">initStores</span>(app, { namespace });

  <span class="hljs-comment">// å®‰è£…æƒé™æŒ‡ä»¤</span>
  <span class="hljs-title function_">registerAccessDirective</span>(app);

  <span class="hljs-comment">// åˆå§‹åŒ– tippy</span>
  <span class="hljs-keyword">const</span> { initTippy } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@vben/common-ui/es/tippy'</span>);
  <span class="hljs-title function_">initTippy</span>(app);

  <span class="hljs-comment">// é…ç½®è·¯ç”±åŠè·¯ç”±å®ˆå«</span>
  app.<span class="hljs-title function_">use</span>(router);

  <span class="hljs-comment">// é…ç½®Motionæ’ä»¶</span>
  <span class="hljs-keyword">const</span> { <span class="hljs-title class_">MotionPlugin</span> } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@vben/plugins/motion'</span>);
  app.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">MotionPlugin</span>);

  <span class="hljs-comment">// åŠ¨æ€æ›´æ–°æ ‡é¢˜</span>
  <span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (preferences.<span class="hljs-property">app</span>.<span class="hljs-property">dynamicTitle</span>) {
      <span class="hljs-keyword">const</span> routeTitle = router.<span class="hljs-property">currentRoute</span>.<span class="hljs-property">value</span>.<span class="hljs-property">meta</span>?.<span class="hljs-property">title</span>;
      <span class="hljs-keyword">const</span> pageTitle =
        (routeTitle ? <span class="hljs-string">`<span class="hljs-subst">${$t(routeTitle)}</span> - `</span> : <span class="hljs-string">''</span>) + preferences.<span class="hljs-property">app</span>.<span class="hljs-property">name</span>;
      <span class="hljs-title function_">useTitle</span>(pageTitle);
    }
  });

  app.<span class="hljs-title function_">mount</span>(container ? container.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#sub_app'</span>) : <span class="hljs-string">'#sub_app'</span>);
  <span class="hljs-keyword">return</span> app;
}

<span class="hljs-keyword">export</span> { bootstrap };


</code></pre>
<h4 data-id="heading-13">ä¿®æ”¹ main.ts</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { initPreferences } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/preferences'</span>;
<span class="hljs-keyword">import</span> { useAccessStore, useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/stores'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'@vben/styles'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'@vben/styles/antd'</span>;
<span class="hljs-keyword">import</span> { unmountGlobalLoading } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vben/utils'</span>;

<span class="hljs-keyword">import</span> {
  qiankunWindow,
  renderWithQiankun,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-qiankun/dist/helper'</span>;

<span class="hljs-keyword">import</span> { bootstrap } <span class="hljs-keyword">from</span> <span class="hljs-string">'./bootstrap'</span>;
<span class="hljs-keyword">import</span> { overridesPreferences } <span class="hljs-keyword">from</span> <span class="hljs-string">'./preferences'</span>;

<span class="hljs-keyword">let</span> <span class="hljs-attr">app</span>: any = <span class="hljs-literal">null</span>;
<span class="hljs-comment">/**
 * åº”ç”¨åˆå§‹åŒ–å®Œæˆä¹‹åå†è¿›è¡Œé¡µé¢åŠ è½½æ¸²æŸ“
 */</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initApplication</span>(<span class="hljs-params">container: any = <span class="hljs-literal">null</span></span>) {
  <span class="hljs-comment">// nameç”¨äºæŒ‡å®šé¡¹ç›®å”¯ä¸€æ ‡è¯†</span>
  <span class="hljs-comment">// ç”¨äºåŒºåˆ†ä¸åŒé¡¹ç›®çš„åå¥½è®¾ç½®ä»¥åŠå­˜å‚¨æ•°æ®çš„keyå‰ç¼€ä»¥åŠå…¶ä»–ä¸€äº›éœ€è¦éš”ç¦»çš„æ•°æ®</span>
  <span class="hljs-keyword">const</span> env = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">PROD</span> ? <span class="hljs-string">'prod'</span> : <span class="hljs-string">'dev'</span>;
  <span class="hljs-keyword">const</span> appVersion = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_APP_VERSION</span>;
  <span class="hljs-keyword">const</span> namespace = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">import</span>.meta.env.VITE_APP_NAMESPACE}</span>-<span class="hljs-subst">${appVersion}</span>-<span class="hljs-subst">${env}</span>`</span>;

  <span class="hljs-comment">// appåå¥½è®¾ç½®åˆå§‹åŒ–</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">initPreferences</span>({
    namespace,
    <span class="hljs-attr">overrides</span>: overridesPreferences,
  });
  <span class="hljs-comment">// å¯åŠ¨åº”ç”¨å¹¶æŒ‚è½½</span>
  <span class="hljs-comment">// vueåº”ç”¨ä¸»è¦é€»è¾‘åŠè§†å›¾</span>
  app = <span class="hljs-keyword">await</span> <span class="hljs-title function_">bootstrap</span>(namespace, container);
  <span class="hljs-comment">// ç§»é™¤å¹¶é”€æ¯loading</span>
  <span class="hljs-title function_">unmountGlobalLoading</span>();
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">initQianKun</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">renderWithQiankun</span>({
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">mount</span>(<span class="hljs-params">props: any</span>) {
      <span class="hljs-keyword">const</span> { container, token, userInfo } = props;
      <span class="hljs-keyword">await</span> <span class="hljs-title function_">initApplication</span>(container);
      <span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">useUserStore</span>();
      <span class="hljs-keyword">const</span> accessStore = <span class="hljs-title function_">useAccessStore</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[å­åº”ç”¨]  mounting'</span>, props);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[å­åº”ç”¨]  token:'</span>, token);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[å­åº”ç”¨]  userInfo:'</span>, userInfo);

      useStore.<span class="hljs-title function_">setUserInfo</span>(userInfo);
      accessStore.<span class="hljs-title function_">setAccessToken</span>(token);
      <span class="hljs-comment">// ç§»é™¤å¹¶é”€æ¯loading</span>
      <span class="hljs-title function_">unmountGlobalLoading</span>();
    },
    <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// eslint-disable-next-line no-console</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[å­åº”ç”¨]  bootstraped'</span>);
    },
    <span class="hljs-title function_">update</span>(<span class="hljs-params">props: any</span>) {
      <span class="hljs-comment">// eslint-disable-next-line no-console</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[å­åº”ç”¨]  update'</span>);
      <span class="hljs-keyword">const</span> { container } = props;
      <span class="hljs-title function_">initApplication</span>(container);
    },
    <span class="hljs-title function_">unmount</span>(<span class="hljs-params">props</span>) {
      <span class="hljs-comment">// eslint-disable-next-line no-console</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[å­åº”ç”¨] unmount'</span>, props);
      app?.<span class="hljs-title function_">unmount</span>();
      app = <span class="hljs-literal">null</span>;
    },
  });
};
<span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ä¸ºä¹¾å¤ç¯å¢ƒï¼Œå¦åˆ™ä¼šæŠ¥é”™iqiankun]: Target container with #subAppContainerVue3 not existed while subAppVue3 mounting!</span>
qiankunWindow.<span class="hljs-property">__POWERED_BY_QIANKUN__</span>
  ? <span class="hljs-keyword">await</span> <span class="hljs-title function_">initQianKun</span>()
  : <span class="hljs-keyword">await</span> <span class="hljs-title function_">initApplication</span>();
</code></pre>
<h4 data-id="heading-14">æ·»åŠ æµ‹è¯•è·¯ç”±</h4>
<p>ä¿®æ”¹/web-basic/src/router/routes/index.ts çš„å†…å®¹ï¼Œå¢åŠ 2ä¸ªæµ‹è¯•è·¯ç”±ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment">#å°†const externalRoutes: RouteRecordRaw[] = [] è°ƒæ•´ä¸ºä¸‹é¢å†…å®¹</span>
<span class="hljs-attr">const externalRoutes:</span> <span class="hljs-string">RouteRecordRaw[]</span> <span class="hljs-string">=</span> [
  {
    <span class="hljs-attr">meta:</span> {
      <span class="hljs-attr">icon:</span> <span class="hljs-string">'ic:baseline-view-in-ar'</span>,
      <span class="hljs-attr">keepAlive:</span> <span class="hljs-literal">true</span>,
      <span class="hljs-attr">order:</span> <span class="hljs-number">1000</span>,
      <span class="hljs-attr">title:</span> <span class="hljs-string">'æ¼”ç¤ºåŠŸèƒ½'</span>,
    },
    <span class="hljs-attr">name:</span> <span class="hljs-string">'Test'</span>,
    <span class="hljs-attr">path:</span> <span class="hljs-string">'/demo'</span>,
    <span class="hljs-attr">component:</span> <span class="hljs-string">()</span> <span class="hljs-string">=&gt;</span> <span class="hljs-string">import('#/views/demos/antd/index.vue')</span>,
  },
  {
    <span class="hljs-attr">meta:</span> {
      <span class="hljs-attr">icon:</span> <span class="hljs-string">'ic:baseline-view-in-ar'</span>,
      <span class="hljs-attr">keepAlive:</span> <span class="hljs-literal">true</span>,
      <span class="hljs-attr">order:</span> <span class="hljs-number">1000</span>,
      <span class="hljs-attr">title:</span> <span class="hljs-string">'æ¼”ç¤ºåŠŸèƒ½'</span>,
    },
    <span class="hljs-attr">name:</span> <span class="hljs-string">'demo2'</span>,
    <span class="hljs-attr">path:</span> <span class="hljs-string">'/demo2'</span>,
    <span class="hljs-attr">component:</span> <span class="hljs-string">()</span> <span class="hljs-string">=&gt;</span> <span class="hljs-string">import('#/views/dashboard/workspace/index.vue')</span>,
  },
]<span class="hljs-string">;</span>

</code></pre>
<p>é‡æ–°è¿è¡Œå­é¡¹ç›®<strong>pnpm dev</strong>, æ­¤æ—¶åº”è¯¥èƒ½æ‰“å¼€<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A5667%2Fapp%2Fbasic%2Fdemo1" target="_blank" title="http://localhost:5667/app/basic/demo1" ref="nofollow noopener noreferrer">http://localhost:5667/app/basic/demo1</a> å’Œ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A5667%2Fapp%2Fbasic%2Fdemo2" target="_blank" title="http://localhost:5667/app/basic/demo2" ref="nofollow noopener noreferrer">http://localhost:5667/app/basic/demo2</a> å­åº”ç”¨é¡µé¢å•ç‹¬è®¿é—®é¡µé¢å¦‚ä¸‹ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a20b46d2227e4a8d8a03ed5fdd2e54f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29fY2FpcHU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766626892&amp;x-signature=5Rr7IK3kocgh7muT7DoBeWwYRJI%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨ä¸»åº”ç”¨è®¿é—®å­åº”ç”¨é¡µé¢æ•ˆæœï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d88adcfbbdea409199d15f4c58197408~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29fY2FpcHU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766626892&amp;x-signature=M25k97Pzsx9w1s5jZDY%2FEUT%2F%2F9Y%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-15">é—ç•™é—®é¢˜</h3>
<ol>
<li>ä¸»åº”ç”¨å’Œå­åº”ç”¨ä¿æŒä¸»é¢˜é£æ ¼ä¸€è‡´ï¼Œä¸»åº”ç”¨è°ƒæ•´å­åº”ç”¨åŒæ­¥è°ƒæ•´ã€‚ç›®å‰é¦–æ¬¡æ‰“å¼€å­åº”ç”¨ä¼šå½±å“ä¸»åº”ç”¨æ ·å¼å˜æˆé»‘è‰²ä¸»é¢˜ï¼Œè¿˜åœ¨ç ”ç©¶å½“ä¸­ã€‚</li>
<li>å­åº”ç”¨ç™»å½•é‰´æƒä½¿ç”¨ä¸»åº”ç”¨é‰´æƒï¼Œå¦‚æœå­åº”ç”¨é‰´æƒè¿‡æœŸè¦è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œ</li>
</ol>
<h3 data-id="heading-16">åç»­ä¼˜åŒ–ç‚¹</h3>
<ol>
<li>ç®¡ç†ç³»ç»Ÿéƒ½æ˜¯ä»åå°åŠ è½½è·¯ç”±èœå•ï¼Œæœ¬æ¬¡ä»…æ˜¯ä¸€ä¸ªdemoï¼Œåç»­ä¼˜åŒ–è°ƒæ•´æˆåŠ¨æ€ä»åå°è·å–èœå•å’Œå®ç°å­åº”ç”¨çš„åŠ¨æ€æ›´æ–°ï¼Œå®ç°å­åº”ç”¨çš„çƒ­æ’æ‹”è¦å’Œåç«¯ç¨‹åºè¿›è¡Œè”åŠ¨ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[zustandæŒä¹…åŒ–]]></title>    <link>https://juejin.cn/post/7584730804513964075</link>    <guid>https://juejin.cn/post/7584730804513964075</guid>    <pubDate>2025-12-18T01:59:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584730804513964075" data-draft-id="7584729714339479571" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="zustandæŒä¹…åŒ–"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2025-12-18T01:59:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™å¾…é›¨è½"/> <meta itemprop="url" content="https://juejin.cn/user/3219836765220077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            zustandæŒä¹…åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3219836765220077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™å¾…é›¨è½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T01:59:36.000Z" title="Thu Dec 18 2025 01:59:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Zustand æä¾›äº†<strong>æç®€çš„æŒä¹…åŒ–æ–¹æ¡ˆ</strong>ï¼Œæ ¸å¿ƒé€šè¿‡å†…ç½®çš„Â <code>persist</code>Â ä¸­é—´ä»¶å®ç°ï¼Œæ— éœ€é¢å¤–ä¾èµ–ï¼ˆæˆ–ä»…éœ€å°‘é‡é…ç½®ï¼‰ï¼Œæ”¯æŒ localStorage/sessionStorage/ è‡ªå®šä¹‰å­˜å‚¨ï¼ˆå¦‚ React Native çš„ AsyncStorageï¼‰ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„æŒä¹…åŒ–æ•™ç¨‹ï¼ŒåŒ…å«åŸºç¡€ç”¨æ³•ã€é«˜çº§é…ç½®ã€å¸¸è§é—®é¢˜è§£å†³ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€åŸºç¡€ç”¨æ³•ï¼ˆæœ€å¸¸ç”¨ï¼‰</h3>
<h4 data-id="heading-1">1. å®‰è£…ä¾èµ–ï¼ˆè‹¥éœ€ç±»å‹æ”¯æŒï¼‰</h4>
<p>Zustand æ ¸å¿ƒåŒ…å·²å†…ç½®Â <code>persist</code>Â ä¸­é—´ä»¶ï¼Œæ— éœ€é¢å¤–å®‰è£…ï¼Œä»…éœ€ç¡®ä¿ zustand ç‰ˆæœ¬ â‰¥4.0.0ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install zustand <span class="hljs-comment"># æˆ– yarn add zustand</span>
</code></pre>
<h4 data-id="heading-2">2. åŸºç¡€æŒä¹…åŒ–é…ç½®</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;
<span class="hljs-keyword">import</span> { persist } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand/middleware'</span>; <span class="hljs-comment">// å¯¼å…¥æŒä¹…åŒ–ä¸­é—´ä»¶</span>

<span class="hljs-comment">// åˆ›å»ºå¸¦æŒä¹…åŒ–çš„ store</span>
<span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">create</span>(
  <span class="hljs-title function_">persist</span>(
    <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŸå§‹ store é€»è¾‘</span>
    <span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> })),
      <span class="hljs-attr">decrement</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> - <span class="hljs-number">1</span> })),
      <span class="hljs-attr">reset</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> }),
    }),
    <span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°ï¼šæŒä¹…åŒ–é…ç½®</span>
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'counter-storage'</span>, <span class="hljs-comment">// å­˜å‚¨çš„ keyï¼ˆå¿…é€‰ï¼Œç”¨äº localStorage æ ‡è¯†ï¼‰</span>
      <span class="hljs-comment">// é»˜è®¤å­˜å‚¨åˆ° localStorageï¼Œå¯æŒ‡å®šä¸º sessionStorageï¼š</span>
      <span class="hljs-comment">// storage: sessionStorage,</span>
    }
  )
);

<span class="hljs-comment">// ç»„ä»¶ä¸­ä½¿ç”¨ï¼ˆå’Œæ™®é€š zustand ç”¨æ³•å®Œå…¨ä¸€è‡´ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { count, increment, reset } = <span class="hljs-title function_">useCounterStore</span>();
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increment}</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{reset}</span>&gt;</span>é‡ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>âœ… æ•ˆæœï¼šåˆ·æ–°é¡µé¢åï¼Œ<code>count</code>Â çŠ¶æ€ä¼šä» localStorage ä¸­æ¢å¤ï¼Œæ— éœ€é¢å¤–ä»£ç ã€‚</p>
<h3 data-id="heading-3">äºŒã€é«˜çº§é…ç½®ï¼ˆè¦†ç›–å¸¸è§åœºæ™¯ï¼‰</h3>
<h4 data-id="heading-4">1. è‡ªå®šä¹‰å­˜å‚¨æ–¹å¼ï¼ˆå¦‚ React Nativeï¼‰</h4>
<p>é»˜è®¤å­˜å‚¨æ˜¯Â <code>localStorage</code>ï¼ˆWebï¼‰ï¼Œè‹¥éœ€é€‚é… React Nativeï¼Œå¯æŒ‡å®šÂ <code>AsyncStorage</code>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;
<span class="hljs-keyword">import</span> { persist } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand/middleware'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AsyncStorage</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@react-native-async-storage/async-storage'</span>; <span class="hljs-comment">// RN æŒä¹…åŒ–å­˜å‚¨</span>

<span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">create</span>(
  <span class="hljs-title function_">persist</span>(
    <span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
      <span class="hljs-attr">userInfo</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">token</span>: <span class="hljs-string">''</span> },
      <span class="hljs-attr">setUser</span>: <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">userInfo</span>: user }),
    }),
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'user-storage'</span>,
      <span class="hljs-attr">storage</span>: { <span class="hljs-comment">// è‡ªå®šä¹‰å­˜å‚¨é€‚é…å™¨</span>
        <span class="hljs-attr">getItem</span>: <span class="hljs-keyword">async</span> (name) =&gt; {
          <span class="hljs-keyword">const</span> value = <span class="hljs-keyword">await</span> <span class="hljs-title class_">AsyncStorage</span>.<span class="hljs-title function_">getItem</span>(name);
          <span class="hljs-keyword">return</span> value ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(value) : <span class="hljs-literal">null</span>;
        },
        <span class="hljs-attr">setItem</span>: <span class="hljs-keyword">async</span> (name, value) =&gt; {
          <span class="hljs-keyword">await</span> <span class="hljs-title class_">AsyncStorage</span>.<span class="hljs-title function_">setItem</span>(name, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));
        },
        <span class="hljs-attr">removeItem</span>: <span class="hljs-keyword">async</span> (name) =&gt; {
          <span class="hljs-keyword">await</span> <span class="hljs-title class_">AsyncStorage</span>.<span class="hljs-title function_">removeItem</span>(name);
        },
      },
    }
  )
);
</code></pre>
<h4 data-id="heading-5">3. æŒä¹…åŒ–åŠ å¯†ï¼ˆæ•æ„Ÿæ•°æ®ï¼‰</h4>
<p>è‹¥å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ tokenï¼‰ï¼Œå¯é€šè¿‡Â <code>serialize</code>/<code>deserialize</code>Â åŠ å¯† / è§£å¯†ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;
<span class="hljs-keyword">import</span> { persist } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand/middleware'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">CryptoJS</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'crypto-js'</span>; <span class="hljs-comment">// éœ€å®‰è£…ï¼šnpm install crypto-js</span>

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SECRET_KEY</span> = <span class="hljs-string">'your-secret-key'</span>; <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­å»ºè®®ä»ç¯å¢ƒå˜é‡è¯»å–</span>

<span class="hljs-keyword">const</span> useSecureStore = <span class="hljs-title function_">create</span>(
  <span class="hljs-title function_">persist</span>(
    <span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
      <span class="hljs-attr">token</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">setToken</span>: <span class="hljs-function">(<span class="hljs-params">token</span>) =&gt;</span> <span class="hljs-title function_">set</span>({ token }),
    }),
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'secure-storage'</span>,
      <span class="hljs-comment">// åºåˆ—åŒ–ï¼ˆå­˜å‚¨æ—¶åŠ å¯†ï¼‰</span>
      <span class="hljs-attr">serialize</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> encrypted = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(
          <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(state),
          <span class="hljs-variable constant_">SECRET_KEY</span>
        ).<span class="hljs-title function_">toString</span>();
        <span class="hljs-keyword">return</span> encrypted;
      },
      <span class="hljs-comment">// ååºåˆ—åŒ–ï¼ˆè¯»å–æ—¶è§£å¯†ï¼‰</span>
      <span class="hljs-attr">deserialize</span>: <span class="hljs-function">(<span class="hljs-params">encrypted</span>) =&gt;</span> {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> decrypted = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">decrypt</span>(encrypted, <span class="hljs-variable constant_">SECRET_KEY</span>).<span class="hljs-title function_">toString</span>(
            <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>
          );
          <span class="hljs-keyword">return</span> decrypted ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(decrypted) : {};
        } <span class="hljs-keyword">catch</span> (e) {
          <span class="hljs-keyword">return</span> {}; <span class="hljs-comment">// è§£å¯†å¤±è´¥è¿”å›ç©ºçŠ¶æ€</span>
        }
      },
    }
  )
);
</code></pre>
<h4 data-id="heading-6">4. æ‰‹åŠ¨æ§åˆ¶æŒä¹…åŒ–ï¼ˆæ¸…é™¤ / é‡æ–°åŠ è½½ï¼‰</h4>
<p>å¯é€šè¿‡Â <code>persist</code>Â è¿”å›çš„Â <code>persist</code>Â å¯¹è±¡æ‰‹åŠ¨æ“ä½œå­˜å‚¨ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">create</span>(
  <span class="hljs-title function_">persist</span>(
    <span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> ({ <span class="hljs-attr">count</span>: s.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> })),
    }),
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'manual-storage'</span> }
  )
);

<span class="hljs-comment">// è·å–æŒä¹…åŒ–æ“ä½œæ–¹æ³•</span>
<span class="hljs-keyword">const</span> { persist } = useStore;

<span class="hljs-comment">// æ‰‹åŠ¨æ¸…é™¤æŒä¹…åŒ–æ•°æ®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">clearStorage</span>(<span class="hljs-params"/>) {
  persist.<span class="hljs-title function_">clearStorage</span>(); <span class="hljs-comment">// æ¸…é™¤ localStorage ä¸­çš„æ•°æ®</span>
}

<span class="hljs-comment">// æ‰‹åŠ¨é‡æ–°åŠ è½½æŒä¹…åŒ–æ•°æ®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">reloadStorage</span>(<span class="hljs-params"/>) {
  persist.<span class="hljs-title function_">rehydrate</span>(); <span class="hljs-comment">// ä»å­˜å‚¨ä¸­é‡æ–°åŠ è½½çŠ¶æ€åˆ° store</span>
}

<span class="hljs-comment">// ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ControlPanel</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearStorage}</span>&gt;</span>æ¸…é™¤æŒä¹…åŒ–æ•°æ®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{reloadStorage}</span>&gt;</span>é‡æ–°åŠ è½½æ•°æ®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-7">5. æŒä¹…åŒ–å†²çªå¤„ç†ï¼ˆå¤šæ ‡ç­¾é¡µåŒæ­¥ï¼‰</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¤šæ ‡ç­¾é¡µä¿®æ”¹çŠ¶æ€å¯èƒ½å¯¼è‡´å†²çªï¼Œå¯é€šè¿‡Â <code>merge</code>Â é…ç½®åˆå¹¶çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">create</span>(
  <span class="hljs-title function_">persist</span>(
    <span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
    }),
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'sync-storage'</span>,
      <span class="hljs-comment">// åˆå¹¶å¤šæ ‡ç­¾é¡µçš„çŠ¶æ€ï¼ˆå–æœ€æ–°çš„ countï¼‰</span>
      <span class="hljs-attr">merge</span>: <span class="hljs-function">(<span class="hljs-params">persistedState, currentState</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> {
          ...currentState,
          <span class="hljs-attr">count</span>: persistedState.<span class="hljs-property">count</span> &gt; currentState.<span class="hljs-property">count</span> ? persistedState.<span class="hljs-property">count</span> : currentState.<span class="hljs-property">count</span>,
        };
      },
    }
  )
);
</code></pre>
<h3 data-id="heading-8">ä¸‰ã€å¸¸è§é—®é¢˜è§£å†³</h3>
<h4 data-id="heading-9">1. çŠ¶æ€ä¸æŒä¹…åŒ–ï¼Ÿ</h4>
<ul>
<li>æ£€æŸ¥Â <code>name</code>Â é…ç½®æ˜¯å¦å”¯ä¸€ï¼ˆé¿å…å’Œå…¶ä»–å­˜å‚¨å†²çªï¼‰ï¼›</li>
<li>ç¡®è®¤å­˜å‚¨çš„çŠ¶æ€æ˜¯å¯åºåˆ—åŒ–çš„ï¼ˆä¸èƒ½å­˜å‡½æ•°ã€Symbol ç­‰ï¼Œ<code>persist</code>Â ä¼šè‡ªåŠ¨å¿½ç•¥ä¸å¯åºåˆ—åŒ–å­—æ®µï¼‰ï¼›</li>
<li>è‹¥ç”¨è‡ªå®šä¹‰å­˜å‚¨ï¼ˆå¦‚ RN AsyncStorageï¼‰ï¼Œæ£€æŸ¥æ˜¯å¦å®‰è£…å¹¶é“¾æ¥ä¾èµ–ã€‚</li>
</ul>
<h4 data-id="heading-10">2. æŒä¹…åŒ–åçŠ¶æ€æ›´æ–°ä¸ç”Ÿæ•ˆï¼Ÿ</h4>
<ul>
<li>ç¡®ä¿ä¿®æ”¹çŠ¶æ€æ—¶ä½¿ç”¨Â <code>set</code>Â æ–¹æ³•ï¼ˆè€Œéç›´æ¥èµ‹å€¼ï¼‰ï¼›</li>
<li>è‹¥æ‰‹åŠ¨ä¿®æ”¹äº† localStorageï¼Œéœ€è°ƒç”¨Â <code>persist.rehydrate()</code>Â é‡æ–°åŠ è½½ã€‚</li>
</ul>
<h4 data-id="heading-11">3. ç±»å‹æŠ¥é”™ï¼ˆTypeScriptï¼‰ï¼Ÿ</h4>
<p>ä¸ºÂ <code>persist</code>Â æ˜¾å¼æŒ‡å®šçŠ¶æ€ç±»å‹</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">CounterState</span> {
  <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-keyword">const</span> useCounterStore = create&lt;<span class="hljs-title class_">CounterState</span>&gt;()(
  <span class="hljs-title function_">persist</span>(
    <span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> ({ <span class="hljs-attr">count</span>: s.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> })),
    }),
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'counter-storage'</span> }
  )
);
</code></pre>
<h3 data-id="heading-12">å››ã€æ€»ç»“</h3>
<p>Zustand æŒä¹…åŒ–çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>æç®€é…ç½®</strong>ï¼šä¸€è¡Œä»£ç å®ç°åŸºç¡€æŒä¹…åŒ–ï¼Œæ— éœ€ç¹ççš„ reducer/action é…ç½®ï¼›</li>
<li><strong>é«˜åº¦çµæ´»</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰å­˜å‚¨ã€åŠ å¯†ã€éƒ¨åˆ†æŒä¹…åŒ–ã€æ‰‹åŠ¨æ§åˆ¶ï¼›</li>
<li><strong>è·¨å¹³å°</strong>ï¼šé€‚é… Webï¼ˆlocalStorage/sessionStorageï¼‰ã€React Nativeï¼ˆAsyncStorageï¼‰ï¼›</li>
<li><strong>æ€§èƒ½å‹å¥½</strong>ï¼šä»…åœ¨çŠ¶æ€å˜æ›´æ—¶è§¦å‘å­˜å‚¨ï¼Œæ— å¤šä½™æ€§èƒ½å¼€é”€ã€‚</li>
</ol>
<p>å®é™…å¼€å‘ä¸­ï¼Œä¼˜å…ˆä½¿ç”¨åŸºç¡€é…ç½®ï¼Œæ•æ„Ÿæ•°æ®åŠ è§£å¯†ï¼Œå¤šåœºæ™¯é€‚é…è‡ªå®šä¹‰å­˜å‚¨å³å¯æ»¡è¶³ 99% çš„éœ€æ±‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Web Worker å‰ç«¯å¤šçº¿ç¨‹è§£æ]]></title>    <link>https://juejin.cn/post/7584695558159663145</link>    <guid>https://juejin.cn/post/7584695558159663145</guid>    <pubDate>2025-12-18T02:05:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584695558159663145" data-draft-id="7584729825384235046" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Web Worker å‰ç«¯å¤šçº¿ç¨‹è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-18T02:05:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äºŒäºŒå››ä¸€"/> <meta itemprop="url" content="https://juejin.cn/user/2975738274777080"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Web Worker å‰ç«¯å¤šçº¿ç¨‹è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2975738274777080/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äºŒäºŒå››ä¸€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T02:05:55.000Z" title="Thu Dec 18 2025 02:05:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body ::selection{color:#fff;background-color:#ed7373}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:.6em;margin-top:1.5em;padding-bottom:4px;color:#ed7373}.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px}.markdown-body h4{font-size:16px}.markdown-body h5,.markdown-body h6{font-size:14px}.markdown-body p{line-height:inherit;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border-top:1px solid #dfe1e6;margin:33px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:rgba(239,198,221,.2666666667);color:#7b164f;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==") 10px 10px no-repeat;background-size:40px;background-color:#fdf8f8}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#fdf8f8}.markdown-body a{position:relative;text-decoration:underline;text-decoration-color:#ffd4d4;color:#ed7373;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAAXNSR0IArs4c6QAAD1lJREFUeF7tnV122zgShQHJG5gT9/OkV2J7JR3voI/U707eI5/eQeyVRFlJa56nc2YDFjkHEulWHP3g5xZYAK5eku6QYOFWfSwUAJLW8EcFqMBJBSy1oQJU4LQCBITRQQXOKEBAGB5UgIAwBqhAnALMIHG68axGFCAgjTia3YxTgIDE6cazGlGAgDTiaHYzTgECEqcbz2pEAQLSiKPZzTgFCEicbjyrEQUISCOOZjfjFCAgcbrxrEYUICCNOJrdjFOAgMTpxrMaUYCANOJodjNOAQISpxvPakQBAtKIo9nNOAUISJxuPKsRBQhII45GdfN/v//+/l9//rlBtae9HQKi3UOZ7ft7sfhgjfm3sfa9u3RvzHtrjPv77r8PfpvemB0o1v3Z95tuNvt29fKyqQkgApI5ADVebgeFtTfGmA8I+3pj1rbv17Ouey4dFgKCiIgC2/i+WDwYax0QbzMDtDcjLC67/PL58xraeIbGCEgGkTVd4vty+QWVKUL75WCZb7f3JWUVAhLq5UKPHzLGRyXmP822208lgEJAlESMlBlDfeGyhsafelAIiMawAdjkpmO38/kXa8wtoDnRJvq+v79+fHwSvUhk4wQkUjjNp/33jz9uZ33/VbONP9nW9x/fPT5+0mYzAdHmkUR7lNUaob1RN+QiIKEuVHz838vl1xKGVOck1DbTRUAUB7yvaSXVG5592sy22zsNs1wExNNjWg+rEI5XqWfb7a9TQ0JAtEa+h101wzF0f/JMQkA8AlHjIQ3AMco+KSQERGP0X7CpITj2Skw4BUxACgOkOThG/0wECQEpCJBm4Rh81Fl7l3tHMAEpBJCJ4Hjq+/7bvOt229THGSVny8vV1W6b/Kzrbnprb088VAVXN/fMFgGBuxDfYE443L4oB0TM9OqwxcVtjJR7xiTzUIuA4OMZ2mI2OICBN+wgfpACJWcWISDQcMY2lgMOt7XjerW6w1q+b03sqUUgzJf6TUAuKTTRv+eAI8f0qdSwK1cWISATAXDusjngyDkj5PrTzedu+z2uNsmURQiIMkBqg2OUVwKSHFmEgCgCpFY4xCDJkEUIiBJAaodjlBlZuEtOMIz2EhAFgLQCxxtIIG9YkR5mEZCJAWkNjldIlsu/EEW79AsfCMiEgLQKx8EaCSKLPL1bre6l3EhApJS90G7LcKCziOQwi4BMAAjh+GGlPTmLSK7pEJDMgBCOfwRHvb9Lsg4hIBkBIRw/i/0dUawLrocQkEyAEI7jQoPeNi9WqBOQDIAQjtMig16uTUAyxLHIJQjHeVkRdYjkijoziAgW+0YJx2VxEYAYYzbvVqtfL18t/AgCEq6Z1xmEw0um3U2km8/dqnrS791qJRLLIo0m9bSCkwmHvxNBgDCD+Es+7ZGEI0x/DrHC9Cr6aMIR7j7ELBaL9HDds59BOOIkB33wh9O8cfLnOYtwxOsM+egPV9LjHSB9JuFIU/j7ctmntSD7cmvOYiV6B3IHPGOD5E7VxK4nnw4q0A03Kya7QqYBwpGmK6j+MFJrIK53zCCRPgZtsjt59Zozh+s0aP3DNSW2BkJAIuFATE2eu3TtcLi+w24wggU6AYkABDVuPnXpFuAAZg8jrReHWAGQIB177LLSzg7oqtih4Dcsig6vmEECw0CyKG8BDic3VEPh4RUBCQAENePSaubY1R2LxYOxNvklDa8aEpCACBY+FLKgdcTGZjLHYvHBWuu+PoX6iQ+vmEE8XQW/8w3XJRyeDjhymOTi4OHlWKRf8JFUYU444uGQXvsgIAG+kcgesXAM6y83/fAhGtv36242+5b708i+8kmtF+XKHhxiTZA9YuDwCLSn2Xb7KebLtL7BHnqch82hTY7HZ6k9xotxiHXGTejsEQXHcvnVGnPrEU2b2XZ7pwESQTjEFwbf6kxAzgGCeOvf2H7ElGQMoDmHH8ekk4RD8snBU2FAQE4oAy7Og594S7p+BIweGeriIZJw5CzMWaRfdDV0UStqzByTPX7oVt9/nHXdc64hV41wsEjPMLyKqTucWZAtGZkyiTAc2esOZpBMs1cpY2bIW89dP4UhkYZj6pqKNcgRWFBb2lO+fAQDxBiTYse5e4k0HMaY4NrNY/QcdAgBOSJX8vjf3biNWV+vVndB3jg4GPZA0b5N+BSwNByp+sXqzmleD+UQgMTWHqN5AgEIg0TAtrdemTxzjAYxgxzLIMul23X6wYOlU4dEzVy9bQw5zNq1DahHpOGYuuZgBvGI+uQZJEAgOjOHWsjB+t7DbK9DUgIQkVnPGZmadb0ECDyIGeR4Bkl6mRnS0WhIYsf2LcLhQoOACACCfk8T+Dnu4BetJa3qe9yxkTcUj8sFHUJAjgPiPugSO6yB1B9vzUJCEppFBLPHprP2Xut2fWaQE/eSxOJYBJDR1ETbXnscUosk12THdVYPBwE5AUhiQIgCAswk3tO+As/ji2oUNIa6cDCHWOBp3tDhS4wzUZD4ZhEkIDn0idH01DkEBAyIaw5dpB9zHqgu8FqQgw3rEncXIAPft60qAXF32JRt3qnBJ7X36a1TUwPX926O2Pbiey3fwM11XBWADGsFv5n9o6m72SfnkJ2Iff98/fj4FCJo6mpxrmnLVJCdJj4wp+pRKhxVFOmeBXXwSw2S7s6glXQfqJPs3N0/+nufG0jCdbyGcT59neKYYjNIxKfPvGdtnCM8wTvpM587M8LhgOGPVwDHTAz4wofQQaqNIgGJgGOvX8CdPXVYEXKtFOcm2+k5zHI2hmx7yTXMTNHO59ziAEne9uAJCeChqaCM5eOsY8cA7PSqQw6vPWSt13rvjV1PnbXPmlfHQ7QuChBEMIQUjAnj7uCMFeI09GxW7N1+54+uuxkmRf4z77p1yuxhigZS5xYDCAKOUUTfdQrELFGOoVZqvRQLiFRQamq3CECQcPhObY5OSs4iATNFsYGRamMNxXSsdpfOUw8IGg4nSMgdE5JFhCEhIJfCPP7fVQOCmKE5Ik3wRrnUABxtkLpTJ9vnOXERH2blnqkWECE4ot42gsoiodnLN6wAmwm91kJ87anpOJWAABa/Tvso8m6ZfJf+xyLo9G/ytPduCqr/+O7x8VNNgY3qizpAROEwJnh4NQodskh20TnAgITUaEB7Lva9sANUAZI6XXlB++Q7N3KohdqKgrApZNKisPhONlcNIMJwBM1cnVMVEZDIWgShGwrW5GhU2IAKQBBOPqct+g4JqUcAwxpI/ZHpAS+Fse9l0qSARG869Ora/iA0HK7NmJ2tP5kMAASUzaLrsgA3FHvopICUljkOvZwKCQJcRCYL2ZtWbJQnGD4ZICXDMeo93MHdO3yD36Hlux/slG8hs1ec4r2IziSAgIYGJzuHuDtfVG44IGr6FzG8An1gNKdWvppqOi47ILA73wkVp3B4ICTJY37gDSbZFk3BLGFLVkBQsy6nhJgCjtEWn5oEMd6HagjIZBJBqanNbIBAHXtEwSnhODRn2EP2MPy/sTaBPWWHrN20aKYJiLe2ZANEcguJVkenvp/rrbOQcEz13XHNMByzLQsgktlDKxzoQADWHXvTOLzyclEWQMB3vteOtQKHxNZ/bi/x4kP+AzpS2YNw+Dn46FHMHt7iiWcQiexBOLz9e+xATu0GyCcKiMSaB+EI8O6xQ5k9ggQUBQSxV+iwN4QjyLfMHslyCX7EE157NHLnkyjIxziRemkEIA7VNiGWQcDTkk28VEAUjgI/XqOBGjFAgMV5E0WlJBxcFIxHTQQQ5PCqhbpDGo7ZdntX2ztz40M+7EwRQICzV9VnD2E4RJ6oDAuxso8WAQRVf9S+2isNB4vydDhlAFku+3TT4t9hBbi2eBPScBhjmpjYkHaUXkAqntaVhgPx3Il04JXSPhwQVIFe6/CKcJSCxt5OrYBUWZwTjrLgEAEEMYNV4xCBcJQHhwggoECoqsAEaXIywmq8oWjBCT7EgkzxVlSgEw4toR5nBwGJ083rLMLhJZPqg/CALJdfjDHubYPxvwoyCOGId7+mM+GAgAKj6BoEpAFrDgWkqASk5KKTcCiIaqAJcEBanuYlHMDIVNIUHJBWV9IJh5KIBpsBB8TZB/gssSlpJyrhAEelouakAPkr5psZb3QpolAnHIqiWcAUEUBQj9tq37BIOAQiUlmTMoAsFh+stW49JO2neD2EcKS5tpSzRQBBzGSNAmrMIoSjlPBOt1MEkKFQR9Qh6t5CTjjSg66kFiQBSd9yMiqpZKhFOEoKbYytYoAgh1muq1MPtQgHJuBKa0UMEOgwa6/qZqr3OxGO0sIaZ68sIIvFg7H2I87c/JBAnm85I0DJ+86AflXblCggAlkkayZBreec8j7hUMvFq2HygOCzyM54ya0obj/Zdj7/Yo25lXIh4ZBSFtuuOCBCWWQPiTHr+XZ7j3zvrHS9Mdp9vVrdYV3J1iQUyAOIUBY5EORptt1+SgFlAMN933z8trmE3juoCYeItCKNZgFEMoscquKCz/b9etZ1zz6wDFDcmP1QShQMZg6R+BVvNBsgw7qIWzwUD8RBtU1vzMb93Q5/DkH63u5tyGXH63CQmUM8nuEXyAbILovID7XgAiEa5LAKoeI0bWQFpEVICMc0gY26anZActUjKIFS2iEcKerpOHcSQIbn1r/mrgNySk44cqotd61JAHHdqRkSwiEXsLlbngwQ19EJZrbE9SUc4hJnvcCkgFQHiZLnVrJGUOUXmxyQUV/pjYHSfmzhc9XSGmpsXw0gBU8Bbzpr73/5/Hmt0cG0KU0BVYAcQOLeDp91pTtGRtYbMaqVdY46QMa6xPb9g+R282Q3sd5IlrCEBlQCMgqndJariDc+lhB8JdioGpDXAn7/IjrxregXHJa8pb6EgKCNPypQBCATg0IwGqamKEB+GHp13U1v7a3Q1vWnvu+/XT8+PjUcG+z6/lGJ8n+uVhmK+nHmK2QGzD0zsnZAzLtu7fOgVfmKsQe+ClQByLHOur1eL1dXO1Bs170C089mm6uXl92DVITBN0zaPa5aQNp1KXuOVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFTg//8JNVC78ovQAAAAAElFTkSuQmCC");background-size:100%}.markdown-body a:active,.markdown-body a:hover{opacity:.66}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #ed7373;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#ed7373}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#fdf2f2}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #ed7373;background-color:#fdf2f2}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ed7373}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]{appearance:none;-webkit-appearance:none;-moz-appearance:none;outline:none;width:16px;height:16px;border-radius:2px;background-color:transparent;box-shadow:inset 0 0 0 1px rgba(28,31,35,.3490196078);vertical-align:middle;margin:0;transform:translateY(-2px)}.markdown-body input[type=checkbox]:checked{background-color:#ed7373;background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjFlbSIgaGVpZ2h0PSIxZW0iIGFyaWEtaGlkZGVuPSJ0cnVlIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE3LjQxMSA3LjMwOGExLjUgMS41IDAgMDEuMjggMi4xMDNsLTYuNSA4LjVhMS41IDEuNSAwIDAxLTIuMzc1LjAxbC0zLjUtNC41YTEuNSAxLjUgMCAxMTIuMzY4LTEuODQybDIuMzA2IDIuOTY1IDUuMzE4LTYuOTU1YTEuNSAxLjUgMCAwMTIuMTAzLS4yOHoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=");box-shadow:inset 0 0 0 1px #ed7373}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">1. Web Worker å®šä¹‰</h2>
<p>Web Worker æ˜¯æµè§ˆå™¨æä¾›çš„å¤šçº¿ç¨‹èƒ½åŠ›ï¼Œå…è®¸åœ¨ä¸»çº¿ç¨‹ä¹‹å¤–è¿è¡Œ JavaScriptã€‚</p>
<p>å®ƒçš„ç›®æ ‡åªæœ‰ä¸€ä¸ªï¼š  ğŸ‘‰ <strong>æŠŠè€—æ—¶ä»»åŠ¡ä» UI çº¿ç¨‹ä¸­æŒªèµ°ï¼Œè®©é¡µé¢ä¿æŒæµç•…ã€‚</strong></p>
<h2 data-id="heading-1">2. Web Worker ä½œç”¨</h2>
<p>è§£å†³ä¸»çº¿ç¨‹çš„ç°å®å›°å¢ƒï¼Œä¸»çº¿ç¨‹åŒæ—¶è´Ÿè´£ï¼š</p>
<ul>
<li>JS æ‰§è¡Œ</li>
<li>é¡µé¢æ¸²æŸ“</li>
<li>ç”¨æˆ·äº¤äº’</li>
<li>äº‹ä»¶å“åº”</li>
</ul>
<p>ä¸€æ—¦é‡åˆ°ğŸ‘‡</p>
<ul>
<li>å¤§é‡è®¡ç®—</li>
<li>JSON è§£æ</li>
<li>æ–‡ä»¶å¤„ç†</li>
<li>å›¾ç‰‡ / è§†é¢‘å¤„ç†</li>
<li>é«˜é¢‘è½®è¯¢ / é•¿æ—¶é—´ä»»åŠ¡</li>
</ul>
<p>ğŸ‘‰ <strong>UI å°±ä¼šå¡ï¼Œé¡µé¢å°±ä¼šâ€œå‡æ­»â€ã€‚</strong></p>
<h2 data-id="heading-2">3. Web Worker çš„å·¥ä½œåŸç†</h2>
<h3 data-id="heading-3">1ï¸âƒ£ çº¿ç¨‹æ¨¡å‹</h3>
<pre><code class="hljs">ä¸»çº¿ç¨‹ï¼ˆUI / Reactï¼‰
   â”‚
   â”œâ”€â”€ postMessage
   â–¼
Worker çº¿ç¨‹ï¼ˆç‹¬ç«‹äº‹ä»¶å¾ªç¯ï¼‰
   â”‚
   â””â”€â”€ postMessage
</code></pre>
<ul>
<li>Worker è¿è¡Œåœ¨ <strong>ç‹¬ç«‹çº¿ç¨‹</strong></li>
<li>æ‹¥æœ‰è‡ªå·±çš„äº‹ä»¶å¾ªç¯</li>
<li><strong>ä¸ä¼šé˜»å¡ UI</strong></li>
</ul>
<h3 data-id="heading-4">2ï¸âƒ£ é€šä¿¡æœºåˆ¶</h3>
<ul>
<li>ä½¿ç”¨ <code>postMessage</code> ä¼ é€’æ¶ˆæ¯</li>
<li>é»˜è®¤é‡‡ç”¨ <strong>structured cloneï¼ˆæ·±æ‹·è´ï¼‰</strong></li>
<li>å¯ä½¿ç”¨ <strong>Transferable</strong>ï¼ˆå¦‚ ArrayBufferï¼‰è½¬ç§»æ‰€æœ‰æƒï¼Œé¿å…æ‹·è´</li>
</ul>
<p>âš ï¸ Worker <strong>ä¸èƒ½è®¿é—® DOM / window / document</strong>ï¼Œä¸»çº¿ç¨‹çš„ä¸Šä¸‹æ–‡</p>
<h2 data-id="heading-5">4. Web Worker çš„ç±»å‹</h2>



































<table><thead><tr><th>ç±»å‹</th><th>åç§°</th><th>ç‰¹ç‚¹</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Dedicated Worker</td><td>ä¸“ç”¨ Worker</td><td>ä¸€å¯¹ä¸€ã€æœ€å¸¸ç”¨</td><td>è®¡ç®—ã€è§£æã€åå°ä»»åŠ¡</td></tr><tr><td>Shared Worker</td><td>å…±äº« Worker</td><td>å¤šé¡µé¢å…±äº«</td><td>å¤šæ ‡ç­¾é¡µå…±äº«çŠ¶æ€</td></tr><tr><td>Service Worker</td><td>service Worker</td><td>æ‹¦æˆªç½‘ç»œè¯·æ±‚</td><td>PWA / ç¦»çº¿ç¼“å­˜</td></tr><tr><td>Worklet</td><td>â€”â€”</td><td>ä½å»¶è¿Ÿ</td><td>éŸ³é¢‘ / æ¸²æŸ“</td></tr></tbody></table>
<p>ğŸ‘‰ <strong>æ—¥å¸¸ä¸šåŠ¡ä¸­ 90% ç”¨ Dedicated Worker</strong></p>
<h2 data-id="heading-6">5. Web Worker çš„ç‰¹ç‚¹</h2>
<ul>
<li>âœ… çœŸæ­£çš„å¹¶è¡Œæ‰§è¡Œ</li>
<li>âœ… é¿å…ä¸»çº¿ç¨‹é˜»å¡</li>
<li>âŒ ä¸èƒ½æ“ä½œ DOM</li>
<li>âŒ åˆ›å»ºå’Œé€šä¿¡æœ‰æˆæœ¬</li>
<li>âš ï¸ æ•°æ®ä¼ è¾“éœ€è¦è€ƒè™‘æ€§èƒ½</li>
</ul>
<h2 data-id="heading-7">6. ä¼˜ç¼ºç‚¹å¯¹ç…§</h2>
<ol>
<li>âœ… ä¼˜ç‚¹</li>
</ol>
<ul>
<li>æå‡é¡µé¢å“åº”é€Ÿåº¦</li>
<li>é€‚åˆ CPU å¯†é›†å‹ä»»åŠ¡</li>
<li>å¯ä½œä¸ºåå°â€œè®¡ç®—å¼•æ“â€</li>
<li>å¯å‘é€å¼‚æ­¥è¯·æ±‚</li>
<li>å¯è¿è¡Œ fetch / WebSocket / IndexedDB</li>
</ul>
<ol start="2">
<li>âŒ ç¼ºç‚¹</li>
</ol>
<ul>
<li>æ— æ³•æ“ä½œ DOM</li>
<li>é€šä¿¡å­˜åœ¨æ•°æ®æ‹·è´æˆæœ¬</li>
<li>åˆ›å»º/é”€æ¯å¼€é”€ä¸å°</li>
<li>è°ƒè¯•ã€æ‰“åŒ…éœ€è¦é¢å¤–é…ç½®</li>
</ul>
<h2 data-id="heading-8">7. React ä¸­å¦‚ä½•ä¼˜é›…ä½¿ç”¨ Web Worker</h2>
<ol>
<li>âŒ å¸¸è§è¯¯åŒº</li>
</ol>
<ul>
<li>æ¯ä¸ªç»„ä»¶ new ä¸€ä¸ª Worker</li>
<li>Worker ç”Ÿå‘½å‘¨æœŸä¸æ¸…ç†</li>
<li>ä¸»çº¿ç¨‹/Worker å¼ºè€¦åˆ</li>
</ul>
<ol start="2">
<li>âœ… æ¨èæ¨¡å¼ï¼šHook + å•ä¾‹ Worker</li>
</ol>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">const</span> { post } = useWorker() <span class="hljs-comment">// React Hook åº“</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> post(<span class="hljs-string">'compute'</span>, payload)

</code></pre>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>Worker åªåˆ›å»ºä¸€æ¬¡</li>
<li>Promise åŒ–è°ƒç”¨</li>
<li>ç»„ä»¶åªå…³å¿ƒç»“æœ</li>
</ul>
<blockquote>
<p>Web Worker æ˜¯å…¨å±€èµ„æºï¼Œè€Œä¸æ˜¯ç»„ä»¶èµ„æºã€‚</p>
</blockquote>
<h2 data-id="heading-9">8. å…¸å‹é€‚ç”¨åœºæ™¯</h2>
<ol>
<li>ğŸ”¥ å¼ºçƒˆæ¨èä½¿ç”¨</li>
</ol>
<ul>
<li>å¤§æ•°æ®è®¡ç®— / æ’åº / è¿‡æ»¤</li>
<li>å›¾ç‰‡å¤„ç†ã€å‹ç¼©ã€æ»¤é•œ</li>
<li>è§†é¢‘è½¬ç ã€éŸ³é¢‘åˆ†æ</li>
<li>æ–‡ä»¶è§£æï¼ˆCSV / Excel / JSONï¼‰</li>
<li>åŠ å¯†ã€è§£å¯†ã€å“ˆå¸Œè®¡ç®—</li>
</ul>
<ol start="2">
<li>âš ï¸ è°¨æ…ä½¿ç”¨</li>
</ol>
<ul>
<li>è½»é‡é€»è¾‘</li>
<li>é«˜é¢‘çŸ­ä»»åŠ¡</li>
<li>å¼ºä¾èµ– DOM çš„æ“ä½œ</li>
</ul>
<h2 data-id="heading-10">10. Web Worker + WebSocketï¼ˆå·¥ç¨‹è¿›é˜¶ï¼‰</h2>
<p>ä¸€ä¸ªéå¸¸å®ç”¨çš„ç»„åˆï¼š</p>
<ul>
<li>Worker é‡Œç»´æŠ¤ WebSocket</li>
<li>å¤„ç†å¿ƒè·³ / é‡è¿ / è§£æ</li>
<li>ä¸»çº¿ç¨‹åªè´Ÿè´£ UI æ¸²æŸ“</li>
</ul>
<p>ä¼˜åŠ¿ï¼š</p>
<ul>
<li>UI ä¸å—ç½‘ç»œæŠ–åŠ¨å½±å“</li>
<li>è¿æ¥é€»è¾‘é«˜åº¦è§£è€¦</li>
<li>æ›´ç¨³å®šçš„å®æ—¶é€šä¿¡</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ React UI   â”‚
â”‚            â”‚
â”‚ è®¢é˜…æ•°æ®   â”‚
â”‚ postMessageâ”‚
â””â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ structured <span class="hljs-built_in">clone</span>
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Web Worker â”‚
â”‚            â”‚
â”‚ WebSocket  â”‚
â”‚ å¿ƒè·³/é‡è¿  â”‚
â”‚ é™æµ/èšåˆ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript Date çš„é‚£äº›äº‹]]></title>    <link>https://juejin.cn/post/7584702863689547791</link>    <guid>https://juejin.cn/post/7584702863689547791</guid>    <pubDate>2025-12-18T02:11:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584702863689547791" data-draft-id="7584689488771039267" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript Date çš„é‚£äº›äº‹"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-18T02:11:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="paradeå²æœˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3773179639113831"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript Date çš„é‚£äº›äº‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3773179639113831/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    paradeå²æœˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T02:11:02.000Z" title="Thu Dec 18 2025 02:11:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ—¶é—´çš„"é•¿ç›¸"ï¼šä½ çœ‹åˆ°çš„æ—¶é—´æœ‰å“ªäº›å½¢å¼?</h2>
<p>åœ¨ä»£ç ä¸­,æ—¶é—´é€šå¸¸ä»¥ä¸¤ç§å½¢å¼å­˜åœ¨:<strong>æ—¶é—´æˆ³</strong>å’Œ<strong>å­—ç¬¦ä¸²</strong>ã€‚</p>
<h3 data-id="heading-1">1.1 æ—¶é—´æˆ³ (Timestamp)</h3>
<p>æ—¶é—´æˆ³æ˜¯ä¸€ä¸ªæ•°å­—,è¡¨ç¤ºä» <strong>1970 å¹´ 1 æœˆ 1 æ—¥ 00:00:00 UTC</strong>(ç§°ä¸º Unix çºªå…ƒ)åˆ°æŸä¸ªæ—¶åˆ»ç»è¿‡çš„æ—¶é—´ã€‚</p>
<h4 data-id="heading-2">ç§’çº§ vs æ¯«ç§’çº§</h4>
<ul>
<li><strong>ç§’çº§æ—¶é—´æˆ³</strong>:Unix/Linux ç³»ç»Ÿå¸¸ç”¨,å¦‚ <code>1734345000</code></li>
<li><strong>æ¯«ç§’çº§æ—¶é—´æˆ³</strong>:JavaScript ä½¿ç”¨çš„æ˜¯è¿™ç§,å¦‚ <code>1734345000000</code></li>
</ul>
<blockquote>
<p><strong>ğŸ’¡ æç¤º</strong>:ä¸¤è€…å·® 1000 å€,ä½æ•°ç›¸å·® 3 ä½ã€‚ç§’çº§ 10 ä½æ•°,æ¯«ç§’çº§ 13 ä½æ•°ã€‚</p>
</blockquote>
<h4 data-id="heading-3">è·å–æ—¶é—´æˆ³çš„æ–¹å¼</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·å–å½“å‰æ—¶é—´çš„æ¯«ç§’çº§æ—¶é—´æˆ³</span>
<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() <span class="hljs-comment">// âœ… æ¨è,ç®€æ´é«˜æ•ˆ</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>() <span class="hljs-comment">// ç­‰ä»·,ä½†å¤šåˆ›å»ºäº†ä¸€ä¸ª Date å¯¹è±¡</span>
+<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>() <span class="hljs-comment">// éšå¼è½¬æ¢,ä¸æ¨è(å¯è¯»æ€§å·®)</span>

<span class="hljs-comment">// ç¤ºä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()) <span class="hljs-comment">// 1734345000000</span>
</code></pre>
<h3 data-id="heading-4">1.2 å­—ç¬¦ä¸²å½¢å¼</h3>
<p>æ—¶é—´å­—ç¬¦ä¸²æœ‰å¤šç§æ ¼å¼æ ‡å‡†,äº†è§£å®ƒä»¬èƒ½å¸®ä½ é¿å…å¾ˆå¤šè§£æé—®é¢˜ã€‚</p>
<h4 data-id="heading-5">ISO 8601 æ ‡å‡†(æ¨è)</h4>
<p>å›½é™…æ ‡å‡†åŒ–ç»„ç»‡åˆ¶å®šçš„æ ¼å¼,<strong>è·¨å¹³å°ã€è·¨è¯­è¨€é€šç”¨</strong>ã€‚</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">2025-12-16T10:30:00.000Z</span>
â”‚    â”‚  â”‚ â”‚ â”‚  â”‚  â”‚   â””â”€â”€ Z è¡¨ç¤º UTC æ—¶åŒº(ä¹Ÿå¯ä»¥æ˜¯ +08:00)
â”‚    â”‚  â”‚ â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€ æ¯«ç§’
â”‚    â”‚  â”‚ â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç§’
â”‚    â”‚  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†
â”‚    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ—¶
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ—¥
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœˆ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¹´
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ISO å­—ç¬¦ä¸²ç¤ºä¾‹</span>
<span class="hljs-string">'2025-12-16'</span> <span class="hljs-comment">// åªæœ‰æ—¥æœŸéƒ¨åˆ†</span>
<span class="hljs-string">'2025-12-16T10:30:00'</span> <span class="hljs-comment">// ä¸å¸¦æ—¶åŒº(ä¼šè¢«å½“ä½œæœ¬åœ°æ—¶é—´)</span>
<span class="hljs-string">'2025-12-16T10:30:00Z'</span> <span class="hljs-comment">// UTC æ—¶é—´</span>
<span class="hljs-string">'2025-12-16T10:30:00+08:00'</span> <span class="hljs-comment">// å¸¦æ—¶åŒºåç§»(ä¸œå…«åŒº)</span>
</code></pre>
<h4 data-id="heading-6">RFC 2822 æ ‡å‡†</h4>
<p>å¸¸è§äºé‚®ä»¶å¤´ã€HTTP å“åº”å¤´ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-string">'Mon, 16 Dec 2025 10:30:00 GMT'</span>
<span class="hljs-string">'Tue, 16 Dec 2025 18:30:00 +0800'</span>
</code></pre>
<h4 data-id="heading-7">æœ¬åœ°åŒ–å­—ç¬¦ä¸²</h4>
<p>å› åœ°åŒºã€è¯­è¨€è€Œå¼‚,<strong>ä¸å»ºè®®ç”¨äºæ•°æ®ä¼ è¾“</strong>,ä»…ç”¨äºå±•ç¤ºã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-string">'2025å¹´12æœˆ16æ—¥'</span> <span class="hljs-comment">// ä¸­æ–‡</span>
<span class="hljs-string">'12/16/2025'</span> <span class="hljs-comment">// ç¾å¼(æœˆ/æ—¥/å¹´)</span>
<span class="hljs-string">'16/12/2025'</span> <span class="hljs-comment">// æ¬§å¼(æ—¥/æœˆ/å¹´)</span>
<span class="hljs-string">'December 16, 2025'</span> <span class="hljs-comment">// è‹±æ–‡</span>
</code></pre>
<h4 data-id="heading-8">å„æ ¼å¼é€‚ç”¨åœºæ™¯</h4>






























<table><thead><tr><th>æ ¼å¼</th><th>é€‚ç”¨åœºæ™¯</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>æ—¶é—´æˆ³</td><td>å­˜å‚¨ã€è®¡ç®—ã€æ¥å£ä¼ è¾“</td><td>æœ€é€šç”¨,æ— æ­§ä¹‰</td></tr><tr><td>ISO 8601</td><td>æ¥å£ä¼ è¾“ã€æ—¥å¿—ã€æ•°æ®åº“</td><td>æ ‡å‡†æ ¼å¼,å¼ºçƒˆæ¨è</td></tr><tr><td>RFC 2822</td><td>é‚®ä»¶ã€HTTP å¤´</td><td>ç‰¹å®šåè®®ä½¿ç”¨</td></tr><tr><td>æœ¬åœ°åŒ–å­—ç¬¦ä¸²</td><td>ä»…ç”¨äº UI å±•ç¤º</td><td>å±•ç¤ºå‹å¥½,ä½†ä¸èƒ½ç”¨äºä¼ è¾“</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-9">äºŒã€åˆ›å»º Date å¯¹è±¡çš„å‡ ç§æ–¹å¼</h2>
<h3 data-id="heading-10">2.1 æ— å‚æ„é€ :è·å–å½“å‰æ—¶é—´</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(now) <span class="hljs-comment">// Mon Dec 16 2024 18:30:00 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)</span>
</code></pre>
<h3 data-id="heading-11">2.2 æ—¶é—´æˆ³æ„é€ </h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¯«ç§’çº§æ—¶é—´æˆ³</span>
<span class="hljs-keyword">const</span> date1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">1734345000000</span>)

<span class="hljs-comment">// âš ï¸ å¦‚æœåç«¯è¿”å›ç§’çº§æ—¶é—´æˆ³,è®°å¾—ä¹˜ 1000</span>
<span class="hljs-keyword">const</span> backendTimestamp = <span class="hljs-number">1734345000</span> <span class="hljs-comment">// ç§’çº§</span>
<span class="hljs-keyword">const</span> date2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(backendTimestamp * <span class="hljs-number">1000</span>)
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ å¸¸è§é”™è¯¯</strong>:å¿˜è®°è½¬æ¢ç§’çº§æ—¶é—´æˆ³,å¯¼è‡´æ—¥æœŸæ˜¾ç¤ºä¸º 1970 å¹´ã€‚</p>
</blockquote>
<h3 data-id="heading-12">2.3 å­—ç¬¦ä¸²æ„é€ (é‡ç‚¹:å¯é æ€§é—®é¢˜)</h3>
<h4 data-id="heading-13">âœ… ISO æ ¼å¼æœ€å¯é </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿™äº›åœ¨æ‰€æœ‰ç°ä»£æµè§ˆå™¨ä¸­è¡¨ç°ä¸€è‡´</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16T10:30:00.000Z'</span>) <span class="hljs-comment">// UTC æ—¶é—´</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16T10:30:00+08:00'</span>) <span class="hljs-comment">// å¸¦æ—¶åŒº</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16T10:30:00'</span>) <span class="hljs-comment">// æœ¬åœ°æ—¶é—´</span>
</code></pre>
<h4 data-id="heading-14">âš ï¸ ä¸å¯é çš„å­—ç¬¦ä¸²æ ¼å¼</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. çº¯æ—¥æœŸå­—ç¬¦ä¸² - æ—¶åŒºè¡Œä¸ºä¸ä¸€è‡´!</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16'</span>)
<span class="hljs-comment">// Chrome/Firefox: å½“ä½œ UTC 00:00:00,è½¬æœ¬åœ°æ—¶é—´æ˜¯ 08:00:00</span>
<span class="hljs-comment">// Safari/iOS Safari: å½“ä½œæœ¬åœ°æ—¶é—´ 00:00:00</span>
<span class="hljs-comment">// ç»“æœ: åŒä¸€ä¸ªå­—ç¬¦ä¸²,ä¸åŒæµè§ˆå™¨å¯èƒ½ç›¸å·® 8 å°æ—¶!</span>

<span class="hljs-comment">// 2. æ–œæ åˆ†éš” - éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒ</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025/12/16'</span>) <span class="hljs-comment">// å¤§éƒ¨åˆ†æµè§ˆå™¨ OK,ä½†ä¸æ˜¯æ ‡å‡†</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'12/16/2025'</span>) <span class="hljs-comment">// ç¾å¼æ ¼å¼,ä¾èµ–æµè§ˆå™¨å®ç°</span>

<span class="hljs-comment">// 3. å…¶ä»–æ ¼å¼ - ç»“æœä¸å¯é¢„æµ‹</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'16-12-2025'</span>) <span class="hljs-comment">// âŒ å¯èƒ½è¿”å› Invalid Date</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'12-16-2025'</span>) <span class="hljs-comment">// âŒ ä¸åŒæµè§ˆå™¨è§£æä¸åŒ</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'December 16, 2025'</span>) <span class="hljs-comment">// âš ï¸ èƒ½ç”¨,ä½†ä¾èµ–è‹±æ–‡ç¯å¢ƒ</span>

<span class="hljs-comment">// 4. å¸¦ä¸­æ–‡ - å®Œå…¨ä¸æ”¯æŒ</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025å¹´12æœˆ16æ—¥'</span>) <span class="hljs-comment">// âŒ Invalid Date</span>
</code></pre>
<h4 data-id="heading-15">ğŸ’¡ æœ€ä½³å®è·µ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¦‚æœæ‹¿åˆ°éæ ‡å‡†æ ¼å¼,å…ˆè½¬æˆ ISO æˆ–æ—¶é—´æˆ³</span>
<span class="hljs-keyword">const</span> dateStr = <span class="hljs-string">'16/12/2025'</span> <span class="hljs-comment">// æ¬§å¼æ ¼å¼</span>
<span class="hljs-keyword">const</span> [day, month, year] = dateStr.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>)
<span class="hljs-keyword">const</span> safeDate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">`<span class="hljs-subst">${year}</span>-<span class="hljs-subst">${month.padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>-<span class="hljs-subst">${day.padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>`</span>)

<span class="hljs-comment">// æˆ–è€…ä½¿ç”¨æ—¥æœŸåº“(å¦‚ Day.js)å¤„ç†</span>
</code></pre>
<h3 data-id="heading-16">2.4 æ—¶é—´åˆ†é‡æ„é€ (æœˆä»½å‘ç‚¹é¢„å‘Š)</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// new Date(year, monthIndex, day, hours, minutes, seconds, ms)</span>
<span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">11</span>, <span class="hljs-number">16</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>, <span class="hljs-number">0</span>)
<span class="hljs-comment">//                         â†‘</span>
<span class="hljs-comment">//                    æ³¨æ„: 11 è¡¨ç¤º 12 æœˆ!</span>
</code></pre>
<p>è¿™å°±å¼•å‡ºäº†ä¸‹ä¸€ç« çš„é‡ç‚¹â€”â€”æœˆä»½ä» 0 å¼€å§‹çš„é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-17">ä¸‰ã€æœˆä»½ä» 0 å¼€å§‹:åˆ°åº•æ˜¯å“ªé‡Œçš„å‘?</h2>
<p>è¿™æ˜¯ JavaScript Date æœ€è‡­åæ˜­è‘—çš„è®¾è®¡ä¹‹ä¸€ã€‚ä½†å¾ˆå¤šäººå¯¹å®ƒæœ‰è¯¯è§£,è®©æˆ‘ä»¬æ¥æ¾„æ¸…ã€‚</p>
<h3 data-id="heading-18">3.1 æ¾„æ¸…è¯¯åŒº:å­—ç¬¦ä¸²æ„é€ ä¸å—å½±å“</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… å­—ç¬¦ä¸²ä¸­çš„ 12 å°±æ˜¯ 12 æœˆ,æ²¡æœ‰ä»»ä½•é—®é¢˜</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16'</span>) <span class="hljs-comment">// 12 æœˆ 16 æ—¥</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16T10:30'</span>) <span class="hljs-comment">// 12 æœˆ 16 æ—¥ 10:30</span>

<span class="hljs-comment">// âœ… ISO å­—ç¬¦ä¸²ä¸­çš„æœˆä»½æ˜¯æ­£å¸¸çš„ 1-12</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-01-01'</span>) <span class="hljs-comment">// 1 æœˆ 1 æ—¥</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-31'</span>) <span class="hljs-comment">// 12 æœˆ 31 æ—¥</span>
</code></pre>
<h3 data-id="heading-19">3.2 çœŸæ­£çš„å‘ç‚¹:æ—¶é—´åˆ†é‡æ„é€ å’Œ getter/setter</h3>
<h4 data-id="heading-20">å‘ç‚¹ 1:æ—¶é—´åˆ†é‡æ„é€ </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ å¸¸è§é”™è¯¯: ç¬¬äºŒä¸ªå‚æ•°ä»¥ä¸ºæ˜¯æœˆä»½(1-12)</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">12</span>, <span class="hljs-number">16</span>) <span class="hljs-comment">// é”™è¯¯! è¿™æ˜¯ 2026 å¹´ 1 æœˆ 16 æ—¥</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)   <span class="hljs-comment">// é”™è¯¯! è¿™æ˜¯ 2 æœˆ 1 æ—¥,ä¸æ˜¯ 1 æœˆ</span>

<span class="hljs-comment">// âœ… æ­£ç¡®å†™æ³•: ç¬¬äºŒä¸ªå‚æ•°æ˜¯ monthIndex(0-11)</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">11</span>, <span class="hljs-number">16</span>) <span class="hljs-comment">// 2025 å¹´ 12 æœˆ 16 æ—¥</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)   <span class="hljs-comment">// 2025 å¹´ 1 æœˆ 1 æ—¥</span>
</code></pre>
<h4 data-id="heading-21">å‘ç‚¹ 2:getMonth() è¿”å› 0-11</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(date.<span class="hljs-title function_">getMonth</span>()) <span class="hljs-comment">// 11,ä¸æ˜¯ 12!</span>

<span class="hljs-comment">// âœ… æƒ³è¦å¾—åˆ°æ­£å¸¸æœˆä»½,éœ€è¦ +1</span>
<span class="hljs-keyword">const</span> month = date.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span> <span class="hljs-comment">// 12</span>

<span class="hljs-comment">// âŒ å¸¸è§é”™è¯¯: å¿˜è®° +1</span>
<span class="hljs-keyword">const</span> wrongMonth = date.<span class="hljs-title function_">getMonth</span>() <span class="hljs-comment">// 11 (é”™è¯¯!)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰æœˆä»½æ˜¯ <span class="hljs-subst">${wrongMonth}</span> æœˆ`</span>) <span class="hljs-comment">// "å½“å‰æœˆä»½æ˜¯ 11 æœˆ"(å®é™…æ˜¯ 12 æœˆ)</span>
</code></pre>
<h4 data-id="heading-22">å‘ç‚¹ 3:setMonth() åŒæ ·æ˜¯ 0-11</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-06-16'</span>)

<span class="hljs-comment">// âŒ é”™è¯¯: ä»¥ä¸ºæ˜¯è®¾ç½®ä¸º 12 æœˆ</span>
date.<span class="hljs-title function_">setMonth</span>(<span class="hljs-number">12</span>) <span class="hljs-comment">// å®é™…è®¾ç½®ä¸ºä¸‹ä¸€å¹´ 1 æœˆ!</span>

<span class="hljs-comment">// âœ… æ­£ç¡®: è®¾ç½®ä¸º 12 æœˆ</span>
date.<span class="hljs-title function_">setMonth</span>(<span class="hljs-number">11</span>)
</code></pre>
<h3 data-id="heading-23">3.3 ä¸ºä»€ä¹ˆè®¾è®¡æˆè¿™æ ·?</h3>
<p>è¿™æ˜¯å†å²é—ç•™é—®é¢˜ã€‚JavaScript çš„ Date å¯¹è±¡è®¾è®¡å€Ÿé‰´äº† Java çš„ <code>java.util.Date</code>(Java åæ¥ä¹ŸåºŸå¼ƒäº†è¿™ä¸ªç±»)ã€‚</p>
<p>å¯èƒ½çš„åŸå› :</p>
<ol>
<li><strong>æ•°ç»„ç´¢å¼•æ€ç»´</strong>:æœˆä»½å¯ä»¥ç›´æ¥ä½œä¸ºæœˆä»½åç§°æ•°ç»„çš„ç´¢å¼•</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> months = [<span class="hljs-string">'January'</span>, <span class="hljs-string">'February'</span>, <span class="hljs-string">'March'</span>, <span class="hljs-string">'April'</span>, <span class="hljs-string">'May'</span>, <span class="hljs-string">'June'</span>,
                <span class="hljs-string">'July'</span>, <span class="hljs-string">'August'</span>, <span class="hljs-string">'September'</span>, <span class="hljs-string">'October'</span>, <span class="hljs-string">'November'</span>, <span class="hljs-string">'December'</span>]
<span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(months[date.<span class="hljs-title function_">getMonth</span>()]) <span class="hljs-comment">// ç›´æ¥å–æœˆä»½å,æ— éœ€ -1</span>
</code></pre>
<ol start="2">
<li><strong>æ—©æœŸè®¾è®¡ä»“ä¿ƒ</strong>:JavaScript åªç”¨äº† 10 å¤©è®¾è®¡å‡ºæ¥,å¾ˆå¤šå†³ç­–æ²¡æœ‰æ·±æ€ç†Ÿè™‘</li>
</ol>
<h3 data-id="heading-24">3.4 è®°å¿†å£è¯€</h3>
<blockquote>
<p><strong>å­—ç¬¦ä¸²æœˆä»½æ­£å¸¸å†™,åˆ†é‡æ„é€ å’Œ getter è¦å‡ä¸€(æˆ–ä» 0 å¼€å§‹)ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-25">å››ã€Date çš„å…¶ä»–å¸¸è§å‘</h2>
<h3 data-id="heading-26">4.1 æ—¶åŒºé—®é¢˜:æœ¬åœ°æ—¶é—´ vs UTC æ—¶é—´</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16T00:00:00Z'</span>) <span class="hljs-comment">// UTC æ—¶é—´åˆå¤œ</span>

<span class="hljs-comment">// æœ¬åœ°æ—¶é—´æ–¹æ³•(å—æ—¶åŒºå½±å“)</span>
date.<span class="hljs-title function_">getHours</span>() <span class="hljs-comment">// 8 (åŒ—äº¬æ—¶é—´ +8 å°æ—¶)</span>
date.<span class="hljs-title function_">getDate</span>() <span class="hljs-comment">// 16</span>
date.<span class="hljs-title function_">getDay</span>() <span class="hljs-comment">// 2 (å‘¨äºŒ)</span>

<span class="hljs-comment">// UTC æ—¶é—´æ–¹æ³•(ä¸å—æ—¶åŒºå½±å“)</span>
date.<span class="hljs-title function_">getUTCHours</span>() <span class="hljs-comment">// 0</span>
date.<span class="hljs-title function_">getUTCDate</span>() <span class="hljs-comment">// 16</span>
date.<span class="hljs-title function_">getUTCDay</span>() <span class="hljs-comment">// 2</span>

<span class="hljs-comment">// toString ä¹Ÿä¸åŒ</span>
date.<span class="hljs-title function_">toString</span>() 
<span class="hljs-comment">// "Tue Dec 16 2025 08:00:00 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)"</span>

date.<span class="hljs-title function_">toISOString</span>() 
<span class="hljs-comment">// "2025-12-16T00:00:00.000Z"</span>

date.<span class="hljs-title function_">toUTCString</span>() 
<span class="hljs-comment">// "Tue, 16 Dec 2025 00:00:00 GMT"</span>
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ æç¤º</strong>:æ¶‰åŠè·¨æ—¶åŒºåœºæ™¯æ—¶,ç»Ÿä¸€ä½¿ç”¨ UTC æ—¶é—´,é¿å…æ··ä¹±ã€‚</p>
</blockquote>
<h3 data-id="heading-27">4.2 æœˆæœ«æº¢å‡º:è‡ªåŠ¨è¿›ä½</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Date ä¼šè‡ªåŠ¨å¤„ç†æº¢å‡º,è¿™æœ‰æ—¶æ˜¯ feature,æœ‰æ—¶æ˜¯ bug</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">0</span>, <span class="hljs-number">32</span>) <span class="hljs-comment">// 1 æœˆ 32 æ—¥ â†’ 2 æœˆ 1 æ—¥</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">1</span>, <span class="hljs-number">30</span>) <span class="hljs-comment">// 2 æœˆ 30 æ—¥ â†’ 3 æœˆ 2 æ—¥(2025 éé—°å¹´)</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">11</span>, <span class="hljs-number">32</span>) <span class="hljs-comment">// 12 æœˆ 32 æ—¥ â†’ 2026 å¹´ 1 æœˆ 1 æ—¥</span>

<span class="hljs-comment">// âœ… åˆ©ç”¨è¿™ä¸ªç‰¹æ€§è·å–æŸæœˆæœ€åä¸€å¤©</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getLastDayOfMonth</span>(<span class="hljs-params">year, month</span>) {
  <span class="hljs-comment">// month æ˜¯ 1-12,æ‰€ä»¥ month ä½œä¸º monthIndex å°±æ˜¯ä¸‹ä¸ªæœˆ</span>
  <span class="hljs-comment">// day ä¼  0 è¡¨ç¤ºä¸Šä¸ªæœˆæœ€åä¸€å¤©</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(year, month, <span class="hljs-number">0</span>).<span class="hljs-title function_">getDate</span>()
}

<span class="hljs-title function_">getLastDayOfMonth</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// 28 (2 æœˆæœ€åä¸€å¤©)</span>
<span class="hljs-title function_">getLastDayOfMonth</span>(<span class="hljs-number">2024</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// 29 (2024 æ˜¯é—°å¹´)</span>
<span class="hljs-title function_">getLastDayOfMonth</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">12</span>) <span class="hljs-comment">// 31 (12 æœˆæœ€åä¸€å¤©)</span>
</code></pre>
<h4 data-id="heading-28">æ›´å¤šç‰¹æ®Šå‚æ•°ç”¨æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// day ä¼  0: ä¸Šä¸ªæœˆæœ€åä¸€å¤©</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>) <span class="hljs-comment">// 2025-02-28 (2 æœˆæœ€åä¸€å¤©)</span>

<span class="hljs-comment">// day ä¼ è´Ÿæ•°: å¾€å‰æ¨</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">2</span>, -<span class="hljs-number">1</span>) <span class="hljs-comment">// 2025-02-27 (2 æœˆå€’æ•°ç¬¬äºŒå¤©)</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) <span class="hljs-comment">// 2024-12-31 (å»å¹´æœ€åä¸€å¤©)</span>

<span class="hljs-comment">// è·å–ä¸Šä¸ªæœˆåŒä¸€å¤©</span>
<span class="hljs-keyword">const</span> today = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>) <span class="hljs-comment">// 3 æœˆ 15 æ—¥</span>
<span class="hljs-keyword">const</span> lastMonth = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">1</span>, <span class="hljs-number">15</span>) <span class="hljs-comment">// 2 æœˆ 15 æ—¥</span>

<span class="hljs-comment">// è·å–ä¸‹ä¸ªæœˆç¬¬ä¸€å¤©</span>
<span class="hljs-keyword">const</span> nextMonthFirst = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2025</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>) <span class="hljs-comment">// 4 æœˆ 1 æ—¥</span>

<span class="hljs-comment">// âœ… åˆ¤æ–­æ˜¯å¦ä¸ºé—°å¹´</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isLeapYear</span>(<span class="hljs-params">year</span>) {
  <span class="hljs-comment">// 2 æœˆ 29 æ—¥å¦‚æœå­˜åœ¨,å°±æ˜¯é—°å¹´</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(year, <span class="hljs-number">1</span>, <span class="hljs-number">29</span>).<span class="hljs-title function_">getDate</span>() === <span class="hljs-number">29</span>
}

<span class="hljs-title function_">isLeapYear</span>(<span class="hljs-number">2024</span>) <span class="hljs-comment">// true</span>
<span class="hljs-title function_">isLeapYear</span>(<span class="hljs-number">2025</span>) <span class="hljs-comment">// false</span>
</code></pre>
<h3 data-id="heading-29">4.3 Invalid Date:å¦‚ä½•åˆ¤æ–­æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> valid = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16'</span>)
<span class="hljs-keyword">const</span> invalid = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'not a date'</span>)

<span class="hljs-comment">// âœ… æ–¹æ³• 1: æ£€æŸ¥ getTime() æ˜¯å¦ä¸º NaN (æ¨è)</span>
<span class="hljs-built_in">isNaN</span>(valid.<span class="hljs-title function_">getTime</span>()) <span class="hljs-comment">// false</span>
<span class="hljs-built_in">isNaN</span>(invalid.<span class="hljs-title function_">getTime</span>()) <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æ–¹æ³• 2: è½¬å­—ç¬¦ä¸²æ£€æŸ¥</span>
invalid.<span class="hljs-title function_">toString</span>() <span class="hljs-comment">// "Invalid Date"</span>

<span class="hljs-comment">// æ–¹æ³• 3: ä½¿ç”¨ valueOf()</span>
<span class="hljs-built_in">isNaN</span>(invalid.<span class="hljs-title function_">valueOf</span>()) <span class="hljs-comment">// true</span>

<span class="hljs-comment">// âœ… å°è£…æˆå‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isValidDate</span>(<span class="hljs-params">date</span>) {
  <span class="hljs-keyword">return</span> date <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span> &amp;&amp; !<span class="hljs-built_in">isNaN</span>(date.<span class="hljs-title function_">getTime</span>())
}

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-title function_">isValidDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) <span class="hljs-comment">// true</span>
<span class="hljs-title function_">isValidDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'invalid'</span>)) <span class="hljs-comment">// false</span>
<span class="hljs-title function_">isValidDate</span>(<span class="hljs-string">'2025-12-16'</span>) <span class="hljs-comment">// false (ä¸æ˜¯ Date å¯¹è±¡)</span>
</code></pre>
<h3 data-id="heading-30">4.4 Date å¯¹è±¡æ¯”è¾ƒçš„é™·é˜±</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> date1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16'</span>)
<span class="hljs-keyword">const</span> date2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16'</span>)

<span class="hljs-comment">// âŒ é”™è¯¯: ç›´æ¥æ¯”è¾ƒä¼šæ¯”è¾ƒå¼•ç”¨,è€Œéå€¼</span>
date1 == date2 <span class="hljs-comment">// false</span>
date1 === date2 <span class="hljs-comment">// false</span>

<span class="hljs-comment">// âœ… æ­£ç¡®: è½¬æˆæ—¶é—´æˆ³æ¯”è¾ƒ</span>
date1.<span class="hljs-title function_">getTime</span>() === date2.<span class="hljs-title function_">getTime</span>() <span class="hljs-comment">// true</span>
+date1 === +date2 <span class="hljs-comment">// true (éšå¼è½¬æ¢)</span>

<span class="hljs-comment">// âœ… æ¯”è¾ƒå¤§å°(å¯ä»¥ç›´æ¥æ¯”è¾ƒ,ä¼šè‡ªåŠ¨è½¬æ—¶é—´æˆ³)</span>
date1 &gt; date2 <span class="hljs-comment">// false</span>
date1 &lt; date2 <span class="hljs-comment">// false</span>
date1 &gt;= date2 <span class="hljs-comment">// true</span>

<span class="hljs-comment">// å®é™…åº”ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> deadline = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-31'</span>)
<span class="hljs-keyword">const</span> today = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
<span class="hljs-keyword">if</span> (today &gt; deadline) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å·²è¿‡æœŸ'</span>)
}
</code></pre>
<h3 data-id="heading-31">4.5 æ—¶é—´æˆ³ç²¾åº¦é—®é¢˜</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// JavaScript çš„ Number ç±»å‹æ˜¯ 64 ä½æµ®ç‚¹æ•°</span>
<span class="hljs-comment">// å®‰å…¨æ•´æ•°èŒƒå›´: -(2^53 - 1) åˆ° (2^53 - 1)</span>
<span class="hljs-title class_">Number</span>.<span class="hljs-property">MAX_SAFE_INTEGER</span> <span class="hljs-comment">// 9007199254740991</span>

<span class="hljs-comment">// å¯¹äºæ—¶é—´æˆ³æ¥è¯´:</span>
<span class="hljs-comment">// æ¯«ç§’çº§æ—¶é—´æˆ³åœ¨ 2287 å¹´ä¹‹å‰éƒ½æ˜¯å®‰å…¨çš„</span>
<span class="hljs-keyword">const</span> year2287 = <span class="hljs-number">9999999999999</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(year2287) <span class="hljs-comment">// Sat Nov 20 2286 17:46:39 GMT+0800</span>

<span class="hljs-comment">// âš ï¸ ä½†å¦‚æœåç«¯è¿”å›å¾®ç§’çº§æˆ–çº³ç§’çº§æ—¶é—´æˆ³,å¯èƒ½è¶…å‡ºå®‰å…¨èŒƒå›´</span>
<span class="hljs-keyword">const</span> microTimestamp = <span class="hljs-number">1734345000000000</span> <span class="hljs-comment">// å¾®ç§’çº§(16ä½,è¶…å‡ºå®‰å…¨èŒƒå›´)</span>
<span class="hljs-comment">// è¿™ç§æƒ…å†µéœ€è¦ç”¨ BigInt æˆ–å­—ç¬¦ä¸²å¤„ç†</span>

<span class="hljs-comment">// è§£å†³æ–¹æ¡ˆç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> microStr = <span class="hljs-string">'1734345000000000'</span>
<span class="hljs-keyword">const</span> millisTimestamp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Number</span>(microStr) / <span class="hljs-number">1000</span>)
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(millisTimestamp)
</code></pre>
<h3 data-id="heading-32">4.6 æ ¼å¼åŒ–å›°éš¾:æ²¡æœ‰å†…ç½® format æ–¹æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16T10:30:00'</span>)

<span class="hljs-comment">// æƒ³è¦ "2025-12-16" æ ¼å¼? åªèƒ½æ‰‹åŠ¨æ‹¼æ¥</span>
<span class="hljs-keyword">const</span> year = date.<span class="hljs-title function_">getFullYear</span>()
<span class="hljs-keyword">const</span> month = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>) <span class="hljs-comment">// åˆ«å¿˜äº† +1!</span>
<span class="hljs-keyword">const</span> day = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getDate</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
<span class="hljs-keyword">const</span> formatted = <span class="hljs-string">`<span class="hljs-subst">${year}</span>-<span class="hljs-subst">${month}</span>-<span class="hljs-subst">${day}</span>`</span> <span class="hljs-comment">// "2025-12-16"</span>

<span class="hljs-comment">// æƒ³è¦ "2025-12-16 10:30:00"? ç»§ç»­æ‹¼...</span>
<span class="hljs-keyword">const</span> hours = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getHours</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
<span class="hljs-keyword">const</span> minutes = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getMinutes</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
<span class="hljs-keyword">const</span> seconds = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getSeconds</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
<span class="hljs-keyword">const</span> fullFormatted = <span class="hljs-string">`<span class="hljs-subst">${year}</span>-<span class="hljs-subst">${month}</span>-<span class="hljs-subst">${day}</span> <span class="hljs-subst">${hours}</span>:<span class="hljs-subst">${minutes}</span>:<span class="hljs-subst">${seconds}</span>`</span>

<span class="hljs-comment">// ğŸ˜« æ¯æ¬¡éƒ½è¦å†™è¿™ä¹ˆå¤šä»£ç </span>

<span class="hljs-comment">// âœ… å°è£…æˆå·¥å…·å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatDate</span>(<span class="hljs-params">date, format = <span class="hljs-string">'YYYY-MM-DD HH:mm:ss'</span></span>) {
  <span class="hljs-keyword">const</span> year = date.<span class="hljs-title function_">getFullYear</span>()
  <span class="hljs-keyword">const</span> month = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
  <span class="hljs-keyword">const</span> day = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getDate</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
  <span class="hljs-keyword">const</span> hours = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getHours</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
  <span class="hljs-keyword">const</span> minutes = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getMinutes</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
  <span class="hljs-keyword">const</span> seconds = <span class="hljs-title class_">String</span>(date.<span class="hljs-title function_">getSeconds</span>()).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)
  
  <span class="hljs-keyword">return</span> format
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'YYYY'</span>, year)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'MM'</span>, month)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'DD'</span>, day)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'HH'</span>, hours)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'mm'</span>, minutes)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'ss'</span>, seconds)
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-title function_">formatDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) <span class="hljs-comment">// "2025-12-16 10:30:00"</span>
<span class="hljs-title function_">formatDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(), <span class="hljs-string">'YYYY/MM/DD'</span>) <span class="hljs-comment">// "2025/12/16"</span>
</code></pre>
<h3 data-id="heading-33">4.7 Date å¯¹è±¡æ˜¯å¯å˜çš„</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âš ï¸ Date å¯¹è±¡çš„ setter æ–¹æ³•ä¼šä¿®æ”¹åŸå¯¹è±¡</span>
<span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(date.<span class="hljs-title function_">toString</span>()) <span class="hljs-comment">// "Mon Dec 16 2025..."</span>

date.<span class="hljs-title function_">setMonth</span>(<span class="hljs-number">0</span>) <span class="hljs-comment">// ä¿®æ”¹ä¸º 1 æœˆ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(date.<span class="hljs-title function_">toString</span>()) <span class="hljs-comment">// "Thu Jan 16 2025..." (åŸå¯¹è±¡è¢«æ”¹å˜!)</span>

<span class="hljs-comment">// è¿™åœ¨å‡½æ•°ä¼ å‚æ—¶å®¹æ˜“äº§ç”Ÿå‰¯ä½œç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">addOneDay</span>(<span class="hljs-params">date</span>) {
  date.<span class="hljs-title function_">setDate</span>(date.<span class="hljs-title function_">getDate</span>() + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">return</span> date <span class="hljs-comment">// âš ï¸ è¿”å›çš„æ˜¯ä¿®æ”¹åçš„åŸå¯¹è±¡</span>
}

<span class="hljs-keyword">const</span> original = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-12-16'</span>)
<span class="hljs-keyword">const</span> next = <span class="hljs-title function_">addOneDay</span>(original)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(original.<span class="hljs-title function_">toString</span>()) <span class="hljs-comment">// åŸå¯¹è±¡ä¹Ÿå˜äº†!</span>

<span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•: å…ˆå¤åˆ¶å†ä¿®æ”¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">addOneDaySafe</span>(<span class="hljs-params">date</span>) {
  <span class="hljs-keyword">const</span> newDate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(date.<span class="hljs-title function_">getTime</span>()) <span class="hljs-comment">// å¤åˆ¶</span>
  newDate.<span class="hljs-title function_">setDate</span>(newDate.<span class="hljs-title function_">getDate</span>() + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">return</span> newDate
}
</code></pre>
<hr/>
<h2 data-id="heading-34">äº”ã€Day.js è§£å†³äº†å“ªäº›ç—›ç‚¹? (å¯¹æ¯”åŸç”Ÿ Date)</h2>
<p>Day.js æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ—¥æœŸå¤„ç†åº“(ä»… 2KB gzip),API è®¾è®¡å€Ÿé‰´äº† Moment.js,ä½†æ›´åŠ ç°ä»£å’Œè½»ä¾¿ã€‚</p>
<h3 data-id="heading-35">5.1 ç—›ç‚¹å¯¹æ¯”è¡¨</h3>























































<table><thead><tr><th>ç—›ç‚¹</th><th>åŸç”Ÿ Date</th><th>Day.js</th></tr></thead><tbody><tr><td><strong>æœˆä»½ä» 0 å¼€å§‹</strong></td><td><code>getMonth()</code> è¿”å› 0-11,éœ€è¦æ‰‹åŠ¨ +1</td><td><code>month()</code> ä¹Ÿæ˜¯ 0-11,ä½† <code>format('M')</code> è‡ªåŠ¨è¾“å‡º 1-12</td></tr><tr><td><strong>æ ¼å¼åŒ–æ—¥æœŸ</strong></td><td>æ— å†…ç½®æ–¹æ³•,éœ€æ‰‹åŠ¨æ‹¼æ¥åå‡ è¡Œä»£ç </td><td><code>format('YYYY-MM-DD HH:mm:ss')</code> ä¸€è¡Œæå®š</td></tr><tr><td><strong>å­—ç¬¦ä¸²è§£æä¸ä¸€è‡´</strong></td><td>ä¸åŒæµè§ˆå™¨ç»“æœä¸åŒ,é ISO æ ¼å¼ä¸å¯é </td><td>ç»Ÿä¸€è§£æ,<code>customParseFormat</code> æ’ä»¶æ”¯æŒä»»æ„æ ¼å¼</td></tr><tr><td><strong>æ—¥æœŸåŠ å‡</strong></td><td>éœ€æ‰‹åŠ¨è®¡ç®—æ¯«ç§’æˆ–ç”¨ <code>setDate()</code> ç­‰æ–¹æ³•</td><td><code>add(7, 'day')</code>ã€<code>subtract(1, 'month')</code> è¯­ä¹‰æ¸…æ™°</td></tr><tr><td><strong>æ—¥æœŸæ¯”è¾ƒ</strong></td><td>éœ€è½¬æ—¶é—´æˆ³æ¯”è¾ƒ,ä»£ç å†—é•¿</td><td><code>isBefore()</code>ã€<code>isAfter()</code>ã€<code>isSame()</code> ç›´è§‚æ˜“è¯»</td></tr><tr><td><strong>ä¸å¯å˜æ€§</strong></td><td><code>setMonth()</code> ç­‰æ–¹æ³•ä¼šä¿®æ”¹åŸå¯¹è±¡,æ˜“äº§ç”Ÿ bug</td><td>æ‰€æœ‰æ“ä½œè¿”å›æ–°å¯¹è±¡,åŸå¯¹è±¡ä¸å˜,é¿å…å‰¯ä½œç”¨</td></tr><tr><td><strong>æ—¶åŒºå¤„ç†</strong></td><td>åªæœ‰æœ¬åœ°å’Œ UTC,åˆ‡æ¢éº»çƒ¦</td><td><code>timezone</code> æ’ä»¶è½»æ¾å¤„ç†ä»»æ„æ—¶åŒº</td></tr><tr><td><strong>ç›¸å¯¹æ—¶é—´</strong></td><td>æ— å†…ç½®æ”¯æŒ</td><td><code>fromNow()</code> ç›´æ¥è¾“å‡º"3 å¤©å‰"ã€"2 å°æ—¶å"</td></tr><tr><td><strong>ä½“ç§¯</strong></td><td>å†…ç½®,0 æˆæœ¬</td><td>~2KB gzip,æè½»é‡</td></tr></tbody></table>
<h3 data-id="heading-36">5.2 Day.js åŸºæœ¬ä½¿ç”¨</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> dayjs <span class="hljs-keyword">from</span> <span class="hljs-string">'dayjs'</span>

<span class="hljs-comment">// åˆ›å»ºæ—¥æœŸå¯¹è±¡</span>
<span class="hljs-title function_">dayjs</span>() <span class="hljs-comment">// å½“å‰æ—¶é—´</span>
<span class="hljs-title function_">dayjs</span>(<span class="hljs-string">'2025-12-16'</span>) <span class="hljs-comment">// ä»å­—ç¬¦ä¸²</span>
<span class="hljs-title function_">dayjs</span>(<span class="hljs-number">1734345000000</span>) <span class="hljs-comment">// ä»æ—¶é—´æˆ³</span>
<span class="hljs-title function_">dayjs</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) <span class="hljs-comment">// ä» Date å¯¹è±¡</span>

<span class="hljs-comment">// æ ¼å¼åŒ– (æœ€å¸¸ç”¨!)</span>
<span class="hljs-title function_">dayjs</span>().<span class="hljs-title function_">format</span>(<span class="hljs-string">'YYYY-MM-DD'</span>) <span class="hljs-comment">// "2025-12-16"</span>
<span class="hljs-title function_">dayjs</span>().<span class="hljs-title function_">format</span>(<span class="hljs-string">'YYYY-MM-DD HH:mm:ss'</span>) <span class="hljs-comment">// "2025-12-16 10:30:00"</span>
<span class="hljs-title function_">dayjs</span>().<span class="hljs-title function_">format</span>(<span class="hljs-string">'YYYYå¹´MMæœˆDDæ—¥'</span>) <span class="hljs-comment">// "2025å¹´12æœˆ16æ—¥"</span>

<span class="hljs-comment">// æ—¥æœŸåŠ å‡</span>
<span class="hljs-title function_">dayjs</span>().<span class="hljs-title function_">add</span>(<span class="hljs-number">7</span>, <span class="hljs-string">'day'</span>) <span class="hljs-comment">// 7 å¤©å</span>
<span class="hljs-title function_">dayjs</span>().<span class="hljs-title function_">subtract</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'month'</span>) <span class="hljs-comment">// 1 ä¸ªæœˆå‰</span>
<span class="hljs-title function_">dayjs</span>().<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'year'</span>) <span class="hljs-comment">// 1 å¹´å</span>

<span class="hljs-comment">// æ—¥æœŸæ¯”è¾ƒ</span>
<span class="hljs-title function_">dayjs</span>(<span class="hljs-string">'2025-12-16'</span>).<span class="hljs-title function_">isBefore</span>(<span class="hljs-string">'2025-12-17'</span>) <span class="hljs-comment">// true</span>
<span class="hljs-title function_">dayjs</span>(<span class="hljs-string">'2025-12-16'</span>).<span class="hljs-title function_">isAfter</span>(<span class="hljs-string">'2025-12-15'</span>) <span class="hljs-comment">// true</span>
<span class="hljs-title function_">dayjs</span>(<span class="hljs-string">'2025-12-16'</span>).<span class="hljs-title function_">isSame</span>(<span class="hljs-string">'2025-12-16'</span>) <span class="hljs-comment">// true</span>

<span class="hljs-comment">// ç›¸å¯¹æ—¶é—´ (éœ€è¦ relativeTime æ’ä»¶)</span>
<span class="hljs-keyword">import</span> relativeTime <span class="hljs-keyword">from</span> <span class="hljs-string">'dayjs/plugin/relativeTime'</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'dayjs/locale/zh-cn'</span>
dayjs.<span class="hljs-title function_">extend</span>(relativeTime)
dayjs.<span class="hljs-title function_">locale</span>(<span class="hljs-string">'zh-cn'</span>)

<span class="hljs-title function_">dayjs</span>().<span class="hljs-title function_">fromNow</span>() <span class="hljs-comment">// "å‡ ç§’å‰"</span>
<span class="hljs-title function_">dayjs</span>().<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-string">'day'</span>).<span class="hljs-title function_">fromNow</span>() <span class="hljs-comment">// "3 å¤©å"</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°æ®å¤§å±å¸¸ç”¨å¸ƒå±€-ç­‰æ¯”ç¼©æ”¾å¸ƒå±€(Scale Laylout)-ä½¿ç”¨ CSS Transform Scale å®ç°ç­‰æ¯”ç¼©æ”¾]]></title>    <link>https://juejin.cn/post/7584722109584146475</link>    <guid>https://juejin.cn/post/7584722109584146475</guid>    <pubDate>2025-12-18T02:10:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584722109584146475" data-draft-id="7584722109584097323" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°æ®å¤§å±å¸¸ç”¨å¸ƒå±€-ç­‰æ¯”ç¼©æ”¾å¸ƒå±€(Scale  Laylout)-ä½¿ç”¨ CSS Transform Scale å®ç°ç­‰æ¯”ç¼©æ”¾"/> <meta itemprop="keywords" content="å‰ç«¯,CSS"/> <meta itemprop="datePublished" content="2025-12-18T02:10:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç é€”æ½‡æ½‡"/> <meta itemprop="url" content="https://juejin.cn/user/2386391857112611"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°æ®å¤§å±å¸¸ç”¨å¸ƒå±€-ç­‰æ¯”ç¼©æ”¾å¸ƒå±€(Scale  Laylout)-ä½¿ç”¨ CSS Transform Scale å®ç°ç­‰æ¯”ç¼©æ”¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2386391857112611/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç é€”æ½‡æ½‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T02:10:26.000Z" title="Thu Dec 18 2025 02:10:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ•°æ®å¤§å±å¸¸ç”¨å¸ƒå±€-ç­‰æ¯”ç¼©æ”¾å¸ƒå±€(Scale  Laylout)-ä½¿ç”¨ CSS Transform Scale å®ç°ç­‰æ¯”ç¼©æ”¾</h2>
<h2 data-id="heading-1">1.ä»‹ç»</h2>
<h3 data-id="heading-2">1.1 å…¸å‹ç‰¹å¾å’Œå…¸å‹ç‰¹ç‚¹</h3>
<p>Scale Layout çš„å…¸å‹ç‰¹å¾ï¼š</p>
<blockquote>
<p>1.æµè§ˆå™¨ç¼©å°</p>
<p>2.æ•´ä¸ªé¡µé¢ä¸€èµ·ç¼©</p>
<p>3.å¸ƒå±€ä¸å˜</p>
<p>4.å­—ä½“å¯ä»¥ç¼©åˆ°å‡  px</p>
</blockquote>
<p>å·¥ç¨‹ä¸Šæ„å‘³ç€ï¼š</p>
<ul>
<li>é¡µé¢æœ‰ä¸€ä¸ªå›ºå®šâ€œè®¾è®¡å°ºå¯¸â€</li>
<li>æµè§ˆå™¨å˜åŒ–æ—¶ ä¸é‡æ’ï¼ˆä¸ reflowï¼‰</li>
<li>åªæ˜¯ æ•´ä½“åš transform</li>
</ul>
<p>ä¸ºä»€ä¹ˆé€‚åˆæ•°æ®å¤§å±ï¼Ÿ</p>
<p>æ•°æ®å¤§å±çš„å…¸å‹ç‰¹ç‚¹</p>
<ul>
<li>å›ºå®šåˆ†è¾¨ç‡è®¾è®¡ï¼ˆ1920Ã—1080 / 3840Ã—2160ï¼‰</li>
<li>ä¸»è¦æ˜¯ çœ‹ï¼Œä¸æ˜¯ ç‚¹</li>
<li>è¿è¡Œç¯å¢ƒå¯æ§ï¼ˆä¼šè®®å®¤ / å¤§å±ç”µè§†ï¼‰</li>
</ul>
<h3 data-id="heading-3">1.2 æ•ˆæœå±•ç¤º</h3>
<p>æ•ˆæœå®ç°å±•ç¤ºï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e98d559d9d84481975c2ff8079c7848~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB6YCU5r2H5r2H:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766628625&amp;x-signature=wjsPffTfH8KjbdK6dxh1JSWzUts%3D" alt="å½•å±2025-12-17 09.44.00 (online-video-cutter.com) - Compressed with FlexClip (2)" loading="lazy"/></p>
<h3 data-id="heading-4">1.3 CSS ç¼–å†™åŸåˆ™</h3>
<p>åœ¨è¿™ç§æ–¹æ¡ˆä¸‹ï¼Œä½ çš„ CSS ç¼–å†™åŸåˆ™æ˜¯</p>
<p>CSS ä¸–ç•Œé‡Œæ°¸è¿œæ˜¯ 1920Ã—1080ï¼Œç¼©æ”¾äº¤ç»™ JSï¼Œä½¿ç”¨å›ºå®š pxï¼Œä¸è¦å†™å“åº”å¼</p>
<h2 data-id="heading-5">2.å®æˆ˜æ¡ˆä¾‹-ä½¿ç”¨ CSS Transform Scale å®ç°ç­‰æ¯”ç¼©æ”¾</h2>
<ol>
<li>å›ºå®šè®¾è®¡å°ºå¯¸</li>
</ol>
<p>åœ¨å…¨å±€æ ·å¼ä¸­ï¼Œ#app è¢«è®¾ç½®ä¸ºå›ºå®šçš„è®¾è®¡å°ºå¯¸ï¼š</p>
<p>Index.css</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-id">#app</span> {
  <span class="hljs-keyword">@apply</span> inline-block absolute left-<span class="hljs-number">1</span>/<span class="hljs-number">2</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">1920px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">1080px</span>;
  <span class="hljs-attribute">transform-origin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.9</span>);
}
</code></pre>
<ol start="2">
<li>åŠ¨æ€ç¼©æ”¾è®¡ç®—</li>
</ol>
<p>ä½¿ç”¨ useScreenScale hook è®¡ç®—ç¼©æ”¾æ¯”ä¾‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { onMounted, onUnmounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">useScreenScale</span> = (<span class="hljs-params"/>) =&gt; {
	<span class="hljs-comment">/**
	 * Scales the screen based on the design dimensions.
	 * window resize is not usually triggered, so no need to use debounce
	 * <span class="hljs-doctag">@return</span> {<span class="hljs-type">void</span>} This function does not return a value.
	 */</span>
	<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleScreenScale</span> = (<span class="hljs-params"/>) =&gt; {
		<span class="hljs-keyword">const</span> designDreftWidth = <span class="hljs-number">1920</span>
		<span class="hljs-keyword">const</span> designDreftHeight = <span class="hljs-number">1080</span>

		<span class="hljs-keyword">const</span> scale =
			<span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientWidth</span> / <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span> &lt;
			designDreftWidth / designDreftHeight
				? <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientWidth</span> / designDreftWidth
				: <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span> / designDreftHeight

		<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#app'</span>) !== <span class="hljs-literal">null</span>) {
			;(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#app'</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>).<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> =
				<span class="hljs-string">`scale(<span class="hljs-subst">${scale}</span>) translate(-50%)`</span>
		}
	}
	<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
		<span class="hljs-title function_">handleScreenScale</span>()
		<span class="hljs-variable language_">window</span>.<span class="hljs-property">onresize</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">handleScreenScale</span>()
	})

	<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
		<span class="hljs-variable language_">window</span>.<span class="hljs-property">onresize</span> = <span class="hljs-literal">null</span>
	})
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useScreenScale
</code></pre>
<p>ç¼©æ”¾é€»è¾‘ï¼š</p>
<ul>
<li>
<p>æ¯”è¾ƒå½“å‰å±å¹•å®½é«˜æ¯”ä¸è®¾è®¡ç¨¿å®½é«˜æ¯”ï¼ˆ16:9ï¼‰</p>
</li>
<li>
<p>å¦‚æœå±å¹•æ›´çª„ï¼šæŒ‰å®½åº¦ç¼©æ”¾ scale = å±å¹•å®½åº¦ / 1920</p>
</li>
<li>
<p>å¦‚æœå±å¹•æ›´é«˜ï¼šæŒ‰é«˜åº¦ç¼©æ”¾ scale = å±å¹•é«˜åº¦ / 1080</p>
</li>
<li>
<p>åº”ç”¨å˜æ¢ï¼štransform: scale(scale) translate(-50%)</p>
<ul>
<li>translate(-50%)å’Œleftï¼ˆ50%ï¼‰é…åˆï¼Œå®ç°æ°´å¹³å±…ä¸­</li>
</ul>
</li>
<li>
<p>scale() ç¼©æ”¾ï¼Œscaleå°±æ˜¯ç¼©æ”¾æ¯”ä¾‹</p>
</li>
<li>
<p>translate(-50%) é…åˆ left-1/2 å®ç°å±…ä¸­</p>
</li>
</ul>
<ol start="3">
<li>åœ¨ App.vue ä¸­å¯ç”¨</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript">&lt;script setup lang=<span class="hljs-string">"ts"</span>&gt;
<span class="hljs-title function_">useScreenScale</span>()
&lt;/script&gt;
</code></pre>
<p>é¡µé¢å¦‚ä½•å®ç°ç­‰æ¯”ç¼©æ”¾?</p>
<p>é¡µé¢æ— éœ€é¢å¤–å¤„ç†ï¼Œå› ä¸ºï¼š</p>
<blockquote>
<p>æ‰€æœ‰é¡µé¢éƒ½åœ¨ #app å†…éƒ¨</p>
<p>#app æ•´ä½“ç¼©æ”¾ï¼Œå†…éƒ¨å…ƒç´ è‡ªåŠ¨è·Ÿéš</p>
<p>ä½¿ç”¨å›ºå®šåƒç´ å€¼å³å¯ï¼Œä¾‹å¦‚ï¼š</p>
</blockquote>
<pre><code class="hljs language-html" lang="html"> <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"w-[1114px] h-full"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">HistoryEventsList</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">"historyEventsListRef"</span>
          @<span class="hljs-attr">update:queryParams</span>=<span class="hljs-string">"handleTrendQuery"</span>
          @<span class="hljs-attr">open:warningEventDetail</span>=<span class="hljs-string">"handleOpenWarningEventDetail"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"w-[738px] h-full"</span>&gt;</span>
</code></pre>
<p>è¿™äº›å›ºå®šåƒç´ å€¼ï¼ˆå¦‚ 1114pxã€738pxï¼‰ä¼šéš #app çš„ç¼©æ”¾æ¯”ä¾‹è‡ªåŠ¨ç¼©æ”¾ã€‚</p>
<h2 data-id="heading-6">3.æ³¨æ„å‘ç‚¹-  Element Plus å¼¹å‡ºå±‚çš„é»˜è®¤è¡Œä¸º</h2>
<p>Element Plus å¼¹å‡ºå±‚çš„é»˜è®¤è¡Œä¸ºï¼ŒElement Plus çš„å¼¹å‡ºå±‚ç»„ä»¶ï¼ˆel-selectã€el-cascaderã€el-date-picker ç­‰ï¼‰é»˜è®¤ä¼šå°†ä¸‹æ‹‰èœå•æŒ‚è½½åˆ° body ä¸Šï¼Œè€Œä¸æ˜¯ç»„ä»¶æ‰€åœ¨çš„ DOM æ ‘ä¸­ã€‚</p>
<p>DOM ç»“æ„ç¤ºæ„ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>  â† è¿™é‡Œåº”ç”¨äº† transform: scale(0.75)
    <span class="hljs-tag">&lt;<span class="hljs-name">HistoryEventsList</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-select</span>&gt;</span>  â† è¾“å…¥æ¡†åœ¨è¿™é‡Œ
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-select</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">HistoryEventsList</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸‹æ‹‰èœå•ä¼šæŒ‚è½½åˆ°è¿™é‡Œ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-select-dropdown"</span>&gt;</span>  â† ä¸‹æ‹‰èœå•åœ¨ body ä¸‹ï¼Œä¸åœ¨ #app å†…ï¼
    <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<p>ç”±äºç¼©æ”¾æ˜¯å†™åœ¨appä¸Šçš„ï¼Œä½†æ˜¯å¼¹å‡ºå±‚æŒ‚åœ¨äº†bodyä¸Šï¼Œæ‰€ä»¥åº”è¯¥å°†å¼¹å‡ºå±‚æŒ‚åˆ°appä¸Š,ä½¿ç”¨append-to="#app"</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">el-date-picker</span>
            <span class="hljs-attr">v-model</span>=<span class="hljs-string">"currentDateRange"</span>
            <span class="hljs-attr">:shortcuts</span>=<span class="hljs-string">"EVENT_SHORTCUTS"</span>
            <span class="hljs-attr">append-to</span>=<span class="hljs-string">"#app"</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"daterange"</span>
            <span class="hljs-attr">range-separator</span>=<span class="hljs-string">"è‡³"</span>
            <span class="hljs-attr">start-placeholder</span>=<span class="hljs-string">"å¼€å§‹æ—¥æœŸ"</span>
            <span class="hljs-attr">end-placeholder</span>=<span class="hljs-string">"ç»“æŸæ—¥æœŸ"</span>
            <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span>
            <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ width: '100%', height: '32px' }"</span>
          /&gt;</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>