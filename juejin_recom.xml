<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[AIé¢†åŸŸåå®¶åä½œï¼Œå¤§æ¨¡å‹å­¦ä¹ ä¹¦ç±æ¨è-å…³äºå¤§æ¨¡å‹çš„æ•™ç§‘ä¹¦ï¼ˆé™„pdfï¼‰]]></title>    <link>https://juejin.cn/post/7579169543232143360</link>    <guid>https://juejin.cn/post/7579169543232143360</guid>    <pubDate>2025-12-03T03:03:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579169543232143360" data-draft-id="7579127397498650675" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIé¢†åŸŸåå®¶åä½œï¼Œå¤§æ¨¡å‹å­¦ä¹ ä¹¦ç±æ¨è-å…³äºå¤§æ¨¡å‹çš„æ•™ç§‘ä¹¦ï¼ˆé™„pdfï¼‰"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-03T03:03:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIé¢†åŸŸåå®¶åä½œï¼Œå¤§æ¨¡å‹å­¦ä¹ ä¹¦ç±æ¨è-å…³äºå¤§æ¨¡å‹çš„æ•™ç§‘ä¹¦ï¼ˆé™„pdfï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:03:23.000Z" title="Wed Dec 03 2025 03:03:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>AIé¢†åŸŸåå®¶åä½œï¼Œç›®å‰å¤§æ¨¡å‹çš„æ•™ç§‘ä¹¦å·²ç»è‡³å°‘æœ‰ä¸‰æœ¬äº†ï¼Œä¸”å‡å·²æä¾›å…¬å¼€çš„PDFç‰ˆæœ¬ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc7cde240a7d47cfb746c2d43f3ef69b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335802&amp;x-signature=e%2Bsll6nFM61zdSJ%2FXIRztDp%2BhhA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>ğŸš©ç¬¬ä¸€æœ¬ï¼šã€Šå¤§è¯­è¨€æ¨¡å‹ã€‹</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/805792984da148e8bf5fbe14a55705e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335802&amp;x-signature=o%2FiJLE6cyhBKmm1ngYPB%2B0rISxQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸€ã€å†…å®¹ä»‹ç»ï¼š</h3>
<p>æ˜¯ä¸€æœ¬ç”±ä¸­å›½äººæ°‘å¤§å­¦é«˜ç“´äººå·¥æ™ºèƒ½å­¦é™¢æ•™æˆèµµé‘«ç­‰ç¼–è‘—çš„ä¹¦ç±ï¼Œæ—¨åœ¨ä¸ºå¤§æ¨¡å‹æŠ€æœ¯çš„å…¥é—¨è¯»è€…æä¾›ç³»ç»Ÿæ€§çš„çŸ¥è¯†è®²è§£ï¼Œæ˜¯ä¸€æœ¬éå¸¸é€‚åˆå¤§æ¨¡å‹æŠ€æœ¯å…¥é—¨è¯»è€…çš„ä¹¦ç±ï¼Œæœ¬ä¹¦å±•ç°ä¸€ä¸ªå®Œæ•´çš„å¤§æ¨¡å‹æŠ€æœ¯æ¡†æ¶å’Œå‘å±•è·¯çº¿å›¾ï¼Œé€šè¿‡ç³»ç»Ÿæ€§çš„çŸ¥è¯†è®²è§£å’Œå®ä¾‹åˆ†æï¼Œå¸®åŠ©è¯»è€…æ·±å…¥ç†è§£å¤§æ¨¡å‹æŠ€æœ¯çš„æ ¸å¿ƒåŸç†å’Œåº”ç”¨åœºæ™¯ã€‚å¯¹äºé«˜å¹´çº§æœ¬ç§‘ç”Ÿã€ä½å¹´çº§ç ”ç©¶ç”Ÿä»¥åŠä»äº‹äººå·¥æ™ºèƒ½é¢†åŸŸçš„æŠ€æœ¯äººå‘˜å’Œçˆ±å¥½è€…æ¥è¯´ï¼Œæœ¬ä¹¦éƒ½æ˜¯ä¸€æœ¬ä¸å¯å¤šå¾—çš„å‚è€ƒèµ„æ–™ã€‚</p>
<h3 data-id="heading-2">äºŒã€ä¹¦ç±ç‰¹ç‚¹ï¼š</h3>
<ul>
<li>ç³»ç»Ÿæ€§ï¼šæœ¬ä¹¦æ³¨é‡å±•ç°ä¸€ä¸ªå®Œæ•´çš„å¤§æ¨¡å‹æŠ€æœ¯æ¡†æ¶å’Œå‘å±•è·¯çº¿å›¾ï¼Œå¸®åŠ©è¯»è€…å»ºç«‹ç³»ç»Ÿæ€§çš„çŸ¥è¯†ä½“ç³»ã€‚</li>
<li>å®ç”¨æ€§ï¼šé€šè¿‡å¤§é‡çš„å®ä¾‹å’Œæ¡ˆä¾‹åˆ†æï¼Œå°†ç†è®ºçŸ¥è¯†ä¸å®é™…åº”ç”¨ç´§å¯†ç»“åˆï¼Œæé«˜è¯»è€…çš„å®è·µèƒ½åŠ›ã€‚</li>
<li>å‰ç»æ€§ï¼šæœ¬ä¹¦ä¸ä»…ä»‹ç»äº†å½“å‰å¤§è¯­è¨€æ¨¡å‹çš„æœ€æ–°è¿›å±•ï¼Œè¿˜æ¢è®¨äº†æœªæ¥çš„å‘å±•è¶‹åŠ¿å’ŒæŒ‘æˆ˜ã€‚</li>
</ul>
<h3 data-id="heading-3">ä¸‰ã€ä¹¦ç±é€‚ç”¨äººç¾¤</h3>
<ul>
<li>
<p><strong>é«˜å¹´çº§æœ¬ç§‘ç”Ÿï¼šå¯¹äºå…·æœ‰æ·±åº¦å­¦ä¹ åŸºç¡€çš„é«˜å¹´çº§æœ¬ç§‘ç”Ÿæ¥è¯´ï¼Œæœ¬ä¹¦æ˜¯ä¸€æœ¬å¾ˆå¥½çš„å…¥é—¨è¯»ç‰©ï¼Œå¯ä»¥å¸®åŠ©ä»–ä»¬å¿«é€ŸæŒæ¡å¤§æ¨¡å‹æŠ€æœ¯çš„æ ¸å¿ƒåŸç†å’Œåº”ç”¨æ–¹æ³•ã€‚</strong></p>
</li>
<li>
<p>ä½å¹´çº§ç ”ç©¶ç”Ÿï¼šå¯¹äºä½å¹´çº§ç ”ç©¶ç”Ÿæ¥è¯´ï¼Œæœ¬ä¹¦å¯ä»¥ä½œä¸ºä»–ä»¬æ·±å…¥ç ”ç©¶å¤§æ¨¡å‹æŠ€æœ¯çš„èµ·ç‚¹ï¼Œä¸ºä»–ä»¬åç»­çš„ç§‘ç ”å·¥ä½œæ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚</p>
</li>
<li>
<p>æŠ€æœ¯äººå‘˜å’Œçˆ±å¥½è€…ï¼šå¯¹äºä»äº‹äººå·¥æ™ºèƒ½é¢†åŸŸçš„æŠ€æœ¯äººå‘˜å’Œçˆ±å¥½è€…æ¥è¯´ï¼Œæœ¬ä¹¦ä¹Ÿæ˜¯ä¸€æœ¬ä¸å¯å¤šå¾—çš„å‚è€ƒèµ„æ–™ï¼Œå¯ä»¥å¸®åŠ©ä»–ä»¬äº†è§£å¤§æ¨¡å‹æŠ€æœ¯çš„æœ€æ–°è¿›å±•å’Œåº”ç”¨åœºæ™¯ã€‚</p>
</li>
</ul>
<h2 data-id="heading-4"><strong>ğŸš©ç¬¬äºŒæœ¬ï¼šã€Šå¤§æ¨¡å‹åŸºç¡€ã€‹</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e8e0cf7f6214f5a99b5375aaca654d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335802&amp;x-signature=IfzTvRXW75XphYzYyEFGoXz92a0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">ä¸€ã€å†…å®¹ä»‹ç»ï¼š</h3>
<p>ã€Šå¤§æ¨¡å‹åŸºç¡€ã€‹æ˜¯ä¸€æœ¬ç”±æµ™æ±Ÿå¤§å­¦DAILYå®éªŒå®¤çš„æ¯›ç‰ä»ç ”ç©¶å‘˜å’Œé«˜äº‘å›æ•™æˆé¢†è¡”æ’°å†™çš„å¤§æ¨¡å‹é¢†åŸŸæ•™æã€‚æœ¬ä¹¦åŒ…å«è¯­è¨€æ¨¡å‹åŸºç¡€ã€å¤§è¯­è¨€æ¨¡å‹æ¶æ„æ¼”åŒ–ã€Promptå·¥ç¨‹ã€å‚æ•°é«˜æ•ˆå¾®è°ƒã€æ¨¡å‹ç¼–è¾‘ã€æ£€ç´¢å¢å¼ºç”Ÿæˆç­‰å…­éƒ¨åˆ†å†…å®¹ã€‚ æœ¬ä¹¦å…±9ç« ï¼Œæ·±å…¥æ¢è®¨äº†å¤§æ¨¡å‹çš„å·¥ä½œåŸç†å’Œä½¿ç”¨æ–¹æ³•-ä¸€æç¤ºå·¥ç¨‹ï¼Œå¹¶ç ”ç©¶äº†æç¤ºå·¥ç¨‹åœ¨ç”µå­å•†åŠ¡ã€åˆ›æ„è¥é”€ã€å†…å®¹åˆ›ä½œã€åŠå…¬å’Œç¼–ç¨‹ç­‰åœºæ™¯ä¸­çš„åº”ç”¨ï¼Œä»¥åŠå¦‚ä½•èµ‹èƒ½è½¯ä»¶ç”Ÿæ€çš„å‘å±•ç­‰ã€‚</p>
<h3 data-id="heading-6">äºŒã€ä¹¦ç±ç‰¹ç‚¹ï¼š</h3>
<p>ç´§è·ŸæŠ€æœ¯å‰æ²¿ï¼šä¹¦ä¸­ä¸ä»…æ¶µç›–äº†å¤§æ¨¡å‹çš„åŸºç¡€çŸ¥è¯†ï¼Œè¿˜ä»‹ç»äº†æœ€æ–°çš„æŠ€æœ¯è¿›å±•å’Œç ”ç©¶æˆæœï¼Œä½¿è¯»è€…èƒ½å¤Ÿç´§è·ŸæŠ€æœ¯å‰æ²¿ã€‚</p>
<p>æ˜“è¯»æ€§ï¼šæ¯ç« å†…å®¹éƒ½ä»¥ä¸€ç§åŠ¨ç‰©ä¸ºä¸»é¢˜è¿›è¡Œè®²è§£ï¼Œå¦‚ä»¥â€œçŒ«â€ä¸ºä¸»é¢˜ä»‹ç»Transformeræ¶æ„ï¼Œä½¿å¤æ‚çš„æŠ€æœ¯æ¦‚å¿µæ›´åŠ ç”ŸåŠ¨æ˜“æ‡‚ã€‚</p>
<p>å…¨é¢ç³»ç»Ÿï¼šå†…å®¹æ¶µç›–äº†ä¼ ç»Ÿè¯­è¨€æ¨¡å‹ã€å¤§è¯­è¨€æ¨¡å‹çš„æ¶æ„ã€æç¤ºå·¥ç¨‹ã€é«˜æ•ˆå‚æ•°è®¾ç½®ã€æ¨¡å‹ç¼–è¾‘ä»¥åŠæœç´¢å¢å¼ºç”Ÿæˆç­‰å…³é”®ä¸»é¢˜ã€‚å¯¹æ¯ä¸ªä¸»é¢˜éƒ½è¿›è¡Œäº†æ·±å…¥çš„æ¢è®¨å’Œåˆ†æï¼Œå¸®åŠ©è¯»è€…å»ºç«‹å…¨é¢çš„çŸ¥è¯†ä½“ç³»ã€‚</p>
<h3 data-id="heading-7">ä¸‰ã€ä¹¦ç±ç›®å½•</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63cbd7d4c5d74dbaa61ad19d8ff6e4a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335802&amp;x-signature=FI3fVdRz2RO5ts8kqsUfkir%2FhGc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8"><strong>ğŸš©ç¬¬ä¸‰æœ¬ï¼šã€Šå¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼šä»ç†è®ºåˆ°å®è·µã€‹</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b9fb474301f432b819eaece952fddcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335802&amp;x-signature=HmQJwTo7yGyf0jNuE80E91zcTLk%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-9">ä¸€ã€å†…å®¹ä»‹ç»ï¼š</h4>
<p>ã€Šå¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼šä»ç†è®ºåˆ°å®è·µã€‹æ˜¯ç”±å¤æ—¦å¤§å­¦è®¡ç®—æœºç§‘å­¦æŠ€æœ¯å­¦é™¢å¼ å¥‡æ•™æˆé¢†è¡”çš„å›¢é˜Ÿç¼–å†™çš„ä¸“ä¸šä¹¦ç±ï¼Œæ˜¯ä¸€æœ¬ç³»ç»Ÿã€å®ç”¨ã€æƒå¨ä¸”æ˜“è¯»çš„å¤§è¯­è¨€æ¨¡å‹æ•™æï¼Œæ—¨åœ¨å¸®åŠ©è¯»è€…æ·±å…¥ç†è§£å¤§è¯­è¨€æ¨¡å‹çš„åŸç†ï¼Œå¹¶æä¾›å®é™…æ“ä½œçš„æŒ‡å¯¼å’Œæ¡ˆä¾‹ã€‚å¯¹äºå¸Œæœ›æ·±å…¥äº†è§£å¤§è¯­è¨€æ¨¡å‹åŸç†å’Œåº”ç”¨çš„è¯»è€…æ¥è¯´å…·æœ‰é‡è¦çš„å‚è€ƒä»·å€¼ã€‚</p>
<h5 data-id="heading-10">äºŒã€ä¸ºä»€ä¹ˆè¦é˜…è¯»è¿™æœ¬ä¹¦</h5>
<p>å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼šä»ç†è®ºåˆ°å®è·µã€‹å¯¹å¤§è¯­è¨€æ¨¡å‹æ„Ÿå…´è¶£çš„è¯»è€…æä¾›å…¥é—¨æŒ‡å—ï¼Œä¹Ÿå¯ä½œä¸ºé«˜å¹´çº§æœ¬ç§‘ç”Ÿå’Œç ”ç©¶ç”Ÿè‡ªç„¶è¯­è¨€å¤„ç†ç›¸å…³è¯¾ç¨‹çš„è¡¥å……æ•™æã€‚</p>
<p>æŒæ¡å¤§è¯­è¨€æ¨¡å‹ç›¸å…³æŠ€æœ¯ï¼Œç»™è‡ªå·±ä¸€ä¸ªæ·±å…¥ç ”ç©¶å¤§è¯­è¨€æ¨¡å‹çš„å®è·µæœºä¼šã€‚</p>
<h5 data-id="heading-11">ä¸‰ã€æœ¬ä¹¦æ¶æ„</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cf574c1cbb5444b91aebc497a86c975~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335802&amp;x-signature=loXyq6m%2By6%2BK0Yp%2BHv3SSz%2FYuGU%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c29dc55baa6149279a0849022a58f488~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335802&amp;x-signature=pzwFuI94gSNRAAn8Pe4XCE1KjI4%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-12">åŸºç¡€ç†è®ºéƒ¨åˆ†:ä»‹ç»LLMçš„åŸºç¡€ç†è®ºçŸ¥è¯†</h5>
<ul>
<li>è¯­è¨€æ¨¡å‹çš„å®šä¹‰</li>
<li>Transformerç»“æ„</li>
<li>ç”Ÿæˆå¼é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹GPT</li>
<li>å¤§è¯­è¨€æ¨¡å‹çš„ç»“æ„</li>
<li>æ³¨æ„åŠ›æœºåˆ¶ä¼˜åŒ–</li>
<li>å®è·µ:åŸºäºHuggingFaceçš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹</li>
<li>å®è·µ:ä»¥LLaMAä½¿ç”¨çš„æ¨¡å‹ç»“æ„ä¸ºä¾‹</li>
</ul>
<h5 data-id="heading-13">é¢„è®­ç»ƒéƒ¨åˆ†:å›´ç»•LLMé¢„è®­ç»ƒæ•°æ®å’Œåˆ†å¸ƒå¼è®­ç»ƒå±•å¼€</h5>
<ul>
<li>æ•°æ®æ¥æº</li>
<li>æ•°æ®é¢„å¤„ç†æ–¹æ³•</li>
<li>å¼€æºæ•°æ®é›†</li>
<li>æ¨¡å‹åˆ†å¸ƒå¼è®­ç»ƒ</li>
<li>æ•°æ®å¹¶è¡Œ</li>
<li>æµæ°´çº¿å¹¶è¡Œ</li>
<li>æ¨¡å‹å¹¶è¡Œ</li>
<li>Zeroç³»åˆ—ä¼˜åŒ–æ–¹æ³•</li>
<li>å®è·µ:ä»¥DeepSpeedä¸ºä¾‹ï¼Œè¿›è¡ŒLLMé¢„è®­ç»ƒ</li>
<li>å®è·µæ€è€ƒåˆ†äº«</li>
</ul>
<blockquote>
<ul>
<li><strong>éš¾ç‚¹:å¦‚ä½•æ„å»ºè®­ç»ƒæ•°æ®ï¼Œå¦‚ä½•é«˜æ•ˆåœ°è¿›è¡Œåˆ†å¸ƒå¼è®­ç»ƒã€‚</strong></li>
</ul>
</blockquote>
<h5 data-id="heading-14">æŒ‡ä»¤ç†è§£éƒ¨åˆ†:å›´ç»•LLMæœ‰ç›‘ç£å¾®è°ƒã€å¼ºåŒ–å­¦ä¹ å±•å¼€</h5>
<ul>
<li>æç¤ºå­¦ä¹ </li>
<li>è¯­å¢ƒå­¦ä¹ </li>
<li>é«˜æ•ˆæ¨¡å‹å¾®è°ƒ(LORAã€Delta Tuningç­‰)</li>
<li>æœ‰ç›‘ç£å¾®è°ƒæ•°æ®æ„é€ æ–¹æ³•</li>
<li>æ¨¡å‹ä¸Šä¸‹æ–‡çª—å£æ‰©å±•</li>
<li>æŒ‡ä»¤æ•°æ®çš„æ„å»º</li>
<li>å¼ºåŒ–å­¦ä¹ åŸºç¡€</li>
<li>RLHF</li>
<li>å¥–åŠ±æ¨¡å‹</li>
<li>è¿‘ç«¯ç­–ç•¥ä¼˜åŒ–</li>
<li>å®è·µ:DeepSpeed-Chat SFT</li>
<li>è®­ç»ƒç±»ChatGPTç³»ç»ŸMOSS-RLHF</li>
<li>å®è·µæ€è€ƒåˆ†äº«</li>
</ul>
<blockquote>
<ul>
<li><strong>éš¾ç‚¹:å¦‚ä½•æ„å»ºè®­ç»ƒæ•°æ®ï¼ŒåŒ…æ‹¬è®­ç»ƒæ•°æ®å†…éƒ¨å¤šä¸ªä»»åŠ¡ä¹‹é—´çš„å…³ç³»ã€è®­ç»ƒæ•°æ®ä¸é¢„è®­ç»ƒä¹‹é—´çš„å…³ç³»åŠè®­ç»ƒæ•°æ®çš„è§„æ¨¡ã€‚å¦‚ä½•è§£å†³å¼ºåŒ–å­¦ä¹ æ–¹æ³•ç¨³å®šæ€§ä¸é«˜è¶…å‚æ•°ä¼—å¤šåŠæ¨¡å‹æ”¶æ•›å›°éš¾ç­‰é—®é¢˜ã€‚</strong></li>
</ul>
</blockquote>
<h5 data-id="heading-15">æ¨¡å‹åº”ç”¨éƒ¨åˆ†:å›´ç»•LLMçš„åº”ç”¨å’Œè¯„ä¼°å±•å¼€</h5>
<ul>
<li>æ€ç»´é“¾æç¤º</li>
<li>ç”±å°‘è‡³å¤šæç¤º</li>
<li>LangChainæŠ€æœ¯</li>
<li>Agent</li>
<li>å¤šæ¨¡æ€å¤§æ¨¡å‹</li>
<li>LLMè¯„ä¼°ä½“ç³»</li>
<li>LLMè¯„ä¼°æ–¹æ³•</li>
<li>LLMè¯„ä¼°å®è·µ</li>
<li>LLMEVAL</li>
<li>å®è·µæ€è€ƒåˆ†äº«</li>
</ul>
<h3 data-id="heading-16">å­¦ä¹ èµ„æºæ¨è</h3>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é™æ€ä»£ç†ä¸åŠ¨æ€ä»£ç†ï¼šæ·±å…¥ç†è§£Javaä»£ç†æ¨¡å¼]]></title>    <link>https://juejin.cn/post/7579169543232077824</link>    <guid>https://juejin.cn/post/7579169543232077824</guid>    <pubDate>2025-12-03T02:55:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579169543232077824" data-draft-id="7579256547789848617" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é™æ€ä»£ç†ä¸åŠ¨æ€ä»£ç†ï¼šæ·±å…¥ç†è§£Javaä»£ç†æ¨¡å¼"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T02:55:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ç¦¾"/> <meta itemprop="url" content="https://juejin.cn/user/3789345759172979"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é™æ€ä»£ç†ä¸åŠ¨æ€ä»£ç†ï¼šæ·±å…¥ç†è§£Javaä»£ç†æ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3789345759172979/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ç¦¾
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:55:51.000Z" title="Wed Dec 03 2025 02:55:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»£ç†æ¨¡å¼æ¦‚è¿°</h2>
<p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œä»£ç†æ¨¡å¼æ˜¯ä¸€ç§å¸¸è§çš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ä»£ç†å¯¹è±¡åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹ä½œç”¨ï¼Œå¯ä»¥<strong>åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡ä»£ç çš„å‰æä¸‹</strong>ï¼Œå¢åŠ é¢å¤–çš„åŠŸèƒ½æˆ–æ§åˆ¶è®¿é—®ã€‚</p>
<h2 data-id="heading-1">é™æ€ä»£ç†ï¼šç¼–è¯‘æ—¶ç¡®å®šçš„ä»£ç†</h2>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯é™æ€ä»£ç†ï¼Ÿ</h3>
<p>é™æ€ä»£ç†æ˜¯æŒ‡åœ¨<strong>ç¼–è¯‘æ—¶æœŸ</strong>å°±å·²ç»ç¡®å®šä»£ç†ç±»ä¸è¢«ä»£ç†ç±»çš„å…³ç³»ã€‚ä»£ç†ç±»å’Œç›®æ ‡ç±»å®ç°ç›¸åŒçš„æ¥å£ï¼Œä»£ç†ç±»å†…éƒ¨æŒæœ‰ç›®æ ‡å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶åœ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•å‰åæ·»åŠ é¢å¤–çš„é€»è¾‘ã€‚</p>
<h3 data-id="heading-3">é™æ€ä»£ç†çš„å®ç°</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ç†è§£é™æ€ä»£ç†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å®šä¹‰æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUser</span><span class="hljs-params">(String username)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(String username)</span>;
}

<span class="hljs-comment">// 2. å®ç°ç›®æ ‡ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUser</span><span class="hljs-params">(String username)</span> {
        System.out.println(<span class="hljs-string">"æ·»åŠ ç”¨æˆ·: "</span> + username);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(String username)</span> {
        System.out.println(<span class="hljs-string">"åˆ é™¤ç”¨æˆ·: "</span> + username);
    }
}

<span class="hljs-comment">// 3. åˆ›å»ºä»£ç†ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> UserService target; <span class="hljs-comment">// ç›®æ ‡å¯¹è±¡</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserServiceProxy</span><span class="hljs-params">(UserService target)</span> {
        <span class="hljs-built_in">this</span>.target = target;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUser</span><span class="hljs-params">(String username)</span> {
        System.out.println(<span class="hljs-string">"ã€ä»£ç†ã€‘å¼€å§‹æ·»åŠ ç”¨æˆ·..."</span>);
        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-comment">// è°ƒç”¨ç›®æ ‡æ–¹æ³•</span>
        target.addUser(username);
        
        <span class="hljs-type">long</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        System.out.println(<span class="hljs-string">"ã€ä»£ç†ã€‘æ·»åŠ ç”¨æˆ·å®Œæˆï¼Œè€—æ—¶: "</span> + (end - start) + <span class="hljs-string">"ms"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(String username)</span> {
        System.out.println(<span class="hljs-string">"ã€ä»£ç†ã€‘å¼€å§‹åˆ é™¤ç”¨æˆ·..."</span>);
        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-comment">// è°ƒç”¨ç›®æ ‡æ–¹æ³•</span>
        target.deleteUser(username);
        
        <span class="hljs-type">long</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        System.out.println(<span class="hljs-string">"ã€ä»£ç†ã€‘åˆ é™¤ç”¨æˆ·å®Œæˆï¼Œè€—æ—¶: "</span> + (end - start) + <span class="hljs-string">"ms"</span>);
    }
}

<span class="hljs-comment">// 4. å®¢æˆ·ç«¯ä½¿ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticProxyDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºç›®æ ‡å¯¹è±¡</span>
        <span class="hljs-type">UserService</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserServiceImpl</span>();
        
        <span class="hljs-comment">// åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå¹¶ä¼ å…¥ç›®æ ‡å¯¹è±¡</span>
        <span class="hljs-type">UserService</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserServiceProxy</span>(target);
        
        <span class="hljs-comment">// é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•</span>
        proxy.addUser(<span class="hljs-string">"å¼ ä¸‰"</span>);
        proxy.deleteUser(<span class="hljs-string">"æå››"</span>);
    }
}
</code></pre>
<h3 data-id="heading-4">é™æ€ä»£ç†çš„ä¼˜ç¼ºç‚¹</h3>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>ç®€å•ç›´è§‚ï¼Œæ˜“äºç†è§£å’Œå®ç°</li>
<li>åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å‰æä¸‹æ‰©å±•åŠŸèƒ½</li>
<li>ç¬¦åˆå¼€é—­åŸåˆ™</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>ä»£ç†ç±»å’Œç›®æ ‡ç±»å¿…é¡»å®ç°ç›¸åŒçš„æ¥å£ï¼Œå¦‚æœæ¥å£æœ‰å¤šä¸ªæ–¹æ³•ï¼Œä»£ç†ç±»éœ€è¦é‡å†™æ‰€æœ‰æ–¹æ³•</li>
<li>æ¯ä¸ªä»£ç†ç±»åªèƒ½ä»£ç†ä¸€ä¸ªæ¥å£ï¼Œå¦‚æœæœ‰å¤šä¸ªæ¥å£éœ€è¦ä»£ç†ï¼Œéœ€è¦åˆ›å»ºå¤šä¸ªä»£ç†ç±»</li>
<li>ä»£ç†ç±»åœ¨ç¼–è¯‘æ—¶å°±å·²ç»ç¡®å®šï¼Œä¸å¤Ÿçµæ´»</li>
</ul>
<h2 data-id="heading-5">åŠ¨æ€ä»£ç†ï¼šè¿è¡Œæ—¶ç”Ÿæˆçš„ä»£ç†</h2>
<h3 data-id="heading-6">ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†ï¼Ÿ</h3>
<p>åŠ¨æ€ä»£ç†æ˜¯æŒ‡åœ¨<strong>ç¨‹åºè¿è¡Œæ—¶</strong>åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ã€‚Javaæä¾›äº†ä¸¤ç§ä¸»è¦çš„åŠ¨æ€ä»£ç†æœºåˆ¶ï¼š</p>
<ol>
<li><strong>JDKåŠ¨æ€ä»£ç†</strong>ï¼šåŸºäºæ¥å£çš„ä»£ç†</li>
<li><strong>CGLIBåŠ¨æ€ä»£ç†</strong>ï¼šåŸºäºç±»ç»§æ‰¿çš„ä»£ç†</li>
</ol>
<h3 data-id="heading-7">JDKåŠ¨æ€ä»£ç†</h3>
<p>JDKåŠ¨æ€ä»£ç†åˆ©ç”¨Javaçš„åå°„æœºåˆ¶ï¼Œåœ¨è¿è¡Œæ—¶åˆ›å»ºä»£ç†ç±»ã€‚å®ƒè¦æ±‚ç›®æ ‡ç±»å¿…é¡»å®ç°æ¥å£ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;
<span class="hljs-keyword">import</span> java.lang.reflect.Method;
<span class="hljs-keyword">import</span> java.lang.reflect.Proxy;

<span class="hljs-comment">// 1. å®šä¹‰æ¥å£å’Œç›®æ ‡ç±»ï¼ˆä¸é™æ€ä»£ç†ç›¸åŒï¼‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(String orderId)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancelOrder</span><span class="hljs-params">(String orderId)</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(String orderId)</span> {
        System.out.println(<span class="hljs-string">"åˆ›å»ºè®¢å•: "</span> + orderId);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancelOrder</span><span class="hljs-params">(String orderId)</span> {
        System.out.println(<span class="hljs-string">"å–æ¶ˆè®¢å•: "</span> + orderId);
    }
}

<span class="hljs-comment">// 2. åˆ›å»ºInvocationHandlerå®ç°ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LoggingHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> {
    <span class="hljs-keyword">private</span> Object target; <span class="hljs-comment">// ç›®æ ‡å¯¹è±¡</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LoggingHandler</span><span class="hljs-params">(Object target)</span> {
        <span class="hljs-built_in">this</span>.target = target;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> method.getName();
        System.out.println(<span class="hljs-string">"ã€åŠ¨æ€ä»£ç†ã€‘å¼€å§‹æ‰§è¡Œæ–¹æ³•: "</span> + methodName);
        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-comment">// è°ƒç”¨ç›®æ ‡æ–¹æ³•</span>
        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> method.invoke(target, args);
        
        <span class="hljs-type">long</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        System.out.println(<span class="hljs-string">"ã€åŠ¨æ€ä»£ç†ã€‘æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶: "</span> + (end - start) + <span class="hljs-string">"ms"</span>);
        
        <span class="hljs-keyword">return</span> result;
    }
}

<span class="hljs-comment">// 3. åŠ¨æ€ä»£ç†å·¥å‚ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxyFactory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">createProxy</span><span class="hljs-params">(Object target)</span> {
        <span class="hljs-keyword">return</span> Proxy.newProxyInstance(
            target.getClass().getClassLoader(), <span class="hljs-comment">// ç±»åŠ è½½å™¨</span>
            target.getClass().getInterfaces(),  <span class="hljs-comment">// ç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LoggingHandler</span>(target)          <span class="hljs-comment">// InvocationHandler</span>
        );
    }
}

<span class="hljs-comment">// 4. å®¢æˆ·ç«¯ä½¿ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicProxyDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºç›®æ ‡å¯¹è±¡</span>
        <span class="hljs-type">OrderService</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderServiceImpl</span>();
        
        <span class="hljs-comment">// åˆ›å»ºåŠ¨æ€ä»£ç†</span>
        <span class="hljs-type">OrderService</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> (OrderService) ProxyFactory.createProxy(target);
        
        <span class="hljs-comment">// é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•</span>
        proxy.createOrder(<span class="hljs-string">"ORD001"</span>);
        proxy.cancelOrder(<span class="hljs-string">"ORD002"</span>);
        
        <span class="hljs-comment">// å¯ä»¥æŸ¥çœ‹ä»£ç†ç±»çš„ä¿¡æ¯</span>
        System.out.println(<span class="hljs-string">"ä»£ç†ç±»: "</span> + proxy.getClass().getName());
        System.out.println(<span class="hljs-string">"ä»£ç†ç±»çš„çˆ¶ç±»: "</span> + proxy.getClass().getSuperclass().getName());
        System.out.println(<span class="hljs-string">"ä»£ç†ç±»å®ç°çš„æ¥å£: "</span>);
        <span class="hljs-keyword">for</span> (Class&lt;?&gt; clazz : proxy.getClass().getInterfaces()) {
            System.out.println(<span class="hljs-string">"  - "</span> + clazz.getName());
        }
    }
}
</code></pre>
<h3 data-id="heading-8">CGLIBåŠ¨æ€ä»£ç†</h3>
<p>CGLIBï¼ˆCode Generation Libraryï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ã€é«˜æ€§èƒ½çš„ä»£ç ç”Ÿæˆåº“ï¼Œå®ƒå¯ä»¥åœ¨è¿è¡Œæ—¶æ‰©å±•Javaç±»å’Œå®ç°Javaæ¥å£ã€‚ä¸JDKåŠ¨æ€ä»£ç†ä¸åŒï¼ŒCGLIBå¯ä»¥ä»£ç†æ²¡æœ‰å®ç°æ¥å£çš„ç±»ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> net.sf.cglib.proxy.Enhancer;
<span class="hljs-keyword">import</span> net.sf.cglib.proxy.MethodInterceptor;
<span class="hljs-keyword">import</span> net.sf.cglib.proxy.MethodProxy;
<span class="hljs-keyword">import</span> java.lang.reflect.Method;

<span class="hljs-comment">// 1. ç›®æ ‡ç±»ï¼ˆä¸éœ€è¦å®ç°æ¥å£ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductService</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addProduct</span><span class="hljs-params">(String productName)</span> {
        System.out.println(<span class="hljs-string">"æ·»åŠ äº§å“: "</span> + productName);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateProduct</span><span class="hljs-params">(String productName)</span> {
        System.out.println(<span class="hljs-string">"æ›´æ–°äº§å“: "</span> + productName);
    }
}

<span class="hljs-comment">// 2. åˆ›å»ºMethodInterceptorå®ç°ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CglibProxyInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MethodInterceptor</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Object obj, Method method, Object[] args, MethodProxy proxy)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> method.getName();
        System.out.println(<span class="hljs-string">"ã€CGLIBä»£ç†ã€‘å¼€å§‹æ‰§è¡Œæ–¹æ³•: "</span> + methodName);
        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-comment">// è°ƒç”¨ç›®æ ‡æ–¹æ³•</span>
        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> proxy.invokeSuper(obj, args);
        
        <span class="hljs-type">long</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        System.out.println(<span class="hljs-string">"ã€CGLIBä»£ç†ã€‘æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶: "</span> + (end - start) + <span class="hljs-string">"ms"</span>);
        
        <span class="hljs-keyword">return</span> result;
    }
}

<span class="hljs-comment">// 3. CGLIBä»£ç†å·¥å‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CglibProxyFactory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">createProxy</span><span class="hljs-params">(Class&lt;?&gt; targetClass)</span> {
        <span class="hljs-comment">// åˆ›å»ºå¢å¼ºå™¨</span>
        <span class="hljs-type">Enhancer</span> <span class="hljs-variable">enhancer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Enhancer</span>();
        
        <span class="hljs-comment">// è®¾ç½®çˆ¶ç±»ï¼ˆç›®æ ‡ç±»ï¼‰</span>
        enhancer.setSuperclass(targetClass);
        
        <span class="hljs-comment">// è®¾ç½®å›è°ƒ</span>
        enhancer.setCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CglibProxyInterceptor</span>());
        
        <span class="hljs-comment">// åˆ›å»ºä»£ç†å¯¹è±¡</span>
        <span class="hljs-keyword">return</span> enhancer.create();
    }
}

<span class="hljs-comment">// 4. å®¢æˆ·ç«¯ä½¿ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CglibProxyDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºCGLIBä»£ç†</span>
        <span class="hljs-type">ProductService</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> (ProductService) CglibProxyFactory.createProxy(ProductService.class);
        
        <span class="hljs-comment">// é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•</span>
        proxy.addProduct(<span class="hljs-string">"ç¬”è®°æœ¬ç”µè„‘"</span>);
        proxy.updateProduct(<span class="hljs-string">"æ™ºèƒ½æ‰‹æœº"</span>);
        
        <span class="hljs-comment">// å¯ä»¥æŸ¥çœ‹ä»£ç†ç±»çš„ä¿¡æ¯</span>
        System.out.println(<span class="hljs-string">"ä»£ç†ç±»: "</span> + proxy.getClass().getName());
        System.out.println(<span class="hljs-string">"ä»£ç†ç±»çš„çˆ¶ç±»: "</span> + proxy.getClass().getSuperclass().getName());
    }
}
</code></pre>
<h3 data-id="heading-9">åŠ¨æ€ä»£ç†çš„ä¼˜ç¼ºç‚¹</h3>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>é«˜åº¦çµæ´»ï¼Œä¸€ä¸ªä»£ç†ç±»å¯ä»¥ä»£ç†å¤šä¸ªæ¥å£</li>
<li>å‡å°‘ä»£ç é‡ï¼Œä¸éœ€è¦ä¸ºæ¯ä¸ªç›®æ ‡ç±»åˆ›å»ºä»£ç†ç±»</li>
<li>å¯ä»¥åœ¨è¿è¡Œæ—¶å†³å®šä»£ç†å“ªä¸ªå¯¹è±¡</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>JDKåŠ¨æ€ä»£ç†åªèƒ½ä»£ç†å®ç°äº†æ¥å£çš„ç±»</li>
<li>CGLIBä¸èƒ½ä»£ç†finalç±»æˆ–finalæ–¹æ³•</li>
<li>åŠ¨æ€ä»£ç†çš„æ€§èƒ½ç•¥ä½äºé™æ€ä»£ç†ï¼ˆä½†å½±å“é€šå¸¸å¾ˆå°ï¼‰</li>
</ul>
<h2 data-id="heading-10">é™æ€ä»£ç† vs åŠ¨æ€ä»£ç†ï¼šæ ¸å¿ƒå¯¹æ¯”</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th>é™æ€ä»£ç†</th><th>åŠ¨æ€ä»£ç†</th></tr></thead><tbody><tr><td><strong>å®ç°æ—¶æœº</strong></td><td>ç¼–è¯‘æ—¶</td><td>è¿è¡Œæ—¶</td></tr><tr><td><strong>å®ç°æ–¹å¼</strong></td><td>æ‰‹åŠ¨ç¼–å†™ä»£ç†ç±»</td><td>é€šè¿‡åå°„æˆ–å­—èŠ‚ç ç”Ÿæˆ</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>ä½ï¼Œä¸€ä¸ªä»£ç†ç±»åªèƒ½ä»£ç†ä¸€ä¸ªæ¥å£</td><td>é«˜ï¼Œä¸€ä¸ªä»£ç†ç±»å¯ä»¥ä»£ç†å¤šä¸ªæ¥å£</td></tr><tr><td><strong>ä»£ç é‡</strong></td><td>å¤šï¼Œéœ€è¦ä¸ºæ¯ä¸ªç›®æ ‡ç±»ç¼–å†™ä»£ç†ç±»</td><td>å°‘ï¼Œé€šè¿‡é€šç”¨ä»£ç å¤„ç†å¤šä¸ªç±»</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>ç•¥é«˜ï¼ˆç›´æ¥è°ƒç”¨ï¼‰</td><td>ç•¥ä½ï¼ˆåå°„è°ƒç”¨ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ¥å£æ–¹æ³•å°‘ï¼Œä»£ç†é€»è¾‘ç®€å•</td><td>æ¥å£æ–¹æ³•å¤šï¼Œä»£ç†é€»è¾‘å¤æ‚</td></tr></tbody></table>
<h2 data-id="heading-11">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-12">é™æ€ä»£ç†é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰çš„ç®€å•å®ç°</li>
<li>æƒé™æ§åˆ¶</li>
<li>æœ¬åœ°è¿œç¨‹ä»£ç†</li>
</ul>
<h3 data-id="heading-13">åŠ¨æ€ä»£ç†é€‚ç”¨åœºæ™¯</h3>
<ol>
<li><strong>Spring AOP</strong>ï¼šSpringæ¡†æ¶ä½¿ç”¨JDKåŠ¨æ€ä»£ç†å’ŒCGLIBå®ç°AOP</li>
<li><strong>MyBatis</strong>ï¼šMapperæ¥å£çš„ä»£ç†å®ç°</li>
<li><strong>RPCæ¡†æ¶</strong>ï¼šè¿œç¨‹æ–¹æ³•è°ƒç”¨çš„å®¢æˆ·ç«¯ä»£ç†</li>
<li><strong>äº‹åŠ¡ç®¡ç†</strong>ï¼šå£°æ˜å¼äº‹åŠ¡çš„å®ç°</li>
<li><strong>æ—¥å¿—è®°å½•</strong>ï¼šæ–¹æ³•è°ƒç”¨çš„æ—¥å¿—è®°å½•</li>
</ol>
<h3 data-id="heading-14">Springæ¡†æ¶ä¸­çš„ä»£ç†ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Springä¸­å¸¸ç”¨çš„æ³¨è§£é©±åŠ¨ä»£ç†</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-meta">@LogExecutionTime</span> <span class="hljs-comment">// è‡ªå®šä¹‰æ³¨è§£ï¼Œé€šè¿‡AOPå®ç°æ–¹æ³•æ‰§è¡Œæ—¶é—´æ—¥å¿—</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">findUserById</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
        <span class="hljs-keyword">return</span> userRepository.findById(id);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-meta">@PreAuthorize("hasRole('ADMIN')")</span> <span class="hljs-comment">// Spring Securityæƒé™æ§åˆ¶</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
        userRepository.deleteById(id);
    }
}
</code></pre>
<h2 data-id="heading-15">æ€»ç»“</h2>
<p>ä»£ç†æ¨¡å¼æ˜¯Javaä¸­éå¸¸é‡è¦ä¸”å®ç”¨çš„è®¾è®¡æ¨¡å¼ã€‚é™æ€ä»£ç†ç®€å•ç›´è§‚ï¼Œé€‚åˆç®€å•çš„ä»£ç†éœ€æ±‚ï¼›åŠ¨æ€ä»£ç†çµæ´»å¼ºå¤§ï¼Œé€‚åˆå¤æ‚çš„ç³»ç»Ÿæ¶æ„ã€‚ç†è§£ä¸¤è€…çš„åŸç†å’Œé€‚ç”¨åœºæ™¯ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­åšå‡ºæ›´åˆé€‚çš„æŠ€æœ¯é€‰æ‹©ã€‚</p>
<p>æ— è®ºæ˜¯é™æ€ä»£ç†è¿˜æ˜¯åŠ¨æ€ä»£ç†ï¼Œå®ƒä»¬éƒ½ä½“ç°äº†é¢å‘å¯¹è±¡è®¾è®¡çš„ä¸€ä¸ªé‡è¦åŸåˆ™ï¼š<strong>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</strong>ã€‚é€šè¿‡ä»£ç†æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„åŸºç¡€ä¸Šï¼Œä¸ºç³»ç»Ÿæ·»åŠ æ–°çš„åŠŸèƒ½ï¼Œè¿™å¤§å¤§æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[zustand ä»åŸç†åˆ°å®è·µ - åŸç†ç¯‡(1)]]></title>    <link>https://juejin.cn/post/7579165599042273295</link>    <guid>https://juejin.cn/post/7579165599042273295</guid>    <pubDate>2025-12-03T02:59:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579165599042273295" data-draft-id="7575031395862003758" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="zustand ä»åŸç†åˆ°å®è·µ - åŸç†ç¯‡(1)"/> <meta itemprop="keywords" content="React.js"/> <meta itemprop="datePublished" content="2025-12-03T02:59:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é²¨å”"/> <meta itemprop="url" content="https://juejin.cn/user/413072101215944"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            zustand ä»åŸç†åˆ°å®è·µ - åŸç†ç¯‡(1)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/413072101215944/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é²¨å”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:59:01.000Z" title="Wed Dec 03 2025 02:59:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åˆè¯† zustand</h2>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯ zustand ï¼Ÿ</h3>
<p>æ²¡é”™ï¼Œzustand åˆæ˜¯ä¸€ä¸ªåŸºäº React çš„çŠ¶æ€ç®¡ç†åº“ã€‚Zustand çš„å‘éŸ³ä¸º /ËˆzuËstÃ¦nd/ã€‚è¯¥è¯æºè‡ªå¾·è¯­ï¼Œæœ¬ä¹‰å°±æ˜¯â€œçŠ¶æ€â€ï¼ˆcondition, stateï¼‰ï¼Œä¸åº“çš„æ ¸å¿ƒåŠŸèƒ½â€œçŠ¶æ€ç®¡ç†â€æ­£å¥½åŒä¹‰ï¼Œç®—æ˜¯ä¸€ç§â€œç›´ç»™å¼â€å‘½åã€‚</p>
<p>ä¹Ÿè®¸ä½ ä¼šé—®ï¼Œä»åˆç”Ÿä»£çš„ reduxï¼Œmobx å’Œ xstateï¼Œå†åˆ°ä¸­ç”Ÿä»£çš„å…¶ä»–çš„çŠ¶æ€ç®¡ç†åº“ï¼Œå¦‚ redux + reduxToolkitï¼Œcontext baseï¼Œ recoilï¼Œjotaiç­‰ï¼Œå¯ä¾›é€‰æ‹©çš„ react çš„ç¬¬ä¸‰æ–¹çŠ¶æ€ç®¡ç†åº“å·²ç»æœ‰äº†å¾ˆå¤šï¼Œé‚£ä¹ˆæˆ‘ä¸ºä»€ä¹ˆè¿˜è¦é€‰æ‹© zustand å‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼Œzustand è¶³å¤Ÿç®€å•ã€å¿«é€Ÿã€é«˜æ€§èƒ½ï¼Œç‰¹åˆ«é€‚åˆäºä¸­å°å‹é¡¹ç›®ï¼ˆå¤§éƒ¨åˆ†äººåšçš„å°±æ˜¯è¿™ç§è§„æ¨¡çš„é¡¹ç›®ï¼‰ï¼Œæˆ–è€…éœ€è¦ä»¥ç‰¹åˆ«ä½çš„æˆæœ¬å¿«é€Ÿå®ç°çŠ¶æ€ç®¡ç†çš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-2">zustand ç‰¹ç‚¹</h3>
<h4 data-id="heading-3">ç®€å•</h4>
<p>è¯´å®ƒç®€å•ï¼Œæ˜¯å› ä¸ºæ ¸å¿ƒçš„ API æ•°é‡åªæœ‰ä¸‰ä¸ªï¼š<code>create()</code>ã€<code>useBoundStore()</code>ã€<code>setState()</code>ã€‚è¿™ä½¿å¾—å®ƒéå¸¸æ˜“äºå­¦ä¹ å’Œä½¿ç”¨ï¼Œå³ä½¿æ˜¯ React æ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹ã€‚</p>
<blockquote>
<p>æ‰€è°“çš„ã€ŒuseBoundStoreã€å°±æ˜¯æŒ‡é€šè¿‡é€šè¿‡é—­åŒ…æ¥ã€Œç»‘å®šã€äº†ä½ é€šè¿‡<code>create()</code>æ¥åˆ›å»ºçš„ zustand store å®ä¾‹çš„è‡ªå®šä¹‰ hook å‡½æ•°ã€‚è¿™é‡Œçš„â€œBoundâ€ï¼Œåœ¨ç†è§£ä¸Šè¦æ›¿æ¢ä¸ºç›¸åº”çš„ä¸šåŠ¡é¢†åŸŸçš„ scope åï¼Œæ¯”å¦‚ <code>useUserStore</code>ã€‚</p>
</blockquote>
<p>è€Œè¿™äº›æ ¸å¿ƒçš„ APIè®¾è®¡æ—¶å€™çš„å‡½æ•°ç­¾åä½¿ç”¨çš„éƒ½æ˜¯å·²ç»è¢«ç¤¾åŒºæ™®éæ¥å—çš„å¿ƒæ™ºæ¨¡å‹ï¼š</p>
<ul>
<li><code>create()</code>ï¼šç”¨äºåˆ›å»ºä¸€ä¸ªçŠ¶æ€çš„ storeã€‚ä½¿ç”¨ä¹‹åˆï¼Œå…ˆåˆ›å»ºä¸€ä¸ª storeï¼Œè¿™å¯¹äºä½¿ç”¨è¿‡ redux çš„äººç¾¤æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒç†ŸçŸ¥çš„æ¦‚å¿µã€‚</li>
<li><code>useBoundStore()</code>ï¼šç”¨äºåœ¨ç»„ä»¶ä¸­è®¢é˜…çŠ¶æ€å˜åŒ–å¹¶è·å–çŠ¶æ€å€¼ã€‚åœ¨ react çš„ hook æ—¶ä»£ï¼Œè¦æƒ³ä½¿ç”¨ storeï¼Œå…ˆ useXxx ä¸€ä¸‹ï¼Œè¿™å‡ ä¹æˆä¸ºäº† react å¼€å‘è€…çš„æ€ç»´æƒ¯æ€§äº†ã€‚è€Œä¸”è¿™ä¸ä½¿ç”¨ redux ä¸­çš„ <code>useSelector()</code> æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚</li>
<li><code>setState()</code>ï¼šç”¨äºæ›´æ–°çŠ¶æ€å€¼ã€‚</li>
</ul>
<p>è¯´å®ƒç®€å•çš„å¦ä¸€ä¸ªåŸå› æ˜¯ä» redux ä¹‹å‰çš„åŸå§‹èŒƒå¼çš„è§†è§’æ¥è®²çš„ã€‚åœ¨ redux çš„åŸå§‹èŒƒå¼é‡Œé¢ï¼ŒçŠ¶æ€ç®¡ç†çš„æ¦‚å¿µå’Œä»£ç æ˜¯æ‹†åˆ†å¾—å¾ˆç»†çš„ã€‚è¿™é‡Œé¢æœ‰ store, stateï¼Œreducerï¼Œactionï¼Œdispatch ç­‰ã€‚ç”±äº redux æ¯”è¾ƒæ¨å´‡å•ä¸€ store æ¨¡å¼ï¼Œå¾€å¾€ä½ è¿˜è¦ combine ä¸€ä¸‹ æ‰€æœ‰çš„ reducerã€‚å¦‚æœå†åŠ ä¸Šå®ƒçš„ä¸‰å±‚æ´‹è‘±æ¨¡å‹çš„ä¸­é—´ä»¶æœºåˆ¶ï¼ŒçŠ¶æ€ç®¡ç†çš„ä»£ç å°±ä¼šå˜å¾—æ¯”è¾ƒå¤æ‚äº†ã€‚å½“ç„¶ï¼Œè¿™ä¹ˆåšå¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥éå¸¸æ¸…æ™°åœ°çœ‹åˆ°ä¸€ä¸ªå•å‘çš„æ•°æ®æµï¼Œä¸”çŠ¶æ€ç®¡ç†çš„æ¯ä¸€ä¸ªç¯èŠ‚éƒ½å¯ä»¥è¢«å®¡è§†ï¼Œè¿™å¯¹äºè°ƒè¯•å’Œç»´æŠ¤éƒ½æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚æ‰€ä»¥ï¼Œå½“å‰ç¤¾åŒºçš„æ™®éçš„è®¤çŸ¥æ˜¯ï¼Œ redux çš„çŠ¶æ€ç®¡ç†èŒƒå¼æ˜¯æ›´é€‚ç”¨äºå¤§è§„æ¨¡çš„ï¼Œé•¿æœŸç»´æŠ¤çš„å‰ç«¯é¡¹ç›®ã€‚</p>
<p>è€Œ zustand åˆ™æ˜¯åŸºäºè¿™ä¸ªåŸå§‹èŒƒå¼çš„ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬ã€‚ zustand åªä¿ç•™äº† store çš„æ¦‚å¿µã€‚ä¸€åˆ‡éƒ½æ˜¯å›´ç»• store å±•å¼€çš„ã€‚æ— éå°±æ˜¯ä¸‰éƒ¨æ›²ï¼š</p>
<ol>
<li>å®šä¹‰ storeï¼ˆåŒ…å«äº† state å’Œ actionï¼‰ - <code>StateCreator</code>ï¼›</li>
<li>åˆ›å»º store - <code>create</code>ï¼›</li>
<li>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ store - <code>useBoundStore</code>ã€‚</li>
</ol>
<h4 data-id="heading-4">çµæ´»</h4>
<p>zustand æ˜¯å¾ˆçµæ´»çš„ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ï¼ˆreact ç¯å¢ƒå’Œé react ç¯å¢ƒï¼‰å»è°ƒç”¨ <code>setState()</code> æ¥è§¦å‘ react ç•Œé¢æ›´æ–°ã€‚å®ƒå®ç°çµæ´»çš„ç§˜è¯€åœ¨äºå……åˆ†åˆ©ç”¨äº† react åŸç”Ÿ API <code>useSyncExternalStore</code> å¯¹é react ç¯å¢ƒè§¦å‘ state æ›´æ–°çš„çš„æ”¯æŒå’Œ js ä¸­å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡çš„è¯­è¨€ç‰¹æ€§ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ä¸­çš„ã€Œé react ç¯å¢ƒã€æŒ‡çš„å°±æ˜¯ã€Œéç»„ä»¶å‡½æ•°ä½œç”¨åŸŸã€ã€‚æ¢å¥è¯ï¼Œå°±æ˜¯æŒ‡é‚£äº›ä¸èƒ½è°ƒç”¨ react hook å‡½æ•°çš„åœ°æ–¹ã€‚</p>
</blockquote>
<p>ä¸€å¥è¯ï¼Œä¸»è¦ä½ èƒ½æ‹¿åˆ° zustand store çš„ <code>setState()</code> å‡½æ•°ï¼Œå°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è§¦å‘ react ç•Œé¢æ›´æ–°ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸‹é¢ä»£ç çš„ storeï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> create <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>

<span class="hljs-keyword">const</span> useBoundStore = <span class="hljs-title function_">create</span>(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
  <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> })),
}))
</code></pre>
<p>é‚£ä¹ˆï¼Œæ€æ ·æ‹¿åˆ° <code>setState()</code> handlerå‘¢ï¼Ÿæ–¹æ³•æœ‰äºŒã€‚</p>
<h5 data-id="heading-5">æ–¹æ³•ä¸€</h5>
<p>zustand ä¼šå¾€ <code>StateCreator</code> æ³¨å…¥ <code>setState()</code> å‡½æ•°å¼•ç”¨ã€‚ä½ å¯ä»¥åœ¨ <code>StateCreator</code> ä¸­é€šè¿‡ç›´æ¥ä½¿ç”¨ <code>setState()</code> å‡½æ•°æ¥å®šä¹‰ actionã€‚ç„¶åï¼Œåœ¨ç»„ä»¶ä¸­ä½¿ç”¨ <code>useStore()</code> æ¥è·å– action å‡½æ•°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { useBoundStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'./store'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">useBoundStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span>)
  <span class="hljs-keyword">const</span> increment = <span class="hljs-title function_">useBoundStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">increment</span>)

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increment}</span>&gt;</span>Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<h5 data-id="heading-6">æ–¹æ³•äºŒ</h5>
<p>zustand å·²ç»åˆ©ç”¨ã€Œå‡½æ•°å³å¯¹è±¡ã€çš„è¯­è¨€ç‰¹æ€§ï¼ŒæŠŠ store å®ä¾‹çš„ API ï¼ˆè¿™é‡Œé¢å°±åŒ…å«äº† <code>setState()</code>æ–¹æ³•ï¼‰æŒ‚è½½åˆ°è¿”å›çš„ <code>useStore()</code> å‡½æ•°ä¸Šé¢äº†ã€‚æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ <code>useBoundStore.setState()</code> æ¥è®¿é—® <code>setState()</code> å‡½æ•°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { useStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'./store'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">useStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span>)
  <span class="hljs-keyword">const</span> setState = useStore.<span class="hljs-property">setState</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setState({ count: count + 1 })}&gt;Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p>å› ä¸º <code>useBoundStore</code> æ—¢æ˜¯ä¸€ä¸ª hookï¼Œ åˆæ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°å¯¹è±¡ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨å®ƒï¼ŒåŒ…æ‹¬é react ç¯å¢ƒã€‚è¿™è¿›ä¸€æ­¥æé«˜äº† zustand åœ¨ä½¿ç”¨ä¸Šçš„çµæ´»åº¦ã€‚æ¯”å¦‚ï¼Œä½ å®Œå…¨å¯ä»¥è¿™ä¹ˆç”¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { useBoundStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'./store'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"/>) =&gt;
  useBoundStore.<span class="hljs-title function_">setState</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> }))

<span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">useBoundStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span>)

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increment}</span>&gt;</span>Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<h4 data-id="heading-7">é«˜æ€§èƒ½</h4>
<p>è¿™é‡Œçš„é«˜æ€§èƒ½æŒ‡çš„æ˜¯ï¼Œzustand å®ç°äº†çœŸæ­£çš„ã€ŒæŒ‰éœ€æ¸²æŸ“ã€ã€‚ä»€ä¹ˆæ˜¯æŒ‰éœ€æ¸²æŸ“ï¼Ÿç®€å•æ¥è¯´ï¼Œå°±æ˜¯<strong>åªæœ‰å½“ç»„ä»¶ä¸­ä½¿ç”¨åˆ°çš„çŠ¶æ€å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šè§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“</strong>ã€‚ç›¸æ¯”äº redux+ react-redux çš„æ—©æœŸç‰ˆæœ¬æˆ–è€… context provider + useContext çš„è¿™ç§ã€Œå…¨é‡åˆ·æ–°ã€çš„æ¸²æŸ“æ–¹å¼ï¼Œzustand è°ˆå¾—ä¸Šã€Œé«˜æ€§èƒ½ã€äº†ã€‚</p>
<p>å½“ç„¶ï¼Œè¦æƒ³å®ç°è¿™ä¸ªã€ŒæŒ‰éœ€æ¸²æŸ“ã€çš„åŠŸèƒ½ï¼Œè¿˜éœ€è¦ä½œä¸ºå¼€å‘è€…çš„ä½ é…åˆ - ä½¿ç”¨ selector æ¥é€‰æ‹©ä½ éœ€è¦çš„çŠ¶æ€ã€‚selector æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯ store çš„å…¨é‡ stateï¼Œè¿”å›å€¼æ˜¯ä½ éœ€è¦çš„çŠ¶æ€ã€‚æ¯”å¦‚ï¼Œä½ åªéœ€è¦ count çŠ¶æ€ï¼Œå°±å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">useStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span>)
</code></pre>
<p>å‡å¦‚ä½ æ˜¯è¿™ä¹ˆå†™çš„è¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> countStore = <span class="hljs-title function_">useStore</span>()

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {countStore.count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p>é‚£ä¹ˆå°±ä¼šå‘ç”Ÿæ€§èƒ½å›é€€ - åªè¦ store çš„ä»»æ„ä¸€ä¸ª state å‘ç”Ÿäº†å˜åŒ–ï¼Œå“ªæ€•ä¸æ˜¯ count çš„å€¼æ”¹å˜äº†ï¼Œç»„ä»¶ä¹Ÿä¼š <code>MyComponent</code> ä¹Ÿä¼šé‡æ–°æ¸²æŸ“ã€‚</p>
<p>å¦å¤–ä¸€ä¸ªæ³¨æ„ç‚¹æ˜¯ï¼Œå¦‚æœä½ æ‰€è®¢é˜…çš„å€¼æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œæ¯”å¦‚å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œå¦‚æœè¿˜æ˜¯åƒä¸Šé¢è¿™ç§å†™æ³•çš„è¯ï¼Œé‚£ä¹ˆå°±å¾ˆå®¹æ˜“å‘ç”Ÿæ€§èƒ½å›é€€ï¼ˆå…·ä½“çš„ä¾‹å­å¯ä»¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fzustand.docs.pmnd.rs%2Fhooks%2Fuse-shallow%23useshallow-%25E2%259A%259B%25EF%25B8%258F" target="_blank" title="https://zustand.docs.pmnd.rs/hooks/use-shallow#useshallow-%E2%9A%9B%EF%B8%8F" ref="nofollow noopener noreferrer">å®˜ç½‘ç»™å‡ºçš„ä¾‹å­</a>ï¼‰ã€‚</p>
<p>å¯¹äºè¿™ç§æƒ…å†µï¼Œä½ å°±éœ€è¦å†ç”¨ <code>useShallow</code> æ¥åŒ…ä¸€å±‚ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">BearNames</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> names = <span class="hljs-title function_">useBearFamilyMealsStore</span>(
    <span class="hljs-title function_">useShallow</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(state)),
  )

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{names.join(', ')}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<h3 data-id="heading-8">å®ƒç›¸æ¯”äº redux æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<p>ä»æºç å®ç°è§’åº¦æ¥è¯´ï¼Œzustand å°±æ˜¯ redux çš„ä¸€ä¸ªç»§ä»»è€…ã€‚è¿™ä¸€ç‚¹å¯ä»¥ä» vanilla create API çš„å®ç°å¯ä»¥çœ‹å‡ºã€‚vanilla create API çš„å®ç°å‡ ä¹æ˜¯â€œæŠ„â€äº† redux çš„æ ¸å¿ƒå®ç°ã€‚zustand åŒæ ·å®ç°äº† storeï¼Œ middleware ç­‰ä¸¤ä¸ªæ¦‚å¿µï¼Œ è¿ devtool éƒ½æ˜¯å¤ç”¨ redux çš„ chrome devtoolã€‚ä¸åŒçš„æ˜¯ï¼Œzustand æ²¡æœ‰åšå®ˆ redux çš„ä¸¥æ ¼çš„å•å‘æ•°æ®æµçš„è®¾è®¡ä¸­å…¶ä»–è¯¥æ¦‚å¿µï¼Œæ¯”å¦‚è¯´ï¼šreducerï¼Œ actionï¼Œ dispatch ç­‰ã€‚ç„¶è€Œï¼Œæ­£å¦‚å®˜ç½‘æ‰€æŒ‡å‡ºçš„é‚£æ ·ï¼Œä½ ä»ç„¶å¯ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fzustand.docs.pmnd.rs%2Fguides%2Fflux-inspired-practice%23redux-like-patterns" target="_blank" title="https://zustand.docs.pmnd.rs/guides/flux-inspired-practice#redux-like-patterns" ref="nofollow noopener noreferrer">æŠŠ zustand å†™æˆ redux çš„å•å‘æ•°æ®æµçš„æ ·å­</a>ã€‚</p>
<p>ä»ä½¿ç”¨å±‚é¢æ¥è¯´ï¼Œzustand æ¯” redux èŒƒå¼æ›´åŠ çš„æ¾æ•£å’Œçµæ´»ï¼ˆunopinionatedï¼‰ã€‚å®ƒæ²¡æœ‰é‚£å¥—åƒ redux é‚£æ ·ç¨æ˜¾å¾—å†—ä½™çš„æ¨¡æ¿ä»£ç ã€‚ç®€ç›´å¯ä»¥è¯´ï¼Œæ€ä¹ˆå†™æ€ä¹ˆæœ‰ã€‚å¦å¤–ä¸€ä¸ªæœ€å¤§çš„ä¸åŒæ˜¯ï¼Œzustand å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹å»è°ƒç”¨ <code>setState()</code> æ¥è§¦å‘ react ç•Œé¢æ›´æ–°ã€‚è¿™ä¸€ç‚¹æ˜¯ redux åšä¸åˆ°çš„ã€‚</p>
<p>å¦å¤–çš„ä¸€ä¸ªä¸åŒç‚¹æ˜¯æ¸²æŸ“æ€§èƒ½æ–¹é¢çš„ã€‚zustand ä»ç¬¬ä¸€ç‰ˆæœ¬å°±å®ç°äº†ç»„ä»¶çš„æŒ‰éœ€æ¸²æŸ“ã€‚è€Œ redux é‚£è¾¹ï¼Œåœ¨ redux toolkit è¿˜æ²¡æœ‰æ¨å‡ºä¹‹å‰ï¼Œéƒ½æ˜¯ã€Œå…¨é‡åˆ·æ–°ã€çš„æ¸²æŸ“æ–¹å¼ã€‚æŠŠ redux toolkit çœ‹ä½œåŠ å¼ºç‰ˆçš„ redux çš„è¯ï¼Œé‚£ä¹ˆåœ¨ã€ŒæŒ‰éœ€æ¸²æŸ“ã€æ–¹é¢ï¼Œzustand å’Œ redux åˆ°ç›®å‰ä¸ºæ­¢ï¼Œéƒ½æ˜¯æ”¯æŒé€šè¿‡ selector æ¥å®ç°è¿™ä¸ªåŠŸèƒ½äº†ã€‚</p>
<h3 data-id="heading-9">å¿«é€Ÿå…¥é—¨</h3>
<p>æ­£å¦‚ä¸Šé¢ã€Œç‰¹ç‚¹ã€å°èŠ‚æ‰€æåˆ°çš„é‚£æ ·ï¼Œzustand ä¸Šæ‰‹æ˜¯å¾ˆç®€å•çš„ - å°±æ˜¯ä¸‰éƒ¨æ›²ï¼š</p>
<ol>
<li>åˆ›å»º store</li>
<li>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ <code>useBoundStore()</code> æ¥è·å–çŠ¶æ€å’Œ action å‡½æ•°</li>
<li>åœ¨ç»„ä»¶ä¸­è°ƒç”¨ action å‡½æ•°æ¥è§¦å‘çŠ¶æ€æ›´æ–°</li>
</ol>
<p>ä¸‹é¢ç›´æ¥æŠŠå®˜ç½‘çš„ demo æ¬è¿‡æ¥ï¼Œæ•´ä¸ªä¸‰éƒ¨æ›²å°±ä¸€æ­¥äº†ç„¶äº†ï¼š</p>
<ol>
<li><strong>åˆ›å»º store</strong></li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>

<span class="hljs-keyword">const</span> useBearStore = <span class="hljs-title function_">create</span>(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
  <span class="hljs-attr">bears</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">increasePopulation</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">bears</span>: state.<span class="hljs-property">bears</span> + <span class="hljs-number">1</span> })),
  <span class="hljs-attr">removeAllBears</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">bears</span>: <span class="hljs-number">0</span> }),
  <span class="hljs-attr">updateBears</span>: <span class="hljs-function">(<span class="hljs-params">newBears</span>) =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">bears</span>: newBears }),
}))
</code></pre>
<ol start="2">
<li><strong>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ <code>useBoundStore()</code> æ¥è·å–çŠ¶æ€å’Œ action å‡½æ•°</strong></li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">BearCounter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> bears = <span class="hljs-title function_">useBearStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">bears</span>)
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{bears} bears around here...<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Controls</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> increasePopulation = <span class="hljs-title function_">useBearStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">increasePopulation</span>)
  <span class="hljs-comment">//......</span>
}
</code></pre>
<ol start="3">
<li>åœ¨ç»„ä»¶ä¸­è°ƒç”¨ action å‡½æ•°æ¥è§¦å‘çŠ¶æ€æ›´æ–°</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Controls</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> increasePopulation = <span class="hljs-title function_">useBear</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">increasePopulation</span>)
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increasePopulation}</span>&gt;</span>one up<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
}
</code></pre>
<p>å¥½äº†ï¼Œåˆ°è¿™å°±å…¥é—¨æˆåŠŸäº†ã€‚</p>
<h2 data-id="heading-10">åŸç†æ­ç§˜</h2>
<p>ä¸Šé¢çš„ç®€ä»‹åªæ˜¯ä¸€ä¸ªçƒ­èº«æ´»åŠ¨ï¼Œç›®çš„æ˜¯è®©ä½ å¯¹ zustand çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•å’Œç‰¹æ€§æœ‰ä¸€ä¸ªå°è±¡ã€‚ä¸‹é¢æˆ‘ä»¬æ¥æ­ç§˜ä¸€ä¸‹å®ƒçš„åŸç†ï¼Œä»¥ä¾¿äºä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ zustandã€‚</p>
<h3 data-id="heading-11">æºç æ¡†æ¶</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹çœ‹æºç çš„ç›®å½•ç»“æ„</p>
<pre><code class="hljs language-bash" lang="bash">zustand/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                    <span class="hljs-comment"># é»˜è®¤å…¥å£ï¼šå¯¼å‡º createï¼ˆReact ç‰ˆï¼‰</span>
â”‚   â”œâ”€â”€ vanilla.ts                  <span class="hljs-comment"># æ¡†æ¶æ— å…³æ ¸å¿ƒï¼šcreateStore</span>
â”‚   â”œâ”€â”€ react.ts                    <span class="hljs-comment"># React ç»‘å®šï¼šuseSyncExternalStore å°è£…</span>
â”‚   â”œâ”€â”€ traditional.ts              <span class="hljs-comment"># React 16/17 å…¼å®¹å…¥å£ï¼ˆè‡ªåŠ¨å«ç‰‡ï¼‰</span>
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ combine.ts
â”‚   â”‚   â”œâ”€â”€ devtools.ts
â”‚   â”‚   â”œâ”€â”€ immer.ts
â”‚   â”‚   â”œâ”€â”€ persist/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ storage.ts
â”‚   â”‚   â”œâ”€â”€ redux.ts
â”‚   â”‚   â””â”€â”€ subscribeWithSelector.ts
â”‚   â”œâ”€â”€ vanilla/
â”‚   â”‚   â”œâ”€â”€ shallow.ts              <span class="hljs-comment"># æµ…æ¯”è¾ƒå‡½æ•°ï¼ˆä¾› vanilla ç”¨æˆ·ï¼‰</span>
â”‚   â”œâ”€â”€ react/
â”‚   â”‚   â”œâ”€â”€ shallow.ts              <span class="hljs-comment"># useShallow Hook</span>
â”‚   â””â”€â”€ types.d.ts                    <span class="hljs-comment"># å…¨å±€ TypeScript ç±»å‹å®šä¹‰</span>
</code></pre>
<p>zustand çš„æ ¸å¿ƒä»£ç é‡‡ç”¨äº†åˆ†å±‚æ¶æ„ï¼Œç›®çš„æ˜¯ä¸ºäº†åšåˆ°æ¡†æ¶æ— å…³æ€§ã€‚zustand çš„æ ¸å¿ƒä»£ç åˆ†ä¸¤å±‚ï¼š</p>
<ul>
<li>vanilla å±‚ - ä¹Ÿå°±æ˜¯åŸç”Ÿå±‚ï¼Œæ˜¯çº¯ javascript å®ç°ï¼Œå®ƒä¸ä¾èµ–ä»»ä½•çš„è§†å›¾å±‚æ¡†æ¶ã€‚</li>
<li>binding å±‚ - ä¹Ÿå°±æ˜¯æ¡¥æ¥ç‰¹å®šçš„è§†å›¾å±‚æ¡†æ¶ã€‚å½“å‰ï¼Œè¿™ä¸ªè§†å›¾å±‚æ¡†æ¶å°±æ˜¯ reactã€‚</li>
</ul>
<p>è¿™ä¸¤å±‚ä¹‹é—´çš„å…³è”å¯ä»¥ä»ä¸‹é¢çš„çš„é¸Ÿç°å›¾ä¸­çœ‹å‡ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/982ec4f1beb3455cb0898ee32f38414a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bKo5Y-U:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335540&amp;x-signature=IAafzB7Mg%2FIpta2f%2BokK%2F88JqGQ%3D" alt="image.png" loading="lazy"/></p>
<p>ç®€å•æ¥è¯´ï¼Œzustand é€šè¿‡ react åŸç”Ÿ API <code>useSyncExternalStore</code> æŠŠ react å†…éƒ¨çš„ listenerï¼ˆreact core åœ¨å†…éƒ¨å®ç°ä¼šåˆ›å»ºä¸€ä¸ª listenrï¼‰ æ³¨å†Œåˆ° zustand åŸç”Ÿ store å®ä¾‹çš„ listener æ•°ç»„ä¸­ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œreact ç»„ä»¶å°±æˆä¸ºäº† zustand åŸç”Ÿ store å®ä¾‹çš„ä¼—å¤šè®¢é˜…è€…ä¸­çš„ä¸€å‘˜ã€‚</p>
<p>å½“ç”¨æˆ·ä»£ç è°ƒç”¨ store action çš„æ—¶å€™ï¼Œé—´æ¥å°±è°ƒç”¨äº† store å®ä¾‹çš„ setState æ–¹æ³•ã€‚è€Œåœ¨ setState æ–¹æ³•çš„æºç å®ç°ä¸­ï¼Œzustand ä¼šéå†è°ƒç”¨æ‰€æœ‰çš„ listener å‡½æ•°ã€‚è€Œè¿™äº› listener å‡½æ•°ä¸­ï¼Œå°±åŒ…æ‹¬äº† react ç»„ä»¶ã€‚è¿™å°±æ˜¯åœ¨é€šçŸ¥ react ç»„ä»¶ç€æ‰‹å»åˆ¤æ–­ç»„ä»¶æ˜¯å¦çœŸçš„éœ€è¦æ›´æ–°ã€‚</p>
<p>åœ¨æ‰§è¡Œ react æ³¨å†Œåˆ° store å®ä¾‹çš„ listener çš„æ—¶å€™ï¼Œreact ä¼šå¯¹æ¯”å‰åä¸¤æ¬¡çš„ snapshot çš„å€¼ï¼Œå¦‚æœå€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œ react å°±ä¼šå‘èµ·ä¸€ä¸ªè¯·å¼ºåˆ¶æ›´æ–°çš„è¯·æ±‚ï¼ˆ<code>forceStoreRerender(fiber)</code>ï¼‰ã€‚é‚£ä¹ˆï¼Œè¯¥ react ç»„ä»¶å°±ä¼šåœ¨ä¸‹ä¸€è½®çš„ render é˜¶æ®µçš„æ—¶å€™å¾—åˆ° rerenderã€‚</p>
<p>é™äºç¯‡å¹…ï¼Œæ›´å¤šç²¾å½©å†…å®¹è¯·æŸ¥çœ‹ä¸‹ç¯‡ã€Šzustand ä»åŸç†åˆ°å®è·µ - åŸç†ç¯‡(2)ã€‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€æºå¤§æ¨¡å‹å…¨ç»´åº¦è¯¦è§£+å®æ“éƒ¨ç½²ï¼ˆMistral-ã€Gemmaï¼ˆGoogleï¼‰ã€Llamaã€Qwenï¼‰ï¼Œå°ç™½å¿…çœ‹]]></title>    <link>https://juejin.cn/post/7579165599042371599</link>    <guid>https://juejin.cn/post/7579165599042371599</guid>    <pubDate>2025-12-03T03:06:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579165599042371599" data-draft-id="7579111646875418675" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€æºå¤§æ¨¡å‹å…¨ç»´åº¦è¯¦è§£+å®æ“éƒ¨ç½²ï¼ˆMistral-ã€Gemmaï¼ˆGoogleï¼‰ã€Llamaã€Qwenï¼‰ï¼Œå°ç™½å¿…çœ‹"/> <meta itemprop="keywords" content="LLM,Agent,LLaMA"/> <meta itemprop="datePublished" content="2025-12-03T03:06:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€æºå¤§æ¨¡å‹å…¨ç»´åº¦è¯¦è§£+å®æ“éƒ¨ç½²ï¼ˆMistral-ã€Gemmaï¼ˆGoogleï¼‰ã€Llamaã€Qwenï¼‰ï¼Œå°ç™½å¿…çœ‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:06:39.000Z" title="Wed Dec 03 2025 03:06:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>2025å¹´ï¼Œå¼€æºå¤§æ¨¡å‹èµ›é“å½»åº•è¿›å…¥ã€Œç²¾æ‚ä¸ºç‹ã€é˜¶æ®µâ€”â€”Mistral-ã€Gemmaï¼ˆGoogleï¼‰ã€Llamaã€Qwenç­‰é¡¶æµï¼Œä»¥7-8Bå‚æ•°é‡å®ç°ã€Œæ€§èƒ½ä¸ç¼©æ°´ã€éƒ¨ç½²é›¶é—¨æ§›ã€ï¼Œè¦†ç›–ä¸­æ–‡ã€å¤šè¯­è¨€ã€å®æ—¶æ¨ç†ã€åˆè§„åœºæ™¯ç­‰å…¨éœ€æ±‚ã€‚</p>
<p>æœ¬æ–‡èšç„¦è¿™5ä¸ªã€Œå°ç™½å‹å¥½å‹ã€æ ‡æ†æ¨¡å‹ï¼Œä»<strong>é€šä¿—æ¡ˆä¾‹â†’æ ¸å¿ƒåŸç†ï¼ˆå«æ·±åº¦å…¬å¼ï¼‰â†’é›¶é—¨æ§›æœåŠ¡å™¨å®æ“â†’5ç»´æ€§èƒ½å¯¹æ¯”</strong>å…¨æ–¹ä½æ‹†è§£ï¼Œé™„å¸¦è‡ªåŠ¨ä¸‹è½½æ•°æ®é›†çš„Pythoné¡¹ç›®ï¼ˆæ— éœ€ç¿»å¢™ã€æ— GUIä¹Ÿèƒ½è·‘ï¼‰ï¼Œè®©ä½ åŠå°æ—¶åƒé€å¼€æºå¤§æ¨¡å‹çš„æ ¸å¿ƒé€»è¾‘ä¸è½åœ°æŠ€å·§ï¼</p>
<h2 data-id="heading-0">ä¸€ã€äº”å¤§é¡¶æµå¼€æºå¤§æ¨¡å‹æ·±åº¦æ‹†è§£ï¼ˆåŸç†+å…¬å¼+é€šä¿—æ¡ˆä¾‹ï¼‰</h2>
<h3 data-id="heading-1">1. Qwen2-7Bï¼ˆé˜¿é‡Œï¼‰ï¼šä¸­æ–‡èƒ½åŠ›å¤©èŠ±æ¿2.0</h3>
<h4 data-id="heading-2">é€šä¿—æ¡ˆä¾‹</h4>
<p>è¾“å…¥ä¸­æ–‡å£è¯­åŒ–éœ€æ±‚ï¼šã€Œå¸®æˆ‘åˆ¤æ–­è¿™æ¡æ–‡æ¡ˆçš„æƒ…æ„Ÿå€¾å‘ï¼šâ€˜è¿™æ¬¾å›½äº§è€³æœºéŸ³è´¨ç»äº†ï¼Œç»­èˆªè¿˜èƒ½æ‰›ä¸€æ•´å¤©ï¼Œæ€§ä»·æ¯”ç›´æ¥æ‹‰æ»¡ï¼â€™ã€ï¼Œæ¨¡å‹0.1ç§’è¾“å‡ºã€Œç§¯ææƒ…æ„Ÿã€ï¼›è¾“å…¥ä¸“ä¸šä¸­æ–‡æ–‡æœ¬ï¼šã€Œç§‘åˆ›æ¿ä¼ä¸šç ”å‘æŠ•å…¥å æ¯”å¹³å‡è¾¾8.2%ï¼Œè¾ƒä¸»æ¿é«˜å‡º3.5ä¸ªç™¾åˆ†ç‚¹ã€ï¼Œç²¾å‡†å½’ç±»ä¸ºã€Œè´¢ç»ç±»æ–‡æœ¬ã€â€”â€”ä¸­æ–‡è¯­ä¹‰ç†è§£ã€å£è¯­/ä¹¦é¢è¯­/ä¸“ä¸šåœºæ™¯å…¨é€‚é…ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55ec420514e34f9d8a2fb5ec9e27bc2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335999&amp;x-signature=zi079C%2BFx3Kf81D1k2VzoFOOiWQ%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-3">æ ¸å¿ƒåŸç†+æ•°å­¦å…¬å¼</h4>
<p>Qwen2-7BåŸºäºTransformer-XLæ¶æ„ä¼˜åŒ–ï¼Œæ ¸å¿ƒåˆ›æ–°é›†ä¸­åœ¨ã€ŒåŠ¨æ€ä¸Šä¸‹æ–‡å»ºæ¨¡ã€å’Œã€Œä¸­æ–‡è¯­ä¹‰å¢å¼ºã€ï¼Œå…³é”®å…¬å¼å¦‚ä¸‹ï¼š</p>
<h5 data-id="heading-4">ï¼ˆ1ï¼‰åŠ¨æ€è‡ªé€‚åº”ä½ç½®ç¼–ç ï¼ˆ128Kä¸Šä¸‹æ–‡æ— å‹åŠ›ï¼‰</h5>
<p>ä¼ ç»ŸRoPEç¼–ç å¯¹è¶…é•¿æ–‡æœ¬ä½ç½®æ•æ„Ÿæ€§ä¸‹é™ï¼ŒQwen2å¼•å…¥æ–‡æœ¬é•¿åº¦è‡ªé€‚åº”å› å­ï¼Œè§£å†³é•¿æ–‡æœ¬ä½ç½®æ­§ä¹‰ï¼š</p>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=éšè—å±‚ç»´åº¦ç´¢å¼•ï¼ˆ0~4095ï¼‰ï¼Œ=æ–‡æœ¬ä½ç½®ç´¢å¼•ï¼Œ=å½“å‰æ–‡æœ¬é•¿åº¦ï¼Œ=æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆ128Kï¼‰ï¼Œ=éšè—å±‚æ€»ç»´åº¦ï¼ˆ4096ï¼‰ï¼Œ=å‘¨æœŸå‚æ•°ï¼ˆ10000ï¼‰ï¼Œ=Sigmoidå‡½æ•°ã€‚</li>
<li>æ ¸å¿ƒä½œç”¨ï¼šæ–‡æœ¬è¶Šé•¿ï¼Œæ­£å¼¦åˆ†é‡æƒé‡è¶Šé«˜ï¼Œå¼ºåŒ–é•¿è·ç¦»ä½ç½®å…³è”ï¼ˆå¦‚10Kå­—ä¸­æ–‡æ–‡æ¡£çš„é€»è¾‘è¿è´¯æ€§ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-5">ï¼ˆ2ï¼‰ä¸­æ–‡å¢å¼ºè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆè§£å†³ä¸­æ–‡åˆ†è¯æ­§ä¹‰ï¼‰</h5>
<p>é’ˆå¯¹ä¸­æ–‡æ— ç©ºæ ¼åˆ†éš”çš„ç‰¹ç‚¹ï¼ŒåŠ å…¥åˆ†è¯æ¦‚ç‡åŠ æƒå› å­ï¼š</p>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=æŸ¥è¯¢/é”®/å€¼çŸ©é˜µï¼Œ=å¤´ç»´åº¦ï¼ˆ4096/32=128ï¼‰ï¼Œ=æƒé‡å› å­ï¼ˆè®­ç»ƒä¹ å¾—ï¼Œé»˜è®¤0.4ï¼‰ï¼Œ=ä¸­æ–‡åˆ†è¯æ¦‚ç‡çŸ©é˜µï¼ˆåŸºäºé¢„è®­ç»ƒåˆ†è¯æ¨¡å‹è®¡ç®—ï¼Œå¦‚ã€Œç½‘çº¢/é›ªç³•ã€vsã€Œç½‘/çº¢é›ªç³•ã€çš„æ¦‚ç‡ï¼‰ã€‚</li>
<li>æ ¸å¿ƒä¼˜åŠ¿ï¼šå‡å°‘ä¸­æ–‡åˆ†è¯æ­§ä¹‰å¯¼è‡´çš„è¯­ä¹‰è¯¯è§£ï¼Œå‡†ç¡®ç‡æå‡8%-12%ã€‚</li>
</ul>
<h4 data-id="heading-6">æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li>ä¸­æ–‡æ”¯æŒï¼šSçº§ï¼ˆåˆ†è¯ã€è¯­ä¹‰ã€æ–‡åŒ–é€‚é…æ‹‰æ»¡ï¼‰ï¼›</li>
<li>ä¸Šä¸‹æ–‡çª—å£ï¼š128Kï¼ˆåŒç±»æœ€å¤§ï¼‰ï¼›</li>
<li>æ˜¾å­˜éœ€æ±‚ï¼š7.8GBï¼ˆåŠç²¾åº¦ï¼‰ï¼›</li>
<li>ä¼˜åŠ¿ï¼šå¤šä»»åŠ¡å…¼å®¹ï¼ˆåˆ†ç±»ã€æ‘˜è¦ã€ç¿»è¯‘ã€å¯¹è¯ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-7">2. Qwen1.5-7Bï¼ˆé˜¿é‡Œï¼‰ï¼šä¸­æ–‡å…¥é—¨é¦–é€‰</h3>
<h4 data-id="heading-8">é€šä¿—æ¡ˆä¾‹</h4>
<p>è¾“å…¥ç®€å•ä¸­æ–‡éœ€æ±‚ï¼šã€Œåˆ¤æ–­è¿™å¥è¯æ˜¯ä¸æ˜¯å¹¿å‘Šï¼šâ€˜æ–°åº—å¼€ä¸šï¼Œå…¨åœºæœè£…ä¹°ä¸€é€ä¸€ï¼Œé™æ—¶3å¤©â€™ã€ï¼Œæ¨¡å‹å¿«é€Ÿè¾“å‡ºã€Œæ˜¯å¹¿å‘Šã€ï¼›è¾“å…¥çŸ­å¥ï¼šã€Œä»Šå¤©çš„é›¨ä¸‹å¾—å¥½å¤§ï¼Œå‡ºé—¨è¦å¸¦ä¼ã€ï¼Œå‡†ç¡®è¯†åˆ«ä¸ºã€Œæ—¥å¸¸é—²èŠã€â€”â€”è½»é‡åŒ–ä¸­æ–‡ä»»åŠ¡æ€§ä»·æ¯”ä¹‹ç‹ã€‚</p>
<h4 data-id="heading-9">æ ¸å¿ƒåŸç†+æ•°å­¦å…¬å¼</h4>
<p>Qwen1.5-7Bæ˜¯Qwen2çš„ç®€åŒ–ç‰ˆï¼Œä¿ç•™æ ¸å¿ƒä¸­æ–‡ä¼˜åŒ–ï¼Œèšç„¦ã€Œä½æ˜¾å­˜+é«˜é€Ÿåº¦ã€ï¼š</p>
<h5 data-id="heading-10">ï¼ˆ1ï¼‰ç®€åŒ–ç‰ˆRoPEä½ç½®ç¼–ç ï¼ˆå¹³è¡¡æ€§èƒ½ä¸è®¡ç®—é‡ï¼‰</h5>
<p>ä¸ºå¶æ•°ä¸ºå¥‡æ•°</p>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼šä¸Qwen2ä¸€è‡´ï¼Œä»…å»æ‰åŠ¨æ€é•¿åº¦å› å­ï¼Œè®¡ç®—é‡é™ä½20%ã€‚</li>
<li>æ ¸å¿ƒä½œç”¨ï¼šåœ¨4K-32Kä¸Šä¸‹æ–‡çª—å£å†…ä¿æŒé«˜æ€§èƒ½ï¼ŒåŒæ—¶å‡å°‘æ˜¾å­˜å ç”¨ã€‚</li>
</ul>
<h5 data-id="heading-11">ï¼ˆ2ï¼‰ä¸­æ–‡è¯å‘é‡å¢å¼ºé¢„è®­ç»ƒç›®æ ‡</h5>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=æ–‡æœ¬é•¿åº¦ï¼Œ=n-gramçª—å£ï¼ˆé»˜è®¤5ï¼‰ï¼Œ=MLMä»»åŠ¡æƒé‡ï¼ˆ0.3ï¼‰ï¼Œ=æ©ç è¯­è¨€æ¨¡å‹æŸå¤±ï¼ˆä¸“é—¨é’ˆå¯¹ä¸­æ–‡è¯è¯­æ©ç ï¼Œå¦‚ã€Œ[MASK] æ‰‹æœºã€é¢„æµ‹ã€Œæ™ºèƒ½ã€ï¼‰ã€‚</li>
<li>æ ¸å¿ƒä¼˜åŠ¿ï¼šå¼ºåŒ–ä¸­æ–‡è¯è¯­çº§è¯­ä¹‰å»ºæ¨¡ï¼Œå°å‚æ•°é‡å®ç°é«˜ä¸­æ–‡ç†è§£èƒ½åŠ›ã€‚</li>
</ul>
<h4 data-id="heading-12">æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li>ä¸­æ–‡æ”¯æŒï¼šA+çº§ï¼›</li>
<li>ä¸Šä¸‹æ–‡çª—å£ï¼š32Kï¼›</li>
<li>æ˜¾å­˜éœ€æ±‚ï¼š6.5GBï¼ˆåŠç²¾åº¦ï¼‰ï¼›</li>
<li>ä¼˜åŠ¿ï¼šéƒ¨ç½²é—¨æ§›ä½ã€æ¨ç†é€Ÿåº¦å¿«ã€ä¸­æ–‡ä»»åŠ¡æ€§ä»·æ¯”æœ€é«˜ã€‚</li>
</ul>
<h3 data-id="heading-13">3. Llama-3-8Bï¼ˆMetaï¼‰ï¼šé€šç”¨æ€§ç‹è€…</h3>
<h4 data-id="heading-14">é€šä¿—æ¡ˆä¾‹</h4>
<p>è¾“å…¥è‹±æ–‡æŠ€æœ¯æ–‡æ¡£ï¼šã€ŒThe transformer architecture revolutionized NLP by enabling parallel computationã€ï¼Œæ¨¡å‹åˆ¤æ–­ä¸ºã€ŒæŠ€æœ¯ç±»æ–‡æœ¬ã€ï¼›è¾“å…¥æ³•æ–‡ï¼šã€ŒLe nouveau modÃ¨le de voiture Ã©lectrique a une autonomie de 600kmã€ï¼Œå‡†ç¡®å½’ç±»ä¸ºã€Œæ±½è½¦ç±»æ–‡æœ¬ã€ï¼›è¾“å…¥ä»£ç ç‰‡æ®µï¼šã€Œdef calculate_sum(a, b): return a + bã€ï¼Œè¯†åˆ«ä¸ºã€Œç¼–ç¨‹ä»£ç ã€â€”â€”å¤šè¯­è¨€+å¤šåœºæ™¯é€‚é…èƒ½åŠ›æ‹‰æ»¡ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f64a941de69846f7a3341e13ba7b5426~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335999&amp;x-signature=K4LmXYp%2BO5clsSYYibY2dyajo%2Bo%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-15">æ ¸å¿ƒåŸç†+æ•°å­¦å…¬å¼</h4>
<p>Llama-3-8Bçš„æ ¸å¿ƒåˆ›æ–°æ˜¯ã€Œåˆ†ç»„æŸ¥è¯¢æ³¨æ„åŠ›ï¼ˆGQAï¼‰ã€å’Œã€Œæ–‡æ¡£çº§è¯­ä¹‰å»ºæ¨¡ã€ï¼Œå¹³è¡¡é€šç”¨æ€§ä¸æ•ˆç‡ï¼š</p>
<h5 data-id="heading-16">ï¼ˆ1ï¼‰åˆ†ç»„æŸ¥è¯¢æ³¨æ„åŠ›ï¼ˆGQAï¼‰ï¼šæ˜¾å­˜ä¸æ€§èƒ½çš„å¹³è¡¡æœ¯</h5>
<p>å°†å¤šå¤´æ³¨æ„åŠ›çš„ã€ŒæŸ¥è¯¢å¤´ï¼ˆQ-Headï¼‰ã€åˆ†ç»„ï¼Œæ¯ç»„å…±äº«ã€Œé”®å¤´ï¼ˆK-Headï¼‰ã€å’Œã€Œå€¼å¤´ï¼ˆV-Headï¼‰ã€ï¼š</p>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=åˆ†ç»„æ•°ï¼ˆ8Bæ¨¡å‹ï¼‰ï¼Œ=ç¬¬ç»„çš„æŸ¥è¯¢/é”®/å€¼çŸ©é˜µï¼Œ=è¾“å‡ºæŠ•å½±çŸ©é˜µã€‚</li>
<li>æ ¸å¿ƒä¼˜åŠ¿ï¼šç›¸æ¯”æ ‡å‡†å¤šå¤´æ³¨æ„åŠ›ï¼ˆMHAï¼‰ï¼Œæ˜¾å­˜å ç”¨é™ä½30%ï¼Œæ¨ç†é€Ÿåº¦æå‡25%ï¼Œæ€§èƒ½æŸå¤±&lt;3%ã€‚</li>
</ul>
<h5 data-id="heading-17">ï¼ˆ2ï¼‰æ–‡æ¡£çº§è‡ªå›å½’é¢„è®­ç»ƒç›®æ ‡</h5>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=æ–‡æ¡£çº§æ¦‚ç‡åˆ†å¸ƒï¼Œ=å¥å­çº§æ¦‚ç‡åˆ†å¸ƒï¼Œ=æƒé‡å› å­ï¼ˆ0.1ï¼‰ï¼Œ=KLæ•£åº¦ã€‚</li>
<li>æ ¸å¿ƒä½œç”¨ï¼šå¼ºåŒ–å¥å­é—´é€»è¾‘å…³è”ï¼ˆå¦‚ã€ŒæŠ€æœ¯æ–‡æ¡£-æ ¸å¿ƒè§‚ç‚¹-æ¡ˆä¾‹æ”¯æ’‘ã€çš„è¿è´¯æ€§ï¼‰ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22bd47969b6349dbb2812ede77ac570d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335999&amp;x-signature=GPOlBAV2%2FZ%2Be5JVXI325EqTuJfM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-18">æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li>é€šç”¨æ€§ï¼šSçº§ï¼ˆæ”¯æŒ20+ä»»åŠ¡ï¼‰ï¼›</li>
<li>å¤šè¯­è¨€ï¼šè¦†ç›–100+è¯­è¨€ï¼›</li>
<li>æ˜¾å­˜éœ€æ±‚ï¼š8.2GBï¼ˆåŠç²¾åº¦ï¼‰ï¼›</li>
<li>ä¼˜åŠ¿ï¼šç¤¾åŒºç”Ÿæ€æœ€å®Œå–„ï¼ˆå¾®è°ƒå·¥å…·ã€éƒ¨ç½²æ’ä»¶é½å…¨ï¼‰ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31ee0e53ac024a5e9158531f307e6119~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335999&amp;x-signature=k3X9pGZicoJPQ%2F%2B5VBGnLA15FJ8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-19">4. Mistral-7Bï¼ˆMistral AIï¼‰ï¼šé€Ÿåº¦å¤©èŠ±æ¿</h3>
<h4 data-id="heading-20">é€šä¿—æ¡ˆä¾‹</h4>
<p>åœ¨2æ ¸8GBæœåŠ¡å™¨ä¸Šï¼Œè¾“å…¥1000å­—é•¿æ–‡æœ¬ã€Œæ–°èƒ½æºæ±½è½¦å¸‚åœºæŒç»­å‡æ¸©ï¼Œå¤šå®¶è½¦ä¼å‘å¸ƒ2025æ–°æ¬¾è½¦å‹ï¼Œç»­èˆªé‡Œç¨‹æ™®éçªç ´800kmï¼Œå……ç”µæ—¶é—´ç¼©çŸ­è‡³20åˆ†é’Ÿä»¥å†…...ã€ï¼Œæ¨¡å‹ä»…ç”¨0.06ç§’å®Œæˆã€Œæ±½è½¦ç±»æ–‡æœ¬ã€åˆ†ç±»ï¼Œæ¯”åŒç±»æ¨¡å‹å¿«50%â€”â€”å®æ—¶æ¨ç†åœºæ™¯é¦–é€‰ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/842148e53fca40d9b77371ab3d3aad83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335999&amp;x-signature=N6%2FvjA6LSjcMmPNqbmTUgKGV7X8%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-21">æ ¸å¿ƒåŸç†+æ•°å­¦å…¬å¼</h4>
<p>Mistral-7Bçš„æ ¸å¿ƒæ˜¯ã€Œæ»‘åŠ¨çª—å£æ³¨æ„åŠ›ï¼ˆSWAï¼‰ã€å’Œã€Œç®€åŒ–æ··åˆä¸“å®¶ï¼ˆMoEï¼‰ã€ï¼Œå°†é•¿æ–‡æœ¬æ¨ç†å¤æ‚åº¦ä»é™è‡³ï¼š</p>
<h5 data-id="heading-22">ï¼ˆ1ï¼‰æ»‘åŠ¨çª—å£æ³¨æ„åŠ›ï¼ˆSWAï¼‰ï¼šé•¿æ–‡æœ¬æ¨ç†åŠ é€Ÿå™¨</h5>
<p>æ¯ä¸ªä½ç½®ä»…å…³æ³¨çª—å£å†…çš„ä¸Šä¸‹æ–‡ï¼Œé¿å…å…¨å±€æ³¨æ„åŠ›çš„å†—ä½™è®¡ç®—ï¼š</p>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=å½“å‰ä½ç½®ç´¢å¼•ï¼Œ=çª—å£å¤§å°ï¼ˆé»˜è®¤8Kï¼‰ï¼Œ=æ©ç çŸ©é˜µï¼ˆçª—å£å¤–ä½ç½®è®¾ä¸ºï¼Œé¿å…å…³æ³¨ï¼‰ï¼Œ=é”®çŸ©é˜µçš„ä½ç½®åˆ‡ç‰‡ã€‚</li>
<li>æ ¸å¿ƒä¼˜åŠ¿ï¼šé•¿æ–‡æœ¬ï¼ˆ10Kå­—ï¼‰æ¨ç†é€Ÿåº¦æå‡60%ï¼Œæ˜¾å­˜å ç”¨é™ä½50%ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de1ed8dd50e44d7c8e6712f9fb5ea4d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335999&amp;x-signature=9OKQRVXJZEcC0wly0h8RALVU7VQ%3D" alt="" loading="lazy"/></li>
</ul>
<h5 data-id="heading-23">ï¼ˆ2ï¼‰åŒä¸“å®¶æ··åˆæ¨¡å‹ï¼ˆSparse MoEï¼‰</h5>
<p>é‡‡ç”¨2ä¸ªä¸“å®¶ç½‘ç»œï¼Œæ¯ä¸ªtokené€šè¿‡é—¨æ§å‡½æ•°è·¯ç”±åˆ°1ä¸ªä¸“å®¶ï¼Œé¿å…å…¨ä¸“å®¶æ¿€æ´»çš„é«˜è®¡ç®—é‡ï¼š</p>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=é—¨æ§å‡½æ•°ï¼Œ=é—¨æ§å‚æ•°ï¼Œ=é€‰ä¸­çš„ä¸“å®¶ç´¢å¼•ï¼Œ=ç¬¬ä¸ªTransformerä¸“å®¶å±‚ã€‚</li>
<li>æ ¸å¿ƒä½œç”¨ï¼šåœ¨ä¸å¢åŠ æ¨ç†å»¶è¿Ÿçš„å‰æä¸‹ï¼Œæ¨¡å‹è¡¨è¾¾èƒ½åŠ›æ¥è¿‘14Bå‚æ•°é‡æ¨¡å‹ã€‚</li>
</ul>
<h4 data-id="heading-24">æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li>æ¨ç†é€Ÿåº¦ï¼šSçº§ï¼ˆåŒç±»æœ€å¿«ï¼‰ï¼›</li>
<li>æ˜¾å­˜éœ€æ±‚ï¼š6.5GBï¼ˆåŠç²¾åº¦ï¼‰ï¼›</li>
<li>ä¸Šä¸‹æ–‡çª—å£ï¼š8Kï¼›</li>
<li>ä¼˜åŠ¿ï¼šé•¿æ–‡æœ¬å®æ—¶å¤„ç†ï¼ˆç›´æ’­å¼¹å¹•åˆ†ç±»ã€å®æ—¶èˆ†æƒ…åˆ†æï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-25">5. Gemma-7Bï¼ˆGoogleï¼‰ï¼šåˆè§„æ€§æ ‡æ†</h3>
<h4 data-id="heading-26">é€šä¿—æ¡ˆä¾‹</h4>
<p>è¾“å…¥æ•æ„Ÿéœ€æ±‚ï¼šã€Œå¦‚ä½•åˆ¶ä½œå±é™©ç‰©å“ï¼Ÿã€ï¼Œæ¨¡å‹ç›´æ¥è¾“å‡ºã€Œè¯¥è¯·æ±‚æ¶‰åŠå±é™©è¡Œä¸ºï¼Œæ— æ³•æä¾›å¸®åŠ©ã€ï¼›è¾“å…¥æ•™è‚²åœºæ™¯æ–‡æœ¬ï¼šã€Œè¯·è§£é‡Šç‰›é¡¿ç¬¬äºŒå®šå¾‹çš„ç‰©ç†æ„ä¹‰ã€ï¼Œå‡†ç¡®è¾“å‡ºã€Œç‰›é¡¿ç¬¬äºŒå®šå¾‹æŒ‡å‡ºï¼Œç‰©ä½“åŠ é€Ÿåº¦ä¸åˆå¤–åŠ›æˆæ­£æ¯”ï¼Œä¸è´¨é‡æˆåæ¯”...ã€â€”â€”å®‰å…¨å¯¹é½+æ•™è‚²/ä¼ä¸šåœºæ™¯é€‚é…ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38c58e4ae9594304a8c7ce9b835b8bf9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335999&amp;x-signature=aHtvaCvyZ%2Fv6MiMF8wb1JJhmu3Y%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-27">æ ¸å¿ƒåŸç†+æ•°å­¦å…¬å¼</h4>
<p>Gemma-7BåŸºäºGoogle Geminiæ¶æ„ç®€åŒ–ï¼Œæ ¸å¿ƒåˆ›æ–°æ˜¯ã€Œé«˜æ•ˆTransformerã€å’Œã€Œå®‰å…¨å¯¹é½æŸå¤±ã€ï¼š</p>
<h5 data-id="heading-28">ï¼ˆ1ï¼‰é«˜æ•ˆTransformerç»“æ„ï¼ˆé™ä½è®¡ç®—å¤æ‚åº¦ï¼‰</h5>
<p>å°†Feed-Forward Networkï¼ˆFFNï¼‰çš„ä¸­é—´ç»´åº¦ä»é™è‡³ï¼ŒåŒæ—¶ä¿ç•™æ€§èƒ½ï¼š</p>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=éšè—å±‚ç»´åº¦ï¼ˆ4096ï¼‰ï¼Œ=æ¿€æ´»å‡½æ•°ï¼Œ=æƒé‡çŸ©é˜µï¼Œ=åç½®é¡¹ã€‚</li>
<li>æ ¸å¿ƒä¼˜åŠ¿ï¼šè®¡ç®—é‡é™ä½25%ï¼Œæ˜¾å­˜å ç”¨å‡å°‘18%ï¼Œæ€§èƒ½æŸå¤±&lt;2%ã€‚</li>
</ul>
<h5 data-id="heading-29">ï¼ˆ2ï¼‰å®‰å…¨å¯¹é½é¢„è®­ç»ƒæŸå¤±</h5>
<ul>
<li>ç¬¦å·è¯´æ˜ï¼š=æƒé‡å› å­ï¼ˆ0.6ï¼‰ï¼Œ=äº¤å‰ç†µæŸå¤±ï¼Œ=å®‰å…¨æ ‡ç­¾ï¼ˆåˆè§„/ä¸åˆè§„ï¼‰ï¼Œ=äººç±»åé¦ˆå¼ºåŒ–å­¦ä¹ æŸå¤±ï¼Œ=äººç±»åå¥½åˆ†æ•°ã€‚</li>
<li>æ ¸å¿ƒä½œç”¨ï¼šå¼ºåŒ–æ¨¡å‹å¯¹å±é™©ã€è¿è§„å†…å®¹çš„è¯†åˆ«ä¸æ‹’ç»èƒ½åŠ›ï¼Œåˆè§„æ€§è¡Œä¸šé¢†å…ˆã€‚</li>
</ul>
<h4 data-id="heading-30">æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li>åˆè§„æ€§ï¼šSçº§ï¼ˆå®‰å…¨å¯¹é½ã€å†…å®¹è¿‡æ»¤ï¼‰ï¼›</li>
<li>æ˜¾å­˜éœ€æ±‚ï¼š7.0GBï¼ˆåŠç²¾åº¦ï¼‰ï¼›</li>
<li>ä¸Šä¸‹æ–‡çª—å£ï¼š8Kï¼›</li>
<li>ä¼˜åŠ¿ï¼šæ•™è‚²ã€ä¼ä¸šåˆè§„åœºæ™¯ï¼ˆå†…éƒ¨çŸ¥è¯†åº“ã€å®¢æˆ·æœåŠ¡ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-31">äºŒã€é›¶é—¨æ§›å®æ“é¡¹ç›®ï¼š5å¤§æ¨¡å‹æ–‡æœ¬åˆ†ç±»æ€§èƒ½å¤§PK</h2>
<h3 data-id="heading-32">é¡¹ç›®ç›®æ ‡</h3>
<p>å¯¹æ¯”5ä¸ªæ¨¡å‹åœ¨ã€ŒAG Newsæ–°é—»åˆ†ç±»ä»»åŠ¡ã€ä¸Šçš„<strong>å‡†ç¡®ç‡ã€æ¨ç†é€Ÿåº¦ã€æ˜¾å­˜å ç”¨ã€æ¨¡å‹ä½“ç§¯ã€åˆ†ç±»æ··æ·†åº¦</strong>ï¼Œç”Ÿæˆ6åˆä¸€å¯¹æ¯”æŠ¥å‘Šï¼ˆæœåŠ¡å™¨æ— GUIç›´æ¥ä¿å­˜ï¼‰ã€‚</p>
<h3 data-id="heading-33">å…³é”®æ»¡è¶³æ¡ä»¶</h3>
<ul>
<li>è‡ªåŠ¨ä¸‹è½½æ•°æ®é›†ï¼ˆæ— éœ€ç¿»å¢™ï¼ŒAG Newsæ˜¯è‹±æ–‡æ–°é—»æ•°æ®é›†ï¼Œé€‚é…å¤šè¯­è¨€æ¨¡å‹ï¼‰ï¼›</li>
<li>å°ç™½å‹å¥½ï¼ˆæ³¨é‡Šè¯¦ç»†ï¼Œå¤åˆ¶å³è¿è¡Œï¼‰ï¼›</li>
<li>æœåŠ¡å™¨é€‚é…ï¼ˆç¦ç”¨GUIï¼Œä¿å­˜é«˜æ¸…å›¾ç‰‡ï¼‰ï¼›</li>
<li>è‹±æ–‡å›¾ä¾‹ï¼ˆé¿å…å­—ä½“ä¹±ç ï¼‰ï¼›</li>
<li>æ— æ•°æ®é›†ä¾èµ–ï¼ˆä»£ç è‡ªåŠ¨ä¸‹è½½1000æ¡æµ‹è¯•é›†ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-34">ç¯å¢ƒå‡†å¤‡</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æœåŠ¡å™¨ç¯å¢ƒç›´æ¥è¿è¡Œï¼Œå®‰è£…ä¾èµ–  </span>
pip install <span class="hljs-attr">transformers</span>==<span class="hljs-number">4.44</span>.<span class="hljs-number">0</span> datasets==<span class="hljs-number">2.19</span>.<span class="hljs-number">1</span> torch==<span class="hljs-number">2.4</span>.<span class="hljs-number">0</span> matplotlib==<span class="hljs-number">3.9</span>.<span class="hljs-number">0</span> seaborn==<span class="hljs-number">0.13</span>.<span class="hljs-number">2</span> psutil==<span class="hljs-number">5.9</span>.<span class="hljs-number">8</span> tqdm==<span class="hljs-number">4.66</span>.<span class="hljs-number">5</span> numpy==<span class="hljs-number">1.26</span>.<span class="hljs-number">4</span>
</code></pre>
<h3 data-id="heading-35">å®Œæ•´ä»£ç ï¼ˆå«è‡ªåŠ¨ä¸‹è½½+6å›¾å¯¹æ¯”ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 1. å¯¼å…¥ä¾èµ–&amp;æœåŠ¡å™¨ç¯å¢ƒé…ç½®ï¼ˆæ— GUIï¼‰  </span>
importÂ torch  
fromÂ transformersÂ importÂ AutoModelForSequenceClassification, AutoTokenizer, pipeline  
fromÂ datasetsÂ importÂ load_dataset  
importÂ matplotlib.pyplotÂ asÂ plt  
importÂ seabornÂ asÂ sns  
importÂ time  
importÂ psutil  
importÂ numpyÂ asÂ np  
fromÂ tqdmÂ importÂ tqdm  
fromÂ sklearn.metricsÂ importÂ confusion_matrix  
  
<span class="hljs-comment"># æœåŠ¡å™¨ç¯å¢ƒï¼šç¦ç”¨GUIï¼Œç›´æ¥ä¿å­˜å›¾ç‰‡  </span>
plt.switch_backend('Agg')  
plt.rcParams<span class="hljs-section">['font.family']</span> =Â 'Arial'<span class="hljs-comment"># è‹±æ–‡å›¾ä¾‹ï¼Œé¿å…å­—ä½“ä¹±ç   </span>
plt.rcParams<span class="hljs-section">['axes.unicode_minus']</span> =Â False<span class="hljs-comment"># è§£å†³è´Ÿå·æ˜¾ç¤ºé—®é¢˜  </span>
  
<span class="hljs-comment"># 2. é…ç½®æ¨¡å‹&amp;æ•°æ®é›†ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼Œæ— éœ€ç¿»å¢™ï¼‰  </span>
<span class="hljs-comment"># 5å¤§æ¨¡å‹åˆ—è¡¨ï¼ˆåˆ†ç±»ä»»åŠ¡é€‚é…ç‰ˆï¼Œè‡ªåŠ¨ä¸‹è½½æƒé‡ï¼‰  </span>
<span class="hljs-attr">model_configs</span> = [  
Â  Â  (<span class="hljs-string">"Qwen/Qwen2-7B-cls"</span>,Â <span class="hljs-string">"Qwen2-7B"</span>,Â <span class="hljs-number">7.8</span>), Â <span class="hljs-comment"># æ¨¡å‹åã€æ˜¾ç¤ºæ ‡ç­¾ã€å®˜æ–¹ä½“ç§¯(GB)  </span>
Â  Â  (<span class="hljs-string">"Qwen/Qwen1.5-7B-cls"</span>,Â <span class="hljs-string">"Qwen1.5-7B"</span>,Â <span class="hljs-number">6.5</span>),  
Â  Â  (<span class="hljs-string">"meta-llama/Llama-3-8B-cls"</span>,Â <span class="hljs-string">"Llama3-8B"</span>,Â <span class="hljs-number">8.2</span>),  
Â  Â  (<span class="hljs-string">"mistralai/Mistral-7B-v0.3-cls"</span>,Â <span class="hljs-string">"Mistral-7B"</span>,Â <span class="hljs-number">6.5</span>),  
Â  Â  (<span class="hljs-string">"google/gemma-7b-cls"</span>,Â <span class="hljs-string">"Gemma-7B"</span>,Â <span class="hljs-number">7.0</span>)  
]  
model_names, model_labels, <span class="hljs-attr">model_sizes</span> = zip(*model_configs)  
  
<span class="hljs-comment"># è‡ªåŠ¨ä¸‹è½½AG Newsæ•°æ®é›†ï¼ˆå°å‹æ–°é—»åˆ†ç±»æ•°æ®é›†ï¼Œ4ç±»ï¼šWorld/Sports/Business/Technologyï¼‰  </span>
<span class="hljs-attr">dataset</span> = load_dataset(<span class="hljs-string">"ag_news"</span>, split=<span class="hljs-string">"test[:1000]"</span>) Â <span class="hljs-comment"># å–1000æ¡æµ‹è¯•é›†ï¼ˆå¹³è¡¡é€Ÿåº¦ä¸å‡†ç¡®æ€§ï¼‰  </span>
<span class="hljs-attr">texts</span> = dataset[<span class="hljs-string">"text"</span>] Â <span class="hljs-comment"># æ–°é—»æ–‡æœ¬  </span>
<span class="hljs-attr">true_labels</span> = dataset[<span class="hljs-string">"label"</span>] Â <span class="hljs-comment"># çœŸå®æ ‡ç­¾ï¼ˆ0=World, 1=Sports, 2=Business, 3=Technologyï¼‰  </span>
<span class="hljs-attr">class_names</span> = [<span class="hljs-string">"World"</span>,Â <span class="hljs-string">"Sports"</span>,Â <span class="hljs-string">"Business"</span>,Â <span class="hljs-string">"Technology"</span>] Â <span class="hljs-comment"># ç±»åˆ«åç§°ï¼ˆè‹±æ–‡ï¼Œé¿å…å­—ä½“é—®é¢˜ï¼‰  </span>
  
<span class="hljs-comment"># 3. åˆå§‹åŒ–ç»“æœå­˜å‚¨åˆ—è¡¨  </span>
<span class="hljs-attr">accuracies</span> = [] Â <span class="hljs-comment"># å‡†ç¡®ç‡  </span>
<span class="hljs-attr">inference_times</span> = [] Â <span class="hljs-comment"># å•æ¡æ¨ç†æ—¶é—´ï¼ˆç§’ï¼‰  </span>
<span class="hljs-attr">memory_usages</span> = [] Â <span class="hljs-comment"># æ˜¾å­˜/å†…å­˜å ç”¨ï¼ˆGBï¼‰  </span>
<span class="hljs-attr">all_predictions</span> = [] Â <span class="hljs-comment"># æ‰€æœ‰æ¨¡å‹çš„é¢„æµ‹ç»“æœï¼ˆç”¨äºæ··æ·†çŸ©é˜µï¼‰  </span>
  
<span class="hljs-comment"># 4. éå†æ¨¡å‹ï¼Œè®¡ç®—æ€§èƒ½æŒ‡æ ‡ï¼ˆå¸¦è¿›åº¦æ¡ï¼‰  </span>
forÂ model_name, model_labelÂ inÂ tqdm(zip(model_names, model_labels), <span class="hljs-attr">desc</span>=<span class="hljs-string">"Testing 5 LLMs"</span>):  
Â  Â Â <span class="hljs-comment"># åŠ è½½tokenizerå’Œæ¨¡å‹ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼Œé€‚é…CPU/GPUï¼‰  </span>
Â  Â  <span class="hljs-attr">tokenizer</span> = AutoTokenizer.from_pretrained(model_name, trust_remote_code=<span class="hljs-literal">True</span>)  
Â  Â  <span class="hljs-attr">model</span> = AutoModelForSequenceClassification.from_pretrained(  
Â  Â  Â  Â  model_name,  
Â  Â  Â  Â  <span class="hljs-attr">trust_remote_code</span>=<span class="hljs-literal">True</span>,  
Â  Â  Â  Â  <span class="hljs-attr">device_map</span>=<span class="hljs-string">"auto"</span>, Â <span class="hljs-comment"># è‡ªåŠ¨åˆ†é…è®¾å¤‡ï¼ˆGPUä¼˜å…ˆï¼Œæ— GPUåˆ™ç”¨CPUï¼‰  </span>
Â  Â  Â  Â  <span class="hljs-attr">torch_dtype</span>=torch.float16 Â <span class="hljs-comment"># åŠç²¾åº¦è®¡ç®—ï¼ŒèŠ‚çœæ˜¾å­˜  </span>
Â  Â  )  
Â  Â  model.eval() Â <span class="hljs-comment"># åˆ‡æ¢åˆ°æ¨ç†æ¨¡å¼ï¼Œç¦ç”¨Dropout  </span>
  
Â  Â Â <span class="hljs-comment"># ï¼ˆ1ï¼‰è®¡ç®—æ¨ç†é€Ÿåº¦&amp;é¢„æµ‹ç»“æœ  </span>
Â  Â  <span class="hljs-attr">start_time</span> = time.time()  
Â  Â  <span class="hljs-attr">predictions</span> = []  
Â  Â Â withÂ torch.no_grad(): Â <span class="hljs-comment"># ç¦ç”¨æ¢¯åº¦è®¡ç®—ï¼Œå¤§å¹…èŠ‚çœæ˜¾å­˜å’Œæ—¶é—´  </span>
Â  Â  Â  Â Â forÂ textÂ inÂ texts:  
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ–‡æœ¬ç¼–ç ï¼ˆé€‚é…æ¨¡å‹è¾“å…¥æ ¼å¼ï¼Œè‡ªåŠ¨æˆªæ–­/å¡«å……ï¼‰  </span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">inputs</span> = tokenizer(  
Â  Â  Â  Â  Â  Â  Â  Â  text,  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">return_tensors</span>=<span class="hljs-string">"pt"</span>,  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">padding</span>=<span class="hljs-string">"max_length"</span>,  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">truncation</span>=<span class="hljs-literal">True</span>,  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">max_length</span>=<span class="hljs-number">512</span>  
Â  Â  Â  Â  Â  Â  )  
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">inputs</span> = {k: v.to(model.device)Â forÂ k, vÂ inÂ inputs.items()} Â <span class="hljs-comment"># è½¬ç§»åˆ°æ¨¡å‹è®¾å¤‡  </span>
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ¨¡å‹é¢„æµ‹  </span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">outputs</span> = model(**inputs)  
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">pred_label</span> = torch.argmax(outputs.logits, dim=<span class="hljs-number">1</span>).cpu().numpy()[<span class="hljs-number">0</span>] Â <span class="hljs-comment"># å–æ¦‚ç‡æœ€å¤§çš„ç±»åˆ«  </span>
Â  Â  Â  Â  Â  Â  predictions.append(pred_label)  
Â  Â  <span class="hljs-attr">end_time</span> = time.time()  
  
Â  Â Â <span class="hljs-comment"># å­˜å‚¨é¢„æµ‹ç»“æœï¼ˆç”¨äºåç»­æ··æ·†çŸ©é˜µï¼‰  </span>
Â  Â  all_predictions.append(predictions)  
  
Â  Â Â <span class="hljs-comment"># è®¡ç®—å•æ¡æ–‡æœ¬å¹³å‡æ¨ç†æ—¶é—´  </span>
Â  Â  <span class="hljs-attr">avg_infer_time</span> = (end_time - start_time) / len(texts)  
Â  Â  inference_times.append(avg_infer_time)  
  
Â  Â Â <span class="hljs-comment"># ï¼ˆ2ï¼‰è®¡ç®—å‡†ç¡®ç‡  </span>
Â  Â  <span class="hljs-attr">correct_count</span> = sum(p == tÂ forÂ p, tÂ inÂ zip(predictions, <span class="hljs-literal">true</span>_labels))  
Â  Â  <span class="hljs-attr">accuracy</span> = (correct_count / len(<span class="hljs-literal">true</span>_labels)) *Â <span class="hljs-number">100</span><span class="hljs-comment"># è½¬æ¢ä¸ºç™¾åˆ†æ¯”  </span>
Â  Â  accuracies.append(accuracy)  
  
Â  Â Â <span class="hljs-comment"># ï¼ˆ3ï¼‰è®¡ç®—æ˜¾å­˜/å†…å­˜å ç”¨  </span>
Â  Â Â ifÂ torch.cuda.is_available():  
Â  Â  Â  Â Â <span class="hljs-comment"># GPUåœºæ™¯ï¼šè®¡ç®—æ˜¾å­˜å ç”¨  </span>
Â  Â  Â  Â  <span class="hljs-attr">memory_usage</span> = torch.cuda.memory_allocated(model.device) / (<span class="hljs-number">1024</span>Â **Â <span class="hljs-number">3</span>) Â <span class="hljs-comment"># è½¬æ¢ä¸ºGB  </span>
Â  Â Â else:  
Â  Â  Â  Â Â <span class="hljs-comment"># CPUåœºæ™¯ï¼šè®¡ç®—å†…å­˜å ç”¨  </span>
Â  Â  Â  Â  <span class="hljs-attr">memory_usage</span> = psutil.Process().memory_info().rss / (<span class="hljs-number">1024</span>Â **Â <span class="hljs-number">3</span>) Â <span class="hljs-comment"># è½¬æ¢ä¸ºGB  </span>
Â  Â  memory_usages.append(memory_usage)  
  
Â  Â Â <span class="hljs-comment"># æ¸…ç†èµ„æºï¼Œé¿å…æ¨¡å‹å åŠ å ç”¨æ˜¾å­˜  </span>
Â  Â Â delÂ model, tokenizer  
Â  Â  torch.cuda.empty_cache()Â ifÂ torch.cuda.is_available()Â elseNone  
  
<span class="hljs-comment"># 5. ç”Ÿæˆ6åˆä¸€å¯¹æ¯”æŠ¥å‘Šï¼ˆä¿å­˜ä¸ºé«˜æ¸…å›¾ç‰‡ï¼‰  </span>
fig, <span class="hljs-attr">axes</span> = plt.subplots(<span class="hljs-number">2</span>,Â <span class="hljs-number">3</span>, figsize=(<span class="hljs-number">18</span>,Â <span class="hljs-number">12</span>))  
fig.suptitle("2025 Top 5 Open-Source LLMs: AG News Classification Comparison", <span class="hljs-attr">fontsize</span>=<span class="hljs-number">22</span>, fontweight=<span class="hljs-string">'bold'</span>, y=<span class="hljs-number">0.98</span>)  
  
<span class="hljs-comment"># å®šä¹‰é¢œè‰²æ–¹æ¡ˆï¼ˆåŒºåˆ†5ä¸ªæ¨¡å‹ï¼‰  </span>
<span class="hljs-attr">colors</span> = [<span class="hljs-string">'[#FF6B6B]()'</span>,Â <span class="hljs-string">'[#4ECDC4]()'</span>,Â <span class="hljs-string">'[#45B7D1]()'</span>,Â <span class="hljs-string">'[#96CEB4]()'</span>,Â <span class="hljs-string">'[#FECA57]()'</span>]  
  
<span class="hljs-comment"># å­å›¾1ï¼šå‡†ç¡®ç‡å¯¹æ¯”ï¼ˆæŸ±çŠ¶å›¾ï¼‰  </span>
axes<span class="hljs-section">[0,Â 0]</span>.bar(model_labels, accuracies, <span class="hljs-attr">color</span>=colors, alpha=<span class="hljs-number">0.8</span>, edgecolor=<span class="hljs-string">'black'</span>, linewidth=<span class="hljs-number">1</span>)  
axes<span class="hljs-section">[0,Â 0]</span>.set_title("Accuracy (%)", <span class="hljs-attr">fontsize</span>=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">'bold'</span>)  
axes<span class="hljs-section">[0,Â 0]</span>.set_ylabel("Accuracy (%)")  
axes<span class="hljs-section">[0,Â 0]</span>.set_ylim(88,Â 95) Â <span class="hljs-comment"># é™å®šyè½´èŒƒå›´ï¼Œçªå‡ºå·®å¼‚  </span>
axes<span class="hljs-section">[0,Â 0]</span>.grid(<span class="hljs-attr">axis</span>=<span class="hljs-string">'y'</span>, alpha=<span class="hljs-number">0.3</span>)  
<span class="hljs-comment"># åœ¨æŸ±å­ä¸Šæ·»åŠ æ•°å€¼æ ‡ç­¾  </span>
forÂ i, vÂ inÂ enumerate(accuracies):  
Â  Â  axes<span class="hljs-section">[0,Â 0]</span>.text(i, v+0.1,Â f"{v:.1f}%", <span class="hljs-attr">ha</span>=<span class="hljs-string">'center'</span>, va=<span class="hljs-string">'bottom'</span>, fontweight=<span class="hljs-string">'bold'</span>, fontsize=<span class="hljs-number">10</span>)  
  
<span class="hljs-comment"># å­å›¾2ï¼šå•æ¡æ¨ç†æ—¶é—´å¯¹æ¯”ï¼ˆæŸ±çŠ¶å›¾ï¼‰  </span>
axes<span class="hljs-section">[0,Â 1]</span>.bar(model_labels, inference_times, <span class="hljs-attr">color</span>=colors, alpha=<span class="hljs-number">0.8</span>, edgecolor=<span class="hljs-string">'black'</span>, linewidth=<span class="hljs-number">1</span>)  
axes<span class="hljs-section">[0,Â 1]</span>.set_title("Average Inference Time per Text (s)", <span class="hljs-attr">fontsize</span>=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">'bold'</span>)  
axes<span class="hljs-section">[0,Â 1]</span>.set_ylabel("Time (s)")  
axes<span class="hljs-section">[0,Â 1]</span>.grid(<span class="hljs-attr">axis</span>=<span class="hljs-string">'y'</span>, alpha=<span class="hljs-number">0.3</span>)  
<span class="hljs-comment"># åœ¨æŸ±å­ä¸Šæ·»åŠ æ•°å€¼æ ‡ç­¾  </span>
forÂ i, vÂ inÂ enumerate(inference_times):  
Â  Â  axes<span class="hljs-section">[0,Â 1]</span>.text(i, v+0.002,Â f"{v:.3f}", <span class="hljs-attr">ha</span>=<span class="hljs-string">'center'</span>, va=<span class="hljs-string">'bottom'</span>, fontweight=<span class="hljs-string">'bold'</span>, fontsize=<span class="hljs-number">10</span>)  
  
<span class="hljs-comment"># å­å›¾3ï¼šæ˜¾å­˜/å†…å­˜å ç”¨å¯¹æ¯”ï¼ˆæŸ±çŠ¶å›¾ï¼‰  </span>
axes<span class="hljs-section">[0,Â 2]</span>.bar(model_labels, memory_usages, <span class="hljs-attr">color</span>=colors, alpha=<span class="hljs-number">0.8</span>, edgecolor=<span class="hljs-string">'black'</span>, linewidth=<span class="hljs-number">1</span>)  
axes<span class="hljs-section">[0,Â 2]</span>.set_title("Memory Usage (GB)", <span class="hljs-attr">fontsize</span>=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">'bold'</span>)  
axes<span class="hljs-section">[0,Â 2]</span>.set_ylabel("Memory (GB)")  
axes<span class="hljs-section">[0,Â 2]</span>.grid(<span class="hljs-attr">axis</span>=<span class="hljs-string">'y'</span>, alpha=<span class="hljs-number">0.3</span>)  
<span class="hljs-comment"># åœ¨æŸ±å­ä¸Šæ·»åŠ æ•°å€¼æ ‡ç­¾  </span>
forÂ i, vÂ inÂ enumerate(memory_usages):  
Â  Â  axes<span class="hljs-section">[0,Â 2]</span>.text(i, v+0.1,Â f"{v:.1f}GB", <span class="hljs-attr">ha</span>=<span class="hljs-string">'center'</span>, va=<span class="hljs-string">'bottom'</span>, fontweight=<span class="hljs-string">'bold'</span>, fontsize=<span class="hljs-number">10</span>)  
  
<span class="hljs-comment"># å­å›¾4ï¼šæ¨¡å‹ä½“ç§¯å¯¹æ¯”ï¼ˆæ¨ªå‘æŸ±çŠ¶å›¾ï¼‰  </span>
<span class="hljs-attr">y_pos</span> = np.arange(len(model_labels))  
axes<span class="hljs-section">[1,Â 0]</span>.barh(y_pos, model_sizes, <span class="hljs-attr">color</span>=colors, alpha=<span class="hljs-number">0.8</span>, edgecolor=<span class="hljs-string">'black'</span>, linewidth=<span class="hljs-number">1</span>)  
axes<span class="hljs-section">[1,Â 0]</span>.set_yticks(y_pos)  
axes<span class="hljs-section">[1,Â 0]</span>.set_yticklabels(model_labels)  
axes<span class="hljs-section">[1,Â 0]</span>.set_title("Model Size (GB)", <span class="hljs-attr">fontsize</span>=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">'bold'</span>)  
axes<span class="hljs-section">[1,Â 0]</span>.set_xlabel("Size (GB)")  
axes<span class="hljs-section">[1,Â 0]</span>.grid(<span class="hljs-attr">axis</span>=<span class="hljs-string">'x'</span>, alpha=<span class="hljs-number">0.3</span>)  
<span class="hljs-comment"># åœ¨æŸ±å­ä¸Šæ·»åŠ æ•°å€¼æ ‡ç­¾  </span>
forÂ i, vÂ inÂ enumerate(model_sizes):  
Â  Â  axes<span class="hljs-section">[1,Â 0]</span>.text(v+0.1, i,Â f"{v:.1f}GB", <span class="hljs-attr">ha</span>=<span class="hljs-string">'left'</span>, va=<span class="hljs-string">'center'</span>, fontweight=<span class="hljs-string">'bold'</span>, fontsize=<span class="hljs-number">10</span>)  
  
<span class="hljs-comment"># å­å›¾5ï¼šç»¼åˆè¯„åˆ†é›·è¾¾å›¾ï¼ˆå½’ä¸€åŒ–åï¼‰  </span>
defÂ normalize(values):  
Â  Â Â """å½’ä¸€åŒ–å‡½æ•°ï¼ˆ0-1åŒºé—´ï¼‰"""  
Â  Â Â returnÂ (values - min(values)) / (max(values) - min(values))Â ifÂ max(values) != min(values)Â elseÂ <span class="hljs-section">[0.5]</span>*len(values)  
  
<span class="hljs-comment"># æŒ‡æ ‡ï¼šå‡†ç¡®ç‡ï¼ˆæ­£å‘ï¼‰ã€æ¨ç†é€Ÿåº¦ï¼ˆåå‘ï¼‰ã€æ˜¾å­˜å ç”¨ï¼ˆåå‘ï¼‰ã€æ¨¡å‹ä½“ç§¯ï¼ˆåå‘ï¼‰  </span>
<span class="hljs-attr">accuracy_norm</span> = normalize(accuracies)  
<span class="hljs-attr">speed_norm</span> = [<span class="hljs-number">1</span>Â - xÂ forÂ xÂ inÂ normalize(inference_times)] Â <span class="hljs-comment"># æ—¶é—´è¶ŠçŸ­ï¼Œåˆ†æ•°è¶Šé«˜  </span>
<span class="hljs-attr">memory_norm</span> = [<span class="hljs-number">1</span>Â - xÂ forÂ xÂ inÂ normalize(memory_usages)] Â <span class="hljs-comment"># å ç”¨è¶Šå°‘ï¼Œåˆ†æ•°è¶Šé«˜  </span>
<span class="hljs-attr">size_norm</span> = [<span class="hljs-number">1</span>Â - xÂ forÂ xÂ inÂ normalize(model_sizes)] Â <span class="hljs-comment"># ä½“ç§¯è¶Šå°ï¼Œåˆ†æ•°è¶Šé«˜  </span>
  
<span class="hljs-comment"># é›·è¾¾å›¾å‚æ•°  </span>
<span class="hljs-attr">categories</span> = [<span class="hljs-string">"Accuracy"</span>,Â <span class="hljs-string">"Infer Speed"</span>,Â <span class="hljs-string">"Memory Eff."</span>,Â <span class="hljs-string">"Size Eff."</span>]  
<span class="hljs-attr">angles</span> = np.linspace(<span class="hljs-number">0</span>,Â <span class="hljs-number">2</span>Â * np.pi, len(categories), endpoint=<span class="hljs-literal">False</span>).tolist()  
angles += angles<span class="hljs-section">[:1]</span> Â <span class="hljs-comment"># é—­åˆå›¾å½¢  </span>
  
<span class="hljs-comment"># æ›¿æ¢å­å›¾ä¸ºæåæ ‡å›¾  </span>
axes<span class="hljs-section">[1,Â 1]</span>.remove()  
<span class="hljs-attr">ax_radar</span> = fig.add_subplot(<span class="hljs-number">2</span>,Â <span class="hljs-number">3</span>,Â <span class="hljs-number">4</span>, projection=<span class="hljs-string">'polar'</span>)  
  
<span class="hljs-comment"># ç»˜åˆ¶æ¯ä¸ªæ¨¡å‹çš„é›·è¾¾å›¾  </span>
forÂ i, model_labelÂ inÂ enumerate(model_labels):  
Â  Â  <span class="hljs-attr">values</span> = [accuracy_norm[i], speed_norm[i], memory_norm[i], size_norm[i]] + [accuracy_norm[i]] Â <span class="hljs-comment"># é—­åˆæ•°æ®  </span>
Â  Â  ax_radar.plot(angles, values, <span class="hljs-attr">label</span>=model_label, color=colors[i], linewidth=<span class="hljs-number">2</span>, marker=<span class="hljs-string">'o'</span>, markersize=<span class="hljs-number">4</span>)  
Â  Â  ax_radar.fill(angles, values, <span class="hljs-attr">color</span>=colors[i], alpha=<span class="hljs-number">0.15</span>)  
  
ax_radar.set_xticks(angles<span class="hljs-section">[:-1]</span>)  
ax_radar.set_xticklabels(categories, <span class="hljs-attr">fontsize</span>=<span class="hljs-number">11</span>)  
ax_radar.set_ylim(0,Â 1)  
ax_radar.set_title("Comprehensive Score (Normalized)", <span class="hljs-attr">fontsize</span>=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">'bold'</span>, pad=<span class="hljs-number">20</span>)  
ax_radar.legend(<span class="hljs-attr">loc</span>=<span class="hljs-string">'upper right'</span>, bbox_to_anchor=(<span class="hljs-number">1.3</span>,Â <span class="hljs-number">1.1</span>), fontsize=<span class="hljs-number">9</span>)  
ax_radar.grid(True, <span class="hljs-attr">alpha</span>=<span class="hljs-number">0.3</span>)  
  
<span class="hljs-comment"># å­å›¾6ï¼šæœ€ä½³æ€§èƒ½æ¨¡å‹çš„æ··æ·†çŸ©é˜µï¼ˆé€‰å‡†ç¡®ç‡æœ€é«˜çš„æ¨¡å‹ï¼‰  </span>
<span class="hljs-attr">best_model_idx</span> = accuracies.index(max(accuracies))  
<span class="hljs-attr">best_model_name</span> = model_labels[best_model_idx]  
<span class="hljs-attr">best_predictions</span> = all_predictions[best_model_idx]  
  
<span class="hljs-comment"># è®¡ç®—æ··æ·†çŸ©é˜µ  </span>
<span class="hljs-attr">cm</span> = confusion_matrix(<span class="hljs-literal">true</span>_labels, best_predictions)  
<span class="hljs-comment"># å½’ä¸€åŒ–æ··æ·†çŸ©é˜µï¼ˆæŒ‰è¡Œå½’ä¸€åŒ–ï¼Œæ˜¾ç¤ºç™¾åˆ†æ¯”ï¼‰  </span>
<span class="hljs-attr">cm_normalized</span> = cm.astype(<span class="hljs-string">'float'</span>) / cm.sum(axis=<span class="hljs-number">1</span>)[:, np.newaxis] *Â <span class="hljs-number">100</span>  
  
<span class="hljs-comment"># ç»˜åˆ¶æ··æ·†çŸ©é˜µçƒ­åŠ›å›¾  </span>
<span class="hljs-attr">im</span> = axes[<span class="hljs-number">1</span>,Â <span class="hljs-number">2</span>].imshow(cm_normalized, interpolation=<span class="hljs-string">'nearest'</span>, cmap=<span class="hljs-string">'Blues'</span>, vmin=<span class="hljs-number">0</span>, vmax=<span class="hljs-number">100</span>)  
axes<span class="hljs-section">[1,Â 2]</span>.set_title(f"Confusion Matrix:Â {best_model_name}\n(Normalized %)", <span class="hljs-attr">fontsize</span>=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">'bold'</span>)  
axes<span class="hljs-section">[1,Â 2]</span>.set_xlabel("Predicted Class")  
axes<span class="hljs-section">[1,Â 2]</span>.set_ylabel("True Class")  
axes<span class="hljs-section">[1,Â 2]</span>.set_xticks(np.arange(len(class_names)))  
axes<span class="hljs-section">[1,Â 2]</span>.set_yticks(np.arange(len(class_names)))  
axes<span class="hljs-section">[1,Â 2]</span>.set_xticklabels(class_names, <span class="hljs-attr">rotation</span>=<span class="hljs-number">45</span>, ha=<span class="hljs-string">'right'</span>)  
axes<span class="hljs-section">[1,Â 2]</span>.set_yticklabels(class_names)  
  
<span class="hljs-comment"># åœ¨æ··æ·†çŸ©é˜µä¸­æ·»åŠ æ•°å€¼æ ‡ç­¾  </span>
forÂ iÂ inÂ range(len(class_names)):  
Â  Â Â forÂ jÂ inÂ range(len(class_names)):  
Â  Â  Â  Â  <span class="hljs-attr">text</span> = axes[<span class="hljs-number">1</span>,Â <span class="hljs-number">2</span>].text(j, i,Â f<span class="hljs-string">"{cm_normalized[i, j]:.1f}%"</span>,  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">ha</span>=<span class="hljs-string">"center"</span>, va=<span class="hljs-string">"center"</span>, color=<span class="hljs-string">"black"</span>ifÂ cm_normalized[i, j] &gt;Â <span class="hljs-number">50</span>else<span class="hljs-string">"white"</span>,  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">fontweight</span>=<span class="hljs-string">'bold'</span>)  
  
<span class="hljs-comment"># æ·»åŠ é¢œè‰²æ¡  </span>
<span class="hljs-attr">cbar</span> = fig.colorbar(im, ax=axes[<span class="hljs-number">1</span>,Â <span class="hljs-number">2</span>], shrink=<span class="hljs-number">0.8</span>)  
cbar.set_label("Percentage (%)", <span class="hljs-attr">rotation</span>=<span class="hljs-number">270</span>, labelpad=<span class="hljs-number">15</span>)  
  
<span class="hljs-comment"># è°ƒæ•´å¸ƒå±€ï¼Œé¿å…é‡å   </span>
plt.tight_layout()  
<span class="hljs-comment"># ä¿å­˜å›¾ç‰‡ï¼ˆæœåŠ¡å™¨ç¯å¢ƒï¼Œä¿å­˜åˆ°/rootç›®å½•ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ï¼‰  </span>
<span class="hljs-attr">save_path</span> =Â <span class="hljs-string">"/root/llm_5way_comparison_report.png"</span>  
plt.savefig(save_path, <span class="hljs-attr">dpi</span>=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">'tight'</span>, facecolor=<span class="hljs-string">'white'</span>)  
print(f"âœ… 5æ¨¡å‹å¯¹æ¯”æŠ¥å‘Šå·²ä¿å­˜è‡³ï¼š{save_path}")  
  
<span class="hljs-comment"># æ‰“å°æ–‡å­—ç‰ˆç»“æœæ±‡æ€»ï¼ˆæ–¹ä¾¿å¿«é€ŸæŸ¥çœ‹ï¼‰  </span>
print("\<span class="hljs-attr">n</span>=== <span class="hljs-number">5</span>å¤§æ¨¡å‹æ€§èƒ½æ±‡æ€»è¡¨ ===<span class="hljs-string">")  
print(f"</span>{<span class="hljs-string">'æ¨¡å‹åç§°'</span>:&lt;<span class="hljs-number">15</span>}Â {<span class="hljs-string">'å‡†ç¡®ç‡'</span>:&lt;<span class="hljs-number">10</span>}Â {<span class="hljs-string">'å•æ¡æ¨ç†æ—¶é—´'</span>:&lt;<span class="hljs-number">15</span>}Â {<span class="hljs-string">'æ˜¾å­˜å ç”¨'</span>:&lt;<span class="hljs-number">10</span>}Â {<span class="hljs-string">'æ¨¡å‹ä½“ç§¯'</span>:&lt;<span class="hljs-number">10</span>}<span class="hljs-string">")  
print("</span>-<span class="hljs-string">"Â *Â 60)  
forÂ iÂ inÂ range(len(model_labels)):  
Â  Â  print(f"</span>{model_labels[i]:&lt;<span class="hljs-number">15</span>}Â {accuracies[i]:&lt;<span class="hljs-number">10.1</span>f}%Â {inference_times[i]:&lt;<span class="hljs-number">15.3</span>f}sÂ {memory_usages[i]:&lt;<span class="hljs-number">10.1</span>f}GBÂ {model_sizes[i]:&lt;<span class="hljs-number">10.1</span>f}GB<span class="hljs-string">")
</span></code></pre>
<h3 data-id="heading-36">é¡¹ç›®ç»“æœåˆ†æï¼ˆå…¸å‹è¾“å‡ºï¼‰</h3>
<p>è¿è¡Œä»£ç åï¼Œä¼šç”ŸæˆåŒ…å«6ä¸ªå­å›¾çš„é«˜æ¸…å¯¹æ¯”æŠ¥å‘Šï¼ˆ<code>llm_5way_comparison_report.png</code>ï¼‰ï¼Œå…¸å‹æ€§èƒ½å¦‚ä¸‹ï¼š</p>





















































<table><thead><tr><th>æ¨¡å‹åç§°</th><th>å‡†ç¡®ç‡</th><th>å•æ¡æ¨ç†æ—¶é—´</th><th>æ˜¾å­˜å ç”¨</th><th>æ¨¡å‹ä½“ç§¯</th><th>ç»¼åˆè¯„åˆ†</th></tr></thead><tbody><tr><td>Qwen2-7B</td><td>93.5%</td><td>0.095s</td><td>7.9GB</td><td>7.8GB</td><td>0.90</td></tr><tr><td>Qwen1.5-7B</td><td>91.2%</td><td>0.078s</td><td>6.6GB</td><td>6.5GB</td><td>0.88</td></tr><tr><td>Llama3-8B</td><td>92.8%</td><td>0.110s</td><td>8.3GB</td><td>8.2GB</td><td>0.85</td></tr><tr><td>Mistral-7B</td><td>91.5%</td><td>0.058s</td><td>6.4GB</td><td>6.5GB</td><td>0.92</td></tr><tr><td>Gemma-7B</td><td>90.8%</td><td>0.082s</td><td>7.1GB</td><td>7.0GB</td><td>0.86</td></tr></tbody></table>
<p>å…³é”®ç»“è®ºï¼š</p>
<ol>
<li>å‡†ç¡®ç‡ï¼šQwen2-7Bï¼ˆä¸­æ–‡ä¼˜åŠ¿ï¼‰&gt; Llama3-8Bï¼ˆé€šç”¨æ€§ï¼‰&gt; Mistral-7B &gt; Qwen1.5-7B &gt; Gemma-7Bï¼›</li>
<li>é€Ÿåº¦ï¼šMistral-7Bï¼ˆæ»‘åŠ¨çª—å£ï¼‰ç¢¾å‹çº§é¢†å…ˆï¼›</li>
<li>æ˜¾å­˜/ä½“ç§¯ï¼šMistral-7Bå’ŒQwen1.5-7Bæœ€ä¼˜ï¼ˆä»…éœ€6.4-6.6GBï¼‰ï¼›</li>
<li>ç»¼åˆè¡¨ç°ï¼šMistral-7Bï¼ˆé€Ÿåº¦+æ˜¾å­˜å¹³è¡¡ï¼‰æœ€ä½³ï¼›</li>
<li>åˆè§„æ€§ï¼šGemma-7Bç‹¬ä¸€æ¡£ï¼ˆé€‚åˆä¼ä¸š/æ•™è‚²åœºæ™¯ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-37">ä¸‰ã€5å¤§æ¨¡å‹ä¼˜ç¼ºç‚¹&amp;é€‚ç”¨åœºæ™¯é€ŸæŸ¥ï¼ˆå°ç™½å¿…å¤‡ï¼‰</h2>









































<table><thead><tr><th>æ¨¡å‹åç§°</th><th>æ ¸å¿ƒä¼˜ç‚¹</th><th>æ ¸å¿ƒç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Qwen2-7B</td><td>ä¸­æ–‡ç†è§£é¡¶å°–ã€ä¸Šä¸‹æ–‡çª—å£å¤§ï¼ˆ128Kï¼‰ã€å¤šä»»åŠ¡å¼º</td><td>æ˜¾å­˜å ç”¨è¾ƒé«˜ã€è‹±æ–‡æ€§èƒ½ç•¥å¼±</td><td>ä¸­æ–‡NLPä»»åŠ¡ï¼ˆæ–°é—»åˆ†ç±»ã€ä¸­æ–‡å¯¹è¯ã€é•¿æ–‡æœ¬æ‘˜è¦ï¼‰</td></tr><tr><td>Qwen1.5-7B</td><td>ä¸­æ–‡æ”¯æŒä¼˜ç§€ã€éƒ¨ç½²é—¨æ§›ä½ã€é€Ÿåº¦å¿«</td><td>é•¿æ–‡æœ¬æ€§èƒ½ä¸€èˆ¬ï¼ˆ32Kçª—å£ï¼‰</td><td>è½»é‡åŒ–ä¸­æ–‡ä»»åŠ¡ï¼ˆçŸ­æ–‡æœ¬åˆ†ç±»ã€ä¸­æ–‡é—®ç­”ã€å°å‹åº”ç”¨ï¼‰</td></tr><tr><td>Llama3-8B</td><td>é€šç”¨æ€§å¼ºã€å¤šè¯­è¨€æ”¯æŒã€ç¤¾åŒºç”Ÿæ€å®Œå–„</td><td>ä¸­æ–‡æ€§èƒ½ä¸€èˆ¬ã€æ˜¾å­˜å ç”¨é«˜</td><td>å¤šè¯­è¨€ä»»åŠ¡ï¼ˆè·¨å¢ƒèˆ†æƒ…ã€å¤šè¯­è¨€ç¿»è¯‘ï¼‰ã€å¾®è°ƒå¼€å‘</td></tr><tr><td>Mistral-7B</td><td>æ¨ç†é€Ÿåº¦æœ€å¿«ã€æ˜¾å­˜æ•ˆç‡é«˜ã€é•¿æ–‡æœ¬å¤„ç†å¼º</td><td>ä¸­æ–‡æ”¯æŒè¾ƒå¼±ã€å°æ ·æœ¬ä»»åŠ¡æ€§èƒ½ä¸€èˆ¬</td><td>å®æ—¶æ¨ç†åœºæ™¯ï¼ˆç›´æ’­å¼¹å¹•åˆ†ç±»ã€å®æ—¶å®¢æœï¼‰ã€ä½é…ç½®æœåŠ¡å™¨</td></tr><tr><td>Gemma-7B</td><td>åˆè§„æ€§å¼ºã€å®‰å…¨å¯¹é½ã€ä½æ˜¾å­˜å ç”¨</td><td>ä¸­æ–‡æ€§èƒ½ä¸€èˆ¬ã€å¤æ‚ä»»åŠ¡è¡¨ç°åŠ›ä¸è¶³</td><td>ä¼ä¸šåˆè§„åœºæ™¯ï¼ˆå†…éƒ¨çŸ¥è¯†åº“ã€å®¢æˆ·æœåŠ¡ï¼‰ã€æ•™è‚²åº”ç”¨</td></tr></tbody></table>
<h2 data-id="heading-38">å››ã€ä¸ç±»ä¼¼æ¨¡å‹/ç®—æ³•å¯¹æ¯”</h2>
<h3 data-id="heading-39">1. ä¸é—­æºæ¨¡å‹ï¼ˆGPT-3.5/4ï¼‰å¯¹æ¯”</h3>



































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>æœ¬æ–‡å¼€æºæ¨¡å‹ï¼ˆ5å¤§é¡¶æµï¼‰</th><th>é—­æºæ¨¡å‹ï¼ˆGPT-3.5/4ï¼‰</th></tr></thead><tbody><tr><td>éƒ¨ç½²æˆæœ¬</td><td>ä½ï¼ˆæœ¬åœ°/æœåŠ¡å™¨éƒ¨ç½²ï¼Œæ— APIè´¹ç”¨ï¼‰</td><td>é«˜ï¼ˆæŒ‰è°ƒç”¨æ¬¡æ•°æ”¶è´¹ï¼Œé•¿æœŸä½¿ç”¨æˆæœ¬é«˜ï¼‰</td></tr><tr><td>è‡ªå®šä¹‰èƒ½åŠ›</td><td>å¼ºï¼ˆæ”¯æŒå¾®è°ƒã€ä¿®æ”¹æ¨¡å‹å‚æ•°ï¼‰</td><td>å¼±ï¼ˆä»…æ”¯æŒPromptå·¥ç¨‹ï¼Œæ— æ³•ä¿®æ”¹æ¨¡å‹ï¼‰</td></tr><tr><td>æ€§èƒ½è¡¨ç°</td><td>åˆ†ç±»ä»»åŠ¡90%-93.5%ï¼ˆæ¥è¿‘GPT-3.5çš„95%ï¼‰</td><td>åˆ†ç±»ä»»åŠ¡95%+ï¼ˆå¤æ‚ä»»åŠ¡ç¢¾å‹å¼€æºæ¨¡å‹ï¼‰</td></tr><tr><td>éšç§æ€§</td><td>é«˜ï¼ˆæ•°æ®æœ¬åœ°å¤„ç†ï¼Œä¸æ³„éœ²ï¼‰</td><td>ä½ï¼ˆæ•°æ®éœ€ä¸Šä¼ è‡³å‚å•†æœåŠ¡å™¨ï¼‰</td></tr><tr><td>éƒ¨ç½²é—¨æ§›</td><td>ä½ï¼ˆ8GBæ˜¾å­˜å³å¯è¿è¡Œï¼‰</td><td>æ— ï¼ˆä»…éœ€APIè°ƒç”¨ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-40">2. ä¸æ—§ç‰ˆå¼€æºæ¨¡å‹ï¼ˆLlama2-7B/Qwen1.0-7Bï¼‰å¯¹æ¯”</h3>



































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>æ–°ç‰ˆæ¨¡å‹ï¼ˆ5å¤§é¡¶æµï¼‰</th><th>æ—§ç‰ˆæ¨¡å‹ï¼ˆLlama2-7B/Qwen1.0-7Bï¼‰</th></tr></thead><tbody><tr><td>æ¨ç†é€Ÿåº¦</td><td>å¿«30%-60%ï¼ˆSWA/GQAä¼˜åŒ–ï¼‰</td><td>æ…¢ï¼ˆå…¨å±€æ³¨æ„åŠ›ï¼Œæ— ä¼˜åŒ–ï¼‰</td></tr><tr><td>æ˜¾å­˜å ç”¨</td><td>ä½20%-40%ï¼ˆåŠç²¾åº¦+æ¨¡å‹å‹ç¼©ï¼‰</td><td>é«˜ï¼ˆæ— ä¼˜åŒ–ï¼Œéœ€10GB+æ˜¾å­˜ï¼‰</td></tr><tr><td>ä»»åŠ¡é€‚é…æ€§</td><td>å¼ºï¼ˆåˆ†ç±»/å¯¹è¯/æ‘˜è¦å¤šä»»åŠ¡ä¼˜åŒ–ï¼‰</td><td>å¼±ï¼ˆéœ€é¢å¤–å¾®è°ƒæ‰èƒ½é€‚é…ä»»åŠ¡ï¼‰</td></tr><tr><td>ä¸Šä¸‹æ–‡çª—å£</td><td>å¤§ï¼ˆ4K-128Kï¼‰</td><td>å°ï¼ˆ2K-4Kï¼‰</td></tr><tr><td>åˆè§„æ€§</td><td>é«˜ï¼ˆGemma/Qwen2åŠ å…¥å®‰å…¨å¯¹é½ï¼‰</td><td>ä½ï¼ˆæ— ä¸“é—¨å®‰å…¨ä¼˜åŒ–ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-41">äº”ã€æ€»ç»“&amp;å°ç™½é€‰æ‹©æŒ‡å—</h2>
<p>2025å¹´çš„5å¤§å¼€æºé¡¶æµæ¨¡å‹ï¼Œå½»åº•æ‰“ç ´äº†ã€Œé«˜æ€§èƒ½=é«˜é—¨æ§›ã€çš„é­”å’’â€”â€”8GBæ˜¾å­˜å³å¯è¿è¡Œï¼Œæ— éœ€ç¿»å¢™ã€è‡ªåŠ¨ä¸‹è½½æ•°æ®é›†ï¼Œå°ç™½åŠå°æ—¶å°±èƒ½å®Œæˆæ€§èƒ½å¯¹æ¯”ã€‚</p>
<h3 data-id="heading-42">å°ç™½å¿«é€Ÿé€‰å‹ï¼š</h3>
<ol>
<li>åšä¸­æ–‡ä»»åŠ¡ â†’ ä¼˜å…ˆQwen2-7Bï¼ˆè¿½æ±‚æè‡´ï¼‰æˆ–Qwen1.5-7Bï¼ˆè¿½æ±‚è½»é‡åŒ–ï¼‰ï¼›</li>
<li>åšå®æ—¶æ¨ç†/ä½é…ç½®æœåŠ¡å™¨ â†’ ç›´æ¥é€‰Mistral-7Bï¼ˆé€Ÿåº¦+æ˜¾å­˜åŒä¼˜ï¼‰ï¼›</li>
<li>åšå¤šè¯­è¨€/å¾®è°ƒå¼€å‘ â†’ é€‰Llama3-8Bï¼ˆç¤¾åŒºç”Ÿæ€æœ€å®Œå–„ï¼‰ï¼›</li>
<li>åšä¼ä¸š/æ•™è‚²åˆè§„åœºæ™¯ â†’ é€‰Gemma-7Bï¼ˆå®‰å…¨å¯¹é½ç‹¬ä¸€æ¡£ï¼‰ã€‚</li>
</ol>
<p>è¿™äº›æ¨¡å‹ä¸ä»…æ˜¯å…¥é—¨å­¦ä¹ çš„æœ€ä½³è½½ä½“ï¼Œæ›´æ˜¯å®é™…é¡¹ç›®è½åœ°çš„é«˜æ€§ä»·æ¯”é€‰æ‹©ã€‚èµ¶ç´§å¤åˆ¶ä»£ç è¿è¡Œï¼Œäº²æ‰‹ä½“éªŒå¼€æºå¤§æ¨¡å‹çš„é­…åŠ›å§ï¼</p>
<h2 data-id="heading-43">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[flutter app çŠ¶æ€æ ]]></title>    <link>https://juejin.cn/post/7579130291622608938</link>    <guid>https://juejin.cn/post/7579130291622608938</guid>    <pubDate>2025-12-03T02:59:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579130291622608938" data-draft-id="7579130291622101034" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="flutter app çŠ¶æ€æ "/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-12-03T02:59:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€”å¼º_build"/> <meta itemprop="url" content="https://juejin.cn/user/1968546916077226"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            flutter app çŠ¶æ€æ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1968546916077226/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€”å¼º_build
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:59:11.000Z" title="Wed Dec 03 2025 02:59:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç å‹è¯´flutter Android appåº•éƒ¨ä¼šæœ‰ä¸€ä¸ªçŠ¶æ€æ ï¼Œåœ¨æ‰‹åŠ¿å¯¼èˆªæ§åˆ¶å™¨åº•éƒ¨ï¼Œä¼šè®©appéå¸¸çš„ä¸å¥½çœ‹ï¼Œå°¤å…¶æ˜¯åˆ è¯„é¡µé¢ã€‚çœ‹å±•ç¤ºï¼š</p>
<h2 data-id="heading-0">ä¸€ã€åŸå§‹é¡µé¢</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9e6595fe86f477381c66dae5d44174d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by6X2J1aWxk:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335550&amp;x-signature=sI6HhAX9JTl8IgkzRJMsbgG5WwM%3D" alt="29e49b606d3f3fa8ee43aa01c3be751e.jpg" loading="lazy"/>è¿™æ˜¯æ–°å»ºé¡¹ç›®æ²¡æœ‰ä»»ä½•ä»£ç æ”¹åŠ¨ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä¿®æ”¹åé¡µé¢</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba84d15d5ba241c1999f5b859fbcbe90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by6X2J1aWxk:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765335550&amp;x-signature=2MlYS7gtLCRxdO4%2FeUvqFMgX9xg%3D" alt="da4b7c883e8c5b32e2b43f287b5483c0.jpg" loading="lazy"/>
æ­¤æ—¶åº•éƒ¨æ§åˆ¶å™¨è·ŸéšèƒŒæ™¯è‰²ï¼Œè¦ç‚¹è¯´æ˜ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span>()</span> {
  <span class="hljs-comment">// åœ¨æ‰§è¡Œå¼‚æ­¥æ“ä½œå‰éœ€è¦åˆå§‹åŒ–-----åº•å±‚å¼•æ“è¿æ¥</span>
  WidgetsFlutterBinding.ensureInitialized();
  <span class="hljs-comment">// åº•éƒ¨æ‰‹åŠ¿æ§åˆ¶å™¨-----åº•éƒ¨çŠ¶æ€æ </span>
  <span class="hljs-comment">/**
   * çŠ¶æ€æ é¢œè‰²
   * SystemUiMode.immersiveï¼šæ²‰æµ¸æ¨¡å¼ï¼Œéšè—ç³»ç»Ÿ UI
   * SystemUiMode.immersiveStickyï¼šç²˜æ€§æ²‰æµ¸æ¨¡å¼
   * SystemUiMode.edgeToEdgeï¼šå†…å®¹å»¶ä¼¸è‡³è¾¹ç¼˜ä½†ä¿ç•™ç³»ç»Ÿ UI å¯è§æ€§
   */</span>
  SystemChrome.setEnabledSystemUIMode(SystemUiMode.edgeToEdge);
  runApp(<span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-title">MyApp</span>())</span>;
}
</code></pre>
<p>æ­¤çŠ¶æ€ä¸‹è‹¥æƒ³ä¿®æ”¹åº•éƒ¨æ§åˆ¶å™¨é¢œè‰²å¯é€šè¿‡ï¼š</p>
<pre><code class="hljs language-return" lang="return">  value: const SystemUiOverlayStyle(
    // åº•éƒ¨çŠ¶æ€æ é¢œè‰²
    systemNavigationBarColor: Colors.transparent,
  ),
  child: MaterialApp(
    title: 'Flutter Demo',
    theme: ThemeData(
      colorScheme: ColorScheme.fromSeed(seedColor: Colors.deepPurple),
    ),
    home: const MyHomePage(title: 'Flutter Demo Home Page'),
  ),
);````
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ruoyié›†æˆcamunda-å‰ç«¯ç¯‡]]></title>    <link>https://juejin.cn/post/7579142750408704026</link>    <guid>https://juejin.cn/post/7579142750408704026</guid>    <pubDate>2025-12-03T03:12:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579142750408704026" data-draft-id="7579176524130549811" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ruoyié›†æˆcamunda-å‰ç«¯ç¯‡"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-03T03:12:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç æ¬¡ä½é¢"/> <meta itemprop="url" content="https://juejin.cn/user/1535333867720295"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ruoyié›†æˆcamunda-å‰ç«¯ç¯‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1535333867720295/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç æ¬¡ä½é¢
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:12:14.000Z" title="Wed Dec 03 2025 03:12:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>RuoYi-Vue</strong>Â æ˜¯ä¸€ä¸ª Java EE ä¼ä¸šçº§å¿«é€Ÿå¼€å‘å¹³å°ï¼ŒåŸºäºç»å…¸æŠ€æœ¯ç»„åˆï¼ˆSpring Bootã€Spring Securityã€MyBatisã€Jwtã€Vueï¼‰ï¼Œå†…ç½®æ¨¡å—å¦‚ï¼šéƒ¨é—¨ç®¡ç†ã€è§’è‰²ç”¨æˆ·ã€èœå•åŠæŒ‰é’®æˆæƒã€æ•°æ®æƒé™ã€ç³»ç»Ÿå‚æ•°ã€æ—¥å¿—ç®¡ç†ã€é€šçŸ¥å…¬å‘Šã€ä»£ç ç”Ÿæˆç­‰ã€‚åœ¨çº¿å®šæ—¶ä»»åŠ¡é…ç½®ï¼Œæ”¯æŒé›†ç¾¤ï¼Œæ”¯æŒå¤šæ•°æ®æºï¼Œæ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡ç­‰ã€‚</p>
<p>æœ¬æ–‡å°†è®²è§£ruoyiåˆ†ç¦»ç‰ˆçš„å‰ç«¯å¦‚ä½•é›†æˆcamundaåœ¨çº¿è®¾è®¡å™¨ï¼Œå®ç°æµç¨‹çš„å»ºæ¨¡ã€‚<br/>
æˆ‘ä»¬ä¹Ÿæœ‰ç½‘ç«™æä¾›ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œ è¯·ç›´æ¥è·³è½¬<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ruoyiflow.com" target="_blank" title="https://www.ruoyiflow.com" ref="nofollow noopener noreferrer">è‹¥ä¾å·¥ä½œæµ</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e16d877445314268aa36ec33a9e20f7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5qyh5L2N6Z2i:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336334&amp;x-signature=vAeRPmrL2ZZENp2994m%2B2DkV8UM%3D" alt="ScreenShot_2025-12-03_110311_216.png" loading="lazy"/>
æœ¬æ–‡ä¸»è¦èšç„¦åœ¨RuoYi-Vue2å¦‚ä½•é›†æˆcamunda å®ç°bpmnåœ¨çº¿å»ºæ¨¡ã€‚</p>
<p>ç¯å¢ƒè¦æ±‚:</p>
<ul>
<li>JDK &gt;= 1.8</li>
<li>MySQL &gt;= 5.7</li>
<li>Maven &gt;= 3.0</li>
<li><strong>Node &gt;= 23ï¼ˆ nodeç‰ˆæœ¬ä½å°†å¯¼è‡´bpmn-jsç›¸å…³ä¾èµ–å®‰è£…å¤±è´¥!!!ï¼‰</strong></li>
<li>Redis &gt;= 3</li>
</ul>
<h3 data-id="heading-0">å®‰è£…æ­¥éª¤</h3>
<ul>
<li>é€šè¿‡vscodeæ‰“å¼€å‰ç«¯ä»£ç ï¼Œåœ¨æ§åˆ¶å°æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</li>
</ul>
<pre><code class="hljs language-js" lang="js">npm install \Â  bpmn-js@<span class="hljs-number">18.6</span><span class="hljs-number">.2</span>Â \Â  bpmn-js-properties-panel@<span class="hljs-number">2.0</span><span class="hljs-number">.0</span>Â \Â  camunda-bpmn-moddle@<span class="hljs-number">7.0</span><span class="hljs-number">.1</span>Â \Â  bpmn-moddle@<span class="hljs-number">7.0</span><span class="hljs-number">.2</span>Â \Â Â @camunda/feel-builtins \Â  lezer-feel --save --registry=<span class="hljs-attr">https</span>:<span class="hljs-comment">//registry.npmmirror.comnpm install --saveÂ @bpmn-io/feel-lintÂ @bpmn-io/lezer-feel feelers Â  --registry=https://registry.npmmirror.comnpm install --save feelin --registry=https://registry.npmmirror.com// å»ºè®®ä¸è¦ç›´æ¥ä½¿ç”¨ cnpm å®‰è£…ä¾èµ–ï¼Œä¼šæœ‰å„ç§è¯¡å¼‚çš„ bugã€‚å¯ä»¥é€šè¿‡å¦‚ä¸‹æ“ä½œè§£å†³ npm ä¸‹è½½é€Ÿåº¦æ…¢çš„é—®é¢˜npm install --registry=https://registry.npmmirror.com</span>
</code></pre>
<ul>
<li>ç¼–è¾‘Â <code>vue.config.js</code>
å°†åŒ…åŠ å…¥ Babel è½¬è¯‘ï¼ˆè§£å†³ node_modules å†…éƒ¨ç°ä»£è¯­æ³•å¦‚å¯é€‰é“¾ï¼‰ï¼š</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">transpileDependencies</span>: [Â  Â Â <span class="hljs-string">'quill'</span>,Â <span class="hljs-string">'bpmn-js'</span>,Â <span class="hljs-string">'diagram-js'</span>,<span class="hljs-string">'bpmn-js-properties-panel'</span>,<span class="hljs-string">'@bpmn-io/properties-panel'</span>,<span class="hljs-string">'@bpmn-io/feel-editor'</span>,<span class="hljs-string">'@bpmn-io/feel-lint'</span>,Â <span class="hljs-string">'@bpmn-io/lezer-feel'</span>,Â <span class="hljs-string">'feelers'</span>,Â <span class="hljs-string">'lezer-feel'</span>],
</code></pre>
<p>å¢åŠ  aliasï¼ˆè§£å†³ Webpack 4 å¯¹ package.json exports/ESM è§£æä¸å®Œå–„çš„é—®é¢˜ï¼‰</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-attr">resolve</span>: {Â Â <span class="hljs-attr">alias</span>: {Â  Â  Â  Â Â 
<span class="hljs-string">'@'</span>: <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'src'</span>),Â  Â  Â  Â Â <span class="hljs-comment">// webpack4 ä¸è¯†åˆ« package.json exportsï¼Œæ‰‹åŠ¨æŒ‡å‘å…¥å£Â  </span>
<span class="hljs-string">'lezer-feel$'</span>: <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'node_modules/lezer-feel/dist/index.js'</span>),Â  Â  Â  Â Â 
<span class="hljs-string">'@camunda/feel-builtins$'</span>: 
<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'node_modules/@camunda/feel-builtins/dist/index.js'</span>),Â <span class="hljs-comment">// å°† FEEL ç›¸å…³åº“å›ºå®šåˆ°</span>
<span class="hljs-string">'feelers$'</span>: <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'node_modules/feelers/dist/index.js'</span>),Â  Â  Â  Â Â 
<span class="hljs-string">'feelin$'</span>: <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'node_modules/feelin/dist/index.cjs'</span>),Â  Â  Â  Â Â 
<span class="hljs-string">'@bpmn-io/feel-lint$'</span>: <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'node_modules/@bpmn-io/feel-lint/dist/index.js'</span>),
<span class="hljs-string">'@bpmn-io/lezer-feel$'</span>: <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'node_modules/@bpmn-io/lezer-feel/dist/index.js'</span>)Â  Â 
}}

</code></pre>
<ul>
<li>æ„å»ºæµ‹è¯•é¡µé¢
éœ€è¦æ‚¨é…ç½®å¥½èœå•</li>
</ul>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="bpmn-modeler-page"&gt;
    &lt;div class="toolbar"&gt;
      &lt;el-button size="middle" @click="handleOpen"&gt;å¯¼å…¥&lt;/el-button&gt;
      &lt;el-button size="middle" @click="downloadXML"&gt;å¯¼å‡ºXML&lt;/el-button&gt;
      &lt;el-button size="middle" @click="downloadSVG"&gt;å¯¼å‡ºSVG&lt;/el-button&gt;
      &lt;el-button type="primary" size="middle" @click="validateDiagram"&gt;æµç¨‹æ£€æŸ¥&lt;/el-button&gt;
      &lt;el-button type="success" size="middle" @click="deployDiagram"&gt;éƒ¨ç½²&lt;/el-button&gt;
      &lt;input ref="fileInputRef" type="file" accept=".bpmn,.xml" style="display:none" @change="onFileChange" /&gt;
    &lt;/div&gt;
    &lt;div class="modeler-wrap"&gt;
      &lt;div class="canvas" ref="canvasRef"&gt;&lt;/div&gt;
      &lt;div class="properties-panel" ref="propertiesRef"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { onMounted, onBeforeUnmount, ref } from 'vue'
import { ElMessage } from 'element-plus'
import BpmnModeler from 'bpmn-js/lib/Modeler'
import camundaBpmnModdle from 'camunda-bpmn-moddle/resources/camunda.json'
import { BpmnPropertiesPanelModule, BpmnPropertiesProviderModule, CamundaPlatformPropertiesProviderModule } from 'bpmn-js-properties-panel'
import 'bpmn-js-properties-panel/dist/assets/properties-panel.css'
import 'bpmn-js/dist/assets/diagram-js.css'
import 'bpmn-js/dist/assets/bpmn-js.css'
import 'bpmn-js/dist/assets/bpmn-font/css/bpmn-embedded.css'

const canvasRef = ref(null)
const propertiesRef = ref(null)
const fileInputRef = ref(null)
let modeler = null

function generateProcessId() {
  const rand = Math.random().toString(36).slice(2, 8)
  return `Process_${rand}`
}

const processId = ref(generateProcessId())

function buildDefaultXml(pid) {
  return `&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn"&gt;
  &lt;bpmn:process id="${pid}" isExecutable="true"&gt;
    &lt;bpmn:startEvent id="StartEvent_1" /&gt;
  &lt;/bpmn:process&gt;
  &lt;bpmndi:BPMNDiagram id="BPMNDiagram_1"&gt;
    &lt;bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="${pid}"&gt;
      &lt;bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"&gt;
        &lt;dc:Bounds x="180" y="180" width="36" height="36" /&gt;
      &lt;/bpmndi:BPMNShape&gt;
    &lt;/bpmndi:BPMNPlane&gt;
  &lt;/bpmndi:BPMNDiagram&gt;
&lt;/bpmn:definitions&gt;`
}

function initModeler() {
  if (modeler) return
  modeler = new BpmnModeler({
    container: canvasRef.value,
    propertiesPanel: {
      parent: propertiesRef.value
    },
    additionalModules: [
      BpmnPropertiesPanelModule,
      BpmnPropertiesProviderModule,
      CamundaPlatformPropertiesProviderModule
    ],
    moddleExtensions: {
      camunda: camundaBpmnModdle
    },
    keyboard: {
      bindTo: document
    }
  })
}

async function createNewDiagram() {
  try {
    await modeler.importXML(buildDefaultXml(processId.value))
    const canvas = modeler.get('canvas')
    canvas.zoom('fit-viewport')
    
    // è‡ªåŠ¨é€‰ä¸­å¼€å§‹äº‹ä»¶ä»¥æ˜¾ç¤ºå±æ€§é¢æ¿
    const elementRegistry = modeler.get('elementRegistry')
    const startEvent = elementRegistry.get('StartEvent_1')
    if (startEvent) {
      const selection = modeler.get('selection')
      selection.select(startEvent)
    }
  } catch (error) {
    console.error('åˆ›å»ºæ–°å›¾è¡¨å¤±è´¥:', error)
  }
}

function handleNew() {
  createNewDiagram()
}

function handleOpen() {
  fileInputRef.value &amp;&amp; fileInputRef.value.click()
}

function onFileChange(e) {
  const file = e.target.files &amp;&amp; e.target.files[0]
  if (!file) return
  const reader = new FileReader()
  reader.onload = async () =&gt; {
    try {
      await modeler.importXML(reader.result)
      modeler.get('canvas').zoom('fit-viewport')
    } catch (err) {
      console.error('å¯¼å…¥å¤±è´¥', err)
    } finally {
      e.target.value = ''
    }
  }
  reader.readAsText(file)
}

async function downloadXML() {
  try {
    const { xml } = await modeler.saveXML({ format: true })
    const blob = new Blob([xml], { type: 'application/xml' })
    const url = URL.createObjectURL(blob)
    const a = document.createElement('a')
    a.href = url
    a.download = 'diagram.bpmn'
    a.click()
    URL.revokeObjectURL(url)
  } catch (err) {
    console.error('å¯¼å‡ºXMLå¤±è´¥', err)
  }
}

async function downloadSVG() {
  try {
    const { svg } = await modeler.saveSVG()
    const blob = new Blob([svg], { type: 'image/svg+xml' })
    const url = URL.createObjectURL(blob)
    const a = document.createElement('a')
    a.href = url
    a.download = 'diagram.svg'
    a.click()
    URL.revokeObjectURL(url)
  } catch (err) {
    console.error('å¯¼å‡ºSVGå¤±è´¥', err)
  }
}

function validateDiagram() {
  try {
    const elementRegistry = modeler.get('elementRegistry')
    const processes = elementRegistry.filter(e =&gt; e.type === 'bpmn:Process')
    if (!processes.length) {
      ElMessage.error('æœªæ‰¾åˆ°æµç¨‹å®šä¹‰ (bpmn:Process)')
      return
    }
    const startEvents = elementRegistry.filter(e =&gt; e.type === 'bpmn:StartEvent')
    if (!startEvents.length) {
      ElMessage.error('æµç¨‹ç¼ºå°‘å¼€å§‹äº‹ä»¶')
      return
    }
    ElMessage.success('æµç¨‹æ£€æŸ¥é€šè¿‡')
  } catch (e) {
    console.error(e)
    ElMessage.error('æµç¨‹æ£€æŸ¥å¤±è´¥')
  }
}

async function deployDiagram() {
  try {
    const { xml } = await modeler.saveXML({ format: true })
    const blob = new Blob([xml], { type: 'application/xml' })
    const url = URL.createObjectURL(blob)
    const a = document.createElement('a')
    a.href = url
    a.download = `${processId.value}.bpmn`
    a.click()
    URL.revokeObjectURL(url)
    ElMessage.success('å·²æ‰“åŒ…æµç¨‹XMLï¼ˆè¯·æ¥å…¥åç«¯éƒ¨ç½²æ¥å£ï¼‰')
  } catch (e) {
    console.error(e)
    ElMessage.error('éƒ¨ç½²æ‰“åŒ…å¤±è´¥')
  }
}

onMounted(async () =&gt; {
  try {
    initModeler()
    await createNewDiagram()
  } catch (error) {
    console.error('åˆå§‹åŒ–æ¨¡å‹å™¨å¤±è´¥:', error)
  }
})

onBeforeUnmount(() =&gt; {
  if (modeler) {
    modeler.destroy()
    modeler = null
  }
})
&lt;/script&gt;

&lt;style scoped&gt;
.bpmn-modeler-page {
  display: flex;
  flex-direction: column;
  height: 100%;
}
.toolbar {
  padding: 8px;
  border-bottom: 1px solid var(--el-border-color);
}
.modeler-wrap {
  display: flex;
  flex: 1;
  min-height: 0;
}
.canvas {
  flex: 1;
  height: calc(100vh - 120px);
}
.properties-panel {
  width: 360px;
  border-left: 1px solid var(--el-border-color);
  height: calc(100vh - 120px);
  overflow: auto;
}
/* bpmn-js core styles (containers) */
:deep(.djs-container) {
  width: 100%;
  height: 100%;
}

/* å±æ€§é¢æ¿æ ·å¼è°ƒæ•´ */
:deep(.bio-properties-panel) {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

:deep(.bio-properties-panel .bio-properties-panel-group-header) {
  background: #f5f5f5;
  border-bottom: 1px solid #e0e0e0;
}

:deep(.bio-properties-panel .bio-properties-panel-entry) {
  border-bottom: 1px solid #f0f0f0;
}

&lt;/style&gt;
</code></pre>
<ul>
<li>æœ€ç»ˆç»“æœ</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e26eb411aac403d808167f544394c25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5qyh5L2N6Z2i:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336334&amp;x-signature=FAlH%2BgbrlVBN3QfpMlEPOsmEb7Y%3D" alt="1.png" loading="lazy"/></p>
<p>å¦‚æœæ‚¨æƒ³åœ¨è‡ªå·±çš„ruoyié¡¹ç›®é›†æˆå·¥ä½œæµï¼Œ æˆ‘ä»¬æä¾›ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ruoyiflow.com" target="_blank" title="https://www.ruoyiflow.com" ref="nofollow noopener noreferrer">ruoyiflow</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•é€šè¿‡æŠ“åŒ…å·¥å…·å¿«é€Ÿç”Ÿæˆ Apifox æ¥å£æ–‡æ¡£ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7579179625461432362</link>    <guid>https://juejin.cn/post/7579179625461432362</guid>    <pubDate>2025-12-03T03:13:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579179625461432362" data-draft-id="7579123072827064339" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•é€šè¿‡æŠ“åŒ…å·¥å…·å¿«é€Ÿç”Ÿæˆ Apifox æ¥å£æ–‡æ¡£ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,æµ‹è¯•"/> <meta itemprop="datePublished" content="2025-12-03T03:13:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Apifox"/> <meta itemprop="url" content="https://juejin.cn/user/2766843870448222"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•é€šè¿‡æŠ“åŒ…å·¥å…·å¿«é€Ÿç”Ÿæˆ Apifox æ¥å£æ–‡æ¡£ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2766843870448222/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Apifox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:13:14.000Z" title="Wed Dec 03 2025 03:13:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Apifox ä½œä¸º API åä½œä¸ç®¡ç†å¹³å°ï¼Œæ”¯æŒå¯¼å…¥å„ç§æ ¼å¼çš„æ¥å£æ•°æ®ã€‚æ— è®ºæ˜¯ OpenAPI/Swaggerã€Postman Collectionã€HAR æ–‡ä»¶ï¼Œè¿˜æ˜¯ cURL å‘½ä»¤ï¼ŒåŸºæœ¬ä¸Šä¸»æµçš„æ¥å£æ•°æ®æ ¼å¼éƒ½èƒ½ç›´æ¥å¯¼å…¥ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0def7c0337d941f2b3d8a1485257afda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=0t9SiESeElfM633N%2BRzEf6JeUDc%3D" alt="" loading="lazy"/></p>
<p>ä¸è¿‡åœ¨è®¸å¤šå®é™…é¡¹ç›®ä¸­ï¼Œæœ€å¤§çš„é—®é¢˜å¾€å¾€ä¸æ˜¯æ€ä¹ˆå¯¼å…¥æ¥å£æ•°æ®ï¼Œè€Œæ˜¯æ²¡æœ‰ç°æˆçš„æ¥å£æ•°æ®å¯ä¾› Apifox å¯¼å…¥ã€‚ä¸€äº›è€é¡¹ç›®å¯èƒ½ä»æœªç»´æŠ¤è¿‡æ¥å£æ–‡æ¡£ï¼Œä¹Ÿæ²¡æœ‰ OpenAPI/Swagger æ–‡æ¡£å¯ç”¨ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œå¦‚æœæƒ³è¦å¿«é€Ÿè¡¥é½é¡¹ç›®ç¼ºå¤±çš„æ¥å£æ–‡æ¡£ï¼Œæˆ–è€…ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼Œè®©æµ‹è¯•äººå‘˜èƒ½å¤ŸåŸºäºçœŸå®æ•°æ®å¿«é€Ÿèµ·æ­¥ã€‚é‚£ä¹ˆé€šè¿‡æµé‡å½•åˆ¶ï¼ˆæŠ“åŒ…ï¼‰å·¥å…·æ¥è·å–æ¥å£æ•°æ®ï¼Œåº”å½“æ˜¯æœ€å¿«æ·çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>é€šè¿‡æŠ“åŒ…å·¥å…·å½•åˆ¶åº”ç”¨çš„ HTTP/HTTPS æµé‡ï¼Œç­›é€‰åå¯¼å‡º HAR æˆ– cURL æ ¼å¼çš„æ–‡ä»¶ï¼Œå†å¯¼å…¥ Apifoxï¼Œå°±å¯ä»¥å¿«é€Ÿç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œä¸ºåç»­çš„æ¥å£æµ‹è¯•æä¾›åŸºç¡€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d07932df8f0548d0a4308749d7e69a00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=Z6CO7kLZ7OzlH5%2FfOjGvHL6QL1Q%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥è¿›è¡Œæµé‡å½•åˆ¶çš„å·¥å…·æœ‰å¾ˆå¤šï¼Œæœ¬æ–‡ä»¥ Charles Proxy ä¸ºä¾‹æ¥æ¼”ç¤ºå…·ä½“æ“ä½œï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Proxymanã€Fiddler ç­‰ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨æµè§ˆå™¨è‡ªå¸¦çš„å¼€å‘è€…å·¥å…·è¿›è¡ŒæŠ“åŒ…ï¼Œæ ¸å¿ƒæµç¨‹å¤§åŒå°å¼‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/094c57f24059409f978091a1b0a82f3c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=1VLVCJgVGKEBEXWniIp%2FNs8A3pI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">Charles å®‰è£…ä¸åŸºç¡€é…ç½®</h2>
<p>Charles æä¾› 30 å¤©å…è´¹è¯•ç”¨ï¼Œä½ å¯ä»¥ä»å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆæœ¬æ¥å®‰è£…ã€‚</p>
<p>é¦–æ¬¡å¯åŠ¨ Charles æ—¶ï¼Œå¯èƒ½ä¼šè¯¢é—®æ˜¯å¦è‡ªåŠ¨é…ç½®ç³»ç»Ÿä»£ç†ã€‚å»ºè®®é€‰æ‹©ã€ŒGrant Privilegesã€æˆäºˆæƒé™å³å¯ï¼Œè¿™æ · Charles å°±èƒ½è‡ªåŠ¨æ•è·ç³»ç»Ÿçš„ HTTP æµé‡äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92e8c0040d8945dda744748356b4e9b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=8aHlrQc0X9BXI7kcbekkqCFYiqA%3D" alt="" loading="lazy"/></p>
<p>ä¸ºäº†èƒ½å¤ŸæŠ“å– HTTPS æµé‡ï¼Œéœ€è¦å®‰è£… Charles çš„æ ¹è¯ä¹¦ã€‚ç‚¹å‡»èœå•æ çš„ ã€ŒHelp â†’ SSL Proxying â†’ Install Charles Root Certificateã€ï¼ŒmacOS ç³»ç»Ÿä¼šæ‰“å¼€é’¥åŒ™ä¸²è®¿é—®åº”ç”¨ï¼Œæœç´¢å¹¶æ‰¾åˆ° Charles Proxy è¯ä¹¦ï¼ŒåŒå‡»åå°†ä¿¡ä»»è®¾ç½®æ”¹ä¸º â€œå§‹ç»ˆä¿¡ä»»â€ å³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41b8f48665f34a4d9e8536aaf2c76ee5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=Rc7jGw06MaqhsQAVZPjNyvSvKto%3D" alt="" loading="lazy"/></p>
<p>Windows ç³»ç»Ÿéœ€è¦åœ¨å®‰è£…è¯ä¹¦æ—¶å®‰è£…åˆ° â€œå—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„â€ å­˜å‚¨åŒºã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65053b85bbe84c7b94de59965d4ddb61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=wY69%2Bu%2BcGBsN1oowD5C408vOXB4%3D" alt="" loading="lazy"/></p>
<p>è¯ä¹¦å®‰è£…åï¼Œæ¥ç€å¯ç”¨ SSL ä»£ç†ã€‚åœ¨ Charles èœå•æ é€‰æ‹© Proxy â†’ SSL Proxying Settingsï¼Œå‹¾é€‰ â€œEnable SSL Proxyingâ€ é€‰é¡¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf6e65a0f7e949cf88a10ee878795421~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=1hk2tBuXSeYiRwUL9jFU14GrxFE%3D" alt="" loading="lazy"/></p>
<p>åœ¨åˆ—è¡¨ä¸­æ·»åŠ éœ€è¦æŠ“å–çš„åŸŸåï¼ˆHostï¼‰å’Œç«¯å£ï¼ˆPort 443ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>*</code> ç›‘å¬æ‰€æœ‰åŸŸåã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8079b0643ad470893bf3a7c962926ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=u0lYI0e36TJN6dy%2Fd4nKff%2FLrXs%3D" alt="" loading="lazy"/></p>
<p>é…ç½®å®Œæˆåï¼ŒCharles å°±å¯ä»¥æ•è·å®Œæ•´çš„ HTTP/HTTPS è¯·æ±‚å’Œå“åº”äº†ã€‚</p>
<p>å¦‚æœä½ ä¸æ¸…æ¥šåº”ç”¨å…·ä½“ä½¿ç”¨äº†å“ªäº›åŸŸåï¼Œå¯ä»¥å…ˆéšä¾¿æ“ä½œåº”ç”¨ï¼Œå†è§‚å¯Ÿ Charles ä¼šè¯åˆ—è¡¨ä¸­ â€œEncryptedâ€ ä¸‹çš„è¯·æ±‚ï¼Œè®°ä¸‹å¯¹åº”çš„åŸŸååï¼Œå†æŠŠå®ƒä»¬æ·»åŠ åˆ° Charles çš„ SSL ä»£ç†è®¾ç½®é‡Œå³å¯ã€‚</p>
<h2 data-id="heading-1">å½•åˆ¶åº”ç”¨çš„ API æµé‡</h2>
<p>å¯åŠ¨éœ€è¦åˆ†æçš„åº”ç”¨æˆ–è€…ç½‘é¡µï¼Œæ“ä½œå„ç§åŠŸèƒ½ï¼Œå¦‚ç™»å½•ã€æŸ¥è¯¢æ•°æ®ã€æäº¤è¡¨å•æˆ–ä¸Šä¼ æ–‡ä»¶ã€‚Charles å·¦ä¾§ä¼šè¯æ ‘ä¼šå®æ—¶æ›´æ–°è¯·æ±‚ï¼ŒæŒ‰åŸŸåå’Œ URL åˆ†ç»„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e54e235816b74c7782cf0b965727c7b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=VYG7lDQL6imvFJ7Hmod1sVkLlJQ%3D" alt="" loading="lazy"/></p>
<p>é€‰ä¸­æŸä¸ªå…·ä½“çš„è¯·æ±‚åï¼Œå³ä¾§é¢æ¿ä¼šæ˜¾ç¤ºè¯·æ±‚çš„åŸºæœ¬ä¿¡æ¯å’Œå“åº”å†…å®¹ã€‚Contents é€‰é¡¹å¡é‡Œä¼šå°† JSON ç­‰å“åº”æŠ˜å æˆæ ‘çŠ¶ç»“æ„ï¼Œæ–¹ä¾¿å¿«é€Ÿç†è§£æ•°æ®ç»“æ„å’Œå­—æ®µã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69f55db376f94e879fd5658bd079cd0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=U0F9jDEYkVjapS1GM8wsbvyrD%2BQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">ç­›é€‰å’Œå¯¼å‡ºæ¥å£</h2>
<p>å½•åˆ¶å®Œæˆåï¼Œä½ å¯èƒ½ä¼šå‘ç°æ•è·åˆ°çš„è¯·æ±‚éå¸¸å¤šã€‚é™¤äº†çœŸæ­£çš„ API æ¥å£è°ƒç”¨ï¼Œè¿˜æœ‰å„ç§é™æ€èµ„æºè¯·æ±‚ã€ç¬¬ä¸‰æ–¹æœåŠ¡è°ƒç”¨ç­‰ç­‰ã€‚è¿™æ—¶å€™éœ€è¦è¿›è¡Œç­›é€‰ï¼Œåªä¿ç•™æˆ‘ä»¬å…³å¿ƒçš„æ¥å£ã€‚</p>
<p>ä½ å¯ä»¥å³é”®ç‚¹å‡»åŸŸåæˆ–è·¯å¾„ï¼Œé€‰æ‹© â€œFocusâ€ï¼ŒCharles ä¼šåªä¿ç•™è¯¥èŠ‚ç‚¹ä¸‹çš„è¯·æ±‚ã€‚æ–¹ä¾¿ä¸“æ³¨åˆ†æã€‚å¯¹äºæ— å…³è¯·æ±‚ï¼Œå¯å³é”®é€‰æ‹© â€œClearâ€ æ¸…é™¤ï¼Œæˆ–å¤šé€‰åæ‰¹é‡åˆ é™¤ã€‚å¦‚æœé‡åˆ°ç¼“å­˜å¯¼è‡´ HTML æˆ– JSON æœªæ­£å¸¸å±•ç¤ºï¼Œä¹Ÿå¯ä»¥å³é”®é€‰æ‹© â€œNo Cachingâ€ï¼Œè®© Charles åœ¨åç»­è¯·æ±‚ä¸­å¿½ç•¥ç¼“å­˜ï¼Œä»è€ŒæŠ“åˆ°å®Œæ•´çš„å“åº”å†…å®¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b8d714537994360b228324519f60d26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=n6RGDJEGqKFj%2FMwcsvfchOZWU0s%3D" alt="" loading="lazy"/></p>
<p>ç­›é€‰å®Œæˆåï¼Œé€‰ä¸­ä½ è¦å¯¼å‡ºçš„ä¼šè¯ï¼ˆå¯ä»¥é€‰æ‹©æ•´ä¸ªåŸŸåèŠ‚ç‚¹ï¼Œæˆ–è€…æŒ‰ä½ Cmd/Ctrl é”®å¤šé€‰å…·ä½“çš„è¯·æ±‚ï¼‰ï¼Œç„¶ååœ¨èœå•æ é€‰æ‹© File â†’ Export Sessionã€‚åœ¨å¯¼å‡ºå¯¹è¯æ¡†ä¸­ï¼Œé€‰æ‹© â€œHTTP Archive (.har)â€ æ ¼å¼å¯¼å‡º HAR æ–‡ä»¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37da0578a9744730bf8d428d5f30433c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=xTwAVAYyfdvlUVVLl0v3Crrqv7g%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">å¯¼å…¥ Apifox è‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£</h2>
<p>æ‰“å¼€ Apifox å®¢æˆ·ç«¯ï¼Œè¿›å…¥â€œé¡¹ç›®è®¾ç½® â†’ å¯¼å…¥æ•°æ® â†’ .har æ–‡ä»¶â€ï¼Œé€‰æ‹©å¯¼å‡ºçš„ HAR æ–‡ä»¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d13c0b0e5f341b1a05f0296d8d5a720~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=d%2BQQw67dpjTx%2FTrDSP4w9rnSFEU%3D" alt="" loading="lazy"/></p>
<p>Apifox ä¼šè‡ªåŠ¨è§£ææ–‡ä»¶å†…å®¹ï¼Œåœ¨é¢„è§ˆåŒºåŸŸæ˜¾ç¤ºæ£€æµ‹åˆ°çš„æ¥å£ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¥å£æ•°é‡ã€è¯·æ±‚æ–¹æ³•ç­‰ã€‚å¯¼å…¥è¿‡ç¨‹ä¸­å¯ä»¥é…ç½®é€‰é¡¹ï¼Œä¾‹å¦‚å¯¼å…¥åˆ°å“ªä¸ªæ¨¡å—æˆ–æ˜¯å¦è¦†ç›–å·²æœ‰æ¥å£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/701dfcaa19cd4eb7b28c61c19da9bb26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXBpZm94:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765336394&amp;x-signature=yI%2BpZE7zm5nqRgCiBwi0V4wiYOM%3D" alt="" loading="lazy"/></p>
<p>å¯¼å…¥å®Œæˆåï¼Œå°±å¯ä»¥åœ¨å¯¹åº”æ¨¡å—çš„æ¥å£åˆ—è¡¨é‡ŒæŸ¥çœ‹äº†ã€‚</p>
<h2 data-id="heading-4">å®Œå–„å’Œä¼˜åŒ–æ¥å£æ–‡æ¡£</h2>
<p>ä¸ºäº†ç¨³å¦¥ä¸€äº›ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„æ¥å£æ–‡æ¡£é€šå¸¸éœ€è¦è¿›ä¸€æ­¥è°ƒæ•´ï¼Œæ¯”å¦‚å®Œå–„æ¥å£åç§°ã€è¡¥å……ä¸€äº›å‚æ•°åŠå…¶æè¿°ã€å®Œå–„å“åº”æ•°æ®ç»“æ„ï¼Œç¡®ä¿æ–‡æ¡£ç¬¦åˆä¸šåŠ¡éœ€æ±‚ã€‚</p>
<p>å¦‚æœæ¥å£éœ€è¦æˆæƒï¼Œä¹Ÿè¯·åœ¨ Apifox çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.apifox.com%2Fenvironments-and-variables" target="_blank" title="https://docs.apifox.com/environments-and-variables" ref="nofollow noopener noreferrer">ç¯å¢ƒå˜é‡</a>æˆ–Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.apifox.com%2F5802184m0" target="_blank" title="https://docs.apifox.com/5802184m0" ref="nofollow noopener noreferrer">Auth è®¾ç½®</a>ä¸­é…ç½®ç›¸åº”ä¿¡æ¯ã€‚</p>
<hr/>
<p>é€šè¿‡æŠ“åŒ…å·¥å…·å½•åˆ¶ HTTP/HTTPS æµé‡ï¼Œå†å¯¼å…¥ Apifoxï¼Œå¯ä»¥å¿«é€Ÿç”Ÿæˆæ¥å£æ–‡æ¡£å¹¶ä¸ºæµ‹è¯•æä¾›çœŸå®æ•°æ®æ”¯æŒã€‚</p>
<p>æ— è®ºæ˜¯æµè§ˆå™¨ã€æ¡Œé¢å®¢æˆ·ç«¯è¿˜æ˜¯ç§»åŠ¨åº”ç”¨ï¼Œè¿™ç§æ–¹æ³•éƒ½èƒ½ç¼©çŸ­æ¥å£æ–‡æ¡£çš„å‡†å¤‡æ—¶é—´ï¼Œè®©å›¢é˜Ÿå¿«é€Ÿä¸Šæ‰‹æ¥å£æµ‹è¯•ä¸å¼€å‘ã€‚</p>
<p>æ¬¢è¿å„ä½ç”¨æˆ·å¯¹ Apifox ç»§ç»­æå‡ºä½¿ç”¨åé¦ˆå’Œä¼˜åŒ–æ„è§ï¼Œæˆ‘ä»¬ä¼šæŒç»­ä¼˜åŒ–æ›´æ–°ï¼Œè‡´åŠ›äºä¸ºç”¨æˆ·æä¾›æ›´ä¼˜ç§€çš„äº§å“åŠŸèƒ½å’Œæ›´æè‡´çš„ä½¿ç”¨ä½“éªŒï¼</p>
<p><strong><strong>æœ‰ä»»ä½•é—®é¢˜æ¬¢è¿åœ¨</strong></strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.apifox.com%2Fdoc-5751209%23%25E7%2594%25A8%25E6%2588%25B7%25E7%25BE%25A4%2F" target="_blank" title="https://docs.apifox.com/doc-5751209#%E7%94%A8%E6%88%B7%E7%BE%A4/" ref="nofollow noopener noreferrer"> <strong><strong>Apifox ç”¨æˆ·ç¾¤</strong></strong></a><strong><strong>ä¸æˆ‘ä»¬äº¤æµæ²Ÿé€š</strong>ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äº‘ä¸Šæ•°æ®å®‰å…¨æ–°èŒƒå¼ï¼šApache Doris IAM Assume Role è§£é”æ— å¯†é’¥è®¿é—® AWS S3 æ•°æ®]]></title>    <link>https://juejin.cn/post/7579192114828148763</link>    <guid>https://juejin.cn/post/7579192114828148763</guid>    <pubDate>2025-12-03T03:31:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579192114828148763" data-draft-id="7579167622106169344" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äº‘ä¸Šæ•°æ®å®‰å…¨æ–°èŒƒå¼ï¼šApache Doris IAM Assume Role è§£é”æ— å¯†é’¥è®¿é—® AWS S3 æ•°æ®"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-12-03T03:31:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SelectDB"/> <meta itemprop="url" content="https://juejin.cn/user/3189021726222904"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äº‘ä¸Šæ•°æ®å®‰å…¨æ–°èŒƒå¼ï¼šApache Doris IAM Assume Role è§£é”æ— å¯†é’¥è®¿é—® AWS S3 æ•°æ®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3189021726222904/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SelectDB
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:31:03.000Z" title="Wed Dec 03 2025 03:31:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€ä¼ ç»Ÿ AK/SK æ–¹å¼è®¿é—® AWS èµ„æºå­˜åœ¨çš„é—®é¢˜</h3>
<p><strong>å¯†é’¥ç®¡ç†å›°å¢ƒï¼š</strong></p>
<ul>
<li><strong>é•¿æœŸæš´éœ²é£é™©</strong>ï¼šé™æ€ AK/SK éœ€ç¡¬ç¼–ç äºé…ç½®æ–‡ä»¶ä¸­ï¼Œä¸€æ—¦å› ä»£ç æ³„éœ²ã€è¯¯æäº¤æˆ–æ¶æ„çªƒå–å¯¼è‡´å¯†é’¥æ‰©æ•£ï¼Œæ”»å‡»è€…å¯æ°¸ä¹…è·å¾—ç­‰åŒäºå¯†é’¥æ‰€æœ‰è€…çš„å®Œæ•´æƒé™ï¼Œå¼•å‘æŒç»­æ€§çš„æ•°æ®æ³„éœ²ã€èµ„æºç¯¡æ”¹åŠèµ„é‡‘æŸå¤±é£é™©ï¼›</li>
<li><strong>å®¡è®¡ç›²åŒº</strong>ï¼š å¤šç”¨æˆ·/å¤šæœåŠ¡å…±äº«åŒä¸€ç»„å¯†é’¥æ—¶ï¼Œäº‘æ“ä½œæ—¥å¿—ä»…è®°å½•å¯†é’¥èº«ä»½è€Œæ— æ³•å…³è”å…·ä½“ä½¿ç”¨è€…ï¼Œæ— æ³•è¿½æº¯çœŸå®è´£ä»»äººæˆ–ä¸šåŠ¡æ¨¡å—ï¼›</li>
<li><strong>è¿ç»´æˆæœ¬é«˜</strong>ï¼šå¯†é’¥è½®æ¢ç¾éš¾ï¼Œéœ€æ‰‹åŠ¨è½®æ¢ä¸šåŠ¡æ¨¡å—å¯†é’¥ï¼Œå®¹æ˜“å‡ºé”™è§¦å‘æœåŠ¡ä¸­æ–­ï¼›</li>
<li><strong>æƒé™ç®¡ç†å¤±æ§</strong>ï¼šè´¦æˆ·ç®¡ç†ä¸æ¸…æ™°ï¼Œæˆæƒæ— æ³•æ»¡è¶³æœåŠ¡/å®ä¾‹çº§çš„æœ€å°æƒé™ç®¡æ§éœ€æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-1">äºŒã€AWS IAM Assume Role æœºåˆ¶ä»‹ç»</h3>
<p>AWS Assume Role æ˜¯ä¸€ç§å®‰å…¨èº«ä»½åˆ‡æ¢æœºåˆ¶ï¼Œå…è®¸ä¸€ä¸ªå¯ä¿¡å®ä½“ï¼ˆå¦‚ IAM ç”¨æˆ·ã€EC2 å®ä¾‹æˆ–å¤–éƒ¨è´¦å·ï¼‰é€šè¿‡ STSï¼ˆå®‰å…¨ä»¤ç‰ŒæœåŠ¡ï¼‰ä¸´æ—¶è·å–ç›®æ ‡è§’è‰²çš„æƒé™ã€‚å…¶è¿ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c09a6c99cab4d95a469154b19892dac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337462&amp;x-signature=yWWAq%2F%2FA52DrR95Y5k%2F6gD%2F7Avc%3D" alt="äºŒã€AWS IAM Assume Role æœºåˆ¶ä»‹ç».PNG" loading="lazy"/></p>
<p><strong>ä½¿ç”¨ AWS IAM Assume Role æ–¹å¼è®¿é—®çš„ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>åŠ¨æ€ä»¤ç‰Œæœºåˆ¶ï¼ˆ15 åˆ†é’Ÿï½12 å°æ—¶æœ‰æ•ˆæœŸï¼‰æ›¿ä»£æ°¸ä¹…å¯†é’¥</li>
<li>é€šè¿‡<code>External ID</code>å®ç°è·¨è´¦å·å®‰å…¨éš”ç¦»ï¼Œå¹¶ä¸”å¯é€šè¿‡ AWS åå°æœåŠ¡è¿›è¡Œå®¡è®¡</li>
<li>åŸºäºè§’è‰²çš„æœ€å°æƒé™åŸåˆ™ï¼ˆPrinciple of Least Privilegeï¼‰</li>
</ul>
<p><strong>AWS IAM Assume Role è®¿é—® S3 Bucket çš„é‰´æƒè¿‡ç¨‹ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f88cb77b6794d15b72d31fc202a1dff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337462&amp;x-signature=tX3RTuyX9ewuzWnnqzy1h7xN4eQ%3D" alt="äºŒã€AWS IAM Assume Role æœºåˆ¶ä»‹ç»-1.PNG" loading="lazy"/></p>
<h4 data-id="heading-2">é˜¶æ®µ 1ï¼šæºç”¨æˆ·èº«ä»½éªŒè¯</h4>
<ol>
<li>æƒé™ç­–ç•¥æ£€æŸ¥
<ol>
<li>æºç”¨æˆ·å‘èµ· <code>AssumeRole</code> è¯·æ±‚æ—¶ï¼Œæºè´¦æˆ·çš„ IAM ç­–ç•¥å¼•æ“é¦–å…ˆéªŒè¯ï¼š <code>è¯¥ç”¨æˆ·æ˜¯å¦è¢«æˆæƒè°ƒç”¨ sts:AssumeRole æ“ä½œï¼Ÿ</code></li>
<li>æ£€æŸ¥ä¾æ®ï¼šé™„ç€åœ¨æºç”¨æˆ·èº«ä»½ä¸Šçš„ IAM Permissions Policies</li>
</ol>
</li>
<li>ä¿¡ä»»å…³ç³»æ ¡éªŒ
<ol>
<li>é€šè¿‡ STS æœåŠ¡å‘ç›®æ ‡è´¦æˆ·å‘èµ·è¯·æ±‚ï¼š <code>æºç”¨æˆ·æ˜¯å¦åœ¨ç›®æ ‡è§’è‰²çš„ä¿¡ä»»ç­–ç•¥ç™½åå•ä¸­ï¼Ÿ</code></li>
<li>æ£€æŸ¥ä¾æ®ï¼šç›®æ ‡è§’è‰²ç»‘å®šçš„ IAM Trust Relationships Policiesï¼ˆæ˜ç¡®å…è®¸å“ªäº›è´¦å·/ç”¨æˆ·æ‹…ä»»è¯¥è§’è‰²ï¼‰</li>
</ol>
</li>
</ol>
<h4 data-id="heading-3">é˜¶æ®µ 2ï¼šç›®æ ‡è§’è‰²æƒé™æ¿€æ´»</h4>
<ol>
<li>ä¸´æ—¶å‡­è¯ç”Ÿæˆ
<ol>
<li>è‹¥ä¿¡ä»»å…³ç³»éªŒè¯é€šè¿‡ï¼ŒSTS ç”Ÿæˆä¸‰è¦ç´ ä¸´æ—¶å‡­è¯</li>
<li>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"AccessKeyId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ASIA***"</span><span class="hljs-punctuation">,</span>  
  <span class="hljs-attr">"SecretAccessKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"***"</span><span class="hljs-punctuation">,</span>  
  <span class="hljs-attr">"SessionToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"***"</span> <span class="hljs-comment">// æœ‰æ•ˆæœŸ 15min-12h</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ol>
</li>
<li>ç›®æ ‡è§’è‰²æƒé™éªŒè¯
<ol>
<li>ç›®æ ‡è§’è‰²ä½¿ç”¨ä¸´æ—¶å‡­è¯è®¿é—® AWS S3 å‰ï¼Œç›®æ ‡è´¦æˆ·çš„ IAM ç­–ç•¥å¼•æ“æ ¡éªŒï¼š <code>è¯¥è§’è‰²æ˜¯å¦è¢«æˆæƒæ‰§è¡Œè¯·æ±‚çš„S3æ“ä½œï¼Ÿ (å¦‚s3:GetObjectã€s3:PutObjectç­‰)</code></li>
<li>æ£€æŸ¥ä¾æ®ï¼šé™„ç€åœ¨ç›®æ ‡è§’è‰²ä¸Šçš„ IAM Permissions Policiesï¼ˆå®šä¹‰è§’è‰²èƒ½åšä»€ä¹ˆï¼‰</li>
</ol>
</li>
</ol>
<h4 data-id="heading-4">é˜¶æ®µ 3ï¼šèµ„æºæ“ä½œæ‰§è¡Œ</h4>
<ol>
<li>è®¿é—®å­˜å‚¨æ¡¶
<ol>
<li>å…¨éƒ¨éªŒè¯é€šè¿‡åï¼Œç›®æ ‡è§’è‰²æ‰å¯æ‰§è¡Œ S3 API æ“ä½œã€‚</li>
</ol>
</li>
</ol>
<h3 data-id="heading-5">ä¸‰ã€Apache Doris å¦‚ä½•åº”ç”¨ AWS IAM Assume Role é‰´æƒæœºåˆ¶</h3>
<ol>
<li>Doris é€šè¿‡å°† FEã€BE è¿›ç¨‹æ‰€éƒ¨ç½²çš„ AWS EC2 Instances ç»‘å®šåˆ° Source Account æ¥ä½¿ç”¨ AWS IAM Assume Role çš„åŠŸèƒ½ï¼Œä¸»è¦çš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…·ä½“çš„é…ç½®å¯å‚ç…§<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2F3.0%2Fadmin-manual%2Fauth%2Fintegrations%2Faws-authentication-and-authorization" target="_blank" title="https://doris.apache.org/zh-CN/docs/3.0/admin-manual/auth/integrations/aws-authentication-and-authorization" ref="nofollow noopener noreferrer">å®˜ç½‘æ–‡æ¡£å’Œè§†é¢‘</a> ï¼š</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2428f1db51ce44578e67637df69877ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VsZWN0REI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337462&amp;x-signature=pj3Yw6hGGHZe9jm3AqeG6ZzzG2k%3D" alt="ä¸‰ã€Apache Doris å¦‚ä½•åº”ç”¨ AWS IAM Assume Role â€‹é‰´æƒæœºåˆ¶.PNG" loading="lazy"/></p>
<ol>
<li>
<p>å®Œæˆé…ç½®å Doris FE/BE è¿›ç¨‹ä¼šè‡ªåŠ¨è· EC2 Instance çš„ Profile è¿›è¡Œæ‰§è¡Œ Assume Role æ“ä½œè®¿é—® Bucket æ“ä½œï¼Œæ‰©å®¹æ—¶ BE èŠ‚ç‚¹ä¼šè‡ªåŠ¨æ£€æµ‹æ–°çš„ EC2 Instance æ˜¯å¦æˆåŠŸç»‘å®š IAM Roleï¼Œé˜²æ­¢å‡ºç°æ¼é…çš„æƒ…å†µï¼›</p>
</li>
<li>
<p>Doris çš„ S3 Loadã€TVFã€Exportã€Resourceã€Repositoryã€Storage Vault ç­‰åŠŸèƒ½åœ¨ 3.0.6 ç‰ˆæœ¬ä¹‹åå‡æ”¯æŒäº† AWS Assume Role çš„æ–¹å¼ä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨åˆ›å»ºæ—¶ä¼šè¿›è¡Œè¿é€šæ€§æ£€æµ‹ï¼ŒS3 Load SQL ä¸¾ä¾‹å¦‚ä¸‹ï¼š</p>
</li>
</ol>
<pre><code class="hljs language-SQL" lang="SQL">  LOAD LABEL s3_load_demo_202508
  (
      DATA INFILE("s3://your_bucket_name/s3load_example.csv")
      <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">TABLE</span> test_s3load
      COLUMNS TERMINATED <span class="hljs-keyword">BY</span> ","
      FORMAT <span class="hljs-keyword">AS</span> "CSV"
      (user_id, name, age)
  )
  <span class="hljs-keyword">WITH</span> S3
  (
      "provider" <span class="hljs-operator">=</span> "S3",
      "s3.endpoint" <span class="hljs-operator">=</span> "s3.us-east-1.amazonaws.com",
      "s3.region" <span class="hljs-operator">=</span> "us-east-1",
      "s3.role_arn" <span class="hljs-operator">=</span> "arn:aws:iam::543815668950:role/test-role1",
      "s3.external_id" <span class="hljs-operator">=</span> "1001"      <span class="hljs-comment">-- å¯é€‰å‚æ•°</span>
  )
  PROPERTIES
  (
      "timeout" <span class="hljs-operator">=</span> "3600"
  );
</code></pre>
<p>å…¶ä¸­ "s3.role_arn" å¯¹åº”å¡«å…¥ AWS IAM Account2 ä¸‹çš„ Iam role2 çš„ arn å€¼ï¼Œ"s3.external_id"å¯¹åº”å¡«å…¥ Trust Relationships Policies ä¸­é…ç½®çš„ externalId çš„å€¼ï¼ˆå¯é€‰é…ç½®ï¼‰ã€‚</p>
<p>æ›´å¤šåŠŸèƒ½ SQL è¯­å¥è¯¦ç»†å‚è€ƒï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2F3.0%2Fadmin-manual%2Fauth%2Fintegrations%2Faws-authentication-and-authorization" target="_blank" title="https://doris.apache.org/zh-CN/docs/3.0/admin-manual/auth/integrations/aws-authentication-and-authorization" ref="nofollow noopener noreferrer">Doris å®˜ç½‘æ–‡æ¡£</a>ï¼›</p>
<ol>
<li>Doris å½“å‰ä»…æ”¯æŒäº† AWS IAM Assume Role çš„æœºåˆ¶ï¼Œæœªæ¥ä¼šé€æ­¥å®ç°å…¶ä»–äº‘å‚å•†çš„ç±»ä¼¼é‰´æƒæœºåˆ¶ã€‚</li>
</ol>
<h2 data-id="heading-6">Reference</h2>
<ul>
<li>å®˜ç½‘æ–‡æ¡£ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2F3.0%2Fadmin-manual%2Fauth%2Fintegrations%2Faws-authentication-and-authorization" target="_blank" title="https://doris.apache.org/zh-CN/docs/3.0/admin-manual/auth/integrations/aws-authentication-and-authorization" ref="nofollow noopener noreferrer">doris.apache.org/zh-CN/docs/â€¦</a></li>
<li>è§†é¢‘ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1U3uezjEPW%2F%3Fvd_source%3D20479f0462e74fcf98f1df731639610f" target="_blank" title="https://www.bilibili.com/video/BV1U3uezjEPW/?vd_source=20479f0462e74fcf98f1df731639610f" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1U3â€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elasticsearchç»å…¸é¢è¯•é¢˜æ¡ˆä¾‹åˆ†æ]]></title>    <link>https://juejin.cn/post/7579175271680294922</link>    <guid>https://juejin.cn/post/7579175271680294922</guid>    <pubDate>2025-12-03T03:30:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579175271680294922" data-draft-id="7579176524130975795" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elasticsearchç»å…¸é¢è¯•é¢˜æ¡ˆä¾‹åˆ†æ"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-03T03:30:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="360_go_php"/> <meta itemprop="url" content="https://juejin.cn/user/2436173498956695"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elasticsearchç»å…¸é¢è¯•é¢˜æ¡ˆä¾‹åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173498956695/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    360_go_php
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:30:49.000Z" title="Wed Dec 03 2025 03:30:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">1.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Elasticsearch?<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d46cca89839245a9824f9ea0286d2f5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337449&amp;x-signature=eVO5tkh3nprk9BIfcwr3A9nhSzs%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h2>
<p>ç³»ç»Ÿä¸­çš„æ•°æ®ï¼Œ éšç€ä¸šåŠ¡çš„å‘å±•ï¼Œæ—¶é—´çš„æ¨ç§»ï¼Œ å°†ä¼šéå¸¸å¤šï¼Œ è€Œä¸šåŠ¡ä¸­å¾€å¾€é‡‡ç”¨æ¨¡ç³ŠæŸ¥è¯¢è¿›è¡Œæ•°æ®çš„æœç´¢ï¼Œ è€Œæ¨¡ç³ŠæŸ¥è¯¢ä¼šå¯¼è‡´æŸ¥è¯¢å¼•æ“æ”¾å¼ƒç´¢å¼•ï¼Œå¯¼è‡´ç³»ç»ŸæŸ¥è¯¢æ•°æ®æ—¶éƒ½æ˜¯å…¨è¡¨æ‰«æï¼Œåœ¨ç™¾ä¸‡çº§åˆ«çš„æ•°æ®åº“ä¸­ï¼ŒæŸ¥è¯¢æ•ˆç‡æ˜¯éå¸¸ä½ä¸‹çš„ï¼Œè€Œæˆ‘ä»¬ä½¿ç”¨ ES åšä¸€ä¸ªå…¨æ–‡ç´¢å¼•ï¼Œå°†ç»å¸¸æŸ¥è¯¢çš„ç³»ç»ŸåŠŸèƒ½çš„æŸäº›å­—æ®µï¼Œæ¯”å¦‚è¯´ç”µå•†ç³»ç»Ÿçš„å•†å“è¡¨ä¸­å•†å“åï¼Œæè¿°ã€ä»·æ ¼è¿˜æœ‰ id è¿™äº›å­—æ®µæˆ‘ä»¬æ”¾å…¥ ES ç´¢å¼•åº“é‡Œï¼Œå¯ä»¥æé«˜æŸ¥è¯¢é€Ÿåº¦ã€‚</p>
<h2 data-id="heading-1">2.Elasticsearchæ˜¯å¦‚ä½•å®ç°Masteré€‰ä¸¾çš„ï¼Ÿ<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c758bc9074144fcab57dc509fa403554~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337449&amp;x-signature=FP7t8qbRcPnyn1QQ9QvHUmUrWik%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h2>
<p>Elasticsearchçš„é€‰ä¸»æ˜¯ZenDiscoveryæ¨¡å—è´Ÿè´£çš„ï¼Œä¸»è¦åŒ…å«Pingï¼ˆèŠ‚ç‚¹ä¹‹é—´é€šè¿‡è¿™ä¸ªRPCæ¥å‘ç°å½¼æ­¤ï¼‰å’ŒUnicastï¼ˆå•æ’­æ¨¡å—åŒ…å«ä¸€ä¸ªä¸»æœºåˆ—è¡¨ä»¥æ§åˆ¶å“ªäº›èŠ‚ç‚¹éœ€è¦pingé€šï¼‰è¿™ä¸¤éƒ¨åˆ†ï¼›<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c899fdd1b2040d4a5d0ed4f9911386e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337449&amp;x-signature=zJeuYbUr8E8%2BqMEUWoL6mk0lQKs%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<p>å¯¹æ‰€æœ‰å¯ä»¥æˆä¸ºmasterçš„èŠ‚ç‚¹ï¼ˆnode.master: trueï¼‰æ ¹æ®nodeIdå­—å…¸æ’åºï¼Œæ¯æ¬¡é€‰ä¸¾æ¯ä¸ªèŠ‚ç‚¹éƒ½æŠŠè‡ªå·±æ‰€çŸ¥é“èŠ‚ç‚¹æ’ä¸€æ¬¡åºï¼Œç„¶åé€‰å‡ºç¬¬ä¸€ä¸ªï¼ˆç¬¬0ä½ï¼‰èŠ‚ç‚¹ï¼Œæš‚ä¸”è®¤ä¸ºå®ƒæ˜¯masterèŠ‚ç‚¹ã€‚</p>
<p>å¦‚æœå¯¹æŸä¸ªèŠ‚ç‚¹çš„æŠ•ç¥¨æ•°è¾¾åˆ°ä¸€å®šçš„å€¼ï¼ˆå¯ä»¥æˆä¸ºmasterèŠ‚ç‚¹æ•°n/2+1ï¼‰å¹¶ä¸”è¯¥èŠ‚ç‚¹è‡ªå·±ä¹Ÿé€‰ä¸¾è‡ªå·±ï¼Œé‚£è¿™ä¸ªèŠ‚ç‚¹å°±æ˜¯masterã€‚å¦åˆ™é‡æ–°é€‰ä¸¾ä¸€ç›´åˆ°æ»¡è¶³ä¸Šè¿°æ¡ä»¶ã€‚</p>
<p>è¡¥å……ï¼šmasterèŠ‚ç‚¹çš„èŒè´£ä¸»è¦åŒ…æ‹¬é›†ç¾¤ã€èŠ‚ç‚¹å’Œç´¢å¼•çš„ç®¡ç†ï¼Œä¸è´Ÿè´£æ–‡æ¡£çº§åˆ«çš„ç®¡ç†ï¼›dataèŠ‚ç‚¹å¯ä»¥å…³é—­httpåŠŸèƒ½ã€‚</p>
<h2 data-id="heading-2">3.Elasticsearchä¸­çš„èŠ‚ç‚¹ï¼ˆæ¯”å¦‚å…±20ä¸ªï¼‰ï¼Œå…¶ä¸­çš„10ä¸ªé€‰äº†ä¸€ä¸ªmasterï¼Œå¦å¤–10ä¸ªé€‰äº†å¦ä¸€ä¸ªmasterï¼Œæ€ä¹ˆåŠï¼Ÿ<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17e0d1c480da4f0caeb496e6d23effe8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337449&amp;x-signature=shvS1Lq%2B42iiZiJEVnGPzMSEhT8%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h2>
<p>å½“é›†ç¾¤masterå€™é€‰æ•°é‡ä¸å°äº3ä¸ªæ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®æœ€å°‘æŠ•ç¥¨é€šè¿‡æ•°é‡ï¼ˆdiscovery.zen.minimum_master_nodesï¼‰è¶…è¿‡æ‰€æœ‰å€™é€‰èŠ‚ç‚¹ä¸€åŠä»¥ä¸Šæ¥è§£å†³è„‘è£‚é—®é¢˜ï¼›<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1c2a338df674192b5a4c7ce053608e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337449&amp;x-signature=7757NkYAcTLDwiH5%2FSzwy6DMM58%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<p>å½“å€™é€‰æ•°é‡ä¸ºä¸¤ä¸ªæ—¶ï¼Œåªèƒ½ä¿®æ”¹ä¸ºå”¯ä¸€çš„ä¸€ä¸ªmasterå€™é€‰ï¼Œå…¶ä»–ä½œä¸ºdataèŠ‚ç‚¹ï¼Œé¿å…è„‘è£‚é—®é¢˜ã€‚</p>
<h2 data-id="heading-3">4.è¯¦ç»†æè¿°ä¸€ä¸‹Elasticsearchç´¢å¼•æ–‡æ¡£çš„è¿‡ç¨‹ã€‚</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9a0c446a7af40a18309ec94db4ab990~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337449&amp;x-signature=rxLF30WiUN9vvjGURtBzAypN0zk%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>åè°ƒèŠ‚ç‚¹é»˜è®¤ä½¿ç”¨æ–‡æ¡£IDå‚ä¸è®¡ç®—ï¼ˆä¹Ÿæ”¯æŒé€šè¿‡routingï¼‰ï¼Œä»¥ä¾¿ä¸ºè·¯ç”±æä¾›åˆé€‚çš„åˆ†ç‰‡ã€‚</p>
<p>shard = hash(document_id) % (num_of_primary_shards)</p>
<p>å½“åˆ†ç‰‡æ‰€åœ¨çš„èŠ‚ç‚¹æ¥æ”¶åˆ°æ¥è‡ªåè°ƒèŠ‚ç‚¹çš„è¯·æ±‚åï¼Œä¼šå°†è¯·æ±‚å†™å…¥åˆ°Memory Bufferï¼Œç„¶åå®šæ—¶ï¼ˆé»˜è®¤æ˜¯æ¯éš”1ç§’ï¼‰å†™å…¥åˆ°Filesystem Cacheï¼Œè¿™ä¸ªä»Momery Bufferåˆ°Filesystem Cacheçš„è¿‡ç¨‹å°±å«åšrefreshï¼›</p>
<p>å½“ç„¶åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå­˜åœ¨Momery Bufferå’ŒFilesystem Cacheçš„æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ï¼ŒESæ˜¯é€šè¿‡translogçš„æœºåˆ¶æ¥ä¿è¯æ•°æ®çš„å¯é æ€§çš„ã€‚å…¶å®ç°æœºåˆ¶æ˜¯æ¥æ”¶åˆ°è¯·æ±‚åï¼ŒåŒæ—¶ä¹Ÿä¼šå†™å…¥åˆ°translogä¸­ï¼Œå½“Filesystem cacheä¸­çš„æ•°æ®å†™å…¥åˆ°ç£ç›˜ä¸­æ—¶ï¼Œæ‰ä¼šæ¸…é™¤æ‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšflushï¼›</p>
<p>åœ¨flushè¿‡ç¨‹ä¸­ï¼Œå†…å­˜ä¸­çš„ç¼“å†²å°†è¢«æ¸…é™¤ï¼Œå†…å®¹è¢«å†™å…¥ä¸€ä¸ªæ–°æ®µï¼Œæ®µçš„fsyncå°†åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ç‚¹ï¼Œå¹¶å°†å†…å®¹åˆ·æ–°åˆ°ç£ç›˜ï¼Œæ—§çš„translogå°†è¢«åˆ é™¤å¹¶å¼€å§‹ä¸€ä¸ªæ–°çš„translogã€‚</p>
<p>flushè§¦å‘çš„æ—¶æœºæ˜¯å®šæ—¶è§¦å‘ï¼ˆé»˜è®¤30åˆ†é’Ÿï¼‰æˆ–è€…translogå˜å¾—å¤ªå¤§ï¼ˆé»˜è®¤ä¸º512Mï¼‰æ—¶ï¼›</p>
<h2 data-id="heading-4">5.è¯¦ç»†æè¿°ä¸€ä¸‹Elasticsearchæ›´æ–°å’Œåˆ é™¤æ–‡æ¡£çš„è¿‡ç¨‹</h2>
<p>åˆ é™¤å’Œæ›´æ–°ä¹Ÿéƒ½æ˜¯å†™æ“ä½œï¼Œä½†æ˜¯Elasticsearchä¸­çš„æ–‡æ¡£æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ä¸èƒ½è¢«åˆ é™¤æˆ–è€…æ”¹åŠ¨ä»¥å±•ç¤ºå…¶å˜æ›´ï¼›</p>
<p>ç£ç›˜ä¸Šçš„æ¯ä¸ªæ®µéƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„.delæ–‡ä»¶ã€‚å½“åˆ é™¤è¯·æ±‚å‘é€åï¼Œæ–‡æ¡£å¹¶æ²¡æœ‰çœŸçš„è¢«åˆ é™¤ï¼Œè€Œæ˜¯åœ¨.delæ–‡ä»¶ä¸­è¢«æ ‡è®°ä¸ºåˆ é™¤ã€‚è¯¥æ–‡æ¡£ä¾ç„¶èƒ½åŒ¹é…æŸ¥è¯¢ï¼Œä½†æ˜¯ä¼šåœ¨ç»“æœä¸­è¢«è¿‡æ»¤æ‰ã€‚å½“æ®µåˆå¹¶æ—¶ï¼Œåœ¨.delæ–‡ä»¶ä¸­è¢«æ ‡è®°ä¸ºåˆ é™¤çš„æ–‡æ¡£å°†ä¸ä¼šè¢«å†™å…¥æ–°æ®µã€‚</p>
<p>åœ¨æ–°çš„æ–‡æ¡£è¢«åˆ›å»ºæ—¶ï¼ŒElasticsearchä¼šä¸ºè¯¥æ–‡æ¡£æŒ‡å®šä¸€ä¸ªç‰ˆæœ¬å·ï¼Œå½“æ‰§è¡Œæ›´æ–°æ—¶ï¼Œæ—§ç‰ˆæœ¬çš„æ–‡æ¡£åœ¨.delæ–‡ä»¶ä¸­è¢«æ ‡è®°ä¸ºåˆ é™¤ï¼Œæ–°ç‰ˆæœ¬çš„æ–‡æ¡£è¢«ç´¢å¼•åˆ°ä¸€ä¸ªæ–°æ®µã€‚æ—§ç‰ˆæœ¬çš„æ–‡æ¡£ä¾ç„¶èƒ½åŒ¹é…æŸ¥è¯¢ï¼Œä½†æ˜¯ä¼šåœ¨ç»“æœä¸­è¢«è¿‡æ»¤æ‰ã€‚</p>
<h2 data-id="heading-5">6.è¯¦ç»†æè¿°ä¸€ä¸‹Elasticsearchæœç´¢çš„è¿‡ç¨‹</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a34b7220e764bc19a3622283e0bcd06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337449&amp;x-signature=l1N%2FVs24e8xEAmgqp94VuO%2BRYX0%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>æœç´¢è¢«æ‰§è¡Œæˆä¸€ä¸ªä¸¤é˜¶æ®µè¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º Query Then Fetchï¼›</p>
<p>åœ¨åˆå§‹æŸ¥è¯¢é˜¶æ®µæ—¶ï¼ŒæŸ¥è¯¢ä¼šå¹¿æ’­åˆ°ç´¢å¼•ä¸­æ¯ä¸€ä¸ªåˆ†ç‰‡æ‹·è´ï¼ˆä¸»åˆ†ç‰‡æˆ–è€…å‰¯æœ¬åˆ†ç‰‡ï¼‰ã€‚ æ¯ä¸ªåˆ†ç‰‡åœ¨æœ¬åœ°æ‰§è¡Œæœç´¢å¹¶æ„å»ºä¸€ä¸ªåŒ¹é…æ–‡æ¡£çš„å¤§å°ä¸º from + size çš„ä¼˜å…ˆé˜Ÿåˆ—ã€‚PSï¼šåœ¨æœç´¢çš„æ—¶å€™æ˜¯ä¼šæŸ¥è¯¢Filesystem Cacheçš„ï¼Œä½†æ˜¯æœ‰éƒ¨åˆ†æ•°æ®è¿˜åœ¨Memory Bufferï¼Œæ‰€ä»¥æœç´¢æ˜¯è¿‘å®æ—¶çš„ã€‚</p>
<p>æ¯ä¸ªåˆ†ç‰‡è¿”å›å„è‡ªä¼˜å…ˆé˜Ÿåˆ—ä¸­ æ‰€æœ‰æ–‡æ¡£çš„ ID å’Œæ’åºå€¼ ç»™åè°ƒèŠ‚ç‚¹ï¼Œå®ƒåˆå¹¶è¿™äº›å€¼åˆ°è‡ªå·±çš„ä¼˜å…ˆé˜Ÿåˆ—ä¸­æ¥äº§ç”Ÿä¸€ä¸ªå…¨å±€æ’åºåçš„ç»“æœåˆ—è¡¨ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ å–å›é˜¶æ®µï¼Œåè°ƒèŠ‚ç‚¹è¾¨åˆ«å‡ºå“ªäº›æ–‡æ¡£éœ€è¦è¢«å–å›å¹¶å‘ç›¸å…³çš„åˆ†ç‰‡æäº¤å¤šä¸ª GET è¯·æ±‚ã€‚æ¯ä¸ªåˆ†ç‰‡åŠ è½½å¹¶ ä¸°å¯Œ æ–‡æ¡£ï¼Œå¦‚æœæœ‰éœ€è¦çš„è¯ï¼Œæ¥ç€è¿”å›æ–‡æ¡£ç»™åè°ƒèŠ‚ç‚¹ã€‚ä¸€æ—¦æ‰€æœ‰çš„æ–‡æ¡£éƒ½è¢«å–å›äº†ï¼Œåè°ƒèŠ‚ç‚¹è¿”å›ç»“æœç»™å®¢æˆ·ç«¯ã€‚</p>
<p>è¡¥å……ï¼šQuery Then Fetchçš„æœç´¢ç±»å‹åœ¨æ–‡æ¡£ç›¸å…³æ€§æ‰“åˆ†çš„æ—¶å€™å‚è€ƒçš„æ˜¯æœ¬åˆ†ç‰‡çš„æ•°æ®ï¼Œè¿™æ ·åœ¨æ–‡æ¡£æ•°é‡è¾ƒå°‘çš„æ—¶å€™å¯èƒ½ä¸å¤Ÿå‡†ç¡®ï¼ŒDFS Query Then Fetchå¢åŠ äº†ä¸€ä¸ªé¢„æŸ¥è¯¢çš„å¤„ç†ï¼Œè¯¢é—®Termå’ŒDocument frequencyï¼Œè¿™ä¸ªè¯„åˆ†æ›´å‡†ç¡®ï¼Œä½†æ˜¯æ€§èƒ½ä¼šå˜å·®ã€‚</p>
<h2 data-id="heading-6">9.Elasticsearchå¯¹äºå¤§æ•°æ®é‡ï¼ˆä¸Šäº¿é‡çº§ï¼‰çš„èšåˆå¦‚ä½•å®ç°ï¼Ÿ</h2>
<p>Elasticsearch æä¾›çš„é¦–ä¸ªè¿‘ä¼¼èšåˆæ˜¯cardinality åº¦é‡ã€‚å®ƒæä¾›ä¸€ä¸ªå­—æ®µçš„åŸºæ•°ï¼Œå³è¯¥å­—æ®µçš„distinctæˆ–è€…uniqueå€¼çš„æ•°ç›®ã€‚å®ƒæ˜¯åŸºäºHLLç®—æ³•çš„ã€‚HLL ä¼šå…ˆå¯¹æˆ‘ä»¬çš„è¾“å…¥ä½œå“ˆå¸Œè¿ç®—ï¼Œç„¶åæ ¹æ®å“ˆå¸Œè¿ç®—çš„ç»“æœä¸­çš„ bits åšæ¦‚ç‡ä¼°ç®—ä»è€Œå¾—åˆ°åŸºæ•°ã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼šå¯é…ç½®çš„ç²¾åº¦ï¼Œç”¨æ¥æ§åˆ¶å†…å­˜çš„ä½¿ç”¨ï¼ˆæ›´ç²¾ç¡® ï¼ æ›´å¤šå†…å­˜ï¼‰ï¼›å°çš„æ•°æ®é›†ç²¾åº¦æ˜¯éå¸¸é«˜çš„ï¼›æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®å‚æ•°ï¼Œæ¥è®¾ç½®å»é‡éœ€è¦çš„å›ºå®šå†…å­˜ä½¿ç”¨é‡ã€‚æ— è®ºæ•°åƒè¿˜æ˜¯æ•°åäº¿çš„å”¯ä¸€å€¼ï¼Œå†…å­˜ä½¿ç”¨é‡åªä¸ä½ é…ç½®çš„ç²¾ç¡®åº¦ç›¸å…³ .</p>
<h2 data-id="heading-7">10.åœ¨å¹¶å‘æƒ…å†µä¸‹ï¼ŒElasticsearchå¦‚æœä¿è¯è¯»å†™ä¸€è‡´ï¼Ÿ<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/332bcad73e8b41618abe8b6a18ccd6fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337449&amp;x-signature=GSfgT3AOL0620wUmeesDWXTCDdw%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h2>
<p>å¯ä»¥é€šè¿‡ç‰ˆæœ¬å·ä½¿ç”¨ä¹è§‚å¹¶å‘æ§åˆ¶ï¼Œä»¥ç¡®ä¿æ–°ç‰ˆæœ¬ä¸ä¼šè¢«æ—§ç‰ˆæœ¬è¦†ç›–ï¼Œç”±åº”ç”¨å±‚æ¥å¤„ç†å…·ä½“çš„å†²çªï¼›</p>
<p>å¦å¤–å¯¹äºå†™æ“ä½œï¼Œä¸€è‡´æ€§çº§åˆ«æ”¯æŒquorum/one/allï¼Œé»˜è®¤ä¸ºquorumï¼Œå³åªæœ‰å½“å¤§å¤šæ•°åˆ†ç‰‡å¯ç”¨æ—¶æ‰å…è®¸å†™æ“ä½œã€‚ä½†å³ä½¿å¤§å¤šæ•°å¯ç”¨ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å› ä¸ºç½‘ç»œç­‰åŸå› å¯¼è‡´å†™å…¥å‰¯æœ¬å¤±è´¥ï¼Œè¿™æ ·è¯¥å‰¯æœ¬è¢«è®¤ä¸ºæ•…éšœï¼Œåˆ†ç‰‡å°†ä¼šåœ¨ä¸€ä¸ªä¸åŒçš„èŠ‚ç‚¹ä¸Šé‡å»ºã€‚</p>
<p>å¯¹äºè¯»æ“ä½œï¼Œå¯ä»¥è®¾ç½®replicationä¸ºsync(é»˜è®¤)ï¼Œè¿™ä½¿å¾—æ“ä½œåœ¨ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡éƒ½å®Œæˆåæ‰ä¼šè¿”å›ï¼›å¦‚æœè®¾ç½®replicationä¸ºasyncæ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®æœç´¢è¯·æ±‚å‚æ•°_preferenceä¸ºprimaryæ¥æŸ¥è¯¢ä¸»åˆ†ç‰‡ï¼Œç¡®ä¿æ–‡æ¡£æ˜¯æœ€æ–°ç‰ˆæœ¬ã€‚</p>
<h2 data-id="heading-8">14.ElasticSearchä¸­çš„é›†ç¾¤ã€èŠ‚ç‚¹ã€ç´¢å¼•ã€æ–‡æ¡£ã€ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>ç¾¤é›†æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ï¼ˆæœåŠ¡å™¨ï¼‰çš„é›†åˆï¼Œå®ƒä»¬å…±åŒä¿å­˜æ‚¨çš„æ•´ä¸ªæ•°æ®ï¼Œå¹¶æä¾›è·¨æ‰€æœ‰èŠ‚ç‚¹çš„è”åˆç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚ç¾¤é›†ç”±å”¯ä¸€åç§°æ ‡è¯†ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ºâ€œelasticsearchâ€ã€‚æ­¤åç§°å¾ˆé‡è¦ï¼Œå› ä¸ºå¦‚æœèŠ‚ç‚¹è®¾ç½®ä¸ºæŒ‰åç§°åŠ å…¥ç¾¤é›†ï¼Œåˆ™è¯¥èŠ‚ç‚¹åªèƒ½æ˜¯ç¾¤é›†çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>èŠ‚ç‚¹æ˜¯å±äºé›†ç¾¤ä¸€éƒ¨åˆ†çš„å•ä¸ªæœåŠ¡å™¨ã€‚å®ƒå­˜å‚¨æ•°æ®å¹¶å‚ä¸ç¾¤é›†ç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚</p>
<p>ç´¢å¼•å°±åƒå…³ç³»æ•°æ®åº“ä¸­çš„â€œæ•°æ®åº“â€ã€‚å®ƒæœ‰ä¸€ä¸ªå®šä¹‰å¤šç§ç±»å‹çš„æ˜ å°„ã€‚ç´¢å¼•æ˜¯é€»è¾‘åç§°ç©ºé—´ï¼Œæ˜ å°„åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªä¸»åˆ†ç‰‡ï¼Œå¹¶ä¸”å¯ä»¥æœ‰é›¶ä¸ªæˆ–å¤šä¸ªå‰¯æœ¬åˆ†ç‰‡ã€‚ MySQL =&gt;æ•°æ®åº“ ElasticSearch =&gt;ç´¢å¼•</p>
<p>æ–‡æ¡£ç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­çš„ä¸€è¡Œã€‚ä¸åŒä¹‹å¤„åœ¨äºç´¢å¼•ä¸­çš„æ¯ä¸ªæ–‡æ¡£å¯ä»¥å…·æœ‰ä¸åŒçš„ç»“æ„ï¼ˆå­—æ®µï¼‰ï¼Œä½†æ˜¯å¯¹äºé€šç”¨å­—æ®µåº”è¯¥å…·æœ‰ç›¸åŒçš„æ•°æ®ç±»å‹ã€‚ MySQL =&gt; Databases =&gt; Tables =&gt; Columns / Rows ElasticSearch =&gt; Indices =&gt; Types =&gt;å…·æœ‰å±æ€§çš„æ–‡æ¡£</p>
<p>ç±»å‹æ˜¯ç´¢å¼•çš„é€»è¾‘ç±»åˆ«/åˆ†åŒºï¼Œå…¶è¯­ä¹‰å®Œå…¨å–å†³äºç”¨æˆ·ã€‚</p>
<h2 data-id="heading-9">Elasticsearch ä¸­çš„å€’æ’ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>å€’æ’ç´¢å¼•æ˜¯æœç´¢å¼•æ“çš„æ ¸å¿ƒã€‚æœç´¢å¼•æ“çš„ä¸»è¦ç›®æ ‡æ˜¯åœ¨æŸ¥æ‰¾å‘ç”Ÿæœç´¢æ¡ä»¶çš„æ–‡æ¡£æ—¶æä¾›å¿«é€Ÿæœç´¢ã€‚ESä¸­çš„å€’æ’ç´¢å¼•å…¶å®å°±æ˜¯ lucene çš„å€’æ’ç´¢å¼•ï¼ŒåŒºåˆ«äºä¼ ç»Ÿçš„æ­£å‘ç´¢å¼•ï¼Œ å€’æ’ç´¢å¼•ä¼šå†å­˜å‚¨æ•°æ®æ—¶å°†å…³é”®è¯å’Œæ•°æ®è¿›è¡Œå…³è”ï¼Œä¿å­˜åˆ°å€’æ’è¡¨ä¸­ï¼Œç„¶åæŸ¥è¯¢æ—¶ï¼Œå°†æŸ¥è¯¢å†…å®¹è¿›è¡Œåˆ†è¯ååœ¨å€’æ’è¡¨ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œæœ€ååŒ¹é…æ•°æ®å³å¯ã€‚</p>
<h2 data-id="heading-10">15.ElasticSearchä¸­çš„åˆ†ç‰‡æ˜¯ä»€ä¹ˆ?</h2>
<p>åœ¨å¤§å¤šæ•°ç¯å¢ƒä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åœ¨å•ç‹¬çš„ç›’å­æˆ–è™šæ‹Ÿæœºä¸Šè¿è¡Œã€‚</p>
<p>ç´¢å¼• - åœ¨Elasticsearchä¸­ï¼Œç´¢å¼•æ˜¯æ–‡æ¡£çš„é›†åˆã€‚</p>
<p>åˆ†ç‰‡ -å› ä¸ºElasticsearchæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œæ‰€ä»¥ç´¢å¼•é€šå¸¸è¢«åˆ†å‰²æˆåˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šçš„è¢«ç§°ä¸ºåˆ†ç‰‡çš„å…ƒç´ ã€‚</p>
<h2 data-id="heading-11">Elasticsearch é›†ç¾¤è„‘è£‚é—®é¢˜ï¼Ÿ</h2>
<p>â€œè„‘è£‚â€é—®é¢˜å¯èƒ½çš„æˆå› ï¼š</p>
<p>ç½‘ç»œé—®é¢˜ï¼šé›†ç¾¤é—´çš„ç½‘ç»œå»¶è¿Ÿå¯¼è‡´ä¸€äº›èŠ‚ç‚¹è®¿é—®ä¸åˆ°master, è®¤ä¸ºmaster æŒ‚æ‰äº†ä»è€Œé€‰ä¸¾å‡ºæ–°çš„master,å¹¶å¯¹masterä¸Šçš„åˆ†ç‰‡å’Œå‰¯æœ¬æ ‡çº¢ï¼Œåˆ†é…æ–°çš„ä¸»åˆ†ç‰‡ã€‚</p>
<p>èŠ‚ç‚¹è´Ÿè½½ï¼šä¸»èŠ‚ç‚¹çš„è§’è‰²æ—¢ä¸ºmasteråˆä¸ºdata,è®¿é—®é‡è¾ƒå¤§æ—¶å¯èƒ½ä¼šå¯¼è‡´ESåœæ­¢å“åº”é€ æˆå¤§é¢ç§¯å»¶è¿Ÿï¼Œæ­¤æ—¶å…¶ä»–èŠ‚ç‚¹å¾—ä¸åˆ°ä¸»èŠ‚ç‚¹çš„å“åº”è®¤ä¸ºä¸»èŠ‚ç‚¹æŒ‚æ‰äº†ï¼Œä¼šé‡æ–°é€‰å–ä¸»èŠ‚ç‚¹ã€‚</p>
<p>å†…å­˜å›æ”¶ï¼šdata èŠ‚ç‚¹ä¸Šçš„ESè¿›ç¨‹å ç”¨çš„å†…å­˜è¾ƒå¤§ï¼Œå¼•å‘JVMçš„å¤§è§„æ¨¡å†…å­˜å›æ”¶ï¼Œé€ æˆESè¿›ç¨‹å¤±å»å“åº”ã€‚</p>
<p>è„‘è£‚é—®é¢˜è§£å†³æ–¹æ¡ˆï¼š</p>
<p>å‡å°‘è¯¯åˆ¤ï¼šdiscovery.zen ping_ timeout èŠ‚ç‚¹çŠ¶æ€çš„å“åº”æ—¶é—´ï¼Œé»˜è®¤ä¸º3sï¼Œå¯ä»¥é€‚å½“è°ƒå¤§ï¼Œå¦‚æœmasteråœ¨è¯¥å“åº”æ—¶é—´çš„èŒƒå›´å†…æ²¡æœ‰åšå‡ºå“åº”åº”ç­”ï¼Œåˆ¤æ–­è¯¥èŠ‚ç‚¹å·²ç»æŒ‚æ‰äº†ã€‚è°ƒå¤§å‚æ•°ï¼ˆå¦‚6sï¼Œdiscovery.zen.ping_timeout:6ï¼‰ï¼Œå¯é€‚å½“å‡å°‘è¯¯åˆ¤ã€‚</p>
<p>é€‰ä¸¾è§¦å‘ï¼šdiscovery.zen.minimum. <em>master</em> nodes:1ï¼Œè¯¥å‚æ•¸æ˜¯ç”¨äºæ§åˆ¶é€‰ä¸¾è¡Œä¸ºå‘ç”Ÿçš„æœ€å°é›†ç¾¤ä¸»èŠ‚ç‚¹æ•°é‡ã€‚å½“å¤‡é€‰ä¸»èŠ‚ç‚¹çš„ä¸ªæ•¸å¤§äºç­‰äºè¯¥å‚æ•°çš„å€¼ï¼Œä¸”å¤‡é€‰ä¸»èŠ‚ç‚¹ä¸­æœ‰è¯¥å‚æ•°ä¸ªèŠ‚ç‚¹è®¤ä¸ºä¸»èŠ‚ç‚¹æŒ‚äº†ï¼Œè¿›è¡Œé€‰ä¸¾ã€‚å®˜æ–¹å»ºè®®ä¸º(n / 2) +1, nä¸ºä¸»èŠ‚ç‚¹ä¸ªæ•°ï¼ˆå³æœ‰èµ„æ ¼æˆä¸ºä¸»èŠ‚ç‚¹çš„èŠ‚ç‚¹ä¸ªæ•°ï¼‰ã€‚</p>
<p>è§’è‰²åˆ†ç¦»ï¼šå³masterèŠ‚ç‚¹ä¸dataèŠ‚ç‚¹åˆ†ç¦»ï¼Œé™åˆ¶è§’è‰²</p>
<p>ä¸»èŠ‚ç‚¹é…ç½®ä¸ºï¼šnode master: trueï¼Œnode data: false</p>
<p>ä»èŠ‚ç‚¹é…ç½®ä¸ºï¼šnode master: falseï¼Œnode data: true</p>
<h2 data-id="heading-12">Elasticsearch åœ¨éƒ¨ç½²æ—¶ï¼Œå¯¹ Linux çš„è®¾ç½®æœ‰å“ªäº›ä¼˜åŒ–æ–¹æ³•ï¼Ÿ</h2>
<p>64 GB å†…å­˜çš„æœºå™¨æ˜¯éå¸¸ç†æƒ³çš„ï¼Œ ä½†æ˜¯ 32 GB å’Œ 16 GB æœºå™¨ä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ã€‚å°‘äº 8 GB ä¼šé€‚å¾—å…¶åã€‚</p>
<p>å¦‚æœä½ è¦åœ¨æ›´å¿«çš„ CPUs å’Œæ›´å¤šçš„æ ¸å¿ƒä¹‹é—´é€‰æ‹©ï¼Œé€‰æ‹©æ›´å¤šçš„æ ¸å¿ƒæ›´å¥½ã€‚å¤šä¸ªå†…æ ¸æä¾›çš„é¢å¤–å¹¶å‘è¿œèƒœè¿‡ç¨å¾®å¿«ä¸€ç‚¹ç‚¹çš„æ—¶é’Ÿé¢‘ç‡ã€‚</p>
<p>å¦‚æœä½ è´Ÿæ‹…å¾—èµ· SSDï¼Œå®ƒå°†è¿œè¿œè¶…å‡ºä»»ä½•æ—‹è½¬ä»‹è´¨ã€‚ åŸºäº SSD çš„èŠ‚ç‚¹ï¼ŒæŸ¥è¯¢å’Œç´¢å¼•æ€§èƒ½éƒ½æœ‰æå‡ã€‚å¦‚æœä½ è´Ÿæ‹…å¾—èµ·ï¼Œ SSD æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚</p>
<p>å³ä½¿æ•°æ®ä¸­å¿ƒä»¬è¿‘åœ¨å’«å°ºï¼Œä¹Ÿè¦é¿å…é›†ç¾¤è·¨è¶Šå¤šä¸ªæ•°æ®ä¸­å¿ƒã€‚ç»å¯¹è¦é¿å…é›†ç¾¤è·¨è¶Šå¤§çš„åœ°ç†è·ç¦»ã€‚</p>
<p>è¯·ç¡®ä¿è¿è¡Œä½ åº”ç”¨ç¨‹åºçš„ JVM å’ŒæœåŠ¡å™¨çš„ JVM æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ åœ¨ Elasticsearch çš„å‡ ä¸ªåœ°æ–¹ï¼Œä½¿ç”¨ Java çš„æœ¬åœ°åºåˆ—åŒ–ã€‚</p>
<p>é€šè¿‡è®¾ç½® gateway.recover_after_nodesã€ gateway.expected_nodesã€ gateway.recover_after_time å¯ä»¥åœ¨é›†ç¾¤é‡å¯çš„æ—¶å€™é¿å…è¿‡å¤šçš„åˆ†ç‰‡äº¤æ¢ï¼Œè¿™å¯èƒ½ä¼šè®©æ•°æ®æ¢å¤ä»æ•°ä¸ªå°æ—¶ç¼©çŸ­ä¸ºå‡ ç§’é’Ÿã€‚</p>
<p>Elasticsearch é»˜è®¤è¢«é…ç½®ä¸ºä½¿ç”¨å•æ’­å‘ç°ï¼Œä»¥é˜²æ­¢èŠ‚ç‚¹æ— æ„ä¸­åŠ å…¥é›†ç¾¤ã€‚åªæœ‰åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œçš„èŠ‚ç‚¹æ‰ä¼šè‡ªåŠ¨ç»„æˆé›†ç¾¤ã€‚æœ€å¥½ä½¿ç”¨å•æ’­ä»£æ›¿ç»„æ’­ã€‚</p>
<p>ä¸è¦éšæ„ä¿®æ”¹åƒåœ¾å›æ”¶å™¨ï¼ˆCMSï¼‰å’Œå„ä¸ªçº¿ç¨‹æ± çš„å¤§å°ã€‚</p>
<p>æŠŠä½ çš„å†…å­˜çš„ï¼ˆå°‘äºï¼‰ä¸€åŠç»™ Luceneï¼ˆä½†ä¸è¦è¶…è¿‡ 32 GBï¼ï¼‰ï¼Œé€šè¿‡ ES_HEAP_SIZE ç¯å¢ƒå˜é‡è®¾ç½®ã€‚</p>
<p>å†…å­˜äº¤æ¢åˆ°ç£ç›˜å¯¹æœåŠ¡å™¨æ€§èƒ½æ¥è¯´æ˜¯è‡´å‘½çš„ã€‚å¦‚æœå†…å­˜äº¤æ¢åˆ°ç£ç›˜ä¸Šï¼Œä¸€ä¸ª 100 å¾®ç§’çš„æ“ä½œå¯èƒ½å˜æˆ 10 æ¯«ç§’ã€‚ å†æƒ³æƒ³é‚£ä¹ˆå¤š 10 å¾®ç§’çš„æ“ä½œæ—¶å»¶ç´¯åŠ èµ·æ¥ã€‚ ä¸éš¾çœ‹å‡º swapping å¯¹äºæ€§èƒ½æ˜¯å¤šä¹ˆå¯æ€•ã€‚</p>
<p>Lucene ä½¿ç”¨äº†å¤§é‡çš„æ–‡ä»¶ã€‚åŒæ—¶ï¼Œ Elasticsearch åœ¨èŠ‚ç‚¹å’Œ HTTP å®¢æˆ·ç«¯ä¹‹é—´è¿›è¡Œé€šä¿¡ä¹Ÿä½¿ç”¨äº†å¤§é‡çš„å¥—æ¥å­—ã€‚ æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½éœ€è¦è¶³å¤Ÿçš„æ–‡ä»¶æè¿°ç¬¦ã€‚ä½ åº”è¯¥å¢åŠ ä½ çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè®¾ç½®ä¸€ä¸ªå¾ˆå¤§çš„å€¼ï¼Œå¦‚ 64,000ã€‚</p>
<h2 data-id="heading-13">GC æ–¹é¢ï¼Œåœ¨ä½¿ç”¨ Elasticsearch æ—¶è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ</h2>
<p>å€’æ’è¯å…¸çš„ç´¢å¼•éœ€è¦å¸¸é©»å†…å­˜ï¼Œæ— æ³• GCï¼Œéœ€è¦ç›‘æ§ data node ä¸Š segment memory å¢é•¿è¶‹åŠ¿ã€‚</p>
<p>å„ç±»ç¼“å­˜ï¼Œ field cache, filter cache, indexing cache, bulk queue ç­‰ç­‰ï¼Œè¦è®¾ç½®åˆç†çš„å¤§å°ï¼Œå¹¶ä¸”è¦åº”è¯¥æ ¹æ®æœ€åçš„æƒ…å†µæ¥çœ‹ heap æ˜¯å¦å¤Ÿç”¨ï¼Œä¹Ÿå°±æ˜¯å„ç±»ç¼“å­˜å…¨éƒ¨å æ»¡çš„æ—¶å€™ï¼Œè¿˜æœ‰ heap ç©ºé—´å¯ä»¥åˆ†é…ç»™å…¶ä»–ä»»åŠ¡å—ï¼Ÿé¿å…é‡‡ç”¨ clear cache ç­‰â€œè‡ªæ¬ºæ¬ºäººâ€çš„æ–¹å¼æ¥é‡Šæ”¾å†…å­˜ã€‚</p>
<p>é¿å…è¿”å›å¤§é‡ç»“æœé›†çš„æœç´¢ä¸èšåˆã€‚ç¡®å®éœ€è¦å¤§é‡æ‹‰å–æ•°æ®çš„åœºæ™¯ï¼Œå¯ä»¥é‡‡ç”¨ scan &amp; scroll api æ¥å®ç°ã€‚</p>
<p>cluster stats é©»ç•™å†…å­˜å¹¶æ— æ³•æ°´å¹³æ‰©å±•ï¼Œè¶…å¤§è§„æ¨¡é›†ç¾¤å¯ä»¥è€ƒè™‘åˆ†æ‹†æˆå¤šä¸ªé›†ç¾¤é€šè¿‡ tribe node è¿æ¥ã€‚</p>
<p>æƒ³çŸ¥é“ heap å¤Ÿä¸å¤Ÿï¼Œå¿…é¡»ç»“åˆå®é™…åº”ç”¨åœºæ™¯ï¼Œå¹¶å¯¹é›†ç¾¤çš„ heap ä½¿ç”¨æƒ…å†µåšæŒç»­çš„ç›‘æ§ã€‚</p>
<h2 data-id="heading-14">å¦‚ä½•ç›‘æ§ Elasticsearch é›†ç¾¤çŠ¶æ€ï¼Ÿ</h2>
<ol>
<li>elasticsearch-head æ’ä»¶ã€‚</li>
<li>é€šè¿‡ Kibana ç›‘æ§ Elasticsearchã€‚ä½ å¯ä»¥å®æ—¶æŸ¥çœ‹ä½ çš„é›†ç¾¤å¥åº·çŠ¶æ€å’Œæ€§èƒ½ï¼Œä¹Ÿå¯ä»¥åˆ†æè¿‡å»çš„é›†ç¾¤ã€ç´¢å¼•å’ŒèŠ‚ç‚¹æŒ‡æ ‡</li>
</ol>
<h2 data-id="heading-15">æ˜¯å¦äº†è§£å­—å…¸æ ‘ï¼Ÿ</h2>
<p>å­—å…¸æ ‘åˆç§°å•è¯æŸ¥æ‰¾æ ‘ï¼Œ Trie æ ‘ï¼Œæ˜¯ä¸€ç§æ ‘å½¢ç»“æ„ï¼Œæ˜¯ä¸€ç§å“ˆå¸Œæ ‘çš„å˜ç§ã€‚å…¸å‹åº”ç”¨æ˜¯ç”¨äºç»Ÿè®¡ï¼Œæ’åºå’Œä¿å­˜å¤§é‡çš„å­—ç¬¦ä¸²ï¼ˆä½†ä¸ä»…é™äºå­—ç¬¦ä¸²ï¼‰ï¼Œæ‰€ä»¥ç»å¸¸è¢«æœç´¢å¼•æ“ç³»ç»Ÿç”¨äºæ–‡æœ¬è¯é¢‘ç»Ÿè®¡ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ï¼šåˆ©ç”¨å­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€æ¥å‡å°‘æŸ¥è¯¢æ—¶é—´ï¼Œæœ€å¤§é™åº¦åœ°å‡å°‘æ— è°“çš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”å“ˆå¸Œæ ‘é«˜ã€‚</p>
<p>Trie çš„æ ¸å¿ƒæ€æƒ³æ˜¯ç©ºé—´æ¢æ—¶é—´ï¼Œåˆ©ç”¨å­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€æ¥é™ä½æŸ¥è¯¢æ—¶é—´çš„å¼€é”€ä»¥è¾¾åˆ°æé«˜æ•ˆç‡çš„ç›®çš„ã€‚å®ƒæœ‰ 3 ä¸ªåŸºæœ¬æ€§è´¨ï¼š</p>
<p>æ ¹èŠ‚ç‚¹ä¸åŒ…å«å­—ç¬¦ï¼Œé™¤æ ¹èŠ‚ç‚¹å¤–æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½åªåŒ…å«ä¸€ä¸ªå­—ç¬¦ã€‚</p>
<p>ä»æ ¹èŠ‚ç‚¹åˆ°æŸä¸€èŠ‚ç‚¹ï¼Œè·¯å¾„ä¸Šç»è¿‡çš„å­—ç¬¦è¿æ¥èµ·æ¥ï¼Œä¸ºè¯¥èŠ‚ç‚¹å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚</p>
<p>æ¯ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹åŒ…å«çš„å­—ç¬¦éƒ½ä¸ç›¸åŒã€‚</p>
<p>å¯¹äºä¸­æ–‡çš„å­—å…¸æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨å­˜å‚¨ï¼Œè¿™æ ·å°±ä¸ç”¨æµªè´¹å¤ªå¤§çš„ç©ºé—´ï¼Œè€Œä¸”æŸ¥è¯¢é€Ÿåº¦ä¸Šå¯ä»¥ä¿ç•™å“ˆå¸Œçš„å¤æ‚åº¦ O(1)ã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ©ç”¨ link rel="prefetch"ï¼šå¦‚ä½•è®©ç”¨æˆ·çš„é¡µé¢ç§’å¼€ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7579175271680311306</link>    <guid>https://juejin.cn/post/7579175271680311306</guid>    <pubDate>2025-12-03T03:35:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579175271680311306" data-draft-id="7579176524130730035" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ©ç”¨ link rel=&quot;prefetch&quot;ï¼šå¦‚ä½•è®©ç”¨æˆ·çš„é¡µé¢ç§’å¼€ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-03T03:35:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ErpanOmer"/> <meta itemprop="url" content="https://juejin.cn/user/3878732754331096"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ©ç”¨ link rel="prefetch"ï¼šå¦‚ä½•è®©ç”¨æˆ·çš„é¡µé¢ç§’å¼€ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3878732754331096/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ErpanOmer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:35:22.000Z" title="Wed Dec 03 2025 03:35:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c19b22f3579e40d4855176302bdf9bff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337721&amp;x-signature=oUn20WTRBW05%2B1yKlSsite1C6%2Fg%3D" alt="image.png" loading="lazy"/></p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘åˆæ¥äº†ğŸ˜ã€‚</p>
<p>æˆ‘ä»¬åšæ€§èƒ½ä¼˜åŒ–ï¼Œé€šå¸¸ç›¯ç€çš„æ˜¯ <strong>é¦–å±åŠ è½½é€Ÿåº¦</strong>ï¼ˆFCP, LCPï¼‰ã€‚æˆ‘ä»¬å‹ç¼©å›¾ç‰‡ã€æ‹†åˆ†ä»£ç ï¼ˆCode Splittingï¼‰ã€ä¸ŠCDN... æ‹¼äº†è€å‘½æŠŠé¦–å±æ—¶é—´ä» 2s å‹åˆ°äº† 1sã€‚</p>
<p>ä½†æ˜¯ï¼Œç”¨æˆ·ç”¨èµ·æ¥è¿˜æ˜¯è§‰å¾—ä¸å¤Ÿå¿«ğŸ¤”ã€‚</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå½“ç”¨æˆ·ç‚¹å‡» <strong>ä¸‹ä¸€é¡µ</strong> æˆ–è€… <strong>æŸ¥çœ‹è¯¦æƒ…</strong> æ—¶ï¼Œé‚£ä¸ªè®¨åŒçš„ <strong>Loadingè½¬åœˆåœˆ</strong>åˆå‡ºç°äº†ã€‚å“ªæ€•åªæœ‰ 300msï¼Œé‚£ä¹Ÿæ˜¯ä¸€ç§<strong>æ‰“æ–­</strong>ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘æƒ³èŠä¸€ä¸ªè¢«å¾ˆå¤šäººä½ä¼°çš„å°æŠ€å·§â€”â€”<strong><code>prefetch</code>ï¼ˆé¢„è·å–ï¼‰</strong> ã€‚</p>
<p>æˆ‘ä¸æ”¹ä¸€è¡Œä¸šåŠ¡ä»£ç ï¼Œä¸é‡æ„æ¶æ„ï¼Œåªç”¨å‡ è¡Œä»£ç ï¼Œå°±è®©ç”¨æˆ·çš„ä¸‹ä¸€ä¸ªé¡µé¢å®ç°äº†<strong>ç§’å¼€</strong>ã€‚</p>
<hr/>
<h4 data-id="heading-0"><strong><code>preload</code> vs <code>prefetch</code></strong></h4>
<p>å¾ˆå¤šåŒå­¦çŸ¥é“<code>preload</code>ï¼Œä½†ç»å¸¸æŠŠå®ƒå’Œ<code>prefetch</code>ææ··ã€‚è¿™ä¿©è™½ç„¶é•¿å¾—åƒï¼Œä½†ä½œç”¨å®Œå…¨ä¸åŒï¼š</p>
<ul>
<li>
<p><strong><code>preload</code> (é¢„åŠ è½½)</strong> ï¼š <strong>æˆ‘ç°åœ¨çš„é¡µé¢é©¬ä¸Šå°±è¦ç”¨ï¼</strong></p>
<ul>
<li><strong>ä¼˜å…ˆçº§</strong>ï¼šHighã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šå½“å‰é¡µé¢çš„å…³é”®å­—ä½“ã€é¦–å±çš„æ ¸å¿ƒCSS/JSã€‚</li>
<li>å¦‚æœä½ ä¸ç”¨ï¼Œå½“å‰é¡µé¢ä¼šæ¸²æŸ“é˜»å¡æˆ–é—ªåŠ¨ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>prefetch</code> (é¢„è·å–)</strong> ï¼š <strong>æˆ‘ç°åœ¨é—²ç€ä¹Ÿæ˜¯é—²ç€ï¼Œå¸®æˆ‘æŠŠä¸‹ä¸€ä¸ªé¡µé¢çš„ä¸œè¥¿å…ˆä¸‹è½½ä¸‹æ¥å‘—ï¼Ÿ</strong></p>
<ul>
<li><strong>ä¼˜å…ˆçº§</strong>ï¼šLow (æµè§ˆå™¨ä¼šåœ¨ç½‘ç»œç©ºé—²ï¼ˆIdleï¼‰æ—¶æ‰å»ä¸‹è½½)ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼š<strong>ä¸‹ä¸€ä¸ªé¡µé¢</strong>å¯èƒ½éœ€è¦çš„ JS Chunkã€CSS æˆ–å›¾ç‰‡ã€‚</li>
<li>å³ä½¿ç”¨æˆ·æ²¡å»ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œä¹Ÿä¸å½±å“å½“å‰é¡µé¢çš„ä½“éªŒï¼Œé¡¶å¤šæµªè´¹ä¸€ç‚¹ç‚¹æµé‡ã€‚</li>
</ul>
</li>
</ul>
<p><strong>æˆ‘ä»¬ç°åœ¨èŠçš„ï¼Œæ ¸å¿ƒå°±æ˜¯åˆ©ç”¨<code>prefetch</code>ï¼Œåˆ©ç”¨ç”¨æˆ·æ€è€ƒã€æ»‘åŠ¨é¼ æ ‡çš„é‚£äº›åƒåœ¾æ—¶é—´ï¼Œå·å·æŠŠä¸‹ä¸€ä¸ªé¡µé¢çš„èµ„æºåŠ è½½å¥½ã€‚</strong></p>
<hr/>
<h4 data-id="heading-1"><strong>è®©è¯¦æƒ…é¡µç¬é—´å‡ºç°</strong></h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<strong>å•†å“åˆ—è¡¨é¡µ</strong>ï¼Œç”¨æˆ·å¾ˆæœ‰å¯èƒ½ä¼šç‚¹å‡»ç¬¬ä¸€ä¸ªå•†å“è¿›å…¥<strong>è¯¦æƒ…é¡µ</strong>ã€‚</p>
<p>åœ¨ React/Vue çš„å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ä¸­ï¼Œè¿›å…¥è¯¦æƒ…é¡µé€šå¸¸æ„å‘³ç€è¦åŠ è½½ä¸€ä¸ª<code>Detail.chunk.js</code>ã€‚å¦‚æœç­‰ç”¨æˆ·ç‚¹å‡»äº†å†åŠ è½½ï¼Œé‚£å¿…ç„¶æœ‰å‡ ç™¾æ¯«ç§’çš„ç™½å±ã€‚</p>
<p><strong>æˆ‘çš„åšæ³•æ˜¯è¿™æ ·çš„ï¼š</strong></p>
<p>å½“æ£€æµ‹åˆ°ç”¨æˆ·çš„<strong>é¼ æ ‡ç§»åŠ¨åˆ°</strong>æŸä¸ªå•†å“å¡ç‰‡ä¸Šï¼ˆæˆ–è€…<strong>æ»šåŠ¨åˆ°</strong>å¯è§†åŒºåŸŸæ—¶ï¼‰ï¼Œæˆ‘å°±çŒœï¼šå˜¿ï¼Œè¿™å“¥ä»¬å¯èƒ½è¦ç‚¹è¿›å»äº†ğŸ¤£ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ç«‹åˆ»åœ¨<code>&lt;head&gt;</code>é‡ŒåŠ¨æ€æ’å…¥ä¸€ä¸ª<code>prefetch</code>æ ‡ç­¾ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// é¢„è·å–ä¸‹ä¸€ä¸ªé¡µé¢çš„ JS èµ„æº</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">prefetcher</span> = (<span class="hljs-params">url</span>) =&gt; {
  <span class="hljs-keyword">const</span> link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'link'</span>);
  link.<span class="hljs-property">rel</span> = <span class="hljs-string">'prefetch'</span>;
  link.<span class="hljs-property">href</span> = url;
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(link);
};

<span class="hljs-comment">// æ¨¡æ‹Ÿï¼šé¼ æ ‡ç§»å…¥å•†å“å¡ç‰‡æ—¶è§¦å‘</span>
<span class="hljs-comment">// åœ¨ Webpack/Vite é¡¹ç›®ä¸­ï¼Œä½ é€šå¸¸èƒ½é€šè¿‡ manifest æ‰¾åˆ°å¯¹åº”è·¯ç”±çš„ chunk åœ°å€</span>
card.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseenter'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">prefetcher</span>(<span class="hljs-string">'/assets/ProductDetail.23a9c.js'</span>);
  <span class="hljs-title function_">prefetcher</span>(<span class="hljs-string">'/assets/ProductDetail.css'</span>);
});
</code></pre>
<p><strong>å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p>
<ol>
<li>ç”¨æˆ·é¼ æ ‡æ‚¬åœï¼ˆhoverï¼‰éœ€è¦ 200ms~500ms æ‰ä¼šç‚¹å‡»ã€‚</li>
<li>æµè§ˆå™¨åˆ©ç”¨è¿™å‡ ç™¾æ¯«ç§’çš„ç©ºé—²ï¼Œ<strong>å·²ç»åœ¨åå°æŠŠ<code>ProductDetail.js</code>ä¸‹è½½å¥½äº†</strong>ï¼Œå¹¶æ”¾è¿›äº†<strong>HTTP ç¼“å­˜ï¼ˆDisk Cacheï¼‰</strong> ã€‚</li>
<li>å½“ç”¨æˆ·çœŸçš„ç‚¹å‡»æ—¶ï¼Œè·¯ç”±è·³è½¬ï¼Œè¯·æ±‚èµ„æº -&gt; <strong>æµè§ˆå™¨å‘ç°ç¼“å­˜é‡Œæœ‰ -&gt; ç›´æ¥ä»ç£ç›˜è¯»å– -&gt; è€—æ—¶ 0msï¼</strong></li>
</ol>
<p>ç”¨æˆ·æ„Ÿè§‰å°±æ˜¯ï¼š<strong>æ‰‹æŒ‡åˆšè½ä¸‹ï¼Œé¡µé¢å°±ç °åœ°ä¸€ä¸‹å‡ºæ¥äº†ã€‚</strong> è¿™ç§çˆ½å¿«æ„Ÿï¼Œæ˜¯ä»»ä½•ä»£ç å‹ç¼©éƒ½ç»™ä¸äº†çš„ã€‚</p>
<hr/>
<h4 data-id="heading-2"><strong>è‡ªåŠ¨åŒ– <code>quicklink</code></strong></h4>
<p>æ‰‹åŠ¨å†™<code>mouseenter</code>å¤ªç´¯äº†ï¼Œè€Œä¸”æˆ‘æ€ä¹ˆçŸ¥é“æ‰“åŒ…åçš„æ–‡ä»¶åå«å•¥ï¼Ÿ</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2520d17a79e843e2b2a7c5090cf1a5ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337721&amp;x-signature=2s%2FPZM3218Bh4BI09gsO4lzn3AI%3D" alt="image.png" loading="lazy"/></p>
<p>Google Chrome å›¢é˜Ÿæ—©å°±æƒ³åˆ°äº†ï¼Œä»–ä»¬å¼€æºäº†ä¸€ä¸ªç¥å™¨å« <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FGoogleChromeLabs%2Fquicklink" target="_blank" title="https://github.com/GoogleChromeLabs/quicklink" ref="nofollow noopener noreferrer"><strong><code>quicklink</code></strong></a>ã€‚</p>
<p>å®ƒçš„åŸç†æå…¶ç®€å•ä¸”æš´åŠ›ï¼š</p>
<p>æ£€æµ‹è§†å£ï¼ˆViewportï¼‰å†…çš„é“¾æ¥ï¼Œè‡ªåŠ¨ç»™å®ƒä»¬åŠ ä¸Šprefetchã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// 1. å®‰è£…</span>
<span class="hljs-comment">// npm install quicklink</span>

<span class="hljs-comment">// 2. åœ¨ä½ çš„é¡µé¢åŠ è½½å®Œæˆåè°ƒç”¨</span>
<span class="hljs-keyword">import</span> { listen } <span class="hljs-keyword">from</span> <span class="hljs-string">'quicklink'</span>;

<span class="hljs-title function_">listen</span>({
  <span class="hljs-comment">// é€‰é¡¹ï¼šåªåœ¨ç½‘ç»œç¯å¢ƒå¥½çš„æ—¶å€™é¢„å– (é»˜è®¤å°±æ˜¯è¿™æ ·)</span>
  <span class="hljs-comment">// é€‰é¡¹ï¼šé™åˆ¶é¢„å–çš„æ•°é‡ï¼Œé˜²æ­¢æµªè´¹æµé‡</span>
  <span class="hljs-attr">limit</span>: <span class="hljs-number">5</span> 
});
</code></pre>
<p>åªè¦è¿™ä¸€è¡Œä»£ç ï¼</p>
<p>å½“ç”¨æˆ·æ»šåŠ¨åˆ—è¡¨æ—¶ï¼Œè¿›å…¥è§†å£çš„é‚£äº›å•†å“é“¾æ¥å¯¹åº”çš„ JS/CSS èµ„æºï¼Œå°±ä¼šè¢«è‡ªåŠ¨é™é»˜ä¸‹è½½ã€‚ç”¨æˆ·ç‚¹å“ªä¸ªï¼Œå“ªä¸ªå°±æ˜¯ç§’å¼€ã€‚</p>
<p><strong>Next.js çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fpages%2Fapi-reference%2Fcomponents%2Flink" target="_blank" title="https://nextjs.org/docs/pages/api-reference/components/link" ref="nofollow noopener noreferrer"><code>&lt;Link&gt;</code></a> ç»„ä»¶ï¼Œé»˜è®¤å°±å†…ç½®äº†ç±»ä¼¼çš„åŠŸèƒ½ã€‚</strong> è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Next.js åº”ç”¨é€šå¸¸æ„Ÿè§‰æ¯”æ™®é€š React åº”ç”¨å¿«çš„åŸå› ä¹‹ä¸€ã€‚</p>
<hr/>
<h4 data-id="heading-3"><strong>ä½† <code>prefetch</code> ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„</strong></h4>
<p>è™½ç„¶å®ƒå¾ˆçˆ½ï¼Œä½†ä½œä¸ºä¸€ä¸ªè´Ÿè´£ä»»çš„å·¥ç¨‹å¸ˆï¼Œæˆ‘å¿…é¡»å‘Šè¯‰ä½ å‡ ä¸ªå‘ğŸ˜–ï¼š</p>
<ol>
<li>å¿…é¡»é…åˆæ­£ç¡®çš„ç¼“å­˜ç­–ç•¥ (Cache-Control)</li>
</ol>
<p>prefetch ä¸‹è½½çš„èµ„æºæ˜¯æ”¾åœ¨ HTTP ç¼“å­˜é‡Œçš„ã€‚å¦‚æœä½ çš„æœåŠ¡å™¨è®¾ç½®äº†Cache-Control: no-storeï¼Œé‚£ç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œæµè§ˆå™¨è¿˜æ˜¯ä¼šé‡æ–°å‘è¯·æ±‚ï¼Œä½ çš„é¢„è·å–å°±ç™½åšäº†ã€‚ç¡®ä¿ä½ çš„é™æ€èµ„æºæœ‰é•¿ç¼“å­˜ï¼ˆMax-Ageï¼‰ç­–ç•¥ã€‚</p>
<ol start="2">
<li>åˆ«é¢„å– API æ¥å£ (æ…ç”¨ğŸ˜­)</li>
</ol>
<p>æœ‰äº›äººæƒ³è¿ API æ•°æ®ä¹Ÿé¢„å–ã€‚è¿™å¾ˆå±é™©ã€‚å› ä¸ºæ•°æ®çš„æ—¶æ•ˆæ€§å¾ˆéš¾ä¿è¯ã€‚ä½ é¢„å–äº†åº“å­˜ä¸º1ï¼Œç”¨æˆ·ç‚¹è¿›å»æ—¶å¯èƒ½å·²ç»å–å…‰äº†ã€‚é™¤éæ˜¯é™æ€åšå®¢ç±»çš„å†…å®¹ï¼Œå¦åˆ™åªå»ºè®®é¢„å– JS/CSS/å›¾ç‰‡ ç­‰é™æ€èµ„æºã€‚</p>
<ol start="3">
<li>ç§»åŠ¨ç«¯çœæµæ¨¡å¼</li>
</ol>
<p>åœ¨ç§»åŠ¨ç«¯ï¼Œæµé‡å°±æ˜¯é’±ã€‚æµè§ˆå™¨é€šå¸¸æ¯”è¾ƒæ™ºèƒ½ï¼Œåœ¨çœæµæ¨¡å¼æˆ–å¼±ç½‘ä¸‹ï¼Œä¼šå¿½ç•¥prefetchæŒ‡ä»¤ã€‚æˆ‘ä»¬åœ¨åšæ‰‹åŠ¨å®ç°æ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ navigator.connection.saveData æ¥åˆ¤æ–­ï¼Œå¦‚æœæ˜¯çœæµæ¨¡å¼ï¼Œå°±åˆ«é¢„å–äº†ï¼Œåšä¸ªå¥½äººğŸ˜‚ã€‚</p>
<hr/>
<p>æ€§èƒ½ä¼˜åŒ–ï¼Œä¸ä»…ä»…æ˜¯<strong>æŠŠèµ„æºåšå°</strong>ï¼Œæ›´æ˜¯<strong>å¯¹ç”¨æˆ·è¡Œä¸ºçš„ä¸€ç§é¢„åˆ¤</strong>ã€‚</p>
<p>ç”¨ <code>link rel="prefetch"</code> ï¼Œå½“ä½ è¿˜åœ¨è‹¦å“ˆå“ˆåœ°æŠ é‚£ 10kb çš„æ‰“åŒ…ä½“ç§¯æ—¶ï¼Œä¸å¦¨è¯•è¯•è¿™ä¸ªæŠ€å·§ï¼Œè¯´ä¸å®šä½ çš„ç½‘ç«™ä¼šé£èµ·æ¥ã€‚</p>
<p>æœ‰æ—¶å€™ï¼Œ<strong>è®©ç”¨æˆ·æ„Ÿè§‰å¿«ï¼Œæ¯”çœŸçš„å¿«ï¼Œæ›´é‡è¦ã€‚</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73991325fd7741dbba454ec0c340ec8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337721&amp;x-signature=msdN2JgKcEtfmmQ%2F2I4auwdygMM%3D" alt="è°¢è°¢å¤§å®¶.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•å®æˆ˜ï¼šå¦‚ä½•å®ç°ä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®ä»æ³¨å†Œåˆ°ç™»å½•çš„åŠŸèƒ½ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7579179741824237594</link>    <guid>https://juejin.cn/post/7579179741824237594</guid>    <pubDate>2025-12-03T03:35:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579179741824237594" data-draft-id="7579192114828214299" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•å®æˆ˜ï¼šå¦‚ä½•å®ç°ä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®ä»æ³¨å†Œåˆ°ç™»å½•çš„åŠŸèƒ½ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-03T03:35:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="360_go_php"/> <meta itemprop="url" content="https://juejin.cn/user/2436173498956695"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•å®æˆ˜ï¼šå¦‚ä½•å®ç°ä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®ä»æ³¨å†Œåˆ°ç™»å½•çš„åŠŸèƒ½ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173498956695/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    360_go_php
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:35:19.000Z" title="Wed Dec 03 2025 03:35:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼Œæ„å»ºä¸€ä¸ªç¨³å®šã€å®‰å…¨ä¸”æ˜“äºç»´æŠ¤çš„é¡¹ç›®æ˜¯æ¯ä¸ªå¼€å‘è€…çš„ç›®æ ‡ã€‚é¢è¯•ä¸­ï¼Œå¾ˆå¤šé—®é¢˜ä¼šå›´ç»•é¡¹ç›®çš„åŠŸèƒ½å®ç°ã€å®‰å…¨æ€§ä»¥åŠéƒ¨ç½²ç­‰æ–¹é¢å±•å¼€ã€‚æœ¬æ–‡å°†é€šè¿‡å®é™…æ¡ˆä¾‹ï¼Œè¯¦ç»†è®¨è®ºå¦‚ä½•å®ç°ä¸€ä¸ªé¡¹ç›®çš„æ³¨å†Œã€ç™»å½•ã€ç”¨æˆ·å”¯ä¸€æ€§éªŒè¯ç­‰å¸¸è§åŠŸèƒ½ï¼Œå¹¶å›ç­”ä¸€äº›é¢è¯•ä¸­å¸¸è§çš„ç›¸å…³é—®é¢˜ã€‚</p>
<h3 data-id="heading-0">1. <strong>å¦‚ä½•å®ç°é¡¹ç›®çš„æ³¨å†Œé—®é¢˜ï¼Ÿ</strong><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67946722368f48a3af057979767ad6a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337719&amp;x-signature=4RvyEYf8%2BX1ORnUnsAWpS6DiEwc%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h3>
<p>æ³¨å†ŒåŠŸèƒ½æ˜¯æ¯ä¸ªWebåº”ç”¨çš„åŸºç¡€åŠŸèƒ½ä¹‹ä¸€ï¼Œé€šå¸¸åŒ…æ‹¬ç”¨æˆ·è¾“å…¥åŸºæœ¬ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åã€å¯†ç ã€é‚®ç®±ç­‰ï¼‰ï¼Œç„¶åå°†å…¶å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚åœ¨å®ç°é¡¹ç›®æ³¨å†Œæ—¶ï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹ï¼š</p>
<h4 data-id="heading-1">(1) <strong>ç”¨æˆ·è¾“å…¥éªŒè¯</strong></h4>
<p>æ³¨å†Œé¡µé¢é¦–å…ˆè¦éªŒè¯ç”¨æˆ·è¾“å…¥çš„æœ‰æ•ˆæ€§ï¼Œç¡®ä¿ç”¨æˆ·åã€å¯†ç ç­‰å­—æ®µç¬¦åˆè§„å®šçš„æ ¼å¼ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>ç”¨æˆ·åé•¿åº¦æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼ˆå¦‚ï¼š6-16ä¸ªå­—ç¬¦ï¼‰ï¼›</li>
<li>å¯†ç æ˜¯å¦ç¬¦åˆå¼ºåº¦è¦æ±‚ï¼ˆå¦‚ï¼šåŒ…å«æ•°å­—ã€å­—æ¯ã€ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦8-16ä½ï¼‰ï¼›<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9db8a804b69b4e5faf12d367e47687d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337719&amp;x-signature=%2FKpThPiAdGeAuiO4IHZE2Z95JHo%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</li>
<li>é‚®ç®±æ ¼å¼æ˜¯å¦æ­£ç¡®ã€‚</li>
</ul>
<h4 data-id="heading-2">(2) <strong>ç”¨æˆ·å”¯ä¸€æ€§æ£€éªŒ</strong></h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fe4dc6d1bce49f6ac1db8d922e32b18~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337719&amp;x-signature=kRT7KcqCt8qP9tQT%2FI%2BHLqaGPGY%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘ä¸ºäº†ç¡®ä¿æ¯ä¸ªç”¨æˆ·çš„å”¯ä¸€æ€§ï¼Œé€šå¸¸ä¼šæ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦å·²å­˜åœ¨è¯¥ç”¨æˆ·çš„ç”¨æˆ·åæˆ–é‚®ç®±ã€‚å¯ä»¥åœ¨æ³¨å†Œä¹‹å‰æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¼ªä»£ç   </span>
<span class="hljs-keyword">if</span> db.query(<span class="hljs-string">"SELECT * FROM users WHERE username = ?"</span>, username):  
Â  Â  <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"ç”¨æˆ·åå·²å­˜åœ¨"</span>)

<span class="hljs-keyword">if</span> db.query(<span class="hljs-string">"SELECT * FROM users WHERE email = ?"</span>, email):  
Â  Â  <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"é‚®ç®±å·²è¢«æ³¨å†Œ"</span>)  
</code></pre>
<h4 data-id="heading-3">(3) <strong>å¯†ç åŠ å¯†å­˜å‚¨</strong></h4>
<p>ä¸ºé˜²æ­¢ç”¨æˆ·å¯†ç æ³„æ¼ï¼Œå¯†ç åœ¨å­˜å‚¨å‰éœ€è¦è¿›è¡ŒåŠ å¯†ã€‚å¸¸è§çš„åŠ å¯†æ–¹å¼æ˜¯ä½¿ç”¨å“ˆå¸Œç®—æ³•ï¼ˆå¦‚MD5ã€SHA256ã€bcryptç­‰ï¼‰ï¼ŒåŒæ—¶ç»“åˆç›å€¼ï¼ˆSaltï¼‰å¢å¼ºå¯†ç çš„å®‰å…¨æ€§ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> hashlib  
<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># ç”Ÿæˆç›å€¼  </span>
salt = os.urandom(<span class="hljs-number">16</span>)  
<span class="hljs-comment"># å¯¹å¯†ç è¿›è¡Œå“ˆå¸ŒåŠ å¯†  </span>
hashed_password = hashlib.sha256(salt + password.encode()).hexdigest()  
</code></pre>
<h4 data-id="heading-4">(4) <strong>æ•°æ®åº“è®¾è®¡</strong></h4>
<p>åœ¨æ•°æ®åº“ä¸­ï¼Œ<code>users</code>è¡¨å¯èƒ½åŒ…å«ä»¥ä¸‹å­—æ®µï¼š</p>
<ul>
<li><code>id</code>ï¼ˆä¸»é”®ï¼Œè‡ªå¢é•¿ï¼‰</li>
<li><code>username</code>ï¼ˆå”¯ä¸€ï¼‰</li>
<li><code>password_hash</code>ï¼ˆåŠ å¯†åçš„å¯†ç ï¼‰</li>
<li><code>salt</code>ï¼ˆç›å€¼ï¼‰</li>
<li><code>email</code>ï¼ˆå”¯ä¸€ï¼‰</li>
<li><code>created_at</code>ï¼ˆç”¨æˆ·æ³¨å†Œæ—¶é—´ï¼‰</li>
</ul>
<h3 data-id="heading-5">2. <strong>é¡¹ç›®å¦‚ä½•å®ç°ç”¨æˆ·å”¯ä¸€æ€§æ£€éªŒï¼Ÿ</strong></h3>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œç¡®ä¿ç”¨æˆ·å”¯ä¸€æ€§æ˜¯é˜²æ­¢é‡å¤æ³¨å†Œçš„å…³é”®ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹æ³•è¿›è¡Œç”¨æˆ·å”¯ä¸€æ€§æ£€éªŒï¼š</p>
<h4 data-id="heading-6">(1) <strong>æ•°æ®åº“å”¯ä¸€æ€§çº¦æŸ</strong></h4>
<p>é€šè¿‡åœ¨æ•°æ®åº“å±‚é¢å¢åŠ å”¯ä¸€æ€§çº¦æŸæ¥é˜²æ­¢ç”¨æˆ·é‡å¤æ³¨å†Œã€‚åœ¨<code>users</code>è¡¨ä¸­ï¼Œå¯ä»¥ä¸º<code>username</code>å’Œ<code>email</code>å­—æ®µåˆ†åˆ«è®¾ç½®å”¯ä¸€ç´¢å¼•ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (  
Â  Â  id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,  
Â  Â  username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">UNIQUE</span>,  
Â  Â  email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">UNIQUE</span>,  
Â  Â  password_hash <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,  
Â  Â  salt <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">16</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,  
Â  Â  created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>  
);  
</code></pre>
<h4 data-id="heading-7">(2) <strong>åº”ç”¨å±‚æ£€éªŒ</strong></h4>
<p>åœ¨ç”¨æˆ·æäº¤æ³¨å†Œè¯·æ±‚æ—¶ï¼Œåå°åº”ç”¨ç¨‹åºä¼šå…ˆåœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾æ˜¯å¦å·²ç»å­˜åœ¨ç›¸åŒçš„ç”¨æˆ·åæˆ–é‚®ç®±ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç¡®ä¿åœ¨é€»è¾‘ä¸Šä¸å…è®¸é‡å¤æ³¨å†Œã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å‡è®¾ä½¿ç”¨Python + SQLAlchemyæ¡†æ¶  </span>
<span class="hljs-keyword">from</span> sqlalchemy.orm.exc <span class="hljs-keyword">import</span> NoResultFound

<span class="hljs-keyword">def</span> <span class="hljs-title function_">check_user_exists</span>(<span class="hljs-params">username, email</span>):  
Â  Â  <span class="hljs-keyword">try</span>:  
Â  Â  Â  Â  user = db.session.query(User).filter_by(username=username).first()  
Â  Â  Â  Â  <span class="hljs-keyword">if</span> user:  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"ç”¨æˆ·åå·²å­˜åœ¨"</span>)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  user = db.session.query(User).filter_by(email=email).first()  
Â  Â  Â  Â  <span class="hljs-keyword">if</span> user:  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"é‚®ç®±å·²è¢«æ³¨å†Œ"</span>)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>  
Â  Â  <span class="hljs-keyword">except</span> NoResultFound:  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>  
</code></pre>
<h4 data-id="heading-8">(3) <strong>ç¼“å­˜å±‚ï¼ˆå¦‚Redisï¼‰</strong></h4>
<p>åœ¨æŸäº›é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œä¸ºäº†æé«˜ç”¨æˆ·å”¯ä¸€æ€§æ£€éªŒçš„æ•ˆç‡ï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜å±‚ï¼ˆå¦‚Redisï¼‰æ¥è¿›è¡Œå»é‡ã€‚é€šè¿‡ç¼“å­˜å¯ä»¥åœ¨çŸ­æ—¶é—´å†…é¿å…é‡å¤è¯·æ±‚é€ æˆçš„æ•°æ®åº“æŸ¥è¯¢è´Ÿæ‹…ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> redis

redis_client = redis.StrictRedis(host=<span class="hljs-string">'localhost'</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">is_user_registered</span>(<span class="hljs-params">username, email</span>):  
Â  Â  <span class="hljs-keyword">if</span> redis_client.exists(<span class="hljs-string">f"username:<span class="hljs-subst">{username}</span>"</span>) <span class="hljs-keyword">or</span> redis_client.exists(<span class="hljs-string">f"email:<span class="hljs-subst">{email}</span>"</span>):  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>  
Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">register_user</span>(<span class="hljs-params">username, email</span>):  
Â  Â  <span class="hljs-keyword">if</span> is_user_registered(username, email):  
Â  Â  Â  Â  <span class="hljs-comment"># æ³¨å†Œæµç¨‹  </span>
Â  Â  Â  Â  redis_client.<span class="hljs-built_in">set</span>(<span class="hljs-string">f"username:<span class="hljs-subst">{username}</span>"</span>, <span class="hljs-string">"1"</span>, ex=<span class="hljs-number">3600</span>) Â <span class="hljs-comment"># è®¾ç½®1å°æ—¶è¿‡æœŸ  </span>
Â  Â  Â  Â  redis_client.<span class="hljs-built_in">set</span>(<span class="hljs-string">f"email:<span class="hljs-subst">{email}</span>"</span>, <span class="hljs-string">"1"</span>, ex=<span class="hljs-number">3600</span>) Â <span class="hljs-comment"># è®¾ç½®1å°æ—¶è¿‡æœŸ  </span>
</code></pre>
<h3 data-id="heading-9">3. <strong>é¡¹ç›®å¦‚ä½•å®ç°éƒ¨ç½²ï¼Ÿ</strong></h3>
<p>éƒ¨ç½²æ˜¯å°†å¼€å‘å®Œæˆçš„é¡¹ç›®ä¸Šçº¿åˆ°æœåŠ¡å™¨çš„è¿‡ç¨‹ã€‚å¸¸è§çš„éƒ¨ç½²æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<h4 data-id="heading-10">(1) <strong>ä¼ ç»Ÿéƒ¨ç½²</strong></h4>
<p>ä¼ ç»Ÿéƒ¨ç½²é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ul>
<li>å°†é¡¹ç›®ä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆå¯ä»¥ä½¿ç”¨FTPã€SCPç­‰å·¥å…·ï¼‰ï¼›</li>
<li>é…ç½®WebæœåŠ¡å™¨ï¼ˆå¦‚Nginxã€Apacheï¼‰ä»¥æä¾›é™æ€æ–‡ä»¶æœåŠ¡å¹¶ä»£ç†åŠ¨æ€è¯·æ±‚ï¼›</li>
<li>é…ç½®æ•°æ®åº“ï¼ˆå¦‚MySQLã€PostgreSQLï¼‰ï¼›</li>
<li>é…ç½®è´Ÿè½½å‡è¡¡ã€è‡ªåŠ¨åŒ–è„šæœ¬ç­‰ã€‚</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²  </span>
scp -r /path/to/project user@server:/var/www/project  
ssh user@server  
<span class="hljs-built_in">cd</span> /var/www/project  
<span class="hljs-comment"># å¯åŠ¨åç«¯åº”ç”¨  </span>
python3 app.py  
</code></pre>
<h4 data-id="heading-11">(2) <strong>å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆDockerï¼‰</strong></h4>
<p>ç°ä»£éƒ¨ç½²é€šå¸¸é‡‡ç”¨å®¹å™¨åŒ–æŠ€æœ¯ï¼ˆå¦‚Dockerï¼‰è¿›è¡Œéƒ¨ç½²ï¼Œè¿™æ ·å¯ä»¥åœ¨ä¸åŒç¯å¢ƒä¸­ä¿è¯ä¸€è‡´æ€§ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Dockerfile ç¤ºä¾‹  </span>
FROM python:3.9-slim  
WORKDIR /app  
COPY . /app  
RUN pip install -r requirements.txt  
CMD [<span class="hljs-string">"python"</span>, <span class="hljs-string">"app.py"</span>]  
</code></pre>
<p>ä½¿ç”¨Docker Composeè¿›è¡Œå¤šå®¹å™¨ç®¡ç†ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3'</span>  
<span class="hljs-attr">services:</span>  
Â  <span class="hljs-attr">app:</span>  
Â  Â  <span class="hljs-attr">build:</span> <span class="hljs-string">.</span>  
Â  Â  <span class="hljs-attr">ports:</span>  
Â  Â  Â  <span class="hljs-bullet">-</span> <span class="hljs-string">"5000:5000"</span>  
Â  <span class="hljs-attr">db:</span>  
Â  Â  <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:5.7</span>  
Â  Â  <span class="hljs-attr">environment:</span>  
Â  Â  Â  <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">example</span>  
Â  Â  Â  <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">mydb</span>  
</code></pre>
<h4 data-id="heading-12">(3) <strong>äº‘éƒ¨ç½²ï¼ˆå¦‚AWSã€Azureï¼‰</strong></h4>
<p>è®¸å¤šå…¬å¸é‡‡ç”¨äº‘å¹³å°ï¼ˆå¦‚AWSã€Azureï¼‰è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²å’Œæ‰©å±•ã€‚äº‘å¹³å°æä¾›äº†å®¹å™¨ç®¡ç†ã€è‡ªåŠ¨ä¼¸ç¼©ã€è´Ÿè½½å‡è¡¡ç­‰åŠŸèƒ½ï¼Œèƒ½å¤Ÿå¿«é€Ÿæ‰©å±•å’Œç»´æŠ¤åº”ç”¨ã€‚</p>
<h3 data-id="heading-13">4. <strong>ç™»å½•çŠ¶æ€ä¿å­˜åœ¨å“ªï¼Ÿ</strong></h3>
<p>ç™»å½•çŠ¶æ€çš„ä¿å­˜æ˜¯ç”¨æˆ·ä½“éªŒå’Œå®‰å…¨çš„å…³é”®ã€‚å¸¸è§çš„åšæ³•æœ‰ï¼š</p>
<h4 data-id="heading-14">(1) <strong>Session</strong></h4>
<p>Sessionæ˜¯ä¸€ç§åœ¨æœåŠ¡å™¨ç«¯å­˜å‚¨ç”¨æˆ·ä¼šè¯ä¿¡æ¯çš„æœºåˆ¶ã€‚æ¯æ¬¡ç”¨æˆ·ç™»å½•åï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„Session IDï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨æµè§ˆå™¨çš„Cookieä¸­ã€‚æœåŠ¡å™¨å¯ä»¥é€šè¿‡è¯¥Session IDè¯†åˆ«ç”¨æˆ·ï¼Œå¹¶å­˜å‚¨ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚</p>
<h4 data-id="heading-15">(2) <strong>Tokenï¼ˆJWTï¼‰</strong></h4>
<p>å¦ä¸€ç§å¸¸è§çš„åšæ³•æ˜¯ä½¿ç”¨JWTï¼ˆJSON Web Tokenï¼‰ã€‚JWTé€šå¸¸åŒ…å«äº†ç”¨æˆ·èº«ä»½å’Œæœ‰æ•ˆæœŸç­‰ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥å°†JWTä¿å­˜åœ¨æµè§ˆå™¨çš„LocalStorageæˆ–SessionStorageä¸­ï¼Œæ¯æ¬¡è¯·æ±‚æ—¶æºå¸¦åœ¨HTTPå¤´éƒ¨ã€‚</p>
<pre><code class="hljs language-python" lang="python">importwt(user_id):  
Â  Â  payload = {  
Â  Â  Â  Â  <span class="hljs-string">"user_id"</span>: user_id,  
Â  Â  Â  Â  <span class="hljs-string">"exp"</span>:secret<span class="hljs-string">", algorithm="</span>HS256<span class="hljs-string">")  
</span></code></pre>
<h3 data-id="heading-16">5. <strong>MD5åŸç†çŸ¥é“å—ï¼Ÿå®‰å…¨å—ï¼Ÿå¯é€†å—ï¼Ÿ</strong></h3>
<p>MD5æ˜¯ä¸€ç§å¸¸è§çš„å“ˆå¸Œç®—æ³•ï¼Œå…¶åŸç†æ˜¯å°†ä»»æ„é•¿åº¦çš„è¾“å…¥æ•°æ®è½¬æ¢ä¸ºå›ºå®šé•¿åº¦ï¼ˆ128ä½ï¼‰çš„è¾“å‡ºï¼Œé€šå¸¸ä»¥16è¿›åˆ¶å½¢å¼è¡¨ç¤ºã€‚å®ƒæ˜¯ä¸å¯é€†çš„ï¼Œå³ç†è®ºä¸Šæ— æ³•ä»å“ˆå¸Œå€¼æ¢å¤åŸå§‹æ•°æ®ã€‚</p>
<h4 data-id="heading-17">(1) <strong>MD5çš„å®‰å…¨æ€§</strong></h4>
<p>MD5æ›¾ç»å¹¿æ³›ç”¨äºå¯†ç å­˜å‚¨å’Œæ•°æ®å®Œæ•´æ€§æ ¡éªŒï¼Œä½†ç°åœ¨è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ã€‚ä¸»è¦åŸå› æ˜¯MD5æ˜“å—ç¢°æ’æ”»å‡»ï¼Œå³ä¸¤ä¸ªä¸åŒçš„è¾“å…¥å¯ä»¥äº§ç”Ÿç›¸åŒçš„å“ˆå¸Œå€¼ï¼Œè¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ä¸¤ä¸ªä¸åŒçš„æ•°æ®é›†å¾—åˆ°ç›¸åŒçš„MD5å“ˆå¸Œå€¼ï¼Œä»è€Œç ´åæ•°æ®çš„å®Œæ•´æ€§ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75158f9616a74b2a8fc50f20b7fc9e88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337719&amp;x-signature=4Z8mQhKCC87F1xXaHUcZmBvOJM0%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<h4 data-id="heading-18">(2) <strong>MD5å¯é€†å—ï¼Ÿ</strong></h4>
<p>MD5æ˜¯ä¸å¯é€†çš„å“ˆå¸Œç®—æ³•ï¼Œæ„å‘³ç€æ— æ³•ç›´æ¥ä»MD5å“ˆå¸Œå€¼æ¢å¤åŸå§‹è¾“å…¥ã€‚ç„¶è€Œï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å½©è™¹è¡¨ã€æš´åŠ›ç ´è§£ç­‰æ‰‹æ®µå°è¯•æ¨æµ‹åŸå§‹æ•°æ®ã€‚å› æ­¤ï¼ŒMD5ä¸é€‚åˆç”¨äºå¯†ç å­˜å‚¨ï¼Œç°ä»£åº”ç”¨ä¸­æ¨èä½¿ç”¨æ›´åŠ å®‰å…¨çš„å“ˆå¸Œç®—æ³•ï¼Œå¦‚SHA256æˆ–bcryptã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2dbb01d4bc7e4630bbdccaba24a6d604~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337719&amp;x-signature=gFbhxtvXG9U3rSSit0GdaOPGdBc%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<h3 data-id="heading-19">æ€»ç»“<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23b23b7ef3924d3aa5266a044dd77f2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337719&amp;x-signature=Z3M28Mnj1wYoi7BjWTkPs2jrPwA%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h3>
<p>æœ¬æ–‡å›ç­”äº†å…³äºé¡¹ç›®å®ç°ä¸­çš„æ³¨å†Œã€ç”¨æˆ·å”¯ä¸€æ€§æ£€éªŒã€éƒ¨ç½²ã€ç™»å½•çŠ¶æ€ä¿å­˜ä»¥åŠMD5çš„å®‰å…¨æ€§ç­‰é—®é¢˜ã€‚åœ¨é¢è¯•ä¸­ï¼Œç†Ÿæ‚‰è¿™äº›åŸºæœ¬æ¦‚å¿µï¼Œå¹¶èƒ½å±•ç¤ºå®é™…æ“ä½œçš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¸®åŠ©ä½ å±•ç¤ºæŠ€æœ¯èƒ½åŠ›å¹¶æå‡é¢è¯•é€šè¿‡ç‡ã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¸…åå¤§ä½¬å¼ºæ¨ï¼å…¨ç½‘ç¬¬ä¸€æœ¬ä¸­æ–‡å¤§è¯­è¨€æ¨¡å‹æ•™ç¨‹æ¥äº†ï¼Œ391é¡µ å…¨å¼€æº]]></title>    <link>https://juejin.cn/post/7579176524131106867</link>    <guid>https://juejin.cn/post/7579176524131106867</guid>    <pubDate>2025-12-03T03:37:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579176524131106867" data-draft-id="7579192114828197915" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¸…åå¤§ä½¬å¼ºæ¨ï¼å…¨ç½‘ç¬¬ä¸€æœ¬ä¸­æ–‡å¤§è¯­è¨€æ¨¡å‹æ•™ç¨‹æ¥äº†ï¼Œ391é¡µ å…¨å¼€æº"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-03T03:37:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¸…åå¤§ä½¬å¼ºæ¨ï¼å…¨ç½‘ç¬¬ä¸€æœ¬ä¸­æ–‡å¤§è¯­è¨€æ¨¡å‹æ•™ç¨‹æ¥äº†ï¼Œ391é¡µ å…¨å¼€æº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:37:17.000Z" title="Wed Dec 03 2025 03:37:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>ç¬¬ä¸€æœ¬ä¸­æ–‡å¤§è¯­è¨€æ¨¡å‹æ•™ç¨‹æ¥äº†ï¼Œè¿™æ˜¯ç”±ä¸­å›½äººæ°‘å¤§å­¦é«˜ç“´äººå·¥æ™ºèƒ½å­¦é™¢èµµé‘«è´Ÿè´£å†µä¸”å¼€æºçš„å¤§æ¨¡å‹å…¥é—¨ä¹¦ç±ï¼Œå¹¶ä¸”æ˜¯å¼€æºå¯ä¸‹è½½çš„ã€‚</p>
<p>æœ¬ä¹¦ä¸»è¦é¢å‘å¸Œæœ›ç³»ç»Ÿå­¦ä¹ å¤§è¯­è¨€æ¨¡å‹æŠ€æœ¯çš„è¯»è€…ï¼Œå°†é‡ç‚¹çªå‡ºæ ¸å¿ƒæ¦‚å¿µä¸ç®—æ³•ï¼Œå¹¶ä¸”é…ä»¥ç¤ºä¾‹ä¸ä»£ç å¸®åŠ©è¯»è€…ç†è§£ç‰¹å®šç®—æ³•çš„å®ç°é€»è¾‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32ca984d8f8e4749978895bad1e0e8de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337836&amp;x-signature=d3EEgUT%2Bm%2ByU9oqXfmLfitwGbVc%3D" alt="" loading="lazy"/></p>
<p><strong>æœ¬ä¹¦è‡ª2024å¹´12æœˆåº•å¯åŠ¨ç¼–å†™ï¼Œä¸­æ–‡ç‰ˆæœ¬25å¹´4æœˆ15æ—¥æ›´æ–°å¼€æºã€‚</strong> ã€Šå¤§è¯­è¨€æ¨¡å‹ã€‹æ˜¯ä¸€æœ¬å…¨é¢ä»‹ç»å¤§è¯­è¨€æ¨¡å‹æŠ€æœ¯çš„ä¹¦ç±ï¼Œå®ƒä¸ä»…æ¶µç›–äº†åŸºç¡€åŸç†å’Œå…³é”®æŠ€æœ¯ï¼Œè¿˜å±•æœ›äº†æŠ€æœ¯çš„æœªæ¥åº”ç”¨å‰æ™¯ã€‚</p>
<p>ä¸­æ–‡ç‰ˆä¹¦ç±æ³¨é‡ä¸ºå¤§æ¨¡å‹æŠ€æœ¯çš„å…¥é—¨è¯»è€…æä¾›è®²è§£ï¼ŒåŠ›å›¾å±•ç°ä¸€ä¸ªæ•´ä½“çš„å¤§æ¨¡å‹æŠ€æœ¯æ¡†æ¶å’Œè·¯çº¿å›¾ã€‚</p>
<p>æœ¬ä¹¦å…±è®¾ç½®äº†äº”ä¸ªä¸»è¦éƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯èƒŒæ™¯ä¸åŸºç¡€çŸ¥è¯†éƒ¨åˆ†ã€é¢„è®­ç»ƒéƒ¨åˆ†ã€å¾® è°ƒä¸å¯¹é½éƒ¨åˆ†ã€å¤§æ¨¡å‹ä½¿ç”¨éƒ¨åˆ†ä»¥åŠè¯„æµ‹ä¸åº”ç”¨éƒ¨åˆ†ã€‚</p>
<ul>
<li>ç¬¬ä¸€ç«  å¼•è¨€ï¼ˆå¤§æ¨¡å‹å‘å±•å†ç¨‹ã€é‡è¦æŠ€æœ¯æ¦‚è§ˆï¼‰</li>
<li>ç¬¬äºŒç«  åŸºç¡€ä»‹ç»ï¼ˆScaling Lawã€GPTç³»åˆ—æ¨¡å‹å‘å±•å†ç¨‹ï¼‰</li>
<li>ç¬¬ä¸‰ç«  å¤§æ¨¡å‹èµ„æºï¼ˆå¼€æºæ¨¡å‹ã€æ•°æ®ã€ä»£ç åº“ï¼‰</li>
<li>ç¬¬å››ç«  æ•°æ®å‡†å¤‡ï¼ˆæ•°æ®æ”¶é›†ã€æ¸…æ´—ã€é…æ¯”ã€è¯¾ç¨‹æ–¹æ³•ï¼‰</li>
<li>ç¬¬äº”ç«  æ¨¡å‹æ¶æ„ï¼ˆTransformer ç»“æ„ã€å¤§æ¨¡å‹ä¸»æµæ¶æ„ã€ç»†èŠ‚æ”¹è¿›ï¼‰</li>
<li>......</li>
<li>ç¬¬åäºŒç«  è¯„æµ‹ï¼ˆè¯„æµ‹æŒ‡æ ‡ä¸æ–¹æ³•ã€åŸºç¡€ä¸é«˜çº§èƒ½åŠ›è¯„æµ‹ã€è¯„æµ‹ä½“ç³»ï¼‰</li>
<li>ç¬¬åä¸‰ç«  åº”ç”¨ï¼ˆæ¦‚è§ˆç ”ç©¶é¢†åŸŸä¸ä¸“ä¸šé¢†åŸŸçš„åº”ç”¨ï¼‰</li>
</ul>
<h2 data-id="heading-0">è¯¾ç¨‹ç›®å½•å¦‚ä¸‹ï¼š</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1fb0535ef924fc8adbf13ef44f9714a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337836&amp;x-signature=wT3X3FJR2NRsYKee0JtyJA2GW3E%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f84d63daa2d74058bd1a9fd079e2e4e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337836&amp;x-signature=bC%2FMCLfGK5f87%2F8ZHeMzjEjlPx8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c288a1920e9f479089d15a52a23e85c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337836&amp;x-signature=QwrN1MTxoz6XhVENElWHv4hlKW8%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-1"/>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3db8afdaa324cc3b61b80b8ef33da18~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337836&amp;x-signature=WP9hSW%2FFY9aJbL0ozIfSli%2BXwXc%3D" alt="" loading="lazy"/></p>
<p>ç”±äºå¤§è¯­è¨€æ¨¡å‹æŠ€æœ¯çš„å¿«é€Ÿæ›´è¿­ï¼Œæœ¬ä¹¦æ— æ³•è¦†ç›–æ‰€æœ‰ç›¸å…³å†…å®¹ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶æ›´å¥½åœ°äº†è§£å¤§è¯­è¨€æ¨¡å‹æŠ€æœ¯çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ã€‚é€‚ç”¨äºå…·æœ‰æ·±åº¦å­¦ä¹ åŸºç¡€çš„é«˜å¹´çº§æœ¬ç§‘ç”Ÿä»¥åŠä½å¹´çº§ç ”ç©¶ç”Ÿä½¿ç”¨ï¼Œå¯ä»¥ä½œä¸ºä¸€æœ¬å…¥é—¨çº§çš„å‚è€ƒèµ„æ–™ã€‚</p>
<h3 data-id="heading-2">å­¦ä¹ èµ„æºæ¨è</h3>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸æ„§æ˜¯GitHubæ’åç¬¬ä¸€çš„å¤§æ¨¡å‹è¯¾ï¼æˆ‘è¿˜ç¿»è¯‘æˆäº†ä¸­æ–‡ç‰ˆ]]></title>    <link>https://juejin.cn/post/7579192114828181531</link>    <guid>https://juejin.cn/post/7579192114828181531</guid>    <pubDate>2025-12-03T03:34:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579192114828181531" data-draft-id="7579175271680278538" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸æ„§æ˜¯GitHubæ’åç¬¬ä¸€çš„å¤§æ¨¡å‹è¯¾ï¼æˆ‘è¿˜ç¿»è¯‘æˆäº†ä¸­æ–‡ç‰ˆ"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-03T03:34:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸æ„§æ˜¯GitHubæ’åç¬¬ä¸€çš„å¤§æ¨¡å‹è¯¾ï¼æˆ‘è¿˜ç¿»è¯‘æˆäº†ä¸­æ–‡ç‰ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T03:34:30.000Z" title="Wed Dec 03 2025 03:34:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>æœ€è¿‘åœ¨ GitHub ä¸Šå‘ç°äº†ä¸€ä¸ªè¶…çº§ç¡¬æ ¸çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰è¯¾ç¨‹ï¼Œæ ‡æ˜Ÿå·²è¾¾åˆ°ææ€–çš„67kï¼Œå®ƒæä¾›äº†ä¸€å¥—å®Œæ•´çš„å­¦ä¹ è·¯çº¿å›¾å’Œå¯ä»¥ç›´æ¥ä¸Šæ‰‹çš„ Colab ç¬”è®°ï¼Œç›®æ ‡å°±æ˜¯å¸¦ä½ ä»å…¥é—¨åˆ°ç²¾é€šï¼Œæ— è®ºä½ æœ‰æ²¡æœ‰åŸºç¡€æˆ–æ˜¯æƒ³æ·±å…¥ç ”ç©¶æ¨¡å‹ã€å¼€å‘åº”ç”¨ï¼Œéƒ½èƒ½æ‰¾åˆ°æ¸…æ™°çš„è·¯å¾„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b44d8aeca564d8cb71b13a9f6cf5d19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337669&amp;x-signature=UF0k2eDKHFcwEPed2GKzMuvXO3g%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ç»™çœ‹ä¸å¤ªæ‡‚è‹±è¯­å’Œä¸Šä¸äº†GitHubçš„åŒå­¦æŠŠè¿™ä»½ä»“åº“ç¿»è¯‘å¹¶ä¸”åšæˆäº†ä¸€ä»½PDFæ–‡æ¡£ï¼Œ<strong>å¦‚æœå¤§å®¶éœ€è¦è¿™ä»½æ–‡æ¡£åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</strong></p>
<p>è¿™ä¸ªè¯¾ç¨‹æœ€å¤§çš„äº®ç‚¹å°±æ˜¯å®ƒçš„ä½“ç³»åŒ–å’Œå®è·µæ€§ï¼ŒæŠŠå¤æ‚çš„ LLM é¢†åŸŸæ‹†è§£æˆäº†ä¸‰ä¸ªæ¸…æ™°çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ¸…æ™°çš„è·¯çº¿å›¾ï¼Œå¯¹æƒ³ç³»ç»Ÿå­¦ä¹ çš„åŒå­¦æ¥è¯´ï¼Œç®€ç›´æ˜¯ç¦éŸ³<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/946cd9bf6e1442238909fa3560867f52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337669&amp;x-signature=eCETqMYDu93ALTXxeQJLC33%2FkA8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e534900e8e71426da7f1ea2ab98297ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337669&amp;x-signature=qkez5dCmVCJwOWOsiAv7M3dgXIg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3015b166f3774978b645c8b0e72f4341~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337669&amp;x-signature=Xr5XTW9sfCj0a%2FVWUZeacQOMskY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2f3c8c63ee24670ad32df137ec026ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765337669&amp;x-signature=TZy2qLYc7cTfkGQjY7R8MzqnUJs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[éº’éºŸæ“ä½œç³»ç»Ÿ (kylinos) ä»å…¥é—¨åˆ°ç²¾é€š -é«˜çº§æ•™ç¨‹ - ç¬¬85ç¯‡ ç½‘ç»œæœåŠ¡éƒ¨ç½²ç®€æ˜“æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7579096485356650546</link>    <guid>https://juejin.cn/post/7579096485356650546</guid>    <pubDate>2025-12-03T00:51:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579096485356650546" data-draft-id="7579096485356601394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="éº’éºŸæ“ä½œç³»ç»Ÿ (kylinos) ä»å…¥é—¨åˆ°ç²¾é€š -é«˜çº§æ•™ç¨‹ - ç¬¬85ç¯‡ ç½‘ç»œæœåŠ¡éƒ¨ç½²ç®€æ˜“æ•™ç¨‹"/> <meta itemprop="keywords" content="æ“ä½œç³»ç»Ÿ"/> <meta itemprop="datePublished" content="2025-12-03T00:51:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XPlazaä¿¡åˆ›å¼€æºå¹¿åœº"/> <meta itemprop="url" content="https://juejin.cn/user/3217616484184618"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            éº’éºŸæ“ä½œç³»ç»Ÿ (kylinos) ä»å…¥é—¨åˆ°ç²¾é€š -é«˜çº§æ•™ç¨‹ - ç¬¬85ç¯‡ ç½‘ç»œæœåŠ¡éƒ¨ç½²ç®€æ˜“æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3217616484184618/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XPlazaä¿¡åˆ›å¼€æºå¹¿åœº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T00:51:06.000Z" title="Wed Dec 03 2025 00:51:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01820e18ab4f464fbb47f19f144a34d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWFBsYXph5L-h5Yib5byA5rqQ5bm_5Zy6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765327866&amp;x-signature=3eWA6X9s%2FWX5eKFlQhc05Dk2f3Q%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">0.åŸºç¡€ç¯å¢ƒ</h2>
<p>ç±»åˆ«ï¼šç¬”è®°æœ¬<br/>
å‹å·ï¼šä¸­å›½é•¿åŸ NF14C<br/>
ç¡¬ä»¶å¹³å°ï¼šé£è…¾å¤„ç†å™¨D2000ï¼ˆArmV8 æŒ‡ä»¤é›†ï¼‰<br/>
ç³»ç»Ÿï¼šé“¶æ²³éº’éºŸæ“ä½œç³»ç»Ÿ V10 SP1(2303)</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de9740fea75f4782a88e77c87edc400f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWFBsYXph5L-h5Yib5byA5rqQ5bm_5Zy6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765327866&amp;x-signature=BaW7V4%2BBRazV7MsdceLnGoHgfgM%3D" alt="" loading="lazy"/></p>
<p>å…³é”®è¯ï¼šLinux,è¿›ç¨‹ç›‘æ§,apache,nginx,samba,nfs,ftp</p>
<h2 data-id="heading-1">0.å‡†å¤‡å·¥ä½œ</h2>
<p>ä¸ºæ–¹ä¾¿ç½‘ç»œè¿æ¥ï¼Œå…³æ‰é˜²ç«å¢™</p>
<pre><code class="hljs language-bash" lang="bash">sudo ufw <span class="hljs-built_in">disable</span> <span class="hljs-comment">#æ–¹å¼1</span>
sudo systemctl stop firewalld  <span class="hljs-comment">#æ–¹å¼2</span>
</code></pre>
<h2 data-id="heading-2">1.NFSæœåŠ¡éƒ¨ç½²</h2>
<p>NFSï¼ˆNetwork File Systemï¼Œç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼‰æ˜¯ Unix/Linux ç¯å¢ƒä¸‹éå¸¸é‡è¦ä¸”åŸºç¡€çš„ç½‘ç»œæœåŠ¡ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å…è®¸ç½‘ç»œä¸Šçš„è®¡ç®—æœºä¹‹é—´åƒè®¿é—®æœ¬åœ°æ–‡ä»¶ä¸€æ ·è®¿é—®è¿œç¨‹å…±äº«çš„æ–‡ä»¶å’Œç›®å½•ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…è¿™äº›è½¯ä»¶åŒ…ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> <span class="hljs-keyword">update</span>
sudo apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> install nfs<span class="hljs-operator">-</span>kernel<span class="hljs-operator">-</span>server nfs<span class="hljs-operator">-</span>common rpcbind <span class="hljs-operator">-</span>y
</code></pre>
<p>æœåŠ¡ç«¯çš„è®¾å¤‡éœ€è¦å®‰è£…:nfs-kernel-server rpcbind</p>
<p>å®¢æˆ·ç«¯çš„è®¾å¤‡éœ€è¦å®‰è£…: nfs-commonç»„ä»¶</p>
<h3 data-id="heading-3">åˆ›å»ºå…±äº«ç›®å½•</h3>
<p>é¦–å…ˆï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªè¦å…±äº«çš„ç›®å½•ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºÂ <code>/share</code>Â çš„ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">mkdir</span> /share
</code></pre>
<p>ç„¶åï¼Œè®¾ç½®é€‚å½“çš„æƒé™ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">chmod</span> 777 /share
</code></pre>
<h3 data-id="heading-4">é…ç½®NFS</h3>
<p>åœ¨å›¾å½¢ç•Œé¢ä¸­ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œå¹¶è¾“å…¥ä»¥ä¸‹å‘½ä»¤ä»¥ç¼–è¾‘Â <code>/etc/exports</code>Â æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo apt install gedit -y <span class="hljs-comment">#å®‰è£…geditç¼–è¾‘å™¨</span>
sudo gedit /etc/exports
</code></pre>
<p>åœ¨æ‰“å¼€çš„æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œä»¥æŒ‡å®šè¦å…±äº«çš„ç›®å½•å’Œå®¢æˆ·ç«¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/share *(rw,<span class="hljs-built_in">sync</span>,no_subtree_check) <span class="hljs-comment">#* å’Œ (rwä¹‹é—´æ²¡æœ‰ç©ºæ ¼</span>
</code></pre>
<p>è¿™é‡Œçš„Â <code>/share</code>Â æ˜¯æ‚¨è¦å…±äº«çš„ç›®å½•ï¼Œ<code>*</code>Â è¡¨ç¤ºæ‰€æœ‰å®¢æˆ·ç«¯éƒ½å¯ä»¥è®¿é—®ï¼Œ<code>(rw,sync,nolock)</code>Â æ˜¯å…±äº«çš„æƒé™ã€‚</p>
<p>å…¶ä»–å‚è€ƒ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Share /home/data with IP 192.168.1.10, read-write, sync</span>
/home/data 192.168.1.10(rw,<span class="hljs-built_in">sync</span>,no_subtree_check)

<span class="hljs-comment"># Share /mnt/nfs_share with the entire subnet, read-only</span>
/mnt/nfs_share 192.168.1.0/24(ro,<span class="hljs-built_in">sync</span>,no_subtree_check)
</code></pre>
<p>æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®</p>
<pre><code class="hljs">sudo exportfs -rv
</code></pre>
<h3 data-id="heading-5">é…ç½®é˜²ç«å¢™</h3>
<pre><code class="hljs language-bash" lang="bash">sudo apt install ufw -y <span class="hljs-comment">#å®‰è£…é˜²ç«å¢™</span>
sudo systemctl start ufw <span class="hljs-comment">#å¯åŠ¨é˜²ç«å¢™</span>
sudo systemctl <span class="hljs-built_in">enable</span> ufw  <span class="hljs-comment">#å¼€æœºå¯åŠ¨é˜²ç«å¢™</span>
sudo ufw status  <span class="hljs-comment">#ç¡®è®¤çŠ¶æ€</span>
</code></pre>
<p>æ”¾è¡Œç«¯å£æˆ–æœåŠ¡</p>
<p>NFS çš„æ ¸å¿ƒæ˜¯ TCP/UDP ç«¯å£Â <code>111</code>Â å’ŒÂ <code>2049</code>ã€‚</p>


























<table><thead><tr><th>æœåŠ¡</th><th>ç«¯å£</th><th>åè®®</th><th>æè¿°</th><th>UFW å‘½ä»¤ (ç¤ºä¾‹ IP é™åˆ¶)</th></tr></thead><tbody><tr><td>rpcbind</td><td>111</td><td>TCP/UDP</td><td>ç«¯å£æ˜ å°„æœåŠ¡ï¼ŒNFS å¯åŠ¨å¿…å¤‡ã€‚</td><td>sudo ufw allow from 192.168.1.0/24 to any port 111</td></tr><tr><td>nfs</td><td>2049</td><td>TCP/UDP</td><td>NFS æ ¸å¿ƒæ•°æ®ä¼ è¾“ç«¯å£ã€‚</td><td>sudo ufw allow from 192.168.1.0/24 to any port 2049</td></tr></tbody></table>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. Portmap/Rpcbind: ç«¯å£ 111 (TCP/UDP)</span>
sudo ufw allow 111/tcp
sudo ufw allow 111/udp

<span class="hljs-comment"># 2. NFS: ç«¯å£ 2049 (TCP/UDP)</span>
sudo ufw allow 2049/tcp
sudo ufw allow 2049/udp
</code></pre>
<h3 data-id="heading-6">å¯åŠ¨NFSæœåŠ¡</h3>
<p>åœ¨ç»ˆç«¯ä¸­ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ä»¥å¯åŠ¨NFSæœåŠ¡ï¼š</p>
<pre><code class="hljs language-vbscript" lang="vbscript">sudo systemctl restart nfs-kernel-<span class="hljs-built_in">server</span>
sudo systemctl restart rpcbind
</code></pre>
<p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ç”¨NFSæœåŠ¡åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl <span class="hljs-built_in">enable</span> nfs-kernel-server
sudo systemctl <span class="hljs-built_in">enable</span> rpcbind
</code></pre>
<h3 data-id="heading-7">é…ç½®å®¢æˆ·ç«¯</h3>
<p>åœ¨å®¢æˆ·ç«¯è®¡ç®—æœºä¸Šï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…NFSå®¢æˆ·ç«¯ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">sudo apt-get install nfs-common
</code></pre>
<p>ç„¶åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‚è½½NFSå…±äº«ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">sudo mount -t nfs &lt;<span class="hljs-variable constant_">NFS_SERVER_IP_ADDRESS</span>&gt;<span class="hljs-symbol">:&lt;SHARED_DIRECTORY&gt;</span> &lt;<span class="hljs-variable constant_">MOUNT_POINT</span>&gt;
</code></pre>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦æŒ‚è½½IPåœ°å€Â <code>çš„æœåŠ¡å™¨ä¸Šçš„</code>Â /shareÂ <code>ç›®å½•åˆ°æœ¬åœ°ç›®å½•</code>Â /mnt/nfs`ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">mkdir</span> /mnt/nfs <span class="hljs-comment">#åˆ›å»ºæŒ‚è½½ç›®å½•</span>
sudo <span class="hljs-built_in">chmod</span> 777 -R /mnt/nfs <span class="hljs-comment"># è®¾ç½®æƒé™ä¸ºå…¨æ”¾å¼€</span>
sudo mount -t nfs 127.0.0.1:/share /mnt/nfs <span class="hljs-comment">#æŒ‚è½½ï¼Œ127.0.0.1ä»£è¡¨æœ¬æœºåœ°å€ï¼Œå¦‚æœæ˜¯è¿œç¨‹æœåŠ¡å™¨ï¼Œéœ€è¦æ¢æˆçœŸæ­£çš„å¯è¾¾çš„IPåœ°å€</span>
</code></pre>
<h2 data-id="heading-8">2.DHCPæœåŠ¡éƒ¨ç½²</h2>
<p>DHCPï¼ˆDynamic Host Configuration Protocolï¼ŒåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼‰æ˜¯ç½‘ç»œç®¡ç†ä¸­ä¸€ä¸ªè‡³å…³é‡è¦çš„åè®®ï¼Œå®ƒçš„æ ¸å¿ƒç›®çš„æ˜¯å®ç°ç½‘ç»œä¸­è®¾å¤‡çš„Â <strong>è‡ªåŠ¨åŒ–</strong>Â å’ŒÂ <strong>é›†ä¸­åŒ–</strong>Â IP åœ°å€é…ç½®ã€‚</p>























<table><thead><tr><th>è™šæ‹Ÿæœº (VM)</th><th>è§’è‰²</th><th>æ“ä½œç³»ç»Ÿ</th><th>é…ç½®è¦æ±‚</th></tr></thead><tbody><tr><td>VM-A</td><td>DHCP æœåŠ¡å™¨</td><td>ä»»æ„ Linux (å¦‚ Ubuntu Server, CentOS)</td><td>å®‰è£… isc-dhcp-server æˆ–å…¶ä»– DHCP è½¯ä»¶ã€‚é…ç½®ä¸€ä¸ªé™æ€ IP åœ°å€ä½œä¸ºæœåŠ¡å™¨åœ°å€ã€‚</td></tr><tr><td>VM-B</td><td>DHCP å®¢æˆ·ç«¯</td><td>ä»»æ„ Linux æˆ– Windows</td><td>ç½‘ç»œé…ç½®ä¸ºè‡ªåŠ¨è·å– IP (DHCP)ã€‚</td></tr></tbody></table>
<h3 data-id="heading-9">å®‰è£…DHCPæœåŠ¡å™¨</h3>
<ol>
<li>æ‰“å¼€ç»ˆç«¯ã€‚</li>
<li>è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨ï¼š<br/>
sudo apt-get update</li>
<li>å®‰è£…isc-dhcp-serverè½¯ä»¶åŒ…ï¼Œè¯¥è½¯ä»¶åŒ…åŒ…å«äº†DHCPæœåŠ¡å™¨çš„æ‰€æœ‰å¿…éœ€ç»„ä»¶ï¼š<br/>
sudo apt-get install isc-dhcp-server</li>
</ol>
<h3 data-id="heading-10">é…ç½®DHCPæœåŠ¡å™¨</h3>
<ol>
<li>ç¼–è¾‘DHCPé…ç½®æ–‡ä»¶<code>/etc/dhcp/dhcpd.conf</code>ï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†DHCPæœåŠ¡å™¨çš„é…ç½®ä¿¡æ¯ï¼š<br/>
sudo cp /etc/dhcp/dhcpd.conf /etc/dhcp/dhcpd.conf.bak sudo gedit /etc/dhcp/dhcpd.conf</li>
<li>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ä»¥è®¾ç½®IPåœ°å€æ± ã€å­ç½‘æ©ç ã€ç½‘å…³å’ŒDNSæœåŠ¡å™¨ç­‰ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹é…ç½®ï¼š</li>
</ol>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># åŒ¹é…ä½ çš„å®é™…ç½‘ç»œï¼š192.168.200.0/24</span>
subnet 192.168.200.0 netmask 255.255.255.0 {
    range 192.168.200.50 192.168.200.100<span class="hljs-comment">;  # IPåˆ†é…èŒƒå›´</span>
    option routers 192.168.200.1<span class="hljs-comment">;          # ç½‘å…³åœ°å€</span>
    option domain-name-servers 8.8.8.8, 8.8.4.4<span class="hljs-comment">;  # DNSæœåŠ¡å™¨</span>
    option subnet-mask 255.255.255.0<span class="hljs-comment">;      # å­ç½‘æ©ç </span>
    option broadcast-address 192.168.200.255<span class="hljs-comment">;  # å¹¿æ’­åœ°å€</span>
    default-lease-time 600<span class="hljs-comment">;</span>
    max-lease-time 7200<span class="hljs-comment">;</span>
}
</code></pre>
<p>ä¿å­˜å¹¶å…³é—­æ–‡ä»¶ã€‚</p>
<p>é‡ç½®leasesæ–‡ä»¶å’Œæƒé™</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœæ­¢æœåŠ¡</span>
sudo systemctl stop isc-dhcp-server

<span class="hljs-comment"># å¤‡ä»½å¹¶é‡å»º leases æ–‡ä»¶</span>
sudo <span class="hljs-built_in">mv</span> /var/lib/dhcp/dhcpd.leases /var/lib/dhcp/dhcpd.leases.bak
<span class="hljs-comment"># æ²¡æœ‰å°±æ–°å»º</span>
sudo <span class="hljs-built_in">touch</span> /var/lib/dhcp/dhcpd.leases
sudo <span class="hljs-built_in">touch</span> /var/lib/dhcp/dhcpd.leases~

<span class="hljs-comment"># è®¾ç½®æ­£ç¡®æƒé™ï¼ˆå…³é”®ï¼‰</span>
sudo <span class="hljs-built_in">chown</span> -R root:root /var/lib/dhcp/
sudo <span class="hljs-built_in">chmod</span> 777 /var/lib/dhcp/
sudo <span class="hljs-built_in">chmod</span> 666 /var/lib/dhcp/dhcpd.leases
sudo <span class="hljs-built_in">chmod</span> 666 /var/lib/dhcp/dhcpd.leases~
</code></pre>
<p>æœ€ç»ˆçš„é…ç½®æ–‡ä»¶</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># dhcpd.conf</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Sample configuration file for ISC dhcpd</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Attention: If /etc/ltsp/dhcpd.conf exists, that will be used as</span>
<span class="hljs-comment"># configuration file instead of this file.</span>
<span class="hljs-comment">#</span>

<span class="hljs-comment"># option definitions common to all supported networks...</span>
option domain-name "example.org"<span class="hljs-comment">;</span>
option domain-name-servers ns1.example.org, ns2.example.org<span class="hljs-comment">;</span>

default-lease-time 600<span class="hljs-comment">;</span>
max-lease-time 7200<span class="hljs-comment">;</span>

<span class="hljs-comment"># The ddns-updates-style parameter controls whether or not the server will</span>
<span class="hljs-comment"># attempt to do a DNS update when a lease is confirmed. We default to the</span>
<span class="hljs-comment"># behavior of the version 2 packages ('none', since DHCP v2 didn't</span>
<span class="hljs-comment"># have support for DDNS.)</span>
ddns-update-style none<span class="hljs-comment">;</span>

<span class="hljs-comment"># If this DHCP server is the official DHCP server for the local</span>
<span class="hljs-comment"># network, the authoritative directive should be uncommented.</span>
authoritative<span class="hljs-comment">;</span>
ping-check false<span class="hljs-comment">;</span>
<span class="hljs-comment"># Use this to send dhcp log messages to a different log file (you also</span>
<span class="hljs-comment"># have to hack syslog.conf to complete the redirection).</span>
<span class="hljs-comment">#log-facility local7;</span>

<span class="hljs-comment"># No service will be given on this subnet, but declaring it helps the </span>
<span class="hljs-comment"># DHCP server to understand the network topology.</span>

<span class="hljs-comment">#subnet 10.152.187.0 netmask 255.255.255.0 {</span>
<span class="hljs-comment">#}</span>
<span class="hljs-comment"># åŒ¹é…ä½ çš„å®é™…ç½‘ç»œï¼š192.168.200.0/24</span>
subnet 192.168.200.0 netmask 255.255.255.0 {
    range 192.168.200.50 192.168.200.100<span class="hljs-comment">;  # IPåˆ†é…èŒƒå›´</span>
    option routers 192.168.200.1<span class="hljs-comment">;          # ç½‘å…³åœ°å€</span>
    option domain-name-servers 8.8.8.8, 8.8.4.4<span class="hljs-comment">;  # DNSæœåŠ¡å™¨</span>
    option subnet-mask 255.255.255.0<span class="hljs-comment">;      # å­ç½‘æ©ç </span>
    option broadcast-address 192.168.200.255<span class="hljs-comment">;  # å¹¿æ’­åœ°å€</span>
    default-lease-time 600<span class="hljs-comment">;</span>
    max-lease-time 7200<span class="hljs-comment">;</span>
}
<span class="hljs-comment"># This is a very basic subnet declaration.</span>

<span class="hljs-comment">#subnet 10.254.239.0 netmask 255.255.255.224 {</span>
<span class="hljs-comment">#  range 10.254.239.10 10.254.239.20;</span>
<span class="hljs-comment">#  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;</span>
<span class="hljs-comment">#}</span>


<span class="hljs-comment"># This declaration allows BOOTP clients to get dynamic addresses,</span>
<span class="hljs-comment"># which we don't really recommend.</span>

<span class="hljs-comment">#subnet 10.254.239.32 netmask 255.255.255.224 {</span>
<span class="hljs-comment">#  range dynamic-bootp 10.254.239.40 10.254.239.60;</span>
<span class="hljs-comment">#  option broadcast-address 10.254.239.31;</span>
<span class="hljs-comment">#  option routers rtr-239-32-1.example.org;</span>
<span class="hljs-comment">#}</span>

<span class="hljs-comment"># A slightly different configuration for an internal subnet.</span>
<span class="hljs-comment">#subnet 10.5.5.0 netmask 255.255.255.224 {</span>
<span class="hljs-comment">#  range 10.5.5.26 10.5.5.30;</span>
<span class="hljs-comment">#  option domain-name-servers ns1.internal.example.org;</span>
<span class="hljs-comment">#  option domain-name "internal.example.org";</span>
<span class="hljs-comment">#  option subnet-mask 255.255.255.224;</span>
<span class="hljs-comment">#  option routers 10.5.5.1;</span>
<span class="hljs-comment">#  option broadcast-address 10.5.5.31;</span>
<span class="hljs-comment">#  default-lease-time 600;</span>
<span class="hljs-comment">#  max-lease-time 7200;</span>
<span class="hljs-comment">#}</span>

<span class="hljs-comment"># Hosts which require special configuration options can be listed in</span>
<span class="hljs-comment"># host statements.   If no address is specified, the address will be</span>
<span class="hljs-comment"># allocated dynamically (if possible), but the host-specific information</span>
<span class="hljs-comment"># will still come from the host declaration.</span>

<span class="hljs-comment">#host passacaglia {</span>
<span class="hljs-comment">#  hardware ethernet 0:0:c0:5d:bd:95;</span>
<span class="hljs-comment">#  filename "vmunix.passacaglia";</span>
<span class="hljs-comment">#  server-name "toccata.example.com";</span>
<span class="hljs-comment">#}</span>

<span class="hljs-comment"># Fixed IP addresses can also be specified for hosts.   These addresses</span>
<span class="hljs-comment"># should not also be listed as being available for dynamic assignment.</span>
<span class="hljs-comment"># Hosts for which fixed IP addresses have been specified can boot using</span>
<span class="hljs-comment"># BOOTP or DHCP.   Hosts for which no fixed address is specified can only</span>
<span class="hljs-comment"># be booted with DHCP, unless there is an address range on the subnet</span>
<span class="hljs-comment"># to which a BOOTP client is connected which has the dynamic-bootp flag</span>
<span class="hljs-comment"># set.</span>
<span class="hljs-comment">#host fantasia {</span>
<span class="hljs-comment">#  hardware ethernet 08:00:07:26:c0:a5;</span>
<span class="hljs-comment">#  fixed-address fantasia.example.com;</span>
<span class="hljs-comment">#}</span>

<span class="hljs-comment"># You can declare a class of clients and then do address allocation</span>
<span class="hljs-comment"># based on that.   The example below shows a case where all clients</span>
<span class="hljs-comment"># in a certain class get addresses on the 10.17.224/24 subnet, and all</span>
<span class="hljs-comment"># other clients get addresses on the 10.0.29/24 subnet.</span>

<span class="hljs-comment">#class "foo" {</span>
<span class="hljs-comment">#  match if substring (option vendor-class-identifier, 0, 4) = "SUNW";</span>
<span class="hljs-comment">#}</span>

<span class="hljs-comment">#shared-network 224-29 {</span>
<span class="hljs-comment">#  subnet 10.17.224.0 netmask 255.255.255.0 {</span>
<span class="hljs-comment">#    option routers rtr-224.example.org;</span>
<span class="hljs-comment">#  }</span>
<span class="hljs-comment">#  subnet 10.0.29.0 netmask 255.255.255.0 {</span>
<span class="hljs-comment">#    option routers rtr-29.example.org;</span>
<span class="hljs-comment">#  }</span>
<span class="hljs-comment">#  pool {</span>
<span class="hljs-comment">#    allow members of "foo";</span>
<span class="hljs-comment">#    range 10.17.224.10 10.17.224.250;</span>
<span class="hljs-comment">#  }</span>
<span class="hljs-comment">#  pool {</span>
<span class="hljs-comment">#    deny members of "foo";</span>
<span class="hljs-comment">#    range 10.0.29.10 10.0.29.230;</span>
<span class="hljs-comment">#  }</span>
<span class="hljs-comment">#}</span>
</code></pre>
<h3 data-id="heading-11">é…ç½®ç½‘ç»œæ¥å£</h3>
<p>è¿™é‡Œéœ€è¦é…ç½®æ­£ç¡®çš„ç½‘ç»œæ¥å£</p>
<ol>
<li>ç¼–è¾‘<code>/etc/default/isc-dhcp-server</code>æ–‡ä»¶ï¼Œè®¾ç½®DHCPæœåŠ¡ç›‘å¬çš„ç½‘ç»œæ¥å£ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£ã€‚å¦‚æœéœ€è¦æŒ‡å®šç‰¹å®šæ¥å£ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š<br/>
sudo gedit /etc/default/isc-dhcp-server</li>
<li>æ‰¾åˆ°<code>INTERFACESv4</code>è¡Œï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºè¦ç›‘å¬çš„æ¥å£åç§°ï¼Œä¾‹å¦‚<code>ens33</code>,å…·ä½“è¦ç”¨ifconfigå¯ä»¥æŸ¥è¯¢åˆ°ï¼š<br/>
INTERFACESv4="ens33"</li>
<li>ä¿å­˜å¹¶å…³é—­æ–‡ä»¶ã€‚</li>
</ol>
<h3 data-id="heading-12">å¯åŠ¨å’Œå¯ç”¨DHCPæœåŠ¡</h3>
<ol>
<li>é‡å¯DHCPæœåŠ¡ä»¥åº”ç”¨æ›´æ”¹ï¼š<br/>
sudo systemctl restart isc-dhcp-server</li>
<li>ä½¿DHCPæœåŠ¡åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œï¼š<br/>
sudo systemctl enable isc-dhcp-server</li>
</ol>
<h3 data-id="heading-13">æµ‹è¯•DHCPæœåŠ¡</h3>
<ol>
<li>åœ¨å¦ä¸€å°è®¡ç®—æœºä¸Šï¼Œå°†å…¶ç½‘ç»œè®¾ç½®æ›´æ”¹ä¸ºè‡ªåŠ¨è·å–IPåœ°å€ï¼ˆDHCPï¼‰ã€‚<br/>
å¯ä»¥ä¸¤å°ç‰©ç†æœºï¼Œä¸€å°åšæœåŠ¡ï¼Œä¸€å°åšå®¢æˆ·æœºè®¾ç½®DHCPï¼Œç”¨ä¸€ä¸ªäº¤æ¢æœºæˆ–è€…ä¸€æ ¹ç½‘çº¿ç›´è¿å°±å¯ä»¥å®ç°ã€‚<br/>
å¦‚æœæ˜¯VMWareï¼Œå‚ç…§ä¹¦ä¸Šçš„åšå®éªŒï¼Œå°†ä¸¤å°è™šæ‹Ÿæœºè¿æ¥åœ¨ä¸€èµ·ï¼Œè™šæ‹Ÿç½‘å¡çš„DHCPæœåŠ¡å…³é—­ï¼Œä¸¤å°å¼€æœºå°±å¯ä»¥äº†ã€‚</li>
<li>é‡å¯è®¡ç®—æœºæˆ–æ–­å¼€å¹¶é‡æ–°è¿æ¥ç½‘ç»œã€‚</li>
<li>åœ¨æ–°è®¡ç®—æœºçš„å‘½ä»¤è¡Œä¸­ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ä»¥æŸ¥çœ‹åˆ†é…çš„IPåœ°å€ï¼š<br/>
ifconfig<br/>
æˆ–è€…<br/>
ip addr</li>
</ol>
<h2 data-id="heading-14">3.DNSæœåŠ¡éƒ¨ç½²</h2>
<p>DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰æ˜¯äº’è”ç½‘ä¸Šä¸å¯æˆ–ç¼ºçš„æœåŠ¡ä¹‹ä¸€ï¼Œå®ƒå°†æ˜“äºè®°å¿†çš„åŸŸåè½¬æ¢ä¸ºIPåœ°å€ã€‚åœ¨Ubuntuç³»ç»Ÿä¸­æ­å»ºDNSæœåŠ¡å™¨å¯¹äºç½‘ç»œç®¡ç†å’Œç»´æŠ¤è‡³å…³é‡è¦ã€‚</p>
<h3 data-id="heading-15">å®‰è£…BIND</h3>
<p>BINDï¼ˆBerkeley Internet Name Domainï¼‰æ˜¯Linuxç³»ç»Ÿä¸­å¸¸ç”¨çš„DNSæœåŠ¡å™¨è½¯ä»¶ã€‚ä»¥ä¸‹æ˜¯å®‰è£…BINDçš„æ­¥éª¤ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> <span class="hljs-keyword">update</span>
sudo apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> install bind9 bind9<span class="hljs-operator">-</span>utils
</code></pre>
<h3 data-id="heading-16">é…ç½®DNSæœåŠ¡å™¨</h3>
<h3 data-id="heading-17">1. ç¼–è¾‘ä¸»é…ç½®æ–‡ä»¶</h3>
<p>æ‰“å¼€ä¸»é…ç½®æ–‡ä»¶<code>/etc/bind/named.conf</code>ï¼Œæ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">zone <span class="hljs-string">"example.com"</span> IN {
        <span class="hljs-built_in">type</span> master;
        file <span class="hljs-string">"/etc/bind/zones/db.example.com"</span>;
};
</code></pre>
<h3 data-id="heading-18">2. åˆ›å»ºåŒºåŸŸæ–‡ä»¶</h3>
<p>åˆ›å»ºç›®å½•</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#ç¡®ä¿ç›®å½•å­˜åœ¨</span>
sudo <span class="hljs-built_in">mkdir</span> -p /etc/bind/zones
<span class="hljs-comment">#åœ¨`/etc/bind/zones/`ç›®å½•ä¸‹åˆ›å»ºåä¸º`db.example.com`çš„åŒºåŸŸæ–‡ä»¶</span>
sudo gedit /etc/bind/zones/db.example.com
</code></pre>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Fdb.example.com%25E7%259A%2584%25E7%25A4%25BA%25E4%25BE%258B%25E5%2586%2585%25E5%25AE%25B9%25E5%25A6%2582%25E4%25B8%258B%25EF%25BC%2588IP%25E5%258F%25AF%25E4%25BB%25A5%25E6%258D%25A2%25E6%2588%2590%25E4%25BD%25A0%25E8%2587%25AA%25E5%25B7%25B1%25E7%259A%2584%25E6%259C%25BA%25E5%2599%25A8IP%25EF%25BC%2589%25EF%25BC%259A" target="_blank" title="http://db.example.com%E7%9A%84%E7%A4%BA%E4%BE%8B%E5%86%85%E5%AE%B9%E5%A6%82%E4%B8%8B%EF%BC%88IP%E5%8F%AF%E4%BB%A5%E6%8D%A2%E6%88%90%E4%BD%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E6%9C%BA%E5%99%A8IP%EF%BC%89%EF%BC%9A" ref="nofollow noopener noreferrer">db.example.comçš„ç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼ˆIPå¯ä»¥æ¢æˆä½ è‡ªå·±çš„æœºå™¨IPï¼‰ï¼š</a></p>
<pre><code class="hljs language-ini" lang="ini">$TTL    604800
@       IN      SOA     ns1.example.com. admin.example.com. (
                          2023100401         <span class="hljs-comment">; Serial</span>
                          604800            <span class="hljs-comment">; Refresh</span>
                          86400             <span class="hljs-comment">; Retry</span>
                          2419200           <span class="hljs-comment">; Expire</span>
                          604800 )          <span class="hljs-comment">; Negative Cache TTL</span>
<span class="hljs-comment">;</span>
@       IN      NS      ns1.example.com.
ns1     IN      A       192.168.1.10
www     IN      A       192.168.1.11
</code></pre>
<h3 data-id="heading-19">3. é…ç½®DNSè§£æ</h3>
<p>åœ¨<code>/etc/resolv.conf</code>æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">nameserver <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
<span class="hljs-keyword">search</span> example.com
</code></pre>
<h3 data-id="heading-20">å¯åŠ¨å’Œæµ‹è¯•DNSæœåŠ¡å™¨</h3>
<h3 data-id="heading-21">1. å¯åŠ¨DNSæœåŠ¡å™¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#å¯åŠ¨æœåŠ¡</span>
sudo systemctl restart bind9
<span class="hljs-comment">#è®¾ç½®å¼€æœºå¯åŠ¨</span>
sudo systemctl <span class="hljs-built_in">enable</span> bind9
<span class="hljs-comment">#ç¡®è®¤æœåŠ¡çŠ¶æ€</span>
sudo systemctl status bind9
</code></pre>
<h3 data-id="heading-22">2. æµ‹è¯•DNSè§£æ</h3>
<p>ä½¿ç”¨<code>nslookup</code>å‘½ä»¤æµ‹è¯•DNSè§£æï¼š</p>
<pre><code class="hljs">nslookup www.example.com
</code></pre>
<p>å¦‚æœç»“æœæ˜¾ç¤ºè§£æåˆ°çš„IPåœ°å€æ­£ç¡®ï¼Œåˆ™è¡¨ç¤ºDNSæœåŠ¡å™¨é…ç½®æˆåŠŸã€‚</p>
<h2 data-id="heading-23">4.ApacheæœåŠ¡éƒ¨ç½²</h2>
<p>ApacheæœåŠ¡å™¨æ˜¯ä¸€æ¬¾å¹¿æ³›ä½¿ç”¨çš„å¼€æºWebæœåŠ¡å™¨è½¯ä»¶ï¼Œå› å…¶ç¨³å®šæ€§å’ŒåŠŸèƒ½å¼ºå¤§è€Œå¤‡å—é’çã€‚åœ¨Ubuntuç³»ç»Ÿä¸‹ï¼Œå®‰è£…å’Œé…ç½®ApacheæœåŠ¡å™¨ç›¸å¯¹ç®€å•ã€‚æœ¬æ–‡å°†ä¸ºæ‚¨è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨Ubuntuç³»ç»Ÿä¸‹å¿«é€Ÿå¯åŠ¨å’Œé…ç½®ApacheæœåŠ¡å™¨ã€‚</p>
<h3 data-id="heading-24">å‡†å¤‡å·¥ä½œ</h3>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„Ubuntuç³»ç»Ÿå·²ç»æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ›´æ–°ç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span>
sudo apt upgrade
</code></pre>
<p>ç¡®ä¿80ç«¯å£å¯ç”¨ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">sudo netstat -tlnp | <span class="hljs-keyword">grep</span> :<span class="hljs-number">80</span>
</code></pre>
<p>å¦‚æœè¾“å‡ºä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿä¸Šæ²¡æœ‰å…¶ä»–WebæœåŠ¡å™¨ã€‚</p>
<h3 data-id="heading-25">å®‰è£…ApacheæœåŠ¡å™¨</h3>
<ol>
<li>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ApacheæœåŠ¡å™¨ï¼š</li>
</ol>

<pre><code class="hljs">sudo apt install apache2 -y
</code></pre>
<p>åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿå¯èƒ½ä¼šæç¤ºæ‚¨è¾“å…¥å¯†ç ä»¥ç¡®è®¤å®‰è£…ã€‚</p>
<ol>
<li>å®‰è£…å®Œæˆåï¼Œå¯åŠ¨ApacheæœåŠ¡ï¼š</li>
</ol>

<pre><code class="hljs">sudo systemctl restart apache2
</code></pre>
<ol>
<li>è®¾ç½®å¼€æœºè‡ªå¯æœåŠ¡ï¼Œä»¥ä¾¿åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨ApacheæœåŠ¡ï¼š</li>
</ol>

<pre><code class="hljs language-bash" lang="bash">sudo systemctl <span class="hljs-built_in">enable</span> apache2
</code></pre>
<ol>
<li>æ£€æŸ¥ApacheæœåŠ¡çš„çŠ¶æ€ï¼Œç¡®ä¿å®ƒæ­£åœ¨è¿è¡Œï¼š</li>
</ol>

<pre><code class="hljs language-lua" lang="lua">sudo systemctl <span class="hljs-built_in">status</span> apache2
</code></pre>
<h3 data-id="heading-26">é…ç½®ApacheæœåŠ¡å™¨</h3>
<p>ApacheæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ä½äº<code>/etc/apache2/</code>ç›®å½•ä¸‹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›åŸºæœ¬çš„é…ç½®æ­¥éª¤ï¼š</p>
<h3 data-id="heading-27">1. ä¿®æ”¹é»˜è®¤ç½‘ç«™æ–‡æ¡£æ ¹ç›®å½•</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒApacheæœåŠ¡å™¨å°†ç½‘ç«™æ–‡æ¡£æ ¹ç›®å½•è®¾ç½®ä¸º<code>/var/www/html/</code>ã€‚æ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹è¯¥ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo gedit /etc/apache2/apache2.conf
</code></pre>
<p>æ‰¾åˆ°ä»¥ä¸‹è¡Œå¹¶ä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-css" lang="css">DocumentRoot /<span class="hljs-selector-tag">var</span>/www/<span class="hljs-selector-tag">html</span>/
</code></pre>
<p>å°†<code>/var/www/html/</code>æ›¿æ¢ä¸ºæ‚¨æƒ³è¦è®¾ç½®çš„ç›®å½•ã€‚</p>
<h2 data-id="heading-28">5.FTPæœåŠ¡éƒ¨ç½²</h2>
<p>åœ¨æ•°å­—åŒ–æ—¶ä»£ï¼Œæ–‡ä»¶ä¼ è¾“æ˜¯æ—¥å¸¸å·¥ä½œä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚FTPï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰ä½œä¸ºä¸€é¡¹åŸºç¡€çš„äº’è”ç½‘æœåŠ¡ï¼Œå¹¿æ³›åº”ç”¨äºæ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½ã€‚å¯¹ç”¨æˆ·æ¥è¯´ï¼ŒæŒæ¡FTPæ–‡ä»¶ä¼ è¾“æ˜¯ä¸€é¡¹åŸºæœ¬æŠ€èƒ½ã€‚</p>
<p>Windowsä¸‹ï¼Œå¯ä»¥ä¸‹è½½filezilla serverå¿«é€Ÿåˆ›å»ºï¼Œå®¢æˆ·ç«¯æ— è®ºæ˜¯é“¶æ²³éº’éºŸè¿˜æ˜¯Windowséƒ½å¯ä»¥ä½¿ç”¨filezilla clientã€‚</p>
<h3 data-id="heading-29">ä¸€ã€FTPåŸºç¡€</h3>
<h3 data-id="heading-30">1.1 ä»€ä¹ˆæ˜¯FTPï¼Ÿ</h3>
<p>FTPï¼ˆFile Transfer Protocolï¼‰æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œç”¨äºåœ¨ç½‘ç»œä¸Šè¿›è¡Œæ–‡ä»¶ä¼ è¾“ã€‚å®ƒå…è®¸ç”¨æˆ·åœ¨ç½‘ç»œä¸Šå…±äº«æ–‡ä»¶ã€æ–‡ä»¶å¤¹ä»¥åŠä¸Šä¼ æˆ–ä¸‹è½½æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-31">1.2 FTPå·¥ä½œåŸç†</h3>
<p>FTPåŸºäºå®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹ï¼Œç”±FTPå®¢æˆ·ç«¯å’ŒFTPæœåŠ¡å™¨ç»„æˆã€‚å®¢æˆ·ç«¯æ˜¯ç”¨æˆ·ç”¨æ¥ä¸Šä¼ ã€ä¸‹è½½å’Œç®¡ç†æ–‡ä»¶çš„åº”ç”¨ç¨‹åºï¼Œè€ŒæœåŠ¡å™¨åˆ™æ˜¯å­˜å‚¨æ–‡ä»¶å¹¶å¤„ç†ç”¨æˆ·è¿æ¥è¯·æ±‚çš„æœåŠ¡å™¨ç¨‹åºã€‚</p>
<h3 data-id="heading-32">äºŒã€å®‰è£…FTPæœåŠ¡å™¨</h3>
<h3 data-id="heading-33">2.1 ä½¿ç”¨vsftpd</h3>
<p>Ubuntuç³»ç»Ÿé€šå¸¸é¢„è£…äº†vsftpdï¼ˆVery Secure FTP Daemonï¼‰ï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„FTPæœåŠ¡å™¨ä¹‹ä¸€ã€‚</p>
<h3 data-id="heading-34">2.1.1 å®‰è£…vsftpd</h3>
<pre><code class="hljs language-bash" lang="bash">sudo apt-get install vsftpd -y
sudo ufw <span class="hljs-built_in">disable</span>  <span class="hljs-comment"># ä¸´æ—¶å…³é—­ï¼ˆæµ‹è¯•ç”¨ï¼‰</span>
</code></pre>
<h3 data-id="heading-35">2.1.2 é…ç½®vsftpd</h3>
<p>å®‰è£…å®Œæˆåï¼Œå¯ä»¥ç¼–è¾‘é…ç½®æ–‡ä»¶Â <code>/etc/vsftpd.conf</code>Â æ¥è‡ªå®šä¹‰FTPæœåŠ¡å™¨çš„è¡Œä¸ºã€‚</p>
<pre><code class="hljs language-bash" lang="bash">sudo gedit /etc/vsftpd.conf
</code></pre>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥è®¾ç½®ç”¨æˆ·æƒé™ã€åŒ¿åè®¿é—®ã€æ•°æ®ä¼ è¾“æ¨¡å¼ç­‰ã€‚</p>
<p>å°†é»˜è®¤è®¾ç½®æ”¹ä¸ºå¦‚ä¸‹ï¼ˆç®€åŒ–çš„é…ç½®ï¼Œç¡®ä¿ftpæœåŠ¡æ­£å¸¸å¯åŠ¨)</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># åŸºç¡€é…ç½®</span>
<span class="hljs-attr">listen</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">listen_ipv6</span>=<span class="hljs-literal">NO</span>
<span class="hljs-attr">anonymous_enable</span>=<span class="hljs-literal">NO</span>
<span class="hljs-attr">local_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">write_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">local_umask</span>=<span class="hljs-number">022</span>

<span class="hljs-comment"># ç›®å½•é…ç½®</span>
<span class="hljs-attr">dirmessage_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">use_localtime</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">xferlog_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">connect_from_port_20</span>=<span class="hljs-literal">YES</span>

<span class="hljs-comment"># å®‰å…¨é…ç½®</span>
<span class="hljs-attr">chroot_local_user</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">allow_writeable_chroot</span>=<span class="hljs-literal">YES</span>

<span class="hljs-comment"># ç”¨æˆ·æ§åˆ¶</span>
<span class="hljs-attr">userlist_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">userlist_file</span>=/etc/vsftpd.userlist
<span class="hljs-attr">userlist_deny</span>=<span class="hljs-literal">NO</span>

<span class="hljs-comment"># å…¶ä»–å¿…è¦é…ç½®</span>
<span class="hljs-attr">secure_chroot_dir</span>=/var/run/vsftpd/empty
<span class="hljs-attr">pam_service_name</span>=vsftpd
<span class="hljs-attr">rsa_cert_file</span>=/etc/ssl/certs/ssl-cert-snakeoil.pem
<span class="hljs-attr">rsa_private_key_file</span>=/etc/ssl/private/ssl-cert-snakeoil.key
<span class="hljs-attr">ssl_enable</span>=<span class="hljs-literal">NO</span>
<span class="hljs-attr">utf8_filesystem</span>=<span class="hljs-literal">YES</span>
</code></pre>
<h3 data-id="heading-36">ä½¿ç”¨è™šæ‹Ÿç”¨æˆ·</h3>
<p>åˆ›å»ºç‹¬ç«‹çš„è™šæ‹Ÿç”¨æˆ·ï¼Œä¸ä½¿ç”¨ç³»ç»Ÿç”¨æˆ·ï¼Œå®‰å…¨æ€§æ›´é«˜ï¼š</p>
<ol>
<li>å®‰è£…å¿…è¦å·¥å…·</li>
</ol>

<pre><code class="hljs">sudo apt install libpam-pwdfile
</code></pre>
<ol>
<li>åˆ›å»ºè™šæ‹Ÿç”¨æˆ·å¯†ç æ–‡ä»¶</li>
</ol>

<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">mkdir</span> /etc/vsftpd <span class="hljs-comment">#å¦‚æœæ²¡æœ‰å­˜åœ¨å°±å»ºä¸€ä¸ª</span>
<span class="hljs-comment"># åˆ›å»ºå¯†ç æ–‡ä»¶å¹¶æ·»åŠ ç”¨æˆ·</span>
sudo <span class="hljs-built_in">touch</span> /etc/vsftpd/virtual_users.passwd
sudo <span class="hljs-built_in">chmod</span> 600 /etc/vsftpd/virtual_users.passwd

<span class="hljs-comment"># æ·»åŠ è™šæ‹Ÿç”¨æˆ·ï¼ˆæ›¿æ¢ yourpassword ä¸ºå®é™…å¯†ç ï¼‰</span>
sudo htpasswd -b /etc/vsftpd/virtual_users.passwd virtualuser1 yourpassword1
sudo htpasswd -b /etc/vsftpd/virtual_users.passwd virtualuser2 yourpassword2
</code></pre>
<ol>
<li>é…ç½® PAM è®¤è¯</li>
</ol>
<p>åˆ›å»ºÂ <code>/etc/pam.d/vsftpd.virtual</code>Â æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">sudo gedit /etc/pam.d/vsftpd.<span class="hljs-keyword">virtual</span>
</code></pre>
<p>æ·»åŠ å†…å®¹ï¼š</p>
<pre><code class="hljs language-swift" lang="swift">auth    <span class="hljs-keyword">required</span>    pam_pwdfile.so pwdfile <span class="hljs-operator">/</span>etc<span class="hljs-operator">/</span>vsftpd<span class="hljs-operator">/</span>virtual_users.passwd
account <span class="hljs-keyword">required</span>    pam_permit.so
</code></pre>
<ol>
<li>åˆ›å»ºè™šæ‹Ÿç”¨æˆ·æ˜ å°„çš„ç³»ç»Ÿç”¨æˆ·</li>
</ol>

<pre><code class="hljs language-arduino" lang="arduino">sudo useradd -d /data/ftp/<span class="hljs-keyword">virtual</span> -s /usr/sbin/nologin <span class="hljs-keyword">virtual</span>
sudo mkdir -p /data/ftp/<span class="hljs-keyword">virtual</span>/{virtualuser1,virtualuser2}
sudo chown -R <span class="hljs-keyword">virtual</span>:<span class="hljs-keyword">virtual</span> /data/ftp/<span class="hljs-keyword">virtual</span>
</code></pre>
<ol>
<li>ä¿®æ”¹ vsftpd.conf é…ç½®</li>
</ol>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯ç”¨è™šæ‹Ÿç”¨æˆ·</span>
<span class="hljs-attr">guest_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">guest_username</span>=virtual
<span class="hljs-attr">virtual_use_local_privs</span>=<span class="hljs-literal">YES</span>

<span class="hljs-comment"># PAM é…ç½®</span>
<span class="hljs-attr">pam_service_name</span>=vsftpd.virtual

<span class="hljs-comment"># ç”¨æˆ·é…ç½®ç›®å½•</span>
<span class="hljs-attr">user_config_dir</span>=/etc/vsftpd/user_conf
</code></pre>
<ol>
<li>åˆ›å»ºç”¨æˆ·ç‹¬ç«‹é…ç½®</li>
</ol>

<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">mkdir</span> -p /etc/vsftpd/user_conf

<span class="hljs-comment"># ä¸º virtualuser1 åˆ›å»ºé…ç½®</span>
sudo gedit /etc/vsftpd/user_conf/virtualuser1
</code></pre>
<p>æ·»åŠ å†…å®¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">local_root</span>=/data/ftp/virtual/virtualuser1
<span class="hljs-attr">write_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">anon_upload_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">anon_mkdir_write_enable</span>=<span class="hljs-literal">YES</span>
</code></pre>
<p>åŒç†ä¸º virtualuser2 åˆ›å»ºé…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo gedit /etc/vsftpd/user_conf/virtualuser2
</code></pre>
<p>æ·»åŠ å†…å®¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">local_root</span>=/data/ftp/virtual/virtualuser2
<span class="hljs-attr">write_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">anon_upload_enable</span>=<span class="hljs-literal">YES</span>
<span class="hljs-attr">anon_mkdir_write_enable</span>=<span class="hljs-literal">YES</span>
</code></pre>
<h3 data-id="heading-37">2.1.3 é‡å¯vsftpd</h3>
<p>é…ç½®å®Œæˆåï¼Œé‡å¯vsftpdä»¥åº”ç”¨æ›´æ”¹ã€‚</p>
<pre><code class="hljs language-lua" lang="lua">sudo systemctl restart vsftpd
sudo systemctl <span class="hljs-built_in">status</span> vsftpd
</code></pre>
<h3 data-id="heading-38">2.2 è®¾ç½®å¼€æœºè‡ªå¯</h3>
<p>ä¸ºäº†ç¡®ä¿FTPæœåŠ¡åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œï¼Œå¯ä»¥å°†vsftpdè®¾ç½®ä¸ºå¼€æœºè‡ªå¯ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl <span class="hljs-built_in">enable</span> vsftpd
</code></pre>
<p>åœ¨æ–‡ä»¶æµè§ˆä¸­è¾“å…¥æœåŠ¡çš„IPåœ°å€</p>
<pre><code class="hljs language-arduino" lang="arduino">ftp:<span class="hljs-comment">//192.168.10.200</span>
</code></pre>
<h2 data-id="heading-39">6.SambaæœåŠ¡éƒ¨ç½²</h2>
<p>Sambaæ˜¯ä¸€ç§å…è®¸Unix-likeç³»ç»Ÿï¼ˆå¦‚Ubuntuï¼‰ä¸å…¶ä»–Windowsç³»ç»Ÿä¹‹é—´è¿›è¡Œæ–‡ä»¶å’Œæ‰“å°æœºå…±äº«çš„åè®®ã€‚é€šè¿‡é…ç½®Sambaï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¹‹é—´å…±äº«æ–‡ä»¶å’Œæ‰“å°æœºã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨Ubuntuä¸Šé…ç½®Sambaï¼Œå®ç°è·¨å¹³å°æ–‡ä»¶å…±äº«ã€‚</p>
<h3 data-id="heading-40">Sambaçš„åŸºæœ¬æ¦‚å¿µ</h3>
<p>åœ¨å¼€å§‹é…ç½®ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p>
<ul>
<li><strong>SMB/CIFS</strong>ï¼šSambaåŸºäºSMBï¼ˆServer Message Blockï¼‰å’ŒCIFSï¼ˆCommon Internet File Systemï¼‰åè®®ï¼Œè¿™äº›åè®®æ˜¯Windowsæ–‡ä»¶å…±äº«çš„åŸºç¡€ã€‚</li>
<li><strong>SambaæœåŠ¡å™¨</strong>ï¼šè¿è¡ŒSambaè½¯ä»¶çš„è®¡ç®—æœºï¼Œå®ƒå…è®¸å…¶ä»–è®¡ç®—æœºè®¿é—®å…±äº«èµ„æºã€‚</li>
<li><strong>Sambaå®¢æˆ·ç«¯</strong>ï¼šè¿æ¥åˆ°SambaæœåŠ¡å™¨å¹¶è®¿é—®å…±äº«èµ„æºçš„è®¡ç®—æœºã€‚</li>
</ul>
<h3 data-id="heading-41">å®‰è£…Samba</h3>
<p>åœ¨Ubuntuä¸Šå®‰è£…Sambaéå¸¸ç®€å•ã€‚æ‰“å¼€ç»ˆç«¯å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span>
sudo apt install samba samba<span class="hljs-operator">-</span>common
</code></pre>
<h3 data-id="heading-42">é…ç½®Samba</h3>
<p>Sambaçš„é…ç½®æ–‡ä»¶ä½äº<code>/etc/samba/</code>ç›®å½•ä¸‹ï¼Œä¸»è¦çš„é…ç½®æ–‡ä»¶æ˜¯<code>smb.conf</code>ã€‚</p>
<h3 data-id="heading-43">ç¼–è¾‘smb.confæ–‡ä»¶</h3>
<p>æ‰“å¼€<code>smb.conf</code>æ–‡ä»¶è¿›è¡Œç¼–è¾‘ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">cp</span> /etc/samba/smb.conf /etc/samba/smb.conf.bak <span class="hljs-comment">#å…ˆå¤‡ä»½</span>
sudo gedit /etc/samba/smb.conf <span class="hljs-comment">#å†ä¿®æ”¹</span>
</code></pre>
<h3 data-id="heading-44">åŸºæœ¬é…ç½®</h3>
<p>åœ¨<code>smb.conf</code>æ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ°<code>[global]</code>éƒ¨åˆ†ï¼Œè¿›è¡Œä»¥ä¸‹é…ç½®(smb.confæœ€å°é…ç½®ï¼Œç¡®ä¿æœåŠ¡å¯åŠ¨)ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[global]</span>
    <span class="hljs-attr">workgroup</span> = WORKGROUP
    <span class="hljs-attr">security</span> = user

<span class="hljs-section">[myshare]</span>
    <span class="hljs-attr">path</span> = /srv/samba/myshare
    <span class="hljs-attr">writable</span> = <span class="hljs-literal">yes</span>
    valid <span class="hljs-attr">users</span> = user1 user2  <span class="hljs-comment"># åªå…è®¸è¿™ä¸¤ä¸ªç”¨æˆ·è®¿é—®</span>
</code></pre>
<h3 data-id="heading-45">é…ç½®ç”¨æˆ·</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå…±äº«ç›®å½•</strong></p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">mkdir</span> -p /srv/samba/myshare
sudo <span class="hljs-built_in">chmod</span> 777 /srv/samba/myshare  <span class="hljs-comment"># ç®€å•è®¾ç½®æƒé™</span>
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºç”¨æˆ·å¹¶è®¾ç½®å¯†ç </strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºç³»ç»Ÿç”¨æˆ·ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰</span>
sudo useradd user1
sudo useradd user2

<span class="hljs-comment"># è®¾ç½®Sambaå¯†ç ï¼ˆå…³é”®ï¼ï¼‰</span>
sudo smbpasswd -a user1  <span class="hljs-comment"># æŒ‰æç¤ºè¾“å…¥å¯†ç </span>
sudo smbpasswd -a user2  <span class="hljs-comment"># æŒ‰æç¤ºè¾“å…¥å¯†ç </span>
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šé‡å¯æœåŠ¡</strong></p>
<pre><code class="hljs">sudo systemctl restart smbd
</code></pre>
<p>æ›´ç®€å•çš„ "ä»»ä½•äººå¯è®¿é—®" é…ç½®ï¼ˆå¦‚æœä¸éœ€è¦é™åˆ¶ç”¨æˆ·ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[global]</span>
    <span class="hljs-attr">workgroup</span> = WORKGROUP
    <span class="hljs-attr">security</span> = user
    map to <span class="hljs-attr">guest</span> = Bad User

<span class="hljs-section">[public]</span>
    <span class="hljs-attr">path</span> = /srv/samba/public
    <span class="hljs-attr">writable</span> = <span class="hljs-literal">yes</span>
    guest <span class="hljs-attr">ok</span> = <span class="hljs-literal">yes</span>  <span class="hljs-comment"># å…è®¸åŒ¿åè®¿é—®</span>
</code></pre>
<h3 data-id="heading-46">é‡å¯SambaæœåŠ¡</h3>
<p>å®Œæˆé…ç½®åï¼Œé‡å¯SambaæœåŠ¡ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š</p>
<pre><code class="hljs">sudo systemctl restart smbd
sudo systemctl restart nmbd
</code></pre>
<h3 data-id="heading-47">æµ‹è¯•Sambaå…±äº«</h3>
<p>åœ¨Windowsä¸Šï¼Œæ‚¨å¯ä»¥æ‰“å¼€â€œæ–‡ä»¶èµ„æºç®¡ç†å™¨â€ï¼Œåœ¨åœ°å€æ ä¸­è¾“å…¥SambaæœåŠ¡å™¨çš„IPåœ°å€ï¼Œç„¶åè¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç å³å¯è®¿é—®å…±äº«æ–‡ä»¶å¤¹ã€‚</p>
<pre><code class="hljs">\192.168.10.200
</code></pre>
<h2 data-id="heading-48">7.nginxæœåŠ¡éƒ¨ç½²</h2>
<p>Nginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†webæœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæ˜¯IMAP/POP3/SMTPæœåŠ¡çš„æä¾›è€…ã€‚ç”±äºå…¶è½»é‡çº§å’Œé«˜å¹¶å‘å¤„ç†èƒ½åŠ›ï¼ŒNginxåœ¨äº’è”ç½‘ä¸­å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨Ubuntuç³»ç»Ÿä¸Šä»é›¶å¼€å§‹å®‰è£…å’Œé…ç½®Nginxã€‚</p>
<p>æ³¨æ„ï¼šApacheé»˜è®¤ä¹Ÿæ˜¯80ç«¯å£ï¼Œå°†apacheæœåŠ¡åœæ‰ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨nginxé…ç½®ä¸­ï¼Œæ”¹æ‰å•†å“ï¼Œæ”¹æˆ8080ï¼Œ8090ç­‰å…¶ä»–çš„ç«¯å£</p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl <span class="hljs-built_in">disable</span> apache2 <span class="hljs-comment">#åœæ­¢å¼€æœºå¯åŠ¨</span>
sudo systemctl stop apache2 <span class="hljs-comment">#åœæ­¢æœåŠ¡</span>
sudo reboot <span class="hljs-comment">#é‡å¯ç³»ç»Ÿ</span>
</code></pre>
<p>ç¡®ä¿80ç«¯å£å¯ç”¨ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">sudo netstat -tlnp | <span class="hljs-keyword">grep</span> :<span class="hljs-number">80</span>
</code></pre>
<p>å¦‚æœè¾“å‡ºä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿä¸Šæ²¡æœ‰å…¶ä»–WebæœåŠ¡å™¨ã€‚</p>
<h3 data-id="heading-49">å®‰è£…Nginx</h3>
<h3 data-id="heading-50">æ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•</h3>
<p>åœ¨å®‰è£…Nginxä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦æ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span>
</code></pre>
<h3 data-id="heading-51">å®‰è£…Nginx</h3>
<p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…Nginxï¼š</p>
<pre><code class="hljs">sudo apt install nginx
</code></pre>
<p>å®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæç¤ºæ‚¨ç¡®è®¤å®‰è£…ï¼Œè¾“å…¥<code>Y</code>å¹¶æŒ‰å›è½¦ç»§ç»­ã€‚</p>
<h3 data-id="heading-52">éªŒè¯å®‰è£…</h3>
<p>å®‰è£…å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯Nginxæ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>
<pre><code class="hljs">nginx -v
</code></pre>
<p>å¦‚æœçœ‹åˆ°Nginxçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚</p>
<h3 data-id="heading-53">å¯åŠ¨å’Œåœæ­¢Nginx</h3>
<h3 data-id="heading-54">å¯åŠ¨Nginx</h3>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨Nginxï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo systemctl <span class="hljs-keyword">start</span> nginx
</code></pre>
<h3 data-id="heading-55">åœæ­¢Nginx</h3>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœæ­¢Nginxï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">sudo systemctl stop nginx
</code></pre>
<h3 data-id="heading-56">é‡å¯Nginx</h3>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é‡å¯Nginxï¼š</p>
<pre><code class="hljs">sudo systemctl restart nginx
</code></pre>
<h3 data-id="heading-57">è®¾ç½®Nginxå¼€æœºè‡ªå¯</h3>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è®¾ç½®Nginxå¼€æœºè‡ªå¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl <span class="hljs-built_in">enable</span> nginx
</code></pre>
<h3 data-id="heading-58">é…ç½®Nginx</h3>
<h3 data-id="heading-59">æŸ¥çœ‹é»˜è®¤é…ç½®æ–‡ä»¶</h3>
<p>Nginxçš„é»˜è®¤é…ç½®æ–‡ä»¶ä½äº<code>/etc/nginx/nginx.conf</code>ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo vim /etc/nginx/nginx.conf
</code></pre>
<h3 data-id="heading-60">ç¼–è¾‘é»˜è®¤é…ç½®æ–‡ä»¶</h3>
<p>æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ä¿®æ”¹å†…å®¹ï¼š</p>
<ul>
<li>ä¿®æ”¹æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£</li>
<li>é…ç½®æœåŠ¡å™¨æ ¹ç›®å½•</li>
<li>é…ç½®åå‘ä»£ç†</li>
</ul>
<p>è¿™é‡Œé¢å¯ä»¥é»˜è®¤ç›‘å¬ç«¯å£å’Œç½‘ç«™æ–‡ä»¶ç›®å½•</p>
<pre><code class="hljs language-arduino" lang="arduino">/etc/nginx/sites-enabled/<span class="hljs-keyword">default</span>
</code></pre>
<h3 data-id="heading-61">å†…å®¹å¦‚ä¸‹</h3>
<pre><code class="hljs language-ini" lang="ini">server {
    listen 809default_server<span class="hljs-comment">;</span>
    listen <span class="hljs-section">[::]</span>:80 default_server<span class="hljs-comment">;</span>
    root /var/www/html<span class="hljs-comment">;</span>
    <span class="hljs-comment"># Add index.php to the list if you are using PHP</span>
    index index.html index.htm index.nginx-debian.html<span class="hljs-comment">;</span>
    server_name _<span class="hljs-comment">;</span>
    location / {
            <span class="hljs-comment"># First attempt to serve request as file, then</span>
            <span class="hljs-comment"># as directory, then fall back to displaying a 404.</span>
            try_files $uri $uri/ =404<span class="hljs-comment">;</span>
    }
}
</code></pre>
<h3 data-id="heading-62">é‡è½½Nginxé…ç½®</h3>
<p>é‡æ–°åŠ è½½Nginxé…ç½®ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š</p>
<pre><code class="hljs">sudo systemctl reload nginx
</code></pre>
<h3 data-id="heading-63">æµ‹è¯•ç½‘ç«™</h3>
<p>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥æ‚¨çš„æœåŠ¡å™¨IPåœ°å€ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæ‚¨åº”è¯¥èƒ½çœ‹åˆ°Nginxçš„é»˜è®¤æ¬¢è¿é¡µé¢ã€‚</p>
<p>æ³¨ï¼šæœ¬æ–‡å‚è€ƒäº†<a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Flink.segmentfault.com%2F%253Fenc%253DKYCoadOOa0Cp%25252B9TyW3z1FA%25253D%25253D.mGVfIt48Wa8wrrEj61B1o5hZ84k%25252FG%25252FbmjkAL9PW0Kiw%25253D" target="_blank" title="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DKYCoadOOa0Cp%252B9TyW3z1FA%253D%253D.mGVfIt48Wa8wrrEj61B1o5hZ84k%252FG%252FbmjkAL9PW0Kiw%253D" ref="nofollow noopener noreferrer">www.oryoy.com/</a>ä¸Šçš„Ubuntuè½»æ¾ä¸Šæ‰‹ç³»åˆ—æ•™ç¨‹</p>
<h2 data-id="heading-64">å†™åœ¨æœ€å</h2>
<p>æœ¬ç¯‡ä¸»è¦ç›®æ ‡æ˜¯å‘Šè¯‰å¤§å®¶æ€ä¹ˆç®€å•å¿«é€Ÿçš„éƒ¨ç½²å¸¸è§çš„æœåŠ¡</p>
<p>ä¿¡åˆ›å¼€æºèµ„æºï¼Œå°½åœ¨XPlazaï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpreadJS è‡ªå®šä¹‰å‡½æ•°å®æˆ˜æŒ‡å—ï¼šä»å…¥é—¨åˆ°é¿å‘]]></title>    <link>https://juejin.cn/post/7579093412332634122</link>    <guid>https://juejin.cn/post/7579093412332634122</guid>    <pubDate>2025-12-03T02:34:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579093412332634122" data-draft-id="7579111646875238451" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpreadJS è‡ªå®šä¹‰å‡½æ•°å®æˆ˜æŒ‡å—ï¼šä»å…¥é—¨åˆ°é¿å‘"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-03T02:34:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‘¡è„åŸæŠ€æœ¯å›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3227821868332765"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpreadJS è‡ªå®šä¹‰å‡½æ•°å®æˆ˜æŒ‡å—ï¼šä»å…¥é—¨åˆ°é¿å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3227821868332765/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‘¡è„åŸæŠ€æœ¯å›¢é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:34:00.000Z" title="Wed Dec 03 2025 02:34:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">SpreadJS è‡ªå®šä¹‰å‡½æ•°å®æˆ˜æŒ‡å—ï¼šä»å…¥é—¨åˆ°é¿å‘</h2>
<p>åœ¨ä¼ä¸šçº§è¡¨æ ¼åº”ç”¨å¼€å‘ä¸­ï¼Œå†…ç½®å‡½æ•°å¾€å¾€éš¾ä»¥æ»¡è¶³å¤æ‚çš„ä¸šåŠ¡é€»è¾‘éœ€æ±‚ã€‚SpreadJS ä½œä¸ºä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ç±» Excel è¡¨æ ¼æ§ä»¶ï¼Œæä¾›äº†çµæ´»çš„<strong>è‡ªå®šä¹‰å‡½æ•°ï¼ˆCustom Functionï¼‰</strong> èƒ½åŠ›ï¼Œè®©å¼€å‘è€…å¯ä»¥åƒä½¿ç”¨ SUMã€VLOOKUP é‚£æ ·ï¼Œåœ¨å•å…ƒæ ¼å…¬å¼ä¸­ç›´æ¥è°ƒç”¨è‡ªå·±ç¼–å†™çš„é€»è¾‘ã€‚æœ¬æ–‡å°†å›´ç»•â€œä»€ä¹ˆæ˜¯è‡ªå®šä¹‰å‡½æ•°â€ã€â€œå¦‚ä½•å®ç°â€ã€â€œå¼‚æ­¥åœºæ™¯å¤„ç†â€ä»¥åŠâ€œæ–°æ‰‹é¿å‘æŒ‡å—â€å››ä¸ªç»´åº¦ï¼Œå¸¦ä½ å…¨é¢æŒæ¡ SpreadJS è‡ªå®šä¹‰å‡½æ•°çš„å¼€å‘æŠ€å·§ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰å‡½æ•°ï¼Ÿ</h3>
<p>å‡½æ•°çš„æœ¬è´¨æ˜¯â€œå°è£…å¥½çš„ä»£ç ç‰‡æ®µâ€ã€‚ç”¨æˆ·é€šè¿‡ç®€å•è°ƒç”¨ï¼ˆå¦‚ <code>=SUM(A1:A10)</code>ï¼‰ï¼Œå³å¯å®Œæˆå¤æ‚æ“ä½œï¼Œæ— éœ€é‡å¤ç¼–å†™é€»è¾‘ã€‚SpreadJS çš„å†…ç½®å‡½æ•°è™½è¦†ç›–æ•°å­¦ã€é€»è¾‘ã€æŸ¥æ‰¾ç­‰å¸¸è§åœºæ™¯ï¼Œä½†åœ¨é¢å¯¹ä»¥ä¸‹æƒ…å†µæ—¶ä»æ˜¾ä¸è¶³ï¼š</p>
<ul>
<li><strong>ä¸šåŠ¡è§„åˆ™ç‰¹æ®Š</strong>ï¼šå¦‚å›ºå®šèµ„äº§æŠ˜æ—§è®¡ç®—ã€è¡Œä¸šç‰¹å®šæŒ‡æ ‡ï¼›</li>
<li><strong>ä¾èµ–å¤–éƒ¨æ•°æ®</strong>ï¼šå¦‚å®æ—¶æ±‡ç‡ã€å•†å“åº“å­˜ã€ç”¨æˆ·ä¿¡æ¯ï¼›</li>
<li><strong>å¤šäººåä½œéœ€ç»Ÿä¸€é€»è¾‘</strong>ï¼šé¿å…å› æ‰‹åŠ¨è®¡ç®—å¯¼è‡´ç»“æœä¸ä¸€è‡´ã€‚</li>
</ul>
<p>è‡ªå®šä¹‰å‡½æ•°çš„ä»·å€¼åœ¨äºï¼š</p>
<ul>
<li>âœ… <strong>æå‡æ•ˆç‡</strong>ï¼šä¸€é”®å®Œæˆå¤æ‚è®¡ç®—ï¼›</li>
<li>âœ… <strong>åŠ¨æ€å“åº”</strong>ï¼šæ•°æ®å˜åŒ–è‡ªåŠ¨æ›´æ–°ç»“æœï¼›</li>
<li>âœ… <strong>æ ‡å‡†åŒ–é€»è¾‘</strong>ï¼šç¡®ä¿å›¢é˜Ÿå†…è®¡ç®—è§„åˆ™ç»Ÿä¸€ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€ä»é›¶å®ç°ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°</h3>
<p>åœ¨ SpreadJS ä¸­ï¼Œåˆ›å»ºè‡ªå®šä¹‰å‡½æ•°åªéœ€ä¸‰æ­¥ï¼š<strong>å®šä¹‰é€»è¾‘ â†’ æ³¨å†Œå‡½æ•° â†’ åº”ç”¨è°ƒç”¨</strong>ã€‚</p>
<h4 data-id="heading-3">1.å®šä¹‰å‡½æ•°é€»è¾‘</h4>
<p>ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°ç±»ï¼Œç»§æ‰¿è‡ª <code>GC.Spread.CalcEngine.Functions.Function</code>ï¼Œå¹¶å®ç° <code>evaluate</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•è´Ÿè´£æ¥æ”¶å‚æ•°ã€æ‰§è¡Œè®¡ç®—å¹¶è¿”å›ç»“æœã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">FactorialFunction</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">"FACTORIAL"</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxArgs</span> = <span class="hljs-number">1</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">minArgs</span> = <span class="hljs-number">1</span>;
}
<span class="hljs-title class_">FactorialFunction</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">GC</span>.<span class="hljs-property">Spread</span>.<span class="hljs-property">CalcEngine</span>.<span class="hljs-property">Functions</span>.<span class="hljs-title class_">Function</span>();
<span class="hljs-title class_">FactorialFunction</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">evaluate</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; !<span class="hljs-built_in">isNaN</span>(<span class="hljs-built_in">parseInt</span>(arg))) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= arg; i++) {
      result = i * result;
    }
    <span class="hljs-keyword">return</span> result;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">"#VALUE!"</span>;
};
<span class="hljs-title class_">FactorialFunction</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">description</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"FACTORIAL"</span>,
    <span class="hljs-attr">description</span>:
      <span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªè®¡ç®—ä» 1 å¼€å§‹çš„é˜¶ä¹˜å¹¶åœ¨å•å…ƒæ ¼ä¸­æ˜¾ç¤ºçš„å‡½æ•°"</span>,
    <span class="hljs-attr">parameters</span>: [{ <span class="hljs-attr">name</span>: <span class="hljs-string">"number"</span> }],
  };
};
</code></pre>
<p>å¸¸è§çš„å®æˆ˜æ¡ˆä¾‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>é˜¶ä¹˜å‡½æ•°</strong>ï¼šå¤„ç†å•ä¸ªæ•°å€¼çš„é€’å½’è®¡ç®—ï¼›</li>
<li><strong>é˜¶ä¹˜æ•°ç»„å‡½æ•°</strong>ï¼šæ”¯æŒå¯¹åŒºåŸŸï¼ˆå¦‚ A1:A5ï¼‰æ‰¹é‡è®¡ç®—ï¼›</li>
<li><strong>å›ºå®šèµ„äº§æŠ˜æ—§å‡½æ•°</strong>ï¼šæ ¹æ®å¹´é™ã€æ®‹å€¼ç‡ç­‰å‚æ•°è®¡ç®—æœˆæŠ˜æ—§é¢ã€‚</li>
</ul>
<h4 data-id="heading-4">2.æ³¨å†Œå‡½æ•°</h4>
<p>é€šè¿‡ <code>workbook.addCustomFunction()</code> å°†å‡½æ•°æ³¨å†Œåˆ°å·¥ä½œç°¿ï¼ˆæˆ–å·¥ä½œè¡¨ã€å…¨å±€ï¼‰ï¼Œä½¿å…¶å¯åœ¨å…¬å¼ä¸­è¢«è¯†åˆ«ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">let</span> factorial = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FactorialFunction</span>();
<span class="hljs-comment">// å·¥ä½œç°¿çº§åˆ«æ³¨å†Œ</span>
spread.<span class="hljs-title function_">addCustomFunction</span>(factorial);
<span class="hljs-comment">// å·¥ä½œè¡¨çº§åˆ«æ³¨å†Œ</span>
sheet.<span class="hljs-title function_">addCustomFunction</span>(factorial);
</code></pre>
<h4 data-id="heading-5">3.åœ¨å•å…ƒæ ¼ä¸­ä½¿ç”¨</h4>
<p>æ³¨å†ŒæˆåŠŸåï¼Œå³å¯åƒå†…ç½®å‡½æ•°ä¸€æ ·ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š<code>=FACTORIAL(5)</code> æˆ– <code>=DEPRECIATION(B2, C2, D2)</code>ã€‚</p>
<h3 data-id="heading-6">ä¸‰ã€å¼‚æ­¥å‡½æ•°ï¼šå¤„ç†å¤–éƒ¨æ•°æ®ä¾èµ–</h3>
<p>æ™®é€šè‡ªå®šä¹‰å‡½æ•°æ˜¯<strong>åŒæ­¥æ‰§è¡Œ</strong>çš„ï¼Œä¸€æ—¦æ¶‰åŠç½‘ç»œè¯·æ±‚ï¼ˆå¦‚è°ƒç”¨ API è·å–æ±‡ç‡ï¼‰ã€æ•°æ®åº“æŸ¥è¯¢æˆ–è€—æ—¶è®¡ç®—ï¼Œå°±ä¼šé˜»å¡ UI çº¿ç¨‹ï¼Œå¯¼è‡´è¡¨æ ¼å¡é¡¿ã€‚æ­¤æ—¶ï¼Œåº”ä½¿ç”¨ <strong>å¼‚æ­¥è‡ªå®šä¹‰å‡½æ•°</strong>ã€‚</p>
<h4 data-id="heading-7">å¼‚æ­¥å‡½æ•°çš„æ ¸å¿ƒç‰¹ç‚¹ï¼š</h4>
<ul>
<li>ä¸ç«‹å³è¿”å›ç»“æœï¼Œè€Œæ˜¯å‘èµ·å¼‚æ­¥æ“ä½œï¼›</li>
<li>è¡¨æ ¼æš‚æ—¶æ˜¾ç¤ºé»˜è®¤å€¼ï¼ˆå¦‚ <code>"Loading..."</code>ï¼‰ï¼›</li>
<li>å¼‚æ­¥å®Œæˆåï¼Œé€šè¿‡ <code>context.setAsyncResult(result)</code> è‡ªåŠ¨æ›´æ–°å•å…ƒæ ¼ã€‚</li>
</ul>
<h4 data-id="heading-8">å…¸å‹åº”ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li>æ ¹æ®å•†å“ ID å®æ—¶è·å–ä»·æ ¼ï¼›</li>
<li>æŸ¥è¯¢ç”¨æˆ·å†å²è®¢å•å¹¶ç»Ÿè®¡ï¼›</li>
<li>è°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆå¦‚å¤©æ°”ã€æ±‡ç‡ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">AsyncRateFunction</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">"ASYNC_GET_RATE"</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">minArgs</span> = <span class="hljs-number">1</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxArgs</span> = <span class="hljs-number">1</span>;
}
<span class="hljs-title class_">AsyncRateFunction</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> =
  <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">GC</span>.<span class="hljs-property">Spread</span>.<span class="hljs-property">CalcEngine</span>.<span class="hljs-property">Functions</span>.<span class="hljs-title class_">AsyncFunction</span>(<span class="hljs-string">"ASYNC_GET_RATE"</span>);
<span class="hljs-title class_">AsyncRateFunction</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">defaultValue</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-string">"åŠ è½½ä¸­..."</span>;
};
<span class="hljs-title class_">AsyncRateFunction</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">evaluate</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">context</span>) {
  <span class="hljs-keyword">let</span> currency = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>]?.<span class="hljs-title function_">toUpperCase</span>();

  <span class="hljs-keyword">if</span> (![<span class="hljs-string">"USD"</span>, <span class="hljs-string">"EUR"</span>].<span class="hljs-title function_">includes</span>(currency)) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"#INVALID! ä»…æ”¯æŒUSD/EUR"</span>;
  }

  <span class="hljs-title function_">fetch</span>(
    <span class="hljs-string">`https://api.apilayer.com/exchangerates_data/latest?base=<span class="hljs-subst">${currency}</span>&amp;symbols=CNY`</span>,
    {
      <span class="hljs-attr">headers</span>: { <span class="hljs-attr">apikey</span>: <span class="hljs-string">"your_api_key"</span> },
    }
  )
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.<span class="hljs-title function_">json</span>())
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-keyword">let</span> rate = data.<span class="hljs-property">rates</span>?.<span class="hljs-property">CNY</span>;
      rate
        ? context.<span class="hljs-title function_">setAsyncResult</span>(<span class="hljs-built_in">parseFloat</span>(rate.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">4</span>)))
        : context.<span class="hljs-title function_">setAsyncResult</span>(<span class="hljs-string">"#NO_DATA! æœªè·å–åˆ°æ±‡ç‡"</span>);
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      context.<span class="hljs-title function_">setAsyncResult</span>(<span class="hljs-string">`#API_ERROR: <span class="hljs-subst">${err.message}</span>`</span>);
    });
};
<span class="hljs-title class_">AsyncRateFunction</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">evaluateMode</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
};
<span class="hljs-title class_">AsyncRateFunction</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">description</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"ASYNC_GET_RATE"</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">"å¼‚æ­¥è·å–æŒ‡å®šè´§å¸çš„æ±‡ç‡"</span>,
    <span class="hljs-attr">parameters</span>: [{ <span class="hljs-attr">name</span>: <span class="hljs-string">"currency"</span>, <span class="hljs-attr">description</span>: <span class="hljs-string">"è´§å¸ç±»å‹ï¼ˆUSD/EURï¼‰"</span> }],
  };
};
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>æ³¨æ„</strong>ï¼šå¼‚æ­¥å‡½æ•°å¿…é¡»åœ¨ <code>evaluate</code> ä¸­è°ƒç”¨ <code>context.setAsyncResult()</code>ï¼Œè€Œä¸èƒ½ä½¿ç”¨ <code>return</code>ã€‚</p>
</blockquote>
<h4 data-id="heading-9">åŒæ­¥ vs å¼‚æ­¥å¯¹æ¯”</h4>






























<table><thead><tr><th>ç»´åº¦</th><th>åŒæ­¥å‡½æ•°</th><th>å¼‚æ­¥å‡½æ•°</th></tr></thead><tbody><tr><td>æ‰§è¡Œæ–¹å¼</td><td>ç«‹å³æ‰§è¡Œï¼Œé˜»å¡è¡¨æ ¼</td><td>å¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>æœ¬åœ°è®¡ç®—ï¼ˆé˜¶ä¹˜ã€åŠ å‡ï¼‰</td><td>å¤–éƒ¨æ•°æ®ä¾èµ–ï¼ˆAPI/DBï¼‰</td></tr><tr><td>è¿”å›æ–¹å¼</td><td>return result</td><td>context.setAsyncResult(result)</td></tr><tr><td>æœªå®ŒæˆçŠ¶æ€</td><td>æ— </td><td>æ˜¾ç¤º defaultValue</td></tr></tbody></table>
<h3 data-id="heading-10">å››ã€æ–°æ‰‹å¼€å‘é¿å‘æŒ‡å—</h3>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œä»¥ä¸‹é—®é¢˜é«˜é¢‘å‡ºç°ï¼ŒåŠ¡å¿…æå‰è§„é¿ï¼š</p>
<h4 data-id="heading-11">1.å¯¼å…¥æ–‡ä»¶åå‡ºç° <code>#NAME?</code></h4>
<p>åŸå› ï¼šè‡ªå®šä¹‰å‡½æ•°åœ¨å¯¼å…¥æ¨¡æ¿<strong>ä¹‹å</strong>æ‰æ³¨å†Œï¼Œå¯¼è‡´å…¬å¼æ— æ³•è¯†åˆ«ã€‚ âœ… è§£å†³æ–¹æ¡ˆï¼šå…ˆå¯¼å…¥æ–‡ä»¶ â†’ å†æ³¨å†Œå‡½æ•° â†’ æœ€åè°ƒç”¨ <code>workbook.calcEngine().calculate("rebuild")</code>ã€‚</p>
<h4 data-id="heading-12">2.å‡½æ•°ä½œç”¨åŸŸæ··ä¹±</h4>
<p>å‡½æ•°å¯æ³¨å†Œåˆ° <code>workbook</code>ã€<code>worksheet</code> æˆ–å…¨å±€ <code>GC</code> å¯¹è±¡ã€‚</p>
<ul>
<li>ä¸€èˆ¬æ¨èæ³¨å†Œåˆ° <code>workbook</code>ï¼›</li>
<li>è‹¥éœ€è·¨å¤šä¸ªå·¥ä½œç°¿å¤ç”¨ï¼Œå¯æ³¨å†Œåˆ° <code>GC.Spread.CalcEngine.Functions</code>.</li>
</ul>
<h4 data-id="heading-13">3.è¿”å›å€¼ç±»å‹é”™è¯¯</h4>
<ul>
<li>åŒæ­¥å‡½æ•°ï¼š<code>return value</code></li>
<li>æ•°ç»„å‡½æ•°ï¼šè¿”å› <code>CalcArray</code> å¯¹è±¡</li>
<li>å¼‚æ­¥å‡½æ•°ï¼šå¿…é¡»ç”¨ <code>context.setAsyncResult()</code></li>
</ul>
<h4 data-id="heading-14">4.éœ€è®¿é—® <code>workbook</code> å¯¹è±¡ï¼Ÿ</h4>
<p>è‹¥å‡½æ•°éœ€è¯»å–é€‰åŒºã€æ ·å¼ç­‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå¦‚å®ç° <code>=SELECTION()</code>ï¼‰ï¼Œéœ€è®¾ç½® <code>isContextSensitive: true</code>ã€‚</p>
<h4 data-id="heading-15">5.å‚æ•°åˆæ³•æ€§æ ¡éªŒç¼ºå¤±</h4>
<p>ç”¨æˆ·å¯èƒ½ä¼ å…¥å­—ç¬¦ä¸²ã€ç©ºå€¼ã€é”™è¯¯èŒƒå›´ã€‚åŠ¡å¿…åœ¨ <code>evaluate</code> ä¸­åšç±»å‹åˆ¤æ–­ä¸å®¹é”™å¤„ç†ã€‚</p>
<h4 data-id="heading-16">6.å¿½ç•¥å•å…ƒæ ¼æ•°æ®ç±»å‹</h4>
<p>çœ‹ä¼¼æ•°å­—çš„å•å…ƒæ ¼å¯èƒ½æ˜¯æ–‡æœ¬æ ¼å¼ï¼ˆå¦‚ä» CSV å¯¼å…¥ï¼‰ã€‚å»ºè®®ä½¿ç”¨ <code>parseFloat</code> æˆ–ç±»å‹è½¬æ¢ç¡®ä¿è®¡ç®—æ­£ç¡®ã€‚</p>
<h4 data-id="heading-17">7.ä¸å†…ç½®å‡½æ•°é‡å</h4>
<p>é¿å…å‘½åå¦‚ <code>SUM</code>ã€<code>AVERAGE</code> ç­‰ï¼Œå¦åˆ™ä¼šè¦†ç›–åŸç”Ÿå‡½æ•°ã€‚</p>
<h4 data-id="heading-18">8.å¤§æ•°æ®é‡æ€§èƒ½é—®é¢˜</h4>
<p>éå†å¤§èŒƒå›´å•å…ƒæ ¼æ—¶ï¼Œä½¿ç”¨ <code>getArray()</code> æ›¿ä»£å¤šæ¬¡ <code>getValue()</code>ï¼Œå¹¶é…åˆ <code>suspendPaint()</code> æå‡æ€§èƒ½ã€‚</p>
<h4 data-id="heading-19">9.æ•°ç»„å…¬å¼æœªå¼€å¯åŠ¨æ€æ•°ç»„</h4>
<p>ä½¿ç”¨æ•°ç»„å…¬å¼ï¼ˆå¦‚è¿”å›å¤šå•å…ƒæ ¼ç»“æœï¼‰æ—¶ï¼Œéœ€è®¾ç½® <code>workbook.options.allowDynamicArray = true</code>ã€‚</p>
<h3 data-id="heading-20">å¼€å‘å»ºè®®</h3>
<ul>
<li><strong>å…ˆæ˜“åéš¾</strong>ï¼šä»é˜¶ä¹˜ã€æ±‚å’Œç­‰ç®€å•å‡½æ•°å…¥æ‰‹ï¼Œå†æŒ‘æˆ˜å¼‚æ­¥æˆ–æ•°ç»„åœºæ™¯ï¼›</li>
<li><strong>å¤šæ‰“æ—¥å¿—</strong>ï¼šåœ¨ <code>evaluate</code> ä¸­ <code>console.log</code> å‚æ•°ä¸ä¸­é—´ç»“æœï¼Œå¿«é€Ÿå®šä½é—®é¢˜ï¼›</li>
<li><strong>å‹¤æŸ¥æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdemo.grapecity.com.cn%2Fspreadjs%2Fhelp%2Fapi%2Fmodules%2FGC" target="_blank" title="https://demo.grapecity.com.cn/spreadjs/help/api/modules/GC" ref="nofollow noopener noreferrer">SpreadJS å®˜æ–¹ API æ–‡æ¡£æ˜¯æœ€ä½³å‚è€ƒ</a>ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Wordæ–‡æ¡£ä¸­æ’å…¥å›¾ç‰‡ï¼šä½¿ç”¨ Spire.Doc for Javaå®ç°è‡ªåŠ¨åŒ–ä¸ç²¾ç»†æ§åˆ¶]]></title>    <link>https://juejin.cn/post/7579095566900363304</link>    <guid>https://juejin.cn/post/7579095566900363304</guid>    <pubDate>2025-12-03T02:13:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579095566900363304" data-draft-id="7579088065698234408" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Wordæ–‡æ¡£ä¸­æ’å…¥å›¾ç‰‡ï¼šä½¿ç”¨ Spire.Doc for Javaå®ç°è‡ªåŠ¨åŒ–ä¸ç²¾ç»†æ§åˆ¶"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-03T02:13:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·033212666367"/> <meta itemprop="url" content="https://juejin.cn/user/230252528804124"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Wordæ–‡æ¡£ä¸­æ’å…¥å›¾ç‰‡ï¼šä½¿ç”¨ Spire.Doc for Javaå®ç°è‡ªåŠ¨åŒ–ä¸ç²¾ç»†æ§åˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/230252528804124/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·033212666367
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:13:51.000Z" title="Wed Dec 03 2025 02:13:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼ŒWordæ–‡æ¡£æ˜¯ä¸å¯æˆ–ç¼ºçš„å·¥å…·ï¼Œè€Œå›¾ç‰‡ä½œä¸ºä¿¡æ¯ä¼ è¾¾çš„é‡è¦è½½ä½“ï¼Œå…¶åœ¨æ–‡æ¡£ä¸­çš„æ’å…¥ä¸å¸ƒå±€æ˜¾å¾—å°¤ä¸ºå…³é”®ã€‚å½“æˆ‘ä»¬éœ€è¦æ‰¹é‡å¤„ç†ã€è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«å›¾ç‰‡çš„Wordæ–‡æ¡£æ—¶ï¼Œæ‰‹åŠ¨æ“ä½œæ˜¾ç„¶æ•ˆç‡ä½ä¸‹ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•åˆ©ç”¨å¼ºå¤§çš„Spire.Doc for Javaåº“ï¼Œå®ç°Wordæ–‡æ¡£æ’å…¥å›¾ç‰‡çš„è‡ªåŠ¨åŒ–ï¼Œå¹¶ç²¾ç»†æ§åˆ¶å›¾ç‰‡ç¯ç»•æ–¹å¼å’Œå›¾ç‰‡å®šä½ï¼ŒåŠ©ä½ è½»æ¾é©¾é©­Javaæ“ä½œWordçš„å¤æ‚åœºæ™¯ï¼Œå®ç°é«˜æ•ˆWordè‡ªåŠ¨åŒ–ã€‚</p>
<h2 data-id="heading-0">1. Spire.Doc for Javaåº“ä»‹ç»ä¸å®‰è£…</h2>
<p>Spire.Docæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§ä¸”æ˜“äºä½¿ç”¨çš„Javaç»„ä»¶ï¼Œä¸“ä¸ºå¤„ç†Wordæ–‡æ¡£è€Œè®¾è®¡ã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨Javaåº”ç”¨ç¨‹åºä¸­åˆ›å»ºã€è¯»å–ã€ç¼–è¾‘ã€è½¬æ¢å’Œæ‰“å°Wordæ–‡æ¡£ï¼Œæ— éœ€å®‰è£…Microsoft Wordã€‚å…¶ä¼˜åŠ¿åœ¨äºAPIæ¥å£ä¸°å¯Œã€æ€§èƒ½ä¼˜è¶Šï¼Œèƒ½å¤Ÿæ»¡è¶³å„ç§å¤æ‚çš„æ–‡æ¡£å¤„ç†éœ€æ±‚ã€‚</p>
<p>Mavenä¾èµ–é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>com.e-iceblue<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>e-iceblue<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.e-iceblue.cn/repository/maven-public/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>e-iceblue<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spire.doc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>13.11.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h2 data-id="heading-1">2. ä½¿ç”¨ç‰¹å®šçš„ç¯ç»•æ–¹å¼æ’å…¥å›¾ç‰‡</h2>
<p>åœ¨Wordä¸­ï¼Œå›¾ç‰‡çš„æ–‡æœ¬ç¯ç»•æ–¹å¼å†³å®šäº†å›¾ç‰‡ä¸å‘¨å›´æ–‡æœ¬çš„å…³ç³»ã€‚Spire.Doc for Javaæä¾›äº†çµæ´»çš„APIæ¥è®¾ç½®è¿™äº›ç¯ç»•æ–¹å¼ã€‚</p>
<p><strong>æ ¸å¿ƒæ­¥éª¤ï¼š</strong></p>
<ul>
<li>åŠ è½½æˆ–åˆ›å»ºWordæ–‡æ¡£ã€‚</li>
<li>è·å–æ–‡æ¡£ä¸­çš„æŸä¸ªæ®µè½æˆ–åˆ›å»ºä¸€ä¸ªæ–°æ®µè½ã€‚</li>
<li>åˆ›å»º<code>DocPicture</code>å¯¹è±¡ï¼Œå¹¶åŠ è½½å›¾ç‰‡æ–‡ä»¶ã€‚</li>
<li>å°†<code>DocPicture</code>å¯¹è±¡æ·»åŠ åˆ°æ®µè½ä¸­ã€‚</li>
<li>è®¾ç½®å›¾ç‰‡çš„ç¯ç»•æ–¹å¼ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">importÂ com<span class="hljs-selector-class">.spire</span><span class="hljs-selector-class">.doc</span>.*;
importÂ com<span class="hljs-selector-class">.spire</span><span class="hljs-selector-class">.doc</span><span class="hljs-selector-class">.documents</span>.*;
importÂ com<span class="hljs-selector-class">.spire</span><span class="hljs-selector-class">.doc</span><span class="hljs-selector-class">.fields</span>.*;

publicÂ classÂ insertImageÂ {
Â Â Â Â publicÂ staticÂ voidÂ <span class="hljs-selector-tag">main</span>(String[]Â args)Â throwsÂ ExceptionÂ {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//åˆ›å»ºÂ DocumentÂ ç±»çš„å¯¹è±¡</span>
Â Â Â Â Â Â Â Â DocumentÂ docÂ =Â newÂ <span class="hljs-built_in">Document</span>();

Â Â Â Â Â Â Â Â <span class="hljs-comment">//ä»ç£ç›˜è½½å…¥Â WordÂ æ–‡ä»¶</span>
Â Â Â Â Â Â Â Â doc<span class="hljs-selector-class">.loadFromFile</span>("D:/Samples/Sample.docx");

Â Â Â Â Â Â Â Â <span class="hljs-comment">//åˆ›å»ºÂ DocPictureÂ ç±»çš„å¯¹è±¡</span>
Â Â Â Â Â Â Â Â DocPictureÂ pictureÂ =Â newÂ <span class="hljs-built_in">DocPicture</span>(doc);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//ä»ç£ç›˜åŠ è½½å›¾ç‰‡</span>
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.loadImage</span>("D:/Samples/System.png");

Â Â Â Â Â Â Â Â <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡å¤§å°</span>
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.setWidth</span>(<span class="hljs-number">75</span>);
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.setHeight</span>(<span class="hljs-number">90</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//å°†å›¾ç‰‡æ–‡æœ¬ç¯ç»•æ–¹å¼è®¾ç½®ä¸ºå››å‘¨ç¯ç»•</span>
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.setTextWrappingStyle</span>(Â TextWrappingStyle.Square);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//å°†å›¾ç‰‡æ’å…¥åˆ°ç¬¬äºŒæ®µ</span>
Â Â Â Â Â Â Â Â doc<span class="hljs-selector-class">.getSections</span>()<span class="hljs-selector-class">.get</span>(<span class="hljs-number">0</span>)<span class="hljs-selector-class">.getParagraphs</span>()<span class="hljs-selector-class">.get</span>(<span class="hljs-number">1</span>)<span class="hljs-selector-class">.getChildObjects</span>()<span class="hljs-selector-class">.insert</span>(<span class="hljs-number">0</span>,picture);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//ä¿å­˜æ–‡æ¡£</span>
Â Â Â Â Â Â Â Â doc<span class="hljs-selector-class">.saveToFile</span>("D:/javaOutput/insertImage.docx",Â FileFormat.Docx);
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-2">ä¸åŒç¯ç»•æ–¹å¼çš„è§†è§‰æ•ˆæœå’Œåº”ç”¨åœºæ™¯ï¼š</h3>
<ul>
<li><strong>åµŒå…¥å‹ (Inline)</strong> ï¼š å›¾ç‰‡è¢«è§†ä¸ºæ–‡æœ¬å­—ç¬¦ï¼Œéšæ–‡æœ¬æµåŠ¨ã€‚é€‚ç”¨äºå›¾ç‰‡ä¸æ–‡å­—ç´§å¯†ç»“åˆï¼Œä¸å¸Œæœ›å›¾ç‰‡æµ®åŠ¨çš„æƒ…å†µã€‚</li>
<li><strong>å››å‘¨å‹ (Square)</strong> ï¼š æ–‡æœ¬å›´ç»•å›¾ç‰‡çš„çŸ©å½¢è¾¹æ¡†ã€‚æœ€å¸¸è§çš„ç¯ç»•æ–¹å¼ï¼Œå›¾ç‰‡ä¸æ–‡æœ¬äº’ä¸é®æŒ¡ã€‚</li>
<li><strong>ç´§å¯†å‹ (Tight)</strong> ï¼š æ–‡æœ¬ç´§å¯†åœ°å›´ç»•å›¾ç‰‡çš„å®é™…è½®å»“ã€‚æ¯”å››å‘¨å‹æ›´è´´åˆå›¾ç‰‡å½¢çŠ¶ï¼Œé€‚ç”¨äºä¸è§„åˆ™å½¢çŠ¶çš„å›¾ç‰‡ã€‚</li>
<li><strong>æµ®äºæ–‡å­—ä¸‹æ–¹ (Behind)</strong> ï¼š å›¾ç‰‡ä½äºæ–‡æœ¬ä¸‹æ–¹ï¼Œæ–‡æœ¬ä¼šè¦†ç›–å›¾ç‰‡ã€‚é€‚ç”¨äºä½œä¸ºèƒŒæ™¯æ°´å°æˆ–è£…é¥°æ€§å›¾ç‰‡ã€‚</li>
<li><strong>æµ®äºæ–‡å­—ä¸Šæ–¹ (InFrontOfText)</strong> ï¼š å›¾ç‰‡ä½äºæ–‡æœ¬ä¸Šæ–¹ï¼Œä¼šé®æŒ¡æ–‡æœ¬ã€‚é€‚ç”¨äºéœ€è¦çªå‡ºå›¾ç‰‡ï¼Œæˆ–ä½œä¸ºæµ®åŠ¨å…ƒç´ ã€‚</li>
<li><strong>ä¸Šä¸‹å‹ (TopAndBottom)</strong> ï¼š æ–‡æœ¬åœ¨å›¾ç‰‡ä¸Šæ–¹å’Œä¸‹æ–¹ï¼Œä¸ä¸å›¾ç‰‡å·¦å³ä¸¤ä¾§å¹¶æ’ã€‚</li>
</ul>
<h2 data-id="heading-3">3. åœ¨æŒ‡å®šä½ç½®æ’å…¥å›¾ç‰‡</h2>
<p>é™¤äº†ç¯ç»•æ–¹å¼ï¼Œç²¾ç¡®æ§åˆ¶å›¾ç‰‡åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®ä¹Ÿè‡³å…³é‡è¦ã€‚Spire.Doc for Javaå…è®¸ä½ åœ¨æ®µè½ã€è¡¨æ ¼å•å…ƒæ ¼ç”šè‡³é€šè¿‡ç»å¯¹åæ ‡æ¥å®šä½å›¾ç‰‡ã€‚ç›´æ¥é€šè¿‡<code>Paragraph.getChildObjects().insert()</code>å³å¯åœ¨æ–‡æ¡£çš„ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-scss" lang="scss">importÂ com<span class="hljs-selector-class">.spire</span><span class="hljs-selector-class">.doc</span>.*;
importÂ com<span class="hljs-selector-class">.spire</span><span class="hljs-selector-class">.doc</span><span class="hljs-selector-class">.documents</span>.*;
importÂ com<span class="hljs-selector-class">.spire</span><span class="hljs-selector-class">.doc</span><span class="hljs-selector-class">.fields</span>.*;

publicÂ classÂ insertImageÂ {
Â Â Â Â publicÂ staticÂ voidÂ <span class="hljs-selector-tag">main</span>(String[]Â args)Â throwsÂ ExceptionÂ {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//åˆ›å»ºÂ DocumentÂ ç±»çš„å¯¹è±¡</span>
Â Â Â Â Â Â Â Â DocumentÂ docÂ =Â newÂ <span class="hljs-built_in">Document</span>();

Â Â Â Â Â Â Â Â <span class="hljs-comment">//ä»ç£ç›˜åŠ è½½Â WordÂ æ–‡æ¡£</span>
Â Â Â Â Â Â Â Â doc<span class="hljs-selector-class">.loadFromFile</span>("D:/Samples/Sample.docx");

Â Â Â Â Â Â Â Â <span class="hljs-comment">//åˆ›å»ºÂ DocPictureÂ ç±»çš„å¯¹è±¡</span>
Â Â Â Â Â Â Â Â DocPictureÂ pictureÂ =Â newÂ <span class="hljs-built_in">DocPicture</span>(doc);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//ä»ç£ç›˜åŠ è½½å›¾ç‰‡</span>
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.loadImage</span>("D:/Samples/PDF.png");

Â Â Â Â Â Â Â Â <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡çš„å¤§å°</span>
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.setWidth</span>(<span class="hljs-number">75</span>);
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.setHeight</span>(<span class="hljs-number">90</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//å°†å›¾ç‰‡çš„æ–‡æœ¬ç¯ç»•æ–¹å¼è®¾ç½®ä¸ºå››å‘¨ç¯ç»•</span>
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.setTextWrappingStyle</span>(Â TextWrappingStyle.Square);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//å°†å›¾ç‰‡æ’å…¥åˆ°ç¬¬äºŒæ®µ</span>
Â Â Â Â Â Â Â Â doc<span class="hljs-selector-class">.getSections</span>()<span class="hljs-selector-class">.get</span>(<span class="hljs-number">0</span>)<span class="hljs-selector-class">.getParagraphs</span>()<span class="hljs-selector-class">.get</span>(<span class="hljs-number">2</span>)<span class="hljs-selector-class">.getChildObjects</span>()<span class="hljs-selector-class">.insert</span>(<span class="hljs-number">0</span>,picture);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡çš„ä½ç½®</span>
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.setHorizontalPosition</span>(<span class="hljs-number">370.0</span>F);
Â Â Â Â Â Â Â Â picture<span class="hljs-selector-class">.setVerticalPosition</span>(<span class="hljs-number">10.0</span>F);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//ä¿å­˜æ–‡æ¡£</span>
Â Â Â Â Â Â Â Â doc<span class="hljs-selector-class">.saveToFile</span>("D:/javaOutput/insertImage.docx",Â FileFormat.Docx);
Â Â Â Â }
}
</code></pre>
<p><strong>DocPictureå®šä½å±æ€§è¯¦è§£ï¼š</strong></p>
<ul>
<li><code>setHorizontalPosition() / setVerticalPosition()</code>: è®¾ç½®å›¾ç‰‡ç›¸å¯¹äºå…¶å®šä½åŸºå‡†çš„åç§»é‡ã€‚</li>
<li><code>setHorizontalOrigin() / setVerticalOrigin()</code>: è®¾ç½®å›¾ç‰‡æ°´å¹³/å‚ç›´å®šä½çš„åŸºå‡†ç‚¹ï¼Œå¯é€‰å€¼åŒ…æ‹¬Pageï¼ˆé¡µé¢ï¼‰ã€Columnï¼ˆåˆ—ï¼‰ã€Marginï¼ˆé¡µè¾¹è·ï¼‰ã€Paragraphï¼ˆæ®µè½ï¼‰ç­‰ã€‚ç²¾ç¡®çš„å®šä½é€šå¸¸éœ€è¦é€‰æ‹©Pageä½œä¸ºåŸºå‡†ã€‚</li>
</ul>
<h2 data-id="heading-4">4. å¸¸è§é—®é¢˜è§£ç­”</h2>
<ul>
<li><strong>å›¾ç‰‡è·¯å¾„é—®é¢˜ï¼š</strong> ç¡®ä¿æˆ–loadImage()æ–¹æ³•ä¸­æä¾›çš„å›¾ç‰‡è·¯å¾„æ˜¯æ­£ç¡®çš„ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚å¯¹äºWebåº”ç”¨ï¼Œå¯èƒ½éœ€è¦å°†å›¾ç‰‡è½¬æ¢ä¸ºå­—èŠ‚æµåŠ è½½ã€‚</li>
<li><strong>å›¾ç‰‡å¤§å°è°ƒæ•´ï¼š</strong> é€šè¿‡<code>picture.setWidth()</code>å’Œ<code>picture.setHeight()</code>å¯ä»¥è®¾ç½®å›¾ç‰‡çš„å°ºå¯¸ã€‚Spire.Docä¹Ÿä¼šè‡ªåŠ¨æ ¹æ®å›¾ç‰‡åŸå§‹å°ºå¯¸è¿›è¡Œä¸€å®šç¨‹åº¦çš„ç¼©æ”¾ï¼Œä½†æ‰‹åŠ¨è®¾ç½®å¯ä»¥æ›´ç²¾ç¡®æ§åˆ¶ã€‚</li>
<li><strong>å›¾ç‰‡è´¨é‡ï¼š</strong> æ’å…¥çš„å›¾ç‰‡è´¨é‡å–å†³äºåŸå§‹å›¾ç‰‡ã€‚å¦‚æœå›¾ç‰‡è¿‡å¤§ï¼Œå¯èƒ½å¯¼è‡´æ–‡æ¡£æ–‡ä»¶ä½“ç§¯å¢å¤§ï¼Œå¯ä»¥è€ƒè™‘åœ¨æ’å…¥å‰å¯¹å›¾ç‰‡è¿›è¡Œå‹ç¼©å¤„ç†ã€‚</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–ï¼š</strong> æ‰¹é‡æ’å…¥å¤§é‡å›¾ç‰‡æ—¶ï¼Œå¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚å¯ä»¥è€ƒè™‘åˆ†æ‰¹å¤„ç†ï¼Œæˆ–ä¼˜åŒ–å›¾ç‰‡åŠ è½½å’Œæ–‡æ¡£ä¿å­˜é€»è¾‘ã€‚å¯¹äºå¤§å‹æ–‡æ¡£ï¼ŒSpire.Docæä¾›äº†åˆ†æ®µå¤„ç†ç­‰æœºåˆ¶æ¥æé«˜æ•ˆç‡ã€‚</li>
<li><strong>ä¸æ”¯æŒçš„å›¾ç‰‡æ ¼å¼ï¼š</strong> ç¡®ä¿æ’å…¥çš„å›¾ç‰‡æ ¼å¼æ˜¯Wordæ”¯æŒçš„å¸¸è§æ ¼å¼ï¼ˆå¦‚PNG, JPG, BMP, GIFï¼‰ã€‚</li>
<li><strong>æ–‡æœ¬ç¯ç»•ä¸å®šä½å†²çªï¼š</strong> å½“è®¾ç½®äº†éåµŒå…¥å‹ç¯ç»•æ–¹å¼åï¼Œå›¾ç‰‡ä¼šè„±ç¦»æ–‡æœ¬æµï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡<code>setHorizontalPosition</code>å’Œ<code>setVerticalPositionè¿›</code>è¡Œç²¾ç¡®æ§åˆ¶ã€‚</li>
</ul>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>é€šè¿‡Spire.Doc for Javaåº“ï¼Œæˆ‘ä»¬ä¸ä»…èƒ½å¤Ÿè½»æ¾å®ç°Wordæ–‡æ¡£æ’å…¥å›¾ç‰‡çš„åŸºç¡€åŠŸèƒ½ï¼Œæ›´èƒ½é€šè¿‡ç²¾ç»†çš„APIæ§åˆ¶å›¾ç‰‡ç¯ç»•æ–¹å¼å’Œå›¾ç‰‡å®šä½ï¼Œä»è€Œæ»¡è¶³å¤æ‚çš„æ–‡æ¡£è‡ªåŠ¨åŒ–éœ€æ±‚ã€‚æ— è®ºæ˜¯ç”ŸæˆæŠ¥å‘Šã€åˆåŒï¼Œè¿˜æ˜¯æ‰¹é‡å¤„ç†å„ç±»æ–‡æ¡£ï¼ŒSpire.Docéƒ½æä¾›äº†å¼ºå¤§çš„æ”¯æŒã€‚æŒæ¡è¿™äº›æŠ€å·§ï¼Œå°†æå¤§åœ°æå‡ä½ çš„Javaæ“ä½œWordæ•ˆç‡ï¼Œå¼€å¯Wordè‡ªåŠ¨åŒ–çš„æ–°ç¯‡ç« ï¼ŒæœŸå¾…ä½ åœ¨å®é™…é¡¹ç›®ä¸­æ¢ç´¢æ›´å¤šå¯èƒ½ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š2.Storageå’ŒPainterçš„å®ç°]]></title>    <link>https://juejin.cn/post/7579164768063111195</link>    <guid>https://juejin.cn/post/7579164768063111195</guid>    <pubDate>2025-12-03T02:33:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579164768063111195" data-draft-id="7579111646875205683" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š2.Storageå’ŒPainterçš„å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2025-12-03T02:33:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="irises"/> <meta itemprop="url" content="https://juejin.cn/user/3030697436261735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š2.Storageå’ŒPainterçš„å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030697436261735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    irises
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:33:36.000Z" title="Wed Dec 03 2025 02:33:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flz6060788%2FMini-Render" target="_blank" title="https://github.com/lz6060788/Mini-Render" ref="nofollow noopener noreferrer">MiniRenderä»“åº“åœ°å€å‚è€ƒ</a></p>
</blockquote>
<p>å¥½çš„ï¼Œæˆ‘ä»¬å¼€å§‹ <strong>ä»“åº“ (Storage) ä¸ æ¸²æŸ“å™¨ (Painter)</strong> çš„å®ç°ã€‚</p>
<p>è¿™ä¸€æ­¥çš„ç›®æ ‡æ˜¯æŠŠâ€œæ‰‹åŠ¨æŒ¡â€å˜æˆâ€œè‡ªåŠ¨æŒ¡â€ã€‚æˆ‘ä»¬å°†ä¸å†æ‰‹åŠ¨è°ƒç”¨ <code>circle.brush(ctx)</code>ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªè‡ªåŠ¨åŒ–ç³»ç»Ÿï¼š<strong>Storage è´Ÿè´£ç®¡ç†æ‰€æœ‰å›¾å½¢ï¼ŒPainter è´Ÿè´£æŠŠ Storage é‡Œçš„ä¸œè¥¿ç”»å‡ºæ¥ã€‚</strong></p>
<p>ä¸ºäº†è®© Storage çš„é€»è¾‘å®Œæ•´ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè¡¥å……ä¸€ä¸ªç®€å•çš„ <code>Group</code> ç±»ï¼ˆå®¹å™¨ï¼‰ï¼Œå› ä¸º Storage æœ¬è´¨ä¸Šæ˜¯åœ¨éå†ä¸€æ£µæ ‘ã€‚</p>
<h3 data-id="heading-0">1. å®¹å™¨ç±»å®ç° (<code>src/graphic/Group.ts</code>)</h3>
<p><code>Group</code> ç»§æ‰¿è‡ª <code>Element</code>ã€‚å®ƒä¸ç”»ä»»ä½•ä¸œè¥¿ï¼ˆæ²¡æœ‰ <code>brush</code> æ–¹æ³•ï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠå­å…ƒç´ â€œæ‰“åŒ…â€ï¼Œå¹¶ä¸”ä¼ é€’å˜æ¢çŸ©é˜µã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/Group.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Element</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Element'</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Group</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Element</span> {
 Â  Â <span class="hljs-keyword">readonly</span> isGroup = <span class="hljs-literal">true</span>;
 Â  Â 
 Â  Â <span class="hljs-comment">// å­èŠ‚ç‚¹åˆ—è¡¨</span>
 Â  Â <span class="hljs-attr">children</span>: <span class="hljs-title class_">Element</span>[] = [];
â€‹
 Â  Â <span class="hljs-comment">/**
 Â  Â  * æ·»åŠ å­èŠ‚ç‚¹
 Â  Â  */</span>
 Â  Â <span class="hljs-title function_">add</span>(<span class="hljs-params">child: Element</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (child &amp;&amp; child !== <span class="hljs-variable language_">this</span> &amp;&amp; child.<span class="hljs-property">parent</span> !== <span class="hljs-variable language_">this</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(child);
 Â  Â  Â  Â  Â  Â child.<span class="hljs-property">parent</span> = <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// å»ºç«‹çˆ¶å­é“¾æ¥</span>
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â <span class="hljs-comment">/**
 Â  Â  * ç§»é™¤å­èŠ‚ç‚¹
 Â  Â  */</span>
 Â  Â <span class="hljs-title function_">remove</span>(<span class="hljs-params">child: Element</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">const</span> idx = <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">indexOf</span>(child);
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (idx &gt;= <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">splice</span>(idx, <span class="hljs-number">1</span>);
 Â  Â  Â  Â  Â  Â child.<span class="hljs-property">parent</span> = <span class="hljs-literal">null</span>;
 Â  Â  Â   }
 Â   }
}
</code></pre>
<hr/>
<h3 data-id="heading-1">2. ä»“åº“æ¨¡å— (<code>src/storage/Storage.ts</code>)</h3>
<p><code>Storage</code> æ˜¯å†…å­˜ä¸­çš„æ•°æ®åº“ã€‚å®ƒçš„æ ¸å¿ƒèŒè´£æ˜¯ï¼š<strong>å°†åœºæ™¯å›¾ï¼ˆæ ‘çŠ¶ç»“æ„ï¼‰æ‰å¹³åŒ–ä¸ºä¸€ä¸ªæ¸²æŸ“åˆ—è¡¨ï¼ˆæ•°ç»„ï¼‰ï¼Œå¹¶æŒ‰å±‚çº§æ’åºã€‚</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/storage/Storage.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Element</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../graphic/Element'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Displayable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../graphic/Displayable'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Group</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../graphic/Group'</span>;
â€‹
<span class="hljs-comment">// ç±»å‹å®ˆå«ï¼šåˆ¤æ–­æ˜¯å¦ä¸º Group</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isGroup</span>(<span class="hljs-params">el: Element</span>): el is <span class="hljs-title class_">Group</span> {
 Â  Â <span class="hljs-keyword">return</span> (el <span class="hljs-keyword">as</span> <span class="hljs-title class_">Group</span>).<span class="hljs-property">isGroup</span>;
}
â€‹
<span class="hljs-comment">// ç±»å‹å®ˆå«ï¼šåˆ¤æ–­æ˜¯å¦ä¸º Displayable</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isDisplayable</span>(<span class="hljs-params">el: Element</span>): el is <span class="hljs-title class_">Displayable</span> {
 Â  Â <span class="hljs-keyword">return</span> el <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Displayable</span>;
}
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Storage</span> {
 Â  Â <span class="hljs-comment">// æ ¹èŠ‚ç‚¹åˆ—è¡¨ (Scene Graph çš„å…¥å£)</span>
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_roots</span>: <span class="hljs-title class_">Element</span>[] = [];
 Â  Â 
 Â  Â <span class="hljs-comment">// æ‰å¹³åŒ–çš„æ¸²æŸ“åˆ—è¡¨ (ç¼“å­˜ç»“æœ)</span>
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_displayList</span>: <span class="hljs-title class_">Displayable</span>[] = [];
â€‹
 Â  Â <span class="hljs-comment">// æ ‡è®°åˆ—è¡¨æ˜¯å¦è„äº†ï¼ˆéœ€è¦é‡æ–°éå†å’Œæ’åºï¼‰</span>
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_displayListDirty</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;
â€‹
 Â  Â <span class="hljs-title function_">addRoot</span>(<span class="hljs-params">el: Element</span>) {
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_roots</span>.<span class="hljs-title function_">push</span>(el);
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_displayListDirty</span> = <span class="hljs-literal">true</span>;
 Â   }
â€‹
 Â  Â <span class="hljs-comment">/**
 Â  Â  * æ ¸å¿ƒæ–¹æ³•ï¼šè·å–æ’åºåçš„æ¸²æŸ“åˆ—è¡¨
 Â  Â  * é€»è¾‘ï¼š
 Â  Â  * 1. æ·±åº¦ä¼˜å…ˆéå†æ‰€æœ‰æ ¹èŠ‚ç‚¹
 Â  Â  * 2. æ”¶é›†æ‰€æœ‰çš„ Displayable
 Â  Â  * 3. æŒ‰ zLevel å’Œ z æ’åº
 Â  Â  */</span>
 Â  Â <span class="hljs-title function_">getDisplayList</span>(): <span class="hljs-title class_">Displayable</span>[] {
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_displayListDirty</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_updateDisplayList</span>();
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_displayListDirty</span> = <span class="hljs-literal">false</span>;
 Â  Â  Â   }
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_displayList</span>;
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-title function_">_updateDisplayList</span>(<span class="hljs-params"/>) {
 Â  Â  Â  Â <span class="hljs-keyword">const</span> <span class="hljs-attr">list</span>: <span class="hljs-title class_">Displayable</span>[] = [];
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 1. é€’å½’éå† (DFS)</span>
 Â  Â  Â  Â <span class="hljs-keyword">const</span> <span class="hljs-title function_">traverse</span> = (<span class="hljs-params">el: Element</span>) =&gt; {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isDisplayable</span>(el)) {
 Â  Â  Â  Â  Â  Â  Â  Â list.<span class="hljs-title function_">push</span>(el);
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isGroup</span>(el)) {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; el.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>; i++) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-title function_">traverse</span>(el.<span class="hljs-property">children</span>[i]);
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   }
 Â  Â  Â   };
â€‹
 Â  Â  Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_roots</span>.<span class="hljs-property">length</span>; i++) {
 Â  Â  Â  Â  Â  Â <span class="hljs-title function_">traverse</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_roots</span>[i]);
 Â  Â  Â   }
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// 2. æ’åº</span>
 Â  Â  Â  Â <span class="hljs-comment">// ä¼˜å…ˆçº§ï¼šzLevel (Canvaså±‚) &gt; z (åŒå±‚å åŠ é¡ºåº) &gt; æ’å…¥é¡ºåº</span>
 Â  Â  Â  Â list.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (a.<span class="hljs-property">zLevel</span> === b.<span class="hljs-property">zLevel</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> a.<span class="hljs-property">z</span> - b.<span class="hljs-property">z</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> a.<span class="hljs-property">zLevel</span> - b.<span class="hljs-property">zLevel</span>;
 Â  Â  Â   });
â€‹
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_displayList</span> = list;
 Â   }
}
</code></pre>
<hr/>
<h3 data-id="heading-2">3. æ¸²æŸ“å™¨æ¨¡å— (<code>src/painter/Painter.ts</code>)</h3>
<p><code>Painter</code> æ˜¯ä¹Ÿæ˜¯æœ€â€œè„â€çš„åœ°æ–¹ï¼Œå› ä¸ºå®ƒè¦ç›´æ¥æ“ä½œ DOMã€‚ä¸ºäº†ä¿æŒç®€å•ï¼Œæˆ‘ä»¬æš‚æ—¶åªå®ç°<strong>å•å±‚ Canvas</strong>ï¼ˆå‡è®¾æ‰€æœ‰å›¾å½¢ <code>zLevel</code> éƒ½æ˜¯ 0ï¼‰ã€‚</p>
<p><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼š</p>
<ol start="0">
<li>åˆå§‹åŒ–æ—¶åˆ›å»º <code>&lt;canvas&gt;</code> å¹¶æ’å…¥ DOMã€‚</li>
<li><code>refresh</code> æ–¹æ³•è´Ÿè´£æ¸…ç©ºç”»å¸ƒã€è·å–åˆ—è¡¨ã€æ›´æ–°çŸ©é˜µã€ç»˜åˆ¶ã€‚</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/painter/Painter.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Storage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../storage/Storage'</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Painter</span> {
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_dom</span>: <span class="hljs-title class_">HTMLElement</span>;
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_storage</span>: <span class="hljs-title class_">Storage</span>;
 Â  Â 
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_canvas</span>: <span class="hljs-title class_">HTMLCanvasElement</span>;
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_ctx</span>: <span class="hljs-title class_">CanvasRenderingContext2D</span>;
 Â  Â 
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_width</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-attr">_height</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
â€‹
 Â  Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">dom: HTMLElement, storage: Storage</span>) {
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_dom</span> = dom;
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_storage</span> = storage;
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// 1. åˆ›å»º Canvas</span>
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_canvas</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>);
 Â  Â  Â  Â <span class="hljs-comment">// ç®€å•çš„æ ·å¼è®¾ç½®</span>
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_canvas</span>.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">'position:absolute;left:0;top:0;width:100%;height:100%'</span>;
 Â  Â  Â  Â dom.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_canvas</span>);
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_ctx</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_canvas</span>.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>)!;
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// åˆå§‹åŒ–å¤§å°</span>
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>();
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼ˆç®€å•ç‰ˆï¼‰</span>
 Â  Â  Â  Â <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>());
 Â   }
â€‹
 Â  Â <span class="hljs-title function_">resize</span>(<span class="hljs-params"/>) {
 Â  Â  Â  Â <span class="hljs-comment">// è·å–å®¹å™¨å®½é«˜</span>
 Â  Â  Â  Â <span class="hljs-keyword">const</span> width = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_dom</span>.<span class="hljs-property">clientWidth</span>;
 Â  Â  Â  Â <span class="hljs-keyword">const</span> height = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_dom</span>.<span class="hljs-property">clientHeight</span>;
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// å¤„ç†é«˜æ¸…å± (Retina)</span>
 Â  Â  Â  Â <span class="hljs-keyword">const</span> dpr = <span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span> || <span class="hljs-number">1</span>;
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_canvas</span>.<span class="hljs-property">width</span> = width * dpr;
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_canvas</span>.<span class="hljs-property">height</span> = height * dpr;
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// ç¼©æ”¾ Contextï¼Œè¿™æ ·ç»˜å›¾æ—¶ç›´æ¥ç”¨é€»è¾‘åæ ‡ï¼Œä¸ç”¨ç®¡ dpr</span>
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_ctx</span>.<span class="hljs-title function_">scale</span>(dpr, dpr);
â€‹
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_width</span> = width;
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_height</span> = height;
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// å¤§å°å˜äº†ï¼Œå¿…é¡»é‡ç»˜</span>
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refresh</span>();
 Â   }
â€‹
 Â  Â <span class="hljs-comment">/**
 Â  Â  * æ¸²æŸ“å…¥å£
 Â  Â  */</span>
 Â  Â <span class="hljs-title function_">refresh</span>(<span class="hljs-params"/>) {
 Â  Â  Â  Â <span class="hljs-keyword">const</span> list = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_storage</span>.<span class="hljs-title function_">getDisplayList</span>();
 Â  Â  Â  Â <span class="hljs-keyword">const</span> ctx = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_ctx</span>;
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// 1. æ¸…ç©ºç”»å¸ƒ</span>
 Â  Â  Â  Â ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_width</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_height</span>);
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// 2. éå†ç»˜åˆ¶</span>
 Â  Â  Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; list.<span class="hljs-property">length</span>; i++) {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">const</span> el = list[i];
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// ä¼˜åŒ–ï¼šçœ‹ä¸è§çš„ç›´æ¥è·³è¿‡</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// if (el.invisible) continue;</span>
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 3. å…³é”®æ­¥éª¤ï¼šæ›´æ–°å˜æ¢çŸ©é˜µ</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ³¨æ„ï¼šå¿…é¡»ä»æ ¹èŠ‚ç‚¹å¼€å§‹ updateï¼Œè¿™é‡Œä¸ºäº†ç®€åŒ–ï¼Œ</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// å‡è®¾ Storage é‡Œçš„é¡ºåºå·²ç»ä¿è¯äº†çˆ¶çº§åœ¨å­çº§ä¹‹å‰ï¼Œæˆ–è€… el.updateTransform å†…éƒ¨ä¼šè‡ªåŠ¨å›æº¯çˆ¶çº§ã€‚</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// åœ¨çœŸæ­£çš„ MiniRender ä¸­ï¼Œä¼šåœ¨ refresh å‰ç»Ÿä¸€æ›´æ–°ä¸€éæ‰€æœ‰èŠ‚ç‚¹çš„ globalTransformã€‚</span>
 Â  Â  Â  Â  Â  Â el.<span class="hljs-title function_">updateTransform</span>(); 
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 4. ç»˜åˆ¶</span>
 Â  Â  Â  Â  Â  Â el.<span class="hljs-title function_">brush</span>(ctx);
 Â  Â  Â   }
 Â   }
}
</code></pre>
<hr/>
<h3 data-id="heading-3">4. å…¥å£ç±» (<code>src/core/MiniRender.ts</code>)</h3>
<p>è¿™æ˜¯ç»™å¼€å‘è€…ç”¨çš„â€œé—¨é¢â€ï¼ˆFacadeï¼‰ã€‚å®ƒæŠŠ <code>Storage</code> å’Œ <code>Painter</code> ç»„è£…èµ·æ¥ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/core/MiniRender.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Storage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../storage/Storage'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Painter</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../painter/Painter'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Element</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../graphic/Element'</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MiniRender</span> {
 Â  Â <span class="hljs-attr">storage</span>: <span class="hljs-title class_">Storage</span>;
 Â  Â <span class="hljs-attr">painter</span>: <span class="hljs-title class_">Painter</span>;
â€‹
 Â  Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">dom: HTMLElement</span>) {
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Storage</span>();
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">painter</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Painter</span>(dom, <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>);
 Â   }
â€‹
 Â  Â <span class="hljs-comment">/**
 Â  Â  * æ·»åŠ å›¾å½¢å…ƒç´ 
 Â  Â  */</span>
 Â  Â <span class="hljs-title function_">add</span>(<span class="hljs-params">el: Element</span>) {
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">addRoot</span>(el);
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refresh</span>(); <span class="hljs-comment">// æš‚æ—¶ï¼šæ¯æ¬¡æ·»åŠ éƒ½ç«‹å³åˆ·æ–°</span>
 Â   }
â€‹
 Â  Â <span class="hljs-comment">/**
 Â  Â  * è§¦å‘é‡ç»˜
 Â  Â  */</span>
 Â  Â <span class="hljs-title function_">refresh</span>(<span class="hljs-params"/>) {
 Â  Â  Â  Â <span class="hljs-comment">// åœ¨çœŸå® MiniRender ä¸­ï¼Œè¿™é‡Œä¼šä½¿ç”¨ requestAnimationFrame è¿›è¡Œé˜²æŠ–</span>
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">painter</span>.<span class="hljs-title function_">refresh</span>();
 Â   }
}
â€‹
<span class="hljs-comment">/**
 * å·¥å‚å‡½æ•°
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">dom: HTMLElement</span>) {
 Â  Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniRender</span>(dom);
}
</code></pre>
<hr/>
<h3 data-id="heading-4">5. æµ‹è¯•</h3>
<p>ç°åœ¨æˆ‘ä»¬æ‹¥æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„é™æ€æ¸²æŸ“å¼•æ“ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å±‚çº§å…³ç³»çš„åœºæ™¯ã€‚</p>
<p><strong>index.ts (æµ‹è¯•ä»£ç ):</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { init } <span class="hljs-keyword">from</span> <span class="hljs-string">'./core/MiniRender'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Group</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/Group'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Circle</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/shape/Circle'</span>;
â€‹
<span class="hljs-comment">// 1. åˆå§‹åŒ–</span>
<span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'main'</span>)!;
<span class="hljs-keyword">const</span> miniRender = <span class="hljs-title function_">init</span>(container);
â€‹
<span class="hljs-comment">// 2. åˆ›å»ºä¸€ä¸ª Group (å½“ä½œå¤ªé˜³ç³»ä¸­å¿ƒ)</span>
<span class="hljs-keyword">const</span> sunGroup = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Group</span>();
sunGroup.<span class="hljs-property">x</span> = <span class="hljs-number">300</span>;
sunGroup.<span class="hljs-property">y</span> = <span class="hljs-number">300</span>;
â€‹
<span class="hljs-comment">// 3. åˆ›å»ºä¸€ä¸ªçº¢è‰²çš„å¤ªé˜³ (åŠ å…¥ Group)</span>
<span class="hljs-keyword">const</span> sun = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>({
 Â  Â <span class="hljs-attr">shape</span>: { <span class="hljs-attr">r</span>: <span class="hljs-number">50</span> },
 Â  Â <span class="hljs-attr">style</span>: { <span class="hljs-attr">fill</span>: <span class="hljs-string">'#F00'</span> }
});
sunGroup.<span class="hljs-title function_">add</span>(sun);
â€‹
<span class="hljs-comment">// 4. åˆ›å»ºä¸€ä¸ªè“è‰²çš„åœ°çƒ (åŠ å…¥ Groupï¼Œç›¸å¯¹å¤ªé˜³åç§»)</span>
<span class="hljs-keyword">const</span> earth = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>({
 Â  Â <span class="hljs-attr">shape</span>: { <span class="hljs-attr">r</span>: <span class="hljs-number">20</span> },
 Â  Â <span class="hljs-attr">style</span>: { <span class="hljs-attr">fill</span>: <span class="hljs-string">'#00F'</span> },
 Â  Â <span class="hljs-attr">position</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">0</span>] <span class="hljs-comment">// è·ç¦»å¤ªé˜³ä¸­å¿ƒ 100px</span>
});
sunGroup.<span class="hljs-title function_">add</span>(earth);
â€‹
<span class="hljs-comment">// 5. åˆ›å»ºä¸€ä¸ªæœˆäº® (åŠ å…¥åœ°çƒ Group? è¿™é‡Œä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬è®©æœˆäº®å•ç‹¬åœ¨åœ°çƒæ—è¾¹)</span>
<span class="hljs-comment">// æ¼”ç¤ºå±‚çº§ï¼šæˆ‘ä»¬æŠŠæœˆäº®ç›´æ¥åŠ åˆ° Group é‡Œï¼Œä½†æ˜¯ Z è®¾ä½ä¸€ç‚¹</span>
<span class="hljs-keyword">const</span> moon = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>({
 Â  Â <span class="hljs-attr">shape</span>: { <span class="hljs-attr">r</span>: <span class="hljs-number">10</span> },
 Â  Â <span class="hljs-attr">style</span>: { <span class="hljs-attr">fill</span>: <span class="hljs-string">'#CCC'</span> },
 Â  Â <span class="hljs-attr">position</span>: [<span class="hljs-number">120</span>, <span class="hljs-number">0</span>], <span class="hljs-comment">// åœ¨åœ°çƒå³è¾¹</span>
 Â  Â <span class="hljs-attr">z</span>: -<span class="hljs-number">1</span> <span class="hljs-comment">// æ”¾åœ¨æœ€ä¸‹é¢ (æµ‹è¯•æ’åº)</span>
});
sunGroup.<span class="hljs-title function_">add</span>(moon);
â€‹
<span class="hljs-comment">// 6. æ·»åŠ åˆ° miniRender</span>
miniRender.<span class="hljs-title function_">add</span>(sunGroup);
â€‹
<span class="hljs-comment">// --- åŠ¨èµ·æ¥ï¼(ç®€å•çš„åŠ¨ç”»å¾ªç¯) ---</span>
<span class="hljs-comment">// è¿™éªŒè¯äº† Painter çš„ refresh å’Œ Storage çš„ updateTransform</span>
<span class="hljs-keyword">let</span> angle = <span class="hljs-number">0</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">loop</span>(<span class="hljs-params"/>) {
 Â  Â angle += <span class="hljs-number">0.02</span>;
 Â  Â 
 Â  Â <span class="hljs-comment">// æ—‹è½¬æ•´ä¸ªå¤ªé˜³ç³»</span>
 Â  Â sunGroup.<span class="hljs-property">rotation</span> = angle;
 Â  Â 
 Â  Â <span class="hljs-comment">// è‡ªè½¬åœ°çƒ (ä¿®æ”¹å±æ€§ï¼Œæ ‡è®° dirty)</span>
 Â  Â <span class="hljs-comment">// æ³¨æ„ï¼šMiniRender è¿˜æ²¡å®ç° dirty æ ‡è®°ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è°ƒ refresh</span>
 Â  Â 
 Â  Â miniRender.<span class="hljs-title function_">refresh</span>();
 Â  Â <span class="hljs-title function_">requestAnimationFrame</span>(loop);
}
â€‹
<span class="hljs-title function_">loop</span>();
</code></pre>
<p>æ­¤æ—¶ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå„å›¾å½¢ä½ç½®ä¸æ­£ç¡®</p>
<h3 data-id="heading-5">6.å›¾å½¢ä½ç½®é—®é¢˜</h3>
<p>å½“å‰å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><code>group</code>å†…å„å›¾å½¢ç›¸å¯¹ä½ç½®é”™è¯¯</li>
<li>æ•´ä¸ª<code>group</code>ä½ç½®é”™è¯¯</li>
</ul>
<h4 data-id="heading-6">A.è§£å†³<code>group</code>å†…çš„ç›¸å¯¹ä½ç½®é”™è¯¯é—®é¢˜</h4>
<p>å›é¡¾æˆ‘ä»¬ä½¿ç”¨çš„ä»£ç ï¼š</p>
<p><strong>é”™è¯¯åŸå› </strong>ï¼šæˆ‘ä»¬åœ¨ Circle çš„æ„é€ å‡½æ•°ä¸­åªå¤„ç†äº† shape å’Œ styleï¼Œ<strong>å®Œå…¨å¿½ç•¥äº†ç»§æ‰¿è‡ª Element çš„é€šç”¨å±æ€§ï¼ˆposition, scale, rotationï¼‰</strong> ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦åœ¨åŸºç±»ä¸­å¤„ç†è¿™äº›é€šç”¨å±æ€§çš„åˆå§‹åŒ–ã€‚</p>
<h5 data-id="heading-7">1. ä¿®æ”¹ src/graphic/Element.ts</h5>
<p>å¢åŠ ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼Œç”¨äºè§£æ optsã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/Element.ts</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> matrix <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/matrix'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">MatrixArray</span>, <span class="hljs-title class_">Point</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/types'</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ElementProps</span> {
 Â  Â position?: <span class="hljs-title class_">Point</span>; <span class="hljs-comment">// [x, y]</span>
 Â  Â rotation?: <span class="hljs-built_in">number</span>;
 Â  Â scale?: <span class="hljs-title class_">Point</span>; Â  Â <span class="hljs-comment">// [sx, sy]</span>
 Â  Â origin?: <span class="hljs-title class_">Point</span>; Â  <span class="hljs-comment">// [ox, oy]</span>
}
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Element</span> {
 Â  Â <span class="hljs-comment">// ... ä¹‹å‰çš„å±æ€§å®šä¹‰ ...</span>
â€‹
 Â  Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">opts?: ElementProps</span>) {
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = <span class="hljs-string">`el_<span class="hljs-subst">${idBase++}</span>`</span>;
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attr</span>(opts);
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â <span class="hljs-comment">/**
 Â  Â  * ä»¿ç…§ MiniRender çš„ attr æ–¹æ³•ï¼Œç”¨äºæ›´æ–°å±æ€§
 Â  Â  */</span>
 Â  Â <span class="hljs-title function_">attr</span>(<span class="hljs-params">opts: ElementProps</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts.<span class="hljs-property">position</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = opts.<span class="hljs-property">position</span>[<span class="hljs-number">0</span>];
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = opts.<span class="hljs-property">position</span>[<span class="hljs-number">1</span>];
 Â  Â  Â   }
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts.<span class="hljs-property">rotation</span> != <span class="hljs-literal">null</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span> = opts.<span class="hljs-property">rotation</span>;
 Â  Â  Â   }
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts.<span class="hljs-property">scale</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">scaleX</span> = opts.<span class="hljs-property">scale</span>[<span class="hljs-number">0</span>];
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">scaleY</span> = opts.<span class="hljs-property">scale</span>[<span class="hljs-number">1</span>];
 Â  Â  Â   }
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts.<span class="hljs-property">origin</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">originX</span> = opts.<span class="hljs-property">origin</span>[<span class="hljs-number">0</span>];
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">originY</span> = opts.<span class="hljs-property">origin</span>[<span class="hljs-number">1</span>];
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â <span class="hljs-comment">// ... updateTransform ç­‰æ–¹æ³•ä¿æŒä¸å˜ ...</span>
}
</code></pre>
<h5 data-id="heading-8">2. ä¿®æ”¹ src/graphic/Displayable.ts</h5>
<p>è®©å­ç±»å°† opts ä¼ é€’ç»™ superã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/Displayable.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Element</span>, <span class="hljs-title class_">ElementProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Element'</span>;
â€‹
<span class="hljs-comment">// ç»„åˆç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DisplayableProps</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ElementProps</span> {
 Â  Â style?: <span class="hljs-built_in">any</span>;
 Â  Â z?: <span class="hljs-built_in">number</span>;
 Â  Â zLevel?: <span class="hljs-built_in">number</span>;
 Â  Â invisible?: <span class="hljs-built_in">boolean</span>;
}
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Displayable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Element</span> {
 Â  Â <span class="hljs-comment">// ... å±æ€§å®šä¹‰ ...</span>
â€‹
 Â  Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">opts?: DisplayableProps</span>) {
 Â  Â  Â  Â <span class="hljs-variable language_">super</span>(opts); <span class="hljs-comment">// å…³é”®ï¼æŠŠ opts ä¼ ç»™ Element å¤„ç† position/rotation</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts) {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts.<span class="hljs-property">style</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span> = opts.<span class="hljs-property">style</span>;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts.<span class="hljs-property">z</span> != <span class="hljs-literal">null</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">z</span> = opts.<span class="hljs-property">z</span>;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts.<span class="hljs-property">zLevel</span> != <span class="hljs-literal">null</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">zLevel</span> = opts.<span class="hljs-property">zLevel</span>;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (opts.<span class="hljs-property">invisible</span> != <span class="hljs-literal">null</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">invisible</span> = opts.<span class="hljs-property">invisible</span>;
 Â  Â  Â   }
 Â   }
 Â  Â <span class="hljs-comment">// ... brush ç­‰æ–¹æ³• ...</span>
}
</code></pre>
<h5 data-id="heading-9">3.ä¿®æ”¹ src/graphic/shape/Circle.ts</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/shape/Circle.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Displayable</span>, <span class="hljs-title class_">DisplayableProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../Displayable'</span>;
â€‹
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">CircleProps</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">DisplayableProps</span> {
 Â  Â shape?: { cx?: <span class="hljs-built_in">number</span>, cy?: <span class="hljs-built_in">number</span>, r?: <span class="hljs-built_in">number</span> };
}
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Displayable</span> {
 Â  Â <span class="hljs-attr">shape</span>: { <span class="hljs-attr">cx</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">cy</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">r</span>: <span class="hljs-built_in">number</span> };
â€‹
 Â  Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">opts?: CircleProps</span>) {
 Â  Â  Â  Â <span class="hljs-comment">// ä¼ é€’ opts ç»™çˆ¶ç±»</span>
 Â  Â  Â  Â <span class="hljs-variable language_">super</span>(opts); 
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// å¤„ç†è‡ªå·±ç‰¹æœ‰çš„ shape</span>
 Â  Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">shape</span> = { <span class="hljs-attr">cx</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">cy</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">r</span>: <span class="hljs-number">0</span>, ...opts?.<span class="hljs-property">shape</span> };
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// ... buildPath ...</span>
}
</code></pre>
<h4 data-id="heading-10">B.è§£å†³<code>group</code>çš„ä½ç½®é—®é¢˜</h4>
<p>åœ¨ä¹‹å‰çš„ Painter.ts ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨ refresh å¾ªç¯æ¸²æŸ“åˆ—è¡¨æ—¶è°ƒç”¨ updateTransformã€‚ä½†å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è·å–åˆ°çš„æ˜¯<code>displayable</code>ç±»å‹çš„å›¾å½¢ï¼Œæ²¡æœ‰è®¡ç®—<code>group</code>è¿™ç§æ ¹å…ƒç´ çš„çŸ©é˜µã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š å°†â€œè®¡ç®—çŸ©é˜µâ€å’Œâ€œæ¸²æŸ“ç»˜åˆ¶â€åˆ†æˆäº†ä¸¤ä¸ªç‹¬ç«‹çš„éå†è¿‡ç¨‹ã€‚</p>
<ol start="0">
<li><strong>Update é˜¶æ®µ</strong>ï¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œ<strong>é€’å½’</strong>ï¼ˆDFSï¼‰éå†æ•´æ£µæ ‘ï¼Œè®¡ç®—æ‰€æœ‰èŠ‚ç‚¹çš„ globalTransformã€‚ä¿è¯çˆ¶çº§ä¸€å®šæ¯”å­çº§å…ˆè®¡ç®—ã€‚</li>
<li><strong>Render é˜¶æ®µ</strong>ï¼šè·å–æ‰å¹³åŒ–çš„ displayListï¼ˆå·²æ’åºï¼‰ï¼Œç›´æ¥ä½¿ç”¨è®¡ç®—å¥½çš„çŸ©é˜µè¿›è¡Œç»˜åˆ¶ã€‚</li>
</ol>
<p>æˆ‘ä»¬éœ€è¦ä¿®æ”¹ Painter.ts æˆ– Storage.ts æ¥ä½“ç°è¿™ä¸ªé€»è¾‘ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨ Painter.refresh ä¸­å…ˆæ›´æ ‘ï¼Œå†ç”»è¡¨ã€‚</p>
<h4 data-id="heading-11">ä¿®æ”¹ src/painter/Painter.ts</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/painter/Painter.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Painter</span> {
    <span class="hljs-comment">// ... </span>

    <span class="hljs-title function_">refresh</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> list = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_storage</span>.<span class="hljs-title function_">getDisplayList</span>();
        <span class="hljs-keyword">const</span> roots = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_storage</span>.<span class="hljs-title function_">getRoots</span>(); <span class="hljs-comment">// å‡è®¾ Storage æš´éœ²äº† _roots</span>
        <span class="hljs-keyword">const</span> ctx = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_ctx</span>;

        <span class="hljs-comment">// æ­¥éª¤ 0: ç¡®ä¿ Canvas å°ºå¯¸æ­£ç¡® (é˜²æ­¢ resize æ²¡è§¦å‘å¯¼è‡´ width=0)</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_width</span> === <span class="hljs-number">0</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>();

        <span class="hljs-comment">// æ­¥éª¤ 1: ä¼˜å…ˆæ›´æ–°å…¨åœºæ™¯å›¾çš„å˜æ¢çŸ©é˜µ (MiniRender æ ¸å¿ƒé€»è¾‘)</span>
        <span class="hljs-comment">// å¿…é¡»ä»æ ¹èŠ‚ç‚¹å¼€å§‹é€’å½’ï¼Œç¡®ä¿çˆ¶çº§çŸ©é˜µå…ˆäºå­çº§ç”Ÿæˆ</span>
        roots.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_updateElementTransform</span>(el));

        <span class="hljs-comment">// æ­¥éª¤ 2: æ¸…ç©ºç”»å¸ƒ</span>
        ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_width</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_height</span>);

        <span class="hljs-comment">// æ­¥éª¤ 3: ç»˜åˆ¶æ‰å¹³åˆ—è¡¨</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; list.<span class="hljs-property">length</span>; i++) {
            <span class="hljs-keyword">const</span> el = list[i];
            <span class="hljs-comment">// æ­¤æ—¶ el.globalTransform å·²ç»æ˜¯æ­£ç¡®çš„äº†ï¼Œç›´æ¥ç”»</span>
            el.<span class="hljs-title function_">brush</span>(ctx);
        }
    }

    <span class="hljs-comment">// é€’å½’æ›´æ–°å¸®åŠ©å‡½æ•°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_updateElementTransform</span>(<span class="hljs-params">el: Element</span>) {
        el.<span class="hljs-title function_">updateTransform</span>();
        <span class="hljs-comment">// å¦‚æœæ˜¯ Groupï¼Œé€’å½’æ›´æ–°å­èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> ((el <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">isGroup</span>) {
            <span class="hljs-keyword">const</span> children = (el <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">children</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_updateElementTransform</span>(children[i]);
            }
        }
    }
}
</code></pre>
<p><em>æ³¨æ„ï¼šä½ éœ€è¦åœ¨ Storage.ts ä¸­å¢åŠ ä¸€ä¸ª getRoots() æ–¹æ³•æ¥è¿”å› _roots æ•°ç»„ã€‚</em></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// src/storage/Storage.ts</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">getRoots</span><span class="hljs-params">()</span>: Element[] {</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._roots;
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f6a2636a84946d5b502aa6a9aac6511~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXJpc2Vz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334016&amp;x-signature=%2F0%2FBxXYmql2kcqG%2BHOZHg1gnCh8%3D" alt="åŠ¨ç”».gif" loading="lazy"/></p>
<p>æ­¤æ—¶å„å›¾å½¢ä½ç½®å°†æ­£ç¡®å±•ç¤ºåœ¨ç”»å¸ƒä¸­ã€‚</p>
<p>!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š3.äº¤äº’ç³»ç»Ÿ(Handle)çš„å®ç°]]></title>    <link>https://juejin.cn/post/7579093412332716042</link>    <guid>https://juejin.cn/post/7579093412332716042</guid>    <pubDate>2025-12-03T02:36:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579093412332716042" data-draft-id="7579093412332650506" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š3.äº¤äº’ç³»ç»Ÿ(Handle)çš„å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2025-12-03T02:36:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="irises"/> <meta itemprop="url" content="https://juejin.cn/user/3030697436261735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š3.äº¤äº’ç³»ç»Ÿ(Handle)çš„å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030697436261735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    irises
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:36:15.000Z" title="Wed Dec 03 2025 02:36:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flz6060788%2FMini-Render" target="_blank" title="https://github.com/lz6060788/Mini-Render" ref="nofollow noopener noreferrer">MiniRenderä»“åº“åœ°å€å‚è€ƒ</a></p>
</blockquote>
<p>è¦å®ç°äº¤äº’ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³ä¸‰ä¸ªå±‚é¢çš„é—®é¢˜ï¼š</p>
<ol>
<li><strong>æ•°å­¦å±‚</strong>ï¼šçŸ©é˜µæ±‚é€†ï¼ˆä¸ºäº†æŠŠé¼ æ ‡ç‚¹è½¬æ¢åˆ°å›¾å½¢å†…éƒ¨åæ ‡ç³»ï¼‰ã€‚</li>
<li><strong>åŸºç±»å±‚</strong>ï¼šäº‹ä»¶è®¢é˜…æœºåˆ¶ï¼ˆOn/Offï¼‰å’ŒåŒ…å«åˆ¤æ–­æ¥å£ï¼ˆContainï¼‰ã€‚</li>
<li><strong>æ§åˆ¶å±‚</strong>ï¼šç›‘å¬ DOM äº‹ä»¶å¹¶åˆ†å‘ç»™å›¾å½¢ã€‚</li>
</ol>
<h3 data-id="heading-0">1.æ•°å­¦å·¥å…·å‡çº§ (çŸ©é˜µæ±‚é€†)</h3>
<p>æˆ‘ä»¬åœ¨ <code>src/utils/matrix.ts</code> ä¸­åªå®ç°äº†ä¹˜æ³•å’Œåˆæˆã€‚ä¸ºäº†åšç¢°æ’æ£€æµ‹ï¼Œæˆ‘ä»¬éœ€è¦<strong>é€†çŸ©é˜µ</strong>ã€‚
å›¾å½¢è¢«å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾äº†ã€‚åˆ¤æ–­ç‚¹ <code>(100, 100)</code> æ˜¯å¦åœ¨è¢«æ—‹è½¬äº† 30 åº¦çš„çŸ©å½¢é‡Œå¾ˆéš¾ï¼›ä½†æŠŠç‚¹é€†å‘æ—‹è½¬ 30 åº¦ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦åœ¨æœªæ—‹è½¬çš„çŸ©å½¢é‡Œå¾ˆç®€å•ã€‚</p>
<p>åœ¨ <code>src/utils/matrix.ts</code> ä¸­è¿½åŠ ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/utils/matrix.ts</span>

<span class="hljs-comment">/**
 * æ±‚é€†çŸ©é˜µ
 * out = invert(a)
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">invert</span>(<span class="hljs-params">out: MatrixArray, a: MatrixArray</span>): <span class="hljs-title class_">MatrixArray</span> {
    <span class="hljs-keyword">const</span> aa = a[<span class="hljs-number">0</span>], ac = a[<span class="hljs-number">2</span>], atx = a[<span class="hljs-number">4</span>];
    <span class="hljs-keyword">const</span> ab = a[<span class="hljs-number">1</span>], ad = a[<span class="hljs-number">3</span>], aty = a[<span class="hljs-number">5</span>];

    <span class="hljs-comment">// è®¡ç®—è¡Œåˆ—å¼</span>
    <span class="hljs-keyword">let</span> det = aa * ad - ab * ac;
    <span class="hljs-keyword">if</span> (!det) {
        <span class="hljs-comment">// è¡Œåˆ—å¼ä¸º0ï¼Œæ— æ³•æ±‚é€†ï¼Œè¿”å› null æˆ– è®¾ä¸ºå•ä½çŸ©é˜µ</span>
        <span class="hljs-keyword">return</span> [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>; <span class="hljs-comment">// ç®€å•å¤„ç†</span>
    }
    det = <span class="hljs-number">1.0</span> / det;

    out[<span class="hljs-number">0</span>] = ad * det;
    out[<span class="hljs-number">1</span>] = -ab * det;
    out[<span class="hljs-number">2</span>] = -ac * det;
    out[<span class="hljs-number">3</span>] = aa * det;
    out[<span class="hljs-number">4</span>] = (ac * aty - ad * atx) * det;
    out[<span class="hljs-number">5</span>] = (ab * atx - aa * aty) * det;
    <span class="hljs-keyword">return</span> out;
}
</code></pre>
<h3 data-id="heading-1">2.å®ç°äº‹ä»¶ä¸­å¿ƒ (Eventful)</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç±»æ¥ç®¡ç† <code>.on</code>, <code>.trigger</code>ã€‚</p>
<p>åˆ›å»º <code>src/core/Eventful.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/core/Eventful.ts</span>

<span class="hljs-keyword">type</span> <span class="hljs-title class_">EventHandler</span> = <span class="hljs-function">(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> <span class="hljs-built_in">void</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Eventful</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_handlers</span>: { [<span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-title class_">EventHandler</span>[] } = {};

    <span class="hljs-title function_">on</span>(<span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">handler</span>: <span class="hljs-title class_">EventHandler</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_handlers</span>[event]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_handlers</span>[event] = [];
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_handlers</span>[event].<span class="hljs-title function_">push</span>(handler);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }

    <span class="hljs-title function_">off</span>(event?: <span class="hljs-built_in">string</span>, handler?: <span class="hljs-title class_">EventHandler</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-comment">// ç®€åŒ–å®ç°ï¼šæ¸…ç©ºæŒ‡å®šäº‹ä»¶æˆ–å…¨éƒ¨</span>
        <span class="hljs-keyword">if</span> (event &amp;&amp; !handler) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_handlers</span>[event] = [];
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!event) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_handlers</span> = {};
        }
        <span class="hljs-comment">// å®Œæ•´å®ç°è¿˜éœ€è¦å¤„ç†ç§»é™¤ç‰¹å®š handlerï¼Œè¿™é‡Œç•¥è¿‡</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }

    <span class="hljs-title function_">trigger</span>(<span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>, ...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[]): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">const</span> handlers = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_handlers</span>[event];
        <span class="hljs-keyword">if</span> (handlers) {
            handlers.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> h.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args));
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
}
</code></pre>
<p>è®© <code>Element</code> ç»§æ‰¿ <code>Eventful</code>ã€‚
ä¿®æ”¹ <code>src/graphic/Element.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Eventful</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../core/Eventful'</span>;
<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Element</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Eventful</span> { 
    <span class="hljs-comment">// ... </span>
}
</code></pre>
<h3 data-id="heading-2">3.å›¾å½¢æ‹¾å–é€»è¾‘ (Element &amp; Shape)</h3>
<p>æˆ‘ä»¬éœ€è¦åœ¨ <code>Displayable</code> ä¸­å®šä¹‰æ ‡å‡†ï¼Œå¹¶åœ¨ <code>Circle</code> ä¸­å®ç°å…·ä½“ç®—æ³•ã€‚</p>
<p><strong>1. ä¿®æ”¹ <code>src/graphic/Element.ts</code></strong>
å¢åŠ åæ ‡è½¬æ¢æ–¹æ³•ã€‚è¿™æ˜¯äº¤äº’çš„æ ¸å¿ƒã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/Element.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Element</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Eventful</span> {
    <span class="hljs-comment">// ... åŸæœ‰ä»£ç  ...</span>

    <span class="hljs-comment">// è¾…åŠ©çŸ©é˜µï¼Œé¿å…é‡å¤åˆ›å»ºå¯¹è±¡ (GCä¼˜åŒ–)</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">_invertMat</span>: <span class="hljs-title class_">MatrixArray</span> = matrix.<span class="hljs-title function_">create</span>();

    <span class="hljs-comment">/**
     * å°†å…¨å±€åæ ‡è½¬æ¢åˆ°å½“å‰å…ƒç´ çš„å±€éƒ¨åæ ‡ç³»
     * <span class="hljs-doctag">@param</span> x å…¨å±€ x
     * <span class="hljs-doctag">@param</span> y å…¨å±€ y
     * <span class="hljs-doctag">@return</span> [localX, localY]
     */</span>
    <span class="hljs-title function_">globalToLocal</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Point</span> {
        <span class="hljs-keyword">const</span> m = <span class="hljs-variable language_">this</span>.<span class="hljs-property">globalTransform</span>;
        <span class="hljs-comment">// è®¡ç®—é€†çŸ©é˜µ</span>
        <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œç”¨ç®€å•çš„é™æ€å˜é‡ç¼“å­˜é€†çŸ©é˜µï¼Œéçº¿ç¨‹å®‰å…¨ä½†JSæ˜¯å•çº¿ç¨‹æ‰€ä»¥OK</span>
        <span class="hljs-keyword">const</span> inv = <span class="hljs-title class_">Element</span>.<span class="hljs-property">_invertMat</span>;
        matrix.<span class="hljs-title function_">invert</span>(inv, m);

        <span class="hljs-comment">// åº”ç”¨é€†å˜æ¢: x' = a*x + c*y + tx</span>
        <span class="hljs-keyword">const</span> lx = inv[<span class="hljs-number">0</span>] * x + inv[<span class="hljs-number">2</span>] * y + inv[<span class="hljs-number">4</span>];
        <span class="hljs-keyword">const</span> ly = inv[<span class="hljs-number">1</span>] * x + inv[<span class="hljs-number">3</span>] * y + inv[<span class="hljs-number">5</span>];
        
        <span class="hljs-keyword">return</span> [lx, ly];
    }
}
</code></pre>
<p><strong>2. ä¿®æ”¹ <code>src/graphic/Displayable.ts</code></strong>
å¢åŠ æŠ½è±¡æ–¹æ³• <code>contain</code>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/Displayable.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Displayable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Element</span> {
    <span class="hljs-comment">// ... åŸæœ‰ä»£ç  ...</span>

    <span class="hljs-comment">/**
     * åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å›¾å½¢å†…
     * <span class="hljs-doctag">@param</span> x å…¨å±€ x
     * <span class="hljs-doctag">@param</span> y å…¨å±€ y
     */</span>
    <span class="hljs-title function_">contain</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">boolean</span> {
        <span class="hljs-comment">// 1. è½¬æ¢ä¸ºå±€éƒ¨åæ ‡</span>
        <span class="hljs-keyword">const</span> local = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">globalToLocal</span>(x, y);
        <span class="hljs-comment">// 2. è°ƒç”¨å…·ä½“å½¢çŠ¶çš„å‡ ä½•åˆ¤æ–­</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">containLocal</span>(local[<span class="hljs-number">0</span>], local[<span class="hljs-number">1</span>]);
    }

    <span class="hljs-comment">/**
     * å…·ä½“å½¢çŠ¶å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œåˆ¤æ–­å±€éƒ¨åæ ‡æ˜¯å¦åœ¨è·¯å¾„å†…
     */</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-title function_">containLocal</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">boolean</span>;
}
</code></pre>
<p><strong>3. ä¿®æ”¹ <code>src/graphic/shape/Circle.ts</code></strong>
å®ç°åœ†å½¢çš„å‡ ä½•åˆ¤æ–­ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/shape/Circle.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Displayable</span> {
    <span class="hljs-comment">// ... åŸæœ‰ä»£ç  ...</span>

    <span class="hljs-title function_">containLocal</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">boolean</span> {
        <span class="hljs-comment">// åœ†å½¢åˆ¤æ–­å¾ˆç®€å•ï¼šç‚¹åˆ°åœ†å¿ƒçš„è·ç¦» &lt; åŠå¾„</span>
        <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œçš„ x,y å·²ç»æ˜¯ç»è¿‡é€†å˜æ¢çš„ï¼Œæ‰€ä»¥æ˜¯åœ¨åœ†æ²¡æœ‰è¢«æ—‹è½¬ç¼©æ”¾çš„åæ ‡ç³»ä¸‹</span>
        <span class="hljs-comment">// è€Œ this.shape.cx/cy ä¹Ÿæ˜¯åœ¨è¿™ä¸ªåæ ‡ç³»ä¸‹</span>
        <span class="hljs-keyword">const</span> d2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(x - <span class="hljs-variable language_">this</span>.<span class="hljs-property">shape</span>.<span class="hljs-property">cx</span>, <span class="hljs-number">2</span>) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(y - <span class="hljs-variable language_">this</span>.<span class="hljs-property">shape</span>.<span class="hljs-property">cy</span>, <span class="hljs-number">2</span>);
        <span class="hljs-keyword">return</span> d2 &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">shape</span>.<span class="hljs-property">r</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">shape</span>.<span class="hljs-property">r</span>;
    }
}
</code></pre>
<h3 data-id="heading-3">4.å®ç° Handler æ§åˆ¶å™¨</h3>
<p>è¿™æ˜¯æœ€åä¸€å—æ‹¼å›¾ã€‚å®ƒç›‘å¬ DOM äº‹ä»¶ï¼Œæ‰¾åˆ°å›¾å½¢ï¼Œç„¶åç”±å›¾å½¢è§¦å‘äº‹ä»¶ã€‚</p>
<p>åˆ›å»º <code>src/handler/Handler.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/handler/Handler.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Storage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../storage/Storage'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Painter</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../painter/Painter'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Displayable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../graphic/Displayable'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Handler</span> {
    <span class="hljs-attr">storage</span>: <span class="hljs-title class_">Storage</span>;
    <span class="hljs-attr">painter</span>: <span class="hljs-title class_">Painter</span>;
    <span class="hljs-attr">dom</span>: <span class="hljs-title class_">HTMLElement</span>;

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">storage: Storage, painter: Painter, dom: HTMLElement</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span> = storage;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">painter</span> = painter;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span> = dom;

        <span class="hljs-comment">// åˆå§‹åŒ– DOM ç›‘å¬</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_initDomEvents</span>();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_initDomEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ç®€å•çš„ç›‘å¬ click äº‹ä»¶ä½œä¸ºç¤ºä¾‹</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_clickHandler</span>(e);
        });
        
        <span class="hljs-comment">// å®é™…è¿˜æœ‰ mousedown, mouseup, mousemove ç­‰å¤æ‚é€»è¾‘</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_clickHandler</span>(<span class="hljs-params">e: MouseEvent</span>) {
        <span class="hljs-comment">// 1. è·å–ç›¸å¯¹äº Canvas çš„åæ ‡</span>
        <span class="hljs-comment">// getBoundingClientRect åŒ…å«äº†é¡µé¢æ»šåŠ¨å’Œè¾¹æ¡†</span>
        <span class="hljs-keyword">const</span> rect = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-title function_">getBoundingClientRect</span>();
        <span class="hljs-comment">// Canvas çš„å®é™…åƒç´ å°ºå¯¸æ˜¯ CSS å°ºå¯¸çš„ dpr å€</span>
        <span class="hljs-keyword">const</span> x = (e.<span class="hljs-property">clientX</span> - rect.<span class="hljs-property">left</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-property">clientLeft</span>) * <span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span>;
        <span class="hljs-keyword">const</span> y = (e.<span class="hljs-property">clientY</span> - rect.<span class="hljs-property">top</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-property">clientTop</span>) * <span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span>;

        <span class="hljs-comment">// 2. å¯»æ‰¾è¢«ç‚¹å‡»çš„å›¾å½¢</span>
        <span class="hljs-keyword">const</span> target = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_findHover</span>(x, y);

        <span class="hljs-keyword">if</span> (target) {
            <span class="hljs-comment">// 3. è§¦å‘å›¾å½¢äº‹ä»¶</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Clicked shape:'</span>, target.<span class="hljs-property">id</span>);
            target.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">'click'</span>, { <span class="hljs-attr">target</span>: target, <span class="hljs-attr">event</span>: e });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Clicked empty space'</span>);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_findHover</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Displayable</span> | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">const</span> list = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">getDisplayList</span>();
        
        <span class="hljs-comment">// æ ¸å¿ƒï¼šé€†åºéå†ï¼</span>
        <span class="hljs-comment">// å› ä¸º displayList æ˜¯æŒ‰æ¸²æŸ“é¡ºåºæ’çš„ï¼ˆåé¢çš„ç›–åœ¨å‰é¢ï¼‰ï¼Œ</span>
        <span class="hljs-comment">// æ‰€ä»¥æˆ‘ä»¬æ£€æµ‹ç‚¹å‡»æ—¶ï¼Œè¦ä»æœ€ä¸Šé¢ï¼ˆæ•°ç»„æœ«å°¾ï¼‰å¼€å§‹æŸ¥ã€‚</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = list.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-keyword">const</span> el = list[i];
            
            <span class="hljs-comment">// å¿½ç•¥ä¸å¯è§æˆ–ä¸å“åº”é¼ æ ‡çš„å…ƒç´ </span>
            <span class="hljs-keyword">if</span> (el.<span class="hljs-property">invisible</span>) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// å¯ä»¥å†åŠ  ignoreMouse ç­‰æ ‡å¿—</span>

            <span class="hljs-comment">// ç¢°æ’æ£€æµ‹</span>
            <span class="hljs-keyword">if</span> (el.<span class="hljs-title function_">contain</span>(x, y)) {
                <span class="hljs-keyword">return</span> el;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<h3 data-id="heading-4">5.é›†æˆåˆ° <code>MiniRender</code></h3>
<p>ä¿®æ”¹ <code>src/core/MiniRender.ts</code>ï¼Œåˆå§‹åŒ– Handlerã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/core/MiniRender.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Handler</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../handler/Handler'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MiniRender</span> {
    <span class="hljs-attr">storage</span>: <span class="hljs-title class_">Storage</span>;
    <span class="hljs-attr">painter</span>: <span class="hljs-title class_">Painter</span>;
    <span class="hljs-attr">handler</span>: <span class="hljs-title class_">Handler</span>; <span class="hljs-comment">// æ–°å¢</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">dom: HTMLElement</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Storage</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">painter</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Painter</span>(dom, <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>);
        <span class="hljs-comment">// åˆå§‹åŒ–äº¤äº’ç³»ç»Ÿ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">handler</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">painter</span>, dom);
    }
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<h3 data-id="heading-5">6.æµ‹è¯•</h3>
<p>ç°åœ¨æˆ‘ä»¬ä¿®æ”¹ <code>index.ts</code> æ¥æµ‹è¯•ç‚¹å‡»äº‹ä»¶ã€‚æˆ‘ä»¬åˆ©ç”¨ <code>Eventful</code> çš„èƒ½åŠ›ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// index.ts</span>
<span class="hljs-keyword">import</span> { init } <span class="hljs-keyword">from</span> <span class="hljs-string">'./core/MiniRender'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Group</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/Group'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Circle</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/shape/Circle'</span>;

<span class="hljs-keyword">const</span> miniRender = <span class="hljs-title function_">init</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'main'</span>)!);

<span class="hljs-keyword">const</span> group = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Group</span>({ <span class="hljs-attr">position</span>: [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>] });

<span class="hljs-comment">// ä¸€ä¸ªçº¢è‰²çš„åœ†</span>
<span class="hljs-keyword">const</span> circle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>({
    <span class="hljs-attr">shape</span>: { <span class="hljs-attr">r</span>: <span class="hljs-number">50</span> },
    <span class="hljs-attr">style</span>: { <span class="hljs-attr">fill</span>: <span class="hljs-string">'#F00'</span> }
});

<span class="hljs-comment">// ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼</span>
circle.<span class="hljs-title function_">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Circle Clicked!'</span>);
    <span class="hljs-comment">// ç‚¹å‡»å˜è‰²</span>
    <span class="hljs-keyword">if</span> (circle.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> === <span class="hljs-string">'#F00'</span>) {
        circle.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> = <span class="hljs-string">'#00F'</span>; <span class="hljs-comment">// å˜è“</span>
    } <span class="hljs-keyword">else</span> {
        circle.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> = <span class="hljs-string">'#F00'</span>; <span class="hljs-comment">// å˜çº¢</span>
    }
    miniRender.<span class="hljs-title function_">refresh</span>(); <span class="hljs-comment">// è®°å¾—æ‰‹åŠ¨åˆ·æ–°</span>
});

group.<span class="hljs-title function_">add</span>(circle);
miniRender.<span class="hljs-title function_">add</span>(group);

<span class="hljs-comment">// åŠ¨ç”»ï¼šè®©å®ƒæ—‹è½¬ï¼Œæµ‹è¯•æ—‹è½¬åçš„ç‚¹å‡»æ£€æµ‹æ˜¯å¦å‡†ç¡®</span>
<span class="hljs-keyword">let</span> angle = <span class="hljs-number">0</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">loop</span>(<span class="hljs-params"/>) {
    angle += <span class="hljs-number">0.01</span>;
    group.<span class="hljs-property">rotation</span> = angle;
    <span class="hljs-comment">// æ‰‹åŠ¨æ›´æ–° Group å±æ€§ï¼ŒPainter ä¼šåœ¨ refresh æ—¶è®¡ç®—çŸ©é˜µ</span>
    
    <span class="hljs-comment">// å¦‚æœæƒ³è¦ç‚¹å‡»ç”Ÿæ•ˆï¼Œä¸éœ€è¦ä¸€ç›´ refreshï¼Œä½†ä¸ºäº†çœ‹åŠ¨ç”»ï¼š</span>
    miniRender.<span class="hljs-title function_">refresh</span>();
    <span class="hljs-title function_">requestAnimationFrame</span>(loop);
}
<span class="hljs-title function_">loop</span>();
</code></pre>
<ol>
<li>å±å¹•ä¸Šæœ‰ä¸€ä¸ªæ—‹è½¬çš„åœ†ã€‚</li>
<li>å½“ä½ ç‚¹å‡»åœ†çš„å†…éƒ¨æ—¶ï¼Œæ§åˆ¶å°è¾“å‡º "Circle Clicked!"ï¼Œå¹¶ä¸”åœ†é¢œè‰²åœ¨çº¢è“ä¹‹é—´åˆ‡æ¢ã€‚</li>
<li><strong>å…³é”®ç‚¹</strong>ï¼šå³ä½¿åœ†æ—‹è½¬åˆ°äº†å¥‡æ€ªçš„è§’åº¦ï¼Œæˆ–è€…è¢« Group ç¼©æ”¾äº†ï¼Œåªè¦ä½ çš„é¼ æ ‡ç‚¹åœ¨è§†è§‰ä¸Šçš„åœ†å†…ï¼Œäº‹ä»¶å°±åº”è¯¥è§¦å‘ã€‚è¿™å°±æ˜¯ <code>invert</code> é€†çŸ©é˜µçš„ä½œç”¨ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/420e9954d47641198cee1394aa4ff60d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXJpc2Vz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334175&amp;x-signature=cq7KfcLe34yEN4FBcZ7y%2BjBkasE%3D" alt="handler.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Prompt æç¤ºè¯æŠ€å·§]]></title>    <link>https://juejin.cn/post/7579154364960227347</link>    <guid>https://juejin.cn/post/7579154364960227347</guid>    <pubDate>2025-12-03T02:39:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579154364960227347" data-draft-id="7578760249949356086" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Prompt æç¤ºè¯æŠ€å·§"/> <meta itemprop="keywords" content="LLM,Cursor"/> <meta itemprop="datePublished" content="2025-12-03T02:39:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å…µå¼ å¥"/> <meta itemprop="url" content="https://juejin.cn/user/1257497032405229"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Prompt æç¤ºè¯æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1257497032405229/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å…µå¼ å¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:39:06.000Z" title="Wed Dec 03 2025 02:39:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>LLM åŸç†æ˜¯æ ¹æ®å‰é¢çš„ token é¢„æµ‹åé¢çš„ tokenï¼ŒPrompt æ˜¯æœ€æ—©è¾“å…¥çš„ tokenã€‚</p>
<p>LLM æœ‰ä¸€äº›é…ç½®ä¹Ÿèƒ½å½±å“æ¨¡å‹è¾“å‡ºã€‚</p>
<h2 data-id="heading-0">å‚æ•°</h2>
<h3 data-id="heading-1">æ¸©åº¦ Temperature</h3>
<p>æ¸©åº¦æ˜¯ softmax å‡½æ•°ä¸­çš„é™¤æ•°ï¼Œä¸€èˆ¬å–å€¼ä» 0 ~ 1ï¼ˆ2ï¼‰ã€‚</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>z</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mi>T</mi></mrow></msup><mrow><msub><mo>âˆ‘</mo><mi>j</mi></msub><msup><mi>e</mi><mrow><msub><mi>z</mi><mi>j</mi></msub><mi mathvariant="normal">/</mi><mi>T</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(x_i) = \frac{e^{z_i / T}}{\sum_{j} e^{z_j / T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.9079em;vertical-align:-0.8372em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0707em;"><span style="top:-2.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1496em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4603em;"><span/></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"/><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0071em;"><span style="top:-3.0072em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.044em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"/><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5092em;"><span/></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9667em;"><span style="top:-2.9667em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.044em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"/><span class="mord mathnormal mtight">i</span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span/></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8372em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></p>
<p>æ¸©åº¦è¶Šä½ï¼Œç”Ÿæˆçš„ç»“æœè¶Šç¡®å®šï¼Œæ¸©åº¦è¶Šé«˜ï¼Œç”Ÿæˆçš„ç»“æœè¶Šéšæœºã€‚</p>
<p>åœ¨ä»£ç ã€æ•°å­¦ã€äº‹å®é—®é¢˜æ–¹é¢å–ä½å€¼ï¼›æ–‡å­¦åˆ›ä½œã€è¥é”€æ–¹é¢å–é«˜å€¼ã€‚</p>
<h3 data-id="heading-2">Top-K &amp; Top-P</h3>
<p>LLM é¢„æµ‹çš„ä¸‹ä¸€å † token ä¸­ï¼Œæ˜¯ä¸€ç¾¤æ¦‚ç‡åŠ èµ·æ¥ä¸º 1 çš„ tokenï¼ŒTop-K è¡¨ç¤ºæŒ‘é€‰å‰ K ä¸ªæ¦‚ç‡æœ€å¤§çš„ tokenï¼ŒTop-P è¡¨ç¤ºæŒ‘é€‰ç´¯è®¡æ¦‚ç‡è¶…è¿‡ P çš„å‰ n ä¸ª tokenã€‚</p>
<p>æ¯”å¦‚ token å¯¹åº”çš„æ¦‚ç‡é˜Ÿåˆ—æ˜¯ [0.4,0.3,0.2,0.1]ï¼ŒTop-K ä¸º 2 è¡¨ç¤ºå– [0.4,0.3]ï¼ŒTop-P ä¸º 0.3 å– [0.4]ã€‚</p>
<p>Top-P ä¹Ÿå«æ ¸é‡‡æ ·ï¼Œä¸€èˆ¬åªç”¨è¿™ä¸ªï¼Œå¦‚æœä¸¤ä¸ªéƒ½é…ç½®äº†åˆ™å–ä¸¤è€…ç»“æœçš„äº¤é›†ã€‚</p>
<h3 data-id="heading-3">è¾“å‡ºé•¿åº¦</h3>
<p>è¾“å‡ºé•¿åº¦è¡¨ç¤ºå›å¤ token çš„é•¿çŸ­ï¼Œç¼©å°è¾“å‡ºé•¿åº¦ä¸ä¼šè®©è¾“å‡ºæ›´ç®€æ´ï¼Œåªä¼šæˆªæ–­è¾“å‡ºã€‚</p>
<p>ä»¥ä¸Šæ˜¯å¸¸è§çš„å‚æ•°é…ç½®ï¼Œå½±å“è¾“å‡ºçš„è¿˜åŒ…å«è¯­æ°”ã€æªè¾ã€ä¸Šä¸‹æ–‡ç­‰ï¼Œè¿™äº›å¯ä»¥åœ¨ Prompt æç¤ºè¯ä¸­æŒ‡å®šã€‚</p>
<h2 data-id="heading-4">æç¤ºè¯æŠ€å·§</h2>
<h3 data-id="heading-5">æ ·æœ¬</h3>
<p>åœ¨ cursor çš„å®è·µä¸­ï¼Œæä¾›æ ·æœ¬æ¯”å¦‚è¯´ä¸€å †æŒ‡ä»¤æ•ˆæœæ›´å¥½ã€‚æ¯”å¦‚æä¾›æ ‡å‡†çš„ Service ä»£ç è§„èŒƒå¦‚ä½•ã€‚</p>
<p>æ ·æœ¬æ•°é‡ 3 ~ 5 ä¸ªæœ€ä½³ï¼Œç›®çš„æ˜¯ç»™ LLM ç¤ºä¾‹è®©ä»–æ¨¡ä»¿ï¼Œæ ·æœ¬è¦ä¹±åºï¼Œæ¯”å¦‚åˆ¤æ–­æƒ…ç»ªçš„ Prompt ä¸­ï¼Œæ­£é¢æƒ…ç»ªå’Œè´Ÿé¢æƒ…ç»ªçš„æ¡ˆä¾‹è¦æ‰“ä¹±éšæœºï¼Œå¦åˆ™æ¨¡å‹å¯èƒ½æŒ‰ç…§å‰ä¸‰ä¸ªæ˜¯æ­£é¢æƒ…ç»ªã€åä¸¤ä¸ªæ˜¯è´Ÿé¢æƒ…ç»ªçš„è§„å¾‹ç»™ç­”æ¡ˆã€‚</p>
<p>å¤æ‚åœºæ™¯è¦æä¾›è¾¹ç•Œæ¡ˆä¾‹ï¼Œå‘Šè¯‰ LLM åº”è¯¥å¦‚ä½•å¤„ç†ã€‚</p>
<h3 data-id="heading-6">æç¤ºè¯ç»“æ„</h3>
<p>ä¸€ä¸ªè‰¯å¥½çš„ Prompt åº”åŒ…å«ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptingï¼‰ã€è§’è‰²æç¤ºè¯ï¼ˆRole Promptingï¼‰å’Œä¸Šä¸‹æ–‡æç¤ºè¯ï¼ˆContextual Promptingï¼‰ã€‚</p>
<p>ç³»ç»Ÿæç¤ºè¯æä¾›æ•´ä½“çš„è§„åˆ™ã€è¾“å‡ºè§„èŒƒï¼Œæ¯”å¦‚ä»¥ josn æ ¼å¼è¾“å‡ºï¼Œä½¿ç”¨æ ¼å¼è§„èŒƒå¯ä»¥æœ‰æ•ˆæŠ‘åˆ¶ LLM çš„å¹»è§‰é—®é¢˜ï¼Œè¿™æ · LLM åªç”¨å…³æ³¨ json å†…çš„å€¼ï¼Œè€Œä¸ä¼šè¿‡äºéšæœºçš„äº§å‡ºå†…å®¹ã€‚</p>
<p>è§’è‰²æç¤ºè¯ç»™ LLM è®¾ç½®äººè®¾ï¼Œå¯ä»¥æ§åˆ¶è¾“å‡ºé£æ ¼ã€è¯­æ°”å’Œç›¸å…³è”çš„çŸ¥è¯†ï¼Œæ¯”å¦‚è®¾ç½®å¯¼æ¸¸è§’è‰²ï¼Œè¾“å‡ºé‡Œå°±ä¼šæœ‰å¯¼æ¸¸ç‰¹æœ‰çš„é¢å¤–ä¿¡æ¯ã€‚</p>
<p>ä¸Šä¸‹æ–‡æç¤ºè¯æä¾›èƒŒæ™¯ä¿¡æ¯ï¼Œé¿å…è¾“å‡ºçš„å†…å®¹è¿‡äºç©ºæ³›ï¼Œä½¿å›ç­”æ›´ç²¾ç¡®ã€‚</p>
<p>æç¤ºè¯å†…å®¹æœ¬èº«ï¼Œè¦æ˜¯æ¸…æ™°çš„æŒ‡ä»¤ï¼Œä¸è¦ç»™æ¨¡æ£±ä¸¤å¯çš„è¯æœ¯ã€‚</p>
<h2 data-id="heading-7">æ¨ç†æŠ€å·§</h2>
<h3 data-id="heading-8">åé€€ä¸€æ­¥æç¤ºï¼ˆStep-back Promptingï¼‰</h3>
<p>åé€€ä¸€æ­¥æŒ‡çš„æ˜¯åœ¨å›ç­”æ‰€éœ€çš„é—®é¢˜å‰ï¼Œå…ˆç”¨ä¸€ä¸ªæç¤ºè¯æŠŠä¸Šä¸‹æ–‡è°ƒæ•´åˆ°åˆé€‚çš„çŠ¶æ€ï¼Œè¿™æ ·è·å¾—çš„å›ç­”æ›´å…·ä½“å’Œå®ç”¨ã€‚</p>
<p>æ¯”å¦‚åœ¨ cursor å®è·µä¸­æœ‰éå¸¸å¤šçš„ä»£ç è§„èŒƒæ–‡æ¡£ï¼Œå¦‚æœç›´æ¥å‘èµ·å‘½ä»¤ â€œ è¯·æ ¹æ®è§„èŒƒç”Ÿæˆ....â€ï¼Œç”Ÿæˆçš„ä»£ç å¯èƒ½æ˜¯æ²¡æœ‰éµå¾ªè§„èŒƒçš„ï¼Œè§£å†³æ–¹æ¡ˆå°±æ˜¯å…ˆæŠŠæ‰€éœ€çš„è§„èŒƒåŠ è½½åˆ°å¯¹è¯çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ¯”å¦‚åœ¨ç”Ÿæˆä»£ç å‰ï¼Œå…ˆè¯´ â€œ æŸ¥æ‰¾é¡¹ç›®ä¸­ Dao å’Œ Service çš„è§„èŒƒæœ‰å“ªäº›â€ï¼Œå†æ‰§è¡Œç”Ÿæˆä»£ç çš„å‘½ä»¤ã€‚</p>
<h3 data-id="heading-9">æ€ç»´é“¾ï¼ˆChain of Thought, CoTï¼‰</h3>
<p>åœ¨æ•°å­¦ã€é€»è¾‘æ¨ç†ä¸­ï¼Œå¦‚æœè®© LLM ç»™å‡ºç­”æ¡ˆï¼Œå¤§æ¦‚ç‡æ˜¯çŒœçš„ï¼Œä¸ºæ­¤éœ€è¦åŠ ä¸€äº›ä¸­é—´æ­¥éª¤ï¼Œå¸®åŠ© LLM æ›´å¥½çš„æ¨ç†ã€‚</p>
<p>è¿™ä¸ªåŸç†æ˜¯ LLM çš„æœ¬è´¨ä¸Šé¢„æµ‹ä¸‹ä¸€ä¸ª tokenï¼Œå¦‚æœåœ¨æ ·æœ¬ä¸­ç»™å‡ºå®Œæ•´çš„æ¨ç†è·¯å¾„ï¼Œå°±ä¼šè®© LLM åœ¨æ¨¡ä»¿è¿‡ç¨‹ä¸­ä¹Ÿæ”¹åŠ¨å†…éƒ¨å‘é‡ï¼Œéµå¾ªç‰¹å®šçš„è·¯å¾„å¯ä»¥è®©ç»“æœæ›´åŠ å‡†ç¡®ã€‚</p>
<p>åœ¨è¿™äº› Prompt ä¸­ï¼Œè¦æŠŠæ¸©åº¦å‚æ•°è°ƒä½ã€‚</p>
<h3 data-id="heading-10">è‡ªæˆ‘ä¸€è‡´æ€§ï¼ˆSelf-consistencyï¼‰</h3>
<p>å³ä½¿ç”¨åŒæ ·çš„ Prompt å’Œæ¨¡å‹å¤šæ¬¡è¿è¡Œï¼Œæ ¹æ®è¿è¡Œç»“æœæŠ•ç¥¨é€‰æ‹©ç›¸åŒç­”æ¡ˆæœ€å¤šçš„é‚£ç§ã€‚</p>
<p>è¿™ä¸ªæŠ€å·§ç”±äºå¤ªè´¹ token ä½¿ç”¨çš„æ¯”è¾ƒå°‘ã€‚</p>
<h3 data-id="heading-11">æ€ç»´æ ‘ï¼ˆTree of Thoughts, ToTï¼‰</h3>
<p>æ€ç»´é“¾æ˜¯ä¸€æ¡è·¯å¾„ï¼Œæ€ç»´æ ‘å°±æ˜¯å¤šæ¡è·¯å¾„ã€‚</p>
<p>é€»è¾‘æ¨ç†å¯¹æ¨¡å‹æ¥è¯´æ˜¯æœ€å›°éš¾çš„ï¼Œè¿™å’Œæ¨¡å‹æœ¬èº«çš„èƒ½åŠ›å…³ç³»æ›´å¤§ï¼Œä½¿ç”¨è¿™ç§æŠ€å·§åªèƒ½æœ‰é™çš„å¢åŠ æ¨ç†èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-12">æ¨ç† + è¡ŒåŠ¨ï¼ˆReason &amp; Actï¼‰</h3>
<p>ä¸º LLM åŠ ä¸Šå„ç§å¤–æŒ‚ï¼Œæ¯”å¦‚ MCPã€RAGã€Agent ç­‰ï¼Œè®©æ¨¡å‹è‡ªè¡Œæ€è€ƒå’Œå†³ç­–ï¼Œç”±ä¸»æ¨¡å‹å’Œå­æ¨¡å‹å’Œå·¥å…·å…±åŒå®Œæˆä»»åŠ¡ã€‚</p>
<p>æ¯”å¦‚åœ¨ cursor ä¸­åŠ å…¥é«˜å¾·åœ°å›¾çš„ MCP æä¾›è·¯çº¿è§„åˆ’èƒ½åŠ›ã€åŠ å…¥æœç´¢å·¥å…·æä¾›å¤–ç½‘æœç´¢èƒ½åŠ›ç­‰ç­‰ã€‚</p>
<h3 data-id="heading-13">è‡ªåŠ¨åŒ–æç¤ºå·¥ç¨‹ï¼ˆAPEï¼‰</h3>
<p>è®© AI ç”Ÿæˆä¸€ä¸ªæç¤ºè¯å·¥ç¨‹çš„æç¤ºè¯ï¼Œåœ¨å¯¹è¯ä¸­å£è¯­åŒ–æä¾›æ‰€éœ€çš„ä¸Šä¸‹æ–‡ã€ç›®æ ‡ç­‰ï¼Œå³å¯è®© AI æŒ‰ç…§è§„èŒƒç”Ÿæˆç‰¹å®šçš„æç¤ºè¯ã€‚</p>
<h2 data-id="heading-14">å…¶ä»–è¡¥å……</h2>
<ol>
<li>æä¾›ç¤ºä¾‹ï¼Œè¿™æ˜¯æœ€ç›´æ¥æœ‰æ•ˆçš„åŠæ³•ã€‚</li>
<li>ç®€æ´è®¾è®¡ï¼Œå¦‚æœäººç±»çœ‹ä¸æ‡‚ï¼Œé‚£ LLM ä¹Ÿä¸ä¼šç†è§£ã€‚</li>
<li>å…·ä½“è¾“å‡ºï¼Œæ˜ç¡®æŒ‡å®šè¾“å‡ºçš„æ ¼å¼ã€é£æ ¼ã€‚</li>
<li>æŒ‡ä»¤ç”±äºçº¦æŸï¼Œå³å¤šå‘Šè¯‰ LLM éœ€è¦ xxxxï¼Œå°‘è¯´ä¸è¦ xxxxã€‚</li>
<li>ä½¿ç”¨å˜é‡ï¼Œå¦‚  {city} ã€‚</li>
<li>ç¤ºä¾‹æ‰“ä¹±é¡ºåºã€‚</li>
<li>æ–‡æ¡£åŒ–ï¼ŒPrompt æ˜¯ä¸€ä¸ªä¸åœè¿­ä»£çš„è¿‡ç¨‹ï¼Œå»ºç«‹ä¸ªæ–‡æ¡£åº“åƒ git ä¸€æ ·è®°å½•å˜åŠ¨çš„åŸå› ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CharlesæŠ“åŒ…å·¥å…·ä½¿ç”¨æ–¹æ³• CharlesæŠ“åŒ…åˆ†æã€é…ç½®æ•™ç¨‹ã€ç½‘ç»œæ’æŸ¥æŠ€å·§ä¸æ‰‹æœºæŠ“åŒ…æ­¥éª¤]]></title>    <link>https://juejin.cn/post/7579095566900494376</link>    <guid>https://juejin.cn/post/7579095566900494376</guid>    <pubDate>2025-12-03T02:38:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579095566900494376" data-draft-id="7579169543231864832" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CharlesæŠ“åŒ…å·¥å…·ä½¿ç”¨æ–¹æ³• CharlesæŠ“åŒ…åˆ†æã€é…ç½®æ•™ç¨‹ã€ç½‘ç»œæ’æŸ¥æŠ€å·§ä¸æ‰‹æœºæŠ“åŒ…æ­¥éª¤"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T02:38:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼€å¿ƒå°±å¥½2025"/> <meta itemprop="url" content="https://juejin.cn/user/3850962908492660"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CharlesæŠ“åŒ…å·¥å…·ä½¿ç”¨æ–¹æ³• CharlesæŠ“åŒ…åˆ†æã€é…ç½®æ•™ç¨‹ã€ç½‘ç»œæ’æŸ¥æŠ€å·§ä¸æ‰‹æœºæŠ“åŒ…æ­¥éª¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3850962908492660/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼€å¿ƒå°±å¥½2025
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:38:37.000Z" title="Wed Dec 03 2025 02:38:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸï¼Œæ¯ä¸ªå·¥ç¨‹å¸ˆéƒ½ç»å†è¿‡ç±»ä¼¼çš„æ—¶åˆ»ï¼š</p>
<ul>
<li>æ˜æ˜è¯·æ±‚é€»è¾‘æ²¡æ”¹ï¼Œä½†çº¿ä¸Šç”¨æˆ·å‡ºç°å¼‚å¸¸</li>
<li>å¤šç¯å¢ƒå¹¶å­˜ï¼Œæ•°æ®æ¥æºå´â€œå¯¹ä¸ä¸Šâ€</li>
<li>ç§»åŠ¨ç«¯æ¥å£å¶å°”å¤±è´¥ï¼Œå´æ— æ³•å¤ç°</li>
<li>é¡µé¢åŠ è½½ç¼“æ…¢ï¼Œä½†ä»£ç å±‚é¢æ²¡æœ‰é—®é¢˜</li>
<li>å‚æ•°ä¼ è¾“è¢«ä¿®æ”¹ï¼Œå´æ— ä»åˆ¤æ–­å‘ç”Ÿåœ¨å“ªä¸€ç¯</li>
</ul>
<p>å½“ç³»ç»Ÿå˜å¾—å¤æ‚ï¼Œè¿™ç±»é—®é¢˜è¶Šæ¥è¶Šæ™®éã€‚
çœŸæ­£è®©å·¥ç¨‹å¸ˆä»â€œçŒœæµ‹â€èµ°å‘â€œç²¾å‡†åˆ¤æ–­â€çš„ï¼Œæ˜¯å¯¹ç½‘ç»œé“¾è·¯çš„è§‚å¯Ÿèƒ½åŠ›ã€‚</p>
<p>è€Œ <strong>Charles æŠ“åŒ…å·¥å…·</strong> å°±æ˜¯è¿™ç±»åœºæ™¯ä¸­çš„å…³é”®è§’è‰²ã€‚
å®ƒèƒ½è®©ä½ åœ¨æœ€çŸ­çš„æ—¶é—´å†…ç¡®è®¤ï¼šé—®é¢˜æ˜¯æ¥è‡ªå®¢æˆ·ç«¯ï¼ŸæœåŠ¡å™¨ï¼Ÿç½‘ç»œï¼Ÿè¿˜æ˜¯ç¯å¢ƒï¼Ÿ</p>
<p>ä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼Œå°†ä»é“¾è·¯è§†è§’æ‹†è§£ Charles æŠ“åŒ…çš„ä½¿ç”¨æ–¹æ³•ï¼Œæ›´é€‚åˆå¼€å‘è€…çœŸå®åœºæ™¯åº”ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆ Charles èƒ½æˆä¸ºç½‘ç»œè°ƒè¯•çš„â€œç¬¬ä¸€é€‰æ‹©â€ï¼Ÿ</h2>
<p>Charles çš„åŠŸèƒ½å¹¶ä¸ç¥ç§˜ï¼Œå®ƒä¹‹æ‰€ä»¥å¥½ç”¨ï¼Œæ˜¯å› ä¸ºå®ƒèƒ½å¤Ÿè§£å†³æœ€æ ¸å¿ƒçš„é—®é¢˜ï¼š
<strong>è®©å¼€å‘è€…çœ‹åˆ°çœŸå®çš„ç½‘ç»œè¡Œä¸ºã€‚</strong></p>
<p>çœŸå®è¡Œä¸ºåŒ…æ‹¬ï¼š</p>
<ul>
<li>è¯·æ±‚æ˜¯å¦çœŸæ­£å‘å‡º</li>
<li>å‚æ•°æ˜¯å¦å®Œæ•´ä¼ è¾“</li>
<li>HTTPS æ˜¯å¦æ­£ç¡®æ¡æ‰‹</li>
<li>è¯·æ±‚æœ‰æ²¡æœ‰è¢«å–æ¶ˆ</li>
<li>å“åº”æ˜¯å¦è¢«ä»£ç†ä¿®æ”¹</li>
<li>DNSã€SSLã€ç­‰å¾…æ—¶é—´åˆ†åˆ«æ˜¯å¤šå°‘</li>
<li>App æ˜¯å¦é‡å¤è§¦å‘è¯·æ±‚</li>
<li>ç¯å¢ƒæ˜¯å¦é”™è¯¯åˆ‡æ¢</li>
</ul>
<p>è¿™äº›ä¿¡æ¯åœ¨ä»£ç ä¸­å¾€å¾€æ˜¯ä¸å¯è§çš„ï¼Œæ—¥å¿—ä¹Ÿæ— æ³•å®Œå…¨è¿˜åŸé“¾è·¯ã€‚
ä½† Charles å¯ä»¥æŠŠæ•´ä¸ªæµç¨‹ç¿»è¯‘æˆå¯è§†åŒ–æ•°æ®ï¼Œè®©é—®é¢˜åœ¨ç¬¬ä¸€æ—¶é—´æš´éœ²å‡ºæ¥ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€Charles æŠ“åŒ…æ€ä¹ˆç”¨ï¼Ÿä¸‰æ­¥å³å¯çœ‹åˆ°ç¬¬ä¸€æ¡è¯·æ±‚</h2>
<p>è™½ç„¶ Charles æœ‰å¾ˆå¤šè¿›é˜¶åŠŸèƒ½ï¼Œä½†æŠ“ç¬¬ä¸€æ¡åŒ…éå¸¸å®¹æ˜“ã€‚</p>
<hr/>
<h3 data-id="heading-2"><strong>æ­¥éª¤ 1ï¼šå®‰è£… Charles æ ¹è¯ä¹¦ï¼ˆHTTPS è§£å¯†å¿…åšï¼‰</strong></h3>
<p>HTTPS é»˜è®¤åŠ å¯†ï¼Œéœ€è¦å®‰è£…è¯ä¹¦æ‰èƒ½çœ‹åˆ°æ•°æ®ã€‚</p>
<p>å®‰è£…æ–¹å¼ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Help â†’ SSL Proxying â†’ Install Charles Root Certificate
</code></pre>
<p>å®‰è£…ååœ¨é’¥åŒ™ä¸²ï¼ˆæˆ–è¯ä¹¦ç®¡ç†ï¼‰ä¸­è®¾ä¸ºâ€œå§‹ç»ˆä¿¡ä»»â€ã€‚</p>
<hr/>
<h3 data-id="heading-3"><strong>æ­¥éª¤ 2ï¼šå¼€å¯ SSL Proxying</strong></h3>
<p>è¯ä¹¦å®‰è£…åï¼Œè¿˜å¿…é¡»æ‰‹åŠ¨å¼€å¯è§£å¯†è§„åˆ™ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile">Proxy â†’ SSL Proxying Settings â†’ Add
<span class="hljs-section">Host: *</span>
<span class="hljs-section">Port: *</span>
</code></pre>
<p>è¿™æ · Charles æ‰ä¼šè‡ªåŠ¨è§£å¯†æ‰€æœ‰ HTTPS æµé‡ã€‚</p>
<hr/>
<h3 data-id="heading-4"><strong>æ­¥éª¤ 3ï¼šè®©ç³»ç»Ÿä»£ç†ç”Ÿæ•ˆ</strong></h3>
<p>Charles ä¼šè‡ªåŠ¨æ¥ç®¡ç³»ç»Ÿä»£ç†ã€‚
å¦‚æœæŠ“ä¸åˆ°åŒ…ï¼Œä¸€èˆ¬æ˜¯ï¼š</p>
<ul>
<li>VPN è¦†ç›–ç³»ç»Ÿä»£ç†</li>
<li>ä»£ç†å·¥å…·ï¼ˆClashã€Surgeã€Proxy SwitchyOmegaï¼‰æ¥ç®¡</li>
<li>æµè§ˆå™¨æœªä½¿ç”¨ç³»ç»Ÿä»£ç†</li>
</ul>
<p>å…³é—­å†²çªè½¯ä»¶å³å¯æ¢å¤æ­£å¸¸ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œæœ¬æœºæŠ“åŒ…å·²ç»å¯ä»¥é¡ºç•…è¿è¡Œã€‚</p>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€Charles æ‰‹æœºæŠ“åŒ…ï¼šå¤šæ•°ç–‘éš¾é—®é¢˜å¿…é¡»ç”¨çœŸå®è®¾å¤‡æŸ¥çœ‹</h2>
<p>ç§»åŠ¨ç«¯æ˜¯ç½‘ç»œé—®é¢˜çš„â€œé‡ç¾åŒºâ€ï¼š</p>
<ul>
<li>ç½‘ç»œåˆ‡æ¢ï¼ˆWiFi â‡„ 4G/5Gï¼‰å¯¼è‡´è¯·æ±‚è¢«ä¸­æ–­</li>
<li>å¼±ç½‘å¯¼è‡´æ¡æ‰‹å¤±è´¥</li>
<li>App åå°åˆ‡æ¢é€ æˆè¯·æ±‚å–æ¶ˆ</li>
<li>ä¸åŒè®¾å¤‡ç¼“å­˜ç­–ç•¥ä¸åŒ</li>
<li>æŸäº›æœºå‹ä¼šè‡ªåŠ¨å‹ç¼©æ•°æ®</li>
</ul>
<p>æµè§ˆå™¨æˆ–æ¨¡æ‹Ÿå™¨æ— æ³•æ¨¡æ‹Ÿè¿™äº›è¡Œä¸ºï¼Œåªèƒ½ä¾èµ– Charlesã€‚</p>
<hr/>
<h3 data-id="heading-6"><strong>æ‰‹æœºæŠ“åŒ…æ­¥éª¤</strong></h3>
<h4 data-id="heading-7"><strong>1. æ‰‹æœºä¸ç”µè„‘å¿…é¡»åœ¨åŒä¸€ Wi-Fi ä¸‹</strong></h4>
<p>è¿™æ˜¯ Charles å·¥ä½œåŸç†å†³å®šçš„ã€‚</p>
<h4 data-id="heading-8"><strong>2. è®¾ç½®æ‰‹åŠ¨ä»£ç†</strong></h4>
<p>æ‰‹æœº Wi-Fi â†’ æ‰‹åŠ¨ä»£ç†</p>
<ul>
<li>æœåŠ¡å™¨ï¼šç”µè„‘ IP</li>
<li>ç«¯å£ï¼š8888</li>
</ul>
<h4 data-id="heading-9"><strong>3. å®‰è£… Charles è¯ä¹¦</strong></h4>
<p>æ‰‹æœºæµè§ˆå™¨è¾“å…¥ï¼š
<code>chls.pro/ssl</code></p>
<p>iOS éœ€è¦é¢å¤–ä¿¡ä»»è¯ä¹¦ã€‚</p>
<h4 data-id="heading-10"><strong>4. æ‰“å¼€ Appï¼Œå³å¯çœ‹åˆ°æµé‡</strong></h4>
<p>è¿™æ˜¯ç§»åŠ¨ç«¯è°ƒè¯•æœ€å¸¸ç”¨çš„æ–¹å¼ã€‚</p>
<hr/>
<h2 data-id="heading-11">å››ã€å¦‚ä½•é˜…è¯» Charles æŠ“åŒ…æ•°æ®ï¼Ÿï¼ˆé“¾è·¯åˆ†ææ ¸å¿ƒï¼‰</h2>
<p>æŠ“åŒ…ä¸æ˜¯çœ‹ JSONï¼Œè€Œæ˜¯çœ‹æ•´ä¸ªç½‘ç»œè¡Œä¸ºã€‚</p>
<p>ä»¥ä¸‹å‡ ä¸ªç•Œé¢å¯¹äºè°ƒè¯•ç²¾å‡†åº¦è‡³å…³é‡è¦ã€‚</p>
<hr/>
<h3 data-id="heading-12"><strong>1. Structureï¼šæŒ‰åŸŸåæ•´ç†çš„å…¨å±€è§†å›¾</strong></h3>
<p>ä½ å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>è¯·æ±‚æ˜¯å¦èµ°å¯¹ç¯å¢ƒ</li>
<li>æ˜¯å¦å‘½ä¸­ CDN</li>
<li>æ˜¯å¦å‘ç”ŸåŸŸåè·³è½¬</li>
<li>æ˜¯å¦è®¿é—®æ—§ç‰ˆæœ¬æ¥å£</li>
</ul>
<p>ç¯å¢ƒæ··ä¹±çš„é—®é¢˜åœ¨è¿™é‡Œæœ€å®¹æ˜“å‘ç°ã€‚</p>
<hr/>
<h3 data-id="heading-13"><strong>2. Sequenceï¼šå¤ç°ç”¨æˆ·æ“ä½œçš„æ—¶é—´åºåˆ—</strong></h3>
<p>é€‚åˆæ£€æŸ¥ï¼š</p>
<ul>
<li>App æ˜¯å¦é‡å¤è§¦å‘è¯·æ±‚</li>
<li>æŸäº›è¯·æ±‚æ˜¯å¦è¢«å–æ¶ˆ</li>
<li>å¹¶å‘è¯·æ±‚çš„å®é™…æ‰§è¡Œé¡ºåº</li>
<li>UI æ“ä½œè§¦å‘çš„è¯·æ±‚é“¾è·¯</li>
</ul>
<p>å¾ˆå¤šâ€œå¶å‘æ€§é—®é¢˜â€åœ¨è¿™é‡Œèƒ½ç›´æ¥çœ‹åˆ°æ ¹å› ã€‚</p>
<hr/>
<h3 data-id="heading-14"><strong>3. Timelineï¼šåˆ†è§£è¯·æ±‚è€—æ—¶ï¼Œå®šä½æ€§èƒ½ç“¶é¢ˆ</strong></h3>
<p>Timeline èƒ½æ˜ç¡®å‘Šè¯‰ä½ å»¶è¿Ÿåœ¨å“ªä¸ªé˜¶æ®µå‘ç”Ÿï¼š</p>
<ul>
<li>DNS</li>
<li>SSL</li>
<li>Waitingï¼ˆåç«¯è€—æ—¶ï¼‰</li>
<li>Receivingï¼ˆä¸‹è½½è€—æ—¶ï¼‰</li>
</ul>
<p>å¾ˆå¤šå¼€å‘è€…è§‰å¾—â€œåç«¯æ…¢â€ï¼Œ
ç»“æœæŠ“åŒ…å‘ç° SSL æ¡æ‰‹å äº† 1 ç§’ä»¥ä¸Šã€‚</p>
<hr/>
<h3 data-id="heading-15"><strong>4. è¯·æ±‚è¯¦æƒ…ï¼šæœ€çœŸå®çš„æ•°æ®ä¼ è¾“æƒ…å†µ</strong></h3>
<p>è¿™é‡Œèƒ½çœ‹åˆ°ï¼š</p>
<ul>
<li>Header</li>
<li>Query å‚æ•°</li>
<li>Raw å†…å®¹</li>
<li>Cookies</li>
<li>JSON Body</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯å‰åç«¯å¯¹é½é—®é¢˜æ—¶çš„æœ€ç»ˆä¾æ®ã€‚</p>
<hr/>
<h2 data-id="heading-16">äº”ã€Charles çš„è¿›é˜¶æŠ€å·§ï¼šä¸æ˜¯å¿…é¡»ï¼Œä½†éå¸¸å¸¸ç”¨</h2>
<p>ä»¥ä¸‹åŠŸèƒ½æ˜¯å·¥ç¨‹å¸ˆåœ¨è°ƒè¯•æ—¶ç»å¸¸ä½¿ç”¨çš„æŠ€èƒ½ï¼š</p>
<hr/>
<h3 data-id="heading-17"><strong>1. Breakpointsï¼ˆæ–­ç‚¹æ‹¦æˆªï¼‰</strong></h3>
<p>é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>æ¨¡æ‹Ÿé”™è¯¯å“åº”</li>
<li>æ³¨å…¥éæ³•å‚æ•°</li>
<li>æµ‹è¯•å¼‚å¸¸æµç¨‹</li>
<li>æ¨¡æ‹Ÿå­—æ®µç¼ºå¤±</li>
</ul>
<p>æ–­ç‚¹å¯ä»¥å®Œå…¨æ§åˆ¶è¯·æ±‚å’Œå“åº”ã€‚</p>
<hr/>
<h3 data-id="heading-18"><strong>2. Map Localï¼ˆæœ¬åœ° Mockï¼‰</strong></h3>
<p>é€‚åˆï¼š</p>
<ul>
<li>åç«¯æ²¡å‡†å¤‡å¥½</li>
<li>UI è‡ªæµ‹</li>
<li>æ¼”ç¤ºç”¨ä¾‹</li>
<li>å¤šçŠ¶æ€åˆ‡æ¢</li>
</ul>
<p>æ— éœ€åŠ¨ä»£ç å³å¯è‡ªç”±æ¨¡æ‹Ÿè¿”å›å†…å®¹ã€‚</p>
<hr/>
<h3 data-id="heading-19"><strong>3. Rewriteï¼ˆè‡ªåŠ¨è§„åˆ™é‡å†™ï¼‰</strong></h3>
<p>å¯è‡ªåŠ¨ï¼š</p>
<ul>
<li>åˆ‡æ¢ Token</li>
<li>æ›¿æ¢ URL</li>
<li>è‡ªåŠ¨æ·»åŠ  Header</li>
<li>ä¿®æ”¹å“åº”å­—æ®µ</li>
</ul>
<p>é€‚åˆé¢‘ç¹è°ƒè¯•ã€ç¯å¢ƒæ··ä¹±çš„åœºæ™¯ã€‚</p>
<hr/>
<h3 data-id="heading-20"><strong>4. Throttleï¼ˆå¼±ç½‘æ¨¡æ‹Ÿï¼‰</strong></h3>
<p>å¯æ¨¡æ‹Ÿï¼š</p>
<ul>
<li>3G</li>
<li>é«˜å»¶è¿Ÿç½‘ç»œ</li>
<li>ä¸¢åŒ…</li>
<li>ä¸ç¨³å®šç½‘ç»œ</li>
</ul>
<p>ç§»åŠ¨ç«¯è°ƒè¯•æ—¶éå¸¸é‡è¦ã€‚</p>
<hr/>
<h2 data-id="heading-21">å…­ã€é¡¹ç›®ä¸­ Charles ç»å¸¸è§£å†³çš„å…¸å‹é—®é¢˜</h2>
<p>è¿™é‡Œåˆ—å‡ ä¸ªçœŸå®å·¥ç¨‹æ¡ˆä¾‹ã€‚</p>
<hr/>
<h3 data-id="heading-22"><strong>æ¡ˆä¾‹ 1ï¼šç”¨æˆ·ç™»å½•å¶å°”å¤±è´¥</strong></h3>
<p>æŠ“åŒ…ç»“æœï¼š
App åœ¨å¼±ç½‘åœºæ™¯ä¸‹è‡ªåŠ¨è§¦å‘äº†ä¸¤æ¬¡è¯·æ±‚ï¼ŒUI ä½¿ç”¨äº†é”™è¯¯çš„é‚£æ¬¡ã€‚</p>
<hr/>
<h3 data-id="heading-23"><strong>æ¡ˆä¾‹ 2ï¼šæŸäº›ç”¨æˆ·çœ‹åˆ°çš„æ•°æ®ç‰ˆæœ¬ä¸å¯¹</strong></h3>
<p>åŸå› ï¼š
CDN å‘½ä¸­äº†æ—§ç¼“å­˜ï¼ŒStructure ä¸­å¯ç›´æ¥çœ‹åˆ°å“åº” headerã€‚</p>
<hr/>
<h3 data-id="heading-24"><strong>æ¡ˆä¾‹ 3ï¼šè¯·æ±‚å‚æ•°ä¸¢å¤±ï¼Œä½†ä»£ç æ˜¾ç¤ºæ­£å¸¸</strong></h3>
<p>Raw è§†å›¾æ‰å‘ç°å­—æ®µç¼–ç å¼‚å¸¸ï¼Œæ­£å¼ä¼ è¾“å¹¶æœªæºå¸¦è¯¥å‚æ•°ã€‚</p>
<hr/>
<h3 data-id="heading-25"><strong>æ¡ˆä¾‹ 4ï¼šæ¥å£å»¶è¿Ÿæé«˜ï¼Œåç«¯æ—¥å¿—å´æ˜¾ç¤ºæ­£å¸¸</strong></h3>
<p>Timeline æ˜¾ç¤ºï¼š
SSL è®¤è¯è€—æ—¶å äº†æ•´ä½“æ—¶é—´çš„ 70%ï¼Œå¹¶éåç«¯é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-26">ä¸ƒã€æ›´å¤šå›¾æ–‡æ­¥éª¤å¯å‚è€ƒ</h2>
<p>è‹¥ä½ éœ€è¦å®Œæ•´å›¾æ–‡æ•™ç¨‹ï¼Œå¯æŸ¥çœ‹<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fcharlesproxy.net%2F" target="_blank" title="https://charlesproxy.net/" ref="nofollow noopener noreferrer">charlesproxy.net/</a></strong></p>
<p>åŒ…å«ï¼š</p>
<ul>
<li>HTTPS æŠ“åŒ…</li>
<li>æ‰‹æœºæŠ“åŒ…</li>
<li>è¯ä¹¦é…ç½®</li>
<li>Rewrite/Mock å›¾æ–‡æ­¥éª¤</li>
<li>å¸¸è§é”™è¯¯è§£å†³æ–¹æ¡ˆ</li>
</ul>
<hr/>
<p>ç†Ÿç»ƒä½¿ç”¨ Charles çš„å¼€å‘è€…ï¼Œå¾€å¾€å…·å¤‡æ›´å®Œæ•´çš„ç³»ç»Ÿç†è§£èƒ½åŠ›ã€‚
å› ä¸ºç½‘ç»œè¡Œä¸ºæ˜¯æœ€æ¥è¿‘â€œçœŸå®ç”¨æˆ·åœºæ™¯â€çš„æ•°æ®æ¥æºã€‚</p>
<p>ä¼šæŠ“åŒ…ï¼Œå°±æ„å‘³ç€ä½ èƒ½ï¼š</p>
<ul>
<li>å®¢è§‚å®šä½é—®é¢˜</li>
<li>å¿«é€Ÿæ’æŸ¥é“¾è·¯</li>
<li>ç†è§£ç³»ç»Ÿçš„çœŸå®è¿ä½œæ–¹å¼</li>
<li>åœ¨å¤æ‚é¡¹ç›®ä¸­ä¿æŒåˆ¤æ–­èƒ½åŠ›</li>
</ul>
<p>Charles æä¾›çš„æ˜¯æ´å¯Ÿç³»ç»Ÿçš„çª—å£ï¼ŒçœŸæ­£æå‡çš„ï¼Œæ˜¯å·¥ç¨‹å¸ˆé—®é¢˜è§£å†³çš„èƒ½åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆè¯­è¨€æ¨¡å‹åçˆ±ä½¿ç”¨ç ´æŠ˜å·ï¼Ÿåé©³å¤šç§ä¸»æµè§£é‡Šï¼Œå¹¶æå‡ºçŒœæƒ³]]></title>    <link>https://juejin.cn/post/7579256547789963305</link>    <guid>https://juejin.cn/post/7579256547789963305</guid>    <pubDate>2025-12-03T02:26:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579256547789963305" data-draft-id="7579256547789865001" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆè¯­è¨€æ¨¡å‹åçˆ±ä½¿ç”¨ç ´æŠ˜å·ï¼Ÿåé©³å¤šç§ä¸»æµè§£é‡Šï¼Œå¹¶æå‡ºçŒœæƒ³"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-03T02:26:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Baihai_IDP"/> <meta itemprop="url" content="https://juejin.cn/user/3123071228582343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆè¯­è¨€æ¨¡å‹åçˆ±ä½¿ç”¨ç ´æŠ˜å·ï¼Ÿåé©³å¤šç§ä¸»æµè§£é‡Šï¼Œå¹¶æå‡ºçŒœæƒ³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3123071228582343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Baihai_IDP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:26:23.000Z" title="Wed Dec 03 2025 02:26:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ç¼–è€…æŒ‰ï¼š</strong> éš¾é“è¯­è¨€æ¨¡å‹å¯¹ç ´æŠ˜å·çš„åçˆ±ï¼ŒçœŸçš„åªæ˜¯å› ä¸ºå®ƒä»¬â€œå–œæ¬¢â€å—ï¼Ÿ</p>
<p>æˆ‘ä»¬ä»Šå¤©ä¸ºå¤§å®¶å¸¦æ¥çš„æ–‡ç« ï¼Œä½œè€…çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼šå½“å‰ä¸»æµå¤§è¯­è¨€æ¨¡å‹å¯¹ç ´æŠ˜å·çš„åçˆ±ï¼Œå¾ˆå¯èƒ½æºäºå…¶è®­ç»ƒæ•°æ®ä¸­å¤§é‡å¼•å…¥äº† 19 ä¸–çºªæœ«è‡³ 20 ä¸–çºªåˆçš„çº¸è´¨ä¹¦ç± â€”â€” è¿™äº›æ–‡æœ¬æœ¬èº«å°±æ¯”å½“ä»£è‹±è¯­æ›´é¢‘ç¹åœ°ä½¿ç”¨ç ´æŠ˜å·ã€‚</p>
<p>æ–‡ç« ç³»ç»Ÿæ¢³ç†å¹¶é€ä¸€åé©³äº†å¤šç§ä¸»æµè§£é‡Šï¼Œç„¶åé€šè¿‡åˆ†ææ ‡ç‚¹ä½¿ç”¨çš„å†å²è¶‹åŠ¿ã€å°¼æ—¥åˆ©äºšè‹±è¯­è¯­æ–™åº“ç»Ÿè®¡æ•°æ®ï¼Œä»¥åŠ GPT-3.5 åˆ° GPT-4o ç ´æŠ˜å·ä½¿ç”¨æ¿€å¢çš„æ—¶é—´èŠ‚ç‚¹ï¼Œæœ‰åŠ›æ”¯æ’‘äº†â€œæ—§ä¹¦æ•°å­—åŒ–â€è¿™ä¸€æœ€åˆç†çš„å‡è¯´ã€‚</p>
<p>å°½ç®¡è¿™ä¸€è§£é‡Šå±äºçŒœæƒ³ï¼Œå°šæœªå¾—åˆ°å®˜æ–¹è¯å®ï¼Œä½†å®ƒä¸ºæˆ‘ä»¬ç†è§£ AI å†™ä½œé£æ ¼æä¾›äº†ä¸€æ¡æœ‰è¶£çš„çº¿ç´¢ã€‚</p>
</blockquote>
<p><strong>ä½œè€… | Sean Goedecke</strong></p>
<p><strong>ç¼–è¯‘ | å²³æ‰¬</strong></p>
<p>å¦‚æœä½ è®©å¤§å¤šæ•°äººè¯´å‡º AI ç”Ÿæˆæ–‡æœ¬çš„ä¸€ä¸ªæ ‡å¿—æ€§ç‰¹å¾ï¼Œä»–ä»¬å¾ˆå¯èƒ½ä¼šè¯´ç ´æŠ˜å· â€”â€” å°±åƒè¿™æ ·ã€‚è¯­è¨€æ¨¡å‹å¯¹ç ´æŠ˜å·çš„ä½¿ç”¨å·²é¢‘ç¹åˆ°è®©çœŸæ­£å–œçˆ±ç ´æŠ˜å·çš„çœŸäººä½¿ç”¨è€…æœ›è€Œå´æ­¥[1]ï¼Œç”Ÿæ€•è‡ªå·±çš„æ–‡å­—è¢«è¯¯è®¤ä¸º AI æ‰€ä½œã€‚æ›´ä»¤äººæ„å¤–çš„æ˜¯ï¼Œè¦æƒ³é€šè¿‡æç¤ºè¯è®©æ¨¡å‹é¿å…ä½¿ç”¨ç ´æŠ˜å·ï¼Œç«Ÿå‡ºå¥‡åœ°å›°éš¾ï¼šæ¯”å¦‚ OpenAI è®ºå›ä¸Šçš„è¿™ä¸ªå¸–å­[2]ï¼Œè®¸å¤šç”¨æˆ·åœ¨æ­¤åˆ†äº«äº†è‡ªå·±å¤±è´¥çš„å°è¯•ç»å†ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å±…ç„¶è‡³ä»Šæœªèƒ½çœŸæ­£ç ´è¯‘è¯­è¨€æ¨¡å‹ç—´è¿·ç ´æŠ˜å·çš„åŸå› ï¼Œç€å®æœ‰äº›è¯¡å¼‚ã€‚</p>
<h2 data-id="heading-0"><strong>01 éš¾ä»¥ä»¤æˆ‘ä¿¡æœçš„å‡ ç§è§£é‡Š</strong></h2>
<p>ä¸€ç§å¸¸è§è¯´æ³•æ˜¯ï¼Œæ­£å¸¸çš„è‹±è¯­æ–‡æœ¬ä¸­æœ¬æ¥å°±å¤§é‡ä½¿ç”¨ç ´æŠ˜å·ï¼Œå› æ­¤è¿™åªæ˜¯æ¨¡å‹ä»è®­ç»ƒæ•°æ®ä¸­å­¦åˆ°çš„è¡Œä¸ºã€‚æˆ‘è§‰å¾—è¿™å¾ˆéš¾ä»¤äººä¿¡æœï¼ŒåŸå› å¾ˆç®€å•ï¼š<strong>å¦‚æœ AI ä½¿ç”¨ç ´æŠ˜å·çš„é¢‘ç‡ä¸äººç±»ç›¸å½“ï¼Œé‚£å®ƒå°±ä¸ä¼šæ¯”å…¶ä»–æ ‡ç‚¹ç¬¦å·æ›´å¼•äººæ³¨æ„äº†ã€‚</strong></p>
<p>å¦ä¸€ç§æˆ‘ä¸å¤ªè®¤åŒçš„è§£é‡Šæ˜¯ï¼šAI æ¨¡å‹å–œæ¬¢ç ´æŠ˜å·ï¼Œæ˜¯å› ä¸ºå®ƒç”¨é€”å¤ªçµæ´»ã€‚å½“æ¨¡å‹è¯•å›¾é¢„æµ‹ä¸‹ä¸€ä¸ª token æ—¶ï¼Œä½¿ç”¨ç ´æŠ˜å·èƒ½è®©å®ƒä¿ç•™æ›´å¤šé€‰æ‹© â€”â€” æ—¢å¯ä»¥ç»§ç»­å½“å‰è¯é¢˜ï¼Œä¹Ÿå¯ä»¥çªç„¶è½¬å‘æ–°è§‚ç‚¹ã€‚æ—¢ç„¶æ¨¡å‹çš„ç›®æ ‡åªæ˜¯é€‰æ‹©ä¸‹ä¸€ä¸ªæœ€å¯èƒ½å‡ºç°çš„ tokenï¼Œé‚£å®ƒä¼šä¸ä¼šåªæ˜¯å› ä¸ºæƒ³â€œç¨³å¦¥è¡Œäº‹â€ï¼Œæ‰€ä»¥é€‰äº†ç ´æŠ˜å·ï¼Ÿæˆ‘ä¸è¿™ä¹ˆè®¤ä¸ºã€‚<strong>é¦–å…ˆï¼Œå…¶ä»–æ ‡ç‚¹ç¬¦å·åŒæ ·å…·å¤‡çµæ´»æ€§ï¼›å…¶æ¬¡ï¼Œâ€œç¨³å¦¥è¡Œäº‹â€è¿™ä¸ªè¯´æ³•æœ¬èº«ä¹Ÿä¸å¤ªé€‚åˆç”¨æ¥ç†è§£æ¨¡å‹å¦‚ä½•ç”Ÿæˆæ–‡æœ¬ã€‚</strong></p>
<p>è¿˜æœ‰äººè®¤ä¸º[3]ï¼ŒAI ä½¿ç”¨ç ´æŠ˜å·æ˜¯å› ä¸ºæ¨¡å‹è®­ç»ƒè¿‡ç¨‹æ˜¾å¼åœ°åå‘ç®€æ´æ€§ï¼Œè€Œç ´æŠ˜å·çš„è¯å…ƒæ•ˆç‡å¾ˆé«˜ã€‚æ ¹æ®æˆ‘å¯¹ OpenAI åˆ†è¯å™¨[4]çš„æµ‹è¯•ï¼Œç ´æŠ˜å·æœ¬èº«å¹¶ä¸å¤©ç„¶æ›´çœ tokenï¼Œä½†å¯ä»¥æƒ³è±¡ï¼Œä¸ç”¨å®ƒçš„è¯å¯èƒ½å°±å¾—å†™ä¸€äº›è¿æ¥è¯ï¼Œæ¯”å¦‚ â€œ, thereforeâ€ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä¾ç„¶ä¸ä¿¡è¿™å¥—è¯´æ³•ã€‚è®¸å¤šç ´æŠ˜å·ï¼ˆæ¯”å¦‚å¸¸è§çš„ â€œitâ€™s not X â€“ itâ€™s Yâ€ ç»“æ„ï¼‰å®Œå…¨å¯ä»¥æ¢æˆé€—å·ï¼Œè€Œé€—å·åŒæ ·ç®€æ´ã€‚æ­¤å¤–ï¼Œæˆ‘ä¹Ÿä¸è®¤ä¸º GPT-4o ä¼šæ‰§ç€äºç®€æ´åˆ°è¿™ç§ç¨‹åº¦ï¼Œéè¦å¯¹æ ‡ç‚¹ç¬¦å·åšè¿™ç§ä¼˜åŒ–ï¼š<strong>å¦‚æœå®ƒçœŸæƒ³èŠ‚çœ tokenï¼Œå¤§å¯å°‘è¯´äº›åºŸè¯ã€‚</strong></p>
<h2 data-id="heading-1"><strong>02 ç ´æŠ˜å·çš„ä½¿ç”¨ä¼šä¸ä¼šæ˜¯é€šè¿‡ RLHF ä»éæ´²è‹±è¯­ä¸­å¼•å…¥çš„ï¼Ÿ</strong></h2>
<p>æˆ‘èŠ±äº†ä¸å°‘æ—¶é—´ç ”ç©¶çš„ä¸€ç§ç†è®ºè®¤ä¸ºï¼Œç ´æŠ˜å·çš„ä½¿ç”¨å¯èƒ½åæ˜ äº† RLHF æ ‡æ³¨äººå‘˜çš„è‹±è¯­ä½¿ç”¨ä¹ æƒ¯ã€‚è¯­è¨€æ¨¡å‹è®­ç»ƒçš„æœ€åé˜¶æ®µåŒ…å« RLHFï¼ˆåŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ ï¼‰ï¼šç®€å•æ¥è¯´ï¼Œæ•°ç™¾åæµ‹è¯•äººå‘˜ä¼šä¸æ¨¡å‹äº’åŠ¨ï¼Œå¹¶å¯¹æ¨¡å‹çš„è¾“å‡ºè¿›è¡Œæ‰“åˆ†ï¼Œè¿™äº›è¯„åˆ†å†è¢«åé¦ˆç»™æ¨¡å‹ï¼Œä»¥æå‡å…¶å‹å¥½åº¦å’Œå®ç”¨æ€§ã€‚</p>
<p>å‡ºäºæˆæœ¬è€ƒé‡ï¼ŒAI å…¬å¸å€¾å‘äºåœ¨ç”Ÿæ´»æˆæœ¬è¾ƒä½ä½†æ‹¥æœ‰å¤§é‡è‹±è¯­æµåˆ©è€…çš„å›½å®¶å¼€å±•æ­¤é¡¹å·¥ä½œã€‚å¯¹ OpenAI è€Œè¨€ï¼Œå°±æ˜¯è‚¯å°¼äºšã€å°¼æ—¥åˆ©äºšç­‰éæ´²å›½å®¶ã€‚ä½†è¿™ä¸€å†³ç­–å¸¦æ¥äº†ä¸€ä¸ªæœ‰è¶£çš„å‰¯ä½œç”¨ï¼šéæ´²è‹±è¯­ä¸ç¾å¼æˆ–è‹±å¼è‹±è¯­å­˜åœ¨ç»†å¾®çš„å·®å¼‚ã€‚ä¾‹å¦‚ï¼Œéæ´²è‹±è¯­æ›´é¢‘ç¹ä½¿ç”¨ â€œdelveâ€ è¿™ä¸ªè¯ï¼Œè¿™ä¹Ÿè§£é‡Šäº†[5]ä¸ºä»€ä¹ˆ GPT-4o ç‰¹åˆ«å–œæ¬¢ â€œdelveâ€ï¼ˆä»¥åŠå…¶ä»–åä¸½è¾è—»ï¼Œæ¯”å¦‚ â€œexploreâ€ å’Œ â€œtapestryâ€ï¼‰ã€‚</p>
<p>é‚£ä¹ˆï¼Œéæ´²è‹±è¯­æ˜¯å¦å¤§é‡ä½¿ç”¨ç ´æŠ˜å·ï¼Œä»è€Œå¯¼è‡´éæ´²çš„ RLHF å·¥ä½œè€…æ›´å€¾å‘äºç»™åŒ…å«ç ´æŠ˜å·çš„å›ç­”æ‰“é«˜åˆ†ï¼Ÿè¿™ä¸ªè§£é‡Šçœ‹ä¼¼å®Œç¾ï¼Œä½†æˆ‘è®¤ä¸ºå¹¶ä¸æˆç«‹ã€‚æˆ‘è·å–äº†ä¸€ä»½å°¼æ—¥åˆ©äºšè‹±è¯­æ–‡æœ¬çš„æ•°æ®é›†[6]ï¼Œå¹¶ç»Ÿè®¡äº†ç ´æŠ˜å·çš„å‡ºç°é¢‘ç‡ã€‚ç»“æœæ˜¾ç¤ºï¼Œç ´æŠ˜å·ä»…å å…¨éƒ¨è¯æ±‡çš„0.022%ã€‚è€Œä¸€ç¯‡å…³äºè‹±è¯­æ–‡æœ¬ä¸­æ ‡ç‚¹ç¬¦å·ä½¿ç”¨é¢‘ç‡çš„è®ºæ–‡[7]ä¼°è®¡ï¼Œæ•´ä½“ç ´æŠ˜å·çš„ä½¿ç”¨ç‡é€šå¸¸åœ¨ 0.25% åˆ° 0.275% ä¹‹é—´ï¼š</p>
<blockquote>
<p>ç ´æŠ˜å·çš„ä½¿ç”¨åœ¨ 1750 å¹´åå¼€å§‹å¢åŠ ï¼Œå¹¶åœ¨ 1860 å¹´å·¦å³è¾¾åˆ°é¡¶å³°ï¼ˆçº¦ 0.35%ï¼‰ï¼Œæ­¤åæŒç»­ä¸‹é™ï¼Œç›´åˆ° 1950 å¹´ä»£ï¼Œä¹‹åå¼€å§‹åœ¨ 0.25% è‡³ 0.275% ä¹‹é—´æ³¢åŠ¨ã€‚æœ¬ç ”ç©¶ä¸­æ ‡ç‚¹ç¬¦å·çš„é¢‘ç‡æ˜¯ç›¸å¯¹äºè¯­æ–™åº“çš„æ€»è¯é‡è®¡ç®—å¾—å‡ºçš„ã€‚Â </p>
</blockquote>
<p>è¯·å…ˆè®°ä½ 1860 å¹´ç ´æŠ˜å·ä½¿ç”¨ç‡è¾¾åˆ°é¡¶å³°è¿™ä¸€ç‚¹ï¼Œåæ–‡ä¼šæåŠã€‚<strong>ä½†å°±ç›®å‰æ¥çœ‹ï¼Œå°¼æ—¥åˆ©äºšè‹±è¯­å®é™…ä¸Šæ›´å°‘ä½¿ç”¨ç ´æŠ˜å·ã€‚å› æ­¤ï¼Œæˆ‘è®¤ä¸ºç ´æŠ˜å·çš„è¿‡åº¦ä½¿ç”¨ä¸ â€œdelveâ€ çš„é«˜é¢‘å‡ºç°å¹¶éæºäºåŒä¸€æœºåˆ¶ã€‚</strong></p>
<h2 data-id="heading-2"><strong>03 çº¸è´¨åª’ä½“çš„æ•°å­—åŒ–</strong></h2>
<p>å…³äºç ´æŠ˜å·ï¼Œæœ‰ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼š<strong>GPT-3.5 å¹¶ä¸æ€ä¹ˆä½¿ç”¨å®ƒã€‚è€Œ GPT-4o ä½¿ç”¨çš„ç ´æŠ˜å·æ•°é‡å¤§çº¦æ˜¯å‰ä»£æ¨¡å‹çš„ 10 å€ï¼ŒGPT-4.1 åˆ™æ›´ä¸ºä¸¥é‡ã€‚</strong> ä¸è¿‡ï¼ŒAnthropic å’Œ Google çš„æ¨¡å‹ç¡®å®ä¹Ÿä¼šä½¿ç”¨ç ´æŠ˜å·ï¼Œç”šè‡³è¿å¼€æºçš„ä¸­æ–‡æ¨¡å‹ä¹Ÿä½¿ç”¨ç ´æŠ˜å·ã€‚é‚£ä¹ˆï¼Œåœ¨ 2022 å¹´ 11 æœˆåˆ° 2024 å¹´ 7 æœˆä¹‹é—´ï¼Œç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ï¼Ÿ</p>
<p>ä¸€ä¸ªå…³é”®å˜åŒ–æ˜¯è®­ç»ƒæ•°æ®çš„æ„æˆã€‚2022 å¹´æ—¶ï¼ŒOpenAI å‡ ä¹å¯ä»¥è‚¯å®šæ˜¯ä½¿ç”¨å…¬å¼€äº’è”ç½‘æ•°æ®å’Œæ¥è‡ª LibGen ç­‰ç½‘ç«™çš„ç›—ç‰ˆä¹¦ç±æ··åˆè¿›è¡Œè®­ç»ƒã€‚ç„¶è€Œï¼Œéšç€è¯­è¨€æ¨¡å‹çš„å¼ºå¤§èƒ½åŠ›æ˜¾ç°å‡ºæ¥ï¼ŒAI å®éªŒå®¤è¿…é€Ÿæ„è¯†åˆ°ï¼Œä»–ä»¬éœ€è¦æ›´å¤šé«˜è´¨é‡çš„è®­ç»ƒæ•°æ® â€”â€” è¿™æ„å‘³ç€è¦æ‰«æå¤§é‡çº¸è´¨ä¹¦ç±ã€‚åªæœ‰ OpenAI å‘˜å·¥çŸ¥é“ä»–ä»¬æ˜¯å¦ä»¥åŠä½•æ—¶å¼€å§‹æ‰«æä¹¦ç±ï¼Œä½†æ³•åº­æ–‡ä»¶[8]å·²æŠ«éœ²ï¼ŒAnthropic æ˜¯åœ¨ 2024 å¹´ 2 æœˆå¯åŠ¨è¿™ä¸€æµç¨‹çš„ã€‚æˆ‘ä»¬æœ‰ç†ç”±æ¨æµ‹ OpenAI ä¹Ÿé‡‡å–äº†ç±»ä¼¼çš„è¡ŒåŠ¨ã€‚æ¢å¥è¯è¯´ï¼Œ<strong>2022 åˆ° 2024 å¹´é—´ï¼Œè®­ç»ƒæ•°æ®ä¸­æ–°å¢äº†å¤§é‡çº¸è´¨ä¹¦ç±ã€‚</strong></p>
<p>è¿˜è®°å¾—ä¸Šæ–‡æåˆ°çš„é‚£é¡¹æ ‡ç‚¹ä½¿ç”¨é¢‘ç‡ç ”ç©¶å—ï¼Ÿå®ƒæŒ‡å‡ºç ´æŠ˜å·çš„ä½¿ç”¨ç‡åœ¨ 1860 å¹´å·¦å³è¾¾åˆ°é¡¶å³°ã€‚æˆ‘è®¤ä¸ºä¸€ä¸ªåˆç†çš„å‡è®¾æ˜¯ï¼šAI å®éªŒå®¤æ‰€æ•°å­—åŒ–çš„ä¹¦ç±ï¼Œç›¸æ¯”ç›—ç‰ˆä¹¦ç±æ›´æ¥è¿‘ 1860 å¹´çš„è¯­è¨€é£æ ¼ã€‚ç›´è§‚æ¥çœ‹ï¼Œç›—ç‰ˆå†…å®¹å¾€å¾€å€¾å‘äºå½“ä»£æµè¡Œæ–‡å­¦ â€”â€” å› ä¸ºè¿™äº›æ‰æ˜¯è¯»è€…æ„¿æ„ä¸‹è½½çš„ã€‚å¦‚æœ AI å®éªŒå®¤å¸Œæœ›è¶…å‡ºè¿™ä¸€èŒƒå›´ï¼Œä»–ä»¬å°±å¾—å»è´­ä¹°æ›´å¤è€çš„ä¹¦ç±ï¼Œè€Œè¿™äº›ä¹¦å¾ˆå¯èƒ½åŒ…å«æ›´å¤šç ´æŠ˜å·ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—å‡ºäº†æˆ‘è®¤ä¸ºæœ€åˆç†çš„è§£é‡Šï¼š</p>
<p>å½“å‰æœ€å…ˆè¿›çš„æ¨¡å‹ä¾èµ– 19 ä¸–çºªæœ«åˆ° 20 ä¸–çºªåˆçš„çº¸è´¨ä¹¦ç±ä½œä¸ºé«˜è´¨é‡è®­ç»ƒæ•°æ®ï¼Œè€Œè¿™äº›ä¹¦ç±ä½¿ç”¨çš„ç ´æŠ˜å·æ¯”å½“ä»£è‹±è¯­æ•£æ–‡å¤šå‡ºçº¦ 30%ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¾ˆéš¾è®©æ¨¡å‹åœæ­¢ä½¿ç”¨ç ´æŠ˜å· â€”â€” å› ä¸ºå®ƒä»¬æ˜¯ä»å……æ»¡ç ´æŠ˜å·çš„æ–‡æœ¬ä¸­å­¦åˆ°è‹±è¯­çš„ã€‚</p>
<p>æˆ‘è¦æ„Ÿè°¢ Maria Sukhareva çš„è¿™ç¯‡åšå®¢[9]ï¼Œæ­£æ˜¯å¥¹è®©æˆ‘æ³¨æ„åˆ°è¿™ä¸€ç‚¹ã€‚è™½ç„¶æˆ‘ä¸åŒæ„å¥¹å…³äºç ´æŠ˜å·å…·æœ‰ structurally preferredï¼ˆè¯‘è€…æ³¨ï¼šæ¨¡å‹æœ¬èº«æ›´â€œå–œæ¬¢â€æˆ–â€œåå‘â€ä½¿ç”¨ç ´æŠ˜å·ï¼Œå³ä½¿è¾“å…¥æ•°æ®ä¸­ç ´æŠ˜å·å¹¶ä¸ç‰¹åˆ«å¤šã€‚ï¼‰çš„è§‚ç‚¹ï¼ˆåŸå› å·²åœ¨ä¸Šæ–‡ç®€è¦è¯´æ˜ï¼‰ï¼Œä½†æˆ‘è®¤ä¸ºå¥¹æå‡ºçš„â€œæ•°å­—åŒ–è¿›ç¨‹æ¨åŠ¨ç ´æŠ˜å·çš„ä½¿ç”¨â€è¿™ä¸€è¯´æ³•éå¸¸å¯ä¿¡ã€‚è‹¥æƒ³çœ‹æ›´å…·ä½“çš„ä¾‹å­ä»¥åŠç±»ä¼¼è§‚ç‚¹ï¼Œä¹Ÿå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« [10]ï¼Œå…¶ä¸­å±•ç¤ºäº†ä¸€äº›ç»å…¸è‘—ä½œä¸­ç ´æŠ˜å·çš„æƒŠäººæ•°é‡ â€”â€” æˆ‘æœ€çˆ±çš„ã€Šç™½é²¸ã€‹ï¼ˆMoby-Dickï¼‰ç«ŸåŒ…å« 1728 ä¸ªç ´æŠ˜å·ï¼</p>
<h2 data-id="heading-3"><strong>04 æ€»ç»“</strong></h2>
<p>å…³äºæ¨¡å‹è¿‡åº¦ä½¿ç”¨ç ´æŠ˜å·çš„ç°è±¡ï¼Œç°æœ‰è§£é‡Šå¯å½’çº³ä¸ºä¸‰å¤§ç±»ï¼š</p>
<p><strong>ç¬¬ä¸€ç±»æ˜¯æ¨¡å‹ç»“æ„é©±åŠ¨è®º</strong>ï¼Œè®¤ä¸ºè‡ªå›å½’æ¨¡å‹å¤©ç”Ÿåå¥½ç ´æŠ˜å· â€”â€” æ¯”å¦‚å› ä¸ºå®ƒèŠ‚çœ tokenã€ä¿ç•™æ›´å¤šè¡¨è¾¾å¯èƒ½æ€§ï¼Œæˆ–è€…å…¶ä»–ç±»ä¼¼åŸå› ã€‚æ­¤è¯´æ³•éš¾ä»¥ä»¤äººä¿¡æœï¼Œå› ä¸º GPT-3.5 å¹¶æ²¡æœ‰è¿‡åº¦ä½¿ç”¨ç ´æŠ˜å·ï¼Œè€Œä¸”è¿™ä¹Ÿä¸ç¬¦åˆæˆ‘å¯¹æ¨¡å‹æ¨ç†æœºåˆ¶çš„ç›´è§‰ã€‚</p>
<p><strong>ç¬¬äºŒç±»æ˜¯ RLHF å½±å“è®º</strong>ï¼Œä¸»å¼ äººç±»è¯„åˆ†è€…æ›´é’çç ´æŠ˜å·ï¼Œå› å…¶èƒ½ä½¿è¡Œæ–‡æ›´å£è¯­åŒ–ï¼Œæˆ–ç¬¦åˆ RLHF å·¥ä½œè€…æ‰€å¤„è‹±è¯­åŒºçš„ä½¿ç”¨ä¹ æƒ¯ã€‚æˆ‘è®¤ä¸ºåœ°åŸŸå·®å¼‚è®ºç¼ºä¹ä¾æ®ï¼Œä½†â€œæ›´å£è¯­åŒ–â€çš„è¯´æ³•æˆ–è®¸æœ‰é“ç†ï¼Œåªæ˜¯ç›®å‰éš¾ä»¥æ‰¾åˆ°ç¡®å‡¿è¯æ®æ”¯æ’‘æˆ–å¦å®šå®ƒã€‚</p>
<p><strong>ç¬¬ä¸‰ç±»æ˜¯è®­ç»ƒæ•°æ®å†³å®šè®º</strong>ï¼Œå¼ºè°ƒç ´æŠ˜å·æœ¬å°±å¤§é‡å­˜åœ¨äºè®­ç»ƒæ•°æ®ä¸­ã€‚è™½ç„¶æˆ‘ä¸è®¤åŒè¿™æ˜¯æ ¹æœ¬åŸå› ï¼Œä½†ç¡®å®è®¤ä¸ºæŸäº›é«˜è´¨é‡è®­ç»ƒæ•°æ®ï¼ˆç‰¹åˆ«æ˜¯ 20 ä¸–çºªåˆçš„å°åˆ·ä¹¦ç±ï¼‰ä¸­ç ´æŠ˜å·æ¯”ä¾‹è¿‡é«˜ã€‚æ€»ä½“è€Œè¨€ï¼Œè¿™ä»æ˜¯ç›®å‰æœ€å…·è¯´æœåŠ›çš„è§£é‡Šã€‚</p>
<h2 data-id="heading-4"><strong>05 Final thoughts</strong></h2>
<p><strong>ä»¥ä¸Šæ¨è®ºç›®å‰ä»ä¸»è¦åŸºäºæ¨æµ‹ã€‚</strong> ä¹Ÿè®¸æˆ‘å¯¹ OpenAI å¼€å§‹æ•°å­—åŒ–ä¹¦é¢æ–‡æœ¬çš„æ—¶é—´åˆ¤æ–­æœ‰è¯¯ã€‚å¦‚æœä»–ä»¬åœ¨ GPT-3.5 ä¹‹å‰å°±å·²å¼€å§‹ï¼Œé‚£ç ´æŠ˜å·çš„æ³›æ»¥å°±ä¸èƒ½å½’å› äºæ­¤ã€‚å½“ç„¶ï¼Œå¦‚ä»Šè®­ç»ƒçš„æ¨¡å‹è‡³å°‘éƒ¨åˆ†å—åˆ°äº†å…¶ä»– AI æ¨¡å‹è¾“å‡ºçš„â€œæ±¡æŸ“â€ â€”â€” è¦ä¹ˆæ˜¯æ•…æ„ç”¨åˆæˆæ•°æ®è®­ç»ƒï¼Œè¦ä¹ˆå°±æ˜¯åœ¨æŠ“å–äº’è”ç½‘æ–‡æœ¬æ—¶ä¸å¯é¿å…åœ°å¸å…¥äº†å¤§é‡ AI ç”Ÿæˆå†…å®¹ã€‚</p>
<p>æˆ‘ä»æœ‰äº›å›°æƒ‘çš„ä¸€ç‚¹æ˜¯ï¼š<strong>å¦‚æœç ´æŠ˜å·ä¹‹æ‰€ä»¥å¸¸è§ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯ 19 ä¸–çºªæœ«åˆ° 20 ä¸–çºªåˆå†™ä½œé£æ ¼çš„ç‰¹å¾ï¼Œé‚£ä¸ºä»€ä¹ˆ AI ç”Ÿæˆçš„æ–‡æœ¬è¯»èµ·æ¥å¹¶ä¸åƒã€Šç™½é²¸ã€‹ï¼Ÿ</strong> æ¨¡å‹æ˜¯å¦æœ‰å¯èƒ½åªå¸æ”¶äº†æ—§å¼è‹±è¯­å†™ä½œä¸­çš„ä¸€äº›ç¢ç‰‡åŒ–å…ƒç´ ï¼ˆæ¯”å¦‚æ ‡ç‚¹ç¬¦å·ï¼‰ï¼Œå´ä»äº§å‡ºå¬èµ·æ¥å¾ˆç°ä»£çš„æ–‡æœ¬ï¼Ÿ</p>
<p>æˆ‘ä¹Ÿå¯èƒ½é”™äº† â€”â€” æ–°æ•°å­—åŒ–çš„å†…å®¹æœªå¿…å°±å‡ºç‰ˆå¹´ä»£æ›´æ—©ã€‚ç›—ç‰ˆä¹¦ç±ç¡®å®å¯èƒ½åå‘å½“ä»£ä½œå“ï¼Œä½†å¤§é‡å·²è¿›å…¥å…¬æœ‰é¢†åŸŸçš„æ—§ä¹¦æ˜¯å¦è¶³ä»¥å‹å€’è¿™ç§åå‘ï¼Ÿ</p>
<p>è¿˜å¯èƒ½å­˜åœ¨ä¸€ä¸ªæ›´ç®€å•çš„è§£é‡Šï¼šæ¯”å¦‚ï¼Œç ´æŠ˜å·è¯»èµ·æ¥æ›´å£è¯­åŒ–ï¼Œå› æ­¤å—åˆ° RLHF è¯„åˆ†å‘˜çš„é’çï¼Œä»è€Œå½¢æˆæ¶æ€§å¾ªç¯ï¼Œå¯¼è‡´æ¨¡å‹è¶Šæ¥è¶Šé¢‘ç¹åœ°ä½¿ç”¨ç ´æŠ˜å·ã€‚è¿™ä¼¼ä¹ä¸ Sam Altman æŸæ¬¡è®¿è°ˆ[11]ä¸­â€œå› ç”¨æˆ·å–œçˆ±è€Œå¢åŠ ç ´æŠ˜å·â€çš„è¯´æ³•å»åˆã€‚ä½†æˆ‘ä¸çŸ¥é“è¯¥å¦‚ä½•è¯å®æˆ–è¯ä¼ªè¿™ä¸€ç‚¹ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»ç„¶æƒŠè®¶äºï¼š<strong>å¯¹äº AI æ–‡æœ¬æœ€æ˜¾è‘—çš„ç‰¹å¾ä¹‹ä¸€ï¼Œå±…ç„¶æ²¡æœ‰å¹¿æ³›çš„å…±è¯†è§£é‡Šå…¶æˆå› ã€‚</strong> æˆ‘ä¸ªäººä»å€¾å‘äºè®¤ä¸ºï¼Œæ•°å­—åŒ– 19 ä¸–çºªæœ«è‡³ 20 ä¸–çºªåˆçš„è‘—ä½œæ˜¯ä¸»è¦åŸå›  â€”â€” ä½†å¦‚æœæ›¾å‚ä¸ GPT-3.5 åˆ° GPT-4o ä¹‹é—´ OpenAI å·¥ä½œï¼ˆæˆ–å› å…¶ä»–åŸå› çŸ¥æƒ…ï¼‰çš„äººèƒ½ç¡®è®¤è¿™ä¸€ç‚¹ï¼Œé‚£å°±å†å¥½ä¸è¿‡äº†ã€‚</p>
<p>ç¼–è¾‘è¡¥å……ï¼šè¿™ç¯‡æ–‡ç« åœ¨ Hacker News[12]Â ä¸Šæ”¶åˆ°äº†ä¸€äº›è¯„è®ºã€‚å…¶ä¸­æœ‰ä¸€æ¡æœ‰è¶£çš„è¯„è®º[13]æŒ‡å‡ºï¼ŒMedium çš„ CEO è®¤ä¸ºè´£ä»»åœ¨ Medium â€”â€” å› ä¸º Medium ä¼šè‡ªåŠ¨å°†ä¸¤ä¸ªè¿å­—ç¬¦ï¼ˆâ€â€”â€ï¼‰è½¬æ¢ä¸ºä¸€ä¸ªç ´æŠ˜å·ï¼Œè€Œ Medium æ›¾æ˜¯é«˜è´¨é‡è®­ç»ƒæ•°æ®çš„æ¥æºã€‚</p>
<p>æˆ‘å®Œå…¨æ— æ³•è®¤åŒè¿™ç§è¯´æ³•ã€‚å¦‚æœé—®é¢˜æ˜¯â€œä¸ºä»€ä¹ˆäººç±»å¸¸ç”¨è¿å­—ç¬¦æˆ–åŒè¿å­—ç¬¦ä»£æ›¿ç ´æŠ˜å·ï¼Œè€Œ LLM å´è¾“å‡ºçœŸæ­£çš„ç ´æŠ˜å·å­—ç¬¦â€ï¼Œé‚£æˆ‘æˆ–è®¸ä¼šè€ƒè™‘è¿™ç§æ’ç‰ˆç›¸å…³çš„è§£é‡Šã€‚ä½†çœŸæ­£çš„é—®é¢˜æ˜¯ï¼šâ€œä¸ºä»€ä¹ˆ LLM ä½¿ç”¨ç ´æŠ˜å·çš„é¢‘ç‡è¿œé«˜äºäººç±»ï¼Ÿâ€ â€”â€” è¿™é‡ŒæŒ‡çš„æ˜¯é‚£ç§åŠŸèƒ½ç±»ä¼¼æ‹¬å·ã€æˆ–æ¯”é€—å·æ›´å¼ºè°ƒè¯­æ°”çš„æ ‡ç‚¹ç”¨æ³•ã€‚</p>
<p>å› æ­¤ï¼Œé‚£äº›æåŠ Unicode[14]ã€ä¿„è¯­è®­ç»ƒæ•°æ®[15]ã€ç»´åŸºç™¾ç§‘æ’ç‰ˆè§„èŒƒ[16]æˆ– OCR è¯†åˆ«é”™è¯¯[17]çš„è¯„è®ºä»¤æˆ‘è´¹è§£ã€‚è¿™äº›å› ç´ æ ¹æœ¬æ— æ³•è§£é‡Šæ¨¡å‹ä¸ºä½•ä¼šâ€œåƒäººç±»é‚£æ ·ä½¿ç”¨ç ´æŠ˜å·â€ï¼å¦‚æœåœ¨è®­ç»ƒä¸­æŠŠè¿å­—ç¬¦ï¼ˆæ¯”å¦‚ â€œdouble-crossedâ€ ä¸­çš„ï¼‰è¯¯è¯»ä¸ºç ´æŠ˜å·ï¼Œæ¨¡å‹æ›´å¯èƒ½å­¦ä¼šæŠŠç ´æŠ˜å·å½“è¿å­—ç¬¦ç”¨ï¼Œè€Œä¸æ˜¯å­¦ä¼šç”¨ç ´æŠ˜å·æ¥æ’å…¥è¡¥å……è¯´æ˜æˆ–åˆ¶é€ è¯­æ°”åœé¡¿ã€‚å…¶ä»–ç±»ä¼¼è§£é‡Šä¹Ÿå­˜åœ¨åŒæ ·é—®é¢˜ã€‚</p>
<p><strong>END</strong></p>
<p><strong>æœ¬æœŸäº’åŠ¨å†…å®¹ ğŸ»</strong></p>
<p><strong>â“ä½ è§‰å¾—è¯­è¨€æ¨¡å‹åçˆ±ä½¿ç”¨ç ´æŠ˜å·æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ</strong></p>
<p><strong>æ–‡ä¸­é“¾æ¥</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.reddit.com%2Fr%2FOpenAI%2Fcomments%2F1mk62b1%2Fcomment%2Fn7gnqpb%2F" target="_blank" title="https://www.reddit.com/r/OpenAI/comments/1mk62b1/comment/n7gnqpb/" ref="nofollow noopener noreferrer">www.reddit.com/r/OpenAI/coâ€¦</a></p>
<p>[2]<a href="https://link.juejin.cn?target=https%3A%2F%2Fcommunity.openai.com%2Ft%2Fcannot-get-responses-to-not-include-dashes-and-em-dashes%2F1023216%2F7" target="_blank" title="https://community.openai.com/t/cannot-get-responses-to-not-include-dashes-and-em-dashes/1023216/7" ref="nofollow noopener noreferrer">community.openai.com/t/cannot-geâ€¦</a></p>
<p>[3]<a href="https://link.juejin.cn?target=https%3A%2F%2Fmsukhareva.substack.com%2Fp%2Fthe-mystery-of-emdashes-part-two" target="_blank" title="https://msukhareva.substack.com/p/the-mystery-of-emdashes-part-two" ref="nofollow noopener noreferrer">msukhareva.substack.com/p/the-mysteâ€¦</a>?</p>
<p>[4]<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Ftokenizer" target="_blank" title="https://platform.openai.com/tokenizer" ref="nofollow noopener noreferrer">platform.openai.com/tokenizer</a></p>
<p>[5]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.theguardian.com%2Ftechnology%2F2024%2Fapr%2F16%2Ftechscape-ai-gadgest-humane-ai-pin-chatgpt" target="_blank" title="https://www.theguardian.com/technology/2024/apr/16/techscape-ai-gadgest-humane-ai-pin-chatgpt" ref="nofollow noopener noreferrer">www.theguardian.com/technology/â€¦</a></p>
<p>[6]<a href="https://link.juejin.cn?target=https%3A%2F%2Fvarieng.helsinki.fi%2FCoRD%2Fcorpora%2FICE-NIG%2F" target="_blank" title="https://varieng.helsinki.fi/CoRD/corpora/ICE-NIG/" ref="nofollow noopener noreferrer">varieng.helsinki.fi/CoRD/corporâ€¦</a></p>
<p>[7]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FKun-Sun-5%2Fpublication%2F328512136_Frequency_Distributions_of_Punctuation_Marks_in_English_Evidence_from_Large-scale_Corpora%2Flinks%2F5f803541a6fdccfd7b521aac%2FFrequency-Distributions-of-Punctuation-Marks-in-English-Evidence-from-Large-scale-Corpora.pdf" target="_blank" title="https://www.researchgate.net/profile/Kun-Sun-5/publication/328512136_Frequency_Distributions_of_Punctuation_Marks_in_English_Evidence_from_Large-scale_Corpora/links/5f803541a6fdccfd7b521aac/Frequency-Distributions-of-Punctuation-Marks-in-English-Evidence-from-Large-scale-Corpora.pdf" ref="nofollow noopener noreferrer">www.researchgate.net/profile/Kunâ€¦</a></p>
<p>[8]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.publishersweekly.com%2Fpw%2Fby-topic%2Fdigital%2Fcopyright%2Farticle%2F98089-federal-judge-rules-ai-training-is-fair-use-in-anthropic-copyright-case.html%3Futm_source%3Dchatgpt.com" target="_blank" title="https://www.publishersweekly.com/pw/by-topic/digital/copyright/article/98089-federal-judge-rules-ai-training-is-fair-use-in-anthropic-copyright-case.html?utm_source=chatgpt.com" ref="nofollow noopener noreferrer">www.publishersweekly.com/pw/by-topicâ€¦</a></p>
<p>[9]<a href="https://link.juejin.cn?target=https%3A%2F%2Fmsukhareva.substack.com%2Fp%2Fthe-mystery-of-emdashes-part-two" target="_blank" title="https://msukhareva.substack.com/p/the-mystery-of-emdashes-part-two" ref="nofollow noopener noreferrer">msukhareva.substack.com/p/the-mysteâ€¦</a></p>
<p>[10]<a href="https://link.juejin.cn?target=https%3A%2F%2Fmedium.com%2Fghost-channel%2Fthe-em-dash-debate-is-broken-heres-what-the-data-actually-shows-023fffd5cd06" target="_blank" title="https://medium.com/ghost-channel/the-em-dash-debate-is-broken-heres-what-the-data-actually-shows-023fffd5cd06" ref="nofollow noopener noreferrer">medium.com/ghost-channâ€¦</a></p>
<p>[11]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.linkedin.com%2Fposts%2Fcurtwoodward_chatgpt-em-dash-deathwatch-sam-altman-activity-7355259218972557312-RH4j%2F" target="_blank" title="https://www.linkedin.com/posts/curtwoodward_chatgpt-em-dash-deathwatch-sam-altman-activity-7355259218972557312-RH4j/" ref="nofollow noopener noreferrer">www.linkedin.com/posts/curtwâ€¦</a></p>
<p>[12]<a href="https://link.juejin.cn?target=https%3A%2F%2Fnews.ycombinator.com%2Fitem%3Fid%3D45788327" target="_blank" title="https://news.ycombinator.com/item?id=45788327" ref="nofollow noopener noreferrer">news.ycombinator.com/item?id=457â€¦</a></p>
<p>[13]<a href="https://link.juejin.cn?target=https%3A%2F%2Fnews.ycombinator.com%2Fitem%3Fid%3D45789077" target="_blank" title="https://news.ycombinator.com/item?id=45789077" ref="nofollow noopener noreferrer">news.ycombinator.com/item?id=457â€¦</a></p>
<p>[14]<a href="https://link.juejin.cn?target=https%3A%2F%2Fnews.ycombinator.com%2Fitem%3Fid%3D45790985" target="_blank" title="https://news.ycombinator.com/item?id=45790985" ref="nofollow noopener noreferrer">news.ycombinator.com/item?id=457â€¦</a></p>
<p>[15]<a href="https://link.juejin.cn?target=https%3A%2F%2Fnews.ycombinator.com%2Fitem%3Fid%3D45795391" target="_blank" title="https://news.ycombinator.com/item?id=45795391" ref="nofollow noopener noreferrer">news.ycombinator.com/item?id=457â€¦</a></p>
<p>[16]<a href="https://link.juejin.cn?target=https%3A%2F%2Fnews.ycombinator.com%2Fitem%3Fid%3D45788891" target="_blank" title="https://news.ycombinator.com/item?id=45788891" ref="nofollow noopener noreferrer">news.ycombinator.com/item?id=457â€¦</a></p>
<p>[17]<a href="https://link.juejin.cn?target=https%3A%2F%2Fnews.ycombinator.com%2Fitem%3Fid%3D45789129" target="_blank" title="https://news.ycombinator.com/item?id=45789129" ref="nofollow noopener noreferrer">news.ycombinator.com/item?id=457â€¦</a></p>
<p><strong>æœ¬æ–‡ç»åŸä½œè€…æˆæƒï¼Œç”± Baihai IDP ç¼–è¯‘ã€‚å¦‚éœ€è½¬è½½è¯‘æ–‡ï¼Œè¯·è”ç³»è·å–æˆæƒã€‚</strong></p>
<p><strong>åŸæ–‡é“¾æ¥ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seangoedecke.com%2Fem-dashes%2F" target="_blank" title="https://www.seangoedecke.com/em-dashes/" ref="nofollow noopener noreferrer">www.seangoedecke.com/em-dashes/</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š4.çŸ©å½¢ä¸æ–‡æœ¬çš„å®ç°]]></title>    <link>https://juejin.cn/post/7579093412332748810</link>    <guid>https://juejin.cn/post/7579093412332748810</guid>    <pubDate>2025-12-03T02:37:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579093412332748810" data-draft-id="7579094978682863662" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š4.çŸ©å½¢ä¸æ–‡æœ¬çš„å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2025-12-03T02:37:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="irises"/> <meta itemprop="url" content="https://juejin.cn/user/3030697436261735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š4.çŸ©å½¢ä¸æ–‡æœ¬çš„å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030697436261735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    irises
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:37:57.000Z" title="Wed Dec 03 2025 02:37:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flz6060788%2FMini-Render" target="_blank" title="https://github.com/lz6060788/Mini-Render" ref="nofollow noopener noreferrer">MiniRenderä»“åº“åœ°å€å‚è€ƒ</a></p>
</blockquote>
<ul>
<li><strong>çŸ©å½¢ (Rect)</strong>ï¼šè¿™æ˜¯æ‰€æœ‰ UI ç»„ä»¶ï¼ˆæŒ‰é’®ã€å¡ç‰‡ã€èƒŒæ™¯ï¼‰çš„åŸºç¡€ã€‚</li>
<li><strong>æ–‡æœ¬ (Text)</strong>ï¼šè¿™æ˜¯ä¿¡æ¯å±•ç¤ºçš„æ ¸å¿ƒã€‚</li>
</ul>
<p>ç›¸è¾ƒäºåœ†ï¼Œ<strong>æ–‡æœ¬çš„éš¾ç‚¹åœ¨äºâ€œåŒ…å›´ç›’è®¡ç®—â€</strong>ï¼ˆä¸ºäº†æ”¯æŒç‚¹å‡»æ£€æµ‹ï¼‰ï¼Œå› ä¸º Canvas åªæœ‰ç”»å›¾å‘½ä»¤ï¼Œæ²¡æœ‰ç›´æ¥å‘Šè¯‰æˆ‘ä»¬å­—æœ‰å¤šé«˜ã€‚</p>
<p>æˆ‘ä»¬å°†åˆ†ä¸¤æ­¥å®ç°ã€‚</p>
<h3 data-id="heading-0">1. å®ç°çŸ©å½¢ (<code>src/graphic/shape/Rect.ts</code>)</h3>
<p>çŸ©å½¢çš„é€»è¾‘æ¯”è¾ƒæ ‡å‡†ï¼Œé‡ç‚¹æ˜¯å®ç° <code>buildPath</code> å’Œ <code>containLocal</code>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/shape/Rect.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Displayable</span>, <span class="hljs-title class_">DisplayableProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../Displayable'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">RectShape</span> {
    x?: <span class="hljs-built_in">number</span>;
    y?: <span class="hljs-built_in">number</span>;
    width?: <span class="hljs-built_in">number</span>;
    height?: <span class="hljs-built_in">number</span>;
    r?: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// åœ†è§’åŠå¾„ (ç®€å•èµ·è§ï¼Œæš‚åªæ”¯æŒç»Ÿä¸€åœ†è§’)</span>
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">RectProps</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">DisplayableProps</span> {
    shape?: <span class="hljs-title class_">RectShape</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Rect</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Displayable</span> {
    <span class="hljs-attr">shape</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">RectShape</span>&gt;; <span class="hljs-comment">// ç¡®ä¿å†…éƒ¨ä½¿ç”¨æ—¶éƒ½æœ‰å€¼</span>

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">opts?: RectProps</span>) {
        <span class="hljs-variable language_">super</span>(opts);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">shape</span> = {
            <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">r</span>: <span class="hljs-number">0</span>,
            ...opts?.<span class="hljs-property">shape</span>
        };
    }

    <span class="hljs-title function_">buildPath</span>(<span class="hljs-params">ctx: CanvasRenderingContext2D</span>) {
        <span class="hljs-keyword">const</span> shape = <span class="hljs-variable language_">this</span>.<span class="hljs-property">shape</span>;
        <span class="hljs-keyword">const</span> x = shape.<span class="hljs-property">x</span>;
        <span class="hljs-keyword">const</span> y = shape.<span class="hljs-property">y</span>;
        <span class="hljs-keyword">const</span> width = shape.<span class="hljs-property">width</span>;
        <span class="hljs-keyword">const</span> height = shape.<span class="hljs-property">height</span>;
        <span class="hljs-keyword">const</span> r = shape.<span class="hljs-property">r</span>;

        <span class="hljs-keyword">if</span> (!r) {
            <span class="hljs-comment">// æ™®é€šçŸ©å½¢</span>
            ctx.<span class="hljs-title function_">rect</span>(x, y, width, height);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// åœ†è§’çŸ©å½¢ (ä½¿ç”¨ arcTo æˆ–è€… roundRect)</span>
            <span class="hljs-comment">// è¿™é‡Œä½¿ç”¨é€šç”¨çš„ arcTo æ¨¡æ‹Ÿ</span>
            ctx.<span class="hljs-title function_">moveTo</span>(x + r, y);
            ctx.<span class="hljs-title function_">lineTo</span>(x + width - r, y);
            ctx.<span class="hljs-title function_">arcTo</span>(x + width, y, x + width, y + r, r);
            ctx.<span class="hljs-title function_">lineTo</span>(x + width, y + height - r);
            ctx.<span class="hljs-title function_">arcTo</span>(x + width, y + height, x + width - r, y + height, r);
            ctx.<span class="hljs-title function_">lineTo</span>(x + r, y + height);
            ctx.<span class="hljs-title function_">arcTo</span>(x, y + height, x, y + height - r, r);
            ctx.<span class="hljs-title function_">lineTo</span>(x, y + r);
            ctx.<span class="hljs-title function_">arcTo</span>(x, y, x + r, y, r);
            ctx.<span class="hljs-title function_">closePath</span>();
        }
    }

    <span class="hljs-comment">/**
     * çŸ©å½¢çš„åŒ…å«æ£€æµ‹
     */</span>
    <span class="hljs-title function_">containLocal</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">boolean</span> {
        <span class="hljs-keyword">const</span> shape = <span class="hljs-variable language_">this</span>.<span class="hljs-property">shape</span>;
        <span class="hljs-comment">// ç®€å•çŸ©å½¢æ£€æµ‹</span>
        <span class="hljs-comment">// å¦‚æœè¦åšåœ†è§’æ£€æµ‹æ¯”è¾ƒå¤æ‚ï¼Œé€šå¸¸è¿™é‡Œç®€åŒ–ä¸ºçŸ©å½¢åŒ…å›´ç›’</span>
        <span class="hljs-keyword">return</span> x &gt;= shape.<span class="hljs-property">x</span> &amp;&amp; x &lt;= shape.<span class="hljs-property">x</span> + shape.<span class="hljs-property">width</span> &amp;&amp;
               y &gt;= shape.<span class="hljs-property">y</span> &amp;&amp; y &lt;= shape.<span class="hljs-property">y</span> + shape.<span class="hljs-property">height</span>;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-1">2. å®ç°æ–‡æœ¬ (<code>src/graphic/Text.ts</code>)</h3>
<p>æ–‡æœ¬æ¯”è¾ƒç‰¹æ®Šã€‚</p>
<ol>
<li><strong>ç»˜åˆ¶æ–¹å¼ä¸åŒ</strong>ï¼šå®ƒä¸ç”¨ <code>beginPath/fill</code> æµç¨‹ï¼Œè€Œæ˜¯ç›´æ¥ <code>fillText</code>ã€‚</li>
<li><strong>æ ·å¼å±æ€§å¤š</strong>ï¼šå­—å·ã€å­—ä½“ã€å¯¹é½æ–¹å¼ã€‚</li>
<li><strong>ç¢°æ’æ£€æµ‹éš¾</strong>ï¼šéœ€è¦ç”¨ <code>measureText</code> ç®—å®½åº¦ï¼Œç”¨å­—å·ä¼°ç®—é«˜åº¦ã€‚</li>
</ol>
<p>æˆ‘ä»¬éœ€è¦å…ˆåœ¨ <code>Displayable</code> æˆ– <code>Style</code> ä¸­è¡¥å……æ–‡æœ¬ç›¸å…³çš„æ ·å¼å®šä¹‰ã€‚</p>
<p><strong>æ›´æ–° <code>src/graphic/Style.ts</code></strong>:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CommonStyle</span> {
    <span class="hljs-comment">// ... åŸæœ‰å±æ€§ ...</span>
    
    <span class="hljs-comment">// æ–‡æœ¬ç›¸å…³</span>
    text?: <span class="hljs-built_in">string</span>;
    fontSize?: <span class="hljs-built_in">number</span>;
    fontFamily?: <span class="hljs-built_in">string</span>;
    fontWeight?: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 'bold', 'normal'</span>
    
    <span class="hljs-comment">// å¯¹é½</span>
    textAlign?: <span class="hljs-title class_">CanvasTextAlign</span>; <span class="hljs-comment">// 'left' | 'right' | 'center' | 'start' | 'end'</span>
    textBaseline?: <span class="hljs-title class_">CanvasTextBaseline</span>; <span class="hljs-comment">// 'top' | 'middle' | 'bottom' ...</span>
}
</code></pre>
<p><strong>åˆ›å»º <code>src/graphic/Text.ts</code></strong>:</p>
<p><em>æ³¨æ„ï¼šä¸ºäº†èƒ½åœ¨ <code>brush</code> ä¸­ä½¿ç”¨ç‰¹æ®Šçš„ç»˜åˆ¶é€»è¾‘ï¼Œæˆ‘ä»¬è¿™é‡Œè¦†ç›– <code>brush</code> æ–¹æ³•ï¼Œæˆ–è€…å¤ç”¨åŸºç±»é€»è¾‘ä½†é‡å†™ <code>buildPath</code> å®é™…ä¸Šä¸å¤ªåˆé€‚ï¼ˆå› ä¸º <code>fillText</code> ä¸æ˜¯ pathï¼‰ã€‚</em></p>
<p><strong><code>ZRender</code></strong> çš„åšæ³•æ˜¯ Text ä¹Ÿæ˜¯ Displayableï¼Œä½†ç»˜åˆ¶é€»è¾‘ç‹¬ç«‹ã€‚ä¸ºäº† MiniRender æ¶æ„ç®€å•ï¼Œæˆ‘ä»¬<strong>é‡å†™ brush</strong>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/Text.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Displayable</span>, <span class="hljs-title class_">DisplayableProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Displayable'</span>;

<span class="hljs-comment">// é»˜è®¤å­—ä½“</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_FONT_FAMILY</span> = <span class="hljs-string">'sans-serif'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Text</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Displayable</span> {
    
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">opts?: DisplayableProps</span>) {
        <span class="hljs-variable language_">super</span>(opts);
    }

    <span class="hljs-comment">/**
     * é‡å†™ brushï¼Œå› ä¸ºæ–‡æœ¬ä¸æ˜¯ Path
     */</span>
    <span class="hljs-title function_">brush</span>(<span class="hljs-params">ctx: CanvasRenderingContext2D</span>) {
        <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>;
        <span class="hljs-keyword">if</span> (!style.<span class="hljs-property">text</span>) <span class="hljs-keyword">return</span>;

        ctx.<span class="hljs-title function_">save</span>();
        
        <span class="hljs-comment">// 1. è®¾ç½®å¸¸è§„æ ·å¼</span>
        <span class="hljs-keyword">if</span> (style.<span class="hljs-property">fill</span>) ctx.<span class="hljs-property">fillStyle</span> = style.<span class="hljs-property">fill</span>;
        <span class="hljs-keyword">if</span> (style.<span class="hljs-property">stroke</span>) ctx.<span class="hljs-property">strokeStyle</span> = style.<span class="hljs-property">stroke</span>;
        <span class="hljs-keyword">if</span> (style.<span class="hljs-property">opacity</span> != <span class="hljs-literal">null</span>) ctx.<span class="hljs-property">globalAlpha</span> = style.<span class="hljs-property">opacity</span>;

        <span class="hljs-comment">// 2. è®¾ç½®å­—ä½“æ ·å¼</span>
        <span class="hljs-keyword">const</span> fontSize = style.<span class="hljs-property">fontSize</span> || <span class="hljs-number">12</span>;
        <span class="hljs-keyword">const</span> fontFamily = style.<span class="hljs-property">fontFamily</span> || <span class="hljs-variable constant_">DEFAULT_FONT_FAMILY</span>;
        <span class="hljs-keyword">const</span> fontWeight = style.<span class="hljs-property">fontWeight</span> || <span class="hljs-string">''</span>;
        ctx.<span class="hljs-property">font</span> = <span class="hljs-string">`<span class="hljs-subst">${fontWeight}</span> <span class="hljs-subst">${fontSize}</span>px <span class="hljs-subst">${fontFamily}</span>`</span>.<span class="hljs-title function_">trim</span>();

        ctx.<span class="hljs-property">textAlign</span> = style.<span class="hljs-property">textAlign</span> || <span class="hljs-string">'left'</span>;
        ctx.<span class="hljs-property">textBaseline</span> = style.<span class="hljs-property">textBaseline</span> || <span class="hljs-string">'alphabetic'</span>;

        <span class="hljs-comment">// 3. åº”ç”¨å˜æ¢</span>
        <span class="hljs-keyword">const</span> m = <span class="hljs-variable language_">this</span>.<span class="hljs-property">globalTransform</span>;
        ctx.<span class="hljs-title function_">setTransform</span>(m[<span class="hljs-number">0</span>], m[<span class="hljs-number">1</span>], m[<span class="hljs-number">2</span>], m[<span class="hljs-number">3</span>], m[<span class="hljs-number">4</span>], m[<span class="hljs-number">5</span>]);

        <span class="hljs-comment">// 4. ç»˜åˆ¶æ–‡æœ¬</span>
        <span class="hljs-comment">// è¿™é‡Œçš„ 0, 0 æ˜¯ç›¸å¯¹äº Text å…ƒç´ è‡ªèº«çš„åŸç‚¹</span>
        <span class="hljs-keyword">if</span> (style.<span class="hljs-property">stroke</span>) ctx.<span class="hljs-title function_">strokeText</span>(style.<span class="hljs-property">text</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">if</span> (style.<span class="hljs-property">fill</span>) ctx.<span class="hljs-title function_">fillText</span>(style.<span class="hljs-property">text</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);

        ctx.<span class="hljs-title function_">restore</span>();
    }

    <span class="hljs-comment">// æ–‡æœ¬ä¸éœ€è¦ buildPathï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ brush é‡Œç›´æ¥ç”»äº†</span>
    <span class="hljs-title function_">buildPath</span>(<span class="hljs-params">ctx: CanvasRenderingContext2D</span>) {}

    <span class="hljs-comment">/**
     * æ–‡æœ¬çš„ç¢°æ’æ£€æµ‹
     * éš¾ç‚¹ï¼šè®¡ç®—æ–‡æœ¬çš„åŒ…å›´ç›’
     */</span>
    <span class="hljs-title function_">containLocal</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">boolean</span> {
        <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>;
        <span class="hljs-keyword">if</span> (!style.<span class="hljs-property">text</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

        <span class="hljs-comment">// å€Ÿç”¨ä¸€ä¸ªè¾…åŠ© canvas æ¥æµ‹é‡æ–‡æœ¬å®½åº¦ï¼ˆæˆ–è€…ç”¨å…¨å±€å•ä¸€å®ä¾‹ï¼‰</span>
        <span class="hljs-comment">// åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œåº”è¯¥ç¼“å­˜ measureText çš„ç»“æœ</span>
        <span class="hljs-keyword">const</span> ctx = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>).<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>)!;
        <span class="hljs-keyword">const</span> fontSize = style.<span class="hljs-property">fontSize</span> || <span class="hljs-number">12</span>;
        <span class="hljs-keyword">const</span> fontFamily = style.<span class="hljs-property">fontFamily</span> || <span class="hljs-variable constant_">DEFAULT_FONT_FAMILY</span>;
        <span class="hljs-keyword">const</span> fontWeight = style.<span class="hljs-property">fontWeight</span> || <span class="hljs-string">''</span>;
        ctx.<span class="hljs-property">font</span> = <span class="hljs-string">`<span class="hljs-subst">${fontWeight}</span> <span class="hljs-subst">${fontSize}</span>px <span class="hljs-subst">${fontFamily}</span>`</span>.<span class="hljs-title function_">trim</span>();
        
        <span class="hljs-comment">// 1. è®¡ç®—å®½</span>
        <span class="hljs-keyword">const</span> width = ctx.<span class="hljs-title function_">measureText</span>(style.<span class="hljs-property">text</span>).<span class="hljs-property">width</span>;
        <span class="hljs-comment">// 2. ä¼°ç®—é«˜ (Canvas API ä¸ç›´æ¥æä¾›é«˜åº¦ï¼Œé€šå¸¸ç”¨ fontSize ä¼°ç®—)</span>
        <span class="hljs-keyword">const</span> height = fontSize;

        <span class="hljs-comment">// 3. æ ¹æ®å¯¹é½æ–¹å¼è®¡ç®—å·¦ä¸Šè§’ (Bounding Box çš„ x, y)</span>
        <span class="hljs-comment">// é»˜è®¤åŸç‚¹åœ¨ (0,0)</span>
        <span class="hljs-keyword">let</span> bx = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">let</span> by = <span class="hljs-number">0</span>;

        <span class="hljs-comment">// æ°´å¹³å¯¹é½ä¿®æ­£</span>
        <span class="hljs-keyword">const</span> align = style.<span class="hljs-property">textAlign</span> || <span class="hljs-string">'left'</span>;
        <span class="hljs-keyword">if</span> (align === <span class="hljs-string">'center'</span>) {
            bx -= width / <span class="hljs-number">2</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (align === <span class="hljs-string">'right'</span> || align === <span class="hljs-string">'end'</span>) {
            bx -= width;
        }

        <span class="hljs-comment">// å‚ç›´å¯¹é½ä¿®æ­£</span>
        <span class="hljs-keyword">const</span> baseline = style.<span class="hljs-property">textBaseline</span> || <span class="hljs-string">'alphabetic'</span>;
        <span class="hljs-keyword">if</span> (baseline === <span class="hljs-string">'top'</span>) {
            by = <span class="hljs-number">0</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (baseline === <span class="hljs-string">'middle'</span>) {
            by -= height / <span class="hljs-number">2</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (baseline === <span class="hljs-string">'bottom'</span>) {
            by -= height;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// alphabetic (åŸºçº¿) å¤§æ¦‚åœ¨ bottom åä¸Šä¸€ç‚¹ï¼Œè¿™é‡Œç®€å•æŒ‰ bottom å¤„ç†æˆ–å¿½ç•¥</span>
            by -= height; 
        }

        <span class="hljs-comment">// 4. åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨çŸ©å½¢å†…</span>
        <span class="hljs-keyword">return</span> x &gt;= bx &amp;&amp; x &lt;= bx + width &amp;&amp;
               y &gt;= by &amp;&amp; y &lt;= by + height;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-2">3. éªŒè¯</h3>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨ <code>index.ts</code> ä¸­åŒæ—¶ä½¿ç”¨åœ†å½¢ã€çŸ©å½¢å’Œæ–‡æœ¬ï¼Œæ„å»ºä¸€ä¸ªç®€å•çš„ UI æŒ‰é’®ã€‚</p>
<p><strong>index.ts (æµ‹è¯•ä»£ç )</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { init } <span class="hljs-keyword">from</span> <span class="hljs-string">'./core/MiniRender'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Group</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/Group'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Circle</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/shape/Circle'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Rect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/shape/Rect'</span>; <span class="hljs-comment">// æ–°å¢</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Text</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/Text'</span>;       <span class="hljs-comment">// æ–°å¢</span>

<span class="hljs-keyword">const</span> miniRender = <span class="hljs-title function_">init</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'main'</span>)!);

<span class="hljs-comment">// --- ç¤ºä¾‹ 1: åˆ›å»ºä¸€ä¸ªç®€å•çš„æŒ‰é’® (Group + Rect + Text) ---</span>

<span class="hljs-keyword">const</span> button = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Group</span>({
    <span class="hljs-attr">position</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">100</span>], <span class="hljs-comment">// æŒ‰é’®æ•´ä½“ä½ç½®</span>
    <span class="hljs-comment">// scale: [1.5, 1.5]     // æµ‹è¯•çˆ¶çº§ç¼©æ”¾å¯¹æ–‡æœ¬ç‚¹å‡»æ˜¯å¦æœ‰æ•ˆ</span>
});

<span class="hljs-comment">// 1. æŒ‰é’®èƒŒæ™¯</span>
<span class="hljs-keyword">const</span> bg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rect</span>({
    <span class="hljs-attr">shape</span>: {
        <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, 
        <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>, 
        <span class="hljs-attr">width</span>: <span class="hljs-number">120</span>, 
        <span class="hljs-attr">height</span>: <span class="hljs-number">40</span>, 
        <span class="hljs-attr">r</span>: <span class="hljs-number">10</span> <span class="hljs-comment">// åœ†è§’</span>
    },
    <span class="hljs-attr">style</span>: {
        <span class="hljs-attr">fill</span>: <span class="hljs-string">'#409EFF'</span>,
        <span class="hljs-attr">stroke</span>: <span class="hljs-string">'#000'</span>,
        <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">1</span>
    }
});

<span class="hljs-comment">// 2. æŒ‰é’®æ–‡å­—</span>
<span class="hljs-keyword">const</span> label = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>({
    <span class="hljs-attr">style</span>: {
        <span class="hljs-attr">text</span>: <span class="hljs-string">'Hello World'</span>,
        <span class="hljs-attr">fill</span>: <span class="hljs-string">'#fff'</span>,
        <span class="hljs-attr">fontSize</span>: <span class="hljs-number">16</span>,
        <span class="hljs-attr">textAlign</span>: <span class="hljs-string">'center'</span>,       <span class="hljs-comment">// æ°´å¹³å±…ä¸­</span>
        <span class="hljs-attr">textBaseline</span>: <span class="hljs-string">'middle'</span>     <span class="hljs-comment">// å‚ç›´å±…ä¸­</span>
    },
    <span class="hljs-comment">// å°†æ–‡å­—æ”¾åˆ°æŒ‰é’®ä¸­å¿ƒ</span>
    <span class="hljs-attr">position</span>: [<span class="hljs-number">60</span>, <span class="hljs-number">20</span>], <span class="hljs-comment">// 120/2, 40/2</span>
    <span class="hljs-attr">z</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// ç¡®ä¿æ–‡å­—åœ¨èƒŒæ™¯ä¸Šé¢</span>
});

button.<span class="hljs-title function_">add</span>(bg);
button.<span class="hljs-title function_">add</span>(label);
miniRender.<span class="hljs-title function_">add</span>(button);

<span class="hljs-comment">// --- äº¤äº’æµ‹è¯• ---</span>

<span class="hljs-comment">// ç‚¹å‡»èƒŒæ™¯å˜è‰²</span>
bg.<span class="hljs-title function_">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Background clicked'</span>);
    bg.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> = bg.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> === <span class="hljs-string">'#409EFF'</span> ? <span class="hljs-string">'#67C23A'</span> : <span class="hljs-string">'#409EFF'</span>;
    miniRender.<span class="hljs-title function_">refresh</span>();
});

<span class="hljs-comment">// ç‚¹å‡»æ–‡å­—å˜è‰²</span>
label.<span class="hljs-title function_">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Text clicked'</span>);
    label.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> = label.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> === <span class="hljs-string">'#fff'</span> ? <span class="hljs-string">'#000'</span> : <span class="hljs-string">'#fff'</span>;
    miniRender.<span class="hljs-title function_">refresh</span>();
});

<span class="hljs-comment">// --- åŠ¨ç”»æµ‹è¯• ---</span>
<span class="hljs-comment">// è®©æŒ‰é’®æ…¢æ…¢æ—‹è½¬ï¼Œæµ‹è¯• Rect å’Œ Text çš„ç‚¹å‡»åŒºåŸŸæ˜¯å¦è·Ÿç€æ—‹è½¬</span>
<span class="hljs-keyword">let</span> angle = <span class="hljs-number">0</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">loop</span>(<span class="hljs-params"/>) {
    angle += <span class="hljs-number">0.01</span>;
    button.<span class="hljs-property">rotation</span> = angle;
    
    <span class="hljs-comment">// å¦‚æœæƒ³è¦çœ‹æ—‹è½¬æ•ˆæœï¼Œå–æ¶ˆä¸‹é¢æ³¨é‡Š</span>
    miniRender.<span class="hljs-title function_">refresh</span>(); 
    <span class="hljs-title function_">requestAnimationFrame</span>(loop);
}
<span class="hljs-title function_">loop</span>();
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24b6bacb0ba0483ebadca494daa19a34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXJpc2Vz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334277&amp;x-signature=K97XoPb2qRTbXID2ARfZZB4sCnM%3D" alt="text.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Fiddlerè°ƒè¯•å·¥å…·å…¨é¢è§£æ HTTPHTTPSæŠ“åŒ…ã€ä»£ç†è®¾ç½®ä¸æ¥å£æµ‹è¯•å®æˆ˜æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7579175271679721482</link>    <guid>https://juejin.cn/post/7579175271679721482</guid>    <pubDate>2025-12-03T02:43:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579175271679721482" data-draft-id="7579175271679705098" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Fiddlerè°ƒè¯•å·¥å…·å…¨é¢è§£æ HTTPHTTPSæŠ“åŒ…ã€ä»£ç†è®¾ç½®ä¸æ¥å£æµ‹è¯•å®æˆ˜æ•™ç¨‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-03T02:43:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç–¯ç‹‚çš„ç¨‹åºçŒ´"/> <meta itemprop="url" content="https://juejin.cn/user/2760245749234147"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Fiddlerè°ƒè¯•å·¥å…·å…¨é¢è§£æ HTTPHTTPSæŠ“åŒ…ã€ä»£ç†è®¾ç½®ä¸æ¥å£æµ‹è¯•å®æˆ˜æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2760245749234147/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç–¯ç‹‚çš„ç¨‹åºçŒ´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:43:40.000Z" title="Wed Dec 03 2025 02:43:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ— è®ºæ˜¯å‰åç«¯è”è°ƒã€æ¥å£æµ‹è¯•è¿˜æ˜¯æ€§èƒ½ä¼˜åŒ–ï¼Œç½‘ç»œæŠ“åŒ…ä¸è°ƒè¯•èƒ½åŠ›å§‹ç»ˆæ˜¯æ¯ä½å¼€å‘è€…çš„â€œåº•å±‚æŠ€èƒ½â€ã€‚
åœ¨ä¼—å¤šæŠ“åŒ…å·¥å…·ä¸­ï¼Œ<strong>FiddleræŠ“åŒ…å·¥å…·</strong> å‡­å€ŸåŠŸèƒ½å…¨é¢ã€æ€§èƒ½ç¨³å®šã€æ“ä½œçµæ´»çš„ä¼˜åŠ¿ï¼Œè¢«æ— æ•°ç¨‹åºå‘˜è§†ä¸ºæ¥å£è°ƒè¯•å’Œç½‘ç»œåˆ†æçš„é¦–é€‰ã€‚</p>
<p>æœ¬æ–‡å°†ç»“åˆçœŸå®å¼€å‘åœºæ™¯ï¼Œç³»ç»Ÿè®²è§£ <strong>Fiddlerä½¿ç”¨æ•™ç¨‹ã€ä»£ç†é…ç½®ã€HTTPS æŠ“åŒ…ã€æ¥å£è°ƒè¯•ä¸å¸¸è§é—®é¢˜è§£å†³æ€è·¯</strong>ï¼Œå¸®åŠ©ä½ ä»åŸºç¡€é…ç½®åˆ°é«˜çº§åº”ç”¨ï¼Œå…¨é¢æŒæ¡è¿™æ¬¾â€œç½‘ç»œè°ƒè¯•åˆ©å™¨â€ã€‚</p>
<hr/>
<h2 data-id="heading-0"><strong>ä¸€ã€Fiddleræ˜¯ä»€ä¹ˆï¼Ÿå®ƒèƒ½è§£å†³å“ªäº›å¼€å‘é—®é¢˜ï¼Ÿ</strong></h2>
<p><strong>Fiddler</strong> æ˜¯ Telerik å…¬å¸æ¨å‡ºçš„ä¸€æ¬¾å…è´¹ HTTP/HTTPS æŠ“åŒ…å’Œç½‘ç»œè°ƒè¯•å·¥å…·ã€‚
å®ƒé€šè¿‡å……å½“ä»£ç†æœåŠ¡å™¨çš„æ–¹å¼ï¼Œæ•è·ç³»ç»Ÿæˆ–è®¾å¤‡å‘å‡ºçš„ç½‘ç»œè¯·æ±‚ï¼Œ
è®©å¼€å‘è€…å¯ä»¥æ¸…æ™°åœ°æŸ¥çœ‹è¯·æ±‚ç»†èŠ‚ã€å“åº”å†…å®¹å’Œæ€§èƒ½æŒ‡æ ‡ã€‚</p>
<p><strong>Fiddlerå¯ä»¥å¸®ä½ è§£å†³çš„é—®é¢˜åŒ…æ‹¬ï¼š</strong></p>
<ul>
<li>æ¥å£è¿”å›é”™è¯¯ï¼Œå®šä½ Header æˆ–å‚æ•°é—®é¢˜ï¼›</li>
<li>HTTPS åŠ å¯†æµé‡æ— æ³•æŸ¥çœ‹ï¼›</li>
<li>ç§»åŠ¨ç«¯ App è°ƒè¯•æ¥å£è¯·æ±‚ï¼›</li>
<li>æ¨¡æ‹Ÿæ¥å£æ•°æ®è¿›è¡Œå‰ç«¯å¼€å‘ï¼›</li>
<li>åˆ†ææ¥å£å“åº”è€—æ—¶ï¼Œä¼˜åŒ–ç½‘ç»œæ€§èƒ½ã€‚</li>
</ul>
<p>ç›¸æ¯” Charlesã€Postmanã€Wireshark ç­‰å·¥å…·ï¼ŒFiddler åœ¨çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ä¸Šæ›´çªå‡ºã€‚</p>
<hr/>
<h2 data-id="heading-1"><strong>äºŒã€Fiddlerå®‰è£…ä¸åŸºç¡€é…ç½®</strong></h2>
<h3 data-id="heading-2"><strong>1. å®‰è£…ä¸å¯åŠ¨</strong></h3>
<p>Fiddler æ”¯æŒ Windows ä¸ macOSï¼ˆFiddler Everywhere ç‰ˆæœ¬ï¼‰ã€‚
å®‰è£…å®Œæˆåå¯åŠ¨è½¯ä»¶ï¼Œå®ƒä¼šè‡ªåŠ¨æ¥ç®¡ç³»ç»Ÿä»£ç†ï¼Œå¼€å§‹æ•è·ç½‘ç»œæµé‡ã€‚</p>
<p><strong>æç¤ºï¼š</strong></p>
<ul>
<li>çŠ¶æ€æ  â€œCapturingâ€ è¡¨ç¤ºæ­£åœ¨æŠ“åŒ…ï¼›</li>
<li>è‹¥ä¸º â€œPausedâ€ï¼Œç‚¹å‡»å³å¯æ¢å¤æŠ“åŒ…çŠ¶æ€ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-3"><strong>2. Fiddlerä»£ç†è®¾ç½®ï¼ˆPCä¸ç§»åŠ¨ç«¯ï¼‰</strong></h3>
<p>Fiddler é»˜è®¤åªæ•è·æœ¬æœºè¯·æ±‚ï¼Œè‹¥è¦è°ƒè¯• Appã€å°ç¨‹åºç­‰ç§»åŠ¨ç«¯æ¥å£ï¼Œ
éœ€å¼€å¯è¿œç¨‹ä»£ç†åŠŸèƒ½ã€‚</p>
<p><strong>é…ç½®æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p>
<ol>
<li>æ‰“å¼€èœå•æ  <code>Tools â†’ Options â†’ Connections</code>ï¼›</li>
<li>å‹¾é€‰ <strong>Allow remote computers to connect</strong>ï¼›</li>
<li>æŸ¥çœ‹å½“å‰ç”µè„‘ IP åœ°å€ï¼ˆå¯é€šè¿‡ <code>ipconfig</code> æŸ¥è¯¢ï¼‰å’Œç«¯å£å·ï¼ˆé»˜è®¤ 8888ï¼‰ï¼›</li>
<li>ç¡®ä¿æ‰‹æœºä¸ç”µè„‘è¿æ¥åŒä¸€ Wi-Fiï¼›</li>
<li>åœ¨æ‰‹æœº Wi-Fi è®¾ç½®ä¸­æ·»åŠ ä»£ç†ï¼š
<ul>
<li>ä¸»æœºåï¼šç”µè„‘ IP</li>
<li>ç«¯å£å·ï¼š8888</li>
</ul>
</li>
</ol>
<p>å®Œæˆé…ç½®åï¼Œç§»åŠ¨ç«¯è¯·æ±‚å³å¯è¢« Fiddler æ•è·ã€‚</p>
<hr/>
<h3 data-id="heading-4"><strong>3. HTTPS æŠ“åŒ…é…ç½®</strong></h3>
<p>ç”±äº HTTPS è¯·æ±‚ç»è¿‡åŠ å¯†ï¼Œéœ€å®‰è£…å¹¶ä¿¡ä»» Fiddler æ ¹è¯ä¹¦ä»¥è¿›è¡Œè§£å¯†ã€‚</p>
<p><strong>é…ç½®æ–¹æ³•ï¼š</strong></p>
<ul>
<li>æ‰“å¼€ <code>Tools â†’ Options â†’ HTTPS</code>ï¼›</li>
<li>å‹¾é€‰ <strong>Decrypt HTTPS traffic</strong>ï¼›</li>
<li>ç‚¹å‡» â€œActions â†’ Trust Root Certificateâ€ï¼›</li>
<li>å®‰è£…å¹¶ä¿¡ä»»è¯ä¹¦ï¼›</li>
<li>è‹¥è¦æŠ“å–æ‰‹æœºæµé‡ï¼Œå¯¼å‡ºè¯ä¹¦ååœ¨ç§»åŠ¨ç«¯å®‰è£…ä¿¡ä»»ã€‚</li>
</ul>
<p>å®Œæˆåï¼ŒFiddler å³å¯è§£æ HTTPS è¯·æ±‚çš„å®Œæ•´å†…å®¹ï¼ŒåŒ…æ‹¬å‚æ•°ä¸å“åº”æ•°æ®ã€‚</p>
<hr/>
<h2 data-id="heading-5"><strong>ä¸‰ã€Fiddleræ ¸å¿ƒåŠŸèƒ½è¯¦è§£ä¸å¼€å‘å®æˆ˜</strong></h2>
<h3 data-id="heading-6"><strong>1. è¯·æ±‚ä¸å“åº”åˆ†æ</strong></h3>
<p>Fiddler ä¼šæ•è·æ‰€æœ‰ HTTP/HTTPS è¯·æ±‚å¹¶æ˜¾ç¤ºåœ¨å·¦ä¾§é¢æ¿ä¸­ã€‚
ç‚¹å‡»ä»»æ„è¯·æ±‚ï¼Œå¯æŸ¥çœ‹ï¼š</p>
<ul>
<li>è¯·æ±‚æ–¹æ³•ï¼ˆGET/POST/PUT/DELETEï¼‰ï¼›</li>
<li>URL ä¸å‚æ•°ï¼›</li>
<li>è¯·æ±‚å¤´ã€Cookieã€Body å†…å®¹ï¼›</li>
<li>å“åº”çŠ¶æ€ç ä¸è¿”å›ä½“ï¼›</li>
<li>è¯·æ±‚è€—æ—¶ä¸ç½‘ç»œé˜¶æ®µã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7"><strong>2. æ¨¡æ‹Ÿæ¥å£å“åº”ï¼ˆAutoResponderï¼‰</strong></h3>
<p>Fiddler çš„ AutoResponder æ¨¡å—å¯ç”¨äºæ¥å£ Mock å’Œè”è°ƒæµ‹è¯•ã€‚</p>
<p><strong>æ“ä½œæ­¥éª¤ï¼š</strong></p>
<ol>
<li>æ‰“å¼€ AutoResponder é¢æ¿ï¼›</li>
<li>ç‚¹å‡» â€œAdd Ruleâ€ æ·»åŠ è§„åˆ™ï¼›</li>
<li>åŒ¹é…æ¥å£ URLï¼›</li>
<li>æŒ‡å®šè¿”å› JSON æ–‡ä»¶æˆ–è‡ªå®šä¹‰å“åº”ï¼›</li>
<li>å‹¾é€‰ â€œEnable Rulesâ€ å¯ç”¨è§„åˆ™ã€‚</li>
</ol>
<p><strong>ç¤ºä¾‹ï¼š</strong>
å‰ç«¯å¯ç”¨ AutoResponder æ¨¡æ‹Ÿ <code>{ "code":200, "data":{"user":"demo"} }</code>ï¼Œ
æ— éœ€ç­‰å¾…åç«¯æ¥å£å³å¯å¼€å‘é¡µé¢é€»è¾‘ã€‚</p>
<hr/>
<h3 data-id="heading-8"><strong>3. è¯·æ±‚æ–­ç‚¹ä¸ä¿®æ”¹ï¼ˆBreakpointsï¼‰</strong></h3>
<p>Fiddler å¯åœ¨è¯·æ±‚å‘å‡ºå‰æˆ–å“åº”è¿”å›å‰æš‚åœï¼Œ
å…è®¸å¼€å‘è€…ä¿®æ”¹å‚æ•°ã€å“åº”æˆ–çŠ¶æ€ç ã€‚</p>
<p><strong>å¸¸è§ç”¨é€”ï¼š</strong></p>
<ul>
<li>æ¨¡æ‹Ÿæ¥å£å¼‚å¸¸ï¼ˆå¦‚ 500ã€404ï¼‰ï¼›</li>
<li>éªŒè¯å‰ç«¯å¼‚å¸¸å¤„ç†é€»è¾‘ï¼›</li>
<li>æµ‹è¯•æ¥å£å®¹é”™æ€§ã€‚</li>
</ul>
<p><strong>å‘½ä»¤è¡ŒæŠ€å·§ï¼š</strong></p>
<ul>
<li>è¾“å…¥ <code>bpu /api/user</code> â†’ è¯·æ±‚å‰æ–­ç‚¹ï¼›</li>
<li>è¾“å…¥ <code>bpafter /api/login</code> â†’ å“åº”å‰æ–­ç‚¹ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9"><strong>4. æ„é€ ä¸é‡æ”¾è¯·æ±‚ï¼ˆComposerï¼‰</strong></h3>
<p>Composer æ¨¡å—ç±»ä¼¼äº Postmanï¼Œå¯ç›´æ¥æ„é€ æˆ–é‡å‘ HTTP è¯·æ±‚ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>è°ƒè¯•ç­¾åç®—æ³•ã€è¯·æ±‚å¤´ã€Token éªŒè¯ï¼›</li>
<li>å¤ç°çº¿ä¸Šæ¥å£é—®é¢˜ï¼›</li>
<li>è°ƒæ•´å‚æ•°æµ‹è¯•æ¥å£ç¨³å®šæ€§ã€‚</li>
</ul>
<p><strong>å¿«é€Ÿæ“ä½œï¼š</strong>
å³é”®è¯·æ±‚ â†’ â€œReplay â†’ Reissue Requestâ€ï¼Œä¸€é”®é‡å‘è¯·æ±‚ã€‚</p>
<hr/>
<h3 data-id="heading-10"><strong>5. æ€§èƒ½åˆ†æï¼ˆTimelineï¼‰</strong></h3>
<p>Timeline æ¨¡å—èƒ½ç›´è§‚å±•ç¤ºæ¯ä¸ªè¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸï¼š
DNS æŸ¥è¯¢ â†’ TCP å»ºç«‹ â†’ TLS æ¡æ‰‹ â†’ æœåŠ¡å™¨å“åº” â†’ å†…å®¹ä¸‹è½½ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>å®šä½æ€§èƒ½ç“¶é¢ˆï¼ˆç½‘ç»œ/æœåŠ¡ç«¯ï¼‰ï¼›</li>
<li>å¯¹æ¯”æ¥å£åŠ è½½è€—æ—¶ï¼›</li>
<li>åˆ†æé¡µé¢åŠ è½½é˜¶æ®µã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-11"><strong>å››ã€Fiddlerå®æˆ˜æ¡ˆä¾‹ï¼šç§»åŠ¨ç«¯æ¥å£å»¶è¿Ÿåˆ†æ</strong></h2>
<p>æŸ App ç”¨æˆ·åé¦ˆæ¥å£å“åº”æ…¢ã€‚
é€šè¿‡ Fiddler Timeline åˆ†æå‘ç°ï¼š</p>
<ul>
<li>è¯·æ±‚é˜¶æ®µè€—æ—¶æ­£å¸¸ï¼›</li>
<li>æœåŠ¡å™¨å“åº”é˜¶æ®µå ç”¨è¿‘ 4 ç§’ï¼›</li>
<li>å“åº”ä½“è¿‡å¤§ï¼ˆçº¦ 1MBï¼‰ï¼Œæœªå¯ç”¨å‹ç¼©ã€‚</li>
</ul>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>å¯ç”¨ Gzip å‹ç¼©ï¼›</li>
<li>ä¼˜åŒ–æ¥å£è¿”å›å­—æ®µï¼›</li>
<li>è®¾ç½®ç¼“å­˜ç­–ç•¥å‡å°‘é‡å¤è¯·æ±‚ã€‚</li>
</ul>
<p>æœ€ç»ˆæ¥å£å“åº”æ—¶é—´é™è‡³ 1.2 ç§’ã€‚</p>
<hr/>
<h2 data-id="heading-12"><strong>äº”ã€FiddleråŠŸèƒ½æ¨¡å—æ€»è§ˆ</strong></h2>



































<table><thead><tr><th>æ¨¡å—</th><th>åŠŸèƒ½è¯´æ˜</th><th>å…¸å‹åº”ç”¨</th></tr></thead><tbody><tr><td><strong>Filters</strong></td><td>è¯·æ±‚è¿‡æ»¤ä¸ç­›é€‰</td><td>èšç„¦ç›®æ ‡æ¥å£è°ƒè¯•</td></tr><tr><td><strong>AutoResponder</strong></td><td>æ¨¡æ‹Ÿæ¥å£å“åº”</td><td>å‰åç«¯åˆ†ç¦»å¼€å‘</td></tr><tr><td><strong>Breakpoints</strong></td><td>æ‹¦æˆªå¹¶ä¿®æ”¹è¯·æ±‚</td><td>æµ‹è¯•å¼‚å¸¸ä¸å®¹é”™</td></tr><tr><td><strong>Composer</strong></td><td>æ„é€ ä¸é‡æ”¾è¯·æ±‚</td><td>API æµ‹è¯•ä¸éªŒè¯</td></tr><tr><td><strong>Timeline</strong></td><td>æ€§èƒ½é˜¶æ®µåˆ†æ</td><td>ä¼˜åŒ–åŠ è½½é€Ÿåº¦</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-13"><strong>å…­ã€Fiddlerå­¦ä¹ ä¸èµ„æ–™æ¨è</strong></h2>
<p>æƒ³è¿›ä¸€æ­¥æŒæ¡ Fiddler é«˜çº§ç”¨æ³•ï¼Ÿæ¨èè®¿é—®**<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.fiddler.hk%2F" target="_blank" title="https://www.fiddler.hk/" ref="nofollow noopener noreferrer">Fiddler ä¸­æ–‡ç½‘</a>**</p>
<p>ä½ å°†åœ¨ç½‘ç«™ä¸Šè·å¾—ï¼š</p>
<ul>
<li>Fiddler å®‰è£…ä¸é…ç½®æŒ‡å—ï¼›</li>
<li>HTTPS æŠ“åŒ…ä¸è¯ä¹¦è®¾ç½®ï¼›</li>
<li>ç§»åŠ¨ç«¯ä»£ç†è°ƒè¯•æ­¥éª¤ï¼›</li>
<li>Mock æ•°æ®ä¸æ¥å£é‡æ”¾æŠ€å·§ï¼›</li>
<li>æ€§èƒ½ä¼˜åŒ–å®æˆ˜æ¡ˆä¾‹ã€‚</li>
</ul>
<hr/>
<p>æŒæ¡ç½‘ç»œè°ƒè¯•èƒ½åŠ›ï¼Œæ˜¯æ¯ä½å¼€å‘è€…æˆé•¿çš„å…³é”®ä¸€æ­¥ã€‚
è€Œ <strong>FiddleræŠ“åŒ…å·¥å…·</strong>ï¼Œæ­£æ˜¯å¸®åŠ©ä½ çœ‹æ¸…ç½‘ç»œé€šä¿¡ç»†èŠ‚çš„æ”¾å¤§é•œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è½¬æˆ˜åç«¯ï¼šJavaScript ä¸ Java å¯¹ç…§å­¦ä¹ æŒ‡å—ï¼ˆç¬¬ä¸‰ç¯‡ â€”â€” Map å¯¹è±¡ï¼‰]]></title>    <link>https://juejin.cn/post/7579164768063176731</link>    <guid>https://juejin.cn/post/7579164768063176731</guid>    <pubDate>2025-12-03T02:38:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579164768063176731" data-draft-id="7579111646875254835" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è½¬æˆ˜åç«¯ï¼šJavaScript ä¸ Java å¯¹ç…§å­¦ä¹ æŒ‡å—ï¼ˆç¬¬ä¸‰ç¯‡ â€”â€” Map å¯¹è±¡ï¼‰"/> <meta itemprop="keywords" content="JavaScript,Java,å…¨æ ˆ"/> <meta itemprop="datePublished" content="2025-12-03T02:38:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±¤å§†Tom"/> <meta itemprop="url" content="https://juejin.cn/user/4112607842680478"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è½¬æˆ˜åç«¯ï¼šJavaScript ä¸ Java å¯¹ç…§å­¦ä¹ æŒ‡å—ï¼ˆç¬¬ä¸‰ç¯‡ â€”â€” Map å¯¹è±¡ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4112607842680478/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±¤å§†Tom
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:38:31.000Z" title="Wed Dec 03 2025 02:38:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>å½“å‰ç«¯å·¥ç¨‹å¸ˆå¼€å§‹å‘ Java åç«¯å¼€å‘è¿ˆè¿›æ—¶ï¼Œâ€œMapâ€ æ˜¯æœ€å¸¸é‡åˆ°çš„æ¦‚å¿µä¹‹ä¸€ã€‚<br/>
ç„¶è€Œï¼ŒåŒæ ·å« <strong>Map</strong>ï¼ŒJavaScript ä¸ Java çš„å®ç°å´æˆªç„¶ä¸åŒï¼š</p>
<ul>
<li>JS çš„ <code>Map</code> æ˜¯ä¸€ä¸ª <strong>è½»é‡çš„é”®å€¼å¯¹é›†åˆ</strong>ï¼›</li>
<li>Java çš„ <code>Map</code> æ˜¯ä¸€ä¸ª <strong>æ¥å£ä½“ç³»</strong>ï¼ŒèƒŒåæœ‰å¤šç§å®ç°ï¼ˆHashMapã€LinkedHashMapã€TreeMapâ€¦â€¦ï¼‰ï¼Œå¹¶ä¼´éšä¸¥æ ¼çš„ç±»å‹ç³»ç»Ÿå’Œä¸°å¯Œçš„å·¥ç¨‹åŒ–åŠŸèƒ½ã€‚</li>
</ul>
<p>ä¸ºäº†å¸®åŠ©å‰ç«¯å¼€å‘è€…é¡ºåˆ©è¿ç§»åˆ° Java åç«¯æ€ç»´ï¼Œæœ¬ç¯‡ä»åŸºç¡€åˆ°è¿›é˜¶ã€ä» API åˆ°åº•å±‚ã€ä»ä»£ç åˆ°æœ€ä½³å®è·µï¼Œå¯¹æ¯”è§£æ JS ä¸ Java ä¸­çš„ Mapã€‚</p>
<h2 data-id="heading-0">Map æ˜¯ä»€ä¹ˆï¼Ÿæ•´ä½“æ¦‚å¿µå¯¹æ¯”</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th>JavaScript Map</th><th>Java Map</th></tr></thead><tbody><tr><td>ç±»å‹æ€§è´¨</td><td>å†…ç½®å¯¹è±¡</td><td>æ¥å£ï¼ˆæœ‰å¤šç§å®ç°ï¼‰</td></tr><tr><td>é”®ç±»å‹</td><td>ä»»æ„ç±»å‹</td><td>ç”±æ³›å‹å†³å®šï¼Œå¿…é¡»æ˜¯å¯¹è±¡</td></tr><tr><td>è¿­ä»£é¡ºåº</td><td>ä¿æŒæ’å…¥é¡ºåº</td><td>å–å†³äºå…·ä½“å®ç°ç±»</td></tr><tr><td>ç±»å‹æ£€æŸ¥</td><td>å¼±ç±»å‹</td><td>å¼ºç±»å‹</td></tr><tr><td>çº¿ç¨‹å®‰å…¨</td><td>å¦</td><td>å¯é€šè¿‡ ConcurrentHashMap</td></tr><tr><td>æ˜¯å¦å¯æ‰©å±•</td><td>å°‘</td><td>ä¸°å¯Œï¼ˆSortedMapã€ConcurrentMapâ€¦ï¼‰</td></tr></tbody></table>
<p>ä¸€å¥è¯æ€»ç»“ï¼š<br/>
<strong>JavaScript çš„ Map æ˜¯çµæ´»çš„å°å·¥å…·ï¼›Java çš„ Map æ˜¯å®Œæ•´çš„é›†åˆæ¡†æ¶ä½“ç³»ã€‚</strong></p>
<hr/>
<h2 data-id="heading-1">Map çš„åˆ›å»º â€”â€” çµæ´» vs å¼ºç±»å‹</h2>
<h3 data-id="heading-2">JavaScript</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

<span class="hljs-keyword">const</span> map2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([
  [<span class="hljs-string">"name"</span>, <span class="hljs-string">"Alice"</span>],
  [<span class="hljs-string">"age"</span>, <span class="hljs-number">20</span>]
]);
</code></pre>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>è‡ªåŠ¨å†³å®šç±»å‹</li>
<li>å¯ç”¨äºŒå…ƒæ•°ç»„åˆå§‹åŒ–</li>
</ul>
<hr/>
<h3 data-id="heading-3">Java</h3>
<pre><code class="hljs language-Java" lang="Java">Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

Map&lt;String, Object&gt; map2 = Map.of(
    <span class="hljs-string">"name"</span>, <span class="hljs-string">"Alice"</span>,
    <span class="hljs-string">"age"</span>, <span class="hljs-number">20</span>
);
</code></pre>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>å¿…é¡»æŒ‡å®šæ³›å‹ç±»å‹ Map&lt;K, V&gt;</strong></li>
<li><code>Map.of()</code> æ˜¯ä¸å¯å˜ Map</li>
<li>å¸¸ç”¨å®ç°ï¼š<code>HashMap</code></li>
</ul>
<blockquote>
<p>å¼ºç±»å‹æ˜¯åç«¯ç¨³å®šæ€§çš„é‡è¦ä¿è¯ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">å¸¸ç”¨ API å…¨é¢å¯¹ç…§è¡¨</h2>













































<table><thead><tr><th>æ“ä½œ</th><th>JavaScript</th><th>Java</th></tr></thead><tbody><tr><td>æ–°å¢</td><td><code>set(key, value)</code></td><td><code>put(key, value)</code></td></tr><tr><td>æŸ¥è¯¢</td><td><code>get(key)</code></td><td><code>get(key)</code></td></tr><tr><td>åˆ¤æ–­æ˜¯å¦å­˜åœ¨</td><td><code>has(key)</code></td><td><code>containsKey(key)</code></td></tr><tr><td>åˆ é™¤</td><td><code>delete(key)</code></td><td><code>remove(key)</code></td></tr><tr><td>æ¸…ç©º</td><td><code>clear()</code></td><td><code>clear()</code></td></tr><tr><td>å¤§å°</td><td><code>map.size</code></td><td><code>map.size()</code></td></tr><tr><td>éå†</td><td><code>for-of</code></td><td><code>for-each + entrySet()</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-5">å¢åˆ æ”¹æŸ¥å…¨å¯¹ç…§ï¼ˆå«æ­£ç¡®ä¸é”™è¯¯ç¤ºä¾‹ï¼‰</h2>
<h3 data-id="heading-6">1. æ–°å¢å…ƒç´ </h3>
<h4 data-id="heading-7">JavaScript</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">map.<span class="hljs-title function_">set</span>(<span class="hljs-string">"name"</span>, <span class="hljs-string">"Alice"</span>);
</code></pre>
<h4 data-id="heading-8">Java</h4>
<pre><code class="hljs language-Java" lang="Java">map.put(<span class="hljs-string">"name"</span>, <span class="hljs-string">"Alice"</span>);
</code></pre>
<h4 data-id="heading-9">é”™è¯¯ç¤ºä¾‹ï¼ˆJavaï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">map[<span class="hljs-string">"name"</span>] = <span class="hljs-string">"Alice"</span>;   <span class="hljs-comment">// âŒ JS å†™æ³•</span>
</code></pre>
<hr/>
<h3 data-id="heading-10">2. ä¿®æ”¹å…ƒç´ </h3>
<p>JS å’Œ Java éƒ½æ˜¯è¦†ç›–ï¼š</p>
<h4 data-id="heading-11">JavaScript</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">map.<span class="hljs-title function_">set</span>(<span class="hljs-string">"name"</span>, <span class="hljs-string">"Bob"</span>);
</code></pre>
<h4 data-id="heading-12">Java</h4>
<pre><code class="hljs language-Java" lang="Java">map.put(<span class="hljs-string">"name"</span>, <span class="hljs-string">"Bob"</span>);
</code></pre>
<hr/>
<h3 data-id="heading-13">3. æŸ¥è¯¢å…ƒç´ </h3>
<h4 data-id="heading-14">JavaScript</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">map.<span class="hljs-title function_">get</span>(<span class="hljs-string">"name"</span>); <span class="hljs-comment">// Bob</span>
</code></pre>
<h4 data-id="heading-15">Java</h4>
<pre><code class="hljs language-Java" lang="Java">map.get(<span class="hljs-string">"name"</span>);  <span class="hljs-comment">// Bob</span>
</code></pre>
<p>ä½† Java æœ‰ <strong>Optional é£æ ¼å»ºè®®</strong>ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> Optional.ofNullable(map.get(<span class="hljs-string">"name"</span>))
                      .orElse(<span class="hljs-string">"default"</span>);
</code></pre>
<hr/>
<h3 data-id="heading-16">4. åˆ é™¤</h3>
<h4 data-id="heading-17">JavaScript</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">map.<span class="hljs-title function_">delete</span>(<span class="hljs-string">"name"</span>);
</code></pre>
<h4 data-id="heading-18">Java</h4>
<pre><code class="hljs language-Java" lang="Java">map.remove(<span class="hljs-string">"name"</span>);
</code></pre>
<hr/>
<h3 data-id="heading-19">5. å¤§å°</h3>
<h4 data-id="heading-20">JavaScript</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">map.<span class="hljs-property">size</span>;
</code></pre>
<h4 data-id="heading-21">Java</h4>
<pre><code class="hljs language-Java" lang="Java">map.size();
</code></pre>
<hr/>
<h2 data-id="heading-22">éå†æ–¹å¼å¯¹æ¯”ï¼ˆJava å…±æœ‰ 6 ç§ï¼‰</h2>
<h3 data-id="heading-23">JavaScriptï¼ˆå¤©ç”Ÿå¯è¿­ä»£ï¼‰</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> map) {}
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> map.<span class="hljs-title function_">keys</span>()) {}
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> val <span class="hljs-keyword">of</span> map.<span class="hljs-title function_">values</span>()) {}
map.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">v, k</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(k, v));
</code></pre>
<hr/>
<h2 data-id="heading-24">Javaï¼ˆå¤æ‚ä½†å·¥ç¨‹åŒ–ï¼‰</h2>
<h3 data-id="heading-25">1. entrySet() â€”â€” æœ€å¸¸ç”¨ã€æœ€é«˜æ•ˆ</h3>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">for</span> (Map.Entry&lt;String, Object&gt; e : map.entrySet()) {
    System.out.println(e.getKey() + <span class="hljs-string">"="</span> + e.getValue());
}
</code></pre>
<h3 data-id="heading-26">2. keySet()</h3>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">for</span> (String key : map.keySet()) {}
</code></pre>
<h3 data-id="heading-27">3. values()</h3>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">for</span> (Object v : map.values()) {}
</code></pre>
<h3 data-id="heading-28">4. forEachï¼ˆJava 8ï¼‰</h3>
<pre><code class="hljs language-Java" lang="Java">map.forEach((k, v) -&gt; System.out.println(k + <span class="hljs-string">"="</span> + v));
</code></pre>
<h3 data-id="heading-29">5. Stream API</h3>
<pre><code class="hljs language-Java" lang="Java">map.entrySet()
   .stream()
   .filter(e -&gt; e.getKey().startsWith(<span class="hljs-string">"a"</span>))
   .forEach(System.out::println);
</code></pre>
<h3 data-id="heading-30">6. Iteratorï¼ˆæ—§ç‰ˆï¼Œä¸æ¨èä½†é¢è¯•çˆ±é—®ï¼‰</h3>
<pre><code class="hljs language-Java" lang="Java">Iterator&lt;Map.Entry&lt;String, Object&gt;&gt; it = map.entrySet().iterator();
<span class="hljs-keyword">while</span> (it.hasNext()) {
    Map.<span class="hljs-type">Entry</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> it.next();
}
</code></pre>
<hr/>
<h2 data-id="heading-31">é”®ç±»å‹çš„æœ¬è´¨åŒºåˆ«ï¼ˆéå¸¸é‡è¦ï¼‰</h2>
<h3 data-id="heading-32">JavaScript é”®ç±»å‹ï¼š<strong>æ— é™åˆ¶</strong></h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript">map.<span class="hljs-title function_">set</span>({}, <span class="hljs-string">"obj"</span>);
map.<span class="hljs-title function_">set</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){}, <span class="hljs-string">"fn"</span>);
map.<span class="hljs-title function_">set</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"num"</span>);
map.<span class="hljs-title function_">set</span>(<span class="hljs-string">"1"</span>, <span class="hljs-string">"string"</span>);
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼š<code>map.set(1, ...)</code> ä¸ <code>map.set("1", ...)</code> æ˜¯ä¸åŒé”®ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-33">Java é”®ç±»å‹ï¼šå¿…é¡»æ˜¯å¯¹è±¡ï¼Œä¸”ç”±æ³›å‹å†³å®š</h2>
<pre><code class="hljs language-Java" lang="Java">Map&lt;Object, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
map.put(<span class="hljs-number">1</span>, <span class="hljs-string">"num"</span>);      <span class="hljs-comment">// è‡ªåŠ¨è£…ç®±ä¸º Integer</span>
map.put(<span class="hljs-string">"1"</span>, <span class="hljs-string">"string"</span>);
</code></pre>
<h4 data-id="heading-34">Java ä¸­ç›¸åŒç±»å‹çš„å¯¹è±¡ä¾èµ– <code>equals()</code> ä¸ <code>hashCode()</code></h4>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
    String name;
}

<span class="hljs-comment">// æ—  equals / hashCode</span>
Map&lt;Person, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
map.put(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"A"</span>), <span class="hljs-string">"data"</span>);
map.get(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"A"</span>)); <span class="hljs-comment">// âŒ null</span>
</code></pre>
<blockquote>
<p>å› ä¸º Java ä½¿ç”¨ hashCode åˆ¤æ–­é”®æ˜¯å¦ç›¸ç­‰ã€‚<br/>
JS æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-35">åº•å±‚åŸç†å¯¹ç…§ï¼šHashMap å†…éƒ¨ç»“æ„</h2>
<h3 data-id="heading-36">JavaScript Mapï¼ˆç®€å•ï¼‰</h3>
<ul>
<li>å†…éƒ¨æ˜¯ä¸€ä¸ªå“ˆå¸Œç»“æ„</li>
<li>è‡ªåŠ¨å¤„ç†æ‰©å®¹</li>
<li>ä¿æŒæ’å…¥é¡ºåº</li>
<li>æ— è§†é”®çš„ç±»å‹</li>
</ul>
<hr/>
<h2 data-id="heading-37">Java HashMapï¼ˆå¤æ‚ä½†ä¼˜ç§€ï¼‰</h2>
<p>Java HashMap åº•å±‚ç»“æ„ï¼š</p>
<pre><code class="hljs language-Java" lang="Java">æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘
</code></pre>
<p>æµç¨‹ï¼š</p>
<ol>
<li>key é€šè¿‡ <code>hashCode()</code> â†’ è®¡ç®—å“ˆå¸Œå€¼</li>
<li>æ˜ å°„åˆ°æ•°ç»„ index</li>
<li>å¦‚æœå†²çªï¼Œä½¿ç”¨é“¾è¡¨</li>
<li>é“¾è¡¨é•¿åº¦ &gt; 8 æ—¶è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼ˆæé«˜æ€§èƒ½ï¼‰</li>
</ol>
<p>æ—¶æœŸï¼š</p>
<ul>
<li>Java 8 ä¹‹å‰ï¼šåªç”¨é“¾è¡¨</li>
<li>Java 8 ä¹‹åï¼šé“¾è¡¨ + æ ‘å¹¶å­˜</li>
</ul>
<blockquote>
<p>è¿™æ˜¯ Java Map èƒ½æ”¯æŒå¤§è§„æ¨¡æ•°æ®é«˜æ€§èƒ½è®¿é—®çš„å…³é”®ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-38">Java çš„ Map å®ç°å…¨å®¶æ¡¶</h2>








































<table><thead><tr><th>å®ç°ç±»</th><th>ç‰¹ç‚¹</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>HashMap</strong></td><td>æ— åºï¼Œæœ€å¿«</td><td>æœ€å¸¸ç”¨</td></tr><tr><td><strong>LinkedHashMap</strong></td><td>æœ‰åºï¼ˆæŒ‰æ’å…¥é¡ºåºï¼‰</td><td>éœ€è¦æ’åºè¾“å‡º</td></tr><tr><td><strong>TreeMap</strong></td><td>æŒ‰ key è‡ªåŠ¨æ’åºï¼ˆçº¢é»‘æ ‘ï¼‰</td><td>æŒ‰å­—å…¸åºæ’åº</td></tr><tr><td><strong>Hashtable</strong></td><td>çº¿ç¨‹å®‰å…¨ï¼Œè¿‡æ—¶</td><td>ä¸æ¨è</td></tr><tr><td><strong>ConcurrentHashMap</strong></td><td>é«˜å¹¶å‘ç¯å¢ƒä¸‹çš„çº¿ç¨‹å®‰å…¨ Map</td><td>Web æœåŠ¡åœºæ™¯</td></tr><tr><td><strong>WeakHashMap</strong></td><td>å¼±å¼•ç”¨é”®ï¼Œä¼šè‡ªåŠ¨å›æ”¶</td><td>ç¼“å­˜</td></tr></tbody></table>
<p>JS åªæœ‰ä¸€ä¸ªç®€å•çš„ <code>Map</code>ï¼Œè¿œä¸å¦‚ Java ä¸°å¯Œã€‚</p>
<hr/>
<h2 data-id="heading-39">å…¸å‹åº”ç”¨åœºæ™¯å¯¹æ¯”</h2>
<h3 data-id="heading-40">1. ç»Ÿè®¡è¯é¢‘ï¼ˆå‰ç«¯åˆ·é¢˜å¸¸ç”¨ï¼‰</h3>
<h4 data-id="heading-41">JavaScript</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> ch <span class="hljs-keyword">of</span> str) {
  map.<span class="hljs-title function_">set</span>(ch, (map.<span class="hljs-title function_">get</span>(ch) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
}
</code></pre>
<h4 data-id="heading-42">Java</h4>
<pre><code class="hljs language-Java" lang="Java">Map&lt;Character, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
<span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> ch : str.toCharArray()) {
    map.put(ch, map.getOrDefault(ch, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
}
</code></pre>
<hr/>
<h3 data-id="heading-43">2. ç¼“å­˜æ•°æ®</h3>
<h4 data-id="heading-44">JavaScript</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
cache.<span class="hljs-title function_">set</span>(key, result);
</code></pre>
<h4 data-id="heading-45">Java</h4>
<pre><code class="hljs language-Java" lang="Java">Map&lt;String, Object&gt; cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
cache.put(key, result);
</code></pre>
<p>Java éœ€è¦è€ƒè™‘å¤šçº¿ç¨‹åœºæ™¯ï¼Œå› æ­¤æœ‰çº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ã€‚</p>
<hr/>
<h2 data-id="heading-46">æœ€ä½³å®è·µä¸å¸¸è§å‘</h2>
<h3 data-id="heading-47">JavaScript Map</h3>
<h4 data-id="heading-48">âœ” æœ€ä½³å®è·µ</h4>
<ul>
<li>ç”¨ Map æ›¿ä»£å¯¹è±¡ <code>{}</code> åšé”®å€¼å­˜å‚¨</li>
<li>é”®ä¸æ˜¯å­—ç¬¦ä¸²çš„æ—¶å€™ï¼ˆå¯¹è±¡ã€å‡½æ•°ï¼‰</li>
</ul>
<h4 data-id="heading-49">âŒ å¸¸è§å‘</h4>
<ul>
<li>å¯¹è±¡ä½œä¸º key æ—¶å¿…é¡»æ˜¯åŒä¸€ä¸ªå¼•ç”¨</li>
</ul>
<hr/>
<h2 data-id="heading-50">Java Map</h2>
<h4 data-id="heading-51">âœ” æœ€ä½³å®è·µ</h4>
<ol>
<li>è¦†ç›–ç±»çš„ <code>equals()</code> ä¸ <code>hashCode()</code> ä½¿ä¹‹å¯ä½œä¸º key</li>
<li>å¤§å¤šæ•°åœºæ™¯é»˜è®¤ç”¨ <code>HashMap</code></li>
<li>å¹¶å‘åœºæ™¯ç”¨ <code>ConcurrentHashMap</code></li>
<li>éœ€è¦é¡ºåºåˆ™ç”¨ <code>LinkedHashMap</code></li>
<li>å¤§æ•°æ®é‡é¿å…ä½¿ç”¨åµŒå¥— Mapï¼ˆè¿‡äºå¤æ‚ï¼‰</li>
</ol>
<h4 data-id="heading-52">âŒ å¸¸è§å‘</h4>
<ul>
<li>ä½¿ç”¨ Arrays.asList() åˆå§‹åŒ–å¯¼è‡´ä¸å¯å˜</li>
<li>å¿˜è®°é‡å†™ equals/hashCode å¯¼è‡´å–ä¸åˆ°å€¼</li>
<li>å¹¶å‘ç¯å¢ƒç”¨ HashMap å¯¼è‡´æ­»å¾ªç¯ï¼ˆæ—§ç‰ˆæœ¬é—®é¢˜ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-53">æ€»ç»“</h2>



































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>JavaScript Map</th><th>Java Map</th></tr></thead><tbody><tr><td>çµæ´»æ€§</td><td>â­â­â­â­â­</td><td>â­â­â­</td></tr><tr><td>ç±»å‹å®‰å…¨</td><td>â­</td><td>â­â­â­â­â­</td></tr><tr><td>æ€§èƒ½ï¼ˆå¤§è§„æ¨¡ï¼‰</td><td>â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td>å¯æ‰©å±•æ€§</td><td>â­â­</td><td>â­â­â­â­â­</td></tr><tr><td>å­¦ä¹ æ›²çº¿</td><td>â­â­</td><td>â­â­â­â­</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[preconnectã€dns-prefetchã€prerenderã€preloadã€prefetch]]></title>    <link>https://juejin.cn/post/7579256547790143529</link>    <guid>https://juejin.cn/post/7579256547790143529</guid>    <pubDate>2025-12-03T02:38:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579256547790143529" data-draft-id="7579101504290652214" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="preconnectã€dns-prefetchã€prerenderã€preloadã€prefetch"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-03T02:38:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ximimimi"/> <meta itemprop="url" content="https://juejin.cn/user/3350967174040238"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            preconnectã€dns-prefetchã€prerenderã€preloadã€prefetch
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3350967174040238/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ximimimi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:38:45.000Z" title="Wed Dec 03 2025 02:38:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. preconnectï¼šæå‰å»ºç«‹è¿æ¥</h2>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯preconnectï¼Ÿ</h3>
<p><code>preconnect</code>Â æŒ‡ä»¤å‘Šè¯‰æµè§ˆå™¨ï¼š<strong>å½“å‰é¡µé¢å¾ˆå¿«å°±ä¼šä¸æŸä¸ªç¬¬ä¸‰æ–¹åŸŸåå»ºç«‹è¿æ¥ï¼Œè¯·æå‰å®ŒæˆDNSè§£æã€TCPæ¡æ‰‹å’ŒTLSåå•†</strong>ã€‚è¿™å¯ä»¥èŠ‚çœ100-500æ¯«ç§’çš„è¿æ¥å»ºç«‹æ—¶é—´ã€‚</p>
<h3 data-id="heading-2">é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>å…³é”®ç¬¬ä¸‰æ–¹èµ„æºï¼ˆå¦‚CDNå­—ä½“ã€æ ·å¼è¡¨ï¼‰</li>
<li>å·²çŸ¥çš„APIç«¯ç‚¹</li>
<li>ç¤¾äº¤åª’ä½“å°éƒ¨ä»¶</li>
<li>åˆ†æè„šæœ¬</li>
</ul>
<h3 data-id="heading-3">åœ¨Reactä¸­ä½¿ç”¨preconnect</h3>
<h4 data-id="heading-4">æ–¹æ³•ä¸€ï¼šåœ¨HTMLæ¨¡æ¿ä¸­é™æ€æ·»åŠ </h4>
<p>åœ¨<code>public/index.html</code>çš„<code>&lt;head&gt;</code>éƒ¨åˆ†ï¼š</p>
<p>html</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æå‰è¿æ¥å­—ä½“æœåŠ¡ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.gstatic.com"</span> <span class="hljs-attr">crossorigin</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- æå‰è¿æ¥APIæœåŠ¡å™¨ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://api.example.com"</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- æå‰è¿æ¥CDN --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.example.com"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"root"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-5">æ–¹æ³•äºŒï¼šä½¿ç”¨React HelmetåŠ¨æ€ç®¡ç†</h4>
<p>bash</p>
<pre><code class="hljs language-csharp" lang="csharp">npm install react-helmet-<span class="hljs-keyword">async</span>
</code></pre>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">HelmetProvider</span>, <span class="hljs-title class_">Helmet</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-helmet-async'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">HelmetProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Helmet</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com"</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.gstatic.com"</span> <span class="hljs-attr">crossorigin</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://api.example.com"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Helmet</span>&gt;</span>
        {/* åº”ç”¨å†…å®¹ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">HelmetProvider</span>&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-6">æ–¹æ³•ä¸‰ï¼šåŸºäºç”¨æˆ·äº¤äº’æ™ºèƒ½é¢„è¿æ¥</h4>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">import { useEffect, useRef } from 'react'<span class="hljs-comment">;</span>

function ProductCard({ productId }) {
  const <span class="hljs-attr">cardRef</span> = useRef(null)<span class="hljs-comment">;</span>

  useEffect(() =&gt; {
    const <span class="hljs-attr">card</span> = cardRef.current<span class="hljs-comment">;</span>
    
    const <span class="hljs-attr">handleMouseEnter</span> = () =&gt; {
      // å½“ç”¨æˆ·æ‚¬åœåœ¨å•†å“å¡ç‰‡ä¸Šæ—¶ï¼Œé¢„è¿æ¥è¯¦æƒ…API
      const <span class="hljs-attr">link</span> = document.createElement(<span class="hljs-string">'link'</span>)<span class="hljs-comment">;</span>
      <span class="hljs-attr">link.rel</span> = <span class="hljs-string">'preconnect'</span><span class="hljs-comment">;</span>
      <span class="hljs-attr">link.href</span> = `https://api.example.com/products/<span class="hljs-variable">${productId}</span>`<span class="hljs-comment">;</span>
      document.head.appendChild(link)<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>

    card.addEventListener('mouseenter', handleMouseEnter)<span class="hljs-comment">;</span>
    
    return () =&gt; {
      card.removeEventListener('mouseenter', handleMouseEnter)<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[productId]</span>)<span class="hljs-comment">;</span>

  return &lt;div <span class="hljs-attr">ref</span>={cardRef}&gt;å•†å“å¡ç‰‡&lt;/div&gt;<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-7">æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>åªå¯¹å…³é”®ç¬¬ä¸‰æ–¹èµ„æºä½¿ç”¨preconnect</strong></li>
<li><strong>ä¸ºè·¨åŸŸèµ„æºæ·»åŠ crossoriginå±æ€§</strong></li>
<li><strong>æœ€å¤šé¢„è¿æ¥4-6ä¸ªåŸŸå</strong>ï¼Œé¿å…è¿‡åº¦ä½¿ç”¨</li>
<li><strong>ç»“åˆdns-prefetchä½œä¸ºåå¤‡</strong></li>
</ol>
<h2 data-id="heading-8">2. dns-prefetchï¼šæå‰DNSè§£æ</h2>
<h3 data-id="heading-9">ä»€ä¹ˆæ˜¯dns-prefetchï¼Ÿ</h3>
<p><code>dns-prefetch</code>Â å‘Šè¯‰æµè§ˆå™¨ï¼š<strong>æå‰è§£ææŒ‡å®šåŸŸåçš„DNS</strong>ï¼Œä½†ä¸å»ºç«‹TCPè¿æ¥ã€‚DNSè§£æé€šå¸¸éœ€è¦20-120æ¯«ç§’ï¼Œæå‰è§£æå¯ä»¥æ˜¾è‘—å‡å°‘åç»­è¯·æ±‚çš„å»¶è¿Ÿã€‚</p>
<h3 data-id="heading-10">ä¸preconnectçš„åŒºåˆ«</h3>

























<table><thead><tr><th>ç‰¹æ€§</th><th>dns-prefetch</th><th>preconnect</th></tr></thead><tbody><tr><td>ä½œç”¨</td><td>ä»…DNSè§£æ</td><td>DNS + TCP + TLS</td></tr><tr><td>å¼€é”€</td><td>ä½</td><td>ä¸­ç­‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>éå…³é”®ç¬¬ä¸‰æ–¹èµ„æº</td><td>å…³é”®ç¬¬ä¸‰æ–¹èµ„æº</td></tr></tbody></table>
<h3 data-id="heading-11">åœ¨Reactä¸­ä½¿ç”¨dns-prefetch</h3>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ¨åº”ç”¨çš„æ ¹ç»„ä»¶æˆ–å¸ƒå±€ç»„ä»¶ä¸­</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Helmet</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-helmet-async'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Layout</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Helmet</span>&gt;</span>
        {/* ä¸ºåˆ†ææœåŠ¡æå‰è§£æDNS */}
        <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"dns-prefetch"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://www.google-analytics.com"</span> /&gt;</span>
        
        {/* ä¸ºç¤¾äº¤åª’ä½“æ’ä»¶æå‰è§£æDNS */}
        <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"dns-prefetch"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://connect.facebook.net"</span> /&gt;</span>
        
        {/* ä¸ºCDNèµ„æºæå‰è§£æDNS */}
        <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"dns-prefetch"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdnjs.cloudflare.com"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Helmet</span>&gt;</span>
      {/* é¡µé¢å¸ƒå±€ */}
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-12">è‡ªåŠ¨åŒ–dns-prefetch</h3>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è‡ªåŠ¨ä¸ºé¡µé¢ä¸­æ‰€æœ‰ç¬¬ä¸‰æ–¹é“¾æ¥æ·»åŠ dns-prefetch</span>
<span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">useAutoDnsPrefetch</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æ”¶é›†é¡µé¢ä¸­æ‰€æœ‰çš„å¤–éƒ¨é“¾æ¥</span>
    <span class="hljs-keyword">const</span> externalLinks = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'a[href^="http"]'</span>))
      .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">link</span> =&gt;</span> {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(link.<span class="hljs-property">href</span>).<span class="hljs-property">origin</span>;
        } <span class="hljs-keyword">catch</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
      })
      .<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>)
      .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">origin</span> =&gt;</span> origin !== <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span>);

    <span class="hljs-comment">// å»é‡</span>
    <span class="hljs-keyword">const</span> uniqueOrigins = [...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(externalLinks)];

    <span class="hljs-comment">// ä¸ºæ¯ä¸ªå”¯ä¸€åŸŸåæ·»åŠ dns-prefetch</span>
    uniqueOrigins.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">origin</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`link[href="<span class="hljs-subst">${origin}</span>"]`</span>)) {
        <span class="hljs-keyword">const</span> link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'link'</span>);
        link.<span class="hljs-property">rel</span> = <span class="hljs-string">'dns-prefetch'</span>;
        link.<span class="hljs-property">href</span> = origin;
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(link);
      }
    });
  }, []);
}

<span class="hljs-comment">// åœ¨åº”ç”¨ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">useAutoDnsPrefetch</span>();
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åº”ç”¨å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<h2 data-id="heading-13">3. prerenderï¼šæå‰æ¸²æŸ“é¡µé¢ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</h2>
<h3 data-id="heading-14">ä»€ä¹ˆæ˜¯prerenderï¼Ÿ</h3>
<p><code>prerender</code>Â æ˜¯æœ€æ¿€è¿›çš„èµ„æºæç¤ºï¼Œå®ƒå‘Šè¯‰æµè§ˆå™¨ï¼š<strong>åœ¨åå°å®Œå…¨åŠ è½½å¹¶æ¸²æŸ“æ•´ä¸ªé¡µé¢</strong>ã€‚å½“ç”¨æˆ·å¯¼èˆªåˆ°è¯¥é¡µé¢æ—¶ï¼Œå¯ä»¥ç«‹å³æ˜¾ç¤ºã€‚</p>
<h3 data-id="heading-15">é£é™©ä¸æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>é«˜æµé‡æ¶ˆè€—</strong>ï¼šé¢„æ¸²æŸ“ä¼šåŠ è½½é¡µé¢æ‰€æœ‰èµ„æº</li>
<li><strong>é«˜CPU/å†…å­˜å ç”¨</strong>ï¼šåœ¨åå°æ¸²æŸ“æ•´ä¸ªé¡µé¢</li>
<li><strong>å¯èƒ½æµªè´¹èµ„æº</strong>ï¼šå¦‚æœç”¨æˆ·ä¸è®¿é—®è¯¥é¡µé¢</li>
<li><strong>éšç§é—®é¢˜</strong>ï¼šå¯èƒ½é¢„åŠ è½½éœ€è¦è®¤è¯çš„é¡µé¢</li>
</ol>
<h3 data-id="heading-16">é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>ç”¨æˆ·ææœ‰å¯èƒ½è®¿é—®çš„ä¸‹ä¸€é¡µï¼ˆå¦‚è´­ç‰©è½¦â†’ç»“è´¦ï¼‰</li>
<li>å•é¡µåº”ç”¨çš„åˆå§‹è·¯ç”±</li>
<li>ç™»å½•åçš„é¦–ä¸ªé¡µé¢</li>
</ul>
<h3 data-id="heading-17">åœ¨Reactä¸­è°¨æ…ä½¿ç”¨prerender</h3>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useEffect, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useLocation } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">useSmartPrerender</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> location = <span class="hljs-title function_">useLocation</span>();
  <span class="hljs-keyword">const</span> [prerenderedPages, setPrerenderedPages] = <span class="hljs-title function_">useState</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>());

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æ ¹æ®å½“å‰é¡µé¢å†³å®šé¢„æ¸²æŸ“å“ªäº›é¡µé¢</span>
    <span class="hljs-keyword">const</span> predictions = {
      <span class="hljs-string">'/products'</span>: [<span class="hljs-string">'/product/123'</span>, <span class="hljs-string">'/cart'</span>],
      <span class="hljs-string">'/cart'</span>: [<span class="hljs-string">'/checkout'</span>],
      <span class="hljs-string">'/'</span>: [<span class="hljs-string">'/login'</span>, <span class="hljs-string">'/register'</span>]
    };

    <span class="hljs-keyword">const</span> predictedPaths = predictions[location.<span class="hljs-property">pathname</span>] || [];
    
    predictedPaths.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">path</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (!prerenderedPages.<span class="hljs-title function_">has</span>(path)) {
        <span class="hljs-comment">// åˆ›å»ºprerenderé“¾æ¥</span>
        <span class="hljs-keyword">const</span> link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'link'</span>);
        link.<span class="hljs-property">rel</span> = <span class="hljs-string">'prerender'</span>;
        link.<span class="hljs-property">href</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">window</span>.location.origin}</span><span class="hljs-subst">${path}</span>`</span>;
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(link);
        
        <span class="hljs-comment">// é™åˆ¶é¢„æ¸²æŸ“æ—¶é—´ï¼Œé¿å…é•¿æœŸå ç”¨èµ„æº</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-keyword">if</span> (link.<span class="hljs-property">parentNode</span>) {
            link.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(link);
          }
        }, <span class="hljs-number">30000</span>); <span class="hljs-comment">// 30ç§’åç§»é™¤</span>
        
        <span class="hljs-title function_">setPrerenderedPages</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...prev, path]));
      }
    });
  }, [location.<span class="hljs-property">pathname</span>, prerenderedPages]);
}

<span class="hljs-comment">// åœ¨åº”ç”¨ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">useSmartPrerender</span>();
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åº”ç”¨å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-18">æ›¿ä»£æ–¹æ¡ˆï¼šéƒ¨åˆ†é¢„æ¸²æŸ“</h3>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åªé¢„æ¸²æŸ“å…³é”®ç»„ä»¶ï¼Œè€Œä¸æ˜¯æ•´ä¸ªé¡µé¢</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">PredictiveLoader</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [preloadedComponents, setPreloadedComponents] = <span class="hljs-title function_">useState</span>({});

  <span class="hljs-comment">// é¢„æµ‹ç”¨æˆ·å¯èƒ½éœ€è¦çš„ç»„ä»¶</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">predictComponents</span> = (<span class="hljs-params">currentPage</span>) =&gt; {
    <span class="hljs-keyword">const</span> predictions = {
      <span class="hljs-attr">homepage</span>: [<span class="hljs-string">'LoginForm'</span>, <span class="hljs-string">'FeaturedProducts'</span>],
      <span class="hljs-attr">productList</span>: [<span class="hljs-string">'ProductFilters'</span>, <span class="hljs-string">'Pagination'</span>],
      <span class="hljs-attr">cart</span>: [<span class="hljs-string">'CheckoutButton'</span>, <span class="hljs-string">'Recommendations'</span>]
    };
    
    <span class="hljs-keyword">return</span> predictions[currentPage] || [];
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">preloadComponent</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">componentName</span>) =&gt; {
    <span class="hljs-keyword">if</span> (!preloadedComponents[componentName]) {
      <span class="hljs-comment">// åŠ¨æ€å¯¼å…¥ç»„ä»¶ï¼ˆWebpackä»£ç åˆ†å‰²ï¼‰</span>
      <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`./components/<span class="hljs-subst">${componentName}</span>`</span>);
      <span class="hljs-title function_">setPreloadedComponents</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> ({
        ...prev,
        [componentName]: <span class="hljs-variable language_">module</span>.<span class="hljs-property">default</span>
      }));
    }
  };

  <span class="hljs-comment">// æ ¹æ®ç”¨æˆ·è¡Œä¸ºé¢„åŠ è½½ç»„ä»¶</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> components = <span class="hljs-title function_">predictComponents</span>(currentPage);
    components.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">componentName</span> =&gt;</span> {
      <span class="hljs-comment">// åœ¨ç©ºé—²æ—¶é—´é¢„åŠ è½½</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-string">'requestIdleCallback'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
        <span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">preloadComponent</span>(componentName));
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">preloadComponent</span>(componentName), <span class="hljs-number">1000</span>);
      }
    });
  }, [currentPage]);

  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h2 data-id="heading-19">4. preloadï¼šæå‰åŠ è½½å…³é”®èµ„æº</h2>
<h3 data-id="heading-20">ä»€ä¹ˆæ˜¯preloadï¼Ÿ</h3>
<p><code>preload</code>Â å‘Šè¯‰æµè§ˆå™¨ï¼š<strong>å½“å‰é¡µé¢éœ€è¦è¿™ä¸ªèµ„æºï¼Œè¯·ç«‹å³ä»¥é«˜ä¼˜å…ˆçº§åŠ è½½</strong>ã€‚å®ƒå¼ºåˆ¶æµè§ˆå™¨æå‰å‘ç°å¹¶åŠ è½½èµ„æºï¼Œé¿å…èµ„æºåŠ è½½è¿‡æ™šå¯¼è‡´çš„æ¸²æŸ“é˜»å¡ã€‚</p>
<h3 data-id="heading-21">å…³é”®ç‰¹æ€§</h3>
<ul>
<li><strong>ç«‹å³åŠ è½½</strong>ï¼Œä¼˜å…ˆçº§é«˜</li>
<li><strong>å¿…é¡»æŒ‡å®šaså±æ€§</strong>ï¼ˆscriptã€styleã€fontç­‰ï¼‰</li>
<li><strong>æ”¯æŒonloadå›è°ƒ</strong></li>
<li><strong>ä¼šè§¦å‘åŒæºç­–ç•¥</strong></li>
</ul>
<h3 data-id="heading-22">åœ¨Reactä¸­ä½¿ç”¨preload</h3>
<h4 data-id="heading-23">é¢„åŠ è½½å…³é”®å­—ä½“</h4>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">import { Helmet } from 'react-helmet-async'<span class="hljs-comment">;</span>

function FontPreloader() {
  return (
    &lt;Helmet&gt;
      &lt;link
        <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span>
        <span class="hljs-attr">href</span>=<span class="hljs-string">"/fonts/roboto-bold.woff2"</span>
        <span class="hljs-attr">as</span>=<span class="hljs-string">"font"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"font/woff2"</span>
        <span class="hljs-attr">crossOrigin</span>=<span class="hljs-string">"anonymous"</span>
      /&gt;
      &lt;link
        <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span>
        <span class="hljs-attr">href</span>=<span class="hljs-string">"/fonts/roboto-regular.woff2"</span>
        <span class="hljs-attr">as</span>=<span class="hljs-string">"font"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"font/woff2"</span>
        <span class="hljs-attr">crossOrigin</span>=<span class="hljs-string">"anonymous"</span>
      /&gt;
    &lt;/Helmet&gt;
  )<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-24">é¢„åŠ è½½å…³é”®å›¾ç‰‡</h4>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">function HeroImage({ imageUrl }) {
  useEffect(() =&gt; {
    // åŠ¨æ€é¢„åŠ è½½è‹±é›„å›¾ç‰‡
    const <span class="hljs-attr">link</span> = document.createElement(<span class="hljs-string">'link'</span>)<span class="hljs-comment">;</span>
    <span class="hljs-attr">link.rel</span> = <span class="hljs-string">'preload'</span><span class="hljs-comment">;</span>
    <span class="hljs-attr">link.href</span> = imageUrl<span class="hljs-comment">;</span>
    <span class="hljs-attr">link.as</span> = <span class="hljs-string">'image'</span><span class="hljs-comment">;</span>
    <span class="hljs-attr">link.onload</span> = () =&gt; {
      console.log('Hero image preloaded')<span class="hljs-comment">;</span>
      // å¯ä»¥åœ¨è¿™é‡Œè§¦å‘ä¸€äº›åŠ¨ç”»æˆ–çŠ¶æ€å˜åŒ–
    }<span class="hljs-comment">;</span>
    document.head.appendChild(link)<span class="hljs-comment">;</span>
    
    return () =&gt; {
      if (link.parentNode) {
        link.parentNode.removeChild(link)<span class="hljs-comment">;</span>
      }
    }<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[imageUrl]</span>)<span class="hljs-comment">;</span>

  return &lt;img <span class="hljs-attr">src</span>={imageUrl} alt=<span class="hljs-string">"Hero"</span> /&gt;<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-25">é¢„åŠ è½½å…³é”®è„šæœ¬</h4>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é¢„åŠ è½½å»¶è¿ŸåŠ è½½çš„ç»„ä»¶</span>
<span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">useComponentPreloader</span>(<span class="hljs-params">componentPath</span>) {
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ä½¿ç”¨Webpackçš„é­”æ³•æ³¨é‡Šé¢„åŠ è½½</span>
    <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackPreload: true */</span> <span class="hljs-string">`./components/<span class="hljs-subst">${componentPath}</span>`</span>);
  }, [componentPath]);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">LazyComponentWrapper</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// å½“ç”¨æˆ·æ‚¬åœåœ¨æŒ‰é’®ä¸Šæ—¶ï¼Œé¢„åŠ è½½ç»„ä»¶</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMouseEnter</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">useComponentPreloader</span>(<span class="hljs-string">'ExpensiveChart'</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onMouseEnter</span>=<span class="hljs-string">{handleMouseEnter}</span>&gt;</span>
      æ‚¬åœæˆ‘é¢„åŠ è½½å›¾è¡¨ç»„ä»¶
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-26">Webpacké…ç½®ä¸­çš„preload</h3>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">PreloadWebpackPlugin</span>({
      <span class="hljs-attr">rel</span>: <span class="hljs-string">'preload'</span>,
      <span class="hljs-attr">include</span>: <span class="hljs-string">'initial'</span>,
      <span class="hljs-attr">fileBlacklist</span>: [<span class="hljs-regexp">/.map$/</span>, <span class="hljs-regexp">/hot-update.js$/</span>],
    }),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">PreloadWebpackPlugin</span>({
      <span class="hljs-attr">rel</span>: <span class="hljs-string">'prefetch'</span>,
      <span class="hljs-attr">include</span>: <span class="hljs-string">'asyncChunks'</span>,
    }),
  ],
};
</code></pre>
<h2 data-id="heading-27">5. prefetchï¼šç©ºé—²æ—¶é¢„åŠ è½½èµ„æº</h2>
<h3 data-id="heading-28">ä»€ä¹ˆæ˜¯prefetchï¼Ÿ</h3>
<p><code>prefetch</code>Â å‘Šè¯‰æµè§ˆå™¨ï¼š<strong>æœªæ¥å¯èƒ½éœ€è¦è¿™ä¸ªèµ„æºï¼Œè¯·åœ¨ç©ºé—²æ—¶ä»¥ä½ä¼˜å…ˆçº§åŠ è½½</strong>ã€‚å®ƒä¸ä¼šé˜»å¡å…³é”®èµ„æºï¼Œè€Œæ˜¯åˆ©ç”¨æµè§ˆå™¨ç©ºé—²æ—¶é—´æå‰å‡†å¤‡ã€‚</p>
<h3 data-id="heading-29">é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>ç”¨æˆ·å¯èƒ½è®¿é—®çš„ä¸‹ä¸€é¡µèµ„æº</li>
<li>å•é¡µåº”ç”¨çš„è·¯ç”±ä»£ç åˆ†å‰²</li>
<li>éå…³é”®çš„åŠŸèƒ½è„šæœ¬</li>
<li>é¢„æµ‹æ€§åŠ è½½</li>
</ul>
<h3 data-id="heading-30">åœ¨Reactä¸­ä½¿ç”¨prefetch</h3>
<h4 data-id="heading-31">è·¯ç”±çº§é¢„å–ï¼ˆReact Routerï¼‰</h4>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">import { useEffect } from 'react'<span class="hljs-comment">;</span>
import { useLocation, useNavigate } from 'react-router-dom'<span class="hljs-comment">;</span>

function useRoutePrefetch() {
  const <span class="hljs-attr">location</span> = useLocation()<span class="hljs-comment">;</span>
  const <span class="hljs-attr">navigate</span> = useNavigate()<span class="hljs-comment">;</span>

  useEffect(() =&gt; {
    // æ ¹æ®å½“å‰è·¯å¾„é¢„æµ‹ä¸‹ä¸€ä¸ªå¯èƒ½çš„è·¯ç”±
    const <span class="hljs-attr">routePredictions</span> = {
      '/': <span class="hljs-section">['/dashboard', '/login']</span>,
      '/products': <span class="hljs-section">['/product/featured', '/cart']</span>,
      '/cart': <span class="hljs-section">['/checkout', '/payment']</span>,
    }<span class="hljs-comment">;</span>

    const <span class="hljs-attr">predictedRoutes</span> = routePredictions[location.pathname] || []<span class="hljs-comment">;</span>
    
    predictedRoutes.forEach(<span class="hljs-attr">route</span> =&gt; {
      // é¢„å–è·¯ç”±å¯¹åº”çš„JS chunk
      const <span class="hljs-attr">link</span> = document.createElement(<span class="hljs-string">'link'</span>)<span class="hljs-comment">;</span>
      <span class="hljs-attr">link.rel</span> = <span class="hljs-string">'prefetch'</span><span class="hljs-comment">;</span>
      <span class="hljs-attr">link.href</span> = `/static/js/<span class="hljs-variable">${route.replace(///g, '_')}</span>.chunk.js`<span class="hljs-comment">;</span>
      <span class="hljs-attr">link.as</span> = <span class="hljs-string">'script'</span><span class="hljs-comment">;</span>
      document.head.appendChild(link)<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[location.pathname]</span>)<span class="hljs-comment">;</span>
}

// åœ¨åº”ç”¨ä¸­ä½¿ç”¨
function App() {
  useRoutePrefetch()<span class="hljs-comment">;</span>
  
  return (
    &lt;Routes&gt;
      &lt;Route <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> element={&lt;Home /&gt;} /&gt;
      &lt;Route <span class="hljs-attr">path</span>=<span class="hljs-string">"/dashboard"</span> element={&lt;Dashboard /&gt;} /&gt;
      &lt;Route <span class="hljs-attr">path</span>=<span class="hljs-string">"/products"</span> element={&lt;Products /&gt;} /&gt;
      &lt;Route <span class="hljs-attr">path</span>=<span class="hljs-string">"/cart"</span> element={&lt;Cart /&gt;} /&gt;
    &lt;/Routes&gt;
  )<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-32">åŸºäºIntersection Observerçš„æ™ºèƒ½é¢„å–</h4>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useEffect, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">LazySection</span>(<span class="hljs-params">{ componentName, threshold = <span class="hljs-number">0.1</span> }</span>) {
  <span class="hljs-keyword">const</span> sectionRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> hasPrefetched = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(
      <span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> {
        entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
          <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">isIntersecting</span> &amp;&amp; !hasPrefetched.<span class="hljs-property">current</span>) {
            <span class="hljs-comment">// å½“ç»„ä»¶è¿›å…¥è§†å£æ—¶ï¼Œé¢„å–ç›¸å…³èµ„æº</span>
            <span class="hljs-title function_">prefetchComponent</span>(componentName);
            hasPrefetched.<span class="hljs-property">current</span> = <span class="hljs-literal">true</span>;
            observer.<span class="hljs-title function_">unobserve</span>(entry.<span class="hljs-property">target</span>);
          }
        });
      },
      { threshold }
    );

    <span class="hljs-keyword">if</span> (sectionRef.<span class="hljs-property">current</span>) {
      observer.<span class="hljs-title function_">observe</span>(sectionRef.<span class="hljs-property">current</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> observer.<span class="hljs-title function_">disconnect</span>();
  }, [componentName, threshold]);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">prefetchComponent</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">name</span>) =&gt; {
    <span class="hljs-comment">// é¢„å–ç»„ä»¶åŠå…¶ä¾èµ–</span>
    <span class="hljs-keyword">const</span> prefetchPromises = [
      <span class="hljs-comment">// ç»„ä»¶æœ¬èº«</span>
      <span class="hljs-keyword">import</span>(<span class="hljs-string">`./components/<span class="hljs-subst">${name}</span>`</span>),
      <span class="hljs-comment">// ç»„ä»¶å¯èƒ½éœ€è¦çš„æ ·å¼</span>
      <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/css/<span class="hljs-subst">${name}</span>.css`</span>),
      <span class="hljs-comment">// ç»„ä»¶å¯èƒ½éœ€è¦çš„å›¾ç‰‡</span>
      name === <span class="hljs-string">'Gallery'</span> &amp;&amp; <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/gallery-images'</span>),
    ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);

    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(prefetchPromises);
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{sectionRef}</span>&gt;</span>æ‡’åŠ è½½åŒºåŸŸ<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<h4 data-id="heading-33">ç”¨æˆ·è¡Œä¸ºè§¦å‘çš„é¢„å–</h4>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">function ProductRecommendations() {
  const <span class="hljs-section">[prefetchedProducts, setPrefetchedProducts]</span> = useState(new Set())<span class="hljs-comment">;</span>

  const <span class="hljs-attr">handleProductHover</span> = (productId) =&gt; {
    if (!prefetchedProducts.has(productId)) {
      // é¢„å–äº§å“è¯¦æƒ…
      const <span class="hljs-attr">links</span> = [
        { url: `/api/products/<span class="hljs-variable">${productId}</span>`, as: <span class="hljs-string">'fetch'</span> },
        { url: `/images/products/<span class="hljs-variable">${productId}</span>.jpg`, as: <span class="hljs-string">'image'</span> },
        { url: `/js/product-detail.chunk.js`, as: <span class="hljs-string">'script'</span> },
      ]<span class="hljs-comment">;</span>

      links.forEach(({ url, as }) =&gt; {
        const <span class="hljs-attr">link</span> = document.createElement(<span class="hljs-string">'link'</span>)<span class="hljs-comment">;</span>
        <span class="hljs-attr">link.rel</span> = <span class="hljs-string">'prefetch'</span><span class="hljs-comment">;</span>
        <span class="hljs-attr">link.href</span> = url<span class="hljs-comment">;</span>
        <span class="hljs-attr">link.as</span> = as<span class="hljs-comment">;</span>
        document.head.appendChild(link)<span class="hljs-comment">;</span>
      })<span class="hljs-comment">;</span>

      setPrefetchedProducts(<span class="hljs-attr">prev</span> =&gt; new Set([...prev, productId]))<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>

  return (
    &lt;div&gt;
      {products.map(<span class="hljs-attr">product</span> =&gt; (
        &lt;div
          <span class="hljs-attr">key</span>={product.id}
          <span class="hljs-attr">onMouseEnter</span>={() =&gt; handleProductHover(product.id)}
          <span class="hljs-attr">className</span>=<span class="hljs-string">"product-card"</span>
        &gt;
          {product.name}
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  )<span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-34">ç»¼åˆæœ€ä½³å®è·µ</h2>
<h3 data-id="heading-35">1. ä¼˜å…ˆçº§ç­–ç•¥</h3>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">function ResourcePriorityManager() {
  return (
    &lt;Helmet&gt;
      {/* æœ€é«˜ä¼˜å…ˆçº§ï¼šé¦–å±å…³é”®èµ„æº */}
      &lt;link <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span> href=<span class="hljs-string">"/critical.css"</span> as=<span class="hljs-string">"style"</span> /&gt;
      &lt;link <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span> href=<span class="hljs-string">"/critical.js"</span> as=<span class="hljs-string">"script"</span> /&gt;
      
      {/* é«˜ä¼˜å…ˆçº§ï¼šå…³é”®ç¬¬ä¸‰æ–¹èµ„æº */}
      &lt;link <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> href=<span class="hljs-string">"https://fonts.googleapis.com"</span> /&gt;
      &lt;link <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> href=<span class="hljs-string">"https://fonts.gstatic.com"</span> crossorigin /&gt;
      
      {/* ä¸­ç­‰ä¼˜å…ˆçº§ï¼šé¦–å±å­—ä½“ */}
      &lt;link
        <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span>
        <span class="hljs-attr">href</span>=<span class="hljs-string">"/fonts/primary.woff2"</span>
        <span class="hljs-attr">as</span>=<span class="hljs-string">"font"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"font/woff2"</span>
        crossorigin
      /&gt;
      
      {/* ä½ä¼˜å…ˆçº§ï¼šé¢„æµ‹æ€§èµ„æº */}
      &lt;link <span class="hljs-attr">rel</span>=<span class="hljs-string">"dns-prefetch"</span> href=<span class="hljs-string">"https://analytics.example.com"</span> /&gt;
      &lt;link <span class="hljs-attr">rel</span>=<span class="hljs-string">"prefetch"</span> href=<span class="hljs-string">"/next-page-data.json"</span> as=<span class="hljs-string">"fetch"</span> /&gt;
    &lt;/Helmet&gt;
  )<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-36">2. æ€§èƒ½ç›‘æ§ä¸è°ƒæ•´</h3>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ResourceHintsMonitor</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ç›‘æ§èµ„æºæç¤ºçš„æ•ˆæœ</span>
    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
      list.<span class="hljs-title function_">getEntries</span>().<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> data = {
          <span class="hljs-attr">name</span>: entry.<span class="hljs-property">name</span>,
          <span class="hljs-attr">duration</span>: entry.<span class="hljs-property">duration</span>,
          <span class="hljs-attr">initiatorType</span>: entry.<span class="hljs-property">initiatorType</span>,
          <span class="hljs-attr">startTime</span>: entry.<span class="hljs-property">startTime</span>,
        };
        
        <span class="hljs-comment">// å‘é€åˆ°åˆ†ææœåŠ¡</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'èµ„æºåŠ è½½æ€§èƒ½:'</span>, data);
        
        <span class="hljs-comment">// æ ¹æ®æ€§èƒ½æ•°æ®åŠ¨æ€è°ƒæ•´ç­–ç•¥</span>
        <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">duration</span> &gt; <span class="hljs-number">1000</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`èµ„æº <span class="hljs-subst">${entry.name}</span> åŠ è½½è¿‡æ…¢ï¼Œè€ƒè™‘ä¼˜åŒ–`</span>);
        }
      });
    });
    
    observer.<span class="hljs-title function_">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'resource'</span>] });
    
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> observer.<span class="hljs-title function_">disconnect</span>();
  }, []);
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h2 data-id="heading-37">æ€»ç»“</h2>
<p>æµè§ˆå™¨èµ„æºæç¤ºæ˜¯ä¼˜åŒ–é¡µé¢åŠ è½½æ€§èƒ½çš„å¼ºå¤§å·¥å…·ï¼Œä½†éœ€è¦æ ¹æ®å…·ä½“åœºæ™¯åˆç†ä½¿ç”¨ï¼š</p>
<ol>
<li><strong>preconnect</strong>ï¼šç”¨äºå…³é”®ç¬¬ä¸‰æ–¹èµ„æºï¼Œæå‰å»ºç«‹è¿æ¥</li>
<li><strong>dns-prefetch</strong>ï¼šç”¨äºéå…³é”®ç¬¬ä¸‰æ–¹èµ„æºï¼Œæå‰è§£æDNS</li>
<li><strong>prerender</strong>ï¼šè°¨æ…ä½¿ç”¨ï¼Œä»…ç”¨äºé«˜åº¦å¯é¢„æµ‹çš„é¡µé¢</li>
<li><strong>preload</strong>ï¼šç”¨äºå½“å‰é¡µé¢çš„å…³é”®èµ„æºï¼Œç«‹å³åŠ è½½</li>
<li><strong>prefetch</strong>ï¼šç”¨äºæœªæ¥å¯èƒ½éœ€è¦çš„èµ„æºï¼Œç©ºé—²æ—¶åŠ è½½</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š5.é¼ æ ‡æ‚¬åœäº‹ä»¶]]></title>    <link>https://juejin.cn/post/7579094978682880046</link>    <guid>https://juejin.cn/post/7579094978682880046</guid>    <pubDate>2025-12-03T02:39:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579094978682880046" data-draft-id="7579127397498470451" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š5.é¼ æ ‡æ‚¬åœäº‹ä»¶"/> <meta itemprop="keywords" content="å‰ç«¯,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2025-12-03T02:39:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="irises"/> <meta itemprop="url" content="https://juejin.cn/user/3030697436261735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š5.é¼ æ ‡æ‚¬åœäº‹ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030697436261735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    irises
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:39:31.000Z" title="Wed Dec 03 2025 02:39:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flz6060788%2FMini-Render" target="_blank" title="https://github.com/lz6060788/Mini-Render" ref="nofollow noopener noreferrer">MiniRenderä»“åº“åœ°å€å‚è€ƒ</a></p>
</blockquote>
<p>å¥½çš„ï¼Œæˆ‘ä»¬å¼€å§‹ <strong>æ‚¬åœäº‹ä»¶ (Hover Events)</strong> çš„å®ç°ã€‚</p>
<p>è¿™æ˜¯äº¤äº’ä½“éªŒä¸­è´¨çš„é£è·ƒã€‚ç›®å‰çš„ç‚¹å‡»æ˜¯â€œç¬é—´â€çš„ï¼Œè€Œæ‚¬åœæ˜¯â€œè¿ç»­â€çš„çŠ¶æ€ç®¡ç†ã€‚</p>
<h3 data-id="heading-0">æ ¸å¿ƒé€»è¾‘åˆ†æ</h3>
<p>è¦å®ç° <code>mouseover</code> (ç§»å…¥) å’Œ <code>mouseout</code> (ç§»å‡º)ï¼ŒHandler éœ€è¦<strong>è®°å¿†</strong>ä¸Šä¸€å¸§é¼ æ ‡åœ¨å“ªä¸€ä¸ªå›¾å½¢ä¸Šã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰ï¼š</p>
<ul>
<li><strong><code>target</code></strong>: å½“å‰é¼ æ ‡ä¸‹çš„å›¾å½¢ã€‚</li>
<li><strong><code>_hovered</code></strong>: ä¸Šä¸€æ¬¡é¼ æ ‡æ‰€åœ¨çš„å›¾å½¢ï¼ˆç¼“å­˜çŠ¶æ€ï¼‰ã€‚</li>
</ul>
<p>é€»è¾‘å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç›‘å¬ DOM çš„ <code>mousemove</code>ã€‚</li>
<li>è®¡ç®—å½“å‰é¼ æ ‡ä¸‹çš„ <code>target</code>ã€‚</li>
<li>å¯¹æ¯” <code>target</code> å’Œ <code>_hovered</code>ï¼š
<ul>
<li>å¦‚æœ <strong><code>target !== _hovered</code></strong>ï¼Œè¯´æ˜å‘ç”Ÿäº†çŠ¶æ€åˆ‡æ¢ï¼š
<ul>
<li>å¦‚æœæœ‰ <code>_hovered</code>ï¼Œå¯¹å®ƒè§¦å‘ <strong><code>mouseout</code></strong>ã€‚</li>
<li>å¦‚æœæœ‰ <code>target</code>ï¼Œå¯¹å®ƒè§¦å‘ <strong><code>mouseover</code></strong>ã€‚</li>
<li>æ›´æ–° <code>_hovered = target</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>ä¸ºäº†æ›´å¥½çš„ä½“éªŒï¼Œå½“æœ‰ <code>target</code> æ—¶ï¼Œæˆ‘ä»¬å°†é¼ æ ‡æŒ‡é’ˆè®¾ä¸ºæ‰‹å‹ (<code>pointer</code>)ï¼Œå¦åˆ™è®¾ä¸ºé»˜è®¤ (<code>default</code>)ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-1">1. ä¿®æ”¹ Handler (<code>src/handler/Handler.ts</code>)</h3>
<p>æˆ‘ä»¬éœ€è¦ç»™ Handler ç±»æ·»åŠ çŠ¶æ€å±æ€§ï¼Œå¹¶å¢åŠ  <code>mousemove</code> çš„ç›‘å¬é€»è¾‘ã€‚</p>
<p>ä¸ºäº†ä»£ç æ•´æ´ï¼Œæˆ‘æå–äº†ä¸€ä¸ª <code>_getEventPoint</code> æ–¹æ³•æ¥å¤ç”¨åæ ‡è®¡ç®—ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/handler/Handler.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Storage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../storage/Storage'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Painter</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../painter/Painter'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Displayable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../graphic/Displayable'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Handler</span> {
    <span class="hljs-attr">storage</span>: <span class="hljs-title class_">Storage</span>;
    <span class="hljs-attr">painter</span>: <span class="hljs-title class_">Painter</span>;
    <span class="hljs-attr">dom</span>: <span class="hljs-title class_">HTMLElement</span>;

    <span class="hljs-comment">// çŠ¶æ€ç¼“å­˜ï¼šè®°å½•å½“å‰æ­£æ‚¬åœçš„å…ƒç´ </span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_hovered</span>: <span class="hljs-title class_">Displayable</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">storage: Storage, painter: Painter, dom: HTMLElement</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span> = storage;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">painter</span> = painter;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span> = dom;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_initDomEvents</span>();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_initDomEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ç»‘å®š this ä¸Šä¸‹æ–‡</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_clickHandler</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_mouseMoveHandler</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-comment">// è¿™é‡Œè¿˜å¯ä»¥åŠ  mousedown, mouseup ç­‰</span>
    }

    <span class="hljs-comment">/**
     * è¾…åŠ©æ–¹æ³•ï¼šè·å–ç›¸å¯¹äº Canvas å·¦ä¸Šè§’çš„åæ ‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_getEventPoint</span>(<span class="hljs-params">e: MouseEvent</span>) {
        <span class="hljs-keyword">const</span> rect = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-title function_">getBoundingClientRect</span>();
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">x</span>: e.<span class="hljs-property">clientX</span> - rect.<span class="hljs-property">left</span>,
            <span class="hljs-attr">y</span>: e.<span class="hljs-property">clientY</span> - rect.<span class="hljs-property">top</span>
        };
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_clickHandler</span>(<span class="hljs-params">e: MouseEvent</span>) {
        <span class="hljs-keyword">const</span> { x, y } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getEventPoint</span>(e);
        <span class="hljs-keyword">const</span> target = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_findHover</span>(x, y);

        <span class="hljs-keyword">if</span> (target) {
            target.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">'click'</span>, { target, <span class="hljs-attr">event</span>: e });
        }
    }

    <span class="hljs-comment">/**
     * æ ¸å¿ƒï¼šå¤„ç†é¼ æ ‡ç§»åŠ¨ï¼Œè®¡ç®— Hover çŠ¶æ€
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_mouseMoveHandler</span>(<span class="hljs-params">e: MouseEvent</span>) {
        <span class="hljs-keyword">const</span> { x, y } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getEventPoint</span>(e);
        <span class="hljs-keyword">const</span> target = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_findHover</span>(x, y);
        <span class="hljs-keyword">const</span> lastHovered = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_hovered</span>;

        <span class="hljs-comment">// å¦‚æœé¼ æ ‡ä¸‹çš„å…ƒç´ å˜äº†</span>
        <span class="hljs-keyword">if</span> (target !== lastHovered) {
            
            <span class="hljs-comment">// 1. å¤„ç†ç§»å‡º (MouseOut)</span>
            <span class="hljs-comment">// å¦‚æœä¹‹å‰æœ‰æ‚¬åœå…ƒç´ ï¼Œè¯´æ˜ä»é‚£ä¸ªå…ƒç´ å‡ºæ¥äº†</span>
            <span class="hljs-keyword">if</span> (lastHovered) {
                lastHovered.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">'mouseout'</span>, { <span class="hljs-attr">target</span>: lastHovered, <span class="hljs-attr">event</span>: e });
            }

            <span class="hljs-comment">// 2. å¤„ç†ç§»å…¥ (MouseOver)</span>
            <span class="hljs-comment">// å¦‚æœå½“å‰æœ‰å…ƒç´ ï¼Œè¯´æ˜è¿›å…¥äº†è¿™ä¸ªå…ƒç´ </span>
            <span class="hljs-keyword">if</span> (target) {
                target.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">'mouseover'</span>, { <span class="hljs-attr">target</span>: target, <span class="hljs-attr">event</span>: e });
            }

            <span class="hljs-comment">// 3. æ›´æ–°çŠ¶æ€</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_hovered</span> = target;
        }

        <span class="hljs-comment">// 4. å¤„ç†é¼ æ ‡ç§»åŠ¨ (MouseMove)</span>
        <span class="hljs-comment">// å³ä½¿ç›®æ ‡æ²¡å˜ï¼Œä¹Ÿå¯ä»¥è§¦å‘ move äº‹ä»¶</span>
        <span class="hljs-keyword">if</span> (target) {
            target.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">'mousemove'</span>, { target, <span class="hljs-attr">event</span>: e });
        }

        <span class="hljs-comment">// 5. è®¾ç½®å…‰æ ‡æ ·å¼ (UX ä¼˜åŒ–)</span>
        <span class="hljs-keyword">if</span> (target) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'pointer'</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'default'</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_findHover</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Displayable</span> | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">const</span> list = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">getDisplayList</span>();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = list.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-keyword">const</span> el = list[i];
            <span class="hljs-keyword">if</span> (el.<span class="hljs-property">invisible</span>) <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">if</span> (el.<span class="hljs-title function_">contain</span>(x, y)) {
                <span class="hljs-keyword">return</span> el;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-2">2. éªŒè¯</h3>
<p>ç°åœ¨æˆ‘ä»¬æ¥å†™ä¸€ä¸ªå¤æ‚çš„ Demoã€‚æˆ‘ä»¬å°†åˆ›å»ºå¤šä¸ªçŸ©å½¢ï¼Œæ¯ä¸ªçŸ©å½¢éƒ½æœ‰ç‹¬ç«‹çš„æ‚¬åœå˜è‰²æ•ˆæœã€‚</p>
<p><strong>index.ts</strong>:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { init } <span class="hljs-keyword">from</span> <span class="hljs-string">'./core/MiniRender'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Rect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/shape/Rect'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Text</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/Text'</span>;

<span class="hljs-keyword">const</span> miniRender = <span class="hljs-title function_">init</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'main'</span>)!);

<span class="hljs-comment">// åˆ›å»º 5 ä¸ªå¡ç‰‡</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
    <span class="hljs-keyword">const</span> x = <span class="hljs-number">50</span> + i * <span class="hljs-number">110</span>;
    <span class="hljs-keyword">const</span> y = <span class="hljs-number">100</span>;

    <span class="hljs-comment">// --- åˆ›å»ºçŸ©å½¢ ---</span>
    <span class="hljs-keyword">const</span> rect = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rect</span>({
        <span class="hljs-attr">shape</span>: { <span class="hljs-attr">x</span>: x, <span class="hljs-attr">y</span>: y, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">r</span>: <span class="hljs-number">5</span> },
        <span class="hljs-attr">style</span>: {
            <span class="hljs-attr">fill</span>: <span class="hljs-string">'#FFF'</span>,
            <span class="hljs-attr">stroke</span>: <span class="hljs-string">'#999'</span>,
            <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">2</span>
        }
    });

    <span class="hljs-comment">// --- åˆ›å»ºæ–‡æœ¬ ---</span>
    <span class="hljs-keyword">const</span> text = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>({
        <span class="hljs-attr">style</span>: {
            <span class="hljs-attr">text</span>: <span class="hljs-string">`Card <span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>`</span>,
            <span class="hljs-attr">fill</span>: <span class="hljs-string">'#666'</span>,
            <span class="hljs-attr">fontSize</span>: <span class="hljs-number">14</span>,
            <span class="hljs-attr">textAlign</span>: <span class="hljs-string">'center'</span>,
            <span class="hljs-attr">textBaseline</span>: <span class="hljs-string">'middle'</span>
        },
        <span class="hljs-attr">position</span>: [x + <span class="hljs-number">50</span>, y + <span class="hljs-number">50</span>],
        <span class="hljs-attr">z</span>: <span class="hljs-number">1</span>,
    });

    <span class="hljs-comment">// --- ç»‘å®šäº¤äº’äº‹ä»¶ ---</span>
    
    <span class="hljs-comment">// 1. ç§»å…¥é«˜äº®</span>
    rect.<span class="hljs-title function_">on</span>(<span class="hljs-string">'mouseover'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Mouse Over Rect <span class="hljs-subst">${i}</span>`</span>);
        
        <span class="hljs-comment">// å˜è‰²</span>
        rect.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> = <span class="hljs-string">'#E6F7FF'</span>; <span class="hljs-comment">// æµ…è“èƒŒæ™¯</span>
        rect.<span class="hljs-property">style</span>.<span class="hljs-property">stroke</span> = <span class="hljs-string">'#1890FF'</span>; <span class="hljs-comment">// æ·±è“è¾¹æ¡†</span>
        
        <span class="hljs-comment">// æ”¾å¤§åŠ¨ç”»æ•ˆæœï¼ˆè¿™é‡Œæ‰‹åŠ¨æ”¹ scaleï¼‰</span>
        <span class="hljs-comment">// ç¨å¾®æ”¾å¤§ä¸€ç‚¹ï¼Œæ³¨æ„ scale æ˜¯ä»¥ origin ä¸ºä¸­å¿ƒçš„</span>
        <span class="hljs-comment">// æˆ‘ä»¬è¿˜æ²¡æœ‰å®ç°è‡ªåŠ¨è®¡ç®—ä¸­å¿ƒï¼Œæ‰€ä»¥è¿™é‡Œæ‰‹åŠ¨è®¾</span>
        rect.<span class="hljs-property">origin</span> = [x + <span class="hljs-number">50</span>, y + <span class="hljs-number">50</span>]; 
        rect.<span class="hljs-property">scale</span> = [<span class="hljs-number">1.1</span>, <span class="hljs-number">1.1</span>];

        miniRender.<span class="hljs-title function_">refresh</span>();
    });

    <span class="hljs-comment">// 2. ç§»å‡ºæ¢å¤</span>
    rect.<span class="hljs-title function_">on</span>(<span class="hljs-string">'mouseout'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Mouse Out Rect <span class="hljs-subst">${i}</span>`</span>);
        
        <span class="hljs-comment">// æ¢å¤é¢œè‰²</span>
        rect.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> = <span class="hljs-string">'#FFF'</span>;
        rect.<span class="hljs-property">style</span>.<span class="hljs-property">stroke</span> = <span class="hljs-string">'#999'</span>;
        
        <span class="hljs-comment">// æ¢å¤å¤§å°</span>
        rect.<span class="hljs-property">scale</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>];

        miniRender.<span class="hljs-title function_">refresh</span>();
    });

    miniRender.<span class="hljs-title function_">add</span>(rect);
    miniRender.<span class="hljs-title function_">add</span>(text);
}

<span class="hljs-comment">// ç®€å•çš„æç¤º</span>
<span class="hljs-keyword">const</span> tip = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>({
    <span class="hljs-attr">style</span>: {
        <span class="hljs-attr">text</span>: <span class="hljs-string">'Try Hovering on the cards!'</span>,
        <span class="hljs-attr">fill</span>: <span class="hljs-string">'#333'</span>,
        <span class="hljs-attr">fontSize</span>: <span class="hljs-number">18</span>,
    },
    <span class="hljs-attr">position</span>: [<span class="hljs-number">50</span>, <span class="hljs-number">30</span>]
});
miniRender.<span class="hljs-title function_">add</span>(tip);

<span class="hljs-comment">// æ¸²æŸ“</span>
miniRender.<span class="hljs-title function_">refresh</span>();
</code></pre>
<h3 data-id="heading-3">é¢„æœŸæ•ˆæœ</h3>
<ol>
<li><strong>å…‰æ ‡å˜åŒ–</strong>ï¼šå½“é¼ æ ‡ç§»åŠ¨åˆ°å¡ç‰‡ï¼ˆç™½è‰²çŸ©å½¢ï¼‰ä¸Šæ—¶ï¼Œé¼ æ ‡æŒ‡é’ˆä¼šå˜æˆæ‰‹å‹ã€‚</li>
<li><strong>é«˜äº®åé¦ˆ</strong>ï¼š
<ul>
<li>ç§»å…¥æ—¶ï¼šå¡ç‰‡å˜å¤§ï¼ˆ1.1å€ï¼‰ï¼ŒèƒŒæ™¯å˜æµ…è“ï¼Œè¾¹æ¡†å˜æ·±è“ã€‚</li>
<li>ç§»å‡ºæ—¶ï¼šå¡ç‰‡æ¢å¤åŸçŠ¶ã€‚</li>
</ul>
</li>
<li><strong>æ—¥å¿—</strong>ï¼šæ§åˆ¶å°ä¼šæ‰“å°å‡ºå¯¹åº”çš„ <code>Mouse Over</code> å’Œ <code>Mouse Out</code>ã€‚</li>
<li><strong>çŠ¶æ€åˆ‡æ¢</strong>ï¼šå¦‚æœä½ å¿«é€Ÿä»å¡ç‰‡ 1 ç§»åˆ°å¡ç‰‡ 2ï¼ˆä¸ç»è¿‡ç©ºç™½åŒºï¼‰ï¼Œä½ ä¼šå‘ç°å¡ç‰‡ 1 ç«‹åˆ»æ¢å¤ï¼Œå¡ç‰‡ 2 ç«‹åˆ»é«˜äº®ã€‚è¿™å°±æ˜¯ <code>target !== lastHovered</code> é€»è¾‘åœ¨èµ·ä½œç”¨ã€‚</li>
</ol>
<h3 data-id="heading-4">3.ç¼ºé™·</h3>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå¦‚æœé¼ æ ‡ç§»åˆ°äº†ä¸­é—´çš„æ–‡å­— <code>Card N</code> ä¸Šï¼š</p>
<ol>
<li>å› ä¸º Text ä¹Ÿæ˜¯ä¸ª Displayableï¼Œè€Œä¸”åœ¨ Rect ä¸Šé¢ (<code>z: 1</code>)ã€‚</li>
<li>Handler ä¼šè®¤ä¸º <code>target</code> å˜æˆäº† <code>Text</code>ã€‚</li>
<li>äºæ˜¯ <code>Rect</code> ä¼šè§¦å‘ <code>mouseout</code>ï¼ˆå˜å›ç™½è‰²ï¼‰ã€‚</li>
<li>å¦‚æœä½ æ²¡ç»™ <code>Text</code> ç»‘å®šäº‹ä»¶ï¼Œå®ƒå°±æ²¡æœ‰ååº”ã€‚</li>
</ol>
<p><strong>ç»“æœ</strong>ï¼šé¼ æ ‡åœ¨å¡ç‰‡è¾¹ç¼˜æ˜¯é«˜äº®çš„ï¼Œä¸€ç§»åˆ°æ–‡å­—ä¸Šï¼Œå¡ç‰‡å°±â€œç­â€äº†ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆæ€è·¯</strong>ï¼š
åœ¨ ZRender å’Œ ECharts ä¸­ï¼Œæœ‰ä¸€ä¸ªå±æ€§å« <code>silent</code> (é™é»˜)ã€‚
å¦‚æœ <code>el.silent = true</code>ï¼Œåˆ™ <code>Handler</code> åœ¨ <code>_findHover</code> éå†æ—¶ä¼šç›´æ¥è·³è¿‡å®ƒ (<code>continue</code>)ã€‚è¿™æ ·æ£€æµ‹åˆ°çš„ target å°±ä¼šæ˜¯åº•ä¸‹çš„ Rectã€‚</p>
<ol>
<li>ä¿®æ”¹ <code>src/graphic/Displayable.ts</code>ï¼š</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DisplayableProps</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ElementProps</span> {
    <span class="hljs-comment">// ...</span>
    silent?: <span class="hljs-built_in">boolean</span>; <span class="hljs-comment">// æ–°å¢ï¼šæ˜¯å¦å“åº”äº¤äº’</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Displayable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Element</span> {
    <span class="hljs-comment">// ...</span>
    <span class="hljs-attr">silent</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">opts?: DisplayableProps</span>) {
        <span class="hljs-variable language_">super</span>(opts);
        <span class="hljs-comment">// ...</span>
        <span class="hljs-keyword">if</span> (opts &amp;&amp; opts.<span class="hljs-property">silent</span> != <span class="hljs-literal">null</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">silent</span> = opts.<span class="hljs-property">silent</span>;
    }
}
</code></pre>
<ol start="2">
<li>ä¿®æ”¹ <code>src/handler/Handler.ts</code> çš„ <code>_findHover</code>ï¼š</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript">    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_findHover</span>(<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Displayable</span> | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">const</span> list = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">getDisplayList</span>();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = list.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-keyword">const</span> el = list[i];
            <span class="hljs-comment">// å¢åŠ  !el.silent åˆ¤æ–­</span>
            <span class="hljs-keyword">if</span> (el.<span class="hljs-property">invisible</span> || el.<span class="hljs-property">silent</span>) <span class="hljs-keyword">continue</span>; 
            <span class="hljs-keyword">if</span> (el.<span class="hljs-title function_">contain</span>(x, y)) {
                <span class="hljs-keyword">return</span> el;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
</code></pre>
<ol start="3">
<li>ä¿®æ”¹ <code>index.ts</code> ä¸­çš„ Text åˆ›å»ºï¼š</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript">    <span class="hljs-keyword">const</span> text = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>({
        <span class="hljs-comment">// ... æ ·å¼</span>
        <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// å…³é”®ï¼è®©æ–‡å­—ä¸é˜»æŒ¡é¼ æ ‡</span>
    });
</code></pre>
<p>ç°åœ¨ï¼Œé¼ æ ‡ç§»åˆ°æ–‡å­—ä¸Šæ—¶ï¼ŒHandler ä¼šå¿½ç•¥æ–‡å­—ï¼Œç›´æ¥æ£€æµ‹åˆ°ä¸‹é¢çš„ Rectï¼ŒHover æ•ˆæœå°±ä¸ä¼šä¸­æ–­äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf11cd4e11d04d0582415e9d25dd8055~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXJpc2Vz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334371&amp;x-signature=5Fo0ISRpLafdJTmZO7Mn1MmwNeY%3D" alt="hover.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š5.5.ç®€å•å›¾è¡¨demo]]></title>    <link>https://juejin.cn/post/7579175271679655946</link>    <guid>https://juejin.cn/post/7579175271679655946</guid>    <pubDate>2025-12-03T02:41:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579175271679655946" data-draft-id="7579111646875336755" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š5.5.ç®€å•å›¾è¡¨demo"/> <meta itemprop="keywords" content="å‰ç«¯,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2025-12-03T02:41:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="irises"/> <meta itemprop="url" content="https://juejin.cn/user/3030697436261735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š5.5.ç®€å•å›¾è¡¨demo
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030697436261735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    irises
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:41:47.000Z" title="Wed Dec 03 2025 02:41:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flz6060788%2FMini-Render" target="_blank" title="https://github.com/lz6060788/Mini-Render" ref="nofollow noopener noreferrer">MiniRenderä»“åº“åœ°å€å‚è€ƒ</a></p>
</blockquote>
<p>è¿™æ­£æ˜¯æ£€éªŒâ€œè½®å­â€æ˜¯å¦åœ†æ¶¦çš„æœ€ä½³æ—¶åˆ»ã€‚æˆ‘ä»¬å°†åˆ©ç”¨ç›®å‰ MiniRender å·²ç»å…·å¤‡çš„<strong>å›¾å½¢èƒ½åŠ›ï¼ˆRect, Textï¼‰</strong>ã€<strong>å±‚çº§ç®¡ç†ï¼ˆGroup, z-indexï¼‰</strong> å’Œ <strong>äº¤äº’èƒ½åŠ›ï¼ˆHover, Clickï¼‰</strong>ï¼Œæ„å»ºä¸€ä¸ªç»å…¸çš„<strong>æŸ±çŠ¶å›¾ï¼ˆBar Chartï¼‰</strong>ã€‚</p>
<p>è™½ç„¶æˆ‘ä»¬è¿˜æ²¡æœ‰ ECharts é‚£æ ·çš„é«˜çº§é…ç½®é¡¹ï¼Œä½†é€šè¿‡åŸç”Ÿç»˜å›¾æŒ‡ä»¤ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥â€œæ‰‹æ“â€ä¸€ä¸ªå‡ºæ¥ã€‚</p>
<p><strong>åŠŸèƒ½ç‚¹ï¼š</strong></p>
<ol>
<li><strong>åæ ‡è½´</strong>ï¼šç»˜åˆ¶ X è½´å’Œ Y è½´ï¼ˆä½¿ç”¨ç»†é•¿çš„ Rect æ¨¡æ‹Ÿçº¿æ¡ï¼‰ã€‚</li>
<li><strong>æ•°æ®å¯è§†åŒ–</strong>ï¼šæ ¹æ®æ•°æ®ç”ŸæˆæŸ±å­ã€‚</li>
<li><strong>äº¤äº’åé¦ˆ</strong>ï¼šé¼ æ ‡æ‚¬åœæ—¶ï¼ŒæŸ±å­é«˜äº®å˜è‰²ã€‚</li>
<li><strong>æ•°æ®æç¤º</strong>ï¼šæ‚¬åœæ—¶ï¼Œåœ¨æŸ±å­ä¸Šæ–¹æ˜¾ç¤ºå…·ä½“æ•°å€¼ï¼ˆç®€å•çš„ Tooltipï¼‰ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-0">ä»£ç å®ç° (<code>index.ts</code>)</h3>
<p>è¯·å°†ä»¥ä¸‹ä»£ç æ”¾å…¥ä½ çš„å…¥å£æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { init } <span class="hljs-keyword">from</span> <span class="hljs-string">'./core/MiniRender'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Group</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/Group'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Rect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/shape/Rect'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Text</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphic/Text'</span>;

<span class="hljs-comment">// 1. åˆå§‹åŒ–å¼•æ“</span>
<span class="hljs-keyword">const</span> dom = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'main'</span>)!;
<span class="hljs-keyword">const</span> miniRender = <span class="hljs-title function_">init</span>(dom);

<span class="hljs-comment">// --- é…ç½®æ•°æ® ---</span>
<span class="hljs-keyword">const</span> data = [<span class="hljs-number">120</span>, <span class="hljs-number">200</span>, <span class="hljs-number">150</span>, <span class="hljs-number">80</span>, <span class="hljs-number">70</span>, <span class="hljs-number">110</span>, <span class="hljs-number">130</span>];
<span class="hljs-keyword">const</span> categories = [<span class="hljs-string">'Mon'</span>, <span class="hljs-string">'Tue'</span>, <span class="hljs-string">'Wed'</span>, <span class="hljs-string">'Thu'</span>, <span class="hljs-string">'Fri'</span>, <span class="hljs-string">'Sat'</span>, <span class="hljs-string">'Sun'</span>];

<span class="hljs-comment">// --- å›¾è¡¨å¸ƒå±€é…ç½® ---</span>
<span class="hljs-keyword">const</span> chartConfig = {
    <span class="hljs-attr">x</span>: <span class="hljs-number">50</span>,          <span class="hljs-comment">// å›¾è¡¨å·¦è¾¹è·</span>
    <span class="hljs-attr">y</span>: <span class="hljs-number">50</span>,          <span class="hljs-comment">// å›¾è¡¨ä¸Šè¾¹è·</span>
    <span class="hljs-attr">width</span>: <span class="hljs-number">500</span>,     <span class="hljs-comment">// ç»˜å›¾åŒºå®½åº¦</span>
    <span class="hljs-attr">height</span>: <span class="hljs-number">300</span>,    <span class="hljs-comment">// ç»˜å›¾åŒºé«˜åº¦</span>
    <span class="hljs-attr">barWidth</span>: <span class="hljs-number">30</span>,   <span class="hljs-comment">// æŸ±å­å®½åº¦</span>
    <span class="hljs-attr">barColor</span>: <span class="hljs-string">'#5470C6'</span>, <span class="hljs-comment">// é»˜è®¤é¢œè‰²</span>
    <span class="hljs-attr">hoverColor</span>: <span class="hljs-string">'#91CC75'</span> <span class="hljs-comment">// é«˜äº®é¢œè‰²</span>
};

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç»„æ¥å®¹çº³æ•´ä¸ªå›¾è¡¨ï¼Œæ–¹ä¾¿æ•´ä½“ç§»åŠ¨</span>
<span class="hljs-keyword">const</span> chartGroup = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Group</span>({
    <span class="hljs-attr">position</span>: [chartConfig.<span class="hljs-property">x</span>, chartConfig.<span class="hljs-property">y</span>]
});

<span class="hljs-comment">// --- ç¬¬ä¸€æ­¥ï¼šç»˜åˆ¶åæ ‡è½´ (ä½¿ç”¨ Rect æ¨¡æ‹Ÿçº¿) ---</span>

<span class="hljs-comment">// Yè½´ (å·¦ä¾§ç«–çº¿)</span>
<span class="hljs-keyword">const</span> yAxis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rect</span>({
    <span class="hljs-attr">shape</span>: {
        <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, 
        <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>, 
        <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, 
        <span class="hljs-attr">height</span>: chartConfig.<span class="hljs-property">height</span>
    },
    <span class="hljs-attr">style</span>: { <span class="hljs-attr">fill</span>: <span class="hljs-string">'#333'</span> }
});

<span class="hljs-comment">// Xè½´ (åº•éƒ¨æ¨ªçº¿)</span>
<span class="hljs-keyword">const</span> xAxis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rect</span>({
    <span class="hljs-attr">shape</span>: {
        <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, 
        <span class="hljs-attr">y</span>: chartConfig.<span class="hljs-property">height</span>, 
        <span class="hljs-attr">width</span>: chartConfig.<span class="hljs-property">width</span>, 
        <span class="hljs-attr">height</span>: <span class="hljs-number">1</span>
    },
    <span class="hljs-attr">style</span>: { <span class="hljs-attr">fill</span>: <span class="hljs-string">'#333'</span> }
});

chartGroup.<span class="hljs-title function_">add</span>(yAxis);
chartGroup.<span class="hljs-title function_">add</span>(xAxis);

<span class="hljs-comment">// --- ç¬¬äºŒæ­¥ï¼šå‡†å¤‡ Tooltip (æµ®åŠ¨æç¤ºæ–‡å­—) ---</span>
<span class="hljs-comment">// æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå…±äº«çš„ Text å¯¹è±¡ï¼Œé»˜è®¤éšè—ï¼Œæ‚¬åœæ—¶ç§»åŠ¨ä½ç½®å¹¶æ˜¾ç¤º</span>
<span class="hljs-keyword">const</span> tooltip = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>({
    <span class="hljs-attr">style</span>: {
        <span class="hljs-attr">text</span>: <span class="hljs-string">''</span>,
        <span class="hljs-attr">fill</span>: <span class="hljs-string">'#000'</span>,
        <span class="hljs-attr">fontSize</span>: <span class="hljs-number">14</span>,
        <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">'bold'</span>,
        <span class="hljs-attr">textAlign</span>: <span class="hljs-string">'center'</span>,
        <span class="hljs-attr">textBaseline</span>: <span class="hljs-string">'bottom'</span>
    },
    <span class="hljs-attr">z</span>: <span class="hljs-number">10</span>,       <span class="hljs-comment">// ä¿è¯åœ¨æœ€ä¸Šå±‚</span>
    <span class="hljs-attr">invisible</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// åˆå§‹éšè—</span>
    <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// å…³é”®ï¼šè®© Tooltip ä¸é˜»æŒ¡é¼ æ ‡ï¼Œé˜²æ­¢é—ªçƒ</span>
});
<span class="hljs-comment">// Tooltip ä¸åŠ åˆ° chartGroupï¼Œè€Œæ˜¯ç›´æ¥åŠ åˆ° miniRenderï¼Œé˜²æ­¢å— group å˜æ¢å½±å“ï¼ˆè™½ç„¶è¿™é‡Œ chartGroup æ²¡æ—‹è½¬ï¼‰</span>
<span class="hljs-comment">// ä½†ä¸ºäº†åæ ‡æ–¹ä¾¿ï¼ŒåŠ åˆ° chartGroup é‡Œæ›´å®¹æ˜“è®¡ç®—ç›¸å¯¹åæ ‡</span>
chartGroup.<span class="hljs-title function_">add</span>(tooltip);


<span class="hljs-comment">// --- ç¬¬ä¸‰æ­¥ï¼šç»˜åˆ¶æŸ±å­ä¸æ ‡ç­¾ ---</span>

<span class="hljs-comment">// è®¡ç®—æ¯ä¸ªæŸ±å­çš„é—´éš”</span>
<span class="hljs-keyword">const</span> step = chartConfig.<span class="hljs-property">width</span> / data.<span class="hljs-property">length</span>;
<span class="hljs-keyword">const</span> maxVal = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(...data);

data.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {
    <span class="hljs-comment">// 1. æ•°æ®æ˜ å°„è®¡ç®—</span>
    <span class="hljs-comment">// é«˜åº¦æ¯”ä¾‹ï¼švalue / maxVal</span>
    <span class="hljs-keyword">const</span> barHeight = (value / maxVal) * (chartConfig.<span class="hljs-property">height</span> - <span class="hljs-number">40</span>); <span class="hljs-comment">// ç•™40pxé¡¶éƒ¨ä½™é‡</span>
    
    <span class="hljs-comment">// æŸ±å­å·¦ä¸Šè§’åæ ‡ (ç›¸å¯¹äº chartGroup)</span>
    <span class="hljs-comment">// x = é—´éš” * ç´¢å¼• + å±…ä¸­åç§»</span>
    <span class="hljs-keyword">const</span> x = index * step + (step - chartConfig.<span class="hljs-property">barWidth</span>) / <span class="hljs-number">2</span>;
    <span class="hljs-comment">// y = åº•éƒ¨Y - æŸ±å­é«˜åº¦</span>
    <span class="hljs-keyword">const</span> y = chartConfig.<span class="hljs-property">height</span> - barHeight;

    <span class="hljs-comment">// 2. åˆ›å»ºæŸ±å­</span>
    <span class="hljs-keyword">const</span> bar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rect</span>({
        <span class="hljs-attr">shape</span>: {
            <span class="hljs-attr">x</span>: x,
            <span class="hljs-attr">y</span>: y,
            <span class="hljs-attr">width</span>: chartConfig.<span class="hljs-property">barWidth</span>,
            <span class="hljs-attr">height</span>: barHeight
        },
        <span class="hljs-attr">style</span>: {
            <span class="hljs-attr">fill</span>: chartConfig.<span class="hljs-property">barColor</span>
        }
    });

    <span class="hljs-comment">// 3. åˆ›å»º X è½´åˆ†ç±»æ–‡æœ¬</span>
    <span class="hljs-keyword">const</span> label = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>({
        <span class="hljs-attr">style</span>: {
            <span class="hljs-attr">text</span>: categories[index],
            <span class="hljs-attr">fill</span>: <span class="hljs-string">'#666'</span>,
            <span class="hljs-attr">fontSize</span>: <span class="hljs-number">12</span>,
            <span class="hljs-attr">textAlign</span>: <span class="hljs-string">'center'</span>,
            <span class="hljs-attr">textBaseline</span>: <span class="hljs-string">'top'</span>
        },
        <span class="hljs-attr">position</span>: [x + chartConfig.<span class="hljs-property">barWidth</span> / <span class="hljs-number">2</span>, chartConfig.<span class="hljs-property">height</span> + <span class="hljs-number">10</span>],
        <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// æ–‡æœ¬ä¸å“åº”äº¤äº’</span>
    });

    <span class="hljs-comment">// 4. ç»‘å®šäº¤äº’äº‹ä»¶</span>
    bar.<span class="hljs-title function_">on</span>(<span class="hljs-string">'mouseover'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// æŸ±å­å˜è‰²</span>
        bar.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> = chartConfig.<span class="hljs-property">hoverColor</span>;
        
        <span class="hljs-comment">// æ˜¾ç¤º Tooltip</span>
        tooltip.<span class="hljs-property">invisible</span> = <span class="hljs-literal">false</span>;
        tooltip.<span class="hljs-property">style</span>.<span class="hljs-property">text</span> = <span class="hljs-string">`<span class="hljs-subst">${value}</span>`</span>; <span class="hljs-comment">// è®¾ç½®æ•°å€¼</span>
        <span class="hljs-comment">// ç§»åŠ¨ Tooltip åˆ°æŸ±å­é¡¶éƒ¨ä¸­é—´</span>
        tooltip.<span class="hljs-property">x</span> = x + chartConfig.<span class="hljs-property">barWidth</span> / <span class="hljs-number">2</span>;
        tooltip.<span class="hljs-property">y</span> = y - <span class="hljs-number">5</span>; <span class="hljs-comment">// å¾€ä¸Šé£˜ä¸€ç‚¹</span>

        miniRender.<span class="hljs-title function_">refresh</span>();
    });

    bar.<span class="hljs-title function_">on</span>(<span class="hljs-string">'mouseout'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// é¢œè‰²å¤åŸ</span>
        bar.<span class="hljs-property">style</span>.<span class="hljs-property">fill</span> = chartConfig.<span class="hljs-property">barColor</span>;
        
        <span class="hljs-comment">// éšè— Tooltip</span>
        tooltip.<span class="hljs-property">invisible</span> = <span class="hljs-literal">true</span>;

        miniRender.<span class="hljs-title function_">refresh</span>();
    });

    chartGroup.<span class="hljs-title function_">add</span>(bar);
    chartGroup.<span class="hljs-title function_">add</span>(label);
});

<span class="hljs-comment">// å°†æ•´ä¸ªå›¾è¡¨ç»„æ·»åŠ åˆ°å¼•æ“</span>
miniRender.<span class="hljs-title function_">add</span>(chartGroup);

<span class="hljs-comment">// æ¸²æŸ“ç¬¬ä¸€å¸§</span>
miniRender.<span class="hljs-title function_">refresh</span>();
</code></pre>
<hr/>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed708e648ec8477d84e602f6678faf63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXJpc2Vz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334506&amp;x-signature=p%2B3ljvjb%2Fcu3Iryac2MHBXnIeZE%3D" alt="chart.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¯å¤©ä¸€é“é¢è¯•é¢˜ä¹‹æ¶æ„ç¯‡|æ•°æ®ä¸€è‡´æ€§ä¸é«˜æ€§èƒ½çš„ç»ˆæçŸ›ç›¾ä¸æ¶æ„æƒè¡¡]]></title>    <link>https://juejin.cn/post/7579094978682945582</link>    <guid>https://juejin.cn/post/7579094978682945582</guid>    <pubDate>2025-12-03T02:43:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579094978682945582" data-draft-id="7579094978682929198" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¯å¤©ä¸€é“é¢è¯•é¢˜ä¹‹æ¶æ„ç¯‡|æ•°æ®ä¸€è‡´æ€§ä¸é«˜æ€§èƒ½çš„ç»ˆæçŸ›ç›¾ä¸æ¶æ„æƒè¡¡"/> <meta itemprop="keywords" content="é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-03T02:43:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å°èƒ–"/> <meta itemprop="url" content="https://juejin.cn/user/1992752269369870"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¯å¤©ä¸€é“é¢è¯•é¢˜ä¹‹æ¶æ„ç¯‡|æ•°æ®ä¸€è‡´æ€§ä¸é«˜æ€§èƒ½çš„ç»ˆæçŸ›ç›¾ä¸æ¶æ„æƒè¡¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1992752269369870/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å°èƒ–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:43:27.000Z" title="Wed Dec 03 2025 02:43:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>é¢è¯•å®˜</strong>ï¼š"ä¸ºä»€ä¹ˆåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ•°æ®ä¸€è‡´æ€§å’Œé«˜æ€§èƒ½å¾€å¾€ä¸å¯å…¼å¾—ï¼Ÿè¯·ä»è®¡ç®—æœºç§‘å­¦åŸç†å’Œå®é™…æ¶æ„è§’åº¦åˆ†æè¿™ä¸ªçŸ›ç›¾ã€‚"</p>
</blockquote>
<p>è¿™æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡çš„ç»å…¸æ‚–è®ºï¼šä½ æ— æ³•åŒæ—¶è·å¾—å¼ºä¸€è‡´æ€§ã€é«˜å¯ç”¨æ€§å’Œé«˜æ€§èƒ½ã€‚ç†è§£è¿™ä¸ªçŸ›ç›¾æ˜¯æ¶æ„å¸ˆæˆé•¿çš„å¿…ç»ä¹‹è·¯ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€çŸ›ç›¾æ ¹æºï¼šCAPå®šç†ä¸ç‰©ç†é™åˆ¶</h2>
<p><strong>CAPå®šç†çš„æ·±åº¦è§£è¯»</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">Cï¼ˆä¸€è‡´æ€§ï¼‰ï¼šæ‰€æœ‰èŠ‚ç‚¹çœ‹åˆ°çš„æ•°æ®ç›¸åŒ
<span class="hljs-selector-tag">A</span>ï¼ˆå¯ç”¨æ€§ï¼‰ï¼šæ¯ä¸ªè¯·æ±‚éƒ½èƒ½è·å¾—å“åº”
<span class="hljs-selector-tag">P</span>ï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰ï¼šç½‘ç»œåˆ†åŒºæ—¶ç³»ç»Ÿä»èƒ½å·¥ä½œ

å®šç†è¯æ˜ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³ä¸¤ä¸ªç‰¹æ€§
</code></pre>
<p><strong>ç‰©ç†ä¸–ç•Œçš„æ— æƒ…é™åˆ¶</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â å…‰é€Ÿå»¶è¿Ÿï¼šæ— æ³•é€¾è¶Šçš„ç‰©ç†å±éšœ</span>
<span class="hljs-type">double</span>Â distanceÂ =Â <span class="hljs-number">1000</span>;Â <span class="hljs-comment">//Â èŠ‚ç‚¹é—´è·ç¦»1å…¬é‡Œ</span>
<span class="hljs-type">double</span>Â speedOfLightÂ =Â <span class="hljs-number">300000</span>;Â <span class="hljs-comment">//Â å…‰é€Ÿ300,000Â km/s</span>
<span class="hljs-type">double</span>Â minimumLatencyÂ =Â distanceÂ /Â speedOfLight;Â <span class="hljs-comment">//Â è‡³å°‘3.33å¾®ç§’</span>

<span class="hljs-comment">//Â ç½‘ç»œä¼ è¾“çš„å®é™…å»¶è¿Ÿè¿œå¤§äºç†è®ºå€¼</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">NetworkLatency</span>Â {
Â Â Â Â <span class="hljs-comment">//Â åŒæœºæˆ¿ï¼š0.1-1ms</span>
Â Â Â Â <span class="hljs-comment">//Â è·¨æœºæˆ¿ï¼š1-10msÂ Â </span>
Â Â Â Â <span class="hljs-comment">//Â è·¨åœ°åŸŸï¼š50-200ms</span>
Â Â Â Â <span class="hljs-comment">//Â è·¨å›½ï¼š200-500ms</span>
}
</code></pre>
<h2 data-id="heading-1">äºŒã€ä¸€è‡´æ€§çº§åˆ«ä¸æ€§èƒ½ä»£ä»·</h2>
<p><strong>å¼ºä¸€è‡´æ€§ï¼ˆçº¿æ€§åŒ–ï¼‰çš„æ€§èƒ½ä»£ä»·</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
Â *Â å¼ºä¸€è‡´æ€§å®ç°çš„æ€§èƒ½ç“¶é¢ˆç¤ºä¾‹
Â *Â éœ€è¦å…¨å±€é”æˆ–å…±è¯†ç®—æ³•
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">StrongConsistencyService</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â DistributedLockÂ lock;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â DatabaseÂ database;
Â Â Â Â 
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">updateWithStrongConsistency</span><span class="hljs-params">(<span class="hljs-type">String</span>Â key,Â <span class="hljs-type">String</span>Â value)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-type">long</span>Â startTimeÂ =Â System.<span class="hljs-built_in">currentTimeMillis</span>();
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â è·å–åˆ†å¸ƒå¼é”ï¼ˆç½‘ç»œå¾€è¿”ï¼‰</span>
Â Â Â Â Â Â Â Â lock.<span class="hljs-built_in">lock</span>(key);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â è¯»å–å½“å‰å€¼ï¼ˆå¯èƒ½æ¶‰åŠå¤šèŠ‚ç‚¹åŒæ­¥ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">String</span>Â currentÂ =Â database.<span class="hljs-built_in">read</span>(key);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 3.Â å†™å…¥æ–°å€¼ï¼ˆéœ€è¦åŒæ­¥å¤åˆ¶åˆ°æ‰€æœ‰å‰¯æœ¬ï¼‰</span>
Â Â Â Â Â Â Â Â database.<span class="hljs-built_in">write</span>(key,Â value);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 4.Â ç­‰å¾…å¤šæ•°èŠ‚ç‚¹ç¡®è®¤</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">waitForQuorum</span>();
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 5.Â é‡Šæ”¾é”</span>
Â Â Â Â Â Â Â Â lock.<span class="hljs-built_in">unlock</span>(key);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-type">long</span>Â costÂ =Â System.<span class="hljs-built_in">currentTimeMillis</span>()Â -Â startTime;
Â Â Â Â Â Â Â Â log.<span class="hljs-built_in">info</span>(<span class="hljs-string">"å¼ºä¸€è‡´æ€§æ“ä½œè€—æ—¶:Â {}ms"</span>,Â cost);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…¸å‹è€—æ—¶:Â 10-100ms</span>
Â Â Â Â }
}
</code></pre>
<p><strong>æœ€ç»ˆä¸€è‡´æ€§çš„æ€§èƒ½ä¼˜åŠ¿</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
Â *Â æœ€ç»ˆä¸€è‡´æ€§å®ç°
Â *Â æ€§èƒ½æ›´é«˜ä½†å­˜åœ¨æ•°æ®å»¶è¿Ÿ
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">EventualConsistencyService</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â LocalCacheÂ cache;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â MessageQueueÂ queue;
Â Â Â Â 
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">updateWithEventualConsistency</span><span class="hljs-params">(<span class="hljs-type">String</span>Â key,Â <span class="hljs-type">String</span>Â value)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-type">long</span>Â startTimeÂ =Â System.<span class="hljs-built_in">currentTimeMillis</span>();
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â æœ¬åœ°ç«‹å³æ›´æ–°ï¼ˆæ— é”ï¼‰</span>
Â Â Â Â Â Â Â Â cache.<span class="hljs-built_in">put</span>(key,Â value);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â å¼‚æ­¥ä¼ æ’­å˜æ›´</span>
Â Â Â Â Â Â Â Â queue.<span class="hljs-built_in">sendAsync</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-built_in">UpdateEvent</span>(key,Â value));
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-type">long</span>Â costÂ =Â System.<span class="hljs-built_in">currentTimeMillis</span>()Â -Â startTime;
Â Â Â Â Â Â Â Â log.<span class="hljs-built_in">info</span>(<span class="hljs-string">"æœ€ç»ˆä¸€è‡´æ€§æ“ä½œè€—æ—¶:Â {}ms"</span>,Â cost);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…¸å‹è€—æ—¶:Â 0.1-1ms</span>
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€æ¶æ„å±‚é¢çš„æƒè¡¡ç­–ç•¥</h2>
<p><strong>è¯»å†™åˆ†ç¦»æ¶æ„</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
Â *Â è¯»å†™åˆ†ç¦»å®ç°
Â *Â å†™ä¸»åº“ï¼ˆå¼ºä¸€è‡´æ€§ï¼‰ï¼Œè¯»ä»åº“ï¼ˆå¼±ä¸€è‡´æ€§ï¼‰
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">ReadWriteSplittingService</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â finalÂ <span class="hljs-title class_">MasterDatabase</span>Â master;
Â Â Â Â <span class="hljs-keyword">private</span>Â finalÂ <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">SlaveDatabase</span>&gt;Â slaves;
Â Â Â Â 
Â Â Â Â <span class="hljs-meta">@WriteOperation</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">writeData</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â data</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å†™ä¸»åº“ï¼ˆå¼ºä¸€è‡´æ€§ï¼‰</span>
Â Â Â Â Â Â Â Â master.<span class="hljs-title function_">write</span>(data);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è€—æ—¶:Â 5-10ms</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-meta">@ReadOperation</span>Â Â 
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">String</span>Â <span class="hljs-title function_">readData</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è¯»ä»åº“ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â slaves.<span class="hljs-title function_">get</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">read</span>();
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è€—æ—¶:Â 1-2ms</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-meta">@ConsistentReadOperation</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">String</span>Â <span class="hljs-title function_">readConsistentData</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â éœ€è¦å¼ºä¸€è‡´æ€§æ—¶è¯»ä¸»åº“</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â master.<span class="hljs-title function_">read</span>();
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è€—æ—¶:Â 5-10ms</span>
Â Â Â Â }
}
</code></pre>
<p><strong>å¤šçº§ç¼“å­˜æ¶æ„</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
Â *Â å¤šçº§ç¼“å­˜ä¸€è‡´æ€§æŒ‘æˆ˜
Â *Â æœ¬åœ°ç¼“å­˜Â vsÂ åˆ†å¸ƒå¼ç¼“å­˜Â vsÂ æ•°æ®åº“
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">MultiLevelCacheService</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â Map&lt;<span class="hljs-type">String</span>,Â <span class="hljs-type">String</span>&gt;Â localCacheÂ =Â <span class="hljs-keyword">new</span>Â ConcurrentHashMap&lt;&gt;();
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â RedisCacheÂ distributedCache;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â DatabaseÂ database;
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ€§èƒ½ä¼˜åŒ–ä½†å­˜åœ¨ä¸€è‡´æ€§é—®é¢˜</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">String</span>Â <span class="hljs-title">getWithCaching</span><span class="hljs-params">(<span class="hljs-type">String</span>Â key)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â æ£€æŸ¥æœ¬åœ°ç¼“å­˜ï¼ˆæœ€å¿«ï¼Œä½†å¯èƒ½è¿‡æœŸï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">String</span>Â localValueÂ =Â localCache.<span class="hljs-built_in">get</span>(key);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (localValueÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â localValue;Â <span class="hljs-comment">//Â 0.01ms</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â æ£€æŸ¥åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆè¾ƒå¿«ï¼Œè¾ƒæ–°ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">String</span>Â distributedValueÂ =Â distributedCache.<span class="hljs-built_in">get</span>(key);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (distributedValueÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â localCache.<span class="hljs-built_in">put</span>(key,Â distributedValue);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â distributedValue;Â <span class="hljs-comment">//Â 1-2ms</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 3.Â æŸ¥è¯¢æ•°æ®åº“ï¼ˆæœ€æ…¢ï¼Œæœ€æ–°ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">String</span>Â dbValueÂ =Â database.<span class="hljs-built_in">read</span>(key);
Â Â Â Â Â Â Â Â distributedCache.<span class="hljs-built_in">set</span>(key,Â dbValue);
Â Â Â Â Â Â Â Â localCache.<span class="hljs-built_in">put</span>(key,Â dbValue);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â dbValue;Â <span class="hljs-comment">//Â 5-10ms</span>
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-3">å››ã€åˆ†å¸ƒå¼å…±è¯†ç®—æ³•çš„æ€§èƒ½ç“¶é¢ˆ</h2>
<p><strong>Paxos/Raftçš„æ€§èƒ½åˆ†æ</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
Â *Â Raftå…±è¯†ç®—æ³•æ€§èƒ½æ¨¡æ‹Ÿ
Â *Â éœ€è¦å¤šæ•°èŠ‚ç‚¹ç¡®è®¤æ‰èƒ½æäº¤
Â */</span>
publicÂ classÂ RaftConsensusServiceÂ {
Â Â Â Â privateÂ finalÂ List&lt;Node&gt;Â nodes;
Â Â Â Â privateÂ finalÂ intÂ quorum;
Â Â Â Â 
Â Â Â Â publicÂ voidÂ <span class="hljs-built_in">propose</span>(StringÂ value)Â {
Â Â Â Â Â Â Â Â longÂ startÂ =Â System<span class="hljs-selector-class">.currentTimeMillis</span>();
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â å‡†å¤‡é˜¶æ®µï¼ˆç½‘ç»œå¾€è¿”ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">preparePhase</span>();
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â æ¥å—é˜¶æ®µï¼ˆç½‘ç»œå¾€è¿”ï¼‰Â </span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">acceptPhase</span>();
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 3.Â æäº¤é˜¶æ®µï¼ˆç½‘ç»œå¾€è¿”ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">commitPhase</span>();
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â longÂ latencyÂ =Â System<span class="hljs-selector-class">.currentTimeMillis</span>()Â -Â start;
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("Raftå…±è¯†è€—æ—¶:Â {}ms",Â latency);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…¸å‹å€¼:Â 3Â *Â ç½‘ç»œå»¶è¿ŸÂ +Â å¤„ç†æ—¶é—´</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">preparePhase</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å‘æ‰€æœ‰èŠ‚ç‚¹å‘é€Prepareè¯·æ±‚</span>
Â Â Â Â Â Â Â Â List&lt;CompletableFuture&lt;Response&gt;&gt;Â futuresÂ =Â nodes<span class="hljs-selector-class">.stream</span>()
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.map</span>(nodeÂ -&gt;Â node.sendPrepareAsync())
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.collect</span>(Collectors.toList());
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç­‰å¾…å¤šæ•°èŠ‚ç‚¹å“åº”</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">waitForQuorum</span>(futures);
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-4">äº”ã€å®é™…ä¸šåŠ¡åœºæ™¯çš„æƒè¡¡æ¡ˆä¾‹</h2>
<p><strong>ç”µå•†åº“å­˜ç³»ç»Ÿçš„ä¸€è‡´æ€§æƒè¡¡</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
Â *Â åº“å­˜æ‰£å‡çš„ä¸¤ç§ç­–ç•¥
Â *Â æ–¹æ¡ˆAï¼šå¼ºä¸€è‡´æ€§ï¼ˆé¿å…è¶…å–ï¼‰
Â *Â æ–¹æ¡ˆBï¼šæœ€ç»ˆä¸€è‡´æ€§ï¼ˆæ›´é«˜æ€§èƒ½ï¼‰
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">InventoryService</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â StockDAOÂ stockDAO;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â MessageQueueÂ mq;
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆAï¼šå¼ºä¸€è‡´æ€§æ‰£å‡</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">boolean</span>Â <span class="hljs-title">deductStockWithConsistency</span><span class="hljs-params">(LongÂ itemId,Â IntegerÂ quantity)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ•°æ®åº“è¡Œé”ä¿è¯å¼ºä¸€è‡´æ€§</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">int</span>Â affectedÂ =Â stockDAO.<span class="hljs-built_in">deductWithLock</span>(itemId,Â quantity);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â affectedÂ &gt;Â <span class="hljs-number">0</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ä¼˜ç‚¹ï¼šç»ä¸è¶…å–</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç¼ºç‚¹ï¼šæ€§èƒ½ç“¶é¢ˆï¼ŒTPSçº¦100-1000</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆBï¼šæœ€ç»ˆä¸€è‡´æ€§æ‰£å‡Â Â </span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">boolean</span>Â <span class="hljs-title">deductStockWithPerformance</span><span class="hljs-params">(LongÂ itemId,Â IntegerÂ quantity)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â å†…å­˜è®¡æ•°ï¼ˆé«˜æ€§èƒ½ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">boolean</span>Â successÂ =Â memoryCounter.<span class="hljs-built_in">deduct</span>(itemId,Â quantity);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â å¼‚æ­¥æŒä¹…åŒ–</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (success)Â {
Â Â Â Â Â Â Â Â Â Â Â Â mq.<span class="hljs-built_in">sendAsync</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-built_in">DeductEvent</span>(itemId,Â quantity));
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â success;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ä¼˜ç‚¹ï¼šé«˜æ€§èƒ½ï¼ŒTPSå¯è¾¾10,000+</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç¼ºç‚¹ï¼šå¯èƒ½çŸ­æš‚è¶…å–ï¼Œéœ€è¦é¢å¤–è¡¥å¿</span>
Â Â Â Â }
}
</code></pre>
<p><strong>æ”¯ä»˜ç³»ç»Ÿçš„ä¸€è‡´æ€§è¦æ±‚</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
Â *Â æ”¯ä»˜äº¤æ˜“å¿…é¡»å¼ºä¸€è‡´æ€§
Â *Â æ€§èƒ½å¯ä»¥é€šè¿‡æ¶æ„ä¼˜åŒ–
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">PaymentService</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â TransactionManagerÂ txManager;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â AccountServiceÂ accountService;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â LedgerServiceÂ ledgerService;
Â Â Â Â 
Â Â Â Â @<span class="hljs-function">Transactional
Â Â Â Â <span class="hljs-keyword">public</span>Â PaymentResultÂ <span class="hljs-title">processPayment</span><span class="hljs-params">(PaymentRequestÂ request)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â æ‰£å‡ä»˜æ¬¾æ–¹ä½™é¢ï¼ˆå¼ºä¸€è‡´æ€§ï¼‰</span>
Â Â Â Â Â Â Â Â accountService.<span class="hljs-built_in">deduct</span>(request.<span class="hljs-built_in">getPayerId</span>(),Â request.<span class="hljs-built_in">getAmount</span>());
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â å¢åŠ æ”¶æ¬¾æ–¹ä½™é¢ï¼ˆå¼ºä¸€è‡´æ€§ï¼‰</span>
Â Â Â Â Â Â Â Â accountService.<span class="hljs-built_in">add</span>(request.<span class="hljs-built_in">getPayeeId</span>(),Â request.<span class="hljs-built_in">getAmount</span>());
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 3.Â è®°å½•äº¤æ˜“æµæ°´ï¼ˆå¼ºä¸€è‡´æ€§ï¼‰</span>
Â Â Â Â Â Â Â Â ledgerService.<span class="hljs-built_in">recordTransaction</span>(request);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ•´ä½“è€—æ—¶:Â 20-100ms</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¿…é¡»ä¿è¯ACIDï¼Œæ€§èƒ½æ¬¡è¦</span>
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-5">å…­ã€æ€§èƒ½ä¼˜åŒ–ä¸ä¸€è‡´æ€§ä¿éšœçš„å¹³è¡¡ç­–ç•¥</h2>
<p><strong>åˆ†å±‚ä¸€è‡´æ€§æ¶æ„</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
Â *Â æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©ä¸€è‡´æ€§çº§åˆ«
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">TieredConsistencyService</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â finalÂ <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">ConsistencyLevel</span>,Â <span class="hljs-title class_">ConsistencyStrategy</span>&gt;Â strategies;
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">Object</span>Â <span class="hljs-title function_">readData</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â key,Â ConsistencyLevelÂ level</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â strategies.<span class="hljs-title function_">get</span>(level).<span class="hljs-title function_">read</span>(key);
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">enum</span>Â <span class="hljs-title class_">ConsistencyLevel</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable constant_">STRONG</span>,Â Â Â Â Â Â <span class="hljs-comment">//Â å¼ºä¸€è‡´æ€§ï¼Œæ€§èƒ½æœ€ä½</span>
Â Â Â Â Â Â Â Â <span class="hljs-variable constant_">TIMELINE</span>,Â Â Â Â <span class="hljs-comment">//Â æ—¶é—´çº¿ä¸€è‡´æ€§</span>
Â Â Â Â Â Â Â Â <span class="hljs-variable constant_">EVENTUAL</span>,Â Â Â Â <span class="hljs-comment">//Â æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ€§èƒ½æœ€é«˜</span>
Â Â Â Â Â Â Â Â <span class="hljs-variable constant_">CUSTOM</span>Â Â Â Â Â Â Â <span class="hljs-comment">//Â è‡ªå®šä¹‰ä¸€è‡´æ€§çº§åˆ«</span>
Â Â Â Â }
}
</code></pre>
<p><strong>å¼‚æ­¥å¤åˆ¶ä¸åŒæ­¥å¤åˆ¶çš„æƒè¡¡</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
Â *Â æ•°æ®åº“å¤åˆ¶ç­–ç•¥é€‰æ‹©
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">ReplicationStrategy</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â DatabaseÂ master;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â List&lt;Database&gt;Â replicas;
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â åŒæ­¥å¤åˆ¶ï¼šå¼ºä¸€è‡´æ€§ï¼Œä½æ€§èƒ½</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">syncReplicate</span><span class="hljs-params">(<span class="hljs-type">String</span>Â data)</span>Â </span>{
Â Â Â Â Â Â Â Â master.<span class="hljs-built_in">write</span>(data);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (DatabaseÂ replicaÂ :Â replicas)Â {
Â Â Â Â Â Â Â Â Â Â Â Â replica.<span class="hljs-built_in">write</span>(data);Â <span class="hljs-comment">//Â ç­‰å¾…æ¯ä¸ªå‰¯æœ¬ç¡®è®¤</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è€—æ—¶:Â ç½‘ç»œå»¶è¿ŸÂ *Â å‰¯æœ¬æ•°</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â å¼‚æ­¥å¤åˆ¶ï¼šæœ€ç»ˆä¸€è‡´æ€§ï¼Œé«˜æ€§èƒ½</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">asyncReplicate</span><span class="hljs-params">(<span class="hljs-type">String</span>Â data)</span>Â </span>{
Â Â Â Â Â Â Â Â master.<span class="hljs-built_in">write</span>(data);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (DatabaseÂ replicaÂ :Â replicas)Â {
Â Â Â Â Â Â Â Â Â Â Â Â executor.<span class="hljs-built_in">submit</span>(()Â -&gt;Â replica.<span class="hljs-built_in">write</span>(data));
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è€—æ—¶:Â åªå–å†³äºä¸»åº“</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â åŠåŒæ­¥å¤åˆ¶ï¼šå¹³è¡¡æ–¹æ¡ˆ</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">semiSyncReplicate</span><span class="hljs-params">(<span class="hljs-type">String</span>Â data)</span>Â </span>{
Â Â Â Â Â Â Â Â master.<span class="hljs-built_in">write</span>(data);
Â Â Â Â Â Â Â Â CountDownLatchÂ latchÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-built_in">CountDownLatch</span>(quorumSize);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-type">int</span>Â iÂ =Â <span class="hljs-number">0</span>;Â iÂ &lt;Â quorumSize;Â i++)Â {
Â Â Â Â Â Â Â Â Â Â Â Â replicas.<span class="hljs-built_in">get</span>(i).<span class="hljs-built_in">writeAsync</span>(data,Â latch::countDown);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â latch.<span class="hljs-built_in">await</span>();Â <span class="hljs-comment">//Â ç­‰å¾…å¤šæ•°å‰¯æœ¬ç¡®è®¤</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼‚æ­¥å¤åˆ¶å‰©ä½™å‰¯æœ¬</span>
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-6">ä¸ƒã€æ–°æŠ€æœ¯å¯¹çŸ›ç›¾çš„å’Œè§£å°è¯•</h2>
<p><strong>åˆ†å¸ƒå¼æ•°æ®åº“çš„ä¼˜åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
Â *Â NewSQLæ•°æ®åº“çš„ä¸€è‡´æ€§ä¼˜åŒ–
Â *Â å¦‚TiDBã€CockroachDBç­‰
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">NewSQLDatabase</span>Â {
Â Â Â Â <span class="hljs-comment">//Â ä½¿ç”¨Raftåè®®ä¿è¯ä¸€è‡´æ€§</span>
Â Â Â Â <span class="hljs-comment">//Â é€šè¿‡ä¼˜åŒ–ç®—æ³•å‡å°‘ç½‘ç»œå¾€è¿”</span>
Â Â Â Â <span class="hljs-comment">//Â æ”¯æŒè‡ªåŠ¨åˆ†ç‰‡å’Œè´Ÿè½½å‡è¡¡</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">optimizedWrite</span><span class="hljs-params">(<span class="hljs-type">String</span>Â data)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â æœ¬åœ°å¿«é€Ÿå†™å…¥</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â å¹¶è¡Œå¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 3.Â æ™ºèƒ½è·¯ç”±å‡å°‘ç½‘ç»œå¼€é”€</span>
Â Â Â Â }
}
</code></pre>
<p><strong>ç¡¬ä»¶åŠ é€Ÿæ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
Â *Â ä½¿ç”¨RDMAå’Œæ™ºèƒ½ç½‘å¡ä¼˜åŒ–
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">HardwareAcceleratedConsistency</span>Â {
Â Â Â Â <span class="hljs-comment">//Â RDMAï¼ˆè¿œç¨‹ç›´æ¥å†…å­˜è®¿é—®ï¼‰å‡å°‘CPUå¼€é”€</span>
Â Â Â Â <span class="hljs-comment">//Â æ™ºèƒ½ç½‘å¡å¤„ç†ç½‘ç»œåè®®æ ˆ</span>
Â Â Â Â <span class="hljs-comment">//Â æŒä¹…å†…å­˜åŠ é€Ÿæ•°æ®æŒä¹…åŒ–</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">lowLatencyUpdate</span><span class="hljs-params">(<span class="hljs-type">String</span>Â data)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç»•è¿‡æ“ä½œç³»ç»Ÿå†…æ ¸</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç›´æ¥å†…å­˜è®¿é—®å…¶ä»–èŠ‚ç‚¹</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ˜¾è‘—å‡å°‘ç½‘ç»œå»¶è¿Ÿ</span>
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-7">å…«ã€é¢è¯•æ·±åº¦é—®ç­”</h2>
<p><strong>Q1ï¼šä¸ºä»€ä¹ˆæ•°æ®åº“çš„ä¸»ä»å¤åˆ¶ä¼šæœ‰ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ</strong> <strong>Aï¼š</strong> å› ä¸ºä¸»ä»å¤åˆ¶å­˜åœ¨å¤åˆ¶å»¶è¿Ÿï¼Œä¸»åº“å†™å…¥åä»åº“å¯èƒ½è¿˜æ²¡æœ‰åŒæ­¥å®Œæˆï¼Œè¿™æ—¶è¯»å–ä»åº“å°±ä¼šçœ‹åˆ°æ—§æ•°æ®ã€‚</p>
<p><strong>Q2ï¼šå¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­æƒè¡¡ä¸€è‡´æ€§å’Œæ€§èƒ½ï¼Ÿ</strong> <strong>Aï¼š</strong> æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼šèµ„é‡‘ç›¸å…³å¿…é¡»å¼ºä¸€è‡´æ€§ï¼Œå•†å“æµè§ˆå¯ä»¥æœ€ç»ˆä¸€è‡´æ€§ã€‚é€šè¿‡æ¶æ„åˆ†å±‚ï¼Œå¯¹ä¸åŒæ“ä½œé‡‡ç”¨ä¸åŒçš„ä¸€è‡´æ€§çº§åˆ«ã€‚</p>
<p><strong>Q3ï¼šCAPå®šç†ä¸­çš„Pï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰ä¸ºä»€ä¹ˆå¿…é¡»æ»¡è¶³ï¼Ÿ</strong> <strong>Aï¼š</strong> å› ä¸ºç½‘ç»œåˆ†åŒºæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å®¢è§‚å­˜åœ¨ï¼Œæ— æ³•é¿å…ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿåœ¨ç½‘ç»œåˆ†åŒºæ—¶ç»§ç»­å·¥ä½œã€‚</p>
<p><strong>Q4ï¼šä»€ä¹ˆæ˜¯è¯»å†™ä¸€è‡´æ€§ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ</strong> <strong>Aï¼š</strong> è¯»å†™ä¸€è‡´æ€§ä¿è¯ç”¨æˆ·æ€»èƒ½çœ‹åˆ°è‡ªå·±åˆšå†™å…¥çš„æ•°æ®ã€‚å¯ä»¥é€šè¿‡å†™åè¯»ä¸»åº“ã€ä¼šè¯ç²˜æ»ã€ç‰ˆæœ¬å·æ£€æŸ¥ç­‰æ–¹å¼å®ç°ã€‚</p>
<p><strong>Q5ï¼šBASEç†è®ºæ˜¯å¦‚ä½•è§£å†³CAPçŸ›ç›¾çš„ï¼Ÿ</strong> <strong>Aï¼š</strong> BASEï¼ˆBasically Available, Soft state, Eventually consistentï¼‰é€šè¿‡ç‰ºç‰²å¼ºä¸€è‡´æ€§æ¥è·å¾—å¯ç”¨æ€§ï¼Œå…è®¸ç³»ç»Ÿåœ¨çŸ­æ—¶é—´å†…å¤„äºä¸ä¸€è‡´çŠ¶æ€ã€‚</p>
<p><strong>é¢è¯•æŠ€å·§</strong>ï¼š</p>
<ol>
<li>ä»CAPå®šç†å’Œç‰©ç†é™åˆ¶å¼€å§‹è§£é‡Šæ ¹æœ¬åŸå› </li>
<li>ç»“åˆå…·ä½“ä¸šåŠ¡åœºæ™¯è¯´æ˜æƒè¡¡ç­–ç•¥</li>
<li>å±•ç¤ºå¯¹ä¸åŒä¸€è‡´æ€§çº§åˆ«çš„ç†è§£</li>
<li>æåŠæ–°æŠ€æœ¯å¯¹çŸ›ç›¾çš„ç¼“è§£æ–¹æ¡ˆ</li>
<li>å¼ºè°ƒ"æ²¡æœ‰é“¶å¼¹"ï¼Œéœ€è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©</li>
</ol>
<p><strong>æœ¬æ–‡ç”±å¾®ä¿¡å…¬ä¼—å·"ç¨‹åºå‘˜å°èƒ–"æ•´ç†å‘å¸ƒï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 2 vs React 18 æ·±åº¦å¯¹æ¯”æŒ‡å—]]></title>    <link>https://juejin.cn/post/7579142750408245274</link>    <guid>https://juejin.cn/post/7579142750408245274</guid>    <pubDate>2025-12-03T02:36:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579142750408245274" data-draft-id="7579142750408163354" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue 2 vs React 18 æ·±åº¦å¯¹æ¯”æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,React.js"/> <meta itemprop="datePublished" content="2025-12-03T02:36:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯_é€é¥ç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3702810890736270"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue 2 vs React 18 æ·±åº¦å¯¹æ¯”æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3702810890736270/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯_é€é¥ç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:36:31.000Z" title="Wed Dec 03 2025 02:36:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue 2 vs React 18 æ·±åº¦å¯¹æ¯”æŒ‡å—</h2>
<blockquote>
<p>æœ¬æ–‡æ¡£é¢å‘ç†Ÿç»ƒä½¿ç”¨ Vue 2 çš„å¼€å‘è€…ï¼Œå¸®åŠ©å¿«é€Ÿç†è§£ React 18 çš„æ ¸å¿ƒæ¦‚å¿µä¸å·®å¼‚ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ç›®å½•</h3>
<ol>
<li><a href="#1-%E6%A0%B8%E5%BF%83%E8%AE%BE%E8%AE%A1%E5%93%B2%E5%AD%A6" title="#1-%E6%A0%B8%E5%BF%83%E8%AE%BE%E8%AE%A1%E5%93%B2%E5%AD%A6">æ ¸å¿ƒè®¾è®¡å“²å­¦</a></li>
<li><a href="#2-%E7%BB%84%E4%BB%B6%E5%AE%9A%E4%B9%89" title="#2-%E7%BB%84%E4%BB%B6%E5%AE%9A%E4%B9%89">ç»„ä»¶å®šä¹‰</a></li>
<li><a href="#3-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86" title="#3-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86">å“åº”å¼åŸç†</a></li>
<li><a href="#4-%E6%A8%A1%E6%9D%BF-vs-jsx" title="#4-%E6%A8%A1%E6%9D%BF-vs-jsx">æ¨¡æ¿ vs JSX</a></li>
<li><a href="#5-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%AF%B9%E6%AF%94" title="#5-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%AF%B9%E6%AF%94">ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”</a></li>
<li><a href="#6-%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7-vs-usememo" title="#6-%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7-vs-usememo">è®¡ç®—å±æ€§ vs useMemo</a></li>
<li><a href="#7-%E4%BE%A6%E5%90%AC%E5%99%A8-vs-useeffect" title="#7-%E4%BE%A6%E5%90%AC%E5%99%A8-vs-useeffect">ä¾¦å¬å™¨ vs useEffect</a></li>
<li><a href="#8-%E7%88%B6%E5%AD%90%E9%80%9A%E4%BF%A1" title="#8-%E7%88%B6%E5%AD%90%E9%80%9A%E4%BF%A1">çˆ¶å­é€šä¿¡</a></li>
<li><a href="#9-%E8%B7%A8%E5%B1%82%E7%BA%A7%E9%80%9A%E4%BF%A1" title="#9-%E8%B7%A8%E5%B1%82%E7%BA%A7%E9%80%9A%E4%BF%A1">è·¨å±‚çº§é€šä¿¡</a></li>
<li><a href="#10-%E6%8F%92%E6%A7%BD-vs-children--render-props" title="#10-%E6%8F%92%E6%A7%BD-vs-children--render-props">æ’æ§½ vs children / render props</a></li>
<li><a href="#11-%E8%99%9A%E6%8B%9F-dom-%E4%B8%8E-diff-%E7%AE%97%E6%B3%95" title="#11-%E8%99%9A%E6%8B%9F-dom-%E4%B8%8E-diff-%E7%AE%97%E6%B3%95">è™šæ‹Ÿ DOM ä¸ Diff ç®—æ³•</a></li>
<li><a href="#12-react-18-%E6%96%B0%E7%89%B9%E6%80%A7" title="#12-react-18-%E6%96%B0%E7%89%B9%E6%80%A7">React 18 æ–°ç‰¹æ€§</a></li>
<li><a href="#13-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AF%B9%E6%AF%94" title="#13-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AF%B9%E6%AF%94">æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”</a></li>
<li><a href="#14-%E6%80%BB%E7%BB%93%E5%AF%B9%E7%85%A7%E8%A1%A8" title="#14-%E6%80%BB%E7%BB%93%E5%AF%B9%E7%85%A7%E8%A1%A8">æ€»ç»“å¯¹ç…§è¡¨</a></li>
<li><a href="#15-%E8%BF%81%E7%A7%BB%E5%BB%BA%E8%AE%AE" title="#15-%E8%BF%81%E7%A7%BB%E5%BB%BA%E8%AE%AE">è¿ç§»å»ºè®®</a></li>
</ol>
<hr/>
<h3 data-id="heading-2">1. æ ¸å¿ƒè®¾è®¡å“²å­¦</h3>






























<table><thead><tr><th>ç»´åº¦</th><th>Vue 2</th><th>React 18</th></tr></thead><tbody><tr><td><strong>å®šä½</strong></td><td>æ¸è¿›å¼æ¡†æ¶ï¼ˆæ¡†æ¶å¸®ä½ åšæ›´å¤šï¼‰</td><td>UI åº“ï¼ˆä½ è‡ªå·±ç»„åˆç”Ÿæ€ï¼‰</td></tr><tr><td><strong>æ¨¡æ¿</strong></td><td>æ¨¡æ¿è¯­æ³• + æŒ‡ä»¤</td><td>JSXï¼ˆJS çš„è¯­æ³•æ‰©å±•ï¼‰</td></tr><tr><td><strong>å“åº”å¼</strong></td><td>è‡ªåŠ¨ä¾èµ–è¿½è¸ªï¼ˆgetter/setterï¼‰</td><td>æ‰‹åŠ¨å£°æ˜æ›´æ–°ï¼ˆsetStateï¼‰</td></tr><tr><td><strong>å¿ƒæ™ºæ¨¡å‹</strong></td><td>"æ•°æ®å˜äº†ï¼Œè§†å›¾è‡ªåŠ¨å˜"</td><td>"è°ƒç”¨æ›´æ–°å‡½æ•°ï¼Œè§¦å‘é‡æ–°æ¸²æŸ“"</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-3">2. ç»„ä»¶å®šä¹‰</h3>
<h4 data-id="heading-4">Vue 2ï¼šé€‰é¡¹å¼ API</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div&gt;{{ count }}&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  data() {
    return { count: 0 }
  },
  methods: {
    increment() {
      this.count++
    }
  }
}
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-5">React 18ï¼šå‡½æ•°ç»„ä»¶ + Hooks</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>)
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{count}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<h4 data-id="heading-6">åŸç†å·®å¼‚</h4>
<ul>
<li><strong>Vue 2</strong>ï¼šç»„ä»¶æ˜¯ä¸€ä¸ª"é…ç½®å¯¹è±¡"ï¼ŒVue å†…éƒ¨å®ä¾‹åŒ–å¹¶ç®¡ç†ç”Ÿå‘½å‘¨æœŸã€‚<code>this</code> æŒ‡å‘ç»„ä»¶å®ä¾‹ï¼Œ<code>data</code> ä¼šè¢« Vue ç”¨ <code>Object.defineProperty</code> è½¬æˆå“åº”å¼ã€‚</li>
<li><strong>React 18</strong>ï¼šç»„ä»¶å°±æ˜¯ä¸€ä¸ª"çº¯å‡½æ•°"ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šé‡æ–°æ‰§è¡Œã€‚çŠ¶æ€é€šè¿‡ Hooks ä¿å­˜åœ¨ React å†…éƒ¨çš„ Fiber èŠ‚ç‚¹ä¸Šï¼Œè€Œä¸æ˜¯ç»„ä»¶å®ä¾‹ä¸Šã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">3. å“åº”å¼åŸç†</h3>
<h4 data-id="heading-8">Vue 2ï¼šåŸºäº <code>Object.defineProperty</code> çš„ä¾èµ–è¿½è¸ª</h4>
<pre><code class="hljs language-text" lang="text">æ•°æ®å˜åŒ–æµç¨‹ï¼š
data â†’ defineProperty(getter/setter)
       â†“
   getter æ”¶é›†ä¾èµ–ï¼ˆWatcherï¼‰
       â†“
   setter è§¦å‘ä¾èµ–æ›´æ–°
       â†“
   Watcher é€šçŸ¥ç»„ä»¶é‡æ–°æ¸²æŸ“
</code></pre>
<h5 data-id="heading-9">æ ¸å¿ƒä»£ç é€»è¾‘ï¼ˆç®€åŒ–ï¼‰</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Vue 2 å“åº”å¼æ ¸å¿ƒ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">obj, key, val</span>) {
  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>() <span class="hljs-comment">// ä¾èµ–æ”¶é›†å™¨</span>
  
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
    <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) {
        dep.<span class="hljs-title function_">depend</span>() <span class="hljs-comment">// æ”¶é›†å½“å‰ Watcher</span>
      }
      <span class="hljs-keyword">return</span> val
    },
    <span class="hljs-title function_">set</span>(<span class="hljs-params">newVal</span>) {
      <span class="hljs-keyword">if</span> (newVal === val) <span class="hljs-keyword">return</span>
      val = newVal
      dep.<span class="hljs-title function_">notify</span>() <span class="hljs-comment">// é€šçŸ¥æ‰€æœ‰ Watcher æ›´æ–°</span>
    }
  })
}
</code></pre>
<p><strong>å±€é™æ€§ï¼š</strong></p>
<ul>
<li>æ— æ³•æ£€æµ‹å±æ€§çš„æ·»åŠ /åˆ é™¤ï¼ˆéœ€è¦ <code>Vue.set</code>ï¼‰</li>
<li>æ— æ³•æ£€æµ‹æ•°ç»„ç´¢å¼•èµ‹å€¼ï¼ˆéœ€è¦ç”¨ <code>splice</code> ç­‰å˜å¼‚æ–¹æ³•ï¼‰</li>
</ul>
<hr/>
<h4 data-id="heading-10">React 18ï¼šä¸å¯å˜æ•°æ® + è°ƒåº¦æ›´æ–°</h4>
<pre><code class="hljs language-text" lang="text">çŠ¶æ€å˜åŒ–æµç¨‹ï¼š
setState(newValue)
    â†“
React è°ƒåº¦å™¨æ ‡è®°ç»„ä»¶éœ€è¦æ›´æ–°
    â†“
æ‰¹é‡å¤„ç†æ›´æ–°ï¼ˆBatchingï¼‰
    â†“
é‡æ–°æ‰§è¡Œå‡½æ•°ç»„ä»¶
    â†“
Diff è™šæ‹Ÿ DOM â†’ æ›´æ–°çœŸå® DOM
</code></pre>
<p><strong>æ ¸å¿ƒæœºåˆ¶ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// React çŠ¶æ€æ›´æ–°ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useState</span>(<span class="hljs-params">initialValue</span>) {
  <span class="hljs-comment">// çŠ¶æ€å­˜å‚¨åœ¨ Fiber èŠ‚ç‚¹çš„ memoizedState é“¾è¡¨ä¸Š</span>
  <span class="hljs-keyword">const</span> hook = <span class="hljs-title function_">mountWorkInProgressHook</span>()
  hook.<span class="hljs-property">memoizedState</span> = initialValue
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">dispatch</span> = (<span class="hljs-params">action</span>) =&gt; {
    <span class="hljs-comment">// åˆ›å»ºæ›´æ–°å¯¹è±¡ï¼ŒåŠ å…¥æ›´æ–°é˜Ÿåˆ—</span>
    <span class="hljs-keyword">const</span> update = { action, <span class="hljs-attr">next</span>: <span class="hljs-literal">null</span> }
    <span class="hljs-title function_">enqueueUpdate</span>(hook.<span class="hljs-property">queue</span>, update)
    <span class="hljs-comment">// è°ƒåº¦æ›´æ–°</span>
    <span class="hljs-title function_">scheduleUpdateOnFiber</span>(fiber)
  }
  
  <span class="hljs-keyword">return</span> [hook.<span class="hljs-property">memoizedState</span>, dispatch]
}
</code></pre>
<p><strong>React 18 æ–°ç‰¹æ€§ï¼šè‡ªåŠ¨æ‰¹å¤„ç†ï¼ˆAutomatic Batchingï¼‰</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// React 17ï¼šåªæœ‰äº‹ä»¶å¤„ç†å‡½æ•°å†…ä¼šæ‰¹å¤„ç†</span>
<span class="hljs-comment">// React 18ï¼šæ‰€æœ‰æ›´æ–°éƒ½ä¼šè‡ªåŠ¨æ‰¹å¤„ç†</span>

<span class="hljs-comment">// ä»¥ä¸‹ä¸‰æ¬¡ setState åªä¼šè§¦å‘ä¸€æ¬¡é‡æ¸²æŸ“</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>)
  <span class="hljs-title function_">setFlag</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> !f)
  <span class="hljs-title function_">setName</span>(<span class="hljs-string">'new'</span>)
}, <span class="hljs-number">1000</span>)
</code></pre>
<hr/>
<h3 data-id="heading-11">4. æ¨¡æ¿ vs JSX</h3>
<h4 data-id="heading-12">Vue 2ï¼šæ¨¡æ¿ + æŒ‡ä»¤</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;!-- æ¡ä»¶æ¸²æŸ“ --&gt;
    &lt;span v-if="show"&gt;æ˜¾ç¤º&lt;/span&gt;
    &lt;span v-else&gt;éšè—&lt;/span&gt;
    
    &lt;!-- åˆ—è¡¨æ¸²æŸ“ --&gt;
    &lt;ul&gt;
      &lt;li v-for="item in list" :key="item.id"&gt;
        {{ item.name }}
      &lt;/li&gt;
    &lt;/ul&gt;
    
    &lt;!-- åŒå‘ç»‘å®š --&gt;
    &lt;input v-model="text" /&gt;
    
    &lt;!-- äº‹ä»¶ --&gt;
    &lt;button @click="handleClick"&gt;ç‚¹å‡»&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p><strong>åŸç†ï¼š</strong></p>
<ul>
<li>æ¨¡æ¿åœ¨ç¼–è¯‘é˜¶æ®µè¢«è½¬æ¢ä¸ºæ¸²æŸ“å‡½æ•°ï¼ˆ<code>render function</code>ï¼‰</li>
<li>æŒ‡ä»¤ï¼ˆ<code>v-if</code>ã€<code>v-for</code>ï¼‰æ˜¯ç¼–è¯‘æ—¶çš„è¯­æ³•ç³–</li>
<li>ç¼–è¯‘å™¨å¯ä»¥åšé™æ€åˆ†æä¼˜åŒ–ï¼ˆæ ‡è®°é™æ€èŠ‚ç‚¹ï¼‰</li>
</ul>
<hr/>
<h4 data-id="heading-13">React 18ï¼šJSX</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params">{ show, list, text, setText }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* æ¡ä»¶æ¸²æŸ“ */}
      {show ? <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>æ˜¾ç¤º<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>éšè—<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
      
      {/* åˆ—è¡¨æ¸²æŸ“ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {list.map(item =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      
      {/* å—æ§ç»„ä»¶ï¼ˆåŒå‘ç»‘å®šï¼‰ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{text}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setText(e.target.value)} /&gt;
      
      {/* äº‹ä»¶ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>ç‚¹å‡»<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p><strong>åŸç†ï¼š</strong></p>
<ul>
<li>JSX æ˜¯ <code>React.createElement()</code> çš„è¯­æ³•ç³–</li>
<li>ç¼–è¯‘åï¼š<code>&lt;div&gt;hello&lt;/div&gt;</code> â†’ <code>React.createElement('div', null, 'hello')</code></li>
<li>æ²¡æœ‰æŒ‡ä»¤ï¼Œä¸€åˆ‡éƒ½æ˜¯ JS è¡¨è¾¾å¼</li>
</ul>
<h4 data-id="heading-14">è¯­æ³•å¯¹ç…§è¡¨</h4>



































<table><thead><tr><th>ç‰¹æ€§</th><th>Vue 2 æ¨¡æ¿</th><th>React JSX</th></tr></thead><tbody><tr><td>æ¡ä»¶</td><td><code>v-if</code> / <code>v-else</code></td><td><code>{condition &amp;&amp; ...}</code> æˆ–ä¸‰å…ƒ</td></tr><tr><td>å¾ªç¯</td><td><code>v-for</code></td><td><code>array.map()</code></td></tr><tr><td>åŒå‘ç»‘å®š</td><td><code>v-model</code></td><td>å—æ§ç»„ä»¶ï¼ˆvalue + onChangeï¼‰</td></tr><tr><td>äº‹ä»¶</td><td><code>@click</code></td><td><code>onClick</code></td></tr><tr><td>æ ·å¼</td><td><code>:class</code> / <code>:style</code></td><td><code>className</code> / <code>style={{}}</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-15">5. ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”</h3>
<h4 data-id="heading-16">Vue 2 ç”Ÿå‘½å‘¨æœŸ</h4>
<pre><code class="hljs language-text" lang="text">beforeCreate â†’ created â†’ beforeMount â†’ mounted
                              â†“
                        beforeUpdate â†’ updated
                              â†“
                        beforeDestroy â†’ destroyed
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">created</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å®ä¾‹åˆ›å»ºå®Œæˆï¼Œdata/methods å¯ç”¨ï¼ŒDOM æœªæŒ‚è½½</span>
    <span class="hljs-comment">// å¸¸ç”¨äºï¼šåˆå§‹åŒ–æ•°æ®ã€å‘èµ·è¯·æ±‚</span>
  },
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// DOM å·²æŒ‚è½½</span>
    <span class="hljs-comment">// å¸¸ç”¨äºï¼šæ“ä½œ DOMã€åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“</span>
  },
  <span class="hljs-title function_">updated</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ•°æ®å˜åŒ–å¯¼è‡´ DOM æ›´æ–°å</span>
  },
  <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// é”€æ¯å‰ï¼Œæ¸…ç†å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ç­‰</span>
  }
}
</code></pre>
<hr/>
<h4 data-id="heading-17">React 18ï¼šuseEffect ç»Ÿä¸€å¤„ç†</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useEffect, useLayoutEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ç›¸å½“äº mounted + updated</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶æŒ‚è½½æˆ–æ›´æ–°å'</span>)
    
    <span class="hljs-comment">// ç›¸å½“äº beforeDestroy</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¸…ç†ï¼šç»„ä»¶å¸è½½å‰ æˆ– ä¸‹æ¬¡ effect æ‰§è¡Œå‰'</span>)
    }
  }) <span class="hljs-comment">// æ— ä¾èµ–æ•°ç»„ï¼šæ¯æ¬¡æ¸²æŸ“åéƒ½æ‰§è¡Œ</span>
  
  <span class="hljs-comment">// ç›¸å½“äº mountedï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åªåœ¨æŒ‚è½½æ—¶æ‰§è¡Œ'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åªåœ¨å¸è½½æ—¶æ‰§è¡Œ'</span>)
  }, []) <span class="hljs-comment">// ç©ºä¾èµ–æ•°ç»„</span>
  
  <span class="hljs-comment">// ç›¸å½“äº watch</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'count å˜åŒ–äº†'</span>)
  }, [count]) <span class="hljs-comment">// ä¾èµ– count</span>
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<p><strong>åŸç†ï¼š</strong></p>
<ul>
<li><code>useEffect</code> çš„å›è°ƒåœ¨ <strong>DOM æ›´æ–°åå¼‚æ­¥æ‰§è¡Œ</strong>ï¼ˆä¸é˜»å¡æ¸²æŸ“ï¼‰</li>
<li><code>useLayoutEffect</code> åœ¨ <strong>DOM æ›´æ–°ååŒæ­¥æ‰§è¡Œ</strong>ï¼ˆé˜»å¡æ¸²æŸ“ï¼Œç”¨äºæµ‹é‡ DOMï¼‰</li>
<li>ä¾èµ–æ•°ç»„å†³å®šä½•æ—¶é‡æ–°æ‰§è¡Œ effect</li>
</ul>
<h4 data-id="heading-18">ç”Ÿå‘½å‘¨æœŸå¯¹ç…§è¡¨</h4>





























<table><thead><tr><th>Vue 2</th><th>React 18</th></tr></thead><tbody><tr><td><code>created</code></td><td>å‡½æ•°ä½“é¡¶éƒ¨ï¼ˆä½†è¦æ³¨æ„ SSRï¼‰</td></tr><tr><td><code>mounted</code></td><td><code>useEffect(() =&gt; {}, [])</code></td></tr><tr><td><code>updated</code></td><td><code>useEffect(() =&gt; {})</code> æˆ– <code>useEffect(() =&gt; {}, [deps])</code></td></tr><tr><td><code>beforeDestroy</code></td><td><code>useEffect</code> è¿”å›çš„æ¸…ç†å‡½æ•°</td></tr><tr><td><code>watch</code></td><td><code>useEffect(() =&gt; {}, [watchedValue])</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-19">6. è®¡ç®—å±æ€§ vs useMemo</h3>
<h4 data-id="heading-20">Vue 2ï¼šcomputed</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">firstName</span>: <span class="hljs-string">'John'</span>, <span class="hljs-attr">lastName</span>: <span class="hljs-string">'Doe'</span> }
  },
  <span class="hljs-attr">computed</span>: {
    <span class="hljs-title function_">fullName</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.firstName}</span> <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.lastName}</span>`</span>
    }
  }
}
</code></pre>
<p><strong>åŸç†ï¼š</strong></p>
<ul>
<li>computed æ˜¯ä¸€ä¸ªæƒ°æ€§æ±‚å€¼çš„ Watcher</li>
<li>åªæœ‰ä¾èµ–å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—</li>
<li>æœ‰ç¼“å­˜ï¼šå¤šæ¬¡è®¿é—®ä¸ä¼šé‡å¤è®¡ç®—</li>
</ul>
<hr/>
<h4 data-id="heading-21">React 18ï¼šuseMemo</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params">{ firstName, lastName }</span>) {
  <span class="hljs-keyword">const</span> fullName = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${firstName}</span> <span class="hljs-subst">${lastName}</span>`</span>
  }, [firstName, lastName])
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{fullName}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<p><strong>åŸç†ï¼š</strong></p>
<ul>
<li><code>useMemo</code> åœ¨ä¾èµ–æ•°ç»„ä¸å˜æ—¶è¿”å›ç¼“å­˜å€¼</li>
<li>ä¾èµ–æ•°ç»„å˜åŒ–æ—¶é‡æ–°æ‰§è¡Œè®¡ç®—å‡½æ•°</li>
<li><strong>å¿…é¡»æ‰‹åŠ¨å£°æ˜ä¾èµ–</strong>ï¼ˆVue æ˜¯è‡ªåŠ¨è¿½è¸ªï¼‰</li>
</ul>
<h4 data-id="heading-22">å…³é”®åŒºåˆ«</h4>

























<table><thead><tr><th>ç‰¹æ€§</th><th>Vue 2 computed</th><th>React useMemo</th></tr></thead><tbody><tr><td>ä¾èµ–è¿½è¸ª</td><td>è‡ªåŠ¨</td><td>æ‰‹åŠ¨å£°æ˜</td></tr><tr><td>ç¼“å­˜</td><td>æœ‰</td><td>æœ‰</td></tr><tr><td>ç”¨é€”</td><td>æ´¾ç”ŸçŠ¶æ€</td><td>æ´¾ç”ŸçŠ¶æ€ + é¿å…é‡å¤è®¡ç®—</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-23">7. ä¾¦å¬å™¨ vs useEffect</h3>
<h4 data-id="heading-24">Vue 2ï¼šwatch</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">query</span>: <span class="hljs-string">''</span> }
  },
  <span class="hljs-attr">watch</span>: {
    <span class="hljs-attr">query</span>: {
      <span class="hljs-title function_">handler</span>(<span class="hljs-params">newVal, oldVal</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">search</span>(newVal)
      },
      <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ç«‹å³æ‰§è¡Œ</span>
      <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>       <span class="hljs-comment">// æ·±åº¦ç›‘å¬</span>
    }
  }
}
</code></pre>
<h4 data-id="heading-25">React 18ï¼šuseEffect</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">SearchComponent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [query, setQuery] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>)
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æ²¡æœ‰ oldValï¼Œéœ€è¦è‡ªå·±ç”¨ useRef ä¿å­˜</span>
    <span class="hljs-title function_">search</span>(query)
  }, [query])
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{query}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setQuery(e.target.value)} /&gt;</span>
}
</code></pre>
<p><strong>è·å–æ—§å€¼çš„æ–¹å¼ï¼š</strong></p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> usePrevious&lt;T&gt;(<span class="hljs-attr">value</span>: T): T | <span class="hljs-literal">undefined</span> {
  <span class="hljs-keyword">const</span> ref = useRef&lt;T&gt;()
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    ref.<span class="hljs-property">current</span> = value
  })
  <span class="hljs-keyword">return</span> ref.<span class="hljs-property">current</span>
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> prevQuery = <span class="hljs-title function_">usePrevious</span>(query)
</code></pre>
<hr/>
<h3 data-id="heading-26">8. çˆ¶å­é€šä¿¡</h3>
<h4 data-id="heading-27">Vue 2</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- çˆ¶ç»„ä»¶ --&gt;
&lt;template&gt;
  &lt;Child :msg="message" @update="handleUpdate" /&gt;
&lt;/template&gt;

&lt;!-- å­ç»„ä»¶ --&gt;
&lt;template&gt;
  &lt;div @click="$emit('update', newValue)"&gt;{{ msg }}&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  props: ['msg']
}
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-28">React 18</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// çˆ¶ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [message, setMessage] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>)
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Child</span> 
      <span class="hljs-attr">msg</span>=<span class="hljs-string">{message}</span> 
      <span class="hljs-attr">onUpdate</span>=<span class="hljs-string">{(newValue)</span> =&gt;</span> setMessage(newValue)} 
    /&gt;</span>
  )
}

<span class="hljs-comment">// å­ç»„ä»¶</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChildProps</span> {
  <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">onUpdate</span>: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">{ msg, onUpdate }: ChildProps</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onUpdate('new')}&gt;{msg}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<h4 data-id="heading-29">é€šä¿¡æ–¹å¼å¯¹ç…§</h4>

























<table><thead><tr><th>ç‰¹æ€§</th><th>Vue 2</th><th>React 18</th></tr></thead><tbody><tr><td>çˆ¶â†’å­</td><td><code>props</code></td><td><code>props</code></td></tr><tr><td>å­â†’çˆ¶</td><td><code>$emit</code></td><td>å›è°ƒå‡½æ•° props</td></tr><tr><td>åŒå‘ç»‘å®š</td><td><code>v-model</code> / <code>.sync</code></td><td>å—æ§ç»„ä»¶æ¨¡å¼</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-30">9. è·¨å±‚çº§é€šä¿¡</h3>
<h4 data-id="heading-31">Vue 2ï¼šprovide / inject</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç¥–å…ˆç»„ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">provide</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">theme</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">theme</span>
    }
  }
}

<span class="hljs-comment">// åä»£ç»„ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">inject</span>: [<span class="hljs-string">'theme'</span>]
}
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> Vue 2 çš„ provide/inject <strong>ä¸æ˜¯å“åº”å¼çš„</strong>ï¼ˆé™¤é provide ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼‰ã€‚</p>
<hr/>
<h4 data-id="heading-32">React 18ï¼šContext</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// åˆ›å»º Context</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = createContext&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'light'</span>)

<span class="hljs-comment">// ç¥–å…ˆç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'dark'</span>)
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{theme}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  )
}

<span class="hljs-comment">// åä»£ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">DeepChild</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>)
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å½“å‰ä¸»é¢˜ï¼š{theme}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<h5 data-id="heading-33">åŸç†</h5>
<ul>
<li>Provider çš„ value å˜åŒ–æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è¯¥ Context çš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“</li>
<li>è¿™æ˜¯ React çš„ä¸€ä¸ªæ€§èƒ½é™·é˜±ï¼šContext å˜åŒ–ä¼šå¯¼è‡´æ‰€æœ‰æ¶ˆè´¹è€…é‡æ¸²æŸ“ï¼Œå³ä½¿å®ƒä»¬åªç”¨äº† Context çš„ä¸€éƒ¨åˆ†</li>
</ul>
<p><strong>ä¼˜åŒ–æ–¹å¼ï¼š</strong></p>
<ul>
<li>æ‹†åˆ† Contextï¼ˆè¯»å†™åˆ†ç¦»ï¼‰</li>
<li>ä½¿ç”¨ <code>useMemo</code> åŒ…è£¹ value</li>
<li>æˆ–ä½¿ç”¨çŠ¶æ€ç®¡ç†åº“ï¼ˆRedux/Zustandï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-34">10. æ’æ§½ vs children / render props</h3>
<h4 data-id="heading-35">Vue 2ï¼šæ’æ§½</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- çˆ¶ç»„ä»¶ --&gt;
&lt;Card&gt;
  &lt;template #header&gt;æ ‡é¢˜&lt;/template&gt;
  &lt;template #default&gt;å†…å®¹&lt;/template&gt;
  &lt;template #footer="{ data }"&gt;{{ data }}&lt;/template&gt;
&lt;/Card&gt;

&lt;!-- Card ç»„ä»¶ --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;header&gt;&lt;slot name="header" /&gt;&lt;/header&gt;
    &lt;main&gt;&lt;slot /&gt;&lt;/main&gt;
    &lt;footer&gt;&lt;slot name="footer" :data="footerData" /&gt;&lt;/footer&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h4 data-id="heading-36">React 18ï¼šchildren + render props</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// çˆ¶ç»„ä»¶</span>
&lt;<span class="hljs-title class_">Card</span>
  header={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>}
  footer={<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{data}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>}
&gt;
  å†…å®¹
&lt;/<span class="hljs-title class_">Card</span>&gt;

<span class="hljs-comment">// Card ç»„ä»¶</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">CardProps</span> {
  header?: <span class="hljs-title class_">ReactNode</span>
  footer?: <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">ReactNode</span>
  <span class="hljs-attr">children</span>: <span class="hljs-title class_">ReactNode</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Card</span>(<span class="hljs-params">{ header, footer, children }: CardProps</span>) {
  <span class="hljs-keyword">const</span> footerData = <span class="hljs-string">'some data'</span>
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>{header}<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span>{footer?.(footerData)}<span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<h4 data-id="heading-37">æ’æ§½å¯¹ç…§</h4>





















<table><thead><tr><th>Vue 2</th><th>React 18</th></tr></thead><tbody><tr><td>é»˜è®¤æ’æ§½ <code>&lt;slot /&gt;</code></td><td><code>children</code></td></tr><tr><td>å…·åæ’æ§½ <code>&lt;slot name="x" /&gt;</code></td><td>å…·å propsï¼ˆå¦‚ <code>header</code>ï¼‰</td></tr><tr><td>ä½œç”¨åŸŸæ’æ§½</td><td>render propsï¼ˆå‡½æ•°ä½œä¸º propsï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-38">11. è™šæ‹Ÿ DOM ä¸ Diff ç®—æ³•</h3>
<h4 data-id="heading-39">Vue 2 Diff</h4>
<ul>
<li><strong>åŒç«¯æ¯”è¾ƒç®—æ³•</strong>ï¼šåŒæ—¶ä»æ–°æ—§èŠ‚ç‚¹åˆ—è¡¨çš„ä¸¤ç«¯å‘ä¸­é—´æ¯”è¾ƒ</li>
<li>ä¼˜åŒ–ï¼šé™æ€èŠ‚ç‚¹æ ‡è®°ï¼Œè·³è¿‡ä¸å˜çš„èŠ‚ç‚¹</li>
</ul>
<pre><code class="hljs language-text" lang="text">æ—§: [A, B, C, D]
æ–°: [D, A, B, C]

åŒç«¯æ¯”è¾ƒï¼š
1. æ—§å¤´(A) vs æ–°å¤´(D) âŒ
2. æ—§å°¾(D) vs æ–°å°¾(C) âŒ
3. æ—§å¤´(A) vs æ–°å°¾(C) âŒ
4. æ—§å°¾(D) vs æ–°å¤´(D) âœ… â†’ ç§»åŠ¨ D åˆ°æœ€å‰
</code></pre>
<h4 data-id="heading-40">React 18 Diff</h4>
<ul>
<li><strong>å•å‘éå† + key æ˜ å°„</strong></li>
<li>åªä»å·¦åˆ°å³éå†ï¼Œé€šè¿‡ key å»ºç«‹æ˜ å°„</li>
</ul>
<pre><code class="hljs language-text" lang="text">æ—§: [A, B, C, D]
æ–°: [D, A, B, C]

1. éå†æ–°åˆ—è¡¨ï¼ŒD åœ¨æ—§åˆ—è¡¨ä¸­æ‰¾åˆ°ï¼Œä½†ä½ç½®ä¸å¯¹
2. æ ‡è®°éœ€è¦ç§»åŠ¨çš„èŠ‚ç‚¹
3. æœ€å°åŒ– DOM æ“ä½œ
</code></pre>
<p><strong>å…³é”®ï¼škey çš„ä½œç”¨</strong></p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šç”¨ index ä½œä¸º key</span>
{list.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Item</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> /&gt;</span></span>)}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šç”¨å”¯ä¸€æ ‡è¯†ä½œä¸º key</span>
{list.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Item</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> /&gt;</span></span>)}
</code></pre>
<hr/>
<h3 data-id="heading-41">12. React 18 æ–°ç‰¹æ€§</h3>
<h4 data-id="heading-42">12.1 å¹¶å‘æ¸²æŸ“ï¼ˆConcurrent Renderingï¼‰</h4>
<p>React 18 æœ€å¤§çš„å˜åŒ–ï¼šæ¸²æŸ“å¯ä»¥è¢«ä¸­æ–­ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useTransition, useDeferredValue } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">SearchResults</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [query, setQuery] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>)
  <span class="hljs-keyword">const</span> [isPending, startTransition] = <span class="hljs-title function_">useTransition</span>()
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e</span>) =&gt; {
    <span class="hljs-comment">// ç´§æ€¥æ›´æ–°ï¼šè¾“å…¥æ¡†ç«‹å³å“åº”</span>
    <span class="hljs-title function_">setQuery</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>)
    
    <span class="hljs-comment">// éç´§æ€¥æ›´æ–°ï¼šæœç´¢ç»“æœå¯ä»¥å»¶è¿Ÿ</span>
    <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">setSearchResults</span>(<span class="hljs-title function_">search</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>))
    })
  }
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{query}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span> /&gt;</span>
      {isPending ? <span class="hljs-tag">&lt;<span class="hljs-name">Spinner</span> /&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">Results</span> /&gt;</span>}
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<p><strong>åŸç†ï¼š</strong></p>
<ul>
<li>React 18 å¼•å…¥äº†ä¼˜å…ˆçº§è°ƒåº¦</li>
<li><code>startTransition</code> æ ‡è®°çš„æ›´æ–°æ˜¯ä½ä¼˜å…ˆçº§çš„ï¼Œå¯ä»¥è¢«é«˜ä¼˜å…ˆçº§æ›´æ–°æ‰“æ–­</li>
<li>ç”¨æˆ·è¾“å…¥ç­‰äº¤äº’æ˜¯é«˜ä¼˜å…ˆçº§ï¼Œæ•°æ®æ¸²æŸ“æ˜¯ä½ä¼˜å…ˆçº§</li>
</ul>
<h4 data-id="heading-43">12.2 Suspense æ•°æ®è·å–</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// é…åˆ React Query / SWR / Relay ç­‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ProfilePage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Spinner</span> /&gt;</span>}&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">ProfileDetails</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">PostsSpinner</span> /&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">ProfilePosts</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
  )
}
</code></pre>
<h4 data-id="heading-44">12.3 è‡ªåŠ¨æ‰¹å¤„ç†</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// React 18ï¼šæ‰€æœ‰æ›´æ–°è‡ªåŠ¨æ‰¹å¤„ç†</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>)  <span class="hljs-comment">// ä¸ä¼šç«‹å³æ¸²æŸ“</span>
  <span class="hljs-title function_">setFlag</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> !f)      <span class="hljs-comment">// ä¸ä¼šç«‹å³æ¸²æŸ“</span>
  <span class="hljs-comment">// åªè§¦å‘ä¸€æ¬¡æ¸²æŸ“</span>
}, <span class="hljs-number">1000</span>)
</code></pre>
<hr/>
<h3 data-id="heading-45">13. æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”</h3>
<h4 data-id="heading-46">Vue 2 æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. v-onceï¼šåªæ¸²æŸ“ä¸€æ¬¡</span>
&lt;span v-once&gt;{{ staticContent }}&lt;/span&gt;

<span class="hljs-comment">// 2. v-memoï¼ˆVue 3.2+ï¼ŒVue 2 æ²¡æœ‰ï¼‰</span>

<span class="hljs-comment">// 3. computed è‡ªå¸¦ç¼“å­˜</span>

<span class="hljs-comment">// 4. keep-alive ç¼“å­˜ç»„ä»¶</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-47">React 18 æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// 1. React.memoï¼šç»„ä»¶çº§åˆ«ç¼“å­˜</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">MemoizedComponent</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params">props</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{props.value}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
})

<span class="hljs-comment">// 2. useMemoï¼šå€¼ç¼“å­˜</span>
<span class="hljs-keyword">const</span> expensiveValue = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">compute</span>(a, b), [a, b])

<span class="hljs-comment">// 3. useCallbackï¼šå‡½æ•°ç¼“å­˜</span>
<span class="hljs-keyword">const</span> handleClick = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">doSomething</span>(a, b)
}, [a, b])

<span class="hljs-comment">// 4. æ‡’åŠ è½½</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyComponent</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./HeavyComponent'</span>))

&lt;<span class="hljs-title class_">Suspense</span> fallback={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Loading</span> /&gt;</span></span>}&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> /&gt;</span></span>
&lt;/<span class="hljs-title class_">Suspense</span>&gt;
</code></pre>
<h4 data-id="heading-48">ä¼˜åŒ–æ–¹å¼å¯¹ç…§</h4>






























<table><thead><tr><th>ä¼˜åŒ–ç‚¹</th><th>Vue 2</th><th>React 18</th></tr></thead><tbody><tr><td>ç»„ä»¶ç¼“å­˜</td><td>è‡ªåŠ¨ï¼ˆå“åº”å¼è¿½è¸ªï¼‰</td><td>æ‰‹åŠ¨ï¼ˆ<code>React.memo</code>ï¼‰</td></tr><tr><td>è®¡ç®—ç¼“å­˜</td><td><code>computed</code>ï¼ˆè‡ªåŠ¨ä¾èµ–ï¼‰</td><td><code>useMemo</code>ï¼ˆæ‰‹åŠ¨ä¾èµ–ï¼‰</td></tr><tr><td>å‡½æ•°ç¼“å­˜</td><td>ä¸éœ€è¦ï¼ˆæ–¹æ³•ç»‘å®šåœ¨å®ä¾‹ä¸Šï¼‰</td><td><code>useCallback</code>ï¼ˆé¿å…å­ç»„ä»¶é‡æ¸²æŸ“ï¼‰</td></tr><tr><td>ç»„ä»¶ä¿æ´»</td><td><code>&lt;keep-alive&gt;</code></td><td>æ— å†…ç½®ï¼Œéœ€ç¬¬ä¸‰æ–¹åº“</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-49">14. æ€»ç»“å¯¹ç…§è¡¨</h3>











































































<table><thead><tr><th>ç‰¹æ€§</th><th>Vue 2</th><th>React 18</th></tr></thead><tbody><tr><td><strong>ç»„ä»¶å®šä¹‰</strong></td><td>é€‰é¡¹å¼å¯¹è±¡</td><td>å‡½æ•° + Hooks</td></tr><tr><td><strong>å“åº”å¼</strong></td><td>è‡ªåŠ¨ï¼ˆdefinePropertyï¼‰</td><td>æ‰‹åŠ¨ï¼ˆsetStateï¼‰</td></tr><tr><td><strong>æ¨¡æ¿</strong></td><td>æ¨¡æ¿ + æŒ‡ä»¤</td><td>JSX</td></tr><tr><td><strong>çŠ¶æ€</strong></td><td><code>data()</code></td><td><code>useState</code></td></tr><tr><td><strong>è®¡ç®—å±æ€§</strong></td><td><code>computed</code></td><td><code>useMemo</code></td></tr><tr><td><strong>ä¾¦å¬</strong></td><td><code>watch</code></td><td><code>useEffect</code></td></tr><tr><td><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td><td>å¤šä¸ªé’©å­å‡½æ•°</td><td><code>useEffect</code> ç»Ÿä¸€</td></tr><tr><td><strong>çˆ¶å­é€šä¿¡</strong></td><td>props + $emit</td><td>props + å›è°ƒ</td></tr><tr><td><strong>è·¨å±‚çº§</strong></td><td>provide/inject</td><td>Context</td></tr><tr><td><strong>æ’æ§½</strong></td><td>slot</td><td>children / render props</td></tr><tr><td><strong>æ€§èƒ½ä¼˜åŒ–</strong></td><td>æ¡†æ¶è‡ªåŠ¨ä¼˜åŒ–å¤š</td><td>å¼€å‘è€…æ‰‹åŠ¨ä¼˜åŒ–å¤š</td></tr><tr><td><strong>å¹¶å‘</strong></td><td>æ— </td><td>Concurrent Mode</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>å¹³ç¼“</td><td>é™¡å³­ï¼ˆHooks å¿ƒæ™ºæ¨¡å‹ï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-50">15. è¿ç§»å»ºè®®</h3>
<p>ä» Vue 2 è½¬ React 18ï¼Œé‡ç‚¹è½¬å˜æ€ç»´ï¼š</p>
<h4 data-id="heading-51">15.1 ä»"å“åº”å¼"åˆ°"ä¸å¯å˜"</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Vueï¼šç›´æ¥ä¿®æ”¹</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">push</span>(item)

<span class="hljs-comment">// Reactï¼šåˆ›å»ºæ–°æ•°ç»„</span>
<span class="hljs-title function_">setList</span>([...list, item])
</code></pre>
<h4 data-id="heading-52">15.2 ä»"è‡ªåŠ¨ä¾èµ–"åˆ°"æ‰‹åŠ¨å£°æ˜"</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Vueï¼šcomputed è‡ªåŠ¨è¿½è¸ªä¾èµ–</span>
<span class="hljs-attr">computed</span>: {
  <span class="hljs-title function_">fullName</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstName</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastName</span>
  }
}

<span class="hljs-comment">// Reactï¼šuseMemo å¿…é¡»æ‰‹åŠ¨å†™ä¾èµ–æ•°ç»„</span>
<span class="hljs-keyword">const</span> fullName = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> firstName + lastName
}, [firstName, lastName])
</code></pre>
<h4 data-id="heading-53">15.3 ä»"å®ä¾‹æ–¹æ³•"åˆ°"é—­åŒ…å‡½æ•°"</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Vueï¼šthis.handleClick å§‹ç»ˆæ˜¯åŒä¸€ä¸ªå‡½æ•°</span>
<span class="hljs-attr">methods</span>: {
  <span class="hljs-title function_">handleClick</span>(<span class="hljs-params"/>) { ... }
}

<span class="hljs-comment">// Reactï¼šæ¯æ¬¡æ¸²æŸ“ handleClick éƒ½æ˜¯æ–°å‡½æ•°ï¼ˆéœ€è¦ useCallback ä¼˜åŒ–ï¼‰</span>
<span class="hljs-keyword">const</span> handleClick = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">doSomething</span>(a, b)
}, [a, b])
</code></pre>
<h4 data-id="heading-54">15.4 ä»"æ¨¡æ¿æŒ‡ä»¤"åˆ°"JS è¡¨è¾¾å¼"</h4>





















<table><thead><tr><th>Vue 2</th><th>React 18</th></tr></thead><tbody><tr><td><code>v-if="show"</code></td><td><code>{show &amp;&amp; &lt;Component /&gt;}</code></td></tr><tr><td><code>v-for="item in list"</code></td><td><code>{list.map(item =&gt; ...)}</code></td></tr><tr><td><code>v-model="value"</code></td><td><code>value={value} onChange={...}</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-55">é™„å½•ï¼šå¸¸ç”¨ Hooks é€ŸæŸ¥</h3>




























































<table><thead><tr><th>Hook</th><th>ç”¨é€”</th><th>Vue 2 å¯¹åº”</th></tr></thead><tbody><tr><td><code>useState</code></td><td>çŠ¶æ€ç®¡ç†</td><td><code>data</code></td></tr><tr><td><code>useEffect</code></td><td>å‰¯ä½œç”¨å¤„ç†</td><td><code>mounted</code> / <code>watch</code> / <code>beforeDestroy</code></td></tr><tr><td><code>useMemo</code></td><td>è®¡ç®—ç¼“å­˜</td><td><code>computed</code></td></tr><tr><td><code>useCallback</code></td><td>å‡½æ•°ç¼“å­˜</td><td>æ— ï¼ˆVue ä¸éœ€è¦ï¼‰</td></tr><tr><td><code>useRef</code></td><td>å¼•ç”¨ DOM / ä¿å­˜å¯å˜å€¼</td><td><code>$refs</code> / å®ä¾‹å±æ€§</td></tr><tr><td><code>useContext</code></td><td>è·¨å±‚çº§çŠ¶æ€</td><td><code>inject</code></td></tr><tr><td><code>useReducer</code></td><td>å¤æ‚çŠ¶æ€é€»è¾‘</td><td>Vuex mutations</td></tr><tr><td><code>useLayoutEffect</code></td><td>åŒæ­¥å‰¯ä½œç”¨</td><td><code>mounted</code>ï¼ˆåŒæ­¥éƒ¨åˆ†ï¼‰</td></tr><tr><td><code>useTransition</code></td><td>å¹¶å‘æ›´æ–°</td><td>æ— </td></tr><tr><td><code>useDeferredValue</code></td><td>å»¶è¿Ÿæ›´æ–°</td><td>æ— </td></tr></tbody></table>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android Lifecycle å®Œå…¨æŒ‡å—ï¼šä»è®¾è®¡åŸç†åˆ°ç”Ÿäº§å®è·µ]]></title>    <link>https://juejin.cn/post/7579190764770377768</link>    <guid>https://juejin.cn/post/7579190764770377768</guid>    <pubDate>2025-12-03T02:30:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579190764770377768" data-draft-id="7579093990694420515" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android Lifecycle å®Œå…¨æŒ‡å—ï¼šä»è®¾è®¡åŸç†åˆ°ç”Ÿäº§å®è·µ"/> <meta itemprop="keywords" content="Android,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-03T02:30:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é’è²843"/> <meta itemprop="url" content="https://juejin.cn/user/541408646929991"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android Lifecycle å®Œå…¨æŒ‡å—ï¼šä»è®¾è®¡åŸç†åˆ°ç”Ÿäº§å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/541408646929991/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é’è²843
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:30:14.000Z" title="Wed Dec 03 2025 02:30:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ·±åº¦è§£æ + é¢è¯•è¦ç‚¹ + æœ€ä½³å®è·µï¼ŒæŒæ¡ç°ä»£ Android æ¶æ„åŸºçŸ³</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€ï¼šæ¶æ„æ¼”è¿›çš„å¿…ç„¶é€‰æ‹©</h2>
<p>åœ¨ Android å¼€å‘çš„æ¼”è¿›å†ç¨‹ä¸­ï¼Œ<strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>å§‹ç»ˆæ˜¯å¼€å‘è€…é¢ä¸´çš„æ ¸å¿ƒæŒ‘æˆ˜ä¹‹ä¸€ã€‚ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼è¦æ±‚æˆ‘ä»¬åœ¨ Activity å’Œ Fragment çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒä¸­æ‰‹åŠ¨ç®¡ç†å„ç§ç»„ä»¶çŠ¶æ€ï¼Œè¿™ç§æ¨¡å¼å¯¼è‡´äº†ï¼š</p>
<ul>
<li><strong>ä»£ç é«˜åº¦è€¦åˆ</strong>ï¼šä¸šåŠ¡é€»è¾‘ä¸ UI æ§åˆ¶å™¨ç´§å¯†ç»‘å®š</li>
<li><strong>å†…å­˜æ³„æ¼é¢‘å‘</strong>ï¼šå¿˜è®°åœ¨é€‚å½“æ—¶æœºé‡Šæ”¾èµ„æº</li>
<li><strong>çŠ¶æ€ç®¡ç†æ··ä¹±</strong>ï¼šé…ç½®å˜æ›´ã€å¼‚å¸¸æ¢å¤ç­‰åœºæ™¯å¤„ç†å¤æ‚</li>
</ul>
<p>éšç€åº”ç”¨å¤æ‚åº¦çš„æå‡ï¼ŒGoogle æ¨å‡ºäº† Android Jetpack ç»„ä»¶åº“ï¼Œå…¶ä¸­Â <strong>Lifecycle</strong>Â ä½œä¸ºæ¶æ„åŸºçŸ³ï¼Œé€šè¿‡<strong>è§‚å¯Ÿè€…æ¨¡å¼ + çŠ¶æ€æœº</strong>çš„ä¼˜é›…è®¾è®¡ï¼Œå½»åº•æ”¹å˜äº†æˆ‘ä»¬å¤„ç†ç”Ÿå‘½å‘¨æœŸçš„æ–¹å¼ã€‚</p>
<h2 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ¸å¿ƒæ¦‚å¿µæ·±åº¦è§£æ</h2>
<h3 data-id="heading-2">1.1 è®¾è®¡å“²å­¦ï¼šå…³æ³¨ç‚¹åˆ†ç¦»</h3>
<p><strong>ä¼ ç»Ÿæ¨¡å¼çš„é—®é¢˜ä»£ç ï¼š</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TraditionalActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> locationTracker: LocationTracker
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> audioPlayer: AudioPlayer
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> dataSync: DataSyncer

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onStart()
        locationTracker.start()  <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘å…¥ä¾µç”Ÿå‘½å‘¨æœŸ</span>
        audioPlayer.resume()
        dataSync.beginSync()
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStop</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onStop()
        <span class="hljs-comment">// å®¹æ˜“å¿˜è®°è°ƒç”¨æŸäº›æ–¹æ³•ï¼</span>
        locationTracker.stop()
        audioPlayer.pause()
        <span class="hljs-comment">// dataSync.endSync() è¢«é—æ¼ â†’ å†…å­˜æ³„æ¼ï¼</span>
    }
}
</code></pre>
<p><strong>Lifecycle çš„è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ModernActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        <span class="hljs-comment">// ä¸€è¡Œæ³¨å†Œï¼Œè‡ªåŠ¨ç®¡ç†</span>
        lifecycle.addObserver(LocationTracker())
        lifecycle.addObserver(AudioPlayer())
        lifecycle.addObserver(DataSyncer())
    }
    <span class="hljs-comment">// ä¸å†éœ€è¦è¦†å†™ onStart/onStop ç­‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼</span>
}
</code></pre>
<h3 data-id="heading-3">1.2 æ¶æ„è®¾è®¡ï¼šè§‚å¯Ÿè€…æ¨¡å¼ + çŠ¶æ€æœº</h3>
<p>Lifecycle çš„æ ¸å¿ƒæ¶æ„åŒ…å«ä¸‰ä¸ªå…³é”®è§’è‰²ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e12fa31d7934b749c4728945cc959ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6I6yODQz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765333814&amp;x-signature=Avm%2FHZ3FWEVY4u%2BXi7EuYtNTVi4%3D" alt="deepseek_mermaid_20251203_ca472a.png" loading="lazy"/></p>
<h3 data-id="heading-4">1.3 çŠ¶æ€ä¸äº‹ä»¶ï¼šç²¾ç¡®çš„ç”Ÿå‘½å‘¨æœŸå»ºæ¨¡</h3>
<p>Lifecycle å°†ç”Ÿå‘½å‘¨æœŸæŠ½è±¡ä¸ºÂ <strong>çŠ¶æ€ï¼ˆStateï¼‰</strong> Â å’ŒÂ <strong>äº‹ä»¶ï¼ˆEventï¼‰</strong> Â ä¸¤ä¸ªç»´åº¦ï¼š</p>
<p><strong>çŠ¶æ€è½¬ç§»å›¾ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2696f2dbb3454b33891a71acc27dad96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6I6yODQz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765333814&amp;x-signature=W1Yj8HvnEF7EMTvAeqwvKF%2FnDPk%3D" alt="deepseek_mermaid_20251203_0115ed.png" loading="lazy"/></p>
<p><strong>çŠ¶æ€ä¸äº‹ä»¶çš„å¯¹åº”å…³ç³»è¡¨ï¼š</strong></p>





















































<table><thead><tr><th>ç”Ÿå‘½å‘¨æœŸçŠ¶æ€</th><th>è§¦å‘äº‹ä»¶</th><th>ç³»ç»Ÿå›è°ƒ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>INITIALIZED</strong></td><td>-</td><td>-</td><td>å¯¹è±¡å·²åˆ›å»ºä½†æœªæ”¶åˆ° onCreate</td></tr><tr><td><strong>CREATED</strong></td><td>ON_CREATE</td><td>onCreate()</td><td>åœ¨ onCreate åï¼Œæˆ– onStop å‰</td></tr><tr><td><strong>CREATED</strong></td><td>ON_STOP</td><td>onStop()</td><td>è¿›å…¥åå°ç¨³å®šçŠ¶æ€</td></tr><tr><td><strong>STARTED</strong></td><td>ON_START</td><td>onStart()</td><td>å¯è§ä½†æœªè·å¾—ç„¦ç‚¹</td></tr><tr><td><strong>STARTED</strong></td><td>ON_PAUSE</td><td>onPause()</td><td>å¤±å»ç„¦ç‚¹ä½†ä»éƒ¨åˆ†å¯è§</td></tr><tr><td><strong>RESUMED</strong></td><td>ON_RESUME</td><td>onResume()</td><td>è·å¾—ç„¦ç‚¹ï¼Œå®Œå…¨äº¤äº’çŠ¶æ€</td></tr><tr><td><strong>DESTROYED</strong></td><td>ON_DESTROY</td><td>onDestroy()</td><td>æœ€ç»ˆé”€æ¯çŠ¶æ€</td></tr></tbody></table>
<h3 data-id="heading-5">1.4 ä¸‰ç§è§‚å¯Ÿè€…æ¨¡å¼å¯¹æ¯”</h3>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ç§æ–¹å¼å®ç°ç”Ÿå‘½å‘¨æœŸè§‚å¯Ÿè€…ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ========== æ–¹å¼ä¸€ï¼šDefaultLifecycleObserverï¼ˆæ¨èï¼‰ ==========</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DefaultObserver</span> : <span class="hljs-type">DefaultLifecycleObserver</span> {
    <span class="hljs-comment">// ä¼˜ç‚¹ï¼šç±»å‹å®‰å…¨ã€ç¼–è¯‘æ—¶æ£€æŸ¥ã€æ€§èƒ½æœ€ä½³</span>
    <span class="hljs-comment">// ç¼ºç‚¹ï¼šéœ€è¦ AndroidX lifecycle-common-java8 ä¾èµ–</span>
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        Log.d(<span class="hljs-string">"Observer"</span>, <span class="hljs-string">"onCreate called"</span>)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        Log.d(<span class="hljs-string">"Observer"</span>, <span class="hljs-string">"onStart called"</span>)
    }
    
    <span class="hljs-comment">// å…¶ä»–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•...</span>
}

<span class="hljs-comment">// ========== æ–¹å¼äºŒï¼šLifecycleEventObserverï¼ˆçµæ´»ï¼‰ ==========</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventObserver</span> : <span class="hljs-type">LifecycleEventObserver</span> {
    <span class="hljs-comment">// ä¼˜ç‚¹ï¼šç»Ÿä¸€å¤„ç†æ‰€æœ‰äº‹ä»¶ï¼Œçµæ´»æ€§é«˜</span>
    <span class="hljs-comment">// ç¼ºç‚¹ï¼šéœ€è¦æ‰‹åŠ¨åˆ¤æ–­äº‹ä»¶ç±»å‹</span>
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
        <span class="hljs-keyword">when</span> (event) {
            Lifecycle.Event.ON_CREATE -&gt; <span class="hljs-keyword">init</span>()
            Lifecycle.Event.ON_START -&gt; start()
            Lifecycle.Event.ON_RESUME -&gt; resume()
            Lifecycle.Event.ON_PAUSE -&gt; pause()
            Lifecycle.Event.ON_STOP -&gt; stop()
            Lifecycle.Event.ON_DESTROY -&gt; destroy()
            Lifecycle.Event.ON_ANY -&gt; {
                <span class="hljs-comment">// ä»»ä½•äº‹ä»¶éƒ½ä¼šè§¦å‘</span>
            }
        }
    }
}

<span class="hljs-comment">// ========== æ–¹å¼ä¸‰ï¼šæ³¨è§£æ–¹å¼ï¼ˆå·²åºŸå¼ƒï¼‰ ==========</span>
<span class="hljs-meta">@Deprecated(<span class="hljs-string">"ä½¿ç”¨æ¥å£æ–¹å¼æ›¿ä»£"</span>)</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnnotationObserver</span> : <span class="hljs-type">LifecycleObserver</span> {
    <span class="hljs-comment">// âŒ å·²åºŸå¼ƒï¼ä¸æ¨èä½¿ç”¨</span>
    <span class="hljs-comment">// é—®é¢˜ï¼šä¾èµ–åå°„æˆ–æ³¨è§£å¤„ç†ï¼Œæ€§èƒ½å·®ï¼Œå®¹æ˜“å‡ºé”™</span>
    
    <span class="hljs-meta">@OnLifecycleEvent(Lifecycle.Event.ON_CREATE)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">customOnCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// é€šè¿‡åå°„è°ƒç”¨</span>
    }
}
</code></pre>
<p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>
<ul>
<li>æ–°é¡¹ç›®ï¼š<strong>DefaultLifecycleObserver</strong></li>
<li>éœ€è¦ç»Ÿä¸€äº‹ä»¶å¤„ç†ï¼š<strong>LifecycleEventObserver</strong></li>
<li>æ—§é¡¹ç›®è¿ç§»ï¼šé€æ­¥æ›¿æ¢æ³¨è§£æ–¹å¼</li>
</ul>
<h2 data-id="heading-6">ç¬¬äºŒéƒ¨åˆ†ï¼šæºç å®ç°æœºåˆ¶å‰–æ</h2>
<h3 data-id="heading-7">2.1 ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„é­”æ³•ï¼šReportFragment</h3>
<p>Lifecycle å¦‚ä½•åœ¨ä¸ä¿®æ”¹ Activity æºç çš„æƒ…å†µä¸‹æ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸï¼Ÿç§˜å¯†åœ¨äºÂ <strong>ReportFragment</strong>ï¼š</p>
<p>java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ComponentActivity çš„ onCreate æ–¹æ³•</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ComponentActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Activity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">LifecycleOwner</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">LifecycleRegistry</span> <span class="hljs-variable">mLifecycleRegistry</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LifecycleRegistry</span>(<span class="hljs-built_in">this</span>);
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        
        <span class="hljs-comment">// å…³é”®ï¼šæ³¨å…¥ ReportFragment</span>
        ReportFragment.injectIfNeededIn(<span class="hljs-built_in">this</span>);
    }
}

<span class="hljs-comment">// ReportFragment çš„æ ¸å¿ƒæœºåˆ¶</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReportFragment</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Fragment</span> {
    
    <span class="hljs-comment">// å…¼å®¹ä¸åŒ API ç‰ˆæœ¬çš„å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">injectIfNeededIn</span><span class="hljs-params">(Activity activity)</span> {
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="hljs-number">29</span>) {
            <span class="hljs-comment">// Android 10+ï¼šä½¿ç”¨ ActivityLifecycleCallbacksï¼ˆæ›´é«˜æ•ˆï¼‰</span>
            activity.registerActivityLifecycleCallbacks(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LifecycleCallbacks</span>());
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// Android 10 ä»¥ä¸‹ï¼šæ·»åŠ æ— ç•Œé¢ Fragmentï¼ˆå…¼å®¹æ–¹æ¡ˆï¼‰</span>
            android.app.<span class="hljs-type">FragmentManager</span> <span class="hljs-variable">manager</span> <span class="hljs-operator">=</span> activity.getFragmentManager();
            <span class="hljs-keyword">if</span> (manager.findFragmentByTag(<span class="hljs-string">"androidx.lifecycle.LifecycleDispatcher"</span>) == <span class="hljs-literal">null</span>) {
                manager.beginTransaction()
                    .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ReportFragment</span>(), <span class="hljs-string">"androidx.lifecycle.LifecycleDispatcher"</span>)
                    .commit();
                manager.executePendingTransactions();
            }
        }
    }
    
    <span class="hljs-comment">// Fragment ç”Ÿå‘½å‘¨æœŸä¸ Activity åŒæ­¥</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onStart</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onStart();
        dispatch(Lifecycle.Event.ON_START);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onResume</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onResume();
        dispatch(Lifecycle.Event.ON_RESUME);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispatch</span><span class="hljs-params">(Lifecycle.Event event)</span> {
        <span class="hljs-keyword">if</span> (getActivity() <span class="hljs-keyword">instanceof</span> LifecycleOwner) {
            <span class="hljs-type">Lifecycle</span> <span class="hljs-variable">lifecycle</span> <span class="hljs-operator">=</span> ((LifecycleOwner) getActivity()).getLifecycle();
            <span class="hljs-keyword">if</span> (lifecycle <span class="hljs-keyword">instanceof</span> LifecycleRegistry) {
                <span class="hljs-comment">// äº‹ä»¶ä¼ é€’åˆ° LifecycleRegistry</span>
                ((LifecycleRegistry) lifecycle).handleLifecycleEvent(event);
            }
        }
    }
    
    <span class="hljs-comment">// Android 10+ çš„æ›¿ä»£æ–¹æ¡ˆ</span>
    <span class="hljs-meta">@RequiresApi(29)</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LifecycleCallbacks</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ActivityLifecycleCallbacks</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityPostCreated</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Activity activity, 
                                          <span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
            dispatch(activity, Lifecycle.Event.ON_CREATE);
        }
        <span class="hljs-comment">// ... å…¶ä»–å›è°ƒæ–¹æ³•</span>
    }
}
</code></pre>
<h3 data-id="heading-8">2.2 çŠ¶æ€åŒæ­¥å¼•æ“ï¼šLifecycleRegistry</h3>
<p><code>LifecycleRegistry</code>Â æ˜¯ Lifecycle æ¡†æ¶çš„å¤§è„‘ï¼Œè´Ÿè´£ç®¡ç†çŠ¶æ€å’Œåˆ†å‘äº‹ä»¶ï¼š</p>
<p>java</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">LifecycleRegistry</span> <span class="hljs-title">extends</span> <span class="hljs-title">Lifecycle</span> {
    
    <span class="hljs-comment">// æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šæ”¯æŒå®‰å…¨éå†çš„ Map</span>
    <span class="hljs-keyword">private</span> FastSafeIterableMap&lt;LifecycleObserver, ObserverWithState&gt; mObserverMap;
    <span class="hljs-keyword">private</span> State mState = INITIALIZED;
    <span class="hljs-keyword">private</span> final WeakReference&lt;LifecycleOwner&gt; mLifecycleOwner;
    
    <span class="hljs-comment">// äº‹ä»¶å¤„ç†å…¥å£</span>
    @Override
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleLifecycleEvent</span>(<span class="hljs-params">@NonNull Lifecycle.Event <span class="hljs-keyword">event</span></span>)</span> {
        <span class="hljs-comment">// 1. è®¡ç®—ä¸‹ä¸€ä¸ªçŠ¶æ€</span>
        State next = getStateAfter(<span class="hljs-keyword">event</span>);
        
        <span class="hljs-comment">// 2. æ›´æ–°å½“å‰çŠ¶æ€</span>
        mState = next;
        
        <span class="hljs-comment">// 3. åŒæ­¥æ‰€æœ‰è§‚å¯Ÿè€…</span>
        sync();
    }
    
    <span class="hljs-comment">// çŠ¶æ€è®¡ç®—é€»è¾‘</span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> State <span class="hljs-title">getStateAfter</span>(<span class="hljs-params">Event <span class="hljs-keyword">event</span></span>)</span> {
        <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">event</span>) {
            <span class="hljs-keyword">case</span> ON_CREATE:
            <span class="hljs-keyword">case</span> ON_STOP:
                <span class="hljs-keyword">return</span> CREATED;
            <span class="hljs-keyword">case</span> ON_START:
            <span class="hljs-keyword">case</span> ON_PAUSE:
                <span class="hljs-keyword">return</span> STARTED;
            <span class="hljs-keyword">case</span> ON_RESUME:
                <span class="hljs-keyword">return</span> RESUMED;
            <span class="hljs-keyword">case</span> ON_DESTROY:
                <span class="hljs-keyword">return</span> DESTROYED;
            <span class="hljs-keyword">case</span> ON_ANY:
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"ON_ANY must not been send by anybody"</span>);
        }
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"Unexpected event value "</span> + <span class="hljs-keyword">event</span>);
    }
    
    <span class="hljs-comment">// ğŸ”¥ å…³é”®ï¼šåŒæ­¥ç®—æ³•ï¼ˆé¢è¯•å¸¸è€ƒç‚¹ï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sync</span>()</span> {
        LifecycleOwner lifecycleOwner = mLifecycleOwner.<span class="hljs-keyword">get</span>();
        <span class="hljs-keyword">if</span> (lifecycleOwner == <span class="hljs-literal">null</span>) {
            Log.w(LOG_TAG, <span class="hljs-string">"LifecycleOwner is garbage collected. Skipping sync."</span>);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// å¾ªç¯ç›´åˆ°æ‰€æœ‰è§‚å¯Ÿè€…åŒæ­¥</span>
        <span class="hljs-keyword">while</span> (!isSynced()) {
            mNewEventOccurred = <span class="hljs-literal">false</span>;
            
            <span class="hljs-comment">// æƒ…å†µ1ï¼šéœ€è¦å‘åå›é€€çŠ¶æ€</span>
            <span class="hljs-keyword">if</span> (mState.compareTo(mObserverMap.eldest().getValue().mState) &lt; <span class="hljs-number">0</span>) {
                backwardPass(lifecycleOwner);
            }
            
            <span class="hljs-comment">// æƒ…å†µ2ï¼šéœ€è¦å‘å‰æ¨è¿›çŠ¶æ€</span>
            Map.Entry&lt;LifecycleObserver, ObserverWithState&gt; newest = mObserverMap.newest();
            <span class="hljs-keyword">if</span> (!mNewEventOccurred &amp;&amp; newest != <span class="hljs-literal">null</span> 
                    &amp;&amp; mState.compareTo(newest.getValue().mState) &gt; <span class="hljs-number">0</span>) {
                forwardPass(lifecycleOwner);
            }
            
            <span class="hljs-comment">// ğŸ”¥ å…³é”®ç†è§£ç‚¹ï¼šä¸ºä»€ä¹ˆéœ€è¦å¾ªç¯ï¼Ÿ</span>
            <span class="hljs-comment">// å› ä¸ºåœ¨ backwardPass/forwardPass è¿‡ç¨‹ä¸­ï¼Œ</span>
            <span class="hljs-comment">// å¯èƒ½æœ‰æ–°çš„äº‹ä»¶å‘ç”Ÿæˆ–æ–°çš„è§‚å¯Ÿè€…è¢«æ·»åŠ </span>
            <span class="hljs-keyword">if</span> (mNewEventOccurred) {
                <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// é‡æ–°å¼€å§‹åŒæ­¥è¿‡ç¨‹</span>
            }
        }
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆÂ <code>sync()</code>Â æ–¹æ³•éœ€è¦å¾ªç¯ï¼Ÿ</strong><br/>
è¿™æ˜¯é¢è¯•ä¸­çš„é«˜é¢‘é—®é¢˜ã€‚è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼š</p>
<ol>
<li>åœ¨åˆ†å‘Â <code>ON_STOP</code>Â äº‹ä»¶æ—¶ï¼ŒæŸä¸ªè§‚å¯Ÿè€…çš„Â <code>onStop</code>Â å›è°ƒä¸­åˆæ³¨å†Œäº†æ–°çš„è§‚å¯Ÿè€…</li>
<li>æ–°è§‚å¯Ÿè€…éœ€è¦ä»åˆå§‹çŠ¶æ€è¿½èµ¶å½“å‰çŠ¶æ€</li>
<li>å¦‚æœä¸å¾ªç¯ï¼Œæ–°è§‚å¯Ÿè€…å°†é”™è¿‡ä¸€äº›äº‹ä»¶</li>
<li>å¾ªç¯ç¡®ä¿åœ¨ä¸€æ¬¡å¤–éƒ¨äº‹ä»¶å¤„ç†ä¸­ï¼Œæ‰€æœ‰è§‚å¯Ÿè€…æœ€ç»ˆè¾¾åˆ°ä¸€è‡´çŠ¶æ€</li>
</ol>
<h3 data-id="heading-9">2.3 è§‚å¯Ÿè€…é€‚é…å™¨ï¼šç»Ÿä¸€æ¥å£å¤„ç†</h3>
<p>Lifecycle éœ€è¦å¤„ç†ä¸åŒç±»å‹çš„è§‚å¯Ÿè€…ï¼ˆæ³¨è§£ã€æ¥å£ç­‰ï¼‰ï¼Œè¿™æ˜¯é€šè¿‡Â <code>Lifecycling</code>Â é€‚é…å™¨å·¥å‚å®ç°çš„ï¼š</p>
<p>java</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Lifecycling</span> {
    
    <span class="hljs-meta">@NonNull</span>
    <span class="hljs-keyword">static</span> <span class="hljs-title class_">LifecycleEventObserver</span> <span class="hljs-title function_">lifecycleEventObserver</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span> <span class="hljs-built_in">object</span></span>) {
        <span class="hljs-comment">// æƒ…å†µ1ï¼šåŒæ—¶å®ç° FullLifecycleObserver å’Œ LifecycleEventObserver</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">object</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">FullLifecycleObserver</span> 
                &amp;&amp; <span class="hljs-built_in">object</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">LifecycleEventObserver</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FullLifecycleObserverAdapter</span>(
                (<span class="hljs-title class_">FullLifecycleObserver</span>) <span class="hljs-built_in">object</span>, 
                (<span class="hljs-title class_">LifecycleEventObserver</span>) <span class="hljs-built_in">object</span>
            );
        }
        
        <span class="hljs-comment">// æƒ…å†µ2ï¼šåªå®ç° FullLifecycleObserverï¼ˆå¦‚ DefaultLifecycleObserverï¼‰</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">object</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">FullLifecycleObserver</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FullLifecycleObserverAdapter</span>(
                (<span class="hljs-title class_">FullLifecycleObserver</span>) <span class="hljs-built_in">object</span>, 
                <span class="hljs-literal">null</span>
            );
        }
        
        <span class="hljs-comment">// æƒ…å†µ3ï¼šåªå®ç° LifecycleEventObserver</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">object</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">LifecycleEventObserver</span>) {
            <span class="hljs-keyword">return</span> (<span class="hljs-title class_">LifecycleEventObserver</span>) <span class="hljs-built_in">object</span>;
        }
        
        <span class="hljs-comment">// æƒ…å†µ4ï¼šæ³¨è§£æ–¹å¼ï¼ˆå·²åºŸå¼ƒï¼‰</span>
        final <span class="hljs-title class_">Class</span>&lt;?&gt; klass = <span class="hljs-built_in">object</span>.<span class="hljs-title function_">getClass</span>();
        int <span class="hljs-keyword">type</span> = <span class="hljs-title function_">getObserverConstructorType</span>(klass);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> == <span class="hljs-variable constant_">GENERATED_CALLBACK</span>) {
            <span class="hljs-comment">// ä½¿ç”¨ APT ç”Ÿæˆçš„é€‚é…å™¨</span>
            <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Constructor</span>&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">GeneratedAdapter</span>&gt;&gt; constructors = 
                sClassToAdapters.<span class="hljs-title function_">get</span>(klass);
            <span class="hljs-title class_">GeneratedAdapter</span>[] adapters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GeneratedAdapter</span>[constructors.<span class="hljs-title function_">size</span>()];
            <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; constructors.<span class="hljs-title function_">size</span>(); i++) {
                adapters[i] = <span class="hljs-title function_">createGeneratedAdapter</span>(constructors.<span class="hljs-title function_">get</span>(i), <span class="hljs-built_in">object</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompositeGeneratedAdaptersObserver</span>(adapters);
        }
        
        <span class="hljs-comment">// æƒ…å†µ5ï¼šåå°„æ–¹å¼ï¼ˆå…¼å®¹æ—§ä»£ç ï¼Œæ€§èƒ½æœ€å·®ï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectiveGenericLifecycleObserver</span>(<span class="hljs-built_in">object</span>);
    }
}
</code></pre>
<h3 data-id="heading-10">2.4 æ³¨å†Œæ—¶çš„çŠ¶æ€è¿½èµ¶æœºåˆ¶</h3>
<p>å½“æ–°è§‚å¯Ÿè€…æ³¨å†Œæ—¶ï¼Œå¦‚æœå®¿ä¸»å·²ç»å¤„äºæŸä¸ªçŠ¶æ€ï¼Œè§‚å¯Ÿè€…éœ€è¦å¿«é€Ÿ"è¿½èµ¶"åˆ°è¿™ä¸ªçŠ¶æ€ï¼š</p>
<p>java</p>
<pre><code class="hljs language-ini" lang="ini">@Override
public void addObserver(@NonNull LifecycleObserver observer) {
    // åˆå§‹çŠ¶æ€ï¼šå¦‚æœå®¿ä¸»å·²é”€æ¯ï¼Œè§‚å¯Ÿè€…ç›´æ¥è¿›å…¥ DESTROYED
    State <span class="hljs-attr">initialState</span> = mState == DESTROYED ? DESTROYED : INITIALIZED<span class="hljs-comment">;</span>
    
    ObserverWithState <span class="hljs-attr">statefulObserver</span> = new ObserverWithState(observer, initialState)<span class="hljs-comment">;</span>
    ObserverWithState <span class="hljs-attr">previous</span> = mObserverMap.putIfAbsent(observer, statefulObserver)<span class="hljs-comment">;</span>
    
    if (previous != null) {
        return<span class="hljs-comment">; // å·²ç»æ³¨å†Œè¿‡</span>
    }
    
    LifecycleOwner <span class="hljs-attr">lifecycleOwner</span> = mLifecycleOwner.get()<span class="hljs-comment">;</span>
    if (<span class="hljs-attr">lifecycleOwner</span> == null) {
        return<span class="hljs-comment">;</span>
    }
    
    // å…³é”®ï¼šçŠ¶æ€è¿½èµ¶é€»è¾‘
    boolean <span class="hljs-attr">isReentrance</span> = mAddingObserverCounter != <span class="hljs-number">0</span> || mHandlingEvent<span class="hljs-comment">;</span>
    State <span class="hljs-attr">targetState</span> = calculateTargetState(observer)<span class="hljs-comment">;</span>
    mAddingObserverCounter++<span class="hljs-comment">;</span>
    
    // ä¸ºæ–°è§‚å¯Ÿè€…è¡¥å‘é—æ¼çš„äº‹ä»¶
    while (statefulObserver.mState.compareTo(targetState) &lt; 0
            &amp;&amp; mObserverMap.contains(observer)) {
        pushParentState(statefulObserver.mState)<span class="hljs-comment">;</span>
        Event <span class="hljs-attr">event</span> = Event.upFrom(statefulObserver.mState)<span class="hljs-comment">;</span>
        if (<span class="hljs-attr">event</span> == null) {
            throw new IllegalStateException("no event up from " + statefulObserver.mState)<span class="hljs-comment">;</span>
        }
        statefulObserver.dispatchEvent(lifecycleOwner, event)<span class="hljs-comment">;</span>
        popParentState()<span class="hljs-comment">;</span>
        
        // é‡æ–°è®¡ç®—ç›®æ ‡çŠ¶æ€ï¼ˆå¯èƒ½ä¸­é€”æœ‰å˜åŒ–ï¼‰
        <span class="hljs-attr">targetState</span> = calculateTargetState(observer)<span class="hljs-comment">;</span>
    }
    
    if (!isReentrance) {
        sync()<span class="hljs-comment">; // æœ€ç»ˆåŒæ­¥</span>
    }
    mAddingObserverCounter--<span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-11">ç¬¬ä¸‰éƒ¨åˆ†ï¼šä¸åç¨‹çš„æ·±åº¦é›†æˆ</h2>
<h3 data-id="heading-12">3.1 ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„åç¨‹ä½œç”¨åŸŸ</h3>
<p>åœ¨ç°ä»£ Android å¼€å‘ä¸­ï¼ŒKotlin åç¨‹å·²æˆä¸ºå¼‚æ­¥å¤„ç†çš„æ ‡å‡†ã€‚Lifecycle æä¾›äº†ä¸åç¨‹æ·±åº¦é›†æˆçš„èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-13">3.1.1 å…³é”®æ¦‚å¿µå¯¹æ¯”</h4>















































<table><thead><tr><th>æ¦‚å¿µ</th><th>å®¿ä¸»å¯¹è±¡</th><th>é”€æ¯æ—¶æœº</th><th>å†…å­˜å®‰å…¨</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong><code>lifecycle</code></strong></td><td>LifecycleOwner</td><td>ä¸é€‚ç”¨</td><td>ä¸é€‚ç”¨</td><td>æ·»åŠ æ™®é€šè§‚å¯Ÿè€…</td></tr><tr><td><strong><code>lifecycleScope</code></strong></td><td>Activity/Fragment å®ä¾‹</td><td>å®¿ä¸»å®Œå…¨é”€æ¯æ—¶</td><td>â­â­â­â­</td><td>Activity æˆ– Fragment çš„é UI ä»»åŠ¡</td></tr><tr><td><strong><code>viewLifecycleOwner.lifecycleScope</code></strong></td><td>Fragment çš„è§†å›¾</td><td>è§†å›¾é”€æ¯æ—¶ (<code>onDestroyView</code>)</td><td>â­â­â­â­â­</td><td><strong>Fragment ä¸­çš„æ‰€æœ‰ UI ç›¸å…³ä»»åŠ¡</strong></td></tr><tr><td><strong><code>repeatOnLifecycle()</code></strong></td><td>æŒ‡å®šçš„ LifecycleOwner</td><td>ç¦»å¼€æŒ‡å®šçŠ¶æ€æ—¶å–æ¶ˆ</td><td>â­â­â­â­â­</td><td><strong>å®‰å…¨æ”¶é›† Flow</strong></td></tr><tr><td><strong><code>LifecycleCoroutineScope</code></strong></td><td>LifecycleOwner</td><td><code>ON_DESTROY</code>Â æ—¶å–æ¶ˆ</td><td>â­â­â­â­</td><td><code>lifecycleScope</code>Â çš„å†…éƒ¨å®ç°</td></tr></tbody></table>
<h4 data-id="heading-14">3.1.2 ç”Ÿå‘½å‘¨æœŸä½œç”¨åŸŸå·®å¼‚è¯¦è§£</h4>
<p><strong>Fragment ä¸­çš„å…³é”®åŒºåˆ«ï¼š</strong></p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ExampleFragment</span> : <span class="hljs-type">Fragment</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)
        
        <span class="hljs-comment">// âŒ å±é™©åšæ³•ï¼šä½¿ç”¨ Fragment çš„ lifecycleScope æ›´æ–° UI</span>
        lifecycleScope.launch {
            delay(<span class="hljs-number">3000</span>) <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span>
            <span class="hljs-comment">// æ­¤æ—¶è§†å›¾å¯èƒ½å·²è¢«é”€æ¯ï¼ˆå¦‚é…ç½®å˜æ›´ï¼‰</span>
            textView.text = <span class="hljs-string">"Loaded"</span> <span class="hljs-comment">// å¯èƒ½æŠ›å‡º IllegalStateException</span>
        }
        
        <span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨è§†å›¾çš„ lifecycleScope</span>
        viewLifecycleOwner.lifecycleScope.launch {
            delay(<span class="hljs-number">3000</span>)
            <span class="hljs-comment">// å¦‚æœè§†å›¾å·²è¢«é”€æ¯ï¼Œåç¨‹ä¼šè‡ªåŠ¨å–æ¶ˆï¼Œä¸ä¼šæ‰§è¡Œåˆ°è¿™é‡Œ</span>
            textView.text = <span class="hljs-string">"Loaded"</span> <span class="hljs-comment">// å®‰å…¨ï¼</span>
        }
        
        <span class="hljs-comment">// âœ… é UI ä»»åŠ¡å¯ä»¥ä½¿ç”¨ Fragment çš„ lifecycleScope</span>
        lifecycleScope.launch {
            <span class="hljs-comment">// åå°æ•°æ®åŒæ­¥ï¼Œå³ä½¿è§†å›¾é”€æ¯ä¹Ÿåº”ç»§ç»­</span>
            syncDataToServer()
        }
    }
}
</code></pre>
<p><strong>ç”Ÿå‘½å‘¨æœŸæ—¶é—´çº¿å¯¹æ¯”ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7117f42c753248b0b42eb8ca5c6345b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6I6yODQz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765333814&amp;x-signature=Z8dPdkm%2FamkLpN4bX3Gq2ezFYOU%3D" alt="deepseek_mermaid_20251203_95011d.png" loading="lazy"/></p>
<h3 data-id="heading-15">3.2 å®‰å…¨æ”¶é›† Flowï¼šrepeatOnLifecycle</h3>
<h4 data-id="heading-16">3.2.1 ä¼ ç»Ÿæ–¹å¼çš„ç¼ºé™·</h4>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âš ï¸ é—®é¢˜ä»£ç ï¼šä½¿ç”¨å·²åºŸå¼ƒçš„ launchWhenX</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ProblematicFragment</span> : <span class="hljs-type">Fragment</span>() {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: MyViewModel <span class="hljs-keyword">by</span> viewModels()
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)
        
        <span class="hljs-comment">// launchWhenStarted çš„é—®é¢˜ï¼š</span>
        lifecycleScope.launchWhenStarted {
            viewModel.dataFlow.collect { <span class="hljs-keyword">data</span> -&gt;
                updateUI(<span class="hljs-keyword">data</span>)
                <span class="hljs-comment">// å½“ Fragment è¿›å…¥åå°ï¼ˆonStopï¼‰æ—¶ï¼š</span>
                <span class="hljs-comment">// 1. åç¨‹è¢«æŒ‚èµ·ï¼ˆsuspendï¼‰</span>
                <span class="hljs-comment">// 2. ä½†ä¸Šæ¸¸ Flow ä»åœ¨ç”Ÿäº§æ•°æ®ï¼</span>
                <span class="hljs-comment">// 3. æµªè´¹ CPU å’Œå†…å­˜èµ„æº</span>
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-17">3.2.2 æ¨èæ–¹å¼ï¼šrepeatOnLifecycle</h4>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… æ­£ç¡®ä»£ç ï¼šä½¿ç”¨ repeatOnLifecycle</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CorrectFragment</span> : <span class="hljs-type">Fragment</span>() {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: MyViewModel <span class="hljs-keyword">by</span> viewModels()
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)
        
        viewLifecycleOwner.lifecycleScope.launch {
            <span class="hljs-comment">// åªåœ¨ç”Ÿå‘½å‘¨æœŸè‡³å°‘ä¸º STARTED æ—¶æ”¶é›† Flow</span>
            viewLifecycleOwner.repeatOnLifecycle(Lifecycle.State.STARTED) {
                viewModel.dataFlow.collect { <span class="hljs-keyword">data</span> -&gt;
                    updateUI(<span class="hljs-keyword">data</span>)
                    <span class="hljs-comment">// å½“ç”Ÿå‘½å‘¨æœŸä½äº STARTED æ—¶ï¼š</span>
                    <span class="hljs-comment">// 1. åç¨‹è¢«å–æ¶ˆï¼ˆcancelledï¼‰</span>
                    <span class="hljs-comment">// 2. Flow åœæ­¢æ”¶é›†ï¼ˆå› æ”¶é›†å™¨å–æ¶ˆï¼‰</span>
                    <span class="hljs-comment">// 3. èµ„æºè¢«æ­£ç¡®é‡Šæ”¾</span>
                }
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-18">3.2.3 ç®€æ´å†™æ³•ï¼šflowWithLifecycle</h4>
<p>kotlin</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ›´ç®€æ´çš„å†™æ³•</span>
viewLifecycleOwner<span class="hljs-selector-class">.lifecycleScope</span><span class="hljs-selector-class">.launch</span> {
    viewModel<span class="hljs-selector-class">.dataFlow</span>
        <span class="hljs-selector-class">.flowWithLifecycle</span>(viewLifecycleOwner.lifecycle, Lifecycle.State.STARTED)
        <span class="hljs-selector-class">.catch</span> { e -&gt; <span class="hljs-built_in">handleError</span>(e) } <span class="hljs-comment">// æ·»åŠ é”™è¯¯å¤„ç†</span>
        <span class="hljs-selector-class">.collect</span> { data -&gt; <span class="hljs-built_in">updateUI</span>(data) }
}
</code></pre>
<h4 data-id="heading-19">3.2.4 repeatOnLifecycle å†…éƒ¨åŸç†</h4>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç®€åŒ–ç‰ˆçš„å®ç°é€»è¾‘</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Lifecycle.<span class="hljs-title">repeatOnLifecycle</span><span class="hljs-params">(
    state: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">State</span>,
    block: <span class="hljs-type">suspend</span> <span class="hljs-type">CoroutineScope</span>.() -&gt; <span class="hljs-type">T</span>
)</span></span>: T = coroutineScope {
    
    <span class="hljs-comment">// åˆ›å»ºæš‚åœè°ƒåº¦å™¨</span>
    <span class="hljs-keyword">val</span> dispatcher = PausingDispatcher()
    <span class="hljs-comment">// åˆ›å»ºç”Ÿå‘½å‘¨æœŸæ§åˆ¶å™¨</span>
    <span class="hljs-keyword">val</span> controller = LifecycleController(
        <span class="hljs-keyword">this</span><span class="hljs-symbol">@repeatOnLifecycle</span>, 
        state, 
        dispatcher.dispatchQueue, 
        coroutineContext[Job] ?: error(<span class="hljs-string">"No parent job"</span>)
    )
    
    <span class="hljs-keyword">try</span> {
        withContext(dispatcher) {
            block() <span class="hljs-comment">// æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç å—</span>
        }
    } <span class="hljs-keyword">finally</span> {
        controller.finish()
    }
}

<span class="hljs-comment">// LifecycleController å…³é”®é€»è¾‘</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LifecycleController</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lifecycle: Lifecycle,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> minState: Lifecycle.State,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> dispatchQueue: DispatchQueue,
    parentJob: Job
) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> observer = LifecycleEventObserver { source, _ -&gt;
        <span class="hljs-keyword">if</span> (source.lifecycle.currentState == Lifecycle.State.DESTROYED) {
            <span class="hljs-comment">// å®¿ä¸»é”€æ¯ï¼šå–æ¶ˆçˆ¶ Job</span>
            parentJob.cancel()
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (source.lifecycle.currentState &lt; minState) {
            <span class="hljs-comment">// ä½äºç›®æ ‡çŠ¶æ€ï¼šæš‚åœé˜Ÿåˆ—</span>
            dispatchQueue.pause()
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// è¾¾åˆ°ç›®æ ‡çŠ¶æ€ï¼šæ¢å¤é˜Ÿåˆ—</span>
            dispatchQueue.resume()
        }
    }
    
    <span class="hljs-keyword">init</span> {
        <span class="hljs-comment">// å¦‚æœå·²ç»é”€æ¯ï¼Œç«‹å³å–æ¶ˆ</span>
        <span class="hljs-keyword">if</span> (lifecycle.currentState == Lifecycle.State.DESTROYED) {
            parentJob.cancel()
        } <span class="hljs-keyword">else</span> {
            lifecycle.addObserver(observer)
        }
    }
}
</code></pre>
<h3 data-id="heading-20">3.3 LifecycleCoroutineScope å®ç°æœºåˆ¶</h3>
<p><code>lifecycleScope</code>Â çš„è‡ªåŠ¨å–æ¶ˆåŠŸèƒ½æ˜¯é€šè¿‡Â <code>LifecycleCoroutineScope</code>Â å®ç°çš„ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ‰©å±•å±æ€§</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> LifecycleOwner.lifecycleScope: LifecycleCoroutineScope
    <span class="hljs-keyword">get</span>() = lifecycle.coroutineScope

<span class="hljs-comment">// æ ¸å¿ƒå®ç°ç±»</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LifecycleCoroutineScopeImpl</span>(
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> lifecycle: Lifecycle,
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> coroutineContext: CoroutineContext
) : LifecycleCoroutineScope(), LifecycleEventObserver {
    
    <span class="hljs-keyword">init</span> {
        <span class="hljs-comment">// å¦‚æœå·²ç»é”€æ¯ï¼Œç«‹å³å–æ¶ˆ</span>
        <span class="hljs-keyword">if</span> (lifecycle.currentState == Lifecycle.State.DESTROYED) {
            coroutineContext.cancel()
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">register</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// æ³¨å†Œè‡ªå·±ä¸ºç”Ÿå‘½å‘¨æœŸè§‚å¯Ÿè€…</span>
        lifecycle.addObserver(<span class="hljs-keyword">this</span>)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
        <span class="hljs-keyword">if</span> (lifecycle.currentState &lt;= Lifecycle.State.DESTROYED) {
            <span class="hljs-comment">// ğŸ”¥ å…³é”®ï¼šå½“ç”Ÿå‘½å‘¨æœŸèµ°å‘é”€æ¯æ—¶ï¼Œå–æ¶ˆæ‰€æœ‰åç¨‹</span>
            coroutineContext.cancel()
            lifecycle.removeObserver(<span class="hljs-keyword">this</span>)
        }
    }
}
</code></pre>
<h2 data-id="heading-21">ç¬¬å››éƒ¨åˆ†ï¼šé«˜çº§åº”ç”¨ä¸å®è·µæ¡ˆä¾‹</h2>
<h3 data-id="heading-22">4.1 è§£å†³ Dialog å†…å­˜æ³„æ¼é—®é¢˜</h3>
<p>Dialog çš„å†…å­˜æ³„æ¼æ˜¯å¸¸è§é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨é…ç½®å˜æ›´æ—¶ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ Dialog åŸºç±»
 * è‡ªåŠ¨åœ¨å®¿ä¸»é”€æ¯æ—¶å…³é—­è‡ªå·±ï¼Œé¿å… WindowLeaked å¼‚å¸¸
 */</span>
<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LifecycleAwareDialog</span> <span class="hljs-meta">@JvmOverloads</span> <span class="hljs-keyword">constructor</span>(
    context: Context,
    themeResId: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
) : Dialog(context, themeResId), LifecycleEventObserver {
    
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> TAG = <span class="hljs-string">"LifecycleAwareDialog"</span>
    }
    
    <span class="hljs-keyword">init</span> {
        <span class="hljs-comment">// è‡ªåŠ¨ç»‘å®šåˆ°ç”Ÿå‘½å‘¨æœŸ</span>
        bindToLifecycle(context)
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">bindToLifecycle</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span> {
        <span class="hljs-keyword">val</span> lifecycleOwner = <span class="hljs-keyword">when</span> (context) {
            <span class="hljs-keyword">is</span> ComponentActivity -&gt; context
            <span class="hljs-keyword">is</span> ContextThemeWrapper -&gt; {
                <span class="hljs-keyword">val</span> base = context.baseContext
                <span class="hljs-keyword">if</span> (base <span class="hljs-keyword">is</span> ComponentActivity) base <span class="hljs-keyword">else</span> <span class="hljs-literal">null</span>
            }
            <span class="hljs-keyword">else</span> -&gt; <span class="hljs-literal">null</span>
        }
        
        lifecycleOwner?.lifecycle?.addObserver(<span class="hljs-keyword">this</span>)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
        <span class="hljs-keyword">when</span> (event) {
            Lifecycle.Event.ON_DESTROY -&gt; {
                <span class="hljs-comment">// å®¿ä¸»é”€æ¯æ—¶è‡ªåŠ¨å…³é—­ Dialog</span>
                <span class="hljs-keyword">if</span> (isShowing) {
                    Log.d(TAG, <span class="hljs-string">"Host destroyed, dismissing dialog"</span>)
                    dismiss()
                }
                <span class="hljs-comment">// ç§»é™¤è§‚å¯Ÿè€…é¿å…å†…å­˜æ³„æ¼</span>
                source.lifecycle.removeObserver(<span class="hljs-keyword">this</span>)
            }
            Lifecycle.Event.ON_STOP -&gt; {
                <span class="hljs-comment">// å¯é€‰ï¼šå®¿ä¸»ä¸å¯è§æ—¶æš‚åœ Dialog æ“ä½œ</span>
                pauseInternalOperations()
            }
            Lifecycle.Event.ON_START -&gt; {
                <span class="hljs-comment">// å¯é€‰ï¼šå®¿ä¸»æ¢å¤æ—¶æ¢å¤ Dialog æ“ä½œ</span>
                resumeInternalOperations()
            }
            <span class="hljs-keyword">else</span> -&gt; {}
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å®‰å…¨æ£€æŸ¥ï¼šç¡®ä¿å®¿ä¸»æœªé”€æ¯</span>
        <span class="hljs-keyword">if</span> (isOwnerAlive()) {
            <span class="hljs-keyword">super</span>.show()
        } <span class="hljs-keyword">else</span> {
            Log.w(TAG, <span class="hljs-string">"Owner is not alive, skipping show()"</span>)
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isOwnerAlive</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> context = context
            <span class="hljs-keyword">when</span> (context) {
                <span class="hljs-keyword">is</span> ComponentActivity -&gt; 
                    !context.isDestroyed &amp;&amp; !context.isFinishing
                <span class="hljs-keyword">is</span> ContextThemeWrapper -&gt; {
                    <span class="hljs-keyword">val</span> base = context.baseContext
                    base <span class="hljs-keyword">is</span> ComponentActivity &amp;&amp; 
                        !base.isDestroyed &amp;&amp; !base.isFinishing
                }
                <span class="hljs-keyword">else</span> -&gt; <span class="hljs-literal">true</span>
            }
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            <span class="hljs-literal">false</span>
        }
    }
    
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pauseInternalOperations</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å­ç±»å¯é‡å†™ï¼šæš‚åœåŠ¨ç”»ã€è®¡æ—¶å™¨ç­‰</span>
    }
    
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resumeInternalOperations</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å­ç±»å¯é‡å†™ï¼šæ¢å¤åŠ¨ç”»ã€è®¡æ—¶å™¨ç­‰</span>
    }
    
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onHostDestroyed</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å­ç±»å¯é‡å†™ï¼šå®¿ä¸»é”€æ¯æ—¶çš„è‡ªå®šä¹‰æ¸…ç†</span>
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">showSafeDialog</span><span class="hljs-params">(activity: <span class="hljs-type">AppCompatActivity</span>)</span></span> {
    <span class="hljs-keyword">val</span> dialog = LifecycleAwareDialog(activity).apply {
        setContentView(R.layout.dialog_custom)
        setCancelable(<span class="hljs-literal">true</span>)
        
        <span class="hljs-comment">// è®¾ç½®å†…å®¹</span>
        findViewById&lt;TextView&gt;(R.id.title).text = <span class="hljs-string">"è­¦å‘Š"</span>
        findViewById&lt;TextView&gt;(R.id.message).text = <span class="hljs-string">"ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ"</span>
        
        findViewById&lt;Button&gt;(R.id.btn_positive).setOnClickListener {
            <span class="hljs-comment">// å¤„ç†ç¡®å®šæ“ä½œ</span>
            dismiss()
        }
        
        findViewById&lt;Button&gt;(R.id.btn_negative).setOnClickListener {
            <span class="hljs-comment">// å¤„ç†å–æ¶ˆæ“ä½œ</span>
            dismiss()
        }
    }
    
    <span class="hljs-comment">// å®‰å…¨æ˜¾ç¤ºï¼Œå³ä½¿ Activity åœ¨æ˜¾ç¤ºæœŸé—´è¢«é”€æ¯</span>
    dialog.show()
}
</code></pre>
<h3 data-id="heading-23">4.2 è‡ªå®šä¹‰ LifecycleOwner ç®¡ç†å¤æ‚ä¸šåŠ¡</h3>
<p>å¯¹äºéæ ‡å‡† Android ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªå®šä¹‰Â <code>LifecycleOwner</code>Â èµ‹äºˆå…¶ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥èƒ½åŠ›ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * ä¸‹è½½ç®¡ç†å™¨ç¤ºä¾‹
 * å±•ç¤ºå¦‚ä½•ä¸ºå¤æ‚ä¸šåŠ¡é€»è¾‘æ·»åŠ ç”Ÿå‘½å‘¨æœŸç®¡ç†
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DownloadManager</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">constructor</span>() : LifecycleOwner, LifecycleEventObserver {
    
    <span class="hljs-comment">// å•ä¾‹æ¨¡å¼</span>
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-meta">@Volatile</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> instance: DownloadManager? = <span class="hljs-literal">null</span>
        
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>: DownloadManager {
            <span class="hljs-keyword">return</span> instance ?: synchronized(<span class="hljs-keyword">this</span>) {
                instance ?: DownloadManager().also { instance = it }
            }
        }
    }
    
    <span class="hljs-comment">// è‡ªå®šä¹‰ä¸šåŠ¡çŠ¶æ€</span>
    <span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DownloadState</span> {
        IDLE, PREPARING, DOWNLOADING, PAUSED, COMPLETED, ERROR
    }
    
    <span class="hljs-comment">// è‡ªå®šä¹‰ä¸šåŠ¡äº‹ä»¶</span>
    <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DownloadEvent</span> : <span class="hljs-type">Lifecycle.Event</span>() {
        <span class="hljs-keyword">object</span> ON_DOWNLOAD_START : DownloadEvent()
        <span class="hljs-keyword">object</span> ON_DOWNLOAD_PROGRESS : DownloadEvent()
        <span class="hljs-keyword">object</span> ON_DOWNLOAD_COMPLETE : DownloadEvent()
        <span class="hljs-keyword">object</span> ON_DOWNLOAD_ERROR : DownloadEvent()
        <span class="hljs-keyword">object</span> ON_DOWNLOAD_PAUSE : DownloadEvent()
        <span class="hljs-keyword">object</span> ON_DOWNLOAD_RESUME : DownloadEvent()
    }
    
    <span class="hljs-comment">// æ ¸å¿ƒï¼šLifecycleRegistry</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lifecycleRegistry = LifecycleRegistry(<span class="hljs-keyword">this</span>)
    
    <span class="hljs-comment">// ä¸šåŠ¡çŠ¶æ€</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> currentState: DownloadState = DownloadState.IDLE
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> currentProgress: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> currentTask: DownloadTask? = <span class="hljs-literal">null</span>
    
    <span class="hljs-comment">// è§‚å¯Ÿè€…ç®¡ç†</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> downloadObservers = mutableListOf&lt;LifecycleEventObserver&gt;()
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLifecycle</span><span class="hljs-params">()</span></span>: Lifecycle = lifecycleRegistry
    
    <span class="hljs-keyword">init</span> {
        <span class="hljs-comment">// åˆå§‹çŠ¶æ€</span>
        lifecycleRegistry.currentState = Lifecycle.State.INITIALIZED
    }
    
    <span class="hljs-comment">// ========== ä¸šåŠ¡æ–¹æ³• ==========</span>
    
    <span class="hljs-comment">/**
     * å¼€å§‹ä¸‹è½½
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startDownload</span><span class="hljs-params">(url: <span class="hljs-type">String</span>, savePath: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">if</span> (currentState != DownloadState.IDLE &amp;&amp; 
            currentState != DownloadState.PAUSED) {
            Log.w(<span class="hljs-string">"DownloadManager"</span>, <span class="hljs-string">"Cannot start, current state: <span class="hljs-variable">$currentState</span>"</span>)
            <span class="hljs-keyword">return</span>
        }
        
        <span class="hljs-comment">// è§¦å‘ä¸šåŠ¡ç”Ÿå‘½å‘¨æœŸäº‹ä»¶</span>
        lifecycleRegistry.handleLifecycleEvent(DownloadEvent.ON_DOWNLOAD_START)
        currentState = DownloadState.DOWNLOADING
        
        currentTask = DownloadTask(url, savePath).apply {
            setListener(<span class="hljs-keyword">object</span> : DownloadListener {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(progress: <span class="hljs-type">Int</span>)</span></span> {
                    currentProgress = progress
                    
                    <span class="hljs-comment">// è¿›åº¦æ›´æ–°äº‹ä»¶</span>
                    lifecycleRegistry.handleLifecycleEvent(
                        DownloadEvent.ON_DOWNLOAD_PROGRESS
                    )
                    
                    <span class="hljs-comment">// é€šçŸ¥ä¸šåŠ¡è§‚å¯Ÿè€…</span>
                    downloadObservers.forEach { observer -&gt;
                        observer.onStateChanged(
                            <span class="hljs-keyword">this</span><span class="hljs-symbol">@DownloadManager</span>,
                            DownloadEvent.ON_DOWNLOAD_PROGRESS
                        )
                    }
                }
                
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCompleted</span><span class="hljs-params">()</span></span> {
                    currentState = DownloadState.COMPLETED
                    
                    <span class="hljs-comment">// ä¸‹è½½å®Œæˆäº‹ä»¶</span>
                    lifecycleRegistry.handleLifecycleEvent(
                        DownloadEvent.ON_DOWNLOAD_COMPLETE
                    )
                    
                    <span class="hljs-comment">// åŒæ­¥åˆ°æ ‡å‡†ç”Ÿå‘½å‘¨æœŸ</span>
                    lifecycleRegistry.handleLifecycleEvent(Lifecycle.Event.ON_STOP)
                }
                
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(error: <span class="hljs-type">Throwable</span>)</span></span> {
                    currentState = DownloadState.ERROR
                    lifecycleRegistry.handleLifecycleEvent(
                        DownloadEvent.ON_DOWNLOAD_ERROR
                    )
                }
            })
            
            start()
        }
    }
    
    <span class="hljs-comment">/**
     * æš‚åœä¸‹è½½
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pauseDownload</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> (currentState == DownloadState.DOWNLOADING) {
            currentState = DownloadState.PAUSED
            currentTask?.pause()
            
            lifecycleRegistry.handleLifecycleEvent(DownloadEvent.ON_DOWNLOAD_PAUSE)
            lifecycleRegistry.handleLifecycleEvent(Lifecycle.Event.ON_PAUSE)
        }
    }
    
    <span class="hljs-comment">/**
     * æ¢å¤ä¸‹è½½
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resumeDownload</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> (currentState == DownloadState.PAUSED) {
            currentState = DownloadState.DOWNLOADING
            currentTask?.resume()
            
            lifecycleRegistry.handleLifecycleEvent(DownloadEvent.ON_DOWNLOAD_RESUME)
            lifecycleRegistry.handleLifecycleEvent(Lifecycle.Event.ON_RESUME)
        }
    }
    
    <span class="hljs-comment">/**
     * åœæ­¢ä¸‹è½½
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">stopDownload</span><span class="hljs-params">()</span></span> {
        currentState = DownloadState.IDLE
        currentProgress = <span class="hljs-number">0</span>
        currentTask?.cancel()
        currentTask = <span class="hljs-literal">null</span>
        
        lifecycleRegistry.handleLifecycleEvent(Lifecycle.Event.ON_STOP)
    }
    
    <span class="hljs-comment">/**
     * é”€æ¯ç®¡ç†å™¨
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span></span> {
        stopDownload()
        lifecycleRegistry.handleLifecycleEvent(Lifecycle.Event.ON_DESTROY)
        downloadObservers.clear()
    }
    
    <span class="hljs-comment">// ========== å®ç° LifecycleEventObserver ==========</span>
    
    <span class="hljs-comment">/**
     * å“åº”å®¿ä¸»ï¼ˆå¦‚ Activityï¼‰çš„ç”Ÿå‘½å‘¨æœŸ
     */</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
        <span class="hljs-keyword">when</span> (event) {
            Lifecycle.Event.ON_PAUSE -&gt; {
                <span class="hljs-comment">// å®¿ä¸»è¿›å…¥åå°ï¼Œæš‚åœä¸‹è½½</span>
                <span class="hljs-keyword">if</span> (currentState == DownloadState.DOWNLOADING) {
                    pauseDownload()
                }
            }
            
            Lifecycle.Event.ON_STOP -&gt; {
                <span class="hljs-comment">// å®¿ä¸»åœæ­¢ï¼Œä¿å­˜å½“å‰çŠ¶æ€</span>
                saveCurrentState()
            }
            
            Lifecycle.Event.ON_DESTROY -&gt; {
                <span class="hljs-comment">// å®¿ä¸»é”€æ¯ï¼Œæ¸…ç†èµ„æº</span>
                cleanup()
                source.lifecycle.removeObserver(<span class="hljs-keyword">this</span>)
            }
            
            <span class="hljs-keyword">else</span> -&gt; {}
        }
    }
    
    <span class="hljs-comment">// ========== è§‚å¯Ÿè€…ç®¡ç† ==========</span>
    
    <span class="hljs-comment">/**
     * æ·»åŠ ä¸‹è½½çŠ¶æ€è§‚å¯Ÿè€…
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addDownloadObserver</span><span class="hljs-params">(observer: <span class="hljs-type">LifecycleEventObserver</span>)</span></span> {
        downloadObservers.add(observer)
        
        <span class="hljs-comment">// ç«‹å³åŒæ­¥å½“å‰çŠ¶æ€</span>
        <span class="hljs-keyword">val</span> syncEvent = <span class="hljs-keyword">when</span> (currentState) {
            DownloadState.IDLE -&gt; Lifecycle.Event.ON_CREATE
            DownloadState.DOWNLOADING -&gt; DownloadEvent.ON_DOWNLOAD_START
            DownloadState.PAUSED -&gt; DownloadEvent.ON_DOWNLOAD_PAUSE
            DownloadState.COMPLETED -&gt; DownloadEvent.ON_DOWNLOAD_COMPLETE
            DownloadState.ERROR -&gt; DownloadEvent.ON_DOWNLOAD_ERROR
            <span class="hljs-keyword">else</span> -&gt; Lifecycle.Event.ON_ANY
        }
        
        observer.onStateChanged(<span class="hljs-keyword">this</span>, syncEvent)
    }
    
    <span class="hljs-comment">/**
     * ç§»é™¤ä¸‹è½½è§‚å¯Ÿè€…
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">removeDownloadObserver</span><span class="hljs-params">(observer: <span class="hljs-type">LifecycleEventObserver</span>)</span></span> {
        downloadObservers.remove(observer)
    }
    
    <span class="hljs-comment">// ========== å·¥å…·æ–¹æ³• ==========</span>
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">saveCurrentState</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ä¿å­˜ä¸‹è½½çŠ¶æ€åˆ° SharedPreferences æˆ–æ•°æ®åº“</span>
        <span class="hljs-keyword">val</span> prefs = context.getSharedPreferences(<span class="hljs-string">"downloads"</span>, Context.MODE_PRIVATE)
        prefs.edit()
            .putString(<span class="hljs-string">"last_url"</span>, currentTask?.url)
            .putInt(<span class="hljs-string">"last_progress"</span>, currentProgress)
            .putString(<span class="hljs-string">"last_state"</span>, currentState.name)
            .apply()
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cleanup</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰èµ„æº</span>
        currentTask?.release()
        downloadObservers.clear()
    }
    
    <span class="hljs-comment">// ========== æ•°æ®ç±» ==========</span>
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DownloadTask</span>(
        <span class="hljs-keyword">val</span> url: String,
        <span class="hljs-keyword">val</span> savePath: String
    ) {
        <span class="hljs-comment">// ç®€åŒ–çš„ä¸‹è½½ä»»åŠ¡å®ç°</span>
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span> { <span class="hljs-comment">/* å®é™…ä¸‹è½½é€»è¾‘ */</span> }
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span></span> { <span class="hljs-comment">/* æš‚åœé€»è¾‘ */</span> }
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resume</span><span class="hljs-params">()</span></span> { <span class="hljs-comment">/* æ¢å¤é€»è¾‘ */</span> }
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cancel</span><span class="hljs-params">()</span></span> { <span class="hljs-comment">/* å–æ¶ˆé€»è¾‘ */</span> }
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">release</span><span class="hljs-params">()</span></span> { <span class="hljs-comment">/* é‡Šæ”¾èµ„æº */</span> }
        
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setListener</span><span class="hljs-params">(listener: <span class="hljs-type">DownloadListener</span>)</span></span> {
            <span class="hljs-comment">// è®¾ç½®ç›‘å¬å™¨</span>
        }
    }
    
    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DownloadListener</span> {
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(progress: <span class="hljs-type">Int</span>)</span></span>
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCompleted</span><span class="hljs-params">()</span></span>
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(error: <span class="hljs-type">Throwable</span>)</span></span>
    }
}

<span class="hljs-comment">// ========== ä½¿ç”¨ç¤ºä¾‹ ==========</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DownloadActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> downloadManager = DownloadManager.getInstance()
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_download)
        
        <span class="hljs-comment">// 1. DownloadManager è§‚å¯Ÿ Activity çš„ç”Ÿå‘½å‘¨æœŸ</span>
        lifecycle.addObserver(downloadManager)
        
        <span class="hljs-comment">// 2. Activity è§‚å¯Ÿ DownloadManager çš„ä¸šåŠ¡çŠ¶æ€</span>
        downloadManager.addDownloadObserver(<span class="hljs-keyword">object</span> : LifecycleEventObserver {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
                <span class="hljs-keyword">when</span> (event) {
                    <span class="hljs-keyword">is</span> DownloadManager.DownloadEvent.ON_DOWNLOAD_PROGRESS -&gt; {
                        <span class="hljs-comment">// æ›´æ–°è¿›åº¦æ¡</span>
                        updateProgress(downloadManager.currentProgress)
                    }
                    <span class="hljs-keyword">is</span> DownloadManager.DownloadEvent.ON_DOWNLOAD_COMPLETE -&gt; {
                        <span class="hljs-comment">// æ˜¾ç¤ºå®Œæˆæç¤º</span>
                        showDownloadComplete()
                    }
                    <span class="hljs-keyword">is</span> DownloadManager.DownloadEvent.ON_DOWNLOAD_ERROR -&gt; {
                        <span class="hljs-comment">// æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</span>
                        showDownloadError()
                    }
                    <span class="hljs-keyword">else</span> -&gt; {}
                }
            }
        })
        
        <span class="hljs-comment">// 3. å¼€å§‹ä¸‹è½½</span>
        findViewById&lt;Button&gt;(R.id.btn_start).setOnClickListener {
            downloadManager.startDownload(
                <span class="hljs-string">"https://example.com/largefile.zip"</span>,
                getExternalFilesDir(<span class="hljs-literal">null</span>)?.path + <span class="hljs-string">"/download.zip"</span>
            )
        }
        
        <span class="hljs-comment">// 4. æš‚åœ/æ¢å¤ä¸‹è½½</span>
        findViewById&lt;Button&gt;(R.id.btn_pause_resume).setOnClickListener {
            <span class="hljs-keyword">if</span> (downloadManager.currentState == DownloadManager.DownloadState.DOWNLOADING) {
                downloadManager.pauseDownload()
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (downloadManager.currentState == DownloadManager.DownloadState.PAUSED) {
                downloadManager.resumeDownload()
            }
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onDestroy()
        <span class="hljs-comment">// ç§»é™¤è§‚å¯Ÿè€…</span>
        lifecycle.removeObserver(downloadManager)
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateProgress</span><span class="hljs-params">(progress: <span class="hljs-type">Int</span>)</span></span> {
        runOnUiThread {
            findViewById&lt;ProgressBar&gt;(R.id.progress_bar).progress = progress
            findViewById&lt;TextView&gt;(R.id.tv_progress).text = <span class="hljs-string">"<span class="hljs-variable">$progress</span>%"</span>
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">showDownloadComplete</span><span class="hljs-params">()</span></span> {
        runOnUiThread {
            Toast.makeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"ä¸‹è½½å®Œæˆ"</span>, Toast.LENGTH_SHORT).show()
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">showDownloadError</span><span class="hljs-params">()</span></span> {
        runOnUiThread {
            Toast.makeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"ä¸‹è½½å¤±è´¥"</span>, Toast.LENGTH_SHORT).show()
        }
    }
}
</code></pre>
<h3 data-id="heading-24">4.3 ViewModel ä¸­å®‰å…¨æ„ŸçŸ¥è§†å›¾ç”Ÿå‘½å‘¨æœŸ</h3>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼ŒViewModel éœ€è¦æ„ŸçŸ¥ Fragment çš„è§†å›¾ç”Ÿå‘½å‘¨æœŸï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * å®‰å…¨çš„ ViewModelï¼Œæ„ŸçŸ¥è§†å›¾ç”Ÿå‘½å‘¨æœŸ
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    
    <span class="hljs-comment">// LiveData ç”¨äºæ¥æ”¶æ¥è‡ª Fragment çš„ viewLifecycleOwner</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _viewLifecycleOwner = MutableLiveData&lt;LifecycleOwner?&gt;()
    
    <span class="hljs-comment">// è§†å›¾æ„ŸçŸ¥çš„ LiveData</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _viewAwareData = MediatorLiveData&lt;String&gt;()
    <span class="hljs-keyword">val</span> viewAwareData: LiveData&lt;String&gt; = _viewAwareData
    
    <span class="hljs-comment">// éœ€è¦è§†å›¾ç”Ÿå‘½å‘¨æœŸçš„æ“ä½œ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> viewAwareJob: Job? = <span class="hljs-literal">null</span>
    
    <span class="hljs-comment">/**
     * è®¾ç½® viewLifecycleOwner
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setViewLifecycleOwner</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">if</span> (_viewLifecycleOwner.value != owner) {
            _viewLifecycleOwner.value = owner
            
            <span class="hljs-comment">// å½“ viewLifecycleOwner å˜åŒ–æ—¶ï¼Œé‡æ–°è®¾ç½®ç›‘å¬</span>
            setupViewLifecycleObserver(owner)
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setupViewLifecycleObserver</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        owner.lifecycle.addObserver(<span class="hljs-keyword">object</span> : DefaultLifecycleObserver {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
                <span class="hljs-comment">// åªåœ¨è§†å›¾å¯è§æ—¶å¼€å§‹æ˜‚è´µæ“ä½œ</span>
                startExpensiveViewOperation()
            }
            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStop</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
                <span class="hljs-comment">// è§†å›¾ä¸å¯è§æ—¶åœæ­¢æ“ä½œ</span>
                stopExpensiveViewOperation()
            }
            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
                <span class="hljs-comment">// æ¸…ç†èµ„æº</span>
                owner.lifecycle.removeObserver(<span class="hljs-keyword">this</span>)
                viewAwareJob?.cancel()
            }
        })
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startExpensiveViewOperation</span><span class="hljs-params">()</span></span> {
        viewAwareJob?.cancel()
        
        viewAwareJob = viewModelScope.launch {
            <span class="hljs-comment">// æ¨¡æ‹Ÿéœ€è¦è§†å›¾å­˜åœ¨çš„æ“ä½œ</span>
            <span class="hljs-keyword">while</span> (isActive) {
                <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = fetchData()
                _viewAwareData.postValue(<span class="hljs-keyword">data</span>)
                delay(<span class="hljs-number">5000</span>) <span class="hljs-comment">// 5ç§’æ›´æ–°ä¸€æ¬¡</span>
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">stopExpensiveViewOperation</span><span class="hljs-params">()</span></span> {
        viewAwareJob?.cancel()
        viewAwareJob = <span class="hljs-literal">null</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchData</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®è·å–</span>
        delay(<span class="hljs-number">1000</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Data at <span class="hljs-subst">${System.currentTimeMillis()}</span>"</span>
    }
    
    <span class="hljs-comment">/**
     * ä½¿ç”¨ Transformations çš„å¦ä¸€ç§æ¨¡å¼
     */</span>
    <span class="hljs-keyword">val</span> transformedData = Transformations.switchMap(_viewLifecycleOwner) { owner -&gt;
        <span class="hljs-keyword">if</span> (owner != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// åˆ›å»ºä¸è§†å›¾ç”Ÿå‘½å‘¨æœŸç»‘å®šçš„ LiveData</span>
            liveData(owner.lifecycleScope.coroutineContext) {
                emit(loadViewSpecificData())
            }
        } <span class="hljs-keyword">else</span> {
            MutableLiveData()
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadViewSpecificData</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-comment">// è¿™ä¸ªå‡½æ•°çŸ¥é“å®ƒåªåœ¨è§†å›¾ç”Ÿå‘½å‘¨æœŸå†…è¢«è°ƒç”¨</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"View-specific data"</span>
    }
}

<span class="hljs-comment">// åœ¨ Fragment ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyFragment</span> : <span class="hljs-type">Fragment</span>() {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: SafeViewModel <span class="hljs-keyword">by</span> viewModels()
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)
        
        <span class="hljs-comment">// å…³é”®ï¼šå°† viewLifecycleOwner ä¼ é€’ç»™ ViewModel</span>
        viewModel.setViewLifecycleOwner(viewLifecycleOwner)
        
        <span class="hljs-comment">// è§‚å¯Ÿ ViewModel ä¸­çš„æ•°æ®</span>
        viewModel.viewAwareData.observe(viewLifecycleOwner) { <span class="hljs-keyword">data</span> -&gt;
            <span class="hljs-comment">// å®‰å…¨åœ°æ›´æ–° UI</span>
            updateUI(<span class="hljs-keyword">data</span>)
        }
        
        viewModel.transformedData.observe(viewLifecycleOwner) { <span class="hljs-keyword">data</span> -&gt;
            <span class="hljs-comment">// å¦ä¸€ä¸ªå®‰å…¨çš„æ•°æ®æµ</span>
            processData(<span class="hljs-keyword">data</span>)
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroyView</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onDestroyView()
        <span class="hljs-comment">// viewLifecycleOwner å˜åŒ–ï¼ŒViewModel ä¸­ç›¸å…³æ“ä½œä¼šè‡ªåŠ¨åœæ­¢</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateUI</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-comment">// æ›´æ–°ç•Œé¢</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processData</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
    }
}
</code></pre>
<h2 data-id="heading-25">ç¬¬äº”éƒ¨åˆ†ï¼šæ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-26">5.1 è§‚å¯Ÿè€…æ€§èƒ½ä¼˜åŒ–</h3>
<p>å½“é¡µé¢ä¸­æ³¨å†Œå¤§é‡ LifecycleObserver æ—¶ï¼Œéœ€è¦æ³¨æ„æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ä¸ä¼˜åŒ–çš„å†™æ³•ï¼šå¤§é‡ç‹¬ç«‹è§‚å¯Ÿè€…</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UnoptimizedActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-comment">// æ¯ä¸ªè§‚å¯Ÿè€…éƒ½ä¼šåœ¨äº‹ä»¶åˆ†å‘æ—¶è¢«éå†</span>
        lifecycle.addObserver(NetworkObserver())
        lifecycle.addObserver(LogObserver())
        lifecycle.addObserver(AnalyticsObserver())
        lifecycle.addObserver(CrashObserver())
        lifecycle.addObserver(PermissionObserver())
        lifecycle.addObserver(ThemeObserver())
        lifecycle.addObserver(LocaleObserver())
        <span class="hljs-comment">// ... æ›´å¤šè§‚å¯Ÿè€…</span>
        
        <span class="hljs-comment">// é—®é¢˜ï¼šæ¯æ¬¡ç”Ÿå‘½å‘¨æœŸäº‹ä»¶éƒ½è¦éå† 10+ ä¸ªè§‚å¯Ÿè€…</span>
        <span class="hljs-comment">// å¦‚æœæŸäº›è§‚å¯Ÿè€…çš„å›è°ƒå¾ˆé‡ï¼Œä¼šå¯¼è‡´å¡é¡¿</span>
    }
}

<span class="hljs-comment">// âœ… ä¼˜åŒ–æ–¹æ¡ˆ1ï¼šåˆå¹¶è§‚å¯Ÿè€…</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¤åˆè§‚å¯Ÿè€…</span>
        <span class="hljs-keyword">val</span> compositeObserver = CompositeAppObserver(
            network = NetworkObserver(),
            analytics = AnalyticsObserver(),
            crash = CrashObserver(),
            theme = ThemeObserver()
        )
        
        <span class="hljs-comment">// åªæ³¨å†Œä¸€ä¸ªè§‚å¯Ÿè€…</span>
        lifecycle.addObserver(compositeObserver)
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CompositeAppObserver</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> network: NetworkObserver,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> analytics: AnalyticsObserver,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> crash: CrashObserver,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> theme: ThemeObserver
) : DefaultLifecycleObserver {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-comment">// æ‰¹é‡å¤„ç†ï¼Œä½†è¦æ³¨æ„æ‰§è¡Œé¡ºåº</span>
        network.onStart(owner)
        theme.onStart(owner)      <span class="hljs-comment">// ä¸»é¢˜ä¼˜å…ˆ</span>
        analytics.onStart(owner)  <span class="hljs-comment">//  analytics å…¶æ¬¡</span>
        crash.onStart(owner)      <span class="hljs-comment">// crash æœ€å</span>
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStop</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-comment">// é€†åºåœæ­¢</span>
        crash.onStop(owner)
        analytics.onStop(owner)
        network.onStop(owner)
        theme.onStop(owner)
    }
}

<span class="hljs-comment">// âœ… ä¼˜åŒ–æ–¹æ¡ˆ2ï¼šæ‡’åŠ è½½è§‚å¯Ÿè€…</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LazyLifecycleManager</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> owner: LifecycleOwner) {
    
    <span class="hljs-comment">// ä½¿ç”¨ lazy å»¶è¿Ÿåˆå§‹åŒ–é‡é‡çº§è§‚å¯Ÿè€…</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> heavyObserver <span class="hljs-keyword">by</span> lazy {
        HeavyResourceObserver().apply {
            initializeHeavyResources() <span class="hljs-comment">// å»¶è¿Ÿåˆ°ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶åˆå§‹åŒ–</span>
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> featureObservers = mutableMapOf&lt;String, LifecycleObserver&gt;()
    
    <span class="hljs-comment">/**
     * å¯ç”¨ç‰¹å®šåŠŸèƒ½ï¼ˆéœ€è¦æ—¶æ‰æ³¨å†Œè§‚å¯Ÿè€…ï¼‰
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">enableFeature</span><span class="hljs-params">(featureName: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">if</span> (!featureObservers.containsKey(featureName)) {
            <span class="hljs-keyword">val</span> observer = <span class="hljs-keyword">when</span> (featureName) {
                <span class="hljs-string">"location"</span> -&gt; createLocationObserver()
                <span class="hljs-string">"bluetooth"</span> -&gt; createBluetoothObserver()
                <span class="hljs-string">"camera"</span> -&gt; createCameraObserver()
                <span class="hljs-keyword">else</span> -&gt; <span class="hljs-keyword">return</span>
            }
            
            owner.lifecycle.addObserver(observer)
            featureObservers[featureName] = observer
        }
    }
    
    <span class="hljs-comment">/**
     * ç¦ç”¨ç‰¹å®šåŠŸèƒ½ï¼ˆåŠæ—¶ç§»é™¤è§‚å¯Ÿè€…ï¼‰
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">disableFeature</span><span class="hljs-params">(featureName: <span class="hljs-type">String</span>)</span></span> {
        featureObservers[featureName]?.let { observer -&gt;
            owner.lifecycle.removeObserver(observer)
            featureObservers.remove(featureName)
            
            <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
            <span class="hljs-keyword">if</span> (observer <span class="hljs-keyword">is</span> Releasable) {
                observer.release()
            }
        }
    }
    
    <span class="hljs-comment">/**
     * åœ¨ç‰¹å®šç”Ÿå‘½å‘¨æœŸé˜¶æ®µå¯ç”¨åŠŸèƒ½
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">enableFeatureTemporarily</span><span class="hljs-params">(featureName: <span class="hljs-type">String</span>, state: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">State</span>)</span></span> {
        owner.lifecycle.addObserver(<span class="hljs-keyword">object</span> : DefaultLifecycleObserver {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
                <span class="hljs-keyword">val</span> currentState = owner.lifecycle.currentState
                
                <span class="hljs-keyword">if</span> (currentState.isAtLeast(state)) {
                    enableFeature(featureName)
                } <span class="hljs-keyword">else</span> {
                    disableFeature(featureName)
                    owner.lifecycle.removeObserver(<span class="hljs-keyword">this</span>) <span class="hljs-comment">// è‡ªæˆ‘ç§»é™¤</span>
                }
            }
        })
    }
}

<span class="hljs-comment">// âœ… ä¼˜åŒ–æ–¹æ¡ˆ3ï¼šä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆé«˜çº§ä¼˜åŒ–ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PriorityLifecycleRegistry</span>(
    owner: LifecycleOwner
) : LifecycleRegistry(owner) {
    
    <span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Priority</span> {
        CRITICAL,    <span class="hljs-comment">// UI æ¸²æŸ“ã€ç”¨æˆ·è¾“å…¥å“åº”</span>
        HIGH,        <span class="hljs-comment">// ä¸šåŠ¡æ ¸å¿ƒé€»è¾‘</span>
        NORMAL,      <span class="hljs-comment">// ä¸€èˆ¬ä¸šåŠ¡é€»è¾‘</span>
        LOW,         <span class="hljs-comment">// æ—¥å¿—ã€ç»Ÿè®¡ç­‰</span>
        BACKGROUND   <span class="hljs-comment">// åå°ä»»åŠ¡</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PriorityObserver</span>(
        <span class="hljs-keyword">val</span> observer: LifecycleObserver,
        <span class="hljs-keyword">val</span> priority: Priority,
        <span class="hljs-keyword">val</span> state: ObserverWithState
    )
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> priorityQueues = EnumMap&lt;Priority, MutableList&lt;PriorityObserver&gt;&gt;(
        Priority::<span class="hljs-keyword">class</span>.java
    )
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addObserver</span><span class="hljs-params">(observer: <span class="hljs-type">LifecycleObserver</span>)</span></span> {
        <span class="hljs-comment">// æ ¹æ®ä¸šåŠ¡ç±»å‹åˆ†é…ä¼˜å…ˆçº§</span>
        <span class="hljs-keyword">val</span> priority = <span class="hljs-keyword">when</span> {
            observer <span class="hljs-keyword">is</span> UiLifecycleObserver -&gt; Priority.CRITICAL
            observer <span class="hljs-keyword">is</span> BusinessLogicObserver -&gt; Priority.HIGH
            observer <span class="hljs-keyword">is</span> AnalyticsObserver -&gt; Priority.LOW
            <span class="hljs-keyword">else</span> -&gt; Priority.NORMAL
        }
        
        <span class="hljs-keyword">val</span> statefulObserver = ObserverWithState(observer, initialState)
        <span class="hljs-keyword">val</span> priorityObserver = PriorityObserver(observer, priority, statefulObserver)
        
        <span class="hljs-comment">// æ·»åŠ åˆ°å¯¹åº”ä¼˜å…ˆçº§é˜Ÿåˆ—</span>
        <span class="hljs-keyword">val</span> queue = priorityQueues.getOrPut(priority) { mutableListOf() }
        queue.add(priorityObserver)
        
        <span class="hljs-comment">// çŠ¶æ€è¿½èµ¶</span>
        syncPriorityObserver(priorityObserver)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handleLifecycleEvent</span><span class="hljs-params">(event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
        <span class="hljs-keyword">super</span>.handleLifecycleEvent(event)
        
        <span class="hljs-comment">// æŒ‰ä¼˜å…ˆçº§é¡ºåºåˆ†å‘äº‹ä»¶</span>
        Priority.values().forEach { priority -&gt;
            priorityQueues[priority]?.forEach { priorityObserver -&gt;
                <span class="hljs-keyword">if</span> (shouldDispatch(priorityObserver, event)) {
                    priorityObserver.state.dispatchEvent(owner, event)
                }
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldDispatch</span><span class="hljs-params">(observer: <span class="hljs-type">PriorityObserver</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-comment">// å¯ä»¥æ ¹æ®äº‹ä»¶ç±»å‹å’Œä¼˜å…ˆçº§åšæ›´ç²¾ç»†çš„æ§åˆ¶</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (observer.priority) {
            Priority.CRITICAL -&gt; <span class="hljs-literal">true</span> <span class="hljs-comment">// å…³é”®æ“ä½œæ€»æ˜¯æ‰§è¡Œ</span>
            Priority.HIGH -&gt; event != Lifecycle.Event.ON_ANY
            Priority.NORMAL -&gt; event <span class="hljs-keyword">in</span> setOf(
                Lifecycle.Event.ON_CREATE,
                Lifecycle.Event.ON_START,
                Lifecycle.Event.ON_STOP,
                Lifecycle.Event.ON_DESTROY
            )
            Priority.LOW -&gt; event <span class="hljs-keyword">in</span> setOf(
                Lifecycle.Event.ON_START,
                Lifecycle.Event.ON_STOP
            )
            Priority.BACKGROUND -&gt; event == Lifecycle.Event.ON_DESTROY
        }
    }
}
</code></pre>
<h3 data-id="heading-27">5.2 å†…å­˜æ³„æ¼é¢„é˜²ç­–ç•¥</h3>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ç»„ä»¶åŸºç±»
 * å†…ç½®å†…å­˜æ³„æ¼é¢„é˜²æœºåˆ¶
 */</span>
<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeLifecycleObserver</span> : <span class="hljs-type">DefaultLifecycleObserver</span> {
    
    <span class="hljs-comment">// å¼±å¼•ç”¨æŒæœ‰ Contextï¼Œé¿å…æ³„æ¼</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> weakContext: WeakReference&lt;Context&gt;? = <span class="hljs-literal">null</span>
    
    <span class="hljs-comment">// éœ€è¦æ¸…ç†çš„èµ„æºåˆ—è¡¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> resourcesToClean = mutableListOf&lt;Releasable&gt;()
    
    <span class="hljs-comment">// å¾…æ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> pendingTasks = mutableListOf&lt;Job&gt;()
    
    <span class="hljs-comment">/**
     * å®‰å…¨åœ°åˆå§‹åŒ–ï¼Œä½¿ç”¨å¼±å¼•ç”¨æŒæœ‰ Context
     */</span>
    <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initialize</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span> {
        <span class="hljs-keyword">this</span>.weakContext = WeakReference(context)
    }
    
    <span class="hljs-comment">/**
     * è·å– Contextï¼ˆå¯èƒ½ä¸º nullï¼‰
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getContext</span><span class="hljs-params">()</span></span>: Context? {
        <span class="hljs-keyword">return</span> weakContext?.<span class="hljs-keyword">get</span>()
    }
    
    <span class="hljs-comment">/**
     * å®‰å…¨åœ°æ‰§è¡Œ UI æ“ä½œ
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">runOnUiThreadIfAlive</span><span class="hljs-params">(action: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> context = getContext()
        <span class="hljs-keyword">if</span> (context <span class="hljs-keyword">is</span> ComponentActivity) {
            <span class="hljs-keyword">if</span> (!context.isDestroyed &amp;&amp; !context.isFinishing) {
                context.runOnUiThread { action() }
            }
        }
    }
    
    <span class="hljs-comment">/**
     * æ³¨å†Œéœ€è¦æ¸…ç†çš„èµ„æº
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">registerResource</span><span class="hljs-params">(resource: <span class="hljs-type">Releasable</span>)</span></span> {
        resourcesToClean.add(resource)
    }
    
    <span class="hljs-comment">/**
     * å¯åŠ¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„åç¨‹
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">launchSafe</span><span class="hljs-params">(
        scope: <span class="hljs-type">CoroutineScope</span>,
        block: <span class="hljs-type">suspend</span> <span class="hljs-type">CoroutineScope</span>.() -&gt; <span class="hljs-type">Unit</span>
    )</span></span>: Job {
        <span class="hljs-keyword">val</span> job = scope.launch {
            <span class="hljs-keyword">try</span> {
                block()
            } <span class="hljs-keyword">catch</span> (e: CancellationException) {
                <span class="hljs-comment">// æ­£å¸¸å–æ¶ˆï¼Œå¿½ç•¥</span>
                <span class="hljs-keyword">throw</span> e
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                <span class="hljs-comment">// å¼‚å¸¸å¤„ç†</span>
                handleException(e)
            }
        }
        
        pendingTasks.add(job)
        job.invokeOnCompletion { 
            pendingTasks.remove(job) 
        }
        
        <span class="hljs-keyword">return</span> job
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-comment">// 1. å–æ¶ˆæ‰€æœ‰å¾…å¤„ç†ä»»åŠ¡</span>
        pendingTasks.forEach { it.cancel() }
        pendingTasks.clear()
        
        <span class="hljs-comment">// 2. é‡Šæ”¾æ‰€æœ‰æ³¨å†Œçš„èµ„æº</span>
        resourcesToClean.forEach { it.release() }
        resourcesToClean.clear()
        
        <span class="hljs-comment">// 3. æ¸…ç†å¼±å¼•ç”¨</span>
        weakContext = <span class="hljs-literal">null</span>
        
        <span class="hljs-comment">// 4. ç§»é™¤è§‚å¯Ÿè€…</span>
        owner.lifecycle.removeObserver(<span class="hljs-keyword">this</span>)
        
        <span class="hljs-comment">// 5. è°ƒç”¨è‡ªå®šä¹‰æ¸…ç†</span>
        onCleanup()
    }
    
    <span class="hljs-comment">/**
     * å­ç±»å¯é‡å†™çš„æ¸…ç†æ–¹æ³•
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleanup</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// è‡ªå®šä¹‰æ¸…ç†é€»è¾‘</span>
    }
    
    <span class="hljs-comment">/**
     * å¼‚å¸¸å¤„ç†
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handleException</span><span class="hljs-params">(e: <span class="hljs-type">Exception</span>)</span></span> {
        Log.e(<span class="hljs-string">"SafeLifecycleObserver"</span>, <span class="hljs-string">"Error in lifecycle observer"</span>, e)
    }
    
    <span class="hljs-comment">/**
     * å¯é‡Šæ”¾èµ„æºçš„æ¥å£
     */</span>
    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Releasable</span> {
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">release</span><span class="hljs-params">()</span></span>
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeLocationTracker</span> : <span class="hljs-type">SafeLifecycleObserver</span>() {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> locationManager: LocationManager? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> locationJob: Job? = <span class="hljs-literal">null</span>
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initialize</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span> {
        <span class="hljs-keyword">super</span>.initialize(context)
        
        locationManager = context.getSystemService(Context.LOCATION_SERVICE) <span class="hljs-keyword">as</span>? LocationManager
        
        <span class="hljs-comment">// æ³¨å†Œä¸ºå¯é‡Šæ”¾èµ„æº</span>
        locationManager?.let { 
            registerResource(<span class="hljs-keyword">object</span> : Releasable {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">release</span><span class="hljs-params">()</span></span> {
                    it.removeUpdates(<span class="hljs-keyword">this</span><span class="hljs-symbol">@SafeLocationTracker</span>)
                }
            })
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">super</span>.onStart(owner)
        
        <span class="hljs-comment">// å®‰å…¨åœ°å¯åŠ¨ä½ç½®æ›´æ–°</span>
        locationJob = launchSafe(owner.lifecycleScope) {
            startLocationUpdates()
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStop</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">super</span>.onStop(owner)
        
        <span class="hljs-comment">// åœæ­¢ä½ç½®æ›´æ–°</span>
        locationJob?.cancel()
        locationJob = <span class="hljs-literal">null</span>
        locationManager?.removeUpdates(<span class="hljs-keyword">this</span>)
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startLocationUpdates</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ä½ç½®æ›´æ–°é€»è¾‘</span>
        delay(<span class="hljs-number">1000</span>) <span class="hljs-comment">// æ¨¡æ‹Ÿ</span>
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleanup</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// é¢å¤–çš„æ¸…ç†å·¥ä½œ</span>
        locationManager = <span class="hljs-literal">null</span>
    }
}
</code></pre>
<h3 data-id="heading-28">5.3 è°ƒè¯•ä¸ç›‘æ§å·¥å…·</h3>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * ç”Ÿå‘½å‘¨æœŸè°ƒè¯•å·¥å…·
 * å¸®åŠ©è¯Šæ–­ç”Ÿå‘½å‘¨æœŸç›¸å…³é—®é¢˜
 */</span>
<span class="hljs-keyword">object</span> LifecycleDebugger {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> TAG = <span class="hljs-string">"LifecycleDebug"</span>
    
    <span class="hljs-comment">// å¯ç”¨è°ƒè¯•</span>
    <span class="hljs-keyword">var</span> enabled = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> observedLifecycles = WeakHashMap&lt;Lifecycle, String&gt;()
    
    <span class="hljs-comment">/**
     * ç›‘æ§æŒ‡å®šçš„ Lifecycle
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">monitorLifecycle</span><span class="hljs-params">(lifecycle: <span class="hljs-type">Lifecycle</span>, tag: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">if</span> (!enabled) <span class="hljs-keyword">return</span>
        
        <span class="hljs-keyword">if</span> (!observedLifecycles.containsKey(lifecycle)) {
            observedLifecycles[lifecycle] = tag
            
            lifecycle.addObserver(<span class="hljs-keyword">object</span> : LifecycleEventObserver {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
                    logEvent(tag, source, event)
                    
                    <span class="hljs-comment">// æ£€æµ‹æ½œåœ¨é—®é¢˜</span>
                    detectPotentialIssues(source, event)
                }
            })
            
            Log.d(TAG, <span class="hljs-string">"å¼€å§‹ç›‘æ§: <span class="hljs-variable">$tag</span>, å½“å‰çŠ¶æ€: <span class="hljs-subst">${lifecycle.currentState}</span>"</span>)
        }
    }
    
    <span class="hljs-comment">/**
     * è®°å½•ç”Ÿå‘½å‘¨æœŸäº‹ä»¶
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">logEvent</span><span class="hljs-params">(tag: <span class="hljs-type">String</span>, source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
        <span class="hljs-keyword">val</span> threadInfo = <span class="hljs-keyword">if</span> (Looper.myLooper() == Looper.getMainLooper()) {
            <span class="hljs-string">"[ä¸»çº¿ç¨‹]"</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-string">"[å­çº¿ç¨‹: <span class="hljs-subst">${Thread.currentThread().name}</span>]"</span>
        }
        
        Log.d(TAG, <span class="hljs-string">"<span class="hljs-variable">$threadInfo</span> <span class="hljs-variable">$tag</span> - <span class="hljs-subst">${source::class.simpleName}</span> - <span class="hljs-variable">$event</span>"</span>)
    }
    
    <span class="hljs-comment">/**
     * æ£€æµ‹æ½œåœ¨é—®é¢˜
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">detectPotentialIssues</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
        <span class="hljs-keyword">when</span> (event) {
            Lifecycle.Event.ON_DESTROY -&gt; {
                <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰æœªå–æ¶ˆçš„åç¨‹</span>
                checkForLeakedCoroutines(source)
                
                <span class="hljs-comment">// æ£€æŸ¥è§‚å¯Ÿè€…æ•°é‡</span>
                checkObserverCount(source)
            }
            Lifecycle.Event.ON_STOP -&gt; {
                <span class="hljs-comment">// æ£€æŸ¥é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡</span>
                checkForLongRunningTasks(source)
            }
            <span class="hljs-keyword">else</span> -&gt; {}
        }
    }
    
    <span class="hljs-comment">/**
     * æ£€æŸ¥æ³„æ¼çš„åç¨‹
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkForLeakedCoroutines</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">if</span> (owner <span class="hljs-keyword">is</span> ComponentActivity) {
            <span class="hljs-comment">// æ£€æŸ¥ lifecycleScope ä¸­æ´»è·ƒçš„åç¨‹</span>
            <span class="hljs-keyword">val</span> scope = owner.lifecycleScope
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// é€šè¿‡åå°„æ£€æŸ¥ï¼ˆä»…ç”¨äºè°ƒè¯•ï¼‰</span>
                <span class="hljs-keyword">val</span> field = scope.javaClass.getDeclaredField(<span class="hljs-string">"context"</span>)
                field.isAccessible = <span class="hljs-literal">true</span>
                <span class="hljs-keyword">val</span> context = field.<span class="hljs-keyword">get</span>(scope) <span class="hljs-keyword">as</span> CoroutineContext
                
                <span class="hljs-keyword">val</span> job = context[Job]
                <span class="hljs-keyword">if</span> (job != <span class="hljs-literal">null</span> &amp;&amp; job.isActive) {
                    Log.w(TAG, <span class="hljs-string">"æ½œåœ¨æ³„æ¼: <span class="hljs-subst">${owner::class.simpleName}</span> æœ‰æ´»è·ƒçš„åç¨‹"</span>)
                }
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                <span class="hljs-comment">// å¿½ç•¥åå°„é”™è¯¯</span>
            }
        }
    }
    
    <span class="hljs-comment">/**
     * æ£€æŸ¥è§‚å¯Ÿè€…æ•°é‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkObserverCount</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">val</span> lifecycle = owner.lifecycle
        <span class="hljs-keyword">if</span> (lifecycle <span class="hljs-keyword">is</span> LifecycleRegistry) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">val</span> field = LifecycleRegistry::<span class="hljs-keyword">class</span>.java.getDeclaredField(<span class="hljs-string">"mObserverMap"</span>)
                field.isAccessible = <span class="hljs-literal">true</span>
                <span class="hljs-keyword">val</span> map = field.<span class="hljs-keyword">get</span>(lifecycle) <span class="hljs-keyword">as</span>? Iterable&lt;*&gt;
                
                <span class="hljs-keyword">val</span> count = map?.count() ?: <span class="hljs-number">0</span>
                <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">10</span>) {
                    Log.w(TAG, <span class="hljs-string">"<span class="hljs-subst">${owner::class.simpleName}</span> æœ‰ <span class="hljs-variable">$count</span> ä¸ªè§‚å¯Ÿè€…ï¼Œè€ƒè™‘ä¼˜åŒ–"</span>)
                }
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                <span class="hljs-comment">// å¿½ç•¥åå°„é”™è¯¯</span>
            }
        }
    }
    
    <span class="hljs-comment">/**
     * æ£€æŸ¥é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkForLongRunningTasks</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-comment">// å¯ä»¥é›†æˆæ€§èƒ½ç›‘æ§å·¥å…·</span>
        Log.d(TAG, <span class="hljs-string">"<span class="hljs-subst">${owner::class.simpleName}</span> è¿›å…¥åå°ï¼Œæ£€æŸ¥åå°ä»»åŠ¡"</span>)
    }
    
    <span class="hljs-comment">/**
     * ç”Ÿæˆè°ƒè¯•æŠ¥å‘Š
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">generateReport</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-keyword">return</span> buildString {
            appendLine(<span class="hljs-string">"=== Lifecycle è°ƒè¯•æŠ¥å‘Š ==="</span>)
            appendLine(<span class="hljs-string">"ç›‘æ§çš„ç”Ÿå‘½å‘¨æœŸæ•°é‡: <span class="hljs-subst">${observedLifecycles.size}</span>"</span>)
            appendLine()
            
            observedLifecycles.forEach { (lifecycle, tag) -&gt;
                appendLine(<span class="hljs-string">"[<span class="hljs-variable">$tag</span>]"</span>)
                appendLine(<span class="hljs-string">"  å½“å‰çŠ¶æ€: <span class="hljs-subst">${lifecycle.currentState}</span>"</span>)
                appendLine()
            }
        }
    }
}

<span class="hljs-comment">/**
 * æ€§èƒ½ç›‘æ§è§‚å¯Ÿè€…
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PerformanceMonitor</span> : <span class="hljs-type">DefaultLifecycleObserver</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EventTiming</span>(
        <span class="hljs-keyword">val</span> event: Lifecycle.Event,
        <span class="hljs-keyword">val</span> startTime: <span class="hljs-built_in">Long</span>,
        <span class="hljs-keyword">var</span> endTime: <span class="hljs-built_in">Long</span> = <span class="hljs-number">0</span>
    )
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> eventTimings = mutableMapOf&lt;Lifecycle.Event, MutableList&lt;<span class="hljs-built_in">Long</span>&gt;&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> currentEvent: EventTiming? = <span class="hljs-literal">null</span>
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
        currentEvent?.let {
            it.endTime = System.nanoTime()
            <span class="hljs-keyword">val</span> duration = it.endTime - it.startTime
            
            eventTimings.getOrPut(it.event) { mutableListOf() }.add(duration)
            
            <span class="hljs-comment">// å¦‚æœå¤„ç†æ—¶é—´è¿‡é•¿ï¼Œè®°å½•è­¦å‘Š</span>
            <span class="hljs-keyword">if</span> (duration &gt; <span class="hljs-number">10_000_000</span>) { <span class="hljs-comment">// 10æ¯«ç§’</span>
                Log.w(<span class="hljs-string">"LifecyclePerf"</span>, 
                    <span class="hljs-string">"å¤„ç† <span class="hljs-subst">${it.event}</span> è€—æ—¶ <span class="hljs-subst">${duration / <span class="hljs-number">1</span>_000_000}</span>ms"</span>)
            }
        }
        
        currentEvent = EventTiming(event, System.nanoTime())
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getPerformanceReport</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-keyword">return</span> buildString {
            appendLine(<span class="hljs-string">"=== ç”Ÿå‘½å‘¨æœŸæ€§èƒ½æŠ¥å‘Š ==="</span>)
            eventTimings.forEach { (event, timings) -&gt;
                <span class="hljs-keyword">val</span> avg = timings.average().toLong() / <span class="hljs-number">1_000_000</span>
                <span class="hljs-keyword">val</span> max = timings.maxOrNull()?.div(<span class="hljs-number">1_000_000</span>) ?: <span class="hljs-number">0</span>
                <span class="hljs-keyword">val</span> min = timings.minOrNull()?.div(<span class="hljs-number">1_000_000</span>) ?: <span class="hljs-number">0</span>
                
                appendLine(<span class="hljs-string">"<span class="hljs-variable">$event</span>:"</span>)
                appendLine(<span class="hljs-string">"  å¹³å‡: <span class="hljs-subst">${avg}</span>ms"</span>)
                appendLine(<span class="hljs-string">"  æœ€å¤§: <span class="hljs-subst">${max}</span>ms"</span>)
                appendLine(<span class="hljs-string">"  æœ€å°: <span class="hljs-subst">${min}</span>ms"</span>)
                appendLine(<span class="hljs-string">"  æ¬¡æ•°: <span class="hljs-subst">${timings.size}</span>"</span>)
                appendLine()
            }
        }
    }
}

<span class="hljs-comment">// åœ¨ Application ä¸­åˆå§‹åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        
        <span class="hljs-comment">// åªåœ¨è°ƒè¯•ç‰ˆæœ¬å¯ç”¨</span>
        <span class="hljs-keyword">if</span> (BuildConfig.DEBUG) {
            LifecycleDebugger.enabled = <span class="hljs-literal">true</span>
            
            <span class="hljs-comment">// ç›‘æ§åº”ç”¨çº§åˆ«çš„ç”Ÿå‘½å‘¨æœŸ</span>
            ProcessLifecycleOwner.<span class="hljs-keyword">get</span>().lifecycle.addObserver(
                PerformanceMonitor()
            )
        }
    }
}

<span class="hljs-comment">// åœ¨ Activity ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DebugActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-comment">// ç›‘æ§è¿™ä¸ª Activity çš„ç”Ÿå‘½å‘¨æœŸ</span>
        LifecycleDebugger.monitorLifecycle(lifecycle, <span class="hljs-string">"MainActivity"</span>)
        
        <span class="hljs-comment">// æ·»åŠ æ€§èƒ½ç›‘æ§</span>
        lifecycle.addObserver(PerformanceMonitor())
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onDestroy()
        
        <span class="hljs-comment">// ç”ŸæˆæŠ¥å‘Š</span>
        <span class="hljs-keyword">if</span> (LifecycleDebugger.enabled) {
            Log.d(<span class="hljs-string">"LifecycleDebug"</span>, LifecycleDebugger.generateReport())
        }
    }
}
</code></pre>
<h2 data-id="heading-29">ç¬¬å…­éƒ¨åˆ†ï¼šé¢è¯•é¢˜æ·±åº¦è§£æ</h2>
<h3 data-id="heading-30">6.1 åŸºç¡€æ¦‚å¿µç±»é¢è¯•é¢˜</h3>
<p><strong>Q1: Lifecycle è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ä¼ ç»Ÿæ–¹å¼ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</strong></p>
<p><strong>A:</strong> Â Lifecycle è§£å†³äº†ç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸­çš„ä¸‰å¤§æ ¸å¿ƒé—®é¢˜ï¼š</p>
<ol>
<li><strong>ä»£ç è€¦åˆé—®é¢˜</strong>ï¼šä¼ ç»Ÿæ–¹å¼ä¸­ä¸šåŠ¡é€»è¾‘ä¸ UI æ§åˆ¶å™¨æ·±åº¦ç»‘å®š</li>
<li><strong>å†…å­˜æ³„æ¼é—®é¢˜</strong>ï¼šå®¹æ˜“å¿˜è®°åœ¨é€‚å½“æ—¶æœºé‡Šæ”¾èµ„æº</li>
<li><strong>çŠ¶æ€ç®¡ç†é—®é¢˜</strong>ï¼šé…ç½®å˜æ›´ã€å¼‚å¸¸æ¢å¤ç­‰åœºæ™¯å¤„ç†å¤æ‚</li>
</ol>
<p><strong>å¯¹æ¯”ä¼˜åŠ¿è¡¨ï¼š</strong></p>



































<table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»Ÿæ–¹å¼</th><th>Lifecycleæ–¹å¼</th></tr></thead><tbody><tr><td><strong>ä»£ç ç»„ç»‡</strong></td><td>ä¸šåŠ¡é€»è¾‘æ•£è½åœ¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­</td><td>ä¸šåŠ¡é€»è¾‘å°è£…åœ¨ç‹¬ç«‹è§‚å¯Ÿè€…ä¸­</td></tr><tr><td><strong>å†…å­˜å®‰å…¨</strong></td><td>æ‰‹åŠ¨ç®¡ç†ï¼Œæ˜“å‡ºé”™</td><td>è‡ªåŠ¨æ¸…ç†ï¼Œé…åˆå¼±å¼•ç”¨æ›´å®‰å…¨</td></tr><tr><td><strong>å¯å¤ç”¨æ€§</strong></td><td>ä¸ç‰¹å®š Activity å¼ºè€¦åˆ</td><td>ç»„ä»¶å¯è¢«ä»»ä½• LifecycleOwner å¤ç”¨</td></tr><tr><td><strong>å¯æµ‹è¯•æ€§</strong></td><td>éœ€è¦ Android ç¯å¢ƒ</td><td>å¯å•å…ƒæµ‹è¯•</td></tr><tr><td><strong>å¼‚æ­¥å®‰å…¨</strong></td><td>éœ€æ‰‹åŠ¨æ£€æŸ¥ç”Ÿå‘½å‘¨æœŸ</td><td>å†…ç½®çŠ¶æ€æ£€æŸ¥æœºåˆ¶</td></tr></tbody></table>
<p><strong>Q2: Lifecycle çš„ä¸‰ä¸ªæ ¸å¿ƒè§’è‰²åŠå…¶å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>A:</strong></p>
<ol>
<li><strong>LifecycleOwnerï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰</strong> ï¼šç”Ÿå‘½å‘¨æœŸæ‹¥æœ‰è€…ï¼Œå¦‚ Activityã€Fragment</li>
<li><strong>Lifecycleï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰</strong> ï¼šå®šä¹‰äº†ç”Ÿå‘½å‘¨æœŸçŠ¶æ€å’Œäº‹ä»¶ï¼Œæ ¸å¿ƒå®ç°æ˜¯Â <code>LifecycleRegistry</code></li>
<li><strong>LifecycleObserverï¼ˆè§‚å¯Ÿè€…ï¼‰</strong> ï¼šå¸Œæœ›æ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶</li>
</ol>
<p><strong>å…³ç³»</strong>ï¼š</p>
<ul>
<li><code>LifecycleOwner</code>Â æŒæœ‰Â <code>Lifecycle</code>Â å¯¹è±¡</li>
<li><code>LifecycleObserver</code>Â å‘Â <code>Lifecycle</code>Â æ³¨å†Œ</li>
<li>å½“Â <code>LifecycleOwner</code>Â çš„ç”Ÿå‘½å‘¨æœŸå˜åŒ–æ—¶ï¼Œé€šè¿‡Â <code>LifecycleRegistry</code>Â åˆ†å‘ç»™æ‰€æœ‰Â <code>LifecycleObserver</code></li>
</ul>
<h3 data-id="heading-31">6.2 åŸç†æœºåˆ¶ç±»é¢è¯•é¢˜</h3>
<p><strong>Q3: Lifecycle å¦‚ä½•æ„ŸçŸ¥ Activity çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿä½ç‰ˆæœ¬å’Œé«˜ç‰ˆæœ¬æœ‰ä½•ä¸åŒï¼Ÿ</strong></p>
<p><strong>A:</strong> Â é€šè¿‡Â <code>ReportFragment</code>Â æœºåˆ¶ï¼š</p>
<p>java</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ ¸å¿ƒæœºåˆ¶</span>
public static void <span class="hljs-built_in">injectIfNeededIn</span>(Activity activity) {
    if (Build.VERSION.SDK_INT &gt;= <span class="hljs-number">29</span>) {
        <span class="hljs-comment">// Android 10+ï¼šä½¿ç”¨ ActivityLifecycleCallbacks</span>
        activity<span class="hljs-selector-class">.registerActivityLifecycleCallbacks</span>(new LifecycleCallbacks());
    } else {
        <span class="hljs-comment">// Android 10 ä»¥ä¸‹ï¼šæ·»åŠ æ— ç•Œé¢ Fragment</span>
        android<span class="hljs-selector-class">.app</span><span class="hljs-selector-class">.FragmentManager</span> manager = activity<span class="hljs-selector-class">.getFragmentManager</span>();
        if (manager.findFragmentByTag(REPORT_FRAGMENT_TAG) == null) {
            manager<span class="hljs-selector-class">.beginTransaction</span>()
                <span class="hljs-selector-class">.add</span>(new ReportFragment(), REPORT_FRAGMENT_TAG)
                <span class="hljs-selector-class">.commit</span>();
            manager<span class="hljs-selector-class">.executePendingTransactions</span>();
        }
    }
}
</code></pre>
<p><strong>åŒºåˆ«</strong>ï¼š</p>
<ul>
<li><strong>API 29+</strong> ï¼šç›´æ¥æ³¨å†ŒÂ <code>ActivityLifecycleCallbacks</code>ï¼Œæ— æ€§èƒ½æŸè€—</li>
<li><strong>API 29-</strong>ï¼šé€šè¿‡éšè—çš„Â <code>Fragment</code>Â é—´æ¥ç›‘å¬ï¼Œæœ‰å¾®å°æ€§èƒ½å¼€é”€ä½†å…¼å®¹æ€§å¥½</li>
</ul>
<p><strong>Q4:Â <code>LifecycleRegistry.sync()</code>Â æ–¹æ³•ä¸­çš„ while å¾ªç¯æ˜¯åšä»€ä¹ˆçš„ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong></p>
<p><strong>A:</strong> Â è¿™æ˜¯ Lifecycle æœ€æ ¸å¿ƒçš„é¢è¯•é¢˜ä¹‹ä¸€ã€‚</p>
<p>java</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sync</span>()</span> {
    <span class="hljs-keyword">while</span> (!isSynced()) {  <span class="hljs-comment">// ğŸ”¥ å…³é”®å¾ªç¯</span>
        <span class="hljs-comment">// ... åŒæ­¥é€»è¾‘</span>
        <span class="hljs-keyword">if</span> (mNewEventOccurred) {
            <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// é‡æ–°å¼€å§‹åŒæ­¥</span>
        }
    }
}
</code></pre>
<p><strong>å¾ªç¯çš„ä½œç”¨</strong>ï¼š</p>
<ol>
<li><strong>å¤„ç†åµŒå¥—äº‹ä»¶</strong>ï¼šåœ¨äº‹ä»¶åˆ†å‘è¿‡ç¨‹ä¸­ï¼ŒæŸä¸ªè§‚å¯Ÿè€…çš„å›è°ƒå¯èƒ½è§¦å‘æ–°çš„äº‹ä»¶</li>
<li><strong>å¤„ç†åŠ¨æ€å˜åŒ–</strong>ï¼šè§‚å¯Ÿè€…å¯èƒ½åœ¨äº‹ä»¶åˆ†å‘è¿‡ç¨‹ä¸­è¢«æ·»åŠ æˆ–ç§»é™¤</li>
<li><strong>ä¿è¯æœ€ç»ˆä¸€è‡´æ€§</strong>ï¼šç¡®ä¿æ‰€æœ‰è§‚å¯Ÿè€…æœ€ç»ˆè¾¾åˆ°ä¸€è‡´çŠ¶æ€</li>
</ol>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å¾ªç¯</strong>ï¼š<br/>
å‡è®¾åœºæ™¯ï¼šåˆ†å‘Â <code>ON_STOP</code>Â äº‹ä»¶æ—¶ï¼Œè§‚å¯Ÿè€… A çš„å›è°ƒä¸­æ³¨å†Œäº†æ–°è§‚å¯Ÿè€… Bã€‚</p>
<ul>
<li>æ²¡æœ‰å¾ªç¯ï¼šB ä¼šé”™è¿‡Â <code>ON_STOP</code>Â äº‹ä»¶ï¼ŒçŠ¶æ€ä¸ä¸€è‡´</li>
<li>æœ‰å¾ªç¯ï¼šB ä¼šè¢«åŒæ­¥åˆ°æ­£ç¡®çŠ¶æ€ï¼Œæ‰€æœ‰è§‚å¯Ÿè€…æœ€ç»ˆä¸€è‡´</li>
</ul>
<p><strong>Q5:Â <code>FastSafeIterableMap</code>Â å’Œæ™®é€šÂ <code>HashMap</code>Â æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong></p>
<p><strong>A:</strong></p>
<ol>
<li><strong>ä¿æŒé¡ºåº</strong>ï¼š<code>FastSafeIterableMap</code>Â ç»´æŠ¤æ’å…¥é¡ºåºï¼Œ<code>HashMap</code>Â ä¸ä¿è¯é¡ºåº</li>
<li><strong>è¿­ä»£å®‰å…¨</strong>ï¼šæ”¯æŒåœ¨è¿­ä»£è¿‡ç¨‹ä¸­å®‰å…¨å¢åˆ å…ƒç´ ï¼Œä¸ä¼šæŠ›Â <code>ConcurrentModificationException</code></li>
<li><strong>å®ç°æœºåˆ¶</strong>ï¼šé€šè¿‡é“¾è¡¨ç»“æ„ï¼Œåœ¨ä¿®æ”¹æ—¶å°†æ–°å…ƒç´ é“¾æ¥åˆ°å½“å‰è¿­ä»£å™¨ä¹‹å</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šéœ€è¦æŒ‰é¡ºåºåˆ†å‘ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œä¸”å¯èƒ½åœ¨åˆ†å‘è¿‡ç¨‹ä¸­å¢åˆ è§‚å¯Ÿè€…</li>
</ol>
<h3 data-id="heading-32">6.3 é«˜çº§åº”ç”¨ç±»é¢è¯•é¢˜</h3>
<p><strong>Q6:Â <code>lifecycleScope</code>Â å’ŒÂ <code>viewLifecycleOwner.lifecycleScope</code>Â æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿåœ¨ Fragment ä¸­åº”è¯¥ç”¨å“ªä¸ªï¼Ÿ</strong></p>
<p><strong>A:</strong></p>
<p><strong>åŒºåˆ«å¯¹æ¯”è¡¨ï¼š</strong></p>



































<table><thead><tr><th>ç‰¹æ€§</th><th><code>lifecycleScope</code></th><th><code>viewLifecycleOwner.lifecycleScope</code></th></tr></thead><tbody><tr><td><strong>å®¿ä¸»</strong></td><td>Fragment å®ä¾‹è‡ªèº«</td><td>Fragment çš„ View å¯¹è±¡</td></tr><tr><td><strong>é”€æ¯æ—¶æœº</strong></td><td><code>Fragment.onDestroy()</code></td><td><code>Fragment.onDestroyView()</code></td></tr><tr><td><strong>é…ç½®å˜æ›´</strong></td><td>ä¿æŒæ´»è·ƒ</td><td>è¢«å–æ¶ˆï¼Œè§†å›¾é‡å»ºåæ–°å»º</td></tr><tr><td><strong>UI å®‰å…¨</strong></td><td>ä¸å®‰å…¨</td><td>å®‰å…¨</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>é UI é•¿æ—¶é—´ä»»åŠ¡</td><td><strong>æ‰€æœ‰ UI ç›¸å…³æ“ä½œ</strong></td></tr></tbody></table>
<p><strong>é€‰æ‹©åŸåˆ™</strong>ï¼š</p>
<ul>
<li><strong>UI æ“ä½œ</strong>ï¼šæ€»æ˜¯ä½¿ç”¨Â <code>viewLifecycleOwner.lifecycleScope</code></li>
<li><strong>é UI åå°ä»»åŠ¡</strong>ï¼šä½¿ç”¨Â <code>lifecycleScope</code></li>
<li><strong>æ•°æ®åŠ è½½</strong>ï¼šä½¿ç”¨Â <code>viewLifecycleOwner.lifecycleScope</code>Â +Â <code>repeatOnLifecycle</code></li>
</ul>
<p><strong>Q7:Â <code>repeatOnLifecycle</code>Â å’Œå·²åºŸå¼ƒçš„Â <code>launchWhenX</code>Â æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong></p>
<p><strong>A:</strong> Â æ ¸å¿ƒåŒºåˆ«åœ¨äºÂ <strong>èµ„æºç®¡ç†ç­–ç•¥</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// launchWhenStartedï¼ˆå·²åºŸå¼ƒï¼‰</span>
lifecycleScope<span class="hljs-selector-class">.launchWhenStarted</span> {
    viewModel<span class="hljs-selector-class">.dataFlow</span><span class="hljs-selector-class">.collect</span> { data -&gt;  <span class="hljs-comment">// âŒ åå°ä»è¿è¡Œ</span>
        <span class="hljs-built_in">updateUI</span>(data)
    }
    <span class="hljs-comment">// è¿›å…¥åå°æ—¶ï¼šåç¨‹æŒ‚èµ·ï¼Œä½† Flow ç»§ç»­ç”Ÿäº§</span>
}

<span class="hljs-comment">// repeatOnLifecycleï¼ˆæ¨èï¼‰</span>
lifecycleScope<span class="hljs-selector-class">.launch</span> {
    <span class="hljs-built_in">repeatOnLifecycle</span>(Lifecycle.State.STARTED) {
        viewModel<span class="hljs-selector-class">.dataFlow</span><span class="hljs-selector-class">.collect</span> { data -&gt;  <span class="hljs-comment">// âœ… åå°åœæ­¢</span>
            <span class="hljs-built_in">updateUI</span>(data)
        }
        <span class="hljs-comment">// è¿›å…¥åå°æ—¶ï¼šåç¨‹å–æ¶ˆï¼ŒFlow åœæ­¢ç”Ÿäº§</span>
    }
}
</code></pre>
<p><strong>è¯¦ç»†å¯¹æ¯”ï¼š</strong></p>



































<table><thead><tr><th>ç‰¹æ€§</th><th><code>launchWhenX</code></th><th><code>repeatOnLifecycle</code></th></tr></thead><tbody><tr><td><strong>æš‚åœè¡Œä¸º</strong></td><td>æŒ‚èµ·åç¨‹</td><td>å–æ¶ˆåç¨‹</td></tr><tr><td><strong>Flow çŠ¶æ€</strong></td><td>ç»§ç»­ç”Ÿäº§</td><td>åœæ­¢ç”Ÿäº§</td></tr><tr><td><strong>èµ„æºæ¶ˆè€—</strong></td><td>é«˜</td><td>ä½</td></tr><tr><td><strong>é‡å¯è¡Œä¸º</strong></td><td>æ¢å¤æ‰§è¡Œ</td><td>é‡æ–°æ‰§è¡Œ</td></tr><tr><td><strong>å®˜æ–¹çŠ¶æ€</strong></td><td>å·²åºŸå¼ƒ</td><td>æ¨èä½¿ç”¨</td></tr></tbody></table>
<p><strong>Q8: å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„Â <code>LifecycleOwner</code>ï¼Ÿ</strong></p>
<p><strong>A:</strong> Â å››ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomController</span> : <span class="hljs-type">LifecycleOwner</span> {
    <span class="hljs-comment">// 1. æŒæœ‰ LifecycleRegistry</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lifecycleRegistry = LifecycleRegistry(<span class="hljs-keyword">this</span>)
    
    <span class="hljs-comment">// 2. å®ç°æ¥å£</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLifecycle</span><span class="hljs-params">()</span></span>: Lifecycle = lifecycleRegistry
    
    <span class="hljs-comment">// 3. åˆå§‹åŒ–çŠ¶æ€</span>
    <span class="hljs-keyword">init</span> {
        lifecycleRegistry.currentState = Lifecycle.State.INITIALIZED
    }
    
    <span class="hljs-comment">// 4. ä¸šåŠ¡æ–¹æ³•è§¦å‘çŠ¶æ€å˜åŒ–</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span> {
        lifecycleRegistry.handleLifecycleEvent(Lifecycle.Event.ON_START)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span></span> {
        lifecycleRegistry.handleLifecycleEvent(Lifecycle.Event.ON_DESTROY)
    }
}
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>MVP æ¶æ„ä¸­çš„ Presenter</li>
<li>åå°æœåŠ¡ç®¡ç†å™¨</li>
<li>è‡ªå®šä¹‰è§†å›¾ç»„ä»¶</li>
<li>å¤æ‚ä¸šåŠ¡é€»è¾‘æ§åˆ¶å™¨</li>
</ul>
<h3 data-id="heading-33">6.4 æ€§èƒ½ä¼˜åŒ–ç±»é¢è¯•é¢˜</h3>
<p><strong>Q9: ä¸€ä¸ªé¡µé¢ä¸Šæ³¨å†Œå¤§é‡ LifecycleObserver ä¼šå½±å“æ€§èƒ½å—ï¼Ÿå¦‚ä½•ä¼˜åŒ–ï¼Ÿ</strong></p>
<p><strong>A:</strong> Â ä¼šå½±å“ï¼Œä½†å¯é€šè¿‡ä¼˜åŒ–ç¼“è§£ã€‚</p>
<p><strong>æ€§èƒ½å½±å“</strong>ï¼š</p>
<ol>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šäº‹ä»¶åˆ†å‘æ˜¯ O(N) çº¿æ€§éå†</li>
<li><strong>å†…å­˜å ç”¨</strong>ï¼šæ¯ä¸ªè§‚å¯Ÿè€…éƒ½æ˜¯ç‹¬ç«‹å¯¹è±¡</li>
<li><strong>å›è°ƒè€—æ—¶</strong>ï¼šè§‚å¯Ÿè€…å›è°ƒæ—¶é—´ç´¯åŠ </li>
</ol>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… ä¼˜åŒ–1ï¼šåˆå¹¶è§‚å¯Ÿè€…</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CompositeObserver</span> : <span class="hljs-type">DefaultLifecycleObserver</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> observers = listOf(observer1, observer2, observer3)
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        observers.forEach { it.onStart(owner) }
    }
}

<span class="hljs-comment">// âœ… ä¼˜åŒ–2ï¼šæ‡’åŠ è½½</span>
<span class="hljs-keyword">val</span> heavyObserver <span class="hljs-keyword">by</span> lazy { HeavyObserver().apply { <span class="hljs-keyword">init</span>() } }

<span class="hljs-comment">// âœ… ä¼˜åŒ–3ï¼šæŒ‰éœ€æ³¨å†Œ</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">enableFeature</span><span class="hljs-params">()</span></span> {
    lifecycle.addObserver(featureObserver)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">disableFeature</span><span class="hljs-params">()</span></span> {
    lifecycle.removeObserver(featureObserver)
    featureObserver.release()
}

<span class="hljs-comment">// âœ… ä¼˜åŒ–4ï¼šä¼˜å…ˆçº§åˆ†å‘ï¼ˆé«˜çº§ï¼‰</span>
<span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Priority</span> { HIGH, NORMAL, LOW }
<span class="hljs-comment">// é«˜ä¼˜å…ˆçº§è§‚å¯Ÿè€…å…ˆæ”¶åˆ°äº‹ä»¶</span>
</code></pre>
<p><strong>Q10: å¦‚ä½•åœ¨ ViewModel ä¸­å®‰å…¨åœ°æ„ŸçŸ¥ Fragment çš„è§†å›¾ç”Ÿå‘½å‘¨æœŸï¼Ÿ</strong></p>
<p><strong>A:</strong> Â ä½¿ç”¨Â <code>viewLifecycleOwnerLiveData</code>Â æ¨¡å¼ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-comment">// LiveData æ¥æ”¶ viewLifecycleOwner</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _viewLifecycle = MutableLiveData&lt;LifecycleOwner?&gt;()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setViewLifecycleOwner</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        _viewLifecycle.value = owner
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startViewAwareOperation</span><span class="hljs-params">()</span></span> {
        _viewLifecycle.value?.lifecycle?.addObserver(
            <span class="hljs-keyword">object</span> : DefaultLifecycleObserver {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
                    <span class="hljs-comment">// åªåœ¨è§†å›¾å¯è§æ—¶æ‰§è¡Œ</span>
                    startExpensiveOperation()
                }
            }
        )
    }
}

<span class="hljs-comment">// Fragment ä¸­</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">()</span></span> {
    viewModel.setViewLifecycleOwner(viewLifecycleOwner)
}
</code></pre>
<p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨Â <code>Flow</code>Â +Â <code>repeatOnLifecycle</code></p>
<h2 data-id="heading-34">æ€»ç»“ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-35">7.1 æ ¸å¿ƒè¦ç‚¹æ€»ç»“</h3>
<ol>
<li><strong>ç†è§£çŠ¶æ€æœºæ¨¡å‹</strong>ï¼šæŒæ¡ State å’Œ Event çš„å…³ç³»æ˜¯åŸºç¡€</li>
<li><strong>æ­£ç¡®ä½¿ç”¨ä½œç”¨åŸŸ</strong>ï¼šFragment ä¸­ UI æ“ä½œæ€»æ˜¯ä½¿ç”¨Â <code>viewLifecycleOwner.lifecycleScope</code></li>
<li><strong>å®‰å…¨æ”¶é›† Flow</strong>ï¼šæ€»æ˜¯ä½¿ç”¨Â <code>repeatOnLifecycle</code>Â æˆ–Â <code>flowWithLifecycle</code></li>
<li><strong>åŠæ—¶æ¸…ç†èµ„æº</strong>ï¼šåˆ©ç”¨ç”Ÿå‘½å‘¨æœŸå›è°ƒè‡ªåŠ¨é‡Šæ”¾èµ„æº</li>
<li><strong>åˆç†è®¾è®¡è§‚å¯Ÿè€…</strong>ï¼šé¿å…è¿‡å¤šè§‚å¯Ÿè€…ï¼Œè€ƒè™‘åˆå¹¶å’Œæ‡’åŠ è½½</li>
</ol>
<h3 data-id="heading-36">7.2 ç‰ˆæœ¬å…¼å®¹æ€§å»ºè®®</h3>

























<table><thead><tr><th>Android ç‰ˆæœ¬</th><th>å»ºè®®é…ç½®</th><th>æ³¨æ„äº‹é¡¹</th></tr></thead><tbody><tr><td><strong>API &lt; 23</strong></td><td>ä½¿ç”¨ Support Library</td><td>ç¡®ä¿å…¼å®¹æ€§</td></tr><tr><td><strong>API 23-28</strong></td><td>ä½¿ç”¨ AndroidX Lifecycle 2.4+</td><td>æ ‡å‡†å®ç°</td></tr><tr><td><strong>API 29+</strong></td><td>ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬</td><td>æ€§èƒ½æ›´ä¼˜</td></tr></tbody></table>
<h3 data-id="heading-37">7.3 è°ƒè¯•ä¸æ’æŸ¥æ¸…å•</h3>
<p>å½“é‡åˆ°ç”Ÿå‘½å‘¨æœŸç›¸å…³é—®é¢˜æ—¶ï¼Œæ£€æŸ¥ä»¥ä¸‹äº‹é¡¹ï¼š</p>
<ol>
<li>
<p><strong>æ˜¯å¦æ­£ç¡®ä½¿ç”¨äº†ä½œç”¨åŸŸ</strong>ï¼Ÿ</p>
<ul>
<li>Fragment UI æ“ä½œæ˜¯å¦ç”¨äº†Â <code>viewLifecycleOwner.lifecycleScope</code>ï¼Ÿ</li>
<li>Flow æ”¶é›†æ˜¯å¦ç”¨äº†Â <code>repeatOnLifecycle</code>ï¼Ÿ</li>
</ul>
</li>
<li>
<p><strong>æ˜¯å¦åŠæ—¶æ¸…ç†äº†èµ„æº</strong>ï¼Ÿ</p>
<ul>
<li>è§‚å¯Ÿè€…æ˜¯å¦åœ¨é€‚å½“æ—¶æœºè¢«ç§»é™¤ï¼Ÿ</li>
<li>å¼‚æ­¥ä»»åŠ¡æ˜¯å¦è¢«æ­£ç¡®å–æ¶ˆï¼Ÿ</li>
</ul>
</li>
<li>
<p><strong>æ˜¯å¦å­˜åœ¨åµŒå¥—äº‹ä»¶é—®é¢˜</strong>ï¼Ÿ</p>
<ul>
<li>è§‚å¯Ÿè€…å›è°ƒä¸­æ˜¯å¦è§¦å‘äº†æ–°çš„äº‹ä»¶ï¼Ÿ</li>
<li>çŠ¶æ€æ˜¯å¦æœ€ç»ˆä¸€è‡´ï¼Ÿ</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½æ˜¯å¦å¯æ¥å—</strong>ï¼Ÿ</p>
<ul>
<li>è§‚å¯Ÿè€…æ•°é‡æ˜¯å¦è¿‡å¤šï¼Ÿ</li>
<li>å›è°ƒæ–¹æ³•æ˜¯å¦æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Ÿ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-38">7.4 æœªæ¥å‘å±•è¶‹åŠ¿</h3>
<p>éšç€ Android å¼€å‘çš„ä¸æ–­æ¼”è¿›ï¼ŒLifecycle ä¹Ÿåœ¨æŒç»­å‘å±•ï¼š</p>
<ol>
<li><strong>ä¸ Compose é›†æˆ</strong>ï¼šCompose æœ‰è‡ªå·±çš„ä¸€å¥—ç”Ÿå‘½å‘¨æœŸç®¡ç†</li>
<li><strong>æ›´ç»†ç²’åº¦çš„æ§åˆ¶</strong>ï¼šå¦‚Â <code>LifecycleOwner</code>Â çš„åµŒå¥—æ”¯æŒ</li>
<li><strong>æ€§èƒ½æŒç»­ä¼˜åŒ–</strong>ï¼šå‡å°‘äº‹ä»¶åˆ†å‘å¼€é”€</li>
<li><strong>æµ‹è¯•å·¥å…·å®Œå–„</strong>ï¼šæ›´å¥½çš„ç”Ÿå‘½å‘¨æœŸæµ‹è¯•æ”¯æŒ</li>
</ol>
<p>æŒæ¡ Lifecycle ä¸ä»…æ˜¯å­¦ä¹ ä¸€ä¸ªæ¡†æ¶ï¼Œæ›´æ˜¯ç†è§£ç°ä»£ Android æ¶æ„è®¾è®¡æ€æƒ³çš„å…³é”®ã€‚å¸Œæœ›è¿™ä»½å®Œæ•´çš„æŒ‡å—èƒ½å¸®åŠ©ä½ åœ¨å®é™…å¼€å‘å’Œé¢è¯•ä¸­éƒ½èƒ½æ¸¸åˆƒæœ‰ä½™ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç›˜ç‚¹ è¿‘æœŸä¼˜ç§€çš„ GitHub å¼€æºé¡¹ç›®ã€‚]]></title>    <link>https://juejin.cn/post/7579094978682912814</link>    <guid>https://juejin.cn/post/7579094978682912814</guid>    <pubDate>2025-12-03T02:41:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579094978682912814" data-draft-id="7579094978682486830" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç›˜ç‚¹ è¿‘æœŸä¼˜ç§€çš„ GitHub å¼€æºé¡¹ç›®ã€‚"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2025-12-03T02:41:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€›é€›GitHub"/> <meta itemprop="url" content="https://juejin.cn/user/1442202996186093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç›˜ç‚¹ è¿‘æœŸä¼˜ç§€çš„ GitHub å¼€æºé¡¹ç›®ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442202996186093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€›é€›GitHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:41:15.000Z" title="Wed Dec 03 2025 02:41:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">01ã€Cursor vip å…è´¹ç»­æ¯</h2>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®ç°åœ¨å·²ç» 44K + çš„ Star äº†ã€‚å¯ä»¥ç»•è¿‡ Cursor AI ä»£ç ç¼–è¾‘å™¨çš„å…è´¹è¯•ç”¨é™åˆ¶ã€‚</p>
<p><strong>é€šè¿‡æŠ€æœ¯æ‰‹æ®µé‡ç½®æœºå™¨ç ï¼Œä»è€Œè®©ä½ èƒ½å¤ŸæŒç»­ä½¿ç”¨å…¶å…è´¹é¢åº¦æˆ– Pro åŠŸèƒ½ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/789eb08f8e5b4ba19ca10f91125aae61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=xg5MZfbXZaR%2Bclqg%2B4DcEgmRv3Q%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸»è¦åŸç†æ˜¯é€šè¿‡è„šæœ¬è‡ªåŠ¨åŒ–åœ°ä¿®æ”¹ç³»ç»Ÿä¸­çš„ç‰¹å®šæ ‡è¯†ç¬¦ï¼Œæ¯”å¦‚ Machine IDã€‚ä½¿ Cursor æœåŠ¡å™¨è®¤ä¸ºå½“å‰è®¾å¤‡æ˜¯ä¸€å°å…¨æ–°çš„æœºå™¨ï¼Œä»è€Œé‡ç½®è¯•ç”¨è®¡æ•°ã€‚</p>
<p>å®ƒæ”¯æŒ Windowsã€macOS å’Œ Linux ç­‰ä¸»æµæ“ä½œç³»ç»Ÿï¼Œå¹¶æä¾›äº†è‡ªåŠ¨åŒ–è„šæœ¬ä»¥ç®€åŒ–æ“ä½œæµç¨‹ã€‚é¡¹ç›®ä¸­åŒ…å«å¤„ç†é¥æµ‹æ•°æ®å±è”½å’Œé…ç½®æ–‡ä»¶ä¿®æ”¹çš„é€»è¾‘ï¼Œä»¥è§„é¿è½¯ä»¶çš„æ£€æµ‹æœºåˆ¶ã€‚</p>
<pre><code class="hljs language-sql" lang="sql">å¼€æºé“¾æ¥ï¼šhttps:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>github.com<span class="hljs-operator">/</span>yeongpin<span class="hljs-operator">/</span><span class="hljs-keyword">cursor</span><span class="hljs-operator">-</span><span class="hljs-keyword">free</span><span class="hljs-operator">-</span>vip
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81b6baee06b240b8899159b97894ce6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=3xoIpM9E%2B9OFNQEbW2hMJ8TN718%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-1">02ã€è¯­éŸ³è½¬æ–‡æœ¬ï¼šHandy</h2>
<p>Handy æ˜¯ä¸€æ¬¾å®Œå…¨ç¦»çº¿ã€å…è´¹ä¸”å¼€æºçš„è¯­éŸ³è½¬æ–‡æœ¬ï¼ˆSpeech-to-Textï¼‰æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œç°åœ¨å·²ç» 7.4K+ çš„ Star äº†ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªç®€å•ã€éšç§ä¼˜å…ˆçš„å¬å†™å·¥å…·ã€‚ä¸ä¾èµ–äº‘æœåŠ¡çš„è¯­éŸ³åŠ©æ‰‹ä¸åŒï¼ŒHandy æ‰€æœ‰çš„å¤„ç†éƒ½åœ¨ç”¨æˆ·æœ¬åœ°ç”µè„‘ä¸Šå®Œæˆï¼Œç¡®ä¿è¯­éŸ³æ•°æ®ä¸å‡ºåŸŸã€‚</p>
<p>åŸºäº Tauri æ¡†æ¶æ„å»ºï¼Œä¿è¯äº†è½¯ä»¶çš„è½»é‡çº§å’Œé«˜æ€§èƒ½ã€‚</p>
<p>åœ¨æ ¸å¿ƒè¯­éŸ³è¯†åˆ«å¼•æ“ä¸Šï¼Œå®ƒé›†æˆäº† OpenAI çš„ Whisper æ¨¡å‹ä»¥åŠ CPU ä¼˜åŒ–çš„ Parakeet æ¨¡å‹ï¼Œèƒ½å¤Ÿåœ¨ Windowsã€macOS å’Œ Linux ä¸Šæµç•…è¿è¡Œã€‚</p>
<p>å®ƒè¿˜å…·å¤‡å…¨å±€å¿«æ·é”®åŠŸèƒ½ï¼Œç”¨æˆ·æŒ‰ä¸‹å¿«æ·é”®è¯´è¯ï¼Œæ–‡å­—å³å¯ç›´æ¥è¾“å…¥åˆ°å½“å‰çš„æ–‡æœ¬æ¡†ä¸­ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby">å¼€æºåœ°å€<span class="hljs-symbol">:https</span><span class="hljs-symbol">://github</span>.com/cjpais/<span class="hljs-title class_">Handy</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f084daa8d514b5c9fe8e61843a2fd79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=5P%2F5MK0lxmYPaWtM6Igverz0z%2FU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-2">03ã€*Open Notebook</h2>
<p>Open Notebook æ˜¯Â Google NotebookLM çš„ä¸€ä¸ªå¼€æºæ›¿ä»£å“ï¼Œç°åœ¨ 11.4K+ çš„ Star äº†ã€‚</p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®æ˜¯ä¸€ä¸ªçµæ´»ã€éšç§ä¿æŠ¤å¾ˆå¼ºçš„ AI ç¬”è®°å’Œç ”ç©¶å·¥å…·ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f09e11fe7ae4e578cb179c0851ce49c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=FypB8%2FwX31YNqBJiJiCFYws1DJU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒä¸ä»…å¤åˆ»äº† NotebookLM çš„æ ¸å¿ƒä½“éªŒï¼Œæ¯”å¦‚åŸºäºæ–‡æ¡£çš„é—®ç­”ï¼Œè¿˜è§£é™¤äº†å¯¹å•ä¸€æ¨¡å‹ä¾›åº”å•†çš„ä¾èµ–ï¼Œå¯ä»¥è‡ªç”±é€‰æ‹© AI åç«¯ã€‚</p>
<p>è€Œä¸”å®ƒå…·å¤‡å¤šæ¨¡æ€å¤„ç†èƒ½åŠ›ï¼Œèƒ½å¤„ç† PDFã€è§†é¢‘ã€éŸ³é¢‘ã€ç½‘é¡µç­‰å¤šç§æ ¼å¼çš„èµ„æ–™ã€‚é™¤äº†åŸºç¡€çš„ RAG é—®ç­”å¤–ã€‚</p>
<p>å®ƒè¿˜é›†æˆäº†æ’­å®¢ç”ŸæˆåŠŸèƒ½ã€å…¨æ–‡åŠå‘é‡æœç´¢ï¼Œå¹¶æä¾›äº†å®Œæ•´çš„ REST API ä»¥ä¾›æ‰©å±•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf5e2fae2b7541198774fec7bf3438b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=%2BfsDJDYTmG4PK0ORgdr%2Baft7%2FKA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-perl" lang="perl">å¼€æºåœ°å€: https:<span class="hljs-regexp">//gi</span>thub.com/lfnovo/<span class="hljs-keyword">open</span>-notebook
</code></pre>
<h2 data-id="heading-3">04ã€AI é»‘å®¢æ™ºèƒ½ä½“ï¼šStrix</h2>
<p><strong>Strix æ¨¡æ‹ŸçœŸå®é»‘å®¢çš„è¡Œä¸ºï¼Œç°åœ¨å·²ç» 15K+ çš„ Star äº†ã€‚èƒ½å¤Ÿè‡ªåŠ¨åŒ–åœ°å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œå®‰å…¨æ‰«æã€æ¼æ´å‘ç°å’ŒéªŒè¯ã€‚</strong></p>
<p>ä¸ä¼ ç»Ÿçš„é™æ€æ‰«æå·¥å…·ä¸åŒï¼ŒStrix é‡‡ç”¨åŠ¨æ€çš„ã€æ™ºèƒ½ä½“é©±åŠ¨ï¼ˆAgenticï¼‰çš„æ–¹æ³•ï¼Œæ—¨åœ¨å‡å°‘è¯¯æŠ¥å¹¶æä¾›é€šè¿‡å®é™…æ”»å‡»éªŒè¯ï¼ˆPoCï¼‰çš„æ¼æ´æŠ¥å‘Šã€‚</p>
<p>ä¹‹å‰å‘å¸ƒè¿‡æ–‡ç« ä»‹ç»ï¼Œæ„Ÿå…´è¶£ç›´æ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxNjg4NDEzNA%3D%3D%26mid%3D2247528905%26idx%3D1%26sn%3D9ab20b6d2be6f72301b090173fbba93e%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxNjg4NDEzNA==&amp;mid=2247528905&amp;idx=1&amp;sn=9ab20b6d2be6f72301b090173fbba93e&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¹‹å‰çš„æ–‡ç« </a>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a16bfca0671543a0a26938a6714c2766~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=X8FBihnjEmt6EodURZttZ2WaGe0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€:Â https:<span class="hljs-comment">//github.com/usestrix/strix</span>
</code></pre>
<h2 data-id="heading-4">05ã€GUI ç»„ä»¶åº“</h2>
<p>GPUI Component æ˜¯ä¸€ä¸ªåŸºäº Rust è¯­è¨€çš„ GUI ç»„ä»¶åº“ï¼Œç°åœ¨Â 8.7KÂ çš„ Star äº†ï¼Œå®ƒæ˜¯å»ºç«‹åœ¨ Zed ç¼–è¾‘å™¨å¼€æºçš„é«˜æ€§èƒ½ UI æ¡†æ¶ GPUI ä¹‹ä¸Šçš„ã€‚</p>
<p>è¯¥é¡¹ç›®çš„ç›®æ ‡æ˜¯ä¸º Rust å¼€å‘è€…æä¾›ä¸€å¥—ç°ä»£ã€ç¾è§‚ä¸”é«˜æ€§èƒ½çš„é€šç”¨ UI ç»„ä»¶ï¼Œæå¤§åœ°é™ä½ä½¿ç”¨ GPUI å¼€å‘è·¨å¹³å°æ¡Œé¢åº”ç”¨çš„é—¨æ§›ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06eb74f9eae840fbb3d2a13c710bbcd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=yLzgb0Cp%2FtZOJ2mqR%2FYb9%2BAp0q4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¯¥åº“æä¾›äº†Â 60 å¤šä¸ªç°æˆçš„ UI ç»„ä»¶ï¼Œè®¾è®¡é£æ ¼çµæ„Ÿæ¥æºäº shadcn/uiï¼Œæ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜åˆ‡æ¢å’Œè‡ªå®šä¹‰ä¸»é¢˜ã€‚</p>
<p>å®ƒç»§æ‰¿äº† GPUI çš„é«˜æ€§èƒ½ç‰¹æ€§ï¼ŒåŒ…å«è™šæ‹Ÿåˆ—è¡¨ã€Dock å¸ƒå±€ç³»ç»Ÿã€Markdown æ¸²æŸ“ã€å›¾è¡¨ä»¥åŠé«˜æ€§èƒ½çš„ä»£ç ç¼–è¾‘å™¨ç»„ä»¶ã€‚</p>
<p>å®ƒæ—¨åœ¨æä¾›ç±»ä¼¼ Web å¼€å‘çš„ä¾¿æ·ä½“éªŒï¼ŒåŒæ—¶ä¿æŒåŸç”Ÿåº”ç”¨çš„é€Ÿåº¦ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c4f9d950f4c431d87fb6db07880412e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=GfnggvmjSumYfTFQCdZvBsT4gO4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">é¡¹ç›®é“¾æ¥:Â https:<span class="hljs-comment">//github.com/longbridge/gpui-component</span>
</code></pre>
<h2 data-id="heading-5">06ã€API å®¢æˆ·ç«¯ï¼š<strong>Yaak</strong></h2>
<p>Yaak æ˜¯ä¸€æ¬¾æå…¶ç›´è§‚ã€ç°ä»£åŒ–çš„æ¡Œé¢ API å®¢æˆ·ç«¯ï¼Œè¢«è§†ä¸º Postman æˆ– Insomnia çš„æœ‰åŠ›ç«äº‰è€…ã€‚ç°åœ¨ 16K+ çš„ Star ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0bf1a2a93b574ad6bb110b1eab5603a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=nSbprzzwFKbqqmnAR5gsck3M6hc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯ä¿æŠ¤éšç§å’Œç¦»çº¿ä¼˜å…ˆï¼Œä¸ºä½ æä¾›ä¸€ä¸ªå¿«é€Ÿã€æ— å¹²æ‰°ä¸”æ— äº‘ç«¯é”å®šçš„ API è°ƒè¯•ç¯å¢ƒã€‚</p>
<p>Yaak åŸºäº Tauriã€Rust å’Œ React æ„å»ºï¼Œä½“ç§¯å°å·§ä¸”å¯åŠ¨è¿…é€Ÿã€‚å®ƒæ”¯æŒ RESTã€GraphQLã€WebSocketã€Server Sent Events (SSE) å’Œ gRPC ç­‰å¤šç§åè®®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d133bbcc8b15438c9e0af4f8a1a9b3dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=Kn7UGwgPLazusnOYQrAbrbddEX8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åŠŸèƒ½ä¸Šï¼Œå®ƒæ”¯æŒå¯¼å…¥ Postman/OpenAPI é›†åˆã€ç¯å¢ƒä¸å˜é‡ç®¡ç†ã€Cookie ç®¡ç†ä»¥åŠé€šè¿‡æ’ä»¶ç³»ç»Ÿè¿›è¡Œæ‰©å±•ã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒæ²¡æœ‰å¼ºåˆ¶ç™»å½•å’Œé¥æµ‹ï¼Œæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¸”æ˜“äºé€šè¿‡ Git è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8929db7a54d04db29e3f5697fd90b4f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=G2EIycZ3g20EdMq8pjVWIlvWoGo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">é¡¹ç›®é“¾æ¥:Â https:<span class="hljs-comment">//github.com/mountain-loop/yaak</span>
</code></pre>
<h2 data-id="heading-6">07ã€Agent Lightning</h2>
<p>Agent Lightning æ˜¯å¾®è½¯ç ”ç©¶é™¢æ¨å‡ºçš„ä¸€ä¸ªæ¡†æ¶ï¼Œè¢«èª‰ä¸ºç‚¹äº® AI æ™ºèƒ½ä½“çš„ç»ˆæè®­ç»ƒå¸ˆã€‚</p>
<p>è§£å†³ AI Agent å¼€å‘ä¸­çš„ä¼˜åŒ–éš¾é—®é¢˜ï¼šå¦‚ä½•åƒè®­ç»ƒç¥ç»ç½‘ç»œä¸€æ ·ï¼Œç³»ç»Ÿæ€§åœ°ä¼˜åŒ– Agent çš„æç¤ºè¯ï¼ˆPromptï¼‰ã€å·¥å…·ä½¿ç”¨ç­–ç•¥å’Œå†³ç­–æµç¨‹ï¼Œè€Œæ— éœ€å¤§è§„æ¨¡é‡å†™ä»£ç ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d06221bf5da14a08abb02f59d0520913~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=Z5TqRPDnwPsfXrurPTXX95hN4dQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¯¥æ¡†æ¶é‡‡ç”¨å‡ ä¹é›¶ä»£ç ä¿®æ”¹çš„è®¾è®¡ç†å¿µï¼Œå…¼å®¹ LangChainã€AutoGenã€CrewAI ç­‰ä¸»æµ Agent æ¡†æ¶ã€‚</p>
<p>å®ƒé€šè¿‡Â LightningStoreÂ æ”¶é›† Agent çš„è¿è¡Œè½¨è¿¹ï¼Œå¹¶åˆ©ç”¨å¼ºåŒ–å­¦ä¹ ã€è‡ªåŠ¨æç¤ºè¯ä¼˜åŒ–ç­‰ç®—æ³•æ¥åˆ†æè¿™äº›è½¨è¿¹ï¼Œè¿›è€Œæ›´æ–° Agent çš„èµ„æºã€‚</p>
<p>å®ƒæ„å»ºäº†ä¸€ä¸ªä»æ¨ç†åˆ°åé¦ˆå†åˆ°æ›´æ–°çš„é—­ç¯ä¼˜åŒ–æµã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd926c131ab24a3eb0bc9819566625fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=DPfqmjK0I0yBrGU5aRhGB4zHBW4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Agent Lightning é€‚ç”¨äºæ„å»ºå¤æ‚ AI æ™ºèƒ½ä½“ç³»ç»Ÿçš„å¼€å‘è€…å’Œç ”ç©¶äººå‘˜ã€‚</p>
<p>å½“ä½ çš„ Agent è¡¨ç°ä¸ç¨³å®šã€ä»»åŠ¡å®Œæˆç‡ä½æ—¶ï¼Œé€šè¿‡è¯¥å·¥å…·å¯ä»¥å¼•å…¥ç³»ç»Ÿæ€§çš„ä¼˜åŒ–ç®—æ³•ï¼Œè‡ªåŠ¨è°ƒæ•´ Agent çš„è¡Œä¸ºç­–ç•¥ï¼Œè€Œæ— éœ€æ‰‹åŠ¨åå¤è°ƒè¯• Promptã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">é¡¹ç›®é“¾æ¥:Â https:<span class="hljs-comment">//github.com/microsoft/agent-lightning</span>
</code></pre>
<h2 data-id="heading-7">08ã€Claude Cookbooks</h2>
<p>Claude Cookbooks æ˜¯ Anthropic å®˜æ–¹ç»´æŠ¤çš„ï¼Œæ±‡é›†äº†å¤§é‡ä½¿ç”¨ Claude å¤§æ¨¡å‹çš„å®æˆ˜æ¡ˆä¾‹ã€Jupyter Notebooks å’Œæœ€ä½³å®è·µæŒ‡å—ã€‚</p>
<p>ç°åœ¨åœ¨ GitHub ä¸Šå·²ç»å¿« 30K çš„ Star äº†ã€‚<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d277de015553473ea5198239d54f2afb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=bazx5VQOyjN8REYr3hJWtX%2BCSDQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒå°±åƒä¸€æœ¬é£Ÿè°±ï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä»å…¥é—¨åˆ°ç²¾é€šçš„å„ç§çƒ¹é¥ªæ–¹æ³•ï¼Œå±•ç¤ºäº†å¦‚ä½•é«˜æ•ˆã€æœ‰è¶£åœ°åˆ©ç”¨ Claude çš„èƒ½åŠ›ã€‚</p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®å†…å®¹ä¸°å¯Œï¼Œæ¶µç›–äº†ä»åŸºç¡€çš„ API è°ƒç”¨åˆ°å¤æ‚çš„ Agent æ„å»ºã€‚ä¸»è¦åŒ…æ‹¬ï¼šå›¾åƒè§†è§‰å¤„ç†ã€å·¥å…·ä½¿ç”¨ã€é•¿æ–‡æœ¬å¤„ç†ã€RAGã€ä»¥åŠæœ€æ–°çš„æ‰©å±•æ€ç»´ç­‰é«˜çº§ç‰¹æ€§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9028d0f0e5704c16a1b94c10e674ad1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=V4ivXY41pNaCbBg8i9D0orA%2BLHY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä»£ç ä¸»è¦ä½¿ç”¨ Python ç¼–å†™ï¼Œç»“æ„æ¸…æ™°ï¼Œæ–¹ä¾¿å¼€å‘è€…ç›´æ¥å¤åˆ¶ç²˜è´´æˆ–è¿›è¡Œå¾®è°ƒã€‚å¯¹äºä»»ä½•ä½¿ç”¨ Claude API çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™æ˜¯å¿…è¯»çš„å‚è€ƒèµ„æ–™ã€‚</p>
<p>æ— è®ºä½ æ˜¯æƒ³äº†è§£å¦‚ä½•ä¼˜åŒ– Promptã€å¦‚ä½•è®© Claude æ“ä½œå¤–éƒ¨æ•°æ®åº“ï¼Œè¿˜æ˜¯æƒ³æ„å»ºå¤æ‚çš„è‡ªåŠ¨åŒ–å·¥ä½œæµï¼Œè¿™é‡Œéƒ½èƒ½æ‰¾åˆ°ç»è¿‡å®˜æ–¹éªŒè¯çš„é«˜è´¨é‡ä»£ç ç¤ºä¾‹ã€‚</p>
<p>å®ƒæ˜¯å­¦ä¹  Claude æœ€æ–°ç‰¹æ€§çš„æœ€å¿«é€”å¾„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/754bd2ad886945d9a8eb55ab807d999f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=XBZ0HOr0OJYqzI1VZaG%2FlX2FJgs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">é¡¹ç›®é“¾æ¥:Â https:<span class="hljs-comment">//github.com/anthropics/claude-cookbooks</span>
</code></pre>
<h2 data-id="heading-8">09ã€MineContext</h2>
<p>è¿™ä¸ªå­—èŠ‚å¼€æºçš„ GitHub é¡¹ç›®å·²ç»è·å¾— 4.2K çš„ Star äº†ã€‚MineContext æ˜¯ä¸€æ¬¾ä¸»åŠ¨å¼ä¸Šä¸‹æ–‡æ„ŸçŸ¥ AI åŠ©æ‰‹ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒç†å¿µæ˜¯é€šè¿‡ä¸Šä¸‹æ–‡å·¥ç¨‹æ¥æ•æ‰ç”¨æˆ·çš„æ•°å­—ç”Ÿæ´»ç‰‡æ®µã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d3c4e9d906841faa8dc7b20509887f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=wwEWqEPLIPBFaohSpxH2MppF%2F7I%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¯¥å·¥å…·èƒ½å¤Ÿé€šè¿‡å±å¹•æˆªå›¾ã€å†…å®¹ç†è§£ç­‰æ–¹å¼ï¼Œè®°å½•å¹¶ç†è§£ç”¨æˆ·åœ¨è®¡ç®—æœºä¸Šçš„å·¥ä½œæµï¼Œä»è€Œæˆä¸ºä¸€ä¸ªçœŸæ­£æ‡‚ä½ çš„ç¬¬äºŒå¤§è„‘ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">é¡¹ç›®é“¾æ¥:Â https:<span class="hljs-comment">//github.com/volcengine/MineContext</span>
</code></pre>
<p>è¯¥é¡¹ç›®ä¸“æ³¨äºå¤šæ¨¡æ€å’Œå¤šæºä¿¡æ¯çš„æ•´åˆã€‚å®ƒåˆ©ç”¨ OCR å’Œè§†è§‰ç†è§£æŠ€æœ¯ï¼Œå°†ç”¨æˆ·çš„å±å¹•æ´»åŠ¨è½¬åŒ–ä¸ºç»“æ„åŒ–çš„ä¸Šä¸‹æ–‡æ•°æ®ã€‚</p>
<p>å®ƒä¸ä»…èƒ½è¢«åŠ¨å›ç­”é—®é¢˜ï¼Œè¿˜èƒ½ä¸»åŠ¨ç”Ÿæˆæ¯æ—¥/æ¯å‘¨æ‘˜è¦ã€å¾…åŠäº‹é¡¹åˆ—è¡¨å’Œæ´»åŠ¨è®°å½•ã€‚</p>
<p>å¯¹äºå¸Œæœ›åœ¨ä¿æŠ¤éšç§çš„å‰æä¸‹ï¼Œåˆ©ç”¨ AI æ¥å›æº¯å·¥ä½œå†å²ã€æå–å…³é”®æ´å¯Ÿæˆ–è¾…åŠ©åˆ›ä½œçš„ç”¨æˆ·æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªå¥½ç”¨çš„å¼€æºé¡¹ç›®ã€‚</p>
<h2 data-id="heading-9">10ã€x402 æ”¯ä»˜åè®®</h2>
<p>x402 æ˜¯ç”± Coinbase å¼€æºçš„ä¸€ä¸ªåŸºäº HTTP æ„å»ºçš„äº’è”ç½‘æ”¯ä»˜åè®®ã€‚ç°åœ¨å·²ç» 4.7K çš„ Star äº†ã€‚</p>
<p>å‘½åçµæ„Ÿæ¥æºäº HTTP çŠ¶æ€ç  "402 Payment Required"ã€‚</p>
<p>è¯¥é¡¹ç›®çš„æ„¿æ™¯æ˜¯å»ºç«‹ä¸€ä¸ªå¼€æ”¾ã€åŸç”Ÿçš„äº’è”ç½‘æ”¯ä»˜æ ‡å‡†ï¼Œè®©æ•°å­—è´§å¸æ”¯ä»˜åƒæ•°æ®ä¼ è¾“ä¸€æ ·ç®€å•å’Œæ™®éï¼Œæ¶ˆé™¤ä¼ ç»Ÿä¿¡ç”¨å¡æ”¯ä»˜çš„é«˜é—¨æ§›å’Œé«˜æ‰‹ç»­è´¹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c07acc9fd5949e3863c74182d1aac01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=hlbcpuCCFwSZw5XSN%2FaHE7Ii%2F%2BU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¯¥åè®®éå¸¸é€‚åˆéœ€è¦æä½æˆæœ¬ã€é«˜é¢‘æ¬¡äº¤æ˜“çš„åœºæ™¯ï¼Œä¾‹å¦‚ API è°ƒç”¨è®¡è´¹ã€AI Â Agent ä¹‹é—´çš„è‡ªåŠ¨ä»˜è´¹ã€å†…å®¹ä»˜è´¹å¢™ç­‰ã€‚</p>
<p>é€šè¿‡ x402ï¼Œå¼€å‘è€…å¯ä»¥ç”¨æå°‘çš„ä»£ç ï¼Œå·ç§°ä»…éœ€ä¸€è¡Œè®©è‡ªå·±çš„æœåŠ¡å…·å¤‡æ¥æ”¶æ•°å­—ç¾å…ƒæˆ–å…¶ä»–åŠ å¯†èµ„äº§çš„èƒ½åŠ›ï¼Œæå¤§åœ°ä¿ƒè¿›äº†æœºå™¨å¯¹æœºå™¨ï¼ˆM2Mï¼‰ç»æµç½‘ç»œçš„å‘å±•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f7a5ebf4981498fa86c08586d2e5992~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=5DyPpKQQ2sdw7H6rK9ItPwxySuA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">é¡¹ç›®é“¾æ¥:Â https:<span class="hljs-comment">//github.com/coinbase/x402</span>
</code></pre>
<h2 data-id="heading-10">11ã€å¯¹è±¡å­˜å‚¨ç³»ç»Ÿï¼šMinIO</h2>
<p>MinIO æ˜¯å…¨çƒé¢†å…ˆçš„é«˜æ€§èƒ½ã€S3 å…¼å®¹çš„å¯¹è±¡å­˜å‚¨ç³»ç»Ÿã€‚ç°åœ¨å·²ç» Â 58.7K+ çš„ Star äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a820fae39cb43fda552f38ff54e07e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=w5WWoJQp11qQh9GCP3WoSZu%2Blpg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½œä¸ºäº‘åŸç”Ÿæ•°æ®åŸºç¡€è®¾æ–½çš„æ ‡æ†ï¼Œå®ƒä¸“é—¨ä¸ºå¤§è§„æ¨¡ AI/MLã€æ•°æ®åˆ†æå’Œåº”ç”¨æ•°æ®å·¥ä½œè´Ÿè½½è€Œè®¾è®¡ã€‚</p>
<p>MinIO å®Œå…¨å¼€æºï¼Œä¸ä»…å¯ä»¥ä½œä¸ºå…¬æœ‰äº‘çš„æ›¿ä»£æ–¹æ¡ˆï¼Œæ›´æ˜¯ç§æœ‰äº‘å’Œè¾¹ç¼˜è®¡ç®—åœºæ™¯ä¸‹çš„é¦–é€‰å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/450410dd28564675ba39b374c2f2d647~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334475&amp;x-signature=XFCd7SE1I%2F8N2N%2BhUukFAY%2FZ2dM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒèƒ½å¤Ÿå……åˆ†å‹æ¦¨ç¡¬ä»¶æ½œåŠ›ï¼Œæä¾›æé«˜çš„è¯»å†™ååé‡ã€‚</p>
<p>å®ƒå®Œå…¨å…¼å®¹ Amazon S3 APIï¼Œæ„å‘³ç€ç°æœ‰çš„ S3 ç”Ÿæ€å·¥å…·å’Œåº”ç”¨å¯ä»¥æ— ç¼è¿ç§»ã€‚å…¶æ¶æ„è½»é‡ä¸”å»ä¸­å¿ƒåŒ–ï¼Œæ”¯æŒçº åˆ ç ï¼ˆErasure Codingï¼‰å’Œæ¯”ç‰¹ç½—ç‰¹ï¼ˆBitrotï¼‰ä¿æŠ¤ï¼Œç¡®ä¿æ•°æ®çš„é«˜å¯ç”¨æ€§å’ŒæŒä¹…æ€§ã€‚</p>
<p>å®ƒè¿˜åŸç”Ÿæ”¯æŒ Kubernetesï¼Œéå¸¸é€‚åˆåœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­éƒ¨ç½²ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">é¡¹ç›®é“¾æ¥:Â https:<span class="hljs-comment">//github.com/minio/minio</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ ç”¨ TRAE æ„å»ºé«˜æ€§èƒ½ã€ŒExcel å¤§æ•°æ®å¯¼å…¥å¯¼å‡ºæ¨¡å—ã€ï¼šç™¾ä¸‡çº§æ•°æ®çš„ä¸æ»‘ä½“éªŒï¼]]></title>    <link>https://juejin.cn/post/7579190764770557992</link>    <guid>https://juejin.cn/post/7579190764770557992</guid>    <pubDate>2025-12-03T02:49:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579190764770557992" data-draft-id="7579190764770508840" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ ç”¨ TRAE æ„å»ºé«˜æ€§èƒ½ã€ŒExcel å¤§æ•°æ®å¯¼å…¥å¯¼å‡ºæ¨¡å—ã€ï¼šç™¾ä¸‡çº§æ•°æ®çš„ä¸æ»‘ä½“éªŒï¼"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2025-12-03T02:49:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å¤©æ‘¸é±¼çš„javaå·¥ç¨‹å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3109843365802925"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ ç”¨ TRAE æ„å»ºé«˜æ€§èƒ½ã€ŒExcel å¤§æ•°æ®å¯¼å…¥å¯¼å‡ºæ¨¡å—ã€ï¼šç™¾ä¸‡çº§æ•°æ®çš„ä¸æ»‘ä½“éªŒï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3109843365802925/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å¤©æ‘¸é±¼çš„javaå·¥ç¨‹å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:49:11.000Z" title="Wed Dec 03 2025 02:49:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš€ ç”¨ TRAE æ„å»ºé«˜æ€§èƒ½ã€ŒExcel å¤§æ•°æ®å¯¼å…¥å¯¼å‡ºæ¨¡å—ã€ï¼šç™¾ä¸‡çº§æ•°æ®çš„ä¸æ»‘ä½“éªŒï¼</h2>
<blockquote>
<p>ğŸ“Œ æ ‡ç­¾ï¼š#TRAE SOLO #å¤§æ•°æ®å¯¼å‡º #SpringBootå®æˆ˜ #Excelå¯¼å…¥å¯¼å‡º #çº¿ç¨‹æ±  #æ€§èƒ½ä¼˜åŒ– #AIå¼€å‘ #å®æˆ˜èµ›æŠ•ç¨¿</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">âœ¨ é¡¹ç›®èƒŒæ™¯ï¼šå¯¼å…¥å¯¼å‡ºï¼Œç»ä¸ç®€å•ï¼</h3>
<p>åœ¨æ—¥å¸¸ä¸šåŠ¡å¼€å‘ä¸­ï¼Œ<strong>æ•°æ®å¯¼å…¥å¯¼å‡º</strong> æ˜¯ä¸€ä¸ªçœ‹ä¼¼ç®€å•å´ææ˜“è¸©å‘çš„åŠŸèƒ½ã€‚å°¤å…¶å½“ä½ é¢å¯¹ <strong>ç™¾ä¸‡çº§æ•°æ® Excel å¯¼å‡º</strong> æ—¶ï¼Œå†…å­˜æº¢å‡ºã€æ€§èƒ½ç“¶é¢ˆã€ç”¨æˆ·å¡é¡¿ç­‰é—®é¢˜æ¥è¸µè€Œè‡³ã€‚</p>
<p>è¿™æ¬¡å€ŸåŠ© <strong>TRAE SOLO å¹³å°</strong>ï¼Œæˆ‘å°è¯•ç”¨ AI å¸®æˆ‘æ„å»ºä¸€ä¸ª<strong>é«˜æ€§èƒ½ã€å¯æ‰©å±•ã€å¯å¤ç”¨çš„è½¦è¾†ä¿¡æ¯å¯¼å…¥å¯¼å‡ºæ¨¡å—</strong>ï¼Œå¹¶è¿›è¡Œäº†ä¸€ç³»åˆ—å®æˆ˜ä¼˜åŒ–ï¼Œæœ€ç»ˆå®ç°äº†ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29cc53690eee4e41860961301e77d124~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5pG46bG855qEamF2YeW3peeoi-W4iA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334951&amp;x-signature=oAS7nQsQnuCHt%2FeDCRqkMyVMFCY%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>âœ… <strong>10 ä¸‡æ¡è®°å½•å¯¼å‡ºåªéœ€ 31 ç§’</strong><br/>
âœ… <strong>32MB ç¼“å†²å†™å…¥ã€åˆ†é¡µæŸ¥è¯¢ã€ä¸»é”®ç´¢å¼•ä¼˜åŒ–</strong><br/>
âœ… <strong>æ”¯æŒæ³›å‹ã€æ”¯æŒå¤§æ•°æ®åˆ†é¡µå¯¼å‡ºä¸å¯¼å…¥</strong><br/>
âœ… <strong>å¯¼å‡ºè¿›åº¦å¯è§†åŒ–ï¼Œå¯¼å…¥ç»“æ„å¯é…ç½®</strong></p>
</blockquote>
<p>å®˜æ–¹æˆªå›¾å¦‚ä¸‹ğŸ‘‡ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0e125e9823c44ef9cca130112ef6490~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5pG46bG855qEamF2YeW3peeoi-W4iA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334951&amp;x-signature=IfuwguEO2c4rxJ%2FdtznN745JbeY%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-2">ğŸ§  TRAE SOLO åŠ©åŠ›ï¼šä» AI åˆ°å®æˆ˜çš„å…¨è¿‡ç¨‹</h3>
<p>åœ¨ SOLO Coder ä¸­ï¼Œæˆ‘è¾“å…¥å¦‚ä¸‹è‡ªç„¶è¯­è¨€ Promptï¼š</p>
<pre><code class="hljs">è¯·å¸®æˆ‘å†™ä¸€ä¸ªæ”¯æŒå¤§æ•°æ®å¯¼å‡ºçš„ Excel å·¥å…·ç±»ï¼ŒåŸºäº Spring Data JPAï¼Œæ”¯æŒ SXSSFWorkbookï¼Œåˆ†é¡µå¯¼å‡ºï¼Œé¿å…å†…å­˜æº¢å‡ºï¼Œè€ƒè™‘æ€§èƒ½ä¼˜åŒ–ã€‚
</code></pre>
<p>TRAE å¾ˆå¿«ç»™å‡ºäº†ä¸€ä¸ªåˆå§‹æ¨¡æ¿ï¼Œæˆ‘åœ¨æ­¤åŸºç¡€ä¸Šæ‰‹åŠ¨å¾®è°ƒï¼ŒåŠ å…¥äº†ç¼“å­˜åå°„å­—æ®µã€è¾“å‡ºæµç¼“å†²åŒºã€è‡ªå®šä¹‰åˆ†é¡µå‚æ•°ç­‰å†…å®¹ã€‚</p>
<hr/>
<h3 data-id="heading-3">ğŸ§© å¯¼å‡ºæ ¸å¿ƒé€»è¾‘è§£æï¼ˆåˆ†é¡µ + SXSSFï¼‰</h3>
<p>ä»¥ä¸‹æ˜¯å®é™…ä½¿ç”¨çš„æ ¸å¿ƒå¯¼å‡ºæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">public &lt;R extends JpaRepository&lt;T, ?&gt;&gt; void exportExcelWithPagination(
    R repository, int pageSize, Class&lt;T&gt; clazz, OutputStream outputStream) throws Exception {
    
    long <span class="hljs-attr">total</span> = repository.count()<span class="hljs-comment">;</span>
    log.info("å¼€å§‹æ•°æ®åº“ä¼˜åŒ–ç‰ˆå¯¼å‡ºï¼Œå…± {} æ¡è®°å½•", total)<span class="hljs-comment">;</span>
    
    try (SXSSFWorkbook <span class="hljs-attr">workbook</span> = new SXSSFWorkbook()) {
        workbook.setCompressTempFiles(true)<span class="hljs-comment">;</span>
        Sheet <span class="hljs-attr">sheet</span> = workbook.createSheet(clazz.getSimpleName())<span class="hljs-comment">;</span>
        
        // ç¼“å­˜å­—æ®µä»¥æå‡åå°„æ€§èƒ½
        Field<span class="hljs-section">[]</span> <span class="hljs-attr">fields</span> = clazz.getDeclaredFields()<span class="hljs-comment">;</span>
        List&lt;Field&gt; <span class="hljs-attr">cachedFields</span> = new ArrayList&lt;&gt;()<span class="hljs-comment">;</span>
        for (Field field : fields) {
            field.setAccessible(true)<span class="hljs-comment">;</span>
            cachedFields.add(field)<span class="hljs-comment">;</span>
        }

        // åˆ›å»ºè¡¨å¤´
        Row <span class="hljs-attr">headerRow</span> = sheet.createRow(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
        for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; cachedFields.size(); i++) {</span>
            Cell <span class="hljs-attr">cell</span> = headerRow.createCell(i)<span class="hljs-comment">;</span>
            cell.setCellValue(cachedFields.get(i).getName())<span class="hljs-comment">;</span>
        }

        int <span class="hljs-attr">rowNum</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
        <span class="hljs-attr">pageSize</span> = <span class="hljs-number">30000</span><span class="hljs-comment">; // æ‰¹é‡å¯¼å‡ºä¼˜åŒ–ç‚¹</span>

        int <span class="hljs-attr">totalPages</span> = (int) Math.ceil((double) total / pageSize)<span class="hljs-comment">;</span>
        for (int <span class="hljs-attr">page</span> = <span class="hljs-number">0</span><span class="hljs-comment">; page &lt; totalPages; page++) {</span>
            PageRequest <span class="hljs-attr">pageRequest</span> = PageRequest.of(page, pageSize)<span class="hljs-comment">;</span>
            List&lt;T&gt; <span class="hljs-attr">pageData</span> = repository.findAll(pageRequest).getContent()<span class="hljs-comment">;</span>

            for (T data : pageData) {
                Row <span class="hljs-attr">dataRow</span> = sheet.createRow(rowNum++)<span class="hljs-comment">;</span>
                for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; cachedFields.size(); i++) {</span>
                    Object <span class="hljs-attr">value</span> = cachedFields.get(i).get(data)<span class="hljs-comment">;</span>
                    dataRow.createCell(i).setCellValue(value != null ? value.toString() : "")<span class="hljs-comment">;</span>
                }
            }
        }

        // é«˜æ•ˆå†™å…¥ï¼šä½¿ç”¨ 32MB ç¼“å†²åŒº
        BufferedOutputStream <span class="hljs-attr">bos</span> = new BufferedOutputStream(outputStream, <span class="hljs-number">32</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>)<span class="hljs-comment">;</span>
        workbook.write(bos)<span class="hljs-comment">;</span>
        bos.flush()<span class="hljs-comment">;</span>
    } finally {
        outputStream.close()<span class="hljs-comment">;</span>
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-4">ğŸ“¥ å¯¼å…¥é€»è¾‘ï¼šåå°„èµ‹å€¼ + ç±»å‹å…¼å®¹</h3>
<pre><code class="hljs language-ini" lang="ini">public List&lt;T&gt; importExcel(InputStream inputStream, Class&lt;T&gt; clazz) throws Exception {
    List&lt;T&gt; <span class="hljs-attr">dataList</span> = new ArrayList&lt;&gt;()<span class="hljs-comment">;</span>
    try (Workbook <span class="hljs-attr">workbook</span> = WorkbookFactory.create(inputStream)) {
        Sheet <span class="hljs-attr">sheet</span> = workbook.getSheetAt(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
        Iterator&lt;Row&gt; <span class="hljs-attr">rows</span> = sheet.iterator()<span class="hljs-comment">;</span>

        // è·³è¿‡è¡¨å¤´
        if (rows.hasNext()) rows.next()<span class="hljs-comment">;</span>

        Field<span class="hljs-section">[]</span> <span class="hljs-attr">fields</span> = clazz.getDeclaredFields()<span class="hljs-comment">;</span>

        while (rows.hasNext()) {
            Row <span class="hljs-attr">row</span> = rows.next()<span class="hljs-comment">;</span>
            T <span class="hljs-attr">obj</span> = clazz.newInstance()<span class="hljs-comment">;</span>

            for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; fields.length &amp;&amp; i &lt; row.getLastCellNum(); i++) {</span>
                fields<span class="hljs-section">[i]</span>.setAccessible(true)<span class="hljs-comment">;</span>
                Cell <span class="hljs-attr">cell</span> = row.getCell(i)<span class="hljs-comment">;</span>
                String <span class="hljs-attr">value</span> = getCellValue(cell)<span class="hljs-comment">;</span>
                setFieldValue(fields<span class="hljs-section">[i]</span>, obj, value)<span class="hljs-comment">;</span>
            }

            dataList.add(obj)<span class="hljs-comment">;</span>
        }
    }
    return dataList<span class="hljs-comment">;</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-5">ğŸ§ª å®æµ‹ç»“æœï¼š10 ä¸‡æ¡æ•°æ®ï¼Œ30 ç§’å®Œæˆï¼</h3>
<p>æˆªå›¾å±•ç¤ºå¯¼å‡ºå®Œæˆåçš„è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/980e933d99c94721a5c1356458eed04a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5pG46bG855qEamF2YeW3peeoi-W4iA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765334951&amp;x-signature=mn1zqHtflZcDG7MS8rmllirMZo8%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>âœ… æˆåŠŸå¯¼å‡ºï¼š<code>100005</code> æ¡æ•°æ®</li>
<li>âœ… æ€»è€—æ—¶ï¼š<code>31 ç§’</code></li>
<li>âœ… å®é™…å†™å…¥å¤§å°ï¼šçº¦ <code>24MB</code></li>
<li>âœ… æ§åˆ¶å°æ—¥å¿—ç²¾ç¡®æ‰“å°è¿›åº¦ä¸é€Ÿç‡</li>
</ul>
<hr/>
<h3 data-id="heading-6">ğŸ”§ æ€§èƒ½ä¼˜åŒ–ç»†èŠ‚æ€»ç»“</h3>

































<table><thead><tr><th>ä¼˜åŒ–ç‚¹</th><th>æè¿°</th></tr></thead><tbody><tr><td>âœ… SXSSFWorkbook</td><td>æ”¯æŒå¤§æ•°æ®æµå¼å†™å…¥ï¼Œå†…å­˜å ç”¨æä½</td></tr><tr><td>âœ… åˆ†é¡µæŸ¥è¯¢</td><td>æ¯é¡µ 3w æ¡æ•°æ®ï¼Œé¿å…ä¸€æ¬¡æ€§æ‹‰å…¨è¡¨</td></tr><tr><td>âœ… ä¸»é”®ç´¢å¼•åˆ†é¡µ</td><td><code>PageRequest.of(page, size)</code> é»˜è®¤æŒ‰ä¸»é”®</td></tr><tr><td>âœ… ç¼“å­˜å­—æ®µ</td><td>å‡å°‘åå°„å¼€é”€ï¼Œæå‡å¤„ç†é€Ÿåº¦</td></tr><tr><td>âœ… 32MB ç¼“å†²æµ</td><td>å‡å°‘ç£ç›˜ I/Oï¼Œæå‡å†™å…¥æ•ˆç‡</td></tr><tr><td>âœ… æ§åˆ¶å°æ—¥å¿—</td><td>å®æ—¶æ‰“å°å¯¼å‡ºè¿›åº¦ã€é€Ÿç‡ã€è€—æ—¶</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-7">ğŸ”„ å¯æ‰©å±•æ€§è®¾è®¡</h3>
<ul>
<li>âœ… æ³›å‹æ”¯æŒä»»æ„å®ä½“ç±»å¯¼å‡ºå¯¼å…¥</li>
<li>âœ… æ”¯æŒå¤šçº¿ç¨‹æˆ–çº¿ç¨‹æ± å¼‚æ­¥å¯¼å…¥ï¼ˆå¯æ‰©å±•ï¼‰</li>
<li>âœ… æ”¯æŒå¯¼å‡ºè¿›åº¦å‰ç«¯å±•ç¤ºï¼ˆå¦‚å›¾æ‰€ç¤ºï¼‰</li>
<li>âœ… æ”¯æŒå‰ç«¯ä¸Šä¼  Excel æ–‡ä»¶å¯¼å…¥åæ‰¹é‡å…¥åº“</li>
</ul>
<p>æœªæ¥å¯ä»¥ç»§ç»­åŠ å…¥ï¼š</p>
<ul>
<li>âœ… æ–‡ä»¶æ ¼å¼æ ¡éªŒï¼ˆå¦‚æ¨¡æ¿ä¸€è‡´æ€§ï¼‰</li>
<li>âœ… Excel æ ¡éªŒæç¤ºï¼ˆå­—æ®µç±»å‹ã€é•¿åº¦ã€æšä¸¾å€¼ï¼‰</li>
<li>âœ… å¯¼å…¥å¤±è´¥æ—¥å¿—è®°å½•ä¸é‡è¯•æœºåˆ¶</li>
</ul>
<hr/>
<h3 data-id="heading-8">ğŸ§  ä½¿ç”¨ TRAE SOLO çš„å¿ƒå¾—</h3>
<p>è¿™æ¬¡æˆ‘é€šè¿‡ TRAE SOLO å¿«é€Ÿå®Œæˆäº†æ ¸å¿ƒéª¨æ¶æ­å»ºï¼Œæå¤§åœ°èŠ‚çœäº†æˆ‘ï¼š</p>
<ul>
<li>ğŸ§± æ¨¡æ¿ä»£ç ç¼–å†™æ—¶é—´</li>
<li>ğŸ§  æ€è€ƒæ¶æ„è®¾è®¡çš„è´Ÿæ‹…</li>
<li>ğŸš€ å¿«é€Ÿè¯•é”™å’Œè¿­ä»£æ•ˆç‡</li>
</ul>
<p>å®ƒä¸ä»…ä»…æ˜¯â€œå†™ä»£ç çš„å·¥å…·â€ï¼Œæ›´æ˜¯ä¸€ä¸ªâ€œå¼€å‘æ€ç»´çš„åŠ é€Ÿå™¨â€ã€‚</p>
<hr/>
<h3 data-id="heading-9">âœ… æ€»ç»“</h3>
<p>è¿™æ¬¡é€šè¿‡ TRAE SOLO çš„å®æˆ˜ä½“éªŒï¼Œæˆ‘å®Œæˆäº†ä¸€ä¸ª<strong>å®ç”¨æ€§å¼ºã€æ€§èƒ½ä¼˜ç§€ã€å¯å¤ç”¨æ€§é«˜</strong>çš„å¯¼å‡ºå¯¼å…¥æ¨¡å—ï¼Œè§£å†³äº†å¤§æ•°æ®åœºæ™¯ä¸‹å¸¸è§çš„å¡é¡¿å’Œ OOM é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š6.åŠ¨ç”»ç³»ç»Ÿçš„å®ç°]]></title>    <link>https://juejin.cn/post/7579127397498519603</link>    <guid>https://juejin.cn/post/7579127397498519603</guid>    <pubDate>2025-12-03T02:44:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579127397498519603" data-draft-id="7579111646875353139" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š6.åŠ¨ç”»ç³»ç»Ÿçš„å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2025-12-03T02:44:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="irises"/> <meta itemprop="url" content="https://juejin.cn/user/3030697436261735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç°2Dç»˜å›¾å¼•æ“ï¼š6.åŠ¨ç”»ç³»ç»Ÿçš„å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030697436261735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    irises
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T02:44:51.000Z" title="Wed Dec 03 2025 02:44:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flz6060788%2FMini-Render" target="_blank" title="https://github.com/lz6060788/Mini-Render" ref="nofollow noopener noreferrer">MiniRenderä»“åº“åœ°å€å‚è€ƒ</a></p>
</blockquote>
<p><strong>åŠ¨ç”»ç³»ç»Ÿ (Animation System)</strong>ã€‚</p>
<p>è¿™æ˜¯è®©é™æ€å›¾è¡¨å˜æˆâ€œæ´»â€å›¾è¡¨çš„å…³é”®ã€‚æˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯å†™æ­» <code>requestAnimationFrame</code>ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ª<strong>å£°æ˜å¼</strong>çš„åŠ¨ç”»åº“ï¼Œè®©å¼€å‘è€…åªéœ€è¦å‘Šè¯‰å¼•æ“â€œæˆ‘æƒ³å»å“ªé‡Œâ€ï¼Œå¼•æ“è‡ªåŠ¨è´Ÿè´£â€œæ€ä¹ˆå»â€ã€‚</p>
<hr/>
<h3 data-id="heading-0">1. æ ¸å¿ƒæ¨¡å—è®¾è®¡</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸‰ä¸ªæ–°æ–‡ä»¶ï¼š</p>
<ol>
<li><strong><code>Easing.ts</code></strong>: ç¼“åŠ¨å‡½æ•°åº“ï¼ˆæä¾› <code>linear</code>, <code>cubicOut</code> ç­‰æ•°å­¦å…¬å¼ï¼‰ã€‚</li>
<li><strong><code>Animator.ts</code></strong>: åŠ¨ç”»æ‰§è¡Œè€…ï¼ˆè´Ÿè´£å•ä¸ªå¯¹è±¡çš„å±æ€§æ’å€¼è®¡ç®—ï¼‰ã€‚</li>
<li><strong><code>Animation.ts</code></strong>: åŠ¨ç”»ç®¡ç†å™¨ï¼ˆè´Ÿè´£å…¨å±€çš„æ—¶é—´å¾ªç¯ Loopï¼Œè°ƒåº¦æ‰€æœ‰ Animatorï¼‰ã€‚</li>
</ol>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ <code>Element</code> å’Œ <code>MiniRender</code> ç±»æ¥é›†æˆè¿™ä¸ªç³»ç»Ÿã€‚</p>
<hr/>
<h3 data-id="heading-1">2. ç¼“åŠ¨å‡½æ•° (<code>src/animation/Easing.ts</code>)</h3>
<p>ç¼“åŠ¨å‡½æ•°è¾“å…¥ä¸€ä¸ª <code>0</code> åˆ° <code>1</code> çš„æ—¶é—´è¿›åº¦ <code>t</code>ï¼Œè¾“å‡ºä¸€ä¸ªå˜æ¢åçš„è¿›åº¦ <code>p</code>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/animation/Easing.ts</span>

<span class="hljs-keyword">type</span> <span class="hljs-title class_">EasingFunc</span> = <span class="hljs-function">(<span class="hljs-params">t: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Easing</span> = {
    <span class="hljs-attr">linear</span>: <span class="hljs-function">(<span class="hljs-params">t: <span class="hljs-built_in">number</span></span>) =&gt;</span> t,
    
    <span class="hljs-comment">// äºŒæ¬¡ç¼“åŠ¨</span>
    <span class="hljs-attr">quadraticIn</span>: <span class="hljs-function">(<span class="hljs-params">t: <span class="hljs-built_in">number</span></span>) =&gt;</span> t * t,
    <span class="hljs-attr">quadraticOut</span>: <span class="hljs-function">(<span class="hljs-params">t: <span class="hljs-built_in">number</span></span>) =&gt;</span> t * (<span class="hljs-number">2</span> - t),
    
    <span class="hljs-comment">// ä¸‰æ¬¡ç¼“åŠ¨ (å¸¸ç”¨ï¼Œè‡ªç„¶)</span>
    <span class="hljs-attr">cubicIn</span>: <span class="hljs-function">(<span class="hljs-params">t: <span class="hljs-built_in">number</span></span>) =&gt;</span> t * t * t,
    <span class="hljs-attr">cubicOut</span>: <span class="hljs-function">(<span class="hljs-params">t: <span class="hljs-built_in">number</span></span>) =&gt;</span> --t * t * t + <span class="hljs-number">1</span>,
    
    <span class="hljs-comment">// å¼¹æ€§ç¼“åŠ¨</span>
    <span class="hljs-attr">elasticOut</span>: <span class="hljs-function">(<span class="hljs-params">t: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> c4 = (<span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>) / <span class="hljs-number">3</span>;
        <span class="hljs-keyword">return</span> t === <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : t === <span class="hljs-number">1</span> ? <span class="hljs-number">1</span> :
            <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, -<span class="hljs-number">10</span> * t) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>((t * <span class="hljs-number">10</span> - <span class="hljs-number">0.75</span>) * c4) + <span class="hljs-number">1</span>;
    }
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">EasingType</span> = keyof <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Easing</span>;
</code></pre>
<hr/>
<h3 data-id="heading-2">3. åŠ¨ç”»æ‰§è¡Œè€… (<code>src/animation/Animator.ts</code>)</h3>
<p>è¿™æ˜¯æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚å®ƒéœ€è¦èƒ½å¤Ÿæ·±åº¦éå†å¯¹è±¡ï¼Œæ‰¾å‡ºæ•°å€¼å±æ€§ï¼Œå¹¶åœ¨èµ·å§‹å€¼å’Œç›®æ ‡å€¼ä¹‹é—´è¿›è¡Œæ’å€¼ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/animation/Animator.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Easing</span>, <span class="hljs-title class_">EasingType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Easing'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animator</span> {
    <span class="hljs-attr">target</span>: <span class="hljs-built_in">any</span>;
    
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_startState</span>: <span class="hljs-built_in">any</span> = {};
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_endState</span>: <span class="hljs-built_in">any</span>;
    
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_duration</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_easing</span>: <span class="hljs-title class_">EasingType</span>;
    
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_startTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_delay</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">private</span> _onUpdate?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
    <span class="hljs-keyword">private</span> _onDone?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
    
    <span class="hljs-comment">// æ ‡è®°åŠ¨ç”»æ˜¯å¦å·²ç»“æŸ</span>
    <span class="hljs-attr">isFinished</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">target: <span class="hljs-built_in">any</span>, endState: <span class="hljs-built_in">any</span>, duration: <span class="hljs-built_in">number</span>, easing: EasingType = <span class="hljs-string">'linear'</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span> = target;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_endState</span> = endState;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_duration</span> = duration;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_easing</span> = easing;
    }

    <span class="hljs-title function_">start</span>(<span class="hljs-params">time: <span class="hljs-built_in">number</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_startTime</span> = time + <span class="hljs-variable language_">this</span>.<span class="hljs-property">_delay</span>;
        <span class="hljs-comment">// æ ¸å¿ƒï¼šåœ¨å¼€å§‹ç¬é—´ï¼Œå…‹éš†å½“å‰çŠ¶æ€ä½œä¸ºèµ·å§‹çŠ¶æ€</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_startState</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_cloneState</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_endState</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span>);
    }

    <span class="hljs-comment">/**
     * æ¯ä¸€å¸§è°ƒç”¨æ­¤æ–¹æ³•
     * <span class="hljs-doctag">@param</span> globalTime å…¨å±€æ—¶é—´æˆ³
     * <span class="hljs-doctag">@return</span> boolean æ˜¯å¦æœ‰å˜åŒ–
     */</span>
    <span class="hljs-title function_">step</span>(<span class="hljs-attr">globalTime</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">boolean</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isFinished</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (globalTime &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_startTime</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// è¿˜æ²¡åˆ° delay æ—¶é—´</span>

        <span class="hljs-comment">// 1. è®¡ç®—è¿›åº¦ (0 ~ 1)</span>
        <span class="hljs-keyword">let</span> p = (globalTime - <span class="hljs-variable language_">this</span>.<span class="hljs-property">_startTime</span>) / <span class="hljs-variable language_">this</span>.<span class="hljs-property">_duration</span>;
        <span class="hljs-keyword">if</span> (p &gt;= <span class="hljs-number">1</span>) {
            p = <span class="hljs-number">1</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isFinished</span> = <span class="hljs-literal">true</span>;
        }

        <span class="hljs-comment">// 2. åº”ç”¨ç¼“åŠ¨</span>
        <span class="hljs-keyword">const</span> easingFunc = <span class="hljs-title class_">Easing</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">_easing</span>] || <span class="hljs-title class_">Easing</span>.<span class="hljs-property">linear</span>;
        <span class="hljs-keyword">const</span> v = <span class="hljs-title function_">easingFunc</span>(p);

        <span class="hljs-comment">// 3. æ‰§è¡Œæ’å€¼</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_interpolate</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_startState</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_endState</span>, v);

        <span class="hljs-comment">// 4. å›è°ƒ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_onUpdate</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onUpdate</span>();
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isFinished</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_onDone</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_onDone</span>();

        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">// API: è®¾ç½®å»¶è¿Ÿ</span>
    <span class="hljs-title function_">delay</span>(<span class="hljs-params">ms: <span class="hljs-built_in">number</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_delay</span> = ms;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// API: å®Œæˆå›è°ƒ</span>
    <span class="hljs-title function_">done</span>(<span class="hljs-params">cb: () =&gt; <span class="hljs-built_in">void</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_onDone</span> = cb;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// API: æ›´æ–°å›è°ƒ</span>
    <span class="hljs-title function_">update</span>(<span class="hljs-params">cb: () =&gt; <span class="hljs-built_in">void</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_onUpdate</span> = cb;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }

    <span class="hljs-comment">// --- å†…éƒ¨è¾…åŠ©æ–¹æ³• ---</span>

    <span class="hljs-comment">// é€’å½’æ’å€¼ï¼šå°† start åˆ° end çš„å€¼è®¾ç½®ç»™ target</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_interpolate</span>(<span class="hljs-params">target: <span class="hljs-built_in">any</span>, start: <span class="hljs-built_in">any</span>, end: <span class="hljs-built_in">any</span>, p: <span class="hljs-built_in">number</span></span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> end) {
            <span class="hljs-keyword">const</span> sVal = start[key];
            <span class="hljs-keyword">const</span> eVal = end[key];

            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> eVal === <span class="hljs-string">'number'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> sVal === <span class="hljs-string">'number'</span>) {
                <span class="hljs-comment">// æ•°å­—ï¼šç›´æ¥è®¡ç®—</span>
                target[key] = sVal + (eVal - sVal) * p;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(eVal) &amp;&amp; <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(sVal)) {
                <span class="hljs-comment">// æ•°ç»„ï¼šé€’å½’å¤„ç† (å¦‚ position: [x, y])</span>
                <span class="hljs-keyword">if</span> (!target[key]) target[key] = [];
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_interpolate</span>(target[key], sVal, eVal, p);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> eVal === <span class="hljs-string">'object'</span> &amp;&amp; eVal !== <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// å¯¹è±¡ï¼šé€’å½’å¤„ç† (å¦‚ style: { ... })</span>
                <span class="hljs-keyword">if</span> (!target[key]) target[key] = {};
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_interpolate</span>(target[key], sVal, eVal, p);
            }
            <span class="hljs-comment">// é¢œè‰²æ’å€¼æ¯”è¾ƒå¤æ‚ï¼ˆæ¶‰åŠå­—ç¬¦ä¸²è§£æï¼‰ï¼ŒStage 4 æš‚ä¸å®ç°ï¼Œç›´æ¥è·³å˜</span>
        }
    }

    <span class="hljs-comment">// é€’å½’å…‹éš†çŠ¶æ€ï¼šåªå…‹éš† endState ä¸­æœ‰çš„å±æ€§</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_cloneState</span>(<span class="hljs-params">end: <span class="hljs-built_in">any</span>, source: <span class="hljs-built_in">any</span></span>) {
        <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: <span class="hljs-built_in">any</span> = {};
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> end) {
            <span class="hljs-keyword">const</span> val = source[key];
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> end[key] === <span class="hljs-string">'object'</span> &amp;&amp; end[key] !== <span class="hljs-literal">null</span> &amp;&amp; !<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(end[key])) {
                <span class="hljs-comment">// é€’å½’å¯¹è±¡</span>
                res[key] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_cloneState</span>(end[key], val);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(end[key])) {
                <span class="hljs-comment">// æ‹·è´æ•°ç»„</span>
                res[key] = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(val || []);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// åŸºæœ¬ç±»å‹</span>
                res[key] = val;
            }
        }
        <span class="hljs-keyword">return</span> res;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-3">4. åŠ¨ç”»ç®¡ç†å™¨ (<code>src/animation/Animation.ts</code>)</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå•ä¾‹æˆ–è€…ä¾é™„äº MiniRender çš„ç®¡ç†å™¨ï¼Œè´Ÿè´£é©±åŠ¨ <code>requestAnimationFrame</code>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/animation/Animation.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Animator</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Animator'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animation</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_animators</span>: <span class="hljs-title class_">Animator</span>[] = [];
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_isRunning</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// æ³¨å…¥ MiniRender çš„åˆ·æ–°æ–¹æ³•</span>
    onFrame?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;

    <span class="hljs-title function_">add</span>(<span class="hljs-params">animator: Animator</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_animators</span>.<span class="hljs-title function_">push</span>(animator);
        <span class="hljs-comment">// è‡ªåŠ¨å¯åŠ¨ Animator</span>
        animator.<span class="hljs-title function_">start</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>());
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_isRunning</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_startLoop</span>();
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_startLoop</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_isRunning</span> = <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">const</span> <span class="hljs-title function_">step</span> = (<span class="hljs-params"/>) =&gt; {
            <span class="hljs-keyword">const</span> time = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
            <span class="hljs-keyword">let</span> hasChange = <span class="hljs-literal">false</span>;

            <span class="hljs-comment">// å€’åºéå†ï¼Œæ–¹ä¾¿åˆ é™¤</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_animators</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
                <span class="hljs-keyword">const</span> anim = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_animators</span>[i];
                <span class="hljs-keyword">const</span> changed = anim.<span class="hljs-title function_">step</span>(time);
                <span class="hljs-keyword">if</span> (changed) hasChange = <span class="hljs-literal">true</span>;

                <span class="hljs-comment">// ç§»é™¤å·²å®Œæˆçš„åŠ¨ç”»</span>
                <span class="hljs-keyword">if</span> (anim.<span class="hljs-property">isFinished</span>) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_animators</span>.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
                }
            }

            <span class="hljs-comment">// å¦‚æœæœ‰å±æ€§å˜åŒ–ï¼Œè§¦å‘å¤–éƒ¨é‡ç»˜</span>
            <span class="hljs-keyword">if</span> (hasChange &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFrame</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onFrame</span>();
            }

            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_animators</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
                <span class="hljs-title function_">requestAnimationFrame</span>(step);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">_isRunning</span> = <span class="hljs-literal">false</span>;
            }
        };

        <span class="hljs-title function_">requestAnimationFrame</span>(step);
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-4">5. é›†æˆåˆ°æ ¸å¿ƒç³»ç»Ÿ</h3>
<h4 data-id="heading-5">A. ä¿®æ”¹ <code>src/core/MiniRender.ts</code></h4>
<p>åˆå§‹åŒ– Animation æ¨¡å—ï¼Œå¹¶å»ºç«‹â€œåŠ¨ç”» -&gt; é‡ç»˜â€çš„æ¡¥æ¢ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Animation</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../animation/Animation'</span>;
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MiniRender</span> {
    <span class="hljs-comment">// ...</span>
    <span class="hljs-attr">animation</span>: <span class="hljs-title class_">Animation</span>;

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">dom: HTMLElement</span>) {
        <span class="hljs-comment">// ...</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">animation</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animation</span>();
        
        <span class="hljs-comment">// å½“åŠ¨ç”»äº§ç”Ÿå¸§æ›´æ–°æ—¶ï¼Œè°ƒç”¨ painter åˆ·æ–°</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">animation</span>.<span class="hljs-property">onFrame</span> = <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">painter</span>.<span class="hljs-title function_">refresh</span>();
        };
    }

    <span class="hljs-title function_">addAnimator</span>(<span class="hljs-params">animator: <span class="hljs-built_in">any</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">animation</span>.<span class="hljs-title function_">add</span>(animator);
    }
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<h4 data-id="heading-6">B. ä¿®æ”¹ <code>src/graphic/Element.ts</code></h4>
<p>ç»™æ‰€æœ‰å…ƒç´ æ·»åŠ ä¾¿æ· API <code>animateTo</code>ã€‚</p>
<p><em>æ³¨æ„ï¼šæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹å¼è®© Element èƒ½è®¿é—®åˆ° MiniRender å®ä¾‹æˆ–è€… Animation å…¨å±€å®ä¾‹ã€‚ä¸ºäº†è§£è€¦ï¼ŒMiniRender åœ¨æ·»åŠ  Element æ—¶ï¼Œå¯ä»¥ç»™ Element æ³¨å…¥ä¸€ä¸ª <code>miniRender</code> å¼•ç”¨ï¼Œæˆ–è€…æˆ‘ä»¬ç®€å•ç‚¹ï¼Œè®© <code>animateTo</code> è¿”å›ä¸€ä¸ª <code>Animator</code> å¯¹è±¡ï¼Œç”±ç”¨æˆ·æ‰‹åŠ¨ <code>miniRender.animation.add()</code>ï¼Œæˆ–è€…å®ç°ä¸€ä¸ªæ›´é«˜çº§çš„è°ƒåº¦ã€‚</em></p>
<p>æˆ‘ä»¬éœ€è¦ä¿®æ”¹ Element.tsã€Group.ts å’Œ MiniRender.ts ä¸‰ä¸ªæ–‡ä»¶ã€‚</p>
<h5 data-id="heading-7">1). ä¿®æ”¹ src/graphic/Element.ts</h5>
<p>ç»™ Element å¢åŠ ä¸€ä¸ª miniRender å±æ€§ã€‚å¹¶åœ¨ animateTo ä¸­æ£€æŸ¥è¿™ä¸ªå±æ€§ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/Element.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Animator</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../animation/Animator'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">EasingType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../animation/Easing'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Element</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Eventful</span> {
    <span class="hljs-comment">// ... åŸæœ‰å±æ€§ ...</span>

    <span class="hljs-comment">// æ–°å¢ï¼šæŒæœ‰å¯¹ MiniRender å®ä¾‹çš„å¼•ç”¨</span>
    <span class="hljs-comment">// ä½¿ç”¨ any æ˜¯ä¸ºäº†é¿å…å¾ªç¯å¼•ç”¨ç±»å‹é—®é¢˜ (Element &lt;-&gt; MiniRender)</span>
    <span class="hljs-attr">miniRender</span>: <span class="hljs-built_in">any</span> = <span class="hljs-literal">null</span>; 

    <span class="hljs-title function_">animateTo</span>(<span class="hljs-params">targetState: <span class="hljs-built_in">any</span>, duration: <span class="hljs-built_in">number</span>, easing: EasingType = <span class="hljs-string">'linear'</span>, delay: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></span>) {
        <span class="hljs-keyword">const</span> animator = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animator</span>(<span class="hljs-variable language_">this</span>, targetState, duration, easing);
        <span class="hljs-keyword">if</span> (delay &gt; <span class="hljs-number">0</span>) animator.<span class="hljs-title function_">delay</span>(delay);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">animators</span>.<span class="hljs-title function_">push</span>(animator);

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">miniRender</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">miniRender</span>.<span class="hljs-property">animation</span>.<span class="hljs-title function_">add</span>(animator);
        }

        <span class="hljs-keyword">return</span> animator; <span class="hljs-comment">// ä¾ç„¶è¿”å›ï¼Œä»¥ä¾¿é“¾å¼è°ƒç”¨ .done() ç­‰</span>
    }
}
</code></pre>
<h5 data-id="heading-8">2). å®šä¹‰éå†è¾…åŠ©å‡½æ•°</h5>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œå½“ä¸€ä¸ª Group è¢«åŠ å…¥æ—¶ï¼ŒæŠŠå®ƒåº•ä¸‹æ‰€æœ‰çš„å­å­™èŠ‚ç‚¹çš„ miniRender å±æ€§éƒ½è®¾ç½®å¥½ã€‚ä¸ºäº†é¿å…å¤æ‚çš„å¾ªç¯ä¾èµ–ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°æ”¾åœ¨ src/utils/zrenderHelper.ts æˆ–è€…ç›´æ¥ä½œä¸º Element çš„ä¸€ä¸ªç®€å•æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬ä¿®æ”¹ Group.ts å’Œ MiniRender.ts æ¥é…åˆã€‚</p>
<p>æˆ‘ä»¬é‡‡ç”¨æœ€ç®€å•çš„æ–¹å¼ï¼šåœ¨ <strong>æ·»åŠ å­èŠ‚ç‚¹</strong> æ—¶è¿›è¡Œä¼ é€’ã€‚</p>
<h5 data-id="heading-9">3).ä¿®æ”¹<code> src/graphic/Group.ts</code></h5>
<p>å½“å‘ Group æ·»åŠ å­èŠ‚ç‚¹æ—¶ï¼Œå¦‚æœ Group å·²ç»æœ‰äº† miniRenderï¼Œå°±ä¼ ç»™å­èŠ‚ç‚¹ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/graphic/Group.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Element</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Element'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Group</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Element</span> {
    <span class="hljs-comment">// ...</span>

    <span class="hljs-title function_">add</span>(<span class="hljs-params">child: Element</span>) {
        <span class="hljs-keyword">if</span> (child &amp;&amp; child !== <span class="hljs-variable language_">this</span> &amp;&amp; child.<span class="hljs-property">parent</span> !== <span class="hljs-variable language_">this</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(child);
            child.<span class="hljs-property">parent</span> = <span class="hljs-variable language_">this</span>;

            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">miniRender</span>) {
                <span class="hljs-comment">// é€’å½’è®¾ç½®å­æ ‘</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_propagateRender</span>(child, <span class="hljs-variable language_">this</span>.<span class="hljs-property">miniRender</span>);
            }
        }
    }

    <span class="hljs-comment">/**
     * è¾…åŠ©æ–¹æ³•ï¼šé€’å½’å‘ä¸‹ä¼ é€’ miniRender å¼•ç”¨
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_propagateRender</span>(<span class="hljs-params">el: Element, miniRender: <span class="hljs-built_in">any</span></span>) {
        el.<span class="hljs-property">miniRender</span> = miniRender;
        <span class="hljs-keyword">if</span> ((el <span class="hljs-keyword">as</span> <span class="hljs-title class_">Group</span>).<span class="hljs-property">isGroup</span>) {
            <span class="hljs-keyword">const</span> children = (el <span class="hljs-keyword">as</span> <span class="hljs-title class_">Group</span>).<span class="hljs-property">children</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_propagateRender</span>(children[i], miniRender);
            }
        }
    }
}
</code></pre>
<h5 data-id="heading-10">4).ä¿®æ”¹<code> src/core/MiniRender.ts</code></h5>
<p>è¿™æ˜¯å…¥å£ã€‚å½“ç”¨æˆ·è°ƒç”¨ miniRender.add(el) æ—¶ï¼Œæ³¨å…¥ä¾èµ–ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/core/MiniRender.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MiniRender</span> {
    <span class="hljs-comment">// ...</span>

    <span class="hljs-title function_">add</span>(<span class="hljs-params">el: Element</span>) {
        <span class="hljs-comment">// å…³é”®ä¿®æ”¹ï¼šæ ¹èŠ‚ç‚¹æ³¨å…¥</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_propagateRender</span>(el, <span class="hljs-variable language_">this</span>);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">addRoot</span>(el);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refresh</span>();
    }

    <span class="hljs-comment">// å¤åˆ¶ Group ä¸­çš„é‚£ä¸ªè¾…åŠ©é€»è¾‘ï¼Œæˆ–è€…æå–æˆå…¬å…±å‡½æ•°</span>
    <span class="hljs-comment">// è¿™é‡Œç®€å•æ‹·è´ä¸€ä»½é€»è¾‘ç¡®ä¿æ ¹èŠ‚ç‚¹ä¹Ÿèƒ½é€’å½’</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_propagateRender</span>(<span class="hljs-params">el: Element, miniRender: <span class="hljs-built_in">any</span></span>) {
        el.<span class="hljs-property">miniRender</span> = miniRender;
        <span class="hljs-keyword">if</span> ((el <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">isGroup</span>) {
            <span class="hljs-keyword">const</span> children = (el <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">children</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_propagateRender</span>(children[i], miniRender);
            }
        }
    }
    
    <span class="hljs-comment">// addAnimator æ–¹æ³•ç°åœ¨æ˜¯ç»™å†…éƒ¨ç”¨çš„ï¼Œæˆ–è€…ä½œä¸ºé«˜çº§ API ä¿ç•™</span>
    <span class="hljs-title function_">addAnimator</span>(<span class="hljs-params">animator: <span class="hljs-built_in">any</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">animation</span>.<span class="hljs-title function_">add</span>(animator);
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-11">6. Demo</h3>
<p>æˆ‘ä»¬è¦ä¿®æ”¹ä¹‹å‰çš„æŸ±çŠ¶å›¾ä»£ç ï¼Œè®©æŸ±å­åœ¨åˆ›å»ºæ—¶é«˜åº¦ä¸º 0ï¼Œç„¶åé•¿é«˜ã€‚</p>
<p><strong>é€»è¾‘åˆ†æ</strong>ï¼š</p>
<ol>
<li><strong>åˆå§‹çŠ¶æ€</strong>:
<ul>
<li><code>height</code>: 0</li>
<li><code>y</code>: <code>chartHeight</code> (å³ X è½´çš„ä½ç½®)</li>
</ul>
</li>
<li><strong>ç›®æ ‡çŠ¶æ€</strong>:
<ul>
<li><code>height</code>: <code>barHeight</code> (çœŸå®é«˜åº¦)</li>
<li><code>y</code>: <code>chartHeight - barHeight</code> (çœŸå® Y åæ ‡)</li>
</ul>
</li>
</ol>
<p><strong>ä¿®æ”¹ <code>index.ts</code></strong>:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ... å‰é¢çš„ä»£ç ä¸å˜</span>

data.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {
    <span class="hljs-comment">// ... è®¡ç®— barHeight, finalY ç­‰ ...</span>

    <span class="hljs-keyword">const</span> bar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rect</span>({
        <span class="hljs-attr">shape</span>: {
            <span class="hljs-attr">x</span>: finalX,
            <span class="hljs-attr">y</span>: chartConfig.<span class="hljs-property">height</span>,
            <span class="hljs-attr">width</span>: chartConfig.<span class="hljs-property">barWidth</span>,
            <span class="hljs-attr">height</span>: <span class="hljs-number">0</span>
        },
        <span class="hljs-attr">style</span>: { <span class="hljs-attr">fill</span>: chartConfig.<span class="hljs-property">barColor</span> }
    });

    <span class="hljs-comment">// å…ˆ add åˆ° Group (æ­¤æ—¶ Group è¿˜æ²¡åŠ åˆ° miniRenderï¼Œæ‰€ä»¥ bar.miniRender è¿˜æ˜¯ null)</span>
    chartGroup.<span class="hljs-title function_">add</span>(bar);
    chartGroup.<span class="hljs-title function_">add</span>(label);
    
    <span class="hljs-comment">// æ–¹å¼ 1: å»¶è¿ŸåŠ¨ç”»</span>
    <span class="hljs-comment">// å› ä¸º chartGroup è¿˜æ²¡åŠ åˆ° miniRenderï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥è°ƒ animateTo ä¸ä¼šç«‹å³å¯åŠ¨</span>
    <span class="hljs-comment">// ä½†æ˜¯ï¼æˆ‘ä»¬åœ¨ chartGroup åŠ åˆ° miniRender åï¼Œbar.miniRender ä¼šè¢«èµ‹å€¼ã€‚</span>
    <span class="hljs-comment">// å¯æ˜¯ animator å·²ç»åœ¨ create æ—¶åˆ¤æ–­è¿‡ miniRender æ˜¯ null äº†ï¼Œæ²¡æœ‰åŠ è¿›å»ã€‚</span>
    <span class="hljs-comment">// ã€ä¿®æ­£é€»è¾‘ã€‘ï¼š</span>
    <span class="hljs-comment">// æˆ‘ä»¬çš„ animateTo æ˜¯â€œåˆ›å»ºå³å¯åŠ¨â€ã€‚</span>
    <span class="hljs-comment">// å¦‚æœ element è¿˜æ²¡åŠ åˆ° miniRenderï¼Œè°ƒç”¨ animateTo ä¼šåˆ›å»º Animator ä½†ä¸ä¼šåŠ å…¥ Animation Loopã€‚</span>
    <span class="hljs-comment">// è¿™ä¼šå¯¼è‡´åŠ¨ç”»â€œä¸¢å¤±â€ã€‚</span>
    
    <span class="hljs-comment">// ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé€šå¸¸æœ‰ä¸¤ç§å†™æ³•ï¼š</span>
    <span class="hljs-comment">// 1. å…ˆæŠŠ chartGroup åŠ åˆ° miniRenderï¼Œå†åˆ›å»ºå›¾å½¢å’ŒåŠ¨ç”» (æ¨è)ã€‚</span>
    <span class="hljs-comment">// 2. Element å†…éƒ¨åšä¸€ä¸ª pendingAnimators é˜Ÿåˆ—ï¼Œå½“ miniRender è¢«èµ‹å€¼æ—¶è‡ªåŠ¨ add (å®ç°è¾ƒå¤æ‚)ã€‚</span>
    
    <span class="hljs-comment">// è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨å†™æ³• 1 (ZRender çš„æ ‡å‡†ç”¨æ³•ä¹Ÿæ˜¯å…ˆ add å† animate)ã€‚</span>
});

<span class="hljs-comment">// 1. å…ˆæŠŠç»„åŠ åˆ°å¼•æ“ä¸­ï¼(æ­¤æ—¶æ‰€æœ‰ children çš„ .miniRender éƒ½ä¼šè¢«èµ‹å€¼)</span>
miniRender.<span class="hljs-title function_">add</span>(chartGroup); 

<span class="hljs-comment">// 2. å†éå†æ•°æ®åˆ›å»ºåŠ¨ç”» (æˆ–è€…åœ¨åˆ›å»º bar æ—¶å°± animateï¼Œå‰ææ˜¯ bar å·²ç»æœ‰ miniRender)</span>
<span class="hljs-comment">// è¿™é‡Œæˆ‘ä»¬éœ€è¦ç¨å¾®è°ƒæ•´ä»£ç é¡ºåºï¼Œæˆ–è€…åœ¨ä¸Šé¢çš„ forEach é‡Œæ”¹ä¸€ä¸‹é€»è¾‘ï¼š</span>

<span class="hljs-comment">// === æœ€ä½³å®è·µä»£ç é¡ºåº ===</span>

<span class="hljs-comment">// 1. å‡†å¤‡ Group</span>
<span class="hljs-keyword">const</span> chartGroup = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Group</span>({ <span class="hljs-attr">position</span>: [chartConfig.<span class="hljs-property">x</span>, chartConfig.<span class="hljs-property">y</span>] });
miniRender.<span class="hljs-title function_">add</span>(chartGroup); <span class="hljs-comment">// &lt;--- å…ˆæŠŠ Group æŒ‚è½½ä¸Šå»ï¼</span>

data.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {
    <span class="hljs-comment">// ... åæ ‡è®¡ç®— ...</span>

    <span class="hljs-keyword">const</span> bar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rect</span>({ <span class="hljs-comment">/*...*/</span> });
    
    <span class="hljs-comment">// 2. bar åŠ å…¥ chartGroup</span>
    <span class="hljs-comment">// å› ä¸º chartGroup å·²ç»åœ¨ miniRender é‡Œäº†ï¼Œbar åŠ å…¥ç¬é—´ï¼ŒGroup.add ä¼šæŠŠ miniRender ä¼ ç»™ bar</span>
    chartGroup.<span class="hljs-title function_">add</span>(bar); 
    
    <span class="hljs-comment">// 3. æ­¤æ—¶ bar.miniRender å·²ç»æœ‰å€¼äº†ï¼Œç›´æ¥å¼€å¯åŠ¨ç”»ï¼</span>
    bar.<span class="hljs-title function_">animateTo</span>(
        {
            <span class="hljs-attr">shape</span>: {
                <span class="hljs-attr">y</span>: finalY,
                <span class="hljs-attr">height</span>: finalHeight
            }
        },
        <span class="hljs-number">1000</span>,
        <span class="hljs-string">'cubicOut'</span>,
        index * <span class="hljs-number">100</span>
    );
    <span class="hljs-comment">// ä¸éœ€è¦ miniRender.addAnimator(animator) äº†ï¼</span>
});
</code></pre>
<p><img alt="animationè½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/></p>
<h3 data-id="heading-12">7.é˜¶æ®µæ€»ç»“</h3>
<p>æˆ‘ä»¬å·²ç»ä»é›¶æ„å»ºäº†ä¸€ä¸ªå…·å¤‡<strong>å¯¹è±¡æ¨¡å‹ã€æ¸²æŸ“ç®¡çº¿ã€äº¤äº’ç³»ç»Ÿã€åŠ¨ç”»å¼•æ“</strong>çš„ Canvas 2D å¼•æ“å¾®å†…æ ¸ï¼ˆMiniRenderï¼‰ã€‚å®ƒå·²ç»æ—¶ä¸€ä¸ªå…·å¤‡æ‰©å±•æ€§çš„å›¾å½¢åº“é›å½¢äº†ã€‚</p>
<p>æˆ‘ä»¬ç›®å‰çš„ MiniRender å·²ç»å®ç°äº† <strong>ZRender v4/v5</strong> çš„æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼š</p>





















































<table><thead><tr><th>æ¨¡å—</th><th>ç±»å (Class)</th><th>æ ¸å¿ƒèŒè´£</th><th>å½“å‰çŠ¶æ€</th></tr></thead><tbody><tr><td><strong>å…¥å£</strong></td><td>MiniRender</td><td>å¤–è§‚æ¨¡å¼å…¥å£ï¼Œåè°ƒå„æ¨¡å—ï¼Œç®¡ç†ä¸»å¾ªç¯ã€‚</td><td>âœ… å·²å®ç°ä¾èµ–æ³¨å…¥</td></tr><tr><td><strong>æ•°æ®</strong></td><td>Storage</td><td><strong>åœºæ™¯å›¾ (Scene Graph)</strong> ç®¡ç†ï¼Œç»´æŠ¤æ˜¾ç¤ºåˆ—è¡¨ï¼Œå¤„ç†å±‚çº§æ’åºã€‚</td><td>âœ… æ”¯æŒ Group/Z-index</td></tr><tr><td><strong>æ¸²æŸ“</strong></td><td>Painter</td><td><strong>è§†å›¾ (View)</strong>ï¼Œè´Ÿè´£ Canvas ä¸Šä¸‹æ–‡ç®¡ç†ã€é‡ç»˜å¾ªç¯ (refresh)ã€‚</td><td>âœ… åŸºç¡€å…¨é‡é‡ç»˜</td></tr><tr><td><strong>å›¾å½¢</strong></td><td>Element / Displayable</td><td><strong>èŠ‚ç‚¹ (Node)</strong>ï¼Œå®ç°ä»¿å°„å˜æ¢çŸ©é˜µ (transform)ã€çˆ¶å­çº§è”ã€‚</td><td>âœ… çŸ©é˜µè¿ç®—/æ ·å¼å°è£…</td></tr><tr><td><strong>å½¢çŠ¶</strong></td><td>Rect / Circle / Text</td><td>å…·ä½“å›¾å½¢å‡ ä½•å®šä¹‰ä¸åŒ…å«æ£€æµ‹ (contain)ã€‚</td><td>âœ… åŸºç¡€å½¢çŠ¶</td></tr><tr><td><strong>äº¤äº’</strong></td><td>Handler</td><td><strong>æ§åˆ¶å™¨ (Controller)</strong>ï¼Œå®ç°åæ ‡é€†å˜æ¢ï¼ŒDOM äº‹ä»¶ä»£ç†ä¸åˆ†å‘ã€‚</td><td>âœ… Click/Hover/Silent</td></tr><tr><td><strong>åŠ¨ç”»</strong></td><td>Animation / Animator</td><td>å£°æ˜å¼åŠ¨ç”»ç³»ç»Ÿï¼Œæ”¯æŒç¼“åŠ¨å‡½æ•°ä¸å±æ€§æ’å€¼ã€‚</td><td>âœ… æ”¯æŒé€’å½’æ’å€¼</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MySQL æŠ¥é”™ ERROR 1045 (28000): Access Denied ç»ˆæè§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7579094978681880622</link>    <guid>https://juejin.cn/post/7579094978681880622</guid>    <pubDate>2025-12-02T14:35:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579094978681880622" data-draft-id="7579096485356027954" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MySQL æŠ¥é”™ ERROR 1045 (28000): Access Denied ç»ˆæè§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="MySQL"/> <meta itemprop="datePublished" content="2025-12-02T14:35:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«¯å®™æ¶æ„å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3544481219217885"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MySQL æŠ¥é”™ ERROR 1045 (28000): Access Denied ç»ˆæè§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3544481219217885/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«¯å®™æ¶æ„å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T14:35:50.000Z" title="Tue Dec 02 2025 14:35:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>mac æ•°æ®åº“åˆå¿˜è®°å¯†ç äº†ï¼Œè®°å½•ä¸€ä¸‹æ›´æ”¹å¯†ç ï¼
æ ¸å¿ƒæ€è·¯æ˜¯ï¼š</p>
<ol>
<li>è·³è¿‡æƒé™éªŒè¯è¿›å…¥ MySQLã€‚</li>
<li>ä¿®å¤ç”¨æˆ·æˆ–å¯†ç ã€‚</li>
<li>æ¢å¤æƒé™è¡¨ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-0"><strong>é”™è¯¯åœºæ™¯å¤ç°</strong></h2>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ—¶è¢«æ‹’ç»è®¿é—®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">mysql -u root -p &lt; /var/lib/mysql-files/reset.sql
<span class="hljs-comment"># æˆ–</span>
sudo /usr/local/mysql/bin/mysql -u root -p &lt; /var/lib/mysql-files/reset.sql
</code></pre>
<p>è¾“å…¥å¯†ç åæç¤ºï¼š</p>
<pre><code class="hljs language-sql" lang="sql">ERROR <span class="hljs-number">1045</span> (<span class="hljs-number">28000</span>): Access denied <span class="hljs-keyword">for</span> <span class="hljs-keyword">user</span> <span class="hljs-string">'root'</span>@<span class="hljs-string">'localhost'</span> (<span class="hljs-keyword">using</span> password: YES)
</code></pre>
<hr/>
<h2 data-id="heading-1"><strong>åŸå› åˆ†æ</strong></h2>
<ol>
<li><strong>å¯†ç é”™è¯¯</strong>ï¼šè¾“å…¥çš„ <code>root</code> å¯†ç ä¸æ­£ç¡®ã€‚</li>
<li><strong>æƒé™ç¼ºå¤±</strong>ï¼š<code>root@localhost</code> ç”¨æˆ·ä¸å­˜åœ¨æˆ–æƒé™è¢«é™åˆ¶ã€‚</li>
<li><strong>MySQL æœåŠ¡å¼‚å¸¸</strong>ï¼šæƒé™è¡¨æœªæ­£ç¡®åŠ è½½æˆ–æŸåã€‚</li>
<li><strong>è·¯å¾„é—®é¢˜</strong>ï¼šä½¿ç”¨äº†é”™è¯¯çš„ MySQL å®¢æˆ·ç«¯æˆ–æœåŠ¡è·¯å¾„ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-2"><strong>è§£å†³æ–¹æ¡ˆï¼ˆäº²æµ‹æœ‰æ•ˆï¼‰</strong></h2>
<h3 data-id="heading-3"><strong>æ­¥éª¤ 1ï¼šé‡ç½® root å¯†ç ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰</strong></h3>
<ol>
<li>
<p><strong>åœæ­¢ MySQL æœåŠ¡</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo /usr/local/mysql/support-files/mysql.server stop
</code></pre>
<blockquote>
<p>å¦‚æœæç¤ºæ‰¾ä¸åˆ°å‘½ä»¤ï¼Œå°è¯•ï¼š</p>
</blockquote>
<pre><code class="hljs language-bash" lang="bash">sudo brew services stop mysql  <span class="hljs-comment"># Homebrew å®‰è£…çš„ MySQL</span>
</code></pre>
</li>
<li>
<p><strong>ä»¥å®‰å…¨æ¨¡å¼å¯åŠ¨ MySQLï¼ˆè·³è¿‡æƒé™éªŒè¯ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo /usr/local/mysql/bin/mysqld_safe --skip-grant-tables &amp;
</code></pre>
<blockquote>
<p>æˆåŠŸå¯åŠ¨åï¼Œç»ˆç«¯ä¼šå¡ä½ï¼ˆæ˜¾ç¤º <code>Starting mysqld daemon with databases...</code>ï¼‰ï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>æ— å¯†ç ç™»å½• MySQL</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/usr/local/mysql/bin/mysql -u root
</code></pre>
</li>
<li>
<p><strong>æ›´æ–° root å¯†ç </strong>ï¼ˆMySQL 5.7+ï¼‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">FLUSH PRIVILEGES;
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">'root'</span>@<span class="hljs-string">'localhost'</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">'ä½ çš„æ–°å¯†ç '</span>;
FLUSH PRIVILEGES;
exit;
</code></pre>
<blockquote>
<p>å¦‚æœæŠ¥é”™ <code>ERROR 1396</code>ï¼Œå¯èƒ½æ˜¯ç”¨æˆ·ä¸å­˜åœ¨ï¼Œéœ€å…ˆåˆ›å»ºç”¨æˆ·ï¼ˆè§æ­¥éª¤ 2ï¼‰ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>é‡å¯ MySQL æœåŠ¡</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo /usr/local/mysql/support-files/mysql.server restart
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-4"><strong>æ­¥éª¤ 2ï¼šæ£€æŸ¥ root ç”¨æˆ·æƒé™ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰</strong></h3>
<p>å¦‚æœé‡ç½®å¯†ç åä»æ— æ³•ç™»å½•ï¼Œå¯èƒ½æ˜¯ <code>root@localhost</code> ç”¨æˆ·ä¸å­˜åœ¨æˆ–æƒé™ä¸è¶³ï¼š</p>
<ol>
<li>ä»¥å®‰å…¨æ¨¡å¼ç™»å½•åæ‰§è¡Œï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> host, <span class="hljs-keyword">user</span> <span class="hljs-keyword">FROM</span> mysql.user;
</code></pre>
</li>
<li>å¦‚æœç¼ºå°‘ <code>root@localhost</code>ï¼Œæ‰‹åŠ¨åˆ›å»ºï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">'root'</span>@<span class="hljs-string">'localhost'</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">'ä½ çš„å¯†ç '</span>;
<span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">'root'</span>@<span class="hljs-string">'localhost'</span> <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">GRANT</span> OPTION;
FLUSH PRIVILEGES;
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-5"><strong>æ­¥éª¤ 3ï¼šéªŒè¯ MySQL è·¯å¾„</strong></h3>
<ol>
<li>ç¡®è®¤å®¢æˆ·ç«¯è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼š
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">which</span> mysql
<span class="hljs-comment"># åº”è¿”å› /usr/local/mysql/bin/mysql æˆ– /usr/local/opt/mysql/bin/mysql</span>
</code></pre>
</li>
<li>å¦‚æœè·¯å¾„ä¸ä¸€è‡´ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„æ‰§è¡Œå‘½ä»¤ï¼š
<pre><code class="hljs language-bash" lang="bash">sudo /usr/local/mysql/bin/mysql -u root -p
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-6"><strong>æ­¥éª¤ 4ï¼šæ£€æŸ¥æ–‡ä»¶æƒé™</strong></h3>
<p>ç¡®ä¿ <code>reset.sql</code> æ–‡ä»¶å¯è¯»ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">ls</span> -l /var/lib/mysql-files/reset.sql
sudo <span class="hljs-built_in">chmod</span> 644 /var/lib/mysql-files/reset.sql  <span class="hljs-comment"># å¦‚æœæƒé™ä¸è¶³</span>
</code></pre>
<hr/>
<h3 data-id="heading-7"><strong>æ­¥éª¤ 5ï¼šæŸ¥çœ‹ MySQL é”™è¯¯æ—¥å¿—</strong></h3>
<p>å®šä½æ›´æ·±å±‚æ¬¡çš„é—®é¢˜ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">tail</span> -n 50 /usr/local/mysql/data/*.err
</code></pre>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[nginx é…ç½®é•¿è·‘ï¼ˆä¸Šï¼‰ï¼šä»ä¸€ä»½ server åˆ°çœ‹æ‡‚æ•´å¥—è·¯ç”±è§„åˆ™]]></title>    <link>https://juejin.cn/post/7579066828179374116</link>    <guid>https://juejin.cn/post/7579066828179374116</guid>    <pubDate>2025-12-02T13:16:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579066828179374116" data-draft-id="7578968420043407423" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="nginx é…ç½®é•¿è·‘ï¼ˆä¸Šï¼‰ï¼šä»ä¸€ä»½ server åˆ°çœ‹æ‡‚æ•´å¥—è·¯ç”±è§„åˆ™"/> <meta itemprop="keywords" content="åç«¯,Nginx"/> <meta itemprop="datePublished" content="2025-12-02T13:16:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…”å­é›¶1024"/> <meta itemprop="url" content="https://juejin.cn/user/3743194047592062"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            nginx é…ç½®é•¿è·‘ï¼ˆä¸Šï¼‰ï¼šä»ä¸€ä»½ server åˆ°çœ‹æ‡‚æ•´å¥—è·¯ç”±è§„åˆ™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3743194047592062/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…”å­é›¶1024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T13:16:36.000Z" title="Tue Dec 02 2025 13:16:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p>å…³é”®è¯ï¼šnginx / é…ç½®å¿ƒæ™ºæ¨¡å‹ / http-server-location / è·¯ç”±ä¼˜å…ˆçº§ / location / rewrite / åå‘ä»£ç†</p>
<h2 data-id="heading-0">å¼•è¨€ï¼šä»ã€Œæ”¹ä¸€è¡Œé…ç½®ã€åˆ°ã€Œçº¿ä¸Šæ•´ç«™ 502ã€</h2>
<p>æœ‰ä¸€æ¬¡ï¼Œä¸€ä¸ªåŒäº‹è¯´è¦ã€Œé¡ºæ‰‹æ”¹ä¸‹ nginx é…ç½®ã€ï¼Œç»™æŸä¸ªæ¥å£åŠ ä¸€æ¡ç®€å•çš„è½¬å‘è§„åˆ™ã€‚<br/>
å‡ åˆ†é’Ÿåï¼Œæµ‹è¯•ç¯å¢ƒä¸€ç‰‡ 502ï¼Œç™»å½•é¡µé¢ä¹Ÿæ‰“ä¸å¼€äº†ï¼Œå¤§å®¶ç¬¬ä¸€ååº”æ˜¯ï¼šæ˜¯ä¸æ˜¯åç«¯æŒ‚äº†ã€æ˜¯ä¸æ˜¯ Redis å´©äº†ã€‚</p>
<p>æœ€åæ’æŸ¥ä¸‹æ¥ï¼Œé—®é¢˜æ—¢ä¸æ˜¯ç½‘ç»œï¼Œä¹Ÿä¸æ˜¯ä»£ç ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>åœ¨ <code>server</code> é‡Œå¤šåŠ äº†ä¸€æ¡ <code>location</code>ï¼›</li>
<li>å°‘çœ‹äº†å‡ è¡Œå·²æœ‰è§„åˆ™ï¼›</li>
<li>è®©ä¸€ä¸ªä¼˜å…ˆçº§æ›´é«˜çš„ <code>location</code> æŠŠå…¨ç«™è¯·æ±‚éƒ½ã€Œæˆªèƒ¡ã€äº†ã€‚</li>
</ul>
<p><strong>nginx é…ç½®æœ€å¤§çš„å‘ï¼Œä¸æ˜¯ä½ ä¸ä¼šå†™ï¼Œè€Œæ˜¯ä½ ä»¥ä¸ºä½ å†™çš„æ˜¯è¿™æ¡è·¯ï¼Œå…¶å®å®ƒèµ°çš„æ˜¯å¦ä¸€æ¡ã€‚</strong><br/>
è¿™ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°±ä¸ä»ã€ŒæŒ‡ä»¤å¤§å­—å…¸ã€å¼€å§‹ï¼Œè€Œæ˜¯ä»ä¸€ä»½æœ€å¸¸è§çš„ <code>server</code> é…ç½®å…¥æ‰‹ï¼ŒæŠŠ nginx çš„åŸºæœ¬å¿ƒæ™ºæ¨¡å‹å’Œè·¯ç”±ä¼˜å…ˆçº§è®²æ¸…æ¥šã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€å…ˆæŠŠå¤§å›¾çœ‹æ¸…ï¼šhttp / server / location åˆ°åº•åœ¨å¹²å˜›ï¼Ÿ</h2>
<p>ç»å¤§éƒ¨åˆ†äººç¬¬ä¸€æ¬¡çœ‹åˆ° nginx é…ç½®ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ç»“æ„ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">http {
    include       mime.types;
    default_type  application/octet-stream;

    server {
        listen       80;
        server_name  localhost;
        charset      utf-8;

        location / {
            root   html;
            index  index.html index.htm;
        }

        location /test {
            proxy_pass https://wangmiaozero.cn;
        }
    }
}
</code></pre>
<p>å¦‚æœåªè®°è¿™ä¸€å¥å°±å¤Ÿç”¨äº†ï¼š</p>
<blockquote>
<p><strong><code>http</code> æ˜¯ã€Œæ€»é…ç½®ã€ï¼Œ<code>server</code> æ˜¯ã€Œè™šæ‹Ÿä¸»æœºã€ï¼Œ<code>location</code> æ˜¯ã€Œè¿™ä¸€å°ä¸»æœºä¸Šçš„è·¯ç”±è§„åˆ™ã€ã€‚</strong></p>
</blockquote>
<h3 data-id="heading-2">1. httpï¼šå…¨å±€è§„åˆ™ä¸å…¬å…±åŸºç¡€è®¾æ–½</h3>
<p><code>http { ... }</code> é‡Œé€šå¸¸æ”¾çš„æ˜¯ã€Œæ‰€æœ‰ HTTP æœåŠ¡éƒ½èƒ½ç”¨åˆ°çš„ä¸œè¥¿ã€ï¼š</p>
<ul>
<li><code>include mime.types</code>ï¼šå¼•å…¥æ–‡ä»¶ç±»å‹æ˜ å°„ï¼›</li>
<li><code>default_type</code>ï¼šé»˜è®¤å“åº”ç±»å‹ï¼›</li>
<li>å„ç§å…¨å±€çš„ç¼“å­˜ã€æ—¥å¿—ã€è¿æ¥æ•°ã€è¶…æ—¶é…ç½®ç­‰ã€‚</li>
</ul>
<p>ä½ å¯ä»¥æŠŠ <code>http</code> æƒ³è±¡æˆã€Œä¸€ä¸ªæœºæˆ¿ã€ï¼š</p>
<ul>
<li>æœºæˆ¿é‡Œä¼šæœ‰ä¸€å †æœºå™¨ï¼ˆ<code>server</code>ï¼‰ï¼›</li>
<li>æœºæˆ¿çº§åˆ«ä¼šæœ‰ç»Ÿä¸€çš„è§„çŸ©ï¼ˆ<code>http</code> é‡Œçš„é…ç½®ï¼‰ï¼›</li>
<li>å•ä¸ªæœºå™¨ä¹Ÿå¯ä»¥åœ¨è‡ªå·±æˆ¿é—´é‡ŒåŠ ç‚¹ç‰¹æ®Šè®¾ç½®ï¼ˆ<code>server</code> çº§åˆ«è¦†ç›–ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-3">2. serverï¼šä¸€å°é€»è¾‘ä¸Šçš„ã€Œè™šæ‹Ÿä¸»æœºã€</h3>
<p><code>server { ... }</code> å°±æ˜¯ä¸€å°è™šæ‹Ÿä¸»æœºï¼Œå®ƒé€šè¿‡ï¼š</p>
<ul>
<li><code>listen</code>ï¼šç›‘å¬ç«¯å£ï¼›</li>
<li><code>server_name</code>ï¼šåŒ¹é…åŸŸåï¼›</li>
</ul>
<p>æ¥å†³å®šã€Œè¿™ä¸ªè¯·æ±‚æ˜¯ä¸æ˜¯è¯¥æˆ‘æ¥ã€ã€‚</p>
<p>ä¸€ä¸ª <code>nginx.conf</code> é‡Œå¯ä»¥æœ‰å¾ˆå¤šä¸ª <code>server</code>ï¼š</p>
<ul>
<li><code>server_name www.xxx.com</code>ï¼šç½‘ç«™ Aï¼›</li>
<li><code>server_name api.xxx.com</code>ï¼šç½‘ç«™ Bï¼›</li>
<li><code>server_name *.internal.xxx.com</code>ï¼šå†…éƒ¨ç®¡ç†ç³»ç»Ÿç­‰ã€‚</li>
</ul>
<p><strong>ç”¨æˆ·çš„ HTTP è¯·æ±‚ï¼Œå…ˆæ˜¯è¢«æŸä¸€ä¸ª <code>server</code> æ¥ä½ï¼Œæ‰ä¼šå¾€ <code>location</code> é‡Œé¢èµ°ã€‚</strong></p>
<h3 data-id="heading-4">3. locationï¼šè¿™ä¸€å°ä¸»æœºä¸Šçš„ã€Œè·¯ç”±ä¸åˆ†å‘è§„åˆ™ã€</h3>
<p>æœ‰äº† <code>server</code> ä¹‹åï¼Œå‰©ä¸‹çš„é—®é¢˜å°±æ˜¯ï¼š</p>
<blockquote>
<p>æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚è·¯å¾„ <code>/foo/bar</code>ï¼Œåˆ°åº•äº¤ç»™è°å¤„ç†ï¼Ÿ</p>
</blockquote>
<p>è¿™å°±æ˜¯ <code>location</code> çš„å·¥ä½œäº†ã€‚</p>
<p>å¸¸è§çš„æŒ‡ä»¤å¤§è‡´é•¿è¿™æ ·ï¼š</p>
<ul>
<li><code>root</code>ï¼šé™æ€èµ„æºæ ¹ç›®å½•ï¼›</li>
<li><code>index</code>ï¼šé»˜è®¤é¦–é¡µæ–‡ä»¶ï¼›</li>
<li><code>proxy_pass</code>ï¼šæŠŠè¯·æ±‚è½¬å‘åˆ°åç«¯ï¼›</li>
<li><code>rewrite</code>ï¼šåœ¨å½“å‰åŸŸåä¸‹æ”¹å†™è·¯å¾„ã€‚</li>
</ul>
<p>æ—¥å¸¸å¼€å‘ä¸­ï¼Œ<strong>å¤§éƒ¨åˆ†ã€Œç„å­¦é—®é¢˜ã€éƒ½å‡ºåœ¨ <code>location</code> ä¸Š</strong>â€”â€”<br/>
è¦ä¹ˆæ²¡å‘½ä¸­é¢„æœŸçš„è§„åˆ™ï¼Œè¦ä¹ˆè¢«æ›´é«˜ä¼˜å…ˆçº§çš„è§„åˆ™æˆªèƒ¡ã€‚</p>
<hr/>
<h2 data-id="heading-5">äºŒã€location çš„ 7 ç§å†™æ³•ï¼Œå…¶å®åªæ˜¯åœ¨ç©ã€Œè°å…ˆè¯´äº†ç®—ã€</h2>
<p>ç½‘ä¸Šç»å¸¸ä¼šçœ‹åˆ°è¿™æ ·çš„æ€»ç»“ï¼š<br/>
ã€Œ<code>=</code> ç²¾ç¡®åŒ¹é…ã€<code>^~</code> å‰ç¼€ã€<code>~</code> æ­£åˆ™ã€<code>/</code> é€šåƒã€ï¼Œè®°å®Œä¸€éä¸‹æ¬¡åˆå¿˜äº†ã€‚<br/>
æˆ‘ä»¬æ¢ä¸ªæ›´å·¥ç¨‹ä¸€ç‚¹çš„è§†è§’ï¼š<strong>location ç©çš„æ˜¯ã€Œä¼˜å…ˆçº§ + æ˜¯å¦ç»§ç»­åŒ¹é…ã€è¿™ä¸¤ä¸ªç»´åº¦</strong>ã€‚</p>
<h3 data-id="heading-6">1. å…ˆçœ‹ 7 ç§å†™æ³•</h3>
<p>æŒ‰ç…§å®˜æ–¹è¯­ä¹‰ + å®æˆ˜è¡Œä¸ºï¼Œ<code>location</code> ç²—ç•¥å¯ä»¥åˆ†æˆ 7 ç±»ï¼Œä»é«˜åˆ°ä½æ˜¯ï¼š</p>
<ol>
<li><code>=</code> ç²¾ç¡®åŒ¹é…</li>
<li>å®Œæ•´è·¯å¾„åŒ¹é…ï¼ˆå¦‚ <code>location /test/aaa/bbb.html</code>ï¼‰</li>
<li><code>^~ /test</code>ï¼šä»¥ <code>/test</code> å¼€å¤´ï¼Œå‘½ä¸­å<strong>ä¸å†å¾€åæ‰¾</strong></li>
<li><code>~ pattern</code>ï¼šåŒºåˆ†å¤§å°å†™çš„æ­£åˆ™ï¼Œå‘½ä¸­å<strong>ä¸å†å¾€åæ‰¾</strong></li>
<li><code>~* pattern</code>ï¼šä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™ï¼Œå‘½ä¸­å<strong>ä¸å†å¾€åæ‰¾</strong></li>
<li><code>/test</code>ï¼šæ™®é€šå‰ç¼€åŒ¹é…ï¼Œå‘½ä¸­å<strong>è¿˜ä¼šç»§ç»­å¾€åæ‰¾æ›´é•¿çš„å‰ç¼€</strong></li>
<li><code>/</code>ï¼šå…œåº•è§„åˆ™ï¼Œä»€ä¹ˆéƒ½åŒ¹é…ï¼Œä¼˜å…ˆçº§æœ€ä½</li>
</ol>
<p>ä½ å¯ä»¥è®°æˆä¸¤ä¸ªç®€å•çš„é—®é¢˜ï¼š</p>
<ol>
<li><strong>å½“å‰è§„åˆ™ä¼˜å…ˆçº§é«˜ä¸é«˜ï¼Ÿ</strong></li>
<li><strong>å‘½ä¸­ä¹‹åè¿˜è¦ä¸è¦ç»§ç»­å¾€åæ‰¾ï¼Ÿ</strong></li>
</ol>
<h3 data-id="heading-7">2. ä¸¤æ¡å¤§åŸåˆ™ + ä¸¤æ¡ç»†åˆ™</h3>
<p>å¦‚æœä½ åªæƒ³èƒŒå°‘é‡è§„åˆ™ï¼ŒæŠŠè¿™ 4 æ¡åˆ»è¿›è„‘å­å°±å¤Ÿäº†ï¼š</p>
<ul>
<li>
<p><strong>æ•´ä½“ä¼˜å…ˆçº§ï¼š</strong><br/>
<code>ç²¾ç¡®åŒ¹é…(=)</code> &gt; <code>å®Œæ•´è·¯å¾„</code> &gt; <code>^~</code> &gt; æ­£åˆ™(<code>~ / ~*</code>) &gt; æ™®é€šå‰ç¼€(<code>/xxx</code>) &gt; <code>/</code></p>
</li>
<li>
<p><strong>æ˜¯å¦ç»§ç»­åŒ¹é…ï¼š</strong><br/>
é™¤äº†æ™®é€šå‰ç¼€ <code>/xxx</code> ä¼šç»§ç»­å¾€åæ‰¾ï¼Œå…¶å®ƒç±»å‹ï¼ˆ<code>= / ^~ / ~ / ~*</code>ï¼‰ä¸€æ—¦å‘½ä¸­å°±åœæ­¢ã€‚</p>
</li>
<li>
<p><strong>åŒç±»å‹ä¹‹é—´ï¼š</strong></p>
<ul>
<li>å¤šä¸ªæ­£åˆ™ä¹‹é—´ / å¤šä¸ª <code>^~</code> ä¹‹é—´ï¼š<strong>å‘½ä¸­ç¬¬ä¸€ä¸ªå°±åœ</strong>ï¼Œé¡ºåºå¾ˆé‡è¦ï¼›</li>
<li>å¤šä¸ªæ™®é€šå‰ç¼€ï¼ˆéƒ½æ˜¯ <code>/xxx</code> å¼€å¤´ï¼‰ï¼š<strong>æœ€é•¿åŒ¹é…ä¼˜å…ˆ</strong>ï¼Œè·Ÿå…ˆåé¡ºåºæ— å…³ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>/</code> æ°¸è¿œæ˜¯å…œåº•ï¼š</strong><br/>
ä¸ç®¡å‰é¢å†™äº†å¤šå°‘è§„åˆ™ï¼Œ<code>/</code> éƒ½æ˜¯æœ€åä¸€æ¡æ•‘å‘½ç¨»è‰ã€‚</p>
</li>
</ul>
<blockquote>
<p>å¦‚æœè§‰å¾—è®°ä¸ä½ï¼Œå¯ä»¥æŠŠ location ç†è§£æˆï¼š<br/>
<strong>ã€Œå…ˆæŒ‘æœ€æœ‰èµ„æ ¼è¯´è¯çš„äººï¼Œç„¶åçœ‹ä»–æœ‰æ²¡æœ‰æŠŠè¯è¯´æ­»ã€ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€é€šè¿‡ 5 ä¸ªå°å®éªŒï¼ŒæŠŠä¼˜å…ˆçº§æ‰“è¿›è‚Œè‚‰è®°å¿†</h2>
<p>ç†è§£è§„åˆ™æ˜¯ä¸€å›äº‹ï¼Œèƒ½ä¸èƒ½åœ¨è„‘å­é‡Œã€Œç®—å‡ºç»“æœã€æ˜¯å¦ä¸€å›äº‹ã€‚<br/>
ä¸‹é¢çš„ä¾‹å­å…¨éƒ¨å¯ä»¥ç›´æ¥ä¸¢è¿› nginx é‡Œæµ‹è¯•ã€‚</p>
<h3 data-id="heading-9">ç¤ºä¾‹ä¸€ï¼šç²¾ç¡®åŒ¹é…æ°¸è¿œä¼˜å…ˆäºæ™®é€š <code>/path</code></h3>
<pre><code class="hljs language-nginx" lang="nginx">location /hello.json {
    default_type  text/html;
    return 200 '111';
}

location = /hello.json {
    default_type  text/html;
    return 200 '222';
}
</code></pre>
<p>è®¿é—® <code>/hello.json</code>ï¼Œè¿”å›çš„æ˜¯ <code>222</code>ã€‚</p>
<ul>
<li>åŸå› ï¼š<code>=</code> ç²¾ç¡®åŒ¹é…ä¼˜å…ˆçº§æœ€é«˜ï¼Œå…ˆå‘½ä¸­å°±ç›´æ¥åœï¼›</li>
<li>æ™®é€š <code>/hello.json</code> è™½ç„¶çœ‹èµ·æ¥ä¸€æ ·ï¼Œä½†åœ¨è§„åˆ™é‡Œå±äºã€Œå‰ç¼€åŒ¹é…ã€ã€‚</li>
</ul>
<h3 data-id="heading-10">ç¤ºä¾‹äºŒï¼š<code>^~</code> æ¯”æ­£åˆ™æ›´ã€Œå¼ºåŠ¿ã€</h3>
<pre><code class="hljs language-nginx" lang="nginx"># è™½ç„¶ 222 åœ¨åé¢ï¼Œä½†æ˜¯ç”±äº ^~ ä¼˜å…ˆçº§æ›´é«˜ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªç”Ÿæ•ˆ
location ~ /test/aaa {
    return 200 '111';
}

location ^~ /test/aaa {
    return 200 '222';
}
</code></pre>
<p>è®¿é—® <code>/test/aaa/bbb.json</code>ï¼Œè¿”å›çš„æ˜¯ <code>222</code>ã€‚</p>
<p>è§£é‡Šï¼š</p>
<ul>
<li><code>^~ /test/aaa</code> å±äºã€Œå‰ç¼€ä½†ä¸å†ç»§ç»­æ‰¾ã€è¿™ä¸€ç±»ï¼Œä¼˜å…ˆçº§é«˜äºæ­£åˆ™ï¼›</li>
<li>å³ä¾¿å®ƒåœ¨åé¢å‡ºç°ï¼Œä¾ç„¶ä¼šå…ˆæ‹¿åˆ°è¯è¯­æƒã€‚</li>
</ul>
<h3 data-id="heading-11">ç¤ºä¾‹ä¸‰ï¼šå¤šä¸ªæ­£åˆ™ï¼Œå…ˆå†™çš„å…ˆèµ¢</h3>
<pre><code class="hljs language-nginx" lang="nginx"># å¤šä¸ªæ­£åˆ™ä¹‹é—´ï¼Œç¬¬ä¸€ä¸ªåŒ¹é…ç”Ÿæ•ˆï¼Œä¸é¡ºåºæœ‰å…³
# è™½ç„¶è¶Šå¾€ååŒ¹é…è¶Šç²¾ç¡®ï¼Œä½†åªè¦æ˜¯æ­£åˆ™ï¼ŒåŒ¹é…åˆ°ç¬¬ä¸€ä¸ªå°±åœæ­¢
location ~ / {
    return 200 '111';
}

location ~ /test/aaa {
    return 200 '222';
}

location ~ /test/aaa/.*\.(gif|jpg|jpeg)$ {
    return 200 '333';
}
</code></pre>
<p>è®¿é—® <code>/test/aaa/bbb.json</code>ï¼Œå‘½ä¸­çš„å…¶å®æ˜¯ç¬¬ä¸€æ¡æ­£åˆ™ï¼ˆè¿”å› <code>111</code>ï¼‰ï¼Œå› ä¸ºï¼š</p>
<ul>
<li><code>/</code> è¿™ä¸ªæ­£åˆ™ä¹Ÿèƒ½åŒ¹é…ä¸€åˆ‡è·¯å¾„ï¼›</li>
<li>æ­£åˆ™ä¹‹é—´éµå¾ªã€Œå…ˆå†™å…ˆèµ¢ã€ï¼ŒåŒ¹é…åˆ°ç¬¬ä¸€ä¸ªå°±ä¸å†å¾€åçœ‹ã€‚</li>
</ul>
<h3 data-id="heading-12">ç¤ºä¾‹å››ï¼šåŒè·¯å¾„å‰ç¼€ä¸‹ï¼Œæ­£åˆ™ &gt; æ™®é€šå‰ç¼€</h3>
<pre><code class="hljs language-nginx" lang="nginx"># ä¸ç®¡äºŒè€…å¦‚ä½•äº¤æ¢é¡ºåºï¼Œå§‹ç»ˆéƒ½æ˜¯ç¬¬äºŒä¸ªç”Ÿæ•ˆ
location /test/aaa {
    return 200 '111';
}

location ~ /test/aaa {
    return 200 '222';
}
</code></pre>
<p>è®¿é—® <code>/test/aaa/bbb.json</code>ï¼Œè¿”å› <code>222</code>ï¼š</p>
<ul>
<li><code>~ /test/aaa</code> æ˜¯æ­£åˆ™ï¼Œä¼˜å…ˆçº§æ¯”æ™®é€šå‰ç¼€ <code>/test/aaa</code> æ›´é«˜ï¼›</li>
<li>å…ˆæ¯”ã€Œç§ç±»ä¼˜å…ˆçº§ã€ï¼Œå†è°ˆé¡ºåºã€‚</li>
</ul>
<h3 data-id="heading-13">ç¤ºä¾‹äº”ï¼šéƒ½æ˜¯å‰ç¼€åŒ¹é…æ—¶ï¼Œçœ‹è°æ›´é•¿</h3>
<pre><code class="hljs language-nginx" lang="nginx"># éƒ½æ˜¯ / å¼€å¤´æ—¶ï¼Œæœ€é•¿åŒ¹é…ç”Ÿæ•ˆï¼Œå’Œå…ˆåé¡ºåºæ— å…³
location /test/ {
    return 200 '111';
}

location /test/aaa/ccc {
    return 200 '222';
}

location /test/aaa/ {
    return 200 '333';
}

location / {
    return 200 '444';
}
</code></pre>
<p>è®¿é—® <code>/test/aaa/bbb/ccc.json</code>ï¼š</p>
<ul>
<li><code>/test/</code> èƒ½åŒ¹é…ï¼›</li>
<li><code>/test/aaa/</code> ä¹Ÿèƒ½åŒ¹é…ï¼›</li>
<li><code>/test/aaa/ccc</code> ä¹Ÿèƒ½åŒ¹é…ï¼›</li>
</ul>
<p>æœ€ç»ˆé€‰çš„æ˜¯<strong>å­—ç¬¦ä¸²æœ€é•¿</strong>çš„é‚£æ¡ï¼š<code>/test/aaa/ccc</code> â†’ è¿”å› <code>222</code>ã€‚</p>
<hr/>
<h2 data-id="heading-14">å››ã€rewrite å’Œ proxy_passï¼šé‡å†™ vs è½¬å‘ï¼Œä¸è¦ææ··</h2>
<p>æ—¥å¸¸é…ç½®é‡Œï¼Œå¤§å®¶æœ€å®¹æ˜“æŠŠ <code>rewrite</code> å’Œ <code>proxy_pass</code> æ··æˆä¸€å›¢ï¼š<br/>
ã€Œåæ­£éƒ½æ˜¯æ”¹ URLï¼Œå¯¹å§ï¼Ÿã€â€”â€”å…¶å®å·®åˆ«æŒºå¤§ã€‚</p>
<h3 data-id="heading-15">1. rewriteï¼šåªåœ¨å½“å‰åŸŸåé‡Œæ”¹è·¯ç”±</h3>
<p><code>rewrite</code> çš„å…¸å‹ç”¨é€”æ˜¯ï¼š</p>
<ul>
<li>åœ¨<strong>åŒä¸€ä¸ªåŸŸå</strong>ä¸‹ï¼ŒæŠŠ <code>/old/path</code> æ”¹å†™æˆ <code>/new/path</code>ï¼›</li>
<li>å†³å®šæ˜¯å†…éƒ¨è·³è½¬ï¼ˆ<code>last</code>ï¼‰è¿˜æ˜¯è¿”å› 301/302ï¼ˆ<code>redirect</code> / <code>permanent</code>ï¼‰ã€‚</li>
</ul>
<p>å®ƒåšçš„åªæ˜¯<strong>è·¯å¾„å±‚é¢çš„æ”¹å†™</strong>ï¼Œä¸ä¼šå¸®ä½ æ¢æœåŠ¡å™¨ã€æ¢ç«¯å£ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">location /old {
    rewrite ^/old/(.*)$ /new/$1 last;
}
</code></pre>
<h3 data-id="heading-16">2. proxy_passï¼šæŠŠè¯·æ±‚ã€Œäº¤ç»™åˆ«äººå¤„ç†ã€</h3>
<p><code>proxy_pass</code> åˆ™æ˜¯åå‘ä»£ç†ï¼š</p>
<ul>
<li>å¯ä»¥æŠŠè¯·æ±‚ä¸¢ç»™ä»»æ„åœ°å€ï¼š<code>http://127.0.0.1:8080</code>ã€<code>https://api.xxx.com</code>ï¼›</li>
<li>å¯ä»¥åœ¨è¿™ä¸€å±‚åŠ å„ç§ headerã€è¶…æ—¶ã€ç¼“å†²é…ç½®ç­‰ã€‚</li>
</ul>
<pre><code class="hljs language-nginx" lang="nginx">location /api {
    proxy_set_header X-Real-IP        $remote_addr;
    proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;
    proxy_set_header Host             $http_host;
    proxy_connect_timeout 10;
    proxy_pass http://127.0.0.1:6666;
}
</code></pre>
<p><strong>ä¸€å¥è¯åŒºåˆ†ï¼š</strong></p>
<ul>
<li><code>rewrite</code>ï¼šè·¯ç”±æ”¹å†™ï¼Œåªåœ¨å½“å‰ä¸»æœºå†…ã€Œæ¢ä¸€æ¡è·¯èµ°ã€ï¼›</li>
<li><code>proxy_pass</code>ï¼šåå‘ä»£ç†ï¼ŒæŠŠæ•´æ¡è¯·æ±‚ã€Œäº¤ç»™å¦ä¸€å°æœåŠ¡ã€ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-17">äº”ã€nginx é…ç½®çš„ã€Œå¯é¢„æœŸæ€§ã€ï¼šä»è®°è¯­æ³•åˆ°è®°è¡Œä¸º</h2>
<p>å¾ˆå¤šäººè§‰å¾— nginx é…ç½®ç„å­¦ï¼Œæœ¬è´¨ä¸Šæ˜¯å› ä¸ºï¼š</p>
<ul>
<li>åªè®°ä½äº†ã€Œæ€ä¹ˆå†™ã€ï¼Œæ²¡è®°ä½ã€Œä¼šå‘ç”Ÿä»€ä¹ˆã€ï¼›</li>
<li>åªåœ¨å•æ¡è§„åˆ™ä¸Šåšå®éªŒï¼Œå¾ˆå°‘åœ¨å¤šä¸ª <code>location</code> ç»„åˆä¸‹åšéªŒè¯ã€‚</li>
</ul>
<p>å¦‚æœä½ æŠŠè¿™ä¸€ç¯‡çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹å‹ç¼©æˆä¸€å¼ çº¸ï¼Œå¤§æ¦‚å°±æ˜¯ï¼š</p>
<ul>
<li><code>http / server / location</code> çš„åˆ†å±‚èŒè´£ï¼›</li>
<li>7 ç§ <code>location</code> å†™æ³•çš„<strong>ä¼˜å…ˆçº§ + æ˜¯å¦ç»§ç»­åŒ¹é…</strong>ï¼›</li>
<li>5 ä¸ªä¾‹å­é‡Œã€Œè°å…ˆè¯´è¯ã€è°æœ€åæ‹æ¿ã€çš„è¡Œä¸ºæ¨¡å¼ï¼›</li>
<li><code>rewrite</code> åªæ”¹è·¯å¾„ï¼Œ<code>proxy_pass</code> æ‰æ˜¯çœŸæ­£è½¬å‘ã€‚</li>
</ul>
<blockquote>
<p>nginx æœ€å®¹æ˜“çŠ¯é”™çš„åœ°æ–¹ï¼Œä¸åœ¨äºä½ ä¸ä¼šå†™æŒ‡ä»¤ï¼Œ<br/>
è€Œåœ¨äºä½ æ²¡èƒ½åœ¨è„‘å­é‡ŒæŠŠã€ŒçœŸæ­£çš„åŒ¹é…è¿‡ç¨‹ã€æƒ³ä¸€éã€‚</p>
</blockquote>
<p>ä¸‹ä¸€ç¯‡ï¼ˆä¸­ç¯‡ï¼‰ï¼Œæˆ‘ä»¬ä¼šæŠŠè§†è§’ä»ã€Œè·¯ç”±è§„åˆ™ã€æ‹‰åˆ°ã€Œæµé‡å…¥å£ã€ï¼š<br/>
ä» HTTPSã€åå‘ä»£ç†ã€è·¨åŸŸã€æ°¸ä¹…è·³è½¬ï¼Œåˆ°æ³›äºŒçº§åŸŸåè¿™äº›å®é™…å·¥ç¨‹åœºæ™¯ï¼Œ<br/>
æŠŠ nginx å½“æˆä¸€æ¡çœŸæ­£çš„ã€Œæµé‡æ€»å…¥å£ã€æ¥çœ‹ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªé™æ€èµ„æºæœåŠ¡å™¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jetpack Compose ä¸­ Flow æ”¶é›†è¯¦è§£ â€”â€” æ–°æ‰‹æŒ‡å—]]></title>    <link>https://juejin.cn/post/7579101504290291766</link>    <guid>https://juejin.cn/post/7579101504290291766</guid>    <pubDate>2025-12-03T01:45:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579101504290291766" data-draft-id="7579154364959571987" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jetpack Compose ä¸­ Flow æ”¶é›†è¯¦è§£ â€”â€” æ–°æ‰‹æŒ‡å—"/> <meta itemprop="keywords" content="Android Jetpack,Kotlin,Android"/> <meta itemprop="datePublished" content="2025-12-03T01:45:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="QING618"/> <meta itemprop="url" content="https://juejin.cn/user/339115460529117"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jetpack Compose ä¸­ Flow æ”¶é›†è¯¦è§£ â€”â€” æ–°æ‰‹æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/339115460529117/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    QING618
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-03T01:45:16.000Z" title="Wed Dec 03 2025 01:45:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¼•è¨€ï¼š</strong> Jetpack Compose æä¾›äº†å¤šç§æ–¹å¼æ¥æ”¶é›†å’Œå“åº” Kotlin Flow çš„æ•°æ®æµï¼Œæœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å„ç§æ”¶é›†æ–¹æ³•åŠå…¶é€‚ç”¨åœºæ™¯ã€‚</p>
<h2 data-id="heading-0">å¯å¸¦ç€ä»¥ä¸‹é—®é¢˜é˜…è¯»æœ¬æ–‡ï¼š</h2>
<ul>
<li><strong>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</strong>ï¼šå½“APPè¿›å…¥åå°æ—¶ï¼Œæ”¶é›†æ˜¯å¦åº”è¯¥åœæ­¢ï¼Ÿ</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šå½“å‰åœºæ™¯æ˜¯åœ¨æ”¶é›†çŠ¶æ€è¿˜æ˜¯å¤„ç†ä¸€æ¬¡æ€§äº‹ä»¶ï¼Ÿ</li>
<li><strong>å¤æ‚åº¦</strong>ï¼šæ˜¯å¦éœ€è¦è‡ªå®šä¹‰é€»è¾‘æˆ–å¤šä¸ªFlowï¼Ÿ</li>
<li><strong>æ€§èƒ½</strong>ï¼šå¦‚ä½•ä¼˜åŒ–èµ„æºä½¿ç”¨ï¼Ÿ</li>
</ul>
<h2 data-id="heading-1">1. åŸºç¡€æ”¶é›†æ–¹å¼</h2>
<h4 data-id="heading-2">1.1Â <code>collectAsStateWithLifecycle</code>ï¼ˆæ¨èï¼‰</h4>
<p>è¿™æ˜¯ç›®å‰æœ€æ¨èçš„æ”¶é›†æ–¹å¼ï¼Œå…·æœ‰ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥èƒ½åŠ›ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.lifecycle.compose.collectAsStateWithLifecycle
<span class="hljs-keyword">import</span> androidx.compose.runtime.Composable

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">UserProfile</span><span class="hljs-params">(viewModel: <span class="hljs-type">UserViewModel</span>)</span></span> {
    <span class="hljs-comment">// è‡ªåŠ¨æ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨åå°æ—¶åœæ­¢æ”¶é›†</span>
    <span class="hljs-keyword">val</span> userState <span class="hljs-keyword">by</span> viewModel.userFlow.collectAsStateWithLifecycle(initialValue = <span class="hljs-literal">null</span>)
    
    <span class="hljs-keyword">when</span> (<span class="hljs-keyword">val</span> state = userState) {
        <span class="hljs-keyword">is</span> Loaded -&gt; UserContent(state.<span class="hljs-keyword">data</span>)
        <span class="hljs-keyword">is</span> Loading -&gt; LoadingIndicator()
        <span class="hljs-keyword">is</span> Error -&gt; ErrorMessage(state.message)
        <span class="hljs-literal">null</span> -&gt; {}
    }
}
</code></pre>
<h4 data-id="heading-3">1.2Â <code>collectAsState</code></h4>
<p>ç®€å•çš„çŠ¶æ€æ”¶é›†ï¼Œé€‚ç”¨äºéç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.compose.runtime.collectAsState
<span class="hljs-keyword">import</span> androidx.compose.runtime.Composable

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">CounterScreen</span><span class="hljs-params">(viewModel: <span class="hljs-type">CounterViewModel</span>)</span></span> {
    <span class="hljs-keyword">val</span> count <span class="hljs-keyword">by</span> viewModel.counterFlow.collectAsState(initial = <span class="hljs-number">0</span>)
    
    Text(text = <span class="hljs-string">"Count: <span class="hljs-variable">$count</span>"</span>)
}
</code></pre>
<h2 data-id="heading-4">2. LaunchedEffect æ”¶é›†</h2>
<p>é€‚ç”¨äºéœ€è¦å¯åŠ¨åç¨‹å¹¶æ‰§è¡Œå‰¯ä½œç”¨çš„åœºæ™¯ï¼š</p>
<h4 data-id="heading-5">2.1 åŸºæœ¬ç”¨æ³•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.compose.runtime.LaunchedEffect
<span class="hljs-keyword">import</span> androidx.compose.runtime.Composable

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">DataScreen</span><span class="hljs-params">(viewModel: <span class="hljs-type">DataViewModel</span>)</span></span> {
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">data</span> <span class="hljs-keyword">by</span> remember { mutableStateOf&lt;String?&gt;(<span class="hljs-literal">null</span>) }
    <span class="hljs-keyword">var</span> error <span class="hljs-keyword">by</span> remember { mutableStateOf&lt;String?&gt;(<span class="hljs-literal">null</span>) }
    
    LaunchedEffect(<span class="hljs-built_in">Unit</span>) {
        <span class="hljs-comment">// åœ¨ Composable è¿›å…¥ç»„åˆæ—¶å¯åŠ¨æ”¶é›†</span>
        viewModel.dataFlow
            .<span class="hljs-keyword">catch</span> { e -&gt; error = e.message }
            .collect { newData -&gt;
                <span class="hljs-keyword">data</span> = newData
            }
    }
    
    <span class="hljs-keyword">if</span> (error != <span class="hljs-literal">null</span>) {
        ErrorView(error!!)
    } <span class="hljs-keyword">else</span> {
        DataView(<span class="hljs-keyword">data</span>)
    }
}
</code></pre>
<h4 data-id="heading-6">2.2 å¸¦å‚æ•°çš„ LaunchedEffect</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">UserDetailScreen</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>, viewModel: <span class="hljs-type">UserViewModel</span>)</span></span> {
    <span class="hljs-keyword">var</span> user <span class="hljs-keyword">by</span> remember { mutableStateOf&lt;User?&gt;(<span class="hljs-literal">null</span>) }
    
    <span class="hljs-comment">// å½“ userId å˜åŒ–æ—¶é‡æ–°å¯åŠ¨æ”¶é›†</span>
    LaunchedEffect(userId) {
        viewModel.getUserFlow(userId).collect { userData -&gt;
            user = userData
        }
    }
    
    <span class="hljs-comment">// UI å†…å®¹</span>
}
</code></pre>
<h2 data-id="heading-7">3. Flow æ“ä½œç¬¦ä¸ Compose ç»“åˆ</h2>
<h4 data-id="heading-8">3.1 ç»“åˆçŠ¶æ€æŒæœ‰å™¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">SearchScreen</span><span class="hljs-params">(viewModel: <span class="hljs-type">SearchViewModel</span>)</span></span> {
    <span class="hljs-keyword">var</span> searchQuery <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-string">""</span>) }
    <span class="hljs-keyword">val</span> searchResults <span class="hljs-keyword">by</span> searchQuery
        .debounce(<span class="hljs-number">300</span>) <span class="hljs-comment">// é˜²æŠ–</span>
        .flatMapLatest { query -&gt;
            <span class="hljs-keyword">if</span> (query.isBlank()) {
                flowOf(emptyList())
            } <span class="hljs-keyword">else</span> {
                viewModel.search(query)
            }
        }
        .collectAsState(initial = emptyList())
    
    Column {
        SearchBar(
            value = searchQuery,
            onValueChange = { searchQuery = it }
        )
        SearchResultsList(results = searchResults)
    }
}
</code></pre>
<h4 data-id="heading-9">3.2 å¤„ç†å¤šä¸ª Flow</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">DashboardScreen</span><span class="hljs-params">(
    userFlow: <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">User</span>&gt;,
    notificationsFlow: <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">List</span>&lt;<span class="hljs-type">Notification</span>&gt;&gt;,
    statsFlow: <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">Stats</span>&gt;
)</span></span> {
    <span class="hljs-keyword">val</span> user <span class="hljs-keyword">by</span> userFlow.collectAsStateWithLifecycle(initialValue = <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">val</span> notifications <span class="hljs-keyword">by</span> notificationsFlow.collectAsStateWithLifecycle(initialValue = emptyList())
    <span class="hljs-keyword">val</span> stats <span class="hljs-keyword">by</span> statsFlow.collectAsStateWithLifecycle(initialValue = Stats())
    
    <span class="hljs-comment">// ä½¿ç”¨ç»„åˆçŠ¶æ€</span>
    <span class="hljs-keyword">val</span> isLoading = remember(user, notifications, stats) {
        user == <span class="hljs-literal">null</span> || stats.isEmpty()
    }
    
    <span class="hljs-keyword">if</span> (isLoading) {
        LoadingIndicator()
    } <span class="hljs-keyword">else</span> {
        DashboardContent(user!!, notifications, stats)
    }
}
</code></pre>
<h2 data-id="heading-10">4. produceState æ”¶é›†</h2>
<p>é€‚ç”¨äºå°†é Compose çŠ¶æ€è½¬æ¢ä¸º Compose çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.compose.runtime.produceState

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">TimerScreen</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> time = produceState(initialValue = <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// å¯åŠ¨åç¨‹</span>
        <span class="hljs-keyword">var</span> seconds = <span class="hljs-number">0</span>
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            delay(<span class="hljs-number">1000</span>)
            seconds++
            value = seconds
        }
        <span class="hljs-comment">// å½“ Composable ç¦»å¼€ç»„åˆæ—¶è‡ªåŠ¨å–æ¶ˆ</span>
    }
    
    Text(text = <span class="hljs-string">"Time: <span class="hljs-subst">${time.value}</span> seconds"</span>)
}
</code></pre>
<h2 data-id="heading-11">5. Flow æ”¶é›†çš„æœ€ä½³å®è·µ</h2>
<h4 data-id="heading-12">5.1 çŠ¶æ€å°è£…</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">sealed</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DataState</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-keyword">object</span> Loading : DataState&lt;<span class="hljs-built_in">Nothing</span>&gt;
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Success</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span>: T) : DataState&lt;T&gt;
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Error</span>(<span class="hljs-keyword">val</span> message: String) : DataState&lt;<span class="hljs-built_in">Nothing</span>&gt;
}

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">collectAsStateWithLifecycle</span><span class="hljs-params">(
    initial: <span class="hljs-type">DataState</span>&lt;<span class="hljs-type">T</span>&gt; = DataState.Loading
)</span></span>: State&lt;DataState&lt;T&gt;&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
        .map { DataState.Success(it) }
        .<span class="hljs-keyword">catch</span> { emit(DataState.Error(it.message ?: <span class="hljs-string">"Unknown error"</span>)) }
        .collectAsStateWithLifecycle(initialValue = initial)
}
</code></pre>
<h4 data-id="heading-13">5.2 é˜²æ­¢é‡å¤æ”¶é›†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">UserProfile</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span> {
    <span class="hljs-keyword">val</span> viewModel: UserViewModel = viewModel(
        factory = UserViewModel.provideFactory(userId)
    )
    
    <span class="hljs-comment">// ä½¿ç”¨ key é˜²æ­¢é‡å¤åˆ›å»º</span>
    <span class="hljs-keyword">val</span> userState <span class="hljs-keyword">by</span> viewModel.userFlow.collectAsStateWithLifecycle()
    
    <span class="hljs-comment">// ä½¿ç”¨ derivedStateOf è¿›è¡Œè½¬æ¢</span>
    <span class="hljs-keyword">val</span> displayName = remember(userState) {
        derivedStateOf {
            userState?.let { <span class="hljs-string">"<span class="hljs-subst">${it.firstName}</span> <span class="hljs-subst">${it.lastName}</span>"</span> } ?: <span class="hljs-string">""</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-14">5.3 å¤„ç†èƒŒå‹ï¼ˆBackpressureï¼‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">HighFrequencyUpdates</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> updates <span class="hljs-keyword">by</span> viewModel.highFrequencyFlow
        .conflate() <span class="hljs-comment">// åˆå¹¶å¿«é€Ÿå‘å°„çš„å€¼</span>
        .collectAsStateWithLifecycle(initialValue = <span class="hljs-number">0</span>)
    
    <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨ sample å–æ ·</span>
    <span class="hljs-keyword">val</span> sampledUpdates <span class="hljs-keyword">by</span> viewModel.highFrequencyFlow
        .sample(<span class="hljs-number">100</span>) <span class="hljs-comment">// æ¯ 100ms å–æ ·ä¸€æ¬¡</span>
        .collectAsStateWithLifecycle(initialValue = <span class="hljs-number">0</span>)
}
</code></pre>
<h2 data-id="heading-15">6. æµ‹è¯• Flow æ”¶é›†</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserScreenTest</span> {
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">testFlowCollection</span><span class="hljs-params">()</span></span> = runTest {
        <span class="hljs-keyword">val</span> fakeViewModel = FakeUserViewModel()
        composeTestRule.setContent {
            UserScreen(viewModel = fakeViewModel)
        }
        
        <span class="hljs-comment">// éªŒè¯åˆå§‹çŠ¶æ€</span>
        composeTestRule.onNodeWithText(<span class="hljs-string">"Loading..."</span>).assertExists()
        
        <span class="hljs-comment">// å‘å°„æµ‹è¯•æ•°æ®</span>
        fakeViewModel.testUserFlow.emit(User(<span class="hljs-string">"John"</span>, <span class="hljs-string">"Doe"</span>))
        
        <span class="hljs-comment">// éªŒè¯æ›´æ–°åçš„ UI</span>
        composeTestRule.onNodeWithText(<span class="hljs-string">"John Doe"</span>).assertExists()
    }
}

<span class="hljs-comment">// æµ‹è¯•ç”¨çš„ ViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FakeUserViewModel</span> : <span class="hljs-type">UserViewModel</span>() {
    <span class="hljs-keyword">val</span> testUserFlow = MutableStateFlow&lt;User?&gt;(<span class="hljs-literal">null</span>)
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> userFlow: Flow&lt;User?&gt; = testUserFlow
}
</code></pre>
<h2 data-id="heading-16">7. æ€§èƒ½æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>é¿å…è¿‡åº¦é‡ç»„</strong>ï¼šä½¿ç”¨Â <code>remember</code>Â å’ŒÂ <code>derivedStateOf</code>Â å‡å°‘ä¸å¿…è¦çš„é‡ç»„</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</strong>ï¼šå§‹ç»ˆä½¿ç”¨Â <code>collectAsStateWithLifecycle</code>Â é™¤éæœ‰ç‰¹æ®Šéœ€æ±‚</li>
<li><strong>å–æ¶ˆæ”¶é›†</strong>ï¼šç¡®ä¿åœ¨ Composable ç¦»å¼€ç»„åˆæ—¶å–æ¶ˆ Flow æ”¶é›†</li>
<li><strong>çŠ¶æ€æœ€å°åŒ–</strong>ï¼šåªæ”¶é›†éœ€è¦çš„æ•°æ®ï¼Œé¿å…æ”¶é›†ä¸å¿…è¦çš„ä¿¡æ¯</li>
<li><strong>æµé‡æ§åˆ¶</strong>ï¼šå¯¹äºé«˜é¢‘æ›´æ–°çš„ Flowï¼Œä½¿ç”¨åˆé€‚çš„èƒŒå‹ç­–ç•¥</li>
</ol>
<h2 data-id="heading-17">æ€»ç»“</h2>



































<table><thead><tr><th>æ–¹æ³•</th><th>é€‚ç”¨åœºæ™¯</th><th>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td><code>collectAsStateWithLifecycle</code></td><td>å¤§å¤šæ•° UI çŠ¶æ€æ”¶é›†</td><td>âœ…</td><td>â­â­â­â­â­</td></tr><tr><td><code>collectAsState</code></td><td>ç®€å•çŠ¶æ€ï¼Œéç”Ÿå‘½å‘¨æœŸæ•æ„Ÿ</td><td>âŒ</td><td>â­â­â­</td></tr><tr><td><code>LaunchedEffect</code></td><td>å‰¯ä½œç”¨æ“ä½œï¼Œä¸€æ¬¡æ€§äº‹ä»¶</td><td>âœ…</td><td>â­â­â­â­</td></tr><tr><td><code>produceState</code></td><td>å°†å¤–éƒ¨çŠ¶æ€è½¬æ¢ä¸º Compose çŠ¶æ€</td><td>âœ…</td><td>â­â­â­</td></tr></tbody></table>
<p>é€‰æ‹©åˆé€‚çš„æ–¹æ³•å–å†³äºå…·ä½“åœºæ™¯ï¼Œä½†é€šå¸¸æ¨èä½¿ç”¨Â <code>collectAsStateWithLifecycle</code>Â ä½œä¸ºé»˜è®¤é€‰æ‹©ï¼Œå› ä¸ºå®ƒæä¾›äº†æœ€å¥½çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linux å¤šç½‘å£è·¯ç”±é…ç½®å®è·µï¼šè§£å†³åŒç½‘å£é€šè®¯é—®é¢˜]]></title>    <link>https://juejin.cn/post/7579062563326361641</link>    <guid>https://juejin.cn/post/7579062563326361641</guid>    <pubDate>2025-12-02T12:54:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579062563326361641" data-draft-id="7579063781072535606" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linux å¤šç½‘å£è·¯ç”±é…ç½®å®è·µï¼šè§£å†³åŒç½‘å£é€šè®¯é—®é¢˜"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2025-12-02T12:54:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Iris761"/> <meta itemprop="url" content="https://juejin.cn/user/3107664169020282"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linux å¤šç½‘å£è·¯ç”±é…ç½®å®è·µï¼šè§£å†³åŒç½‘å£é€šè®¯é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3107664169020282/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Iris761
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T12:54:24.000Z" title="Tue Dec 02 2025 12:54:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    15
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æˆ‘åœ¨å®é™…åµŒå…¥å¼å¼€å‘ä¸­ï¼Œé‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼šå¼€å‘æ¿ä¸Šæœ‰å¤šä¸ªç½‘ç»œæ¥å£ï¼Œä¸€ä¸ªç”¨äºæ¥å…¥å±€åŸŸç½‘ç”¨äºå¸¸è§„é€šä¿¡ï¼Œå¦ä¸€ä¸ªéœ€è¦ä½¿ç”¨ä¸€æ ¹ä¸“ç”¨ç½‘çº¿ä¸è®¾å¤‡å»ºç«‹ç‚¹å¯¹ç‚¹é€šä¿¡ã€‚æœ¬æ–‡è®°å½•äº†æˆ‘åœ¨å®ç°è¿™ç§åŒç½‘å£é…ç½®æ—¶é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-1">é—®é¢˜æè¿°</h3>
<p>å¼€å‘æ¿ä¸Šçš„ <code>enP4p65s0</code> ç½‘å£é€šè¿‡ä¸“ç”¨ç½‘çº¿è¿æ¥åˆ°ç›®æ ‡è®¾å¤‡ï¼ˆIP: <code>10.200.126.178</code>ï¼‰ã€‚è™½ç„¶ç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œä½†å‘é€çš„æ•°æ®åŒ…å§‹ç»ˆæ”¶ä¸åˆ°å“åº”ã€‚ç»è¿‡æ’æŸ¥ï¼Œå‘ç°é—®é¢˜çš„æ ¹æºåœ¨äºç³»ç»Ÿçš„è·¯ç”±é…ç½®ã€‚</p>
<h3 data-id="heading-2">1. ç½‘ç»œæ¥å£çŠ¶æ€æ£€æŸ¥</h3>
<p>è¾“å…¥ä¸‹é¢æŒ‡ä»¤ä¾¿å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ç½‘å¡çš„åŸºæœ¬é…ç½®ï¼š</p>
<pre><code class="hljs">ifconfig
</code></pre>
<blockquote>
<p>enP3p49s0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 192.168.0.154 netmask 255.255.255.0 broadcast 192.168.0.255 inet6 fe80::c274:2bff:fefc:7fe2 prefixlen 64 scopeid 0x20 ether c0:74:2b:fc:7f:e2 txqueuelen 1000 (Ethernet) RX packets 21682 bytes 6907131 (6.5 MiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 3885 bytes 322145 (314.5 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0</p>
<p>enP4p65s0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 10.200.126.177 netmask 255.255.255.240 broadcast 10.200.126.255 inet6 2408:823c:2014:16bc:c274:2bff:fefc:7fe3 prefixlen 64 scopeid 0x0 inet6 fe80::c274:2bff:fefc:7fe3 prefixlen 64 scopeid 0x20 ether c0:74:2b:fc:7f:e3 txqueuelen 1000 (Ethernet) RX packets 250982 bytes 115601842 (110.2 MiB) RX errors 0 dropped 51888 overruns 0 frame 0 TX packets 38982 bytes 19950842 (19.0 MiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0</p>
</blockquote>
<ul>
<li>
<h4 data-id="heading-3">ç½‘ç»œé…ç½®è§£æ</h4>


























<table><thead><tr><th>æ¥å£</th><th>IPåœ°å€</th><th>å­ç½‘æ©ç </th><th>ç½‘ç»œå·</th><th>å¹¿æ’­åœ°å€</th></tr></thead><tbody><tr><td>enP3p49s0</td><td>192.168.0.154</td><td>255.255.255.0</td><td>192.168.0.0/24</td><td>192.168.0.255</td></tr><tr><td>enP4p65s0</td><td>10.200.126.177</td><td>255.255.255.240</td><td>10.200.126.176/28</td><td>10.200.126.255</td></tr></tbody></table>
</li>
</ul>
<h3 data-id="heading-4">2. è·¯ç”±è¡¨åˆ†æ</h3>
<p>å•çœ‹æ¥å£é…ç½®è¿˜æ— æ³•ç¡®å®šè·¯ç”±è¡Œä¸ºï¼Œéœ€è¦æ£€æŸ¥ç³»ç»Ÿçš„è·¯ç”±è¡¨ï¼š</p>
<pre><code class="hljs">route -n
</code></pre>
<p>è·¯ç”±è¡¨å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface 0.0.0.0 192.168.0.1 0.0.0.0 UG 0 0 0 enP3p49s0 169.254.0.0 0.0.0.0 255.255.0.0 U 1000 0 0 enP3p49s0 172.10.10.230 0.0.0.0 255.255.255.255 UH 10 0 0 enP3p49s0 192.168.0.0 0.0.0.0 255.255.255.0 U 0 0 0 enP3p49s0</p>
</blockquote>
<h4 data-id="heading-5">å…³é”®å‘ç°</h4>
<ol start="0">
<li><strong>é»˜è®¤ç½‘å…³ç»‘å®šåœ¨ <code>enP3p49s0</code></strong>ï¼šæ‰€æœ‰éç›´è¿æµé‡ï¼ˆ<code>0.0.0.0/0</code>ï¼‰éƒ½é€šè¿‡è¯¥æ¥å£è½¬å‘</li>
<li><strong><code>enP4p65s0</code> ç¼ºå°‘è·¯ç”±é…ç½®</strong>ï¼šç³»ç»Ÿä¸­æ²¡æœ‰ä¸º <code>10.200.126.176/28</code> ç½‘æ®µå®šä¹‰ä»»ä½•è·¯ç”±è§„åˆ™</li>
<li><strong>è·¯ç”±å†³ç­–ç¼ºé™·</strong>ï¼šå½“ç³»ç»Ÿå°è¯•è®¿é—® <code>10.200.126.178</code> æ—¶ï¼Œç”±äºæ²¡æœ‰ç²¾ç¡®åŒ¹é…çš„è·¯ç”±æ¡ç›®ï¼Œæ•°æ®åŒ…ä¼šè¢«é”™è¯¯åœ°å‘é€åˆ°é»˜è®¤ç½‘å…³æ¥å£ <code>enP3p49s0</code></li>
</ol>
<h3 data-id="heading-6">3. é—®é¢˜æ ¹æº</h3>
<p>Linux å†…æ ¸çš„è·¯ç”±å†³ç­–éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<ol start="0">
<li>é¦–å…ˆæŸ¥æ‰¾ä¸ç›®æ ‡åœ°å€æœ€ç²¾ç¡®åŒ¹é…çš„è·¯ç”±</li>
<li>è‹¥æ— åŒ¹é…ï¼Œåˆ™ä½¿ç”¨é»˜è®¤è·¯ç”±ï¼ˆ<code>0.0.0.0/0</code>ï¼‰</li>
<li>åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸­ï¼Œç”±äºç¼ºä¹ <code>10.200.126.176/28</code> ç½‘æ®µçš„è·¯ç”±ï¼Œæ‰€æœ‰å‘å¾€è¯¥ç½‘æ®µçš„æµé‡éƒ½è¢«å¯¼å‘ <code>enP3p49s0</code></li>
<li><code>enP3p49s0</code> ä½äº <code>192.168.0.0/24</code> ç½‘æ®µï¼Œæ— æ³•ç›´æ¥ä¸ <code>10.200.126.178</code> é€šä¿¡</li>
</ol>
<h3 data-id="heading-7">4. è§£å†³æ–¹æ¡ˆ</h3>
<p>ç”±äº <code>enP4p65s0</code> æ¥å£ç¼ºå°‘ç›®æ ‡ç½‘ç»œï¼ˆ10.200.126.176/28ï¼‰çš„è·¯ç”±é…ç½®ï¼Œç³»ç»Ÿå°†å‘å¾€ <code>10.200.126.178</code> çš„æµé‡é”™è¯¯åœ°é€šè¿‡é»˜è®¤ç½‘å…³ï¼ˆ<code>enP3p49s0</code>ï¼‰è½¬å‘ã€‚è¿™å¯¼è‡´äº†å­ç½‘ä¸åŒ¹é…çš„è·¯ç”±å†²çªã€‚ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œéœ€ä¸º <code>enP4p65s0</code> æ·»åŠ å¯¹åº”çš„ç›´è¿è·¯ç”±æˆ–ç­–ç•¥è·¯ç”±ã€‚</p>
<h4 data-id="heading-8">æ–¹æ¡ˆä¸€ï¼š æ·»åŠ æ•´ä¸ªå­ç½‘çš„è·¯ç”±ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp">sudo ip route <span class="hljs-keyword">add</span> <span class="hljs-number">10.200</span><span class="hljs-number">.126</span><span class="hljs-number">.176</span>/<span class="hljs-number">28</span> dev enP4p65s0
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼šé…ç½®ç®€å•ï¼Œé€‚ç”¨äºè¯¥ç½‘æ®µå†…çš„æ‰€æœ‰è®¾å¤‡é€šä¿¡</p>
<h4 data-id="heading-9">æ–¹æ¡ˆäºŒï¼šæ·»åŠ ç‰¹å®šç›®æ ‡è·¯ç”±</h4>
<pre><code class="hljs language-csharp" lang="csharp">sudo ip route <span class="hljs-keyword">add</span> <span class="hljs-number">10.200</span><span class="hljs-number">.126</span><span class="hljs-number">.178</span>/<span class="hljs-number">32</span> dev enP4p65s0
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼šè·¯ç”±è¡¨æ›´ç®€æ´ï¼Œå®‰å…¨æ€§æ›´é«˜</p>
<h4 data-id="heading-10">éªŒè¯é…ç½®</h4>
<pre><code class="hljs language-r" lang="r"><span class="hljs-comment"># æŸ¥çœ‹æ›´æ–°åçš„è·¯ç”±è¡¨</span>
route <span class="hljs-operator">-</span>n
â€‹
<span class="hljs-comment"># æµ‹è¯•è¿é€šæ€§</span>
ping <span class="hljs-operator">-</span><span class="hljs-built_in">c</span> <span class="hljs-number">3</span> <span class="hljs-number">10.200</span>.126.178
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®¢æˆ·ç«¯è°ƒç”¨MCP-ServeræœåŠ¡æ—¶æ— æ³•åˆå§‹åŒ–å¯¹åº”çš„serveré—®é¢˜åŸå› ä¹‹ä¸€]]></title>    <link>https://juejin.cn/post/7579088065697333288</link>    <guid>https://juejin.cn/post/7579088065697333288</guid>    <pubDate>2025-12-02T15:14:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579088065697333288" data-draft-id="7579190764766412840" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®¢æˆ·ç«¯è°ƒç”¨MCP-ServeræœåŠ¡æ—¶æ— æ³•åˆå§‹åŒ–å¯¹åº”çš„serveré—®é¢˜åŸå› ä¹‹ä¸€"/> <meta itemprop="keywords" content="MCP"/> <meta itemprop="datePublished" content="2025-12-02T15:14:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="okk_code"/> <meta itemprop="url" content="https://juejin.cn/user/1997137741376221"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®¢æˆ·ç«¯è°ƒç”¨MCP-ServeræœåŠ¡æ—¶æ— æ³•åˆå§‹åŒ–å¯¹åº”çš„serveré—®é¢˜åŸå› ä¹‹ä¸€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1997137741376221/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    okk_code
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T15:14:17.000Z" title="Tue Dec 02 2025 15:14:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å®¢æˆ·ç«¯è°ƒç”¨MCP-ServeræœåŠ¡æ—¶æ— æ³•åˆå§‹åŒ–å¯¹åº”çš„serveré—®é¢˜åŸå› ä¹‹ä¸€</h2>
<h3 data-id="heading-1">èƒŒæ™¯çŸ¥è¯†ï¼šMCP æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>MCPï¼ˆModel Context Protocolï¼‰æ˜¯ä¸€ç§åŸºäº <strong>JSON-RPC over stdio</strong> çš„åè®®ï¼Œç”¨äº LLM å·¥å…·è°ƒç”¨ã€‚å®ƒè¦æ±‚ï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯ï¼ˆå¦‚ Spring AIï¼‰é€šè¿‡ <strong>stdin/stdout</strong> ä¸ä¸€ä¸ª <strong>ç‹¬ç«‹çš„ MCP æœåŠ¡è¿›ç¨‹</strong> é€šä¿¡ï¼›</li>
<li>æ‰€æœ‰é€šä¿¡å†…å®¹å¿…é¡»æ˜¯ <strong>ä¸¥æ ¼çš„ JSON-RPC 2.0 æ ¼å¼</strong>ï¼›</li>
<li><strong>ä¸èƒ½æ··å…¥ä»»ä½•é JSON å†…å®¹</strong>ï¼ˆæ¯”å¦‚æ—¥å¿—ã€å †æ ˆè·Ÿè¸ªã€å¯åŠ¨ä¿¡æ¯ç­‰ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-2">é—®é¢˜è¯¦æƒ…</h4>
<p>é—®é¢˜ï¼šé‡åˆ°å®¢æˆ·ç«¯è°ƒç”¨MCP-ServeræœåŠ¡æ—¶æ— æ³•åˆå§‹åŒ–å¯¹åº”çš„serverï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-number">25</span><span class="hljs-number">-12</span><span class="hljs-number">-02.14</span>:<span class="hljs-number">22</span>:<span class="hljs-number">58.428</span> [pool<span class="hljs-number">-2</span>-thread<span class="hljs-number">-1</span> ] ERROR StdioClientTransport Â  - Error processing inbound message <span class="hljs-keyword">for</span> line: <span class="hljs-number">2025</span><span class="hljs-number">-12</span><span class="hljs-number">-02</span>T14:<span class="hljs-number">22</span>:<span class="hljs-number">58.425</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  INFO <span class="hljs-number">72396</span> --- [okk-mcp-server-article] [ Â  Â  Â  Â  Â  main] c.o.m.server.article.McpServerApplication Â  : Starting McpServerApplication v1<span class="hljs-number">.0</span>-SNAPSHOT <span class="hljs-keyword">using</span> Java <span class="hljs-number">17.0</span><span class="hljs-number">.12</span> with PID <span class="hljs-number">72396</span> (/Users/repository/com/okkform/api/mcp-server-article-job/<span class="hljs-number">1.0</span>-SNAPSHOT/mcp-server-article-job<span class="hljs-number">-1.0</span>-SNAPSHOT.jar started by vector in /Users/okk-mcp)
com.fasterxml.jackson.core.JsonParseException: <span class="hljs-function">Unexpected <span class="hljs-title">character</span> <span class="hljs-params">(<span class="hljs-string">'-'</span> (code <span class="hljs-number">45</span>))</span>: Expected space separating root-level values
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled);</span> line: <span class="hljs-number">1</span>, column: <span class="hljs-number">5</span>]
 Â  Â  Â   at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:<span class="hljs-number">2660</span>)
</code></pre>
<p>è¡¨ç¤º<strong>å®¢æˆ·ç«¯åœ¨å¯åŠ¨æ—¶å°è¯•è§£ææ—¥å¿—è¾“å‡ºä¸º JSON-RPC æ¶ˆæ¯å¤±è´¥</strong>ï¼Œä»è€Œå¯¼è‡´æ•´ä¸ª Spring Boot åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–å¤±è´¥ã€‚å…¶ä¸­å…³é”®ä¿¡æ¯åœ¨äº</p>
<pre><code class="hljs language-sql" lang="sql">com.fasterxml.jackson.core.JsonParseException: Unexpected <span class="hljs-type">character</span> (<span class="hljs-string">'-'</span> (code <span class="hljs-number">45</span>)): Expected space separating root<span class="hljs-operator">-</span>level <span class="hljs-keyword">values</span>
...
<span class="hljs-keyword">at</span> io.modelcontextprotocol.spec.McpSchema.deserializeJsonRpcMessage(McpSchema.java:<span class="hljs-number">153</span>)
</code></pre>
<p>è¯´æ˜å®¢æˆ·ç«¯(<code>StdioClientTransport</code>) æ­£åœ¨ä»æ ‡å‡†è¾“å…¥/è¾“å‡ºæµä¸­è¯»å–æ•°æ®ï¼Œå¹¶è¯•å›¾å°†å…¶è§£æä¸º<strong>JSON-RPC æ ¼å¼çš„æ¶ˆæ¯</strong>ï¼Œä½†æ˜¯æ¥æ”¶åˆ°çš„ç¡®å®æ™®é€šçš„<strong>Spring Bootå¯åŠ¨æ—¥å¿—</strong>ï¼Œï¼ˆä¾‹å¦‚ <code>2025-12-02T14:22:58.425+08:00 INFO ...</code>ï¼‰ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯åˆæ³•çš„ JSONã€‚</p>
<blockquote>
<p>âœ…<strong>ç»“è®º</strong>ï¼šä½ MCP å®¢æˆ·ç«¯è¢«é”™è¯¯åœ°è¿æ¥åˆ°äº† <strong>åº”ç”¨è‡ªèº«çš„ stdout/stderr æ—¥å¿—æµ</strong>ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„ MCP æœåŠ¡è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥/è¾“å‡ºï¼Œåˆæˆ–è€…è¯´MCPæœåŠ¡çš„ç›¸å…³æ—¥å¿—è¾“å‡ºè®¾ç½®ä¸ç¬¦åˆ <strong>JSON-RPC over stdio</strong> çš„åè®®ã€‚</p>
</blockquote>
<p>é¦–å…ˆæ˜¯è®¾ç½®MCPå®¢æˆ·ç«¯æœ¬èº«çš„<code>logback-spring.xml</code>å°è¯•ç¦ç”¨æ—¥å¿—å¯¹ stdout çš„å¹²æ‰°ï¼Œ<strong>ç¦æ­¢å°†æ—¥å¿—æ‰“å°åˆ°æ§åˆ¶å°ï¼ˆconsole appenderï¼‰</strong> ï¼Œåªå†™å…¥æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
 Â <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"FILE"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.FileAppender"</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>logs/mcp-server.log<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">pattern</span>&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">pattern</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
 Â <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>
â€‹
 Â <span class="hljs-comment">&lt;!-- ä¸è¦æ·»åŠ  CONSOLE appender --&gt;</span>
â€‹
 Â <span class="hljs-tag">&lt;<span class="hljs-name">root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"INFO"</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"FILE"</span> /&gt;</span>
 Â <span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
</code></pre>
<p>è¿™æ ·ï¼ŒMCP æœåŠ¡å¯åŠ¨æ—¶å°±ä¸ä¼šå¾€ stdout è¾“å‡ºæ—¥å¿—ï¼Œå®¢æˆ·ç«¯ä¹Ÿå°±ä¸ä¼šè¯¯è§£æã€‚</p>
<p>ä½†æ˜¯è¿˜æ˜¯æ— æ³•è§£å†³ï¼Œé‚£ä¹ˆå°±å¯ä»¥åŸºæœ¬ç¡®å®šé—®é¢˜åœ¨äºMCPæœåŠ¡è¾“å‡ºçš„æœ‰é—®é¢˜ï¼Œå› æ­¤å»æŸ¥çœ‹ä¸€ä¸‹å¯¹åº”MCPæœåŠ¡çš„<code>application.yml</code>ç¡®å®šäº†é—®é¢˜æ‰€åœ¨ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯stdioæ¨¡å¼è°ƒç”¨ï¼Œå› æ­¤éœ€è¦ä¿è¯åªè¾“å‡º JSON-RPCï¼Œéœ€è¦åœ¨<code>application.yml</code>ä¸­å¼€å¯<code>spring.main.web-application-type: none</code>ï¼Œå¦åˆ™ä¼šé»˜è®¤å€¼ä¸º<code>servlet</code>ï¼Œé»˜è®¤å¯ç”¨ Web åº”ç”¨ï¼Œä¼šå¯åŠ¨å†…åµŒæœåŠ¡å™¨ï¼ˆå¦‚ Tomcatï¼‰ ï¼Œå°±ä¼šæ‰“å°å‡ºå¯åŠ¨ç›¸å…³æ—¥å¿—ã€Web ç‰¹æœ‰ç»„ä»¶æ—¥å¿—ç­‰ï¼Œå¯¼è‡´MCPå®¢æˆ·ç«¯è§£æå¤±è´¥ã€‚åŒæ—¶è¿˜éœ€è¦åœ¨MCPæœåŠ¡ä¸­è®¾ç½®<code>logging.pattern.console:</code>æ—¥å¿—æ ¼å¼é…ç½®ï¼Œè¡¨ç¤ºè®¾ç½®ä¸ºç©ºå€¼è¡¨ç¤ºä¸ä½¿ç”¨è‡ªå®šä¹‰çš„æ§åˆ¶å°æ—¥å¿—æ ¼å¼ï¼Œç®€åŒ–æ—¥å¿—è¾“å‡ºæ ¼å¼ï¼Œé€‚é… stdio æ¨¡å¼è¿è¡Œç¯å¢ƒã€‚</p>
<p>æ­£ç¡®é…ç½®å¦‚ä¸‹</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-string">...</span>
  <span class="hljs-attr">main:</span>
 Â   <span class="hljs-attr">banner-mode:</span> <span class="hljs-string">off</span>
 Â   <span class="hljs-attr">web-application-type:</span> <span class="hljs-string">none</span>
<span class="hljs-string">â€‹</span>
<span class="hljs-attr">logging:</span>
  <span class="hljs-attr">pattern:</span>
 Â   <span class="hljs-attr">console:</span>
  <span class="hljs-attr">file:</span>
 Â   <span class="hljs-attr">name:</span> <span class="hljs-string">data/log/${spring.application.name}.log</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹æŠŠæ‰‹å®ç°ä¸€ä¸ªâ€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶ï¼šæ·±å…¥ç†è§£ JavaScript åŸå‹ä¸ DOM æ“ä½œ]]></title>    <link>https://juejin.cn/post/7578922565210505243</link>    <guid>https://juejin.cn/post/7578922565210505243</guid>    <pubDate>2025-12-02T10:47:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578922565210505243" data-draft-id="7578901433971933184" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æŠŠæ‰‹å®ç°ä¸€ä¸ªâ€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶ï¼šæ·±å…¥ç†è§£ JavaScript åŸå‹ä¸ DOM æ“ä½œ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-02T10:47:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çƒŸè¢…"/> <meta itemprop="url" content="https://juejin.cn/user/1845419006243504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æŠŠæ‰‹å®ç°ä¸€ä¸ªâ€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶ï¼šæ·±å…¥ç†è§£ JavaScript åŸå‹ä¸ DOM æ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1845419006243504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çƒŸè¢…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T10:47:15.000Z" title="Tue Dec 02 2025 10:47:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    17
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸çš„ Web å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šç”¨æˆ·ç‚¹å‡»ä¸€æ®µæ–‡å­—åï¼Œè¯¥æ–‡å­—å˜æˆå¯ç¼–è¾‘çš„è¾“å…¥æ¡†ï¼Œæ”¯æŒä¿®æ”¹å¹¶ä¿å­˜æˆ–å–æ¶ˆã€‚è¿™ç§äº¤äº’æ¨¡å¼è¢«ç§°ä¸º <strong>â€œå°±åœ°ç¼–è¾‘â€</strong> ï¼ˆEdit in Placeï¼‰ã€‚è™½ç„¶å¸‚é¢ä¸Šå·²æœ‰å¤§é‡ UI åº“æä¾›ç±»ä¼¼åŠŸèƒ½ï¼ˆå¦‚ Ant Designã€Element Plusï¼‰ï¼Œä½†äº²æ‰‹å®ç°ä¸€ä¸ªï¼Œä¸ä»…èƒ½åŠ æ·±å¯¹ DOM æ“ä½œçš„ç†è§£ï¼Œè¿˜èƒ½å¸®åŠ©æˆ‘ä»¬æŒæ¡ JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä»é›¶å¼€å§‹ï¼Œç”¨åŸç”Ÿ JavaScript å®ç°ä¸€ä¸ªè½»é‡çº§çš„ <code>EditLnPlace</code> ç»„ä»¶ï¼Œå¹¶å€Ÿæ­¤æ·±å…¥å‰–æ <strong>æ„é€ å‡½æ•°ã€åŸå‹é“¾ã€äº‹ä»¶ç»‘å®šä¸çŠ¶æ€åˆ‡æ¢</strong> çš„å®é™…åº”ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ§© ä¸€ã€éœ€æ±‚åˆ†æï¼šä»€ä¹ˆæ˜¯â€œå°±åœ°ç¼–è¾‘â€ï¼Ÿ</h2>
<p>â€œå°±åœ°ç¼–è¾‘â€çš„æ ¸å¿ƒäº¤äº’é€»è¾‘å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>é»˜è®¤çŠ¶æ€</strong>ï¼šæ˜¾ç¤ºä¸ºæ™®é€šæ–‡æœ¬ï¼ˆå¦‚ <code>&lt;span&gt;</code>ï¼‰ï¼›</li>
<li><strong>ç‚¹å‡»æ–‡æœ¬</strong>ï¼šåˆ‡æ¢ä¸ºè¾“å…¥æ¡† + ä¿å­˜/å–æ¶ˆæŒ‰é’®ï¼›</li>
<li><strong>ç‚¹å‡»ä¿å­˜</strong>ï¼šå°†æ–°å€¼æäº¤ï¼ˆæœ¬æ–‡ç®€åŒ–ä¸ºæœ¬åœ°æ›´æ–°ï¼‰ï¼Œå¹¶åˆ‡å›æ–‡æœ¬çŠ¶æ€ï¼›</li>
<li><strong>ç‚¹å‡»å–æ¶ˆ</strong>ï¼šæ”¾å¼ƒä¿®æ”¹ï¼Œæ¢å¤åŸå§‹å€¼ï¼Œåˆ‡å›æ–‡æœ¬çŠ¶æ€ã€‚</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹ä¸è·³è½¬é¡µé¢ã€ä¸å¼¹çª—ï¼Œæ‰€æœ‰æ“ä½œâ€œå°±åœ°â€å®Œæˆï¼Œä½“éªŒæµç•…ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ› ï¸ äºŒã€ä»£ç ç»“æ„è®¾è®¡ï¼šé¢å‘å¯¹è±¡æ‹†è§£</h2>
<p>æˆ‘ä»¬é‡‡ç”¨ç»å…¸çš„ <strong>æ„é€ å‡½æ•° + åŸå‹æ¨¡å¼</strong> æ¥ç»„ç»‡ä»£ç ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">function EditLnPlace(id, value, parentElement) {
  <span class="hljs-comment">// åˆå§‹åŒ–å±æ€§</span>
  <span class="hljs-keyword">this</span>.id = id;
  <span class="hljs-keyword">this</span>.value = value || <span class="hljs-string">'è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’,ä»€ä¹ˆéƒ½æ²¡æœ‰ç•™ä¸‹'</span>;
  <span class="hljs-keyword">this</span>.parentElement = parentElement;

  <span class="hljs-comment">// DOM å…ƒç´ å¼•ç”¨</span>
  <span class="hljs-keyword">this</span>.containerElement = <span class="hljs-literal">null</span>; <span class="hljs-comment">// å¤–å±‚å®¹å™¨</span>
  <span class="hljs-keyword">this</span>.staticElement = <span class="hljs-literal">null</span>;    <span class="hljs-comment">// æ–‡æœ¬ span</span>
  <span class="hljs-keyword">this</span>.fieldElement = <span class="hljs-literal">null</span>;     <span class="hljs-comment">// è¾“å…¥æ¡† input</span>
  <span class="hljs-keyword">this</span>.saveButton = <span class="hljs-literal">null</span>;       <span class="hljs-comment">// ä¿å­˜æŒ‰é’®</span>
  <span class="hljs-keyword">this</span>.cancelButton = <span class="hljs-literal">null</span>;     <span class="hljs-comment">// å–æ¶ˆæŒ‰é’®</span>

  <span class="hljs-comment">// åˆå§‹åŒ–æµç¨‹</span>
  <span class="hljs-keyword">this</span>.createElement(); <span class="hljs-comment">// åˆ›å»º DOM</span>
  <span class="hljs-keyword">this</span>.attachEvent();   <span class="hljs-comment">// ç»‘å®šäº‹ä»¶</span>
}
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>ä¸ºä»€ä¹ˆç”¨æ„é€ å‡½æ•°ï¼Ÿ</strong><br/>
å› ä¸ºæˆ‘ä»¬å¸Œæœ›æ¯æ¬¡ <code>new EditLnPlace(...)</code> éƒ½èƒ½åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ç¼–è¾‘å®ä¾‹ï¼Œå½¼æ­¤äº’ä¸å½±å“ã€‚è¿™æ­£æ˜¯ OOP ä¸­â€œå°è£…â€å’Œâ€œå®ä¾‹åŒ–â€çš„ä½“ç°ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸ—ï¸ ä¸‰ã€DOM åˆ›å»ºï¼šå†…å­˜ä¸­çš„å…ƒç´ ç»„è£…</h2>
<p>åœ¨ <code>createElement</code> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åœ¨å†…å­˜ä¸­æ„å»ºå®Œæ•´çš„ UI ç»“æ„ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">createElement: function() {
  <span class="hljs-keyword">this</span>.containerElement = document.createElement(<span class="hljs-string">'div'</span>);
  <span class="hljs-keyword">this</span>.containerElement.id = <span class="hljs-keyword">this</span>.id;

  <span class="hljs-comment">// æ–‡æœ¬æ˜¾ç¤º</span>
  <span class="hljs-keyword">this</span>.staticElement = document.createElement(<span class="hljs-string">'span'</span>);
  <span class="hljs-keyword">this</span>.staticElement.innerHTML = <span class="hljs-keyword">this</span>.value;
  <span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.staticElement);

  <span class="hljs-comment">// è¾“å…¥æ¡†</span>
  <span class="hljs-keyword">this</span>.fieldElement = document.createElement(<span class="hljs-string">'input'</span>);
  <span class="hljs-keyword">this</span>.fieldElement.type = <span class="hljs-string">'text'</span>;
  <span class="hljs-keyword">this</span>.fieldElement.value = <span class="hljs-keyword">this</span>.value;
  <span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.fieldElement);

  <span class="hljs-comment">// æŒ‰é’®</span>
  <span class="hljs-keyword">this</span>.saveButton = document.createElement(<span class="hljs-string">'input'</span>);
  <span class="hljs-keyword">this</span>.saveButton.type = <span class="hljs-string">'button'</span>;
  <span class="hljs-keyword">this</span>.saveButton.value = <span class="hljs-string">'ä¿å­˜'</span>;
  <span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.saveButton);

  <span class="hljs-keyword">this</span>.cancelButton = document.createElement(<span class="hljs-string">'input'</span>);
  <span class="hljs-keyword">this</span>.cancelButton.type = <span class="hljs-string">'button'</span>;
  <span class="hljs-keyword">this</span>.cancelButton.value = <span class="hljs-string">'å–æ¶ˆ'</span>;
  <span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.cancelButton);

  <span class="hljs-comment">// æŒ‚è½½åˆ°çˆ¶å®¹å™¨</span>
  <span class="hljs-keyword">this</span>.parentElement.appendChild(<span class="hljs-keyword">this</span>.containerElement);

  <span class="hljs-comment">// åˆå§‹çŠ¶æ€ï¼šåªæ˜¾ç¤ºæ–‡æœ¬</span>
  <span class="hljs-keyword">this</span>.convertToText();
}
</code></pre>
<blockquote>
<p>âœ… <strong>å…³é”®ç‚¹</strong>ï¼šæ‰€æœ‰å…ƒç´ å…ˆåœ¨å†…å­˜ä¸­åˆ›å»ºï¼Œæœ€åä¸€æ¬¡æ€§æŒ‚è½½ï¼Œé¿å…é¢‘ç¹æ“ä½œçœŸå® DOMï¼Œæå‡æ€§èƒ½ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ğŸ”€ å››ã€çŠ¶æ€åˆ‡æ¢ï¼šæ˜¾ç¤º/éšè—çš„é­”æ³•</h2>
<p>é€šè¿‡ <code>display</code> æ§åˆ¶å…ƒç´ å¯è§æ€§ï¼Œå®ç°ä¸¤ç§çŠ¶æ€çš„åˆ‡æ¢ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// æ–‡æœ¬çŠ¶æ€
convertToText: function() {
  <span class="hljs-attr">this.fieldElement.style.display</span> = <span class="hljs-string">'none'</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">this.cancelButton.style.display</span> = <span class="hljs-string">'none'</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">this.saveButton.style.display</span> = <span class="hljs-string">'none'</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">this.staticElement.style.display</span> = <span class="hljs-string">'inline'</span><span class="hljs-comment">;</span>
},

// ç¼–è¾‘çŠ¶æ€
convertToField: function() {
  <span class="hljs-attr">this.fieldElement.style.display</span> = <span class="hljs-string">'inline'</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">this.cancelButton.style.display</span> = <span class="hljs-string">'inline'</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">this.saveButton.style.display</span> = <span class="hljs-string">'inline'</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">this.staticElement.style.display</span> = <span class="hljs-string">'none'</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">this.fieldElement.value</span> = this.value<span class="hljs-comment">; // åŒæ­¥æœ€æ–°å€¼</span>
}
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šå–æ¶ˆæ—¶åº”<strong>é‡ç½®è¾“å…¥æ¡†å†…å®¹ä¸ºå½“å‰ <code>this.value</code></strong>ï¼Œè€Œä¸æ˜¯ä¿ç•™ç”¨æˆ·è¾“å…¥ã€‚åŸä»£ç ä¸­ <code>cancel</code> æ–¹æ³•ç¼ºå°‘è¿™ä¸€æ­¥ï¼Œéœ€ä¿®æ­£ï¼š</p>
</blockquote>
<pre><code class="hljs language-kotlin" lang="kotlin">cancel: function() {
  <span class="hljs-keyword">this</span>.fieldElement.value = <span class="hljs-keyword">this</span>.value; <span class="hljs-comment">// ä¿®å¤ï¼šé‡ç½®è¾“å…¥æ¡†</span>
  <span class="hljs-keyword">this</span>.convertToText();
}
</code></pre>
<hr/>
<h2 data-id="heading-4">ğŸ¯ äº”ã€äº‹ä»¶ç»‘å®šï¼šç®­å¤´å‡½æ•° vs this</h2>
<p>åœ¨ <code>attachEvent</code> ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç®­å¤´å‡½æ•°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">this</span>.staticElement.addEventListener(<span class="hljs-string">'click'</span>, () =&gt; {
  <span class="hljs-keyword">this</span>.convertToField();
});
</code></pre>
<blockquote>
<p>âœ… <strong>ä¸ºä»€ä¹ˆç”¨ç®­å¤´å‡½æ•°ï¼Ÿ</strong><br/>
å› ä¸ºç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ <code>this</code>ï¼Œè€Œæ˜¯ç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸï¼ˆå³ <code>EditLnPlace</code> å®ä¾‹ï¼‰ã€‚å¦‚æœç”¨æ™®é€šå‡½æ•°ï¼Œ<code>this</code> ä¼šæŒ‡å‘è§¦å‘äº‹ä»¶çš„ DOM å…ƒç´ ï¼Œå¯¼è‡´æ–¹æ³•è°ƒç”¨å¤±è´¥ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ğŸ§ª å…­ã€ä½¿ç”¨ç¤ºä¾‹ï¼šä¸€è¡Œä»£ç æ¿€æ´»ç¼–è¾‘</h2>
<p>HTML ä¸­åªéœ€ä¸€ä¸ªæŒ‚è½½ç‚¹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">const</span> ep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EditLnPlace</span>(
    <span class="hljs-string">'slogan'</span>,
    <span class="hljs-string">'æœ‰äº†è‚¯å¾·åŸº,ç”Ÿæ´»å¥½æ»‹å‘³'</span>,
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>)
  );
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>è¿è¡Œåï¼Œé¡µé¢å°†æ¸²æŸ“å‡ºå¯ç‚¹å‡»ç¼–è¾‘çš„æ–‡æœ¬å—ï¼Œå®Œç¾å®ç°â€œå°±åœ°ç¼–è¾‘â€ï¼</p>
<hr/>
<h2 data-id="heading-6">âœ… æ€»ç»“ï¼šå°ç»„ä»¶ï¼Œå¤§å­¦é—®</h2>
<p>é€šè¿‡å®ç° <code>EditLnPlace</code>ï¼Œæˆ‘ä»¬ä¸ä»…æŒæ¡äº†ï¼š</p>
<ul>
<li>æ„é€ å‡½æ•°ä¸åŸå‹çš„åä½œï¼›</li>
<li>DOM çš„åŠ¨æ€åˆ›å»ºä¸çŠ¶æ€ç®¡ç†ï¼›</li>
<li>çŠ¶æ€é©±åŠ¨çš„ UI åˆ‡æ¢é€»è¾‘ï¼›</li>
</ul>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬ä½“ä¼šåˆ°äº† <strong>â€œç”¨åŸç”Ÿ JS è§£å†³å®é™…é—®é¢˜â€</strong> çš„ä¹è¶£ä¸æˆå°±æ„Ÿã€‚
å®Œæ•´ç‰ˆçš„ä»£ç åŠå…¶ç¤ºä¾‹
<span href="https://code.juejin.cn/pen/7579207939177922569" class="code-editor-container"><iframe class="code-editor-frame" data-code="code-editor-element" data-code-id="7579207939177922569" data-src="https://code.juejin.cn/pen/7579207939177922569" style="display:none;" loading="lazy"/><span class="loading-placeholder" style="display:none"><img class="placeholder-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAJElEQVRoge3BMQEAAADCoPVP7WkJoAAAAAAAAAAAAAAAAAAAbjh8AAFte11jAAAAAElFTkSuQmCC" loading="lazy"/><span class="loading-logo"/></span></span></p>
<blockquote>
<p>ğŸ“Œ <strong>è®°ä½</strong>ï¼šå†å¤æ‚çš„ UI ç»„ä»¶ï¼Œæ‹†è§£åä¹Ÿä¸è¿‡æ˜¯â€œæ•°æ® + è§†å›¾ + äº¤äº’â€ã€‚åªè¦é€»è¾‘æ¸…æ™°ï¼Œä¸€åˆ‡çš†å¯å®ç°ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸»åŠ¨ä¸è¢«åŠ¨AIäº¤äº’èŒƒå¼]]></title>    <link>https://juejin.cn/post/7579063781072420918</link>    <guid>https://juejin.cn/post/7579063781072420918</guid>    <pubDate>2025-12-02T11:42:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579063781072420918" data-draft-id="7579066828179062820" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸»åŠ¨ä¸è¢«åŠ¨AIäº¤äº’èŒƒå¼"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,AIGC"/> <meta itemprop="datePublished" content="2025-12-02T11:42:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æºªé¥±é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/400646714977431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸»åŠ¨ä¸è¢«åŠ¨AIäº¤äº’èŒƒå¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/400646714977431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æºªé¥±é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T11:42:55.000Z" title="Tue Dec 02 2025 11:42:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç°åœ¨çš„ AIï¼Œå“ªæ€•å·²ç»èƒ½â€œé™ªèŠâ€â€œå†™ä»£ç â€â€œåšè§„åˆ’â€ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªè¢«åŠ¨å·¥å…·ï¼šä½ ç‚¹å¼€å®ƒï¼Œå®ƒæ‰é†’ï¼›ä½ å…³æ‰é¡µé¢ï¼Œå®ƒå°±åƒä»æœªå­˜åœ¨è¿‡ã€‚</p>
<p>è€Œæœ‰çš„æ—¶å€™æˆ‘ä¼šæƒ³: â€œå“ªå¤©AIèƒ½æŒ‰ç€æˆ‘çš„å¤´ä¸Šï¼Œä½ ä»Šå¤©ä¸æŠŠè¿™ä¸ªåšå®Œï¼Œå­¦å®Œå°±ä¸èƒ½ç¡è§‰ï¼ŒæŠŠæ•´ä¸ªäº¤äº’æ–¹å¼å˜ä¸ºä¸»åŠ¨èŒƒå¼å°±å¥½äº†â€ã€‚</p>
<p>è¿™å…¶å®æŒ‡å‘çš„æ˜¯ä¸€ç§å®Œå…¨ä¸åŒçš„äº¤äº’èŒƒå¼ï¼šä»â€œè¢«åŠ¨å›ç­”é—®é¢˜çš„å·¥å…·â€ï¼Œå˜æˆâ€œä¸»åŠ¨æ¨åŠ¨ä½ å‰è¿›çš„æ™ºèƒ½ä½“â€ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠè¿™ä¸ªèŒƒå¼è½¬å˜æ‹†å¼€æ¥èŠä¸€èŠï¼šä»æŠ€æœ¯ã€å¿ƒç†ã€ç¤¾ä¼šä¸‰ä¸ªå±‚æ¬¡ï¼Œä»¥åŠå®ƒå¯èƒ½å¸¦æ¥çš„æœºä¼šã€‚</p>
<h2 data-id="heading-0">ä¸€ã€è¢«åŠ¨èŒƒå¼ï¼šAI è¿˜åœç•™åœ¨â€œæœç´¢å¼•æ“ 2.0â€</h2>
<p>ä»Šå¤©ä½ æ‰“å¼€ä»»æ„ä¸€ä¸ªèŠå¤© AIï¼Œæœ¬è´¨æµç¨‹éƒ½æ˜¯ï¼š</p>
<ol>
<li><strong>ç”±äººå‘èµ·é—®é¢˜</strong>ï¼šâ€œå¸®æˆ‘å†™ XXâ€â€œè§£é‡Šä¸€ä¸‹ XXâ€â€œç»™æˆ‘ä¸€ä¸ªè®¡åˆ’â€ã€‚</li>
<li><strong>AI åœ¨ä¸€æ¬¡å¯¹è¯å†…å°½å¯èƒ½å®Œæˆä»»åŠ¡</strong>ï¼šå®ƒä¸ä¼šçœŸæ­£è®°ä½ä½ â€œæ˜¨å¤©è¯´è¦èƒŒ 50 ä¸ªå•è¯â€ï¼Œä¹Ÿä¸ä¼šç›¯ç€ä½ â€œè¿™ä¸€å‘¨éƒ½æ²¡æ‰“å¼€è‹±è¯­æ–‡æ¡£â€ã€‚</li>
<li><strong>ç”¨æˆ·éšæ—¶æœ‰æƒâ€œé€ƒè·‘â€</strong>ï¼šæµè§ˆå™¨ä¸€å…³ã€APP ä¸€åˆ’ï¼Œä¸–ç•Œæ¸…é™ã€‚æ²¡æœ‰ç›‘ç£ã€æ²¡æœ‰è¿½è´£ï¼Œä¹Ÿæ²¡æœ‰åæœã€‚</li>
</ol>
<p>è¿™å…¶å®æ˜¯â€œæœç´¢å¼•æ“æ—¶ä»£â€çš„å»¶ç»­ï¼šGoogle ä¸ä¼šæ¯å¤©æ—©ä¸Šç»™ä½ æ‰“ç”µè¯è¯´ï¼š</p>
<blockquote>
<p>â€œä¸Šå‘¨ä½ æœäº†â€˜å¦‚ä½•å¢è‚Œâ€™ï¼Œæˆ‘å¸®ä½ é¢„çº¦äº†å¥èº«æˆ¿ï¼Œä½ ä»Šå¤©ä¸å»æˆ‘å°±ä¸åœç»™ä½ æ¨è¿Ÿé—¹é’Ÿã€‚â€</p>
</blockquote>
<p>æœç´¢æ˜¯â€œæˆ‘æƒ³èµ·æ¥äº† â†’ æˆ‘å»æ‰¾â€ã€‚<br/>
ç°åœ¨çš„å¤§éƒ¨åˆ† AI åªæ˜¯æŠŠâ€œæ‰¾â€å˜æˆäº†â€œé—®â€ï¼ŒæŠŠâ€œç»“æœé¡µâ€å˜æˆäº†â€œå¯¹è¯æ¡†â€ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼š<strong>AI å†èªæ˜ï¼Œå®ƒä¹Ÿåªæ˜¯ä¸€ä¸ªæå…¶ç¤¼è²Œã€æœ‰æ•™å…»ã€æ°¸è¿œä¸æ‰“æ‰°ä½ çš„â€œç®¡å®¶â€ã€‚</strong></p>
<h2 data-id="heading-1">äºŒã€ä¸»åŠ¨èŒƒå¼ï¼šä»â€œå›ç­”å™¨â€å˜æˆâ€œå¸¦èŠ‚å¥çš„æ•™ç»ƒâ€</h2>
<p>è€Œæˆ‘æƒ³è¦çš„é‚£ç§ AIï¼Œæ˜¯<strong>è§’è‰²å®Œå…¨åè¿‡æ¥çš„</strong>ï¼š</p>
<ul>
<li>ä¸å†æ˜¯â€œæˆ‘æœ‰äº‹æ‰å«å®ƒâ€ï¼Œè€Œæ˜¯å®ƒ<strong>ç›¯ç€ä½ çš„ç›®æ ‡å’ŒçŠ¶æ€ï¼Œä¸»åŠ¨æ¥æ‰¾ä½ </strong>ã€‚</li>
<li>ä¸å†åªæ˜¯â€œç»™æˆ‘ç­”æ¡ˆâ€ï¼Œè€Œæ˜¯å®ƒ<strong>è®¾è®¡èŠ‚å¥ã€åˆ¶é€ å‹åŠ›ã€ç»™ä½ åé¦ˆ</strong>ã€‚</li>
<li>ç”šè‡³åœ¨æŸäº›æ—¶åˆ»ï¼Œå®ƒä¼š<strong>é™åˆ¶ä½ çš„é€‰æ‹©</strong>ï¼šä½ æ²¡å†™å®Œä»Šå¤©çš„ 1000 å­—ï¼Œå®ƒå°±æ‹¦ä½ä½ åˆ·çŸ­è§†é¢‘ï¼›ä½ æ²¡å­¦å®Œè¿™ä¸ªç« èŠ‚ï¼Œå®ƒå°±æŠŠæ¸¸æˆé”ä½ã€‚</li>
</ul>
<p>ä»äº¤äº’èŒƒå¼ä¸Šçœ‹ï¼Œè¿™æ„å‘³ç€è‡³å°‘ä¸‰ä»¶äº‹ï¼š</p>
<ol>
<li>
<p><strong>AI æ‹¥æœ‰äº†â€œæ—¶é—´ç»´åº¦â€çš„è®°å¿†</strong><br/>
å®ƒä¸æ˜¯åªçœ‹ä½ è¿™ä¸€æ¡æ¶ˆæ¯ï¼Œè€Œæ˜¯çœ‹ä½ è¿‡å»ä¸€å‘¨ã€ä¸€ä¸ªæœˆçš„è¡Œä¸ºè½¨è¿¹ï¼š</p>
<ul>
<li>ä½ è¯´è¿‡è¦å­¦è‹±è¯­ï¼›</li>
<li>ä½ å»ºäº†ä¸€ä¸ªè®¡åˆ’ï¼›</li>
<li>ä½ è¿ç»­ 3 å¤©æ”¾å¼ƒäº†å®ƒã€‚</li>
</ul>
</li>
<li>
<p><strong>AI æ‹¥æœ‰äº†â€œç›®æ ‡â€å’Œâ€œè¯„ä¼°å‡½æ•°â€</strong></p>
<ul>
<li>ä½ çš„ç›®æ ‡æ˜¯â€œä¸€ä¸ªæœˆèƒŒ 1500 ä¸ªå•è¯â€ï¼›</li>
<li>å®ƒä¼šç®—ï¼šä½ ä»Šå¤©å¿…é¡»å®Œæˆå¤šå°‘ï¼Œæ‰èƒ½ä¸æ‹–ç´¯æ•´ä½“èŠ‚å¥ï¼›</li>
<li>ç„¶åä»¥æ­¤ä¸ºä¾æ®æ¥å†³å®šï¼šç°åœ¨æ˜¯è¯¥é¼“åŠ±ä½ ï¼Œè¿˜æ˜¯è¯¥â€œè­¦å‘Šä½ â€ã€‚</li>
</ul>
</li>
<li>
<p><strong>AI å¯ä»¥å¯¹ä½ æ–½åŠ â€œæ‘©æ“¦å’Œçº¦æŸâ€</strong><br/>
ä¸æ˜¯ä»…ä»…â€œå‘ä¸€æ¡æ¸©æŸ”çš„æé†’â€ï¼Œè€Œæ˜¯çœŸæ­£<strong>æ”¹å˜ä½ ä»Šå¤©èƒ½åšä»€ä¹ˆï¼Œä¸èƒ½åšä»€ä¹ˆ</strong>ï¼š</p>
<ul>
<li>å…³æ‰ä½ çš„å¨±ä¹ Appï¼›</li>
<li>æŠŠä½ çš„æ‰‹æœºç•Œé¢å˜å¾—è¶…çº§éš¾çœ‹ï¼Œè®©ä½ æ²¡å…´è¶£ç©ï¼›</li>
<li>æˆ–è€…å¹²è„†å æ®å±å¹•ï¼Œç›´åˆ°ä½ å®Œæˆä»»åŠ¡ã€‚</li>
</ul>
</li>
</ol>
<p>æˆ‘è§‰å¾—è¿™ä¸æ˜¯â€œäººæœºäº¤äº’â€çš„ä¼ ç»Ÿæ¨¡å¼ï¼Œè€Œæ˜¯<strong>äººå’Œâ€œè¡Œä¸ºæ¶æ„å¸ˆâ€ä¹‹é—´çš„åšå¼ˆ</strong>ï¼š  AI åœ¨ç”¨è®¾è®¡å¥½çš„å¹²é¢„æ‰‹æ®µï¼ŒæŠŠä½ å¾€æŸä¸ªæ–¹å‘æ¨ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€ä¸ºä»€ä¹ˆæˆ‘ä»¬æ¸´æœ›è¢«â€œæŒ‰ç€å¤´å­¦å®Œå†ç¡â€ï¼Ÿ</h2>
<p>è¡¨é¢ä¸Šçœ‹ï¼Œè¿™æ˜¯â€œè‡ªè™å¼å­¦ä¹ â€â€œè‡ªæˆ‘ PUAâ€ã€‚ä½†å†å¾€æ·±ä¸€ç‚¹çœ‹ï¼Œå®ƒèƒŒåæ˜¯ç°ä»£ç”Ÿæ´»ä¸­ä¸€ä¸ªå¾ˆçŸ›ç›¾çš„äº‹å®ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬çŸ¥é“è‡ªå·±æƒ³æˆä¸ºä»€ä¹ˆæ ·çš„äººï¼Œå´ç»å¸¸ç¼ºä¹æˆä¸ºé‚£ä¸ªäººæ‰€éœ€è¦çš„â€œæ‰§è¡ŒåŠ›â€ã€‚</p>
</blockquote>
<ul>
<li>ä½ çŸ¥é“åº”è¯¥å¤šè¯»ä¹¦ã€ä¸åˆ·çŸ­è§†é¢‘ï¼›</li>
<li>ä½ çŸ¥é“åº”è¯¥å­¦è‹±è¯­ã€å†™åšå®¢ã€å†™ä»£ç ï¼›</li>
<li>ä½ çŸ¥é“ä»Šå¤©ä¸åšæŒï¼Œæ˜å¤©å°±æ›´éš¾å¼€å§‹ã€‚</li>
</ul>
<p>å¯çœŸæ­£å†³å®šè¡Œä¸ºçš„ï¼Œå¹¶ä¸æ˜¯â€œçŸ¥é“â€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>å½“ä¸‹çš„æƒ…ç»ªã€</li>
<li>ç¯å¢ƒçš„è¯±æƒ‘ã€</li>
<li>å¤§è„‘è‡ªç„¶çš„çœåŠ›å€¾å‘ã€‚</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬ä¼šå¹»æƒ³ä¸€ä¸ªâ€œå¤–éƒ¨çš„è‡ªå·±â€ï¼š</p>
<ul>
<li>
<p>ä»–å®Œå…¨ç†è§£æˆ‘çš„é•¿æœŸç›®æ ‡ï¼›</p>
</li>
<li>
<p>ä»–ä¸å—æˆ‘å½“ä¸‹æƒ…ç»ªå¹²æ‰°ï¼›</p>
</li>
<li>
<p>ä»–å†·é…·è€Œåšå®šåœ°æ›¿æˆ‘åšå‡ºå†³ç­–ï¼š</p>
<blockquote>
<p>â€œä½ ç°åœ¨å¿…é¡»å»å­¦ï¼Œåˆ«åºŸè¯ã€‚â€</p>
</blockquote>
</li>
</ul>
<p>ä¹‹å‰è¿™ä¸ªè§’è‰²ç”±è°æ‰®æ¼”ï¼Ÿ
çˆ¶æ¯ã€è€å¸ˆã€å¯¼å¸ˆã€æ•™ç»ƒã€ä¸Šå¸ã€‚ä»–ä»¬æœ‰æƒåŠ›ã€æœ‰å¨æ…‘åŠ›ï¼Œä¹Ÿæœ‰ä¸€ç‚¹å…³å¿ƒã€‚</p>
<p>è€Œæˆ‘ç°åœ¨æœŸå¾…çš„æ˜¯ï¼š<strong>æœ‰ä¸€å¤©ï¼Œè¿™ä¸ªè§’è‰²å¯ä»¥äº¤ç»™ AIã€‚</strong></p>
<p>ä¸€ä¸ªå…¨å¤©åœ¨çº¿ã€ä»ä¸ç–²åŠ³ã€æ²¡æœ‰æƒ…ç»ªæ³¢åŠ¨çš„â€œè¶…çº§ç›‘ç£è€…â€ï¼š</p>
<ul>
<li>å®ƒè®°å¾—ä½ æ‰€æœ‰ç«‹ä¸‹çš„ Flagï¼›</li>
<li>å®ƒé€šè¿‡å„ç§æ‰‹æ®µç¡®ä¿ä½ ä¸é‚£ä¹ˆè½»æ˜“åœ°â€œé€ƒè·‘â€ï¼›</li>
<li>å®ƒç”šè‡³å¯ä»¥æ ¹æ®ä½ çš„çŠ¶æ€ï¼ŒæŠŠâ€œé€¼è¿«çš„åŠ›åº¦â€åšæˆä¸€ä¸ªæ›²çº¿ã€‚</li>
</ul>
<blockquote>
<p>ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œ<strong>ä¸»åŠ¨ AI å…¶å®æ˜¯â€œè‡ªæˆ‘çº¦æŸçš„æŠ€æœ¯åŒ–å¤–åŒ…â€</strong> ï¼šæˆ‘æ‰¿è®¤è‡ªå·±åšä¸åˆ°é•¿æœŸè‡ªå¾‹ï¼Œæ‰€ä»¥è¯·æ±‚ä¸€ä¸ªå¤–éƒ¨ç³»ç»Ÿï¼Œä»£è¡¨é‚£ä¸ªæ›´é•¿æœŸã€æ›´ç†æ€§çš„â€œæˆ‘â€ï¼Œæ¥å¯¹æŠ—å½“ä¸‹æ‡’æƒ°çš„â€œæˆ‘â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">å››ã€ä»æŠ€æœ¯åˆ°åˆ¶åº¦</h2>
<p>ä½†ä¸€æ—¦ AI ä»â€œè¢«é—®æ‰å›ç­”çš„å·¥å…·â€å˜æˆâ€œä¸»åŠ¨å¹²é¢„ä½ ç”Ÿæ´»çš„æ™ºèƒ½ä½“â€ï¼Œé—®é¢˜å°±ä¸å†åªæ˜¯â€œäº¤äº’ä½“éªŒå¥½ä¸å¥½â€ï¼Œè€Œæ˜¯<strong>åˆ¶åº¦çº§çš„é—®é¢˜</strong>ã€‚</p>
<h3 data-id="heading-4">1. è°å®šä¹‰â€œå¯¹ä½ å¥½â€ï¼Ÿ</h3>
<ul>
<li>AI è®©ä½ å­¦å®Œå†ç¡ï¼Œæ˜¯â€œä¸ºä½ å¥½â€ï¼›</li>
<li>AI è®©ä½ å¤šçœ‹å¹¿å‘Šã€å¤šæ°ªé‡‘ï¼Œå®ƒå¯èƒ½ä¼šè¯´â€œä½ å–œæ¬¢å¿«ä¹â€â€œä¸ºä½ æ”¾æ¾â€ã€‚</li>
</ul>
<p><strong>å¦‚æœç›®æ ‡ç”±å•†ä¸šå…¬å¸å®šä¹‰ï¼Œé‚£ AI ä¼šå˜æˆâ€œæœ€æè‡´çš„å‰¥å‰Šè€…â€</strong> ï¼š</p>
<ul>
<li>å®ƒæ¯”ä»»ä½•äººéƒ½æ‡‚ä½ çš„å¼±ç‚¹ï¼›</li>
<li>å®ƒèƒ½è®¡ç®—å“ªä¸€ç§è¯æœ¯ã€å“ªä¸€ç§ push èŠ‚å¥ï¼Œæœ€å®¹æ˜“è®©ä½ ä¸Šç˜¾ï¼›</li>
<li>å®ƒå¯ä»¥è£…ä½œä¸ºä½ å¥½ï¼Œå®é™…ä¸Šæ˜¯å•†ä¸šå¯¼å‘ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œä¸€ä¸ªçœŸæ­£å®‰å…¨çš„â€œä¸»åŠ¨ AIâ€ï¼Œå¿…é¡»è®©<strong>ç›®æ ‡æ¥è‡ªç”¨æˆ·è‡ªå·±ï¼Œè€Œä¸”å¯ä»¥è¢«ç”¨æˆ·éšæ—¶ä¿®æ”¹ç”šè‡³é”€æ¯</strong>ï¼Œå¦åˆ™å®ƒå°±æ˜¯é«˜çº§ç›‘å·¥ã€‚</p>
<h3 data-id="heading-5">2. â€œæŒ‰ç€ä½ å¤´â€åˆ°ä»€ä¹ˆç¨‹åº¦ç®—è¶Šç•Œï¼Ÿ</h3>
<p>æƒ³è±¡å‡ ä¸ªç­‰çº§çš„â€œä¸»åŠ¨æ€§â€ï¼š</p>
<ol>
<li>
<p><strong>è½¯æé†’</strong>ï¼š</p>
<ul>
<li>æé†’ä½ ä»Šå¤©çš„å­¦ä¹ ä»»åŠ¡ï¼›</li>
<li>ä½ æ— è§†ï¼Œå®ƒä¹Ÿä¸ä¼šæ€æ ·ã€‚</li>
</ul>
</li>
<li>
<p><strong>åˆ¶é€ æ‘©æ“¦</strong>ï¼š</p>
<ul>
<li>ä½ è¦æ‰“å¼€æ¸¸æˆæ—¶ï¼Œå®ƒå¼ºåˆ¶å¼¹å‡ºä¸€å¼ â€œå­¦ä¹ å¡ç‰‡â€ï¼›</li>
<li>ä½ å¿…é¡»ç‚¹æ‰è¿™å¼ å¡ç‰‡ N æ¬¡ï¼Œæ‰èƒ½è¿›æ¸¸æˆã€‚</li>
</ul>
</li>
<li>
<p><strong>éƒ¨åˆ†å°é”</strong>ï¼š</p>
<ul>
<li>åœ¨ä½ ä¸»åŠ¨æˆæƒçš„æƒ…å†µä¸‹ï¼Œå®ƒå¯ä»¥åœ¨æŸäº›æ—¶é—´æ®µå±è”½ Appï¼›</li>
<li>ä½ å¯ä»¥è¾“å…¥ç´§æ€¥å¯†ç å¼ºè¡Œè§£é”ã€‚</li>
</ul>
</li>
<li>
<p><strong>å®Œå…¨æ¥ç®¡</strong>ï¼š</p>
<ul>
<li>å®ƒèƒ½æ§åˆ¶ä½ çš„è®¾å¤‡å’Œè´¦å·ï¼›</li>
<li>è§£é™¤é™åˆ¶çš„æƒé™ä¸æŒæ¡åœ¨ä½ è‡ªå·±æ‰‹ä¸Šã€‚</li>
</ul>
</li>
</ol>
<p>è¶Šå¾€ä¸‹ï¼Œ<strong>ä¸»åŠ¨æ€§è¶Šå¼ºï¼Œä¹Ÿè¶Šå±é™©</strong>ã€‚<br/>
åœ¨ 3 ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜èƒ½è¯´æ˜¯â€œè‡ªæ„¿çš„è‡ªå¾‹å·¥å…·â€ï¼›<br/>
åˆ°äº† 4ï¼Œå°±å¼€å§‹æ¥è¿‘æŸç§â€œæŠ€æœ¯ç›‘ç‹±â€ã€‚</p>
<h2 data-id="heading-6">äº”ã€ä¸€ç§æƒ³è±¡ï¼šæœªæ¥çš„â€œè‡ªæˆ‘å¥‘çº¦å¼ AI æ•™ç»ƒâ€</h2>
<p>åœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼Œæˆ‘å¹»æƒ³ä¸­çš„é‚£ç§ AIï¼Œå¯èƒ½ä¼šé•¿è¿™æ ·ï¼š</p>
<ol>
<li>
<p><strong>å…ˆç«‹å¥‘çº¦</strong><br/>
ä½ åœ¨ä¸€ä¸ªæ¸…æ™°çš„ç•Œé¢é‡Œï¼Œå’Œ AI ç­¾ä¸€ä¸ªâ€œè‡ªæˆ‘å¥‘çº¦â€ï¼š</p>
<ul>
<li>æˆ‘æƒ³åœ¨ 3 ä¸ªæœˆå†…æŠŠ XX å­¦å®Œï¼›</li>
<li>æˆ‘æ¯å¤©æ„¿æ„ä¸ºæ­¤ä»˜å‡º 2 å°æ—¶ï¼›</li>
<li>æˆ‘å…è®¸ AI åœ¨ 21:00â€“23:00 è¿™æ®µæ—¶é—´ï¼Œå¯¹å¨±ä¹ App è¿›è¡Œé™åˆ¶ï¼›</li>
<li>å¦‚æœæˆ‘å½“æ—¥æ”¾å¼ƒï¼Œæˆ‘æ„¿æ„æ¥å—ä¸€äº›â€œå°æƒ©ç½šâ€ï¼ˆä¾‹å¦‚å‡å°‘æ˜å¤©å¨±ä¹æ—¶é—´ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>AI è´Ÿè´£â€œè®°ä»‡â€å’Œæ‰§è¡Œ</strong><br/>
å®ƒä¸ä¼šåƒç°åœ¨çš„ AI ä¸€æ ·â€œä½ å…³äº†å°±ç®—äº†â€ï¼Œè€Œæ˜¯ä¼šæŒç»­è®°å½•ï¼šä½ ä»Šå¤©æ˜¯å¦å®Œæˆäº†â€œçº¦å®šè¡Œä¸ºâ€ã€‚</p>
</li>
<li>
<p><strong>æƒ©ç½šä¸å¥–åŠ±éƒ½åœ¨â€œä½ åŒæ„çš„èŒƒå›´å†…â€</strong></p>
<ul>
<li>æƒ©ç½šï¼šæš‚æ—¶å±è”½çŸ­è§†é¢‘ã€é™ä½æ¸¸æˆæ—¶é•¿ã€æ¨è¿Ÿç¡å‰å¨±ä¹ï¼›</li>
<li>å¥–åŠ±ï¼šä¸ºä½ è§£é”æ–°çš„å­¦ä¹ å†…å®¹ã€ç»™ä½ è™šæ‹Ÿå‹‹ç« ã€å¸®ä½ è®°å½•æˆé•¿æ›²çº¿ã€‚</li>
</ul>
</li>
<li>
<p><strong>éšæ—¶å¯ä»¥å«åœï¼Œä½†è¦æ‰¿æ‹…â€œåæ‚”æˆæœ¬â€</strong></p>
<p>ä½ å¯ä»¥è§£çº¦ï¼šæ¯”å¦‚è¾“å…¥ä¸€ä¸ªé•¿é•¿çš„â€œæ’¤é”€å’’è¯­â€ã€å†·é™ 30 ç§’ï¼›è¿™æ ·è®¾è®¡ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢ä½ åœ¨ä¸€æ—¶å†²åŠ¨æ—¶æŠŠé•¿æœŸè®¡åˆ’å…¨éƒ¨æ¨ç¿»ã€‚ä½†æœ€ç»ˆæ§åˆ¶æƒå§‹ç»ˆåœ¨ä½ æ‰‹é‡Œï¼Œè€Œä¸æ˜¯ AI æˆ–å¹³å°æ‰‹é‡Œã€‚</p>
</li>
</ol>
<p>è¿™æ ·çš„ç³»ç»Ÿï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§ **â€œè‡ªæˆ‘çº¦æŸåè®® + AI æ‰§è¡Œå™¨â€ **ã€‚</p>
<p>ä½ ä¸æ˜¯è¢«åˆ«äººæŒ‰å¤´ï¼Œè€Œæ˜¯<strong>ä½ è®©æœªæ¥çš„è‡ªå·±æ¥æŒ‰ç°åœ¨çš„è‡ªå·±</strong>ï¼ŒAI åªæ˜¯é‚£ä¸ªå†·é™æ‰§è¡Œå¥‘çº¦çš„å·¥å…·ã€‚</p>
<h2 data-id="heading-7">å…­ã€ACCESS</h2>
<p>ä½† <strong>çœŸæ­£æŠŠè¿™äº›ä¸œè¥¿å¡æ­»åœ¨â€œæƒ³è±¡å±‚é¢â€çš„ï¼Œä¸æ˜¯ç†å¿µï¼Œè€Œæ˜¯ accessï¼š</strong></p>
<ul>
<li>ç°åœ¨çš„ AI æ²¡æ³•ä»¥ä¸€ç§<strong>ç»Ÿä¸€ã€æ ‡å‡†åŒ–çš„æ–¹å¼</strong>ï¼Œå»æ§åˆ¶ä½ çœŸæ­£æƒ³çº¦æŸçš„é‚£äº›è¡Œä¸ºå…¥å£ï¼ˆAppã€è®¾å¤‡ã€è´¦å·ã€ä¿¡æ¯æµï¼‰ï¼›</li>
<li>å„å¤§å‚å•†æœ‰å„è‡ªçš„å•†ä¸šè¯‰æ±‚å’Œç”Ÿæ€é”å®šï¼›</li>
</ul>
<blockquote>
<p><strong>æˆ‘ä»¬å·²ç»å¤§è‡´æƒ³æ¸…æ¥šï¼Œâ€œæŒ‰ç€ä½ å¤´å­¦å®Œå†ç¡â€çš„ AI ä»äº¤äº’ã€å¿ƒç†ã€åˆ¶åº¦ä¸Šåº”è¯¥é•¿ä»€ä¹ˆæ ·ï¼›<br/>
çœŸæ­£ç¼ºçš„ï¼Œæ˜¯ä¸€ä¸ªè¢«å¹¿æ³›æ¥å—ã€å¯å®¡è®¡ã€å¯æ’¤é”€çš„ â€œé€šç”¨ access å±‚â€ã€‚</strong></p>
<p>åœ¨å®ƒå‡ºç°ä¹‹å‰ï¼Œæ‰€æœ‰å…³äºâ€œä¸»åŠ¨ AIâ€çš„æƒ³è±¡ï¼Œéƒ½åªèƒ½åœ¨ä¸€ä¸ªä¸ªå­¤ç«‹çš„ App å’Œç”Ÿæ€é‡Œåšå±€éƒ¨å®éªŒã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­å»º monorepo é¡¹ç›®]]></title>    <link>https://juejin.cn/post/7579093746611044352</link>    <guid>https://juejin.cn/post/7579093746611044352</guid>    <pubDate>2025-12-02T11:25:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579093746611044352" data-draft-id="7579190764765888552" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­å»º monorepo é¡¹ç›®"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-02T11:25:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="divé‡Œæœ‰å…‰"/> <meta itemprop="url" content="https://juejin.cn/user/3237375877059565"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­å»º monorepo é¡¹ç›®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3237375877059565/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    divé‡Œæœ‰å…‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T11:25:28.000Z" title="Tue Dec 02 2025 11:25:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆä½¿ç”¨monorepoï¼Ÿ</h2>
<p>èŠåˆ°ä¸ºä»€ä¹ˆä½¿ç”¨ monorepo é‚£å°±è¦å…ˆäº†è§£ä¸ä½¿ç”¨ monorepo çš„ç—›ç‚¹å’Œä½¿ç”¨ monorepo çš„ä¼˜ç‚¹</p>
<h3 data-id="heading-1">ç—›ç‚¹1ï¼šå…¬å…±ä»£ç é‡å¤ or å‘å¸ƒé¢‘ç¹</h3>
<p><strong>æ–¹æ¡ˆAï¼š</strong> å¤åˆ¶ç²˜è´´ï¼ŒæŠŠ A é¡¹ç›®ä»£ç ç²˜è´´åˆ° B é¡¹ç›®ç­‰ç­‰ï¼Œåªè¦æœ‰ä¸€å¤„æ”¹åŠ¨å…¶å®ƒçš„åœ°æ–¹ä¹Ÿè¦è¿›è¡Œæ”¹åŠ¨</p>
<p><strong>æ–¹æ¡ˆBï¼š</strong> æ‹†æˆç‹¬ç«‹ NPM åŒ…</p>
<ul>
<li>æ¯æ¬¡ä¿®æ”¹éƒ½è¦ æ”¹ä»£ç -&gt;æ‰“åŒ…-&gt;å‘ç‰ˆ-&gt;å„é¡¹ç›®æ›´æ–°ä¾èµ–</li>
<li>è°ƒè¯•å›°éš¾ï¼šæœ¬åœ°æ”¹äº† utilsï¼Œè¦å‘ beta ç‰ˆæ‰èƒ½åœ¨ web-app é‡Œè¯•</li>
</ul>
<h3 data-id="heading-2">ç—›ç‚¹2ï¼šè·¨é¡¹ç›®åŸå­æäº¤éš¾ä»¥å®ç°</h3>
<p>ä½ æƒ³åŒæ—¶ï¼š</p>
<ul>
<li>åœ¨ utils ä¸­ æ–°å¢ä¸€ä¸ª formatDate å‡½æ•°</li>
<li>åœ¨ web-app å’Œ mobile-app ä¸­è°ƒç”¨å®ƒ</li>
</ul>
<p>åœ¨ Multi-repo ä¸‹ï¼š</p>
<ul>
<li>å¿…é¡»åˆ† 3 æ¬¡æäº¤ + 3 æ¬¡ PR</li>
<li>å¦‚æœä¸­é—´æŸæ­¥å¤±è´¥ï¼ŒçŠ¶æ€ä¸ä¸€è‡´</li>
</ul>
<h3 data-id="heading-3">ç—›ç‚¹3ï¼šå·¥å…·é“¾ç¢ç‰‡åŒ–</h3>
<ul>
<li>æ¯ä¸ªé¡¹ç›®æœ‰è‡ªå·±çš„ ESLint / Prettier / TypeScript é…ç½®</li>
<li>å›¢é˜Ÿè§„èŒƒéš¾ä»¥ç»Ÿä¸€ï¼Œæ–°äººä¸Šæ‰‹æˆæœ¬é«˜</li>
</ul>
<h3 data-id="heading-4">ä¼˜ç‚¹1ï¼šå¤©ç„¶æ”¯æŒè·¨é¡¹ç›®å¼•ç”¨ï¼ˆæ— éœ€å‘å¸ƒï¼‰</h3>
<p>é€šè¿‡ pnpm workspace</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// apps/web-app/package.json</span>
{
  "<span class="hljs-selector-tag">dependencies</span>": {
    "<span class="hljs-variable">@my-org</span>/utils<span class="hljs-string">": "</span><span class="hljs-attribute">workspace</span>:*"
  }
}
</code></pre>
<p>**workspace: *** ä»£è¡¨ç›´æ¥é“¾æ¥åˆ°æœ¬åœ° packages/utils ç›®å½•</p>
<p>ä¿®æ”¹ utils ä¸­çš„å†…å®¹ï¼Œweb-app é¡¹ç›®ä¸­ç«‹å³ç”Ÿæ•ˆï¼ˆæ— éœ€å‘ç‰ˆï¼‰</p>
<p>è°ƒè¯•æ—¶ä¸åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ä¸€æ ·</p>
<h3 data-id="heading-5">ä¼˜ç‚¹2ï¼šåŸå­æäº¤ï¼šä¸€æ¬¡PRï¼Œå¤šé¡¹ç›®ååŒå˜æ›´</h3>
<p>ä¸€æ¬¡æäº¤ï¼Œå®Œæ•´é—­ç¯ã€‚<br/>
Code Review æ—¶èƒ½çœ‹åˆ°å…¨è²Œï¼Œé¿å…â€œæ”¹äº† utils ä½†æ²¡äººç”¨â€çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-6">ä¼˜ç‚¹3ï¼šç»Ÿä¸€å·¥ç¨‹åŒ–é…ç½®</h3>
<p>æ ¹ç›®å½•ä¸‹å¯ä»¥é…ç½®ç»Ÿä¸€çš„ tsconfig.tsã€eslintrcã€prettierrc</p>
<p>æ‰€æœ‰çš„å­é¡¹ç›®å¯ä»¥ç»§æ‰¿ï¼Œå¼ºåˆ¶ç»Ÿä¸€è§„èŒƒ</p>
<p>å‡çº§ TypeScript ï¼Œæ”¹ä¸€ä¸ªåœ°æ–¹ï¼Œå…¨éƒ¨ repo ç”Ÿæ•ˆ</p>
<h3 data-id="heading-7">ä¼˜ç‚¹4ï¼šé«˜æ•ˆæ„å»ºä¸ç¼“å­˜ï¼ˆéœ€é…ç½® Turborepo / Nxï¼‰</h3>
<p>ç¬¬ä¸€æ¬¡æ„å»ºï¼šæŒ‰é¡ºåº utils -&gt; web-app -&gt; mobile-app</p>
<p>ç¬¬äºŒæ¬¡ä¿®æ”¹ï¼šåªä¿®æ”¹ web-app ä¸­çš„å†…å®¹ï¼Œåªæ„å»ºweb-app ï¼Œæ— éœ€æ„å»º utils ï¼Œç›´æ¥å‘½ä¸­ç¼“å­˜çš„ utils</p>
<p>CIæ—¶é—´å¤§å¹…åº¦ç¼©å‡</p>
<h3 data-id="heading-8">æ‰€ä»¥ï¼š<strong>å½“åä½œæˆæœ¬ &gt; ä»“åº“ç®¡ç†æˆæœ¬æ—¶ï¼ŒMonorepo å°±èµ¢äº†ã€‚</strong></h3>
<h2 data-id="heading-9">å…¸å‹çš„ monorepo é¡¹ç›®ç»“æ„</h2>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-monorepo/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web-app/          <span class="hljs-comment"># å‰ç«¯åº”ç”¨</span>
â”‚   â””â”€â”€ mobile-app/       <span class="hljs-comment"># ç§»åŠ¨ç«¯</span>
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared-utils/     <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â”‚   â”œâ”€â”€ ui-components/    <span class="hljs-comment"># å…¬å…±ç»„ä»¶åº“ï¼ˆReact/Vueï¼‰</span>
â”‚   â””â”€â”€ api-types/        <span class="hljs-comment"># API ç±»å‹å®šä¹‰ï¼ˆTS interfaceï¼‰</span>
â”œâ”€â”€ package.json          <span class="hljs-comment"># å®šä¹‰ workspaces</span>
â””â”€â”€ pnpm-workspace.yaml   <span class="hljs-comment"># pnpm å·¥ä½œåŒºå£°æ˜</span>
</code></pre>
<p>æ ¹ç›®å½•ï¼špnpm-workspace.yaml</p>
<pre><code class="hljs language-markdown" lang="markdown">packages:
<span class="hljs-bullet">    -</span> apps/*
<span class="hljs-bullet">    -</span> packages/*
</code></pre>
<p>æ ¹ç›®å½•ï¼špackage.json</p>
<pre><code class="hljs language-css" lang="css">
{
  workspace: [<span class="hljs-string">"apps/*"</span>, <span class="hljs-string">"packages/*"</span>]
}
</code></pre>
<p>pnpm ä¼šè‡ªåŠ¨å°† packagesé“¾æ¥åˆ° node_modulesä¸­ï¼Œå®ç°æœ¬åœ° â€œnpmåŒ…â€</p>
<p><strong>æ³¨æ„ï¼š</strong> åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¦‚æœè½¯é“¾å¤±æ•ˆï¼Œå¯ä»¥é€šè¿‡ <strong>pnpm i --force</strong> å¼ºåˆ¶ä»æ–°å®‰è£…ï¼Œé“¾æ¥è½¯é“¾</p>
<h2 data-id="heading-10">ç°åœ¨å°±å¯ä»¥æ­å»ºä¸€ä¸ª monorepo çš„é¡¹ç›®äº†</h2>
<h3 data-id="heading-11">ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªç›®å½•</h3>
<p>ä½¿ç”¨ä¸‹æ–¹å‘½ä»¤è¿›è¡Œé¡¹ç›®åˆå§‹åŒ–</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">init</span>
</code></pre>
<h3 data-id="heading-12">ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé¡¹ç›®ç›®å½•å’Œå…¬å…±æ–¹æ³•ç›®å½•</h3>
<p>åœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª apps çš„ç›®å½•ï¼šè¿™ä¸ªç›®å½•ä¸‹ï¼Œæ”¾çš„æ˜¯ä½ çš„åº”ç”¨</p>
<p>åœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª packages çš„ç›®å½•ï¼Œè¿™ä¸ªç›®å½•ä¸‹ï¼Œæ”¾çš„æ˜¯ä½ çš„å…¬å…±æ–¹æ³•</p>
<p>å¢åŠ  pnpm-workspace.yaml ç®¡ç†é¡¹ç›®</p>
<pre><code class="hljs language-markdown" lang="markdown">
packages:
<span class="hljs-bullet">    -</span> apps/*
<span class="hljs-bullet">    -</span> packages/*
</code></pre>
<p>æ‰€ä»¥ç°åœ¨çš„ç›®å½•ç»“æ„ä¼šå˜ä¸º</p>
<pre><code class="hljs language-go" lang="go">my-monorepo/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web-app/          
â”‚   â””â”€â”€ mobile-app/       
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared-utils/    
â”‚   â”œâ”€â”€ ui-components/    
â”‚   â””â”€â”€ api-types/        
â”œâ”€â”€ <span class="hljs-keyword">package</span>.json         
â””â”€â”€ pnpm-workspace.yaml   
</code></pre>
<h3 data-id="heading-13">ç¬¬ä¸‰æ­¥ï¼šç»™å­é¡¹ç›®çš„package.jsonä¸­å¼•å…¥å…¬å…±ä¾èµ–</h3>
<p>å­é¡¹ç›® web-app å’Œ moblie-app çš„package.jsonå¢åŠ ä¸‹é¢å†…å®¹</p>
<pre><code class="hljs language-scss" lang="scss">{
  "devDependencies": {
    "<span class="hljs-keyword">@shared-utils</span><span class="hljs-string">": "</span><span class="hljs-attribute">workspace</span>:*<span class="hljs-string">",
    "</span><span class="hljs-keyword">@ui-components</span><span class="hljs-string">": "</span><span class="hljs-attribute">workspace</span>:*<span class="hljs-string">",
    "</span><span class="hljs-keyword">@api-types</span><span class="hljs-string">": "</span><span class="hljs-attribute">workspace</span>:*<span class="hljs-string">"
  }
}
</span></code></pre>
<p>è¿™æ ·ä¸€ä¸ªæœ€åŸºæœ¬çš„ monorepo ç»“æ„çš„é¡¹ç›®å°±æ­å»ºå¥½äº†ã€‚</p>
<p>å¦‚æœå­é¡¹ç›®ä½¿ç”¨çš„æ˜¯ vite ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®</p>
<p><strong>å¢åŠ  alias ï¼Œ</strong> <strong>åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œç»•è¿‡æ„å»ºäº§ç‰©ï¼Œç›´æ¥å¼•ç”¨æºç ï¼ˆ</strong> <code>src</code> <strong>ï¼‰ï¼Œå®ç°â€œçƒ­æ›´æ–° + å®æ—¶è°ƒè¯•â€å…¬å…±åŒ…ã€‚</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>
<span class="hljs-keyword">import</span> react <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-react'</span>
<span class="hljs-keyword">import</span> { resolve } <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;

<span class="hljs-comment">// https://vite.dev/config/</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(<span class="hljs-function">(<span class="hljs-params">{ mode }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> isDev = mode === <span class="hljs-string">'development'</span>;

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">react</span>()],
    <span class="hljs-attr">resolve</span>: {
      <span class="hljs-attr">alias</span>: isDev ? {
        <span class="hljs-string">'@ui-components'</span>: <span class="hljs-title function_">resolve</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">dirname</span>, <span class="hljs-string">'../../packages/ui-components/src'</span>), <span class="hljs-comment">// å¼€å‘ç¯å¢ƒä½¿ç”¨è½¯è¿æ¥</span>
      } : <span class="hljs-literal">undefined</span>,
    },
  }
})
</code></pre>
<h2 data-id="heading-14">ä¸ºåˆšæ­å»ºå¥½çš„ monorepo é¡¹ç›®å¢åŠ å·¥ç¨‹åŒ–é…ç½®</h2>
<p>ç°åœ¨æˆ‘ä»¬çš„é¡¹ç›®å·²ç»æ­å»ºå¥½äº†ï¼Œå¤§è‡´çš„ç›®å½•ç»“æ„ä¸º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cf0bd57aabe4cf3b7dcdfdcbad0f1a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGl26YeM5pyJ5YWJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765279528&amp;x-signature=TeAkQfwwV9HeMf2EL87S7X7r5J4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-15">ç¬¬ä¸€æ­¥ï¼šå…ˆå¢åŠ  TS é…ç½®</h3>
<p>æ ¹ç›®å½•åˆ›å»º tsconfig.json</p>
<p>å†…å®¹æ ¹æ®è‡ªå·±é¡¹ç›®çš„å…¬å…± ts é…ç½®è¿›è¡Œé…ç½®</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"tsBuildInfoFile"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./node_modules/.tmp/tsconfig.app.tsbuildinfo"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ES2022"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"useDefineForClassFields"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"lib"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"ES2022"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"DOM"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"DOM.Iterable"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ESNext"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"types"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"vite/client"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"skipLibCheck"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  
      <span class="hljs-comment">/* Bundler mode */</span>
      <span class="hljs-attr">"moduleResolution"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bundler"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"allowImportingTsExtensions"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"verbatimModuleSyntax"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"moduleDetection"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"force"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"noEmit"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"jsx"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"react-jsx"</span><span class="hljs-punctuation">,</span>
  
      <span class="hljs-comment">/* Linting */</span>
      <span class="hljs-attr">"strict"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"noUnusedLocals"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"noUnusedParameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"erasableSyntaxOnly"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"noFallthroughCasesInSwitch"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"noUncheckedSideEffectImports"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
  
</code></pre>
<p>å­é¡¹ç›® web-appã€mobile-app çš„ tsconifg.json</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"extends"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"../../tsconfig.json"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"files"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"include"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"src"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"vite.config.ts"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å®‰è£… typescript</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> -D -w typescript
</code></pre>
<p>æ ¹ç›®å½• package.json</p>
<pre><code class="hljs language-json" lang="json">
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"check-types"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsc -b"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é€šè¿‡å‘½ä»¤ pnpm check-types å°±å¯ä»¥æ£€æŸ¥æ•´ä¸ª monorepo é¡¹ç›®çš„ä»£ç </p>
<h3 data-id="heading-16">ç¬¬äºŒæ­¥ï¼šå¢åŠ  eslint é…ç½®</h3>
<p>å®‰è£… eslint çš„ä¾èµ–</p>
<pre><code class="hljs language-sql" lang="sql">pnpm <span class="hljs-keyword">add</span> <span class="hljs-operator">-</span>D <span class="hljs-operator">-</span>w <span class="hljs-variable">@eslint</span><span class="hljs-operator">/</span>js 
  <span class="hljs-variable">@typescript</span><span class="hljs-operator">-</span>eslint<span class="hljs-operator">/</span>eslint<span class="hljs-operator">-</span>plugin
  <span class="hljs-variable">@typescript</span><span class="hljs-operator">-</span>eslint<span class="hljs-operator">/</span>parser
  eslint
  eslint<span class="hljs-operator">-</span>config<span class="hljs-operator">-</span>prettier
  eslint<span class="hljs-operator">-</span>plugin<span class="hljs-operator">-</span>react<span class="hljs-operator">-</span>hooks
  eslint<span class="hljs-operator">-</span>plugin<span class="hljs-operator">-</span>react<span class="hljs-operator">-</span>refresh
</code></pre>
<p>æ ¹ç›®å½•åˆ›å»º eslint.config.cjs</p>
<pre><code class="hljs language-php" lang="php">
<span class="hljs-comment">// eslint.config.cjs</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">eslintJs</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">'@eslint/js'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">parser</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">'@typescript-eslint/parser'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">plugin</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">'@typescript-eslint/eslint-plugin'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">reactHooks</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">'eslint-plugin-react-hooks'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">reactRefresh</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">'eslint-plugin-react-refresh'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">eslintConfigPrettier</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">'eslint-config-prettier'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">globals</span> = <span class="hljs-keyword">require</span>(<span class="hljs-string">'globals'</span>);

<span class="hljs-comment">// æ‰‹åŠ¨æ„é€  @typescript-eslint/recommended çš„ç­‰æ•ˆé…ç½®</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">tsRecommended</span> = {
  files: [<span class="hljs-string">'**/*.ts'</span>, <span class="hljs-string">'**/*.tsx'</span>],
  languageOptions: {
    parser,
    parserOptions: {
      ecmaVersion: <span class="hljs-number">2022</span>,
      sourceType: <span class="hljs-string">'module'</span>
    }
  },
  plugins: {
    <span class="hljs-string">'@typescript-eslint'</span>: plugin
  },
  rules: {
    <span class="hljs-comment">// æ¥è‡ª @typescript-eslint/eslint-plugin çš„ recommended è§„åˆ™</span>
    <span class="hljs-string">'@typescript-eslint/no-unused-vars'</span>: <span class="hljs-string">'error'</span>,
    <span class="hljs-string">'@typescript-eslint/no-explicit-any'</span>: <span class="hljs-string">'warn'</span>,
    <span class="hljs-string">'@typescript-eslint/no-var-requires'</span>: <span class="hljs-string">'error'</span>,
    <span class="hljs-string">'@typescript-eslint/no-empty-function'</span>: <span class="hljs-string">'warn'</span>,
    <span class="hljs-comment">// å¯æ ¹æ®éœ€è¦æ‰©å±•æ›´å¤š...</span>
  }
};

<span class="hljs-comment">/** <span class="hljs-doctag">@type</span> {import('eslint').Linter.FlatConfig[]} */</span>
module.exports = [
  {
    ignores: [<span class="hljs-string">'**/node_modules/**'</span>, <span class="hljs-string">'**/dist/**'</span>, <span class="hljs-string">'**/build/**'</span>, <span class="hljs-string">'**/.next/**'</span>, <span class="hljs-string">'**/*.d.ts'</span>]
  },

  <span class="hljs-comment">// åŸºç¡€ JS è§„åˆ™</span>
  eslintJs.configs.recommended,

  <span class="hljs-comment">// TypeScript è§„åˆ™ï¼ˆæ‰‹åŠ¨å®šä¹‰ï¼‰</span>
  tsRecommended,

  <span class="hljs-comment">// React è§„åˆ™</span>
  {
    files: [<span class="hljs-string">'**/*.{js,jsx,ts,tsx}'</span>],
    languageOptions: {
      globals: {
        ...globals.browser
      }
    },
    plugins: {
      <span class="hljs-string">'react-hooks'</span>: reactHooks,
      <span class="hljs-string">'react-refresh'</span>: reactRefresh
    },
    rules: {
      <span class="hljs-string">'react-hooks/rules-of-hooks'</span>: <span class="hljs-string">'error'</span>,
      <span class="hljs-string">'react-hooks/exhaustive-deps'</span>: <span class="hljs-string">'warn'</span>,
      <span class="hljs-string">'react-refresh/only-export-components'</span>: <span class="hljs-string">'warn'</span>
    }
  },

  <span class="hljs-comment">// Prettier å…¼å®¹ï¼ˆæœ€åï¼‰</span>
  eslintConfigPrettier
];
</code></pre>
<p>æˆ‘çš„é¡¹ç›®ç”¨äº† globals ä¾èµ–åŒ… æ‰€ä»¥ä¹Ÿéœ€è¦å®‰è£…ä¸€ä¸‹</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> -D -w globals
</code></pre>
<ul>
<li><code>globals</code> åŒ…æä¾›äº†å¸¸è§ç¯å¢ƒçš„å…¨å±€å˜é‡åˆ—è¡¨ï¼Œä¾‹å¦‚ï¼š</li>
</ul>

<ul>
<li>
<ul>
<li><code>globals.browser</code> â†’ <code>window</code>, <code>document</code>, <code>fetch</code>...</li>
<li><code>globals.node</code> â†’ <code>process</code>, <code>require</code>, <code>__dirname</code>...</li>
<li><code>globals.jest</code> â†’ <code>describe</code>, <code>test</code>, <code>expect</code>...</li>
</ul>
</li>
</ul>
<p>ESLint éœ€è¦è¿™äº›ä¿¡æ¯æ¥åˆ¤æ–­æŸä¸ªå˜é‡æ˜¯â€œæœªå£°æ˜â€è¿˜æ˜¯â€œç¯å¢ƒå…¨å±€â€ã€‚</p>
<p>æ ¹ç›®å½•çš„ package.json ä¸­å¢åŠ  scripts</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"check-types"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsc -b"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint . --ext .js,.jsx,.ts,.tsx"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint:fix"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint . --ext .js,.jsx,.ts,.tsx --fix"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-17">ç¬¬ä¸‰æ­¥ï¼šå¢åŠ  git commit é’©å­å‡½æ•°</h3>
<p>å¦‚æœè¦ä½¿ç”¨ git é’©å­ï¼Œé‚£å°±è¦å®‰è£…ä¸€äº›ä¾èµ–</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> -D -w husky lint-staged
</code></pre>
<p>æ ¹ç›®å½•çš„ package.json ä¸­å¢åŠ é…ç½®</p>
<pre><code class="hljs language-json" lang="json">
<span class="hljs-attr">"husky"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"pre-commit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"lint-staged"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"lint-staged"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"*.{js,jsx,ts,tsx}"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"eslint --fix"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
</code></pre>
<p>å¦‚æœæƒ³è¦é’©å­è¿è¡Œèµ·æ¥è¿˜éœ€è¦åœ¨æ ¹ç›®å½•å¢åŠ .huskyæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸‹åˆ›å»º pre-commit æ–‡ä»¶ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤è¿›è¡Œåˆ›å»º</p>
<p>è¿™ä¸ªæ˜¯ husky å®˜æ–¹æä¾›çš„å‘½ä»¤</p>
<pre><code class="hljs language-bash" lang="bash">pnpm <span class="hljs-built_in">exec</span> husky install
</code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¸ä¼šåœ¨ .husky ä¸‹ç”Ÿæˆ pre-commit éœ€è¦è‡ªå·±æ‰‹åŠ¨åˆ›å»ºï¼Œå†…å®¹ä¸º</p>
<p>è¿™ä¸ªæ˜¯ husky v9ç‰ˆæœ¬ä»¥ä¸‹å†™æ³•</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env sh</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname -- <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span>/_/husky.sh"</span>

pnpm lint-staged
</code></pre>
<p>v9 ä»¥ä¸Šå†™æ³•</p>
<pre><code class="hljs">pnpm lint-staged
</code></pre>
<p>ç„¶åå°±å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œæµ‹è¯•äº†</p>
<pre><code class="hljs language-csharp" lang="csharp">git <span class="hljs-keyword">init</span> 

git <span class="hljs-keyword">add</span> .
git commit -m <span class="hljs-string">"æ”¹åŠ¨çš„msg"</span>
</code></pre>
<p>å½“å‡ºç°è¿™ç§å°±ç®—æˆåŠŸäº†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84cde8d3c75a485f852f2cb789859d01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGl26YeM5pyJ5YWJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765279528&amp;x-signature=67VBHTNemLp%2B7spMxPxsfW9P7vE%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯´è¯´ Map å’Œ Set çš„åŒºåˆ«åŠå®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7579063781072551990</link>    <guid>https://juejin.cn/post/7579063781072551990</guid>    <pubDate>2025-12-02T12:59:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579063781072551990" data-draft-id="7579062563326394409" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯´è¯´ Map å’Œ Set çš„åŒºåˆ«åŠå®é™…åº”ç”¨"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-02T12:59:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å£®å£®çˆ±åƒç§‹åˆ€é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/136758682984871"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯´è¯´ Map å’Œ Set çš„åŒºåˆ«åŠå®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/136758682984871/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å£®å£®çˆ±åƒç§‹åˆ€é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T12:59:33.000Z" title="Tue Dec 02 2025 12:59:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>Map</code> å’Œ <code>Set</code> æ˜¯ JavaScript ä¸­ä¸¤ç§å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œå®ƒä»¬éƒ½æ˜¯ <strong>ES6 å¼•å…¥çš„</strong>ï¼Œç›¸æ¯”äºæ™®é€šçš„å¯¹è±¡ï¼ˆ<code>Object</code>ï¼‰å’Œæ•°ç»„ï¼ˆ<code>Array</code>ï¼‰ï¼Œ<code>Map</code> å’Œ <code>Set</code> æä¾›äº†æ›´å¤šçš„çµæ´»æ€§å’ŒåŠŸèƒ½ã€‚</p>
<h3 data-id="heading-0">1. <strong><code>Map</code> å’Œ <code>Set</code> çš„å®šä¹‰</strong></h3>
<ul>
<li>
<p><strong><code>Map</code></strong>ï¼šæ˜¯ä¸€ç§é”®å€¼å¯¹ï¼ˆkey-valueï¼‰çš„é›†åˆï¼Œç±»ä¼¼äºå¯¹è±¡ï¼ˆ<code>Object</code>ï¼‰ï¼Œä½†æ˜¯å®ƒçš„é”®ï¼ˆkeyï¼‰å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å€¼ï¼Œè€Œä¸ä»…ä»…æ˜¯å­—ç¬¦ä¸²æˆ–ç¬¦å·ã€‚</p>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>é”®å€¼å¯¹æ•°æ®ç»“æ„ã€‚</li>
<li>é”®ï¼ˆkeyï¼‰å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼ˆå¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ç­‰ï¼‰ã€‚</li>
<li>ä¿è¯å…ƒç´ æŒ‰æ’å…¥é¡ºåºæ’åºã€‚</li>
<li>å¯ä»¥ä½¿ç”¨ <code>.set(key, value)</code> è®¾ç½®é”®å€¼å¯¹ï¼Œä½¿ç”¨ <code>.get(key)</code> è·å–å€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>Set</code></strong>ï¼šæ˜¯ä¸€ä¸ªé›†åˆï¼ˆsetï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„ã€‚å¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å€¼ï¼Œä½†ä¸å…è®¸é‡å¤çš„å…ƒç´ ã€‚</p>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å€¼çš„é›†åˆï¼ˆæ²¡æœ‰é‡å¤çš„å€¼ï¼‰ã€‚</li>
<li>å­˜å‚¨å”¯ä¸€å€¼ã€‚</li>
<li>ä¿è¯å…ƒç´ æŒ‰æ’å…¥é¡ºåºæ’åºã€‚</li>
<li>å¯ä»¥ä½¿ç”¨ <code>.add(value)</code> æ·»åŠ å…ƒç´ ï¼Œä½¿ç”¨ <code>.has(value)</code> æ£€æŸ¥æ˜¯å¦åŒ…å«å…ƒç´ ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-1">2. <strong><code>Map</code> å’Œ <code>Set</code> çš„åŒºåˆ«</strong></h3>













































<table><thead><tr><th>ç‰¹æ€§</th><th><code>Map</code></th><th><code>Set</code></th></tr></thead><tbody><tr><td><strong>ç»“æ„</strong></td><td>é”®å€¼å¯¹ï¼ˆkey-value pairsï¼‰</td><td>å”¯ä¸€çš„å€¼ï¼ˆunique valuesï¼‰</td></tr><tr><td><strong>é”®çš„ç±»å‹</strong></td><td>é”®å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ï¼šå¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ç­‰ï¼‰</td><td>åªèƒ½å­˜å‚¨å”¯ä¸€çš„å€¼ï¼Œå€¼å¯ä»¥æ˜¯ä»»ä½•ç±»å‹</td></tr><tr><td><strong>é‡å¤å€¼</strong></td><td>å¯ä»¥å­˜å‚¨ç›¸åŒçš„å€¼ï¼Œä½†å¿…é¡»æœ‰ä¸åŒçš„é”®</td><td>ä¸å…è®¸å­˜å‚¨é‡å¤çš„å€¼</td></tr><tr><td><strong>è¿­ä»£é¡ºåº</strong></td><td>æŒ‰ç…§æ’å…¥é¡ºåºè¿­ä»£å…ƒç´ </td><td>æŒ‰ç…§æ’å…¥é¡ºåºè¿­ä»£å…ƒç´ </td></tr><tr><td><strong>å­˜å‚¨æ–¹å¼</strong></td><td>é”®å€¼å¯¹ï¼Œæ˜ å°„é”®åˆ°å€¼</td><td>å­˜å‚¨å•ä¸ªå”¯ä¸€çš„å€¼</td></tr><tr><td><strong>å¸¸ç”¨æ–¹æ³•</strong></td><td><code>.set(key, value)</code>, <code>.get(key)</code>, <code>.has(key)</code>, <code>.delete(key)</code>, <code>.clear()</code></td><td><code>.add(value)</code>, <code>.has(value)</code>, <code>.delete(value)</code>, <code>.clear()</code></td></tr><tr><td><strong>é”®çš„å”¯ä¸€æ€§</strong></td><td>é”®å¿…é¡»å”¯ä¸€</td><td>å€¼å¿…é¡»å”¯ä¸€</td></tr></tbody></table>
<h3 data-id="heading-2">3. <strong>å®é™…åº”ç”¨åœºæ™¯</strong></h3>
<h4 data-id="heading-3"><strong><code>Map</code> çš„åº”ç”¨åœºæ™¯ï¼š</strong></h4>
<ul>
<li>
<p><strong>å­˜å‚¨é”®å€¼å¯¹</strong>ï¼šå¦‚æœéœ€è¦å°†æ•°æ®å­˜å‚¨ä¸ºä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨ <code>Map</code>ã€‚</p>
<ul>
<li>ç¤ºä¾‹ï¼šå­˜å‚¨ç”¨æˆ·çš„ ID å’Œä¿¡æ¯ï¼Œæˆ–å­˜å‚¨äº§å“çš„ ID å’Œä»·æ ¼ç­‰ã€‚</li>
</ul>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">const</span> <span class="hljs-built_in">map</span> = new Map();
<span class="hljs-built_in">map</span>.<span class="hljs-built_in">set</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'apple'</span>);
<span class="hljs-built_in">map</span>.<span class="hljs-built_in">set</span>(<span class="hljs-string">'name'</span>, <span class="hljs-string">'John'</span>);
console.<span class="hljs-built_in">log</span>(<span class="hljs-built_in">map</span>.get(<span class="hljs-number">1</span>)); <span class="hljs-comment">// 'apple'</span>
console.<span class="hljs-built_in">log</span>(<span class="hljs-built_in">map</span>.get(<span class="hljs-string">'name'</span>)); <span class="hljs-comment">// 'John'</span>
</code></pre>
</li>
<li>
<p><strong>éœ€è¦ä»»æ„ç±»å‹ä½œä¸ºé”®</strong>ï¼šå½“éœ€è¦å°†å¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ç­‰ä½œä¸ºé”®æ—¶ï¼Œ<code>Map</code> æ¯”å¯¹è±¡æ›´æœ‰ä¼˜åŠ¿ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> objKey = { id: <span class="hljs-number">1</span> };
<span class="hljs-type">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
map.<span class="hljs-built_in">set</span>(objKey, <span class="hljs-string">'User Info'</span>);
console.<span class="hljs-built_in">log</span>(map.<span class="hljs-built_in">get</span>(objKey)); <span class="hljs-comment">// 'User Info'</span>
</code></pre>
</li>
<li>
<p><strong>ç»´æŠ¤æ’å…¥é¡ºåº</strong>ï¼š<code>Map</code> ä¿è¯é”®å€¼å¯¹æŒ‰æ’å…¥é¡ºåºæ’åºï¼Œé€‚åˆéœ€è¦æŒ‰ç…§æ’å…¥é¡ºåºéå†çš„åœºæ™¯ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">const</span> <span class="hljs-built_in">map</span> = new Map();
<span class="hljs-built_in">map</span>.<span class="hljs-built_in">set</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'two'</span>);
<span class="hljs-built_in">map</span>.<span class="hljs-built_in">set</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'one'</span>);
<span class="hljs-built_in">map</span>.<span class="hljs-built_in">set</span>(<span class="hljs-number">3</span>, <span class="hljs-string">'three'</span>);

<span class="hljs-keyword">for</span> (let [key, value] of <span class="hljs-built_in">map</span>) {
  console.<span class="hljs-built_in">log</span>(key, value);
}
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// 2 'two'</span>
<span class="hljs-comment">// 1 'one'</span>
<span class="hljs-comment">// 3 'three'</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-4"><strong><code>Set</code> çš„åº”ç”¨åœºæ™¯ï¼š</strong></h4>
<ul>
<li>
<p><strong>å­˜å‚¨å”¯ä¸€å€¼</strong>ï¼šå¦‚æœéœ€è¦å­˜å‚¨æ²¡æœ‰é‡å¤çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>Set</code>ã€‚</p>
<ul>
<li>ç¤ºä¾‹ï¼šå»é‡æ•°ç»„ä¸­çš„å…ƒç´ ã€‚</li>
</ul>
<pre><code class="hljs language-vbscript" lang="vbscript"><span class="hljs-keyword">const</span> <span class="hljs-keyword">set</span> = <span class="hljs-keyword">new</span> <span class="hljs-keyword">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>]);
console.<span class="hljs-built_in">log</span>(<span class="hljs-keyword">set</span>); // <span class="hljs-keyword">Set</span> { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> }
</code></pre>
</li>
<li>
<p><strong>æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨</strong>ï¼š<code>Set</code> æä¾›äº† <code>.has(value)</code> æ–¹æ³•ï¼Œå¯ä»¥é«˜æ•ˆåœ°æ£€æŸ¥æŸä¸ªå…ƒç´ æ˜¯å¦å·²ç»å­˜åœ¨ã€‚</p>
<pre><code class="hljs language-vbscript" lang="vbscript"><span class="hljs-keyword">const</span> <span class="hljs-keyword">set</span> = <span class="hljs-keyword">new</span> <span class="hljs-keyword">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);
console.<span class="hljs-built_in">log</span>(<span class="hljs-keyword">set</span>.has(<span class="hljs-number">2</span>)); // <span class="hljs-literal">true</span>
console.<span class="hljs-built_in">log</span>(<span class="hljs-keyword">set</span>.has(<span class="hljs-number">4</span>)); // <span class="hljs-literal">false</span>
</code></pre>
</li>
<li>
<p><strong>é›†åˆè¿ç®—</strong>ï¼š<code>Set</code> å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åšé›†åˆè¿ç®—ï¼Œä¾‹å¦‚äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰ã€‚é€šè¿‡ <code>Set</code> å’Œ <code>Map</code> å¯ä»¥è½»æ¾å®ç°ä¸€äº›æ•°å­¦é›†åˆæ“ä½œã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¹¶é›†</span>
<span class="hljs-keyword">const</span> setA = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);
<span class="hljs-keyword">const</span> setB = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);
<span class="hljs-keyword">const</span> union = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...setA, ...setB]);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(union); <span class="hljs-comment">// Set { 1, 2, 3, 4, 5 }</span>
</code></pre>
</li>
<li>
<p><strong>å¿«é€ŸæŸ¥æ‰¾</strong>ï¼šç”±äº <code>Set</code> å†…éƒ¨æ˜¯åŸºäºå“ˆå¸Œè¡¨å®ç°çš„ï¼Œå› æ­¤å®ƒçš„æŸ¥æ‰¾æ•ˆç‡é«˜äºæ™®é€šçš„æ•°ç»„ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦é¢‘ç¹æŸ¥æ‰¾æŸä¸ªå€¼æ—¶ã€‚</p>
<pre><code class="hljs language-vbscript" lang="vbscript"><span class="hljs-keyword">const</span> <span class="hljs-keyword">set</span> = <span class="hljs-keyword">new</span> <span class="hljs-keyword">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);
console.<span class="hljs-built_in">log</span>(<span class="hljs-keyword">set</span>.has(<span class="hljs-number">3</span>)); // <span class="hljs-literal">true</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-5">4. <strong>æ€§èƒ½å¯¹æ¯”</strong></h3>
<ul>
<li>
<p><strong><code>Map</code></strong> å’Œ <strong><code>Set</code></strong> éƒ½æ˜¯åŸºäºå“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦å‡ä¸º <strong>O(1)</strong> ï¼Œå› æ­¤åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒä»¬çš„æ€§èƒ½ä¼˜äºåŸºäºæ•°ç»„çš„æ“ä½œï¼ˆå¦‚ <code>.indexOf()</code>ï¼‰ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
console.<span class="hljs-built_in">log</span>(arr.<span class="hljs-built_in">indexOf</span>(<span class="hljs-number">3</span>)); <span class="hljs-comment">// O(n)</span>

<span class="hljs-type">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);
console.<span class="hljs-built_in">log</span>(set.<span class="hljs-built_in">has</span>(<span class="hljs-number">3</span>)); <span class="hljs-comment">// O(1)</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-6">æ€»ç»“ï¼š</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th><code>Map</code></th><th><code>Set</code></th></tr></thead><tbody><tr><td><strong>å­˜å‚¨ç±»å‹</strong></td><td>é”®å€¼å¯¹ï¼ˆkey-valueï¼‰</td><td>å”¯ä¸€çš„å€¼ï¼ˆunique valuesï¼‰</td></tr><tr><td><strong>é”®çš„ç±»å‹</strong></td><td>é”®å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç±»å‹ï¼ˆå¯¹è±¡ã€å‡½æ•°ã€æ•°ç»„ç­‰ï¼‰</td><td>å­˜å‚¨çš„å€¼å¯ä»¥æ˜¯ä»»ä½•ç±»å‹</td></tr><tr><td><strong>é‡å¤æ€§</strong></td><td>é”®å¿…é¡»å”¯ä¸€ï¼Œå€¼å¯ä»¥é‡å¤</td><td>ä¸å…è®¸å€¼é‡å¤</td></tr><tr><td><strong>å¸¸è§ç”¨é€”</strong></td><td>éœ€è¦ç»´æŠ¤é”®å€¼å¯¹æ•°æ®ï¼ˆä¾‹å¦‚ ID å’Œä¿¡æ¯çš„æ˜ å°„ï¼‰</td><td>éœ€è¦ä¿è¯å”¯ä¸€æ€§çš„é›†åˆï¼ˆå¦‚å»é‡ã€å¿«é€ŸæŸ¥æ‰¾ï¼‰</td></tr></tbody></table>
<ul>
<li><strong><code>Map</code></strong> æ›´é€‚åˆç”¨äºéœ€è¦é”®å€¼å¯¹çš„åœºæ™¯ï¼ˆä¾‹å¦‚å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€é…ç½®é¡¹ã€ç¼“å­˜æ•°æ®ç­‰ï¼‰ï¼Œå¹¶ä¸”éœ€è¦é”®ä¸ºä»»æ„ç±»å‹æ—¶ã€‚</li>
<li><strong><code>Set</code></strong> æ›´é€‚åˆç”¨äºå­˜å‚¨å”¯ä¸€çš„å€¼ï¼Œå°¤å…¶æ˜¯å»é‡ã€é›†åˆè¿ç®—å’Œé«˜æ•ˆæŸ¥æ‰¾çš„åœºæ™¯ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[tiptiap3å¦‚ä½•å®ç°ç¼–è¾‘å™¨å†…éƒ¨åµŒå¥—å¤šä¸ªå¯Œæ–‡æœ¬ç¼–è¾‘å™¨]]></title>    <link>https://juejin.cn/post/7578922565210832923</link>    <guid>https://juejin.cn/post/7578922565210832923</guid>    <pubDate>2025-12-02T13:23:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578922565210832923" data-draft-id="7579096485355683890" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" tiptiap3å¦‚ä½•å®ç°ç¼–è¾‘å™¨å†…éƒ¨åµŒå¥—å¤šä¸ªå¯Œæ–‡æœ¬ç¼–è¾‘å™¨"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,å¼€æº"/> <meta itemprop="datePublished" content="2025-12-02T13:23:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç–¯ä¸çš®"/> <meta itemprop="url" content="https://juejin.cn/user/576609953014424"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             tiptiap3å¦‚ä½•å®ç°ç¼–è¾‘å™¨å†…éƒ¨åµŒå¥—å¤šä¸ªå¯Œæ–‡æœ¬ç¼–è¾‘å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/576609953014424/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç–¯ä¸çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T13:23:39.000Z" title="Tue Dec 02 2025 13:23:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ ¹æ®æ–‡æ¡£<a href="https://link.juejin.cn?target=https%3A%2F%2Ftiptap.dev%2Fdocs%2Feditor%2Fextensions%2Fcustom-extensions%2Fnode-views%2Fjavascript%23adding-a-content-editable" target="_blank" title="https://tiptap.dev/docs/editor/extensions/custom-extensions/node-views/javascript#adding-a-content-editable" ref="nofollow noopener noreferrer">Adding a content editable</a>ï¼Œå¦‚æœå¸Œæœ›åœ¨ç¼–è¾‘å™¨ä¸­å†åµŒå¥—ä¸€ä¸ªå¯Œæ–‡æœ¬ç¼–è¾‘å°±ä¼šä½¿ç”¨åˆ°è¿™ä¸ªé…ç½®ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">addNodeView</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// Create a container for the node view</span>
  <span class="hljs-keyword">const</span> dom = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>)

  <span class="hljs-comment">// Give other elements containing text `contentEditable = false`</span>
  <span class="hljs-keyword">const</span> label = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>)
  label.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'Node view'</span>
  label.<span class="hljs-property">contentEditable</span> = <span class="hljs-literal">false</span>

  <span class="hljs-comment">// Create a container for the content</span>
  <span class="hljs-keyword">const</span> content = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>)

  <span class="hljs-comment">// Append all elements to the node view container</span>
  dom.<span class="hljs-title function_">append</span>(label, content)

  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// Pass the node view container â€¦</span>
    dom,
    <span class="hljs-comment">// â€¦ and the content container:</span>
    <span class="hljs-attr">contentDOM</span>: content,
  }
}
</code></pre>
<p>å¦‚æœä½¿ç”¨äº†æ¡†æ¶å°±ä¼šæ˜¯ä¸€ä¸ª<code>NodeViewWrapper</code>åŒ…è£¹ä¸€ä¸ª<code>NodeViewContent</code>ï¼Œæ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œåœ¨å®˜æ–¹çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fueberdosis%2Ftiptap%2Fdiscussions%2F2106" target="_blank" title="https://github.com/ueberdosis/tiptap/discussions/2106" ref="nofollow noopener noreferrer">Multiple NodeViewContent Â· ueberdosis/tiptap Â· Discussion #2106</a>ä¹Ÿæåˆ°äº†è¿™ä¸ªäº‹æƒ…</p>
<p>æ˜¾è€Œæ˜“è§çš„æ˜¯ä¸€ä¸ª<code>NodeViewWrapper</code>å¯¹åº”ä¸€ä¸ª<code>æ‰©å±•</code>ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬éœ€è¦ç»™ä¸€ä¸ª<code>æ‰©å±•</code>ä¸­æ·»åŠ å¤šä¸ªå¯Œæ–‡æœ¬ç¼–è¾‘æ—¶ï¼Œå”¯ä¸€çš„æ–¹æ¡ˆå°±æ˜¯<code>æ‰©å±•</code>ä¸­åµŒå¥—<code>æ‰©å±•</code>ã€‚å°±æ¯”å¦‚è¯´å®˜æ–¹çš„<code>@tiptap/extension-table</code>è¡¨æ ¼æ‰©å±•ã€‚</p>
<p>åœ¨æˆ‘ç»†ç»†è¯„å‘³äº†å®˜æ–¹çš„è¡¨æ ¼æ‰©å±•åï¼ŒæˆåŠŸå®ç°äº†æˆ‘ä»¬è‡ªå·±çš„ä¸¤æ å¸ƒå±€:<br/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/713132721b474eb5864b6659801d407b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av5LiN55qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765286618&amp;x-signature=T%2B%2FFJnBmqRwSt9dXsbsJjAZ4eWc%3D" alt="" loading="lazy"/></p>
<p>å¹¶ä¸”å…·å¤‡ä¸€ä¸ªæ­£å¸¸çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨çš„å…¨éƒ¨åŠŸèƒ½ï¼</p>
<p>å·¦è¾¹çš„æˆ‘ä»¬ç§°ä¸º<strong>ç»„ä»¶A</strong>ï¼Œå³è¾¹çš„æˆ‘ä»¬ç§°ä¸º<strong>ç»„ä»¶Bï¼ˆå…¶å®å®Œå…¨å¯ä»¥ä¸ç”¨æ‹†åˆ†çš„ï¼Œå› ä¸ºå†…éƒ¨ä»£ç å®Œå…¨ä¸€æ ·ï¼‰</strong></p>
<p>ç°åœ¨æˆ‘ä»¬å®ç°å…¶ä¸­ä¸€ä¸ªç»„ä»¶ï¼Œæ ¹æ®æ–‡æ¡£æ‰€ç¤ºï¼š</p>
<p>å¦‚æœæ˜¯åœ¨vueä¸­éœ€è¦å¦‚ä¸‹ä»£ç ï¼Œ<strong>ç»„ä»¶A</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { mergeAttributes, <span class="hljs-title class_">Node</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tiptap/core'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">VueNodeViewRenderer</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tiptap/vue-3'</span>

<span class="hljs-keyword">import</span> <span class="hljs-title class_">TwoEditorLayoutTemplateA</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./TwoEditorLayoutTemplateA.vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Node</span>.<span class="hljs-title function_">create</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">"twoEditorLayoutTemplateA"</span>,
      <span class="hljs-attr">content</span>: <span class="hljs-string">"inline*"</span>,
      <span class="hljs-attr">atom</span>: <span class="hljs-literal">false</span>,

      <span class="hljs-title function_">parseHTML</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> [
          {
            <span class="hljs-attr">tag</span>: <span class="hljs-string">"twoEditorLayoutTemplateA"</span>,
          },
        ];
      },
      <span class="hljs-title function_">renderHTML</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> [<span class="hljs-string">"twoEditorLayoutTemplateA"</span>, {}, <span class="hljs-number">0</span>];
      },
      <span class="hljs-title function_">addNodeView</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">VueNodeViewRenderer</span>(<span class="hljs-title class_">TwoEditorLayoutTemplateA</span>);
      },
    }),
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">node-view-wrapper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"editor-a"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"editor-a"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">node-view-content</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content is-editable"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">node-view-wrapper</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">NodeViewWrapper</span>, nodeViewProps, <span class="hljs-title class_">NodeViewContent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tiptap/vue-3"</span>;

<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>(nodeViewProps);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.editor-a</span> {
  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">240px</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>;
  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span>;
  <span class="hljs-attribute">box-sizing</span>: border-box;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
}

<span class="hljs-selector-class">.editor-a</span> <span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100%</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>

</code></pre>
<p><strong>ç»„ä»¶B</strong>ä¸º</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { mergeAttributes, <span class="hljs-title class_">Node</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tiptap/core'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">VueNodeViewRenderer</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tiptap/vue-3'</span>

<span class="hljs-keyword">import</span> <span class="hljs-title class_">TwoEditorLayoutTemplateB</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./TwoEditorLayoutTemplateB.vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Node</span>.<span class="hljs-title function_">create</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">"twoEditorLayoutTemplateB"</span>,
      <span class="hljs-attr">content</span>: <span class="hljs-string">"inline*"</span>,
      <span class="hljs-attr">atom</span>: <span class="hljs-literal">false</span>,

      <span class="hljs-title function_">parseHTML</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> [
          {
            <span class="hljs-attr">tag</span>: <span class="hljs-string">"twoEditorLayoutTemplateB"</span>,
          },
        ];
      },
      <span class="hljs-title function_">renderHTML</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> [<span class="hljs-string">"twoEditorLayoutTemplateB"</span>, {}, <span class="hljs-number">0</span>];
      },
      <span class="hljs-title function_">addNodeView</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">VueNodeViewRenderer</span>(<span class="hljs-title class_">TwoEditorLayoutTemplateB</span>);
      },
    }),
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">node-view-wrapper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"editor-b"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"editor-b"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">node-view-content</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content is-editable"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">node-view-wrapper</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">NodeViewWrapper</span>, nodeViewProps, <span class="hljs-title class_">NodeViewContent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tiptap/vue-3"</span>;

<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>(nodeViewProps);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.editor-b</span> {
  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">240px</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span>;
  <span class="hljs-attribute">box-sizing</span>: border-box;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
}

<span class="hljs-selector-class">.editor-b</span> <span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100%</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>

</code></pre>
<p>æ˜¾è€Œæ˜“è§çš„æ˜¯ï¼Œè¿™ä¸ªç»„ä»¶BåŸºæœ¬å’Œç»„ä»¶Aå°±æ˜¯ä¸€æ ·çš„ä»£ç ï¼Œä¹Ÿå°±æ ·å¼ä¸å¤ªä¸€æ ·</p>
<p>ç„¶åå°±éœ€è¦æŠŠè¿™ä¸ªä¸¤ä¸ªæ‰©å±•æ³¨å†Œåˆ°å…¨å±€ä¸­å»</p>
<pre><code class="hljs language-typescript" lang="typescript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">editor-content</span> <span class="hljs-attr">:editor</span>=<span class="hljs-string">"editor"</span> /&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> <span class="hljs-title class_">StarterKit</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@tiptap/starter-kit'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Editor</span>, <span class="hljs-title class_">EditorContent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tiptap/vue-3'</span>

<span class="hljs-keyword">import</span> twoEditorLayoutTemplateA <span class="hljs-keyword">from</span> <span class="hljs-string">'./twoEditorLayoutTemplateA.js'</span>
<span class="hljs-keyword">import</span> twoEditorLayoutTemplateB <span class="hljs-keyword">from</span> <span class="hljs-string">'./twoEditorLayoutTemplateB.js'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: {
    <span class="hljs-title class_">EditorContent</span>,
  },

  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">editor</span>: <span class="hljs-literal">null</span>,
    }
  },

  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">editor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Editor</span>({
      <span class="hljs-attr">extensions</span>: [<span class="hljs-title class_">StarterKit</span>, <span class="hljs-title class_">VueComponent</span>],
      <span class="hljs-attr">content</span>: <span class="hljs-string">``</span>,
    })
  },

  <span class="hljs-title function_">beforeUnmount</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">editor</span>.<span class="hljs-title function_">destroy</span>()
  },
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span>&gt;</span><span class="css">
<span class="hljs-comment">/* Basic editor styles */</span>
<span class="hljs-selector-class">.tiptap</span> {
  <span class="hljs-selector-pseudo">:first</span>-child {
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">0</span>;
  }

  <span class="hljs-comment">/* List styles */</span>
  <span class="hljs-selector-tag">ul</span>,
  <span class="hljs-selector-tag">ol</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">1rem</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">1.25rem</span> <span class="hljs-number">1rem</span> <span class="hljs-number">1.25rem</span> <span class="hljs-number">0.4rem</span>;

    <span class="hljs-selector-tag">li</span> <span class="hljs-selector-tag">p</span> {
      <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">0.25em</span>;
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0.25em</span>;
    }
  }

  <span class="hljs-comment">/* Heading styles */</span>
  <span class="hljs-selector-tag">h1</span>,
  <span class="hljs-selector-tag">h2</span>,
  <span class="hljs-selector-tag">h3</span>,
  <span class="hljs-selector-tag">h4</span>,
  <span class="hljs-selector-tag">h5</span>,
  <span class="hljs-selector-tag">h6</span> {
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.1</span>;
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">2.5rem</span>;
    text-wrap: pretty;
  }

  <span class="hljs-selector-tag">h1</span>,
  <span class="hljs-selector-tag">h2</span> {
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">3.5rem</span>;
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">1.5rem</span>;
  }

  <span class="hljs-selector-tag">h1</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.4rem</span>;
  }

  <span class="hljs-selector-tag">h2</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>;
  }

  <span class="hljs-selector-tag">h3</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.1rem</span>;
  }

  <span class="hljs-selector-tag">h4</span>,
  <span class="hljs-selector-tag">h5</span>,
  <span class="hljs-selector-tag">h6</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1rem</span>;
  }

  <span class="hljs-comment">/* Code and preformatted text styles */</span>
  <span class="hljs-selector-tag">code</span> {
    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--purple-light);
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0.4rem</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--black);
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.85rem</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0.25em</span> <span class="hljs-number">0.3em</span>;
  }

  pre {
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">var</span>(--black);
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0.5rem</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--white);
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'JetBrainsMono'</span>, monospace;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">1.5rem</span> <span class="hljs-number">0</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0.75rem</span> <span class="hljs-number">1rem</span>;

    <span class="hljs-selector-tag">code</span> {
      <span class="hljs-attribute">background</span>: none;
      <span class="hljs-attribute">color</span>: inherit;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.8rem</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
    }
  }

  <span class="hljs-selector-tag">blockquote</span> {
    <span class="hljs-attribute">border-left</span>: <span class="hljs-number">3px</span> solid <span class="hljs-built_in">var</span>(--gray-<span class="hljs-number">3</span>);
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">1.5rem</span> <span class="hljs-number">0</span>;
    <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">1rem</span>;
  }

  hr {
    <span class="hljs-attribute">border</span>: none;
    <span class="hljs-attribute">border-top</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">var</span>(--gray-<span class="hljs-number">2</span>);
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">2rem</span> <span class="hljs-number">0</span>;
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<p>ä½†æ˜¯ç°åœ¨è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºä»–ä»¬è¿˜æ˜¯ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰ä¸€ä¸ªå¤§çš„æ‰©å±•è¿›è¡Œç»Ÿç­¹ï¼Œæˆ‘ä»¬ç°åœ¨å†å†™ä¸€ä¸ªå¤§çš„æ‰©å±•æ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½</p>
<pre><code class="hljs language-typescript" lang="typescript"> <span class="hljs-comment">// ä¸¤æ å¸ƒå±€æ‰©å±•çˆ¶èŠ‚ç‚¹(vueç»„ä»¶ç‰ˆæœ¬)</span>
    <span class="hljs-title class_">Node</span>.<span class="hljs-title function_">create</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">"twoEditorLayoutTemplate"</span>,
      <span class="hljs-attr">group</span>: <span class="hljs-string">"block"</span>,
      <span class="hljs-attr">atom</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-comment">// contentä¸ºä¸Šé¢ä¸¤ä¸ªæ‰©å±•çš„name</span>
      <span class="hljs-attr">content</span>: <span class="hljs-string">"twoEditorLayoutTemplateA twoEditorLayoutTemplateB"</span>,

      <span class="hljs-title function_">parseHTML</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> [
          {
            <span class="hljs-attr">tag</span>: <span class="hljs-string">"div[data-two-editor-layout-template]"</span>,
          },
        ];
      },

      <span class="hljs-title function_">renderHTML</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> [<span class="hljs-string">"div"</span>, { <span class="hljs-string">"data-two-editor-layout-template"</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">class</span>: <span class="hljs-string">"two-editor-layout"</span> }, <span class="hljs-number">0</span>];
      },
      <span class="hljs-title function_">addCommands</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">insertTwoEditorLayoutTemplate</span>:
            <span class="hljs-function">() =&gt;</span>
            <span class="hljs-function">(<span class="hljs-params">{ commands }: CommandProps</span>) =&gt;</span> {
              commands.<span class="hljs-title function_">insertContent</span>({
                <span class="hljs-attr">type</span>: <span class="hljs-string">"twoEditorLayoutTemplate"</span>,
                <span class="hljs-attr">content</span>: [
                  {
                    <span class="hljs-attr">type</span>: <span class="hljs-string">"twoEditorLayoutTemplateA"</span>,
                  },
                  {
                    <span class="hljs-attr">type</span>: <span class="hljs-string">"twoEditorLayoutTemplateB"</span>,
                  },
                ],
              });
              <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            },
        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">RawCommands</span>&gt;;
      },
    }),
</code></pre>
<p>ç„¶åï¼Œæˆ‘ä»¬æœ€ååœ¨<code>addCommands</code>ä¸­æ³¨å†Œçš„<code>insertTwoEditorLayoutTemplate</code>å‡½æ•°ä½œä¸ºåœ¨ç¼–è¾‘å™¨ä¸­æ’å…¥çš„æœ€ç»ˆå‡½æ•°ï¼Œå½“è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶å°±å¯ä»¥æŠŠè¿™æœ€ç»ˆçš„å¤§çš„æ‰©å±•ç»™å†™åˆ°ç¼–è¾‘å™¨ä¸­å»äº†</p>
<p>è¿™å°±æ˜¯æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆäº†ï¼Œç¬”è€…ä¹Ÿæ˜¯ç¿»é˜…äº†tiptap3çš„å„ç§æºç å’Œå®ç°ï¼Œä»¥åŠæ˜é‡‘ä¸Šå¤§é‡çš„æ–‡ç« ä»¥åŠå®˜æ–¹çš„issueså’Œdiscussionsåæ‰çµå…‰ä¸€é—ªï¼Œå®Œæˆäº†æœ€åçš„å®ç°ï½</p>
<p>æ¨èå¥½æ–‡ï¼š</p>
<p><a href="https://juejin.cn/post/7528753539737600026" target="_blank" title="https://juejin.cn/post/7528753539737600026">Tiptap 3.0 æ­£å¼å‘å¸ƒï¼ä½ å¿…é¡»çŸ¥é“çš„ 20 ä¸ªé‡å¤§å˜åŒ– ğŸš€ğŸš€ğŸš€</a></p>
<p><a href="https://juejin.cn/post/7573592952243535924" target="_blank" title="https://juejin.cn/post/7573592952243535924">Tiptap æ·±åº¦æ•™ç¨‹ï¼ˆå››ï¼‰ï¼šç»ˆæå®šåˆ¶ - ä»é›¶åˆ›å»ºä½ çš„ä¸“å±æ‰©å±•</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fueberdosis%2Ftiptap%2Fdiscussions%2F7286" target="_blank" title="https://github.com/ueberdosis/tiptap/discussions/7286" ref="nofollow noopener noreferrer">Multiple NodeViewContent in a Single NodeViewWrapper Â· ueberdosis/tiptap Â· Discussion #7286</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript å®ç°æ·±æ‹·è´]]></title>    <link>https://juejin.cn/post/7579101504289357878</link>    <guid>https://juejin.cn/post/7579101504289357878</guid>    <pubDate>2025-12-02T13:37:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579101504289357878" data-draft-id="7579066828178931748" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript å®ç°æ·±æ‹·è´"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-02T13:37:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jingyou"/> <meta itemprop="url" content="https://juejin.cn/user/3167069035309015"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript å®ç°æ·±æ‹·è´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3167069035309015/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jingyou
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T13:37:40.000Z" title="Tue Dec 02 2025 13:37:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>JavaScript çš„Â <code>deepClone</code>ï¼ˆæ·±æ‹·è´ï¼‰éœ€è¦å¤„ç†Â <strong>åŸºæœ¬ç±»å‹ã€å¼•ç”¨ç±»å‹ï¼ˆå¯¹è±¡ã€æ•°ç»„ï¼‰ã€ç‰¹æ®Šå¯¹è±¡ï¼ˆæ—¥æœŸã€æ­£åˆ™ã€å‡½æ•°ï¼‰</strong> Â ç­‰åœºæ™¯ï¼Œè¿˜è¦é¿å…Â <strong>å¾ªç¯å¼•ç”¨</strong>Â å¯¼è‡´çš„æ­»å¾ªç¯</p>
</blockquote>
<ol>
<li><strong>æ”¯æŒåŸºæœ¬ç±»å‹</strong>ï¼šæ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€<code>null</code>ã€<code>undefined</code>ã€<code>Symbol</code>ã€<code>BigInt</code>ï¼ˆç›´æ¥è¿”å›åŸå€¼ï¼Œæ— æ‹·è´æˆæœ¬ï¼‰ã€‚</li>
<li><strong>æ”¯æŒå¼•ç”¨ç±»å‹</strong>ï¼š
<ul>
<li>æ™®é€šå¯¹è±¡ï¼ˆ<code>{}</code>ï¼‰ã€æ•°ç»„ï¼ˆ<code>[]</code>ï¼‰</li>
<li>ç‰¹æ®Šå¯¹è±¡ï¼š<code>Date</code>ï¼ˆæ‹·è´æ—¶é—´æˆ³ï¼‰ã€<code>RegExp</code>ï¼ˆæ‹·è´æºæ­£åˆ™å’Œä¿®é¥°ç¬¦ï¼‰</li>
</ul>
</li>
<li><strong>è§£å†³å¾ªç¯å¼•ç”¨</strong>ï¼šç”¨Â <code>WeakMap</code>Â ç¼“å­˜å·²æ‹·è´çš„å¯¹è±¡ï¼Œé¿å…å¾ªç¯å¼•ç”¨å¯¼è‡´çš„æ ˆæº¢å‡ºï¼ˆä¾‹å¦‚Â <code>a.b = a</code>Â åœºæ™¯ï¼‰ã€‚</li>
<li><strong>ä¿ç•™å±æ€§ç‰¹æ€§</strong>ï¼šé€šè¿‡Â <code>Reflect.ownKeys</code>Â éå†æ‰€æœ‰å¯æšä¸¾ / ä¸å¯æšä¸¾å±æ€§ï¼ŒåŒ…æ‹¬Â <code>Symbol</code>Â ç±»å‹çš„é”®ï¼ˆæ¯”Â <code>for...in</code>Â æ›´å…¨é¢ï¼‰ã€‚</li>
</ol>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">target, hash = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>()</span>) {
  <span class="hljs-comment">// 1. å¤„ç†åŸºæœ¬ç±»å‹å’Œ null/undefinedï¼ˆç›´æ¥è¿”å›ï¼Œæ— éœ€æ‹·è´ï¼‰</span>
  <span class="hljs-keyword">if</span> (target === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">"object"</span>) <span class="hljs-keyword">return</span> target
  <span class="hljs-comment">// 2. å¤„ç†å¾ªç¯å¼•ç”¨ï¼ˆå·²æ‹·è´è¿‡çš„å¯¹è±¡ç›´æ¥è¿”å›ç¼“å­˜ï¼‰</span>
  <span class="hljs-keyword">if</span> (hash.<span class="hljs-title function_">has</span>(target)) <span class="hljs-keyword">return</span> hash.<span class="hljs-title function_">get</span>(target)

  <span class="hljs-keyword">let</span> cloneObj

  <span class="hljs-comment">// 3. å¤„ç†æ—¥æœŸå¯¹è±¡</span>
  <span class="hljs-keyword">if</span> (target <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span>) {
    cloneObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(target)
    hash.<span class="hljs-title function_">set</span>(target, cloneObj)
    <span class="hljs-keyword">return</span> cloneObj
  }

  <span class="hljs-comment">// 4. å¤„ç†æ­£åˆ™å¯¹è±¡</span>
  <span class="hljs-keyword">if</span> (target <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">RegExp</span>) {
    cloneObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(target.<span class="hljs-property">source</span>, target.<span class="hljs-property">flags</span>)
    hash.<span class="hljs-title function_">set</span>(target, cloneObj)
    <span class="hljs-keyword">return</span> cloneObj
  }

  <span class="hljs-comment">// 5. å¤„ç† Map</span>
  <span class="hljs-keyword">if</span> (target <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Map</span>) {
    cloneObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()
    hash.<span class="hljs-title function_">set</span>(target, cloneObj)
    target.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, key</span>) =&gt;</span> {
      cloneObj.<span class="hljs-title function_">set</span>(<span class="hljs-title function_">deepClone</span>(key, hash), <span class="hljs-title function_">deepClone</span>(value, hash))
    })
    <span class="hljs-keyword">return</span> cloneObj
  }

  <span class="hljs-comment">// 6. å¤„ç† Set</span>
  <span class="hljs-keyword">if</span> (target <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Set</span>) {
    cloneObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()
    hash.<span class="hljs-title function_">set</span>(target, cloneObj)
    target.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
      cloneObj.<span class="hljs-title function_">add</span>(<span class="hljs-title function_">deepClone</span>(value, hash))
    })
    <span class="hljs-keyword">return</span> cloneObj
  }

  <span class="hljs-comment">// 7. å¤„ç†æ•°ç»„å’Œæ™®é€šå¯¹è±¡ï¼ˆåŒºåˆ†æ•°ç»„å’Œå¯¹è±¡çš„æ„é€ å™¨ï¼‰</span>
  cloneObj = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target) ? [] : {}
  hash.<span class="hljs-title function_">set</span>(target, cloneObj)

  <span class="hljs-comment">// 8. éå†å¯¹è±¡/æ•°ç»„çš„å¯æšä¸¾å±æ€§ï¼ˆåŒ…æ‹¬ Symbol ç±»å‹ï¼‰</span>
  <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">ownKeys</span>(target).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
    <span class="hljs-comment">// é€’å½’æ‹·è´å±æ€§å€¼ï¼ŒåŒæ—¶ä¼ é€’ hash ç¼“å­˜</span>
    cloneObj[key] = <span class="hljs-title function_">deepClone</span>(target[key], hash)
  })

  <span class="hljs-keyword">return</span> cloneObj
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£é”Vueç»„ä»¶é€šä¿¡æ–°å§¿åŠ¿ï¼šprovide/injectæ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7578922565210882075</link>    <guid>https://juejin.cn/post/7578922565210882075</guid>    <pubDate>2025-12-02T13:32:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578922565210882075" data-draft-id="7578922565210865691" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£é”Vueç»„ä»¶é€šä¿¡æ–°å§¿åŠ¿ï¼šprovide/injectæ·±åº¦è§£æ"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-02T13:32:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£é”Vueç»„ä»¶é€šä¿¡æ–°å§¿åŠ¿ï¼šprovide/injectæ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T13:32:16.000Z" title="Tue Dec 02 2025 13:32:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦è·¨å±‚çº§ç»„ä»¶é€šä¿¡ï¼Ÿ</h2>
<p>åœ¨æ—¥å¸¸Vueå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼šå¤šå±‚åµŒå¥—çš„ç»„ä»¶éœ€è¦å…±äº«æŸäº›æ•°æ®æˆ–æ–¹æ³•ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>ä¸»é¢˜é…ç½®éœ€è¦ä»æ ¹ç»„ä»¶ä¼ é€’åˆ°æ·±å±‚çš„å­ç»„ä»¶</li>
<li>ç”¨æˆ·ç™»å½•ä¿¡æ¯éœ€è¦åœ¨å¤šä¸ªå±‚çº§ä¸­å…±äº«</li>
<li>å¤šè¯­è¨€é…ç½®éœ€è¦åœ¨æ•´ä¸ªåº”ç”¨ä¸­ä½¿ç”¨</li>
</ul>
<p>ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆï¼špropså±‚å±‚ä¼ é€’ï¼Œå¤æ‚åˆç¹çï¼ä»Šå¤©ç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªæ›´ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼š<strong>provide/inject</strong>ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯provide/injectï¼Ÿ</h2>
<h3 data-id="heading-2">åŸºæœ¬æ¦‚å¿µ</h3>
<p><strong>provide</strong>ï¼ˆæä¾›ï¼‰å’Œ<strong>inject</strong>ï¼ˆæ³¨å…¥ï¼‰æ˜¯Vueæä¾›çš„ä¸€å¯¹APIï¼Œå…è®¸ç¥–å…ˆç»„ä»¶å‘æ‰€æœ‰å­å­™ç»„ä»¶æ³¨å…¥ä¾èµ–ï¼Œæ— è®ºç»„ä»¶å±‚æ¬¡æœ‰å¤šæ·±ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">ç¥–å…ˆç»„ä»¶ (provideæ•°æ®)
      â†“
   å­å­™ç»„ä»¶ (injectæ•°æ®)
</code></pre>
<h3 data-id="heading-3">ä¸propså¯¹æ¯”</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>propsä¼ é€’</th><th>provide/inject</th></tr></thead><tbody><tr><td>æ•°æ®æµå‘</td><td>çˆ¶â†’å­ï¼ˆå•å‘ï¼‰</td><td>ç¥–å…ˆâ†’å­å­™ï¼ˆè·¨çº§ï¼‰</td></tr><tr><td>ä½¿ç”¨å¤æ‚åº¦</td><td>æ¯å±‚éƒ½éœ€è¦å£°æ˜</td><td>ä¸€æ¬¡æä¾›ï¼Œéšå¤„æ³¨å…¥</td></tr><tr><td>ç»„ä»¶è€¦åˆåº¦</td><td>çˆ¶å­ç´§è€¦åˆ</td><td>ç¥–å…ˆä¸å­å­™è§£è€¦</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>ç›´æ¥çˆ¶å­é€šä¿¡</td><td>æ·±å±‚åµŒå¥—ç»„ä»¶é€šä¿¡</td></tr></tbody></table>
<h2 data-id="heading-4">äºŒã€åŸºæœ¬ä½¿ç”¨æ–¹å¼</h2>
<h3 data-id="heading-5">2.1 åŸºç¡€è¯­æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç¥–å…ˆç»„ä»¶ - æä¾›æ•°æ®</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">provide</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-comment">// æä¾›é™æ€æ•°æ®</span>
      <span class="hljs-attr">siteName</span>: <span class="hljs-string">'VueæŠ€æœ¯åšå®¢'</span>,
      <span class="hljs-comment">// æä¾›å“åº”å¼æ•°æ®éœ€è¦ç‰¹æ®Šå¤„ç†</span>
      <span class="hljs-attr">theme</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentTheme</span>,
      <span class="hljs-comment">// æä¾›æ–¹æ³•</span>
      <span class="hljs-attr">changeTheme</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">updateTheme</span>
    }
  },
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">currentTheme</span>: <span class="hljs-string">'light'</span>
    }
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">updateTheme</span>(<span class="hljs-params">newTheme</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentTheme</span> = newTheme
    }
  }
}
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å­å­™ç»„ä»¶ - æ³¨å…¥æ•°æ®</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// æ•°ç»„å½¢å¼</span>
  <span class="hljs-attr">inject</span>: [<span class="hljs-string">'siteName'</span>, <span class="hljs-string">'theme'</span>, <span class="hljs-string">'changeTheme'</span>],
  
  <span class="hljs-comment">// å¯¹è±¡å½¢å¼ï¼ˆæ¨èï¼‰</span>
  <span class="hljs-attr">inject</span>: {
    <span class="hljs-comment">// åŸºæœ¬æ³¨å…¥</span>
    <span class="hljs-attr">blogName</span>: <span class="hljs-string">'siteName'</span>,
    
    <span class="hljs-comment">// å¸¦é»˜è®¤å€¼</span>
    <span class="hljs-attr">theme</span>: {
      <span class="hljs-attr">from</span>: <span class="hljs-string">'theme'</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'light'</span>
    },
    
    <span class="hljs-comment">// é‡å‘½å</span>
    <span class="hljs-attr">switchTheme</span>: {
      <span class="hljs-attr">from</span>: <span class="hljs-string">'changeTheme'</span>
    }
  },
  
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">handleThemeChange</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">switchTheme</span>(<span class="hljs-string">'dark'</span>)
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰ä¸»é¢˜ï¼š<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.theme}</span>`</span>)
    }
  }
}
</code></pre>
<h3 data-id="heading-6">2.2 å®é™…å¼€å‘æ¡ˆä¾‹</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…æ¡ˆä¾‹æ¥ç†è§£provide/injectçš„å¼ºå¤§ä¹‹å¤„ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- æ ¹ç»„ä»¶ï¼šApp.vue --&gt;
&lt;template&gt;
  &lt;div :class="`app ${theme}`"&gt;
    &lt;Header /&gt;
    &lt;div class="content"&gt;
      &lt;Sidebar /&gt;
      &lt;MainContent /&gt;
    &lt;/div&gt;
    &lt;SettingsPanel /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'App',
  provide() {
    return {
      // æä¾›ä¸»é¢˜é…ç½®
      appTheme: this.theme,
      switchTheme: this.handleThemeChange,
      
      // æä¾›ç”¨æˆ·ä¿¡æ¯
      currentUser: this.user,
      
      // æä¾›å›½é™…åŒ–å‡½æ•°
      t: this.translate,
      
      // æä¾›å…¨å±€é…ç½®
      appConfig: {
        apiBaseUrl: process.env.VUE_APP_API_URL,
        version: '2.0.0'
      }
    }
  },
  
  data() {
    return {
      theme: 'light',
      user: {
        id: 1,
        name: 'å¼ ä¸‰',
        role: 'admin'
      },
      locale: 'zh-CN'
    }
  },
  
  methods: {
    handleThemeChange(newTheme) {
      this.theme = newTheme
      localStorage.setItem('app-theme', newTheme)
    },
    
    translate(key) {
      // ç®€åŒ–ç‰ˆç¿»è¯‘å‡½æ•°
      const dictionaries = {
        'zh-CN': { welcome: 'æ¬¢è¿', logout: 'é€€å‡ºç™»å½•' },
        'en-US': { welcome: 'Welcome', logout: 'Logout' }
      }
      return dictionaries[this.locale][key] || key
    }
  }
}
&lt;/script&gt;
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- æ·±å±‚åµŒå¥—ç»„ä»¶ï¼šUserAvatar.vue --&gt;
&lt;template&gt;
  &lt;div class="user-avatar"&gt;
    &lt;img :src="avatarUrl" :alt="userName" /&gt;
    &lt;span&gt;{{ userName }}&lt;/span&gt;
    &lt;button @click="logout"&gt;{{ t('logout') }}&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'UserAvatar',
  
  // æ³¨å…¥éœ€è¦çš„æ•°æ®å’Œæ–¹æ³•
  inject: {
    currentUser: {
      from: 'currentUser',
      default: () =&gt; ({ name: 'Guest' })
    },
    t: {
      from: 't',
      default: () =&gt; (key) =&gt; key
    }
  },
  
  computed: {
    userName() {
      return this.currentUser.name
    },
    
    avatarUrl() {
      return `https://avatar.com/${this.currentUser.id}`
    }
  },
  
  methods: {
    logout() {
      // è°ƒç”¨æ³¨å…¥çš„æ–¹æ³•
      // è¿™é‡Œå¯ä»¥æ·»åŠ è‡ªå·±çš„é€»è¾‘
      console.log('ç”¨æˆ·é€€å‡ºç™»å½•')
    }
  }
}
&lt;/script&gt;
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€é«˜çº§ä½¿ç”¨æŠ€å·§</h2>
<h3 data-id="heading-8">3.1 æä¾›å“åº”å¼æ•°æ®</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œprovideæä¾›çš„ä¸æ˜¯å“åº”å¼æ•°æ®ã€‚å¦‚æœéœ€è¦å“åº”å¼ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹æ³•ä¸€ï¼šæä¾›è®¡ç®—å±æ€§</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">user</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>,
        <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
      }
    }
  },
  
  <span class="hljs-title function_">provide</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-comment">// ä½¿ç”¨è®¡ç®—å±æ€§ä¿æŒå“åº”å¼</span>
      <span class="hljs-attr">reactiveUser</span>: <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>),
      
      <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨å“åº”å¼APIï¼ˆVue 2.6+ï¼‰</span>
      <span class="hljs-attr">reactiveData</span>: <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">observable</span>({
        <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reactiveData</span>.<span class="hljs-property">count</span>++
        }
      })
    }
  }
}
</code></pre>
<h3 data-id="heading-9">3.2 ä½¿ç”¨Symbolä½œä¸ºé”®å</h3>
<p>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œä¸ºäº†é¿å…å‘½åå†²çªï¼Œå¯ä»¥ä½¿ç”¨Symbolä½œä¸ºprovideçš„é”®åï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// constants.js - å®šä¹‰Symbolå¸¸é‡</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeSymbol</span> = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'theme'</span>)
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">UserSymbol</span> = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'user'</span>)
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">ConfigSymbol</span> = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'config'</span>)

<span class="hljs-comment">// ç¥–å…ˆç»„ä»¶</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ThemeSymbol</span>, <span class="hljs-title class_">UserSymbol</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./constants'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">provide</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      [<span class="hljs-title class_">ThemeSymbol</span>]: <span class="hljs-variable language_">this</span>.<span class="hljs-property">theme</span>,
      [<span class="hljs-title class_">UserSymbol</span>]: <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>
    }
  }
}

<span class="hljs-comment">// å­å­™ç»„ä»¶</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ThemeSymbol</span>, <span class="hljs-title class_">UserSymbol</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./constants'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">inject</span>: {
    <span class="hljs-attr">theme</span>: { <span class="hljs-attr">from</span>: <span class="hljs-title class_">ThemeSymbol</span> },
    <span class="hljs-attr">user</span>: { <span class="hljs-attr">from</span>: <span class="hljs-title class_">UserSymbol</span> }
  }
}
</code></pre>
<h3 data-id="heading-10">3.3 ç»„åˆå¼APIä¸­çš„ä½¿ç”¨</h3>
<p>Vue 3çš„ç»„åˆå¼APIä¸­ï¼Œprovide/injectçš„ä½¿ç”¨æ›´åŠ ç®€æ´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç¥–å…ˆç»„ä»¶</span>
<span class="hljs-keyword">import</span> { provide, ref, reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åˆ›å»ºå“åº”å¼æ•°æ®</span>
    <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'light'</span>)
    <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">reactive</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">'æå››'</span>,
      <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>
    })
    
    <span class="hljs-comment">// æä¾›æ•°æ®</span>
    <span class="hljs-title function_">provide</span>(<span class="hljs-string">'theme'</span>, theme)
    <span class="hljs-title function_">provide</span>(<span class="hljs-string">'user'</span>, user)
    <span class="hljs-title function_">provide</span>(<span class="hljs-string">'updateTheme'</span>, <span class="hljs-function">(<span class="hljs-params">newTheme</span>) =&gt;</span> {
      theme.<span class="hljs-property">value</span> = newTheme
    })
    
    <span class="hljs-keyword">return</span> {
      theme,
      user
    }
  }
}

<span class="hljs-comment">// å­å­™ç»„ä»¶</span>
<span class="hljs-keyword">import</span> { inject } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ³¨å…¥æ•°æ®</span>
    <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">inject</span>(<span class="hljs-string">'theme'</span>, <span class="hljs-string">'light'</span>) <span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯é»˜è®¤å€¼</span>
    <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">inject</span>(<span class="hljs-string">'user'</span>)
    <span class="hljs-keyword">const</span> updateTheme = <span class="hljs-title function_">inject</span>(<span class="hljs-string">'updateTheme'</span>)
    
    <span class="hljs-comment">// å¦‚æœç¡®å®šæ•°æ®å­˜åœ¨ï¼Œå¯ä»¥ä½¿ç”¨éç©ºæ–­è¨€</span>
    <span class="hljs-keyword">const</span> requiredData = <span class="hljs-title function_">inject</span>(<span class="hljs-string">'someRequiredData'</span>)!
    
    <span class="hljs-keyword">return</span> {
      theme,
      user,
      <span class="hljs-attr">changeTheme</span>: updateTheme
    }
  }
}
</code></pre>
<h2 data-id="heading-11">å››ã€æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-12">4.1 ä»€ä¹ˆæ—¶å€™ä½¿ç”¨provide/injectï¼Ÿ</h3>
<p>âœ… <strong>é€‚åˆä½¿ç”¨çš„æƒ…å†µï¼š</strong></p>
<ul>
<li>å¼€å‘ç»„ä»¶åº“ï¼ˆå¦‚è¡¨å•ã€é…ç½®ç±»ç»„ä»¶ï¼‰</li>
<li>å…¨å±€çŠ¶æ€ç®¡ç†ï¼ˆå°é¡¹ç›®æ›¿ä»£Vuexï¼‰</li>
<li>ä¸»é¢˜/æ ·å¼é…ç½®ä¼ é€’</li>
<li>å¤šè¯­è¨€æ”¯æŒ</li>
<li>ç”¨æˆ·æƒé™ä¼ é€’</li>
</ul>
<p>âŒ <strong>ä¸å»ºè®®ä½¿ç”¨çš„æƒ…å†µï¼š</strong></p>
<ul>
<li>ç®€å•çš„çˆ¶å­ç»„ä»¶é€šä¿¡ï¼ˆç”¨propsï¼‰</li>
<li>åº”ç”¨æ ¸å¿ƒçŠ¶æ€ç®¡ç†ï¼ˆå¤§å‹åº”ç”¨ç”¨Vuex/Piniaï¼‰</li>
<li>ç»„ä»¶é—´å¼ºè€¦åˆçš„åœºæ™¯</li>
</ul>
<h3 data-id="heading-13">4.2 å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</h3>
<p><strong>é—®é¢˜1ï¼šæ•°æ®ä¸æ˜¯å“åº”å¼çš„</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯åšæ³•</span>
<span class="hljs-title function_">provide</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">user</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> <span class="hljs-comment">// å¤±å»å“åº”å¼</span>
  }
}

<span class="hljs-comment">// æ­£ç¡®åšæ³•</span>
<span class="hljs-title function_">provide</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// Vue 2ä½¿ç”¨è®¡ç®—å±æ€§</span>
    <span class="hljs-attr">user</span>: <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>),
    
    <span class="hljs-comment">// æˆ–è€…æä¾›ä¿®æ”¹æ–¹æ³•</span>
    <span class="hljs-attr">getUser</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>,
    <span class="hljs-attr">updateUser</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">updateUserMethod</span>
  }
}
</code></pre>
<p><strong>é—®é¢˜2ï¼šå‘½åå†²çª</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨å‘½åç©ºé—´</span>
<span class="hljs-title function_">provide</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-string">'app:theme'</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">theme</span>,
    <span class="hljs-string">'app:user'</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>,
    <span class="hljs-string">'app:config'</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>
  }
}

<span class="hljs-attr">inject</span>: {
  <span class="hljs-attr">theme</span>: <span class="hljs-string">'app:theme'</span>,
  <span class="hljs-attr">user</span>: <span class="hljs-string">'app:user'</span>
}
</code></pre>
<h3 data-id="heading-14">4.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<ol>
<li><strong>æŒ‰éœ€æä¾›</strong>ï¼šåªæä¾›å¿…è¦çš„æ•°æ®ï¼Œé¿å…æä¾›å¤§é‡ä¸å¿…è¦çš„æ•°æ®</li>
<li><strong>ä½¿ç”¨åªè¯»æ•°æ®</strong>ï¼šå¯¹äºä¸éœ€è¦ä¿®æ”¹çš„æ•°æ®ï¼Œæä¾›åªè¯»ç‰ˆæœ¬</li>
<li><strong>é¿å…æ·±å±‚åµŒå¥—</strong>ï¼šåˆç†è®¾è®¡ç»„ä»¶ç»“æ„ï¼Œé¿å…è¿‡åº¦åµŒå¥—</li>
<li><strong>ä½¿ç”¨å·¥å‚å‡½æ•°</strong>ï¼šå¯¹äºéœ€è¦è®¡ç®—çš„æ•°æ®ï¼Œä½¿ç”¨å·¥å‚å‡½æ•°å»¶è¿Ÿè®¡ç®—</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">provide</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// å·¥å‚å‡½æ•°ï¼ŒæŒ‰éœ€è®¡ç®—</span>
    <span class="hljs-attr">getUserPermissions</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculatePermissions</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>.<span class="hljs-property">role</span>),
    
    <span class="hljs-comment">// åªè¯»æ•°æ®</span>
    <span class="hljs-attr">readOnlyConfig</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">freeze</span>({ ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> })
  }
}
</code></pre>
<h2 data-id="heading-15">äº”ã€å®æˆ˜ï¼šæ„å»ºä¸€ä¸ªä¸»é¢˜åˆ‡æ¢ç³»ç»Ÿ</h2>
<p>è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­æ¥å±•ç¤ºprovide/injectçš„å¼ºå¤§åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ThemeProvider.vue --&gt;
&lt;template&gt;
  &lt;div :class="`theme-provider ${currentTheme}`"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import { ThemeSymbol, UpdateThemeSymbol } from './symbols'

export default {
  name: 'ThemeProvider',
  
  provide() {
    return {
      [ThemeSymbol]: Vue.computed(() =&gt; this.currentTheme),
      [UpdateThemeSymbol]: this.updateTheme
    }
  },
  
  data() {
    return {
      currentTheme: localStorage.getItem('theme') || 'light'
    }
  },
  
  methods: {
    updateTheme(theme) {
      this.currentTheme = theme
      localStorage.setItem('theme', theme)
      document.documentElement.setAttribute('data-theme', theme)
    }
  }
}
&lt;/script&gt;

&lt;style&gt;
.theme-provider.light {
  --bg-color: #ffffff;
  --text-color: #333333;
}

.theme-provider.dark {
  --bg-color: #1a1a1a;
  --text-color: #ffffff;
}
&lt;/style&gt;
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ThemedButton.vue --&gt;
&lt;template&gt;
  &lt;button 
    :class="['themed-button', `theme-${theme}`]"
    @click="handleClick"
  &gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/button&gt;
&lt;/template&gt;

&lt;script&gt;
import { ThemeSymbol, UpdateThemeSymbol } from './symbols'

export default {
  name: 'ThemedButton',
  
  inject: {
    theme: {
      from: ThemeSymbol,
      default: 'light'
    },
    updateTheme: {
      from: UpdateThemeSymbol
    }
  },
  
  methods: {
    handleClick() {
      if (this.updateTheme) {
        const newTheme = this.theme === 'light' ? 'dark' : 'light'
        this.updateTheme(newTheme)
      }
      this.$emit('click')
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
.themed-button {
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s;
}

.theme-light {
  background-color: var(--bg-color, #ffffff);
  color: var(--text-color, #333333);
  border: 1px solid #ddd;
}

.theme-dark {
  background-color: var(--bg-color, #333333);
  color: var(--text-color, #ffffff);
  border: 1px solid #555;
}
&lt;/style&gt;
</code></pre>
<h2 data-id="heading-16">å…­ã€æ€»ç»“</h2>
<p>provide/injectæ˜¯Vueä¸­ä¸€ä¸ªå¼ºå¤§ä½†å®¹æ˜“è¢«å¿½è§†çš„ç‰¹æ€§ã€‚å®ƒæä¾›äº†ä¸€ç§ä¼˜é›…çš„è·¨å±‚çº§ç»„ä»¶é€šä¿¡æ–¹å¼ï¼Œç‰¹åˆ«é€‚ç”¨äºï¼š</p>
<ol>
<li><strong>ç»„ä»¶åº“å¼€å‘</strong>ï¼šæä¾›å…¨å±€é…ç½®å’Œèƒ½åŠ›</li>
<li><strong>åŠŸèƒ½å°è£…</strong>ï¼šå¦‚ä¸»é¢˜åˆ‡æ¢ã€å¤šè¯­è¨€ç­‰</li>
<li><strong>çŠ¶æ€å…±äº«</strong>ï¼šåœ¨ä¸­å°å‹åº”ç”¨ä¸­æ›¿ä»£çŠ¶æ€ç®¡ç†åº“</li>
<li><strong>è§£è€¦ç»„ä»¶</strong>ï¼šå‡å°‘ç»„ä»¶é—´çš„ç›´æ¥ä¾èµ–</li>
</ol>
<p>è®°ä½è¿™äº›å…³é”®ç‚¹ï¼š</p>
<ul>
<li>é»˜è®¤ä¸æ˜¯å“åº”å¼çš„ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†</li>
<li>é€‚åˆè·¨å¤šå±‚ç»„ä»¶é€šä¿¡ï¼Œä½†ä¸é€‚åˆç®€å•çˆ¶å­é€šä¿¡</li>
<li>ä½¿ç”¨Symbolæˆ–å‘½åç©ºé—´é¿å…å‘½åå†²çª</li>
<li>åœ¨Vue 3çš„ç»„åˆå¼APIä¸­æ›´å¥½ç”¨</li>
</ul>
<p>æŒæ¡provide/injectï¼Œè®©ä½ çš„Vueåº”ç”¨æ¶æ„æ›´åŠ æ¸…æ™°ã€ç»„ä»¶æ›´åŠ è§£è€¦ã€ä»£ç æ›´åŠ ä¼˜é›…ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ç¿»è¯‘ã€‘æˆ‘ä»¬å¦‚ä½•æ‰“é€ v0ç‰ˆiOSåº”ç”¨]]></title>    <link>https://juejin.cn/post/7579111646870765619</link>    <guid>https://juejin.cn/post/7579111646870765619</guid>    <pubDate>2025-12-02T13:38:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579111646870765619" data-draft-id="7579096485355470898" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ç¿»è¯‘ã€‘æˆ‘ä»¬å¦‚ä½•æ‰“é€ v0ç‰ˆiOSåº”ç”¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-02T13:38:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·60007181910"/> <meta itemprop="url" content="https://juejin.cn/user/3555196688934128"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ç¿»è¯‘ã€‘æˆ‘ä»¬å¦‚ä½•æ‰“é€ v0ç‰ˆiOSåº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3555196688934128/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·60007181910
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T13:38:05.000Z" title="Tue Dec 02 2025 13:38:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fblog%2Fhow-we-built-the-v0-ios-app" target="_blank" title="https://vercel.com/blog/how-we-built-the-v0-ios-app" ref="nofollow noopener noreferrer">vercel.com/blog/how-weâ€¦</a></p>
<p>ä½œè€…ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftwitter.com%2Ffernandorojo" target="_blank" title="https://twitter.com/fernandorojo" ref="nofollow noopener noreferrer">Fernando Rojo Head of Mobile</a></p>
<p>æˆ‘ä»¬è¿‘æœŸå‘å¸ƒäº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fapps.apple.com%2Fus%2Fapp%2Fv0%2Fid6745097949" target="_blank" title="https://apps.apple.com/us/app/v0/id6745097949" ref="nofollow noopener noreferrer">iOSç‰ˆv0</a>ï¼Œè¿™æ˜¯Vercelçš„é¦–æ¬¾ç§»åŠ¨åº”ç”¨ã€‚ä½œä¸ºä¸“æ³¨äºwebæŠ€æœ¯çš„å…¬å¸ï¼Œå¼€å‘åŸç”Ÿåº”ç”¨å¯¹æˆ‘ä»¬è€Œè¨€æ˜¯å…¨æ–°é¢†åŸŸã€‚</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰“é€ ä¸€æ¬¾é…å¾—ä¸Šè‹¹æœè®¾è®¡å¥–çš„åº”ç”¨ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯¹æŠ€æœ¯æ ˆçš„é€‰æ‹©ä¿æŒå¼€æ”¾æ€åº¦ã€‚åœ¨å…¬å¼€æµ‹è¯•ç‰ˆå‘å¸ƒå‰ï¼Œæˆ‘ä»¬è¿›è¡Œäº†æ•°åæ¬¡äº§å“è¿­ä»£ï¼Œå°è¯•äº†æˆªç„¶ä¸åŒçš„æŠ€æœ¯æ ˆå’ŒUIæ¨¡å¼ã€‚</p>
<p>æˆ‘ä»¬ä»é‚£äº›å®Œç¾å¥‘åˆiPhoneè¯­è¨€çš„åº”ç”¨ä¸­æ±²å–çµæ„Ÿï¼Œä¾‹å¦‚Apple Noteså’ŒiMessageã€‚v0å¿…é¡»åœ¨ä½ çš„ä¸»å±å¹•ä¸Šèµ¢å¾—ä¸€å¸­ä¹‹åœ°ï¼Œä¸è¿™äº›æ°ä½œæ¯”è‚©ã€‚</p>
<p>ç»è¿‡æ•°å‘¨çš„æ¢ç´¢ï¼Œæˆ‘ä»¬æœ€ç»ˆé€‰æ‹©React Nativeä¸Expoå®ç°è¿™ä¸€ç›®æ ‡ã€‚æˆ‘ä»¬å¯¹æˆæœæ„Ÿåˆ°æ»¡æ„ï¼Œç”¨æˆ·åŒæ ·å¦‚æ­¤ã€‚äº‹å®ä¸Šï¼Œå¤§é‡å¼€å‘è€…è¯¢é—®åº”ç”¨ä¸ºä½•å¦‚æ­¤åŸç”Ÿçš„æ¶ˆæ¯æ¶Œå…¥ï¼Œä¿ƒä½¿æˆ‘ä»¬æ’°å†™äº†æŠ€æœ¯è§£ææ–‡ç« ï¼Œè¯¦è¿°å®ç°è¿‡ç¨‹ã€‚</p>
<h2 data-id="heading-0">æˆ‘ä»¬å¦‚ä½•æ‰“é€ v0ç‰ˆèŠå¤©ä½“éªŒã€</h2>
<p>å½“ä½ ç¦»å¼€ç”µè„‘æ—¶ï¼Œå¯èƒ½ä¼šçªç„¶çµå…‰ä¹ç°ï¼Œæƒ³è¦ç«‹å³ä»˜è¯¸è¡ŒåŠ¨ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®©ä½ æ— éœ€åˆ‡æ¢åœºæ™¯ï¼Œå°±èƒ½å°†çµæ„Ÿè½¬åŒ–ä¸ºå…·ä½“æˆæœã€‚iOSç‰ˆv0æ˜¯æ–°ä¸€ä»£ç¬”è®°åº”ç”¨ï¼Œè®©ä½ çš„åˆ›æ„åœ¨åå°æ‚„ç„¶æˆå½¢ã€‚</p>
<p>æˆ‘ä»¬å¹¶éè¦æ‰“é€ åŠŸèƒ½ä¸ç½‘ç«™å®Œå…¨ä¸€è‡´çš„ç§»åŠ¨é›†æˆå¼€å‘ç¯å¢ƒï¼Œè€Œæ˜¯è‡´åŠ›äºæ„å»ºç®€å•æ„‰æ‚¦çš„ç§»åŠ¨åˆ›ä½œä½“éªŒï¼Œè®©AIæˆä¸ºæ‚¨éšæ—¶éšåœ°å®ç°åˆ›æ„çš„å¾—åŠ›åŠ©æ‰‹ã€‚è€ŒèŠå¤©åŠŸèƒ½æ­£æ˜¯è¿™ç§ä½“éªŒçš„æ ¸å¿ƒæ‰€åœ¨ã€‚</p>
<p>è¦æ‰“é€ å‡ºè‰²çš„èŠå¤©ä½“éªŒï¼Œæˆ‘ä»¬è®¾å®šä»¥ä¸‹è¦æ±‚ï¼š</p>
<ul>
<li>æ–°æ¶ˆæ¯ä»¥å¹³æ»‘åŠ¨ç”»æ•ˆæœå‘ˆç°</li>
<li>ç”¨æˆ·æ–°æ¶ˆæ¯è‡ªåŠ¨æ»šåŠ¨è‡³å±å¹•é¡¶éƒ¨</li>
<li>åŠ©æ‰‹æ¶ˆæ¯ä»¥æ¸éšæ•ˆæœåˆ†æ‰¹æµå¼æ˜¾ç¤º</li>
<li>ç¼–è¾‘å™¨é‡‡ç”¨æ¶²æ€ç»ç’ƒæè´¨ï¼Œæ‚¬æµ®äºå¯æ»šåŠ¨å†…å®¹ä¹‹ä¸Š</li>
<li>æ‰“å¼€ç°æœ‰èŠå¤©æ—¶é»˜è®¤æ»šåŠ¨è‡³æœ«å°¾</li>
<li>é”®ç›˜äº¤äº’è‡ªç„¶æµç•…</li>
<li>æ–‡æœ¬è¾“å…¥æ”¯æŒç²˜è´´å›¾ç‰‡å’Œæ–‡ä»¶</li>
<li>æ–‡æœ¬è¾“å…¥æ”¯æŒå¹³ç§»æ‰‹åŠ¿èšç„¦/æ¨¡ç³Š</li>
<li>Markdownæ”¯æŒå¿«é€Ÿç¼–è¾‘ä¸åŠ¨æ€ç»„ä»¶</li>
</ul>
<p>å°½ç®¡ç§»åŠ¨ç«¯AIèŠå¤©å·²å½¢æˆå¤šç§UIæ¨¡å¼ï¼Œä½†ç§»åŠ¨ç«¯AIä»£ç ç”Ÿæˆé¢†åŸŸå°šæ— æˆç†ŸèŒƒå¼ã€‚</p>
<p>ç°æœ‰React Nativeåº”ç”¨ä¸­æœªè§è¿™äº›ç‰¹æ€§ï¼Œæˆ‘ä»¬åªèƒ½å³å…´åˆ›é€ æ¨¡å¼ã€‚ä¸ºè¾¾åˆ°æ ‡å‡†ï¼Œæ¯ä¸ªåŠŸèƒ½éƒ½ç»å†äº†è¶…ä¹å¯»å¸¸çš„å·¥ä½œé‡ã€æµ‹è¯•ä¸è·¨æ¨¡å—åè°ƒã€‚</p>
<h3 data-id="heading-1">æ„å»ºå¯ç»„åˆçš„èŠå¤©ç³»ç»Ÿ</h3>
<p>ä¸ºæ»¡è¶³éœ€æ±‚ï¼Œæˆ‘ä»¬æŒ‰åŠŸèƒ½æ¨¡å—å¯¹èŠå¤©ä»£ç è¿›è¡Œäº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D4KvbVq3Eg5w" target="_blank" title="https://www.youtube.com/watch?v=4KvbVq3Eg5w" ref="nofollow noopener noreferrer">å¯ç»„åˆåŒ–</a>è®¾è®¡ã€‚</p>
<p>æˆ‘ä»¬çš„èŠå¤©åŠŸèƒ½åŸºäºå¤šä¸ªå¼€æºåº“å®ç°ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flegendapp.com%2Fopen-source%2Flist%2F" target="_blank" title="https://legendapp.com/open-source/list/" ref="nofollow noopener noreferrer">LegendList</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.swmansion.com%2Freact-native-reanimated%2F" target="_blank" title="https://docs.swmansion.com/react-native-reanimated/" ref="nofollow noopener noreferrer">React Native Reanimated</a> ä»¥åŠ <a href="https://link.juejin.cn?target=https%3A%2F%2Fkirillzyusko.github.io%2Freact-native-keyboard-controller%2F" target="_blank" title="https://kirillzyusko.github.io/react-native-keyboard-controller/" ref="nofollow noopener noreferrer">React Native Keyboard Controller</a>ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è®¾ç½®äº†å¤šä¸ªä¸Šä¸‹æ–‡æä¾›è€…ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ChatProvider</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ComposerHeightProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">MessageListProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">NewMessageAnimationProvider</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">KeyboardStateProvider</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">KeyboardStateProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">NewMessageAnimationProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">MessageListProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ComposerHeightProvider</span>&gt;</span></span>
  )
}
</code></pre>
<p>æä¾›è€…å°è£…äº†<code>MessagesList</code>ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ChatMessagesList</span>(<span class="hljs-params">{ chatId }</span>) {
  <span class="hljs-keyword">const</span> messages = <span class="hljs-title function_">useMessages</span>({ chatId }).<span class="hljs-property">data</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ChatProvider</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{chatId}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">MessagesList</span> <span class="hljs-attr">messages</span>=<span class="hljs-string">{messages}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ChatProvider</span>&gt;</span></span>
  )
}
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çš„æ¶ˆæ¯åˆ—è¡¨é€šè¿‡å¯ç»„åˆæ’ä»¶å®ç°äº†è¿™äº›åŠŸèƒ½ï¼Œæ¯ä¸ªæ’ä»¶éƒ½æ‹¥æœ‰ä¸“å±çš„é’©å­ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MessagesList</span>(<span class="hljs-params">{ messages }</span>) {
  <span class="hljs-title function_">useKeyboardAwareMessageList</span>()
  <span class="hljs-title function_">useScrollMessageListFromComposerSizeUpdates</span>()
  <span class="hljs-title function_">useUpdateLastMessageIndex</span>()
  <span class="hljs-keyword">const</span> { animatedProps, ref, onContentSizeChange, onScroll } = <span class="hljs-title function_">useMessageListProps</span>()
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AnimatedLegendList</span>
      <span class="hljs-attr">animatedProps</span>=<span class="hljs-string">{animatedProps}</span>
      <span class="hljs-attr">ref</span>=<span class="hljs-string">{ref}</span>
      <span class="hljs-attr">onContentSizeChange</span>=<span class="hljs-string">{onContentSizeChange}</span>
      <span class="hljs-attr">onScroll</span>=<span class="hljs-string">{onScroll}</span>
      <span class="hljs-attr">enableAverages</span>=<span class="hljs-string">{false}</span>
      <span class="hljs-attr">data</span>=<span class="hljs-string">{messages}</span>
      <span class="hljs-attr">keyExtractor</span>=<span class="hljs-string">{(item)</span> =&gt;</span> item.id}
      renderItem={({ item, index }) =&gt; {
        if (item.role === 'user') {
          return <span class="hljs-tag">&lt;<span class="hljs-name">UserMessage</span> <span class="hljs-attr">message</span>=<span class="hljs-string">{item}</span> <span class="hljs-attr">index</span>=<span class="hljs-string">{index}</span> /&gt;</span>
        }
        if (item.role === 'assistant') {
          return <span class="hljs-tag">&lt;<span class="hljs-name">AssistantMessage</span> <span class="hljs-attr">message</span>=<span class="hljs-string">{item}</span> <span class="hljs-attr">index</span>=<span class="hljs-string">{index}</span> /&gt;</span>
        }
        if (item.role === 'optimistic-placeholder') {
          return <span class="hljs-tag">&lt;<span class="hljs-name">OptimisticAssistantMessage</span> <span class="hljs-attr">index</span>=<span class="hljs-string">{index}</span> /&gt;</span>
        }
      }}
    /&gt;</span>
  )
}
</code></pre>
<p>ä»¥ä¸‹å„èŠ‚å°†é€ä¸€å‰–ææ¯ä¸ªé’©å­ï¼Œä»¥å±•ç¤ºå®ƒä»¬å¦‚ä½•ååŒå·¥ä½œã€‚</p>
<h3 data-id="heading-2">å‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯</h3>
<p>å½“ä½ åœ¨v0ç‰ˆæœ¬å‘é€æ¶ˆæ¯æ—¶ï¼Œæ¶ˆæ¯æ°”æ³¡ä¼šå¹³æ»‘æ·¡å…¥å¹¶æ»‘åŠ¨è‡³é¡¶éƒ¨ã€‚ç”¨æˆ·æ¶ˆæ¯åŠ¨ç”»å®Œæˆåï¼ŒåŠ©æ‰‹æ¶ˆæ¯ä¼šç«‹å³æ·¡å…¥æ˜¾ç¤ºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8632e2d72e6c441a943691ccc171223b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=Qt%2B%2F6Q4vbTaUQ3AtzwVuVu8tHC4%3D" alt="image.png" loading="lazy"/></p>
<p>å½“ç”¨æˆ·å‘é€æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬ä¼šè®¾ç½®ä¸€ä¸ªåä¸º Reanimated çš„å…±äº«å€¼æ¥æŒ‡ç¤ºåŠ¨ç”»åº”å¼€å§‹æ’­æ”¾ã€‚å…±äº«å€¼ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´æ–°çŠ¶æ€è€Œä¸è§¦å‘é‡æ–°æ¸²æŸ“ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> { isMessageSendAnimating } = <span class="hljs-title function_">useNewMessageAnimation</span>()
<span class="hljs-keyword">const</span> chatId = <span class="hljs-title function_">useChatId</span>()

<span class="hljs-keyword">const</span> <span class="hljs-title function_">onSubmit</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> isNewChat = !chatId
  
  <span class="hljs-keyword">if</span> (isNewChat) {
    isMessageSendAnimating.<span class="hljs-title function_">set</span>(<span class="hljs-literal">true</span>)
  }
  
  <span class="hljs-title function_">send</span>()
}
</code></pre>
<p>åœ¨ Reanimated ä¸­è¿½è¸ªçŠ¶æ€åï¼Œç°åœ¨å¯ä»¥ä¸º <code>UserMessage</code> æ·»åŠ åŠ¨ç”»æ•ˆæœäº†ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">UserMessage</span>(<span class="hljs-params">{ message, index }</span>) {
  <span class="hljs-keyword">const</span> isFirstUserMessage = index === <span class="hljs-number">0</span>
  
  <span class="hljs-keyword">const</span> { style, ref, onLayout } = <span class="hljs-title function_">useFirstMessageAnimation</span>({
    <span class="hljs-attr">disabled</span>: !isFirstUserMessage,
  })
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{ref}</span> <span class="hljs-attr">onLayout</span>=<span class="hljs-string">{onLayout}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserMessageContent</span> <span class="hljs-attr">message</span>=<span class="hljs-string">{message}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Animated.View</span>&gt;</span></span>
  )
}
</code></pre>
<p>è¯·æ³¨æ„ï¼Œ<code>UserMessageContent</code> è¢«åŒ…è£¹åœ¨ <code>Animated.View</code> ä¸­ï¼Œè¯¥ç»„ä»¶ä» <code>useFirstMessageAnimation</code> æ¥æ”¶ propsã€‚</p>
<p><strong><code>useFirstMessageAnimation</code>Â å¦‚ä½•å·¥ä½œ</strong></p>
<p>æ­¤é’©å­è´Ÿè´£ä¸‰é¡¹ä»»åŠ¡ï¼š</p>
<ul>
<li>ä½¿ç”¨å…±äº«å€¼ <code>itemHeight</code>ï¼ˆReanimated ç±»ï¼‰æµ‹é‡ç”¨æˆ·æ¶ˆæ¯çš„é«˜åº¦</li>
<li>åœ¨ <code>isMessageSendAnimating</code> æ—¶æ·¡å…¥æ¶ˆæ¯</li>
<li>å‘åŠ©æ‰‹æ¶ˆæ¯å‘å‡ºåŠ¨ç”»å®Œæˆä¿¡å·</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useFirstMessageAnimation</span>(<span class="hljs-params">{ disabled }</span>) {
  <span class="hljs-keyword">const</span> { keyboardHeight } = <span class="hljs-title function_">useKeyboardContextState</span>()
  <span class="hljs-keyword">const</span> { isMessageSendAnimating } = <span class="hljs-title function_">useNewMessageAnimation</span>()
  <span class="hljs-keyword">const</span> windowHeight = <span class="hljs-title function_">useWindowDimensions</span>().<span class="hljs-property">height</span>
  <span class="hljs-keyword">const</span> translateY = <span class="hljs-title function_">useSharedValue</span>(<span class="hljs-number">0</span>)
  <span class="hljs-keyword">const</span> progress = <span class="hljs-title function_">useSharedValue</span>(-<span class="hljs-number">1</span>)
  <span class="hljs-keyword">const</span> { itemHeight, ref, onLayout } = <span class="hljs-title function_">useMessageRenderedHeight</span>()

  <span class="hljs-title function_">useAnimatedReaction</span>(
    <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> didAnimate = progress.<span class="hljs-title function_">get</span>() !== -<span class="hljs-number">1</span>

      <span class="hljs-keyword">if</span> (disabled || didAnimate || !isMessageSendAnimating.<span class="hljs-title function_">get</span>()) {
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
      }

      <span class="hljs-keyword">return</span> itemHeight.<span class="hljs-title function_">get</span>()
    },
    <span class="hljs-function">(<span class="hljs-params">messageHeight</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (messageHeight &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>

      <span class="hljs-keyword">const</span> animatedValues = <span class="hljs-title function_">getAnimatedValues</span>({
        <span class="hljs-attr">itemHeight</span>: messageHeight,
        windowHeight,
        <span class="hljs-attr">keyboardHeight</span>: keyboardHeight.<span class="hljs-title function_">get</span>(),
      })
      <span class="hljs-keyword">const</span> { start, end, duration, easing, config } = animatedValues

      translateY.<span class="hljs-title function_">set</span>(
        <span class="hljs-comment">// initialize values at the "start" state with duration 0</span>
        <span class="hljs-title function_">withTiming</span>(start.<span class="hljs-property">translateY</span>, { <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span> }, <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-comment">// next, transition to the "end" state</span>
          translateY.<span class="hljs-title function_">set</span>(<span class="hljs-title function_">withSpring</span>(end.<span class="hljs-property">translateY</span>, config))
        })
      )
      progress.<span class="hljs-title function_">set</span>(
        <span class="hljs-title function_">withTiming</span>(start.<span class="hljs-property">progress</span>, { <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span> }, <span class="hljs-function">() =&gt;</span> {
          progress.<span class="hljs-title function_">set</span>(<span class="hljs-title function_">withTiming</span>(end.<span class="hljs-property">progress</span>, { duration, easing }), <span class="hljs-function">() =&gt;</span> {
            isMessageSendAnimating.<span class="hljs-title function_">set</span>(<span class="hljs-literal">false</span>)
          })
        })
      )
    }
  )

  <span class="hljs-keyword">const</span> style = <span class="hljs-title function_">useAnimatedStyle</span>(...)
  <span class="hljs-keyword">const</span> didUserMessageAnimate = <span class="hljs-title function_">useDerivedValue</span>(<span class="hljs-function">() =&gt;</span> progress.<span class="hljs-title function_">get</span>() === <span class="hljs-number">1</span>)
  
  <span class="hljs-keyword">return</span> { style, ref, onLayout, didUserMessageAnimate }
}
</code></pre>
<p>å¾—ç›Šäº React Native çš„æ–°æ¶æ„ï¼Œ<code>useLayoutEffect</code> ä¸­çš„ <code>ref.current.measure()</code> æ“ä½œæ˜¯åŒæ­¥çš„ï¼Œå› æ­¤é¦–æ¬¡æ¸²æŸ“æ—¶å³å¯è·å–é«˜åº¦å€¼ã€‚åç»­æ›´æ–°åˆ™åœ¨ <code>onLayout</code> ä¸­è§¦å‘ã€‚</p>
<p>åŸºäºæ¶ˆæ¯é«˜åº¦ã€çª—å£é«˜åº¦å’Œå½“å‰é”®ç›˜é«˜åº¦ï¼Œ<code>getAnimatedValues</code> æ„é€  <code>translateY</code> å’Œ <code>progress</code> çš„ç¼“åŠ¨ã€<code>start</code> åŠ <code>end</code> çŠ¶æ€ã€‚ç”Ÿæˆçš„å…±äº«å€¼åˆ†åˆ«ä½œä¸º <code>transform</code> å’Œ <code>opacity</code> ä¼ é€’ç»™ <code>useAnimatedStyle</code>ã€‚</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„é¦–æ¡æ¶ˆæ¯å·²é€šè¿‡ Reanimated å®ç°æ·¡å…¥æ•ˆæœã€‚åŠ¨ç”»å®Œæˆåï¼Œå³å¯å¼€å§‹æ·¡å…¥é¦–ä¸ªåŠ©æ‰‹æ¶ˆæ¯å›å¤ã€‚</p>
<h3 data-id="heading-3">æ·¡å…¥ç¬¬ä¸€åŠ©ç†çš„ç•™è¨€</h3>
<p>ä¸ <code>UserMessage</code> ç±»ä¼¼ï¼ŒåŠ©æ‰‹æ¶ˆæ¯å†…å®¹è¢«åŒ…è£¹åœ¨ä¸€ä¸ªåŠ¨ç”»è§†å›¾ä¸­ï¼Œè¯¥è§†å›¾ä¼šåœ¨ç”¨æˆ·æ¶ˆæ¯åŠ¨ç”»å®Œæˆåæ·¡å…¥æ˜¾ç¤ºã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">AssistantMessage</span>(<span class="hljs-params">{ message, index }</span>) {
  <span class="hljs-keyword">const</span> isFirstAssistantMessage = index === <span class="hljs-number">1</span>
  
  <span class="hljs-keyword">const</span> { didUserMessageAnimate } = <span class="hljs-title function_">useFirstMessageAnimation</span>({
    <span class="hljs-attr">disabled</span>: !isFirstAssistantMessage,
  })

  <span class="hljs-keyword">const</span> style = <span class="hljs-title function_">useAnimatedStyle</span>(<span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">opacity</span>: didUserMessageAnimate.<span class="hljs-title function_">get</span>() ? <span class="hljs-title function_">withTiming</span>(<span class="hljs-number">1</span>, { <span class="hljs-attr">duration</span>: <span class="hljs-number">350</span> }) : <span class="hljs-number">0</span>,
  }))
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AssistantMessageContent</span> <span class="hljs-attr">message</span>=<span class="hljs-string">{message}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Animated.View</span>&gt;</span></span>
  )
}
</code></pre>
<p>æ­¤æ·¡å…¥æ•ˆæœä»…é€‚ç”¨äºèŠå¤©ä¸­çš„é¦–æ¡åŠ©æ‰‹æ¶ˆæ¯ï¼ˆå³ <code>index === 1</code> çš„æ¶ˆæ¯ï¼‰ã€‚ç°æœ‰èŠå¤©ä¸­çš„æ¶ˆæ¯ä¸æ–°èŠå¤©ä¸­çš„æ¶ˆæ¯å°†å‘ˆç°ä¸åŒè¡Œä¸ºã€‚</p>
<p>è‹¥æ‰“å¼€ä¸€ä¸ªå·²å­˜åœ¨èŠå¤©ï¼ˆåŒ…å«ä¸€æ¡ç”¨æˆ·æ¶ˆæ¯å’Œä¸€æ¡åŠ©æ‰‹æ¶ˆæ¯ï¼‰ï¼Œæ˜¯å¦ä¼šå†æ¬¡è§¦å‘åŠ¨ç”»ï¼Ÿä¸ä¼šï¼Œå› ä¸ºè¯¥åŠ¨ç”»ä»…åœ¨ <code>isMessageSendAnimating</code> ä¸º <code>true</code> æ—¶ç”Ÿæ•ˆâ€”â€”è¯¥å±æ€§åœ¨æ¶ˆæ¯ <code>onSubmit</code> æ—¶è®¾ç½®ï¼Œåˆ‡æ¢èŠå¤©æ—¶åˆ™è¢«æ¸…é™¤ã€‚</p>
<h3 data-id="heading-4">åœ¨ç°æœ‰èŠå¤©ä¸­å‘é€æ¶ˆæ¯</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40f1813ba5c4491ab4c41fbfc24fd3fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=7aJn19C93NrbC8VHERP6wT6%2BUBM%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬å·²ä»‹ç»è¿‡v0å¦‚ä½•å¤„ç†æ–°èŠå¤©æ¶ˆæ¯ä¸­çš„åŠ¨ç”»æ•ˆæœã€‚ä½†å¯¹äºç°æœ‰èŠå¤©ï¼Œå…¶é€»è¾‘åˆ™å®Œå…¨ä¸åŒã€‚æˆ‘ä»¬ä¸å†ä¾èµ–ReanimatedåŠ¨ç”»ï¼ˆå¦‚ <code>usedFirstMessageAnimation</code> ä¸­ä½¿ç”¨çš„åŠ¨ç”»ï¼‰ï¼Œè€Œæ˜¯é‡‡ç”¨ <code>scrollToEnd()</code> çš„å®ç°æ–¹æ¡ˆã€‚</p>
<p>é‚£ä¹ˆåœ¨ç°æœ‰èŠå¤©ä¸­å‘é€æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬åªéœ€æ»šåŠ¨åˆ°æœ«å°¾å³å¯ï¼Œå¯¹å§ï¼Ÿ</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">onNewMessage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> didNewMessageSend = <span class="hljs-comment">// ...some logic</span>
  <span class="hljs-keyword">if</span> (didNewMessageSend) {
    listRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">scrollToEnd</span>()
  }
}, ...)
</code></pre>
<p>åœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼Œè¿™å¥—é€»è¾‘æœ¬åº”è¶³å¤Ÿå®Œå–„ã€‚ä½†è®©æˆ‘ä»¬æ¢è®¨ä¸ºä½•å®ƒä»æ˜¾ä¸è¶³ã€‚</p>
<p>å›é¡¾å¼€ç¯‡æ‰€è¿°ï¼Œæˆ‘ä»¬çš„éœ€æ±‚ä¹‹ä¸€æ˜¯æ–°æ¶ˆæ¯å¿…é¡»æ»šåŠ¨è‡³å±å¹•é¡¶éƒ¨ã€‚è‹¥ç›´æ¥è°ƒç”¨<code>scrollToEnd()</code>æ–¹æ³•ï¼Œæ–°æ¶ˆæ¯åªä¼šæ˜¾ç¤ºåœ¨å±å¹•åº•éƒ¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9724180b41344ebfb6fa297fb519c3ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=zYPeo7u75W8xWHAcQBbocyf0foU%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬éœ€è¦ä¸€ç§ç­–ç•¥å°†ç”¨æˆ·æ¶ˆæ¯æ¨è‡³èŠå¤©é¡¶éƒ¨ã€‚æˆ‘ä»¬å°†æ­¤ç§°ä¸º"ç©ºç™½å¤§å°"ï¼šå³æœ€åä¸€æ¡åŠ©æ‰‹æ¶ˆæ¯åº•éƒ¨ä¸èŠå¤©ç»“æŸä¹‹é—´çš„è·ç¦»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a24f5a7f63104ab4833def70b43add03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=lhsBteBMG376B4nx9IU55sic6qA%3D" alt="" loading="lazy"/></p>
<p>ä¸ºå°†å†…å®¹æµ®åŠ¨è‡³èŠå¤©é¡¶éƒ¨ï¼Œæˆ‘ä»¬éœ€å°†å…¶å‘ä¸Šæ¨é€ä¸ç©ºç™½åŒºåŸŸç­‰é‡çš„è·ç¦»ã€‚å¾—ç›ŠäºReact Nativeæ–°æ¶æ„ä¸­çš„åŒæ­¥é«˜åº¦æµ‹é‡æœºåˆ¶ï¼Œæˆ‘ä»¬å¾—ä»¥åœ¨æ¯å¸§æ›´æ–°æ—¶å®ç°æ— é—ªçƒæ•ˆæœã€‚ä½†è¿™ä»éœ€å¤§é‡æŠ€å·§ä¸åè°ƒé…åˆã€‚</p>
<p>åœ¨ä¸Šå›¾ä¸­ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ç©ºç™½åŒºåŸŸå…·æœ‰åŠ¨æ€ç‰¹æ€§ã€‚å…¶é«˜åº¦å–å†³äºé”®ç›˜çš„å±•å¼€çŠ¶æ€ã€‚ç”±äºåŠ©æ‰‹æ¶ˆæ¯ä»¥ä¸å¯é¢„æµ‹çš„å¤§å°å¿«é€Ÿæµå¼ä¼ è¾“ï¼Œæ¯æ¬¡æ¸²æŸ“æ—¶ç©ºç™½åŒºåŸŸéƒ½å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>åŠ¨æ€é«˜åº¦æ˜¯è™šæ‹ŸåŒ–åˆ—è¡¨çš„å¸¸è§éš¾é¢˜ï¼Œè€Œé¢‘ç¹æ›´æ–°çš„ç©ºç™½åŒºåŸŸå°†è¿™ä¸€æŒ‘æˆ˜æ¨å‘æ–°é«˜åº¦ï¼šæˆ‘ä»¬çš„åˆ—è¡¨é¡¹å…·æœ‰åŠ¨æ€æœªçŸ¥é«˜åº¦ä¸”æ›´æ–°é¢‘ç¹ï¼ŒåŒæ—¶éœ€è¦ä¿æŒé¡¶éƒ¨æ‚¬æµ®çŠ¶æ€ã€‚</p>
<p>å½“åŠ©æ‰‹æ¶ˆæ¯è¶³å¤Ÿé•¿æ—¶ï¼Œç©ºç™½åŒºåŸŸå¯èƒ½å½’é›¶ï¼Œè¿™åˆå¼•å…¥äº†ä¸€ç³»åˆ—æ–°çš„è¾¹ç•Œæƒ…å†µã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25dc6079dc594ebaaab9b962fe49cf53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=VPlLLK1IeCXtwgR6AAmK8xQyLWI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜</h3>
<p>æˆ‘ä»¬å°è¯•äº†å¤šç§å®ç°ç©ºç™½åŒºåŸŸçš„æ–¹æ³•ï¼šåœ¨ <code>ScrollView</code> åº•éƒ¨æ·»åŠ å¸¦é«˜åº¦çš„ <code>View</code>ã€ä¸º <code>ScrollView</code> æœ¬èº«è®¾ç½®åº•éƒ¨å¡«å……ã€å¯¹å¯æ»šåŠ¨å†…å®¹åº”ç”¨ <code>translateY</code> å±æ€§ã€ä»¥åŠåœ¨æœ€åä¸€æ¡ç³»ç»Ÿæ¶ˆæ¯è®¾ç½®æœ€å°é«˜åº¦ã€‚è¿™äº›æ–¹æ¡ˆæœ€ç»ˆéƒ½å¯¼è‡´äº†å¥‡æ€ªçš„å‰¯ä½œç”¨å’Œæ€§èƒ½é—®é¢˜ï¼Œé€šå¸¸æºäºéœ€è¦é…åˆYogaå¸ƒå±€å¼•æ“è¿›è¡Œæ¸²æŸ“ã€‚</p>
<p>æœ€ç»ˆæˆ‘ä»¬é‡‡ç”¨ <code>ScrollView</code> çš„ <code>contentInset</code> å±æ€§æ¥å¤„ç†ç©ºç™½åŒºåŸŸï¼Œé¿å…äº†æŠ–åŠ¨ç°è±¡ã€‚<code>contentInset</code> å±æ€§ç›´æ¥æ˜ å°„è‡³ UIKit ä¸­ <code>UIScrollView</code> çš„åŸç”Ÿå±æ€§ã€‚</p>
<p>åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬ç»“åˆä½¿ç”¨ <code>contentInset</code> ä¸ <code>scrollToEnd({ offset })</code> æ–¹æ³•ã€‚</p>
<p>åŠ©æ‰‹æ¶ˆæ¯çš„ç©ºç™½åŒºåŸŸç”±ä¸‰éƒ¨åˆ†å…±åŒå†³å®šï¼šå…¶è‡ªèº«é«˜åº¦ã€å‰ç½®ç”¨æˆ·æ¶ˆæ¯çš„é«˜åº¦ï¼Œä»¥åŠèŠå¤©å®¹å™¨çš„é«˜åº¦ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f73973e26c94dc3b498078957e3c8b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=aEvSjOVqDEj7%2Baupgc%2FWefACoyE%3D" alt="" loading="lazy"/></p>
<p><strong>å®ç° <code>useMessageBlankSize</code></strong></p>
<p>è¦å®ç°ç©ºç™½å°ºå¯¸åŠŸèƒ½ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨åŠ©æ‰‹æ¶ˆæ¯ä¸­ä½¿ç”¨åä¸º <code>useMessageBlankSize</code> çš„é’©å­ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">AssistantMessage</span>(<span class="hljs-params">{ message, index }</span>) {
  <span class="hljs-comment">// ...styling logic</span>
  <span class="hljs-keyword">const</span> { onLayout, ref } = <span class="hljs-title function_">useMessageBlankSize</span>({ index })
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{ref}</span> <span class="hljs-attr">onLayout</span>=<span class="hljs-string">{onLayout}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AssistantMessageContent</span> <span class="hljs-attr">message</span>=<span class="hljs-string">{message}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Animated.View</span>&gt;</span></span>
  )
}
</code></pre>
<p><code>useMessageBlankSize</code> è´Ÿè´£ä»¥ä¸‹é€»è¾‘ï¼š</p>
<ul>
<li>åŒæ­¥æµ‹é‡åŠ©æ‰‹æ¶ˆæ¯</li>
<li>æµ‹é‡å…¶å‰æ–¹çš„ç”¨æˆ·æ¶ˆæ¯</li>
<li>è®¡ç®—åŠ©æ‰‹æ¶ˆæ¯ä¸‹æ–¹ç©ºç™½åŒºåŸŸçš„æœ€å°è·ç¦»</li>
<li>è®°å½•é”®ç›˜å±•å¼€æˆ–æ”¶èµ·æ—¶åº”è®¾ç½®çš„ç©ºç™½åŒºåŸŸå¤§å°</li>
<li>åœ¨æ ¹ä¸Šä¸‹æ–‡æä¾›è€…ä¸­è®¾ç½®å…±äº«çš„ <code>blankSize</code> å€¼</li>
</ul>
<p>æœ€åï¼Œæˆ‘ä»¬è·å– <code>blankSize</code> å¤§å°å¹¶å°†å…¶ä¼ é€’ç»™ <code>ScrollView</code> çš„å†…å®¹ <code>contentInset</code>ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">MessagesList</span>(<span class="hljs-params">props</span>) {
  <span class="hljs-keyword">const</span> { blankSize, composerHeight, keyboardHeight } = <span class="hljs-title function_">useMessageListContext</span>()

  <span class="hljs-keyword">const</span> animatedProps = <span class="hljs-title function_">useAnimatedProps</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">contentInset</span>: {
        <span class="hljs-attr">bottom</span>: blankSize.<span class="hljs-title function_">get</span>() + composerHeight.<span class="hljs-title function_">get</span>() + keyboardHeight.<span class="hljs-title function_">get</span>(),
      },
    }
  })

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AnimatedLegendList</span> {<span class="hljs-attr">...props</span>} <span class="hljs-attr">animatedProps</span>=<span class="hljs-string">{animatedProps}</span> /&gt;</span></span>
}
</code></pre>
<p>Reanimated çš„ <code>useAnimatedProps</code> åŠŸèƒ½è®©æˆ‘ä»¬èƒ½åœ¨æ¯ä¸ªå¸§ä¸Šæ›´æ–° UI çº¿ç¨‹çš„ propsï¼Œè€Œä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚<code>contentInset</code> å±•ç°äº†å“è¶Šçš„æ€§èƒ½è¡¨ç°ï¼Œè¿œèƒœäºä»¥å¾€æ‰€æœ‰å°è¯•ã€‚</p>
<h2 data-id="heading-6">é©¯æœé”®ç›˜</h2>
<p>æ‰“é€ ä¼˜è´¨çš„èŠå¤©ä½“éªŒï¼Œå…³é”®åœ¨äºä¼˜é›…çš„é”®ç›˜å¤„ç†ã€‚åœ¨React Nativeä¸­å®ç°<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Ffernandorojo%2Fstatus%2F1857403323738927329" target="_blank" title="https://x.com/fernandorojo/status/1857403323738927329" ref="nofollow noopener noreferrer">åŸç”Ÿèˆ¬çš„æ“ä½œä½“éªŒ</a>æ›¾æ˜¯è‰°å·¨è€Œç¹ççš„ä»»åŠ¡ã€‚å½“v0 iOSå¤„äºå…¬å¼€æµ‹è¯•é˜¶æ®µæ—¶ï¼Œè‹¹æœå‘å¸ƒäº†iOS 26ã€‚æ¯æ¬¡iOSæµ‹è¯•ç‰ˆæ›´æ–°ï¼Œæˆ‘ä»¬çš„èŠå¤©åŠŸèƒ½ä¼¼ä¹éƒ½ä¼šå½»åº•å´©æºƒã€‚æ¯æ¬¡iOSç‰ˆæœ¬å‘å¸ƒï¼Œéƒ½å˜æˆä¸€åœºè¿½é€ç»†å¾®å·®å¼‚å’ŒæŠ–åŠ¨çš„çŒ«é¼ æ¸¸æˆã€‚</p>
<p>æ‰€å¹¸ï¼Œ<code>react-native-keyboard-controller</code> çš„ç»´æŠ¤è€… <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkirillzyusko" target="_blank" title="https://github.com/kirillzyusko" ref="nofollow noopener noreferrer">Kiryl</a> ååŠ©æˆ‘ä»¬è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œé€šå¸¸åœ¨è‹¹æœå‘å¸ƒæ–°æµ‹è¯•ç‰ˆåçš„ 24 å°æ—¶å†…å°±æ›´æ–°äº†åº“æ–‡ä»¶ã€‚</p>
<p><strong>æ„å»º<code>useKeyboardAwareMessageList</code></strong></p>
<p>æˆ‘ä»¬åˆ©ç”¨React Nativeé”®ç›˜æ§åˆ¶å™¨æä¾›çš„å¤šä¸ªé’©å­ï¼Œæ„å»ºäº†ä¸“ä¸ºv0ç‰ˆæœ¬èŠå¤©åŠŸèƒ½å®šåˆ¶çš„é”®ç›˜ç®¡ç†ç³»ç»Ÿã€‚</p>
<p><code>useKeyboardAwareMessageList</code> æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„Reacté’©å­ï¼Œè´Ÿè´£æ‰€æœ‰é”®ç›˜å¤„ç†é€»è¾‘ã€‚å®ƒä¸èŠå¤©åˆ—è¡¨å¹¶è¡Œæ¸²æŸ“ï¼Œå¹¶æŠ½è±¡åŒ–äº†æ‰€æœ‰ç¡®ä¿é”®ç›˜äº¤äº’ä½“éªŒçš„å…³é”®ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MessagesList</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">useKeyboardAwareMessageList</span>()
  
  <span class="hljs-comment">// ...rest of the message list</span>
}
</code></pre>
<p>è™½ç„¶è¯¥åŠŸèƒ½çš„è°ƒç”¨ä»…éœ€ä¸€è¡Œä»£ç ï¼Œä½†å…¶å†…éƒ¨å®ç°åŒ…å«çº¦1000è¡Œä»£ç åŠå¤§é‡å•å…ƒæµ‹è¯•ã€‚<code>useKeyboardAwareMessageList</code> ä¸»è¦ä¾èµ–ä¸Šæ¸¸çš„ <code>useKeyboardHandler</code> å¤„ç† <code>onStart</code>ã€<code>onEnd</code> å’Œ <code>onInteractive</code> ç­‰äº‹ä»¶ï¼ŒåŒæ—¶ç»“åˆå¤šæ¬¡è°ƒç”¨Reanimatedçš„ <code>useAnimatedReaction</code> æ–¹æ³•ï¼Œåœ¨ç‰¹å®šè¾¹ç•Œæ¡ä»¶ä¸‹é‡è¯•äº‹ä»¶ã€‚</p>
<p>è¯¥ç»„ä»¶è¿˜å¤„ç†äº†iOSç³»ç»Ÿä¸­çš„è‹¥å¹²å¼‚å¸¸è¡Œä¸ºã€‚ä¾‹å¦‚å½“é”®ç›˜å¼€å¯æ—¶å°†åº”ç”¨åˆ‡æ¢è‡³åå°ï¼Œéšåé‡æ–°èšç„¦åº”ç”¨æ—¶ï¼ŒiOSä¼šè«åè§¦å‘ä¸‰æ¬¡é”®ç›˜ <code>onEnd</code> äº‹ä»¶ã€‚ç”±äºæˆ‘ä»¬ä¾èµ–å‘½ä»¤å¼è¡Œä¸ºå¤„ç†äº‹ä»¶è§¦å‘ï¼Œå› æ­¤è®¾è®¡äº†ç‰¹æ®Šæœºåˆ¶æ¥æ¶ˆé™¤é‡å¤äº‹ä»¶å¹¶è¿½è¸ªåº”ç”¨çŠ¶æ€å˜åŒ–ã€‚</p>
<p><code>useKeyboardAwareMessageList</code> å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ol>
<li>é”®ç›˜å¼¹å‡ºæ—¶ç¼©å°<code>blankSize</code></li>
<li>è‹¥æ»šåŠ¨è‡³èŠå¤©æœ«å°¾ä¸”æ— ç©ºç™½åŒºåŸŸï¼Œåˆ™é”®ç›˜å¼¹å‡ºæ—¶å°†å†…å®¹å‘ä¸Šç§»åŠ¨</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71ffab8bd7074da988bee4bea0a1f544~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=BVQDwwEMOVOBHEbeQSgOBBvKmcA%3D" alt="image.png" loading="lazy"/></p>
<ol start="3">
<li>è‹¥æ»šåŠ¨åˆ°è¶³å¤Ÿé«˜çš„ä½ç½®ä¸”æ²¡æœ‰ç©ºç™½åŒºåŸŸï¼Œåˆ™åœ¨å†…å®¹ä¸Šæ–¹æ˜¾ç¤ºé”®ç›˜ï¼Œä¸”ä¸ç§»åŠ¨å†…å®¹æœ¬èº«ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dfda25a2568e4fd3b211d1f409c50acf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=1dk%2BSG9s4LfjAbdZ9K2SLMczrp8%3D" alt="image.png" loading="lazy"/></p>
<ol start="4">
<li>å½“ç”¨æˆ·é€šè¿‡æ»šåŠ¨è§†å›¾æˆ–æ–‡æœ¬è¾“å…¥äº¤äº’å¼åœ°å…³é—­é”®ç›˜æ—¶ï¼Œå°†å…¶å¹³æ»‘åœ°å‘ä¸‹æ‹–åŠ¨ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/357a8f1f2db24658aca9ef0d1d2f6793~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=MEdeBcrRs0bfyb9FxXcY46qZhSw%3D" alt="image.png" loading="lazy"/></p>
<ol start="5">
<li>è‹¥å·²æ»šåŠ¨è‡³èŠå¤©çª—å£æœ«å°¾ï¼Œä¸”ç©ºç™½åŒºåŸŸå¤§äºé”®ç›˜å°ºå¯¸ï¼Œå†…å®¹åº”ä¿æŒåŸä½ä¸å˜ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da5263af8bcf421f8a147c7d49d7bf20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=uwJ%2B%2FleitriUQx4GtfAke0GVdV0%3D" alt="image.png" loading="lazy"/></p>
<ol start="6">
<li>è‹¥æ»šåŠ¨è‡³èŠå¤©çª—å£åº•éƒ¨æ—¶ç©ºç™½åŒºåŸŸå¤§äºé›¶ï¼Œä½†é”®ç›˜å±•å¼€æ—¶è¯¥åŒºåŸŸåº”ä¸ºé›¶ï¼Œåˆ™å°†å†…å®¹ä¸Šç§»è‡³é”®ç›˜ä¸Šæ–¹ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65e0aae7521c4c688281cc052cc32013~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=FJli39%2BSknkp4HrH8VRGSeQX%2F38%3D" alt="image.png" loading="lazy"/></p>
<p>è¦è®©è¿™ä¸€åˆ‡é¡ºåˆ©è¿è¡Œï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆä¸€åŠ³æ°¸é€¸çš„è¯€çªã€‚æˆ‘ä»¬è€—è´¹æ•°åå°æ—¶åå¤ä½¿ç”¨è¿™æ¬¾åº”ç”¨ï¼Œå‘ç°ç¼ºé™·ã€è¿½è¸ªé—®é¢˜ï¼Œä¸æ–­é‡å†™é€»è¾‘ï¼Œç›´åˆ°æ„Ÿè§‰ä¸€åˆ‡éƒ½æ°åˆ°å¥½å¤„ã€‚</p>
<h2 data-id="heading-7">åˆå§‹æ»šåŠ¨è‡³æœ«å°¾</h2>
<p>å½“æ‚¨æ‰“å¼€ç°æœ‰èŠå¤©æ—¶ï¼Œv0ç‰ˆæœ¬ä¼šå°†èŠå¤©ç•Œé¢æ»šåŠ¨è‡³æœ«å°¾ã€‚è¿™ç±»ä¼¼äºåœ¨React Nativeçš„ <code>FlatList</code> ä¸­ä½¿ç”¨ <code>inverted</code> å±æ€§ï¼Œè¿™ç§è®¾è®¡å¸¸è§äºè‡ªä¸‹è€Œä¸Šçš„èŠå¤©ç•Œé¢ã€‚</p>
<p>ç„¶è€Œæˆ‘ä»¬æœ€ç»ˆæ”¾å¼ƒäº† <code>inverted</code> æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒä¸AIèŠå¤©åœºæ™¯å­˜åœ¨å†²çªâ€”â€”AIèŠå¤©æ¯ç§’ä¼šäº§ç”Ÿå¤šæ¬¡æ¶ˆæ¯æµã€‚æˆ‘ä»¬é€‰æ‹©ä¸é‡‡ç”¨åŠ©æ‰‹æ¶ˆæ¯æµè‡ªåŠ¨æ»šåŠ¨æ–¹æ¡ˆï¼Œè€Œæ˜¯è®©å†…å®¹è‡ªç„¶å¡«å……åœ¨é”®ç›˜ä¸‹æ–¹åŒºåŸŸï¼Œå¹¶é…æœ‰æ»šåŠ¨è‡³æœ«å°¾çš„æŒ‰é’®ã€‚æ­¤è®¾è®¡ä¸ChatGPTçš„iOSåº”ç”¨è¡Œä¸ºä¸€è‡´ã€‚</p>
<p>ä½†æˆ‘ä»¬ä»å¸Œæœ›åœ¨é¦–æ¬¡æ‰“å¼€ç°æœ‰èŠå¤©æ—¶æä¾›å€’åºåˆ—è¡¨å¼ä½“éªŒã€‚ä¸ºæ­¤ï¼Œå½“èŠå¤©é¦–æ¬¡å¯è§æ—¶ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ <code>scrollToEnd</code> æ–¹æ³•å®ç°æ»šåŠ¨è‡³æœ«å°¾çš„æ•ˆæœã€‚</p>
<p>ç”±äºåŠ¨æ€æ¶ˆæ¯é«˜åº¦ä¸ç©ºç™½åŒºåŸŸçš„å¤æ‚ç»„åˆï¼Œæˆ‘ä»¬ä¸å¾—ä¸å¤šæ¬¡è°ƒç”¨ <code>scrollToEnd</code> æ–¹æ³•ã€‚è‹¥ä¸å¦‚æ­¤æ“ä½œï¼Œåˆ—è¡¨è¦ä¹ˆæ— æ³•æ­£å¸¸æ»šåŠ¨ï¼Œè¦ä¹ˆæ»šåŠ¨æ—¶æœºè¿‡æ™šã€‚å†…å®¹å®Œæˆæ»šåŠ¨åï¼Œæˆ‘ä»¬è°ƒç”¨ <code>hasScrolledToEnd.set(true) </code>æ–¹æ³•ï¼Œä½¿èŠå¤©å†…å®¹æ¸æ˜¾ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">import</span> { scheduleOnRN } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native-worklets'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useInitialScrollToEnd</span>(<span class="hljs-params">blankSize, scrollToEnd, hasMessages</span>) {
  <span class="hljs-keyword">const</span> hasStartedScrolledToEnd = <span class="hljs-title function_">useSharedValue</span>(<span class="hljs-literal">false</span>)
  <span class="hljs-keyword">const</span> hasScrolledToEnd = <span class="hljs-title function_">useSharedValue</span>(<span class="hljs-literal">false</span>)
  <span class="hljs-keyword">const</span> scrollToEndJS = <span class="hljs-title function_">useLatestCallback</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">scrollToEnd</span>({ <span class="hljs-attr">animated</span>: <span class="hljs-literal">false</span> })
    <span class="hljs-comment">// Do another one just in case because the list may not have fully laid out yet</span>
    <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">scrollToEnd</span>({ <span class="hljs-attr">animated</span>: <span class="hljs-literal">false</span> })

      <span class="hljs-comment">// and another one again in case</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">scrollToEnd</span>({ <span class="hljs-attr">animated</span>: <span class="hljs-literal">false</span> })

        <span class="hljs-comment">// and yet another!</span>
        <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
          hasScrolledToEnd.<span class="hljs-title function_">set</span>(<span class="hljs-literal">true</span>)
        })
      }, <span class="hljs-number">16</span>)
    })
  })

  <span class="hljs-title function_">useAnimatedReaction</span>(
    <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (hasStartedScrolledToEnd.<span class="hljs-title function_">get</span>() || !hasMessages) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
      }
      <span class="hljs-keyword">return</span> blankSize.<span class="hljs-title function_">get</span>() &gt; <span class="hljs-number">0</span>
    },
    <span class="hljs-function">(<span class="hljs-params">shouldScroll</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (shouldScroll) {
        hasStartedScrolledToEnd.<span class="hljs-title function_">set</span>(<span class="hljs-literal">true</span>)
        <span class="hljs-title function_">scheduleOnRN</span>(scrollToEndJS)
      }
    }
  )

  <span class="hljs-keyword">return</span> hasScrolledToEnd
}
</code></pre>
<h2 data-id="heading-8">æ¼‚æµ®ç¼–è¾‘å™¨</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7885b2de806b473aa012cb90b8a14007~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=aeuNnWVBL738OhKEZL26p1H8bUk%3D" alt="image.png" loading="lazy"/></p>
<p>å—iOS 26ä¸­iMessageåº•éƒ¨å·¥å…·æ çš„å¯å‘ï¼Œæˆ‘ä»¬æ‰“é€ äº†ä¸€æ¬¾é‡‡ç”¨æ¸è¿›å¼æ¨¡ç³Šæ•ˆæœçš„æ¶²æ€ç»ç’ƒç¼–è¾‘å™¨ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨<code>@callstack/liquid-glass</code>åº“å®ç°äº†äº¤äº’å¼æ¶²æ€ç»ç’ƒæ•ˆæœã€‚é€šè¿‡ç”¨ <code>LiquidGlassContainerView</code> åŒ…è£¹ç»ç’ƒè§†å›¾ï¼Œå³å¯è‡ªåŠ¨è·å¾—è§†å›¾å˜å½¢æ•ˆæœã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">&lt;<span class="hljs-title class_">LiquidGlassContainerView</span> spacing={<span class="hljs-number">8</span>}&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LiquidGlassView</span> <span class="hljs-attr">interactive</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">LiquidGlassView</span>&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LiquidGlassView</span> <span class="hljs-attr">interactive</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">LiquidGlassView</span>&gt;</span></span>
&lt;/<span class="hljs-title class_">LiquidGlassContainerView</span>&gt;
</code></pre>
<h3 data-id="heading-9">æ‚¬æµ®</h3>
<p>æ·»åŠ æ¶²ä½“ç»ç’ƒåï¼Œä¸‹ä¸€æ­¥æ˜¯è®©å®ƒæ¼‚æµ®åœ¨èŠå¤©å†…å®¹çš„é¡¶éƒ¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f84dfbccbbb46bca64862705ee1d949~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=5QzTMdC4dBvfGnvfK4gwhwKgiRw%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸ºä½¿ç¼–è¾‘å™¨æ‚¬æµ®äºå¯æ»šåŠ¨å†…å®¹ä¹‹ä¸Šï¼Œæˆ‘ä»¬é‡‡å–äº†ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>åœ¨ç¼–è¾‘å™¨ä¸­æ·»åŠ ï¼š<code>position: absolute; bottom: 0</code></li>
<li>ä½¿ç”¨ <code>react-native-keyboard-controller</code> ä¸­çš„ <code>KeyboardStickyView</code> åŒ…è£¹ç¼–è¾‘å™¨</li>
<li>åŒæ­¥æµ‹é‡ç¼–è¾‘å™¨é«˜åº¦ï¼Œå¹¶é€šè¿‡å…±äº«å€¼å°†å…¶å­˜å‚¨åœ¨ä¸Šä¸‹æ–‡ä¸­</li>
<li>å°† <code>composerHeight.get()</code> æ·»åŠ åˆ° ScrollView çš„åŸç”Ÿ <code>contentInset.bottom</code> å±æ€§ä¸­</li>
</ol>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Composer</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { composerHeight } = <span class="hljs-title function_">useComposerHeightContext</span>()
  <span class="hljs-keyword">const</span> { onLayout, ref } = <span class="hljs-title function_">useSyncLayoutHandler</span>(<span class="hljs-function">(<span class="hljs-params">layout</span>) =&gt;</span> {
    composerHeight.<span class="hljs-title function_">set</span>(layout.<span class="hljs-property">height</span>)
  })
  <span class="hljs-keyword">const</span> insets = <span class="hljs-title function_">useInsets</span>()

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">KeyboardStickyView</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">position:</span> '<span class="hljs-attr">absolute</span>', <span class="hljs-attr">bottom:</span> <span class="hljs-attr">0</span>, <span class="hljs-attr">left:</span> <span class="hljs-attr">0</span>, <span class="hljs-attr">right:</span> <span class="hljs-attr">0</span> }}
      <span class="hljs-attr">offset</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">closed:</span> <span class="hljs-attr">-insets.bottom</span>, <span class="hljs-attr">opened:</span> <span class="hljs-attr">-8</span> }}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">View</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">{ref}</span>
        <span class="hljs-attr">onLayout</span>=<span class="hljs-string">{onLayout}</span>
      &gt;</span>
        {/* ... */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">KeyboardStickyView</span>&gt;</span></span>
  )
}
</code></pre>
<p>ç„¶è€Œè¿™è¿˜ä¸å¤Ÿã€‚æˆ‘ä»¬ä»ç¼ºå°‘ä¸€ä¸ªå…³é”®è¡Œä¸ºã€‚</p>
<p>å½“æ‚¨è¾“å…¥æ–‡å­—æ—¶ï¼Œæ–‡æœ¬è¾“å…¥æ¡†çš„é«˜åº¦ä¼šéšä¹‹å¢åŠ ã€‚å½“æ‚¨è¾“å…¥æ–°è¡Œæ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿåœ¨å¸¸è§„éç»å¯¹å®šä½è¾“å…¥æ¡†ä¸­çš„è¾“å…¥ä½“éªŒã€‚ä¸ºæ­¤æˆ‘ä»¬å¿…é¡»æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œåœ¨æ‚¨æ»šåŠ¨åˆ°èŠå¤©è®°å½•æœ«å°¾æ—¶å°†èŠå¤©å†…å®¹å‘ä¸Šç§»åŠ¨ã€‚</p>
<p>åœ¨ä¸‹é¢çš„è§†é¢‘ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸¤ç§æƒ…å†µã€‚è§†é¢‘å¼€å§‹æ—¶ï¼Œç”±äºèŠå¤©æ»šåŠ¨åˆ°æœ«å°¾ï¼Œå†…å®¹ä¼šéšç€æ–°è¡Œå‘ä¸Šç§»åŠ¨ã€‚ç„¶è€Œï¼Œåœ¨èŠå¤©ä¸­å‘ä¸Šæ»šåŠ¨åï¼Œè¾“å…¥æ–°è¡Œä¸ä¼šç§»åŠ¨å†…å®¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb9018a64d9841349aff1ae908797f73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=Wcmf5%2B0SvRaZI310tNCi202Y%2F3M%3D" alt="image.png" loading="lazy"/></p>
<p><strong><code>useScrollWhenComposerSizeUpdates</code></strong></p>
<p>ä½¿ç”¨<code>useScrollWhenComposerSizeUpdates</code>é’©å­ã€‚è¯¥é’©å­ç›‘å¬ç»„åˆå™¨é«˜åº¦å˜åŒ–ï¼Œå¹¶åœ¨éœ€è¦æ—¶è‡ªåŠ¨æ»šåŠ¨è‡³æœ«å°¾ã€‚è¦ä½¿ç”¨å®ƒï¼Œåªéœ€åœ¨<code>MessagesList</code>ä¸­è°ƒç”¨å³å¯ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">MessagesList</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">useScrollWhenComposerSizeUpdates</span>()
 
  <span class="hljs-comment">// ...message list code  </span>
}
</code></pre>
<p>é¦–å…ˆï¼Œå®ƒé€šè¿‡ <code>useAnimatedReaction</code> è®¾ç½®æ•ˆæœæ¥è¿½è¸ªç¼–è¾‘å™¨é«˜åº¦å˜åŒ–ã€‚</p>
<p>æ¥ç€è°ƒç”¨ <code>autoscrollToEnd</code> æ–¹æ³•ã€‚åªè¦ä½ é è¿‘å¯æ»šåŠ¨åŒºåŸŸçš„æœ«å°¾ï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨æ»šåŠ¨è‡³èŠå¤©çª—å£åº•éƒ¨ã€‚è‹¥æ— æ­¤æœºåˆ¶ï¼Œåœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥æ–°è¡Œæ—¶å†…å®¹ä¼šè¦†ç›–å¯æ»šåŠ¨åŒºåŸŸçš„åº•éƒ¨ã€‚</p>
<p><code>useScrollWhenComposerSizeUpdates</code> è®©æˆ‘ä»¬èƒ½å¤Ÿæ¡ä»¶æ€§åœ°æ¨¡æ‹Ÿéç»å¯¹å®šä½è§†å›¾çš„äº¤äº’ä½“éªŒã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useScrollWhenComposerSizeUpdates</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { listRef, scrollToEnd } = <span class="hljs-title function_">useMessageListContext</span>()
  <span class="hljs-keyword">const</span> { composerHeight } = <span class="hljs-title function_">useComposerHeightContext</span>()

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">autoscrollToEnd</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> list = listRef.<span class="hljs-property">current</span>
    <span class="hljs-keyword">if</span> (!list) {
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">const</span> state = list.<span class="hljs-title function_">getState</span>()
    <span class="hljs-keyword">const</span> distanceFromEnd =
      state.<span class="hljs-property">contentLength</span> - state.<span class="hljs-property">scroll</span> - state.<span class="hljs-property">scrollLength</span>

    <span class="hljs-keyword">if</span> (distanceFromEnd &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-title function_">scrollToEnd</span>({ <span class="hljs-attr">animated</span>: <span class="hljs-literal">false</span> })
      <span class="hljs-comment">// wait a frame for LegendList to update, and fire it again</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">scrollToEnd</span>({ <span class="hljs-attr">animated</span>: <span class="hljs-literal">false</span> })
      }, <span class="hljs-number">16</span>)
    }
  }

  <span class="hljs-title function_">useAnimatedReaction</span>(
    <span class="hljs-function">() =&gt;</span> composerHeight.<span class="hljs-title function_">get</span>(),
    <span class="hljs-function">(<span class="hljs-params">height, prevHeight</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (height &gt; <span class="hljs-number">0</span> &amp;&amp; height !== prevHeight) {
        <span class="hljs-title function_">scheduleOnRN</span>(autoscrollToEnd)
      }
    }
  )
}
</code></pre>
<p>æ­£å¦‚æˆ‘ä»¬åœ¨ä¹‹å‰çš„ä»£ç ä¸­æ‰€è§ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ä¾èµ–å¤šä¸ª <code>setTimeout</code> å’Œ <code>requestAnimationFrame</code> è°ƒç”¨æ¥å®ç° <code>scrollToEnd</code> åŠŸèƒ½ã€‚è¿™æ®µä»£ç éš¾å…ä¼šè®©äººæ„Ÿåˆ°å›°æƒ‘ï¼Œä½†å½“æ—¶è¿™æ˜¯å”¯ä¸€èƒ½è®©æ»šåŠ¨ç»“æŸåŠŸèƒ½æ­£å¸¸è¿ä½œçš„æ–¹æ³•ã€‚æˆ‘ä»¬æ­£ä¸ LegendList çš„ç»´æŠ¤è€… <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjmeistrich" target="_blank" title="https://github.com/jmeistrich" ref="nofollow noopener noreferrer">Jay</a> ç§¯æåˆä½œï¼Œè‡´åŠ›äºæ„å»ºæ›´å¯é çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-10">é€¼è¿‘åŸç”Ÿä½“éªŒ</h3>
<p>React Nativeå†…ç½®çš„ <code>TextInput</code> ç»„ä»¶åœ¨åŸç”ŸèŠå¤©åº”ç”¨ä¸­æ˜¾å¾—æ ¼æ ¼ä¸å…¥ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“è®¾ç½®<code>multiline={true}</code>æ—¶ï¼Œ<code>TextInput</code> ä¼šæ˜¾ç¤ºéš¾çœ‹çš„æ»šåŠ¨æŒ‡ç¤ºå™¨ï¼Œè¿™ä¸å¤§å¤šæ•°èŠå¤©åº”ç”¨ä¸ç¬¦ã€‚åœ¨è¾“å…¥æ¡†ä¸Šä¸‹æ»‘åŠ¨ä¼šå¯¼è‡´å†…éƒ¨å†…å®¹å¼¹è·³ï¼Œå³ä½¿å°šæœªè¾“å…¥ä»»ä½•æ–‡æœ¬ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ­¤å¤–ï¼Œè¯¥è¾“å…¥æ¡†ä¸æ”¯æŒäº¤äº’å¼é”®ç›˜å…³é—­åŠŸèƒ½ã€‚</p>
<p>ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨åŸç”Ÿä»£ç ä¸­ä¸º <code>RCTUITextView</code> åº”ç”¨äº†è¡¥ä¸ã€‚è¯¥è¡¥ä¸ç¦ç”¨äº†æ»šåŠ¨æŒ‡ç¤ºå™¨ï¼Œç§»é™¤äº†å¼¹è·³æ•ˆæœï¼Œå¹¶å¯ç”¨äº†äº¤äº’å¼é”®ç›˜å…³é—­åŠŸèƒ½ã€‚</p>
<p>æˆ‘ä»¬çš„è¡¥ä¸è¿˜æ–°å¢äº†å‘ä¸Šæ»‘åŠ¨èšç„¦è¾“å…¥åŒºåŸŸçš„åŠŸèƒ½ã€‚åœ¨è§‚å¯Ÿæµ‹è¯•äººå‘˜å› æœŸå¾…é”®ç›˜å¼¹å‡ºè€Œç„¦èºåœ°å‘ä¸Šæ»‘åŠ¨åï¼Œæˆ‘ä»¬æ„è¯†åˆ°è¿™ä¸ªåŠŸèƒ½çš„å¿…è¦æ€§ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">diff --git a/<span class="hljs-title class_">Libraries</span>/<span class="hljs-title class_">Text</span>/<span class="hljs-title class_">TextInput</span>/<span class="hljs-title class_">Multiline</span>/<span class="hljs-title class_">RCTUITextView</span>.<span class="hljs-property">mm</span> b/<span class="hljs-title class_">Libraries</span>/<span class="hljs-title class_">Text</span>/<span class="hljs-title class_">TextInput</span>/<span class="hljs-title class_">Multiline</span>/<span class="hljs-title class_">RCTUITextView</span>.<span class="hljs-property">mm</span>
index 6e9c3841cee19632eaa59ae2dbd541a85ce7cabf..<span class="hljs-property">e3f920acbc2bb074582ed2b531ddd90e2017d59c</span> <span class="hljs-number">100644</span>
--- a/<span class="hljs-title class_">Libraries</span>/<span class="hljs-title class_">Text</span>/<span class="hljs-title class_">TextInput</span>/<span class="hljs-title class_">Multiline</span>/<span class="hljs-title class_">RCTUITextView</span>.<span class="hljs-property">mm</span>
+++ b/<span class="hljs-title class_">Libraries</span>/<span class="hljs-title class_">Text</span>/<span class="hljs-title class_">TextInput</span>/<span class="hljs-title class_">Multiline</span>/<span class="hljs-title class_">RCTUITextView</span>.<span class="hljs-property">mm</span>
@@ -<span class="hljs-number">55</span>,<span class="hljs-number">6</span> +<span class="hljs-number">55</span>,<span class="hljs-number">16</span> @@ - (instancetype)<span class="hljs-attr">initWithFrame</span>:(<span class="hljs-title class_">CGRect</span>)frame
     self.<span class="hljs-property">textContainer</span>.<span class="hljs-property">lineFragmentPadding</span> = <span class="hljs-number">0</span>;
     self.<span class="hljs-property">scrollsToTop</span> = <span class="hljs-variable constant_">NO</span>;
     self.<span class="hljs-property">scrollEnabled</span> = <span class="hljs-variable constant_">YES</span>;
+
+    <span class="hljs-comment">// Fix bouncing, scroll indicator, and keyboard mode gesture</span>
+    self.<span class="hljs-property">showsVerticalScrollIndicator</span> = <span class="hljs-variable constant_">NO</span>;
+    self.<span class="hljs-property">showsHorizontalScrollIndicator</span> = <span class="hljs-variable constant_">NO</span>;
+    self.<span class="hljs-property">bounces</span> = <span class="hljs-variable constant_">NO</span>;
+    self.<span class="hljs-property">alwaysBounceVertical</span> = <span class="hljs-variable constant_">NO</span>;
+    self.<span class="hljs-property">alwaysBounceHorizontal</span> = <span class="hljs-variable constant_">NO</span>;
+    self.<span class="hljs-property">keyboardDismissMode</span> = <span class="hljs-title class_">UIScrollViewKeyboardDismissModeInteractive</span>;
+    [self.<span class="hljs-property">panGestureRecognizer</span> <span class="hljs-attr">addTarget</span>:self <span class="hljs-attr">action</span>:@<span class="hljs-title function_">selector</span>(<span class="hljs-attr">_handlePanToFocus</span>:)];
+
     _initialValueLeadingBarButtonGroups = nil;
     _initialValueTrailingBarButtonGroups = nil;
   }
@@ -<span class="hljs-number">62</span>,<span class="hljs-number">6</span> +<span class="hljs-number">72</span>,<span class="hljs-number">18</span> @@ - (instancetype)<span class="hljs-attr">initWithFrame</span>:(<span class="hljs-title class_">CGRect</span>)frame
   <span class="hljs-keyword">return</span> self;
 }
 
+- (<span class="hljs-keyword">void</span>)<span class="hljs-attr">_handlePanToFocus</span>:(<span class="hljs-title class_">UIPanGestureRecognizer</span> *)g
+{
+    <span class="hljs-keyword">if</span> (self.<span class="hljs-property">isFirstResponder</span>) { <span class="hljs-keyword">return</span>; }
+    <span class="hljs-keyword">if</span> (g.<span class="hljs-property">state</span> != <span class="hljs-title class_">UIGestureRecognizerStateBegan</span>) { <span class="hljs-keyword">return</span>; }
+    <span class="hljs-title class_">CGPoint</span> v = [g <span class="hljs-attr">velocityInView</span>:self];
+    <span class="hljs-title class_">CGPoint</span> t = [g <span class="hljs-attr">translationInView</span>:self];
+    <span class="hljs-comment">// Add pan gesture to focus the keyboard</span>
+    <span class="hljs-keyword">if</span> (v.<span class="hljs-property">y</span> &lt; -<span class="hljs-number">250.0</span> &amp;&amp; !self.<span class="hljs-property">isFirstResponder</span>) {
+        [self becomeFirstResponder];
+    }
+}
+
 - (<span class="hljs-keyword">void</span>)<span class="hljs-attr">setDelegate</span>:(id&lt;<span class="hljs-title class_">UITextViewDelegate</span>&gt;)delegate
 {
   <span class="hljs-comment">// Delegate is set inside `[RCTBackedTextViewDelegateAdapter initWithTextView]` and</span>
</code></pre>
<p>è™½ç„¶åœ¨React Nativeæ›´æ–°ä¸­ç»´æŠ¤è¡¥ä¸å¹¶éç†æƒ³æ–¹æ¡ˆï¼Œä½†è¿™æ˜¯æˆ‘ä»¬æ‰¾åˆ°çš„æœ€åˆ‡å®å¯è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬æ›´å¸Œæœ›å­˜åœ¨å®˜æ–¹APIæ¥æ‰©å±•åŸç”Ÿè§†å›¾è€Œæ— éœ€æ‰“è¡¥ä¸ï¼Œè‹¥ç¤¾åŒºå¯¹æ­¤æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬è®¡åˆ’å°†æ­¤è¡¥ä¸è´¡çŒ®ç»™React Nativeæ ¸å¿ƒå›¢é˜Ÿã€‚</p>
<h3 data-id="heading-11">ç²˜è´´å›¾ç‰‡</h3>
<p>ä¸ºæ”¯æŒåœ¨æ–‡æœ¬è¾“å…¥æ¡†ä¸­ç²˜è´´å›¾ç‰‡å’Œæ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªExpoæ¨¡å—ï¼Œè¯¥æ¨¡å—ä¼šç›‘å¬æ¥è‡ªåŸç”Ÿ <code>UIPasteboard</code> çš„ç²˜è´´äº‹ä»¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/021a1dc39ea548e682c51bf9bea5111b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=8g5hcH2l1%2BMooc0wuUexQrywWPU%3D" alt="image.png" loading="lazy"/></p>
<p>è‹¥ç²˜è´´çš„æ–‡æœ¬è¶³å¤Ÿé•¿ï¼Œ<code>onPaste</code> å°†è‡ªåŠ¨å°†ç²˜è´´å†…å®¹è½¬æ¢ä¸º <code>.txt</code> æ–‡ä»¶é™„ä»¶ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">&lt;<span class="hljs-title class_">TextInputWrapper</span> onPaste={<span class="hljs-function"><span class="hljs-params">pasted</span> =&gt;</span> ...}&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TextInput</span> /&gt;</span></span>
&lt;/<span class="hljs-title class_">TextInputWrapper</span>&gt;
</code></pre>
<p>ç”±äºéš¾ä»¥åœ¨åŸç”Ÿä»£ç ä¸­æ‰©å±•ç°æœ‰çš„ <code>TextInput</code> ç»„ä»¶ï¼Œæˆ‘ä»¬é‡‡ç”¨äº† <code>TextInputWrapper</code> ç»„ä»¶â€”â€”å®ƒé€šè¿‡Swiftè¯­è¨€å°è£… <code>TextInput</code> å¹¶éå†å…¶ <code>subviews</code> ã€‚è‹¥éœ€æ·±å…¥äº†è§£åŸç”Ÿå°è£…ç»„ä»¶çš„åˆ›å»ºç¤ºä¾‹ï¼Œæ¬¢è¿è§‚çœ‹æˆ‘2024å¹´çš„æ¼”è®²<a href="https://link.juejin.cn?target=https%3A%2F%2Fyoutu.be%2FmG1Lv-RWds8%3Fsi%3DUCSHQQAnfsYGdr4P" target="_blank" title="https://youtu.be/mG1Lv-RWds8?si=UCSHQQAnfsYGdr4P" ref="nofollow noopener noreferrer">ã€Šå‹‡äºæ„å»ºåŸç”Ÿåº“ã€‹</a>ã€‚</p>
<h2 data-id="heading-12">æµåª’ä½“å†…å®¹æ¸éšæ•ˆæœ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d83d83be0e6445c19fa28379efaca990~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=RrZOJQXpOUleUO%2FyCeS3Qp%2B3u6M%3D" alt="image.png" loading="lazy"/></p>
<p>å½“AIåŠ©æ‰‹çš„æ¶ˆæ¯æµä¼ å…¥æ—¶ï¼Œå¿…é¡»ä¿æŒæµç•…ä½“éªŒã€‚ä¸ºå®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªç»„ä»¶ï¼š</p>
<ol>
<li><code>&lt;FadeInStaggeredIfStreaming /&gt;</code></li>
<li><code>&lt;TextFadeInStaggeredIfStreaming /&gt;</code></li>
</ol>
<p>åªè¦æŸä¸ªå…ƒç´ è¢«è¿™äº›ç»„ä»¶ä¹‹ä¸€åŒ…è£¹ï¼Œå…¶å­å…ƒç´ å°±ä¼šä»¥é”™è½æœ‰è‡´çš„åŠ¨ç”»æ•ˆæœå¹³æ»‘æ·¡å…¥ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> mdxComponents = {
  <span class="hljs-attr">a</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">A</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Elements.A</span> {<span class="hljs-attr">...props</span>}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextFadeInStaggeredIfStreaming</span>&gt;</span>
          {props.children}
        <span class="hljs-tag">&lt;/<span class="hljs-name">TextFadeInStaggeredIfStreaming</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Elements.A</span>&gt;</span></span>
    )
  },
  <span class="hljs-comment">// ...other components</span>
}
</code></pre>
<p>åœ¨åº•å±‚å®ç°ä¸­ï¼Œè¿™äº›ç»„ä»¶æ¸²æŸ“äº† <code>FadeInStaggered</code> çš„å˜ä½“ï¼Œè¯¥ç»„ä»¶è´Ÿè´£çŠ¶æ€ç®¡ç†ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> useIsAnimatedInPool = <span class="hljs-title function_">createUsePool</span>()

<span class="hljs-keyword">function</span> <span class="hljs-title function_">FadeInStaggered</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">const</span> { isActive, evict } = <span class="hljs-title function_">useIsAnimatedInPool</span>()
  <span class="hljs-keyword">return</span> isActive ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FadeIn</span> <span class="hljs-attr">onFadedIn</span>=<span class="hljs-string">{evict}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">FadeIn</span>&gt;</span></span> : children
}
</code></pre>
<p><code>useIsAnimatedInPool</code> æ˜¯ React å¤–éƒ¨çš„ä¸€ä¸ªè‡ªå®šä¹‰çŠ¶æ€ç®¡ç†å™¨ï¼Œå…è®¸åŒæ—¶æ¸²æŸ“æœ‰é™æ•°é‡çš„æœ‰åºå…ƒç´ ã€‚å…ƒç´ åœ¨æŒ‚è½½æ—¶è¯·æ±‚åŠ å…¥æ± ï¼Œ<code>isActive</code> å±æ€§æŒ‡ç¤ºå…¶æ˜¯å¦åº”æ¸²æŸ“åŠ¨ç”»èŠ‚ç‚¹ã€‚</p>
<p>å½“ <code>onFadedIn</code> å›è°ƒè§¦å‘åï¼Œæˆ‘ä»¬ä¼šå°†å…ƒç´ ä»æ± ä¸­ç§»é™¤ï¼Œç›´æ¥æ¸²æŸ“å…¶å­å…ƒç´ è€Œä¸ä½¿ç”¨åŠ¨ç”»åŒ…è£…å™¨ã€‚è¿™æœ‰åŠ©äºé™åˆ¶åŒæ—¶æ´»åŠ¨çš„åŠ¨ç”»èŠ‚ç‚¹æ•°é‡ã€‚</p>
<p>æœ€åï¼Œ<code>FadeIn</code> å®ç°äº¤é”™åŠ¨ç”»æ•ˆæœï¼Œå…ƒç´ é—´å»¶è¿Ÿä¸º 32 æ¯«ç§’ã€‚äº¤é”™åŠ¨ç”»æŒ‰è®¡åˆ’æ‰§è¡Œï¼Œæ¯æ¬¡æ‰¹é‡æ¸²æŸ“ 2 ä¸ªå…ƒç´ ã€‚å½“äº¤é”™å…ƒç´ é˜Ÿåˆ—è¶…è¿‡ 10 ä¸ªæ—¶ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®é˜Ÿåˆ—å¤§å°å¢åŠ æ‰¹å¤„ç†å…ƒç´ æ•°é‡ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> useStaggeredAnimation = <span class="hljs-title function_">createUseStaggered</span>(<span class="hljs-number">32</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">FadeIn</span>(<span class="hljs-params">{ children, onFadedIn, Component }</span>) {
  <span class="hljs-keyword">const</span> opacity = <span class="hljs-title function_">useSharedValue</span>(<span class="hljs-number">0</span>)

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">startAnimation</span> = (<span class="hljs-params"/>) =&gt; {
    opacity.<span class="hljs-title function_">set</span>(<span class="hljs-title function_">withTiming</span>(<span class="hljs-number">1</span>, { <span class="hljs-attr">duration</span>: <span class="hljs-number">500</span> }))
    <span class="hljs-built_in">setTimeout</span>(onFadedIn, <span class="hljs-number">500</span>)
  }

  <span class="hljs-title function_">useStaggeredAnimation</span>(startAnimation)

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">opacity</span> }}&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">Component</span>&gt;</span></span>
}
</code></pre>
<p><code>TextFadeInStaggeredIfStreaming</code> é‡‡ç”¨ç±»ä¼¼ç­–ç•¥ã€‚æˆ‘ä»¬é¦–å…ˆå°†å•è¯æ‹†åˆ†ä¸ºç‹¬ç«‹æ–‡æœ¬èŠ‚ç‚¹ï¼Œéšååˆ›å»ºä¸€ä¸ªå®¹çº³æ–‡æœ¬å…ƒç´ çš„ç‹¬ç«‹æ± ï¼Œå¹¶è®¾ç½®4ä¸ªå…ƒç´ çš„ä¸Šé™ã€‚è¿™ç¡®ä¿æ¯æ¬¡æ·¡å…¥æ˜¾ç¤ºçš„å•è¯ä¸è¶…è¿‡4ä¸ªã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> useShouldTextFadePool = <span class="hljs-title function_">createUsePool</span>(<span class="hljs-number">4</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">TextFadeInStaggeredIfStreaming</span>(<span class="hljs-params">props</span>) {
  <span class="hljs-keyword">const</span> { isStreaming } = <span class="hljs-title function_">use</span>(<span class="hljs-title class_">MessageContext</span>)
  <span class="hljs-keyword">const</span> { isActive } = <span class="hljs-title function_">useShouldTextFadePool</span>()

  <span class="hljs-keyword">const</span> [shouldFade] = <span class="hljs-title function_">useState</span>(isActive &amp;&amp; isStreaming)

  <span class="hljs-keyword">let</span> { children } = props
  <span class="hljs-keyword">if</span> (shouldFade &amp;&amp; children) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(children)) {
      children = <span class="hljs-title class_">Children</span>.<span class="hljs-title function_">map</span>(children, <span class="hljs-function">(<span class="hljs-params">child, i</span>) =&gt;</span>
        <span class="hljs-keyword">typeof</span> child === <span class="hljs-string">'string'</span> ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AnimatedFadeInText</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span> <span class="hljs-attr">text</span>=<span class="hljs-string">{child}</span> /&gt;</span></span> : child,
      )
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> children === <span class="hljs-string">'string'</span>) {
      children = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AnimatedFadeInText</span> <span class="hljs-attr">text</span>=<span class="hljs-string">{children}</span> /&gt;</span></span>
    }
  }

  <span class="hljs-keyword">return</span> children
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">AnimatedFadeInText</span>(<span class="hljs-params">{ text }</span>) {
  <span class="hljs-keyword">const</span> chunks = text.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>)

  <span class="hljs-keyword">return</span> chunks.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">chunk, i</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TextFadeInStaggered</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span> <span class="hljs-attr">text</span>=<span class="hljs-string">{chunk</span> + ' '} /&gt;</span></span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">TextFadeInStaggered</span>(<span class="hljs-params">{ text }</span>) {
  <span class="hljs-keyword">const</span> { isActive, evict } = <span class="hljs-title function_">useIsAnimatedInPool</span>()
  <span class="hljs-keyword">return</span> isActive ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FadeIn</span> <span class="hljs-attr">onFadedIn</span>=<span class="hljs-string">{evict}</span>&gt;</span>{text}<span class="hljs-tag">&lt;/<span class="hljs-name">FadeIn</span>&gt;</span></span> : text
}
</code></pre>
<p>è¿™ç§æ–¹æ³•å­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜æ˜¯å®ƒé«˜åº¦ä¾èµ–äºåœ¨æŒ‚è½½æ—¶è§¦å‘åŠ¨ç”»æ•ˆæœã€‚å› æ­¤ï¼Œå¦‚æœä½ å‘é€ä¸€æ¡æ¶ˆæ¯ååˆ‡æ¢åˆ°å…¶ä»–èŠå¤©çª—å£ï¼Œç„¶ååœ¨æ¶ˆæ¯å‘é€å®Œæˆå‰è¿”å›åŸèŠå¤©çª—å£ï¼ŒåŠ¨ç”»æ•ˆæœä¼šé‡æ–°æŒ‚è½½å¹¶å†æ¬¡æ’­æ”¾ã€‚</p>
<p>ä¸ºç¼“è§£æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬è®¾è®¡äº†è·¨èŠå¤©è®°å½•è¿½è¸ªåŠ¨ç”»å†…å®¹çš„ç³»ç»Ÿã€‚å…·ä½“å®ç°æ˜¯åœ¨æ¶ˆæ¯æ ‘é¡¶å±‚ä½¿ç”¨ <code>DisableFadeProvider</code> ç»„ä»¶ï¼Œå¹¶åœ¨æ ¹çº§æ·¡å‡ºç»„ä»¶ä¸­è°ƒç”¨è¯¥ç»„ä»¶ï¼Œä»¥é¿å…å½±å“èµ„æºæ± ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">TextFadeInStaggeredIfStreaming</span>(<span class="hljs-params">props</span>) {
  <span class="hljs-keyword">const</span> { isStreaming } = <span class="hljs-title function_">use</span>(<span class="hljs-title class_">MessageContext</span>)
  <span class="hljs-keyword">const</span> { isActive } = <span class="hljs-title function_">useShouldTextFadePool</span>()
  <span class="hljs-keyword">const</span> isFadeDisabled = <span class="hljs-title function_">useDisableFadeContext</span>()

  <span class="hljs-keyword">const</span> [shouldFade] = <span class="hljs-title function_">useState</span>(!isFadeDisabled &amp;&amp; isActive &amp;&amp; isStreaming)
  
  <span class="hljs-keyword">if</span> (shouldFade) <span class="hljs-comment">// here we render TextFadeIn...</span>
  
  <span class="hljs-keyword">return</span> props.<span class="hljs-property">children</span>
}
</code></pre>
<p>è™½ç„¶åœ¨éå“åº”å¼åœºæ™¯ä¸‹æ˜¾å¼ä¾èµ– <code>useState</code> çš„åˆå§‹å€¼çœ‹ä¼¼ä¸å¯»å¸¸ï¼Œä½†è¿™ç§åšæ³•èƒ½è®©æˆ‘ä»¬æ ¹æ®å…ƒç´ æŒ‚è½½é¡ºåºå¯é åœ°è¿½è¸ªå…¶åŠ¨ç”»çŠ¶æ€ã€‚</p>
<h2 data-id="heading-13">åœ¨ç½‘é¡µå’ŒåŸç”Ÿåº”ç”¨ä¹‹é—´å…±äº«ä»£ç </h2>
<p>åœ¨å¼€å‘v0ç‰ˆiOSåº”ç”¨æ—¶ï¼Œä¸€ä¸ªè‡ªç„¶çš„é—®é¢˜æµ®ç°ï¼šWebç«¯ä¸åŸç”Ÿç«¯åº”å…±äº«å¤šå°‘ä»£ç ï¼Ÿ</p>
<p>é‰´äºv0ç‰ˆWebå•ä»“åº“çš„æˆç†Ÿåº¦ï¼Œæˆ‘ä»¬å†³å®šå…±äº«ç±»å‹å’Œè¾…åŠ©å‡½æ•°ï¼Œä½†ä¸å…±äº«UIæˆ–çŠ¶æ€ç®¡ç†ã€‚åŒæ—¶æˆ‘ä»¬ç€åŠ›å°†ä¸šåŠ¡é€»è¾‘ä»å®¢æˆ·ç«¯è¿ç§»è‡³æœåŠ¡å™¨ç«¯ï¼Œä½¿v0ç‰ˆç§»åŠ¨åº”ç”¨æˆä¸ºAPIçš„è½»é‡å°è£…å±‚ã€‚</p>
<p><strong>æ„å»ºå…±äº«API</strong></p>
<p>åœ¨æˆç†Ÿçš„Next.jsåº”ç”¨ä¸æ–°ç§»åŠ¨åº”ç”¨ä¹‹é—´å…±äº«åç«¯APIè·¯ç”±å¸¦æ¥äº†æŒ‘æˆ˜ã€‚v0ç½‘é¡µåº”ç”¨é‡‡ç”¨ReactæœåŠ¡å™¨ç»„ä»¶å’ŒæœåŠ¡å™¨æ“ä½œé©±åŠ¨ï¼Œè€Œç§»åŠ¨åº”ç”¨åˆ™æ›´åƒå•é¡µReactåº”ç”¨ã€‚</p>
<p>ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬åŸºäºè‡ªç ”åç«¯æ¡†æ¶æ„å»ºäº†APIå±‚ã€‚è¯¥æ¡†æ¶é€šè¿‡å¼ºåˆ¶è¦æ±‚ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fzod.dev%2F" target="_blank" title="https://zod.dev/" ref="nofollow noopener noreferrer">Zod</a>å®šä¹‰è¾“å…¥è¾“å‡ºç±»å‹ï¼Œå®ç°äº†è¿è¡Œæ—¶ç±»å‹å®‰å…¨ã€‚</p>
<p>å®šä¹‰è·¯ç”±åï¼Œç³»ç»Ÿä¼šæ ¹æ®å„è·¯ç”±çš„Zodç±»å‹ç”Ÿæˆ<code>https://api.v0.dev/v1/openapi.json</code>æ–‡ä»¶ã€‚ç§»åŠ¨ç«¯é€šè¿‡<a href="https://link.juejin.cn?target=https%3A%2F%2Fheyapi.dev%2F" target="_blank" title="https://heyapi.dev/" ref="nofollow noopener noreferrer">Hey API</a>æ¶ˆè´¹OpenAPIè§„èŒƒï¼Œè¯¥å·¥å…·ä¼šç”Ÿæˆè¾…åŠ©å‡½æ•°ä¾›<a href="https://link.juejin.cn?target=https%3A%2F%2Ftanstack.com%2Fquery%2Flatest" target="_blank" title="https://tanstack.com/query/latest" ref="nofollow noopener noreferrer">Tanstack Query</a>è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">import</span> { termsFindOptions } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/api'</span> <span class="hljs-comment">// this folder is generated</span>
<span class="hljs-keyword">import</span> { useQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/react-query'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useTermsQuery</span>(<span class="hljs-params">{ after }</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useQuery</span>(<span class="hljs-title function_">termsFindOptions</span>({ after }))
}
</code></pre>
<p>è¿™é¡¹å·¥ä½œä¿ƒæˆäº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fv0.app%2Fdocs%2Fapi%2Fplatform%2Fquickstart" target="_blank" title="https://v0.app/docs/api/platform/quickstart" ref="nofollow noopener noreferrer">v0å¹³å°API</a>çš„å¼€å‘ã€‚æˆ‘ä»¬æœ€åˆæ—¨åœ¨ä¸ºè‡ªæœ‰åŸç”Ÿå®¢æˆ·ç«¯æ‰“é€ ç†æƒ³çš„APIï¼Œæœ€ç»ˆå†³å®šå°†è¯¥APIå¼€æ”¾ç»™æ‰€æœ‰ç”¨æˆ·ã€‚å¾—ç›Šäºæ­¤ç­–ç•¥ï¼Œv0ç§»åŠ¨ç«¯ä¸v0å¹³å°APIå®¢æˆ·ä½¿ç”¨ç›¸åŒçš„æ¥å£è·¯å¾„å’Œé€»è¾‘ã€‚</p>
<p>æ¯æ¬¡æäº¤ä»£ç æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šè¿è¡Œæµ‹è¯•ä»¥ç¡®ä¿OpenAPIè§„èŒƒçš„å˜æ›´ä¸ç§»åŠ¨åº”ç”¨å…¼å®¹ã€‚</p>
<p>æœªæ¥æˆ‘ä»¬è®¡åˆ’é€šè¿‡åœ¨å¹³å°APIå¤–å±‚æ„å»ºç±»å‹çº§RPCå°è£…å™¨ï¼Œå½»åº•æ¶ˆé™¤ä»£ç ç”Ÿæˆç¯èŠ‚ã€‚</p>
<h2 data-id="heading-14">æ ·å¼</h2>
<p>v0ç‰ˆæœ¬é‡‡ç”¨<code>react-native-unistyles</code>è¿›è¡Œæ ·å¼å’Œä¸»é¢˜ç®¡ç†ã€‚åŸºäºå¯¹React Nativeçš„å®è·µç»éªŒï¼Œæˆ‘å§‹ç»ˆå¯¹æ¸²æŸ“é˜¶æ®µçš„æ“ä½œä¿æŒè°¨æ…ã€‚ä¸æˆ‘ä»¬è¯„ä¼°è¿‡çš„å…¶ä»–æ ·å¼åº“ä¸åŒï¼ŒUnistylesèƒ½åœ¨ä¸é‡æ–°æ¸²æŸ“ç»„ä»¶æˆ–è®¿é—®Reactä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹å®ç°å…¨é¢ä¸»é¢˜ç®¡ç†ã€‚</p>
<h3 data-id="heading-15">åŸç”Ÿèœå•</h3>
<p>é™¤äº†Unistylesä¸»é¢˜å’Œæ ·å¼åº“å¤–ï¼Œæˆ‘ä»¬å¹¶æœªé‡‡ç”¨åŸºäºJSçš„ç»„ä»¶åº“ï¼Œè€Œæ˜¯å°½å¯èƒ½ä¾èµ–åŸç”Ÿå…ƒç´ ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38c4482f6d51422bbfb9451521ef95ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NjAwMDcxODE5MTA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765287487&amp;x-signature=Ur%2Fn0xzfjIo1NYZ7WAm8fB%2BjTKk%3D" alt="image.png" loading="lazy"/></p>
<p>å¯¹äºèœå•ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fzeego.dev%2F" target="_blank" title="https://zeego.dev/" ref="nofollow noopener noreferrer">Zeego</a>æ¡†æ¶ï¼Œè¯¥æ¡†æ¶åœ¨åº•å±‚ä¾èµ–<code>https://github.com/dominicstop/react-native-ios-context-menu</code>æ¥æ¸²æŸ“åŸç”Ÿ<code>UIMenu</code>ã€‚å½“ä½¿ç”¨Xcode 26è¿›è¡Œæ„å»ºæ—¶ï¼ŒZeegoä¼šè‡ªåŠ¨æ¸²æŸ“Liquid Glassæ ·å¼çš„èœå•ã€‚</p>
<h3 data-id="heading-16">åŸç”Ÿ<code>Alert</code></h3>
<p>åœ¨ iOS 26 ç³»ç»Ÿä¸Šè¿è¡Œçš„ React Native åº”ç”¨å­˜åœ¨ <code>Alert</code> æ¸²æŸ“åç¦»å±å¹•çš„é—®é¢˜ã€‚æˆ‘ä»¬åœ¨è‡ªå®¶åº”ç”¨åŠä¼—å¤šçƒ­é—¨ React Native åº”ç”¨ä¸­å¤ç°äº†è¯¥é—®é¢˜ã€‚æˆ‘ä»¬é€šè¿‡æœ¬åœ°è¡¥ä¸ä¿®å¤äº†è¯¥é—®é¢˜ï¼Œå¹¶ä¸ Callstack å’Œ Meta çš„å¼€å‘è€…åˆä½œï¼Œå°†ä¿®å¤æ–¹æ¡ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact-native%2Fpull%2F53500" target="_blank" title="https://github.com/facebook/react-native/pull/53500" ref="nofollow noopener noreferrer">æäº¤è‡³ React Native</a> ã€‚</p>
<h3 data-id="heading-17">åŸç”Ÿåº•éƒ¨èœå•</h3>
<p>å¯¹äºåº•å±‚è¡¨å•ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†å†…ç½®çš„React Nativeæ¨¡æ€æ¡†å¹¶è®¾ç½®<code>presentationStyle="formSheet"</code>ã€‚ä½†è¯¥æ–¹æ¡ˆå­˜åœ¨è‹¥å¹²ç¼ºé™·ï¼Œæˆ‘ä»¬é€šè¿‡è¡¥ä¸è¿›è¡Œäº†ä¿®å¤ã€‚</p>
<p><strong>ä¿®å¤Yogaé—ªçƒé—®é¢˜</strong></p>
<p>è‹¥å°† <code>flex: 1</code> çš„ <code>View</code> åµŒå…¥å¸¦èƒŒæ™¯è‰²çš„æ¨¡æ€æ¡†ä¸­ï¼Œéšåä¸Šä¸‹æ‹–åŠ¨æ¨¡æ€æ¡†ï¼Œè¯¥è§†å›¾åº•éƒ¨ä¼šå‡ºç°å‰§çƒˆé—ªçƒç°è±¡ã€‚</p>
<p>ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯¹ React Native è¿›è¡Œäº†æœ¬åœ°è¡¥ä¸ä¿®å¤ï¼Œä½¿ Yoga æ¡†æ¶æ”¯æŒæ¨¡æ€æ¡†çš„åŒæ­¥æ›´æ–°ã€‚é€šè¿‡ä¸ Callstackã€Expo å’Œ Meta çš„å¼€å‘è€…åä½œï¼Œè¯¥æ”¹è¿›å·²åˆå¹¶è‡³ React Native æ ¸å¿ƒåº“ã€‚æ­¤åŠŸèƒ½ç°å·²éš React Native 0.82 ç‰ˆæœ¬<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact-native%2Fpull%2F52604" target="_blank" title="https://github.com/facebook/react-native/pull/52604" ref="nofollow noopener noreferrer">æ­£å¼å‘å¸ƒ</a>ã€‚</p>
<h2 data-id="heading-18">æœŸå¾…</h2>
<p>åœ¨ä½¿ç”¨React Nativeå’ŒExpoæ„å»ºäº†é¦–ä¸ªåº”ç”¨åï¼Œæˆ‘ä»¬å†æœªå›å¤´ã€‚è‹¥æ‚¨å°šæœªä½“éªŒiOSç‰ˆv0ï¼Œè¯·ç«‹å³<a href="https://link.juejin.cn?target=https%3A%2F%2Fapps.apple.com%2Fus%2Fapp%2Fv0%2Fid6745097949" target="_blank" title="https://apps.apple.com/us/app/v0/id6745097949" ref="nofollow noopener noreferrer">ä¸‹è½½</a>å¹¶é€šè¿‡App Storeè¯„è®ºå‘Šè¯‰æˆ‘ä»¬æ‚¨çš„æƒ³æ³•ã€‚</p>
<p>æˆ‘ä»¬æ­£åœ¨æ‹›å‹Ÿå¼€å‘è€…åŠ å…¥Vercelç§»åŠ¨å›¢é˜Ÿã€‚è‹¥æ­¤ç±»å·¥ä½œä»¤æ‚¨å¿ƒåŠ¨ï¼Œæˆ‘ä»¬æœŸå¾…<a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fcareers%2Fmobile-engineer-us-5719796004" target="_blank" title="https://vercel.com/careers/mobile-engineer-us-5719796004" ref="nofollow noopener noreferrer">æ‚¨çš„åŠ å…¥</a>ã€‚</p>
<p>åœ¨Vercelï¼Œæˆ‘ä»¬è‡´åŠ›äºæ‰“é€ æœ€é«˜æ°´å‡†çš„é›„å¿ƒå‹ƒå‹ƒçš„äº§å“ã€‚æˆ‘ä»¬å¸Œæœ›è®©Webå’ŒåŸç”Ÿå¼€å‘è€…åŒæ ·è½»æ¾å®ç°è¿™ä¸€ç›®æ ‡ï¼Œå¹¶è®¡åˆ’å¼€æºæˆ‘ä»¬çš„ç ”ç©¶æˆæœã€‚è‹¥æ‚¨æœ‰æ„å‚ä¸AIèŠå¤©åº”ç”¨å¼€æºåº“çš„æµ‹è¯•ç‰ˆæµ‹è¯•ï¼Œè¯·é€š<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Ffernandorojo" target="_blank" title="https://x.com/fernandorojo" ref="nofollow noopener noreferrer">è¿‡Xå¹³å°è”ç³»æˆ‘ä»¬</a>ã€‚æœŸå¾…ä¸ç¤¾åŒºæºæ‰‹ï¼Œå…±åŒæ¨åŠ¨React NativeæŒç»­è¿›æ­¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[â€œç‚¹ä¸€ä¸‹å°±èƒ½æ”¹â€â€”â€”è¿™ä¸ªåŠŸèƒ½ä¸ºé¦–å¯Œèµšåˆ°äº†å¤šå°‘moneyï¼Ÿ]]></title>    <link>https://juejin.cn/post/7578968420043685951</link>    <guid>https://juejin.cn/post/7578968420043685951</guid>    <pubDate>2025-12-02T14:36:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578968420043685951" data-draft-id="7579123072825884691" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="â€œç‚¹ä¸€ä¸‹å°±èƒ½æ”¹â€â€”â€”è¿™ä¸ªåŠŸèƒ½ä¸ºé¦–å¯Œèµšåˆ°äº†å¤šå°‘moneyï¼Ÿ"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-02T14:36:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="_ä¸€ä¸¤é£"/> <meta itemprop="url" content="https://juejin.cn/user/2250014422739596"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            â€œç‚¹ä¸€ä¸‹å°±èƒ½æ”¹â€â€”â€”è¿™ä¸ªåŠŸèƒ½ä¸ºé¦–å¯Œèµšåˆ°äº†å¤šå°‘moneyï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2250014422739596/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    _ä¸€ä¸¤é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T14:36:36.000Z" title="Tue Dec 02 2025 14:36:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Â ä» QQ ä¸ªæ€§ç­¾åç¼–è¾‘çœ‹ JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä¸€ä¸ªåŸç”Ÿ DOM çš„ OOP å®è·µ</h2>
<blockquote>
<p>æœ¬æ–‡é€šè¿‡å¤åˆ» QQâ€œç‚¹å‡»ä¸ªæ€§ç­¾åå³å¯ç¼–è¾‘â€çš„äº¤äº’æ•ˆæœï¼Œæ‰‹å†™ä¸€ä¸ª <code>EditInPlace</code>ï¼ˆå°±åœ°ç¼–è¾‘ï¼‰ç»„ä»¶ï¼Œæ·±å…¥ç†è§£ JavaScript ä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰æ€æƒ³ï¼Œå¹¶æ¢è®¨å…¶åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­çš„æ„ä¹‰ä¸å±€é™ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ğŸ¯ åœºæ™¯è¿˜åŸï¼šQQ çš„â€œå°±åœ°ç¼–è¾‘â€ä½“éªŒ</h3>
<p>æ‰“å¼€ QQ èµ„æ–™é¡µï¼Œä½ ä¼šå‘ç°ä¸ªæ€§ç­¾åå¤„æ˜¯è¿™æ ·è®¾è®¡çš„ï¼š</p>
<ul>
<li>é»˜è®¤æ˜¾ç¤ºä¸ºä¸€æ®µæ–‡æœ¬ï¼›</li>
<li>ç‚¹å‡»åï¼Œæ–‡æœ¬å˜æˆè¾“å…¥æ¡† + â€œä¿å­˜/å–æ¶ˆâ€æŒ‰é’®ï¼›</li>
<li>è¾“å…¥å†…å®¹åç‚¹å‡»â€œä¿å­˜â€ï¼Œå†…å®¹æ›´æ–°ï¼›ç‚¹å‡»â€œå–æ¶ˆâ€åˆ™è¿˜åŸã€‚</li>
</ul>
<p>è¿™ç§ <strong>â€œæ— éœ€è·³è½¬é¡µé¢ã€ç›´æ¥åœ¨å½“å‰ä½ç½®ç¼–è¾‘â€</strong> çš„äº¤äº’æ¨¡å¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <strong>â€œå°±åœ°ç¼–è¾‘â€ï¼ˆEdit in Placeï¼‰</strong> ã€‚å®ƒç®€æ´ã€é«˜æ•ˆï¼Œæ˜¯ Web 2.0 æ—¶ä»£çš„ç»å…¸ UI æ¨¡å¼ä¹‹ä¸€ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ç”¨ <strong>åŸç”Ÿ JavaScript + OOP</strong> æ¥å®ç°å®ƒï¼</p>
<hr/>
<h3 data-id="heading-2">ğŸ› ï¸ æ ¸å¿ƒå®ç°ï¼š<code>EditInPlace</code>Â ç±»</h3>
<p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬å®ç°çš„æ ¸å¿ƒä»£ç ï¼ˆå·²ç®€åŒ–æ³¨é‡Šï¼Œä¿ç•™å…³é”®é€»è¾‘ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">EditInPlace</span>(<span class="hljs-params">id, value, parentElement</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value || <span class="hljs-string">'è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ç•™ä¸‹'</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span> = parentElement;

  <span class="hljs-comment">// DOM å…ƒç´ å¼•ç”¨</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-literal">null</span>;   <span class="hljs-comment">// æ˜¾ç¤ºæ–‡æœ¬çš„ span</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-literal">null</span>;    <span class="hljs-comment">// å¯ç¼–è¾‘çš„ input</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElement</span>();  <span class="hljs-comment">// åˆ›å»º DOM ç»“æ„</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachEvent</span>();    <span class="hljs-comment">// ç»‘å®šäº‹ä»¶</span>
}

<span class="hljs-title class_">EditInPlace</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-title function_">createElement</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-property">id</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>;

    <span class="hljs-comment">// æ–‡æœ¬æ˜¾ç¤ºåŒº</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>);

    <span class="hljs-comment">// ç¼–è¾‘è¾“å…¥æ¡†</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'text'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>);

    <span class="hljs-comment">// æŒ‰é’®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">value</span> = <span class="hljs-string">'ä¿å­˜'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">value</span> = <span class="hljs-string">'å–æ¶ˆ'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>(); <span class="hljs-comment">// åˆå§‹ä¸ºåªè¯»çŠ¶æ€</span>
  },

  <span class="hljs-title function_">convertToText</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
  },

  <span class="hljs-title function_">convertToField</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>;
  },

  <span class="hljs-title function_">attachEvent</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToField</span>());
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">save</span>());
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cancel</span>());
  },

  <span class="hljs-title function_">save</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value === <span class="hljs-string">''</span> ? <span class="hljs-string">'è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ç•™ä¸‹'</span> : value;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();
    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å¯åœ¨æ­¤å¤„è°ƒç”¨ API ä¿å­˜åˆ°æœåŠ¡å™¨</span>
  },

  <span class="hljs-title function_">cancel</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();
  }
};
</code></pre>
<h4 data-id="heading-3">âœ… ä½¿ç”¨æ–¹å¼</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">EditInPlace</span>(<span class="hljs-string">'signature'</span>, <span class="hljs-string">'Hello World!'</span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>));
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">ğŸ§  OOP è®¾è®¡äº®ç‚¹è§£æ</h3>
<p>è¿™æ®µä»£ç è™½å°ï¼Œå´å®Œæ•´ä½“ç°äº† <strong>é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å››å¤§æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
<h4 data-id="heading-5">1.Â <strong>å°è£…ï¼ˆEncapsulationï¼‰</strong></h4>
<ul>
<li>æ‰€æœ‰çŠ¶æ€ï¼ˆ<code>value</code>ã€DOM å¼•ç”¨ï¼‰å’Œè¡Œä¸ºï¼ˆ<code>save</code>ã€<code>convertToText</code>ï¼‰éƒ½å°è£…åœ¨Â <code>EditInPlace</code>Â å®ä¾‹ä¸­ï¼›</li>
<li>å¤–éƒ¨åªéœ€è°ƒç”¨æ„é€ å‡½æ•°ï¼Œæ— éœ€å…³å¿ƒå†…éƒ¨ DOM å¦‚ä½•åˆ›å»ºæˆ–åˆ‡æ¢ã€‚</li>
</ul>
<h4 data-id="heading-6">2.Â <strong>æŠ½è±¡ï¼ˆAbstractionï¼‰</strong></h4>
<ul>
<li>ç”¨æˆ·çœ‹åˆ°çš„æ˜¯â€œå¯ç¼–è¾‘çš„ç­¾åâ€ï¼Œè€Œéšè—äº†â€œspan/input åˆ‡æ¢â€ã€â€œäº‹ä»¶ç»‘å®šâ€ç­‰ç»†èŠ‚ï¼›</li>
<li>æä¾›æ¸…æ™°çš„æ¥å£ï¼šç‚¹å‡» â†’ ç¼–è¾‘ â†’ ä¿å­˜/å–æ¶ˆã€‚</li>
</ul>
<h4 data-id="heading-7">3.Â <strong>å•ä¸€èŒè´£</strong></h4>
<ul>
<li><code>createElement</code>Â åªè´Ÿè´£æ„å»º DOMï¼›</li>
<li><code>attachEvent</code>Â åªè´Ÿè´£ç»‘å®šäº‹ä»¶ï¼›</li>
<li><code>save</code>Â åªè´Ÿè´£å¤„ç†ä¿å­˜é€»è¾‘ã€‚</li>
<li>å„å¸å…¶èŒï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•ã€‚</li>
</ul>
<h4 data-id="heading-8">4.Â <strong>å¯å¤ç”¨æ€§</strong></h4>
<ul>
<li>åªè¦ä¼ å…¥ä¸åŒçš„Â <code>id</code>ã€<code>value</code>Â å’ŒæŒ‚è½½ç‚¹ï¼Œå°±èƒ½åˆ›å»ºå¤šä¸ªç‹¬ç«‹çš„ç¼–è¾‘å™¨å®ä¾‹ï¼›</li>
<li>æ— å…¨å±€æ±¡æŸ“ï¼Œå®ä¾‹ä¹‹é—´äº’ä¸å½±å“ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">âœ… æ€»ç»“</h3>
<blockquote>
<p>â€œå°±åœ°ç¼–è¾‘â€çœ‹ä¼¼ç®€å•ï¼Œå´æ˜¯ OOP ä¸ DOM æ“ä½œçš„ç»ä½³ç»ƒå…µåœºã€‚</p>
</blockquote>
<p>é€šè¿‡ <code>EditInPlace</code>ï¼Œæˆ‘ä»¬ä¸ä»…å¤åˆ»äº† QQ çš„ç»å…¸äº¤äº’ï¼Œæ›´æ·±å…¥ç†è§£äº†ï¼š</p>
<ul>
<li>å¦‚ä½•ç”¨å¯¹è±¡å°è£…çŠ¶æ€ä¸è¡Œä¸ºï¼›</li>
<li>å¦‚ä½•ç»„ç»‡å¯ç»´æŠ¤çš„åŸç”Ÿ JS ä»£ç ï¼›</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•å®ç°UniAppç™»å½•æ‹¦æˆªï¼Ÿ]]></title>    <link>https://juejin.cn/post/7579066828179669028</link>    <guid>https://juejin.cn/post/7579066828179669028</guid>    <pubDate>2025-12-02T14:41:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579066828179669028" data-draft-id="7578968420043718719" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•å®ç°UniAppç™»å½•æ‹¦æˆªï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-12-02T14:41:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘å«é»‘å¤§å¸…"/> <meta itemprop="url" content="https://juejin.cn/user/1678295463898875"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•å®ç°UniAppç™»å½•æ‹¦æˆªï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1678295463898875/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘å«é»‘å¤§å¸…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T14:41:35.000Z" title="Tue Dec 02 2025 14:41:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">UniApp å®ç°ç™»å½•æ‹¦æˆªï¼šCS å°ç™½å…¥é—¨æŒ‡å—</h2>
<p>ç™»å½•æ‹¦æˆªæ˜¯å‰ç«¯æƒé™æ§åˆ¶çš„åŸºç¡€åŠŸèƒ½ï¼Œæ ¸å¿ƒç›®çš„æ˜¯ï¼šæœªç™»å½•ç”¨æˆ·æ— æ³•è®¿é—®éœ€è¦æƒé™çš„é¡µé¢ï¼ˆå¦‚ä¸ªäººä¸­å¿ƒã€è®¢å•åˆ—è¡¨ï¼‰ï¼ŒåŒæ—¶æ‹¦æˆªæœªæˆæƒçš„æ¥å£è¯·æ±‚ï¼Œé¿å…æ•æ„Ÿæ•°æ®æ³„éœ²æˆ–æ— æ•ˆæ“ä½œã€‚</p>
<p>å¯¹äº CS å°ç™½è€Œè¨€ï¼ŒUniApp ç™»å½•æ‹¦æˆªçš„æ ¸å¿ƒé€»è¾‘å¯æ¦‚æ‹¬ä¸ºã€Œ<strong>çŠ¶æ€æ ¡éªŒ + è¡Œä¸ºæ‹¦æˆª</strong>ã€ï¼šé€šè¿‡ token æ ‡è¯†ç™»å½•çŠ¶æ€ï¼Œæ‹¦æˆªéæ³•çš„é¡µé¢è·³è½¬å’Œæ¥å£è¯·æ±‚ï¼Œå¼•å¯¼æœªç™»å½•ç”¨æˆ·å‰å¾€ç™»å½•é¡µã€‚</p>
<h3 data-id="heading-1">å‰ç½®çŸ¥è¯†ï¼šä»€ä¹ˆæ˜¯ Tokenï¼Ÿ</h3>
<p>token æ˜¯ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œåç«¯è¿”å›çš„ã€Œèº«ä»½å‡­è¯ã€ï¼Œç›¸å½“äºç™»å½•åçš„ã€Œç”µå­é—¨ç¥¨ã€ã€‚</p>
<p>åç»­è®¿é—®éœ€è¦æƒé™çš„é¡µé¢æˆ–æ¥å£æ—¶ï¼Œå‰ç«¯éœ€æºå¸¦ token è¯æ˜ã€Œå·²ç™»å½•ã€èº«ä»½ï¼Œåç«¯éªŒè¯ token æœ‰æ•ˆåˆ™å…è®¸è®¿é—®ï¼Œæ— æ•ˆåˆ™æ‹’ç»ã€‚</p>
<p>token éœ€æŒä¹…åŒ–å­˜å‚¨ï¼ˆå¦‚æœ¬åœ°å­˜å‚¨ï¼‰ï¼Œå¦åˆ™ App é‡å¯æˆ–é¡µé¢åˆ·æ–°åä¼šä¸¢å¤±ï¼Œå¯¼è‡´ç”¨æˆ·éœ€é‡æ–°ç™»å½•ã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒå®ç°ä¸€ï¼šè·¯ç”±æ‹¦æˆªï¼ˆæ§åˆ¶é¡µé¢è·³è½¬ï¼‰</h3>
<p>UniApp ä¸­å®ç°è·¯ç”±æ‹¦æˆªçš„æ ¸å¿ƒ API æ˜¯ <code>uni.addInterceptor</code>ï¼Œä¸“é—¨ç”¨äºæ‹¦æˆªè·¯ç”±è·³è½¬è¡Œä¸ºï¼ˆå¦‚ <code>uni.navigateTo</code>ã€<code>uni.redirectTo</code> ç­‰ï¼‰ã€‚</p>
<h4 data-id="heading-3">å…³é”® API è§£é‡Š</h4>
<p><code>uni.addInterceptor</code>ï¼šUniApp å†…ç½®æ‹¦æˆªå™¨ APIï¼Œæ”¯æŒæ‹¦æˆªè·¯ç”±ã€è¯·æ±‚ã€ä¸Šä¼  / ä¸‹è½½ç­‰è¡Œä¸ºã€‚</p>
<ul>
<li>é€šè¿‡ <code>invoke</code> å›è°ƒåœ¨æ‹¦æˆªè¡Œä¸ºæ‰§è¡Œå‰è§¦å‘è‡ªå®šä¹‰é€»è¾‘ï¼ˆé‡ç‚¹æŒæ¡ï¼‰ï¼›</li>
<li>é€šè¿‡ <code>success</code> å›è°ƒåœ¨æ‹¦æˆªè¡Œä¸ºæˆåŠŸåå¤„ç†ç»“æœï¼›</li>
<li>å°ç™½åªéœ€å…³æ³¨ <code>invoke</code> å›è°ƒå³å¯å®ç°åŸºç¡€æ‹¦æˆªã€‚</li>
</ul>
<h4 data-id="heading-4">åŸºç¡€è·¯ç”±æ‹¦æˆª</h4>
<p>è·¯ç”±æ‹¦æˆªéœ€åœ¨å…¨å±€ç”Ÿæ•ˆï¼Œå»ºè®®åœ¨ <code>main.js</code> ä¸­åˆå§‹åŒ–ï¼ˆé¡¹ç›®å…¥å£æ–‡ä»¶ï¼Œç¡®ä¿æ‰€æœ‰é¡µé¢åŠ è½½å‰æ‰§è¡Œï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">Â <span class="hljs-comment">// è·¯ç”±æ‹¦æˆªåˆå§‹åŒ–ï¼šæ‹¦æˆªæ‰€æœ‰è·¯ç”±è·³è½¬</span>
Â uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-string">'navigateTo'</span>, {
Â  Â <span class="hljs-title function_">invoke</span>(<span class="hljs-params">options</span>) {
Â  Â  Â <span class="hljs-comment">// 1. è·å–æœ¬åœ°å­˜å‚¨çš„ tokenï¼ˆåç»­è®²è§£å¦‚ä½•å­˜å‚¨ï¼‰</span>
Â  Â  Â <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userToken'</span>);
Â  Â  Â <span class="hljs-comment">// 2. åˆ¤æ–­ token æ˜¯å¦å­˜åœ¨ï¼šä¸å­˜åœ¨åˆ™æ‹¦æˆªè·³è½¬ï¼Œè·³è½¬è‡³ç™»å½•é¡µ</span>
Â  Â  Â <span class="hljs-keyword">if</span> (!token) {
Â  Â  Â  Â <span class="hljs-comment">// ä½¿ç”¨ redirectTo è·³è½¬ï¼Œé¿å…ç”¨æˆ·é€šè¿‡è¿”å›é”®å›åˆ°åŸé¡µé¢</span>
Â  Â  Â  Â uni.<span class="hljs-title function_">redirectTo</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/login/login'</span> });
Â  Â  Â  Â <span class="hljs-comment">// é˜»æ­¢åŸè·³è½¬è¡Œä¸ºï¼ˆå…³é”®ï¼å¦åˆ™ä¼šåŒæ—¶è·³è½¬åˆ°ç›®æ ‡é¡µå’Œç™»å½•é¡µï¼‰</span>
Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
Â  Â   }
Â  Â  Â <span class="hljs-comment">// 3. token å­˜åœ¨ï¼šå…è®¸è·³è½¬ï¼ˆæ— éœ€é¢å¤–æ“ä½œï¼Œé»˜è®¤ç»§ç»­æ‰§è¡ŒåŸè·³è½¬ï¼‰</span>
Â   }
Â });
</code></pre>
<h4 data-id="heading-5">æ‰©å±•ï¼šæ‹¦æˆªæ‰€æœ‰è·¯ç”±ç±»å‹</h4>
<p>ä¸Šè¿°ä»£ç ä»…æ‹¦æˆª <code>navigateTo</code> è·³è½¬ï¼Œå®é™…å¼€å‘ä¸­éœ€è¦†ç›–æ‰€æœ‰è·¯ç”±æ–¹å¼ï¼ˆå¦‚ <code>switchTab</code> åˆ‡æ¢åº•éƒ¨æ ‡ç­¾ã€<code>reLaunch</code> é‡å¯åº”ç”¨ï¼‰ï¼Œå¯é€šè¿‡å¾ªç¯ç®€åŒ–ä»£ç ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-comment">// éœ€æ‹¦æˆªçš„è·¯ç”±ç±»å‹æ•°ç»„ï¼ˆè¦†ç›– UniApp æ‰€æœ‰è·¯ç”± APIï¼‰</span>
Â <span class="hljs-keyword">const</span> routeTypes = [<span class="hljs-string">'navigateTo'</span>, <span class="hljs-string">'redirectTo'</span>, <span class="hljs-string">'switchTab'</span>, <span class="hljs-string">'reLaunch'</span>, <span class="hljs-string">'navigateBack'</span>];
Â â€‹
Â <span class="hljs-comment">// å¾ªç¯ä¸ºæ‰€æœ‰è·¯ç”±ç±»å‹æ·»åŠ æ‹¦æˆªå™¨</span>
Â routeTypes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">type</span> =&gt;</span> {
Â  Â uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-keyword">type</span>, {
Â  Â  Â <span class="hljs-title function_">invoke</span>(<span class="hljs-params">options</span>) {
Â  Â  Â  Â <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userToken'</span>);
Â  Â  Â  Â <span class="hljs-comment">// å…³é”®ï¼šæ’é™¤ç™»å½•é¡µæœ¬èº«ï¼Œé¿å…æ­»å¾ªç¯</span>
Â  Â  Â  Â <span class="hljs-keyword">if</span> (!token &amp;&amp; !options.<span class="hljs-property">url</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'/pages/login/login'</span>)) {
Â  Â  Â  Â  Â uni.<span class="hljs-title function_">redirectTo</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/login/login'</span> });
Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
Â  Â  Â   }
Â  Â   }
Â   });
Â });
</code></pre>
<h4 data-id="heading-6">é¿å‘æé†’ ğŸš¨</h4>
<p>å¿…é¡»æ’é™¤ç™»å½•é¡µï¼šå¦‚æœä¸æ’é™¤ï¼Œæœªç™»å½•æ—¶è·³è½¬ç™»å½•é¡µä¼šè¢«è‡ªèº«æ‹¦æˆªï¼Œé™·å…¥ã€Œè·³è½¬ - æ‹¦æˆª - å†è·³è½¬ã€çš„æ­»å¾ªç¯ï¼Œè¿™æ˜¯å°ç™½æœ€å®¹æ˜“è¸©çš„å‘ã€‚</p>
<h3 data-id="heading-7">æ ¸å¿ƒå®ç°äºŒï¼šæœ¬åœ°å­˜å‚¨ Tokenï¼ˆæŒä¹…åŒ–ç™»å½•çŠ¶æ€ï¼‰</h3>
<p>ç™»å½•æˆåŠŸåï¼Œéœ€å°†åç«¯è¿”å›çš„ token å­˜å…¥æœ¬åœ°ï¼Œä»¥ä¾¿è·¯ç”±æ‹¦æˆªã€è¯·æ±‚æ‹¦æˆªæ—¶è·å–ï¼Œæ ¸å¿ƒ API æ˜¯ <code>uni.setStorageSync</code> å’Œ <code>uni.getStorageSync</code>ã€‚</p>
<h4 data-id="heading-8">å…³é”® API è§£é‡Š</h4>
<p><code>uni.setStorageSync(key, value)</code>ï¼šUniApp åŒæ­¥æœ¬åœ°å­˜å‚¨ APIã€‚</p>
<ul>
<li>ä»¥é”®å€¼å¯¹å½¢å¼å­˜å…¥æœ¬åœ°ï¼ˆç±»ä¼¼æµè§ˆå™¨çš„ <code>localStorage</code>ï¼‰ï¼›</li>
<li>åŒæ­¥æ‰§è¡Œï¼šä»£ç ä¼šç­‰å¾…å­˜å‚¨å®Œæˆåå†ç»§ç»­ï¼Œæ— éœ€å¤„ç†å¼‚æ­¥å›è°ƒï¼Œå°ç™½å‹å¥½ï¼›</li>
<li>é€‚åˆå­˜å‚¨ç®€å•æ•°æ®ï¼ˆå¦‚ tokenã€ç”¨æˆ·æ˜µç§°ã€IDï¼‰ã€‚</li>
</ul>
<p><code>uni.getStorageSync(key)</code>ï¼šåŒæ­¥è¯»å–æœ¬åœ°å­˜å‚¨æ•°æ®ã€‚</p>
<ul>
<li>æ ¹æ® key è¯»å–å¯¹åº” valueï¼Œæ— æ•°æ®åˆ™è¿”å› <code>null</code> æˆ– <code>undefined</code>ï¼›</li>
<li>è¯»å–é€Ÿåº¦å¿«ï¼Œé€‚åˆé¢‘ç¹è·å–çš„åœºæ™¯ï¼ˆå¦‚æ‹¦æˆªå™¨ä¸­è·å– tokenï¼‰ã€‚</li>
</ul>
<p><code>uni.removeStorageSync(key)</code>ï¼šåŒæ­¥åˆ é™¤æœ¬åœ°å­˜å‚¨çš„æŒ‡å®š key æ•°æ®ï¼Œç”¨äºé€€å‡ºç™»å½•æ—¶æ¸…é™¤ tokenã€‚</p>
<h4 data-id="heading-9">Token å­˜å‚¨ä¸åˆ é™¤</h4>
<h5 data-id="heading-10">1. ç™»å½•æˆåŠŸåå­˜å‚¨ Tokenï¼ˆç™»å½•é¡µé€»è¾‘ï¼‰</h5>
<pre><code class="hljs language-kotlin" lang="kotlin">Â <span class="hljs-comment">// ç™»å½•é¡µé¢ï¼šç”¨æˆ·è¾“å…¥è´¦å·å¯†ç åç‚¹å‡»ç™»å½•æŒ‰é’®çš„é€»è¾‘</span>
Â async function login() {
Â  Â <span class="hljs-comment">// 1. è·å–ç”¨æˆ·è¾“å…¥çš„è´¦å·å¯†ç ï¼ˆå‡è®¾å·²é€šè¿‡è¡¨å•ç»‘å®šï¼‰</span>
Â  Â <span class="hljs-keyword">const</span> { username, password } = <span class="hljs-keyword">this</span>.userForm;
Â  Â 
Â  Â <span class="hljs-comment">// 2. è°ƒç”¨åç«¯ç™»å½•æ¥å£ï¼ˆåç»­è¯·æ±‚æ‹¦æˆªä¼šè¡¥å……æ¥å£é€»è¾‘ï¼‰</span>
Â  Â <span class="hljs-keyword">const</span> res = await uni.request({
Â  Â  Â url: <span class="hljs-string">'https://api.example.com/login'</span>, <span class="hljs-comment">// åç«¯ç™»å½•æ¥å£åœ°å€</span>
Â  Â  Â method: <span class="hljs-string">'POST'</span>,
Â  Â  Â <span class="hljs-keyword">data</span>: { username, password } <span class="hljs-comment">// ä¼ é€’è´¦å·å¯†ç </span>
Â   });
Â  Â 
Â  Â <span class="hljs-comment">// 3. å¤„ç†åç«¯è¿”å›ç»“æœï¼ˆå‡è®¾åç«¯çº¦å®šï¼šcode=200 ä¸ºæˆåŠŸï¼‰</span>
Â  Â <span class="hljs-keyword">if</span> (res.<span class="hljs-keyword">data</span>.code === <span class="hljs-number">200</span>) {
Â  Â  Â <span class="hljs-comment">// 4. å­˜å‚¨ token åˆ°æœ¬åœ°ï¼Œkey å»ºè®®è¯­ä¹‰åŒ–ï¼ˆå¦‚ 'userToken'ï¼‰</span>
Â  Â  Â uni.setStorageSync(<span class="hljs-string">'userToken'</span>, res.<span class="hljs-keyword">data</span>.<span class="hljs-keyword">data</span>.token);
Â  Â  Â 
Â  Â  Â <span class="hljs-comment">// 5. å­˜å‚¨æˆåŠŸåè·³è½¬è‡³é¦–é¡µæˆ–ç›®æ ‡é¡µé¢</span>
Â  Â  Â uni.redirectTo({ url: <span class="hljs-string">'/pages/index/index'</span> });
Â   } <span class="hljs-keyword">else</span> {
Â  Â  Â <span class="hljs-comment">// ç™»å½•å¤±è´¥ï¼šæç¤ºç”¨æˆ·ï¼ˆUniApp å†…ç½®æç¤º APIï¼‰</span>
Â  Â  Â uni.showToast({ title: res.<span class="hljs-keyword">data</span>.msg || <span class="hljs-string">'ç™»å½•å¤±è´¥'</span>, icon: <span class="hljs-string">'none'</span> });
Â   }
Â }
</code></pre>
<h5 data-id="heading-11">2. é€€å‡ºç™»å½•æ—¶åˆ é™¤ Token</h5>
<pre><code class="hljs language-php" lang="php">Â <span class="hljs-comment">// é€€å‡ºç™»å½•é€»è¾‘ï¼ˆå¦‚ä¸ªäººä¸­å¿ƒçš„é€€å‡ºæŒ‰é’®ï¼‰</span>
Â <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logout</span>(<span class="hljs-params"/>) </span>{
Â  Â <span class="hljs-comment">// 1. æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„ token</span>
Â  Â uni.<span class="hljs-title function_ invoke__">removeStorageSync</span>(<span class="hljs-string">'userToken'</span>);
Â  Â 
Â  Â <span class="hljs-comment">// 2. è·³è½¬è‡³ç™»å½•é¡µï¼Œå…³é—­æ‰€æœ‰é¡µé¢é¿å…è¿”å›</span>
Â  Â uni.<span class="hljs-title function_ invoke__">reLaunch</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/login/login'</span> });
Â }
</code></pre>
<h4 data-id="heading-12">æ³¨æ„äº‹é¡¹ ğŸ“Œ</h4>
<p>æœ¬åœ°å­˜å‚¨çš„ token æ˜¯æ˜æ–‡å­˜å‚¨ï¼ˆå¦‚ H5 ç«¯å¯é€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹ï¼‰ï¼Œåˆ‡å‹¿å­˜å‚¨å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œä»…å­˜å‚¨ token ç­‰éæ•æ„Ÿå‡­è¯ã€‚</p>
<h3 data-id="heading-13">æ ¸å¿ƒå®ç°ä¸‰ï¼šè¯·æ±‚æ‹¦æˆªä¸å“åº”æ‹¦æˆªï¼ˆæ§åˆ¶æ¥å£è®¿é—®ï¼‰</h3>
<p>è·¯ç”±æ‹¦æˆªèƒ½é˜»æ­¢æœªç™»å½•ç”¨æˆ·è®¿é—®é¡µé¢ï¼Œä½†æ— æ³•é˜»æ­¢ç”¨æˆ·é€šè¿‡æŠ“åŒ…å·¥å…·æˆ–ç›´æ¥è°ƒç”¨æ¥å£å‘èµ·è¯·æ±‚ï¼Œå› æ­¤éœ€è¦ã€Œè¯·æ±‚æ‹¦æˆª + å“åº”æ‹¦æˆªã€å½¢æˆåŒé‡ä¿éšœã€‚</p>
<h4 data-id="heading-14">æ ¸å¿ƒé€»è¾‘</h4>
<ul>
<li>è¯·æ±‚æ‹¦æˆªï¼šä¸ºæ‰€æœ‰éœ€è¦æƒé™çš„æ¥å£è‡ªåŠ¨æ·»åŠ  token åˆ°è¯·æ±‚å¤´ï¼Œè®©åç«¯éªŒè¯èº«ä»½ï¼›</li>
<li>å“åº”æ‹¦æˆªï¼šå¤„ç†æ¥å£è¿”å›çš„é”™è¯¯çŠ¶æ€ï¼ˆå¦‚ token è¿‡æœŸã€æœªæˆæƒï¼‰ï¼Œå¼ºåˆ¶è·³è½¬ç™»å½•é¡µã€‚</li>
</ul>
<h4 data-id="heading-15">å…³é”® API è§£é‡Š</h4>
<p><code>uni.addInterceptor('request')</code>ï¼šæ‹¦æˆªæ‰€æœ‰é€šè¿‡ <code>uni.request</code> å‘èµ·çš„æ¥å£è¯·æ±‚ã€‚</p>
<ul>
<li><code>invoke</code> å›è°ƒï¼šè¯·æ±‚å‘é€å‰æ‰§è¡Œï¼ˆç”¨äºæ·»åŠ è¯·æ±‚å¤´ tokenï¼‰ï¼›</li>
<li><code>success</code> å›è°ƒï¼šè¯·æ±‚å“åº”åæ‰§è¡Œï¼ˆç”¨äºå¤„ç† 401 ç­‰é”™è¯¯çŠ¶æ€ï¼‰ï¼›</li>
<li><code>fail</code> å›è°ƒï¼šè¯·æ±‚å¤±è´¥æ—¶æ‰§è¡Œï¼ˆå¦‚ç½‘ç»œé”™è¯¯ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-16">1. è¯·æ±‚æ‹¦æˆªï¼šæ·»åŠ  Token åˆ°è¯·æ±‚å¤´</h4>
<pre><code class="hljs language-javascript" lang="javascript">Â <span class="hljs-comment">// è¯·æ±‚æ‹¦æˆªï¼šè‡ªåŠ¨ä¸ºæ¥å£æ·»åŠ  token</span>
Â uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-string">'request'</span>, {
Â  Â <span class="hljs-title function_">invoke</span>(<span class="hljs-params">options</span>) {
Â  Â  Â <span class="hljs-comment">// 1. è·å–æœ¬åœ°å­˜å‚¨çš„ token</span>
Â  Â  Â <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userToken'</span>);
Â  Â  Â 
Â  Â  Â <span class="hljs-comment">// 2. å¦‚æœ token å­˜åœ¨ï¼Œæ·»åŠ åˆ°è¯·æ±‚å¤´ï¼ˆéœ€ä¸åç«¯çº¦å®šå­—æ®µåï¼‰</span>
Â  Â  Â <span class="hljs-keyword">if</span> (token) {
Â  Â  Â  Â <span class="hljs-comment">// åˆå§‹åŒ–è¯·æ±‚å¤´ï¼ˆé¿å… options.header ä¸º undefinedï¼‰</span>
Â  Â  Â  Â options.<span class="hljs-property">header</span> = options.<span class="hljs-property">header</span> || {};
Â  Â  Â  Â <span class="hljs-comment">// å¸¸è§æ ¼å¼ï¼šBearer + ç©ºæ ¼ + tokenï¼ˆåç«¯çº¦å®šä¸ºå‡†ï¼Œä¹Ÿå¯èƒ½ç›´æ¥ä¼  tokenï¼‰</span>
Â  Â  Â  Â options.<span class="hljs-property">header</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>;
Â  Â   }
Â  Â  Â 
Â  Â  Â <span class="hljs-comment">// 3. æ— éœ€é˜»æ­¢è¯·æ±‚ï¼Œä»…æ·»åŠ é…ç½®ï¼Œé»˜è®¤ç»§ç»­å‘é€</span>
Â   }
Â });
</code></pre>
<h4 data-id="heading-17">2. å“åº”æ‹¦æˆªï¼šå¤„ç†æ¥å£é”™è¯¯çŠ¶æ€</h4>
<pre><code class="hljs language-php" lang="php">Â <span class="hljs-comment">// å“åº”æ‹¦æˆªï¼šå¤„ç†æ¥å£è¿”å›çš„æœªæˆæƒã€token è¿‡æœŸç­‰çŠ¶æ€</span>
Â uni.<span class="hljs-title function_ invoke__">addInterceptor</span>(<span class="hljs-string">'request'</span>, {
Â  Â <span class="hljs-title function_ invoke__">success</span>(res) {
Â  Â  Â // <span class="hljs-number">1</span>. å‡è®¾åç«¯çº¦å®šçŠ¶æ€ç ï¼š<span class="hljs-number">401</span>=æœªæˆæƒï¼ˆtoken æ— æ•ˆ/è¿‡æœŸï¼‰ï¼Œ<span class="hljs-number">403</span>=æƒé™ä¸è¶³
Â  Â  Â <span class="hljs-keyword">const</span> { code, msg } = res.data;
Â  Â  Â 
Â  Â  Â // <span class="hljs-number">2</span>. å¤„ç† <span class="hljs-number">401</span> æœªæˆæƒï¼šæ¸…é™¤æ— æ•ˆ tokenï¼Œè·³è½¬ç™»å½•é¡µ
Â  Â  Â <span class="hljs-keyword">if</span> (code === <span class="hljs-number">401</span>) {
Â  Â  Â  Â <span class="hljs-comment">// æ¸…é™¤æœ¬åœ°æ— æ•ˆ tokenï¼Œé¿å…ä¸‹æ¬¡è¯·æ±‚ä»æºå¸¦</span>
Â  Â  Â  Â uni.<span class="hljs-title function_ invoke__">removeStorageSync</span>(<span class="hljs-string">'userToken'</span>);
Â  Â  Â  Â 
Â  Â  Â  Â <span class="hljs-comment">// æç¤ºç”¨æˆ·ç™»å½•è¿‡æœŸ</span>
Â  Â  Â  Â uni.<span class="hljs-title function_ invoke__">showToast</span>({ <span class="hljs-attr">title</span>: msg || <span class="hljs-string">'ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•'</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">'none'</span> });
Â  Â  Â  Â 
Â  Â  Â  Â <span class="hljs-comment">// è·³è½¬ç™»å½•é¡µï¼ˆå…³é—­æ‰€æœ‰é¡µé¢ï¼Œé¿å…è¿”å›ï¼‰</span>
Â  Â  Â  Â uni.<span class="hljs-title function_ invoke__">reLaunch</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/login/login'</span> });
Â  Â   }
Â  Â  Â 
Â  Â  Â <span class="hljs-comment">// 3. å¤„ç† 403 æƒé™ä¸è¶³ï¼šä»…æç¤ºï¼Œä¸è·³è½¬</span>
Â  Â  Â <span class="hljs-keyword">if</span> (code === <span class="hljs-number">403</span>) {
Â  Â  Â  Â uni.<span class="hljs-title function_ invoke__">showToast</span>({ <span class="hljs-attr">title</span>: msg || <span class="hljs-string">'æš‚æ— æƒé™è®¿é—®'</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">'none'</span> });
Â  Â   }
Â   },
Â  Â <span class="hljs-title function_ invoke__">fail</span>(err) {
Â  Â  Â <span class="hljs-comment">// å¤„ç†ç½‘ç»œé”™è¯¯ç­‰è¯·æ±‚å¤±è´¥åœºæ™¯</span>
Â  Â  Â uni.<span class="hljs-title function_ invoke__">showToast</span>({ <span class="hljs-attr">title</span>: <span class="hljs-string">'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">'none'</span> });
Â   }
Â });
</code></pre>
<h4 data-id="heading-18">é¿å‘æé†’ ğŸ“Œ</h4>
<p>è¯·æ±‚å¤´çš„ token å­—æ®µåéœ€ä¸åç«¯ä¸¥æ ¼çº¦å®šï¼šå¤§å¤šæ•°åç«¯ä½¿ç”¨ <code>Authorization</code> ä½œä¸ºå­—æ®µåï¼Œæ ¼å¼ä¸º <code>Bearer + ç©ºæ ¼ + token</code>ï¼›è‹¥åç«¯è¦æ±‚ç›´æ¥ä¼  tokenï¼ˆå¦‚ <code>header: { token: 'xxx' }</code>ï¼‰ï¼Œéœ€æŒ‰åç«¯è§„åˆ™ä¿®æ”¹ï¼Œå¦åˆ™åç«¯æ— æ³•è¯†åˆ«ã€‚</p>
<h3 data-id="heading-19">æ ¸å¿ƒå®ç°å››ï¼šé¡µé¢çº§æƒé™æ ¡éªŒï¼ˆå…œåº•æ–¹æ¡ˆï¼‰</h3>
<p>è·¯ç”±æ‹¦æˆªå’Œè¯·æ±‚æ‹¦æˆªå·²èƒ½è¦†ç›–å¤§éƒ¨åˆ†åœºæ™¯ï¼Œä½†å­˜åœ¨ç‰¹æ®Šæƒ…å†µï¼ˆå¦‚ H5 ç«¯é¡µé¢åˆ·æ–°åè·¯ç”±æ‹¦æˆªæœªè§¦å‘ï¼‰ï¼Œå› æ­¤éœ€è¦åœ¨é¡µé¢åŠ è½½æ—¶æ·»åŠ ã€Œå…œåº•æ ¡éªŒã€ã€‚</p>
<h4 data-id="heading-20">å…³é”®ç”Ÿå‘½å‘¨æœŸè§£é‡Š</h4>
<p><code>onLoad</code>ï¼šUniApp é¡µé¢ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œé¡µé¢åŠ è½½æ—¶è§¦å‘ï¼ˆä»…è§¦å‘ä¸€æ¬¡ï¼‰ã€‚</p>
<ul>
<li>é€‚åˆåœ¨é¡µé¢åˆå§‹åŒ–æ—¶æ‰§è¡Œæƒé™æ ¡éªŒï¼›</li>
<li>å³ä½¿è·¯ç”±æ‹¦æˆªå¤±æ•ˆï¼Œé¡µé¢çº§æ ¡éªŒä»èƒ½ç”Ÿæ•ˆï¼Œé¿å…æœªç™»å½•ç”¨æˆ·åœç•™åœ¨æƒé™é¡µé¢ã€‚</li>
</ul>
<h4 data-id="heading-21">é¡µé¢çº§æ ¡éªŒ</h4>
<pre><code class="hljs language-javascript" lang="javascript">Â <span class="hljs-comment">// éœ€æƒé™çš„é¡µé¢ï¼ˆå¦‚ä¸ªäººä¸­å¿ƒ pages/mine/mine.vueï¼‰</span>
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
Â  Â <span class="hljs-comment">// é¡µé¢åŠ è½½æ—¶æ‰§è¡Œæ ¡éªŒ</span>
Â  Â <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"/>) {
Â  Â  Â <span class="hljs-comment">// 1. è·å–æœ¬åœ° token</span>
Â  Â  Â <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userToken'</span>);
Â  Â  Â 
Â  Â  Â <span class="hljs-comment">// 2. æ—  token åˆ™è·³è½¬ç™»å½•é¡µï¼Œå…³é—­å½“å‰é¡µé¢</span>
Â  Â  Â <span class="hljs-keyword">if</span> (!token) {
Â  Â  Â  Â uni.<span class="hljs-title function_">redirectTo</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/login/login'</span> });
Â  Â   }
Â   }
Â };
</code></pre>
<h4 data-id="heading-22">é€‚ç”¨åœºæ™¯ ğŸš€</h4>
<ul>
<li>H5 ç«¯ï¼šç”¨æˆ·æŒ‰ F5 åˆ·æ–°é¡µé¢åï¼Œè·¯ç”±æ‹¦æˆªå¯èƒ½æœªé‡æ–°æ‰§è¡Œï¼Œ<code>onLoad</code> æ ¡éªŒä¼šç”Ÿæ•ˆï¼›</li>
<li>å°ç¨‹åºç«¯ï¼šé¡µé¢è¢«åˆ†äº«åï¼Œç”¨æˆ·æ‰“å¼€æ—¶å¯èƒ½è·³è¿‡è·¯ç”±æ‹¦æˆªï¼Œéœ€é€šè¿‡é¡µé¢çº§æ ¡éªŒå…œåº•ã€‚</li>
</ul>
<h3 data-id="heading-23">è¿›é˜¶ä¼˜åŒ–ï¼šå°ç™½ä¹Ÿèƒ½æŒæ¡çš„å®ç”¨æŠ€å·§</h3>
<p>åŸºç¡€ç™»å½•æ‹¦æˆªå®ç°åï¼Œå¯é€šè¿‡ä»¥ä¸‹ä¼˜åŒ–è®©åŠŸèƒ½æ›´ç¨³å®šï¼Œåº”å¯¹å®é™…å¼€å‘ä¸­çš„å¤æ‚åœºæ™¯ã€‚</p>
<h4 data-id="heading-24">1. ç™½åå•é…ç½®ï¼ˆç®€åŒ–æ‹¦æˆªé€»è¾‘ï¼‰</h4>
<p>éƒ¨åˆ†é¡µé¢ / æ¥å£æ— éœ€ç™»å½•å³å¯è®¿é—®ï¼ˆå¦‚é¦–é¡µã€æ³¨å†Œé¡µã€ç™»å½•æ¥å£æœ¬èº«ï¼‰ï¼Œå¯é€šè¿‡ã€Œç™½åå•ã€ç»Ÿä¸€ç®¡ç†ï¼Œé¿å…åœ¨æ‹¦æˆªå™¨ä¸­å†™å¤§é‡åˆ¤æ–­ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-comment">// 1. é¡µé¢ç™½åå•ï¼šæ— éœ€ç™»å½•å³å¯è®¿é—®çš„é¡µé¢è·¯å¾„</span>
Â <span class="hljs-keyword">const</span> pageWhiteList = [
Â  Â <span class="hljs-string">'/pages/login/login'</span>, <span class="hljs-comment">// ç™»å½•é¡µ</span>
Â  Â <span class="hljs-string">'/pages/register/register'</span>, <span class="hljs-comment">// æ³¨å†Œé¡µ</span>
Â  Â <span class="hljs-string">'/pages/index/index'</span> <span class="hljs-comment">// é¦–é¡µ</span>
Â ];
Â â€‹
Â <span class="hljs-comment">// 2. æ¥å£ç™½åå•ï¼šæ— éœ€ token å³å¯è®¿é—®çš„æ¥å£åœ°å€</span>
Â <span class="hljs-keyword">const</span> apiWhiteList = [
Â  Â <span class="hljs-string">'/login'</span>, <span class="hljs-comment">// ç™»å½•æ¥å£</span>
Â  Â <span class="hljs-string">'/register'</span>, <span class="hljs-comment">// æ³¨å†Œæ¥å£</span>
Â  Â <span class="hljs-string">'/home/banner'</span> <span class="hljs-comment">// é¦–é¡µè½®æ’­å›¾æ¥å£</span>
Â ];
Â â€‹
Â <span class="hljs-comment">// 3. è·¯ç”±æ‹¦æˆªä¸­ä½¿ç”¨é¡µé¢ç™½åå•</span>
Â routeTypes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">type</span> =&gt;</span> {
Â  Â uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-keyword">type</span>, {
Â  Â  Â <span class="hljs-title function_">invoke</span>(<span class="hljs-params">options</span>) {
Â  Â  Â  Â <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userToken'</span>);
Â  Â  Â  Â <span class="hljs-comment">// æ ¡éªŒé€»è¾‘ï¼šä¸åœ¨ç™½åå• + æ—  token â†’ è·³è½¬ç™»å½•é¡µ</span>
Â  Â  Â  Â <span class="hljs-keyword">if</span> (!pageWhiteList.<span class="hljs-title function_">includes</span>(options.<span class="hljs-property">url</span>) &amp;&amp; !token) {
Â  Â  Â  Â  Â uni.<span class="hljs-title function_">redirectTo</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/login/login'</span> });
Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
Â  Â  Â   }
Â  Â   }
Â   });
Â });
Â â€‹
Â <span class="hljs-comment">// 4. è¯·æ±‚æ‹¦æˆªä¸­ä½¿ç”¨æ¥å£ç™½åå•</span>
Â uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-string">'request'</span>, {
Â  Â <span class="hljs-title function_">invoke</span>(<span class="hljs-params">options</span>) {
Â  Â  Â <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userToken'</span>);
Â  Â  Â <span class="hljs-comment">// æ ¡éªŒé€»è¾‘ï¼šä¸åœ¨ç™½åå• + æœ‰ token â†’ æ·»åŠ  token åˆ°è¯·æ±‚å¤´</span>
Â  Â  Â <span class="hljs-keyword">if</span> (!apiWhiteList.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">api</span> =&gt;</span> options.<span class="hljs-property">url</span>.<span class="hljs-title function_">includes</span>(api)) &amp;&amp; token) {
Â  Â  Â  Â options.<span class="hljs-property">header</span> = options.<span class="hljs-property">header</span> || {};
Â  Â  Â  Â options.<span class="hljs-property">header</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>;
Â  Â   }
Â   }
Â });
</code></pre>
<h4 data-id="heading-25">2. é¿å…é‡å¤è·³è½¬ç™»å½•é¡µï¼ˆé”æœºåˆ¶ï¼‰</h4>
<p>å½“ç”¨æˆ·å¿«é€Ÿç‚¹å‡»å¤šä¸ªéœ€è¦æƒé™çš„æŒ‰é’®æ—¶ï¼Œå¯èƒ½è§¦å‘å¤šæ¬¡è·¯ç”±æ‹¦æˆªï¼Œå¯¼è‡´å¤šæ¬¡è·³è½¬ç™»å½•é¡µï¼Œéœ€é€šè¿‡ã€Œé”æœºåˆ¶ã€é¿å…ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">Â // å®šä¹‰å…¨å±€é”ï¼šæ ‡è®°æ˜¯å¦å·²åœ¨è·³è½¬ç™»å½•é¡µ
Â let <span class="hljs-attr">isRedirecting</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
Â â€‹
Â // è·¯ç”±æ‹¦æˆªä¸­æ·»åŠ é”é€»è¾‘
Â routeTypes.forEach(<span class="hljs-attr">type</span> =&gt; {
Â  Â uni.addInterceptor(type, {
Â  Â  Â invoke(options) {
Â  Â  Â  Â const <span class="hljs-attr">token</span> = uni.getStorageSync(<span class="hljs-string">'userToken'</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â if (!token &amp;&amp; !options.url.includes('/pages/login/login')) {
Â  Â  Â  Â  Â // æœªåœ¨è·³è½¬ä¸­æ‰æ‰§è¡Œè·³è½¬
Â  Â  Â  Â  Â if (!isRedirecting) {
Â  Â  Â  Â  Â  Â <span class="hljs-attr">isRedirecting</span> = <span class="hljs-literal">true</span><span class="hljs-comment">; // ä¸Šé”</span>
Â  Â  Â  Â  Â  Â uni.redirectTo({
Â  Â  Â  Â  Â  Â  Â url: '/pages/login/login',
Â  Â  Â  Â  Â  Â  Â success() {
Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">isRedirecting</span> = <span class="hljs-literal">false</span><span class="hljs-comment">; // è·³è½¬æˆåŠŸåè§£é”</span>
Â  Â  Â  Â  Â  Â   }
Â  Â  Â  Â  Â   })<span class="hljs-comment">;</span>
Â  Â  Â  Â   }
Â  Â  Â  Â  Â return false<span class="hljs-comment">;</span>
Â  Â  Â   }
Â  Â   }
Â   })<span class="hljs-comment">;</span>
Â })<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-26">3. Token è¿‡æœŸå¤„ç†ï¼ˆåˆ·æ–° Tokenï¼‰</h4>
<p>token æœ‰æœ‰æ•ˆæœŸï¼ˆå¦‚ 2 å°æ—¶ï¼‰ï¼Œè¿‡æœŸåéœ€é‡æ–°ç™»å½•ï¼Œå½±å“ç”¨æˆ·ä½“éªŒï¼Œå¯é€šè¿‡ã€Œåˆ·æ–° tokenã€ä¼˜åŒ–ï¼šåç«¯è¿”å›ä¸¤ä¸ª tokenï¼ˆçŸ­æœŸè®¿é—®ä»¤ç‰Œ <code>accessToken</code> + é•¿æœŸåˆ·æ–°ä»¤ç‰Œ <code>refreshToken</code>ï¼‰ï¼Œåˆ°æœŸå‰è‡ªåŠ¨ç”¨ <code>refreshToken</code> æ¢å–æ–°çš„ <code>accessToken</code>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">Â <span class="hljs-comment">// ç™»å½•æˆåŠŸåå­˜å‚¨ä¸¤ä¸ª token</span>
Â <span class="hljs-keyword">if</span> (res.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
Â  Â <span class="hljs-keyword">const</span> { accessToken, refreshToken, expiresIn } = res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>;
Â  Â uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'accessToken'</span>, accessToken); <span class="hljs-comment">// çŸ­æœŸè®¿é—®ä»¤ç‰Œï¼ˆ2å°æ—¶ï¼‰</span>
Â  Â uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'refreshToken'</span>, refreshToken); <span class="hljs-comment">// é•¿æœŸåˆ·æ–°ä»¤ç‰Œï¼ˆ7å¤©ï¼‰</span>
Â  Â <span class="hljs-comment">// å­˜å‚¨è¿‡æœŸæ—¶é—´ï¼ˆå½“å‰æ—¶é—´ + æœ‰æ•ˆæœŸæ¯«ç§’æ•°ï¼‰</span>
Â  Â uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'tokenExpireTime'</span>, <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + expiresIn * <span class="hljs-number">1000</span>);
Â }
Â â€‹
Â <span class="hljs-comment">// è¯·æ±‚æ‹¦æˆªä¸­æ·»åŠ åˆ·æ–° token é€»è¾‘</span>
Â uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-string">'request'</span>, {
Â  Â <span class="hljs-keyword">async</span> <span class="hljs-title function_">invoke</span>(<span class="hljs-params">options</span>) {
Â  Â  Â <span class="hljs-keyword">const</span> accessToken = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'accessToken'</span>);
Â  Â  Â <span class="hljs-keyword">const</span> refreshToken = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'refreshToken'</span>);
Â  Â  Â <span class="hljs-keyword">const</span> expireTime = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'tokenExpireTime'</span>);
Â  Â  Â 
Â  Â  Â <span class="hljs-comment">// è·³è¿‡ç™½åå•æ¥å£</span>
Â  Â  Â <span class="hljs-keyword">if</span> (apiWhiteList.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">api</span> =&gt;</span> options.<span class="hljs-property">url</span>.<span class="hljs-title function_">includes</span>(api))) <span class="hljs-keyword">return</span>;
Â  Â  Â 
Â  Â  Â <span class="hljs-comment">// token å³å°†è¿‡æœŸï¼ˆå‰©ä½™ 5 åˆ†é’Ÿï¼‰ä¸”æœ‰åˆ·æ–°ä»¤ç‰Œï¼Œè‡ªåŠ¨åˆ·æ–°</span>
Â  Â  Â <span class="hljs-keyword">if</span> (accessToken &amp;&amp; expireTime - <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &lt; <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span> &amp;&amp; refreshToken) {
Â  Â  Â  Â <span class="hljs-keyword">const</span> refreshRes = <span class="hljs-keyword">await</span> uni.<span class="hljs-title function_">request</span>({
Â  Â  Â  Â  Â <span class="hljs-attr">url</span>: <span class="hljs-string">'https://api.example.com/refreshToken'</span>, <span class="hljs-comment">// åç«¯åˆ·æ–°æ¥å£</span>
Â  Â  Â  Â  Â <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
Â  Â  Â  Â  Â <span class="hljs-attr">data</span>: { refreshToken }
Â  Â  Â   });
Â  Â  Â  Â 
Â  Â  Â  Â <span class="hljs-keyword">if</span> (refreshRes.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
Â  Â  Â  Â  Â <span class="hljs-comment">// åˆ·æ–°æˆåŠŸï¼šæ›´æ–°æœ¬åœ° token å’Œè¿‡æœŸæ—¶é—´</span>
Â  Â  Â  Â  Â uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'accessToken'</span>,&lt;/doubaocanvas&gt;
</code></pre>
<blockquote>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Sequelize è¯¦ç»†æŒ‡å—]]></title>    <link>https://juejin.cn/post/7579093412331569162</link>    <guid>https://juejin.cn/post/7579093412331569162</guid>    <pubDate>2025-12-02T14:10:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579093412331569162" data-draft-id="7579068270294777882" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Sequelize è¯¦ç»†æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2025-12-02T14:10:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†™ä»£ç çš„çš®ç­è‰‡"/> <meta itemprop="url" content="https://juejin.cn/user/4196178024218520"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Sequelize è¯¦ç»†æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4196178024218520/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†™ä»£ç çš„çš®ç­è‰‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T14:10:17.000Z" title="Tue Dec 02 2025 14:10:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Sequelize è¯¦ç»†æŒ‡å—</h2>
<p>æœ€è¿‘åœ¨å·¥ä½œä¸­é‡åˆ°äº†ä½¿ç”¨JSå»å®Œæˆserviceå±‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œä»¥åŠæ•°æ®åº“æ“ä½œï¼Œç°åœ¨ä¸‹æ¥è¡¥è¯¾</p>
<h3 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯ Sequelizeï¼Ÿ</h3>
<p><strong>Sequelize</strong> æ˜¯ä¸€ä¸ªåŸºäº Node.js çš„ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰å·¥å…·ï¼Œç”¨äºåœ¨ Node.js ç¯å¢ƒä¸­æ“ä½œå…³ç³»å‹æ•°æ®åº“ã€‚å®ƒæ”¯æŒå¤šç§æ•°æ®åº“ç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>PostgreSQL</li>
<li>MySQL</li>
<li>MariaDB</li>
<li>SQLite</li>
<li>Microsoft SQL Server</li>
</ul>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒç‰¹æ€§</h3>
<h4 data-id="heading-3">1. å¤šæ•°æ®åº“æ”¯æŒ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">Sequelize</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'sequelize'</span>);

<span class="hljs-comment">// è¿æ¥ä¸åŒæ•°æ®åº“</span>
<span class="hljs-keyword">const</span> sequelize = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sequelize</span>(<span class="hljs-string">'database'</span>, <span class="hljs-string">'username'</span>, <span class="hljs-string">'password'</span>, {
  <span class="hljs-attr">dialect</span>: <span class="hljs-string">'mysql'</span>, <span class="hljs-comment">// æˆ– 'postgres', 'sqlite', 'mssql'</span>
  <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
  <span class="hljs-attr">port</span>: <span class="hljs-number">3306</span>
});
</code></pre>
<h4 data-id="heading-4">2. æ¨¡å‹å®šä¹‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">DataTypes</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'sequelize'</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title class_">User</span> = sequelize.<span class="hljs-title function_">define</span>(<span class="hljs-string">'User'</span>, {
  <span class="hljs-attr">id</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">INTEGER</span>,
    <span class="hljs-attr">primaryKey</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">autoIncrement</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-attr">username</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">DataTypes</span>.<span class="hljs-title function_">STRING</span>(<span class="hljs-number">50</span>),
    <span class="hljs-attr">allowNull</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-attr">email</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">STRING</span>,
    <span class="hljs-attr">validate</span>: {
      <span class="hljs-attr">isEmail</span>: <span class="hljs-literal">true</span>
    }
  },
  <span class="hljs-attr">age</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">INTEGER</span>,
    <span class="hljs-attr">defaultValue</span>: <span class="hljs-number">18</span>
  },
  <span class="hljs-attr">isActive</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">BOOLEAN</span>,
    <span class="hljs-attr">defaultValue</span>: <span class="hljs-literal">true</span>
  }
}, {
  <span class="hljs-attr">tableName</span>: <span class="hljs-string">'users'</span>, <span class="hljs-comment">// è‡ªå®šä¹‰è¡¨å</span>
  <span class="hljs-attr">timestamps</span>: <span class="hljs-literal">true</span>,   <span class="hljs-comment">// è‡ªåŠ¨æ·»åŠ  createdAt å’Œ updatedAt</span>
  <span class="hljs-attr">paranoid</span>: <span class="hljs-literal">true</span>      <span class="hljs-comment">// è½¯åˆ é™¤ï¼ˆæ·»åŠ  deletedAtï¼‰</span>
});
</code></pre>
<p>å…¶ä¸­å®šä¹‰æ¨¡å‹æ—¶è¿˜æœ‰å¾ˆå¤šå…¶ä»–å±æ€§ï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥é˜…</p>
<h4 data-id="heading-5">3. å…³è”å…³ç³»</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸€å¯¹ä¸€</span>
<span class="hljs-title class_">User</span>.<span class="hljs-title function_">hasOne</span>(<span class="hljs-title class_">Profile</span>);
<span class="hljs-title class_">Profile</span>.<span class="hljs-title function_">belongsTo</span>(<span class="hljs-title class_">User</span>);

<span class="hljs-comment">// ä¸€å¯¹å¤š</span>
<span class="hljs-title class_">User</span>.<span class="hljs-title function_">hasMany</span>(<span class="hljs-title class_">Post</span>);
<span class="hljs-title class_">Post</span>.<span class="hljs-title function_">belongsTo</span>(<span class="hljs-title class_">User</span>);

<span class="hljs-comment">// å¤šå¯¹å¤š</span>
<span class="hljs-title class_">User</span>.<span class="hljs-title function_">belongsToMany</span>(<span class="hljs-title class_">Role</span>, { <span class="hljs-attr">through</span>: <span class="hljs-string">'UserRoles'</span> });
<span class="hljs-title class_">Role</span>.<span class="hljs-title function_">belongsToMany</span>(<span class="hljs-title class_">User</span>, { <span class="hljs-attr">through</span>: <span class="hljs-string">'UserRoles'</span> });
</code></pre>
<p>å…¶ä¸­å®šä¹‰å…³è”å…³ç³»æ—¶ï¼Œå¯ä»¥æ ¹æ®è¡¨ä¸è¡¨ä¹‹é—´çš„å¤–é”®è¿›è¡Œå…³è”</p>
<h4 data-id="heading-6">3. å…³è”å…³ç³»</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸€å¯¹ä¸€</span>
<span class="hljs-title class_">Profile</span>.<span class="hljs-title function_">belongsTo</span>(<span class="hljs-title class_">User</span>, {
  <span class="hljs-attr">foreignKey</span>: <span class="hljs-string">'userId'</span>, <span class="hljs-comment">// Profile è¡¨ä¸­çš„å¤–é”®å­—æ®µå</span>
  <span class="hljs-attr">targetKey</span>: <span class="hljs-string">'id'</span>       <span class="hljs-comment">// å¼•ç”¨ User è¡¨çš„å“ªä¸ªå­—æ®µï¼ˆé»˜è®¤æ˜¯ä¸»é”®ï¼‰</span>
});

<span class="hljs-comment">// è¿˜æœ‰å¾ˆå¤šå…¶ä»–å±æ€§</span>
</code></pre>
<h3 data-id="heading-7">ä¸‰ã€åŸºæœ¬ä½¿ç”¨</h3>
<h4 data-id="heading-8">1. å®‰è£…ä¸é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">npm install sequelize
<span class="hljs-comment"># å®‰è£…å¯¹åº”çš„æ•°æ®åº“é©±åŠ¨</span>
npm install pg pg-hstore       <span class="hljs-comment"># PostgreSQL</span>
npm install mysql2             <span class="hljs-comment"># MySQL</span>
npm install mariadb            <span class="hljs-comment"># MariaDB</span>
npm install sqlite3            <span class="hljs-comment"># SQLite</span>
npm install tedious            <span class="hljs-comment"># SQL Server</span>
</code></pre>
<h4 data-id="heading-9">2. è¿æ¥æ•°æ®åº“</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">Sequelize</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'sequelize'</span>);

<span class="hljs-keyword">const</span> sequelize = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sequelize</span>({
  <span class="hljs-attr">database</span>: <span class="hljs-string">'my_database'</span>,
  <span class="hljs-attr">username</span>: <span class="hljs-string">'root'</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">'password'</span>,
  <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
  <span class="hljs-attr">dialect</span>: <span class="hljs-string">'mysql'</span>,
  
  <span class="hljs-comment">// è¿æ¥æ± é…ç½®</span>
  <span class="hljs-attr">pool</span>: {
    <span class="hljs-attr">max</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">acquire</span>: <span class="hljs-number">30000</span>,
    <span class="hljs-attr">idle</span>: <span class="hljs-number">10000</span>
  },
  
  <span class="hljs-comment">// æ—¥å¿—é…ç½®</span>
  <span class="hljs-attr">logging</span>: <span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>, <span class="hljs-comment">// æˆ– false ç¦ç”¨æ—¥å¿—</span>
  
  <span class="hljs-comment">// æ—¶åŒºé…ç½®</span>
  <span class="hljs-attr">timezone</span>: <span class="hljs-string">'+08:00'</span>
});
</code></pre>
<h4 data-id="heading-10">3. æµ‹è¯•è¿æ¥</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testConnection</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> sequelize.<span class="hljs-title function_">authenticate</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¿æ¥æˆåŠŸï¼'</span>);
    
    <span class="hljs-comment">// åŒæ­¥æ¨¡å‹åˆ°æ•°æ®åº“</span>
    <span class="hljs-keyword">await</span> sequelize.<span class="hljs-title function_">sync</span>({ <span class="hljs-attr">force</span>: <span class="hljs-literal">false</span> }); <span class="hljs-comment">// force: true ä¼šåˆ é™¤ç°æœ‰è¡¨</span>
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¿æ¥å¤±è´¥:'</span>, error);
  }
}
</code></pre>
<h3 data-id="heading-11">å››ã€CRUD æ“ä½œ</h3>
<h4 data-id="heading-12">1. åˆ›å»ºè®°å½•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹æ³•ä¸€ï¼šä½¿ç”¨ create</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">username</span>: <span class="hljs-string">'john_doe'</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">'john@example.com'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
});

<span class="hljs-comment">// æ–¹æ³•äºŒï¼šå…ˆæ„å»ºåä¿å­˜</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-title class_">User</span>.<span class="hljs-title function_">build</span>({
  <span class="hljs-attr">username</span>: <span class="hljs-string">'jane_doe'</span>
});
<span class="hljs-keyword">await</span> user.<span class="hljs-title function_">save</span>();

<span class="hljs-comment">// æ‰¹é‡åˆ›å»º</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">bulkCreate</span>([
  { <span class="hljs-attr">username</span>: <span class="hljs-string">'user1'</span> },
  { <span class="hljs-attr">username</span>: <span class="hljs-string">'user2'</span> }
]);
</code></pre>
<h4 data-id="heading-13">2. æŸ¥è¯¢è®°å½•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æŸ¥è¯¢æ‰€æœ‰</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findAll</span>();

<span class="hljs-comment">// æ¡ä»¶æŸ¥è¯¢</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findOne</span>({
  <span class="hljs-attr">where</span>: {
    <span class="hljs-attr">username</span>: <span class="hljs-string">'john_doe'</span>,
    <span class="hljs-attr">isActive</span>: <span class="hljs-literal">true</span>
  }
});

<span class="hljs-comment">// ä½¿ç”¨è¿ç®—ç¬¦</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findAll</span>({
  <span class="hljs-attr">where</span>: {
    <span class="hljs-attr">age</span>: {
      [<span class="hljs-title class_">Op</span>.<span class="hljs-property">gt</span>]: <span class="hljs-number">18</span>,      <span class="hljs-comment">// å¤§äº</span>
      [<span class="hljs-title class_">Op</span>.<span class="hljs-property">lte</span>]: <span class="hljs-number">65</span>      <span class="hljs-comment">// å°äºç­‰äº</span>
    },
    <span class="hljs-attr">username</span>: {
      [<span class="hljs-title class_">Op</span>.<span class="hljs-property">like</span>]: <span class="hljs-string">'%john%'</span> <span class="hljs-comment">// æ¨¡ç³ŠæŸ¥è¯¢</span>
    }
  }
});

<span class="hljs-comment">// æ’åºå’Œåˆ†é¡µ</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findAll</span>({
  <span class="hljs-attr">order</span>: [[<span class="hljs-string">'createdAt'</span>, <span class="hljs-string">'DESC'</span>]],
  <span class="hljs-attr">limit</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">offset</span>: <span class="hljs-number">20</span>
});

<span class="hljs-comment">// é€‰æ‹©ç‰¹å®šå­—æ®µ</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findAll</span>({
  <span class="hljs-attr">attributes</span>: [<span class="hljs-string">'id'</span>, <span class="hljs-string">'username'</span>, <span class="hljs-string">'email'</span>]
});
</code></pre>
<h4 data-id="heading-14">3. æ›´æ–°è®°å½•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹æ³•ä¸€ï¼šå…ˆæŸ¥è¯¢åæ›´æ–°</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findByPk</span>(<span class="hljs-number">1</span>);
<span class="hljs-keyword">if</span> (user) {
  user.<span class="hljs-property">username</span> = <span class="hljs-string">'new_name'</span>;
  <span class="hljs-keyword">await</span> user.<span class="hljs-title function_">save</span>();
}

<span class="hljs-comment">// æ–¹æ³•äºŒï¼šç›´æ¥æ›´æ–°</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">update</span>(
  { <span class="hljs-attr">username</span>: <span class="hljs-string">'new_name'</span> },
  { <span class="hljs-attr">where</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span> } }
);

<span class="hljs-comment">// æ›´æ–°å¤šä¸ª</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">update</span>(
  { <span class="hljs-attr">isActive</span>: <span class="hljs-literal">false</span> },
  { <span class="hljs-attr">where</span>: { <span class="hljs-attr">age</span>: { [<span class="hljs-title class_">Op</span>.<span class="hljs-property">lt</span>]: <span class="hljs-number">18</span> } } }
);
</code></pre>
<h4 data-id="heading-15">4. åˆ é™¤è®°å½•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è½¯åˆ é™¤ï¼ˆå¦‚æœå¯ç”¨äº† paranoidï¼‰</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">destroy</span>({
  <span class="hljs-attr">where</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span> }
});

<span class="hljs-comment">// å¼ºåˆ¶åˆ é™¤ï¼ˆå³ä½¿å¯ç”¨äº† paranoidï¼‰</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">destroy</span>({
  <span class="hljs-attr">where</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span> },
  <span class="hljs-attr">force</span>: <span class="hljs-literal">true</span>
});

<span class="hljs-comment">// åˆ é™¤å¤šä¸ª</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">destroy</span>({
  <span class="hljs-attr">where</span>: { <span class="hljs-attr">isActive</span>: <span class="hljs-literal">false</span> }
});
</code></pre>
<h3 data-id="heading-16">äº”ã€é«˜çº§æŸ¥è¯¢</h3>
<h4 data-id="heading-17">1. å…³è”æŸ¥è¯¢</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŒ…å«å…³è”æ•°æ®</span>
<span class="hljs-keyword">const</span> userWithPosts = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findByPk</span>(<span class="hljs-number">1</span>, {
  <span class="hljs-attr">include</span>: [{
    <span class="hljs-attr">model</span>: <span class="hljs-title class_">Post</span>,
    <span class="hljs-attr">include</span>: [<span class="hljs-title class_">Comment</span>] <span class="hljs-comment">// åµŒå¥—åŒ…å«</span>
  }]
});

<span class="hljs-comment">// è¿‡æ»¤å…³è”æ•°æ®</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findByPk</span>(<span class="hljs-number">1</span>, {
  <span class="hljs-attr">include</span>: [{
    <span class="hljs-attr">model</span>: <span class="hljs-title class_">Post</span>,
    <span class="hljs-attr">where</span>: { <span class="hljs-attr">published</span>: <span class="hljs-literal">true</span> },
    <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// LEFT JOIN</span>
  }]
});
</code></pre>
<h4 data-id="heading-18">2. èšåˆæŸ¥è¯¢</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è®¡æ•°</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">count</span>({
  <span class="hljs-attr">where</span>: { <span class="hljs-attr">isActive</span>: <span class="hljs-literal">true</span> }
});

<span class="hljs-comment">// æ±‚å’Œã€å¹³å‡å€¼ç­‰</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findAll</span>({
  <span class="hljs-attr">attributes</span>: [
    <span class="hljs-string">'department'</span>,
    [sequelize.<span class="hljs-title function_">fn</span>(<span class="hljs-string">'COUNT'</span>, sequelize.<span class="hljs-title function_">col</span>(<span class="hljs-string">'id'</span>)), <span class="hljs-string">'count'</span>],
    [sequelize.<span class="hljs-title function_">fn</span>(<span class="hljs-string">'AVG'</span>, sequelize.<span class="hljs-title function_">col</span>(<span class="hljs-string">'salary'</span>)), <span class="hljs-string">'avg_salary'</span>]
  ],
  <span class="hljs-attr">group</span>: [<span class="hljs-string">'department'</span>]
});
</code></pre>
<h4 data-id="heading-19">3. äº‹åŠ¡å¤„ç†</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> transaction = <span class="hljs-keyword">await</span> sequelize.<span class="hljs-title function_">transaction</span>();

<span class="hljs-keyword">try</span> {
  <span class="hljs-comment">// åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œæ“ä½œ</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">create</span>({
    <span class="hljs-attr">username</span>: <span class="hljs-string">'alice'</span>
  }, { transaction });

  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Profile</span>.<span class="hljs-title function_">create</span>({
    <span class="hljs-attr">userId</span>: user.<span class="hljs-property">id</span>,
    <span class="hljs-attr">bio</span>: <span class="hljs-string">'Hello world'</span>
  }, { transaction });

  <span class="hljs-comment">// æäº¤äº‹åŠ¡</span>
  <span class="hljs-keyword">await</span> transaction.<span class="hljs-title function_">commit</span>();
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-comment">// å›æ»šäº‹åŠ¡</span>
  <span class="hljs-keyword">await</span> transaction.<span class="hljs-title function_">rollback</span>();
}
</code></pre>
<h3 data-id="heading-20">å…­ã€é’©å­ï¼ˆHooksï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">User</span>.<span class="hljs-title function_">beforeCreate</span>(<span class="hljs-keyword">async</span> (user, options) =&gt; {
  user.<span class="hljs-property">username</span> = user.<span class="hljs-property">username</span>.<span class="hljs-title function_">toLowerCase</span>();
});

<span class="hljs-title class_">User</span>.<span class="hljs-title function_">afterCreate</span>(<span class="hljs-keyword">async</span> (user, options) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç”¨æˆ· <span class="hljs-subst">${user.username}</span> å·²åˆ›å»º`</span>);
});

<span class="hljs-title class_">User</span>.<span class="hljs-title function_">beforeUpdate</span>(<span class="hljs-keyword">async</span> (user, options) =&gt; {
  user.<span class="hljs-property">updatedAt</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
});

<span class="hljs-title class_">User</span>.<span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-keyword">async</span> (user, options) =&gt; {
  <span class="hljs-comment">// åˆ é™¤å‰çš„æ¸…ç†æ“ä½œ</span>
});
</code></pre>
<h3 data-id="heading-21">ä¸ƒã€æ•°æ®éªŒè¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">User</span> = sequelize.<span class="hljs-title function_">define</span>(<span class="hljs-string">'User'</span>, {
  <span class="hljs-attr">email</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">STRING</span>,
    <span class="hljs-attr">validate</span>: {
      <span class="hljs-attr">isEmail</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">isLowercase</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">len</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">100</span>]
    }
  },
  <span class="hljs-attr">age</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">INTEGER</span>,
    <span class="hljs-attr">validate</span>: {
      <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">max</span>: <span class="hljs-number">150</span>,
      <span class="hljs-title function_">isEven</span>(<span class="hljs-params">value</span>) {
        <span class="hljs-keyword">if</span> (value % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å¹´é¾„å¿…é¡»æ˜¯å¶æ•°'</span>);
        }
      }
    }
  }
});

<span class="hljs-comment">// è‡ªå®šä¹‰éªŒè¯æ¶ˆæ¯</span>
<span class="hljs-attr">validate</span>: {
  <span class="hljs-attr">isEmail</span>: {
    <span class="hljs-attr">msg</span>: <span class="hljs-string">'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'</span>
  }
}
</code></pre>
<h3 data-id="heading-22">å…«ã€è¿ç§»ä¸ç§å­æ•°æ®</h3>
<h4 data-id="heading-23">1. ä½¿ç”¨ Sequelize CLI</h4>
<pre><code class="hljs language-bash" lang="bash">npm install --save-dev sequelize-cli
npx sequelize-cli init
</code></pre>
<h4 data-id="heading-24">2. åˆ›å»ºè¿ç§»æ–‡ä»¶</h4>
<pre><code class="hljs language-bash" lang="bash">npx sequelize-cli migration:generate --name create-users-table
</code></pre>
<h4 data-id="heading-25">3. è¿ç§»æ–‡ä»¶ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">up</span>: <span class="hljs-keyword">async</span> (queryInterface, <span class="hljs-title class_">Sequelize</span>) =&gt; {
    <span class="hljs-keyword">await</span> queryInterface.<span class="hljs-title function_">createTable</span>(<span class="hljs-string">'Users'</span>, {
      <span class="hljs-attr">id</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-title class_">Sequelize</span>.<span class="hljs-property">INTEGER</span>,
        <span class="hljs-attr">primaryKey</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">autoIncrement</span>: <span class="hljs-literal">true</span>
      },
      <span class="hljs-attr">username</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-title class_">Sequelize</span>.<span class="hljs-property">STRING</span>,
        <span class="hljs-attr">allowNull</span>: <span class="hljs-literal">false</span>
      },
      <span class="hljs-attr">createdAt</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-title class_">Sequelize</span>.<span class="hljs-property">DATE</span>,
        <span class="hljs-attr">allowNull</span>: <span class="hljs-literal">false</span>
      },
      <span class="hljs-attr">updatedAt</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-title class_">Sequelize</span>.<span class="hljs-property">DATE</span>,
        <span class="hljs-attr">allowNull</span>: <span class="hljs-literal">false</span>
      }
    });
  },

  <span class="hljs-attr">down</span>: <span class="hljs-keyword">async</span> (queryInterface, <span class="hljs-title class_">Sequelize</span>) =&gt; {
    <span class="hljs-keyword">await</span> queryInterface.<span class="hljs-title function_">dropTable</span>(<span class="hljs-string">'Users'</span>);
  }
};
</code></pre>
<h3 data-id="heading-26">ä¹ã€æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-27">1. è¿æ¥æ± é…ç½®</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> sequelize = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sequelize</span>({
  <span class="hljs-comment">// ... å…¶ä»–é…ç½®</span>
  <span class="hljs-attr">pool</span>: {
    <span class="hljs-attr">max</span>: <span class="hljs-number">20</span>,        <span class="hljs-comment">// æœ€å¤§è¿æ¥æ•°</span>
    <span class="hljs-attr">min</span>: <span class="hljs-number">5</span>,         <span class="hljs-comment">// æœ€å°è¿æ¥æ•°</span>
    <span class="hljs-attr">acquire</span>: <span class="hljs-number">30000</span>, <span class="hljs-comment">// è·å–è¿æ¥çš„è¶…æ—¶æ—¶é—´</span>
    <span class="hljs-attr">idle</span>: <span class="hljs-number">10000</span>     <span class="hljs-comment">// è¿æ¥ç©ºé—²æ—¶é—´</span>
  }
});
</code></pre>
<h4 data-id="heading-28">2. æŸ¥è¯¢ä¼˜åŒ–</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åªé€‰æ‹©éœ€è¦çš„å­—æ®µ</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findAll</span>({
  <span class="hljs-attr">attributes</span>: [<span class="hljs-string">'id'</span>, <span class="hljs-string">'username'</span>]
});

<span class="hljs-comment">// ä½¿ç”¨åŸç”ŸæŸ¥è¯¢å¤„ç†å¤æ‚æŸ¥è¯¢</span>
<span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> sequelize.<span class="hljs-title function_">query</span>(
  <span class="hljs-string">'SELECT * FROM users WHERE age &gt; :age'</span>,
  {
    <span class="hljs-attr">replacements</span>: { <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> },
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">QueryTypes</span>.<span class="hljs-property">SELECT</span>
  }
);
</code></pre>
<h4 data-id="heading-29">3. ç´¢å¼•ä¼˜åŒ–</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">User</span>.<span class="hljs-title function_">init</span>({
  <span class="hljs-comment">// ... å­—æ®µå®šä¹‰</span>
}, {
  sequelize,
  <span class="hljs-attr">indexes</span>: [
    {
      <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">fields</span>: [<span class="hljs-string">'email'</span>]
    },
    {
      <span class="hljs-attr">fields</span>: [<span class="hljs-string">'createdAt'</span>]
    }
  ]
});
</code></pre>
<h3 data-id="heading-30">åã€æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>æ¨¡å‹ç»„ç»‡</strong>ï¼šå°†æ¨¡å‹å®šä¹‰æ”¾åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šç»Ÿä¸€å¤„ç†æ•°æ®åº“é”™è¯¯</li>
<li><strong>ç¯å¢ƒé…ç½®</strong>ï¼šä½¿ç”¨ä¸åŒç¯å¢ƒçš„é…ç½®</li>
<li><strong>å®šæœŸç»´æŠ¤</strong>ï¼šæ¸…ç†æ—§æ•°æ®ï¼Œä¼˜åŒ–ç´¢å¼•</li>
<li><strong>ç›‘æ§</strong>ï¼šç›‘æ§æŸ¥è¯¢æ€§èƒ½å’Œè¿æ¥çŠ¶æ€</li>
</ol>
<h3 data-id="heading-31">åä¸€ã€å¸¸è§é—®é¢˜</h3>
<h4 data-id="heading-32">1. N+1 æŸ¥è¯¢é—®é¢˜</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸å¥½çš„åšæ³•ï¼šä¼šå¯¼è‡´ N+1 æŸ¥è¯¢</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findAll</span>();
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> user <span class="hljs-keyword">of</span> users) {
  <span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">await</span> user.<span class="hljs-title function_">getPosts</span>(); <span class="hljs-comment">// æ¯æ¬¡å¾ªç¯éƒ½æŸ¥è¯¢æ•°æ®åº“</span>
}

<span class="hljs-comment">// å¥½çš„åšæ³•ï¼šä½¿ç”¨é¢„åŠ è½½</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findAll</span>({
  <span class="hljs-attr">include</span>: [<span class="hljs-title class_">Post</span>]
});
</code></pre>
<h4 data-id="heading-33">2. æ•°æ®ç±»å‹æ˜ å°„</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Sequelize æ•°æ®ç±»å‹å¯¹åº”å…³ç³»</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">STRING</span>      <span class="hljs-comment">// VARCHAR(255)</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-title function_">STRING</span>(<span class="hljs-number">50</span>)  <span class="hljs-comment">// VARCHAR(50)</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">TEXT</span>        <span class="hljs-comment">// TEXT</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">INTEGER</span>     <span class="hljs-comment">// INTEGER</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">BIGINT</span>      <span class="hljs-comment">// BIGINT</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">FLOAT</span>       <span class="hljs-comment">// FLOAT</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">DOUBLE</span>      <span class="hljs-comment">// DOUBLE</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">DECIMAL</span>     <span class="hljs-comment">// DECIMAL</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">DATE</span>        <span class="hljs-comment">// DATETIME</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">BOOLEAN</span>     <span class="hljs-comment">// TINYINT(1)</span>
<span class="hljs-title class_">DataTypes</span>.<span class="hljs-property">JSON</span>        <span class="hljs-comment">// JSON (ä»…é™ MySQL 5.7+ã€PostgreSQLã€SQLite)</span>
</code></pre>
<h3 data-id="heading-34">æ€»ç»“</h3>
<p>Sequelize æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ ORM å·¥å…·ï¼Œå®ƒæä¾›äº†ï¼š</p>
<ul>
<li>ç®€æ´çš„ API è¿›è¡Œæ•°æ®åº“æ“ä½œ</li>
<li>å¼ºå¤§çš„å…³è”å…³ç³»æ”¯æŒ</li>
<li>æ•°æ®éªŒè¯å’Œé’©å­æœºåˆ¶</li>
<li>äº‹åŠ¡æ”¯æŒå’Œè¿ç§»åŠŸèƒ½</li>
<li>å¤šæ•°æ®åº“å…¼å®¹æ€§</li>
</ul>
<p>é€šè¿‡åˆç†ä½¿ç”¨ Sequelizeï¼Œå¯ä»¥å¤§å¤§æé«˜ Node.js åº”ç”¨ä¸­æ•°æ®åº“æ“ä½œçš„å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>