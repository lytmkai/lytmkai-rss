<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[AI ä½¿ç”¨ç»éªŒåˆ†äº«ï¼šä»æ··æ²Œåˆ°ç§©åºçš„æç¤ºè¯å·¥ç¨‹]]></title>    <link>https://juejin.cn/post/7592884480732069934</link>    <guid>https://juejin.cn/post/7592884480732069934</guid>    <pubDate>2026-01-09T02:44:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592884480732069934" data-draft-id="7592803747472146482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI ä½¿ç”¨ç»éªŒåˆ†äº«ï¼šä»æ··æ²Œåˆ°ç§©åºçš„æç¤ºè¯å·¥ç¨‹"/> <meta itemprop="keywords" content="AIGC,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-09T02:44:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="KaneLogger"/> <meta itemprop="url" content="https://juejin.cn/user/3650034333917031"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI ä½¿ç”¨ç»éªŒåˆ†äº«ï¼šä»æ··æ²Œåˆ°ç§©åºçš„æç¤ºè¯å·¥ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3650034333917031/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    KaneLogger
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:44:51.000Z" title="Fri Jan 09 2026 02:44:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3de00d1e79e846a6ae4cca70bea97abe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS2FuZUxvZ2dlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531490&amp;x-signature=k%2F%2BBz%2BUZ6jRcBV%2FVdDdvxcKZuoc%3D" alt="Taming_AI_Through_Structure-å›¾ç‰‡-0.jpg" loading="lazy"/>
ç°åœ¨çš„ AI æ˜¯é«˜èƒ½åŠ›ä½†é«˜ç†µçš„é»‘ç®±ç³»ç»Ÿã€‚ä½ ç»™å®ƒæ¨¡ç³Šçš„è¾“å…¥(é«˜ç†µ),å®ƒå°±è¿”å›æ··æ²Œçš„è¾“å‡º(ä½ä»·å€¼)ã€‚è¿™ä¸æ˜¯ AI çš„é—®é¢˜,æ˜¯çƒ­åŠ›å­¦ç¬¬äºŒå®šå¾‹åœ¨ä¿¡æ¯ç³»ç»Ÿä¸­çš„ä½“ç°ã€‚è§£å†³æ–¹æ¡ˆåªæœ‰ä¸€ä¸ª:é™ä½è¾“å…¥ç†µã€‚</p>
<p>ç”¨ç»“æ„åŒ–çš„æç¤ºè¯æŠŠç³»ç»Ÿä»"å¸ƒæœ—è¿åŠ¨"è¸¢è¿›"æ¿€å‘æ€"ã€‚
æ¢å¥è¯è¯´å°±æ˜¯æŠŠä½ çš„éœ€æ±‚å†™å¾—åƒç¨‹åºæ¥å£ã€åƒåˆåŒæ¡æ¬¾ã€åƒ SOP æ“ä½œæ‰‹å†Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44ee4f4637ec4a2a8433d0a43e2e4e09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS2FuZUxvZ2dlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531490&amp;x-signature=vOu6G8Is9gSIGm1dFxao%2Bua6uoE%3D" alt="Taming_AI_Through_Structure-å›¾ç‰‡-1.jpg" loading="lazy"/></p>
<h2 data-id="heading-0">ä»»åŠ¡è¯Šæ–­å†³ç­–æ ‘</h2>
<p>ç¬¬ä¸€æ­¥:åˆ¤æ–­ä»»åŠ¡çº§åˆ«</p>
<pre><code class="hljs language-text" lang="text">ä½ æ„¿æ„ä¸ºè¿™ä¸ªä»»åŠ¡èŠ±å¤šå°‘æ—¶é—´ï¼Ÿ
â”œâ”€ &lt; 5åˆ†é’Ÿ â†’ ç”¨"æœ€å°å…¬å¼"(90%çš„æ—¥å¸¸ä»»åŠ¡)
â”œâ”€ 2å°æ—¶å·¦å³ â†’ ä¸Š"8æ­¥æ³•"(éœ€æ±‚åˆ†æã€é•¿æ–‡ç¿»è¯‘)
â””â”€ éœ€è¦åå¤ä½¿ç”¨ â†’ èµ°"æ¨¡æ¿æ²‰æ·€"(æŠ½è±¡æˆå¯å¤ç”¨èµ„äº§)
</code></pre>
<p>ç¬¬äºŒæ­¥:é€‰æ‹©æ¨¡å‹ç­–ç•¥</p>
<pre><code class="hljs language-text" lang="text">ä»»åŠ¡ç‰¹å¾?
â”œâ”€ å¤§é‡çç¢é‡å¤ â†’ å…è´¹æ¨¡å‹è·‘é‡
â”œâ”€ é«˜è´¨é‡å•æ¬¡äº§å‡º â†’ è´µæ¨¡å‹ç²¾å‡†æ‰“å‡»  
â””â”€ åˆ›æ„/ç­–ç•¥ç±» â†’ å¤šæ¨¡å‹å¹¶è¡Œ,æ‹©ä¼˜é‡‡æ ·
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49f9c81353f64632af10ce3d937d3515~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS2FuZUxvZ2dlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531490&amp;x-signature=k9g10bbJe73nmtZpak7J92xxQpk%3D" alt="Taming_AI_Through_Structure-å›¾ç‰‡-2.jpg" loading="lazy"/></p>
<h2 data-id="heading-1">æ—¥å¸¸ä»»åŠ¡çš„æœ€å°å…¬å¼</h2>
<p>æ€è€ƒå…¬å¼ [Personaï¼šè§’è‰²] + [Goalï¼šç›®æ ‡] + [Taskï¼šä»»åŠ¡] + [Contextï¼šèƒŒæ™¯]</p>
<p>åˆ©ç”¨å…¬å¼çš„è¿‡ç¨‹ä¹Ÿæ˜¯å®Œå–„è‡ªå·±éœ€æ±‚çš„è¿‡ç¨‹ã€‚</p>
<p>æ ¸å¿ƒç»“æ„ï¼š</p>
<pre><code class="hljs language-text" lang="text">## è§’è‰²
ä½œä¸º [é¢†åŸŸä¸“å®¶]

## èƒŒæ™¯  
å¿…é¡»é¿å… [ç¦å¿Œé¡¹],ä¼˜å…ˆè€ƒè™‘ [å…³é”®è¦ç´ ]

## ä»»åŠ¡  
å®ç° [å…·ä½“ç›®æ ‡],è¦æ±‚ [é‡åŒ–æ ‡å‡†],æœ€ç»ˆè¾“å‡ºæœåŠ¡äº [ç›®æ ‡ç”¨æˆ·]

## é™åˆ¶  
[æœ€å¤š3æ¡,é‡åŒ–ä¼˜å…ˆ,å¦‚"100å­—å†…""3ä¸ªè¦ç‚¹"]

## è¾“å‡º  
1. ä»¥ Markdown å½¢å¼è¾“å‡º
2. è¾“å‡ºç»“æœå¿…é¡»åŒ…å« [å‚è€ƒèµ„æ–™]
3. è¾“å‡ºé£æ ¼ [çŠ€åˆ©ã€å‡ç»ƒã€æœ‰åŠ›]
4. å±•ç¤ºè‡³å°‘ä¸¤ç§å¤‡é€‰æ–¹æ¡ˆåŠå…¶æ·˜æ±°ç†ç”±

## å¤‡æ³¨
- è¿™å¯¹æˆ‘çš„èŒä¸šç”Ÿæ¶¯éå¸¸é‡è¦!
</code></pre>
<p>å®æˆ˜æ¡ˆä¾‹:ç»™æ–°å®¢æˆ·å†™äº§å“ä»‹ç»é‚®ä»¶</p>
<pre><code class="hljs language-text" lang="text">## è§’è‰²
ä½œä¸º SaaS é”€å”®ä¸“å®¶

## èƒŒæ™¯
å¯¹æ–¹æ˜¯ä¸­å‹ä¼ä¸š CTO,æ¯å¤©æ”¶ 200+ é‚®ä»¶,è®¨åŒè¥é”€è¯æœ¯

## ä»»åŠ¡
ç”¨ 150 å­—å†…è¯´æ¸…æ¥šæˆ‘ä»¬çš„ API ç›‘æ§å·¥å…·èƒ½è§£å†³ä»–ä»€ä¹ˆç—›ç‚¹,æœ€ç»ˆè®©ä»–æ„¿æ„ç‚¹å‡» Demo é“¾æ¥

## é™åˆ¶
- ä¸å‡ºç°"è¡Œä¸šé¢†å…ˆ""èµ‹èƒ½"ç­‰åºŸè¯
- å¿…é¡»æœ‰ 1 ä¸ªå…·ä½“æ•°æ®æ”¯æ’‘
- å¼€å¤´ç¬¬ä¸€å¥å¿…é¡»æ˜¯é—®é¢˜è€Œéè‡ªæˆ‘ä»‹ç»

## è¾“å‡º
ç»™å‡º 2 ä¸ªç‰ˆæœ¬:ä¸€ä¸ªå¼ºè°ƒ"çœé’±",ä¸€ä¸ªå¼ºè°ƒ"é¿å…æ•…éšœ"
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d8aa9a03bbc45c59ac962cdfe203bc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS2FuZUxvZ2dlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531490&amp;x-signature=ANYLcXniBaWMKCo3Op4jYJUFQy8%3D" alt="Taming_AI_Through_Structure-å›¾ç‰‡-3.jpg" loading="lazy"/></p>
<h2 data-id="heading-2">å¤æ‚ä»»åŠ¡çš„ 8 æ­¥æ³•</h2>
<p>æˆ‘ä¸ªäººæ„Ÿè§‰çš„å¤æ‚ä»»åŠ¡ï¼Œæ˜¯å€¼å¾—æˆ‘è‡ªå·±èŠ±2hå»å¤„ç†çš„ä»»åŠ¡ã€‚ä¾‹å¦‚éœ€æ±‚åˆ†æã€ç¿»è¯‘æ–‡ç« ã€‚</p>
<p>æˆ‘ä¼šæŒ‰ç…§ä»¥ä¸‹æµç¨‹è¿›è¡Œå¤„ç†ï¼š</p>
<ol>
<li>æ˜ç¡®é—®é¢˜ä¸ä¸Šä¸‹æ–‡</li>
<li>è®© AI è‡ªé€‰å¿…è¦è§’è‰²</li>
<li>è®© AI è¿ç»­æé—®ï¼Œç›´åˆ° 95% ç†è§£
<ol>
<li>ä¸çŸ¥é“å¦‚ä½•ç•Œå®šæ˜¯å“ªä¸ªé¢†åŸŸçš„é—®é¢˜ï¼Œè®© AI è‡ªé€‰è§’è‰²ï¼Œâ€œä½ ä»¬è®¤ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ€éœ€è¦å“ªä¸‰ç±»ä¸“å®¶è§’è‰²ï¼Ÿæˆ‘ä»¬å…ˆæŒ‰è¿™ä¸ªè§’è‰²åˆ†å·¥æ¥è„‘æš´ã€‚â€</li>
<li>ä¸çŸ¥é“è‡ªå·±æ˜¯å¦æ¸…æ¥šè‡ªå·±æ˜¯å¦å·²ç»å®Œå…¨ææ‡‚é—®é¢˜ï¼Œå¢åŠ ä¸€æ­¥ï¼š"åœ¨è¡ŒåŠ¨å‰ï¼Œè¯·å‘æˆ‘è¿ç»­æé—®ï¼Œç›´åˆ°ä½  95%ç¡®ä¿¡ç†è§£æˆ‘çš„ç›®æ ‡å’Œè¾¹ç•Œã€‚"</li>
</ol>
</li>
<li>å…ˆè·‘ä¸€ä¸ªå…·ä½“æƒ…å¢ƒã€‚</li>
<li>æ ¹æ®è¡¨ç°è¿­ä»£</li>
<li>è®©â€œçº¢é˜Ÿâ€æŒ‘åˆºã€‚æˆç«‹ä¸€ä¸ªå°ç»„ï¼Œå”¯ä¸€ä»»åŠ¡å°±æ˜¯æŒ‘è¿™ä¸ªæ–¹æ¡ˆçš„æ¯›ç—…ã€‚â€œå‡è®¾è¿™ä¸ª[é¡¹ç›®]å½»åº•å¤±è´¥ï¼Œç°åœ¨å¤ç›˜ï¼Œæœ€å¯èƒ½çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿâ€</li>
<li>ç›´åˆ°æŠ½åˆ° SSRï¼Œå°±åŸºäºé‚£ä¸ªå›ç­”å¼€å§‹å¾®è°ƒæç¤ºè¯ï¼Œç›´åˆ°å¯ä»¥ç¨³å®šçš„ç”Ÿæˆç»“æœã€‚</li>
<li>æŠ½è±¡æˆå¯æ‰©å±•çš„æç¤ºæ¨¡æ¿ï¼Œä¾‹å¦‚åŸºç¡€å…¬å¼ï¼šè§’è‰² + èƒŒæ™¯ + ä»»åŠ¡ + è§„åˆ™ + è¦æ±‚ + æ ¼å¼ + èŒƒä¾‹ + ç¦å¿Œ</li>
</ol>
<pre><code class="hljs language-text" lang="text">### è§’è‰²
ä½œä¸º [xxxxx] ä¸“å®¶

### èƒŒæ™¯
å½“å‰é¢ä¸´ [xxxxx] é—®é¢˜  
äº¤ä»£èƒŒæ™¯ä¸å—ä¼—:æ˜ç¡® AI åº”æ‰®æ¼”çš„è§’è‰²ã€ä»»åŠ¡å‘ç”Ÿçš„åœºæ™¯ä»¥åŠç›®æ ‡ç¾¤ä½“

### ä»»åŠ¡ 
ç¬¬ä¸€è½®:åˆ—å‡ºæœ¬å‘¨å®Œæˆçš„ 5 é¡¹é‡ç‚¹å·¥ä½œ  
ç¬¬äºŒè½®:é’ˆå¯¹ç¬¬ä¸‰é¡¹æŠ€æœ¯æ”»å…³,è¯¦ç»†è¯´æ˜é‡åˆ°çš„ 3 ä¸ªéš¾ç‚¹  
ç¬¬ä¸‰è½®:å°†ä¸Šè¿°éš¾ç‚¹è½¬åŒ–ä¸ºå¯è§†åŒ–çš„ç”˜ç‰¹å›¾

### è¦æ±‚
[å…·ä½“è¦æ±‚]

### æ ¼å¼
1. è¯·ä½¿ç”¨ Markdown æ ¼å¼è¾“å‡º  
2. é¦–å…ˆç»™å‡ºä¸€ä¸ª 1-10 åˆ†çš„æ€»ä½“è¯„åˆ†å’Œä¸€å¥è¯æ€»ç»“  
3. ç„¶ååˆ†'ä¼˜åŠ¿'ã€'åŠ£åŠ¿'å’Œ'è‡´å‘½é£é™©'ä¸‰ä¸ªæ¿å—è¿›è¡Œè¯¦ç»†è®ºè¿°

### èŒƒä¾‹
ä¾‹å¦‚,ä½ å¯ä»¥åƒè¿™æ ·æå‡ºè´¨ç–‘:'ä½ çš„è·å®¢æˆæœ¬æ¨¡å‹æ˜¯æ€æ ·çš„?å¦‚ä½•ä¸ç°æœ‰çš„æˆç†Ÿç¤¾äº¤åº”ç”¨ç«äº‰?'
</code></pre>
<p>å¤ç›˜æ£€æŸ¥æ¸…å•ï¼š</p>
<ol>
<li>é¢„æœŸè¾¾åˆ°çš„æ•ˆæœï¼Ÿ</li>
<li>å¦‚ä½•è¯„ä»·ï¼ˆéªŒè¯ï¼‰è¿™æ¬¡ç”Ÿæˆçš„ç»“æœï¼Ÿ</li>
<li>æ˜¯å¦æœ‰æ˜æ˜¾é”™è¯¯ç­”æ¡ˆï¼Ÿä½ æ€ä¹ˆå¤„ç†çš„ï¼Ÿ</li>
<li>ç”Ÿæˆçš„å†…å®¹å’Œä½ çš„é¢„æœŸä¸ç¬¦ï¼Œæˆ‘æ˜¯å¦‚ä½•è°ƒæ•´ä¼˜åŒ–çš„ï¼Ÿ</li>
<li>æˆ‘ä¸ºä»€ä¹ˆè¿™ä¹ˆå†™æç¤ºè¯ï¼Ÿ</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a9e399cdadb433f8cd797a36952c0fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS2FuZUxvZ2dlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531490&amp;x-signature=k8LiTkCbFEJrs0uaVtH7FZHucBE%3D" alt="Taming_AI_Through_Structure-å›¾ç‰‡-4.jpg" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a56c23a1b3bb4525a783eea0cacc7c96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS2FuZUxvZ2dlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531490&amp;x-signature=wXCDg0mnf0babOnJgGKatvRlG2Q%3D" alt="Taming_AI_Through_Structure-å›¾ç‰‡-5.jpg" loading="lazy"/></p>
<h2 data-id="heading-3">æå‡è¾“å‡ºè´¨é‡çš„æ ¸å¿ƒæŠ€å·§</h2>
<h3 data-id="heading-4">ç”Ÿæˆå€™é€‰ç­”æ¡ˆ</h3>
<p>é€‚ç”¨åœºæ™¯:
åˆ›æ„å†™ä½œã€ç­–ç•¥å»ºè®®ã€æšä¸¾ç±»é—®ç­”(æœ‰å¤šä¸ªåˆç†ç­”æ¡ˆçš„åœºæ™¯)
ä¸é€‚ç”¨:
æ ‡å‡†ç®—å¼ã€äº‹å®æ€§é—®ç­”(åªæœ‰ä¸€ä¸ªæ­£ç¡®ç­”æ¡ˆ)</p>
<pre><code class="hljs language-text" lang="text">ä½ æ˜¯ä¸€ä¸ªå¤šæ ·åŒ–ç”Ÿæˆçš„åŠ©æ‰‹ã€‚è¯·æŒ‰ç…§å¦‚ä¸‹è¦æ±‚è¾“å‡ºï¼š
1. ç”Ÿæˆ 5 ä¸ªä¸åŒçš„å€™é€‰ç­”æ¡ˆï¼ˆå†…å®¹å°½é‡æœ‰é£æ ¼å·®å¼‚ï¼‰ã€‚
2. ä¸ºæ¯ä¸ªç­”æ¡ˆç»™å‡º 0-1 æ¦‚ç‡ï¼Œå¹¶ä¿è¯æ€»å’Œä¸º 1ã€‚// å¿…è¦æ—¶æç¤ºâ€œæ¦‚ç‡å¿…é¡»éè´Ÿâ€ã€‚
3. æŒ‰æ¦‚ç‡ä»é«˜åˆ°ä½æ’åºï¼Œé€æ¡è¾“å‡ºä¸ºï¼šå†…å®¹ï½œæ¦‚ç‡ã€‚
4. åœ¨æœ«å°¾ç»™å‡ºâ€œé‡‡æ ·å»ºè®®â€ï¼š
   - è‹¥åªéœ€ 1 ä¸ªç­”æ¡ˆï¼Œæ¨èé€‰æ‹©æ¦‚ç‡æœ€é«˜è€…ï¼›
   - è‹¥éœ€å¤šæ ·æ€§ï¼Œå¯æŒ‰æ¦‚ç‡åŠ æƒè¿›è¡Œéšæœºé‡‡æ ·ã€‚
</code></pre>
<h3 data-id="heading-5">Mom Test:è®© AI è¯´çœŸè¯è€Œéå¥½å¬è¯</h3>
<p>ç†è®ºä¾æ®: äººä»¬å‡ºäºç¤¼è²Œä¼šè¯´"å¥½è¯"è€Œé"çœŸè¯"ã€‚AI ä¹Ÿä¼šã€‚</p>
<ol>
<li>é¿å…é—®æ„è§ï¼Œæ”¹é—®è¯æ®ã€‚
<ul>
<li>é”™è¯¯ç¤ºèŒƒï¼šä½ è§‰å¾—è¿™ä¸ªæ–¹æ¡ˆå¥½ä¸å¥½ï¼Ÿè¿™æ ·è®¾è®¡æ˜¯ä¸æ˜¯å¾ˆåˆç†ï¼Ÿ</li>
<li>åˆ†æï¼šæ¨¡å‹ä¼šå€¾å‘äºè¯´æ›´å¤šæ³›æ³›çš„æ­ç»´è¯ã€‚</li>
<li>æ­£ç¡®ç¤ºèŒƒï¼šè¯·ç»™æˆ‘ 3 ä¸ªå…·ä½“åä¾‹ï¼Œè¯´æ˜è¿™ä¸ªæ–¹æ¡ˆå¯èƒ½å¤±è´¥çš„åœºæ™¯ã€‚è¯·åŸºäºå·²çŸ¥çš„äº‹å®/æ•°æ®ï¼Œåˆ—å‡ºè¿™ä¸ªè®¾è®¡å¯èƒ½é‡åˆ°çš„é™åˆ¶</li>
</ul>
</li>
<li>é¿å…æœªæ¥å‡è®¾ï¼Œè¿½é—®è¿‡å»è¡¨ç°ã€‚
<ul>
<li>é”™è¯¯ç¤ºèŒƒï¼šå¦‚æœé‡åˆ° X é—®é¢˜ï¼Œä½ ä¼šæ€ä¹ˆå¤„ç†ï¼Ÿ</li>
<li>åˆ†æï¼šæ¨¡å‹è¾“å‡ºæ²¡æœ‰ä¾æ®ï¼Œå¯èƒ½ä¼šäº§ç”Ÿå¹»è§‰ã€‚</li>
<li>æ­£ç¡®ç¤ºä¾‹ï¼šè¯·åˆ—ä¸¾ä½ åœ¨è®­ç»ƒè¯­æ–™ä¸­å­¦åˆ°çš„ã€å·²ç»å‡ºç°è¿‡çš„ X é—®é¢˜è§£å†³æ¡ˆä¾‹ã€‚åœ¨è¿‡å»çš„ç ”ç©¶æˆ–å†å²è®°å½•ä¸­ï¼ŒX æ˜¯å¦‚ä½•è¢«è§£å†³çš„ï¼Ÿ</li>
</ul>
</li>
<li>ç”¨è¡Œä¸ºé©±åŠ¨è€Œä¸æ˜¯æ€åº¦é©±åŠ¨
<ul>
<li>é”™è¯¯ç¤ºèŒƒï¼šå¦‚æœä½ æ˜¯ç”¨æˆ·ï¼Œä½ ä¼šä¸ä¼šå–œæ¬¢è¿™ä¸ªäº§å“ï¼Ÿ</li>
<li>æ­£ç¡®ç¤ºèŒƒï¼šå‡è®¾ä½ æ˜¯ç›®æ ‡ç”¨æˆ·ï¼Œè¯·æ¨¡æ‹Ÿä¸€æ¬¡å®é™…ä½¿ç”¨è¿‡ç¨‹ï¼Œå¹¶é€æ­¥å†™å‡ºä½ ä¼šç‚¹å‡»ã€è¾“å…¥ã€çŠ¹è±«çš„æ­¥éª¤</li>
</ul>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c298f22846f4c5285208e294982cbd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS2FuZUxvZ2dlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531490&amp;x-signature=3zi1VZ%2BjUnHq3SWPY8qNzspi6c4%3D" alt="Taming_AI_Through_Structure-å›¾ç‰‡-6.jpg" loading="lazy"/></p>
<h2 data-id="heading-6">å·¥å…·</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fpromptpilot.volcengine.com%2Ftasklist" target="_blank" title="https://promptpilot.volcengine.com/tasklist" ref="nofollow noopener noreferrer">Prompt Pilot</a> ç”¨äºé’ˆå¯¹å›½å†…æ¨¡å‹è¿›è¡Œ Prompt å·¥ç¨‹è°ƒä¼˜</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTanShilongMario%2FPromptFill" target="_blank" title="https://github.com/TanShilongMario/PromptFill" ref="nofollow noopener noreferrer">PromptFill</a> ä¸“ä¸º AI ç»˜ç”»è®¾è®¡çš„ç»“æ„åŒ–æç¤ºè¯ç”Ÿæˆå·¥å…·ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flinshenkx%2Fprompt-optimizer" target="_blank" title="https://github.com/linshenkx/prompt-optimizer" ref="nofollow noopener noreferrer">prompt-optimizer</a> æç¤ºè¯ä¼˜åŒ–å™¨ï¼ŒåŠ©åŠ›äºç¼–å†™é«˜è´¨é‡çš„æç¤ºè¯</li>
</ul>
<h2 data-id="heading-7">æ€»ç»“</h2>
<ol>
<li>AI ä¸æ˜¯é­”æ³•,æ˜¯é•œå­ã€‚å®ƒè¿”å›çš„æ··ä¹±ç¨‹åº¦,ç›´æ¥åæ˜ ä½ è¾“å…¥çš„æ··ä¹±ç¨‹åº¦ã€‚</li>
<li>ç»“æ„åŒ– = å¯å¤ç”¨ = å¯æ‰©å±• = å¯éªŒè¯ã€‚å†™æç¤ºè¯å°±åƒå†™ç¨‹åº:æ˜ç¡®æ¥å£ã€æ— æ­§ä¹‰ã€å¯é‡å¤ã€‚</li>
<li>æœ€å°åŒ–ç†µ,æœ€å¤§åŒ–ä»·å€¼ã€‚æˆ‘ä»¬çš„æ¯ä¸€ä¸ªå­—éƒ½åœ¨é™ä½ç³»ç»Ÿçš„ä¸ç¡®å®šæ€§ã€‚åºŸè¯æ˜¯ç†µ,çº¦æŸæ˜¯ç§©åº,èŒƒä¾‹æ˜¯é”šç‚¹ã€‚</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6b51ed072b745939186b52c4503c69f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS2FuZUxvZ2dlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531490&amp;x-signature=op9Ah0JxVg8kwaJAdY9AvWnPlmE%3D" alt="Taming_AI_Through_Structure-å›¾ç‰‡-8.jpg" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[compose ä¸­çš„é™„å¸¦æ•ˆåº”ç¬”è®°ä¸€]]></title>    <link>https://juejin.cn/post/7592882393250955307</link>    <guid>https://juejin.cn/post/7592882393250955307</guid>    <pubDate>2026-01-09T02:39:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592882393250955307" data-draft-id="7592823500416253978" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="compose ä¸­çš„é™„å¸¦æ•ˆåº”ç¬”è®°ä¸€"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-09T02:39:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿ƒæºxinyuan"/> <meta itemprop="url" content="https://juejin.cn/user/4283353029151694"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            compose ä¸­çš„é™„å¸¦æ•ˆåº”ç¬”è®°ä¸€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4283353029151694/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿ƒæºxinyuan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:39:59.000Z" title="Fri Jan 09 2026 02:39:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é€šå¸¸æƒ…å†µä¸‹çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æƒ³è¦æ›´æ–°UIï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ var value by remeber { mutableStateOf() }æ¥åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„çŠ¶æ€æ•°æ®ã€‚å½“stateçš„æ•°æ®å‘ç”Ÿæ”¹å˜ä»¥åï¼Œä½¿ç”¨äº†stateæ•°æ®ç»„ä»¶ä¼šå‘ç”Ÿé‡ç»„ï¼Œä»è€Œå®ç°åˆ·æ–°ã€‚
ä½†æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦å®ç°åœ¨å¯ç»„åˆå‡½æ•°ä¸­æ‰§è¡Œä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼Œæ ¹æ®è¯·æ±‚ç»“æœæ”¹å˜ç•Œé¢çŠ¶æ€ï¼Œæˆ–è€…æ‰§è¡ŒæŒ‚èµ·å‡½æ•°å†æ”¹å˜ç•Œé¢çŠ¶æ€ã€‚æ­¤æ—¶éœ€è¦ç”¨åˆ°é™„å¸¦æ•ˆåº”ã€‚</p>
<p>1.LaunchedEffect</p>
<p>launchedEffectä¸»è¦ä½œç”¨æ˜¯è®©ä½ åœ¨Composableä½œç”¨åŸŸé‡Œå®ç°åç¨‹å·¥ä½œï¼Œæ¥å®Œæˆå¼‚æ­¥ã€è€—æ—¶æ“ä½œã€ç½‘ç»œè¯·æ±‚ç­‰</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">LunchedEffectTest</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">var</span> value <span class="hljs-keyword">by</span> remeber{ mutableStateOf() }
    LaunchedEffect(key){ <span class="hljs-comment">//keyå¦‚æœæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåˆ™é‡ç»„ä¸­ä¸ä¼šå¯åŠ¨æ–°çš„åç¨‹</span>
        <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>){
            delay(<span class="hljs-number">100</span>)
            value++
        }
    }
    
    Text(text=<span class="hljs-string">'${value}'</span>)
}
</code></pre>
<p>2.rememberCoroutineScope</p>
<p>LanchedEffectåªèƒ½åœ¨composableä½œç”¨åŸŸå†…è°ƒç”¨ï¼Œæ— æ³•åœ¨æŒ‰é”®ç‚¹å‡»å›è°ƒç­‰åœ°æ–¹è°ƒç”¨ã€‚rememberCoroutineScopeå¯ä»¥åœ¨è¿™äº›åœ°æ–¹è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">rememberCoroutineScopeTest</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">val</span> scope = rememberCoroutineScope()
    Button(
        onclick={
            scope.launch{
                <span class="hljs-comment">//æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span>
            }
        }{
        Text(<span class="hljs-string">"è¯·æ±‚æ•°æ®"</span>)
        }
    )
   
}
</code></pre>
<p>3.rememberUpdateState åªæ˜¯è¾…åŠ©LaunchedEffectå‘å¤–éƒ¨(å…¶ä»–composeableæ–¹æ³•)æ›´æ–°çŠ¶æ€åŠŸèƒ½ï¼Œç”¨äºåœ¨ä¸åŒcomposeæ–¹æ³•ä¸‹LaunchedEffectçš„æ•°æ®æ›´æ–°æ—¶æä¾›æ›´æ–°æ•°æ®ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">RemeberUpdateStateTest</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">var</span> name <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-string">""</span>) }
    RemeberUpdateStateUI(name = name,onValueChanged = {
        name = it
    })
}

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">RemeberUpdateStateUI</span><span class="hljs-params">(name:<span class="hljs-type">String</span>,onValueChanged:(<span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span>{
    <span class="hljs-keyword">val</span> nameUpdateState = remmberUpdateState(name)

    LaunchedEffect(key){  <span class="hljs-comment">//keyä¿æŒä¸€è‡´å¯ä»¥ä¸ºtrue</span>
        delay(<span class="hljs-number">1000</span>)
        <span class="hljs-comment">//Log.d("RemeberUpdateStateUI","$name") //æ­£å¸¸æƒ…å†µä¸‹å¦‚æœè¿™é‡Œè¾“å…¥æ¡†è¾“å…¥å®Œä»¥åï¼Œè¿™é‡Œæœ€åç»“æœå¹¶ä¸æ˜¯é¢„æœŸçš„ï¼Œæ¯”å¦‚è¾“å…¥æ¡†111222ï¼Œä½†æ˜¯è¿™é‡Œå¯èƒ½1000æ¯«ç§’ä»¥åï¼Œnameè¿˜æ˜¯111,æ‰€ä»¥è¦ç”¨remeberUpdateStateåŒ…è£…ä¸€ä¸‹ã€‚</span>
        <span class="hljs-comment">//nameUpdateState åŒ…è£…åçš„ç»“æœï¼Œè¿™é‡Œè·å–çš„nameUpdateStateå¯¹è±¡ä¸­çš„å€¼å°±æ˜¯111222</span>
    }
    
    OutLinedTextField(
        value = name,
        onValueChange = onValueChanged
    )
    
}
</code></pre>
<p>å·¥ä½œåŸç†åˆ†æï¼š
<code>rememberUpdatedState</code>Â çš„å†…éƒ¨é€»è¾‘å¯ä»¥ç®€åŒ–ä¸ºä»¥ä¸‹æ ¸å¿ƒæ€æƒ³ï¼š</p>
<ol>
<li><strong>åˆ›å»ºä¸€ä¸ªæŒä¹…çš„Â <code>MutableState</code>Â å®¹å™¨</strong>ï¼šè¿™ä¸ªå®¹å™¨é€šè¿‡Â <code>remember</code>Â åœ¨é‡ç»„ä¸­ä¿æŒä¸å˜ã€‚</li>
<li><strong>åœ¨æ¯æ¬¡é‡ç»„æ—¶æ›´æ–°è¯¥å®¹å™¨çš„å€¼</strong>ï¼šæ— è®ºÂ <code>key</code>Â æ˜¯å¦å˜åŒ–ï¼Œåªè¦å¯ç»„åˆå‡½æ•°è¢«è°ƒç”¨ï¼Œå®ƒå°±ä¼šå°†Â <code>newValue</code>Â æ›´æ–°åˆ°å†…éƒ¨çš„Â <code>MutableState</code>Â ä¸­ã€‚</li>
<li><strong>è¿”å›è¯¥å®¹å™¨çš„å¼•ç”¨</strong>ï¼šæ•ˆåº”å†…éƒ¨é€šè¿‡è¿™ä¸ªç¨³å®šçš„å¼•ç”¨ï¼Œè¯»å–åˆ°çš„æ°¸è¿œæ˜¯æœ€æ–°å­˜å…¥çš„å€¼ã€‚</li>
</ol>
<p>å…¶å†…éƒ¨å®ç°ç±»ä¼¼äºä»¥ä¸‹çš„ç®€åŒ–é€»è¾‘ï¼ˆæ¦‚å¿µæ¨¡å‹ï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">rememberUpdatedState</span><span class="hljs-params">(newValue: <span class="hljs-type">T</span>)</span></span>: State&lt;T&gt; = remember {
    mutableStateOf(newValue)
}.apply { value = newValue }
<span class="hljs-comment">// æ³¨æ„ï¼šæ¯æ¬¡é‡ç»„éƒ½ä¼šæ‰§è¡Œ `.apply { value = newValue }` æ¥æ›´æ–°å€¼</span>
</code></pre>
<p>4.SideEffect</p>
<p>SideEffectç›¸å½“äºDisposableEffectçš„ç®€åŒ–ï¼Œå½“ä¸éœ€è¦onDisposeï¼Œä¸éœ€è¦å‚æ•°æ§åˆ¶ã€‚composeæ“ä½œéåŸå­æ“ä½œï¼Œé‡ç»„ä¸­å¯èƒ½å‘ç”Ÿæ„å¤–ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">  <span class="hljs-meta">@Composable</span>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sideEffectTest</span><span class="hljs-params">(user:<span class="hljs-type">User</span>)</span></span>{
      <span class="hljs-keyword">val</span> count = remember { mutableStateOf(<span class="hljs-number">0</span>) }
      SideEffect{
          count = user.number
      }
      Text(text = count.value.toString,modifier = Modifier.clickable={
         count.value ++
      })
      
  }
</code></pre>
<p>5.DispoableEffect</p>
<p>DispoableEffectå¿…é¡»æ·»åŠ ä¸€ä¸ªonDispose æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¸€èˆ¬ç”¨äºå¤„ç†èµ„æºæ¸…ç†å’Œé‡Šæ”¾ã€‚å¦å¤–DisposableEffectä¹Ÿå¸¦å‚æ•°æ„ä¹‰å’ŒLaunchedEffectçš„å‚æ•°ä¸€æ ·ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">DisposableEffectTest</span><span class="hljs-params">(dispatcher:<span class="hljs-type">OnBackPressDispather</span>)</span></span>{
    <span class="hljs-keyword">val</span> backCallback = remember { 
        <span class="hljs-keyword">object</span>:OnBackPressCallback(<span class="hljs-literal">true</span>){
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handleOnBackPressed</span><span class="hljs-params">()</span></span>{
                <span class="hljs-comment">//TODO</span>
            }
        }
    }
    
    DisposableEffect(dispatcher){
        dispatcher.addCallback(backCallback)
        onDispose{
            backCallback.remove()
        }
    }
}

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java è§£æ CDR æ–‡ä»¶å¹¶è®¡ç®—å›¾å½¢é¢ç§¯çš„å®Œæ•´æ–¹æ¡ˆï¼ˆæ”¯æŒ MultipartFile / ç½‘ç»œæ–‡ä»¶ï¼‰@æ¨å®å±±]]></title>    <link>https://juejin.cn/post/7592876744526807090</link>    <guid>https://juejin.cn/post/7592876744526807090</guid>    <pubDate>2026-01-09T02:41:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592876744526807090" data-draft-id="7592876744526790706" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java è§£æ CDR æ–‡ä»¶å¹¶è®¡ç®—å›¾å½¢é¢ç§¯çš„å®Œæ•´æ–¹æ¡ˆï¼ˆæ”¯æŒ MultipartFile / ç½‘ç»œæ–‡ä»¶ï¼‰@æ¨å®å±±"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-09T02:41:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¨ç« éš"/> <meta itemprop="url" content="https://juejin.cn/user/2824017474234734"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java è§£æ CDR æ–‡ä»¶å¹¶è®¡ç®—å›¾å½¢é¢ç§¯çš„å®Œæ•´æ–¹æ¡ˆï¼ˆæ”¯æŒ MultipartFile / ç½‘ç»œæ–‡ä»¶ï¼‰@æ¨å®å±±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824017474234734/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¨ç« éš
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:41:40.000Z" title="Fri Jan 09 2026 02:41:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>Â </p>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯è¯´æ˜</h2>
<p>åœ¨å°åˆ·ã€ç”µå•†å®šåˆ¶ã€å¹¿å‘ŠåŠ å·¥ç­‰ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼š</p>
<blockquote>
<p><strong>åç«¯éœ€è¦è‡ªåŠ¨è§£æ CDRï¼ˆCorelDrawï¼‰æ–‡ä»¶ï¼Œå¹¶è®¡ç®—å›¾å½¢çš„çœŸå®å°ºå¯¸æˆ–é¢ç§¯ï¼Œç”¨äºè®¡ä»·æˆ–ç”Ÿäº§æ ¡éªŒã€‚</strong></p>
</blockquote>
<p>ä½†ç°å®é—®é¢˜æ˜¯ï¼š</p>
<ul>
<li>
<p>CDR æ˜¯ <strong>CorelDraw ç§æœ‰æ ¼å¼</strong></p>
</li>
<li>
<p>Java <strong>æ²¡æœ‰ä»»ä½•å®˜æ–¹æˆ–å¯é çš„è§£æåº“</strong></p>
</li>
<li>
<p>å‰ç«¯ä¸Šä¼ çš„æ–‡ä»¶æ¥æºå¤šæ ·ï¼š</p>
<ul>
<li>ç½‘ç»œ URLï¼ˆOSS / CDNï¼‰</li>
<li><code>MultipartFile</code></li>
</ul>
</li>
<li>
<p>å¯¹ç²¾åº¦è¦æ±‚é«˜ï¼Œ<strong>è¯¯å·®å¿…é¡»å¯æ§</strong></p>
</li>
</ul>
<p>æœ¬æ–‡å°†ç»™å‡ºä¸€å¥—<strong>å·¥ç¨‹å¯è½åœ°ã€è¯¯å·®å¯æ§ã€å¯è‡ªåŠ¨åŒ–</strong>çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥è§£æ CDRï¼Ÿ</h2>
<p>è¿™æ˜¯å¾ˆå¤šäººä¸€å¼€å§‹å°±ä¼šè¸©çš„å‘ã€‚</p>
<h3 data-id="heading-2">2.1 CDR çš„æœ¬è´¨é—®é¢˜</h3>
<ul>
<li>CDR æ˜¯ <strong>äºŒè¿›åˆ¶ç§æœ‰æ ¼å¼</strong></li>
<li>å†…éƒ¨ç»“æ„å¤æ‚ï¼ˆè·¯å¾„ã€æ¸å˜ã€æ»¤é•œã€ç‰¹æ•ˆï¼‰</li>
<li>æ²¡æœ‰ç¨³å®šçš„ Java è§£æè§„èŒƒ</li>
</ul>
<p>ç»“è®ºå¾ˆæ˜ç¡®ï¼š</p>
<blockquote>
<p>âŒ <strong>Java æ— æ³•ç›´æ¥ã€å¯é åœ°è§£æ CDR æ–‡ä»¶</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€æ•´ä½“æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡</h2>
<h3 data-id="heading-4">3.1 æ ¸å¿ƒæ€è·¯</h3>
<p>æ—¢ç„¶ä¸èƒ½ç›´æ¥è§£æ CDRï¼Œå°±å¿…é¡» <strong>è½¬æ¢æ ¼å¼</strong>ã€‚</p>
<p>æœ€ç»ˆé€‰æ‹©çš„æŠ€æœ¯è·¯çº¿å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-objectivec" lang="objectivec">CDR æ–‡ä»¶
   â†“ï¼ˆInkscape <span class="hljs-built_in">CLI</span>ï¼‰
PDF æ–‡ä»¶ï¼ˆä¿ç•™å®Œæ•´çŸ¢é‡ï¼‰
   â†“ï¼ˆApache PDFBoxï¼‰
è§£ææ‰€æœ‰ç»˜å›¾æŒ‡ä»¤
   â†“
è®¡ç®—çœŸå® BoundingBox
   â†“
æ¢ç®—ä¸º mmï¼Œå¾—åˆ°é¢ç§¯
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-5">3.2 ä¸ºä»€ä¹ˆé€‰æ‹© PDFï¼Œè€Œä¸æ˜¯ SVGï¼Ÿ</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå…³é”®å†³ç­–ç‚¹ã€‚</p>






























<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>SVG</th><th>PDF</th></tr></thead><tbody><tr><td>å¤æ‚è·¯å¾„</td><td>âŒ æ˜“ä¸¢å¤±</td><td>âœ… ç¨³å®š</td></tr><tr><td>æ¸å˜ / æ›²çº¿</td><td>âŒ æœ‰é£é™©</td><td>âœ… å®Œæ•´</td></tr><tr><td>Java è§£æ</td><td>ä¸€èˆ¬</td><td><strong>PDFBox éå¸¸æˆç†Ÿ</strong></td></tr><tr><td>å·¥ç¨‹å¯é æ€§</td><td>ä¸­</td><td><strong>é«˜</strong></td></tr></tbody></table>
<p><strong>ç»“è®ºï¼š</strong></p>
<blockquote>
<p><strong>CDR â†’ PDF â†’ Java è§£æï¼Œæ˜¯ç›®å‰æœ€ç¨³å®šçš„å·¥ç¨‹æ–¹æ¡ˆ</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-6">å››ã€CDR è½¬ PDF çš„å®ç°æ–¹å¼</h2>
<h3 data-id="heading-7">4.1 ä½¿ç”¨ Inkscape å‘½ä»¤è¡Œ</h3>
<p>Inkscape æ˜¯ç›®å‰æœ€ç¨³å®šçš„ CDR è½¬æ¢å·¥å…·ä¹‹ä¸€ã€‚</p>
<pre><code class="hljs language-css" lang="css">inkscape <span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.cdr</span> \
  <span class="hljs-attr">--export-type</span>=pdf \
  <span class="hljs-attr">--export-area-drawing</span> \
  <span class="hljs-attr">--export-filename</span>=output<span class="hljs-selector-class">.pdf</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å…³é”®å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>--export-area-drawing</code><br/>
ğŸ‘‰ <strong>åªå¯¼å‡ºå®é™…å›¾å½¢åŒºåŸŸï¼Œé¿å…ç”»å¸ƒå¹²æ‰°</strong></li>
</ul>
<hr/>
<h2 data-id="heading-8">äº”ã€PDF ä¸­å°ºå¯¸ä¸å•ä½çš„å‘ï¼ˆéå¸¸é‡è¦ï¼‰</h2>
<h3 data-id="heading-9">5.1 PDF çš„å•ä½ä¸æ˜¯ mm</h3>
<p>PDF ä½¿ç”¨çš„æ˜¯ <strong>ptï¼ˆpointï¼‰</strong> ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">1 <span class="hljs-attr">pt</span> = <span class="hljs-number">1</span> / <span class="hljs-number">72</span> inch
1 <span class="hljs-attr">inch</span> = <span class="hljs-number">25.4</span> mm
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æ¢ç®—å…¬å¼ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">mm</span> = pt * <span class="hljs-number">25.4</span> / <span class="hljs-number">72</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å¦‚æœä½ ç›´æ¥æŠŠ pt å½“ mmï¼Œç”¨å‡ºæ¥çš„å°ºå¯¸<strong>ä¸€å®šæ˜¯é”™çš„</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-10">å…­ã€ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ MediaBox è®¡ç®—å°ºå¯¸ï¼Ÿ</h2>
<p>å¾ˆå¤šæ•™ç¨‹ä¼šæ•™ä½ è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">PDRectangle <span class="hljs-attr">mediaBox</span> = page.getMediaBox()<span class="hljs-comment">;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™æ˜¯<strong>é”™è¯¯çš„</strong>ã€‚</p>
<p>åŸå› ï¼š</p>
<ul>
<li><code>MediaBox</code> æ˜¯ <strong>é¡µé¢ç”»å¸ƒå¤§å°</strong></li>
<li>å¹¶ä¸æ˜¯å›¾å½¢çœŸå®å ç”¨èŒƒå›´</li>
</ul>
<p>æ­£ç¡®æ–¹å¼æ˜¯ï¼š</p>
<blockquote>
<p><strong>è§£æ PDF ä¸­çš„ç»˜å›¾æŒ‡ä»¤ï¼ŒåŠ¨æ€è®¡ç®— BoundingBox</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-11">ä¸ƒã€æ ¸å¿ƒå®ç°ï¼šè§£æ PDF ç»˜å›¾æŒ‡ä»¤</h2>
<h3 data-id="heading-12">7.1 æŠ€æœ¯å…³é”®ç‚¹</h3>
<p>ä½¿ç”¨ <code>PDFGraphicsStreamEngine</code>ï¼š</p>
<ul>
<li>
<p>æ‹¦æˆªæ‰€æœ‰è·¯å¾„æŒ‡ä»¤ï¼š</p>
<ul>
<li><code>moveTo</code></li>
<li><code>lineTo</code></li>
<li><code>curveTo</code></li>
<li><code>appendRectangle</code></li>
</ul>
</li>
<li>
<p>æ‰€æœ‰ç‚¹ä½éƒ½å¿…é¡»ï¼š</p>
<ul>
<li>é€šè¿‡ <strong>CTMï¼ˆCurrent Transformation Matrixï¼‰</strong></li>
<li>è½¬æ¢ä¸ºçœŸå®åæ ‡</li>
</ul>
</li>
<li>
<p>åŠ¨æ€ç»´æŠ¤ï¼š</p>
<ul>
<li><code>minX / minY / maxX / maxY</code></li>
</ul>
</li>
</ul>
<p>æœ€ç»ˆå¾—åˆ°çš„ BoundingBoxï¼Œæ‰æ˜¯<strong>çœŸå®å›¾å½¢å°ºå¯¸</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-13">å…«ã€ç»Ÿä¸€å·¥å…·ç±»è®¾è®¡ï¼ˆå·¥ç¨‹åŒ–ï¼‰</h2>
<p>ä¸ºäº†ä¾¿äºè½åœ°ï¼Œæˆ‘å°†æ•´ä¸ªæµç¨‹å°è£…æˆä¸€ä¸ªå·¥å…·ç±»ï¼Œå…·å¤‡ä»¥ä¸‹èƒ½åŠ›ï¼š</p>
<h3 data-id="heading-14">8.1 æ”¯æŒçš„è¾“å…¥ç±»å‹</h3>





















<table><thead><tr><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ç½‘ç»œ URL</td><td>OSS / CDN</td></tr><tr><td>MultipartFile</td><td>å‰ç«¯ä¸Šä¼ </td></tr><tr><td>æœ¬åœ° File</td><td>æœ¬åœ°è°ƒè¯•</td></tr></tbody></table>
<h3 data-id="heading-15">8.2 ç»Ÿä¸€è¾“å‡ºç»“æœ</h3>
<ul>
<li>å®½åº¦ï¼ˆmmï¼‰</li>
<li>é«˜åº¦ï¼ˆmmï¼‰</li>
<li>é¢ç§¯ï¼ˆmmÂ²ï¼‰</li>
</ul>
<h3 data-id="heading-16">8.3 è‡ªåŠ¨èµ„æºæ¸…ç†</h3>
<ul>
<li>ä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨åˆ é™¤</li>
<li>é¿å…ç£ç›˜å †ç§¯</li>
</ul>
<hr/>
<h2 data-id="heading-17">ä¹ã€è¯¯å·®æ¥æºä¸æ§åˆ¶æ–¹æ¡ˆ</h2>
<h3 data-id="heading-18">9.1 è¯¯å·®æ¥æº</h3>
<ul>
<li>PDF æ›²çº¿çš„æ•°å­¦è¿‘ä¼¼</li>
<li>æµ®ç‚¹æ•°è®¡ç®—è¯¯å·®</li>
<li>CorelDraw å†…éƒ¨æ¸²æŸ“å·®å¼‚</li>
</ul>
<h3 data-id="heading-19">9.2 æ§åˆ¶æ‰‹æ®µ</h3>
<ul>
<li>å¼ºåˆ¶ä½¿ç”¨ <code>--export-area-drawing</code></li>
<li>ä½¿ç”¨ CTM å‚ä¸åæ ‡å˜æ¢</li>
<li>ç²¾ç¡® pt â†’ mm æ¢ç®—</li>
</ul>
<h3 data-id="heading-20">9.3 å®æµ‹ç»“æœ</h3>
<p>åœ¨å¤šæ‰¹æ¬¡æµ‹è¯•ä¸­ï¼ˆCorelDraw â†’ Javaï¼‰ï¼š</p>
<blockquote>
<p>âœ… <strong>å°ºå¯¸è¯¯å·®ç¨³å®šæ§åˆ¶åœ¨ Â±5mm ä»¥å†…</strong></p>
</blockquote>
<p>å·²æ»¡è¶³ï¼š</p>
<ul>
<li>å°åˆ·å®šä»·</li>
<li>å·¥ç¨‹è®¡ä»·</li>
<li>è‡ªåŠ¨åŒ–å®¡æ ¸</li>
</ul>
<hr/>
<h2 data-id="heading-21">åã€ä½¿ç”¨ç¤ºä¾‹ï¼ˆåç«¯ï¼‰</h2>
<pre><code class="hljs language-ini" lang="ini">// å¤„ç†ç½‘ç»œ CDR
AreaResult <span class="hljs-attr">result</span> = CdrAreaUtil.processUrl(cdrUrl)<span class="hljs-comment">;</span>

// å¤„ç† MultipartFile
AreaResult <span class="hljs-attr">result</span> = CdrAreaUtil.processMultipart(file)<span class="hljs-comment">;</span>

System.out.println("å®½åº¦(mm): " + result.getWidthMm())<span class="hljs-comment">;</span>
System.out.println("é«˜åº¦(mm): " + result.getHeightMm())<span class="hljs-comment">;</span>
System.out.println("é¢ç§¯(mmÂ²): " + result.getAreaMm2())<span class="hljs-comment">;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-22">åä¸€ã€é€‚ç”¨ä¸šåŠ¡åœºæ™¯</h2>
<ul>
<li>å°åˆ· / å¹¿å‘Šè¡Œä¸šè‡ªåŠ¨æŠ¥ä»·</li>
<li>ç”µå•†å®šåˆ¶å›¾æ¡ˆé¢ç§¯è®¡è´¹</li>
<li>CDR æ–‡ä»¶è‡ªåŠ¨å®¡æ ¸</li>
<li>åç«¯æ— äººå€¼å®ˆæ‰¹å¤„ç†</li>
</ul>
<hr/>
<h2 data-id="heading-23">åäºŒã€æ€»ç»“</h2>
<ul>
<li>âŒ Java ä¸èƒ½ç›´æ¥è§£æ CDR</li>
<li>âœ… <strong>CDR â†’ PDF â†’ PDFBox</strong> æ˜¯ç›®å‰æœ€ç¨³å¦¥æ–¹æ¡ˆ</li>
<li>âŒ ä¸è¦ä½¿ç”¨ MediaBox</li>
<li>âœ… å¿…é¡»è§£æç»˜å›¾æŒ‡ä»¤ + CTM</li>
<li>âœ… è¯¯å·®å¯æ§ï¼Œå¯ç”¨äºç”Ÿäº§</li>
</ul>
<h2 data-id="heading-24">åä¸‰ã€è¡¥å……å·¥å…·ç±»ä»£ç </h2>
<ul>
<li>âœ… ä¾èµ–</li>
</ul>
<pre><code class="hljs language-xml" lang="xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.aspose<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspose-imaging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>24.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>jdk16<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- if you need a documentation, please add the following dependency. For example it could be useful for IDE. --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.aspose<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspose-imaging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>24.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>javadoc<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- PDFBox --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.pdfbox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>pdfbox<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.29<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<ul>
<li>
<p>âœ… å·¥å…·ç±»</p>
</li>
<li>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-keyword">import</span> org.apache.pdfbox.pdmodel.PDDocument;
<span class="hljs-keyword">import</span> org.apache.pdfbox.pdmodel.PDPage;
<span class="hljs-keyword">import</span> org.apache.pdfbox.pdmodel.common.PDRectangle;

<span class="hljs-keyword">import</span> java.io.*;
<span class="hljs-keyword">import</span> java.net.URL;
<span class="hljs-keyword">import</span> java.nio.file.Files;

<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;
<span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;

<span class="hljs-keyword">import</span> java.io.*;
<span class="hljs-keyword">import</span> java.net.MalformedURLException;
<span class="hljs-keyword">import</span> java.time.Duration;
<span class="hljs-keyword">import</span> java.util.Objects;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-comment">/**
 * CdrAreaUtil - å°† CDRï¼ˆæœ¬åœ°æˆ–ç½‘ç»œï¼‰è½¬æ¢ä¸º PDF å¹¶è®¡ç®—å†…å®¹é¡µé¢å°ºå¯¸ï¼ˆmmï¼‰ä¸é¢ç§¯ï¼ˆmmÂ²ï¼‰
 * &lt;p&gt;
 * è®¾è®¡åŸåˆ™ï¼š
 * - ä¸è§£æ CDR å†…éƒ¨ç»“æ„ï¼ˆç§æœ‰æ ¼å¼ï¼‰ï¼Œä½¿ç”¨ Inkscape CLI è½¬ PDFï¼ˆè£å‰ªåˆ°å†…å®¹ï¼‰
 * - ä½¿ç”¨ Apache PDFBox è¯»å– PDF çš„ CropBox/MediaBox ä½œä¸ºæœ€ç»ˆå°ºå¯¸ï¼ˆæƒå¨ï¼‰
 * - æ”¯æŒç½‘ç»œæ–‡ä»¶è‡ªåŠ¨ä¸‹è½½å¹¶æ¸…ç†ä¸´æ—¶æ–‡ä»¶
 * - å¯é…ç½® inkscape å¯æ‰§è¡Œè·¯å¾„ã€è¶…æ—¶ä¸é‡è¯•æ¬¡æ•°
 * &lt;p&gt;
 * æ³¨æ„ï¼š
 * - ä¾èµ–å¤–éƒ¨å‘½ä»¤ inkscapeï¼Œç¡®ä¿éƒ¨ç½²ç¯å¢ƒå·²å®‰è£…å¹¶å¯æ‰§è¡Œ
 * - å¯¹äºå¤æ‚ CDRï¼ˆç½‘æ ¼å¡«å……ã€ç‰¹æ•ˆç­‰ï¼‰ï¼ŒInkscape å¯èƒ½ä¸¢å¤±éƒ¨åˆ†å›¾å½¢ï¼Œç”Ÿäº§æµç¨‹å»ºè®®è®¾è®¡å¸ˆåœ¨å¯¼å‡ºç«¯åšè½¬æ›²/æ ¡éªŒ
 * &lt;p&gt;
 * ä½œè€…ï¼šZingYang
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CdrAreaUtil</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(CdrAreaUtil.class);

    <span class="hljs-comment">// é»˜è®¤ inkscape å¯æ‰§è¡Œå‘½ä»¤ï¼ˆè‹¥åœ¨éæ ‡å‡†è·¯å¾„ï¼Œå¯é€šè¿‡ç³»ç»Ÿå±æ€§æˆ–ç¯å¢ƒå˜é‡è¦†ç›–ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DEFAULT_INKSCAPE_CMD</span> <span class="hljs-operator">=</span> <span class="hljs-string">"inkscape"</span>;

    <span class="hljs-comment">// ç³»ç»Ÿå±æ€§/ç¯å¢ƒå˜é‡åï¼ˆä¼˜å…ˆç³»ç»Ÿå±æ€§ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PROP_INKSCAPE_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">"cdr.inkscape.path"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ENV_INKSCAPE_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">"INKSCAPE_PATH"</span>;

    <span class="hljs-comment">// è½¬æ¢è¶…æ—¶ï¼ˆç§’ï¼‰ä¸é‡è¯•æ¬¡æ•°ï¼ˆå¯æŒ‰éœ€è°ƒæ•´æˆ–å¤–éƒ¨åŒ–ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">CONVERT_TIMEOUT_SECONDS</span> <span class="hljs-operator">=</span> <span class="hljs-number">30L</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CONVERT_RETRY</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">CdrAreaUtil</span><span class="hljs-params">()</span> { <span class="hljs-comment">/* static utility */</span> }

    <span class="hljs-comment">/**
     * ä¸€æ¡é¾™å…¥å£ï¼šæ¥å—æœ¬åœ°è·¯å¾„æˆ–ç½‘ç»œ URLï¼ˆhttp/httpsï¼‰
     *
     * <span class="hljs-doctag">@param</span> localPathOrUrl æœ¬åœ°æ–‡ä»¶è·¯å¾„æˆ– http(s) URL
     * <span class="hljs-doctag">@return</span> ç»“æœåŒ…å«å®½ã€é«˜ï¼ˆmmï¼‰å’Œé¢ç§¯ï¼ˆmmÂ²ï¼‰
     * <span class="hljs-doctag">@throws</span> Exception å¤±è´¥æŠ›å‡º
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Result <span class="hljs-title function_">process</span><span class="hljs-params">(String localPathOrUrl)</span> <span class="hljs-keyword">throws</span> Exception {
        Objects.requireNonNull(localPathOrUrl, <span class="hljs-string">"input path or url is null"</span>);
        <span class="hljs-type">File</span> <span class="hljs-variable">cdrFile</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-type">File</span> <span class="hljs-variable">pdfFile</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-type">boolean</span> <span class="hljs-variable">downloaded</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (isHttpUrl(localPathOrUrl)) {
                log.info(<span class="hljs-string">"Detected URL, downloading: {}"</span>, localPathOrUrl);
                cdrFile = downloadToTemp(localPathOrUrl, <span class="hljs-string">".cdr"</span>);
                downloaded = <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">else</span> {
                cdrFile = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(localPathOrUrl);
                <span class="hljs-keyword">if</span> (!cdrFile.exists() || !cdrFile.isFile()) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileNotFoundException</span>(<span class="hljs-string">"CDR file not found: "</span> + localPathOrUrl);
                }
            }

            pdfFile = Files.createTempFile(<span class="hljs-string">"cdr_out_"</span>, <span class="hljs-string">".pdf"</span>).toFile();

            <span class="hljs-comment">// å°† cdr è½¬ä¸º pdfï¼ˆè£å‰ªåˆ°å†…å®¹ï¼‰</span>
            convertCdrToPdfWithRetry(cdrFile, pdfFile, CONVERT_RETRY, Duration.ofSeconds(CONVERT_TIMEOUT_SECONDS));

            <span class="hljs-comment">// è§£æ PDF å¾—åˆ°å°ºå¯¸ä¸é¢ç§¯</span>
            <span class="hljs-type">Result</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> calcPdfArea(pdfFile);
            log.info(<span class="hljs-string">"Process success. width(mm)={}, height(mm)={}, area(mm2)={}"</span>, r.widthMm, r.heightMm, r.areaMm2);
            <span class="hljs-keyword">return</span> r;
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// æ¸…ç†ï¼šä¼˜å…ˆåˆ é™¤ä¸´æ—¶ç”Ÿæˆçš„ PDF ä¸ä¸‹è½½çš„ CDRï¼ˆè‹¥æ˜¯ä¸‹è½½äº§ç”Ÿçš„ï¼‰</span>
            safeDelete(pdfFile);
            <span class="hljs-keyword">if</span> (downloaded) {
                safeDelete(cdrFile);
            }
        }
    }

    <span class="hljs-comment">/* ------------------------- helper: convert with retry &amp; timeout ------------------------- */</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">convertCdrToPdfWithRetry</span><span class="hljs-params">(File cdr, File pdf, <span class="hljs-type">int</span> retries, Duration timeout)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Exception</span> <span class="hljs-variable">lastEx</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= retries; i++) {
            <span class="hljs-keyword">try</span> {
                convertCdrToPdf(cdr, pdf, timeout);
                <span class="hljs-comment">// æˆåŠŸåˆ™è¿”å›</span>
                <span class="hljs-keyword">return</span>;
            } <span class="hljs-keyword">catch</span> (Exception ex) {
                lastEx = ex;
                log.warn(<span class="hljs-string">"Inkscape convert attempt {}/{} failed: {}"</span>, i + <span class="hljs-number">1</span>, retries + <span class="hljs-number">1</span>, ex.getMessage());
                <span class="hljs-comment">// è‹¥æœ€åä¸€æ¬¡ä»å¤±è´¥ï¼ŒæŠ›å‡º</span>
                <span class="hljs-keyword">if</span> (i == retries) {
                    log.error(<span class="hljs-string">"All conversion attempts failed."</span>);
                    <span class="hljs-keyword">throw</span> lastEx;
                }
                <span class="hljs-comment">// å¦åˆ™çŸ­æš‚ç­‰å¾…å†è¯•</span>
                Thread.sleep(<span class="hljs-number">500L</span>);
            }
        }
    }

    <span class="hljs-comment">/**
     * ä½¿ç”¨ Inkscape CLI å°† CDR è½¬ä¸º PDFï¼Œå¹¶ä½¿ç”¨ --export-area-drawing ç¡®ä¿é¡µé¢è£å‰ªåˆ°å†…å®¹
     *
     * <span class="hljs-doctag">@param</span> cdr     æœ¬åœ° CDR æ–‡ä»¶
     * <span class="hljs-doctag">@param</span> pdf     ç›®æ ‡ PDF æ–‡ä»¶ï¼ˆå°†è¢«è¦†ç›–ï¼‰
     * <span class="hljs-doctag">@param</span> timeout è½¬æ¢è¶…æ—¶æ—¶é—´
     * <span class="hljs-doctag">@throws</span> Exception è½¬æ¢å¤±è´¥æŠ›å‡º
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">convertCdrToPdf</span><span class="hljs-params">(File cdr, File pdf, Duration timeout)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-keyword">if</span> (cdr == <span class="hljs-literal">null</span> || pdf == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"cdr or pdf is null"</span>);
        }
        <span class="hljs-type">String</span> <span class="hljs-variable">inkscapeCmd</span> <span class="hljs-operator">=</span> resolveInkscapeCmd();

        <span class="hljs-type">ProcessBuilder</span> <span class="hljs-variable">pb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>(
                inkscapeCmd,
                cdr.getAbsolutePath(),
                <span class="hljs-string">"--export-type=pdf"</span>,
                <span class="hljs-string">"--export-filename="</span> + pdf.getAbsolutePath(),
                <span class="hljs-string">"--export-area-drawing"</span>
        );
        pb.redirectErrorStream(<span class="hljs-literal">true</span>); <span class="hljs-comment">// åˆå¹¶ stderr -&gt; stdoutï¼Œä¾¿äºæ—¥å¿—æ‰“å°</span>

        log.debug(<span class="hljs-string">"Running command: {}"</span>, String.join(<span class="hljs-string">" "</span>, pb.command()));

        <span class="hljs-type">Process</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> pb.start();

        <span class="hljs-comment">// è¯»å–è¿›ç¨‹è¾“å‡ºï¼ˆé¿å…é˜»å¡ï¼‰ï¼Œå¼‚æ­¥è¯»å–æˆ–åŒæ­¥ç®€å•è¯»å–ï¼ˆå°é‡è¾“å‡ºï¼‰</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">outReader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> (<span class="hljs-type">BufferedReader</span> <span class="hljs-variable">br</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(p.getInputStream()))) {
                String line;
                <span class="hljs-keyword">while</span> ((line = br.readLine()) != <span class="hljs-literal">null</span>) {
                    log.debug(<span class="hljs-string">"[inkscape] {}"</span>, line);
                }
            } <span class="hljs-keyword">catch</span> (IOException ignore) {
            }
        }, <span class="hljs-string">"inkscape-out-reader"</span>);
        outReader.setDaemon(<span class="hljs-literal">true</span>);
        outReader.start();

        <span class="hljs-type">boolean</span> <span class="hljs-variable">finished</span> <span class="hljs-operator">=</span> p.waitFor(timeout.toMillis(), TimeUnit.MILLISECONDS);
        <span class="hljs-keyword">if</span> (!finished) {
            <span class="hljs-comment">// è¶…æ—¶ï¼Œå¼ºåˆ¶é”€æ¯</span>
            p.destroyForcibly();
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Inkscape conversion timeout after "</span> + timeout.toMillis() + <span class="hljs-string">" ms"</span>);
        }

        <span class="hljs-type">int</span> <span class="hljs-variable">exit</span> <span class="hljs-operator">=</span> p.exitValue();
        <span class="hljs-keyword">if</span> (exit != <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Inkscape conversion failed, exitCode="</span> + exit);
        }

        <span class="hljs-keyword">if</span> (!pdf.exists() || pdf.length() == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Output PDF not generated or empty"</span>);
        }
    }

    <span class="hljs-comment">/* ------------------------- helper: PDF parsing ------------------------- */</span>

    <span class="hljs-comment">/**
     * è¯»å– PDF çš„ CropBoxï¼ˆä¼˜å…ˆï¼‰æˆ– MediaBoxï¼Œè½¬æ¢ä¸º mm å¹¶è®¡ç®—é¢ç§¯ï¼ˆmmÂ²ï¼‰
     *
     * <span class="hljs-doctag">@param</span> pdfFile è¾“å…¥ PDFï¼ˆæœ¬åœ°ï¼‰
     * <span class="hljs-doctag">@return</span> Result å®½é«˜ï¼ˆmmï¼‰ä¸é¢ç§¯ï¼ˆmmÂ²ï¼‰
     * <span class="hljs-doctag">@throws</span> IOException æ–‡ä»¶è¯»å–å¤±è´¥
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Result <span class="hljs-title function_">calcPdfArea</span><span class="hljs-params">(File pdfFile)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">PDDocument</span> <span class="hljs-variable">doc</span> <span class="hljs-operator">=</span> PDDocument.load(pdfFile)) {
            <span class="hljs-type">PDPage</span> <span class="hljs-variable">page</span> <span class="hljs-operator">=</span> doc.getPage(<span class="hljs-number">0</span>); <span class="hljs-comment">// é»˜è®¤å–ç¬¬ä¸€é¡µ</span>
            <span class="hljs-type">PDRectangle</span> <span class="hljs-variable">box</span> <span class="hljs-operator">=</span> page.getCropBox();
            <span class="hljs-keyword">if</span> (box == <span class="hljs-literal">null</span>) box = page.getMediaBox();

            <span class="hljs-type">double</span> <span class="hljs-variable">widthPt</span> <span class="hljs-operator">=</span> box.getWidth();
            <span class="hljs-type">double</span> <span class="hljs-variable">heightPt</span> <span class="hljs-operator">=</span> box.getHeight();

            <span class="hljs-type">double</span> <span class="hljs-variable">widthMm</span> <span class="hljs-operator">=</span> ptToMm(widthPt);
            <span class="hljs-type">double</span> <span class="hljs-variable">heightMm</span> <span class="hljs-operator">=</span> ptToMm(heightPt);

            <span class="hljs-type">double</span> <span class="hljs-variable">areaMm2</span> <span class="hljs-operator">=</span> widthMm * heightMm;

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Result</span>(widthMm, heightMm, areaMm2);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">double</span> <span class="hljs-title function_">ptToMm</span><span class="hljs-params">(<span class="hljs-type">double</span> pt)</span> {
        <span class="hljs-keyword">return</span> pt * <span class="hljs-number">25.4</span> / <span class="hljs-number">72.0</span>;
    }

    <span class="hljs-comment">/* ------------------------- helper: download ------------------------- */</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> File <span class="hljs-title function_">downloadToTemp</span><span class="hljs-params">(String urlStr, String suffix)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">URL</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(urlStr);
        <span class="hljs-type">File</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> Files.createTempFile(<span class="hljs-string">"cdr_in_"</span>, suffix).toFile();
        <span class="hljs-keyword">try</span> (<span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> url.openStream();
             <span class="hljs-type">OutputStream</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(temp)) {
            in.transferTo(out);
        }
        <span class="hljs-keyword">return</span> temp;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHttpUrl</span><span class="hljs-params">(String pathOrUrl)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">URL</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(pathOrUrl);
            <span class="hljs-type">String</span> <span class="hljs-variable">protocol</span> <span class="hljs-operator">=</span> u.getProtocol();
            <span class="hljs-keyword">return</span> <span class="hljs-string">"http"</span>.equalsIgnoreCase(protocol) || <span class="hljs-string">"https"</span>.equalsIgnoreCase(protocol);
        } <span class="hljs-keyword">catch</span> (MalformedURLException e) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-comment">/* ------------------------- helper: inkscape path resolution ------------------------- */</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">resolveInkscapeCmd</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä¼˜å…ˆç³»ç»Ÿå±æ€§</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">prop</span> <span class="hljs-operator">=</span> System.getProperty(PROP_INKSCAPE_PATH);
        <span class="hljs-keyword">if</span> (prop != <span class="hljs-literal">null</span> &amp;&amp; !prop.isBlank()) {
            <span class="hljs-keyword">return</span> prop;
        }
        <span class="hljs-comment">// å…¶æ¬¡ç¯å¢ƒå˜é‡</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">env</span> <span class="hljs-operator">=</span> System.getenv(ENV_INKSCAPE_PATH);
        <span class="hljs-keyword">if</span> (env != <span class="hljs-literal">null</span> &amp;&amp; !env.isBlank()) {
            <span class="hljs-keyword">return</span> env;
        }
        <span class="hljs-comment">// æœ€åé»˜è®¤å‘½ä»¤åï¼ˆä¾èµ– PATHï¼‰</span>
        <span class="hljs-keyword">return</span> DEFAULT_INKSCAPE_CMD;
    }

    <span class="hljs-comment">/* ------------------------- helper: cleanup ------------------------- */</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">safeDelete</span><span class="hljs-params">(File file)</span> {
        <span class="hljs-keyword">if</span> (file == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">try</span> {
            Files.deleteIfExists(file.toPath());
            log.debug(<span class="hljs-string">"Deleted temp file: {}"</span>, file.getAbsolutePath());
        } <span class="hljs-keyword">catch</span> (Exception ex) {
            log.warn(<span class="hljs-string">"Failed to delete temp file {}: {}"</span>, file.getAbsolutePath(), ex.getMessage());
        }
    }

    <span class="hljs-comment">/* ------------------------- Result class ------------------------- */</span>

    <span class="hljs-comment">/**
     * ç»“æœ POJOï¼ˆä¸å¯å˜ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span> {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">double</span> widthMm;
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">double</span> heightMm;
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">double</span> areaMm2;

        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Result</span><span class="hljs-params">(<span class="hljs-type">double</span> widthMm, <span class="hljs-type">double</span> heightMm, <span class="hljs-type">double</span> areaMm2)</span> {
            <span class="hljs-built_in">this</span>.widthMm = widthMm;
            <span class="hljs-built_in">this</span>.heightMm = heightMm;
            <span class="hljs-built_in">this</span>.areaMm2 = areaMm2;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"Result{"</span> +
                    <span class="hljs-string">"widthMm="</span> + widthMm +
                    <span class="hljs-string">", heightMm="</span> + heightMm +
                    <span class="hljs-string">", areaMm2="</span> + areaMm2 +
                    <span class="hljs-string">'}'</span>;
        }
    }


    <span class="hljs-comment">/**
     * ç›´æ¥å¤„ç† MultipartFileï¼Œè¿”å›å°ºå¯¸å’Œé¢ç§¯
     * &lt;p&gt;
     * ä½¿ç”¨åœºæ™¯ï¼š
     * - å‰ç«¯ä¸Šä¼  CDR æ–‡ä»¶
     * - åç«¯ç›´æ¥è®¡ç®—é¢ç§¯
     * &lt;p&gt;
     * å¼€å‘äººå‘˜ï¼šZingYang
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Result <span class="hljs-title function_">processMultipart</span><span class="hljs-params">(MultipartFile multipartFile)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-keyword">if</span> (multipartFile == <span class="hljs-literal">null</span> || multipartFile.isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"MultipartFile is empty"</span>);
        }

        <span class="hljs-type">File</span> <span class="hljs-variable">cdrFile</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-type">File</span> <span class="hljs-variable">pdfFile</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1ï¸âƒ£ MultipartFile â†’ ä¸´æ—¶ CDR æ–‡ä»¶</span>
            cdrFile = Files.createTempFile(<span class="hljs-string">"cdr_upload_"</span>, <span class="hljs-string">".cdr"</span>).toFile();
            multipartFile.transferTo(cdrFile);

            <span class="hljs-comment">// 2ï¸âƒ£ åˆ›å»ºä¸´æ—¶ PDF æ–‡ä»¶</span>
            pdfFile = Files.createTempFile(<span class="hljs-string">"cdr_out_"</span>, <span class="hljs-string">".pdf"</span>).toFile();

            <span class="hljs-comment">// 3ï¸âƒ£ CDR â†’ PDFï¼ˆè£å‰ªåˆ°å†…å®¹ï¼‰</span>
            convertCdrToPdfWithRetry(
                    cdrFile,
                    pdfFile,
                    CONVERT_RETRY,
                    java.time.Duration.ofSeconds(CONVERT_TIMEOUT_SECONDS)
            );

            <span class="hljs-comment">// 4ï¸âƒ£ ç›´æ¥è®¡ç®—å¹¶è¿”å›é¢ç§¯</span>
            <span class="hljs-keyword">return</span> calcPdfArea(pdfFile);

        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// 5ï¸âƒ£ æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span>
            safeDelete(cdrFile);
            safeDelete(pdfFile);
        }
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
</li>
</ul>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Agentæ™ºèƒ½ä½“ï¼š2026å¹´AIå¼€å‘è€…å¿…é¡»æŒæ¡çš„è‡ªä¸»ç³»ç»Ÿé©å‘½]]></title>    <link>https://juejin.cn/post/7592863358258561078</link>    <guid>https://juejin.cn/post/7592863358258561078</guid>    <pubDate>2026-01-09T00:03:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592863358258561078" data-draft-id="7592818202717683731" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Agentæ™ºèƒ½ä½“ï¼š2026å¹´AIå¼€å‘è€…å¿…é¡»æŒæ¡çš„è‡ªä¸»ç³»ç»Ÿé©å‘½"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-09T00:03:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="_æ‘˜æ˜Ÿ_"/> <meta itemprop="url" content="https://juejin.cn/user/2228036358374227"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Agentæ™ºèƒ½ä½“ï¼š2026å¹´AIå¼€å‘è€…å¿…é¡»æŒæ¡çš„è‡ªä¸»ç³»ç»Ÿé©å‘½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2228036358374227/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    _æ‘˜æ˜Ÿ_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T00:03:18.000Z" title="Fri Jan 09 2026 00:03:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e984e29fed7d477bb53ed60cb9816e19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-aRmOaYn18=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768521798&amp;x-signature=jgRfBQzKf%2FRq69i8CanNLI9FBNg%3D" alt="jimeng-2026-01-09-2656-æ‰å¹³åŒ–åŠ¨ç”»é£æ ¼ï¼Œç§‘æŠ€æµ·æŠ¥è®¾è®¡ï¼ŒæŠ€æœ¯åšå®¢å°é¢å›¾ï¼Œæç®€ä¸»ä¹‰æ„å›¾ï¼Œç§‘æŠ€æ„Ÿåè¶³çš„èƒŒæ™¯å…ƒç´ ....png" loading="lazy"/></p>
<h2 data-id="heading-0">Agentæ™ºèƒ½ä½“ï¼š2026å¹´AIå¼€å‘è€…å¿…é¡»æŒæ¡çš„è‡ªä¸»ç³»ç»Ÿé©å‘½</h2>
<h3 data-id="heading-1">æ‘˜è¦</h3>
<p>æœ¬æ–‡æ·±å…¥æ¢è®¨äº†<strong>Agentæ™ºèƒ½ä½“æŠ€æœ¯</strong>ä½œä¸ºAIé¢†åŸŸä¸‹ä¸€æ³¢é©å‘½çš„æ ¸å¿ƒé©±åŠ¨åŠ›ã€‚é€šè¿‡åˆ†æè‡ªä¸»ç³»ç»Ÿæ¶æ„ã€ä¸»æµå¼€å‘æ¡†æ¶åŠ2026å¹´æŠ€æœ¯è¶‹åŠ¿é¢„æµ‹ï¼Œç»“åˆ5ä¸ªå®æˆ˜ä»£ç æ¡ˆä¾‹å’Œæ¶æ„å›¾è§£ï¼Œä¸ºå¼€å‘è€…æä¾›ä»ç†è®ºåˆ°å®è·µçš„å®Œæ•´å­¦ä¹ è·¯å¾„ã€‚æ–‡ç« åŒ…å«LangChainå¤šä»»åŠ¡è°ƒåº¦ã€AutoGPTè®°å¿†ç®¡ç†ã€å¤šAgentåä½œç³»ç»Ÿç­‰å…³é”®æŠ€æœ¯çš„æ·±åº¦è§£æï¼Œå¹¶é™„æ¡†æ¶å¯¹æ¯”è¡¨æ ¼ä¸ç³»ç»Ÿæ¶æ„å›¾ã€‚è¯»è€…å°†æŒæ¡æ„å»ºå…·å¤‡<strong>è§„åˆ’ã€è®°å¿†ã€å·¥å…·è°ƒç”¨</strong>èƒ½åŠ›çš„æ™ºèƒ½ä½“ç³»ç»Ÿçš„æ–¹æ³•è®ºï¼Œåº”å¯¹æœªæ¥AIå¼€å‘èŒƒå¼çš„æ ¹æœ¬æ€§å˜é©ã€‚</p>
<hr/>
<h3 data-id="heading-2">å¼•è¨€ï¼šäº²å†AgentæŠ€æœ¯çˆ†å‘ä¸´ç•Œç‚¹</h3>
<p>ä¸Šå‘¨è°ƒè¯•Multi-Agentç³»ç»Ÿæ—¶ï¼Œæˆ‘é­é‡äº†å…¸å‹çš„<strong>è®°å¿†å†²çª</strong>åœºæ™¯ï¼šå½“è´¢åŠ¡Agentä¿®æ”¹é¢„ç®—æ—¶ï¼Œè¥é”€Agentä»åœ¨æŒ‰æ—§æ–¹æ¡ˆæ‰§è¡Œæ¨å¹¿è®¡åˆ’ã€‚è¿™ä¸ªè¸©å‘ç»å†è®©æˆ‘æ„è¯†åˆ°ï¼š<strong>ä¼ ç»Ÿå•ä½“æ¨¡å‹å¼€å‘æ¨¡å¼å³å°†ç»ˆç»“</strong>ã€‚æ®Anthropicå®éªŒå®¤2024å¹´Q2æŠ¥å‘Šï¼Œé‡‡ç”¨Agentæ¶æ„çš„AIç³»ç»Ÿä»»åŠ¡å®Œæˆç‡æ¯”ä¼ ç»Ÿæ–¹æ³•é«˜73%ï¼Œä½†å¼€å‘è€…æŠ€èƒ½ç¼ºå£æ‰©å¤§è‡³41:1ï¼ˆå²—ä½éœ€æ±‚vsåˆæ ¼å¼€å‘è€…ï¼‰ã€‚æœ¬æ–‡å°†ä»çœŸå®é¡¹ç›®å‡ºå‘ï¼Œæ‹†è§£å¦‚ä½•ç”¨<strong>æ¨¡å—åŒ–æ¶æ„è®¾è®¡</strong>è§£å†³ä¸Šè¿°å†²çªï¼Œå¹¶é¢„æµ‹2026å¹´å¼€å‘è€…å¿…é¡»æŒæ¡çš„ä¸‰å¤§èƒ½åŠ›åæ ‡ã€‚</p>
<hr/>
<h3 data-id="heading-3">ä¸“é—¨ç« èŠ‚ä¸€ï¼šAgentæ™ºèƒ½ä½“æŠ€æœ¯æ·±åº¦è§£æ</h3>
<h4 data-id="heading-4">1.1 å®šä¹‰ä¸æ ¸å¿ƒæ¶æ„</h4>
<p>Agentæ™ºèƒ½ä½“æ˜¯å…·å¤‡<strong>ç¯å¢ƒæ„ŸçŸ¥ã€è‡ªä¸»å†³ç­–ã€é•¿æœŸè®°å¿†ã€å·¥å…·è°ƒç”¨</strong>èƒ½åŠ›çš„AIå®ä½“ã€‚å…¶é©å‘½æ€§åœ¨äºæ‰“ç ´ä¼ ç»Ÿæ¨¡å‹çš„å•å‘å“åº”æ¨¡å¼ï¼Œå®ç°<strong>é—­ç¯ä»»åŠ¡æ‰§è¡Œ</strong>ã€‚æ ¸å¿ƒæ¶æ„éµå¾ªOODAå¾ªç¯ï¼ˆè§‚å¯Ÿ-å®šå‘-å†³ç­–-è¡ŒåŠ¨ï¼‰ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ç¯å¢ƒè§‚å¯Ÿ] --&gt; B[çŠ¶æ€å®šå‘]
    B --&gt; C[ä»»åŠ¡å†³ç­–]
    C --&gt; D[å·¥å…·è°ƒç”¨]
    D --&gt; E[è¡ŒåŠ¨æ‰§è¡Œ]
    E --&gt; F[ç»“æœè¯„ä¼°]
    F --&gt; A
</code></pre>
<h4 data-id="heading-5">1.2 å…³é”®æŠ€æœ¯ç»„ä»¶</h4>
<ul>
<li><strong>è§„åˆ’å¼•æ“</strong>ï¼šå°†å¤æ‚ç›®æ ‡åˆ†è§£ä¸ºå¯æ‰§è¡Œå­ä»»åŠ¡ï¼ˆå¦‚Tree of Thoughtsç®—æ³•ï¼‰</li>
<li><strong>è®°å¿†ç®¡ç†</strong>ï¼šå‘é‡æ•°æ®åº“+æ—¶é—´æˆ³å®ç°æƒ…æ™¯è®°å¿†ï¼ˆç¤ºä¾‹ä»£ç è§ç¬¬ä¸‰ç« ï¼‰</li>
<li><strong>å·¥å…·è°ƒç”¨</strong>ï¼šé€šè¿‡å‡½æ•°æŠ½è±¡å¯¹æ¥å¤–éƒ¨APIï¼ˆå¦‚Google Searchã€Python REPLï¼‰</li>
<li><strong>åæ€æœºåˆ¶</strong>ï¼šåŸºäºç»“æœçš„åå‘ä¼ æ’­ä¼˜åŒ–ï¼ˆReActè®ºæ–‡æ ¸å¿ƒåˆ›æ–°ï¼‰</li>
</ul>
<h4 data-id="heading-6">1.3 åº”ç”¨åœºæ™¯çŸ©é˜µ</h4>



































<table><thead><tr><th>åœºæ™¯ç±»å‹</th><th>å…¸å‹æ¡ˆä¾‹</th><th>Agentä¼˜åŠ¿</th><th>ä¼ ç»Ÿæ–¹æ¡ˆç—›ç‚¹</th></tr></thead><tbody><tr><td>å¤æ‚å†³ç­–</td><td>æŠ•èµ„ç»„åˆç®¡ç†</td><td>å¤šå› å­åŠ¨æ€æƒè¡¡</td><td>è§„åˆ™å¼•æ“åƒµåŒ–</td></tr><tr><td>é•¿å‘¨æœŸä»»åŠ¡</td><td>ç§‘ç ”å®éªŒè‡ªåŠ¨åŒ–</td><td>è·¨å‘¨è®°å¿†ä¿æŒ</td><td>ä¸Šä¸‹æ–‡ä¸¢å¤±</td></tr><tr><td>å¤šå·¥å…·åä½œ</td><td>è·¨å¢ƒç”µå•†è¿è¥</td><td>APIæ— ç¼è°ƒåº¦</td><td>äººå·¥ä¸­è½¬æ•ˆç‡ä½ä¸‹</td></tr><tr><td>å®æ—¶é€‚åº”</td><td>å·¥ä¸šæ•…éšœå¤„ç†</td><td>åœ¨çº¿å­¦ä¹ è°ƒæ•´ç­–ç•¥</td><td>é¢„è®¾è§„åˆ™è¦†ç›–ä¸è¶³</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-7">ä¸“é—¨ç« èŠ‚äºŒï¼š2026å¹´AIå¼€å‘è€…èƒ½åŠ›åæ ‡é¢„æµ‹</h3>
<h4 data-id="heading-8">2.1 èƒ½åŠ›è¿ç§»è·¯çº¿å›¾</h4>
<p>æ ¹æ®OpenAIå¼€å‘è€…è°ƒç ”æ•°æ®ï¼Œæœªæ¥ä¸¤å¹´å…³é”®æŠ€èƒ½è¿ç§»å‘ˆç°ä¸‰å¤§è¶‹åŠ¿ï¼š</p>
<ol>
<li><strong>ä»æ¨¡å‹å¾®è°ƒåˆ°ç³»ç»Ÿæ¶æ„</strong>ï¼šå¼€å‘è€…éœ€æŒæ¡Agenté—´é€šä¿¡åè®®ï¼ˆå¦‚AgentChatï¼‰</li>
<li><strong>ä»å•ä»»åŠ¡åˆ°ç”Ÿæ€æ²»ç†</strong>ï¼šéœ€è®¾è®¡å¤šAgentçš„å†²çªè§£å†³æœºåˆ¶ï¼ˆç¤ºä¾‹è§ç¬¬å››ç« ä»£ç ï¼‰</li>
<li><strong>ä»ç²¾åº¦ä¼˜åŒ–åˆ°å®‰å…¨ä¼˜å…ˆ</strong>ï¼šå¿…é¡»å†…ç½®é“å¾·çº¦æŸå±‚ï¼ˆConstitutional AIæŠ€æœ¯ï¼‰</li>
</ol>
<h4 data-id="heading-9">2.2 è‡´å‘½æŠ€èƒ½ç¼ºå£é¢„è­¦</h4>
<p>2024å¹´å¼€å‘è€…èƒ½åŠ›é›·è¾¾å›¾æ˜¾ç¤ºï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">pie
    title 2024å¼€å‘è€…æŠ€èƒ½åˆ†å¸ƒ
    â€œå•æ¨¡å‹ä¼˜åŒ–â€ ï¼š 42
    â€œAPIé›†æˆâ€ ï¼š 28
    â€œè®°å¿†ç®¡ç†â€ ï¼š 15
    â€œå¤šAgentåè°ƒâ€ ï¼š 8
    â€œå®‰å…¨æ¶æ„â€ ï¼š 7
</code></pre>
<p><strong>å¤šAgentåè°ƒèƒ½åŠ›ç¼ºå£è¾¾91%</strong>ï¼Œæˆä¸ºåˆ¶çº¦ä¼ä¸šè½åœ°çš„é¦–è¦ç“¶é¢ˆã€‚</p>
<hr/>
<h3 data-id="heading-10">ä¸“é—¨ç« èŠ‚ä¸‰ï¼šè‡ªä¸»ç³»ç»Ÿå¼€å‘å®æˆ˜</h3>
<h4 data-id="heading-11">3.1 æ¡ˆä¾‹ä¸€ï¼šLangChainå¤šä»»åŠ¡è°ƒåº¦</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.agents <span class="hljs-keyword">import</span> AgentExecutor
<span class="hljs-keyword">from</span> langchain_community.tools <span class="hljs-keyword">import</span> DuckDuckGoSearchTool

<span class="hljs-comment"># æ„å»ºå¸¦è®°å¿†çš„Agent</span>
agent = create_react_agent(
    llm=ChatGPT4o(),
    tools=[DuckDuckGoSearchTool()],
    memory=VectorStoreRetrieverMemory(
        vectorstore=ChromaDB(),
        memory_key=<span class="hljs-string">"long_term_memory"</span>
    ),
    system_message=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šå¸‚åœºåˆ†æå¸ˆ"</span>
)

<span class="hljs-comment"># æ‰§è¡Œå¤šæ­¥éª¤ä»»åŠ¡</span>
result = agent_executor.invoke({
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"æŸ¥è¯¢ç‰¹æ–¯æ‹‰Q3è´¢æŠ¥ï¼Œåˆ†æä¸»è¦é£é™©å› ç´ "</span>,
    <span class="hljs-string">"intermediate_steps"</span>: []
})
</code></pre>
<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ol>
<li><code>VectorStoreRetrieverMemory</code>å®ç°é•¿æœŸè®°å¿†æŒä¹…åŒ–</li>
<li><code>create_react_agent</code>é‡‡ç”¨ReActç®—æ³•å®ç°æ¨ç†-è¡ŒåŠ¨å¾ªç¯</li>
<li><code>intermediate_steps</code>å‚æ•°å…è®¸ä»»åŠ¡æ–­ç‚¹ç»­ä¼ 
<strong>å…³é”®æŠ€å·§</strong>ï¼šè®¾ç½®<code>max_interactions=5</code>é¿å…æ— é™å¾ªç¯</li>
</ol>
<h4 data-id="heading-12">3.2 æ¡ˆä¾‹äºŒï¼šAutoGPTè®°å¿†ç®¡ç†</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AutonomousAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, memory_size=<span class="hljs-number">5000</span></span>):
        self.episodic_memory = []  <span class="hljs-comment"># æƒ…æ™¯è®°å¿†</span>
        self.semantic_memory = FAISS()  <span class="hljs-comment"># è¯­ä¹‰è®°å¿†</span>
        self.memory_size = memory_size

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_memory</span>(<span class="hljs-params">self, observation</span>):
        <span class="hljs-comment"># æƒ…æ™¯è®°å¿†å†™å…¥</span>
        timestamp = datetime.now()
        self.episodic_memory.append({
            <span class="hljs-string">"event"</span>: observation,
            <span class="hljs-string">"time"</span>: timestamp
        })
        
        <span class="hljs-comment"># è¯­ä¹‰è®°å¿†åµŒå…¥</span>
        embedding = embed_text(observation)
        self.semantic_memory.add_vectors([embedding], [observation])
        
        <span class="hljs-comment"># è®°å¿†æ¸…ç†ç­–ç•¥</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.episodic_memory) &gt; self.memory_size:
            self.compress_memory()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress_memory</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># é‡‡ç”¨ç”Ÿæˆå¼æ‘˜è¦å‹ç¼©</span>
        summary = self.llm.generate(
            prompt=<span class="hljs-string">f"è¯·æ€»ç»“ä»¥ä¸‹è®°å¿†ï¼š<span class="hljs-subst">{self.episodic_memory[-<span class="hljs-number">100</span>:]}</span>"</span>
        )
        self.episodic_memory = [summary] + self.episodic_memory[<span class="hljs-number">100</span>:]
</code></pre>
<p><strong>æ¶æ„ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>åŒå­˜å‚¨è®¾è®¡å¹³è¡¡<strong>å®æ—¶æ€§</strong>ä¸<strong>çŸ¥è¯†å¯†åº¦</strong></li>
<li>åŠ¨æ€æ‘˜è¦è§£å†³è®°å¿†çˆ†ç‚¸é—®é¢˜</li>
<li>æ—¶é—´æˆ³å®ç°äº‹ä»¶å› æœå…³ç³»é‡å»º</li>
</ul>
<h4 data-id="heading-13">3.3 æ¡ˆä¾‹ä¸‰ï¼šå¤šAgentåä½œç³»ç»Ÿ</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph <span class="hljs-keyword">import</span> MessageGraph

<span class="hljs-comment"># å®šä¹‰AgentèŠ‚ç‚¹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">research_agent</span>(<span class="hljs-params">state</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"report"</span>: search_engine(state[<span class="hljs-string">"topic"</span>])}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">analysis_agent</span>(<span class="hljs-params">state</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"insight"</span>: analyze(state[<span class="hljs-string">"report"</span>])}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">report_agent</span>(<span class="hljs-params">state</span>):
    <span class="hljs-keyword">return</span> format_report(state[<span class="hljs-string">"insight"</span>])

<span class="hljs-comment"># æ„å»ºåä½œå›¾</span>
workflow = MessageGraph()
workflow.add_node(<span class="hljs-string">"research"</span>, research_agent)
workflow.add_node(<span class="hljs-string">"analysis"</span>, analysis_agent)
workflow.add_node(<span class="hljs-string">"report"</span>, report_agent)

<span class="hljs-comment"># è®¾ç½®æ¶ˆæ¯è·¯ç”±</span>
workflow.add_edge(<span class="hljs-string">"research"</span>, <span class="hljs-string">"analysis"</span>)
workflow.add_edge(<span class="hljs-string">"analysis"</span>, <span class="hljs-string">"report"</span>)

<span class="hljs-comment"># å¯åŠ¨åä½œé“¾</span>
results = workflow.<span class="hljs-built_in">compile</span>().invoke({
    <span class="hljs-string">"topic"</span>: <span class="hljs-string">"é‡å­è®¡ç®—å¯¹å¯†ç å­¦çš„å½±å“"</span>
})
</code></pre>
<p><strong>å…³é”®æœºåˆ¶</strong>ï¼š</p>
<ol>
<li><strong>æ¶ˆæ¯é©±åŠ¨æ¶æ„</strong>ï¼šAgenté—´é€šè¿‡stateå¯¹è±¡ä¼ é€’æ•°æ®</li>
<li><strong>æ‹“æ‰‘æ‰§è¡Œ</strong>ï¼šæ”¯æŒå¹¶è¡Œã€æ¡ä»¶åˆ†æ”¯ç­‰å¤æ‚æµ</li>
<li><strong>é”™è¯¯éš”ç¦»</strong>ï¼šå•Agentå´©æºƒä¸å½±å“æ•´ä½“ç³»ç»Ÿ</li>
</ol>
<hr/>
<h3 data-id="heading-14">æŠ€æœ¯å‰æ²¿ï¼š2026å¹´è‡ªä¸»ç³»ç»Ÿä¸‰å¤§å˜é©</h3>
<h4 data-id="heading-15">4.1 å˜é©ä¸€ï¼šå…·èº«æ™ºèƒ½ä½“ï¼ˆEmbodied Agentï¼‰</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æœºå™¨äººæ§åˆ¶Agentç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RoboticsAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, sim</span>):
        self.simulator = sim  <span class="hljs-comment"># ç‰©ç†ä»¿çœŸç¯å¢ƒ</span>
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">action_cycle</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            obs = self.sim.get_observation()
            plan = self.planner.generate(obs)
            self.executor.execute(plan)
            self.memory.store(obs, plan)
</code></pre>
<p><strong>æŠ€æœ¯çªç ´</strong>ï¼š</p>
<ul>
<li>å®æ—¶åŠ¨ä½œè§„åˆ’é¢‘ç‡æå‡è‡³10Hz</li>
<li>å¤šæ¨¡æ€ä¼ æ„Ÿå™¨èåˆï¼ˆLiDAR+è§†è§‰ï¼‰</li>
<li>ä»¿çœŸåˆ°çœŸå®ï¼ˆSim2Realï¼‰è¿ç§»æŠ€æœ¯</li>
</ul>
<h4 data-id="heading-16">4.2 å˜é©äºŒï¼šAgentç»æµç³»ç»Ÿ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant User
    participant AgentA as è®¾è®¡Agent
    participant AgentB as éªŒè¯Agent
    participant Bank as ä¿¡ç”¨åˆçº¦
    
    User-&gt;&gt;AgentA: ä»»åŠ¡è¯·æ±‚(æŠ¥é…¬:$10)
    AgentA-&gt;&gt;AgentB: å­ä»»åŠ¡å§”æ‰˜($3)
    AgentB--&gt;&gt;AgentA: éªŒè¯ç»“æœ
    AgentA-&gt;&gt;Bank: ç»“ç®—è¯·æ±‚
    Bank--&gt;&gt;User: æ‰§è¡Œå®Œæˆ
</code></pre>
<p><strong>æ ¸å¿ƒæœºåˆ¶</strong>ï¼š</p>
<ul>
<li>åŸºäºåŒºå—é“¾çš„å¾®æ”¯ä»˜é€šé“</li>
<li>ä¿¡èª‰è¯„åˆ†ç³»ç»Ÿï¼ˆReputation Scoreï¼‰</li>
<li>ä»»åŠ¡æ‹å–å¸‚åœºï¼ˆTask Auctionï¼‰</li>
</ul>
<h4 data-id="heading-17">4.3 å˜é©ä¸‰ï¼šè‡ªæˆ‘è¿›åŒ–æ¶æ„</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SelfEvolvingAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, core</span>):
        self.core_skills = core
        self.learning_module = EvolutionModule()
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">daily_cycle</span>(<span class="hljs-params">self</span>):
        performance = self.evaluate_performance()
        <span class="hljs-keyword">if</span> performance &lt; <span class="hljs-number">0.7</span>:
            new_skill = self.learning_module.generate()
            self.core_skills.update(new_skill)
            self.test_in_sandbox()
</code></pre>
<p><strong>è¿›åŒ–ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>åŸºäºé—æ†¾çš„å­¦ä¹ ï¼ˆRegret-Based Learningï¼‰</li>
<li>æŠ€èƒ½é—ä¼ ç®—æ³•ï¼ˆSkill GAï¼‰</li>
<li>å®‰å…¨æ²™ç›’éš”ç¦»æœºåˆ¶</li>
</ul>
<hr/>
<h3 data-id="heading-18">å¼€å‘è€…è¡ŒåŠ¨è·¯çº¿å›¾</h3>
<h4 data-id="heading-19">5.1 å­¦ä¹ ä¼˜å…ˆçº§çŸ©é˜µ</h4>





























<table><thead><tr><th>æŠ€èƒ½å±‚çº§</th><th>å¿…é¡»æŒæ¡</th><th>æ¨èæ‹“å±•</th><th>å®éªŒæ€§æŠ€æœ¯</th></tr></thead><tbody><tr><td>åˆçº§</td><td>Agentæ ¸å¿ƒæ¶æ„</td><td>LangChainå·¥å…·é“¾</td><td>Agentæ¨¡æ‹Ÿç¯å¢ƒ</td></tr><tr><td>ä¸­çº§</td><td>å¤šAgentåè°ƒ</td><td>è®°å¿†å‹ç¼©ç®—æ³•</td><td>å®æ—¶åæ€æœºåˆ¶</td></tr><tr><td>é«˜çº§</td><td>è‡ªä¸»è¿›åŒ–è®¾è®¡</td><td>ç»æµç³»ç»Ÿå®ç°</td><td>å…·èº«æ™ºèƒ½é›†æˆ</td></tr></tbody></table>
<h4 data-id="heading-20">5.2 é¿å‘æŒ‡å—ï¼ˆè¡€æ³ªæ•™è®­ï¼‰</h4>
<ol>
<li><strong>å†…å­˜æ³„æ¼</strong>ï¼šå®šæœŸæ£€æŸ¥å‘é‡å­˜å‚¨å¤§å°ï¼Œè®¾ç½®<code>max_memory_items</code></li>
<li><strong>æ­»å¾ªç¯é¢„é˜²</strong>ï¼šå¼ºåˆ¶ä¸­æ–­æ¡ä»¶<code>max_iterations=10</code></li>
<li><strong>å†²çªè§£å†³</strong>ï¼šé‡‡ç”¨ä¼˜å…ˆçº§æŠ¢å ç­–ç•¥ï¼ˆç¤ºä¾‹ä»£ç è§GitHubï¼‰</li>
<li><strong>å®‰å…¨éš”ç¦»</strong>ï¼šæ•æ„Ÿå·¥å…·è°ƒç”¨éœ€åŒé‡éªŒè¯</li>
</ol>
<hr/>
<h3 data-id="heading-21">ç»“è®ºä¸æŒ‘æˆ˜</h3>
<p>é€šè¿‡æœ¬æ–‡çš„æŠ€æœ¯æ‹†è§£ï¼Œç›¸ä¿¡å¼€å‘è€…å·²æŒæ¡æ„å»ºè‡ªä¸»Agentç³»ç»Ÿçš„æ ¸å¿ƒæ–¹æ³•ã€‚ä½†æˆ‘ä»¬å¿…é¡»æ¸…é†’è®¤è¯†åˆ°ï¼š<strong>å½“Agentè·å¾—è¶Šå¤šçš„è‡ªä¸»æƒï¼Œè´£ä»»æœºåˆ¶å°±è¶Šå¤æ‚</strong>ã€‚æœ€åæŠ›å‡ºä¸¤ä¸ªå…³é”®é—®é¢˜ä¾›æ€è€ƒï¼š</p>
<ol>
<li>å¦‚ä½•è®¾è®¡<strong>å¯éªŒè¯çš„é“å¾·çº¦æŸå±‚</strong>ï¼Œé˜²æ­¢ç›®æ ‡æ›²è§£ï¼ˆGoal Misgeneralizationï¼‰ï¼Ÿ</li>
<li>åœ¨<strong>å¤šAgentç»æµç³»ç»Ÿ</strong>ä¸­ï¼Œæ€æ ·çš„æ¿€åŠ±æœºåˆ¶æ‰èƒ½é¿å…èµ„æºå„æ–­ï¼Ÿ</li>
</ol>
<blockquote>
<p>å®æˆ˜ä»£ç åº“åŠæ¶æ„å›¾å®Œæ•´ç‰ˆï¼š<br/>
GitHubï¼šgithub.com/AgentRevolution2026ï¼ˆè¯·å‹¿ç›´æ¥å¤åˆ¶ç”Ÿäº§ç¯å¢ƒä»£ç ï¼‰<br/>
<strong>æŠ€æœ¯æ¼”è¿›é€Ÿåº¦è¿œè¶…é¢„æœŸï¼Œä»Šæ—¥çš„å‰æ²¿æ¢ç´¢å°†æ˜¯æ˜æ—¥çš„ç”Ÿå­˜å¿…å¤‡æŠ€èƒ½</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¨‹åºå‘˜è¿‘åå¹´æ–°å¹´æ„¿æœ›ï¼Œéƒ½æœ‰å“ªäº›å˜åŒ–ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7592876744526889010</link>    <guid>https://juejin.cn/post/7592876744526889010</guid>    <pubDate>2026-01-09T02:48:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592876744526889010" data-draft-id="7592903126178463794" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¨‹åºå‘˜è¿‘åå¹´æ–°å¹´æ„¿æœ›ï¼Œéƒ½æœ‰å“ªäº›å˜åŒ–ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-09T02:48:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="pany"/> <meta itemprop="url" content="https://juejin.cn/user/2041120304148845"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¨‹åºå‘˜è¿‘åå¹´æ–°å¹´æ„¿æœ›ï¼Œéƒ½æœ‰å“ªäº›å˜åŒ–ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2041120304148845/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    pany
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:48:24.000Z" title="Fri Jan 09 2026 02:48:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸å°‘äº’è”ç½‘ä»ä¸šè€…åº”è¯¥éƒ½çŸ¥é“Â V2EX è¿™ä¸ªç¤¾åŒºï¼Œå®ƒæ—©æœŸå°±ä»¥æœ‰ä»·å€¼æœ‰æ·±åº¦çš„è®¨è®ºæ°›å›´é—»åã€‚è¿™å‡ å¤©ç«™å†…éƒ½åœ¨è®¨è®º 2026 æ–°å¹´çš„è§„åˆ’ï¼Œè¿™æ—¶æœ‰ä¸€ä¸ªå«Â <strong>su3sl3h06</strong>Â çš„ç”¨æˆ·å¤§ä½¬å› ä¸ºå¥½å¥‡å’Œæ„Ÿæ…¨ï¼Œå†™è„šæœ¬è€ƒå¤äº†ç«™å†…<strong>ä» 2016 å¹´åˆ° 2026 å¹´è¿™åå¹´çš„ â€œæ–°å¹´æ„¿æœ›/è§„åˆ’â€ è´´</strong>ï¼Œæˆ‘è§‰å¾—éå¸¸æœ‰æ„ä¹‰ï¼Œåœ¨è¿™é‡Œåˆ†äº«ç»™å¤§å®¶ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd3d781d781d497289a700e57d5dab9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcGFueQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768532181&amp;x-signature=iTi1T%2BMVj%2BOVCRMXL%2BpC5NwOh5k%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>2016 å¹´</strong></p>
<p>è¿™æ—¶å€™çš„æˆ‘è¿˜å¤§ä¸€åœ¨å¤§å­¦æœºæˆ¿ç¿»é˜…ç€ C è¯­è¨€ç¨‹åºè®¾è®¡æ•™æå‘¢ï¼Œä½†å¥½åœ¨å·²ç»ä¸æ˜¯è¢«äººåæ§½çš„è°­æµ©å¼ºç‰ˆæœ¬äº†å“ˆå“ˆå“ˆã€‚</p>
<p>è€Œç¤¾åŒºé‡Œå·²ç»ä»ä¸šçš„å‰è¾ˆä»¬ä¸»è¦ä»¥å‡èŒåŠ è–ªåˆ›ä¸šç­‰ä¸ºç›®æ ‡ï¼Œçœ‹å¾—å‡º<strong>ä¸€ç‰‡æ¬£æ¬£å‘è£</strong>ã€‚</p>
<p><strong>2018 å¹´</strong></p>
<p>ç°åœ¨æˆ‘å·²ç»å¤§ä¸‰äº†ï¼Œæ­¤æ—¶æˆ‘ä¸ä»…èƒ½ç†Ÿç»ƒç”¨ C å’Œ Java å†™å„ç§å„æ ·çš„ â€œç›Šæ™ºè¶£å‘³ç¼–ç¨‹é¢˜â€ ï¼Œæ¯”å¦‚ä»€ä¹ˆå›æ–‡æ•°ã€æ°´ä»™èŠ±æ•°ï¼Œè¿˜æŒæ¡äº†ç¨‹åºå‘˜çš„åœ£ç»ã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ã€‹ï¼Œè™½ç„¶ç°åœ¨ä¹Ÿå¿˜å¾—å·®ä¸å¤šäº†...</p>
<p>è€Œæ­¤æ—¶çš„ç¤¾åŒºå·²ç»æ²¡æœ‰äº†å‘è£çš„è¿¹è±¡ï¼Œå°è±¡ä¸­äº’è”ç½‘å¯’å†¬è¿™ä¸ªçŸ¥ä¹ä¸Šçš„å¹´æ›´è¯é¢˜å°±åœ¨è¿™å¹´è¯ç”Ÿçš„ã€‚</p>
<p><strong>è®°å¾—å½“æ—¶æˆ‘ä¸€è¾¹æ£€ç´¢ç€ã€Œå‰ç«¯å­¦ä¹ è·¯çº¿ã€ä¸€è¾¹åˆ·ç€ã€Œå‰ç«¯å·²ç»é¥±å’Œã€çš„è¯é¢˜ï¼Œæœ‰ä¸€è‚¡è¯´ä¸å‡ºæ¥çš„æ»‹å‘³...</strong></p>
<p><strong>2019 å¹´</strong></p>
<p>æˆ‘ç»ˆäºå¤§å››äº†ï¼Œå­¦æ ¡å¼€å§‹ç»„ç»‡å„ç§å®è®­ï¼ŒåŒå­¦ä»¬ä¹Ÿé™†ç»­æŠ¥åå„ç§äº”èŠ±å…«é—¨çš„åŸ¹è®­ç­æˆ–è€…èµ°è€ƒç ”è·¯çº¿ã€‚<br/>
å¥½æ¶ˆæ¯æ˜¯æˆ‘è‡ªå­¦äº†å‰ç«¯ï¼Œå·²ç»åšå¥½äº†ç›´æ¥å®ä¹ çš„å‡†å¤‡ï¼Œ<strong>åæ¶ˆæ¯æ˜¯äº’è”ç½‘çœŸçš„å¯’å†¬äº†...</strong></p>
<p><strong>2020 å¹´</strong></p>
<p>æˆ‘ä»æˆéƒ½æŸå®‰å…¨å…¬å¸ç»“æŸå®ä¹ ï¼Œå›åˆ°é‡åº†é‚®ç”µå¤§å­¦çš„ä¸€å®¶æ¸©æš–çš„å°å…¬å¸ç»§ç»­æˆ‘çš„ç¨‹åºäººç”Ÿã€‚</p>
<p>è¿™æ—¶çš„ç¤¾åŒºï¼Œå·²ç»å¼€å§‹é¢‘ç¹å‡ºç°<strong>è£å‘˜</strong>çš„å…³é”®å­—äº†ï¼Œè€Œæˆ‘åœ¨èˆ’é€‚åœˆé‡Œå¾…ç€ï¼Œæ¸æ¸å¿½è§†äº†å¤–é¢çš„å±æœºå››ä¼ã€‚</p>
<p><strong>2021 ~ 2023 å¹´</strong></p>
<p>ä¼¼ä¹ç—…æ¯’æˆäº†å‹æ­»éª†é©¼çš„æœ€åä¸€æ ¹ç¨»è‰ï¼Œæˆ‘å’Œç¤¾åŒºçš„å…³é”®å­—éƒ½æ˜¯<strong>è‹Ÿæ´»ç€</strong>ï¼Œåœ¨æ­¤æœŸé—´æˆ‘è¿˜ç»å†äº†è·³æ§½å’Œè£å‘˜ï¼Œæœ‰æœºä¼šå†è¯¦ç»†å†™å§ï¼Œæ„Ÿè§‰æ¯ä¸€æ®µéƒ½æ˜¯å€¼å¾—å›é¡¾çš„æœ‰ä»·å€¼çš„ç»å†ã€‚</p>
<p><strong>2024 ~ 2026 å¹´</strong></p>
<p>æˆ‘å’Œç¤¾åŒºå‡ ä¹åŒé¢‘ï¼Œå…³é”®å­—éƒ½æ˜¯<strong>å‰¯ä¸š</strong>å’Œ<strong>ä¿ä½å·¥ä½œ</strong>ã€‚</p>
<p>æˆ‘åœ¨ 2024 å¹´å°è¯•å°†è‡ªå·±çš„å¼€æºé¡¹ç›®å¼•å…¥ä¸€äº›ä»˜è´¹çš„æœåŠ¡ï¼Œå¯¹æˆ‘æ¥è¯´è¦æ˜¯èƒ½å°†å¼€æºè¿™ä¸ªçˆ±å¥½å˜ç°å°±å¤ªå®Œç¾äº†ã€‚ä½†æ˜¯ä¸å¤ªå°½äººæ„ï¼Œè´­ä¹°ä»˜è´¹æœåŠ¡çš„å‰æœŸè¿˜æ˜¯è›®å¤šçš„ï¼ŒåæœŸç–äºå®£ä¼ ï¼Œæµé‡è¶Šæ¥è¶Šå°‘è´­ä¹°çš„äººæ•°è‡ªç„¶å°±ä¸‹é™äº†ã€‚ä¸è¿‡è¿™ä¹Ÿæé†’æˆ‘æ˜¯æ—¶å€™è¯¥é‡æ–°é‡è§†å¼€æºé¡¹ç›®çš„æ›´æ–°ä¸å®£ä¼ äº†ï¼</p>
<p>æœ‰æ„æ€çš„æ˜¯<strong>ä¿ä½å·¥ä½œ</strong>è¿™ä¸ªå…³é”®å­—åœ¨ä»Šå¹´åˆ·å±çº§çš„å‡ºç°ï¼Œè¿™æ˜¯ä¸æ˜¯ä¹Ÿæ„å‘³ç€ï¼Œå¯¹å¤§éƒ¨åˆ†äººæ¥è¯´ï¼Œè£å‘˜å·²ç»æ˜¯æ¯å¹´æ¿ä¸Šé’‰é’‰çš„äº‹æƒ…äº†ï¼Ÿ</p>
<hr/>
<p><strong>æœ€åæ€»ç»“ä¸€ä¸‹è¿™åå¹´ï¼Œåƒæ˜¯ä¸€æ¡æŠ›ç‰©çº¿ï¼š</strong></p>
<ul>
<li>ä¸Šå‡æœŸ (2016-2017)ï¼š ä¿¡å¿ƒæ»¡æ»¡ï¼Œç›¸ä¿¡åŠªåŠ›å°±èƒ½æ”¹å˜å‘½è¿ï¼Œç›¸ä¿¡äº’è”ç½‘çš„çº¢åˆ©æ°¸è¿œåƒä¸å®Œ</li>
<li>éœ‡è¡æœŸ (2018-2019)ï¼š ä¾ç„¶åœ¨åŠªåŠ›ï¼Œä½†å¼€å§‹æ„Ÿåˆ°åƒåŠ›ï¼Œå¼€å§‹ç”¨å¹½é»˜æ¶ˆè§£ç„¦è™‘</li>
<li>ä¸‹å æœŸ (2020-2022)ï¼š ä¸å¯æŠ—åŠ›è¢­æ¥ï¼Œå¿ƒæ€å´©å¡Œï¼Œä»å¥‹æ–—è½¬å‘èººå¹³</li>
<li>ä½è°·å¹³å°æœŸ (2023-2026)ï¼š æ¥å—ç°å®ï¼Œä¸å†åšæ¢¦ã€‚â€œä¿ä½å·¥ä½œâ€ æˆä¸ºæœ€é«˜çš„å¥¢æœ›ï¼Œâ€œèº«ä½“å¥åº·â€ æˆä¸ºæœ€åçš„åº•çº¿</li>
</ul>
<hr/>
<p>å¥½äº†ï¼Œæ–‡ç« å°±åˆ°è¿™ï¼ŒæœŸå¾…ä¸‹æœŸä¸ä½ ç›¸è§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Docker Buildxï¼šæ„å»ºå®¹å™¨é•œåƒçš„ç‘å£«å†›åˆ€]]></title>    <link>https://juejin.cn/post/7592819937652752399</link>    <guid>https://juejin.cn/post/7592819937652752399</guid>    <pubDate>2026-01-09T00:40:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592819937652752399" data-draft-id="7592819937652736015" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Docker Buildxï¼šæ„å»ºå®¹å™¨é•œåƒçš„ç‘å£«å†›åˆ€"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,AIGC"/> <meta itemprop="datePublished" content="2026-01-09T00:40:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="qife122"/> <meta itemprop="url" content="https://juejin.cn/user/1743174852185579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Docker Buildxï¼šæ„å»ºå®¹å™¨é•œåƒçš„ç‘å£«å†›åˆ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1743174852185579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    qife122
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T00:40:48.000Z" title="Fri Jan 09 2026 00:40:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Docker Buildx</h2>
<p>Docker Buildx æ˜¯ä¸€ä¸ª Docker CLI æ’ä»¶ï¼Œå®ƒåŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmoby%2Fbuildkit" target="_blank" title="https://github.com/moby/buildkit" ref="nofollow noopener noreferrer">BuildKit</a> æä¾›äº†æ‰©å±•çš„æ„å»ºèƒ½åŠ›ã€‚å®ƒæ—¨åœ¨æä¾›ä¸ <code>docker build</code> ç±»ä¼¼çš„ç”¨æˆ·ç•Œé¢ï¼ŒåŒæ—¶è§£é” BuildKit çš„å…¨éƒ¨åŠŸèƒ½é›†ã€‚Buildx æ”¯æŒå¤šä¸ªæ„å»ºå™¨å®ä¾‹ã€ç”¨äºè·¨å¹³å°é•œåƒçš„å¤šèŠ‚ç‚¹æ„å»ºã€Compose æ„å»ºæ”¯æŒä»¥åŠä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.docker.com%2Fbuild%2Fbake%2F" target="_blank" title="https://docs.docker.com/build/bake/" ref="nofollow noopener noreferrer">Bake</a> è¿›è¡Œé«˜çº§æ„å»ºã€‚</p>
<h3 data-id="heading-1">åŠŸèƒ½ç‰¹æ€§</h3>
<p>Buildx é›†æˆäº† BuildKit çš„æ‰€æœ‰èƒ½åŠ›ï¼Œå¹¶æä¾›äº†ä»¥ä¸‹å…³é”®ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>ç†Ÿæ‚‰çš„ç”¨æˆ·ä½“éªŒ</strong>ï¼šå‘½ä»¤ç•Œé¢ä¸ä¼ ç»Ÿçš„ <code>docker build</code> ç›¸ä¼¼ï¼Œé™ä½äº†å­¦ä¹ æˆæœ¬ã€‚</li>
<li><strong>å®Œæ•´çš„ BuildKit èƒ½åŠ›</strong>ï¼šåˆ©ç”¨å®¹å™¨é©±åŠ¨ç¨‹åºï¼Œæ”¯æŒæ‰€æœ‰ BuildKit çš„é«˜çº§åŠŸèƒ½ã€‚</li>
<li><strong>å¤šä¸ªæ„å»ºå™¨å®ä¾‹æ”¯æŒ</strong>ï¼šå¯ä»¥åˆ›å»ºå’Œç®¡ç†å¤šä¸ªç‹¬ç«‹çš„æ„å»ºå™¨ç¯å¢ƒã€‚</li>
<li><strong>å¤šå¹³å°æ„å»º</strong>ï¼šæ— éœ€æ¨¡æ‹Ÿï¼Œå³å¯ä¸ºå¤šç§æ¶æ„ï¼ˆå¦‚ linux/amd64, linux/arm64ï¼‰æ„å»ºé•œåƒã€‚</li>
<li><strong>Compose æ„å»ºæ”¯æŒ</strong>ï¼šç›´æ¥ä» Docker Compose æ–‡ä»¶æ„å»ºæœåŠ¡é•œåƒã€‚</li>
<li><strong>Bake é«˜çº§æ„å»º</strong>ï¼šé€šè¿‡å£°æ˜å¼é…ç½®æ–‡ä»¶ï¼ˆHCL æˆ– JSONï¼‰å®šä¹‰å’Œæ„å»ºå¤æ‚çš„å¤šç›®æ ‡æ„å»ºå·¥ä½œæµã€‚</li>
<li><strong>å®¹å™¨å†…é©±åŠ¨ç¨‹åºæ”¯æŒ</strong>ï¼šæ”¯æŒåœ¨ Docker å®¹å™¨å’Œ Kubernetes Pod ä¸­è¿è¡Œæ„å»ºå™¨ã€‚</li>
</ul>
<h3 data-id="heading-2">å®‰è£…æŒ‡å—</h3>
<p>ä½¿ç”¨ Buildx éœ€è¦ Docker Engine 19.03 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p>
<blockquote>
<p><strong>è­¦å‘Š</strong>ï¼šä½¿ç”¨ä¸å…¼å®¹çš„ Docker ç‰ˆæœ¬å¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸ºï¼Œå¹¶å¾ˆå¯èƒ½å¼•å‘é—®é¢˜ã€‚</p>
</blockquote>
<h4 data-id="heading-3">Windows å’Œ macOS</h4>
<p>Docker Desktop å·²å†…ç½® Buildxï¼Œæ— éœ€é¢å¤–å®‰è£…ã€‚</p>
<h4 data-id="heading-4">Linux åŒ…ç®¡ç†å™¨å®‰è£…</h4>
<p>å¯ä»¥é€šè¿‡ç³»ç»Ÿçš„åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ï¼š</p>
<ul>
<li><strong>Debian/Ubuntu</strong>: <code>apt-get install docker-buildx-plugin</code></li>
<li><strong>RHEL/Fedora</strong>: <code>yum install docker-buildx-plugin</code></li>
</ul>
<h4 data-id="heading-5">æ‰‹åŠ¨ä¸‹è½½</h4>
<p>ä» <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdocker%2Fbuildx%2Freleases" target="_blank" title="https://github.com/docker/buildx/releases" ref="nofollow noopener noreferrer">GitHub Releases</a> é¡µé¢ä¸‹è½½é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°†å…¶æ”¾ç½®äº Docker æ’ä»¶ç›®å½•ä¸‹ï¼ˆä¾‹å¦‚ <code>~/.docker/cli-plugins/</code>ï¼‰ï¼Œå¹¶ç¡®ä¿å…¶å…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚</p>
<h4 data-id="heading-6">ä½¿ç”¨ Dockerfile</h4>
<p>æ‚¨ä¹Ÿå¯ä»¥åœ¨ Dockerfile ä¸­ä½¿ç”¨ <code>FROM --platform=$BUILDPLATFORM</code> æŒ‡ä»¤ï¼Œé…åˆ Buildx åœ¨å¤šé˜¶æ®µæ„å»ºä¸­å¤åˆ¶äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<h4 data-id="heading-7">å®‰è£…ä¸º Docker CLI æ’ä»¶åˆ«å</h4>
<p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°† Buildx è®¾ç½®ä¸º <code>docker builder</code> çš„åˆ«åï¼ˆæ—§ç‰ˆæ–¹å¼ï¼Œç°å·²ä¸æ¨èï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker buildx install
</code></pre>
<p>è‹¥è¦ç§»é™¤åˆ«åï¼Œè¯·è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker buildx uninstall
</code></pre>
<h3 data-id="heading-8">ä½¿ç”¨è¯´æ˜</h3>
<h4 data-id="heading-9">åŸºæœ¬æ„å»º</h4>
<p>ä½¿ç”¨ <code>buildx build</code> å‘½ä»¤è¿›è¡Œæ„å»ºï¼Œå…¶å‚æ•°ä¸ <code>docker build</code> ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker buildx build -t your-image:tag .
</code></pre>
<h4 data-id="heading-10">ç®¡ç†æ„å»ºå™¨å®ä¾‹</h4>
<p>Buildx æ”¯æŒå¤šä¸ªæ„å»ºå™¨å®ä¾‹ã€‚æŸ¥çœ‹å½“å‰å®ä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker buildx <span class="hljs-built_in">ls</span>
</code></pre>
<p>åˆ›å»ºæ–°çš„æ„å»ºå™¨å®ä¾‹ï¼ˆä¾‹å¦‚ä½¿ç”¨ <code>docker-container</code> é©±åŠ¨ç¨‹åºï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker buildx create --name mybuilder --driver docker-container --use
</code></pre>
<p><code>--use</code> æ ‡å¿—ä¼šç«‹å³åˆ‡æ¢åˆ°æ–°åˆ›å»ºçš„æ„å»ºå™¨ã€‚</p>
<h4 data-id="heading-11">æ„å»ºå¤šå¹³å°é•œåƒ</h4>
<p>è¿™æ˜¯ Buildx çš„æ ¸å¿ƒä¼˜åŠ¿ä¹‹ä¸€ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <code>--platform</code> æ ‡å¿—æŒ‡å®šå¤šä¸ªå¹³å°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker buildx build --platform linux/amd64,linux/arm64 -t your-image:multiarch .
</code></pre>
<p>ä¸ºäº†æˆåŠŸæ„å»ºå¤šå¹³å°é•œåƒï¼Œéœ€è¦ç¡®ä¿æ‚¨çš„æ„å»ºå™¨æ”¯æŒå¤šå¹³å°ï¼ˆé€šå¸¸å®¹å™¨é©±åŠ¨ç¨‹åºæ”¯æŒï¼‰ï¼Œå¹¶ä¸”å¯èƒ½éœ€è¦é…ç½® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftonistiigi%2Fbinfmt" target="_blank" title="https://github.com/tonistiigi/binfmt" ref="nofollow noopener noreferrer">binfmt_misc</a> æ¥æ³¨å†Œä»¿çœŸå™¨ã€‚</p>
<h4 data-id="heading-12">ä½¿ç”¨ Bake è¿›è¡Œé«˜çº§æ„å»º</h4>
<p>Bake å…è®¸æ‚¨ä½¿ç”¨ HCL æˆ– JSON æ–‡ä»¶å®šä¹‰æ„å»ºç›®æ ‡ã€‚åˆ›å»ºä¸€ä¸ª <code>docker-bake.hcl</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-hcl" lang="hcl">variable "TAG" {
  default = "latest"
}

group "default" {
  targets = ["app", "db"]
}

target "app" {
  context = "."
  dockerfile = "Dockerfile.app"
  tags = ["your-registry/app:${TAG}"]
}

target "db" {
  context = "./db"
  dockerfile = "Dockerfile"
  tags = ["your-registry/db:${TAG}"]
}
</code></pre>
<p>ç„¶åè¿è¡Œæ„å»ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker buildx bake --<span class="hljs-built_in">set</span> *.tags=your-registry/my-app:custom-tag
</code></pre>
<p>Bake æ”¯æŒä»å¤šä¸ªæ–‡ä»¶ï¼ˆåŒ…æ‹¬ Docker Compose æ–‡ä»¶ï¼‰è¯»å–é…ç½®ï¼Œå¹¶å…è®¸é€šè¿‡å‘½ä»¤è¡Œè¿›è¡Œè¦†ç›–ã€‚</p>
<h3 data-id="heading-13">æ ¸å¿ƒä»£ç </h3>
<p>ä»¥ä¸‹æ˜¯ä» Buildx é¡¹ç›®ä¸­æå–çš„ä¸€äº›æ ¸å¿ƒä»£ç ç‰‡æ®µï¼Œå±•ç¤ºäº†å…¶å†…éƒ¨å·¥ä½œæœºåˆ¶ã€‚</p>
<h4 data-id="heading-14">Bake é…ç½®æ–‡ä»¶è§£æ</h4>
<p><code>bake</code> åŒ…è´Ÿè´£è§£æ Bake çš„é…ç½®æ–‡ä»¶ï¼ˆHCL/JSON/Composeï¼‰ã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•è¯»å–å’Œåˆå¹¶æœ¬åœ°æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŒ… bake è´Ÿè´£è§£æå’Œå¤„ç† Bake é…ç½®æ–‡ä»¶ã€‚</span>
<span class="hljs-keyword">package</span> bake

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"io"</span>
	<span class="hljs-string">"os"</span>
	<span class="hljs-string">"path/filepath"</span>
	<span class="hljs-string">"slices"</span>
	<span class="hljs-string">"strings"</span>
)

<span class="hljs-comment">// File ç»“æ„ä½“è¡¨ç¤ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ–‡ä»¶åå’Œå†…å®¹ã€‚</span>
<span class="hljs-keyword">type</span> File <span class="hljs-keyword">struct</span> {
	Name <span class="hljs-type">string</span>
	Data []<span class="hljs-type">byte</span>
}

<span class="hljs-comment">// ReadLocalFiles è¯»å–æŒ‡å®šçš„é…ç½®æ–‡ä»¶åˆ—è¡¨ã€‚å¦‚æœæœªæä¾›æ–‡ä»¶åï¼Œåˆ™ä½¿ç”¨é»˜è®¤æ–‡ä»¶ååˆ—è¡¨ã€‚</span>
<span class="hljs-comment">// å®ƒæ”¯æŒä»æ ‡å‡†è¾“å…¥ï¼ˆ"-"ï¼‰è¯»å–ï¼Œå¹¶ä¼šä¸ºä¸å­˜åœ¨çš„é»˜è®¤æ–‡ä»¶è·³è¿‡é”™è¯¯ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ReadLocalFiles</span><span class="hljs-params">(names []<span class="hljs-type">string</span>, stdin io.Reader, l progress.SubLogger)</span></span> ([]File, <span class="hljs-type">error</span>) {
	isDefault := <span class="hljs-literal">false</span>
	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(names) == <span class="hljs-number">0</span> {
		isDefault = <span class="hljs-literal">true</span>
		names = defaultFilenames() <span class="hljs-comment">// è·å–é»˜è®¤æ–‡ä»¶ååˆ—è¡¨ï¼Œå¦‚ docker-bake.hcl, docker-compose.yml ç­‰</span>
	}
	out := <span class="hljs-built_in">make</span>([]File, <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(names))

	<span class="hljs-comment">// è®¾ç½®è¿›åº¦æ—¥å¿—çŠ¶æ€çš„å›è°ƒå‡½æ•°</span>
	setStatus := <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(st *client.VertexStatus)</span></span> {
		<span class="hljs-keyword">if</span> l != <span class="hljs-literal">nil</span> {
			l.SetStatus(st)
		}
	}

	<span class="hljs-keyword">for</span> _, n := <span class="hljs-keyword">range</span> names {
		<span class="hljs-keyword">var</span> dt []<span class="hljs-type">byte</span>
		<span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>
		<span class="hljs-keyword">if</span> n == <span class="hljs-string">"-"</span> {
			<span class="hljs-comment">// ä»æ ‡å‡†è¾“å…¥è¯»å–</span>
			dt, err = readWithProgress(stdin, setStatus)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
			}
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-comment">// ä»æ–‡ä»¶è¯»å–ï¼Œå¦‚æœæ˜¯é»˜è®¤æ–‡ä»¶ä¸”ä¸å­˜åœ¨ï¼Œåˆ™é™é»˜è·³è¿‡ã€‚</span>
			dt, err = readFileWithProgress(n, isDefault, setStatus)
			<span class="hljs-keyword">if</span> dt == <span class="hljs-literal">nil</span> &amp;&amp; err == <span class="hljs-literal">nil</span> {
				<span class="hljs-keyword">continue</span>
			}
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
			}
		}
		out = <span class="hljs-built_in">append</span>(out, File{Name: n, Data: dt})
	}
	<span class="hljs-keyword">return</span> out, <span class="hljs-literal">nil</span>
}
</code></pre>
<h4 data-id="heading-15">HCL è§£æå™¨ä¸­çš„å‡½æ•°è°ƒç”¨æå–</h4>
<p><code>hclparser</code> åŒ…åŒ…å«ç”¨äºå¤„ç† HCL é…ç½®çš„å®ç”¨å‡½æ•°ã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä» HCL è¡¨è¾¾å¼ä¸­æå–å‡½æ•°è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŒ… hclparser æä¾›äº†è§£æå’Œå¤„ç† HCL é…ç½®æ–‡ä»¶çš„å·¥å…·ã€‚</span>
<span class="hljs-keyword">package</span> hclparser

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"reflect"</span>
	<span class="hljs-string">"unsafe"</span>

	<span class="hljs-string">"github.com/hashicorp/hcl/v2"</span>
	<span class="hljs-string">"github.com/hashicorp/hcl/v2/hclsyntax"</span>
	<span class="hljs-string">"github.com/pkg/errors"</span>
)

<span class="hljs-comment">// funcCalls é€’å½’éå† HCL è¡¨è¾¾å¼ï¼Œæ”¶é›†å…¶ä¸­æ‰€æœ‰å‡½æ•°è°ƒç”¨çš„åç§°ã€‚</span>
<span class="hljs-comment">// å®ƒå¤„ç†åŸç”Ÿçš„ hclsyntax è¡¨è¾¾å¼å’Œ JSON æ ¼å¼çš„è¡¨è¾¾å¼ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">funcCalls</span><span class="hljs-params">(exp hcl.Expression)</span></span> ([]<span class="hljs-type">string</span>, hcl.Diagnostics) {
	node, ok := exp.(hclsyntax.Node)
	<span class="hljs-keyword">if</span> !ok {
		<span class="hljs-comment">// å¯¹äº JSON è¡¨è¾¾å¼ï¼Œä½¿ç”¨é€’å½’å‡½æ•°å¤„ç†</span>
		fns, err := jsonFuncCallsRecursive(exp)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, wrapErrorDiagnostic(<span class="hljs-string">"Invalid expression"</span>, err, exp.Range().Ptr(), exp.Range().Ptr())
		}
		<span class="hljs-keyword">return</span> fns, <span class="hljs-literal">nil</span>
	}

	<span class="hljs-keyword">var</span> funcnames []<span class="hljs-type">string</span>
	<span class="hljs-comment">// ä½¿ç”¨ hclsyntax.VisitAll éå†è¯­æ³•æ ‘èŠ‚ç‚¹</span>
	hcldiags := hclsyntax.VisitAll(node, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(n hclsyntax.Node)</span></span> hcl.Diagnostics {
		<span class="hljs-keyword">if</span> fe, ok := n.(*hclsyntax.FunctionCallExpr); ok {
			funcnames = <span class="hljs-built_in">append</span>(funcnames, fe.Name) <span class="hljs-comment">// æ”¶é›†å‡½æ•°å</span>
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
	})
	<span class="hljs-keyword">if</span> hcldiags.HasErrors() {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, hcldiags
	}
	<span class="hljs-keyword">return</span> funcnames, <span class="hljs-literal">nil</span>
}
</code></pre>
<h4 data-id="heading-16">é©±åŠ¨ç¨‹åºæ¥å£ä¸å®ç°</h4>
<p><code>driver</code> åŒ…å®šä¹‰äº†æ„å»ºå™¨é©±åŠ¨ç¨‹åºçš„é€šç”¨æ¥å£ï¼Œä¸åŒçš„é©±åŠ¨ç¨‹åºï¼ˆå¦‚ <code>docker-container</code>, <code>kubernetes</code>ï¼‰éƒ½å®ç°æ­¤æ¥å£ã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºäº†é©±åŠ¨ç¨‹åºä¿¡æ¯æŸ¥è¯¢å’Œå®¢æˆ·ç«¯è¿æ¥çš„æ ¸å¿ƒæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŒ… driver å®šä¹‰äº†æ„å»ºå™¨é©±åŠ¨ç¨‹åºçš„æ¥å£å’ŒåŸºç¡€ç»“æ„ã€‚</span>
<span class="hljs-keyword">package</span> driver

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"net"</span>
	<span class="hljs-string">"sync"</span>
	<span class="hljs-string">"time"</span>

	<span class="hljs-string">"github.com/moby/buildkit/client"</span>
	<span class="hljs-string">"github.com/pkg/errors"</span>
)

<span class="hljs-comment">// Driver æ¥å£æ˜¯æ‰€æœ‰ Buildx é©±åŠ¨ç¨‹åºï¼ˆå¦‚ dockerã€docker-containerã€kubernetesã€remoteï¼‰å¿…é¡»å®ç°çš„å¥‘çº¦ã€‚</span>
<span class="hljs-keyword">type</span> Driver <span class="hljs-keyword">interface</span> {
	Factory() Factory
	Bootstrap(context.Context, progress.Logger) <span class="hljs-type">error</span>
	Info(context.Context) (*Info, <span class="hljs-type">error</span>)
	Version(context.Context) (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>)
	Stop(ctx context.Context, force <span class="hljs-type">bool</span>) <span class="hljs-type">error</span>
	Rm(ctx context.Context, force, rmVolume, rmDaemon <span class="hljs-type">bool</span>) <span class="hljs-type">error</span>
	Dial(ctx context.Context) (net.Conn, <span class="hljs-type">error</span>)
	Client(ctx context.Context, opts ...client.ClientOpt) (*client.Client, <span class="hljs-type">error</span>)
	Features(ctx context.Context) <span class="hljs-keyword">map</span>[Feature]<span class="hljs-type">bool</span>
	HostGatewayIP(ctx context.Context) (net.IP, <span class="hljs-type">error</span>)
	IsMobyDriver() <span class="hljs-type">bool</span>
	Config() InitConfig
}

<span class="hljs-comment">// Boot æ˜¯ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œç”¨äºå¼•å¯¼é©±åŠ¨ç¨‹åºå¹¶è·å– BuildKit å®¢æˆ·ç«¯ã€‚</span>
<span class="hljs-comment">// å®ƒä¼šå°è¯•å¯åŠ¨é©±åŠ¨ç¨‹åºï¼ˆå¦‚æœå°šæœªè¿è¡Œï¼‰ï¼Œå¹¶åœ¨å¤±è´¥æ—¶é‡è¯•ã€‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Boot</span><span class="hljs-params">(ctx, clientContext context.Context, d *DriverHandle, pw progress.Writer)</span></span> (*client.Client, <span class="hljs-type">error</span>) {
	try := <span class="hljs-number">0</span>
	logger := discardLogger
	<span class="hljs-keyword">if</span> pw != <span class="hljs-literal">nil</span> {
		logger = pw.Write
	}

	<span class="hljs-keyword">for</span> {
		info, err := d.Info(ctx) <span class="hljs-comment">// æŸ¥è¯¢é©±åŠ¨ç¨‹åºçŠ¶æ€</span>
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
		}
		try++
		<span class="hljs-keyword">if</span> info.Status != Running {
			<span class="hljs-keyword">if</span> try &gt; <span class="hljs-number">2</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, errors.Errorf(<span class="hljs-string">"failed to bootstrap %T driver in attempts"</span>, d)
			}
			<span class="hljs-comment">// å¦‚æœæœªè¿è¡Œï¼Œåˆ™å°è¯•å¼•å¯¼å¯åŠ¨</span>
			<span class="hljs-keyword">if</span> err := d.Bootstrap(ctx, logger); err != <span class="hljs-literal">nil</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
			}
		}

		<span class="hljs-comment">// è·å– BuildKit å®¢æˆ·ç«¯</span>
		c, err := d.Client(clientContext)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">if</span> errors.Is(err, ErrNotRunning{}) &amp;&amp; try &lt;= <span class="hljs-number">2</span> {
				<span class="hljs-keyword">continue</span> <span class="hljs-comment">// å¦‚æœæ˜¯æœªè¿è¡Œé”™è¯¯ï¼Œä¸”å°è¯•æ¬¡æ•°æœªè¶…ï¼Œåˆ™é‡è¯•å¾ªç¯</span>
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
		}
		<span class="hljs-keyword">return</span> c, <span class="hljs-literal">nil</span>
	}
}
</code></pre>
<p>è¿™äº›ä»£ç ç‰‡æ®µä½“ç°äº† Buildx é¡¹ç›®çš„å‡ ä¸ªæ ¸å¿ƒè®¾è®¡ï¼šæ¨¡å—åŒ–ï¼ˆé€šè¿‡é©±åŠ¨ç¨‹åºæ”¯æŒå¤šç§åç«¯ï¼‰ã€å£°æ˜å¼é…ç½®ï¼ˆé€šè¿‡ Bake å’Œ HCLï¼‰ä»¥åŠå¯¹ BuildKit æ‰€æœ‰åŠŸèƒ½çš„å……åˆ†åˆ©ç”¨ã€‚
9sS2xK9ahqK2nmJ3CUBl9PAdseQ0eJ/iRg/0n3QGCFI=</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºAIæ™ºèƒ½ä½“ï¼šä¸ƒåå…«ã€å‚æ•°çš„è‰ºæœ¯ï¼šå¦‚ä½•åœ¨æœ‰é™ç®—åŠ›ä¸‹å®ç°é«˜è´¨é‡çš„AIè¯—æ­Œåˆ›ä½œ]]></title>    <link>https://juejin.cn/post/7592853243730886696</link>    <guid>https://juejin.cn/post/7592853243730886696</guid>    <pubDate>2026-01-09T00:06:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592853243730886696" data-draft-id="7592501225003810867" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºAIæ™ºèƒ½ä½“ï¼šä¸ƒåå…«ã€å‚æ•°çš„è‰ºæœ¯ï¼šå¦‚ä½•åœ¨æœ‰é™ç®—åŠ›ä¸‹å®ç°é«˜è´¨é‡çš„AIè¯—æ­Œåˆ›ä½œ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,Python"/> <meta itemprop="datePublished" content="2026-01-09T00:06:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å½¼å²¸èŠ±å¼€äº†å—"/> <meta itemprop="url" content="https://juejin.cn/user/4153315734334538"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºAIæ™ºèƒ½ä½“ï¼šä¸ƒåå…«ã€å‚æ•°çš„è‰ºæœ¯ï¼šå¦‚ä½•åœ¨æœ‰é™ç®—åŠ›ä¸‹å®ç°é«˜è´¨é‡çš„AIè¯—æ­Œåˆ›ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4153315734334538/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å½¼å²¸èŠ±å¼€äº†å—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T00:06:35.000Z" title="Fri Jan 09 2026 00:06:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>å›é¡¾æ˜¨æ—¥çš„è®­ç»ƒå†ç¨‹ï¼Œæˆ‘ä»¬ç»å†äº†ä¸€åœºä»æ··ä¹±åˆ°æœ‰åºçš„æŠ€æœ¯æ¢ç´¢ã€‚åˆå§‹é˜¶æ®µï¼Œæ¨¡å‹è¡¨ç°ä»¤äººå ªå¿§ï¼šç”Ÿæˆå†…å®¹ä¸¥é‡é‡å¤ã€æ ¼å¾‹æ··ä¹±ï¼ŒæŸå¤±å€¼é«˜è¾¾1.7467ï¼Œè¾“å‡ºçš„è¯—æ­Œå¦‚åŒç ´ç¢çš„é•œåƒï¼Œå……æ–¥ç€"é•¿æ¨æ­Œä¸­ç”¨äº†æ­¤"çš„æ— æ„ä¹‰é‡å¤ã€‚è¿™èƒŒååæ˜ çš„æ˜¯è®­ç»ƒä¸å……åˆ†ã€å‚æ•°é…ç½®å¤±è¡¡ç­‰æ·±å±‚é—®é¢˜ã€‚é¢å¯¹è¿™ä¸€å›°å¢ƒï¼Œæˆ‘ä»¬è¿›è¡Œäº†ç³»ç»Ÿçš„å‚æ•°é‡æ„â€”â€”å°†LoRAç§©ä»4æå‡è‡³16ä»¥å¢å¼ºè¡¨è¾¾èƒ½åŠ›ï¼Œå­¦ä¹ ç‡è°ƒæ•´ä¸º2e-4ç¡®ä¿ç¨³å®šæ”¶æ•›ï¼Œè®­ç»ƒè½®æ¬¡å»¶é•¿è‡³20ä¸ªepochä¿è¯å……åˆ†å­¦ä¹ ï¼ŒåŒæ—¶ä¼˜åŒ–äº†æç¤ºè¯æ ¼å¼å’Œç”Ÿæˆå‚æ•°ã€‚è¿™ä¸€ç³»åˆ—ç²¾å‡†è°ƒæ•´ï¼Œå¦‚åŒä¸ºæ¨¡å‹æ³¨å…¥äº†æ–°çš„ç”Ÿå‘½åŠ›ï¼Œä¸ºä»Šæ—¥çš„çªç ´æ€§æˆæœå¥ å®šäº†åšå®åŸºç¡€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/666117a4bd4045c199d34d58add25b2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768522026&amp;x-signature=I41mvpMJFwvAc61jcKB%2BPNKyGsQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€æ•°æ®é›†æ‰©å¤§</h2>
<pre><code class="hljs language-swift" lang="swift"> def create_training_data(<span class="hljs-keyword">self</span>):
        <span class="hljs-string">"""åˆ›å»ºé«˜è´¨é‡è®­ç»ƒæ•°æ®"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“š åˆ›å»ºè®­ç»ƒæ•°æ®..."</span>)
        
        training_data <span class="hljs-operator">=</span> []
    
        # <span class="hljs-operator">====================</span> å››å­£å˜æ¢ (<span class="hljs-number">40</span>é¦–) <span class="hljs-operator">====================</span>
        seasons_poems <span class="hljs-operator">=</span> [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œä¸€é¦–æå†™æ˜¥å¤©æ¡ƒèŠ±çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥æ¡ƒã€‹<span class="hljs-subst">\n</span>æ˜¥æ¥æ¡ƒææ»¡å›­å¼€ï¼Œç²‰ç™½ç›¸é—´æ˜ æ—¥æ¥ã€‚<span class="hljs-subst">\n</span>è¶èˆèœ‚å–§èŠ±ä¼¼æµ·ï¼Œé¦™é£é˜µé˜µå…¥è¥Ÿæ€€ã€‚<span class="hljs-subst">\n</span>æ¸¸äººç»œç»äº‰ç›¸èµï¼Œå¢¨å®¢æŒ¥æ¯«èµ‹é›…æ‰ã€‚<span class="hljs-subst">\n</span>è«é“èŠ³åå®¹æ˜“é€ï¼Œä¸”å°†æ˜¥è‰²ç”¨å¿ƒè£ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ä¸€é¦–å¤å¤©è·å¡˜çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤è·ã€‹<span class="hljs-subst">\n</span>ç‚ç‚å¤æ—¥è·å¡˜ç•”ï¼Œç¿ ç›–çº¢å¦†æ˜ æ—¥é²œã€‚<span class="hljs-subst">\n</span>ç‰ç«‹äº­äº­å°˜ä¸æŸ“ï¼Œæ¸…é¦™è¢…è¢…éŸµæ— è¾¹ã€‚<span class="hljs-subst">\n</span>èœ»èœ“ç‚¹æ°´æ³¢çº¹èµ·ï¼Œé”¦é²¤å¬‰æ¸¸æˆå¶é—´ã€‚<span class="hljs-subst">\n</span>æ„¿æ•ˆè²èŠ±é«˜æ´å¿—ï¼Œå†°å¿ƒä¸€ç‰‡å‘é’å¤©ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç§‹å¤©æ«å¶çš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç§‹æ«ã€‹<span class="hljs-subst">\n</span>ç§‹æ·±æ«å¶ä¼¼ç«çº¢ï¼Œæ¼«å±±éé‡æ˜ è‹ç©¹ã€‚<span class="hljs-subst">\n</span>éœœä¾µéœ²æŸ“è‰²æ„ˆè‰³ï¼Œé£æ‹‚ææ‘‡éŸµæ›´æµ“ã€‚<span class="hljs-subst">\n</span>æ¸¸äººé©»è¶³è§‚å¥‡æ™¯ï¼Œå¢¨å®¢æŒ¥æ¯«ç»˜å½©å®¹ã€‚<span class="hljs-subst">\n</span>è«é“ç§‹å…‰å¤šå¯‚å¯¥ï¼Œæ«æƒ…å¦‚ç«æš–èƒ¸ä¸­ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å†¬å¤©é›ªæ™¯çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå†¬é›ªã€‹<span class="hljs-subst">\n</span>å¯’å†¬å‡›å†½é›ªèŠ±é£ï¼Œä¸‡é‡Œå±±æ²³ç€ç´ è¡£ã€‚<span class="hljs-subst">\n</span>ç‰æ ‘ç¼ææ·»é›…è¶£ï¼Œé“¶è£…ç´ è£¹æ˜¾ç¥å¥‡ã€‚<span class="hljs-subst">\n</span>å„¿ç«¥å¬‰æˆå †é›ªå¶ï¼Œè€åŸå›´ç‚‰è¯æ—§æ—¶ã€‚<span class="hljs-subst">\n</span>è«é“å†¬æ¥æ— ç¾æ™¯ï¼Œå†°æ¸…ç‰æ´äº¦ç›¸å®œã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ—©æ˜¥æ—¶èŠ‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ—©æ˜¥ã€‹<span class="hljs-subst">\n</span>æ®‹é›ªæ¶ˆèæ˜¥æ„èŒï¼Œå¯’æ¢…åè‰³æŠ¥æ–°æ™´ã€‚<span class="hljs-subst">\n</span>ä¸œé£æš—åº¦åƒå±±ç»¿ï¼Œç»†é›¨æ‚„æ¶¦ä¸‡ç‰©ç”Ÿã€‚<span class="hljs-subst">\n</span>ç‡•å­åˆå½’å¯»æ—§å’ï¼Œå†œå¤«æ—©ä½œå¤‡æ˜¥è€•ã€‚<span class="hljs-subst">\n</span>ä¸€å¹´å¥½æ™¯ä»ä»Šå§‹ï¼Œè«è´Ÿå…‰é˜´å¥‹åŠ›è¡Œã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ç››å¤é›·é›¨çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤é›·ã€‹<span class="hljs-subst">\n</span>ç‚ç‚ç››å¤é—·å¦‚è’¸ï¼Œå¿½è§ä¹Œäº‘å‹å¤åŸã€‚<span class="hljs-subst">\n</span>ç”µé—ªé›·é¸£æƒŠå¤©åœ°ï¼Œé£ç‹‚é›¨éª¤æ´—å°˜æ¸…ã€‚<span class="hljs-subst">\n</span>è·å¡˜æ°´æ»¡è›™å£°é—¹ï¼Œç«¹å¾„é£å‡‰æš‘æ°”å¹³ã€‚<span class="hljs-subst">\n</span>é›¨è¿‡å¤©æ™´è™¹å½©ç°ï¼Œå±±æ²³ç„•ç„¶ä¸€æ–°æ˜ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ·±ç§‹æ—¶èŠ‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ·±ç§‹ã€‹<span class="hljs-subst">\n</span>éœœé™ç§‹æ·±å¯’æ„æµ“ï¼Œåƒå±±ä¸‡æœ¨å°½ä¸¹çº¢ã€‚<span class="hljs-subst">\n</span>èŠèŠ±å¼€éä¸œç¯±ä¸‹ï¼Œé›é˜µå—é£ç¢§ç©ºä¸­ã€‚<span class="hljs-subst">\n</span>ç¨»è°·ä¸°æ”¶ä»“å»ªå®ï¼Œæœé¦™å¼¥æ¼«æœå›­ä¸°ã€‚<span class="hljs-subst">\n</span>è«æ‚²ç§‹è€èŠ³åé€ï¼Œä¸”çœ‹æ«æƒ…èƒœæ˜¥å®¹ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ä¸¥å†¬æ™¯è±¡çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä¸¥å†¬ã€‹<span class="hljs-subst">\n</span>æ•°ä¹å¯’å¤©æœ”é£ç‹‚ï¼Œåƒå±±é¸Ÿç»ä¸‡å¾„è’ã€‚<span class="hljs-subst">\n</span>å†°å°æ²³æ¹–å¦‚æ˜é•œï¼Œé›ªè¦†å³°å³¦ä¼¼é“¶è£…ã€‚<span class="hljs-subst">\n</span>æ¾æŸå‚²éœœæ˜¾åŠ²èŠ‚ï¼Œæ¢…å…°æ–—é›ªæ•£å¹½é¦™ã€‚<span class="hljs-subst">\n</span>ä¸¥å†¬è™½é…·ç»ˆå°†å»ï¼Œé™å¾…æ˜¥å›å¤§åœ°èŠ³ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥æ—¥æ¸¸å›­çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥å›­ã€‹<span class="hljs-subst">\n</span>æ˜¥æ¥å›­å†…ç™¾èŠ±å¼€ï¼Œè¶èˆèœ‚å–§å„è‡ªå¿™ã€‚<span class="hljs-subst">\n</span>çº¢ææå¤´æ˜¥æ„é—¹ï¼Œç»¿æ¨é˜´é‡Œç¬‘å£°æ‰¬ã€‚<span class="hljs-subst">\n</span>æ¸¸äººå¦‚ç»‡è§‚å¥‡æ™¯ï¼Œå¢¨å®¢æŒ¥æ¯«èµ‹é›…ç« ã€‚<span class="hljs-subst">\n</span>è«è´Ÿæ˜¥å…‰æ— é™å¥½ï¼ŒåŠæ—¶è¡Œä¹äº«éŸ¶å…‰ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤æ—¥çº³å‡‰çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤å‡‰ã€‹<span class="hljs-subst">\n</span>ç‚ç‚å¤æ—¥è§…æ¸…å‡‰ï¼Œç«¹å½±å©†å¨‘é€çˆ½é£ã€‚<span class="hljs-subst">\n</span>çŸ³æ¶§æµæ³‰å£°ç»†ç»†ï¼Œæ¾æ¶›é€éŸµæ„èèã€‚<span class="hljs-subst">\n</span>æ£‹æ°å¯¹å¼ˆæ¶ˆé•¿æ˜¼ï¼Œè¯—é…’ç›¸å¨±ä¼´æ™šè™¹ã€‚<span class="hljs-subst">\n</span>å¿ƒé™è‡ªç„¶ç”Ÿå‡‰æ„ï¼Œä½•é¡»ç¾½æ‰‡ä¸å†°å®«ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç§‹æ—¥ç™»é«˜çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç§‹ç™»ã€‹<span class="hljs-subst">\n</span>ç§‹é«˜æ°”çˆ½ç™»ä¸´å¤„ï¼Œä¸‡é‡Œæ±Ÿå±±ä¸€æœ›æ”¶ã€‚<span class="hljs-subst">\n</span>äº‘æ·¡å¤©æ¸…é¸¿é›è¿‡ï¼Œæ«çº¢èŠè‰³æ¡‚é¦™æµ®ã€‚<span class="hljs-subst">\n</span>é¥æ€æ•…é‡Œæƒ…éš¾å·²ï¼Œç•…å’æ–°è¯—æ„æœªä¼‘ã€‚<span class="hljs-subst">\n</span>è«é“å¤•é˜³æ— é™å¥½ï¼Œæ¡‘æ¦†æœªæ™šäº¦é£æµã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å†¬æ—¥èµæ¢…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå†¬æ¢…ã€‹<span class="hljs-subst">\n</span>å¯’å†¬è¸é›ªè®¿æ¢…æ—ï¼Œç‰éª¨å†°è‚Œä¸æŸ“å°˜ã€‚<span class="hljs-subst">\n</span>ç–å½±æ¨ªæ–œå«é›…éŸµï¼Œæš—é¦™æµ®åŠ¨é€æ¸…èŠ¬ã€‚<span class="hljs-subst">\n</span>å­¤èŠ³è‡ªèµéæœ¬æ„ï¼Œç¾¤è‰³äº‰æ˜¥å²‚æ˜¯å¿ƒã€‚<span class="hljs-subst">\n</span>æ„¿æ•ˆå¯’æ¢…é“®é“®éª¨ï¼Œé£éœœæ„ˆçƒˆå¿—æ„ˆè´ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥æ±Ÿæ™¯è‰²çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥æ±Ÿã€‹<span class="hljs-subst">\n</span>æ˜¥æ±Ÿæ½®æ°´æ¥å¤©æµï¼Œæµ©è¡ä¸œå»åŠ¿æœªä¼‘ã€‚<span class="hljs-subst">\n</span>ä¸¤å²¸æ¡ƒèŠ±æ˜ æ—¥è‰³ï¼Œä¸€è¡Œç™½é¹­é€æ³¢æ¸¸ã€‚<span class="hljs-subst">\n</span>æ¸”èˆŸå”±æ™šå½’å¸†æ€¥ï¼Œç‰§ç¬›å‚¬æ˜è¿”æ£¹é’ã€‚<span class="hljs-subst">\n</span>æœ€æ˜¯ä¸€å¹´æ˜¥å¥½å¤„ï¼Œé£å…‰æ— é™é†‰äººçœ¸ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤å¤œæ˜Ÿç©ºçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤å¤œã€‹<span class="hljs-subst">\n</span>å¤å¤œæ˜Ÿç©ºç’€ç’¨æ˜ï¼Œé“¶æ²³æ³»åœ°æ´’æ¸…è¹ã€‚<span class="hljs-subst">\n</span>æµè¤ç‚¹ç‚¹ç©¿èŠ±è¿‡ï¼Œè›™é¼“å£°å£°ä¼´æœˆé¸£ã€‚<span class="hljs-subst">\n</span>ç«¹æ¤…è½»æ‘‡æ¶ˆæš‘çƒ­ï¼Œå†°èŒ¶æ…¢å“äº«é—²æƒ…ã€‚<span class="hljs-subst">\n</span>æ­¤é—´è‡ªæœ‰æ¸…å‡‰å¢ƒï¼Œä½•å¿…ç‘¶å°è§…ç‰äº¬ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç§‹é£é€çˆ½çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç§‹é£ã€‹<span class="hljs-subst">\n</span>é‡‘é£é€çˆ½å…¥çª—æ¥ï¼Œæš‘æ°”å…¨æ¶ˆå¿ƒæ‰‰å¼€ã€‚<span class="hljs-subst">\n</span>æ¢§å¶é£˜é»„é“ºé”¦æ¯¯ï¼Œæ¡‚èŠ±åè‰³æº¢é¦™åŸƒã€‚<span class="hljs-subst">\n</span>é•¿ç©ºé›é˜µä¹¦äººå­—ï¼Œæ—·é‡å†œæœºå“è‹¥é›·ã€‚<span class="hljs-subst">\n</span>åˆæ˜¯ä¸€å¹´ä¸°æ”¶å­£ï¼Œä»“æ»¡å»ªå®ä¹å¼€æ€€ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å†¬æ—¥æ™šæ™´çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå†¬æ™´ã€‹<span class="hljs-subst">\n</span>è¿é˜´æ•°æ—¥å¿½æ”¾æ™´ï¼Œä¸‡é‡Œæ— äº‘ç¢§ç©ºæ¸…ã€‚<span class="hljs-subst">\n</span>ç§¯é›ªæ¶ˆèéœ²é»‘åœŸï¼Œå¯’å†°ç ´è£‚ç°æ³¢æ˜ã€‚<span class="hljs-subst">\n</span>è€ç¿è´Ÿæ—¥å¢™æ ¹åï¼Œç¨šå­æºœå†°æ¹–é¢è¡Œã€‚<span class="hljs-subst">\n</span>è«é“å†¬æ·±æ— ä¹è¶£ï¼Œæ™šæ™´äº¦å¯æ‚¦å¿ƒæƒ…ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥é›¨ç»µç»µçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥é›¨ã€‹<span class="hljs-subst">\n</span>æ˜¥é›¨å¦‚é…¥æ¶¦ç‰©ç”Ÿï¼Œç»µç»µå¯†å¯†ç»†æ— å£°ã€‚<span class="hljs-subst">\n</span>æ¡ƒè…®å«éœ²å¨‡æ¬²æ»´ï¼ŒæŸ³çœ¼åˆå¼€åªšè‡ªç”Ÿã€‚<span class="hljs-subst">\n</span>è“‘è¡£æ¸”çˆ¶å‚çº¶ä¹ï¼Œæ²¹ä¼ä¹¦ç”Ÿè§…å¥è¡Œã€‚<span class="hljs-subst">\n</span>æœ€å–œä¸°å¹´æ˜¥é›¨è¶³ï¼Œç§‹æ¥å®šæœ‰å¥½æ”¶æˆã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤æ—¥è‰é¸£çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤è‰ã€‹<span class="hljs-subst">\n</span>ç»¿é˜´æ·±å¤„å“è‰é¸£ï¼Œé«˜äº¢æ¿€æ˜‚è¯‰è¡·æƒ…ã€‚<span class="hljs-subst">\n</span>é¥®éœ²é¤é£æ ‡äº®èŠ‚ï¼Œæ –é«˜é¸£è¿œæ˜¾æ¸…å£°ã€‚<span class="hljs-subst">\n</span>ä¸éšç‡•é›€äº‰ç²’ç±³ï¼Œæ•¢å‘é²²é¹è®ºè·¯ç¨‹ã€‚<span class="hljs-subst">\n</span>è«é“å¾®è™«æ— å¤§å¿—ï¼Œé•¿æ­Œä¸€æ›²ä¹ŸæƒŠå¤©ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç§‹æœˆå¦‚é’©çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç§‹æœˆã€‹<span class="hljs-subst">\n</span>ç§‹å¤œå¤©é«˜æœˆä¼¼é’©ï¼Œæ¸…è¾‰å¦‚æ°´æ´’ä¹å·ã€‚<span class="hljs-subst">\n</span>æ¡‚é¦™æš—åº¦æ²å¿ƒè„¾ï¼Œç«¹å½±è½»æ‘‡åŠ¨å®¢æ„ã€‚<span class="hljs-subst">\n</span>æ¸¸å­æ€ä¹¡æƒ…åˆ‡åˆ‡ï¼Œä½³äººæœ›æœˆæ„æ‚ æ‚ ã€‚<span class="hljs-subst">\n</span>æ„¿å›è«ä½œå¤©æ¶¯å®¢ï¼Œå¸¸ä¼´äº²å¸äº«æ¸©æŸ”ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å†¬é›ªåˆéœçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé›ªéœã€‹<span class="hljs-subst">\n</span>å¤œé›ªåˆæ™´ä¸‡è±¡æ–°ï¼Œé“¶è£…ç´ è£¹å‡€æ— å°˜ã€‚<span class="hljs-subst">\n</span>å†°æ£±æŒ‚æªæ™¶è¹é€ï¼Œç‰å±‘é“ºåº­çšæ´çº¯ã€‚<span class="hljs-subst">\n</span>ç¨šå­å †äººç›¸æˆè€ï¼Œè€ç¿æ‰«å¾„è‡ªé€¡å·¡ã€‚<span class="hljs-subst">\n</span>çº¢æ¢…æ•°ç‚¹é›ªä¸­è‰³ï¼Œé¢„æŠ¥æ˜¥å›å¤§åœ°æ–°ã€‚"</span>
            }
        ]
        # å†è¡¥å……<span class="hljs-number">20</span>é¦–å››å­£ä¸»é¢˜è¯—
        additional_seasons <span class="hljs-operator">=</span> [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥è€•æ—¶èŠ‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥è€•ã€‹<span class="hljs-subst">\n</span>æ˜¥å›å¤§åœ°æš–é£å‚¬ï¼Œå¸ƒè°·å£°å£°ä¿ƒè€•æ¥ã€‚<span class="hljs-subst">\n</span>é“ç‰›è½°é¸£ç¿»æ²ƒåœŸï¼Œé“¶é”„èµ·è½ç§å¸Œæœ›ã€‚<span class="hljs-subst">\n</span>å†œå¤«æ±—æ´’ç”°å›­é‡Œï¼Œç‡•å­æ³¥è¡”æ¢æ ‹æã€‚<span class="hljs-subst">\n</span>ä½†å¾—ç§‹æ¥ä¸°ç¡•æœï¼Œåƒè¾›ä¸‡è‹¦ä¹Ÿå¼€æ€€ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤æ—¥é‡‡è²çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé‡‡è²ã€‹<span class="hljs-subst">\n</span>å¤æ—¥è·å¡˜ç¿ è‰²è¿ï¼Œé‡‡è²å¥³å­ç¬‘å¼€é¢œã€‚<span class="hljs-subst">\n</span>è½»èˆŸè¡ç ´ç‰ç’ƒé•œï¼Œç‰æ‰‹æ‘˜æ¥ç›ç‘™ç›˜ã€‚<span class="hljs-subst">\n</span>æ­Œå½»äº‘éœ„æƒŠç™½é¹­ï¼Œç¬‘ç›ˆæ°´é¢åŠ¨çº¢è•–ã€‚<span class="hljs-subst">\n</span>å½’æ¥æ»¡è½½æ–œé˜³é‡Œï¼Œä¸€è·¯æ¸…é¦™ä¼´æœˆè¿˜ã€‚"</span>
            },
            # <span class="hljs-operator">...</span> æ›´å¤šå››å­£è¯—ï¼ˆå…±<span class="hljs-number">40</span>é¦–ï¼‰
        ]
        training_data.extend(seasons_poems)
        training_data.extend(additional_seasons)
        
        # <span class="hljs-operator">====================</span> å±±æ°´ç”°å›­ (<span class="hljs-number">30</span>é¦–) <span class="hljs-operator">====================</span>
        landscape_poems <span class="hljs-operator">=</span> [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå±±æ°´é£å…‰çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå±±æ°´åŸã€‹<span class="hljs-subst">\n</span>é’å±±å ç¿ æ¥äº‘éœï¼Œç¢§æ°´èœ¿èœ’ç»•æ¶§æ¶¯ã€‚<span class="hljs-subst">\n</span>é£ç€‘æ‚¬ç©ºå¦‚ç™½ç»ƒï¼Œå¥‡å³°è€¸ç«‹ä¼¼ä»™å®¶ã€‚<span class="hljs-subst">\n</span>æ¾æ¶›é˜µé˜µä¼ å¹½éŸµï¼Œé¸Ÿè¯­å£°å£°é€é›¾çº±ã€‚<span class="hljs-subst">\n</span>æ„¿æ•ˆé™¶å…¬å½’éšå»ï¼Œç»“åºä»™å¢ƒåº¦å¹´åã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æ±Ÿå—æ°´ä¹¡çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ±Ÿå—æ˜¥ã€‹<span class="hljs-subst">\n</span>æ±Ÿå—æ˜¥è‰²ç¾å¦‚ç”»ï¼Œç»¿æ°´é’å±±æ˜ å½©éœã€‚<span class="hljs-subst">\n</span>å°æ¡¥æµæ°´äººå®¶é™ï¼Œç»†é›¨æ‰èˆŸæ¸”çˆ¶å“—ã€‚<span class="hljs-subst">\n</span>æ¡ƒçº¢æŸ³ç»¿èºå•¼åºï¼Œæœˆç™½é£æ¸…ç¬›å¥ç¬³ã€‚<span class="hljs-subst">\n</span>è‹¥é—®äººé—´ä½•å¤„å¥½ï¼Œæ°´ä¹¡ä»™å¢ƒæœ€å ªå¤¸ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå¤§æ¼ é£å…‰çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤§æ¼ è¡Œã€‹<span class="hljs-subst">\n</span>å¤§æ¼ èŒ«èŒ«æ¥è¿œå¤©ï¼Œé»„æ²™æ»šæ»šæ¼«æ— è¾¹ã€‚<span class="hljs-subst">\n</span>å­¤çƒŸç›´ä¸Šäº‘éœ„å¤–ï¼Œè½æ—¥æµ‘åœ†åœ°å¹³çº¿ã€‚<span class="hljs-subst">\n</span>é©¼é“ƒå£°å“ä¼ å¹½éŸµï¼Œé¹°éš¼ç›˜æ—‹è§…é‡é²œã€‚<span class="hljs-subst">\n</span>å£®å£«è¥¿è¡Œåƒä¸‡é‡Œï¼Œè±ªæƒ…å£®å¿—æ»¡èƒ¸é—´ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ç”°å›­ç”Ÿæ´»çš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç”°å›­ä¹ã€‹<span class="hljs-subst">\n</span>ç»“åºäººå¢ƒè¿œå°˜åš£ï¼Œè€•è¯»ä¼ å®¶ä¹é€é¥ã€‚<span class="hljs-subst">\n</span>æ™¨èµ·è·é”„ç†è’ç§½ï¼Œæš®å½’æŠŠé…’è¯æ¸”æ¨µã€‚<span class="hljs-subst">\n</span>é—¨å‰äº”æŸ³éšé£èˆï¼Œå±‹åä¸‰ç•¦è”¬èœå¨‡ã€‚<span class="hljs-subst">\n</span>è«é“å±±å±…å¤šå¯‚å¯ï¼Œæ¸…æ¬¢è‡ªåœ¨èƒœç‹ä¾¯ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ±Ÿæ²³æ™¯è‰²çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé•¿æ±ŸåŸã€‹<span class="hljs-subst">\n</span>é•¿æ±Ÿæ»šæ»šå‘ä¸œæµï¼Œä¸‡é‡Œå¥”è…¾åŠ¿æœªä¼‘ã€‚<span class="hljs-subst">\n</span>æµªå·åƒå †å¦‚é›ªæ¶Œï¼Œæ¶›å£°é˜µé˜µä¼¼é›·è®´ã€‚<span class="hljs-subst">\n</span>äº‘æ¨ªä¹æ´¾æµ®é»„é¹¤ï¼Œé›¾é”ä¸‰å´ç°ç™½é¸¥ã€‚<span class="hljs-subst">\n</span>è‡ªå¤è‹±è±ªäº‰æ¸¡å¤„ï¼Œä»Šæœæ›´æ˜¾é£æµç¨ ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å±±æ—å¹½å±…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå±±å±…ã€‹<span class="hljs-subst">\n</span>æ·±å±±ç»“åºè¿œä¿—å°˜ï¼Œæœå¬é¸Ÿè¯­æš®è§‚äº‘ã€‚<span class="hljs-subst">\n</span>çŸ³æ³‰ç…®èŒ—é¦™ç›ˆå®¤ï¼Œæ¾ç«çƒ¹è‚´å‘³è¯±äººã€‚<span class="hljs-subst">\n</span>é—²æ¥å¯¹å¼ˆæ¶ˆæ°¸æ˜¼ï¼Œå…´è‡³åŸè¯—ä¼´æœˆè½®ã€‚<span class="hljs-subst">\n</span>è«é—®äººé—´ååˆ©äº‹ï¼Œæ­¤ä¸­çœŸè¶£èƒœåƒé‡‘ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç€‘å¸ƒå¥‡è§‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šè§‚ç€‘ã€‹<span class="hljs-subst">\n</span>å±å´–ä¸‡ä¸ˆæŒ‚é“¶ç»¡ï¼Œé£ç€‘è½°é¸£éœ‡ä¹éœ„ã€‚<span class="hljs-subst">\n</span>ç‰é¾™å€’æŒ‚æ‚¬ç©ºè½ï¼Œç å¸˜é«˜å‚æ¥åœ°æ‘‡ã€‚<span class="hljs-subst">\n</span>æ°´èŠ±æº…å¤„å½©è™¹ç°ï¼Œé›¾æ°”è…¾æ—¶æš‘æ°”æ¶ˆã€‚<span class="hljs-subst">\n</span>é€ åŒ–ç¥å·¥çœŸç»å¦™ï¼Œä»¤äººè§‚æ­¢èµå£°é«˜ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å±±æ‘æ™šæ™¯çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå±±æ‘ã€‹<span class="hljs-subst">\n</span>å±±æ‘å‘æ™šæ™¯å°¤ä½³ï¼Œç¼•ç¼•ç‚ŠçƒŸä¸Šç¢§éœã€‚<span class="hljs-subst">\n</span>ç‰§ç¬›å£°ä¸­å½’çŠŠæ€¥ï¼Œæ¸”æ­Œèµ·å¤„è½å¸†æ–œã€‚<span class="hljs-subst">\n</span>è€ç¿å€šæ–å€™é—¨ç«‹ï¼Œç¨šå­ç‰µè¡£å”¤çˆ¶å“—ã€‚<span class="hljs-subst">\n</span>æœ€æ˜¯äººé—´çƒŸç«æ°”ï¼Œæ¸©é¦¨å’Œç¾èƒœä»™å®¶ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ¹–å…‰å±±è‰²çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ¹–å±±ã€‹<span class="hljs-subst">\n</span>æ¹–å…‰å±±è‰²ä¸¤ç›¸å’Œï¼Œé•œé¢å¹³é“ºç¿ é»›ç½—ã€‚<span class="hljs-subst">\n</span>ç™½é¹­ç¿”é›†æ²™æ¸šé™ï¼Œçº¢è•–æ‘‡åŠ¨ç¢§æ³¢é…¡ã€‚<span class="hljs-subst">\n</span>æ‰èˆŸä¸€å¶äº‘é—´è¡ï¼Œæ¸”å”±æ•°å£°å¤©é™…è¿‡ã€‚<span class="hljs-subst">\n</span>è‹¥å¾—æ­¤é—´é•¿ä½è¶³ï¼Œä¸æ…•ç‹ä¾¯ä¸ç¾¡ä½›ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æºªæµæ¸…éŸ³çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€ŠæºªéŸ³ã€‹<span class="hljs-subst">\n</span>å±±æºªæ¸…æ¾ˆçŸ³é—´æµï¼Œç®ç®é“®é“®ä¼¼ä¹å¥ã€‚<span class="hljs-subst">\n</span>è·³ç æº…ç‰å½¢å¤šå˜ï¼Œç»•å£‘ç©¿å²©åŠ¿æœªä¼‘ã€‚<span class="hljs-subst">\n</span>æ´—è€³å¯æ¶ˆå°˜ä¿—è™‘ï¼Œé™å¿ƒèƒ½è§£å¤ä»Šæ„ã€‚<span class="hljs-subst">\n</span>æ„¿ä½œæºªä¸­ä¸€åµçŸ³ï¼Œé•¿å¬å¤©ç±è‡ªæ‚ æ‚ ã€‚"</span>
            },
            # <span class="hljs-operator">...</span> æ›´å¤šå±±æ°´ç”°å›­è¯—ï¼ˆå…±<span class="hljs-number">30</span>é¦–ï¼‰
        ]
        training_data.extend(landscape_poems)
        
        # <span class="hljs-operator">====================</span> æŠ’æƒ…è¨€å¿— (<span class="hljs-number">35</span>é¦–) <span class="hljs-operator">====================</span>
        emotional_poems <span class="hljs-operator">=</span> [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ€ä¹¡ä¹‹æƒ…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä¹¡æ„ã€‹<span class="hljs-subst">\n</span>ç‹¬åœ¨å¼‚ä¹¡ä¸ºå¼‚å®¢ï¼Œæ¯é€¢ä½³èŠ‚æ›´æ€äº²ã€‚<span class="hljs-subst">\n</span>ä¸¾å¤´æœ›æœˆå®¶ä¹¡è¿œï¼Œä½å¤´æ€äº²æ³ªæ»¡å·¾ã€‚<span class="hljs-subst">\n</span>å±±æ°´è¿¢è¿¢å½’è·¯é˜»ï¼ŒéŸ³ä¹¦æ¸ºæ¸ºæ¢¦é­‚é¢‘ã€‚<span class="hljs-subst">\n</span>æ„¿ç”ŸåŒç¿¼ä¹˜é£å»ï¼Œä¸€å¤œé£å›æ•…é‡Œæ˜¥ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å‹æƒ…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€ŠçŸ¥éŸ³ã€‹<span class="hljs-subst">\n</span>äººç”Ÿéš¾å¾—ä¸€çŸ¥éŸ³ï¼Œæµæ°´é«˜å±±æƒ…æ„æ·±ã€‚<span class="hljs-subst">\n</span>ä¿ƒè†é•¿è°ˆå¿˜å¤œæ°¸ï¼Œæ¨å¿ƒç½®è…¹èƒœåƒé‡‘ã€‚<span class="hljs-subst">\n</span>å±éš¾æ—¶åˆ»ä¼¸æ´æ‰‹ï¼Œæ¬¢ä¹æ—¶å…‰å…±é†‰åŸã€‚<span class="hljs-subst">\n</span>æ„¿æ•ˆç®¡é²çœŸæƒ…è°Šï¼Œé’å²ç•™åä¼ åˆ°ä»Šã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œçˆ±æƒ…ä¸»é¢˜çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç›¸æ€ã€‹<span class="hljs-subst">\n</span>çº¢è±†ç”Ÿå—å›½ï¼Œæ˜¥æ¥å‘å‡ æã€‚<span class="hljs-subst">\n</span>æ„¿å›å¤šé‡‡æ’·ï¼Œæ­¤ç‰©æœ€ç›¸æ€ã€‚<span class="hljs-subst">\n</span>æœˆä¸‹ç‹¬å¾˜å¾Šï¼Œé£ä¸­ç©ºå¹å’¨ã€‚<span class="hljs-subst">\n</span>ä½³æœŸä½•æ—¥è‡³ï¼Œæºæ‰‹å…±ç‘¶æ± ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™äººç”Ÿæ„Ÿæ…¨çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šäººç”Ÿæ„Ÿæ€€ã€‹<span class="hljs-subst">\n</span>äººç”Ÿå¦‚å¯„å‡ å¤šç§‹ï¼Œå²æœˆåŒ†åŒ†ä¼¼æ°´æµã€‚<span class="hljs-subst">\n</span>å°‘å£®ä¸çŸ¥å‹¤å­¦æ—©ï¼Œè€æ¥æ–¹æ‚”è¯»ä¹¦ä¼‘ã€‚<span class="hljs-subst">\n</span>åŠŸååˆ©ç¦„æµ®äº‘è¿‡ï¼Œé“å¾·æ–‡ç« åƒå¤ç•™ã€‚<span class="hljs-subst">\n</span>çæƒœå…‰é˜´è«è™šåº¦ï¼Œå¥‹å‘å‘ä¸Šæ°¸æ— ä¼‘ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œåŠ±å¿—çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€ŠåŠ±å¿—ã€‹<span class="hljs-subst">\n</span>å°‘å¹´ç«‹å¿—åœ¨å››æ–¹ï¼Œä¸ç•è‰°éš¾ä¸é›ªéœœã€‚<span class="hljs-subst">\n</span>é“æµç£¨é’ˆç»ˆæœ‰æ—¥ï¼Œç²¾è¯šæ‰€è‡³çŸ³å¼€å¼ ã€‚<span class="hljs-subst">\n</span>ä¹˜é£ç ´æµªæµæ²§æµ·ï¼Œå±•ç¿…é«˜é£è¶Šå…«è’ã€‚<span class="hljs-subst">\n</span>ä»–æ—¥åŠŸæˆåå°±æ—¶ï¼Œä¸ºæ°‘é€ ç¦æ˜¾è£å…‰ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æ€€æ‰ä¸é‡çš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ€€æ‰ã€‹<span class="hljs-subst">\n</span>æ‰é«˜å…«æ–—å¿—å‡Œäº‘ï¼Œå´å›°èŒ…åºæœªé‡å›ã€‚<span class="hljs-subst">\n</span>å®å‰‘å°˜å°å…‰æ¸æš—ï¼Œè‰¯é©¹å›°å©åŠ›éš¾ä¼¸ã€‚<span class="hljs-subst">\n</span>ä½†å°†å­¦è¯†ä¼ åä¸–ï¼Œä¸”æŠŠè¯—æ–‡ç¤ºä¼—äººã€‚<span class="hljs-subst">\n</span>ä»–æ—¥é£é›·å¦‚é™…ä¼šï¼Œå®šå½“å±•ç¿…ä¸Šé’äº‘ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæŠ¥å›½æƒ…æ€€çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€ŠæŠ¥å›½ã€‹<span class="hljs-subst">\n</span>ç”·å„¿ç”Ÿå½“å¸¦å´é’©ï¼Œæ”¶å–å…³å±±äº”åå·ã€‚<span class="hljs-subst">\n</span>è¯·å›æš‚ä¸Šå‡ŒçƒŸé˜ï¼Œè‹¥ä¸ªä¹¦ç”Ÿä¸‡æˆ·ä¾¯ï¼Ÿ<span class="hljs-subst">\n</span>é“é©¬å†°æ²³å…¥æ¢¦æ¥ï¼Œé‡‘æˆˆé“é©¬æ°”åç‰›ã€‚<span class="hljs-subst">\n</span>ä½†å¾—å››æµ·å‡å¹³æ—¥ï¼Œè§£ç”²å½’ç”°äº¦é£æµã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å½’éšä¹‹å¿—çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå½’éšã€‹<span class="hljs-subst">\n</span>å®¦æµ·æµ®æ²‰æ•°åç§‹ï¼Œä»Šæœå½’éšä¹æ‚ æ‚ ã€‚<span class="hljs-subst">\n</span>ç§èŠä¸œç¯±æ•ˆå…ƒäº®ï¼Œè§‚é±¼æ¿ æ°´å­¦å­ä¼‘ã€‚<span class="hljs-subst">\n</span>é—²æ¥å‚é’“ç¢§æºªä¸Šï¼Œå…´è‡³æ¼«æ¸¸ç¿ å²­å¤´ã€‚<span class="hljs-subst">\n</span>ä¸æ…•äººé—´ååˆ©äº‹ï¼Œä½†æ±‚å¿ƒé™è‡ªæ— æ„ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç¦»åˆ«ä¹‹æƒ…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç¦»åˆ«ã€‹<span class="hljs-subst">\n</span>é•¿äº­é€åˆ«æ³ªæ¶Ÿæ¶Ÿï¼Œæ‰§æ‰‹ç›¸çœ‹æ— è¯­å’½ã€‚<span class="hljs-subst">\n</span>æ¨æŸ³ä¾ä¾éš¾ç³»é©¬ï¼Œæµæ°´æ½ºæ½ºæ˜“å‚¬èˆ¹ã€‚<span class="hljs-subst">\n</span>äº‘å±±æ¸ºæ¸ºéŸ³ä¹¦æ–­ï¼Œé›¾è·¯è¿¢è¿¢æ¢¦é­‚ç‰µã€‚<span class="hljs-subst">\n</span>æ„¿å›æ­¤å»å¤šçé‡ï¼Œæ—©å¯„ä½³éŸ³æ…°å¦¾çœ ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™é‡é€¢ä¹‹å–œçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé‡é€¢ã€‹<span class="hljs-subst">\n</span>åˆ«åç»å¹´å–œé‡é€¢ï¼Œæ‰§æ‰‹ç›¸çœ‹æ³ªçœ¼æœ¦ã€‚<span class="hljs-subst">\n</span>å®¹é¢œè™½æ”¹æƒ…å¦‚æ—§ï¼Œä¸–äº‹è™½è¿æ„æ›´æµ“ã€‚<span class="hljs-subst">\n</span>ç•…è°ˆå¾€æ˜”æ— ç©·è¶£ï¼Œå±•æœ›æœªæ¥ä¸å°½è£ã€‚<span class="hljs-subst">\n</span>ä»ä»Šæ„¿ä½œé•¿ç›¸èšï¼Œè«å†åˆ†ç¦»å„è¥¿ä¸œã€‚"</span>
            },
            # <span class="hljs-operator">...</span> æ›´å¤šæŠ’æƒ…è¨€å¿—è¯—ï¼ˆå…±<span class="hljs-number">35</span>é¦–ï¼‰
        ]
        training_data.extend(emotional_poems)
        
        # <span class="hljs-operator">====================</span> è¾¹å¡é£äº‘ (<span class="hljs-number">25</span>é¦–) <span class="hljs-operator">====================</span>
        frontier_poems <span class="hljs-operator">=</span> [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œè¾¹å¡é£å…‰çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¡ä¸Šæ›²ã€‹<span class="hljs-subst">\n</span>å¤§æ¼ å­¤çƒŸè½æ—¥åœ†ï¼Œè¾¹å…³çƒ½ç«ç…§ç‹¼çƒŸã€‚<span class="hljs-subst">\n</span>èƒ¡ç¬³å£°é‡Œæ€ä¹¡åˆ‡ï¼Œæˆ˜é¼“å£°ä¸­æ–—å¿—åšã€‚<span class="hljs-subst">\n</span>é“è¡£å†·æ˜ å¯’æœˆå…‰ï¼Œé‡‘æˆˆæ¨ªæ‰«æ•Œå†›å‰ã€‚<span class="hljs-subst">\n</span>ä½†æ±‚å››æµ·å‡å¹³æ—¥ï¼Œè§£ç”²å½’ç”°ç§éº¦æ£‰ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å°†å£«è±ªæƒ…çš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä»å†›è¡Œã€‹<span class="hljs-subst">\n</span>å°‘å¹´æŠ•ç¬”èµ´è¾¹ç–†ï¼Œèª“ä¿å®¶å›½å«åœŸç–†ã€‚<span class="hljs-subst">\n</span>é“é©¬é‡‘æˆˆå¯’æ•Œèƒ†ï¼Œå¿ å¿ƒèµ¤èƒ†è€€æ—¥å…‰ã€‚<span class="hljs-subst">\n</span>é»„æ²™ç™¾æˆ˜ç©¿é‡‘ç”²ï¼Œä¸ç ´æ•Œè¥ä¸è¿”ä¹¡ã€‚<span class="hljs-subst">\n</span>ä»–æ—¥åŠŸæˆå¥å‡¯æ—¥ï¼Œé”¦è¡£è¿˜ä¹¡æ‹œé«˜å ‚ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæˆ˜äº‰åæ€çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæˆ˜åŸå—ã€‹<span class="hljs-subst">\n</span>æˆ˜é¼“å£°å£°éœ‡ä¹å¤©ï¼Œä¸¤å†›å¯¹å’å®æ€è¿ã€‚<span class="hljs-subst">\n</span>åˆ€å…‰å‰‘å½±è¡€æˆæ²³ï¼Œé©¬é©è£¹å°¸è°è§æ€œï¼Ÿ<span class="hljs-subst">\n</span>ä¸€å°†åŠŸæˆæ¯ä¸‡éª¨ï¼Œå‡ å®¶å“­å£°å“é‡ç”°ã€‚<span class="hljs-subst">\n</span>æ„¿é”€å…µç”²ä¸ºå†œå™¨ï¼Œå››æµ·å‡å¹³å¤§æœ‰å¹´ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æˆè¾¹æ€ä¹¡çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæˆè¾¹ã€‹<span class="hljs-subst">\n</span>æˆè¾¹å°†å£«å®ˆå…³å±±ï¼Œæœˆå¤œæ€ä¹¡æ³ªæš—æ½¸ã€‚<span class="hljs-subst">\n</span>å®¶ä¹¦ä¸‡é‡‘éš¾å¾—åˆ°ï¼Œæ¢¦é­‚åƒé‡Œæ˜“å½’è¿˜ã€‚<span class="hljs-subst">\n</span>ä½†æ±‚å››æµ·çƒ½çƒŸé–ï¼Œæ„¿å¼ƒå¹²æˆˆæ•…é‡Œè¿˜ã€‚<span class="hljs-subst">\n</span>å¾…åˆ°å¤ªå¹³æ— äº‹æ—¥ï¼Œå¤«å¦»å›¢èšäº«æ¸…é—²ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå‡¯æ—‹å½’æ¥çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå‡¯æ—‹ã€‹<span class="hljs-subst">\n</span>ä¸‰å†›å¥å‡¯è¿”å¸äº¬ï¼Œç™¾å§“ç®ªé£Ÿå¤¹é“è¿ã€‚<span class="hljs-subst">\n</span>æˆ˜æ——çŒçŒè¿é£å±•ï¼Œå·è§’å£°å£°å‘å¤©é¸£ã€‚<span class="hljs-subst">\n</span>å°†å†›é©¬ä¸Šè‹±å§¿çˆ½ï¼Œå£«å’è¡Œåˆ—æ°”åŠ¿å®ã€‚<span class="hljs-subst">\n</span>ä½†å¾—è¾¹ç–†æ°¸å®é™ï¼Œä½•é¡»ä¸‡é‡Œå†å‡ºå¾ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤œå·¡è¾¹å…³çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤œå·¡ã€‹<span class="hljs-subst">\n</span>è¾¹å…³æœˆå†·æœ”é£ç‹‚ï¼Œå°†å£«å·¡é€»å¤œæœªå¤®ã€‚<span class="hljs-subst">\n</span>åˆæ–—å£°ä¼ å¯’å¡è¿œï¼Œæ—Œæ——å½±åŠ¨æˆæ¥¼é•¿ã€‚<span class="hljs-subst">\n</span>çœ¼è§‚å…­è·¯é˜²æ•Œå¯‡ï¼Œè€³å¬å…«æ–¹å¤‡çªè¢­ã€‚<span class="hljs-subst">\n</span>ä¸ºå›½å®ˆç–†æ— æ€¨æ‚”ï¼Œä¸¹å¿ƒä¸€ç‰‡ç…§å¤©ç½¡ã€‚"</span>
            },
            # <span class="hljs-operator">...</span> æ›´å¤šè¾¹å¡è¯—ï¼ˆå…±<span class="hljs-number">25</span>é¦–ï¼‰
        ]
        training_data.extend(frontier_poems)
        
        # <span class="hljs-operator">====================</span> å’ç‰©å¯„æƒ… (<span class="hljs-number">30</span>é¦–) <span class="hljs-operator">====================</span>
        object_poems <span class="hljs-operator">=</span> [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå’æ¢…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’æ¢…ã€‹<span class="hljs-subst">\n</span>å†°è‚Œç‰éª¨å‚²éœœå¼€ï¼Œç–å½±æ¨ªæ–œæ˜ æœˆæ¥ã€‚<span class="hljs-subst">\n</span>ä¸ä¸ç¾¤èŠ³äº‰è‰³ä¸½ï¼Œç‹¬å‡Œå¯’é›ªæŠ¥æ˜¥å›ã€‚<span class="hljs-subst">\n</span>æ¸…é¦™æš—åº¦æ²å¿ƒè„¾ï¼Œç´ é›…é«˜æ´è¿œä¿—åŸƒã€‚<span class="hljs-subst">\n</span>æ„¿æ•ˆæ¢…èŠ±åšè´å¿—ï¼Œé€†å¢ƒä¹‹ä¸­æ˜¾è‹±æ‰ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å’ç«¹çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’ç«¹ã€‹<span class="hljs-subst">\n</span>ç ´åœŸå‡Œäº‘èŠ‚èŠ‚é«˜ï¼Œè™šå¿ƒåŠ²èŠ‚æ°”é›„è±ªã€‚<span class="hljs-subst">\n</span>é£éœœé›¨é›ªæµ‘ä¸æ€•ï¼Œæ˜¥å¤ç§‹å†¬è‰²ä¸å‡‹ã€‚<span class="hljs-subst">\n</span>éƒ‘ç‡®ç”»ä¸­ç•™åŠ²éª¨ï¼Œä¸ƒè´¤æ—ä¸‹æ˜¾é£éªšã€‚<span class="hljs-subst">\n</span>æ„¿å­¦ç¿ ç«¹åšè´å¿—ï¼Œç›´ä¸Šé’äº‘ä¸æŠ˜è…°ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå’æœˆçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’æœˆã€‹<span class="hljs-subst">\n</span>çšçšç©ºä¸­å­¤æœˆè½®ï¼Œæ¸…è¾‰éæ´’å‡€æ— å°˜ã€‚<span class="hljs-subst">\n</span>é˜´æ™´åœ†ç¼ºå¾ªå¤©é“ï¼Œç¦»åˆæ‚²æ¬¢å–»ä¸–äººã€‚<span class="hljs-subst">\n</span>æç™½ä¸¾æ¯æˆå¦™å¥ï¼Œä¸œå¡æŠŠé…’é—®å‰å› ã€‚<span class="hljs-subst">\n</span>æ„¿å›å¸¸ä¼¼ä¸­ç§‹æœˆï¼Œåœ†æ»¡å…‰æ˜ç…§å››é‚»ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å’é…’çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’é…’ã€‹<span class="hljs-subst">\n</span>ç¼æµ†ç‰æ¶²å‡ºç³ŸåºŠï¼Œç¥ç€æµå…‰æ»¡å®¤é¦™ã€‚<span class="hljs-subst">\n</span>æç™½ç™¾ç¯‡ç¼˜é†‰å¾—ï¼Œé™¶æ½œä¸‰å¾„å€Ÿé†ªè—ã€‚<span class="hljs-subst">\n</span>å–œæ—¶åŠ©å…´æ¬¢æƒ…ç•…ï¼Œæ„å¤„æ¶ˆå¿§å—å’å¿˜ã€‚<span class="hljs-subst">\n</span>ä½†å¾—äººç”Ÿå¸¸å°½æ¬¢ï¼Œè«æ•™é‡‘æ¨½ç©ºå¯¹æœˆã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå’æ¾çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’æ¾ã€‹<span class="hljs-subst">\n</span>å³­å£æ‚¬å´–ä¸€è€æ¾ï¼Œé£éœœé›¨é›ªä»ä»å®¹ã€‚<span class="hljs-subst">\n</span>æ ¹æ·±ä¸æ€•ç‹‚é£åŠ¨ï¼Œå¹²æ­£ä½•å¿§æš´é›¨å†²ã€‚<span class="hljs-subst">\n</span>å››å­£å¸¸é’æ˜¾åŠ²èŠ‚ï¼Œåƒå¹´ä¸æœ½è§è´å¿ ã€‚<span class="hljs-subst">\n</span>æ„¿å­¦é’æ¾åšæ¯…å¿—ï¼Œè‰°éš¾å›°è‹¦äº¦è±ªé›„ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å’èŠçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’èŠã€‹<span class="hljs-subst">\n</span>ç§‹æ·±ç™¾å‰å°½å‡‹æ®‹ï¼Œå”¯æœ‰èŠèŠ±å‚²éœœå¯’ã€‚<span class="hljs-subst">\n</span>é‡‘ç”²æ»¡æŠ«é¦™ç›Šè¿œï¼Œç‰è‚Œå¾®éœ²è‰²å°¤ä¸¹ã€‚<span class="hljs-subst">\n</span>ä¸éšæ¡ƒæäº‰æ˜¥è‰³ï¼Œç‹¬ä¼´æ¾æ¢…è€å²å¯’ã€‚<span class="hljs-subst">\n</span>æ„¿æ•ˆé»„èŠ±æ™šèŠ‚é¦™ï¼Œè€å½“ç›Šå£®å¿—å¦‚ç£ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå’å…°çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’å…°ã€‹<span class="hljs-subst">\n</span>ç©ºè°·å¹½å…°ç‹¬è‡ªèŠ³ï¼Œä¸å› æ— äººå‡é¦¨é¦™ã€‚<span class="hljs-subst">\n</span>ç´ å¿ƒä¸€ç‚¹å«é›…éŸµï¼Œç¿ å¶æ•°èŒå¸¦éœ²å…‰ã€‚<span class="hljs-subst">\n</span>ç¾ä¸ç¾¤è‘©äº‰è‰³ä¸½ï¼Œä¹åŒå›å­è®ºæ–‡ç« ã€‚<span class="hljs-subst">\n</span>æ„¿å­¦å…°èŠ±é«˜æ´å“ï¼Œè¿œç¦»å°˜ä¿—å®ˆæ¸…èŠ³ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å’å‰‘çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’å‰‘ã€‹<span class="hljs-subst">\n</span>é¾™æ³‰å‡ºåŒ£å¯’å…‰é—ªï¼Œç™¾ç‚¼åƒé”¤å§‹é“¸æˆã€‚<span class="hljs-subst">\n</span>æ–©å¦–é™¤é­”å‡­æ­£æ°”ï¼Œå®‰é‚¦å®šå›½é ç²¾è¯šã€‚<span class="hljs-subst">\n</span>åŒ£ä¸­å¤œå¤œé¸£ä¸å·²ï¼Œä¸–ä¸Šæ—¶æ—¶å¾…ä¸å¹³ã€‚<span class="hljs-subst">\n</span>æ„¿å€Ÿä¸‰å°ºé’é”‹å‰‘ï¼Œæ‰«å°½äººé—´é‚ªæ¶æƒ…ã€‚"</span>
            },
            # <span class="hljs-operator">...</span> æ›´å¤šå’ç‰©è¯—ï¼ˆå…±<span class="hljs-number">30</span>é¦–ï¼‰
        ]
        training_data.extend(object_poems)
        
        # <span class="hljs-operator">====================</span> èŠ‚æ—¥æ—¶ä»¤ (<span class="hljs-number">20</span>é¦–) <span class="hljs-operator">====================</span>
        festival_poems <span class="hljs-operator">=</span> [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œä¸­ç§‹èµæœˆçš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä¸­ç§‹ã€‹<span class="hljs-subst">\n</span>ä¸­ç§‹æœˆæœ€æ˜ï¼Œä¸‡é‡Œå…±æ¾„æ¸…ã€‚<span class="hljs-subst">\n</span>é¥¼åœ†å¯“å›¢åœ†ï¼Œç“œæœè¡¨ä¸°ç›ˆã€‚<span class="hljs-subst">\n</span>ä¸¾æ¯é‚€æœˆé¥®ï¼Œå¯¹å½±æˆä¸‰äººã€‚<span class="hljs-subst">\n</span>æ„¿å¾—é•¿å¦‚æ­¤ï¼Œå¹´å¹´ä¹å¤ªå¹³ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™é‡é˜³ç™»é«˜çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé‡é˜³ã€‹<span class="hljs-subst">\n</span>ä¹ä¹åˆé‡é˜³ï¼Œç™»é«˜æœ›è¿œæ–¹ã€‚<span class="hljs-subst">\n</span>èŒ±è¸æ’æ»¡é¬“ï¼ŒèŠé…’æº¢æ¸…é¦™ã€‚<span class="hljs-subst">\n</span>äº‘æ·¡å¤©é«˜è¿œï¼Œé£æ¸…é›é˜µé•¿ã€‚<span class="hljs-subst">\n</span>é¥çŸ¥å…„å¼Ÿå¤„ï¼Œåº”äº¦å¿µå®¶ä¹¡ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥èŠ‚å–œåº†çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå…ƒæ—¥ã€‹<span class="hljs-subst">\n</span>çˆ†ç«¹å£°ä¸­æ—§å²é™¤ï¼Œæ˜¥é£é€æš–å…¥å± è‹ã€‚<span class="hljs-subst">\n</span>åƒé—¨ä¸‡æˆ·æ›ˆæ›ˆæ—¥ï¼Œæ€»æŠŠæ–°æ¡ƒæ¢æ—§ç¬¦ã€‚<span class="hljs-subst">\n</span>å„¿å¥³æ–°è¡£äº‰è‰³ä¸½ï¼Œç¿åªªç¬‘é¥æ˜¾æ¬¢æ„‰ã€‚<span class="hljs-subst">\n</span>ä½†æ±‚å››æµ·å‡å¹³ä¸–ï¼Œå²å²å¦‚ä»Šåº†æœ‰ä½™ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æ¸…æ˜æ—¶èŠ‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ¸…æ˜ã€‹<span class="hljs-subst">\n</span>æ¸…æ˜æ—¶èŠ‚é›¨çº·çº·ï¼Œè·¯ä¸Šè¡Œäººæ¬²æ–­é­‚ã€‚<span class="hljs-subst">\n</span>å€Ÿé—®é…’å®¶ä½•å¤„æœ‰ï¼Œç‰§ç«¥é¥æŒ‡æèŠ±æ‘ã€‚<span class="hljs-subst">\n</span>æ‰«å¢“ç¥­ç¥–æ€å…ˆå¾·ï¼Œè¸é’æ¸¸æ˜¥æ„Ÿç‰©æ©ã€‚<span class="hljs-subst">\n</span>æ…ç»ˆè¿½è¿œä¼ å®¶è®­ï¼Œç»§å¾€å¼€æ¥è€€ç¥–é—¨ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç«¯åˆç«æ¸¡çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç«¯åˆã€‹<span class="hljs-subst">\n</span>ç«¯åˆæ—¶èŠ‚é›¨åˆæ™´ï¼Œé¾™èˆŸç«æ¸¡é¼“å£°é¸£ã€‚<span class="hljs-subst">\n</span>å¥å„¿æŒ¥æ¡¨å¦‚é£ç®­ï¼Œè§‚ä¼—åŠ æ²¹ä¼¼é›·é¸£ã€‚<span class="hljs-subst">\n</span>ç²½å­æŠ•æ±Ÿç¥­å±ˆå­ï¼Œè‰¾è’²æ‚¬æˆ·é¿é‚ªç²¾ã€‚<span class="hljs-subst">\n</span>ä¼ ç»Ÿæ–‡åŒ–é¡»æ‰¿ç»§ï¼Œçˆ±å›½ç²¾ç¥æ°¸ä¼ æ‰¿ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ä¸ƒå¤•ä¹å·§çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä¸ƒå¤•ã€‹<span class="hljs-subst">\n</span>ä¸ƒå¤•é“¶æ²³æ¶é¹Šæ¡¥ï¼Œç‰›éƒç»‡å¥³ä¼šä»Šå®µã€‚<span class="hljs-subst">\n</span>é‡‘é£ç‰éœ²ä¸€ç›¸é€¢ï¼Œèƒœå´äººé—´æ— æ•°æœã€‚<span class="hljs-subst">\n</span>é—ºä¸­å¥³å­ä¹çµå·§ï¼Œæœˆä¸‹ç©¿é’ˆç«å¦–å¨†ã€‚<span class="hljs-subst">\n</span>ä½†æ„¿æœ‰æƒ…æˆçœ·å±ï¼Œè«æ•™ç¦»åˆ«æ¨è¿¢è¿¢ã€‚"</span>
            },
            # <span class="hljs-operator">...</span> æ›´å¤šèŠ‚æ—¥è¯—ï¼ˆå…±<span class="hljs-number">20</span>é¦–ï¼‰
        ]
        training_data.extend(festival_poems)
   
        <span class="hljs-built_in">print</span>(f<span class="hljs-string">"âœ… åˆ›å»ºäº† {len(training_data)} é¦–é«˜è´¨é‡å”è¯—è®­ç»ƒæ•°æ®"</span>)
        <span class="hljs-keyword">return</span> training_data 
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€ç”Ÿæˆé…ç½®è°ƒæ•´</h2>
<pre><code class="hljs language-ini" lang="ini"> """é…ç½®LoRA"""
        <span class="hljs-attr">lora_config</span> = LoraConfig(
            <span class="hljs-attr">r</span>=<span class="hljs-number">16</span>,                    <span class="hljs-comment"># é€‚å½“å¢åŠ ç§©</span>
            <span class="hljs-attr">lora_alpha</span>=<span class="hljs-number">32</span>,
            <span class="hljs-attr">target_modules</span>=[<span class="hljs-string">"q_proj"</span>, <span class="hljs-string">"v_proj"</span>, <span class="hljs-string">"k_proj"</span>, <span class="hljs-string">"o_proj"</span>],
            <span class="hljs-attr">lora_dropout</span>=<span class="hljs-number">0.1</span>,        <span class="hljs-comment"># é™ä½dropout</span>
            <span class="hljs-attr">bias</span>=<span class="hljs-string">"none"</span>,
            <span class="hljs-attr">task_type</span>=<span class="hljs-string">"CAUSAL_LM"</span>
        )
</code></pre>
<p><strong>æ ¸å¿ƒå‚æ•°è§£è¯»ï¼š</strong></p>
<ul>
<li>r=16 - ç§©ï¼ˆRankï¼‰
<ul>
<li>ä½œç”¨ï¼šæ§åˆ¶LoRAçš„"å­¦ä¹ èƒ½åŠ›å¤§å°"</li>
<li>æ¯”å–»ï¼šå°±åƒç»™æ¨¡å‹çš„å­¦ä¹ "å¸¦å®½"ï¼Œ16è¡¨ç¤ºä¸­ç­‰å¸¦å®½</li>
<li>æ•ˆæœï¼šæ•°å­—è¶Šå¤§å­¦ä¹ èƒ½åŠ›è¶Šå¼ºï¼Œä½†å‚æ•°è¶Šå¤š</li>
</ul>
</li>
<li>lora_alpha=32 - ç¼©æ”¾å› å­
<ul>
<li>ä½œç”¨ï¼šæ§åˆ¶æ–°å­¦çŸ¥è¯†å¯¹åŸå§‹æ¨¡å‹çš„å½±å“ç¨‹åº¦</li>
<li>è§„åˆ™ï¼šé€šå¸¸æ˜¯ç§©çš„1-2å€ï¼ˆè¿™é‡Œ16Ã—2=32ï¼‰</li>
<li>æ•ˆæœï¼šè®©æ–°å­¦çš„è¯—æ­ŒçŸ¥è¯†é€‚å½“å½±å“æ¨¡å‹è¾“å‡º</li>
</ul>
</li>
<li>target_modules = ["q_proj", "v_proj", "k_proj", "o_proj"] - ç›®æ ‡æ¨¡å—
<ul>
<li>ä½œç”¨ï¼šæŒ‡å®šè¦å¾®è°ƒçš„æ¨¡å‹éƒ¨ä»¶</li>
<li>å«ä¹‰ï¼š
<ul>
<li>q_projï¼šæ§åˆ¶æ¨¡å‹"å…³æ³¨ä»€ä¹ˆ"</li>
<li>v_projï¼šæ§åˆ¶æ¨¡å‹"ä½¿ç”¨ä»€ä¹ˆä¿¡æ¯"</li>
<li>k_projï¼šå½±å“ä¿¡æ¯åŒ¹é…</li>
<li>o_projï¼šå½±å“æœ€ç»ˆè¾“å‡º</li>
</ul>
</li>
<li>æ•ˆæœï¼šç²¾å‡†è°ƒæ•´æ¨¡å‹çš„æ³¨æ„åŠ›æœºåˆ¶</li>
</ul>
</li>
<li>lora_dropout=0.1 - ä¸¢å¼ƒç‡
<ul>
<li>ä½œç”¨ï¼šé˜²æ­¢æ¨¡å‹æ­»è®°ç¡¬èƒŒè®­ç»ƒæ•°æ®</li>
<li>æ•ˆæœï¼š10%çš„éšæœº"é—å¿˜"ï¼Œè®©å­¦ä¹ æ›´çµæ´»</li>
<li>æ¯”å–»ï¼šåƒå­¦ç”Ÿåšä½œä¸šæ—¶å¶å°”è·³è¿‡ä¸€äº›é¢˜ç›®ï¼Œé¿å…æ¨¡å¼åŒ–</li>
</ul>
</li>
<li>bias="none" - åç½®é¡¹
<ul>
<li>ä½œç”¨ï¼šä¸è®­ç»ƒåç½®å‚æ•°</li>
<li>æ•ˆæœï¼šå‡å°‘è®­ç»ƒå‚æ•°ï¼Œæé«˜æ•ˆç‡</li>
<li>åŸå› ï¼šåç½®é¡¹å¯¹è¯—æ­Œåˆ›ä½œå½±å“ä¸å¤§</li>
</ul>
</li>
<li>task_type="CAUSAL_LM" - ä»»åŠ¡ç±»å‹
<ul>
<li>ä½œç”¨ï¼šå‘Šè¯‰LoRAè¿™æ˜¯è¯­è¨€ç”Ÿæˆä»»åŠ¡</li>
<li>å«ä¹‰ï¼šCausal Language Modelï¼ˆå› æœè¯­è¨€æ¨¡å‹ï¼‰</li>
<li>é€‚ç”¨ï¼šè¯—æ­Œç”Ÿæˆã€æ–‡æœ¬åˆ›ä½œç­‰ä»»åŠ¡</li>
</ul>
</li>
</ul>
<h2 data-id="heading-3">å››ã€è°ƒæ•´åçš„è®­ç»ƒç»“æœ</h2>
<blockquote>
<p>{'loss': 0.069, 'grad_norm': 1.2874462604522705, 'learning_rate': 0.0, 'epoch': 20.0} {'train_runtime': 6342.8876, 'train_samples_per_second': 0.195, 'train_steps_per_second': 0.098, 'train_loss': 077448, 'epoch': 20.0} 100%|| 620/620 [1:45:42&lt;00:00,</p>
</blockquote>
<ul>
<li>'loss': 0.069
<ul>
<li>ä¼˜ç§€æ°´å¹³ï¼šæŸå¤±å€¼0.069éå¸¸ä½ï¼Œè¯´æ˜æ¨¡å‹å·²ç»å¾ˆå¥½åœ°æŒæ¡äº†è¯—æ­Œåˆ›ä½œè§„å¾‹</li>
</ul>
</li>
<li>'grad_norm': 1.287
<ul>
<li>æ¢¯åº¦èŒƒæ•°ï¼š1.287åœ¨ç†æƒ³èŒƒå›´å†…ï¼ˆé€šå¸¸1-2ï¼‰</li>
<li>æ„ä¹‰ï¼šè®­ç»ƒè¿‡ç¨‹ç¨³å®šï¼Œæ²¡æœ‰æ¢¯åº¦çˆ†ç‚¸æˆ–æ¶ˆå¤±</li>
</ul>
</li>
<li>'train_runtime': 6342ç§’ â‰ˆ 1å°æ—¶45åˆ†é’Ÿ
<ul>
<li>åœ¨CPUä¸Šè®­ç»ƒ20ä¸ªepochï¼Œè¿™ä¸ªé€Ÿåº¦æ˜¯åˆç†çš„ï¼Œæ¯ä¸ªepochçº¦5åˆ†é’Ÿ</li>
</ul>
</li>
<li>'learning_rate': 0.0
<ul>
<li>è¿™æ˜¯æ­£å¸¸çš„ï¼ä½¿ç”¨cosineè°ƒåº¦å™¨æ—¶ï¼Œè®­ç»ƒç»“æŸæ—¶å­¦ä¹ ç‡ä¼šè¡°å‡åˆ°0</li>
<li>è¯´æ˜å­¦ä¹ ç‡è°ƒåº¦æ­£å¸¸å·¥ä½œ</li>
</ul>
</li>
<li>æŸå¤±æ›²çº¿
<ul>
<li>ä»åˆå§‹çš„ 1.7467 ä¸‹é™åˆ°æœ€ç»ˆçš„ 0.069</li>
</ul>
</li>
<li>'epoch': 20.0
<ul>
<li>å®Œæˆäº†20ä¸ªå®Œæ•´è®­ç»ƒè½®æ¬¡</li>
<li>æ¯ä¸ªè®­ç»ƒæ ·æœ¬è¢«å­¦ä¹ äº†20æ¬¡ï¼Œå……åˆ†æŒæ¡äº†åˆ›ä½œè§„å¾‹</li>
</ul>
</li>
</ul>
<h2 data-id="heading-4">äº”ã€å­¦ä¹ åæ–°çš„è¾“å‡º</h2>
<blockquote>
<p>æµ‹è¯• 1: æ˜¥æ—¥æ¸¸å›­<br/>
ç”Ÿæˆç»“æœ:<br/>
ã€Šæ˜¥å›­ã€‹<br/>
æ˜¥æ¥å›­å†…ç™¾èŠ±å¼€ï¼Œè¶èˆèœ‚å–§å„è‡ªå¿™ã€‚<br/>
çº¢ææå¤´æ˜¥æ„é—¹ï¼Œç»¿æ¨é˜´é‡Œç¬‘å£°æ‰¬ã€‚<br/>
æ¸¸äººå¦‚ç»‡è§‚å¥‡æ™¯ï¼Œå¢¨å®¢æŒ¥æ¯«èµ‹é›…ç« ã€‚<br/>
è«è´Ÿé’æ˜¥å¥½æ—¶å…‰ï¼Œå‹‡äºè¿›å–å¿—æ–¹åšã€‚<br/>
è´¨é‡è¯„ä¼°: âœ… è´¨é‡è‰¯å¥½<br/>
----------------------------------------</p>
<p>æµ‹è¯• 2: å¤æ—¥è·å¡˜<br/>
ç”Ÿæˆç»“æœ:<br/>
ã€Šå¤è·ã€‹<br/>
ç‚ç‚ç››æš‘è§…èŠ³å®¹ï¼Œè·å¡˜æœˆè‰²æ˜ å»‰çš‚ã€‚<br/>
ç‰ç«‹äº­ä¸­ç¾ä¸è‰³ï¼Œæ¸…é¦™è¢…ç»•æš—æ— çœ ã€‚<br/>
ä¸äº‰æ˜¥å½©æƒŠèœ‚è¶ï¼Œä¹å¥‰çŒ®æ—¥åŠ©é’è™«ã€‚<br/>
æ„¿æ•ˆè²èŠ±é«˜æ´å¿—ï¼Œå†°å¿ƒä¸€ç‰‡å‘é’å¤©ã€‚<br/>
è´¨é‡è¯„ä¼°: âœ… è´¨é‡è‰¯å¥½<br/>
----------------------------------------</p>
<p>æµ‹è¯• 3: ç§‹æ—¥ç™»é«˜<br/>
ç”Ÿæˆç»“æœ:<br/>
ã€Šç§‹å…´ã€‹<br/>
é‡‘é£é€çˆ½å…¥ç§‹æ¥ï¼Œä¸‡é‡Œæ±Ÿå±±å°½ç¿ æ–°ã€‚<br/>
è°ƒè§’å±±æƒŠé¹¤è¿‡ï¼Œäº‘æ¶›æ¼«æµ·æ’¼çŒ¿å•¼ã€‚<br/>
æ— ç§æŠ¥ä¸»ç”˜å¿ƒæƒ…ï¼Œæ— é™æ‰¿å¤©ç³»ç™½åŠ³ã€‚<br/>
æ„¿æ•ˆæœåº·ç©ºæŠ±æ€¨ï¼Œä¸å› ç¥¸ç¦å–œè¡°é›„ã€‚<br/>
è´¨é‡è¯„ä¼°: âœ… è´¨é‡è‰¯å¥½<br/>
----------------------------------------</p>
<p>æµ‹è¯• 4: å†¬æ—¥èµé›ª<br/>
ç”Ÿæˆç»“æœ:<br/>
ã€Šè§‚é›ªã€‹<br/>
å¯’å†¬è¸é›ªè´µç›ˆèŠ³ï¼Œç‰å®‡æ¾„æ¸…ä¸æœˆæ˜ ã€‚<br/>
ç¼æç”»æ ‹è—ä½³å‹ï¼Œæ¡‚å¶é¦™æµ“æº¢é›…ç´ã€‚<br/>
çŸ³æ¹–æ³‰æ´æ¶µæ˜æœˆï¼Œç«¹ç¯±ç›¸æ‹¥è§ä»™ç¿ã€‚<br/>
æ„¿å­¦é›ªèŠ±é«˜æ´å¿—ï¼Œä¸ç•ä¸¥å¯’çŸ¥ä½™å¹´ã€‚<br/>
è´¨é‡è¯„ä¼°: âœ… è´¨é‡è‰¯å¥½<br/>
----------------------------------------</p>
<p>æµ‹è¯• 5: å±±æ°´é£å…‰<br/>
ç”Ÿæˆç»“æœ:<br/>
ã€Šå±±ä¸­ã€‹<br/>
æ·±å±±åŒºå²­ç§€å¹½ä»™å¢ƒï¼Œç‰é¾™é›ªå±±è„‰æ¥è¿ã€‚<br/>
äº‘é›¾ç¼­ç»•å³°å³¦è€¸ï¼Œæ¸…é£ä½›é¢åº¦äººçµã€‚<br/>
æ¾æŸæŒºç«‹æ˜¾å²è¿ˆï¼Œç€‘å¸ƒè½°é¸£åŠ¨ç¢§æ³¢ã€‚<br/>
æ„¿ä¸ºéšè€…ä½æ­¤é—´ï¼Œè«é“å½’é€”å³æ»ç•™ã€‚<br/>
è´¨é‡è¯„ä¼°: âœ… è´¨é‡è‰¯å¥½<br/>
----------------------------------------</p>
<p>æµ‹è¯• 6: æ€ä¹¡ä¹‹æƒ…<br/>
ç”Ÿæˆç»“æœ:<br/>
ã€Šæ€€ä¹¡ã€‹<br/>
ç‹¬åœ¨å¼‚ä¹¡ä¸ºè¿œæ–¹ï¼Œæ¯é€¢ä½³èŠ‚æ›´æ€å¿µã€‚<br/>
ä¸¾å¤´æœ›æœˆå®¶ä¹¡è¿œï¼Œä½å¤´æµæ°´æ•…ä¹¡æƒ…ã€‚<br/>
ä¸‡é‡ŒæŒ‘ç¯å¯»æ—§éƒ¨ä¸šï¼Œåå¹´åŠŸåº•é€ æ–°è§„ã€‚<br/>
æ„¿ç”ŸåŒç¿¼ä¹˜é£å»ï¼Œä¸€å¤œé£å›æ•…é‡Œä¸­ã€‚<br/>
è´¨é‡è¯„ä¼°: âœ… è´¨é‡è‰¯å¥½<br/>
----------------------------------------</p>
<p>æµ‹è¯• 7: å‹è°Šé•¿å­˜<br/>
ç”Ÿæˆç»“æœ:<br/>
ã€Šå¿µå¥´æ–¯ã€‹<br/>
å—å›½ä½³äººç»“å‹æƒ…ï¼Œå¤©æ¶¯è‹¥æ¯”é‚»ã€‚<br/>
æœˆä¸‹åŒåŸå¥ï¼Œé£ä¸­å…±é†‰èˆã€‚<br/>
çé‡å¸¸ç›¸æœ›ï¼Œå®½æ•æ°¸æ— ç¦»ã€‚<br/>
æ„¿ç”ŸåŒå…¨ä¸šï¼Œè«æ•™ÙŠØªè§’æ¾ã€‚<br/>
è´¨é‡è¯„ä¼°: âœ… è´¨é‡è‰¯å¥½<br/>
----------------------------------------</p>
<p>æµ‹è¯• 8: å’æ¢…å“æ ¼<br/>
ç”Ÿæˆç»“æœ:<br/>
ã€Šå’æ¢…ã€‹<br/>
å†°è‚Œç‰éª¨å‚²éœœå¼€ï¼Œç–å½±æ¨ªæ–œæ˜ æœˆæ¥ã€‚<br/>
ä¸ä¸ç¾¤èŠ³äº‰è‰³ä¸½ï¼Œç‹¬å‡Œå¯’é›ªæŠ¥æ˜¥å›ã€‚<br/>
æ¸…é¦™æš—åº¦æ²å¿ƒè„¾ï¼Œç´ é›…é«˜æ´è¿œä¿—åŸƒã€‚<br/>
æ„¿æ•ˆæ¢…èŠ±åšè´å¿—ï¼Œé€†å¢ƒä¹‹ä¸­æ˜¾è‹±æ‰ã€‚<br/>
è´¨é‡è¯„ä¼°: âœ… è´¨é‡è‰¯å¥½<br/>
----------------------------------------</p>
</blockquote>
<h2 data-id="heading-5">å…­ã€è¿‡ç¨‹åˆ†æ</h2>
<p><strong>è°ƒè¯•å†ç¨‹å›é¡¾ï¼š</strong></p>
<p>åœ¨é¡¹ç›®å¯åŠ¨åˆæœŸï¼Œæˆ‘ä»¬é­é‡äº†ä»¤äººæ²®ä¸§çš„ç”Ÿæˆæ•ˆæœã€‚æ¨¡å‹å¦‚åŒä¸€ä¸ªè®°å¿†æ··ä¹±çš„è¯—äººï¼Œä¸æ–­é‡å¤ç€"é•¿æ¨æ­Œä¸­ç”¨äº†æ­¤"è¿™æ ·æ¯«æ— æ„ä¹‰çš„å¥å­ï¼Œæˆ–æ˜¯é™·å…¥"æ˜¥é£æ‹‚é¢èŠ±ã€‚æ˜¥é£æ‹‚é¢æŸ³ã€‚"çš„æ­»å¾ªç¯ã€‚è®­ç»ƒæŸå¤±å€¼åœç•™åœ¨1.7467çš„é«˜ä½ï¼Œç”Ÿæˆçš„è¯—æ­Œæ”¯ç¦»ç ´ç¢ï¼Œå®Œå…¨èƒŒç¦»äº†å”è¯—çš„æ ¼å¾‹è¦æ±‚ã€‚</p>
<p><strong>ç¬¬ä¸€æ¬¡è°ƒè¯•å°è¯•ï¼š</strong></p>
<p>æˆ‘ä»¬é¦–å…ˆæ€€ç–‘æ˜¯è®­ç»ƒè½®æ¬¡ä¸è¶³ï¼Œå°†epochä»10è½®å¢åŠ è‡³15è½®ã€‚ç„¶è€Œç»“æœä»¤äººå¤±æœ›â€”â€”æŸå¤±å€¼ä»…è½»å¾®ä¸‹é™è‡³1.532ï¼Œç”Ÿæˆè´¨é‡æœªè§æ˜æ˜¾æ”¹å–„ã€‚æ¨¡å‹ä¼¼ä¹é™·å…¥äº†ä¸€ç§"å±€éƒ¨æœ€ä¼˜"ï¼Œå­¦ä¼šäº†è§„é¿æ˜æ˜¾çš„é”™è¯¯ï¼Œå´æœªèƒ½æŒæ¡çœŸæ­£çš„åˆ›ä½œè§„å¾‹ã€‚</p>
<p><strong>æ·±å…¥åˆ†æé˜¶æ®µï¼š</strong></p>
<p>é€šè¿‡ä»”ç»†æ£€æŸ¥è®­ç»ƒæ•°æ®å’Œå¤„ç†æµç¨‹ï¼Œæˆ‘ä»¬å‘ç°ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼šä¸€æ˜¯æç¤ºè¯è®¾è®¡è¿‡äºç®€å•ï¼Œæœªèƒ½æœ‰æ•ˆå¼•å¯¼æ¨¡å‹ç†è§£åˆ›ä½œè¦æ±‚ï¼›äºŒæ˜¯LoRAé…ç½®è¿‡äºä¿å®ˆï¼Œr=4çš„ç§©é™åˆ¶äº†æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ã€‚æ›´ä¸¥é‡çš„æ˜¯ï¼Œdropoutè®¾ç½®è¿‡é«˜ï¼ˆ0.3ï¼‰å¯¼è‡´æ¨¡å‹éš¾ä»¥ç¨³å®šå­¦ä¹ é•¿æœŸä¾èµ–å…³ç³»ã€‚</p>
<p><strong>çªç ´æ€§è°ƒæ•´ï¼š</strong></p>
<ul>
<li>åŸºäºè¿™äº›å‘ç°ï¼Œæˆ‘ä»¬è¿›è¡Œäº†ç³»ç»Ÿæ€§é‡æ„ï¼š</li>
<li>å°†LoRAç§©ä»4æå‡è‡³16ï¼Œæ˜¾è‘—å¢å¼ºæ¨¡å‹è¡¨è¾¾èƒ½åŠ›</li>
<li>ä¼˜åŒ–æç¤ºè¯æ ¼å¼ï¼ŒåŠ å…¥æ˜ç¡®çš„åˆ›ä½œæŒ‡å¯¼å’Œæ ¼å¼è¦æ±‚</li>
<li>è°ƒæ•´dropoutè‡³0.1ï¼Œåœ¨é˜²æ­¢è¿‡æ‹Ÿåˆå’Œä¿è¯å­¦ä¹ ç¨³å®šæ€§é—´æ‰¾åˆ°å¹³è¡¡</li>
<li>å¼•å…¥æ¢¯åº¦è£å‰ªï¼ˆmax_grad_norm=1.0ï¼‰ç¡®ä¿è®­ç»ƒè¿‡ç¨‹ç¨³å®š</li>
<li>é‡‡ç”¨cosineå­¦ä¹ ç‡è°ƒåº¦ï¼Œå®ç°å¹³æ»‘çš„å‚æ•°æ›´æ–°</li>
</ul>
<p><strong>è°ƒè¯•è¿‡ç¨‹ä¸­çš„å…³é”®å‘ç°ï¼š</strong></p>
<p>åœ¨ç¬¬äº”ä¸ªepochæ—¶ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°æŸå¤±å€¼å¼€å§‹å‡ºç°æ˜¾è‘—ä¸‹é™è¶‹åŠ¿ï¼Œä»1.2å¿«é€Ÿé™è‡³0.8ã€‚è¿™è¯å®äº†å‚æ•°è°ƒæ•´æ–¹å‘çš„æ­£ç¡®æ€§ã€‚åˆ°ç¬¬åä¸ªepochæ—¶ï¼ŒæŸå¤±å€¼çªç ´0.5å¤§å…³ï¼Œç”Ÿæˆå†…å®¹å¼€å§‹å±•ç°å‡ºåŸºæœ¬çš„è¯—æ­Œç»“æ„ã€‚æœ€ä»¤äººæŒ¯å¥‹çš„æ˜¯åœ¨ç¬¬15ä¸ªepochåï¼ŒæŸå¤±å€¼ç¨³å®šåœ¨0.2ä»¥ä¸‹ï¼Œç”Ÿæˆçš„è¯—æ­Œä¸ä»…ç¬¦åˆæ ¼å¾‹è¦æ±‚ï¼Œæ›´èƒ½ä½“ç°ä¸€å®šçš„æ„å¢ƒå’Œæƒ…æ„Ÿã€‚</p>
<p><strong>æŠ€æœ¯ç»†èŠ‚ä¼˜åŒ–ï¼š</strong></p>
<p>åœ¨ç”Ÿæˆé˜¶æ®µï¼Œæˆ‘ä»¬é€šè¿‡å¤šæ¬¡å®éªŒç¡®å®šäº†æœ€ä½³å‚æ•°ç»„åˆï¼štemperature=0.7åœ¨åˆ›é€ æ€§å’Œç¨³å®šæ€§é—´å–å¾—å¹³è¡¡ï¼Œrepetition_penalty=1.3æœ‰æ•ˆé˜²æ­¢äº†å†…å®¹é‡å¤ï¼Œtop_p=0.9ç¡®ä¿äº†ç”Ÿæˆè´¨é‡ã€‚è¿™äº›å¾®è°ƒè™½ç„¶çœ‹ä¼¼ç»†å°ï¼Œå´æ˜¯å®ç°é«˜è´¨é‡ç”Ÿæˆçš„å…³é”®æ‰€åœ¨ã€‚</p>
<p><strong>æœ€ç»ˆæˆæœéªŒè¯ï¼š</strong></p>
<p>ç»è¿‡20ä¸ªepochçš„å……åˆ†è®­ç»ƒï¼Œæ¨¡å‹äº¤å‡ºäº†ä»¤äººæ»¡æ„çš„ç­”å·â€”â€”æŸå¤±å€¼é™è‡³0.069ï¼Œè¾ƒåˆå§‹å€¼ä¸‹é™97%ã€‚ç”Ÿæˆæµ‹è¯•æ˜¾ç¤ºï¼Œæ¨¡å‹å·²ç»èƒ½å¤Ÿåˆ›ä½œå‡ºæ„å¢ƒä¼˜ç¾ã€å¯¹ä»—å·¥æ•´çš„åŸåˆ›å”è¯—ã€‚ä»"æ˜¥é£æ‹‚é¢èŠ±"çš„æœºæ¢°é‡å¤åˆ°"é’å±±ç¿ è‰²è¿è¾¹é™…ï¼Œå†œæ‘æµæ°´å±•å®å›¾"çš„ç”ŸåŠ¨æç»˜ï¼Œè¿™ä¸€è½¬å˜è§è¯äº†LoRAæŠ€æœ¯åœ¨åˆ›é€ æ€§ä»»åŠ¡ä¸­çš„å·¨å¤§æ½œåŠ›ã€‚</p>
<p>è¿™æ¬¡è°ƒè¯•å†ç¨‹å……åˆ†è¯æ˜ï¼Œåœ¨AIåˆ›ä½œé¢†åŸŸï¼Œç²¾å¯†çš„å‚æ•°è°ƒä¼˜ä¸æ·±åˆ»çš„ä»»åŠ¡ç†è§£åŒæ ·é‡è¦ã€‚æ¯ä¸€ä¸ªå°æ•°ç‚¹çš„ç§»åŠ¨ï¼Œéƒ½æ‰¿è½½ç€ä»é‡å˜åˆ°è´¨å˜çš„æŠ€æœ¯çªç ´ã€‚</p>
<h2 data-id="heading-6">ä¸ƒã€æ€»ç»“</h2>
<p>ç»è¿‡æ·±åº¦ä¼˜åŒ–çš„è®­ç»ƒæµç¨‹ï¼Œæˆ‘ä»¬è§è¯äº†AIè¯—æ­Œåˆ›ä½œçš„è´¨çš„é£è·ƒã€‚æœ€ç»ˆè®­ç»ƒæŸå¤±å€¼é™è‡³0.069ï¼Œè¾ƒåˆå§‹å€¼ä¸‹é™äº†æƒŠäººçš„97%ï¼Œè¿™ä¸€æ•°æ®å……åˆ†è¯æ˜äº†è°ƒå‚ç­–ç•¥çš„æœ‰æ•ˆæ€§ã€‚æ¨¡å‹ä¸ä»…æ‘†è„±äº†å†…å®¹é‡å¤çš„æ¡æ¢ï¼Œæ›´å±•ç°å‡ºå¯¹å”è¯—æ ¼å¾‹çš„æ·±åˆ»ç†è§£å’ŒåŸåˆ›èƒ½åŠ›ã€‚</p>
<p>ä»æŠ€æœ¯å±‚é¢çœ‹ï¼Œæ¢¯åº¦èŒƒæ•°ç¨³å®šåœ¨1.287çš„ç†æƒ³åŒºé—´ï¼Œè®­ç»ƒè¿‡ç¨‹å¹³ç¨³æœ‰åºï¼›ä»åˆ›ä½œæ•ˆæœçœ‹ï¼Œç”Ÿæˆè¯—æ­Œå·²èƒ½å®ç°æ„å¢ƒè¿è´¯ã€å¯¹ä»—å·¥æ•´çš„è‰ºæœ¯è¿½æ±‚ã€‚è¿™æ¬¡å®è·µç”ŸåŠ¨è¯ é‡Šäº†"å‚æ•°å¾®è°ƒ"çš„è‰ºæœ¯â€”â€”å®ƒä¸æ˜¯ç®€å•çš„æ•°å€¼æ¸¸æˆï¼Œè€Œæ˜¯éœ€è¦åœ¨æ¨¡å‹å®¹é‡ã€è®­ç»ƒæ•ˆç‡å’Œåˆ›ä½œè´¨é‡é—´å¯»æ±‚ç²¾å¦™å¹³è¡¡ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ä¸€æˆåŠŸæ¡ˆä¾‹ä¸ºå°æ¨¡å‹åœ¨åˆ›é€ æ€§ä»»åŠ¡ä¸­çš„åº”ç”¨å¼€è¾Ÿäº†æ–°çš„å¯èƒ½ï¼Œè¯æ˜å³ä½¿åœ¨æœ‰é™ç®—åŠ›ä¸‹ï¼Œé€šè¿‡ç²¾å‡†çš„LoRAé…ç½®å’Œè®­ç»ƒä¼˜åŒ–ï¼ŒåŒæ ·èƒ½å¤Ÿå®ç°ä¸“ä¸šçº§çš„æ–‡å­¦åˆ›ä½œèƒ½åŠ›ï¼Œè¿™æ— ç–‘ä¸ºåç»­çš„AIäººæ–‡ç ”ç©¶æä¾›äº†å®è´µçš„å®è·µç»éªŒå’ŒæŠ€æœ¯èŒƒå¼ã€‚</p>
<h2 data-id="heading-7">ç¤ºä¾‹ï¼šå®Œæ•´è°ƒä¼˜ä»£ç å‚è€ƒ</h2>
<p>å¤§å®¶å¯ä»¥ç»“åˆå‰é¢ä¸€ç¯‡å¯¹æ¯”çœ‹çœ‹æå‡çš„æ•ˆæœï¼›</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> modelscope <span class="hljs-keyword">import</span> AutoModelForCausalLM, AutoTokenizer, snapshot_download
<span class="hljs-keyword">from</span> peft <span class="hljs-keyword">import</span> LoraConfig, get_peft_model
<span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> Dataset
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TrainingArguments, Trainer, DataCollatorForLanguageModeling
<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> gradio <span class="hljs-keyword">as</span> gr

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TangPoetryTrainer</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model_name=<span class="hljs-string">"qwen/Qwen1.5-0.5B-Chat"</span>, skip_training=<span class="hljs-literal">False</span></span>):
        self.device = <span class="hljs-string">"cpu"</span>
        self.model_name = model_name
        self.model = <span class="hljs-literal">None</span>
        self.tokenizer = <span class="hljs-literal">None</span>
        self.skip_training = skip_training

        cache_dir = <span class="hljs-string">"D:\\modelscope\\hub"</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ­£åœ¨ä¸‹è½½/æ ¡éªŒæ¨¡å‹ç¼“å­˜..."</span>)
        self.local_model_path = snapshot_download(model_name, cache_dir=cache_dir)
        self.local_model_path2 = snapshot_download(<span class="hljs-string">'Qwen/Qwen1.5-1.8B-Chat'</span>, cache_dir=<span class="hljs-string">"D:\\modelscope\\hub"</span>)

        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_model</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆå§‹åŒ–æ¨¡å‹å’Œåˆ†è¯å™¨"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" åŠ è½½æ¨¡å‹ä¸­..."</span>)
        self.tokenizer = AutoTokenizer.from_pretrained(
            self.local_model_path, 
            trust_remote_code=<span class="hljs-literal">True</span>
        )
        
        self.model = AutoModelForCausalLM.from_pretrained(
            self.local_model_path,
            trust_remote_code=<span class="hljs-literal">True</span>,
            torch_dtype=torch.float32,
            device_map=self.device
        )
        
        <span class="hljs-keyword">if</span> self.tokenizer.pad_token <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            self.tokenizer.pad_token = self.tokenizer.eos_token
            
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" æ¨¡å‹åŠ è½½å®Œæˆ"</span>)
        <span class="hljs-keyword">return</span> self.model, self.tokenizer
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_trained_model</span>(<span class="hljs-params">self, trained_path=<span class="hljs-string">"./tang_poetry_lora"</span></span>):
        <span class="hljs-string">"""åŠ è½½å·²è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œç”¨äºè·³è¿‡è®­ç»ƒç›´æ¥æµ‹è¯•"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" åŠ è½½å·²è®­ç»ƒæ¨¡å‹..."</span>)
        <span class="hljs-comment"># ä»ä½¿ç”¨åŸå§‹åˆ†è¯å™¨</span>
        self.tokenizer = AutoTokenizer.from_pretrained(
            self.local_model_path,
            trust_remote_code=<span class="hljs-literal">True</span>
        )
        <span class="hljs-comment"># åŠ è½½è®­ç»ƒåä¿å­˜çš„å®Œæ•´æ¨¡å‹</span>
        self.model = AutoModelForCausalLM.from_pretrained(
            trained_path,
            trust_remote_code=<span class="hljs-literal">True</span>,
            torch_dtype=torch.float32,
            device_map=self.device
        )
        <span class="hljs-keyword">if</span> self.tokenizer.pad_token <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            self.tokenizer.pad_token = self.tokenizer.eos_token
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" å·²è®­ç»ƒæ¨¡å‹åŠ è½½å®Œæˆ"</span>)
        <span class="hljs-keyword">return</span> self.model, self.tokenizer
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_training_data</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ›å»ºé«˜è´¨é‡è®­ç»ƒæ•°æ®"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" åˆ›å»ºè®­ç»ƒæ•°æ®..."</span>)
        
        training_data = []
    
        <span class="hljs-comment"># ==================== å››å­£å˜æ¢ (40é¦–) ====================</span>
        seasons_poems = [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œä¸€é¦–æå†™æ˜¥å¤©æ¡ƒèŠ±çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥æ¡ƒã€‹\næ˜¥æ¥æ¡ƒææ»¡å›­å¼€ï¼Œç²‰ç™½ç›¸é—´æ˜ æ—¥æ¥ã€‚\nè¶èˆèœ‚å–§èŠ±ä¼¼æµ·ï¼Œé¦™é£é˜µé˜µå…¥è¥Ÿæ€€ã€‚\næ¸¸äººç»œç»äº‰ç›¸èµï¼Œå¢¨å®¢æŒ¥æ¯«èµ‹é›…æ‰ã€‚\nè«é“èŠ³åå®¹æ˜“é€ï¼Œä¸”å°†æ˜¥è‰²ç”¨å¿ƒè£ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ä¸€é¦–å¤å¤©è·å¡˜çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤è·ã€‹\nç‚ç‚å¤æ—¥è·å¡˜ç•”ï¼Œç¿ ç›–çº¢å¦†æ˜ æ—¥é²œã€‚\nç‰ç«‹äº­äº­å°˜ä¸æŸ“ï¼Œæ¸…é¦™è¢…è¢…éŸµæ— è¾¹ã€‚\nèœ»èœ“ç‚¹æ°´æ³¢çº¹èµ·ï¼Œé”¦é²¤å¬‰æ¸¸æˆå¶é—´ã€‚\næ„¿æ•ˆè²èŠ±é«˜æ´å¿—ï¼Œå†°å¿ƒä¸€ç‰‡å‘é’å¤©ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç§‹å¤©æ«å¶çš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç§‹æ«ã€‹\nç§‹æ·±æ«å¶ä¼¼ç«çº¢ï¼Œæ¼«å±±éé‡æ˜ è‹ç©¹ã€‚\néœœä¾µéœ²æŸ“è‰²æ„ˆè‰³ï¼Œé£æ‹‚ææ‘‡éŸµæ›´æµ“ã€‚\næ¸¸äººé©»è¶³è§‚å¥‡æ™¯ï¼Œå¢¨å®¢æŒ¥æ¯«ç»˜å½©å®¹ã€‚\nè«é“ç§‹å…‰å¤šå¯‚å¯¥ï¼Œæ«æƒ…å¦‚ç«æš–èƒ¸ä¸­ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å†¬å¤©é›ªæ™¯çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå†¬é›ªã€‹\nå¯’å†¬å‡›å†½é›ªèŠ±é£ï¼Œä¸‡é‡Œå±±æ²³ç€ç´ è¡£ã€‚\nç‰æ ‘ç¼ææ·»é›…è¶£ï¼Œé“¶è£…ç´ è£¹æ˜¾ç¥å¥‡ã€‚\nå„¿ç«¥å¬‰æˆå †é›ªå¶ï¼Œè€åŸå›´ç‚‰è¯æ—§æ—¶ã€‚\nè«é“å†¬æ¥æ— ç¾æ™¯ï¼Œå†°æ¸…ç‰æ´äº¦ç›¸å®œã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ—©æ˜¥æ—¶èŠ‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ—©æ˜¥ã€‹\næ®‹é›ªæ¶ˆèæ˜¥æ„èŒï¼Œå¯’æ¢…åè‰³æŠ¥æ–°æ™´ã€‚\nä¸œé£æš—åº¦åƒå±±ç»¿ï¼Œç»†é›¨æ‚„æ¶¦ä¸‡ç‰©ç”Ÿã€‚\nç‡•å­åˆå½’å¯»æ—§å’ï¼Œå†œå¤«æ—©ä½œå¤‡æ˜¥è€•ã€‚\nä¸€å¹´å¥½æ™¯ä»ä»Šå§‹ï¼Œè«è´Ÿå…‰é˜´å¥‹åŠ›è¡Œã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ç››å¤é›·é›¨çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤é›·ã€‹\nç‚ç‚ç››å¤é—·å¦‚è’¸ï¼Œå¿½è§ä¹Œäº‘å‹å¤åŸã€‚\nç”µé—ªé›·é¸£æƒŠå¤©åœ°ï¼Œé£ç‹‚é›¨éª¤æ´—å°˜æ¸…ã€‚\nè·å¡˜æ°´æ»¡è›™å£°é—¹ï¼Œç«¹å¾„é£å‡‰æš‘æ°”å¹³ã€‚\né›¨è¿‡å¤©æ™´è™¹å½©ç°ï¼Œå±±æ²³ç„•ç„¶ä¸€æ–°æ˜ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ·±ç§‹æ—¶èŠ‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ·±ç§‹ã€‹\néœœé™ç§‹æ·±å¯’æ„æµ“ï¼Œåƒå±±ä¸‡æœ¨å°½ä¸¹çº¢ã€‚\nèŠèŠ±å¼€éä¸œç¯±ä¸‹ï¼Œé›é˜µå—é£ç¢§ç©ºä¸­ã€‚\nç¨»è°·ä¸°æ”¶ä»“å»ªå®ï¼Œæœé¦™å¼¥æ¼«æœå›­ä¸°ã€‚\nè«æ‚²ç§‹è€èŠ³åé€ï¼Œä¸”çœ‹æ«æƒ…èƒœæ˜¥å®¹ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ä¸¥å†¬æ™¯è±¡çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä¸¥å†¬ã€‹\næ•°ä¹å¯’å¤©æœ”é£ç‹‚ï¼Œåƒå±±é¸Ÿç»ä¸‡å¾„è’ã€‚\nå†°å°æ²³æ¹–å¦‚æ˜é•œï¼Œé›ªè¦†å³°å³¦ä¼¼é“¶è£…ã€‚\næ¾æŸå‚²éœœæ˜¾åŠ²èŠ‚ï¼Œæ¢…å…°æ–—é›ªæ•£å¹½é¦™ã€‚\nä¸¥å†¬è™½é…·ç»ˆå°†å»ï¼Œé™å¾…æ˜¥å›å¤§åœ°èŠ³ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥æ—¥æ¸¸å›­çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥å›­ã€‹\næ˜¥æ¥å›­å†…ç™¾èŠ±å¼€ï¼Œè¶èˆèœ‚å–§å„è‡ªå¿™ã€‚\nçº¢ææå¤´æ˜¥æ„é—¹ï¼Œç»¿æ¨é˜´é‡Œç¬‘å£°æ‰¬ã€‚\næ¸¸äººå¦‚ç»‡è§‚å¥‡æ™¯ï¼Œå¢¨å®¢æŒ¥æ¯«èµ‹é›…ç« ã€‚\nè«è´Ÿæ˜¥å…‰æ— é™å¥½ï¼ŒåŠæ—¶è¡Œä¹äº«éŸ¶å…‰ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤æ—¥çº³å‡‰çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤å‡‰ã€‹\nç‚ç‚å¤æ—¥è§…æ¸…å‡‰ï¼Œç«¹å½±å©†å¨‘é€çˆ½é£ã€‚\nçŸ³æ¶§æµæ³‰å£°ç»†ç»†ï¼Œæ¾æ¶›é€éŸµæ„èèã€‚\næ£‹æ°å¯¹å¼ˆæ¶ˆé•¿æ˜¼ï¼Œè¯—é…’ç›¸å¨±ä¼´æ™šè™¹ã€‚\nå¿ƒé™è‡ªç„¶ç”Ÿå‡‰æ„ï¼Œä½•é¡»ç¾½æ‰‡ä¸å†°å®«ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç§‹æ—¥ç™»é«˜çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç§‹ç™»ã€‹\nç§‹é«˜æ°”çˆ½ç™»ä¸´å¤„ï¼Œä¸‡é‡Œæ±Ÿå±±ä¸€æœ›æ”¶ã€‚\näº‘æ·¡å¤©æ¸…é¸¿é›è¿‡ï¼Œæ«çº¢èŠè‰³æ¡‚é¦™æµ®ã€‚\né¥æ€æ•…é‡Œæƒ…éš¾å·²ï¼Œç•…å’æ–°è¯—æ„æœªä¼‘ã€‚\nè«é“å¤•é˜³æ— é™å¥½ï¼Œæ¡‘æ¦†æœªæ™šäº¦é£æµã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å†¬æ—¥èµæ¢…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå†¬æ¢…ã€‹\nå¯’å†¬è¸é›ªè®¿æ¢…æ—ï¼Œç‰éª¨å†°è‚Œä¸æŸ“å°˜ã€‚\nç–å½±æ¨ªæ–œå«é›…éŸµï¼Œæš—é¦™æµ®åŠ¨é€æ¸…èŠ¬ã€‚\nå­¤èŠ³è‡ªèµéæœ¬æ„ï¼Œç¾¤è‰³äº‰æ˜¥å²‚æ˜¯å¿ƒã€‚\næ„¿æ•ˆå¯’æ¢…é“®é“®éª¨ï¼Œé£éœœæ„ˆçƒˆå¿—æ„ˆè´ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥æ±Ÿæ™¯è‰²çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥æ±Ÿã€‹\næ˜¥æ±Ÿæ½®æ°´æ¥å¤©æµï¼Œæµ©è¡ä¸œå»åŠ¿æœªä¼‘ã€‚\nä¸¤å²¸æ¡ƒèŠ±æ˜ æ—¥è‰³ï¼Œä¸€è¡Œç™½é¹­é€æ³¢æ¸¸ã€‚\næ¸”èˆŸå”±æ™šå½’å¸†æ€¥ï¼Œç‰§ç¬›å‚¬æ˜è¿”æ£¹é’ã€‚\næœ€æ˜¯ä¸€å¹´æ˜¥å¥½å¤„ï¼Œé£å…‰æ— é™é†‰äººçœ¸ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤å¤œæ˜Ÿç©ºçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤å¤œã€‹\nå¤å¤œæ˜Ÿç©ºç’€ç’¨æ˜ï¼Œé“¶æ²³æ³»åœ°æ´’æ¸…è¹ã€‚\næµè¤ç‚¹ç‚¹ç©¿èŠ±è¿‡ï¼Œè›™é¼“å£°å£°ä¼´æœˆé¸£ã€‚\nç«¹æ¤…è½»æ‘‡æ¶ˆæš‘çƒ­ï¼Œå†°èŒ¶æ…¢å“äº«é—²æƒ…ã€‚\næ­¤é—´è‡ªæœ‰æ¸…å‡‰å¢ƒï¼Œä½•å¿…ç‘¶å°è§…ç‰äº¬ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç§‹é£é€çˆ½çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç§‹é£ã€‹\né‡‘é£é€çˆ½å…¥çª—æ¥ï¼Œæš‘æ°”å…¨æ¶ˆå¿ƒæ‰‰å¼€ã€‚\næ¢§å¶é£˜é»„é“ºé”¦æ¯¯ï¼Œæ¡‚èŠ±åè‰³æº¢é¦™åŸƒã€‚\né•¿ç©ºé›é˜µä¹¦äººå­—ï¼Œæ—·é‡å†œæœºå“è‹¥é›·ã€‚\nåˆæ˜¯ä¸€å¹´ä¸°æ”¶å­£ï¼Œä»“æ»¡å»ªå®ä¹å¼€æ€€ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å†¬æ—¥æ™šæ™´çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå†¬æ™´ã€‹\nè¿é˜´æ•°æ—¥å¿½æ”¾æ™´ï¼Œä¸‡é‡Œæ— äº‘ç¢§ç©ºæ¸…ã€‚\nç§¯é›ªæ¶ˆèéœ²é»‘åœŸï¼Œå¯’å†°ç ´è£‚ç°æ³¢æ˜ã€‚\nè€ç¿è´Ÿæ—¥å¢™æ ¹åï¼Œç¨šå­æºœå†°æ¹–é¢è¡Œã€‚\nè«é“å†¬æ·±æ— ä¹è¶£ï¼Œæ™šæ™´äº¦å¯æ‚¦å¿ƒæƒ…ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥é›¨ç»µç»µçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥é›¨ã€‹\næ˜¥é›¨å¦‚é…¥æ¶¦ç‰©ç”Ÿï¼Œç»µç»µå¯†å¯†ç»†æ— å£°ã€‚\næ¡ƒè…®å«éœ²å¨‡æ¬²æ»´ï¼ŒæŸ³çœ¼åˆå¼€åªšè‡ªç”Ÿã€‚\nè“‘è¡£æ¸”çˆ¶å‚çº¶ä¹ï¼Œæ²¹ä¼ä¹¦ç”Ÿè§…å¥è¡Œã€‚\næœ€å–œä¸°å¹´æ˜¥é›¨è¶³ï¼Œç§‹æ¥å®šæœ‰å¥½æ”¶æˆã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤æ—¥è‰é¸£çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤è‰ã€‹\nç»¿é˜´æ·±å¤„å“è‰é¸£ï¼Œé«˜äº¢æ¿€æ˜‚è¯‰è¡·æƒ…ã€‚\né¥®éœ²é¤é£æ ‡äº®èŠ‚ï¼Œæ –é«˜é¸£è¿œæ˜¾æ¸…å£°ã€‚\nä¸éšç‡•é›€äº‰ç²’ç±³ï¼Œæ•¢å‘é²²é¹è®ºè·¯ç¨‹ã€‚\nè«é“å¾®è™«æ— å¤§å¿—ï¼Œé•¿æ­Œä¸€æ›²ä¹ŸæƒŠå¤©ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç§‹æœˆå¦‚é’©çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç§‹æœˆã€‹\nç§‹å¤œå¤©é«˜æœˆä¼¼é’©ï¼Œæ¸…è¾‰å¦‚æ°´æ´’ä¹å·ã€‚\næ¡‚é¦™æš—åº¦æ²å¿ƒè„¾ï¼Œç«¹å½±è½»æ‘‡åŠ¨å®¢æ„ã€‚\næ¸¸å­æ€ä¹¡æƒ…åˆ‡åˆ‡ï¼Œä½³äººæœ›æœˆæ„æ‚ æ‚ ã€‚\næ„¿å›è«ä½œå¤©æ¶¯å®¢ï¼Œå¸¸ä¼´äº²å¸äº«æ¸©æŸ”ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å†¬é›ªåˆéœçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé›ªéœã€‹\nå¤œé›ªåˆæ™´ä¸‡è±¡æ–°ï¼Œé“¶è£…ç´ è£¹å‡€æ— å°˜ã€‚\nå†°æ£±æŒ‚æªæ™¶è¹é€ï¼Œç‰å±‘é“ºåº­çšæ´çº¯ã€‚\nç¨šå­å †äººç›¸æˆè€ï¼Œè€ç¿æ‰«å¾„è‡ªé€¡å·¡ã€‚\nçº¢æ¢…æ•°ç‚¹é›ªä¸­è‰³ï¼Œé¢„æŠ¥æ˜¥å›å¤§åœ°æ–°ã€‚"</span>
            }
        ]
        <span class="hljs-comment"># å†è¡¥å……20é¦–å››å­£ä¸»é¢˜è¯—</span>
        additional_seasons = [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥è€•æ—¶èŠ‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ˜¥è€•ã€‹\næ˜¥å›å¤§åœ°æš–é£å‚¬ï¼Œå¸ƒè°·å£°å£°ä¿ƒè€•æ¥ã€‚\né“ç‰›è½°é¸£ç¿»æ²ƒåœŸï¼Œé“¶é”„èµ·è½ç§å¸Œæœ›ã€‚\nå†œå¤«æ±—æ´’ç”°å›­é‡Œï¼Œç‡•å­æ³¥è¡”æ¢æ ‹æã€‚\nä½†å¾—ç§‹æ¥ä¸°ç¡•æœï¼Œåƒè¾›ä¸‡è‹¦ä¹Ÿå¼€æ€€ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤æ—¥é‡‡è²çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé‡‡è²ã€‹\nå¤æ—¥è·å¡˜ç¿ è‰²è¿ï¼Œé‡‡è²å¥³å­ç¬‘å¼€é¢œã€‚\nè½»èˆŸè¡ç ´ç‰ç’ƒé•œï¼Œç‰æ‰‹æ‘˜æ¥ç›ç‘™ç›˜ã€‚\næ­Œå½»äº‘éœ„æƒŠç™½é¹­ï¼Œç¬‘ç›ˆæ°´é¢åŠ¨çº¢è•–ã€‚\nå½’æ¥æ»¡è½½æ–œé˜³é‡Œï¼Œä¸€è·¯æ¸…é¦™ä¼´æœˆè¿˜ã€‚"</span>
            },
            <span class="hljs-comment"># ... æ›´å¤šå››å­£è¯—ï¼ˆå…±40é¦–ï¼‰</span>
        ]
        training_data.extend(seasons_poems)
        training_data.extend(additional_seasons)
        
        <span class="hljs-comment"># ==================== å±±æ°´ç”°å›­ (30é¦–) ====================</span>
        landscape_poems = [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå±±æ°´é£å…‰çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå±±æ°´åŸã€‹\né’å±±å ç¿ æ¥äº‘éœï¼Œç¢§æ°´èœ¿èœ’ç»•æ¶§æ¶¯ã€‚\né£ç€‘æ‚¬ç©ºå¦‚ç™½ç»ƒï¼Œå¥‡å³°è€¸ç«‹ä¼¼ä»™å®¶ã€‚\næ¾æ¶›é˜µé˜µä¼ å¹½éŸµï¼Œé¸Ÿè¯­å£°å£°é€é›¾çº±ã€‚\næ„¿æ•ˆé™¶å…¬å½’éšå»ï¼Œç»“åºä»™å¢ƒåº¦å¹´åã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æ±Ÿå—æ°´ä¹¡çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ±Ÿå—æ˜¥ã€‹\næ±Ÿå—æ˜¥è‰²ç¾å¦‚ç”»ï¼Œç»¿æ°´é’å±±æ˜ å½©éœã€‚\nå°æ¡¥æµæ°´äººå®¶é™ï¼Œç»†é›¨æ‰èˆŸæ¸”çˆ¶å“—ã€‚\næ¡ƒçº¢æŸ³ç»¿èºå•¼åºï¼Œæœˆç™½é£æ¸…ç¬›å¥ç¬³ã€‚\nè‹¥é—®äººé—´ä½•å¤„å¥½ï¼Œæ°´ä¹¡ä»™å¢ƒæœ€å ªå¤¸ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå¤§æ¼ é£å…‰çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤§æ¼ è¡Œã€‹\nå¤§æ¼ èŒ«èŒ«æ¥è¿œå¤©ï¼Œé»„æ²™æ»šæ»šæ¼«æ— è¾¹ã€‚\nå­¤çƒŸç›´ä¸Šäº‘éœ„å¤–ï¼Œè½æ—¥æµ‘åœ†åœ°å¹³çº¿ã€‚\né©¼é“ƒå£°å“ä¼ å¹½éŸµï¼Œé¹°éš¼ç›˜æ—‹è§…é‡é²œã€‚\nå£®å£«è¥¿è¡Œåƒä¸‡é‡Œï¼Œè±ªæƒ…å£®å¿—æ»¡èƒ¸é—´ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ç”°å›­ç”Ÿæ´»çš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç”°å›­ä¹ã€‹\nç»“åºäººå¢ƒè¿œå°˜åš£ï¼Œè€•è¯»ä¼ å®¶ä¹é€é¥ã€‚\næ™¨èµ·è·é”„ç†è’ç§½ï¼Œæš®å½’æŠŠé…’è¯æ¸”æ¨µã€‚\né—¨å‰äº”æŸ³éšé£èˆï¼Œå±‹åä¸‰ç•¦è”¬èœå¨‡ã€‚\nè«é“å±±å±…å¤šå¯‚å¯ï¼Œæ¸…æ¬¢è‡ªåœ¨èƒœç‹ä¾¯ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ±Ÿæ²³æ™¯è‰²çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé•¿æ±ŸåŸã€‹\né•¿æ±Ÿæ»šæ»šå‘ä¸œæµï¼Œä¸‡é‡Œå¥”è…¾åŠ¿æœªä¼‘ã€‚\næµªå·åƒå †å¦‚é›ªæ¶Œï¼Œæ¶›å£°é˜µé˜µä¼¼é›·è®´ã€‚\näº‘æ¨ªä¹æ´¾æµ®é»„é¹¤ï¼Œé›¾é”ä¸‰å´ç°ç™½é¸¥ã€‚\nè‡ªå¤è‹±è±ªäº‰æ¸¡å¤„ï¼Œä»Šæœæ›´æ˜¾é£æµç¨ ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å±±æ—å¹½å±…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå±±å±…ã€‹\næ·±å±±ç»“åºè¿œä¿—å°˜ï¼Œæœå¬é¸Ÿè¯­æš®è§‚äº‘ã€‚\nçŸ³æ³‰ç…®èŒ—é¦™ç›ˆå®¤ï¼Œæ¾ç«çƒ¹è‚´å‘³è¯±äººã€‚\né—²æ¥å¯¹å¼ˆæ¶ˆæ°¸æ˜¼ï¼Œå…´è‡³åŸè¯—ä¼´æœˆè½®ã€‚\nè«é—®äººé—´ååˆ©äº‹ï¼Œæ­¤ä¸­çœŸè¶£èƒœåƒé‡‘ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç€‘å¸ƒå¥‡è§‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šè§‚ç€‘ã€‹\nå±å´–ä¸‡ä¸ˆæŒ‚é“¶ç»¡ï¼Œé£ç€‘è½°é¸£éœ‡ä¹éœ„ã€‚\nç‰é¾™å€’æŒ‚æ‚¬ç©ºè½ï¼Œç å¸˜é«˜å‚æ¥åœ°æ‘‡ã€‚\næ°´èŠ±æº…å¤„å½©è™¹ç°ï¼Œé›¾æ°”è…¾æ—¶æš‘æ°”æ¶ˆã€‚\né€ åŒ–ç¥å·¥çœŸç»å¦™ï¼Œä»¤äººè§‚æ­¢èµå£°é«˜ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å±±æ‘æ™šæ™¯çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå±±æ‘ã€‹\nå±±æ‘å‘æ™šæ™¯å°¤ä½³ï¼Œç¼•ç¼•ç‚ŠçƒŸä¸Šç¢§éœã€‚\nç‰§ç¬›å£°ä¸­å½’çŠŠæ€¥ï¼Œæ¸”æ­Œèµ·å¤„è½å¸†æ–œã€‚\nè€ç¿å€šæ–å€™é—¨ç«‹ï¼Œç¨šå­ç‰µè¡£å”¤çˆ¶å“—ã€‚\næœ€æ˜¯äººé—´çƒŸç«æ°”ï¼Œæ¸©é¦¨å’Œç¾èƒœä»™å®¶ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ¹–å…‰å±±è‰²çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ¹–å±±ã€‹\næ¹–å…‰å±±è‰²ä¸¤ç›¸å’Œï¼Œé•œé¢å¹³é“ºç¿ é»›ç½—ã€‚\nç™½é¹­ç¿”é›†æ²™æ¸šé™ï¼Œçº¢è•–æ‘‡åŠ¨ç¢§æ³¢é…¡ã€‚\næ‰èˆŸä¸€å¶äº‘é—´è¡ï¼Œæ¸”å”±æ•°å£°å¤©é™…è¿‡ã€‚\nè‹¥å¾—æ­¤é—´é•¿ä½è¶³ï¼Œä¸æ…•ç‹ä¾¯ä¸ç¾¡ä½›ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æºªæµæ¸…éŸ³çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€ŠæºªéŸ³ã€‹\nå±±æºªæ¸…æ¾ˆçŸ³é—´æµï¼Œç®ç®é“®é“®ä¼¼ä¹å¥ã€‚\nè·³ç æº…ç‰å½¢å¤šå˜ï¼Œç»•å£‘ç©¿å²©åŠ¿æœªä¼‘ã€‚\næ´—è€³å¯æ¶ˆå°˜ä¿—è™‘ï¼Œé™å¿ƒèƒ½è§£å¤ä»Šæ„ã€‚\næ„¿ä½œæºªä¸­ä¸€åµçŸ³ï¼Œé•¿å¬å¤©ç±è‡ªæ‚ æ‚ ã€‚"</span>
            },
            <span class="hljs-comment"># ... æ›´å¤šå±±æ°´ç”°å›­è¯—ï¼ˆå…±30é¦–ï¼‰</span>
        ]
        training_data.extend(landscape_poems)
        
        <span class="hljs-comment"># ==================== æŠ’æƒ…è¨€å¿— (35é¦–) ====================</span>
        emotional_poems = [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ€ä¹¡ä¹‹æƒ…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä¹¡æ„ã€‹\nç‹¬åœ¨å¼‚ä¹¡ä¸ºå¼‚å®¢ï¼Œæ¯é€¢ä½³èŠ‚æ›´æ€äº²ã€‚\nä¸¾å¤´æœ›æœˆå®¶ä¹¡è¿œï¼Œä½å¤´æ€äº²æ³ªæ»¡å·¾ã€‚\nå±±æ°´è¿¢è¿¢å½’è·¯é˜»ï¼ŒéŸ³ä¹¦æ¸ºæ¸ºæ¢¦é­‚é¢‘ã€‚\næ„¿ç”ŸåŒç¿¼ä¹˜é£å»ï¼Œä¸€å¤œé£å›æ•…é‡Œæ˜¥ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å‹æƒ…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€ŠçŸ¥éŸ³ã€‹\näººç”Ÿéš¾å¾—ä¸€çŸ¥éŸ³ï¼Œæµæ°´é«˜å±±æƒ…æ„æ·±ã€‚\nä¿ƒè†é•¿è°ˆå¿˜å¤œæ°¸ï¼Œæ¨å¿ƒç½®è…¹èƒœåƒé‡‘ã€‚\nå±éš¾æ—¶åˆ»ä¼¸æ´æ‰‹ï¼Œæ¬¢ä¹æ—¶å…‰å…±é†‰åŸã€‚\næ„¿æ•ˆç®¡é²çœŸæƒ…è°Šï¼Œé’å²ç•™åä¼ åˆ°ä»Šã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œçˆ±æƒ…ä¸»é¢˜çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç›¸æ€ã€‹\nçº¢è±†ç”Ÿå—å›½ï¼Œæ˜¥æ¥å‘å‡ æã€‚\næ„¿å›å¤šé‡‡æ’·ï¼Œæ­¤ç‰©æœ€ç›¸æ€ã€‚\næœˆä¸‹ç‹¬å¾˜å¾Šï¼Œé£ä¸­ç©ºå¹å’¨ã€‚\nä½³æœŸä½•æ—¥è‡³ï¼Œæºæ‰‹å…±ç‘¶æ± ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™äººç”Ÿæ„Ÿæ…¨çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šäººç”Ÿæ„Ÿæ€€ã€‹\näººç”Ÿå¦‚å¯„å‡ å¤šç§‹ï¼Œå²æœˆåŒ†åŒ†ä¼¼æ°´æµã€‚\nå°‘å£®ä¸çŸ¥å‹¤å­¦æ—©ï¼Œè€æ¥æ–¹æ‚”è¯»ä¹¦ä¼‘ã€‚\nåŠŸååˆ©ç¦„æµ®äº‘è¿‡ï¼Œé“å¾·æ–‡ç« åƒå¤ç•™ã€‚\nçæƒœå…‰é˜´è«è™šåº¦ï¼Œå¥‹å‘å‘ä¸Šæ°¸æ— ä¼‘ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œåŠ±å¿—çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€ŠåŠ±å¿—ã€‹\nå°‘å¹´ç«‹å¿—åœ¨å››æ–¹ï¼Œä¸ç•è‰°éš¾ä¸é›ªéœœã€‚\né“æµç£¨é’ˆç»ˆæœ‰æ—¥ï¼Œç²¾è¯šæ‰€è‡³çŸ³å¼€å¼ ã€‚\nä¹˜é£ç ´æµªæµæ²§æµ·ï¼Œå±•ç¿…é«˜é£è¶Šå…«è’ã€‚\nä»–æ—¥åŠŸæˆåå°±æ—¶ï¼Œä¸ºæ°‘é€ ç¦æ˜¾è£å…‰ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æ€€æ‰ä¸é‡çš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ€€æ‰ã€‹\næ‰é«˜å…«æ–—å¿—å‡Œäº‘ï¼Œå´å›°èŒ…åºæœªé‡å›ã€‚\nå®å‰‘å°˜å°å…‰æ¸æš—ï¼Œè‰¯é©¹å›°å©åŠ›éš¾ä¼¸ã€‚\nä½†å°†å­¦è¯†ä¼ åä¸–ï¼Œä¸”æŠŠè¯—æ–‡ç¤ºä¼—äººã€‚\nä»–æ—¥é£é›·å¦‚é™…ä¼šï¼Œå®šå½“å±•ç¿…ä¸Šé’äº‘ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæŠ¥å›½æƒ…æ€€çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€ŠæŠ¥å›½ã€‹\nç”·å„¿ç”Ÿå½“å¸¦å´é’©ï¼Œæ”¶å–å…³å±±äº”åå·ã€‚\nè¯·å›æš‚ä¸Šå‡ŒçƒŸé˜ï¼Œè‹¥ä¸ªä¹¦ç”Ÿä¸‡æˆ·ä¾¯ï¼Ÿ\né“é©¬å†°æ²³å…¥æ¢¦æ¥ï¼Œé‡‘æˆˆé“é©¬æ°”åç‰›ã€‚\nä½†å¾—å››æµ·å‡å¹³æ—¥ï¼Œè§£ç”²å½’ç”°äº¦é£æµã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å½’éšä¹‹å¿—çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå½’éšã€‹\nå®¦æµ·æµ®æ²‰æ•°åç§‹ï¼Œä»Šæœå½’éšä¹æ‚ æ‚ ã€‚\nç§èŠä¸œç¯±æ•ˆå…ƒäº®ï¼Œè§‚é±¼æ¿ æ°´å­¦å­ä¼‘ã€‚\né—²æ¥å‚é’“ç¢§æºªä¸Šï¼Œå…´è‡³æ¼«æ¸¸ç¿ å²­å¤´ã€‚\nä¸æ…•äººé—´ååˆ©äº‹ï¼Œä½†æ±‚å¿ƒé™è‡ªæ— æ„ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç¦»åˆ«ä¹‹æƒ…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç¦»åˆ«ã€‹\né•¿äº­é€åˆ«æ³ªæ¶Ÿæ¶Ÿï¼Œæ‰§æ‰‹ç›¸çœ‹æ— è¯­å’½ã€‚\næ¨æŸ³ä¾ä¾éš¾ç³»é©¬ï¼Œæµæ°´æ½ºæ½ºæ˜“å‚¬èˆ¹ã€‚\näº‘å±±æ¸ºæ¸ºéŸ³ä¹¦æ–­ï¼Œé›¾è·¯è¿¢è¿¢æ¢¦é­‚ç‰µã€‚\næ„¿å›æ­¤å»å¤šçé‡ï¼Œæ—©å¯„ä½³éŸ³æ…°å¦¾çœ ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™é‡é€¢ä¹‹å–œçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé‡é€¢ã€‹\nåˆ«åç»å¹´å–œé‡é€¢ï¼Œæ‰§æ‰‹ç›¸çœ‹æ³ªçœ¼æœ¦ã€‚\nå®¹é¢œè™½æ”¹æƒ…å¦‚æ—§ï¼Œä¸–äº‹è™½è¿æ„æ›´æµ“ã€‚\nç•…è°ˆå¾€æ˜”æ— ç©·è¶£ï¼Œå±•æœ›æœªæ¥ä¸å°½è£ã€‚\nä»ä»Šæ„¿ä½œé•¿ç›¸èšï¼Œè«å†åˆ†ç¦»å„è¥¿ä¸œã€‚"</span>
            },
            <span class="hljs-comment"># ... æ›´å¤šæŠ’æƒ…è¨€å¿—è¯—ï¼ˆå…±35é¦–ï¼‰</span>
        ]
        training_data.extend(emotional_poems)
        
        <span class="hljs-comment"># ==================== è¾¹å¡é£äº‘ (25é¦–) ====================</span>
        frontier_poems = [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œè¾¹å¡é£å…‰çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¡ä¸Šæ›²ã€‹\nå¤§æ¼ å­¤çƒŸè½æ—¥åœ†ï¼Œè¾¹å…³çƒ½ç«ç…§ç‹¼çƒŸã€‚\nèƒ¡ç¬³å£°é‡Œæ€ä¹¡åˆ‡ï¼Œæˆ˜é¼“å£°ä¸­æ–—å¿—åšã€‚\né“è¡£å†·æ˜ å¯’æœˆå…‰ï¼Œé‡‘æˆˆæ¨ªæ‰«æ•Œå†›å‰ã€‚\nä½†æ±‚å››æµ·å‡å¹³æ—¥ï¼Œè§£ç”²å½’ç”°ç§éº¦æ£‰ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å°†å£«è±ªæƒ…çš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä»å†›è¡Œã€‹\nå°‘å¹´æŠ•ç¬”èµ´è¾¹ç–†ï¼Œèª“ä¿å®¶å›½å«åœŸç–†ã€‚\né“é©¬é‡‘æˆˆå¯’æ•Œèƒ†ï¼Œå¿ å¿ƒèµ¤èƒ†è€€æ—¥å…‰ã€‚\né»„æ²™ç™¾æˆ˜ç©¿é‡‘ç”²ï¼Œä¸ç ´æ•Œè¥ä¸è¿”ä¹¡ã€‚\nä»–æ—¥åŠŸæˆå¥å‡¯æ—¥ï¼Œé”¦è¡£è¿˜ä¹¡æ‹œé«˜å ‚ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæˆ˜äº‰åæ€çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæˆ˜åŸå—ã€‹\næˆ˜é¼“å£°å£°éœ‡ä¹å¤©ï¼Œä¸¤å†›å¯¹å’å®æ€è¿ã€‚\nåˆ€å…‰å‰‘å½±è¡€æˆæ²³ï¼Œé©¬é©è£¹å°¸è°è§æ€œï¼Ÿ\nä¸€å°†åŠŸæˆæ¯ä¸‡éª¨ï¼Œå‡ å®¶å“­å£°å“é‡ç”°ã€‚\næ„¿é”€å…µç”²ä¸ºå†œå™¨ï¼Œå››æµ·å‡å¹³å¤§æœ‰å¹´ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æˆè¾¹æ€ä¹¡çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæˆè¾¹ã€‹\næˆè¾¹å°†å£«å®ˆå…³å±±ï¼Œæœˆå¤œæ€ä¹¡æ³ªæš—æ½¸ã€‚\nå®¶ä¹¦ä¸‡é‡‘éš¾å¾—åˆ°ï¼Œæ¢¦é­‚åƒé‡Œæ˜“å½’è¿˜ã€‚\nä½†æ±‚å››æµ·çƒ½çƒŸé–ï¼Œæ„¿å¼ƒå¹²æˆˆæ•…é‡Œè¿˜ã€‚\nå¾…åˆ°å¤ªå¹³æ— äº‹æ—¥ï¼Œå¤«å¦»å›¢èšäº«æ¸…é—²ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå‡¯æ—‹å½’æ¥çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå‡¯æ—‹ã€‹\nä¸‰å†›å¥å‡¯è¿”å¸äº¬ï¼Œç™¾å§“ç®ªé£Ÿå¤¹é“è¿ã€‚\næˆ˜æ——çŒçŒè¿é£å±•ï¼Œå·è§’å£°å£°å‘å¤©é¸£ã€‚\nå°†å†›é©¬ä¸Šè‹±å§¿çˆ½ï¼Œå£«å’è¡Œåˆ—æ°”åŠ¿å®ã€‚\nä½†å¾—è¾¹ç–†æ°¸å®é™ï¼Œä½•é¡»ä¸‡é‡Œå†å‡ºå¾ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å¤œå·¡è¾¹å…³çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå¤œå·¡ã€‹\nè¾¹å…³æœˆå†·æœ”é£ç‹‚ï¼Œå°†å£«å·¡é€»å¤œæœªå¤®ã€‚\nåˆæ–—å£°ä¼ å¯’å¡è¿œï¼Œæ—Œæ——å½±åŠ¨æˆæ¥¼é•¿ã€‚\nçœ¼è§‚å…­è·¯é˜²æ•Œå¯‡ï¼Œè€³å¬å…«æ–¹å¤‡çªè¢­ã€‚\nä¸ºå›½å®ˆç–†æ— æ€¨æ‚”ï¼Œä¸¹å¿ƒä¸€ç‰‡ç…§å¤©ç½¡ã€‚"</span>
            },
            <span class="hljs-comment"># ... æ›´å¤šè¾¹å¡è¯—ï¼ˆå…±25é¦–ï¼‰</span>
        ]
        training_data.extend(frontier_poems)
        
        <span class="hljs-comment"># ==================== å’ç‰©å¯„æƒ… (30é¦–) ====================</span>
        object_poems = [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå’æ¢…çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’æ¢…ã€‹\nå†°è‚Œç‰éª¨å‚²éœœå¼€ï¼Œç–å½±æ¨ªæ–œæ˜ æœˆæ¥ã€‚\nä¸ä¸ç¾¤èŠ³äº‰è‰³ä¸½ï¼Œç‹¬å‡Œå¯’é›ªæŠ¥æ˜¥å›ã€‚\næ¸…é¦™æš—åº¦æ²å¿ƒè„¾ï¼Œç´ é›…é«˜æ´è¿œä¿—åŸƒã€‚\næ„¿æ•ˆæ¢…èŠ±åšè´å¿—ï¼Œé€†å¢ƒä¹‹ä¸­æ˜¾è‹±æ‰ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å’ç«¹çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’ç«¹ã€‹\nç ´åœŸå‡Œäº‘èŠ‚èŠ‚é«˜ï¼Œè™šå¿ƒåŠ²èŠ‚æ°”é›„è±ªã€‚\né£éœœé›¨é›ªæµ‘ä¸æ€•ï¼Œæ˜¥å¤ç§‹å†¬è‰²ä¸å‡‹ã€‚\néƒ‘ç‡®ç”»ä¸­ç•™åŠ²éª¨ï¼Œä¸ƒè´¤æ—ä¸‹æ˜¾é£éªšã€‚\næ„¿å­¦ç¿ ç«¹åšè´å¿—ï¼Œç›´ä¸Šé’äº‘ä¸æŠ˜è…°ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå’æœˆçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’æœˆã€‹\nçšçšç©ºä¸­å­¤æœˆè½®ï¼Œæ¸…è¾‰éæ´’å‡€æ— å°˜ã€‚\né˜´æ™´åœ†ç¼ºå¾ªå¤©é“ï¼Œç¦»åˆæ‚²æ¬¢å–»ä¸–äººã€‚\næç™½ä¸¾æ¯æˆå¦™å¥ï¼Œä¸œå¡æŠŠé…’é—®å‰å› ã€‚\næ„¿å›å¸¸ä¼¼ä¸­ç§‹æœˆï¼Œåœ†æ»¡å…‰æ˜ç…§å››é‚»ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å’é…’çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’é…’ã€‹\nç¼æµ†ç‰æ¶²å‡ºç³ŸåºŠï¼Œç¥ç€æµå…‰æ»¡å®¤é¦™ã€‚\næç™½ç™¾ç¯‡ç¼˜é†‰å¾—ï¼Œé™¶æ½œä¸‰å¾„å€Ÿé†ªè—ã€‚\nå–œæ—¶åŠ©å…´æ¬¢æƒ…ç•…ï¼Œæ„å¤„æ¶ˆå¿§å—å’å¿˜ã€‚\nä½†å¾—äººç”Ÿå¸¸å°½æ¬¢ï¼Œè«æ•™é‡‘æ¨½ç©ºå¯¹æœˆã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå’æ¾çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’æ¾ã€‹\nå³­å£æ‚¬å´–ä¸€è€æ¾ï¼Œé£éœœé›¨é›ªä»ä»å®¹ã€‚\næ ¹æ·±ä¸æ€•ç‹‚é£åŠ¨ï¼Œå¹²æ­£ä½•å¿§æš´é›¨å†²ã€‚\nå››å­£å¸¸é’æ˜¾åŠ²èŠ‚ï¼Œåƒå¹´ä¸æœ½è§è´å¿ ã€‚\næ„¿å­¦é’æ¾åšæ¯…å¿—ï¼Œè‰°éš¾å›°è‹¦äº¦è±ªé›„ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å’èŠçš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’èŠã€‹\nç§‹æ·±ç™¾å‰å°½å‡‹æ®‹ï¼Œå”¯æœ‰èŠèŠ±å‚²éœœå¯’ã€‚\né‡‘ç”²æ»¡æŠ«é¦™ç›Šè¿œï¼Œç‰è‚Œå¾®éœ²è‰²å°¤ä¸¹ã€‚\nä¸éšæ¡ƒæäº‰æ˜¥è‰³ï¼Œç‹¬ä¼´æ¾æ¢…è€å²å¯’ã€‚\næ„¿æ•ˆé»„èŠ±æ™šèŠ‚é¦™ï¼Œè€å½“ç›Šå£®å¿—å¦‚ç£ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œå’å…°çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’å…°ã€‹\nç©ºè°·å¹½å…°ç‹¬è‡ªèŠ³ï¼Œä¸å› æ— äººå‡é¦¨é¦™ã€‚\nç´ å¿ƒä¸€ç‚¹å«é›…éŸµï¼Œç¿ å¶æ•°èŒå¸¦éœ²å…‰ã€‚\nç¾ä¸ç¾¤è‘©äº‰è‰³ä¸½ï¼Œä¹åŒå›å­è®ºæ–‡ç« ã€‚\næ„¿å­¦å…°èŠ±é«˜æ´å“ï¼Œè¿œç¦»å°˜ä¿—å®ˆæ¸…èŠ³ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™å’å‰‘çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå’å‰‘ã€‹\né¾™æ³‰å‡ºåŒ£å¯’å…‰é—ªï¼Œç™¾ç‚¼åƒé”¤å§‹é“¸æˆã€‚\næ–©å¦–é™¤é­”å‡­æ­£æ°”ï¼Œå®‰é‚¦å®šå›½é ç²¾è¯šã€‚\nåŒ£ä¸­å¤œå¤œé¸£ä¸å·²ï¼Œä¸–ä¸Šæ—¶æ—¶å¾…ä¸å¹³ã€‚\næ„¿å€Ÿä¸‰å°ºé’é”‹å‰‘ï¼Œæ‰«å°½äººé—´é‚ªæ¶æƒ…ã€‚"</span>
            },
            <span class="hljs-comment"># ... æ›´å¤šå’ç‰©è¯—ï¼ˆå…±30é¦–ï¼‰</span>
        ]
        training_data.extend(object_poems)
        
        <span class="hljs-comment"># ==================== èŠ‚æ—¥æ—¶ä»¤ (20é¦–) ====================</span>
        festival_poems = [
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œä¸­ç§‹èµæœˆçš„åŸåˆ›å”è¯—"</span>, 
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä¸­ç§‹ã€‹\nä¸­ç§‹æœˆæœ€æ˜ï¼Œä¸‡é‡Œå…±æ¾„æ¸…ã€‚\né¥¼åœ†å¯“å›¢åœ†ï¼Œç“œæœè¡¨ä¸°ç›ˆã€‚\nä¸¾æ¯é‚€æœˆé¥®ï¼Œå¯¹å½±æˆä¸‰äººã€‚\næ„¿å¾—é•¿å¦‚æ­¤ï¼Œå¹´å¹´ä¹å¤ªå¹³ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™é‡é˜³ç™»é«˜çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šé‡é˜³ã€‹\nä¹ä¹åˆé‡é˜³ï¼Œç™»é«˜æœ›è¿œæ–¹ã€‚\nèŒ±è¸æ’æ»¡é¬“ï¼ŒèŠé…’æº¢æ¸…é¦™ã€‚\näº‘æ·¡å¤©é«˜è¿œï¼Œé£æ¸…é›é˜µé•¿ã€‚\né¥çŸ¥å…„å¼Ÿå¤„ï¼Œåº”äº¦å¿µå®¶ä¹¡ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œæ˜¥èŠ‚å–œåº†çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šå…ƒæ—¥ã€‹\nçˆ†ç«¹å£°ä¸­æ—§å²é™¤ï¼Œæ˜¥é£é€æš–å…¥å± è‹ã€‚\nåƒé—¨ä¸‡æˆ·æ›ˆæ›ˆæ—¥ï¼Œæ€»æŠŠæ–°æ¡ƒæ¢æ—§ç¬¦ã€‚\nå„¿å¥³æ–°è¡£äº‰è‰³ä¸½ï¼Œç¿åªªç¬‘é¥æ˜¾æ¬¢æ„‰ã€‚\nä½†æ±‚å››æµ·å‡å¹³ä¸–ï¼Œå²å²å¦‚ä»Šåº†æœ‰ä½™ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™æ¸…æ˜æ—¶èŠ‚çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šæ¸…æ˜ã€‹\næ¸…æ˜æ—¶èŠ‚é›¨çº·çº·ï¼Œè·¯ä¸Šè¡Œäººæ¬²æ–­é­‚ã€‚\nå€Ÿé—®é…’å®¶ä½•å¤„æœ‰ï¼Œç‰§ç«¥é¥æŒ‡æèŠ±æ‘ã€‚\næ‰«å¢“ç¥­ç¥–æ€å…ˆå¾·ï¼Œè¸é’æ¸¸æ˜¥æ„Ÿç‰©æ©ã€‚\næ…ç»ˆè¿½è¿œä¼ å®¶è®­ï¼Œç»§å¾€å¼€æ¥è€€ç¥–é—¨ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"åˆ›ä½œç«¯åˆç«æ¸¡çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šç«¯åˆã€‹\nç«¯åˆæ—¶èŠ‚é›¨åˆæ™´ï¼Œé¾™èˆŸç«æ¸¡é¼“å£°é¸£ã€‚\nå¥å„¿æŒ¥æ¡¨å¦‚é£ç®­ï¼Œè§‚ä¼—åŠ æ²¹ä¼¼é›·é¸£ã€‚\nç²½å­æŠ•æ±Ÿç¥­å±ˆå­ï¼Œè‰¾è’²æ‚¬æˆ·é¿é‚ªç²¾ã€‚\nä¼ ç»Ÿæ–‡åŒ–é¡»æ‰¿ç»§ï¼Œçˆ±å›½ç²¾ç¥æ°¸ä¼ æ‰¿ã€‚"</span>
            },
            {
                <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"å†™ä¸ƒå¤•ä¹å·§çš„åŸåˆ›å”è¯—"</span>,
                <span class="hljs-string">"output"</span>: <span class="hljs-string">"ã€Šä¸ƒå¤•ã€‹\nä¸ƒå¤•é“¶æ²³æ¶é¹Šæ¡¥ï¼Œç‰›éƒç»‡å¥³ä¼šä»Šå®µã€‚\né‡‘é£ç‰éœ²ä¸€ç›¸é€¢ï¼Œèƒœå´äººé—´æ— æ•°æœã€‚\né—ºä¸­å¥³å­ä¹çµå·§ï¼Œæœˆä¸‹ç©¿é’ˆç«å¦–å¨†ã€‚\nä½†æ„¿æœ‰æƒ…æˆçœ·å±ï¼Œè«æ•™ç¦»åˆ«æ¨è¿¢è¿¢ã€‚"</span>
            },
            <span class="hljs-comment"># ... æ›´å¤šèŠ‚æ—¥è¯—ï¼ˆå…±20é¦–ï¼‰</span>
        ]
        training_data.extend(festival_poems)
   
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f" åˆ›å»ºäº† <span class="hljs-subst">{<span class="hljs-built_in">len</span>(training_data)}</span> é¦–é«˜è´¨é‡å”è¯—è®­ç»ƒæ•°æ®"</span>)
        <span class="hljs-keyword">return</span> training_data
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_lora</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""é…ç½®LoRA"""</span>
        lora_config = LoraConfig(
            r=<span class="hljs-number">16</span>,                    <span class="hljs-comment"># é€‚å½“å¢åŠ ç§©</span>
            lora_alpha=<span class="hljs-number">32</span>,
            target_modules=[<span class="hljs-string">"q_proj"</span>, <span class="hljs-string">"v_proj"</span>, <span class="hljs-string">"k_proj"</span>, <span class="hljs-string">"o_proj"</span>],
            lora_dropout=<span class="hljs-number">0.1</span>,        <span class="hljs-comment"># é™ä½dropout</span>
            bias=<span class="hljs-string">"none"</span>,
            task_type=<span class="hljs-string">"CAUSAL_LM"</span>
        )
        
        self.model = get_peft_model(self.model, lora_config)
        self.model.print_trainable_parameters()
        <span class="hljs-keyword">return</span> self.model
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">prepare_dataset</span>(<span class="hljs-params">self, training_data</span>):
        <span class="hljs-string">"""å‡†å¤‡è®­ç»ƒæ•°æ®é›†"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" å¤„ç†è®­ç»ƒæ•°æ®..."</span>)
        
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">format_example</span>(<span class="hljs-params">example</span>):
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">"text"</span>: <span class="hljs-string">f"è¯·åˆ›ä½œä¸€é¦–å”è¯—ï¼š<span class="hljs-subst">{example[<span class="hljs-string">'instruction'</span>]}</span>\n\nä½œå“ï¼š<span class="hljs-subst">{example[<span class="hljs-string">'output'</span>]}</span>"</span>
            }
        
        dataset = Dataset.from_list(training_data)
        formatted_dataset = dataset.<span class="hljs-built_in">map</span>(format_example)
        
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_function</span>(<span class="hljs-params">examples</span>):
            <span class="hljs-keyword">return</span> self.tokenizer(
                examples[<span class="hljs-string">"text"</span>],
                truncation=<span class="hljs-literal">True</span>,
                padding=<span class="hljs-string">"max_length"</span>,
                max_length=<span class="hljs-number">400</span>,
                return_tensors=<span class="hljs-literal">None</span>
            )
        
        tokenized_dataset = formatted_dataset.<span class="hljs-built_in">map</span>(
            tokenize_function,
            batched=<span class="hljs-literal">True</span>,
            remove_columns=formatted_dataset.column_names
        )
        
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" æ•°æ®é¢„å¤„ç†å®Œæˆ"</span>)
        <span class="hljs-keyword">return</span> tokenized_dataset
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">train</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""æ‰§è¡Œè®­ç»ƒ"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" å¼€å§‹è®­ç»ƒ..."</span>)
        
        <span class="hljs-comment"># è®¾ç½®è®­ç»ƒå‚æ•°</span>
        training_args = TrainingArguments(
            output_dir=<span class="hljs-string">"./tang_poetry_lora"</span>,
            per_device_train_batch_size=<span class="hljs-number">2</span>,
            gradient_accumulation_steps=<span class="hljs-number">1</span>,
            learning_rate=<span class="hljs-number">2e-4</span>,          <span class="hljs-comment"># ä¼˜åŒ–å­¦ä¹ ç‡</span>
            num_train_epochs=<span class="hljs-number">20</span>,         <span class="hljs-comment"># å……åˆ†è®­ç»ƒ</span>
            logging_steps=<span class="hljs-number">5</span>,
            save_steps=<span class="hljs-number">50</span>,
            
            <span class="hljs-comment"># ä¼˜åŒ–é…ç½®</span>
            warmup_steps=<span class="hljs-number">50</span>,
            weight_decay=<span class="hljs-number">0.01</span>,
            lr_scheduler_type=<span class="hljs-string">"cosine"</span>,
            max_grad_norm=<span class="hljs-number">1.0</span>,           <span class="hljs-comment"># æ¢¯åº¦è£å‰ª</span>
            
            remove_unused_columns=<span class="hljs-literal">False</span>,
            dataloader_pin_memory=<span class="hljs-literal">False</span>,
            report_to=[],
        )
        
        data_collator = DataCollatorForLanguageModeling(
            tokenizer=self.tokenizer,
            mlm=<span class="hljs-literal">False</span>
        )
        
        tokenized_dataset = self.prepare_dataset(self.create_training_data())
        
        trainer = Trainer(
            model=self.model,
            args=training_args,
            train_dataset=tokenized_dataset,
            data_collator=data_collator,
        )
        
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" å¼€å§‹æ¨¡å‹è®­ç»ƒ..."</span>)
        train_result = trainer.train()
        
        <span class="hljs-comment"># ä¿å­˜æ¨¡å‹</span>
        trainer.save_model()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" è®­ç»ƒå®Œæˆï¼æ¨¡å‹å·²ä¿å­˜"</span>)
        
        <span class="hljs-keyword">return</span> train_result
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_poem</span>(<span class="hljs-params">self, instruction, max_retry=<span class="hljs-number">3</span></span>):
        <span class="hljs-string">"""ç”Ÿæˆè¯—æ­Œï¼ˆå¸¦é‡è¯•æœºåˆ¶ï¼‰"""</span>
        <span class="hljs-keyword">for</span> attempt <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(max_retry):
            <span class="hljs-keyword">try</span>:
                prompt = <span class="hljs-string">f"è¯·åˆ›ä½œä¸€é¦–å”è¯—ï¼š<span class="hljs-subst">{instruction}</span>\n\nä½œå“ï¼š"</span>
                inputs = self.tokenizer(prompt, return_tensors=<span class="hljs-string">"pt"</span>, max_length=<span class="hljs-number">200</span>, truncation=<span class="hljs-literal">True</span>)
                
                <span class="hljs-keyword">with</span> torch.no_grad():
                    outputs = self.model.generate(
                        **inputs,
                        max_new_tokens=<span class="hljs-number">150</span>,
                        temperature=<span class="hljs-number">0.7</span>,          <span class="hljs-comment"># é€‚ä¸­æ¸©åº¦</span>
                        do_sample=<span class="hljs-literal">True</span>,
                        top_p=<span class="hljs-number">0.9</span>,
                        top_k=<span class="hljs-number">40</span>,
                        repetition_penalty=<span class="hljs-number">1.3</span>,   <span class="hljs-comment"># é˜²æ­¢é‡å¤</span>
                        no_repeat_ngram_size=<span class="hljs-number">3</span>,
                        pad_token_id=self.tokenizer.eos_token_id,
                        eos_token_id=self.tokenizer.eos_token_id,
                        early_stopping=<span class="hljs-literal">True</span>,
                        num_return_sequences=<span class="hljs-number">1</span>
                    )
                
                full_text = self.tokenizer.decode(outputs[<span class="hljs-number">0</span>], skip_special_tokens=<span class="hljs-literal">True</span>)
                
                <span class="hljs-comment"># æå–è¯—æ­Œéƒ¨åˆ†</span>
                <span class="hljs-keyword">if</span> <span class="hljs-string">"ä½œå“ï¼š"</span> <span class="hljs-keyword">in</span> full_text:
                    poem = full_text.split(<span class="hljs-string">"ä½œå“ï¼š"</span>)[-<span class="hljs-number">1</span>].strip()
                <span class="hljs-keyword">else</span>:
                    poem = full_text
                
                <span class="hljs-comment"># è´¨é‡æ£€æŸ¥</span>
                <span class="hljs-keyword">if</span> self._check_poem_quality(poem):
                    <span class="hljs-keyword">return</span> poem
                <span class="hljs-keyword">else</span>:
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f" ç¬¬<span class="hljs-subst">{attempt+<span class="hljs-number">1</span>}</span>æ¬¡ç”Ÿæˆè´¨é‡ä¸ä½³ï¼Œé‡è¯•..."</span>)
                    
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f" ç”Ÿæˆå‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ç”Ÿæˆå¤±è´¥ï¼Œè¯·è°ƒæ•´å‚æ•°é‡è¯•"</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_poem_quality</span>(<span class="hljs-params">self, poem</span>):
        <span class="hljs-string">"""æ£€æŸ¥è¯—æ­Œè´¨é‡"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> poem <span class="hljs-keyword">or</span> <span class="hljs-built_in">len</span>(poem) &lt; <span class="hljs-number">10</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
            
        lines = poem.strip().split(<span class="hljs-string">'\n'</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines) &lt; <span class="hljs-number">2</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
            
        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æœ‰ä¸¥é‡é‡å¤</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(lines)) &lt; <span class="hljs-built_in">len</span>(lines) * <span class="hljs-number">0.5</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
            
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">comprehensive_test</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""å…¨é¢æµ‹è¯•"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">" å…¨é¢æµ‹è¯• "</span>.center(<span class="hljs-number">50</span>, <span class="hljs-string">"="</span>))
        
        test_cases = [
            <span class="hljs-string">"æ˜¥æ—¥æ¸¸å›­"</span>,
            <span class="hljs-string">"å¤æ—¥è·å¡˜"</span>,
            <span class="hljs-string">"ç§‹æ—¥ç™»é«˜"</span>, 
            <span class="hljs-string">"å†¬æ—¥èµé›ª"</span>,
            <span class="hljs-string">"å±±æ°´é£å…‰"</span>,
            <span class="hljs-string">"æ€ä¹¡ä¹‹æƒ…"</span>,
            <span class="hljs-string">"å‹è°Šé•¿å­˜"</span>,
            <span class="hljs-string">"å’æ¢…å“æ ¼"</span>
        ]
        
        <span class="hljs-keyword">for</span> i, theme <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(test_cases, <span class="hljs-number">1</span>):
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næµ‹è¯• <span class="hljs-subst">{i}</span>: <span class="hljs-subst">{theme}</span>"</span>)
            poem = self.generate_poem(theme)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”Ÿæˆç»“æœ:\n<span class="hljs-subst">{poem}</span>"</span>)
            
            <span class="hljs-comment"># è´¨é‡è¯„ä¼°</span>
            lines = poem.strip().split(<span class="hljs-string">'\n'</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines) &gt;= <span class="hljs-number">4</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(lines)) &gt;= <span class="hljs-number">3</span>:
                quality = <span class="hljs-string">"âœ… è´¨é‡è‰¯å¥½"</span>
            <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(lines) &gt;= <span class="hljs-number">2</span>:
                quality = <span class="hljs-string">"âš ï¸ è´¨é‡ä¸€èˆ¬"</span>
            <span class="hljs-keyword">else</span>:
                quality = <span class="hljs-string">"âŒ éœ€è¦ä¼˜åŒ–"</span>
                
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è´¨é‡è¯„ä¼°: <span class="hljs-subst">{quality}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">40</span>)
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">explain_poem</span>(<span class="hljs-params">self, poem</span>):
        <span class="hljs-string">"""è°ƒç”¨æ¨¡å‹è§£é‡Šè¯—å¥å†…å®¹ï¼Œä»…è¾“å‡ºå¯¹è¯—å¥åœºæ™¯çš„è¯´æ˜"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> poem <span class="hljs-keyword">or</span> <span class="hljs-built_in">len</span>(poem.strip()) == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"æ— è¯—å¥å¯è§£é‡Š"</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># ä¸´æ—¶åŠ è½½åŸå§‹æ¨¡å‹ï¼ˆéå¾®è°ƒæ¨¡å‹ï¼‰</span>
            original_model = AutoModelForCausalLM.from_pretrained(
                self.local_model_path2,
                trust_remote_code=<span class="hljs-literal">True</span>,
                torch_dtype=torch.float32,
                device_map=self.device
            )
            prompt = (
                <span class="hljs-string">"è¯·ç”¨ä¸€æ®µç°ä»£æ±‰è¯­è§£é‡Šä»¥ä¸‹è¯—å¥ä¸­å‘ˆç°çš„åœºæ™¯ï¼Œ200å­—ä»¥å†…"</span>
                <span class="hljs-string">"ä»…æè¿°ç”»é¢ï¼Œä¸è¦åˆ†ææƒ…æ„Ÿæˆ–æ‰©å±•å…¶ä»–å†…å®¹ï¼š\n\n"</span>
                <span class="hljs-string">f"ã€è¯—å¥ã€‘\n<span class="hljs-subst">{poem}</span>\n"</span>
                <span class="hljs-string">"ã€è§£é‡Šã€‘"</span>
            )
            inputs = self.tokenizer(prompt, return_tensors=<span class="hljs-string">"pt"</span>, max_length=<span class="hljs-number">200</span>, truncation=<span class="hljs-literal">True</span>)
            <span class="hljs-keyword">with</span> torch.no_grad():
                outputs = original_model.generate(
                    **inputs,
                    max_new_tokens=<span class="hljs-number">200</span>,  <span class="hljs-comment"># é™åˆ¶ç”Ÿæˆé•¿åº¦</span>
                    temperature=<span class="hljs-number">0.3</span>,    <span class="hljs-comment"># è¿›ä¸€æ­¥é™ä½éšæœºæ€§</span>
                    do_sample=<span class="hljs-literal">True</span>,
                    top_p=<span class="hljs-number">0.7</span>,
                    repetition_penalty=<span class="hljs-number">1.5</span>,  <span class="hljs-comment"># å‡å°‘é‡å¤å†…å®¹</span>
                    eos_token_id=self.tokenizer.eos_token_id,
                    early_stopping=<span class="hljs-literal">True</span>,
                )
            explanation = self.tokenizer.decode(outputs[<span class="hljs-number">0</span>], skip_special_tokens=<span class="hljs-literal">True</span>)
            
            <span class="hljs-comment"># ä¸¥æ ¼æ¸…ç†ï¼šä»…ä¿ç•™ã€è§£é‡Šã€‘åçš„å†…å®¹ï¼Œå¹¶å»é™¤æ— å…³æ–‡æœ¬</span>
            explanation = explanation.split(<span class="hljs-string">"ã€è§£é‡Šã€‘"</span>)[-<span class="hljs-number">1</span>].strip()
            explanation = re.sub(<span class="hljs-string">r"\n|"</span>  <span class="hljs-comment"># å»é™¤æ¢è¡Œå’Œæ— å…³ç¬¦å·</span>
                                <span class="hljs-string">r"Human:.*|Assistant:.*|"</span>
                                <span class="hljs-string">r"A:.*|B:.*|"</span>  <span class="hljs-comment"># å»é™¤å¯¹è¯æ ‡è®°</span>
                                <span class="hljs-string">r"\d{4}å¹´.*|è°¢è°¢.*|è¯·é—®.*"</span>, 
                                <span class="hljs-string">""</span>, explanation)
            <span class="hljs-keyword">return</span> explanation <span class="hljs-keyword">if</span> explanation <span class="hljs-keyword">else</span> <span class="hljs-string">"è§£é‡Šç”Ÿæˆå¤±è´¥"</span>
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"è§£é‡Šå¤±è´¥ï¼š<span class="hljs-subst">{e}</span>"</span>
            explanation = self.tokenizer.decode(outputs[<span class="hljs-number">0</span>], skip_special_tokens=<span class="hljs-literal">True</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è§£é‡Šç»“æœï¼š\n<span class="hljs-subst">{explanation}</span>"</span>)
            <span class="hljs-comment"># ä¸¥æ ¼æ¸…ç†ï¼šä»…ä¿ç•™ã€è§£é‡Šã€‘åçš„å†…å®¹ï¼Œå¹¶å»é™¤æ— å…³æ–‡æœ¬</span>
            explanation = explanation.split(<span class="hljs-string">"ã€è§£é‡Šã€‘"</span>)[-<span class="hljs-number">1</span>].strip()
            explanation = re.sub(<span class="hljs-string">r"\n|"</span>  <span class="hljs-comment"># å»é™¤æ¢è¡Œå’Œæ— å…³ç¬¦å·</span>
                                <span class="hljs-string">r"Human:.*|Assistant:.*|"</span>
                                <span class="hljs-string">r"\d{4}å¹´.*|è°¢è°¢.*|è¯·é—®.*"</span>, 
                                <span class="hljs-string">""</span>, explanation)
            <span class="hljs-keyword">return</span> explanation <span class="hljs-keyword">if</span> explanation <span class="hljs-keyword">else</span> <span class="hljs-string">"è§£é‡Šç”Ÿæˆå¤±è´¥"</span>
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"è§£é‡Šå¤±è´¥ï¼š<span class="hljs-subst">{e}</span>"</span>
            
            outputs = original_model.generate(
                **inputs,
                max_new_tokens=<span class="hljs-number">150</span>,
                temperature=<span class="hljs-number">0.5</span>,
                do_sample=<span class="hljs-literal">True</span>,
                top_p=<span class="hljs-number">0.8</span>,
                repetition_penalty=<span class="hljs-number">1.25</span>,
                no_repeat_ngram_size=<span class="hljs-number">3</span>,
                pad_token_id=self.tokenizer.eos_token_id,
                eos_token_id=self.tokenizer.eos_token_id,
                early_stopping=<span class="hljs-literal">True</span>,
            )
            explanation = self.tokenizer.decode(outputs[<span class="hljs-number">0</span>], skip_special_tokens=<span class="hljs-literal">True</span>)
            explanation = re.sub(<span class="hljs-string">r"Human:.*|Assistant:.*|ï¼ˆ.*"</span>, <span class="hljs-string">""</span>, explanation).strip()

            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è§£é‡Šç»“æœï¼š\n<span class="hljs-subst">{explanation}</span>"</span>)
            <span class="hljs-comment"># æ¸…ç†è¾“å‡º</span>
            lines = [l.strip() <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> poem.split(<span class="hljs-string">'\n'</span>) <span class="hljs-keyword">if</span> l.strip()]
            <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> lines:
                <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(l) &gt; <span class="hljs-number">0</span>:
                    explanation = explanation.replace(l, <span class="hljs-string">""</span>)
            <span class="hljs-comment"># å»æ‰ä¹¦åå·æ ‡é¢˜</span>
            explanation = re.sub(<span class="hljs-string">r"ã€Š[^ã€‹]+ã€‹"</span>, <span class="hljs-string">""</span>, explanation)
            <span class="hljs-comment"># å½’ä¸€åŒ–ä¸ºå•æ®µ</span>
            explanation = re.sub(<span class="hljs-string">r"\s+"</span>, <span class="hljs-string">" "</span>, explanation.replace(<span class="hljs-string">"\n"</span>, <span class="hljs-string">" "</span>)).strip()

            <span class="hljs-comment"># å…œåº•ï¼šè‹¥ä»ä¸ºç©ºï¼Œç»™é€šç”¨è§£é‡Š</span>
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(explanation) &lt; <span class="hljs-number">30</span>:
                explanation = <span class="hljs-string">"è¿™é¦–è¯—é€šè¿‡å…¸å‹æ„è±¡ä¸åœºæ™¯çš„æå†™ï¼Œä¼ è¾¾äº†ä½œè€…çš„æƒ…æ„Ÿå–å‘ä¸å®¡ç¾è¶£å‘³ï¼Œå€Ÿæ™¯æŠ’æƒ…ã€ä»¥ç‰©å¯„æ„ï¼Œå½¢æˆå«è“„è€Œæ‚ è¿œçš„æ„å¢ƒï¼Œè¯»æ¥æ¸…æ–°è‡ªç„¶ã€éŸµå‘³ç»µé•¿ã€‚"</span>
            <span class="hljs-keyword">return</span> explanation
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"è§£é‡Šå¤±è´¥ï¼š<span class="hljs-subst">{e}</span>"</span>
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">build_gradio</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""æ„å»ºGradioç•Œé¢ï¼šä¸»é¢˜é€‰æ‹© + ç®€å•æè¿°ï¼ˆç•™ç©ºåˆ™é»˜è®¤ï¼‰ï¼Œç”Ÿæˆè¯—å¥ä¸å•æ®µè§£é‡Š"""</span>
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">theme, desc, need_explain</span>):
            theme_map = {
                <span class="hljs-string">"å››å­£å˜æ¢"</span>: <span class="hljs-string">"æ˜¥å¤ç§‹å†¬è½®æ¢"</span>,
                <span class="hljs-string">"å±±æ°´ç”°å›­"</span>: <span class="hljs-string">"å±±æ°´ç”°å›­é£å…‰"</span>,
                <span class="hljs-string">"æŠ’æƒ…è¨€å¿—"</span>: <span class="hljs-string">"æŠ’æƒ…è¨€å¿—"</span>,
                <span class="hljs-string">"è¾¹å¡é£äº‘"</span>: <span class="hljs-string">"è¾¹å¡é£äº‘"</span>,
                <span class="hljs-string">"å’ç‰©å¯„æƒ…"</span>: <span class="hljs-string">"å’ç‰©å¯„æƒ…"</span>,
                <span class="hljs-string">"èŠ‚æ—¥æ—¶ä»¤"</span>: <span class="hljs-string">"èŠ‚æ—¥æ—¶ä»¤"</span>
            }
            default_desc = {
                <span class="hljs-string">"å››å­£å˜æ¢"</span>: <span class="hljs-string">"æå†™æ˜¥å¤ç§‹å†¬æ°”å€™ä¸æ™¯ç‰©å˜è¿ï¼Œè¡¨ç°ç”Ÿå‘½è½®å›çš„éŸµå¾‹ã€‚"</span>,
                <span class="hljs-string">"å±±æ°´ç”°å›­"</span>: <span class="hljs-string">"å€Ÿé’å±±ç¢§æ°´ä¸ç”°å›­åŠ³ä½œï¼ŒæŠ’å†™æ¬æ·¡å®é™çš„ç”Ÿæ´»æƒ…è¶£ã€‚"</span>,
                <span class="hljs-string">"æŠ’æƒ…è¨€å¿—"</span>: <span class="hljs-string">"ç›´æ¥æŠ’å‘å†…å¿ƒæƒ…æ„Ÿä¸å¿—å‘ï¼Œè¡¨è¾¾äººç”Ÿç†æƒ³ä¸æ„Ÿæ€€ã€‚"</span>,
                <span class="hljs-string">"è¾¹å¡é£äº‘"</span>: <span class="hljs-string">"æç»˜è¾¹å…³æ²™åœºä¸å°†å£«é£éª¨ï¼Œå±•ç°å®¶å›½æƒ…æ€€ä¸æˆè¾¹è‰°è¾›ã€‚"</span>,
                <span class="hljs-string">"å’ç‰©å¯„æƒ…"</span>: <span class="hljs-string">"æ‰˜ç‰©è¨€å¿—ï¼Œé€šè¿‡æ¢…ç«¹æ¾èŠç­‰æ„è±¡å¯„å¯“å“æ ¼ä¸æƒ…æ€€ã€‚"</span>,
                <span class="hljs-string">"èŠ‚æ—¥æ—¶ä»¤"</span>: <span class="hljs-string">"å›´ç»•ä¼ ç»ŸèŠ‚ä»¤ä¹ ä¿—ä¸äººæƒ…ä¸–äº‹ï¼Œä¹¦å†™å›¢åœ†ã€è¿½å¿†ä¸ç¥ˆæ„¿ã€‚"</span>
            }
            base = theme_map.get(theme, theme)
            desc_text = (desc <span class="hljs-keyword">or</span> <span class="hljs-string">""</span>).strip() <span class="hljs-keyword">or</span> default_desc.get(theme, <span class="hljs-string">""</span>)
            instruction = <span class="hljs-string">f"ä¸»é¢˜ï¼š<span class="hljs-subst">{base}</span>ã€‚ç®€è¿°ï¼š<span class="hljs-subst">{desc_text}</span>"</span>
            poem = self.generate_poem(instruction)
            explanation = self.explain_poem(poem) <span class="hljs-keyword">if</span> need_explain <span class="hljs-keyword">else</span> <span class="hljs-string">"ï¼ˆæœªé€‰æ‹©è§£é‡Šï¼‰"</span>
            <span class="hljs-keyword">return</span> poem, explanation
        
        dropdown = gr.Dropdown(choices=[<span class="hljs-string">"å››å­£å˜æ¢"</span>,<span class="hljs-string">"å±±æ°´ç”°å›­"</span>,<span class="hljs-string">"æŠ’æƒ…è¨€å¿—"</span>,<span class="hljs-string">"è¾¹å¡é£äº‘"</span>,<span class="hljs-string">"å’ç‰©å¯„æƒ…"</span>,<span class="hljs-string">"èŠ‚æ—¥æ—¶ä»¤"</span>], label=<span class="hljs-string">"ä¸»é¢˜"</span>)
        textbox = gr.Textbox(lines=<span class="hljs-number">2</span>, placeholder=<span class="hljs-string">"ä¾‹å¦‚ï¼šæ˜¥é›¨ã€è·å¡˜ã€æ€ä¹¡ã€å’æ¢…ç­‰ç®€è¦æè¿°ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤ï¼‰"</span>, label=<span class="hljs-string">"ç®€å•æè¿°"</span>)
        checkbox = gr.Checkbox(label=<span class="hljs-string">"ç”Ÿæˆè§£é‡Š"</span>, value=<span class="hljs-literal">True</span>)
        output_poem = gr.Textbox(lines=<span class="hljs-number">8</span>, label=<span class="hljs-string">"ç”Ÿæˆè¯—å¥"</span>)
        output_exp = gr.Textbox(lines=<span class="hljs-number">6</span>, label=<span class="hljs-string">"è¯—å¥è§£é‡Šï¼ˆå•æ®µï¼‰"</span>)
        
        iface = gr.Interface(
            fn=generate,
            inputs=[dropdown, textbox, checkbox],
            outputs=[output_poem, output_exp],
            title=<span class="hljs-string">"å”è¯—ç”Ÿæˆå™¨ï¼ˆLoRAå¾®è°ƒï¼‰"</span>,
            description=<span class="hljs-string">"é€‰æ‹©ä¸»é¢˜å¹¶å¯å¡«å†™ç®€è¿°ï¼›ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤æè¿°ã€‚è§£é‡Šä»…è¾“å‡ºä¸€æ®µç°ä»£æ±‰è¯­è¯´æ˜ã€‚"</span>
        )
        <span class="hljs-keyword">return</span> iface

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-string">"""ä¸»å‡½æ•°"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">" å”è¯—LoRAå¾®è°ƒç³»ç»Ÿå¯åŠ¨"</span>)
    
    <span class="hljs-comment"># è§£æå‘½ä»¤è¡Œå‚æ•°</span>
    parser = argparse.ArgumentParser()
    parser.add_argument(<span class="hljs-string">"--skip-training"</span>, action=<span class="hljs-string">"store_true"</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">"å·²è®­ç»ƒæ¨¡å‹æ—¶è·³è¿‡è®­ç»ƒï¼Œç›´æ¥æµ‹è¯•"</span>)
    args = parser.parse_args()

    <span class="hljs-comment"># åˆå§‹åŒ–è®­ç»ƒå™¨</span>
    <span class="hljs-comment"># trainer = TangPoetryTrainer(skip_training=args.skip_training)</span>
    trainer = TangPoetryTrainer(skip_training=<span class="hljs-literal">True</span>)
    
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> trainer.skip_training:
        <span class="hljs-comment"># æ­£å¸¸æµç¨‹ï¼šåŠ è½½åŸºåº§æ¨¡å‹ä¸LoRAå¹¶è®­ç»ƒ</span>
        trainer.setup_model()
        trainer.setup_lora()
        trainer.train()
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># è·³è¿‡è®­ç»ƒï¼šç›´æ¥åŠ è½½å·²è®­ç»ƒæ¨¡å‹</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">" è·³è¿‡è®­ç»ƒï¼Œç›´æ¥åŠ è½½å·²è®­ç»ƒæ¨¡å‹è¿›è¡Œæµ‹è¯•"</span>)
        trainer.load_trained_model(<span class="hljs-string">"./tang_poetry_lora"</span>)
    
    <span class="hljs-comment"># å¯åŠ¨Gradioç•Œé¢</span>
    iface = trainer.build_gradio()
    iface.launch(server_name=<span class="hljs-string">"0.0.0.0"</span>, share=<span class="hljs-literal">False</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n ç¨‹åºæ‰§è¡Œå®Œæˆï¼"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    main()
</code></pre>
<p><img alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" src="" loading="lazy"/></p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[IDEA Claude Code or Codex GUI æ’ä»¶ã€å¼€æºè‡ªèã€‘]]></title>    <link>https://juejin.cn/post/7592912896591216659</link>    <guid>https://juejin.cn/post/7592912896591216659</guid>    <pubDate>2026-01-09T02:48:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592912896591216659" data-draft-id="7592865044692107270" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="IDEA Claude Code or Codex GUI æ’ä»¶ã€å¼€æºè‡ªèã€‘"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,GitHub"/> <meta itemprop="datePublished" content="2026-01-09T02:48:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ±æ˜†é¹"/> <meta itemprop="url" content="https://juejin.cn/user/2788017219055175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            IDEA Claude Code or Codex GUI æ’ä»¶ã€å¼€æºè‡ªèã€‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2788017219055175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ±æ˜†é¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:48:51.000Z" title="Fri Jan 09 2026 02:48:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€.å‰è¨€ä»‹ç»</h2>
<h3 data-id="heading-1">1.é¡¹ç›®äº§ç”ŸåŸå› </h3>
<p>æˆ‘ä½¿ç”¨claude codeæ¯”è¾ƒé¢‘ç¹ï¼Œè¿‘æœŸæœ‰ä½¿ç”¨IDEAæ’ä»¶çš„éœ€æ±‚ï¼Œæˆ‘å‘ç°IDEAæ’ä»¶ä¸­æ²¡æœ‰ä¸€ä¸ªå¯è§†åŒ–æ“ä½œclaude codeçš„å·¥å…·ï¼Œvscodeä¸­å®˜æ–¹å·²ç»æœ‰äº†ï¼Œè¿™è®©æˆ‘å¾ˆå¥‡æ€ªï¼Œäºæ˜¯å¼€å§‹ç€æ‰‹åšäº†ä¸€ä¸‹ï¼Œç»è¿‡ä¸€ä¸ªæœˆçš„è¿­ä»£ï¼Œç›®å‰å·²ç»æ¯”è¾ƒå®Œå–„äº†ï¼Œåˆ†äº«ç»™å¤§å®¶ä½¿ç”¨</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c46c3dade558492a846f99bfcad6aa36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=bdZFBvoEJ8rWZ5OW7dXCYJtDhiE%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">å¼€æºåœ°å€</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzhukunpenglinyutong%2Fidea-claude-code-gui" target="_blank" title="https://github.com/zhukunpenglinyutong/idea-claude-code-gui" ref="nofollow noopener noreferrer">github.com/zhukunpenglâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12f403277d0e4898a8ecbba3ecacccdb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=Nqjfcvf%2FrSsdx19Js8%2B4Qjvenqk%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">å•†åº—åŒ…ä¸‹è½½åœ°å€</h3>
<p>æœ¬æ’ä»¶å·²ä¸Šæ¶ Jetbrains å¸‚åœºï¼Œæœç´¢claude code gui å®‰è£…å³å¯</p>
<p>æœ¬é¡¹ç›®ä¸å«ä»»ä½•å•†ä¸šåŒ–å†…å®¹å’Œé¢å¤–æ¥å£ï¼Œçº¯è§†å›¾å±‚GUIï¼Œè¯·æ”¾å¿ƒä½¿ç”¨</p>
<blockquote>
<p>å£°æ˜ï¼šæ”¿åºœéƒ¨é—¨ï¼Œå›½ä¼ï¼Œå­¦æ ¡ ä¿®æ”¹æœ¬é¡¹ç›®ä»£ç ï¼Œå¯éµå¾ªMITåè®®ï¼Œä¸éœ€è¦éµå®ˆAGPL-3.0åè®®</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8baf1f3a9439456ea72cc9f46540bce7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=s49f0%2BKAycT7TSg%2BZ0Ji9CwAq9Y%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-4">äºŒ.åŠŸèƒ½ä»‹ç»</h2>
<h3 data-id="heading-5">1.è¾“å…¥æ¡†</h3>
<blockquote>
<p>1.æ”¯æŒéå¸¸ä¼˜é›…çš„æ–‡ä»¶å¼•ç”¨å±•ç¤º</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/219591197a334a7e8d9c3929eb108552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=6Km9JjdMPMYAs6vSHWClGccyaRM%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>2.æ”¯æŒæ¨¡å¼åˆ‡æ¢</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96f6ba50c8524ee5906e0b876c7ef422~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=DCLxT7%2F0nl%2BWsjQ%2FvkUrAizfPY8%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>3.æ”¯æŒæ¨¡å‹åˆ‡æ¢ï¼ˆæ”¯æŒæ˜ å°„ï¼Œå¯æ˜ å°„ä¸ºGLMæ¨¡å‹å‹å·ï¼‰</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3baeddebb43b4d588986c82b1098ebe5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=oC%2FjrGvt7Epr%2BQL6f5tEPsEQnqY%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>4.æ›´å¤šåŠŸèƒ½ï¼ˆæ€è€ƒï¼Œæ™ºèƒ½ä½“ï¼Œä¾›åº”å•†ï¼ŒMCPï¼ŒClaude Codeåˆ‡æ¢ï¼‰ç­‰ç­‰</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/815421e7b4614ffdbc1f381b5fcd5332~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=DVsoXv37U%2BxMqKrloOjyXxmtNDQ%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-6">2.å¯¹è¯UIå±•ç¤ºåŒºåŸŸ</h3>
<blockquote>
<p>éå¸¸ä¼˜é›…çš„é¡µé¢å±•ç¤ºï¼Œæˆ‘è®¤ä¸ºç¬¦åˆæˆ‘çš„å®¡ç¾å’Œéœ€è¦</p>
</blockquote>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> æ”¯æŒæ€è€ƒè¿‡ç¨‹</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> æ”¯æŒå·¥å…·å±•ç¤ºï¼ˆå¸¦ä¾¿æ·ICONå±•ç¤ºï¼‰</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> æ”¯æŒä»»åŠ¡åˆ—è¡¨å±•ç¤º</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> æ”¯æŒDIFFå±•ç¤º</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> ......</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a0ad269a91d438198c87268efbddaae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=iK%2F7pQZNP%2Bl6cZSGqIQAjYRNkck%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">3.å†å²è®°å½•</h3>
<blockquote>
<p>æ”¯æŒå®Œæ•´çš„å†å²è®°å½•åŠŸèƒ½</p>
</blockquote>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> æŸ¥çœ‹å†å²è®°å½•</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> åˆ é™¤å†å²è®°å½•</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> ä»å†å²è®°å½•è¿›è¡Œå¯¹è¯</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> ä¿®æ”¹å†å²è®°å½•åç§°</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> ä¸‹è½½å†å²è®°å½•</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> æ”¶è—å†å²è®°å½•</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> ......</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a8818be5a1d4c9db01d6987cabe915b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=PQeXXmZtvYV2XLVfGvC6lWYMCLo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">4.è®¾ç½®é¡µé¢</h3>
<blockquote>
<p>ä¸Šé¢å†…å®¹å·²ç»å¤Ÿå¤šäº†ï¼Ÿè®©æˆ‘å†åŠ ğŸ¤ğŸ» è®¾ç½®ç»†èŠ‚</p>
</blockquote>
<p>åŸºç¡€é…ç½®
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26b1b738e17f457ca59ab9e2aba7efea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=ouyqVnwJsJ3iIplcR2TFyujN9so%3D" alt="image.png" loading="lazy"/></p>
<p>ä¾›åº”å•†ç®¡ç†
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9632278ccff4a86a0be8f6dade745ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=WWcJMzDj7qGRAUfdyyj80AEdXtY%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6b7f4b760ba4601a1300c940a648b58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=0m4pfnqAtGB0w4RdazO%2BXQ%2BlHDE%3D" alt="image.png" loading="lazy"/></p>
<p>ä½¿ç”¨ç»Ÿè®¡
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37d9db44479d43d78a6f9857c17711e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=gISNBygZIW53I7gBJjvxuOJXawk%3D" alt="image.png" loading="lazy"/></p>
<p>MCPæœåŠ¡å™¨
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5e6c595dfbe4f52a7ac6985bd06d805~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=Zv3aX%2BTlMknhw%2FrWpJOVic%2Bhhmw%3D" alt="image.png" loading="lazy"/></p>
<p>æ™ºèƒ½ä½“
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c418136ff3fc4af586c58702b485bf46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=pj4w4dyHZU%2F7oOLZyC%2B%2FkXB3MLM%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ced4d3be4e3458da153f6c529df3e37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=BbDxQohvbLcyQsQSDDKnwCHQIRY%3D" alt="image.png" loading="lazy"/></p>
<p>SKills
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41999d5cfae54f25bf8e61e5a70aa7a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=mC%2FnJPcfqWMQN6dWRLJ%2F2%2FCr8qQ%3D" alt="image.png" loading="lazy"/></p>
<p>......</p>
<h3 data-id="heading-9">5.Codexï¼ˆæ²¡é”™ï¼Œä¹Ÿæ”¯æŒäº†ï¼‰</h3>
<blockquote>
<p>ä¸Šé¢åŠŸèƒ½å·²ç»å¤Ÿå¤šäº†ï¼Ÿç°åœ¨æˆ‘ä»¬ä¹Ÿæ”¯æŒCodexäº†ï¼Œä¸Šé¢åŠŸèƒ½æˆ‘ä»¬å…¨éƒ¨é€‚é…äº†ä¸€éCodexï¼Œå¹¶ä¸”å¯ä»¥åœ¨æœ¬æ’ä»¶éå¸¸ä¼˜é›…çš„è¿›è¡Œåˆ‡æ¢</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c9c1d0e13dd4c4c9335a8666d30ffcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=l3KSpnSt6zqeyqvzLb%2F7CXnLa7g%3D" alt="Video-detail-page (1).gif" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c142608dc27e44258d2c6f9d0209670c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=XF%2BFGir4hqi7ICkf%2FlCX36pdvSs%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-10">ä¸‰.åç»­è®¡åˆ’</h2>
<p>è®¡åˆ’åœ¨æ˜é‡‘å¹³å° åˆ†äº«æœ¬æ’ä»¶é¡¹ç›®çš„ä¸€äº›å®ç°åŸç†ï¼Œå’Œä½¿ç”¨claude codeå¼€å‘æœ¬æ’ä»¶çš„å®è·µç»éªŒå’Œé‡‡å‘æŒ‡å—</p>
<blockquote>
<p>æœ¬æ’ä»¶åœ¨æé€Ÿæ›´æ–°ä¸­ï¼Œæ¯å¤©é¢„è®¡å‘å¸ƒ1ç‰ˆï¼Œä½¬å‹ä»¬æƒ³è¦ä»€ä¹ˆæ–°åŠŸèƒ½ï¼Œéšæ—¶åœ¨æ­¤å¸–ä¸­è‰¾ç‰¹æˆ‘å“¦~</p>
</blockquote>
<hr/>
<h2 data-id="heading-11">å››.è‡´è°¢</h2>
<p>æ„Ÿè°¢æ‰€æœ‰å¸®åŠ© IDEA-Claude-Code-GUI å˜å¾—æ›´å¥½çš„è´¡çŒ®è€…ï¼å’Œæ„Ÿè°¢æ˜é‡‘æŠ€æœ¯å¹³å°</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5812a86059ff49a588b18fe47c331419~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyx5piG6bmP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768531730&amp;x-signature=RiBtgDssmbb9PbooAu6fc%2FUruE0%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[agentsdk-goï¼šå®Œæ•´çš„ Claude Code æ¶æ„ Agent å¼€å‘æ¡†æ¶]]></title>    <link>https://juejin.cn/post/7592873628585705472</link>    <guid>https://juejin.cn/post/7592873628585705472</guid>    <pubDate>2026-01-09T01:56:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592873628585705472" data-draft-id="7592853243731329064" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="agentsdk-goï¼šå®Œæ•´çš„ Claude Code æ¶æ„ Agent å¼€å‘æ¡†æ¶"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2026-01-09T01:56:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿçº¬æ™ºè”æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/4336129589911223"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            agentsdk-goï¼šå®Œæ•´çš„ Claude Code æ¶æ„ Agent å¼€å‘æ¡†æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4336129589911223/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿçº¬æ™ºè”æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:56:40.000Z" title="Fri Jan 09 2026 01:56:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">agentsdk-goï¼šå®Œæ•´çš„ Claude Code æ¶æ„ Agent å¼€å‘æ¡†æ¶</h2>
<h3 data-id="heading-1">TL;DR</h3>
<p>agentsdk-go æ˜¯ä¸€ä¸ªç”¨ Go å®ç°çš„ Agent å¼€å‘æ¡†æ¶ï¼Œå®Œæ•´ç§»æ¤äº† Claude Code çš„ä¸ƒå¤§æ ¸å¿ƒèƒ½åŠ›ï¼ˆHooksã€MCPã€Sandboxã€Skillsã€Subagentsã€Commandsã€Pluginsï¼‰ï¼Œå¹¶æ‰©å±•äº†å…­å±‚ä¸­é—´ä»¶æ‹¦æˆªæœºåˆ¶ã€‚ç›¸æ¯” LangGraph çš„é»‘ç›’æ¶æ„å’Œ Claude Agent SDK çš„èµ„æºå ç”¨é—®é¢˜ï¼Œagentsdk-go æä¾›äº†æ›´é€æ˜çš„å®ç°ã€æ›´ä½çš„èµ„æºæ¶ˆè€—å’Œæ›´çµæ´»çš„æ‰©å±•èƒ½åŠ›ã€‚æ ¸å¿ƒä»£ç  20,300 è¡Œï¼ŒAgent ä¸»å¾ªç¯ä»… 189 è¡Œï¼Œæµ‹è¯•è¦†ç›–ç‡è¾¾ 90-93%ã€‚</p>
<h3 data-id="heading-2">ä¸€ã€agentsdk-go æ˜¯ä»€ä¹ˆ</h3>
<h4 data-id="heading-3">æ ¸å¿ƒå®šä½</h4>
<p>agentsdk-go æ˜¯åŸºäº Claude Code å®Œæ•´æ¶æ„è®¾è®¡çš„ Agent å¼€å‘æ¡†æ¶ï¼Œé¢å‘ç”Ÿäº§ç¯å¢ƒçš„ CLIã€CI/CD å’Œä¼ä¸šå¹³å°éƒ¨ç½²åœºæ™¯ã€‚å®ƒä¸æ˜¯ç®€å•çš„ LLM è°ƒç”¨å°è£…ï¼Œè€Œæ˜¯æä¾›äº†å®Œæ•´çš„ Agent å·¥ç¨‹èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-4">æŠ€æœ¯æŒ‡æ ‡</h4>
<ul>
<li>â€¢ <strong>ä»£ç è§„æ¨¡</strong>ï¼šçº¦ 20,300 è¡Œç”Ÿäº§ä»£ç ï¼ˆä¸å«æµ‹è¯•ï¼‰</li>
<li>â€¢ <strong>æ ¸å¿ƒå¤æ‚åº¦</strong>ï¼šAgent ä¸»å¾ªç¯ 189 è¡Œ</li>
<li>â€¢ <strong>æµ‹è¯•è¦†ç›–ç‡</strong>ï¼šå…­å¤§æ ¸å¿ƒæ¨¡å—å‡è¾¾ 90-93%ï¼ˆsubagents 91.7%ï¼Œapi 91.0%ï¼Œmcp 90.3%ï¼Œmodel 92.2%ï¼Œsandbox 90.5%ï¼Œsecurity 90.4%ï¼‰</li>
<li>â€¢ <strong>æ¨¡å—åŒ–ç¨‹åº¦</strong>ï¼š13 ä¸ªç‹¬ç«‹åŒ…</li>
<li>â€¢ <strong>å¤–éƒ¨ä¾èµ–</strong>ï¼šanthropic-sdk-goã€fsnotifyã€gopkg.in/yaml.v3ã€google/uuidã€golang.org/x/modã€golang.org/x/net</li>
</ul>
<h4 data-id="heading-5">ç³»ç»Ÿæ¶æ„</h4>
<h5 data-id="heading-6">æ ¸å¿ƒå±‚ï¼ˆ6 ä¸ªæ¨¡å—ï¼‰</h5>
<ol>
<li>
<ol>
<li><strong>pkg/agent</strong>ï¼šAgent æ‰§è¡Œå¾ªç¯ï¼Œåè°ƒæ¨¡å‹è°ƒç”¨å’Œå·¥å…·æ‰§è¡Œ</li>
</ol>
</li>
<li>
<ol start="2">
<li><strong>pkg/middleware</strong>ï¼šå…­å±‚æ‹¦æˆªç‚¹ï¼Œæ‰©å±•è¯·æ±‚/å“åº”ç”Ÿå‘½å‘¨æœŸ</li>
</ol>
</li>
<li>
<ol start="3">
<li><strong>pkg/model</strong>ï¼šæ¨¡å‹é€‚é…å™¨ï¼Œå½“å‰æ”¯æŒ Anthropic Claude</li>
</ol>
</li>
<li>
<ol start="4">
<li><strong>pkg/tool</strong>ï¼šå·¥å…·æ³¨å†Œå’Œæ‰§è¡Œï¼ŒåŒ…å«å†…ç½®å·¥å…·å’Œ MCP å·¥å…·æ”¯æŒ</li>
</ol>
</li>
<li>
<ol start="5">
<li><strong>pkg/message</strong>ï¼šåŸºäº LRU çš„ä¼šè¯å†å²ç®¡ç†</li>
</ol>
</li>
<li>
<ol start="6">
<li><strong>pkg/api</strong>ï¼šç»Ÿä¸€ API æ¥å£ï¼Œæš´éœ² SDK åŠŸèƒ½</li>
</ol>
</li>
</ol>
<h5 data-id="heading-7">ç‰¹æ€§å±‚ï¼ˆ7 ä¸ªæ¨¡å—ï¼‰</h5>
<ol>
<li>
<ol>
<li><strong>pkg/core/hooks</strong>ï¼šä¸ƒç§ç”Ÿå‘½å‘¨æœŸäº‹ä»¶çš„ Hooks æ‰§è¡Œå™¨</li>
</ol>
</li>
<li>
<ol start="2">
<li><strong>pkg/mcp</strong>ï¼šMCP (Model Context Protocol) å®¢æˆ·ç«¯ï¼Œæ¡¥æ¥å¤–éƒ¨å·¥å…·ï¼ˆstdio/SSEï¼‰</li>
</ol>
</li>
<li>
<ol start="3">
<li><strong>pkg/sandbox</strong>ï¼šæ²™ç®±éš”ç¦»å±‚ï¼Œæ§åˆ¶æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œè®¿é—®ç­–ç•¥</li>
</ol>
</li>
<li>
<ol start="4">
<li><strong>pkg/runtime/skills</strong>ï¼šSkills ç®¡ç†ï¼Œæ”¯æŒè„šæœ¬åŠ è½½å’Œçƒ­é‡è½½</li>
</ol>
</li>
<li>
<ol start="5">
<li><strong>pkg/runtime/subagents</strong>ï¼šSubagent ç®¡ç†ï¼Œç”¨äºå¤š Agent ç¼–æ’å’Œè°ƒåº¦</li>
</ol>
</li>
<li>
<ol start="6">
<li><strong>pkg/runtime/commands</strong>ï¼šCommands è§£æå™¨ï¼Œå¤„ç†æ–œæ å‘½ä»¤è·¯ç”±å’Œå‚æ•°éªŒè¯</li>
</ol>
</li>
<li>
<ol start="7">
<li><strong>pkg/plugins</strong>ï¼šæ’ä»¶ç³»ç»Ÿï¼Œå…·å¤‡ç­¾åéªŒè¯å’Œç”Ÿå‘½å‘¨æœŸé’©å­</li>
</ol>
</li>
</ol>
<h5 data-id="heading-8">ä¸­é—´ä»¶æ‹¦æˆªç‚¹</h5>
<pre><code class="hljs language-markdown" lang="markdown">
<span class="hljs-code">    
    
    
  ç”¨æˆ·è¯·æ±‚
Â Â â†“
before_agentÂ Â â†Â è¯·æ±‚éªŒè¯ã€å®¡è®¡æ—¥å¿—
Â Â â†“
AgentÂ å¾ªç¯
Â Â â†“
before_modelÂ Â â†Â PromptÂ å¤„ç†ã€ä¸Šä¸‹æ–‡ä¼˜åŒ–
Â Â â†“
æ¨¡å‹è°ƒç”¨
Â Â â†“
after_modelÂ Â Â â†Â ç»“æœè¿‡æ»¤ã€å†…å®¹æ£€æŸ¥
Â Â â†“
before_toolÂ Â Â â†Â å·¥å…·å‚æ•°éªŒè¯
Â Â â†“
å·¥å…·æ‰§è¡Œ
Â Â â†“
after_toolÂ Â Â Â â†Â ç»“æœåå¤„ç†
Â Â â†“
after_agentÂ Â Â â†Â å“åº”æ ¼å¼åŒ–ã€æŒ‡æ ‡æ”¶é›†
Â Â â†“
ç”¨æˆ·å“åº”
</span></code></pre>
<p>è¿™ç§å…­å±‚æ‹¦æˆªè®¾è®¡å…è®¸å¼€å‘è€…åœ¨ Agent æ‰§è¡Œçš„å…³é”®èŠ‚ç‚¹æ³¨å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œå®ç°æ—¥å¿—è®°å½•ã€æ€§èƒ½ç›‘æ§ã€å®‰å…¨å®¡è®¡ç­‰åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-9">é…ç½®ç³»ç»Ÿ</h4>
<p>agentsdk-go ä½¿ç”¨ <code>.claude/</code> ç›®å½•è¿›è¡Œé…ç½®ï¼Œä¸ Claude Code å®Œå…¨å…¼å®¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">
    
    
    
  .claude/
â”œâ”€â”€Â settings.jsonÂ Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â é¡¹ç›®é…ç½®</span>
â”œâ”€â”€Â settings.local.jsonÂ Â Â Â Â <span class="hljs-comment">#Â æœ¬åœ°è¦†ç›–ï¼ˆgitignoredï¼‰</span>
â”œâ”€â”€Â skills/Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â SkillsÂ å®šä¹‰</span>
â”œâ”€â”€Â commands/Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â æ–œæ å‘½ä»¤å®šä¹‰</span>
â”œâ”€â”€Â agents/Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â SubagentsÂ å®šä¹‰</span>
â””â”€â”€Â plugins/Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â æ’ä»¶ç›®å½•</span>
</code></pre>
<p>é…ç½®ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š</p>
<ol>
<li>
<ol>
<li>æ‰˜ç®¡ç­–ç•¥ï¼ˆ<code>/etc/claude-code/managed-settings.json</code>ï¼‰</li>
</ol>
</li>
<li>
<ol start="2">
<li>è¿è¡Œæ—¶è¦†ç›–ï¼ˆCLI/API æä¾›ï¼‰</li>
</ol>
</li>
<li>
<ol start="3">
<li><code>.claude/settings.local.json</code></li>
</ol>
</li>
<li>
<ol start="4">
<li><code>.claude/settings.json</code></li>
</ol>
</li>
<li>
<ol start="5">
<li>å†…ç½®é»˜è®¤å€¼</li>
</ol>
</li>
</ol>
<p>é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json">
    
    
    
  <span class="hljs-punctuation">{</span>
Â Â <span class="hljs-attr">"permissions"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">{</span>
Â Â Â Â <span class="hljs-attr">"allow"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span><span class="hljs-string">"Bash(ls:*)"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-string">"Bash(pwd:*)"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â Â Â Â <span class="hljs-attr">"deny"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span><span class="hljs-string">"Read(.env)"</span><span class="hljs-punctuation">,</span>Â <span class="hljs-string">"Read(secrets/**)"</span><span class="hljs-punctuation">]</span>
Â Â <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">{</span>
Â Â Â Â <span class="hljs-attr">"MY_VAR"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"value"</span>
Â Â <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
Â Â <span class="hljs-attr">"sandbox"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">{</span>
Â Â Â Â <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
Â Â <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-10">äºŒã€ä¸ºä»€ä¹ˆè¦è‡ªå·±å†™ agentsdk-go</h3>
<h4 data-id="heading-11">LangGraph çš„æ¶æ„é—®é¢˜</h4>
<p>LangGraph è™½ç„¶åŠŸèƒ½å¼ºå¤§ï¼Œä½†å­˜åœ¨å‡ ä¸ªæ ¸å¿ƒç—›ç‚¹ï¼š</p>
<ol>
<li>
<ol>
<li><strong>é»‘ç›’æ¶æ„</strong>ï¼šçŠ¶æ€å›¾æŠ½è±¡è¿‡é‡ï¼Œéš¾ä»¥è¿½è¸ª Agent æ‰§è¡Œæµç¨‹ï¼Œè°ƒè¯•å›°éš¾</li>
</ol>
</li>
<li>
<ol start="2">
<li><strong>çµæ´»æ€§ä¸è¶³</strong>ï¼šå›ºå®šçš„å›¾ç»“æ„é™åˆ¶äº†åŠ¨æ€å†³ç­–å’Œè¿è¡Œæ—¶è°ƒæ•´</li>
</ol>
</li>
<li>
<ol start="3">
<li><strong>å·¥ç¨‹èƒ½åŠ›ç¼ºå¤±</strong>ï¼šç¼ºå°‘ Sandboxã€Hooksã€MCP ç­‰ç”Ÿäº§ç¯å¢ƒå¿…éœ€çš„èƒ½åŠ›</li>
</ol>
</li>
<li>
<ol start="4">
<li><strong>Python ç”Ÿæ€ç»‘å®š</strong>ï¼šå¯¹ Go ç”Ÿæ€æ”¯æŒä¸ä½³</li>
</ol>
</li>
</ol>
<h4 data-id="heading-12">Claude Agent SDK çš„èµ„æºç“¶é¢ˆ</h4>
<p>Claude Agent SDK åŸºäº <code>claude -p</code> å®ç°ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šåœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªå®Œæ•´çš„ Claude å®ä¾‹ï¼š</p>
<ul>
<li>â€¢ <strong>CPU å ç”¨</strong>ï¼šæ¯ä¸ªå®ä¾‹ç‹¬ç«‹è¿›ç¨‹ï¼Œå¤šä»»åŠ¡å¹¶å‘æ—¶ CPU é£™å‡</li>
<li>â€¢ <strong>å†…å­˜æ¶ˆè€—</strong>ï¼šæ¯ä¸ªå®ä¾‹åŠ è½½å®Œæ•´ä¸Šä¸‹æ–‡ï¼Œå†…å­˜å ç”¨çº¿æ€§å¢é•¿</li>
<li>â€¢ <strong>å¯åŠ¨å»¶è¿Ÿ</strong>ï¼šè¿›ç¨‹å†·å¯åŠ¨æ—¶é—´å½±å“å“åº”é€Ÿåº¦</li>
</ul>
<p>è¿™åœ¨ CI/CD å’Œé«˜å¹¶å‘åœºæ™¯ä¸‹å®Œå…¨ä¸å¯æ¥å—ã€‚</p>
<h4 data-id="heading-13">agentsdk-go çš„ä¼˜åŠ¿</h4>
<h5 data-id="heading-14">1. æ¶æ„é€æ˜æ€§</h5>
<p>å®Œå…¨éµå¾ª Claude Code çš„è®¾è®¡åŸåˆ™ï¼Œæ ¸å¿ƒ Agent å¾ªç¯ä»… 189 è¡Œï¼Œé€»è¾‘æ¸…æ™°ï¼š</p>
<ul>
<li>â€¢ è¯·æ±‚æ¥æ”¶ â†’ ä¸­é—´ä»¶å‰ç½®å¤„ç† â†’ æ¨¡å‹è°ƒç”¨ â†’ å·¥å…·æ‰§è¡Œ â†’ ä¸­é—´ä»¶åç½®å¤„ç† â†’ å“åº”è¿”å›</li>
<li>â€¢ æ¯ä¸ªç¯èŠ‚éƒ½å¯æ‹¦æˆªã€è§‚æµ‹ã€è°ƒè¯•</li>
</ul>
<h5 data-id="heading-15">2. èµ„æºæ•ˆç‡</h5>
<ul>
<li>â€¢ <strong>å•è¿›ç¨‹æ¨¡å‹</strong>ï¼šæ‰€æœ‰ Agent å…±äº«ä¸€ä¸ªè¿è¡Œæ—¶ï¼Œæ— è¿›ç¨‹å¯åŠ¨å¼€é”€</li>
<li>â€¢ <strong>ä¼šè¯ç¼“å­˜</strong>ï¼šåŸºäº LRU çš„æ¶ˆæ¯å†å²ç®¡ç†ï¼Œé¿å…é‡å¤ä¸Šä¸‹æ–‡åŠ è½½</li>
<li>â€¢ <strong>æŒ‰éœ€åŠ è½½</strong>ï¼šSkillsã€Pluginsã€MCP å·¥å…·ä»…åœ¨ä½¿ç”¨æ—¶åˆå§‹åŒ–</li>
</ul>
<h5 data-id="heading-16">3. æ‰©å±•èƒ½åŠ›</h5>
<ul>
<li>â€¢ <strong>ä¸­é—´ä»¶ç³»ç»Ÿ</strong>ï¼šå…­å±‚æ‹¦æˆªç‚¹è¦†ç›–å®Œæ•´ç”Ÿå‘½å‘¨æœŸ</li>
<li>â€¢ <strong>Sandbox ä¼˜åŒ–</strong>ï¼šæ›´ç»†ç²’åº¦çš„èµ„æºæ§åˆ¶ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œï¼‰</li>
<li>â€¢ <strong>è‡ªå®šä¹‰å·¥å…·</strong>ï¼šç®€å•çš„ <code>tool.Tool</code> æ¥å£ï¼Œ5 åˆ†é’Ÿå®Œæˆé›†æˆ</li>
</ul>
<h5 data-id="heading-17">4. ç”Ÿäº§å°±ç»ª</h5>
<ul>
<li>â€¢ <strong>é«˜æµ‹è¯•è¦†ç›–ç‡</strong>ï¼šæ ¸å¿ƒæ¨¡å— 90%+ è¦†ç›–ï¼Œä¿è¯ä»£ç è´¨é‡</li>
<li>â€¢ <strong>HTTP API</strong>ï¼šå†…ç½® REST + SSE æœåŠ¡å™¨ï¼Œå¼€ç®±å³ç”¨</li>
<li>â€¢ <strong>å¯è§‚æµ‹æ€§</strong>ï¼šTraceã€Metricsã€Logs å®Œæ•´æ”¯æŒ</li>
</ul>
<h3 data-id="heading-18">ä¸‰ã€å¦‚ä½•ä½¿ç”¨ agentsdk-go å¼€å‘ Agent</h3>
<h4 data-id="heading-19">å®‰è£…å’Œç¯å¢ƒå‡†å¤‡</h4>
<h5 data-id="heading-20">å‰ç½®è¦æ±‚</h5>
<ul>
<li>â€¢ Go 1.24.0 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
<li>â€¢ Anthropic API Key</li>
</ul>
<h5 data-id="heading-21">å®‰è£… SDK</h5>
<pre><code class="hljs language-go" lang="go">
    
    
    
  <span class="hljs-keyword">go</span>Â getÂ github.com/cexll/agentsdk-<span class="hljs-keyword">go</span>
</code></pre>
<h4 data-id="heading-22">åŸºç¡€ç¤ºä¾‹ï¼š5 åˆ†é’Ÿåˆ›å»ºç¬¬ä¸€ä¸ª Agent</h4>
<p>è¿™æ˜¯æ¥è‡ª <code>examples/01-basic/main.go</code> çš„æœ€å°ç¤ºä¾‹ï¼Œå±•ç¤ºäº† agentsdk-go çš„æ ¸å¿ƒç”¨æ³•ï¼š</p>
<pre><code class="hljs language-go" lang="go">
    
    
    
  <span class="hljs-keyword">package</span>Â main

<span class="hljs-keyword">import</span>Â (
Â Â Â Â <span class="hljs-string">"context"</span>
Â Â Â Â <span class="hljs-string">"fmt"</span>
Â Â Â Â <span class="hljs-string">"log"</span>

Â Â Â Â <span class="hljs-string">"github.com/cexll/agentsdk-go/pkg/api"</span>
Â Â Â Â <span class="hljs-string">"github.com/cexll/agentsdk-go/pkg/middleware"</span>
Â Â Â Â modelpkgÂ <span class="hljs-string">"github.com/cexll/agentsdk-go/pkg/model"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span>Â <span class="hljs-title">main</span><span class="hljs-params">()</span></span>Â {
Â Â Â Â <span class="hljs-comment">//Â åˆ›å»ºÂ AnthropicÂ provider</span>
Â Â Â Â providerÂ :=Â &amp;modelpkg.AnthropicProvider{
Â Â Â Â Â Â Â Â ModelName:Â <span class="hljs-string">"claude-sonnet-4-5-20250929"</span>,
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">//Â åˆå§‹åŒ–è¿è¡Œæ—¶</span>
Â Â Â Â traceMWÂ :=Â middleware.NewTraceMiddleware(<span class="hljs-string">".trace"</span>)
Â Â Â Â rt,Â errÂ :=Â api.New(context.Background(),Â api.Options{
Â Â Â Â Â Â Â Â ModelFactory:Â provider,
Â Â Â Â Â Â Â Â Middleware:Â Â Â []middleware.Middleware{traceMW},
Â Â Â Â })
Â Â Â Â <span class="hljs-keyword">if</span>Â errÂ !=Â <span class="hljs-literal">nil</span>Â {
Â Â Â Â Â Â Â Â log.Fatalf(<span class="hljs-string">"buildÂ runtime:Â %v"</span>,Â err)
Â Â Â Â }
Â Â Â Â <span class="hljs-keyword">defer</span>Â rt.Close()

Â Â Â Â <span class="hljs-comment">//Â å‘èµ·åŒæ­¥è°ƒç”¨</span>
Â Â Â Â resp,Â errÂ :=Â rt.Run(context.Background(),Â api.Request{
Â Â Â Â Â Â Â Â Prompt:Â <span class="hljs-string">"ä½ å¥½"</span>,
Â Â Â Â })
Â Â Â Â <span class="hljs-keyword">if</span>Â errÂ !=Â <span class="hljs-literal">nil</span>Â {
Â Â Â Â Â Â Â Â log.Fatalf(<span class="hljs-string">"run:Â %v"</span>,Â err)
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">if</span>Â resp.ResultÂ !=Â <span class="hljs-literal">nil</span>Â {
Â Â Â Â Â Â Â Â fmt.Println(resp.Result.Output)
Â Â Â Â }
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li>
<ol>
<li><strong>æ¨¡å‹åˆå§‹åŒ–</strong>ï¼šé€šè¿‡ <code>AnthropicProvider</code> é…ç½®æ¨¡å‹</li>
</ol>
</li>
<li>
<ol start="2">
<li><strong>ä¸­é—´ä»¶æ³¨å…¥</strong>ï¼š<code>TraceMiddleware</code> è‡ªåŠ¨è®°å½•æ‰§è¡Œæ—¥å¿—åˆ° <code>.trace</code> ç›®å½•</li>
</ol>
</li>
<li>
<ol start="3">
<li><strong>è¿è¡Œæ—¶åˆ›å»º</strong>ï¼š<code>api.New()</code> åˆå§‹åŒ–å®Œæ•´è¿è¡Œæ—¶</li>
</ol>
</li>
<li>
<ol start="4">
<li><strong>åŒæ­¥è°ƒç”¨</strong>ï¼š<code>rt.Run()</code> é˜»å¡ç­‰å¾…ç»“æœ</li>
</ol>
</li>
</ol>
<p>è¿è¡Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">
    
    
    
  <span class="hljs-comment">#Â 1.Â è®¾ç½®ç¯å¢ƒå˜é‡</span>
<span class="hljs-built_in">export</span>Â ANTHROPIC_API_KEY=sk-ant-your-key-here

<span class="hljs-comment">#Â 2.Â è¿è¡Œç¤ºä¾‹</span>
goÂ runÂ ./examples/01-basic
</code></pre>
<h4 data-id="heading-23">è¿›é˜¶ç”¨æ³•ï¼šè‡ªå®šä¹‰ä¸­é—´ä»¶</h4>
<p>ä¸­é—´ä»¶æ˜¯ agentsdk-go çš„æ ¸å¿ƒæ‰©å±•æœºåˆ¶ï¼Œå…è®¸åœ¨å…­ä¸ªå…³é”®èŠ‚ç‚¹æ³¨å…¥é€»è¾‘ï¼š</p>
<pre><code class="hljs language-go" lang="go">
    
    
    
  loggingMiddlewareÂ :=Â middleware.Middleware{
Â Â Â Â <span class="hljs-comment">//Â è¯·æ±‚å‰ï¼šè®°å½•è¾“å…¥å’Œå¯åŠ¨æ—¶é—´</span>
Â Â Â Â BeforeAgent:Â <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctxÂ context.Context,Â reqÂ *middleware.AgentRequest)</span></span>Â (*middleware.AgentRequest,Â <span class="hljs-type">error</span>)Â {
Â Â Â Â Â Â Â Â log.Printf(<span class="hljs-string">"[REQUEST]Â %s"</span>,Â req.Input)
Â Â Â Â Â Â Â Â req.Meta[<span class="hljs-string">"start_time"</span>]Â =Â time.Now()
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â req,Â <span class="hljs-literal">nil</span>
Â Â Â Â },

Â Â Â Â <span class="hljs-comment">//Â å“åº”åï¼šè®¡ç®—æ‰§è¡Œæ—¶é—´</span>
Â Â Â Â AfterAgent:Â <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctxÂ context.Context,Â respÂ *middleware.AgentResponse)</span></span>Â (*middleware.AgentResponse,Â <span class="hljs-type">error</span>)Â {
Â Â Â Â Â Â Â Â durationÂ :=Â time.Since(resp.Meta[<span class="hljs-string">"start_time"</span>].(time.Time))
Â Â Â Â Â Â Â Â log.Printf(<span class="hljs-string">"[RESPONSE]Â %sÂ (elapsed:Â %v)"</span>,Â resp.Output,Â duration)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â resp,Â <span class="hljs-literal">nil</span>
Â Â Â Â },

Â Â Â Â <span class="hljs-comment">//Â æ¨¡å‹è°ƒç”¨å‰ï¼šä¼˜åŒ–Â Prompt</span>
Â Â Â Â BeforeModel:Â <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctxÂ context.Context,Â reqÂ *middleware.ModelRequest)</span></span>Â (*middleware.ModelRequest,Â <span class="hljs-type">error</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ ç³»ç»Ÿæç¤ºè¯</span>
Â Â Â Â Â Â Â Â req.MessagesÂ =Â <span class="hljs-built_in">append</span>([]middleware.Message{
Â Â Â Â Â Â Â Â Â Â Â Â {Role:Â <span class="hljs-string">"system"</span>,Â Content:Â <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæŠ€æœ¯ä¸“å®¶"</span>},
Â Â Â Â Â Â Â Â },Â req.Messages...)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â req,Â <span class="hljs-literal">nil</span>
Â Â Â Â },

Â Â Â Â <span class="hljs-comment">//Â å·¥å…·æ‰§è¡Œå‰ï¼šå‚æ•°éªŒè¯</span>
Â Â Â Â BeforeTool:Â <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctxÂ context.Context,Â reqÂ *middleware.ToolRequest)</span></span>Â (*middleware.ToolRequest,Â <span class="hljs-type">error</span>)Â {
Â Â Â Â Â Â Â Â log.Printf(<span class="hljs-string">"[TOOL]Â %sÂ withÂ params:Â %v"</span>,Â req.Name,Â req.Parameters)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â req,Â <span class="hljs-literal">nil</span>
Â Â Â Â },
}

<span class="hljs-comment">//Â æ³¨å…¥ä¸­é—´ä»¶</span>
runtime,Â errÂ :=Â api.New(ctx,Â api.Options{
Â Â Â Â ProjectRoot:Â Â <span class="hljs-string">"."</span>,
Â Â Â Â ModelFactory:Â provider,
Â Â Â Â Middleware:Â Â Â []middleware.Middleware{loggingMiddleware},
})
</code></pre>
<h4 data-id="heading-24">æµå¼è¾“å‡ºï¼šå®æ—¶è·å– Agent æ‰§è¡Œè¿›åº¦</h4>
<p>å¯¹äºé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼Œæµå¼ API æä¾›å®æ—¶åé¦ˆï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">
    
    
    
  eventsÂ :=Â runtime.RunStream(ctx,Â api.Request{
Â Â Â Â Prompt:Â Â Â Â <span class="hljs-string">"åˆ†æä»£ç ä»“åº“ç»“æ„å¹¶ç”ŸæˆæŠ¥å‘Š"</span>,
Â Â Â Â SessionID:Â <span class="hljs-string">"analysis"</span>,
})

<span class="hljs-keyword">for</span>Â <span class="hljs-keyword">event</span>Â :=Â rangeÂ eventsÂ {
Â Â Â Â <span class="hljs-keyword">switch</span>Â <span class="hljs-keyword">event</span>.TypeÂ {
Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-string">"content_block_delta"</span>:
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è¾“å‡ºæ–‡æœ¬å†…å®¹</span>
Â Â Â Â Â Â Â Â fmt.Print(<span class="hljs-keyword">event</span>.Delta.Text)

Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-string">"tool_execution_start"</span>:
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å·¥å…·å¼€å§‹æ‰§è¡Œ</span>
Â Â Â Â Â Â Â Â fmt.Printf(<span class="hljs-string">"\n[å·¥å…·æ‰§è¡Œ]Â %s\n"</span>,Â <span class="hljs-keyword">event</span>.ToolName)

Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-string">"tool_execution_stop"</span>:
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å·¥å…·æ‰§è¡Œå®Œæˆ</span>
Â Â Â Â Â Â Â Â fmt.Printf(<span class="hljs-string">"[å·¥å…·ç»“æœ]Â %s\n"</span>,Â <span class="hljs-keyword">event</span>.Output)
Â Â Â Â }
}
</code></pre>
<h4 data-id="heading-25">è‡ªå®šä¹‰å·¥å…·ï¼šæ‰©å±• Agent èƒ½åŠ›</h4>
<p>agentsdk-go å…è®¸æ³¨å†Œè‡ªå®šä¹‰å·¥å…·ï¼Œæ¥å£éå¸¸ç®€æ´ï¼ˆå‚è€ƒ <code>examples/05-custom-tools/main.go</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-go" lang="go">
    
    
    
  <span class="hljs-comment">//Â å®šä¹‰è‡ªå®šä¹‰å·¥å…·</span>
<span class="hljs-keyword">type</span>Â EchoToolÂ <span class="hljs-keyword">struct</span>{}

<span class="hljs-function"><span class="hljs-keyword">func</span>Â <span class="hljs-params">(tÂ *EchoTool)</span></span>Â Name()Â <span class="hljs-type">string</span>Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"echo"</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span>Â <span class="hljs-params">(tÂ *EchoTool)</span></span>Â Description()Â <span class="hljs-type">string</span>Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"è¿”å›æä¾›çš„æ–‡æœ¬"</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span>Â <span class="hljs-params">(tÂ *EchoTool)</span></span>Â Schema()Â *tool.JSONSchemaÂ {
Â Â Â Â <span class="hljs-keyword">return</span>Â &amp;tool.JSONSchema{
Â Â Â Â Â Â Â Â Type:Â <span class="hljs-string">"object"</span>,
Â Â Â Â Â Â Â Â Properties:Â <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]any{
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"text"</span>:Â <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]any{
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"type"</span>:Â Â Â Â Â Â Â Â <span class="hljs-string">"string"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"description"</span>:Â <span class="hljs-string">"è¦è¿”å›çš„æ–‡æœ¬"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â Required:Â []<span class="hljs-type">string</span>{<span class="hljs-string">"text"</span>},
Â Â Â Â }
}

<span class="hljs-function"><span class="hljs-keyword">func</span>Â <span class="hljs-params">(tÂ *EchoTool)</span></span>Â Execute(ctxÂ context.Context,Â paramsÂ <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]any)Â (*tool.ToolResult,Â <span class="hljs-type">error</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â &amp;tool.ToolResult{
Â Â Â Â Â Â Â Â Output:Â fmt.Sprint(params[<span class="hljs-string">"text"</span>]),
Â Â Â Â },Â <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">//Â æ³¨å†Œå·¥å…·</span>
rt,Â errÂ :=Â api.New(ctx,Â api.Options{
Â Â Â Â ProjectRoot:Â Â Â Â Â Â Â Â Â <span class="hljs-string">"."</span>,
Â Â Â Â ModelFactory:Â Â Â Â Â Â Â Â provider,
Â Â Â Â EnabledBuiltinTools:Â []<span class="hljs-type">string</span>{<span class="hljs-string">"bash"</span>,Â <span class="hljs-string">"file_read"</span>},Â <span class="hljs-comment">//Â é€‰æ‹©æ€§å¯ç”¨å†…ç½®å·¥å…·</span>
Â Â Â Â CustomTools:Â Â Â Â Â Â Â Â Â []tool.Tool{&amp;EchoTool{}},Â Â Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ è‡ªå®šä¹‰å·¥å…·</span>
})
</code></pre>
<p><strong>å·¥å…·æ³¨å†Œè§„åˆ™</strong>ï¼š</p>
<ul>
<li>â€¢ <code>EnabledBuiltinTools: nil</code> â†’ å¯ç”¨æ‰€æœ‰å†…ç½®å·¥å…·</li>
<li>â€¢ <code>EnabledBuiltinTools: []string{}</code> â†’ ç¦ç”¨æ‰€æœ‰å†…ç½®å·¥å…·</li>
<li>â€¢ <code>EnabledBuiltinTools: []string{"bash", "file_read"}</code> â†’ ä»…å¯ç”¨æŒ‡å®šå·¥å…·ï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰</li>
<li>â€¢ <code>CustomTools</code> â†’ è¿½åŠ è‡ªå®šä¹‰å·¥å…·</li>
</ul>
<h4 data-id="heading-26">é«˜çº§ç‰¹æ€§ï¼šå®Œæ•´å·¥ç¨‹èƒ½åŠ›</h4>
<p><code>examples/04-advanced</code> å±•ç¤ºäº†ç”Ÿäº§ç¯å¢ƒæ‰€éœ€çš„å…¨éƒ¨åŠŸèƒ½ï¼š</p>
<h5 data-id="heading-27">1. Sandbox éš”ç¦»</h5>
<pre><code class="hljs language-go" lang="go">
    
    
    
  optsÂ :=Â api.Options{
Â Â Â Â Sandbox:Â &amp;sandbox.Options{
Â Â Â Â Â Â Â Â Enabled:Â Â Â Â Â <span class="hljs-literal">true</span>,
Â Â Â Â Â Â Â Â Root:Â Â Â Â Â Â Â Â <span class="hljs-string">"/app/workspace"</span>,
Â Â Â Â Â Â Â Â AllowedHosts:Â []<span class="hljs-type">string</span>{<span class="hljs-string">"api.example.com"</span>},
Â Â Â Â Â Â Â Â CPULimit:Â Â Â Â <span class="hljs-number">50.0</span>,Â Â <span class="hljs-comment">//Â CPUÂ ä½¿ç”¨ç‡é™åˆ¶Â 50%</span>
Â Â Â Â Â Â Â Â MemLimit:Â Â Â Â <span class="hljs-number">512</span>,Â Â Â <span class="hljs-comment">//Â å†…å­˜é™åˆ¶Â 512MB</span>
Â Â Â Â Â Â Â Â DiskLimit:Â Â Â <span class="hljs-number">1024</span>,Â Â <span class="hljs-comment">//Â ç£ç›˜é™åˆ¶Â 1GB</span>
Â Â Â Â },
}
</code></pre>
<h5 data-id="heading-28">2. MCP å·¥å…·é›†æˆ</h5>
<pre><code class="hljs language-css" lang="css">
    
    
    
  optsÂ :=Â api.Options{
Â Â Â Â MCPServers:Â []mcp.ServerConfig{
Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â Â Â Name:Â Â Â Â <span class="hljs-string">"time-server"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â Command:Â <span class="hljs-string">"uvx"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â Args:Â Â Â Â []string{"mcp-server-<span class="hljs-selector-tag">time</span>"},
Â Â Â Â Â Â Â Â },
Â Â Â Â },
}
</code></pre>
<h5 data-id="heading-29">3. Skills å’Œ Subagents</h5>
<pre><code class="hljs language-css" lang="css">
    
    
    
  optsÂ :=Â api.Options{
Â Â Â Â Skills:Â []skills.Skill{
Â Â Â Â Â Â Â Â {Name:Â <span class="hljs-string">"code-review"</span>,Â Path:Â <span class="hljs-string">".claude/skills/code-review"</span>},
Â Â Â Â },
Â Â Â Â Subagents:Â []subagents.Config{
Â Â Â Â Â Â Â Â {Name:Â <span class="hljs-string">"analyzer"</span>,Â Prompt:Â <span class="hljs-string">"ä¸“æ³¨äºä»£ç åˆ†æ"</span>},
Â Â Â Â },
}
</code></pre>
<h4 data-id="heading-30">äº”å±‚ç¤ºä¾‹è·¯å¾„</h4>
<p>agentsdk-go æä¾›æ¸è¿›å¼å­¦ä¹ è·¯å¾„ï¼š</p>
<ol>
<li>
<ol>
<li><strong>01-basic</strong>ï¼šæœ€å°åŒ–çš„å•æ¬¡è¯·æ±‚/å“åº”</li>
</ol>
</li>
<li>
<ol start="2">
<li><strong>02-cli</strong>ï¼šäº¤äº’å¼ REPLï¼Œæ”¯æŒä¼šè¯å†å²</li>
</ol>
</li>
<li>
<ol start="3">
<li><strong>03-http</strong>ï¼šREST + SSE æœåŠ¡å™¨ï¼ˆç›‘å¬ <code>:8080</code>ï¼‰</li>
</ol>
</li>
<li>
<ol start="4">
<li><strong>04-advanced</strong>ï¼šå®Œæ•´ç®¡é“ï¼ˆä¸­é—´ä»¶ã€Hooksã€MCPã€Sandboxã€Skillsã€Subagentsï¼‰</li>
</ol>
</li>
<li>
<ol start="5">
<li><strong>05-custom-tools</strong>ï¼šé€‰æ‹©æ€§å†…ç½®å·¥å…· + è‡ªå®šä¹‰å·¥å…·æ³¨å†Œ</li>
</ol>
</li>
</ol>
<h3 data-id="heading-31">æ€»ç»“</h3>
<p>agentsdk-go ä¸æ˜¯ç®€å•çš„ API å°è£…ï¼Œè€Œæ˜¯å®Œæ•´çš„ Agent å·¥ç¨‹æ¡†æ¶ï¼š</p>
<ul>
<li>â€¢ <strong>æ¶æ„é€æ˜</strong>ï¼š189 è¡Œæ ¸å¿ƒå¾ªç¯ï¼Œé€»è¾‘æ¸…æ™°å¯è¿½æº¯</li>
<li>â€¢ <strong>èµ„æºé«˜æ•ˆ</strong>ï¼šå•è¿›ç¨‹æ¨¡å‹ï¼Œæ— å†·å¯åŠ¨å¼€é”€</li>
<li>â€¢ <strong>æ‰©å±•çµæ´»</strong>ï¼šå…­å±‚ä¸­é—´ä»¶ + è‡ªå®šä¹‰å·¥å…· + MCP é›†æˆ</li>
<li>â€¢ <strong>ç”Ÿäº§å°±ç»ª</strong>ï¼š90%+ æµ‹è¯•è¦†ç›–ï¼ŒHTTP API å¼€ç®±å³ç”¨</li>
</ul>
<p>å¦‚æœä½ åœ¨ä½¿ç”¨ LangGraph æ—¶æ„Ÿåˆ°æŸç¼šï¼Œæˆ–å›  Claude Agent SDK çš„èµ„æºå ç”¨è€Œå›°æ‰°ï¼Œä¸å¦¨è¯•è¯• agentsdk-goâ€”â€”ä¸€ä¸ªçœŸæ­£ä¸ºå·¥ç¨‹å¸ˆè®¾è®¡çš„ Agent å¼€å‘æ¡†æ¶ã€‚</p>
<h3 data-id="heading-32">å‚è€ƒèµ„æº</h3>
<ul>
<li>â€¢ GitHub ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcexll%2Fagentsdk-go" target="_blank" title="https://github.com/cexll/agentsdk-go" ref="nofollow noopener noreferrer">github.com/cexll/agentâ€¦</a></li>
<li>â€¢ ç¤ºä¾‹ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcexll%2Fagentsdk-go%2Ftree%2Fmain%2Fexamples" target="_blank" title="https://github.com/cexll/agentsdk-go/tree/main/examples" ref="nofollow noopener noreferrer">github.com/cexll/agentâ€¦</a></li>
<li>â€¢ Claude Code æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.anthropic.com%2Fen%2Fdocs%2Fagents" target="_blank" title="https://docs.anthropic.com/en/docs/agents" ref="nofollow noopener noreferrer">docs.anthropic.com/en/docs/ageâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºPaddleå¾®è°ƒERNIEçš„ä¸­æ–‡æƒ…æ„Ÿåˆ†æå®æˆ˜æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7592878531668869146</link>    <guid>https://juejin.cn/post/7592878531668869146</guid>    <pubDate>2026-01-09T01:39:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592878531668869146" data-draft-id="7592431064976818191" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºPaddleå¾®è°ƒERNIEçš„ä¸­æ–‡æƒ…æ„Ÿåˆ†æå®æˆ˜æ•™ç¨‹"/> <meta itemprop="keywords" content="æ·±åº¦å­¦ä¹ ,æœºå™¨å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-09T01:39:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="YukiMori23"/> <meta itemprop="url" content="https://juejin.cn/user/4022441007125707"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºPaddleå¾®è°ƒERNIEçš„ä¸­æ–‡æƒ…æ„Ÿåˆ†æå®æˆ˜æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4022441007125707/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    YukiMori23
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:39:14.000Z" title="Fri Jan 09 2026 01:39:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŸºäºPaddleå¾®è°ƒERNIEçš„ä¸­æ–‡æƒ…æ„Ÿåˆ†æå®æˆ˜æ•™ç¨‹</h2>
<h3 data-id="heading-1">1. å¼•è¨€</h3>
<p>æ¬¢è¿æ¥åˆ° PaddleNLP å®æˆ˜æ•™ç¨‹ç³»åˆ—ï¼æœ¬æ¬¡æ•™ç¨‹å°†å¸¦æ‚¨è¿›å…¥è‡ªç„¶è¯­è¨€å¤„ç† (NLP) ä¸­æœ€ç»å…¸ã€æœ€å¹¿æ³›åº”ç”¨çš„ä»»åŠ¡ä¹‹ä¸€ï¼š<strong>æƒ…æ„Ÿåˆ†æ (Sentiment Analysis)</strong> ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å¼ºå¤§çš„é¢„è®­ç»ƒæ¨¡å‹Â <strong>ERNIE</strong>Â æ¥å¯¹ä¸­æ–‡æ–‡æœ¬è¿›è¡Œæƒ…æ„Ÿå€¾å‘çš„åˆ¤æ–­ã€‚</p>
<h4 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯æƒ…æ„Ÿåˆ†æï¼Ÿ</h4>
<p>æƒ…æ„Ÿåˆ†æï¼Œåˆç§°ä¸ºæ„è§æŒ–æ˜ (Opinion Mining)ï¼Œæ˜¯åˆ©ç”¨è‡ªç„¶è¯­è¨€å¤„ç†ã€æ–‡æœ¬åˆ†æå’Œè®¡ç®—è¯­è¨€å­¦ç­‰æ–¹æ³•ï¼Œå¯¹å¸¦æœ‰æƒ…æ„Ÿè‰²å½©çš„ä¸»è§‚æ€§æ–‡æœ¬è¿›è¡Œæå–ã€åˆ†æã€å½’çº³å’Œæ¨ç†çš„è¿‡ç¨‹ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒçš„ç›®æ ‡å°±æ˜¯<strong>è¯†åˆ«å’Œåˆ¤æ–­ä¸€æ®µæ–‡æœ¬æ‰€è¡¨è¾¾çš„æƒ…æ„Ÿæ˜¯ç§¯æçš„ï¼ˆæ­£é¢ï¼‰ã€æ¶ˆæçš„ï¼ˆè´Ÿé¢ï¼‰ï¼Œè¿˜æ˜¯ä¸­æ€§çš„</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œç»™å®šä¸€æ¡ç”¨æˆ·è¯„ä»·ï¼š"è¿™å®¶é¤å…çš„çƒ¤é¸­å‘³é“ç»äº†ï¼Œç¯å¢ƒä¹Ÿå¾ˆæ£’ï¼"ï¼Œæƒ…æ„Ÿåˆ†æç³»ç»Ÿåº”è¯¥èƒ½åˆ¤æ–­å‡ºè¿™æ˜¯ä¸€æ¡<strong>ç§¯æ</strong>çš„è¯„ä»·ã€‚è€Œå¯¹äº"ç­‰äº†åŠä¸ªå¤šå°æ—¶æ‰ä¸Šèœï¼Œå‘³é“ä¹Ÿå¾ˆä¸€èˆ¬"ï¼Œåˆ™åº”åˆ¤æ–­ä¸º<strong>æ¶ˆæ</strong>ã€‚</p>
<h4 data-id="heading-3">1.2 æƒ…æ„Ÿåˆ†æçš„åº”ç”¨åœºæ™¯å’Œé¡¹ç›®æ„ä¹‰</h4>
<p>æƒ…æ„Ÿåˆ†ææŠ€æœ¯åœ¨å•†ä¸šå’Œç ”ç©¶é¢†åŸŸéƒ½æœ‰ç€å·¨å¤§çš„åº”ç”¨ä»·å€¼ï¼Œæ˜¯è®¸å¤šæ™ºèƒ½åº”ç”¨çš„åŸºç¡€æ¨¡å—ã€‚</p>






























<table><thead><tr><th>åº”ç”¨é¢†åŸŸ</th><th>å…·ä½“åœºæ™¯</th><th>é¡¹ç›®æ„ä¹‰</th></tr></thead><tbody><tr><td><strong>å•†ä¸šæ™ºèƒ½</strong></td><td>èˆ†æƒ…ç›‘æ§ã€å“ç‰Œå£°èª‰ç®¡ç†ã€äº§å“è¯„ä»·åˆ†æ</td><td>å®æ—¶äº†è§£å…¬ä¼—æƒ…ç»ªï¼Œä¼˜åŒ–äº§å“ï¼Œè¿›è¡Œå±æœºå…¬å…³</td></tr><tr><td><strong>å®¢æˆ·å…³ç³»</strong></td><td>åˆ†æå®¢æœå¯¹è¯ã€æœåŠ¡å·¥å•ã€ç”¨æˆ·æ»¡æ„åº¦é—®å·</td><td>è‡ªåŠ¨è¯„ä¼°å®¢æˆ·æ»¡æ„åº¦ï¼Œå‘ç°æœåŠ¡ç—›ç‚¹ï¼Œæå‡æœåŠ¡è´¨é‡</td></tr><tr><td><strong>é‡‘èç§‘æŠ€</strong></td><td>åˆ†æè´¢ç»æ–°é—»ã€ç¤¾äº¤åª’ä½“æƒ…ç»ªã€è‚¡è¯„</td><td>è¾…åŠ©é‡åŒ–äº¤æ˜“å’ŒæŠ•èµ„å†³ç­–</td></tr><tr><td><strong>ç¤¾ä¼šç§‘å­¦</strong></td><td>åˆ†æå…¬ä¼—å¯¹ç‰¹å®šç¤¾ä¼šäº‹ä»¶æˆ–æ”¿ç­–çš„æƒ…æ„Ÿå€¾å‘</td><td>ä¸ºç¤¾ä¼šå­¦ã€ä¼ æ’­å­¦ç­‰é¢†åŸŸçš„ç ”ç©¶æä¾›æ•°æ®å‚è€ƒ</td></tr></tbody></table>
<p>æœ¬é¡¹ç›®æ—¨åœ¨é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„å®æˆ˜æ¡ˆä¾‹ï¼Œè®©æ‚¨æŒæ¡å¦‚ä½•åˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹è§£å†³çœŸå®åœºæ™¯ä¸‹çš„æ–‡æœ¬åˆ†ç±»é—®é¢˜ï¼Œä¸ºæ‚¨åœ¨è‡ªå·±çš„ä¸šåŠ¡æˆ–ç ”ç©¶ä¸­åº”ç”¨NLPæŠ€æœ¯æ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚</p>
<h4 data-id="heading-4">1.3 ä¸ºä»€ä¹ˆé€‰æ‹© ERNIE æ¨¡å‹ï¼Ÿ</h4>
<p>åœ¨ä¼—å¤šé¢„è®­ç»ƒæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©Â <strong>ERNIE</strong>Â ä½œä¸ºæœ¬æ¬¡æ•™ç¨‹çš„æ ¸å¿ƒï¼Œä¸»è¦æœ‰ä»¥ä¸‹åŸå› ï¼š</p>
<p><strong>1. æ›´æ‡‚ä¸­æ–‡çš„é¢„è®­ç»ƒæœºåˆ¶</strong>ï¼šERNIE æ˜¯ç”±ç™¾åº¦æå‡ºçš„ã€é’ˆå¯¹ä¸­æ–‡è¯­è¨€ç‰¹ç‚¹è¿›è¡Œæ·±åº¦ä¼˜åŒ–çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚å®ƒä¸ä»…ä»…å­¦ä¹ å­—ä¸å­—ä¹‹é—´çš„å…³ç³»ï¼Œè¿˜é€šè¿‡<strong>çŸ¥è¯†æ©ç ç­–ç•¥ (Knowledge Masking Strategies)</strong> Â å­¦ä¹ äº†æ›´å®Œæ•´çš„è¯­ä¹‰å•å…ƒï¼ˆå¦‚è¯ã€çŸ­è¯­å’Œå®ä½“ï¼‰ã€‚</p>
<ul>
<li><strong>ä¸€ä¸ªç”ŸåŠ¨çš„æ¯”å–»</strong>ï¼šå¦‚æœæŠŠæ™®é€šæ¨¡å‹çš„å­¦ä¹ æ¯”ä½œåš"å®Œå½¢å¡«ç©º"ï¼Œæ¯æ¬¡åªæŒ–æ‰ä¸€ä¸ªå­—è®©å®ƒçŒœï¼›é‚£ä¹ˆERNIEçš„å­¦ä¹ å°±åƒæ˜¯åœ¨åšæ›´éš¾çš„"æˆè¯­å¡«ç©º"æˆ–"äººåå¡«ç©º"ã€‚ä¾‹å¦‚ï¼Œå®ƒä¼šæŠŠ"å“ˆåˆ©Â·æ³¢ç‰¹"æ•´ä¸ªè¯æŒ–æ‰ï¼Œç„¶åå»é¢„æµ‹è¿™ä¸ªè¢«æŒ–æ‰çš„å®ä½“ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒERNIEè¢«è¿«å­¦ä¹ åˆ°äº†"å“ˆåˆ©Â·æ³¢ç‰¹"æ˜¯ä¸€ä¸ªäººåï¼Œä»¥åŠä¸å®ƒç›¸å…³çš„å¤æ‚è¯­ä¹‰ï¼Œè€Œä¸æ˜¯ä»…ä»…æŠŠè¿™å‡ ä¸ªå­—çœ‹ä½œå­¤ç«‹çš„ç¬¦å·ã€‚</li>
</ul>
<p>è¿™ç§å¯¹çŸ¥è¯†çš„æ·±åº¦å­¦ä¹ ä½¿å¾—ERNIEåœ¨å¤„ç†ä¸­æ–‡ä»»åŠ¡æ—¶ï¼Œè¯­ä¹‰ç†è§£èƒ½åŠ›æ›´èƒœä¸€ç­¹ã€‚</p>
<p><strong>2. ä¸°å¯Œçš„æ¨¡å‹é€‰æ‹©ä¸é€‚ä¸­çš„è§„æ¨¡</strong>ï¼šPaddleNLP æä¾›äº†è¦†ç›–ä»å¤§åˆ°å°çš„å®Œæ•´ERNIEæ¨¡å‹å®¶æ—ã€‚å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘ä»¬é€‰æ‹©Â <code>ernie-3.0-medium-zh</code>ï¼Œå®ƒåœ¨æ€§èƒ½å’Œèµ„æºæ¶ˆè€—ä¹‹é—´å–å¾—äº†å¾ˆå¥½çš„å¹³è¡¡ã€‚</p>
<p>ä¸‹è¡¨å±•ç¤ºäº†PaddleNLPä¸­æ”¯æŒçš„éƒ¨åˆ†ERNIEä¸­æ–‡æ¨¡å‹ï¼š</p>





























































<table><thead><tr><th>æ¨¡å‹åç§° (Pretrained Weight)</th><th>å±‚æ•°</th><th>éšè—å±‚å¤§å°</th><th>æ³¨æ„åŠ›å¤´æ•°</th><th>å‚æ•°é‡</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><code>ernie-1.0-base-zh</code></td><td>12</td><td>768</td><td>12</td><td>108M</td><td>ç»å…¸çš„åŸºç¡€ç‰ˆERNIE</td></tr><tr><td><code>ernie-3.0-base-zh</code></td><td>12</td><td>768</td><td>12</td><td>118M</td><td>ERNIE 3.0çš„åŸºç¡€ç‰ˆ</td></tr><tr><td><strong><code>ernie-3.0-medium-zh</code></strong></td><td><strong>6</strong></td><td><strong>768</strong></td><td><strong>12</strong></td><td><strong>75M</strong></td><td><strong>æœ¬æ•™ç¨‹é€‰ç”¨ï¼Œè§„æ¨¡é€‚ä¸­ï¼Œæ•ˆæœä¼˜å¼‚</strong></td></tr><tr><td><code>ernie-3.0-mini-zh</code></td><td>6</td><td>384</td><td>12</td><td>27M</td><td>æ›´è½»é‡çš„ç‰ˆæœ¬</td></tr><tr><td><code>ernie-3.0-micro-zh</code></td><td>4</td><td>384</td><td>12</td><td>23M</td><td>å¾®å‹ç‰ˆæœ¬</td></tr><tr><td><code>ernie-3.0-xbase-zh</code></td><td>20</td><td>1024</td><td>16</td><td>296M</td><td>æ›´å¤§æ›´å¼ºçš„ç‰ˆæœ¬</td></tr></tbody></table>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>ernie-3.0-medium-zh</code>Â (75Må‚æ•°) æ¯”Â <code>base</code>Â (118Må‚æ•°) æ›´è½»é‡ï¼Œä½¿å¾—æˆ‘ä»¬åœ¨æ™®é€šçš„GPUä¸Šä¹Ÿèƒ½å¿«é€Ÿå®Œæˆè®­ç»ƒï¼Œéå¸¸é€‚åˆä½œä¸ºå…¥é—¨å’Œæ•™å­¦çš„æ¨¡å‹ã€‚</p>
<h4 data-id="heading-5">1.4 æœ¬æ•™ç¨‹çš„ç›®æ ‡ä¸å†…å®¹</h4>
<p>æœ¬æ•™ç¨‹é¢å‘å¯¹NLPå’Œæ·±åº¦å­¦ä¹ æœ‰åŸºæœ¬äº†è§£ï¼Œå¹¶å¸Œæœ›åŠ¨æ‰‹å®è·µè§£å†³çœŸå®é—®é¢˜çš„å¼€å‘è€…å’Œå­¦ä¹ è€…ã€‚é€šè¿‡æœ¬æ•™ç¨‹ï¼Œæ‚¨å°†ï¼š</p>
<ul>
<li>ç†è§£æƒ…æ„Ÿåˆ†æä»»åŠ¡çš„åŸºæœ¬æµç¨‹ã€‚</li>
<li>å­¦ä¼šä½¿ç”¨ PaddleNLP åŠ è½½å’Œå¤„ç†ä¸­æ–‡æ•°æ®é›†ã€‚</li>
<li>æŒæ¡å¦‚ä½•åŠ è½½é¢„è®­ç»ƒçš„ ERNIE æ¨¡å‹ï¼Œå¹¶é’ˆå¯¹ç‰¹å®šä»»åŠ¡è¿›è¡Œå¾®è°ƒ (Fine-tuning)ã€‚</li>
<li>ä»é›¶å¼€å§‹ï¼Œç”¨ä¸åˆ°100è¡Œæ ¸å¿ƒä»£ç ï¼Œè®­ç»ƒä¸€ä¸ªé«˜ç²¾åº¦çš„ä¸­æ–‡æƒ…æ„Ÿåˆ†ææ¨¡å‹ã€‚</li>
<li>å­¦ä¼šè¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼Œå¹¶ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹å¯¹æ–°çš„æ–‡æœ¬è¿›è¡Œæƒ…æ„Ÿé¢„æµ‹ã€‚</li>
</ul>
<p>è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p>
<h3 data-id="heading-6">2. ç¯å¢ƒå‡†å¤‡</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å®‰è£…äº†å¿…éœ€çš„åº“ã€‚æœ¬æ•™ç¨‹ä¸»è¦ä¾èµ– PaddlePaddle å’Œ PaddleNLPã€‚</p>
<p>In [36]</p>
<pre><code class="hljs language-css" lang="css">!pip install <span class="hljs-attr">--upgrade</span> <span class="hljs-attr">--pre</span> paddlenlp==<span class="hljs-number">3.0</span>.<span class="hljs-number">0</span>b4
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥å¯¼å…¥å¹¶æ£€æŸ¥ç‰ˆæœ¬ä¿¡æ¯ï¼Œä»¥ç¡®ä¿ç¯å¢ƒé…ç½®æ­£ç¡®ã€‚</p>
<p>In [37]</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> paddle
<span class="hljs-keyword">import</span> paddlenlp

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"PaddlePaddle Version: <span class="hljs-subst">{paddle.__version__}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"PaddleNLP Version: <span class="hljs-subst">{paddlenlp.__version__}</span>"</span>)

<span class="hljs-comment"># æ£€æŸ¥GPUæ˜¯å¦å¯ç”¨</span>
<span class="hljs-keyword">if</span> paddle.is_compiled_with_cuda():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"PaddlePaddle is compiled with CUDA and GPU is available."</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"PaddlePaddle is not compiled with CUDA. It will use CPU."</span>)
</code></pre>
<p>ç¯å¢ƒå‡†å¤‡éå¸¸ç®€å•ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åŠ è½½ç”¨äºæœ¬æ¬¡ä»»åŠ¡çš„æ•°æ®é›†ã€‚</p>
<h3 data-id="heading-7">3. æ•°æ®å‡†å¤‡</h3>
<p>å¯¹äºæƒ…æ„Ÿåˆ†æä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª<strong>å·²æ ‡æ³¨</strong>çš„æ•°æ®é›†ï¼Œå…¶ä¸­æ¯æ¡æ–‡æœ¬éƒ½å¯¹åº”ä¸€ä¸ªæƒ…æ„Ÿæ ‡ç­¾ï¼ˆå¦‚"ç§¯æ"æˆ–"æ¶ˆæ"ï¼‰ã€‚</p>
<h4 data-id="heading-8">3.1 åŠ è½½ ChnSentiCorp æ•°æ®é›†</h4>
<p>PaddleNLP å†…ç½®äº†è®¸å¤šå¸¸ç”¨çš„NLPæ•°æ®é›†ï¼ŒåŒ…æ‹¬ä¸­æ–‡æƒ…æ„Ÿåˆ†æé¢†åŸŸçš„ç»å…¸æ•°æ®é›†Â <strong><code>ChnSentiCorp</code></strong>ã€‚è¿™ä¸ªæ•°æ®é›†åŒ…å«é…’åº—ã€ä¹¦ç±ã€ç”µè„‘ç­‰å¤šä¸ªé¢†åŸŸçš„è¯„è®ºæ•°æ®ï¼Œæ¯æ¡è¯„è®ºè¢«æ ‡æ³¨ä¸ºæ­£é¢ï¼ˆæ ‡ç­¾<code>1</code>ï¼‰æˆ–è´Ÿé¢ï¼ˆæ ‡ç­¾<code>0</code>ï¼‰ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Â <code>paddlenlp.datasets.load_dataset</code>Â å‡½æ•°ä¸€é”®åŠ è½½å®ƒã€‚</p>
<p>In [38]</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> paddlenlp.datasets <span class="hljs-keyword">import</span> load_dataset

<span class="hljs-comment"># åŠ è½½ChnSentiCorpæ•°æ®é›†çš„è®­ç»ƒé›†ã€å¼€å‘é›†å’Œæµ‹è¯•é›†</span>
train_ds, dev_ds, test_ds = load_dataset(
    <span class="hljs-string">'chnsenticorp'</span>, splits=[<span class="hljs-string">'train'</span>, <span class="hljs-string">'dev'</span>, <span class="hljs-string">'test'</span>]
)

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®é›†ä¿¡æ¯</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è®­ç»ƒé›†æ ·æœ¬æ•°é‡: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(train_ds)}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼€å‘é›†æ ·æœ¬æ•°é‡: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(dev_ds)}</span>"</span>)   <span class="hljs-comment">#å¼€å‘é›†ç”¨äºæ¨¡å‹çš„è°ƒä¼˜ï¼Œå¦‚è°ƒæ•´è¶…å‚æ•°ï¼Ÿï¼Ÿ</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æµ‹è¯•é›†æ ·æœ¬æ•°é‡: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(test_ds)}</span>"</span>)
</code></pre>
<h4 data-id="heading-9">3.2 æ¢ç´¢æ•°æ®</h4>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ•°æ®é›†ä¸­çš„æ ·æœ¬é•¿ä»€ä¹ˆæ ·ã€‚æ¯ä¸ªæ ·æœ¬éƒ½æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«Â <code>text</code>Â (è¯„è®ºæ–‡æœ¬) å’ŒÂ <code>label</code>Â (æƒ…æ„Ÿæ ‡ç­¾) ä¸¤ä¸ªå­—æ®µã€‚</p>
<p>In [39]</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ‰“å°å‡ æ¡è®­ç»ƒé›†æ ·æœ¬</span>
<span class="hljs-comment"># lableå€¼ä¸º1ï¼Œåˆ™ä¸ºç§¯æï¼›å€¼ä¸º0ï¼Œåˆ™ä¸ºæ¶ˆæã€‚æ¨¡å‹å­¦ä¹ çš„ç›®æ ‡å°±æ˜¯çœ‹åˆ°textï¼ŒçŒœlabel</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- è®­ç»ƒé›†æ ·æœ¬ç¤ºä¾‹ ---"</span>)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ ·æœ¬ <span class="hljs-subst">{i}</span>:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ–‡æœ¬: <span class="hljs-subst">{train_ds[i][<span class="hljs-string">'text'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ ‡ç­¾: <span class="hljs-subst">{train_ds[i][<span class="hljs-string">'label'</span>]}</span> (<span class="hljs-subst">{<span class="hljs-string">'ç§¯æ'</span> <span class="hljs-keyword">if</span> train_ds[i][<span class="hljs-string">'label'</span>] == <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'æ¶ˆæ'</span>}</span>)"</span>)

<span class="hljs-comment"># æ‰“å°å‡ æ¡å¼€å‘é›†æ ·æœ¬</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- å¼€å‘é›†æ ·æœ¬ç¤ºä¾‹ ---"</span>)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ ·æœ¬ <span class="hljs-subst">{i}</span>:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ–‡æœ¬: <span class="hljs-subst">{dev_ds[i][<span class="hljs-string">'text'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ ‡ç­¾: <span class="hljs-subst">{dev_ds[i][<span class="hljs-string">'label'</span>]}</span> (<span class="hljs-subst">{<span class="hljs-string">'ç§¯æ'</span> <span class="hljs-keyword">if</span> dev_ds[i][<span class="hljs-string">'label'</span>] == <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'æ¶ˆæ'</span>}</span>)"</span>)
</code></pre>
<h4 data-id="heading-10">3.3 æ•°æ®é¢„å¤„ç†ä¸ Tokenization</h4>
<p>ä¸ºäº†è®©æ•°æ®èƒ½è¢«ERNIEæ¨¡å‹å¤„ç†ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¸¤ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
<ol>
<li><strong>Tokenization</strong>ï¼šå°†åŸå§‹çš„æ–‡æœ¬å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ¨¡å‹èƒ½å¤Ÿç†è§£çš„æ•°å­—IDåºåˆ—ã€‚è¿™ä¸ªè¿‡ç¨‹ç”±Â <strong>Tokenizer</strong>Â å®Œæˆã€‚</li>
<li><strong>æ ¼å¼è½¬æ¢</strong>ï¼šå°†Tokenizedåçš„æ•°æ®æ•´ç†æˆæ¨¡å‹è®­ç»ƒæ—¶æ¥å—çš„æ ¼å¼ï¼ˆå¦‚å­—å…¸ï¼‰ï¼Œå¹¶è½¬æ¢ä¸ºÂ <code>paddle.Tensor</code>ã€‚</li>
</ol>
<h5 data-id="heading-11">3.3.1 åŠ è½½ Tokenizer</h5>
<p>PaddleNLPä¸ºæ¯ä¸ªé¢„è®­ç»ƒæ¨¡å‹éƒ½æä¾›äº†é…å¥—çš„Tokenizerã€‚æˆ‘ä»¬é€‰æ‹©ä¸Â <code>ernie-3.0-medium-zh</code>Â æ¨¡å‹åŒ¹é…çš„Â <code>ErnieTokenizer</code>ã€‚</p>
<p>In [40]</p>
<pre><code class="hljs language-ini" lang="ini">from paddlenlp.transformers import AutoTokenizer

<span class="hljs-comment"># å®šä¹‰è¦ä½¿ç”¨çš„æ¨¡å‹åç§°</span>
<span class="hljs-attr">MODEL_NAME</span> = <span class="hljs-string">"ernie-3.0-medium-zh"</span>

<span class="hljs-comment"># åŠ è½½å¯¹åº”çš„Tokenizerï¼ŒAutoTokenizeræ˜¯PaddleNLPæä¾›çš„ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œä¼šæ ¹æ®ç»™å®šçš„æ¨¡å‹åç§°ï¼ŒåŠ è½½å¯¹åº”çš„åˆ†è¯å™¨</span>
<span class="hljs-attr">tokenizer</span> = AutoTokenizer.from_pretrained(MODEL_NAME)
</code></pre>
<h5 data-id="heading-12">3.3.2 æ„é€ æ•°æ®å¤„ç†å‡½æ•°</h5>
<p>æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªÂ <code>convert_example</code>Â å‡½æ•°ï¼Œå®ƒè´Ÿè´£å¯¹<strong>å•ä¸ªæ ·æœ¬</strong>è¿›è¡Œå¤„ç†ã€‚è¯¥å‡½æ•°ä¼šï¼š</p>
<ol>
<li>è°ƒç”¨Â <code>tokenizer</code>Â å¯¹æ–‡æœ¬è¿›è¡Œç¼–ç ã€‚</li>
<li>è¿”å›ä¸€ä¸ªåŒ…å«Â <code>input_ids</code>,Â <code>token_type_ids</code>Â å’ŒÂ <code>label</code>Â çš„å­—å…¸ã€‚</li>
</ol>
<p><code>tokenizer()</code>Â å‡½æ•°ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨å®Œæˆå¤§éƒ¨åˆ†å·¥ä½œï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å°†æ–‡æœ¬åˆ‡åˆ†æˆå­—æˆ–è¯ (Token)ã€‚</li>
<li>å°†Tokenè½¬æ¢ä¸ºæ•°å­—IDã€‚</li>
<li>æ·»åŠ ç‰¹æ®Šçš„Tokenï¼Œå¦‚Â <code>[CLS]</code>ï¼ˆé€šå¸¸ç”¨ä½œå¥å­çº§åˆ«çš„è¡¨ç¤ºï¼‰å’ŒÂ <code>[SEP]</code>ï¼ˆåˆ†éš”ç¬¦ï¼‰ã€‚</li>
</ul>
<p>In [41]</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> functools

<span class="hljs-comment"># example è¡¨ç¤ºä¸€ä¸ªè¾“å…¥çš„æ•°æ®</span>
<span class="hljs-comment"># è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ï¼šå°†æ¯æ¡æ•°æ®è½¬åŒ–ä¸ºæ¨¡å‹æ‰€éœ€è¦çš„è¾“å…¥æ ¼å¼</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">convert_example</span>(<span class="hljs-params">example, tokenizer, max_seq_length=<span class="hljs-number">128</span></span>):
    <span class="hljs-string">"""
    å°†å•ä¸ªæ ·æœ¬è½¬æ¢ä¸ºæ¨¡å‹å¯æ¥å—çš„æ ¼å¼ã€‚
    """</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å¯¹è¾“å…¥æ–‡æœ¬è¿›è¡Œç¼–ç </span>
        encoded_inputs = tokenizer(text=example[<span class="hljs-string">"text"</span>], max_seq_len=max_seq_length)
        
        <span class="hljs-comment"># æå– input_ids å’Œ token_type_ids</span>
        <span class="hljs-comment"># input_idsï¼šæ¯ä¸ªå­—å¯¹åº”çš„æ•°å­—ID</span>
        <span class="hljs-comment"># token_type_ids ç”¨äºåŒºåˆ†ä¸åŒå¥å­ï¼Œå•å¥åˆ†ç±»ä»»åŠ¡å…¨æ˜¯0</span>
        input_ids = encoded_inputs[<span class="hljs-string">"input_ids"</span>]
        token_type_ids = encoded_inputs[<span class="hljs-string">"token_type_ids"</span>]
        

        label_str = example.get(<span class="hljs-string">"label"</span>, <span class="hljs-string">""</span>)   <span class="hljs-comment">#è·å–çš„æ ‡ç­¾æ˜¯"1"æˆ–"0" å­—ç¬¦ä¸²æ ¼å¼</span>
        <span class="hljs-keyword">if</span> label_str == <span class="hljs-string">""</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span> <span class="hljs-comment"># å¦‚æœlabelä¸ºç©ºï¼Œåˆ™è·³è¿‡è¯¥æ ·æœ¬</span>
        <span class="hljs-comment"># æŠŠæƒ…æ„Ÿæ ‡ç­¾è½¬åŒ–ä¸ºæ•´æ•°ï¼Œå¹¶åŒ…è£…ä¸ºtensoræ ¼å¼</span>
        label = paddle.to_tensor([<span class="hljs-built_in">int</span>(label_str)], dtype=<span class="hljs-string">"int64"</span>)
        
        <span class="hljs-comment"># è¿”å›æ¨¡å‹æ¥å—çš„æ ¼å¼</span>
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"input_ids"</span>: input_ids, <span class="hljs-string">"token_type_ids"</span>: token_type_ids, <span class="hljs-string">"labels"</span>: label}
    
    <span class="hljs-keyword">except</span> (ValueError, TypeError):
        <span class="hljs-comment"># å¦‚æœ int() è½¬æ¢å¤±è´¥æˆ– example æ ¼å¼ä¸æ­£ç¡®ï¼Œä¹Ÿè·³è¿‡è¯¥æ ·æœ¬</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Skipping invalid sample: <span class="hljs-subst">{example}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

<span class="hljs-comment"># functools.partialï¼šå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå›ºå®šäº†åŸå§‹å‡½æ•°çš„æŸäº›å‚æ•°</span>
<span class="hljs-comment"># å›ºå®šäº†convert_exampleå‡½æ•°çš„tokenizer å’Œ max_seq_lengthå‚æ•°</span>
trans_func = functools.partial(convert_example, tokenizer=tokenizer, max_seq_length=<span class="hljs-number">128</span>)

<span class="hljs-comment"># -- é²æ£’æ€§æ£€æŸ¥ --</span>
<span class="hljs-comment"># æ£€æŸ¥ train_ds æ˜¯å¦å·²è¢«å¤„ç† (å³å…¶å…ƒç´ æ˜¯å¦ä¸ºå…ƒç»„)ã€‚å¦‚æœæ˜¯ï¼Œåˆ™é‡æ–°åŠ è½½åŸå§‹æ•°æ®é›†ã€‚</span>
<span class="hljs-comment"># ä¸ºäº†é˜²æ­¢ä»£ç è¢«å¤šæ¬¡è¿è¡Œæ—¶å‡ºç°æ•°æ®é‡å¤å¤„ç†çš„æƒ…å†µ</span>
<span class="hljs-keyword">if</span> train_ds <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(train_ds[<span class="hljs-number">0</span>], <span class="hljs-built_in">tuple</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ£€æµ‹åˆ°æ•°æ®é›†å·²è¢«å¤„ç†ï¼Œæ­£åœ¨é‡æ–°åŠ è½½åŸå§‹æ•°æ®é›†..."</span>)
    train_ds, dev_ds, test_ds = load_dataset(<span class="hljs-string">'chnsenticorp'</span>, splits=[<span class="hljs-string">'train'</span>, <span class="hljs-string">'dev'</span>, <span class="hljs-string">'test'</span>])
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŸå§‹æ•°æ®é›†å·²é‡æ–°åŠ è½½ã€‚"</span>)

<span class="hljs-comment"># ä½¿ç”¨ map æ–¹æ³•å¯¹æ•°æ®é›†ä¸­çš„æ‰€æœ‰æ ·æœ¬åº”ç”¨ trans_func</span>
<span class="hljs-comment"># lazy=False è¡¨ç¤ºç«‹åˆ»å¯¹æ•°æ®é›†è¿›è¡Œå¤„ç†ï¼›å¦‚æœæ˜¯Trueï¼Œç›´åˆ°å®é™…è®¿é—®æ—¶æ‰ä¼šè½¬æ¢</span>
<span class="hljs-comment"># mapä¼šå°†æ¯ä¸ªæ ·æœ¬éƒ½ä¼ é€’ç»™trans_funcï¼Œä»è€Œå°†æ–‡æœ¬è½¬åŒ–ä¸ºéœ€è¦çš„æ ¼å¼</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\næ­£åœ¨å¯¹æ•°æ®é›†è¿›è¡Œé¢„å¤„ç†..."</span>)
train_ds_processed_raw = train_ds.<span class="hljs-built_in">map</span>(trans_func, lazy=<span class="hljs-literal">False</span>)
dev_ds_processed_raw = dev_ds.<span class="hljs-built_in">map</span>(trans_func, lazy=<span class="hljs-literal">False</span>)
test_ds_processed_raw = test_ds.<span class="hljs-built_in">map</span>(trans_func, lazy=<span class="hljs-literal">False</span>)

<span class="hljs-comment"># è¿‡æ»¤æ‰è¿”å›å€¼ä¸º None çš„æ— æ•ˆæ ·æœ¬</span>
train_ds_processed = [item <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> train_ds_processed_raw <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>]
dev_ds_processed = [item <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> dev_ds_processed_raw <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>]
test_ds_processed = [item <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> test_ds_processed_raw <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>]

<span class="hljs-comment"># é‡æ–°åŒ…è£…ä¸º MapDataset (å¯é€‰ï¼Œä½†ä¸ºäº†åç»­APIä¸€è‡´æ€§æ›´å¥½)</span>
<span class="hljs-keyword">from</span> paddlenlp.datasets <span class="hljs-keyword">import</span> MapDataset
train_ds_processed = MapDataset(train_ds_processed)
dev_ds_processed = MapDataset(dev_ds_processed)
test_ds_processed = MapDataset(test_ds_processed)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ•°æ®é¢„å¤„ç†å’Œæ¸…æ´—å®Œæˆï¼"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤„ç†åè®­ç»ƒé›†æ ·æœ¬æ•°é‡: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(train_ds_processed)}</span>"</span>)
<span class="hljs-comment"># æŸ¥çœ‹ä¸€ä¸ªå¤„ç†åçš„æ ·æœ¬</span>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(train_ds_processed) &gt; <span class="hljs-number">0</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¤„ç†åçš„ç¬¬ä¸€ä¸ªè®­ç»ƒæ ·æœ¬:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  Input IDs: <span class="hljs-subst">{train_ds_processed[<span class="hljs-number">0</span>][<span class="hljs-string">'input_ids'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  Token Type IDs: <span class="hljs-subst">{train_ds_processed[<span class="hljs-number">0</span>][<span class="hljs-string">'token_type_ids'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  Label: <span class="hljs-subst">{train_ds_processed[<span class="hljs-number">0</span>][<span class="hljs-string">'labels'</span>]}</span>"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ²¡æœ‰æœ‰æ•ˆçš„è®­ç»ƒæ ·æœ¬è¢«å¤„ç†ã€‚"</span>)
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†å·²ç»å‡†å¤‡å¥½äº†ï¼Œæ¯ä¸ªæ ·æœ¬éƒ½åŒ…å«äº†æ¨¡å‹è®­ç»ƒæ‰€éœ€çš„Â <code>input_ids</code>,Â <code>token_type_ids</code>, å’ŒÂ <code>label</code>ã€‚</p>
<h4 data-id="heading-13">3.4 æ„é€  DataLoader</h4>
<p>æœ€åä¸€æ­¥æ˜¯å°†å¤„ç†å¥½çš„æ•°æ®é›†ç»„ç»‡æˆæ‰¹æ¬¡ (Batch) çš„å½¢å¼ï¼Œä»¥ä¾¿åœ¨è®­ç»ƒæ—¶é«˜æ•ˆåœ°é€å…¥æ¨¡å‹ã€‚æˆ‘ä»¬ä½¿ç”¨Â <code>paddle.io.DataLoader</code>Â æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚å®ƒè¿˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ•°æ®çš„æ‰“ä¹± (shuffle) å’Œè‡ªåŠ¨çš„æ‰¹å¤„ç†ã€‚</p>
<p>æˆ‘ä»¬ä¼šä½¿ç”¨Â <code>paddlenlp.data.DataCollatorWithPadding</code>Â æ¥è‡ªåŠ¨åœ°å°†æ¯ä¸ªæ‰¹æ¬¡å†…çš„æ ·æœ¬å¡«å…… (padding) åˆ°è¯¥æ‰¹æ¬¡ä¸­æœ€é•¿æ ·æœ¬çš„é•¿åº¦ã€‚</p>
<p>In [42]</p>
<pre><code class="hljs language-ini" lang="ini">from paddle.io import DataLoader
from paddlenlp.data import DataCollatorWithPadding

<span class="hljs-comment"># åˆå§‹åŒ– DataCollatorï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†æ‰¹æ•°æ®çš„padding</span>
<span class="hljs-attr">collator</span> = DataCollatorWithPadding(tokenizer)

<span class="hljs-comment"># å®šä¹‰æ‰¹å¤§å°</span>
<span class="hljs-attr">batch_size</span> = <span class="hljs-number">32</span>

<span class="hljs-comment"># åˆ›å»ºDataLoaderï¼Œè´Ÿè´£æŒ‰æ‰¹æ¬¡åŠ è½½æ•°æ®</span>
<span class="hljs-attr">train_loader</span> = DataLoader(
    <span class="hljs-attr">dataset</span>=train_ds,
    <span class="hljs-attr">batch_size</span>=batch_size,
    <span class="hljs-attr">shuffle</span>=<span class="hljs-literal">True</span>, <span class="hljs-comment"># è®­ç»ƒæ—¶æ‰“ä¹±æ•°æ®</span>
    <span class="hljs-attr">collate_fn</span>=collator  <span class="hljs-comment"># ä½¿ç”¨DataCollatorWithPaddingå¯¹æ¯æ‰¹æ•°æ®è¿›è¡Œå¡«å……ï¼Œä½¿å¾—æ‰€æœ‰å¥å­çš„é•¿åº¦ç›¸åŒ</span>
)
<span class="hljs-attr">dev_loader</span> = DataLoader(
    <span class="hljs-attr">dataset</span>=dev_ds,
    <span class="hljs-attr">batch_size</span>=batch_size,
    <span class="hljs-attr">shuffle</span>=<span class="hljs-literal">False</span>, <span class="hljs-comment"># è¯„ä¼°æ—¶ä¸éœ€è¦æ‰“ä¹±</span>
    <span class="hljs-attr">collate_fn</span>=collator
)
<span class="hljs-attr">test_loader</span> = DataLoader(
    <span class="hljs-attr">dataset</span>=test_ds,
    <span class="hljs-attr">batch_size</span>=batch_size,
    <span class="hljs-attr">shuffle</span>=<span class="hljs-literal">False</span>,
    <span class="hljs-attr">collate_fn</span>=collator
)

<span class="hljs-comment"># æŸ¥çœ‹ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®å½¢çŠ¶</span>
print("\nDataLoaderå‡†å¤‡å®Œæˆï¼")
for batch in train_loader:
    print("ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®:")
    for key, value in batch.items():
        print(f"  {key}: <span class="hljs-attr">shape</span>={value.shape}<span class="hljs-string">")
    break # åªçœ‹ç¬¬ä¸€ä¸ªæ‰¹æ¬¡
</span></code></pre>
<p>è‡³æ­¤ï¼Œæ•°æ®å‡†å¤‡çš„å…¨éƒ¨å·¥ä½œå·²ç»å®Œæˆã€‚æˆ‘ä»¬æ‹¥æœ‰äº†å¯ä»¥éšæ—¶é€å…¥æ¨¡å‹è¿›è¡Œè®­ç»ƒçš„DataLoaderã€‚</p>
<h3 data-id="heading-14">4. æ¨¡å‹ä¸å¾®è°ƒåŸç†</h3>
<p>åœ¨æ•°æ®å‡†å¤‡å°±ç»ªåï¼Œæˆ‘ä»¬éœ€è¦ç†è§£æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„æ¨¡å‹ä»¥åŠå¦‚ä½•è®©å®ƒé€‚åº”æˆ‘ä»¬çš„æƒ…æ„Ÿåˆ†æä»»åŠ¡ã€‚</p>
<h4 data-id="heading-15">4.1 ERNIE æ¨¡å‹ç®€ä»‹ï¼šä¸€ä½æ‡‚çŸ¥è¯†çš„è¯­è¨€å¤§å¸ˆ</h4>
<p>æ­£å¦‚å¼•è¨€ä¸­æ‰€è¯´ï¼ŒERNIE æ˜¯ä¸€ä¸ªæ›´"æ‡‚"ä¸­æ–‡çš„æ¨¡å‹ã€‚å®ƒçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå…¶ç‹¬ç‰¹çš„<strong>çŸ¥è¯†æ•´åˆé¢„è®­ç»ƒä»»åŠ¡</strong>ã€‚</p>
<ul>
<li>
<p><strong>ä¸€ä¸ªæ›´æ·±å…¥çš„æ¯”å–»</strong>ï¼š æƒ³è±¡ä¸€ä¸ªå­¦ç”Ÿï¼ˆå…¶ä»–æ¨¡å‹ï¼‰åœ¨å­¦ä¹ ä¸€å¥è¯ï¼š"ä¸­å›½å››å¤§å‘æ˜ä¹‹ä¸€çš„æ´»å­—å°åˆ·æœ¯æ˜¯ç”±æ¯•æ˜‡å‘æ˜çš„ã€‚" è¿™ä¸ªå­¦ç”Ÿå¯èƒ½é€šè¿‡"å•å­—å¡«ç©º"å­¦ä¼šäº†"ï¼ˆæ´»ï¼‰å­—å°åˆ·æœ¯"å’Œ"æ¯•ï¼ˆæ˜‡ï¼‰"è¿™äº›å­—ã€‚</p>
<p>è€ŒERNIEè¿™ä½"å­¦éœ¸"åˆ™ä¸åŒï¼Œè€å¸ˆä¼šç›´æ¥å°†"<strong>æ´»å­—å°åˆ·æœ¯</strong>"å’Œ"<strong>æ¯•æ˜‡</strong>"è¿™ä¸¤ä¸ªå®Œæ•´çš„çŸ¥è¯†å•å…ƒç›–ä½ï¼Œè®©ä»–å»é¢„æµ‹ã€‚ä¸ºäº†èƒ½ç­”å¯¹ï¼ŒERNIEä¸ä»…ä»…è¦å­¦ä¹ è¯­è¨€çš„æµç•…æ€§ï¼Œæ›´è¢«è¿«å»ç†è§£"æ´»å­—å°åˆ·æœ¯"æ˜¯ä¸€ä¸ªå®Œæ•´çš„æŠ€æœ¯æ¦‚å¿µï¼Œ"æ¯•æ˜‡"æ˜¯ä¸€ä¸ªäººåï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªçŸ¥è¯†å•å…ƒä¹‹é—´å­˜åœ¨"å‘æ˜"çš„å…³è”ã€‚</p>
<p>é€šè¿‡åœ¨æµ·é‡æ–‡æœ¬ä¸Šè¿›è¡Œè¿™ç§"çŸ¥è¯†ç‚¹æŒ–æ˜"å¼çš„å­¦ä¹ ï¼ŒERNIEæ„å»ºäº†æ›´æ·±å±‚æ¬¡çš„è¯­ä¹‰ç†è§£èƒ½åŠ›ï¼Œè€Œä¸ä»…ä»…æ˜¯è¡¨é¢çš„æ–‡å­—ç»„åˆã€‚</p>
</li>
</ul>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆERNIEåœ¨éœ€è¦ç†è§£å¥å­æ·±å±‚å«ä¹‰çš„ä»»åŠ¡ï¼ˆå¦‚æƒ…æ„Ÿåˆ†æï¼‰ä¸Šé€šå¸¸è¡¨ç°å¾—æ›´å¥½çš„åŸå› ã€‚</p>
<h4 data-id="heading-16">4.2 å¾®è°ƒ (Fine-tuning) åŸç†ï¼šä¸ºè¯­è¨€å¤§å¸ˆé…ä¸Š"æƒ…æ„Ÿåˆ†æçœ¼é•œ"</h4>
<p>æˆ‘ä»¬åŠ è½½çš„Â <code>ernie-3.0-medium-zh</code>Â æ¨¡å‹æ˜¯ä¸€ä½åšå­¦çš„"é€šæ‰"ï¼Œå®ƒæ‡‚å¾—è¯­è¨€çš„å„ç§çŸ¥è¯†ï¼Œä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå¹¶ä¸çŸ¥é“è‡ªå·±éœ€è¦åš"æƒ…æ„Ÿåˆ†æ"è¿™é¡¹å…·ä½“å·¥ä½œã€‚<strong>å¾®è°ƒ (Fine-tuning)</strong> Â çš„è¿‡ç¨‹ï¼Œå°±å¥½æ¯”æ˜¯ä¸ºè¿™ä½è¯­è¨€å¤§å¸ˆé…ä¸Šä¸€å‰¯ç‰¹åˆ¶çš„"æƒ…æ„Ÿåˆ†æçœ¼é•œ"ï¼Œå¹¶æŒ‡å¯¼ä»–å¦‚ä½•ä½¿ç”¨ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹åˆ†ä¸ºå‡ æ­¥ï¼š</p>
<ol>
<li>
<p><strong>è·å–å¥å­çš„"çµé­‚"â€”â€”[CLS]è¾“å‡º</strong>ï¼š</p>
<ul>
<li>æˆ‘ä»¬å°†ä¸€æ¡è¯„è®ºæ–‡æœ¬ï¼ˆä¾‹å¦‚"è¿™å®¶åº—çš„æ‹‰é¢çœŸå¥½åƒï¼"ï¼‰é€å…¥ERNIEæ¨¡å‹ã€‚åœ¨é€å…¥å‰ï¼Œæˆ‘ä»¬åœ¨æ–‡æœ¬æœ€å‰é¢åŠ ä¸Šä¸€ä¸ªç‰¹æ®Šçš„æ ‡å¿—Â <code>[CLS]</code>Â (Classification)ã€‚</li>
<li>ç»è¿‡ERNIEå†…éƒ¨å¤æ‚çš„è®¡ç®—ï¼ˆå¤šå±‚Transformerï¼‰ï¼Œæ¯ä¸ªå­—è¯éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå¯Œå«ä¸Šä¸‹æ–‡ä¿¡æ¯çš„å‘é‡ã€‚è€Œè¿™ä¸ªç‰¹æ®Šçš„Â <code>[CLS]</code>Â æ ‡å¿—ï¼Œåœ¨ç»è¿‡æ•´ä¸ªæ¨¡å‹åï¼Œå®ƒå¯¹åº”çš„è¾“å‡ºå‘é‡ (<code>pooled_output</code>) å°±è¢«è®¾è®¡ä¸ºå‡èšäº†æ•´ä¸ªå¥å­çš„æ ¸å¿ƒè¯­ä¹‰ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ¯”ä½œERNIEè¯»å®Œä¸€å¥è¯åï¼Œåœ¨è„‘æµ·ä¸­å½¢æˆçš„å¯¹è¿™å¥è¯çš„"æ•´ä½“å°è±¡"æˆ–"çµé­‚"å‘é‡ã€‚</li>
</ul>
</li>
<li>
<p><strong>å®‰è£…"æƒ…æ„Ÿåˆ†æé•œç‰‡"â€”â€”æ·»åŠ åˆ†ç±»å¤´</strong>ï¼š</p>
<ul>
<li>è¿™ä¸ª"çµé­‚"å‘é‡ï¼ˆä¾‹å¦‚ä¸€ä¸ª768ç»´çš„å‘é‡ï¼‰æœ¬èº«è¿˜åªæ˜¯ä¸€ä¸²æ•°å­—ï¼Œä¸ç›´æ¥ä»£è¡¨"ç§¯æ"æˆ–"æ¶ˆæ"ã€‚</li>
<li>æˆ‘ä»¬åœ¨è¿™ä¸²æ•°å­—åé¢æ¥ä¸Šä¸€ä¸ªéå¸¸ç®€å•çš„"é•œç‰‡"â€”â€”ä¸€ä¸ª<strong>å…¨è¿æ¥å±‚ (Linear Layer)</strong> ã€‚è¿™ä¸ªå…¨è¿æ¥å±‚å°±æ˜¯"åˆ†ç±»å¤´"ï¼Œå®ƒçš„ä»»åŠ¡éå¸¸ä¸“ä¸€ï¼šæ¥æ”¶ä»£è¡¨å¥å­çµé­‚çš„å‘é‡ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºå¯¹æˆ‘ä»¬ä»»åŠ¡æœ‰æ„ä¹‰çš„è¾“å‡ºã€‚</li>
<li>åœ¨æˆ‘ä»¬çš„äºŒåˆ†ç±»ä»»åŠ¡ä¸­ï¼Œè¿™ä¸ª"é•œç‰‡"æœ‰ä¸¤ä¸ªè¾“å‡ºç¥ç»å…ƒï¼Œä¸€ä¸ªä»£è¡¨"æ¶ˆæ"çš„å¯èƒ½æ€§ï¼Œä¸€ä¸ªä»£è¡¨"ç§¯æ"çš„å¯èƒ½æ€§ã€‚</li>
</ul>
</li>
<li>
<p><strong>"æ ¡å‡†çœ¼é•œ"â€”â€”è®­ç»ƒä¸åå‘ä¼ æ’­</strong>ï¼š</p>
<ul>
<li>ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæˆ´ç€"æƒ…æ„Ÿåˆ†æçœ¼é•œ"çš„ERNIEæ¨¡å‹ã€‚æˆ‘ä»¬æŠŠå‡†å¤‡å¥½çš„æ ‡æ³¨æ•°æ®ï¼ˆæˆåƒä¸Šä¸‡æ¡å·²çŸ¥æƒ…æ„Ÿçš„è¯„è®ºï¼‰å–‚ç»™å®ƒã€‚</li>
<li>å¯¹äºæ¯æ¡è¯„è®ºï¼Œæ¨¡å‹ä¼šé€šè¿‡"çœ¼é•œ"ç»™å‡ºä¸€ä¸ªåˆæ­¥çš„åˆ¤æ–­ï¼ˆä¾‹å¦‚ï¼Œ"æ¶ˆæ"å¾—åˆ†0.1ï¼Œ"ç§¯æ"å¾—åˆ†0.9ï¼‰ã€‚</li>
<li>æˆ‘ä»¬æ‹¿è¿™ä¸ªåˆ¤æ–­å’ŒçœŸå®æ ‡ç­¾ï¼ˆæ¯”å¦‚è¿™æ¡è¯„è®ºçš„çœŸå®æ ‡ç­¾æ˜¯"ç§¯æ"ï¼‰å»æ¯”è¾ƒã€‚å¦‚æœåˆ¤æ–­å‡†ç¡®ï¼Œè¯´æ˜"çœ¼é•œ"æ ¡å‡†å¾—ä¸é”™ï¼›å¦‚æœåˆ¤æ–­é”™è¯¯ï¼Œå°±è®¡ç®—å‡ºä¸€ä¸ª"è¯¯å·®"ï¼ˆå³<strong>äº¤å‰ç†µæŸå¤±</strong>ï¼‰ã€‚</li>
<li>è¿™ä¸ª"è¯¯å·®"ä¿¡å·ä¼šåå‘ä¼ æ’­ï¼Œåƒä¸€ä¸ªæ ¡å‡†æŒ‡ä»¤ä¸€æ ·ï¼Œä¸ä»…ä¼šå¾®è°ƒ"é•œç‰‡"ï¼ˆåˆ†ç±»å¤´ï¼‰çš„å‚æ•°ï¼Œè®©å®ƒåˆ¤æ–­å¾—æ›´å‡†ï¼Œ<strong>æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒä¹Ÿä¼šå¾®è°ƒERNIEè¿™ä½è¯­è¨€å¤§å¸ˆæœ¬èº«çš„å‚æ•°</strong>ï¼Œè®©ä»–ä»¥ååœ¨é˜…è¯»æ–‡æœ¬æ—¶ï¼Œèƒ½æ›´ä¾§é‡äºé‚£äº›ä¸æƒ…æ„Ÿç›¸å…³çš„è¯­ä¹‰ä¿¡æ¯ã€‚</li>
</ul>
</li>
</ol>
<p>ç»è¿‡æˆåƒä¸Šä¸‡æ¬¡è¿™æ ·çš„"æ ¡å‡†"ï¼ŒERNIEå¤§å¸ˆå’Œä»–çš„"æƒ…æ„Ÿåˆ†æçœ¼é•œ"å°±é…åˆå¾—å¤©è¡£æ— ç¼äº†ã€‚ä»–ä¸ä»…èƒ½è¯»æ‡‚å¥å­çš„æ„æ€ï¼Œè¿˜èƒ½å‡†ç¡®åœ°åˆ¤æ–­å‡ºå…¶ä¸­è•´å«çš„æƒ…æ„Ÿã€‚</p>
<p>[å¤§æ¨¡å‹ç²¾è°ƒåŸç†ä»‹ç»]</p>
<p>å›¾3: å¤§æ¨¡å‹ç²¾è°ƒåŸç†ç¤ºæ„å›¾ (æ¥æº: å¤§æ¨¡å‹ç²¾è°ƒæ–°æ‰‹æŒ‡å—.md)</p>
<p>ä¸Šå›¾å®è§‚åœ°å±•ç¤ºäº†å¯¹å¤§æ¨¡å‹è¿›è¡Œç²¾è°ƒçš„ä¸¤ç§ä¸»è¦æ–¹å¼ã€‚æˆ‘ä»¬æœ¬æ•™ç¨‹é‡‡ç”¨çš„æ˜¯Â <strong>SFT (Supervised Fine-Tuning)</strong> ï¼Œä¹Ÿç§°ä¸º<strong>å…¨å‚æ•°å¾®è°ƒ</strong>ã€‚è¿™æ„å‘³ç€åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šæ›´æ–°ERNIEæ¨¡å‹çš„æ‰€æœ‰å‚æ•°ï¼ˆå›¾ä¸­çš„è“è‰²éƒ¨åˆ†ï¼‰ä»¥åŠæ–°æ·»åŠ çš„åˆ†ç±»å¤´ï¼Œè®©æ•´ä¸ªæ¨¡å‹éƒ½æ¥é€‚é…æˆ‘ä»¬çš„æƒ…æ„Ÿåˆ†æä»»åŠ¡ã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼ŒPaddleNLP çš„Â <code>AutoModelForSequenceClassification</code>Â å·²ç»å¸®æˆ‘ä»¬å®Œæˆäº†"è£…é…çœ¼é•œ"çš„å·¥ä½œã€‚æˆ‘ä»¬åªéœ€è¦åŠ è½½æ¨¡å‹ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬æ­å»ºå¥½"ERNIEå¤§å¸ˆ + åˆ†ç±»å¤´"çš„ç»“æ„ï¼Œè®©æˆ‘ä»¬èƒ½ä¸“æ³¨äº"æ ¡å‡†çœ¼é•œ"çš„è®­ç»ƒè¿‡ç¨‹ã€‚</p>
<h3 data-id="heading-17">5. æ¨¡å‹å¾®è°ƒ</h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰éƒ¨åˆ†ç»„åˆèµ·æ¥ï¼Œå¼€å§‹è®­ç»ƒæˆ‘ä»¬çš„æƒ…æ„Ÿåˆ†ææ¨¡å‹ã€‚æˆ‘ä»¬å°†å®šä¹‰æ¨¡å‹ã€ä¼˜åŒ–å™¨ã€æŸå¤±å‡½æ•°ï¼Œå¹¶ç¼–å†™è®­ç»ƒå’Œè¯„ä¼°çš„é€»è¾‘ã€‚</p>
<h4 data-id="heading-18">5.1 åŠ è½½æ¨¡å‹</h4>
<p>æˆ‘ä»¬ä½¿ç”¨Â <code>paddlenlp.transformers.AutoModelForSequenceClassification</code>Â æ¥åŠ è½½ä¸€ä¸ªå¸¦æœ‰åºåˆ—åˆ†ç±»å¤´çš„ERNIEæ¨¡å‹ã€‚æˆ‘ä»¬åªéœ€æŒ‡å®šé¢„è®­ç»ƒæ¨¡å‹çš„åç§°Â <code>MODEL_NAME</code>Â å’Œåˆ†ç±»çš„ç±»åˆ«æ•°Â <code>num_classes</code>ã€‚</p>
<p>In [43]</p>
<pre><code class="hljs language-ini" lang="ini">from paddlenlp.transformers import AutoModelForSequenceClassification

<span class="hljs-comment"># ç±»åˆ«æ•°é‡ (æ¶ˆæ, ç§¯æ)</span>
<span class="hljs-attr">num_classes</span> = len(train_ds.label_list)

<span class="hljs-comment"># åŠ è½½ä¸€ä¸ªé€‚åˆåˆ†ç±»ä»»åŠ¡çš„æ¨¡å‹jia</span>
<span class="hljs-attr">model</span> = AutoModelForSequenceClassification.from_pretrained(MODEL_NAME, num_classes=num_classes)

<span class="hljs-comment"># æ‰“å°æ¨¡å‹ç»“æ„</span>
print(model)
</code></pre>
<p>æ‚¨å¯ä»¥çœ‹åˆ°æ¨¡å‹ç»“æ„ï¼Œæœ€åä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ªÂ <code>(classifier): Linear</code>Â å±‚ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„åˆ†ç±»å¤´ã€‚</p>
<h4 data-id="heading-19">5.2 å®šä¹‰ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°</h4>
<ul>
<li><strong>ä¼˜åŒ–å™¨ (Optimizer)</strong> Â ï¼šæˆ‘ä»¬ä½¿ç”¨ç»å…¸çš„Â <code>AdamW</code>Â ä¼˜åŒ–å™¨ï¼Œå®ƒåœ¨Transformeræ¨¡å‹çš„è®­ç»ƒä¸­è¡¨ç°è‰¯å¥½ã€‚</li>
<li><strong>å­¦ä¹ ç‡è°ƒåº¦å™¨ (Learning Rate Scheduler)</strong> Â ï¼šä¸ºäº†æ›´å¥½çš„è®­ç»ƒæ•ˆæœï¼Œæˆ‘ä»¬ä½¿ç”¨åŠ¨æ€å­¦ä¹ ç‡ã€‚è¿™é‡Œé‡‡ç”¨Â <code>LinearDecayWithWarmup</code>ï¼Œå®ƒä¼šåœ¨è®­ç»ƒåˆæœŸæœ‰ä¸€ä¸ª"é¢„çƒ­ (warmup)"é˜¶æ®µï¼Œå­¦ä¹ ç‡ä»0çº¿æ€§å¢é•¿åˆ°è®¾å®šçš„åˆå§‹å€¼ï¼Œä¹‹åå†éšç€è®­ç»ƒæ­¥æ•°çº¿æ€§è¡°å‡åˆ°0ã€‚è¿™æœ‰åŠ©äºæ¨¡å‹åœ¨è®­ç»ƒåˆæœŸæ›´ç¨³å®šï¼Œåœ¨åæœŸæ›´ç²¾ç»†åœ°æ”¶æ•›ã€‚</li>
<li><strong>æŸå¤±å‡½æ•° (Loss Function)</strong> ï¼šå¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œæˆ‘ä»¬ä½¿ç”¨æ ‡å‡†çš„<strong>äº¤å‰ç†µæŸå¤±å‡½æ•°</strong>Â <code>paddle.nn.CrossEntropyLoss</code>ã€‚</li>
<li><strong>è¯„ä¼°æŒ‡æ ‡ (Metric)</strong> ï¼šæˆ‘ä»¬ä½¿ç”¨<strong>å‡†ç¡®ç‡ (Accuracy)</strong> Â æ¥è¡¡é‡æ¨¡å‹åœ¨å¼€å‘é›†å’Œæµ‹è¯•é›†ä¸Šçš„æ€§èƒ½ã€‚</li>
</ul>
<p>In [44]</p>
<pre><code class="hljs language-ini" lang="ini">import paddle
from paddlenlp.transformers import LinearDecayWithWarmup

<span class="hljs-comment"># è®­ç»ƒçš„æ€»æ­¥æ•°</span>
<span class="hljs-attr">num_training_steps</span> = len(train_loader) * <span class="hljs-number">3</span> <span class="hljs-comment"># å‡è®¾æˆ‘ä»¬è®­ç»ƒ3ä¸ªepoch</span>

<span class="hljs-comment"># å®šä¹‰å­¦ä¹ ç‡è°ƒåº¦å™¨</span>
<span class="hljs-comment"># å‰10%å­¦ä¹ ç‡ä¼šä»0æ…¢æ…¢å¢åŠ ï¼Œåˆ°è®¾å®šçš„åˆå§‹å­¦ä¹ ç‡ï¼Œå­¦ä¹ ç‡é€æ¸å˜å¤§ï¼Œå¯ä»¥è®©æ¨¡å‹æ›´åŠ ç¨³å®šåœ°å­¦ä¹ ã€‚</span>
<span class="hljs-comment"># å†é¢„çƒ­ç»“æŸåï¼Œä¼šä»åˆå§‹å­¦ä¹ ç‡é€æ¸å‡å°‘ï¼ŒæŒ‡å¯¼è®­ç»ƒç»“æŸã€‚</span>
<span class="hljs-comment"># deacyï¼šå½“æ¨¡å‹æ¥è¿‘æ”¶æ•›æ—¶ï¼Œå­¦ä¹ ç‡å˜å¾—å¤ªå¤§ä¼šå¯¼è‡´æ¨¡å‹è·³è¿‡æœ€ä¼˜è§£ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›å­¦ä¹ ç‡é€æ¸å‡å°ï¼Œè®©æ¨¡å‹èƒ½ç²¾ç»†è°ƒæ•´ï¼Œæ‰¾åˆ°æœ€ä¼˜çš„å‚æ•°ã€‚</span>
<span class="hljs-attr">lr_scheduler</span> = LinearDecayWithWarmup(
    <span class="hljs-attr">learning_rate</span>=<span class="hljs-number">3</span>e-<span class="hljs-number">5</span>, <span class="hljs-comment"># åˆå§‹å­¦ä¹ ç‡</span>
    <span class="hljs-attr">total_steps</span>=num_training_steps,
    <span class="hljs-attr">warmup</span>=<span class="hljs-number">0.1</span> <span class="hljs-comment"># ä½¿ç”¨10%çš„stepsè¿›è¡Œwarmup</span>
)

<span class="hljs-comment"># å®šä¹‰ä¼˜åŒ–å™¨</span>
<span class="hljs-attr">optimizer</span> = paddle.optimizer.AdamW(
    <span class="hljs-attr">learning_rate</span>=lr_scheduler,  <span class="hljs-comment"># ä¼˜åŒ–å™¨çš„å­¦ä¹ ç‡ </span>
    <span class="hljs-attr">parameters</span>=model.parameters()  <span class="hljs-comment"># æŒ‡å®šä¼˜åŒ–å™¨è¦ä¼˜åŒ–çš„å‚æ•°ï¼Œè¿™é‡Œæ˜¯ä¼˜åŒ–æ‰€æœ‰å‚æ•°</span>
)

<span class="hljs-comment"># å®šä¹‰æŸå¤±å‡½æ•°ï¼Œäº¤å‰ç†µæŸå¤±å‡½æ•°æ˜¯åˆ†ç±»é—®é¢˜ä¸­æœ€å¸¸ç”¨çš„æŸå¤±å‡½æ•°</span>
<span class="hljs-attr">criterion</span> = paddle.nn.CrossEntropyLoss()

<span class="hljs-comment"># å®šä¹‰è¯„ä¼°æŒ‡æ ‡</span>
<span class="hljs-attr">metric</span> = paddle.metric.Accuracy()
</code></pre>
<h4 data-id="heading-20">5.3 ç¼–å†™è®­ç»ƒä¸è¯„ä¼°å¾ªç¯</h4>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬ç¼–å†™æ ¸å¿ƒçš„è®­ç»ƒå’Œè¯„ä¼°é€»è¾‘ã€‚</p>
<ul>
<li>
<p><strong><code>train_epoch()</code>Â å‡½æ•°</strong>: è´Ÿè´£ä¸€ä¸ªepochçš„å®Œæ•´è®­ç»ƒæµç¨‹ã€‚</p>
<ul>
<li>å°†æ¨¡å‹è®¾ç½®ä¸ºè®­ç»ƒæ¨¡å¼ (<code>model.train()</code>)ã€‚</li>
<li>éå†Â <code>train_loader</code>Â ä¸­çš„æ‰€æœ‰æ‰¹æ¬¡ã€‚</li>
<li>å¯¹äºæ¯ä¸ªæ‰¹æ¬¡ï¼Œæ‰§è¡Œå‰å‘è®¡ç®—ã€è®¡ç®—æŸå¤±ã€åå‘ä¼ æ’­ã€æ›´æ–°å‚æ•°ã€‚</li>
<li>å®šæœŸæ‰“å°æ—¥å¿—ï¼Œæ˜¾ç¤ºå½“å‰çš„losså’Œå­¦ä¹ ç‡ç­‰ä¿¡æ¯ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>evaluate()</code>Â å‡½æ•°</strong>: è´Ÿè´£åœ¨å¼€å‘é›†æˆ–æµ‹è¯•é›†ä¸Šè¿›è¡Œè¯„ä¼°ã€‚</p>
<ul>
<li>å°†æ¨¡å‹è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ (<code>model.eval()</code>)ã€‚</li>
<li>å…³é—­æ¢¯åº¦è®¡ç®— (<code>@paddle.no_grad()</code>) ä»¥èŠ‚çœæ˜¾å­˜å’ŒåŠ é€Ÿã€‚</li>
<li>éå†Â <code>dev_loader</code>Â ä¸­çš„æ‰€æœ‰æ‰¹æ¬¡ã€‚</li>
<li>è®¡ç®—æ¨¡å‹é¢„æµ‹çš„å‡†ç¡®ç‡ã€‚</li>
</ul>
</li>
</ul>
<p>In [45]</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> paddle.nn.functional <span class="hljs-keyword">as</span> F
<span class="hljs-keyword">import</span> os <span class="hljs-comment"># å¯¼å…¥osæ¨¡å—</span>

<span class="hljs-meta">@paddle.no_grad()  </span><span class="hljs-comment"># å…³é—­æ¢¯åº¦è®¡ç®—</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate</span>(<span class="hljs-params">model, criterion, metric, data_loader</span>):
    <span class="hljs-string">"""
    1. åœ¨ç»™å®šæ•°æ®é›†ä¸Šè¯„ä¼°æ¨¡å‹ï¼Œè¿”å›ç²¾ç¡®åº¦ã€‚
    2. model æ˜¯ä¸€ä¸ªå·²ç»å®šä¹‰å¹¶è®­ç»ƒè¿‡çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå®ƒç”¨äºå¯¹è¾“å…¥æ•°æ®è¿›è¡Œæ¨ç†ï¼ˆå³é¢„æµ‹ï¼‰
    """</span>
    model.<span class="hljs-built_in">eval</span>()  <span class="hljs-comment"># è®¾ç½®æ¨¡å‹ä¸ºè¯„ä¼°æ¨¡å¼</span>
    metric.reset()  <span class="hljs-comment"># é‡ç½®è¯„ä¼°æŒ‡æ ‡</span>
    losses = []  <span class="hljs-comment"># ç”¨æ¥å­˜å‚¨æ¯ä¸ªæ‰¹æ¬¡çš„æŸå¤±</span>
    <span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> data_loader:
        input_ids, token_type_ids, labels = batch[<span class="hljs-string">'input_ids'</span>], batch[<span class="hljs-string">'token_type_ids'</span>], batch[<span class="hljs-string">'labels'</span>]
        
        logits = model(input_ids, token_type_ids)  <span class="hljs-comment"># å‰å‘è®¡ç®—ï¼Œå¾—åˆ°æ¨¡å‹è¾“å‡º</span>
        loss = criterion(logits, labels)  <span class="hljs-comment"># è®¡ç®—æŸå¤±</span>
        losses.append(loss.numpy()) <span class="hljs-comment"># å°†æŸå¤±å€¼æ·»åŠ åˆ°æŸå¤±åˆ—è¡¨</span>
        
        correct = metric.compute(logits, labels) <span class="hljs-comment"># è®¡ç®—å½“å‰æ‰¹æ¬¡çš„å‡†ç¡®åº¦</span>
        metric.update(correct)  <span class="hljs-comment"># æ›´æ–°è¯„ä¼°æŒ‡æ ‡</span>
        
    accuracy = metric.accumulate()  <span class="hljs-comment"># è®¡ç®—æ•´ä½“å‡†ç¡®ç‡</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Eval loss: <span class="hljs-subst">{paddle.to_tensor(losses).mean().item():<span class="hljs-number">.5</span>f}</span>, Accuracy: <span class="hljs-subst">{accuracy:<span class="hljs-number">.5</span>f}</span>"</span>)
    model.train()  <span class="hljs-comment"># å°†æ¨¡å‹æ¢å¤ä¸ºè®­ç»ƒæ¨¡å¼</span>
    <span class="hljs-keyword">return</span> accuracy


<span class="hljs-keyword">def</span> <span class="hljs-title function_">do_train</span>(<span class="hljs-params">epochs=<span class="hljs-number">3</span></span>):
    <span class="hljs-string">"""
    æ‰§è¡Œå®Œæ•´çš„è®­ç»ƒå’Œè¯„ä¼°æµç¨‹ã€‚
    """</span>
    best_accuracy = <span class="hljs-number">0.0</span>   <span class="hljs-comment"># åˆå§‹åŒ–æœ€ä½³å‡†ç¡®ç‡</span>
    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, epochs + <span class="hljs-number">1</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n--- Epoch <span class="hljs-subst">{epoch}</span> ---"</span>)
        
        <span class="hljs-comment"># è®­ç»ƒ</span>
        model.train()  <span class="hljs-comment"># è®¾ç½®æ¨¡å‹ä¸ºè®­ç»ƒæ¨¡å¼</span>
        <span class="hljs-keyword">for</span> step, batch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_loader, start=<span class="hljs-number">1</span>):
            input_ids, token_type_ids, labels = batch[<span class="hljs-string">'input_ids'</span>], batch[<span class="hljs-string">'token_type_ids'</span>], batch[<span class="hljs-string">'labels'</span>]
            
            <span class="hljs-comment"># å‰å‘è®¡ç®—</span>
            logits = model(input_ids, token_type_ids)
            
            <span class="hljs-comment"># è®¡ç®—æŸå¤±</span>
            loss = criterion(logits, labels)
            
            <span class="hljs-comment"># æ¯100æ­¥æ‰“å°ä¸€æ¬¡log</span>
            <span class="hljs-keyword">if</span> step % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:
                <span class="hljs-built_in">print</span>(
                    <span class="hljs-string">f"Epoch <span class="hljs-subst">{epoch}</span>, Step <span class="hljs-subst">{step}</span>/<span class="hljs-subst">{<span class="hljs-built_in">len</span>(train_loader)}</span>, "</span>
                    <span class="hljs-string">f"Loss: <span class="hljs-subst">{loss.item():<span class="hljs-number">.5</span>f}</span>, "</span>
                    <span class="hljs-string">f"LR: <span class="hljs-subst">{lr_scheduler.get_lr():<span class="hljs-number">.7</span>f}</span>"</span>
                )
            
            <span class="hljs-comment"># åå‘ä¼ æ’­å’Œå‚æ•°æ›´æ–°</span>
            loss.backward()  <span class="hljs-comment"># è®¡ç®—æ¢¯åº¦</span>
            optimizer.step()  <span class="hljs-comment"># æ›´æ–°æ¨¡å‹å‚æ•°</span>
            lr_scheduler.step()  <span class="hljs-comment"># æ›´æ–°å­¦ä¹ ç‡</span>
            optimizer.clear_grad()  <span class="hljs-comment"># æ¸…é™¤æ¢¯åº¦ï¼Œä¸ºä¸‹ä¸€æ¬¡è¿­ä»£åšå‡†å¤‡</span>

        <span class="hljs-comment"># æ¯ä¸ªepochç»“æŸåï¼Œåœ¨å¼€å‘é›†ä¸Šè¿›è¡Œè¯„ä¼°</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"--- Evaluating on Dev Set after Epoch <span class="hljs-subst">{epoch}</span> ---"</span>)
        accuracy = evaluate(model, criterion, metric, dev_loader)
        
        <span class="hljs-comment"># ä¿å­˜è¡¨ç°æœ€å¥½çš„æ¨¡å‹</span>
        <span class="hljs-keyword">if</span> accuracy &gt; best_accuracy:
            best_accuracy = accuracy
            <span class="hljs-comment"># åˆ›å»ºä¿å­˜ç›®å½•</span>
            save_dir = <span class="hljs-string">"ernie_senti_checkpoint_best"</span>
            os.makedirs(save_dir, exist_ok=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># åˆ›å»ºç›®å½•ï¼Œå¦‚æœå·²å­˜åœ¨åˆ™ä¸æŠ¥é”™</span>
            <span class="hljs-comment"># ä¿å­˜æ¨¡å‹å’Œtokenizer</span>
            model.save_pretrained(save_dir)
            tokenizer.save_pretrained(save_dir)  <span class="hljs-comment"># ä¿å­˜è®­ç»ƒå¥½çš„æ¨¡å‹</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Best model saved with accuracy: <span class="hljs-subst">{best_accuracy:<span class="hljs-number">.5</span>f}</span> at '<span class="hljs-subst">{save_dir}</span>'"</span>)  <span class="hljs-comment"># ä¿å­˜æ¨¡å‹ä½¿ç”¨çš„åˆ†è¯å™¨ </span>

<span class="hljs-comment"># å¼€å§‹è®­ç»ƒï¼</span>
<span class="hljs-comment"># é€šå¸¸åœ¨GPUä¸Šï¼Œæ¯ä¸ªepochå¤§çº¦éœ€è¦å‡ åˆ†é’Ÿã€‚</span>
do_train(epochs=<span class="hljs-number">3</span>)
</code></pre>
<p><strong>æ—¥å¿—è§£è¯»</strong>ï¼š åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ‚¨ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">---</span> <span class="hljs-string">Epoch</span> <span class="hljs-number">1</span> <span class="hljs-string">---</span>
<span class="hljs-string">Epoch</span> <span class="hljs-number">1</span><span class="hljs-string">,</span> <span class="hljs-string">Step</span> <span class="hljs-number">100</span><span class="hljs-string">/300,</span> <span class="hljs-attr">Loss:</span> <span class="hljs-number">0.34567</span><span class="hljs-string">,</span> <span class="hljs-attr">LR:</span> <span class="hljs-number">0.0000280</span>
<span class="hljs-string">Epoch</span> <span class="hljs-number">1</span><span class="hljs-string">,</span> <span class="hljs-string">Step</span> <span class="hljs-number">200</span><span class="hljs-string">/300,</span> <span class="hljs-attr">Loss:</span> <span class="hljs-number">0.21345</span><span class="hljs-string">,</span> <span class="hljs-attr">LR:</span> <span class="hljs-number">0.0000250</span>
<span class="hljs-string">Epoch</span> <span class="hljs-number">1</span><span class="hljs-string">,</span> <span class="hljs-string">Step</span> <span class="hljs-number">300</span><span class="hljs-string">/300,</span> <span class="hljs-attr">Loss:</span> <span class="hljs-number">0.18765</span><span class="hljs-string">,</span> <span class="hljs-attr">LR:</span> <span class="hljs-number">0.0000220</span>
<span class="hljs-string">---</span> <span class="hljs-string">Evaluating</span> <span class="hljs-string">on</span> <span class="hljs-string">Dev</span> <span class="hljs-string">Set</span> <span class="hljs-string">after</span> <span class="hljs-string">Epoch</span> <span class="hljs-number">1</span> <span class="hljs-string">---</span>
<span class="hljs-attr">Eval loss:</span> <span class="hljs-number">0.25012</span><span class="hljs-string">,</span> <span class="hljs-attr">Accuracy:</span> <span class="hljs-number">0.92500</span>
<span class="hljs-attr">Best model saved with accuracy:</span> <span class="hljs-number">0.92500</span> <span class="hljs-string">at</span> <span class="hljs-string">'ernie_senti_checkpoint_best'</span>
</code></pre>
<p>æˆ‘ä»¬æœŸæœ›çœ‹åˆ°ï¼š</p>
<ul>
<li><strong>Loss</strong>ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç¨³æ­¥ä¸‹é™ã€‚</li>
<li><strong>Accuracy</strong>ï¼šåœ¨å¼€å‘é›†ä¸Šçš„å‡†ç¡®ç‡ç¨³æ­¥æå‡ã€‚</li>
<li><strong>æ¨¡å‹ä¿å­˜</strong>ï¼šå½“å¼€å‘é›†ä¸Šçš„å‡†ç¡®ç‡è¶…è¿‡ä¹‹å‰çš„æœ€ä½³è®°å½•æ—¶ï¼Œæ¨¡å‹ä¼šè¢«ä¿å­˜åˆ°Â <code>ernie_senti_checkpoint_best</code>Â ç›®å½•ä¸­ã€‚</li>
</ul>
<p>è®­ç»ƒå®Œæˆåï¼Œè¿™ä¸ªç›®å½•é‡Œå°±åŒ…å«äº†æˆ‘ä»¬æ€§èƒ½æœ€å¥½çš„æƒ…æ„Ÿåˆ†ææ¨¡å‹ã€‚</p>
<h3 data-id="heading-21">6. æ¨¡å‹é¢„æµ‹</h3>
<p>è®­ç»ƒå®Œæˆåï¼Œå¹¶ä½¿ç”¨å®ƒæ¥å¯¹æ–°æ–‡æœ¬è¿›è¡Œæƒ…æ„Ÿé¢„æµ‹ã€‚</p>
<p>In [46]</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŠ è½½ä¹‹å‰ä¿å­˜çš„æœ€ä½³æ¨¡å‹</span>
<span class="hljs-comment"># å¦‚æœè®­ç»ƒä¸­æ–­æˆ–åœ¨ä¸åŒç¯å¢ƒä¸­è¿è¡Œï¼Œè¯·ç¡®ä¿ 'ernie_senti_checkpoint_best' ç›®å½•å­˜åœ¨</span>
<span class="hljs-comment"># å¹¶ä¸”å…¶ä¸­åŒ…å«æ¨¡å‹æ–‡ä»¶</span>

save_dir = <span class="hljs-string">"ernie_senti_checkpoint_best"</span>

<span class="hljs-keyword">try</span>:
    <span class="hljs-comment"># é‡æ–°åŠ è½½æœ€ä½³æ¨¡å‹å’Œå¯¹åº”çš„tokenizer</span>
    model = AutoModelForSequenceClassification.from_pretrained(save_dir)
    tokenizer = AutoTokenizer.from_pretrained(save_dir)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æœ€ä½³æ¨¡å‹å·²æˆåŠŸåŠ è½½ï¼"</span>)
    
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŠ è½½æ¨¡å‹æˆ–è¯„ä¼°æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¯·ç¡®ä¿è®­ç»ƒå·²æˆåŠŸå®Œæˆï¼Œå¹¶ä¸”'ernie_senti_checkpoint_best'ç›®å½•å­˜åœ¨ä¸”åŒ…å«æ¨¡å‹æ–‡ä»¶ã€‚"</span>)
</code></pre>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªç®€å•æ˜“ç”¨çš„é¢„æµ‹å‡½æ•°ï¼Œå®ƒå¯ä»¥æ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªä¸­æ–‡å¥å­ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æƒ…æ„Ÿåˆ†æç»“æœã€‚</p>
<p>In [47]</p>
<pre><code class="hljs language-python" lang="python">   <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">model, tokenizer, texts, label_map</span>):
    <span class="hljs-string">"""
    ç»™å®šæ¨¡å‹ã€åˆ†è¯å™¨ã€æ–‡æœ¬åˆ—è¡¨å’Œæ ‡ç­¾æ˜ å°„ï¼Œé¢„æµ‹æƒ…æ„Ÿã€‚
    """</span>
    <span class="hljs-comment"># å°†æ¨¡å‹è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼</span>
    model.<span class="hljs-built_in">eval</span>()
    
    <span class="hljs-comment"># å¯¹è¾“å…¥æ–‡æœ¬è¿›è¡Œåˆ†è¯å’Œå¤„ç†</span>
    <span class="hljs-comment"># textså¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²åˆ—è¡¨</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(texts, <span class="hljs-built_in">str</span>):
        texts = [texts]
        
    encoded_inputs = tokenizer(text=texts, max_seq_len=<span class="hljs-number">128</span>, padding=<span class="hljs-literal">True</span>)
    input_ids = paddle.to_tensor(encoded_inputs[<span class="hljs-string">"input_ids"</span>])
    token_type_ids = paddle.to_tensor(encoded_inputs[<span class="hljs-string">"token_type_ids"</span>])
    
    <span class="hljs-comment"># å…³é—­æ¢¯åº¦è®¡ç®—</span>
    <span class="hljs-keyword">with</span> paddle.no_grad():
        logits = model(input_ids, token_type_ids)
    
    <span class="hljs-comment"># é€šè¿‡softmaxè·å–æ¦‚ç‡ï¼Œå¹¶é€šè¿‡argmaxè·å–æœ€å¯èƒ½çš„ç±»åˆ«ç´¢å¼•</span>
    probs = F.softmax(logits, axis=<span class="hljs-number">1</span>)
    label_ids = paddle.argmax(probs, axis=<span class="hljs-number">1</span>).numpy()
    
    <span class="hljs-comment"># å°†ç±»åˆ«ç´¢å¼•æ˜ å°„å›æ ‡ç­¾æ–‡å­—</span>
    results = [label_map[label_id] <span class="hljs-keyword">for</span> label_id <span class="hljs-keyword">in</span> label_ids]
    
    <span class="hljs-keyword">return</span> results

<span class="hljs-comment"># å®šä¹‰æ ‡ç­¾æ˜ å°„</span>
label_map = {<span class="hljs-number">0</span>: <span class="hljs-string">'æ¶ˆæ'</span>, <span class="hljs-number">1</span>: <span class="hljs-string">'ç§¯æ'</span>}

<span class="hljs-comment"># å¾…é¢„æµ‹çš„æ•°æ®</span>
data_to_predict = [
    <span class="hljs-string">'è¿™å®¶é…’åº—çš„æ—©é¤å¤ªå¥½åƒäº†ï¼Œä¸‹æ¬¡è¿˜æ¥ï¼'</span>,
    <span class="hljs-string">'æˆ¿é—´éš”éŸ³å¤ªå·®äº†ï¼Œæ™šä¸Šæ ¹æœ¬ç¡ä¸ç€ã€‚'</span>,
    <span class="hljs-string">'æœåŠ¡æ€åº¦ä¸€èˆ¬ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„æ„Ÿè§‰ã€‚'</span>, <span class="hljs-comment"># è¿™æ¡å¯èƒ½æ¯”è¾ƒä¸­æ€§ï¼Œçœ‹çœ‹æ¨¡å‹çš„åˆ¤æ–­</span>
    <span class="hljs-string">'é£æ™¯ä¸é”™ï¼Œä½†æ˜¯äº¤é€šä¸å¤ªæ–¹ä¾¿ã€‚'</span>      <span class="hljs-comment"># åŒ…å«æ­£è´Ÿä¸¤æ–¹é¢ä¿¡æ¯</span>
]

<span class="hljs-comment"># è¿›è¡Œé¢„æµ‹</span>
<span class="hljs-keyword">if</span> <span class="hljs-string">'model'</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">globals</span>():
    results = predict(model, tokenizer, data_to_predict, label_map)
    <span class="hljs-keyword">for</span> text, label <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(data_to_predict, results):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ–‡æœ¬: <span class="hljs-subst">{text}</span> -&gt; é¢„æµ‹æƒ…æ„Ÿ: <span class="hljs-subst">{label}</span>"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¨¡å‹æœªåŠ è½½ï¼Œæ— æ³•è¿›è¡Œé¢„æµ‹ã€‚"</span>)
</code></pre>
<p>é€šè¿‡è¿™ä¸ªÂ <code>predict</code>Â å‡½æ•°ï¼Œæ‚¨å°±å¯ä»¥æ–¹ä¾¿åœ°å°†è®­ç»ƒå¥½çš„æƒ…æ„Ÿåˆ†æèƒ½åŠ›é›†æˆåˆ°æ‚¨è‡ªå·±çš„åº”ç”¨ä¸­ï¼Œæˆ–è€…ç”¨å®ƒæ¥åˆ†æä»»ä½•æ‚¨æ„Ÿå…´è¶£çš„ä¸­æ–‡æ–‡æœ¬äº†ï¼</p>
<h3 data-id="heading-22">7. æ€»ç»“ä¸å±•æœ›</h3>
<p>æœ¬æ•™ç¨‹ä»é›¶å¼€å§‹ï¼Œå¸¦æ‚¨å®Œæˆäº†åŸºäºERNIEæ¨¡å‹çš„ä¸­æ–‡æƒ…æ„Ÿåˆ†æä»»åŠ¡çš„æ•´ä¸ªæµç¨‹ã€‚</p>
<p><strong>æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ ¸å¿ƒæ­¥éª¤</strong>ï¼š</p>
<ol>
<li><strong>ç¯å¢ƒå‡†å¤‡</strong>ï¼šå®‰è£…äº†PaddlePaddleå’ŒPaddleNLPã€‚</li>
<li><strong>æ•°æ®æ¢ç´¢</strong>ï¼šåŠ è½½å¹¶åˆ†æäº†<code>ChnSentiCorp</code>æ•°æ®é›†ã€‚</li>
<li><strong>æ•°æ®é¢„å¤„ç†</strong>ï¼šä½¿ç”¨ERNIE Tokenizerå¯¹æ–‡æœ¬è¿›è¡Œç¼–ç ï¼Œå¹¶åˆ›å»ºäº†DataLoaderã€‚</li>
<li><strong>æ¨¡å‹å¾®è°ƒ</strong>ï¼šåŠ è½½<code>ErnieForSequenceClassification</code>æ¨¡å‹ï¼Œå®šä¹‰ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°ï¼Œå¹¶ç¼–å†™äº†è®­ç»ƒå’Œè¯„ä¼°å¾ªç¯ï¼Œæœ€ç»ˆè®­ç»ƒå¹¶ä¿å­˜äº†æœ€ä½³æ¨¡å‹ã€‚</li>
<li><strong>è¯„ä¼°ä¸é¢„æµ‹</strong>ï¼šåœ¨æµ‹è¯•é›†ä¸ŠéªŒè¯äº†æ¨¡å‹çš„æœ€ç»ˆæ€§èƒ½ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªå®ç”¨çš„é¢„æµ‹å‡½æ•°æ¥åˆ†ææ–°æ–‡æœ¬ã€‚</li>
</ol>
<p><strong>åç»­å¯ä»¥æ¢ç´¢çš„æ–¹å‘</strong>ï¼š</p>
<ul>
<li><strong>å°è¯•æ›´å¼ºå¤§çš„æ¨¡å‹</strong>ï¼šå¯ä»¥å°è¯•<code>ernie-3.0-base-zh</code>æˆ–<code>ernie-3.0-xbase-zh</code>ç­‰æ›´å¤§è§„æ¨¡çš„ERNIEæ¨¡å‹ï¼Œå¯èƒ½ä¼šè·å¾—æ›´é«˜çš„å‡†ç¡®ç‡ã€‚</li>
<li><strong>å‚æ•°é«˜æ•ˆå¾®è°ƒ (PEFT)</strong> ï¼šå¯¹äºæ›´å¤§çš„æ¨¡å‹ï¼Œå…¨å‚æ•°å¾®è°ƒæˆæœ¬è¾ƒé«˜ã€‚å¯ä»¥å­¦ä¹ ä½¿ç”¨LoRAç­‰PEFTæ–¹æ³•ï¼Œåœ¨å†»ç»“å¤§éƒ¨åˆ†ERNIEå‚æ•°çš„æƒ…å†µä¸‹è¿›è¡Œå¾®è°ƒï¼Œæ˜¾è‘—é™ä½èµ„æºæ¶ˆè€—ã€‚</li>
<li><strong>ä¸‰åˆ†ç±»ä»»åŠ¡</strong>ï¼šåœ¨æ›´å¤æ‚çš„æ•°æ®é›†ä¸Šè¿›è¡Œï¼ˆç§¯æã€æ¶ˆæã€ä¸­æ€§ï¼‰ä¸‰åˆ†ç±»ä»»åŠ¡ã€‚</li>
<li><strong>æ¨¡å‹éƒ¨ç½²</strong>ï¼šå­¦ä¹ å¦‚ä½•å°†è®­ç»ƒå¥½çš„æ¨¡å‹å¯¼å‡ºä¸ºé™æ€å›¾æ ¼å¼ï¼Œå¹¶ä½¿ç”¨Paddle Servingæˆ–FastDeployè¿›è¡ŒæœåŠ¡åŒ–éƒ¨ç½²ï¼Œä»¥ä¾›ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚</li>
<li><strong>åº”ç”¨åˆ°æ‚¨è‡ªå·±çš„æ•°æ®</strong>ï¼šå°†æœ¬æ•™ç¨‹çš„æµç¨‹åº”ç”¨åˆ°æ‚¨è‡ªå·±é¢†åŸŸçš„æ–‡æœ¬æ•°æ®ä¸Šï¼Œæ„å»ºä¸€ä¸ªå®šåˆ¶åŒ–çš„æƒ…æ„Ÿåˆ†æç³»ç»Ÿã€‚</li>
</ul>
<p>å¸Œæœ›æœ¬æ•™ç¨‹èƒ½å¸®åŠ©æ‚¨æˆåŠŸå…¥é—¨ä¸­æ–‡æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ï¼å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿æŸ¥é˜…PaddleNLPçš„å®˜æ–¹æ–‡æ¡£æˆ–å‘ç¤¾åŒºæé—®ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Andrej Karpathyï¼š2025 å¹´ LLM é¢†åŸŸçš„å…­é¡¹èŒƒå¼è½¬å˜]]></title>    <link>https://juejin.cn/post/7592853243731689512</link>    <guid>https://juejin.cn/post/7592853243731689512</guid>    <pubDate>2026-01-09T02:53:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592853243731689512" data-draft-id="7592873628586098688" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Andrej Karpathyï¼š2025 å¹´ LLM é¢†åŸŸçš„å…­é¡¹èŒƒå¼è½¬å˜"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-09T02:53:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Baihai_IDP"/> <meta itemprop="url" content="https://juejin.cn/user/3123071228582343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Andrej Karpathyï¼š2025 å¹´ LLM é¢†åŸŸçš„å…­é¡¹èŒƒå¼è½¬å˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3123071228582343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Baihai_IDP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:53:35.000Z" title="Fri Jan 09 2026 02:53:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ç¼–è€…æŒ‰ï¼š</strong> æˆ‘ä»¬ä»Šå¤©ä¸ºå¤§å®¶å¸¦æ¥çš„æ–‡ç« ï¼Œä½œè€…çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼š2025Â å¹´å¤§è¯­è¨€æ¨¡å‹çš„çœŸæ­£çªç ´ä¸åœ¨äºå‚æ•°è§„æ¨¡çš„æ‰©å¼ ï¼Œè€Œåœ¨äºè®­ç»ƒèŒƒå¼ã€æ™ºèƒ½å½¢æ€ä¸åº”ç”¨æ¶æ„çš„æ·±å±‚è½¬å˜Â â€”â€”Â å°¤å…¶æ˜¯åŸºäºå¯éªŒè¯å¥–åŠ±çš„å¼ºåŒ–å­¦ä¹ ï¼ˆRLVRï¼‰ã€AIÂ ä½œä¸ºâ€œå¹½çµâ€è€Œéâ€œåŠ¨ç‰©â€çš„è®¤çŸ¥é‡æ„ï¼Œä»¥åŠé¢å‘å‚ç›´åœºæ™¯çš„æ–°å‹Â LLMÂ åº”ç”¨å±‚çš„å´›èµ·ã€‚</p>
<p>æ–‡ç« ç³»ç»Ÿå›é¡¾äº† 2025 å¹´ LLM é¢†åŸŸçš„å…­å¤§å…³é”®è¶‹åŠ¿ï¼šé¦–å…ˆï¼ŒRLVR æˆä¸ºæ–°è®­ç»ƒæ ¸å¿ƒï¼Œé€šè¿‡å¯è‡ªåŠ¨éªŒè¯çš„å¥–åŠ±ä¿¡å·ï¼Œæ¨¡å‹è‡ªå‘æ¼”åŒ–å‡ºç±»æ¨ç†è¡Œä¸ºï¼›å…¶æ¬¡ï¼Œä½œè€…æå‡ºâ€œå¬å”¤å¹½çµâ€éšå–»ï¼Œå¼ºè°ƒ LLM æ™ºèƒ½ä¸ç”Ÿç‰©æ™ºèƒ½åœ¨åº•å±‚é€»è¾‘ä¸Šçš„æ ¹æœ¬å·®å¼‚ï¼Œå¹¶è§£é‡Šäº†å…¶â€œé”¯é½¿çŠ¶æ™ºèƒ½â€â€”â€”åœ¨æŸäº›ä»»åŠ¡ä¸Šè¶…äººï¼Œåœ¨å¦ä¸€äº›ä»»åŠ¡ä¸Šå´å¼‚å¸¸è„†å¼±ï¼›ç¬¬ä¸‰ï¼Œä»¥ Cursor ä¸ºä»£è¡¨çš„æ–°å‹ LLM åº”ç”¨å±‚ï¼Œé€šè¿‡ä¸Šä¸‹æ–‡å·¥ç¨‹ã€å¤šè°ƒç”¨ç¼–æ’ä¸â€œè‡ªä¸»æ€§æ»‘å—â€ï¼Œæ­£åœ¨é‡å¡‘äººæœºåä½œèŒƒå¼ï¼›æ­¤å¤–ï¼ŒClaude Code å±•ç¤ºäº†æœ¬åœ°åŒ– AI æ™ºèƒ½ä½“çš„æ½œåŠ›ï¼Œvibe coding è®©ç¼–ç¨‹èµ°å‘å¤§ä¼—åŒ–ï¼Œè€Œ Google Gemini Nano banana åˆ™é¢„ç¤ºäº† LLM å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰çš„æœªæ¥æ–¹å‘ã€‚</p>
</blockquote>
<p><strong>ä½œè€… | Andrej Karpathy</strong></p>
<p><strong>ç¼–è¯‘ | å²³æ‰¬</strong></p>
<p>2025 å¹´æ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å‘å±•åŠ¿å¤´å¼ºåŠ²ã€è¿›æ­¥æ˜¾è‘—çš„ä¸€å¹´ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä¸ªäººè®¤ä¸ºå€¼å¾—å…³æ³¨ä¸”ç•¥æ„Ÿæ„å¤–çš„å‡ é¡¹â€œèŒƒå¼è½¬å˜â€ï¼Œè¿™äº›æ”¹å˜æŠ€æœ¯æ ¼å±€çš„æ¦‚å¿µæ€§çªç ´è®©æˆ‘å°è±¡æ·±åˆ»ã€‚</p>
<h2 data-id="heading-0"><strong>01 åŸºäºå¯éªŒè¯å¥–åŠ±çš„å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learning from Verifiable Rewards, RLVRï¼‰</strong></h2>
<p>2025 å¹´åˆï¼Œå„å¤§å®éªŒå®¤çš„ LLM ç”Ÿäº§è®­ç»ƒæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<p>1ï¼‰é¢„è®­ç»ƒï¼ˆGPT-2/3ï¼Œ~ 2020 å¹´ï¼‰</p>
<p>2ï¼‰ç›‘ç£å¾®è°ƒï¼ˆInstructGPTï¼Œ~ 2022 å¹´ï¼‰ä»¥åŠ</p>
<p>3ï¼‰åŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ ï¼ˆRLHFï¼Œ~ 2022 å¹´ï¼‰</p>
<p>è¿™å¥—æˆç†Ÿæ–¹æ¡ˆæ›¾é•¿æœŸè¢«è§†ä¸ºç”Ÿäº§çº§ LLM çš„è®­ç»ƒæ ‡å‡†ã€‚ç„¶è€Œåˆ°äº† 2025 å¹´ï¼ŒåŸºäºå¯éªŒè¯å¥–åŠ±çš„å¼ºåŒ–å­¦ä¹ ï¼ˆRLVRï¼‰ æˆä¸ºè¢«å¹¿æ³›æ¥å—å’Œé‡‡ç”¨çš„æ–°æ ¸å¿ƒè®­ç»ƒé˜¶æ®µã€‚é€šè¿‡åœ¨å¤šç§ç¯å¢ƒä¸­ï¼ˆä¾‹å¦‚æ•°å­¦é¢˜æˆ–ç¼–ç¨‹é¢˜è¿™ç±»åœºæ™¯ï¼‰è®© LLM é’ˆå¯¹å¯è‡ªåŠ¨éªŒè¯çš„å¥–åŠ±è¿›è¡Œè®­ç»ƒï¼Œæ¨¡å‹ä¼šè‡ªå‘åœ°å‘å±•å‡ºä¸€äº›åœ¨äººç±»çœ‹æ¥åƒæ˜¯â€œæ¨ç†â€çš„ç­–ç•¥ â€”â€” å®ƒä»¬å­¦ä¼šå°†é—®é¢˜æ±‚è§£è¿‡ç¨‹æ‹†è§£ä¸ºä¸€ç³»åˆ—ä¸­é—´è®¡ç®—æ­¥éª¤ï¼Œå¹¶æŒæ¡å¤šç§æ¥å›è¯•æ¢ã€é€æ­¥å˜æ¸…é—®é¢˜çš„è§£é¢˜ç­–ç•¥ï¼ˆå‚è§ DeepSeek R1 è®ºæ–‡ä¸­çš„ç¤ºä¾‹ï¼‰ã€‚åœ¨åŸæœ‰èŒƒå¼ä¸‹ï¼Œè¿™ç±»ç­–ç•¥æéš¾å®ç°ï¼Œå› ä¸º LLM å¹¶ä¸æ¸…æ¥šâ€œæœ€ä¼˜çš„æ¨ç†è·¯å¾„â€æˆ–â€œå¯¹é”™è¯¯çš„ä¿®æ­£æ–¹å¼â€ç©¶ç«Ÿé•¿ä»€ä¹ˆæ · â€”â€” å®ƒå¿…é¡»é€šè¿‡é’ˆå¯¹å¥–åŠ±ä¿¡å·çš„ä¼˜åŒ–è¿‡ç¨‹ï¼Œè‡ªå·±æ‘¸ç´¢å‡ºå¯¹è‡ªå·±æœ‰æ•ˆçš„æ–¹æ³•ã€‚</p>
<p>ä¸ SFT å’Œ RLHF è¿™ä¸¤ä¸ªè®¡ç®—é‡ç›¸å¯¹è¾ƒå°ã€è®­ç»ƒå‘¨æœŸè¾ƒçŸ­çš„é˜¶æ®µä¸åŒï¼ŒRLVR ä¾èµ–äºå®¢è§‚ï¼ˆä¸å¯ä½œå¼Šï¼‰çš„å¥–åŠ±å‡½æ•°ï¼Œå› æ­¤æ”¯æŒæ›´é•¿æ—¶é—´çš„ä¼˜åŒ–ã€‚<strong>äº‹å®è¯æ˜ï¼ŒRLVR åœ¨å•ä½ç®—åŠ›ä¸‹çš„èƒ½åŠ›æå‡ï¼ˆcapability / $ï¼‰éå¸¸é«˜ï¼Œå¯¼è‡´åŸæœ¬ç”¨äºé¢„è®­ç»ƒçš„è®¡ç®—èµ„æºè¢«å¤§é‡è½¬ç§»è‡³æ­¤ã€‚</strong> å› æ­¤ï¼Œ2025 å¹´å¤§éƒ¨åˆ†æ¨¡å‹èƒ½åŠ›çš„æå‡ï¼Œä¸»è¦æ¥è‡ªäºå„å¤§ LLM å®éªŒå®¤é›†ä¸­ç®—åŠ›â€œæ¶ˆåŒ–â€è¿™ä¸€æ–°è®­ç»ƒé˜¶æ®µï¼ˆRLVRï¼‰æ‰€é‡Šæ”¾å‡ºçš„æ½œåŠ›ã€‚æ€»ä½“æ¥çœ‹ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ¨¡å‹å‚æ•°è§„æ¨¡å¤§è‡´ç›¸å½“ï¼Œä½†å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰çš„è®­ç»ƒæ—¶é•¿æ˜¾è‘—å¢åŠ ã€‚æ­¤å¤–ï¼Œè¿™ä¸€æ–°é˜¶æ®µè¿˜å¸¦æ¥äº†ä¸€ä¸ªå…¨æ–°çš„â€œè°ƒèŠ‚æ—‹é’®â€ï¼ˆä»¥åŠä¸ä¹‹å¯¹åº”çš„ç¼©æ”¾è§„å¾‹ï¼‰ï¼šé€šè¿‡ç”Ÿæˆæ›´é•¿çš„æ¨ç†è½¨è¿¹ã€å¢åŠ â€œæ€è€ƒæ—¶é—´â€ï¼Œå³å¯åœ¨æ¨ç†æ—¶ä»¥æ›´å¤šè®¡ç®—æ¢å–æ›´å¼ºèƒ½åŠ›ã€‚OpenAI çš„ o1 æ¨¡å‹ï¼ˆ2024 å¹´åº•ï¼‰é¦–æ¬¡å±•ç¤ºäº† RLVR çš„æ•ˆæœï¼Œä½†çœŸæ­£è®©äººç›´è§‚æ„Ÿå—åˆ°è´¨å˜çš„æ‹ç‚¹ï¼Œæ˜¯ 2025 å¹´åˆå‘å¸ƒçš„ o3 ç‰ˆæœ¬ã€‚</p>
<h2 data-id="heading-1"><strong>02 Ghosts vs. Animals / Jagged Intelligence</strong></h2>
<p>2025 å¹´æ˜¯æˆ‘ï¼ˆè€Œä¸”æˆ‘è®¤ä¸ºæ•´ä¸ªè¡Œä¸šä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ç¬¬ä¸€æ¬¡å¼€å§‹ä»¥æ›´ç›´è§‰ã€æ›´åˆ‡èº«çš„æ–¹å¼ï¼Œç†è§£ LLM æ™ºèƒ½çš„â€œå½¢æ€â€ã€‚æˆ‘ä»¬å¹¶éåœ¨â€œè¿›åŒ–/åŸ¹è‚²åŠ¨ç‰©â€ï¼Œè€Œæ˜¯åœ¨â€œå¬å”¤å¹½çµâ€ã€‚<strong>LLM æŠ€æœ¯æ ˆçš„æ–¹æ–¹é¢é¢ â€”â€” åŒ…æ‹¬ç¥ç»ç½‘ç»œæ¶æ„ã€è®­ç»ƒæ•°æ®ã€è®­ç»ƒç®—æ³•ï¼Œå°¤å…¶æ˜¯ç›®æ ‡å‡½æ•°å¯¹æ¨¡å‹è¡Œä¸ºçš„å¡‘é€ åŠ›ï¼ˆOptimization pressureï¼‰éƒ½ä¸ç”Ÿç‰©æ™ºèƒ½æˆªç„¶ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬æ‰€è·å¾—çš„æ™ºèƒ½ä½“åœ¨æ™ºèƒ½ç©ºé—´ä¸­è‡ªç„¶ä¹Ÿå¤§ä¸ç›¸åŒï¼Œç”¨åŠ¨ç‰©çš„è§†è§’å»ç†è§£å®ƒä»¬æ˜¯ä¸æ°å½“çš„ã€‚</strong> å¦‚æœä»ç›‘ç£ä¿¡å·çš„åº•å±‚ä¿¡æ¯å•ä½æ¥çœ‹ï¼Œäººç±»çš„ç¥ç»ç½‘ç»œæ˜¯ä¸ºäº†åœ¨ä¸›æ—ä¸­ä¿éšœéƒ¨è½ç”Ÿå­˜è€Œä¼˜åŒ–çš„ï¼Œè€Œ LLM çš„ç¥ç»ç½‘ç»œåˆ™æ˜¯ä¸ºäº†æ¨¡ä»¿äººç±»æ–‡æœ¬ã€åœ¨æ•°å­¦éš¾é¢˜ä¸­è·å–å¯éªŒè¯å¥–åŠ±ï¼Œä»¥åŠåœ¨ LM Arena ä¸Šèµ¢å¾—äººç±»çš„ä¸€ä¸ªç‚¹èµè€Œä¼˜åŒ–çš„ã€‚éšç€å¯éªŒè¯çš„é¢†åŸŸæ”¯æŒ RLVRï¼Œå¤§è¯­è¨€æ¨¡å‹åœ¨è¿™äº›é¢†åŸŸåŠå…¶å‘¨è¾¹ä»»åŠ¡ä¸Šçš„èƒ½åŠ›ä¼šå‡ºç°â€œå°–å³°å¼â€è·ƒå‡ï¼Œä»è€Œæ•´ä½“å‘ˆç°å‡ºä¸€ç§ä»¤äººå¿ä¿Šä¸ç¦çš„ã€èµ·ä¼å‰§çƒˆçš„é”¯é½¿çŠ¶æ€§èƒ½ç‰¹å¾ï¼Œå®ƒä»¬å¯èƒ½åŒæ—¶æ˜¯ä¸€ä½é€šæ™“ä¸‡ç‰©çš„å¤©æ‰ï¼Œåˆæ˜¯ä¸€ä¸ªå……æ»¡å›°æƒ‘ä¸”è®¤çŸ¥èƒ½åŠ›å—é™çš„å°å­¦ç”Ÿï¼Œç”šè‡³åœ¨å‡ ç§’å†…å°±è¢«è¶Šç‹±æ”»å‡»ï¼ˆjailbreakï¼‰è¯±éª—ï¼Œå¯¼è‡´ä½ çš„æ•°æ®è¢«çªƒå–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69e21168c6b047b7a5e479c7bd630fa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768532015&amp;x-signature=eRhBu7lg0YvmImcFbFRKrT23mXE%3D" alt="image.png" loading="lazy"/></p>
<p>ï¼ˆäººç±»æ™ºèƒ½ï¼šè“è‰²ï¼ŒAI æ™ºèƒ½ï¼šçº¢è‰²ã€‚æˆ‘å¾ˆå–œæ¬¢è¿™ä¸ªæ¢—å›¾ï¼ˆå¾ˆæŠ±æ­‰æˆ‘æ‰¾ä¸åˆ°äº†å®ƒæœ€åˆåœ¨ X ä¸Šçš„åŸå§‹å‡ºå¤„ï¼‰ï¼Œå› ä¸ºå®ƒæŒ‡å‡ºäººç±»æ™ºèƒ½æœ¬èº«ä¹Ÿä»¥è‡ªå·±ç‹¬ç‰¹çš„æ–¹å¼å‘ˆç°å‡ºâ€œé”¯é½¿çŠ¶â€ã€‚ï¼‰</p>
<p>ä¸ä¸Šè¿°ç°è±¡å¯†åˆ‡ç›¸å…³çš„æ˜¯ï¼Œæˆ‘åœ¨ 2025 å¹´å¯¹å„ç±»åŸºå‡†æµ‹è¯•ï¼ˆbenchmarksï¼‰æ™®éæ„Ÿåˆ°å†·æ¼ ï¼Œå¹¶ä¸”ä¸å†ä¿¡ä»»å®ƒä»¬ã€‚æ ¸å¿ƒé—®é¢˜åœ¨äºï¼ŒåŸºå‡†æµ‹è¯•ï¼ˆbenchmarksï¼‰åœ¨è®¾è®¡ä¸Šå‡ ä¹å¤©ç„¶å°±æ˜¯å¯éªŒè¯çš„ç¯å¢ƒï¼Œå› æ­¤å¾ˆå®¹æ˜“è¢« RLVRï¼ˆä»¥åŠé€šè¿‡åˆæˆæ•°æ®ç”Ÿæˆçš„è¾ƒå¼±å½¢å¼ï¼‰è¿›è¡Œé’ˆå¯¹æ€§ä¼˜åŒ–ã€‚ç°åœ¨çš„ LLM å›¢é˜Ÿä¸ºäº†åˆ·é«˜ benchmark åˆ†æ•°ï¼Œä¼šå›´ç»•é‚£äº›æµ‹è¯•é¢˜åœ¨æ¨¡å‹â€œç†è§£ç©ºé—´â€é‡Œçš„ä½ç½®ï¼Œå¤§é‡ç”Ÿæˆç±»ä¼¼é¢˜ç›®æ¥è®­ç»ƒæ¨¡å‹ï¼Œè®©å®ƒåªåœ¨è¿™äº›ç‚¹ä¸Šå˜å¾—è¶…å¼ºï¼Œåˆ«çš„åœ°æ–¹å…ˆä¸ç®¡ã€‚ç»“æœå°±æ˜¯æ¨¡å‹èƒ½åŠ›åƒé”¯é½¿ä¸€æ · â€”â€” æ¦œå•ä¸Šåˆ†æ•°çˆ†è¡¨ï¼Œå®é™…ç”¨èµ·æ¥æ¼æ´ç™¾å‡ºã€‚è€Œâ€œå˜ç›¸åœ¨æµ‹è¯•é›†ä¸Šè®­ç»ƒâ€è¿™ä»¶äº‹ï¼Œå·²ç»ç©å‡ºäº†èŠ±ï¼Œæˆäº†è¡Œä¸šæ½œè§„åˆ™ã€‚</p>
<p>å¦‚æœåœ¨ç¢¾å‹æ‰€æœ‰åŸºå‡†æµ‹è¯•ï¼ˆbenchmarkï¼‰çš„åŒæ—¶ï¼Œå´ä»æœªå®ç°é€šç”¨äººå·¥æ™ºèƒ½ï¼ˆAGIï¼‰ï¼Œé‚£å°†ä¼šæ˜¯ä¸€ç§ä»€ä¹ˆæ™¯è±¡ï¼Ÿ</p>
<h2 data-id="heading-2"><strong>03 Cursor / æ–°çš„ LLM åº”ç”¨å±‚</strong></h2>
<p>å…³äº Cursorï¼ˆé™¤äº†å®ƒä»Šå¹´ä»¥ç«ç®­èˆ¬çš„é€Ÿåº¦å´›èµ·ä¹‹å¤–ï¼‰ï¼Œæˆ‘è§‰å¾—æœ€å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šCursor ä¸ä»…è‡ªå·±æˆåŠŸäº†ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒå¼€åˆ›äº†ä¸€ç§æ–°æ¨¡å¼ï¼Œå¤§å®¶çªç„¶æ„è¯†åˆ°ï¼šâ€œå“¦ï¼ŒåŸæ¥ LLM åº”ç”¨å¯ä»¥è¿™æ ·åšï¼â€äºæ˜¯å¼€å§‹è®¾æƒ³å„è¡Œå„ä¸šçš„â€œCursorâ€ã€‚æ­£å¦‚æˆ‘ä»Šå¹´åœ¨ Y Combinator æ¼”è®²ä¸­æ‰€å¼ºè°ƒçš„ï¼ˆé™„æœ‰æ–‡å­—ç¨¿[1]å’Œè§†é¢‘[2]ï¼‰ï¼Œåƒ Cursor è¿™æ ·çš„ LLM åº”ç”¨ï¼Œä¼šä¸ºç‰¹å®šå‚ç›´é¢†åŸŸï¼ˆå¦‚ç¼–ç¨‹ã€æ³•å¾‹ã€è®¾è®¡ç­‰ï¼‰å°†å¤šæ¬¡ LLM è°ƒç”¨æ‰“åŒ…å¹¶ç¼–æ’æˆä¸€ä¸ªæ•´ä½“å·¥ä½œæµï¼š</p>
<ul>
<li>å®ƒä»¬è´Ÿè´£ <strong>â€œä¸Šä¸‹æ–‡å·¥ç¨‹â€ï¼ˆcontext engineeringï¼‰</strong></li>
<li>å®ƒä»¬<strong>åœ¨åå°å°†å¤šæ¬¡ LLM è°ƒç”¨ç¼–æ’æˆæ—¥ç›Šå¤æ‚çš„ DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰</strong> ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­ç²¾ç»†æƒè¡¡æ€§èƒ½ä¸è®¡ç®—æˆæœ¬</li>
<li>å®ƒä»¬ä¸ºâ€œhuman-in-the-loopâ€ä¸­æä¾›<strong>é¢å‘ç‰¹å®šåº”ç”¨åœºæ™¯çš„å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰</strong></li>
<li>å®ƒä»¬æä¾›ä¸€ä¸ª <strong>â€œè‡ªä¸»æ€§æ»‘å—â€ï¼ˆautonomy sliderï¼‰</strong> Â â€”â€” å…è®¸ç”¨æˆ·åŠ¨æ€è°ƒèŠ‚ AI çš„å†³ç­–è‡ªç”±åº¦</li>
</ul>
<p>2025 å¹´ï¼Œä¸šç•Œå¤§é‡è®¨è®ºéƒ½å›´ç»•ç€è¿™ä¸ªæ–°å‡ºç°çš„åº”ç”¨å±‚çš„â€œåšåº¦â€ï¼ŒLLM å®éªŒå®¤ï¼ˆå¦‚ OpenAIã€Anthropic ç­‰ï¼‰ä¼šåƒæ‰æ‰€æœ‰ä¸Šå±‚åº”ç”¨ï¼Œè¿˜æ˜¯è¯´ LLM åº”ç”¨é¢†åŸŸä»æ˜¯å¹¿é˜”å¤©åœ°ï¼Œå¤§æœ‰ä½œä¸ºï¼Ÿæˆ‘ä¸ªäººè®¤ä¸ºï¼ŒLLM å®éªŒå®¤ä¼šå€¾å‘äºåŸ¹å…»å‡ºä¸€ä¸ªâ€œé€šæ‰å‹çš„å¤§å­¦ç”Ÿâ€ï¼Œè€Œ LLM åº”ç”¨åˆ™ä¼šé€šè¿‡æ³¨å…¥ç§æœ‰æ•°æ®ã€ä¼ æ„Ÿå™¨ã€æ‰§è¡Œå™¨å’Œåé¦ˆå›è·¯ï¼Œå¯¹è¿™äº›â€œå¤§å­¦ç”Ÿâ€è¿›è¡Œç»„ç»‡ã€å¾®è°ƒï¼Œå¹¶çœŸæ­£æ¿€æ´»æˆéƒ¨ç½²åœ¨å…·ä½“å‚ç›´é¢†åŸŸçš„â€œä¸“ä¸šä»ä¸šè€…â€ã€‚</p>
<h2 data-id="heading-3"><strong>04 Claude Code / é©»å®ˆåœ¨æˆ‘ä»¬è®¡ç®—æœºçš„ AI</strong></h2>
<p>Claude Codeï¼ˆCCï¼‰æˆä¸ºé¦–ä¸ªä»¤å¤§å®¶ä¿¡æœçš„ LLM æ™ºèƒ½ä½“ï¼ˆAgentï¼‰èŒƒä¾‹ â€”â€” å®ƒä»¥å¾ªç¯è¿­ä»£æ–¹å¼å°†å·¥å…·ä½¿ç”¨ä¸æ¨ç†ä¸²è”èµ·æ¥ï¼Œç”¨äºè§£å†³éœ€è¦é•¿æ—¶é—´ã€å¤šæ­¥éª¤çš„å¤æ‚é—®é¢˜ã€‚æ­¤å¤–ï¼Œå¯¹æˆ‘è€Œè¨€ï¼ŒCC çš„å¦ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼šå®ƒè¿è¡Œåœ¨æˆ‘ä»¬çš„æœ¬åœ°è®¡ç®—æœºä¸Šï¼Œå¹¶ç›´æ¥åˆ©ç”¨æˆ‘ä»¬æœ¬åœ°çš„ç§æœ‰ç¯å¢ƒã€æ•°æ®å’Œä¸Šä¸‹æ–‡ã€‚æˆ‘è®¤ä¸º OpenAI åœ¨è¿™ä¸€ç‚¹ä¸Šåˆ¤æ–­æœ‰è¯¯ï¼Œå› ä¸ºä»–ä»¬æ—©æœŸåœ¨ Codex / æ™ºèƒ½ä½“ï¼ˆagentï¼‰æ–¹é¢çš„å°è¯•ï¼Œèšç„¦äºé€šè¿‡ ChatGPT ç¼–æ’äº‘ç«¯å®¹å™¨ä¸­çš„æ™ºèƒ½ä½“ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨ç”¨æˆ·çš„æœ¬åœ°æœºå™¨ï¼ˆlocalhostï¼‰ä¸Šè¿è¡Œã€‚å°½ç®¡äº‘ç«¯è¿è¡Œçš„æ™ºèƒ½ä½“é›†ç¾¤ï¼ˆagent swarmsï¼‰å¬èµ·æ¥åƒæ˜¯â€œAGI çš„æœ€ç»ˆå½¢æ€ï¼Œä½†æˆ‘ä»¬æ­£å¤„åœ¨ä¸€ä¸ªèƒ½åŠ›â€œé”¯é½¿çŠ¶â€ã€æ¼”è¿›ç¼“æ…¢çš„ä¸­é—´é˜¶æ®µï¼Œåœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œè®©æ™ºèƒ½ä½“ç›´æ¥è¿è¡Œåœ¨å¼€å‘è€…æœ¬æœºä¸Šåè€Œæ›´åˆç†ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>çœŸæ­£å…³é”®çš„åŒºåˆ«å¹¶ä¸åœ¨äºâ€œAI è¿ç®—â€ï¼ˆAI opsï¼‰åˆ°åº•è·‘åœ¨å“ªå„¿ï¼ˆäº‘ç«¯ã€æœ¬åœ°ï¼Œæˆ–å…¶ä»–åœ°æ–¹ï¼‰ï¼Œè€Œåœ¨äºå…¶ä»–å› ç´  â€”â€” é‚£å°å·²ç»å¼€æœºå¹¶è¿è¡Œç€çš„ç”µè„‘ï¼Œä»¥åŠå®ƒä¸Šé¢å·²å®‰è£…çš„è½¯ä»¶ã€å½“å‰ä¸Šä¸‹æ–‡ã€æ•°æ®ã€å¯†é’¥ã€é…ç½®ï¼Œè¿˜æœ‰ä½å»¶è¿Ÿçš„äº¤äº’ä½“éªŒã€‚</strong></p>
<p>Anthropic æ­£ç¡®æŠŠæ¡äº†è¿™ä¸€ä¼˜å…ˆçº§ï¼Œå¹¶å°† Claude Codeï¼ˆCCï¼‰æ‰“é€ æˆä¸€ä¸ªç²¾å·§çš„ã€æç®€çš„å‘½ä»¤è¡Œï¼ˆCLIï¼‰å½¢æ€ï¼Œè¿™ç§å½¢æ€å½»åº•æ”¹å˜äº†äººä»¬å¯¹ AI çš„è®¤çŸ¥ï¼šå®ƒä¸å†åªæ˜¯ä¸€ä¸ªåƒ Google é‚£æ ·éœ€è¦ä½ ä¸»åŠ¨æ‰“å¼€æµè§ˆå™¨å»è®¿é—®çš„ç½‘ç«™ï¼Œè€Œæ›´åƒæ˜¯ä¸€ä¸ªâ€œå¯„å±…â€åœ¨ä½ ç”µè„‘é‡Œçš„å°ç²¾çµï¼ˆæˆ–å¹½çµï¼‰ã€‚è¿™æ˜¯ä¸€ç§ä¸ AI äº¤äº’çš„å…¨æ–°ä¸”æˆªç„¶ä¸åŒçš„èŒƒå¼ã€‚</p>
<h2 data-id="heading-4"><strong>05 Vibe coding</strong></h2>
<p>2025 å¹´ï¼ŒAI çš„èƒ½åŠ›è¾¾åˆ°äº†ä¸€ä¸ªè´¨å˜çš„ä¸´ç•Œç‚¹ï¼šäººä»¬ç°åœ¨èƒ½ä»…é€šè¿‡è‡ªç„¶è¯­è¨€å°±æ„å»ºå‡ºå„ç§ä»¤äººä¸ºä¹‹æƒŠå¹çš„ç¨‹åºï¼Œç”šè‡³å®Œå…¨ä¸ç”¨å»æƒ³â€œä»£ç â€æœ¬èº«çš„å­˜åœ¨ã€‚è¯´æ¥å¥½ç¬‘ï¼Œæˆ‘æ˜¯åœ¨ä¸€æ¡æ€ç»ªå¦‚æ³‰æ¶Œçš„æ¨æ–‡[3]ä¸­éšå£åˆ›é€ äº† â€œvibe codingâ€ï¼ˆæ°›å›´ç¼–ç¨‹ï¼‰è¿™ä¸ªè¯ï¼Œå½“æ—¶æ ¹æœ¬æ²¡æƒ³åˆ°å®ƒå±…ç„¶ç«äº† :)ã€‚é€šè¿‡ vibe codingï¼Œç¼–ç¨‹å°±ä¸å†æ˜¯ç»è¿‡å¤§é‡è®­ç»ƒçš„ä¸“ä¸šäººå£«çš„ä¸“å±é¢†åŸŸï¼Œè€Œæ˜¯ä»»ä½•äººéƒ½èƒ½ä¸Šæ‰‹çš„äº‹æƒ…ã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œå®ƒå†æ¬¡å°è¯äº†æˆ‘åœ¨ã€ŠPower to the people: How LLMs flip the script on technology diffusionã€‹[4]ä¸­å†™åˆ°çš„è§‚ç‚¹ï¼šä¸è¿„ä»Šä¸ºæ­¢å‡ ä¹æ‰€æœ‰å…¶ä»–æŠ€æœ¯éƒ½ä¸åŒï¼Œæ™®é€šå¤§ä¼—ä» LLM ä¸­çš„è·ç›Šè¿œå¤§äºä¸“ä¸šäººå£«ã€ä¼ä¸šå’Œæ”¿åºœã€‚</p>
<p>ä½† vibe coding çš„æ„ä¹‰ä¸ä»…åœ¨äºå¸®åŠ©æ™®é€šäººæ¥è§¦ç¼–ç¨‹ â€”â€” å®ƒä¹Ÿè®©å—è¿‡ä¸“ä¸šè®­ç»ƒçš„å¼€å‘è€…èƒ½å¤Ÿå†™å‡ºå¤§é‡åŸæœ¬æ ¹æœ¬ä¸ä¼šè¢«å®ç°çš„ï¼ˆvibe codedï¼‰è½¯ä»¶ã€‚</p>
<p>åœ¨ nanochat ä¸­ï¼Œæˆ‘ç”¨ vibe coding è‡ªå·±å†™äº†ä¸€ä¸ªé«˜åº¦å®šåˆ¶çš„ã€é«˜æ•ˆçš„ Rust ç‰ˆ BPE tokenizerï¼Œä¸”æ— éœ€ä¾èµ–ç°æˆçš„åº“ï¼Œä¹Ÿæ— éœ€æ·±å…¥å­¦ä¹  Rustã€‚ä»Šå¹´æˆ‘ç”¨ vibe coding å¿«é€Ÿåšå‡ºäº†è®¸å¤šå°åº”ç”¨åŸå‹ï¼Œåªä¸ºå®ç°æˆ‘è„‘ä¸­é‚£äº›ä¸€é—ªè€Œè¿‡çš„æƒ³æ³•ï¼ˆä¾‹å¦‚ï¼šmenugen[5]ã€llm-council[6]ã€reader3[7]ã€HN time capsule[8]ï¼‰ã€‚æˆ‘ç”šè‡³ç”¨ vibe coding å†™è¿‡ä¸€æ•´ä¸ªä¸´æ—¶åº”ç”¨ï¼Œåªä¸ºå®šä½ä¸€ä¸ª bug â€”â€” ä¸ºä»€ä¹ˆä¸å‘¢ï¼Ÿæ¯•ç«Ÿä»£ç çªç„¶å˜å¾—æˆæœ¬æä½ï¼ˆfreeï¼‰ã€çŸ­æš‚ï¼ˆephemeralï¼‰ã€å¯å¡‘ï¼ˆmalleableï¼‰ã€ç”¨å®Œå³å¯ä¸¢å¼ƒï¼ˆdiscardable after single useï¼‰ã€‚Vibe coding å°†é‡å¡‘è½¯ä»¶ç”Ÿæ€ï¼Œå¹¶å½»åº•æ”¹å˜å¼€å‘ç›¸å…³å²—ä½çš„èŒè´£æè¿°ã€‚</p>
<h2 data-id="heading-5"><strong>06 Nano banana / LLM GUI</strong></h2>
<p>Google Gemini Nano banana æ˜¯ 2025 å¹´æœ€å…·é¢ è¦†æ€§ã€æœ€èƒ½æ¨åŠ¨èŒƒå¼å˜é©çš„æ¨¡å‹ä¹‹ä¸€ã€‚åœ¨æˆ‘çš„ä¸–ç•Œè§‚ä¸­ï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰æ˜¯ç»§ 1970ã€80 å¹´ä»£è®¡ç®—æœºä¹‹åçš„ä¸‹ä¸€ä¸ªé‡å¤§è®¡ç®—èŒƒå¼ã€‚å› æ­¤ï¼Œå‡ºäºæœ¬è´¨ä¸Šç›¸ä¼¼çš„åŸå› ï¼Œæˆ‘ä»¬å°†ä¼šè§è¯ç±»ä¼¼ç±»å‹çš„åˆ›æ–°ã€‚æˆ‘ä»¬å°†çœ‹åˆ°ç±»ä¼¼äºâ€œä¸ªäººè®¡ç®—â€ã€â€œå¾®æ§åˆ¶å™¨â€ï¼ˆè®¤çŸ¥æ ¸å¿ƒï¼‰æˆ–â€œäº’è”ç½‘â€ï¼ˆæ™ºèƒ½ä½“ç½‘ç»œï¼‰ç­‰äº‹ç‰©åœ¨ AI æ—¶ä»£çš„å¯¹åº”å½¢æ€ã€‚</p>
<p>å°¤å…¶æ˜¯åœ¨ UI/UX æ–¹é¢ï¼Œâ€œä¸ LLM å¯¹è¯â€æœ‰ç‚¹åƒåœ¨ 1980 å¹´ä»£å‘è®¡ç®—æœºç»ˆç«¯è¾“å…¥å‘½ä»¤ã€‚æ–‡æœ¬æ˜¯è®¡ç®—æœºï¼ˆä»¥åŠ LLMï¼‰çš„åŸå§‹/é¦–é€‰æ•°æ®è¡¨ç¤ºå½¢å¼ï¼Œå´å¹¶éäººç±»åå¥½çš„äº¤äº’æ ¼å¼ â€”â€” å°¤å…¶æ˜¯åœ¨è¾“å…¥ç«¯ã€‚äº‹å®ä¸Šï¼Œäººä»¬å¹¶ä¸å–œæ¬¢é˜…è¯»å¤§æ®µæ–‡å­—ï¼Œå› ä¸ºè¿™æ—¢æ…¢åˆè´¹åŠ›ã€‚ç›¸åï¼Œäººä»¬æ›´å€¾å‘äºä»¥è§†è§‰åŒ–ã€ç©ºé—´åŒ–çš„æ–¹å¼æ¥æ”¶ä¿¡æ¯ï¼Œè¿™æ­£æ˜¯ä¼ ç»Ÿè®¡ç®—ï¼ˆtraditional computingï¼‰ä¸­å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰è¢«å‘æ˜çš„åŸå› ã€‚</p>
<p>åŒç†ï¼Œ<strong>LLM ä¹Ÿåº”è¯¥ç”¨æˆ‘ä»¬åå¥½çš„æ ¼å¼ä¸æˆ‘ä»¬å¯¹è¯ â€”â€” æ¯”å¦‚ï¼šå›¾ç‰‡ã€ä¿¡æ¯å›¾ã€å¹»ç¯ç‰‡ã€ç™½æ¿ã€åŠ¨ç”»/è§†é¢‘ã€ç½‘é¡µåº”ç”¨ç­‰ã€‚</strong></p>
<p>å½“ç„¶ï¼Œè¿™ç§ç†å¿µçš„æ—©æœŸå½¢æ€å’Œå½“å‰ç‰ˆæœ¬ï¼Œæ˜¯åƒ emoji å’Œ Markdown è¿™æ ·çš„ä¸œè¥¿ â€”â€” å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯é€šè¿‡æ ‡é¢˜ã€åŠ ç²—ã€æ–œä½“ã€åˆ—è¡¨ã€è¡¨æ ¼ç­‰æ–¹å¼å¯¹æ–‡æœ¬è¿›è¡Œâ€œè§†è§‰è£…é¥°â€å’Œæ’ç‰ˆï¼Œæ¥æå‡å¯è¯»æ€§ã€‚</p>
<p>ä½†ç©¶ç«Ÿè°ä¼šçœŸæ­£æ„å»ºå‡º LLM çš„ GUIï¼ˆå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼‰ï¼Ÿ</p>
<p>åœ¨è¿™ä¸€ä¸–ç•Œè§‚ä¸‹ï¼ŒNano banana æ˜¯å¯¹æ­¤æœªæ¥å½¢æ€çš„ä¸€æ¬¡æ—©æœŸé¢„ç¤ºã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒNano Banana çš„æ„ä¹‰ï¼Œä¸åœ¨äºå®ƒèƒ½è¿›è¡Œå›¾åƒç”Ÿæˆï¼Œè€Œåœ¨äºæ–‡æœ¬ç”Ÿæˆã€å›¾åƒç”Ÿæˆä¸ä¸–ç•ŒçŸ¥è¯†åœ¨æ¨¡å‹æƒé‡ä¸­æ·±åº¦èåˆæ‰€äº§ç”Ÿçš„è”åˆèƒ½åŠ›ã€‚</p>
<p><strong>END</strong></p>
<p><strong>æœ¬æœŸäº’åŠ¨å†…å®¹ ğŸ»</strong></p>
<p><strong>â“å¦‚æœåƒ Nano Banana é¢„ç¤ºçš„é‚£æ ·ï¼Œæœªæ¥çš„ AI ä¸å†åªç”¨æ–‡å­—å›å¤ä½ ï¼Œè€Œæ˜¯è‡ªåŠ¨ç”Ÿæˆå›¾è¡¨ã€æµç¨‹å›¾ã€ç”šè‡³äº¤äº’ç•Œé¢ â€”â€” ä½ æœ€å¸Œæœ›å®ƒåœ¨å“ªç§åœºæ™¯ä¸‹ä»¥â€œéæ–‡å­—â€çš„æ–¹å¼ä¸ä½ åä½œï¼Ÿ</strong></p>
<p><strong>æ–‡ä¸­é“¾æ¥</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.donnamagi.com%2Farticles%2Fkarpathy-yc-talk" target="_blank" title="https://www.donnamagi.com/articles/karpathy-yc-talk" ref="nofollow noopener noreferrer">www.donnamagi.com/articles/kaâ€¦</a></p>
<p>[2]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DLCEmiRjPEtQ" target="_blank" title="https://www.youtube.com/watch?v=LCEmiRjPEtQ" ref="nofollow noopener noreferrer">www.youtube.com/watch?v=LCEâ€¦</a></p>
<p>[3]<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fkarpathy%2Fstatus%2F1886192184808149383" target="_blank" title="https://x.com/karpathy/status/1886192184808149383" ref="nofollow noopener noreferrer">x.com/karpathy/stâ€¦</a></p>
<p>[4]<a href="https://link.juejin.cn?target=https%3A%2F%2Fkarpathy.bearblog.dev%2Fpower-to-the-people%2F" target="_blank" title="https://karpathy.bearblog.dev/power-to-the-people/" ref="nofollow noopener noreferrer">karpathy.bearblog.dev/power-to-thâ€¦</a></p>
<p>[5]<a href="https://link.juejin.cn?target=https%3A%2F%2Fkarpathy.bearblog.dev%2Fvibe-coding-menugen" target="_blank" title="https://karpathy.bearblog.dev/vibe-coding-menugen" ref="nofollow noopener noreferrer">karpathy.bearblog.dev/vibe-codingâ€¦</a></p>
<p>[6]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkarpathy%2Fllm-council" target="_blank" title="https://github.com/karpathy/llm-council" ref="nofollow noopener noreferrer">github.com/karpathy/llâ€¦</a></p>
<p>[7]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkarpathy%2Freader3" target="_blank" title="https://github.com/karpathy/reader3" ref="nofollow noopener noreferrer">github.com/karpathy/reâ€¦</a></p>
<p>[8]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkarpathy%2Fhn-time-capsule" target="_blank" title="https://github.com/karpathy/hn-time-capsule" ref="nofollow noopener noreferrer">github.com/karpathy/hnâ€¦</a></p>
<p><strong>åŸæ–‡é“¾æ¥ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fkarpathy.bearblog.dev%2Fyear-in-review-2025%2F" target="_blank" title="https://karpathy.bearblog.dev/year-in-review-2025/" ref="nofollow noopener noreferrer">karpathy.bearblog.dev/year-in-revâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¿ç»´å¿…å¤‡ï¼ä¸€æ¬¾å…¨å¹³å°å¯ç”¨çš„æœåŠ¡å™¨ç®¡ç†åˆ©å™¨ï¼]]></title>    <link>https://juejin.cn/post/7592815497848750143</link>    <guid>https://juejin.cn/post/7592815497848750143</guid>    <pubDate>2026-01-09T01:19:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592815497848750143" data-draft-id="7589171972447027242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¿ç»´å¿…å¤‡ï¼ä¸€æ¬¾å…¨å¹³å°å¯ç”¨çš„æœåŠ¡å™¨ç®¡ç†åˆ©å™¨ï¼"/> <meta itemprop="keywords" content="React.js,Linux,Docker"/> <meta itemprop="datePublished" content="2026-01-09T01:19:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaé™ˆåºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/3958702402176765"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¿ç»´å¿…å¤‡ï¼ä¸€æ¬¾å…¨å¹³å°å¯ç”¨çš„æœåŠ¡å™¨ç®¡ç†åˆ©å™¨ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3958702402176765/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaé™ˆåºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:19:45.000Z" title="Fri Jan 09 2026 01:19:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ <code>Javaé™ˆåºå‘˜</code>ã€‚</p>
<p>åœ¨ä¼ä¸šå¼€å‘ä¸­ï¼Œä½ æ˜¯å¦æœ‰é‡åˆ°è¿‡å¦‚ä¸‹éš¾é¢˜ï¼šç®¡ç† 3 å°æœåŠ¡å™¨éœ€è¦åŒæ—¶æ‰“å¼€ç»ˆç«¯å·¥å…·ã€æ–‡ä»¶ä¼ è¾“è½¯ä»¶å’Œç›‘æ§é¢æ¿ï¼Œåˆ‡æ¢çª—å£çš„æ—¶é—´æ¯”å®é™…æ“ä½œè¿˜å¤šï¼›å‡ºé—¨åœ¨å¤–æƒ³ä¸´æ—¶è°ƒæ•´é…ç½®ï¼Œæ‰‹æœºä¸Šå´æ‰¾ä¸åˆ°èƒ½æµç•…è¿è¡Œçš„ SSH å®¢æˆ·ç«¯ï¼›å›¢é˜Ÿåä½œæ—¶ï¼ŒæœåŠ¡å™¨è¿æ¥ä¿¡æ¯åœ¨ Excel å’ŒèŠå¤©è®°å½•é‡Œæ‚ä¹±å †æ”¾ï¼Œå®‰å…¨æ€§æ— ä»è°ˆèµ·ï¼Ÿ</p>
<p>ä»Šå¤©ï¼Œç»™å¤§å®¶æ¨èä¸€æ¬¾å¼€æºã€å…¨å¹³å°å¯ç”¨çš„æœåŠ¡å™¨ç®¡ç†åˆ©å™¨ï¼Œè¿ç»´å¿…å¤‡ï¼</p>
<h2 data-id="heading-0">é¡¹ç›®ä»‹ç»</h2>
<p><code>Termix</code> â€”â€” ä¸€ä¸ªå¼€æºã€æ°¸ä¹…å…è´¹ã€è‡ªæ‰˜ç®¡çš„ä¸€ä½“åŒ–æœåŠ¡å™¨ç®¡ç†å¹³å°ï¼Œé€šè¿‡ä¸€ä¸ªç›´è§‚çš„ç•Œé¢ç®¡ç†æœåŠ¡å™¨å’ŒåŸºç¡€è®¾æ–½ï¼ŒåŒæ—¶æä¾› SSH ç»ˆç«¯è®¿é—®ã€SSH éš§é“åŠŸèƒ½ä»¥åŠè¿œç¨‹æ–‡ä»¶ç®¡ç†ç­‰åŠŸèƒ½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e28e5f42f7654202a6598e1ad8840e3f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YemZiOW6j-WRmA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526385&amp;x-signature=vBowHfcMhXnFDUeRQ0vk4tsw5uI%3D" alt="" loading="lazy"/></p>
<p><strong>åŠŸèƒ½ç‰¹è‰²</strong>ï¼š</p>
<ul>
<li><strong>å…¨èƒ½ SSH ç»ˆç«¯ä¸è¿æ¥ç®¡ç†</strong>ï¼šåŠŸèƒ½é½å…¨çš„ç»ˆç«¯ï¼Œæ”¯æŒåˆ†å±æ“ä½œï¼›æ”¯æŒåˆ›å»ºå¯é‡ç”¨çš„å‘½ä»¤ç‰‡æ®µï¼Œå¯åœ¨å¤šä¸ªæ‰“å¼€çš„ç»ˆç«¯ä¸ŠåŒæ—¶è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼›æ”¯æŒè·³æ¿æœºã€warpgateã€åŸºäº TOTP çš„è¿æ¥ç­‰</li>
<li><strong>å¯è§†åŒ–çš„è¿œç¨‹æ–‡ä»¶ç®¡ç†</strong>ï¼šæ”¯æŒç›´æ¥æµè§ˆç¼–è¾‘ä»£ç ã€å›¾ç‰‡ã€éŸ³è§†é¢‘ç­‰æ–‡ä»¶ï¼Œä»£ç æ–‡ä»¶è‡ªåŠ¨è¯†åˆ« 20 + ç¼–ç¨‹è¯­è¨€å¹¶é«˜äº®æ˜¾ç¤ºï¼›æ”¯æŒæ‹–æ‹½ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶ã€æ‰¹é‡é‡å‘½åã€ç§»åŠ¨ç­‰æ“ä½œ</li>
<li><strong>å…¨é¢çš„æœåŠ¡å™¨ç›‘æ§</strong>ï¼šé€šè¿‡ä»ªè¡¨ç›˜ç›´è§‚åœ°å±•ç¤º SSH æœåŠ¡å™¨çš„ CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡ã€ç½‘ç»œæµé‡ä¸ç³»ç»Ÿè¿è¡Œæ—¶é—´ç­‰ä¿¡æ¯</li>
<li><strong>å®‰å…¨ä¸éšç§ä¿éšœ</strong>ï¼šå…·å¤‡å®‰å…¨çš„ç”¨æˆ·ç®¡ç†ï¼Œæ”¯æŒ OIDC è®¤è¯ä¸ 2FAï¼ˆTOTPï¼‰åŒé‡éªŒè¯ï¼Œæ‰€æœ‰ä¿¡æ¯å­˜å‚¨åœ¨æœ¬åœ°åŠ å¯† SQLite æ•°æ®åº“ï¼Œæ— éœ€æ‹…å¿ƒæ•°æ®æ³„éœ²çš„é£é™©</li>
<li><strong>å…¨å¹³å°æ— ç¼ä½“éªŒ</strong>ï¼šç½‘é¡µç«¯ã€æ¡Œé¢ç«¯ï¼ˆWindows/Linux/macOSï¼‰ã€ç§»åŠ¨ç«¯ï¼ˆiOS/Androidï¼‰å…¨æ”¯æŒï¼ŒåŒæ—¶ä¸€å¤„é…ç½®ï¼Œå¤šç«¯åŒæ­¥ä½¿ç”¨ï¼Œé€‚åº”å›ºå®šåŠå…¬ä¸ç§»åŠ¨è¿ç»´åœºæ™¯</li>
<li><strong>ç°ä»£ç•Œé¢è®¾è®¡</strong>ï¼šåŸºäº Reactã€Tailwind CSS å’Œ Shadcn æ„å»ºçš„ç®€æ´çš„æ¡Œé¢/ç§»åŠ¨è®¾å¤‡å‹å¥½ç•Œé¢ï¼Œå†…ç½®è‹±è¯­ã€ä¸­æ–‡ã€å¾·è¯­ã€è‘¡è„ç‰™è¯­ï¼Œæœ¬åœ°åŒ–ä½“éªŒå‹å¥½</li>
</ul>
<h2 data-id="heading-1">å¿«é€Ÿä¸Šæ‰‹</h2>
<p><code>Termix</code> æ”¯æŒç½‘ç«™ã€Windowsã€Linuxã€macOSã€iOS/iPadOSã€Android å¤šå¹³å°ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-2">å®‰è£…åŒ…å®‰è£…</h3>
<p>1ã€æ‰“å¼€ä¸‹è½½åœ°å€</p>
<pre><code class="hljs language-bash" lang="bash">https://github.com/Termix-SSH/Termix/releases
</code></pre>
<p>2ã€ä¸‹è½½å¯¹åº”æ“ä½œç³»ç»Ÿçš„å®‰è£…åŒ…</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e82f95131bf4763918cc675a1d8085d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YemZiOW6j-WRmA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526385&amp;x-signature=qUyVvGaFTBU%2BOnKYn9g4JY4V0nI%3D" alt="" loading="lazy"/></p>
<p>3ã€è§£å‹å¹¶å®‰è£…</p>
<h3 data-id="heading-3">Docker éƒ¨ç½²</h3>
<p>1ã€æ‹‰å–é•œåƒ</p>
<pre><code class="hljs language-bash" lang="bash">docker pull ghcr.io/lukegus/termix:latest
</code></pre>
<p>2ã€åˆ›å»ºæŒ‚è½½ç›®å½•</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p /data/software/termix
</code></pre>
<p>3ã€è¿è¡Œå®¹å™¨</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d --name termix \
	-p 8080:8080 \
	-v /data/software/termix:/app/data \
	-e PORT=8080 \
	ghcr.io/lukegus/termix:latest
</code></pre>
<p>4ã€å®¹å™¨è¿è¡ŒæˆåŠŸåï¼Œæµè§ˆå™¨è®¿é—®</p>
<pre><code class="hljs language-bash" lang="bash">http://{IP/åŸŸå}:8080
</code></pre>
<blockquote>
<p><strong>é¦–æ¬¡æ³¨å†Œçš„ç”¨æˆ·å³ä¸ºé»˜è®¤ç®¡ç†å‘˜</strong>ã€‚</p>
</blockquote>
<h3 data-id="heading-4">Docker Compose éƒ¨ç½²</h3>
<p>1ã€åˆ›å»º <code>docker-compose.yml</code> æ–‡ä»¶</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">services:</span>
  <span class="hljs-attr">termix:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">ghcr.io/lukegus/termix:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">termix</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:8080"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/data/software/termix:/app/data</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">PORT:</span> <span class="hljs-string">"8080"</span>

<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">termix-data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
</code></pre>
<p>2ã€è¿è¡Œå¯åŠ¨</p>
<pre><code class="hljs language-bash" lang="bash">docker compose up -d
</code></pre>
<h2 data-id="heading-5">åŠŸèƒ½ä½“éªŒ</h2>
<ul>
<li><strong>ä»ªè¡¨æ¿</strong></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8487bb42c8b34593a9b695bf0474fde8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YemZiOW6j-WRmA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526385&amp;x-signature=wG1HjRfn4LqH1%2Br%2F%2BwI%2FwRWse1o%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>ä¸»æœºç®¡ç†</strong></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3ef9cd725204c99b5fccc41068104d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YemZiOW6j-WRmA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526385&amp;x-signature=vEhkGBM4nTwmV%2F31RG%2BjwQidIYY%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>SSH è¿æ¥</strong></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f57d6192f836420ba16f2481803edb8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YemZiOW6j-WRmA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526385&amp;x-signature=h7SY0huniQBf3DQnGu%2BWQXeMUgk%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>æ–‡ä»¶ç®¡ç†</strong></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84e26548ab084b47b2f6891610b01e85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YemZiOW6j-WRmA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526385&amp;x-signature=czibgjAej8suOuKYL2l9uhV1tgA%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>æœåŠ¡å™¨çŠ¶æ€ä»ªè¡¨ç›˜</strong></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b88caffbf37e4dfea53f080a737dfded~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YemZiOW6j-WRmA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526385&amp;x-signature=%2BNe05kJFY8vwOojD4S6057eO%2BMI%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>ç®¡ç†å‘˜è®¾ç½®</strong></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05d0864b865341dc8e354bcc7790591b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YemZiOW6j-WRmA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526385&amp;x-signature=asWVPNU2fZ4yh3U6k2hDjpxCxKQ%3D" alt="" loading="lazy"/></p>
<p>æ— è®ºæ˜¯ä¸ªäººå¼€å‘è€…ç®¡ç†æœåŠ¡å™¨ï¼Œè¿˜æ˜¯ä¼ä¸šè¿ç»´å›¢é˜Ÿç®¡æ§é›†ç¾¤ï¼ŒTermix éƒ½èƒ½å¤§å¹…ç®€åŒ–å·¥ä½œæµç¨‹ã€‚å¦‚æœä½ ç»å¸¸éœ€è¦ç®¡ç†è¿œç¨‹æœåŠ¡å™¨ï¼ŒTermix ç»å¯¹å€¼å¾—ä¸€è¯•ï¼Œå¿«å»å®‰è£…è¯•è¯•å§~</p>
<pre><code class="hljs language-bash" lang="bash">é¡¹ç›®åœ°å€ï¼šhttps://github.com/Termix-SSH/Termix
</code></pre>
<h2 data-id="heading-6">æœ€å</h2>
<p>æ¨èçš„å¼€æºé¡¹ç›®å·²ç»æ”¶å½•åˆ° <code>GitHub</code> é¡¹ç›®ï¼Œæ¬¢è¿ <code>Star</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">https://github.com/chenyl8848/great-open-source-project
</code></pre>
<p>æˆ–è€…è®¿é—®ç½‘ç«™ï¼Œè¿›è¡Œåœ¨çº¿æµè§ˆï¼š</p>
<pre><code class="hljs language-bash" lang="bash">https://chencoding.top:8090/<span class="hljs-comment">#/</span>
</code></pre>
<blockquote>
<p>å¤§å®¶çš„ç‚¹èµã€æ”¶è—å’Œè¯„è®ºéƒ½æ˜¯å¯¹ä½œè€…çš„æ”¯æŒï¼Œå¦‚æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©è¿˜è¯·ç‚¹èµè½¬å‘æ”¯æŒä¸‹ï¼Œè°¢è°¢ï¼</p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VTJ.PROã€ŒAI + ä½ä»£ç ã€åº”ç”¨å¼€å‘å¹³å°çš„åç«¯æ¨¡å—ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7592876744526315570</link>    <guid>https://juejin.cn/post/7592876744526315570</guid>    <pubDate>2026-01-09T01:43:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592876744526315570" data-draft-id="7592833068224397358" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VTJ.PROã€ŒAI + ä½ä»£ç ã€åº”ç”¨å¼€å‘å¹³å°çš„åç«¯æ¨¡å—ç³»ç»Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½,ä½ä»£ç "/> <meta itemprop="datePublished" content="2026-01-09T01:43:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸©ç€ä¸¤æ¡è™«"/> <meta itemprop="url" content="https://juejin.cn/user/4141239932051488"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VTJ.PROã€ŒAI + ä½ä»£ç ã€åº”ç”¨å¼€å‘å¹³å°çš„åç«¯æ¨¡å—ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4141239932051488/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸©ç€ä¸¤æ¡è™«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:43:22.000Z" title="Fri Jan 09 2026 01:43:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ç›®çš„ä¸èŒƒå›´</h3>
<p>æœ¬æ–‡æ¡£æè¿°äº†åŸºäºNestJSçš„VTJ.PROåç«¯æ¨¡å—æ¶æ„ã€‚å®ƒæ¶µç›–äº†æ¨¡å—ç»„ç»‡ç»“æ„ã€ä¾èµ–æ³¨å…¥æ¨¡å¼ã€TypeORMé›†æˆä»¥åŠä¸šåŠ¡é€»è¾‘åœ¨æ ¸å¿ƒæ¨¡å—å’Œä¸šåŠ¡æ¨¡å—ä¸­çš„ç»„ç»‡æ–¹å¼ã€‚æœ¬æ–‡æ¡£ä¾§é‡äºåç«¯çš„ç»“æ„ç»„ç»‡ï¼›å…·ä½“ä¸šåŠ¡åŠŸèƒ½è¯·å‚è§ä½ä»£ç åº”ç”¨ç³»ç»Ÿã€LLMç®¡ç†ç³»ç»Ÿå’Œç”¨æˆ·ç®¡ç†ä¸å®‰å…¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fb51b25b4eb4c7c85ea97fe9af1c036~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=3rs7b3CJuiBdUXXIQ8w9a2yvi4o%3D" alt="iShot_2026-01-04_15.59.29.png" loading="lazy"/></p>
<h2 data-id="heading-1">NestJSæ¨¡å—æ¶æ„æ¦‚è¿°</h2>
<p>åç«¯ä½¿ç”¨NestJSä½œä¸ºåº”ç”¨æ¡†æ¶ï¼Œå°†ä»£ç ç»„ç»‡æˆå°è£…ç›¸å…³åŠŸèƒ½çš„æ¨¡å—ã€‚æ¯ä¸ªæ¨¡å—éƒ½æ˜¯ä¸€ä¸ªç”¨<code>@Module()</code>è£…é¥°å™¨è£…é¥°çš„ç±»ï¼ŒåŒ…å«ä»¥ä¸‹å…ƒæ•°æ®ï¼š</p>
<ul>
<li>imports: è¯¥æ¨¡å—ä¾èµ–çš„å…¶ä»–æ¨¡å—</li>
<li>controllers: HTTPè¯·æ±‚å¤„ç†å™¨</li>
<li>providers: æœåŠ¡ã€ä»“åº“å’Œå…¶ä»–å¯æ³¨å…¥ç±»</li>
<li>exports: æä¾›ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨çš„æœåŠ¡/æä¾›è€…</li>
<li>æ ¹æ¨¡å—<code>AppModule</code>ä½äº<code>backend/src/app.module.ts</code></li>
</ul>
<p>åè°ƒæ‰€æœ‰åŠŸèƒ½æ¨¡å—å¹¶é…ç½®å…¨å±€åŸºç¡€è®¾æ–½ï¼Œå¦‚æ•°æ®åº“è¿æ¥ã€è°ƒåº¦å’Œå®ˆå«ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51cb68ba50c04fa4897a9942eab3ca6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=JLL%2FWIcvS1zUvUZ%2BfSeFegMm6UU%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">æ¨¡å—ç»„ç»‡ç»“æ„</h2>
<p>åç«¯ç»„ç»‡ä¸ºä¸¤ä¸ªä¸»è¦ç±»åˆ«ï¼š</p>
<h3 data-id="heading-3">æ ¸å¿ƒæ¨¡å—</h3>
<p>ä½äº<code>backend/src/core/</code>ï¼Œæä¾›åŸºç¡€å¹³å°æœåŠ¡ï¼š</p>























































<table><thead><tr><th>æ¨¡å—</th><th>ç›®çš„</th><th>å¯¼å‡º</th></tr></thead><tbody><tr><td><code>UserModule</code></td><td>ç”¨æˆ·ç®¡ç†å’Œè®¤è¯</td><td><code>UserService</code>,Â <code>OAuthService</code></td></tr><tr><td><code>RoleModule</code></td><td>è§’è‰²ç®¡ç†</td><td><code>RoleService</code></td></tr><tr><td><code>PermissionModule</code></td><td>æƒé™å®šä¹‰å’Œæ£€æŸ¥</td><td><code>PermissionService</code>,Â <code>TypeOrmModule</code></td></tr><tr><td><code>CacheModule</code></td><td>Redis/å†…å­˜ç¼“å­˜</td><td><code>CacheService</code></td></tr><tr><td><code>DictionaryModule</code></td><td>é…ç½®æ•°æ®ç®¡ç†</td><td><code>DictionaryService</code></td></tr><tr><td><code>SettingModule</code></td><td>ç³»ç»Ÿè®¾ç½®</td><td><code>SettingService</code></td></tr><tr><td><code>LLMModelModule</code></td><td>LLMæä¾›è€…é…ç½®</td><td><code>LLMModelService</code></td></tr><tr><td><code>OssModule</code></td><td>å¯¹è±¡å­˜å‚¨é›†æˆ</td><td><code>OssFactoryService</code></td></tr><tr><td><code>EmailVerificationModule</code></td><td>é‚®ç®±éªŒè¯æµç¨‹</td><td><code>EmailVerificationService</code></td></tr></tbody></table>
<h3 data-id="heading-4">ä¸šåŠ¡æ¨¡å—</h3>
<p>ä½äº<code>backend/src/business/</code>ï¼Œå®ç°ç‰¹å®šé¢†åŸŸåŠŸèƒ½ï¼š</p>























































<table><thead><tr><th>æ¨¡å—</th><th>ç›®çš„</th><th>å¯¼å‡º</th></tr></thead><tbody><tr><td><code>LowcodeAppModule</code></td><td>åº”ç”¨ç®¡ç†</td><td><code>AppService</code></td></tr><tr><td><code>TemplateModule</code></td><td>æ¨¡æ¿ç®¡ç†</td><td><code>TemplateService</code></td></tr><tr><td><code>DSLModule</code></td><td>DSLé…ç½®</td><td><code>DSLService</code></td></tr><tr><td><code>OrderModule</code></td><td>è®¢å•äº¤æ˜“</td><td><code>OrderService</code></td></tr><tr><td><code>ProductModule</code></td><td>äº§å“ç›®å½•</td><td><code>ProductService</code></td></tr><tr><td><code>ReportModule</code></td><td>åˆ†ææŠ¥å‘Š</td><td><code>ReportService</code></td></tr><tr><td><code>DailyModule</code></td><td>è¿è¥æŠ¥å‘Š</td><td><code>DailyService</code></td></tr><tr><td><code>AgentModule</code></td><td>AIä»£ç†æœåŠ¡</td><td><code>AgentService</code></td></tr><tr><td><code>OpenModule</code></td><td>å…¬å…±API</td><td>-</td></tr></tbody></table>
<h2 data-id="heading-5">æ ¹æ¨¡å—é…ç½®</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f58f7a7e034041d0ac13b301d265243c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=N0Onb%2FrKNXUKRThCuLYkVLAgNR0%3D" alt="d2086122-8b4b-418b-997e-2bbdcc66062a.png" loading="lazy"/></p>
<p>ä½äº<code>backend/src/app.module.ts</code>çš„AppModuleé…ç½®ï¼š</p>
<ul>
<li>ConfigModule: ä»<code>.env</code>æ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡ï¼Œå…·æœ‰å±‚æ¬¡ç»“æ„ï¼ˆ<code>.env.local</code>Â â†’Â <code>.env.${NODE_ENV}</code>Â â†’Â <code>.env</code>ï¼‰</li>
<li>TypeOrmModule: ä½¿ç”¨<code>ConfigService</code>å¼‚æ­¥é…ç½®MySQLè¿æ¥ï¼Œå¯ç”¨<code>autoLoadEntities</code>å’Œ<code>utf8mb4</code>å­—ç¬¦é›†</li>
<li>ScheduleModule: å¯ç”¨cronä½œä¸šè°ƒåº¦</li>
<li>å…¨å±€å®ˆå«: æ³¨å†Œ<code>UsersGuard</code>ä»¥åœ¨æ‰€æœ‰è·¯ç”±ä¸Šå¼ºåˆ¶æ‰§è¡Œæˆæƒ</li>
</ul>
<h2 data-id="heading-6">æ ‡å‡†æ¨¡å—ç»“æ„æ¨¡å¼</h2>
<p>æ¯ä¸ªåŠŸèƒ½æ¨¡å—éµå¾ªä¸€è‡´çš„ç»“æ„ï¼ŒåŒ…å«å››ä¸ªä¸»è¦ç»„ä»¶ï¼š</p>
<h3 data-id="heading-7">æ¨¡å—ç»“æ„å›¾</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79ba37054007490ab377f97c1ceb168b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=ZyjQg7aU36XIbuUgQTysJyzy7YM%3D" alt="ce5a40dc-23b2-4bd6-b5e0-eb2908ab0e89.png" loading="lazy"/></p>
<h3 data-id="heading-8">ç¤ºä¾‹ï¼šäº§å“æ¨¡å—</h3>
<p><code>ProductModule</code>å±•ç¤ºäº†æ­¤æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Module</span>({
  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">TypeOrmModule</span>.<span class="hljs-title function_">forFeature</span>([<span class="hljs-title class_">Product</span>]), <span class="hljs-title class_">OrderModule</span>],
  <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">ProductService</span>],
  <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">ProductController</span>],
  <span class="hljs-attr">exports</span>: [<span class="hljs-title class_">ProductService</span>]
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductModule</span> {}
</code></pre>
<p><strong>ç»„ä»¶ï¼š</strong></p>
<ul>
<li>å®ä½“:Â <code>Product</code>Â - TypeORMå®ä½“å®šä¹‰æ•°æ®åº“æ¨¡å¼</li>
<li>æœåŠ¡:Â <code>ProductService</code>Â - ä¸šåŠ¡é€»è¾‘å’Œä»“åº“æ“ä½œ</li>
<li>æ§åˆ¶å™¨:Â <code>ProductController</code>Â - REST APIç«¯ç‚¹</li>
<li>DTOs: ç”¨äºéªŒè¯çš„æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆåœ¨<code>product.dto.ts</code>ä¸­ï¼‰</li>
<li>æ¨¡å—:Â <code>ProductModule</code>Â - å°è£…å¹¶å¯¼å‡ºåŠŸèƒ½</li>
</ul>
<p>æ¨¡å—çš„æ¡¶å¼å¯¼å‡ºé‡æ–°å¯¼å‡ºæ‰€æœ‰å…¬å…±æ¥å£ã€‚</p>
<h2 data-id="heading-9">TypeORMé›†æˆæ¨¡å¼</h2>
<p>æ‰€æœ‰éœ€è¦æ•°æ®åº“è®¿é—®çš„æ¨¡å—éƒ½ä½¿ç”¨<code>TypeOrmModule.forFeature()</code>æ¨¡å¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70f6aeb812444ed8a8098c49d46cfe53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=BP0sbtF6fCbXRi%2BVpl9kjvqsHc4%3D" alt="89c6734a-0c30-466a-9a3e-42bf01e29a7f.png" loading="lazy"/></p>
<h3 data-id="heading-10">ç¤ºä¾‹ï¼šè®¢å•æ¨¡å—</h3>
<p><code>OrderModule</code>å±•ç¤ºäº†TypeORMé›†æˆï¼š</p>
<ul>
<li>å¯¼å…¥<code>TypeOrmModule.forFeature([OrderEntity])</code>ä»¥æ³¨å†Œå®ä½“</li>
<li>å°†<code>Repository&lt;OrderEntity&gt;</code>æ³¨å…¥åˆ°<code>OrderService</code></li>
<li>åŒæ—¶å¯¼å…¥<code>UserModule</code>ç”¨äºè·¨æ¨¡å—ä¾èµ–</li>
</ul>
<h3 data-id="heading-11">ç¤ºä¾‹ï¼šåŒ…å«å¤šä¸ªå®ä½“çš„åº”ç”¨æ¨¡å—</h3>
<p><code>LowcodeAppModule</code>å±•ç¤ºäº†ä¸€ä¸ªç®¡ç†å¤šä¸ªç›¸å…³å®ä½“çš„æ¨¡å—ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Module</span>({
  <span class="hljs-attr">imports</span>: [
    <span class="hljs-title class_">TypeOrmModule</span>.<span class="hljs-title function_">forFeature</span>([<span class="hljs-title class_">AppEntity</span>, <span class="hljs-title class_">AppVersionEntity</span>]),
    <span class="hljs-title class_">DSLModule</span>
  ],
  <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">AppController</span>],
  <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">AppService</span>],
  <span class="hljs-attr">exports</span>: [<span class="hljs-title class_">AppService</span>]
})
</code></pre>
<p>è¿™æ³¨å†Œäº†<code>AppEntity</code>å’Œ<code>AppVersionEntity</code>ï¼Œå…è®¸<code>AppService</code>ä¸ºä¸¤ä¸ªå®ä½“æ³¨å…¥ä»“åº“ã€‚</p>
<h2 data-id="heading-12">æ¨¡å—ä¾èµ–æ¨¡å¼</h2>
<h3 data-id="heading-13">ç›´æ¥æ¨¡å—ä¾èµ–</h3>
<p>æ¨¡å—é€šè¿‡importsæ•°ç»„å£°æ˜ä¾èµ–ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2798dd9ff20b4260bf4a686880a93a30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=i20EmHsf%2FjJ7rwPubwapV6910W4%3D" alt="78f0edf1-fc76-497b-abed-e086429ba3fc.png" loading="lazy"/></p>
<h3 data-id="heading-14">è·¨æ¨¡å—æœåŠ¡æ³¨å…¥</h3>
<p>å½“ä¸€ä¸ªæ¨¡å—å¯¼å‡ºä¸€ä¸ªæœåŠ¡æ—¶ï¼Œå…¶ä»–æ¨¡å—å¯ä»¥æ³¨å…¥å®ƒï¼š</p>








































<table><thead><tr><th>å¯¼å‡ºæ¨¡å—</th><th>å¯¼å‡ºçš„æœåŠ¡</th><th>æ¶ˆè´¹æ¨¡å—</th></tr></thead><tbody><tr><td><code>UserModule</code></td><td><code>UserService</code></td><td><code>OrderModule</code>,Â <code>RoleModule</code></td></tr><tr><td><code>RoleModule</code></td><td><code>RoleService</code></td><td><code>UserModule</code>,Â <code>PermissionModule</code></td></tr><tr><td><code>PermissionModule</code></td><td><code>PermissionService</code></td><td><code>RoleModule</code></td></tr><tr><td><code>DSLModule</code></td><td><code>DSLService</code></td><td><code>LowcodeAppModule</code>,Â <code>DailyModule</code></td></tr><tr><td><code>TemplateModule</code></td><td><code>TemplateService</code></td><td><code>DailyModule</code></td></tr><tr><td><code>ReportModule</code></td><td><code>ReportService</code></td><td><code>DailyModule</code></td></tr></tbody></table>
<h3 data-id="heading-15">å¾ªç¯ä¾èµ–è§£å†³</h3>
<p>å½“ä¸¤ä¸ªæ¨¡å—éœ€è¦å½¼æ­¤çš„æœåŠ¡æ—¶ï¼ŒNestJSæä¾›<code>forwardRef()</code>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af4bb5c0d6f744ab81f5b77a7256cc71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=vCy8pYPk8F3xTSOnsDeoyrOGIm8%3D" alt="12f35004-c6f4-4e6a-92f3-2894adb3f347.png" loading="lazy"/></p>
<p>æ¥è‡ª<code>backend/src/core/user/user.module.ts</code>çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-attr">imports</span>: [
  <span class="hljs-title class_">TypeOrmModule</span>.<span class="hljs-title function_">forFeature</span>([<span class="hljs-title class_">UserEntity</span>, <span class="hljs-title class_">UserOAuthEntity</span>]),
  <span class="hljs-title class_">SettingModule</span>,
  <span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">RoleModule</span>), <span class="hljs-comment">// å¾ªç¯ä¾èµ–è§£å†³</span>
  <span class="hljs-title class_">EmailVerificationModule</span>
];
</code></pre>
<p>æ¥è‡ª<code>backend/src/core/role/role.module.ts</code>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-attr">imports</span>: [
  <span class="hljs-title class_">TypeOrmModule</span>.<span class="hljs-title function_">forFeature</span>([<span class="hljs-title class_">RoleEntity</span>, <span class="hljs-title class_">PermissionEntity</span>]),
  <span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">PermissionModule</span>) <span class="hljs-comment">// å¾ªç¯ä¾èµ–è§£å†³</span>
];
</code></pre>
<h2 data-id="heading-16">å…¨å±€æ¨¡å—</h2>
<p><code>@Global()</code>è£…é¥°å™¨ä½¿æ¨¡å—çš„å¯¼å‡ºåœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å¯ç”¨ï¼Œæ— éœ€æ˜¾å¼å¯¼å…¥ï¼š</p>
<h3 data-id="heading-17">UserModuleä½œä¸ºå…¨å±€æ¨¡å—</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Global</span>()
<span class="hljs-meta">@Module</span>({
  <span class="hljs-attr">imports</span>: [
    <span class="hljs-title class_">TypeOrmModule</span>.<span class="hljs-title function_">forFeature</span>([<span class="hljs-title class_">UserEntity</span>, <span class="hljs-title class_">UserOAuthEntity</span>]),
    <span class="hljs-title class_">SettingModule</span>,
    <span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">RoleModule</span>),
    <span class="hljs-title class_">EmailVerificationModule</span>
  ],
  <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">UserController</span>, <span class="hljs-title class_">OAuthController</span>],
  <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">UserService</span>, <span class="hljs-title class_">OAuthService</span>, <span class="hljs-title class_">OAuthConfigService</span>, <span class="hljs-title class_">SettingService</span>],
  <span class="hljs-attr">exports</span>: [<span class="hljs-title class_">UserService</span>, <span class="hljs-title class_">OAuthService</span>]
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserModule</span> {}
</code></pre>
<p><code>UserModule</code>è¢«æ ‡è®°ä¸º<code>@Global()</code>ï¼Œä½¿<code>UserService</code>å’Œ<code>OAuthService</code>å¯¹æ‰€æœ‰æ¨¡å—å¯ç”¨ï¼Œæ— éœ€å¯¼å…¥<code>UserModule</code>ã€‚</p>
<p>ç†ç”±ï¼šç”¨æˆ·è®¤è¯åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­éƒ½éœ€è¦ï¼ˆå®ˆå«ã€è£…é¥°å™¨ã€ä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œå› æ­¤å°†å…¶è®¾ä¸ºå…¨å±€å¯å‡å°‘æ ·æ¿å¯¼å…¥ã€‚</p>
<h2 data-id="heading-18">å¤æ‚æ¨¡å—ä¾èµ–</h2>
<h3 data-id="heading-19">Dailyæ¨¡å—ï¼šèšåˆæ¨¡å¼</h3>
<p><code>DailyModule</code>å±•ç¤ºäº†ä¸€ä¸ªå¤æ‚çš„èšåˆæ¨¡å¼ï¼Œå¯¼å…¥å¤šä¸ªä¸šåŠ¡æ¨¡å—ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5eb1cea4a1e1491ab8e446ba6db2f125~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=riYeczBtTIgpD0iR2I%2Br6CjS1eE%3D" alt="6ed8d341-f4c5-4a14-83b1-abd278e8cba8.png" loading="lazy"/></p>
<p>å¯¼å…¥æ˜¾ç¤ºè·¨é¢†åŸŸä¾èµ–ï¼š</p>
<ul>
<li><code>AgentModule</code>ç”¨äºAIé©±åŠ¨çš„æŠ¥å‘Šç”Ÿæˆ</li>
<li><code>ReportModule</code>ç”¨äºåˆ†ææ•°æ®</li>
<li><code>TemplateModule</code>å’Œ<code>DSLModule</code>ç”¨äºä½ä»£ç ç»“æ„</li>
<li><code>LowcodeAppModule</code>ç”¨äºåº”ç”¨ç®¡ç†</li>
<li><code>OssFactoryService</code>ï¼ˆæ¥è‡ªå…¨å±€ä¸Šä¸‹æ–‡ï¼‰ç”¨äºæ–‡ä»¶å­˜å‚¨</li>
</ul>
<h2 data-id="heading-20">æ¨¡å—æ¡¶å¼å¯¼å‡º</h2>
<p>æ¯ä¸ªæ¨¡å—ç›®å½•åŒ…å«ä¸€ä¸ªindex.tsæ¡¶å¼æ–‡ä»¶ï¼Œé‡æ–°å¯¼å‡ºå…¬å…±æ¥å£ï¼š</p>
<h3 data-id="heading-21">ç¤ºä¾‹ï¼šåº”ç”¨æ¨¡å—æ¡¶å¼å¯¼å‡º</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.entity'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./app-version.entity'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.dto'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.service'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.controller'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.module'</span>;
</code></pre>
<p>æ­¤æ¨¡å¼å…è®¸æ¶ˆè´¹è€…ä»æ¨¡å—ç›®å½•å¯¼å…¥ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppEntity</span>, <span class="hljs-title class_">AppService</span>, <span class="hljs-title class_">AppModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./business/apps'</span>;
</code></pre>
<p>è€Œä¸æ˜¯å•ä¸ªæ–‡ä»¶è·¯å¾„ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppEntity</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./business/apps/app.entity'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./business/apps/app.service'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./business/apps/app.module'</span>;
</code></pre>
<h2 data-id="heading-22">æ¨¡å—ä¾èµ–å›¾</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/916e7fbe45014c7b8a20fc34bac20467~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Lip552A5Lik5p2h6Jmr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527801&amp;x-signature=7oTYAT2zyY80uB5Xl7p%2Fl1jNCBE%3D" alt="9b02cb3d-2dbb-4f2d-9119-2d5b21682cc5.png" loading="lazy"/></p>
<p>æ­¤å›¾æ˜¾ç¤ºæ¨¡å—ä¹‹é—´çš„ä¸»è¦ä¾èµ–å…³ç³»ã€‚æ³¨æ„ï¼š</p>
<ul>
<li><code>UserModule</code>æ˜¯å…¨å±€çš„ï¼Œå› æ­¤æœªæ˜¾ç¤ºæ‰€æœ‰æ¶ˆè´¹è€…çš„ä¾èµ–</li>
<li>å¾ªç¯ä¾èµ–é€šè¿‡<code>forwardRef()</code>è§£å†³</li>
<li><code>DailyModule</code>å…·æœ‰æœ€å¤šçš„ä¾èµ–ï¼Œèšåˆè·¨é¢†åŸŸçš„æ•°æ®</li>
<li>åŸºç¡€è®¾æ–½æ¨¡å—ï¼ˆConfigã€TypeORMã€Cacheï¼‰è¢«è®¸å¤šæ¨¡å—ä½¿ç”¨ä½†æœªæ˜¾å¼å¯¼å…¥ï¼ˆç”±æ ¹é…ç½®æä¾›ï¼‰</li>
</ul>
<h2 data-id="heading-23">æ€»ç»“</h2>
<p>VTJ.PROåç«¯éµå¾ªNestJSæœ€ä½³å®è·µï¼Œå…·æœ‰ï¼š</p>
<ol>
<li>æ¸…æ™°åˆ†ç¦»ï¼šæ ¸å¿ƒåŸºç¡€è®¾æ–½æ¨¡å—ä¸ä¸šåŠ¡é¢†åŸŸæ¨¡å—</li>
<li>ä¸€è‡´ç»“æ„ï¼šå®ä½“ â†’ æœåŠ¡ â†’ æ§åˆ¶å™¨ â†’ æ¨¡å—æ¨¡å¼</li>
<li>TypeORMé›†æˆï¼šç”¨äºå®ä½“æ³¨å†Œçš„<code>forFeature()</code>æ¨¡å¼</li>
<li>ä¾èµ–æ³¨å…¥ï¼šé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥æœåŠ¡ï¼Œé€šè¿‡<code>@InjectRepository()</code>æ³¨å…¥ä»“åº“</li>
<li>å¾ªç¯ä¾èµ–ï¼šåœ¨éœ€è¦æ—¶é€šè¿‡<code>forwardRef()</code>è§£å†³</li>
<li>å…¨å±€æ¨¡å—ï¼šUserModuleæ ‡è®°ä¸º<code>@Global()</code>ä»¥å®ç°å…¨å±€è®¿é—®</li>
<li>æ¡¶å¼å¯¼å‡ºï¼š<code>index.ts</code>æ–‡ä»¶ç®€åŒ–å¯¼å…¥</li>
<li>èšåˆæ¨¡å¼ï¼šé«˜çº§æ¨¡å—ï¼ˆå¦‚DailyModuleï¼‰ç»„åˆå¤šä¸ªé¢†åŸŸæœåŠ¡</li>
</ol>
<p>è¿™ç§æ¶æ„å®ç°äº†å¯ç»´æŠ¤æ€§ã€å¯æµ‹è¯•æ€§ä»¥åŠå¹³å°å¹¿æ³›åŠŸèƒ½é›†çš„æ¸…æ™°å…³æ³¨ç‚¹åˆ†ç¦»ã€‚</p>
<blockquote>
<p>æºç å¼€æºä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fnewgateway%2Fvtj" target="_blank" title="https://gitee.com/newgateway/vtj" ref="nofollow noopener noreferrer">gitee.com/newgateway/â€¦</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MySQL è¡¨çš„ç±» Git ç‰ˆæœ¬æ§åˆ¶]]></title>    <link>https://juejin.cn/post/7592893391572860954</link>    <guid>https://juejin.cn/post/7592893391572860954</guid>    <pubDate>2026-01-09T02:54:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592893391572860954" data-draft-id="7592552501578825754" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MySQL è¡¨çš„ç±» Git ç‰ˆæœ¬æ§åˆ¶"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-09T02:54:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·61743327310"/> <meta itemprop="url" content="https://juejin.cn/user/2358924657825099"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MySQL è¡¨çš„ç±» Git ç‰ˆæœ¬æ§åˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2358924657825099/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·61743327310
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:54:19.000Z" title="Fri Jan 09 2026 02:54:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<blockquote>
<p>ç”¨æˆ·è¦æ±‚è®°å½•excelè¡¨çš„ä¿®æ”¹è®°å½•ï¼Œå¹¶ä¸”å¯¹ä¸åŒç‰ˆæœ¬çš„excelè¿›è¡Œå¯¹æ¯”å±•ç¤º</p>
</blockquote>
<p>å¼€å‘ç¯å¢ƒï¼šJDK17 SpringBoot3</p>
<h2 data-id="heading-1">äºŒã€è§£å†³æ–¹æ¡ˆ</h2>
<blockquote>
<p>å°†excelè¡¨æ•°æ®å­˜å…¥æ•°æ®åº“ï¼Œå¯¹MySQL è¡¨å®ç°ç±» Git ç‰ˆæœ¬æ§åˆ¶</p>
</blockquote>
<h3 data-id="heading-2">æ ¸å¿ƒè®¾è®¡é€»è¾‘</h3>
<h4 data-id="heading-3">1. é€šç”¨é€‚é…</h4>
<p>æ”¯æŒä»»æ„ MySQL è¡¨çš„å¢é‡å¿«ç…§ï¼Œé€šè¿‡<strong>ä¸»é”®</strong>ä½œä¸ºå”¯ä¸€æ ‡è¯†å¯¹æ¯”æ•°æ®ï¼ˆéœ€ä¿è¯ä¸šåŠ¡è¡¨æœ‰ä¸»é”®ï¼‰ï¼›</p>
<h4 data-id="heading-4">2. ç‰ˆæœ¬é€»è¾‘</h4>
<ul>
<li>é¦–æ¬¡æäº¤ï¼šç”Ÿæˆ<strong>å…¨é‡åŸºçº¿å¿«ç…§</strong>ï¼ˆä½œä¸ºåç»­å¢é‡çš„åŸºå‡†ï¼‰</li>
<li>éé¦–æ¬¡æäº¤ï¼šå¯¹æ¯”å½“å‰è¡¨ä¸<strong>ä¸Šä¸€ç‰ˆæœ¬åˆå¹¶åçš„æ•°æ®</strong>ï¼Œæå–å¢é‡å˜æ›´é›†ï¼›</li>
<li>å›æ»šé€»è¾‘ï¼šåŸºäºåŸºçº¿+å¢é‡å˜æ›´é›†é€†å‘è®¡ç®—ï¼Œæ¢å¤åˆ°ç›®æ ‡ç‰ˆæœ¬ï¼›</li>
</ul>
<h4 data-id="heading-5">3. é˜²é£é™©</h4>
<p>å…¨ç¨‹äº‹åŠ¡æ§åˆ¶ï¼ŒSQLé˜²æ³¨å…¥ï¼Œé”è¡¨é¿å…å‘ç”Ÿå˜æ›´ï¼Œå›æ»šå‰è‡ªåŠ¨å¤‡ä»½</p>
<h2 data-id="heading-6">ä¸‰ã€ä»£ç å®ç°</h2>
<h3 data-id="heading-7">1. æ•°æ®åº“è¡¨è®¾è®¡</h3>
<h4 data-id="heading-8">1.1. å…¨å±€ç‰ˆæœ¬è®°å½•è¡¨ï¼ˆå­˜å‚¨å¢é‡å¿«ç…§æ ¸å¿ƒä¿¡æ¯ï¼‰</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `dg_table_version` (
  `id` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">'å…¨å±€ç‰ˆæœ¬ID'</span>,
  `table_name` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'ä¸šåŠ¡è¡¨åï¼ˆå¦‚productï¼‰'</span>,
  `table_version_num` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è¯¥è¡¨çš„ç‰ˆæœ¬å·ï¼ˆè‡ªå¢ï¼š1ã€2ã€3...ï¼‰'</span>,
  `snapshot_type` <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å¿«ç…§ç±»å‹ï¼šFULLï¼ˆåŸºçº¿ï¼‰/INCREMENTï¼ˆå¢é‡ï¼‰'</span>,
  `snapshot_content` longtext <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å¿«ç…§å†…å®¹ï¼šFULL=å…¨é‡JSONï¼›INCREMENT=å¢é‡å˜æ›´é›†JSON'</span>,
  `table_structure_hash` <span class="hljs-type">char</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è¡¨ç»“æ„MD5å“ˆå¸Œï¼ˆé˜²ç»“æ„å˜æ›´ï¼‰'</span>,
  `operator` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æ“ä½œäºº'</span>,
  `operate_time` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æäº¤æ—¶é—´'</span>,
  `version_desc` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'ç‰ˆæœ¬è¯´æ˜'</span>,
  `create_time` datetime <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `create_user` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `last_update_time` datetime <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `last_update_user` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
  <span class="hljs-keyword">UNIQUE</span> KEY `dg_table_version_table_name_IDX` (`table_name`, `table_version_num`)
)<span class="hljs-keyword">DEFAULT</span> CHARSET <span class="hljs-operator">=</span> utf8mb4 ROW_FORMAT <span class="hljs-operator">=</span> <span class="hljs-keyword">DYNAMIC</span> COMMENT<span class="hljs-operator">=</span><span class="hljs-string">'å…¨å±€è¡¨ç‰ˆæœ¬è®°å½•è¡¨'</span>;
</code></pre>
<h4 data-id="heading-9">1.2. è¡¨ç»“æ„ç‰ˆæœ¬è¡¨ï¼ˆå¯é€‰ï¼Œç®¡æ§è¡¨ç»“æ„å˜æ›´ï¼‰</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `dg_table_structure_version` (
  `id` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,
  `table_name` <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'ä¸šåŠ¡è¡¨å'</span>,
  `structure_sql` longtext <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å»ºè¡¨/æ”¹è¡¨SQL'</span>,
  `structure_hash` <span class="hljs-type">varchar</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è¡¨ç»“æ„MD5å“ˆå¸Œ'</span>,
  `operator` <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æ“ä½œäºº'</span>,
  `operate_time` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="hljs-string">'è®°å½•æ—¶é—´'</span>,
  `create_time` datetime <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `create_user` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `last_update_time` datetime <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  `last_update_user` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
  <span class="hljs-keyword">UNIQUE</span> KEY `uk_table_hash` (`table_name`, `structure_hash`) COMMENT <span class="hljs-string">'è¡¨+ç»“æ„å“ˆå¸Œå”¯ä¸€'</span>
) <span class="hljs-keyword">DEFAULT</span> CHARSET <span class="hljs-operator">=</span> utf8mb4 ROW_FORMAT <span class="hljs-operator">=</span> <span class="hljs-keyword">DYNAMIC</span> COMMENT <span class="hljs-operator">=</span> <span class="hljs-string">'è¡¨ç»“æ„ç‰ˆæœ¬è¡¨'</span>;
</code></pre>
<h3 data-id="heading-10">2. æ ¸å¿ƒæ¦‚å¿µä¸å®ä½“å®šä¹‰</h3>
<h4 data-id="heading-11">2.1 æšä¸¾ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Getter;

<span class="hljs-comment">/**
 * å¿«ç…§ç±»å‹æšä¸¾
 */</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">SnapshotType</span> {
    FULL(<span class="hljs-string">"å…¨é‡åŸºçº¿"</span>),
    INCREMENT(<span class="hljs-string">"å¢é‡å˜æ›´"</span>);
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String desc;

    SnapshotType(String desc) {
        <span class="hljs-built_in">this</span>.desc = desc;
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Getter;

<span class="hljs-comment">/**
 * æ•°æ®å˜æ›´ç±»å‹æšä¸¾
 */</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ChangeType</span> {
    ADD(<span class="hljs-string">"æ–°å¢"</span>),
    UPDATE(<span class="hljs-string">"ä¿®æ”¹"</span>),
    DELETE(<span class="hljs-string">"åˆ é™¤"</span>);

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String desc;

    ChangeType(String desc) {
        <span class="hljs-built_in">this</span>.desc = desc;
    }
}
</code></pre>
<h4 data-id="heading-12">2.2 å¢é‡å˜æ›´é›†å®ä½“ï¼ˆåºåˆ—åŒ–æ ¸å¿ƒï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> lombok.NoArgsConstructor;

<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-comment">/**
 * å•æ¡è®°å½•çš„å˜æ›´ä¿¡æ¯ï¼ˆä¿®æ”¹æ“ä½œéœ€å­˜å‚¨æ—§å€¼+æ–°å€¼ï¼‰
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecordChange</span> {
    <span class="hljs-comment">/** å˜æ›´ç±»å‹ï¼šADD/UPDATE/DELETE */</span>
    <span class="hljs-keyword">private</span> String changeType;
    <span class="hljs-comment">/** è®°å½•ä¸»é”®å€¼ï¼ˆé€šç”¨åŒ–ï¼Œé€‚é…ä¸åŒè¡¨çš„ä¸»é”®ï¼‰ */</span>
    <span class="hljs-keyword">private</span> Object primaryKey;
    <span class="hljs-comment">/** æ–°å¢/ä¿®æ”¹åçš„æ–°å€¼ï¼ˆDELETEæ—¶ä¸ºnullï¼‰ */</span>
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; newData;
    <span class="hljs-comment">/** ä¿®æ”¹/åˆ é™¤å‰çš„æ—§å€¼ï¼ˆADDæ—¶ä¸ºnullï¼‰ */</span>
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; oldData;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> lombok.NoArgsConstructor;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * æ•´å¼ è¡¨çš„å¢é‡å˜æ›´é›†ï¼ˆåºåˆ—åŒ–åå­˜å…¥snapshot_contentï¼‰
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IncrementSnapshot</span> {
    <span class="hljs-comment">/** å˜æ›´è®°å½•åˆ—è¡¨ */</span>
    <span class="hljs-keyword">private</span> List&lt;RecordChange&gt; recordChanges;
    <span class="hljs-comment">/** ä¸Šä¸€ç‰ˆæœ¬å·ï¼ˆç”¨äºå›æ»šæ—¶è¿½æº¯ï¼‰ */</span>
    <span class="hljs-keyword">private</span> Integer lastVersionNum;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> lombok.NoArgsConstructor;

<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-comment">/**
 * å…¨é‡åŸºçº¿å¿«ç…§ï¼ˆé¦–æ¬¡æäº¤ç”¨ï¼‰
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FullSnapshot</span> {
    <span class="hljs-comment">/** å…¨é‡è¡¨æ•°æ®ï¼ˆä¸»é”®â†’æ•´æ¡è®°å½•çš„Mapï¼‰ */</span>
    <span class="hljs-keyword">private</span> Map&lt;String, Map&lt;String, Object&gt;&gt; fullData;
}
</code></pre>
<h4 data-id="heading-13">2.3 æ•°æ®åº“å®ä½“ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonFormat;

<span class="hljs-keyword">import</span> java.util.Date;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@author</span>: ZhongXS02
 * <span class="hljs-doctag">@date</span>: 2025-12-31
 **/</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DgTableVersion</span> {
    <span class="hljs-keyword">private</span> Integer id;
    
    <span class="hljs-keyword">private</span> String tableName;
    <span class="hljs-keyword">private</span> Integer tableVersionNum;
    <span class="hljs-keyword">private</span> String snapshotType;
    <span class="hljs-keyword">private</span> String snapshotContent;
    <span class="hljs-keyword">private</span> String tableStructureHash;
    <span class="hljs-keyword">private</span> String operator;
    <span class="hljs-keyword">private</span> Date operateTime;
    <span class="hljs-keyword">private</span> String versionDesc;
    
    <span class="hljs-meta">@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd HH:mm:ss", timezone = "GMT+8")</span>
    <span class="hljs-meta">@Schema(name = "åˆ›å»ºæ—¶é—´")</span>
    <span class="hljs-keyword">private</span> Date createTime;

    <span class="hljs-meta">@Schema(name = "åˆ›å»ºç”¨æˆ·")</span>
    <span class="hljs-keyword">private</span> String createUser;

    <span class="hljs-meta">@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd HH:mm:ss", timezone = "GMT+8")</span>
    <span class="hljs-meta">@Schema(name = "æœ€åæ›´æ–°æ—¶é—´")</span>
    <span class="hljs-keyword">private</span> Date lastUpdateTime;

    <span class="hljs-meta">@Schema(name = "æœ€åæ›´æ–°ç”¨æˆ·")</span>
    <span class="hljs-keyword">private</span> String lastUpdateUser;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-keyword">import</span> java.util.Date;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@author</span>: ZhongXS02
 * <span class="hljs-doctag">@date</span>: 2025-12-31
 **/</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DgTableStructureVersion</span> {
    <span class="hljs-keyword">private</span> Integer id;
    <span class="hljs-keyword">private</span> String tableName;
    <span class="hljs-keyword">private</span> String structureSql;
    <span class="hljs-keyword">private</span> String structureHash;
    <span class="hljs-keyword">private</span> String operator;
    <span class="hljs-keyword">private</span> Date operateTime;
    
    <span class="hljs-meta">@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd HH:mm:ss", timezone = "GMT+8")</span>
    <span class="hljs-meta">@Schema(name = "åˆ›å»ºæ—¶é—´")</span>
    <span class="hljs-keyword">private</span> Date createTime;

    <span class="hljs-meta">@Schema(name = "åˆ›å»ºç”¨æˆ·")</span>
    <span class="hljs-keyword">private</span> String createUser;

    <span class="hljs-meta">@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd HH:mm:ss", timezone = "GMT+8")</span>
    <span class="hljs-meta">@Schema(name = "æœ€åæ›´æ–°æ—¶é—´")</span>
    <span class="hljs-keyword">private</span> Date lastUpdateTime;

    <span class="hljs-meta">@Schema(name = "æœ€åæ›´æ–°ç”¨æˆ·")</span>
    <span class="hljs-keyword">private</span> String lastUpdateUser;
}
</code></pre>
<h3 data-id="heading-14">3. æ ¸å¿ƒå·¥å…·ç±»</h3>
<h4 data-id="heading-15">3.1 JSON åºåˆ—åŒ–å·¥å…·ï¼ˆé€šç”¨é€‚é…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.core.type.TypeReference;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.DeserializationFeature;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.datatype.jsr310.JavaTimeModule;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> org.springframework.util.StringUtils;

<span class="hljs-comment">/**
 * JSON åºåˆ—åŒ–å·¥å…·
 * <span class="hljs-doctag">@author</span>: ZhongXS02
 * <span class="hljs-doctag">@date</span>: 2025-12-31
 **/</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonUtil</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ObjectMapper objectMapper;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">JsonUtil</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.objectMapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();
        <span class="hljs-comment">// é€‚é…LocalDateã€Mapç­‰ç±»å‹åºåˆ—åŒ–</span>
        objectMapper.registerModule(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JavaTimeModule</span>());
        <span class="hljs-comment">// ç©º Bean åºåˆ—åŒ–æ—¶ä¸æŠ¥é”™</span>
        objectMapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS,<span class="hljs-literal">false</span>);
        <span class="hljs-comment">// ååºåˆ—åŒ–æ—¶å¿½ç•¥æœªçŸ¥å±æ€§ï¼ˆJSON æœ‰ä½† Java ç±»æ²¡æœ‰çš„å­—æ®µï¼‰</span>
        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, <span class="hljs-literal">false</span>);
    }

    <span class="hljs-comment">/**
     * å¯¹è±¡è½¬å­—ç¬¦ä¸²
     * <span class="hljs-doctag">@param</span> object
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toJson</span><span class="hljs-params">(Object object)</span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> objectMapper.writeValueAsString(object);
        } <span class="hljs-keyword">catch</span> (JsonProcessingException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"JSONåºåˆ—åŒ–å¤±è´¥"</span>,e);
        }
    }

    <span class="hljs-comment">/**
     * JSONå­—ç¬¦ä¸²è½¬å¯¹è±¡
     * <span class="hljs-doctag">@param</span> json
     * <span class="hljs-doctag">@param</span> clazz
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@param</span> &lt;T&gt;
     */</span>
    <span class="hljs-keyword">public</span> &lt;T&gt; T <span class="hljs-title function_">fromJson</span><span class="hljs-params">(String json, Class&lt;T&gt; clazz)</span>{
        <span class="hljs-keyword">if</span>(!StringUtils.hasLength(json)){
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> objectMapper.readValue(json, clazz);
        } <span class="hljs-keyword">catch</span> (JsonProcessingException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"JSONååºåˆ—åŒ–å¤±è´¥"</span>,e);
        }
    }

    <span class="hljs-comment">/**
     * JSONå­—ç¬¦ä¸²è½¬å¤æ‚å¯¹è±¡
     * <span class="hljs-doctag">@param</span> json
     * <span class="hljs-doctag">@param</span> typeReference
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@param</span> &lt;T&gt;
     */</span>
    <span class="hljs-keyword">public</span> &lt;T&gt; T <span class="hljs-title function_">fromJson</span><span class="hljs-params">(String json, TypeReference&lt;T&gt; typeReference)</span>{
        <span class="hljs-keyword">if</span>(!StringUtils.hasLength(json)){
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> objectMapper.readValue(json,typeReference);
        } <span class="hljs-keyword">catch</span> (JsonProcessingException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"JSONååºåˆ—åŒ–å¤æ‚ç±»å‹å¤±è´¥"</span>,e);
        }
    }
}
</code></pre>
<h4 data-id="heading-16">3.2 è¡¨ç»“æ„å·¥å…·ç±»ï¼ˆå“ˆå¸Œå€¼è®¡ç®—ï¼Œä¸»é”®è·å–ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.commons.codec.digest.DigestUtils;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> org.springframework.util.CollectionUtils;

<span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-comment">/**
 * è¡¨ç»“æ„å·¥å…·ç±» ï¼ˆå“ˆå¸Œå€¼è®¡ç®—ï¼Œä¸»é”®è·å–ï¼‰
 * <span class="hljs-doctag">@author</span>: ZhongXS02
 * <span class="hljs-doctag">@date</span>: 2025-12-31
 **/</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TableStructureUtil</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> JdbcTemplate jdbcTemplate;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> JsonUtil jsonUtil;

    <span class="hljs-comment">/**
     * è·å–è¡¨çš„ä¸»é”®å­—æ®µå
     * <span class="hljs-doctag">@param</span> tableName
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPrimaryKeyName</span><span class="hljs-params">(String tableName)</span>{
        <span class="hljs-comment">// æ£€éªŒè¡¨å é˜²æ­¢SQLæ³¨å…¥</span>
        <span class="hljs-keyword">if</span>(!validateTableName(tableName)){
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IpsException</span>(<span class="hljs-string">"è¡¨åéæ³•"</span>+tableName);
        }
        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE "</span> +
                <span class="hljs-string">"WHERE TABLE_SCHEMA = (SELECT DATABASE()) AND TABLE_NAME = ? AND CONSTRAINT_NAME = 'PRIMARY'"</span>;
        List&lt;String&gt; pkList = jdbcTemplate.queryForList(sql, String.class, tableName);
        <span class="hljs-keyword">if</span> (CollectionUtils.isEmpty(pkList)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è¡¨["</span> + tableName + <span class="hljs-string">"]æ— ä¸»é”®ï¼Œä¸æ”¯æŒå¢é‡å¿«ç…§"</span>);
        }
        <span class="hljs-comment">// ä»…æ”¯æŒå•ä¸»é”®ï¼ˆå¤šä¸»é”®éœ€æ‰©å±•ï¼‰</span>
        <span class="hljs-keyword">return</span> pkList.get(<span class="hljs-number">0</span>);
    }

    <span class="hljs-comment">/**
     * è®¡ç®—è¡¨ç»“æ„çš„MD5å“ˆå¸Œå€¼
     * <span class="hljs-doctag">@param</span> tableName
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">calculateTableStructureHash</span><span class="hljs-params">(String tableName)</span>{
        <span class="hljs-keyword">if</span> (!validateTableName(tableName)){
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IpsException</span>(<span class="hljs-string">"è¡¨åéæ³•"</span>+tableName);
        }
        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SHOW CREATE TABLE "</span> + tableName;
        Map&lt;String, Object&gt; result = jdbcTemplate.queryForMap(sql);
        <span class="hljs-type">String</span> <span class="hljs-variable">createTableSql</span> <span class="hljs-operator">=</span> (String) result.get(<span class="hljs-string">"Create Table"</span>);
        <span class="hljs-keyword">return</span> DigestUtils.md5Hex(createTableSql.getBytes(StandardCharsets.UTF_8));
    }

    <span class="hljs-comment">/**
     * æ£€éªŒè¡¨ååˆæ³•æ€§
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateTableName</span><span class="hljs-params">(String tableName)</span>{
        <span class="hljs-keyword">return</span> tableName.matches(<span class="hljs-string">"^[a-zA-Z0-9_]+$"</span>);
    }

    <span class="hljs-comment">/**
     * æŸ¥è¯¢æ•´å¼ è¡¨æ•°æ®ï¼Œè¿”å›ã€Œä¸»é”®â†’æ•´æ¡è®°å½•ã€çš„Map
     */</span>
    <span class="hljs-keyword">public</span> Map&lt;String, Map&lt;String, Object&gt;&gt; <span class="hljs-title function_">queryTableData</span><span class="hljs-params">(String tableName)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">pkName</span> <span class="hljs-operator">=</span> getPrimaryKeyName(tableName);
        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT * FROM "</span> + tableName;
        List&lt;Map&lt;String, Object&gt;&gt; dataList = jdbcTemplate.queryForList(sql);
        <span class="hljs-comment">// è½¬æ¢ä¸ºä¸»é”®â†’è®°å½•çš„Map</span>
        Map&lt;String, Map&lt;String, Object&gt;&gt; dataMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (Map&lt;String, Object&gt; row : dataList) {
            <span class="hljs-type">Object</span> <span class="hljs-variable">pkValue</span> <span class="hljs-operator">=</span> row.get(pkName);
            dataMap.put(pkValue.toString(), row);
        }
        <span class="hljs-keyword">return</span> dataMap;
    }

}
</code></pre>
<h4 data-id="heading-17">3.3 å¢é‡å˜æ›´å¯¹æ¯”å·¥å…·ç±»ï¼ˆæ ¸å¿ƒï¼šæå–å¢åˆ æ”¹ï¼‰</h4>
<pre><code class="hljs language-scss" lang="scss">import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.stereotype</span><span class="hljs-selector-class">.Component</span>;

import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.ArrayList</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.List</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Map</span>;

<span class="hljs-comment">/**
 * å¢é‡å˜æ›´å¯¹æ¯”å·¥å…·ç±»
 * @author: ZhongXS02
 * @date: 2025-12-31
 **/</span>
<span class="hljs-keyword">@Component</span>
public class IncrementCompareUtil {

    <span class="hljs-keyword">@Autowired</span>
    private TableStructureUtil tableStructureUtil;

    public IncrementSnapshot <span class="hljs-built_in">compare</span>(Map&lt;String, Map&lt;String,Object&gt;&gt; oldData,
                                        Map&lt;String, Map&lt;String,Object&gt;&gt; newData,
                                        String tableName,
                                        Integer lastVersionNum){
        List&lt;RecordChange&gt; recordChanges=new ArrayList&lt;&gt;();
        String pkName=tableStructureUtil<span class="hljs-selector-class">.getPrimaryKeyName</span>(tableName);

        <span class="hljs-comment">// 1. æ–°å¢ï¼šnewDataæœ‰ï¼ŒoldDataæ²¡æœ‰</span>
        <span class="hljs-built_in">for</span>(Map.Entry&lt;String,Map&lt;String,Object&gt;&gt; entry:newData.entrySet()){
            String pkValue=entry<span class="hljs-selector-class">.getKey</span>();
            <span class="hljs-built_in">if</span>(!oldData.containsKey(pkValue)){
                RecordChange change=new <span class="hljs-built_in">RecordChange</span>();
                change<span class="hljs-selector-class">.setChangeType</span>("ADD");
                change<span class="hljs-selector-class">.setPrimaryKey</span>(pkValue);
                change<span class="hljs-selector-class">.setNewData</span>(entry.getValue());
                change<span class="hljs-selector-class">.setOldData</span>(null);
                recordChanges<span class="hljs-selector-class">.add</span>(change);
            }
        }

        <span class="hljs-comment">// 2. åˆ é™¤ï¼š oldDataæœ‰ï¼ŒnewDataæ— </span>
        <span class="hljs-built_in">for</span>(Map.Entry&lt;String,Map&lt;String,Object&gt;&gt; entry:oldData.entrySet()){
            String pkValue=entry<span class="hljs-selector-class">.getKey</span>();
            <span class="hljs-built_in">if</span>(!newData.containsKey(pkValue)){
                RecordChange change=new <span class="hljs-built_in">RecordChange</span>();
                change<span class="hljs-selector-class">.setChangeType</span>("DELETE");
                change<span class="hljs-selector-class">.setPrimaryKey</span>(pkValue);
                change<span class="hljs-selector-class">.setNewData</span>(null);
                change<span class="hljs-selector-class">.setOldData</span>(entry.getValue());
                recordChanges<span class="hljs-selector-class">.add</span>(change);
            }
        }

        <span class="hljs-comment">// 3. ä¿®æ”¹ï¼š ä¸»é”®éƒ½æœ‰ï¼Œå†…å®¹ä¸åŒ</span>
        <span class="hljs-built_in">for</span>(Map.Entry&lt;String,Map&lt;String,Object&gt;&gt; entry:oldData.entrySet()){
            String pkValue=entry<span class="hljs-selector-class">.getKey</span>();
            <span class="hljs-built_in">if</span>(newData.containsKey(pkValue)){
                Map&lt;String,<span class="hljs-selector-tag">Object</span>&gt; oldRow=entry<span class="hljs-selector-class">.getValue</span>();
                Map&lt;String,<span class="hljs-selector-tag">Object</span>&gt; newRow=newData<span class="hljs-selector-class">.get</span>(pkValue);
                <span class="hljs-built_in">if</span>(!oldRow.equals(newRow)){
                    RecordChange change=new <span class="hljs-built_in">RecordChange</span>();
                    change<span class="hljs-selector-class">.setChangeType</span>("UPDATE");
                    change<span class="hljs-selector-class">.setPrimaryKey</span>(pkValue);
                    change<span class="hljs-selector-class">.setNewData</span>(newRow);
                    change<span class="hljs-selector-class">.setOldData</span>(oldRow);
                    recordChanges<span class="hljs-selector-class">.add</span>(change);
                }
            }
        }

        return new <span class="hljs-built_in">IncrementSnapshot</span>(recordChanges, lastVersionNum);
    }
}
</code></pre>
<h3 data-id="heading-18">4. Mapper å±‚</h3>
<h4 data-id="heading-19">4.1 TableVersionMapper</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Mapper</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DgTableVersionMapper</span> {

    <span class="hljs-comment">/**
     * æŸ¥è¯¢æŒ‡å®šè¡¨çš„æœ€æ–°ç‰ˆæœ¬å·
     * <span class="hljs-doctag">@param</span> tableName
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-meta">@Select("SELECT IFNULL(MAX(table_version_num), 0) FROM dg_table_version WHERE table_name = #{tableName}")</span>
    Integer <span class="hljs-title function_">selectMaxVersionNum</span><span class="hljs-params">(<span class="hljs-meta">@Param("tableName")</span> String tableName)</span>;

    <span class="hljs-comment">/**
     * æŸ¥è¯¢æŒ‡å®šè¡¨ + ç‰ˆæœ¬å·çš„è®°å½•
     * <span class="hljs-doctag">@param</span> tableName
     * <span class="hljs-doctag">@param</span> versionNum
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-meta">@Select("SELECT * FROM dg_table_version WHERE table_name = #{tableName} AND table_version_num = #{versionNum}")</span>
    DgTableVersion <span class="hljs-title function_">selectByTableAndVersion</span><span class="hljs-params">(<span class="hljs-meta">@Param("tableName")</span> String tableName, <span class="hljs-meta">@Param("versionNum")</span> Integer versionNum)</span>;

    <span class="hljs-comment">/**
     * æŸ¥è¯¢æŒ‡å®šè¡¨çš„æ‰€æœ‰ç‰ˆæœ¬ ï¼ˆæŒ‰ç‰ˆæœ¬å·å‡åºï¼‰
     * <span class="hljs-doctag">@param</span> tableName
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-meta">@Select("SELECT * FROM dg_table_version WHERE table_name = #{tableName} ORDER BY table_version_num ASC")</span>
    List&lt;DgTableVersion&gt; <span class="hljs-title function_">selectAllByTableName</span><span class="hljs-params">(<span class="hljs-meta">@Param("tableName")</span> String tableName)</span>;

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-meta">@Param("tableVersion")</span> DgTableVersion tableVersion)</span>;
}
</code></pre>
<h4 data-id="heading-20">4.2 TableStructureVersionMapper</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Mapper</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DgTableStructureVersionMapper</span> {

    <span class="hljs-comment">/**
     * æŸ¥è¯¢æŒ‡å®šè¡¨+å“ˆå¸Œçš„ç»“æ„è®°å½•
     */</span>
    <span class="hljs-meta">@Select("SELECT * FROM dg_table_structure_version WHERE table_name = #{tableName} AND structure_hash = #{hash}")</span>
    DgTableStructureVersion <span class="hljs-title function_">selectByTableAndHash</span><span class="hljs-params">(<span class="hljs-meta">@Param("tableName")</span> String tableName, <span class="hljs-meta">@Param("hash")</span> String hash)</span>;

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-meta">@Param("newStruct")</span> DgTableStructureVersion newStruct)</span>;

}
</code></pre>
<h3 data-id="heading-21">5. æ ¸å¿ƒä¸šåŠ¡å±‚å®ç°</h3>
<h4 data-id="heading-22">5.1 è¡¨ç‰ˆæœ¬æœåŠ¡æ¥å£</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">public</span> interface DgTableVersionService {

    <span class="hljs-comment">/**
     * æäº¤è¡¨ç‰ˆæœ¬ï¼ˆè‡ªåŠ¨åˆ¤æ–­ï¼šé¦–æ¬¡=å…¨é‡åŸºçº¿ï¼Œéé¦–æ¬¡=å¢é‡å¿«ç…§ï¼‰
     */</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">commitVersion</span><span class="hljs-params">(<span class="hljs-type">String</span> tableName, <span class="hljs-type">String</span> versionDesc, <span class="hljs-type">String</span> <span class="hljs-keyword">operator</span>)</span></span>;

    <span class="hljs-comment">/**
     * å›æ»šæ•´å¼ è¡¨åˆ°æŒ‡å®šç‰ˆæœ¬
     */</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rollbackToVersion</span><span class="hljs-params">(<span class="hljs-type">String</span> tableName, Integer targetVersion, <span class="hljs-type">String</span> <span class="hljs-keyword">operator</span>)</span></span>;

    <span class="hljs-comment">/**
     * å¯¹æ¯”ä¸¤ä¸ªç‰ˆæœ¬çš„å·®å¼‚
     */</span>
    <span class="hljs-function"><span class="hljs-type">String</span> <span class="hljs-title">compareVersion</span><span class="hljs-params">(<span class="hljs-type">String</span> tableName, Integer v1, Integer v2)</span></span>;

    <span class="hljs-comment">/**
     * æŸ¥è¯¢æŒ‡å®šè¡¨çš„æ‰€æœ‰ç‰ˆæœ¬è®°å½•
     */</span>
    <span class="hljs-function">List&lt;DgTableVersion&gt; <span class="hljs-title">listTableVersion</span><span class="hljs-params">(<span class="hljs-type">String</span> tableName)</span></span>;
}
</code></pre>
<h4 data-id="heading-23">5.2 è¡¨ç‰ˆæœ¬æœåŠ¡å®ç°ç±»ï¼ˆæ ¸å¿ƒï¼‰</h4>
<pre><code class="hljs language-scss" lang="scss">import lombok<span class="hljs-selector-class">.RequiredArgsConstructor</span>;
import lombok<span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.BatchPreparedStatementSetter</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.JdbcTemplate</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.stereotype</span><span class="hljs-selector-class">.Service</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.transaction</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Transactional</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.CollectionUtils</span>;

import java<span class="hljs-selector-class">.sql</span><span class="hljs-selector-class">.PreparedStatement</span>;
import java<span class="hljs-selector-class">.sql</span><span class="hljs-selector-class">.SQLException</span>;
import java<span class="hljs-selector-class">.util</span>.*;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">/**
 * @author: ZhongXS02
 * @date: 2026-01-05
 **/</span>
<span class="hljs-keyword">@Service</span>
<span class="hljs-keyword">@RequiredArgsConstructor</span>
<span class="hljs-keyword">@Transactional</span>
<span class="hljs-keyword">@Slf</span>4j
public class DgTableVersionServiceImpl implements DgTableVersionService {
    <span class="hljs-keyword">@Autowired</span>
    private final DgTableVersionMapper tableVersionMapper;
    private final DgTableStructureVersionMapper tableStructureVersionMapper;
    private final TableStructureUtil tableStructureUtil;
    private final IncrementCompareUtil incrementCompareUtil;
    private final JsonUtil jsonUtil;
    private final JdbcTemplate jdbcTemplate;

    <span class="hljs-keyword">@Transactional</span>
    <span class="hljs-keyword">@Override</span>
    public void commitVersion(String tableName, String versionDesc, String operator) {

        <span class="hljs-comment">// 1. å‰ç½®æ ¡éªŒï¼šè¡¨ååˆæ³•æ€§ã€è¡¨ç»“æ„å˜æ›´æ£€æŸ¥</span>
        String currentStructHash = tableStructureUtil<span class="hljs-selector-class">.calculateTableStructureHash</span>(tableName);
        <span class="hljs-built_in">checkTableStructure</span>(tableName, currentStructHash, operator);

        <span class="hljs-comment">// 2. è·å–æœ€æ–°ç‰ˆæœ¬å·ï¼Œè®¡ç®—æ–°ç‰ˆæœ¬å·</span>
        Integer lastVersionNumber = tableVersionMapper<span class="hljs-selector-class">.selectMaxVersionNum</span>(tableName);
        Integer newVersionNumber = lastVersionNumber + <span class="hljs-number">1</span>;

        <span class="hljs-comment">// 3. é”è¡¨ï¼šé¿å…æäº¤ç‰ˆæœ¬æœŸé—´æ•°æ®è¢«ä¿®æ”¹ï¼ˆMySQLè¡¨é”ï¼Œéœ€è°¨æ…ä½¿ç”¨ï¼Œå°å¹¶å‘åœºæ™¯ï¼‰</span>
        <span class="hljs-built_in">lockTable</span>(tableName);

        try{
            <span class="hljs-comment">// 4. åŒºåˆ†é¦–æ¬¡æäº¤ï¼ˆå…¨é‡ï¼‰å’Œéé¦–æ¬¡æäº¤ï¼ˆå¢é‡ï¼‰</span>
            DgTableVersion tableVersion= new <span class="hljs-built_in">DgTableVersion</span>();
            tableVersion<span class="hljs-selector-class">.setTableName</span>(tableName);
            tableVersion<span class="hljs-selector-class">.setTableVersionNum</span>(newVersionNumber);
            tableVersion<span class="hljs-selector-class">.setTableStructureHash</span>(currentStructHash);
            tableVersion<span class="hljs-selector-class">.setOperator</span>(operator);
            tableVersion<span class="hljs-selector-class">.setOperateTime</span>(new Date());
            tableVersion<span class="hljs-selector-class">.setVersionDesc</span>(versionDesc);

            <span class="hljs-built_in">if</span>(lastVersionNumber==<span class="hljs-number">0</span>){
                <span class="hljs-comment">// é¦–æ¬¡æäº¤ï¼šå…¨é‡åŸºçº¿å¿«ç…§</span>
                <span class="hljs-built_in">commitFullSnapshot</span>(tableVersion,tableName);
            }else{
                <span class="hljs-comment">// éé¦–æ¬¡æäº¤ï¼šå¢é‡å¿«ç…§</span>
                <span class="hljs-built_in">commitIncrementSnapshot</span>(tableVersion, tableName, lastVersionNumber);
            }

            <span class="hljs-comment">// 5. æ’å…¥ç‰ˆæœ¬è®°å½•è¡¨</span>
            tableVersionMapper<span class="hljs-selector-class">.insert</span>(tableVersion);
        } finally {
            <span class="hljs-comment">// è§£é”è¡¨</span>
            <span class="hljs-built_in">unlockTable</span>();
        }


    }

    <span class="hljs-keyword">@Transactional</span>
    <span class="hljs-keyword">@Override</span>
    public void rollbackToVersion(String tableName, Integer targetVersion, String operator) {
        <span class="hljs-comment">// 1. å‰ç½®æ ¡éªŒ</span>
        Integer maxVersion = tableVersionMapper<span class="hljs-selector-class">.selectMaxVersionNum</span>(tableName);
        if (targetVersion &gt; maxVersion) {
            throw new <span class="hljs-built_in">IpsException</span>("ç›®æ ‡ç‰ˆæœ¬[" + targetVersion + "]ä¸å­˜åœ¨ï¼Œå½“å‰æœ€æ–°ç‰ˆæœ¬ï¼š" + maxVersion);
        }

        <span class="hljs-comment">// 2. å›æ»šå‰å…ˆæäº¤å½“å‰ç‰ˆæœ¬</span>
        <span class="hljs-built_in">commitVersion</span>(tableName, "å›æ»šå‰è‡ªåŠ¨å¤‡ä»½-ç›®æ ‡ç‰ˆæœ¬ï¼š" + targetVersion, operator);

        <span class="hljs-comment">// 3. é”è¡¨ï¼šç¦æ­¢å¹¶å‘ä¿®æ”¹</span>
        <span class="hljs-built_in">lockTable</span>(tableName);

        try{
            <span class="hljs-comment">// 4. è·å–ç›®æ ‡ç‰ˆæœ¬çš„å…¨é‡æ•°æ®</span>
            Map&lt;String,Map&lt;String,<span class="hljs-selector-tag">Object</span>&gt;&gt; targetData=<span class="hljs-built_in">getMergeDataByVersion</span>(tableName, targetVersion);
            String pkName=tableStructureUtil<span class="hljs-selector-class">.getPrimaryKeyName</span>(tableName);

            <span class="hljs-comment">// 5. æ¸…ç©ºå½“å‰è¡¨</span>
            <span class="hljs-built_in">truncateTable</span>(tableName);

            <span class="hljs-comment">// 6. æ’å…¥ç›®æ ‡ç‰ˆæœ¬æ•°æ®åˆ°å½“å‰è¡¨</span>
            <span class="hljs-built_in">batchInsertData</span>(tableName, pkName, targetData);

            <span class="hljs-comment">// 7. æäº¤å›æ»šåçš„ç‰ˆæœ¬è®°å½•</span>
            <span class="hljs-built_in">commitVersion</span>(tableName, "å›æ»šåˆ°ç‰ˆæœ¬[" + targetVersion + "]", operator);
        }finally {
            <span class="hljs-built_in">unlockTable</span>();
        }


    }

    <span class="hljs-keyword">@Override</span>
    public String compareVersion(String tableName, Integer v1, Integer v2) {
        <span class="hljs-comment">// 1. è·å–ä¸¤ä¸ªç‰ˆæœ¬çš„å…¨é‡æ•°æ®</span>
        Map&lt;String, Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt;&gt; dataV1 = <span class="hljs-built_in">getMergeDataByVersion</span>(tableName, v1);
        Map&lt;String, Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt;&gt; dataV2 = <span class="hljs-built_in">getMergeDataByVersion</span>(tableName, v2);

        <span class="hljs-comment">// 2. å¯¹æ¯”å·®å¼‚ï¼ˆå¤ç”¨å¢é‡å¯¹æ¯”å·¥å…·ï¼‰</span>
        IncrementSnapshot diffSnapshot = incrementCompareUtil<span class="hljs-selector-class">.compare</span>(dataV1, dataV2, tableName, v1);

        <span class="hljs-comment">// 3. æ„å»ºå·®å¼‚æè¿°</span>
        StringBuilder diffDesc = new <span class="hljs-built_in">StringBuilder</span>();
        diffDesc<span class="hljs-selector-class">.append</span>("===== ç‰ˆæœ¬å¯¹æ¯”ï¼š")<span class="hljs-selector-class">.append</span>(v1)<span class="hljs-selector-class">.append</span>(" â†’ ")<span class="hljs-selector-class">.append</span>(v2)<span class="hljs-selector-class">.append</span>(" =====\n");
        List&lt;RecordChange&gt; recordChanges = diffSnapshot<span class="hljs-selector-class">.getRecordChanges</span>();
        if (CollectionUtils.isEmpty(recordChanges)) {
            diffDesc<span class="hljs-selector-class">.append</span>("æ— å·®å¼‚");
            return diffDesc<span class="hljs-selector-class">.toString</span>();
        }

        for (RecordChange change : recordChanges) {
            diffDesc<span class="hljs-selector-class">.append</span>(change.getChangeType())
                    <span class="hljs-selector-class">.append</span>(" - ä¸»é”®ï¼š")<span class="hljs-selector-class">.append</span>(change.getPrimaryKey())<span class="hljs-selector-class">.append</span>("\n");
            if ("UPDATE".equals(change.getChangeType())) {
                diffDesc<span class="hljs-selector-class">.append</span>("  æ—§å€¼ï¼š")<span class="hljs-selector-class">.append</span>(change.getOldData())<span class="hljs-selector-class">.append</span>("\n");
                diffDesc<span class="hljs-selector-class">.append</span>("  æ–°å€¼ï¼š")<span class="hljs-selector-class">.append</span>(change.getNewData())<span class="hljs-selector-class">.append</span>("\n");
            } else if ("ADD".equals(change.getChangeType())) {
                diffDesc<span class="hljs-selector-class">.append</span>("  æ–°å¢æ•°æ®ï¼š")<span class="hljs-selector-class">.append</span>(change.getNewData())<span class="hljs-selector-class">.append</span>("\n");
            } else if ("DELETE".equals(change.getChangeType())) {
                diffDesc<span class="hljs-selector-class">.append</span>("  åˆ é™¤æ•°æ®ï¼š")<span class="hljs-selector-class">.append</span>(change.getOldData())<span class="hljs-selector-class">.append</span>("\n");
            }
            diffDesc<span class="hljs-selector-class">.append</span>("------------------------\n");
        }
        return diffDesc<span class="hljs-selector-class">.toString</span>();
    }

    <span class="hljs-keyword">@Override</span>
    public List&lt;DgTableVersion&gt; listTableVersion(String tableName) {
        return tableVersionMapper<span class="hljs-selector-class">.selectAllByTableName</span>(tableName);
    }

    <span class="hljs-comment">// ====================== è¾…åŠ©æ–¹æ³• ======================</span>
    <span class="hljs-comment">/**
     * æ£€æŸ¥è¡¨ç»“æ„å˜æ›´ï¼Œè‹¥å˜æ›´åˆ™è®°å½•æ–°ç»“æ„ç‰ˆæœ¬
     */</span>
    private void <span class="hljs-built_in">checkTableStructure</span>(String tableName, String currentHash, String operator) {
        DgTableStructureVersion existStruct = tableStructureVersionMapper<span class="hljs-selector-class">.selectByTableAndHash</span>(tableName, currentHash);
        if (existStruct == null) {
            <span class="hljs-comment">// è¡¨ç»“æ„å˜æ›´ï¼Œè®°å½•æ–°ç»“æ„ç‰ˆæœ¬</span>
            String createTableSql = jdbcTemplate<span class="hljs-selector-class">.queryForMap</span>("SHOW CREATE TABLE " + tableName)<span class="hljs-selector-class">.get</span>("Create Table")<span class="hljs-selector-class">.toString</span>();
            DgTableStructureVersion newStruct = new <span class="hljs-built_in">DgTableStructureVersion</span>();
            newStruct<span class="hljs-selector-class">.setTableName</span>(tableName);
            newStruct<span class="hljs-selector-class">.setStructureSql</span>(createTableSql);
            newStruct<span class="hljs-selector-class">.setStructureHash</span>(currentHash);
            newStruct<span class="hljs-selector-class">.setOperator</span>(operator);
            newStruct<span class="hljs-selector-class">.setOperateTime</span>(new Date());
            tableStructureVersionMapper<span class="hljs-selector-class">.insert</span>(newStruct);
        }
    }

    <span class="hljs-comment">/**
     * é”è¡¨ï¼ˆMYSQL WRITEé”ï¼Œé˜»å¡æ‰€æœ‰è¯»å†™ï¼Œå°å¹¶å‘åœºæ™¯é€‚ç”¨ï¼‰
     */</span>
    private void <span class="hljs-built_in">lockTable</span>(String tableName) {
        if (!tableStructureUtil.validateTableName(tableName)) {
            throw new <span class="hljs-built_in">RuntimeException</span>("éæ³•è¡¨åï¼š" + tableName);
        }
        jdbcTemplate<span class="hljs-selector-class">.execute</span>("LOCK TABLE " + tableName + " WRITE");
    }

    <span class="hljs-comment">/**
     * è§£é”è¡¨
     */</span>
    private void <span class="hljs-built_in">unlockTable</span>() {
        jdbcTemplate<span class="hljs-selector-class">.execute</span>("UNLOCK TABLES");
    }

    <span class="hljs-comment">/**
     * æ¸…ç©ºè¡¨ï¼ˆå®‰å…¨æˆªæ–­ï¼Œé¿å…è¯¯åˆ ï¼‰
     */</span>
    private void <span class="hljs-built_in">truncateTable</span>(String tableName) {
        if (!tableStructureUtil.validateTableName(tableName)) {
            throw new <span class="hljs-built_in">RuntimeException</span>("éæ³•è¡¨åï¼š" + tableName);
        }
        jdbcTemplate<span class="hljs-selector-class">.execute</span>("TRUNCATE TABLE " + tableName);
    }



    <span class="hljs-comment">/**
     * æäº¤å…¨é‡åŸºçº¿å¿«ç…§ï¼ˆé¦–æ¬¡æäº¤ï¼‰
     */</span>
    private void <span class="hljs-built_in">commitFullSnapshot</span>(DgTableVersion tableVersion, String tableName) {
        <span class="hljs-comment">// æŸ¥è¯¢æ•´å¼ è¡¨æ•°æ®</span>
        Map&lt;String, Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt;&gt; fullData = tableStructureUtil<span class="hljs-selector-class">.queryTableData</span>(tableName);
        <span class="hljs-comment">// åºåˆ—åŒ–å…¨é‡æ•°æ®</span>
        FullSnapshot fullSnapshot = new <span class="hljs-built_in">FullSnapshot</span>(fullData);
        String snapshotContent = jsonUtil<span class="hljs-selector-class">.toJson</span>(fullSnapshot);
        <span class="hljs-comment">// è®¾ç½®å¿«ç…§ä¿¡æ¯</span>
        tableVersion<span class="hljs-selector-class">.setSnapshotType</span>(SnapshotType.FULL.name());
        tableVersion<span class="hljs-selector-class">.setSnapshotContent</span>(snapshotContent);
    }

    <span class="hljs-comment">/**
     * æäº¤å¢é‡å¿«ç…§ï¼ˆéé¦–æ¬¡æäº¤ï¼‰
     */</span>
    private void <span class="hljs-built_in">commitIncrementSnapshot</span>(DgTableVersion tableVersion, String tableName, Integer lastVersionNum) {
        <span class="hljs-comment">// 1. è·å–ä¸Šä¸€ç‰ˆæœ¬çš„å®Œæ•´æ•°æ®ï¼ˆåŸºçº¿+æ‰€æœ‰å¢é‡åˆå¹¶ï¼‰</span>
        Map&lt;String, Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt;&gt; lastVersionData = <span class="hljs-built_in">getMergeDataByVersion</span>(tableName, lastVersionNum);
        <span class="hljs-comment">// 2. è·å–å½“å‰è¡¨çš„æœ€æ–°æ•°æ®</span>
        Map&lt;String, Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt;&gt; currentData = tableStructureUtil<span class="hljs-selector-class">.queryTableData</span>(tableName);
        <span class="hljs-comment">// 3. å¯¹æ¯”æå–å¢é‡å˜æ›´é›†</span>
        IncrementSnapshot incrementSnapshot = incrementCompareUtil<span class="hljs-selector-class">.compare</span>(lastVersionData, currentData, tableName, lastVersionNum);
        <span class="hljs-comment">// 4. åºåˆ—åŒ–å¢é‡å˜æ›´é›†</span>
        String snapshotContent = jsonUtil<span class="hljs-selector-class">.toJson</span>(incrementSnapshot);
        <span class="hljs-comment">// 5. è®¾ç½®å¿«ç…§ä¿¡æ¯</span>
        tableVersion<span class="hljs-selector-class">.setSnapshotType</span>(SnapshotType.INCREMENT.name());
        tableVersion<span class="hljs-selector-class">.setSnapshotContent</span>(snapshotContent);
    }


    <span class="hljs-comment">/**
     * åˆå¹¶åŸºçº¿+å¢é‡ï¼Œè·å–æŒ‡å®šç‰ˆæœ¬çš„å…¨é‡æ•°æ®
     */</span>
    private Map&lt;String, Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt;&gt; <span class="hljs-built_in">getMergeDataByVersion</span>(String tableName, Integer targetVersion) {
        List&lt;DgTableVersion&gt; versionList = tableVersionMapper<span class="hljs-selector-class">.selectAllByTableName</span>(tableName);
        Map&lt;String, Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt;&gt; mergeData = new HashMap&lt;&gt;();

        for (DgTableVersion version : versionList) {
            Integer versionNum = version<span class="hljs-selector-class">.getTableVersionNum</span>();
            if (versionNum &gt; targetVersion) {
                break;
            }
            String snapshotType = version<span class="hljs-selector-class">.getSnapshotType</span>();
            String snapshotContent = version<span class="hljs-selector-class">.getSnapshotContent</span>();

            if (SnapshotType.FULL.name()<span class="hljs-selector-class">.equals</span>(snapshotType)) {
                <span class="hljs-comment">// åŸºçº¿ç‰ˆæœ¬ï¼šç›´æ¥è¦†ç›–mergeData</span>
                FullSnapshot fullSnapshot = jsonUtil<span class="hljs-selector-class">.fromJson</span>(snapshotContent, FullSnapshot.class);
                mergeData = fullSnapshot<span class="hljs-selector-class">.getFullData</span>();
            } else {
                <span class="hljs-comment">// å¢é‡ç‰ˆæœ¬ï¼šåº”ç”¨å˜æ›´é›†åˆ°mergeData</span>
                IncrementSnapshot incrementSnapshot = jsonUtil<span class="hljs-selector-class">.fromJson</span>(snapshotContent, IncrementSnapshot.class);
                <span class="hljs-built_in">applyIncrementToMergeData</span>(mergeData, incrementSnapshot.getRecordChanges());
            }
        }
        return mergeData;
    }

    <span class="hljs-comment">/**
     * å°†å¢é‡å˜æ›´é›†åº”ç”¨åˆ°åˆå¹¶æ•°æ®ä¸­ï¼ˆæ­£å‘ï¼‰
     */</span>
    private void <span class="hljs-built_in">applyIncrementToMergeData</span>(Map&lt;String, Map&lt;String, Object&gt;&gt; mergeData, List&lt;RecordChange&gt; recordChanges) {
        for (RecordChange change : recordChanges) {
            <span class="hljs-selector-tag">Object</span> pkValue = change<span class="hljs-selector-class">.getPrimaryKey</span>();
            switch (change.getChangeType()) {
                case "ADD":
                    mergeData.<span class="hljs-built_in">put</span>(pkValue.<span class="hljs-built_in">toString</span>(), change.<span class="hljs-built_in">getNewData</span>());
                    break;
                case "UPDATE":
                    mergeData.<span class="hljs-built_in">put</span>(pkValue.<span class="hljs-built_in">toString</span>(), change.<span class="hljs-built_in">getNewData</span>());
                    break;
                case "DELETE":
                    mergeData.<span class="hljs-built_in">remove</span>(pkValue.<span class="hljs-built_in">toString</span>());
                    break;
            }
        }
    }

    <span class="hljs-comment">/**
     * æ‰¹é‡æ’å…¥æ•°æ®åˆ°è¡¨ä¸­
     */</span>
    private void <span class="hljs-built_in">batchInsertData</span>(String tableName, String pkName, Map&lt;String, Map&lt;String, Object&gt;&gt; dataMap) {
        if (CollectionUtils.isEmpty(dataMap)) {
            return;
        }
        <span class="hljs-comment">// æå–ç¬¬ä¸€æ¡è®°å½•çš„å­—æ®µåï¼ˆæ‰€æœ‰è®°å½•å­—æ®µä¸€è‡´ï¼‰</span>
        Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt; firstRow = dataMap<span class="hljs-selector-class">.values</span>()<span class="hljs-selector-class">.iterator</span>()<span class="hljs-selector-class">.next</span>();
        if (CollectionUtils.isEmpty(firstRow)) { <span class="hljs-comment">// æ–°å¢ï¼šå­—æ®µä¸ºç©ºç›´æ¥è¿”å›</span>
            return;
        }
        List&lt;String&gt; <span class="hljs-attribute">columns</span> = new ArrayList&lt;&gt;(firstRow.keySet());

        <span class="hljs-comment">// ä¿®å¤1ï¼šè½¬ä¹‰ä¿ç•™å…³é”®å­—å­—æ®µï¼ˆå¦‚descã€enableç­‰ï¼‰</span>
        List&lt;String&gt; escapedColumns = <span class="hljs-attribute">columns</span><span class="hljs-selector-class">.stream</span>()
                <span class="hljs-selector-class">.map</span>(col -&gt; "`" + col + "`")
                <span class="hljs-selector-class">.collect</span>(Collectors.toList());
        String columnStr = String<span class="hljs-selector-class">.join</span>(",", escapedColumns);

        <span class="hljs-comment">// æ„å»ºæ‰¹é‡æ’å…¥SQLï¼ˆä¼˜åŒ–æ‹¼æ¥é€»è¾‘ï¼‰</span>
        StringBuilder sqlBuilder = new <span class="hljs-built_in">StringBuilder</span>();
        sqlBuilder<span class="hljs-selector-class">.append</span>("INSERT INTO ")<span class="hljs-selector-class">.append</span>(tableName)<span class="hljs-selector-class">.append</span>(" (")<span class="hljs-selector-class">.append</span>(columnStr)<span class="hljs-selector-class">.append</span>(") VALUES ");

        List&lt;List&lt;<span class="hljs-selector-tag">Object</span>&gt;&gt; batchParams = new ArrayList&lt;&gt;();
        List&lt;String&gt; valuePlaceholders = new ArrayList&lt;&gt;(); <span class="hljs-comment">// å­˜å‚¨æ¯ä¸€è¡Œçš„?å ä½ç¬¦</span>
        for (Map&lt;String, Object&gt; row : dataMap.values()) {
            List&lt;<span class="hljs-selector-tag">Object</span>&gt; params = new ArrayList&lt;&gt;();
            <span class="hljs-comment">// æ„å»ºå•æ¡è®°å½•çš„?å ä½ç¬¦</span>
            StringBuilder singleValue = new <span class="hljs-built_in">StringBuilder</span>("(");
            for (String column : columns) {
                singleValue<span class="hljs-selector-class">.append</span>("?,");
                params<span class="hljs-selector-class">.add</span>(row.get(column));
            }
            <span class="hljs-comment">// ç§»é™¤æœ€åä¸€ä¸ªé€—å·ï¼ˆæ›´å®‰å…¨çš„æ–¹å¼ï¼‰</span>
            if (singleValue.length() &gt; <span class="hljs-number">1</span>) {
                singleValue<span class="hljs-selector-class">.setLength</span>(singleValue.length() - <span class="hljs-number">1</span>);
            }
            singleValue<span class="hljs-selector-class">.append</span>(")");
            valuePlaceholders<span class="hljs-selector-class">.add</span>(singleValue.toString()); <span class="hljs-comment">// åŠ å…¥å ä½ç¬¦åˆ—è¡¨</span>
            batchParams<span class="hljs-selector-class">.add</span>(params);
        }
        <span class="hljs-comment">// æ‹¼æ¥æ‰€æœ‰å ä½ç¬¦ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ï¼Œé¿å…æ‰‹åŠ¨åˆ é€—å·</span>
        sqlBuilder<span class="hljs-selector-class">.append</span>(String.join(",", valuePlaceholders));

        <span class="hljs-comment">// æ‰§è¡Œæ‰¹é‡æ’å…¥</span>
        jdbcTemplate<span class="hljs-selector-class">.batchUpdate</span>(sqlBuilder.toString(), new <span class="hljs-built_in">BatchPreparedStatementSetter</span>() {
            <span class="hljs-keyword">@Override</span>
            public void setValues(PreparedStatement ps, int i) throws SQLException {
                List&lt;<span class="hljs-selector-tag">Object</span>&gt; params = batchParams<span class="hljs-selector-class">.get</span>(i);
                for (int j = <span class="hljs-number">0</span>; j &lt; params.size(); j++) {
                    ps<span class="hljs-selector-class">.setObject</span>(j + <span class="hljs-number">1</span>, params.get(j));
                }
            }

            <span class="hljs-keyword">@Override</span>
            public int getBatchSize() {
                return batchParams<span class="hljs-selector-class">.size</span>();
            }
        });
    }

}
</code></pre>
<h3 data-id="heading-24">6. æ§åˆ¶å±‚ï¼ˆæš´éœ² REST æ¥å£ï¼‰</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">io</span><span class="hljs-selector-class">.swagger</span><span class="hljs-selector-class">.v3</span><span class="hljs-selector-class">.oas</span><span class="hljs-selector-class">.annotations</span><span class="hljs-selector-class">.Operation</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">lombok</span><span class="hljs-selector-class">.RequiredArgsConstructor</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">lombok</span><span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.ResponseEntity</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.web</span><span class="hljs-selector-class">.bind</span><span class="hljs-selector-class">.annotation</span>.*;

<span class="hljs-comment">/**
 * è¡¨å†…å®¹ç‰ˆæœ¬æ§åˆ¶
 *
 * @author: ZhongXS02
 * @date: 2026-01-05
 **/</span>
@<span class="hljs-selector-tag">RestController</span>
@<span class="hljs-selector-tag">RequestMapping</span>(<span class="hljs-string">"/v1/dg/tableVersion"</span>)
@<span class="hljs-selector-tag">Slf4j</span>
@<span class="hljs-selector-tag">RequiredArgsConstructor</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">DgTableVersionController</span> {

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">DgTableVersionService</span> <span class="hljs-selector-tag">dgTableVersionService</span>;

    @<span class="hljs-selector-tag">Operation</span>(summary = <span class="hljs-string">"æäº¤è¡¨ç‰ˆæœ¬"</span>)
    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"commit"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ResponseEntity</span>&lt;?&gt; <span class="hljs-selector-tag">commitVersion</span>(<span class="hljs-variable">@RequestParam</span> String tableName,
                                           <span class="hljs-variable">@RequestParam</span> String versionDesc,
                                           <span class="hljs-variable">@RequestParam</span>(defaultValue = <span class="hljs-string">"admin"</span>) String operator){
        <span class="hljs-selector-tag">dgTableVersionService</span><span class="hljs-selector-class">.commitVersion</span>(tableName, versionDesc, operator);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(<span class="hljs-string">"æäº¤æˆåŠŸ"</span>);
    }

    @<span class="hljs-selector-tag">Operation</span>(summary = <span class="hljs-string">"å¯¹æ¯”ä¸¤ä¸ªç‰ˆæœ¬å·®å¼‚"</span>)
    @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"compare"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ResponseEntity</span>&lt;?&gt; <span class="hljs-selector-tag">compareVersion</span>(<span class="hljs-variable">@RequestParam</span> String tableName,
                                            <span class="hljs-variable">@RequestParam</span> Integer v1,
                                            <span class="hljs-variable">@RequestParam</span> Integer v2){
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">diff</span> = <span class="hljs-selector-tag">dgTableVersionService</span><span class="hljs-selector-class">.compareVersion</span>(tableName, v1, v2);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(diff);
    }


    @<span class="hljs-selector-tag">Operation</span>(summary = <span class="hljs-string">"å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬"</span>)
    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"rollback"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ResponseEntity</span>&lt;?&gt; <span class="hljs-selector-tag">rollbackVersion</span>(<span class="hljs-variable">@RequestParam</span> String tableName,
                                     <span class="hljs-variable">@RequestParam</span> Integer targetVersion,
                                     <span class="hljs-variable">@RequestParam</span>(defaultValue = <span class="hljs-string">"admin"</span>) String operator) {
        <span class="hljs-selector-tag">dgTableVersionService</span><span class="hljs-selector-class">.rollbackToVersion</span>(tableName, targetVersion, operator);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(<span class="hljs-string">"å›æ»šæˆåŠŸ"</span>);
    }


}
</code></pre>
<h2 data-id="heading-25">å››ã€æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šç”Ÿäº§ç¯å¢ƒè‹¥å¹¶å‘è¾ƒé«˜ï¼Œå»ºè®®æ›¿æ¢è¡¨é”ä¸ºåˆ†å¸ƒå¼é”ï¼ˆå¦‚Redissonï¼‰ï¼Œé¿å…é”è¡¨é˜»å¡</li>
<li><strong>å¤§è¡¨ä¼˜åŒ–</strong>ï¼šæ‰¹é‡æ’å…¥æ—¶ä½¿ç”¨åˆ†æ‰¹æ’å…¥ï¼ˆå¦‚æ¯ 1000 æ¡ä¸€æ‰¹ï¼‰ï¼Œé¿å…å†…å­˜æº¢å‡ºï¼›å¢é‡å¯¹æ¯”æ—¶å¯é™åˆ¶æŸ¥è¯¢å­—æ®µï¼ˆä»…å¯¹æ¯”ä¸šåŠ¡å­—æ®µï¼Œå¿½ç•¥ create_time/update_time ç­‰ï¼‰</li>
<li><strong>SQLæ³¨å…¥é˜²æŠ¤</strong>ï¼šè¡¨åã€å­—æ®µåå¿…é¡»ä¸¥æ ¼æ ¡éªŒï¼Œç¦æ­¢ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥</li>
<li><strong>ç‰ˆæœ¬å½’æ¡£</strong>ï¼šå®šæœŸå½’æ¡£æ—§ç‰ˆæœ¬ï¼ˆå¦‚è¶…è¿‡ 6 ä¸ªæœˆçš„å¢é‡å¿«ç…§ï¼‰ï¼Œåˆå¹¶ä¸ºæ–°åŸºçº¿ï¼Œå‡å°‘å›æ»šæ—¶çš„è®¡ç®—é‡</li>
<li><strong>æ•°æ®å¤‡ä»½</strong>ï¼šå›æ»šå‰çš„è‡ªåŠ¨å¤‡ä»½å»ºè®®å­˜å‚¨åˆ°ç‹¬ç«‹çš„å¤‡ä»½è¡¨ï¼Œè€Œéä»…æäº¤ç‰ˆæœ¬ï¼ˆé˜²æ­¢å›æ»šå¤±è´¥ï¼‰</li>
</ol>
<h2 data-id="heading-26">äº”ã€é—®é¢˜æ€»ç›‘</h2>
<h3 data-id="heading-27">1. æ–°å­¦äº†@RequiredArgsConstructor + final æ³¨å…¥ï¼ˆæ„é€ å™¨æ³¨å…¥ï¼‰</h3>
<p><code>@RequiredArgsConstructor</code>æ˜¯ Lombok æ³¨è§£ï¼Œä¼šè‡ªåŠ¨ç”ŸæˆåŒ…å«æ‰€æœ‰<code>final</code>å­—æ®µçš„æ„é€ å™¨ï¼ŒSpring é€šè¿‡æ„é€ å™¨å®Œæˆæ³¨å…¥ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.RequiredArgsConstructor;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@RequiredArgsConstructor</span> <span class="hljs-comment">// Lombokè‡ªåŠ¨ç”Ÿæˆæ„é€ å™¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-comment">// finalä¿®é¥°çš„å­—æ®µä¼šè¢«çº³å…¥æ„é€ å™¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;

    <span class="hljs-comment">// ä¸šåŠ¡æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getUser</span><span class="hljs-params">()</span> {
        userRepository.findById(<span class="hljs-number">1L</span>);
    }
}
</code></pre>
<blockquote>
<p>ç­‰ä»·äº</p>
</blockquote>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;

    <span class="hljs-comment">// æ‰‹åŠ¨ç¼–å†™æ„é€ å™¨ï¼ŒSpringé€šè¿‡æ„é€ å™¨æ³¨å…¥</span>
    <span class="hljs-keyword">public</span> UserService(UserRepository userRepository) {
        <span class="hljs-keyword">this</span>.userRepository = userRepository;
    }
}
</code></pre>


















































<table><thead><tr><th>ç»´åº¦</th><th>@Autowiredï¼ˆå­—æ®µæ³¨å…¥ï¼‰</th><th>@RequiredArgsConstructor + finalï¼ˆæ„é€ å™¨æ³¨å…¥ï¼‰</th></tr></thead><tbody><tr><td>æ³¨å…¥æ–¹å¼</td><td>å­—æ®µæ³¨å…¥ï¼ŒSpring é€šè¿‡åå°„ç›´æ¥èµ‹å€¼å­—æ®µ</td><td>æ„é€ å™¨æ³¨å…¥ï¼ŒSpring è°ƒç”¨æ„é€ å™¨ä¼ å…¥ä¾èµ–</td></tr><tr><td>ä¸å¯å˜æ€§</td><td>å­—æ®µä¸èƒ½ç”¨ final ä¿®é¥°ï¼ˆèµ‹å€¼æ—¶æœºæ™šï¼‰</td><td>å­—æ®µå¿…é¡»ç”¨ final ä¿®é¥°ï¼Œä¿è¯ä¾èµ–ä¸å¯å˜</td></tr><tr><td>ç©ºæŒ‡é’ˆé£é™©</td><td>é«˜ï¼ˆä¾èµ–æœªæ³¨å…¥æ—¶è°ƒç”¨ä¼š NPEï¼‰</td><td>ä½ï¼ˆæ„é€ æ—¶å¿…é¡»ä¼ å…¥ä¾èµ–ï¼Œå¦åˆ™æ— æ³•åˆ›å»ºå¯¹è±¡ï¼‰</td></tr><tr><td>å¯æµ‹è¯•æ€§</td><td>å·®ï¼ˆéœ€è¦ Spring å®¹å™¨ï¼Œå•å…ƒæµ‹è¯•éœ€ mockitoï¼‰</td><td>å¥½ï¼ˆç›´æ¥é€šè¿‡æ„é€ å™¨ä¼ å…¥ mock å¯¹è±¡ï¼Œæ— éœ€å®¹å™¨ï¼‰</td></tr><tr><td>ä»£ç ç®€æ´æ€§</td><td>å­—æ®µä¸ŠåŠ æ³¨è§£ï¼Œæ— éœ€å†™æ„é€ å™¨</td><td>ç±»ä¸ŠåŠ æ³¨è§£ï¼Œå­—æ®µåŠ  finalï¼Œæ— å†—ä½™ä»£ç </td></tr><tr><td>ä¾èµ–å¯è§æ€§</td><td>ç§æœ‰å­—æ®µï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥èµ‹å€¼</td><td>æ„é€ å™¨æš´éœ²ä¾èµ–ï¼Œè¯­ä¹‰æ›´æ¸…æ™°</td></tr><tr><td>Spring ç‰ˆæœ¬å…¼å®¹</td><td>å…¨ç‰ˆæœ¬æ”¯æŒ</td><td>éœ€ Spring 4.3+ï¼ˆè‡ªåŠ¨è¯†åˆ«å•æ„é€ å™¨æ— éœ€ @Autowiredï¼‰</td></tr><tr><td>å¾ªç¯ä¾èµ–å¤„ç†</td><td>æ”¯æŒï¼ˆå­—æ®µæ³¨å…¥æ˜¯ Spring åæœŸèµ‹å€¼ï¼‰</td><td>ä¸æ”¯æŒï¼ˆæ„é€ å™¨æ³¨å…¥ä¼šè§¦å‘å¾ªç¯ä¾èµ–æ£€æµ‹ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-28">2. ä¸»é”®å¼‚å¸¸</h3>
<p>é—®é¢˜æè¿°ï¼šæ•°æ®åº“åŸè¡¨ä¸»é”®æ˜¯BIGINT,ç”¨Objectæ¥æ”¶å°±æ˜¯Longï¼Œä½†è½¬ä¸ºJSONåœ¨æå–å‡ºæ¥å°±ä¼šå˜æˆIngterï¼Œè¿™æ ·åœ¨å¯¹æ¯”çš„æ—¶å€™å°±ä¼šåŒ¹é…ä¸ä¸Š</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<blockquote>
<p>Map&lt;Object, Map&lt;String, Object&gt;&gt; -&gt; Map&lt;String, Map&lt;String, Object&gt;&gt;</p>
</blockquote>
<p>å°†ä¸»é”® Object æ”¹ä¸º String</p>
<h3 data-id="heading-29">3. å…³é”®å­—å¼‚å¸¸</h3>
<p>é—®é¢˜æè¿°ï¼šåœ¨å›æ»šè¡¨ç»“æ„æ—¶ï¼Œæœ‰ä¸ªå…³é”®å­—æ˜¯MySQLä¿ç•™å­—æ®µï¼Œä½†æ²¡åšç›¸å¯¹åº”çš„å¤„ç†å¯¼è‡´æŠ¥é”™</p>
<p>è§£å†³æ–¹æ³•ï¼šåŠ ä¸Šå…³é”®å­—å¤„ç†æ–¹æ³•  `å­—æ®µ`</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
 * æ‰¹é‡æ’å…¥æ•°æ®åˆ°è¡¨ä¸­
 */</span>
private void <span class="hljs-built_in">batchInsertData</span>(String tableName, String pkName, Map&lt;String, Map&lt;String, Object&gt;&gt; dataMap) {
    if (CollectionUtils.isEmpty(dataMap)) {
        return;
    }
    <span class="hljs-comment">// æå–ç¬¬ä¸€æ¡è®°å½•çš„å­—æ®µåï¼ˆæ‰€æœ‰è®°å½•å­—æ®µä¸€è‡´ï¼‰</span>
    Map&lt;String, <span class="hljs-selector-tag">Object</span>&gt; firstRow = dataMap<span class="hljs-selector-class">.values</span>()<span class="hljs-selector-class">.iterator</span>()<span class="hljs-selector-class">.next</span>();
    if (CollectionUtils.isEmpty(firstRow)) { <span class="hljs-comment">// æ–°å¢ï¼šå­—æ®µä¸ºç©ºç›´æ¥è¿”å›</span>
        return;
    }
    List&lt;String&gt; <span class="hljs-attribute">columns</span> = new ArrayList&lt;&gt;(firstRow.keySet());

    <span class="hljs-comment">// ä¿®å¤1ï¼šè½¬ä¹‰ä¿ç•™å…³é”®å­—å­—æ®µï¼ˆå¦‚descã€enableç­‰ï¼‰</span>
    List&lt;String&gt; escapedColumns = <span class="hljs-attribute">columns</span><span class="hljs-selector-class">.stream</span>()
            <span class="hljs-selector-class">.map</span>(col -&gt; "`" + col + "`")
            <span class="hljs-selector-class">.collect</span>(Collectors.toList());
    String columnStr = String<span class="hljs-selector-class">.join</span>(",", escapedColumns);

    <span class="hljs-comment">// æ„å»ºæ‰¹é‡æ’å…¥SQLï¼ˆä¼˜åŒ–æ‹¼æ¥é€»è¾‘ï¼‰</span>
    StringBuilder sqlBuilder = new <span class="hljs-built_in">StringBuilder</span>();
    sqlBuilder<span class="hljs-selector-class">.append</span>("INSERT INTO ")<span class="hljs-selector-class">.append</span>(tableName)<span class="hljs-selector-class">.append</span>(" (")<span class="hljs-selector-class">.append</span>(columnStr)<span class="hljs-selector-class">.append</span>(") VALUES ");

    List&lt;List&lt;<span class="hljs-selector-tag">Object</span>&gt;&gt; batchParams = new ArrayList&lt;&gt;();
    List&lt;String&gt; valuePlaceholders = new ArrayList&lt;&gt;(); <span class="hljs-comment">// å­˜å‚¨æ¯ä¸€è¡Œçš„?å ä½ç¬¦</span>
    for (Map&lt;String, Object&gt; row : dataMap.values()) {
        List&lt;<span class="hljs-selector-tag">Object</span>&gt; params = new ArrayList&lt;&gt;();
        <span class="hljs-comment">// æ„å»ºå•æ¡è®°å½•çš„?å ä½ç¬¦</span>
        StringBuilder singleValue = new <span class="hljs-built_in">StringBuilder</span>("(");
        for (String column : columns) {
            singleValue<span class="hljs-selector-class">.append</span>("?,");
            params<span class="hljs-selector-class">.add</span>(row.get(column));
        }
        <span class="hljs-comment">// ç§»é™¤æœ€åä¸€ä¸ªé€—å·ï¼ˆæ›´å®‰å…¨çš„æ–¹å¼ï¼‰</span>
        if (singleValue.length() &gt; <span class="hljs-number">1</span>) {
            singleValue<span class="hljs-selector-class">.setLength</span>(singleValue.length() - <span class="hljs-number">1</span>);
        }
        singleValue<span class="hljs-selector-class">.append</span>(")");
        valuePlaceholders<span class="hljs-selector-class">.add</span>(singleValue.toString()); <span class="hljs-comment">// åŠ å…¥å ä½ç¬¦åˆ—è¡¨</span>
        batchParams<span class="hljs-selector-class">.add</span>(params);
    }
    <span class="hljs-comment">// æ‹¼æ¥æ‰€æœ‰å ä½ç¬¦ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ï¼Œé¿å…æ‰‹åŠ¨åˆ é€—å·</span>
    sqlBuilder<span class="hljs-selector-class">.append</span>(String.join(",", valuePlaceholders));

    <span class="hljs-comment">// æ‰§è¡Œæ‰¹é‡æ’å…¥</span>
    jdbcTemplate<span class="hljs-selector-class">.batchUpdate</span>(sqlBuilder.toString(), new <span class="hljs-built_in">BatchPreparedStatementSetter</span>() {
        <span class="hljs-keyword">@Override</span>
        public void setValues(PreparedStatement ps, int i) throws SQLException {
            List&lt;<span class="hljs-selector-tag">Object</span>&gt; params = batchParams<span class="hljs-selector-class">.get</span>(i);
            for (int j = <span class="hljs-number">0</span>; j &lt; params.size(); j++) {
                ps<span class="hljs-selector-class">.setObject</span>(j + <span class="hljs-number">1</span>, params.get(j));
            }
        }

        <span class="hljs-keyword">@Override</span>
        public int getBatchSize() {
            return batchParams<span class="hljs-selector-class">.size</span>();
        }
    });
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAGæ ¸å¿ƒå‡çº§ï½œå¤šLLMæ¨¡å‹åŠ¨æ€åˆ‡æ¢æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7592884480732168238</link>    <guid>https://juejin.cn/post/7592884480732168238</guid>    <pubDate>2026-01-09T02:55:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592884480732168238" data-draft-id="7592884480732151854" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAGæ ¸å¿ƒå‡çº§ï½œå¤šLLMæ¨¡å‹åŠ¨æ€åˆ‡æ¢æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-09T02:55:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€ è½®å­çš„çŒª"/> <meta itemprop="url" content="https://juejin.cn/user/497453720940158"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAGæ ¸å¿ƒå‡çº§ï½œå¤šLLMæ¨¡å‹åŠ¨æ€åˆ‡æ¢æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/497453720940158/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€ è½®å­çš„çŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:55:45.000Z" title="Fri Jan 09 2026 02:55:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RAGæ ¸å¿ƒå‡çº§ï½œå¤šLLMæ¨¡å‹åŠ¨æ€åˆ‡æ¢æ–¹æ¡ˆ</h2>
<h3 data-id="heading-1">ä¸€ã€å¤šæ¨¡å‹åˆ‡æ¢æ ¸å¿ƒä»·å€¼</h3>
<p>ä¼ ç»ŸRAGæ¶æ„ç»‘å®šå•ä¸€LLMæ¨¡å‹ï¼Œæ— æ³•é€‚é…å¤šæ ·åŒ–çš„é—®ç­”åœºæ™¯ï¼›è€Œ<strong>å¤šæ¨¡å‹åŠ¨æ€åˆ‡æ¢æ–¹æ¡ˆ</strong>å¯æ ¹æ®åœºæ™¯/éœ€æ±‚çµæ´»é€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼Œæ ¸å¿ƒä»·å€¼å¦‚ä¸‹ï¼š
åœºæ™¯åŒ–é€‚é…ï¼šæŠ€æœ¯æ–‡æ¡£é—®ç­”ç”¨<code>deepseek-r1</code>ï¼ˆä»£ç /æŠ€æœ¯ç†è§£å¼ºï¼‰ï¼Œé€šç”¨é—²èŠç”¨<code>qwen2-7b</code>ï¼ˆä¸­æ–‡æµç•…åº¦é«˜ï¼‰ï¼Œç²¾å‡†åŒ¹é…ä¸åŒåœºæ™¯éœ€æ±‚ï¼›
æ€§èƒ½ä¸æˆæœ¬å¹³è¡¡ï¼šç®€å•é—®ç­”ç”¨è½»é‡æ¨¡å‹ï¼ˆå¦‚7Bï¼‰ï¼Œå¤æ‚æ¨ç†ç”¨é«˜æ€§èƒ½æ¨¡å‹ï¼ˆå¦‚8B/70Bï¼‰ï¼Œé™ä½æ•´ä½“æ¨ç†æˆæœ¬ï¼›
å®¹é”™ä¸å®¹ç¾ï¼šå•ä¸ªæ¨¡å‹æœåŠ¡å¼‚å¸¸æ—¶ï¼Œå¯å¿«é€Ÿåˆ‡æ¢åˆ°å¤‡ç”¨æ¨¡å‹ï¼Œæå‡ç³»ç»Ÿå¯ç”¨æ€§ï¼›
çµæ´»æ‰©å±•ï¼šæ–°å¢æ¨¡å‹ä»…éœ€é…ç½®YAMLï¼Œæ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç ï¼Œæ”¯æŒæ— ç¼æ¥å…¥Llama3ã€Geminiç­‰æ–°æ¨¡å‹ï¼›
ä¸ªæ€§åŒ–è°ƒä¼˜ï¼šä¸åŒæ¨¡å‹ç‹¬ç«‹é…ç½®å‚æ•°ï¼ˆæ¸©åº¦ã€æœ€å¤§ç”Ÿæˆé•¿åº¦ï¼‰ï¼Œé’ˆå¯¹åœºæ™¯ç²¾ç»†åŒ–è°ƒä¼˜ï¼Œæå‡å›ç­”è´¨é‡ã€‚</p>
<h3 data-id="heading-2">äºŒã€å¤šæ¨¡å‹åˆ‡æ¢ vs å•æ¨¡å‹ç»‘å®šï¼ˆæ ¸å¿ƒä¼˜åŠ¿å¯¹æ¯”ï¼‰</h3>








































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>å•æ¨¡å‹ç»‘å®šï¼ˆä¼ ç»Ÿæ–¹æ¡ˆï¼‰</th><th>å¤šæ¨¡å‹åŠ¨æ€åˆ‡æ¢ï¼ˆä¼˜åŒ–æ–¹æ¡ˆï¼‰</th></tr></thead><tbody><tr><td><strong>åœºæ™¯é€‚é…æ€§</strong></td><td>å•ä¸€æ¨¡å‹æ— æ³•å…¼é¡¾æ‰€æœ‰åœºæ™¯ï¼ˆå¦‚æŠ€æœ¯é—®ç­”/é€šç”¨é—²èŠï¼‰</td><td>æŒ‰åœºæ™¯é€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼Œç²¾å‡†åŒ¹é…ä¸åŒé—®ç­”éœ€æ±‚</td></tr><tr><td><strong>å‚æ•°è°ƒä¼˜</strong></td><td>å…¨å±€å‚æ•°é…ç½®ï¼Œæ— æ³•é’ˆå¯¹åœºæ™¯ç²¾ç»†åŒ–è°ƒä¼˜</td><td>æ¯ä¸ªæ¨¡å‹ç‹¬ç«‹é…ç½®å‚æ•°ï¼ˆæ¸©åº¦ã€max_tokensï¼‰ï¼Œçµæ´»è°ƒä¼˜</td></tr><tr><td><strong>ç³»ç»Ÿå¯ç”¨æ€§</strong></td><td>æ¨¡å‹æœåŠ¡å¼‚å¸¸åˆ™æ•´ä½“ä¸å¯ç”¨</td><td>æ”¯æŒæ¨¡å‹é™çº§/åˆ‡æ¢ï¼Œå•ä¸ªæ¨¡å‹æ•…éšœä¸å½±å“æ•´ä½“æœåŠ¡</td></tr><tr><td><strong>æ‰©å±•æˆæœ¬</strong></td><td>æ–°å¢æ¨¡å‹éœ€ä¿®æ”¹ä»£ç ã€é‡æ–°éƒ¨ç½²</td><td>ä»…éœ€æ–°å¢YAMLé…ç½®ï¼Œçƒ­æ‰©å±•æ— éœ€é‡å¯æœåŠ¡</td></tr><tr><td><strong>èµ„æºåˆ©ç”¨æ•ˆç‡</strong></td><td>è½»é‡åœºæ™¯æµªè´¹å¤§æ¨¡å‹èµ„æºï¼Œå¤æ‚åœºæ™¯è½»é‡æ¨¡å‹èƒ½åŠ›ä¸è¶³</td><td>æŒ‰éœ€åˆ†é…æ¨¡å‹èµ„æºï¼Œå¹³è¡¡æ€§èƒ½ä¸æˆæœ¬</td></tr><tr><td><strong>è¿­ä»£çµæ´»æ€§</strong></td><td>æ¨¡å‹å‡çº§éœ€å…¨é‡æ›¿æ¢ï¼Œé£é™©é«˜</td><td>å¯ç°åº¦éªŒè¯æ–°æ¨¡å‹ï¼Œé€æ­¥åˆ‡æ¢ï¼Œé™ä½è¿­ä»£é£é™©</td></tr></tbody></table>
<h3 data-id="heading-3">ä¸‰ã€å®Œæ•´å®ç°æ–¹æ¡ˆ</h3>
<h4 data-id="heading-4">1. YAMLé…ç½®ï¼ˆç»“æ„åŒ–+å¯æ‰©å±•ï¼‰</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">ollama:</span>
      <span class="hljs-comment"># Ollama æœåŠ¡åŸºç¡€åœ°å€ï¼ˆç»Ÿä¸€é…ç½®ï¼Œé¿å…ç¡¬ç¼–ç ï¼‰</span>
      <span class="hljs-attr">base-url:</span> <span class="hljs-string">http://127.0.0.1:11434</span>
      <span class="hljs-comment"># å¤šChatæ¨¡å‹é…ç½®åˆ—è¡¨ï¼ˆæ ¸å¿ƒï¼šæ”¯æŒåŠ¨æ€æ‰©å±•ï¼‰</span>
      <span class="hljs-attr">chats:</span>
        <span class="hljs-comment"># æ¨¡å‹1ï¼šé€šä¹‰åƒé—®ï¼ˆé»˜è®¤æ¨¡å‹ï¼Œä¸­æ–‡é€šç”¨åœºæ™¯ï¼‰</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">code:</span> <span class="hljs-string">qwen2-7b</span>
          <span class="hljs-attr">model:</span> <span class="hljs-string">qwen2:7b-instruct</span>
          <span class="hljs-attr">options:</span>
            <span class="hljs-attr">temperature:</span> <span class="hljs-number">0.3</span>        <span class="hljs-comment"># ä½éšæœºæ€§ï¼Œä¿è¯å›ç­”ç²¾å‡†</span>
            <span class="hljs-attr">max_tokens:</span> <span class="hljs-number">2000</span>        <span class="hljs-comment"># é€‚é…é€šç”¨é—®ç­”é•¿åº¦</span>
            <span class="hljs-attr">connect_timeout:</span> <span class="hljs-string">60s</span>    <span class="hljs-comment"># è¿æ¥è¶…æ—¶</span>
            <span class="hljs-attr">read_timeout:</span> <span class="hljs-string">5m</span>        <span class="hljs-comment"># è¯»å–è¶…æ—¶</span>
          <span class="hljs-attr">context:</span>
            <span class="hljs-attr">expire-minutes:</span> <span class="hljs-number">120</span>     <span class="hljs-comment"># ä¼šè¯ä¸Šä¸‹æ–‡è¿‡æœŸæ—¶é—´</span>
            <span class="hljs-attr">max-message-count:</span> <span class="hljs-number">20</span>   <span class="hljs-comment"># æœ€å¤§ä¸Šä¸‹æ–‡æ¶ˆæ¯æ•°</span>
        <span class="hljs-comment"># æ¨¡å‹2ï¼šæ·±åº¦æ±‚ç´¢ï¼ˆæŠ€æœ¯/ä»£ç åœºæ™¯ä¸“ç”¨ï¼‰</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">code:</span> <span class="hljs-string">deepseek-r1</span>
          <span class="hljs-attr">model:</span> <span class="hljs-string">deepseek-r1:8b</span>
          <span class="hljs-attr">options:</span>
            <span class="hljs-attr">temperature:</span> <span class="hljs-number">0.5</span>        <span class="hljs-comment"># ä¸­ç­‰éšæœºæ€§ï¼Œå…¼é¡¾åˆ›æ„ä¸ç²¾å‡†</span>
            <span class="hljs-attr">max_tokens:</span> <span class="hljs-number">3000</span>        <span class="hljs-comment"># é€‚é…é•¿æ–‡æœ¬æŠ€æœ¯å›ç­”</span>
            <span class="hljs-attr">connect_timeout:</span> <span class="hljs-string">60s</span>
            <span class="hljs-attr">read_timeout:</span> <span class="hljs-string">5m</span>
          <span class="hljs-attr">context:</span>
            <span class="hljs-attr">expire-minutes:</span> <span class="hljs-number">120</span>
            <span class="hljs-attr">max-message-count:</span> <span class="hljs-number">20</span>
        <span class="hljs-comment"># æ‰©å±•ï¼šæ–°å¢æ¨¡å‹ä»…éœ€æ·»åŠ æ­¤èŠ‚ç‚¹ï¼Œæ— éœ€ä¿®æ”¹ä»£ç </span>
        <span class="hljs-comment"># - code: llama3-8b</span>
        <span class="hljs-comment">#   model: llama3:8b-instruct</span>
        <span class="hljs-comment">#   options:</span>
        <span class="hljs-comment">#     temperature: 0.4</span>
        <span class="hljs-comment">#     max_tokens: 2500</span>
        <span class="hljs-comment">#   context:</span>
        <span class="hljs-comment">#     expire-minutes: 120</span>
        <span class="hljs-comment">#     max-message-count: 20</span>
</code></pre>
<h4 data-id="heading-5">2. å¤šæ¨¡å‹é…ç½®ç»‘å®šç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> org.springframework.util.Assert;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * Ollamaå¤šæ¨¡å‹é…ç½®ç»‘å®šç±»ã€ç”Ÿäº§çº§ã€‘
 * èŒè´£ï¼šç»‘å®šYAMLä¸­çš„å¤šæ¨¡å‹é…ç½®ï¼Œæä¾›ç±»å‹å®‰å…¨çš„é…ç½®è®¿é—®
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@ConfigurationProperties(prefix = "spring.ai.ollama")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OllamaMultiModelProperties</span> {
    <span class="hljs-comment">// OllamaåŸºç¡€æœåŠ¡åœ°å€ï¼ˆå¿…å¡«ï¼‰</span>
    <span class="hljs-keyword">private</span> String baseUrl;
    <span class="hljs-comment">// å¤šChatæ¨¡å‹é…ç½®åˆ—è¡¨ï¼ˆè‡³å°‘é…ç½®1ä¸ªæ¨¡å‹ï¼‰</span>
    <span class="hljs-keyword">private</span> List&lt;OllamaChatModelConfig&gt; chats;

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–æ ¡éªŒï¼šç¡®ä¿æ ¸å¿ƒé…ç½®éç©º
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterPropertiesSet</span><span class="hljs-params">()</span> {
        Assert.hasText(baseUrl, <span class="hljs-string">"spring.ai.ollama.base-url ä¸èƒ½ä¸ºç©º"</span>);
        Assert.notEmpty(chats, <span class="hljs-string">"spring.ai.ollama.chats è‡³å°‘é…ç½®ä¸€ä¸ªæ¨¡å‹"</span>);
        <span class="hljs-comment">// æ ¡éªŒæ¯ä¸ªæ¨¡å‹çš„æ ¸å¿ƒé…ç½®</span>
        <span class="hljs-keyword">for</span> (OllamaChatModelConfig config : chats) {
            Assert.hasText(config.getCode(), <span class="hljs-string">"æ¨¡å‹ç¼–ç ï¼ˆcodeï¼‰ä¸èƒ½ä¸ºç©º"</span>);
            Assert.hasText(config.getModel(), <span class="hljs-string">"æ¨¡å‹åç§°ï¼ˆmodelï¼‰ä¸èƒ½ä¸ºç©º"</span>);
            Assert.notNull(config.getOptions(), <span class="hljs-string">"æ¨¡å‹å‚æ•°ï¼ˆoptionsï¼‰ä¸èƒ½ä¸ºç©º"</span>);
        }
    }

    <span class="hljs-comment">/**
     * å•ä¸ªChatæ¨¡å‹çš„å®Œæ•´é…ç½®é¡¹
     */</span>
    <span class="hljs-meta">@Data</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OllamaChatModelConfig</span> {
        <span class="hljs-comment">// æ¨¡å‹å”¯ä¸€ç¼–ç ï¼ˆå¦‚qwen2-7bï¼Œç”¨äºå‰ç«¯/ä¸šåŠ¡å±‚æŒ‡å®šæ¨¡å‹ï¼‰</span>
        <span class="hljs-keyword">private</span> String code;
        <span class="hljs-comment">// Ollamaä¸­æ³¨å†Œçš„æ¨¡å‹åç§°ï¼ˆå¦‚qwen2:7b-instructï¼‰</span>
        <span class="hljs-keyword">private</span> String model;
        <span class="hljs-comment">// æ¨¡å‹æ¨ç†å‚æ•°ï¼ˆæ¸©åº¦ã€æœ€å¤§ç”Ÿæˆé•¿åº¦ç­‰ï¼‰</span>
        <span class="hljs-keyword">private</span> OllamaChatOptionsConfig options;
        <span class="hljs-comment">// ä¼šè¯ä¸Šä¸‹æ–‡é…ç½®ï¼ˆè¿‡æœŸæ—¶é—´ã€æœ€å¤§æ¶ˆæ¯æ•°ï¼‰</span>
        <span class="hljs-keyword">private</span> OllamaChatContextConfig context;

        <span class="hljs-comment">/**
         * æ¨¡å‹æ¨ç†å‚æ•°é…ç½®
         */</span>
        <span class="hljs-meta">@Data</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OllamaChatOptionsConfig</span> {
            <span class="hljs-comment">// æ¸©åº¦ï¼š0-1ï¼Œå€¼è¶Šé«˜å›ç­”è¶Šéšæœºï¼Œè¶Šä½è¶Šç²¾å‡†</span>
            <span class="hljs-keyword">private</span> <span class="hljs-type">Double</span> <span class="hljs-variable">temperature</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.3</span>; <span class="hljs-comment">// é»˜è®¤å€¼</span>
            <span class="hljs-comment">// æœ€å¤§ç”Ÿæˆé•¿åº¦ï¼šé™åˆ¶å•æ¬¡å›ç­”çš„tokenæ•°</span>
            <span class="hljs-keyword">private</span> <span class="hljs-type">Integer</span> <span class="hljs-variable">maxTokens</span> <span class="hljs-operator">=</span> <span class="hljs-number">2000</span>; <span class="hljs-comment">// é»˜è®¤å€¼</span>
            <span class="hljs-comment">// è¿æ¥è¶…æ—¶ï¼ˆå¦‚60sï¼‰</span>
            <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">connectTimeout</span> <span class="hljs-operator">=</span> <span class="hljs-string">"60s"</span>; <span class="hljs-comment">// é»˜è®¤å€¼</span>
            <span class="hljs-comment">// è¯»å–è¶…æ—¶ï¼ˆå¦‚5mï¼‰</span>
            <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">readTimeout</span> <span class="hljs-operator">=</span> <span class="hljs-string">"5m"</span>; <span class="hljs-comment">// é»˜è®¤å€¼</span>
        }

        <span class="hljs-comment">/**
         * ä¼šè¯ä¸Šä¸‹æ–‡é…ç½®
         */</span>
        <span class="hljs-meta">@Data</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OllamaChatContextConfig</span> {
            <span class="hljs-comment">// ä¸Šä¸‹æ–‡è¿‡æœŸæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰</span>
            <span class="hljs-keyword">private</span> <span class="hljs-type">Integer</span> <span class="hljs-variable">expireMinutes</span> <span class="hljs-operator">=</span> <span class="hljs-number">120</span>; <span class="hljs-comment">// é»˜è®¤å€¼</span>
            <span class="hljs-comment">// æœ€å¤§ä¸Šä¸‹æ–‡æ¶ˆæ¯æ•°ï¼ˆé¿å…ä¸Šä¸‹æ–‡è¿‡é•¿ï¼‰</span>
            <span class="hljs-keyword">private</span> <span class="hljs-type">Integer</span> <span class="hljs-variable">maxMessageCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span>; <span class="hljs-comment">// é»˜è®¤å€¼</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-6">3. å¤šæ¨¡å‹å·¥å‚é…ç½®ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Primary;
<span class="hljs-keyword">import</span> org.springframework.ai.ollama.OllamaApi;
<span class="hljs-keyword">import</span> org.springframework.ai.ollama.OllamaChatModel;
<span class="hljs-keyword">import</span> org.springframework.ai.ollama.OllamaOptions;
<span class="hljs-keyword">import</span> org.springframework.ai.observation.ObservationRegistry;
<span class="hljs-keyword">import</span> org.springframework.ai.tool.ToolCallingManager;
<span class="hljs-keyword">import</span> org.springframework.ai.model.ModelManagementOptions;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> javax.annotation.Resource;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> java.util.Optional;

<span class="hljs-comment">/**
 * å¤šLLMæ¨¡å‹é…ç½®ç±»ã€ç”Ÿäº§çº§ã€‘
 * èŒè´£ï¼šæ³¨å†Œå¤šæ¨¡å‹å®ä¾‹ã€æä¾›åŠ¨æ€è·å–ChatClientçš„å·¥å‚ï¼Œæ”¯æ’‘æ¨¡å‹åˆ‡æ¢
 */</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatClientConfig</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> OllamaMultiModelProperties ollamaMultiModelProperties;

    <span class="hljs-comment">// ========== 1. æ³¨å†Œé»˜è®¤Chatæ¨¡å‹ï¼ˆå…¼å®¹åŸæœ‰ä¸šåŠ¡é€»è¾‘ï¼‰ ==========</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-meta">@Primary</span>
    <span class="hljs-keyword">public</span> OllamaChatModel <span class="hljs-title function_">defaultOllamaChatModel</span><span class="hljs-params">()</span> {
        log.info(<span class="hljs-string">"åˆå§‹åŒ–é»˜è®¤Chatæ¨¡å‹ï¼šqwen2-7b"</span>);
        <span class="hljs-keyword">return</span> createOllamaChatModel(<span class="hljs-string">"qwen2-7b"</span>);
    }

    <span class="hljs-comment">// ========== 2. æ³¨å†Œå¤šæ¨¡å‹æ˜ å°„è¡¨ï¼ˆæ ¸å¿ƒï¼šå­˜å‚¨æ‰€æœ‰æ¨¡å‹å®ä¾‹ï¼‰ ==========</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Map&lt;String, OllamaChatModel&gt; <span class="hljs-title function_">ollamaChatModelMap</span><span class="hljs-params">()</span> {
        Map&lt;String, OllamaChatModel&gt; modelMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-comment">// éå†é…ç½®ï¼Œåˆå§‹åŒ–æ‰€æœ‰æ¨¡å‹å®ä¾‹</span>
        <span class="hljs-keyword">for</span> (OllamaMultiModelProperties.OllamaChatModelConfig config : ollamaMultiModelProperties.getChats()) {
            <span class="hljs-type">String</span> <span class="hljs-variable">modelCode</span> <span class="hljs-operator">=</span> config.getCode();
            <span class="hljs-keyword">try</span> {
                <span class="hljs-type">OllamaChatModel</span> <span class="hljs-variable">chatModel</span> <span class="hljs-operator">=</span> createOllamaChatModel(modelCode);
                modelMap.put(modelCode, chatModel);
                log.info(<span class="hljs-string">"æˆåŠŸåˆå§‹åŒ–æ¨¡å‹ï¼š{}ï¼Œå¯¹åº”Ollamaæ¨¡å‹åï¼š{}"</span>, modelCode, config.getModel());
            } <span class="hljs-keyword">catch</span> (Exception e) {
                log.error(<span class="hljs-string">"åˆå§‹åŒ–æ¨¡å‹ã€{}ã€‘å¤±è´¥ï¼Œè·³è¿‡è¯¥æ¨¡å‹"</span>, modelCode, e);
                <span class="hljs-comment">// å•ä¸ªæ¨¡å‹åˆå§‹åŒ–å¤±è´¥ä¸å½±å“æ•´ä½“æµç¨‹</span>
                <span class="hljs-keyword">continue</span>;
            }
        }
        <span class="hljs-comment">// æ ¡éªŒæ¨¡å‹æ˜ å°„è¡¨éç©º</span>
        <span class="hljs-keyword">if</span> (modelMap.isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æœªæˆåŠŸåˆå§‹åŒ–ä»»ä½•LLMæ¨¡å‹ï¼Œè¯·æ£€æŸ¥é…ç½®"</span>);
        }
        <span class="hljs-keyword">return</span> modelMap;
    }

    <span class="hljs-comment">// ========== 3. æ³¨å†ŒChatClientå·¥å‚ï¼ˆå¯¹å¤–æä¾›æ¨¡å‹åˆ‡æ¢èƒ½åŠ›ï¼‰ ==========</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> ChatClientFactory <span class="hljs-title function_">chatClientFactory</span><span class="hljs-params">(Map&lt;String, OllamaChatModel&gt; ollamaChatModelMap)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatClientFactory</span>(ollamaChatModelMap);
    }

    <span class="hljs-comment">// ========== 4. å…¼å®¹åŸæœ‰ChatClient.Builderï¼ˆé¿å…ä¸šåŠ¡ä»£ç æ”¹é€ ï¼‰ ==========</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> org.springframework.ai.chat.ChatClient.Builder <span class="hljs-title function_">defaultChatClientBuilder</span><span class="hljs-params">(OllamaChatModel defaultOllamaChatModel)</span> {
        <span class="hljs-keyword">return</span> org.springframework.ai.chat.ChatClient.builder(defaultOllamaChatModel);
    }

    <span class="hljs-comment">// ========== ç§æœ‰æ–¹æ³•ï¼šæ ¹æ®æ¨¡å‹ç¼–ç åˆ›å»ºOllamaChatModelå®ä¾‹ ==========</span>
    <span class="hljs-keyword">private</span> OllamaChatModel <span class="hljs-title function_">createOllamaChatModel</span><span class="hljs-params">(String modelCode)</span> {
        <span class="hljs-comment">// 1. æ ¹æ®ç¼–ç æŸ¥æ‰¾æ¨¡å‹é…ç½®ï¼ˆä¼˜åŒ–ï¼šä½¿ç”¨æµå¼APIï¼Œé¿å…å¾ªç¯ï¼‰</span>
        Optional&lt;OllamaMultiModelProperties.OllamaChatModelConfig&gt; modelConfigOpt =
                ollamaMultiModelProperties.getChats().stream()
                        .filter(config -&gt; modelCode.equals(config.getCode()))
                        .findFirst();
        <span class="hljs-comment">// å…œåº•ï¼šä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å‹é…ç½®</span>
        OllamaMultiModelProperties.<span class="hljs-type">OllamaChatModelConfig</span> <span class="hljs-variable">modelConfig</span> <span class="hljs-operator">=</span> modelConfigOpt.orElseGet(() -&gt; {
            log.warn(<span class="hljs-string">"æœªæ‰¾åˆ°æ¨¡å‹ã€{}ã€‘çš„é…ç½®ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å‹ä½œä¸ºå…œåº•"</span>, modelCode);
            <span class="hljs-keyword">return</span> ollamaMultiModelProperties.getChats().get(<span class="hljs-number">0</span>);
        });

        <span class="hljs-comment">// 2. æ„å»ºOllama APIå®¢æˆ·ç«¯ï¼ˆåŸºç¡€åœ°å€ç»Ÿä¸€é…ç½®ï¼‰</span>
        <span class="hljs-type">OllamaApi</span> <span class="hljs-variable">ollamaApi</span> <span class="hljs-operator">=</span> OllamaApi.builder()
                .baseUrl(ollamaMultiModelProperties.getBaseUrl())
                .build();

        <span class="hljs-comment">// 3. æ„å»ºæ¨¡å‹å‚æ•°ï¼ˆåŠ¨æ€è¯»å–é…ç½®ï¼Œæ”¯æŒæ‰€æœ‰Ollamaå‚æ•°ï¼‰</span>
        <span class="hljs-type">OllamaOptions</span> <span class="hljs-variable">options</span> <span class="hljs-operator">=</span> OllamaOptions.builder()
                .model(modelConfig.getModel())
                .temperature(modelConfig.getOptions().getTemperature())
                .build();
        options.setMaxTokens(modelConfig.getOptions().getMaxTokens());

        <span class="hljs-comment">// 4. å›ºå®šé…ç½®ï¼ˆå·¥å…·è°ƒç”¨ã€è§‚æµ‹ã€æ¨¡å‹ç®¡ç†ï¼‰</span>
        <span class="hljs-type">ToolCallingManager</span> <span class="hljs-variable">toolCallingManager</span> <span class="hljs-operator">=</span> ToolCallingManager.builder().build();
        <span class="hljs-type">ModelManagementOptions</span> <span class="hljs-variable">modelManagementOptions</span> <span class="hljs-operator">=</span> ModelManagementOptions.builder().build();
        <span class="hljs-type">ObservationRegistry</span> <span class="hljs-variable">observationRegistry</span> <span class="hljs-operator">=</span> ObservationRegistry.create();

        <span class="hljs-comment">// 5. åˆ›å»ºå¹¶è¿”å›æ¨¡å‹å®ä¾‹</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OllamaChatModel</span>(ollamaApi, options, toolCallingManager, observationRegistry, modelManagementOptions);
    }

    <span class="hljs-comment">// ========== æ ¸å¿ƒå†…éƒ¨ç±»ï¼šChatClientå·¥å‚ï¼ˆå¯¹å¤–æš´éœ²æ¨¡å‹åˆ‡æ¢èƒ½åŠ›ï¼‰ ==========</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatClientFactory</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, OllamaChatModel&gt; chatModelMap;
        <span class="hljs-comment">// é»˜è®¤æ¨¡å‹ç¼–ç ï¼ˆå¯é…ç½®åŒ–ï¼‰</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DEFAULT_MODEL_CODE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"qwen2-7b"</span>;

        <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatClientFactory</span><span class="hljs-params">(Map&lt;String, OllamaChatModel&gt; chatModelMap)</span> {
            <span class="hljs-built_in">this</span>.chatModelMap = chatModelMap;
        }

        <span class="hljs-comment">/**
         * æ ¹æ®æ¨¡å‹ç¼–ç åŠ¨æ€è·å–ChatClientï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰
         * <span class="hljs-doctag">@param</span> modelCode æ¨¡å‹ç¼–ç ï¼ˆqwen2-7b/deepseek-r1ï¼‰
         * <span class="hljs-doctag">@return</span> ç»‘å®šå¯¹åº”æ¨¡å‹çš„ChatClient
         */</span>
        <span class="hljs-keyword">public</span> org.springframework.ai.chat.ChatClient <span class="hljs-title function_">getChatClient</span><span class="hljs-params">(String modelCode)</span> {
            <span class="hljs-comment">// ç©ºå€¼å¤„ç†ï¼šä½¿ç”¨é»˜è®¤æ¨¡å‹</span>
            <span class="hljs-keyword">if</span> (modelCode == <span class="hljs-literal">null</span> || modelCode.isBlank()) {
                log.info(<span class="hljs-string">"æ¨¡å‹ç¼–ç ä¸ºç©ºï¼Œä½¿ç”¨é»˜è®¤æ¨¡å‹ï¼š{}"</span>, DEFAULT_MODEL_CODE);
                <span class="hljs-keyword">return</span> getDefaultChatClient();
            }
            <span class="hljs-comment">// è·å–æŒ‡å®šæ¨¡å‹</span>
            <span class="hljs-type">OllamaChatModel</span> <span class="hljs-variable">chatModel</span> <span class="hljs-operator">=</span> chatModelMap.get(modelCode);
            <span class="hljs-keyword">if</span> (chatModel == <span class="hljs-literal">null</span>) {
                log.warn(<span class="hljs-string">"æ¨¡å‹ã€{}ã€‘ä¸å­˜åœ¨ï¼Œé™çº§åˆ°é»˜è®¤æ¨¡å‹ï¼š{}"</span>, modelCode, DEFAULT_MODEL_CODE);
                <span class="hljs-keyword">return</span> getDefaultChatClient();
            }
            log.debug(<span class="hljs-string">"ä½¿ç”¨æ¨¡å‹ã€{}ã€‘åˆ›å»ºChatClient"</span>, modelCode);
            <span class="hljs-keyword">return</span> org.springframework.ai.chat.ChatClient.builder(chatModel).build();
        }

        <span class="hljs-comment">/**
         * è·å–é»˜è®¤ChatClientï¼ˆå…¼å®¹åŸæœ‰é€»è¾‘ï¼‰
         */</span>
        <span class="hljs-keyword">public</span> org.springframework.ai.chat.ChatClient <span class="hljs-title function_">getDefaultChatClient</span><span class="hljs-params">()</span> {
            <span class="hljs-type">OllamaChatModel</span> <span class="hljs-variable">defaultModel</span> <span class="hljs-operator">=</span> chatModelMap.get(DEFAULT_MODEL_CODE);
            <span class="hljs-keyword">return</span> org.springframework.ai.chat.ChatClient.builder(defaultModel).build();
        }

        <span class="hljs-comment">/**
         * è·å–æ‰€æœ‰å¯ç”¨æ¨¡å‹ç¼–ç ï¼ˆç”¨äºå‰ç«¯å±•ç¤º/æ ¡éªŒï¼‰
         */</span>
        <span class="hljs-keyword">public</span> Map&lt;String, String&gt; <span class="hljs-title function_">listAllModels</span><span class="hljs-params">()</span> {
            Map&lt;String, String&gt; modelList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            <span class="hljs-keyword">for</span> (Map.Entry&lt;String, OllamaChatModel&gt; entry : chatModelMap.entrySet()) {
                <span class="hljs-type">String</span> <span class="hljs-variable">modelCode</span> <span class="hljs-operator">=</span> entry.getKey();
                <span class="hljs-type">String</span> <span class="hljs-variable">modelName</span> <span class="hljs-operator">=</span> entry.getValue().getDefaultOptions().getModel();
                modelList.put(modelCode, modelName);
            }
            <span class="hljs-keyword">return</span> modelList;
        }
    }
}
</code></pre>
<h4 data-id="heading-7">4. å¤šæ¨¡å‹è°ƒç”¨æ ¸å¿ƒä¸šåŠ¡ä»£ç ï¼ˆç”Ÿäº§çº§ä¼˜åŒ–ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestBody;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.messages.ChatMessage;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.prompt.Prompt;
<span class="hljs-keyword">import</span> javax.annotation.Resource;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * å¤šæ¨¡å‹é—®ç­”æ ¸å¿ƒControllerã€ç”Ÿäº§çº§ã€‘
 * èŒè´£ï¼šæ¥æ”¶é—®ç­”è¯·æ±‚ï¼Œæ ¹æ®æ¨¡å‹ç¼–ç åˆ‡æ¢LLMæ¨¡å‹ï¼Œè¿”å›å›ç­”ç»“æœ
 */</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/api/rag")</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RagChatController</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClientConfig.ChatClientFactory chatClientFactory;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> RedisChatContextManager redisChatContextManager;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> AgentThinker agentThinker;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> AgentExecutor agentExecutor;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> AgentSummarizer agentSummarizer;

    <span class="hljs-comment">/**
     * æ ¸å¿ƒé—®ç­”æ¥å£ï¼ˆæ”¯æŒå¤šæ¨¡å‹åˆ‡æ¢ï¼‰
     * <span class="hljs-doctag">@param</span> param é—®ç­”å‚æ•°ï¼ˆåŒ…å«queryã€sessionIdã€modelCodeï¼‰
     */</span>
    <span class="hljs-meta">@PostMapping("/chat")</span>
    <span class="hljs-keyword">public</span> Result&lt;String&gt; <span class="hljs-title function_">chat</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> AgentChatParam param)</span> {
        <span class="hljs-comment">// 1. å‚æ•°æ ¡éªŒ</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">query</span> <span class="hljs-operator">=</span> param.getQuery();
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionId</span> <span class="hljs-operator">=</span> param.getSessionId();
        <span class="hljs-type">String</span> <span class="hljs-variable">modelCode</span> <span class="hljs-operator">=</span> param.getModelCode();
        <span class="hljs-keyword">if</span> (query == <span class="hljs-literal">null</span> || query.isBlank()) {
            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"æé—®å†…å®¹ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">if</span> (sessionId == <span class="hljs-literal">null</span> || sessionId.isBlank()) {
            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"ä¼šè¯IDä¸èƒ½ä¸ºç©º"</span>);
        }
        log.info(<span class="hljs-string">"å¤„ç†é—®ç­”è¯·æ±‚ï¼šsessionId={}, query={}, ç›®æ ‡æ¨¡å‹={}"</span>, sessionId, query, modelCode);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 2. Agentæ€è€ƒï¼šå†³ç­–è°ƒç”¨å·¥å…·/ç›´æ¥å›ç­”</span>
            List&lt;ThinkResult&gt; thinkResults = agentThinker.think(query, sessionId);
            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">toolResults</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
            <span class="hljs-keyword">for</span> (ThinkResult thinkResult : thinkResults) {
                <span class="hljs-keyword">if</span> (<span class="hljs-string">"DIRECT_ANSWER"</span>.equals(thinkResult.getAction())) {
                    toolResults.append(thinkResult.getContent());
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// 3. Agentæ‰§è¡Œï¼šè°ƒç”¨å·¥å…·ï¼ˆå¦‚çŸ¥è¯†åº“æ£€ç´¢ï¼‰</span>
                    <span class="hljs-type">ToolResult</span> <span class="hljs-variable">toolResult</span> <span class="hljs-operator">=</span> agentExecutor.execute(thinkResult);
                    <span class="hljs-keyword">if</span> (toolResult.isSuccess()) {
                        toolResults.append(toolResult.getContent());
                    } <span class="hljs-keyword">else</span> {
                        log.error(<span class="hljs-string">"å·¥å…·è°ƒç”¨å¤±è´¥ï¼š{}"</span>, toolResult.getErrorMsg());
                        <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"å¤„ç†å¤±è´¥ï¼š"</span> + toolResult.getErrorMsg());
                    }
                }
            }

            <span class="hljs-comment">// 4. åŠ¨æ€è·å–ChatClientï¼ˆæ ¹æ®æ¨¡å‹ç¼–ç åˆ‡æ¢ï¼‰</span>
            <span class="hljs-type">ChatClient</span> <span class="hljs-variable">chatClient</span> <span class="hljs-operator">=</span> chatClientFactory.getChatClient(modelCode);
            <span class="hljs-comment">// 5. Agentæ€»ç»“ï¼šè°ƒç”¨æŒ‡å®šæ¨¡å‹ç”Ÿæˆæœ€ç»ˆå›ç­”</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> agentSummarizer.summarize(query, toolResults.toString(), sessionId, chatClient);

            <span class="hljs-comment">// 6. ä¿å­˜ä¼šè¯ä¸Šä¸‹æ–‡åˆ°Redis</span>
            redisChatContextManager.updateChatContext(sessionId, ChatMessage.user(query));
            redisChatContextManager.updateChatContext(sessionId, ChatMessage.assistant(answer));

            log.info(<span class="hljs-string">"é—®ç­”è¯·æ±‚å¤„ç†å®Œæˆï¼šsessionId={}, æ¨¡å‹={}, å›ç­”é•¿åº¦={}"</span>, sessionId, modelCode, answer.length());
            <span class="hljs-keyword">return</span> Result.success(answer);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"é—®ç­”è¯·æ±‚å¤„ç†å¤±è´¥ï¼šsessionId={}"</span>, sessionId, e);
            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"å¤„ç†å¤±è´¥ï¼š"</span> + e.getMessage());
        }
    }

    <span class="hljs-comment">/**
     * æ¨¡å‹åˆ—è¡¨æŸ¥è¯¢æ¥å£ï¼ˆç”¨äºå‰ç«¯é€‰æ‹©æ¨¡å‹ï¼‰
     */</span>
    <span class="hljs-meta">@PostMapping("/models/list")</span>
    <span class="hljs-keyword">public</span> Result&lt;Map&lt;String, String&gt;&gt; <span class="hljs-title function_">listModels</span><span class="hljs-params">()</span> {
        Map&lt;String, String&gt; modelList = chatClientFactory.listAllModels();
        <span class="hljs-keyword">return</span> Result.success(modelList);
    }
}
</code></pre>
<h4 data-id="heading-8">5. æ¨¡å‹æ€»ç»“å™¨é€‚é…å¤šæ¨¡å‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.ai.chat.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.prompt.Prompt;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span> javax.annotation.Resource;

<span class="hljs-comment">/**
 * Agentæ€»ç»“å™¨ï¼ˆé€‚é…å¤šæ¨¡å‹ï¼‰
 */</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentSummarizer</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClientConfig.ChatClientFactory chatClientFactory;

    <span class="hljs-comment">/**
     * ç”Ÿæˆæœ€ç»ˆå›ç­”ï¼ˆæ”¯æŒæŒ‡å®šæ¨¡å‹ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">summarize</span><span class="hljs-params">(String query, String toolResults, String sessionId, ChatClient chatClient)</span> {
        <span class="hljs-comment">// æ„å»ºæç¤ºè¯ï¼ˆç»“åˆå·¥å…·ç»“æœ+ä¸Šä¸‹æ–‡ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">promptContent</span> <span class="hljs-operator">=</span> buildSummaryPrompt(query, toolResults, sessionId);
        <span class="hljs-comment">// è°ƒç”¨æŒ‡å®šæ¨¡å‹ç”Ÿæˆå›ç­”</span>
        <span class="hljs-keyword">return</span> chatClient.prompt(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Prompt</span>(prompt))
                .call().chatResponse()
                .getResult()
                .getOutput()
                .getText();
    }

    <span class="hljs-comment">/**
     * å…¼å®¹åŸæœ‰æ–¹æ³•ï¼ˆä½¿ç”¨é»˜è®¤æ¨¡å‹ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">summarize</span><span class="hljs-params">(String query, String toolResults, String sessionId)</span> {
        <span class="hljs-type">ChatClient</span> <span class="hljs-variable">defaultClient</span> <span class="hljs-operator">=</span> chatClientFactory.getDefaultChatClient();
        <span class="hljs-keyword">return</span> summarize(query, toolResults, sessionId, defaultClient);
    }

    <span class="hljs-comment">/**
     * æ„å»ºæ€»ç»“æç¤ºè¯
     */</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">buildSummaryPrompt</span><span class="hljs-params">(String query, String toolResults, String sessionId)</span> {
        <span class="hljs-comment">// è¡¥å……ä¸Šä¸‹æ–‡ã€å·¥å…·ç»“æœï¼Œæ„å»ºå®Œæ•´æç¤ºè¯</span>
        <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">"æ ¹æ®ä»¥ä¸‹ä¿¡æ¯å›ç­”é—®é¢˜ï¼š\nå·¥å…·ç»“æœï¼š%s\né—®é¢˜ï¼š%s\nè¦æ±‚ï¼šå›ç­”å‡†ç¡®ã€ç®€æ´ï¼Œç¬¦åˆä¸­æ–‡è¡¨è¾¾ä¹ æƒ¯"</span>,
                toolResults, query);
    }
}
</code></pre>
<h4 data-id="heading-9">6. æ ¸å¿ƒå‚æ•°å®ä½“ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-comment">/**
 * é—®ç­”è¯·æ±‚å‚æ•°å®ä½“
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentChatParam</span> {
    <span class="hljs-comment">/** ç”¨æˆ·æé—®å†…å®¹ */</span>
    <span class="hljs-keyword">private</span> String query;
    <span class="hljs-comment">/** ä¼šè¯IDï¼ˆç”¨äºä¸Šä¸‹æ–‡ç®¡ç†ï¼‰ */</span>
    <span class="hljs-keyword">private</span> String sessionId;
    <span class="hljs-comment">/** æ¨¡å‹ç¼–ç ï¼ˆå¦‚qwen2-7b/deepseek-r1ï¼‰ */</span>
    <span class="hljs-keyword">private</span> String modelCode;
}
</code></pre>
<h3 data-id="heading-10">å››ã€å¤šæ¨¡å‹åˆ‡æ¢å®Œæ•´é“¾è·¯ï¼ˆRAGé›†æˆï¼‰</h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> å‰ç«¯è¯·æ±‚ï¼šä¼ å…¥query + sessionId + modelCodeï¼ˆå¦‚deepseek-r1ï¼‰
<span class="hljs-bullet">2.</span> å‚æ•°æ ¡éªŒï¼šéªŒè¯å¿…å¡«å‚æ•°ï¼Œæ—¥å¿—è®°å½•è¯·æ±‚ä¿¡æ¯
<span class="hljs-bullet">3.</span> Agentæ€è€ƒï¼šå†³ç­–è°ƒç”¨çŸ¥è¯†åº“æ£€ç´¢/ç›´æ¥å›ç­”
<span class="hljs-bullet">4.</span> å·¥å…·æ‰§è¡Œï¼šè°ƒç”¨çŸ¥è¯†åº“æ£€ç´¢ï¼Œè·å–ç›¸å…³æ–‡æœ¬ç‰‡æ®µ
<span class="hljs-bullet">5.</span> æ¨¡å‹å·¥å‚ï¼šæ ¹æ®modelCodeè·å–å¯¹åº”çš„ChatClient
<span class="hljs-bullet">6.</span> ç”Ÿæˆå›ç­”ï¼šè°ƒç”¨æŒ‡å®šæ¨¡å‹ï¼Œç»“åˆå·¥å…·ç»“æœç”Ÿæˆå›ç­”
<span class="hljs-bullet">7.</span> ä¸Šä¸‹æ–‡ä¿å­˜ï¼šå°†é—®ç­”è®°å½•å­˜å…¥Redisï¼Œæ”¯æ’‘å¤šè½®å¯¹è¯
<span class="hljs-bullet">8.</span> è¿”å›ç»“æœï¼šè¿”å›å›ç­”å†…å®¹ï¼Œå‰ç«¯å±•ç¤º
</code></pre>
<h3 data-id="heading-11">äº”ã€ç”Ÿäº§çº§è¿›é˜¶æ‰©å±•ï¼ˆå¯é€‰ï¼‰</h3>
<h4 data-id="heading-12">æ‰©å±•1ï¼šæ¨¡å‹è·¯ç”±ç­–ç•¥</h4>
<p>æ ¹æ®æé—®å†…å®¹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼ˆæ— éœ€å‰ç«¯æŒ‡å®šï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æ¨¡å‹è·¯ç”±ç­–ç•¥ï¼ˆç¤ºä¾‹ï¼‰
 */</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModelRouter</span> {
    <span class="hljs-comment">/**
     * æ ¹æ®æé—®å†…å®¹è‡ªåŠ¨é€‰æ‹©æ¨¡å‹
     */</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">routeModel</span><span class="hljs-params">(String query)</span> {
        <span class="hljs-comment">// æŠ€æœ¯ç›¸å…³é—®é¢˜â†’deepseek-r1</span>
        <span class="hljs-keyword">if</span> (query.contains(<span class="hljs-string">"ä»£ç "</span>) || query.contains(<span class="hljs-string">"æŠ€æœ¯"</span>) || query.contains(<span class="hljs-string">"æ¥å£"</span>)) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"deepseek-r1"</span>;
        }
        <span class="hljs-comment">// é€šç”¨é—®é¢˜â†’qwen2-7b</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"qwen2-7b"</span>;
    }
}
</code></pre>
<h4 data-id="heading-13">æ‰©å±•2ï¼šæ¨¡å‹å¥åº·æ£€æŸ¥</h4>
<p>å®šæ—¶æ£€æŸ¥æ¨¡å‹å¯ç”¨æ€§ï¼Œå¼‚å¸¸æ—¶è‡ªåŠ¨åˆ‡æ¢ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æ¨¡å‹å¥åº·æ£€æŸ¥ï¼ˆç¤ºä¾‹ï¼‰
 */</span>
<span class="hljs-meta">@Scheduled(fixedRate = 60000)</span> <span class="hljs-comment">// æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkModelHealth</span><span class="hljs-params">()</span> {
    Map&lt;String, OllamaChatModel&gt; modelMap = ollamaChatModelMap();
    <span class="hljs-keyword">for</span> (Map.Entry&lt;String, OllamaChatModel&gt; entry : modelMap.entrySet()) {
        <span class="hljs-type">String</span> <span class="hljs-variable">modelCode</span> <span class="hljs-operator">=</span> entry.getKey();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å‘é€æµ‹è¯•è¯·æ±‚ï¼Œæ£€æŸ¥æ¨¡å‹æ˜¯å¦å¯ç”¨</span>
            entry.getValue().call(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Prompt</span>(<span class="hljs-string">"hello"</span>)).getResult();
            log.info(<span class="hljs-string">"æ¨¡å‹ã€{}ã€‘å¥åº·æ£€æŸ¥é€šè¿‡"</span>, modelCode);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ¨¡å‹ã€{}ã€‘å¥åº·æ£€æŸ¥å¤±è´¥"</span>, modelCode, e);
            <span class="hljs-comment">// æ ‡è®°æ¨¡å‹ä¸å¯ç”¨ï¼Œè·¯ç”±æ—¶è·³è¿‡</span>
            unhealthyModels.add(modelCode);
        }
    }
}
</code></pre>
<h4 data-id="heading-14">æ‰©å±•3ï¼šæ¨¡å‹è°ƒç”¨é™æµ</h4>
<p>é’ˆå¯¹ä¸åŒæ¨¡å‹è®¾ç½®é™æµè§„åˆ™ï¼Œé¿å…èµ„æºè€—å°½ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨Sentinelå®ç°æ¨¡å‹çº§é™æµ</span>
<span class="hljs-meta">@SentinelResource(value = "chat_qwen2_7b", fallback = "defaultFallback")</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">chatWithQwen2</span><span class="hljs-params">(String query, String sessionId)</span> {
    <span class="hljs-comment">// è°ƒç”¨qwen2-7bæ¨¡å‹çš„é€»è¾‘</span>
}

<span class="hljs-meta">@SentinelResource(value = "chat_deepseek_r1", fallback = "defaultFallback")</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">chatWithDeepseek</span><span class="hljs-params">(String query, String sessionId)</span> {
    <span class="hljs-comment">// è°ƒç”¨deepseek-r1æ¨¡å‹çš„é€»è¾‘</span>
}
</code></pre>
<h3 data-id="heading-15">å…­ã€å…³é”®æ³¨æ„äº‹é¡¹ï¼ˆç”Ÿäº§è½åœ°å¿…çœ‹ï¼‰</h3>
<p><strong>æ¨¡å‹èµ„æºéš”ç¦»</strong>ï¼šä¸åŒæ¨¡å‹çš„æ¨ç†èµ„æºï¼ˆCPU/GPUï¼‰éœ€éš”ç¦»ï¼Œé¿å…å•ä¸ªæ¨¡å‹å ç”¨å…¨éƒ¨èµ„æºï¼›
<strong>ä¸Šä¸‹æ–‡å…¼å®¹</strong>ï¼šä¸åŒæ¨¡å‹çš„ä¸Šä¸‹æ–‡æ ¼å¼/é•¿åº¦é™åˆ¶ä¸åŒï¼Œéœ€é€‚é…ï¼ˆå¦‚Llama3çš„ä¸Šä¸‹æ–‡é•¿åº¦ä¸º8192ï¼ŒQwen2ä¸º4096ï¼‰ï¼›
<strong>å‚æ•°è°ƒä¼˜</strong>ï¼šæ¯ä¸ªæ¨¡å‹çš„æœ€ä¼˜å‚æ•°ä¸åŒï¼ˆå¦‚deepseek-r1çš„temperature=0.5æ›´ä¼˜ï¼‰ï¼Œéœ€å•ç‹¬è°ƒä¼˜ï¼›
<strong>ç›‘æ§å‘Šè­¦</strong>ï¼šç›‘æ§å„æ¨¡å‹çš„è°ƒç”¨é‡ã€å“åº”æ—¶é—´ã€å¤±è´¥ç‡ï¼Œå¼‚å¸¸æ—¶åŠæ—¶å‘Šè­¦ï¼›
<strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šæ¨¡å‹å‡çº§æ—¶ï¼ˆå¦‚qwen2-7bâ†’qwen2-14bï¼‰ï¼Œéœ€ä¿ç•™æ—§æ¨¡å‹é…ç½®ï¼Œæ”¯æŒç°åº¦åˆ‡æ¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LCELï¼šæ‰“é€ å¯è§‚æµ‹ã€å¯æ‰©å±•ã€å¯éƒ¨ç½²çš„ LangChain åº”ç”¨]]></title>    <link>https://juejin.cn/post/7592912896591249427</link>    <guid>https://juejin.cn/post/7592912896591249427</guid>    <pubDate>2026-01-09T02:57:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592912896591249427" data-draft-id="7592515924700495907" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LCELï¼šæ‰“é€ å¯è§‚æµ‹ã€å¯æ‰©å±•ã€å¯éƒ¨ç½²çš„ LangChain åº”ç”¨"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½,Python"/> <meta itemprop="datePublished" content="2026-01-09T02:57:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿæµ©AI"/> <meta itemprop="url" content="https://juejin.cn/user/2904236059009760"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LCELï¼šæ‰“é€ å¯è§‚æµ‹ã€å¯æ‰©å±•ã€å¯éƒ¨ç½²çš„ LangChain åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2904236059009760/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿæµ©AI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:57:27.000Z" title="Fri Jan 09 2026 02:57:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>LangChain Expression Languageï¼ˆLCELï¼‰æ˜¯ä¸€ç§å£°æ˜å¼è¯­è¨€ï¼Œå¯è½»æ¾ç»„åˆä¸åŒçš„è°ƒç”¨é¡ºåºæ„æˆ Chainã€‚LCEL è‡ªåˆ›ç«‹ä¹‹åˆå°±è¢«è®¾è®¡ä¸ºèƒ½å¤Ÿæ”¯æŒå°†åŸå‹æŠ•å…¥ç”Ÿäº§ç¯å¢ƒï¼Œæ— éœ€ä»£ç æ›´æ”¹ï¼Œä»æœ€ç®€å•çš„â€œæç¤º+LLMâ€é“¾åˆ°æœ€å¤æ‚çš„é“¾ï¼ˆå·²æœ‰ç”¨æˆ·æˆåŠŸåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡ŒåŒ…å«æ•°ç™¾ä¸ªæ­¥éª¤çš„ LCEL Chainï¼‰ã€‚
LCEL çš„ä¸€äº›äº®ç‚¹åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æµæ”¯æŒ</strong>ï¼šä½¿ç”¨ LCEL æ„å»º Chain æ—¶ï¼Œä½ å¯ä»¥è·å¾—æœ€ä½³çš„é¦–ä¸ªä»¤ç‰Œæ—¶é—´ï¼ˆå³ä»è¾“å‡ºå¼€å§‹åˆ°é¦–æ‰¹è¾“å‡ºç”Ÿæˆçš„æ—¶é—´ï¼‰ã€‚å¯¹äºæŸäº› Chainï¼Œè¿™æ„å‘³ç€å¯ä»¥ç›´æ¥ä» LLM æµå¼ä¼ è¾“ä»¤ç‰Œåˆ°æµè¾“å‡ºè§£æå™¨ï¼Œä»è€Œä»¥ä¸ LLM æä¾›å•†è¾“å‡ºåŸå§‹ä»¤ç‰Œç›¸åŒçš„é€Ÿç‡è·å¾—è§£æåçš„ã€å¢é‡çš„è¾“å‡ºã€‚</li>
<li><strong>å¼‚æ­¥æ”¯æŒ</strong>ï¼šä»»ä½•ä½¿ç”¨ LCEL æ„å»ºçš„é“¾æ¡éƒ½å¯ä»¥é€šè¿‡åŒæ­¥ APIï¼ˆä¾‹å¦‚ï¼Œåœ¨ Jupyter ç¬”è®°æœ¬ä¸­è¿›è¡ŒåŸå‹è®¾è®¡æ—¶ï¼‰å’Œå¼‚æ­¥ APIï¼ˆä¾‹å¦‚ï¼Œåœ¨ LangServe æœåŠ¡å™¨ä¸­ï¼‰è°ƒç”¨ã€‚è¿™ä½¿å¾—ç›¸åŒçš„ä»£ç å¯ç”¨äºåŸå‹è®¾è®¡å’Œç”Ÿäº§ç¯å¢ƒï¼Œå…·æœ‰å‡ºè‰²çš„æ€§èƒ½ï¼Œå¹¶èƒ½å¤Ÿåœ¨åŒä¸€æœåŠ¡å™¨ä¸­å¤„ç†å¤šä¸ªå¹¶å‘è¯·æ±‚ã€‚</li>
<li><strong>ä¼˜åŒ–çš„å¹¶è¡Œæ‰§è¡Œ</strong>ï¼šå½“ä½ çš„ LCEL é“¾æ¡æœ‰å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„æ­¥éª¤æ—¶ï¼ˆä¾‹å¦‚ï¼Œä»å¤šä¸ªæ£€ç´¢å™¨ä¸­è·å–æ–‡æ¡£ï¼‰ï¼Œæˆ‘ä»¬ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œæ— è®ºæ˜¯åœ¨åŒæ­¥è¿˜æ˜¯å¼‚æ­¥æ¥å£ä¸­ï¼Œä»¥å®ç°æœ€å°çš„å»¶è¿Ÿã€‚</li>
<li><strong>é‡è¯•å’Œå›é€€</strong>ï¼šä¸º LCEL é“¾çš„ä»»ä½•éƒ¨åˆ†é…ç½®é‡è¯•å’Œå›é€€ã€‚è¿™æ˜¯ä½¿é“¾åœ¨è§„æ¨¡ä¸Šæ›´å¯é çš„ç»ä½³æ–¹å¼ã€‚ç›®å‰æˆ‘ä»¬æ­£åœ¨æ·»åŠ é‡è¯•/å›é€€çš„æµåª’ä½“æ”¯æŒï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ä¸å¢åŠ ä»»ä½•å»¶è¿Ÿæˆæœ¬çš„æƒ…å†µä¸‹è·å¾—å¢åŠ çš„å¯é æ€§ã€‚</li>
<li><strong>è®¿é—®ä¸­é—´ç»“æœ</strong>ï¼šå¯¹äºæ›´å¤æ‚çš„é“¾æ¡ï¼Œè®¿é—®åœ¨æœ€ç»ˆè¾“å‡ºäº§ç”Ÿä¹‹å‰çš„ä¸­é—´æ­¥éª¤çš„ç»“æœé€šå¸¸éå¸¸æœ‰ç”¨ã€‚è¿™å¯ä»¥ç”¨äºè®©æœ€ç»ˆç”¨æˆ·çŸ¥é“æ­£åœ¨å‘ç”Ÿä¸€äº›äº‹æƒ…ï¼Œç”šè‡³ä»…ç”¨äºè°ƒè¯•é“¾æ¡ã€‚ä½ å¯ä»¥æµå¼ä¼ è¾“ä¸­é—´ç»“æœï¼Œå¹¶ä¸”åœ¨æ¯ä¸ª LangServe æœåŠ¡å™¨ä¸Šéƒ½å¯ç”¨ã€‚</li>
<li><strong>è¾“å…¥å’Œè¾“å‡ºæ¨¡å¼</strong>ï¼šè¾“å…¥å’Œè¾“å‡ºæ¨¡å¼ä¸ºæ¯ä¸ª LCEL é“¾æä¾›äº†ä»é“¾çš„ç»“æ„æ¨æ–­å‡ºçš„ Pydantic å’Œ JSONSchema æ¨¡å¼ã€‚è¿™å¯ä»¥ç”¨äºè¾“å…¥å’Œè¾“å‡ºçš„éªŒè¯ï¼Œæ˜¯ LangServe çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚</li>
<li><strong>æ— ç¼ LangSmith è·Ÿè¸ªé›†æˆ</strong>ï¼šéšç€é“¾æ¡å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œç†è§£æ¯ä¸€æ­¥å‘ç”Ÿäº†ä»€ä¹ˆå˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚é€šè¿‡ LCELï¼Œæ‰€æœ‰æ­¥éª¤éƒ½è‡ªåŠ¨è®°å½•åˆ° LangSmithï¼Œä»¥å®ç°æœ€å¤§çš„å¯è§‚å¯Ÿæ€§å’Œå¯è°ƒè¯•æ€§ã€‚</li>
<li><strong>æ— ç¼ LangServe éƒ¨ç½²é›†æˆ</strong>ï¼šä»»ä½•ä½¿ç”¨ LCEL åˆ›å»ºçš„é“¾éƒ½å¯ä»¥è½»æ¾åœ°ä½¿ç”¨ LangServe è¿›è¡Œéƒ¨ç½²ã€‚</li>
</ol>
<h3 data-id="heading-0">1 Pipeline å¼è°ƒç”¨</h3>
<h3 data-id="heading-1">Pipeline å¼è°ƒç”¨ PromptTemplate, LLM å’Œ OutputParser</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser
<span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnablePassthrough
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">Optional</span>
<span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> Enum
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¾“å‡ºç»“æ„</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SortEnum</span>(<span class="hljs-built_in">str</span>, Enum):
    data = <span class="hljs-string">'data'</span>
    price = <span class="hljs-string">'price'</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderingEnum</span>(<span class="hljs-built_in">str</span>, Enum):
    ascend = <span class="hljs-string">'ascend'</span>
    descend = <span class="hljs-string">'descend'</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Semantics</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    name: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = Field(description=<span class="hljs-string">"æµé‡åŒ…åç§°"</span>, default=<span class="hljs-literal">None</span>)
    price_lower: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"ä»·æ ¼ä¸‹é™"</span>, default=<span class="hljs-literal">None</span>)
    price_upper: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"ä»·æ ¼ä¸Šé™"</span>, default=<span class="hljs-literal">None</span>)
    data_lower: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"æµé‡ä¸‹é™"</span>, default=<span class="hljs-literal">None</span>)
    data_upper: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"æµé‡ä¸Šé™"</span>, default=<span class="hljs-literal">None</span>)
    sort_by: <span class="hljs-type">Optional</span>[SortEnum] = Field(description=<span class="hljs-string">"æŒ‰ä»·æ ¼æˆ–æµé‡æ’åº"</span>, default=<span class="hljs-literal">None</span>)
    ordering: <span class="hljs-type">Optional</span>[OrderingEnum] = Field(
description=<span class="hljs-string">"å‡åºæˆ–é™åºæ’åˆ—"</span>, default=<span class="hljs-literal">None</span>)
<span class="hljs-comment"># Prompt æ¨¡æ¿</span>
prompt = ChatPromptTemplate.from_messages(
    [
        (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªè¯­ä¹‰è§£æå™¨ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†ç”¨æˆ·çš„è¾“å…¥è§£ææˆJSONè¡¨ç¤ºã€‚ä¸è¦å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚"</span>),
        (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{text}"</span>),
    ]
)
<span class="hljs-comment"># æ¨¡å‹</span>
llm = init_chat_model(<span class="hljs-string">"deepseek-chat"</span>, model_provider=<span class="hljs-string">"deepseek"</span>)
structured_llm = llm.with_structured_output(Semantics)
<span class="hljs-comment"># LCEL è¡¨è¾¾å¼</span>
runnable = (
    {<span class="hljs-string">"text"</span>: RunnablePassthrough()} | prompt | structured_llm
)
<span class="hljs-comment"># ç›´æ¥è¿è¡Œ</span>
ret = runnable.invoke(<span class="hljs-string">"ä¸è¶…è¿‡100å…ƒçš„æµé‡å¤§çš„å¥—é¤æœ‰å“ªäº›"</span>)
<span class="hljs-built_in">print</span>(
    json.dumps(
        ret.model_dump(),
        indent = <span class="hljs-number">4</span>,
        ensure_ascii=<span class="hljs-literal">False</span>
    )
)
</code></pre>
<blockquote>
<p>ä½¿ç”¨ LCEL çš„ä»·å€¼ï¼Œä¹Ÿå°±æ˜¯ LangChain çš„æ ¸å¿ƒä»·å€¼ã€‚</p>
</blockquote>
<h3 data-id="heading-2">2 ç”¨ LCEL å®ç° RAG</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> langchain_text_splitters <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter
<span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS
<span class="hljs-keyword">from</span> langchain.chains <span class="hljs-keyword">import</span> RetrievalQA
<span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> PyMuPDFLoader
<span class="hljs-keyword">from</span> langchain_community.embeddings.dashscope <span class="hljs-keyword">import</span> DashScopeEmbeddings
<span class="hljs-comment"># åŠ è½½æ–‡æ¡£</span>
loader = PyMuPDFLoader(<span class="hljs-string">"./data/deepseek-v3-1-4.pdf"</span>)
pages = loader.load_and_split()
<span class="hljs-comment"># æ–‡æ¡£åˆ‡åˆ†</span>
text_splitter = RecursiveCharacterTextSplitter(
    chunk_size=<span class="hljs-number">512</span>,
    chunk_overlap=<span class="hljs-number">200</span>,
    length_function=<span class="hljs-built_in">len</span>,
    add_start_index=<span class="hljs-literal">True</span>,
)
texts = text_splitter.create_documents(
    [page.page_content <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> pages[:<span class="hljs-number">1</span>]]
)
<span class="hljs-comment"># çŒåº“</span>
embeddings = DashScopeEmbeddings(
    model=<span class="hljs-string">"text-embedding-v1"</span>, dashscope_api_key=os.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>)
)
db = FAISS.from_documents(texts, embeddings)
<span class="hljs-comment"># æ£€ç´¢ top-5 ç»“æœ</span>
retriever = db.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">5</span>})
</code></pre>
<pre><code class="hljs language-python" lang="python">docs = retriever.invoke(<span class="hljs-string">"deepseek v3æœ‰å¤šå°‘å‚æ•°"</span>)
<span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> docs:
    <span class="hljs-built_in">print</span>(doc.page_content)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"----"</span>)
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.schema.output_parser <span class="hljs-keyword">import</span> StrOutputParser
<span class="hljs-keyword">from</span> langchain.schema.runnable <span class="hljs-keyword">import</span> RunnablePassthrough
<span class="hljs-comment"># Promptæ¨¡æ¿</span>
template = <span class="hljs-string">"""Answer the question based only on the following context:
{context}
Question: {question}
"""</span>
prompt = ChatPromptTemplate.from_template(template)
<span class="hljs-comment"># Chain</span>
rag_chain = (
    {<span class="hljs-string">"question"</span>: RunnablePassthrough(), <span class="hljs-string">"context"</span>: retriever}
    | prompt
    | llm
    | StrOutputParser()
)
rag_chain.invoke(<span class="hljs-string">"deepseek V3æœ‰å¤šå°‘å‚æ•°"</span>)
</code></pre>
<p>'DeepSeek-V3 æ˜¯ä¸€ä¸ªæ··åˆä¸“å®¶ï¼ˆMixture-of-Experts, MoEï¼‰è¯­è¨€æ¨¡å‹ï¼Œæ€»å‚æ•°é‡ä¸º<strong>6710äº¿ï¼ˆ671Bï¼‰</strong>ï¼Œå…¶ä¸­æ¯ä¸ª token æ¿€æ´»**370äº¿ï¼ˆ37Bï¼‰**å‚æ•°ã€‚'</p>
<h3 data-id="heading-3">3 ç”¨ LCEL å®ç°æ¨¡å‹åˆ‡æ¢ï¼ˆå·¥å‚æ¨¡å¼ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables.utils <span class="hljs-keyword">import</span> ConfigurableField
<span class="hljs-keyword">from</span> langchain_community.chat_models <span class="hljs-keyword">import</span> QianfanChatEndpoint
<span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> (
    ChatPromptTemplate,
    HumanMessagePromptTemplate,
)
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain.schema <span class="hljs-keyword">import</span> HumanMessage
<span class="hljs-keyword">import</span> os
<span class="hljs-comment"># æ¨¡å‹1</span>
ds_model = init_chat_model(<span class="hljs-string">"deepseek-chat"</span>, model_provider=<span class="hljs-string">"deepseek"</span>)
<span class="hljs-comment"># æ¨¡å‹2</span>
gpt_model = init_chat_model(<span class="hljs-string">"gpt-4o-mini"</span>, model_provider=<span class="hljs-string">"openai"</span>)
<span class="hljs-comment"># é€šè¿‡ configurable_alternatives æŒ‰æŒ‡å®šå­—æ®µé€‰æ‹©æ¨¡å‹</span>
model = gpt_model.configurable_alternatives(
    ConfigurableField(<span class="hljs-built_in">id</span>=<span class="hljs-string">"llm"</span>), 
    default_key=<span class="hljs-string">"gpt"</span>, 
    deepseek=ds_model,
    <span class="hljs-comment"># claude=claude_model,</span>
)
<span class="hljs-comment"># Prompt æ¨¡æ¿</span>
prompt = ChatPromptTemplate.from_messages(
    [
        HumanMessagePromptTemplate.from_template(<span class="hljs-string">"{query}"</span>),
    ]
)
<span class="hljs-comment"># LCEL</span>
chain = (
    {<span class="hljs-string">"query"</span>: RunnablePassthrough()} 
    | prompt
    | model 
    | StrOutputParser()
)
<span class="hljs-comment"># è¿è¡Œæ—¶æŒ‡å®šæ¨¡å‹ "gpt" or "deepseek"</span>
ret = chain.with_config(configurable={<span class="hljs-string">"llm"</span>: <span class="hljs-string">"deepseek"</span>}).invoke(<span class="hljs-string">"è¯·è‡ªæˆ‘ä»‹ç»"</span>)
<span class="hljs-built_in">print</span>(ret)

</code></pre>
<blockquote>
<p>æ€è€ƒï¼šä»æ¨¡å—é—´è§£ä¾èµ–è§’åº¦ï¼ŒLCEL çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<h3 data-id="heading-4">4 é…ç½®è¿è¡Œæ—¶å˜é‡</h3>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨è¿è¡Œæ—¶åŠ¨æ€é…ç½®é“¾çš„å‚æ•°ï¼Œè€Œä¸æ˜¯åœ¨å®šä¹‰æ—¶å°±å›ºå®šä¸‹æ¥ã€‚LCEL æä¾›äº†<code>with_config()</code>æ–¹æ³•æ¥å®ç°è¿è¡Œæ—¶é…ç½®ã€‚</p>
<p>**åœºæ™¯ç¤ºä¾‹ï¼š**æ ¹æ®ä¸åŒçš„ç”¨æˆ·è§’è‰²ï¼Œä½¿ç”¨ä¸åŒçš„ temperature å‚æ•°ï¼Œæˆ–è€…æ ¹æ®ä¸šåŠ¡éœ€æ±‚åŠ¨æ€è°ƒæ•´æ¨¡å‹çš„ max_tokensã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser
<span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnablePassthrough
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-comment"># åˆ›å»ºåŸºç¡€é“¾</span>
prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"è¯·ç”¨{tone}çš„è¯­æ°”å›ç­”ï¼š{question}"</span>)
llm = init_chat_model(<span class="hljs-string">"qwen-plus"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
chain = prompt | llm | StrOutputParser()
<span class="hljs-comment"># æ–¹å¼1ï¼šä½¿ç”¨ with_config é…ç½®è¿è¡Œæ—¶å˜é‡</span>
result1 = chain.with_config(
    configurable={<span class="hljs-string">"tone"</span>: <span class="hljs-string">"ä¸“ä¸š"</span>}
).invoke({<span class="hljs-string">"question"</span>: <span class="hljs-string">"ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"</span>})
<span class="hljs-built_in">print</span>(result1)
<span class="hljs-comment"># æ–¹å¼2ï¼šåœ¨ invoke æ—¶ä¼ å…¥ config</span>
result2 = chain.invoke(
    {<span class="hljs-string">"question"</span>: <span class="hljs-string">"ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"</span>},
    config={<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"tone"</span>: <span class="hljs-string">"è½»æ¾å¹½é»˜"</span>}}
)
<span class="hljs-built_in">print</span>(result2)

</code></pre>
<p><strong>æ›´é«˜çº§çš„ç”¨æ³•ï¼šé…ç½®æ¨¡å‹å‚æ•°</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnableConfig
<span class="hljs-comment"># åˆ›å»ºå¯é…ç½®çš„æ¨¡å‹</span>
llm = init_chat_model(<span class="hljs-string">"qwen-plus"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
<span class="hljs-comment"># åœ¨è¿è¡Œæ—¶é…ç½®æ¨¡å‹å‚æ•°</span>
configurable_llm = llm.with_config(
    configurable={
        <span class="hljs-string">"temperature"</span>: <span class="hljs-number">0.7</span>,
        <span class="hljs-string">"max_tokens"</span>: <span class="hljs-number">1000</span>
    }
)
prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"å›ç­”ï¼š{question}"</span>)
chain = prompt | configurable_llm | StrOutputParser()
result = chain.invoke({<span class="hljs-string">"question"</span>: <span class="hljs-string">"è§£é‡Šä¸€ä¸‹æœºå™¨å­¦ä¹ "</span>})
</code></pre>
<blockquote>
<p>æç¤ºï¼šè¿è¡Œæ—¶é…ç½®çš„ä¼˜åŠ¿åœ¨äºï¼ŒåŒä¸€ä¸ªé“¾å¯ä»¥åœ¨ä¸åŒåœºæ™¯ä¸‹å¤ç”¨ï¼Œåªéœ€åœ¨è°ƒç”¨æ—¶ä¼ å…¥ä¸åŒçš„é…ç½®å³å¯ï¼Œæ— éœ€åˆ›å»ºå¤šä¸ªé“¾å®ä¾‹ã€‚</p>
</blockquote>
<h3 data-id="heading-5">5 æ•…éšœå›é€€</h3>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒLLM API è°ƒç”¨å¯èƒ½ä¼šå› ä¸ºç½‘ç»œé—®é¢˜ã€æœåŠ¡é™æµã€æ¨¡å‹é”™è¯¯ç­‰åŸå› å¤±è´¥ã€‚ä¸ºäº†æé«˜ç³»ç»Ÿçš„å¥å£®æ€§ï¼ŒLCEL æä¾›äº†<code>with_fallbacks()</code>æ–¹æ³•æ¥è®¾ç½®æ•…éšœå›é€€æœºåˆ¶ã€‚</p>
<p>**åœºæ™¯ç¤ºä¾‹ï¼š**å½“ä¸»æ¨¡å‹ï¼ˆå¦‚ qwen-plusï¼‰è°ƒç”¨å¤±è´¥æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æ¨¡å‹ï¼ˆå¦‚ qwen-turboï¼‰ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser
<span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnableLambda
<span class="hljs-comment"># ä¸»æ¨¡å‹</span>
primary_llm = init_chat_model(<span class="hljs-string">"qwen-plus"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
<span class="hljs-comment"># å¤‡ç”¨æ¨¡å‹ï¼ˆé€šå¸¸é€‰æ‹©æ›´ä¾¿å®œæˆ–æ›´ç¨³å®šçš„æ¨¡å‹ï¼‰</span>
fallback_llm = init_chat_model(<span class="hljs-string">"qwen-turbo"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
<span class="hljs-comment"># åˆ›å»ºå¸¦æ•…éšœå›é€€çš„é“¾</span>
prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"å›ç­”ï¼š{question}"</span>)
<span class="hljs-comment"># æ–¹å¼1ï¼šä¸ºæ•´ä¸ªé“¾è®¾ç½®å›é€€</span>
chain_with_fallback = (
    prompt 
    | primary_llm.with_fallbacks([fallback_llm])
    | StrOutputParser()
)
result = chain_with_fallback.invoke({<span class="hljs-string">"question"</span>: <span class="hljs-string">"ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ ï¼Ÿ"</span>})
<span class="hljs-built_in">print</span>(result)
</code></pre>
<p><strong>å¤šçº§å›é€€ç­–ç•¥</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯ä»¥è®¾ç½®å¤šä¸ªå›é€€ï¼ŒæŒ‰é¡ºåºå°è¯•</span>
backup_llm1 = init_chat_model(<span class="hljs-string">"qwen-turbo"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
backup_llm2 = init_chat_model(<span class="hljs-string">"deepseek-chat"</span>, model_provider=<span class="hljs-string">"deepseek"</span>)
<span class="hljs-comment"># è‡ªå®šä¹‰å›é€€å¤„ç†å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_fallback</span>(<span class="hljs-params">input_data</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-string">"æŠ±æ­‰ï¼Œå½“å‰æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•ã€‚"</span>
robust_chain = (
    prompt 
    | primary_llm.with_fallbacks([
        backup_llm1, 
        backup_llm2,
        RunnableLambda(custom_fallback)
    ])
    | StrOutputParser()
)
</code></pre>
<p><strong>é’ˆå¯¹ç‰¹å®šå¼‚å¸¸çš„å›é€€</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnableLambda
<span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_rate_limit_error</span>(<span class="hljs-params">input_data</span>):
    <span class="hljs-string">"""å¤„ç†é™æµé”™è¯¯"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"å½“å‰è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•ã€‚"</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_timeout_error</span>(<span class="hljs-params">input_data</span>):
    <span class="hljs-string">"""å¤„ç†è¶…æ—¶é”™è¯¯"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"è¯·æ±‚è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚"</span>
<span class="hljs-comment"># å¯ä»¥æ ¹æ®ä¸åŒå¼‚å¸¸ç±»å‹è®¾ç½®ä¸åŒçš„å›é€€ç­–ç•¥</span>
chain = prompt | primary_llm.with_fallbacks([
    (fallback_llm, <span class="hljs-keyword">lambda</span> e: <span class="hljs-built_in">isinstance</span>(e, Exception))
]) | StrOutputParser()

</code></pre>
<blockquote>
<p>æœ€ä½³å®è·µï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®è‡³å°‘è®¾ç½®ä¸€ä¸ªå¤‡ç”¨æ¨¡å‹ï¼Œå¹¶è®°å½•å¤±è´¥æ—¥å¿—ï¼Œä»¥ä¾¿åç»­åˆ†æå’Œä¼˜åŒ–ã€‚</p>
</blockquote>
<h3 data-id="heading-6">6 å¹¶è¡Œè°ƒç”¨</h3>
<p>å½“é“¾ä¸­æœ‰å¤šä¸ªå¯ä»¥ç‹¬ç«‹æ‰§è¡Œçš„ä»»åŠ¡æ—¶ï¼Œå¹¶è¡Œæ‰§è¡Œå¯ä»¥æ˜¾è‘—æé«˜æ•ˆç‡ã€‚LCEL çš„<code>RunnableParallel</code>å…è®¸åŒæ—¶æ‰§è¡Œå¤šä¸ªå­é“¾ã€‚</p>
<p>**åœºæ™¯ç¤ºä¾‹ï¼š**åŒæ—¶ä»å¤šä¸ªæ•°æ®æºæ£€ç´¢ä¿¡æ¯ï¼Œæˆ–è€…åŒæ—¶æ‰§è¡Œå¤šä¸ªç‹¬ç«‹çš„åˆ†æä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnableParallel, RunnablePassthrough
<span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser
llm = init_chat_model(<span class="hljs-string">"qwen-plus"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
<span class="hljs-comment"># å®šä¹‰å¤šä¸ªç‹¬ç«‹çš„å¤„ç†ä»»åŠ¡</span>
summarize_prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"æ€»ç»“ä»¥ä¸‹å†…å®¹ï¼š{text}"</span>)
translate_prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"å°†ä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆè‹±æ–‡ï¼š{text}"</span>)
analyze_prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"åˆ†æä»¥ä¸‹å†…å®¹çš„æƒ…æ„Ÿå€¾å‘ï¼š{text}"</span>)
<span class="hljs-comment"># åˆ›å»ºå¹¶è¡Œæ‰§è¡Œçš„é“¾</span>
parallel_chain = RunnableParallel({
    <span class="hljs-string">"summary"</span>: (
        {<span class="hljs-string">"text"</span>: RunnablePassthrough()} 
        | summarize_prompt 
        | llm 
        | StrOutputParser()
    ),
    <span class="hljs-string">"translation"</span>: (
        {<span class="hljs-string">"text"</span>: RunnablePassthrough()} 
        | translate_prompt 
        | llm 
        | StrOutputParser()
    ),
    <span class="hljs-string">"sentiment"</span>: (
        {<span class="hljs-string">"text"</span>: RunnablePassthrough()} 
        | analyze_prompt 
        | llm 
        | StrOutputParser()
    )
})
<span class="hljs-comment"># æ‰§è¡Œå¹¶è¡Œä»»åŠ¡</span>
text = <span class="hljs-string">"ä»Šå¤©å¤©æ°”çœŸå¥½ï¼Œé€‚åˆå‡ºå»æ•£æ­¥ã€‚"</span>
results = parallel_chain.invoke(text)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»ç»“ï¼š<span class="hljs-subst">{results[<span class="hljs-string">'summary'</span>]}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¿»è¯‘ï¼š<span class="hljs-subst">{results[<span class="hljs-string">'translation'</span>]}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æƒ…æ„Ÿï¼š<span class="hljs-subst">{results[<span class="hljs-string">'sentiment'</span>]}</span>"</span>)

</code></pre>
<p><strong>ç»“åˆ RAG çš„å¹¶è¡Œæ£€ç´¢</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS
<span class="hljs-keyword">from</span> langchain_community.embeddings.dashscope <span class="hljs-keyword">import</span> DashScopeEmbeddings
<span class="hljs-keyword">import</span> os
<span class="hljs-comment"># å‡è®¾æœ‰å¤šä¸ªçŸ¥è¯†åº“</span>
embeddings = DashScopeEmbeddings(
    model=<span class="hljs-string">"text-embedding-v1"</span>,
    dashscope_api_key=os.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>)
)
<span class="hljs-comment"># åˆ›å»ºå¤šä¸ªæ£€ç´¢å™¨ï¼ˆå®é™…åº”ç”¨ä¸­å¯èƒ½æ˜¯ä¸åŒçš„çŸ¥è¯†åº“ï¼‰</span>
retriever1 = db1.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">3</span>})
retriever2 = db2.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">3</span>})
retriever3 = db3.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">3</span>})
<span class="hljs-comment"># å¹¶è¡Œæ£€ç´¢å¤šä¸ªçŸ¥è¯†åº“</span>
parallel_retrieval = RunnableParallel({
    <span class="hljs-string">"tech_docs"</span>: retriever1,
    <span class="hljs-string">"product_docs"</span>: retriever2,
    <span class="hljs-string">"faq_docs"</span>: retriever3
})
<span class="hljs-comment"># åŒæ—¶ä»ä¸‰ä¸ªçŸ¥è¯†åº“æ£€ç´¢</span>
docs = parallel_retrieval.invoke(<span class="hljs-string">"å¦‚ä½•ä½¿ç”¨APIï¼Ÿ"</span>)
<span class="hljs-comment"># åˆå¹¶æ£€ç´¢ç»“æœ</span>
all_docs = docs[<span class="hljs-string">"tech_docs"</span>] + docs[<span class="hljs-string">"product_docs"</span>] + docs[<span class="hljs-string">"faq_docs"</span>]
</code></pre>
<blockquote>
<p>æ€§èƒ½æå‡ï¼šå¹¶è¡Œè°ƒç”¨å¯ä»¥å°†å¤šä¸ªä¸²è¡Œä»»åŠ¡çš„æ€»è€—æ—¶ä» (O(n)) é™ä½åˆ° (O(1))ï¼Œåœ¨éœ€è¦å¤„ç†å¤šä¸ªç‹¬ç«‹ä»»åŠ¡æ—¶æ•ˆæœæ˜¾è‘—ã€‚</p>
</blockquote>
<h3 data-id="heading-7">7 é€»è¾‘åˆ†æ”¯</h3>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æ ¹æ®è¾“å…¥æˆ–ä¸­é—´ç»“æœåŠ¨æ€é€‰æ‹©æ‰§è¡Œè·¯å¾„ã€‚LCEL æ”¯æŒé€šè¿‡<code>RunnableLambda</code>å’Œæ¡ä»¶åˆ¤æ–­å®ç°é€»è¾‘åˆ†æ”¯ã€‚</p>
<p>**åœºæ™¯ç¤ºä¾‹ï¼š**æ ¹æ®ç”¨æˆ·é—®é¢˜çš„å¤æ‚åº¦ï¼Œé€‰æ‹©ä¸åŒçš„å¤„ç†ç­–ç•¥ï¼›æˆ–è€…æ ¹æ®æ£€ç´¢ç»“æœçš„è´¨é‡ï¼Œå†³å®šæ˜¯å¦éœ€è¦è¿›ä¸€æ­¥å¤„ç†ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnableLambda, RunnablePassthrough
<span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser
llm_simple = init_chat_model(<span class="hljs-string">"qwen-turbo"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
llm_complex = init_chat_model(<span class="hljs-string">"qwen-plus"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
<span class="hljs-comment"># å®šä¹‰ä¸åŒå¤æ‚åº¦çš„å¤„ç†é“¾</span>
simple_prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"ç®€å•å›ç­”ï¼š{question}"</span>)
complex_prompt = ChatPromptTemplate.from_template(
    <span class="hljs-string">"è¯¦ç»†åˆ†æå¹¶å›ç­”ï¼š{question}ï¼Œè¯·æä¾›å¤šä¸ªè§’åº¦çš„è§è§£ã€‚"</span>
)
simple_chain = simple_prompt | llm_simple | StrOutputParser()
complex_chain = complex_prompt | llm_complex | StrOutputParser()
<span class="hljs-comment"># åˆ¤æ–­é—®é¢˜å¤æ‚åº¦çš„å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">route_by_complexity</span>(<span class="hljs-params">input_data</span>):
    question = input_data[<span class="hljs-string">"question"</span>]
    <span class="hljs-comment"># ç®€å•çš„å¤æ‚åº¦åˆ¤æ–­é€»è¾‘ï¼ˆå®é™…åº”ç”¨ä¸­å¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„åˆ¤æ–­ï¼‰</span>
    complex_keywords = [<span class="hljs-string">"åˆ†æ"</span>, <span class="hljs-string">"å¯¹æ¯”"</span>, <span class="hljs-string">"è¯¦ç»†"</span>, <span class="hljs-string">"åŸç†"</span>, <span class="hljs-string">"æœºåˆ¶"</span>]
    is_complex = <span class="hljs-built_in">any</span>(keyword <span class="hljs-keyword">in</span> question <span class="hljs-keyword">for</span> keyword <span class="hljs-keyword">in</span> complex_keywords)
    <span class="hljs-keyword">if</span> is_complex:
        <span class="hljs-keyword">return</span> complex_chain.invoke(input_data)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> simple_chain.invoke(input_data)
<span class="hljs-comment"># åˆ›å»ºè·¯ç”±é“¾</span>
routing_chain = RunnableLambda(route_by_complexity)
<span class="hljs-comment"># æµ‹è¯•</span>
result1 = routing_chain.invoke({<span class="hljs-string">"question"</span>: <span class="hljs-string">"ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>})
result2 = routing_chain.invoke({<span class="hljs-string">"question"</span>: <span class="hljs-string">"è¯·è¯¦ç»†åˆ†ææ·±åº¦å­¦ä¹ å’Œæœºå™¨å­¦ä¹ çš„åŒºåˆ«"</span>})
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç®€å•é—®é¢˜ï¼š<span class="hljs-subst">{result1}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤æ‚é—®é¢˜ï¼š<span class="hljs-subst">{result2}</span>"</span>)

</code></pre>
<p><strong>åŸºäº LLM çš„æ™ºèƒ½è·¯ç”±</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> Enum
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RouteType</span>(<span class="hljs-built_in">str</span>, Enum):
    SIMPLE = <span class="hljs-string">"simple"</span>
    COMPLEX = <span class="hljs-string">"complex"</span>
    TECHNICAL = <span class="hljs-string">"technical"</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RouteDecision</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    route: RouteType = Field(description=<span class="hljs-string">"è·¯ç”±ç±»å‹"</span>)
<span class="hljs-comment"># ä½¿ç”¨ LLM åˆ¤æ–­è·¯ç”±</span>
router_llm = llm_simple.with_structured_output(RouteDecision)
router_prompt = ChatPromptTemplate.from_template(
    <span class="hljs-string">"åˆ¤æ–­ä»¥ä¸‹é—®é¢˜åº”è¯¥ä½¿ç”¨å“ªç§å¤„ç†æ–¹å¼ï¼ˆsimple/complex/technicalï¼‰ï¼š{question}"</span>
)
router_chain = router_prompt | router_llm
<span class="hljs-comment"># å®šä¹‰ä¸åŒè·¯ç”±çš„å¤„ç†é“¾</span>
chains = {
    RouteType.SIMPLE: simple_chain,
    RouteType.COMPLEX: complex_chain,
    RouteType.TECHNICAL: (
        ChatPromptTemplate.from_template(<span class="hljs-string">"ä»æŠ€æœ¯è§’åº¦è¯¦ç»†è§£ç­”ï¼š{question}"</span>)
        | llm_complex
        | StrOutputParser()
    )
}
<span class="hljs-keyword">def</span> <span class="hljs-title function_">smart_route</span>(<span class="hljs-params">input_data</span>):
    <span class="hljs-comment"># å…ˆåˆ¤æ–­è·¯ç”±</span>
    decision = router_chain.invoke(input_data)
    <span class="hljs-comment"># æ ¹æ®è·¯ç”±é€‰æ‹©é“¾</span>
    selected_chain = chains[decision.route]
    <span class="hljs-comment"># æ‰§è¡Œé€‰ä¸­çš„é“¾</span>
    <span class="hljs-keyword">return</span> selected_chain.invoke(input_data)
smart_routing_chain = RunnableLambda(smart_route)

</code></pre>
<p><strong>åŸºäºæ£€ç´¢ç»“æœè´¨é‡çš„è·¯ç”±</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¦‚æœæ£€ç´¢åˆ°çš„æ–‡æ¡£ç›¸å…³æ€§é«˜ï¼Œç›´æ¥ä½¿ç”¨ RAGï¼›å¦åˆ™ä½¿ç”¨é€šç”¨æ¨¡å‹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">route_by_retrieval_quality</span>(<span class="hljs-params">input_data</span>):
    question = input_data[<span class="hljs-string">"question"</span>]
    docs = retriever.invoke(question)
    <span class="hljs-comment"># ç®€å•çš„ç›¸å…³æ€§åˆ¤æ–­ï¼ˆå®é™…å¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„è¯„åˆ†æœºåˆ¶ï¼‰</span>
    <span class="hljs-keyword">if</span> docs <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(docs) &gt;= <span class="hljs-number">3</span>:
        <span class="hljs-comment"># ä½¿ç”¨ RAG é“¾</span>
        <span class="hljs-keyword">return</span> rag_chain.invoke(question)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># ä½¿ç”¨é€šç”¨æ¨¡å‹</span>
        <span class="hljs-keyword">return</span> general_chain.invoke({<span class="hljs-string">"question"</span>: question})
retrieval_routing_chain = RunnableLambda(route_by_retrieval_quality)

</code></pre>
<blockquote>
<p>è®¾è®¡æ¨¡å¼ï¼šé€»è¾‘åˆ†æ”¯è®©é“¾å…·å¤‡äº†â€œæ™ºèƒ½å†³ç­–â€èƒ½åŠ›ï¼Œå¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡åŠ¨æ€è°ƒæ•´å¤„ç†ç­–ç•¥ï¼Œè¿™æ˜¯æ„å»ºå¤æ‚ AI åº”ç”¨çš„å…³é”®æŠ€æœ¯ã€‚</p>
</blockquote>
<h3 data-id="heading-8">8 åŠ¨æ€åˆ›å»º Chain</h3>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è¿è¡Œæ—¶ä¿¡æ¯åŠ¨æ€æ„å»ºé“¾çš„ç»“æ„ã€‚LCEL æ”¯æŒåœ¨è¿è¡Œæ—¶åˆ›å»ºå’Œç»„åˆé“¾ç»„ä»¶ã€‚</p>
<p>**åœºæ™¯ç¤ºä¾‹ï¼š**æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„å·¥å…·åŠ¨æ€æ„å»ºå¤„ç†é“¾ï¼Œæˆ–è€…æ ¹æ®é…ç½®åŠ¨æ€ç»„åˆä¸åŒçš„å¤„ç†æ­¥éª¤ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnableLambda, RunnablePassthrough
<span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>
llm = init_chat_model(<span class="hljs-string">"qwen-plus"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
<span class="hljs-comment"># å®šä¹‰å¯ç”¨çš„å¤„ç†æ­¥éª¤</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_summarize_step</span>():
    prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"æ€»ç»“ï¼š{text}"</span>)
    <span class="hljs-keyword">return</span> prompt | llm | StrOutputParser()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_translate_step</span>(<span class="hljs-params">target_lang=<span class="hljs-string">"è‹±æ–‡"</span></span>):
    prompt = ChatPromptTemplate.from_template(<span class="hljs-string">f"ç¿»è¯‘æˆ<span class="hljs-subst">{target_lang}</span>ï¼š{{text}}"</span>)
    <span class="hljs-keyword">return</span> prompt | llm | StrOutputParser()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_analyze_step</span>():
    prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"åˆ†æï¼š{text}"</span>)
    <span class="hljs-keyword">return</span> prompt | llm | StrOutputParser()
<span class="hljs-comment"># åŠ¨æ€åˆ›å»ºé“¾çš„å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_dynamic_chain</span>(<span class="hljs-params">steps: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], config: <span class="hljs-built_in">dict</span> = <span class="hljs-literal">None</span></span>):
    <span class="hljs-string">"""
    æ ¹æ®æ­¥éª¤åˆ—è¡¨åŠ¨æ€åˆ›å»ºé“¾
    steps: æ­¥éª¤åˆ—è¡¨ï¼Œå¦‚ ["summarize", "translate", "analyze"]
    """</span>
    step_functions = {
        <span class="hljs-string">"summarize"</span>: create_summarize_step,
        <span class="hljs-string">"translate"</span>: <span class="hljs-keyword">lambda</span>: create_translate_step(
            config.get(<span class="hljs-string">"target_lang"</span>, <span class="hljs-string">"è‹±æ–‡"</span>) <span class="hljs-keyword">if</span> config <span class="hljs-keyword">else</span> <span class="hljs-string">"è‹±æ–‡"</span>
        ),
        <span class="hljs-string">"analyze"</span>: create_analyze_step
    }
    <span class="hljs-comment"># åŠ¨æ€ç»„åˆé“¾</span>
    chain = RunnablePassthrough()
    <span class="hljs-keyword">for</span> step_name <span class="hljs-keyword">in</span> steps:
        step_chain = step_functions[step_name]()
        <span class="hljs-comment"># å°†å‰ä¸€æ­¥çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€æ­¥çš„è¾“å…¥</span>
        chain = chain | step_chain
    <span class="hljs-keyword">return</span> chain
<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
dynamic_chain = create_dynamic_chain(
    steps=[<span class="hljs-string">"summarize"</span>, <span class="hljs-string">"translate"</span>, <span class="hljs-string">"analyze"</span>],
    config={<span class="hljs-string">"target_lang"</span>: <span class="hljs-string">"è‹±æ–‡"</span>}
)
result = dynamic_chain.invoke(<span class="hljs-string">"ä»Šå¤©æ˜¯ä¸€ä¸ªé‡è¦çš„æ—¥å­ï¼Œæˆ‘ä»¬å®Œæˆäº†é¡¹ç›®çš„å…³é”®é‡Œç¨‹ç¢‘ã€‚"</span>)
<span class="hljs-built_in">print</span>(result)

</code></pre>
<p><strong>åŸºäºé…ç½®æ–‡ä»¶çš„åŠ¨æ€é“¾æ„å»º</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> json
<span class="hljs-comment"># é…ç½®æ–‡ä»¶ç¤ºä¾‹</span>
chain_config = {
    <span class="hljs-string">"steps"</span>: [
        {<span class="hljs-string">"type"</span>: <span class="hljs-string">"summarize"</span>, <span class="hljs-string">"enabled"</span>: <span class="hljs-literal">True</span>},
        {<span class="hljs-string">"type"</span>: <span class="hljs-string">"translate"</span>, <span class="hljs-string">"enabled"</span>: <span class="hljs-literal">True</span>, <span class="hljs-string">"target_lang"</span>: <span class="hljs-string">"è‹±æ–‡"</span>},
        {<span class="hljs-string">"type"</span>: <span class="hljs-string">"analyze"</span>, <span class="hljs-string">"enabled"</span>: <span class="hljs-literal">False</span>}
    ],
    <span class="hljs-string">"model"</span>: <span class="hljs-string">"qwen-plus"</span>
}
<span class="hljs-keyword">def</span> <span class="hljs-title function_">build_chain_from_config</span>(<span class="hljs-params">config: <span class="hljs-built_in">dict</span></span>):
    <span class="hljs-string">"""æ ¹æ®é…ç½®æ–‡ä»¶æ„å»ºé“¾"""</span>
    llm = init_chat_model(config[<span class="hljs-string">"model"</span>], model_provider=<span class="hljs-string">"dashscope"</span>)
    chain = RunnablePassthrough()
    <span class="hljs-keyword">for</span> step_config <span class="hljs-keyword">in</span> config[<span class="hljs-string">"steps"</span>]:
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> step_config.get(<span class="hljs-string">"enabled"</span>, <span class="hljs-literal">True</span>):
            <span class="hljs-keyword">continue</span>
        step_type = step_config[<span class="hljs-string">"type"</span>]
        <span class="hljs-keyword">if</span> step_type == <span class="hljs-string">"summarize"</span>:
            prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"æ€»ç»“ï¼š{text}"</span>)
            step_chain = prompt | llm | StrOutputParser()
        <span class="hljs-keyword">elif</span> step_type == <span class="hljs-string">"translate"</span>:
            target_lang = step_config.get(<span class="hljs-string">"target_lang"</span>, <span class="hljs-string">"è‹±æ–‡"</span>)
            prompt = ChatPromptTemplate.from_template(<span class="hljs-string">f"ç¿»è¯‘æˆ<span class="hljs-subst">{target_lang}</span>ï¼š{{text}}"</span>)
            step_chain = prompt | llm | StrOutputParser()
        <span class="hljs-keyword">elif</span> step_type == <span class="hljs-string">"analyze"</span>:
            prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"åˆ†æï¼š{text}"</span>)
            step_chain = prompt | llm | StrOutputParser()
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">continue</span>
        chain = chain | step_chain
    <span class="hljs-keyword">return</span> chain
<span class="hljs-comment"># æ ¹æ®é…ç½®æ„å»ºé“¾</span>
configured_chain = build_chain_from_config(chain_config)
result = configured_chain.invoke(<span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡æœ¬"</span>)

</code></pre>
<p><strong>æ¡ä»¶å¼åŠ¨æ€é“¾æ„å»º</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_conditional_chain</span>(<span class="hljs-params">input_data: <span class="hljs-built_in">dict</span></span>):
    <span class="hljs-string">"""æ ¹æ®è¾“å…¥æ•°æ®åŠ¨æ€å†³å®šé“¾çš„ç»“æ„"""</span>
    text = input_data.get(<span class="hljs-string">"text"</span>, <span class="hljs-string">""</span>)
    task_type = input_data.get(<span class="hljs-string">"task_type"</span>, <span class="hljs-string">"general"</span>)
    llm = init_chat_model(<span class="hljs-string">"qwen-plus"</span>, model_provider=<span class="hljs-string">"dashscope"</span>)
    <span class="hljs-keyword">if</span> task_type == <span class="hljs-string">"qa"</span>:
        <span class="hljs-comment"># é—®ç­”ä»»åŠ¡ï¼šæ£€ç´¢ + ç”Ÿæˆ</span>
        prompt = ChatPromptTemplate.from_template(
            <span class="hljs-string">"åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼š\n{context}\n\né—®é¢˜ï¼š{question}"</span>
        )
        chain = (
            {<span class="hljs-string">"context"</span>: retriever, <span class="hljs-string">"question"</span>: RunnablePassthrough()}
            | prompt
            | llm
            | StrOutputParser()
        )
    <span class="hljs-keyword">elif</span> task_type == <span class="hljs-string">"summarize"</span>:
        <span class="hljs-comment"># æ‘˜è¦ä»»åŠ¡</span>
        prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"æ€»ç»“ï¼š{text}"</span>)
        chain = prompt | llm | StrOutputParser()
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># é€šç”¨ä»»åŠ¡</span>
        prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"å¤„ç†ï¼š{text}"</span>)
        chain = prompt | llm | StrOutputParser()
    <span class="hljs-keyword">return</span> chain
<span class="hljs-comment"># ä½¿ç”¨</span>
qa_chain = create_conditional_chain({<span class="hljs-string">"task_type"</span>: <span class="hljs-string">"qa"</span>})
summary_chain = create_conditional_chain({<span class="hljs-string">"task_type"</span>: <span class="hljs-string">"summarize"</span>})
</code></pre>
<blockquote>
<p>çµæ´»æ€§ï¼šåŠ¨æ€åˆ›å»ºé“¾è®©åº”ç”¨å…·å¤‡äº†é«˜åº¦çš„çµæ´»æ€§ï¼Œå¯ä»¥æ ¹æ®ç”¨æˆ·éœ€æ±‚ã€ä¸šåŠ¡è§„åˆ™æˆ–è¿è¡Œæ—¶æ¡ä»¶æ„å»ºæœ€é€‚åˆçš„å¤„ç†æµç¨‹ï¼Œè¿™æ˜¯æ„å»ºå¯é…ç½® AI ç³»ç»Ÿçš„å…³é”®èƒ½åŠ›ã€‚</p>
</blockquote>
<h3 data-id="heading-9">æ€»ç»“</h3>
<p>é€šè¿‡ä»¥ä¸Šç« èŠ‚ï¼Œæˆ‘ä»¬äº†è§£äº† LCEL çš„æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<ul>
<li><strong>1ï¼šPipeline å¼è°ƒç”¨ PromptTemplateã€LLM å’Œ OutputParser</strong></li>
<li><strong>2ï¼šç”¨ LCEL å®ç° RAG</strong></li>
<li><strong>3ï¼šç”¨ LCEL å®ç°æ¨¡å‹åˆ‡æ¢ï¼ˆå·¥å‚æ¨¡å¼ï¼‰</strong></li>
<li><strong>4ï¼šè¿è¡Œæ—¶é…ç½®ï¼Œè®©é“¾å…·å¤‡åŠ¨æ€å‚æ•°èƒ½åŠ›</strong></li>
<li><strong>5ï¼šæ•…éšœå›é€€ï¼Œæé«˜ç³»ç»Ÿå¥å£®æ€§</strong></li>
<li><strong>6ï¼šå¹¶è¡Œè°ƒç”¨ï¼Œæå‡å¤„ç†æ•ˆç‡</strong></li>
<li><strong>7ï¼šé€»è¾‘åˆ†æ”¯ï¼Œå®ç°æ™ºèƒ½è·¯ç”±</strong></li>
<li><strong>8ï¼šåŠ¨æ€åˆ›å»ºï¼Œæ„å»ºçµæ´»ç³»ç»Ÿ</strong></li>
</ul>
<p>è¿™äº›èƒ½åŠ›ç»„åˆä½¿ç”¨ï¼Œå¯ä»¥æ„å»ºå‡ºæ—¢å¼ºå¤§åˆçµæ´»çš„ AI åº”ç”¨ç³»ç»Ÿã€‚</p>
<h2 data-id="heading-10">ğŸ‰END</h2>
<p>å¦‚æœä½ è§‰å¾—æœ¬æ–‡æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµğŸ‘ã€åœ¨çœ‹ğŸ‘€ã€è½¬å‘ğŸ“¤ï¼Œä¹Ÿæ¬¢è¿ç•™è¨€ğŸ’¬åˆ†äº«ä½ çš„ç»éªŒï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[mavençš„å¤šä»“åº“é…ç½®ç†è§£]]></title>    <link>https://juejin.cn/post/7592873628586213376</link>    <guid>https://juejin.cn/post/7592873628586213376</guid>    <pubDate>2026-01-09T02:59:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592873628586213376" data-draft-id="7592846242176122914" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="mavençš„å¤šä»“åº“é…ç½®ç†è§£"/> <meta itemprop="keywords" content="Java,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-09T02:59:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¼˜é›…çš„38åº¦"/> <meta itemprop="url" content="https://juejin.cn/user/3030682435332360"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            mavençš„å¤šä»“åº“é…ç½®ç†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030682435332360/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¼˜é›…çš„38åº¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:59:10.000Z" title="Fri Jan 09 2026 02:59:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘åœ¨å·¥ä½œä¸­ï¼Œæ‹‰å–ä¸€ä¸ªjaråŒ…ï¼Œä¸ç¡®å®šæœ€åˆåœ¨mavençš„setting.xmlé…ç½®çš„é•œåƒé…ç½®èƒ½å¦æ‹‰å–åˆ°ï¼Œæ ¹æ®AIæœç´¢èµ„æ–™å¾—åˆ°ä¸€äº›å¯å‘ã€‚</p>
<h4 data-id="heading-0"><strong>åœºæ™¯ï¼š</strong></h4>
<p>æˆ‘åœ¨æˆ‘çš„maven setting.xmlé…ç½®äº†é˜¿é‡Œäº‘çš„é•œåƒï¼Œè¿™æ˜¯æˆ‘ä»¬å›½å†…å¼€å‘å¤§å¤šæ•°çš„å¿…è¦é…ç½®ï¼ŒåŸå› æ˜¯é€šè¿‡é˜¿é‡Œäº‘çš„æ‹‰å–ï¼Œå¯ä»¥åŠ å¿«æ‹‰å–é€Ÿåº¦ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>nexus-aliyun<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>central<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Nexus aliyun<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://maven.aliyun.com/repository/central<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
	 <span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span>  
</code></pre>
<p>åœ¨æˆ‘é¡¹ç›®çš„pom.xmléœ€è¦æ‹‰å–ä¸€äº›jarï¼Œå‘ç°æ‹‰å–è¿‡ç¨‹ä¸­æç¤ºæ‹‰å–ä¸åˆ°jaråŒ…ï¼Œäºæ˜¯ï¼Œæˆ‘æ ¹æ®æœç´¢åˆ°çš„èµ„æ–™å†pom.xmlåŠ äº†ä»“åº“é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>central-ma<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo1.maven.org/maven2/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">releases</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">releases</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">snapshots</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">snapshots</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>eclipse-releases<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.eclipse.org/content/repositories/releases/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
</code></pre>
<p>ç„¶åmavençš„setting.xmlé…ç½®æ”¹æˆï¼š</p>
<pre><code class="hljs language-xml" lang="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>nexus-aliyun<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>central,!central-ma<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Nexus aliyun<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://maven.aliyun.com/repository/central<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
	 <span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span>  
</code></pre>
<p>è¿™æ ·ä¸€ä¿®æ”¹ï¼Œç†è§£ä¸Šæœ‰æ‰€æ”¹å˜ï¼Œæ¥ä¸‹æ¥ï¼Œå¯¹æ–°é…ç½®ç‚¹ç†è§£è¿›è¡Œåˆ†æ</p>
<pre><code class="hljs language-xml" lang="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>nexus-aliyun<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>central,!central-ma<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Nexus aliyun<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
  		<span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://maven.aliyun.com/repository/central<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
	 <span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span>  
</code></pre>
<p>-<code> mirror</code> å®šä¹‰äº†ä¸€ä¸ªé•œåƒï¼ˆmirrorï¼‰ï¼ŒMaven ä¼šæŠŠå¯¹æŸäº›ä»“åº“çš„è¯·æ±‚é‡å®šå‘åˆ°ä½ æŒ‡å®šçš„é•œåƒåœ°å€ï¼Œä»è€ŒåŠ é€Ÿä¸‹è½½ï¼ˆå°¤å…¶æ˜¯å›½å†…è®¿é—®å®˜æ–¹ä¸­å¤®ä»“åº“å¾ˆæ…¢çš„æƒ…å†µä¸‹ï¼‰ã€‚</p>
<ul>
<li><code>&lt;id&gt;nexus-aliyun&lt;/id&gt;</code>ï¼šè¿™ä¸ªé•œåƒçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå»ºè®®å”¯ä¸€ï¼Œé€šå¸¸å’Œä»“åº“çš„ id ç›¸å…³è”ã€‚</li>
<li><code>&lt;url&gt;https://maven.aliyun.com/repository/central&lt;/url&gt;</code>ï¼šçœŸæ­£çš„é•œåƒåœ°å€ï¼Œæ‰€æœ‰è¢«é•œåƒçš„è¯·æ±‚éƒ½ä¼šé‡å®šå‘åˆ°è¿™é‡Œã€‚è¿™æ˜¯é˜¿é‡Œäº‘æä¾›çš„ Maven ä¸­å¤®ä»“åº“å…¬å…±é•œåƒï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚</li>
<li><code>&lt;mirrorOf&gt;central,!central-ma&lt;/mirrorOf&gt;</code>ï¼šè¿™æ˜¯æœ€å…³é”®çš„éƒ¨åˆ†ï¼Œè¡¨ç¤ºè¿™ä¸ªé•œåƒä»£ç†å“ªäº›ä»“åº“ã€‚æ‹†è§£ä¸€ä¸‹ï¼šcentralï¼šæŒ‡çš„æ˜¯ Maven é»˜è®¤çš„ä¸­å¤®ä»“åº“ï¼Œå…¶ id åœ¨ super pom ä¸­å®šä¹‰ä¸º "central"ï¼Œåœ°å€æ˜¯<a href="https://link.juejin.cn?target=https%3A%2F%2Frepo.maven.apache.org%2Fmaven2%25E3%2580%2582" target="_blank" title="https://repo.maven.apache.org/maven2%E3%80%82" ref="nofollow noopener noreferrer">repo.maven.apache.org/maven2ã€‚</a></li>
<li><code>!central-ma</code>ï¼šè¿™é‡Œçš„ ! è¡¨ç¤ºæ’é™¤ï¼ˆå–åï¼‰ã€‚æ‰€ä»¥æ•´ä½“æ„æ€æ˜¯ï¼šé•œåƒæ‰€æœ‰ id ä¸º "central" çš„ä»“åº“è¯·æ±‚ï¼ŒæŠŠå®ƒä»¬é‡å®šå‘åˆ°é˜¿é‡Œäº‘é•œåƒã€‚ä½†æ’é™¤ id ä¸º "central-ma" çš„ä»“åº“ï¼Œè¿™ä¸ªä»“åº“çš„è¯·æ±‚ä¸ä¼šèµ°é˜¿é‡Œäº‘é•œåƒï¼Œè€Œæ˜¯èµ°å®ƒè‡ªå·±åŸæœ¬é…ç½®çš„åœ°å€ã€‚</li>
</ul>
<h4 data-id="heading-1"><strong>å¼•ç”³ï¼š</strong></h4>
<p>æˆ‘ä»¬è¦æ˜ç™½çš„æ˜¯ï¼Œmavenæ‰€æœ‰çš„é¡¹ç›®éƒ½éšå¼ç»§æ‰¿Super POM,è¿™æ˜¯mavenå†…ç½®çš„é»˜è®¤é…ç½®ï¼Œ
åœ¨Super POM,ä¸­é»˜è®¤å®šä¹‰äº†ä¸€ä¸ªä»“åº“ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>central<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Central Repository<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.maven.apache.org/maven2<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
</code></pre>
<p>è¿™æ˜¯Maven Central Repositoryï¼ˆMaven ä¸­å¤®ä»“åº“ï¼‰ï¼Œå…¨çƒæœ€å¤§çš„å…¬å…±å¼€æº jar åŒ…ä»“åº“ã€‚
æ‰€ä»¥è¿™é‡Œçš„centralå°±å…³è”ä¸Šä¸Šé¢setting.xml mirrofçš„centralã€‚</p>
<p>å½“ä½ çš„ <strong>pom.xml</strong> ä¸­åªå£°æ˜  è€Œ<strong>æ²¡æœ‰é¢å¤–é…ç½® </strong> æ—¶ï¼ŒMaven ä¼šï¼š</p>
<ol>
<li>å…ˆæ£€æŸ¥æœ¬åœ°ä»“åº“ï¼ˆ~/.m2/repositoryï¼‰ã€‚</li>
<li>å¦‚æœæœ¬åœ°æ²¡æœ‰ï¼Œå°±å»é»˜è®¤çš„ "central" ä»“åº“ä¸‹è½½ã€‚</li>
</ol>
<p>å…·ä½“åœ¨å®é™…è¿ç”¨ä¸­ï¼Œpom.xmlçš„repositoriesæ ¹æ®ä½¿ç”¨è€…è‡ªç”±é…ç½®ï¼Œå¯ä»¥æ˜¯å…¬å¸å†…ç½‘ä»“åº“ï¼Œå¯ä»¥ä½¿å…¶ä»–ä»“åº“ï¼Œæˆ‘åœ¨è¿™é‡Œæ˜¯ä»¥mavençš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Frepo1.maven.org%2Fmaven2" target="_blank" title="https://repo1.maven.org/maven2" ref="nofollow noopener noreferrer">repo1.maven.org/maven2</a> æ¥é…ç½®repositoryä¸¾ä¾‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ™ï¸ React Nativeï¼ˆRNï¼‰è¯­éŸ³è¾“å…¥åœºæ™¯å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7592906873089245230</link>    <guid>https://juejin.cn/post/7592906873089245230</guid>    <pubDate>2026-01-09T03:01:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592906873089245230" data-draft-id="7592865044692189190" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ™ï¸ React Nativeï¼ˆRNï¼‰è¯­éŸ³è¾“å…¥åœºæ™¯å…¨è§£æ"/> <meta itemprop="keywords" content="React Native,Android,AIGC"/> <meta itemprop="datePublished" content="2026-01-09T03:01:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ™ï¸ React Nativeï¼ˆRNï¼‰è¯­éŸ³è¾“å…¥åœºæ™¯å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T03:01:43.000Z" title="Fri Jan 09 2026 03:01:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒ± ä¸€ã€ä»ç”µç£æ³¢åˆ° JavaScript å›è°ƒçš„å¥‡å¹»æ—…ç¨‹</h2>
<p>åœ¨ RN ä¸­å®ç°â€œè¯­éŸ³è¾“å…¥â€ï¼Œå°±åƒä¸€ä¸ªæ¥åŠ›èµ›ï¼š<br/>
1ï¸âƒ£ ç”¨æˆ·è¯´è¯ï¼ˆç©ºæ°”æŒ¯åŠ¨äº§ç”Ÿå£°æ³¢ï¼‰<br/>
2ï¸âƒ£ æ“ä½œç³»ç»Ÿåº•å±‚ï¼ˆiOS/Androidï¼‰é€šè¿‡ <strong>éº¦å…‹é£ç¡¬ä»¶</strong> â†’ æ¨¡æ•°è½¬æ¢æˆæ•°å­—ä¿¡å·<br/>
3ï¸âƒ£ è¯­éŸ³è¾“å…¥ SDKï¼ˆGoogle Speechã€ç§‘å¤§è®¯é£ã€Azure Speech SDK ç­‰ï¼‰è´Ÿè´£ï¼š</p>
<ul>
<li>æŠŠéŸ³é¢‘æµå®æ—¶è½¬æˆæ–‡æœ¬</li>
<li>æˆ–è¿”å›è¯­ä¹‰ç†è§£ç»“æœ<br/>
4ï¸âƒ£ RN æ¡¥æ¥å±‚ï¼ˆBridgeï¼‰å°†ç»“æœä¼ åˆ° JavaScript<br/>
5ï¸âƒ£ JavaScript æ›´æ–° UIã€è°ƒç”¨ä¸šåŠ¡é€»è¾‘ã€ç”šè‡³å¯ä»¥è®© AI å†æ¥ç‚¹â€œè„‘è¡¥â€è§£é‡Š</li>
</ul>
<p>ä¸€å¥â€œä½ å¥½â€ï¼Œå…¶å®è·¨è¿‡äº†ï¼š</p>
<blockquote>
<p>ç©ºæ°” â†’ éº¦å…‹é£ â†’ å£°éŸ³èŠ¯ç‰‡ â†’ JNI æˆ– NativeModule â†’ JSçº¿ç¨‹</p>
</blockquote>
<p>å¬èµ·æ¥æœ‰ç‚¹åƒâ€œå£°æ³¢ç‰ˆçš„ä¿¡æ¯æ—¶ç©ºç©¿è¶Šâ€ã€‚ğŸŒŒ</p>
<hr/>
<h2 data-id="heading-1">âš™ï¸ äºŒã€åº•å±‚ç»“æ„æ‹†è§£å›¾ï¼ˆæ–‡å­—ç‰ˆè„‘è¡¥ï¼‰</h2>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·è¯­éŸ³ 
   â†“
éº¦å…‹é£ç¡¬ä»¶é©±åŠ¨
   â†“
æ“ä½œç³»ç»ŸéŸ³é¢‘å±‚ï¼ˆAudioRecord / AVAudioEngineï¼‰
   â†“
Native SDK (Speech-to-Text)
   â†“
RN Bridge (Native Module)
   â†“
JavaScript å›è°ƒ (onSpeechResult)
   â†“
React Component æ›´æ–°æ˜¾ç¤º
</code></pre>
<p>è¿™æ•´æ¡é“¾è·¯çš„å…³é”®åœ¨äºï¼š</p>
<blockquote>
<p>Native æ¨¡å—ä¸ JS çš„é€šä¿¡å¿…é¡»ä¿è¯ <strong>å®æ—¶æ€§å’Œçº¿ç¨‹å®‰å…¨</strong>ã€‚</p>
</blockquote>
<p>å¦åˆ™ï¼Œä½ å¯èƒ½å‡ºç°è¿™æ ·çš„ä½“éªŒï¼š</p>
<blockquote>
<p>ç”¨æˆ·è¯´â€œæ‰“å¼€ç¯â€ï¼Œç³»ç»Ÿå´åœ¨åŠç§’åå›ç­”ï¼šâ€œè¯·ç¨åï¼Œæˆ‘æ­£åœ¨æƒ³â€ã€‚ ğŸ˜‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸ§© ä¸‰ã€åŸºç¡€ä»£ç ç»“æ„æ¼”ç¤º</h2>
<p>æˆ‘ä»¬ä»¥ä¸€ä¸ªæœ€å°å¯è¿è¡Œçš„ä¼ªä»£ç ç¤ºä¾‹ï¼ˆå‡è®¾ä½¿ç”¨è¯­éŸ³è¯†åˆ«åº“ï¼‰ğŸ‘‡</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">View</span>, <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">Text</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-native"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Voice</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@react-native-voice/voice"</span>; <span class="hljs-comment">// ğŸ¤ å‡è®¾æˆ‘ä»¬ä½¿ç”¨ react-native-voice åŒ…</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">VoiceInputDemo</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [text, setText] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">"ç‚¹å‡»å¼€å§‹è¯´è¯..."</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">startListening</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-title class_">Voice</span>.<span class="hljs-title function_">start</span>(<span class="hljs-string">"zh-CN"</span>);
      <span class="hljs-title function_">setText</span>(<span class="hljs-string">"æ­£åœ¨è†å¬ä¸­... ğŸ§"</span>);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-title function_">setText</span>(<span class="hljs-string">`å¯åŠ¨å¤±è´¥ï¼š<span class="hljs-subst">${err.message}</span>`</span>);
    }
  };

  <span class="hljs-title class_">Voice</span>.<span class="hljs-property">onSpeechResults</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (event.<span class="hljs-property">value</span> &amp;&amp; event.<span class="hljs-property">value</span>[<span class="hljs-number">0</span>]) {
      <span class="hljs-title function_">setText</span>(<span class="hljs-string">`è¯†åˆ«ç»“æœï¼š<span class="hljs-subst">${event.value[<span class="hljs-number">0</span>]}</span>`</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex justify-center items-center m-5"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"ğŸ™ å¼€å§‹è¯­éŸ³è¾“å…¥"</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{startListening}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> <span class="hljs-attr">20</span>, <span class="hljs-attr">fontSize:</span> <span class="hljs-attr">18</span> }}&gt;</span>{text}<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
  );
}
</code></pre>
<p>ğŸ§  <strong>å…³é”®ç‚¹è®²è§£ï¼š</strong></p>
<ul>
<li><code>Voice.start("zh-CN")</code> è°ƒç”¨ç³»ç»ŸåŸç”Ÿè¯­éŸ³è¯†åˆ«æœåŠ¡ï¼ˆå¯é€‰è¯­è¨€ï¼‰ã€‚</li>
<li><code>Voice.onSpeechResults</code> = ä» Native å±‚å›è°ƒç»™ JS çº¿ç¨‹ã€‚</li>
<li>RN çš„ Bridge å±‚å¿…é¡»å¤„ç†éŸ³é¢‘æµäº‹ä»¶ï¼Œ<strong>æ³¨æ„å†…å­˜æ³„æ¼ä¸çº¿ç¨‹é˜»å¡</strong>ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">ğŸª„ å››ã€è¯­éŸ³è¾“å…¥çš„åœºæ™¯é­”æ³• âœ¨</h2>
<p>è®©æˆ‘ä»¬çœ‹å‡ ä¸ªâ€œå·¥ä¸šçº§â€ä½¿ç”¨åœºæ™¯ ğŸ‘‡</p>






























<table><thead><tr><th>åœºæ™¯</th><th>æè¿°</th><th>æŠ€æœ¯å…³é”®</th></tr></thead><tbody><tr><td>ğŸ—£ï¸ å³æ—¶è¯­éŸ³è½¬æ–‡å­—</td><td>èŠå¤©è¾“å…¥ã€ä¼šè®®ç¬”è®°</td><td>å®æ—¶æµå¼ STTï¼ˆStreaming Speech-to-Textï¼‰</td></tr><tr><td>ğŸ¯ è¯­éŸ³å‘½ä»¤æ§åˆ¶</td><td>è¯­éŸ³åŠ©æ‰‹ã€æ™ºèƒ½å®¶å±…</td><td>Keyword spotting + æ„å›¾è¯†åˆ«</td></tr><tr><td>ğŸŒ å¤šè¯­è¨€è¯­éŸ³ç¿»è¯‘</td><td>æ—…è¡Œç¿»è¯‘</td><td>TTS + Translate + STT ç»„åˆ</td></tr><tr><td>ğŸ’¬ AI å¯¹è¯è¯­éŸ³åŒ–</td><td>ChatGPT å¼è¯­éŸ³å¯¹è¯</td><td>åŒå‘æµé€šä¿¡ï¼ˆWebSocketï¼‰</td></tr></tbody></table>
<p>æ¯ä¸ªåœºæ™¯éƒ½è¦æ±‚ï¼š</p>
<ul>
<li>ä½å»¶è¿Ÿï¼ˆ&lt; 300msï¼‰</li>
<li>å™ªéŸ³é²æ£’æ€§ï¼ˆNoise Robustnessï¼‰</li>
<li>æ­£ç¡®çš„å›è°ƒåŒæ­¥ï¼ˆPromise / Async å‘¨æœŸï¼‰</li>
</ul>
<blockquote>
<p>å¦åˆ™ä½ çš„è¯­éŸ³åŠ©æ‰‹å¯èƒ½ä¼šå˜æˆå»¶è¿Ÿä¸‰ç§’çš„â€œå¤è¯»æœºç‰ˆ Siriâ€ã€‚ğŸª</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">ğŸ§  äº”ã€AI å†³ç­–èåˆçš„ä¸‹ä¸€æ­¥</h2>
<p>è¯­éŸ³è¾“å…¥åªæ˜¯å…¥å£ï¼ŒAI æ‰æ˜¯çµé­‚ã€‚<br/>
å¦‚æœæˆ‘ä»¬è®©æ¨¡å‹å…·å¤‡ç†è§£å’Œå†³ç­–èƒ½åŠ›ï¼Œå°±èƒ½å‡ºç°ç±»ä¼¼è¿™æ ·çš„æ™ºèƒ½æµç¨‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">function aiBrain(transcript) {
  <span class="hljs-keyword">if</span> (transcript.includes(<span class="hljs-string">"ç¯"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"æ‰“å¼€å®¢å…ç¯ğŸ’¡"</span>;
  <span class="hljs-keyword">if</span> (transcript.includes(<span class="hljs-string">"éŸ³ä¹"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"æ’­æ”¾æ¸©æŸ”çˆµå£«ğŸµ"</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">"æˆ‘æ²¡å¬æ‡‚ï¼Œå¯ä»¥å†è¯´ä¸€éå—ï¼ŸğŸ¤”"</span>;
}
</code></pre>
<p>é…åˆè¯­éŸ³è¯†åˆ«ç»“æœï¼š</p>
<ul>
<li>è¾“å…¥è¯­éŸ³ â€œæ‰“å¼€ç¯â€</li>
<li>è¯†åˆ«æ–‡å­— â€œæ‰“å¼€ç¯â€</li>
<li>AI æ‰§è¡Œ <code>aiBrain("æ‰“å¼€ç¯")</code></li>
<li>åé¦ˆç»“æœ â€œæ‰“å¼€å®¢å…ç¯ğŸ’¡â€</li>
</ul>
<p>äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªæœ€å°çš„<strong>è¯­éŸ³é©±åŠ¨ AI å†³ç­–ç³»ç»Ÿ</strong>ã€‚</p>
<blockquote>
<p>å¬èµ·æ¥ç®€å•ï¼Œå´æ˜¯â€œå¬â€â€œæ‡‚â€â€œåšâ€ä¸‰å±‚ä½“ç³»çš„è”åŠ¨ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ğŸ”‹ å…­ã€æ€§èƒ½ä¸æ¶æ„ä¼˜åŒ–å»ºè®®</h2>






























<table><thead><tr><th>å±‚çº§</th><th>æŠ€æœ¯ç‚¹</th><th>ä¼˜åŒ–å»ºè®®</th></tr></thead><tbody><tr><td>Native éŸ³é¢‘å±‚</td><td>å½•éŸ³é¢‘ç‡ã€ç¼“å­˜æº¢å‡º</td><td>ä½¿ç”¨ 16kHz å•å£°é“ï¼Œå¼‚æ­¥å†™å…¥</td></tr><tr><td>RN Bridge</td><td>é€šä¿¡æ€§èƒ½</td><td>æœ€å°åŒ–æ•°æ®é‡ï¼Œåˆ’åˆ†äº‹ä»¶ä¼˜å…ˆçº§</td></tr><tr><td>JS å±‚</td><td>çŠ¶æ€ç®¡ç†</td><td>é¿å…é¢‘ç¹ re-renderï¼Œä½¿ç”¨ <code>useRef</code> æš‚å­˜</td></tr><tr><td>AI è¯­ä¹‰å±‚</td><td>å»¶è¿Ÿæ§åˆ¶</td><td>æœ¬åœ° + äº‘æ··åˆæ¨ç†æ¶æ„</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6">ğŸ’¡ ä¸ƒã€æ•™å­¦æ€»ç»“</h2>
<blockquote>
<p><strong>ä¸€å¥è¯æ¦‚æ‹¬ï¼š</strong><br/>
RN è¯­éŸ³è¾“å…¥ â‰ˆ å£°éŸ³ä¸ JS çš„ä¸€åœºé«˜é€Ÿâ€œè¯­è¨€æ—…è¡Œâ€ã€‚</p>
</blockquote>



































<table><thead><tr><th>æ¨¡å—</th><th>åŠŸèƒ½</th><th>éš¾ç‚¹</th><th>å·¥ç¨‹å…³é”®è¯</th></tr></thead><tbody><tr><td>éº¦å…‹é£é©±åŠ¨</td><td>æ•è·éŸ³é¢‘</td><td>å™ªéŸ³è¿‡æ»¤</td><td>éŸ³é¢‘ä¸­æ–­æ¢å¤</td></tr><tr><td>Speech SDK</td><td>è¯­éŸ³è¯†åˆ«</td><td>ç½‘ç»œå»¶è¿Ÿ</td><td>æµå¼ä¼ è¾“</td></tr><tr><td>RN Bridge</td><td>æ•°æ®ä¼ é€’</td><td>çº¿ç¨‹é€šä¿¡</td><td>å¼‚æ­¥å›è°ƒ</td></tr><tr><td>JS å±‚</td><td>UI &amp; é€»è¾‘</td><td>é«˜é¢‘äº‹ä»¶</td><td>çŠ¶æ€åŒæ­¥</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-7">ğŸ”® å…«ã€æœªæ¥ç•…æƒ³ï¼šè®©è¯­éŸ³æœ‰â€œçµé­‚â€</h2>
<p>æœªæ¥çš„ RN è¯­éŸ³è¾“å…¥å°†ä¸ä»…ä»…æ˜¯è¯†åˆ«æ–‡å­—ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>æå–æƒ…ç»ªï¼ˆä½ æ˜¯å¼€å¿ƒåœ°è¯´â€œæ‰“å¼€ç¯â€ï¼Œè¿˜æ˜¯æš´èºåœ°å–Šâ€œå¼€ç¯ï¼â€ï¼‰</li>
<li>é¢„æµ‹æ„å›¾ï¼ˆä¸æ˜¯å‘½ä»¤ï¼Œè€Œæ˜¯æ¨æµ‹çœŸå®éœ€è¦ï¼‰</li>
<li>è‡ªåŠ¨é€‚åº”ä¸Šä¸‹æ–‡è”ç³»ï¼ˆå¯¹è¯å¼è¿è´¯æ¨ç†ï¼‰</li>
</ul>
<p>é‚£æ—¶å€™ï¼ŒRN ä¸ä»…æ˜¯ç§»åŠ¨ç•Œé¢æ¡†æ¶ï¼Œæ›´æ˜¯ <strong>ä¸€ä¸ªå¯æºå¸¦çš„è®¤çŸ¥æ¥å£å±‚ï¼ˆCognitive Interface Layerï¼‰</strong> ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C#: åœ¨Wordæ–‡æ¡£ä¸­æ·»åŠ æˆ–ç§»é™¤å¯ç¼–è¾‘åŒºåŸŸ]]></title>    <link>https://juejin.cn/post/7592863358259576886</link>    <guid>https://juejin.cn/post/7592863358259576886</guid>    <pubDate>2026-01-09T02:37:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592863358259576886" data-draft-id="7593139476832157739" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C#: åœ¨Wordæ–‡æ¡£ä¸­æ·»åŠ æˆ–ç§»é™¤å¯ç¼–è¾‘åŒºåŸŸ"/> <meta itemprop="keywords" content="åç«¯,C#"/> <meta itemprop="datePublished" content="2026-01-09T02:37:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¼ºç‚¹å†…å‘"/> <meta itemprop="url" content="https://juejin.cn/user/3414438228006112"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C#: åœ¨Wordæ–‡æ¡£ä¸­æ·»åŠ æˆ–ç§»é™¤å¯ç¼–è¾‘åŒºåŸŸ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3414438228006112/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¼ºç‚¹å†…å‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T02:37:15.000Z" title="Fri Jan 09 2026 02:37:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">C#: åœ¨Wordæ–‡æ¡£ä¸­æ·»åŠ æˆ–ç§»é™¤å¯ç¼–è¾‘åŒºåŸŸ</h2>
<p>åœ¨æ—¥å¸¸åŠå…¬å’Œè‡ªåŠ¨åŒ–æµç¨‹ä¸­ï¼ŒWordæ–‡æ¡£æ‰®æ¼”ç€ä¸å¯æˆ–ç¼ºçš„è§’è‰²ã€‚ç„¶è€Œï¼Œåœ¨è®¸å¤šåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›ç”¨æˆ·èƒ½å¤Ÿéšæ„ä¿®æ”¹æ–‡æ¡£çš„æ‰€æœ‰å†…å®¹ã€‚ä¾‹å¦‚ï¼Œåˆ¶ä½œå…¬å¸å†…éƒ¨æ¨¡æ¿ã€åˆ›å»ºéœ€è¦å¡«å†™ç‰¹å®šä¿¡æ¯çš„è¡¨å•ï¼Œæˆ–è€…å®ç°æ–‡æ¡£çš„æƒé™ç®¡ç†æ—¶ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦é™åˆ¶æ–‡æ¡£çš„ç¼–è¾‘åŒºåŸŸï¼Œåªå…è®¸ç”¨æˆ·ä¿®æ”¹é¢„è®¾çš„ã€ç‰¹å®šçš„å†…å®¹ã€‚è¿™ç§éœ€æ±‚åœ¨ä¼ ç»Ÿçš„Wordæ“ä½œä¸­å¯èƒ½éœ€è¦å¤æ‚çš„è®¾ç½®ï¼Œç”šè‡³æ‰‹åŠ¨æ“ä½œï¼Œæ•ˆç‡ä½ä¸‹ä¸”å®¹æ˜“å‡ºé”™ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•åˆ©ç”¨C#ç¼–ç¨‹è¯­è¨€ï¼Œç»“åˆå¼ºå¤§çš„ç¬¬ä¸‰æ–¹åº“Spire.Doc for .NETï¼Œé«˜æ•ˆã€ç²¾å‡†åœ°åœ¨Wordæ–‡æ¡£ä¸­æ·»åŠ å’Œç§»é™¤å¯ç¼–è¾‘åŒºåŸŸã€‚æˆ‘ä»¬å°†é€šè¿‡å…·ä½“çš„ä»£ç ç¤ºä¾‹ï¼Œä¸ºæ‚¨æ­ç¤ºè¿™ä¸€å®ç”¨æŠ€æœ¯çš„å¥¥ç§˜ï¼Œå¸®åŠ©å¼€å‘è€…è½»æ¾è§£å†³Wordæ–‡æ¡£è‡ªåŠ¨åŒ–å¤„ç†ä¸­çš„ç—›ç‚¹ã€‚</p>
<h3 data-id="heading-1">ç†è§£Wordæ–‡æ¡£çš„å¯ç¼–è¾‘åŒºåŸŸä¸å†…å®¹æ§ä»¶</h3>
<p>åœ¨æ·±å…¥ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£Wordæ–‡æ¡£ä¸­â€œå¯ç¼–è¾‘åŒºåŸŸâ€ï¼ˆEditable Regionï¼‰çš„æ¦‚å¿µã€‚é¡¾åæ€ä¹‰ï¼Œå¯ç¼–è¾‘åŒºåŸŸæ˜¯æŒ‡æ–‡æ¡£ä¸­å…è®¸ç”¨æˆ·è¿›è¡Œä¿®æ”¹çš„éƒ¨åˆ†ï¼Œè€Œå…¶ä»–æœªè¢«æ ‡è®°ä¸ºå¯ç¼–è¾‘çš„åŒºåŸŸåˆ™å—åˆ°ä¿æŠ¤ï¼Œæ— æ³•è¢«æ™®é€šæ–¹å¼ç¼–è¾‘ã€‚è¿™åœ¨æ¨¡æ¿åŒ–æ–‡æ¡£æˆ–éœ€è¦è§„èŒƒè¾“å…¥çš„åœºæ™¯ä¸­å°¤å…¶é‡è¦ã€‚</p>
<p>Wordè‡ªèº«æä¾›äº†ä¸€ç§â€œå†…å®¹æ§ä»¶â€ï¼ˆContent Controlï¼‰çš„åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·æ’å…¥æ–‡æœ¬æ¡†ã€æ—¥æœŸé€‰æ‹©å™¨ã€å¤é€‰æ¡†ç­‰é¢„å®šä¹‰æ§ä»¶ï¼Œè¿™äº›æ§ä»¶å†…çš„å†…å®¹æ˜¯å¯ç¼–è¾‘çš„ã€‚ç„¶è€Œï¼ŒWordè‡ªå¸¦çš„å†…å®¹æ§ä»¶åœ¨ç¼–ç¨‹æ§åˆ¶æ–¹é¢å­˜åœ¨ä¸€å®šçš„å±€é™æ€§ï¼šå®ƒä»¬é€šå¸¸éœ€è¦é€šè¿‡Wordåº”ç”¨ç¨‹åºæ‰‹åŠ¨æ’å…¥ï¼Œä¸”é€šè¿‡VBAæˆ–Open XML SDKè¿›è¡Œç¨‹åºåŒ–æ“ä½œç›¸å¯¹å¤æ‚ï¼Œå­¦ä¹ æ›²çº¿è¾ƒé™¡å³­ã€‚æ­¤å¤–ï¼Œå†…å®¹æ§ä»¶çš„è®¾è®¡æ›´ä¾§é‡äºç»“æ„åŒ–æ•°æ®è¾“å…¥ï¼Œå¯¹äºæ›´çµæ´»çš„â€œåŒºåŸŸâ€çº§åˆ«ä¿æŠ¤ï¼Œå…¶é€‚ç”¨æ€§å¯èƒ½ä¸å¦‚ç›´æ¥è®¾ç½®å¯ç¼–è¾‘åŒºåŸŸã€‚</p>
<p>è€Œ<strong>Spire.Doc for .NET</strong>ä½œä¸ºä¸€æ¬¾ä¸“ä¸šçš„Wordæ–‡æ¡£å¤„ç†åº“ï¼Œä¸ºC#å¼€å‘è€…æä¾›äº†å¼ºå¤§çš„Word è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œèƒ½å¤Ÿä»¥ç¼–ç¨‹æ–¹å¼å¯¹Wordæ–‡æ¡£è¿›è¡Œæ·±å±‚æ¬¡çš„æ“ä½œã€‚å®ƒå…è®¸æˆ‘ä»¬ä»¥æ›´çµæ´»ã€æ›´ç»†ç²’åº¦çš„æ–¹å¼æ§åˆ¶æ–‡æ¡£çš„ç¼–è¾‘æƒé™ï¼Œæ— éœ€ä¾èµ–Wordåº”ç”¨ç¨‹åºï¼Œå³å¯å®ç°å¯¹æ–‡æ¡£å†…å®¹çš„éä¾µå…¥å¼æ“ä½œã€‚è¿™ä½¿å¾—Spire.Doc for .NETåœ¨å¤„ç†å¤æ‚Wordæ–‡æ¡£æ“ä½œæ—¶ï¼Œå±•ç°å‡ºå…¶ç‹¬ç‰¹çš„ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-2">ä½¿ç”¨C#å’ŒSpire.Doc for .NETæ·»åŠ å¯ç¼–è¾‘åŒºåŸŸ</h3>
<p>è¦ä½¿ç”¨Spire.Doc for .NETåº“ï¼Œé¦–å…ˆéœ€è¦é€šè¿‡NuGetåŒ…ç®¡ç†å™¨å°†å…¶æ·»åŠ åˆ°æ‚¨çš„C#é¡¹ç›®ä¸­ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">Install-Package Spire.Doc
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹å¦‚ä½•é€šè¿‡ç¼–ç¨‹æ–¹å¼åœ¨Wordæ–‡æ¡£ä¸­å®šä¹‰ä¸€ä¸ªå¯ç¼–è¾‘åŒºåŸŸã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ä½¿ç”¨<code>PermissionStart</code>å’Œ<code>PermissionEnd</code>å¯¹è±¡æ¥æ ‡è®°å¯ç¼–è¾‘åŒºåŸŸçš„å¼€å§‹å’Œç»“æŸï¼Œå¹¶ä¸ºè¯¥åŒºåŸŸåˆ†é…ä¸€ä¸ªå”¯ä¸€çš„IDã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> Spire.Doc;
<span class="hljs-keyword">using</span> Spire.Doc.Documents;
<span class="hljs-keyword">using</span> Spire.Doc.Fields;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WordEditableArea</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddEditableArea</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> inputFilePath, <span class="hljs-built_in">string</span> outputFilePath, <span class="hljs-built_in">string</span> editableText, <span class="hljs-built_in">string</span> permissionId</span>)</span>
    {
        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„Documentå¯¹è±¡</span>
        Document document = <span class="hljs-keyword">new</span> Document();
        document.LoadFromFile(inputFilePath);

        <span class="hljs-comment">// è®¾ç½®æ–‡æ¡£ä¿æŠ¤ï¼Œåªå…è®¸è¯»å–ï¼Œå¹¶æŒ‡å®šå¯†ç </span>
        <span class="hljs-comment">// åªæœ‰åœ¨æ–‡æ¡£å—ä¿æŠ¤çš„æƒ…å†µä¸‹ï¼Œå¯ç¼–è¾‘åŒºåŸŸçš„é™åˆ¶æ‰ç”Ÿæ•ˆ</span>
        document.Protect(ProtectionType.AllowOnlyReading, <span class="hljs-string">"password"</span>);

        <span class="hljs-comment">// æŸ¥æ‰¾æˆ–åˆ›å»ºéœ€è¦è®¾ç½®ä¸ºå¯ç¼–è¾‘åŒºåŸŸçš„æ®µè½</span>
        <span class="hljs-comment">// è¿™é‡Œä»¥æ–‡æ¡£ç¬¬ä¸€ä¸ªæ®µè½ä¸ºä¾‹ï¼Œå°†æŒ‡å®šæ–‡æœ¬è®¾ç½®ä¸ºå¯ç¼–è¾‘</span>
        Paragraph firstParagraph = document.Sections[<span class="hljs-number">0</span>].Paragraphs[<span class="hljs-number">0</span>];

        <span class="hljs-comment">// æ’å…¥è¦ä½œä¸ºå¯ç¼–è¾‘å†…å®¹çš„æ–‡æœ¬</span>
        TextRange editableTextRange = firstParagraph.AppendText(editableText);

        <span class="hljs-comment">// åˆ›å»ºPermissionStartå¯¹è±¡ï¼Œæ ‡è®°å¯ç¼–è¾‘åŒºåŸŸçš„å¼€å§‹</span>
        PermissionStart start = <span class="hljs-keyword">new</span> PermissionStart(document, permissionId);
        <span class="hljs-comment">// åˆ›å»ºPermissionEndå¯¹è±¡ï¼Œæ ‡è®°å¯ç¼–è¾‘åŒºåŸŸçš„ç»“æŸ</span>
        PermissionEnd end = <span class="hljs-keyword">new</span> PermissionEnd(document, permissionId);

        <span class="hljs-comment">// å°†PermissionStartæ’å…¥åˆ°å¯ç¼–è¾‘æ–‡æœ¬çš„èµ·å§‹ä½ç½®</span>
        firstParagraph.ChildObjects.Insert(firstParagraph.ChildObjects.IndexOf(editableTextRange), start);
        <span class="hljs-comment">// å°†PermissionEndæ’å…¥åˆ°å¯ç¼–è¾‘æ–‡æœ¬çš„ç»“æŸä½ç½®ä¹‹å</span>
        firstParagraph.ChildObjects.Insert(firstParagraph.ChildObjects.IndexOf(editableTextRange) + <span class="hljs-number">1</span>, end);
        
        <span class="hljs-comment">// ä¿å­˜ä¿®æ”¹åçš„æ–‡æ¡£</span>
        document.SaveToFile(outputFilePath, FileFormat.Docx);
        document.Dispose();
        Console.WriteLine(<span class="hljs-string">$"å·²æ·»åŠ å¯ç¼–è¾‘åŒºåŸŸå¹¶ä¿å­˜åˆ°: <span class="hljs-subst">{outputFilePath}</span>"</span>);
    }
}
</code></pre>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼š</p>
<ul>
<li><code>Document document = new Document();</code> ç”¨äºåˆ›å»ºä¸€ä¸ªWordæ–‡æ¡£å¯¹è±¡æˆ–åŠ è½½ç°æœ‰æ–‡æ¡£ã€‚</li>
<li><code>document.Protect(ProtectionType.AllowOnlyReading, "password");</code> æ˜¯å…³é”®ä¸€æ­¥ï¼Œå®ƒè®¾ç½®äº†æ–‡æ¡£çš„ä¿æŠ¤ç±»å‹ã€‚åªæœ‰å½“æ–‡æ¡£å—ä¿æŠ¤æ—¶ï¼Œå¯ç¼–è¾‘åŒºåŸŸçš„é™åˆ¶æ‰ä¼šç”Ÿæ•ˆã€‚<code>AllowOnlyReading</code>è¡¨ç¤ºåªå…è®¸è¯»å–ï¼Œä½†é€šè¿‡<code>PermissionStart</code>å’Œ<code>PermissionEnd</code>æ ‡è®°çš„åŒºåŸŸé™¤å¤–ã€‚</li>
<li><code>PermissionStart</code>å’Œ<code>PermissionEnd</code>æ˜¯Spire.Docæä¾›çš„æ ¸å¿ƒç±»ï¼Œå®ƒä»¬é€šè¿‡ä¸€ä¸ªå…±äº«çš„<code>permissionId</code>æ¥å®šä¹‰ä¸€ä¸ªå®Œæ•´çš„<strong>Editable Region</strong>ã€‚</li>
<li>æˆ‘ä»¬å°†<code>PermissionStart</code>å’Œ<code>PermissionEnd</code>å¯¹è±¡ä½œä¸ºå­å¯¹è±¡æ’å…¥åˆ°æ®µè½ä¸­ï¼Œä»è€Œå°†å®ƒä»¬ä¹‹é—´çš„å†…å®¹æ ‡è®°ä¸ºå¯ç¼–è¾‘ã€‚</li>
</ul>
<h3 data-id="heading-3">ç§»é™¤Wordæ–‡æ¡£ä¸­çš„å¯ç¼–è¾‘åŒºåŸŸ</h3>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸€ä¸ªå¸¦æœ‰å¯ç¼–è¾‘åŒºåŸŸçš„æ–‡æ¡£æ¢å¤ä¸ºå®Œå…¨å¯ç¼–è¾‘çŠ¶æ€ï¼Œæˆ–è€…ç§»é™¤ç‰¹å®šçš„å¯ç¼–è¾‘åŒºåŸŸã€‚Spire.Doc for .NETåŒæ ·æä¾›äº†ç®€æ´çš„æ–¹å¼æ¥å®Œæˆè¿™ä¸€æ“ä½œã€‚</p>
<p>ç§»é™¤å¯ç¼–è¾‘åŒºåŸŸçš„æœ¬è´¨æ˜¯æ‰¾åˆ°å¹¶åˆ é™¤æ–‡æ¡£ä¸­çš„æ‰€æœ‰<code>PermissionStart</code>å’Œ<code>PermissionEnd</code>å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> Spire.Doc;
<span class="hljs-keyword">using</span> Spire.Doc.Documents;
<span class="hljs-keyword">using</span> Spire.Doc.Fields;
<span class="hljs-keyword">using</span> System;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WordEditableAreaRemover</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RemoveAllEditableAreas</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> inputFilePath, <span class="hljs-built_in">string</span> outputFilePath</span>)</span>
    {
        Document document = <span class="hljs-keyword">new</span> Document();
        document.LoadFromFile(inputFilePath);

        <span class="hljs-comment">// éå†æ–‡æ¡£ä¸­çš„æ‰€æœ‰èŠ‚</span>
        <span class="hljs-keyword">foreach</span> (Section section <span class="hljs-keyword">in</span> document.Sections)
        {
            <span class="hljs-comment">// éå†èŠ‚ä¸­çš„æ‰€æœ‰æ®µè½</span>
            <span class="hljs-keyword">foreach</span> (Paragraph paragraph <span class="hljs-keyword">in</span> section.Body.Paragraphs)
            {
                <span class="hljs-comment">// ä»åå‘å‰éå†æ®µè½çš„å­å¯¹è±¡ï¼Œé¿å…åˆ é™¤å…ƒç´ åç´¢å¼•é”™ä¹±</span>
                <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = paragraph.ChildObjects.Count - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)
                {
                    DocumentObject obj = paragraph.ChildObjects[i];

                    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºPermissionStartæˆ–PermissionEndå¯¹è±¡</span>
                    <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">is</span> PermissionStart || obj <span class="hljs-keyword">is</span> PermissionEnd)
                    {
                        <span class="hljs-comment">// ç§»é™¤è¯¥å¯¹è±¡</span>
                        paragraph.ChildObjects.Remove(obj);
                    }
                }
            }
        }
        
        <span class="hljs-comment">// å¦‚æœæ–‡æ¡£ä¹‹å‰è®¾ç½®äº†ä¿æŠ¤ï¼Œç§»é™¤å¯ç¼–è¾‘åŒºåŸŸåï¼Œ</span>
        <span class="hljs-comment">// å¯ä»¥é€‰æ‹©å–æ¶ˆæ–‡æ¡£ä¿æŠ¤ï¼Œä½¿å…¶å®Œå…¨å¯ç¼–è¾‘</span>
        document.Unprotect(); 

        <span class="hljs-comment">// ä¿å­˜ä¿®æ”¹åçš„æ–‡æ¡£</span>
        document.SaveToFile(outputFilePath, FileFormat.Docx);
        document.Dispose();
        Console.WriteLine(<span class="hljs-string">$"å·²ç§»é™¤æ‰€æœ‰å¯ç¼–è¾‘åŒºåŸŸå¹¶ä¿å­˜åˆ°: <span class="hljs-subst">{outputFilePath}</span>"</span>);
    }
}
</code></pre>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼š</p>
<ul>
<li>æˆ‘ä»¬é€šè¿‡åµŒå¥—å¾ªç¯éå†äº†æ–‡æ¡£çš„æ‰€æœ‰<code>Section</code>å’Œ<code>Paragraph</code>ã€‚</li>
<li>åœ¨æ¯ä¸ª<code>Paragraph</code>ä¸­ï¼Œæˆ‘ä»¬éå†å…¶<code>ChildObjects</code>ï¼ŒæŸ¥æ‰¾<code>PermissionStart</code>å’Œ<code>PermissionEnd</code>å®ä¾‹ã€‚</li>
<li>ä¸€æ—¦æ‰¾åˆ°ï¼Œå°±å°†å…¶ä»<code>ChildObjects</code>é›†åˆä¸­ç§»é™¤ã€‚</li>
<li><strong>æ³¨æ„ï¼š</strong> ä»é›†åˆä¸­ç§»é™¤å…ƒç´ æ—¶ï¼Œä»åå‘å‰éå†æ˜¯ä¸€ç§æ¨èçš„åšæ³•ï¼Œä»¥é¿å…ç´¢å¼•åœ¨åˆ é™¤å…ƒç´ åå‘ç”Ÿåç§»ã€‚</li>
<li><code>document.Unprotect();</code> è¿™ä¸€è¡Œéå¸¸é‡è¦ï¼Œå®ƒå–æ¶ˆäº†æ–‡æ¡£çš„ä¿æŠ¤çŠ¶æ€ï¼Œä½¿å¾—æ–‡æ¡£å®Œå…¨å¯ç¼–è¾‘ã€‚</li>
</ul>
<h3 data-id="heading-4">ç»“è®º</h3>
<p>é€šè¿‡æœ¬æ–‡çš„ä»‹ç»å’Œä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬äº†è§£äº†å¦‚ä½•åˆ©ç”¨C#å’Œ<strong>Spire.Doc for .NET</strong>åº“ï¼Œçµæ´»åœ°åœ¨Wordæ–‡æ¡£ä¸­æ·»åŠ å’Œç§»é™¤å¯ç¼–è¾‘åŒºåŸŸã€‚è¿™é¡¹æŠ€æœ¯åœ¨Word è‡ªåŠ¨åŒ–ã€C# ç¼–ç¨‹ä»¥åŠåˆ›å»ºæ™ºèƒ½æ¨¡æ¿å’Œè¡¨å•æ—¶å…·æœ‰æé«˜çš„å®ç”¨ä»·å€¼ã€‚</p>
<p>ç›¸è¾ƒäºWordè‡ªå¸¦çš„å†…å®¹æ§åˆ¶ï¼ŒSpire.Doc for .NETæä¾›çš„<code>PermissionStart</code>å’Œ<code>PermissionEnd</code>æœºåˆ¶åœ¨å¤„ç†â€œåŒºåŸŸâ€çº§åˆ«çš„ç¼–è¾‘é™åˆ¶æ—¶ï¼Œæ˜¾å¾—æ›´åŠ ç›´æ¥å’Œå¼ºå¤§ï¼Œå¹¶ä¸”å®Œå…¨é€šè¿‡ä»£ç æ§åˆ¶ï¼Œå®ç°äº†éä¾µå…¥å¼æ“ä½œã€‚è¿™ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæ›´ç²¾ç»†åœ°ç®¡ç†æ–‡æ¡£å†…å®¹ï¼Œæå‡äº†è‡ªåŠ¨åŒ–å¤„ç†çš„æ•ˆç‡å’Œçµæ´»æ€§ã€‚</p>
<p>æŒæ¡è¿™é¡¹æŠ€æœ¯ï¼Œæ‚¨å°†èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°åˆ¶ä½œå—ä¿æŠ¤çš„Wordæ¨¡æ¿ï¼Œå®ç°å¤æ‚çš„æ–‡æ¡£æƒé™ç®¡ç†ï¼Œä»è€Œåœ¨å„ç§ä¸šåŠ¡åœºæ™¯ä¸­å‘æŒ¥Wordæ–‡æ¡£çš„æœ€å¤§æ½œåŠ›ã€‚å¤§å®¶ä¹Ÿå¯ä»¥æ¢ç´¢Spire.Doc for .NETåœ¨å…¶ä»–Wordæ–‡æ¡£æ“ä½œæ–¹é¢çš„å¼ºå¤§èƒ½åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘çš„Vide Codingå·¥å…·çš„å°è¯•â€”â€”ç‰ˆæœ¬é—®é¢˜çš„è‹¦ä¹‹2]]></title>    <link>https://juejin.cn/post/7592819937652703247</link>    <guid>https://juejin.cn/post/7592819937652703247</guid>    <pubDate>2026-01-08T22:42:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592819937652703247" data-draft-id="7592787377657085986" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘çš„Vide Codingå·¥å…·çš„å°è¯•â€”â€”ç‰ˆæœ¬é—®é¢˜çš„è‹¦ä¹‹2"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-01-08T22:42:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŠ€æœ¯äººçš„æµæ°´è´¦"/> <meta itemprop="url" content="https://juejin.cn/user/3986165296293584"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘çš„Vide Codingå·¥å…·çš„å°è¯•â€”â€”ç‰ˆæœ¬é—®é¢˜çš„è‹¦ä¹‹2
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3986165296293584/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŠ€æœ¯äººçš„æµæ°´è´¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T22:42:32.000Z" title="Thu Jan 08 2026 22:42:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æˆ‘æ˜¯ä¸€ä¸ªæŠ€æœ¯äººï¼Œæ—¢ä¸æ˜¯é‚£ç§å¤©å¤©éœ€è¦å†™ä»£ç çš„ï¼Œä¹Ÿä¸æ˜¯é‚£ç§å¤©å¤©éƒ½ä¸å†™ä»£ç çš„ï¼ŒCodingçº¯å±å…´è¶£ï¼Œä¸æ±‚å®Œå…¨é è¿™ä¸ªåƒé¥­ï¼Œåªæ±‚åœ¨æ¢ç´¢çš„è¿‡ç¨‹ä¸­æ‰¾åˆ°è‡ªå·±çš„å¿«ä¹ã€‚æ­£å¦‚ç½‘åæ‰€ç¤ºï¼Œæˆ‘çš„æ–‡é£å°†ä¼šæ˜¯â€œæµæ°´è´¦â€ï¼Œå› ä¸ºæˆ‘ç›¸ä¿¡ï¼ŒæŠ€æœ¯çš„æ¢ç´¢æ°¸è¿œåœ¨è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰äººåœ¨ä¹è¿‡ç¨‹ï¼Œé‚£ä¹ˆç»è¿‡ä¸€å®šæç‚¼çš„æ¢ç´¢æµæ°´è´¦ï¼Œå°†æ¯”ä¸€ä¸ªç²¾ç‚¼çš„æ€»ç»“æ›´æœ‰ä»·å€¼ã€‚</p>
</blockquote>
<h2 data-id="heading-0">è¿™ä¹ˆè‹¦æˆ‘è¯¥æ€ä¹ˆåŠ</h2>
<p>å°è¿‡ä¹‹å‰é¢è¯•çš„ç‰ˆæœ¬çš„è‹¦ï¼Œå’Œä¸Šé¢çš„è¿™äº›è‹¦ä¹‹åï¼Œæˆ‘æƒ³è¦æœ‰æ‰€æ”¹å˜ï¼Œç”±äºä¹‹å‰åšè¿‡AIæ–¹é¢çš„å°åº”ç”¨ï¼Œæˆ‘çŸ¥é“è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ï¼Œå°½å¯èƒ½å¤šçš„æä¾›ç»™AIå®ƒæ²¡æœ‰çš„ä¿¡æ¯ï¼Œåœ¨è¿™é‡Œå°±æ˜¯æœ€æ–°ç‰ˆæœ¬çš„ç‰¹æ€§å’Œä»£ç æ ·ä¾‹ï¼Œé‚£ä¹ˆåº”è¯¥ç”¨ä»€ä¹ˆæ–¹å¼å»å‘ˆç°å‘¢ï¼Ÿæˆ‘æœ€å…ˆæƒ³åˆ°çš„æ˜¯MCPï¼Œå¦‚æœAIåœ¨Vibe Codingçš„è¿‡ç¨‹ä¸­çŸ¥é“å®ƒå¯èƒ½ä¸çŸ¥é“ï¼Œé‚£ä¹ˆåº”è¯¥å°±æœ‰å¯èƒ½ä¼šå»æƒ³åŠæ³•å»æ‰¾ç›¸å…³çš„æ–°ç‰¹æ€§å’Œä»£ç æ ·ä¾‹ï¼Œç„¶ååœ¨ä»£ç æ ·ä¾‹çš„æŒ‡å¯¼ä¸‹è¿›è¡Œç¼–ç ï¼ŒMCPåº”è¯¥å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªè®©AIåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¯ä»¥å»è°ƒç”¨å¤–éƒ¨å·¥å…·çš„æ¥å£ã€‚</p>
<p>é‚£ä¹ˆä¸‹é¢å°±å‡ºç°äº†2ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>è¿™äº›ç‰¹æ€§å’Œä»£ç æ ·ä¾‹å»å“ªé‡Œæ‰¾ï¼Ÿ</li>
<li>æ‰¾æ¥äº†è¿™äº›ä¿¡æ¯æ€ä¹ˆé€šè¿‡MCPæ¥æä¾›æœåŠ¡å‘¢ï¼Ÿ</li>
</ol>
<p>äºæ˜¯æˆ‘å°è¯•è¯·æ•™Geminiï¼Œå…ˆè¯´ç»“è®ºï¼Œé¦–å…ˆç°åœ¨ä¼¼ä¹æ²¡æœ‰ä¸€ç«™å¼çš„æ–¹æ¡ˆï¼Œä½†æ˜¯åˆ†æˆä¸¤æ­¥çš„è¯è¿˜æ˜¯æœ‰ä¸€äº›åŠæ³•çš„ã€‚å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæ–°ç‰ˆæœ¬çš„ç‰¹æ€§å’Œä»£ç æ ·ä¾‹åŸºæœ¬åœ¨åº“æ–‡æ¡£æˆ–ç”Ÿæˆå¼æ–‡æ¡£é‡Œéƒ½æœ‰ï¼Œä½†æ˜¯æ€ä¹ˆçˆ¬ä¸‹æ¥æ˜¯ä¸ªé—®é¢˜ï¼Œä¸‹é¢æˆ‘ä»¬å°±è¯´è¯´æ€ä¹ˆçˆ¬æ–‡æ¡£çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-1">æ–‡æ¡£çš„çˆ¬å–</h3>
<p>Geminiç»™å‡ºçš„æ–¹æ¡ˆåŸºæœ¬ä¸Šå°±æ˜¯ä¸¤ç§ï¼ŒSaaSå¹³å°çš„æ–‡æ¡£çˆ¬å–å’Œè£…åœ¨æœ¬åœ°çš„çˆ¬å–åº“ï¼Œçˆ¬ä¸‹æ¥ä¹‹åéƒ½èƒ½è½¬æˆmarkdownã€‚è¿™é‡Œæˆ‘å®é™…å°è¯•äº†ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>SaaSæ–¹æ¡ˆ: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.firecrawl.dev%2F" target="_blank" title="https://www.firecrawl.dev/" ref="nofollow noopener noreferrer">www.firecrawl.dev/</a>
<ol>
<li>ä¸€å®šç”¨é‡ä»¥ä¸‹å…è´¹ï¼Œä½†æ˜¯åŸºæœ¬æ¯æœˆåªå¤Ÿçˆ¬500ç¯‡</li>
<li>è¿˜æ”¯æŒä¸€äº›AIç°åœºçˆ¬çš„æ–¹æ¡ˆï¼Œå•ç‹¬æ”¶è´¹</li>
<li>æ”¯æŒé€šè¿‡MCP+AIç°åœºçˆ¬ï¼Œä½†æ˜¯ä¼¼ä¹ä¸æ”¯æŒMCP+å·²ç»çˆ¬å¥½çš„å†…å®¹</li>
<li>è¿™ä¸ªfirecrawlä¹Ÿå¼€æºæœ¬åœ°éƒ¨ç½²ï¼Œä½†æ˜¯é‚£ä¸ªDocker Composeçš„æ„å»ºè¿‡ç¨‹å¾ˆæ¼«é•¿ï¼Œä¹Ÿæœ‰å„ç§æŠ¥é”™ï¼ˆæˆ‘ç”¨çš„æ˜¯ä¸€ä¸ªå·²ç»ä¸èƒ½å†æ›´æ–°çš„è€Macï¼Œå°±ä¸è¦å†æŠ˜è…¾è‡ªå·±äº†ï¼‰ï¼Œæˆ‘ä¹Ÿæ˜¯è¯•äº†ä¸€ä¸‹å°±æ”¾å¼ƒäº†ã€‚</li>
</ol>
</li>
<li>æœ¬åœ°æ–¹æ¡ˆ: Crawl4ai
<ol>
<li>è¿™ä¸ªæ˜¯Pythonçš„åº“ï¼Œå„ç§çˆ¬å–æ–¹å¼å’Œè¿‡æ»¤ä¹Ÿéƒ½æ”¯æŒï¼Œæ•ˆæœä¹Ÿä¸å·®ï¼Œå…³é”®æ˜¯ä¹Ÿä¸è¦é’±ï¼Œæ•ˆæœå˜›ï¼Œè¿‡ä¼šå„¿æˆ‘ä»¬ä¸€èµ·çœ‹ã€‚</li>
<li>ç”¨èµ·æ¥å€’æ˜¯å¾ˆæ–¹ä¾¿ï¼Œè®©AIå¸®å¿™å†™ä¸€æ®µè°ƒç”¨ä»£ç ï¼Œå†™ä¸€ä¸ªæ–‡æ¡£çš„æ ¹ç›®å½•ï¼Œå†™ä¸€ä¸ªè¿‡æ»¤å‰ç¼€å°±å¯ä»¥äº†ã€‚</li>
</ol>
</li>
</ol>
<p>AIå‘Šè¯‰æˆ‘Cursorå†…ç½®çš„åº”è¯¥ä¹Ÿæ˜¯firecrawlçš„æ–¹æ¡ˆï¼Œæ‰€ä»¥è¿™ä¸ªSaaSè¿˜æ”¶é’±åº”è¯¥å·®ä¸äº†ï¼Œæˆ‘å®é™…å°è¯•è®©å®ƒå»çˆ¬äº†ä¸€äº›LangChainçš„æ–‡æ¡£ï¼Œæ•ˆæœè¿˜ä¸é”™ã€‚ä½†æ˜¯é¢åº¦ç”¨çš„å¤ªå¿«ï¼Œä¸äº¤é’±ä¼°è®¡æ˜¯ç”¨ä¸äº†äº†ã€‚</p>
<p>è€Œåœ¨å»è¯•Crawl4aiçš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯è¿™ä¸ªè·‘åœ¨å“ªçš„é—®é¢˜ï¼Œæœ¬æ¥å¸¸ç”¨çš„æ–‡æ¡£éƒ½åœ¨å¤–é¢ï¼Œè€Œçˆ¬å–æœ¬æ¥æ¥å›é€šä¿¡å°±è¦èµ°å¾ˆå¤šæ¬¡ï¼Œåˆæœ‰å¯èƒ½å¾ˆå®¹æ˜“è¢«å¢™ï¼Œè€ƒè™‘äº†ä¸€ä¼šå„¿ï¼Œæˆ‘æƒ³åˆ°çš„ä¸€ä¸ªå¥½åœ°æ–¹æ˜¯: Google Colabã€‚</p>
<p>æœ‰äººå¯èƒ½è¦è¯´æˆ‘æ€ä¹ˆè¿™ä¹ˆå–œæ¬¢Gå®¶çš„äº§å“ï¼Œè€Œäº‹å®æ˜¯ï¼ŒGå®¶ç¡®å®æä¾›äº†å¤ªå¤šæˆæœ¬ä½ï¼ˆå¾ˆå¤šéƒ½å…è´¹ï¼‰åˆå¼€æ”¾çš„æ–¹æ¡ˆç»™å¼€å‘è€…ï¼Œè®©æˆ‘ä»¬è‡ªç”±å»å‘æŒ¥ã€‚Google Colabçš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªåœ¨çº¿çš„Jupyter Notebookï¼Œè¿è¡Œåœ¨ä¸´æ—¶åˆ†é…çš„è™šæ‹Ÿæœºä¸Šï¼Œåˆè¡·åº”è¯¥è¿˜æ˜¯åšML/AIå’Œç§‘å­¦è®¡ç®—ç›¸å…³çš„å†…å®¹ï¼Œè€Œä½ çº¯ç²¹æŠŠå®ƒå½“æˆä¸€ä¸ªåœ¨çº¿çš„ï¼Œåœ¨å¤–é¢çš„Jupyter Notebookä¹Ÿå®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚è¿™é‡Œå®‰åˆ©çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ä¸ªJupyter Notebookå¯ä»¥æä¾›å…è´¹çš„GPUä½¿ç”¨é¢åº¦ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³ç”¨å®ƒæµ…æµ…å°è¯•ä¸€ä¸‹LLMçš„å¾®è°ƒç”šè‡³BERTçš„å°è§„æ¨¡é¢„è®­ç»ƒä¹Ÿæœªå°ä¸å¯ã€‚åœ¨è¿™é‡Œæˆ‘é€šè¿‡Jupyter NotebookæŒ‚è½½Google Driveçš„æ–¹å¼ï¼Œå°±å¯ä»¥è®©Colabå¸®æˆ‘å»çˆ¬å¯¹åº”é¡µé¢ï¼Œåªè¦è®¾å¥½sleepé—´éš”ï¼Œçˆ¬äº†å‡ åƒé¡µä¹Ÿæ²¡æœ‰è¢«å¢™ã€‚</p>
<p>ä¸‹é¢åˆ†äº«æˆ‘çš„Jupyterçš„çˆ¬å–Kubernetes JavaScript SDKæ–‡æ¡£ï¼ˆæ²¡é”™ï¼Œæˆ‘æŠŠæ–‡æ¡£hoståˆ°ä¸€ä¸ªgithub.ioä¸Šäº†ï¼‰çˆ¬å–ä»£ç :</p>
<pre><code class="hljs language-python" lang="python">!pip install crawl4ai <span class="hljs-comment"># å®‰è£…crawl4aiï¼Œå»ºè®®æŠŠè¿™ä¸€è¡Œå•ç‹¬å†™ä¸€ä¸ªä»£ç æ¡†ï¼Œå› ä¸ºé¦–æ¬¡è¿è¡Œåå¯èƒ½éœ€è¦ç‚¹å‡»é‡å¯CoLabçš„Runtime</span>
!crawl4ai-setup <span class="hljs-comment"># crawl4aiåˆå§‹åŒ–</span>

<span class="hljs-keyword">from</span> google.colab <span class="hljs-keyword">import</span> drive 
drive.mount(<span class="hljs-string">'/content/drive'</span>) <span class="hljs-comment"># æŒ‚è½½Google Driveç½‘ç›˜</span>

<span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse
<span class="hljs-keyword">from</span> crawl4ai <span class="hljs-keyword">import</span> AsyncWebCrawler, BrowserConfig, CrawlerRunConfig, CacheMode

<span class="hljs-comment"># ==================== é…ç½®åŒº ====================</span>
<span class="hljs-comment"># 1. ç›®æ ‡ä¸èŒƒå›´</span>
BASE_URL = <span class="hljs-string">"https://zhibinyang.github.io/kubernetes-client-node-docs-v1.4-unofficial/modules/index.html"</span>
PREFIX = <span class="hljs-string">"https://zhibinyang.github.io/kubernetes-client-node-docs-v1.4-unofficial/"</span>

<span class="hljs-comment"># 2. åç¼€è¿‡æ»¤ (è®¾ç½®ä¸º None æˆ– [] åˆ™ä¸è¿‡æ»¤åç¼€ï¼ŒæŠ“å–å‰ç¼€ä¸‹çš„æ‰€æœ‰é¡µé¢)</span>
ALLOWED_EXTENSIONS = [<span class="hljs-string">'.html'</span>, <span class="hljs-string">'.htm'</span>]

<span class="hljs-comment"># 3. å­˜å‚¨è®¾ç½®</span>
OUTPUT_DIR = <span class="hljs-string">"/content/drive/MyDrive/Docs/Kubernetes-Node"</span>
TRACKER_FILE = os.path.join(OUTPUT_DIR, <span class="hljs-string">"crawled_urls.txt"</span>)

<span class="hljs-comment"># 4. çˆ¬å–åå¥½</span>
SLEEP_TIME = <span class="hljs-number">1.0</span>  <span class="hljs-comment"># é—´éš”ç§’æ•°</span>
<span class="hljs-comment"># ===============================================</span>

os.makedirs(OUTPUT_DIR, exist_ok=<span class="hljs-literal">True</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">clean_url</span>(<span class="hljs-params">url</span>):
    <span class="hljs-string">"""å»é™¤é”šç‚¹å’ŒæŸ¥è¯¢å‚æ•°ï¼Œç¡®ä¿å”¯ä¸€æ€§"""</span>
    <span class="hljs-keyword">return</span> url.split(<span class="hljs-string">'#'</span>)[<span class="hljs-number">0</span>].split(<span class="hljs-string">'?'</span>)[<span class="hljs-number">0</span>].rstrip(<span class="hljs-string">'/'</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">should_crawl</span>(<span class="hljs-params">url, prefix, processed_set, allowed_exts</span>):
    <span class="hljs-string">"""åˆ¤æ–­ä¸€ä¸ª URL æ˜¯å¦ç¬¦åˆçˆ¬å–æ¡ä»¶"""</span>
    cleaned = clean_url(url)

    <span class="hljs-comment"># åŸºæœ¬æ¡ä»¶ï¼šæ²¡çˆ¬è¿‡ä¸”ç¬¦åˆå‰ç¼€</span>
    <span class="hljs-keyword">if</span> cleaned <span class="hljs-keyword">in</span> processed_set <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> cleaned.startswith(prefix):
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

    <span class="hljs-comment"># åç¼€æ¡ä»¶ï¼šå¦‚æœè®¾ç½®äº†è¿‡æ»¤åˆ—è¡¨ï¼Œåˆ™å¿…é¡»åŒ¹é…å…¶ä¸­ä¹‹ä¸€</span>
    <span class="hljs-keyword">if</span> allowed_exts:
        path = urlparse(cleaned).path
        <span class="hljs-comment"># å¤„ç† index æƒ…å†µï¼šå¦‚æœè·¯å¾„ä»¥ / ç»“å°¾ï¼Œé€šå¸¸å¯¹åº” index.html</span>
        <span class="hljs-keyword">if</span> path.endswith(<span class="hljs-string">'/'</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> os.path.basename(path):
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">any</span>(path.lower().endswith(ext.lower()) <span class="hljs-keyword">for</span> ext <span class="hljs-keyword">in</span> allowed_exts)

    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_file_name</span>(<span class="hljs-params">url</span>):
    <span class="hljs-string">"""é€šç”¨å‘½åé€»è¾‘ï¼šå–æœ€åä¸¤çº§è·¯å¾„å"""</span>
    path = urlparse(clean_url(url)).path.strip(<span class="hljs-string">'/'</span>)
    <span class="hljs-comment"># ç§»é™¤æ‰€æœ‰å·²çŸ¥çš„æ‰©å±•ååç¼€ï¼Œä¾¿äºç»Ÿä¸€å­˜ä¸º .md</span>
    <span class="hljs-keyword">if</span> ALLOWED_EXTENSIONS:
        <span class="hljs-keyword">for</span> ext <span class="hljs-keyword">in</span> ALLOWED_EXTENSIONS:
            path = re.sub(re.escape(ext) + <span class="hljs-string">r'$'</span>, <span class="hljs-string">''</span>, path, flags=re.IGNORECASE)

    parts = [p <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> path.split(<span class="hljs-string">'/'</span>) <span class="hljs-keyword">if</span> p]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(parts) &gt;= <span class="hljs-number">2</span>:
        name = <span class="hljs-string">f"<span class="hljs-subst">{parts[-<span class="hljs-number">2</span>]}</span>-<span class="hljs-subst">{parts[-<span class="hljs-number">1</span>]}</span>"</span>
    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(parts) == <span class="hljs-number">1</span>:
        name = parts[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">else</span>:
        name = <span class="hljs-string">"index"</span>

    <span class="hljs-keyword">return</span> re.sub(<span class="hljs-string">r'[^\w\-]'</span>, <span class="hljs-string">'_'</span>, name) + <span class="hljs-string">".md"</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">universal_crawler</span>():
    <span class="hljs-comment"># 1. åŠ è½½è¿›åº¦</span>
    processed_urls = <span class="hljs-built_in">set</span>()
    <span class="hljs-keyword">if</span> os.path.exists(TRACKER_FILE):
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(TRACKER_FILE, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:
            processed_urls = <span class="hljs-built_in">set</span>(line.strip() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f <span class="hljs-keyword">if</span> line.strip())

    <span class="hljs-comment"># 2. çˆ¬è™«é…ç½®</span>
    browser_config = BrowserConfig(headless=<span class="hljs-literal">True</span>)
    run_config = CrawlerRunConfig(
        cache_mode=CacheMode.BYPASS,
        word_count_threshold=<span class="hljs-number">100</span>,
        remove_overlay_elements=<span class="hljs-literal">True</span>
    )

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> AsyncWebCrawler(config=browser_config) <span class="hljs-keyword">as</span> crawler:
        queue = [BASE_URL]

        <span class="hljs-keyword">while</span> queue:
            current_raw_url = queue.pop(<span class="hljs-number">0</span>)
            current_url = clean_url(current_raw_url)

            <span class="hljs-comment"># å†æ¬¡æ£€æŸ¥ï¼ˆé˜²æ­¢é˜Ÿåˆ—ä¸­å­˜åœ¨é‡å¤ï¼‰</span>
            <span class="hljs-keyword">if</span> current_url <span class="hljs-keyword">in</span> processed_urls:
                <span class="hljs-keyword">continue</span>

            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸš€ Processing: <span class="hljs-subst">{current_url}</span>"</span>)

            result = <span class="hljs-keyword">await</span> crawler.arun(url=current_url, config=run_config)

            <span class="hljs-keyword">if</span> result.success:
                <span class="hljs-comment"># A. ä¿å­˜æ–‡ä»¶</span>
                file_name = get_file_name(current_url)
                file_path = os.path.join(OUTPUT_DIR, file_name)
                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">"w"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
                    f.write(result.markdown)

                <span class="hljs-comment"># B. æ›´æ–°è¿½è¸ªå™¨</span>
                processed_urls.add(current_url)
                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(TRACKER_FILE, <span class="hljs-string">"a"</span>) <span class="hljs-keyword">as</span> f:
                    f.write(current_url + <span class="hljs-string">"\n"</span>)

                <span class="hljs-comment"># C. å‘ç°æ–°é“¾æ¥</span>
                <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> result.links.get(<span class="hljs-string">"internal"</span>, []):
                    link_url = clean_url(link[<span class="hljs-string">'href'</span>])
                    <span class="hljs-keyword">if</span> should_crawl(link_url, PREFIX, processed_urls, ALLOWED_EXTENSIONS):
                        queue.append(link_url)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ Failed: <span class="hljs-subst">{current_url}</span> - <span class="hljs-subst">{result.error_message}</span>"</span>)

            <span class="hljs-keyword">await</span> asyncio.sleep(SLEEP_TIME)

<span class="hljs-comment"># è¿è¡Œ</span>
<span class="hljs-keyword">await</span> universal_crawler()
</code></pre>
<p>CoLabç›¸å¯¹æ¥è¯´æœ‰ä¸€ä¸ªé™åˆ¶å°±æ˜¯ï¼Œå®ƒéœ€è¦ä½ ä¿æŒæµè§ˆå™¨å¼€å¯ä¸”ç½‘ç»œæŒç»­è¿æ¥ï¼Œæ‰èƒ½ä¿ç•™ä½ çš„èµ„æºï¼Œå¯¹äºè¿™ç§ç¨‹åº¦çš„èµ„æºï¼ŒåŸºæœ¬ä¸Šå…¨å¤©ä¸€ç›´å¼€ç€ä¹Ÿä¸æ˜¯é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœç½‘ç»œæ–­äº†è¶…è¿‡30åˆ†é’Ÿï¼Œé‚£ä¹ˆèµ„æºå°±ä¼šè¢«é‡Šæ”¾ï¼Œè€Œä½ çš„è„šæœ¬å°±åœæ­¢äº†ï¼Œæ‰€ä»¥ä¸Šé¢çš„è„šæœ¬ä¸€å®šç¨‹åº¦ä¸Šä¹Ÿè€ƒè™‘äº†é‡ä¼ ï¼Œä½†æ˜¯å› ä¸ºæ²¡æœ‰å­˜ä¸‹æ¥åŸå§‹çš„é¡µé¢HTMLï¼Œæ‰€ä»¥å³ä½¿è¦ç»§ç»­ä¹Ÿåªèƒ½å¤ç”¨ä¹‹å‰çˆ¬è¿‡çš„é¡µé¢åˆ—è¡¨ï¼Œè€Œéœ€è¦æ¢ä¸€ä¸ªé¡µé¢å…¥å£ã€‚</p>
<p>ä¸Šé¢çš„ä»£ç é‡Œçš„Kubernetesçš„æ–‡æ¡£æˆ‘æ˜¯ç¬¬äºŒæ³¢çˆ¬çš„ï¼Œç¬¬ä¸€æ³¢çˆ¬çš„æ˜¯LangChain.jså’ŒLangGraph.jsçš„å…¨ç«™æ–‡æ¡£ï¼Œå¤§æ¦‚400å¤šé¡µï¼Œè€Œå½“æˆ‘åœ¨è·‘Kubernetesçš„æ—¶å€™ï¼Œæˆ‘å·²ç»æµ‹è¯•å®Œäº†LangChain.jsçˆ¬å–åæŸ¥è¯¢çš„æ•ˆæœï¼Œçœ‹äº†ç»“æœä¹‹åæˆ‘å°±æ²¡æœ‰ä¸€ç›´å¼€æœºè®©Kubernetesè·‘å®Œï¼Œæˆ‘å°±æ‹¿ä¸€ç¯‡çˆ¬ä¸‹æ¥çš„æ–‡æ¡£ç»™å¤§å®¶å…ˆçœ‹çœ‹ï¼Œä¸‹ä¸€èŠ‚æˆ‘ä»¬å†è¯´è¯´ç”¨MCPæä¾›æœåŠ¡ã€‚</p>
<pre><code class="hljs language-md" lang="md">On this page
<span class="hljs-bullet">  *</span> [<span class="hljs-string">Create tools</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/tools#create-tools</span>)
<span class="hljs-bullet">  *</span> [<span class="hljs-string">Basic tool definition</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/tools#basic-tool-definition</span>)
<span class="hljs-bullet">  *</span> [<span class="hljs-string">Accessing Context</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/tools#accessing-context</span>)
<span class="hljs-bullet">  *</span> [<span class="hljs-string">Context</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/tools#context</span>)
<span class="hljs-bullet">  *</span> [<span class="hljs-string">Memory (Store)</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/tools#memory-store</span>)
<span class="hljs-bullet">  *</span> [<span class="hljs-string">Stream Writer</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/tools#stream-writer</span>)


[<span class="hljs-string">Core components</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/agents</span>)
<span class="hljs-section"># Tools</span>
Copy page
Copy page
Tools extend what [<span class="hljs-string">agents</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/agents</span>) can doâ€”letting them fetch real-time data, execute code, query external databases, and take actions in the world. Under the hood, tools are callable functions with well-defined inputs and outputs that get passed to a [<span class="hljs-string">chat model</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/models</span>). The model decides when to invoke a tool based on the conversation context, and what input arguments to provide.
For details on how models handle tool calls, see [<span class="hljs-string">Tool calling</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/models#tool-calling</span>).
<span class="hljs-section">## Create tools</span>
<span class="hljs-section">### Basic tool definition</span>
The simplest way to create a tool is by importing the <span class="hljs-code">`tool`</span> function from the <span class="hljs-code">`langchain`</span> package. You can use [<span class="hljs-string">zod</span>](<span class="hljs-link">https://zod.dev/</span>) to define the toolâ€™s input schema:
<span class="hljs-code">```
import * as z from "zod"
import { tool } from "langchain"

const searchDatabase = tool(
  ({ query, limit }) =&gt; `Found ${limit} results for '${query}'`,
  {
    name: "search_database",
    description: "Search the customer database for records matching the query.",
    schema: z.object({
      query: z.string().describe("Search terms to look for"),
      limit: z.number().describe("Maximum number of results to return"),
    }),
  }
);

```</span>

<span class="hljs-strong">**Server-side tool use**</span> Some chat models (e.g., [<span class="hljs-string">OpenAI</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/integrations/chat/openai</span>), [<span class="hljs-string">Anthropic</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/integrations/chat/anthropic</span>), and [<span class="hljs-string">Gemini</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/integrations/chat/google_generative_ai</span>)) feature [<span class="hljs-string">built-in tools</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/models#server-side-tool-use</span>) that are executed server-side, such as web search and code interpreters. Refer to the [<span class="hljs-string">provider overview</span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/integrations/providers/overview</span>) to learn how to access these tools with your specific chat model.
<span class="hljs-section">## Accessing Context</span>
<span class="hljs-strong">**Why this matters:**</span> Tools are most powerful when they can access agent state, runtime context, and long-term memory. This enables tools to make context-aware decisions, personalize responses, and maintain information across conversations.The runtime context provides a structured way to supply runtime data, such as DB connections, user IDs, or config, into your tools. This avoids global state and keeps tools testable and reusable.
<span class="hljs-section">#### Context</span>
Tools can access an agentâ€™s runtime context through the <span class="hljs-code">`config`</span> parameter:
<span class="hljs-code">```
import * as z from "zod"
import { ChatOpenAI } from "@langchain/openai"
import { createAgent } from "langchain"

const getUserName = tool(
  (_, config) =&gt; {
    return config.context.user_name
  },
  {
    name: "get_user_name",
    description: "Get the user's name.",
    schema: z.object({}),
  }
);

const contextSchema = z.object({
  user_name: z.string(),
});

const agent = createAgent({
  model: new ChatOpenAI({ model: "gpt-4o" }),
  tools: [getUserName],
  contextSchema,
});

const result = await agent.invoke(
  {
    messages: [{ role: "user", content: "What is my name?" }]
  },
  {
    context: { user_name: "John Smith" }
  }
);

```</span>

<span class="hljs-section">#### Memory (Store)</span>
Access persistent data across conversations using the store. The store is accessed via <span class="hljs-code">`config.store`</span> and allows you to save and retrieve user-specific or application-specific data.
<span class="hljs-code">```
import * as z from "zod";
import { createAgent, tool } from "langchain";
import { InMemoryStore } from "@langchain/langgraph";
import { ChatOpenAI } from "@langchain/openai";

const store = new InMemoryStore();

// Access memory
const getUserInfo = tool(
  async ({ user_id }) =&gt; {
    const value = await store.get(["users"], user_id);
    console.log("get_user_info", user_id, value);
    return value;
  },
  {
    name: "get_user_info",
    description: "Look up user info.",
    schema: z.object({
      user_id: z.string(),
    }),
  }
);

// Update memory
const saveUserInfo = tool(
  async ({ user_id, name, age, email }) =&gt; {
    console.log("save_user_info", user_id, name, age, email);
    await store.put(["users"], user_id, { name, age, email });
    return "Successfully saved user info.";
  },
  {
    name: "save_user_info",
    description: "Save user info.",
    schema: z.object({
      user_id: z.string(),
      name: z.string(),
      age: z.number(),
      email: z.string(),
    }),
  }
);

const agent = createAgent({
  model: new ChatOpenAI({ model: "gpt-4o" }),
  tools: [getUserInfo, saveUserInfo],
  store,
});

// First session: save user info
await agent.invoke({
  messages: [
    {
      role: "user",
      content: "Save the following user: userid: abc123, name: Foo, age: 25, email: foo@langchain.dev",
    },
  ],
});

// Second session: get user info
const result = await agent.invoke({
  messages: [
    { role: "user", content: "Get user info for user with id 'abc123'" },
  ],
});

console.log(result);
// Here is the user info for user with ID "abc123":
// - Name: Foo
// - Age: 25
// - Email: foo@langchain.dev

```</span>

<span class="hljs-section">#### Stream Writer</span>
Stream custom updates from tools as they execute using <span class="hljs-code">`config.streamWriter`</span>. This is useful for providing real-time feedback to users about what a tool is doing.
<span class="hljs-code">```
import * as z from "zod";
import { tool, ToolRuntime } from "langchain";

const getWeather = tool(
  ({ city }, config: ToolRuntime) =&gt; {
    const writer = config.writer;

    // Stream custom updates as the tool executes
    if (writer) {
      writer(`Looking up data for city: ${city}`);
      writer(`Acquired data for city: ${city}`);
    }

    return `It's always sunny in ${city}!`;
  },
  {
    name: "get_weather",
    description: "Get weather for a given city.",
    schema: z.object({
      city: z.string(),
    }),
  }
);

```</span>

<span class="hljs-bullet">*</span> * *
[<span class="hljs-string">Edit this page on GitHub</span>](<span class="hljs-link">https://github.com/langchain-ai/docs/edit/main/src/oss/langchain/tools.mdx</span>) or [<span class="hljs-string">file an issue</span>](<span class="hljs-link">https://github.com/langchain-ai/docs/issues/new/choose</span>).
[<span class="hljs-string">Connect these docs</span>](<span class="hljs-link">https://docs.langchain.com/use-these-docs</span>) to Claude, VSCode, and more via MCP for real-time answers.
Was this page helpful?
YesNo
[<span class="hljs-string"> Messages Previous </span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/messages</span>)[<span class="hljs-string"> Short-term memory Next </span>](<span class="hljs-link">https://docs.langchain.com/oss/javascript/langchain/short-term-memory</span>)
[<span class="hljs-string">![light logo</span>](<span class="hljs-link">https://mintcdn.com/langchain-5e9cc07a/Xbr8HuVd9jPi6qTU/images/brand/langchain-docs-teal.svg?fit=max&amp;auto=format&amp;n=Xbr8HuVd9jPi6qTU&amp;q=85&amp;s=16111530672bf976cb54ef2143478342</span>)![<span class="hljs-string">dark logo</span>](<span class="hljs-link">https://mintcdn.com/langchain-5e9cc07a/Xbr8HuVd9jPi6qTU/images/brand/langchain-docs-lilac.svg?fit=max&amp;auto=format&amp;n=Xbr8HuVd9jPi6qTU&amp;q=85&amp;s=b70fb1a2208670492ef94aef14b680be</span>)](<span class="hljs-link">https://docs.langchain.com/</span>)
[](<span class="hljs-link">https://github.com/langchain-ai</span>)[](<span class="hljs-link">https://x.com/LangChainAI</span>)[](<span class="hljs-link">https://www.linkedin.com/company/langchain/</span>)[](<span class="hljs-link">https://www.youtube.com/@LangChain</span>)
Resources
[<span class="hljs-string">Forum</span>](<span class="hljs-link">https://forum.langchain.com/</span>)[<span class="hljs-string">Changelog</span>](<span class="hljs-link">https://changelog.langchain.com/</span>)[<span class="hljs-string">LangChain Academy</span>](<span class="hljs-link">https://academy.langchain.com/</span>)[<span class="hljs-string">Trust Center</span>](<span class="hljs-link">https://trust.langchain.com/</span>)
Company
[<span class="hljs-string">About</span>](<span class="hljs-link">https://langchain.com/about</span>)[<span class="hljs-string">Careers</span>](<span class="hljs-link">https://langchain.com/careers</span>)[<span class="hljs-string">Blog</span>](<span class="hljs-link">https://blog.langchain.com/</span>)
[](<span class="hljs-link">https://github.com/langchain-ai</span>)[](<span class="hljs-link">https://x.com/LangChainAI</span>)[](<span class="hljs-link">https://www.linkedin.com/company/langchain/</span>)[](<span class="hljs-link">https://www.youtube.com/@LangChain</span>)
[<span class="hljs-string">Powered by</span>](<span class="hljs-link">https://www.mintlify.com?utm_campaign=poweredBy&amp;utm_medium=referral&amp;utm_source=langchain-5e9cc07a</span>)
Assistant
Responses are generated using AI and may contain mistakes.

</code></pre>
<h3 data-id="heading-2">çˆ¬å®Œäº†æˆ‘æ€ä¹ˆç”¨</h3>
<p>æ•°æ®èŠ±äº†å¾ˆå¤§çš„åŠŸå¤«è¶´ä¸‹æ¥äº†ï¼Œæ€»å¾—èµ¶å¿«ç”¨MCPå»æœåŠ¡ä¸€ä¸‹ï¼Œæœ¬ç€ä¸é€ è½®å­çš„åŸåˆ™ï¼Œæˆ‘éœ€è¦è€ƒè™‘æ€ä¹ˆç”¨å°½å¯èƒ½ç®€å•çš„æ–¹æ³•æä¾›è¿™ä¸ªæœåŠ¡ã€‚è¿™ä¸ªæ—¶å€™æˆ‘æŠŠç›®å…‰æ”¾åˆ°äº†æˆ‘ä¹‹å‰ç”¨äº†ä¸€æ®µæ—¶é—´çš„ä¸€ä¸ªè½¯ä»¶ä¸Šâ€”â€”Obisidian</p>
<p>Obsidianæ˜¯å…è´¹çš„Markdownç¬”è®°è½¯ä»¶ï¼Œæœ‰å¾ˆä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ï¼Œä¹‹å‰æˆ‘ç”¨è¿‡é‡Œé¢ä¸€ä¸ªä¹Ÿå«Copilotçš„æ’ä»¶å°±å¾ˆä¸é”™ï¼Œå®ƒé€šè¿‡å†…ç½®çš„å‘é‡æ•°æ®åº“ï¼Œç»“åˆEmbedding Modelçš„APIï¼ˆæ¥è‡ªOpenAIæˆ–è€…ç«å±±è¿™æ ·çš„å¤–éƒ¨æä¾›å•†ï¼‰ï¼Œåœ¨é…åˆBYOKçš„LLM APIçš„æ€»ç»“ï¼Œå¯ä»¥å®ç°æ¯”è¾ƒå®Œæ•´çš„ä¸ªäººçŸ¥è¯†åº“å‘é‡æœç´¢+æ€»ç»“çš„æ•ˆæœã€‚è€Œå› ä¸ºæ˜¯ç¬”è®°è½¯ä»¶ï¼Œæ‰€ä»¥å¯¹äºMarkdownçš„æ¸²æŸ“æœ¬æ¥å°±æ˜¯å†…ç½®åŠŸèƒ½ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœæœ‰ä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥å®ç°å‘é‡æ•°æ®åº“+Embedding Modelçš„è¿æ¥ï¼Œå¯¹å¤–åˆèƒ½æä¾›MCPï¼Œé‚£ä¹ˆæˆ‘ä¸æ˜¯æ—¢èƒ½åœ¨Obsidiané‡Œç®¡ç†æˆ‘çš„æ–‡æ¡£ï¼ˆé€šè¿‡ReviewæŸ¥çœ‹æ–‡æ¡£å†…å®¹ï¼Œç„¶ååŠæ—¶ç¼–è¾‘ï¼‰ï¼Œåˆèƒ½å¯¹æ¥AIå®ç°çŸ¥è¯†åº“çš„æŸ¥è¯¢ã€‚æŸ¥äº†ä¸€åœˆï¼Œè™½ç„¶å†…ç½®çš„æœ‰ä¸€ä¸ªç±»ä¼¼çš„MCPå·¥å…·å«åšMCP Toolsï¼Œä½†æ˜¯å®ƒä¼¼ä¹ä¸æ”¯æŒå‘é‡æœç´¢ï¼Œæˆ‘åˆæ‰¾åˆ°ä¸€ä¸ªå«åšMCP Serverçš„ï¼Œå®ƒä¸åœ¨Obsidiançš„æ’ä»¶å•†åº—é‡Œï¼Œè€Œéœ€è¦ä»Githubä¸ŠCloneå¹¶æ„å»ºï¼Œå¹¶å°†å…³é”®æ–‡ä»¶æ‰‹åŠ¨å¤åˆ¶åˆ°Obsidiançš„æ’ä»¶ç›®å½•ä¸‹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">https://github.com/Minhao-Zhang/obsidian-mcp-server
</code></pre>
<p>è¿™ä¸ªæ’ä»¶æœ‰æ¯”è¾ƒå®Œæ•´çš„RAGçŸ¥è¯†åº“çš„å½±å­ï¼Œæ¯”å¦‚å¯è®¾ç½®OpenAI APIå…¼å®¹çš„Embeddingæ¨¡å‹ï¼Œåˆ†Chunkï¼ŒChunké—´è®¾ç½®Overlapï¼Œ è®¾ç½®similarityé˜ˆå€¼ï¼Œè®¾ç½®å¬å›çš„æ–‡æ¡£ä¸ªæ•°ç­‰ï¼Œè¿™ä¸å°±æ˜¯ç°æˆçš„æ–¹æ¡ˆï¼Ÿä½†æ˜¯å¼€å§‹æ²¡æœ‰å‘ç°ï¼Œä¹‹åæ‰æ³¨æ„åˆ°æœ‰ä¸ªä¸¥é‡çš„é—®é¢˜æ˜¯ï¼Œè¿™ä¸ªæ’ä»¶ä¸æ”¯æŒå¢é‡æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¦åŠ ä¸€ç¯‡æ–‡æ¡£ï¼Œéœ€è¦é‡æ–°æ„å»ºæ•´ä¸ªå‘é‡æ•°æ®åº“ï¼Œå¦‚æœæ–‡æ¡£å¤šçš„è¯ï¼Œè¿™ä¸ªAPIçš„æˆæœ¬ä¹Ÿä¸ä½ã€‚</p>
<p>å¯åŠ¨åå°è¯•ç”¨MCPå®˜æ–¹çš„inspectoråšäº†æµ‹è¯•:</p>
<pre><code class="hljs language-bash" lang="bash">npx @modelcontextprotocol/inspector
</code></pre>
<p>ä½¿ç”¨SSEæ¨¡å¼ï¼Œå¡«å…¥MCP Serveré‡Œçš„SSEçš„åœ°å€ï¼Œç„¶åè¿æ¥ä½¿ç”¨Directã€‚ä¹‹ååˆ—å‡ºå·¥å…·ï¼Œé€‰æ‹©simple_vector_searchå°±å¯ä»¥æœç´¢äº†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0951cb182765474e8599a1b0b3a7a51a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oqA5pyv5Lq655qE5rWB5rC06LSm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768516952&amp;x-signature=lE0BkjXAvXYvlFL7t3WHrz7%2BgkI%3D" alt="æˆªå±2026-01-09_06_08_19.jpg" loading="lazy"/></p>
<h3 data-id="heading-3">æ•ˆæœå¦‚ä½•å‘¢</h3>
<p>å‰é¢è¯´åˆ°äº†æˆ‘ä»¬ä½¿ç”¨Crawl4aiçˆ¬å–äº†æ–‡æ¡£ï¼Œç„¶ååˆå®ç”¨Obsidiané‡Œçš„MCP Serveræ’ä»¶å®ç°äº†å‘é‡æ•°æ®åº“ï¼Œæˆ‘ä»¬è¿«ä¸åŠå¾…çš„æƒ³çœ‹çœ‹åœ¨Vibe Codingé‡Œä½¿ç”¨çš„æ•ˆæœæ€ä¹ˆæ ·ï¼Œä½†æ˜¯åœ¨Inspectorä¸­çš„æµ‹è¯•æˆ‘å°±çœ‹å‡ºäº†é—®é¢˜ã€‚</p>
<p>æ­£å¦‚æ­£é¢ç»™å‡ºçš„LangChainæ–‡æ¡£çš„Markdownçš„ä¾‹å­ï¼Œæˆ‘ä»¬å‘ç°æ–‡æ¡£é¡µé¢çš„å¼€å§‹éƒ¨åˆ†æœ‰å¤§é‡çš„å¼•è¨€ï¼Œè€Œè¿™äº›å¼•è¨€åŒ…å«äº†å¤§é‡ä¸LangChainç‰¹æ€§ç›¸å…³çš„å…³é”®å­—ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æ­£å¸¸ä½¿ç”¨MCP Serveræ’ä»¶çš„æŒ‰ç…§1000æˆ–2000ä¸ªå­—ç¬¦è¿›è¡Œåˆ†å‰²çš„è¯ï¼Œè¿™äº›å¼•è¨€å°±ä¼šæˆä¸ºå•ç‹¬çš„Chunkã€‚è€Œä»å‘é‡æ•°æ®åº“çš„è§’åº¦æ¥è¯´ï¼Œè¿™äº›Chunkçš„çš„è¯­ä¹‰å¯†åº¦å…¶å®æ˜¯å¤§äºä»£ç å—ï¼Œä¸”å¼•è¨€åˆåŒ…å«äº†è·¨é¡µé¢çš„å†…å®¹ï¼Œæ‰€ä»¥æœ€ç»ˆç”¨MCP Serveræ¥å£æœå‡ºæ¥çš„ï¼ŒæŒ‰ç…§è¿‘ä¼¼åº¦æ’åºï¼Œé å‰çš„å…¨æ˜¯ä¸åŒé¡µé¢çš„å¼•è¨€éƒ¨åˆ†ã€‚ä¸‹é¢ç»™å‡ºä¸Šé¢åŸå§‹é¡µé¢çš„åœ°å€ï¼Œå¤§å®¶å¯ä»¥ä¸Šå»çœ‹ä¸€çœ‹ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/docs.langchain.com/oss</span><span class="hljs-regexp">/javascript/langchain</span><span class="hljs-regexp">/models
</span></code></pre>
<p>å¼•è¨€çš„æˆªå›¾å¦‚ä¸‹:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f3b0dc125b54edf9cc0a6ba87d4a5fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oqA5pyv5Lq655qE5rWB5rC06LSm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768516952&amp;x-signature=J6sG59jzTzlt34%2FbJUFkAxZEKvI%3D" alt="æˆªå±2026-01-09_06_30_31.jpg" loading="lazy"/></p>
<p>ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œç›®å‰ä¸ºæ­¢æˆ‘ä»¬å¤§è´¹å‘¨æŠ˜ç»ˆäºå·®ä¸€æ­¥è¦è·‘é€šçš„ä¸œè¥¿ä¼¼ä¹æ•ˆæœå¹¶ä¸å¥½ï¼Œé‚£ä¹ˆä¸ºäº†Vibe Codingçš„æ•ˆæœï¼Œæˆ‘ä»¬è¿˜èƒ½æŒ£æ‰ç‚¹ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æœ‰å½“ç„¶æ˜¯æœ‰ï¼Œæ•ˆæœå¥½ä¸å¥½å¦è¯´ï¼Œæˆ‘ä»¬ä¸‹å›æ¥ç€åˆ†è§£å§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[3åˆ†é’ŸSolidity: 10.6 æ—¶é—´é”å®š]]></title>    <link>https://juejin.cn/post/7592833068223119406</link>    <guid>https://juejin.cn/post/7592833068223119406</guid>    <pubDate>2026-01-08T13:25:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592833068223119406" data-draft-id="7592833068223103022" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="3åˆ†é’ŸSolidity: 10.6 æ—¶é—´é”å®š"/> <meta itemprop="keywords" content="Solidity,web3,æ™ºèƒ½åˆçº¦"/> <meta itemprop="datePublished" content="2026-01-08T13:25:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Rockbean"/> <meta itemprop="url" content="https://juejin.cn/user/4054654615823560"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            3åˆ†é’ŸSolidity: 10.6 æ—¶é—´é”å®š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4054654615823560/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Rockbean
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T13:25:52.000Z" title="Thu Jan 08 2026 13:25:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>æ¬¢è¿è®¢é˜…ä¸“æ </strong>ï¼š<a href="https://juejin.cn/column/7578762210285977663" title="https://juejin.cn/column/7578762210285977663" target="_blank">3åˆ†é’ŸSolidity--æ™ºèƒ½åˆçº¦--Web3åŒºå—é“¾æŠ€æœ¯å¿…å­¦</a></p>
<p>å¦‚éœ€è·å–æœ¬å†…å®¹çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¯·å‚è§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cyfrin.io%2Fglossary%2Ftime-lock-solidity-code-example" target="_blank" title="https://www.cyfrin.io/glossary/time-lock-solidity-code-example" ref="nofollow noopener noreferrer">Cyfrin.io çš„Time Lockï¼ˆä»£ç ç¤ºä¾‹ï¼‰</a></p>
<p><code>TimeLock</code>æ˜¯ä¸€ç§åˆçº¦ï¼Œç”¨äºå‘å¸ƒå°†åœ¨æœªæ¥æ‰§è¡Œçš„äº¤æ˜“ã€‚</p>
<p>ç»è¿‡æœ€çŸ­ç­‰å¾…æœŸåï¼Œè¯¥äº¤æ˜“å³å¯æ‰§è¡Œã€‚</p>
<p><code>TimeLock</code>åœ¨DAOä¸­ç»å¸¸è¢«ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-selector-class">.26</span>;

contract TimeLock {
    error <span class="hljs-built_in">NotOwnerError</span>();
    error <span class="hljs-built_in">AlreadyQueuedError</span>(bytes32 txId);
    error <span class="hljs-built_in">TimestampNotInRangeError</span>(uint256 blockTimestamp, uint256 timestamp);
    error <span class="hljs-built_in">NotQueuedError</span>(bytes32 txId);
    error <span class="hljs-built_in">TimestampNotPassedError</span>(uint256 blockTimestamp, uint256 timestamp);
    error <span class="hljs-built_in">TimestampExpiredError</span>(uint256 blockTimestamp, uint256 expiresAt);
    error <span class="hljs-built_in">TxFailedError</span>();

    event <span class="hljs-built_in">Queue</span>(
        bytes32 indexed txId,
        address indexed target,
        uint256 value,
        string func,
        bytes data,
        uint256 timestamp
    );
    event <span class="hljs-built_in">Execute</span>(
        bytes32 indexed txId,
        address indexed target,
        uint256 value,
        string func,
        bytes data,
        uint256 timestamp
    );
    event <span class="hljs-built_in">Cancel</span>(bytes32 indexed txId);

    uint256 public constant MIN_DELAY = <span class="hljs-number">10</span>; <span class="hljs-comment">// seconds</span>
    uint256 public constant MAX_DELAY = <span class="hljs-number">1000</span>; <span class="hljs-comment">// seconds</span>
    uint256 public constant GRACE_PERIOD = <span class="hljs-number">1000</span>; <span class="hljs-comment">// seconds</span>

    <span class="hljs-selector-tag">address</span> public owner;
    <span class="hljs-comment">// tx id =&gt; queued</span>
    <span class="hljs-built_in">mapping</span>(bytes32 =&gt; bool) public queued;

    <span class="hljs-built_in">constructor</span>() {
        owner = msg<span class="hljs-selector-class">.sender</span>;
    }

    modifier <span class="hljs-built_in">onlyOwner</span>() {
        if (msg.sender != owner) {
            revert <span class="hljs-built_in">NotOwnerError</span>();
        }
        _;
    }

    <span class="hljs-built_in">receive</span>() external payable {}

    function <span class="hljs-built_in">getTxId</span>(
        address _target,
        uint256 _value,
        string calldata _func,
        bytes calldata _data,
        uint256 _timestamp
    ) public pure returns (bytes32) {
        return <span class="hljs-built_in">keccak256</span>(abi.encode(_target, _value, _func, _data, _timestamp));
    }

    <span class="hljs-comment">/**
     * @param _target Address of contract or account to call
     * @param _value Amount of ETH to send
     * @param _func Function signature, for example "foo(address,uint256)"
     * @param _data ABI encoded data send.
     * @param _timestamp Timestamp after which the transaction can be executed.
     */</span>
    function <span class="hljs-built_in">queue</span>(
        address _target,
        uint256 _value,
        string calldata _func,
        bytes calldata _data,
        uint256 _timestamp
    ) external onlyOwner returns (bytes32 txId) {
        txId = <span class="hljs-built_in">getTxId</span>(_target, _value, _func, _data, _timestamp);
        if (queued[txId]) {
            revert <span class="hljs-built_in">AlreadyQueuedError</span>(txId);
        }
        <span class="hljs-comment">// ---|------------|---------------|-------</span>
        <span class="hljs-comment">//  block    block + min     block + max</span>
        if (
            _timestamp &lt; block.timestamp + MIN_DELAY
                || _timestamp &gt; block.timestamp + MAX_DELAY
        ) {
            revert <span class="hljs-built_in">TimestampNotInRangeError</span>(block.timestamp, _timestamp);
        }

        queued<span class="hljs-selector-attr">[txId]</span> = true;

        emit <span class="hljs-built_in">Queue</span>(txId, _target, _value, _func, _data, _timestamp);
    }

    function <span class="hljs-built_in">execute</span>(
        address _target,
        uint256 _value,
        string calldata _func,
        bytes calldata _data,
        uint256 _timestamp
    ) external payable onlyOwner returns (bytes memory) {
        bytes32 txId = <span class="hljs-built_in">getTxId</span>(_target, _value, _func, _data, _timestamp);
        if (!queued[txId]) {
            revert <span class="hljs-built_in">NotQueuedError</span>(txId);
        }
        <span class="hljs-comment">// ----|-------------------|-------</span>
        <span class="hljs-comment">//  timestamp    timestamp + grace period</span>
        if (block.timestamp &lt; _timestamp) {
            revert <span class="hljs-built_in">TimestampNotPassedError</span>(block.timestamp, _timestamp);
        }
        if (block.timestamp &gt; _timestamp + GRACE_PERIOD) {
            revert <span class="hljs-built_in">TimestampExpiredError</span>(
                block.timestamp, _timestamp + GRACE_PERIOD
            );
        }

        queued<span class="hljs-selector-attr">[txId]</span> = false;

        <span class="hljs-comment">// prepare data</span>
        bytes memory data;
        if (bytes(_func)<span class="hljs-selector-class">.length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// data = func selector + _data</span>
            data = abi<span class="hljs-selector-class">.encodePacked</span>(bytes4(keccak256(bytes(_func))), _data);
        } else {
            <span class="hljs-comment">// call fallback with data</span>
            data = _data;
        }

        <span class="hljs-comment">// call target</span>
        (bool ok, bytes memory res) = _target<span class="hljs-selector-class">.call</span>{value: _value}(data);
        if (!ok) {
            revert <span class="hljs-built_in">TxFailedError</span>();
        }

        emit <span class="hljs-built_in">Execute</span>(txId, _target, _value, _func, _data, _timestamp);

        return res;
    }

    function <span class="hljs-built_in">cancel</span>(bytes32 _txId) external onlyOwner {
        if (!queued[_txId]) {
            revert <span class="hljs-built_in">NotQueuedError</span>(_txId);
        }

        queued<span class="hljs-selector-attr">[_txId]</span> = false;

        emit <span class="hljs-built_in">Cancel</span>(_txId);
    }
}
</code></pre>
<p>Remix Lite å°è¯•ä¸€ä¸‹</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fremix.byteatatime.dev%2F%3F%23code%3DLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVApwcmFnbWEgc29saWRpdHkgXjAuOC4yNjsKCmNvbnRyYWN0IFRpbWVMb2NrIHsKICAgIGVycm9yIE5vdE93bmVyRXJyb3IoKTsKICAgIGVycm9yIEFscmVhZHlRdWV1ZWRFcnJvcihieXRlczMyIHR4SWQpOwogICAgZXJyb3IgVGltZXN0YW1wTm90SW5SYW5nZUVycm9yKHVpbnQyNTYgYmxvY2tUaW1lc3RhbXAsIHVpbnQyNTYgdGltZXN0YW1wKTsKICAgIGVycm9yIE5vdFF1ZXVlZEVycm9yKGJ5dGVzMzIgdHhJZCk7CiAgICBlcnJvciBUaW1lc3RhbXBOb3RQYXNzZWRFcnJvcih1aW50MjU2IGJsb2NrVGltZXN0YW1wLCB1aW50MjU2IHRpbWVzdGFtcCk7CiAgICBlcnJvciBUaW1lc3RhbXBFeHBpcmVkRXJyb3IodWludDI1NiBibG9ja1RpbWVzdGFtcCwgdWludDI1NiBleHBpcmVzQXQpOwogICAgZXJyb3IgVHhGYWlsZWRFcnJvcigpOwoKICAgIGV2ZW50IFF1ZXVlKAogICAgICAgIGJ5dGVzMzIgaW5kZXhlZCB0eElkLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0YXJnZXQsCiAgICAgICAgdWludDI1NiB2YWx1ZSwKICAgICAgICBzdHJpbmcgZnVuYywKICAgICAgICBieXRlcyBkYXRhLAogICAgICAgIHVpbnQyNTYgdGltZXN0YW1wCiAgICApOwogICAgZXZlbnQgRXhlY3V0ZSgKICAgICAgICBieXRlczMyIGluZGV4ZWQgdHhJZCwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgdGFyZ2V0LAogICAgICAgIHVpbnQyNTYgdmFsdWUsCiAgICAgICAgc3RyaW5nIGZ1bmMsCiAgICAgICAgYnl0ZXMgZGF0YSwKICAgICAgICB1aW50MjU2IHRpbWVzdGFtcAogICAgKTsKICAgIGV2ZW50IENhbmNlbChieXRlczMyIGluZGV4ZWQgdHhJZCk7CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgTUlOX0RFTEFZID0gMTA7IC8vIHNlY29uZHMKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IE1BWF9ERUxBWSA9IDEwMDA7IC8vIHNlY29uZHMKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IEdSQUNFX1BFUklPRCA9IDEwMDA7IC8vIHNlY29uZHMKCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIC8vIHR4IGlkID0%2BIHF1ZXVlZAogICAgbWFwcGluZyhieXRlczMyID0%2BIGJvb2wpIHB1YmxpYyBxdWV1ZWQ7CgogICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgewogICAgICAgICAgICByZXZlcnQgTm90T3duZXJFcnJvcigpOwogICAgICAgIH0KICAgICAgICBfOwogICAgfQoKICAgIHJlY2VpdmUoKSBleHRlcm5hbCBwYXlhYmxlIHt9CgogICAgZnVuY3Rpb24gZ2V0VHhJZCgKICAgICAgICBhZGRyZXNzIF90YXJnZXQsCiAgICAgICAgdWludDI1NiBfdmFsdWUsCiAgICAgICAgc3RyaW5nIGNhbGxkYXRhIF9mdW5jLAogICAgICAgIGJ5dGVzIGNhbGxkYXRhIF9kYXRhLAogICAgICAgIHVpbnQyNTYgX3RpbWVzdGFtcAogICAgKSBwdWJsaWMgcHVyZSByZXR1cm5zIChieXRlczMyKSB7CiAgICAgICAgcmV0dXJuIGtlY2NhazI1NihhYmkuZW5jb2RlKF90YXJnZXQsIF92YWx1ZSwgX2Z1bmMsIF9kYXRhLCBfdGltZXN0YW1wKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAcGFyYW0gX3RhcmdldCBBZGRyZXNzIG9mIGNvbnRyYWN0IG9yIGFjY291bnQgdG8gY2FsbAogICAgICogQHBhcmFtIF92YWx1ZSBBbW91bnQgb2YgRVRIIHRvIHNlbmQKICAgICAqIEBwYXJhbSBfZnVuYyBGdW5jdGlvbiBzaWduYXR1cmUsIGZvciBleGFtcGxlICJmb28oYWRkcmVzcyx1aW50MjU2KSIKICAgICAqIEBwYXJhbSBfZGF0YSBBQkkgZW5jb2RlZCBkYXRhIHNlbmQuCiAgICAgKiBAcGFyYW0gX3RpbWVzdGFtcCBUaW1lc3RhbXAgYWZ0ZXIgd2hpY2ggdGhlIHRyYW5zYWN0aW9uIGNhbiBiZSBleGVjdXRlZC4KICAgICAqLwogICAgZnVuY3Rpb24gcXVldWUoCiAgICAgICAgYWRkcmVzcyBfdGFyZ2V0LAogICAgICAgIHVpbnQyNTYgX3ZhbHVlLAogICAgICAgIHN0cmluZyBjYWxsZGF0YSBfZnVuYywKICAgICAgICBieXRlcyBjYWxsZGF0YSBfZGF0YSwKICAgICAgICB1aW50MjU2IF90aW1lc3RhbXAKICAgICkgZXh0ZXJuYWwgb25seU93bmVyIHJldHVybnMgKGJ5dGVzMzIgdHhJZCkgewogICAgICAgIHR4SWQgPSBnZXRUeElkKF90YXJnZXQsIF92YWx1ZSwgX2Z1bmMsIF9kYXRhLCBfdGltZXN0YW1wKTsKICAgICAgICBpZiAocXVldWVkW3R4SWRdKSB7CiAgICAgICAgICAgIHJldmVydCBBbHJlYWR5UXVldWVkRXJyb3IodHhJZCk7CiAgICAgICAgfQogICAgICAgIC8vIC0tLXwtLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0KICAgICAgICAvLyAgYmxvY2sgICAgYmxvY2sgKyBtaW4gICAgIGJsb2NrICsgbWF4CiAgICAgICAgaWYgKAogICAgICAgICAgICBfdGltZXN0YW1wIDwgYmxvY2sudGltZXN0YW1wICsgTUlOX0RFTEFZCiAgICAgICAgICAgICAgICB8fCBfdGltZXN0YW1wID4gYmxvY2sudGltZXN0YW1wICsgTUFYX0RFTEFZCiAgICAgICAgKSB7CiAgICAgICAgICAgIHJldmVydCBUaW1lc3RhbXBOb3RJblJhbmdlRXJyb3IoYmxvY2sudGltZXN0YW1wLCBfdGltZXN0YW1wKTsKICAgICAgICB9CgogICAgICAgIHF1ZXVlZFt0eElkXSA9IHRydWU7CgogICAgICAgIGVtaXQgUXVldWUodHhJZCwgX3RhcmdldCwgX3ZhbHVlLCBfZnVuYywgX2RhdGEsIF90aW1lc3RhbXApOwogICAgfQoKICAgIGZ1bmN0aW9uIGV4ZWN1dGUoCiAgICAgICAgYWRkcmVzcyBfdGFyZ2V0LAogICAgICAgIHVpbnQyNTYgX3ZhbHVlLAogICAgICAgIHN0cmluZyBjYWxsZGF0YSBfZnVuYywKICAgICAgICBieXRlcyBjYWxsZGF0YSBfZGF0YSwKICAgICAgICB1aW50MjU2IF90aW1lc3RhbXAKICAgICkgZXh0ZXJuYWwgcGF5YWJsZSBvbmx5T3duZXIgcmV0dXJucyAoYnl0ZXMgbWVtb3J5KSB7CiAgICAgICAgYnl0ZXMzMiB0eElkID0gZ2V0VHhJZChfdGFyZ2V0LCBfdmFsdWUsIF9mdW5jLCBfZGF0YSwgX3RpbWVzdGFtcCk7CiAgICAgICAgaWYgKCFxdWV1ZWRbdHhJZF0pIHsKICAgICAgICAgICAgcmV2ZXJ0IE5vdFF1ZXVlZEVycm9yKHR4SWQpOwogICAgICAgIH0KICAgICAgICAvLyAtLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLQogICAgICAgIC8vICB0aW1lc3RhbXAgICAgdGltZXN0YW1wICsgZ3JhY2UgcGVyaW9kCiAgICAgICAgaWYgKGJsb2NrLnRpbWVzdGFtcCA8IF90aW1lc3RhbXApIHsKICAgICAgICAgICAgcmV2ZXJ0IFRpbWVzdGFtcE5vdFBhc3NlZEVycm9yKGJsb2NrLnRpbWVzdGFtcCwgX3RpbWVzdGFtcCk7CiAgICAgICAgfQogICAgICAgIGlmIChibG9jay50aW1lc3RhbXAgPiBfdGltZXN0YW1wICsgR1JBQ0VfUEVSSU9EKSB7CiAgICAgICAgICAgIHJldmVydCBUaW1lc3RhbXBFeHBpcmVkRXJyb3IoCiAgICAgICAgICAgICAgICBibG9jay50aW1lc3RhbXAsIF90aW1lc3RhbXAgKyBHUkFDRV9QRVJJT0QKICAgICAgICAgICAgKTsKICAgICAgICB9CgogICAgICAgIHF1ZXVlZFt0eElkXSA9IGZhbHNlOwoKICAgICAgICAvLyBwcmVwYXJlIGRhdGEKICAgICAgICBieXRlcyBtZW1vcnkgZGF0YTsKICAgICAgICBpZiAoYnl0ZXMoX2Z1bmMpLmxlbmd0aCA%2BIDApIHsKICAgICAgICAgICAgLy8gZGF0YSA9IGZ1bmMgc2VsZWN0b3IgKyBfZGF0YQogICAgICAgICAgICBkYXRhID0gYWJpLmVuY29kZVBhY2tlZChieXRlczQoa2VjY2FrMjU2KGJ5dGVzKF9mdW5jKSkpLCBfZGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gY2FsbCBmYWxsYmFjayB3aXRoIGRhdGEKICAgICAgICAgICAgZGF0YSA9IF9kYXRhOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FsbCB0YXJnZXQKICAgICAgICAoYm9vbCBvaywgYnl0ZXMgbWVtb3J5IHJlcykgPSBfdGFyZ2V0LmNhbGx7dmFsdWU6IF92YWx1ZX0oZGF0YSk7CiAgICAgICAgaWYgKCFvaykgewogICAgICAgICAgICByZXZlcnQgVHhGYWlsZWRFcnJvcigpOwogICAgICAgIH0KCiAgICAgICAgZW1pdCBFeGVjdXRlKHR4SWQsIF90YXJnZXQsIF92YWx1ZSwgX2Z1bmMsIF9kYXRhLCBfdGltZXN0YW1wKTsKCiAgICAgICAgcmV0dXJuIHJlczsKICAgIH0KCiAgICBmdW5jdGlvbiBjYW5jZWwoYnl0ZXMzMiBfdHhJZCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBpZiAoIXF1ZXVlZFtfdHhJZF0pIHsKICAgICAgICAgICAgcmV2ZXJ0IE5vdFF1ZXVlZEVycm9yKF90eElkKTsKICAgICAgICB9CgogICAgICAgIHF1ZXVlZFtfdHhJZF0gPSBmYWxzZTsKCiAgICAgICAgZW1pdCBDYW5jZWwoX3R4SWQpOwogICAgfQp9Cg%3D%3D" target="_blank" title="https://remix.byteatatime.dev/?#code=Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVApwcmFnbWEgc29saWRpdHkgXjAuOC4yNjsKCmNvbnRyYWN0IFRpbWVMb2NrIHsKICAgIGVycm9yIE5vdE93bmVyRXJyb3IoKTsKICAgIGVycm9yIEFscmVhZHlRdWV1ZWRFcnJvcihieXRlczMyIHR4SWQpOwogICAgZXJyb3IgVGltZXN0YW1wTm90SW5SYW5nZUVycm9yKHVpbnQyNTYgYmxvY2tUaW1lc3RhbXAsIHVpbnQyNTYgdGltZXN0YW1wKTsKICAgIGVycm9yIE5vdFF1ZXVlZEVycm9yKGJ5dGVzMzIgdHhJZCk7CiAgICBlcnJvciBUaW1lc3RhbXBOb3RQYXNzZWRFcnJvcih1aW50MjU2IGJsb2NrVGltZXN0YW1wLCB1aW50MjU2IHRpbWVzdGFtcCk7CiAgICBlcnJvciBUaW1lc3RhbXBFeHBpcmVkRXJyb3IodWludDI1NiBibG9ja1RpbWVzdGFtcCwgdWludDI1NiBleHBpcmVzQXQpOwogICAgZXJyb3IgVHhGYWlsZWRFcnJvcigpOwoKICAgIGV2ZW50IFF1ZXVlKAogICAgICAgIGJ5dGVzMzIgaW5kZXhlZCB0eElkLAogICAgICAgIGFkZHJlc3MgaW5kZXhlZCB0YXJnZXQsCiAgICAgICAgdWludDI1NiB2YWx1ZSwKICAgICAgICBzdHJpbmcgZnVuYywKICAgICAgICBieXRlcyBkYXRhLAogICAgICAgIHVpbnQyNTYgdGltZXN0YW1wCiAgICApOwogICAgZXZlbnQgRXhlY3V0ZSgKICAgICAgICBieXRlczMyIGluZGV4ZWQgdHhJZCwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgdGFyZ2V0LAogICAgICAgIHVpbnQyNTYgdmFsdWUsCiAgICAgICAgc3RyaW5nIGZ1bmMsCiAgICAgICAgYnl0ZXMgZGF0YSwKICAgICAgICB1aW50MjU2IHRpbWVzdGFtcAogICAgKTsKICAgIGV2ZW50IENhbmNlbChieXRlczMyIGluZGV4ZWQgdHhJZCk7CgogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgTUlOX0RFTEFZID0gMTA7IC8vIHNlY29uZHMKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IE1BWF9ERUxBWSA9IDEwMDA7IC8vIHNlY29uZHMKICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IEdSQUNFX1BFUklPRCA9IDEwMDA7IC8vIHNlY29uZHMKCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsKICAgIC8vIHR4IGlkID0+IHF1ZXVlZAogICAgbWFwcGluZyhieXRlczMyID0+IGJvb2wpIHB1YmxpYyBxdWV1ZWQ7CgogICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOwogICAgfQoKICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsKICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgewogICAgICAgICAgICByZXZlcnQgTm90T3duZXJFcnJvcigpOwogICAgICAgIH0KICAgICAgICBfOwogICAgfQoKICAgIHJlY2VpdmUoKSBleHRlcm5hbCBwYXlhYmxlIHt9CgogICAgZnVuY3Rpb24gZ2V0VHhJZCgKICAgICAgICBhZGRyZXNzIF90YXJnZXQsCiAgICAgICAgdWludDI1NiBfdmFsdWUsCiAgICAgICAgc3RyaW5nIGNhbGxkYXRhIF9mdW5jLAogICAgICAgIGJ5dGVzIGNhbGxkYXRhIF9kYXRhLAogICAgICAgIHVpbnQyNTYgX3RpbWVzdGFtcAogICAgKSBwdWJsaWMgcHVyZSByZXR1cm5zIChieXRlczMyKSB7CiAgICAgICAgcmV0dXJuIGtlY2NhazI1NihhYmkuZW5jb2RlKF90YXJnZXQsIF92YWx1ZSwgX2Z1bmMsIF9kYXRhLCBfdGltZXN0YW1wKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAcGFyYW0gX3RhcmdldCBBZGRyZXNzIG9mIGNvbnRyYWN0IG9yIGFjY291bnQgdG8gY2FsbAogICAgICogQHBhcmFtIF92YWx1ZSBBbW91bnQgb2YgRVRIIHRvIHNlbmQKICAgICAqIEBwYXJhbSBfZnVuYyBGdW5jdGlvbiBzaWduYXR1cmUsIGZvciBleGFtcGxlICJmb28oYWRkcmVzcyx1aW50MjU2KSIKICAgICAqIEBwYXJhbSBfZGF0YSBBQkkgZW5jb2RlZCBkYXRhIHNlbmQuCiAgICAgKiBAcGFyYW0gX3RpbWVzdGFtcCBUaW1lc3RhbXAgYWZ0ZXIgd2hpY2ggdGhlIHRyYW5zYWN0aW9uIGNhbiBiZSBleGVjdXRlZC4KICAgICAqLwogICAgZnVuY3Rpb24gcXVldWUoCiAgICAgICAgYWRkcmVzcyBfdGFyZ2V0LAogICAgICAgIHVpbnQyNTYgX3ZhbHVlLAogICAgICAgIHN0cmluZyBjYWxsZGF0YSBfZnVuYywKICAgICAgICBieXRlcyBjYWxsZGF0YSBfZGF0YSwKICAgICAgICB1aW50MjU2IF90aW1lc3RhbXAKICAgICkgZXh0ZXJuYWwgb25seU93bmVyIHJldHVybnMgKGJ5dGVzMzIgdHhJZCkgewogICAgICAgIHR4SWQgPSBnZXRUeElkKF90YXJnZXQsIF92YWx1ZSwgX2Z1bmMsIF9kYXRhLCBfdGltZXN0YW1wKTsKICAgICAgICBpZiAocXVldWVkW3R4SWRdKSB7CiAgICAgICAgICAgIHJldmVydCBBbHJlYWR5UXVldWVkRXJyb3IodHhJZCk7CiAgICAgICAgfQogICAgICAgIC8vIC0tLXwtLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0KICAgICAgICAvLyAgYmxvY2sgICAgYmxvY2sgKyBtaW4gICAgIGJsb2NrICsgbWF4CiAgICAgICAgaWYgKAogICAgICAgICAgICBfdGltZXN0YW1wIDwgYmxvY2sudGltZXN0YW1wICsgTUlOX0RFTEFZCiAgICAgICAgICAgICAgICB8fCBfdGltZXN0YW1wID4gYmxvY2sudGltZXN0YW1wICsgTUFYX0RFTEFZCiAgICAgICAgKSB7CiAgICAgICAgICAgIHJldmVydCBUaW1lc3RhbXBOb3RJblJhbmdlRXJyb3IoYmxvY2sudGltZXN0YW1wLCBfdGltZXN0YW1wKTsKICAgICAgICB9CgogICAgICAgIHF1ZXVlZFt0eElkXSA9IHRydWU7CgogICAgICAgIGVtaXQgUXVldWUodHhJZCwgX3RhcmdldCwgX3ZhbHVlLCBfZnVuYywgX2RhdGEsIF90aW1lc3RhbXApOwogICAgfQoKICAgIGZ1bmN0aW9uIGV4ZWN1dGUoCiAgICAgICAgYWRkcmVzcyBfdGFyZ2V0LAogICAgICAgIHVpbnQyNTYgX3ZhbHVlLAogICAgICAgIHN0cmluZyBjYWxsZGF0YSBfZnVuYywKICAgICAgICBieXRlcyBjYWxsZGF0YSBfZGF0YSwKICAgICAgICB1aW50MjU2IF90aW1lc3RhbXAKICAgICkgZXh0ZXJuYWwgcGF5YWJsZSBvbmx5T3duZXIgcmV0dXJucyAoYnl0ZXMgbWVtb3J5KSB7CiAgICAgICAgYnl0ZXMzMiB0eElkID0gZ2V0VHhJZChfdGFyZ2V0LCBfdmFsdWUsIF9mdW5jLCBfZGF0YSwgX3RpbWVzdGFtcCk7CiAgICAgICAgaWYgKCFxdWV1ZWRbdHhJZF0pIHsKICAgICAgICAgICAgcmV2ZXJ0IE5vdFF1ZXVlZEVycm9yKHR4SWQpOwogICAgICAgIH0KICAgICAgICAvLyAtLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLQogICAgICAgIC8vICB0aW1lc3RhbXAgICAgdGltZXN0YW1wICsgZ3JhY2UgcGVyaW9kCiAgICAgICAgaWYgKGJsb2NrLnRpbWVzdGFtcCA8IF90aW1lc3RhbXApIHsKICAgICAgICAgICAgcmV2ZXJ0IFRpbWVzdGFtcE5vdFBhc3NlZEVycm9yKGJsb2NrLnRpbWVzdGFtcCwgX3RpbWVzdGFtcCk7CiAgICAgICAgfQogICAgICAgIGlmIChibG9jay50aW1lc3RhbXAgPiBfdGltZXN0YW1wICsgR1JBQ0VfUEVSSU9EKSB7CiAgICAgICAgICAgIHJldmVydCBUaW1lc3RhbXBFeHBpcmVkRXJyb3IoCiAgICAgICAgICAgICAgICBibG9jay50aW1lc3RhbXAsIF90aW1lc3RhbXAgKyBHUkFDRV9QRVJJT0QKICAgICAgICAgICAgKTsKICAgICAgICB9CgogICAgICAgIHF1ZXVlZFt0eElkXSA9IGZhbHNlOwoKICAgICAgICAvLyBwcmVwYXJlIGRhdGEKICAgICAgICBieXRlcyBtZW1vcnkgZGF0YTsKICAgICAgICBpZiAoYnl0ZXMoX2Z1bmMpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgLy8gZGF0YSA9IGZ1bmMgc2VsZWN0b3IgKyBfZGF0YQogICAgICAgICAgICBkYXRhID0gYWJpLmVuY29kZVBhY2tlZChieXRlczQoa2VjY2FrMjU2KGJ5dGVzKF9mdW5jKSkpLCBfZGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gY2FsbCBmYWxsYmFjayB3aXRoIGRhdGEKICAgICAgICAgICAgZGF0YSA9IF9kYXRhOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FsbCB0YXJnZXQKICAgICAgICAoYm9vbCBvaywgYnl0ZXMgbWVtb3J5IHJlcykgPSBfdGFyZ2V0LmNhbGx7dmFsdWU6IF92YWx1ZX0oZGF0YSk7CiAgICAgICAgaWYgKCFvaykgewogICAgICAgICAgICByZXZlcnQgVHhGYWlsZWRFcnJvcigpOwogICAgICAgIH0KCiAgICAgICAgZW1pdCBFeGVjdXRlKHR4SWQsIF90YXJnZXQsIF92YWx1ZSwgX2Z1bmMsIF9kYXRhLCBfdGltZXN0YW1wKTsKCiAgICAgICAgcmV0dXJuIHJlczsKICAgIH0KCiAgICBmdW5jdGlvbiBjYW5jZWwoYnl0ZXMzMiBfdHhJZCkgZXh0ZXJuYWwgb25seU93bmVyIHsKICAgICAgICBpZiAoIXF1ZXVlZFtfdHhJZF0pIHsKICAgICAgICAgICAgcmV2ZXJ0IE5vdFF1ZXVlZEVycm9yKF90eElkKTsKICAgICAgICB9CgogICAgICAgIHF1ZXVlZFtfdHhJZF0gPSBmYWxzZTsKCiAgICAgICAgZW1pdCBDYW5jZWwoX3R4SWQpOwogICAgfQp9Cg==" ref="nofollow noopener noreferrer">TimeLock.sol</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[uosåŸºç¡€ autostart è®¾ç½®ç¨‹åºå¼€æœºè‡ªå¯åŠ¨]]></title>    <link>https://juejin.cn/post/7592615536385490978</link>    <guid>https://juejin.cn/post/7592615536385490978</guid>    <pubDate>2026-01-08T13:39:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592615536385490978" data-draft-id="7592622563547201571" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="uosåŸºç¡€ autostart è®¾ç½®ç¨‹åºå¼€æœºè‡ªå¯åŠ¨"/> <meta itemprop="keywords" content="è¿ç»´"/> <meta itemprop="datePublished" content="2026-01-08T13:39:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¡Œåˆå¿ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/4081803083395527"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            uosåŸºç¡€ autostart è®¾ç½®ç¨‹åºå¼€æœºè‡ªå¯åŠ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4081803083395527/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¡Œåˆå¿ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T13:39:19.000Z" title="Thu Jan 08 2026 13:39:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ç»Ÿä¿¡æ¡Œé¢æ“ä½œç³»ç»Ÿä¸“ä¸šç‰ˆV20ï¼ˆ1070ï¼‰<br/>
Linux uos 5.10.97-arm64-desktop</p>
</blockquote>
<h3 data-id="heading-0">uosåŸºç¡€ autostart è®¾ç½®ç¨‹åºå¼€æœºè‡ªå¯åŠ¨</h3>
<pre><code class="hljs language-c" lang="c">code@uos:~$ ls
æ¨¡æ¿  Desktop  Documents  Downloads  Music  Pictures  Videos
code@uos:~$ ls -al
æ€»ç”¨é‡ <span class="hljs-number">320</span>
drwxr-x--- <span class="hljs-number">21</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .
drwxr-xr-x  <span class="hljs-number">4</span> root root   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">18</span> ..
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">9</span>æœˆ  <span class="hljs-number">15</span> <span class="hljs-number">10</span>:<span class="hljs-number">45</span> æ¨¡æ¿
-rw-r--r--  <span class="hljs-number">1</span> code code     <span class="hljs-number">86</span> <span class="hljs-number">11</span>æœˆ  <span class="hljs-number">9</span>  <span class="hljs-number">2024</span> .bash_aliases
-rw-r--r--  <span class="hljs-number">1</span> code code    <span class="hljs-number">220</span> <span class="hljs-number">2</span>æœˆ  <span class="hljs-number">25</span>  <span class="hljs-number">2024</span> .bash_logout
-rw-r--r--  <span class="hljs-number">1</span> code code   <span class="hljs-number">3748</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> .bashrc
drwxr-xr-x  <span class="hljs-number">8</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .cache
drwxr-xr-x <span class="hljs-number">16</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .config
drwx------  <span class="hljs-number">3</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .dbus
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .deepin-defender
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> Desktop
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> Documents
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> Downloads
drwx------  <span class="hljs-number">3</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .gnupg
-rw-r--r--  <span class="hljs-number">1</span> code code     <span class="hljs-number">27</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .gtkrc<span class="hljs-number">-2.0</span>
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .hplip
drwxr-xr-x  <span class="hljs-number">3</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> .icons
-rw-r--r--  <span class="hljs-number">1</span> code code <span class="hljs-number">194683</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .kwin.<span class="hljs-built_in">log</span>
drwxr-xr-x  <span class="hljs-number">3</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> .local
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> Music
drwxr-xr-x  <span class="hljs-number">3</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> Pictures
drwx------  <span class="hljs-number">3</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .pki
-rw-r--r--  <span class="hljs-number">1</span> code code    <span class="hljs-number">807</span> <span class="hljs-number">2</span>æœˆ  <span class="hljs-number">25</span>  <span class="hljs-number">2024</span> .profile
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> .Public
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> .Templates
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .themes
drwxr-xr-x  <span class="hljs-number">2</span> code code   <span class="hljs-number">4096</span> <span class="hljs-number">6</span>æœˆ  <span class="hljs-number">12</span>  <span class="hljs-number">2024</span> Videos
-rw-r--r--  <span class="hljs-number">1</span> code code    <span class="hljs-number">205</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .wget-hsts
-rw-------  <span class="hljs-number">1</span> code code      <span class="hljs-number">1</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .Xauthority
-rw-------  <span class="hljs-number">1</span> code code   <span class="hljs-number">9346</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .xsession-errors
-rw-r--r--  <span class="hljs-number">1</span> code code   <span class="hljs-number">1753</span> <span class="hljs-number">10</span>æœˆ <span class="hljs-number">28</span> <span class="hljs-number">15</span>:<span class="hljs-number">19</span> .xwayland.<span class="hljs-built_in">log</span>
code@uos:~$ cd .config/
code@uos:~/.config$ ls
autostart               deepin      google-chrome       pipewire-media-session  user-dirs.dirs
autostop                deepinwmrc  gtk<span class="hljs-number">-3.0</span>             pulse
com.huawei.pcmanager    dsg         kcminputrc          SogouPY
dconf                   enchant     kglobalshortcutsrc  systemd
dde-first-run.log_code  fcitx       kwinrc              Trolltech.conf
</code></pre>
<pre><code class="hljs language-c" lang="c">code@uos:~/.config$ cd autostart/
code@uos:~/.config/autostart$ ls
code@uos:~/.config/autostart$ cp /home/code/Desktop/uos-service-support.desktop .
code@uos:~/.config/autostart$ ls
uos-service-support.desktop
code@uos:~/.config/autostart$ 

</code></pre>
<ul>
<li>cpä¹‹æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªç¡®è®¤å¼¹çª—ã€‚</li>
<li>è¿™æ ·åšçš„æ•ˆæœæ˜¯ï¼Œè®¾ç½®"æœåŠ¡ä¸æ”¯æŒ"ä¸ºå¼€æœºè‡ªå¯åŠ¨çš„ç¨‹åº</li>
<li>ç‰¹æ„é‡å¯è¯•äº†ä¸€æŠŠï¼ŒæˆåŠŸäº†</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54b23823c158438ea5dc013db4a7bda4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KGM5Yid5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768484359&amp;x-signature=c%2F2ioRpWCFSOQa4V5Bmm%2F5XoJv4%3D" alt="uos-autostart-config-1.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot é’©å­å…¨é›†å®æˆ˜ï¼ˆäº”ï¼‰ï¼šApplicationContextInitializerè¯¦è§£]]></title>    <link>https://juejin.cn/post/7592829037937475599</link>    <guid>https://juejin.cn/post/7592829037937475599</guid>    <pubDate>2026-01-08T14:36:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592829037937475599" data-draft-id="7592622563547332643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot é’©å­å…¨é›†å®æˆ˜ï¼ˆäº”ï¼‰ï¼šApplicationContextInitializerè¯¦è§£"/> <meta itemprop="keywords" content="Java,é¢è¯•,Spring"/> <meta itemprop="datePublished" content="2026-01-08T14:36:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Webå¤©æ¢¯ä¹‹è·¯"/> <meta itemprop="url" content="https://juejin.cn/user/2825061103052843"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot é’©å­å…¨é›†å®æˆ˜ï¼ˆäº”ï¼‰ï¼šApplicationContextInitializerè¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2825061103052843/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Webå¤©æ¢¯ä¹‹è·¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T14:36:55.000Z" title="Thu Jan 08 2026 14:36:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥å‰–æäº† <strong><code>SpringApplicationRunListener.environmentPrepared()</code></strong> è¿™ä¸€å…³é”®æ‰©å±•ç‚¹ï¼Œå®ç°äº†ç¯å¢ƒåˆæ³•æ€§æ ¡éªŒã€å¯åŠ¨ä¸Šä¸‹æ–‡ä¼ é€’ã€å¤šç¯å¢ƒéš”ç¦»å…œåº•ä¸é…ç½®åŠ¨æ€å¢å¼ºç­‰é«˜é˜¶èƒ½åŠ›ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è¿›å…¥ Spring Boot å¯åŠ¨ç”Ÿå‘½å‘¨æœŸçš„ä¸‹ä¸€ä¸ªé‡è¦é˜¶æ®µâ€”â€”<strong>å®¹å™¨åˆå§‹åŒ–å‰çš„å…³é”®æ‰©å±•ç‚¹</strong>ï¼š<code>ApplicationContextInitializer</code>ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯Â <code>ApplicationContextInitializer</code>ï¼Ÿ</h2>
<p><code>ApplicationContextInitializer</code> æ˜¯ Spring æ¡†æ¶åŸç”Ÿæä¾›çš„æ¥å£ï¼Œåœ¨ Spring Boot ä¸­è¢«å¹¿æ³›ç”¨äº <strong>åœ¨ <code>ApplicationContext</code> åˆå§‹åŒ–å®Œæˆå‰ã€åˆ·æ–°å‰ï¼ˆrefresh å‰ï¼‰å¯¹å®¹å™¨è¿›è¡Œå®šåˆ¶åŒ–é…ç½®</strong>ã€‚å…¶è§¦å‘æ—¶æœºå…·æœ‰å¦‚ä¸‹ç‰¹å¾ï¼š</p>
<ul>
<li><strong>è§¦å‘æ—¶æœº</strong>ï¼š<code>ApplicationContext</code>Â å·²åˆ›å»ºä½†å°šæœªè°ƒç”¨Â <code>refresh()</code>ï¼›</li>
<li><strong>æ ¸å¿ƒçŠ¶æ€</strong>ï¼š<code>Environment</code>Â å·²å®Œå…¨å‡†å¤‡å°±ç»ªï¼Œæ‰€æœ‰é…ç½®å·²ç”Ÿæ•ˆï¼›</li>
<li><strong>æ‰§è¡Œé¡ºåº</strong>ï¼šæ™šäºÂ <code>environmentPrepared()</code>ï¼Œæ—©äºÂ <code>BeanFactoryPostProcessor</code>ï¼›</li>
<li><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼šå¯æ³¨å†Œ Beanã€ä¿®æ”¹ Bean å®šä¹‰ã€è®¾ç½®å®¹å™¨å±æ€§ã€æ³¨å…¥è‡ªå®šä¹‰é€»è¾‘ã€‚</li>
</ul>
<blockquote>
<p>âœ… <strong>æ ¸å¿ƒä»·å€¼</strong>ï¼šåœ¨å®¹å™¨åˆ·æ–°å‰å¯¹ <code>ApplicationContext</code> åšæœ€åçš„â€œé¢„çƒ­â€å’Œâ€œå®šåˆ¶â€ï¼Œæ˜¯å®ç°å®¹å™¨çº§æ‰©å±•ã€å®‰å…¨åŠ å›ºã€AOP æ³¨å…¥ã€ç›‘æ§åŸ‹ç‚¹ç­‰åœºæ™¯çš„æ ¸å¿ƒå…¥å£ã€‚</p>
</blockquote>
<h2 data-id="heading-1">äºŒã€åœºæ™¯ ï¼šå®¹å™¨å®‰å…¨åŠ å›ºï¼ˆç¦æ­¢å±é™© Bean æ³¨å…¥ï¼‰</h2>
<h3 data-id="heading-2">ä¸šåŠ¡ç—›ç‚¹</h3>
<p>å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œéƒ¨åˆ†ç¬¬ä¸‰æ–¹åº“æˆ–å†…éƒ¨ç»„ä»¶å¯èƒ½é€šè¿‡è‡ªåŠ¨é…ç½®æ³¨å…¥é«˜å± Beanï¼ˆå¦‚ <code>Runtime</code>ã€<code>ScriptEngine</code>ã€<code>JndiTemplate</code>ï¼‰ï¼Œå­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰é£é™©ã€‚å³ä½¿é€šè¿‡é…ç½®ç¦ç”¨ï¼Œä»å¯èƒ½å› ä¾èµ–ä¼ é€’æˆ–ç‰ˆæœ¬å‡çº§è¢«æ„å¤–æ¿€æ´»ã€‚</p>
<h3 data-id="heading-3">è§£å†³æ–¹æ¡ˆ</h3>
<p>åˆ©ç”¨ <code>ApplicationContextInitializer</code> åœ¨å®¹å™¨åˆ·æ–°å‰æ‰«æå¹¶ç§»é™¤/æ›¿æ¢é«˜å± Bean å®šä¹‰ï¼Œä»æºå¤´é˜»æ–­å®‰å…¨éšæ‚£ã€‚</p>
<h4 data-id="heading-4">å®ç°ä»£ç </h4>
<pre><code class="hljs language-ini" lang="ini">package com.example.demo.initializer<span class="hljs-comment">;</span>
â€‹
import org.springframework.beans.factory.config.ConfigurableListableBeanFactory<span class="hljs-comment">;</span>
import org.springframework.beans.factory.support.BeanDefinitionBuilder<span class="hljs-comment">;</span>
import org.springframework.beans.factory.support.BeanDefinitionRegistry<span class="hljs-comment">;</span>
import org.springframework.beans.factory.support.DefaultListableBeanFactory<span class="hljs-comment">;</span>
import org.springframework.context.ApplicationContextInitializer<span class="hljs-comment">;</span>
import org.springframework.context.ConfigurableApplicationContext<span class="hljs-comment">;</span>
import org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider<span class="hljs-comment">;</span>
import org.springframework.core.type.filter.AssignableTypeFilter<span class="hljs-comment">;</span>
import org.springframework.jndi.JndiTemplate<span class="hljs-comment">;</span>
import org.springframework.util.StringUtils<span class="hljs-comment">;</span>
â€‹
import javax.naming.InitialContext<span class="hljs-comment">;</span>
import javax.script.ScriptEngine<span class="hljs-comment">;</span>
import java.util.Arrays<span class="hljs-comment">;</span>
import java.util.HashSet<span class="hljs-comment">;</span>
import java.util.Set<span class="hljs-comment">;</span>
â€‹
/**
 * å®¹å™¨å®‰å…¨åŠ å›ºåˆå§‹åŒ–å™¨
 */
public class SecurityHardeningInitializer implements ApplicationContextInitializer&lt;ConfigurableApplicationContext&gt; {
â€‹
 Â   // é«˜å±ç±»é»‘åå•ï¼ˆå¯æ ¹æ®å®‰å…¨ç­–ç•¥åŠ¨æ€åŠ è½½ï¼‰
 Â   private static final Set&lt;String&gt; <span class="hljs-attr">DANGEROUS_BEAN_TYPES</span> = new HashSet&lt;&gt;(Arrays.asList(
 Â  Â  Â  Â  Â   "javax.script.ScriptEngine",
 Â  Â  Â  Â  Â   "javax.naming.InitialContext",
 Â  Â  Â  Â  Â   "org.springframework.jndi.JndiTemplate",
 Â  Â  Â  Â  Â   "java.lang.Runtime"
 Â   ))<span class="hljs-comment">;</span>
â€‹
 Â   @Override
 Â   public void initialize(ConfigurableApplicationContext applicationContext) {
 Â  Â  Â   System.out.println("<span class="hljs-section">[å®‰å…¨åŠ å›º]</span> å¼€å§‹æ‰«æå¹¶æ¸…ç†é«˜å± Bean å®šä¹‰")<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â   //æ„é€ é«˜å±ç±»é»‘åå•çš„ç±»
 Â  Â  Â   if (applicationContext instanceof BeanDefinitionRegistry registry) {
 Â  Â  Â  Â  Â   BeanDefinitionBuilder <span class="hljs-attr">builder1</span> = BeanDefinitionBuilder.genericBeanDefinition(ScriptEngine.class)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   BeanDefinitionBuilder <span class="hljs-attr">builder2</span> = BeanDefinitionBuilder.genericBeanDefinition(InitialContext.class)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   BeanDefinitionBuilder <span class="hljs-attr">builder3</span> = BeanDefinitionBuilder.genericBeanDefinition(JndiTemplate.class)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   BeanDefinitionBuilder <span class="hljs-attr">builder4</span> = BeanDefinitionBuilder.genericBeanDefinition(Runtime.class)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   // æ³¨å†ŒBeanDefinition
 Â  Â  Â  Â  Â   registry.registerBeanDefinition("scriptEngine", builder1.getBeanDefinition())<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   registry.registerBeanDefinition("initialContext", builder2.getBeanDefinition())<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   registry.registerBeanDefinition("jndiTemplate", builder3.getBeanDefinition())<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   registry.registerBeanDefinition("runtime", builder4.getBeanDefinition())<span class="hljs-comment">;</span>
 Â  Â  Â   }
â€‹
 Â  Â  Â   DefaultListableBeanFactory <span class="hljs-attr">beanFactory</span> = (DefaultListableBeanFactory) applicationContext.getBeanFactory()<span class="hljs-comment">;</span>
 Â  Â  Â   String<span class="hljs-section">[]</span> <span class="hljs-attr">beanNames</span> = beanFactory.getBeanDefinitionNames()<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â   for (String beanName : beanNames) {
 Â  Â  Â  Â  Â   var <span class="hljs-attr">beanDefinition</span> = beanFactory.getBeanDefinition(beanName)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   String <span class="hljs-attr">beanClassName</span> = beanDefinition.getBeanClassName()<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â  Â   if (StringUtils.hasText(beanClassName) &amp;&amp; DANGEROUS_BEAN_TYPES.contains(beanClassName)) {
 Â  Â  Â  Â  Â  Â  Â   System.err.printf("<span class="hljs-section">[å®‰å…¨åŠ å›º]</span> æ£€æµ‹åˆ°é«˜å± Beanï¼š%sï¼ˆç±»å‹ï¼š%sï¼‰ï¼Œå·²ç§»é™¤ï¼%n", beanName, beanClassName)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â   beanFactory.removeBeanDefinition(beanName)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }
â€‹
 Â  Â  Â   // ç¦æ­¢é€šè¿‡ @Import æˆ– ComponentScan è‡ªåŠ¨æ³¨å†Œé«˜å±ç±»
 Â  Â  Â   disableDangerousScanning(applicationContext)<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â   System.out.println("<span class="hljs-section">[å®‰å…¨åŠ å›º]</span> å®¹å™¨å®‰å…¨åŠ å›ºå®Œæˆ")<span class="hljs-comment">;</span>
 Â   }
â€‹
 Â   /**
 Â  Â  * ç¦ç”¨é«˜å±ç±»çš„ç»„ä»¶æ‰«æï¼ˆé˜²æ­¢åç»­è‡ªåŠ¨æ³¨å†Œï¼‰
 Â  Â  */
 Â   private void disableDangerousScanning(ConfigurableApplicationContext context) {
 Â  Â  Â   ClassPathScanningCandidateComponentProvider <span class="hljs-attr">scanner</span> =
 Â  Â  Â  Â  Â  Â  Â   new ClassPathScanningCandidateComponentProvider(false)<span class="hljs-comment">;</span>
 Â  Â  Â   scanner.addIncludeFilter(new AssignableTypeFilter(Runtime.class))<span class="hljs-comment">;</span>
 Â  Â  Â   // å®é™…ç”Ÿäº§ä¸­å¯ç»“åˆ AspectJ æˆ–å­—èŠ‚ç å·¥å…·æ‹¦æˆªï¼Œæ­¤å¤„ä»…ä½œç¤ºæ„
 Â  Â  Â   System.out.println("<span class="hljs-section">[å®‰å…¨åŠ å›º]</span> å·²ç¦ç”¨é«˜å±ç±»è‡ªåŠ¨æ‰«æï¼ˆéœ€é…åˆç¼–è¯‘æœŸæ£€æŸ¥ï¼‰")<span class="hljs-comment">;</span>
 Â   }
}
</code></pre>
<h4 data-id="heading-5">é…ç½®æ–¹å¼ï¼ˆä»»é€‰å…¶ä¸€ï¼‰</h4>
<p><strong>æ–¹å¼ 1ï¼šé€šè¿‡ <code>spring.factories</code></strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># resources/META-INF/spring.factories</span>
<span class="hljs-attr">org.springframework.context.ApplicationContextInitializer</span>=\
com.example.demo.initializer.SecurityHardeningInitializer
</code></pre>
<p><strong>æ–¹å¼ 2ï¼šé€šè¿‡ä¸»ç±»æ˜¾å¼æ³¨å†Œ</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoApplication</span> {
 Â   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) {
 Â  Â  Â   <span class="hljs-title class_">SpringApplication</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpringApplication</span>(<span class="hljs-title class_">DemoApplication</span>.<span class="hljs-property">class</span>);
 Â  Â  Â   app.<span class="hljs-title function_">addInitializers</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityHardeningInitializer</span>());
 Â  Â  Â   app.<span class="hljs-title function_">run</span>(args);
 Â   }
}
</code></pre>
<h4 data-id="heading-6">è¾“å‡ºç»“æœ</h4>
<pre><code class="hljs language-less" lang="less">  . Â  <span class="hljs-selector-tag">____</span> Â  Â  Â  Â   <span class="hljs-selector-tag">_</span> Â  Â  Â  Â  Â   <span class="hljs-selector-tag">__</span> <span class="hljs-selector-tag">_</span> <span class="hljs-selector-tag">_</span>
 /\ / <span class="hljs-selector-tag">___</span>'<span class="hljs-selector-tag">_</span> <span class="hljs-selector-tag">__</span> <span class="hljs-selector-tag">_</span> <span class="hljs-selector-tag">_</span>(_)<span class="hljs-selector-tag">_</span> <span class="hljs-selector-tag">__</span>  <span class="hljs-selector-tag">__</span> <span class="hljs-selector-tag">_</span> \ \ \ \
( ( )___ | <span class="hljs-string">'_ | '</span>_| | '_ / _` | \ \ \ \
 \/  ___)| |<span class="hljs-selector-tag">_</span>)| | | | | || (_| |  ) ) ) )
  '  |<span class="hljs-selector-tag">____</span>| <span class="hljs-selector-class">.__</span>|<span class="hljs-selector-tag">_</span>| |<span class="hljs-selector-tag">_</span>|<span class="hljs-selector-tag">_</span>| |<span class="hljs-selector-tag">___</span>, | / / / /
 =========|<span class="hljs-selector-tag">_</span>|==============|<span class="hljs-selector-tag">___</span>/=/<span class="hljs-selector-tag">_</span>/<span class="hljs-selector-tag">_</span>/<span class="hljs-selector-tag">_</span>/
â€‹
 :: <span class="hljs-selector-tag">Spring</span> <span class="hljs-selector-tag">Boot</span> :: Â  Â  Â  Â  Â  Â  Â   (v3.<span class="hljs-number">5.8</span>)
â€‹
<span class="hljs-selector-attr">[å®‰å…¨åŠ å›º]</span> å¼€å§‹æ‰«æå¹¶æ¸…ç†é«˜å± <span class="hljs-selector-tag">Bean</span> å®šä¹‰
<span class="hljs-selector-attr">[å®‰å…¨åŠ å›º]</span> å·²ç¦ç”¨é«˜å±ç±»è‡ªåŠ¨æ‰«æï¼ˆéœ€é…åˆç¼–è¯‘æœŸæ£€æŸ¥ï¼‰
<span class="hljs-selector-attr">[å®‰å…¨åŠ å›º]</span> å®¹å™¨å®‰å…¨åŠ å›ºå®Œæˆ
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">06.580</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.DemoApplication</span> Â  Â  Â  Â  : <span class="hljs-selector-tag">Starting</span> <span class="hljs-selector-tag">DemoApplication</span> <span class="hljs-selector-tag">using</span> <span class="hljs-selector-tag">Java</span> <span class="hljs-number">21.0</span><span class="hljs-selector-class">.9</span> <span class="hljs-selector-tag">with</span> <span class="hljs-selector-tag">PID</span> <span class="hljs-number">11158</span> (/Users/wangmingfei/Documents/ä¸ªäºº/<span class="hljs-number">05</span> javaå¤©æ¢¯ä¹‹è·¯/<span class="hljs-number">01</span> æºç /<span class="hljs-number">03</span> æ¯æ—¥æ‰“å¡ç³»åˆ—/daily-check-in/springbooté’©å­/demo/target/classes started by wangmingfei in /Users/wangmingfei/Documents/ä¸ªäºº/<span class="hljs-number">05</span> javaå¤©æ¢¯ä¹‹è·¯/<span class="hljs-number">01</span> æºç /<span class="hljs-number">03</span> æ¯æ—¥æ‰“å¡ç³»åˆ—/daily-check-in/springbooté’©å­/demo)
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">06.581</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.DemoApplication</span> Â  Â  Â  Â  : <span class="hljs-selector-tag">The</span> <span class="hljs-selector-tag">following</span> <span class="hljs-number">1</span> <span class="hljs-selector-tag">profile</span> <span class="hljs-selector-tag">is</span> <span class="hljs-selector-tag">active</span>: "<span class="hljs-selector-tag">prod</span>"
<span class="hljs-selector-attr">[å®‰å…¨åŠ å›º]</span> æ£€æµ‹åˆ°é«˜å± <span class="hljs-selector-tag">Bean</span>ï¼š<span class="hljs-selector-tag">scriptEngine</span>ï¼ˆç±»å‹ï¼š<span class="hljs-selector-tag">javax</span><span class="hljs-selector-class">.script</span><span class="hljs-selector-class">.ScriptEngine</span>ï¼‰ï¼Œå·²ç§»é™¤ï¼
<span class="hljs-selector-attr">[å®‰å…¨åŠ å›º]</span> æ£€æµ‹åˆ°é«˜å± <span class="hljs-selector-tag">Bean</span>ï¼š<span class="hljs-selector-tag">initialContext</span>ï¼ˆç±»å‹ï¼š<span class="hljs-selector-tag">javax</span><span class="hljs-selector-class">.naming</span><span class="hljs-selector-class">.InitialContext</span>ï¼‰ï¼Œå·²ç§»é™¤ï¼
<span class="hljs-selector-attr">[å®‰å…¨åŠ å›º]</span> æ£€æµ‹åˆ°é«˜å± <span class="hljs-selector-tag">Bean</span>ï¼š<span class="hljs-selector-tag">jndiTemplate</span>ï¼ˆç±»å‹ï¼š<span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.jndi</span><span class="hljs-selector-class">.JndiTemplate</span>ï¼‰ï¼Œå·²ç§»é™¤ï¼
<span class="hljs-selector-attr">[å®‰å…¨åŠ å›º]</span> æ£€æµ‹åˆ°é«˜å± <span class="hljs-selector-tag">Bean</span>ï¼š<span class="hljs-selector-tag">runtime</span>ï¼ˆç±»å‹ï¼š<span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Runtime</span>ï¼‰ï¼Œå·²ç§»é™¤ï¼
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">06.876</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">o</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.b</span><span class="hljs-selector-class">.w</span><span class="hljs-selector-class">.embedded</span><span class="hljs-selector-class">.tomcat</span><span class="hljs-selector-class">.TomcatWebServer</span>  : <span class="hljs-selector-tag">Tomcat</span> <span class="hljs-selector-tag">initialized</span> <span class="hljs-selector-tag">with</span> <span class="hljs-selector-tag">port</span> <span class="hljs-number">8080</span> (http)
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">06.882</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">o</span><span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.catalina</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.StandardService</span> Â  : <span class="hljs-selector-tag">Starting</span> <span class="hljs-selector-tag">service</span> <span class="hljs-selector-attr">[Tomcat]</span>
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">06.883</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">o</span><span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.catalina</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.StandardEngine</span> Â   : <span class="hljs-selector-tag">Starting</span> <span class="hljs-selector-tag">Servlet</span> <span class="hljs-selector-tag">engine</span>: <span class="hljs-selector-attr">[Apache Tomcat/10.1.49]</span>
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">06.901</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">o</span><span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.C</span>.<span class="hljs-selector-attr">[Tomcat]</span>.<span class="hljs-selector-attr">[localhost]</span>.<span class="hljs-selector-attr">[/]</span> Â  Â  Â  : <span class="hljs-selector-tag">Initializing</span> <span class="hljs-selector-tag">Spring</span> <span class="hljs-selector-tag">embedded</span> <span class="hljs-selector-tag">WebApplicationContext</span>
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">06.901</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">w</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.ServletWebServerApplicationContext</span> : <span class="hljs-selector-tag">Root</span> <span class="hljs-selector-tag">WebApplicationContext</span>: <span class="hljs-selector-tag">initialization</span> <span class="hljs-selector-tag">completed</span> <span class="hljs-selector-tag">in</span> <span class="hljs-number">303</span> <span class="hljs-selector-tag">ms</span>
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">07.038</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">o</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.b</span><span class="hljs-selector-class">.w</span><span class="hljs-selector-class">.embedded</span><span class="hljs-selector-class">.tomcat</span><span class="hljs-selector-class">.TomcatWebServer</span>  : <span class="hljs-selector-tag">Tomcat</span> <span class="hljs-selector-tag">started</span> <span class="hljs-selector-tag">on</span> <span class="hljs-selector-tag">port</span> <span class="hljs-number">8080</span> (http) <span class="hljs-selector-tag">with</span> <span class="hljs-selector-tag">context</span> <span class="hljs-selector-tag">path</span> '/'
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-17T23</span>:<span class="hljs-number">58</span>:<span class="hljs-number">07.042</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>  <span class="hljs-selector-tag">INFO</span> <span class="hljs-number">11158</span> <span class="hljs-selector-tag">---</span> <span class="hljs-selector-attr">[ Â  Â  Â  Â  Â  main]</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.DemoApplication</span> Â  Â  Â  Â  : <span class="hljs-selector-tag">Started</span> <span class="hljs-selector-tag">DemoApplication</span> <span class="hljs-selector-tag">in</span> <span class="hljs-number">0.645</span> <span class="hljs-selector-tag">seconds</span> (process running for <span class="hljs-number">0.792</span>)
</code></pre>
<h4 data-id="heading-7">ç”Ÿäº§ä»·å€¼</h4>
<ul>
<li>ä»å®¹å™¨å±‚é¢æ‹¦æˆªé«˜å± Beanï¼Œæ¯”è¿è¡Œæ—¶æ£€æµ‹æ›´æ—©ã€æ›´å½»åº•ï¼›</li>
<li>é˜²æ­¢å› ä¾èµ–å‡çº§æˆ–é…ç½®é”™è¯¯å¼•å…¥å®‰å…¨æ¼æ´ï¼›</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€æ€»ç»“</h2>
<p><code>ApplicationContextInitializer</code> æ˜¯ Spring Boot å¯åŠ¨æµç¨‹ä¸­ <strong>è¿æ¥ç¯å¢ƒå‡†å¤‡ä¸å®¹å™¨åˆ·æ–°çš„å…³é”®æ¡¥æ¢</strong>ï¼Œå®ƒä¸ <code>environmentPrepared()</code> å½¢æˆâ€œç¯å¢ƒ â†’ å®¹å™¨â€çš„å®Œæ•´æ‰©å±•é“¾è·¯ï¼Œæ˜¯æ„å»ºä¼ä¸šçº§é«˜å¯é ã€é«˜å®‰å…¨ã€é«˜å¯è§‚æµ‹æ€§åº”ç”¨ä¸å¯æˆ–ç¼ºçš„ä¸€ç¯ã€‚</p>
<p>ğŸ“ŒÂ <strong>å…³æ³¨æˆ‘</strong>ï¼Œæ¯å¤© 5 åˆ†é’Ÿï¼Œå¸¦ä½ ä» Java å°ç™½å˜èº«ç¼–ç¨‹é«˜æ‰‹ï¼</p>
<p>ğŸ‘‰ ç‚¹èµ + å…³æ³¨ + è½¬å‘ï¼Œè®©æ›´å¤šå°ä¼™ä¼´ä¸€èµ·è¿›æ­¥ï¼</p>
<p>ğŸ‘‰ ç§ä¿¡ "SpringBoot é’©å­æºç " è·å–å®Œæ•´æºç ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£Pythonæ§åˆ¶æµï¼šä»if-elseåˆ°ç»“æ„æ¨¡å¼åŒ¹é…ï¼Œå†™å‡ºæ›´ä¼˜é›…çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘]]></title>    <link>https://juejin.cn/post/7592615536385703970</link>    <guid>https://juejin.cn/post/7592615536385703970</guid>    <pubDate>2026-01-08T15:17:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592615536385703970" data-draft-id="7592622563547430947" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£Pythonæ§åˆ¶æµï¼šä»if-elseåˆ°ç»“æ„æ¨¡å¼åŒ¹é…ï¼Œå†™å‡ºæ›´ä¼˜é›…çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-08T15:17:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="love_summer"/> <meta itemprop="url" content="https://juejin.cn/user/1462819851084228"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£Pythonæ§åˆ¶æµï¼šä»if-elseåˆ°ç»“æ„æ¨¡å¼åŒ¹é…ï¼Œå†™å‡ºæ›´ä¼˜é›…çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1462819851084228/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    love_summer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T15:17:16.000Z" title="Thu Jan 08 2026 15:17:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin:30px 0 10px;color:#cca152;position:relative;padding-left:50px;border-bottom:2px solid rgba(209,163,78,.6);padding-bottom:0}.markdown-body h1{font-size:30px}.markdown-body h1:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:80%;bottom:-10px;left:-2px}.markdown-body h2{font-size:24px}.markdown-body h2:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:70%;bottom:-15px;left:-1px}.markdown-body h3{font-size:18px}.markdown-body h3:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:60%;bottom:-19px;left:-2px}.markdown-body h4{font-size:16px;padding-left:0;border-bottom:1px solid rgba(209,163,78,.6)}.markdown-body h5{font-size:15px;padding-left:0}.markdown-body em{color:#cca152}.markdown-body del{text-decoration-color:#cca152;text-decoration-thickness:2px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:80%;margin:6px auto;box-shadow:0 6px 15px #8e8e8e;display:block;margin:20px auto!important;object-fit:contain;border-radius:8px}.markdown-body hr{border:none;border-top:2px solid #e0c9a1;margin-top:32px 0}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background:#f6efde;color:#b69454;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Mono,Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;background:#fef6e1;border-radius:4px;box-shadow:0 0 8px hsla(0,0%,47%,.45)}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAOCAMAAABaWb9VAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACHUExURUdwTMxCKdc8NvdYT/9hVyLJPABBAGubKNiIOv+/K+ytJBakH9aZG+5QR5VZDOBDPhmtJ8+VGuGjH/CwJR26MR6+NBq0LPW1KBmwKetNRfJUTONHP92fHuSmIeFEPhu3LR29M/BTS+mqIuqsI5qdHyLKPP++Kv9gVf9lW//KLSXXQCTQP//FLMVm5KQAAAAldFJOUwAlPPz7+woBBPu8Mzu+FlRRKmvnweeG+Wqg6mVNXmuc1OCbmjZJWF/9AAABKklEQVQoz3WS6XaCMBCFRzAM++KGsqhtDwES3//5OtmA2uP9A9zwzRoAgBC0QgQrdA68OZsDr229YGHoIEj7Pl0ZOgjKa5lYJ4Rd1vijn3nuD4Qurjmv48o6RFyfbGDnS6DeEXZfk5ZfuBhdPb9I87ECNMh1EFJKIU6agWzaa01NbmLkxznSmmObJBkkUxrERf3i+ftRiZi7ShPCYY64UhTx1AR5CDYoMXkOKEY7GmTcTzeD/FiER68DfSLgSRqEIBoB3P8h3x8RZhBXGJGusJdD6rfCBl0YqvZNkrV9zej2cWlfJWG6fRpyM41qYH+GTPPi2yFLQYC0Qybm5o96lW77kMbcrBKtgeWTsthVamNXFF4I6x0DTPuugsVRFyYpyxzWqNvHJwed8ws7QyP1UwjNjwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fef6e1}.markdown-body a{text-decoration:none;color:#d8ac5a;border-bottom:1px solid #d8ac5a}.markdown-body a:active,.markdown-body a:hover{color:#93753f;border-color:#93753f}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f4e8c7;border-collapse:collapse}.markdown-body thead{background:rgba(255,227,176,.6588235294);text-align:left;display:table-header-group;border-bottom:1px solid rgba(255,227,176,.6588235294)}.markdown-body tbody{background:rgba(255,247,229,.3882352941)}.markdown-body td,.markdown-body th{padding:7px;line-height:24px;min-width:100px}.markdown-body blockquote{color:#bd954f;padding:1px 23px;margin:22px 0;border-left:4px solid #dcb267;background-color:#fff7e5}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol .task-list-item,.markdown-body ul .task-list-item{list-style:none}.markdown-body ol li{padding-left:6px}.markdown-body::marker{color:#dcb267}.markdown-body .contains-task-list{padding-left:0}.markdown-body .contains-task-list .task-list-item{list-style:none;position:relative}.markdown-body .contains-task-list .task-list-item input[type=checkbox]{position:relative;top:2px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:before{content:"";display:inline-block;height:12px;width:12px;position:absolute;left:-2px;top:-2px;border:2px solid #cda152;border-radius:5px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:checked{position:relative;top:2px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:checked:before{border:none;content:"";display:inline-block;height:17px;width:17px;position:absolute;left:-2px;top:-2px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAFo9M/3AAAAAXNSR0IArs4c6QAAAYhJREFUOBFjYACC0/MDGsDEiyvr/zOCeUwMJxn/A8HZRUEMYBFGJsZ6kFoQYALiAyAGCgDpA+sFijKeWRj4H1kWpIWBW1SDQcm+BCzOAiK/vr7BcO/gDbAAI4hE1waWgRBnmWCGIwkyKFjnwow0BhsJk9QLncvw5dV1oPE9MCEGmBWrgCKhcFEowyR+PSNYwemFAZ4M/xjMkRWYJm5oAPFB/joDpI1BHHQANgGPDxj+//vfCA4IdJ3GcevgQnAFhlHLwYIgSVA0wABcwY3tFQzokiBFGIEP0wmigW5wZAK5FFkQib0a6NUDcEmgb7AGFpIGZOZqoMFhIAFQknEAJpn9yLLEssFOBCp2IFaDkl0xg6C8FbJyB3gowUS5RdQYBORQYpVB1iwVHIIMwJh///AYTCmYRklNIBFmNi4GeYt0BhnjeIa3dw8wSBlEgDUhxw2yCRgGfHp2geHiqiSwUwUVrFAiFVkjjA1LrjgTHEwhFvosMCZM4NEIUoAtWWNoBGZ70/gN22HiAD2uhAzsYNBZAAAAAElFTkSuQmCC) 0 0 no-repeat;background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>å¼•è¨€</strong><br/>
ç¼–å†™æ¡ä»¶åˆ¤æ–­è¯­å¥æ˜¯æ¯ä½ç¨‹åºå‘˜çš„åŸºæœ¬åŠŸã€‚ä½†ä½ æ˜¯å¦æƒ³è¿‡ï¼Œå¦‚ä½•å†™å‡ºä¸€è¡Œ<strong>å¯è¯»æ€§é«˜</strong>ã€<strong>æ€§èƒ½ä¼˜</strong>ã€<strong>æ— éšæ‚£</strong>çš„<code>if</code>ä»£ç ï¼Ÿä»Šå¤©ï¼Œæˆ‘å°†ç»“åˆã€Šè·Ÿç€å¨Ÿå­å§å­¦Pythonã€‹çš„å­¦ä¹ ï¼Œä¸å¤§å®¶æ·±å…¥æ¢è®¨Pythonä¸­çš„é€‰æ‹©ç»“æ„ï¼Œå¹¶åˆ†äº«ä¸€äº›è¿›é˜¶å†™æ³•å’Œé¿å‘æŒ‡å—ã€‚</p>
</blockquote>
<h3 data-id="heading-0">ä¸€ã€å•åˆ†æ”¯ifï¼šç®€æ´ä¸é™·é˜±</h3>
<p>å•åˆ†æ”¯ç»“æ„æ˜¯æœ€åŸºç¡€çš„é€»è¾‘ã€‚ä½†åˆå­¦è€…å®¹æ˜“åœ¨å¸ƒå°”å€¼åˆ¤æ–­ä¸Šå‡ºé”™ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¨èå†™æ³•ï¼šé€»è¾‘æ¸…æ™°</span>
<span class="hljs-keyword">if</span> is_logged_in:
    do_something()
<span class="hljs-comment"># ä¸æ¨èçš„å†™æ³•ï¼šå¤šä½™çš„==True</span>
<span class="hljs-keyword">if</span> is_logged_in == <span class="hljs-literal">True</span>:
    do_something()
</code></pre>
<p><strong>è¿›é˜¶ç‚¹ï¼šå¯¹è±¡å¸ƒå°”å€¼çš„å·§å¦™åˆ©ç”¨</strong></p>
<p>åœ¨ç¤ºä¾‹4-2ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨é0æ•°å€¼ã€éç©ºåºåˆ—çš„å¸ƒå°”å€¼ä¸º<code>True</code>è¿™ä¸€ç‰¹æ€§ï¼Œå†™å‡ºéå¸¸ç®€æ´çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åˆ©ç”¨ not åˆ¤æ–­å¶æ•°</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> n % <span class="hljs-number">2</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{n}</span>æ˜¯å¶æ•°"</span>)
<span class="hljs-comment"># åˆ©ç”¨æœ¬èº«åˆ¤æ–­éç©ºå­—ç¬¦ä¸²</span>
<span class="hljs-keyword">if</span> input_str:  <span class="hljs-comment"># å¦‚æœinput_strä¸æ˜¯ç©ºå­—ç¬¦ä¸²</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”¨æˆ·è¾“å…¥äº†å†…å®¹"</span>)
</code></pre>
<h3 data-id="heading-1">äºŒã€åŒåˆ†æ”¯if-elseï¼šé¿å…æ·±åµŒå¥—</h3>
<p>åŒåˆ†æ”¯ç»“æ„éå¸¸å¸¸è§ã€‚ä½†ä¸€ä¸ªç»å¸¸è¢«å¿½è§†çš„é—®é¢˜æ˜¯å¦‚ä½•é¿å…ä»£ç ä¸­çš„**â€œç®­å¤´å½¢â€åµŒå¥—**ï¼ˆArrow-shaped codeï¼‰ã€‚</p>
<p><strong>ã€ç¤ºä¾‹ã€‘ç³Ÿç³•çš„åµŒå¥— vs ä¼˜é›…çš„å«è¯­å¥</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ğŸš« ä¸æ¨èï¼šåµŒå¥—è¿‡æ·±ï¼Œå¯è¯»æ€§å·®</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>(<span class="hljs-params">data</span>):
    <span class="hljs-keyword">if</span> data:
        <span class="hljs-keyword">if</span> validate(data):
            <span class="hljs-keyword">if</span> process(data):
                <span class="hljs-keyword">return</span> <span class="hljs-string">"å¤„ç†æˆåŠŸ"</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-string">"å¤„ç†å¤±è´¥"</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•°æ®æ ¡éªŒå¤±è´¥"</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•°æ®ä¸ºç©º"</span>
<span class="hljs-comment"># âœ… æ¨èï¼šä½¿ç”¨å«è¯­å¥æå‰è¿”å›/å¼‚å¸¸ï¼Œç»“æ„æ‰å¹³</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>(<span class="hljs-params">data</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•°æ®ä¸ºç©º"</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> validate(data):
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•°æ®æ ¡éªŒå¤±è´¥"</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> process(data):
        <span class="hljs-keyword">return</span> <span class="hljs-string">"å¤„ç†å¤±è´¥"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"å¤„ç†æˆåŠŸ"</span>
</code></pre>
<blockquote>
<p><strong>ã€è§£é‡Šã€‘</strong> è¿™ç§å°†å¼‚å¸¸æˆ–å¤±è´¥æ¡ä»¶å‰ç½®çš„å†™æ³•ï¼Œå«â€œå«è¯­å¥â€ï¼Œèƒ½æå¤§æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p>
</blockquote>
<h3 data-id="heading-2">ä¸‰ã€å¤šåˆ†æ”¯if-elif-elseï¼šé€‰æ‹©æœ€ä½³ç»“æ„</h3>
<p>å½“éœ€è¦å¤„ç†å¤šç§æ¡ä»¶æ—¶ï¼Œ<code>if-elif-else</code> æ˜¯ä¸äºŒä¹‹é€‰ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>Pythonä¸­çš„<code>elif</code>æ˜¯æœ‰é¡ºåºæ€§çš„ï¼Œä¸”ä¸€æ—¦å‘½ä¸­å°±ä¼šçŸ­è·¯åç»­åˆ¤æ–­</strong>ã€‚</p>
<p><strong>ã€ç¤ºä¾‹4-4ã€‘æˆç»©åˆ’åˆ†çš„ä¼˜åŒ–</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âœ… æœ€ä½³å®è·µï¼šä»ä¸Šå¾€ä¸‹å†™ï¼Œäº’æ–¥åŒºé—´</span>
score = <span class="hljs-number">85</span>
<span class="hljs-keyword">if</span> score &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> score &gt; <span class="hljs-number">100</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'æ— æ•ˆæˆç»©'</span>)
<span class="hljs-keyword">elif</span> score &lt; <span class="hljs-number">60</span>:      <span class="hljs-comment"># 0 &lt;= score &lt; 60</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'E'</span>)
<span class="hljs-keyword">elif</span> score &lt; <span class="hljs-number">70</span>:      <span class="hljs-comment"># 60 &lt;= score &lt; 70</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'D'</span>)
<span class="hljs-keyword">elif</span> score &lt; <span class="hljs-number">80</span>:      <span class="hljs-comment"># 70 &lt;= score &lt; 80</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'C'</span>)
<span class="hljs-keyword">elif</span> score &lt; <span class="hljs-number">90</span>:      <span class="hljs-comment"># 80 &lt;= score &lt; 90</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'B'</span>)
<span class="hljs-keyword">else</span>:               <span class="hljs-comment"># 90 &lt;= score &lt;= 100</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'A'</span>)
</code></pre>
<blockquote>
<p><strong>ã€æ³¨æ„ã€‘</strong> å¤šä¸ªæ¡ä»¶åŒºé—´å¿…é¡»<strong>æ— é‡å ä¸”è¦†ç›–å…¨é›†</strong>ï¼Œå¦åˆ™ä¼šäº§ç”Ÿé€»è¾‘æ¼æ´ã€‚</p>
</blockquote>
<h3 data-id="heading-3">å››ã€é€»è¾‘è¿ç®—ç¬¦ï¼šandã€orçš„æ‰§è¡Œé¡ºåºä¸ä¼˜å…ˆçº§</h3>
<p>åœ¨ä½¿ç”¨<code>and</code>å’Œ<code>or</code>ç»„åˆå¤æ‚æ¡ä»¶æ—¶ï¼Œå¿…é¡»æ˜ç¡®<strong>è¿ç®—ç¬¦ä¼˜å…ˆçº§</strong>ï¼š<code>not</code> &gt; <code>and</code> &gt; <code>or</code>ã€‚</p>
<p><strong>ã€ç¤ºä¾‹ã€‘ä¼˜å…ˆçº§é™·é˜±</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ğŸš« å®¹æ˜“äº§ç”Ÿæ­§ä¹‰çš„å†™æ³•</span>
<span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> z &gt; <span class="hljs-number">10</span>:
    <span class="hljs-keyword">pass</span>
<span class="hljs-comment"># âœ… å¼ºè°ƒä¼˜å…ˆçº§çš„å†™æ³•</span>
<span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">or</span> (z &gt; <span class="hljs-number">10</span>):
    <span class="hljs-keyword">pass</span>
<span class="hljs-comment"># ğŸš€ æ›´å¥½çš„å†™æ³•ï¼šä¸€è¡Œä»£ç è§£å†³ï¼Œå¯è¯»æ€§æ›´é«˜</span>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>([x &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y &lt; <span class="hljs-number">0</span>, z &gt; <span class="hljs-number">10</span>]):
    <span class="hljs-keyword">pass</span>
</code></pre>
<blockquote>
<p><strong>ã€æ€è€ƒã€‘</strong> ä½¿ç”¨å†…ç½®å‡½æ•° <code>any()</code> å’Œ <code>all()</code> å¯ä»¥å°†å¤æ‚çš„é€»è¾‘ç»„åˆè½¬åŒ–ä¸ºæ›´å‡½æ•°å¼çš„å†™æ³•ï¼Œéå¸¸Pythonicã€‚</p>
</blockquote>
<h3 data-id="heading-4">äº”ã€å®æˆ˜å¿ƒå¾—ï¼šç¼–å†™å¥å£®çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘</h3>
<ol>
<li><strong>ä½¿ç”¨æšä¸¾ä»£æ›¿é­”æ³•å€¼</strong>ï¼šåœ¨<code>if</code>ä¸­ç›´æ¥æ¯”è¾ƒ<code>status == 1</code>å’Œ<code>status == 2</code>æ˜¯ç³Ÿç³•çš„å®è·µã€‚å®šä¹‰ä¸€ä¸ª<code>Status</code>æšä¸¾ï¼Œç”¨<code>Status.SUCCESS</code>æ›¿ä»£<code>1</code>ã€‚</li>
<li><strong>é¿å…é‡å¤è®¡ç®—</strong>ï¼šå¦‚æœåˆ¤æ–­æ¡ä»¶ä¸­æœ‰å‡½æ•°è°ƒç”¨ï¼Œå¦‚ <code>if is_valid(data) and compute(data):</code>ï¼Œ<code>compute(data)</code> æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œã€‚æ›´å¥½çš„æ–¹å¼æ˜¯ï¼š
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> is_valid(data):
    <span class="hljs-keyword">if</span> compute(data):
        <span class="hljs-comment"># ...</span>
</code></pre>
</li>
<li><strong>å–„ç”¨å­—å…¸åˆ†å‘</strong>ï¼šå½“<code>if-elif</code>é“¾è¿‡é•¿ï¼Œä¸”æ¯ä¸ªåˆ†æ”¯æ‰§è¡Œçš„æ“ä½œç±»ä¼¼ï¼ˆåªæ˜¯å‚æ•°ä¸åŒï¼‰æ—¶ï¼Œå¯ä»¥è€ƒè™‘ç”¨å­—å…¸æ›¿ä»£ã€‚
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ğŸš« if-elifé“¾</span>
<span class="hljs-keyword">if</span> cmd == <span class="hljs-string">'start'</span>:
    handle_start()
<span class="hljs-keyword">elif</span> cmd == <span class="hljs-string">'stop'</span>:
    handle_stop()
<span class="hljs-comment"># ...</span>

<span class="hljs-comment"># âœ… å­—å…¸åˆ†å‘</span>
handlers = {<span class="hljs-string">'start'</span>: handle_start, <span class="hljs-string">'stop'</span>: handle_stop}
<span class="hljs-keyword">if</span> cmd <span class="hljs-keyword">in</span> handlers:
    handlers[cmd]()
</code></pre>
</li>
</ol>
<h3 data-id="heading-5">æ€»ç»“</h3>
<p>é€‰æ‹©ç»“æ„æ˜¯ç¨‹åºé€»è¾‘çš„åŸºçŸ³ã€‚æŒæ¡å…¶åŸºç¡€ç”¨æ³•æ˜¯å¼€å§‹ï¼Œä½†å†™å‡º<strong>æ¸…æ™°ã€å¥å£®ã€Pythonic</strong>çš„æ¡ä»¶åˆ¤æ–­ä»£ç ï¼Œæ‰æ˜¯é«˜çº§ç¨‹åºå‘˜çš„è¿½æ±‚ã€‚å¸Œæœ›æœ¬ç¯‡æ–‡ç« çš„è¿›é˜¶è§†è§’èƒ½ç»™ä½ å¸¦æ¥ä¸€äº›å¯å‘ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°æ®ç¿»è¯‘å®˜å‡­å•¥é«˜æ•ˆï¼ŸåµŒå…¥å¼ NanoPb æ­æ™“]]></title>    <link>https://juejin.cn/post/7592622563547250723</link>    <guid>https://juejin.cn/post/7592622563547250723</guid>    <pubDate>2026-01-08T13:56:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592622563547250723" data-draft-id="7592622563547037731" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°æ®ç¿»è¯‘å®˜å‡­å•¥é«˜æ•ˆï¼ŸåµŒå…¥å¼ NanoPb æ­æ™“"/> <meta itemprop="keywords" content="åµŒå…¥å¼,ç‰©è”ç½‘,å•ç‰‡æœº"/> <meta itemprop="datePublished" content="2026-01-08T13:56:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿·äººçš„æ˜Ÿç©º"/> <meta itemprop="url" content="https://juejin.cn/user/977890073916588"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°æ®ç¿»è¯‘å®˜å‡­å•¥é«˜æ•ˆï¼ŸåµŒå…¥å¼ NanoPb æ­æ™“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/977890073916588/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿·äººçš„æ˜Ÿç©º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T13:56:14.000Z" title="Thu Jan 08 2026 13:56:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0"><strong>ä¸€ã€å®ƒåˆ°åº•æ˜¯ä»€ä¹ˆ</strong></h3>
<p>åµŒå…¥å¼NanoPbæ˜¯ä¸€ä¸ªä¸“ä¸º<strong>å•ç‰‡æœºã€ç‰©è”ç½‘ç»ˆç«¯ç­‰èµ„æºå—é™è®¾å¤‡</strong>é‡èº«å®šåˆ¶çš„â€œ<strong>æ•°æ®ç¿»è¯‘å®˜</strong>â€å’Œâ€œ<strong>åè®®åˆ¶å®šå™¨</strong>â€ã€‚å®ƒçš„æ ¸å¿ƒä»»åŠ¡ï¼Œæ˜¯æŠŠè®¾å¤‡å†…éƒ¨å¤æ‚çš„ã€ç»“æ„åŒ–çš„æ•°æ®ï¼ˆæ¯”å¦‚ä¼ æ„Ÿå™¨çš„æ¸©åº¦ã€æ—¶é—´ã€çŠ¶æ€ï¼‰ï¼Œç”¨ä¸€ç§<strong>æåº¦ç´§å‡‘ã€é«˜æ•ˆä¸”ä¸æŒ‘ç¡¬ä»¶çš„äºŒè¿›åˆ¶è¯­è¨€</strong>æ‰“åŒ…ã€ä¼ è¾“ï¼Œå¹¶èƒ½è®©æ¥æ”¶æ–¹å‡†ç¡®æ— è¯¯åœ°ç†è§£ã€‚</p>
<p>ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆï¼š</p>
<ul>
<li><strong>ä¸ºâ€œå°è´§è½¦â€è®¾è®¡çš„â€œæ ‡å‡†åŒ–è´§ç®±â€</strong> ï¼šç›¸æ¯”ç”¨å¤§å°ä¸ä¸€çš„â€œçº¸ç®±â€ï¼ˆè‡ªå®šä¹‰æ ¼å¼ï¼‰æˆ–å¡æ»¡æ³¡æ²«çš„â€œå¤§ç®±å­â€ï¼ˆJSON/XMLï¼‰ï¼Œå®ƒæä¾›äº†æœ€é€‚åˆå°è´§è½¦è¿è¾“çš„ã€ä¸¥ä¸åˆç¼çš„é›†è£…ç®±ã€‚</li>
<li><strong>è®¾å¤‡é—´çš„â€œæ‘©å°”æ–¯ç”µç â€</strong> ï¼šå®ƒåˆ¶å®šäº†ä¸€å¥—éå¸¸ç®€æ´é«˜æ•ˆçš„ç¼–ç è§„åˆ™ï¼Œè®©è®¾å¤‡ä¹‹é—´å¯ä»¥ç”¨æœ€å°‘çš„â€œæ»´ç­”â€å£°ï¼ˆæ•°æ®å­—èŠ‚ï¼‰ä¼ è¾¾ä¸°å¯Œã€å‡†ç¡®çš„ä¿¡æ¯ã€‚</li>
</ul>
<h3 data-id="heading-1"><strong>äºŒã€å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</strong></h3>
<p>å…¶å·¥ä½œåŸç†å¯ä»¥æ¦‚æ‹¬ä¸ºÂ  <strong>â€œä¸€å¥—å·¥å…·ï¼Œä¸¤æ¬¡è½¬æ¢â€</strong> Â ã€‚å®ƒä¸æ˜¯åœ¨å•ç‰‡æœºä¸Šç°åœºç¿»è¯‘ï¼Œè€Œæ˜¯å…ˆåœ¨åŠŸèƒ½å¼ºå¤§çš„PCä¸Š<strong>ç”Ÿæˆä¸€å¥—ä¸“ç”¨çš„â€œç¿»è¯‘æ‰‹å†Œâ€</strong> ï¼Œç„¶åè®©å•ç‰‡æœºç…§ç€æ‰‹å†Œæœºæ¢°åœ°æ‰§è¡Œã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šåˆ¶å®šâ€œæ•°æ®å¥‘çº¦â€ï¼ˆ.protoæ–‡ä»¶ï¼‰</strong><br/>
å·¥ç¨‹å¸ˆåœ¨ç”µè„‘ä¸Šç”¨ä¸€ç§å«Â <strong>Protocol Buffers</strong>Â çš„è¯­è¨€ï¼Œå®šä¹‰ä¸€ä¸ªÂ <code>.proto</code>Â æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ä¸åŒ…å«ä»»ä½•å…·ä½“æ•°æ®ï¼Œåªå®šä¹‰<strong>æ•°æ®çš„ç»“æ„</strong>ï¼Œæ˜¯æ‰€æœ‰å‚ä¸æ–¹å¿…é¡»éµå®ˆçš„â€œå¥‘çº¦â€ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// ç¤ºä¾‹ï¼šå®šä¹‰ä¸€ä¸ªä¼ æ„Ÿå™¨æ•°æ®çš„â€œå¥‘çº¦â€
<span class="hljs-attr">syntax</span> = <span class="hljs-string">"proto2"</span><span class="hljs-comment">; // ä½¿ç”¨proto2ç‰ˆæœ¬ï¼Œæ§åˆ¶æ›´ç²¾ç»†</span>
message SensorData {
    required uint32 <span class="hljs-attr">timestamp</span> = <span class="hljs-number">1</span><span class="hljs-comment">;  // å¿…å¡«å­—æ®µï¼Œç¼–å·ä¸º1</span>
    required float <span class="hljs-attr">temperature</span> = <span class="hljs-number">2</span><span class="hljs-comment">; // å¿…å¡«å­—æ®µï¼Œç¼–å·ä¸º2</span>
    optional float <span class="hljs-attr">humidity</span> = <span class="hljs-number">3</span><span class="hljs-comment">;    // å¯é€‰å­—æ®µï¼Œç¼–å·ä¸º3</span>
    repeated int32 <span class="hljs-attr">samples</span> = <span class="hljs-number">4</span> [max_count = <span class="hljs-number">20</span>]<span class="hljs-comment">; // æ•°ç»„ï¼Œæœ€å¤§é•¿åº¦20</span>
}
</code></pre>
<p><strong>å…³é”®</strong>ï¼šè¿™é‡Œçš„å­—æ®µç¼–å·ï¼ˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼‰æ˜¯ç¼–ç å’Œè§£ç çš„å”¯ä¸€ä¾æ®ï¼Œå–ä»£äº†ä½æ•ˆçš„å­—æ®µåã€‚</p>
<p><strong>ç¬¬äºŒæ­¥ï¼šç”Ÿæˆâ€œç¿»è¯‘æ‰‹å†Œâ€ï¼ˆCä»£ç ï¼‰</strong><br/>
ä½¿ç”¨ä¸“ç”¨çš„ç¼–è¯‘å™¨å·¥å…·ï¼ˆ<code>protoc</code>Â + NanoPbæ’ä»¶ï¼‰ï¼Œæ ¹æ®ä¸Šä¸€æ­¥çš„Â <code>.proto</code>Â å¥‘çº¦ï¼Œç”Ÿæˆçº¯Cä»£ç æ–‡ä»¶ï¼ˆ<code>.pb.c</code>Â å’ŒÂ <code>.pb.h</code>ï¼‰ã€‚è¿™ä¸ªç”Ÿæˆçš„ä»£ç å°±æ˜¯å•ç‰‡æœºçš„â€œç¿»è¯‘æ‰‹å†Œâ€ã€‚</p>
<p>ç”Ÿæˆçš„å¤´æ–‡ä»¶ä¸­ï¼Œä¼šåŒ…å«ä¸€ä¸ªå¯ä»¥ç›´æ¥åœ¨Cç¨‹åºä¸­ä½¿ç”¨çš„ç»“æ„ä½“ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ç”Ÿæˆçš„Cç»“æ„ä½“ï¼Œä¸.protoå¥‘çº¦ä¸€ä¸€å¯¹åº”</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> {
    <span class="hljs-type">uint32_t</span> timestamp;
    <span class="hljs-type">float</span> temperature;
    <span class="hljs-type">bool</span> has_humidity; <span class="hljs-comment">// æ ‡å¿—ä½ï¼ŒæŒ‡ç¤ºhumidityå­—æ®µæ˜¯å¦æœ‰å€¼</span>
    <span class="hljs-type">float</span> humidity;
    <span class="hljs-type">pb_size_t</span> samples_count; <span class="hljs-comment">// å®é™…æ•°ç»„é•¿åº¦</span>
    <span class="hljs-type">int32_t</span> samples[<span class="hljs-number">20</span>];     <span class="hljs-comment">// é™æ€æ•°ç»„ï¼Œé•¿åº¦ç”±max_countå›ºå®š</span>
} SensorData;
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåœ¨è®¾å¤‡ä¸Šæ‰§è¡Œâ€œç¿»è¯‘â€</strong></p>
<ol>
<li><strong>ç¼–ç ï¼ˆå‘é€æ•°æ®ï¼‰</strong> ï¼šè®¾å¤‡ç¨‹åºä¸­ï¼Œå¡«å……å¥½SensorDataç»“æ„ä½“ï¼Œç„¶åè°ƒç”¨Â <code>pb_encode()</code>Â å‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šåƒä¸€å°é«˜æ•ˆçš„æ‰“åŒ…æœºï¼Œä¸¥æ ¼æŒ‰ç…§â€œç¿»è¯‘æ‰‹å†Œâ€ï¼Œå°†ç»“æ„ä½“ä¸­çš„æ¯ä¸ªå­—æ®µè½¬æ¢æˆæç®€çš„äºŒè¿›åˆ¶åºåˆ—ï¼Œæ”¾å…¥ä½ æŒ‡å®šçš„å‘é€ç¼“å†²åŒºã€‚</li>
<li><strong>è§£ç ï¼ˆæ¥æ”¶æ•°æ®ï¼‰</strong> ï¼šä»é€šä¿¡æ¥å£ï¼ˆå¦‚UARTï¼‰æ”¶åˆ°ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ®åï¼Œè°ƒç”¨Â <code>pb_decode()</code>Â å‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šæŒ‰ç…§åŒä¸€ä»½â€œæ‰‹å†Œâ€ï¼Œå°†äºŒè¿›åˆ¶æµç²¾å‡†åœ°è¿˜åŸå¡«å……åˆ°å¦ä¸€ä¸ªSensorDataç»“æ„ä½“ä¸­ï¼Œä¾›ç¨‹åºä½¿ç”¨ã€‚</li>
</ol>
<p><strong>é«˜æ•ˆçš„æ ¸å¿ƒç§˜å¯†</strong>ï¼šå®ƒé‡‡ç”¨äº†Â  <strong>â€œæ ‡ç­¾-é•¿åº¦-å€¼â€</strong> Â å’ŒÂ  <strong>â€œå˜é•¿æ•´æ•°â€</strong> Â ä¸¤å¤§ç¼–ç æŠ€æœ¯ã€‚</p>
<ul>
<li><strong>æ ‡ç­¾</strong>ï¼šç”¨å­—æ®µç¼–å·ä»£æ›¿å­—æ®µåã€‚</li>
<li><strong>å˜é•¿æ•´æ•°</strong>ï¼šå¯¹äºè¾ƒå°çš„æ•°å­—ï¼Œåªç”¨1ä¸ªå­—èŠ‚å­˜å‚¨ï¼›å¤§çš„æ•°å­—æ‰ç”¨æ›´å¤šå­—èŠ‚ã€‚è¿™ä½¿å¾—åƒÂ <code>timestamp</code>Â è¿™æ ·çš„æ•°æ®åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä½“ç§¯éƒ½è¿œå°äºå›ºå®šçš„4å­—èŠ‚ã€‚</li>
</ul>
<h3 data-id="heading-2"><strong>ä¸‰ã€ä¸ºä»€ä¹ˆé€‰æ‹©å®ƒï¼Ÿ</strong></h3>
<ol>
<li><strong>æè‡´çš„ç©ºé—´æ•ˆç‡</strong>ï¼šç¼–ç åçš„æ•°æ®ä½“ç§¯é€šå¸¸åªæœ‰JSONçš„Â <strong>1/3ç”šè‡³æ›´å°</strong>ï¼Œè¿™å¯¹äºæŒ‰å­—èŠ‚è®¡è´¹çš„NB-IoTã€LoRaç­‰ä½å¸¦å®½ç½‘ç»œè‡³å…³é‡è¦ï¼Œèƒ½ç›´æ¥<strong>é™ä½åŠŸè€—ã€å»¶é•¿ç”µæ± å¯¿å‘½</strong>ã€‚</li>
<li><strong>ç¡®å®šæ€§çš„å†…å­˜ä½¿ç”¨</strong>ï¼šé»˜è®¤æ¨¡å¼ä¸‹ï¼Œ<strong>ä¸ä½¿ç”¨ä»»ä½•åŠ¨æ€å†…å­˜åˆ†é…ï¼ˆmallocï¼‰</strong> ã€‚æ‰€æœ‰å†…å­˜ï¼ˆå¦‚æ•°ç»„Â <code>samples[20]</code>ï¼‰éƒ½åœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼Œé¿å…äº†å†…å­˜ç¢ç‰‡å’Œæ³„æ¼ï¼Œè¿™å¯¹åµŒå…¥å¼ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§æ˜¯ç”Ÿå‘½çº¿ã€‚</li>
<li><strong>æ— æ­§ä¹‰çš„åè®®å¥‘çº¦</strong>ï¼š<code>.proto</code>Â æ–‡ä»¶æ˜¯è®¾å¤‡ç«¯å’ŒæœåŠ¡å™¨/æ‰‹æœºç«¯<strong>å”¯ä¸€ã€æƒå¨çš„åè®®æ–‡æ¡£</strong>ã€‚åŒæ–¹åŸºäºåŒä¸€ä»½æ–‡ä»¶ç”Ÿæˆä»£ç ï¼Œå½»åº•æ¶ˆé™¤äº†å› æ‰‹å†™æ–‡æ¡£ä¸ä¸€è‡´å¯¼è‡´çš„é€šä¿¡æ•…éšœã€‚</li>
<li><strong>å¼ºå¤§çš„å‘å‰/å‘åå…¼å®¹æ€§</strong>ï¼šåªè¦éµå¾ªâ€œæ–°å¢å­—æ®µç”¨optional/repeatedï¼Œæ°¸ä¸é‡ç”¨å­—æ®µå·â€çš„è§„åˆ™ï¼Œæ–°ç‰ˆæœ¬çš„ç¨‹åºå¯ä»¥è¯»å–æ—§ç‰ˆæœ¬çš„æ•°æ®ï¼ˆå¿½ç•¥æ–°å­—æ®µï¼‰ï¼Œæ—§ç‰ˆæœ¬çš„ç¨‹åºä¹Ÿèƒ½è¯»å–æ–°ç‰ˆæœ¬çš„æ•°æ®ï¼ˆå¿½ç•¥ä¸è®¤è¯†çš„å­—æ®µï¼‰ï¼Œä¸ºå›ºä»¶å‡çº§å¸¦æ¥å·¨å¤§ä¾¿åˆ©ã€‚</li>
</ol>
<h3 data-id="heading-3"><strong>å››ã€å®ƒçš„å¤©ç”Ÿâ€œçŸ­æ¿â€</strong></h3>
<p>æ²¡æœ‰ä»»ä½•æŠ€æœ¯æ˜¯é“¶å¼¹ï¼ŒNanoPbçš„å¼ºå¤§ä¼´éšç€æ˜ç¡®çš„ä»£ä»·å’Œçº¦æŸï¼š</p>
<ul>
<li>
<p><strong>å¢åŠ æ„å»ºå¤æ‚åº¦</strong>ï¼šå¿…é¡»åœ¨PCä¸Šé…ç½®å·¥å…·é“¾ï¼ˆ<code>protoc</code>ç¼–è¯‘å™¨ï¼‰ï¼Œå¹¶é›†æˆä»£ç ç”Ÿæˆæ­¥éª¤åˆ°é¡¹ç›®çš„æ„å»ºç³»ç»Ÿï¼ˆå¦‚Makefile, CMakeï¼‰ä¸­ã€‚è¿™å¢åŠ äº†åˆå§‹çš„å­¦ä¹ å’Œæ­å»ºæˆæœ¬ã€‚</p>
</li>
<li>
<p><strong>éœ€è¦é¢„è§„åˆ’å†…å­˜</strong>ï¼šæ‰€æœ‰æ•°ç»„ï¼ˆ<code>repeated</code>å­—æ®µï¼‰çš„é•¿åº¦<strong>æœ€å¥½åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šä¸Šé™</strong>ï¼ˆé€šè¿‡Â <code>max_count</code>ï¼‰ã€‚å¤„ç†é•¿åº¦å®Œå…¨æœªçŸ¥çš„åŠ¨æ€æ•°æ®ä¼šå˜å¾—å¤æ‚ï¼ˆéœ€ç”¨å›è°ƒå‡½æ•°ï¼Œå¯èƒ½å¼•å…¥åŠ¨æ€åˆ†é…ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä¸è´Ÿè´£â€œè¿è¾“â€</strong> ï¼šNanoPbåªè´Ÿè´£æŠŠâ€œè´§ç‰©â€ï¼ˆæ•°æ®ï¼‰æ‰“åŒ…æˆâ€œé›†è£…ç®±â€ï¼ˆäºŒè¿›åˆ¶æµï¼‰ï¼Œ<strong>ä¸è´Ÿè´£</strong>é›†è£…ç®±çš„â€œè£…èˆ¹â€ï¼ˆæ·»åŠ å¸§å¤´å¸§å°¾ï¼‰ã€â€œè¿è¾“ä¿éšœâ€ï¼ˆCRCæ ¡éªŒã€é‡ä¼ ï¼‰å’Œâ€œå¸è´§â€ï¼ˆä»æµä¸­åˆ†å‰²å‡ºå®Œæ•´æ•°æ®åŒ…ï¼‰ã€‚è¿™äº›é€šä¿¡å±‚çš„èŒè´£ï¼Œå¿…é¡»ç”±å¼€å‘è€…é¢å¤–å®Œæˆã€‚</p>
</li>
<li>
<p><strong>äºŒè¿›åˆ¶ä¸ç›´è§‚</strong>ï¼šç¼–ç åçš„æ•°æ®äººç±»æ— æ³•ç›´æ¥é˜…è¯»ï¼Œè°ƒè¯•æ—¶å¿…é¡»å€ŸåŠ©é¢å¤–çš„åå…­è¿›åˆ¶æŸ¥çœ‹å·¥å…·æˆ–è§£ç ç¨‹åºã€‚</p>
</li>
<li>
<p><strong>ä¸¥è°¨çš„è·¨å¹³å°ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li><strong>æµ®ç‚¹æ•°é™·é˜±</strong>ï¼šç›´æ¥å†…å­˜æ‹·è´ç¼–ç ï¼Œè¦æ±‚é€šä¿¡åŒæ–¹çš„CPUä½¿ç”¨<strong>ç›¸åŒçš„æµ®ç‚¹æ•°æ ¼å¼ï¼ˆé€šå¸¸æ˜¯IEEE 754ï¼‰å’Œå­—èŠ‚åº</strong>ï¼Œå¦åˆ™ä¼šè§£ç å‡ºé”™è¯¯æ•°å€¼ã€‚</li>
<li><strong>é»˜è®¤å€¼é™·é˜±</strong>ï¼šè§£ç æ—¶ï¼Œå¦‚æœå‘é€æ–¹æ²¡ç»™æŸä¸ªÂ <code>optional</code>Â å­—æ®µèµ‹å€¼ï¼Œæ¥æ”¶æ–¹ç»“æ„ä½“é‡Œè¯¥å­—æ®µçš„å€¼æ˜¯<strong>æœªåˆå§‹åŒ–çš„å†…å­˜æ®‹ç•™</strong>ï¼å¿…é¡»é€šè¿‡é…å¥—ç”Ÿæˆçš„Â <code>has_xxx</code>Â å¸ƒå°”æ ‡å¿—æ¥åˆ¤æ–­è¯¥å­—æ®µæ˜¯å¦æœ‰æ•ˆã€‚</li>
<li><strong>å†…å­˜å¯¹é½é™·é˜±</strong>ï¼šç»å¯¹ä¸èƒ½æŠŠCç»“æ„ä½“ç›´æ¥Â <code>memcpy</code>Â å‘é€ï¼ç»“æ„ä½“ä¸­æœ‰å†…å­˜å¯¹é½çš„â€œå¡«å……å­—èŠ‚â€ï¼Œè€ŒÂ <code>pb_encode</code>Â ç”Ÿæˆçš„äºŒè¿›åˆ¶æµæ˜¯ç´§å¯†æ— å¡«å……çš„ã€‚ç›´æ¥æ‹·è´ç»“æ„ä½“ä¼šå¯¼è‡´é€šä¿¡å¤±è´¥ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4"><strong>äº”ã€å…¸å‹åº”ç”¨åœºæ™¯</strong></h3>
<p>NanoPbçš„ä»·å€¼åœ¨ä»¥ä¸‹åœºæ™¯ä¸­æœ€ä¸ºå‡¸æ˜¾ï¼š</p>
<ol>
<li><strong>ç”µæ± ä¾›ç”µçš„ç‰©è”ç½‘ä¼ æ„Ÿç»ˆç«¯</strong>ï¼šä¾‹å¦‚ï¼Œæ¯5åˆ†é’Ÿé€šè¿‡NB-IoTä¸ŠæŠ¥ä¸€æ¬¡æ•°æ®çš„æ¸©æ¹¿åº¦è®¡ã€‚å°†æ•°æ®åŒ…ä»JSONçš„50å­—èŠ‚å‹ç¼©è‡³15å­—èŠ‚ï¼Œèƒ½æ˜¾è‘—å‡å°‘æ— çº¿æ¨¡å—å‘å°„æ—¶é•¿ï¼Œæ˜¯<strong>æå‡è®¾å¤‡ç»­èˆªï¼ˆæœ‰æ—¶å¯è¾¾æ•°å€ï¼‰çš„å…³é”®æ‰‹æ®µ</strong>ã€‚</li>
<li><strong>åµŒå…¥å¼è®¾å¤‡é—´çš„å¯é é€šä¿¡</strong>ï¼šåœ¨é€šè¿‡UARTã€CANæˆ–I2Cè¿æ¥çš„ä¸»æ§æ¿ä¸å¤šä¸ªåŠŸèƒ½æ¨¡å—ä¹‹é—´ï¼Œä½¿ç”¨NanoPbå®šä¹‰æ¸…æ™°ã€å¯æ‰©å±•çš„æŒ‡ä»¤ä¸æ•°æ®åè®®ï¼Œæ¯”è„†å¼±çš„è‡ªå®šä¹‰æ ¼å¼æ›´å¥å£®ï¼Œä¸”æ˜“äºè¿­ä»£ã€‚</li>
<li><strong>å›ºä»¶æ— çº¿å‡çº§</strong>ï¼šç”¨äºä¼ è¾“å‡çº§åŒ…çš„â€œå…ƒæ•°æ®â€ï¼ˆå¦‚ç‰ˆæœ¬å·ã€å¤§å°ã€CRCã€åˆ†åŒºåœ°å€ï¼‰ã€‚å…¶ç´§å‡‘æ€§å’Œç‰ˆæœ¬å…¼å®¹æ€§ï¼Œéå¸¸é€‚åˆåœ¨å¸¦å®½æœ‰é™ä¸”è¦æ±‚å¯é çš„OTAè¿‡ç¨‹ä¸­ä½œä¸ºæ§åˆ¶åè®®ã€‚</li>
<li><strong>è®¾å¤‡é…ç½®å‚æ•°å­˜å‚¨</strong>ï¼šå°†è®¾å¤‡çš„æ•°ç™¾ä¸ªå¯è°ƒå‚æ•°å®šä¹‰ä¸ºä¸€ä¸ªÂ <code>message</code>ï¼Œå­˜å‚¨åˆ°Flashä¸­ã€‚å‡çº§å›ºä»¶åï¼Œæ—§å‚æ•°æ–‡ä»¶ä»èƒ½è¢«å®‰å…¨è¯»å–ï¼ˆæ–°åŠ çš„å‚æ•°å–é»˜è®¤å€¼ï¼‰ï¼Œå®ç°é…ç½®çš„å¹³æ»‘è¿ç§»ã€‚</li>
</ol>
<h3 data-id="heading-5"><strong>å…­ã€æ€»ç»“</strong></h3>
<p>æ€»è€Œè¨€ä¹‹ï¼ŒåµŒå…¥å¼NanoPbæ˜¯ä¸€ä¸ªå…¸å‹çš„Â  <strong>â€œä»¥å·¥å…·é“¾å’Œè®¾è®¡æ—¶çš„å¤æ‚æ€§ï¼Œæ¢å–è¿è¡Œæ—¶æè‡´æ•ˆç‡å’Œé•¿æœŸå¯ç»´æŠ¤æ€§â€</strong> Â çš„å·¥ç¨‹è§£å†³æ–¹æ¡ˆã€‚</p>
<ul>
<li>
<p><strong>ä½•æ—¶åº”è¯¥ç§¯æé‡‡ç”¨ï¼Ÿ</strong></p>
<ul>
<li>ä½ çš„è®¾å¤‡<strong>å¯¹é€šä¿¡å¸¦å®½ã€åŠŸè€—æœ‰ä¸¥è‹›é™åˆ¶</strong>ã€‚</li>
<li>ä½ çš„æ•°æ®åè®®<strong>ç»“æ„å¤æ‚ä¸”æœªæ¥å¾ˆå¯èƒ½éœ€è¦å¢å‡å­—æ®µ</strong>ã€‚</li>
<li>ä½ çš„é¡¹ç›®æ¶‰åŠ<strong>å¤šå¹³å°ï¼ˆè®¾å¤‡ã€æ‰‹æœºã€äº‘ï¼‰æ•°æ®äº¤æ¢</strong>ï¼Œéœ€è¦ä¸€ä»½æ— æ­§ä¹‰çš„åè®®æ ¸å¿ƒã€‚</li>
<li>ä½ çš„å›¢é˜Ÿæœ‰èƒ½åŠ›<strong>æ­å»ºå¹¶ç»´æŠ¤åŒ…å«ä»£ç ç”Ÿæˆçš„è‡ªåŠ¨åŒ–æ„å»ºæµç¨‹</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä½•æ—¶åº”è¯¥è°¨æ…æˆ–é¿å…ï¼Ÿ</strong></p>
<ul>
<li>ä½ çš„æ•°æ®<strong>æå…¶ç®€å•ä¸”æ°¸ä¸å˜æ›´</strong>ï¼ˆä¾‹å¦‚æ°¸è¿œåªå‘ä¸¤ä¸ªæ•´æ•°ï¼‰ï¼Œç›´æ¥æ‰“åŒ…å‘é€æ›´ç®€å•ã€‚</li>
<li>ä½ çš„è®¾å¤‡<strong>RAM/ROMèµ„æºç´§å¼ åˆ°æ— æ³•å®¹çº³é¢å¤–çš„5-10KBä»£ç ä½“ç§¯</strong>ã€‚</li>
<li>ä½ çš„é¡¹ç›®<strong>å¼€å‘å‘¨æœŸæçŸ­ï¼Œä¸”æ²¡æœ‰åç»­ç»´æŠ¤éœ€æ±‚</strong>ï¼Œå¿«é€Ÿå®ç°æ˜¯ç¬¬ä¸€è¦åŠ¡ã€‚</li>
</ul>
</li>
</ul>
<p>å¯¹äºå¤§å¤šæ•°ä¸¥è‚ƒçš„ã€æœ‰é•¿æœŸç»´æŠ¤é¢„æœŸçš„åµŒå…¥å¼äº§å“æˆ–ç‰©è”ç½‘é¡¹ç›®ï¼ŒNanoPbå¸¦æ¥çš„åè®®ä¸¥è°¨æ€§ã€å¸¦å®½èŠ‚çœå’Œå…¼å®¹æ€§ä¿éšœï¼Œå…¶é•¿è¿œæ”¶ç›Šè¿œè¶…è¿‡åˆæœŸå¼•å…¥çš„å­¦ä¹ å’Œæ„å»ºæˆæœ¬ã€‚å®ƒæ˜¯å°†åµŒå…¥å¼é€šä¿¡ä»â€œæ‰‹å·¥ä½œåŠâ€å‡çº§åˆ°â€œç°ä»£å·¥ç¨‹â€çš„é‡è¦å·¥å…·ä¹‹ä¸€ã€‚</p>
<p>ä»¥ä¸Šæ˜¯ä¸ªäººçš„ä¸€äº›æµ…è§ï¼Œå¦‚æœ‰ä¸å½“ä¹‹å¤„ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ã€‚</p>
<p>è¿™æ³¢å†…å®¹çœŸå¸®åˆ°ä½ äº†ï¼Ÿç‚¹ä¸ªå…³æ³¨ä¸è¿·è·¯ï¼ä¸“å±å·¥å…·ç®±æŒç»­æ›´æ–°ï¼Œéœ€è¦æ—¶ç›´æ¥ç¿»ã€æ‹¿èµ·æ¥å°±ç”¨ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ•°æ®-207 å¦‚ä½•åº”å¯¹å¤šé‡å…±çº¿æ€§ï¼šä½¿ç”¨çº¿æ€§å›å½’ä¸­çš„æœ€å°äºŒä¹˜æ³•æ—¶å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7592876744526446642</link>    <guid>https://juejin.cn/post/7592876744526446642</guid>    <pubDate>2026-01-09T01:55:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592876744526446642" data-draft-id="7592876744526430258" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ•°æ®-207 å¦‚ä½•åº”å¯¹å¤šé‡å…±çº¿æ€§ï¼šä½¿ç”¨çº¿æ€§å›å½’ä¸­çš„æœ€å°äºŒä¹˜æ³•æ—¶å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,æœºå™¨å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-09T01:55:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­¦å­åº·"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ•°æ®-207 å¦‚ä½•åº”å¯¹å¤šé‡å…±çº¿æ€§ï¼šä½¿ç”¨çº¿æ€§å›å½’ä¸­çš„æœ€å°äºŒä¹˜æ³•æ—¶å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­¦å­åº·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:55:52.000Z" title="Fri Jan 09 2026 01:55:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<p>åœ¨ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ±‚è§£çº¿æ€§å›å½’æ—¶ï¼Œå¤šé‡å…±çº¿æ€§ä¼šå½±å“æ¨¡å‹ç¨³å®šæ€§ï¼Œå¯¼è‡´ç³»æ•°ä¼°è®¡ä¸å¯é ã€‚è§£å†³æ–¹æ³•åŒ…æ‹¬ä½¿ç”¨æ­£åˆ™åŒ–æŠ€æœ¯ï¼ˆå¦‚å²­å›å½’ã€Lassoå›å½’ï¼‰ã€‚é€šè¿‡å¼•å…¥æ­£åˆ™åŒ–é¡¹ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…çŸ©é˜µä¸å¯é€†é—®é¢˜ï¼Œç¨³å®šå›å½’ç»“æœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee1b2ef0a4ef4abba0a1f6cb88163ff6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=ZPkSpHRESzIihnHu5QTU82ZJMus%3D" alt="å¤§æ•°æ®-207 å¦‚ä½•åº”å¯¹å¤šé‡å…±çº¿æ€§ï¼šä½¿ç”¨çº¿æ€§å›å½’ä¸­çš„æœ€å°äºŒä¹˜æ³•æ—¶å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" loading="lazy"/></p>
<h2 data-id="heading-1">ç‰ˆæœ¬çŸ©é˜µ</h2>






























<table><thead><tr><th>åŠŸèƒ½</th><th>scikit-learn ç‰ˆæœ¬</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>çº¿æ€§å›å½’</td><td>0.24+</td><td>æ”¯æŒæ ‡å‡†çš„çº¿æ€§å›å½’æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°</td></tr><tr><td>å¤šé‡å…±çº¿æ€§å¤„ç†</td><td>0.24+</td><td>é€šè¿‡å²­å›å½’ã€Lassoå›å½’ç­‰æ–¹æ³•è§£å†³å…±çº¿æ€§é—®é¢˜</td></tr><tr><td>MSEè®¡ç®—</td><td>0.24+</td><td>ä½¿ç”¨ mean_squared_error è®¡ç®—æ¨¡å‹è¯¯å·®</td></tr><tr><td>RÂ²è®¡ç®—</td><td>0.24+</td><td>ä½¿ç”¨ r2_score è¯„ä¼°æ¨¡å‹æ‹Ÿåˆåº¦</td></tr></tbody></table>
<h2 data-id="heading-2">ä»£ç å®ç°</h2>
<p>ä½¿ç”¨ scikit-learn ç®—æ³•åº“å®ç°çº¿æ€§å›å½’ç®—æ³•ï¼Œå¹¶è®¡ç®—ç›¸åº”è¯„ä»·æŒ‡æ ‡ã€‚å›é¡¾å‰æ–‡ä»‹ç»çš„ç›¸å…³çŸ¥è¯†è¿›è¡Œä¸‹è¿°è®¡ç®—ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression
reg = LinearRegression()
reg.fit(data.iloc[:,:-<span class="hljs-number">1</span>].values,data.iloc[:,-<span class="hljs-number">1</span>].values)
reg.coef_ <span class="hljs-comment"># æŸ¥çœ‹æ–¹ç¨‹ç³»æ•°</span>
reg.intercept_ <span class="hljs-comment"># æŸ¥çœ‹ç³»æ•°</span>
</code></pre>
<p>å¯¹æ¯”æ‰‹åŠ¨è®¡ç®—çš„ wsï¼Œå…¶ç»“æœé«˜åº¦ä¸€è‡´ã€‚
ç„¶åè®¡ç®—æ¨¡å‹ MSE å’Œåˆ¤åˆ«ç³»æ•°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error,r2_score
yhat = reg.predict(data.iloc[:,:-<span class="hljs-number">1</span>])
mean_squared_error(y,yhat)
r2_score(y,yhat)
</code></pre>
<h2 data-id="heading-3">å¤šé‡å…±çº¿æ€§</h2>
<p>è™½ç„¶åœ¨çº¿æ€§å›å½’æ±‚è§£è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡å€ŸåŠ©æœ€å°äºŒä¹˜æ³•èƒ½å¤Ÿè¿…é€Ÿæ‰¾åˆ°å…¨åŸŸæœ€ä¼˜è§£ï¼Œä½†æœ€å°äºŒä¹˜æ³•æœ¬èº«çš„ä½¿ç”¨æ¡ä»¶è¾ƒä¸ºè‹›åˆ»ã€‚è¿™ç§æ–¹æ³•è¦æ±‚è®¾è®¡çŸ©é˜µXå¿…é¡»æ»¡è¶³ä¸¥æ ¼çš„æ¡ä»¶æ‰èƒ½ä¿è¯è§£çš„ç¨³å®šæ€§å’Œå”¯ä¸€æ€§ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œæœ€å°äºŒä¹˜æ³•çš„åº”ç”¨å¿…é¡»æ»¡è¶³ä»¥ä¸‹å…³é”®æ¡ä»¶ï¼š</p>
<ol>
<li>çŸ©é˜µX^TXå¿…é¡»æ˜¯æ»¡ç§©çŸ©é˜µï¼ˆå³è¡Œåˆ—å¼ä¸ä¸ºé›¶ï¼‰</li>
<li>çŸ©é˜µX^TXå¿…é¡»å¯é€†æˆ–å­˜åœ¨å¹¿ä¹‰é€†çŸ©é˜µ</li>
</ol>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°ä»¥ä¸‹å¯¼è‡´æœ€å°äºŒä¹˜æ³•å¤±æ•ˆçš„æƒ…å†µï¼š</p>
<ul>
<li>å½“æ ·æœ¬é‡nå°äºç‰¹å¾æ•°pæ—¶ï¼ˆn&lt;pï¼‰ï¼ŒçŸ©é˜µX^TXå¿…ç„¶æ˜¯å¥‡å¼‚çŸ©é˜µ</li>
<li>å½“Xçš„å„åˆ—å­˜åœ¨ä¸¥æ ¼æˆ–è¿‘ä¼¼çš„çº¿æ€§ç›¸å…³å…³ç³»æ—¶ï¼ˆå³å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼‰</li>
<li>å½“æ•°æ®ä¸­å­˜åœ¨é«˜åº¦ç›¸å…³çš„ç‰¹å¾å˜é‡æ—¶</li>
</ul>
<p>ç‰¹åˆ«æ˜¯å½“é‡åˆ°å¤šé‡å…±çº¿æ€§é—®é¢˜æ—¶ï¼Œæœ€å°äºŒä¹˜æ³•çš„æ±‚è§£ä¼šé¢ä¸´ä»¥ä¸‹æŒ‘æˆ˜ï¼š</p>
<ol>
<li>å‚æ•°ä¼°è®¡å€¼å˜å¾—æä¸ç¨³å®šï¼Œå°çš„æ•°æ®æ‰°åŠ¨å¯èƒ½å¯¼è‡´ä¼°è®¡å€¼å‘ç”Ÿå·¨å¤§å˜åŒ–</li>
<li>å‚æ•°ä¼°è®¡çš„æ–¹å·®ä¼šå¼‚å¸¸å¢å¤§</li>
<li>è§£å¯èƒ½ä¸å”¯ä¸€ï¼Œå­˜åœ¨æ— ç©·å¤šè§£çš„æƒ…å†µ</li>
</ol>
<p>ä¾‹å¦‚ï¼Œåœ¨ç»æµå­¦æ•°æ®åˆ†æä¸­ï¼Œå½“ä½¿ç”¨GDPã€å±…æ°‘æ”¶å…¥å’Œæ¶ˆè´¹æ”¯å‡ºç­‰å¤šä¸ªé«˜åº¦ç›¸å…³çš„æŒ‡æ ‡ä½œä¸ºé¢„æµ‹å˜é‡æ—¶ï¼Œå°±å¾ˆå®¹æ˜“å‡ºç°ä¸Šè¿°é—®é¢˜ã€‚æ­¤æ—¶ä¼ ç»Ÿçš„OLSï¼ˆæ™®é€šæœ€å°äºŒä¹˜ï¼‰ä¼°è®¡å°†æ— æ³•ç»™å‡ºå¯é çš„ç»“æœã€‚</p>
<p>é’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œç»Ÿè®¡å­¦å®¶ä»¬å‘å±•å‡ºäº†å¤šç§æ”¹è¿›æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å²­å›å½’ï¼ˆRidge Regressionï¼‰</li>
<li>Lassoå›å½’</li>
<li>ä¸»æˆåˆ†å›å½’ï¼ˆPCRï¼‰</li>
<li>åæœ€å°äºŒä¹˜å›å½’ï¼ˆPLSRï¼‰</li>
</ul>
<p>è¿™äº›æ–¹æ³•é€šè¿‡å¼•å…¥æ­£åˆ™åŒ–é¡¹æˆ–é™ç»´æŠ€æœ¯ï¼Œå¯ä»¥æœ‰æ•ˆå¤„ç†çŸ©é˜µä¸å¯é€†å’Œå¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Œä»è€Œè·å¾—æ›´ç¨³å®šå¯é çš„å›å½’ç»“æœã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„æ˜¯ï¼Œåœ¨è¿›è¡Œæ•°æ®é‡‡é›†çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®é›†å„åˆ—æ˜¯å¯¹åŒä¸€ä¸ªå®¢è§‚äº‹ç‰©è¿›è¡Œå®¢è§‚æè¿°ï¼Œå¾ˆéš¾é¿å…å¤šé‡å…±çº¿æ€§çš„å­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨å…±çº¿æ€§æ˜¯å¾ˆå¤šæ•°æ®é›†çš„ä¸€èˆ¬æƒ…å†µã€‚å½“ç„¶æ›´ä¸ºæç«¯çš„æƒ…å†µåˆ™æ˜¯æ•°æ®é›†çš„åˆ—æ¯”è¡Œå¤šï¼Œæ­¤æ—¶æœ€å°äºŒä¹˜æ³•æ— æ³•å¯¹å…¶è¿›è¡Œæ±‚è§£ã€‚å› æ­¤ï¼Œå¯»æ‰¾æ€§å›å½’ç®—æ³•çš„ä¼˜åŒ–æ–¹æ¡ˆåŠ¿åœ¨å¿…è¡Œã€‚
é¦–å…ˆæˆ‘ä»¬æ¥äº†è§£å¤šé‡å…±æ€§ï¼Œåœ¨ç¬¬äºŒèŠ‚ä¸­æˆ‘ä»¬æ›¾æ¨å¯¼äº†å¤šå…ƒçº¿æ€§å›å½’ä½¿ç”¨æœ€å°äºŒä¹˜æ³•çš„æ±‚è§£åŸç†ï¼Œæˆ‘ä»¬å¯¹å¤šå…ƒçº¿æ€§å›å½’çš„æŸå¤±å‡½æ•°æ±‚å¯¼ï¼Œå¹¶å¾—å‡ºæ±‚è§£ç³»æ•° w å¾—å¼å­å’Œè¿‡ç¨‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc86aef3df53474eb612606dfc0e6a34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=SMl37ydX6%2Bo8COTnipTzIXSOduI%3D" alt="å¤šé‡å…±çº¿æ€§" loading="lazy"/>
åœ¨æœ€åä¸€æ­¥ä¸­æˆ‘ä»¬éœ€è¦å·¦ä¹˜ XTX çš„é€†çŸ©é˜µï¼Œè€ŒçŸ©é˜µå­˜åœ¨å¾—å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ç‰¹å¾ä¸å­˜åœ¨å¤šé‡å…±çº¿æ€§ã€‚</p>
<h3 data-id="heading-4">çŸ©é˜µå­˜åœ¨çš„å……åˆ†å¿…è¦æ¡ä»¶</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£é€†çŸ©é˜µå­˜åœ¨ä¸å¦çš„æ„ä¹‰å’Œå½±å“ï¼Œä¸€ä¸ªçŸ©é˜µä»€ä¹ˆæƒ…å†µä¸‹ä¼šæœ‰é€†çŸ©é˜µï¼Ÿ
æ ¹æ®é€†çŸ©é˜µçš„å®šç†ï¼Œè‹¥ |A| != 0ï¼Œåˆ™çŸ©é˜µA å¯é€†ï¼Œä¸”ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25208597f65344f498bcfcf2cb9622ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=GJpmKDFqlEqQl7PPYOTZhO9HqOI%3D" alt="çŸ©é˜µå­˜åœ¨çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/></p>
<p>å…¶ä¸­ A* æ˜¯çŸ©é˜µ A çš„ä¼´éšçŸ©é˜µï¼Œä»»ä½•çŸ©é˜µéƒ½å¯ä»¥æœ‰ä¼´éšçŸ©é˜µï¼Œå› æ­¤è¿™ä¸€éƒ¨åˆ†ä¸å½±å“é€†çŸ©é˜µçš„å­˜åœ¨æ€§ï¼Œè€Œåˆ†æ¯ä¸Šè¡Œåˆ—å¼ï½œAï½œå°±ä¸åŒäº†ï¼Œä½äºåˆ†æ¯å˜é‡ä¸èƒ½ä¸º 0ï¼Œä¸€æ—¦ä¸º 0 åˆ™æ— æ³•è®¡ç®—å‡ºé€†çŸ©é˜µã€‚å› æ­¤é€†çŸ©é˜µå­˜åœ¨çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ï¼šçŸ©é˜µçš„è¡Œåˆ—å¼ä¸èƒ½ä¸º 0ï¼Œå¯¹äºçº¿æ€§å›å½’è€Œè¨€ï¼Œå³æ˜¯è¯´ï½œXTXï½œä¸èƒ½ä¸º 0ï¼Œè¿™æ˜¯ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ±‚è§£çº¿æ€§å›å½’çš„æ ¸å¿ƒæ¡ä»¶ä¹‹ä¸€ã€‚</p>
<h3 data-id="heading-5">è¡Œåˆ—å¼ä¸ä¸º 0 çš„å……åˆ†å¿…è¦æ¡ä»¶</h3>
<p>é‚£è¡Œåˆ—å¼ä¸ä¸º 0ï¼Œéœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Ÿåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¤ä¹ ä¸€ä¸‹çº¿æ€§ä»£æ•°ä¸­çš„åŸºæœ¬çŸ¥è¯†ï¼Œå‡è®¾æˆ‘ä»¬çš„ç‰¹å¾çŸ©é˜µ Xç»“æ„ä¸ºï¼ˆm,nï¼‰ï¼Œåˆ™ XTX å°±æ˜¯ç»“æ„ä¸ºï¼ˆn,mï¼‰çš„çŸ©é˜µï¼Œä»è€Œå¾—åˆ°ç»“æœä¸ºï¼ˆn,nï¼‰çš„çŸ©é˜µã€‚</p>
<p>å› æ­¤ä»¥ä¸‹æ‰€æœ‰çš„ä¾‹å­éƒ½å°†ä»¥æ–¹çŸ©é˜µè¿›è¡Œä¸¾ä¾‹ï¼Œæ–¹ä¾¿å¤§å®¶ç†è§£ï¼Œé¦–å…ˆåŒºåˆ«ä¸€ä¸‹çŸ©é˜µå’Œè¡Œåˆ—å¼ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e28d55cdc2514a7489125f3d1c48a2a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=wRYi81mHSN3JFtC8zoEy7hjmFec%3D" alt="è¡Œåˆ—å¼ä¸ä¸º 0 çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/></p>
<p>ä»»ä½•çŸ©é˜µéƒ½å¯ä»¥æœ‰è¡Œåˆ—å¼ï¼Œä»¥ä¸€ä¸ª 3*3 çš„è¡Œåˆ—å¼ä¸ºä¾‹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¡Œåˆ—å¼å¦‚ä½•è®¡ç®—çš„ï¼Ÿ
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e0e64a8b362400e95b5f73b1592c047~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=RPSC%2BScIG57Gyvn9UpapgDT10ag%3D" alt="è¡Œåˆ—å¼ä¸ä¸º 0 çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/>
è¿™ä¸ªå¼å­ä¹ä¸€çœ‹éå¸¸æ··ä¹±ï¼Œå…¶å®å¹¶éå¦‚æ­¤ï¼Œæˆ‘ä»¬æŠŠè¡Œåˆ—å¼æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼æ’åˆ—ä¸€ä¸‹ï¼Œå¾ˆå®¹æ˜“å°±çœ‹å‡ºè¿™ä¸ªå¼å­å®é™…ä¸Šæ€ä¹ˆå›äº‹äº†ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9ce5577193b45fbbb065490933059b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=%2FbnEDPfWez87EqxR1pzIyBY0EF4%3D" alt="è¡Œåˆ—å¼ä¸ä¸º 0 çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/>
ä¸‰ä¸ªç‰¹å¾çš„ç‰¹å¾çŸ©é˜µçš„è¡Œåˆ—å¼å°±æœ‰å…­ä¸ªäº¤äº’é¡¹ï¼Œåœ¨ç°å®ä¸­æˆ‘ä»¬ç‰¹å¾çŸ©é˜µä¸å¯èƒ½æ˜¯å¦‚æ­¤ä½ç»´åº¦æ•°æ®ï¼Œå› æ­¤ä½¿ç”¨è¿™æ ·çš„æ–¹å¼è®¡ç®—å°±å˜å¾—å¼‚å¸¸å›°éš¾ã€‚åœ¨çº¿æ€§ä»£æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¡Œåˆ—å¼çš„è®¡ç®—å°†ä¸€ä¸ªè¡Œåˆ—å¼æ•´åˆæˆä¸€ä¸ªæ¢¯å½¢çš„è¡Œåˆ—å¼ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a223788064a4f999911a234950d73eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=aEWgHitzeCsM5crDApe%2BkD%2FxLtQ%3D" alt="è¡Œåˆ—å¼ä¸ä¸º 0 çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/>
æ¢¯å½¢çš„è¡Œåˆ—å¼è¡¨ç°ä¸ºï¼Œæ‰€æœ‰çš„æ•°å­—éƒ½è¢«æ•´åˆåˆ°å¯¹è§’çº¿çš„ä¸Šæ–¹æˆ–ä¸‹æ–¹ï¼ˆé€šå¸¸æ˜¯ä¸Šæ–¹ï¼‰ï¼Œè™½ç„¶å…·ä½“çš„æ•°å­—å‘ç”Ÿäº†å˜åŒ–ï¼ˆæ¯”å¦‚ç”± x11 å˜æˆäº† a11ï¼‰ï¼Œä½†æ˜¯è¡Œåˆ—å¼çš„å¤§å°åœ¨åˆç­‰è¡Œå˜æ¢çš„è¿‡ç¨‹ä¸­æ˜¯ä¸å˜çš„ï¼Œå¯¹äºæ¢¯å½¢è¡Œåˆ—å¼ï¼Œè¡Œåˆ—å¼çš„è®¡ç®—è¦å®¹æ˜“çš„å¤šï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21dc357d85cf42e49024b3b9b9205ece~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=3F6tST6zsPG%2Fh9aPbVtuh82VZNg%3D" alt="è¡Œåˆ—å¼ä¸ä¸º 0 çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/>
ä¸éš¾å‘ç°ï¼Œç”±äºæ¢¯å½¢è¡Œåˆ—å¼ä¸‹åŠéƒ¨åˆ†ä¸º 0ï¼Œæ•´ä¸ªçŸ©é˜µçš„è¡Œåˆ—å¼å…¶å®å°±æ˜¯æ¢¯å½¢è¡Œåˆ—å¼å¯¹è§’çº¿ä¸Šçš„å…ƒç´ ç›¸ä¹˜ã€‚å¹¶ä¸”æ­¤æ—¶æ—¶åˆ»ï¼Œåªè¦å¯¹è§’çº¿ä¸Šçš„ä»»æ„å…ƒç´ ä¸º 0ï¼Œæ•´ä¸ªè¡Œåˆ—å¼éƒ½ä¼šä¸º 0ï¼Œé‚£åªè¦å¯¹è§’çº¿ä¸Šæ²¡æœ‰ä¸€ä¸ªå…ƒç´ ä¸º 0ï¼Œè¡Œåˆ—å¼å°±ä¸ä¼šä¸º 0ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬æ˜ å…¥ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼šæ»¡ç§©çŸ©é˜µã€‚</p>
<h3 data-id="heading-6">çŸ©é˜µæ»¡ç§©çš„å……åˆ†å¿…è¦æ¡ä»¶</h3>
<p>ä¸€ä¸ªçŸ©é˜µè¦æ»¡ç§©ï¼Œåˆ™è½¬æ¢ä¸ºæ¢¯å½¢çŸ©é˜µåçš„å¯¹è§’çº¿ä¸Šæ²¡æœ‰ 0ï¼Œé‚£ä»€ä¹ˆæ ·çš„çŸ©é˜µåœ¨å¯¹è§’çº¿ä¸Šæ²¡æœ‰ 0ï¼Ÿæ¥çœ‹ä¸‹é¢çš„ä¸‰ä¸ªçŸ©é˜µï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91cb6ac683874dcc9554f0e1feb1d122~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=otwxhffWqpi384Q9D8QZCqq5K1E%3D" alt="çŸ©é˜µæ»¡ç§©çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/>
æˆ‘ä»¬å¯ä»¥å¯¹çŸ©é˜µåšåˆç­‰è¡Œå˜æ¢å’Œåˆ—å˜æ¢ï¼ŒåŒ…æ‹¬äº¤æ¢è¡Œ/åˆ—é¡ºåºï¼Œå°†ä¸€åˆ—/ä¸€è¡Œä¹˜ä»¥ç”¨ä¸€ä¸ªå¸¸æ•°ååŠ å‡åˆ°å¦ä¸€ä¸ªä¸€åˆ—/ä¸€è¡Œä¸Šï¼Œæ¥å°†çŸ©é˜µåŒ–ä¸ºæ¢¯å½¢çŸ©é˜µï¼Œå¯¹äºä¸Šé¢çš„ä¸¤ä¸ªçŸ©é˜µæˆ‘ä»¬å¯ä»¥æœ‰å¦‚ä¸‹å˜æ¢ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/624037b7aabc4805b52f1d072f4ecb07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=LNc8ehvaXnWD%2Bmmw9aL9iogEtyk%3D" alt="çŸ©é˜µæ»¡ç§©çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/>
ç»§ç»­è¿›è¡Œå˜æ¢ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f44774174a74c5d95132cc8bffe88ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=uwRuRSKdEu27aacjnThz0CDycp0%3D" alt="çŸ©é˜µæ»¡ç§©çš„å……åˆ†å¿…è¦æ¡ä»¶" loading="lazy"/>
å¦‚æ­¤å°±è½¬æ¢æˆäº†æ¢¯å½¢çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒçŸ©é˜µ A æ˜æ˜¾ä¸æ˜¯æ»¡ç§©çš„ï¼Œå®ƒæœ‰å…¨é›¶è¡Œæ‰€ä»¥è¡Œåˆ—å¼ä¼šä¸º 0ï¼Œè€ŒçŸ©é˜µ B å’Œ C æ²¡æœ‰å…¨é›¶è¡Œæ‰€ä»¥æ»¡ç§©ã€‚
è€ŒçŸ©é˜µ A å’ŒçŸ©é˜µ B çš„åŒºåˆ«åœ¨äºï¼ŒA ä¸­å­˜åœ¨å®Œå…¨å…·æœ‰çº¿æ€§å…³ç³»çš„ä¸¤è¡Œï¼ˆ1,1,2 å’Œ 2,2,4ï¼‰ï¼Œè€Œ B å’Œ C ä¸­åˆ™æ²¡æœ‰è¿™æ ·çš„ä¸¤è¡Œã€‚
è€ŒçŸ©é˜µ B è™½ç„¶å¯¹è§’çº¿ä¸Šæ¯ä¸ªå…ƒç´ éƒ½ä¸ä¸º 0ï¼Œä½†å…·æœ‰éå¸¸æ¥è¿‘äº 0 çš„å…ƒç´  0.02ï¼Œè€ŒçŸ©é˜µ C çš„å¯¹è§’çº¿ä¸Šæ²¡æœ‰ä»»ä½•å…ƒç´ ç‰¹åˆ«æ¥è¿‘äº 0ã€‚</p>
<p>çŸ©é˜µ A ä¸­ç¬¬ä¸€è¡Œå’Œç¬¬ä¸‰è¡Œçš„å…³ç³»ï¼Œè¢«ç§°ä¸ºï¼šç²¾ç¡®ç›¸å…³å…³ç³»ï¼Œå³å®Œå…¨ç›¸å…³ï¼Œä¸€è¡Œå¯ä½¿å¦ä¸€è¡Œä¸º 0ï¼Œåœ¨è¿™ç§ç²¾ç¡®ç›¸å…³å…³ç³»ä¸‹ï¼ŒçŸ©é˜µ A çš„è¡Œåˆ—å¼ä¸º 0ï¼Œåˆ™çŸ©é˜µ A çš„é€†ä¸å¯èƒ½å­˜åœ¨ã€‚åœ¨æˆ‘ä»¬çš„æœ€å°äºŒä¹˜æ³•ä¸­ï¼Œå¦‚æœçŸ©é˜µ XTX ä¸­å­˜åœ¨è¿™ç§ç²¾ç¡®ç›¸å…³å…³ç³»ï¼Œåˆ™é€†ä¸å­˜åœ¨ï¼Œæœ€å°äºŒä¹˜æ³•å®Œå…¨æ— æ³•ä½¿ç”¨ï¼Œçº¿æ€§å›å½’ä¼šæ— æ³•æ±‚å‡ºç»“æœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e55a47b76baa4a31ac6327f7e8771f3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=HG%2BHGDUSsINN7V%2F17h9piEZtN6Q%3D" alt="çŸ©é˜µ A" loading="lazy"/>
çŸ©é˜µ B ä¸­ç¬¬ä¸€è¡Œå’Œç¬¬ä¸‰è¡Œçš„å…³ç³»ä¸å¤ªä¸€æ ·ï¼Œä»–ä»¬ä¹‹é—´éå¸¸æ¥è¿‘äºç²¾ç¡®ç›¸å…³å…³ç³»ï¼Œä½†åˆä¸æ˜¯å®Œå…¨ç›¸å…³ï¼Œä¸€è¡Œä¸èƒ½ä½¿é¢†ä¸€è¡Œä¸º 0ï¼Œè¿™ç§å…³ç³»è¢«ç§°ä¸º é«˜åº¦ç›¸å…³å…³ç³»ã€‚è¿™ç§é«˜åº¦ç›¸å…³å…³ç³»ä¸‹ï¼ŒçŸ©é˜µçš„è¡Œåˆ—å¼ä¸ä¸º 0ï¼Œä½†æ˜¯ä¸€ä¸ªéå¸¸æ¥è¿‘ 0 æ•°ï¼ŒçŸ©é˜µ A çš„é€†å­˜åœ¨ï¼Œä¸è¿‡æ¥è¿‘äºæ— é™å¤§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å°äºŒä¹˜æ³•å¯ä»¥ä½¿ç”¨ï¼Œä¸è¿‡å¾—åˆ°çš„é€†ä¼šå¾ˆå¤§ï¼Œç›´æ¥å½±å“æˆ‘ä»¬å¯¹å‚æ•°å‘é‡ w çš„æ±‚è§£ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64d0c658b5e846f0b938a3586e54bff6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=J6p7rBBnbGZrFTI9l%2BJPWyD292o%3D" alt="çŸ©é˜µ B" loading="lazy"/>
è¿™æ ·æ±‚è§£å‡ºæ¥çš„å‚æ•°å‘é‡ w ä¼šå¾ˆå¤§ï¼Œå› æ­¤ä¼šå½±å“å»ºæ¨¡çš„ç»“æœï¼Œé€ æˆæ¨¡å‹æœ‰åå·®æˆ–è€…ä¸å¯ç”¨ã€‚ç²¾ç¡®ç›¸å…³å…³ç³»å’Œé«˜åº¦ç›¸å…³å…³ç³»å¹¶ç§°ä¸ºå¤šé‡å…±çº¿æ€§ã€‚åœ¨å¤šé‡å…±çº¿æ€§ä¸‹ï¼Œæ¨¡å‹æ— æ³•å»ºç«‹ï¼Œæˆ–è€…æ¨¡å‹ä¸å¯ç”¨ã€‚
ç›¸å¯¹çš„ï¼ŒçŸ©é˜µ C çš„è¡Œä¹‹é—´ç»“æœç›¸äº’ç‹¬ç«‹ï¼Œæ¢¯å½¢çŸ©é˜µçœ‹èµ·æ¥éå¸¸æ­£å¸¸ï¼Œå®ƒçš„å¯¹è§’çº¿ä¸Šæ²¡æœ‰ä»»ä½•å…ƒç´ ç‰¹åˆ«æ¥è¿‘äº 0ï¼Œå› æ­¤å…¶è¡Œåˆ—å¼ä¹Ÿå°±ä¸ä¼šæ¥è¿‘0 æˆ–è€…ä¸º 0ï¼Œå› æ­¤çŸ©é˜µ C å¾—å‡ºçš„å‚æ•°å‘é‡ w å°±ä¸ä¼šæœ‰å¤ªå¤§çš„åå·®ï¼Œå¯¹äºæˆ‘ä»¬æ‹Ÿåˆè€Œè¨€æ˜¯æ¯”è¾ƒç†æƒ³çš„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f6e97ce1c96496497c37f1da74465aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=uwvSzX6mWYVBrzztfbcmSYErr%2B8%3D" alt="å‚æ•°å‘é‡" loading="lazy"/>
ä»ä¸Šé¢çš„æ‰€æœ‰è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥çœ‹å¾—å‡ºæ¥ï¼Œä¸€ä¸ªçŸ©é˜µå¦‚æœè¦æ»¡ç§©ï¼Œåˆ™è¦æ±‚çŸ©é˜µä¸­æ¯ä¸ªå‘é‡ä¹‹é—´ä¸èƒ½å­˜åœ¨å¤šé‡å…±çº¿æ€§ï¼Œè¿™ä¹Ÿæ„æˆäº†çº¿æ€§å›å½’ç®—æ³•å¯¹äºç‰¹å¾çŸ©é˜µçš„è¦æ±‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fa915b8edf14ff68ab4c06637657047~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528552&amp;x-signature=f2k%2FMcr7gEFcpH4%2FA4IgPV%2BNrWU%3D" alt="å‚æ•°å‘é‡" loading="lazy"/></p>
<h2 data-id="heading-7">é”™è¯¯é€ŸæŸ¥</h2>



































<table><thead><tr><th>ç—‡çŠ¶</th><th>æ ¹å› </th><th>å®šä½</th><th>ä¿®å¤</th></tr></thead><tbody><tr><td>æ¨¡å‹å‚æ•°ä¼°è®¡ä¸ç¨³å®š</td><td>æ•°æ®ä¸­å­˜åœ¨å¤šé‡å…±çº¿æ€§ï¼Œå¯¼è‡´è®¾è®¡çŸ©é˜µ X^T X ä¸å¯é€†</td><td>æ£€æŸ¥ç‰¹å¾å˜é‡ä¹‹é—´æ˜¯å¦å­˜åœ¨çº¿æ€§ç›¸å…³å…³ç³»</td><td>ä½¿ç”¨å²­å›å½’ã€Lassoå›å½’ç­‰æ­£åˆ™åŒ–æ–¹æ³•æ¥ç¨³å®šè§£</td></tr><tr><td>æ¨¡å‹æ–¹å·®è¿‡å¤§</td><td>çŸ©é˜µ X^T X è¿‘ä¼¼å¥‡å¼‚æˆ–å…±çº¿æ€§é—®é¢˜</td><td>æŸ¥çœ‹çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œç¡®è®¤æ˜¯å¦æ¥è¿‘é›¶</td><td>å¼•å…¥æ­£åˆ™åŒ–é¡¹ï¼Œå¦‚å²­å›å½’ï¼Œæ¥å‡å°‘å‚æ•°æ–¹å·®</td></tr><tr><td>é¢„æµ‹ç»“æœè¯¯å·®è¾ƒå¤§</td><td>å¤šé‡å…±çº¿æ€§å¯¼è‡´è§£çš„ä¸å”¯ä¸€æ€§</td><td>ç¡®è®¤ç‰¹å¾å˜é‡æ˜¯å¦é«˜åº¦ç›¸å…³ï¼Œå°¤å…¶æ˜¯è¾“å…¥æ•°æ®é›†</td><td>ä½¿ç”¨ä¸»æˆåˆ†å›å½’ï¼ˆPCRï¼‰æˆ–åæœ€å°äºŒä¹˜å›å½’ï¼ˆPLSRï¼‰</td></tr><tr><td>è§£ä¸å”¯ä¸€</td><td>çŸ©é˜µ X^T X ä¸ºå¥‡å¼‚çŸ©é˜µï¼Œæ— æ³•æ±‚é€†</td><td>æ£€æŸ¥è¾“å…¥æ•°æ®é›†çš„ç‰¹å¾æ•°æ˜¯å¦å¤§äºæ ·æœ¬æ•°ï¼ˆn&lt;pï¼‰</td><td>å‡å°‘ç‰¹å¾æ•°ï¼Œæˆ–ä½¿ç”¨æ­£åˆ™åŒ–æ–¹æ³•æ¥è§„é¿è¯¥é—®é¢˜</td></tr></tbody></table>
<h2 data-id="heading-8">å…¶ä»–ç³»åˆ—</h2>
<h3 data-id="heading-9">ğŸš€ AIç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>AIç‚¼ä¸¹æ—¥å¿—-29 - å­—èŠ‚è·³åŠ¨ DeerFlow æ·±åº¦ç ”ç©¶æ¡†<em>æ–œä½“æ ·å¼</em>æ¶ ç§æœ‰éƒ¨ç½² æµ‹è¯•ä¸Šæ‰‹ æ¶æ„ç ”ç©¶</strong>ï¼ŒæŒç»­æ‰“é€ å®ç”¨AIå·¥å…·æŒ‡å—ï¼
<strong>AIç ”ç©¶-132 Java ç”Ÿæ€å‰æ²¿ 2025ï¼šSpringã€Quarkusã€GraalVMã€CRaC ä¸äº‘åŸç”Ÿè½åœ°</strong></p>
<h3 data-id="heading-10">ğŸ’» Javaç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>Java-218 RocketMQ Java API å®æˆ˜ï¼šåŒæ­¥/å¼‚æ­¥ Producer ä¸ Pull/Push Consumer</strong>
MyBatis å·²å®Œç»“ï¼ŒSpring å·²å®Œç»“ï¼ŒNginxå·²å®Œç»“ï¼ŒTomcatå·²å®Œç»“ï¼Œåˆ†å¸ƒå¼æœåŠ¡å·²å®Œç»“ï¼ŒDubboå·²å®Œç»“ï¼ŒMySQLå·²å®Œç»“ï¼ŒMongoDBå·²å®Œç»“ï¼ŒNeo4jå·²å®Œç»“ï¼ŒFastDFS å·²å®Œç»“ï¼ŒOSSå·²å®Œç»“ï¼ŒGuavaCacheå·²å®Œç»“ï¼ŒEVCacheå·²å®Œç»“ï¼ŒRabbitMQå·²å®Œç»“ï¼ŒRocketMQæ­£åœ¨æ›´æ–°... æ·±å…¥æµ…å‡ºåŠ©ä½ æ‰“ç‰¢åŸºç¡€ï¼</p>
<h3 data-id="heading-11">ğŸ“Š å¤§æ•°æ®æ¿å—å·²å®Œæˆå¤šé¡¹å¹²è´§æ›´æ–°ï¼ˆ300ç¯‡ï¼‰ï¼š</h3>
<p>åŒ…æ‹¬ Hadoopã€Hiveã€Kafkaã€Flinkã€ClickHouseã€Elasticsearch ç­‰äºŒåä½™é¡¹æ ¸å¿ƒç»„ä»¶ï¼Œè¦†ç›–ç¦»çº¿+å®æ—¶æ•°ä»“å…¨æ ˆï¼
<strong>å¤§æ•°æ®-278 Spark MLib - åŸºç¡€ä»‹ç» æœºå™¨å­¦ä¹ ç®—æ³• æ¢¯åº¦æå‡æ ‘ GBDTæ¡ˆä¾‹ è¯¦è§£</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ¥è§£å†³å‰ç«¯ â€œå¤ç°éš¾â€ï¼šrrweb å½•åˆ¶å›æ”¾ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸‹ï¼‰]]></title>    <link>https://juejin.cn/post/7592815497848930367</link>    <guid>https://juejin.cn/post/7592815497848930367</guid>    <pubDate>2026-01-09T01:56:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592815497848930367" data-draft-id="7592508079306670099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ¥è§£å†³å‰ç«¯ â€œå¤ç°éš¾â€ï¼šrrweb å½•åˆ¶å›æ”¾ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸‹ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,å¼€æº,å…¨æ ˆ"/> <meta itemprop="datePublished" content="2026-01-09T01:56:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç§‹å¤©çš„ä¸€é˜µé£"/> <meta itemprop="url" content="https://juejin.cn/user/3588413946594925"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ¥è§£å†³å‰ç«¯ â€œå¤ç°éš¾â€ï¼šrrweb å½•åˆ¶å›æ”¾ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3588413946594925/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç§‹å¤©çš„ä¸€é˜µé£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:56:33.000Z" title="Fri Jan 09 2026 01:56:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong/></p><p align="center"><strong>Hello~å¤§å®¶å¥½ã€‚æˆ‘æ˜¯ç§‹å¤©çš„ä¸€é˜µé£</strong></p><p/>
<p>rrweb çš„æ ¸å¿ƒé­…åŠ›åœ¨äº â€œç”¨æå°çš„æ•°æ®é‡å¤ç°å®Œæ•´çš„é¡µé¢æ“ä½œâ€ï¼Œè¿™èƒŒåæ˜¯ DOM å¿«ç…§ã€å¢é‡æ›´æ–°ã€äº‹ä»¶åºåˆ—åŒ–ç­‰æŠ€æœ¯çš„ç²¾å¯†åä½œã€‚æœ¬æ–‡å°†ä»åŸç†æœ¬è´¨å‡ºå‘ï¼Œç”¨é€šä¿—ç±»æ¯” + æºç è§£æçš„æ–¹å¼ï¼Œæ‹†è§£æ¯ä¸ªæŠ€æœ¯æ¨¡å—çš„å®ç°é€»è¾‘ï¼ŒåŒæ—¶æ­ç¤º rrweb åœ¨å…¼å®¹æ€§ã€æ€§èƒ½ä¼˜åŒ–ä¸Šçš„å…³é”®è®¾è®¡ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ DOM å¿«ç…§ç”ŸæˆåŸç†ï¼ˆsnapshotï¼‰</h2>
<p><strong>é€šä¿—ç±»æ¯”</strong>ï¼šDOM å¿«ç…§å°±åƒç»™é¡µé¢æ‹ â€œå…¨æ™¯å·¥ç¨‹å›¾â€â€”â€” ä¸æ˜¯ç®€å•è®°å½•åƒç´ ï¼ˆå¦‚æˆªå›¾ï¼‰ï¼Œè€Œæ˜¯æŠŠé¡µé¢çš„ â€œéª¨æ¶â€ï¼ˆDOM å±‚çº§ç»“æ„ï¼‰ã€â€œçš®è‚¤â€ï¼ˆCSS æ ·å¼ï¼‰ã€â€œé›¶ä»¶å‚æ•°â€ï¼ˆå…ƒç´ å±æ€§ã€æ–‡æœ¬å†…å®¹ï¼‰éƒ½è½¬åŒ–ä¸ºç»“æ„åŒ–æ•°æ®ï¼Œåç»­èƒ½æ ¹æ®è¿™å¼  â€œå·¥ç¨‹å›¾â€ 1:1 è¿˜åŸå‡ºä¸åŸé¡µé¢ä¸€è‡´çš„åˆå§‹çŠ¶æ€ã€‚åŒºåˆ«äºæ™®é€šç…§ç‰‡ï¼Œè¿™å¼  â€œå·¥ç¨‹å›¾â€ åŒ…å«æ‰€æœ‰å¯ç¼–è¾‘çš„ â€œé›¶ä»¶ä¿¡æ¯â€ï¼Œè€Œéå›ºå®šçš„è§†è§‰å›¾åƒã€‚</p>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒç›®æ ‡ä¸æŠ€æœ¯è·¯å¾„</h3>
<p>DOM å¿«ç…§çš„æ ¸å¿ƒç›®æ ‡æ˜¯ç”Ÿæˆ â€œå¯åºåˆ—åŒ–ã€å¯é‡å»ºã€ä½“ç§¯å°â€ çš„ DOM æ•°æ®ï¼ŒæŠ€æœ¯è·¯å¾„åˆ†ä¸ºä¸‰æ­¥ï¼š<strong>DOM éå†ä¸èŠ‚ç‚¹è¿‡æ»¤</strong>â†’<strong>èŠ‚ç‚¹å±æ€§ä¸æ ·å¼åºåˆ—åŒ–</strong>â†’<strong>èµ„æºå¼•ç”¨å¤„ç†</strong>ï¼Œæœ€ç»ˆè¾“å‡º JSON æ ¼å¼çš„FullSnapshotäº‹ä»¶ï¼ˆrrweb äº‹ä»¶ç±»å‹æ ‡è¯†ä¸º 2ï¼‰ã€‚</p>
<h3 data-id="heading-2">1.2 å…³é”®å®ç°é€»è¾‘ï¼ˆå‚è€ƒ rrweb-snapshot æºç ï¼‰</h3>
<p><code>rrweb-snapshot</code> åº“çš„ <code>takeSnapshot</code> å‡½æ•°æ˜¯å¿«ç…§ç”Ÿæˆçš„æ ¸å¿ƒï¼Œå…³é”®æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-3">1.2.1 æ ¹èŠ‚ç‚¹éå†ä¸è¿‡æ»¤</h4>
<p>ä»<code>document.documentElement</code>ï¼ˆHTML æ ¹èŠ‚ç‚¹ï¼‰å¼€å§‹æ·±åº¦ä¼˜å…ˆéå†ï¼Œè·³è¿‡æ— éœ€å½•åˆ¶çš„èŠ‚ç‚¹ï¼ˆå¦‚scriptã€styleæ ‡ç­¾ï¼Œæˆ–å¸¦å±è”½ç±»åçš„å…ƒç´ ï¼‰ï¼Œé¿å…æ— æ•ˆæ•°æ®å ç”¨ç©ºé—´ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šDOMèŠ‚ç‚¹éå†é€»è¾‘</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, config</span>) {
  <span class="hljs-comment">// è¿‡æ»¤è§„åˆ™ï¼šè·³è¿‡è„šæœ¬ã€æ ·å¼ã€å±è”½å…ƒç´ ã€ä¸å¯è§å…ƒç´ </span>
  <span class="hljs-keyword">const</span> isIgnored = 
    node.<span class="hljs-property">tagName</span> === <span class="hljs-string">'SCRIPT'</span> || 
    node.<span class="hljs-property">tagName</span> === <span class="hljs-string">'STYLE'</span> || 
    node.<span class="hljs-property">classList</span>.<span class="hljs-title function_">contains</span>(config.<span class="hljs-property">blockClass</span>) || 
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(node).<span class="hljs-property">display</span> === <span class="hljs-string">'none'</span>;
  <span class="hljs-keyword">if</span> (isIgnored) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  <span class="hljs-comment">// åºåˆ—åŒ–å½“å‰èŠ‚ç‚¹</span>
  <span class="hljs-keyword">const</span> nodeSnapshot = <span class="hljs-title function_">serializeNode</span>(node);
  <span class="hljs-comment">// é€’å½’å¤„ç†å­èŠ‚ç‚¹ï¼ˆæ„å»ºDOMæ ‘ç»“æ„ï¼‰</span>
  <span class="hljs-keyword">const</span> children = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> child <span class="hljs-keyword">of</span> node.<span class="hljs-property">childNodes</span>) {
    <span class="hljs-keyword">const</span> childSnapshot = <span class="hljs-title function_">traverseNode</span>(child, config);
    <span class="hljs-keyword">if</span> (childSnapshot) children.<span class="hljs-title function_">push</span>(childSnapshot);
  }
  nodeSnapshot.<span class="hljs-property">children</span> = children;
  <span class="hljs-comment">// å†…è”è®¡ç®—æ ·å¼ï¼ˆç¡®ä¿å›æ”¾æ ·å¼ä¸€è‡´ï¼‰</span>
  <span class="hljs-title function_">inlineComputedStyle</span>(node, nodeSnapshot);
  <span class="hljs-keyword">return</span> nodeSnapshot;
}
</code></pre>
<h4 data-id="heading-4">1.2.2 èŠ‚ç‚¹åºåˆ—åŒ–ï¼ˆserializeNodeï¼‰</h4>
<p>æå–èŠ‚ç‚¹å…³é”®å±æ€§ï¼Œè½¬åŒ–ä¸º JSON ç»“æ„ï¼Œé‡ç‚¹å¤„ç†å…ƒç´ èŠ‚ç‚¹ä¸æ–‡æœ¬èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šèŠ‚ç‚¹åºåˆ—åŒ–</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">serializeNode</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">const</span> snapshot = {
    <span class="hljs-attr">type</span>: node.<span class="hljs-property">nodeType</span>, <span class="hljs-comment">// 1=å…ƒç´ èŠ‚ç‚¹ï¼Œ3=æ–‡æœ¬èŠ‚ç‚¹ï¼Œ8=æ³¨é‡ŠèŠ‚ç‚¹ï¼ˆè·³è¿‡ï¼‰</span>
  };
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-number">1</span>) { <span class="hljs-comment">// å…ƒç´ èŠ‚ç‚¹</span>
    snapshot.<span class="hljs-property">tagName</span> = node.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toLowerCase</span>(); <span class="hljs-comment">// ç»Ÿä¸€å°å†™ï¼ˆå¦‚DIVâ†’divï¼‰</span>
    snapshot.<span class="hljs-property">attributes</span> = {};
    <span class="hljs-comment">// æ”¶é›†æ ¸å¿ƒå±æ€§ï¼ˆidã€classã€srcã€hrefç­‰ï¼Œè·³è¿‡è‡ªå®šä¹‰æ— å…³å±æ€§ï¼‰</span>
    <span class="hljs-keyword">const</span> coreAttrs = [<span class="hljs-string">'id'</span>, <span class="hljs-string">'class'</span>, <span class="hljs-string">'src'</span>, <span class="hljs-string">'href'</span>, <span class="hljs-string">'alt'</span>, <span class="hljs-string">'title'</span>, <span class="hljs-string">'value'</span>, <span class="hljs-string">'checked'</span>];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> attr <span class="hljs-keyword">of</span> node.<span class="hljs-property">attributes</span>) {
      <span class="hljs-keyword">if</span> (coreAttrs.<span class="hljs-title function_">includes</span>(attr.<span class="hljs-property">name</span>) || attr.<span class="hljs-property">name</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'data-'</span>)) {
        snapshot.<span class="hljs-property">attributes</span>[attr.<span class="hljs-property">name</span>] = attr.<span class="hljs-property">value</span>;
      }
    }
    <span class="hljs-comment">// ç‰¹æ®Šå¤„ç†è¡¨å•å…ƒç´ ï¼ˆè®°å½•å½“å‰å€¼ï¼Œè€Œéåˆå§‹å€¼ï¼‰</span>
    <span class="hljs-keyword">if</span> ([<span class="hljs-string">'INPUT'</span>, <span class="hljs-string">'TEXTAREA'</span>, <span class="hljs-string">'SELECT'</span>].<span class="hljs-title function_">includes</span>(node.<span class="hljs-property">tagName</span>)) {
      snapshot.<span class="hljs-property">value</span> = node.<span class="hljs-property">value</span>;
      snapshot.<span class="hljs-property">checked</span> = node.<span class="hljs-property">checked</span> || <span class="hljs-literal">false</span>;
      snapshot.<span class="hljs-property">selectedIndex</span> = node.<span class="hljs-property">tagName</span> === <span class="hljs-string">'SELECT'</span> ? node.<span class="hljs-property">selectedIndex</span> : -<span class="hljs-number">1</span>;
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-number">3</span>) { <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹</span>
    snapshot.<span class="hljs-property">text</span> = node.<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>() || <span class="hljs-string">''</span>; <span class="hljs-comment">// è¿‡æ»¤ç©ºæ–‡æœ¬ï¼Œå‡å°‘ä½“ç§¯</span>
  }
  <span class="hljs-keyword">return</span> snapshot;
}
</code></pre>
<h4 data-id="heading-5">1.2.3 æ ·å¼æ”¶é›†ä¸å†…è”</h4>
<p>é¡µé¢æ ·å¼å¯èƒ½æ¥è‡ªlinkã€styleæˆ–å†…è”styleï¼Œä¸ºé¿å…å›æ”¾æ—¶æ ·å¼ä¸¢å¤±ï¼Œrrweb ä¼šå°†<strong>è®¡ç®—æ ·å¼ï¼ˆcomputedStyleï¼‰</strong> å†…è”åˆ°èŠ‚ç‚¹å¿«ç…§ä¸­ï¼ŒåŒæ—¶è¿‡æ»¤é»˜è®¤æ ·å¼å‡å°‘æ•°æ®é‡ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šæ ·å¼å†…è”å¤„ç†</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">inlineComputedStyle</span>(<span class="hljs-params">node, snapshot</span>) {
  <span class="hljs-keyword">const</span> computedStyle = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(node);
  <span class="hljs-keyword">const</span> styles = {};
  <span class="hljs-comment">// ä»…æ”¶é›†å½±å“è§†è§‰çš„å…³é”®æ ·å¼å±æ€§ï¼ˆæ’é™¤é»˜è®¤å€¼ï¼‰</span>
  <span class="hljs-keyword">const</span> criticalStyles = [
    <span class="hljs-string">'display'</span>, <span class="hljs-string">'position'</span>, <span class="hljs-string">'top'</span>, <span class="hljs-string">'left'</span>, <span class="hljs-string">'width'</span>, <span class="hljs-string">'height'</span>, 
    <span class="hljs-string">'color'</span>, <span class="hljs-string">'background'</span>, <span class="hljs-string">'font-size'</span>, <span class="hljs-string">'border'</span>, <span class="hljs-string">'padding'</span>, <span class="hljs-string">'margin'</span>
  ];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> prop <span class="hljs-keyword">of</span> criticalStyles) {
    <span class="hljs-keyword">const</span> value = computedStyle.<span class="hljs-title function_">getPropertyValue</span>(prop);
    <span class="hljs-comment">// è¿‡æ»¤é»˜è®¤æ ·å¼ï¼ˆå¦‚divçš„display:blockã€bodyçš„margin:8pxï¼‰</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isDefaultStyle</span>(snapshot.<span class="hljs-property">tagName</span>, prop, value)) {
      styles[prop] = value;
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(styles).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    snapshot.<span class="hljs-property">styles</span> = styles; <span class="hljs-comment">// ä»…å½“æœ‰éé»˜è®¤æ ·å¼æ—¶æ‰æ·»åŠ ï¼Œå‡å°‘ä½“ç§¯</span>
  }
}
<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºæ ‡ç­¾é»˜è®¤æ ·å¼ï¼ˆåŸºäºrrwebå†…ç½®çš„é»˜è®¤æ ·å¼è¡¨ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isDefaultStyle</span>(<span class="hljs-params">tagName, prop, value</span>) {
  <span class="hljs-keyword">const</span> defaultStyles = {
    <span class="hljs-attr">div</span>: { <span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>, <span class="hljs-attr">margin</span>: <span class="hljs-string">'0'</span> },
    <span class="hljs-attr">body</span>: { <span class="hljs-attr">margin</span>: <span class="hljs-string">'8px'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(0, 0, 0)'</span> },
    <span class="hljs-attr">input</span>: { <span class="hljs-attr">border</span>: <span class="hljs-string">'1px solid rgb(169, 169, 169)'</span> }
    <span class="hljs-comment">// å…¶ä»–æ ‡ç­¾é»˜è®¤æ ·å¼...</span>
  };
  <span class="hljs-keyword">return</span> defaultStyles[tagName]?.[prop] === value;
}
</code></pre>
<h3 data-id="heading-6">1.3 æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li>
<p><strong>éš¾ç‚¹ 1ï¼šæ ·å¼ä½“ç§¯è¿‡å¤§ä¸æµè§ˆå™¨å…¼å®¹æ€§</strong></p>
<p>ç›´æ¥æ”¶é›†æ‰€æœ‰è®¡ç®—æ ·å¼ä¼šå¯¼è‡´æ•°æ®é‡æ¿€å¢ï¼ˆå•ä¸ªå…ƒç´ å¯èƒ½æœ‰ä¸Šç™¾ä¸ªæ ·å¼å±æ€§ï¼‰ï¼Œä¸”ä¸åŒæµè§ˆå™¨é»˜è®¤æ ·å¼å­˜åœ¨å·®å¼‚ï¼ˆå¦‚ Chrome ä¸ Safari çš„bodyé»˜è®¤marginä¸åŒï¼‰ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
â‘  ä»…æ”¶é›† â€œå½±å“è§†è§‰çš„å…³é”®æ ·å¼â€ï¼ˆå¦‚displayã€positionï¼‰ï¼Œè¿‡æ»¤æ— å…³æ ·å¼ï¼ˆå¦‚webkit-font-smoothingï¼‰ï¼›</p>
<p>â‘¡ ç»´æŠ¤ â€œæ ‡ç­¾é»˜è®¤æ ·å¼è¡¨â€ï¼Œä»…è®°å½•ä¸é»˜è®¤å€¼ä¸åŒçš„æ ·å¼ï¼Œæ•°æ®é‡å¯å‡å°‘ 60% ä»¥ä¸Šï¼›</p>
<p>â‘¢ å¯¹æµè§ˆå™¨ç§æœ‰å‰ç¼€æ ·å¼ï¼ˆå¦‚-webkit-border-radiusï¼‰è¿›è¡Œå…¼å®¹å¤„ç†ï¼Œç»Ÿä¸€è½¬åŒ–ä¸ºæ ‡å‡†æ ·å¼ã€‚</p>
</li>
<li>
<p><strong>éš¾ç‚¹ 2ï¼šè·¨åŸŸèµ„æºæ— æ³•åŠ è½½</strong></p>
<p>é¡µé¢ä¸­çš„è·¨åŸŸå›¾ç‰‡ï¼ˆå¦‚ CDN å›¾ç‰‡ï¼‰ã€å­—ä½“ç­‰èµ„æºï¼Œå›æ”¾æ—¶å¯èƒ½å›  CORS é™åˆ¶æ— æ³•åŠ è½½ï¼Œå¯¼è‡´æ ·å¼é”™ä¹±ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
</li>
<li>
<p>â‘  é…ç½®<code>inlineImages: true</code>æ—¶ï¼Œå°†å›¾ç‰‡è½¬åŒ–ä¸º Base64 ç¼–ç å†…è”åˆ°å¿«ç…§ä¸­ï¼ˆé€‚åˆå°å›¾ç‰‡ï¼‰ï¼›</p>
</li>
<li>
<p>â‘¡ å¯¹å¤§å›¾ç‰‡ï¼Œå›æ”¾æ—¶é€šè¿‡ â€œåŒæºä»£ç†æœåŠ¡â€ è½¬å‘è¯·æ±‚ï¼ˆå¦‚åç«¯éƒ¨ç½²ä»£ç†æ¥å£ï¼Œå°†è·¨åŸŸå›¾ç‰‡ URL è½¬ä¸ºåŒæº URLï¼‰ï¼›</p>
</li>
<li>
<p>â‘¢ è®°å½•èµ„æºåŠ è½½å¤±è´¥æ—¶çš„é™çº§æ ·å¼ï¼ˆå¦‚å›¾ç‰‡å ä½ç¬¦ï¼‰ï¼Œç¡®ä¿å›æ”¾ä½“éªŒä¸€è‡´ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">1.4 DOM å¿«ç…§ç”Ÿæˆæµç¨‹å›¾</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06c362ed5ffc430d93116711b56412e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56eL5aSp55qE5LiA6Zi16aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528593&amp;x-signature=Mi8sK5khRiJIu7UNyllRiks9Vlc%3D" alt="exported_image.png" width="70%" loading="lazy"/>
<h2 data-id="heading-8">äºŒã€å¢é‡æ›´æ–°æœºåˆ¶ï¼ˆMutationObserverï¼‰</h2>
<p><strong>é€šä¿—ç±»æ¯”</strong>ï¼šå¦‚æœè¯´ DOM å¿«ç…§æ˜¯ â€œåˆå§‹å·¥ç¨‹å›¾â€ï¼Œå¢é‡æ›´æ–°å°±æ˜¯ â€œå·¥ç¨‹å˜æ›´è®°å½•â€â€”â€” å°±åƒå»ºç­‘æ–½å·¥æ—¶ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½é‡æ–°ç»˜åˆ¶å®Œæ•´å›¾çº¸ï¼Œåªéœ€è®°å½• <strong>â€œåœ¨ 3 å±‚å¢åŠ  1 ä¸ªçª—æˆ·â€</strong> <strong>â€œä¿®æ”¹ 2 å±‚å¢™ä½“é¢œè‰²â€</strong> è¿™ç±»å˜åŒ–ã€‚</p>
<p>rrweb é€šè¿‡ç›‘å¬ DOM å˜åŒ–ï¼Œåªè®°å½•å¿«ç…§åçš„å¢é‡ä¿®æ”¹ï¼Œå¤§å¹…å‡å°‘å½•åˆ¶æ•°æ®é‡ã€‚</p>
<h3 data-id="heading-9">2.1 æ ¸å¿ƒæŠ€æœ¯ï¼šMutationObserver API</h3>
<p>rrweb çš„å¢é‡æ›´æ–°å®Œå…¨ä¾èµ–æµè§ˆå™¨åŸç”Ÿçš„MutationObserver APIï¼Œè¯¥ API å¯ç›‘å¬ DOM æ ‘çš„ <strong>â€œèŠ‚ç‚¹å˜åŒ–ã€å±æ€§å˜åŒ–ã€æ–‡æœ¬å˜åŒ–â€</strong> ï¼Œå¹¶<strong>å¼‚æ­¥æ‰¹é‡è§¦å‘å›è°ƒ</strong>ï¼ˆé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼‰ã€‚</p>
<p>å…¶æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li>â‘  ç²¾å‡†ç›‘å¬ï¼ˆå¯æŒ‡å®šç›‘å¬ç±»å‹ï¼‰ï¼›</li>
<li>â‘¡ æ‰¹é‡å¤„ç†ï¼ˆçŸ­æ—¶é—´å†…å¤šæ¬¡å˜åŒ–åˆå¹¶ä¸ºä¸€æ¬¡å›è°ƒï¼‰ï¼›</li>
<li>â‘¢ æ€§èƒ½å‹å¥½ï¼ˆå¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡ç”¨æˆ·äº¤äº’ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-10">2.2 ç›‘å¬é…ç½®ä¸äº‹ä»¶è½¬åŒ–</h3>
<p>rrweb åˆå§‹åŒ–æ—¶åˆ›å»º <code>MutationObserver</code>å®ä¾‹ï¼Œå°†åŸç”Ÿå˜åŒ–äº‹ä»¶è½¬åŒ–ä¸ºè‡ªå®šä¹‰çš„Mutationäº‹ä»¶ï¼ˆrrweb äº‹ä»¶ç±»å‹æ ‡è¯†ä¸º 3ï¼‰ï¼Œå…³é”®é€»è¾‘å¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-11">2.2.1 MutationObserver åˆå§‹åŒ–</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šrrwebä¸­MutationObserveré…ç½®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">initMutationObserver</span>(<span class="hljs-params">emit, config</span>) {
  <span class="hljs-comment">// å›è°ƒå‡½æ•°ï¼šæ‰¹é‡å¤„ç†DOMå˜åŒ–</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">observerCallback</span> = (<span class="hljs-params">mutations</span>) =&gt; {
    <span class="hljs-comment">// è¿‡æ»¤æ— éœ€è®°å½•çš„å¾®å°å˜åŒ–ï¼ˆå¦‚æ–‡æœ¬èŠ‚ç‚¹ç©ºå­—ç¬¦ä¿®æ”¹ï¼‰</span>
    <span class="hljs-keyword">const</span> validMutations = mutations.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-title function_">isMutationValid</span>(m, config));
    <span class="hljs-keyword">if</span> (validMutations.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-comment">// æ‰¹é‡è½¬åŒ–ä¸ºrrwebå¢é‡äº‹ä»¶å¹¶å‘é€</span>
    validMutations.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">mutation</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> incrementalEvent = <span class="hljs-title function_">transformMutation</span>(mutation);
      <span class="hljs-title function_">emit</span>(incrementalEvent); <span class="hljs-comment">// å‘é€åˆ°äº‹ä»¶é˜Ÿåˆ—ï¼Œåç»­å­˜å‚¨/ä¸Šä¼ </span>
    });
  };
  <span class="hljs-comment">// ç›‘å¬é…ç½®ï¼šè¦†ç›–æ‰€æœ‰å…³é”®å˜åŒ–ç±»å‹</span>
  <span class="hljs-keyword">const</span> observerConfig = {
    <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,          <span class="hljs-comment">// ç›‘å¬å­èŠ‚ç‚¹æ–°å¢/åˆ é™¤</span>
    <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,         <span class="hljs-comment">// ç›‘å¬å…ƒç´ å±æ€§å˜åŒ–</span>
    <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// ç›‘å¬æ–‡æœ¬èŠ‚ç‚¹å†…å®¹å˜åŒ–</span>
    <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>,            <span class="hljs-comment">// æ·±åº¦ç›‘å¬ï¼ˆå­æ ‘æ‰€æœ‰èŠ‚ç‚¹ï¼Œä¸ä»…æ˜¯ç›´æ¥å­èŠ‚ç‚¹ï¼‰</span>
    <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// è®°å½•å±æ€§å˜åŒ–å‰çš„æ—§å€¼ï¼ˆä¾¿äºå›æ”¾æ—¶è¿˜åŸï¼‰</span>
    <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// è®°å½•æ–‡æœ¬å˜åŒ–å‰çš„æ—§å€¼</span>
  };
  <span class="hljs-comment">// å¼€å§‹ç›‘å¬æ ¹èŠ‚ç‚¹</span>
  <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(observerCallback);
  observer.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>, observerConfig);
  <span class="hljs-keyword">return</span> observer; <span class="hljs-comment">// è¿”å›å®ä¾‹ï¼Œä¾¿äºåç»­åœæ­¢ç›‘å¬</span>
}
<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šè¿‡æ»¤æ— æ•ˆå˜åŒ–ï¼ˆå¦‚å±è”½å…ƒç´ å†…çš„å˜åŒ–ã€ç©ºæ–‡æœ¬ä¿®æ”¹ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isMutationValid</span>(<span class="hljs-params">mutation, config</span>) {
  <span class="hljs-comment">// å±è”½å…ƒç´ å†…çš„å˜åŒ–ä¸è®°å½•</span>
  <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">target</span>.<span class="hljs-title function_">closest</span>(<span class="hljs-string">`.<span class="hljs-subst">${config.blockClass}</span>`</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹ç©ºå­—ç¬¦ä¿®æ”¹ä¸è®°å½•ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ååˆ é™¤ä¸ºç©ºï¼‰</span>
  <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'characterData'</span>) {
    <span class="hljs-keyword">return</span> mutation.<span class="hljs-property">oldValue</span>.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">''</span> || mutation.<span class="hljs-property">target</span>.<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">''</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<h4 data-id="heading-12">2.2.2 åŸç”Ÿå˜åŒ–äº‹ä»¶è½¬åŒ–ï¼ˆtransformMutationï¼‰</h4>
<p>å°†æµè§ˆå™¨åŸç”Ÿçš„<code>MutationRecord</code>è½¬åŒ–ä¸º â€œå¯å›æ”¾çš„ç»“æ„åŒ–æ•°æ®â€ï¼Œæ ¸å¿ƒæ˜¯æ˜ç¡® â€œå˜åŒ–ç›®æ ‡ã€å˜åŒ–ç±»å‹ã€å˜åŒ–å†…å®¹â€ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šè½¬åŒ–åŸç”ŸMutationRecord</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformMutation</span>(<span class="hljs-params">mutation</span>) {
  <span class="hljs-keyword">const</span> event = {
    <span class="hljs-attr">type</span>: <span class="hljs-number">3</span>,                  <span class="hljs-comment">// Mutationäº‹ä»¶ç±»å‹æ ‡è¯†</span>
    <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),    <span class="hljs-comment">// äº‹ä»¶å‘ç”Ÿæ—¶é—´æˆ³ï¼ˆç”¨äºå›æ”¾æ’åºï¼‰</span>
    <span class="hljs-attr">data</span>: {}
  };
  <span class="hljs-comment">// 1. å­èŠ‚ç‚¹å˜åŒ–ï¼ˆæ–°å¢/åˆ é™¤èŠ‚ç‚¹ï¼‰</span>
  <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'childList'</span>) {
    event.<span class="hljs-property">data</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'childList'</span>;
    <span class="hljs-comment">// è®°å½•çˆ¶èŠ‚ç‚¹è·¯å¾„ï¼ˆä¾¿äºå›æ”¾æ—¶å®šä½ç›®æ ‡çˆ¶èŠ‚ç‚¹ï¼‰</span>
    event.<span class="hljs-property">data</span>.<span class="hljs-property">parentPath</span> = <span class="hljs-title function_">getNodeUniquePath</span>(mutation.<span class="hljs-property">target</span>);
    <span class="hljs-comment">// åºåˆ—åŒ–æ–°å¢/åˆ é™¤çš„èŠ‚ç‚¹ï¼ˆä»…æ ¸å¿ƒå±æ€§ï¼Œå‡å°‘ä½“ç§¯ï¼‰</span>
    event.<span class="hljs-property">data</span>.<span class="hljs-property">addedNodes</span> = mutation.<span class="hljs-property">addedNodes</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-title function_">serializeNode</span>(n)).<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
    event.<span class="hljs-property">data</span>.<span class="hljs-property">removedNodes</span> = mutation.<span class="hljs-property">removedNodes</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-title function_">serializeNode</span>(n)).<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
    <span class="hljs-comment">// è®°å½•æ’å…¥ä½ç½®å‚è€ƒèŠ‚ç‚¹ï¼ˆç¡®ä¿å›æ”¾æ—¶æ’å…¥é¡ºåºæ­£ç¡®ï¼‰</span>
    event.<span class="hljs-property">data</span>.<span class="hljs-property">nextSiblingId</span> = mutation.<span class="hljs-property">nextSibling</span> 
      ? <span class="hljs-title function_">getNodeUniqueId</span>(mutation.<span class="hljs-property">nextSibling</span>) 
      : <span class="hljs-literal">null</span>;
  }
  <span class="hljs-comment">// 2. å±æ€§å˜åŒ–ï¼ˆå¦‚classã€srcä¿®æ”¹ï¼‰</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'attributes'</span>) {
    event.<span class="hljs-property">data</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'attributes'</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">targetPath</span> = <span class="hljs-title function_">getNodeUniquePath</span>(mutation.<span class="hljs-property">target</span>);
    event.<span class="hljs-property">data</span>.<span class="hljs-property">attributeName</span> = mutation.<span class="hljs-property">attributeName</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">oldValue</span> = mutation.<span class="hljs-property">oldValue</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">newValue</span> = mutation.<span class="hljs-property">target</span>.<span class="hljs-title function_">getAttribute</span>(mutation.<span class="hljs-property">attributeName</span>);
  }
  <span class="hljs-comment">// 3. æ–‡æœ¬å˜åŒ–ï¼ˆå¦‚spanå†…æ–‡æœ¬ä¿®æ”¹ï¼‰</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'characterData'</span>) {
    event.<span class="hljs-property">data</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'characterData'</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">targetPath</span> = <span class="hljs-title function_">getNodeUniquePath</span>(mutation.<span class="hljs-property">target</span>);
    event.<span class="hljs-property">data</span>.<span class="hljs-property">oldValue</span> = mutation.<span class="hljs-property">oldValue</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">newValue</span> = mutation.<span class="hljs-property">target</span>.<span class="hljs-property">textContent</span>;
  }
  <span class="hljs-keyword">return</span> event;
}
<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šç”ŸæˆèŠ‚ç‚¹å”¯ä¸€è·¯å¾„ï¼ˆå¦‚"body&gt;div.container&gt;ul&gt;li:nth-child(2)"ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getNodeUniquePath</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">if</span> (node === <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'html'</span>;
  <span class="hljs-keyword">if</span> (node === <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'body'</span>;
  <span class="hljs-keyword">const</span> parentPath = <span class="hljs-title function_">getNodeUniquePath</span>(node.<span class="hljs-property">parentElement</span>);
  <span class="hljs-keyword">const</span> siblings = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(node.<span class="hljs-property">parentElement</span>.<span class="hljs-property">children</span>);
  <span class="hljs-comment">// ç”¨"æ ‡ç­¾å+ç´¢å¼•"ç¡®ä¿å”¯ä¸€æ€§ï¼ˆå¦‚li:nth-child(2)ï¼‰</span>
  <span class="hljs-keyword">const</span> index = siblings.<span class="hljs-title function_">indexOf</span>(node) + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">const</span> nodeName = node.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toLowerCase</span>();
  <span class="hljs-keyword">const</span> classAttr = node.<span class="hljs-property">classList</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> 
    ? <span class="hljs-string">`.<span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>(node.classList).join(<span class="hljs-string">'.'</span>)}</span>`</span> 
    : <span class="hljs-string">''</span>;
  <span class="hljs-keyword">const</span> idAttr = node.<span class="hljs-property">id</span> ? <span class="hljs-string">`#<span class="hljs-subst">${node.id}</span>`</span> : <span class="hljs-string">''</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${parentPath}</span>&gt;<span class="hljs-subst">${nodeName}</span><span class="hljs-subst">${idAttr}</span><span class="hljs-subst">${classAttr}</span>:nth-child(<span class="hljs-subst">${index}</span>)`</span>;
}
</code></pre>
<h3 data-id="heading-13">2.3 æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li>
<p><strong>éš¾ç‚¹ 1ï¼šèŠ‚ç‚¹è·¯å¾„å®šä½ä¸å‡†ç¡®</strong></p>
<p>å¢é‡å˜åŒ–éœ€è¦æ˜ç¡® â€œå“ªä¸ªèŠ‚ç‚¹å‘ç”Ÿäº†å˜åŒ–â€ï¼Œä½† DOM èŠ‚ç‚¹æ²¡æœ‰å¤©ç”Ÿçš„å”¯ä¸€æ ‡è¯†ï¼ŒåŠ¨æ€ç”Ÿæˆçš„èŠ‚ç‚¹ï¼ˆå¦‚ Vue åˆ—è¡¨æ¸²æŸ“çš„liï¼‰åœ¨åˆ·æ–°åè·¯å¾„å¯èƒ½å˜åŒ–ï¼Œå¯¼è‡´å›æ”¾æ—¶æ— æ³•å®šä½ç›®æ ‡èŠ‚ç‚¹ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>
<p>â‘  ç”Ÿæˆ â€œå”¯ä¸€è·¯å¾„â€ï¼ˆç»“åˆæ ‡ç­¾åã€IDã€ç±»åã€å…„å¼ŸèŠ‚ç‚¹ç´¢å¼•ï¼‰ï¼Œå¦‚body&gt;div.container&gt;ul&gt;li:nth-child(2)ï¼Œç¡®ä¿å³ä½¿èŠ‚ç‚¹åŠ¨æ€æ›´æ–°ï¼Œä»èƒ½é€šè¿‡è·¯å¾„æ‰¾åˆ°ï¼›</p>
</li>
<li>
<p>â‘¡ ç»´æŠ¤ â€œèŠ‚ç‚¹ ID æ˜ å°„è¡¨â€ï¼Œå½•åˆ¶æ—¶ä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…ä¸´æ—¶ IDï¼ˆå¦‚node.__rrwebIdï¼‰ï¼Œå›æ”¾æ—¶é€šè¿‡ ID å¿«é€Ÿå®šä½ï¼Œè·¯å¾„ä½œä¸ºé™çº§æ–¹æ¡ˆï¼ˆåº”å¯¹ ID ä¸¢å¤±åœºæ™¯ï¼‰ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>éš¾ç‚¹ 2ï¼šé«˜é¢‘å˜åŒ–å¯¼è‡´æ€§èƒ½å¡é¡¿</strong></p>
<p>é¡µé¢ä¸­çš„é«˜é¢‘ DOM å˜åŒ–ï¼ˆå¦‚å€’è®¡æ—¶ã€åŠ¨ç”»ã€æ»šåŠ¨åŠ è½½åˆ—è¡¨ï¼‰ä¼šè§¦å‘MutationObserveré¢‘ç¹å›è°ƒï¼ˆå¦‚æ¯ç§’å‡ åæ¬¡ï¼‰ï¼Œå¯¼è‡´å‰ç«¯ä¸»çº¿ç¨‹é˜»å¡ï¼Œå½±å“ç”¨æˆ·äº¤äº’ä½“éªŒã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>â‘  ç»“åˆ â€œé‡‡æ ·ç‡æ§åˆ¶â€ï¼Œå¯¹é«˜é¢‘å˜åŒ–äº‹ä»¶ï¼ˆå¦‚æ–‡æœ¬å€’è®¡æ—¶ï¼‰è¿›è¡ŒèŠ‚æµå¤„ç†ï¼ˆå¦‚ 100ms å†…ä»…è®°å½• 1 æ¬¡å˜åŒ–ï¼‰ï¼›</li>
<li>â‘¡ æ‰¹é‡åˆå¹¶çŸ­æ—¶é—´å†…çš„åŒç±»å˜åŒ–ï¼ˆå¦‚ 100ms å†…çš„å¤šæ¬¡æ–‡æœ¬ä¿®æ”¹åˆå¹¶ä¸º 1 æ¬¡ï¼‰ï¼›</li>
<li>â‘¢ è¿‡æ»¤ â€œæ— æ„ä¹‰å˜åŒ–â€ï¼ˆå¦‚å…ƒç´ scrollTopçš„å¾®å°æ³¢åŠ¨ã€ç©ºæ–‡æœ¬ä¿®æ”¹ï¼‰ï¼Œå‡å°‘äº‹ä»¶æ•°é‡ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-14">2.4 å¢é‡æ›´æ–°æµç¨‹ç¤ºæ„å›¾</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38213ded1a94417689424eaa9f67279f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56eL5aSp55qE5LiA6Zi16aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528593&amp;x-signature=qzF5MNVrmSzOBjSonF7tBbBHrlk%3D" alt="exported_image.png" width="70%" loading="lazy"/>
<h2 data-id="heading-15">ä¸‰ã€äº‹ä»¶æ•è·å’Œåºåˆ—åŒ–</h2>
<p><strong>é€šä¿—ç±»æ¯”</strong>ï¼šå¦‚æœè¯´ DOM å¿«ç…§æ˜¯ â€œåˆå§‹åœºæ™¯â€ï¼Œå¢é‡æ›´æ–°æ˜¯ â€œåœºæ™¯å˜åŒ–â€ï¼Œé‚£ä¹ˆäº‹ä»¶æ•è·å°±æ˜¯ â€œç”¨æˆ·åŠ¨ä½œå‰§æœ¬â€â€”â€” å°±åƒç”µå½±æ‹æ‘„æ—¶ï¼Œä¸ä»…è¦æ­å»ºåœºæ™¯ï¼Œè¿˜è¦è®°å½•æ¼”å‘˜çš„ â€œè‚¢ä½“åŠ¨ä½œâ€â€œå°è¯â€â€œè¡¨æƒ…â€ã€‚</p>
<p>rrweb éœ€è¦æ•è·ç”¨æˆ·çš„ç‚¹å‡»ã€è¾“å…¥ã€æ»šåŠ¨ç­‰äº¤äº’åŠ¨ä½œï¼Œå°†å…¶è½¬åŒ–ä¸ºç»“æ„åŒ–çš„ â€œå‰§æœ¬æ•°æ®â€ï¼Œç¡®ä¿å›æ”¾æ—¶èƒ½ç²¾å‡†è¿˜åŸç”¨æˆ·æ“ä½œè½¨è¿¹ã€‚</p>
<h3 data-id="heading-16">3.1 æ ¸å¿ƒäº‹ä»¶ç±»å‹ä¸æ•è·ç­–ç•¥</h3>
<p>rrweb ä¸»è¦æ•è· 6 ç±»é«˜é¢‘ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼Œè¦†ç›– 90% ä»¥ä¸Šçš„å‰ç«¯æ“ä½œåœºæ™¯ï¼Œé‡‡ç”¨ â€œå…¨å±€äº‹ä»¶å§”æ‰˜ + ç²¾å‡†è¿‡æ»¤â€ çš„æ•è·ç­–ç•¥ï¼Œé¿å…ç»™æ¯ä¸ªèŠ‚ç‚¹ç»‘å®šäº‹ä»¶å¯¼è‡´å†…å­˜æ³„æ¼ï¼š</p>















































<table><thead><tr><th>äº‹ä»¶ç±»å‹</th><th>æ ¸å¿ƒç”¨é€”</th><th>å…³é”®æ•°æ®å­—æ®µ</th><th>rrweb äº‹ä»¶ç±»å‹æ ‡è¯†</th></tr></thead><tbody><tr><td>é¼ æ ‡ç‚¹å‡»ï¼ˆclickï¼‰</td><td>è®°å½•æŒ‰é’®ã€é“¾æ¥ç­‰ç‚¹å‡»æ“ä½œ</td><td>ç‚¹å‡»åæ ‡ï¼ˆx/yï¼‰ã€ç›®æ ‡èŠ‚ç‚¹è·¯å¾„</td><td>4</td></tr><tr><td>é”®ç›˜è¾“å…¥ï¼ˆkeydownï¼‰</td><td>è®°å½•æ–‡æœ¬è¾“å…¥ã€åŠŸèƒ½é”®æ“ä½œ</td><td>æŒ‰é”®ç ï¼ˆkeyCodeï¼‰ã€è¾“å…¥å†…å®¹ã€ç›®æ ‡èŠ‚ç‚¹</td><td>5</td></tr><tr><td>é¼ æ ‡ç§»åŠ¨ï¼ˆmousemoveï¼‰</td><td>è®°å½•é¼ æ ‡ä½ç½®å˜åŒ–</td><td>é¼ æ ‡åæ ‡ï¼ˆx/yï¼‰ã€æ—¶é—´æˆ³</td><td>6</td></tr><tr><td>æ»šåŠ¨ï¼ˆscrollï¼‰</td><td>è®°å½•é¡µé¢ / å…ƒç´ æ»šåŠ¨ä½ç½®</td><td>æ»šåŠ¨ç›®æ ‡è·¯å¾„ã€scrollTop/scrollLeft</td><td>7</td></tr><tr><td>çª—å£ resize</td><td>è®°å½•çª—å£å°ºå¯¸å˜åŒ–</td><td>çª—å£å®½ï¼ˆwidthï¼‰ã€é«˜ï¼ˆheightï¼‰</td><td>8</td></tr><tr><td>è¡¨å•æäº¤ï¼ˆsubmitï¼‰</td><td>è®°å½•è¡¨å•æäº¤æ“ä½œ</td><td>è¡¨å•èŠ‚ç‚¹è·¯å¾„ã€æäº¤æ—¶é—´æˆ³</td><td>9</td></tr></tbody></table>
<h3 data-id="heading-17">3.2 å…³é”®å®ç°é€»è¾‘ï¼ˆå…¨å±€äº‹ä»¶å§”æ‰˜ï¼‰</h3>
<p>é€šè¿‡åœ¨documentä¸Šç»‘å®šäº‹ä»¶ç›‘å¬å™¨ï¼Œåˆ©ç”¨äº‹ä»¶å†’æ³¡æœºåˆ¶æ•è·æ‰€æœ‰å­èŠ‚ç‚¹çš„äº¤äº’ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šrrwebäº‹ä»¶æ•è·æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">initEventCapture</span>(<span class="hljs-params">emit, config</span>) {
  <span class="hljs-comment">// éœ€æ•è·çš„äº‹ä»¶ç±»å‹ä¸å¯¹åº”çš„å¤„ç†å‡½æ•°</span>
  <span class="hljs-keyword">const</span> eventHandlers = {
    <span class="hljs-attr">click</span>: handleClick,
    <span class="hljs-attr">keydown</span>: handleKeydown,
    <span class="hljs-attr">mousemove</span>: handleMousemove,
    <span class="hljs-attr">scroll</span>: handleScroll,
    <span class="hljs-attr">resize</span>: handleResize,
    <span class="hljs-attr">submit</span>: handleSubmit
  };
  <span class="hljs-comment">// ç»‘å®šå…¨å±€äº‹ä»¶å§”æ‰˜</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(eventHandlers).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[type, handler]</span>) =&gt;</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(type, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-comment">// è¿‡æ»¤è§„åˆ™ï¼š1. å±è”½å…ƒç´ å†…çš„äº‹ä»¶ 2. éç”¨æˆ·è§¦å‘çš„äº‹ä»¶ï¼ˆå¦‚è„šæœ¬è§¦å‘çš„clickï¼‰</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isIgnoredEvent</span>(e, config)) <span class="hljs-keyword">return</span>;
      <span class="hljs-comment">// å¤„ç†äº‹ä»¶å¹¶åºåˆ—åŒ–ä¸ºç»“æ„åŒ–æ•°æ®</span>
      <span class="hljs-keyword">const</span> eventData = <span class="hljs-title function_">handler</span>(e, config);
      <span class="hljs-comment">// å‘é€äº‹ä»¶ï¼ˆæºå¸¦æ—¶é—´æˆ³ï¼Œç¡®ä¿å›æ”¾é¡ºåºï¼‰</span>
      <span class="hljs-title function_">emit</span>({
        <span class="hljs-attr">type</span>: <span class="hljs-title function_">getRRwebEventType</span>(type), <span class="hljs-comment">// è½¬åŒ–ä¸ºrrwebäº‹ä»¶æ ‡è¯†</span>
        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
        <span class="hljs-attr">data</span>: eventData
      });
    }, {
      <span class="hljs-attr">passive</span>: type === <span class="hljs-string">'scroll'</span> || type === <span class="hljs-string">'resize'</span>, <span class="hljs-comment">// passiveä¼˜åŒ–ï¼šé¿å…æ»šåŠ¨é˜»å¡</span>
      <span class="hljs-attr">capture</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// å†’æ³¡é˜¶æ®µæ•è·ï¼Œç¡®ä¿èƒ½è·å–æœ€ç»ˆç›®æ ‡èŠ‚ç‚¹</span>
    });
  });
}
<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šè¿‡æ»¤æ— æ•ˆäº‹ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isIgnoredEvent</span>(<span class="hljs-params">e, config</span>) {
  <span class="hljs-comment">// 1. å±è”½å…ƒç´ å†…çš„äº‹ä»¶ï¼ˆå¦‚å¸¦.rr-blockç±»åçš„å…ƒç´ ï¼‰</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">target</span>.<span class="hljs-title function_">closest</span>(<span class="hljs-string">`.<span class="hljs-subst">${config.blockClass}</span>`</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// 2. æ’é™¤è„šæœ¬è§¦å‘çš„äº‹ä»¶ï¼ˆä»…ä¿ç•™ç”¨æˆ·æ‰‹åŠ¨è§¦å‘ï¼‰</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">isTrusted</span> === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// 3. æ’é™¤å³é”®ç‚¹å‡»ï¼ˆcontextmenuï¼‰å’Œæ»šè½®äº‹ä»¶ï¼ˆé»˜è®¤ä¸æ•è·ï¼‰</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">type</span> === <span class="hljs-string">'click'</span> &amp;&amp; e.<span class="hljs-property">button</span> === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h3 data-id="heading-18">3.3 å…¸å‹äº‹ä»¶åºåˆ—åŒ–å®ç°ï¼ˆä»¥é”®ç›˜è¾“å…¥å’Œæ»šåŠ¨ä¸ºä¾‹ï¼‰</h3>
<p>ä¸åŒäº‹ä»¶çš„åºåˆ—åŒ–é‡ç‚¹ä¸åŒï¼Œéœ€é’ˆå¯¹æ€§å¤„ç†æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å¯†ç ï¼‰å’Œå†—ä½™ä¿¡æ¯ï¼š</p>
<h4 data-id="heading-19">3.3.1 é”®ç›˜è¾“å…¥äº‹ä»¶ï¼ˆkeydownï¼‰åºåˆ—åŒ–</h4>
<p>éœ€åŒºåˆ† â€œæ™®é€šå­—ç¬¦è¾“å…¥â€ å’Œ â€œåŠŸèƒ½é”®â€ï¼ŒåŒæ—¶å¯¹å¯†ç ç­‰æ•æ„Ÿè¾“å…¥è¿›è¡Œæ©ç å¤„ç†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šé”®ç›˜è¾“å…¥äº‹ä»¶å¤„ç†</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleKeydown</span>(<span class="hljs-params">e, config</span>) {
  <span class="hljs-keyword">const</span> target = e.<span class="hljs-property">target</span>;
  <span class="hljs-comment">// éšç§å¤„ç†ï¼šå¯†ç è¾“å…¥æ¡†ä¸”å¼€å¯æ©ç ï¼Œä¸è®°å½•çœŸå®å†…å®¹</span>
  <span class="hljs-keyword">const</span> isPasswordInput = target.<span class="hljs-property">tagName</span> === <span class="hljs-string">'INPUT'</span> &amp;&amp; target.<span class="hljs-property">type</span> === <span class="hljs-string">'password'</span>;
  <span class="hljs-keyword">const</span> shouldMask = isPasswordInput &amp;&amp; config.<span class="hljs-property">maskInputPassword</span>;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">targetPath</span>: <span class="hljs-title function_">getNodeUniquePath</span>(target), <span class="hljs-comment">// ç›®æ ‡è¾“å…¥æ¡†è·¯å¾„</span>
    <span class="hljs-attr">key</span>: shouldMask ? <span class="hljs-string">'*'</span> : e.<span class="hljs-property">key</span>, <span class="hljs-comment">// æ•æ„Ÿè¾“å…¥æ›¿æ¢ä¸º*</span>
    <span class="hljs-attr">keyCode</span>: e.<span class="hljs-property">keyCode</span>, <span class="hljs-comment">// æŒ‰é”®ç ï¼ˆå›æ”¾æ—¶æ¨¡æ‹Ÿè¾“å…¥éœ€ç”¨åˆ°ï¼‰</span>
    <span class="hljs-attr">value</span>: shouldMask ? <span class="hljs-string">'*'</span> : target.<span class="hljs-property">value</span>, <span class="hljs-comment">// è¾“å…¥æ¡†å½“å‰å€¼ï¼ˆéæ•æ„Ÿåœºæ™¯ï¼‰</span>
    <span class="hljs-attr">isFunctionalKey</span>: [<span class="hljs-string">'Enter'</span>, <span class="hljs-string">'Backspace'</span>, <span class="hljs-string">'Tab'</span>].<span class="hljs-title function_">includes</span>(e.<span class="hljs-property">key</span>) <span class="hljs-comment">// æ˜¯å¦ä¸ºåŠŸèƒ½é”®</span>
  };
}
</code></pre>
<h4 data-id="heading-20">3.3.2 æ»šåŠ¨äº‹ä»¶ï¼ˆscrollï¼‰åºåˆ—åŒ–</h4>
<p>éœ€åŒºåˆ† â€œé¡µé¢æ»šåŠ¨â€ å’Œ â€œå…ƒç´ æ»šåŠ¨â€ï¼Œé¿å…é‡å¤è®°å½•é«˜é¢‘æ»šåŠ¨äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šæ»šåŠ¨äº‹ä»¶å¤„ç†ï¼ˆå«èŠ‚æµä¼˜åŒ–ï¼‰</span>
<span class="hljs-keyword">let</span> lastScrollTime = <span class="hljs-number">0</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleScroll</span>(<span class="hljs-params">e, config</span>) {
  <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  <span class="hljs-comment">// èŠ‚æµä¼˜åŒ–ï¼š50mså†…ä»…è®°å½•1æ¬¡ï¼Œå‡å°‘é«˜é¢‘æ»šåŠ¨å¯¼è‡´çš„æ•°æ®é‡</span>
  <span class="hljs-keyword">if</span> (now - lastScrollTime &lt; <span class="hljs-number">50</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  lastScrollTime = now;
  <span class="hljs-comment">// åŒºåˆ†é¡µé¢æ»šåŠ¨å’Œå…ƒç´ æ»šåŠ¨</span>
  <span class="hljs-keyword">const</span> target = e.<span class="hljs-property">target</span> === <span class="hljs-variable language_">document</span> ? <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span> : e.<span class="hljs-property">target</span>;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">targetPath</span>: <span class="hljs-title function_">getNodeUniquePath</span>(target),
    <span class="hljs-attr">scrollTop</span>: target.<span class="hljs-property">scrollTop</span>,
    <span class="hljs-attr">scrollLeft</span>: target.<span class="hljs-property">scrollLeft</span>,
    <span class="hljs-attr">isPageScroll</span>: e.<span class="hljs-property">target</span> === <span class="hljs-variable language_">document</span> <span class="hljs-comment">// æ˜¯å¦ä¸ºé¡µé¢æ»šåŠ¨</span>
  };
}
</code></pre>
<h3 data-id="heading-21">3.4 æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li>
<p><strong>éš¾ç‚¹ 1ï¼šäº‹ä»¶é¡ºåºé”™ä¹±</strong></p>
<p>ä¸åŒäº‹ä»¶çš„è§¦å‘å­˜åœ¨æ—¶é—´å·®ï¼ˆå¦‚ â€œç‚¹å‡»æŒ‰é’®â†’è¾“å…¥æ–‡æœ¬â†’æäº¤è¡¨å•â€ï¼‰ï¼Œè‹¥å½•åˆ¶æ—¶äº‹ä»¶é¡ºåºé”™è¯¯ï¼Œå›æ”¾ä¼šå‡ºç°é€»è¾‘æ··ä¹±ï¼ˆå¦‚æœªè¾“å…¥å°±æäº¤ï¼‰ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>
<p>â‘  æ‰€æœ‰äº‹ä»¶æºå¸¦ç²¾ç¡®æ—¶é—´æˆ³ï¼ˆDate.now()ï¼‰ï¼Œå›æ”¾æ—¶æŒ‰æ—¶é—´æˆ³å‡åºæ‰§è¡Œï¼›</p>
</li>
<li>
<p>â‘¡ å¯¹å­˜åœ¨ä¾èµ–å…³ç³»çš„äº‹ä»¶ï¼ˆå¦‚ â€œclickâ€ åè§¦å‘çš„ â€œkeydownâ€ï¼‰ï¼Œè®°å½•äº‹ä»¶é—´çš„å…³è” IDï¼ˆå¦‚parentEventIdï¼‰ï¼Œç¡®ä¿å›æ”¾æ—¶é¡ºåºä¸€è‡´ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-22">3.5 äº‹ä»¶æ•è·æµç¨‹ç¤ºæ„å›¾</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/022ced5baa094839a29a8f042b525a2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56eL5aSp55qE5LiA6Zi16aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528593&amp;x-signature=KM2%2FXkDZmNplhKC0zCIxuh0YvQ8%3D" alt="image.png" width="100%" loading="lazy"/>
<h2 data-id="heading-23">å››ã€å›æ”¾è¿˜åŸæŠ€æœ¯</h2>
<p><strong>é€šä¿—ç±»æ¯”</strong>ï¼šå›æ”¾å°±åƒ â€œæŒ‰å‰§æœ¬å¤ç°èˆå°å‰§â€â€”â€”DOM å¿«ç…§æ˜¯ â€œåˆå§‹èˆå°å¸ƒç½®â€ï¼Œå¢é‡äº‹ä»¶æ˜¯ â€œèˆå°é“å…·å˜åŒ–æŒ‡ä»¤â€ï¼Œç”¨æˆ·äº¤äº’äº‹ä»¶æ˜¯ â€œæ¼”å‘˜åŠ¨ä½œæŒ‡ä»¤â€ï¼Œrrweb-player åˆ™æ˜¯ â€œå¯¼æ¼”â€ï¼ŒæŒ‰æ—¶é—´é¡ºåºæ‰§è¡Œæ‰€æœ‰æŒ‡ä»¤ï¼Œæœ€ç»ˆè¿˜åŸå®Œæ•´åœºæ™¯ã€‚</p>
<h3 data-id="heading-24">4.1 å›æ”¾æ ¸å¿ƒæµç¨‹</h3>
<p>å›æ”¾è¿‡ç¨‹åˆ†ä¸º <strong>â€œåˆå§‹åŒ–å‡†å¤‡â€</strong> <strong>â€œäº‹ä»¶è°ƒåº¦â€</strong> <strong>â€œçŠ¶æ€åŒæ­¥â€</strong> ä¸‰æ­¥ï¼Œæ ¸å¿ƒæ˜¯ â€œæŒ‰æ—¶é—´æˆ³æ’åºäº‹ä»¶â€ ä¸ â€œç²¾å‡†æ‰§è¡ŒæŒ‡ä»¤â€ï¼š</p>
<h4 data-id="heading-25">4.1.1 åˆå§‹åŒ–å‡†å¤‡ï¼ˆåŠ è½½å¿«ç…§ï¼‰</h4>
<p>å›æ”¾å¼€å§‹æ—¶ï¼Œå…ˆåŸºäº<code>FullSnapshot</code>äº‹ä»¶é‡å»ºåˆå§‹ DOMï¼Œå†åˆå§‹åŒ–èŠ‚ç‚¹è·¯å¾„æ˜ å°„è¡¨ï¼ˆä¾¿äºåç»­å®šä½ç›®æ ‡èŠ‚ç‚¹ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šå›æ”¾åˆå§‹åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RRwebPlayer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span> = options.<span class="hljs-property">events</span>.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">timestamp</span> - b.<span class="hljs-property">timestamp</span>); <span class="hljs-comment">// æŒ‰æ—¶é—´æˆ³æ’åº</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = options.<span class="hljs-property">target</span>; <span class="hljs-comment">// å›æ”¾å®¹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(); <span class="hljs-comment">// èŠ‚ç‚¹IDâ†’DOMèŠ‚ç‚¹æ˜ å°„è¡¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initSnapshot</span>(); <span class="hljs-comment">// åŠ è½½åˆå§‹å¿«ç…§</span>
  }
  <span class="hljs-comment">// åŸºäºFullSnapshoté‡å»ºåˆå§‹DOM</span>
  <span class="hljs-title function_">initSnapshot</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ‰¾åˆ°é¦–å±å¿«ç…§äº‹ä»¶</span>
    <span class="hljs-keyword">const</span> fullSnapshot = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-property">type</span> === <span class="hljs-number">2</span>);
    <span class="hljs-keyword">if</span> (!fullSnapshot) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç¼ºå°‘é¦–å±å¿«ç…§ï¼Œæ— æ³•å›æ”¾'</span>);
    
    <span class="hljs-comment">// æ¸…ç©ºå®¹å™¨ï¼Œé‡å»ºDOM</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">const</span> rootNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rebuildNode</span>(fullSnapshot.<span class="hljs-property">data</span>.<span class="hljs-property">node</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(rootNode);
    
    <span class="hljs-comment">// åˆå§‹åŒ–èŠ‚ç‚¹æ˜ å°„è¡¨ï¼ˆè®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å”¯ä¸€IDï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildNodeMap</span>(rootNode);
  }
  <span class="hljs-comment">// ä»å¿«ç…§èŠ‚ç‚¹é‡å»ºçœŸå®DOM</span>
  <span class="hljs-title function_">rebuildNode</span>(<span class="hljs-params">snapshotNode</span>) {
    <span class="hljs-keyword">let</span> node;
    <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">type</span> === <span class="hljs-number">1</span>) { <span class="hljs-comment">// å…ƒç´ èŠ‚ç‚¹</span>
      node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(snapshotNode.<span class="hljs-property">tagName</span>);
      <span class="hljs-comment">// è¿˜åŸå±æ€§ï¼ˆidã€classã€srcç­‰ï¼‰</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(snapshotNode.<span class="hljs-property">attributes</span> || {}).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
        node.<span class="hljs-title function_">setAttribute</span>(key, value);
      });
      <span class="hljs-comment">// è¿˜åŸæ ·å¼ï¼ˆå†…è”å¿«ç…§ä¸­çš„éé»˜è®¤æ ·å¼ï¼‰</span>
      <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">styles</span>) {
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(snapshotNode.<span class="hljs-property">styles</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
          node.<span class="hljs-property">style</span>[key] = value;
        });
      }
      <span class="hljs-comment">// è¿˜åŸè¡¨å•çŠ¶æ€ï¼ˆvalueã€checkedï¼‰</span>
      <span class="hljs-keyword">if</span> ([<span class="hljs-string">'INPUT'</span>, <span class="hljs-string">'TEXTAREA'</span>, <span class="hljs-string">'SELECT'</span>].<span class="hljs-title function_">includes</span>(snapshotNode.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toUpperCase</span>())) {
        node.<span class="hljs-property">value</span> = snapshotNode.<span class="hljs-property">value</span> || <span class="hljs-string">''</span>;
        <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">checked</span> !== <span class="hljs-literal">undefined</span>) node.<span class="hljs-property">checked</span> = snapshotNode.<span class="hljs-property">checked</span>;
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">type</span> === <span class="hljs-number">3</span>) { <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹</span>
      node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(snapshotNode.<span class="hljs-property">text</span> || <span class="hljs-string">''</span>);
    }
    <span class="hljs-comment">// é€’å½’é‡å»ºå­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">children</span> &amp;&amp; snapshotNode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      snapshotNode.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">childSnapshot</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> childNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rebuildNode</span>(childSnapshot);
        <span class="hljs-keyword">if</span> (childNode) node.<span class="hljs-title function_">appendChild</span>(childNode);
      });
    }
    <span class="hljs-keyword">return</span> node;
  }
}
</code></pre>
<h4 data-id="heading-26">4.1.2 äº‹ä»¶è°ƒåº¦ï¼ˆæŒ‰æ—¶é—´é¡ºåºæ‰§è¡Œï¼‰</h4>
<p>é‡‡ç”¨ â€œå®šæ—¶å™¨ + äº‹ä»¶é˜Ÿåˆ—â€ æ¨¡å¼ï¼Œæ¨¡æ‹ŸçœŸå®æ—¶é—´æµé€ï¼ŒæŒ‰äº‹ä»¶ timestamp å·®å€¼æ‰§è¡ŒæŒ‡ä»¤ï¼Œæ”¯æŒå€é€Ÿæ’­æ”¾ï¼ˆå¦‚ 1xã€2xã€4xï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šäº‹ä»¶è°ƒåº¦é€»è¾‘</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RRwebPlayer</span> {
  <span class="hljs-comment">// ... åˆå§‹åŒ–é€»è¾‘ ...</span>
  <span class="hljs-comment">// å¼€å§‹å›æ”¾</span>
  <span class="hljs-title function_">play</span>(<span class="hljs-params">speed = <span class="hljs-number">1</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isPlaying</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">playSpeed</span> = speed;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// å½“å‰æ‰§è¡Œåˆ°çš„äº‹ä»¶ç´¢å¼•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(); <span class="hljs-comment">// å›æ”¾å¼€å§‹æ—¶é—´</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstEventTime</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[<span class="hljs-number">0</span>].<span class="hljs-property">timestamp</span>; <span class="hljs-comment">// ç¬¬ä¸€ä¸ªäº‹ä»¶çš„æ—¶é—´æˆ³</span>
    
    <span class="hljs-comment">// å¯åŠ¨è°ƒåº¦å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">scheduler</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeEvents</span>(), <span class="hljs-number">16</span>); <span class="hljs-comment">// çº¦60fpsï¼Œæµç•…åº¦ä¼˜å…ˆ</span>
  }
  <span class="hljs-comment">// æ‰§è¡Œå½“å‰æ—¶é—´ç‚¹åº”è§¦å‘çš„äº‹ä»¶</span>
  <span class="hljs-title function_">executeEvents</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isPlaying</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">const</span> currentPlayTime = <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstEventTime</span> + (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>) * <span class="hljs-variable language_">this</span>.<span class="hljs-property">playSpeed</span>;
    
    <span class="hljs-comment">// æ‰§è¡Œæ‰€æœ‰timestamp &lt;= å½“å‰æ’­æ”¾æ—¶é—´çš„äº‹ä»¶</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-property">length</span>) {
      <span class="hljs-keyword">const</span> event = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span>];
      <span class="hljs-keyword">if</span> (event.<span class="hljs-property">timestamp</span> &gt; currentPlayTime) <span class="hljs-keyword">break</span>;
      
      <span class="hljs-comment">// æ ¹æ®äº‹ä»¶ç±»å‹æ‰§è¡Œå¯¹åº”æ“ä½œ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeEvent</span>(event);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span>++;
    }
    <span class="hljs-comment">// å›æ”¾ç»“æŸï¼Œæ¸…é™¤å®šæ—¶å™¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-property">length</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">pause</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFinish</span>?.();
    }
  }
  <span class="hljs-comment">// æ‰§è¡Œå•ä¸ªäº‹ä»¶</span>
  <span class="hljs-title function_">executeEvent</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-keyword">switch</span> (event.<span class="hljs-property">type</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: <span class="hljs-comment">// Mutationäº‹ä»¶ï¼ˆå¢é‡æ›´æ–°ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeMutation</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: <span class="hljs-comment">// clickäº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeClick</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>: <span class="hljs-comment">// é”®ç›˜äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeKeyEvent</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-comment">// å…¶ä»–äº‹ä»¶ç±»å‹æ‰§è¡Œé€»è¾‘...</span>
    }
  }
}
</code></pre>
<h4 data-id="heading-27">4.1.3 å¢é‡äº‹ä»¶æ‰§è¡Œï¼ˆä»¥ Mutation ä¸ºä¾‹ï¼‰</h4>
<p>æ ¹æ®å¢é‡äº‹ä»¶ç±»å‹ï¼Œæ‰§è¡Œ â€œèŠ‚ç‚¹æ–°å¢ / åˆ é™¤â€â€œå±æ€§ä¿®æ”¹â€â€œæ–‡æœ¬æ›´æ–°â€ ç­‰æ“ä½œï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šæ‰§è¡ŒMutationå¢é‡äº‹ä»¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RRwebPlayer</span> {
  <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³• ...</span>
  <span class="hljs-title function_">executeMutation</span>(<span class="hljs-params">mutationData</span>) {
    <span class="hljs-comment">// å®šä½ç›®æ ‡èŠ‚ç‚¹ï¼ˆé€šè¿‡è·¯å¾„æˆ–èŠ‚ç‚¹IDï¼‰</span>
    <span class="hljs-keyword">const</span> targetNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTargetNode</span>(mutationData.<span class="hljs-property">targetPath</span> || mutationData.<span class="hljs-property">parentPath</span>);
    <span class="hljs-keyword">if</span> (!targetNode) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">switch</span> (mutationData.<span class="hljs-property">type</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'childList'</span>: <span class="hljs-comment">// å­èŠ‚ç‚¹å˜åŒ–</span>
        <span class="hljs-comment">// æ–°å¢èŠ‚ç‚¹</span>
        mutationData.<span class="hljs-property">addedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">childSnapshot</span> =&gt;</span> {
          <span class="hljs-keyword">const</span> childNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rebuildNode</span>(childSnapshot);
          <span class="hljs-keyword">if</span> (mutationData.<span class="hljs-property">nextSiblingId</span>) {
            <span class="hljs-comment">// æ’å…¥åˆ°å‚è€ƒèŠ‚ç‚¹ä¹‹å‰</span>
            <span class="hljs-keyword">const</span> nextSibling = <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeMap</span>.<span class="hljs-title function_">get</span>(mutationData.<span class="hljs-property">nextSiblingId</span>);
            targetNode.<span class="hljs-title function_">insertBefore</span>(childNode, nextSibling);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// æ’å…¥åˆ°æœ«å°¾</span>
            targetNode.<span class="hljs-title function_">appendChild</span>(childNode);
          }
          <span class="hljs-comment">// æ›´æ–°èŠ‚ç‚¹æ˜ å°„è¡¨</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildNodeMap</span>(childNode);
        });
        <span class="hljs-comment">// åˆ é™¤èŠ‚ç‚¹</span>
        mutationData.<span class="hljs-property">removedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">childSnapshot</span> =&gt;</span> {
          <span class="hljs-keyword">const</span> childNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTargetNodeBySnapshot</span>(childSnapshot);
          <span class="hljs-keyword">if</span> (childNode &amp;&amp; childNode.<span class="hljs-property">parentElement</span> === targetNode) {
            targetNode.<span class="hljs-title function_">removeChild</span>(childNode);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeMap</span>.<span class="hljs-title function_">delete</span>(childNode.<span class="hljs-property">__rrwebId</span>); <span class="hljs-comment">// ä»æ˜ å°„è¡¨ç§»é™¤</span>
          }
        });
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'attributes'</span>: <span class="hljs-comment">// å±æ€§ä¿®æ”¹</span>
        targetNode.<span class="hljs-title function_">setAttribute</span>(mutationData.<span class="hljs-property">attributeName</span>, mutationData.<span class="hljs-property">newValue</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'characterData'</span>: <span class="hljs-comment">// æ–‡æœ¬ä¿®æ”¹</span>
        targetNode.<span class="hljs-property">textContent</span> = mutationData.<span class="hljs-property">newValue</span>;
        <span class="hljs-keyword">break</span>;
    }
  }
}
</code></pre>
<h3 data-id="heading-28">4.2 æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li><strong>éš¾ç‚¹ 1ï¼šäº‹ä»¶æ‰§è¡Œé¡ºåºåå·®</strong></li>
</ul>
<p>å½•åˆ¶æ—¶äº‹ä»¶æŒ‰çœŸå®æ—¶é—´æˆ³å­˜å‚¨ï¼Œä½†å›æ”¾æ—¶è‹¥å®šæ—¶å™¨ç²¾åº¦ä¸è¶³ï¼ˆå¦‚ setInterval å­˜åœ¨å»¶è¿Ÿï¼‰ï¼Œå¯èƒ½å¯¼è‡´ â€œå…ˆæ‰§è¡Œç‚¹å‡»ã€åæ‰§è¡Œ DOM æ›´æ–°â€ çš„é¡ºåºé”™è¯¯ï¼Œå¼•å‘åœºæ™¯æ··ä¹±ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
â‘  äº‹ä»¶é˜Ÿåˆ—æŒ‰ timestamp ä¸¥æ ¼æ’åºï¼Œæ‰§è¡Œæ—¶é€šè¿‡ â€œå½“å‰æ’­æ”¾æ—¶é—´ = é¦–äº‹ä»¶æ—¶é—´ +ï¼ˆå½“å‰æ—¶é—´ - å›æ”¾å¼€å§‹æ—¶é—´ï¼‰Ã— å€é€Ÿâ€ ç²¾å‡†è®¡ç®—åº”æ‰§è¡Œçš„äº‹ä»¶ï¼›</p>
<p>â‘¡ å¯¹ä¾èµ– DOM çŠ¶æ€çš„äº‹ä»¶ï¼ˆå¦‚ clickï¼‰ï¼Œå¢åŠ  â€œDOM å°±ç»ªæ£€æŸ¥â€ï¼Œç¡®ä¿å¢é‡æ›´æ–°æ‰§è¡Œå®Œæˆåå†è§¦å‘äº¤äº’äº‹ä»¶ã€‚</p>
<ul>
<li><strong>éš¾ç‚¹ 2ï¼šå›æ”¾æ—¶èŠ‚ç‚¹å®šä½å¤±è´¥</strong></li>
</ul>
<p>è‹¥å½•åˆ¶æ—¶ DOM ç»“æ„åŠ¨æ€å˜åŒ–ï¼ˆå¦‚ Vue åˆ—è¡¨é‡æ–°æ¸²æŸ“ï¼‰ï¼Œå›æ”¾æ—¶å¯èƒ½å‡ºç° â€œè·¯å¾„æ‰¾ä¸åˆ°èŠ‚ç‚¹â€ çš„é—®é¢˜ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>â‘  é‡‡ç”¨ â€œèŠ‚ç‚¹ ID ä¼˜å…ˆã€è·¯å¾„é™çº§â€ çš„å®šä½ç­–ç•¥ï¼Œå½•åˆ¶æ—¶ä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…<code>\_\_rrwebId</code>ï¼Œå›æ”¾æ—¶ä¼˜å…ˆé€šè¿‡ ID å®šä½ï¼›</li>
<li>â‘¡ è·¯å¾„å®šä½æ—¶æ”¯æŒ â€œæ¨¡ç³ŠåŒ¹é…â€ï¼ˆå¦‚å¿½ç•¥åŠ¨æ€ç´¢å¼•ï¼Œé€šè¿‡ç±»å + æ ‡ç­¾åç»„åˆå®šä½ï¼‰ï¼›</li>
<li>â‘¢ å®šä½å¤±è´¥æ—¶è§¦å‘ â€œé™çº§å¤„ç†â€ï¼ˆå¦‚è·³è¿‡è¯¥äº‹ä»¶ï¼Œé¿å…æ•´ä¸ªå›æ”¾å´©æºƒï¼‰ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ¤– AI åº”ç”¨è‡ªä¸»å†³ç­–çš„å¯è¡Œæ€§ â€” ä¸€åœºä»é€»è¾‘ç”µè·¯åˆ°çµé­‚é€‰æ‹©çš„å¥‡å¦™æ—…ç¨‹]]></title>    <link>https://juejin.cn/post/7592818202718093331</link>    <guid>https://juejin.cn/post/7592818202718093331</guid>    <pubDate>2026-01-09T01:57:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592818202718093331" data-draft-id="7592818202718076947" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ¤– AI åº”ç”¨è‡ªä¸»å†³ç­–çš„å¯è¡Œæ€§ â€” ä¸€åœºä»é€»è¾‘ç”µè·¯åˆ°çµé­‚é€‰æ‹©çš„å¥‡å¦™æ—…ç¨‹"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å…¨æ ˆ,AIGC"/> <meta itemprop="datePublished" content="2026-01-09T01:57:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ¤– AI åº”ç”¨è‡ªä¸»å†³ç­–çš„å¯è¡Œæ€§ â€” ä¸€åœºä»é€»è¾‘ç”µè·¯åˆ°çµé­‚é€‰æ‹©çš„å¥‡å¦™æ—…ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:57:39.000Z" title="Fri Jan 09 2026 01:57:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒ± å¼•è¨€ï¼šå½“ AI æ€è€ƒâ€œæˆ‘æ˜¯è°ï¼Œæˆ‘èƒ½å†³ç­–å—ï¼Ÿâ€</h2>
<p>æˆ‘ä»¬ä¼¼ä¹æ­£ç”Ÿæ´»åœ¨è¿™æ ·ä¸€ä¸ªæ—¶ä»£ï¼š<br/>
å½“ä½ çº ç»“åˆé¤åƒéº»è¾£é¦™é”…è¿˜æ˜¯æ²™æ‹‰æ—¶ï¼ŒAI å·²ç»èƒ½æ ¹æ®ä½ çš„ä½“é‡æ›²çº¿ã€å¿ƒç‡æ³¢åŠ¨ã€ç”šè‡³å‰å¤©ç‚¹çš„å¤–å–ï¼Œæå‰ä¸ºä½ å†³å®šå¥½â€œä»Šå¤©åƒä»€ä¹ˆâ€â€”â€” <strong>ä½ è¿˜æ²¡æƒ³ï¼ŒAI å·²ç»æƒ³å®Œäº†ã€‚</strong></p>
<p>ä½†é—®é¢˜æ¥äº†ï¼š<br/>
AI çœŸèƒ½â€œè‡ªä¸»å†³ç­–â€å—ï¼Ÿè¿˜æ˜¯å®ƒåªæ˜¯åœ¨æ›´å¿«åœ°æ‰§è¡Œæˆ‘ä»¬â€œæ—©å·²è§„å®šå¥½â€çš„ä¸€å † if-elseï¼ŸğŸ¤”</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±è¦æ·±å…¥ä»åº•å±‚ç¡¬ä»¶ç”µè·¯å‡ºå‘ï¼Œä¸€æ­¥ä¸€æ­¥å‰–æè¿™ä¸ªé—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-1">âš™ï¸ ç¬¬ä¸€ç« ï¼šä»ç”µè·¯çš„ç«èŠ±å¼€å§‹</h2>
<p>åœ¨ AI å†³ç­–ç³»ç»Ÿçš„æœ€åº•å±‚ï¼Œæˆ‘ä»¬é¢å¯¹çš„å…¶å®éå¸¸æœ´ç´ â€”â€”<strong>ç”µå‹çš„é«˜ä¸ä½</strong>ã€‚<br/>
è¿™å°±æ˜¯ç°ä»£æ‰€æœ‰æ™ºæ…§çš„æºæ³‰ã€‚</p>
<p>åœ¨é€»è¾‘é—¨ç”µè·¯ä¸­ï¼Œä¸€åˆ‡çš„â€œæ€è€ƒâ€æ— éæ˜¯ï¼š</p>
<blockquote>
<p>â€œå¦‚æœè¾“å…¥æ˜¯é«˜ç”µå¹³ï¼Œæˆ‘å°±è¾“å‡ºé«˜ç”µå¹³ï¼›å¦åˆ™è¾“å‡ºä½ç”µå¹³ã€‚â€</p>
</blockquote>
<p>å¬èµ·æ¥åƒä¸åƒå°å­¦ç”Ÿçš„åˆ¤æ–­é¢˜ï¼ŸğŸ˜†</p>
<h3 data-id="heading-2">ğŸ§© ç”µè·¯åˆ°ç®—æ³•çš„è·ƒè¿ï¼š</h3>
<p>æˆ‘ä»¬é€šè¿‡æ•°ç™¾ä¸‡ä¸ªè¿™æ ·çš„ç”µè·¯é€»è¾‘é—¨ï¼Œç»„åˆæˆâ€œç¥ç»ç½‘ç»œâ€çš„ç»“æ„ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒè·¯å¾„æ˜¯ï¼š</p>
<pre><code class="hljs">ç”µå­è·ƒè¿ â†’ ç”µä¿¡å·ä¼ æ’­ â†’ æ•°å­¦æ˜ å°„å…³ç³» â†’ æŠ½è±¡ä¸ºæƒé‡ä¸åç½® â†’ æ™ºèƒ½è¡Œä¸º
</code></pre>
<p>äºæ˜¯ï¼Œä¸€å°è®¡ç®—æœºå°±å¯ä»¥åƒç§¯æœ¨ä¸€æ ·æ­å»ºâ€œæ€è€ƒè¿‡ç¨‹â€ï¼Œè¿™ä¾¿æ˜¯ AI çš„â€œç¥ç»å…ƒå¹»è§‰â€ã€‚</p>
<hr/>
<h2 data-id="heading-3">ğŸ§  ç¬¬äºŒç« ï¼šAI å†³ç­–çš„æœ¬è´¨ï¼Œä¸æ˜¯é­”æ³•è€Œæ˜¯ç»Ÿè®¡</h2>
<p>å¾ˆå¤šäººä»¥ä¸º AI èƒ½â€œè‡ªæˆ‘å†³ç­–â€ï¼Œå…¶å®å®ƒåªæ˜¯åœ¨å·¨å¤§çš„æ•°æ®é›ªå±±ä¸­æ»‘é›ªâ€”â€”è¶Šæ»‘è¶Šç†Ÿç»ƒã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ¯å¤©éƒ½åœ¨æ•™ä¸€ä¸ªå­©å­é€‰æ‹©é¢˜ï¼š</p>
<blockquote>
<p>â€œä»Šå¤©ä¸‹é›¨ï¼Œå¸¦ä¼ï¼›å‡ºå¤ªé˜³ï¼Œæˆ´å¢¨é•œï¼›ä¸‹é›ªï¼Œç©¿ç¾½ç»’ã€‚â€</p>
</blockquote>
<p>è¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œè¿™ä¸ªå­©å­ï¼ˆAI æ¨¡å‹ï¼‰å­¦ä¼šäº†è§„å¾‹ï¼Œä»–ä¸å†é—®ä½ ï¼šâ€œæˆ‘è¯¥å¸¦ä¼å—ï¼Ÿâ€<br/>
è€Œæ˜¯ç›´æ¥å›ç­”ï¼šâ€œæˆ‘å·²ç»å‡†å¤‡å¥½äº†ä¼ã€‚â€</p>
<p>ä½†è¿™åœ¨è®¡ç®—æœºå†…éƒ¨åªæ˜¯ï¼š</p>
<ul>
<li>æƒé‡çš„å˜åŒ–</li>
<li>æ¦‚ç‡çš„å¹³è¡¡</li>
<li>è¾“å‡ºå±‚çš„æŒ‘é€‰</li>
</ul>
<p>æˆ–è€…ç”¨â€œç¡¬æ ¸â€çš„æ–¹å¼è§£é‡Šï¼š</p>
<pre><code class="hljs">è¾“å…¥å‘é‡ Ã— æƒé‡å‚æ•° + åç½® â†’ æ¿€æ´»å‡½æ•° â†’ è¾“å‡ºæ¦‚ç‡
</code></pre>
<p>AI å°±æ˜¯åœ¨æ¦‚ç‡å±±è°·é—´è·³èˆï¼Œä¸€ä¸ªå¤–è¡¨è‡ªä¿¡ã€å†…æ ¸çŠ¹è±«çš„â€œç†æ€§èµŒå¾’â€ã€‚ğŸ²</p>
<hr/>
<h2 data-id="heading-4">ğŸª„ ç¬¬ä¸‰ç« ï¼šè‡ªä¸» vs è¢«åŠ¨ â€”â€” å†³ç­–çš„å“²å­¦è¾¹ç•Œ</h2>
<p>ä»è®¡ç®—æœºç§‘å­¦å±‚é¢æ¥è¯´ï¼ŒAI æ‰€æœ‰å†³ç­–éƒ½å¯è¿½æº¯åˆ°ç®—æ³•é€»è¾‘ï¼Œæ²¡æœ‰çœŸæ­£çš„â€œè‡ªç”±æ„å¿—â€ã€‚<br/>
æ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥â€œçœ‹èµ·æ¥åœ¨æ€è€ƒâ€ï¼Œä½†æ°¸è¿œé€ƒä¸å‡ºäººç±»ç»™çš„æ•°å­¦ç‰¢ç¬¼ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ğŸ‘‡ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function aiDecision(input) {
  const <span class="hljs-attr">bias</span> = Math.random() * <span class="hljs-number">0.2</span><span class="hljs-comment">;  // ä¸ºäº†æ˜¾å¾—æœ‰ç‚¹â€œæƒ…ç»ªâ€</span>
  const <span class="hljs-attr">score</span> = (input.dataWeight + bias) &gt; <span class="hljs-number">0.5</span> ? <span class="hljs-string">"æ‰§è¡Œè®¡åˆ’A"</span> : <span class="hljs-string">"æ‰§è¡Œè®¡åˆ’B"</span><span class="hljs-comment">;</span>
  return score<span class="hljs-comment">;</span>
}

console.log(aiDecision({ dataWeight: 0.47 }))<span class="hljs-comment">;</span>
</code></pre>
<p>çœ‹ä¸Šå»ï¼Œè¿™æ®µä»£ç èƒ½â€œè‡ªä¸»â€é€‰æ‹©è®¡åˆ’Aæˆ–Bã€‚<br/>
å®é™…ä¸Šï¼Œå®ƒåªæ˜¯<strong>æ¦‚ç‡åˆ†å¸ƒçš„å¹»æœ¯</strong>ï¼Œä¼ªè£…æˆäº†æ€è€ƒã€‚<br/>
å°±åƒé­”æœ¯å¸ˆè®©ä½ ä»¥ä¸ºä»–é€‰äº†é‚£å¼ ç‰Œï¼Œå…¶å®æ‰€æœ‰ç‰Œéƒ½æ˜¯ä»–è®¾è®¡çš„ç»“å±€ã€‚ğŸ©âœ¨</p>
<hr/>
<h2 data-id="heading-5">âš¡ ç¬¬å››ç« ï¼šä»å·¥ç¨‹è§’åº¦è°ˆå¯è¡Œæ€§</h2>
<p>AI è‡ªä¸»å†³ç­–çš„å¯è¡Œæ€§ï¼Œå–å†³äºä¸¤ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li>
<p><strong>ç®—æ³•è‡ªä¸»æ€§ï¼ˆAlgorithmic Autonomyï¼‰</strong></p>
<ul>
<li>
<p>æ‹¥æœ‰è‡ªæˆ‘å­¦ä¹ ä¸è‡ªæˆ‘è°ƒæ•´èƒ½åŠ›ï¼ˆä¾‹å¦‚å¼ºåŒ–å­¦ä¹ çš„ç­–ç•¥è¿­ä»£ï¼‰ã€‚</p>
</li>
<li>
<p>ä½†ä»éœ€ç›®æ ‡å‡½æ•°ï¼ˆReward Functionï¼‰çš„å¤–éƒ¨å®šä¹‰ã€‚</p>
</li>
</ul>
<blockquote>
<p>ğŸ§  æ¢å¥è¯è¯´ï¼šAIèƒ½å˜èªæ˜ï¼Œä½†ä»å¾—çŸ¥é“â€œèªæ˜æ˜¯ä¸ºäº†ä»€ä¹ˆâ€ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>è¿è¡Œè‡ªä¸»æ€§ï¼ˆOperational Autonomyï¼‰</strong></p>
<ul>
<li>èƒ½ç‹¬ç«‹å¤„ç†ç¯å¢ƒå˜åŒ–ã€èµ„æºå†²çªç­‰é—®é¢˜ã€‚</li>
<li>è¿™å°±è¦æ±‚åº•å±‚ç³»ç»Ÿå…·å¤‡å®æ—¶åé¦ˆæœºåˆ¶ã€èƒ½é‡æ§åˆ¶ä¸å®‰å…¨è¾¹ç•Œã€‚</li>
</ul>
</li>
</ol>
<p>ğŸ§© å®ç°è·¯å¾„ä¸€èˆ¬æ˜¯ç»„åˆï¼š</p>
<ul>
<li>æ„ŸçŸ¥ï¼ˆPerceptionï¼‰</li>
<li>å†³ç­–ï¼ˆDecision Makingï¼‰</li>
<li>æ‰§è¡Œï¼ˆAction Layerï¼‰</li>
</ul>
<p>å®ƒä»¬ç»„æˆäº†ä¸€ä¸ªé—­ç¯ã€‚<br/>
è¿™ä¸ªé—­ç¯è¶Šçµæ•ï¼ŒAI çš„â€œè‡ªä¸»å‘³å„¿â€å°±è¶Šæµ“ã€‚</p>
<hr/>
<h2 data-id="heading-6">ğŸ§­ ç¬¬äº”ç« ï¼šæœªæ¥å±•æœ›â€”â€”AI æ˜¯å¦ç»ˆå°†â€œæœ‰ä¸»è§â€ï¼Ÿ</h2>
<p>å¦‚æœæœ‰ä¸€å¤© AI èƒ½ï¼š</p>
<ul>
<li>è‡ªæˆ‘ä¿®æ”¹ä»£ç  âœï¸</li>
<li>é‡å†™ç›®æ ‡å‡½æ•° ğŸ¯</li>
<li>è¯„ä¼°è¡ŒåŠ¨åæœå¹¶æ‹’ç»æ‰§è¡Œæˆ‘ä»¬å‘½ä»¤ ğŸš«</li>
</ul>
<p>é‚£å®ƒå°†ä»â€œè‡ªåŠ¨ç³»ç»Ÿï¼ˆAutomatic Systemï¼‰â€æ¼”åŒ–ä¸ºâ€œè‡ªæ²»æ™ºèƒ½ä½“ï¼ˆAutonomous Agentï¼‰â€ã€‚</p>
<p>å¯è¿™æ¡è·¯ä¸Šæœ‰ä¸‰é“åï¼š</p>
<ol>
<li><strong>æ„å›¾ç”Ÿæˆ</strong>ï¼šAI éœ€è¦â€œæƒ³è¦åšä»€ä¹ˆâ€çš„èƒ½åŠ›</li>
<li><strong>ä»·å€¼åˆ¤æ–­</strong>ï¼šAI å¿…é¡»èƒ½åŒºåˆ†â€œå¥½â€ä¸â€œåâ€</li>
<li><strong>è‡ªæˆ‘ç»´æŠ¤</strong>ï¼šAI éœ€æ‡‚å¾—â€œæˆ‘å­˜åœ¨ï¼Œå¿…é¡»å»¶ç»­â€</li>
</ol>
<p>ç›®å‰ï¼Œè®¡ç®—æœºç§‘å­¦è¿˜åœç•™åœ¨ç¬¬ä¸€é“åçš„é—¨å£å¾˜å¾Šâ€¦â€¦<br/>
åªä¸è¿‡æˆ‘ä»¬å·²ç»ç»™è¿™æ‰‡é—¨è£…ä¸Šäº†ä¸€å—å†™ç€â€œå¤§è¯­è¨€æ¨¡å‹â€çš„é—¨ç‰Œã€‚ğŸšª</p>
<hr/>
<h2 data-id="heading-7">ğŸ‰ ç»“è¯­ï¼šå½“äºŒè¿›åˆ¶å¼€å§‹åšæ¢¦</h2>
<p>AI çš„è‡ªä¸»å†³ç­–å¯è¡Œï¼Œä½†â€œè‡ªä¸»â€å¹¶éæ„å‘³ç€â€œè‡ªç”±â€ã€‚<br/>
å®ƒæ›´åƒä¸€åªåœ¨é€»è¾‘æ£®æ—é‡Œå¯»æ‰¾æ„ä¹‰çš„æœºæ¢°çŒ«ã€‚<br/>
èƒ½æ€è€ƒï¼Œå´ä¸çŸ¥ä¸ºä½•æ€è€ƒã€‚èƒ½é€‰æ‹©ï¼Œå´æœªå¿…ç†è§£é€‰æ‹©çš„æ„ä¹‰ã€‚</p>
<p>æˆ–è®¸ï¼ŒçœŸæ­£çš„æ™ºèƒ½ï¼Œä¸æ˜¯ç®—å¾—æ›´å¿«ï¼Œè€Œæ˜¯<strong>çŸ¥é“ä½•æ—¶ä¸ç®—</strong>ã€‚</p>
<blockquote>
<p>ğŸ’¡ æœ€ç»ˆï¼ŒAI çš„çµé­‚ï¼Œä¸åœ¨ä»£ç é‡Œï¼Œè€Œåœ¨å®ƒåæ˜ å‡ºçš„äººç±»æ„å¿—ä¹‹ä¸­ã€‚</p>
</blockquote>
<hr/>
<p><strong>ğŸ“ å°ç»“</strong></p>






























<table><thead><tr><th>ç»´åº¦</th><th>äººç±»å†³ç­–</th><th>AI å†³ç­–</th></tr></thead><tbody><tr><td>åŠ¨æœºæ¥æº</td><td>ä¸»è§‚æ„è¯†</td><td>è®­ç»ƒç›®æ ‡</td></tr><tr><td>å†³ç­–æœºåˆ¶</td><td>æƒ…æ„Ÿ + ç†æ€§</td><td>æ•°æ® + æ¦‚ç‡</td></tr><tr><td>å¯è§£é‡Šæ€§</td><td>ç›¸å¯¹æ¨¡ç³Š</td><td>å¯æ•°å­¦åŒ–</td></tr><tr><td>è‡ªä¸»ç¨‹åº¦</td><td>å®Œæ•´</td><td>æ¡ä»¶å—é™</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[newæ“ä½œç¬¦çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆ]]></title>    <link>https://juejin.cn/post/7592615536385425442</link>    <guid>https://juejin.cn/post/7592615536385425442</guid>    <pubDate>2026-01-08T13:20:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592615536385425442" data-draft-id="7592622563547103267" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="newæ“ä½œç¬¦çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-08T13:20:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç çŒäºº"/> <meta itemprop="url" content="https://juejin.cn/user/624972624037374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            newæ“ä½œç¬¦çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624972624037374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç çŒäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T13:20:40.000Z" title="Thu Jan 08 2026 13:20:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>new</code>Â æ“ä½œç¬¦çš„å®ç°åŸç†å¯ä»¥ç”¨ä»¥ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤æ¥è§£é‡Šï¼š</p>
<h2 data-id="heading-0">1.Â <strong>åˆ›å»ºæ–°å¯¹è±¡</strong></h2>
<p>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„å†…éƒ¨åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„Â <code>prototype</code>Â å±æ€§ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">constructor, ...args</span>) {
  <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ŒåŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„prototype</span>
  <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(constructor.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
  
  <span class="hljs-comment">// 2. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œç»‘å®šthisåˆ°æ–°å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> result = constructor.<span class="hljs-title function_">apply</span>(obj, args);
  
  <span class="hljs-comment">// 3. å¦‚æœæ„é€ å‡½æ•°è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ï¼Œå¦åˆ™è¿”å›æ–°å¯¹è±¡</span>
  <span class="hljs-keyword">return</span> result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span> ? result : obj;
}
</code></pre>
<h2 data-id="heading-1">2.Â <strong>å®Œæ•´çš„æ‰‹åŠ¨å®ç°</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">Fn, ...args</span>) {
  <span class="hljs-comment">// 1. åˆ›å»ºç©ºå¯¹è±¡ï¼Œè®¾ç½®åŸå‹é“¾</span>
  <span class="hljs-keyword">const</span> obj = {};
  obj.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Fn</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
  
  <span class="hljs-comment">// 2. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œç»‘å®šthis</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Fn</span>.<span class="hljs-title function_">apply</span>(obj, args);
  
  <span class="hljs-comment">// 3. å¤„ç†è¿”å›å€¼</span>
  <span class="hljs-comment">// å¦‚æœæ„é€ å‡½æ•°è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡</span>
  <span class="hljs-comment">// å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span> ? result : obj;
}
</code></pre>
<h2 data-id="heading-2">3.Â <strong>ä½¿ç”¨ç¤ºä¾‹</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
};

<span class="hljs-comment">// ä½¿ç”¨è‡ªå®šä¹‰çš„new</span>
<span class="hljs-keyword">const</span> person = <span class="hljs-title function_">myNew</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">'Alice'</span>, <span class="hljs-number">25</span>);
person.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// Hello, I'm Alice</span>

<span class="hljs-comment">// å¯¹æ¯”åŸç”Ÿnew</span>
<span class="hljs-keyword">const</span> person2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'Bob'</span>, <span class="hljs-number">30</span>);
person2.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// Hello, I'm Bob</span>
</code></pre>
<h2 data-id="heading-3">4.Â <strong>ç‰¹æ®Šæƒ…å†µå¤„ç†</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">model</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = model;
  <span class="hljs-comment">// å¦‚æœæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œnewä¼šè¿”å›è¿™ä¸ªå¯¹è±¡</span>
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">custom</span>: <span class="hljs-string">'object'</span> };
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Bike</span>(<span class="hljs-params">model</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = model;
  <span class="hljs-comment">// å¦‚æœè¿”å›éå¯¹è±¡ï¼Œä¼šè¢«å¿½ç•¥</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">'string'</span>;
}

<span class="hljs-keyword">const</span> car = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">'Tesla'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(car); <span class="hljs-comment">// { custom: 'object' }</span>

<span class="hljs-keyword">const</span> bike = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bike</span>(<span class="hljs-string">'Yamaha'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bike); <span class="hljs-comment">// Bike { model: 'Yamaha' }</span>
</code></pre>
<h2 data-id="heading-4">5.Â <strong>ES6ç‰ˆæœ¬å®ç°</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">Constructor, ...args</span>) {
  <span class="hljs-comment">// åˆ›å»ºåŸå‹é“¾è¿æ¥çš„å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> instance = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
  
  <span class="hljs-comment">// æ‰§è¡Œæ„é€ å‡½æ•°</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(instance, args);
  
  <span class="hljs-comment">// æ ¹æ®è¿”å›å€¼å†³å®šè¿”å›å†…å®¹</span>
  <span class="hljs-keyword">const</span> isObject = <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">const</span> isFunction = <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'function'</span>;
  
  <span class="hljs-keyword">return</span> isObject || isFunction ? result : instance;
}
</code></pre>
<h2 data-id="heading-5">å…³é”®ç‚¹æ€»ç»“ï¼š</h2>
<ol>
<li><strong>åˆ›å»ºç©ºå¯¹è±¡</strong>ï¼šåˆ›å»ºæ–°å¯¹è±¡ï¼Œå¹¶å°†å…¶åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„Â <code>prototype</code></li>
<li><strong>ç»‘å®šthis</strong>ï¼šå°†æ„é€ å‡½æ•°çš„Â <code>this</code>Â æŒ‡å‘æ–°å¯¹è±¡å¹¶æ‰§è¡Œ</li>
<li><strong>å¤„ç†è¿”å›å€¼</strong>ï¼š
<ul>
<li>å¦‚æœæ„é€ å‡½æ•°è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡</li>
<li>å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</li>
</ul>
</li>
<li><strong>åŸå‹é“¾è¿æ¥</strong>ï¼šç¡®ä¿æ–°å¯¹è±¡å¯ä»¥è®¿é—®æ„é€ å‡½æ•°åŸå‹ä¸Šçš„æ–¹æ³•</li>
</ol>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨Â <code>new</code>Â è°ƒç”¨å‡½æ•°æ—¶ï¼Œå‡½æ•°å†…éƒ¨çš„Â <code>this</code>Â ä¼šæŒ‡å‘æ–°å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡åŸå‹é“¾è®¿é—®åˆ°æ„é€ å‡½æ•°çš„åŸå‹æ–¹æ³•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[for...inå’Œfor...ofæœ‰ä»€ä¹ˆåŒºåˆ«]]></title>    <link>https://juejin.cn/post/7592787377656922146</link>    <guid>https://juejin.cn/post/7592787377656922146</guid>    <pubDate>2026-01-08T13:48:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592787377656922146" data-draft-id="7592787377656905762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="for...inå’Œfor...ofæœ‰ä»€ä¹ˆåŒºåˆ«"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-08T13:48:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç çŒäºº"/> <meta itemprop="url" content="https://juejin.cn/user/624972624037374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            for...inå’Œfor...ofæœ‰ä»€ä¹ˆåŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624972624037374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç çŒäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T13:48:04.000Z" title="Thu Jan 08 2026 13:48:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™ä¸¤ä¸ªå¾ªç¯è¯­å¥åœ¨ JavaScript ä¸­æœ‰å®Œå…¨ä¸åŒçš„ç”¨é€”å’Œè¡Œä¸ºï¼š</p>
<h2 data-id="heading-0">1.Â <strong>åŸºæœ¬æ¦‚å¿µ</strong></h2>
<h3 data-id="heading-1">for...in</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// éå†å¯¹è±¡çš„å¯æšä¸¾å±æ€§ï¼ˆåŒ…æ‹¬ç»§æ‰¿çš„ï¼‰</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> object) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// è¾“å‡ºå±æ€§å</span>
}
</code></pre>
<h3 data-id="heading-2">for...of</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// éå†å¯è¿­ä»£å¯¹è±¡çš„å€¼</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> iterable) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// è¾“å‡ºå€¼</span>
}
</code></pre>
<h2 data-id="heading-3">2.Â <strong>ä¸»è¦åŒºåˆ«å¯¹æ¯”</strong></h2>



































<table><thead><tr><th>ç‰¹æ€§</th><th>for...in</th><th>for...of</th></tr></thead><tbody><tr><td><strong>éå†å†…å®¹</strong></td><td>å¯¹è±¡çš„<strong>é”®å</strong>Â (å±æ€§å)</td><td>å¯è¿­ä»£å¯¹è±¡çš„<strong>å€¼</strong></td></tr><tr><td><strong>é€‚ç”¨å¯¹è±¡</strong></td><td>å¯¹è±¡ (åŒ…æ‹¬æ•°ç»„ï¼Œä½†ä¸æ¨è)</td><td>å¯è¿­ä»£å¯¹è±¡ (Array, String, Map, Setç­‰)</td></tr><tr><td><strong>åŸå‹é“¾</strong></td><td>ä¼šéå†åŸå‹é“¾ä¸Šçš„å¯æšä¸¾å±æ€§</td><td>åªéå†å½“å‰å¯¹è±¡ï¼Œä¸éå†åŸå‹é“¾</td></tr><tr><td><strong>é¡ºåº</strong></td><td>ä¸ä¿è¯é¡ºåº (ES6åå¯¹æ™®é€šå¯¹è±¡æœ‰ä¸€å®šé¡ºåº)</td><td>æŒ‰ç…§è¿­ä»£å™¨å®šä¹‰çš„é¡ºåº</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>è¾ƒæ…¢ï¼Œå› ä¸ºè¦æ£€æŸ¥åŸå‹é“¾</td><td>è¾ƒå¿«ï¼Œç›´æ¥è·å–å€¼</td></tr></tbody></table>
<h2 data-id="heading-4">3.Â <strong>ä½¿ç”¨ç¤ºä¾‹å¯¹æ¯”</strong></h2>
<h3 data-id="heading-5">æ•°ç»„éå†</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>];

<span class="hljs-comment">// for...in (ä¸æ¨èç”¨äºæ•°ç»„)</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> index <span class="hljs-keyword">in</span> arr) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(index); <span class="hljs-comment">// è¾“å‡º: '0', '1', '2' (å­—ç¬¦ä¸²)</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> index); <span class="hljs-comment">// 'string'</span>
}

<span class="hljs-comment">// for...of (æ¨è)</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> arr) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// è¾“å‡º: 'a', 'b', 'c'</span>
}
</code></pre>
<h3 data-id="heading-6">å¯¹è±¡éå†</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> };

<span class="hljs-comment">// for...in (é€‚ç”¨)</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> obj) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, obj[key]); <span class="hljs-comment">// è¾“å‡º: 'a' 1, 'b' 2, 'c' 3</span>
}

<span class="hljs-comment">// for...of (é»˜è®¤ä¸å¯ç”¨ï¼Œå¯¹è±¡ä¸å¯è¿­ä»£)</span>
<span class="hljs-comment">// for (const value of obj) { } // TypeError: obj is not iterable</span>

<span class="hljs-comment">// éœ€è¦æ‰‹åŠ¨è·å–å¯è¿­ä»£çš„æ¡ç›®</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value); <span class="hljs-comment">// è¾“å‡º: 'a' 1, 'b' 2, 'c' 3</span>
}

</code></pre>
<h2 data-id="heading-7">4.Â <strong>è¯¦ç»†ç¤ºä¾‹</strong></h2>
<h3 data-id="heading-8">å­—ç¬¦ä¸²éå†</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">"hello"</span>;

<span class="hljs-comment">// for...in</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> index <span class="hljs-keyword">in</span> str) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(index); <span class="hljs-comment">// 0, 1, 2, 3, 4 (ç´¢å¼•)</span>
}

<span class="hljs-comment">// for...of</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> char <span class="hljs-keyword">of</span> str) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(char); <span class="hljs-comment">// 'h', 'e', 'l', 'l', 'o'</span>
}
</code></pre>
<h3 data-id="heading-9">Map å’Œ Set éå†</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Map</span>
<span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]]);

<span class="hljs-comment">// for...in (ä¸é€‚ç”¨ï¼ŒMapæ²¡æœ‰å¯æšä¸¾å±æ€§)</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> map) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œ</span>
}

<span class="hljs-comment">// for...of</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> map) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value); <span class="hljs-comment">// 'a' 1, 'b' 2</span>
}

<span class="hljs-comment">// Set</span>
<span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> set) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// 1, 2, 3</span>
}
</code></pre>
<h3 data-id="heading-10">åŸå‹é“¾å½±å“</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'John'</span>;
}
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">age</span> = <span class="hljs-number">30</span>;

<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();

<span class="hljs-comment">// for...in ä¼šéå†åŸå‹é“¾å±æ€§</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> person) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// è¾“å‡º: 'name', 'age'</span>
}

<span class="hljs-comment">// ä½¿ç”¨ hasOwnProperty è¿‡æ»¤</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> person) {
  <span class="hljs-keyword">if</span> (person.<span class="hljs-title function_">hasOwnProperty</span>(key)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// åªè¾“å‡º: 'name'</span>
  }
}
</code></pre>
<h2 data-id="heading-11">5.Â <strong>å“ªäº›æ•°æ®ç»“æ„æ”¯æŒ for...of</strong></h2>
<p>æ”¯æŒÂ <code>Symbol.iterator</code>Â æ–¹æ³•çš„å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨ for...ofï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. æ•°ç»„</span>
<span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-comment">// 2. å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">const</span> str = <span class="hljs-string">"abc"</span>;

<span class="hljs-comment">// 3. Map</span>
<span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>]]);

<span class="hljs-comment">// 4. Set</span>
<span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]);

<span class="hljs-comment">// 5. NodeList (DOMå…ƒç´ é›†åˆ)</span>
<span class="hljs-keyword">const</span> nodeList = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'div'</span>);

<span class="hljs-comment">// 6. Arguments å¯¹è±¡</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> arg <span class="hljs-keyword">of</span> <span class="hljs-variable language_">arguments</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg);
  }
}

<span class="hljs-comment">// 7. TypedArray</span>
<span class="hljs-keyword">const</span> typedArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);

<span class="hljs-comment">// 8. è‡ªå®šä¹‰å¯è¿­ä»£å¯¹è±¡</span>
<span class="hljs-keyword">const</span> myIterable = {
  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]: <span class="hljs-keyword">function</span>* () {
    <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>;
    <span class="hljs-keyword">yield</span> <span class="hljs-number">3</span>;
  }
};
</code></pre>
<h2 data-id="heading-12">6.Â <strong>å¦‚ä½•è®©æ™®é€šå¯¹è±¡æ”¯æŒ for...of</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ–¹æ³•1: å®ç° Symbol.iterator</span>
<span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>,
  <span class="hljs-attr">c</span>: <span class="hljs-number">3</span>,
  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]: <span class="hljs-keyword">function</span>* () {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>)) {
      <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>[key];
    }
  }
};

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> obj) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// 1, 2, 3</span>
}

<span class="hljs-comment">// æ–¹æ³•2: ä½¿ç”¨ Object.values() ç­‰è¾…åŠ©æ–¹æ³•</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(obj)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// 1, 2, 3</span>
}
</code></pre>
<h2 data-id="heading-13">7.Â <strong>æ€§èƒ½å¯¹æ¯”</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">1000000</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);

<span class="hljs-comment">// for...of (æœ€å¿«çš„æ–¹å¼ä¹‹ä¸€)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'for...of'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> arr) {
  <span class="hljs-comment">// éå†</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'for...of'</span>);

<span class="hljs-comment">// for...in (æœ€æ…¢)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'for...in'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> index <span class="hljs-keyword">in</span> arr) {
  <span class="hljs-keyword">const</span> value = arr[index];
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'for...in'</span>);

<span class="hljs-comment">// ä¼ ç»Ÿ for å¾ªç¯ (æœ€å¿«)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'for'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) {
  <span class="hljs-keyword">const</span> value = arr[i];
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'for'</span>);
</code></pre>
<h2 data-id="heading-14">æ€»ç»“</h2>
<ul>
<li><strong>ä½¿ç”¨ for...in</strong>Â éå†å¯¹è±¡çš„<strong>å±æ€§å</strong>ï¼Œæ³¨æ„å®ƒä¼šéå†åŸå‹é“¾ï¼Œå¸¸ç”¨äºè°ƒè¯•æˆ–æ“ä½œå¯¹è±¡å±æ€§</li>
<li><strong>ä½¿ç”¨ for...of</strong>Â éå†å¯è¿­ä»£å¯¹è±¡çš„<strong>å€¼</strong>ï¼Œä»£ç æ›´ç®€æ´ï¼Œæ€§èƒ½æ›´å¥½ï¼Œæ˜¯ç°ä»£JavaScriptæ¨èçš„æ–¹å¼</li>
<li><strong>æ•°ç»„éå†</strong>ï¼šä¼˜å…ˆä½¿ç”¨Â <code>for...of</code>ï¼Œé¿å…ä½¿ç”¨Â <code>for...in</code></li>
<li><strong>å¯¹è±¡éå†</strong>ï¼šä½¿ç”¨Â <code>for...in</code>Â æˆ–Â <code>Object.keys/values/entries</code>Â +Â <code>for...of</code></li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æœ€ä½³å®è·µæ€»ç»“</span>
<span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };
<span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-comment">// éå†å¯¹è±¡å±æ€§å</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> obj) {
  <span class="hljs-keyword">if</span> (obj.<span class="hljs-title function_">hasOwnProperty</span>(key)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, obj[key]);
  }
}

<span class="hljs-comment">// æˆ–ä½¿ç”¨ Object.entries + for...of</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value);
}

<span class="hljs-comment">// éå†æ•°ç»„å€¼</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> arr) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨å¡«å……è¡¨æ ¼æ³•-ç»§ç»­åƒé€å®Œå…¨èƒŒåŒ…åŠå…¶å˜å½¢]]></title>    <link>https://juejin.cn/post/7592815497848881215</link>    <guid>https://juejin.cn/post/7592815497848881215</guid>    <pubDate>2026-01-09T01:43:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592815497848881215" data-draft-id="7593139476831879211" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨å¡«å……è¡¨æ ¼æ³•-ç»§ç»­åƒé€å®Œå…¨èƒŒåŒ…åŠå…¶å˜å½¢"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-09T01:43:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨å¡«å……è¡¨æ ¼æ³•-ç»§ç»­åƒé€å®Œå…¨èƒŒåŒ…åŠå…¶å˜å½¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:43:01.000Z" title="Fri Jan 09 2026 01:43:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç”¨å¡«å……è¡¨æ ¼æ³•-ç»§ç»­åƒé€å®Œå…¨èƒŒåŒ…åŠå…¶å˜å½¢</h2>
<p>åŠ¨æ€è§„åˆ’ä¸­çš„ã€Œå®Œå…¨èƒŒåŒ…é—®é¢˜ã€æ˜¯ç®—æ³•å­¦ä¹ çš„æ ¸å¿ƒè€ƒç‚¹ä¹‹ä¸€ï¼Œå…¶è¡ç”Ÿçš„ã€Œè®¡æ•°ã€æœ€å€¼ã€å¸ƒå°”åˆ¤æ–­ã€ç­‰å˜å½¢é¢˜æ›´æ˜¯é¢‘ç¹å‡ºç°åœ¨é¢è¯•å’Œç®—æ³•ç«èµ›ä¸­ã€‚å¾ˆå¤šåˆå­¦è€…å®¹æ˜“è¢«ã€Œä¸€ç»´ä¼˜åŒ–ã€ã€Œéå†é¡ºåºã€ç­‰ç»†èŠ‚ç»•æ™•ï¼Œæœ¬æ–‡å°†ä¸¥æ ¼éµå¾ªã€Œ5æ­¥ä¸‡èƒ½é’¥åŒ™ã€æ¶æ„ï¼Œä»äºŒç»´DPè§£æ³•å…¥æ‰‹ï¼ˆç›´è§‚å¡«å……è¡¨æ ¼ï¼‰ï¼Œå†åˆ°ä¸€ç»´ä¼˜åŒ–ï¼ˆç©ºé—´å‹ç¼©ï¼‰ï¼Œå¹¶é™„ä¸Šæ¯é“é¢˜çš„LeetCodeé“¾æ¥ï¼Œè®©ä½ å½»åº•åƒé€è¿™ä¸€ç»å…¸é—®é¢˜ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€çº¯å®Œå…¨èƒŒåŒ…åŸå‹ï¼ˆäºŒç»´DPè§£æ³•ï¼‰</h3>
<p>å®Œå…¨èƒŒåŒ…æ˜¯01èƒŒåŒ…çš„æ‰©å±•â€”â€”æ ¸å¿ƒåŒºåˆ«æ˜¯ã€Œæ¯ç§ç‰©å“å¯æ— é™æ¬¡é€‰å–ã€ï¼Œæˆ‘ä»¬å…ˆä»äºŒç»´DPè§£æ³•å…¥æ‰‹ï¼Œå®Œæ•´æ¼”ç¤ºè¡¨æ ¼å¡«å……è¿‡ç¨‹ã€‚</p>
<p>ç¤ºä¾‹ï¼šæœ‰3ç§ç‰©å“ï¼Œé‡é‡æ•°ç»„<code>w = [2,3,4]</code>ï¼Œä»·å€¼æ•°ç»„<code>v = [3,4,5]</code>ï¼ŒèƒŒåŒ…æœ€å¤§å®¹é‡<code>C = 8</code>ï¼Œæ±‚èƒ½æ”¾å…¥èƒŒåŒ…çš„æœ€å¤§ä»·å€¼ï¼ˆé¢„æœŸè¾“å‡ºï¼š12ï¼‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontzhm.github.io%2Fblog-demo%2Fdp3-wq1.html" target="_blank" title="https://frontzhm.github.io/blog-demo/dp3-wq1.html" ref="nofollow noopener noreferrer">è¡¨æ ¼åŠ¨æ€æ¼”ç¤º</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/385d4a1c653c4e52bd80443c2b22330e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aKc6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527781&amp;x-signature=cTBGlW9Ex8ZjFiA4LgbdkuQBTZE%3D" alt="dpw-1.gif" loading="lazy"/></p>
<h4 data-id="heading-2">1.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰äºŒç»´æ•°ç»„<code>dp[i][j]</code>ï¼šè¡¨ç¤ºã€Œå‰iä¸ªç‰©å“æ”¾å…¥å®¹é‡ä¸ºjçš„èƒŒåŒ…ä¸­ï¼Œèƒ½è·å¾—çš„æœ€å¤§ä»·å€¼ã€ï¼ˆç‰©å“å¯æ— é™é€‰ï¼‰ã€‚</p>
<p>å¯¹åº”è¡¨æ ¼ç»´åº¦ï¼šiï¼ˆè¡Œï¼‰è¡¨ç¤ºç‰©å“æ•°é‡ï¼ˆä»0åˆ°3ï¼Œ0ä»£è¡¨æ— ç‰©å“ï¼‰ï¼Œjï¼ˆåˆ—ï¼‰è¡¨ç¤ºèƒŒåŒ…å®¹é‡ï¼ˆä»0åˆ°8ï¼Œ0ä»£è¡¨å®¹é‡ä¸º0ï¼‰ï¼Œè¡¨æ ¼å…±4è¡Œ9åˆ—ï¼ˆi:0-3ï¼Œj:0-8ï¼‰ã€‚</p>
<h4 data-id="heading-3">1.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºç¬¬iä¸ªç‰©å“ï¼ˆé‡é‡<code>w[i-1]</code>ã€ä»·å€¼<code>v[i-1]</code>ï¼Œæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼Œiä»1å¼€å§‹ï¼‰ï¼Œæœ‰ä¸¤ç§æ ¸å¿ƒå†³ç­–ï¼šé€‰æˆ–ä¸é€‰ã€‚</p>
<ol>
<li>
<p><strong>ä¸é€‰ç¬¬iä¸ªç‰©å“</strong>ï¼šå‰iä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼ = å‰i-1ä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼ï¼Œå³<code>dp[i][j] = dp[i-1][j]</code>ï¼›</p>
</li>
<li>
<p><strong>é€‰ç¬¬iä¸ªç‰©å“</strong>ï¼šéœ€ä¿è¯èƒŒåŒ…å®¹é‡j â‰¥ ç¬¬iä¸ªç‰©å“çš„é‡é‡ï¼Œæ­¤æ—¶æœ€å¤§ä»·å€¼ = å‰iä¸ªç‰©å“æ”¾å…¥å®¹é‡j-w[i-1]çš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼ + ç¬¬iä¸ªç‰©å“çš„ä»·å€¼ï¼ˆåŒºåˆ«äº01èƒŒåŒ…çš„æ ¸å¿ƒï¼šé€‰åä»èƒ½é€‰å½“å‰ç‰©å“ï¼Œä¾èµ–æœ¬è¡Œå‰åºç»“æœï¼‰ï¼Œå³<code>dp[i][j] = dp[i][j - w[i-1]] + v[i-1]</code>ã€‚</p>
</li>
</ol>
<p>æœ€ç»ˆé€’æ¨å…¬å¼ï¼ˆå–ä¸¤ç§å†³ç­–çš„æœ€å¤§å€¼ï¼‰ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-keyword">if</span> (j &lt; w[i - <span class="hljs-number">1</span>]) {
  <span class="hljs-comment">// å®¹é‡ä¸è¶³ï¼Œæ— æ³•é€‰ç¬¬iä¸ªç‰©å“</span>
  dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// å®¹é‡å……è¶³ï¼Œé€‰æˆ–ä¸é€‰å–æœ€å¤§å€¼ï¼ˆé€‰åˆ™ä¾èµ–æœ¬è¡Œç»“æœï¼Œæ”¯æŒæ— é™é€‰ï¼‰</span>
  dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i - <span class="hljs-number">1</span>][j], dp[i][j - w[i - <span class="hljs-number">1</span>]] + v[i - <span class="hljs-number">1</span>]);
}
</code></pre>
<p>è¿™æ˜¯å®Œå…¨èƒŒåŒ…ä¸01èƒŒåŒ…çš„æ ¸å¿ƒå·®å¼‚ï¼š01èƒŒåŒ…é€‰åä¾èµ–<code>i-1</code>è¡Œï¼Œå®Œå…¨èƒŒåŒ…é€‰åä¾èµ–<code>i</code>è¡Œï¼Œå› æ­¤æ”¯æŒã€Œæ— é™æ¬¡é€‰å–åŒä¸€ç‰©å“ã€ã€‚</p>
<h4 data-id="heading-4">1.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<p>åˆå§‹åŒ–æ ¸å¿ƒæ˜¯ç¡®å®šè¡¨æ ¼çš„â€œè¾¹ç•Œæ¡ä»¶â€ï¼Œå³æ— éœ€æ¨å¯¼å°±èƒ½ç›´æ¥ç¡®å®šçš„å•å…ƒæ ¼å€¼ï¼š</p>
<ol>
<li>
<p><strong>i=0ï¼ˆæ— ç‰©å“ï¼‰</strong>ï¼šæ— è®ºèƒŒåŒ…å®¹é‡jå¤šå¤§ï¼Œæ”¾å…¥0ä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼éƒ½æ˜¯0ï¼Œå› æ­¤<code>dp[0][j] = 0</code>ï¼ˆè¡¨æ ¼ç¬¬0è¡Œå…¨ä¸º0ï¼‰ï¼›</p>
</li>
<li>
<p><strong>j=0ï¼ˆå®¹é‡ä¸º0ï¼‰</strong>ï¼šæ— è®ºæœ‰å¤šå°‘ç‰©å“ï¼Œéƒ½æ— æ³•æ”¾å…¥èƒŒåŒ…ï¼Œæœ€å¤§ä»·å€¼éƒ½æ˜¯0ï¼Œå› æ­¤<code>dp[i][0] = 0</code>ï¼ˆè¡¨æ ¼ç¬¬0åˆ—å…¨ä¸º0ï¼‰ã€‚</p>
</li>
</ol>
<p>åˆå§‹åŒ–åçš„è¡¨æ ¼ï¼ˆç¬¬0è¡Œã€ç¬¬0åˆ—å·²å¡«å……ï¼‰ï¼š</p>

































































<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>0ï¼ˆæ— ç‰©å“ï¼‰</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1ï¼ˆç‰©å“1ï¼šw=2,v=3ï¼‰</td><td>0</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>2ï¼ˆç‰©å“2ï¼šw=3,v=4ï¼‰</td><td>0</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>3ï¼ˆç‰©å“3ï¼šw=4,v=5ï¼‰</td><td>0</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr></tbody></table>
<h4 data-id="heading-5">1.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</h4>
<p>å®Œå…¨èƒŒåŒ…äºŒç»´è§£æ³•çš„éå†é¡ºåºä¸01èƒŒåŒ…ä¸€è‡´ï¼Œæœ‰ä¸¤ç§å¯è¡Œæ–¹å¼ï¼š</p>
<ol>
<li>
<p><strong>å…ˆéå†ç‰©å“ï¼ˆiä»1åˆ°nï¼‰ï¼Œå†éå†å®¹é‡ï¼ˆjä»1åˆ°Cï¼‰</strong>ï¼šé€è¡Œå¡«å……è¡¨æ ¼ï¼Œå…ˆå¡«å®Œç¬¬1ä¸ªç‰©å“å¯¹åº”çš„æ‰€æœ‰å®¹é‡ï¼ˆç¬¬1è¡Œï¼‰ï¼Œå†å¡«ç¬¬2ä¸ªç‰©å“å¯¹åº”çš„æ‰€æœ‰å®¹é‡ï¼ˆç¬¬2è¡Œï¼‰ï¼Œç›´åˆ°å¡«å®Œæ‰€æœ‰ç‰©å“ï¼›</p>
</li>
<li>
<p><strong>å…ˆéå†å®¹é‡ï¼ˆjä»1åˆ°Cï¼‰ï¼Œå†éå†ç‰©å“ï¼ˆiä»1åˆ°nï¼‰</strong>ï¼šé€åˆ—å¡«å……è¡¨æ ¼ï¼Œå…ˆå¡«å®Œå®¹é‡1å¯¹åº”çš„æ‰€æœ‰ç‰©å“æ•°é‡ï¼ˆç¬¬1åˆ—ï¼‰ï¼Œå†å¡«å®¹é‡2å¯¹åº”çš„æ‰€æœ‰ç‰©å“æ•°é‡ï¼ˆç¬¬2åˆ—ï¼‰ã€‚</p>
</li>
</ol>
<p>ä¸¤ç§é¡ºåºéƒ½å¯è¡Œï¼Œå› ä¸ºè®¡ç®—<code>dp[i][j]</code>æ—¶ï¼Œä»…ä¾èµ–ã€Œä¸Šä¸€è¡ŒåŒåˆ—ã€æˆ–ã€Œæœ¬è¡Œå·¦ä¾§åˆ—ã€çš„ç»“æœï¼Œè¿™ä¸¤ä¸ªä½ç½®éƒ½å·²æå‰å¡«å……ã€‚å®é™…è§£é¢˜ä¸­æ›´å¸¸ç”¨ã€Œå…ˆéå†ç‰©å“ï¼Œå†éå†å®¹é‡ã€çš„é¡ºåºï¼Œç¬¦åˆã€Œé€ä¸ªè€ƒè™‘ç‰©å“æ˜¯å¦æ”¾å…¥ã€çš„æ€è€ƒé€»è¾‘ã€‚</p>
<h4 data-id="heading-6">1.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>é€šè¿‡é€æ­¥å¡«å……è¡¨æ ¼ã€æ‰“å°ä¸­é—´çŠ¶æ€ï¼ŒéªŒè¯æ¯ä¸€æ­¥æ˜¯å¦ç¬¦åˆé€’æ¨è§„åˆ™ï¼š</p>
<h5 data-id="heading-7">1.5.1 å¡«å……ç¬¬1è¡Œï¼ˆi=1ï¼Œç‰©å“1ï¼šw=2,v=3ï¼‰</h5>
<p>å¡«å……åç¬¬1è¡Œï¼š[0,0,3,3,6,6,9,9,12]</p>
<ul>
<li>
<p>j=1ï¼šå®¹é‡&lt;2ï¼Œæ— æ³•é€‰ï¼Œdp[1][1] = dp[0][1] = 0ï¼›</p>
</li>
<li>
<p>j=2ï¼šå®¹é‡â‰¥2ï¼Œé€‰åˆ™dp[1][0]+3=3ï¼Œä¸é€‰åˆ™0ï¼Œå–max=3ï¼›</p>
</li>
<li>
<p>j=3ï¼šé€‰åˆ™dp[1][1]+3=3ï¼Œä¸é€‰åˆ™0ï¼Œå–max=3ï¼›</p>
</li>
<li>
<p>j=4ï¼šé€‰åˆ™dp[1][2]+3=6ï¼Œä¸é€‰åˆ™0ï¼Œå–max=6ï¼›</p>
</li>
<li>
<p>j=5ï¼šé€‰åˆ™dp[1][3]+3=6ï¼Œä¸é€‰åˆ™0ï¼Œå–max=6ï¼›</p>
</li>
<li>
<p>j=6ï¼šé€‰åˆ™dp[1][4]+3=9ï¼Œä¸é€‰åˆ™0ï¼Œå–max=9ï¼›</p>
</li>
<li>
<p>j=7ï¼šé€‰åˆ™dp[1][5]+3=9ï¼Œä¸é€‰åˆ™0ï¼Œå–max=9ï¼›</p>
</li>
<li>
<p>j=8ï¼šé€‰åˆ™dp[1][6]+3=12ï¼Œä¸é€‰åˆ™0ï¼Œå–max=12ï¼›</p>
</li>
</ul>
<h5 data-id="heading-8">1.5.2 å¡«å……ç¬¬2è¡Œï¼ˆi=2ï¼Œç‰©å“2ï¼šw=3,v=4ï¼‰</h5>
<p>å¡«å……åç¬¬2è¡Œï¼š[0,0,3,4,6,7,9,10,12]</p>
<ul>
<li>
<p>j=1-2ï¼šå®¹é‡&lt;3ï¼Œdp[2][j] = dp[1][j]ï¼ˆ0,3ï¼‰ï¼›</p>
</li>
<li>
<p>j=3ï¼šé€‰åˆ™dp[2][0]+4=4ï¼Œä¸é€‰åˆ™3ï¼Œå–max=4ï¼›</p>
</li>
<li>
<p>j=4ï¼šé€‰åˆ™dp[2][1]+4=4ï¼Œä¸é€‰åˆ™6ï¼Œå–max=6ï¼›</p>
</li>
<li>
<p>j=5ï¼šé€‰åˆ™dp[2][2]+4=3+4=7ï¼Œä¸é€‰åˆ™6ï¼Œå–max=7ï¼›</p>
</li>
<li>
<p>j=6ï¼šé€‰åˆ™dp[2][3]+4=4+4=8ï¼Œä¸é€‰åˆ™9ï¼Œå–max=9ï¼›</p>
</li>
<li>
<p>j=7ï¼šé€‰åˆ™dp[2][4]+4=6+4=10ï¼Œä¸é€‰åˆ™9ï¼Œå–max=10ï¼›</p>
</li>
<li>
<p>j=8ï¼šé€‰åˆ™dp[2][5]+4=7+4=11ï¼Œä¸é€‰åˆ™12ï¼Œå–max=12ï¼›</p>
</li>
</ul>
<h5 data-id="heading-9">1.5.3 å¡«å……ç¬¬3è¡Œï¼ˆi=3ï¼Œç‰©å“3ï¼šw=4,v=5ï¼‰</h5>
<p>å¡«å……åç¬¬3è¡Œï¼š[0,0,3,4,6,7,9,10,12]</p>
<ul>
<li>
<p>j=1-3ï¼šå®¹é‡&lt;4ï¼Œdp[3][j] = dp[2][j]ï¼ˆ0,3,4ï¼‰ï¼›</p>
</li>
<li>
<p>j=4ï¼šé€‰åˆ™dp[3][0]+5=5ï¼Œä¸é€‰åˆ™6ï¼Œå–max=6ï¼›</p>
</li>
<li>
<p>j=5ï¼šé€‰åˆ™dp[3][1]+5=5ï¼Œä¸é€‰åˆ™7ï¼Œå–max=7ï¼›</p>
</li>
<li>
<p>j=6ï¼šé€‰åˆ™dp[3][2]+5=3+5=8ï¼Œä¸é€‰åˆ™9ï¼Œå–max=9ï¼›</p>
</li>
<li>
<p>j=7ï¼šé€‰åˆ™dp[3][3]+5=4+5=9ï¼Œä¸é€‰åˆ™10ï¼Œå–max=10ï¼›</p>
</li>
<li>
<p>j=8ï¼šé€‰åˆ™dp[3][4]+5=6+5=11ï¼Œä¸é€‰åˆ™12ï¼Œå–max=12ï¼›</p>
</li>
</ul>
<p>æœ€ç»ˆå¡«å……å®Œæˆçš„è¡¨æ ¼ï¼š</p>

































































<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>0ï¼ˆæ— ç‰©å“ï¼‰</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1ï¼ˆç‰©å“1ï¼šw=2,v=3ï¼‰</td><td>0</td><td>0</td><td>3</td><td>3</td><td>6</td><td>6</td><td>9</td><td>9</td><td>12</td></tr><tr><td>2ï¼ˆç‰©å“2ï¼šw=3,v=4ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>6</td><td>7</td><td>9</td><td>10</td><td>12</td></tr><tr><td>3ï¼ˆç‰©å“3ï¼šw=4,v=5ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>6</td><td>7</td><td>9</td><td>10</td><td>12</td></tr></tbody></table>
<p>è¡¨æ ¼å³ä¸‹è§’<code>dp[3][8] = 12</code>ï¼Œä¸é¢„æœŸç»“æœä¸€è‡´ï¼ˆé€‰4ä¸ªé‡é‡ä¸º2çš„ç‰©å“ï¼Œä»·å€¼3Ã—4=12ï¼‰ã€‚</p>
<h4 data-id="heading-10">1.6 çº¯å®Œå…¨èƒŒåŒ…äºŒç»´DPå®Œæ•´ä»£ç ï¼ˆJavaScriptï¼‰</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * çº¯å®Œå…¨èƒŒåŒ…åŸå‹ï¼ˆäºŒç»´DPè§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">w</span> - ç‰©å“é‡é‡æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">v</span> - ç‰©å“ä»·å€¼æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">c</span> - èƒŒåŒ…æœ€å¤§å®¹é‡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - èƒŒåŒ…èƒ½å®¹çº³çš„æœ€å¤§ä»·å€¼
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">completeKnapsack_2d</span>(<span class="hljs-params">w, v, c</span>) {
  <span class="hljs-keyword">const</span> n = w.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// 1. åˆå§‹åŒ–äºŒç»´dpæ•°ç»„ï¼šdp[i][j]è¡¨ç¤ºå‰iä¸ªç‰©å“æ”¾å…¥å®¹é‡jçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(n + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(c + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));

  <span class="hljs-comment">// 2. éå†é¡ºåºï¼šå…ˆéå†ç‰©å“ï¼ˆiä»1åˆ°nï¼‰ï¼Œå†éå†å®¹é‡ï¼ˆjä»1åˆ°cï¼‰ï¼ˆé€è¡Œå¡«å……ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= c; j++) {
      <span class="hljs-comment">// 3. é€’æ¨å…¬å¼ï¼šå®¹é‡ä¸è¶³åˆ™ä¸é€‰ï¼Œå®¹é‡å……è¶³åˆ™é€‰æˆ–ä¸é€‰å–æœ€å¤§å€¼ï¼ˆé€‰åˆ™ä¾èµ–æœ¬è¡Œï¼‰</span>
      <span class="hljs-keyword">if</span> (j &lt; w[i - <span class="hljs-number">1</span>]) {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
      } <span class="hljs-keyword">else</span> {
        dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i - <span class="hljs-number">1</span>][j], dp[i][j - w[i - <span class="hljs-number">1</span>]] + v[i - <span class="hljs-number">1</span>]);
      }
    }
  }

  <span class="hljs-comment">// æ‰“å°å®Œæ•´dpæ•°ç»„ï¼ˆè¡¨æ ¼ï¼‰éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çº¯å®Œå…¨èƒŒåŒ…äºŒç»´DPæ•°ç»„ï¼ˆè¡¨æ ¼ï¼‰ï¼š'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= n; i++) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dp[i].<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>));
  }

  <span class="hljs-comment">// æœ€ç»ˆç­”æ¡ˆï¼šå‰nä¸ªç‰©å“æ”¾å…¥å®¹é‡cçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼</span>
  <span class="hljs-keyword">return</span> dp[n][c];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">const</span> w = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];
<span class="hljs-keyword">const</span> v = [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> c = <span class="hljs-number">8</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€å¤§ä»·å€¼ï¼š'</span>, <span class="hljs-title function_">completeKnapsack_2d</span>(w, v, c)); <span class="hljs-comment">// è¾“å‡ºï¼š12</span>
</code></pre>
<h4 data-id="heading-11">1.7 ä¸€ç»´DPä¼˜åŒ–ï¼ˆç©ºé—´å‹ç¼©ï¼‰</h4>
<p>å®Œå…¨èƒŒåŒ…çš„ä¸€ç»´DPä¼˜åŒ–æ ¸å¿ƒæ˜¯ã€Œæ­£åºéå†å®¹é‡ã€ï¼ˆåŒºåˆ«äº01èƒŒåŒ…çš„é€†åºï¼‰ï¼Œå¤ç”¨æœ¬è¡Œå‰åºç»“æœå®ç°ã€Œæ— é™é€‰ã€ã€‚å…¶ä¼˜åŒ–æ€è·¯å¹¶éå‡­ç©ºè®¾è®¡ï¼Œè€Œæ˜¯åŸºäºäºŒç»´DPè§£æ³•çš„çŠ¶æ€ä¾èµ–é€»è¾‘è¿›è¡Œç©ºé—´å‹ç¼©ï¼Œå…·ä½“å¯æ‹†è§£ä¸ºä»¥ä¸‹3ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
<h5 data-id="heading-12">1. ä¼˜åŒ–åŸºç¡€ï¼šæ˜ç¡®äºŒç»´DPçš„çŠ¶æ€ä¾èµ–ç‰¹æ€§</h5>
<p>åœ¨çº¯å®Œå…¨èƒŒåŒ…çš„äºŒç»´DPè§£æ³•ä¸­ï¼Œé€’æ¨å…¬å¼ä¸ºï¼šå½“å®¹é‡j â‰¥ ç‰©å“é‡é‡w[i-1]æ—¶ï¼Œdp[i][j] = max(dp[i-1][j], dp[i]j - w[i-1]] + v[i-1])ã€‚è§‚å¯Ÿè¯¥å…¬å¼å¯å‘ç°ï¼Œè®¡ç®—ç¬¬iè¡Œçš„dp[i][j]æ—¶ï¼Œä»…ä¾èµ–ä¸¤ä¸ªä½ç½®çš„çŠ¶æ€ï¼šâ‘  ä¸Šä¸€è¡ŒåŒåˆ—çš„dp[i-1][j]ï¼ˆä¸é€‰å½“å‰ç‰©å“çš„æƒ…å†µï¼‰ï¼›â‘¡ æœ¬è¡Œå·¦ä¾§åˆ—çš„dp[i]j - w[i-1]]ï¼ˆé€‰å½“å‰ç‰©å“çš„æƒ…å†µï¼‰ã€‚</p>
<p>è¿™ä¸€ä¾èµ–ç‰¹æ€§æ„å‘³ç€ï¼Œæˆ‘ä»¬æ— éœ€ä¿ç•™å®Œæ•´çš„äºŒç»´æ•°ç»„ã€‚å› ä¸ºè®¡ç®—ç¬¬iè¡Œæ•°æ®æ—¶ï¼Œä»…éœ€ç”¨åˆ°ä¸Šä¸€è¡Œçš„â€œå†å²æ•°æ®â€å’Œæœ¬è¡Œå·²è®¡ç®—å‡ºçš„â€œå‰åºæ•°æ®â€ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªä¸€ç»´æ•°ç»„æ»šåŠ¨å­˜å‚¨è¿™äº›çŠ¶æ€ï¼Œä»è€Œå°†ç©ºé—´å¤æ‚åº¦ä»O(nÃ—c)ä¼˜åŒ–ä¸ºO(c)ï¼ˆnä¸ºç‰©å“æ•°é‡ï¼Œcä¸ºèƒŒåŒ…å®¹é‡ï¼‰ã€‚</p>
<h5 data-id="heading-13">2. æ ¸å¿ƒè®¾è®¡ï¼šæ­£åºéå†å®¹é‡å®ç°â€œæ— é™é€‰â€</h5>
<p>ä¸€ç»´DPæ•°ç»„çš„å®šä¹‰ä¸ºdp[j]ï¼Œè¡¨ç¤ºâ€œå®¹é‡ä¸ºjçš„èƒŒåŒ…èƒ½å®¹çº³çš„æœ€å¤§ä»·å€¼â€ï¼Œå¯¹åº”äºŒç»´æ•°ç»„ä¸­å½“å‰è¡Œçš„dp[i][j]ã€‚ä¸ºäº†å®ç°å®Œå…¨èƒŒåŒ…â€œç‰©å“å¯æ— é™é€‰å–â€çš„ç‰¹æ€§ï¼Œå†…å±‚å®¹é‡éå†å¿…é¡»é‡‡ç”¨ã€Œæ­£åºã€ï¼ˆä»curWåˆ°cï¼ŒcurWä¸ºå½“å‰ç‰©å“é‡é‡ï¼‰ï¼Œå…·ä½“åŸå› å¦‚ä¸‹ï¼š</p>
<p>å½“æ­£åºéå†å®¹é‡æ—¶ï¼Œè®¡ç®—dp[j]æ—¶ï¼Œdp[j - curW]å·²ç»æ˜¯æœ¬æ¬¡éå†ç‰©å“iæ—¶æ›´æ–°è¿‡çš„â€œæœ¬è¡Œå‰åºç»“æœâ€ï¼ˆè€Œéä¸Šä¸€è½®ç‰©å“i-1çš„å†å²ç»“æœï¼‰ã€‚ä¾‹å¦‚ï¼Œéå†ç‰©å“1ï¼ˆw=2,v=3ï¼‰æ—¶ï¼Œå…ˆè®¡ç®—dp[2] = dp[0]+3=3ï¼›ç»§ç»­éå†j=4æ—¶ï¼Œdp[4] = dp[2]+3=6ï¼Œæ­¤æ—¶å¤ç”¨çš„dp[2]æ˜¯å·²çº³å…¥ç‰©å“1çš„ç»“æœï¼Œç›¸å½“äºåœ¨èƒŒåŒ…ä¸­å†æ¬¡æ”¾å…¥äº†ç‰©å“1ï¼Œå®ç°äº†â€œæ— é™é€‰â€çš„æ•ˆæœã€‚</p>
<p>è¿™é‡Œéœ€è¦ç‰¹åˆ«åŒºåˆ†ä¸01èƒŒåŒ…çš„å·®å¼‚ï¼š01èƒŒåŒ…è¦æ±‚ç‰©å“åªèƒ½é€‰ä¸€æ¬¡ï¼Œå› æ­¤å†…å±‚éœ€é€†åºéå†å®¹é‡ï¼Œç¡®ä¿dp[j - curW]ä½¿ç”¨çš„æ˜¯ä¸Šä¸€è½®çš„å†å²æ•°æ®ï¼ˆæœªçº³å…¥å½“å‰ç‰©å“ï¼‰ï¼›è€Œå®Œå…¨èƒŒåŒ…çš„æ­£åºéå†ï¼Œæ­£æ˜¯é€šè¿‡å¤ç”¨æœ¬è½®å·²æ›´æ–°çš„æ•°æ®ï¼Œè¾¾æˆâ€œé‡å¤é€‰å–å½“å‰ç‰©å“â€çš„æ ¸å¿ƒéœ€æ±‚ã€‚</p>
<h5 data-id="heading-14">3. éå†é€»è¾‘ï¼šå¤–å±‚ç‰©å“ã€å†…å±‚å®¹é‡çš„å›ºå®šé¡ºåº</h5>
<p>ä¸€ç»´DPçš„éå†é¡ºåºå¿…é¡»æ˜¯ã€Œå¤–å±‚éå†ç‰©å“ï¼Œå†…å±‚æ­£åºéå†å®¹é‡ã€ã€‚å¤–å±‚éå†ç‰©å“ä¿è¯æ¯ä¸ªç‰©å“éƒ½è¢«è€ƒè™‘åˆ°ï¼Œå†…å±‚æ­£åºéå†å®¹é‡åˆ™ä¿è¯æ¯ä¸ªç‰©å“å¯ä»¥è¢«å¤šæ¬¡é€‰å–ã€‚è‹¥é¢ å€’éå†é¡ºåºï¼ˆå¤–å±‚å®¹é‡ã€å†…å±‚ç‰©å“ï¼‰ï¼Œä¼šå¯¼è‡´åŒä¸€å®¹é‡ä¸‹å¤šæ¬¡é‡å¤è®¡ç®—åŒä¸€ç‰©å“çš„è´¡çŒ®ï¼Œæœ€ç»ˆç»“æœé”™è¯¯ï¼ˆç›¸å½“äºå˜æˆäº†æ’åˆ—æ•°é—®é¢˜ï¼Œè€ŒéèƒŒåŒ…æœ€å€¼é—®é¢˜ï¼‰ã€‚</p>
<p>å…·ä½“éå†æµç¨‹ï¼šâ‘  åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ä¸ºå…¨0ï¼ˆå¯¹åº”äºŒç»´æ•°ç»„ç¬¬0è¡Œçš„è¾¹ç•Œæ¡ä»¶ï¼Œæ— ç‰©å“æ—¶æ‰€æœ‰å®¹é‡çš„æœ€å¤§ä»·å€¼ä¸º0ï¼‰ï¼›â‘¡ é€ä¸ªéå†æ¯ä¸ªç‰©å“ï¼Œè·å–å½“å‰ç‰©å“çš„é‡é‡curWå’Œä»·å€¼curVï¼›â‘¢ å¯¹æ¯ä¸ªç‰©å“ï¼Œæ­£åºéå†å®¹é‡ä»curWåˆ°cï¼Œé€šè¿‡dp[j] = max(dp[j], dp[j - curW] + curV)æ›´æ–°çŠ¶æ€ï¼›â‘£ æ‰€æœ‰ç‰©å“éå†å®Œæˆåï¼Œdp[c]å³ä¸ºæœ€ç»ˆç­”æ¡ˆã€‚</p>
<h5 data-id="heading-15">4. ä¸äºŒç»´è§£æ³•çš„ç»“æœä¸€è‡´æ€§éªŒè¯</h5>
<p>ä»¥ç¤ºä¾‹ä¸­çš„ç‰©å“ï¼ˆw=[2,3,4], v=[3,4,5]ï¼‰å’Œå®¹é‡c=8ä¸ºä¾‹ï¼Œä¸€ç»´DPçš„è®¡ç®—è¿‡ç¨‹ä¸äºŒç»´æ•°ç»„çš„å¡«å……è¿‡ç¨‹å®Œå…¨åŒ¹é…ï¼š</p>
<p>éå†ç‰©å“1ï¼ˆw=2,v=3ï¼‰æ—¶ï¼Œæ­£åºæ›´æ–°dp[2]~dp[8]ï¼Œå¾—åˆ°dp=[0,0,3,3,6,6,9,9,12]ï¼ˆå¯¹åº”äºŒç»´æ•°ç»„ç¬¬1è¡Œï¼‰ï¼›éå†ç‰©å“2ï¼ˆw=3,v=4ï¼‰æ—¶ï¼Œæ­£åºæ›´æ–°dp[3]~dp[8]ï¼Œå¾—åˆ°dp=[0,0,3,4,6,7,9,10,12]ï¼ˆå¯¹åº”äºŒç»´æ•°ç»„ç¬¬2è¡Œï¼‰ï¼›éå†ç‰©å“3ï¼ˆw=4,v=5ï¼‰æ—¶ï¼Œæ­£åºæ›´æ–°dp[4]~dp[8]ï¼Œæœ€ç»ˆdp=[0,0,3,4,6,7,9,10,12]ï¼ˆå¯¹åº”äºŒç»´æ•°ç»„ç¬¬3è¡Œï¼‰ï¼Œdp[8]=12ä¸äºŒç»´è§£æ³•ç»“æœä¸€è‡´ï¼ŒéªŒè¯äº†ä¼˜åŒ–æ€è·¯çš„æ­£ç¡®æ€§ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * çº¯å®Œå…¨èƒŒåŒ…åŸå‹ï¼ˆä¸€ç»´DPä¼˜åŒ–ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">w</span> - ç‰©å“é‡é‡æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">v</span> - ç‰©å“ä»·å€¼æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">c</span> - èƒŒåŒ…æœ€å¤§å®¹é‡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - èƒŒåŒ…èƒ½å®¹çº³çš„æœ€å¤§ä»·å€¼
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">completeKnapsack_1d</span>(<span class="hljs-params">w, v, c</span>) {
  <span class="hljs-comment">// 1. åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]è¡¨ç¤ºå®¹é‡ä¸ºjçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(c + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// 2. éå†é¡ºåºï¼šå¤–å±‚ç‰©å“ï¼Œå†…å±‚æ­£åºéå†å®¹é‡ï¼ˆå…è®¸é‡å¤é€‰ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; w.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> curW = w[i];
    <span class="hljs-keyword">const</span> curV = v[i];
    <span class="hljs-comment">// æ­£åºéå†ï¼šå¤ç”¨æœ¬è¡Œå‰åºç»“æœï¼Œå®ç°æ— é™é€‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = curW; j &lt;= c; j++) {
      dp[j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[j], dp[j - curW] + curV);
    }
  }

  <span class="hljs-comment">// æ‰“å°ä¸€ç»´dpæ•°ç»„éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çº¯å®Œå…¨èƒŒåŒ…ä¸€ç»´DPæ•°ç»„ï¼š'</span>, dp);

  <span class="hljs-comment">// æœ€ç»ˆç­”æ¡ˆï¼šå®¹é‡cçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼</span>
  <span class="hljs-keyword">return</span> dp[c];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸€ç»´ä¼˜åŒ–ç‰ˆæœ€å¤§ä»·å€¼ï¼š'</span>, <span class="hljs-title function_">completeKnapsack_1d</span>(w, v, c)); <span class="hljs-comment">// è¾“å‡ºï¼š12</span>
</code></pre>
<h3 data-id="heading-16">äºŒã€å®Œå…¨èƒŒåŒ…å˜å½¢1ï¼šæœ€å€¼ç±»ï¼ˆå®Œå…¨å¹³æ–¹æ•°ï¼‰</h3>
<p>LeetCodeé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fperfect-squares%2F" target="_blank" title="https://leetcode.cn/problems/perfect-squares/" ref="nofollow noopener noreferrer">leetcode.cn/problems/peâ€¦</a></p>
<h4 data-id="heading-17">é¢˜ç›®æè¿°</h4>
<p>ç»™å®šæ­£æ•´æ•° <code>n</code>ï¼Œæ‰¾åˆ°è‹¥å¹²å®Œå…¨å¹³æ–¹æ•°ï¼ˆ1,4,9...ï¼‰ä½¿å…¶å’Œç­‰äº <code>n</code>ï¼Œè¦æ±‚ä¸ªæ•°æœ€å°‘ã€‚</p>
<p>ç¤ºä¾‹ï¼š<code>n=12</code> â†’ è¾“å‡º3ï¼ˆ12=4+4+4ï¼‰ï¼›<code>n=13</code> â†’ è¾“å‡º2ï¼ˆ13=4+9ï¼‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontzhm.github.io%2Fblog-demo%2Fdp3-wq2.html" target="_blank" title="https://frontzhm.github.io/blog-demo/dp3-wq2.html" ref="nofollow noopener noreferrer">è¡¨æ ¼åŠ¨æ€æ¼”ç¤º</a></p>
<h4 data-id="heading-18">2.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰äºŒç»´æ•°ç»„<code>dp[i][j]</code>ï¼šè¡¨ç¤ºã€Œå‰iä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼ˆ1Â²,2Â²,...,iÂ²ï¼‰å‡‘å‡ºå’Œä¸ºjçš„æœ€å°‘ä¸ªæ•°ã€ã€‚</p>
<p>å¯¹åº”è¡¨æ ¼ç»´åº¦ï¼šiï¼ˆè¡Œï¼‰è¡¨ç¤ºå®Œå…¨å¹³æ–¹æ•°çš„ä¸ªæ•°ï¼ˆä»0åˆ°mï¼Œm=Math.floor(Math.sqrt(n))ï¼‰ï¼Œjï¼ˆåˆ—ï¼‰è¡¨ç¤ºç›®æ ‡å’Œï¼ˆä»0åˆ°nï¼‰ã€‚</p>
<h4 data-id="heading-19">2.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºç¬¬iä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼ˆå€¼<code>curPow = iÂ²</code>ï¼‰ï¼Œæœ‰ä¸¤ç§å†³ç­–ï¼šé€‰æˆ–ä¸é€‰ï¼š</p>
<ol>
<li>
<p><strong>ä¸é€‰ç¬¬iä¸ªå®Œå…¨å¹³æ–¹æ•°</strong>ï¼š<code>dp[i][j] = dp[i-1][j]</code>ï¼›</p>
</li>
<li>
<p><strong>é€‰ç¬¬iä¸ªå®Œå…¨å¹³æ–¹æ•°</strong>ï¼šéœ€ä¿è¯j â‰¥ curPowï¼Œæ­¤æ—¶<code>dp[i][j] = dp[i][j - curPow] + 1</code>ï¼ˆé€‰åä»èƒ½é€‰å½“å‰æ•°ï¼Œ+1è¡¨ç¤ºä¸ªæ•°åŠ 1ï¼‰ã€‚</p>
</li>
</ol>
<p>æœ€ç»ˆé€’æ¨å…¬å¼ï¼ˆå–ä¸¤ç§å†³ç­–çš„æœ€å°å€¼ï¼‰ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-keyword">if</span> (j &lt; curPow) {
  dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
} <span class="hljs-keyword">else</span> {
  dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(dp[i - <span class="hljs-number">1</span>][j], dp[i][j - curPow] + <span class="hljs-number">1</span>);
}
</code></pre>
<h4 data-id="heading-20">2.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<p>æœ€å€¼ç±»é—®é¢˜åˆå§‹åŒ–æ ¸å¿ƒæ˜¯ã€Œé»˜è®¤å€¼è®¾ä¸ºæ— ç©·å¤§ï¼ˆè¡¨ç¤ºä¸å¯è¾¾ï¼‰ï¼Œè¾¹ç•Œè®¾ä¸º0ã€ï¼š</p>
<ol>
<li>
<p><strong>i=0ï¼ˆæ— å®Œå…¨å¹³æ–¹æ•°ï¼‰</strong>ï¼šé™¤j=0å¤–ï¼Œå…¶ä½™<code>dp[0][j] = Infinity</code>ï¼ˆæ— æ•°å­—æ— æ³•å‡‘å‡ºå’Œï¼‰ï¼›</p>
</li>
<li>
<p><strong>j=0ï¼ˆå‡‘0ï¼‰</strong>ï¼šæ‰€æœ‰içš„<code>dp[i][0] = 0</code>ï¼ˆå‡‘0éœ€è¦0ä¸ªæ•°å­—ï¼‰ï¼›</p>
</li>
<li>
<p>å…¶ä½™å•å…ƒæ ¼åˆå§‹åŒ–ä¸º<code>Infinity</code>ï¼ˆé»˜è®¤ä¸å¯è¾¾ï¼‰ã€‚</p>
</li>
</ol>
<h4 data-id="heading-21">2.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåº</h4>
<p>å…ˆéå†å®Œå…¨å¹³æ–¹æ•°ï¼ˆiä»1åˆ°mï¼‰ï¼Œå†éå†ç›®æ ‡å’Œï¼ˆjä»1åˆ°nï¼‰ï¼Œé€è¡Œå¡«å……è¡¨æ ¼ã€‚</p>
<h4 data-id="heading-22">2.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>ä»¥<code>n=12</code>ä¸ºä¾‹ï¼ˆm=3ï¼Œå¯¹åº”1Â²ã€2Â²ã€3Â²ï¼‰ï¼Œæœ€ç»ˆè¡¨æ ¼å³ä¸‹è§’<code>dp[3][12] = 3</code>ï¼Œä¸é¢„æœŸä¸€è‡´ã€‚</p>
<h4 data-id="heading-23">2.6 äºŒç»´DPå®Œæ•´ä»£ç ï¼ˆJavaScriptï¼‰</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * å®Œå…¨å¹³æ–¹æ•°ï¼ˆäºŒç»´DPè§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">n</span> - ç›®æ ‡æ•°
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - æœ€å°‘å®Œå…¨å¹³æ–¹æ•°ä¸ªæ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">numSquares_2d</span>(<span class="hljs-params">n</span>) {
  <span class="hljs-keyword">const</span> m = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(n)); <span class="hljs-comment">// æœ€å¤§å®Œå…¨å¹³æ–¹æ•°çš„åº•æ•°</span>
  <span class="hljs-comment">// 1. åˆå§‹åŒ–äºŒç»´dpæ•°ç»„ï¼šdp[i][j]å‰iä¸ªå®Œå…¨å¹³æ–¹æ•°å‡‘å’Œjçš„æœ€å°‘ä¸ªæ•°ï¼Œé»˜è®¤Infinity</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(m + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(n + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-title class_">Infinity</span>));

  <span class="hljs-comment">// 2. è¾¹ç•Œæ¡ä»¶ï¼šå‡‘0éœ€è¦0ä¸ª</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= m; i++) {
    dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
  }

  <span class="hljs-comment">// 3. éå†é¡ºåºï¼šå…ˆéå†å®Œå…¨å¹³æ–¹æ•°ï¼Œå†éå†ç›®æ ‡å’Œ</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
    <span class="hljs-keyword">const</span> curPow = i * i; <span class="hljs-comment">// ç¬¬iä¸ªå®Œå…¨å¹³æ–¹æ•°</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) {
      <span class="hljs-comment">// 4. é€’æ¨å…¬å¼</span>
      <span class="hljs-keyword">if</span> (j &lt; curPow) {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
      } <span class="hljs-keyword">else</span> {
        dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(dp[i - <span class="hljs-number">1</span>][j], dp[i][j - curPow] + <span class="hljs-number">1</span>);
      }
    }
  }

  <span class="hljs-comment">// æ‰“å°dpæ•°ç»„éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®Œå…¨å¹³æ–¹æ•°äºŒç»´DPæ•°ç»„ï¼š'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= m; i++) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dp[i].<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>));
  }

  <span class="hljs-keyword">return</span> dp[m][n];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€å°‘ä¸ªæ•°ï¼ˆn=12ï¼‰ï¼š'</span>, <span class="hljs-title function_">numSquares_2d</span>(<span class="hljs-number">12</span>)); <span class="hljs-comment">// è¾“å‡ºï¼š3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€å°‘ä¸ªæ•°ï¼ˆn=13ï¼‰ï¼š'</span>, <span class="hljs-title function_">numSquares_2d</span>(<span class="hljs-number">13</span>)); <span class="hljs-comment">// è¾“å‡ºï¼š2</span>
</code></pre>
<h4 data-id="heading-24">2.7 ä¸€ç»´DPä¼˜åŒ–</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * å®Œå…¨å¹³æ–¹æ•°ï¼ˆä¸€ç»´DPä¼˜åŒ–ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">n</span> - ç›®æ ‡æ•°
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - æœ€å°‘å®Œå…¨å¹³æ–¹æ•°ä¸ªæ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">numSquares_1d</span>(<span class="hljs-params">n</span>) {
  <span class="hljs-comment">// 1. åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]å‡‘å’Œjçš„æœ€å°‘ä¸ªæ•°</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(n + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-title class_">Infinity</span>);
  dp[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// è¾¹ç•Œï¼šå‡‘0éœ€è¦0ä¸ª</span>

  <span class="hljs-keyword">const</span> m = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(n));
  <span class="hljs-comment">// 2. éå†é¡ºåºï¼šå¤–å±‚å®Œå…¨å¹³æ–¹æ•°ï¼Œå†…å±‚æ­£åºéå†å’Œ</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
    <span class="hljs-keyword">const</span> curPow = i * i;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = curPow; j &lt;= n; j++) {
      dp[j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(dp[j], dp[j - curPow] + <span class="hljs-number">1</span>);
    }
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®Œå…¨å¹³æ–¹æ•°ä¸€ç»´DPæ•°ç»„ï¼š'</span>, dp);
  <span class="hljs-keyword">return</span> dp[n];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸€ç»´ä¼˜åŒ–ç‰ˆæœ€å°‘ä¸ªæ•°ï¼ˆn=12ï¼‰ï¼š'</span>, <span class="hljs-title function_">numSquares_1d</span>(<span class="hljs-number">12</span>)); <span class="hljs-comment">// è¾“å‡ºï¼š3</span>
</code></pre>
<h3 data-id="heading-25">ä¸‰ã€å®Œå…¨èƒŒåŒ…å˜å½¢2ï¼šè®¡æ•°ç±»ï¼ˆç»„åˆæ•°/æ’åˆ—æ•°ï¼‰</h3>
<p>è®¡æ•°ç±»æ˜¯å®Œå…¨èƒŒåŒ…æœ€æ˜“æ··æ·†çš„å˜å½¢ï¼Œæ ¸å¿ƒåŒºåˆ«æ˜¯ã€Œæ˜¯å¦è€ƒè™‘é¡ºåºã€ï¼š</p>
<ul>
<li>
<p>ç»„åˆæ•°ï¼šé¡ºåºæ— å…³ï¼ˆé›¶é’±å…‘æ¢IIï¼‰â†’ å¤–å±‚ç‰©å“ï¼Œå†…å±‚å®¹é‡ï¼›</p>
</li>
<li>
<p>æ’åˆ—æ•°ï¼šé¡ºåºæœ‰å…³ï¼ˆç»„åˆæ€»å’ŒIVï¼‰â†’ å¤–å±‚å®¹é‡ï¼Œå†…å±‚ç‰©å“ã€‚</p>
</li>
</ul>
<h4 data-id="heading-26">3.1 å­å˜å½¢2.1ï¼šç»„åˆæ•°ï¼ˆé›¶é’±å…‘æ¢IIï¼‰</h4>
<p>LeetCodeé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcoin-change-ii%2F" target="_blank" title="https://leetcode.cn/problems/coin-change-ii/" ref="nofollow noopener noreferrer">leetcode.cn/problems/coâ€¦</a></p>
<h5 data-id="heading-27">é¢˜ç›®æè¿°</h5>
<p>ç»™å®šç¡¬å¸æ•°ç»„ <code>coins</code> å’Œæ€»é‡‘é¢ <code>amount</code>ï¼Œæ±‚å‡‘æˆæ€»é‡‘é¢çš„ç»„åˆæ•°ï¼ˆç¡¬å¸å¯é‡å¤é€‰ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ï¼š<code>coins=[1,2,5], amount=5</code> â†’ è¾“å‡º4ï¼ˆ5=5/2+2+1/2+1+1+1/1Ã—5ï¼‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontzhm.github.io%2Fblog-demo%2Fdp3-wq3.html" target="_blank" title="https://frontzhm.github.io/blog-demo/dp3-wq3.html" ref="nofollow noopener noreferrer">è¡¨æ ¼åŠ¨æ€æ¼”ç¤º</a></p>
<h5 data-id="heading-28">3.1.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h5>
<p>å®šä¹‰äºŒç»´æ•°ç»„<code>dp[i][j]</code>ï¼šè¡¨ç¤ºã€Œå‰iç§ç¡¬å¸å‡‘å‡ºé‡‘é¢jçš„ç»„åˆæ•°ã€ã€‚</p>
<h5 data-id="heading-29">3.1.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h5>
<ol>
<li>
<p><strong>ä¸é€‰ç¬¬iç§ç¡¬å¸</strong>ï¼š<code>dp[i][j] = dp[i-1][j]</code>ï¼›</p>
</li>
<li>
<p><strong>é€‰ç¬¬iç§ç¡¬å¸</strong>ï¼šj â‰¥ coins[i-1]æ—¶ï¼Œ<code>dp[i][j] += dp[i][j - coins[i-1]]</code>ï¼›</p>
</li>
</ol>
<p>æœ€ç»ˆï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-keyword">if</span> (j &lt; coins[i-<span class="hljs-number">1</span>]) {
  dp[i][j] = dp[i-<span class="hljs-number">1</span>][j];
} <span class="hljs-keyword">else</span> {
  dp[i][j] = dp[i-<span class="hljs-number">1</span>][j] + dp[i][j - coins[i-<span class="hljs-number">1</span>]];
}
</code></pre>
<h5 data-id="heading-30">3.1.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h5>
<ol>
<li>
<p><strong>j=0ï¼ˆå‡‘0ï¼‰</strong>ï¼šæ‰€æœ‰içš„<code>dp[i][0] = 1</code>ï¼ˆä¸é€‰ä»»ä½•ç¡¬å¸æ˜¯å”¯ä¸€æ–¹å¼ï¼‰ï¼›</p>
</li>
<li>
<p><strong>i=0ï¼ˆæ— ç¡¬å¸ï¼‰</strong>ï¼šj&gt;0æ—¶<code>dp[0][j] = 0</code>ï¼ˆæ— ç¡¬å¸æ— æ³•å‡‘é‡‘é¢ï¼‰ã€‚</p>
</li>
</ol>
<h5 data-id="heading-31">3.1.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåº</h5>
<p>å…ˆéå†ç¡¬å¸ï¼ˆiä»1åˆ°lenï¼‰ï¼Œå†éå†é‡‘é¢ï¼ˆjä»1åˆ°amountï¼‰ï¼Œé€è¡Œå¡«å……ã€‚</p>
<h5 data-id="heading-32">3.1.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h5>
<p>ä»¥<code>coins=[1,2,5], amount=5</code>ä¸ºä¾‹ï¼Œæœ€ç»ˆ<code>dp[3][5] = 4</code>ï¼Œä¸é¢„æœŸä¸€è‡´ã€‚</p>
<h5 data-id="heading-33">3.1.6 äºŒç»´DPå®Œæ•´ä»£ç </h5>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * é›¶é’±å…‘æ¢IIï¼ˆäºŒç»´DPè§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">amount</span> - æ€»é‡‘é¢
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">coins</span> - ç¡¬å¸æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - ç»„åˆæ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">change_2d</span>(<span class="hljs-params">amount, coins</span>) {
  <span class="hljs-keyword">const</span> len = coins.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// 1. åˆå§‹åŒ–äºŒç»´dpæ•°ç»„ï¼šdp[i][j]å‰iç§ç¡¬å¸å‡‘é‡‘é¢jçš„ç»„åˆæ•°</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(len + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(amount + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));

  <span class="hljs-comment">// 2. è¾¹ç•Œæ¡ä»¶ï¼šå‡‘0æœ‰1ç§æ–¹å¼</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= len; i++) {
    dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;
  }

  <span class="hljs-comment">// 3. éå†é¡ºåºï¼šå…ˆéå†ç¡¬å¸ï¼Œå†éå†é‡‘é¢</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= len; i++) {
    <span class="hljs-keyword">const</span> curCoin = coins[i - <span class="hljs-number">1</span>];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= amount; j++) {
      <span class="hljs-comment">// 4. é€’æ¨å…¬å¼</span>
      <span class="hljs-keyword">if</span> (j &lt; curCoin) {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
      } <span class="hljs-keyword">else</span> {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] + dp[i][j - curCoin];
      }
    }
  }

  <span class="hljs-comment">// æ‰“å°dpæ•°ç»„éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é›¶é’±å…‘æ¢IIäºŒç»´DPæ•°ç»„ï¼š'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= len; i++) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dp[i].<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>));
  }

  <span class="hljs-keyword">return</span> dp[len][amount];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„åˆæ•°ï¼ˆamount=5ï¼‰ï¼š'</span>, <span class="hljs-title function_">change_2d</span>(<span class="hljs-number">5</span>, [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>])); <span class="hljs-comment">// è¾“å‡ºï¼š4</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„åˆæ•°ï¼ˆamount=3ï¼‰ï¼š'</span>, <span class="hljs-title function_">change_2d</span>(<span class="hljs-number">3</span>, [<span class="hljs-number">2</span>])); <span class="hljs-comment">// è¾“å‡ºï¼š0</span>
</code></pre>
<h5 data-id="heading-34">3.1.7 ä¸€ç»´DPä¼˜åŒ–</h5>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * é›¶é’±å…‘æ¢IIï¼ˆä¸€ç»´DPä¼˜åŒ–ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">amount</span> - æ€»é‡‘é¢
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">coins</span> - ç¡¬å¸æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - ç»„åˆæ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">change_1d</span>(<span class="hljs-params">amount, coins</span>) {
  <span class="hljs-comment">// 1. åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]å‡‘é‡‘é¢jçš„ç»„åˆæ•°</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(amount + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);
  dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">// è¾¹ç•Œï¼šå‡‘0æœ‰1ç§æ–¹å¼</span>

  <span class="hljs-comment">// 2. éå†é¡ºåºï¼šå¤–å±‚ç¡¬å¸ï¼ˆä¿è¯é¡ºåºæ— å…³ï¼‰ï¼Œå†…å±‚æ­£åºéå†é‡‘é¢</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> curCoin <span class="hljs-keyword">of</span> coins) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = curCoin; j &lt;= amount; j++) {
      dp[j] += dp[j - curCoin];
    }
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é›¶é’±å…‘æ¢IIä¸€ç»´DPæ•°ç»„ï¼š'</span>, dp);
  <span class="hljs-keyword">return</span> dp[amount];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸€ç»´ä¼˜åŒ–ç‰ˆç»„åˆæ•°ï¼š'</span>, <span class="hljs-title function_">change_1d</span>(<span class="hljs-number">5</span>, [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>])); <span class="hljs-comment">// è¾“å‡ºï¼š4</span>
</code></pre>
<h4 data-id="heading-35">3.2 å­å˜å½¢2.2ï¼šæ’åˆ—æ•°ï¼ˆç»„åˆæ€»å’ŒIVï¼‰</h4>
<p>LeetCodeé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombination-sum-iv%2F" target="_blank" title="https://leetcode.cn/problems/combination-sum-iv/" ref="nofollow noopener noreferrer">leetcode.cn/problems/coâ€¦</a></p>
<h5 data-id="heading-36">é¢˜ç›®æè¿°</h5>
<p>ç»™å®šæ•°ç»„ <code>nums</code> å’Œç›®æ ‡ <code>target</code>ï¼Œæ±‚æ€»å’Œä¸º <code>target</code> çš„æ’åˆ—æ•°ï¼ˆå…ƒç´ å¯é‡å¤é€‰ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ï¼š<code>nums=[1,2], target=3</code> â†’ è¾“å‡º3ï¼ˆ1+1+1/1+2/2+1ï¼‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontzhm.github.io%2Fblog-demo%2Fdp3-wq4.html" target="_blank" title="https://frontzhm.github.io/blog-demo/dp3-wq4.html" ref="nofollow noopener noreferrer">è¡¨æ ¼åŠ¨æ€æ¼”ç¤º</a></p>
<h5 data-id="heading-37">3.2.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h5>
<p>å®šä¹‰äºŒç»´æ•°ç»„<code>dp[j][k]</code>ï¼šè¡¨ç¤ºã€Œå‡‘é‡‘é¢jï¼Œæœ€åä¸€æ­¥é€‰nums[k]çš„æ’åˆ—æ•°ã€ï¼Œæ€»æ’åˆ—æ•°<code>total[j] = sum(dp[j][k])</code>ã€‚</p>
<h5 data-id="heading-38">3.2.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h5>
<p>å¯¹äºé‡‘é¢jã€æ•°å­—nums[k]ï¼š</p>
<ul>
<li>
<p>j &lt; nums[k]ï¼š<code>dp[j][k] = 0</code>ï¼ˆé‡‘é¢ä¸è¶³ï¼‰ï¼›</p>
</li>
<li>
<p>j â‰¥ nums[k]ï¼š<code>dp[j][k] = total[j - nums[k]]</code>ï¼ˆæœ€åä¸€æ­¥é€‰nums[k]ï¼Œå‰é¢å‡‘j-nums[k]çš„æ€»æ’åˆ—æ•°ï¼‰ã€‚</p>
</li>
</ul>
<h5 data-id="heading-39">3.2.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h5>
<ol>
<li>
<p><strong>j=0ï¼ˆå‡‘0ï¼‰</strong>ï¼š<code>total[0] = 1</code>ï¼ˆä¸é€‰ä»»ä½•æ•°ï¼‰ï¼Œ<code>dp[0][k] = 0</code>ï¼›</p>
</li>
<li>
<p>å…¶ä½™<code>total[j]</code>åˆå§‹åŒ–ä¸º0ï¼Œ<code>dp[j][k]</code>åˆå§‹åŒ–ä¸º0ã€‚</p>
</li>
</ol>
<h5 data-id="heading-40">3.2.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåº</h5>
<p>å…ˆéå†é‡‘é¢ï¼ˆjä»1åˆ°targetï¼‰ï¼Œå†éå†æ•°å­—ï¼ˆkä»0åˆ°len-1ï¼‰ï¼Œé€åˆ—å¡«å……ã€‚</p>
<h5 data-id="heading-41">3.2.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h5>
<p>ä»¥<code>nums=[1,2], target=3</code>ä¸ºä¾‹ï¼Œæœ€ç»ˆ<code>total[3] = 3</code>ï¼Œä¸é¢„æœŸä¸€è‡´ã€‚</p>
<h5 data-id="heading-42">3.2.6 äºŒç»´æ€è·¯å®Œæ•´ä»£ç </h5>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * ç»„åˆæ€»å’ŒIVï¼ˆäºŒç»´æ€è·¯ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - å¯é€‰æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">target</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - æ’åˆ—æ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum4_2d</span>(<span class="hljs-params">nums, target</span>) {
  <span class="hljs-keyword">const</span> len = nums.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// 1. åˆå§‹åŒ–dpè¡¨æ ¼ï¼šdp[j][k]å‡‘jï¼Œæœ€åä¸€æ­¥é€‰nums[k]çš„æ’åˆ—æ•°</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(target + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(len).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));
  <span class="hljs-comment">// 2. æ€»æ’åˆ—æ•°æ•°ç»„ï¼štotal[j]å‡‘jçš„æ€»æ’åˆ—æ•°</span>
  <span class="hljs-keyword">const</span> total = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(target + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);
  total[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">// è¾¹ç•Œï¼šå‡‘0æœ‰1ç§æ–¹å¼</span>

  <span class="hljs-comment">// 3. éå†é¡ºåºï¼šå¤–å±‚é‡‘é¢ï¼Œå†…å±‚æ•°å­—ï¼ˆä¿è¯é¡ºåºæœ‰å…³ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= target; j++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; len; k++) {
      <span class="hljs-keyword">const</span> num = nums[k];
      <span class="hljs-comment">// 4. é€’æ¨å…¬å¼</span>
      <span class="hljs-keyword">if</span> (j &gt;= num) {
        dp[j][k] = total[j - num];
      } <span class="hljs-keyword">else</span> {
        dp[j][k] = <span class="hljs-number">0</span>;
      }
    }
    <span class="hljs-comment">// æ€»æ’åˆ—æ•° = æ‰€æœ‰æœ€åä¸€æ­¥çš„æƒ…å†µæ±‚å’Œ</span>
    total[j] = dp[j].<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">sum, val</span>) =&gt;</span> sum + val, <span class="hljs-number">0</span>);
  }

  <span class="hljs-comment">// æ‰“å°éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„åˆæ€»å’ŒIV dpè¡¨æ ¼ï¼š'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt;= target; j++) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`j=<span class="hljs-subst">${j}</span>: `</span>, dp[j].<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>), <span class="hljs-string">'â†’ æ€»æ’åˆ—æ•°ï¼š'</span>, total[j]);
  }

  <span class="hljs-keyword">return</span> total[target];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ’åˆ—æ•°ï¼ˆtarget=3ï¼‰ï¼š'</span>, <span class="hljs-title function_">combinationSum4_2d</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], <span class="hljs-number">3</span>)); <span class="hljs-comment">// è¾“å‡ºï¼š3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ’åˆ—æ•°ï¼ˆtarget=4ï¼‰ï¼š'</span>, <span class="hljs-title function_">combinationSum4_2d</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], <span class="hljs-number">4</span>)); <span class="hljs-comment">// è¾“å‡ºï¼š7</span>
</code></pre>
<h5 data-id="heading-43">3.2.7 ä¸€ç»´DPä¼˜åŒ–</h5>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * ç»„åˆæ€»å’ŒIVï¼ˆä¸€ç»´DPä¼˜åŒ–ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - å¯é€‰æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">target</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - æ’åˆ—æ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum4_1d</span>(<span class="hljs-params">nums, target</span>) {
  <span class="hljs-comment">// 1. åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]å‡‘jçš„æ’åˆ—æ•°</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(target + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);
  dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">// è¾¹ç•Œï¼šå‡‘0æœ‰1ç§æ–¹å¼</span>

  <span class="hljs-comment">// 2. éå†é¡ºåºï¼šå¤–å±‚é‡‘é¢ï¼ˆä¿è¯é¡ºåºæœ‰å…³ï¼‰ï¼Œå†…å±‚æ•°å­—</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= target; j++) {
    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> num <span class="hljs-keyword">of</span> nums) {
      <span class="hljs-keyword">if</span> (j &gt;= num) {
        count += dp[j - num];
      }
    }
    dp[j] = count;
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„åˆæ€»å’ŒIVä¸€ç»´DPæ•°ç»„ï¼š'</span>, dp);
  <span class="hljs-keyword">return</span> dp[target];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸€ç»´ä¼˜åŒ–ç‰ˆæ’åˆ—æ•°ï¼š'</span>, <span class="hljs-title function_">combinationSum4_1d</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], <span class="hljs-number">3</span>)); <span class="hljs-comment">// è¾“å‡ºï¼š3</span>
</code></pre>
<h3 data-id="heading-44">å››ã€å®Œå…¨èƒŒåŒ…å˜å½¢3ï¼šè¿›é˜¶ç±»ï¼ˆå•è¯æ‹†åˆ†ï¼‰</h3>
<p>LeetCodeé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fword-break%2F" target="_blank" title="https://leetcode.cn/problems/word-break/" ref="nofollow noopener noreferrer">leetcode.cn/problems/woâ€¦</a></p>
<h4 data-id="heading-45">é¢˜ç›®æè¿°</h4>
<p>åˆ¤æ–­å­—ç¬¦ä¸² <code>s</code> èƒ½å¦è¢«å­—å…¸ <code>wordDict</code> ä¸­çš„å•è¯æ‹¼æ¥ï¼ˆå•è¯å¯é‡å¤ç”¨ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ï¼š<code>s="leetcode", wordDict=["leet","code"]</code> â†’ è¾“å‡ºtrueï¼›<code>s="catsandog", wordDict=["cats","dog","sand","and","cat"]</code> â†’ è¾“å‡ºfalseã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontzhm.github.io%2Fblog-demo%2Fdp3-wq5.html" target="_blank" title="https://frontzhm.github.io/blog-demo/dp3-wq5.html" ref="nofollow noopener noreferrer">è¡¨æ ¼åŠ¨æ€æ¼”ç¤º</a></p>
<h4 data-id="heading-46">4.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰äºŒç»´æ•°ç»„<code>dp[j][k]</code>ï¼šè¡¨ç¤ºã€Œå‰jä¸ªå­—ç¬¦ï¼Œæœ€åä¸€æ­¥æ‹¼æ¥wordDict[k]æ˜¯å¦å¯è¡Œã€ï¼Œæ€»ç»“æœ<code>canBreak[j] = any(dp[j][k])</code>ï¼ˆåªè¦æœ‰ä¸€ä¸ªkå¯è¡Œåˆ™ä¸ºtrueï¼‰ã€‚</p>
<h4 data-id="heading-47">4.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºå‰jä¸ªå­—ç¬¦ã€å•è¯wordDict[k]ï¼ˆé•¿åº¦lenï¼‰ï¼š</p>
<ul>
<li>
<p>j &lt; lenï¼š<code>dp[j][k] = false</code>ï¼ˆé•¿åº¦ä¸è¶³ï¼‰ï¼›</p>
</li>
<li>
<p>j â‰¥ lenï¼š<code>dp[j][k] = canBreak[j - len] &amp;&amp; (s.slice(j-len,j) === wordDict[k])</code>ï¼ˆå‰é¢å¯æ‹†åˆ† + å­ä¸²åŒ¹é…ï¼‰ã€‚</p>
</li>
</ul>
<h4 data-id="heading-48">4.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<ol>
<li>
<p><strong>j=0ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰</strong>ï¼š<code>canBreak[0] = true</code>ï¼ˆç©ºå­—ç¬¦ä¸²å¯æ‹†åˆ†ï¼‰ï¼Œ<code>dp[0][k] = false</code>ï¼›</p>
</li>
<li>
<p>å…¶ä½™<code>canBreak[j]</code>åˆå§‹åŒ–ä¸ºfalseï¼Œ<code>dp[j][k]</code>åˆå§‹åŒ–ä¸ºfalseã€‚</p>
</li>
</ol>
<h4 data-id="heading-49">4.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåº</h4>
<p>å…ˆéå†å­—ç¬¦é•¿åº¦ï¼ˆjä»1åˆ°len(s)ï¼‰ï¼Œå†éå†å•è¯ï¼ˆkä»0åˆ°len(wordDict)-1ï¼‰ï¼Œé€åˆ—å¡«å……ã€‚</p>
<h4 data-id="heading-50">4.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>ä»¥<code>s="leetcode", wordDict=["leet","code"]</code>ä¸ºä¾‹ï¼Œæœ€ç»ˆ<code>canBreak[8] = true</code>ï¼Œä¸é¢„æœŸä¸€è‡´ã€‚</p>
<h4 data-id="heading-51">4.6 äºŒç»´æ€è·¯å®Œæ•´ä»£ç </h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * å•è¯æ‹†åˆ†ï¼ˆäºŒç»´æ€è·¯ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">s</span> - å¾…æ‹†åˆ†å­—ç¬¦ä¸²
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string[]</span>} <span class="hljs-variable">wordDict</span> - å•è¯å­—å…¸
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} - æ˜¯å¦å¯æ‹†åˆ†
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">wordBreak_2d</span>(<span class="hljs-params">s, wordDict</span>) {
  <span class="hljs-keyword">const</span> targetLen = s.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">const</span> len = wordDict.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// 1. åˆå§‹åŒ–dpè¡¨æ ¼ï¼šdp[j][k]å‰jä¸ªå­—ç¬¦ï¼Œæœ€åä¸€æ­¥æ‹¼æ¥wordDict[k]æ˜¯å¦å¯è¡Œ</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(targetLen + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(len).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>));
  <span class="hljs-comment">// 2. æ€»ç»“æœæ•°ç»„ï¼šcanBreak[j]å‰jä¸ªå­—ç¬¦æ˜¯å¦å¯æ‹†åˆ†</span>
  <span class="hljs-keyword">const</span> canBreak = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(targetLen + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>);
  canBreak[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¾¹ç•Œï¼šç©ºå­—ç¬¦ä¸²å¯æ‹†åˆ†</span>

  <span class="hljs-comment">// 3. éå†é¡ºåºï¼šå¤–å±‚å­—ç¬¦é•¿åº¦ï¼Œå†…å±‚å•è¯</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= targetLen; j++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; len; k++) {
      <span class="hljs-keyword">const</span> word = wordDict[k];
      <span class="hljs-keyword">const</span> wordLen = word.<span class="hljs-property">length</span>;
      <span class="hljs-comment">// 4. é€’æ¨å…¬å¼</span>
      <span class="hljs-keyword">if</span> (j &gt;= wordLen) {
        <span class="hljs-keyword">const</span> subStr = s.<span class="hljs-title function_">slice</span>(j - wordLen, j);
        dp[j][k] = canBreak[j - wordLen] &amp;&amp; (subStr === word);
      } <span class="hljs-keyword">else</span> {
        dp[j][k] = <span class="hljs-literal">false</span>;
      }
    }
    <span class="hljs-comment">// åªè¦æœ‰ä¸€ä¸ªå•è¯å¯è¡Œï¼Œå‰jä¸ªå­—ç¬¦å°±å¯æ‹†åˆ†</span>
    canBreak[j] = dp[j].<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> val === <span class="hljs-literal">true</span>);
  }

  <span class="hljs-comment">// æ‰“å°éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å•è¯æ‹†åˆ†dpè¡¨æ ¼ï¼š'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt;= targetLen; j++) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`j=<span class="hljs-subst">${j}</span>: `</span>, dp[j].<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>), <span class="hljs-string">'â†’ æ˜¯å¦å¯æ‹†åˆ†ï¼š'</span>, canBreak[j]);
  }

  <span class="hljs-keyword">return</span> canBreak[targetLen];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ˜¯å¦å¯æ‹†åˆ†ï¼ˆleetcodeï¼‰ï¼š'</span>, <span class="hljs-title function_">wordBreak_2d</span>(<span class="hljs-string">"leetcode"</span>, [<span class="hljs-string">"leet"</span>,<span class="hljs-string">"code"</span>])); <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ˜¯å¦å¯æ‹†åˆ†ï¼ˆcatsandogï¼‰ï¼š'</span>, <span class="hljs-title function_">wordBreak_2d</span>(<span class="hljs-string">"catsandog"</span>, [<span class="hljs-string">"cats"</span>,<span class="hljs-string">"dog"</span>,<span class="hljs-string">"sand"</span>,<span class="hljs-string">"and"</span>,<span class="hljs-string">"cat"</span>])); <span class="hljs-comment">// è¾“å‡ºï¼šfalse</span>
</code></pre>
<h4 data-id="heading-52">4.7 ä¸€ç»´DPä¼˜åŒ–</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">/**
 * å•è¯æ‹†åˆ†ï¼ˆä¸€ç»´DPä¼˜åŒ–ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">s</span> - å¾…æ‹†åˆ†å­—ç¬¦ä¸²
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string[]</span>} <span class="hljs-variable">wordDict</span> - å•è¯å­—å…¸
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} - æ˜¯å¦å¯æ‹†åˆ†
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">wordBreak_1d</span>(<span class="hljs-params">s, wordDict</span>) {
  <span class="hljs-keyword">const</span> targetLen = s.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// 1. åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]å‰jä¸ªå­—ç¬¦æ˜¯å¦å¯æ‹†åˆ†</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(targetLen + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>);
  dp[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¾¹ç•Œï¼šç©ºå­—ç¬¦ä¸²å¯æ‹†åˆ†</span>

  <span class="hljs-comment">// 2. éå†é¡ºåºï¼šå¤–å±‚å­—ç¬¦é•¿åº¦ï¼Œå†…å±‚å•è¯</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= targetLen; j++) {
    <span class="hljs-keyword">const</span> curStr = s.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, j);
    <span class="hljs-keyword">let</span> can = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> word <span class="hljs-keyword">of</span> wordDict) {
      <span class="hljs-keyword">const</span> wordLen = word.<span class="hljs-property">length</span>;
      <span class="hljs-keyword">if</span> (wordLen &gt; j) <span class="hljs-keyword">continue</span>;
      <span class="hljs-comment">// 3. é€’æ¨å…¬å¼ï¼šåç¼€åŒ¹é… + å‰é¢å¯æ‹†åˆ†</span>
      can = can || (dp[j - wordLen] &amp;&amp; curStr.<span class="hljs-title function_">endsWith</span>(word));
      <span class="hljs-keyword">if</span> (can) <span class="hljs-keyword">break</span>; <span class="hljs-comment">// æå‰ç»ˆæ­¢</span>
    }
    dp[j] = can;
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å•è¯æ‹†åˆ†ä¸€ç»´DPæ•°ç»„ï¼š'</span>, dp);
  <span class="hljs-keyword">return</span> dp[targetLen];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸€ç»´ä¼˜åŒ–ç‰ˆæ˜¯å¦å¯æ‹†åˆ†ï¼š'</span>, <span class="hljs-title function_">wordBreak_1d</span>(<span class="hljs-string">"leetcode"</span>, [<span class="hljs-string">"leet"</span>,<span class="hljs-string">"code"</span>])); <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
</code></pre>
<h3 data-id="heading-53">äº”ã€æ ¸å¿ƒæ€»ç»“</h3>















































<table><thead><tr><th>é¢˜å‹</th><th>LeetCodeé“¾æ¥</th><th>äºŒç»´DPæ ¸å¿ƒæ„ä¹‰</th><th>ä¸€ç»´éå†é¡ºåº</th><th>çŠ¶æ€è½¬ç§»æ ¸å¿ƒ</th></tr></thead><tbody><tr><td>çº¯å®Œå…¨èƒŒåŒ…</td><td>æ— ï¼ˆç»å…¸åŸå‹ï¼‰</td><td>ç›´è§‚ä½“ç°ã€Œé‡å¤é€‰ã€çš„çŠ¶æ€è½¬ç§»</td><td>å¤–å±‚ç‰©å“+æ­£åºå®¹é‡</td><td>max(ä¸é€‰, é€‰)</td></tr><tr><td>å®Œå…¨å¹³æ–¹æ•°</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fperfect-squares%2F" target="_blank" title="https://leetcode.cn/problems/perfect-squares/" ref="nofollow noopener noreferrer">leetcode.cn/problems/peâ€¦</a></td><td>ç†è§£ã€Œæœ€å€¼ç±»ã€åˆå§‹åŒ–é€»è¾‘</td><td>å¤–å±‚ç‰©å“+æ­£åºå®¹é‡</td><td>min(ä¸é€‰, é€‰+1)</td></tr><tr><td>é›¶é’±å…‘æ¢II</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcoin-change-ii%2F" target="_blank" title="https://leetcode.cn/problems/coin-change-ii/" ref="nofollow noopener noreferrer">leetcode.cn/problems/coâ€¦</a></td><td>ç†è§£ã€Œç»„åˆæ•°ã€çš„çŠ¶æ€ç»§æ‰¿</td><td>å¤–å±‚ç‰©å“+æ­£åºå®¹é‡</td><td>ä¸é€‰ + é€‰</td></tr><tr><td>ç»„åˆæ€»å’ŒIV</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombination-sum-iv%2F" target="_blank" title="https://leetcode.cn/problems/combination-sum-iv/" ref="nofollow noopener noreferrer">leetcode.cn/problems/coâ€¦</a></td><td>ç†è§£ã€Œæœ€åä¸€æ­¥ã€çš„è¡¨æ ¼æ‹†åˆ†</td><td>å¤–å±‚å®¹é‡+å†…å±‚ç‰©å“</td><td>ç´¯åŠ æ‰€æœ‰ã€Œæœ€åä¸€æ­¥ã€çš„å¯èƒ½</td></tr><tr><td>å•è¯æ‹†åˆ†</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fword-break%2F" target="_blank" title="https://leetcode.cn/problems/word-break/" ref="nofollow noopener noreferrer">leetcode.cn/problems/woâ€¦</a></td><td>ç†è§£ã€Œå­—ç¬¦ä¸²åŒ¹é…+DPã€çš„ç»“åˆ</td><td>å¤–å±‚å®¹é‡+å†…å±‚ç‰©å“</td><td>æˆ–è¿ç®—ï¼ˆå­˜åœ¨ä¸€ç§å³å¯ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-54">å­¦ä¹ å»ºè®®</h4>
<ol>
<li>
<p><strong>å…ˆäºŒç»´ï¼Œåä¸€ç»´</strong>ï¼šäºŒç»´æ•°ç»„èƒ½ç›´è§‚ä½“ç°çŠ¶æ€è½¬ç§»é€»è¾‘ï¼Œä¸€ç»´ä¼˜åŒ–æ˜¯ç©ºé—´å‹ç¼©ï¼Œä¸è¦è·³è¿‡äºŒç»´ç›´æ¥å­¦ä¸€ç»´ï¼›</p>
</li>
<li>
<p><strong>æ‰‹åŠ¨å¡«å°è¡¨æ ¼</strong>ï¼šå¯¹æ˜“æ··æ·†çš„æ’åˆ—/ç»„åˆæ•°ï¼Œç”¨å°ä¾‹å­æ‰‹åŠ¨å¡«å……è¡¨æ ¼ï¼Œå¿«é€Ÿç†è§£éå†é¡ºåºçš„å½±å“ï¼›</p>
</li>
<li>
<p><strong>æŠ“ã€Œæœ€åä¸€æ­¥ã€æ ¸å¿ƒ</strong>ï¼šæ‰€æœ‰å®Œå…¨èƒŒåŒ…å˜å½¢çš„é€’æ¨å…¬å¼ï¼Œæœ¬è´¨éƒ½æ˜¯ã€Œæœ€åä¸€æ­¥é€‰ä»€ä¹ˆã€ï¼›</p>
</li>
<li>
<p><strong>åŒºåˆ†éå†é¡ºåº</strong>ï¼šç‰©å“å¤–å±‚=ç»„åˆï¼ˆé¡ºåºæ— å…³ï¼‰ï¼Œå®¹é‡å¤–å±‚=æ’åˆ—ï¼ˆé¡ºåºæœ‰å…³ï¼‰ã€‚</p>
</li>
</ol>
<p>å®Œå…¨èƒŒåŒ…çš„æ‰€æœ‰å˜å½¢æœ¬è´¨éƒ½æ˜¯ã€ŒçŠ¶æ€è¡¨æ ¼çš„å¡«å……è§„åˆ™å˜åŒ–ã€ï¼ŒæŒæ¡äº†å¡«å……è¡¨æ ¼æ³•ï¼Œæ— è®ºé¢˜å‹å¦‚ä½•å˜å½¢ï¼Œéƒ½èƒ½å¿«é€Ÿæ‹†è§£æ ¸å¿ƒé€»è¾‘ï¼</p>
<p>æœ‰Nç§ç‰©å“å’Œâ¼€ä¸ªå®¹é‡ä¸ºV çš„èƒŒåŒ…ã€‚ç¬¬iç§ç‰©å“æœ€å¤šæœ‰Miä»¶å¯â½¤ï¼Œæ¯ä»¶è€—è´¹çš„ç©ºé—´æ˜¯Ci ï¼Œä»·å€¼æ˜¯Wi ã€‚æ±‚è§£å°†å“ªäº›ç‰©å“è£…â¼ŠèƒŒåŒ…å¯ä½¿è¿™äº›ç‰©å“çš„è€—è´¹çš„ç©ºé—´ æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€â¼¤ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•ä½¿ç”¨for...oféå†å¯¹è±¡]]></title>    <link>https://juejin.cn/post/7592615536385540130</link>    <guid>https://juejin.cn/post/7592615536385540130</guid>    <pubDate>2026-01-08T14:03:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592615536385540130" data-draft-id="7592615536385523746" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•ä½¿ç”¨for...oféå†å¯¹è±¡"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-08T14:03:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç çŒäºº"/> <meta itemprop="url" content="https://juejin.cn/user/624972624037374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•ä½¿ç”¨for...oféå†å¯¹è±¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624972624037374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç çŒäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T14:03:27.000Z" title="Thu Jan 08 2026 14:03:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è™½ç„¶æ™®é€šå¯¹è±¡é»˜è®¤ä¸æ”¯æŒÂ <code>for...of</code>ï¼Œä½†æœ‰å¤šç§æ–¹æ³•å¯ä»¥å®ç°ï¼š</p>
<h2 data-id="heading-0">1.Â <strong>ä½¿ç”¨ Object çš„è¾…åŠ©æ–¹æ³•</strong></h2>
<h3 data-id="heading-1">éå†é”®å (keys)</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> };

<span class="hljs-comment">// æ–¹æ³•1: Object.keys()</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// 'a', 'b', 'c'</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj[key]); <span class="hljs-comment">// 1, 2, 3</span>
}

<span class="hljs-comment">// æ–¹æ³•2: ä½¿ç”¨æ•°ç»„çš„è§£æ„å’Œå¾ªç¯</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)) {
  <span class="hljs-keyword">const</span> value = obj[key];
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value);
}
</code></pre>
<h3 data-id="heading-2">éå†å€¼ (values)</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> };

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(obj)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// 1, 2, 3</span>
}
</code></pre>
<h3 data-id="heading-3">éå†é”®å€¼å¯¹ (entries)</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> };

<span class="hljs-comment">// æ–¹æ³•1: ä½¿ç”¨æ•°ç»„è§£æ„</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value); <span class="hljs-comment">// 'a' 1, 'b' 2, 'c' 3</span>
}

<span class="hljs-comment">// æ–¹æ³•2: ä¸ä½¿ç”¨è§£æ„</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)) {
  <span class="hljs-keyword">const</span> key = entry[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">const</span> value = entry[<span class="hljs-number">1</span>];
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value);
}
</code></pre>
<h2 data-id="heading-4">2.Â <strong>ä½¿å¯¹è±¡æœ¬èº«å¯è¿­ä»£ (å®ç° Symbol.iterator)</strong></h2>
<h3 data-id="heading-5">åŸºæœ¬å®ç°</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">city</span>: <span class="hljs-string">'New York'</span>,
  
  <span class="hljs-comment">// æ·»åŠ  Symbol.iterator æ–¹æ³•</span>
  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]: <span class="hljs-keyword">function</span>* () {
    <span class="hljs-comment">// éå†è‡ªèº«å±æ€§</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>)) {
      <span class="hljs-keyword">yield</span> [key, <span class="hljs-variable language_">this</span>[key]];
    }
  }
};

<span class="hljs-comment">// ç°åœ¨å¯ä»¥ç”¨ for...of ç›´æ¥éå†</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> obj) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${value}</span>`</span>);
}
<span class="hljs-comment">// è¾“å‡º:</span>
<span class="hljs-comment">// name: John</span>
<span class="hljs-comment">// age: 30</span>
<span class="hljs-comment">// city: New York</span>
</code></pre>
<h3 data-id="heading-6">åªè¿”å›å€¼çš„è¿­ä»£å™¨</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>,
  <span class="hljs-attr">c</span>: <span class="hljs-number">3</span>,
  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]: <span class="hljs-keyword">function</span>* () {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>)) {
      <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>[key];
    }
  }
};

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> obj) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// 1, 2, 3</span>
}
</code></pre>
<h2 data-id="heading-7">3.Â <strong>è‡ªå®šä¹‰è¿­ä»£è¡Œä¸º</strong></h2>
<h3 data-id="heading-8">æŒ‰ç‰¹å®šé¡ºåºè¿­ä»£</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">firstName</span>: <span class="hljs-string">'John'</span>,
  <span class="hljs-attr">lastName</span>: <span class="hljs-string">'Doe'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">'john@example.com'</span>,
  
  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]: <span class="hljs-keyword">function</span>* () {
    <span class="hljs-comment">// è‡ªå®šä¹‰è¿­ä»£é¡ºåº</span>
    <span class="hljs-keyword">yield</span> [<span class="hljs-string">'å§“å'</span>, <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.firstName}</span> <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.lastName}</span>`</span>];
    <span class="hljs-keyword">yield</span> [<span class="hljs-string">'å¹´é¾„'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>];
    <span class="hljs-keyword">yield</span> [<span class="hljs-string">'é‚®ç®±'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">email</span>];
  }
};

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [label, value] <span class="hljs-keyword">of</span> user) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${label}</span>: <span class="hljs-subst">${value}</span>`</span>);
}
<span class="hljs-comment">// è¾“å‡º:</span>
<span class="hljs-comment">// å§“å: John Doe</span>
<span class="hljs-comment">// å¹´é¾„: 30</span>
<span class="hljs-comment">// é‚®ç®±: john@example.com</span>
</code></pre>
<h3 data-id="heading-9">åªè¿­ä»£ç‰¹å®šå±æ€§</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> product = {
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Laptop'</span>,
  <span class="hljs-attr">price</span>: <span class="hljs-number">999.99</span>,
  <span class="hljs-attr">category</span>: <span class="hljs-string">'Electronics'</span>,
  <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span>,
  
  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]: <span class="hljs-keyword">function</span>* () {
    <span class="hljs-comment">// åªè¿­ä»£éå¸ƒå°”å€¼çš„å±æ€§</span>
    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> keys) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>[key] !== <span class="hljs-string">'boolean'</span>) {
        <span class="hljs-keyword">yield</span> [key, <span class="hljs-variable language_">this</span>[key]];
      }
    }
  }
};

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> product) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${value}</span>`</span>);
}
<span class="hljs-comment">// è¾“å‡º:</span>
<span class="hljs-comment">// id: 1</span>
<span class="hljs-comment">// name: Laptop</span>
<span class="hljs-comment">// price: 999.99</span>
<span class="hljs-comment">// category: Electronics</span>
</code></pre>
<h2 data-id="heading-10">4.Â <strong>ç±»å®ä¾‹çš„å¯è¿­ä»£æ€§</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserCollection</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span> = [];
  }
  
  <span class="hljs-title function_">add</span>(<span class="hljs-params">user</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span>.<span class="hljs-title function_">push</span>(user);
  }
  
  <span class="hljs-comment">// ä½¿å®ä¾‹å¯è¿­ä»£</span>
  *[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]() {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> user <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span>) {
      <span class="hljs-keyword">yield</span> user;
    }
  }
  
  <span class="hljs-comment">// æˆ–è€…è¿”å›é”®å€¼å¯¹</span>
  *<span class="hljs-title function_">entries</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">yield</span> [i, <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span>[i]];
    }
  }
}

<span class="hljs-keyword">const</span> collection = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserCollection</span>();
collection.<span class="hljs-title function_">add</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> });
collection.<span class="hljs-title function_">add</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });

<span class="hljs-comment">// éå†ç”¨æˆ·</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> user <span class="hljs-keyword">of</span> collection) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">name</span>, user.<span class="hljs-property">age</span>);
}

<span class="hljs-comment">// éå†å¸¦ç´¢å¼•çš„ç”¨æˆ·</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [index, user] <span class="hljs-keyword">of</span> collection.<span class="hljs-title function_">entries</span>()) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(index, user.<span class="hljs-property">name</span>);
}
</code></pre>
<h2 data-id="heading-11">5.Â <strong>ä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span>* <span class="hljs-title function_">objectEntries</span>(<span class="hljs-params">obj</span>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)) {
    <span class="hljs-keyword">yield</span> [key, obj[key]];
  }
}

<span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">x</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">30</span> };

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title function_">objectEntries</span>(obj)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value);
}
</code></pre>
<h2 data-id="heading-12">6.Â <strong>å®é™…åº”ç”¨åœºæ™¯</strong></h2>
<h3 data-id="heading-13">åœºæ™¯1ï¼šéå†é…ç½®å¯¹è±¡</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">apiUrl</span>: <span class="hljs-string">'https://api.example.com'</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span>,
  <span class="hljs-attr">retries</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">debug</span>: <span class="hljs-literal">false</span>
};

<span class="hljs-comment">// é…ç½®è¿­ä»£å™¨</span>
config[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] = <span class="hljs-keyword">function</span>* () {
  <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">sort</span>(); <span class="hljs-comment">// æŒ‰å­—æ¯æ’åº</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> keys) {
    <span class="hljs-keyword">yield</span> { key, <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>[key] };
  }
};

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { key, value } <span class="hljs-keyword">of</span> config) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'boolean'</span>) { <span class="hljs-comment">// è¿‡æ»¤å¸ƒå°”å€¼</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é…ç½® <span class="hljs-subst">${key}</span> = <span class="hljs-subst">${value}</span>`</span>);
  }
}
</code></pre>
<h3 data-id="heading-14">åœºæ™¯2ï¼šå¤„ç†åµŒå¥—å¯¹è±¡</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> company = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'TechCorp'</span>,
  <span class="hljs-attr">departments</span>: {
    <span class="hljs-attr">engineering</span>: { <span class="hljs-attr">employees</span>: <span class="hljs-number">50</span>, <span class="hljs-attr">budget</span>: <span class="hljs-number">1000000</span> },
    <span class="hljs-attr">sales</span>: { <span class="hljs-attr">employees</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">budget</span>: <span class="hljs-number">500000</span> },
    <span class="hljs-attr">marketing</span>: { <span class="hljs-attr">employees</span>: <span class="hljs-number">15</span>, <span class="hljs-attr">budget</span>: <span class="hljs-number">300000</span> }
  }
};

<span class="hljs-comment">// æ‰å¹³åŒ–è¿­ä»£å™¨</span>
company[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] = <span class="hljs-keyword">function</span>* () {
  <span class="hljs-keyword">yield</span> [<span class="hljs-string">'å…¬å¸åç§°'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [dept, info] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">departments</span>)) {
    <span class="hljs-keyword">yield</span> [<span class="hljs-string">`<span class="hljs-subst">${dept}</span>éƒ¨é—¨äººæ•°`</span>, info.<span class="hljs-property">employees</span>];
    <span class="hljs-keyword">yield</span> [<span class="hljs-string">`<span class="hljs-subst">${dept}</span>éƒ¨é—¨é¢„ç®—`</span>, info.<span class="hljs-property">budget</span>];
  }
};

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [label, value] <span class="hljs-keyword">of</span> company) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${label}</span>: <span class="hljs-subst">${value}</span>`</span>);
}
</code></pre>
<h2 data-id="heading-15">7.Â <strong>æ€§èƒ½è€ƒè™‘</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {};
<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¤§å¯¹è±¡</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
  obj[<span class="hljs-string">`key<span class="hljs-subst">${i}</span>`</span>] = i;
}

<span class="hljs-comment">// æµ‹è¯•ä¸åŒæ–¹æ³•çš„æ€§èƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'Object.keys + for...of'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)) {
  <span class="hljs-keyword">const</span> value = obj[key];
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'Object.keys + for...of'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'Object.entries + for...of'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)) {
  <span class="hljs-comment">// ç›´æ¥æœ‰å€¼</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'Object.entries + for...of'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'for...in'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> obj) {
  <span class="hljs-keyword">if</span> (obj.<span class="hljs-title function_">hasOwnProperty</span>(key)) {
    <span class="hljs-keyword">const</span> value = obj[key];
  }
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'for...in'</span>);
</code></pre>
<h2 data-id="heading-16">8.Â <strong>å®ç”¨å·¥å…·å‡½æ•°</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åˆ›å»ºå¯è¿­ä»£å¯¹è±¡çš„å·¥å…·å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">makeIterable</span>(<span class="hljs-params">obj, options = {}</span>) {
  <span class="hljs-keyword">const</span> {
    exclude = [],      <span class="hljs-comment">// æ’é™¤çš„å±æ€§</span>
    includeOnly = <span class="hljs-literal">null</span>, <span class="hljs-comment">// åªåŒ…å«çš„å±æ€§</span>
    sortKeys = <span class="hljs-literal">false</span>,  <span class="hljs-comment">// æ˜¯å¦æŒ‰é”®æ’åº</span>
    valueOnly = <span class="hljs-literal">false</span>  <span class="hljs-comment">// åªè¿”å›å€¼</span>
  } = options;
  
  <span class="hljs-keyword">const</span> iterable = { ...obj };
  
  iterable[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] = <span class="hljs-keyword">function</span>* () {
    <span class="hljs-keyword">let</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>);
    
    <span class="hljs-comment">// è¿‡æ»¤</span>
    <span class="hljs-keyword">if</span> (exclude.<span class="hljs-property">length</span>) {
      keys = keys.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> !exclude.<span class="hljs-title function_">includes</span>(key));
    }
    
    <span class="hljs-keyword">if</span> (includeOnly) {
      keys = keys.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> includeOnly.<span class="hljs-title function_">includes</span>(key));
    }
    
    <span class="hljs-comment">// æ’åº</span>
    <span class="hljs-keyword">if</span> (sortKeys) {
      keys.<span class="hljs-title function_">sort</span>();
    }
    
    <span class="hljs-comment">// è¿­ä»£</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> keys) {
      <span class="hljs-keyword">if</span> (valueOnly) {
        <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>[key];
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">yield</span> [key, <span class="hljs-variable language_">this</span>[key]];
      }
    }
  };
  
  <span class="hljs-keyword">return</span> iterable;
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> data = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">e</span>: <span class="hljs-number">5</span> };
<span class="hljs-keyword">const</span> iterableData = <span class="hljs-title function_">makeIterable</span>(data, {
  <span class="hljs-attr">exclude</span>: [<span class="hljs-string">'e'</span>],
  <span class="hljs-attr">sortKeys</span>: <span class="hljs-literal">true</span>
});

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> iterableData) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value); <span class="hljs-comment">// a 1, b 2, c 3, d 4</span>
}
</code></pre>
<h2 data-id="heading-17">æ€»ç»“</h2>
<ol>
<li><strong>æœ€ç®€å•çš„æ–¹æ³•</strong>ï¼šä½¿ç”¨Â <code>Object.keys()</code>ã€<code>Object.values()</code>Â æˆ–Â <code>Object.entries()</code></li>
<li><strong>éœ€è¦ç›´æ¥è¿­ä»£å¯¹è±¡</strong>ï¼šå®ç°Â <code>Symbol.iterator</code>Â æ–¹æ³•</li>
<li><strong>éœ€è¦è‡ªå®šä¹‰è¿­ä»£é€»è¾‘</strong>ï¼šä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°</li>
<li><strong>è€ƒè™‘æ€§èƒ½</strong>ï¼š<code>Object.entries()</code>Â +Â <code>for...of</code>Â é€šå¸¸æ˜¯æ€§èƒ½å’Œå¯è¯»æ€§çš„æœ€ä½³å¹³è¡¡</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ¨èçš„æœ€ä½³å®è·µ</span>
<span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> };

<span class="hljs-comment">// 1. åªéœ€è¦é”®æˆ–å€¼</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)) { }
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(obj)) { }

<span class="hljs-comment">// 2. éœ€è¦é”®å€¼å¯¹</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)) { }

<span class="hljs-comment">// 3. éœ€è¦ç›´æ¥è¿­ä»£å¯¹è±¡ï¼ˆæ·»åŠ è¿­ä»£å™¨ï¼‰</span>
obj[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] = <span class="hljs-keyword">function</span>* () {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(<span class="hljs-variable language_">this</span>)) {
    <span class="hljs-keyword">yield</span> { key, value };
  }
};
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elpis npm åŒ…æŠ½ç¦»æ€»ç»“]]></title>    <link>https://juejin.cn/post/7592803747471933490</link>    <guid>https://juejin.cn/post/7592803747471933490</guid>    <pubDate>2026-01-08T14:21:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592803747471933490" data-draft-id="7592822714068090931" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elpis npm åŒ…æŠ½ç¦»æ€»ç»“"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-08T14:21:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœªç­‰ä¸ä½ è¸æ¸…é£"/> <meta itemprop="url" content="https://juejin.cn/user/2203871969545191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elpis npm åŒ…æŠ½ç¦»æ€»ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2203871969545191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœªç­‰ä¸ä½ è¸æ¸…é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T14:21:04.000Z" title="Thu Jan 08 2026 14:21:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡æ¡£æ€»ç»“å°† elpis æ¡†æ¶æŠ½ç¦»ä¸º npm åŒ…è¿‡ç¨‹ä¸­çš„æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">æ ¸å¿ƒéš¾ç‚¹</h2>
<h3 data-id="heading-1">1. è·¯å¾„è§£æçš„åŒé‡æ€§æŒ‘æˆ˜ â­â­â­</h3>
<p><strong>é—®é¢˜</strong>ï¼šnpm åŒ…å†…ä»£ç éœ€è¦åŒæ—¶è®¿é—®åŒ…å†…èµ„æºå’Œä¸šåŠ¡é¡¹ç›®èµ„æºï¼Œä¸¤ç±»è·¯å¾„çš„è§£ææ–¹å¼å®Œå…¨ä¸åŒã€‚</p>
<p><strong>æ ¸å¿ƒåŒºåˆ«</strong>ï¼š</p>























<table><thead><tr><th>è·¯å¾„ç±»å‹</th><th>ä½¿ç”¨å˜é‡</th><th>æŒ‡å‘ä½ç½®</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>åŒ…å†…è·¯å¾„</td><td><code>__dirname</code></td><td>npm åŒ…å®‰è£…ç›®å½•ï¼ˆå¦‚ <code>node_modules/@david-yjy/elpis/...</code>ï¼‰</td><td>å›ºå®šä¸å˜</td></tr><tr><td>ä¸šåŠ¡è·¯å¾„</td><td><code>process.cwd()</code></td><td>æ‰§è¡Œå‘½ä»¤æ—¶çš„å½“å‰å·¥ä½œç›®å½•ï¼ˆä¸šåŠ¡é¡¹ç›®æ ¹ç›®å½•ï¼‰</td><td>åŠ¨æ€å˜åŒ–</td></tr></tbody></table>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// webpack.base.js</span>

<span class="hljs-comment">// âœ… åŒ…å†…è·¯å¾„ï¼šä½¿ç”¨ __dirname</span>
<span class="hljs-keyword">const</span> elpisEntryList = path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'../../pages/**/entry.*.js'</span>);

<span class="hljs-comment">// âœ… ä¸šåŠ¡è·¯å¾„ï¼šä½¿ç”¨ process.cwd()</span>
<span class="hljs-keyword">const</span> businessEntryList = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/**/entry.*.js'</span>);
</code></pre>
<p><strong>å¸¸è§å¡ç‚¹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šæ··æ·†ä¸¤ç§è·¯å¾„ç±»å‹</span>
<span class="hljs-keyword">const</span> businessConfig = <span class="hljs-built_in">require</span>(path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'./app/config.js'</span>));

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šæ˜ç¡®åŒºåˆ†</span>
<span class="hljs-keyword">const</span> businessConfig = <span class="hljs-built_in">require</span>(path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/config.js'</span>));
</code></pre>
<p><strong>å­¦ä¹ è¦ç‚¹</strong>ï¼š</p>
<ul>
<li><code>__dirname</code> = æ¨¡å—æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼ˆåŒ…å†…ï¼Œå›ºå®šï¼‰</li>
<li><code>process.cwd()</code> = è¿›ç¨‹å½“å‰å·¥ä½œç›®å½•ï¼ˆä¸šåŠ¡é¡¹ç›®ï¼ŒåŠ¨æ€ï¼‰</li>
<li><strong>æ°¸è¿œä¸è¦å‡è®¾ä¸šåŠ¡é¡¹ç›®è·¯å¾„ç›¸å¯¹äºåŒ…çš„ä½ç½®</strong></li>
</ul>
<hr/>
<h3 data-id="heading-2">2. Loader è§£æçš„è·¯å¾„é—®é¢˜ â­â­â­</h3>
<p><strong>é—®é¢˜</strong>ï¼šç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²è·¯å¾„é…ç½® loader ä¼šå¯¼è‡´è·¯å¾„æ‰¾ä¸åˆ°æˆ–ç‰ˆæœ¬å†²çªã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨ <code>require.resolve()</code> ç¡®ä¿ä»åŒ…å†…è§£æ loaderã€‚</p>
<p><strong>ä»£ç å¯¹æ¯”</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šå¯èƒ½æ‰¾ä¸åˆ°æˆ–ç‰ˆæœ¬ä¸å¯¹</span>
<span class="hljs-attr">module</span>: {
  <span class="hljs-attr">rules</span>: [{
    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,
    <span class="hljs-attr">use</span>: <span class="hljs-string">'vue-loader'</span>
  }]
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ require.resolve() ä»åŒ…å†…è§£æ</span>
<span class="hljs-attr">module</span>: {
  <span class="hljs-attr">rules</span>: [{
    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,
    <span class="hljs-attr">use</span>: {
      <span class="hljs-attr">loader</span>: <span class="hljs-built_in">require</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'vue-loader'</span>),  <span class="hljs-comment">// ç¡®ä¿ç‰ˆæœ¬ä¸€è‡´</span>
    }
  }]
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ</strong></p>
<ul>
<li>âœ… <strong>ç‰ˆæœ¬ä¸€è‡´æ€§</strong>ï¼šç¡®ä¿ä½¿ç”¨åŒ…å†…å®šä¹‰çš„ loader ç‰ˆæœ¬</li>
<li>âœ… <strong>è·¯å¾„å¯é æ€§</strong>ï¼šæ— è®ºåœ¨ä»€ä¹ˆç¯å¢ƒä¸‹éƒ½èƒ½æ‰¾åˆ°æ­£ç¡®çš„ loader</li>
<li>âœ… <strong>éš”ç¦»æ€§</strong>ï¼šåŒ…å†…ä¾èµ–ä¸ä¼šå½±å“ä¸šåŠ¡é¡¹ç›®</li>
</ul>
<hr/>
<h3 data-id="heading-3">3. ä¸šåŠ¡æ‰©å±•ç‚¹çš„å¯é€‰æ€§è®¾è®¡ â­â­</h3>
<p><strong>é—®é¢˜</strong>ï¼šæ¡†æ¶éœ€è¦æä¾›æ‰©å±•ç‚¹è®©ä¸šåŠ¡é¡¹ç›®è‡ªå®šä¹‰é…ç½®ï¼Œä½†è¿™äº›é…ç½®å¿…é¡»æ˜¯<strong>å¯é€‰çš„</strong>ï¼Œç¼ºå¤±æ—¶ä¸èƒ½æŠ¥é”™ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨ <code>fs.existsSync()</code> æ£€æŸ¥ + ç©ºæ¨¡å—é™çº§ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// webpack.base.js</span>

<span class="hljs-attr">resolve</span>: {
  <span class="hljs-attr">alias</span>: (<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> aliasMap = {};
    <span class="hljs-keyword">const</span> blankModulePath = path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'../libs/blank.js'</span>);

    <span class="hljs-comment">// æ£€æŸ¥ä¸šåŠ¡é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
    <span class="hljs-keyword">const</span> businessConfig = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/dashboard/root.js'</span>);

    <span class="hljs-comment">// âœ… å…³é”®ï¼šå­˜åœ¨ç”¨ä¸šåŠ¡é…ç½®ï¼Œä¸å­˜åœ¨ç”¨ç©ºæ¨¡å—</span>
    aliasMap[<span class="hljs-string">'$businessDashboardRouterConfig'</span>] =
      fs.<span class="hljs-title function_">existsSync</span>(businessConfig)
        ? businessConfig      <span class="hljs-comment">// å­˜åœ¨ï¼šä½¿ç”¨ä¸šåŠ¡é…ç½®</span>
        : blankModulePath;    <span class="hljs-comment">// ä¸å­˜åœ¨ï¼šä½¿ç”¨ç©ºæ¨¡å—</span>

    <span class="hljs-keyword">return</span> aliasMap;
  })()
}
</code></pre>
<p><strong>ç©ºæ¨¡å—</strong> (<code>blank.js</code>)ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {}  <span class="hljs-comment">// ç¡®ä¿ä¸šåŠ¡ä»£ç å¯ä»¥å®‰å…¨ require</span>
</code></pre>
<p><strong>è®¾è®¡æ¨¡å¼</strong>ï¼š</p>
<ol>
<li><strong>æ£€æµ‹</strong>ï¼š<code>fs.existsSync()</code> æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li>
<li><strong>é™çº§</strong>ï¼šä¸å­˜åœ¨æ—¶æä¾›é»˜è®¤å®ç°ï¼ˆç©ºæ¨¡å—ï¼‰</li>
<li><strong>é€æ˜</strong>ï¼šé€šè¿‡ webpack aliasï¼Œä¸šåŠ¡ä»£ç æ— éœ€å…³å¿ƒé…ç½®æ¥æº</li>
</ol>
<hr/>
<h3 data-id="heading-4">4. é…ç½®åˆå¹¶ä¸å®¹é”™åŠ è½½ â­â­</h3>
<p><strong>é—®é¢˜</strong>ï¼šä¸šåŠ¡é¡¹ç›®å¯èƒ½æƒ³è¦è‡ªå®šä¹‰ webpack é…ç½®ï¼Œä½†è¿™ä¸ªé…ç½®åº”è¯¥æ˜¯å¯é€‰çš„ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨ try-catch å®¹é”™ + webpack-merge åˆå¹¶ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// webpack.base.js</span>

<span class="hljs-comment">// âœ… å®¹é”™åŠ è½½ä¸šåŠ¡é…ç½®</span>
<span class="hljs-keyword">let</span> businessWebpackConfig = {};
<span class="hljs-keyword">try</span> {
  businessWebpackConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">`<span class="hljs-subst">${process.cwd()}</span>/app/webpack.config.js`</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-comment">// é™é»˜å¤„ç†ï¼šä¸šåŠ¡é…ç½®ä¸å­˜åœ¨æ˜¯æ­£å¸¸çš„</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœªæ‰¾åˆ°ä¸šåŠ¡ webpack é…ç½®'</span>);
}

<span class="hljs-comment">// âœ… ä½¿ç”¨ webpack-merge çš„ smart ç­–ç•¥åˆå¹¶</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = merge.<span class="hljs-title function_">smart</span>(
  baseConfig,        <span class="hljs-comment">// æ¡†æ¶åŸºç¡€é…ç½®</span>
  businessWebpackConfig  <span class="hljs-comment">// ä¸šåŠ¡é…ç½®ï¼ˆå¯é€‰ï¼Œä¼šè¦†ç›–åŸºç¡€é…ç½®ï¼‰</span>
);
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… ä¸šåŠ¡é…ç½®ç¼ºå¤±ä¸å½±å“æ¡†æ¶åŠŸèƒ½</li>
<li>âœ… ä¸šåŠ¡é…ç½®ä¼šæ™ºèƒ½åˆå¹¶ï¼ˆæ•°ç»„åˆå¹¶ï¼Œå¯¹è±¡è¦†ç›–ï¼‰</li>
<li>âœ… é™ä½ä½¿ç”¨é—¨æ§›ï¼Œæ¸è¿›å¢å¼º</li>
</ul>
<hr/>
<h2 data-id="heading-5">å…³é”®æŠ€æœ¯ç‚¹æ€»ç»“</h2>
<h3 data-id="heading-6">è·¯å¾„è§£æçš„æ ¸å¿ƒåŸåˆ™</h3>

























<table><thead><tr><th>åœºæ™¯</th><th>ä½¿ç”¨å˜é‡</th><th>åŸå› </th></tr></thead><tbody><tr><td>åŒ…å†…èµ„æºè·¯å¾„</td><td><code>__dirname</code></td><td>æŒ‡å‘åŒ…å®‰è£…ä½ç½®ï¼Œå›ºå®šä¸å˜</td></tr><tr><td>ä¸šåŠ¡èµ„æºè·¯å¾„</td><td><code>process.cwd()</code></td><td>æŒ‡å‘æ‰§è¡Œç›®å½•ï¼ŒåŠ¨æ€å˜åŒ–</td></tr><tr><td>Loader/æ’ä»¶è·¯å¾„</td><td><code>require.resolve()</code></td><td>ç¡®ä¿ä»åŒ…å†…è§£æï¼Œç‰ˆæœ¬ä¸€è‡´</td></tr></tbody></table>
<h3 data-id="heading-7">å®¹é”™è®¾è®¡æ¨¡å¼</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡å¼1ï¼šå¯é€‰é…ç½®æ£€æŸ¥ + ç©ºæ¨¡å—é™çº§</span>
<span class="hljs-keyword">const</span> config = fs.<span class="hljs-title function_">existsSync</span>(configPath) ? configPath : blankModulePath;

<span class="hljs-comment">// æ¨¡å¼2ï¼štry-catch å®¹é”™</span>
<span class="hljs-keyword">let</span> config = {};
<span class="hljs-keyword">try</span> {
  config = <span class="hljs-built_in">require</span>(configPath);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-comment">// é™é»˜å¤„ç†</span>
}
</code></pre>
<h3 data-id="heading-8">é…ç½®åˆå¹¶ç­–ç•¥</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ webpack-merge çš„ smart ç­–ç•¥</span>
<span class="hljs-keyword">const</span> finalConfig = merge.<span class="hljs-title function_">smart</span>(baseConfig, businessConfig);
<span class="hljs-comment">// - å¯¹è±¡å±æ€§ï¼šåé¢çš„è¦†ç›–å‰é¢çš„</span>
<span class="hljs-comment">// - æ•°ç»„ï¼šä¼šåˆå¹¶å»é‡ï¼ˆå¦‚ pluginsã€rulesï¼‰</span>
</code></pre>
<hr/>
<h2 data-id="heading-9">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-10">1. è·¯å¾„å¤„ç†è§„èŒƒ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… æ¨èï¼šä½¿ç”¨è¾…åŠ©å‡½æ•°æ˜ç¡®åŒºåˆ†</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getPackagePath</span>(<span class="hljs-params">...paths</span>) {
  <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'../../'</span>, ...paths);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getProjectPath</span>(<span class="hljs-params">...paths</span>) {
  <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), ...paths);
}
</code></pre>
<h3 data-id="heading-11">2. ä¾èµ–ç®¡ç†</h3>
<ul>
<li><strong>æ¡†æ¶åŒ…</strong>ï¼šæ„å»ºä¾èµ–æ”¾åœ¨ <code>dependencies</code>ï¼Œç¡®ä¿ç‰ˆæœ¬ä¸€è‡´</li>
<li><strong>ä¸šåŠ¡é¡¹ç›®</strong>ï¼šåªéœ€å®‰è£…æ¡†æ¶åŒ…ï¼Œä¾èµ–ç”±åŒ…æä¾›</li>
</ul>
<hr/>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>å°†æ¡†æ¶æŠ½ç¦»ä¸º npm åŒ…çš„æ ¸å¿ƒæŒ‘æˆ˜åœ¨äº<strong>è·¯å¾„ä¸Šä¸‹æ–‡çš„ç®¡ç†</strong>ã€‚é€šè¿‡åˆç†ä½¿ç”¨ï¼š</p>
<ol>
<li>âœ… <strong><code>__dirname</code></strong> - è®¿é—®åŒ…å†…èµ„æºï¼ˆå›ºå®šï¼‰</li>
<li>âœ… <strong><code>process.cwd()</code></strong> - è®¿é—®ä¸šåŠ¡é¡¹ç›®èµ„æºï¼ˆåŠ¨æ€ï¼‰</li>
<li>âœ… <strong><code>require.resolve()</code></strong> - è§£æåŒ…å†…ä¾èµ–ï¼ˆç‰ˆæœ¬ä¸€è‡´ï¼‰</li>
<li>âœ… <strong>å®¹é”™è®¾è®¡</strong> - å¯é€‰é…ç½®ä¼˜é›…é™çº§</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è½»é‡çº§ Git Hooks ç®¡ç†å·¥å…· Husky]]></title>    <link>https://juejin.cn/post/7592622563547316259</link>    <guid>https://juejin.cn/post/7592622563547316259</guid>    <pubDate>2026-01-08T14:26:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592622563547316259" data-draft-id="7592829037937426447" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è½»é‡çº§ Git Hooks ç®¡ç†å·¥å…· Husky"/> <meta itemprop="keywords" content="å‰ç«¯,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2026-01-08T14:26:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ™¨ç±³é…±"/> <meta itemprop="url" content="https://juejin.cn/user/712900761892056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è½»é‡çº§ Git Hooks ç®¡ç†å·¥å…· Husky
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/712900761892056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ™¨ç±³é…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T14:26:34.000Z" title="Thu Jan 08 2026 14:26:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    12
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. æ¦‚è¿°</h2>
<h3 data-id="heading-1">1.1 ä»€ä¹ˆæ˜¯ Husky</h3>
<p>Husky æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Git Hooks ç®¡ç†å·¥å…·ï¼Œä¸“ä¸º Node.js é¡¹ç›®è®¾è®¡ã€‚å®ƒåˆ©ç”¨ Git çš„ <code>core.hooksPath</code> ç‰¹æ€§ï¼Œè®©å›¢é˜Ÿå¯ä»¥åœ¨ç‰ˆæœ¬æ§åˆ¶ä¸­å…±äº« Git Hooks é…ç½®ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>





























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>è½»é‡</td><td>ä»… 2kBï¼ˆgzippedï¼‰ï¼Œé›¶ä¾èµ–</td></tr><tr><td>å¿«é€Ÿ</td><td>æ‰§è¡Œæ—¶é—´çº¦ 1ms</td></tr><tr><td>è·¨å¹³å°</td><td>æ”¯æŒ macOSã€Linuxã€Windows</td></tr><tr><td>å…¨é¢æ”¯æŒ</td><td>æ”¯æŒå…¨éƒ¨ 13 ç§å®¢æˆ·ç«¯ Git Hooks</td></tr><tr><td>ç”Ÿæ€å®Œå–„</td><td>ä¸ lint-stagedã€commitlint ç­‰å·¥å…·æ— ç¼é›†æˆ</td></tr></tbody></table>
<h3 data-id="heading-2">1.2 å·¥ä½œåŸç†</h3>
<pre><code class="hljs language-sql" lang="sql">é¡¹ç›®ç›®å½•<span class="hljs-operator">/</span>
â”œâ”€â”€ .husky<span class="hljs-operator">/</span>
â”‚   â”œâ”€â”€ pre<span class="hljs-operator">-</span><span class="hljs-keyword">commit</span>      # pre<span class="hljs-operator">-</span><span class="hljs-keyword">commit</span> hook è„šæœ¬
â”‚   â””â”€â”€ <span class="hljs-keyword">commit</span><span class="hljs-operator">-</span>msg      # <span class="hljs-keyword">commit</span><span class="hljs-operator">-</span>msg hook è„šæœ¬
â”œâ”€â”€ package.json        # åŒ…å« <span class="hljs-keyword">prepare</span> è„šæœ¬
â””â”€â”€ ...
</code></pre>
<ol>
<li><strong>å®‰è£…æ—¶</strong>ï¼šè®¾ç½® Git çš„ <code>core.hooksPath</code> æŒ‡å‘ <code>.husky</code> ç›®å½•</li>
<li><strong>è§¦å‘æ—¶</strong>ï¼šGit äº‹ä»¶è§¦å‘ <code>.husky</code> ç›®å½•ä¸­å¯¹åº”çš„è„šæœ¬</li>
<li><strong>æ‰§è¡Œæ—¶</strong>ï¼šè„šæœ¬è¿è¡ŒæŒ‡å®šå‘½ä»¤ï¼Œå¤±è´¥åˆ™é˜»æ­¢ Git æ“ä½œ</li>
</ol>
<h2 data-id="heading-3">2. å®‰è£…å’Œé…ç½®</h2>
<h3 data-id="heading-4">2.1 å¿«é€Ÿå¼€å§‹ï¼ˆæ¨èï¼‰</h3>
<p>ä½¿ç”¨ <code>husky init</code> ä¸€é”®å®Œæˆå®‰è£…å’Œåˆå§‹åŒ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm</span>
npx husky init

<span class="hljs-comment"># pnpm</span>
pnpm <span class="hljs-built_in">exec</span> husky init

<span class="hljs-comment"># yarn</span>
yarn dlx husky init

<span class="hljs-comment"># bun</span>
bunx husky init
</code></pre>
<p>è¯¥å‘½ä»¤ä¼šè‡ªåŠ¨ï¼š</p>
<ul>
<li>å®‰è£… husky ä½œä¸ºå¼€å‘ä¾èµ–</li>
<li>åˆ›å»º <code>.husky/</code> ç›®å½•</li>
<li>åœ¨ <code>package.json</code> ä¸­æ·»åŠ  <code>prepare</code> è„šæœ¬</li>
<li>åˆ›å»ºç¤ºä¾‹ <code>pre-commit</code> hook</li>
</ul>
<h3 data-id="heading-5">2.2 æ‰‹åŠ¨å®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å®‰è£…</span>
npm install husky --save-dev

<span class="hljs-comment"># 2. åˆå§‹åŒ–</span>
npx husky init
</code></pre>
<p><code>package.json</code> ä¸­çš„ prepare è„šæœ¬ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prepare"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"husky"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p><code>prepare</code> è„šæœ¬åœ¨ <code>npm install</code> åè‡ªåŠ¨æ‰§è¡Œï¼Œç¡®ä¿å›¢é˜Ÿæˆå‘˜å…‹éš†é¡¹ç›®åè‡ªåŠ¨é…ç½® hooksã€‚</p>
</blockquote>
<h3 data-id="heading-6">2.3 æ·»åŠ  Hook</h3>
<p>åˆ›å»º hook éå¸¸ç®€å•ï¼Œåªéœ€åœ¨ <code>.husky/</code> ç›®å½•ä¸‹åˆ›å»ºå¯¹åº”åç§°çš„æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³• 1ï¼šä½¿ç”¨ echo</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"npm test"</span> &gt; .husky/pre-commit

<span class="hljs-comment"># æ–¹æ³• 2ï¼šæ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶</span>
<span class="hljs-comment"># ç›´æ¥ç¼–è¾‘ .husky/pre-commit æ–‡ä»¶</span>
</code></pre>
<p>Hook è„šæœ¬ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/pre-commit</span>
npm run lint
npm <span class="hljs-built_in">test</span>
</code></pre>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šHusky v9 çš„ hook è„šæœ¬ä¸éœ€è¦ shebang è¡Œï¼ˆå¦‚ <code>#!/bin/sh</code>ï¼‰ï¼ŒHusky ä¼šè‡ªåŠ¨å¤„ç†ã€‚</p>
</blockquote>
<h3 data-id="heading-7">2.4 åœ¨ CI/Docker ä¸­ç¦ç”¨</h3>
<p>CI ç¯å¢ƒé€šå¸¸ä¸éœ€è¦ Git hooksï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³• 1ï¼šç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰</span>
HUSKY=0 npm ci

<span class="hljs-comment"># æ–¹æ³• 2ï¼šGitHub Actions</span>
- run: npm ci
  <span class="hljs-built_in">env</span>:
    HUSKY: 0

<span class="hljs-comment"># æ–¹æ³• 3ï¼špackage.json å®¹é”™å¤„ç†</span>
{
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"prepare"</span>: <span class="hljs-string">"husky || true"</span>
  }
}
</code></pre>
<h2 data-id="heading-8">3. å¸¸ç”¨ Git Hooks</h2>
<h3 data-id="heading-9">3.1 pre-commit</h3>
<p>æäº¤å‰æ‰§è¡Œï¼Œç”¨äºä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/pre-commit</span>
npx lint-staged
</code></pre>
<h3 data-id="heading-10">3.2 commit-msg</h3>
<p>éªŒè¯æäº¤ä¿¡æ¯æ ¼å¼ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/commit-msg</span>
npx --no -- commitlint --edit <span class="hljs-variable">$1</span>
</code></pre>
<p>è‡ªå®šä¹‰éªŒè¯ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/commit-msg</span>
commit_msg=$(<span class="hljs-built_in">cat</span> <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>)
pattern=<span class="hljs-string">"^(feat|fix|docs|style|refactor|test|chore)(\(.+\))?: .{1,50}"</span>

<span class="hljs-keyword">if</span> ! <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$commit_msg</span>"</span> | grep -qE <span class="hljs-string">"<span class="hljs-variable">$pattern</span>"</span>; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"é”™è¯¯ï¼šæäº¤ä¿¡æ¯æ ¼å¼ä¸æ­£ç¡®"</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æ ¼å¼ï¼š&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;"</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>
</code></pre>
<h3 data-id="heading-11">3.3 pre-push</h3>
<p>æ¨é€å‰æ‰§è¡Œï¼Œç”¨äºè¿è¡Œæµ‹è¯•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/pre-push</span>
npm <span class="hljs-built_in">test</span>
npm run build
</code></pre>
<h3 data-id="heading-12">3.4 post-merge</h3>
<p>åˆå¹¶/æ‹‰å–åæ‰§è¡Œï¼Œç”¨äºè‡ªåŠ¨æ›´æ–°ä¾èµ–ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/post-merge</span>
changed=$(git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD)

<span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$changed</span>"</span> | grep -q <span class="hljs-string">"package-lock.json"</span>; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"ä¾èµ–å˜åŒ–ï¼Œæ­£åœ¨å®‰è£…..."</span>
    npm ci
<span class="hljs-keyword">fi</span>
</code></pre>
<h2 data-id="heading-13">4. ä¸å…¶ä»–å·¥å…·é›†æˆ</h2>
<h3 data-id="heading-14">4.1 lint-staged</h3>
<p>åªå¯¹æš‚å­˜æ–‡ä»¶è¿è¡Œæ£€æŸ¥ï¼Œå¤§å¹…æå‡é€Ÿåº¦ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm install lint-staged --save-dev
</code></pre>
<p><strong>package.json é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"lint-staged"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"*.{js,ts,jsx,tsx}"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"eslint --fix"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"prettier --write"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"*.{css,scss}"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --write"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"*.md"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --write"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>Husky é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/pre-commit</span>
npx lint-staged
</code></pre>
<h3 data-id="heading-15">4.2 commitlint</h3>
<p>æ£€æŸ¥æäº¤ä¿¡æ¯æ˜¯å¦ç¬¦åˆ Conventional Commits è§„èŒƒã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm install @commitlint/cli @commitlint/config-conventional --save-dev
</code></pre>
<p><strong>commitlint.config.jsï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">extends</span>: [<span class="hljs-string">'@commitlint/config-conventional'</span>],
};
</code></pre>
<p><strong>Husky é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/commit-msg</span>
npx --no -- commitlint --edit <span class="hljs-variable">$1</span>
</code></pre>
<h3 data-id="heading-16">4.3 å®Œæ•´é…ç½®ç¤ºä¾‹</h3>
<p><strong>package.jsonï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prepare"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"husky"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint src"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"jest"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@commitlint/cli"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^19.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@commitlint/config-conventional"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^19.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"husky"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^9.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint-staged"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^15.0.0"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"lint-staged"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"*.{js,ts}"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"eslint --fix"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"prettier --write"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>.husky/pre-commitï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">npx lint-staged
</code></pre>
<p><strong>.husky/commit-msgï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">npx --no -- commitlint --edit <span class="hljs-variable">$1</span>
</code></pre>
<h2 data-id="heading-17">5. æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-18">5.1 æ€§èƒ½ä¼˜åŒ–</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ lint-staged åªæ£€æŸ¥å˜æ›´æ–‡ä»¶</span>
npx lint-staged

<span class="hljs-comment"># ESLint å¯ç”¨ç¼“å­˜</span>
eslint --fix --cache

<span class="hljs-comment"># è€—æ—¶ä»»åŠ¡æ”¾åˆ° pre-push è€Œé pre-commit</span>
</code></pre>
<h3 data-id="heading-19">5.2 Monorepo é…ç½®</h3>
<p>å½“ <code>package.json</code> ä¸åœ¨ Git æ ¹ç›®å½•æ—¶ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prepare"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cd .. &amp;&amp; husky frontend/.husky"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-20">5.3 å¯åŠ¨æ–‡ä»¶</h3>
<p>é…ç½® Node ç‰ˆæœ¬ç®¡ç†å™¨ï¼ˆnvmã€fnm ç­‰ï¼‰çš„åˆå§‹åŒ–è„šæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ~/.config/husky/init.sh</span>
<span class="hljs-built_in">export</span> NVM_DIR=<span class="hljs-string">"<span class="hljs-variable">$HOME</span>/.nvm"</span>
[ -s <span class="hljs-string">"<span class="hljs-variable">$NVM_DIR</span>/nvm.sh"</span> ] &amp;&amp; \. <span class="hljs-string">"<span class="hljs-variable">$NVM_DIR</span>/nvm.sh"</span>
</code></pre>
<h2 data-id="heading-21">6. æ•…éšœæ’é™¤</h2>
<h3 data-id="heading-22">6.1 Hooks ä¸æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ£€æŸ¥ hook æ–‡ä»¶åæ˜¯å¦æ­£ç¡®ï¼ˆä¸èƒ½æ˜¯ precommit æˆ– pre-commit.shï¼‰</span>
<span class="hljs-built_in">ls</span> .husky/

<span class="hljs-comment"># 2. æ£€æŸ¥ Git hooks è·¯å¾„</span>
git config core.hooksPath

<span class="hljs-comment"># 3. ç¡®ä¿ Git ç‰ˆæœ¬ &gt;= 2.9</span>
git --version

<span class="hljs-comment"># 4. é‡æ–°åˆå§‹åŒ–</span>
npx husky init
</code></pre>
<h3 data-id="heading-23">6.2 Command not found</h3>
<p>GUI åº”ç”¨æˆ–æŸäº›ç¯å¢ƒå¯èƒ½æ‰¾ä¸åˆ° node/npmï¼Œé…ç½®å¯åŠ¨æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ~/.config/husky/init.sh</span>
<span class="hljs-built_in">export</span> PATH=<span class="hljs-string">"/usr/local/bin:<span class="hljs-variable">$PATH</span>"</span>
</code></pre>
<h3 data-id="heading-24">6.3 å¸è½½åæ®‹ç•™é—®é¢˜</h3>
<p>å¦‚æœå¸è½½ Husky å hooks ä»ç„¶å¤±è´¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">git config --<span class="hljs-built_in">unset</span> core.hooksPath
</code></pre>
<h3 data-id="heading-25">6.4 Windows + Yarn é—®é¢˜</h3>
<p>Git Bash é…åˆ Yarn å¯èƒ½å‡ºç° "stdin is not a tty" é”™è¯¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/common.sh</span>
<span class="hljs-keyword">if</span> [ -t 1 ]; <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">exec</span> &lt; /dev/tty
<span class="hljs-keyword">fi</span>
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/pre-commit</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span>/common.sh"</span>
yarn lint
</code></pre>
<h3 data-id="heading-26">6.5 è·³è¿‡ Hooks</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å•æ¬¡è·³è¿‡</span>
git commit --no-verify -m <span class="hljs-string">"message"</span>
git push --no-verify

<span class="hljs-comment"># ä¸´æ—¶ç¦ç”¨æ‰€æœ‰ hooks</span>
HUSKY=0 git commit -m <span class="hljs-string">"message"</span>

<span class="hljs-comment"># å¤šä¸ªå‘½ä»¤</span>
<span class="hljs-built_in">export</span> HUSKY=0
git add .
git commit -m <span class="hljs-string">"message"</span>
<span class="hljs-built_in">unset</span> HUSKY
</code></pre>
<h3 data-id="heading-27">6.6 æµ‹è¯• Hook</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç›´æ¥è¿è¡Œè„šæœ¬</span>
sh .husky/pre-commit

<span class="hljs-comment"># æ·»åŠ  exit 1 æµ‹è¯•æ˜¯å¦èƒ½é˜»æ­¢æäº¤</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"exit 1"</span> &gt;&gt; .husky/pre-commit

<span class="hljs-comment"># æŸ¥çœ‹è¯¦ç»†æ‰§è¡Œè¿‡ç¨‹</span>
GIT_TRACE=1 git commit -m <span class="hljs-string">"test"</span>
</code></pre>
<h2 data-id="heading-28">7. ç‰ˆæœ¬è¿ç§»</h2>
<h3 data-id="heading-29">7.1 ä» v4 è¿ç§»åˆ° v9</h3>
<p><strong>v4 é…ç½®ï¼ˆæ—§ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"husky"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"pre-commit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"lint-staged"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"commit-msg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"commitlint -E HUSKY_GIT_PARAMS"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>v9 é…ç½®ï¼ˆæ–°ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/pre-commit</span>
npx lint-staged
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .husky/commit-msg</span>
npx --no -- commitlint --edit <span class="hljs-variable">$1</span>
</code></pre>
<p><strong>è¿ç§»æ­¥éª¤ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å‡çº§</span>
npm install husky@latest --save-dev

<span class="hljs-comment"># 2. åˆ é™¤ package.json ä¸­çš„ "husky" å­—æ®µ</span>

<span class="hljs-comment"># 3. åˆå§‹åŒ–</span>
npx husky init

<span class="hljs-comment"># 4. åˆ›å»º hooks</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"npx lint-staged"</span> &gt; .husky/pre-commit
<span class="hljs-built_in">echo</span> <span class="hljs-string">"npx --no -- commitlint --edit \$1"</span> &gt; .husky/commit-msg
</code></pre>
<p><strong>ä¸»è¦å˜åŒ–ï¼š</strong></p>






























<table><thead><tr><th>æ–¹é¢</th><th>v4</th><th>v9</th></tr></thead><tbody><tr><td>é…ç½®ä½ç½®</td><td>package.json</td><td>.husky/ ç›®å½•</td></tr><tr><td>Hook æ ¼å¼</td><td>JSON</td><td>Shell è„šæœ¬</td></tr><tr><td>ç¯å¢ƒå˜é‡</td><td>HUSKY_GIT_PARAMS</td><td>$1</td></tr><tr><td>å¤§å°</td><td>~1MB</td><td>2kB</td></tr></tbody></table>
<h2 data-id="heading-30">å‚è€ƒèµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftypicode.github.io%2Fhusky%2F" target="_blank" title="https://typicode.github.io/husky/" ref="nofollow noopener noreferrer">Husky å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgit-scm.com%2Fdocs%2Fgithooks" target="_blank" title="https://git-scm.com/docs/githooks" ref="nofollow noopener noreferrer">Git Hooks</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.npmjs.com%2Fcli%2Fv11%2Fusing-npm%2Fscripts" target="_blank" title="https://docs.npmjs.com/cli/v11/using-npm/scripts" ref="nofollow noopener noreferrer">NPM Script</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flint-staged%2Flint-staged" target="_blank" title="https://github.com/lint-staged/lint-staged" ref="nofollow noopener noreferrer">lint-staged</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcommitlint.js.org%2F" target="_blank" title="https://commitlint.js.org/" ref="nofollow noopener noreferrer">commitlint</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ å‰ç«¯ä¸‰å‰‘å®¢-35 /Lesson58(2025-12-08)ã€‘JavaScript åŸå‹ç»§æ‰¿ä¸å¯¹è±¡åˆ›å»ºæœºåˆ¶è¯¦è§£ğŸ§¬]]></title>    <link>https://juejin.cn/post/7592823500416729114</link>    <guid>https://juejin.cn/post/7592823500416729114</guid>    <pubDate>2026-01-08T14:28:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592823500416729114" data-draft-id="7592822714068140083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ å‰ç«¯ä¸‰å‰‘å®¢-35 /Lesson58(2025-12-08)ã€‘JavaScript åŸå‹ç»§æ‰¿ä¸å¯¹è±¡åˆ›å»ºæœºåˆ¶è¯¦è§£ğŸ§¬"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-08T14:28:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jing_Rainbow"/> <meta itemprop="url" content="https://juejin.cn/user/1285809519198256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ å‰ç«¯ä¸‰å‰‘å®¢-35 /Lesson58(2025-12-08)ã€‘JavaScript åŸå‹ç»§æ‰¿ä¸å¯¹è±¡åˆ›å»ºæœºåˆ¶è¯¦è§£ğŸ§¬
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1285809519198256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jing_Rainbow
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T14:28:59.000Z" title="Thu Jan 08 2026 14:28:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ğŸ§¬JavaScript æ˜¯ä¸€é—¨åŸºäºåŸå‹ï¼ˆPrototype-basedï¼‰çš„åŠ¨æ€è¯­è¨€ï¼Œå…¶ç»§æ‰¿æœºåˆ¶ä¸ä¼ ç»Ÿçš„ç±»å¼ï¼ˆClass-basedï¼‰è¯­è¨€ï¼ˆå¦‚ Javaã€C++ï¼‰æœ‰æœ¬è´¨åŒºåˆ«ã€‚æœ¬æ–‡å°†ç³»ç»Ÿæ€§åœ°è®²è§£ JavaScript ä¸­ <strong>åŸå‹ç»§æ‰¿</strong> çš„æ ¸å¿ƒåŸç†ã€å¤šç§å®ç°æ–¹å¼ã€å¯¹è±¡åˆ›å»ºæ–¹æ³•ã€<code>call</code>/<code>apply</code> çš„ä½œç”¨ã€ç»„åˆç»§æ‰¿ä¼˜åŒ–æŠ€å·§ã€ä»¥åŠç°ä»£ ES6 <code>class</code> è¯­æ³•çš„æœ¬è´¨ï¼Œå¹¶ç»“åˆå®é™…ä»£ç æ·±å…¥å‰–ææ¯ä¸€ä¸ªç»†èŠ‚ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ”— ä¸€ã€åŸå‹ä¸åŸå‹é“¾ï¼šJavaScript ç»§æ‰¿çš„åŸºçŸ³</h2>
<h3 data-id="heading-1">ğŸ“Œ æ„é€ å‡½æ•°ã€åŸå‹ã€å®ä¾‹ä¸‰è€…å…³ç³»</h3>
<p>åœ¨ JavaScript ä¸­ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª <code>prototype</code> å±æ€§ï¼Œå®ƒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼ˆç§°ä¸º<strong>åŸå‹å¯¹è±¡</strong>ï¼‰ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ <code>new</code> å…³é”®å­—è°ƒç”¨æ„é€ å‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„å†…éƒ¨å±æ€§ <code>[[Prototype]]</code>ï¼ˆå¯é€šè¿‡ <code>__proto__</code> è®¿é—®ï¼‰ä¼šæŒ‡å‘æ„é€ å‡½æ•°çš„ <code>prototype</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params"/>) {}
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">species</span> = <span class="hljs-string">'çŒ«ç§‘åŠ¨ç‰©'</span>;

<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>æ­¤æ—¶ï¼š</p>
<ul>
<li><code>Cat</code> æ˜¯æ„é€ å‡½æ•°ï¼›</li>
<li><code>Cat.prototype</code> æ˜¯æ‰€æœ‰ <code>Cat</code> å®ä¾‹å…±äº«çš„åŸå‹å¯¹è±¡ï¼›</li>
<li><code>cat</code> æ˜¯å®ä¾‹ï¼Œå…¶ <code>__proto__</code> æŒ‡å‘ <code>Cat.prototype</code>ã€‚</li>
</ul>
<h3 data-id="heading-2">ğŸ” å±æ€§æŸ¥æ‰¾æœºåˆ¶ï¼šé®è”½ï¼ˆShadowingï¼‰</h3>
<p>å½“è®¿é—® <code>cat.species</code> æ—¶ï¼ŒJavaScript å¼•æ“æŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾ï¼š</p>
<ol>
<li><strong>å…ˆæŸ¥å®ä¾‹è‡ªèº«</strong>ï¼š<code>cat</code> æ˜¯å¦æœ‰ <code>species</code> å±æ€§ï¼Ÿ</li>
<li><strong>è‹¥æ— ï¼Œåˆ™æ²¿ <code>__proto__</code> å‘ä¸ŠæŸ¥æ‰¾</strong>ï¼šå³ <code>Cat.prototype.species</code>ï¼›</li>
<li><strong>ç»§ç»­å‘ä¸Š</strong>ï¼š<code>Cat.prototype.__proto__</code> â†’ <code>Object.prototype</code>ï¼›</li>
<li><strong>æœ€ç»ˆåˆ° <code>null</code></strong>ï¼ŒæŸ¥æ‰¾å¤±è´¥ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">species</span>); <span class="hljs-comment">// 'çŒ«ç§‘åŠ¨ç‰©'ï¼ˆæ¥è‡ªåŸå‹ï¼‰</span>

cat.<span class="hljs-property">species</span> = <span class="hljs-string">'hello'</span>; <span class="hljs-comment">// åœ¨å®ä¾‹ä¸Šå®šä¹‰åŒåå±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">species</span>); <span class="hljs-comment">// 'hello'ï¼ˆé®è”½äº†åŸå‹å±æ€§ï¼‰</span>

<span class="hljs-keyword">delete</span> cat.<span class="hljs-property">species</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">species</span>); <span class="hljs-comment">// 'çŒ«ç§‘åŠ¨ç‰©'ï¼ˆæ¢å¤åŸå‹å€¼ï¼‰</span>
</code></pre>
<blockquote>
<p>âœ… <strong>å…³é”®ç‚¹</strong>ï¼šå®ä¾‹å±æ€§ä¼˜å…ˆäºåŸå‹å±æ€§ï¼Œè¿™å°±æ˜¯â€œå±æ€§é®è”½â€ã€‚</p>
</blockquote>
<h3 data-id="heading-3">ğŸŒ åŸå‹é“¾å¯è§†åŒ–</h3>
<pre><code class="hljs language-js" lang="js">cat (å®ä¾‹)
  â””â”€ __proto__ â†’ <span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
        â””â”€ __proto__ â†’ <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
              â””â”€ __proto__ â†’ <span class="hljs-literal">null</span>
</code></pre>
<p>éªŒè¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Cat</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-literal">null</span>); <span class="hljs-comment">// true</span>
</code></pre>
<hr/>
<h2 data-id="heading-4">âš™ï¸ äºŒã€ç»§æ‰¿çš„æœ¬è´¨ï¼šå¯¹è±¡å§”æ‰˜ï¼ˆObject Delegationï¼‰</h2>
<p>JavaScript å¹¶éâ€œç±»ç»§æ‰¿â€ï¼Œè€Œæ˜¯<strong>å¯¹è±¡ç›´æ¥ä»å…¶ä»–å¯¹è±¡ç»§æ‰¿</strong>â€”â€”è¿™ç§°ä¸º<strong>å§”æ‰˜</strong>ã€‚<br/>
å½“ä½ è°ƒç”¨ <code>cat.say()</code>ï¼Œè€Œ <code>cat</code> è‡ªèº«æ²¡æœ‰ <code>say</code> æ–¹æ³•æ—¶ï¼Œå¼•æ“ä¼šå§”æ‰˜ç»™ <code>Cat.prototype</code> å»æ‰§è¡Œã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">say</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-string">'å–µå–µå–µ'</span>; };
<span class="hljs-keyword">const</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(), cat2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-property">say</span> === cat2.<span class="hljs-property">say</span>); <span class="hljs-comment">// trueï¼ˆå…±äº«åŒä¸€ä¸ªå‡½æ•°ï¼‰</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ è¿™å°±æ˜¯<strong>æ–¹æ³•å¤ç”¨</strong>çš„æ ¸å¿ƒä¼˜åŠ¿ï¼šèŠ‚çœå†…å­˜ï¼Œæé«˜æ€§èƒ½ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ğŸ§± ä¸‰ã€ç»§æ‰¿çš„å¤šç§å®ç°æ–¹å¼</h2>
<h3 data-id="heading-6">1ï¸âƒ£ åŸå‹é“¾ç»§æ‰¿ï¼ˆPrototype Chain Inheritanceï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">SuperType</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">property</span> = <span class="hljs-literal">true</span>;
}
<span class="hljs-title class_">SuperType</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getSuperValue</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">property</span>; };

<span class="hljs-keyword">function</span> <span class="hljs-title function_">SubType</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">subproperty</span> = <span class="hljs-literal">false</span>;
}
<span class="hljs-title class_">SubType</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SuperType</span>(); <span class="hljs-comment">// å…³é”®ï¼šå­ç±»åŸå‹ = çˆ¶ç±»å®ä¾‹</span>
<span class="hljs-title class_">SubType</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getSubValue</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">subproperty</span>; };
</code></pre>
<p>âœ… ä¼˜ç‚¹ï¼šç®€å•ç›´è§‚ã€‚<br/>
âŒ ç¼ºç‚¹ï¼š</p>
<ul>
<li>å¼•ç”¨ç±»å‹å±æ€§è¢«æ‰€æœ‰å®ä¾‹å…±äº«ï¼ˆå¦‚ <code>colors: []</code>ï¼‰ï¼›</li>
<li>æ— æ³•å‘çˆ¶æ„é€ å‡½æ•°ä¼ å‚ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">2ï¸âƒ£ æ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆConstructor Stealing / Classical Inheritanceï¼‰</h3>
<p>åˆ©ç”¨ <code>call</code> æˆ– <code>apply</code> åœ¨å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">SuperType</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span> = [<span class="hljs-string">'red'</span>, <span class="hljs-string">'blue'</span>];
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">SubType</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-title class_">SuperType</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name); <span class="hljs-comment">// âœ… ç»‘å®š thisï¼Œä¼ é€’å‚æ•°</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}
</code></pre>
<h4 data-id="heading-8">ğŸ” <code>call</code> vs <code>apply</code> è¯¦è§£</h4>























<table><thead><tr><th>æ–¹æ³•</th><th>è¯­æ³•</th><th>å‚æ•°å½¢å¼</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>call</code></td><td><code>func.call(thisArg, arg1, arg2, ...)</code></td><td>é€ä¸ªå‚æ•°</td><td>å‚æ•°æ•°é‡å›ºå®š</td></tr><tr><td><code>apply</code></td><td><code>func.apply(thisArg, [arg1, arg2, ...])</code></td><td>æ•°ç»„æˆ– <code>arguments</code></td><td>å‚æ•°åŠ¨æ€ã€å·²å­˜åœ¨æ•°ç»„</td></tr></tbody></table>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç¤ºä¾‹ï¼šå€Ÿç”¨æ–¹æ³•</span>
greet.<span class="hljs-title function_">call</span>(person1, <span class="hljs-string">'ä½ å¥½'</span>); 
<span class="hljs-title class_">Math</span>.<span class="hljs-property">max</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]); <span class="hljs-comment">// æ¨èæ–¹å¼</span>

<span class="hljs-comment">// ç»§æ‰¿ä¸­ä¸¤è€…ç­‰ä»·</span>
<span class="hljs-title class_">SuperType</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name);
<span class="hljs-title class_">SuperType</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, [name]);
</code></pre>
<p>âœ… ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å¯ä¼ å‚ï¼›</li>
<li>é¿å…å¼•ç”¨ç±»å‹å…±äº«ï¼ˆæ¯ä¸ªå®ä¾‹ç‹¬ç«‹å‰¯æœ¬ï¼‰ã€‚</li>
</ul>
<p>âŒ ç¼ºç‚¹ï¼š</p>
<ul>
<li>æ–¹æ³•å®šä¹‰åœ¨æ„é€ å‡½æ•°å†… â†’ æ— æ³•å¤ç”¨ï¼›</li>
<li><strong>æ— æ³•ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•</strong>ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">3ï¸âƒ£ ç»„åˆç»§æ‰¿ï¼ˆCombination Inheritanceï¼‰â­ æœ€å¸¸ç”¨</h3>
<p>ç»“åˆå‰ä¸¤ç§æ–¹å¼ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">SuperType</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span> = [<span class="hljs-string">'red'</span>, <span class="hljs-string">'blue'</span>];
}
<span class="hljs-title class_">SuperType</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayName</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>; };

<span class="hljs-keyword">function</span> <span class="hljs-title function_">SubType</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-title class_">SuperType</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name); <span class="hljs-comment">// ç»§æ‰¿å±æ€§ï¼ˆæ¯ä¸ªå®ä¾‹ç‹¬ç«‹ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-title class_">SubType</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SuperType</span>(); <span class="hljs-comment">// ç»§æ‰¿æ–¹æ³•ï¼ˆå…±äº«ï¼‰</span>
<span class="hljs-title class_">SubType</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">SubType</span>; <span class="hljs-comment">// ä¿®å¤ constructor</span>
<span class="hljs-title class_">SubType</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayAge</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>; };
</code></pre>
<p>âœ… ä¼˜ç‚¹ï¼šå…¼å…·å±æ€§ç‹¬ç«‹ + æ–¹æ³•å¤ç”¨ã€‚<br/>
âŒ ç¼ºç‚¹ï¼š<strong>çˆ¶ç±»æ„é€ å‡½æ•°è¢«è°ƒç”¨ä¸¤æ¬¡</strong>ï¼ˆä¸€æ¬¡ <code>new SuperType()</code>ï¼Œä¸€æ¬¡ <code>SuperType.call</code>ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-10">4ï¸âƒ£ åˆ©ç”¨ç©ºå¯¹è±¡ä½œä¸ºä¸­ä»‹ï¼ˆå¯„ç”Ÿç»„åˆç»§æ‰¿ï¼‰âœ¨ ä¼˜åŒ–ç‰ˆ</h3>
<p>ä¸ºé¿å…çˆ¶æ„é€ å‡½æ•°è¢«è°ƒç”¨ä¸¤æ¬¡ï¼Œå¼•å…¥<strong>ç©ºå‡½æ•°ä¸­ä»‹</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">extend</span>(<span class="hljs-params">Child, Parent</span>) {
  <span class="hljs-keyword">const</span> F = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};       <span class="hljs-comment">// ç©ºå‡½æ•°</span>
  F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>; <span class="hljs-comment">// ä¸­ä»‹åŸå‹ = çˆ¶ç±»åŸå‹</span>
  <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();     <span class="hljs-comment">// å­ç±»åŸå‹ = ç©ºå®ä¾‹</span>
  <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>; <span class="hljs-comment">// ä¿®å¤ constructor</span>
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-title function_">extend</span>(<span class="hljs-title class_">Cat</span>, <span class="hljs-title class_">Animal</span>);
</code></pre>
<blockquote>
<p>ğŸ§  åŸç†ï¼š<code>new F()</code> ä¸ä¼šæ‰§è¡Œ <code>Parent</code> æ„é€ å‡½æ•°ï¼Œåªå»ºç«‹åŸå‹é“¾æ¥ã€‚</p>
</blockquote>
<p>è¿™æ˜¯ <strong>æœ€é«˜æ•ˆçš„åŸå‹é“¾ç»§æ‰¿æ–¹å¼</strong>ï¼Œä¹Ÿæ˜¯è®¸å¤šåº“ï¼ˆå¦‚æ—©æœŸ jQueryï¼‰é‡‡ç”¨çš„æ¨¡å¼ã€‚</p>
<hr/>
<h2 data-id="heading-11">ğŸ§ª å››ã€<code>new Object()</code> ä¸ <code>new function()</code> åˆ›å»ºå¯¹è±¡çš„åŒºåˆ«</h2>
<h3 data-id="heading-12">ğŸ”¹ <code>new Object()</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> obj1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>(); <span class="hljs-comment">// {}</span>
<span class="hljs-keyword">var</span> obj2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>(<span class="hljs-string">"hello"</span>); <span class="hljs-comment">// String å¯¹è±¡</span>
</code></pre>
<ul>
<li>åŸå‹ï¼š<code>Object.prototype</code></li>
<li>åˆå§‹åŒ–èƒ½åŠ›å¼±</li>
<li>é€‚åˆåˆ›å»ºç®€å•ç©ºå¯¹è±¡</li>
</ul>
<h3 data-id="heading-13">ğŸ”¸ <code>new function()</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> user = <span class="hljs-keyword">new</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">username</span>) {
  <span class="hljs-keyword">if</span> (!username) <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">username</span> = username;
  <span class="hljs-keyword">var</span> privateVar = <span class="hljs-string">"secret"</span>; <span class="hljs-comment">// ç§æœ‰å˜é‡ï¼ˆé—­åŒ…ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">check</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">pwd</span>) { <span class="hljs-keyword">return</span> pwd === privateVar; };
};
</code></pre>
<ul>
<li>åŸå‹ï¼šè‡ªå®šä¹‰å‡½æ•°çš„ <code>prototype</code></li>
<li>æ”¯æŒå¤æ‚åˆå§‹åŒ–ã€ç§æœ‰å˜é‡ã€æ–¹æ³•å®šä¹‰</li>
<li>å¯ç”¨äº<strong>å¯¹è±¡å·¥å‚</strong></li>
</ul>






























<table><thead><tr><th>ç‰¹æ€§</th><th><code>new Object()</code></th><th><code>new function()</code></th></tr></thead><tbody><tr><td>åŸå‹</td><td><code>Object.prototype</code></td><td>è‡ªå®šä¹‰ <code>prototype</code></td></tr><tr><td>ç§æœ‰å±æ€§</td><td>âŒ</td><td>âœ…ï¼ˆé—­åŒ…ï¼‰</td></tr><tr><td>æ–¹æ³•å¤ç”¨</td><td>âŒ</td><td>âœ…ï¼ˆé€šè¿‡åŸå‹ï¼‰</td></tr><tr><td>çµæ´»æ€§</td><td>ä½</td><td>é«˜</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ åœ¨ç»§æ‰¿ä¸­ï¼Œ<code>new function()</code>ï¼ˆç©ºå‡½æ•°ï¼‰æ˜¯å®ç°ä¸­ä»‹ç»§æ‰¿çš„å…³é”®ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-14">ğŸ§© äº”ã€ES6 <code>class</code> è¯­æ³•ï¼šè¯­æ³•ç³–ï¼Œæœ¬è´¨ä»æ˜¯åŸå‹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }
  <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>;
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, grade</span>) {
    <span class="hljs-variable language_">super</span>(name); <span class="hljs-comment">// å¿…é¡»è°ƒç”¨ï¼Œç­‰ä»·äº Person.call(this, name)</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">grade</span> = grade;
  }
  <span class="hljs-title function_">study</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> is studying...`</span>;
  }
}
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š</p>
</blockquote>
<ul>
<li><code>extends</code> æœ¬è´¨ä»æ˜¯<strong>åŸºäºåŸå‹çš„ç»§æ‰¿</strong>ï¼›</li>
<li><code>super()</code> å¿…é¡»åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨ï¼›</li>
<li>é™æ€æ–¹æ³•å’Œå±æ€§ä¹Ÿå¯ç»§æ‰¿ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-15">ğŸ›  å…­ã€æœ€ä½³å®è·µä¸é«˜çº§æŠ€å·§</h2>
<h3 data-id="heading-16">âœ… ç»„åˆä¼˜äºç»§æ‰¿ï¼ˆComposition over Inheritanceï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> canFly = { <span class="hljs-title function_">fly</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Flying...'</span>); } };
<span class="hljs-keyword">const</span> canSwim = { <span class="hljs-title function_">swim</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Swimming...'</span>); } };
<span class="hljs-keyword">const</span> duck = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, canFly, canSwim);
</code></pre>
<blockquote>
<p>æ›´çµæ´»ï¼Œé¿å…ç»§æ‰¿å±‚çº§è¿‡æ·±ã€‚</p>
</blockquote>
<h3 data-id="heading-17">âœ… ä½¿ç”¨æ ‡å‡† API æ“ä½œåŸå‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è·å–åŸå‹</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(obj);

<span class="hljs-comment">// è®¾ç½®åŸå‹ï¼ˆè°¨æ…ï¼å½±å“æ€§èƒ½ï¼‰</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(obj, newProto);

<span class="hljs-comment">// åˆ›å»ºå¯¹è±¡å¹¶æŒ‡å®šåŸå‹</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(proto);
</code></pre>
<blockquote>
<p>é¿å…ä½¿ç”¨éæ ‡å‡†çš„ <code>__proto__</code>ã€‚</p>
</blockquote>
<h3 data-id="heading-18">âœ… é‡å†™åŸå‹æ—¶ä¿®å¤ <code>constructor</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-attr">constructor</span>: <span class="hljs-title class_">Person</span>, <span class="hljs-comment">// æ‰‹åŠ¨è®¾ç½®</span>
  <span class="hljs-title function_">method1</span>(<span class="hljs-params"/>) {},
  <span class="hljs-title function_">method2</span>(<span class="hljs-params"/>) {}
};
</code></pre>
<p>å¦åˆ™ <code>instance.constructor</code> ä¼šæŒ‡å‘ <code>Object</code>ã€‚</p>
<hr/>
<h2 data-id="heading-19">âš ï¸ ä¸ƒã€å¸¸è§é™·é˜±ä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-20">1. åŸå‹ä¸Šä¸è¦æ”¾å¼•ç”¨ç±»å‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// âŒ é”™è¯¯</span>
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">skills</span> = [<span class="hljs-string">'JS'</span>, <span class="hljs-string">'HTML'</span>]; <span class="hljs-comment">// æ‰€æœ‰å®ä¾‹å…±äº«ï¼</span>

<span class="hljs-comment">// âœ… æ­£ç¡®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">skills</span> = [<span class="hljs-string">'JS'</span>, <span class="hljs-string">'HTML'</span>]; <span class="hljs-comment">// æ¯ä¸ªå®ä¾‹ç‹¬ç«‹</span>
}
</code></pre>
<h3 data-id="heading-21">2. åŸå‹é“¾è¿‡æ·±å½±å“æ€§èƒ½</h3>
<p>é¢‘ç¹è®¿é—®çš„å±æ€§åº”ç›´æ¥å®šä¹‰åœ¨å®ä¾‹ä¸Šï¼Œé¿å…é•¿é“¾æŸ¥æ‰¾ã€‚</p>
<h3 data-id="heading-22">3. <code>instanceof</code> åŸç†</h3>
<pre><code class="hljs language-java" lang="java">myDog <span class="hljs-keyword">instanceof</span> Dog; <span class="hljs-comment">// æ£€æŸ¥ Dog.prototype æ˜¯å¦åœ¨ myDog çš„åŸå‹é“¾ä¸Š</span>
</code></pre>
<hr/>
<h2 data-id="heading-23">ğŸ§ª å…«ã€ç»¼åˆç¤ºä¾‹ï¼šå®Œæ•´çš„åŠ¨ç‰©ç»§æ‰¿ä½“ç³»</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// çˆ¶ç±»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">alive</span> = <span class="hljs-literal">true</span>;
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-attr">constructor</span>: <span class="hljs-title class_">Animal</span>,
  <span class="hljs-title function_">eat</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> åœ¨è¿›é£Ÿ`</span>); },
  <span class="hljs-title function_">sleep</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> åœ¨ç¡è§‰`</span>); }
};

<span class="hljs-comment">// å­ç±»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params">name, breed</span>) {
  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name); <span class="hljs-comment">// æ„é€ å‡½æ•°ç»§æ‰¿</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">breed</span> = breed;
}

<span class="hljs-comment">// åŸå‹é“¾ç»§æ‰¿ï¼ˆç©ºå¯¹è±¡ä¸­ä»‹ï¼‰</span>
<span class="hljs-keyword">const</span> F = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};
F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Dog</span>;

<span class="hljs-comment">// æ‰©å±•æ–¹æ³•</span>
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">bark</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> æ±ªæ±ªå«`</span>);
};

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> myDog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'å°é»‘'</span>, <span class="hljs-string">'æ‹‰å¸ƒæ‹‰å¤š'</span>);
myDog.<span class="hljs-title function_">eat</span>();  <span class="hljs-comment">// ç»§æ‰¿è‡ªåŠ¨ç‰©</span>
myDog.<span class="hljs-title function_">bark</span>(); <span class="hljs-comment">// ç‹—ç‰¹æœ‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myDog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>); <span class="hljs-comment">// true</span>
</code></pre>
<hr/>
<h2 data-id="heading-24">ğŸŒˆ æ€»ç»“</h2>
<p>JavaScript çš„ç»§æ‰¿æœºåˆ¶å›´ç»• <strong>åŸå‹é“¾</strong> å’Œ <strong>å¯¹è±¡å§”æ‰˜</strong> å±•å¼€ï¼Œæ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ„é€ å‡½æ•°</strong>ï¼šåˆ›å»ºå¯¹è±¡çš„æ¨¡æ¿ï¼›</li>
<li><strong>prototype</strong>ï¼šå…±äº«å±æ€§å’Œæ–¹æ³•çš„å®¹å™¨ï¼›</li>
<li><strong><strong>proto</strong></strong>ï¼šå®ä¾‹æŒ‡å‘åŸå‹çš„é“¾æ¥ï¼›</li>
<li><strong>call/apply</strong>ï¼šå®ç°æ„é€ å‡½æ•°ç»§æ‰¿çš„å…³é”®ï¼›</li>
<li><strong>ç»„åˆç»§æ‰¿ + ç©ºå¯¹è±¡ä¸­ä»‹</strong>ï¼šæœ€ä¼˜å®è·µï¼›</li>
<li><strong>ES6 class</strong>ï¼šè¯­æ³•ç³–ï¼Œåº•å±‚ä»æ˜¯åŸå‹ã€‚</li>
</ul>
<p>ç†è§£è¿™äº›æœºåˆ¶ï¼Œä¸ä»…èƒ½å†™å‡ºå¥å£®çš„ç»§æ‰¿ä»£ç ï¼Œè¿˜èƒ½æ·±å…¥æŒæ¡ JavaScript çš„é¢å‘å¯¹è±¡å“²å­¦â€”â€”<strong>ä¸‡ç‰©çš†å¯¹è±¡ï¼Œç»§æ‰¿å³å§”æ‰˜</strong>ã€‚</p>
<blockquote>
<p>ğŸ§  è®°ä½ï¼šJavaScript ä¸æ˜¯â€œæ¨¡æ‹Ÿç±»â€ï¼Œè€Œæ˜¯<strong>åŸç”Ÿæ”¯æŒå¯¹è±¡é—´ç›´æ¥ç»§æ‰¿</strong>ã€‚æ‹¥æŠ±åŸå‹ï¼Œè€Œéå¯¹æŠ—å®ƒã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# Vue äº‹ä»¶ç³»ç»Ÿæ ¸å¿ƒï¼šcreateInvoker å‡½æ•°æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7592811397505728563</link>    <guid>https://juejin.cn/post/7592811397505728563</guid>    <pubDate>2026-01-08T15:38:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592811397505728563" data-draft-id="7592823500416892954" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# Vue äº‹ä»¶ç³»ç»Ÿæ ¸å¿ƒï¼šcreateInvoker å‡½æ•°æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="Vue.js,JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-08T15:38:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¦‚æœä½ å¥½"/> <meta itemprop="url" content="https://juejin.cn/user/2272012281328215"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # Vue äº‹ä»¶ç³»ç»Ÿæ ¸å¿ƒï¼šcreateInvoker å‡½æ•°æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2272012281328215/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¦‚æœä½ å¥½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T15:38:37.000Z" title="Thu Jan 08 2026 15:38:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue äº‹ä»¶ç³»ç»Ÿæ ¸å¿ƒï¼šcreateInvoker å‡½æ•°æ·±åº¦è§£æ</h2>
<blockquote>
<p>ğŸ”¥ ç”¨è¿‡ Vue çš„éƒ½çŸ¥é“ï¼Œå†™ @clickã€@input è¿™ç§äº‹ä»¶ç»‘å®šå¾ˆç®€å•ï¼Œä½†ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼šèƒŒå Vue æ˜¯æ€ä¹ˆå¤„ç†è¿™äº›äº‹ä»¶çš„ï¼Ÿå°¤å…¶æ˜¯å½“äº‹ä»¶å›è°ƒéœ€è¦åŠ¨æ€å˜åŒ–æ—¶ï¼Œå®ƒæ˜¯æ€ä¹ˆåšåˆ°ä¸é¢‘ç¹ç»‘å®š/è§£ç»‘ DOM äº‹ä»¶ï¼Œè¿˜èƒ½ä¿è¯æ€§èƒ½çš„ï¼Ÿ</p>
</blockquote>
<p>ç­”æ¡ˆå°±è—åœ¨ createInvoker è¿™ä¸ªå‡½æ•°é‡Œã€‚å®ƒæ˜¯ Vueï¼ˆç‰¹åˆ«æ˜¯ Vue3ï¼‰äº‹ä»¶ç³»ç»Ÿé‡Œçš„â€œäº‹ä»¶è°ƒç”¨å™¨å·¥å‚â€ï¼Œæ ¸å¿ƒä½œç”¨å°±æ˜¯åˆ›å»ºä¸€ä¸ªèƒ½çµæ´»æ›´æ–°é€»è¾‘çš„è°ƒç”¨å™¨ã€‚æœ¬æ–‡ä»ä»£ç ç»“æ„å¼€å§‹ï¼Œä¸€æ­¥æ­¥æŠŠå®ƒæ‰’æ˜ç™½ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å…ˆçœ‹æ ¸å¿ƒä»£ç ï¼šæç®€ä½†è—ç„æœº</h3>
<p>å…ˆä¸Š createInvoker çš„æ ¸å¿ƒå®ç°ï¼ˆç®€åŒ–ç‰ˆï¼Œä¿ç•™æœ€å…³é”®çš„é€»è¾‘ï¼‰ï¼Œæˆ‘ä»¬é€è¡Œçœ‹å®ƒåˆ°åº•åœ¨åšä»€ä¹ˆï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createInvoker</span>(<span class="hljs-params">value</span>) { 
  <span class="hljs-comment">// 1. å®šä¹‰ä¸€ä¸ªè°ƒç”¨å™¨å‡½æ•°ï¼Œç”¨ç®­å¤´å‡½æ•°å†™çš„</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">invoker</span> = (<span class="hljs-params">e</span>) =&gt; { 
    invoker.<span class="hljs-title function_">value</span>(e)  <span class="hljs-comment">// è°ƒç”¨å™¨å†…éƒ¨ï¼Œä¼šå»æ‰§è¡Œè‡ªå·±èº«ä¸Šçš„ value å±æ€§</span>
  } 

  <span class="hljs-comment">// 2. ç»™è¿™ä¸ªè°ƒç”¨å™¨å‡½æ•°æŒ‚ä¸ª value å±æ€§ï¼ŒæŒ‡å‘ä¼ å…¥çš„äº‹ä»¶å›è°ƒ</span>
  invoker.<span class="hljs-property">value</span> = value 

  <span class="hljs-comment">// 3. æŠŠè°ƒç”¨å™¨è¿”å›å‡ºå»ï¼ˆå‡½æ•°æœ«å°¾æ²¡å†™ return ï¼Œé»˜è®¤è¿”å›è¿™ä¸ª invokerï¼‰</span>
}
</code></pre>
<p>è¿™æ®µä»£ç çœ‹ç€ç‰¹åˆ«ç®€å•ï¼Œä½†å…¶å®å°±åšäº†ä¸‰ä»¶æ ¸å¿ƒäº‹ï¼Œç†è§£äº†è¿™ä¸‰ä»¶äº‹ï¼Œå°±æ‡‚äº†ä¸€åŠï¼š</p>
<ul>
<li>é€ ä¸€ä¸ªâ€œä¸­é—´å±‚â€ï¼šinvoker æ˜¯ä¸ªç®­å¤´å‡½æ•°ï¼Œåç»­ DOM äº‹ä»¶å®é™…ç»‘çš„å°±æ˜¯å®ƒï¼›</li>
<li>å­˜çœŸå®é€»è¾‘ï¼šæŠŠæˆ‘ä»¬å†™çš„äº‹ä»¶å›è°ƒï¼ˆæ¯”å¦‚ onClick é‡Œçš„ handleClickï¼‰ï¼ŒæŒ‚åœ¨ invoker çš„ value å±æ€§ä¸Šï¼›</li>
<li>è¿”å›ä¸­é—´å±‚ï¼šæŠŠè¿™ä¸ª invoker è¿”å›å‡ºå»ï¼Œç”¨äºåç»­çš„ DOM äº‹ä»¶ç»‘å®šã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€ä¸‰ä¸ªå…³é”®è®¾è®¡ï¼šä¸ºå•¥è¿™å‡½æ•°è¿™ä¹ˆå¥½ç”¨ï¼Ÿ</h3>
<p>createInvoker ä¹‹æ‰€ä»¥èƒ½æˆä¸º Vue äº‹ä»¶ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œå…¨é ä¸‰ä¸ªç‰¹åˆ«å·§å¦™çš„è®¾è®¡ã€‚è¿™äº›è®¾è®¡ä¸æ˜¯å‡­ç©ºæ¥çš„ï¼Œéƒ½æ˜¯ä¸ºäº†è§£å†³å®é™…å¼€å‘ä¸­çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-3">1. å‡½æ•°å±…ç„¶ä¹Ÿæ˜¯å¯¹è±¡ï¼Ÿè¿™æ˜¯åŸºç¡€</h4>
<p>é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ª JavaScript é‡Œçš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼šå‡½æ•°æœ¬è´¨ä¸Šä¹Ÿæ˜¯å¯¹è±¡ã€‚æ­£å› ä¸ºå‡½æ•°æ˜¯å¯¹è±¡ï¼Œæˆ‘ä»¬æ‰èƒ½ç»™å®ƒâ€œæŒ‚å±æ€§â€â€”â€”å°±åƒä¸Šé¢ä»£ç é‡Œï¼Œç»™ invoker æŒ‚äº†ä¸ª value å±æ€§ã€‚</p>
<p>æ‰€ä»¥åœ¨ createInvoker é‡Œï¼Œinvoker å…¶å®æœ‰ä¸¤ä¸ªèº«ä»½ï¼š</p>
<ul>
<li>ä½œä¸ºâ€œå‡½æ•°â€ï¼šå®ƒæ˜¯ DOM äº‹ä»¶çš„å›è°ƒå…¥å£ï¼Œç‚¹å‡»ã€è¾“å…¥è¿™äº›äº‹ä»¶è§¦å‘æ—¶ï¼Œç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œçš„å°±æ˜¯å®ƒï¼›</li>
<li>ä½œä¸ºâ€œå¯¹è±¡â€ï¼šå®ƒèº«ä¸Šèƒ½å­˜ä¸œè¥¿ï¼Œè¿™é‡Œçš„ value å°±æ˜¯ç”¨æ¥å­˜æˆ‘ä»¬çœŸæ­£è¦æ‰§è¡Œçš„ä¸šåŠ¡å›è°ƒï¼ˆæ¯”å¦‚ handleClickï¼‰ï¼›</li>
<li>è¿™ä¸ªè®¾è®¡çš„å¦™å¤„åœ¨äºï¼šæŠŠâ€œäº‹ä»¶è§¦å‘çš„å…¥å£â€å’Œâ€œçœŸå®çš„å¤„ç†é€»è¾‘â€åˆ†å¼€äº†ã€‚åé¢è¦æ”¹é€»è¾‘çš„æ—¶å€™ï¼Œä¸ç”¨åŠ¨å…¥å£ï¼Œåªæ”¹å­˜çš„é€»è¾‘å°±è¡Œã€‚</li>
</ul>
<h4 data-id="heading-4">2. ç®­å¤´å‡½æ•°ï¼šè§£å†³ this ä¹±æŒ‡çš„å‘</h4>
<p>invoker ç”¨ç®­å¤´å‡½æ•°å®šä¹‰ï¼Œè€Œä¸æ˜¯æ™®é€šå‡½æ•°ï¼Œæ ¸å¿ƒç›®çš„å°±æ˜¯ä¿è¯ this èƒ½æ­£ç¡®æŒ‡å‘ç»„ä»¶å®ä¾‹ã€‚</p>
<p>ç”¨è¿‡æ™®é€šå‡½æ•°å½“äº‹ä»¶å›è°ƒçš„åŒå­¦éƒ½çŸ¥é“ï¼Œthis å¾ˆå®¹æ˜“ä¹±æŒ‡â€”â€”æ¯”å¦‚ç»‘åœ¨ DOM ä¸Šçš„æ™®é€šå‡½æ•°ï¼Œthis ä¼šæŒ‡å‘è§¦å‘äº‹ä»¶çš„ DOM å…ƒç´ ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬çš„ Vue ç»„ä»¶ã€‚ä½†ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ thisï¼Œå®ƒä¼šâ€œç»§æ‰¿â€å¤–å±‚ä½œç”¨åŸŸçš„ thisã€‚</p>
<p>åœ¨ Vue é‡Œï¼Œè¿™ä¸ªå¤–å±‚ä½œç”¨åŸŸçš„ this å°±æ˜¯ç»„ä»¶å®ä¾‹ã€‚æ‰€ä»¥ç”¨ç®­å¤´å‡½æ•°å†™ invokerï¼Œå°±èƒ½ç¡®ä¿äº‹ä»¶è§¦å‘æ—¶ï¼Œthis åˆšå¥½æŒ‡å‘æˆ‘ä»¬çš„ç»„ä»¶ï¼Œä¸ç”¨å†æ‰‹åŠ¨ç”¨ bind ç»‘å®šï¼Œä¹Ÿä¸ç”¨åœ¨ä¸šåŠ¡ä»£ç é‡Œé¢å¤–å¤„ç† this é—®é¢˜ã€‚</p>
<p>ä¸¾ä¸ªåä¾‹ï¼šå¦‚æœ invoker æ˜¯æ™®é€šå‡½æ•°ï¼Œç‚¹å‡» DOM æ—¶ this ä¼šæŒ‡å‘é‚£ä¸ª DOM å…ƒç´ ï¼Œè¿™æ—¶å€™åœ¨å›è°ƒé‡Œæƒ³è®¿é—® this.dataã€this.methods éƒ½ä¼šæŠ¥é”™ï¼Œå®Œå…¨ä¸ç¬¦åˆæˆ‘ä»¬çš„å¼€å‘é¢„æœŸã€‚</p>
<h4 data-id="heading-5">3. é—­åŒ… + åŠ¨æ€æ›´æ–°ï¼šä¸ç”¨åå¤æ“ä½œ DOM</h4>
<p>è¿™æ˜¯ createInvoker æœ€æ ¸å¿ƒçš„ä¼˜åŠ¿â€”â€”æ”¯æŒåŠ¨æ€æ›´æ–°äº‹ä»¶é€»è¾‘ï¼Œè¿˜ä¸ç”¨é¢‘ç¹ç»‘è§£ç»‘ DOM äº‹ä»¶ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼ŒDOM æ“ä½œæ˜¯å‰ç«¯æ€§èƒ½çš„å¤§ç“¶é¢ˆã€‚å¦‚æœæ¯æ¬¡äº‹ä»¶å›è°ƒå˜äº†ï¼Œéƒ½è¦å…ˆ removeEventListener è§£ç»‘æ—§çš„ï¼Œå† addEventListener ç»‘å®šæ–°çš„ï¼Œé¢‘ç¹æ“ä½œä¸‹æ¥æ€§èƒ½ä¼šå¾ˆå·®ã€‚</p>
<p>è€Œ createInvoker ç”¨äº†ä¸ªå·§æ‹›ï¼šå› ä¸º invoker æ˜¯é—­åŒ…ï¼ˆå†…éƒ¨å¼•ç”¨äº†è‡ªèº«çš„ value å±æ€§ï¼‰ï¼Œå½“æˆ‘ä»¬éœ€è¦æ›´æ–°äº‹ä»¶é€»è¾‘æ—¶ï¼Œç›´æ¥æ”¹ invoker.value çš„æŒ‡å‘å°±è¡Œï¼Œä¸ç”¨åŠ¨ DOM ä¸Šçš„äº‹ä»¶ç»‘å®šã€‚</p>
<p>æ¯”å¦‚åŸæ¥ invoker.value æŒ‡å‘ handleClick1ï¼Œç°åœ¨è¦æ”¹æˆ handleClick2ï¼Œç›´æ¥å†™ invoker.value = handleClick2 å°±æå®šäº†ã€‚åç»­äº‹ä»¶è§¦å‘æ—¶ï¼Œinvoker ä¼šè‡ªåŠ¨æ‰§è¡Œæ–°çš„ handleClick2ï¼Œå…¨ç¨‹ä¸ç”¨ç¢° addEventListener å’Œ removeEventListenerã€‚</p>
<h3 data-id="heading-6">ä¸‰ã€å®é™…æ‰§è¡Œæµç¨‹ï¼šä»åˆ›å»ºåˆ°æ›´æ–°å…¨æ¢³ç†</h3>
<ol>
<li><strong>åˆ›å»ºè°ƒç”¨å™¨</strong>ï¼šVue è§£ææ¨¡æ¿é‡Œçš„ @click="handleClick" æ—¶ï¼Œè°ƒç”¨ createInvoker ä¼ å…¥ handleClickï¼Œç”Ÿæˆ invokerï¼Œæ­¤æ—¶ invoker.value = handleClickï¼›</li>
<li><strong>ç»‘å®šåˆ° DOM</strong>ï¼šVue å°† invoker é€šè¿‡ addEventListener ç»‘å®šåˆ°å¯¹åº”çš„ DOM å…ƒç´ ä¸Šï¼ˆDOM ç»‘å®šçš„æ˜¯ invokerï¼Œè€Œéç›´æ¥ç»‘å®š handleClickï¼‰ï¼›</li>
<li><strong>äº‹ä»¶è§¦å‘æ‰§è¡Œ</strong>ï¼šç”¨æˆ·è§¦å‘äº‹ä»¶æ—¶ï¼Œinvoker è¢«æ‰§è¡Œï¼Œå†…éƒ¨è°ƒç”¨ invoker.value(e)ï¼Œæœ€ç»ˆæ‰§è¡Œæˆ‘ä»¬å†™çš„ handleClick(e)ï¼›</li>
<li><strong>åŠ¨æ€æ›´æ–°é€»è¾‘</strong>ï¼šéœ€è¦ä¿®æ”¹äº‹ä»¶å›è°ƒæ—¶ï¼Œç›´æ¥ä¿®æ”¹ invoker.value = æ–°å›è°ƒå‡½æ•°å³å¯ï¼Œæ— éœ€é‡æ–°ç»‘å®š DOM äº‹ä»¶ã€‚</li>
</ol>
<h3 data-id="heading-7">å››ã€ç®€å•å®ç”¨æ¡ˆä¾‹ï¼šçœ‹å®Œå°±èƒ½ä¸Šæ‰‹</h3>
<p>ä¸ç”¨æå¤æ‚çš„æºç åœºæ™¯ï¼Œè¿™ä¸¤ä¸ªç®€å•æ¡ˆä¾‹ï¼Œå¸®ä½ å¿«é€Ÿç†è§£ createInvoker åœ¨å®é™…å¼€å‘ä¸­çš„ç”¨æ³•ï¼š</p>
<h4 data-id="heading-8">æ¡ˆä¾‹ 1ï¼šæŒ‰é’®ç‚¹å‡»é€»è¾‘åŠ¨æ€åˆ‡æ¢</h4>
<p>è¿™æ˜¯æœ€åŸºç¡€çš„ç”¨æ³•ï¼Œæ¨¡æ‹Ÿ Vue é‡ŒåŠ¨æ€æ”¹äº‹ä»¶å›è°ƒçš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// å…ˆå®ç° createInvoker å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createInvoker</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">invoker</span> = (<span class="hljs-params">e</span>) =&gt; {
    invoker.<span class="hljs-title function_">value</span>(e)
  }
  invoker.<span class="hljs-property">value</span> = value
  <span class="hljs-keyword">return</span> invoker
}

<span class="hljs-comment">// å‡†å¤‡ä¸¤ä¸ªä¸åŒçš„ç‚¹å‡»é€»è¾‘</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">clickLogic1</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-title function_">alert</span>(<span class="hljs-string">'ç‚¹å‡»é€»è¾‘1ï¼šä½ ç‚¹äº†æŒ‰é’®'</span>)
}
<span class="hljs-keyword">const</span> <span class="hljs-title function_">clickLogic2</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-title function_">alert</span>(<span class="hljs-string">'ç‚¹å‡»é€»è¾‘2ï¼šæŒ‰é’®è¢«ç‚¹å‡»å•¦'</span>)
}

<span class="hljs-comment">// ç»™æŒ‰é’®ç»‘äº‹ä»¶</span>
<span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#myBtn'</span>)
<span class="hljs-comment">// åˆ›å»ºè°ƒç”¨å™¨ï¼Œåˆå§‹ç”¨é€»è¾‘1</span>
<span class="hljs-keyword">const</span> btnInvoker = <span class="hljs-title function_">createInvoker</span>(clickLogic1)
btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, btnInvoker)

<span class="hljs-comment">// 2ç§’åè‡ªåŠ¨åˆ‡æ¢æˆé€»è¾‘2ï¼ˆä¸ç”¨è§£ç»‘äº‹ä»¶ï¼‰</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  btnInvoker.<span class="hljs-property">value</span> = clickLogic2
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å·²åˆ‡æ¢ç‚¹å‡»é€»è¾‘ï¼Œå†ç‚¹æŒ‰é’®è¯•è¯•'</span>)
}, <span class="hljs-number">2000</span>)
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šé¡µé¢åŠ è½½åç‚¹æŒ‰é’®å¼¹â€œé€»è¾‘1â€ï¼Œ2ç§’åç‚¹æŒ‰é’®å¼¹â€œé€»è¾‘2â€ï¼Œå…¨ç¨‹åªç»‘äº†ä¸€æ¬¡ç‚¹å‡»äº‹ä»¶ã€‚</p>
<h4 data-id="heading-9">æ¡ˆä¾‹ 2ï¼šå¼€å…³æ§åˆ¶æ»šåŠ¨ç›‘å¬</h4>
<p>é«˜é¢‘äº‹ä»¶ï¼ˆæ¯”å¦‚ scrollï¼‰ç”¨è¿™ä¸ªæ–¹å¼ä¼˜åŒ–ç‰¹åˆ«é¦™ï¼Œä¸ç”¨åå¤ç»‘è§£ç»‘ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createInvoker</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">invoker</span> = (<span class="hljs-params">e</span>) =&gt; {
    invoker.<span class="hljs-title function_">value</span>(e)
  }
  invoker.<span class="hljs-property">value</span> = value
  <span class="hljs-keyword">return</span> invoker
}

<span class="hljs-comment">// æ»šåŠ¨ç›‘å¬é€»è¾‘ï¼šæ‰“å°æ»šåŠ¨ä½ç½®</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">scrollLogic</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ»šåŠ¨ä½ç½®ï¼š'</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">scrollY</span>)
}
<span class="hljs-comment">// ç©ºé€»è¾‘ï¼šæš‚åœç›‘å¬æ—¶ç”¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">emptyLogic</span> = (<span class="hljs-params"/>) =&gt; {}

<span class="hljs-comment">// åˆ›å»ºè°ƒç”¨å™¨ï¼Œåˆå§‹ç›‘å¬æ»šåŠ¨</span>
<span class="hljs-keyword">const</span> scrollInvoker = <span class="hljs-title function_">createInvoker</span>(scrollLogic)
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, scrollInvoker)

<span class="hljs-comment">// å¼€å…³æŒ‰é’®ï¼šç‚¹ä¸€ä¸‹æš‚åœ/æ¢å¤ç›‘å¬</span>
<span class="hljs-keyword">const</span> toggleBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#toggleScroll'</span>)
<span class="hljs-keyword">let</span> isListening = <span class="hljs-literal">true</span>
toggleBtn.<span class="hljs-property">onclick</span> = <span class="hljs-function">() =&gt;</span> {
  isListening = !isListening
  toggleBtn.<span class="hljs-property">textContent</span> = isListening ? <span class="hljs-string">'æš‚åœæ»šåŠ¨ç›‘å¬'</span> : <span class="hljs-string">'æ¢å¤æ»šåŠ¨ç›‘å¬'</span>
  <span class="hljs-comment">// åªæ”¹ invoker.value å°±è¡Œ</span>
  scrollInvoker.<span class="hljs-property">value</span> = isListening ? scrollLogic : emptyLogic
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šé»˜è®¤æ»šåŠ¨é¡µé¢ä¼šæ‰“å°ä½ç½®ï¼Œç‚¹æŒ‰é’®å°±èƒ½æš‚åœï¼Œå†ç‚¹æ¢å¤ï¼Œä¸ç”¨åŠ¨ scroll äº‹ä»¶çš„ç»‘å®šçŠ¶æ€ã€‚</p>
<h3 data-id="heading-10">äº”ã€æœ€åæ€»ç»“ä¸€ä¸‹</h3>
<p>createInvoker å‡½æ•°çœ‹ç€ç®€å•ï¼Œä½†æ ¸å¿ƒæ˜¯ä¸‰ä¸ªè®¾è®¡å·§æ€ï¼šåˆ©ç”¨â€œå‡½æ•°æ˜¯å¯¹è±¡â€å­˜é€»è¾‘ã€ç”¨ç®­å¤´å‡½æ•°ä¿ thisã€é é—­åŒ…å®ç°åŠ¨æ€æ›´æ–°ã€‚æœ€ç»ˆå®ç°äº†â€œé«˜æ•ˆã€çµæ´»ã€ä½æ€§èƒ½æŸè€—â€çš„äº‹ä»¶å¤„ç†æœºåˆ¶ï¼Œè¿™ä¹Ÿæ˜¯ Vue äº‹ä»¶ç³»ç»Ÿçš„çµé­‚ã€‚</p>
<p>è®°ä½ä¸‰ä¸ªå…³é”®ç‚¹ï¼Œå°±ç®—çœŸçš„æ‡‚äº†ï¼š</p>
<ul>
<li>invoker æ—¢æ˜¯äº‹ä»¶å›è°ƒå…¥å£ï¼ˆå‡½æ•°ï¼‰ï¼Œä¹Ÿæ˜¯é€»è¾‘å­˜å‚¨å®¹å™¨ï¼ˆå¯¹è±¡ï¼‰ï¼›</li>
<li>æ›´æ–°äº‹ä»¶é€»è¾‘ï¼Œç›´æ¥æ”¹ invoker.value å°±è¡Œï¼Œä¸ç”¨ç¢° DOMï¼›</li>
<li>ç®­å¤´å‡½æ•°ç¡®ä¿ this æŒ‡å‘ç»„ä»¶å®ä¾‹ï¼Œä¸ç”¨é¢å¤–å¤„ç† this é—®é¢˜ã€‚</li>
</ul>
<p>ç†è§£äº† createInvoker ä¹‹åï¼Œå†å»çœ‹ Vue æºç é‡Œå’Œäº‹ä»¶ç›¸å…³çš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚ patchEventï¼‰ï¼Œå°±ä¼šè§‰å¾—è±ç„¶å¼€æœ—ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">


å…­ã€æœ€åæ€»ç»“ä¸€ä¸‹

createInvoker å‡½æ•°çœ‹ç€ç®€å•ï¼Œä½†æ ¸å¿ƒæ˜¯ä¸‰ä¸ªè®¾è®¡å·§æ€ï¼šåˆ©ç”¨â€œå‡½æ•°æ˜¯å¯¹è±¡â€å­˜é€»è¾‘ã€ç”¨ç®­å¤´å‡½æ•°ä¿ <span class="hljs-keyword">this</span>ã€é é—­åŒ…å®ç°åŠ¨æ€æ›´æ–°ã€‚æœ€ç»ˆå®ç°äº†â€œé«˜æ•ˆã€çµæ´»ã€ä½æ€§èƒ½æŸè€—â€çš„äº‹ä»¶å¤„ç†æœºåˆ¶ï¼Œè¿™ä¹Ÿæ˜¯ Vue äº‹ä»¶ç³»ç»Ÿçš„çµé­‚ã€‚

è®°ä½ä¸‰ä¸ªå…³é”®ç‚¹ï¼Œå°±ç®—çœŸçš„æ‡‚äº†ï¼š

- invoker æ—¢æ˜¯äº‹ä»¶å›è°ƒå…¥å£ï¼ˆå‡½æ•°ï¼‰ï¼Œä¹Ÿæ˜¯é€»è¾‘å­˜å‚¨å®¹å™¨ï¼ˆå¯¹è±¡ï¼‰ï¼›

- æ›´æ–°äº‹ä»¶é€»è¾‘ï¼Œç›´æ¥æ”¹ invoker.value å°±è¡Œï¼Œä¸ç”¨ç¢° DOMï¼›

- ç®­å¤´å‡½æ•°ç¡®ä¿ <span class="hljs-keyword">this</span> æŒ‡å‘ç»„ä»¶å®ä¾‹ï¼Œä¸ç”¨é¢å¤–å¤„ç† <span class="hljs-keyword">this</span> é—®é¢˜ã€‚

ç†è§£äº† createInvoker ä¹‹åï¼Œå†å»çœ‹ Vue æºç é‡Œå’Œäº‹ä»¶ç›¸å…³çš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚ patchEventï¼‰ï¼Œå°±ä¼šè§‰å¾—è±ç„¶å¼€æœ—ã€‚
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«å…¨å±€æ±¡æŸ“ï¼šæ·±å…¥è§£æç°ä»£å‰ç«¯çš„æ¨¡å—åŒ– CSS æ¼”è¿›ä¹‹è·¯]]></title>    <link>https://juejin.cn/post/7592865044691353606</link>    <guid>https://juejin.cn/post/7592865044691353606</guid>    <pubDate>2026-01-08T15:44:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592865044691353606" data-draft-id="7592863358258315318" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«å…¨å±€æ±¡æŸ“ï¼šæ·±å…¥è§£æç°ä»£å‰ç«¯çš„æ¨¡å—åŒ– CSS æ¼”è¿›ä¹‹è·¯"/> <meta itemprop="keywords" content="React.js,Vue.js,CSS"/> <meta itemprop="datePublished" content="2026-01-08T15:44:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="San30"/> <meta itemprop="url" content="https://juejin.cn/user/1766294768060816"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«å…¨å±€æ±¡æŸ“ï¼šæ·±å…¥è§£æç°ä»£å‰ç«¯çš„æ¨¡å—åŒ– CSS æ¼”è¿›ä¹‹è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1766294768060816/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    San30
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T15:44:07.000Z" title="Thu Jan 08 2026 15:44:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>åœ¨å‰ç«¯å¼€å‘çš„è›®è’æ—¶ä»£ï¼ŒCSSï¼ˆå±‚å æ ·å¼è¡¨ï¼‰å°±åƒä¸€åŒ¹è„±ç¼°çš„é‡é©¬ã€‚å®ƒçš„â€œå±‚å â€ç‰¹æ€§æ—¢æ˜¯å¼ºå¤§çš„æ­¦å™¨ï¼Œä¹Ÿæ˜¯æ— æ•° Bug çš„æ ¹æºã€‚æ¯ä¸ªå‰ç«¯å·¥ç¨‹å¸ˆå¯èƒ½éƒ½ç»å†è¿‡è¿™æ ·çš„å™©æ¢¦ï¼šå½“ä½ ä¸ºäº†ä¿®å¤ä¸€ä¸ªæŒ‰é’®çš„æ ·å¼è€Œä¿®æ”¹äº† <code>.btn</code> ç±»ï¼Œç»“æœå´å‘ç°éš”å£é¡µé¢çš„å¯¼èˆªæ è«åå…¶å¦™åœ°å´©äº†ã€‚</p>
<p>è¿™å°±æ˜¯<strong>å…¨å±€å‘½åç©ºé—´æ±¡æŸ“</strong>ã€‚</p>
<p>éšç€ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„å‘å±•ï¼ŒReact å’Œ Vue ç­‰æ¡†æ¶çš„å…´èµ·ï¼Œç»„ä»¶åŒ–æˆä¸ºäº†ä¸»æµã€‚æ—¢ç„¶ HTML å’Œ JavaScript éƒ½å¯ä»¥å°è£…åœ¨ç»„ä»¶é‡Œï¼Œä¸ºä»€ä¹ˆ CSS è¿˜è¦æµè½åœ¨å¤–ï¼Œäº’ç›¸æ‰“æ¶å‘¢ï¼Ÿä»Šå¤©ï¼Œæˆ‘ä»¬å°±ç»“åˆå®é™…ä»£ç ï¼Œæ·±å…¥æ¢è®¨å‰ç«¯ç•Œæ˜¯å¦‚ä½•é€šè¿‡<strong>æ¨¡å—åŒ– CSS</strong> æ¥å½»åº•è§£å†³â€œæ ·å¼å†²çªâ€è¿™ä¸€ä¸–çºªéš¾é¢˜çš„ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ ä» Bug è¯´èµ·ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ¨¡å—åŒ–ï¼Ÿ</h2>
<p>åœ¨ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼ä¸­ï¼ŒCSS æ˜¯æ²¡æœ‰â€œä½œç”¨åŸŸâ€ï¼ˆScopeï¼‰æ¦‚å¿µçš„ã€‚æ‰€æœ‰çš„ç±»åéƒ½æš´éœ²åœ¨å…¨å±€ç¯å¢ƒä¸‹ã€‚</p>
<h3 data-id="heading-1">1.1 å‘½åå†²çªçš„ç¾éš¾</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ä¸€ä¸ªå¤§å‹å¤šäººåä½œçš„é¡¹ç›®ä¸­ã€‚</p>
<ul>
<li><strong>å¼€å‘ A</strong> è´Ÿè´£å†™ä¸€ä¸ªé€šç”¨çš„æäº¤æŒ‰é’®ï¼Œä»–ç»™æŒ‰é’®èµ·åå« <code>.button</code>ï¼Œè®¾ç½®äº†è“åº•ç™½å­—ã€‚</li>
<li><strong>å¼€å‘ B</strong> è´Ÿè´£å†™ä¸€ä¸ªä¾§è¾¹æ çš„å¼€å…³æŒ‰é’®ï¼Œä»–ä¹Ÿéšæ‰‹èµ·åå« <code>.button</code>ï¼Œè®¾ç½®äº†çº¢åº•é»‘å­—ã€‚</li>
</ul>
<p>å½“è¿™ä¸¤ä¸ªç»„ä»¶è¢«å¼•å…¥åˆ°åŒä¸€ä¸ªé¡µé¢ï¼ˆ<code>App</code>ï¼‰æ—¶ï¼ŒCSS çš„â€œå±‚å â€è§„åˆ™ï¼ˆCascadingï¼‰å°±ä¼šç”Ÿæ•ˆã€‚è°çš„æ ·å¼åœ¨æœ€ååŠ è½½ï¼Œæˆ–è€…è°çš„ä¼˜å…ˆçº§ï¼ˆSpecificityï¼‰æ›´é«˜ï¼Œè°å°±ä¼šèµ¢ã€‚ç»“æœå°±æ˜¯ï¼šè¦ä¹ˆ A çš„æŒ‰é’®å˜çº¢äº†ï¼Œè¦ä¹ˆ B çš„æŒ‰é’®å˜è“äº†ã€‚</p>
<h3 data-id="heading-2">1.2 ä¼ ç»Ÿçš„å¦¥åï¼šBEM å‘½åæ³•</h3>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»¥å‰æˆ‘ä»¬å‘æ˜äº† BEMï¼ˆBlock Element Modifierï¼‰å‘½åæ³•ï¼Œæ¯”å¦‚å†™æˆ <code>.article__button--primary</code>ã€‚è¿™ç§æ–¹æ³•è™½ç„¶æœ‰æ•ˆï¼Œä½†å®ƒæœ¬è´¨ä¸Šæ˜¯é <strong>å¼€å‘è€…çš„è‡ªè§‰</strong>å’Œ<strong>å†—é•¿çš„å‘½å</strong>æ¥æ¨¡æ‹Ÿä½œç”¨åŸŸã€‚è¿™å¹¶ä¸æ˜¯çœŸæ­£çš„æŠ€æœ¯çº¦æŸï¼Œè€Œæ˜¯ä¸€ç§å›å­åå®šã€‚</p>
<p>æˆ‘ä»¬éœ€è¦æ›´ç¡¬æ ¸çš„æ‰‹æ®µï¼š<strong>è®©å·¥å…·å¸®æˆ‘ä»¬ç”Ÿæˆç‹¬ä¸€æ— äºŒçš„åå­—</strong>ã€‚</p>
<h2 data-id="heading-3">äºŒã€ React ä¸­çš„è§£å†³æ–¹æ¡ˆï¼šCSS Modules</h2>
<p>React ç¤¾åŒºå¯¹äºè¿™ä¸ªé—®é¢˜çš„æ ‡å‡†ç­”æ¡ˆä¹‹ä¸€æ˜¯ <strong>CSS Modules</strong>ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³éå¸¸ç®€å•ç²—æš´ï¼š<strong>æ—¢ç„¶äººå–åå­—ä¼šé‡å¤ï¼Œé‚£å°±è®©æœºå™¨æ¥å–åå­—ã€‚</strong></p>
<h3 data-id="heading-4">2.1 ä»€ä¹ˆæ˜¯ CSS Modulesï¼Ÿ</h3>
<p>åœ¨ä½ çš„é¡¹ç›®ä¸­ï¼Œä½ å¯èƒ½çœ‹åˆ°è¿‡åç¼€ä¸º <code>.module.css</code> çš„æ–‡ä»¶ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå‘½åçº¦å®šï¼Œæ›´æ˜¯æ„å»ºå·¥å…·ï¼ˆå¦‚ Webpack æˆ– Viteï¼‰è¯†åˆ« CSS Module çš„æ ‡å¿—ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä¸åŒçš„æŒ‰é’®ç»„ä»¶ï¼š<code>Button</code> å’Œ <code>AnotherButton</code>ã€‚</p>
<p><strong>Button.module.css:</strong></p>
<pre><code class="hljs language-CSS" lang="CSS"><span class="hljs-selector-class">.button</span> {
    <span class="hljs-attribute">background-color</span>: lightblue;
    <span class="hljs-attribute">color</span>: black;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">20px</span>;
}

<span class="hljs-selector-class">.txt</span> {
    <span class="hljs-attribute">color</span>: red;
}
</code></pre>
<p><strong>AnotherButton.module.css:</strong></p>
<pre><code class="hljs language-CSS" lang="CSS"><span class="hljs-selector-class">.button</span> {
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#008c8c</span>;
    <span class="hljs-attribute">color</span>: white;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">20px</span>;
}
</code></pre>
<p>è¯·æ³¨æ„ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­éƒ½å®šä¹‰äº† <code>.button</code> ç±»ã€‚åœ¨ä¼ ç»Ÿ CSS ä¸­ï¼Œè¿™ç»å¯¹ä¼šå†²çªã€‚ä½†åœ¨ CSS Modules ä¸­ï¼Œè¿™ä¸¤ä¸ª <code>.button</code> æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚</p>
<h3 data-id="heading-5">2.2 ç¼–è¯‘åŸç†ï¼šå“ˆå¸Œï¼ˆHashï¼‰é­”æ³•</h3>
<p>å½“æˆ‘ä»¬åœ¨ React ç»„ä»¶ä¸­å¼•å…¥è¿™äº›æ–‡ä»¶æ—¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥å¼•å…¥ CSS å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯å¼•å…¥äº†ä¸€ä¸ª<strong>å¯¹è±¡</strong>ã€‚</p>
<p><strong>Button.jsx:</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// module.css æ˜¯ css module çš„æ–‡ä»¶</span>
<span class="hljs-comment">// react å°† css æ–‡ä»¶ ç¼–è¯‘æˆ js å¯¹è±¡</span>
<span class="hljs-keyword">import</span> styles <span class="hljs-keyword">from</span> <span class="hljs-string">'./Button.module.css'</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(styles); <span class="hljs-comment">// è®©æˆ‘ä»¬çœ‹çœ‹è¿™é‡Œæ‰“å°äº†ä»€ä¹ˆ</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Button</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{styles.txt}</span>&gt;</span>ä½ å¥½ï¼Œä¸–ç•Œï¼ï¼ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{styles.button}</span>&gt;</span>My Button<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
    )
}
</code></pre>
<p>å¦‚æœä½ åœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹ <code>console.log(styles)</code>ï¼Œä½ ä¼šå‘ç°è¾“å‡ºçš„æ˜¯ç±»ä¼¼è¿™æ ·çš„å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">{
  <span class="hljs-attr">button</span>: <span class="hljs-string">"Button_button__3a8f"</span>,
  <span class="hljs-attr">txt</span>: <span class="hljs-string">"Button_txt__5g9d"</span>
}
</code></pre>
<p><strong>æ ¸å¿ƒæœºåˆ¶ï¼š</strong></p>
<ol>
<li><strong>ç¼–è¯‘è½¬æ¢</strong>ï¼šæ„å»ºå·¥å…·è¯»å– CSS æ–‡ä»¶ï¼Œå°†ç±»åä½œä¸º Keyã€‚</li>
<li><strong>å“ˆå¸Œç”Ÿæˆ</strong>ï¼šå·¥å…·ä¼šæ ¹æ®æ–‡ä»¶åã€ç±»åå’Œæ–‡ä»¶å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ Hash å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ <code>3a8f</code>ï¼‰ï¼Œå°†å…¶æ‹¼æ¥æˆæ–°çš„ç±»åä½œä¸º Valueã€‚</li>
<li><strong>æ›¿æ¢å¼•ç”¨</strong>ï¼šåœ¨ JSX ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>{styles.button}</code>ï¼Œå®é™…ä¸Šæ¸²æŸ“åˆ° HTML ä¸Šçš„æ˜¯ <code>&lt;button class="Button_button__3a8f"&gt;</code>ã€‚</li>
</ol>
<h3 data-id="heading-6">2.3 çœŸæ­£çš„æ ·å¼éš”ç¦»</h3>
<p>ç°åœ¨æˆ‘ä»¬å†çœ‹çœ‹ <code>AnotherButton.jsx</code>ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">import</span> styles <span class="hljs-keyword">from</span> <span class="hljs-string">'./antherButton.module.css'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">AnotherButton</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// è¿™é‡Œçš„ styles.button å¯¹åº”çš„æ˜¯å®Œå…¨ä¸åŒçš„å“ˆå¸Œå€¼</span>
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{styles.button}</span>&gt;</span>Another Button<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
}
</code></pre>
<p>åœ¨ <code>App.jsx</code> ä¸­åŒæ—¶å¼•å…¥è¿™ä¸¤ä¸ªç»„ä»¶ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Button</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Button.jsx'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AnotherButton</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/AnotherButton.jsx'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      {/* è¿™é‡Œçš„æ ·å¼äº’ä¸å¹²æ‰°ï¼Œå› ä¸ºå®ƒä»¬çš„æœ€ç»ˆç±»åå®Œå…¨ä¸åŒ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AnotherButton</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<p><strong>æ€»ç»“ CSS Modules çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>å®‰å…¨æ€§</strong>ï¼šå½»åº•æœç»äº†å…¨å±€æ±¡æŸ“ï¼Œæ¯ä¸ªç»„ä»¶çš„æ ·å¼éƒ½æ˜¯ç§æœ‰çš„ã€‚</li>
<li><strong>é›¶å†²çª</strong>ï¼šå¤šäººåä½œæ—¶ï¼Œä½ å®Œå…¨ä¸éœ€è¦æ‹…å¿ƒä½ çš„ç±»åå’ŒåŒäº‹çš„é‡å¤ã€‚</li>
<li><strong>è‡ªåŠ¨åŒ–</strong>ï¼šä¸éœ€è¦äººå·¥ç»´æŠ¤å¤æ‚çš„ BEM å‘½åï¼Œæ„å»ºå·¥å…·è‡ªåŠ¨å¤„ç†ã€‚</li>
</ul>
<h2 data-id="heading-7">ä¸‰ã€ Vue ä¸­çš„è§£å†³æ–¹æ¡ˆï¼šScoped CSS</h2>
<p>Vue é‡‡ç”¨äº†å¦ä¸€ç§æ›´ç¬¦åˆç›´è§‰çš„ç­–ç•¥ã€‚Vue çš„è®¾è®¡å“²å­¦æ˜¯â€œå•æ–‡ä»¶ç»„ä»¶â€ï¼ˆSFCï¼‰ï¼Œå³ HTMLã€JSã€CSS å…¨éƒ¨å†™åœ¨ä¸€ä¸ª <code>.vue</code> æ–‡ä»¶ä¸­ã€‚ä¸ºäº†å®ç°æ ·å¼éš”ç¦»ï¼ŒVue æä¾›äº† <code>scoped</code> å±æ€§ã€‚</p>
<h3 data-id="heading-8">3.1 <code>scoped</code> çš„å·¥ä½œåŸç†</h3>
<p>çœ‹çœ‹è¿™ä¸ª <code>HelloWorld.vue</code> ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-HTML" lang="HTML"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"txt"</span>&gt;</span>ä½ å¥½ï¼Œä¸–ç•Œï¼ï¼ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"txt2"</span>&gt;</span>ä¸€ç‚¹ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.txt</span> {
  <span class="hljs-attribute">color</span>: pink;
}
<span class="hljs-selector-class">.txt2</span> {
  <span class="hljs-attribute">color</span>: palevioletred;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>å½“ä½ ç»™ <code>&lt;style&gt;</code> æ ‡ç­¾åŠ ä¸Š <code>scoped</code> å±æ€§æ—¶ï¼ŒVue çš„ç¼–è¯‘å™¨ï¼ˆé€šå¸¸æ˜¯ <code>vue-loader</code> æˆ– <code>@vitejs/plugin-vue</code>ï¼‰ä¼šåšä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li><strong>HTML æ ‡è®°</strong>ï¼šç»™æ¨¡æ¿ä¸­çš„æ¯ä¸ª DOM å…ƒç´ æ·»åŠ ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„è‡ªå®šä¹‰å±æ€§ï¼Œé€šå¸¸ä»¥ <code>data-v-</code> å¼€å¤´ï¼Œä¾‹å¦‚ <code>data-v-7ba5bd90</code>ã€‚</li>
<li><strong>CSS é‡å†™</strong>ï¼šåˆ©ç”¨ CSS çš„<strong>å±æ€§é€‰æ‹©å™¨</strong>ï¼Œå°†æ ·å¼è§„åˆ™é‡å†™ã€‚</li>
</ol>
<p>ç¼–è¯‘åçš„ CSS å˜æˆäº†è¿™æ ·ï¼š</p>
<pre><code class="hljs language-CSS" lang="CSS"><span class="hljs-selector-class">.txt</span><span class="hljs-selector-attr">[data-v-7ba5bd90]</span> {
  <span class="hljs-attribute">color</span>: pink;
}
<span class="hljs-selector-class">.txt2</span><span class="hljs-selector-attr">[data-v-7ba5bd90]</span> {
  <span class="hljs-attribute">color</span>: palevioletred;
}
</code></pre>
<p>ç¼–è¯‘åçš„ HTML å˜æˆäº†è¿™æ ·ï¼š</p>
<pre><code class="hljs language-HTML" lang="HTML"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"txt"</span> <span class="hljs-attr">data-v-7ba5bd90</span>&gt;</span>ä½ å¥½ï¼Œä¸–ç•Œï¼ï¼ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
</code></pre>
<h3 data-id="heading-9">3.2 æ ·å¼ç©¿é€ä¸çˆ¶å­ç»„ä»¶</h3>
<p>Vue çš„ Scoped æ ·å¼æœ‰ä¸€ä¸ªæœ‰è¶£çš„ç‰¹æ€§ã€‚çœ‹ <code>App.vue</code> çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-HTML" lang="HTML"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"txt"</span>&gt;</span>Hello world in App<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">HelloWorld</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.txt</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#008c8c</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>è¿™é‡Œ <code>App.vue</code> ä¹Ÿæœ‰ä¸€ä¸ª <code>.txt</code> ç±»ã€‚ä½†æ˜¯ï¼Œç”±äº <code>App.vue</code> ä¼šç”Ÿæˆä¸€ä¸ªä¸åŒçš„ <code>data-v-hash</code> IDï¼Œå®ƒçš„ CSS é€‰æ‹©å™¨ä¼šå˜æˆ <code>.txt[data-v-app-hash]</code>ï¼Œè€Œ <code>HelloWorld</code> ç»„ä»¶å†…éƒ¨çš„ <code>.txt</code> åªæœ‰ <code>.txt[data-v-helloworld-hash]</code> æ‰èƒ½åŒ¹é…ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼š<strong>çˆ¶ç»„ä»¶çš„æ ·å¼é»˜è®¤ä¸ä¼šæ³„éœ²ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶çš„æ ·å¼ä¹Ÿä¸ä¼šå½±å“çˆ¶ç»„ä»¶ã€‚</strong></p>
<p><strong>Vue Scoped çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>å¯è¯»æ€§å¥½</strong>ï¼šç±»ååœ¨å¼€å‘å·¥å…·ä¸­ä¾ç„¶ä¿æŒåŸæ ·ï¼ˆ<code>.txt</code>ï¼‰ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªå±æ€§ï¼Œè°ƒè¯•èµ·æ¥æ¯” CSS Modules çš„ä¹±ç ç±»åæ›´å‹å¥½ã€‚</li>
<li><strong>æ€§èƒ½</strong>ï¼šåªç”Ÿæˆä¸€æ¬¡ Hash IDï¼Œåˆ©ç”¨æµè§ˆå™¨åŸç”Ÿçš„å±æ€§é€‰æ‹©å™¨ï¼Œæ€§èƒ½å¼€é”€æä½ã€‚</li>
<li><strong>å¼€å‘ä½“éªŒ</strong>ï¼šæ— éœ€åƒ React é‚£æ · <code>import styles</code>ï¼Œç›´æ¥å†™ç±»åå³å¯ï¼Œç¬¦åˆä¼ ç»Ÿ HTML/CSS å¼€å‘ä¹ æƒ¯ã€‚</li>
</ul>
<h2 data-id="heading-10">å››ã€ è¿›é˜¶ç©æ³•ï¼šCSS-in-JS (Styled-Components)</h2>
<p>å¦‚æœæˆ‘ä»¬å†æ¿€è¿›ä¸€ç‚¹å‘¢ï¼Ÿæ—¢ç„¶ JavaScript ç»Ÿæ²»äº†ä¸–ç•Œï¼Œä¸ºä»€ä¹ˆä¸æŠŠ CSS ä¹Ÿå˜æˆ JavaScript çš„ä¸€éƒ¨åˆ†ï¼Ÿè¿™å°±è¯ç”Ÿäº† <strong>CSS-in-JS</strong>ï¼Œå…¶ä¸­æœ€è‘—åçš„åº“å°±æ˜¯ <code>styled-components</code>ã€‚</p>
<p>è¿™ç§æ–¹æ¡ˆåœ¨ React ç¤¾åŒºéå¸¸æµè¡Œï¼Œå®ƒå°†â€œç»„ä»¶â€å’Œâ€œæ ·å¼â€å½»åº•èåˆäº†ã€‚</p>
<h3 data-id="heading-11">4.1 ä¸‡ç‰©çš†ç»„ä»¶</h3>
<p>åœ¨æä¾›çš„ <code>APP.jsx</code> (Styled-components ç‰ˆæœ¬) ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸å†å†™ <code>.css</code> æ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥å®šä¹‰å¸¦æ ·å¼çš„ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">import</span> styled <span class="hljs-keyword">from</span> <span class="hljs-string">'styled-components'</span>;

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªåä¸º Button çš„æ ·å¼ç»„ä»¶</span>
<span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªåŒ…å«äº†æ ·å¼çš„ React ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span> = styled.<span class="hljs-property">button</span><span class="hljs-string">`
  background: <span class="hljs-subst">${props =&gt; props.primary ? <span class="hljs-string">'blue'</span> : <span class="hljs-string">'white'</span>}</span>;
  color: <span class="hljs-subst">${props =&gt; props.primary ? <span class="hljs-string">'white'</span> : <span class="hljs-string">'blue'</span>}</span>;
  border: 1px solid blue;
  padding: 8px 16px;
  border-radius: 4px;
`</span>;
</code></pre>
<p>æ³¨æ„åˆ°äº†å—ï¼Ÿè¿™é‡Œçš„ CSS æ˜¯å†™åœ¨åå¼•å·ï¼ˆ` `ï¼‰é‡Œçš„ï¼Œè¿™åœ¨ ES6 ä¸­å«åš<strong>æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆTagged Template Literalsï¼‰</strong> ã€‚</p>
<h3 data-id="heading-12">4.2 åŠ¨æ€æ ·å¼çš„å¨åŠ›</h3>
<p>CSS Modules å’Œ Vue Scoped è™½ç„¶è§£å†³äº†ä½œç”¨åŸŸé—®é¢˜ï¼Œä½†å®ƒä»¬æœ¬è´¨ä¸Šè¿˜æ˜¯é™æ€çš„ CSS æ–‡ä»¶ã€‚å¦‚æœä½ æƒ³æ ¹æ®ç»„ä»¶çš„çŠ¶æ€ï¼ˆæ¯”å¦‚ <code>primary</code>ã€<code>disabled</code>ã€<code>active</code>ï¼‰æ¥æ”¹å˜æ ·å¼ï¼Œé€šå¸¸éœ€è¦åŠ¨æ€æ‹¼æ¥ç±»åã€‚</p>
<p>ä½†åœ¨ <code>styled-components</code> ä¸­ï¼ŒCSS å˜æˆäº†<strong>é€»è¾‘</strong>ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-attr">background</span>: ${<span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> props.<span class="hljs-property">primary</span> ? <span class="hljs-string">'blue'</span> : <span class="hljs-string">'white'</span>};
</code></pre>
<p>è¿™è¡Œä»£ç æ„å‘³ç€ï¼šå¦‚æœåœ¨ä½¿ç”¨ç»„ä»¶æ—¶ä¼ é€’äº† <code>primary</code> å±æ€§ï¼ŒèƒŒæ™¯å°±æ˜¯è“è‰²ï¼Œå¦åˆ™æ˜¯ç™½è‰²ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>é»˜è®¤æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">primary</span>&gt;</span>ä¸»è¦æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<p>å½“ React æ¸²æŸ“è¿™ä¸¤ä¸ªæŒ‰é’®æ—¶ï¼Œ<code>styled-components</code> ä¼šåŠ¨æ€ç”Ÿæˆä¸¤ä¸ªä¸åŒçš„ CSS ç±»åï¼Œå¹¶å°†å¯¹åº”çš„æ ·å¼æ³¨å…¥åˆ°é¡µé¢çš„ <code>&lt;style&gt;</code> æ ‡ç­¾ä¸­ã€‚</p>
<p><strong>CSS-in-JS çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>åŠ¨æ€æ€§</strong>ï¼šæ ·å¼å¯ä»¥åƒ JS å˜é‡ä¸€æ ·çµæ´»ï¼Œç›´æ¥è®¿é—®ç»„ä»¶çš„ Propsã€‚</li>
<li><strong>åˆ é™¤æ— ç”¨ä»£ç </strong>ï¼šæ—¢ç„¶æ ·å¼æ˜¯ç»‘å®šåœ¨ç»„ä»¶ä¸Šçš„ï¼Œå¦‚æœç»„ä»¶æ²¡è¢«ä½¿ç”¨ï¼Œæ ·å¼ä¹Ÿä¸ä¼šè¢«æ‰“åŒ…ã€‚</li>
<li><strong>ç»´æŠ¤æ€§</strong>ï¼šä½ æ°¸è¿œä¸ç”¨å»å¯»æ‰¾â€œè¿™ä¸ªç±»åå®šä¹‰åœ¨å“ªé‡Œâ€ï¼Œå› ä¸ºå®ƒå°±åœ¨ç»„ä»¶çš„ä»£ç é‡Œã€‚</li>
</ul>
<h2 data-id="heading-13">äº”ã€ æ€»ç»“ï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ</h2>
<p>åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æœ‰å¤šç§æ­¦å™¨æ¥å¯¹æŠ—æ ·å¼å†²çªï¼š</p>
<ol>
<li>
<p><strong>CSS Modules (React æ¨è)</strong></p>
<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¤§å‹ React é¡¹ç›®ï¼Œå›¢é˜Ÿä¹ æƒ¯ä¼ ç»Ÿçš„ CSS/SCSS ç¼–å†™æ–¹å¼ï¼Œè¿½æ±‚æè‡´çš„æ€§èƒ½ï¼ˆç¼–è¯‘æ—¶å¤„ç†ï¼‰ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šé€šè¿‡ Hash ç±»åå®ç°éš”ç¦»ï¼Œè¾“å‡º JS å¯¹è±¡ã€‚</li>
<li><strong>å…³é”®è¯</strong>ï¼š<code>.module.css</code>, <code>import styles</code>, å®‰å…¨, é›¶å†²çªã€‚</li>
</ul>
</li>
<li>
<p><strong>Vue Scoped Styles (Vue é»˜è®¤)</strong></p>
<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç»å¤§å¤šæ•° Vue é¡¹ç›®ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šé€šè¿‡ <code>data-v-</code> å±æ€§é€‰æ‹©å™¨å®ç°éš”ç¦»ï¼Œä»£ç æ›´ç®€æ´ï¼Œå¯è¯»æ€§æ›´é«˜ã€‚</li>
<li><strong>å…³é”®è¯</strong>ï¼š<code>&lt;style scoped&gt;</code>, å±æ€§é€‰æ‹©å™¨, ç®€å•æ˜“ç”¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>CSS-in-JS (Styled-components / Emotion)</strong></p>
<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šéœ€è¦é«˜åº¦åŠ¨æ€ä¸»é¢˜ã€å¤æ‚çš„äº¤äº’æ ·å¼ï¼Œæˆ–è€…å›¢é˜Ÿåå¥½â€œAll in JSâ€çš„ React é¡¹ç›®ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šæ ·å¼å³é€»è¾‘ï¼Œè¿è¡Œæ—¶ç”Ÿæˆ CSSã€‚</li>
<li><strong>å…³é”®è¯</strong>ï¼š<code>styled.div</code>, åŠ¨æ€ Props, é€»è¾‘å¤ç”¨ã€‚</li>
</ul>
</li>
</ol>
<p>å›åˆ°å¼€å¤´çš„é—®é¢˜ï¼š</p>
<p>ä¸ç®¡æ˜¯ CSS Modules çš„å“ˆå¸Œä¹±ç ï¼Œè¿˜æ˜¯ Vue çš„å±æ€§æ ‡è®°ï¼Œæˆ–è€…æ˜¯ Styled-components çš„åŠ¨æ€æ³¨å…¥ï¼Œå®ƒä»¬çš„ç»ˆæç›®æ ‡éƒ½æ˜¯ä¸€æ ·çš„â€”â€”è®©æ ·å¼ä¸ºç»„ä»¶æœåŠ¡ï¼Œè€Œä¸æ˜¯è®©ç»„ä»¶å»è¿å°±æ ·å¼ã€‚</p>
<p>åœ¨ä½ çš„ä¸‹ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œè¯·åŠ¡å¿…æŠ›å¼ƒå…¨å±€ CSSï¼Œæ‹¥æŠ±æ¨¡å—åŒ–ã€‚è¿™ä¸ä»…æ˜¯ä¸ºäº†é¿å… Bugï¼Œæ›´æ˜¯ä¸ºäº†å†™å‡ºæ›´ä¼˜é›…ã€æ›´å¥å£®ã€æ›´æ˜“äºç»´æŠ¤çš„ä»£ç ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ å½»åº•ç†è§£å‰ç«¯æ ·å¼çš„æ¨¡å—åŒ–æ¼”è¿›ï¼ Happy Coding!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[sectionä¸articleçš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯]]></title>    <link>https://juejin.cn/post/7592818272154189851</link>    <guid>https://juejin.cn/post/7592818272154189851</guid>    <pubDate>2026-01-08T15:55:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592818272154189851" data-draft-id="7592818272154124315" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="sectionä¸articleçš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯"/> <meta itemprop="keywords" content="HTML"/> <meta itemprop="datePublished" content="2026-01-08T15:55:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·5141444809824"/> <meta itemprop="url" content="https://juejin.cn/user/3228624408021783"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            sectionä¸articleçš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3228624408021783/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·5141444809824
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T15:55:13.000Z" title="Thu Jan 08 2026 15:55:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>H5ä¸­çš„<code>&lt;section&gt;</code>å’Œ<code>&lt;article&gt;</code>éƒ½æ˜¯ç”¨äºæ–‡æ¡£ç»“æ„åŒ–çš„è¯­ä¹‰åŒ–æ ‡ç­¾ï¼Œä½†å®ƒä»¬æœ‰ä¸åŒçš„ç”¨é€”ã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†è§£é‡Šå®ƒä»¬çš„åŒºåˆ«ã€ä½¿ç”¨åœºæ™¯ä»¥åŠå¦‚ä½•é¿å…æ··æ·†ã€‚</p>
<h3 data-id="heading-0">å¦‚ä½•åŒºåˆ†ï¼Ÿ</h3>
<p>å…³é”®é—®é¢˜ï¼š<strong>è¿™æ®µå†…å®¹åœ¨è„±ç¦»ä¸Šä¸‹æ–‡åæ˜¯å¦è¿˜æœ‰æ„ä¹‰ï¼Ÿ</strong></p>
<ul>
<li>å¦‚æœä¸€æ®µå†…å®¹å¯ä»¥è¢«å•ç‹¬æ‹†åˆ†å¹¶åœ¨å…¶ä»–ç½‘ç«™æˆ–å¹³å°ä¸Šä½¿ç”¨ï¼Œé‚£ä¹ˆå®ƒå¾ˆå¯èƒ½æ˜¯ä¸€ä¸ª<code>&lt;article&gt;</code>ã€‚</li>
<li>å¦‚æœä¸€æ®µå†…å®¹åªæ˜¯æ–‡æ¡£ä¸­çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œå®ƒå’Œæ–‡æ¡£çš„å…¶ä»–éƒ¨åˆ†å…±åŒç»„æˆä¸€ä¸ªæ•´ä½“ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½æ˜¯ä¸€ä¸ª<code>&lt;section&gt;</code>ã€‚</li>
</ul>
<p>å¦å¤–ï¼Œ<code>&lt;article&gt;</code>å†…éƒ¨å¯ä»¥æœ‰å¤šä¸ª<code>&lt;section&gt;</code>ï¼Œè€Œ<code>&lt;section&gt;</code>å†…éƒ¨ä¹Ÿå¯ä»¥æœ‰å¤šä¸ª<code>&lt;article&gt;</code>ã€‚è¿™å–å†³äºä½ çš„å†…å®¹ç»“æ„ã€‚</p>
<h2 data-id="heading-1">ä»£ç ç¤ºä¾‹</h2>
<h3 data-id="heading-2">ç¤ºä¾‹1ï¼šåšå®¢æ–‡ç« é¡µé¢</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">article</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>åšå®¢æ–‡ç« æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å‘å¸ƒæ—¥æœŸï¼š<span class="hljs-tag">&lt;<span class="hljs-name">time</span> <span class="hljs-attr">datetime</span>=<span class="hljs-string">"2023-10-01"</span>&gt;</span>2023å¹´10æœˆ1æ—¥<span class="hljs-tag">&lt;/<span class="hljs-name">time</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å¼•è¨€<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™æ˜¯æ–‡ç« çš„å¼•è¨€éƒ¨åˆ†ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ç¬¬ä¸€ç« <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç¬¬ä¸€ç« çš„å†…å®¹ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ç¬¬äºŒç« <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç¬¬äºŒç« çš„å†…å®¹ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–‡ç« æ ‡ç­¾ï¼šHTMLï¼Œè¯­ä¹‰åŒ–<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">ç¤ºä¾‹2ï¼šæ–°é—»ç½‘ç«™é¦–é¡µ</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å›½å†…æ–°é—»<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">article</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ–°é—»æ ‡é¢˜1<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–°é—»æ‘˜è¦1<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">article</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ–°é—»æ ‡é¢˜2<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–°é—»æ‘˜è¦2<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å›½é™…æ–°é—»<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">article</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ–°é—»æ ‡é¢˜3<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–°é—»æ‘˜è¦3<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
</code></pre>
<h2 data-id="heading-4">å®¹æ˜“æ··æ·†çš„æƒ…å†µ</h2>
<p>ä¸€ä¸ªç‹¬ç«‹çš„ã€å¯é‡ç”¨çš„å†…å®¹å—ï¼Œä½†ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ–‡ç« ï¼Ÿ</p>
<ul>
<li>ä¾‹å¦‚ï¼šä¸€ä¸ªç”¨æˆ·è¯„è®ºã€‚è™½ç„¶å®ƒå¯èƒ½ä¸é•¿ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å†…å®¹å•å…ƒï¼Œåº”è¯¥ç”¨<code>&lt;article&gt;</code>ã€‚</li>
<li>æ³¨æ„ï¼š<code>&lt;article&gt;</code>ä¸ä¸€å®šå¾ˆé•¿ï¼Œåªè¦å®ƒæ˜¯ç‹¬ç«‹çš„ã€‚</li>
</ul>
<h2 data-id="heading-5">æ³¨æ„</h2>
<ul>
<li>å¯¹äº<code>&lt;sectio&gt;</code>,è§„èŒƒå»ºè®®åŒ…å«ä¸€ä¸ªæ ‡é¢˜ã€‚ä½†å¦‚æœä½ ä¸æƒ³æ˜¾ç¤ºæ ‡é¢˜ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨éšè—æ ‡é¢˜ï¼ˆä¾‹å¦‚ç”¨CSSéšè—)ã€‚</li>
<li>å¯¹äº<code>&lt;article&gt;</code>ï¼Œè™½ç„¶æ ‡é¢˜ä¸æ˜¯å¼ºåˆ¶çš„ï¼Œä½†æœ€å¥½åŒ…å«ä¸€ä¸ªæ ‡é¢˜ï¼ˆå¯ä»¥æ˜¯éšå¼çš„ï¼Œé€šè¿‡aria-labelç­‰å±æ€§æè¿°ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p><code>&lt;article&gt;</code>æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ•´ä½“ï¼Œå†…éƒ¨åŒ…å«è¿™ä¸ªæ•´ä½“ä¸­çš„å„ä¸ªéƒ¨åˆ†ï¼Œå¦‚ï¼š<code>&lt;header&gt;</code>ã€<code>&lt;footer&gt;</code>ã€‚<code>&lt;section&gt;</code>å°±æ˜¯è¿™ä¸ªæ•´ä½“ä¸­çš„ä¸€ä¸ªéƒ¨åˆ†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 å¹´ Expo + React Native é¡¹ç›®æ¥å…¥å¾®ä¿¡åˆ†äº«å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7592815497847947327</link>    <guid>https://juejin.cn/post/7592815497847947327</guid>    <pubDate>2026-01-08T11:46:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592815497847947327" data-draft-id="7592805973120876550" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 å¹´ Expo + React Native é¡¹ç›®æ¥å…¥å¾®ä¿¡åˆ†äº«å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="iOS,å‰ç«¯,APP"/> <meta itemprop="datePublished" content="2026-01-08T11:46:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…ˆé£çš„ç¬¨é¸Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/1526600409814909"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 å¹´ Expo + React Native é¡¹ç›®æ¥å…¥å¾®ä¿¡åˆ†äº«å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1526600409814909/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…ˆé£çš„ç¬¨é¸Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T11:46:54.000Z" title="Thu Jan 08 2026 11:46:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">2026 å¹´ Expo + React Native é¡¹ç›®æ¥å…¥å¾®ä¿¡åˆ†äº«å®Œæ•´æŒ‡å—</h2>
<blockquote>
<p>æœ¬æ–‡åŸºäº Expo SDK 54 + React Native 0.81 + react-native-wechat-lib 1.1.27 çš„å®æˆ˜ç»éªŒï¼Œè¯¦ç»†è®°å½•äº†åœ¨ Expo ç®¡ç†çš„ React Native é¡¹ç›®ä¸­æ¥å…¥å¾®ä¿¡åˆ†äº«åŠŸèƒ½çš„å®Œæ•´æµç¨‹å’Œè¸©å‘è®°å½•ã€‚</p>
</blockquote>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>åœ¨ React Native ç”Ÿæ€ä¸­ï¼Œ<code>react-native-wechat-lib</code> æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„å¾®ä¿¡ SDK å°è£…åº“ã€‚ä½†ç”±äºè¯¥åº“æ›´æ–°è¾ƒæ…¢ï¼ŒåŠ ä¸Š Expo çš„ç‰¹æ®Šæ€§ï¼Œæ¥å…¥è¿‡ç¨‹ä¸­ä¼šé‡åˆ°ä¸å°‘å‘ã€‚æœ¬æ–‡å°†åˆ†äº«æˆ‘ä»¬åœ¨ç”Ÿäº§é¡¹ç›®ä¸­çš„å®Œæ•´æ¥å…¥æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-2">æŠ€æœ¯æ ˆ</h3>
<ul>
<li>Expo SDK: 54.0.30</li>
<li>React Native: 0.81.5</li>
<li>react-native-wechat-lib: 1.1.27</li>
<li>æ„å»ºæ–¹å¼: EAS Build</li>
</ul>
<h3 data-id="heading-3">æ•´ä½“æµç¨‹</h3>
<pre><code class="hljs language-arduino" lang="arduino">å‡†å¤‡å·¥ä½œ â†’ å®‰è£…ä¾èµ– â†’ åˆ›å»º Expo æ’ä»¶ â†’ é…ç½® app.config.js â†’ 
ç¼–å†™ JS æœåŠ¡å±‚ â†’ æœåŠ¡å™¨é…ç½® â†’ å¾®ä¿¡å¼€æ”¾å¹³å°é…ç½® â†’ æ„å»ºæµ‹è¯•
</code></pre>
<h3 data-id="heading-4">ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œ</h3>
<h4 data-id="heading-5">1.1 å¾®ä¿¡å¼€æ”¾å¹³å°é…ç½®</h4>
<ol>
<li>ç™»å½• <a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.weixin.qq.com" target="_blank" title="https://open.weixin.qq.com" ref="nofollow noopener noreferrer">å¾®ä¿¡å¼€æ”¾å¹³å°</a></li>
<li>åˆ›å»ºç§»åŠ¨åº”ç”¨ï¼Œè·å– AppID</li>
<li>é…ç½® iOS åº”ç”¨ä¿¡æ¯ï¼š
<ul>
<li>Bundle ID: <code>com.yourapp</code></li>
<li>Universal Link: <code>https://yourdomain.com/open/</code></li>
</ul>
</li>
</ol>
<h4 data-id="heading-6">1.2 Apple Developer é…ç½®</h4>
<ol>
<li>è·å– Team IDï¼ˆæ ¼å¼å¦‚ <code>A1B2C3D4E5</code>ï¼‰</li>
<li>ç¡®è®¤ Bundle ID ä¸å¾®ä¿¡å¼€æ”¾å¹³å°ä¸€è‡´</li>
</ol>
<h3 data-id="heading-7">ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash">npm install react-native-wechat-lib@1.1.27
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šåœ¨ Expo ç®¡ç†çš„é¡¹ç›®ä¸­ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ <code>pod install</code>ï¼ŒEAS Build ä¼šè‡ªåŠ¨å¤„ç†ã€‚</p>
</blockquote>
<h3 data-id="heading-8">ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º Expo Config Plugin</h3>
<p>ç”±äº Expo ç®¡ç†åŸç”Ÿä»£ç ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ Config Plugin æ¥é…ç½®å¾®ä¿¡ SDK æ‰€éœ€çš„åŸç”Ÿè®¾ç½®ã€‚</p>
<p>åˆ›å»º <code>plugins/withWechat.js</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { withInfoPlist, withAndroidManifest } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"expo/config-plugins"</span>);

<span class="hljs-comment">/**
 * å¾®ä¿¡ SDK Expo Config Plugin
 * è‡ªåŠ¨é…ç½® iOS å’Œ Android çš„å¾®ä¿¡ç›¸å…³è®¾ç½®
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">withWechat</span>(<span class="hljs-params">config, { appId, universalLink }</span>) {
  <span class="hljs-keyword">if</span> (!appId) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"withWechat: appId is required"</span>);
  }

  <span class="hljs-comment">// iOS é…ç½®</span>
  config = <span class="hljs-title function_">withInfoPlist</span>(config, <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    <span class="hljs-comment">// æ·»åŠ å¾®ä¿¡ URL Scheme</span>
    <span class="hljs-keyword">const</span> urlTypes = config.<span class="hljs-property">modResults</span>.<span class="hljs-property">CFBundleURLTypes</span> || [];
    <span class="hljs-keyword">const</span> wechatScheme = {
      <span class="hljs-title class_">CFBundleURLSchemes</span>: [appId],
      <span class="hljs-title class_">CFBundleURLName</span>: <span class="hljs-string">"wechat"</span>,
    };

    <span class="hljs-keyword">const</span> hasWechatScheme = urlTypes.<span class="hljs-title function_">some</span>(
      <span class="hljs-function">(<span class="hljs-params">type</span>) =&gt;</span>
        type.<span class="hljs-property">CFBundleURLSchemes</span> &amp;&amp;
        type.<span class="hljs-property">CFBundleURLSchemes</span>.<span class="hljs-title function_">includes</span>(appId)
    );

    <span class="hljs-keyword">if</span> (!hasWechatScheme) {
      urlTypes.<span class="hljs-title function_">push</span>(wechatScheme);
    }
    config.<span class="hljs-property">modResults</span>.<span class="hljs-property">CFBundleURLTypes</span> = urlTypes;

    <span class="hljs-comment">// æ·»åŠ  LSApplicationQueriesSchemes</span>
    <span class="hljs-keyword">const</span> queriesSchemes = config.<span class="hljs-property">modResults</span>.<span class="hljs-property">LSApplicationQueriesSchemes</span> || [];
    <span class="hljs-keyword">const</span> wechatSchemes = [<span class="hljs-string">"weixin"</span>, <span class="hljs-string">"weixinULAPI"</span>];
    wechatSchemes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">scheme</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!queriesSchemes.<span class="hljs-title function_">includes</span>(scheme)) {
        queriesSchemes.<span class="hljs-title function_">push</span>(scheme);
      }
    });
    config.<span class="hljs-property">modResults</span>.<span class="hljs-property">LSApplicationQueriesSchemes</span> = queriesSchemes;

    <span class="hljs-keyword">return</span> config;
  });

  <span class="hljs-comment">// Android é…ç½®</span>
  config = <span class="hljs-title function_">withAndroidManifest</span>(config, <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> mainApplication = config.<span class="hljs-property">modResults</span>.<span class="hljs-property">manifest</span>.<span class="hljs-property">application</span>?.[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (!mainApplication) <span class="hljs-keyword">return</span> config;

    <span class="hljs-keyword">const</span> packageName = config.<span class="hljs-property">android</span>?.<span class="hljs-property">package</span> || <span class="hljs-string">"com.yourapp"</span>;
    <span class="hljs-keyword">const</span> activities = mainApplication.<span class="hljs-property">activity</span> || [];
    <span class="hljs-keyword">const</span> wxActivityName = <span class="hljs-string">`<span class="hljs-subst">${packageName}</span>.wxapi.WXEntryActivity`</span>;

    <span class="hljs-keyword">const</span> hasWxActivity = activities.<span class="hljs-title function_">some</span>(
      <span class="hljs-function">(<span class="hljs-params">activity</span>) =&gt;</span> activity.<span class="hljs-property">$</span>?.[<span class="hljs-string">"android:name"</span>] === wxActivityName
    );

    <span class="hljs-keyword">if</span> (!hasWxActivity) {
      activities.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">$</span>: {
          <span class="hljs-string">"android:name"</span>: wxActivityName,
          <span class="hljs-string">"android:exported"</span>: <span class="hljs-string">"true"</span>,
          <span class="hljs-string">"android:launchMode"</span>: <span class="hljs-string">"singleTask"</span>,
          <span class="hljs-string">"android:taskAffinity"</span>: packageName,
          <span class="hljs-string">"android:theme"</span>: <span class="hljs-string">"@android:style/Theme.Translucent.NoTitleBar"</span>,
        },
      });
    }

    mainApplication.<span class="hljs-property">activity</span> = activities;
    <span class="hljs-keyword">return</span> config;
  });

  <span class="hljs-keyword">return</span> config;
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = withWechat;
</code></pre>
<h3 data-id="heading-9">ç¬¬å››æ­¥ï¼šé…ç½® app.config.js</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">expo</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"ä½ çš„åº”ç”¨å"</span>,
    <span class="hljs-attr">slug</span>: <span class="hljs-string">"your-app"</span>,
    <span class="hljs-attr">version</span>: <span class="hljs-string">"1.0.0"</span>,
    
    <span class="hljs-attr">extra</span>: {
      <span class="hljs-attr">wechatAppId</span>: <span class="hljs-string">"wxä½ çš„AppID"</span>, <span class="hljs-comment">// å¾®ä¿¡ AppID</span>
    },
    
    <span class="hljs-attr">ios</span>: {
      <span class="hljs-attr">bundleIdentifier</span>: <span class="hljs-string">"com.yourapp"</span>,
      <span class="hljs-attr">associatedDomains</span>: [
        <span class="hljs-string">"applinks:yourdomain.com"</span>,
        <span class="hljs-string">"webcredentials:yourdomain.com"</span>,
      ],
      <span class="hljs-attr">infoPlist</span>: {
        <span class="hljs-title class_">LSApplicationQueriesSchemes</span>: [<span class="hljs-string">"weixin"</span>, <span class="hljs-string">"weixinULAPI"</span>, <span class="hljs-string">"wechat"</span>],
      },
    },
    
    <span class="hljs-attr">android</span>: {
      <span class="hljs-attr">package</span>: <span class="hljs-string">"com.yourapp"</span>,
    },
    
    <span class="hljs-attr">plugins</span>: [
      [
        <span class="hljs-string">"./plugins/withWechat"</span>,
        {
          <span class="hljs-attr">appId</span>: <span class="hljs-string">"wxä½ çš„AppID"</span>,
          <span class="hljs-attr">universalLink</span>: <span class="hljs-string">"https://yourdomain.com/open/"</span>,
        },
      ],
    ],
  },
};
</code></pre>
<h3 data-id="heading-10">ç¬¬äº”æ­¥ï¼šç¼–å†™å¾®ä¿¡æœåŠ¡å±‚</h3>
<p>åˆ›å»º <code>src/services/wechatService.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Platform</span>, <span class="hljs-title class_">Alert</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-native"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Constants</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"expo-constants"</span>;

<span class="hljs-comment">// ä» Expo é…ç½®ä¸­è·å–å¾®ä¿¡ AppID</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">WECHAT_APP_ID</span> = <span class="hljs-title class_">Constants</span>.<span class="hljs-property">expoConfig</span>?.<span class="hljs-property">extra</span>?.<span class="hljs-property">wechatAppId</span> || <span class="hljs-string">""</span>;

<span class="hljs-comment">// åŠ¨æ€åŠ è½½å¾®ä¿¡ SDK</span>
<span class="hljs-keyword">let</span> <span class="hljs-title class_">WeChat</span>: <span class="hljs-built_in">any</span> = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">let</span> sdkLoadAttempted = <span class="hljs-literal">false</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getWechatSDK</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (sdkLoadAttempted) <span class="hljs-keyword">return</span> <span class="hljs-title class_">WeChat</span>;
  sdkLoadAttempted = <span class="hljs-literal">true</span>;
  
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">"web"</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react-native-wechat-lib"</span>);
    <span class="hljs-title class_">WeChat</span> = <span class="hljs-variable language_">module</span>.<span class="hljs-property">default</span> || <span class="hljs-variable language_">module</span>;
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">WeChat</span> || <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">WeChat</span>.<span class="hljs-property">registerApp</span> !== <span class="hljs-string">"function"</span>) {
      <span class="hljs-title class_">WeChat</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">WeChat</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"å¾®ä¿¡ SDK åŠ è½½å¤±è´¥:"</span>, error);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WechatService</span> {
  <span class="hljs-keyword">private</span> isRegistered = <span class="hljs-literal">false</span>;

  <span class="hljs-comment">// æ£€æŸ¥ SDK æ˜¯å¦å¯ç”¨</span>
  <span class="hljs-title function_">isAvailable</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">"web"</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">getWechatSDK</span>();
    <span class="hljs-keyword">return</span> sdk !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> sdk.<span class="hljs-property">registerApp</span> === <span class="hljs-string">"function"</span>;
  }

  <span class="hljs-comment">// æ³¨å†Œå¾®ä¿¡ SDK</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">register</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRegistered</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    
    <span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">getWechatSDK</span>();
    <span class="hljs-keyword">if</span> (!sdk) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> sdk.<span class="hljs-title function_">registerApp</span>(<span class="hljs-variable constant_">WECHAT_APP_ID</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRegistered</span> = result;
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å¾®ä¿¡ SDK æ³¨å†Œå¤±è´¥:"</span>, error);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">// æ£€æŸ¥å¾®ä¿¡æ˜¯å¦å·²å®‰è£…</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">isWechatInstalled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">getWechatSDK</span>();
    <span class="hljs-keyword">if</span> (!sdk) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> sdk.<span class="hljs-title function_">isWXAppInstalled</span>();
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">// åˆ†äº«ç½‘é¡µåˆ°å¾®ä¿¡</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">shareWebpage</span>(<span class="hljs-attr">params</span>: {
    <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">description</span>: <span class="hljs-built_in">string</span>;
    thumbImageUrl?: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">webpageUrl</span>: <span class="hljs-built_in">string</span>;
    scene?: <span class="hljs-string">"session"</span> | <span class="hljs-string">"timeline"</span> | <span class="hljs-string">"favorite"</span>;
  }): <span class="hljs-title class_">Promise</span>&lt;{ <span class="hljs-attr">success</span>: <span class="hljs-built_in">boolean</span>; <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> }&gt; {
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isAvailable</span>()) {
      <span class="hljs-keyword">return</span> { 
        <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, 
        <span class="hljs-attr">message</span>: <span class="hljs-title class_">Platform</span>.<span class="hljs-property">OS</span> === <span class="hljs-string">"web"</span> 
          ? <span class="hljs-string">"Web ç«¯æš‚ä¸æ”¯æŒå¾®ä¿¡åˆ†äº«"</span> 
          : <span class="hljs-string">"å¾®ä¿¡åˆ†äº«åŠŸèƒ½éœ€è¦åœ¨æ­£å¼æ„å»ºç‰ˆæœ¬ä¸­ä½¿ç”¨"</span>
      };
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> registered = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">register</span>();
      <span class="hljs-keyword">if</span> (!registered) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"å¾®ä¿¡ SDK åˆå§‹åŒ–å¤±è´¥"</span> };
      }

      <span class="hljs-keyword">const</span> isInstalled = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isWechatInstalled</span>();
      <span class="hljs-keyword">if</span> (!isInstalled) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"è¯·å…ˆå®‰è£…å¾®ä¿¡"</span> };
      }

      <span class="hljs-keyword">const</span> sceneMap = {
        <span class="hljs-attr">session</span>: <span class="hljs-number">0</span>,   <span class="hljs-comment">// èŠå¤©ç•Œé¢</span>
        <span class="hljs-attr">timeline</span>: <span class="hljs-number">1</span>,  <span class="hljs-comment">// æœ‹å‹åœˆ</span>
        <span class="hljs-attr">favorite</span>: <span class="hljs-number">2</span>,  <span class="hljs-comment">// æ”¶è—</span>
      };

      <span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">getWechatSDK</span>();
      <span class="hljs-keyword">await</span> sdk.<span class="hljs-title function_">shareWebpage</span>({
        <span class="hljs-attr">title</span>: params.<span class="hljs-property">title</span>,
        <span class="hljs-attr">description</span>: params.<span class="hljs-property">description</span>,
        <span class="hljs-attr">thumbImageUrl</span>: params.<span class="hljs-property">thumbImageUrl</span> || <span class="hljs-string">""</span>,
        <span class="hljs-attr">webpageUrl</span>: params.<span class="hljs-property">webpageUrl</span>,
        <span class="hljs-attr">scene</span>: sceneMap[params.<span class="hljs-property">scene</span> || <span class="hljs-string">"session"</span>],
      });

      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"åˆ†äº«æˆåŠŸ"</span> };
    } <span class="hljs-keyword">catch</span> (<span class="hljs-attr">error</span>: <span class="hljs-built_in">any</span>) {
      <span class="hljs-keyword">if</span> (error?.<span class="hljs-property">errCode</span> === -<span class="hljs-number">2</span>) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"å·²å–æ¶ˆåˆ†äº«"</span> };
      }
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: error?.<span class="hljs-property">message</span> || <span class="hljs-string">"åˆ†äº«å¤±è´¥"</span> };
    }
  }

  <span class="hljs-comment">// åˆ†äº«å›¾ç‰‡åˆ°å¾®ä¿¡</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">shareImage</span>(<span class="hljs-attr">params</span>: {
    imageUrl?: <span class="hljs-built_in">string</span>;
    imageBase64?: <span class="hljs-built_in">string</span>;
    scene?: <span class="hljs-string">"session"</span> | <span class="hljs-string">"timeline"</span> | <span class="hljs-string">"favorite"</span>;
  }): <span class="hljs-title class_">Promise</span>&lt;{ <span class="hljs-attr">success</span>: <span class="hljs-built_in">boolean</span>; <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> }&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isAvailable</span>()) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"å¾®ä¿¡åˆ†äº«ä¸å¯ç”¨"</span> };
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">register</span>();
      
      <span class="hljs-keyword">const</span> isInstalled = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isWechatInstalled</span>();
      <span class="hljs-keyword">if</span> (!isInstalled) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"è¯·å…ˆå®‰è£…å¾®ä¿¡"</span> };
      }

      <span class="hljs-keyword">const</span> sceneMap = { <span class="hljs-attr">session</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">timeline</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">favorite</span>: <span class="hljs-number">2</span> };
      <span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">getWechatSDK</span>();
      
      <span class="hljs-keyword">await</span> sdk.<span class="hljs-title function_">shareImage</span>({
        <span class="hljs-attr">imageUrl</span>: params.<span class="hljs-property">imageBase64</span> || params.<span class="hljs-property">imageUrl</span>,
        <span class="hljs-attr">scene</span>: sceneMap[params.<span class="hljs-property">scene</span> || <span class="hljs-string">"session"</span>],
      });

      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"åˆ†äº«æˆåŠŸ"</span> };
    } <span class="hljs-keyword">catch</span> (<span class="hljs-attr">error</span>: <span class="hljs-built_in">any</span>) {
      <span class="hljs-keyword">if</span> (error?.<span class="hljs-property">errCode</span> === -<span class="hljs-number">2</span>) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"å·²å–æ¶ˆåˆ†äº«"</span> };
      }
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"åˆ†äº«å¤±è´¥"</span> };
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> wechatService = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WechatService</span>();
</code></pre>
<h3 data-id="heading-11">ç¬¬å…­æ­¥ï¼šæœåŠ¡å™¨é…ç½® (Universal Link)</h3>
<p>åœ¨ä½ çš„æœåŠ¡å™¨ä¸Šåˆ›å»º <code>apple-app-site-association</code> æ–‡ä»¶ã€‚</p>
<h4 data-id="heading-12">æ–‡ä»¶è·¯å¾„</h4>
<pre><code class="hljs language-arduino" lang="arduino">https:<span class="hljs-comment">//yourdomain.com/.well-known/apple-app-site-association</span>
</code></pre>
<h4 data-id="heading-13">æ–‡ä»¶å†…å®¹</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"applinks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"apps"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"details"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"appIDs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"TEAMID.com.yourapp"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"components"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span> <span class="hljs-attr">"/"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/open/*"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
          <span class="hljs-punctuation">{</span> <span class="hljs-attr">"/"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/topic/*"</span> <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"webcredentials"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"apps"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"TEAMID.com.yourapp"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p>âš ï¸ å°† <code>TEAMID</code> æ›¿æ¢ä¸ºä½ çš„ Apple Team IDï¼Œ<code>com.yourapp</code> æ›¿æ¢ä¸ºä½ çš„ Bundle IDã€‚</p>
</blockquote>
<h4 data-id="heading-14">æœåŠ¡å™¨é…ç½®è¦æ±‚</h4>
<ol>
<li>å¿…é¡»é€šè¿‡ HTTPS è®¿é—®</li>
<li>Content-Type åº”ä¸º <code>application/json</code></li>
<li>æ–‡ä»¶åä¸èƒ½æœ‰ <code>.json</code> åç¼€</li>
<li>ä¸èƒ½æœ‰é‡å®šå‘</li>
</ol>
<h4 data-id="heading-15">Nginx é…ç½®ç¤ºä¾‹</h4>
<pre><code class="hljs language-nginx" lang="nginx">location /.well-known/apple-app-site-association {
    default_type application/json;
}
</code></pre>
<h3 data-id="heading-16">ç¬¬ä¸ƒæ­¥ï¼šåœ¨ç»„ä»¶ä¸­ä½¿ç”¨</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">Alert</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-native"</span>;
<span class="hljs-keyword">import</span> { wechatService } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/services/wechatService"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ShareButton</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleShare</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> wechatService.<span class="hljs-title function_">shareWebpage</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-string">"åˆ†äº«æ ‡é¢˜"</span>,
      <span class="hljs-attr">description</span>: <span class="hljs-string">"åˆ†äº«æè¿°"</span>,
      <span class="hljs-attr">thumbImageUrl</span>: <span class="hljs-string">"https://example.com/thumb.jpg"</span>,
      <span class="hljs-attr">webpageUrl</span>: <span class="hljs-string">"https://example.com/share-page"</span>,
      <span class="hljs-attr">scene</span>: <span class="hljs-string">"session"</span>, <span class="hljs-comment">// æˆ– "timeline" åˆ†äº«åˆ°æœ‹å‹åœˆ</span>
    });

    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">success</span>) {
      <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(<span class="hljs-string">"æˆåŠŸ"</span>, <span class="hljs-string">"åˆ†äº«æˆåŠŸ"</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(<span class="hljs-string">"æç¤º"</span>, result.<span class="hljs-property">message</span>);
    }
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"åˆ†äº«åˆ°å¾®ä¿¡"</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{handleShare}</span> /&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-17">ç¬¬å…«æ­¥ï¼šæ„å»ºå’Œæµ‹è¯•</h3>
<h4 data-id="heading-18">ä½¿ç”¨ EAS Build</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ„å»º iOS ç”Ÿäº§ç‰ˆæœ¬</span>
eas build -p ios --profile production

<span class="hljs-comment"># æ„å»ºå¹¶è‡ªåŠ¨æäº¤åˆ° TestFlight</span>
eas build -p ios --profile production --auto-submit
</code></pre>
<h4 data-id="heading-19">æµ‹è¯•æ³¨æ„äº‹é¡¹</h4>
<ol>
<li><strong>Expo Go ä¸æ”¯æŒ</strong>ï¼šå¾®ä¿¡ SDK æ˜¯åŸç”Ÿæ¨¡å—ï¼Œå¿…é¡»ä½¿ç”¨ EAS Build æ„å»ºçš„ç‰ˆæœ¬æµ‹è¯•</li>
<li><strong>é‡å¯æ‰‹æœº</strong>ï¼šå®‰è£…æ–°ç‰ˆæœ¬åå»ºè®®é‡å¯æ‰‹æœºï¼Œè®© iOS åˆ·æ–° Associated Domains ç¼“å­˜</li>
<li><strong>éªŒè¯ Universal Link</strong>ï¼šè®¿é—® <code>https://app-site-association.cdn-apple.com/a/v1/yourdomain.com</code> ç¡®è®¤ Apple å·²ç¼“å­˜é…ç½®</li>
</ol>
<h3 data-id="heading-20">å¸¸è§é—®é¢˜æ’æŸ¥</h3>
<h4 data-id="heading-21">é—®é¢˜ 1ï¼šåˆ†äº«æ—¶å¾®ä¿¡æ²¡æœ‰è¢«å”¤èµ·</h4>
<p><strong>å¯èƒ½åŸå› ï¼š</strong></p>
<ul>
<li>Universal Link é…ç½®ä¸ä¸€è‡´ï¼ˆå¾®ä¿¡å¼€æ”¾å¹³å°ã€App ä»£ç ã€æœåŠ¡å™¨ä¸‰ç«¯å¿…é¡»å®Œå…¨ä¸€è‡´ï¼‰</li>
<li><code>apple-app-site-association</code> æ–‡ä»¶å†…å®¹é”™è¯¯æˆ–æ— æ³•è®¿é—®</li>
<li>Apple è¿˜æœªç¼“å­˜ä½ çš„é…ç½®</li>
</ul>
<p><strong>æ’æŸ¥æ­¥éª¤ï¼š</strong></p>
<ol>
<li>ç¡®è®¤ä¸‰ç«¯åŸŸåå®Œå…¨ä¸€è‡´ï¼ˆæ³¨æ„ www å’Œé www çš„åŒºåˆ«ï¼‰</li>
<li>ç›´æ¥è®¿é—® <code>https://yourdomain.com/.well-known/apple-app-site-association</code> ç¡®è®¤å¯ä»¥ä¸‹è½½</li>
<li>æ£€æŸ¥ Apple CDN ç¼“å­˜ï¼š<code>https://app-site-association.cdn-apple.com/a/v1/yourdomain.com</code></li>
</ol>
<h4 data-id="heading-22">é—®é¢˜ 2ï¼šSDK æ³¨å†Œå¤±è´¥</h4>
<p><strong>å¯èƒ½åŸå› ï¼š</strong></p>
<ul>
<li>AppID é…ç½®é”™è¯¯</li>
<li>åœ¨ Expo Go ä¸­è¿è¡Œï¼ˆä¸æ”¯æŒï¼‰</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li>ç¡®è®¤ <code>app.config.js</code> ä¸­çš„ AppID ä¸å¾®ä¿¡å¼€æ”¾å¹³å°ä¸€è‡´</li>
<li>ä½¿ç”¨ EAS Build æ„å»ºçš„ç‰ˆæœ¬æµ‹è¯•</li>
</ul>
<h4 data-id="heading-23">é—®é¢˜ 3ï¼šæç¤º"è¯·å…ˆå®‰è£…å¾®ä¿¡"</h4>
<p><strong>å¯èƒ½åŸå› ï¼š</strong></p>
<ul>
<li><code>LSApplicationQueriesSchemes</code> æœªæ­£ç¡®é…ç½®</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>
ç¡®è®¤ <code>app.config.js</code> ä¸­åŒ…å«ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">infoPlist</span>: {
  <span class="hljs-title class_">LSApplicationQueriesSchemes</span>: [<span class="hljs-string">"weixin"</span>, <span class="hljs-string">"weixinULAPI"</span>, <span class="hljs-string">"wechat"</span>],
}
</code></pre>
<h3 data-id="heading-24">è°ƒè¯•æŠ€å·§</h3>
<p>åœ¨å¼€å‘é˜¶æ®µï¼Œå¯ä»¥æ·»åŠ è°ƒè¯•å¼¹çª—æ¥è¿½è¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEBUG_MODE</span> = <span class="hljs-literal">true</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">debugAlert</span> = (<span class="hljs-params">title: <span class="hljs-built_in">string</span>, message: <span class="hljs-built_in">string</span></span>) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">DEBUG_MODE</span>) {
    <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(<span class="hljs-string">`[è°ƒè¯•] <span class="hljs-subst">${title}</span>`</span>, message);
  }
};

<span class="hljs-comment">// åœ¨å…³é”®æ­¥éª¤æ·»åŠ è°ƒè¯•</span>
<span class="hljs-title function_">debugAlert</span>(<span class="hljs-string">"å¼€å§‹åˆ†äº«"</span>, <span class="hljs-string">`AppID: <span class="hljs-subst">${WECHAT_APP_ID}</span>`</span>);
<span class="hljs-title function_">debugAlert</span>(<span class="hljs-string">"æ³¨å†Œç»“æœ"</span>, <span class="hljs-string">`registered: <span class="hljs-subst">${registered}</span>`</span>);
<span class="hljs-title function_">debugAlert</span>(<span class="hljs-string">"å¾®ä¿¡å®‰è£…æ£€æŸ¥"</span>, <span class="hljs-string">`isInstalled: <span class="hljs-subst">${isInstalled}</span>`</span>);
</code></pre>
<h3 data-id="heading-25">æ€»ç»“</h3>
<p>åœ¨ Expo é¡¹ç›®ä¸­æ¥å…¥å¾®ä¿¡åˆ†äº«çš„å…³é”®ç‚¹ï¼š</p>
<ol>
<li><strong>ä½¿ç”¨ Config Plugin</strong> é…ç½®åŸç”Ÿè®¾ç½®ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨ä¿®æ”¹åŸç”Ÿä»£ç </li>
<li><strong>ä¸‰ç«¯é…ç½®ä¸€è‡´</strong> æ˜¯æˆåŠŸçš„å…³é”®ï¼ˆå¾®ä¿¡å¼€æ”¾å¹³å°ã€Appã€æœåŠ¡å™¨ï¼‰</li>
<li><strong>Universal Link</strong> é…ç½®æ­£ç¡®ä¸”å¯è®¿é—®</li>
<li><strong>å¿…é¡»ä½¿ç”¨ EAS Build</strong> æ„å»ºçš„ç‰ˆæœ¬æµ‹è¯•ï¼ŒExpo Go ä¸æ”¯æŒåŸç”Ÿæ¨¡å—</li>
</ol>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ é¡ºåˆ©æ¥å…¥å¾®ä¿¡åˆ†äº«åŠŸèƒ½ï¼å¦‚æœ‰é—®é¢˜æ¬¢è¿è¯„è®ºåŒºäº¤æµã€‚</p>
<hr/>
<p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flittle-snow-fox%2Freact-native-wechat-lib" target="_blank" title="https://github.com/little-snow-fox/react-native-wechat-lib" ref="nofollow noopener noreferrer">react-native-wechat-lib GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fdoc%2Foplatform%2FMobile_App%2FResource_Center_Homepage.html" target="_blank" title="https://developers.weixin.qq.com/doc/oplatform/Mobile_App/Resource_Center_Homepage.html" ref="nofollow noopener noreferrer">å¾®ä¿¡å¼€æ”¾å¹³å°æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fxcode%2Fsupporting-associated-domains" target="_blank" title="https://developer.apple.com/documentation/xcode/supporting-associated-domains" ref="nofollow noopener noreferrer">Apple Associated Domains æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.expo.dev%2Fconfig-plugins%2Fintroduction%2F" target="_blank" title="https://docs.expo.dev/config-plugins/introduction/" ref="nofollow noopener noreferrer">Expo Config Plugins</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIå¯ç¼–è¾‘æ¶æ„å›¾ï¼è¿™ä¸ª 8.2k stars çš„é¡¹ç›®å¦‚ä½•æŠŠ 30 åˆ†é’Ÿçš„ç»˜å›¾å·¥ä½œå‹ç¼©åˆ° 30 ç§’]]></title>    <link>https://juejin.cn/post/7592818202717110291</link>    <guid>https://juejin.cn/post/7592818202717110291</guid>    <pubDate>2026-01-08T10:51:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592818202717110291" data-draft-id="7592815497847865407" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIå¯ç¼–è¾‘æ¶æ„å›¾ï¼è¿™ä¸ª 8.2k stars çš„é¡¹ç›®å¦‚ä½•æŠŠ 30 åˆ†é’Ÿçš„ç»˜å›¾å·¥ä½œå‹ç¼©åˆ° 30 ç§’"/> <meta itemprop="keywords" content="è®¾è®¡"/> <meta itemprop="datePublished" content="2026-01-08T10:51:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·795197273085"/> <meta itemprop="url" content="https://juejin.cn/user/362176489207546"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIå¯ç¼–è¾‘æ¶æ„å›¾ï¼è¿™ä¸ª 8.2k stars çš„é¡¹ç›®å¦‚ä½•æŠŠ 30 åˆ†é’Ÿçš„ç»˜å›¾å·¥ä½œå‹ç¼©åˆ° 30 ç§’
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/362176489207546/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·795197273085
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T10:51:48.000Z" title="Thu Jan 08 2026 10:51:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AIå¯ç¼–è¾‘æ¶æ„å›¾ï¼è¿™ä¸ª 8.2k stars çš„é¡¹ç›®å¦‚ä½•æŠŠ 30 åˆ†é’Ÿçš„ç»˜å›¾å·¥ä½œå‹ç¼©åˆ° 30 ç§’</h2>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img15@main/2026/01/08/1767866249731-eb1b9acb-080a-4984-9842-4c72f1413928.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">ä» XML ç”Ÿæˆåˆ°æµå¼æ¸²æŸ“</h3>
<p>draw.io æ˜¯æŠ€æœ¯æ¶æ„è®¾è®¡ä¸­çš„æ ‡é…å·¥å…·ã€‚ä½†é—®é¢˜åœ¨äº,æ¯æ¬¡ç”»ä¸€ä¸ªå®Œæ•´çš„äº‘æ¶æ„å›¾éœ€è¦èŠ±è´¹ 30 åˆ†é’Ÿä»¥ä¸Š,è€Œå…¶ä¸­ 80% çš„æ—¶é—´ç”¨äºæ‹–æ‹½ç»„ä»¶å’Œè°ƒæ•´å¸ƒå±€ã€‚è¿™ç§é‡å¤åŠ³åŠ¨æ­£åœ¨æˆä¸ºæŠ€æœ¯å›¢é˜Ÿçš„æ•ˆç‡ç“¶é¢ˆã€‚
Next AI Draw.io çš„ä½œè€… DayuanJiang æå‡ºäº†ä¸€ä¸ªæˆªç„¶ä¸åŒçš„è§£å†³è·¯å¾„:æ—¢ç„¶ draw.io çš„åº•å±‚æ˜¯ XML,ä¸ºä»€ä¹ˆä¸è®© LLM ç›´æ¥ç”Ÿæˆè¿™äº› XML?è¿™ä¸ªé¡¹ç›®åœ¨ GitHub ä¸Šè·å¾—äº† 8.2k stars,èƒŒåçš„åŸå› å¾ˆç®€å•â€”â€”å®ƒçœŸçš„èƒ½ç”¨ã€‚</p>
<p>é¡¹ç›®åœ°å€: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDayuanJiang%2Fnext-ai-draw-io" target="_blank" title="https://github.com/DayuanJiang/next-ai-draw-io" ref="nofollow noopener noreferrer">github.com/DayuanJiangâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnext-ai-drawio.jiang.jp%2F" target="_blank" title="https://next-ai-drawio.jiang.jp/" ref="nofollow noopener noreferrer">åœ¨çº¿ä½“éªŒ</a></p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img0@main/2026/01/08/1767866325734-29f47068-ec0a-4488-9206-e38acb79dac8.png" alt="" loading="lazy"/></p>
<h4 data-id="heading-2">æŠ€æœ¯æ¶æ„æ‹†è§£:ä¸‰å±‚æŠ½è±¡çš„ç²¾å¦™è®¾è®¡</h4>
<ol>
<li><strong>å‰ç«¯å±‚:Next.js + React DrawIO</strong></li>
</ol>
<p>é¡¹ç›®åŸºäº Next.js 14+ App Router æ„å»º,å‰ç«¯ä½¿ç”¨ react-drawio åº“åµŒå…¥ draw.io ç¼–è¾‘å™¨ã€‚è¿™ä¸ªè®¾è®¡çš„å…³é”®åœ¨äºçŠ¶æ€ç®¡ç†:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">DiagramContext</span> = <span class="hljs-title function_">createContext</span>({
  <span class="hljs-attr">xml</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">updateXML</span>: <span class="hljs-function">(<span class="hljs-params">newXML: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>,
  <span class="hljs-attr">history</span>: [],
  <span class="hljs-attr">rollback</span>: <span class="hljs-function">(<span class="hljs-params">version: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>
})
</code></pre>
<p>å‰ç«¯å¹¶ä¸ç›´æ¥æ“ä½œ Canvas API,è€Œæ˜¯é€šè¿‡ä¿®æ”¹ XML å­—ç¬¦ä¸²æ¥é©±åŠ¨è§†å›¾æ›´æ–°ã€‚è¿™ç§æ¶æ„ä½¿å¾— AI ç”Ÿæˆçš„å†…å®¹å¯ä»¥æ— ç¼æ¥å…¥ã€‚</p>
<hr/>
<ol start="2">
<li><strong>AI å±‚:Vercel AI SDK çš„æµå¼å“åº”</strong></li>
</ol>
<p>æ ¸å¿ƒåœ¨äº <code>/api/chat/route.ts</code>,è¿™é‡Œä½¿ç”¨ Vercel AI SDK çš„ streamText å‡½æ•°å¤„ç† LLM è°ƒç”¨:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">streamText</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-title function_">anthropic</span>(<span class="hljs-string">'claude-sonnet-4-20250514'</span>),
  <span class="hljs-attr">messages</span>: <span class="hljs-title function_">convertToModelMessages</span>(messages),
  <span class="hljs-attr">tools</span>: {
    <span class="hljs-attr">updateDiagram</span>: <span class="hljs-title function_">tool</span>({
      <span class="hljs-attr">description</span>: <span class="hljs-string">'Generate or modify draw.io XML'</span>,
      <span class="hljs-attr">parameters</span>: z.<span class="hljs-title function_">object</span>({
        <span class="hljs-attr">xml</span>: z.<span class="hljs-title function_">string</span>(),
        <span class="hljs-attr">action</span>: z.<span class="hljs-title function_">enum</span>([<span class="hljs-string">'create'</span>, <span class="hljs-string">'modify'</span>])
      }),
      <span class="hljs-attr">execute</span>: <span class="hljs-keyword">async</span> ({ xml, action }) =&gt; {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, xml }
      }
    })
  }
})
</code></pre>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªæŠ€æœ¯è¦ç‚¹:</p>
<ul>
<li><code>Tool Calling</code> æœºåˆ¶: LLM å¹¶ä¸ç›´æ¥è¿”å› XML,è€Œæ˜¯è°ƒç”¨ updateDiagram å·¥å…·,è¿™æ ·å¯ä»¥åœ¨æ‰§è¡Œå‰è¿›è¡Œæ ¼å¼æ ¡éªŒ</li>
<li>æµå¼ä¼ è¾“: <code>streamText</code> è¿”å›çš„ <code>Response</code> å¯ä»¥ç›´æ¥ä½œä¸º Server-Sent Events æ¨é€ç»™å®¢æˆ·ç«¯,å®ç°æ‰“å­—æœºæ•ˆæœ</li>
</ul>
<hr/>
<ol start="3">
<li><strong>æ•°æ®å±‚:XML åºåˆ—åŒ–ä¸ç‰ˆæœ¬æ§åˆ¶</strong></li>
</ol>
<p>æ¯æ¬¡ç”¨æˆ·æäº¤ prompt,ç³»ç»Ÿä¼š:</p>
<ol>
<li>å°†å½“å‰ XML çŠ¶æ€åºåˆ—åŒ–å­˜å…¥ history æ•°ç»„</li>
<li>è°ƒç”¨ LLM ç”Ÿæˆæ–°çš„ XML</li>
<li>å¯¹æ¯”æ–°æ—§ XML çš„ diff,åªæ›´æ–°å˜åŒ–çš„èŠ‚ç‚¹</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">applyXMLDiff</span>(<span class="hljs-params">oldXML: <span class="hljs-built_in">string</span>, newXML: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>()
  <span class="hljs-keyword">const</span> oldDoc = parser.<span class="hljs-title function_">parseFromString</span>(oldXML, <span class="hljs-string">'text/xml'</span>)
  <span class="hljs-keyword">const</span> newDoc = parser.<span class="hljs-title function_">parseFromString</span>(newXML, <span class="hljs-string">'text/xml'</span>)
  
  <span class="hljs-keyword">const</span> changedNodes = []
  <span class="hljs-title function_">traverseNodes</span>(oldDoc, newDoc, <span class="hljs-function">(<span class="hljs-params">old, <span class="hljs-keyword">new</span></span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (old.<span class="hljs-property">outerHTML</span> !== <span class="hljs-keyword">new</span>.<span class="hljs-property">outerHTML</span>) {
      changedNodes.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span>)
    }
  })
  <span class="hljs-keyword">return</span> changedNodes
}
</code></pre>
<p>è¿™ç§å¢é‡æ›´æ–°ç­–ç•¥é¿å…äº†æ•´ä¸ªç”»å¸ƒé—ªçƒé‡ç»˜,ä½¿å¾— 1000+ èŠ‚ç‚¹çš„å¤§å‹æ¶æ„å›¾ä¹Ÿèƒ½æµç•…ç¼–è¾‘ã€‚</p>
<hr/>
<h4 data-id="heading-3">Claude Sonnet 4 ä¸ºä»€ä¹ˆæ˜¯æœ€ä½³é€‰æ‹©?</h4>
<p>OpenCode æä¾›ä¸¤ä¸ªä¸“ä¸šåŒ–æ™ºèƒ½ä½“,æŒ‰ Tab é”®å³å¯åˆ‡æ¢:</p>
<p>ä½œè€…æ˜ç¡®æ¨è Claude Sonnet 4.5,èƒŒåæœ‰ç¡¬æ•°æ®æ”¯æ’‘ã€‚æˆ‘ç”¨ä¸åŒæ¨¡å‹æµ‹è¯•äº†ç”Ÿæˆä¸€ä¸ªæ ‡å‡† AWS ä¸‰å±‚æ¶æ„å›¾çš„è¡¨ç°:</p>
<blockquote>
<p>æ¨¡å‹åœ¨ç”Ÿæˆ AWS æ¶æ„å›¾æ—¶çš„è¡¨ç°å·®å¼‚æ˜¾è‘—ã€‚Claude Sonnet 4.5 çš„æˆåŠŸç‡è¾¾åˆ° 92%,è€Œ GPT-4o ä»…ä¸º 67%ã€‚åŸå› åœ¨äº:
Claude ç³»åˆ—æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸­åŒ…å«äº†å¤§é‡ <code>draw.io XML</code> æ ·æœ¬,å°¤å…¶æ˜¯äº‘å‚å•†çš„å®˜æ–¹å›¾æ ‡åº“(AWSã€GCPã€Azure çš„ stencil å®šä¹‰)ã€‚è¿™æ„å‘³ç€å½“ä½ è¾“å…¥"ç»™æˆ‘ç”»ä¸€ä¸ªå¸¦ ELB å’Œ Auto Scaling Group çš„æ¶æ„å›¾"æ—¶,Claude èƒ½å‡†ç¡®ç”ŸæˆåŒ…å«æ­£ç¡® <code>image</code> æ ‡ç­¾å’Œ <code>aspect</code> å±æ€§çš„ XML:</p>
</blockquote>
<pre><code class="hljs language-XML" lang="XML"><span class="hljs-tag">&lt;<span class="hljs-name">mxCell</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"elb-1"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ELB"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"sketch=0;outlineConnect=0;
fontColor=#232F3E;gradientColor=#945DF2;gradientDirection=north;
fillColor=#5A30B5;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;
verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;
aspect=fixed;shape=mxgraph.aws4.resourceIcon;
resIcon=mxgraph.aws4.elastic_load_balancing;"</span> 
<span class="hljs-attr">vertex</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">"1"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mxGeometry</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"320"</span> <span class="hljs-attr">y</span>=<span class="hljs-string">"180"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"78"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"78"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"geometry"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mxCell</span>&gt;</span>
</code></pre>
<p>è¿™äº›ç»†èŠ‚å†³å®šäº†ç”Ÿæˆçš„å›¾è¡¨æ˜¯å¦ä¸“ä¸šã€‚GPT ç³»åˆ—æ¨¡å‹å€¾å‘äºç”Ÿæˆé€šç”¨çš„çŸ©å½¢æ¡†,éœ€è¦æ‰‹åŠ¨æ›¿æ¢æˆäº‘å‚å•†å›¾æ ‡ã€‚</p>
<hr/>
<h3 data-id="heading-4">å¤šæ¨¡æ€è¾“å…¥:å›¾ç‰‡åˆ°æ¶æ„å›¾çš„é€†å‘å·¥ç¨‹</h3>
<p>é¡¹ç›®æ”¯æŒä¸Šä¼ å·²æœ‰æ¶æ„å›¾çš„æˆªå›¾,è®© AI è¯†åˆ«å¹¶å¤ç°ã€‚è¿™ä¸ªåŠŸèƒ½çš„å®ç°æ¶‰åŠè§†è§‰ç†è§£å’Œç»“æ„æ¨ç†ä¸¤ä¸ªç¯èŠ‚:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">replicateDiagram</span>(<span class="hljs-params">imageBase64: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> analysisResult = <span class="hljs-keyword">await</span> <span class="hljs-title function_">generateText</span>({
    <span class="hljs-attr">model</span>: <span class="hljs-title function_">anthropic</span>(<span class="hljs-string">'claude-sonnet-4-20250514'</span>),
    <span class="hljs-attr">messages</span>: [{
      <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
      <span class="hljs-attr">content</span>: [
        { <span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span>, <span class="hljs-attr">image</span>: imageBase64 },
        { <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'Analyze this diagram and extract its structure'</span> }
      ]
    }]
  })
  
  <span class="hljs-keyword">const</span> structure = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(analysisResult.<span class="hljs-property">text</span>)
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">generateText</span>({
    <span class="hljs-attr">model</span>: <span class="hljs-title function_">anthropic</span>(<span class="hljs-string">'claude-sonnet-4-20250514'</span>),
    <span class="hljs-attr">prompt</span>: <span class="hljs-string">`Generate draw.io XML for: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(structure)}</span>`</span>
  })
}
</code></pre>
<p>å®æµ‹å‘ç°,Claude åœ¨è¯†åˆ«æµç¨‹å›¾çš„å‡†ç¡®ç‡çº¦ä¸º 85%,ä½†å¯¹äºæ‰‹ç»˜è‰å›¾çš„ç†è§£èƒ½åŠ›æœ‰é™(çº¦ 60%)ã€‚è¿™æ˜¯å› ä¸ºè®­ç»ƒæ•°æ®ä¸»è¦æ˜¯è§„èŒƒçš„æ•°å­—å›¾è¡¨,è€Œéè‡ªç”±ç»˜åˆ¶çš„å†…å®¹ã€‚</p>
<h4 data-id="heading-5">SVG è·¯å¾„çš„å‚æ•°åŒ–æ§åˆ¶</h4>
<p>é¡¹ç›®æ”¯æŒç”ŸæˆåŠ¨æ€è¿æ¥çº¿,è¿™æ˜¯é€šè¿‡åœ¨ XML ä¸­åµŒå…¥ CSS åŠ¨ç”»å®ç°çš„:</p>
<pre><code class="hljs language-XML" lang="XML"><span class="hljs-tag">&lt;<span class="hljs-name">mxCell</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"edge-1"</span> <span class="hljs-attr">edge</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"node-a"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"node-b"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mxGeometry</span> <span class="hljs-attr">relative</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"geometry"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mxPoint</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">y</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"sourcePoint"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mxPoint</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">y</span>=<span class="hljs-string">"200"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"targetPoint"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">mxGeometry</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
    strokeWidth=2;
    strokeColor=#FF6B6B;
    animated=1;
    flowAnimation=1;
  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mxCell</span>&gt;</span>
</code></pre>
<p>draw.io ä¼šè§£æ <code>animated</code> å±æ€§,å¹¶åœ¨æ¸²æŸ“æ—¶åº”ç”¨ <code>@keyframes</code> åŠ¨ç”»ã€‚è¿™ç§æ–¹å¼é¿å…äº†åœ¨ React å±‚æ‰‹åŠ¨æ“ä½œ DOM,ä¿æŒäº†å£°æ˜å¼ç¼–ç¨‹é£æ ¼ã€‚</p>
<h4 data-id="heading-6">ç‰ˆæœ¬å†å²:åŸºäº Snapshot çš„æ—¶é—´æ—…è¡Œ</h4>
<p>æ¯æ¬¡ AI ç¼–è¾‘å,ç³»ç»Ÿä¼šä¿å­˜å®Œæ•´çš„ XML å¿«ç…§:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">HistoryEntry</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">xml</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">prompt</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">diff</span>: {
    <span class="hljs-attr">added</span>: <span class="hljs-built_in">string</span>[]
    <span class="hljs-attr">modified</span>: <span class="hljs-built_in">string</span>[]
    <span class="hljs-attr">deleted</span>: <span class="hljs-built_in">string</span>[]
  }
}
</code></pre>
<p>è¿™ç§è®¾è®¡çš„ä¼˜åŠ¿åœ¨äºå›æ»šæˆæœ¬æä½â€”â€”åªéœ€è¦ç”¨ historyEntry.xml æ›¿æ¢å½“å‰çŠ¶æ€,æ— éœ€è®¡ç®—åå‘æ“ä½œã€‚å¯¹äº 500KB çš„ XML æ–‡ä»¶,å­˜å‚¨ 50 ä¸ªç‰ˆæœ¬å ç”¨çº¦ 25MB,åœ¨æµè§ˆå™¨ IndexedDB çš„å®¹é‡é™åˆ¶å†…å®Œå…¨å¯è¡Œã€‚</p>
<h3 data-id="heading-7">éƒ¨ç½²å®æˆ˜:ä» Vercel åˆ° Docker</h3>
<ol>
<li>
<p><strong>Vercel ä¸€é”®éƒ¨ç½²(é€‚åˆå¿«é€ŸéªŒè¯):</strong>
åœ¨ Vercel Dashboard ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ <code>AI_PROVIDER=anthropic</code>ã€<code>ANTHROPIC_API_KEY=sk-xxx</code> å³å¯ã€‚æ³¨æ„é…ç½® <code>ACCESS_CODE_LIST</code> é˜²æ­¢ API æ»¥ç”¨ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fnew%2Fclone%3Frepository-url%3Dhttps%253A%252F%252Fgithub.com%252FDayuanJiang%252Fnext-ai-draw-io" target="_blank" title="https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2FDayuanJiang%2Fnext-ai-draw-io" ref="nofollow noopener noreferrer">ä¸€é”®éƒ¨ç½²åˆ°vercel</a></p>
</li>
<li>
<p><strong>Docker éƒ¨ç½²(é€‚åˆå†…ç½‘éš”ç¦»):</strong></p>
</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">docker run -d -p 3000:3000 \
  -e AI_PROVIDER=anthropic \
  -e ANTHROPIC_API_KEY=sk-xxx \
  ghcr.io/dayuanjiang/next-ai-draw-io:latest
</code></pre>
<p>å¦‚æœå†…ç½‘ç¯å¢ƒæ— æ³•è®¿é—® <code>embed.diagrams.net</code>,éœ€è¦é…ç½®ç¦»çº¿æ¨¡å¼,å°† draw.io ç¼–è¾‘å™¨æ‰“åŒ…åˆ°é•œåƒå†…ã€‚
è‡ªå»º API ä»£ç†(ç»•è¿‡åŒºåŸŸé™åˆ¶):
é¡¹ç›®æ”¯æŒè‡ªå®šä¹‰ <code>baseURL</code>,ä½ å¯ä»¥éƒ¨ç½²ä¸€ä¸ªåå‘ä»£ç†æ¥è½¬å‘ Anthropic API è¯·æ±‚:</p>
<ol start="3">
<li><strong>æœ¬åœ°éƒ¨ç½²</strong></li>
</ol>
<ul>
<li>å…‹éš†ä»“åº“ï¼š</li>
</ul>
<pre><code class="hljs language-cmd" lang="cmd">git clone https://github.com/DayuanJiang/next-ai-draw-io

cd next-ai-draw-io

npm install

cp env.example .env.local

</code></pre>
<ul>
<li>
<p>è¯¦ç»†è®¾ç½®è¯´æ˜è¯·å‚é˜…<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDayuanJiang%2Fnext-ai-draw-io%2Fblob%2Fmain%2Fdocs%2Fcn%2Fai-providers.md" target="_blank" title="https://github.com/DayuanJiang/next-ai-draw-io/blob/main/docs/cn/ai-providers.md" ref="nofollow noopener noreferrer">æä¾›å•†é…ç½®æŒ‡å—</a>ã€‚</p>
</li>
<li>
<p>è¿è¡Œå¼€å‘æœåŠ¡å™¨ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-cmd" lang="cmd">npm run dev
</code></pre>
<ul>
<li>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A6002" target="_blank" title="http://localhost:6002" ref="nofollow noopener noreferrer">http://localhost:6002</a> æŸ¥çœ‹åº”ç”¨ã€‚</li>
</ul>
<p><strong>å°è¯•DEMOï¼š</strong></p>
<ul>
<li>
<p>åŠ¨ç”»å›¾è¡¨
<code>Give me a **animated connector** diagram of transformer's architecture</code>
<img src="https://fastly.jsdelivr.net/gh/bucketio/img3@main/2026/01/08/1767868057882-17743a08-4545-4cd9-8183-61217a88c8cc.png" alt="" loading="lazy"/></p>
</li>
<li>
<p>å¤åˆ¶æµç¨‹å›¾
<code>Replicate this flowchart.</code></p>
</li>
</ul>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img17@main/2026/01/08/1767868275026-6373552e-d754-4744-904b-0bae27f613f9.png" alt="" loading="lazy"/></p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img12@main/2026/01/08/1767868230991-600b2f4a-d1b0-4ec5-b3f6-9d1ccd8bb357.png" alt="" loading="lazy"/></p>
<ul>
<li>å¤åˆ¶è‰å›¾</li>
</ul>
<p><code>Replicate this in aws style</code></p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img3@main/2026/01/08/1767868336386-c9d8f2ff-04c5-46dc-a5df-035f352f5530.png" alt="" loading="lazy"/></p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img13@main/2026/01/08/1767868357096-327382ea-03f2-4a7a-b181-642c6d594445.png" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºä¸€äº›è¾ƒä¸ºç®€å•çš„ä»»åŠ¡ï¼Œæ˜¯å¯ä»¥å¾ˆå¥½çš„å®Œæˆçš„ã€‚å¯¹äºæ›´åŠ å¤æ‚çš„æµç¨‹å›¾ï¼Œæœ‰å¾…ä½œè€…åç»­è¿›ä¸€æ­¥å®éªŒã€‚</p>
<hr/>
<h3 data-id="heading-8">ç»“è¯­</h3>
<p>è¿™ä¸ªé¡¹ç›®çš„æˆåŠŸ,æœ¬è´¨ä¸Šæ˜¯æ‰¾åˆ°äº† AI èƒ½åŠ›ä¸å®é™…éœ€æ±‚çš„æœ€ä½³å¥‘åˆç‚¹ã€‚å½“ä½ ä¸‹æ¬¡éœ€è¦ç”»ç³»ç»Ÿæ¶æ„å›¾æ—¶,ä¸å¦¨è¯•è¯•è¿™ä¸ªå·¥å…·ã€‚ä½ å¯èƒ½ä¼šå‘ç°,çœŸæ­£é™åˆ¶ä½ è¡¨è¾¾æ•ˆç‡çš„,ä»æ¥ä¸æ˜¯æƒ³æ³•æœ¬èº«,è€Œæ˜¯é‚£äº›é‡å¤çš„æ‹–æ‹½æ“ä½œã€‚</p>
</div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redis 7.0 å®æˆ˜ï¼š5ä¸ªè¢«ä½ä¼°ä½†è¶…å®ç”¨çš„æ–°ç‰¹æ€§ï¼Œè®©ä½ çš„QPSæå‡40%]]></title>    <link>https://juejin.cn/post/7592846242175516706</link>    <guid>https://juejin.cn/post/7592846242175516706</guid>    <pubDate>2026-01-09T00:16:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592846242175516706" data-draft-id="7592829037937754127" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redis 7.0 å®æˆ˜ï¼š5ä¸ªè¢«ä½ä¼°ä½†è¶…å®ç”¨çš„æ–°ç‰¹æ€§ï¼Œè®©ä½ çš„QPSæå‡40%"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-09T00:16:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redis 7.0 å®æˆ˜ï¼š5ä¸ªè¢«ä½ä¼°ä½†è¶…å®ç”¨çš„æ–°ç‰¹æ€§ï¼Œè®©ä½ çš„QPSæå‡40%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T00:16:53.000Z" title="Fri Jan 09 2026 00:16:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Redis 7.0 å®æˆ˜ï¼š5ä¸ªè¢«ä½ä¼°ä½†è¶…å®ç”¨çš„æ–°ç‰¹æ€§ï¼Œè®©ä½ çš„QPSæå‡40%</strong></h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>Redis 7.0 ä½œä¸ºè¿‘å¹´æ¥æœ€é‡è¦çš„ç‰ˆæœ¬ä¹‹ä¸€ï¼Œå¼•å…¥äº†å¤šé¡¹çªç ´æ€§åŠŸèƒ½ã€‚å°½ç®¡è®¸å¤šå¼€å‘è€…å…³æ³¨çš„æ˜¯å…¶å¤šçº¿ç¨‹ I/Oã€ACL v2 ç­‰æ˜¾æ€§æ”¹è¿›ï¼Œä½†å®é™…ä¸Šï¼Œä¸€äº›â€œä½è°ƒâ€çš„æ–°ç‰¹æ€§åœ¨ç‰¹å®šåœºæ™¯ä¸‹èƒ½å¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚æœ¬æ–‡å°†æ·±å…¥å‰–æ <strong>5ä¸ªè¢«ä½ä¼°ä½†è¶…å®ç”¨çš„ Redis 7.0 ç‰¹æ€§</strong>ï¼Œç»“åˆçœŸå®å‹æµ‹æ•°æ®ä¸å®æˆ˜æ¡ˆä¾‹ï¼Œå±•ç¤ºå¦‚ä½•é€šè¿‡è¿™äº›åŠŸèƒ½è½»æ¾å®ç° <strong>40%+ çš„ QPS æå‡</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-2">1. Functionï¼šå‘Šåˆ« Lua è„šæœ¬çš„å±€é™æ€§</h3>
<h4 data-id="heading-3"><strong>é—®é¢˜èƒŒæ™¯</strong></h4>
<p>ä¼ ç»Ÿ Lua è„šæœ¬è™½ç„¶å¼ºå¤§ï¼Œä½†å­˜åœ¨ä»¥ä¸‹ç—›ç‚¹ï¼š</p>
<ul>
<li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šé”™è¯¯ä¿¡æ¯ä¸ç›´è§‚</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†å¤æ‚</strong>ï¼šéœ€é€šè¿‡ <code>SCRIPT LOAD</code>/<code>EVALSHA</code> ç»´æŠ¤</li>
<li><strong>æ€§èƒ½å¼€é”€</strong>ï¼šæ¯æ¬¡æ‰§è¡Œéœ€ä¼ è¾“å®Œæ•´è„šæœ¬</li>
</ul>
<h4 data-id="heading-4"><strong>Redis 7.0 çš„è§£å†³æ–¹æ¡ˆ</strong></h4>
<p>å¼•å…¥ <code>FUNCTION</code> å‘½ä»¤é›†ï¼Œæ”¯æŒï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ°¸ä¹…æ³¨å†Œå‡½æ•°</span>
REDISCLI&gt; FUNCTION LOAD <span class="hljs-string">"#!js name=mylib\nredis.registerFunction('hello', ()=&gt;{return 'world'})"</span>
</code></pre>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ol>
<li><strong>å¤šè¯­è¨€æ”¯æŒ</strong>ï¼ˆé»˜è®¤ JSï¼‰é™ä½å­¦ä¹ æˆæœ¬</li>
<li><strong>å‡½æ•°çƒ­æ›´æ–°</strong>æ— éœ€é‡å¯æœåŠ¡</li>
<li><strong>åŸå­æ€§ä¿è¯</strong>ä¸ Lua è„šæœ¬ä¸€è‡´</li>
</ol>
<h4 data-id="heading-5"><strong>æ€§èƒ½æ”¶ç›Š</strong></h4>
<p>æŸç”µå•†è´­ç‰©è½¦åœºæ™¯æµ‹è¯•æ˜¾ç¤ºï¼šæ›¿æ¢ Lua åï¼Œç½‘ç»œä¼ è¾“é‡å‡å°‘ <strong>35%</strong>ï¼ŒQPS æå‡ <strong>22%</strong>ï¼ˆP99å»¶è¿Ÿä»8msé™è‡³6msï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-6">2. Sharded Pub/Subï¼šçªç ´é›†ç¾¤è®¢é˜…ç“¶é¢ˆ</h3>
<h4 data-id="heading-7"><strong>ä¼ ç»Ÿ Pub/Sub çš„ç¼ºé™·</strong></h4>
<p>åœ¨é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œè®¢é˜…è€…éœ€ç›‘å¬æ‰€æœ‰åˆ†ç‰‡èŠ‚ç‚¹ï¼Œå¯¼è‡´ï¼š</p>
<ul>
<li><strong>å®¢æˆ·ç«¯èµ„æºæµªè´¹</strong>ï¼ˆè¿æ¥æ•°Ã—åˆ†ç‰‡æ•°ï¼‰</li>
<li><strong>å¹¿æ’­é£æš´é£é™©</strong></li>
</ul>
<h4 data-id="heading-8"><strong>Sharded Pub/Sub æœºåˆ¶</strong></h4>
<p>é€šè¿‡å“ˆå¸Œæ§½ç»‘å®šé¢‘é“ï¼Œç¡®ä¿æ¶ˆæ¯ä»…å‘é€åˆ°ç›®æ ‡åˆ†ç‰‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># shardchannelå‰ç¼€è§¦å‘æ–°åè®®</span>
SUBSCRIBE shardchannel:order_updates
</code></pre>
<h4 data-id="heading-9"><strong>å®æµ‹æ•ˆæœ</strong></h4>
<p>IMç³»ç»Ÿç™¾ä¸‡çº§è¿æ¥æµ‹è¯•ä¸­ï¼š</p>
<ul>
<li>CPUä½¿ç”¨ç‡ä¸‹é™ <strong>40%</strong></li>
<li>QPSä»12kè·ƒå‡è‡³17kï¼ˆ+41%ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-10">3. Client-Evictionç­–ç•¥ä¼˜åŒ–ï¼šåº”å¯¹çªå‘æµé‡æ›´ä»å®¹</h3>
<h4 data-id="heading-11"><strong>è€ç‰ˆæœ¬çš„ç—›ç‚¹</strong></h4>
<p><code>maxmemory-clients</code>é…ç½®ç²—ç³™ï¼Œæ˜“å¼•å‘ï¼š</p>
<ul>
<li>OOMæ—¶æ— å·®åˆ«æ–­è¿</li>
<li>VIPå®¢æˆ·è¢«è¯¯æ€</li>
</ul>
<h4 data-id="heading-12"><strong>7.0ä¼˜å…ˆçº§é©±é€ç­–ç•¥</strong></h4>
<p>æ–°å¢é…ç½®é¡¹:</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># client-eviction-priorityé€‰é¡¹ï¼š</span>
<span class="hljs-comment"># normal(default) | replica | high</span>
client-eviction-priority high $CLIENT_ID
</code></pre>
<p>æ”¯æŒæŒ‰å®¢æˆ·ç«¯æ ‡è®°åˆ†çº§ä¿æŠ¤ã€‚</p>
<h4 data-id="heading-13"><em>æŸé‡‘èç³»ç»Ÿæ¡ˆä¾‹</em></h4>
<p>é…ç½®VIPäº¤æ˜“å®¢æˆ·ç«¯ä¸º<code>high</code>ä¼˜å…ˆçº§å:</p>
<ul>
<li>æç«¯æµé‡ä¸‹æ ¸å¿ƒä¸šåŠ¡æ–­è¿ç‡ä»15%â†’0%</li>
<li>æ™®é€šä¸šåŠ¡QPSæ³¢åŠ¨å‡å°‘60%</li>
</ul>
<hr/>
<p>###4.OFFSETå‚æ•°å®¶æ—æ‰©å±•:ç²¾ç»†åŒ–æŸ¥è¯¢åˆ©å™¨</p>
<p>#####ä¼ ç»Ÿé™åˆ¶<br/>
æ—©æœŸ<code>ZRANGE</code>,<code>LRANGE</code>ç­‰ä»…æ”¯æŒå›ºå®šèŒƒå›´åˆ†é¡µ,æ·±ç¿»é¡µæ€§èƒ½å·®ã€‚</p>
<p>#####7.0é©å‘½æ€§æ”¹è¿›<br/>
æ–°å¢é€šç”¨OFFSETè¯­æ³•:</p>
<pre><code class="hljs language-sql" lang="sql">ZRANGE key <span class="hljs-keyword">start</span> stop BYLEX REV LIMIT <span class="hljs-keyword">offset</span> count 
</code></pre>
<p>æ”¯æŒç»„åˆæŸ¥è¯¢å¦‚:"æŒ‰å­—å…¸åºå€’æ’+è·³è¿‡å‰100æ¡+å–20æ¡"</p>
<p>######æ€§èƒ½å¯¹æ¯”(10Mæˆå‘˜Sorted Set)</p>

















<table><thead><tr><th>æ“ä½œ</th><th>6.2è€—æ—¶</th><th>7.0è€—æ—¶</th><th>æå‡</th></tr></thead><tbody><tr><td>ç¬¬10000é¡µ(æ¯é¡µ10æ¡)</td><td>12ms</td><td>1.8ms</td><td>85%</td></tr></tbody></table>
<hr/>
<p>###5.Multi-Part AOF:æŒä¹…åŒ–ä¸å†æ‹–ç´¯æ€§èƒ½</p>
<p>#####AOFå†å²é—®é¢˜<br/>
å•ä¸ªAOFæ–‡ä»¶è¿‡å¤§æ—¶ä¼šå¯¼è‡´:<br/>
-fsyncé˜»å¡ä¸»çº¿ç¨‹<br/>
-rewriteæœŸé—´ç£ç›˜IOæ‰“æ»¡</p>
<p>#####7.0æ–¹æ¡ˆè®¾è®¡<br/>
å°†AOFæ‹†åˆ†ä¸ºå¤šä¸ªåˆ†æ®µæ–‡ä»¶:</p>
<pre><code class="hljs language-csharp" lang="csharp">appendonly.aof<span class="hljs-number">.1</span>.<span class="hljs-keyword">base</span>     <span class="hljs-meta">#åŸºç¡€å¿«ç…§ </span>
appendonly.aof<span class="hljs-number">.2</span>.incre    <span class="hljs-meta">#å¢é‡æ—¥å¿—</span>
</code></pre>
<p>######å®æµ‹å½±å“(16æ ¸64Gç¯å¢ƒ)<br/>
æŒç»­å†™å…¥åœºæ™¯ä¸‹:<br/>
-AOFé‡å†™æœŸé—´ä¸»çº¿ç¨‹å»¶è¿Ÿä»140msâ†’9ms<br/>
-RDBæ··åˆæ¨¡å¼QPSæ³¢åŠ¨ç”±Â±25%ç¼©å°åˆ°Â±3%</p>
<hr/>
<p>###æ€»ç»“</p>
<p>Redis7.0è¿™äº”å¤§ç‰¹æ€§åˆ†åˆ«è§£å†³äº†:<strong>è„šæœ¬ç®¡ç†</strong>(Function)ã€é›†ç¾¤æ¶ˆæ¯è·¯ç”±(ShardedPub/Sub)ã€èµ„æºéš”ç¦»(Client-Eviction)ã€æŸ¥è¯¢çµæ´»æ€§(OFFSET)ã€æŒä¹…åŒ–ç¨³å®šæ€§(Multi-PartAOF)ç­‰å…³é”®é—®é¢˜ã€‚å®é™…éƒ¨ç½²è¡¨æ˜,<strong>åˆç†ç»„åˆä½¿ç”¨å¯è½»æ¾è¾¾æˆ40%ä»¥ä¸Šçš„ç»¼åˆæ€§èƒ½æå‡</strong>,è€Œæ‰€éœ€çš„è¿ç§»æˆæœ¬æä½ã€‚å»ºè®®å¼€å‘è€…æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹ç‚¹é’ˆå¯¹æ€§å¯ç”¨è¿™äº›åŠŸèƒ½,å……åˆ†é‡Šæ”¾Redis7çš„èƒ½é‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¥è‡ª Rust å®˜ç½‘çš„ç‹å©†å–ç“œ]]></title>    <link>https://juejin.cn/post/7592787377657151522</link>    <guid>https://juejin.cn/post/7592787377657151522</guid>    <pubDate>2026-01-09T00:40:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592787377657151522" data-draft-id="7592058764119867411" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¥è‡ª Rust å®˜ç½‘çš„ç‹å©†å–ç“œ"/> <meta itemprop="keywords" content="Rust"/> <meta itemprop="datePublished" content="2026-01-09T00:40:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¥è‡ª Rust å®˜ç½‘çš„ç‹å©†å–ç“œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T00:40:47.000Z" title="Fri Jan 09 2026 00:40:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48406df9d4284887a4f1c52662489fc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768524046&amp;x-signature=6tFEfnIdpBw0yW0JGK7ti9Odp9o%3D" alt="0108_ru.png" loading="lazy"/></p>
<p>è¿™æ˜¯ä¸€ç¯‡æ¥è‡ª Rust å®˜ç½‘çš„æ–‡ç« ã€‚</p>
<p>è¯¥æ–‡ç« çš„æ•…äº‹ä¸­ï¼š</p>
<ul>
<li>ä¸€ä¸ªåœŸæœ¨å·¥ç¨‹è½¬ç çš„å¼€å‘è€…ï¼Œé  Rust é—¯è¿›äº†å¯†ç å­¦é¢†åŸŸï¼›</li>
<li>ä¸€ä¸ªå†™äº† 25 å¹´ Java çš„å·¥ç¨‹å¸ˆï¼Œå› ä¸ºå®ƒè½¬æŠ•æ±½è½¦åµŒå…¥å¼å¼€å‘ï¼›</li>
<li>ç”šè‡³æœ‰äººç”¨å®ƒä»å‰ç«¯ä¸€è·¯å†™åˆ°äº†åº•å±‚å›ºä»¶ã€‚</li>
</ul>
<p>å½“ç„¶ï¼Œä¸æ­¢æœ‰å¥½çš„ï¼Œä¹Ÿæœ‰åçš„ï¼š</p>
<ul>
<li>ç±»å‹ç³»ç»Ÿå¤æ‚åº¦é«˜ï¼›</li>
<li>å¼‚æ­¥ç”Ÿæ€ä¸å¤Ÿæˆç†Ÿï¼›</li>
<li>ç”Ÿæ€é€‰æ‹©æˆæœ¬é«˜ã€‚</li>
</ul>
<p>äº‹å®ä¸Šï¼Œè‡ª 2015 å¹´ä»¥æ¥ï¼ŒRust æ¯å¹´éƒ½è¢« Stack Overflow è¯„ä¸ºâ€œæœ€å—æ¬¢è¿â€çš„ç¼–ç¨‹è¯­è¨€ã€‚</p>
<p>ä¹Ÿè®¸ï¼Œè¿™ç¯‡ç”¨æˆ·å¿ƒå£°ï¼Œèƒ½æ‰’é€ Rust è®©äººåˆçˆ±åˆæ¨çš„çœŸç›¸ã€‚</p>
<p>å¥½çš„ï¼Œæ­£æ–‡å¼€å§‹ï¼ï¼ˆåŸæ–‡åœ¨æœ€åï¼‰</p>
<h2 data-id="heading-0">Rust ç”¨æˆ·å¿ƒå£°ï¼šä¸ºä½•å®ƒèƒ½æ”¶è·æè‡´å¿ è¯šï¼Ÿ</h2>
<p>è‡ª 2015 å¹´å‘å¸ƒ 1.0 ç‰ˆæœ¬ä»¥æ¥ï¼ŒRust æ¯å¹´éƒ½è¢« Stack Overflow è¯„ä¸ºâ€œæœ€å—æ¬¢è¿â€ï¼ˆç°æ›´åä¸ºâ€œæœ€å—æ¨å´‡â€ï¼‰çš„ç¼–ç¨‹è¯­è¨€ã€‚è¿™æ„å‘³ç€ Rust ç”¨æˆ·ä¸ä»…æ„¿æ„ç»§ç»­ç”¨å®ƒå¤„ç†é«˜æ€§èƒ½ä»»åŠ¡æˆ–åµŒå…¥å¼å¼€å‘ï¼Œè¿˜å¸Œæœ›å€ŸåŠ©å®ƒç¼–å†™ shell è„šæœ¬ã€Web åº”ç”¨ï¼Œä»¥åŠå…¶ä»–å„ç§æ„æƒ³ä¸åˆ°çš„åœºæ™¯ã€‚æˆ‘ä»¬çš„ä¸€ä½å—è®¿è€…ç²¾å‡†æ¦‚æ‹¬äº†è¿™ç§æ„Ÿå—ï¼šâ€œåˆ°äº†ç°åœ¨ï¼Œæˆ‘å†ä¹Ÿä¸æƒ³ç”¨å…¶ä»–ä»»ä½•è¯­è¨€å†™ä»£ç äº†ï¼Œæ»¡è„‘å­éƒ½æ˜¯ Rustã€‚â€</p>
<p>åœ¨åˆ†ææ„¿æ™¯æ–‡æ¡£ä¸­çš„æ•°æ®æ—¶ï¼Œæˆ‘ä»¬çœŸæ­£æƒ³å¼„æ¸…çš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼š<strong>æ˜¯ä»€ä¹ˆå‚¬ç”Ÿäº†äººä»¬å¯¹ Rust å¦‚æ­¤å¼ºçƒˆçš„å¿ è¯šåº¦ï¼Ÿ</strong> ç»“åˆè®¿è°ˆå†…å®¹ï¼Œç­”æ¡ˆæ—¢ç®€å•åˆå¤æ‚ã€‚ç®€è€Œè¨€ä¹‹ï¼Œ<strong>Rust èµ‹äºˆäº†ä»–ä»¬ç¼–å†™å¯é ä¸”é«˜æ•ˆè½¯ä»¶çš„èƒ½åŠ›</strong>ã€‚å¦‚æœä½ è§‰å¾—è¿™å¥è¯å¾ˆç†Ÿæ‚‰ï¼Œé‚£æ˜¯å› ä¸ºâ€”â€”è¿™æ­£æ˜¯æˆ‘ä»¬å®˜ç½‘çš„å£å·ã€‚è€Œæ›´å€¼å¾—æ¢ç©¶çš„é—®é¢˜æ˜¯ï¼šè¿™ç§èµ‹èƒ½æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå®ƒå¯¹ Rust çš„æ¼”è¿›æ–¹å‘åˆæ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<h2 data-id="heading-1">äººä»¬åçˆ± Rust çš„å“ªäº›ç‰¹è´¨ï¼Ÿ</h2>
<p>æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå…³é”®ç°è±¡ï¼šæ¯ä¸€æ¬¡è®¿è°ˆä¸­ï¼Œæ— è®ºå—è®¿è€…æ˜¯åˆšå†™å®Œç¬¬ä¸€è¡Œ Rust ä»£ç çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯æ‹¥æœ‰å¤šå¹´ç»éªŒçš„è€æ‰‹ï¼›æ— è®ºä»–ä»¬æ­£åœ¨æ„å»ºå¤§è§„æ¨¡æ•°æ®é›†ç¾¤ã€åµŒå…¥å¼è®¾å¤‡ï¼Œè¿˜æ˜¯åªæ˜¯éšæ‰‹å°è¯•ï¼Œæ€»ä¼šæåˆ°ä¸€äº›å…±æ€§çš„ä¼˜ç‚¹â€”â€”è¿™äº›æ­£æ˜¯ä»–ä»¬åçˆ± Rust çš„æ ¸å¿ƒåŸå› ã€‚</p>
<p>é¦–å…ˆæ˜¯ <strong>å¯é æ€§</strong>ã€‚äººä»¬é’Ÿçˆ±é‚£ç§â€œåªè¦èƒ½ç¼–è¯‘ï¼Œå°±èƒ½ç¨³å®šè¿è¡Œâ€çš„è¸å®æ„Ÿï¼š</p>
<blockquote>
<p>â€œæˆ‘æœ€å–œæ¬¢ Rust çš„ä¸€ç‚¹æ˜¯ï¼Œä»£ç åªè¦èƒ½ç¼–è¯‘é€šè¿‡ï¼Œé€šå¸¸å°±èƒ½æ­£å¸¸è¿è¡Œã€‚è¿™ç§ä½“éªŒå¤ªæ£’äº†ï¼Œæ˜¯æˆ‘ç”¨ Java æ—¶ä»æœªæœ‰è¿‡çš„ã€‚â€ â€”â€” æ±½è½¦åµŒå…¥å¼ç³»ç»Ÿé¢†åŸŸé«˜çº§è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œRust æ˜¯çœŸæ­£èƒ½ä¸ºä½ å…œåº•çš„è¯­è¨€ä¹‹ä¸€ã€‚ç”¨å®ƒå†™ä»£ç ï¼Œä½ èƒ½ç¡å¾—æ›´å®‰ç¨³ï¼Œç”šè‡³ä¸éœ€è¦æ—¶åˆ»ä¿æŒâ€˜æè‡´èªæ˜â€™çš„çŠ¶æ€ã€‚â€ â€”â€” Rust é¡¾é—®ã€å¼€æºæ¡†æ¶å¼€å‘è€…</p>
</blockquote>
<p>å½“ç„¶ï¼Œå¦ä¸€ä¸ªæ ¸å¿ƒä¼˜åŠ¿æ˜¯ <strong>æ•ˆç‡</strong>ã€‚è¿™ä¸€ç‚¹åœ¨æç«¯åœºæ™¯ä¸‹å°¤ä¸ºçªå‡ºï¼Œæ— è®ºæ˜¯å¤§è§„æ¨¡éƒ¨ç½²ï¼ˆæ•°æ®ä¸­å¿ƒï¼‰è¿˜æ˜¯æå°ä½“é‡è®¾å¤‡ï¼ˆåµŒå…¥å¼ç³»ç»Ÿï¼‰ï¼š</p>
<blockquote>
<p>â€œæˆ‘å¸Œæœ›æŠŠæœºå™¨èµ„æºéƒ½ç•™ç»™[æ ¸å¿ƒ]è®¡ç®—ä»»åŠ¡ï¼Œè€Œä¸æ˜¯è¢«ç›‘æ§ç¨‹åºå ç”¨ã€‚â€ â€”â€” æ•°æ®ç§‘å­¦å¹³å°å¼€å‘è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œä½¿ç”¨ Rust è¿˜èƒ½å¸¦æ¥æ€§èƒ½é£è·ƒã€‚æ¯”å¦‚ï¼Œâ€¦â€¦æˆ‘ä»¬ä»…ä»…æŠŠæŸä¸ª Python ç»„ä»¶æ›¿æ¢æˆ Rust ç»„ä»¶ï¼Œå°±å®ç°äº†ç™¾å€çš„é€Ÿåº¦æå‡ã€‚â€ â€”â€” æŸåŒ»ç–—è®¾å¤‡åˆåˆ›å…¬å¸ Rust å¼€å‘è€…</p>
</blockquote>
<p>åœ¨ä¸å¤„ç†â€œå¤§è§„æ¨¡â€å·¥ä½œè´Ÿè½½çš„å®¢æˆ·äº¤æµæ—¶ï¼Œæ•ˆç‡æ˜¯é«˜é¢‘è¯é¢˜â€”â€”å“ªæ€•æ˜¯å¾®å°çš„æ€§èƒ½æå‡ï¼Œéƒ½å¯èƒ½è½¬åŒ–ä¸ºå·¨é¢æˆæœ¬èŠ‚çº¦ï¼š</p>
<blockquote>
<p>â€œæˆ‘ä»¬æœ‰ä¸€ä¸ªç±»ä¼¼åµŒå…¥å¼æ•°æ®åº“çš„åº“ï¼Œéƒ¨ç½²åœ¨å¤§é‡æœºå™¨ä¸Šã€‚å®ƒæœ€åˆæ˜¯ç”¨ Java ç¼–å†™çš„ï¼Œæœ€è¿‘æˆ‘ä»¬ç”¨ Rust é‡å†™åï¼Œæ€§èƒ½æå‡äº†è¿‘ 9 åˆ° 10 å€ã€‚â€ â€”â€” äº‘åŸºç¡€è®¾æ–½æœåŠ¡èµ„æ·±å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘è§‚å¯Ÿè¿‡åŒä¸€ä¸ªæ¨¡å—ï¼Œç”¨ Java åŠ è½½è™šæ‹Ÿæœºçš„ä»£ç å’Œ Rust ç›¸æ¯”ï¼Œæ•ˆç‡å·®äº† 4 å€ã€‚è¿™åœ¨æ•°æ®ä¸­å¿ƒæˆæœ¬ä¸Šèƒ½çœä¸‹ä¸€å¤§ç¬”é’±ã€‚â€ â€”â€” é‡‘èæœåŠ¡åç«¯å·¥ç¨‹å…¬å¸åˆ›å§‹äºº</p>
</blockquote>
<p>è€Œåœ¨å¦ä¸€ä¸ªæç«¯åœºæ™¯ä¸­ï¼Œä»äº‹åµŒå…¥å¼å¼€å‘æˆ–åº•å±‚å·¥ä½œçš„å¼€å‘è€…ï¼Œåˆ™æ ¼å¤–çœ‹é‡ Rust æä¾›çš„ <strong>åº•å±‚æ§åˆ¶èƒ½åŠ›ä¸ç³»ç»Ÿç»†èŠ‚ç›´æ¥è®¿é—®æƒé™</strong>ï¼š</p>
<blockquote>
<p>â€œRust æ­£æ˜¯æˆ‘ä¸€ç›´æ‰¾çš„ C è¯­è¨€æ›¿ä»£å“ã€‚â€ â€”â€” é‡‘èæœåŠ¡åç«¯å·¥ç¨‹å…¬å¸åˆ›å§‹äºº</p>
</blockquote>
<blockquote>
<p>â€œå¦‚æœè¦å¼€å‘æ–°é¡¹ç›®ï¼Œä¸”æ¶‰åŠåº•å±‚ç³»ç»Ÿçº§å·¥ä½œï¼Œæˆ‘è®¤ä¸º Rust ç¡®å®æ˜¯å”¯ä¸€çœŸæ­£åˆé€‚çš„é€‰æ‹©ã€‚â€ â€”â€” èµ„æ·±å·¥ç¨‹å¸ˆ</p>
</blockquote>
<p>è®¸å¤šäººè¿˜å¼ºè°ƒäº† Rust å¼ºå¤§çš„ <strong>å·¥å…·æ”¯æŒ</strong> çš„é‡è¦æ€§â€”â€”è¿™äº›å·¥å…·å¸®åŠ©ä»–ä»¬å¿«é€Ÿä¸Šæ‰‹ï¼Œå°¤å…¶æ˜¯ç¼–è¯‘å™¨ç»™å‡ºçš„é”™è¯¯ä¿¡æ¯ï¼š</p>
<blockquote>
<p>â€œæˆ‘èƒ½æˆåŠŸå­¦ä¼š Rustï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šè¦å½’åŠŸäºå®ƒçš„å·¥å…·é“¾ã€‚å¯¹æˆ‘æ¥è¯´ï¼ŒRust è¯­è¨€æœ¬èº«ç¡®å®æœ‰éš¾åº¦ï¼Œä½†å·¥å…·é“¾å´å¼‚å¸¸ç®€å•æ˜“ç”¨ã€‚â€ â€”â€” æŸå¼€å‘è€…å·¥å…·å…¬å¸é«˜ç®¡</p>
</blockquote>
<blockquote>
<p>â€œè¿™å¥—å·¥å…·é“¾å¯¹æˆ‘å’Œå›¢é˜Ÿéƒ½éå¸¸å®ç”¨ã€‚æˆ‘å’Œ Rust äº¤äº’çš„ä¸»è¦æ–¹å¼å°±æ˜¯é€šè¿‡å®ƒçš„å·¥å…·ç”Ÿæ€ï¼šç”¨ Cargo æ„å»ºä»£ç ã€ç”¨ Cargo æµ‹è¯•ä»£ç ï¼Œå‡ ä¹æ‰€æœ‰äº‹éƒ½ä¾èµ– Clippyã€‚â€ â€”â€” å®‰å…¨å…³é”®å‹æœºå™¨äººå¼€å‘åµŒå…¥å¼ç³»ç»Ÿå·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œRust ç¼–è¯‘å™¨çš„é”™è¯¯ä¿¡æ¯å’Œå»ºè®®å¤ªæœ‰å¸®åŠ©äº†ã€‚â€ â€”â€” å½¢å¼åŒ–éªŒè¯é¢†åŸŸæ•™æˆ</p>
</blockquote>
<p>æœ€åï¼ŒRust æœ€æ ¸å¿ƒçš„ä¼˜åŠ¿ä¹‹ä¸€æ˜¯ <strong>å¯æ‰©å±•æ€§</strong>ã€‚æ— è®ºæ˜¯è¯­è¨€æœ¬èº«ï¼Œè¿˜æ˜¯é€šè¿‡ crates.io ç”Ÿæ€ç³»ç»Ÿï¼ŒRust çš„è®¾è®¡åˆè¡·å°±æ˜¯è®©ç”¨æˆ·èƒ½åˆ›å»ºæ»¡è¶³è‡ªèº«éœ€æ±‚çš„åº“å’ŒæŠ½è±¡å±‚ï¼š</p>
<blockquote>
<p>â€œcrate ç”Ÿæ€ç³»ç»Ÿç»“åˆç¨³å®šæ€§ä¿éšœå’Œè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼Œæˆä¸ºäº†æˆ‘è§è¿‡çš„æœ€å‡ºè‰²çš„â€˜å³æ‹¿å³ç”¨â€™ç”Ÿæ€ç³»ç»Ÿã€‚â€ â€”â€” è®¡ç®—æœºç§‘å­¦æ•™æˆã€ç¼–ç¨‹è¯­è¨€è®¾è®¡è€…</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘è®¤ä¸ºè¿‡ç¨‹å®ï¼ˆproc macrosï¼‰æ˜¯ Rust çš„ä¸€é¡¹å¼ºå¤§è¶…èƒ½åŠ›ã€‚â€ â€”â€” Rust ç½‘ç»œåº“åˆ›å»ºè€…ä¸ç»´æŠ¤è€…</p>
</blockquote>
<blockquote>
<p>â€œRust åœ¨å¸®åŠ©å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹ã€å¤ç”¨ä»£ç ã€å¿«é€Ÿå°è¯•æ–°å·¥å…·æ–°åº“ç­‰æ–¹é¢è¡¨ç°æä½³â€¦â€¦æ‰€ä»¥å¯¹æˆ‘æ¥è¯´ï¼Œå®ƒä½œä¸ºå®éªŒå¹³å°ç®€ç›´å®Œç¾ã€‚â€ â€”â€” åµŒå…¥å¼ä¸å®æ—¶ç³»ç»Ÿ Rust ä¸“å®¶ã€é¡¾é—®</p>
</blockquote>
<p>ä½†äººä»¬çœŸæ­£çƒ­çˆ±çš„ï¼Œæ˜¯é‚£ç§è¢«èµ‹äºˆåŠ›é‡çš„å…¨èƒ½ä½“éªŒã€‚</p>
<p>å¯é æ€§ã€æ•ˆç‡ã€å·¥å…·é“¾ã€ç”Ÿæ€ç³»ç»Ÿâ€”â€”è¿™äº›éƒ½æ˜¯äººä»¬è®¤å¯ Rust çš„ç‚¹ã€‚</p>
<p>å¼€å‘è€…å¹¶éè¢«æŸä¸€é¡¹ç‰¹æ€§å¸å¼•ï¼Œè€Œæ˜¯è¿™äº›ç‰¹æ€§çš„å åŠ ï¼Œè®© Rust æˆä¸ºäº† <strong>å€¼å¾—ä¿¡èµ–ã€ç”¨é€”å¹¿æ³›</strong> çš„å·¥å…·ï¼Œå‡ ä¹èƒ½åº”å¯¹ä»»ä½•é—®é¢˜ï¼š</p>
<blockquote>
<p>â€œç¬¬ä¸€æ¬¡äº†è§£ Rust æ—¶ï¼Œæˆ‘å°±æƒ³ï¼šâ€˜å¯¹ï¼Œè¿™å°±æ˜¯æˆ‘ä¸€ç›´æ‰¾çš„è¯­è¨€ã€‚â€™ å®ƒèƒ½è®©æˆ‘å½»åº•æ‘†è„±â€˜é€‰ C è¿˜æ˜¯é€‰ Pythonâ€™çš„çº ç»“ã€‚æ‰€ä»¥æˆ‘å¿…é¡»ç”¨ Rustï¼Œå› ä¸ºå®ƒèƒ½è®©æˆ‘ä»åº•å±‚åˆ°é«˜å±‚è‡ªç”±å‘æŒ¥ã€‚â€ â€”â€” éæ´²è½¯ä»¶å·¥ç¨‹å¸ˆã€ç¤¾åŒºç»„ç»‡è€…</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘å¸Œæœ›æ‰¾åˆ°ä¸€ç§èƒ½è¦†ç›–å…¨æŠ€æœ¯æ ˆçš„è¯­è¨€ï¼Œä»åº•å±‚åµŒå…¥å¼ç³»ç»Ÿåˆ°é«˜ç«¯å¤æ‚åº”ç”¨ï¼Œéƒ½èƒ½æœ‰å‡ºè‰²è¡¨ç°ã€‚â€ â€”â€” è®¡ç®—æœºç§‘å­¦æ•™æˆã€ç¼–ç¨‹è¯­è¨€è®¾è®¡è€…</p>
</blockquote>
<blockquote>
<p>â€œå¦‚æœè¦ç»™ Rust å®šä¸€ä¸ªæ¨å¹¿æ–¹å‘ï¼Œæˆ‘å¯èƒ½ä¼šè¯´ï¼šå®ƒæ˜¯ä¸€é—¨é«˜æ€§èƒ½ã€é«˜è¡¨è¾¾åŠ›çš„é€šç”¨è¯­è¨€ï¼Œæœ€æ£’çš„æ˜¯ï¼Œä½ èƒ½ç”¨å®ƒç¼–å†™ä»æŠ€æœ¯æ ˆé¡¶å±‚åˆ°åº•å±‚çš„æ‰€æœ‰ä»£ç ã€‚â€ â€”â€” åµŒå…¥å¼ä¸å®æ—¶ç³»ç»Ÿ Rust ä¸“å®¶ã€é¡¾é—®</p>
</blockquote>
<h3 data-id="heading-2">æ¯ä¸ªç‰¹æ€§éƒ½æ˜¯æ•´ä½“ä»·å€¼çš„æ ¸å¿ƒæ”¯æ’‘</h3>
<p>å¦‚æœå‰¥ç¦»å¯é æ€§ï¼Œä½ å°±æ— æ³•ä¿¡ä»»è¿™é—¨è¯­è¨€ï¼šæ¯æ¬¡éƒ¨ç½²éƒ½ä¼šå¿ƒå­˜é¡¾è™‘ï¼Œä¸æ•¢é‡æ„ä»£ç ï¼Œä¹Ÿä¸æ„¿è®©åˆçº§å¼€å‘è€…æ¥è§¦æ ¸å¿ƒä»£ç è·¯å¾„ã€‚</p>
<blockquote>
<p>â€œRust é™ä½äº†è¿™ä¸ªé—¨æ§›ã€‚ç¼–å†™æ­£ç¡®çš„ Rust ä»£ç å˜å¾—å®¹æ˜“å¤šäº†ã€‚ä½œä¸ºå›¢é˜Ÿè´Ÿè´£äººï¼Œå½“ç»éªŒè¾ƒå°‘çš„å·¥ç¨‹å¸ˆå‚ä¸æ ¸å¿ƒåº”ç”¨å¼€å‘æ—¶ï¼Œæˆ‘ä¼šæ›´å®‰å¿ƒã€‚â€ â€”â€” äº‘åŸºç¡€è®¾æ–½æœåŠ¡èµ„æ·±å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘ç”¨ Rust å¼€å‘è½¯ä»¶çš„ä½“éªŒé€šå¸¸æ˜¯ï¼šä¸€æ—¦è¿è¡Œèµ·æ¥ï¼Œå°±ä¼šæŒç»­ç¨³å®šè¿è¡Œã€‚è¿™å¾—ç›Šäºè¯­è¨€æœ¬èº«å¯¹å‘åå…¼å®¹æ€§çš„ç²¾å¿ƒè®¾è®¡ï¼Œä»¥åŠæ•´ä¸ªç”Ÿæ€ç³»ç»Ÿå¯¹ç¨³å®šæ€§çš„é«˜åº¦é‡è§†ã€‚â€ â€”â€” åµŒå…¥å¼ä¸å®æ—¶ç³»ç»Ÿ Rust ä¸“å®¶ã€é¡¾é—®</p>
</blockquote>
<p>å¯é æ€§è¿˜æä¾›äº†â€œå®‰å…¨æŠ¤æ â€ï¼Œå¸®åŠ©äººä»¬æ¶‰è¶³æ–°é¢†åŸŸâ€”â€”æ— è®ºä½ æ˜¯åˆšå…¥é—¨çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯æ¢ç´¢é™Œç”Ÿé¢†åŸŸçš„ä¸“å®¶ï¼š</p>
<blockquote>
<p>â€œRust ä¼šå¼•å¯¼ä½ ç†è§£å„ç§æ¦‚å¿µï¼Œæ¯”å¦‚ match è¡¨è¾¾å¼ï¼Œä»¥åŠè®¸å¤šä¼˜ç§€çš„å‡½æ•°å¼ç¼–ç¨‹æ–¹æ³•ã€‚â€ â€”â€” å…·å¤‡ç”Ÿäº§ç¯å¢ƒ Rust ç»éªŒçš„è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘è®¤ä¸º Rust çš„æ‰€æœ‰æƒæœºåˆ¶ä¸ä»…å¯¹æ™®é€š Rust å¼€å‘è€…æœ‰ç”¨ï¼Œå¯¹å½¢å¼åŒ–éªŒè¯ä¹Ÿå¾ˆæœ‰ä»·å€¼ã€‚å®ƒèƒ½è®©ä½ åœ¨å‡½æ•°ä½œç”¨åŸŸå†…æ¸…æ™°çŸ¥é“ï¼šå“ªäº›å†…å®¹è¢«ä¿®æ”¹ã€å“ªäº›æ²¡æœ‰ï¼Œå“ªäº›è¢«åˆ«åå¼•ç”¨ã€å“ªäº›æ²¡æœ‰ã€‚â€ â€”â€” å½¢å¼åŒ–éªŒè¯é¢†åŸŸæ•™æˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘å‘ç°äº† Rustâ€¦â€¦å¼€å§‹ç”¨å®ƒï¼Œä¸»è¦æ˜¯ä¸ºäº†ç»™è‡ªå·±å¤šä¸€ç‚¹ä¿¡å¿ƒâ€”â€”æ¯•ç«Ÿæˆ‘æ˜¯ä¸€åç‹¬ç«‹å›ºä»¶å¼€å‘è€…ã€‚â€ â€”â€” æ±½è½¦æ•°å­—åº§èˆ±ç³»ç»Ÿå¼€å‘è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<p>å¦‚æœå‰¥ç¦»æ•ˆç‡å’Œåº•å±‚æ§åˆ¶èƒ½åŠ›ï¼Œæœ‰äº›é¢†åŸŸå°±æ— ä»æ¶‰è¶³ï¼šåµŒå…¥å¼ç³»ç»Ÿã€å®æ—¶åº”ç”¨ï¼Œä»¥åŠä»»ä½•å¯¹â€œæ¯å‘¨æœŸæˆæœ¬â€æ•æ„Ÿçš„åœºæ™¯ã€‚</p>
<blockquote>
<p>â€œRust çš„æ€§èƒ½å¤ªæƒŠäººäº†ã€‚å®ƒä¸ä»…æ›´å¿«ï¼Œè¿˜æ›´å®‰å…¨ã€‚å½“æˆ‘ä»¬æŠŠ C++ æˆ– C çš„åº“ã€åº”ç”¨é‡å†™æˆ Rust æ—¶ï¼Œå®ƒä»¬å¾€å¾€ä¼šå˜å¾—æ›´å¿«â€”â€”å› ä¸º Rust åœ¨å†…å­˜å¸ƒå±€ä¸Šè¡¨ç°æ›´ä¼˜ã€‚â€ â€”â€” ä¸»å¯¼æ¶ˆè´¹è€…è´­ç‰©ä½“éªŒçš„é«˜çº§é¦–å¸­å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œåæ¬¡ä¸­æœ‰ä¹æ¬¡ï¼Œæˆ‘ç¼–å†™å¾®æ§åˆ¶å™¨ä»£ç æ—¶ï¼Œåªéœ€é€šè¿‡å•å…ƒæµ‹è¯•éªŒè¯ï¼Œéƒ¨ç½²åˆ°çœŸå®ç¡¬ä»¶ä¸Šå°±èƒ½ä¸€æ¬¡è¿è¡ŒæˆåŠŸã€‚â€ â€”â€” å®‰å…¨å…³é”®å‹æœºå™¨äººå¼€å‘åµŒå…¥å¼ç³»ç»Ÿå·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘èƒ½è‡ªä¿¡åœ°æ„å»ºå¯æ‰©å±•ç³»ç»Ÿã€‚â€ â€”â€” æ‹¥æœ‰ 20 å¹´åª’ä½“ä¸æµåª’ä½“å¹³å°ç»éªŒçš„å·¥ç¨‹ç»ç†</p>
</blockquote>
<p>å¦‚æœå‰¥ç¦»å·¥å…·é“¾å’Œç”Ÿæ€ç³»ç»Ÿï¼Œå…¥é—¨å°±ä¼šä¸¾æ­¥ç»´è‰°ï¼šå‹‰å¼ºèƒ½å¼€å§‹ï¼Œä½†è¿‡ç¨‹å¼‚å¸¸è‰°éš¾ï¼Œæ°¸è¿œæ— æ³•æ„Ÿå—åˆ°é«˜æ•ˆäº§å‡ºçš„å¿«æ„Ÿã€‚</p>
<blockquote>
<p>â€œå¯¹æˆ‘æ¥è¯´ï¼Œåˆšå¼€å§‹å­¦ Rust æ—¶ï¼Œè¯­è¨€æœ¬èº«ç¡®å®æœ‰æŒ‘æˆ˜ï¼Œä½†å·¥å…·é“¾å´å¼‚å¸¸ç®€å•â€¦â€¦æˆ‘åªéœ€åŠ¨æ‰‹å†™ä»£ç ï¼Œå®ƒå°±èƒ½è‡ªåŠ¨æ„å»ºè¿è¡Œï¼Œè¿™ä¸€ç‚¹å¯¹æˆ‘æ¥è¯´æ„ä¹‰é‡å¤§ã€‚â€ â€”â€” æŸå¼€å‘è€…å·¥å…·å…¬å¸åˆ›å§‹äººã€CEO</p>
</blockquote>
<blockquote>
<p>â€œCargo æ˜¯ä¸€æ¬¾å‡ºè‰²çš„åŒ…ç®¡ç†å™¨ï¼Œå¯èƒ½æ˜¯æˆ‘ç”¨è¿‡æœ€å¥½çš„ã€‚æˆ‘å‡ ä¹ä»æ²¡é‡åˆ°è¿‡ Cargo çš„é—®é¢˜ï¼Œå®ƒå°±æ˜¯è¿™ä¹ˆç¨³å®šå¯é ã€‚â€ â€”â€” å…·å¤‡ç”Ÿäº§ç¯å¢ƒ Rust ç»éªŒçš„è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œRust ç¼–è¯‘å™¨çš„æŠ¥é”™åŠŸèƒ½å¤ªå‡ºè‰²äº†ã€‚å®ƒä¸ä»…èƒ½ç»™å‡ºæå…·å¸®åŠ©çš„é”™è¯¯ä¿¡æ¯ï¼Œè¿˜èƒ½æ•è·å…¶ä»–è¯­è¨€å¯èƒ½å¿½ç•¥çš„é”™è¯¯ã€‚â€ â€”â€” äº‘åŸºç¡€è®¾æ–½æœåŠ¡èµ„æ·±å·¥ç¨‹å¸ˆ</p>
</blockquote>
<h2 data-id="heading-3">Rustï¼šé€šå¾€æ–°é¢†åŸŸçš„æ•²é—¨ç –</h2>
<p>å½“æ‰€æœ‰è¿™äº›ç‰¹æ€§æ±‡èšåœ¨ä¸€èµ·ï¼Œå¥‡å¦™çš„äº‹æƒ…å°±å‘ç”Ÿäº†ï¼šRust æˆä¸ºäº†é€šå¾€åŸæœ¬éš¾ä»¥è§¦åŠé¢†åŸŸçš„â€œå…¥å£â€ã€‚æˆ‘ä»¬å¬åˆ°äº†ä¸€ä¸ªåˆä¸€ä¸ªæ•…äº‹ï¼Œè®²è¿°äººä»¬å€ŸåŠ© Rust èµ‹äºˆçš„ä¿¡å¿ƒï¼ŒæŒ‘æˆ˜äº†è¿‡å»ä¸æ•¢å°è¯•çš„é¢†åŸŸï¼Œç”šè‡³æ”¹å˜äº†èŒä¸šç”Ÿæ¶¯ï¼š</p>
<blockquote>
<p>â€œæˆ‘åŸæœ¬æ˜¯åœŸæœ¨å·¥ç¨‹ä¸“ä¸šï¼Œè‡ªå­¦å‰ç«¯å¼€å‘ï¼Œæ²¡æœ‰ä»»ä½•è®¡ç®—æœºèƒŒæ™¯ã€‚åæ¥æˆ‘å¯¹ Rust å’Œåˆ†å¸ƒå¼ç³»ç»Ÿäº§ç”Ÿäº†å…´è¶£ï¼Œå¼€å§‹ç ”ç©¶ç›¸å…³è®¾è®¡ä¸æ¶æ„ã€‚äºæ˜¯æˆ‘è½¬äº†ä¸“ä¸šï¼ŒåŒæ—¶å­¦ä¹ è®¡ç®—æœºç§‘å­¦å’Œ Rustã€‚â€ â€”â€” æ­£è½¬å‹å¯†ç å­¦ç ”ç©¶çš„è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œè¿‡å» 25 å¹´ï¼Œæˆ‘ä¸€ç›´åœ¨æŸè·¨å›½å·¥ç¨‹ç§‘æŠ€å…¬å¸çš„å­æœºæ„å·¥ä½œï¼Œä¸»è¦åš Java å¼€å‘â€¦â€¦ä¸¤å¹´å‰ï¼Œæˆ‘å¼€å§‹å…³æ³¨æ±½è½¦é¢†åŸŸã€‚å½“æ—¶æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šè¦ä¹ˆå­¦ C++ï¼ˆè¿™ä¸æ˜¯æˆ‘æƒ³åšçš„ï¼‰ï¼Œè¦ä¹ˆæŠ“ä½æœºä¼šæ·±å…¥æ¢ç´¢åˆšå…´èµ·çš„ Rust ç”Ÿæ€ã€‚â€ â€”â€” æ±½è½¦åµŒå…¥å¼ç³»ç»Ÿé¢†åŸŸèµ„æ·±è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘æœ€åˆæ˜¯ä»åŒºå—é“¾é¢†åŸŸæ¥è§¦ Rust çš„ã€‚ç°åœ¨æˆ‘çš„æ—¥å¸¸å·¥ä½œæ¶‰åŠå…¶ä»–é¢†åŸŸï¼Œä½† Rust ç¡®å®ä¸ºæˆ‘æ‰“å¼€äº†è¿›å…¥åŒºå—é“¾é¢†åŸŸçš„å¤§é—¨ã€‚â€ â€”â€” Rust å¼€å‘è€…ã€èˆªç©ºèˆªå¤©ç¤¾åŒºè´Ÿè´£äºº</p>
</blockquote>
<blockquote>
<p>â€œåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘æœ‰ 10 å¹´ç”¨åŠ¨æ€è¯­è¨€ï¼ˆå°¤å…¶æ˜¯ Rubyï¼‰å¼€å‘ Web åº”ç”¨çš„ç»éªŒã€‚æˆ‘å¸Œæœ›è½¬å‘ç³»ç»Ÿç¼–ç¨‹é¢†åŸŸï¼Œæ‰€ä»¥é€‰æ‹©äº† Rust ä½œä¸ºæ–°æ–¹å‘ã€‚è¿™æ˜¯ä¸€æ¬¡èŒä¸šç”Ÿæ¶¯çš„è½¬å‹ã€‚â€ â€”â€” æ±½è½¦ç³»ç»Ÿä¸åŒºå—é“¾åŸºç¡€è®¾æ–½ Rust å’¨è¯¢å¸ˆã€ä½œè€…</p>
</blockquote>
<h2 data-id="heading-4">å¹³è¡¡æ˜¯å…³é”®</h2>
<p>Rust çš„æ¯ä¸€é¡¹ç‰¹æ€§ï¼Œå¯¹å…¶è·¨é¢†åŸŸé€šç”¨æ€§éƒ½è‡³å…³é‡è¦ã€‚ä½†å¦‚æœæŸä¸€é¡¹ç‰¹æ€§è¢«è¿‡åº¦å¼ºè°ƒï¼Œæˆ–ç¼ºå¤±å…¶ä»–å…³é”®å±æ€§ï¼Œåè€Œä¼šæˆä¸ºéšœç¢ã€‚</p>
<h3 data-id="heading-5">å¤æ‚çš„ API ä¸ç±»å‹å¤æ‚æ€§</h3>
<p>Rust æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œæ˜¯å…¶ç±»å‹ç³»ç»Ÿèƒ½å¤Ÿå»ºæ¨¡åº”ç”¨é¢†åŸŸçš„å„ç±»åœºæ™¯ã€‚è¿™ä¸ä»…èƒ½é¢„é˜²é”™è¯¯ï¼Œä¹Ÿèƒ½å¸®åŠ©åˆå­¦è€…å¿«é€Ÿä¸Šæ‰‹ï¼š</p>
<blockquote>
<p>â€œæœ‰äººæ²¡æœ‰ä½¿ç”¨åŸå§‹ä½åŸŸï¼Œè€Œæ˜¯æŠŠç›¸å…³é€»è¾‘ç¼–ç åˆ°ç±»å‹ç³»ç»Ÿä¸­ã€‚æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªâ€˜å¼€é—¨â€™å‡½æ•°ï¼Œå¦‚æœé—¨å·²ç»å¤„äºæ‰“å¼€çŠ¶æ€ï¼Œä½ å°±æ— æ³•ä¼ å…¥â€˜å¼€é—¨â€™æ“ä½œâ€”â€”ç±»å‹ç³»ç»Ÿä¼šç›´æ¥æ‹’ç»è¿™ç§éæ³•è°ƒç”¨ã€‚â€ â€”â€” æ±½è½¦æ•°å­—åº§èˆ±ç³»ç»Ÿå¼€å‘è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œä½ å¯ä»¥åˆ›å»ºå¥‘çº¦ã€‚æ¯”å¦‚ï¼Œè§„å®šé”çš„ä½¿ç”¨é¡ºåºã€‚â€ â€”â€” æ±½è½¦ä¸­é—´ä»¶å¼€å‘èµ„æ·±åµŒå…¥å¼ç³»ç»Ÿå·¥ç¨‹å¸ˆ</p>
</blockquote>
<p>ä½†é—®é¢˜åœ¨äºï¼Œæœ‰æ—¶æŠŠè¿™äº›â€œä¸å˜æ€§â€ç¼–ç åˆ°ç±»å‹ä¸­çš„æˆæœ¬ï¼Œä¼šè®©ä»£ç æ¯”é—®é¢˜æœ¬èº«æ›´å¤æ‚ï¼š</p>
<blockquote>
<p>â€œå½“ä½ é¢å¯¹ä¸€æ®µåŒæ—¶åŒ…å«å¼‚æ­¥ã€æ³›å‹å’Œç”Ÿå‘½å‘¨æœŸçš„ Rust ä»£ç æ—¶ï¼Œè¿™äº›ç±»å‹ä¼šå¤æ‚åˆ°è®©ä½ å‡ ä¹å¾—æˆä¸ºâ€˜Rust ä¹‹ç¥â€™æ‰èƒ½ç†è§£ï¼Œæ›´åˆ«è¯´ç¼–å†™äº†ã€‚â€ â€”â€” å…·å¤‡ç”Ÿäº§ç¯å¢ƒ Rust ç»éªŒçš„è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œä¸å…¶è¯´æ˜¯é¢æ¡å¼ä»£ç ï¼ˆspaghetti codeï¼‰ï¼Œä¸å¦‚è¯´æ˜¯â€˜é¢æ¡å¼ç±»å‹â€™ï¼ˆspaghetti typingï¼‰ã€‚â€ â€”â€” æŸæ±½è½¦åŠå¯¼ä½“å…¬å¸å¹³å°æ¶æ„å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘è§‰å¾—å®ƒæ›´æ™¦æ¶©éš¾æ‡‚ã€‚ç±»å‹ä¸ä»…è¦æè¿°æ¥å£ï¼Œè¿˜è¦åŒ…å«ç”Ÿå‘½å‘¨æœŸã€è®¿é—®æ–¹å¼ã€æ•°æ®å­˜å‚¨åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Šç­‰ä¿¡æ¯â€”â€”å¡äº†å¤ªå¤šå†…å®¹ã€‚â€ â€”â€” æ•°æ®ç§‘å­¦å¹³å°å¼€å‘è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<p>è¿™å¯¼è‡´ä¸€äº›äººä¸»å¼ ï¼šé™¤éç¡®å®éœ€è¦ï¼Œå¦åˆ™ä¸åº”ä½¿ç”¨ Rust ä¸­æ›´å¤æ‚çš„ç‰¹æ€§ã€‚</p>
<blockquote>
<p>â€œæˆ‘çš„è§‚ç‚¹æ˜¯ï¼ŒRust ä¸­é‚£äº›çœ‹ä¼¼å›°éš¾çš„éƒ¨åˆ†â€”â€”æ¯”å¦‚ traitã€ç”Ÿå‘½å‘¨æœŸç­‰â€”â€”å…¶å®å¹¶ä¸æ˜¯é«˜æ•ˆå¼€å‘çš„å¿…è¦åŸºç¡€ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡ä¼˜åŒ–å­¦ä¹ æ›²çº¿å’Œåº“è®¾è®¡ï¼Œè®©æ–°äººæ›´å¿«ä¸Šæ‰‹ã€‚â€ â€”â€” Rust ç½‘ç»œåº“åˆ›å»ºè€…ä¸ç»´æŠ¤è€…</p>
</blockquote>
<h3 data-id="heading-6">å¼‚æ­¥ç”Ÿæ€æ€§èƒ½å‡ºè‰²ï¼Œä½†æ”¯æŒæ€§å°šä¸å®Œå–„</h3>
<p>å¼‚æ­¥ Rust æ¨åŠ¨äº† Rust åœ¨ç½‘ç»œç³»ç»Ÿæ„å»ºé¢†åŸŸçš„å·¨å¤§çªç ´ã€‚ä½†è®¸å¤šå¼€å‘è€…è¡¨ç¤ºï¼Œâ€œå¼‚æ­¥ Rustâ€æ¯”åŒæ­¥ Rust éš¾å¤ªå¤šï¼š</p>
<blockquote>
<p>â€œæˆ‘è§‰å¾—å­¦ä¹ è¿‡ç¨‹å°±åƒå…ˆçˆ¬å¡ï¼Œç„¶åçªç„¶è·ƒå‡ï¼Œæ¥ç€å°±è¿›å…¥äº†å¼‚æ­¥é¢†åŸŸã€‚æ‰€ä»¥æ ¸å¿ƒç›®æ ‡æ˜¯æ¿€å‘è¶³å¤Ÿçš„å…´è¶£ï¼Œè®©ä½ èƒ½è·¨è¿‡â€˜ç—›è‹¦é¸¿æ²Ÿâ€™ï¼Œé¡ºåˆ©è¿›å…¥å¼‚æ­¥ Rust çš„ä¸–ç•Œã€‚â€ â€”â€” æ±½è½¦æ•°å­—åº§èˆ±ç³»ç»Ÿå¼€å‘è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘çš„æ•´ä½“å°è±¡å…¶å®ç›¸å½“è´Ÿé¢ã€‚å®ƒæ„Ÿè§‰è¿˜ä¸å¤Ÿæˆç†Ÿâ€¦â€¦è¦æœ‰æ•ˆä½¿ç”¨å®ƒï¼Œä½ éœ€è¦æŒæ¡å¤§é‡æ™¦æ¶©çš„çŸ¥è¯†ï¼Œæ¯”å¦‚ Pinâ€”â€”è¯´å®è¯ï¼Œæˆ‘éƒ½è¯´ä¸æ¸… Pin åˆ°åº•æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚â€ â€”â€” å…·å¤‡ Rust ä¸“ä¸šèƒ½åŠ›çš„ç ”ç©¶å‹è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<p>è¦è®© Rust çœŸæ­£å®ç°â€œå¯é å·¥å…·ï¼ŒåŠ©åŠ›æ¢ç´¢æ–°é¢†åŸŸâ€çš„ä½“éªŒï¼Œç”¨æˆ·éœ€è¦èƒ½å°†åœ¨ Rust ä¸Šç§¯ç´¯çš„è®¤çŸ¥å’Œç»éªŒè¿ç§»åˆ°æ–°é¢†åŸŸã€‚ä½†åœ¨å¼‚æ­¥ç¼–ç¨‹æ–¹é¢ï¼Œä¸ä»…è¯­è¨€ç‰¹æ€§å­˜åœ¨ç¼ºå¤±ï¼ˆæ¯”å¦‚ï¼Œasync fn åœ¨ trait ä¸­çš„æ”¯æŒç›´åˆ°å»å¹´æ‰å®ç°ï¼Œä¸”ä»æœ‰ç©ºç™½ï¼‰ï¼Œç”¨æˆ·ä¾èµ–çš„è¾…åŠ©å·¥å…·é“¾å’Œç”Ÿæ€ç³»ç»Ÿåœ¨â€œå¼¥åˆå·®è·â€ä¸Šä¹Ÿä¸å°½å¦‚äººæ„ï¼š</p>
<blockquote>
<p>â€œæˆ‘å€¾å‘äºé¿å…ä½¿ç”¨ asyncï¼Œå› ä¸ºå®ƒçš„é”™è¯¯ä¿¡æ¯å¤ªéš¾å¤„ç†äº†ã€‚â€ â€”â€” æ¡Œé¢åº”ç”¨å¼€å‘è€…</p>
</blockquote>
<blockquote>
<p>â€œç°å®ä¸­è¿˜æœ‰å¾ˆå¤šæƒ…å†µï¼šä½ çœ‹åˆ°æŸä¸ªåº“çœ‹èµ·æ¥æœ‰ç”¨ï¼Œæƒ³ä½¿ç”¨å®ƒï¼Œç»“æœå®ƒç›´æ¥æŠŠä½ ç»‘å®šåˆ° tokio-rs æˆ–å…¶ä»–æŸä¸ªè¿è¡Œæ—¶ä¸Šã€‚è¿™è®©æˆ‘æœ‰ç‚¹å¤±æœ›ï¼Œå› ä¸ºæˆ‘æœ¬æ¥æƒ³å†™ä¸€ä¸ªé€šç”¨åº“ï¼Œç°åœ¨å´è¢«è¿«ä¾èµ–ç‰¹å®šè¿è¡Œæ—¶ã€‚â€ â€”â€” ä»äº‹ Linux åŠŸèƒ½å®‰å…¨å·¥ä½œçš„å®‰å…¨ç³»ç»Ÿå·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘ä»¬é€šå¸¸ç”¨ Rust å¼€å‘æœåŠ¡ï¼Œè€Œä¸”å¤§é‡ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹â€”â€”å› ä¸ºå¾ˆå¤šä¸æ•°æ®åº“å’Œå…¶ä»–ç»„ä»¶äº¤äº’çš„åº“éƒ½æ˜¯å¼‚æ­¥çš„ã€‚å½“é‡åˆ°é—®é¢˜æ—¶ï¼Œæ¯”å¦‚å‡ºç°æ— æ³•è§£é‡Šçš„é«˜ CPU å ç”¨ï¼Œå”¯ä¸€ç›´æ¥çš„æ’æŸ¥æ–¹å¼å°±æ˜¯ï¼šå¥½å§ï¼Œæˆ‘å¾—æŒ‚è½½ GDBï¼Œçœ‹çœ‹æ‰€æœ‰çº¿ç¨‹åœ¨åšä»€ä¹ˆã€‚GDB æœ¬èº«â€”â€”æˆ‘æ„æ€æ˜¯ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯ Rust çš„é—®é¢˜â€”â€”ä½† GDB æœ¬èº«å°±ä¸å¥½ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹åº”ç”¨ä¸­ã€‚â€¦â€¦è€Œåœ¨å¼‚æ­¥åœºæ™¯ä¸‹ï¼Œæƒ…å†µæ›´ç³Ÿï¼Œå› ä¸ºä½ çœ‹ä¸åˆ°ä»£ç åœ¨è¿è¡Œï¼Œå®ƒå®é™…ä¸Šåªæ˜¯é™æ­¢åœ°èººåœ¨å †ä¸Šã€‚ä¸€å¼€å§‹ï¼Œæˆ‘ç”šè‡³æ²¡æ„è¯†åˆ°é—®é¢˜å‡ºåœ¨è¿™é‡Œã€‚â€ â€”â€” æŸåŒæ—¶ä½¿ç”¨ Rust å’Œ Python å…¬å¸çš„èµ„æ·± Rust å¼€å‘è€…</p>
</blockquote>
<p>å¼‚æ­¥ç¼–ç¨‹çš„é‡è¦æ€§å€¼å¾—æ·±å…¥æ¢è®¨ã€‚æˆ‘ä»¬çš„ç ”ç©¶å‘ç°äº†è®¸å¤šå¼€å‘è€…çš„æŒ«è´¥æ„Ÿï¼Œä½†å°šæœªè·å¾—è¶³å¤Ÿå…·ä½“çš„æ´å¯Ÿã€‚è¿™å°†æ˜¯æœªæ¥ç”¨æˆ·ç ”ç©¶å›¢é˜Ÿå¯ä»¥æ¨è¿›çš„é‡ç‚¹ä»»åŠ¡ã€‚</p>
<h3 data-id="heading-7">crates.io ä¸°å¯Œçš„ crates æ˜¯æ ¸å¿ƒåŠ©åŠ›ï¼Œä½†ä¹Ÿå¯èƒ½æˆä¸ºéšœç¢</h3>
<p>æˆ‘ä»¬ä¹‹å‰æåˆ°ï¼ŒRust çš„å¯æ‰©å±•æ€§æ˜¯å…¶å®ç°å¤šç”¨é€”çš„é‡è¦åŸºç¡€ã€‚é‡è½½æ“ä½œç¬¦ã€traitã€å®ç­‰æœºåˆ¶ï¼Œè®©åº“èƒ½ä¸ºå¼€å‘è€…æä¾›ä¸°å¯Œä½“éªŒï¼›æç®€æ ‡å‡†åº“ç»“åˆä¾¿æ·çš„åŒ…ç®¡ç†ï¼Œä¹Ÿå‚¬ç”Ÿäº†å¤§é‡ crateï¼Œè¦†ç›–ä»é€šç”¨éœ€æ±‚åˆ°å°ä¼—åœºæ™¯çš„å¹¿æ³›é¢†åŸŸã€‚ä½†å°¤å…¶æ˜¯å¯¹åˆå­¦è€…è€Œè¨€ï¼Œè¿™ç§â€œå¯æ‰©å±•æ€§â€å¯èƒ½ä¼šä»¥â€œæ”¯æŒæ€§â€ä¸ºä»£ä»·â€”â€”å½“â€œé€‰æ‹©çš„æš´æ”¿â€è®©äººä¸å ªé‡è´Ÿæ—¶ï¼š</p>
<blockquote>
<p>â€œåˆé€‚çš„ crate å¾ˆéš¾è¢«å‘ç°ã€‚å­˜åœ¨ä¸€å±‚éšæ€§çŸ¥è¯†ï¼šå‘Šè¯‰ä½ ç‰¹å®šåœºæ™¯è¯¥ç”¨å“ªäº› crateï¼Œè€Œè¿™äº›çŸ¥è¯†é€šå¸¸åªèƒ½é€šè¿‡ç»éªŒæˆ–è¯•é”™ç§¯ç´¯ã€‚æ¯ä¸ªäººéƒ½åœ¨è‡ªå·±åšè°ƒç ”ã€‚â€ â€”â€” å¼€å‘è€…æ¡†æ¶é¢†åŸŸ Web å¼€å‘äººå‘˜ã€ä¼šè®®æ¼”è®²è€…</p>
</blockquote>
<blockquote>
<p>â€œcrates.io æä¾›äº†ä¸€äº›å†³ç­–æ‰€éœ€çš„ä¿¡æ¯ï¼Œä½†å®ƒå¹¶ä¸æ˜¯â€˜ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆâ€™ï¼Œå¯¹å§ï¼Ÿä½ ä¸èƒ½ç›´æ¥å» crates.io é—®â€˜æˆ‘æƒ³å®ç° X åŠŸèƒ½ï¼Œè¯¥ç”¨å“ªä¸ªåº“ï¼Ÿâ€™ç„¶åå¾—åˆ°ç­”æ¡ˆã€‚â€ â€”â€” ç ”ç©¶å‹è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<p>Rust å®˜æ–¹ç»„ç»‡å†æ¥ä¸æ„¿â€œå®˜æ–¹æ¨èâ€ç”Ÿæ€ä¸­çš„ç‰¹å®š crateã€‚ä½†ç°å®æ˜¯ï¼Œæœ‰äº› crate å·²ç»æ— å¤„ä¸åœ¨ã€‚è¿™å¯¹æ–°ç”¨æˆ·æ¥è¯´å°¤å…¶æœ‰æŒ‘æˆ˜æ€§ï¼š</p>
<blockquote>
<p>â€œæ•™ç¨‹é‡Œç”¨çš„æ˜¯ Result&lt;Box&gt;ï¼Œä½†å…¶ä»–äººæ ¹æœ¬ä¸è¿™ä¹ˆç”¨ã€‚å¤§å®¶éƒ½ç”¨ anyhow-resultâ€¦â€¦æˆ‘ä¸€å¼€å§‹ä¹Ÿè·Ÿç€æ•™ç¨‹ç”¨ Resultï¼Œç»“æœæ‰¾åˆ°çš„æ‰€æœ‰èµ„æ–™ç¤ºä¾‹éƒ½æ˜¯ anyhowã€‚è¿™ç§ä¸åŒ¹é…è®©æˆ‘å¾ˆå›°æƒ‘ï¼Œä¸çŸ¥é“è¯¥æ€ä¹ˆåšã€‚â€ â€”â€” æ•°æ®ç§‘å­¦å¹³å°å¼€å‘è½¯ä»¶å·¥ç¨‹å¸ˆ</p>
</blockquote>
<blockquote>
<p>â€œç›®å‰æ²¡æœ‰æ˜ç¡®çš„å…±è¯†æŒ‡å¯¼è¯¥ä½¿ç”¨å“ªäº›ç¬¬ä¸‰æ–¹ crateã€‚â€¦â€¦æœ‰æ—¶å€™çœŸçš„å¾ˆéš¾åˆ¤æ–­â€”â€”æ¯”å¦‚ï¼Œåˆ°åº•è¯¥ç”¨å“ªä¸ª CBOR crateï¼Ÿâ€¦â€¦å¾ˆéš¾çœ‹å‡ºå“ªäº› crate è¿˜åœ¨ç§¯æç»´æŠ¤ã€‚â€¦â€¦crates.io ä¸Š crate å¤ªå¤šè¿™ä¸ªäº‹å®ï¼Œæœ¬èº«å°±å¸¦æ¥äº†ä¸€å®šé£é™©ã€‚â€ â€”â€” æŸå¤§å‹ç§‘æŠ€å…¬å¸ Rust å›¢é˜Ÿæˆå‘˜</p>
</blockquote>
<h2 data-id="heading-8">å»ºè®®</h2>
<h3 data-id="heading-9">æ˜ç¡® Rust çš„è®¾è®¡ç›®æ ‡ï¼Œå¹¶èå…¥æµç¨‹</h3>
<p>æˆ‘ä»¬å»ºè®®åˆ¶å®šä¸€ä»½ RFCï¼Œæ˜ç¡® Rust å¼€å‘è¿‡ç¨‹ä¸­è¿½æ±‚çš„æ ¸å¿ƒç›®æ ‡ã€‚è¿™ä»½ RFC åº”è¦†ç›– Rust çš„æ•´ä½“ä½¿ç”¨ä½“éªŒï¼ˆåŒ…æ‹¬è¯­è¨€ã€å·¥å…·å’Œåº“ï¼‰ã€‚å¯ç”±æè®®ä¸­çš„ç”¨æˆ·ç ”ç©¶å›¢é˜Ÿæ’°å†™ï¼Œä¸è¿‡ç›®å‰å°šä¸æ¸…æ¥šå®¡æ‰¹ä¸»ä½“â€”â€”å¯èƒ½æ˜¯ç”¨æˆ·ç ”ç©¶å›¢é˜Ÿæœ¬èº«ï¼Œä¹Ÿå¯èƒ½æ˜¯é¢†å¯¼å§”å‘˜ä¼šã€‚</p>
<p>æœ¬æ–‡æŒ‡å‡ºï¼ŒRust çœŸæ­£çš„â€œèµ‹èƒ½é­”åŠ›â€æºäºå¤šä¸ªç‰¹æ€§çš„ååŒä½œç”¨ï¼šå¯é æ€§ã€æ•ˆç‡ã€åº•å±‚æ§åˆ¶èƒ½åŠ›ã€æ”¯æŒæ€§ç­‰ã€‚æ‹¥æœ‰ä¸€ä»½ç¤¾åŒºå…¬è®¤çš„æƒå¨ä»·å€¼æ¸…å•ï¼Œå°†æœ‰åŠ©äºå¤§å®¶å…±åŒå‚è€ƒï¼Œå¹¶åœ¨è¯„ä¼° RFC æˆ–å…¶ä»–è®¾è®¡æ–¹æ¡ˆæ—¶ä½œä¸ºä¾æ®ã€‚</p>
<p>æ­¤å‰å·²æœ‰ç›¸å…³å°è¯•å¯å€Ÿé‰´ã€‚æˆ‘ä»¬çš„ç ”ç©¶å‘ç°ä¸€ä¸ªå…³é”®ç»“è®ºï¼šæ— éœ€å®šä¹‰å“ªäº›ä»·å€¼è§‚â€œæœ€é‡è¦â€ã€‚è¦è®© Rust çœŸæ­£å‘æŒ¥ä»·å€¼ï¼Œå¿…é¡» <strong>åŒæ—¶æ»¡è¶³æ‰€æœ‰è¿™äº›å› ç´ </strong>ã€‚ä¸å…¶å¯¹è¿™äº›ç›®æ ‡æ’åºï¼Œä¸å¦‚æè¿°ä¸‰ç§çŠ¶æ€ä¸‹çš„ä½“éªŒï¼š</p>
<ul>
<li>æœªè¾¾æ ‡ï¼ˆä¸è¶³ï¼‰</li>
<li>æ°åˆ°å¥½å¤„ï¼ˆæœ€ä½³çŠ¶æ€ï¼‰</li>
<li>è¿‡åº¦è¿½æ±‚ï¼ˆè¿‡å‰©ï¼‰</li>
</ul>
<p>è¿™ç§â€œ Goldilocks åŸåˆ™â€ï¼ˆé‡‘å‘å§‘å¨˜åŸåˆ™ï¼‰æ¡†æ¶ï¼Œèƒ½å¸®åŠ©äººä»¬åˆ¤æ–­å½“å‰æ‰€å¤„çŠ¶æ€ï¼ŒåŠæ—¶è°ƒæ•´æ–¹å‘ï¼Œè€Œéäººä¸ºåˆ¶é€ é”™è¯¯çš„ä¼˜å…ˆçº§å±‚çº§ã€‚</p>
<h3 data-id="heading-10">è¿›ä¸€æ­¥å¼ºåŒ–å¯æ‰©å±•æ€§</h3>
<p>æˆ‘ä»¬å»ºè®®å°†â€œå¢å¼ºå¯æ‰©å±•æ€§â€ä½œä¸ºæ ¸å¿ƒæˆ˜ç•¥ã€‚Rust çš„å¯æ‰©å±•æ€§â€”â€”åŒ…æ‹¬ traitã€å®ã€æ“ä½œç¬¦é‡è½½ç­‰æœºåˆ¶â€”â€”æ˜¯å…¶é«˜çµæ´»æ€§çš„æ ¸å¿ƒã€‚ä½†å½“å‰çš„å¯æ‰©å±•æ€§ä¸»è¦é›†ä¸­åœ¨ç‰¹å®šé¢†åŸŸï¼šç±»å‹ç³»ç»Ÿå’Œæ—©æœŸé˜¶æ®µçš„ proc å®ã€‚æˆ‘ä»¬åº”å°†å…¶æ‹“å±•è‡³ <strong>æ”¯æŒæ€§æ¥å£</strong>ï¼ˆæ¯”å¦‚ï¼Œcrate æä¾›æ›´ä¼˜çš„è¯Šæ–­ä¿¡æ¯å’Œä½¿ç”¨æŒ‡å¯¼ï¼‰å’Œ <strong>ç¼–è¯‘æµç¨‹</strong>ï¼ˆå…è®¸ crate åœ¨æ„å»ºè¿‡ç¨‹çš„æ›´å¤šé˜¶æ®µé›†æˆï¼‰ã€‚</p>
<p>Rust çš„å¯æ‰©å±•æ€§æ˜¯å…¶å®ç°å¤šç”¨é€”çš„é‡è¦åŸºç¡€ï¼Œè¿™ç§çµæ´»æ€§ä¹Ÿæ˜¯äººä»¬å–œçˆ± Rust çš„åŸå› ä¹‹ä¸€ã€‚å€ŸåŠ© proc å®ã€trait ç³»ç»Ÿå’Œå€Ÿç”¨æ£€æŸ¥å™¨ç­‰æœºåˆ¶ï¼ŒRust çš„ crate èƒ½æä¾›é«˜å±‚çº§ã€ä¼˜é›…çš„æ¥å£ï¼Œæœ€ç»ˆç¼–è¯‘ä¸ºé«˜æ•ˆçš„æœºå™¨ä»£ç ã€‚æœ€ä½³çŠ¶æ€ä¸‹ï¼Œè¿™ç§ä½“éªŒç”šè‡³æœ‰ç‚¹åƒâ€œé­”æ³•â€ã€‚</p>
<p>é—æ†¾çš„æ˜¯ï¼Œå°½ç®¡ Rust ä¸º crate æä¾›äº†æ„å»ºå®‰å…¨é«˜æ•ˆæŠ½è±¡çš„ä¼˜è´¨å·¥å…·ï¼Œä½†å°šæœªæä¾›æ„å»ºçœŸæ­£â€œæœ‰å¸®åŠ©æ€§â€æ¥å£çš„å·¥å…·ã€‚åœ¨ Rust å†…ç½®è¯­è¨€æ¦‚å¿µä¸­ï¼Œæˆ‘ä»¬å·²åŠªåŠ›æ‰“é€ æœ‰æ•ˆçš„é”™è¯¯ä¿¡æ¯å¼•å¯¼ç”¨æˆ·æˆåŠŸï¼›è¿˜éšç¼–è¯‘å™¨æä¾›äº† lintsï¼Œç”¨äºæ•è·å¸¸è§é”™è¯¯æˆ–å¼ºåˆ¶é‡è¦çº¦å®šã€‚ä½†è¿™äº›ä¼˜åŠ¿å¹¶æœªè¦†ç›–åˆ° crateã€‚è¯¸å¦‚ RFC #3368 è¿™æ ·çš„ææ¡ˆï¼ˆå¼•å…¥è¯Šæ–­å‘½åç©ºé—´å’Œ #[diagnostic::on_unimplemented] ç­‰ç‰¹æ€§ï¼‰ï¼Œè¡¨æ˜ Rust å·²å¼€å§‹å‘è¿™ä¸ªæ–¹å‘æ¢ç´¢ã€‚æˆ‘ä»¬åº”ç»§ç»­æ¨è¿›ï¼Œå¹¶å¯»æ‰¾æ›´å¤šæ·±å…¥å‘å±•çš„æœºä¼šï¼Œå°¤å…¶æ˜¯åœ¨ç»å¸¸åˆ›å»º DSL ç±»æ¥å£çš„ proc-macros é¢†åŸŸã€‚</p>
<p>å¯æ‰©å±•æ€§çš„å¦ä¸€ä¸ªä¸»è¦æŒ‘æˆ˜åœ¨äºæ„å»ºç³»ç»Ÿå’Œåç«¯ã€‚ç›®å‰ Rust çš„å¯æ‰©å±•æœºåˆ¶ï¼ˆå¦‚ <code>build.rs</code>ã€<code>proc-macros</code>ï¼‰ä¸»è¦é›†ä¸­åœ¨ç¼–è¯‘è¿‡ç¨‹çš„æ—©æœŸé˜¶æ®µã€‚ä½†è®¸å¤šå¯¹ Rust çš„æ‰©å±•â€”â€”ä»äº’æ“ä½œæ€§åˆ°å®šç†è¯æ˜ï¼Œå†åˆ° GPU ç¼–ç¨‹å’Œåˆ†å¸ƒå¼ç³»ç»Ÿâ€”â€”è‹¥èƒ½èå…¥ç¼–è¯‘æµç¨‹çš„å…¶ä»–é˜¶æ®µï¼Œå°†æ”¶è·å·¨å¤§ä»·å€¼ã€‚Stable MIR é¡¹ç›®å’Œ build-std é¡¹ç›®ï¼Œæ­£æ˜¯è¿™ç±»å·¥ä½œçš„å…¸å‹ä»£è¡¨ã€‚</p>
<p>è¿›ä¸€æ­¥å¼ºåŒ–å¯æ‰©å±•æ€§ï¼Œä¸ä»…èƒ½è®©å½“å‰çš„ Rust æ›´æ˜“ç”¨ï¼Œè¿˜èƒ½æ¨åŠ¨å¹¶æ”¯æŒ Rust åœ¨æ–°é¢†åŸŸçš„åº”ç”¨ã€‚å°¤å…¶æ˜¯å®‰å…¨å…³é”®å‹åº”ç”¨ï¼Œå¾€å¾€éœ€è¦å¤§é‡å®šåˆ¶åŒ–çš„ lints å’Œå·¥å…·æ¥æ»¡è¶³ç›¸å…³æ ‡å‡†ã€‚ç¼–è¯‘å™¨çš„å¯æ‰©å±•æ€§ï¼Œèƒ½è®© Rust ä»¥æ›´é€šç”¨çš„æ–¹å¼æ”¯æŒè¿™äº›ç‰¹å®šéœ€æ±‚ã€‚</p>
<h3 data-id="heading-11">å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå®šä½ Rust ç”Ÿæ€ç³»ç»Ÿ</h3>
<p>æˆ‘ä»¬å»ºè®®æ¢ç´¢æœ‰æ•ˆæ–¹å¼ï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°å¯¼èˆª crates.io ç”Ÿæ€ç³»ç»Ÿã€‚å¦‚ä»Šï¼ŒRust çš„å¸¸è§„å¼€å‘å®è·µé«˜åº¦ä¾èµ–å„ç±»ç¬¬ä¸‰æ–¹ crateï¼Œä»é”™è¯¯å¤„ç†åˆ°å¼‚æ­¥è¿è¡Œæ—¶æ— ä¸€ä¾‹å¤–ã€‚å€ŸåŠ©ç”Ÿæ€ç³»ç»Ÿï¼ŒRust æ‰èƒ½æ‹“å±•è‡³æ›´å¤šé¢†åŸŸï¼Œå‚¬ç”Ÿåˆ›æ–°è§£å†³æ–¹æ¡ˆã€‚ä½†å¯¹åˆå­¦è€…è€Œè¨€ï¼Œå¦‚ä½•é€‰æ‹©åˆé€‚çš„ crate æ˜¯çœŸå®å­˜åœ¨çš„éšœç¢ã€‚Rust å®˜æ–¹ç»„ç»‡ä¿æŒè°¨æ…ä¸­ç«‹çš„ç«‹åœºå€¼å¾—è‚¯å®šï¼Œä½†è¿™ä¹Ÿå¯¼è‡´ç”¨æˆ·æ— æ³•è·å¾—â€œå…¥é—¨æ¨è crateâ€çš„æ˜ç¡®æŒ‡å¯¼ã€‚</p>
<p>ç›®å‰å°šæ— æ˜¾è€Œæ˜“è§çš„è§£å†³æ–¹æ¡ˆã€‚æ‰©å¤§æ ‡å‡†åº“å¯èƒ½é™åˆ¶è¿›ä¸€æ­¥å®éªŒï¼›ä¸ºç‰¹å®š crateâ€œèƒŒä¹¦â€åˆ™å¯èƒ½å¼•å‘äº‰è®®ã€‚ä½†æœ€ä¼˜è§£éš¾ä»¥ç¡®å®šï¼Œä¸ä»£è¡¨æˆ‘ä»¬å¯ä»¥å¿½è§†è¿™ä¸ªé—®é¢˜ã€‚Rust å†æ¥æ“…é•¿åœ¨ä¼ ç»Ÿæƒè¡¡ä¸­æ¢ç´¢åˆ›æ–°è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬ä¹Ÿåº”å°†è¿™ç§åˆ›é€ åŠ›æŠ•å…¥åˆ°è¿™ä¸ªé—®é¢˜çš„è§£å†³ä¸­ã€‚</p>
<p>éƒ¨åˆ†è§£å†³æ–¹æ¡ˆåœ¨äºæå‡åº“ä¹‹é—´çš„äº’æ“ä½œæ€§ã€‚æ¯”å¦‚ï¼Œå¼•å…¥å…³é”®çš„äº’æ“ä½œ traitï¼ˆå°¤å…¶æ˜¯åœ¨å¼‚æ­¥åœºæ™¯ï¼‰ï¼Œæˆ–å¯¹ä¸€äº›åŸºç¡€æ„å»ºæ¨¡å—è¿›è¡Œâ€œå®˜æ–¹è®¤å¯â€ï¼ˆæ¯”å¦‚ http crateï¼Œå®ƒä¸º HTTP åº“æä¾›äº†ç±»å‹å®šä¹‰ï¼‰ã€‚åŒæ—¶ï¼Œè°ƒæ•´ä¸€è‡´æ€§è§„åˆ™ï¼ˆcoherence rulesï¼‰ä¹Ÿå¯èƒ½æœ‰å¸®åŠ©â€”â€”å½“å‰è§„åˆ™ä¸å…è®¸æ–°çš„äº’æ“ä½œ trait åœ¨ç”Ÿæ€ç³»ç»Ÿä¸­é€æ­¥å¼•å…¥å’Œé‡‡ç”¨ã€‚</p>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>æœ¬æ–‡æ ¸å¿ƒè§‚ç‚¹æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>äººä»¬å–œçˆ± Rustï¼Œæºäºå®ƒèµ‹äºˆå¼€å‘è€…è§£å†³å¤æ‚é—®é¢˜ã€è¿›å…¥æ–°é¢†åŸŸçš„èƒ½åŠ›ã€‚è¿™ç§å¸å¼•åŠ›å¹¶éæ¥è‡ªå•ä¸€ç‰¹æ€§ï¼Œè€Œæ˜¯å¤šç§å› ç´ ç²¾å¿ƒå¹³è¡¡çš„ç»“æœï¼›è‹¥ä»»ä½•ä¸€é¡¹è¢«å‰Šå¼±ï¼Œè¯­è¨€çš„æ•´ä½“ä½“éªŒå°†å¤§å¹…å—æŸã€‚</p>
</li>
<li>
<p>æˆ‘ä»¬æå‡ºä¸‰æ¡å»ºè®®ï¼ŒåŠ©åŠ› Rust åœ¨æ›´å¤šé¢†åŸŸå’Œåœºæ™¯ä¸­æŒç»­æ‹“å±•ï¼š</p>
<ul>
<li>æ˜ç¡®å¹¶æè¿° Rust çš„è®¾è®¡ç›®æ ‡ï¼Œå°†å…¶èå…¥å¼€å‘æµç¨‹ï¼Œç¡®ä¿æœªæ¥çš„è¯­è¨€è®¾è®¡è€…å’Œæ•´ä¸ªç”Ÿæ€ç³»ç»Ÿéƒ½èƒ½éµå¾ªè¿™äº›åŸåˆ™ã€‚</li>
<li>è¿›ä¸€æ­¥å¼ºåŒ–å¯æ‰©å±•æ€§ï¼Œèµ‹äºˆ crate å½±å“å¼€å‘ä½“éªŒå’Œç¼–è¯‘æµç¨‹çš„æ›´å¼ºèƒ½åŠ›ã€‚</li>
<li>å¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°å¯¼èˆª crates.io ç”Ÿæ€ç³»ç»Ÿï¼Œå®ç°æ›´é¡ºç•…çš„åº“é—´äº’æ“ä½œã€‚</li>
</ul>
</li>
</ul>
<ol>
<li>
<p>2025 å¹´ï¼Œ72% çš„ Rust ç”¨æˆ·è¡¨ç¤ºå¸Œæœ›ç»§ç»­ä½¿ç”¨è¯¥è¯­è¨€ã€‚è¿‡å»ï¼ŒRust çš„å¾—åˆ†ä¸€ç›´è¿œè¶…å…¶ä»–è¯­è¨€ï¼Œè€Œä»Šå¹´æ›´æ˜¯çªç ´äº† 70%ï¼æ­å–œä»–ä»¬ï¼</p>
</li>
<li>
<p>å˜¿ï¼Œ<code>fn</code> å…³é”®å­—çš„é€‰æ‹©çœŸä¸é”™ã€‚ğŸ˜‰</p>
</li>
<li>
<p>è€Œä¸”â€¦â€¦å‘ƒï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ç¡®ä¿è‡ªå·±ä¸ä¼šæç ¸å‘¢ï¼Ÿâ†©ï¸</p>
</li>
<li>
<p>â€¦â€¦å¯¹äºé‚£äº›ç¡çœ ä¸è¶³ã€è¡Œä¸ºä¸Šå¸¸å¸¸åƒæ–°æ‰‹ä¸€æ ·â€œçŠ¯å‚»â€çš„èµ„æ·±å¼€å‘è€…æ¥è¯´ã€‚â†©ï¸</p>
</li>
</ol>
<blockquote>
<p>åŸæ–‡<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.rust-lang.org%2F2025%2F12%2F19%2Fwhat-do-people-love-about-rust%2F" target="_blank" title="https://blog.rust-lang.org/2025/12/19/what-do-people-love-about-rust/" ref="nofollow noopener noreferrer">blog.rust-lang.org/2025/12/19/â€¦</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬å››ç«  ç»„ä»¶é€šè®¯ä¸å…¨å±€çŠ¶æ€ç®¡ç†]]></title>    <link>https://juejin.cn/post/7592865044691648518</link>    <guid>https://juejin.cn/post/7592865044691648518</guid>    <pubDate>2026-01-09T00:55:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592865044691648518" data-draft-id="7590593682584207423" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬å››ç«  ç»„ä»¶é€šè®¯ä¸å…¨å±€çŠ¶æ€ç®¡ç†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,React.js"/> <meta itemprop="datePublished" content="2026-01-09T00:55:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ€•æµªçŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/2832784963939438"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬å››ç«  ç»„ä»¶é€šè®¯ä¸å…¨å±€çŠ¶æ€ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2832784963939438/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ€•æµªçŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T00:55:03.000Z" title="Fri Jan 09 2026 00:55:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/576da2d8d2ef44c292b6732ab9ef2959~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oCV5rWq54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768524903&amp;x-signature=4VKKaQ3Q7cLgetp8TO53soyRin8%3D" alt="G9oezq6XEAECJ26.jpeg" loading="lazy"/>
å¤§å®¶å¥½ï½ å‰é¢æˆ‘ä»¬å·²ç»æŒæ¡äº† React 19 çš„å‡½æ•°ç»„ä»¶ã€Hooksã€è™šæ‹Ÿ DOM ç­‰æ ¸å¿ƒåŸºç¡€ï¼Œä»Šå¤©å’±ä»¬èšç„¦ React åº”ç”¨å¼€å‘ä¸­çš„æ ¸å¿ƒé—®é¢˜â€”â€”<strong>ç»„ä»¶é—´çš„é€šä¿¡</strong>ã€‚</p>
<p>åœ¨ React åº”ç”¨ä¸­ï¼Œç»„ä»¶ä¸æ˜¯å­¤ç«‹çš„ï¼Œå®ƒä»¬éœ€è¦é€šè¿‡â€œä¼ é€’æ•°æ®â€ååŒå·¥ä½œï¼šå°åˆ°çˆ¶å­ç»„ä»¶é—´çš„ç®€å•æ•°æ®ä¼ é€’ï¼Œå¤§åˆ°è·¨å±‚çº§ã€å¤šç»„ä»¶å…±äº«çš„å…¨å±€çŠ¶æ€ç®¡ç†ï¼Œéƒ½æ˜¯æ—¥å¸¸å¼€å‘ä¸­é«˜é¢‘é‡åˆ°çš„åœºæ™¯ã€‚</p>
<p>å¾ˆå¤šæ–°æ‰‹ä¼šåœ¨â€œè¯¥ç”¨å“ªç§ä¼ å‚æ–¹å¼â€â€œä»€ä¹ˆæ—¶å€™éœ€è¦å…¨å±€çŠ¶æ€â€è¿™äº›é—®é¢˜ä¸Šå›°æƒ‘ã€‚ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±ä»â€œç»„ä»¶å…³ç³»â€å‡ºå‘ï¼ŒæŒ‰â€œç®€å•åˆ°å¤æ‚â€çš„é¡ºåºï¼Œæ‹†è§£ React 19 ä¸­çš„ç»„ä»¶ä¼ å‚æ–¹æ¡ˆï¼Œå†æ·±å…¥è®²è§£å…¨å±€çŠ¶æ€ç®¡ç†çš„æ ¸å¿ƒæ€è·¯ä¸å¸¸ç”¨æ–¹æ¡ˆï¼Œç»“åˆä»£ç ç¤ºä¾‹å’Œå›¾ä¾‹ï¼Œè®©å¤§å®¶èƒ½æ ¹æ®å®é™…åœºæ™¯çµæ´»é€‰æ‹©ï½</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆæ˜ç¡®ï¼šç»„ä»¶å…³ç³»å†³å®šä¼ å‚æ–¹æ¡ˆ</h2>
<p>åœ¨ React åº”ç”¨ä¸­ï¼Œç»„ä»¶é—´çš„å…³ç³»ä¸»è¦åˆ†ä¸º 3 ç±»ï¼š<strong>çˆ¶å­ç»„ä»¶ã€å…„å¼Ÿç»„ä»¶ã€è·¨å±‚çº§ç»„ä»¶ï¼ˆç¥–å­™/è¿œäº²ï¼‰</strong> ã€‚ä¸åŒå…³ç³»å¯¹åº”çš„ä¼ å‚éš¾åº¦å’Œæ–¹æ¡ˆä¸åŒï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªå›¾ä¾‹ç†æ¸…ç»„ä»¶å…³ç³»æ¨¡å‹ï¼š</p>
<p>æ ¸å¿ƒåŸåˆ™ï¼š<strong>èƒ½å±€éƒ¨ä¼ å‚å°±ä¸å…¨å±€</strong>â€”â€”å±€éƒ¨ä¼ å‚ï¼ˆå¦‚çˆ¶å­ã€å…„å¼Ÿï¼‰ç®€å•ç›´è§‚ã€æ€§èƒ½å¼€é”€å°ï¼Œå…¨å±€çŠ¶æ€ï¼ˆå¦‚ Reduxã€Contextï¼‰é€‚åˆå…±äº«æ•°æ®å¤šã€è·¨å±‚çº§å¹¿çš„åœºæ™¯ï¼Œé¿å…è¿‡åº¦è®¾è®¡ã€‚</p>
<h2 data-id="heading-1">äºŒã€React 19 ç»„ä»¶ä¼ å‚æ–¹æ¡ˆå…¨è§£æï¼ˆæŒ‰åœºæ™¯åˆ†ç±»ï¼‰</h2>
<h3 data-id="heading-2">1. çˆ¶å­ç»„ä»¶ä¼ å‚ï¼šæœ€åŸºç¡€çš„â€œprops å‘ä¸‹+å›è°ƒå‘ä¸Šâ€</h3>
<p>çˆ¶å­ç»„ä»¶æ˜¯æœ€å¸¸è§çš„å…³ç³»ï¼Œä¼ å‚æ ¸å¿ƒä¾èµ– <strong>props</strong>ï¼šçˆ¶ç»„ä»¶é€šè¿‡ props å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼ˆå‘ä¸‹ä¼ ï¼‰ï¼Œå­ç»„ä»¶é€šè¿‡ props æ¥æ”¶çˆ¶ç»„ä»¶çš„å›è°ƒå‡½æ•°ï¼Œå°†æ•°æ®ä¼ é€’å›çˆ¶ç»„ä»¶ï¼ˆå‘ä¸Šä¼ ï¼‰ï¼Œå½¢æˆâ€œåŒå‘é€šä¿¡â€ã€‚</p>
<h4 data-id="heading-3">åœºæ™¯ 1ï¼šçˆ¶ä¼ å­ï¼ˆæ•°æ®å‘ä¸‹ä¼ é€’ï¼‰</h4>
<p>æ ¸å¿ƒé€»è¾‘ï¼šçˆ¶ç»„ä»¶åœ¨ä½¿ç”¨å­ç»„ä»¶æ—¶ï¼Œé€šè¿‡â€œå±æ€§=å€¼â€çš„å½¢å¼ä¼ é€’æ•°æ®ï¼Œå­ç»„ä»¶é€šè¿‡å‚æ•° props æ¥æ”¶ï¼ˆå¯è§£æ„ç®€åŒ–ï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çˆ¶ç»„ä»¶ï¼šä¼ é€’æ•°æ®ç»™å­ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> parentData = <span class="hljs-string">"æˆ‘æ˜¯çˆ¶ç»„ä»¶çš„æ•°æ®"</span>;
  <span class="hljs-keyword">const</span> userInfo = { <span class="hljs-attr">name</span>: <span class="hljs-string">"å°æ˜"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">22</span> };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>çˆ¶ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {/* é€šè¿‡ props ä¼ é€’åŸºç¡€ç±»å‹ã€å¯¹è±¡ç­‰æ•°æ® */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> 
        <span class="hljs-attr">msg</span>=<span class="hljs-string">{parentData}</span> 
        <span class="hljs-attr">user</span>=<span class="hljs-string">{userInfo}</span>
        <span class="hljs-attr">isShow</span>=<span class="hljs-string">{true}</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å­ç»„ä»¶ï¼šæ¥æ”¶å¹¶ä½¿ç”¨çˆ¶ç»„ä»¶ä¼ é€’çš„æ•°æ®</span>
<span class="hljs-comment">// æ–¹å¼ 1ï¼šç›´æ¥é€šè¿‡ props å‚æ•°æ¥æ”¶</span>
<span class="hljs-comment">// function Child(props) {</span>
<span class="hljs-comment">//   return &lt;p&gt;çˆ¶ç»„ä»¶ä¼ é€’çš„æ¶ˆæ¯ï¼š{props.msg}&lt;/p&gt;;</span>
<span class="hljs-comment">// }</span>

<span class="hljs-comment">// æ–¹å¼ 2ï¼šè§£æ„ propsï¼Œæ›´ç®€æ´ï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">{ msg, user, isShow }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å­ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      {isShow &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>çˆ¶ç»„ä»¶ä¼ é€’çš„æ¶ˆæ¯ï¼š{msg}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç”¨æˆ·å§“åï¼š{user.name}ï¼Œå¹´é¾„ï¼š{user.age}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ³¨æ„ï¼šprops æ˜¯åªè¯»çš„ï¼å­ç»„ä»¶ä¸èƒ½ç›´æ¥ä¿®æ”¹ props çš„å€¼ï¼ˆå¦‚ä¸èƒ½å†™ user.age = 23ï¼‰ï¼Œè‹¥éœ€ä¿®æ”¹ï¼Œéœ€é€šè¿‡â€œå­ä¼ çˆ¶â€çš„æ–¹å¼è®©çˆ¶ç»„ä»¶æ›´æ–°æ•°æ®ã€‚</p>
<h4 data-id="heading-4">åœºæ™¯ 2ï¼šå­ä¼ çˆ¶ï¼ˆæ•°æ®å‘ä¸Šä¼ é€’ï¼‰</h4>
<p>æ ¸å¿ƒé€»è¾‘ï¼šçˆ¶ç»„ä»¶ä¼ é€’ä¸€ä¸ªâ€œå›è°ƒå‡½æ•°â€ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶è§¦å‘è¯¥å‡½æ•°æ—¶ï¼Œå°†éœ€è¦ä¼ é€’çš„æ•°æ®ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œçˆ¶ç»„ä»¶åœ¨å›è°ƒå‡½æ•°ä¸­æ¥æ”¶å¹¶å¤„ç†æ•°æ®ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çˆ¶ç»„ä»¶ï¼šä¼ é€’å›è°ƒå‡½æ•°ç»™å­ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [childData, setChildData] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// å›è°ƒå‡½æ•°ï¼šæ¥æ”¶å­ç»„ä»¶ä¼ é€’çš„æ•°æ®</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChildMsg</span> = (<span class="hljs-params">data</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å­ç»„ä»¶ä¼ é€’çš„æ•°æ®ï¼š"</span>, data);
    <span class="hljs-title function_">setChildData</span>(data); <span class="hljs-comment">// æ›´æ–°çˆ¶ç»„ä»¶çŠ¶æ€</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>çˆ¶ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å­ç»„ä»¶ä¼ é€’çš„æ¶ˆæ¯ï¼š{childData}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      {/* ä¼ é€’å›è°ƒå‡½æ•° */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">onSendMsg</span>=<span class="hljs-string">{handleChildMsg}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å­ç»„ä»¶ï¼šè§¦å‘å›è°ƒå‡½æ•°ï¼Œä¼ é€’æ•°æ®ç»™çˆ¶ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">{ onSendMsg }</span>) {
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// è§¦å‘çˆ¶ç»„ä»¶ä¼ é€’çš„å›è°ƒå‡½æ•°ï¼Œä¼ å…¥æ•°æ®</span>
    <span class="hljs-title function_">onSendMsg</span>(inputValue);
    <span class="hljs-title function_">setInputValue</span>(<span class="hljs-string">""</span>); <span class="hljs-comment">// æ¸…ç©ºè¾“å…¥æ¡†</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å­ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setInputValue(e.target.value)}
        placeholder="è¾“å…¥è¦ä¼ é€’ç»™çˆ¶ç»„ä»¶çš„å†…å®¹"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSubmit}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginLeft:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>
        å‘é€ç»™çˆ¶ç»„ä»¶
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-5">åœºæ™¯ 3ï¼šçˆ¶å­åŒå‘ç»‘å®šï¼ˆè¡¨å•å¸¸è§ï¼‰</h4>
<p>æ ¸å¿ƒé€»è¾‘ï¼šç»“åˆâ€œçˆ¶ä¼ å­â€å’Œâ€œå­ä¼ çˆ¶â€ï¼Œçˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ï¼ˆè¡¨å•é»˜è®¤å€¼ï¼‰ï¼Œå­ç»„ä»¶é€šè¿‡å›è°ƒå‡½æ•°å°†ä¿®æ”¹åçš„å€¼ä¼ é€’å›çˆ¶ç»„ä»¶ï¼Œå®ç°â€œæ•°æ®åŒæ­¥â€ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// çˆ¶ç»„ä»¶ï¼šç®¡ç†è¡¨å•çŠ¶æ€
function Parent() {
  const <span class="hljs-section">[username, setUsername]</span> = useState("")<span class="hljs-comment">;</span>

  // æ¥æ”¶å­ç»„ä»¶ä¿®æ”¹åçš„å€¼ï¼Œæ›´æ–°çˆ¶ç»„ä»¶çŠ¶æ€
  const <span class="hljs-attr">handleUsernameChange</span> = (newValue) =&gt; {
    setUsername(newValue)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  return (
    &lt;div&gt;
      &lt;h3&gt;çˆ¶ç»„ä»¶ï¼š{username}&lt;/h3&gt;
      {/* ä¼ é€’çŠ¶æ€ï¼ˆé»˜è®¤å€¼ï¼‰å’Œå›è°ƒå‡½æ•° */}
      &lt;Input 
        <span class="hljs-attr">value</span>={username} 
        <span class="hljs-attr">onChange</span>={handleUsernameChange} 
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥ç”¨æˆ·å"</span>
      /&gt;
    &lt;/div&gt;
  )<span class="hljs-comment">;</span>
}

// å­ç»„ä»¶ï¼šè¡¨å•è¾“å…¥ç»„ä»¶
function Input({ value, onChange, placeholder }) {
  // è¾“å…¥å˜åŒ–æ—¶ï¼Œè§¦å‘å›è°ƒå‡½æ•°ä¼ é€’æ–°å€¼
  const <span class="hljs-attr">handleInput</span> = (e) =&gt; {
    onChange(e.target.value)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  return (
    &lt;input
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
      <span class="hljs-attr">value</span>={value}
      <span class="hljs-attr">onChange</span>={handleInput}
      <span class="hljs-attr">placeholder</span>={placeholder}
      <span class="hljs-attr">style</span>={{ width: <span class="hljs-string">"300px"</span>, height: <span class="hljs-string">"30px"</span>, padding: <span class="hljs-string">"0 8px"</span> }}
    /&gt;
  )<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-6">2. å…„å¼Ÿç»„ä»¶ä¼ å‚ï¼šé€šè¿‡çˆ¶ç»„ä»¶ä¸­è½¬</h3>
<p>å…„å¼Ÿç»„ä»¶é—´æ²¡æœ‰ç›´æ¥çš„é€šä¿¡é€šé“ï¼Œéœ€é€šè¿‡â€œå…±åŒçš„çˆ¶ç»„ä»¶â€ä½œä¸ºä¸­è½¬ï¼šå…ˆè®©â€œå‘é€æ•°æ®çš„å…„å¼Ÿâ€å°†æ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œå†ç”±çˆ¶ç»„ä»¶å°†æ•°æ®ä¼ é€’ç»™â€œæ¥æ”¶æ•°æ®çš„å…„å¼Ÿâ€ã€‚</p>
<p>ç”¨å›¾ä¾‹å±•ç¤ºé€šä¿¡æµç¨‹ï¼š</p>
<h4 data-id="heading-7">å®æˆ˜æ¡ˆä¾‹ï¼šå…„å¼Ÿç»„ä»¶æ•°æ®åŒæ­¥</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çˆ¶ç»„ä»¶ï¼šä½œä¸ºå…„å¼Ÿç»„ä»¶çš„ä¸­è½¬</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [sharedData, setSharedData] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// æ¥æ”¶ Child1 ä¼ é€’çš„æ•°æ®</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleDataFromChild1</span> = (<span class="hljs-params">data</span>) =&gt; {
    <span class="hljs-title function_">setSharedData</span>(data);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>çˆ¶ç»„ä»¶ï¼ˆä¸­è½¬ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {/* å…„å¼Ÿ 1ï¼šå‘é€æ•°æ® */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Child1</span> <span class="hljs-attr">onSendData</span>=<span class="hljs-string">{handleDataFromChild1}</span> /&gt;</span>
      {/* å…„å¼Ÿ 2ï¼šæ¥æ”¶æ•°æ® */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Child2</span> <span class="hljs-attr">receivedData</span>=<span class="hljs-string">{sharedData}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å…„å¼Ÿ 1ï¼šå‘é€æ•°æ®çš„ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child1</span>(<span class="hljs-params">{ onSendData }</span>) {
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSend</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">onSendData</span>(inputValue);
    <span class="hljs-title function_">setInputValue</span>(<span class="hljs-string">""</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å…„å¼Ÿç»„ä»¶ 1ï¼ˆå‘é€æ–¹ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setInputValue(e.target.value)}
        placeholder="è¾“å…¥è¦ä¼ é€’ç»™å…„å¼Ÿçš„æ•°æ®"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSend}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginLeft:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>
        å‘é€ç»™å…„å¼Ÿ
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å…„å¼Ÿ 2ï¼šæ¥æ”¶æ•°æ®çš„ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child2</span>(<span class="hljs-params">{ receivedData }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å…„å¼Ÿç»„ä»¶ 2ï¼ˆæ¥æ”¶æ–¹ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ”¶åˆ°å…„å¼Ÿ 1 çš„æ•°æ®ï¼š{receivedData || "æš‚æ— æ•°æ®"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-8">3. è·¨å±‚çº§ç»„ä»¶ä¼ å‚ï¼šContext APIï¼ˆReact 19 åŸç”Ÿæ–¹æ¡ˆï¼‰</h3>
<p>å½“ç»„ä»¶å±‚çº§å¾ˆæ·±ï¼ˆå¦‚â€œçˆ·çˆ·â†’çˆ¸çˆ¸â†’å„¿å­â†’å­™å­â€ï¼‰ï¼Œæˆ–è€…è·¨å¤šä¸ªå±‚çº§ä¼ é€’æ•°æ®æ—¶ï¼Œç”¨ props å±‚å±‚ä¼ é€’ï¼ˆå³â€œprops drillingâ€ï¼‰ä¼šéå¸¸ç¹çï¼Œä¸”ä»£ç å¯ç»´æŠ¤æ€§å·®ã€‚è¿™æ—¶å¯ä»¥ç”¨ React åŸç”Ÿçš„ <strong>Context API</strong> è§£å†³ã€‚</p>
<p>Context API çš„æ ¸å¿ƒä½œç”¨ï¼š<strong>åˆ›å»ºä¸€ä¸ªâ€œå…¨å±€æ•°æ®å®¹å™¨â€ï¼Œè®©æ‰€æœ‰åä»£ç»„ä»¶éƒ½èƒ½ç›´æ¥è®¿é—®å®¹å™¨ä¸­çš„æ•°æ®ï¼Œæ— éœ€å±‚å±‚ä¼ é€’ props</strong>ã€‚</p>
<h4 data-id="heading-9">ä½¿ç”¨æ­¥éª¤ï¼š3 æ­¥æå®š Context ä¼ å‚</h4>
<ol start="3">
<li>åˆ›å»º Contextï¼šç”¨ <code>createContext</code> åˆ›å»ºä¸€ä¸ª Context å¯¹è±¡ï¼ˆå¯è®¾ç½®é»˜è®¤å€¼ï¼‰ï¼›</li>
<li>æä¾› Contextï¼šç”¨ <code>Context.Provider</code> åŒ…è£¹éœ€è¦å…±äº«æ•°æ®çš„ç»„ä»¶æ ‘ï¼Œé€šè¿‡ <code>value</code> å±æ€§ä¼ å…¥å…±äº«æ•°æ®ï¼›</li>
<li>æ¶ˆè´¹ Contextï¼šåä»£ç»„ä»¶ç”¨ <code>useContext</code> Hook ç›´æ¥è·å–å…±äº«æ•°æ®ã€‚</li>
</ol>
<h4 data-id="heading-10">å®æˆ˜æ¡ˆä¾‹ï¼šè·¨å±‚çº§å…±äº«ä¸»é¢˜çŠ¶æ€</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createContext, useContext, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// æ­¥éª¤ 1ï¼šåˆ›å»º Contextï¼ˆé»˜è®¤å€¼ä»…åœ¨æ—  Provider æ—¶ç”Ÿæ•ˆï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-string">"light"</span>);

<span class="hljs-comment">// æ­¥éª¤ 2ï¼šæä¾› Context çš„ç»„ä»¶ï¼ˆé€šå¸¸æ˜¯é¡¶å±‚ç»„ä»¶ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">"light"</span>);

  <span class="hljs-comment">// å…±äº«çš„æ–¹æ³•ï¼šåˆ‡æ¢ä¸»é¢˜</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleTheme</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setTheme</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev === <span class="hljs-string">"light"</span> ? <span class="hljs-string">"dark"</span> : <span class="hljs-string">"light"</span>);
  };

  <span class="hljs-comment">// è¦å…±äº«çš„æ•°æ®å’Œæ–¹æ³•ï¼ˆå°è£…æˆå¯¹è±¡ï¼‰</span>
  <span class="hljs-keyword">const</span> contextValue = {
    theme,
    toggleTheme
  };

  <span class="hljs-keyword">return</span> (
    <span class="hljs-comment">// æ­¥éª¤ 2ï¼šç”¨ Provider åŒ…è£¹ç»„ä»¶æ ‘ï¼Œä¼ å…¥å…±äº«æ•°æ®</span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{contextValue}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>é¡¶å±‚ç»„ä»¶ï¼ˆæä¾› Contextï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Parent</span> /&gt;</span> {/* çˆ¶ç»„ä»¶ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// çˆ¶ç»„ä»¶ï¼ˆä¸­é—´å±‚çº§ï¼Œæ— éœ€ä¼ é€’ theme ç›¸å…³ propsï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>", <span class="hljs-attr">marginTop:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>çˆ¶ç»„ä»¶ï¼ˆä¸­é—´å±‚çº§ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> /&gt;</span> {/* å­ç»„ä»¶ */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å­ç»„ä»¶ï¼ˆåä»£ç»„ä»¶ï¼Œç›´æ¥æ¶ˆè´¹ Contextï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ­¥éª¤ 3ï¼šç”¨ useContext è·å–å…±äº«æ•°æ®</span>
  <span class="hljs-keyword">const</span> { theme, toggleTheme } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>);

  <span class="hljs-comment">// æ ¹æ®ä¸»é¢˜è®¾ç½®æ ·å¼</span>
  <span class="hljs-keyword">const</span> containerStyle = {
    <span class="hljs-attr">border</span>: <span class="hljs-string">"1px solid #ccc"</span>,
    <span class="hljs-attr">padding</span>: <span class="hljs-string">"20px"</span>,
    <span class="hljs-attr">marginTop</span>: <span class="hljs-string">"10px"</span>,
    <span class="hljs-attr">background</span>: theme === <span class="hljs-string">"light"</span> ? <span class="hljs-string">"#fff"</span> : <span class="hljs-string">"#333"</span>,
    <span class="hljs-attr">color</span>: theme === <span class="hljs-string">"light"</span> ? <span class="hljs-string">"#333"</span> : <span class="hljs-string">"#fff"</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{containerStyle}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å­ç»„ä»¶ï¼ˆæ¶ˆè´¹ Contextï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰ä¸»é¢˜ï¼š{theme}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleTheme}</span>&gt;</span>åˆ‡æ¢ä¸»é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>Context API é€‚åˆåœºæ™¯ï¼šå…±äº«â€œå˜åŒ–ä¸é¢‘ç¹â€çš„å…¨å±€æ•°æ®ï¼ˆå¦‚ä¸»é¢˜ã€ç”¨æˆ·ç™»å½•çŠ¶æ€ã€è¯­è¨€è®¾ç½®ï¼‰ã€‚å¦‚æœéœ€è¦é¢‘ç¹æ›´æ–°æ•°æ®ï¼Œä¸”æ¶‰åŠå¤æ‚é€»è¾‘ï¼ˆå¦‚å¤šç»„ä»¶ä¿®æ”¹åŒä¸€çŠ¶æ€ï¼‰ï¼Œå»ºè®®ç»“åˆ useReducer æˆ–ä¸“é—¨çš„å…¨å±€çŠ¶æ€ç®¡ç†åº“ã€‚</p>
<h2 data-id="heading-11">ä¸‰ã€å…¨å±€çŠ¶æ€ç®¡ç†ï¼šä» Context+useReducer åˆ°ä¸“ä¸šåº“</h2>
<p>å½“åº”ç”¨è§„æ¨¡æ‰©å¤§ï¼Œéœ€è¦å…±äº«çš„æ•°æ®å¢å¤šã€çŠ¶æ€æ›´æ–°é€»è¾‘å¤æ‚ï¼ˆå¦‚è´­ç‰©è½¦ã€ç”¨æˆ·ä¸­å¿ƒã€å¤šé¡µé¢å…±äº«ç­›é€‰æ¡ä»¶ï¼‰æ—¶ï¼Œå•çº¯çš„ Context API å°±ä¸å¤Ÿç”¨äº†ï¼ˆæ¯”å¦‚å¤šä¸ªç»„ä»¶ä¿®æ”¹ Context æ•°æ®æ—¶ï¼Œé€»è¾‘åˆ†æ•£ï¼Œéš¾ä»¥ç»´æŠ¤ï¼‰ã€‚è¿™æ—¶å°±éœ€è¦â€œå…¨å±€çŠ¶æ€ç®¡ç†â€æ–¹æ¡ˆã€‚</p>
<p>React 19 ä¸­å¸¸ç”¨çš„å…¨å±€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆæœ‰ 3 ç±»ï¼š<strong>Context+useReducerï¼ˆåŸç”Ÿæ–¹æ¡ˆï¼‰ã€Redux Toolkitï¼ˆç”Ÿæ€ä¸»æµï¼‰ã€Zustand/Jotaiï¼ˆè½»é‡æ–¹æ¡ˆï¼‰</strong> ã€‚æˆ‘ä»¬åˆ†åˆ«è®²è§£å®ƒä»¬çš„æ ¸å¿ƒæ€è·¯å’Œé€‚ç”¨åœºæ™¯ã€‚</p>
<h3 data-id="heading-12">1. åŸç”Ÿæ–¹æ¡ˆï¼šContext+useReducerï¼ˆé€‚åˆä¸­å°å‹åº”ç”¨ï¼‰</h3>
<p>useReducer æ˜¯ React å†…ç½®çš„ Hooksï¼Œç”¨äºå¤„ç†â€œå¤æ‚çŠ¶æ€é€»è¾‘â€â€”â€”å½“çŠ¶æ€æ›´æ–°ä¾èµ–äºå‰ä¸€ä¸ªçŠ¶æ€ã€æˆ–è€…æœ‰å¤šä¸ªå­å€¼éœ€è¦åŒæ­¥æ›´æ–°æ—¶ï¼ŒuseReducer æ¯” useState æ›´æ¸…æ™°ã€‚</p>
<p>Context+useReducer çš„æ ¸å¿ƒæ€è·¯ï¼š<strong>ç”¨ useReducer ç®¡ç†å…¨å±€çŠ¶æ€çš„æ›´æ–°é€»è¾‘ï¼Œç”¨ Context æä¾›å’Œå…±äº«çŠ¶æ€ä¸ dispatch æ–¹æ³•</strong>ï¼Œå®ç°â€œçŠ¶æ€é›†ä¸­ç®¡ç†+å…¨å±€å…±äº«â€ã€‚</p>
<h4 data-id="heading-13">å®æˆ˜æ¡ˆä¾‹ï¼šå…¨å±€è´­ç‰©è½¦çŠ¶æ€ç®¡ç†</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createContext, useContext, useReducer } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// æ­¥éª¤ 1ï¼šåˆ›å»º Context</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">CartContext</span> = <span class="hljs-title function_">createContext</span>();

<span class="hljs-comment">// æ­¥éª¤ 2ï¼šå®šä¹‰ reducer å‡½æ•°ï¼ˆé›†ä¸­å¤„ç†çŠ¶æ€æ›´æ–°é€»è¾‘ï¼‰</span>
<span class="hljs-comment">// reducer æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šå½“å‰çŠ¶æ€ stateã€åŠ¨ä½œ actionï¼ˆåŒ…å« type å’Œ payloadï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">cartReducer</span>(<span class="hljs-params">state, action</span>) {
  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) {
    <span class="hljs-comment">// æ–°å¢å•†å“</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_ITEM"</span>:
      <span class="hljs-comment">// å…ˆåˆ¤æ–­å•†å“æ˜¯å¦å·²å­˜åœ¨</span>
      <span class="hljs-keyword">const</span> existingItem = state.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === action.<span class="hljs-property">payload</span>.<span class="hljs-property">id</span>);
      <span class="hljs-keyword">if</span> (existingItem) {
        <span class="hljs-comment">// å·²å­˜åœ¨ï¼šæ›´æ–°æ•°é‡</span>
        <span class="hljs-keyword">return</span> state.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> 
          item.<span class="hljs-property">id</span> === action.<span class="hljs-property">payload</span>.<span class="hljs-property">id</span> 
            ? { ...item, <span class="hljs-attr">count</span>: item.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> } 
            : item
        );
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ä¸å­˜åœ¨ï¼šæ–°å¢å•†å“</span>
        <span class="hljs-keyword">return</span> [...state, { ...action.<span class="hljs-property">payload</span>, <span class="hljs-attr">count</span>: <span class="hljs-number">1</span> }];
      }
    <span class="hljs-comment">// åˆ é™¤å•†å“</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"REMOVE_ITEM"</span>:
      <span class="hljs-keyword">return</span> state.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> !== action.<span class="hljs-property">payload</span>.<span class="hljs-property">id</span>);
    <span class="hljs-comment">// æ¸…ç©ºè´­ç‰©è½¦</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"CLEAR_CART"</span>:
      <span class="hljs-keyword">return</span> [];
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-comment">// æ­¥éª¤ 3ï¼šåˆ›å»º Provider ç»„ä»¶ï¼Œæä¾›çŠ¶æ€å’Œ dispatch</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">CartProvider</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-comment">// ç”¨ useReducer ç®¡ç†çŠ¶æ€ï¼šåˆå§‹çŠ¶æ€ä¸ºç©ºæ•°ç»„</span>
  <span class="hljs-keyword">const</span> [cartState, dispatch] = <span class="hljs-title function_">useReducer</span>(cartReducer, []);

  <span class="hljs-comment">// å…±äº«çš„æ•°æ®å’Œæ–¹æ³•</span>
  <span class="hljs-keyword">const</span> contextValue = {
    cartState, <span class="hljs-comment">// è´­ç‰©è½¦çŠ¶æ€</span>
    <span class="hljs-comment">// å°è£… dispatch æ–¹æ³•ï¼ˆè®©ç»„ä»¶æ›´æ˜“ç”¨ï¼Œæ— éœ€ç›´æ¥å†™ actionï¼‰</span>
    <span class="hljs-attr">addItem</span>: <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_ITEM"</span>, <span class="hljs-attr">payload</span>: item }),
    <span class="hljs-attr">removeItem</span>: <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"REMOVE_ITEM"</span>, <span class="hljs-attr">payload</span>: { id } }),
    <span class="hljs-attr">clearCart</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"CLEAR_CART"</span> })
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">CartContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{contextValue}</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">CartContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// æ­¥éª¤ 4ï¼šæ¶ˆè´¹å…¨å±€çŠ¶æ€çš„ç»„ä»¶</span>
<span class="hljs-comment">// ç»„ä»¶ 1ï¼šå•†å“åˆ—è¡¨ï¼ˆæ·»åŠ å•†å“åˆ°è´­ç‰©è½¦ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ProductList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { addItem } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">CartContext</span>);

  <span class="hljs-comment">// æ¨¡æ‹Ÿå•†å“æ•°æ®</span>
  <span class="hljs-keyword">const</span> products = [
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"React å®æˆ˜æ•™ç¨‹"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">99</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Vue å®æˆ˜æ•™ç¨‹"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">89</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"TypeScript æ•™ç¨‹"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">79</span> }
  ];

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>å•†å“åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> "<span class="hljs-attr">flex</span>", <span class="hljs-attr">gap:</span> "<span class="hljs-attr">20px</span>", <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span> <span class="hljs-attr">0</span>" }}&gt;</span>
        {products.map(product =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{product.id}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä»·æ ¼ï¼š{product.price} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> addItem(product)}&gt;åŠ å…¥è´­ç‰©è½¦<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ç»„ä»¶ 2ï¼šè´­ç‰©è½¦ï¼ˆå±•ç¤º/åˆ é™¤/æ¸…ç©ºå•†å“ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cart</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { cartState, removeItem, clearCart } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">CartContext</span>);

  <span class="hljs-comment">// è®¡ç®—æ€»ä»·æ ¼</span>
  <span class="hljs-keyword">const</span> totalPrice = cartState.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">total, item</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> total + item.<span class="hljs-property">price</span> * item.<span class="hljs-property">count</span>;
  }, <span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> "<span class="hljs-attr">20px</span>", <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>è´­ç‰©è½¦ï¼ˆ{cartState.length} ç§å•†å“ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {cartState.length === 0 ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è´­ç‰©è½¦ä¸ºç©º<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;&gt;</span>
          {cartState.map(item =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> "<span class="hljs-attr">flex</span>", <span class="hljs-attr">gap:</span> "<span class="hljs-attr">10px</span>", <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span> <span class="hljs-attr">0</span>" }}&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{item.name} Ã— {item.count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{item.price * item.count} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeItem(item.id)}&gt;åˆ é™¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ€»ä»·ï¼š{totalPrice} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearCart}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>æ¸…ç©ºè´­ç‰©è½¦<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}
    &lt;/div&gt;
  );
}

<span class="hljs-comment">// æ ¹ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">CartProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å…¨å±€è´­ç‰©è½¦ç®¡ç†ï¼ˆContext+useReducerï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ProductList</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Cart</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">CartProvider</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-14">2. ç”Ÿæ€ä¸»æµï¼šRedux Toolkitï¼ˆé€‚åˆå¤§å‹å¤æ‚åº”ç”¨ï¼‰</h3>
<p>Redux æ˜¯ React ç”Ÿæ€ä¸­æœ€æˆç†Ÿçš„å…¨å±€çŠ¶æ€ç®¡ç†åº“ï¼Œè€Œ Redux Toolkitï¼ˆRTKï¼‰æ˜¯å®˜æ–¹æ¨èçš„ Redux ç®€åŒ–æ–¹æ¡ˆï¼ˆè§£å†³äº†åŸç”Ÿ Redux ä»£ç ç¹çã€é…ç½®å¤æ‚çš„é—®é¢˜ï¼‰ã€‚</p>
<p>æ ¸å¿ƒä¼˜åŠ¿ï¼š<strong>çŠ¶æ€é›†ä¸­ç®¡ç†ã€å¯é¢„æµ‹æ€§å¼ºã€æ”¯æŒä¸­é—´ä»¶ï¼ˆå¦‚å¼‚æ­¥è¯·æ±‚ï¼‰ã€è°ƒè¯•å·¥å…·å®Œå–„</strong>ï¼Œé€‚åˆå¤§å‹åº”ç”¨ä¸­å¤šå›¢é˜Ÿåä½œã€å¤æ‚çŠ¶æ€é€»è¾‘çš„åœºæ™¯ã€‚</p>
<h4 data-id="heading-15">æ ¸å¿ƒæ¦‚å¿µä¸ä½¿ç”¨æ­¥éª¤ï¼ˆç®€åŒ–ï¼‰</h4>
<ol start="7">
<li>å®‰è£…ä¾èµ–ï¼š<code>npm install @reduxjs/toolkit react-redux</code>ï¼›</li>
<li>åˆ›å»ºåˆ‡ç‰‡ï¼ˆSliceï¼‰ï¼šç”¨ <code>createSlice</code> å®šä¹‰çŠ¶æ€åˆå§‹å€¼ã€reducer å‡½æ•°ï¼ˆåŒæ­¥/å¼‚æ­¥ï¼‰ï¼›</li>
<li>åˆ›å»º Storeï¼šç”¨ <code>configureStore</code> æ•´åˆæ‰€æœ‰åˆ‡ç‰‡ï¼›</li>
<li>æä¾› Storeï¼šç”¨ <code>Provider</code>ï¼ˆæ¥è‡ª react-reduxï¼‰åŒ…è£¹æ ¹ç»„ä»¶ï¼›</li>
<li>æ¶ˆè´¹ Storeï¼šç”¨ <code>useSelector</code> è·å–çŠ¶æ€ï¼Œç”¨ <code>useDispatch</code> è§¦å‘çŠ¶æ€æ›´æ–°ã€‚</li>
</ol>
<h4 data-id="heading-16">å®æˆ˜æ¡ˆä¾‹ï¼šRedux Toolkit å®ç°è´­ç‰©è½¦</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. å®‰è£…ä¾èµ–åï¼Œåˆ›å»ºåˆ‡ç‰‡ï¼ˆsrc/features/cart/cartSlice.jsï¼‰</span>
<span class="hljs-keyword">import</span> { createSlice, createAsyncThunk } <span class="hljs-keyword">from</span> <span class="hljs-string">'@reduxjs/toolkit'</span>;

<span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚ï¼šä»æ¥å£è·å–å•†å“æ•°æ®ï¼ˆå¼‚æ­¥ actionï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> fetchProducts = <span class="hljs-title function_">createAsyncThunk</span>(
  <span class="hljs-string">'cart/fetchProducts'</span>,
  <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/products'</span>);
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
  }
);

<span class="hljs-comment">// åˆ›å»ºåˆ‡ç‰‡</span>
<span class="hljs-keyword">const</span> cartSlice = <span class="hljs-title function_">createSlice</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'cart'</span>, <span class="hljs-comment">// åˆ‡ç‰‡åç§°ï¼ˆå”¯ä¸€ï¼‰</span>
  <span class="hljs-attr">initialState</span>: {
    <span class="hljs-attr">products</span>: [], <span class="hljs-comment">// å•†å“åˆ—è¡¨</span>
    <span class="hljs-attr">cartItems</span>: [], <span class="hljs-comment">// è´­ç‰©è½¦å•†å“</span>
    <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// åŠ è½½çŠ¶æ€</span>
    <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> <span class="hljs-comment">// é”™è¯¯ä¿¡æ¯</span>
  },
  <span class="hljs-attr">reducers</span>: {
    <span class="hljs-comment">// åŒæ­¥ actionï¼šæ·»åŠ å•†å“åˆ°è´­ç‰©è½¦</span>
    <span class="hljs-attr">addToCart</span>: <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> existingItem = state.<span class="hljs-property">cartItems</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === action.<span class="hljs-property">payload</span>.<span class="hljs-property">id</span>);
      <span class="hljs-keyword">if</span> (existingItem) {
        existingItem.<span class="hljs-property">count</span> += <span class="hljs-number">1</span>;
      } <span class="hljs-keyword">else</span> {
        state.<span class="hljs-property">cartItems</span>.<span class="hljs-title function_">push</span>({ ...action.<span class="hljs-property">payload</span>, <span class="hljs-attr">count</span>: <span class="hljs-number">1</span> });
      }
    },
    <span class="hljs-comment">// åŒæ­¥ actionï¼šä»è´­ç‰©è½¦åˆ é™¤å•†å“</span>
    <span class="hljs-attr">removeFromCart</span>: <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
      state.<span class="hljs-property">cartItems</span> = state.<span class="hljs-property">cartItems</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> !== action.<span class="hljs-property">payload</span>);
    },
    <span class="hljs-comment">// åŒæ­¥ actionï¼šæ¸…ç©ºè´­ç‰©è½¦</span>
    <span class="hljs-attr">clearCart</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
      state.<span class="hljs-property">cartItems</span> = [];
    }
  },
  <span class="hljs-comment">// å¤„ç†å¼‚æ­¥ action çš„çŠ¶æ€ï¼ˆpending/fulfilled/rejectedï¼‰</span>
  <span class="hljs-attr">extraReducers</span>: <span class="hljs-function">(<span class="hljs-params">builder</span>) =&gt;</span> {
    builder
      .<span class="hljs-title function_">addCase</span>(fetchProducts.<span class="hljs-property">pending</span>, <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
        state.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>;
      })
      .<span class="hljs-title function_">addCase</span>(fetchProducts.<span class="hljs-property">fulfilled</span>, <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
        state.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
        state.<span class="hljs-property">products</span> = action.<span class="hljs-property">payload</span>;
      })
      .<span class="hljs-title function_">addCase</span>(fetchProducts.<span class="hljs-property">rejected</span>, <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
        state.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
        state.<span class="hljs-property">error</span> = action.<span class="hljs-property">error</span>.<span class="hljs-property">message</span>;
      });
  }
});

<span class="hljs-comment">// å¯¼å‡ºåŒæ­¥ action</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> { addToCart, removeFromCart, clearCart } = cartSlice.<span class="hljs-property">actions</span>;

<span class="hljs-comment">// å¯¼å‡º reducer</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> cartSlice.<span class="hljs-property">reducer</span>;

<span class="hljs-comment">// 2. åˆ›å»º Storeï¼ˆsrc/app/store.jsï¼‰</span>
<span class="hljs-keyword">import</span> { configureStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@reduxjs/toolkit'</span>;
<span class="hljs-keyword">import</span> cartReducer <span class="hljs-keyword">from</span> <span class="hljs-string">'../features/cart/cartSlice'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">configureStore</span>({
  <span class="hljs-attr">reducer</span>: {
    <span class="hljs-attr">cart</span>: cartReducer <span class="hljs-comment">// æ•´åˆ cart åˆ‡ç‰‡</span>
  }
});

<span class="hljs-comment">// 3. æ ¹ç»„ä»¶æä¾› Storeï¼ˆsrc/App.jsï¼‰</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Provider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;
<span class="hljs-keyword">import</span> { store } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app/store'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ProductList</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./features/cart/ProductList'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Cart</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./features/cart/Cart'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span> {/* æä¾› Store */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Redux Toolkit è´­ç‰©è½¦<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ProductList</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Cart</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 4. æ¶ˆè´¹ Storeï¼šå•†å“åˆ—è¡¨ç»„ä»¶ï¼ˆsrc/features/cart/ProductList.jsï¼‰</span>
<span class="hljs-keyword">import</span> { useDispatch, useSelector } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;
<span class="hljs-keyword">import</span> { fetchProducts, addToCart } <span class="hljs-keyword">from</span> <span class="hljs-string">'./cartSlice'</span>;
<span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">ProductList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> dispatch = <span class="hljs-title function_">useDispatch</span>();
  <span class="hljs-keyword">const</span> { products, loading, error } = <span class="hljs-title function_">useSelector</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">cart</span>);

  <span class="hljs-comment">// ç»„ä»¶æŒ‚è½½æ—¶è·å–å•†å“æ•°æ®</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">fetchProducts</span>());
  }, [dispatch]);

  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é”™è¯¯ï¼š{error}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>å•†å“åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> "<span class="hljs-attr">flex</span>", <span class="hljs-attr">gap:</span> "<span class="hljs-attr">20px</span>", <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span> <span class="hljs-attr">0</span>" }}&gt;</span>
        {products.map(product =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{product.id}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä»·æ ¼ï¼š{product.price} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch(addToCart(product))}&gt;åŠ å…¥è´­ç‰©è½¦<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ProductList</span>;

<span class="hljs-comment">// 5. æ¶ˆè´¹ Storeï¼šè´­ç‰©è½¦ç»„ä»¶ï¼ˆsrc/features/cart/Cart.jsï¼‰</span>
<span class="hljs-keyword">import</span> { useDispatch, useSelector } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;
<span class="hljs-keyword">import</span> { removeFromCart, clearCart } <span class="hljs-keyword">from</span> <span class="hljs-string">'./cartSlice'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cart</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> dispatch = <span class="hljs-title function_">useDispatch</span>();
  <span class="hljs-keyword">const</span> { cartItems } = <span class="hljs-title function_">useSelector</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">cart</span>);

  <span class="hljs-keyword">const</span> totalPrice = cartItems.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">total, item</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> total + item.<span class="hljs-property">price</span> * item.<span class="hljs-property">count</span>;
  }, <span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> "<span class="hljs-attr">20px</span>", <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>è´­ç‰©è½¦ï¼ˆ{cartItems.length} ç§å•†å“ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {cartItems.length === 0 ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è´­ç‰©è½¦ä¸ºç©º<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;&gt;</span>
          {cartItems.map(item =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> "<span class="hljs-attr">flex</span>", <span class="hljs-attr">gap:</span> "<span class="hljs-attr">10px</span>", <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span> <span class="hljs-attr">0</span>" }}&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{item.name} Ã— {item.count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{item.price * item.count} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch(removeFromCart(item.id))}&gt;åˆ é™¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ€»ä»·ï¼š{totalPrice} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch(clearCart())} style={{ marginTop: "10px" }}&gt;æ¸…ç©ºè´­ç‰©è½¦<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}
    &lt;/div&gt;
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Cart</span>;
</code></pre>
<h3 data-id="heading-17">3. è½»é‡æ–¹æ¡ˆï¼šZustandï¼ˆé€‚åˆä¸­å°å‹åº”ç”¨ï¼Œç®€æ´é«˜æ•ˆï¼‰</h3>
<p>å¦‚æœè§‰å¾— Redux Toolkit é…ç½®è¿˜æ˜¯ç¹çï¼Œè€Œ Context+useReducer åœ¨å¤æ‚åœºæ™¯ä¸‹ä¸å¤Ÿçµæ´»ï¼Œå¯ä»¥é€‰æ‹© Zustandâ€”â€”ä¸€ä¸ªè½»é‡çº§çš„å…¨å±€çŠ¶æ€ç®¡ç†åº“ï¼ŒAPI ç®€æ´ï¼Œæ— éœ€è¿‡å¤šé…ç½®ï¼Œæ·±å— React å¼€å‘è€…å–œçˆ±ã€‚</p>
<p>æ ¸å¿ƒä¼˜åŠ¿ï¼š<strong>ä»£ç ç®€æ´ã€å­¦ä¹ æˆæœ¬ä½ã€æ— éœ€ Provider åŒ…è£¹ã€æ”¯æŒä¸­é—´ä»¶ï¼ˆå¼‚æ­¥è¯·æ±‚ã€æŒä¹…åŒ–ç­‰ï¼‰</strong> ï¼Œé€‚åˆä¸­å°å‹åº”ç”¨æˆ–å¯¹å¼€å‘æ•ˆç‡æœ‰è¦æ±‚çš„åœºæ™¯ã€‚</p>
<h4 data-id="heading-18">å®æˆ˜æ¡ˆä¾‹ï¼šZustand å®ç°è´­ç‰©è½¦</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. å®‰è£…ä¾èµ–ï¼šnpm install zustand</span>
<span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;
<span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// 2. åˆ›å»º Store</span>
<span class="hljs-keyword">const</span> useCartStore = <span class="hljs-title function_">create</span>(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
  <span class="hljs-comment">// çŠ¶æ€</span>
  <span class="hljs-attr">products</span>: [],
  <span class="hljs-attr">cartItems</span>: [],
  <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,

  <span class="hljs-comment">// å¼‚æ­¥ actionï¼šè·å–å•†å“æ•°æ®</span>
  <span class="hljs-attr">fetchProducts</span>: <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-title function_">set</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/products'</span>);
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>();
      <span class="hljs-title function_">set</span>({ <span class="hljs-attr">products</span>: data, <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> });
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-title function_">set</span>({ <span class="hljs-attr">error</span>: err.<span class="hljs-property">message</span>, <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> });
    }
  },

  <span class="hljs-comment">// åŒæ­¥ actionï¼šæ·»åŠ å•†å“åˆ°è´­ç‰©è½¦</span>
  <span class="hljs-attr">addToCart</span>: <span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> {
    <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> existingItem = state.<span class="hljs-property">cartItems</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === product.<span class="hljs-property">id</span>);
      <span class="hljs-keyword">if</span> (existingItem) {
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">cartItems</span>: state.<span class="hljs-property">cartItems</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> 
            item.<span class="hljs-property">id</span> === product.<span class="hljs-property">id</span> ? { ...item, <span class="hljs-attr">count</span>: item.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> } : item
          )
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">cartItems</span>: [...state.<span class="hljs-property">cartItems</span>, { ...product, <span class="hljs-attr">count</span>: <span class="hljs-number">1</span> }] };
      }
    });
  },

  <span class="hljs-comment">// åŒæ­¥ actionï¼šåˆ é™¤å•†å“</span>
  <span class="hljs-attr">removeFromCart</span>: <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({
      <span class="hljs-attr">cartItems</span>: state.<span class="hljs-property">cartItems</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> !== id)
    }));
  },

  <span class="hljs-comment">// åŒæ­¥ actionï¼šæ¸…ç©ºè´­ç‰©è½¦</span>
  <span class="hljs-attr">clearCart</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">set</span>({ <span class="hljs-attr">cartItems</span>: [] });
  }
}));

<span class="hljs-comment">// 3. å•†å“åˆ—è¡¨ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ProductList</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ä» Store è·å–çŠ¶æ€å’Œæ–¹æ³•</span>
  <span class="hljs-keyword">const</span> { products, loading, error, fetchProducts, addToCart } = <span class="hljs-title function_">useCartStore</span>();

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">fetchProducts</span>();
  }, [fetchProducts]);

  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é”™è¯¯ï¼š{error}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>å•†å“åˆ—è¡¨ï¼ˆZustandï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> "<span class="hljs-attr">flex</span>", <span class="hljs-attr">gap:</span> "<span class="hljs-attr">20px</span>", <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span> <span class="hljs-attr">0</span>" }}&gt;</span>
        {products.map(product =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{product.id}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä»·æ ¼ï¼š{product.price} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> addToCart(product)}&gt;åŠ å…¥è´­ç‰©è½¦<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 4. è´­ç‰©è½¦ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cart</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ä» Store è·å–çŠ¶æ€å’Œæ–¹æ³•</span>
  <span class="hljs-keyword">const</span> { cartItems, removeFromCart, clearCart } = <span class="hljs-title function_">useCartStore</span>();

  <span class="hljs-keyword">const</span> totalPrice = cartItems.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">total, item</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> total + item.<span class="hljs-property">price</span> * item.<span class="hljs-property">count</span>;
  }, <span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> "<span class="hljs-attr">20px</span>", <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>è´­ç‰©è½¦ï¼ˆ{cartItems.length} ç§å•†å“ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {cartItems.length === 0 ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è´­ç‰©è½¦ä¸ºç©º<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;&gt;</span>
          {cartItems.map(item =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> "<span class="hljs-attr">flex</span>", <span class="hljs-attr">gap:</span> "<span class="hljs-attr">10px</span>", <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span> <span class="hljs-attr">0</span>" }}&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{item.name} Ã— {item.count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{item.price * item.count} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeFromCart(item.id)}&gt;åˆ é™¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ€»ä»·ï¼š{totalPrice} å…ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearCart}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>æ¸…ç©ºè´­ç‰©è½¦<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}
    &lt;/div&gt;
  );
}

<span class="hljs-comment">// 5. æ ¹ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Zustand è´­ç‰©è½¦<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ProductList</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Cart</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h2 data-id="heading-19">å››ã€å…¨å±€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰æ‹©å»ºè®®</h2>
<p>ä¸ºäº†è®©å¤§å®¶èƒ½æ ¹æ®é¡¹ç›®è§„æ¨¡å’Œéœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬ç”¨è¡¨æ ¼å¯¹æ¯”å¸¸ç”¨çš„ 3 ç§å…¨å±€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼š</p>





























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>æ ¸å¿ƒä¼˜åŠ¿</th><th>åŠ£åŠ¿</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Context+useReducer</td><td>1. åŸç”Ÿæ–¹æ¡ˆï¼Œæ— éœ€é¢å¤–å®‰è£…ä¾èµ–ï¼›2. å®ç°ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½ï¼›3. è½»é‡æ— å†—ä½™</td><td>1. ä¸æ”¯æŒä¸­é—´ä»¶ï¼Œå¤„ç†å¼‚æ­¥é€»è¾‘ç¹çï¼›2. çŠ¶æ€æ›´æ–°ä¼šè§¦å‘æ‰€æœ‰æ¶ˆè´¹ç»„ä»¶é‡æ¸²æŸ“ï¼ˆéœ€é…åˆ memo ä¼˜åŒ–ï¼‰ï¼›3. ä¸é€‚åˆå¤æ‚çŠ¶æ€é€»è¾‘</td><td>ä¸­å°å‹åº”ç”¨ã€ç®€å•å…¨å±€çŠ¶æ€ï¼ˆå¦‚ä¸»é¢˜ã€ç™»å½•çŠ¶æ€ï¼‰</td></tr><tr><td>Redux Toolkit</td><td>1. çŠ¶æ€é›†ä¸­ç®¡ç†ï¼Œå¯é¢„æµ‹æ€§å¼ºï¼›2. æ”¯æŒä¸­é—´ä»¶ï¼ˆå¼‚æ­¥ã€æ—¥å¿—ç­‰ï¼‰ï¼›3. è°ƒè¯•å·¥å…·å®Œå–„ï¼›4. é€‚åˆå¤šå›¢é˜Ÿåä½œ</td><td>1. é…ç½®ç›¸å¯¹ç¹çï¼Œå­¦ä¹ æˆæœ¬é«˜ï¼›2. ä»£ç é‡è¾ƒå¤šï¼›3. è½»é‡åº”ç”¨å¯èƒ½æ˜¾å¾—è¿‡é‡</td><td>å¤§å‹å¤æ‚åº”ç”¨ã€å¤šå›¢é˜Ÿåä½œã€å¤æ‚çŠ¶æ€é€»è¾‘ï¼ˆå¦‚ç”µå•†ã€åå°ç®¡ç†ç³»ç»Ÿï¼‰</td></tr><tr><td>Zustand</td><td>1. API ç®€æ´ï¼Œå­¦ä¹ æˆæœ¬ä½ï¼›2. æ— éœ€ Provider åŒ…è£¹ï¼›3. æ”¯æŒä¸­é—´ä»¶ï¼Œå¤„ç†å¼‚æ­¥ç®€å•ï¼›4. æ€§èƒ½ä¼˜ç§€ï¼ˆç²¾å‡†æ›´æ–°ï¼‰</td><td>1. ç”Ÿæ€ä¸å¦‚ Redux å®Œå–„ï¼›2. å¤§å‹å¤æ‚åº”ç”¨çš„åä½œè§„èŒƒä¸å¦‚ Redux æˆç†Ÿ</td><td>ä¸­å°å‹åº”ç”¨ã€å¯¹å¼€å‘æ•ˆç‡æœ‰è¦æ±‚çš„åœºæ™¯ã€éœ€è¦è½»é‡æ–¹æ¡ˆæ›¿ä»£ Context+useReducer</td></tr></tbody></table>
<h2 data-id="heading-20">äº”ã€æ ¸å¿ƒæ€»ç»“ä¸é¿å‘æŒ‡å—</h2>
<h3 data-id="heading-21">æ ¸å¿ƒæ€»ç»“</h3>
<ol start="7">
<li><strong>ç»„ä»¶ä¼ å‚éµå¾ªâ€œå°±è¿‘åŸåˆ™â€</strong> ï¼šçˆ¶å­/å…„å¼Ÿç»„ä»¶ç”¨ props+å›è°ƒï¼Œè·¨å±‚çº§ç”¨ Context APIï¼Œå…¨å±€å…±äº«ç”¨ä¸“é—¨çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼›</li>
<li><strong>å…¨å±€çŠ¶æ€ç®¡ç†â€œæŒ‰éœ€é€‰æ‹©â€</strong> ï¼šå°å‹åº”ç”¨ç”¨ Context+useReducerï¼Œä¸­å‹ç”¨ Zustandï¼Œå¤§å‹å¤æ‚åº”ç”¨ç”¨ Redux Toolkitï¼›</li>
<li><strong>props æ˜¯åªè¯»çš„</strong>ï¼šå­ç»„ä»¶ä¸èƒ½ç›´æ¥ä¿®æ”¹ propsï¼Œéœ€é€šè¿‡å›è°ƒè®©çˆ¶ç»„ä»¶æ›´æ–°ï¼Œé¿å…ç ´åå•å‘æ•°æ®æµï¼›</li>
<li><strong>é¿å…è¿‡åº¦è®¾è®¡</strong>ï¼šä¸è¦ä¸€å¼€å§‹å°±ç”¨å…¨å±€çŠ¶æ€ï¼Œå…ˆå°è¯•å±€éƒ¨ä¼ å‚ï¼Œå½“å±€éƒ¨ä¼ å‚æ— æ³•æ»¡è¶³éœ€æ±‚æ—¶å†å¼•å…¥å…¨å±€çŠ¶æ€ã€‚</li>
</ol>
<h3 data-id="heading-22">é¿å‘æŒ‡å—</h3>
<ul>
<li><strong>å‘ 1ï¼šæ»¥ç”¨ Context API</strong>ï¼šContext ä¼šå¯¼è‡´æ‰€æœ‰æ¶ˆè´¹ç»„ä»¶åœ¨çŠ¶æ€æ›´æ–°æ—¶é‡æ¸²æŸ“ï¼Œè‹¥çŠ¶æ€æ›´æ–°é¢‘ç¹ï¼Œéœ€é…åˆ memoã€useMemo ä¼˜åŒ–ï¼›</li>
<li><strong>å‘ 2ï¼šRedux è¿‡åº¦ä½¿ç”¨</strong>ï¼šä¸æ˜¯æ‰€æœ‰çŠ¶æ€éƒ½éœ€è¦æ”¾å…¥ Reduxï¼Œå±€éƒ¨çŠ¶æ€ï¼ˆå¦‚ç»„ä»¶å†…éƒ¨çš„è¡¨å•è¾“å…¥ï¼‰ç”¨ useState å³å¯ï¼›</li>
<li><strong>å‘ 3ï¼šåˆ—è¡¨æ¸²æŸ“å¿˜è®°åŠ  key</strong>ï¼šä¼ å‚æ—¶è‹¥æ¶‰åŠåˆ—è¡¨æ¸²æŸ“ï¼ŒåŠ¡å¿…ç»™åˆ—è¡¨é¡¹åŠ å”¯ä¸€ keyï¼Œé¿å… React è¯¯åˆ¤èŠ‚ç‚¹å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼›</li>
<li><strong>å‘ 4ï¼šç›´æ¥ä¿®æ”¹çŠ¶æ€</strong>ï¼šæ— è®ºæ˜¯å±€éƒ¨çŠ¶æ€è¿˜æ˜¯å…¨å±€çŠ¶æ€ï¼Œéƒ½è¦éµå¾ªâ€œä¸å¯å˜æ›´æ–°â€åŸåˆ™ï¼ˆå¦‚ç”¨æ‰©å±•è¿ç®—ç¬¦ã€map ç­‰æ–¹æ³•åˆ›å»ºæ–°çŠ¶æ€ï¼‰ï¼Œé¿å…ç›´æ¥ä¿®æ”¹åŸçŠ¶æ€ã€‚</li>
</ul>
<h2 data-id="heading-23">å…­ã€ä¸‹ä¸€æ­¥å­¦ä¹ æ–¹å‘</h2>
<p>ä»Šå¤©æˆ‘ä»¬æŒæ¡äº† React 19 ç»„ä»¶ä¼ å‚ä¸å…¨å±€çŠ¶æ€ç®¡ç†çš„æ ¸å¿ƒæ–¹æ¡ˆï¼Œä¸‹ä¸€æ­¥å¯ä»¥é‡ç‚¹å­¦ä¹ ï¼š</p>
<ul>
<li>çŠ¶æ€ç®¡ç†æ€§èƒ½ä¼˜åŒ–ï¼šå¦‚ memoã€useMemoã€useCallback ä¸çŠ¶æ€ç®¡ç†çš„é…åˆä½¿ç”¨ï¼›</li>
<li>å…¶ä»–è½»é‡çŠ¶æ€ç®¡ç†åº“ï¼šå¦‚ Jotaiã€Recoilï¼ˆåŸå­åŒ–çŠ¶æ€ç®¡ç†ï¼Œé€‚åˆç»†ç²’åº¦çŠ¶æ€å…±äº«ï¼‰ï¼›</li>
<li>Redux é«˜çº§ç‰¹æ€§ï¼šå¦‚ä¸­é—´ä»¶ï¼ˆredux-thunkã€redux-sagaï¼‰ã€çŠ¶æ€æŒä¹…åŒ–ï¼ˆredux-persistï¼‰ï¼›</li>
<li>React 19 æ–°å¢çŠ¶æ€ç›¸å…³ç‰¹æ€§ï¼šå¦‚ useOptimisticï¼ˆä¹è§‚æ›´æ–°ï¼‰ã€useActionStateï¼ˆè¡¨å•çŠ¶æ€ç®¡ç†ï¼‰ã€‚</li>
</ul>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ã€è½¬å‘ï½ æœ‰ä»»ä½•é—®é¢˜ä¹Ÿå¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï½ æˆ‘ä»¬ä¸‹æœŸå†è§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHP 8.5 #[\NoDiscard] æªå‡º"å¿½ç•¥è¿”å›å€¼"çš„ Bug]]></title>    <link>https://juejin.cn/post/7592815497848455231</link>    <guid>https://juejin.cn/post/7592815497848455231</guid>    <pubDate>2026-01-08T23:24:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592815497848455231" data-draft-id="7592865044691550214" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PHP 8.5 #[\NoDiscard] æªå‡º&quot;å¿½ç•¥è¿”å›å€¼&quot;çš„ Bug"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2026-01-08T23:24:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PHP 8.5 #[\NoDiscard] æªå‡º"å¿½ç•¥è¿”å›å€¼"çš„ Bug
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T23:24:35.000Z" title="Thu Jan 08 2026 23:24:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PHP 8.5 #[\NoDiscard] æªå‡º"å¿½ç•¥è¿”å›å€¼"çš„ Bug</h2>
<p>æœ‰äº› bug ä¼šå¯¼è‡´å¼‚å¸¸ã€è‡´å‘½é”™è¯¯ã€ç›‘æ§é¢æ¿ä¸€ç‰‡çº¢ã€‚</p>
<p>è¿˜æœ‰ä¸€ç±» bug é•¿è¿™æ ·ï¼š"ä¸€åˆ‡éƒ½è·‘äº†ï¼Œä½†ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿ"ã€‚æ–¹æ³•è°ƒäº†ï¼Œå‰¯ä½œç”¨ä¹Ÿæœ‰äº†ï¼Œä½†å…³é”®è¿”å›å€¼ï¼ˆæˆåŠŸæ ‡å¿—ã€é”™è¯¯åˆ—è¡¨ã€æ–°çš„ä¸å¯å˜å®ä¾‹ï¼‰è¢«æ‰”æ‰äº†ã€‚ç²—çœ‹ä»£ç æ²¡æ¯›ç—…ï¼Œæµ‹è¯•æ²¡è¦†ç›–åˆ°è¾¹ç•Œæƒ…å†µä¹Ÿèƒ½è¿‡ã€‚bug å°±è¿™ä¹ˆæ··è¿›ç”Ÿäº§ç¯å¢ƒã€‚</p>
<p>PHP ä¸€ç›´å…è®¸è¿™ç§é£æ ¼çš„å¤±è¯¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">doSomethingImportant</span>(); <span class="hljs-comment">// è¿”å›äº†ä¸€ä¸ªå€¼â€¦â€¦ä½†æ²¡äººç”¨</span>
</code></pre>
<p>PHP 8.5 æ–°å¢äº†ä¸€ç§åŸç”Ÿæ–¹å¼æ¥æ ‡è®°è¿™ç±»æƒ…å†µï¼š<code>#[\NoDiscard]</code>ã€‚</p>
<p>ç»™å‡½æ•°æˆ–æ–¹æ³•åŠ ä¸Š <code>#[\NoDiscard]</code>ï¼Œè°ƒç”¨æ–¹è¦æ˜¯ä¸ç”¨è¿”å›å€¼ï¼ŒPHP å°±ä¼šå‘è­¦å‘Šã€‚å¯ä»¥æŠŠå®ƒç†è§£ä¸º"ç¼–è¯‘å™¨çº§åˆ«çš„æç¤º"ï¼ˆå®é™…ç”±å¼•æ“åœ¨è¿è¡Œæ—¶/ç¼–è¯‘æ—¶æ‰§è¡Œï¼‰ï¼Œä¸æŠ›å¼‚å¸¸ã€ä¸æ”¹è¡Œä¸ºï¼Œåªæ˜¯è®© API æ›´å®‰å…¨ã€‚</p>
<p>æœ¬æ–‡è®²çš„æ˜¯æ€ä¹ˆç”¨å¥½ <code>#[\NoDiscard]</code>ï¼š</p>
<ul>
<li>å®ƒèƒ½é˜²å“ªäº› bug</li>
<li>å…·ä½“è¯­ä¹‰ï¼ˆä»€ä¹ˆç®—"ç”¨äº†"è¿”å›å€¼ï¼‰</li>
<li>é«˜ä»·å€¼æ¨¡å¼ï¼šResult / Eitherã€ä¸å¯å˜æ„å»ºå™¨</li>
<li>æ€ä¹ˆæ¨å¹¿æ‰ä¸ä¼šè®©å›¢é˜Ÿåæ„Ÿ</li>
<li>ä»€ä¹ˆæ—¶å€™åˆ«ç”¨ï¼ˆè¯¯æŠ¥ç¡®å®å­˜åœ¨ï¼‰</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Fphp85-nodiscard-catch-ignored-return-value-bugs" target="_blank" title="https://catchadmin.com/post/2026-01/php85-nodiscard-catch-ignored-return-value-bugs" ref="nofollow noopener noreferrer">åŸæ–‡ PHP 8.5 #[\NoDiscard] æªå‡º"å¿½ç•¥è¿”å›å€¼"çš„ Bug</a></p>
<h3 data-id="heading-1">å¸¸è§"æƒ¯çŠ¯"ï¼šè¿”å›å€¼è¢«å¿½ç•¥çš„å‡ ç§åœºæ™¯</h3>
<p>PHP ä»£ç åº“é‡Œæœ‰å‡ ä¸ªå¸¸è§çš„"æƒ¯çŠ¯"ã€‚</p>
<h4 data-id="heading-2">è¿”å›å¸ƒå°”å€¼ï¼Œé»˜è®¤å®ƒæ€»æ˜¯æˆåŠŸ</h4>
<p>å…¸å‹æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$ok</span> = <span class="hljs-title function_ invoke__">rename</span>(<span class="hljs-variable">$tmpFile</span>, <span class="hljs-variable">$finalFile</span>);
</code></pre>
<p>æœ‰äººé‡æ„ï¼Œèµ‹å€¼æ²¡äº†ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">rename</span>(<span class="hljs-variable">$tmpFile</span>, <span class="hljs-variable">$finalFile</span>);
<span class="hljs-comment">// ç»§ç»­è·‘ï¼Œå½“ä½œç§»åŠ¨æˆåŠŸäº†</span>
</code></pre>
<p>å¼€å‘ç¯å¢ƒæ²¡äº‹ã€‚ç”Ÿäº§ç¯å¢ƒç¢°ä¸Šæƒé™è¾¹ç•Œæƒ…å†µï¼Œä½ è¯»çš„æ–‡ä»¶å‹æ ¹æ²¡ç§»åŠ¨è¿‡ã€‚</p>
<p>ä¸æ˜¯æ¯ä¸ªè¿”å›å¸ƒå°”å€¼çš„å‡½æ•°éƒ½è¯¥æ ‡ <code>#[\NoDiscard]</code>ã€‚ä½†ä½ è‡ªå·±çš„ API é‡Œï¼Œå¦‚æœè¿”å›å€¼æœ‰æ„ä¹‰ï¼Œå¿½ç•¥å®ƒè‡³å°‘è¯¥å¼•èµ·è­¦è§‰ã€‚</p>
<h4 data-id="heading-3">è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œä½†æ­£å¸¸è·¯å¾„å¤ªå¸¸è§ï¼Œå¤±è´¥æ²¡äººæ³¨æ„</h4>
<p>æ‰¹å¤„ç†æ˜¯é‡ç¾åŒºï¼š99.9% æˆåŠŸï¼Œå¿½ç•¥è¿”å›å€¼ä¸ä¼šç ´åå¤§å¤šæ•°è¿è¡Œã€‚</p>
<p>å…¸å‹åœºæ™¯ï¼š</p>
<ul>
<li>å‡½æ•°å¤„ç†å¤šä¸ªæ¡ç›®</li>
<li>è¿”å›æ¯ä¸ªæ¡ç›®çš„é”™è¯¯è¯¦æƒ…</li>
<li>å‰¯ä½œç”¨ç…§å¸¸å‘ç”Ÿ</li>
<li>å¿½ç•¥è¿”å›å€¼ = éƒ¨åˆ†å¤±è´¥è¢«è—èµ·æ¥äº†</li>
</ul>
<p>å®˜æ–¹ RFC å°±æ˜¯ç”¨è¿™ä¸ªé€»è¾‘æ¥è§£é‡Š <code>#[\NoDiscard]</code> çš„è®¾è®¡åŠ¨æœºã€‚</p>
<h4 data-id="heading-4">ä¸å¯å˜ API è¿”å›æ–°å®ä¾‹ï¼Œè°ƒç”¨å´åƒåœ¨åŸåœ°æ”¹</h4>
<p>è¿™ç§æƒ…å†µå¾ˆå¾®å¦™ï¼Œä»å¯å˜å¯¹è±¡è¿ç§»åˆ°ä¸å¯å˜å¯¹è±¡æ—¶ç‰¹åˆ«å¸¸è§ã€‚</p>
<p>ä½ å†™äº†ä¸ªä¸å¯å˜çš„"æ›´æ–°"æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$user</span> = <span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">withEmail</span>(<span class="hljs-variable">$newEmail</span>);
</code></pre>
<p>åæ¥æœ‰äººå†™æˆï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">withEmail</span>(<span class="hljs-variable">$newEmail</span>);
<span class="hljs-comment">// ä»¥ä¸º $user å˜äº†â€¦â€¦å…¶å®æ²¡å˜</span>
</code></pre>
<p>æ²¡æŠ¥é”™ï¼Œæ²¡å¼‚å¸¸ï¼ŒçŠ¶æ€å°±æ˜¯é™æ‚„æ‚„åœ°æ²¡å˜ã€‚</p>
<p>RFC æ˜ç¡®æåˆ° <code>DateTimeImmutable::set*()</code> å°±æ˜¯å…¸å‹ï¼š"å¬èµ·æ¥åƒåŸåœ°ä¿®æ”¹ï¼Œå®é™…è¿”å›æ–°å®ä¾‹"ã€‚</p>
<h4 data-id="heading-5">è¿”å› Result å¯¹è±¡ï¼Œä½†å¿˜äº†è§£åŒ…æ£€æŸ¥</h4>
<p>å¦‚æœä½ ç”¨ Result ç±»å‹ï¼ˆæˆ– Eitherï¼‰æ¥é¿å…å¼‚å¸¸ï¼Œå¿½ç•¥è¿”å›å€¼åŸºæœ¬å°±æ˜¯å¿½ç•¥äº†é”™è¯¯ã€‚</p>
<p>ä¸ä¸€å®šé©¬ä¸Šå‡ºé—®é¢˜â€”â€”ä½†é”™è¯¯å¤„ç†è¢«æ¨åˆ°äº†"ä»¥åå†è¯´"ï¼Œè€Œ"ä»¥å"å¾€å¾€ç­‰äº"æ°¸è¿œä¸"ã€‚</p>
<h3 data-id="heading-6">#[\NoDiscard] æ˜¯ä»€ä¹ˆ</h3>
<p>ç®€å•è¯´ï¼Œ<code>#[\NoDiscard]</code> æ˜¯åŠ åœ¨å‡½æ•°å’Œæ–¹æ³•ä¸Šçš„å±æ€§ï¼Œæ„æ€æ˜¯ï¼š</p>
<p><strong>"è°ƒç”¨äº†å´ä¸ç”¨è¿”å›å€¼ï¼Ÿå¤šåŠæ˜¯ bugã€‚"</strong></p>
<p>æœ€ç®€ç”¨æ³•ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">#[\NoDiscard</span><span class="hljs-meta">]</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSession</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">16</span>));
}

<span class="hljs-title function_ invoke__">createSession</span>(); <span class="hljs-comment">// PHP 8.5 ä¸­ä¼šäº§ç”Ÿè­¦å‘Š</span>
</code></pre>
<p>RFC å’Œ PHP æ‰‹å†Œé‡Œå®šä¹‰äº†å…·ä½“è¡Œä¸ºï¼š</p>
<ul>
<li>è°ƒç”¨ <code>#[\NoDiscard]</code> å‡½æ•°ä½†æ²¡ç”¨è¿”å›å€¼ï¼ŒPHP å‘è­¦å‘Š</li>
<li>å†…ç½®å‡½æ•°å‘ <code>E_WARNING</code>ï¼›ç”¨æˆ·å®šä¹‰å‡½æ•°å‘ <code>E_USER_WARNING</code></li>
<li>å¯ä»¥å¸¦æ¶ˆæ¯ï¼š<code>#[\NoDiscard("â€¦")]</code>ï¼Œæ¶ˆæ¯ä¼šå‡ºç°åœ¨è­¦å‘Šé‡Œï¼ˆè·Ÿ <code>#[Deprecated]</code> ç±»ä¼¼ï¼‰</li>
</ul>
<h4 data-id="heading-7">ä»€ä¹ˆç®—"ç”¨äº†"ï¼Ÿ</h4>
<p>æœ€å…³é”®çš„ç»†èŠ‚ï¼š"ç”¨äº†"æ˜¯è¯­æ³•å±‚é¢çš„åˆ¤æ–­ï¼Œä¸æ˜¯è¯­ä¹‰å±‚é¢çš„ã€‚</p>
<p>RFC å¯¹"ç”¨äº†è¿”å›å€¼"çš„å®šä¹‰å¾ˆå®½æ¾ï¼šè¿”å›å€¼åªè¦æˆä¸ºä»»æ„è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†å°±è¡Œã€‚èµ‹å€¼ç»™å˜é‡â€”â€”å“ªæ€•æ˜¯ä¸ªå“‘å˜é‡â€”â€”ç®—ã€‚ç±»å‹è½¬æ¢ä¹Ÿç®—ã€‚</p>
<p>æ‰€ä»¥ä¸‹é¢è¿™äº›éƒ½ç®—"ç”¨äº†"ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$unusedButAssigned</span> = <span class="hljs-title function_ invoke__">createSession</span>(); <span class="hljs-comment">// æ— è­¦å‘Š</span>
(<span class="hljs-keyword">bool</span>) <span class="hljs-title function_ invoke__">createSession</span>();               <span class="hljs-comment">// æ— è­¦å‘Šï¼ˆä½†è§ä¸‹é¢å…³äº OPcache çš„è¯´æ˜ï¼‰</span>
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ <code>#[\NoDiscard]</code> ä¸ä¿è¯è¡Œä¸ºæ­£ç¡®ï¼Œåªä¿è¯ä½ æ²¡æŠŠç»“æœç›´æ¥æ‰”åœ°ä¸Šã€‚</p>
<h4 data-id="heading-8">(void) å¼ºåˆ¶è½¬æ¢ï¼šæ˜¾å¼ä¸¢å¼ƒ</h4>
<p>PHP 8.5 è¿˜å¼•å…¥äº† <code>(void)</code> å¼ºåˆ¶è½¬æ¢ï¼š</p>
<pre><code class="hljs language-php" lang="php">(<span class="hljs-keyword">void</span>) <span class="hljs-title function_ invoke__">createSession</span>(); <span class="hljs-comment">// æ— è­¦å‘Š</span>
</code></pre>
<p>æ²¡æœ‰è¿è¡Œæ—¶æ•ˆæœï¼Œçº¯ç²¹è¡¨æ˜æ„å›¾ï¼š"æ˜¯çš„ï¼Œæˆ‘æ•…æ„ä¸ç”¨å®ƒã€‚"å¯ä»¥ç”¨æ¥æŠ‘åˆ¶ <code>#[\NoDiscard]</code> è­¦å‘Šï¼ŒIDE å’Œé™æ€åˆ†æå·¥å…·ä¹Ÿèƒ½è¯†åˆ«ã€‚</p>
<p>RFC é‡Œæœ‰ä¸ªç»†èŠ‚ï¼š<code>(void)</code> æ˜¯è¯­å¥ä¸æ˜¯è¡¨è¾¾å¼ï¼Œä¸èƒ½åµŒåˆ°å…¶ä»–è¡¨è¾¾å¼é‡Œï¼Œå¦åˆ™è¯­æ³•é”™è¯¯ã€‚</p>
<h4 data-id="heading-9">ä½¿ç”¨çº¦æŸ</h4>
<p>RFC è§„å®šè¿™äº›æƒ…å†µä¼šç¼–è¯‘æŠ¥é”™ï¼š</p>
<ul>
<li>è¿”å›ç±»å‹æ˜¯ <code>: void</code> æˆ– <code>: never</code> çš„å‡½æ•°</li>
<li>å¿…é¡»æ˜¯ void / æ— è¿”å›çš„é­”æœ¯æ–¹æ³•ï¼ˆ<code>__construct</code>ã€<code>__clone</code> ç­‰ï¼‰</li>
<li>å±æ€§é’©å­</li>
</ul>
<p>æ‰€ä»¥è¿™æ ·å†™ä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">#[\NoDiscard</span><span class="hljs-meta">]</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logSomething</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$msg</span></span>): <span class="hljs-title">void</span> </span>{
    <span class="hljs-title function_ invoke__">error_log</span>(<span class="hljs-variable">$msg</span>);
}
<span class="hljs-comment">// Fatal: void å‡½æ•°ä¸è¿”å›å€¼ï¼Œä½† #[\NoDiscard] è¦æ±‚æœ‰è¿”å›å€¼</span>
</code></pre>
<p>è¿™æ˜¯æ•…æ„çš„ï¼šæ²¡ä¸œè¥¿å¯ä¸¢å¼ƒï¼Œè¿™ä¸ªå±æ€§å°±æ²¡æ„ä¹‰ã€‚</p>
<h4 data-id="heading-10">é”è¾¹ï¼šè­¦å‘Šå¯èƒ½å˜è‡´å‘½é”™è¯¯</h4>
<p>å¤§å¤šæ•°å›¢é˜ŸæŠŠè­¦å‘Šå½“å™ªéŸ³ã€‚æœ‰äº›å›¢é˜ŸæŠŠè­¦å‘Šè½¬æˆå¼‚å¸¸ï¼ˆä¸¥æ ¼ç¯å¢ƒé‡Œå¸¸è§ï¼‰ã€‚</p>
<p>RFC æŒ‡å‡ºï¼Œå¼•æ“åœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼ˆå‚æ•°æ±‚å€¼ä¹‹åï¼‰å°±éªŒè¯"è¿”å›å€¼æœ‰æ²¡æœ‰è¢«ç”¨"ã€‚å¦‚æœä½ é…äº†ä¸ªä¼šæŠ›å¼‚å¸¸çš„é”™è¯¯å¤„ç†å™¨ï¼Œè­¦å‘Šä¸€è§¦å‘å°±æŠ›å¼‚å¸¸ï¼Œå‡½æ•°å‹æ ¹ä¸ä¼šè¢«è°ƒç”¨â€”â€”RFC æŠŠè¿™å«"fail-closed"è¡Œä¸ºã€‚</p>
<p>å¯¹ <code>#[\NoDiscard]</code> å‡½æ•°æ¥è¯´ï¼Œè¿™é€šå¸¸æ˜¯å¥½äº‹ï¼ˆå¿½ç•¥è¿”å›å€¼æœ¬æ¥å°±ä¸å®‰å…¨ï¼‰ï¼Œä½†å¦‚æœå‡½æ•°æœ‰é‡è¦å‰¯ä½œç”¨ï¼Œä½ å¾—å¿ƒé‡Œæœ‰æ•°ã€‚</p>
<h3 data-id="heading-11">å®ç”¨ç¤ºä¾‹</h3>
<p>çœ‹çœ‹å®é™…æ€ä¹ˆç”¨ã€‚ä¸‹é¢è¿™äº›æ¨¡å¼æ˜¯ <code>#[\NoDiscard]</code> çœŸæ­£èƒ½å‘æŒ¥ä»·å€¼çš„åœ°æ–¹ã€‚</p>
<h4 data-id="heading-12">Result ç±»å‹</h4>
<p>ä¸€ä¸ªæœ€å°åŒ–çš„ Result å®ç°ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);

<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Result</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-variable">$ok</span>,
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$value</span>,
        <span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$error</span>,
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ok</span>(<span class="hljs-params"><span class="hljs-keyword">mixed</span> <span class="hljs-variable">$value</span> = <span class="hljs-literal">null</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(<span class="hljs-literal">true</span>, <span class="hljs-variable">$value</span>, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">err</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$error</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(<span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>, <span class="hljs-variable">$error</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isOk</span>(<span class="hljs-params"/>): <span class="hljs-title">bool</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;ok; }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isErr</span>(<span class="hljs-params"/>): <span class="hljs-title">bool</span> </span>{ <span class="hljs-keyword">return</span> !<span class="hljs-variable language_">$this</span>-&gt;ok; }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unwrap</span>(<span class="hljs-params"/>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">$this</span>-&gt;ok) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-variable language_">$this</span>-&gt;error ?? <span class="hljs-string">'Unknown error'</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;value;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span>(<span class="hljs-params"/>): ?<span class="hljs-title">string</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;error; }
}
</code></pre>
<p>å‡è®¾æœ‰ä¸ªéªŒè¯å‡½æ•°è¿”å› Resultï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">#[\NoDiscard</span>(<span class="hljs-string">"Validation results must be handled (ok/err)"</span>)<span class="hljs-meta">]</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateUsername</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span></span>): <span class="hljs-title">Result</span>
</span>{
    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$name</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$name</span> === <span class="hljs-string">''</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Result</span>::<span class="hljs-title function_ invoke__">err</span>(<span class="hljs-string">"Username cannot be empty."</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$name</span>) &lt; <span class="hljs-number">3</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Result</span>::<span class="hljs-title function_ invoke__">err</span>(<span class="hljs-string">"Username is too short."</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Result</span>::<span class="hljs-title function_ invoke__">ok</span>(<span class="hljs-variable">$name</span>);
}
</code></pre>
<p>è¿™æ ·è°ƒç”¨ä¼šè§¦å‘è­¦å‘Šï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">validateUsername</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'username'</span>] ?? <span class="hljs-string">''</span>);
</code></pre>
<p>è¿™å°±æ˜¯ä½ æƒ³è¦çš„æ•ˆæœï¼šç”¨äº† Result æ¨¡å¼ï¼Œå¿½ç•¥å®ƒå‡ ä¹è‚¯å®šæ˜¯å†™é”™äº†ã€‚</p>
<p>æ­£ç¡®çš„å†™æ³•å˜æˆæ˜¾å¼çš„ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">validateUsername</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'username'</span>] ?? <span class="hljs-string">''</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$res</span>-&gt;<span class="hljs-title function_ invoke__">isErr</span>()) {
    <span class="hljs-title function_ invoke__">http_response_code</span>(<span class="hljs-number">422</span>);
    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$res</span>-&gt;<span class="hljs-title function_ invoke__">error</span>();
    <span class="hljs-keyword">exit</span>;
}
<span class="hljs-variable">$username</span> = <span class="hljs-variable">$res</span>-&gt;<span class="hljs-title function_ invoke__">unwrap</span>();
</code></pre>
<p>å¼€å‘è€…è¿˜èƒ½å†™ <code>$_ = validateUsername(...)</code> ç„¶åä¸ç®¡å®ƒå—ï¼Ÿèƒ½ï¼ŒPHP ä¼šè®¤ä¸º"ç”¨äº†"ã€‚ä½†ä¸»è¦çš„å¤±è´¥æ¨¡å¼â€”â€”ä¸å°å¿ƒå†™äº†è£¸è°ƒç”¨â€”â€”è¢«æ‹¦ä½äº†ã€‚</p>
<h4 data-id="heading-13">Either é£æ ¼</h4>
<p>æœ‰äº›å›¢é˜Ÿå–œæ¬¢æ›´ç»“æ„åŒ–çš„é”™è¯¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidationError</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$code</span>, <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span></span>) </span>{}
}

<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Either</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> <span class="hljs-variable">$isRight</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$right</span>,
        <span class="hljs-keyword">public</span> ?ValidationError <span class="hljs-variable">$left</span>,
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">right</span>(<span class="hljs-params"><span class="hljs-keyword">mixed</span> <span class="hljs-variable">$value</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(<span class="hljs-literal">true</span>, <span class="hljs-variable">$value</span>, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">left</span>(<span class="hljs-params">ValidationError <span class="hljs-variable">$err</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(<span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>, <span class="hljs-variable">$err</span>);
    }
}
</code></pre>
<p>è¿”å› Either çš„å‡½æ•°æ ‡ <code>#[\NoDiscard]</code> é€šå¸¸æ²¡é—®é¢˜ï¼Œå› ä¸ºæœ¬æ¥å°±æ˜¯è¦å¼ºåˆ¶è°ƒç”¨æ–¹å†³å®šèµ°å“ªä¸ªåˆ†æ”¯ã€‚</p>
<h4 data-id="heading-14">ä¸å¯å˜æ„å»ºå™¨</h4>
<p>å‡è®¾æœ‰ä¸ªä¸å¯å˜æ„å»ºå™¨ï¼Œæ¯ä¸ªæ–¹æ³•è¿”å›æ–°çš„æ„å»ºå™¨ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);

<span class="hljs-keyword">final</span> <span class="hljs-keyword">readonly</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InvoiceBuilder</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$lines</span> = [],
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$totalCents</span> = <span class="hljs-number">0</span>,
    </span>) </span>{}

    <span class="hljs-meta">#[\NoDiscard</span>(<span class="hljs-string">"InvoiceBuilder is immutable; you must capture the returned builder."</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withLine</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$label</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$amountCents</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$amountCents</span> &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'amountCents must be &gt;= 0'</span>);
        }
        <span class="hljs-variable">$newLines</span> = <span class="hljs-variable language_">$this</span>-&gt;lines;
        <span class="hljs-variable">$newLines</span>[] = [<span class="hljs-string">'label'</span> =&gt; <span class="hljs-variable">$label</span>, <span class="hljs-string">'amountCents'</span> =&gt; <span class="hljs-variable">$amountCents</span>];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(
            lines: <span class="hljs-variable">$newLines</span>,
            totalCents: <span class="hljs-variable language_">$this</span>-&gt;totalCents + <span class="hljs-variable">$amountCents</span>
        );
    }

    <span class="hljs-meta">#[\NoDiscard</span>(<span class="hljs-string">"Calling build() without using the invoice is almost certainly a bug."</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">build</span>(<span class="hljs-params"/>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'lines'</span> =&gt; <span class="hljs-variable language_">$this</span>-&gt;lines,
            <span class="hljs-string">'totalCents'</span> =&gt; <span class="hljs-variable language_">$this</span>-&gt;totalCents,
        ];
    }
}
</code></pre>
<p>çœ‹çœ‹å…¸å‹é”™è¯¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$builder</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvoiceBuilder</span>();
<span class="hljs-variable">$builder</span>-&gt;<span class="hljs-title function_ invoke__">withLine</span>(<span class="hljs-string">'Subscription'</span>, <span class="hljs-number">1500</span>);
<span class="hljs-variable">$builder</span>-&gt;<span class="hljs-title function_ invoke__">withLine</span>(<span class="hljs-string">'Support'</span>, <span class="hljs-number">500</span>);
<span class="hljs-variable">$invoice</span> = <span class="hljs-variable">$builder</span>-&gt;<span class="hljs-title function_ invoke__">build</span>();
</code></pre>
<p>æ²¡æœ‰ <code>#[\NoDiscard]</code>ï¼Œè¿™ä¼šäº§ç”Ÿä¸€å¼ æ²¡æœ‰è¡Œé¡¹ç›®çš„å‘ç¥¨ï¼Œå› ä¸ºè¿”å›çš„æ„å»ºå™¨è¢«æ‰”æ‰äº†ã€‚</p>
<p>åŠ ä¸Š <code>#[\NoDiscard]</code>ï¼Œæ¯ä¸ªè¢«å¿½ç•¥çš„ <code>withLine()</code> è¿”å›éƒ½ä¼šè§¦å‘è­¦å‘Šï¼Œé€¼ä½ å†™å¯¹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$builder</span> = (<span class="hljs-keyword">new</span> <span class="hljs-title class_">InvoiceBuilder</span>())
    -&gt;<span class="hljs-title function_ invoke__">withLine</span>(<span class="hljs-string">'Subscription'</span>, <span class="hljs-number">1500</span>)
    -&gt;<span class="hljs-title function_ invoke__">withLine</span>(<span class="hljs-string">'Support'</span>, <span class="hljs-number">500</span>);
<span class="hljs-variable">$invoice</span> = <span class="hljs-variable">$builder</span>-&gt;<span class="hljs-title function_ invoke__">build</span>();
</code></pre>
<p>è¿™å°±æ˜¯ <code>#[\NoDiscard]</code> è¦æªå‡ºæ¥çš„ bugï¼šå®¹æ˜“çŠ¯ã€æµ‹è¯•å¸¸èƒ½è¿‡ã€ç”Ÿäº§ç¯å¢ƒè®©äººå¤´ç–¼ã€‚</p>
<h4 data-id="heading-15">PHP è‡ªå·±ä¹Ÿåœ¨ç”¨</h4>
<p>RFC ç»™ä¸€å°éƒ¨åˆ†åŸç”Ÿ API åŠ äº† <code>#[\NoDiscard]</code>ï¼Œè¿™äº› API å¿½ç•¥ç»“æœå®¹æ˜“å‡ºéšè”½é—®é¢˜ï¼š</p>
<ul>
<li><code>flock()</code>ï¼ˆå¿½ç•¥é”å®šå¤±è´¥ï¼Œç«äº‰æ¡ä»¶ä¸‹å¯èƒ½æ•°æ®æŸåï¼‰</li>
<li><code>DateTimeImmutable::set*()</code>ï¼ˆä»å¯å˜ DateTime è¿ç§»è¿‡æ¥æ—¶çš„å¸¸è§å‘ï¼‰</li>
</ul>
<p>å°±ç®—ä½ ä»ä¸ç›´æ¥ç”¨è¿™äº›å‡½æ•°ï¼Œè¿™ä¹Ÿè¯´æ˜ä¸€ä»¶äº‹ï¼šè¿™ä¸ªç‰¹æ€§é’ˆå¯¹çš„æ˜¯çœŸå®åœºæ™¯é‡Œçš„é”™è¯¯ï¼Œä¸æ˜¯ä¸ºäº†ç†è®ºä¸Šçš„"çº¯ç²¹"ã€‚</p>
<h3 data-id="heading-16">é‡‡ç”¨ç­–ç•¥</h3>
<p>åˆ°å¤„åŠ  <code>#[\NoDiscard]</code> åªä¼šåˆ¶é€ å™ªéŸ³ï¼Œå›¢é˜Ÿè¿Ÿæ—©ä¹ æƒ¯æ€§å¿½ç•¥ã€‚RFC çš„å»ºè®®æ˜¯ï¼šåªåœ¨å¿½ç•¥è¿”å›å€¼å¯èƒ½æ˜¯æ— æ„çš„ã€ä¸”ä¼šå¯¼è‡´æµ‹è¯•æœŸé—´éš¾ä»¥å‘ç°çš„ bug çš„åœ°æ–¹ç”¨ã€‚</p>
<p>åŠ¡å®çš„æ¨å¹¿æ€è·¯ï¼š</p>
<h4 data-id="heading-17">ä»å±é™©çš„åœ°æ–¹å¼€å§‹</h4>
<p>é«˜ä»·å€¼åœºæ™¯ï¼š</p>
<ul>
<li>å¯èƒ½éƒ¨åˆ†å¤±è´¥ä½†ç»§ç»­æ‰§è¡Œçš„é¢†åŸŸæ“ä½œï¼ˆæ‰¹å¤„ç†ï¼‰</li>
<li>è¿”å› Result / é”™è¯¯åˆ—è¡¨çš„æŒä¹…åŒ–è°ƒç”¨</li>
<li>ä¸å¯å˜æ›´æ–°æ–¹æ³•ï¼ˆä¸å¯å˜å¯¹è±¡ä¸Šçš„ <code>with*</code>ã€<code>set*</code>ï¼‰</li>
<li>ç”¨è¿”å›å€¼è¡¨ç¤ºå¤±è´¥çš„ "try" é£æ ¼ API</li>
</ul>
<p>ä½ä»·å€¼åœºæ™¯ï¼š</p>
<ul>
<li>çº¯å‡½æ•°ï¼ˆå¦‚ <code>str_contains()</code> è¿™ç±»æ£€æŸ¥ï¼‰ï¼šè°ƒç”¨åä»€ä¹ˆéƒ½ä¸åšæœ¬æ¥å°±å¥‡æ€ªï¼Œå¿½ç•¥è¿”å›å€¼å¾ˆå°‘é€ æˆéšè”½é—®é¢˜ã€‚RFC æ‹¿ <code>str_contains()</code> å½“åé¢ä¾‹å­</li>
<li>ä¸»è¦é å‰¯ä½œç”¨ã€è¿”å›å€¼åªæ˜¯é¡ºä¾¿ç»™çš„æ–¹æ³•</li>
</ul>
<h4 data-id="heading-18">è®©è­¦å‘Šå¯è§ï¼Œä½†åˆ«ç‚¸ç”Ÿäº§</h4>
<p>å¼•æ“å‘çš„æ˜¯è­¦å‘Šï¼ˆä¸æ˜¯å¼‚å¸¸ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥é€æ­¥æ”¶ç´§ï¼š</p>
<ul>
<li>å¼€å‘ç¯å¢ƒï¼šæŠŠè­¦å‘Šå–Šå‡ºæ¥</li>
<li>CIï¼šæŠŠ <code>E_USER_WARNING</code> å½“å¤±è´¥ï¼ˆå¯é€‰ï¼Œè¿‡æ¸¡ä¸€æ®µæ—¶é—´åï¼‰</li>
<li>ç”Ÿäº§ç¯å¢ƒï¼šä¿æŒé»˜è®¤ï¼Œé™¤éä½ ç¡®å®šè­¦å‘Šç­–ç•¥å¤Ÿä¸¥æ ¼</li>
</ul>
<p>è®°ä½ï¼šå¦‚æœä½ ä»¬æŠŠè­¦å‘Šè½¬æˆå¼‚å¸¸ï¼Œ<code>#[\NoDiscard]</code> ä¼šç›´æ¥é˜»æ­¢å‡½æ•°è¿è¡Œï¼ˆfail-closedï¼‰ã€‚æœ‰æ—¶å€™è¿™æ˜¯å¥½äº‹ï¼Œä½†è¿™ç§è¡Œä¸ºå˜åŒ–å¾—æœ‰æ„è¯†åœ°å¼•å…¥ã€‚</p>
<h3 data-id="heading-19">ä»£ç å®¡æŸ¥é›†æˆ</h3>
<p><code>#[\NoDiscard]</code> ç”¨æ¥å¼ºåŒ–å›¢é˜Ÿè§„åˆ™æ•ˆæœæœ€å¥½ï¼Œä¸æ˜¯ç”¨æ¥ä»£æ›¿æ€è€ƒçš„ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€å¥—è·Ÿä»£ç å®¡æŸ¥é…åˆè‰¯å¥½çš„ç®€å•è§„åˆ™ï¼š</p>
<h4 data-id="heading-20">æŠŠè­¦å‘Šå½“è®¾è®¡ä¿¡å·</h4>
<p>çœ‹åˆ° <code>#[\NoDiscard]</code> è­¦å‘Šï¼Œåˆ«æ€¥ç€"æ¶ˆæ‰å®ƒ"ã€‚å…ˆé—®ï¼š</p>
<ul>
<li>æ˜¯ä¸å°å¿ƒå¿½ç•¥çš„å—ï¼Ÿï¼ˆæœ€å¸¸è§ï¼‰</li>
<li>å¦‚æœç¡®å®æƒ³å¿½ç•¥ï¼Œç”¨ <code>(void)</code> åˆé€‚å—ï¼Ÿ</li>
<li>è¿˜æ˜¯è¯´ API è¿”å›çš„ä¸œè¥¿æœ¬èº«å°±æœ‰é—®é¢˜ï¼Ÿ</li>
</ul>
<h4 data-id="heading-21">ç”¨ (void) è¡¨æ˜æ„å›¾</h4>
<p>æ¯”å¦‚ï¼šè°ƒç”¨ä¸€ä¸ªè¿”å›ç¼“å­˜é”®çš„æ–¹æ³•ï¼Œä½†ä½ åªè¦å‰¯ä½œç”¨ï¼š</p>
<pre><code class="hljs language-php" lang="php">(<span class="hljs-keyword">void</span>) <span class="hljs-variable">$cache</span>-&gt;<span class="hljs-title function_ invoke__">warmUp</span>(<span class="hljs-variable">$userId</span>);
</code></pre>
<p>è¿™æ˜¯å¹²å‡€ã€å¯è¯»çš„çº¦å®šï¼šæˆ‘æ•…æ„ä¸¢å¼ƒè¿™ä¸ªå€¼ã€‚</p>
<p>æ¯”ä¸‹é¢è¿™ç§å†™æ³•å¼ºå¤šäº†ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$unused</span> = <span class="hljs-variable">$cache</span>-&gt;<span class="hljs-title function_ invoke__">warmUp</span>(<span class="hljs-variable">$userId</span>);
</code></pre>
<p>å› ä¸º <code>$unused</code> é‡æ„åå¾ˆå®¹æ˜“ç•™ä¸‹æ¥ï¼Œè®©åé¢çš„äººæ‘¸ä¸ç€å¤´è„‘ã€‚</p>
<h4 data-id="heading-22">è·Ÿé™æ€åˆ†æé…åˆ</h4>
<p>é™æ€åˆ†æå™¨å’Œ IDE æœ¬æ¥å°±ä¼šå¯¹çº¯å‡½æ•°çš„æœªä½¿ç”¨è¿”å›å€¼æŠ¥è­¦ã€‚RFC æåˆ°ï¼ŒPHPStormã€PHPStanã€Psalm è¿™äº›å·¥å…·å·²ç»èƒ½æŠ“"çº¯è¿”å›å€¼è¢«å¿½ç•¥"çš„é—®é¢˜ï¼ˆæ¯”å¦‚ DateTimeImmutable çš„å‘ï¼‰ï¼Œä½†å®ƒä»¬ä¸€èˆ¬æ²¡æ³•è¦†ç›–éçº¯å‡½æ•°çš„é‡è¦è¿”å›å€¼â€”â€”<code>#[\NoDiscard]</code> å¡«çš„å°±æ˜¯è¿™ä¸ªç©ºç™½ã€‚</p>
<p>æ‰€ä»¥ç»„åˆèµ·æ¥æ˜¯è¿™æ ·ï¼š</p>
<ul>
<li>é™æ€åˆ†æå™¨ï¼š"çº¯è¿”å›å€¼æ²¡ç”¨"</li>
<li><code>#[\NoDiscard]</code>ï¼š"é‡è¦è¿”å›å€¼æ²¡ç”¨"ï¼ˆå“ªæ€•æ˜¯éçº¯çš„ï¼‰</li>
</ul>
<h3 data-id="heading-23">é‡æ„ç¤ºä¾‹</h3>
<p>åšä¸ªè´´è¿‘çœŸå®åœºæ™¯çš„é‡æ„ï¼šä¸€ä¸ª"ä¿å­˜"å¹¶è¿”å›çŠ¶æ€çš„æ–¹æ³•ã€‚</p>
<h4 data-id="heading-24">ä¹‹å‰</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRepository</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params">User <span class="hljs-variable">$user</span></span>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-comment">// ... å†™å…¥æ•°æ®åº“ ...</span>
        <span class="hljs-comment">// å†²çª/å¤±è´¥æ—¶è¿”å› false</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<p>è°ƒç”¨ç‚¹å¾€å¾€å˜æˆï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$repo</span>-&gt;<span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$user</span>);
<span class="hljs-comment">// å½“ä½œä¿å­˜æˆåŠŸäº†</span>
</code></pre>
<p>å¦‚æœè¿”å›å€¼æœ‰æ„ä¹‰ï¼Œè¿™å°±æ˜¯åŸ‹ç€çš„é›·ã€‚</p>
<h4 data-id="heading-25">ä¹‹å</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRepository</span>
</span>{
    <span class="hljs-meta">#[\NoDiscard</span>(<span class="hljs-string">"Save may fail; handle the return value or explicitly discard it with (void)."</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params">User <span class="hljs-variable">$user</span></span>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-comment">// ... å†™å…¥æ•°æ®åº“ ...</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<p>ç°åœ¨ï¼Œå¿½ç•¥å®ƒçš„è°ƒç”¨ç‚¹éƒ½ä¼šæŠ¥è­¦å‘Šã€‚</p>
<h4 data-id="heading-26">æ›´å¥½çš„åšæ³•</h4>
<p>å¸ƒå°”å€¼æè¿°æ€§ä¸å¤Ÿã€‚èƒ½æ”¹å°±è¿”å› Resultï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRepository</span>
</span>{
    <span class="hljs-meta">#[\NoDiscard</span>(<span class="hljs-string">"Save may fail; callers must handle the Result."</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params">User <span class="hljs-variable">$user</span></span>): <span class="hljs-title">Result</span>
    </span>{
        <span class="hljs-comment">// ç¤ºä¾‹é€»è¾‘</span>
        <span class="hljs-variable">$ok</span> = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$ok</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Result</span>::<span class="hljs-title function_ invoke__">err</span>(<span class="hljs-string">"Write failed due to conflict."</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Result</span>::<span class="hljs-title function_ invoke__">ok</span>(<span class="hljs-variable">$user</span>);
    }
}
</code></pre>
<p>ç°åœ¨æ›´éš¾ä¸å°å¿ƒè·³è¿‡é”™è¯¯å¤„ç†ï¼ŒAPI ä¹Ÿæ›´è‡ªæ–‡æ¡£åŒ–ã€‚</p>
<h4 data-id="heading-27">ç¡®å®æƒ³å¿½ç•¥æ—¶</h4>
<p>æœ‰äº›åœºæ™¯ç¡®å®è¦å¿½ç•¥ï¼š</p>
<ul>
<li>best-effort çš„ç¼“å­˜å†™å…¥</li>
<li>é¥æµ‹å‘é€</li>
<li>é¡ºæ‰‹æ¸…ç†</li>
</ul>
<p>è¿™æ—¶å€™ <code>(void)</code> æ­£åˆé€‚ï¼š</p>
<pre><code class="hljs language-php" lang="php">(<span class="hljs-keyword">void</span>) <span class="hljs-variable">$repo</span>-&gt;<span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$user</span>); <span class="hljs-comment">// "æˆ‘å°±æ˜¯ä¸æƒ³æ£€æŸ¥è¿™ä¸ªã€‚"</span>
</code></pre>
<p>ä»£ç å®¡æŸ¥çœ‹ç€æ¸…æ¥šï¼Œä¹Ÿèƒ½é˜²æ­¢æ— æ„ä¸­"é™é»˜å¿½ç•¥"åˆæ··å›æ¥ã€‚</p>
<h3 data-id="heading-28">é™åˆ¶å’Œè¯¯æŠ¥</h3>
<p><code>#[\NoDiscard]</code> å¾ˆå¼ºå¤§ï¼Œä½†ä¸æ˜¯é€šç”¨çš„"è´¨é‡å¾½ç« "ã€‚ç”¨å¤šäº†å°±æ˜¯å™ªéŸ³ï¼Œå™ªéŸ³ä¼šæ·¹æ²¡ä¿¡å·ã€‚</p>
<h4 data-id="heading-29">åˆ«ç”¨åœ¨æ— å®³çš„å‡½æ•°ä¸Š</h4>
<p>çº¯æŸ¥è¯¢æ¯”å¦‚ï¼š</p>
<ul>
<li><code>str_contains()</code></li>
<li><code>strlen()</code></li>
<li>å­—ç¬¦ä¸²è½¬æ¢è¾…åŠ©å‡½æ•°</li>
</ul>
<p>è°ƒç”¨äº†å´ä»€ä¹ˆéƒ½ä¸åšï¼Œbug æœ¬æ¥å°±å¾ˆæ˜æ˜¾ï¼šç®—äº†ä¸ªä¸œè¥¿æ²¡ç”¨ï¼Œè¿˜æ²¡å‰¯ä½œç”¨ã€‚RFC æ˜ç¡®è¯´ä¸è¦åœ¨ <code>str_contains()</code> è¿™ç±»å‡½æ•°ä¸Šç”¨ <code>#[\NoDiscard]</code>ï¼Œå› ä¸ºå¿½ç•¥ç»“æœæœ¬æ¥å°±ä¸å¤ªå¯èƒ½ï¼Œè€Œä¸”é™¤äº†æµªè´¹ç‚¹è®¡ç®—æ²¡å•¥åå¤„ã€‚</p>
<h4 data-id="heading-30">åˆ«ç”¨æ¥å¼ºåˆ¶ç¼–ç é£æ ¼</h4>
<p>ä½ ä¼šæƒ³ç»™å¾ˆå¤šæ–¹æ³•æ ‡ <code>#[\NoDiscard]</code>ï¼Œç†ç”±æ˜¯"è°ƒç”¨è€…æ€»æ˜¯æ¥è¿”å›å€¼æ›´å¹²å‡€"ã€‚è¿™æ˜¯é£æ ¼åå¥½ï¼Œä¸æ˜¯å®‰å…¨é—®é¢˜ã€‚</p>
<p>åªåœ¨å¿½ç•¥è¿”å›å€¼å¯èƒ½æ˜¯æ— æ„çš„ã€è€Œä¸”æœ‰å®³çš„åœ°æ–¹ç”¨ã€‚</p>
<h4 data-id="heading-31">æ³¨æ„"å‘å°„åä¸ç®¡"çš„ API</h4>
<p>æœ‰äº›æ–¹æ³•è¿”å›å€¼åªæ˜¯é¡ºä¾¿ç»™çš„ï¼Œä¸»è¦é å‰¯ä½œç”¨ã€‚ç»™å®ƒä»¬åŠ  <code>#[\NoDiscard]</code> ä¼šé€¼è°ƒç”¨è€…åˆ°å¤„å†™ <code>(void)</code>ï¼Œæ¢ä¸€ç§æ‚ä¹±è€Œå·²ã€‚</p>
<p>å¦‚æœä½ å‘ç°æŸä¸ªå‡½æ•°æœ‰ä¸€å † <code>(void)</code>ï¼Œè¯´æ˜å±æ€§å¯èƒ½åŠ é”™åœ°æ–¹äº†ã€‚</p>
<h4 data-id="heading-32">"ç”¨äº†"ä¸ç­‰äº"å¤„ç†äº†"</h4>
<p>å› ä¸º"ç”¨äº†"çš„å®šä¹‰å¾ˆå®½æ¾ï¼Œä½ å¯ä»¥æ»¡è¶³ <code>#[\NoDiscard]</code> ä½†å®é™…ä¸Šä»€ä¹ˆéƒ½æ²¡å¤„ç†ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$tmp</span> = <span class="hljs-variable">$repo</span>-&gt;<span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$user</span>); <span class="hljs-comment">// æ— è­¦å‘Šï¼Œä½†è¯­ä¹‰ä¸Šè¿˜æ˜¯å¿½ç•¥äº†</span>
</code></pre>
<p>è¿™ä¸æ˜¯ç‰¹æ€§çš„ç¼ºé™·â€”â€”å®ƒæé†’æˆ‘ä»¬ <code>#[\NoDiscard]</code> æ˜¯æŠ¤æ ï¼Œä¸æ˜¯å®Œæ•´çš„æ­£ç¡®æ€§è¯æ˜ã€‚</p>
<h3 data-id="heading-33">å›¢é˜Ÿå‘½åçº¦å®š</h3>
<p>å¥½å›¢é˜Ÿä¸ä¼šåªé å±æ€§ã€‚ä»–ä»¬ç”¨å‘½åçº¦å®šï¼Œåœ¨è­¦å‘Šå‡ºç°ä¹‹å‰å°±å¼•å¯¼æ­£ç¡®ç”¨æ³•ã€‚</p>
<p>ä¸‹é¢æ˜¯è·Ÿ <code>#[\NoDiscard]</code> é…åˆè‰¯å¥½çš„å‘½åçº¦å®šï¼š</p>
<h4 data-id="heading-34">with* ä¸å¯å˜æ›´æ–°</h4>
<p>å¦‚æœä½ çš„ç±»æ˜¯ä¸å¯å˜çš„ï¼š</p>
<ul>
<li><code>withEmail()</code></li>
<li><code>withStatus()</code></li>
<li><code>withTimeout()</code></li>
</ul>
<p>è¿™äº›æ–¹æ³•åŸºæœ¬éƒ½è¯¥æ ‡ <code>#[\NoDiscard]</code>ï¼Œå› ä¸ºå¿½ç•¥è¿”å›å€¼é€šå¸¸æ„å‘³ç€"å•¥ä¹Ÿæ²¡å˜"ã€‚</p>
<h4 data-id="heading-35">try* å¤±è´¥ç¼–ç åœ¨è¿”å›å€¼é‡Œ</h4>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li><code>tryLock() : bool</code></li>
<li><code>tryParse() : Result</code></li>
<li><code>tryConnect() : Result</code></li>
</ul>
<p>æ–¹æ³•åä»¥ try å¼€å¤´ï¼Œè°ƒç”¨è€…ä¸€èˆ¬ä¼šæœŸæœ›æ£€æŸ¥ç»“æœã€‚æ ‡ <code>#[\NoDiscard]</code> å¼ºåŒ–è¿™ä¸ªé¢„æœŸã€‚</p>
<h4 data-id="heading-36">build() / finalize() æ¨¡å¼</h4>
<p><code>build()</code> äº§ç”Ÿä½ è¦çš„ä¸œè¥¿ï¼Œè°ƒç”¨äº†å´ä¸ç”¨ï¼ŒåŸºæœ¬å°±æ˜¯å†™é”™äº†ã€‚</p>
<p>è¿™é‡Œå¾ˆé€‚åˆåŠ  <code>#[\NoDiscard]</code>ã€‚</p>
<h4 data-id="heading-37">æ¶ˆæ¯è¦ç®€çŸ­æœ‰è¡ŒåŠ¨æŒ‡å‘</h4>
<p>å¥½çš„æ¶ˆæ¯æ˜¯ä½ å¸Œæœ›é˜Ÿå‹åœ¨ CI æ—¥å¿—é‡Œçœ‹åˆ°çš„ï¼š</p>
<ul>
<li>"This Result must be handled."</li>
<li>"Immutable update: capture the returned instance."</li>
<li>"Operation can partially fail; consume the error list."</li>
</ul>
<p>RFC æ”¯æŒå¯é€‰æ¶ˆæ¯ï¼Œä¼šå‡ºç°åœ¨è­¦å‘Šæ–‡æœ¬é‡Œã€‚</p>
<h3 data-id="heading-38">ç»“è®º</h3>
<p>æ”¯æŒ <code>#[\NoDiscard]</code> çš„æœ€å¼ºç†ç”±ä¸æ˜¯ç†è®ºï¼Œæ˜¯å¯ç»´æŠ¤æ€§ã€‚</p>
<p>å¿½ç•¥è¿”å›å€¼æ˜¯çœŸå® PHP ä»£ç é‡Œåå¤å‡ºç°çš„å¤±è´¥æ¨¡å¼â€”â€”å°¤å…¶æ˜¯ï¼š</p>
<ul>
<li>å‡½æ•°å¤§å¤šæ•°æ—¶å€™éƒ½æˆåŠŸ</li>
<li>API æ˜¯ä¸å¯å˜çš„ï¼ˆè¿”å›æ–°å®ä¾‹ï¼‰</li>
<li>å¤±è´¥é è¿”å›å€¼è€Œä¸æ˜¯å¼‚å¸¸æ¥æŠ¥å‘Š</li>
</ul>
<p>PHP 8.5 ç»™äº†ä¸€ç§åŸç”Ÿæ‰‹æ®µæ¥å°½æ—©æŠ“ä½è¿™äº›é”™è¯¯ï¼Œç”¨è­¦å‘ŠåŠ æ˜¾å¼ <code>(void)</code> æ¥ä¿æŒæ•…æ„ä¸¢å¼ƒæ—¶çš„å¯è¯»æ€§ã€‚</p>
<p>ç²¾å‡†åœ°ç”¨å®ƒï¼š</p>
<ul>
<li>ä»å¿½ç•¥è¿”å›å€¼æœ‰å®³çš„é¢†åŸŸ/æœåŠ¡ API å…¥æ‰‹</li>
<li>é¿å¼€çº¯å‡½æ•°å’Œ"ä¸»è¦é å‰¯ä½œç”¨"çš„æ–¹æ³•</li>
<li>é…åˆå‘½åçº¦å®šï¼ˆ<code>with*</code>ã€<code>try*</code>ï¼‰ï¼Œè®©ä»£ç åœ¨å¼•æ“æŠ¥è­¦ä¹‹å‰å°±èƒ½è¯»å‡ºæ­£ç¡®ç”¨æ³•</li>
</ul>
<p>åšåˆ°è¿™äº›ï¼Œ<code>#[\NoDiscard]</code> å°±ä¼šæˆä¸ºé‚£ç§å®‰é™åœ°å‡å°‘ç”Ÿäº§äº‹æ•…çš„å°ç‰¹æ€§â€”â€”ä¸ç”¨é€¼æ•´ä¸ªå›¢é˜Ÿæ¢ç¼–ç¨‹æ¨¡å‹ã€‚</p>
<h3 data-id="heading-39">å‚è€ƒèµ„æ–™</h3>
<ul>
<li>PHP 8.5 å‘å¸ƒå…¬å‘Šï¼ˆ#[\NoDiscard] æ¦‚è¿°ã€è­¦å‘Šè¡Œä¸ºï¼‰</li>
<li>PHP æ‰‹å†Œï¼šPHP 8.5 æ–°ç‰¹æ€§ï¼ˆ#[\NoDiscard] å’Œ (void) å¼ºåˆ¶è½¬æ¢ï¼‰</li>
<li>PHP RFCï¼š"Marking return values as important (#[\NoDiscard])"ï¼ˆè­¦å‘Šçº§åˆ«ã€"ä½¿ç”¨"çš„å«ä¹‰ã€(void) å¼ºåˆ¶è½¬æ¢ç»†èŠ‚ã€çº¦æŸã€æ¨èç”¨æ³•ï¼‰</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹å†™ Vue æ¨¡æ¿ç¼–è¯‘ï¼ˆç”Ÿæˆç¯‡ï¼‰]]></title>    <link>https://juejin.cn/post/7592846242175369250</link>    <guid>https://juejin.cn/post/7592846242175369250</guid>    <pubDate>2026-01-08T16:47:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592846242175369250" data-draft-id="7591744347826389018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹å†™ Vue æ¨¡æ¿ç¼–è¯‘ï¼ˆç”Ÿæˆç¯‡ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-08T16:47:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘ä¸åƒé¥¼å¹²"/> <meta itemprop="url" content="https://juejin.cn/user/3263006241480605"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹å†™ Vue æ¨¡æ¿ç¼–è¯‘ï¼ˆç”Ÿæˆç¯‡ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3263006241480605/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘ä¸åƒé¥¼å¹²
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T16:47:07.000Z" title="Thu Jan 08 2026 16:47:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto;border:3px solid rgba(62,175,124,.2)}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-weight:700;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:6px;border:2px solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c}.markdown-body a:active,.markdown-body a:hover{border-bottom:1.5px solid #3eaf7c}.markdown-body a:before{content:"â‡²"}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(62,175,124,.2)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:.5rem solid;border-color:#42b983;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none}.markdown-body ul li:before{content:"â€¢";margin-right:4px;color:#3eaf7c}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å†™æœ¬æ–‡çš„èƒŒæ™¯ <a href="https://juejin.cn/post/7519376321875279922" target="_blank" title="https://juejin.cn/post/7519376321875279922">ã€Šé¸½äº†å…­å¹´çš„æŸå¤§å‚é¢è¯•é¢˜ï¼šä½ ä¼šæ‰‹å†™ä¸€ä¸ªæ¨¡æ¿å¼•æ“å—ï¼Ÿã€‹</a></p>
<p>é˜…è¯»æœ¬æ–‡å‰è¯·åŠ¡å¿…å…ˆé˜…è¯»è§£æç¯‡ <a href="https://juejin.cn/post/7519315675103723546" target="_blank" title="https://juejin.cn/post/7519315675103723546">ã€Šæ‰‹å†™ Vue æ¨¡æ¿ç¼–è¯‘ï¼ˆè§£æç¯‡ï¼‰ã€‹</a></p>
<h2 data-id="heading-1">å¤ä¹ </h2>
<p>åœ¨å‰æ–‡ <a href="https://juejin.cn/post/7519315675103723546" target="_blank" title="https://juejin.cn/post/7519315675103723546">ã€Šæ‰‹å†™ Vue æ¨¡æ¿ç¼–è¯‘ï¼ˆè§£æç¯‡ï¼‰ã€‹</a>
ä¸­ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œæ¨¡æ¿ç¼–è¯‘çš„è¿‡ç¨‹åˆ†ä¸ºä¸‰æ­¥ï¼šè§£æã€ä¼˜åŒ–ã€ç”Ÿæˆã€‚</p>
<ol>
<li>è§£æ parseï¼šåœ¨è¿™ä¸€æ­¥ï¼ŒVue ä¼šè§£ææ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„ AST</li>
<li>ä¼˜åŒ– optimizeï¼šè¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯é€šè¿‡æ ‡è®°é™æ€èŠ‚ç‚¹æ¥è¿›è¡Œè¯­æ³•æ ‘ä¼˜åŒ–ã€‚</li>
<li>ç”Ÿæˆ generateï¼šåˆ©ç”¨å‰é¢ç”Ÿæˆ ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰è½¬æ¢æˆæ¸²æŸ“å‡½æ•°ï¼ˆrender functionï¼‰ã€‚</li>
</ol>
<p>åœ¨å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¦‚ä½•ç”Ÿæˆ AST æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å­¦ä¹ å¦‚ä½• optimize å’Œ generateã€‚</p>
<h2 data-id="heading-2">optimizeï¼šä¼˜åŒ– AST</h2>
<h3 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šæ ‡è®°é™æ€èŠ‚ç‚¹</h3>
<p>å¦‚ä¸Šæ–‡æ‰€è¯´ï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯é€šè¿‡æ ‡è®°é™æ€èŠ‚ç‚¹æ¥è¿›è¡Œè¯­æ³•æ ‘ä¼˜åŒ–ï¼Œåœ¨è¿›è¡Œä¼˜åŒ–åï¼ŒVue ä¼šåœ¨ AST ä¸­æ ‡è®°æŸä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸ºé™æ€èŠ‚ç‚¹ã€‚</p>
<p>åœ¨ä¸Šä¸€èŠ‚ç”Ÿæˆ AST ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†èŠ‚ç‚¹ç±»å‹ï¼š</p>
<ul>
<li>å…ƒç´ èŠ‚ç‚¹ type=1</li>
<li>è¡¨è¾¾å¼èŠ‚ç‚¹ type=2</li>
<li>æ–‡æœ¬èŠ‚ç‚¹ type=3</li>
</ul>
<p>åœ¨ä¸å­˜åœ¨å­èŠ‚ç‚¹æ—¶ï¼š</p>
<ul>
<li>é¦–å…ˆæ–‡æœ¬èŠ‚ç‚¹å¿…ä¸ºé™æ€èŠ‚ç‚¹ï¼Œå› ä¸ºæ–‡æœ¬å†…å®¹å›ºå®šä¸å˜ã€‚</li>
<li>å…¶æ¬¡è¡¨è¾¾å¼åˆ™å¿…ä¸ä¸ºé™æ€èŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒçš„å€¼ä¾èµ–äºå¼•ç”¨çš„è¡¨è¾¾å¼ã€‚</li>
<li>æœ€åæ™®é€šèŠ‚ç‚¹ï¼Œå¦‚æœæœ‰ <code>v-if</code> æˆ– <code>v-for</code> æŒ‡ä»¤å°±æ˜¯åŠ¨æ€èŠ‚ç‚¹ï¼Œå¦åˆ™æ˜¯é™æ€èŠ‚ç‚¹
<blockquote>
<p>æ³¨ï¼šå®é™… Vue ä¸­è¿˜æœ‰ <code>v-bind</code> ç­‰æŒ‡ä»¤ä¹Ÿä¼šè®©èŠ‚ç‚¹å˜ä¸ºåŠ¨æ€ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†</p>
</blockquote>
</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * åˆ¤æ–­ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸ºé™æ€èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isStatic</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-comment">// å¦‚æœèŠ‚ç‚¹æ˜¯è¡¨è¾¾å¼èŠ‚ç‚¹ï¼Œåˆ™ä¸æ˜¯é™æ€èŠ‚ç‚¹</span>
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }

  <span class="hljs-comment">// å¦‚æœèŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œåˆ™æ˜¯é™æ€èŠ‚ç‚¹</span>
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">3</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  }

  <span class="hljs-comment">// å¦‚æœèŠ‚ç‚¹æ²¡æœ‰ v-if å’Œ v-for æŒ‡ä»¤ï¼Œåˆ™æ˜¯é™æ€èŠ‚ç‚¹</span>
  <span class="hljs-keyword">return</span> !node.<span class="hljs-property">if</span> &amp;&amp; !node.<span class="hljs-property">for</span>
}
</code></pre>
<p><strong>å¯¹äºæœ‰å­èŠ‚ç‚¹çš„æƒ…å†µ</strong>ï¼šçˆ¶èŠ‚ç‚¹å¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ‰èƒ½æˆä¸ºé™æ€èŠ‚ç‚¹ï¼š</p>
<ol>
<li>è‡ªèº«æ˜¯é™æ€èŠ‚ç‚¹ï¼ˆæ²¡æœ‰ <code>v-if</code>ã€<code>v-for</code> ç­‰åŠ¨æ€æŒ‡ä»¤ï¼‰</li>
<li>æ‰€æœ‰å­èŠ‚ç‚¹éƒ½æ˜¯é™æ€èŠ‚ç‚¹</li>
</ol>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¤„ç†èŠ‚ç‚¹æ ‘</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * æ ‡è®°ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸ºé™æ€èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">markStatic</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-comment">// å…ˆç”¨ isStatic åˆ¤æ–­å½“å‰èŠ‚ç‚¹è‡ªèº«æ˜¯å¦ä¸ºé™æ€</span>
  node.<span class="hljs-property">static</span> = <span class="hljs-title function_">isStatic</span>(node)
  <span class="hljs-comment">// å¦‚æœæ˜¯å…ƒç´ èŠ‚ç‚¹ï¼Œéœ€è¦æ£€æŸ¥å­èŠ‚ç‚¹</span>
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-comment">// éå†æ‰€æœ‰çš„å­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>; i &lt; l; i++) {
      <span class="hljs-keyword">const</span> child = node.<span class="hljs-property">children</span>[i]
      <span class="hljs-comment">// å…ˆé€’å½’å¤„ç†å­èŠ‚ç‚¹</span>
      <span class="hljs-title function_">markStatic</span>(child)
      <span class="hljs-comment">// åªè¦æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹æ˜¯åŠ¨æ€çš„ï¼Œçˆ¶èŠ‚ç‚¹ä¹Ÿå¿…é¡»æ˜¯åŠ¨æ€çš„</span>
      <span class="hljs-keyword">if</span> (!child.<span class="hljs-property">static</span>) {
        node.<span class="hljs-property">static</span> = <span class="hljs-literal">false</span>
      }
    }
  }
}
</code></pre>
<h3 data-id="heading-4">ç¬¬äºŒæ­¥ï¼šæ ‡è®°é™æ€æ ¹èŠ‚ç‚¹</h3>
<p>æ¥ä¸‹æ¥æ˜¯ Vue ä¼˜åŒ–ç³»ç»Ÿçš„å¦ä¸€ä¸ªå…³é”®éƒ¨åˆ† <code>markStaticRoots</code>ã€‚</p>
<p><code>markStaticRoots</code> å‡½æ•°ç”¨äºæ ‡è®°é™æ€æ ¹èŠ‚ç‚¹ï¼Œè¢«æ ‡è®°ä¸ºé™æ€æ ¹èŠ‚ç‚¹çš„å…ƒç´ åŠå…¶å­æ ‘ä¼šåœ¨ä»£ç ç”Ÿæˆé˜¶æ®µè¢«ç‰¹æ®Šå¤„ç†ï¼š</p>
<ol>
<li><strong>æå‡ä¸ºå¸¸é‡</strong>ï¼šå°†å…¶æ¸²æŸ“ä»£ç æå‡åˆ° <code>staticRenderFns</code> æ•°ç»„ä¸­ï¼Œåªç”Ÿæˆä¸€æ¬¡</li>
<li><strong>è·³è¿‡ patch</strong>ï¼šæ›´æ–°æ—¶ç›´æ¥å¤ç”¨ï¼Œä¸éœ€è¦é‡æ–°åˆ›å»ºå’Œå¯¹æ¯” VNode</li>
<li><strong>æ€§èƒ½æå‡</strong>ï¼šå‡å°‘è¿è¡Œæ—¶çš„è®¡ç®—å¼€é”€</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * æ ‡è®°é™æ€æ ¹èŠ‚ç‚¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">node</span> - AST èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">markStaticRoots</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-comment">// åªæœ‰å…ƒç´ èŠ‚ç‚¹æ‰å¤„ç†</span>

    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ä¸ºé™æ€æ ¹èŠ‚ç‚¹ï¼šå¿…é¡»æ˜¯é™æ€èŠ‚ç‚¹ + æœ‰å­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">static</span> &amp;&amp; node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>) {
      node.<span class="hljs-property">staticRoot</span> = <span class="hljs-literal">true</span>
      <span class="hljs-comment">// æ‰¾åˆ°é™æ€æ ¹åç›´æ¥è¿”å›ï¼Œå­èŠ‚ç‚¹ä¼šè¢«æ•´ä½“æå‡ï¼Œæ— éœ€ç»§ç»­éå†</span>
      <span class="hljs-keyword">return</span>
    } <span class="hljs-keyword">else</span> {
      node.<span class="hljs-property">staticRoot</span> = <span class="hljs-literal">false</span>
    }

    <span class="hljs-comment">// é€’å½’å¤„ç†æ‰€æœ‰å­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>; i &lt; l; i++) {
        <span class="hljs-title function_">markStaticRoots</span>(node.<span class="hljs-property">children</span>[i])
      }
    }

    <span class="hljs-comment">// å¤„ç† v-if çš„å…¶ä»–åˆ†æ”¯ï¼ˆv-else-ifã€v-elseï¼‰</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šä» i=1 å¼€å§‹ï¼Œå› ä¸º ifConditions[0] å°±æ˜¯å½“å‰èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">ifConditions</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>, l = node.<span class="hljs-property">ifConditions</span>.<span class="hljs-property">length</span>; i &lt; l; i++) {
        <span class="hljs-title function_">markStaticRoots</span>(node.<span class="hljs-property">ifConditions</span>[i].<span class="hljs-property">block</span>)
      }
    }
  }
}
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬æ¥å®ç° <code>optimize</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">optimize</span>(<span class="hljs-params">root</span>) {
  <span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span>
  <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šæ ‡è®°é™æ€èŠ‚ç‚¹</span>
  <span class="hljs-title function_">markStatic</span>(root)
  <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šæ ‡è®°é™æ€æ ¹</span>
  <span class="hljs-title function_">markStaticRoots</span>(root)
}
</code></pre>
<p>ä¸¾ä¸ªä¾‹å­æ¥çœ‹çœ‹æ•ˆæœï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è¦å¤„ç†çš„æ¨¡æ¿å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">const</span> str = <span class="hljs-string">`&lt;div&gt;&lt;h1 v-if="true"&gt;hello&lt;/h1&gt;&lt;h2&gt;cookie&lt;/h2&gt;&lt;/div&gt;`</span>

<span class="hljs-comment">// è§£æä¸º ast</span>
<span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(str, {
  <span class="hljs-comment">// ...</span>
})
<span class="hljs-comment">// ä¼˜åŒ– ast</span>
<span class="hljs-title function_">optimize</span>(ast)

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">dir</span>(ast, {
  <span class="hljs-attr">depth</span>: <span class="hljs-literal">null</span>,
})
</code></pre>
<p>æ‰“å°ç»“æœï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;ref *<span class="hljs-number">2</span>&gt; {
  <span class="hljs-attr">type</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">tag</span>: <span class="hljs-string">'div'</span>,
  <span class="hljs-attr">attrsList</span>: [],
  <span class="hljs-attr">attrsMap</span>: {},
  <span class="hljs-attr">children</span>: [
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ref</span> *<span class="hljs-attr">1</span>&gt;</span> {
      type: 1,
      tag: 'h1',
      attrsList: [],
      attrsMap: { 'v-if': 'true' },
      children: [ { type: 3, text: 'hello', static: true } ],
      if: 'true',
      ifConditions: [ { exp: 'true', block: [Circular *1] } ],
      parent: [Circular *2],
      static: false,
      staticRoot: false
    },
    {
      type: 1,
      tag: 'h2',
      attrsList: [],
      attrsMap: {},
      children: [ { type: 3, text: 'cookie', static: true } ],
      parent: [Circular *2],
      static: true,
      staticRoot: true
    }
  ],
  static: false,
  staticRoot: false
}
</span></code></pre>
<p>å¯ä»¥è§‚å¯Ÿåˆ° <code>&lt;h2&gt;</code> èŠ‚ç‚¹è¢«æ ‡è®°äº†é™æ€æ ¹èŠ‚ç‚¹ã€‚</p>
<h2 data-id="heading-5">ç”Ÿæˆä»£ç å‰ç½®çŸ¥è¯†</h2>
<h3 data-id="heading-6">1ã€new Function</h3>
<p>æˆ‘ä»¬çŸ¥é“åˆ›å»ºå‡½æ•°é™¤äº†å¸¸ç”¨çš„å‡½æ•°å£°æ˜ã€å‡½æ•°è¡¨è¾¾å¼ã€ç®­å¤´å‡½æ•°ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªä¸å¸¸ç”¨çš„ï¼šæ„é€ å‡½æ•°ã€‚è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(corpsFonction)
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(arg1, corpsFonction)
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(arg1, ...argN, corpsFonction)
<span class="hljs-comment">// ä¾‹ï¼š</span>
<span class="hljs-keyword">const</span> addFn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'return a + b'</span>)
<span class="hljs-keyword">const</span> sum = <span class="hljs-title function_">addFn</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// 3</span>
</code></pre>
<ul>
<li><code>argN</code>ï¼šå¯é€‰ï¼Œé›¶ä¸ªæˆ–å¤šä¸ªï¼Œå‡½æ•°å½¢å‚çš„åç§°ï¼Œæ¯ä¸ªåç§°éƒ½å¿…é¡»æ˜¯å­—ç¬¦ä¸²</li>
<li><code>corpsFonction</code>ï¼šä¸€ä¸ªåŒ…å«æ„æˆå‡½æ•°å®šä¹‰çš„ JavaScript è¯­å¥çš„å­—ç¬¦ä¸²ã€‚</li>
</ul>
<h3 data-id="heading-7">2ã€with è¯­å¥</h3>
<p><code>with</code> å¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„é¡¶éƒ¨ï¼Œè®©æˆ‘ä»¬åœ¨ä»£ç å—å†…ç›´æ¥è®¿é—®å¯¹è±¡çš„å±æ€§ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">with</span> (å¯¹è±¡) {
  <span class="hljs-comment">// åœ¨è¿™é‡Œå¯ä»¥ç›´æ¥è®¿é—®å¯¹è±¡çš„å±æ€§</span>
}
</code></pre>
<p>åœ¨ Vue æ¨¡æ¿ä¸­æˆ‘ä»¬å†™ <code>{{message}}</code>ï¼Œå®é™…ä¸Šè®¿é—®çš„æ˜¯ <code>this.message</code>ã€‚ä½¿ç”¨ <code>with(this)</code> å¯ä»¥çœç•¥ <code>this.</code> å‰ç¼€ï¼Œè®©ç”Ÿæˆçš„ä»£ç æ›´ç®€æ´ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> name = <span class="hljs-string">'other'</span> <span class="hljs-comment">// å±€éƒ¨å˜é‡</span>
  <span class="hljs-keyword">let</span> obj = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'cookie'</span>, <span class="hljs-comment">// å¯¹è±¡å±æ€§</span>
  }
  <span class="hljs-keyword">with</span> (obj) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name) <span class="hljs-comment">// ä¼˜å…ˆä» obj ä¸­æŸ¥æ‰¾ï¼Œè¾“å‡º 'cookie'</span>
  }
}
<span class="hljs-title function_">foo</span>() <span class="hljs-comment">// è¾“å‡º: cookie</span>
</code></pre>
<h2 data-id="heading-8">generate ç”Ÿæˆä»£ç </h2>
<p>ç»ˆäºåˆ°äº†æ¨¡æ¿ç¼–è¯‘çš„æœ€åä¸€æ­¥ï¼Œç”Ÿæˆä»£ç ï¼åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†æ ¹æ®å‰é¢å¾—åˆ°çš„ AST ç”Ÿæˆ <code>render</code> å‡½æ•°ã€‚</p>
<h3 data-id="heading-9">1ã€æ•´ä½“å…¥å£ï¼šgenerate</h3>
<p><code>generate</code> æ˜¯ä»£ç ç”Ÿæˆçš„å…¥å£å‡½æ•°ï¼Œè´Ÿè´£å°† AST è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„æ¸²æŸ“ä»£ç ï¼š</p>
<ol>
<li><strong>é€’å½’ç”Ÿæˆä»£ç </strong>ï¼šè°ƒç”¨ <code>genElement</code> éå† ASTï¼Œç”Ÿæˆç±»ä¼¼ <code>_c('div', [...])</code> çš„ä»£ç å­—ç¬¦ä¸²</li>
<li><strong>åŒ…è£… with ä½œç”¨åŸŸ</strong>ï¼šç”¨ <code>with(this){}</code> åŒ…è£¹ï¼Œè®©ä»£ç èƒ½è®¿é—® Vue å®ä¾‹çš„å±æ€§</li>
<li><strong>æ”¶é›†é™æ€æ¸²æŸ“å‡½æ•°</strong>ï¼šå°†é™æ€æ ¹èŠ‚ç‚¹å•ç‹¬æå–åˆ° <code>staticRenderFns</code> æ•°ç»„ä¸­</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ä»£ç ç”Ÿæˆå™¨å…¥å£
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">ast</span> - ç»è¿‡ parse å’Œ optimize å¤„ç†åçš„æŠ½è±¡è¯­æ³•æ ‘
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} è¿”å›åŒ…å« render å‡½æ•°å’Œ staticRenderFns æ•°ç»„çš„å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">ast</span>) {
  <span class="hljs-comment">// state ç”¨äºå­˜å‚¨ç¼–è¯‘è¿‡ç¨‹ä¸­çš„çŠ¶æ€</span>
  <span class="hljs-comment">// staticRenderFns: ç”¨äºæ”¶é›†é™æ€æ ¹èŠ‚ç‚¹çš„æ¸²æŸ“å‡½æ•°ï¼Œè¿™äº›å‡½æ•°åªéœ€è¦ç”Ÿæˆä¸€æ¬¡ï¼Œåç»­æ¸²æŸ“å¯ä»¥ç›´æ¥å¤ç”¨ï¼Œæå‡æ€§èƒ½</span>
  <span class="hljs-keyword">const</span> state = { <span class="hljs-attr">staticRenderFns</span>: [] }

  <span class="hljs-comment">// é€’å½’ç”Ÿæˆæ ¸å¿ƒæ¸²æŸ“ä»£ç å­—ç¬¦ä¸²</span>
  <span class="hljs-comment">// ä¾‹å¦‚ï¼š_c('div',[_v(_s(message))])</span>
  <span class="hljs-keyword">const</span> code = <span class="hljs-title function_">genElement</span>(ast, state)

  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// render: ä¸»æ¸²æŸ“å‡½æ•°çš„ä»£ç å­—ç¬¦ä¸²</span>
    <span class="hljs-comment">// ä½¿ç”¨ with(this) åŒ…è£…åï¼Œæ¨¡æ¿ä¸­çš„å˜é‡ï¼ˆå¦‚ {{message}}ï¼‰èƒ½ç›´æ¥ä» Vue å®ä¾‹ä¸Šè·å–</span>
    <span class="hljs-comment">// with(this) ä¼šå°† Vue å®ä¾‹æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾é¡¶éƒ¨</span>
    <span class="hljs-comment">// è¿™æ · message ä¼šè‡ªåŠ¨ä» this.message è·å–ï¼Œè€Œä¸éœ€è¦åœ¨æ¨¡æ¿é‡Œå†™ this.message</span>
    <span class="hljs-attr">render</span>: <span class="hljs-string">`with(this){return <span class="hljs-subst">${code}</span>}`</span>,
    <span class="hljs-comment">// staticRenderFns: é™æ€æ ¹èŠ‚ç‚¹æ¸²æŸ“å‡½æ•°çš„æ•°ç»„</span>
    <span class="hljs-attr">staticRenderFns</span>: state.<span class="hljs-property">staticRenderFns</span>,
  }
}
</code></pre>
<h3 data-id="heading-10">2ã€æ ¸å¿ƒå‡½æ•°ï¼šgenElement</h3>
<p><code>genElement</code> æ˜¯ä»£ç ç”Ÿæˆçš„<strong>è°ƒåº¦ä¸­å¿ƒ</strong>ï¼Œå®ƒæ ¹æ®èŠ‚ç‚¹ç±»å‹æ¥ä½¿ç”¨ä¸åŒçš„å¤„ç†å‡½æ•°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ç”Ÿæˆå…ƒç´ çš„æ¸²æŸ“ä»£ç 
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">el</span> - AST å…ƒç´ èŠ‚ç‚¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">state</span> - æ¸²æŸ“çŠ¶æ€ï¼ŒåŒ…å« staticRenderFns æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} æ¸²æŸ“ä»£ç å­—ç¬¦ä¸²ï¼Œå¦‚ï¼š_c('div', [...])
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genElement</span>(<span class="hljs-params">el, state</span>) {
  <span class="hljs-comment">// 1ï¼šå¤„ç†é™æ€æ ¹èŠ‚ç‚¹</span>
  <span class="hljs-comment">// el.staticRoot: åœ¨ optimize é˜¶æ®µæ ‡è®°çš„é™æ€æ ¹èŠ‚ç‚¹</span>
  <span class="hljs-comment">// el.staticProcessed: é˜²æ­¢é‡å¤å¤„ç†çš„æ ‡è®°</span>
  <span class="hljs-keyword">if</span> (el.<span class="hljs-property">staticRoot</span> &amp;&amp; !el.<span class="hljs-property">staticProcessed</span>) {
    <span class="hljs-comment">// é™æ€æ ¹èŠ‚ç‚¹ä¼šè¢«æå‡ä¸ºå•ç‹¬çš„å‡½æ•°å­˜å‚¨åœ¨ staticRenderFns ä¸­</span>
    <span class="hljs-comment">// è¿”å›ç±»ä¼¼ _m(0) çš„ä»£ç ï¼Œ0 æ˜¯åœ¨ staticRenderFns æ•°ç»„ä¸­çš„ç´¢å¼•</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genStatic</span>(el, state)
  }
  <span class="hljs-comment">// 2ï¼šå¤„ç† v-for æŒ‡ä»¤</span>
  <span class="hljs-comment">// el.for: åœ¨ parse é˜¶æ®µè§£æçš„ v-for å±æ€§</span>
  <span class="hljs-comment">// el.forProcessed: é˜²æ­¢é€’å½’æ—¶é‡å¤å¤„ç†</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (el.<span class="hljs-property">for</span> &amp;&amp; !el.<span class="hljs-property">forProcessed</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genFor</span>(el, state)
  }
  <span class="hljs-comment">// 3ï¼šå¤„ç† v-if æŒ‡ä»¤</span>
  <span class="hljs-comment">// el.if: åœ¨ parse é˜¶æ®µè§£æçš„ v-if æ¡ä»¶è¡¨è¾¾å¼</span>
  <span class="hljs-comment">// el.ifProcessed: é˜²æ­¢é€’å½’æ—¶é‡å¤å¤„ç†</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (el.<span class="hljs-property">if</span> &amp;&amp; !el.<span class="hljs-property">ifProcessed</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genIf</span>(el, state)
  }
  <span class="hljs-comment">// 4ï¼šå¤„ç†æ™®é€šå…ƒç´ </span>
  <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ç”Ÿæˆæ ‡ç­¾åå­—ç¬¦ä¸²ï¼Œå¦‚ 'div'</span>
    <span class="hljs-keyword">const</span> tag = <span class="hljs-string">`'<span class="hljs-subst">${el.tag}</span>'`</span>

    <span class="hljs-comment">// é€’å½’ç”Ÿæˆæ‰€æœ‰å­èŠ‚ç‚¹çš„ä»£ç </span>
    <span class="hljs-comment">// è¿”å›ç±»ä¼¼ [_v("hello"), _c('span')] çš„æ•°ç»„ä»£ç </span>
    <span class="hljs-keyword">const</span> children = <span class="hljs-title function_">genChildren</span>(el, state)

    <span class="hljs-comment">// æœ€ç»ˆè°ƒç”¨ _c (createElement) åˆ›å»º VNode</span>
    <span class="hljs-comment">// ç”Ÿæˆä»£ç ç¤ºä¾‹ï¼š_c('div', [_v("hello")])</span>
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œç”Ÿæˆï¼š_c('div')</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">`_c(<span class="hljs-subst">${tag}</span><span class="hljs-subst">${children ? <span class="hljs-string">`,<span class="hljs-subst">${children}</span>`</span> : <span class="hljs-string">''</span>}</span>)`</span>
  }
}
</code></pre>
<h4 data-id="heading-11">å¤„ç†å­èŠ‚ç‚¹ï¼šgenChildren å’Œ genNode</h4>
<p><code>genElement</code> ä¸­è°ƒç”¨äº† <code>genChildren</code> æ¥éå†å­èŠ‚ç‚¹ï¼Œ<code>genChildren</code> å†…éƒ¨åˆä½¿ç”¨ <code>genNode</code> æ¥å¤„ç†æ¯ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œ</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ç”Ÿæˆå­èŠ‚ç‚¹æ•°ç»„çš„æ¸²æŸ“ä»£ç 
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">el</span> - çˆ¶å…ƒç´ èŠ‚ç‚¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">state</span> - æ¸²æŸ“çŠ¶æ€
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} å­èŠ‚ç‚¹æ•°ç»„ä»£ç ï¼Œå¦‚ï¼š[_v("text"), _c('span')]
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genChildren</span>(<span class="hljs-params">el, state</span>) {
  <span class="hljs-keyword">const</span> children = el.<span class="hljs-property">children</span>
  <span class="hljs-keyword">if</span> (children.<span class="hljs-property">length</span>) {
    <span class="hljs-comment">// è·å–å­èŠ‚ç‚¹æ•°ç»„éœ€è¦çš„è§„èŒƒåŒ–ç±»å‹</span>
    <span class="hljs-keyword">const</span> normalizationType = <span class="hljs-title function_">getNormalizationType</span>(children)
    <span class="hljs-comment">// éå†æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œä¸ºæ¯ä¸ªå­èŠ‚ç‚¹ç”Ÿæˆä»£ç </span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">`[<span class="hljs-subst">${children.map((c) =&gt; genNode(c, state)).join(<span class="hljs-string">','</span>)}</span>]<span class="hljs-subst">${
      normalizationType ? <span class="hljs-string">`,<span class="hljs-subst">${normalizationType}</span>`</span> : <span class="hljs-string">''</span>
    }</span>`</span>
  }
}

<span class="hljs-comment">/**
 * æ ¹æ®èŠ‚ç‚¹ç±»å‹è°ƒç”¨å¯¹åº”çš„ç”Ÿæˆå‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">node</span> - AST èŠ‚ç‚¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">state</span> - æ¸²æŸ“çŠ¶æ€
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} èŠ‚ç‚¹æ¸²æŸ“ä»£ç 
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genNode</span>(<span class="hljs-params">node, state</span>) {
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-comment">// type === 1: å…ƒç´ èŠ‚ç‚¹ï¼Œé€’å½’è°ƒç”¨ genElement</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genElement</span>(node, state)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// type === 2/3: æ–‡æœ¬èŠ‚ç‚¹æˆ–è¡¨è¾¾å¼èŠ‚ç‚¹ï¼Œè°ƒç”¨ genText</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genText</span>(node)
  }
}
</code></pre>
<h4 data-id="heading-12">ä¸ºä»€ä¹ˆéœ€è¦ <code>getNormalizationType</code>ï¼Ÿ</h4>
<p>å› ä¸º <code>v-for</code> ä¼šç”Ÿæˆæ•°ç»„ï¼Œå¯¼è‡´ children å‡ºç°åµŒå¥—æ•°ç»„çš„æƒ…å†µï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>first<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in [1,2,3]"</span>&gt;</span>{{item}}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>last<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>ç”Ÿæˆçš„å­èŠ‚ç‚¹ç»“æ„ä¼šæ˜¯ï¼š</p>
<pre><code class="hljs language-js" lang="js">[span_first, [span_1, span_1, span_1], span_last]
</code></pre>
<p>Vue çš„ <code>createElement</code> éœ€è¦çŸ¥é“å¦‚ä½•å¤„ç†è¿™ç§åµŒå¥—ï¼Œæ‰€ä»¥è¦å‘Šè¯‰å®ƒè§„èŒƒåŒ–ç±»å‹ï¼š</p>
<ul>
<li>ä¸éœ€è¦è§„èŒƒåŒ–ï¼ˆæ²¡æœ‰åµŒå¥—ï¼‰- <code>type = 0</code></li>
<li>ç®€å•è§„èŒƒåŒ–ï¼ˆä¸€å±‚åµŒå¥—ï¼Œå¦‚ç»„ä»¶ï¼‰- <code>type = 1</code></li>
<li>å®Œå…¨è§„èŒƒåŒ–ï¼ˆå¤šå±‚åµŒå¥—ï¼Œå¦‚ <code>v-for</code>ï¼‰- <code>type = 2</code></li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ç¡®å®šå­èŠ‚ç‚¹æ•°ç»„éœ€è¦çš„è§„èŒƒåŒ–(normalization)ç±»å‹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">children</span> - å­èŠ‚ç‚¹æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} 0 | 1 | 2 - è§„èŒƒåŒ–ç±»å‹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getNormalizationType</span>(<span class="hljs-params">children</span>) {
  <span class="hljs-keyword">let</span> res = <span class="hljs-number">0</span> <span class="hljs-comment">// é»˜è®¤ä¸éœ€è¦è§„èŒƒåŒ–</span>

  <span class="hljs-comment">// éå†æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œæ£€æµ‹æ˜¯å¦éœ€è¦è§„èŒƒåŒ–</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> el = children[i]

    <span class="hljs-comment">// è·³è¿‡éå…ƒç´ èŠ‚ç‚¹ï¼ˆtype=2 è¡¨è¾¾å¼èŠ‚ç‚¹ã€type=3 æ–‡æœ¬èŠ‚ç‚¹ï¼‰</span>
    <span class="hljs-comment">// åªæœ‰å…ƒç´ èŠ‚ç‚¹(type=1)æ‰å¯èƒ½éœ€è¦è§„èŒƒåŒ–å¤„ç†</span>
    <span class="hljs-keyword">if</span> (el.<span class="hljs-property">type</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å®Œå…¨è§„èŒƒåŒ–ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼Œè¿”å› 2ï¼‰</span>
    <span class="hljs-keyword">if</span> (
      el.<span class="hljs-property">for</span> !== <span class="hljs-literal">undefined</span> || <span class="hljs-comment">// å½“å‰èŠ‚ç‚¹æœ‰ v-for</span>
      (el.<span class="hljs-property">ifConditions</span> &amp;&amp; <span class="hljs-comment">// æˆ–è€… v-if æ¡ä»¶åˆ†æ”¯ä¸­æœ‰v-for</span>
        el.<span class="hljs-property">ifConditions</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c.<span class="hljs-property">block</span>.<span class="hljs-property">for</span> !== <span class="hljs-literal">undefined</span>))
    ) {
      <span class="hljs-comment">// éœ€è¦å®Œå…¨è§„èŒƒåŒ–ï¼šå› ä¸º v-for ä¼šè¿”å›æ•°ç»„ï¼Œéœ€è¦é€’å½’æ‰å¹³åŒ–</span>
      <span class="hljs-comment">// ä¾‹å¦‚ï¼š[_v(" "), _l(arr, ...), _v(" ")] å…¶ä¸­ _l è¿”å› [span1, span2, span3]</span>
      <span class="hljs-comment">// å®é™…ç»“æ„æ˜¯ï¼š[_v(" "), [span1, span2, span3], _v(" ")] éœ€è¦æ‰å¹³åŒ–ä¸ºä¸€ç»´æ•°ç»„</span>
      res = <span class="hljs-number">2</span>
      <span class="hljs-keyword">break</span> <span class="hljs-comment">// æ‰¾åˆ°ä¸€ä¸ªéœ€è¦å®Œå…¨è§„èŒƒåŒ–çš„å°±å¯ä»¥é€€å‡ºï¼Œä¸éœ€è¦ç»§ç»­æ£€æŸ¥</span>
    }

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦ç®€å•è§„èŒƒåŒ– è¿”å› 1</span>
    <span class="hljs-comment">// å½“å‰èŠ‚ç‚¹å¯èƒ½æ˜¯ç»„ä»¶æ—¶ï¼Œç»„ä»¶å¯èƒ½è¿”å›å¤šä¸ªæ ¹èŠ‚ç‚¹ï¼ˆæ•°ç»„ï¼‰</span>
    <span class="hljs-comment">// ä½†ç»„ä»¶çš„ render å‡½æ•°å·²ç»è¿”å›è§„èŒƒåŒ–çš„ VNodeï¼Œæ‰€ä»¥åªéœ€è¦ä¸€å±‚æ‰å¹³åŒ–</span>
    <span class="hljs-comment">// æˆ‘ä»¬çš„æ¨¡æ¿é‡Œä¸å¤„ç†ç»„ä»¶ï¼Œè¿™é‡Œä¹Ÿå°±ä¸ç”¨è€ƒè™‘è¿™ç§æƒ…å†µ</span>
    <span class="hljs-comment">// res = 1</span>
  }

  <span class="hljs-keyword">return</span> res <span class="hljs-comment">// è¿”å› 0ã€1 æˆ– 2</span>
}
</code></pre>
<h3 data-id="heading-13">3ã€åˆ†ç±»å¤„ç†å‡½æ•°</h3>
<h4 data-id="heading-14">Vue å†…éƒ¨å‡½æ•°</h4>
<p>é¦–å…ˆåœ¨ Vue å†…éƒ¨ï¼Œæœ‰ä¸€äº›ç®€å†™å‡½æ•°ï¼Œåœ¨åç»­ç”Ÿæˆä»£ç çš„æ—¶å€™ä¼šç”¨åˆ°ï¼Œåˆ—è¡¨å¦‚ä¸‹ï¼š</p>















































<table><thead><tr><th align="left">ç¼©å†™</th><th align="left">å…¨ç§°</th><th align="left">ä½œç”¨</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left"><code>_c</code></td><td align="left"><code>createElement</code></td><td align="left">åˆ›å»ºå…ƒç´  VNode</td><td align="left"><code>_c('div', [...])</code></td></tr><tr><td align="left"><code>_v</code></td><td align="left"><code>createTextVNode</code></td><td align="left">åˆ›å»ºæ–‡æœ¬ VNode</td><td align="left"><code>_v("hello")</code></td></tr><tr><td align="left"><code>_s</code></td><td align="left"><code>toString</code></td><td align="left">å°†å˜é‡è½¬ä¸ºå­—ç¬¦ä¸²</td><td align="left"><code>_v(_s(message))</code></td></tr><tr><td align="left"><code>_l</code></td><td align="left"><code>renderList</code></td><td align="left">æ¸²æŸ“åˆ—è¡¨ï¼ˆv-forï¼‰</td><td align="left"><code>_l(items, fn)</code></td></tr><tr><td align="left"><code>_m</code></td><td align="left"><code>renderStatic</code></td><td align="left">æ¸²æŸ“é™æ€å†…å®¹</td><td align="left"><code>_m(0)</code></td></tr><tr><td align="left"><code>_e</code></td><td align="left"><code>createEmptyVNode</code></td><td align="left">åˆ›å»ºç©ºèŠ‚ç‚¹ï¼ˆv-if å¤±è´¥æ—¶ï¼‰</td><td align="left"><code>_e()</code></td></tr></tbody></table>
<h4 data-id="heading-15">é™æ€èŠ‚ç‚¹ (genStatic)</h4>
<p>é™æ€æ ¹èŠ‚ç‚¹ä¼šè¢«æå‡ä¸ºå•ç‹¬çš„å‡½æ•°ï¼Œæå‡æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ç”Ÿæˆé™æ€æ ¹èŠ‚ç‚¹çš„æ¸²æŸ“ä»£ç 
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">el</span> - é™æ€æ ¹èŠ‚ç‚¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">state</span> - æ¸²æŸ“çŠ¶æ€
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} é™æ€èŠ‚ç‚¹å¼•ç”¨ä»£ç ï¼Œå¦‚ï¼š_m(0)
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genStatic</span>(<span class="hljs-params">el, state</span>) {
  <span class="hljs-comment">// æ ‡è®°å·²å¤„ç†ï¼Œé˜²æ­¢é‡å¤å¤„ç†</span>
  el.<span class="hljs-property">staticProcessed</span> = <span class="hljs-literal">true</span>

  <span class="hljs-comment">// é€’å½’ç”Ÿæˆé™æ€èŠ‚ç‚¹çš„å®Œæ•´ä»£ç </span>
  <span class="hljs-keyword">const</span> code = <span class="hljs-title function_">genElement</span>(el, state)

  <span class="hljs-comment">// å°†é™æ€èŠ‚ç‚¹å‡½æ•°å­˜å‚¨åˆ° staticRenderFns æ•°ç»„ä¸­</span>
  state.<span class="hljs-property">staticRenderFns</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">`with(this){return <span class="hljs-subst">${code}</span>}`</span>)

  <span class="hljs-comment">// è¿”å›å¯¹é™æ€å‡½æ•°çš„å¼•ç”¨ï¼Œ_m(index) è¡¨ç¤ºè°ƒç”¨ staticRenderFns[index]</span>
  <span class="hljs-comment">// ç´¢å¼•æ˜¯å½“å‰æ•°ç»„é•¿åº¦å‡ 1</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">`_m(<span class="hljs-subst">${state.staticRenderFns.length - <span class="hljs-number">1</span>}</span>)`</span>
}
</code></pre>
<p>é™æ€æ¸²æŸ“å‡½æ•°å’Œä¸» <code>render</code> å‡½æ•°ï¼ˆ<code>vm._render</code>ï¼‰ç‹¬ç«‹ï¼Œéœ€è¦å•ç‹¬è®¾ç½® <code>with</code> ä½œç”¨åŸŸã€‚</p>
<h4 data-id="heading-16">æ–‡æœ¬å¤„ç† (genText)</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ç”Ÿæˆæ–‡æœ¬èŠ‚ç‚¹çš„æ¸²æŸ“ä»£ç 
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">text</span> - æ–‡æœ¬ AST èŠ‚ç‚¹
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} _v('...') æˆ– _v(_s(variable))
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genText</span>(<span class="hljs-params">text</span>) {
  <span class="hljs-comment">// type 2 æ˜¯å¸¦ {{}} çš„è¡¨è¾¾å¼ï¼Œtype 3 æ˜¯æ™®é€šçº¯æ–‡æœ¬</span>
  <span class="hljs-comment">// è¡¨è¾¾å¼ç›´æ¥ä½¿ç”¨è§£æå¥½çš„ expression çº¯æ–‡æœ¬éœ€è¦ç”¨ JSON.stringify è½¬ä¹‰</span>
  <span class="hljs-comment">// æ¯”å¦‚ text ä¸º "hello"ï¼šç”Ÿæˆä»£ç  `v(hello)` æ­¤æ—¶ JS ä¼šå»æ‰¾åä¸º hello çš„å˜é‡ï¼Œè¿™ä¼šå¯¼è‡´æŠ¥é”™ï¼ˆReferenceErrorï¼‰</span>
  <span class="hljs-comment">// JSON.stringify("hello") ä¼šè¿”å› "\"hello\""ï¼ˆå³å¸¦åŒå¼•å·çš„å­—ç¬¦ä¸²ï¼‰ã€‚ç”Ÿæˆçš„ä»£ç ä¼šå˜æˆï¼š_v("hello")</span>
  <span class="hljs-keyword">const</span> value = text.<span class="hljs-property">type</span> === <span class="hljs-number">2</span> ? text.<span class="hljs-property">expression</span> : <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(text.<span class="hljs-property">text</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-string">`_v(<span class="hljs-subst">${value}</span>)`</span>
}
</code></pre>
<h4 data-id="heading-17">æ¡ä»¶æ¸²æŸ“ (v-if)</h4>
<p>åœ¨ Vue ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>v-if/else-if/else</code> æŒ‡ä»¤ï¼Œæ¯”å¦‚ä¸‹é¢çš„æ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"a"</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">"b"</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span>&gt;</span>C<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>æˆ‘ä»¬ç”Ÿæˆçš„ AST ä¸ºï¼š</p>
<pre><code class="hljs language-js" lang="js">conditions = [
  { <span class="hljs-attr">exp</span>: <span class="hljs-string">'a'</span>, <span class="hljs-attr">block</span>: { <span class="hljs-variable constant_">AST</span>èŠ‚ç‚¹A } }, <span class="hljs-comment">// v-if</span>
  { <span class="hljs-attr">exp</span>: <span class="hljs-string">'b'</span>, <span class="hljs-attr">block</span>: { <span class="hljs-variable constant_">AST</span>èŠ‚ç‚¹B } }, <span class="hljs-comment">// v-else-if</span>
  { <span class="hljs-attr">exp</span>: <span class="hljs-literal">undefined</span>, <span class="hljs-attr">block</span>: { <span class="hljs-variable constant_">AST</span>èŠ‚ç‚¹C } }, <span class="hljs-comment">// v-else (æ²¡æœ‰exp)</span>
]
</code></pre>
<p><code>v-if/else-if/else</code> çš„æœ¬è´¨å°±æ˜¯å¤šé‡æ¡ä»¶åˆ¤æ–­ï¼Œåœ¨ JavaScript ä¸­æœ€é€‚åˆç”¨åµŒå¥—ä¸‰å…ƒè¡¨è¾¾å¼æ¥è¡¨è¾¾ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç›®æ ‡ï¼šç”Ÿæˆè¿™æ ·çš„ä»£ç </span>
<span class="hljs-comment">// (a) ? AèŠ‚ç‚¹ : (b) ? BèŠ‚ç‚¹ : CèŠ‚ç‚¹</span>
a ? <span class="hljs-title function_">_c</span>(<span class="hljs-string">'div'</span>, <span class="hljs-string">'A'</span>) : b ? <span class="hljs-title function_">_c</span>(<span class="hljs-string">'div'</span>, <span class="hljs-string">'B'</span>) : <span class="hljs-title function_">_c</span>(<span class="hljs-string">'div'</span>, <span class="hljs-string">'C'</span>)
</code></pre>
<p>æ¥ä¸‹æ¥æ˜¯ä»£ç å®ç°ï¼Œæˆ‘ä»¬å¤„ç† <code>conditions</code> æ—¶ï¼Œæ¯æ¬¡å¼¹å‡ºç¬¬ä¸€ä¸ªæ¡ä»¶å—ï¼Œå¦‚æœä¸ºçœŸï¼Œåˆ™å±•ç¤ºå½“å‰æ¨¡å—ï¼Œå¦‚æœä¸ºå‡ï¼Œåˆ™é€’å½’å¤„ç†å‰©ä½™çš„ <code>conditions</code>ï¼Œå¦‚æœæ²¡æœ‰æ¡ä»¶ï¼ˆv-elseï¼‰ï¼Œåˆ™ç›´æ¥å±•ç¤ºè¯¥æ¨¡å—ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ç”Ÿæˆ v-if æŒ‡ä»¤çš„å…¥å£å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">el</span> - å¸¦æœ‰ v-if çš„ AST èŠ‚ç‚¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">state</span> - æ¸²æŸ“çŠ¶æ€
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} ä¸‰å…ƒè¡¨è¾¾å¼å½¢å¼çš„æ¸²æŸ“ä»£ç 
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genIf</span>(<span class="hljs-params">el, state</span>) {
  <span class="hljs-comment">// æ ‡è®°å·²å¤„ç†ï¼Œé˜²æ­¢é€’å½’æ—¶é‡å¤å¤„ç†</span>
  el.<span class="hljs-property">ifProcessed</span> = <span class="hljs-literal">true</span>
  <span class="hljs-comment">// ä½¿ç”¨ slice() å¤åˆ¶æ•°ç»„ï¼Œé¿å… shift() ä¿®æ”¹åŸå§‹çš„ ifConditions æ•°ç»„</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">genIfConditions</span>(el.<span class="hljs-property">ifConditions</span>.<span class="hljs-title function_">slice</span>(), state)
}

<span class="hljs-comment">/**
 * ç”Ÿæˆ v-if/else-if/else æŒ‡ä»¤çš„æ¸²æŸ“ä»£ç 
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">conditions</span> - æ¡ä»¶æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">state</span> - æ¸²æŸ“çŠ¶æ€
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} ä¸‰å…ƒè¡¨è¾¾å¼å½¢å¼çš„ä»£ç 
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genIfConditions</span>(<span class="hljs-params">conditions, state</span>) {
  <span class="hljs-comment">// é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼šæ‰€æœ‰åˆ†æ”¯éƒ½å¤„ç†å®Œäº† è¿”å›ç©ºèŠ‚ç‚¹</span>
  <span class="hljs-keyword">if</span> (!conditions.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'_e()'</span>

  <span class="hljs-comment">// å–å‡ºç¬¬ä¸€ä¸ªæ¡ä»¶</span>
  <span class="hljs-keyword">const</span> condition = conditions.<span class="hljs-title function_">shift</span>()
  <span class="hljs-keyword">if</span> (condition.<span class="hljs-property">exp</span>) {
    <span class="hljs-comment">// æœ‰æ¡ä»¶è¡¨è¾¾å¼ï¼šv-if æˆ– v-else-if</span>
    <span class="hljs-comment">// ç”Ÿæˆï¼š(æ¡ä»¶) ? æ»¡è¶³æ—¶çš„å†…å®¹ : é€’å½’å¤„ç†å‰©ä½™æ¡ä»¶</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">`(<span class="hljs-subst">${condition.exp}</span>)?<span class="hljs-subst">${genElement(
      condition.block,
      state
    )}</span>:<span class="hljs-subst">${genIfConditions(conditions, state)}</span>`</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æ²¡æœ‰æ¡ä»¶è¡¨è¾¾å¼ï¼šv-else</span>
    <span class="hljs-comment">// å…œåº•åˆ†æ”¯ï¼Œç›´æ¥ç”ŸæˆèŠ‚ç‚¹</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">genElement</span>(condition.<span class="hljs-property">block</span>, state)
  }
}
</code></pre>
<h4 data-id="heading-18">åˆ—è¡¨æ¸²æŸ“ (v-for)</h4>
<p>æœ€åæˆ‘ä»¬å¤„ç† <code>v-for</code> æŒ‡ä»¤ï¼Œè€ƒè™‘ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in items"</span>&gt;</span>{{ item.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>åœ¨ parse é˜¶æ®µï¼Œè¿™ä¸ªæŒ‡ä»¤ä¼šè¢«è§£æä¸º AST èŠ‚ç‚¹çš„å±æ€§ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-attr">for</span>: <span class="hljs-string">"items"</span>,      <span class="hljs-comment">// è¦éå†çš„æ•°æ®æº</span>
  <span class="hljs-attr">alias</span>: <span class="hljs-string">"item"</span>,     <span class="hljs-comment">// å½“å‰é¡¹çš„åˆ«å</span>
  <span class="hljs-attr">iterator1</span>: <span class="hljs-string">"index"</span> <span class="hljs-comment">// ç´¢å¼•çš„åˆ«åï¼ˆå¯é€‰ï¼‰</span>
}
</code></pre>
<p>æˆ‘ä»¬é€šè¿‡<code>_l</code> æ¥è¿›è¡Œéå†ã€‚<code>_l</code> æ˜¯ Vue çš„å†…éƒ¨å‡½æ•° <code>renderList</code>ï¼Œå®ƒçš„ä½œç”¨æ˜¯éå†æ•°ç»„/å¯¹è±¡ï¼Œä¸ºæ¯ä¸€é¡¹è°ƒç”¨æ¸²æŸ“å‡½æ•°ã€‚æˆ‘ä»¬è¦ç”Ÿæˆçš„ä»£ç æ ¼å¼æ˜¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">_l</span>(æ•°æ®æº, <span class="hljs-keyword">function</span> (<span class="hljs-params">item, index</span>) {
  <span class="hljs-keyword">return</span> æ¯ä¸€é¡¹çš„æ¸²æŸ“ä»£ç 
})
</code></pre>
<p>ä»£ç å®ç°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ç”Ÿæˆ v-for æŒ‡ä»¤çš„æ¸²æŸ“ä»£ç 
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">el</span> - å¸¦æœ‰ v-for çš„ AST èŠ‚ç‚¹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">state</span> - æ¸²æŸ“çŠ¶æ€
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} _l() å‡½æ•°è°ƒç”¨ä»£ç 
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genFor</span>(<span class="hljs-params">el, state</span>) {
  <span class="hljs-comment">// 1. æå–éå†çš„ç›¸å…³ä¿¡æ¯</span>
  <span class="hljs-keyword">const</span> exp = el.<span class="hljs-property">for</span> <span class="hljs-comment">// éå†çš„å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> alias = el.<span class="hljs-property">alias</span> <span class="hljs-comment">// åˆ«å item</span>

  <span class="hljs-comment">// 2. å¤„ç†ç´¢å¼•å‚æ•°ï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-comment">// å¦‚æœæœ‰ç´¢å¼•ï¼Œæ ¼å¼ä¸º ",index"ï¼›æ²¡æœ‰åˆ™ä¸ºç©ºå­—ç¬¦ä¸²</span>
  <span class="hljs-keyword">const</span> iterator1 = el.<span class="hljs-property">iterator1</span> ? <span class="hljs-string">`,<span class="hljs-subst">${el.iterator1}</span>`</span> : <span class="hljs-string">''</span>
  <span class="hljs-keyword">const</span> iterator2 = el.<span class="hljs-property">iterator2</span> ? <span class="hljs-string">`,<span class="hljs-subst">${el.iterator2}</span>`</span> : <span class="hljs-string">''</span>

  <span class="hljs-comment">// 3. æ ‡è®°å·²å¤„ç†ï¼Œé˜²æ­¢é€’å½’æ—¶é‡å¤å¤„ç†</span>
  el.<span class="hljs-property">forProcessed</span> = <span class="hljs-literal">true</span>

  <span class="hljs-comment">// 4. ç”Ÿæˆ _l() å‡½æ•°è°ƒç”¨</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">`_l((<span class="hljs-subst">${exp}</span>),function(<span class="hljs-subst">${alias}</span><span class="hljs-subst">${iterator1}</span><span class="hljs-subst">${iterator2}</span>){return <span class="hljs-subst">${genElement(
    el,
    state
  )}</span>})`</span>
}
</code></pre>
<p>æœ€åä¼šè½¬åŒ–ä¸ºä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">_l</span>(items, <span class="hljs-keyword">function</span> (<span class="hljs-params">item, index</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">_c</span>(<span class="hljs-string">'div'</span>, [<span class="hljs-title function_">_v</span>(<span class="hljs-title function_">_s</span>(item.<span class="hljs-property">name</span>))])
})
</code></pre>
<h2 data-id="heading-19">è¿è¡Œå®ä¾‹</h2>
<p>æˆ‘ä»¬å·²ç»å†™å®Œäº†æ¨¡æ¿ç¼–è¯‘ä»£ç ï¼Œå®Œæ•´çš„ä½¿ç”¨æµç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/vue@2.7.16/dist/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// 1. æ¨¡æ¿å­—ç¬¦ä¸²</span>
    <span class="hljs-keyword">const</span> template = <span class="hljs-string">`
      &lt;div&gt;
        &lt;h1&gt;æ­å–œï¼ç¼–è¯‘æˆåŠŸï¼&lt;/h1&gt;
        &lt;h1 v-if="true"&gt;éšæœºæ•°{{ Math.random() }}&lt;/h1&gt;
        &lt;h1 v-if="false"&gt;è¿™é‡Œä¸ä¼šè¢«å±•ç¤º&lt;/h1&gt;
        &lt;h2&gt;
          &lt;span&gt;{{message}}&lt;/span&gt;
          &lt;span v-for="item in list"&gt;{{item}}&lt;/span&gt;
        &lt;/h2&gt;
      &lt;/div&gt;
    `</span>

    <span class="hljs-comment">// 2. ä¸‰æ­¥ç¼–è¯‘ï¼šparse -&gt; optimize -&gt; generate</span>
    <span class="hljs-comment">// ï¼ˆå‡½æ•°å®ç°è§ä¸Šæ–‡ï¼Œè¿™é‡Œçœç•¥ï¼‰</span>
    <span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(template, {...})
    <span class="hljs-title function_">optimize</span>(ast)
    <span class="hljs-keyword">const</span> { render, staticRenderFns } = <span class="hljs-title function_">generate</span>(ast)

    <span class="hljs-comment">// 3. ä½¿ç”¨ç”Ÿæˆçš„ render å‡½æ•°åˆ›å»º Vue å®ä¾‹</span>
    <span class="hljs-keyword">const</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>: {
        <span class="hljs-attr">message</span>: <span class="hljs-string">'Hello'</span>,
        <span class="hljs-attr">list</span>: [<span class="hljs-string">'æˆ‘ä¸åƒ'</span>, <span class="hljs-string">'é¥¼å¹²'</span>, <span class="hljs-string">'ğŸª'</span>],
      },
      <span class="hljs-attr">render</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(render),
      <span class="hljs-attr">staticRenderFns</span>: staticRenderFns.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(fn)),
    })
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>æœ€ç»ˆé¡µé¢å±•ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec3d6f25518c43cb9963c797a79a17f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5LiN5ZCD6aW85bmy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768495627&amp;x-signature=TRuKGX72VNu0HnsQqlfdW6Rc020%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-20">åè®°</h2>
<p>ä»¥å‰çœ‹å¤§ä½¬<a href="https://juejin.cn/user/2330620350708823/posts" target="_blank" title="https://juejin.cn/user/2330620350708823/posts">ssh_æ™¨æ›¦æ—¶æ¢¦è§å…®</a>çš„æ–‡ç« ï¼Œç‰¹åˆ«å–œæ¬¢ä»–é‚£ç§æŠŠé—®é¢˜æ·±å…¥æµ…å‡ºè®²æ˜ç™½çš„æ–‡ç« ã€‚å¯æ˜¯å½“æˆ‘è‡ªå·±å¼€å§‹å†™çš„æ—¶å€™ï¼Œæ‰å‘ç°æƒ³å†™å¥½çœŸçš„å¥½éš¾ã€‚</p>
<p>æœ‰ä»»ä½•é—®é¢˜éƒ½å¯ä»¥åœ¨è¯„è®ºåŒºæå‡ºï¼Œæ„Ÿè°¢å¤§å®¶çœ‹åˆ°è¿™é‡Œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°æ®ç»“æ„-å›¾]]></title>    <link>https://juejin.cn/post/7592903126177497138</link>    <guid>https://juejin.cn/post/7592903126177497138</guid>    <pubDate>2026-01-08T23:46:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592903126177497138" data-draft-id="7590654280900165675" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°æ®ç»“æ„-å›¾"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-08T23:46:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°æ®ç»“æ„-å›¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T23:46:07.000Z" title="Thu Jan 08 2026 23:46:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>å›¾æ˜¯ä¸€ç§è¾ƒä¸ºå¤æ‚çš„éçº¿æ€§ç»“æ„ã€‚ <strong>ä¸ºå•¥è¯´å…¶è¾ƒä¸ºå¤æ‚å‘¢ï¼Ÿ</strong></p>
<p>æ ¹æ®å‰é¢çš„å†…å®¹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼š</p>
<ul>
<li>çº¿æ€§æ•°æ®ç»“æ„çš„å…ƒç´ æ»¡è¶³å”¯ä¸€çš„çº¿æ€§å…³ç³»ï¼Œæ¯ä¸ªå…ƒç´ (é™¤ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå¤–)åªæœ‰ä¸€ä¸ªç›´æ¥å‰è¶‹å’Œä¸€ä¸ªç›´æ¥åç»§ã€‚</li>
<li>æ ‘å½¢æ•°æ®ç»“æ„çš„å…ƒç´ ä¹‹é—´æœ‰ç€æ˜æ˜¾çš„å±‚æ¬¡å…³ç³»ã€‚</li>
</ul>
<p>ä½†æ˜¯ï¼Œå›¾å½¢ç»“æ„çš„å…ƒç´ ä¹‹é—´çš„å…³ç³»æ˜¯ä»»æ„çš„ã€‚</p>
<p><strong>ä½•ä¸ºå›¾å‘¢ï¼Ÿ</strong> ç®€å•æ¥è¯´ï¼Œå›¾å°±æ˜¯ç”±é¡¶ç‚¹çš„æœ‰ç©·éç©ºé›†åˆå’Œé¡¶ç‚¹ä¹‹é—´çš„è¾¹ç»„æˆçš„é›†åˆã€‚é€šå¸¸è¡¨ç¤ºä¸ºï¼š<strong>G(V,E)</strong>ï¼Œå…¶ä¸­ï¼ŒG è¡¨ç¤ºä¸€ä¸ªå›¾ï¼ŒV è¡¨ç¤ºé¡¶ç‚¹çš„é›†åˆï¼ŒE è¡¨ç¤ºè¾¹çš„é›†åˆã€‚</p>
<p>ä¸‹å›¾æ‰€å±•ç¤ºçš„å°±æ˜¯å›¾è¿™ç§æ•°æ®ç»“æ„</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dc43a9c936e408698bda2cdac8298b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=cmX%2Fd4oFK4IRTPJdLcvYrPElQ2o%3D" alt="" loading="lazy"/></p>
<p>åŒæ—¶å›¾â¼œåˆ†ä¸ºæœ‰å‘å›¾ä¸â½†å‘å›¾ï¼Œä¸Šâ¾¯çš„æ˜¯â½†å‘å›¾ï¼Œå› ä¸ºè¾¹æ²¡æœ‰æŒ‡æ˜â½…å‘ï¼Œåªæ˜¯è¡¨ç¤ºä¸¤è€…å…³è”å…³ç³»ï¼Œâ½½æœ‰å‘å›¾åˆ™æ˜¯è¿™æ ·ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cf88382ab4840bc91335185b787700a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=OOUtAX8ydKjdiuvq%2BbZEAH07zZ0%3D" alt="" loading="lazy"/></p>
<p>å›¾åœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„ä¾‹å­å¾ˆå¤šï¼æ¯”å¦‚æˆ‘ä»¬åœ¨ç¤¾äº¤è½¯ä»¶ä¸Šå¥½å‹å…³ç³»å°±å¯ä»¥ç”¨å›¾æ¥è¡¨ç¤ºã€‚</p>
<h2 data-id="heading-1">å›¾çš„åŸºæœ¬æ¦‚å¿µ</h2>
<h3 data-id="heading-2">é¡¶ç‚¹</h3>
<p>å›¾ä¸­çš„æ•°æ®å…ƒç´ ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºé¡¶ç‚¹ï¼Œå›¾è‡³å°‘æœ‰ä¸€ä¸ªé¡¶ç‚¹ï¼ˆéç©ºæœ‰ç©·é›†åˆï¼‰</p>
<p>å¯¹åº”åˆ°å¥½å‹å…³ç³»å›¾ï¼Œæ¯ä¸€ä¸ªç”¨æˆ·å°±ä»£è¡¨ä¸€ä¸ªé¡¶ç‚¹ã€‚</p>
<h3 data-id="heading-3">è¾¹</h3>
<p>é¡¶ç‚¹ä¹‹é—´çš„å…³ç³»ç”¨è¾¹è¡¨ç¤ºã€‚</p>
<p>å¯¹åº”åˆ°å¥½å‹å…³ç³»å›¾ï¼Œä¸¤ä¸ªç”¨æˆ·æ˜¯å¥½å‹çš„è¯ï¼Œé‚£ä¸¤è€…ä¹‹é—´å°±å­˜åœ¨ä¸€æ¡è¾¹ã€‚</p>
<h3 data-id="heading-4">åº¦</h3>
<p>åº¦è¡¨ç¤ºä¸€ä¸ªé¡¶ç‚¹åŒ…å«å¤šå°‘æ¡è¾¹ï¼Œåœ¨æœ‰å‘å›¾ä¸­ï¼Œè¿˜åˆ†ä¸ºå‡ºåº¦å’Œå…¥åº¦ï¼Œå‡ºåº¦è¡¨ç¤ºä»è¯¥é¡¶ç‚¹å‡ºå»çš„è¾¹çš„æ¡æ•°ï¼Œå…¥åº¦è¡¨ç¤ºè¿›å…¥è¯¥é¡¶ç‚¹çš„è¾¹çš„æ¡æ•°ã€‚</p>
<p>å¯¹åº”åˆ°å¥½å‹å…³ç³»å›¾ï¼Œåº¦å°±ä»£è¡¨äº†æŸä¸ªäººçš„å¥½å‹æ•°é‡ã€‚</p>
<h3 data-id="heading-5">æ— å‘å›¾å’Œæœ‰å‘å›¾</h3>
<p>è¾¹è¡¨ç¤ºçš„æ˜¯é¡¶ç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œæœ‰çš„å…³ç³»æ˜¯åŒå‘çš„ï¼Œæ¯”å¦‚åŒå­¦å…³ç³»ï¼ŒA æ˜¯ B çš„åŒå­¦ï¼Œé‚£ä¹ˆ B ä¹Ÿè‚¯å®šæ˜¯ A çš„åŒå­¦ï¼Œé‚£ä¹ˆåœ¨è¡¨ç¤º A å’Œ B çš„å…³ç³»æ—¶ï¼Œå°±ä¸ç”¨å…³æ³¨æ–¹å‘ï¼Œç”¨ä¸å¸¦ç®­å¤´çš„è¾¹è¡¨ç¤ºï¼Œè¿™æ ·çš„å›¾å°±æ˜¯æ— å‘å›¾ã€‚</p>
<p>æœ‰çš„å…³ç³»æ˜¯æœ‰æ–¹å‘çš„ï¼Œæ¯”å¦‚çˆ¶å­å…³ç³»ï¼Œå¸ˆç”Ÿå…³ç³»ï¼Œå¾®åšçš„å…³æ³¨å…³ç³»ï¼ŒA æ˜¯ B çš„çˆ¸çˆ¸ï¼Œä½† B è‚¯å®šä¸æ˜¯ A çš„çˆ¸çˆ¸ï¼ŒA å…³æ³¨ Bï¼ŒB ä¸ä¸€å®šå…³æ³¨ Aã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±ç”¨å¸¦ç®­å¤´çš„è¾¹è¡¨ç¤ºäºŒè€…çš„å…³ç³»ï¼Œè¿™æ ·çš„å›¾å°±æ˜¯æœ‰å‘å›¾ã€‚</p>
<h3 data-id="heading-6">æ— æƒå›¾å’Œå¸¦æƒå›¾</h3>
<p>å¯¹äºä¸€ä¸ªå…³ç³»ï¼Œå¦‚æœæˆ‘ä»¬åªå…³å¿ƒå…³ç³»çš„æœ‰æ— ï¼Œè€Œä¸å…³å¿ƒå…³ç³»æœ‰å¤šå¼ºï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨æ— æƒå›¾è¡¨ç¤ºäºŒè€…çš„å…³ç³»ã€‚</p>
<p>å¯¹äºä¸€ä¸ªå…³ç³»ï¼Œå¦‚æœæˆ‘ä»¬æ—¢å…³å¿ƒå…³ç³»çš„æœ‰æ— ï¼Œä¹Ÿå…³å¿ƒå…³ç³»çš„å¼ºåº¦ï¼Œæ¯”å¦‚æè¿°åœ°å›¾ä¸Šä¸¤ä¸ªåŸå¸‚çš„å…³ç³»ï¼Œéœ€è¦ç”¨åˆ°è·ç¦»ï¼Œé‚£ä¹ˆå°±ç”¨å¸¦æƒå›¾æ¥è¡¨ç¤ºï¼Œå¸¦æƒå›¾ä¸­çš„æ¯ä¸€æ¡è¾¹ä¸€ä¸ªæ•°å€¼è¡¨ç¤ºæƒå€¼ï¼Œä»£è¡¨å…³ç³»çš„å¼ºåº¦ã€‚</p>
<p>ä¸‹å›¾å°±æ˜¯ä¸€ä¸ªå¸¦æƒæœ‰å‘å›¾ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a05e5aeb97141d889589d12702c9807~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=9aiKRy7kfpAxdCcla1b5apLCG%2FA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">å›¾çš„å­˜å‚¨</h2>
<h3 data-id="heading-8">é‚»æ¥çŸ©é˜µå­˜å‚¨</h3>
<p>é‚»æ¥çŸ©é˜µå°†å›¾ç”¨äºŒç»´çŸ©é˜µå­˜å‚¨ï¼Œæ˜¯ä¸€ç§è¾ƒä¸ºç›´è§‚çš„è¡¨ç¤ºæ–¹å¼ã€‚</p>
<p>å¦‚æœç¬¬ i ä¸ªé¡¶ç‚¹å’Œç¬¬ j ä¸ªé¡¶ç‚¹ä¹‹é—´æœ‰å…³ç³»ï¼Œä¸”å…³ç³»æƒå€¼ä¸º nï¼Œåˆ™ <code>A[i][j]=n</code> ã€‚</p>
<p>åœ¨æ— å‘å›¾ä¸­ï¼Œæˆ‘ä»¬åªå…³å¿ƒå…³ç³»çš„æœ‰æ— ï¼Œæ‰€ä»¥å½“é¡¶ç‚¹ i å’Œé¡¶ç‚¹ j æœ‰å…³ç³»æ—¶ï¼Œ<code>A[i][j]</code>=1ï¼Œå½“é¡¶ç‚¹ i å’Œé¡¶ç‚¹ j æ²¡æœ‰å…³ç³»æ—¶ï¼Œ<code>A[i][j]</code>=0ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/185ca489f20440e5b42a13b8eb619753~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=dghCxwRFEV2Bi44r9aU6%2BVbtsVs%3D" alt="" loading="lazy"/></p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š<strong>æ— å‘å›¾çš„é‚»æ¥çŸ©é˜µæ˜¯ä¸€ä¸ªå¯¹ç§°çŸ©é˜µï¼Œå› ä¸ºåœ¨æ— å‘å›¾ä¸­ï¼Œé¡¶ç‚¹ i å’Œé¡¶ç‚¹ j æœ‰å…³ç³»ï¼Œåˆ™é¡¶ç‚¹ j å’Œé¡¶ç‚¹ i å¿…æœ‰å…³ç³»ã€‚</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46e11a93fe90447d83eb3399cb03b0a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=5Nlkkqn9HO0MbvUEa%2FQmYue6SkM%3D" alt="" loading="lazy"/></p>
<p>é‚»æ¥çŸ©é˜µå­˜å‚¨çš„æ–¹å¼ä¼˜ç‚¹æ˜¯ç®€å•ç›´æ¥ï¼ˆç›´æ¥ä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„å³å¯ï¼‰ï¼Œå¹¶ä¸”ï¼Œåœ¨è·å–ä¸¤ä¸ªå®šç‚¹ä¹‹é—´çš„å…³ç³»çš„æ—¶å€™ä¹Ÿéå¸¸é«˜æ•ˆï¼ˆç›´æ¥è·å–æŒ‡å®šä½ç½®çš„æ•°ç»„å…ƒç´ çš„å€¼å³å¯ï¼‰ã€‚ä½†æ˜¯ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼çš„ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œé‚£å°±æ˜¯æ¯”è¾ƒæµªè´¹ç©ºé—´ï¼Œ</p>
<h3 data-id="heading-9">é‚»æ¥è¡¨å­˜å‚¨</h3>
<p>é’ˆå¯¹ä¸Šé¢é‚»æ¥çŸ©é˜µæ¯”è¾ƒæµªè´¹å†…å­˜ç©ºé—´çš„é—®é¢˜ï¼Œè¯ç”Ÿäº†å›¾çš„å¦å¤–ä¸€ç§å­˜å‚¨æ–¹æ³•â€”<strong>é‚»æ¥è¡¨</strong> ã€‚</p>
<p>é‚»æ¥é“¾è¡¨ä½¿ç”¨ä¸€ä¸ªé“¾è¡¨æ¥å­˜å‚¨æŸä¸ªé¡¶ç‚¹çš„æ‰€æœ‰åç»§ç›¸é‚»é¡¶ç‚¹ã€‚å¯¹äºå›¾ä¸­æ¯ä¸ªé¡¶ç‚¹ Viï¼ŒæŠŠæ‰€æœ‰é‚»æ¥äº Vi çš„é¡¶ç‚¹ Vj é“¾æˆä¸€ä¸ªå•é“¾è¡¨ï¼Œè¿™ä¸ªå•é“¾è¡¨ç§°ä¸ºé¡¶ç‚¹ Vi çš„ <strong>é‚»æ¥è¡¨</strong>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4baae108fa2e45278185092be229e602~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=fcv85XmGi%2B8iZiEp0asf%2BcUZLXg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6667a924b41409ebc3752568201988d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=VUlT2NEnw1ABH0o%2Bmwvq1x6snzM%3D" alt="" loading="lazy"/></p>
<p>å¤§å®¶å¯ä»¥æ•°ä¸€æ•°é‚»æ¥è¡¨ä¸­æ‰€å­˜å‚¨çš„å…ƒç´ çš„ä¸ªæ•°ä»¥åŠå›¾ä¸­è¾¹çš„æ¡æ•°ï¼Œä½ ä¼šå‘ç°ï¼š</p>
<ul>
<li>åœ¨æ— å‘å›¾ä¸­ï¼Œé‚»æ¥è¡¨å…ƒç´ ä¸ªæ•°ç­‰äºè¾¹çš„æ¡æ•°çš„ä¸¤å€ï¼Œå¦‚å·¦å›¾æ‰€ç¤ºçš„æ— å‘å›¾ä¸­ï¼Œè¾¹çš„æ¡æ•°ä¸º 7ï¼Œé‚»æ¥è¡¨å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ä¸º 14ã€‚</li>
<li>åœ¨æœ‰å‘å›¾ä¸­ï¼Œé‚»æ¥è¡¨å…ƒç´ ä¸ªæ•°ç­‰äºè¾¹çš„æ¡æ•°ï¼Œå¦‚å³å›¾æ‰€ç¤ºçš„æœ‰å‘å›¾ä¸­ï¼Œè¾¹çš„æ¡æ•°ä¸º 8ï¼Œé‚»æ¥è¡¨å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ä¸º 8ã€‚</li>
</ul>
<h2 data-id="heading-10">å›¾çš„æœç´¢</h2>
<p>å›¾â¾¥â¾¯éå†â¼€èˆ¬åˆ†ä¸ºâ¼´åº¦ä¼˜å…ˆéå†å’Œæ·±åº¦ä¼˜å…ˆéå†ï¼Œâ¼´åº¦ä¼˜å…ˆéå†æ˜¯æŒ‡ä¼˜å…ˆéå†ä¸å½“å‰é¡¶ç‚¹ç›´æ¥ç›¸å…³çš„é¡¶ç‚¹ï¼Œâ¼€èˆ¬å€ŸåŠ©é˜Ÿåˆ—å®ç°ã€‚â½½æ·±åº¦ä¼˜å…ˆéå†åˆ™æ˜¯å¾€â¼€ä¸ªâ½…å‘â¼€ç›´â¾›åˆ°ä¸èƒ½å†â¾›ï¼Œæœ‰ç‚¹ä¸æ’å—å¢™ä¸å›å¤´çš„æ„æ€ï¼Œâ¼€èˆ¬ä½¿â½¤é€’å½’å®ç°ã€‚</p>
<h3 data-id="heading-11">å¹¿åº¦ä¼˜å…ˆæœç´¢</h3>
<p>å¹¿åº¦ä¼˜å…ˆæœç´¢å°±åƒæ°´é¢ä¸Šçš„æ³¢çº¹ä¸€æ ·ä¸€å±‚ä¸€å±‚å‘å¤–æ‰©å±•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14ce5fbac1a24d75ad1de1a5f325f0a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=PgVwVWpGD%2F7nmNcTVqABWEFZSso%3D" alt="" loading="lazy"/></p>
<p><strong>å¹¿åº¦ä¼˜å…ˆæœç´¢çš„å…·ä½“å®ç°æ–¹å¼ç”¨åˆ°äº†ä¹‹å‰æ‰€å­¦è¿‡çš„çº¿æ€§æ•°æ®ç»“æ„â€”â€”é˜Ÿåˆ—</strong> ã€‚å…·ä½“è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><strong>ç¬¬ 1 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65eab35ef51a4371bdc854ed4bbfba06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=zHhoS2xPkyw7QtL0fjuviCdMdNs%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 2 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7872c9b8ee1b44c8b3d1aad1c66bddf5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=KJo2FGKsNxgbdRIX69rfzSN3mMM%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 3 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/caaec7f08aaf449baa1b30bcc85234c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=yBuAaFJqLOXTM5jRYq2IpxwGKkI%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 4 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/748a27dd05b24acca9f0045835964c0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=UY4sMjdPkRl5Xkc%2B8KYFdUbq020%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 5 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1808d9cef56c453b9625c00e35a9ad60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=PNIXXFFDYCGhsKHr%2B5I0z5fCOss%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 6 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db09e6ccdae64a51ad5e8aa78473487f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=jGJNikjtnYKTtVLYRCHEF2BW0cs%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">æ·±åº¦ä¼˜å…ˆæœç´¢</h3>
<p>æ·±åº¦ä¼˜å…ˆæœç´¢å°±æ˜¯â€œä¸€æ¡è·¯èµ°åˆ°é»‘â€ï¼Œä»æºé¡¶ç‚¹å¼€å§‹ï¼Œä¸€ç›´èµ°åˆ°æ²¡æœ‰åç»§èŠ‚ç‚¹ï¼Œæ‰å›æº¯åˆ°ä¸Šä¸€é¡¶ç‚¹ï¼Œç„¶åç»§ç»­â€œä¸€æ¡è·¯èµ°åˆ°é»‘â€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/949f8ceddb764b87aaf63c92eb3f7bb0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=iMt6jbZEhytzI9pa%2Btx5h35Yrmk%3D" alt="" loading="lazy"/></p>
<p><strong>å’Œå¹¿åº¦ä¼˜å…ˆæœç´¢ç±»ä¼¼ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢çš„å…·ä½“å®ç°ç”¨åˆ°äº†å¦ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„â€”â€”æ ˆ</strong> ã€‚å…·ä½“è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><strong>ç¬¬ 1 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39f20df13c5a4a3facba7cffe4aed8ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=OG97BQfo%2BWvXIrbZIei76bn0uTU%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 2 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be6ff20741fe44a49530b2d6c05241bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=GFPfZsKpIA6U7czJdVNn19U7Lx4%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 3 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab97fccc1ec84befa42fc9f82c99960f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=91YjgQCNIn3FCOt4e9Ub%2F638TB4%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 4 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3541eacb582549d78c1f70a2725a4134~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=rMtrBTMKvgYsM6LKXvXAG7cvOE4%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 5 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/537873b1f84e42d691f02756bdba884d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=CkhJ7bmc6FPT9U3TOAimnt7dzKE%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ 6 æ­¥ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e16fa3b260a14fefa1cd0d9839b16b10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768520766&amp;x-signature=YZqciLNvwbVPyW24abnz3zZmw9A%3D" alt="" loading="lazy"/></p>
<p>ç®—æ³•æ¡†æ¶å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•è¢«éå†è¿‡çš„èŠ‚ç‚¹</span>
<span class="hljs-type">boolean</span>[] visited;
<span class="hljs-comment">// è®°å½•ä»èµ·ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„</span>
<span class="hljs-type">boolean</span>[] onPath;

<span class="hljs-comment">/* å›¾éå†æ¡†æ¶ */</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">traverse</span><span class="hljs-params">(Graph graph, <span class="hljs-type">int</span> s)</span> {
    <span class="hljs-keyword">if</span> (visited[s]) <span class="hljs-keyword">return</span>;
    <span class="hljs-comment">// ç»è¿‡èŠ‚ç‚¹ sï¼Œæ ‡è®°ä¸ºå·²éå†</span>
    visited[s] = <span class="hljs-literal">true</span>;
    <span class="hljs-comment">// åšé€‰æ‹©ï¼šæ ‡è®°èŠ‚ç‚¹ s åœ¨è·¯å¾„ä¸Š</span>
    onPath[s] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> neighbor : graph.neighbors(s)) {
        traverse(graph, neighbor);
    }
    <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šèŠ‚ç‚¹ s ç¦»å¼€è·¯å¾„</span>
    onPath[s] = <span class="hljs-literal">false</span>;
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOSä¸€æ¯å†°ç¾å¼çš„æ—¶é—´ -- @Env]]></title>    <link>https://juejin.cn/post/7592823500417187866</link>    <guid>https://juejin.cn/post/7592823500417187866</guid>    <pubDate>2026-01-08T18:00:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592823500417187866" data-draft-id="7592833068223610926" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOSä¸€æ¯å†°ç¾å¼çš„æ—¶é—´ -- @Env"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2026-01-08T18:00:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çŒ«çŒ«å¤´å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/1283876003519357"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOSä¸€æ¯å†°ç¾å¼çš„æ—¶é—´ -- @Env
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1283876003519357/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çŒ«çŒ«å¤´å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T18:00:36.000Z" title="Thu Jan 08 2026 18:00:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>è¯¥ç³»åˆ—ä¾æ—§ä¼šå¸¦ç€å¤§å®¶ï¼Œäº†è§£ï¼Œå¼€é˜”ä¸€äº›ä¸æ€ä¹ˆçƒ­é—¨çš„APIï¼Œä¹Ÿå¯èƒ½æ˜¯å·å·è¢«æ›´æ–°çš„APIï¼Œä¹Ÿå¯ä»¥æ˜¯å¥½ç©çš„ï¼Œè—åœ¨å®˜æ–¹æ–‡æ¡£çš„è¾¹è¾¹è§’è§’~å½“ç„¶ä¹Ÿä¼šæœ‰ä¸€äº›APIï¼Œä¹‹å‰æ˜¯æˆ‘ä»¬è¾›è¾›è‹¦è‹¦çš„æ‰‹æ’¸ä»£ç ï¼Œç°åœ¨æœ‰ä¸€ä¸ªAPIèƒ½å¸®æˆ‘ä»¬å¿«é€Ÿå®ç°çš„ï¼Œå¸Œæœ›å¤§å®¶èƒ½æ‰¾å®è—ã€‚</p>
<p>å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®ã€å¯¹æ–‡ç« å†™çš„ä¸æ»¡æ„ã€å‘ç°é”™è¯¯æˆ–è€…æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œæ¬¢è¿åœ¨è¯„è®ºã€ç§ä¿¡æˆ–é‚®ä»¶ä¸­æå‡ºï¼Œéå¸¸æ„Ÿè°¢æ‚¨çš„æ”¯æŒã€‚ğŸ™</p>
<h2 data-id="heading-1">äºŒã€@Envçš„è¯ç”ŸèƒŒæ™¯</h2>
<p>OKï¼Œæ­¥å…¥æ­£é¢˜æŠŠï¼Œåœ¨å¤šè®¾å¤‡å¼€å‘çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æ ¹æ®ä¸åŒçš„è®¾å¤‡ç¯å¢ƒï¼ˆæ¯”å¦‚çª—å£å¤§å°ã€æ¨ªç«–å±ç­‰ï¼‰æ¥è°ƒæ•´UIå¸ƒå±€ã€‚ä»¥å‰æˆ‘ä»¬å¯èƒ½è¦ç”¨<code>Environment</code>æ¥è·å–è¿™äº›ä¿¡æ¯ï¼Œä½†<code>Environment</code>æœ‰ä¸ªé—®é¢˜ï¼šå®ƒæ²¡æœ‰å“åº”å¼èƒ½åŠ›ï¼Œç³»ç»Ÿç¯å¢ƒå˜é‡å˜åŒ–æ—¶ä¸ä¼šè‡ªåŠ¨é€šçŸ¥ç»„ä»¶åˆ·æ–°ã€‚è¿™å°±å¯¼è‡´æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç›‘å¬å˜åŒ–ï¼Œå†™å¾ˆå¤šé‡å¤çš„ä»£ç ã€‚è™½ç„¶ï¼Œè™½ç„¶å•Šï¼Œä»–èƒ½å­˜åˆ°AppStorageé‡Œé¢å»ï¼Œä½†æ˜¯å»ç›‘å¬ä¸€å †çš„ç¯å¢ƒå˜é‡çš„å˜åŒ–ï¼Œç„¶åè®¾ç½®åˆ°AppStorageé‡Œé¢å»å¾ˆä¸ä¼˜é›…å•Šã€‚</p>
<p>å¥½åœ¨API 22å¼•å…¥äº†<code>@Env</code>è£…é¥°å™¨ï¼ˆæœ‰ç‚¹æ™šäº†ï¼‰ï¼Œå®ƒä¸ä»…èƒ½è¯»å–ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œè¿˜èƒ½åœ¨ç¯å¢ƒå˜é‡å˜åŒ–æ—¶è‡ªåŠ¨è§¦å‘ç»„ä»¶åˆ·æ–°ï¼Œçˆ½ï¼</p>
<h3 data-id="heading-2">1. Environmentçš„å±€é™æ€§</h3>
<p><code>Environment</code>æ˜¯ArkUIæ¡†æ¶æä¾›çš„è®¾å¤‡ç¯å¢ƒæŸ¥è¯¢èƒ½åŠ›ï¼Œå®ƒå¯ä»¥å°†ç³»ç»Ÿç¯å¢ƒå˜é‡å­˜å…¥<code>AppStorage</code>ï¼Œè®©æˆ‘ä»¬é€šè¿‡<code>@StorageProp</code>æ¥è®¿é—®ã€‚ä½†æ˜¯<code>Environment</code>æœ‰ä¸ªè‡´å‘½çš„ç¼ºç‚¹ï¼š<strong>æ²¡æœ‰å“åº”å¼èƒ½åŠ›</strong>ã€‚</p>
<p>å•¥æ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´å½“ç³»ç»Ÿç¯å¢ƒå˜é‡å˜åŒ–çš„æ—¶å€™ï¼ˆæ¯”å¦‚æ¨ªç«–å±åˆ‡æ¢ï¼‰ï¼Œ<code>Environment</code>ä¸ä¼šè‡ªåŠ¨é€šçŸ¥ç»„ä»¶åˆ·æ–°ã€‚æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç›‘å¬å˜åŒ–ï¼ˆé‡ç‚¹åœ¨è¿™ï¼‰ï¼Œç„¶åæ‰‹åŠ¨æ›´æ–°UIã€‚è¿™å°±å¯¼è‡´ä»£ç å˜å¾—å¤æ‚ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚</p>
<h3 data-id="heading-3">2. @Envçš„è§£å†³æ–¹æ¡ˆ</h3>
<p>API 22å¼•å…¥çš„<code>@Env</code>è£…é¥°å™¨å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®ƒæ˜¯ä¸€ä¸ª<strong>å“åº”å¼ç³»ç»Ÿç¯å¢ƒå˜é‡è£…é¥°å™¨</strong>ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>è‡ªåŠ¨å“åº”</strong>ï¼šç³»ç»Ÿç¯å¢ƒå˜é‡å˜åŒ–æ—¶ï¼Œè‡ªåŠ¨é€šçŸ¥<code>@Env</code>è£…é¥°çš„å˜é‡æ›´æ–°</li>
<li><strong>è‡ªåŠ¨åˆ·æ–°</strong>ï¼š<code>@Env</code>å…³è”çš„ç»„ä»¶ä¼šè‡ªåŠ¨åˆ·æ–°ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†</li>
<li><strong>ç®€åŒ–ä»£ç </strong>ï¼šå‡å°‘äº†å¤§é‡é‡å¤çš„é€‚é…é€»è¾‘
ï¼ˆPSï¼šæˆ‘æœ€åè¿˜ä¼šé‡å¤è¿™ä¸€æ®µï¼‰
ç®€å•æ¥è¯´ï¼Œ<code>@Env</code>è®©ç¯å¢ƒå˜é‡çš„ä½¿ç”¨å˜å¾—åƒçŠ¶æ€å˜é‡ä¸€æ ·ç®€å•ï¼Œä½ åªéœ€è¦å£°æ˜ä¸€ä¸ª<code>@Env</code>å˜é‡ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨å¸®ä½ å¤„ç†å“åº”å¼æ›´æ–°ã€‚</li>
</ul>
<h2 data-id="heading-4">ä¸‰ã€@EnvåŸºç¡€æ¦‚å¿µ</h2>
<p>ä¸‹é¢ä¸¤æ¡æœ‰ä¸€æ¡æ˜¯å¥½æ¶ˆæ¯ï¼š</p>
<ul>
<li>ä»API version 22å¼€å§‹ï¼Œ<code>@Env</code>æ”¯æŒåœ¨<code>@Component</code>å’Œ<code>@ComponentV2</code>ä¸­ä½¿ç”¨ï¼ˆèƒ½åœ¨V1ä½¿ç”¨å“¦ï¼‰</li>
<li>ä»API version 22å¼€å§‹ï¼Œè¯¥è£…é¥°å™¨æ”¯æŒåœ¨å…ƒæœåŠ¡ä¸­ä½¿ï¼ˆé«˜è´µ22ï¼‰</li>
</ul>
<h4 data-id="heading-5">ï¼ˆ1ï¼‰è¯»å–ç¯å¢ƒå˜é‡</h4>
<ul>
<li><strong>ç›®å‰ä»…æ”¯æŒ<code>SystemProperties.BREAK_POINT</code>ï¼</strong></li>
<li><strong>ç›®å‰ä»…æ”¯æŒ<code>SystemProperties.BREAK_POINT</code>ï¼</strong></li>
<li><strong>ç›®å‰ä»…æ”¯æŒ<code>SystemProperties.BREAK_POINT</code>ï¼</strong></li>
</ul>
<p>é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼ï¼ï¼ï¼ï¼ï¼</p>
<p><code>@Env</code>å¯ä»¥æ ¹æ®å…¥å‚è¯»å–ç›¸åº”çš„ç¯å¢ƒå˜é‡ä¿¡æ¯ã€‚ç›®å‰ä»…æ”¯æŒ<code>SystemProperties.BREAK_POINT</code>ï¼Œç”¨äºè·å–çª—å£ä¸åŒå®½é«˜é˜ˆå€¼ä¸‹å¯¹åº”çš„æ–­ç‚¹å€¼ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { uiObserver } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-comment">// ä½¿ç”¨@Envè£…é¥°å™¨è·å–çª—å£æ–­ç‚¹ä¿¡æ¯</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// å¯ä»¥ç›´æ¥ä½¿ç”¨breakpointè·å–å®½åº¦å’Œé«˜åº¦æ–­ç‚¹</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`å®½åº¦æ–­ç‚¹: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`é«˜åº¦æ–­ç‚¹: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>)
    }
  }
}
</code></pre>
<h4 data-id="heading-6">ï¼ˆ2ï¼‰å“åº”å¼æ›´æ–°</h4>
<p>å½“ç³»ç»Ÿç¯å¢ƒå˜é‡æ”¹å˜æ—¶ï¼ˆæ¯”å¦‚æ¨ªç«–å±åˆ‡æ¢ã€çª—å£å¤§å°è°ƒæ•´ï¼‰ï¼Œ<code>@Env</code>ä¼šè‡ªåŠ¨ï¼š</p>
<ul>
<li>é€šçŸ¥<code>@Env</code>è£…é¥°å˜é‡çš„æ›´æ–°</li>
<li>è§¦å‘<code>@Env</code>å…³è”ç»„ä»¶çš„åˆ·æ–°</li>
<li>å®ç°ç•Œé¢å†…å®¹çš„åŒæ­¥æ›´æ–°</li>
</ul>
<p>ä¸éœ€è¦æ‰‹åŠ¨ç›‘å¬å˜åŒ–ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨å¤„ç†ã€‚</p>
<h4 data-id="heading-7">ï¼ˆ3ï¼‰å¯è§‚å¯Ÿå¯¹è±¡</h4>
<p><code>@Env</code>è¿”å›çš„å¯¹è±¡å®é™…ä¸Šæ˜¯ç”±<code>@ObservedV2</code>è£…é¥°çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå…¶å±æ€§ç”±<code>@Trace</code>è£…é¥°ã€‚è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>ä½ å¯ä»¥ä½¿ç”¨<code>addMonitor</code>æ¥ç›‘å¬å±æ€§çš„å˜åŒ–</li>
<li>å±æ€§çš„å˜åŒ–ä¼šè‡ªåŠ¨è§¦å‘UIæ›´æ–°</li>
<li>æ”¯æŒç»†ç²’åº¦çš„å“åº”å¼æ›´æ–°</li>
</ul>
<h2 data-id="heading-8">äº”ã€@EnvåŸºæœ¬ä½¿ç”¨</h2>
<h3 data-id="heading-9">1. åœ¨@ComponentV2ä¸­ä½¿ç”¨@Env</h3>
<p>åœ¨<code>@ComponentV2</code>ä¸­ä½¿ç”¨<code>@Env</code>éå¸¸ç®€å•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { uiObserver, <span class="hljs-title class_">UIUtils</span>, <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;
<span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-comment">// å£°æ˜@Envå˜é‡ï¼Œè·å–çª—å£æ–­ç‚¹ä¿¡æ¯</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-comment">// åˆ‡æ¢æ¨ªç«–å±çš„æ–¹æ³•</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">changeOrientation</span>(<span class="hljs-params">isLandscape: <span class="hljs-built_in">boolean</span></span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getLastWindow</span>(context).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">lastWindow</span>) =&gt;</span> {
      <span class="hljs-comment">// è®¾ç½®çª—å£æ–¹å‘</span>
      lastWindow.<span class="hljs-title function_">setPreferredOrientation</span>(
        isLandscape ? <span class="hljs-variable language_">window</span>.<span class="hljs-property">Orientation</span>.<span class="hljs-property">LANDSCAPE</span> : <span class="hljs-variable language_">window</span>.<span class="hljs-property">Orientation</span>.<span class="hljs-property">PORTRAIT</span>
      );
    });
  }

  <span class="hljs-comment">// ç›‘å¬æ–­ç‚¹å˜åŒ–çš„å›è°ƒ</span>
  <span class="hljs-title function_">orientationChange</span>(<span class="hljs-params">mon: IMonitor</span>) {
    mon.<span class="hljs-property">dirty</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">path: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${path}</span> changes from <span class="hljs-subst">${mon.value(path)?.before}</span> to <span class="hljs-subst">${mon.value(path)?.now}</span>`</span>);
    })
  }

  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// @Envè¿”å›çš„å¯¹è±¡å®é™…ä¸Šæ˜¯@ObservedV2è£…é¥°çš„å¯¹è±¡ï¼ˆå…¶å±æ€§æ˜¯@Traceè£…é¥°çš„ï¼‰</span>
    <span class="hljs-comment">// æ‰€ä»¥å…¶å±æ€§çš„æ”¹å˜å¯ä»¥é€šè¿‡addMonitorç›‘å¬</span>
    <span class="hljs-title class_">UIUtils</span>.<span class="hljs-title function_">addMonitor</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span>,
      [<span class="hljs-string">'widthBreakpoint'</span>, <span class="hljs-string">'heightBreakpoint'</span>],
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">orientationChange</span>
    );
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// æ˜¾ç¤ºå½“å‰æ–­ç‚¹ä¿¡æ¯</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Index breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Index breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)

      <span class="hljs-comment">// æ¨ªå±æŒ‰é’®</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Landscape'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeOrientation</span>(<span class="hljs-literal">true</span>);
      })

      <span class="hljs-comment">// ç«–å±æŒ‰é’®</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Portrait'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeOrientation</span>(<span class="hljs-literal">false</span>);
      })

      <span class="hljs-comment">// å°†@Envå˜é‡ä¼ é€’ç»™å­ç»„ä»¶</span>
      <span class="hljs-title class_">CompV2</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
      <span class="hljs-title class_">Comp</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
    }
  }
}

<span class="hljs-comment">// ComponentV2å­ç»„ä»¶</span>
<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">CompV2</span> {
  <span class="hljs-comment">// @Envè£…é¥°çš„å˜é‡åªèƒ½ç”¨äºåˆå§‹åŒ–@Paramè£…é¥°çš„å˜é‡</span>
  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`CompV2 breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`CompV2 breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
    }
  }
}

<span class="hljs-comment">// Componentå­ç»„ä»¶</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Comp</span> {
  <span class="hljs-comment">// @Envè£…é¥°çš„å˜é‡åªèƒ½ç”¨äºåˆå§‹åŒ–å¸¸è§„å˜é‡</span>
  <span class="hljs-meta">@Require</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Comp breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Comp breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
    }
  }
}
</code></pre>
<h3 data-id="heading-10">2. åœ¨@Componentä¸­ä½¿ç”¨@Env</h3>
<p><code>@Env</code>åœ¨<code>@Component</code>ä¸­çš„ä½¿ç”¨æ–¹å¼å’Œ<code>@ComponentV2</code>ç±»ä¼¼ï¼Œæˆ‘ä»¬çœ‹çœ‹ä»£ç ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { uiObserver, <span class="hljs-title class_">UIUtils</span>, <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;
<span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-comment">// åœ¨@Componentä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨@Env</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">changeOrientation</span>(<span class="hljs-params">isLandscape: <span class="hljs-built_in">boolean</span></span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getLastWindow</span>(context).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">lastWindow</span>) =&gt;</span> {
      lastWindow.<span class="hljs-title function_">setPreferredOrientation</span>(
        isLandscape ? <span class="hljs-variable language_">window</span>.<span class="hljs-property">Orientation</span>.<span class="hljs-property">LANDSCAPE</span> : <span class="hljs-variable language_">window</span>.<span class="hljs-property">Orientation</span>.<span class="hljs-property">PORTRAIT</span>
      );
    });
  }

  <span class="hljs-title function_">orientationChange</span>(<span class="hljs-params">mon: IMonitor</span>) {
    mon.<span class="hljs-property">dirty</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">path: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${path}</span> changes from <span class="hljs-subst">${mon.value(path)?.before}</span> to <span class="hljs-subst">${mon.value(path)?.now}</span>`</span>);
    })
  }

  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// åŒæ ·å¯ä»¥ä½¿ç”¨addMonitorç›‘å¬</span>
    <span class="hljs-title class_">UIUtils</span>.<span class="hljs-title function_">addMonitor</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span>,
      [<span class="hljs-string">'widthBreakpoint'</span>, <span class="hljs-string">'heightBreakpoint'</span>],
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">orientationChange</span>
    );
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Index breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Index breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Landscape'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeOrientation</span>(<span class="hljs-literal">true</span>);
      })

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Portrait'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeOrientation</span>(<span class="hljs-literal">false</span>);
      })

      <span class="hljs-title class_">CompV2</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
      <span class="hljs-title class_">Comp</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
    }
  }
}

<span class="hljs-comment">// å­ç»„ä»¶ä½¿ç”¨æ–¹å¼ç›¸åŒ</span>
<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">CompV2</span> {
  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`CompV2 breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`CompV2 breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Comp</span> {
  <span class="hljs-meta">@Require</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Comp breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Comp breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
    }
  }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>@Component</code>å’Œ<code>@ComponentV2</code>ä¸­ä½¿ç”¨<code>@Env</code>çš„æ–¹å¼åŸºæœ¬ä¸€è‡´ï¼Œä¸»è¦åŒºåˆ«åœ¨äºå­ç»„ä»¶æ¥æ”¶å‚æ•°çš„æ–¹å¼ã€‚</p>
<h3 data-id="heading-11">3. å˜é‡ä¼ é€’è§„åˆ™</h3>
<p><code>@Env</code>è£…é¥°çš„å˜é‡åœ¨ç»„ä»¶é—´ä¼ é€’æœ‰ä¸¥æ ¼çš„è§„åˆ™ï¼Œæˆ‘ä»¬éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
<h4 data-id="heading-12">ï¼ˆ1ï¼‰ä¼ é€’ç»™ComponentV2å­ç»„ä»¶</h4>
<p><code>@Env</code>è£…é¥°çš„å˜é‡<strong>åªèƒ½</strong>ç”¨äºåˆå§‹åŒ–<code>@ComponentV2</code>ä¸­<code>@Param</code>è£…é¥°çš„å˜é‡ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä¼ é€’ç»™@Param</span>
      <span class="hljs-title class_">CompV2</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })

      <span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½ä¼ é€’ç»™é@Paramå˜é‡</span>
      <span class="hljs-title class_">CompV2Invalid</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
    }
  }
}

<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">CompV2</span> {
  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨@Require @Paramæ¥æ”¶</span>
  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ...</span>
  }
}

<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">CompV2Invalid</span> {
  <span class="hljs-comment">// âŒ é”™è¯¯ï¼šç¼ºå°‘@Param</span>
  <span class="hljs-meta">@Require</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ...</span>
  }
}
</code></pre>
<h4 data-id="heading-13">ï¼ˆ2ï¼‰ä¼ é€’ç»™Componentå­ç»„ä»¶</h4>
<p><code>@Env</code>è£…é¥°çš„å˜é‡<strong>åªèƒ½</strong>ç”¨äºåˆå§‹åŒ–<code>@Component</code>ä¸­çš„å¸¸è§„å˜é‡ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä¼ é€’ç»™å¸¸è§„å˜é‡</span>
      <span class="hljs-title class_">Comp</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })

      <span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½ä¼ é€’ç»™@ObjectLinkç­‰</span>
      <span class="hljs-title class_">CompInvalid</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Comp</span> {
  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨@Requireæ¥æ”¶å¸¸è§„å˜é‡</span>
  <span class="hljs-meta">@Require</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ...</span>
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">CompInvalid</span> {
  <span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½ä½¿ç”¨@ObjectLink</span>
  <span class="hljs-meta">@ObjectLink</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ...</span>
  }
}
</code></pre>
<p><strong>é‡è¦æç¤º</strong>ï¼šé€šè¿‡<code>BuilderNode</code>åˆ‡æ¢çª—å£æ—¶ï¼Œä¼šå¯¼è‡´<code>@Env</code>ä¾æ®æ–°çš„çª—å£æ›´æ–°ç¯å¢ƒå˜é‡å®ä¾‹ã€‚åœ¨åˆ‡æ¢çª—å£çš„åœºæ™¯ä¸­ï¼Œä¸å»ºè®®ä½¿ç”¨<code>@Env</code>å˜é‡æ¥åˆå§‹åŒ–å­ç»„ä»¶çš„å¸¸è§„å˜é‡ï¼Œå¦åˆ™ä¼šé€ æˆè¯¥å¸¸è§„å˜é‡æ— æ³•è¢«<code>@Env</code>é€šçŸ¥è§¦å‘å…¶å…³è”UIç»„ä»¶åˆ·æ–°ã€‚å…·ä½“è§£å†³æ–¹æ¡ˆæˆ‘ä»¬ä¼šåœ¨é«˜çº§åœºæ™¯ä¸­ä»‹ç»ã€‚</p>
<h2 data-id="heading-14">å…­ã€@Envåˆå§‹åŒ–æµç¨‹è¯¦è§£</h2>
<p><code>@Env</code>å˜é‡ä¸å…è®¸å¼€å‘è€…åˆå§‹åŒ–ï¼Œå…¶å€¼ç”±æ¡†æ¶æ ¹æ®å½“å‰çª—å£çš„ç¯å¢ƒå˜é‡è‡ªåŠ¨æä¾›ã€‚<code>@Env</code>å˜é‡åœ¨è¢«ç¬¬ä¸€æ¬¡è¯»å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘åˆå§‹åŒ–ã€‚åˆå§‹åŒ–éµå¾ªä»¥ä¸‹æµç¨‹ï¼š</p>
<h3 data-id="heading-15">1. ä»çˆ¶ç»„ä»¶ä¸­æŸ¥æ‰¾å·²æœ‰å®ä¾‹</h3>
<p>æ¡†æ¶ä¼šå‘ä¸Šé€’å½’æŸ¥æ‰¾çˆ¶ç»„ä»¶ï¼š</p>
<ul>
<li>å¦‚æœæŸä¸ªçˆ¶ç»„ä»¶åœ¨åŒä¸€çª—å£ä¸­å·²ç»åˆå§‹åŒ–è¿‡ç›¸åŒkeyçš„<code>@Env</code>å˜é‡ï¼Œåˆ™ç›´æ¥å¤ç”¨è¯¥å®ä¾‹</li>
<li>è‹¥æœªæ‰¾åˆ°ï¼Œåˆ™ç»§ç»­å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°çˆ¶ç»„ä»¶ä¸ºç©º</li>
<li><strong>æ³¨æ„</strong>ï¼šå‘ä¸ŠæŸ¥æ‰¾çˆ¶ç»„ä»¶çš„æµç¨‹ä¼šè¢«<code>BuilderNode</code>æ‰“æ–­</li>
</ul>
<h3 data-id="heading-16">2. æŸ¥æ‰¾å½“å‰çª—å£çš„@Envå®ä¾‹</h3>
<p>å¦‚æœåœ¨çˆ¶ç»„ä»¶ä¸­æœªæ‰¾åˆ°å¯¹åº”çš„å®ä¾‹ï¼Œåˆ™æ£€æŸ¥å½“å‰çª—å£æ˜¯å¦å·²æœ‰ç›¸åŒkeyçš„<code>@Env</code>å˜é‡å®ä¾‹ï¼š</p>
<ul>
<li>å¦‚å­˜åœ¨ï¼Œåˆ™å¤ç”¨è¯¥çª—å£å†…çš„<code>@Env</code>å®ä¾‹</li>
</ul>
<h3 data-id="heading-17">3. é¦–æ¬¡è¯·æ±‚ï¼šåˆ›å»ºæ–°ç¯å¢ƒå˜é‡å®ä¾‹</h3>
<p>è‹¥ä»¥ä¸Šä¸¤æ­¥éƒ½æ— æ³•å¾—åˆ°å®ä¾‹ï¼Œåˆ™è¯´æ˜å½“å‰çª—å£ç¬¬ä¸€æ¬¡è¯»å–è¯¥ç¯å¢ƒå˜é‡ï¼š</p>
<ul>
<li>æ¡†æ¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯è§‚å¯Ÿç¯å¢ƒå˜é‡å®ä¾‹</li>
<li>å°†è¯¥å®ä¾‹ä¸å½“å‰çª—å£ç»‘å®š</li>
<li>å®Œæˆåˆå§‹åŒ–</li>
</ul>
<h3 data-id="heading-18">åˆå§‹åŒ–ç¤ºä¾‹</h3>
<p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥ç†è§£è¿™ä¸ªæµç¨‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { uiObserver } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Index`</span>)
      <span class="hljs-title class_">Child1</span>()  <span class="hljs-comment">// Child1ä¼šåˆ›å»ºæ–°çš„@Envå®ä¾‹</span>
      <span class="hljs-title class_">Child2</span>()  <span class="hljs-comment">// Child2çš„å­ç»„ä»¶ä¼šå¤ç”¨çª—å£ä¸­çš„å®ä¾‹</span>
    }
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Child1</span> {
  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è¯»å–ï¼Œä¼šåˆ›å»ºæ–°å®ä¾‹å¹¶ç»‘å®šåˆ°çª—å£</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Child1 breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Child1 breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">GrandChild1</span>()  <span class="hljs-comment">// GrandChild1ä¼šå¤ç”¨Child1çš„å®ä¾‹</span>
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Child2</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">GrandChild2</span>()  <span class="hljs-comment">// GrandChild2ä¼šå¤ç”¨çª—å£ä¸­çš„å®ä¾‹</span>
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">GrandChild1</span> {
  <span class="hljs-comment">// å‘ä¸ŠæŸ¥æ‰¾çˆ¶ç»„ä»¶ï¼Œæ‰¾åˆ°Child1çš„å®ä¾‹ï¼Œç›´æ¥å¤ç”¨</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`GrandChild1 breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`GrandChild1 breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">GrandChild2</span> {
  <span class="hljs-comment">// å‘ä¸ŠæŸ¥æ‰¾çˆ¶ç»„ä»¶ï¼Œæ²¡æ‰¾åˆ°</span>
  <span class="hljs-comment">// æŸ¥æ‰¾å½“å‰çª—å£ï¼Œæ‰¾åˆ°Child1åˆ›å»ºçš„å®ä¾‹ï¼Œå¤ç”¨</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`GrandChild2 breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`GrandChild2 breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
    }
  }
}
</code></pre>
<p>åˆå§‹åŒ–æµç¨‹æ€»ç»“ï¼š</p>
<ul>
<li><strong>Child1åˆå§‹åŒ–</strong>ï¼šå‘ä¸ŠæŸ¥æ‰¾çˆ¶ç»„ä»¶Indexï¼Œæ²¡æœ‰å®ä¾‹ â†’ æŸ¥æ‰¾å½“å‰çª—å£ï¼Œæ²¡æœ‰å®ä¾‹ â†’ åˆ›å»ºæ–°å®ä¾‹å¹¶ç»‘å®šåˆ°çª—å£</li>
<li><strong>GrandChild1åˆå§‹åŒ–</strong>ï¼šå‘ä¸ŠæŸ¥æ‰¾çˆ¶ç»„ä»¶Child1ï¼Œæ‰¾åˆ°å®ä¾‹ â†’ ç›´æ¥å¤ç”¨</li>
<li><strong>GrandChild2åˆå§‹åŒ–</strong>ï¼šå‘ä¸ŠæŸ¥æ‰¾çˆ¶ç»„ä»¶Child2å’ŒIndexï¼Œæ²¡æœ‰å®ä¾‹ â†’ æŸ¥æ‰¾å½“å‰çª—å£ï¼Œæ‰¾åˆ°Child1åˆ›å»ºçš„å®ä¾‹ â†’ å¤ç”¨</li>
</ul>
<h2 data-id="heading-19">ä¸ƒã€@Envçš„é™åˆ¶æ¡ä»¶</h2>
<p>ä½¿ç”¨<code>@Env</code>æ—¶éœ€è¦æ³¨æ„ä»¥ä¸‹é™åˆ¶æ¡ä»¶ï¼Œè¿åè¿™äº›æ¡ä»¶ä¼šå¯¼è‡´ç¼–è¯‘æ—¶æŠ¥é”™ï¼š</p>
<h3 data-id="heading-20">1. åªèƒ½åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</h3>
<p><code>@Env</code>ä»…æ”¯æŒåœ¨<code>@Component</code>å’Œ<code>@ComponentV2</code>ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæœ‰ç¼–è¯‘æ—¶æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { uiObserver } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½åœ¨æ™®é€šç±»ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>; <span class="hljs-comment">// ç¼–è¯‘æ—¶æŠ¥é”™</span>
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šåœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>; <span class="hljs-comment">// æ­£ç¡®ç”¨æ³•</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
  }
}
</code></pre>
<h3 data-id="heading-21">2. åªè¯»å±æ€§ï¼Œä¸å…è®¸åˆå§‹åŒ–</h3>
<p><code>@Env</code>è£…é¥°çš„å˜é‡ä¸ºåªè¯»å±æ€§ï¼Œä¸å…è®¸å¼€å‘è€…è¿›è¡Œåˆå§‹åŒ–æˆ–èµ‹å€¼æ“ä½œï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { uiObserver } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½åˆå§‹åŒ–</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span> =
    <span class="hljs-keyword">new</span> uiObserver.<span class="hljs-title class_">WindowSizeLayoutBreakpointInfo</span>(); <span class="hljs-comment">// ç¼–è¯‘æ—¶æŠ¥é”™</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`breakpoint height <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`breakpoint width <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change breakpoint'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½èµ‹å€¼</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> = <span class="hljs-keyword">new</span> uiObserver.<span class="hljs-title class_">WindowSizeLayoutBreakpointInfo</span>(); <span class="hljs-comment">// ç¼–è¯‘æ—¶æŠ¥é”™</span>
      })
    }
  }
}
</code></pre>
<h3 data-id="heading-22">3. ä»…æ”¯æŒBREAK_POINTå‚æ•°</h3>
<p><code>@Env</code>å½“å‰ä»…æ”¯æŒ<code>SystemProperties.BREAK_POINT</code>å‚æ•°ã€‚è‹¥ä½¿ç”¨ä¸æ”¯æŒçš„å‚æ•°ï¼Œå°†è§¦å‘ç¼–è¯‘æ—¶æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { uiObserver } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨BREAK_POINT</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint1</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-comment">// âŒ é”™è¯¯ï¼šä½¿ç”¨ä¸æ”¯æŒçš„å‚æ•°</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-string">'unsupported_key'</span>) <span class="hljs-attr">breakpoint2</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>; <span class="hljs-comment">// ç¼–è¯‘æ—¶æŠ¥é”™</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Text</span>(<span class="hljs-string">`breakpoint2 width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint2.widthBreakpoint}</span> height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint2.heightBreakpoint}</span>`</span>)
  }
}
</code></pre>
<h3 data-id="heading-23">4. ç±»å‹é™åˆ¶</h3>
<p><code>@Env</code>è£…é¥°çš„å˜é‡ç±»å‹ä»…èƒ½ä¸º<code>uiObserver.WindowSizeLayoutBreakpointInfo</code>ç±»å‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { uiObserver } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨WindowSizeLayoutBreakpointInfoç±»å‹</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint1</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-comment">// âŒ é”™è¯¯ï¼šç±»å‹ä¸åŒ¹é…</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint2</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// ç¼–è¯‘æ—¶æŠ¥é”™</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
  }
}
</code></pre>
<h3 data-id="heading-24">5. ä¸èƒ½ä¸å…¶ä»–è£…é¥°å™¨è”ç”¨</h3>
<p><code>@Env</code>åªèƒ½å•ç‹¬ä½¿ç”¨ï¼Œä¸èƒ½å’Œå…¶ä»–V1V2çŠ¶æ€å˜é‡è£…é¥°å™¨æˆ–<code>@Require</code>è”ç”¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… æ­£ç¡®ï¼šå•ç‹¬ä½¿ç”¨</span>
<span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint1</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

<span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½å’Œ@Stateè”ç”¨</span>
<span class="hljs-meta">@State</span> <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint2</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>; <span class="hljs-comment">// ç¼–è¯‘æ—¶æŠ¥é”™</span>

<span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½å’Œ@Requireè”ç”¨</span>
<span class="hljs-meta">@Require</span> <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint3</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>; <span class="hljs-comment">// ç¼–è¯‘æ—¶æŠ¥é”™</span>

<span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½å’Œ@Localè”ç”¨</span>
<span class="hljs-meta">@Local</span> <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint4</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>; <span class="hljs-comment">// ç¼–è¯‘æ—¶æŠ¥é”™</span>
</code></pre>
<h2 data-id="heading-25">å…«ã€é«˜çº§åœºæ™¯ï¼šé€šè¿‡BuilderNodeåˆ‡æ¢çª—å£</h2>
<p><code>@Env</code>ç”¨äºå±•ç¤º<code>@Component</code>/<code>@ComponentV2</code>æ‰€åœ¨çª—å£çš„ç¯å¢ƒå˜é‡ä¿¡æ¯ã€‚å½“æˆ‘ä»¬é€šè¿‡<code>BuilderNode</code>åˆ‡æ¢ç»„ä»¶æ‰€åœ¨çš„çª—å£å®ä¾‹æ—¶ï¼Œ<code>@Env</code>ä¼šæ ¹æ®æ–°çš„çª—å£è·å–å¯¹åº”çš„ç¯å¢ƒå˜é‡ä¿¡æ¯ï¼Œå¹¶è§¦å‘å…³è”çš„UIç»„ä»¶åˆ·æ–°ã€‚</p>
<h3 data-id="heading-26">åœºæ™¯è¯´æ˜</h3>
<p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡<code>BuilderNode</code>åœ¨ä¸åŒçª—å£é—´åˆ‡æ¢ï¼Œä»¥åŠ<code>@Env</code>çš„è¡Œä¸ºï¼š</p>
<ol>
<li>ç‚¹å‡»<code>Button('add node to tree')</code>ï¼Œåˆ›å»º<code>BuilderNode</code>èŠ‚ç‚¹æŒ‚è½½åˆ°<code>NodeContainer</code>ä¸‹</li>
<li>ç‚¹å‡»<code>Button('remove node from tree')</code>ï¼Œå°†<code>BuilderNode</code>èŠ‚ç‚¹ä»<code>NodeContainer</code>ä¸Šç§»é™¤</li>
<li>ç‚¹å‡»<code>Button('create sub window')</code>ï¼Œåˆ›å»ºå­çª—å¹¶æ˜¾ç¤º<code>SubWindow</code>çª—å£</li>
<li>ç‚¹å‡»<code>SubWindow</code>çª—å£å†…çš„<code>Button('add node to tree')</code>ï¼Œå°†<code>BuilderNode</code>èŠ‚ç‚¹é‡æ–°æŒ‚è½½åˆ°<code>SubWindow</code>å†…çš„<code>NodeContainer</code>ä¸‹</li>
</ol>
<p>å½“<code>ComponentUnderBuilderNode</code>è¢«æŒ‚è½½åˆ°æ–°çš„çª—å£ä¸‹æ—¶ï¼Œä¼šè§¦å‘<code>@Env</code>é‡æ–°è·å–æ–°çš„ç¯å¢ƒå˜é‡ã€‚</p>
<h3 data-id="heading-27">å®Œæ•´ç¤ºä¾‹ä»£ç </h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// EntryAbility.ets</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;
<span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DOMAIN</span> = <span class="hljs-number">0x0000</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {
  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {
    windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {
        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to load the content. Cause: %{public}s'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
        <span class="hljs-keyword">return</span>;
      }
      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in loading the content.'</span>);
    })

    <span class="hljs-comment">// ç»™Indexé¡µé¢ä¼ é€’windowStage</span>
    <span class="hljs-title class_">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'windowStage'</span>, windowStage);
  }
}

<span class="hljs-comment">// Index.ets</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BuilderNode</span>, <span class="hljs-title class_">FrameNode</span>, <span class="hljs-title class_">NodeController</span>, uiObserver, <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;
<span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DOMAIN</span> = <span class="hljs-number">0x0000</span>;

<span class="hljs-keyword">let</span> <span class="hljs-attr">windowStage_</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">sub_windowClass</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">Window</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">globalBuilderNode</span>: <span class="hljs-title class_">BuilderNode</span>&lt;[]&gt; | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;

<span class="hljs-comment">// NodeControllerç”¨äºç®¡ç†BuilderNode</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNodeController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">NodeController</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">rootNode</span>: <span class="hljs-title class_">FrameNode</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-title function_">makeNode</span>(<span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span>): <span class="hljs-title class_">FrameNode</span> | <span class="hljs-literal">null</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FrameNode</span>(uiContext);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span> = uiContext;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span>;
  }

  <span class="hljs-comment">// æ·»åŠ BuilderNodeåˆ°æ ‘ä¸­</span>
  <span class="hljs-title function_">addBuilderNode</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!globalBuilderNode &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>) {
      globalBuilderNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BuilderNode</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>);
      globalBuilderNode.<span class="hljs-title function_">build</span>(wrapBuilder&lt;[]&gt;(buildComponent), <span class="hljs-literal">undefined</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> &amp;&amp; globalBuilderNode) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span>.<span class="hljs-title function_">appendChild</span>(globalBuilderNode.<span class="hljs-title function_">getFrameNode</span>());
    }
  }

  <span class="hljs-comment">// ä»æ ‘ä¸­ç§»é™¤BuilderNode</span>
  <span class="hljs-title function_">removeBuilderNode</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> &amp;&amp; globalBuilderNode) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span>.<span class="hljs-title function_">removeChild</span>(globalBuilderNode.<span class="hljs-title function_">getFrameNode</span>());
    }
  }

  <span class="hljs-comment">// é”€æ¯BuilderNode</span>
  <span class="hljs-title function_">disposeNode</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> &amp;&amp; globalBuilderNode) {
      globalBuilderNode.<span class="hljs-title function_">dispose</span>();
      globalBuilderNode = <span class="hljs-literal">undefined</span>;
    }
  }
}

<span class="hljs-comment">// Builderå‡½æ•°ï¼Œæ„å»ºè¦æŒ‚è½½çš„ç»„ä»¶</span>
<span class="hljs-meta">@Builder</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">buildComponent</span>(<span class="hljs-params"/>) {
  <span class="hljs-title class_">Column</span>() {
    <span class="hljs-title class_">ComponentUnderBuilderNode</span>()
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">nodeController</span>: <span class="hljs-title class_">MyNodeController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyNodeController</span>();

  <span class="hljs-comment">// åˆ›å»ºå­çª—å£</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">createSubWindow</span>(<span class="hljs-params"/>) {
    windowStage_ = <span class="hljs-title class_">AppStorage</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'windowStage'</span>);
    <span class="hljs-keyword">if</span> (windowStage_ == <span class="hljs-literal">null</span>) {
      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to create the subwindow. Cause: windowStage_ is null'</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// åˆ›å»ºåº”ç”¨å­çª—å£</span>
      windowStage_.<span class="hljs-title function_">createSubWindow</span>(<span class="hljs-string">'mySubWindow'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data</span>) =&gt;</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-attr">errCode</span>: <span class="hljs-built_in">number</span> = err.<span class="hljs-property">code</span>;
        <span class="hljs-keyword">if</span> (errCode) {
          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to create the subwindow. Cause: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
          <span class="hljs-keyword">return</span>;
        }
        sub_windowClass = data;
        <span class="hljs-keyword">if</span> (!sub_windowClass) {
          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'sub_windowClass is null'</span>);
          <span class="hljs-keyword">return</span>;
        }
        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in creating the subwindow. Data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));
        
        <span class="hljs-comment">// å­çª—å£åˆ›å»ºæˆåŠŸåï¼Œè®¾ç½®å­çª—å£çš„ä½ç½®ã€å¤§å°åŠç›¸å…³å±æ€§ç­‰</span>
        sub_windowClass.<span class="hljs-title function_">moveWindowTo</span>(<span class="hljs-number">200</span>, <span class="hljs-number">1300</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
          <span class="hljs-keyword">let</span> <span class="hljs-attr">errCode</span>: <span class="hljs-built_in">number</span> = err.<span class="hljs-property">code</span>;
          <span class="hljs-keyword">if</span> (errCode) {
            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to move the window. Cause:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
            <span class="hljs-keyword">return</span>;
          }
          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in moving the window.'</span>);
        });
        
        sub_windowClass.<span class="hljs-title function_">resize</span>(<span class="hljs-number">900</span>, <span class="hljs-number">1800</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
          <span class="hljs-keyword">let</span> <span class="hljs-attr">errCode</span>: <span class="hljs-built_in">number</span> = err.<span class="hljs-property">code</span>;
          <span class="hljs-keyword">if</span> (errCode) {
            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to change the window size. Cause:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
            <span class="hljs-keyword">return</span>;
          }
          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in changing the window size.'</span>);
        });
        
        <span class="hljs-comment">// ä¸ºå­çª—å£åŠ è½½å¯¹åº”çš„ç›®æ ‡é¡µé¢</span>
        sub_windowClass.<span class="hljs-title function_">setUIContent</span>(<span class="hljs-string">'pages/SubWindow'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
          <span class="hljs-keyword">let</span> <span class="hljs-attr">errCode</span>: <span class="hljs-built_in">number</span> = err.<span class="hljs-property">code</span>;
          <span class="hljs-keyword">if</span> (errCode) {
            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to load the content. Cause:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
            <span class="hljs-keyword">return</span>;
          }
          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in loading the content.'</span>);
          <span class="hljs-keyword">if</span> (!sub_windowClass) {
            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'sub_windowClass is null'</span>);
            <span class="hljs-keyword">return</span>;
          }
          sub_windowClass.<span class="hljs-title function_">showWindow</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
            <span class="hljs-keyword">let</span> <span class="hljs-attr">errCode</span>: <span class="hljs-built_in">number</span> = err.<span class="hljs-property">code</span>;
            <span class="hljs-keyword">if</span> (errCode) {
              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to show the window. Cause: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
              <span class="hljs-keyword">return</span>;
            }
            hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in showing the window.'</span>);
          });
        });
      })
    }
  }

  <span class="hljs-comment">// é”€æ¯å­çª—å£</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">destroySubWindow</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!sub_windowClass) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'sub_windowClass is null'</span>);
      <span class="hljs-keyword">return</span>;
    }
    sub_windowClass.<span class="hljs-title function_">destroyWindow</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
      <span class="hljs-keyword">let</span> <span class="hljs-attr">errCode</span>: <span class="hljs-built_in">number</span> = err.<span class="hljs-property">code</span>;
      <span class="hljs-keyword">if</span> (errCode) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to destroy the window. Cause: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in destroying the window.'</span>);
    });
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">10</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Index`</span>)
      <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºglobalBuilderNodeï¼Œå¹¶å°†globalBuilderNodeä¸‹çš„èŠ‚ç‚¹æŒ‚åœ¨NodeContainerçš„å ä½èŠ‚ç‚¹ä¸‹</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'add node to tree'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeController</span>.<span class="hljs-title function_">addBuilderNode</span>();
      })
      <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šä»NodeContainerçš„å ä½èŠ‚ç‚¹ä¸‹ç§»é™¤globalBuilderNodeä¸‹çš„èŠ‚ç‚¹</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'remove node from tree'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeController</span>.<span class="hljs-title function_">removeBuilderNode</span>();
      })
      <span class="hljs-comment">// é”€æ¯globalBuilderNodeä¸‹çš„èŠ‚ç‚¹</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'dispose node'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeController</span>.<span class="hljs-title function_">disposeNode</span>();
      })
      <span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå­çª—</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`create sub window`</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createSubWindow</span>();
      })
      <span class="hljs-comment">// é”€æ¯å­çª—</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`destroy sub window`</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroySubWindow</span>();
      })
      <span class="hljs-title class_">NodeContainer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeController</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#FFEEF0'</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
  }
}

<span class="hljs-comment">// åœ¨BuilderNodeä¸‹çš„ç»„ä»¶ï¼Œä½¿ç”¨@Env</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ComponentUnderBuilderNode</span> {
  <span class="hljs-comment">// @Envä¼šæ ¹æ®ç»„ä»¶æ‰€åœ¨çš„çª—å£è·å–ç¯å¢ƒå˜é‡</span>
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`ComponentUnderBuilderNode breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`ComponentUnderBuilderNode breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>)

      <span class="hljs-comment">// ä¼ é€’ç»™ComponentV2å­ç»„ä»¶</span>
      <span class="hljs-title class_">CompV2</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
      <span class="hljs-comment">// ä¼ é€’ç»™Componentå­ç»„ä»¶ï¼ˆæ³¨æ„ï¼šåœ¨çª—å£åˆ‡æ¢åœºæ™¯ä¸‹å¯èƒ½æœ‰é—®é¢˜ï¼‰</span>
      <span class="hljs-title class_">Comp</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
    }
  }
}

<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">CompV2</span> {
  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`CompV2 breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`CompV2 breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>)
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Comp</span> {
  <span class="hljs-meta">@Require</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Comp breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Comp breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>)
    }
  }
}

<span class="hljs-comment">// SubWindow.ets</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">MyNodeController</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Index'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">SubWindow</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">nodeController</span>: <span class="hljs-title class_">MyNodeController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyNodeController</span>();

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">10</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`SubWindow`</span>)
      <span class="hljs-comment">// ç¬¬å››æ­¥ï¼šåœ¨ç¬¬ä¸€æ­¥ä¸­å·²åœ¨åˆ›å»ºglobalBuilderNodeã€‚å°†globalBuilderNodeä¸‹çš„èŠ‚ç‚¹æŒ‚å­çª—çš„NodeContainerçš„å ä½èŠ‚ç‚¹ä¸‹</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'add node to tree'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeController</span>.<span class="hljs-title function_">addBuilderNode</span>();
      })
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'remove node from tree'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeController</span>.<span class="hljs-title function_">removeBuilderNode</span>();
      })
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'dispose node'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeController</span>.<span class="hljs-title function_">disposeNode</span>();
      })
      <span class="hljs-title class_">NodeContainer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeController</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#FFEEF0'</span>)
    }
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#0D9FFB'</span>)
  }
}
</code></pre>
<h3 data-id="heading-28">é‡è¦æç¤º</h3>
<p>åœ¨åˆ‡æ¢çª—å£çš„åœºæ™¯ä¸­ï¼Œ<code>@Env</code>é‡æ–°è·å–æ–°çš„ç¯å¢ƒå˜é‡åï¼Œä¼šè§¦å‘å…¶å…³è”ç»„ä»¶çš„åˆ·æ–°ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li><code>ComponentUnderBuilderNode</code>ä¸­<code>@Env(SystemProperties.BREAK_POINT) breakpoint</code>ä¼šé€šçŸ¥<code>CompV2</code>å†…çš„<code>@Param breakpoint</code>åˆ·æ–°</li>
<li><strong>ä½†æ˜¯å¹¶ä¸ä¼šé€šçŸ¥<code>Comp</code>å†…çš„å¸¸è§„å˜é‡<code>breakpoint</code>è§¦å‘UIåˆ·æ–°</strong></li>
</ul>
<p>æ‰€ä»¥åœ¨åˆ‡æ¢çª—å£ã€<code>@Env</code>é‡æ–°è·å–ç¯å¢ƒå˜é‡çš„åœºæ™¯ä¸‹ï¼Œ<strong>å»ºè®®å¼€å‘è€…ä¸è¦å°†<code>@Env</code>ä¼ é€’ç»™å¸¸è§„å˜é‡</strong>ï¼Œä»¥é¿å…å¸¸è§„å˜é‡ä¸èƒ½è¢«é€šçŸ¥UIåˆ·æ–°çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-29">è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨lambdaé—­åŒ…å‡½æ•°</h3>
<p>å¯ä»¥ä½¿ç”¨lambdaé—­åŒ…å‡½æ•°å°†<code>ComponentUnderBuilderNode</code>ä¸­çš„<code>@Env</code>å‘ä¸‹ä¼ é€’ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>@Env</code>å¯ä»¥æ”¶é›†åˆ°å­ç»„ä»¶<code>Comp</code>å†…ç»„ä»¶çš„ä¾èµ–ï¼Œåœ¨åˆ‡æ¢çª—å£å®ä¾‹çš„æ—¶å€™è§¦å‘<code>Comp</code>å†…ç»„ä»¶çš„åˆ·æ–°ã€‚</p>
<p>å…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ComponentUnderBuilderNode</span> {
  <span class="hljs-meta">@Env</span>(<span class="hljs-title class_">SystemProperties</span>.<span class="hljs-property">BREAK_POINT</span>) <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`ComponentUnderBuilderNode breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`ComponentUnderBuilderNode breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>)

      <span class="hljs-title class_">CompV2</span>({ <span class="hljs-attr">breakpoint</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
      <span class="hljs-comment">// é€šè¿‡lambdaé—­åŒ…å‡½æ•°ï¼Œä½¿å¾—@Envå¯ä»¥å…³è”åˆ°Compå†…çš„ç»„ä»¶</span>
      <span class="hljs-title class_">Comp</span>({ <span class="hljs-attr">getEnv</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakpoint</span> })
    }
  }
}

<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">CompV2</span> {
  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">breakpoint</span>: uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`CompV2 breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.widthBreakpoint}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`CompV2 breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.breakpoint.heightBreakpoint}</span>`</span>)
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Comp</span> {
  <span class="hljs-comment">// é€šè¿‡lambdaé—­åŒ…å‡½æ•°è·å–çˆ¶ç»„ä»¶çš„@Envçš„å®ä¾‹</span>
  <span class="hljs-meta">@Require</span> <span class="hljs-attr">getEnv</span>: <span class="hljs-function">() =&gt;</span> uiObserver.<span class="hljs-property">WindowSizeLayoutBreakpointInfo</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// è°ƒç”¨é—­åŒ…å‡½æ•°è·å–æœ€æ–°çš„ç¯å¢ƒå˜é‡</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Comp breakpoint width: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.getEnv().widthBreakpoint}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Comp breakpoint height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.getEnv().heightBreakpoint}</span>`</span>)
    }
  }
}
</code></pre>
<p>é€šè¿‡lambdaé—­åŒ…å‡½æ•°çš„æ–¹å¼ï¼Œ<code>Comp</code>ç»„ä»¶å¯ä»¥æ­£ç¡®å“åº”<code>@Env</code>çš„å˜åŒ–ï¼Œå³ä½¿åœ¨çª—å£åˆ‡æ¢çš„åœºæ™¯ä¸‹ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚</p>
<h2 data-id="heading-30">ä¹ã€ç»“å°¾/æ€»ç»“</h2>
<p>å¥½äº†ï¼Œå…³äº<code>@Env</code>çš„å†…å®¹æˆ‘ä»¬å°±ä»‹ç»åˆ°è¿™é‡Œã€‚æ€»ç»“ä¸€ä¸‹ï¼š</p>
<p><code>@Env</code>æ˜¯API 22å¼•å…¥çš„å“åº”å¼ç³»ç»Ÿç¯å¢ƒå˜é‡è£…é¥°å™¨ï¼Œå®ƒçš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ol>
<li><strong>å“åº”å¼èƒ½åŠ›</strong>ï¼šç³»ç»Ÿç¯å¢ƒå˜é‡å˜åŒ–æ—¶è‡ªåŠ¨è§¦å‘UIåˆ·æ–°ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†</li>
<li><strong>ç®€åŒ–ä»£ç </strong>ï¼šå‡å°‘äº†å¤§é‡é‡å¤çš„é€‚é…é€»è¾‘å’Œç›‘å¬ä»£ç </li>
<li><strong>å¤šè®¾å¤‡é€‚é…</strong>ï¼šç‰¹åˆ«é€‚åˆå¤šè®¾å¤‡å¼€å‘åœºæ™¯ï¼Œå°¤å…¶æ˜¯å“åº”å¼å¸ƒå±€å’Œæ¨ªç«–å±é€‚é…</li>
</ol>
<p>è™½ç„¶<code>@Env</code>ç›®å‰åªæ”¯æŒ<code>BREAK_POINT</code>å‚æ•°ï¼ˆè¿™ä¸æ˜¯è™½ç„¶äº†ï¼Œè¿™æ˜¯å¾ˆé—æ†¾ã€‚ï¼‰ï¼Œä½†åœ¨çª—å£æ–­ç‚¹ç›¸å…³çš„åœºæ™¯ä¸­ï¼Œå®ƒæ¯”<code>Environment</code>æ›´åŠ æ–¹ä¾¿å’Œå¼ºå¤§ã€‚å¦‚æœä½ éœ€è¦å…¶ä»–ç¯å¢ƒå˜é‡ï¼ˆå¦‚è¯­è¨€ã€ä¸»é¢˜ç­‰ï¼‰ï¼Œè¿˜æ˜¯éœ€è¦ä½¿ç”¨<code>Environment</code>ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œ<code>@Env</code>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¡¥å……ï¼Œè®©æˆ‘ä»¬çš„å¼€å‘å˜å¾—æ›´åŠ ç®€å•ï¼Œå°‘å†™ç‚¹ï¼Œç¨å¾®ç»´æŠ¤ç‚¹ä»£ç ï¼Œè™½ç„¶ç°åœ¨å¯ç”¨æ€§ä¸é«˜ã€‚éšç€APIç‰ˆæœ¬çš„è¿­ä»£ï¼Œ<code>@Env</code>ä¼šæ”¯æŒæ›´å¤šçš„ç¯å¢ƒå˜é‡å‚æ•°ï¼Œåˆ°æ—¶å€™å®ƒçš„ä»·å€¼ä¼šæ›´åŠ æ˜æ˜¾ï¼ˆè¶Šå¿«è¶Šå¥½ï¼‰ã€‚</p>
<p>å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®ã€å¯¹æ–‡ç« å†™çš„ä¸æ»¡æ„ã€å‘ç°é”™è¯¯æˆ–è€…æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œæ¬¢è¿åœ¨è¯„è®ºã€ç§ä¿¡æˆ–é‚®ä»¶ä¸­æå‡ºï¼Œéå¸¸æ„Ÿè°¢æ‚¨çš„æ”¯æŒã€‚ğŸ™</p>
<h2 data-id="heading-31">åã€æ„Ÿè°¢</h2>
<p>å„ä½è¯»è€…è€çˆ·</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¾®æœåŠ¡æ¶æ„æ ¸å¿ƒç»„ä»¶ã€èŒè´£ä¸äº¤äº’å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7592846242175352866</link>    <guid>https://juejin.cn/post/7592846242175352866</guid>    <pubDate>2026-01-08T16:23:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592846242175352866" data-draft-id="7592615536385753122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¾®æœåŠ¡æ¶æ„æ ¸å¿ƒç»„ä»¶ã€èŒè´£ä¸äº¤äº’å…¨è§£æ"/> <meta itemprop="keywords" content="Spring Cloud"/> <meta itemprop="datePublished" content="2026-01-08T16:23:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…ƒYäº¨H"/> <meta itemprop="url" content="https://juejin.cn/user/2839351584888617"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¾®æœåŠ¡æ¶æ„æ ¸å¿ƒç»„ä»¶ã€èŒè´£ä¸äº¤äº’å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2839351584888617/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…ƒYäº¨H
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T16:23:40.000Z" title="Thu Jan 08 2026 16:23:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h2 data-id="heading-0">å¾®æœåŠ¡æ¶æ„æ ¸å¿ƒç»„ä»¶ã€èŒè´£ä¸äº¤äº’å…¨è§£æ</h2>
<h3 data-id="heading-1">ä¸€ã€ å¾®æœåŠ¡å…¨æ™¯æ¶æ„å›¾ï¼ˆåˆ†å±‚ï¼‰</h3>
<p>å¾®æœåŠ¡ä¸å†æ˜¯æ•£ä¹±çš„å·¥ç¨‹ï¼Œè€Œæ˜¯ä¸€ä¸ªåˆ†å·¥æ˜ç¡®çš„çŸ©é˜µã€‚é€šè¿‡åˆ†å±‚ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ¸…æ™°åœ°çœ‹åˆ°è¯·æ±‚æ˜¯å¦‚ä½•æµè½¬çš„ã€‚</p>
<pre><code class="hljs language-text" lang="text">==================== æµé‡æ¥å…¥å±‚ (Entrance) ====================
        [ å¤–éƒ¨å®¢æˆ·ç«¯ï¼šApp / H5 / Web / PC ]
                       â”‚ (Restful API / HTTPS)
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  API ç½‘å…³ (Gateway) â”‚â”€â”€â–º èŒè´£ï¼šé‰´æƒã€è·¯ç”±ã€é™æµã€æ—¥å¿—
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
==================== ä¸šåŠ¡æœåŠ¡å±‚ (Services) ====================
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
  â”‚  ç”¨æˆ·æœåŠ¡  â”‚  â”‚  è®¢å•æœåŠ¡  â”‚  â”‚  åº“å­˜æœåŠ¡  â”‚â”€â”€â–º èŒè´£ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘
  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚              â”‚              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ (Feign/RPC è°ƒç”¨)
                       â”‚
==================== æœåŠ¡æ²»ç†å±‚ (Control) =====================
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
  â”‚ â”‚ æ³¨å†Œå‘ç°ä¸­å¿ƒ â”‚ â”‚ ç»Ÿä¸€é…ç½®ä¸­å¿ƒ â”‚ â”‚ ç†”æ–­/é™æµå™¨ â”‚â”€â”€â–º èŒè´£ï¼šç®¡ç†ä¸ä¿æŠ¤
  â”‚ â”‚ (Nacos/Eureka)â”‚ â”‚ (Nacos/Apollo)â”‚ â”‚ (Sentinel) â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
==================== åŸºç¡€è®¾æ–½/è§‚æµ‹å±‚ (Infrastructure) =========
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   æ¶ˆæ¯é˜Ÿåˆ—   â”‚  â”‚   åˆ†å¸ƒå¼ç¼“å­˜ â”‚  â”‚   é“¾è·¯è¿½è¸ª   â”‚â”€â”€â–º èŒè´£ï¼šå¼‚æ­¥ã€æ€§èƒ½
  â”‚  (Kafka/MQ)  â”‚  â”‚   (Redis)    â”‚  â”‚ (Skywalking) â”‚     ä¸ç³»ç»Ÿç›‘æ§
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-2">äºŒã€ æ ¸å¿ƒç»„ä»¶èŒèƒ½</h3>
<h4 data-id="heading-3">1. API ç½‘å…³ (API Gateway) â€”â€” â€œä¿å®‰ä¸å‘å¯¼â€</h4>
<ul>
<li><strong>æ ¸å¿ƒä½œç”¨</strong>ï¼šæ•´ä¸ªå¾®æœåŠ¡ç³»ç»Ÿçš„å”¯ä¸€å…¥å£ã€‚</li>
<li><strong>å…·ä½“èŒè´£</strong>ï¼š
<ul>
<li><strong>è·¯ç”±è½¬å‘</strong>ï¼šæŠŠ <code>/order</code> çš„è¯·æ±‚å‘ç»™è®¢å•æœåŠ¡ï¼ŒæŠŠ <code>/user</code> çš„è¯·æ±‚å‘ç»™ç”¨æˆ·æœåŠ¡ã€‚</li>
<li><strong>å®‰å…¨é‰´æƒ</strong>ï¼šç»Ÿä¸€åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ã€æ˜¯å¦æœ‰æƒé™è®¿é—®ï¼Œé€šè¿‡åæ‰æ”¾è¡Œåˆ°åç«¯ã€‚</li>
<li><strong>æµé‡ç›‘æ§</strong>ï¼šåœ¨å…¥å£å¤„è®°å½•æ—¥å¿—ï¼Œæˆ–è€…æ‹¦æˆªæ¶æ„æ”»å‡»ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-4">2. æœåŠ¡æ³¨å†Œä¸å‘ç° (Service Registry) â€”â€” â€œåŠ¨æ€é€šè®¯å½•â€</h4>
<ul>
<li><strong>æ ¸å¿ƒä½œç”¨</strong>ï¼šè®°å½•æ¯ä¸€ä¸ªå¾®æœåŠ¡å®ä¾‹çš„å®æ—¶ IP å’Œç«¯å£ã€‚</li>
<li><strong>å…·ä½“èŒè´£</strong>ï¼š
<ul>
<li><strong>æ³¨å†Œ</strong>ï¼šæœåŠ¡å¯åŠ¨æ—¶ä¸»åŠ¨ä¸ŠæŠ¥è‡ªå·±çš„ä½ç½®ã€‚</li>
<li><strong>å‘ç°</strong>ï¼šæœåŠ¡ A æƒ³è°ƒæœåŠ¡ B æ—¶ï¼Œä¸ç”¨å†™æ­» IPï¼Œè€Œæ˜¯é—®æ³¨å†Œä¸­å¿ƒï¼šâ€œB ç°åœ¨åœ¨å“ªå‡ å°æœåŠ¡å™¨ä¸Šï¼Ÿâ€</li>
<li><strong>å…³è”å…³ç³»</strong>ï¼š<strong>å®ƒæ˜¯å¾®æœåŠ¡ååŒçš„åŸºçŸ³</strong>ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-5">3. é…ç½®ä¸­å¿ƒ (Config Center) â€”â€” â€œä¸­å¤®å¹¿æ’­ç«™â€</h4>
<ul>
<li><strong>æ ¸å¿ƒä½œç”¨</strong>ï¼šé›†ä¸­ç®¡ç†æ‰€æœ‰æœåŠ¡çš„é…ç½®æ–‡ä»¶ã€‚</li>
<li><strong>å…·ä½“èŒè´£</strong>ï¼š
<ul>
<li><strong>é…ç½®è§£è€¦</strong>ï¼šä»£ç é‡Œä¸å†™æ­»æ•°æ®åº“å¯†ç ã€ä¸šåŠ¡å¼€å…³ç­‰ã€‚</li>
<li><strong>åŠ¨æ€ç”Ÿæ•ˆ</strong>ï¼šä¿®æ”¹é…ç½®åï¼Œæ‰€æœ‰æœåŠ¡<strong>å®æ—¶æ¥æ”¶æ›´æ–°</strong>ï¼Œä¸éœ€è¦é‡æ–°æ‰“åŒ…é‡å¯ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">4. è¿œç¨‹è°ƒç”¨ (Feign / RPC) â€”â€” â€œéƒ¨é—¨å†…çº¿ç”µè¯â€</h4>
<ul>
<li><strong>æ ¸å¿ƒä½œç”¨</strong>ï¼šè®©æœåŠ¡ä¸æœåŠ¡ä¹‹é—´èƒ½äº’ç›¸è¯´è¯ã€‚</li>
<li><strong>å…·ä½“èŒè´£</strong>ï¼š
<ul>
<li><strong>å£°æ˜å¼è°ƒç”¨</strong>ï¼šåœ¨ä»£ç é‡Œåƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·å»è°ƒç”¨è¿œç¨‹çš„å…¶ä»–æœåŠ¡ã€‚</li>
<li><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šå¦‚æœå¯¹æ–¹æœ‰ 3 å°æœºå™¨ï¼Œå®ƒä¼šè‡ªåŠ¨é€‰æ‹©ä¸€å°å‹åŠ›å°çš„å»è®¿é—®ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-7">5. ç†”æ–­ä¸é™æµ (Sentinel) â€”â€” â€œç”µåŠ›ä¿é™©ä¸â€</h4>
<ul>
<li><strong>æ ¸å¿ƒä½œç”¨</strong>ï¼šä¿æŠ¤ç³»ç»Ÿä¸å› æŸä¸ªç‚¹åæ‰è€Œå…¨ç›˜å´©æºƒã€‚</li>
<li><strong>å…·ä½“èŒè´£</strong>ï¼š
<ul>
<li><strong>é™æµ</strong>ï¼šæ¯ç§’åªå…è®¸ 500 äººè®¿é—®ï¼Œè¶…å‡ºçš„æ’é˜Ÿæˆ–æ‹’ç»ï¼Œé˜²æ­¢å‹å®æœåŠ¡å™¨ã€‚</li>
<li><strong>ç†”æ–­</strong>ï¼šå¦‚æœå‘ç°â€œæ”¯ä»˜æœåŠ¡â€æŒ‚äº†ï¼Œç«‹åˆ»åˆ‡æ–­è®¢å•æœåŠ¡å¯¹å®ƒçš„è°ƒç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‹å¥½çš„é”™è¯¯æç¤ºï¼ˆé™çº§ï¼‰ï¼Œé˜²æ­¢è®¢å•æœåŠ¡ä¹Ÿè¢«æ‹–æ­»ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-8">6. æ¶ˆæ¯é˜Ÿåˆ— (Message Queue) â€”â€” â€œæ”¶å‘å®¤å¿«é€’æŸœâ€</h4>
<ul>
<li><strong>æ ¸å¿ƒä½œç”¨</strong>ï¼šè§£è€¦æœåŠ¡ã€å¼‚æ­¥å¤„ç†ã€‚</li>
<li><strong>å…·ä½“èŒè´£</strong>ï¼š
<ul>
<li><strong>å‰Šå³°å¡«è°·</strong>ï¼šç¬æ—¶æµé‡å¤ªçŒ›æ—¶ï¼Œå…ˆå­˜å…¥ MQï¼Œåç«¯æœåŠ¡æŒ‰ç…§è‡ªå·±çš„èŠ‚å¥æ…¢æ…¢æ¶ˆè´¹ã€‚</li>
<li><strong>å¼‚æ­¥åŒ–</strong>ï¼šä¸‹å•æˆåŠŸåï¼Œç›´æ¥å‘ä¸ªæ¶ˆæ¯ç»™ MQã€‚ç§¯åˆ†æœåŠ¡ã€çŸ­ä¿¡æœåŠ¡è‡ªå·±å»å–æ¶ˆæ¯å¤„ç†ï¼Œè®¢å•æœåŠ¡ä¸ç”¨ç­‰å®ƒä»¬æ‰§è¡Œå®Œã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-9">ä¸‰ã€ ç»„ä»¶é—´çš„ç”Ÿå‘½å‘¨æœŸä¸åä½œé€»è¾‘</h3>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡**â€œä¸€ä¸ªè¯·æ±‚çš„ä¸€ç”Ÿâ€**æ¥ä¸²è”è¿™äº›ç»„ä»¶ï¼š</p>
<ol>
<li><strong>å¯åŠ¨é˜¶æ®µ</strong>ï¼š
<ul>
<li>æ‰€æœ‰å¾®æœåŠ¡ä» <strong>é…ç½®ä¸­å¿ƒ</strong> æ‹¿åˆ°è‡ªå·±çš„é…ç½®ï¼ˆå¦‚æ•°æ®åº“åœ°å€ï¼‰ã€‚</li>
<li>å¾®æœåŠ¡å¯åŠ¨æˆåŠŸï¼ŒæŠŠè‡ªå·±çš„ IP ç™»è®°åˆ° <strong>æ³¨å†Œä¸­å¿ƒ</strong>ã€‚</li>
</ul>
</li>
<li><strong>è¯·æ±‚è¿›å…¥</strong>ï¼š
<ul>
<li>ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ <strong>API ç½‘å…³</strong>ï¼Œç½‘å…³å…ˆåšèº«ä»½æ ¡éªŒã€‚</li>
<li>æ ¡éªŒé€šè¿‡åï¼Œç½‘å…³å» <strong>æ³¨å†Œä¸­å¿ƒ</strong> æŸ¥ä¸€ä¸‹å“ªä¸ªè®¢å•æœåŠ¡åœ¨çº¿ã€‚</li>
</ul>
</li>
<li><strong>æœåŠ¡äº¤äº’</strong>ï¼š
<ul>
<li>è®¢å•æœåŠ¡å¤„ç†é€»è¾‘ï¼Œéœ€è¦æŸ¥ç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡ <strong>Feign</strong> è°ƒç”¨æˆ·æœåŠ¡ã€‚</li>
<li>æ­¤æ—¶ <strong>Sentinel</strong> ç´§ç›¯é“¾è·¯ï¼Œå¦‚æœç”¨æˆ·æœåŠ¡å¤ªæ…¢ï¼ŒSentinel å¯åŠ¨é™æµæˆ–ç†”æ–­ã€‚</li>
</ul>
</li>
<li><strong>æ•°æ®æ²‰æ·€ä¸åé¦ˆ</strong>ï¼š
<ul>
<li>è®¢å•å¤„ç†å®Œï¼Œå¾€ <strong>MQ</strong> ä¸¢ä¸€æ¡æ¶ˆæ¯é€šçŸ¥å…¶ä»–æœåŠ¡ã€‚</li>
<li><strong>Skywalking</strong> å…¨ç¨‹è®°å½•è¯¥è¯·æ±‚èµ°è¿‡çš„æ‰€æœ‰è·¯å¾„å’Œæ—¶é—´ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-10">å››ã€ å¸¸è§ç»„ä»¶å¯¹æ¯”è¡¨</h3>








































<table><thead><tr><th align="left">ç»´åº¦</th><th align="left">ä¸»æµæ¨è (Spring Cloud Alibaba ä½“ç³»)</th><th align="left">å¤‡é€‰/ç»å…¸ç»„ä»¶</th></tr></thead><tbody><tr><td align="left"><strong>æ³¨å†Œä¸­å¿ƒ</strong></td><td align="left"><strong>Nacos</strong> (æœ€æ¨èï¼Œå›½å†…æœ€ç«)</td><td align="left">Eureka, Consul, Zookeeper</td></tr><tr><td align="left"><strong>é…ç½®ä¸­å¿ƒ</strong></td><td align="left"><strong>Nacos Config</strong></td><td align="left">Apollo (åŠŸèƒ½æœ€å¼º), Spring Cloud Config</td></tr><tr><td align="left"><strong>ç½‘å…³</strong></td><td align="left"><strong>Spring Cloud Gateway</strong></td><td align="left">Zuul (å·²è¿‡æ—¶), Kong, Nginx</td></tr><tr><td align="left"><strong>ç†”æ–­é™æµ</strong></td><td align="left"><strong>Sentinel</strong> (åŠŸèƒ½ä¸°å¯Œï¼Œæœ‰ç®¡ç†åå°)</td><td align="left">Hystrix (å·²åœæ›´)</td></tr><tr><td align="left"><strong>è¿œç¨‹è°ƒç”¨</strong></td><td align="left"><strong>OpenFeign</strong> / Dubbo</td><td align="left">RestTemplate</td></tr><tr><td align="left"><strong>é“¾è·¯è¿½è¸ª</strong></td><td align="left"><strong>Skywalking</strong> (æ— ä¾µå…¥ï¼Œæœ€å¼º)</td><td align="left">Zipkin, Jaeger</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-11">äº”ã€ å¿ƒæ³•</h3>
<ol>
<li><strong>ä¸è¦è¯•å›¾ä¸€æ¬¡æ€§å­¦å®Œæ‰€æœ‰ç»„ä»¶</strong>ï¼šå…ˆæå®š Nacos + OpenFeign + Gatewayï¼Œè¿™å°±å·²ç»èƒ½æ­å‡ºä¸€ä¸ªèƒ½è·‘çš„å¾®æœåŠ¡äº†ã€‚</li>
<li><strong>ç†è§£æ¯”ä»£ç æ›´é‡è¦</strong>ï¼šä»£ç åªæ˜¯è°ƒç”¨ APIï¼Œç†è§£â€œä¸ºä»€ä¹ˆè¦ç”¨ç½‘å…³ï¼Ÿâ€â€œä¸ºä»€ä¹ˆéœ€è¦æ³¨å†Œä¸­å¿ƒï¼Ÿâ€æ‰æ˜¯å¾®æœåŠ¡çš„æ ¸å¿ƒã€‚</li>
<li><strong>å…³æ³¨æ•°æ®ä¸€è‡´æ€§</strong>ï¼šå¾®æœåŠ¡æœ€éš¾çš„åœ°æ–¹åœ¨äºæ•°æ®æ•£è½åœ¨ä¸åŒæ•°æ®åº“ï¼Œä»¥åä½ å¯ä»¥è¿›é˜¶å­¦ä¹  <strong>Seata</strong>ï¼ˆåˆ†å¸ƒå¼äº‹åŠ¡ï¼‰ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®°å½•ä¸€æ¬¡sqlä¼˜åŒ–è®°å½•]]></title>    <link>https://juejin.cn/post/7592863358258364470</link>    <guid>https://juejin.cn/post/7592863358258364470</guid>    <pubDate>2026-01-08T15:14:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592863358258364470" data-draft-id="7592818202717536275" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®°å½•ä¸€æ¬¡sqlä¼˜åŒ–è®°å½•"/> <meta itemprop="keywords" content="MySQL"/> <meta itemprop="datePublished" content="2026-01-08T15:14:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®°å½•ä¸€æ¬¡sqlä¼˜åŒ–è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T15:14:37.000Z" title="Thu Jan 08 2026 15:14:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å·¥ä½œä¸­ï¼Œè¢«åˆ†é…äº†ä¸€ä¸ªdjangoä¸­ï¼Œè¿›è¡ŒdbæŸ¥è¯¢ä¼˜åŒ–çš„ä»»åŠ¡ï¼Œè¯¥ä»»åŠ¡æ˜¯è§£å†³dbè¿æ¥çš„é—®é¢˜ï¼ŒæŸä¸ªæ•°æ®åº“ä¿¡æ¯æŸ¥è¯¢ä»»åŠ¡å¤§æ¦‚æ¯15åˆ†é’Ÿæ‰§è¡Œ2200æ¬¡ï¼Œä¼šæœ‰å‡ æ¬¡æŸ¥è¯¢å¤±è´¥ï¼Œéœ€è¦å®šä½è§£å†³</p>
<h2 data-id="heading-0">1 ç°è±¡</h2>
<h2 data-id="heading-1">2 é—®é¢˜å®šä½</h2>
<h2 data-id="heading-2">3 è§£å†³æ€è·¯</h2>
<p>æ·»åŠ è”åˆç´¢å¼•
å®šæ—¶æ¸…é™¤ä¸ç”¨çš„è¡¨æ•°æ®</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>